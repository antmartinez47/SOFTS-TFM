horizon=720
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6444463
	speed: 0.0088s/iter; left time: 16.3198s
	iters: 200, epoch: 1 | loss: 1.1232940
	speed: 0.0026s/iter; left time: 4.6614s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.6201).  Saving model state dict ...
Epoch: 1 cost time: 1.0148134231567383
Epoch: 1, Steps: 245 | Train Loss: 0.8838702 Vali Loss: 0.6200978 Best vali loss: 0.6200978
	iters: 100, epoch: 2 | loss: 0.6054546
	speed: 0.0067s/iter; left time: 10.8013s
	iters: 200, epoch: 2 | loss: 0.8407548
	speed: 0.0030s/iter; left time: 4.6108s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.6201 --> 0.6097).  Saving model state dict ...
Epoch: 2 cost time: 0.7905981540679932
Epoch: 2, Steps: 245 | Train Loss: 0.7231047 Vali Loss: 0.6097484 Best vali loss: 0.6097484
	iters: 100, epoch: 3 | loss: 0.7110860
	speed: 0.0067s/iter; left time: 9.1377s
	iters: 200, epoch: 3 | loss: 0.9352169
	speed: 0.0027s/iter; left time: 3.4794s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.6097 --> 0.6030).  Saving model state dict ...
Epoch: 3 cost time: 0.729994535446167
Epoch: 3, Steps: 245 | Train Loss: 0.8231514 Vali Loss: 0.6029878 Best vali loss: 0.6029878

best validation loss 0.6029878110865761

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7173828
	speed: 0.0112s/iter; left time: 42.7821s
	iters: 200, epoch: 1 | loss: 1.0096015
	speed: 0.0053s/iter; left time: 19.6655s
	iters: 300, epoch: 1 | loss: 1.1857265
	speed: 0.0053s/iter; left time: 19.3347s
	iters: 400, epoch: 1 | loss: 0.7146049
	speed: 0.0055s/iter; left time: 19.2132s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 2.960505723953247
Epoch: 1, Steps: 490 | Train Loss: 0.9068289 Vali Loss: 0.6028578 Best vali loss: 0.6028578
	iters: 100, epoch: 2 | loss: 0.5630472
	speed: 0.0142s/iter; left time: 47.1856s
	iters: 200, epoch: 2 | loss: 1.1823506
	speed: 0.0050s/iter; left time: 16.1275s
	iters: 300, epoch: 2 | loss: 1.0664259
	speed: 0.0048s/iter; left time: 15.1447s
	iters: 400, epoch: 2 | loss: 0.5732167
	speed: 0.0048s/iter; left time: 14.3983s
Updating learning rate to 0.0007560191392
Epoch: 2 cost time: 2.4591622352600098
Epoch: 2, Steps: 490 | Train Loss: 0.8462601 Vali Loss: 0.6076957 Best vali loss: 0.6028578
	iters: 100, epoch: 3 | loss: 0.5035796
	speed: 0.0133s/iter; left time: 37.8608s
	iters: 200, epoch: 3 | loss: 0.7063930
	speed: 0.0049s/iter; left time: 13.4175s
	iters: 300, epoch: 3 | loss: 0.6522663
	speed: 0.0047s/iter; left time: 12.3336s
	iters: 400, epoch: 3 | loss: 0.6365426
	speed: 0.0049s/iter; left time: 12.4362s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 2.4211366176605225
Epoch: 3, Steps: 490 | Train Loss: 0.6246954 Vali Loss: 0.6051217 Best vali loss: 0.6028578

best validation loss 0.602857762274506

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8099596
	speed: 0.0102s/iter; left time: 8.9878s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.6370).  Saving model state dict ...
Epoch: 1 cost time: 0.8408191204071045
Epoch: 1, Steps: 123 | Train Loss: 0.8099596 Vali Loss: 0.6370162 Best vali loss: 0.6370162
	iters: 100, epoch: 2 | loss: 0.7674240
	speed: 0.0069s/iter; left time: 5.2773s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.6370 --> 0.6112).  Saving model state dict ...
Epoch: 2 cost time: 0.5150761604309082
Epoch: 2, Steps: 123 | Train Loss: 0.7674240 Vali Loss: 0.6111633 Best vali loss: 0.6111633
	iters: 100, epoch: 3 | loss: 0.7244929
	speed: 0.0069s/iter; left time: 4.4339s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.6112 --> 0.6070).  Saving model state dict ...
Epoch: 3 cost time: 0.5025513172149658
Epoch: 3, Steps: 123 | Train Loss: 0.7244929 Vali Loss: 0.6070446 Best vali loss: 0.6070446

best validation loss 0.6070446330383386

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6990818
	speed: 0.0115s/iter; left time: 26.9375s
	iters: 200, epoch: 4 | loss: 0.9412104
	speed: 0.0052s/iter; left time: 11.7403s
	iters: 300, epoch: 4 | loss: 0.9955041
	speed: 0.0052s/iter; left time: 11.2012s
	iters: 400, epoch: 4 | loss: 0.7154804
	speed: 0.0053s/iter; left time: 10.8389s
Updating learning rate to 0.0001890047848
Epoch: 4 cost time: 2.9220869541168213
Epoch: 4, Steps: 490 | Train Loss: 0.8378192 Vali Loss: 0.6158962 Best vali loss: 0.6028578
	iters: 100, epoch: 5 | loss: 0.5547534
	speed: 0.0140s/iter; left time: 26.0590s
	iters: 200, epoch: 5 | loss: 1.1516224
	speed: 0.0050s/iter; left time: 8.7305s
	iters: 300, epoch: 5 | loss: 1.0393096
	speed: 0.0051s/iter; left time: 8.4753s
	iters: 400, epoch: 5 | loss: 0.5763509
	speed: 0.0051s/iter; left time: 7.9410s
Updating learning rate to 9.45023924e-05
Epoch: 5 cost time: 2.5221354961395264
Epoch: 5, Steps: 490 | Train Loss: 0.8305091 Vali Loss: 0.6086928 Best vali loss: 0.6028578
	iters: 100, epoch: 6 | loss: 0.3951067
	speed: 0.0139s/iter; left time: 19.1151s
	iters: 200, epoch: 6 | loss: 0.6998267
	speed: 0.0052s/iter; left time: 6.6065s
	iters: 300, epoch: 6 | loss: 0.6081169
	speed: 0.0052s/iter; left time: 6.0642s
	iters: 400, epoch: 6 | loss: 0.6231296
	speed: 0.0053s/iter; left time: 5.6830s
Updating learning rate to 4.72511962e-05
Epoch: 6 cost time: 2.6155169010162354
Epoch: 6, Steps: 490 | Train Loss: 0.5815450 Vali Loss: 0.6098711 Best vali loss: 0.6028578
	iters: 100, epoch: 7 | loss: 1.0918077
	speed: 0.0140s/iter; left time: 12.3321s
	iters: 200, epoch: 7 | loss: 0.7666696
	speed: 0.0053s/iter; left time: 4.1634s
	iters: 300, epoch: 7 | loss: 0.8725835
	speed: 0.0053s/iter; left time: 3.6283s
	iters: 400, epoch: 7 | loss: 0.6215797
	speed: 0.0054s/iter; left time: 3.1134s
Updating learning rate to 2.36255981e-05
Epoch: 7 cost time: 2.6537368297576904
Epoch: 7, Steps: 490 | Train Loss: 0.8381601 Vali Loss: 0.6076043 Best vali loss: 0.6028578
	iters: 100, epoch: 8 | loss: 0.6157762
	speed: 0.0136s/iter; left time: 5.3020s
	iters: 200, epoch: 8 | loss: 0.6356126
	speed: 0.0048s/iter; left time: 1.3898s
	iters: 300, epoch: 8 | loss: 0.4142317
	speed: 0.0049s/iter; left time: 0.9357s
	iters: 400, epoch: 8 | loss: 0.5651223
	speed: 0.0049s/iter; left time: 0.4480s
Updating learning rate to 1.181279905e-05
Epoch: 8 cost time: 2.4421441555023193
Epoch: 8, Steps: 490 | Train Loss: 0.5576857 Vali Loss: 0.6062898 Best vali loss: 0.6028578

best validation loss 0.602857762274506

[INFO][abstract_intensifier.py:516] Added config 0347d9 as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0163965
	speed: 0.0106s/iter; left time: 19.6861s
	iters: 200, epoch: 1 | loss: 0.9506347
	speed: 0.0040s/iter; left time: 7.1067s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.5828).  Saving model state dict ...
Epoch: 1 cost time: 1.3684625625610352
Epoch: 1, Steps: 245 | Train Loss: 0.9835156 Vali Loss: 0.5828214 Best vali loss: 0.5828214
	iters: 100, epoch: 2 | loss: 0.8091241
	speed: 0.0085s/iter; left time: 13.6564s
	iters: 200, epoch: 2 | loss: 0.6671111
	speed: 0.0039s/iter; left time: 5.8609s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.5828 --> 0.5525).  Saving model state dict ...
Epoch: 2 cost time: 1.0102241039276123
Epoch: 2, Steps: 245 | Train Loss: 0.7381176 Vali Loss: 0.5525374 Best vali loss: 0.5525374
	iters: 100, epoch: 3 | loss: 0.6722549
	speed: 0.0086s/iter; left time: 11.8295s
	iters: 200, epoch: 3 | loss: 0.6232114
	speed: 0.0040s/iter; left time: 5.0969s
Updating learning rate to 8.5374841225e-05
Validation loss decreased (0.5525 --> 0.5442).  Saving model state dict ...
Epoch: 3 cost time: 1.0533006191253662
Epoch: 3, Steps: 245 | Train Loss: 0.6477331 Vali Loss: 0.5441949 Best vali loss: 0.5441949
	iters: 100, epoch: 4 | loss: 0.8908857
	speed: 0.0083s/iter; left time: 9.3284s
	iters: 200, epoch: 4 | loss: 1.1802825
	speed: 0.0035s/iter; left time: 3.5964s
Updating learning rate to 4.26874206125e-05
Epoch: 4 cost time: 0.9282574653625488
Epoch: 4, Steps: 245 | Train Loss: 1.0355841 Vali Loss: 0.5449446 Best vali loss: 0.5441949
	iters: 100, epoch: 5 | loss: 0.8373078
	speed: 0.0082s/iter; left time: 7.2599s
	iters: 200, epoch: 5 | loss: 0.4293734
	speed: 0.0038s/iter; left time: 2.9836s
Updating learning rate to 2.134371030625e-05
Validation loss decreased (0.5442 --> 0.5410).  Saving model state dict ...
Epoch: 5 cost time: 1.0030326843261719
Epoch: 5, Steps: 245 | Train Loss: 0.6333406 Vali Loss: 0.5409771 Best vali loss: 0.5409771
	iters: 100, epoch: 6 | loss: 0.4857479
	speed: 0.0080s/iter; left time: 5.1143s
	iters: 200, epoch: 6 | loss: 0.6878946
	speed: 0.0035s/iter; left time: 1.9002s
Updating learning rate to 1.0671855153125e-05
Validation loss decreased (0.5410 --> 0.5393).  Saving model state dict ...
Epoch: 6 cost time: 0.9411983489990234
Epoch: 6, Steps: 245 | Train Loss: 0.5868212 Vali Loss: 0.5392824 Best vali loss: 0.5392824
	iters: 100, epoch: 7 | loss: 0.4283256
	speed: 0.0084s/iter; left time: 3.3005s
	iters: 200, epoch: 7 | loss: 0.4513689
	speed: 0.0037s/iter; left time: 1.0739s
Updating learning rate to 5.3359275765625e-06
Validation loss decreased (0.5393 --> 0.5379).  Saving model state dict ...
Epoch: 7 cost time: 0.9735536575317383
Epoch: 7, Steps: 245 | Train Loss: 0.4398472 Vali Loss: 0.5378910 Best vali loss: 0.5378910
	iters: 100, epoch: 8 | loss: 0.6264331
	speed: 0.0083s/iter; left time: 1.2180s
	iters: 200, epoch: 8 | loss: 0.6549286
	speed: 0.0038s/iter; left time: 0.1759s
Updating learning rate to 2.66796378828125e-06
Validation loss decreased (0.5379 --> 0.5377).  Saving model state dict ...
Epoch: 8 cost time: 1.0039761066436768
Epoch: 8, Steps: 245 | Train Loss: 0.6406808 Vali Loss: 0.5376553 Best vali loss: 0.5376553

best validation loss 0.537655273903194

[INFO][abstract_intensifier.py:595] Added config c221ed and rejected config 0347d9 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6366393
	speed: 0.0102s/iter; left time: 9.0564s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 0.8412387371063232
Epoch: 1, Steps: 123 | Train Loss: 0.6366393 Vali Loss: 0.6090453 Best vali loss: 0.6090453
	iters: 100, epoch: 2 | loss: 0.8215050
	speed: 0.0067s/iter; left time: 5.0859s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.6090 --> 0.5932).  Saving model state dict ...
Epoch: 2 cost time: 0.5030767917633057
Epoch: 2, Steps: 123 | Train Loss: 0.8215050 Vali Loss: 0.5932330 Best vali loss: 0.5932330
	iters: 100, epoch: 3 | loss: 0.6245622
	speed: 0.0068s/iter; left time: 4.3263s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 0.5105936527252197
Epoch: 3, Steps: 123 | Train Loss: 0.6245622 Vali Loss: 0.6609661 Best vali loss: 0.5932330
	iters: 100, epoch: 4 | loss: 0.6342233
	speed: 0.0064s/iter; left time: 3.2830s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 0.47887396812438965
Epoch: 4, Steps: 123 | Train Loss: 0.6342233 Vali Loss: 0.6652058 Best vali loss: 0.5932330
	iters: 100, epoch: 5 | loss: 0.7118180
	speed: 0.0066s/iter; left time: 2.5797s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 0.513582706451416
Epoch: 5, Steps: 123 | Train Loss: 0.7118180 Vali Loss: 0.6788576 Best vali loss: 0.5932330
	iters: 100, epoch: 6 | loss: 0.5629086
	speed: 0.0065s/iter; left time: 1.7533s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.4769136905670166
Epoch: 6, Steps: 123 | Train Loss: 0.5629086 Vali Loss: 0.6863548 Best vali loss: 0.5932330
	iters: 100, epoch: 7 | loss: 0.4858136
	speed: 0.0064s/iter; left time: 0.9370s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.49543166160583496
Epoch: 7, Steps: 123 | Train Loss: 0.4858136 Vali Loss: 0.6963415 Best vali loss: 0.5932330
	iters: 100, epoch: 8 | loss: 0.6803039
	speed: 0.0064s/iter; left time: 0.1529s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4707770347595215
Epoch: 8, Steps: 123 | Train Loss: 0.6803039 Vali Loss: 0.6930052 Best vali loss: 0.5932330

best validation loss 0.5932329816434296

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8809983
	speed: 0.0099s/iter; left time: 8.7533s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.5937).  Saving model state dict ...
Epoch: 1 cost time: 0.8065688610076904
Epoch: 1, Steps: 123 | Train Loss: 0.8809983 Vali Loss: 0.5936806 Best vali loss: 0.5936806
	iters: 100, epoch: 2 | loss: 0.9040944
	speed: 0.0066s/iter; left time: 5.0018s
Updating learning rate to 0.0004018465698
Epoch: 2 cost time: 0.4986855983734131
Epoch: 2, Steps: 123 | Train Loss: 0.9040944 Vali Loss: 0.6124770 Best vali loss: 0.5936806
	iters: 100, epoch: 3 | loss: 0.9462628
	speed: 0.0066s/iter; left time: 4.2252s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 0.4931144714355469
Epoch: 3, Steps: 123 | Train Loss: 0.9462628 Vali Loss: 0.6239460 Best vali loss: 0.5936806

best validation loss 0.5936805723939214

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6248099
	speed: 0.0098s/iter; left time: 18.2399s
	iters: 200, epoch: 1 | loss: 0.7926866
	speed: 0.0036s/iter; left time: 6.3922s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 1.2518517971038818
Epoch: 1, Steps: 245 | Train Loss: 0.7087483 Vali Loss: 0.6184299 Best vali loss: 0.6184299
	iters: 100, epoch: 2 | loss: 0.9714750
	speed: 0.0077s/iter; left time: 12.3941s
	iters: 200, epoch: 2 | loss: 0.7618306
	speed: 0.0036s/iter; left time: 5.4388s
Updating learning rate to 0.0003076635321
Validation loss decreased (0.6184 --> 0.5972).  Saving model state dict ...
Epoch: 2 cost time: 0.932816743850708
Epoch: 2, Steps: 245 | Train Loss: 0.8666528 Vali Loss: 0.5972018 Best vali loss: 0.5972018
	iters: 100, epoch: 3 | loss: 0.7445564
	speed: 0.0075s/iter; left time: 10.3026s
	iters: 200, epoch: 3 | loss: 0.6498231
	speed: 0.0034s/iter; left time: 4.3248s
Updating learning rate to 0.00015383176605
Epoch: 3 cost time: 0.8828768730163574
Epoch: 3, Steps: 245 | Train Loss: 0.6971898 Vali Loss: 0.6135011 Best vali loss: 0.5972018

best validation loss 0.5972018050187609

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0322714
	speed: 0.0092s/iter; left time: 17.1378s
	iters: 200, epoch: 1 | loss: 0.7813309
	speed: 0.0031s/iter; left time: 5.3783s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.6409).  Saving model state dict ...
Epoch: 1 cost time: 1.1046195030212402
Epoch: 1, Steps: 245 | Train Loss: 0.9068011 Vali Loss: 0.6408954 Best vali loss: 0.6408954
	iters: 100, epoch: 2 | loss: 0.7796395
	speed: 0.0068s/iter; left time: 10.9350s
	iters: 200, epoch: 2 | loss: 0.7407690
	speed: 0.0028s/iter; left time: 4.2587s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.6409 --> 0.6197).  Saving model state dict ...
Epoch: 2 cost time: 0.7338624000549316
Epoch: 2, Steps: 245 | Train Loss: 0.7602042 Vali Loss: 0.6196993 Best vali loss: 0.6196993
	iters: 100, epoch: 3 | loss: 0.8512021
	speed: 0.0061s/iter; left time: 8.3216s
	iters: 200, epoch: 3 | loss: 1.3424101
	speed: 0.0027s/iter; left time: 3.4517s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.6197 --> 0.6133).  Saving model state dict ...
Epoch: 3 cost time: 0.7027199268341064
Epoch: 3, Steps: 245 | Train Loss: 1.0968061 Vali Loss: 0.6132615 Best vali loss: 0.6132615

best validation loss 0.6132615416042234

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7776930
	speed: 0.0099s/iter; left time: 5.1095s
Updating learning rate to 0.00010046164245
Epoch: 4 cost time: 0.7907824516296387
Epoch: 4, Steps: 123 | Train Loss: 0.7776930 Vali Loss: 0.6170878 Best vali loss: 0.5936806
	iters: 100, epoch: 5 | loss: 0.8123508
	speed: 0.0068s/iter; left time: 2.6910s
Updating learning rate to 5.0230821225e-05
Epoch: 5 cost time: 0.5340492725372314
Epoch: 5, Steps: 123 | Train Loss: 0.8123508 Vali Loss: 0.6358300 Best vali loss: 0.5936806
	iters: 100, epoch: 6 | loss: 0.8725266
	speed: 0.0068s/iter; left time: 1.8283s
Updating learning rate to 2.51154106125e-05
Epoch: 6 cost time: 0.5034806728363037
Epoch: 6, Steps: 123 | Train Loss: 0.8725266 Vali Loss: 0.6411257 Best vali loss: 0.5936806
	iters: 100, epoch: 7 | loss: 0.7018778
	speed: 0.0065s/iter; left time: 0.9531s
Updating learning rate to 1.255770530625e-05
Epoch: 7 cost time: 0.4744410514831543
Epoch: 7, Steps: 123 | Train Loss: 0.7018778 Vali Loss: 0.6370390 Best vali loss: 0.5936806
	iters: 100, epoch: 8 | loss: 0.9577098
	speed: 0.0063s/iter; left time: 0.1512s
Updating learning rate to 6.278852653125e-06
Epoch: 8 cost time: 0.4711031913757324
Epoch: 8, Steps: 123 | Train Loss: 0.9577098 Vali Loss: 0.6411136 Best vali loss: 0.5936806

best validation loss 0.5936805723939214

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8961036
	speed: 0.0108s/iter; left time: 20.0983s
	iters: 200, epoch: 1 | loss: 1.0731381
	speed: 0.0047s/iter; left time: 8.3546s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.5945).  Saving model state dict ...
Epoch: 1 cost time: 1.5045578479766846
Epoch: 1, Steps: 245 | Train Loss: 0.9846208 Vali Loss: 0.5944593 Best vali loss: 0.5944593
	iters: 100, epoch: 2 | loss: 0.7571412
	speed: 0.0099s/iter; left time: 15.9433s
	iters: 200, epoch: 2 | loss: 0.7938346
	speed: 0.0047s/iter; left time: 7.1998s
Updating learning rate to 0.000101433541
Validation loss decreased (0.5945 --> 0.5600).  Saving model state dict ...
Epoch: 2 cost time: 1.203477382659912
Epoch: 2, Steps: 245 | Train Loss: 0.7754879 Vali Loss: 0.5599994 Best vali loss: 0.5599994
	iters: 100, epoch: 3 | loss: 1.0435754
	speed: 0.0103s/iter; left time: 14.1646s
	iters: 200, epoch: 3 | loss: 0.5463119
	speed: 0.0050s/iter; left time: 6.3246s
Updating learning rate to 5.07167705e-05
Validation loss decreased (0.5600 --> 0.5516).  Saving model state dict ...
Epoch: 3 cost time: 1.2661583423614502
Epoch: 3, Steps: 245 | Train Loss: 0.7949437 Vali Loss: 0.5516432 Best vali loss: 0.5516432
	iters: 100, epoch: 4 | loss: 0.9146120
	speed: 0.0103s/iter; left time: 11.5636s
	iters: 200, epoch: 4 | loss: 0.5444087
	speed: 0.0050s/iter; left time: 5.1726s
Updating learning rate to 2.535838525e-05
Epoch: 4 cost time: 1.2721459865570068
Epoch: 4, Steps: 245 | Train Loss: 0.7295103 Vali Loss: 0.5522544 Best vali loss: 0.5516432
	iters: 100, epoch: 5 | loss: 0.9177831
	speed: 0.0100s/iter; left time: 8.8157s
	iters: 200, epoch: 5 | loss: 0.8456392
	speed: 0.0051s/iter; left time: 3.9534s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 1.2866992950439453
Epoch: 5, Steps: 245 | Train Loss: 0.8817112 Vali Loss: 0.5602619 Best vali loss: 0.5516432
	iters: 100, epoch: 6 | loss: 0.7295353
	speed: 0.0101s/iter; left time: 6.4374s
	iters: 200, epoch: 6 | loss: 0.4443195
	speed: 0.0050s/iter; left time: 2.6887s
Updating learning rate to 6.3395963125e-06
Validation loss decreased (0.5516 --> 0.5509).  Saving model state dict ...
Epoch: 6 cost time: 1.2819271087646484
Epoch: 6, Steps: 245 | Train Loss: 0.5869274 Vali Loss: 0.5509118 Best vali loss: 0.5509118
	iters: 100, epoch: 7 | loss: 0.7564778
	speed: 0.0103s/iter; left time: 4.0388s
	iters: 200, epoch: 7 | loss: 0.8999364
	speed: 0.0049s/iter; left time: 1.4209s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 1.2443852424621582
Epoch: 7, Steps: 245 | Train Loss: 0.8282071 Vali Loss: 0.5538710 Best vali loss: 0.5509118
	iters: 100, epoch: 8 | loss: 0.6206694
	speed: 0.0100s/iter; left time: 1.4602s
	iters: 200, epoch: 8 | loss: 0.4577188
	speed: 0.0051s/iter; left time: 0.2326s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 1.2794487476348877
Epoch: 8, Steps: 245 | Train Loss: 0.5391941 Vali Loss: 0.5544574 Best vali loss: 0.5509118

best validation loss 0.5509118412667433

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9546034
	speed: 0.0098s/iter; left time: 18.2634s
	iters: 200, epoch: 1 | loss: 1.1145173
	speed: 0.0038s/iter; left time: 6.6690s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 1.266357183456421
Epoch: 1, Steps: 245 | Train Loss: 1.0345604 Vali Loss: 0.6031510 Best vali loss: 0.6031510
	iters: 100, epoch: 2 | loss: 0.8555853
	speed: 0.0081s/iter; left time: 13.0126s
	iters: 200, epoch: 2 | loss: 0.7753830
	speed: 0.0040s/iter; left time: 6.0173s
Updating learning rate to 0.00017060212275
Epoch: 2 cost time: 1.0127360820770264
Epoch: 2, Steps: 245 | Train Loss: 0.8154842 Vali Loss: 0.6242028 Best vali loss: 0.6031510
	iters: 100, epoch: 3 | loss: 0.9125990
	speed: 0.0081s/iter; left time: 11.1734s
	iters: 200, epoch: 3 | loss: 0.6632277
	speed: 0.0039s/iter; left time: 4.9951s
Updating learning rate to 8.5301061375e-05
Epoch: 3 cost time: 1.0018775463104248
Epoch: 3, Steps: 245 | Train Loss: 0.7879134 Vali Loss: 0.6305853 Best vali loss: 0.6031510
	iters: 100, epoch: 4 | loss: 0.6552419
	speed: 0.0082s/iter; left time: 9.1825s
	iters: 200, epoch: 4 | loss: 0.5754877
	speed: 0.0038s/iter; left time: 3.9436s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 1.007624626159668
Epoch: 4, Steps: 245 | Train Loss: 0.6153648 Vali Loss: 0.6355464 Best vali loss: 0.6031510
	iters: 100, epoch: 5 | loss: 0.4575329
	speed: 0.0083s/iter; left time: 7.3048s
	iters: 200, epoch: 5 | loss: 0.9694216
	speed: 0.0039s/iter; left time: 3.0116s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 1.0057172775268555
Epoch: 5, Steps: 245 | Train Loss: 0.7134772 Vali Loss: 0.6272386 Best vali loss: 0.6031510
	iters: 100, epoch: 6 | loss: 0.6236527
	speed: 0.0081s/iter; left time: 5.1614s
	iters: 200, epoch: 6 | loss: 0.6695422
	speed: 0.0037s/iter; left time: 2.0058s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 0.9817245006561279
Epoch: 6, Steps: 245 | Train Loss: 0.6465974 Vali Loss: 0.6301279 Best vali loss: 0.6031510
	iters: 100, epoch: 7 | loss: 0.6208729
	speed: 0.0081s/iter; left time: 3.1554s
	iters: 200, epoch: 7 | loss: 0.8661581
	speed: 0.0039s/iter; left time: 1.1431s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 1.0011885166168213
Epoch: 7, Steps: 245 | Train Loss: 0.7435155 Vali Loss: 0.6321055 Best vali loss: 0.6031510
	iters: 100, epoch: 8 | loss: 0.6293874
	speed: 0.0080s/iter; left time: 1.1714s
	iters: 200, epoch: 8 | loss: 0.7571483
	speed: 0.0038s/iter; left time: 0.1765s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 0.9817581176757812
Epoch: 8, Steps: 245 | Train Loss: 0.6932679 Vali Loss: 0.6327102 Best vali loss: 0.6031510

best validation loss 0.6031509713683069

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7686716
	speed: 0.0108s/iter; left time: 9.6016s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 0.9408237934112549
Epoch: 1, Steps: 123 | Train Loss: 0.7686716 Vali Loss: 0.6046229 Best vali loss: 0.6046229
	iters: 100, epoch: 2 | loss: 0.8970559
	speed: 0.0078s/iter; left time: 5.9073s
Updating learning rate to 0.00025591859596019184
Epoch: 2 cost time: 0.6165626049041748
Epoch: 2, Steps: 123 | Train Loss: 0.8970559 Vali Loss: 0.6333415 Best vali loss: 0.6046229
	iters: 100, epoch: 3 | loss: 0.9366204
	speed: 0.0077s/iter; left time: 4.9488s
Updating learning rate to 0.00020728310997765554
Validation loss decreased (0.6046 --> 0.5497).  Saving model state dict ...
Epoch: 3 cost time: 0.5875539779663086
Epoch: 3, Steps: 123 | Train Loss: 0.9366204 Vali Loss: 0.5496985 Best vali loss: 0.5496985

best validation loss 0.5496985413089277

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0181175
	speed: 0.0101s/iter; left time: 8.9393s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.5939).  Saving model state dict ...
Epoch: 1 cost time: 0.8379898071289062
Epoch: 1, Steps: 123 | Train Loss: 1.0181175 Vali Loss: 0.5939284 Best vali loss: 0.5939284
	iters: 100, epoch: 2 | loss: 0.8088952
	speed: 0.0066s/iter; left time: 5.0429s
Updating learning rate to 0.00177094465065
Validation loss decreased (0.5939 --> 0.5703).  Saving model state dict ...
Epoch: 2 cost time: 0.48337554931640625
Epoch: 2, Steps: 123 | Train Loss: 0.8088952 Vali Loss: 0.5703366 Best vali loss: 0.5703366
	iters: 100, epoch: 3 | loss: 0.7560392
	speed: 0.0066s/iter; left time: 4.2410s
Updating learning rate to 0.000885472325325
Validation loss decreased (0.5703 --> 0.5694).  Saving model state dict ...
Epoch: 3 cost time: 0.4862701892852783
Epoch: 3, Steps: 123 | Train Loss: 0.7560392 Vali Loss: 0.5693668 Best vali loss: 0.5693668

best validation loss 0.5693668105545997

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2947806
	speed: 0.0112s/iter; left time: 86.8106s
	iters: 200, epoch: 1 | loss: 1.1770928
	speed: 0.0053s/iter; left time: 40.2222s
	iters: 300, epoch: 1 | loss: 0.3244324
	speed: 0.0053s/iter; left time: 39.6055s
	iters: 400, epoch: 1 | loss: 0.8843915
	speed: 0.0048s/iter; left time: 35.5851s
	iters: 500, epoch: 1 | loss: 0.5527529
	speed: 0.0049s/iter; left time: 35.9441s
	iters: 600, epoch: 1 | loss: 0.4767869
	speed: 0.0048s/iter; left time: 34.5740s
	iters: 700, epoch: 1 | loss: 1.3706264
	speed: 0.0048s/iter; left time: 34.0480s
	iters: 800, epoch: 1 | loss: 1.5961217
	speed: 0.0049s/iter; left time: 34.5228s
	iters: 900, epoch: 1 | loss: 1.6847657
	speed: 0.0050s/iter; left time: 34.8228s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.6359).  Saving model state dict ...
Epoch: 1 cost time: 5.224521160125732
Epoch: 1, Steps: 979 | Train Loss: 1.0401946 Vali Loss: 0.6359200 Best vali loss: 0.6359200
	iters: 100, epoch: 2 | loss: 1.3709850
	speed: 0.0157s/iter; left time: 105.7215s
	iters: 200, epoch: 2 | loss: 0.4571199
	speed: 0.0052s/iter; left time: 34.4067s
	iters: 300, epoch: 2 | loss: 0.8672310
	speed: 0.0051s/iter; left time: 33.6695s
	iters: 400, epoch: 2 | loss: 2.2370923
	speed: 0.0052s/iter; left time: 33.4945s
	iters: 500, epoch: 2 | loss: 0.8996482
	speed: 0.0053s/iter; left time: 33.6908s
	iters: 600, epoch: 2 | loss: 0.8620222
	speed: 0.0052s/iter; left time: 32.7354s
	iters: 700, epoch: 2 | loss: 1.3955272
	speed: 0.0053s/iter; left time: 32.3128s
	iters: 800, epoch: 2 | loss: 0.3793335
	speed: 0.0051s/iter; left time: 31.0925s
	iters: 900, epoch: 2 | loss: 0.7105541
	speed: 0.0052s/iter; left time: 30.9806s
Updating learning rate to 0.002058451742387382
Epoch: 2 cost time: 5.138848781585693
Epoch: 2, Steps: 979 | Train Loss: 1.0199460 Vali Loss: 0.6590605 Best vali loss: 0.6359200
	iters: 100, epoch: 3 | loss: 0.9161216
	speed: 0.0149s/iter; left time: 85.8312s
	iters: 200, epoch: 3 | loss: 1.0355518
	speed: 0.0046s/iter; left time: 26.2911s
	iters: 300, epoch: 3 | loss: 0.4356979
	speed: 0.0049s/iter; left time: 27.1486s
	iters: 400, epoch: 3 | loss: 0.7474685
	speed: 0.0046s/iter; left time: 25.2688s
	iters: 500, epoch: 3 | loss: 1.1950921
	speed: 0.0048s/iter; left time: 25.7160s
	iters: 600, epoch: 3 | loss: 1.4719807
	speed: 0.0047s/iter; left time: 25.0175s
	iters: 700, epoch: 3 | loss: 0.9620885
	speed: 0.0048s/iter; left time: 24.8084s
	iters: 800, epoch: 3 | loss: 0.4656336
	speed: 0.0047s/iter; left time: 24.0624s
	iters: 900, epoch: 3 | loss: 1.2270960
	speed: 0.0049s/iter; left time: 24.3343s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 4.686317682266235
Epoch: 3, Steps: 979 | Train Loss: 0.9396367 Vali Loss: 0.6468201 Best vali loss: 0.6359200

best validation loss 0.6359199542019556

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7310941
	speed: 0.0109s/iter; left time: 5.6136s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 0.9148349761962891
Epoch: 4, Steps: 123 | Train Loss: 0.7310941 Vali Loss: 0.5547161 Best vali loss: 0.5496985
	iters: 100, epoch: 5 | loss: 0.7725889
	speed: 0.0073s/iter; left time: 2.8808s
Updating learning rate to 9.254417532234449e-05
Validation loss decreased (0.5497 --> 0.5437).  Saving model state dict ...
Epoch: 5 cost time: 0.5779027938842773
Epoch: 5, Steps: 123 | Train Loss: 0.7725889 Vali Loss: 0.5437308 Best vali loss: 0.5437308
	iters: 100, epoch: 6 | loss: 0.8646739
	speed: 0.0075s/iter; left time: 2.0144s
Updating learning rate to 4.3908689339808184e-05
Validation loss decreased (0.5437 --> 0.5389).  Saving model state dict ...
Epoch: 6 cost time: 0.5663790702819824
Epoch: 6, Steps: 123 | Train Loss: 0.8646739 Vali Loss: 0.5388921 Best vali loss: 0.5388921
	iters: 100, epoch: 7 | loss: 0.5771760
	speed: 0.0075s/iter; left time: 1.0955s
Updating learning rate to 1.1411496561453903e-05
Validation loss decreased (0.5389 --> 0.5358).  Saving model state dict ...
Epoch: 7 cost time: 0.5716738700866699
Epoch: 7, Steps: 123 | Train Loss: 0.5771760 Vali Loss: 0.5357898 Best vali loss: 0.5357898
	iters: 100, epoch: 8 | loss: 0.8826732
	speed: 0.0074s/iter; left time: 0.1768s
Updating learning rate to 0.0
Validation loss decreased (0.5358 --> 0.5342).  Saving model state dict ...
Epoch: 8 cost time: 0.5739030838012695
Epoch: 8, Steps: 123 | Train Loss: 0.8826732 Vali Loss: 0.5341616 Best vali loss: 0.5341616

best validation loss 0.5341616446416944

[INFO][abstract_intensifier.py:595] Added config 134b22 and rejected config c221ed as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2142504
	speed: 0.0096s/iter; left time: 36.8650s
	iters: 200, epoch: 1 | loss: 0.3115785
	speed: 0.0033s/iter; left time: 12.0950s
	iters: 300, epoch: 1 | loss: 1.2031573
	speed: 0.0034s/iter; left time: 12.2787s
	iters: 400, epoch: 1 | loss: 0.6073759
	speed: 0.0033s/iter; left time: 11.5573s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 1.9742414951324463
Epoch: 1, Steps: 490 | Train Loss: 0.8340905 Vali Loss: 0.6124947 Best vali loss: 0.6124947
	iters: 100, epoch: 2 | loss: 0.5984302
	speed: 0.0093s/iter; left time: 31.1368s
	iters: 200, epoch: 2 | loss: 0.5529146
	speed: 0.0032s/iter; left time: 10.3175s
	iters: 300, epoch: 2 | loss: 1.0785213
	speed: 0.0032s/iter; left time: 9.9254s
	iters: 400, epoch: 2 | loss: 0.8262918
	speed: 0.0032s/iter; left time: 9.7577s
Updating learning rate to 0.0001296388417
Validation loss decreased (0.6125 --> 0.6090).  Saving model state dict ...
Epoch: 2 cost time: 1.622319221496582
Epoch: 2, Steps: 490 | Train Loss: 0.7640395 Vali Loss: 0.6089722 Best vali loss: 0.6089722
	iters: 100, epoch: 3 | loss: 0.8964269
	speed: 0.0097s/iter; left time: 27.6462s
	iters: 200, epoch: 3 | loss: 0.8805773
	speed: 0.0034s/iter; left time: 9.2855s
	iters: 300, epoch: 3 | loss: 0.5533971
	speed: 0.0033s/iter; left time: 8.7486s
	iters: 400, epoch: 3 | loss: 0.8631372
	speed: 0.0033s/iter; left time: 8.2732s
Updating learning rate to 6.481942085e-05
Validation loss decreased (0.6090 --> 0.6089).  Saving model state dict ...
Epoch: 3 cost time: 1.6743786334991455
Epoch: 3, Steps: 490 | Train Loss: 0.7983846 Vali Loss: 0.6088775 Best vali loss: 0.6088775
	iters: 100, epoch: 4 | loss: 0.7751434
	speed: 0.0094s/iter; left time: 22.0765s
	iters: 200, epoch: 4 | loss: 1.2414687
	speed: 0.0033s/iter; left time: 7.3496s
	iters: 300, epoch: 4 | loss: 0.4078574
	speed: 0.0032s/iter; left time: 6.9116s
	iters: 400, epoch: 4 | loss: 0.7137225
	speed: 0.0032s/iter; left time: 6.5699s
Updating learning rate to 3.2409710425e-05
Validation loss decreased (0.6089 --> 0.5872).  Saving model state dict ...
Epoch: 4 cost time: 1.626781940460205
Epoch: 4, Steps: 490 | Train Loss: 0.7845480 Vali Loss: 0.5871506 Best vali loss: 0.5871506
	iters: 100, epoch: 5 | loss: 1.2497443
	speed: 0.0100s/iter; left time: 18.6735s
	iters: 200, epoch: 5 | loss: 0.9713377
	speed: 0.0038s/iter; left time: 6.7298s
	iters: 300, epoch: 5 | loss: 0.6588400
	speed: 0.0035s/iter; left time: 5.8650s
	iters: 400, epoch: 5 | loss: 0.9288181
	speed: 0.0036s/iter; left time: 5.6924s
Updating learning rate to 1.62048552125e-05
Validation loss decreased (0.5872 --> 0.5818).  Saving model state dict ...
Epoch: 5 cost time: 1.8537521362304688
Epoch: 5, Steps: 490 | Train Loss: 0.9521850 Vali Loss: 0.5818137 Best vali loss: 0.5818137
	iters: 100, epoch: 6 | loss: 0.7072774
	speed: 0.0102s/iter; left time: 13.9779s
	iters: 200, epoch: 6 | loss: 0.6289623
	speed: 0.0038s/iter; left time: 4.7713s
	iters: 300, epoch: 6 | loss: 1.4676905
	speed: 0.0037s/iter; left time: 4.3091s
	iters: 400, epoch: 6 | loss: 0.8496937
	speed: 0.0036s/iter; left time: 3.8830s
Updating learning rate to 8.10242760625e-06
Validation loss decreased (0.5818 --> 0.5740).  Saving model state dict ...
Epoch: 6 cost time: 1.8148751258850098
Epoch: 6, Steps: 490 | Train Loss: 0.9134059 Vali Loss: 0.5740159 Best vali loss: 0.5740159
	iters: 100, epoch: 7 | loss: 0.5728582
	speed: 0.0097s/iter; left time: 8.5327s
	iters: 200, epoch: 7 | loss: 0.8713029
	speed: 0.0034s/iter; left time: 2.6583s
	iters: 300, epoch: 7 | loss: 0.5836515
	speed: 0.0034s/iter; left time: 2.3225s
	iters: 400, epoch: 7 | loss: 0.6575304
	speed: 0.0034s/iter; left time: 1.9961s
Updating learning rate to 4.051213803125e-06
Validation loss decreased (0.5740 --> 0.5739).  Saving model state dict ...
Epoch: 7 cost time: 1.7197327613830566
Epoch: 7, Steps: 490 | Train Loss: 0.6713357 Vali Loss: 0.5738937 Best vali loss: 0.5738937
	iters: 100, epoch: 8 | loss: 0.5290684
	speed: 0.0096s/iter; left time: 3.7470s
	iters: 200, epoch: 8 | loss: 0.4550983
	speed: 0.0032s/iter; left time: 0.9393s
	iters: 300, epoch: 8 | loss: 0.8182865
	speed: 0.0033s/iter; left time: 0.6346s
	iters: 400, epoch: 8 | loss: 1.0137163
	speed: 0.0033s/iter; left time: 0.3023s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 1.6399469375610352
Epoch: 8, Steps: 490 | Train Loss: 0.7040424 Vali Loss: 0.5769503 Best vali loss: 0.5738937

best validation loss 0.5738937398285184

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9965124
	speed: 0.0105s/iter; left time: 9.3137s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.6984).  Saving model state dict ...
Epoch: 1 cost time: 0.8899405002593994
Epoch: 1, Steps: 123 | Train Loss: 0.9965124 Vali Loss: 0.6984230 Best vali loss: 0.6984230
	iters: 100, epoch: 2 | loss: 1.1707535
	speed: 0.0077s/iter; left time: 5.8589s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.6984 --> 0.6833).  Saving model state dict ...
Epoch: 2 cost time: 0.6190767288208008
Epoch: 2, Steps: 123 | Train Loss: 1.1707535 Vali Loss: 0.6832567 Best vali loss: 0.6832567
	iters: 100, epoch: 3 | loss: 0.6766936
	speed: 0.0075s/iter; left time: 4.8239s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.6833 --> 0.6761).  Saving model state dict ...
Epoch: 3 cost time: 0.5999960899353027
Epoch: 3, Steps: 123 | Train Loss: 0.6766936 Vali Loss: 0.6760713 Best vali loss: 0.6760713
	iters: 100, epoch: 4 | loss: 0.8914341
	speed: 0.0075s/iter; left time: 3.8611s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.6761 --> 0.6726).  Saving model state dict ...
Epoch: 4 cost time: 0.5684940814971924
Epoch: 4, Steps: 123 | Train Loss: 0.8914341 Vali Loss: 0.6725922 Best vali loss: 0.6725922
	iters: 100, epoch: 5 | loss: 0.9939275
	speed: 0.0075s/iter; left time: 2.9341s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.6726 --> 0.6709).  Saving model state dict ...
Epoch: 5 cost time: 0.587871789932251
Epoch: 5, Steps: 123 | Train Loss: 0.9939275 Vali Loss: 0.6709430 Best vali loss: 0.6709430
	iters: 100, epoch: 6 | loss: 0.7317936
	speed: 0.0075s/iter; left time: 2.0144s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.6709 --> 0.6701).  Saving model state dict ...
Epoch: 6 cost time: 0.5825362205505371
Epoch: 6, Steps: 123 | Train Loss: 0.7317936 Vali Loss: 0.6701038 Best vali loss: 0.6701038
	iters: 100, epoch: 7 | loss: 0.9887159
	speed: 0.0074s/iter; left time: 1.0936s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.6701 --> 0.6697).  Saving model state dict ...
Epoch: 7 cost time: 0.5883495807647705
Epoch: 7, Steps: 123 | Train Loss: 0.9887159 Vali Loss: 0.6697030 Best vali loss: 0.6697030
	iters: 100, epoch: 8 | loss: 0.7609451
	speed: 0.0076s/iter; left time: 0.1826s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.6697 --> 0.6695).  Saving model state dict ...
Epoch: 8 cost time: 0.6054942607879639
Epoch: 8, Steps: 123 | Train Loss: 0.7609451 Vali Loss: 0.6694974 Best vali loss: 0.6694974

best validation loss 0.669497383931675

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.6223).  Saving model state dict ...
Epoch: 1 cost time: 0.6886296272277832
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6222875 Best vali loss: 0.6222875
Updating learning rate to 0.001942790473283107
Validation loss decreased (0.6223 --> 0.6076).  Saving model state dict ...
Epoch: 2 cost time: 0.41115403175354004
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6076490 Best vali loss: 0.6076490
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 0.41991281509399414
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6386794 Best vali loss: 0.6076490

best validation loss 0.607649037761856

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.6763).  Saving model state dict ...
Epoch: 1 cost time: 0.7713062763214111
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6762806 Best vali loss: 0.6762806
Updating learning rate to 0.0001189273387
Validation loss decreased (0.6763 --> 0.6480).  Saving model state dict ...
Epoch: 2 cost time: 0.5183515548706055
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6479563 Best vali loss: 0.6479563
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.6480 --> 0.6389).  Saving model state dict ...
Epoch: 3 cost time: 0.5012080669403076
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6388536 Best vali loss: 0.6388536

best validation loss 0.6388536081828214

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 0.7580733299255371
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6165463 Best vali loss: 0.6165463
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.6165 --> 0.6075).  Saving model state dict ...
Epoch: 2 cost time: 0.42961931228637695
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6074760 Best vali loss: 0.6074760
Updating learning rate to 0.00043994959105690174
Validation loss decreased (0.6075 --> 0.6029).  Saving model state dict ...
Epoch: 3 cost time: 0.43097877502441406
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6028724 Best vali loss: 0.6028724

best validation loss 0.6028724136533476

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00031818533495
Epoch: 4 cost time: 0.7175736427307129
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6129970 Best vali loss: 0.6028724
Updating learning rate to 0.00019642107884309824
Epoch: 5 cost time: 0.4245142936706543
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6164862 Best vali loss: 0.6028724
Updating learning rate to 9.319432693274203e-05
Epoch: 6 cost time: 0.3999032974243164
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6094910 Best vali loss: 0.6028724
Updating learning rate to 2.4220416444446813e-05
Epoch: 7 cost time: 0.44334912300109863
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6092252 Best vali loss: 0.6028724
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4128861427307129
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6101283 Best vali loss: 0.6028724

best validation loss 0.6028724136533476

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1084582
	speed: 0.0103s/iter; left time: 79.9708s
	iters: 200, epoch: 1 | loss: 0.8622949
	speed: 0.0043s/iter; left time: 33.0842s
	iters: 300, epoch: 1 | loss: 1.1660788
	speed: 0.0044s/iter; left time: 33.2462s
	iters: 400, epoch: 1 | loss: 0.5435473
	speed: 0.0042s/iter; left time: 31.5495s
	iters: 500, epoch: 1 | loss: 0.9132083
	speed: 0.0043s/iter; left time: 31.2425s
	iters: 600, epoch: 1 | loss: 0.5211312
	speed: 0.0043s/iter; left time: 31.3468s
	iters: 700, epoch: 1 | loss: 0.6632494
	speed: 0.0039s/iter; left time: 27.8832s
	iters: 800, epoch: 1 | loss: 0.3020888
	speed: 0.0039s/iter; left time: 27.2315s
	iters: 900, epoch: 1 | loss: 1.1085732
	speed: 0.0037s/iter; left time: 25.8008s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 4.389577627182007
Epoch: 1, Steps: 979 | Train Loss: 0.7987367 Vali Loss: 0.6103000 Best vali loss: 0.6103000
	iters: 100, epoch: 2 | loss: 0.3808030
	speed: 0.0128s/iter; left time: 86.5625s
	iters: 200, epoch: 2 | loss: 0.4729764
	speed: 0.0037s/iter; left time: 24.9213s
	iters: 300, epoch: 2 | loss: 0.5299001
	speed: 0.0038s/iter; left time: 24.6642s
	iters: 400, epoch: 2 | loss: 0.8590503
	speed: 0.0038s/iter; left time: 24.3819s
	iters: 500, epoch: 2 | loss: 2.1809046
	speed: 0.0039s/iter; left time: 24.5940s
	iters: 600, epoch: 2 | loss: 0.8201253
	speed: 0.0038s/iter; left time: 23.9931s
	iters: 700, epoch: 2 | loss: 1.6708297
	speed: 0.0037s/iter; left time: 22.6550s
	iters: 800, epoch: 2 | loss: 1.1801846
	speed: 0.0036s/iter; left time: 21.9300s
	iters: 900, epoch: 2 | loss: 1.0200268
	speed: 0.0036s/iter; left time: 21.5488s
Updating learning rate to 0.0006127786597521479
Epoch: 2 cost time: 3.721644401550293
Epoch: 2, Steps: 979 | Train Loss: 1.0127556 Vali Loss: 0.6103732 Best vali loss: 0.6103000
	iters: 100, epoch: 3 | loss: 1.7798201
	speed: 0.0127s/iter; left time: 73.1083s
	iters: 200, epoch: 3 | loss: 1.0332028
	speed: 0.0043s/iter; left time: 24.5594s
	iters: 300, epoch: 3 | loss: 0.6971891
	speed: 0.0044s/iter; left time: 24.7421s
	iters: 400, epoch: 3 | loss: 0.3332769
	speed: 0.0041s/iter; left time: 22.3301s
	iters: 500, epoch: 3 | loss: 0.4126234
	speed: 0.0042s/iter; left time: 22.7959s
	iters: 600, epoch: 3 | loss: 0.7522967
	speed: 0.0043s/iter; left time: 22.7130s
	iters: 700, epoch: 3 | loss: 0.4381708
	speed: 0.0043s/iter; left time: 22.3050s
	iters: 800, epoch: 3 | loss: 0.7951354
	speed: 0.0042s/iter; left time: 21.4289s
	iters: 900, epoch: 3 | loss: 1.4492455
	speed: 0.0043s/iter; left time: 21.3963s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 4.234285831451416
Epoch: 3, Steps: 979 | Train Loss: 0.8545512 Vali Loss: 0.6248112 Best vali loss: 0.6103000
	iters: 100, epoch: 4 | loss: 0.2802279
	speed: 0.0137s/iter; left time: 65.7079s
	iters: 200, epoch: 4 | loss: 1.1457797
	speed: 0.0040s/iter; left time: 18.6277s
	iters: 300, epoch: 4 | loss: 0.6028035
	speed: 0.0038s/iter; left time: 17.5569s
	iters: 400, epoch: 4 | loss: 0.3426853
	speed: 0.0039s/iter; left time: 17.6540s
	iters: 500, epoch: 4 | loss: 0.2689874
	speed: 0.0040s/iter; left time: 17.6963s
	iters: 600, epoch: 4 | loss: 1.1363177
	speed: 0.0040s/iter; left time: 17.0297s
	iters: 700, epoch: 4 | loss: 0.6846808
	speed: 0.0042s/iter; left time: 17.5504s
	iters: 800, epoch: 4 | loss: 0.2751426
	speed: 0.0044s/iter; left time: 17.8525s
	iters: 900, epoch: 4 | loss: 1.2427502
	speed: 0.0044s/iter; left time: 17.6742s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 4.1078574657440186
Epoch: 4, Steps: 979 | Train Loss: 0.6643750 Vali Loss: 0.6140666 Best vali loss: 0.6103000
	iters: 100, epoch: 5 | loss: 0.2632010
	speed: 0.0136s/iter; left time: 51.8617s
	iters: 200, epoch: 5 | loss: 0.2782793
	speed: 0.0042s/iter; left time: 15.5293s
	iters: 300, epoch: 5 | loss: 1.1295005
	speed: 0.0041s/iter; left time: 14.7768s
	iters: 400, epoch: 5 | loss: 0.4500711
	speed: 0.0038s/iter; left time: 13.3770s
	iters: 500, epoch: 5 | loss: 0.9818063
	speed: 0.0038s/iter; left time: 13.0596s
	iters: 600, epoch: 5 | loss: 1.0030384
	speed: 0.0038s/iter; left time: 12.6293s
	iters: 700, epoch: 5 | loss: 0.3820696
	speed: 0.0038s/iter; left time: 12.3080s
	iters: 800, epoch: 5 | loss: 0.7979268
	speed: 0.0038s/iter; left time: 11.8070s
	iters: 900, epoch: 5 | loss: 0.2220434
	speed: 0.0038s/iter; left time: 11.4734s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 3.8815855979919434
Epoch: 5, Steps: 979 | Train Loss: 0.6119929 Vali Loss: 0.6465823 Best vali loss: 0.6103000
	iters: 100, epoch: 6 | loss: 0.6878363
	speed: 0.0125s/iter; left time: 35.5085s
	iters: 200, epoch: 6 | loss: 0.4392599
	speed: 0.0038s/iter; left time: 10.4574s
	iters: 300, epoch: 6 | loss: 0.4735303
	speed: 0.0040s/iter; left time: 10.5260s
	iters: 400, epoch: 6 | loss: 0.8113493
	speed: 0.0040s/iter; left time: 10.1336s
	iters: 500, epoch: 6 | loss: 0.6834946
	speed: 0.0040s/iter; left time: 9.8324s
	iters: 600, epoch: 6 | loss: 1.6891396
	speed: 0.0040s/iter; left time: 9.3959s
	iters: 700, epoch: 6 | loss: 0.2937052
	speed: 0.0040s/iter; left time: 9.0407s
	iters: 800, epoch: 6 | loss: 0.6895011
	speed: 0.0040s/iter; left time: 8.4961s
	iters: 900, epoch: 6 | loss: 1.0535240
	speed: 0.0039s/iter; left time: 7.9951s
Updating learning rate to 0.00010513619654785212
Epoch: 6 cost time: 3.9335062503814697
Epoch: 6, Steps: 979 | Train Loss: 0.7579267 Vali Loss: 0.6325734 Best vali loss: 0.6103000
	iters: 100, epoch: 7 | loss: 0.3419564
	speed: 0.0129s/iter; left time: 23.9998s
	iters: 200, epoch: 7 | loss: 1.0131437
	speed: 0.0040s/iter; left time: 7.1180s
	iters: 300, epoch: 7 | loss: 0.9130945
	speed: 0.0040s/iter; left time: 6.5606s
	iters: 400, epoch: 7 | loss: 0.6731836
	speed: 0.0039s/iter; left time: 6.1347s
	iters: 500, epoch: 7 | loss: 0.4049096
	speed: 0.0041s/iter; left time: 5.9509s
	iters: 600, epoch: 7 | loss: 0.5171583
	speed: 0.0042s/iter; left time: 5.6641s
	iters: 700, epoch: 7 | loss: 0.4648431
	speed: 0.0040s/iter; left time: 5.0899s
	iters: 800, epoch: 7 | loss: 0.4677816
	speed: 0.0040s/iter; left time: 4.5937s
	iters: 900, epoch: 7 | loss: 0.4476224
	speed: 0.0040s/iter; left time: 4.2755s
Updating learning rate to 2.7324007239324203e-05
Epoch: 7 cost time: 3.985556125640869
Epoch: 7, Steps: 979 | Train Loss: 0.5826326 Vali Loss: 0.6318662 Best vali loss: 0.6103000
	iters: 100, epoch: 8 | loss: 0.7547541
	speed: 0.0131s/iter; left time: 11.4892s
	iters: 200, epoch: 8 | loss: 0.5259562
	speed: 0.0038s/iter; left time: 2.9492s
	iters: 300, epoch: 8 | loss: 1.0006273
	speed: 0.0040s/iter; left time: 2.7365s
	iters: 400, epoch: 8 | loss: 1.1699715
	speed: 0.0040s/iter; left time: 2.2912s
	iters: 500, epoch: 8 | loss: 0.6481782
	speed: 0.0040s/iter; left time: 1.9134s
	iters: 600, epoch: 8 | loss: 0.9182881
	speed: 0.0038s/iter; left time: 1.4596s
	iters: 700, epoch: 8 | loss: 1.1511722
	speed: 0.0039s/iter; left time: 1.1023s
	iters: 800, epoch: 8 | loss: 0.4886137
	speed: 0.0039s/iter; left time: 0.7006s
	iters: 900, epoch: 8 | loss: 0.8319462
	speed: 0.0041s/iter; left time: 0.3251s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8990278244018555
Epoch: 8, Steps: 979 | Train Loss: 0.8321675 Vali Loss: 0.6356963 Best vali loss: 0.6103000

best validation loss 0.6103000158322514

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6436985
	speed: 0.0084s/iter; left time: 64.9899s
	iters: 200, epoch: 1 | loss: 1.9221265
	speed: 0.0025s/iter; left time: 18.7426s
	iters: 300, epoch: 1 | loss: 1.3425049
	speed: 0.0024s/iter; left time: 18.4410s
	iters: 400, epoch: 1 | loss: 0.2516271
	speed: 0.0025s/iter; left time: 18.5149s
	iters: 500, epoch: 1 | loss: 0.2561888
	speed: 0.0024s/iter; left time: 17.6024s
	iters: 600, epoch: 1 | loss: 0.5322934
	speed: 0.0023s/iter; left time: 16.4876s
	iters: 700, epoch: 1 | loss: 0.4750108
	speed: 0.0023s/iter; left time: 16.3449s
	iters: 800, epoch: 1 | loss: 0.5271846
	speed: 0.0023s/iter; left time: 16.1290s
	iters: 900, epoch: 1 | loss: 0.5795394
	speed: 0.0023s/iter; left time: 15.8262s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.6182).  Saving model state dict ...
Epoch: 1 cost time: 2.6548852920532227
Epoch: 1, Steps: 979 | Train Loss: 0.7255749 Vali Loss: 0.6182395 Best vali loss: 0.6182395
	iters: 100, epoch: 2 | loss: 0.6307780
	speed: 0.0085s/iter; left time: 57.3001s
	iters: 200, epoch: 2 | loss: 1.1937897
	speed: 0.0023s/iter; left time: 15.4055s
	iters: 300, epoch: 2 | loss: 1.1436729
	speed: 0.0023s/iter; left time: 14.8579s
	iters: 400, epoch: 2 | loss: 1.5956316
	speed: 0.0023s/iter; left time: 14.7629s
	iters: 500, epoch: 2 | loss: 0.7273771
	speed: 0.0023s/iter; left time: 14.5971s
	iters: 600, epoch: 2 | loss: 1.1725109
	speed: 0.0023s/iter; left time: 14.6254s
	iters: 700, epoch: 2 | loss: 0.4870457
	speed: 0.0023s/iter; left time: 13.9070s
	iters: 800, epoch: 2 | loss: 0.9118534
	speed: 0.0022s/iter; left time: 13.5702s
	iters: 900, epoch: 2 | loss: 1.2767653
	speed: 0.0022s/iter; left time: 12.9910s
Updating learning rate to 0.0004712667668926594
Validation loss decreased (0.6182 --> 0.6095).  Saving model state dict ...
Epoch: 2 cost time: 2.2698400020599365
Epoch: 2, Steps: 979 | Train Loss: 1.0154916 Vali Loss: 0.6094883 Best vali loss: 0.6094883
	iters: 100, epoch: 3 | loss: 0.9158788
	speed: 0.0088s/iter; left time: 50.7512s
	iters: 200, epoch: 3 | loss: 0.3385869
	speed: 0.0026s/iter; left time: 14.8602s
	iters: 300, epoch: 3 | loss: 0.6318110
	speed: 0.0026s/iter; left time: 14.5344s
	iters: 400, epoch: 3 | loss: 1.3767120
	speed: 0.0026s/iter; left time: 14.1335s
	iters: 500, epoch: 3 | loss: 1.1763732
	speed: 0.0026s/iter; left time: 13.9782s
	iters: 600, epoch: 3 | loss: 0.7081573
	speed: 0.0026s/iter; left time: 13.8622s
	iters: 700, epoch: 3 | loss: 0.2912636
	speed: 0.0025s/iter; left time: 13.0261s
	iters: 800, epoch: 3 | loss: 1.2997706
	speed: 0.0022s/iter; left time: 11.3169s
	iters: 900, epoch: 3 | loss: 0.6232018
	speed: 0.0023s/iter; left time: 11.6198s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 2.49861741065979
Epoch: 3, Steps: 979 | Train Loss: 0.8179728 Vali Loss: 0.6304665 Best vali loss: 0.6094883
	iters: 100, epoch: 4 | loss: 0.3605511
	speed: 0.0086s/iter; left time: 41.3055s
	iters: 200, epoch: 4 | loss: 0.3815477
	speed: 0.0023s/iter; left time: 10.9001s
	iters: 300, epoch: 4 | loss: 1.0473745
	speed: 0.0024s/iter; left time: 11.1921s
	iters: 400, epoch: 4 | loss: 1.4896612
	speed: 0.0023s/iter; left time: 10.2141s
	iters: 500, epoch: 4 | loss: 0.4154412
	speed: 0.0022s/iter; left time: 9.4595s
	iters: 600, epoch: 4 | loss: 0.8108490
	speed: 0.0022s/iter; left time: 9.4538s
	iters: 700, epoch: 4 | loss: 0.9971303
	speed: 0.0022s/iter; left time: 9.1970s
	iters: 800, epoch: 4 | loss: 0.4711881
	speed: 0.0022s/iter; left time: 9.1946s
	iters: 900, epoch: 4 | loss: 0.6564723
	speed: 0.0022s/iter; left time: 8.8684s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 2.2427515983581543
Epoch: 4, Steps: 979 | Train Loss: 0.7366906 Vali Loss: 0.6729118 Best vali loss: 0.6094883
	iters: 100, epoch: 5 | loss: 1.0170971
	speed: 0.0084s/iter; left time: 31.8962s
	iters: 200, epoch: 5 | loss: 0.3395461
	speed: 0.0022s/iter; left time: 8.3620s
	iters: 300, epoch: 5 | loss: 0.4868139
	speed: 0.0023s/iter; left time: 8.3438s
	iters: 400, epoch: 5 | loss: 0.9427074
	speed: 0.0022s/iter; left time: 7.7360s
	iters: 500, epoch: 5 | loss: 0.7888041
	speed: 0.0022s/iter; left time: 7.4804s
	iters: 600, epoch: 5 | loss: 0.5029517
	speed: 0.0022s/iter; left time: 7.2707s
	iters: 700, epoch: 5 | loss: 0.8908352
	speed: 0.0024s/iter; left time: 7.6329s
	iters: 800, epoch: 5 | loss: 0.4640659
	speed: 0.0022s/iter; left time: 6.9970s
	iters: 900, epoch: 5 | loss: 0.6302120
	speed: 0.0022s/iter; left time: 6.5546s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 2.2437963485717773
Epoch: 5, Steps: 979 | Train Loss: 0.6736704 Vali Loss: 0.6693220 Best vali loss: 0.6094883
	iters: 100, epoch: 6 | loss: 0.2525549
	speed: 0.0084s/iter; left time: 23.8256s
	iters: 200, epoch: 6 | loss: 0.3800356
	speed: 0.0022s/iter; left time: 6.1033s
	iters: 300, epoch: 6 | loss: 0.9650003
	speed: 0.0022s/iter; left time: 5.8870s
	iters: 400, epoch: 6 | loss: 0.5228025
	speed: 0.0022s/iter; left time: 5.4764s
	iters: 500, epoch: 6 | loss: 1.4078010
	speed: 0.0024s/iter; left time: 5.7893s
	iters: 600, epoch: 6 | loss: 0.6222257
	speed: 0.0022s/iter; left time: 5.1880s
	iters: 700, epoch: 6 | loss: 1.5395285
	speed: 0.0022s/iter; left time: 4.9386s
	iters: 800, epoch: 6 | loss: 0.9433671
	speed: 0.0022s/iter; left time: 4.6614s
	iters: 900, epoch: 6 | loss: 0.4053880
	speed: 0.0022s/iter; left time: 4.5171s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 2.233144760131836
Epoch: 6, Steps: 979 | Train Loss: 0.7820782 Vali Loss: 0.6723934 Best vali loss: 0.6094883
	iters: 100, epoch: 7 | loss: 0.9007948
	speed: 0.0089s/iter; left time: 16.5006s
	iters: 200, epoch: 7 | loss: 0.3790748
	speed: 0.0025s/iter; left time: 4.3206s
	iters: 300, epoch: 7 | loss: 0.3661297
	speed: 0.0026s/iter; left time: 4.2356s
	iters: 400, epoch: 7 | loss: 0.5361819
	speed: 0.0024s/iter; left time: 3.8112s
	iters: 500, epoch: 7 | loss: 0.4226087
	speed: 0.0024s/iter; left time: 3.5285s
	iters: 600, epoch: 7 | loss: 0.2509350
	speed: 0.0024s/iter; left time: 3.3126s
	iters: 700, epoch: 7 | loss: 0.3514245
	speed: 0.0024s/iter; left time: 3.0462s
	iters: 800, epoch: 7 | loss: 1.2442417
	speed: 0.0024s/iter; left time: 2.8151s
	iters: 900, epoch: 7 | loss: 0.4846742
	speed: 0.0024s/iter; left time: 2.5591s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 2.441347360610962
Epoch: 7, Steps: 979 | Train Loss: 0.5484517 Vali Loss: 0.6715852 Best vali loss: 0.6094883
	iters: 100, epoch: 8 | loss: 0.8750940
	speed: 0.0090s/iter; left time: 7.9551s
	iters: 200, epoch: 8 | loss: 0.6744947
	speed: 0.0026s/iter; left time: 2.0221s
	iters: 300, epoch: 8 | loss: 0.6104396
	speed: 0.0026s/iter; left time: 1.7784s
	iters: 400, epoch: 8 | loss: 1.3869405
	speed: 0.0026s/iter; left time: 1.5055s
	iters: 500, epoch: 8 | loss: 0.2914342
	speed: 0.0026s/iter; left time: 1.2496s
	iters: 600, epoch: 8 | loss: 0.6752281
	speed: 0.0027s/iter; left time: 1.0090s
	iters: 700, epoch: 8 | loss: 0.4959309
	speed: 0.0026s/iter; left time: 0.7381s
	iters: 800, epoch: 8 | loss: 0.7238008
	speed: 0.0025s/iter; left time: 0.4586s
	iters: 900, epoch: 8 | loss: 0.8959789
	speed: 0.0025s/iter; left time: 0.2040s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5616111755371094
Epoch: 8, Steps: 979 | Train Loss: 0.7365935 Vali Loss: 0.6668477 Best vali loss: 0.6094883

best validation loss 0.6094882956316823

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5661674
	speed: 0.0085s/iter; left time: 32.4355s
	iters: 200, epoch: 1 | loss: 0.9160898
	speed: 0.0027s/iter; left time: 10.1334s
	iters: 300, epoch: 1 | loss: 0.8161222
	speed: 0.0028s/iter; left time: 10.0573s
	iters: 400, epoch: 1 | loss: 0.8699655
	speed: 0.0028s/iter; left time: 9.7148s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 1.677123785018921
Epoch: 1, Steps: 490 | Train Loss: 0.7920862 Vali Loss: 0.6012181 Best vali loss: 0.6012181
	iters: 100, epoch: 2 | loss: 1.3893591
	speed: 0.0081s/iter; left time: 27.1161s
	iters: 200, epoch: 2 | loss: 1.1185529
	speed: 0.0027s/iter; left time: 8.8074s
	iters: 300, epoch: 2 | loss: 1.0964116
	speed: 0.0027s/iter; left time: 8.5931s
	iters: 400, epoch: 2 | loss: 0.7166560
	speed: 0.0027s/iter; left time: 8.2192s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 1.3686189651489258
Epoch: 2, Steps: 490 | Train Loss: 1.0802449 Vali Loss: 0.6035875 Best vali loss: 0.6012181
	iters: 100, epoch: 3 | loss: 0.6872299
	speed: 0.0079s/iter; left time: 22.3510s
	iters: 200, epoch: 3 | loss: 1.3274575
	speed: 0.0027s/iter; left time: 7.4232s
	iters: 300, epoch: 3 | loss: 1.2026047
	speed: 0.0027s/iter; left time: 7.2067s
	iters: 400, epoch: 3 | loss: 0.8849210
	speed: 0.0027s/iter; left time: 6.9309s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 1.3702685832977295
Epoch: 3, Steps: 490 | Train Loss: 1.0255533 Vali Loss: 0.6105162 Best vali loss: 0.6012181

best validation loss 0.6012181003079377

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5108238
	speed: 0.0113s/iter; left time: 43.2016s
	iters: 200, epoch: 1 | loss: 0.9325484
	speed: 0.0053s/iter; left time: 19.8196s
	iters: 300, epoch: 1 | loss: 0.5597626
	speed: 0.0053s/iter; left time: 19.2816s
	iters: 400, epoch: 1 | loss: 0.9897861
	speed: 0.0053s/iter; left time: 18.8184s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.6678).  Saving model state dict ...
Epoch: 1 cost time: 2.946920156478882
Epoch: 1, Steps: 490 | Train Loss: 0.7482302 Vali Loss: 0.6677508 Best vali loss: 0.6677508
	iters: 100, epoch: 2 | loss: 1.2591417
	speed: 0.0138s/iter; left time: 46.0134s
	iters: 200, epoch: 2 | loss: 1.6385523
	speed: 0.0050s/iter; left time: 16.0290s
	iters: 300, epoch: 2 | loss: 1.0871434
	speed: 0.0049s/iter; left time: 15.2823s
	iters: 400, epoch: 2 | loss: 0.8811885
	speed: 0.0049s/iter; left time: 14.7423s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.6678 --> 0.6453).  Saving model state dict ...
Epoch: 2 cost time: 2.4546167850494385
Epoch: 2, Steps: 490 | Train Loss: 1.2165065 Vali Loss: 0.6452860 Best vali loss: 0.6452860
	iters: 100, epoch: 3 | loss: 0.7517353
	speed: 0.0137s/iter; left time: 38.9679s
	iters: 200, epoch: 3 | loss: 0.6083009
	speed: 0.0050s/iter; left time: 13.6084s
	iters: 300, epoch: 3 | loss: 0.8395465
	speed: 0.0048s/iter; left time: 12.7864s
	iters: 400, epoch: 3 | loss: 0.5254798
	speed: 0.0045s/iter; left time: 11.5236s
Updating learning rate to 0.0008955266062
Validation loss decreased (0.6453 --> 0.6418).  Saving model state dict ...
Epoch: 3 cost time: 2.435948610305786
Epoch: 3, Steps: 490 | Train Loss: 0.6812656 Vali Loss: 0.6417598 Best vali loss: 0.6417598

best validation loss 0.6417597747687552

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1635789
	speed: 0.0128s/iter; left time: 11.3671s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.5920).  Saving model state dict ...
Epoch: 1 cost time: 1.1746792793273926
Epoch: 1, Steps: 123 | Train Loss: 1.1635789 Vali Loss: 0.5920095 Best vali loss: 0.5920095
	iters: 100, epoch: 2 | loss: 0.6821885
	speed: 0.0103s/iter; left time: 7.8677s
Updating learning rate to 0.00034351639665
Validation loss decreased (0.5920 --> 0.5694).  Saving model state dict ...
Epoch: 2 cost time: 0.8509984016418457
Epoch: 2, Steps: 123 | Train Loss: 0.6821885 Vali Loss: 0.5694175 Best vali loss: 0.5694175
	iters: 100, epoch: 3 | loss: 0.6645490
	speed: 0.0106s/iter; left time: 6.7606s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.5694 --> 0.5625).  Saving model state dict ...
Epoch: 3 cost time: 0.8655776977539062
Epoch: 3, Steps: 123 | Train Loss: 0.6645490 Vali Loss: 0.5625092 Best vali loss: 0.5625092

best validation loss 0.5625091572979544

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0466343
	speed: 0.0130s/iter; left time: 6.7197s
Updating learning rate to 8.58790991625e-05
Validation loss decreased (0.5625 --> 0.5537).  Saving model state dict ...
Epoch: 4 cost time: 1.1764700412750244
Epoch: 4, Steps: 123 | Train Loss: 1.0466343 Vali Loss: 0.5537435 Best vali loss: 0.5537435
	iters: 100, epoch: 5 | loss: 0.6060642
	speed: 0.0104s/iter; left time: 4.0815s
Updating learning rate to 4.293954958125e-05
Validation loss decreased (0.5537 --> 0.5472).  Saving model state dict ...
Epoch: 5 cost time: 0.8448562622070312
Epoch: 5, Steps: 123 | Train Loss: 0.6060642 Vali Loss: 0.5472048 Best vali loss: 0.5472048
	iters: 100, epoch: 6 | loss: 0.5957392
	speed: 0.0103s/iter; left time: 2.7723s
Updating learning rate to 2.1469774790625e-05
Validation loss decreased (0.5472 --> 0.5444).  Saving model state dict ...
Epoch: 6 cost time: 0.8424046039581299
Epoch: 6, Steps: 123 | Train Loss: 0.5957392 Vali Loss: 0.5443735 Best vali loss: 0.5443735
	iters: 100, epoch: 7 | loss: 0.7039579
	speed: 0.0103s/iter; left time: 1.5118s
Updating learning rate to 1.07348873953125e-05
Epoch: 7 cost time: 0.8444976806640625
Epoch: 7, Steps: 123 | Train Loss: 0.7039579 Vali Loss: 0.5467833 Best vali loss: 0.5443735
	iters: 100, epoch: 8 | loss: 0.7371955
	speed: 0.0099s/iter; left time: 0.2373s
Updating learning rate to 5.36744369765625e-06
Epoch: 8 cost time: 0.815222978591919
Epoch: 8, Steps: 123 | Train Loss: 0.7371955 Vali Loss: 0.5500362 Best vali loss: 0.5443735

best validation loss 0.5443735164329444

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6602128
	speed: 0.0096s/iter; left time: 8.4598s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.6191).  Saving model state dict ...
Epoch: 1 cost time: 0.7714180946350098
Epoch: 1, Steps: 123 | Train Loss: 0.6602128 Vali Loss: 0.6191283 Best vali loss: 0.6191283
	iters: 100, epoch: 2 | loss: 0.6847517
	speed: 0.0063s/iter; left time: 4.8360s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.6191 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.4897322654724121
Epoch: 2, Steps: 123 | Train Loss: 0.6847517 Vali Loss: 0.6064947 Best vali loss: 0.6064947
	iters: 100, epoch: 3 | loss: 0.7370410
	speed: 0.0066s/iter; left time: 4.2028s
Updating learning rate to 0.00028411015875079426
Validation loss decreased (0.6065 --> 0.6027).  Saving model state dict ...
Epoch: 3 cost time: 0.47988176345825195
Epoch: 3, Steps: 123 | Train Loss: 0.7370410 Vali Loss: 0.6026633 Best vali loss: 0.6026633
	iters: 100, epoch: 4 | loss: 0.8646846
	speed: 0.0065s/iter; left time: 3.3563s
Updating learning rate to 0.00020547737255
Validation loss decreased (0.6027 --> 0.5983).  Saving model state dict ...
Epoch: 4 cost time: 0.4893836975097656
Epoch: 4, Steps: 123 | Train Loss: 0.8646846 Vali Loss: 0.5982759 Best vali loss: 0.5982759
	iters: 100, epoch: 5 | loss: 0.8746138
	speed: 0.0063s/iter; left time: 2.4757s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.4769723415374756
Epoch: 5, Steps: 123 | Train Loss: 0.8746138 Vali Loss: 0.6017428 Best vali loss: 0.5982759
	iters: 100, epoch: 6 | loss: 0.8482376
	speed: 0.0067s/iter; left time: 1.8019s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 0.4910573959350586
Epoch: 6, Steps: 123 | Train Loss: 0.8482376 Vali Loss: 0.6070731 Best vali loss: 0.5982759
	iters: 100, epoch: 7 | loss: 0.7728876
	speed: 0.0066s/iter; left time: 0.9656s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.5029358863830566
Epoch: 7, Steps: 123 | Train Loss: 0.7728876 Vali Loss: 0.6064009 Best vali loss: 0.5982759
	iters: 100, epoch: 8 | loss: 0.6924056
	speed: 0.0066s/iter; left time: 0.1581s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4774472713470459
Epoch: 8, Steps: 123 | Train Loss: 0.6924056 Vali Loss: 0.6069450 Best vali loss: 0.5982759

best validation loss 0.5982758995561013

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7612794
	speed: 0.0089s/iter; left time: 16.5564s
	iters: 200, epoch: 1 | loss: 0.7883686
	speed: 0.0029s/iter; left time: 5.1336s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.6185).  Saving model state dict ...
Epoch: 1 cost time: 1.0552828311920166
Epoch: 1, Steps: 245 | Train Loss: 0.7748240 Vali Loss: 0.6185281 Best vali loss: 0.6185281
	iters: 100, epoch: 2 | loss: 0.8037022
	speed: 0.0069s/iter; left time: 11.1011s
	iters: 200, epoch: 2 | loss: 1.0350244
	speed: 0.0030s/iter; left time: 4.5248s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 0.7826385498046875
Epoch: 2, Steps: 245 | Train Loss: 0.9193633 Vali Loss: 0.6399950 Best vali loss: 0.6185281
	iters: 100, epoch: 3 | loss: 1.1117392
	speed: 0.0065s/iter; left time: 8.9631s
	iters: 200, epoch: 3 | loss: 0.7803931
	speed: 0.0029s/iter; left time: 3.7174s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 0.7688844203948975
Epoch: 3, Steps: 245 | Train Loss: 0.9460661 Vali Loss: 0.6452626 Best vali loss: 0.6185281
	iters: 100, epoch: 4 | loss: 0.7641377
	speed: 0.0066s/iter; left time: 7.4769s
	iters: 200, epoch: 4 | loss: 0.6601235
	speed: 0.0033s/iter; left time: 3.3778s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 0.8211727142333984
Epoch: 4, Steps: 245 | Train Loss: 0.7121306 Vali Loss: 0.6268218 Best vali loss: 0.6185281
	iters: 100, epoch: 5 | loss: 1.0479126
	speed: 0.0065s/iter; left time: 5.7625s
	iters: 200, epoch: 5 | loss: 0.6668214
	speed: 0.0030s/iter; left time: 2.3516s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 0.7674436569213867
Epoch: 5, Steps: 245 | Train Loss: 0.8573670 Vali Loss: 0.6512299 Best vali loss: 0.6185281
	iters: 100, epoch: 6 | loss: 0.6204154
	speed: 0.0064s/iter; left time: 4.0558s
	iters: 200, epoch: 6 | loss: 0.4801936
	speed: 0.0028s/iter; left time: 1.5200s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 0.7419326305389404
Epoch: 6, Steps: 245 | Train Loss: 0.5503045 Vali Loss: 0.6875865 Best vali loss: 0.6185281
	iters: 100, epoch: 7 | loss: 0.5884833
	speed: 0.0065s/iter; left time: 2.5258s
	iters: 200, epoch: 7 | loss: 0.5322987
	speed: 0.0030s/iter; left time: 0.8630s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 0.7711141109466553
Epoch: 7, Steps: 245 | Train Loss: 0.5603910 Vali Loss: 0.6956915 Best vali loss: 0.6185281
	iters: 100, epoch: 8 | loss: 0.3355642
	speed: 0.0066s/iter; left time: 0.9583s
	iters: 200, epoch: 8 | loss: 0.6905882
	speed: 0.0029s/iter; left time: 0.1351s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7609012126922607
Epoch: 8, Steps: 245 | Train Loss: 0.5130762 Vali Loss: 0.7072150 Best vali loss: 0.6185281

best validation loss 0.6185281433092671

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6683575
	speed: 0.0095s/iter; left time: 8.4339s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.6420).  Saving model state dict ...
Epoch: 1 cost time: 0.7864267826080322
Epoch: 1, Steps: 123 | Train Loss: 0.6683575 Vali Loss: 0.6420284 Best vali loss: 0.6420284
	iters: 100, epoch: 2 | loss: 0.6920265
	speed: 0.0064s/iter; left time: 4.8726s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.6420 --> 0.6154).  Saving model state dict ...
Epoch: 2 cost time: 0.484699010848999
Epoch: 2, Steps: 123 | Train Loss: 0.6920265 Vali Loss: 0.6153754 Best vali loss: 0.6153754
	iters: 100, epoch: 3 | loss: 0.7403968
	speed: 0.0066s/iter; left time: 4.2359s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.6154 --> 0.6080).  Saving model state dict ...
Epoch: 3 cost time: 0.49443864822387695
Epoch: 3, Steps: 123 | Train Loss: 0.7403968 Vali Loss: 0.6079966 Best vali loss: 0.6079966

best validation loss 0.6079965788200463

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7990128
	speed: 0.0099s/iter; left time: 18.4128s
	iters: 200, epoch: 1 | loss: 0.9350414
	speed: 0.0039s/iter; left time: 6.9145s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.2985413074493408
Epoch: 1, Steps: 245 | Train Loss: 0.8670271 Vali Loss: 0.6172175 Best vali loss: 0.6172175
	iters: 100, epoch: 2 | loss: 0.9442707
	speed: 0.0080s/iter; left time: 12.8996s
	iters: 200, epoch: 2 | loss: 0.8720335
	speed: 0.0038s/iter; left time: 5.7938s
Updating learning rate to 0.000190206759
Validation loss decreased (0.6172 --> 0.5840).  Saving model state dict ...
Epoch: 2 cost time: 0.9722952842712402
Epoch: 2, Steps: 245 | Train Loss: 0.9081521 Vali Loss: 0.5839532 Best vali loss: 0.5839532
	iters: 100, epoch: 3 | loss: 0.7328448
	speed: 0.0082s/iter; left time: 11.1941s
	iters: 200, epoch: 3 | loss: 0.6012469
	speed: 0.0041s/iter; left time: 5.1714s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.5840 --> 0.5563).  Saving model state dict ...
Epoch: 3 cost time: 1.02498197555542
Epoch: 3, Steps: 245 | Train Loss: 0.6670459 Vali Loss: 0.5562787 Best vali loss: 0.5562787

best validation loss 0.5562786636171602

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1474234
	speed: 0.0090s/iter; left time: 34.3175s
	iters: 200, epoch: 1 | loss: 0.5039167
	speed: 0.0027s/iter; left time: 10.1489s
	iters: 300, epoch: 1 | loss: 0.9614487
	speed: 0.0027s/iter; left time: 9.7658s
	iters: 400, epoch: 1 | loss: 0.7409003
	speed: 0.0027s/iter; left time: 9.4283s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.6154).  Saving model state dict ...
Epoch: 1 cost time: 1.689790964126587
Epoch: 1, Steps: 490 | Train Loss: 0.8384223 Vali Loss: 0.6154177 Best vali loss: 0.6154177
	iters: 100, epoch: 2 | loss: 0.6944100
	speed: 0.0085s/iter; left time: 28.3654s
	iters: 200, epoch: 2 | loss: 0.8885027
	speed: 0.0028s/iter; left time: 8.9337s
	iters: 300, epoch: 2 | loss: 0.7889613
	speed: 0.0027s/iter; left time: 8.5771s
	iters: 400, epoch: 2 | loss: 0.8814310
	speed: 0.0027s/iter; left time: 8.1744s
Updating learning rate to 0.0009951463076058517
Epoch: 2 cost time: 1.4035882949829102
Epoch: 2, Steps: 490 | Train Loss: 0.8133262 Vali Loss: 0.6155948 Best vali loss: 0.6154177
	iters: 100, epoch: 3 | loss: 0.8993956
	speed: 0.0083s/iter; left time: 23.6810s
	iters: 200, epoch: 3 | loss: 0.8586418
	speed: 0.0027s/iter; left time: 7.4275s
	iters: 300, epoch: 3 | loss: 1.0369214
	speed: 0.0027s/iter; left time: 7.1323s
	iters: 400, epoch: 3 | loss: 0.6862473
	speed: 0.0027s/iter; left time: 6.8444s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 1.3836562633514404
Epoch: 3, Steps: 490 | Train Loss: 0.8703015 Vali Loss: 0.6644371 Best vali loss: 0.6154177

best validation loss 0.6154177486206965

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6749210
	speed: 0.0101s/iter; left time: 11.4145s
	iters: 200, epoch: 4 | loss: 0.6737163
	speed: 0.0040s/iter; left time: 4.1206s
Updating learning rate to 4.755168975e-05
Validation loss decreased (0.5563 --> 0.5444).  Saving model state dict ...
Epoch: 4 cost time: 1.3321716785430908
Epoch: 4, Steps: 245 | Train Loss: 0.6743187 Vali Loss: 0.5444231 Best vali loss: 0.5444231
	iters: 100, epoch: 5 | loss: 0.9042117
	speed: 0.0083s/iter; left time: 7.3023s
	iters: 200, epoch: 5 | loss: 0.6633887
	speed: 0.0038s/iter; left time: 2.9330s
Updating learning rate to 2.3775844875e-05
Validation loss decreased (0.5444 --> 0.5416).  Saving model state dict ...
Epoch: 5 cost time: 0.9853067398071289
Epoch: 5, Steps: 245 | Train Loss: 0.7838002 Vali Loss: 0.5416188 Best vali loss: 0.5416188
	iters: 100, epoch: 6 | loss: 0.7169440
	speed: 0.0087s/iter; left time: 5.5079s
	iters: 200, epoch: 6 | loss: 0.5954053
	speed: 0.0040s/iter; left time: 2.1633s
Updating learning rate to 1.18879224375e-05
Validation loss decreased (0.5416 --> 0.5392).  Saving model state dict ...
Epoch: 6 cost time: 1.0524888038635254
Epoch: 6, Steps: 245 | Train Loss: 0.6561747 Vali Loss: 0.5392276 Best vali loss: 0.5392276
	iters: 100, epoch: 7 | loss: 0.7493198
	speed: 0.0084s/iter; left time: 3.3034s
	iters: 200, epoch: 7 | loss: 0.4820168
	speed: 0.0036s/iter; left time: 1.0488s
Updating learning rate to 5.94396121875e-06
Validation loss decreased (0.5392 --> 0.5382).  Saving model state dict ...
Epoch: 7 cost time: 0.96272873878479
Epoch: 7, Steps: 245 | Train Loss: 0.6156683 Vali Loss: 0.5382339 Best vali loss: 0.5382339
	iters: 100, epoch: 8 | loss: 0.7024436
	speed: 0.0085s/iter; left time: 1.2382s
	iters: 200, epoch: 8 | loss: 1.0375055
	speed: 0.0037s/iter; left time: 0.1683s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 0.9895575046539307
Epoch: 8, Steps: 245 | Train Loss: 0.8699746 Vali Loss: 0.5399085 Best vali loss: 0.5382339

best validation loss 0.5382339091749999

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5280249
	speed: 0.0105s/iter; left time: 40.1551s
	iters: 200, epoch: 1 | loss: 0.4887058
	speed: 0.0042s/iter; left time: 15.7578s
	iters: 300, epoch: 1 | loss: 0.5283834
	speed: 0.0043s/iter; left time: 15.7399s
	iters: 400, epoch: 1 | loss: 0.4710268
	speed: 0.0041s/iter; left time: 14.4841s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.6003).  Saving model state dict ...
Epoch: 1 cost time: 2.4424474239349365
Epoch: 1, Steps: 490 | Train Loss: 0.5040352 Vali Loss: 0.6002707 Best vali loss: 0.6002707
	iters: 100, epoch: 2 | loss: 1.1971153
	speed: 0.0123s/iter; left time: 41.1046s
	iters: 200, epoch: 2 | loss: 0.8454405
	speed: 0.0046s/iter; left time: 14.8576s
	iters: 300, epoch: 2 | loss: 0.4720864
	speed: 0.0046s/iter; left time: 14.4916s
	iters: 400, epoch: 2 | loss: 0.8039364
	speed: 0.0046s/iter; left time: 13.8218s
Updating learning rate to 6.451837985e-05
Validation loss decreased (0.6003 --> 0.5931).  Saving model state dict ...
Epoch: 2 cost time: 2.301830530166626
Epoch: 2, Steps: 490 | Train Loss: 0.8296447 Vali Loss: 0.5931258 Best vali loss: 0.5931258
	iters: 100, epoch: 3 | loss: 0.5588891
	speed: 0.0126s/iter; left time: 35.9208s
	iters: 200, epoch: 3 | loss: 0.7724993
	speed: 0.0045s/iter; left time: 12.2346s
	iters: 300, epoch: 3 | loss: 0.9826672
	speed: 0.0044s/iter; left time: 11.6115s
	iters: 400, epoch: 3 | loss: 0.8260806
	speed: 0.0043s/iter; left time: 10.8571s
Updating learning rate to 3.2259189925e-05
Validation loss decreased (0.5931 --> 0.5602).  Saving model state dict ...
Epoch: 3 cost time: 2.202275276184082
Epoch: 3, Steps: 490 | Train Loss: 0.7850341 Vali Loss: 0.5601509 Best vali loss: 0.5601509
	iters: 100, epoch: 4 | loss: 0.5387688
	speed: 0.0123s/iter; left time: 28.8607s
	iters: 200, epoch: 4 | loss: 0.9562023
	speed: 0.0046s/iter; left time: 10.2782s
	iters: 300, epoch: 4 | loss: 0.8049479
	speed: 0.0045s/iter; left time: 9.6033s
	iters: 400, epoch: 4 | loss: 0.8684611
	speed: 0.0044s/iter; left time: 9.0253s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 2.2641289234161377
Epoch: 4, Steps: 490 | Train Loss: 0.7920950 Vali Loss: 0.5682635 Best vali loss: 0.5601509
	iters: 100, epoch: 5 | loss: 0.8460986
	speed: 0.0121s/iter; left time: 22.5294s
	iters: 200, epoch: 5 | loss: 0.5479888
	speed: 0.0040s/iter; left time: 6.9720s
	iters: 300, epoch: 5 | loss: 0.8754396
	speed: 0.0045s/iter; left time: 7.4865s
	iters: 400, epoch: 5 | loss: 0.7654607
	speed: 0.0042s/iter; left time: 6.4864s
Updating learning rate to 8.06479748125e-06
Validation loss decreased (0.5602 --> 0.5579).  Saving model state dict ...
Epoch: 5 cost time: 2.112868309020996
Epoch: 5, Steps: 490 | Train Loss: 0.7587469 Vali Loss: 0.5578702 Best vali loss: 0.5578702
	iters: 100, epoch: 6 | loss: 0.6219015
	speed: 0.0120s/iter; left time: 16.4420s
	iters: 200, epoch: 6 | loss: 0.6590924
	speed: 0.0041s/iter; left time: 5.1554s
	iters: 300, epoch: 6 | loss: 0.7449361
	speed: 0.0040s/iter; left time: 4.6960s
	iters: 400, epoch: 6 | loss: 1.0772507
	speed: 0.0040s/iter; left time: 4.2849s
Updating learning rate to 4.032398740625e-06
Validation loss decreased (0.5579 --> 0.5528).  Saving model state dict ...
Epoch: 6 cost time: 2.037210702896118
Epoch: 6, Steps: 490 | Train Loss: 0.7757952 Vali Loss: 0.5527819 Best vali loss: 0.5527819
	iters: 100, epoch: 7 | loss: 0.8814420
	speed: 0.0115s/iter; left time: 10.1399s
	iters: 200, epoch: 7 | loss: 0.5915195
	speed: 0.0040s/iter; left time: 3.0941s
	iters: 300, epoch: 7 | loss: 0.5025396
	speed: 0.0039s/iter; left time: 2.6815s
	iters: 400, epoch: 7 | loss: 0.4747078
	speed: 0.0041s/iter; left time: 2.3537s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 2.0141634941101074
Epoch: 7, Steps: 490 | Train Loss: 0.6125522 Vali Loss: 0.5577550 Best vali loss: 0.5527819
	iters: 100, epoch: 8 | loss: 1.0831649
	speed: 0.0116s/iter; left time: 4.5456s
	iters: 200, epoch: 8 | loss: 0.8182706
	speed: 0.0040s/iter; left time: 1.1663s
	iters: 300, epoch: 8 | loss: 0.9407285
	speed: 0.0040s/iter; left time: 0.7698s
	iters: 400, epoch: 8 | loss: 0.4973481
	speed: 0.0040s/iter; left time: 0.3649s
Updating learning rate to 1.00809968515625e-06
Validation loss decreased (0.5528 --> 0.5525).  Saving model state dict ...
Epoch: 8 cost time: 2.037860631942749
Epoch: 8, Steps: 490 | Train Loss: 0.8348780 Vali Loss: 0.5524681 Best vali loss: 0.5524681

best validation loss 0.5524681455169989

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.7445251
	speed: 0.0114s/iter; left time: 43.6507s
	iters: 200, epoch: 1 | loss: 0.6589002
	speed: 0.0050s/iter; left time: 18.7740s
	iters: 300, epoch: 1 | loss: 0.6645698
	speed: 0.0051s/iter; left time: 18.6009s
	iters: 400, epoch: 1 | loss: 0.7565520
	speed: 0.0049s/iter; left time: 17.3865s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.6282).  Saving model state dict ...
Epoch: 1 cost time: 2.8376760482788086
Epoch: 1, Steps: 490 | Train Loss: 0.9561368 Vali Loss: 0.6281972 Best vali loss: 0.6281972
	iters: 100, epoch: 2 | loss: 1.7700374
	speed: 0.0135s/iter; left time: 44.8468s
	iters: 200, epoch: 2 | loss: 0.8007645
	speed: 0.0048s/iter; left time: 15.5757s
	iters: 300, epoch: 2 | loss: 0.5037523
	speed: 0.0049s/iter; left time: 15.3755s
	iters: 400, epoch: 2 | loss: 0.6714054
	speed: 0.0049s/iter; left time: 14.9929s
Updating learning rate to 0.0007295719019739402
Validation loss decreased (0.6282 --> 0.6178).  Saving model state dict ...
Epoch: 2 cost time: 2.45572566986084
Epoch: 2, Steps: 490 | Train Loss: 0.9364899 Vali Loss: 0.6178411 Best vali loss: 0.6178411
	iters: 100, epoch: 3 | loss: 0.8498966
	speed: 0.0142s/iter; left time: 40.4533s
	iters: 200, epoch: 3 | loss: 0.4378617
	speed: 0.0053s/iter; left time: 14.4153s
	iters: 300, epoch: 3 | loss: 1.2410415
	speed: 0.0050s/iter; left time: 13.2960s
	iters: 400, epoch: 3 | loss: 0.6824055
	speed: 0.0051s/iter; left time: 12.9814s
Updating learning rate to 0.0005909220165344886
Epoch: 3 cost time: 2.600954055786133
Epoch: 3, Steps: 490 | Train Loss: 0.8028013 Vali Loss: 0.6197227 Best vali loss: 0.6178411
	iters: 100, epoch: 4 | loss: 0.5561153
	speed: 0.0138s/iter; left time: 32.5124s
	iters: 200, epoch: 4 | loss: 0.5415917
	speed: 0.0051s/iter; left time: 11.4163s
	iters: 300, epoch: 4 | loss: 1.4116375
	speed: 0.0050s/iter; left time: 10.7646s
	iters: 400, epoch: 4 | loss: 0.6048334
	speed: 0.0050s/iter; left time: 10.2909s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 2.547269344329834
Epoch: 4, Steps: 490 | Train Loss: 0.7785445 Vali Loss: 0.6222331 Best vali loss: 0.6178411
	iters: 100, epoch: 5 | loss: 0.7754602
	speed: 0.0139s/iter; left time: 25.8354s
	iters: 200, epoch: 5 | loss: 0.7628186
	speed: 0.0050s/iter; left time: 8.7994s
	iters: 300, epoch: 5 | loss: 1.2476954
	speed: 0.0049s/iter; left time: 8.2004s
	iters: 400, epoch: 5 | loss: 0.7612565
	speed: 0.0050s/iter; left time: 7.8283s
Updating learning rate to 0.00026382463436551147
Epoch: 5 cost time: 2.5007286071777344
Epoch: 5, Steps: 490 | Train Loss: 0.8868077 Vali Loss: 0.6407029 Best vali loss: 0.6178411
	iters: 100, epoch: 6 | loss: 0.8877348
	speed: 0.0136s/iter; left time: 18.6196s
	iters: 200, epoch: 6 | loss: 1.0019766
	speed: 0.0050s/iter; left time: 6.3290s
	iters: 300, epoch: 6 | loss: 0.8826704
	speed: 0.0050s/iter; left time: 5.8147s
	iters: 400, epoch: 6 | loss: 0.5130889
	speed: 0.0049s/iter; left time: 5.2862s
Updating learning rate to 0.0001251747489260597
Epoch: 6 cost time: 2.489760160446167
Epoch: 6, Steps: 490 | Train Loss: 0.8213677 Vali Loss: 0.6269657 Best vali loss: 0.6178411
	iters: 100, epoch: 7 | loss: 0.5230461
	speed: 0.0138s/iter; left time: 12.1634s
	iters: 200, epoch: 7 | loss: 0.7308386
	speed: 0.0050s/iter; left time: 3.8991s
	iters: 300, epoch: 7 | loss: 0.5384534
	speed: 0.0049s/iter; left time: 3.3595s
	iters: 400, epoch: 7 | loss: 1.7169954
	speed: 0.0050s/iter; left time: 2.9165s
Updating learning rate to 3.253185732546e-05
Epoch: 7 cost time: 2.5216286182403564
Epoch: 7, Steps: 490 | Train Loss: 0.8773334 Vali Loss: 0.6244595 Best vali loss: 0.6178411
	iters: 100, epoch: 8 | loss: 0.8411772
	speed: 0.0139s/iter; left time: 5.4207s
	iters: 200, epoch: 8 | loss: 0.8489797
	speed: 0.0050s/iter; left time: 1.4552s
	iters: 300, epoch: 8 | loss: 0.9153523
	speed: 0.0050s/iter; left time: 0.9553s
	iters: 400, epoch: 8 | loss: 0.5974488
	speed: 0.0050s/iter; left time: 0.4550s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5271553993225098
Epoch: 8, Steps: 490 | Train Loss: 0.8007395 Vali Loss: 0.6242451 Best vali loss: 0.6178411

best validation loss 0.6178411361741998

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.7045).  Saving model state dict ...
Epoch: 1 cost time: 0.7322382926940918
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7044762 Best vali loss: 0.7044762
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.7045 --> 0.6943).  Saving model state dict ...
Epoch: 2 cost time: 0.47155189514160156
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6943191 Best vali loss: 0.6943191
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.6943 --> 0.6895).  Saving model state dict ...
Epoch: 3 cost time: 0.4580531120300293
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6894892 Best vali loss: 0.6894892

best validation loss 0.6894891639927481

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3513361
	speed: 0.0106s/iter; left time: 81.8851s
	iters: 200, epoch: 1 | loss: 0.5975616
	speed: 0.0045s/iter; left time: 34.5068s
	iters: 300, epoch: 1 | loss: 0.3788374
	speed: 0.0045s/iter; left time: 33.7553s
	iters: 400, epoch: 1 | loss: 1.6165267
	speed: 0.0043s/iter; left time: 31.9654s
	iters: 500, epoch: 1 | loss: 0.7480851
	speed: 0.0044s/iter; left time: 32.1534s
	iters: 600, epoch: 1 | loss: 1.1985389
	speed: 0.0042s/iter; left time: 30.4590s
	iters: 700, epoch: 1 | loss: 1.2202945
	speed: 0.0042s/iter; left time: 30.0309s
	iters: 800, epoch: 1 | loss: 0.2595112
	speed: 0.0044s/iter; left time: 31.1695s
	iters: 900, epoch: 1 | loss: 0.3976642
	speed: 0.0044s/iter; left time: 30.5890s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.6384).  Saving model state dict ...
Epoch: 1 cost time: 4.643755674362183
Epoch: 1, Steps: 979 | Train Loss: 0.7520395 Vali Loss: 0.6383522 Best vali loss: 0.6383522
	iters: 100, epoch: 2 | loss: 0.4961691
	speed: 0.0134s/iter; left time: 90.5852s
	iters: 200, epoch: 2 | loss: 1.0352111
	speed: 0.0042s/iter; left time: 28.2364s
	iters: 300, epoch: 2 | loss: 0.9175203
	speed: 0.0044s/iter; left time: 28.9241s
	iters: 400, epoch: 2 | loss: 0.5135812
	speed: 0.0044s/iter; left time: 28.3202s
	iters: 500, epoch: 2 | loss: 0.6019516
	speed: 0.0044s/iter; left time: 27.9840s
	iters: 600, epoch: 2 | loss: 0.5962945
	speed: 0.0044s/iter; left time: 27.3615s
	iters: 700, epoch: 2 | loss: 0.8737274
	speed: 0.0044s/iter; left time: 27.3464s
	iters: 800, epoch: 2 | loss: 0.4506359
	speed: 0.0044s/iter; left time: 26.8122s
	iters: 900, epoch: 2 | loss: 0.6653984
	speed: 0.0043s/iter; left time: 25.7592s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.6384 --> 0.6068).  Saving model state dict ...
Epoch: 2 cost time: 4.299328804016113
Epoch: 2, Steps: 979 | Train Loss: 0.6833877 Vali Loss: 0.6067928 Best vali loss: 0.6067928
	iters: 100, epoch: 3 | loss: 1.7107376
	speed: 0.0129s/iter; left time: 74.4737s
	iters: 200, epoch: 3 | loss: 1.0090477
	speed: 0.0040s/iter; left time: 22.6166s
	iters: 300, epoch: 3 | loss: 0.4900504
	speed: 0.0038s/iter; left time: 21.1262s
	iters: 400, epoch: 3 | loss: 0.7375504
	speed: 0.0039s/iter; left time: 21.3489s
	iters: 500, epoch: 3 | loss: 0.8455110
	speed: 0.0042s/iter; left time: 22.8012s
	iters: 600, epoch: 3 | loss: 1.3623662
	speed: 0.0044s/iter; left time: 23.4383s
	iters: 700, epoch: 3 | loss: 1.1076038
	speed: 0.0044s/iter; left time: 22.6277s
	iters: 800, epoch: 3 | loss: 0.4581568
	speed: 0.0043s/iter; left time: 22.0652s
	iters: 900, epoch: 3 | loss: 0.4900974
	speed: 0.0045s/iter; left time: 22.2224s
Updating learning rate to 0.000253302663075
Validation loss decreased (0.6068 --> 0.6067).  Saving model state dict ...
Epoch: 3 cost time: 4.1387646198272705
Epoch: 3, Steps: 979 | Train Loss: 0.9123468 Vali Loss: 0.6066877 Best vali loss: 0.6066877

best validation loss 0.6066877227009363

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5609448
	speed: 0.0102s/iter; left time: 79.1442s
	iters: 200, epoch: 1 | loss: 0.4616673
	speed: 0.0042s/iter; left time: 32.0087s
	iters: 300, epoch: 1 | loss: 0.4590980
	speed: 0.0042s/iter; left time: 31.7168s
	iters: 400, epoch: 1 | loss: 0.6332256
	speed: 0.0043s/iter; left time: 32.1746s
	iters: 500, epoch: 1 | loss: 0.6102377
	speed: 0.0044s/iter; left time: 32.3439s
	iters: 600, epoch: 1 | loss: 0.7465973
	speed: 0.0040s/iter; left time: 29.2125s
	iters: 700, epoch: 1 | loss: 1.2587620
	speed: 0.0039s/iter; left time: 28.1322s
	iters: 800, epoch: 1 | loss: 1.6682401
	speed: 0.0038s/iter; left time: 26.9161s
	iters: 900, epoch: 1 | loss: 0.7632124
	speed: 0.0039s/iter; left time: 26.8624s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.6422).  Saving model state dict ...
Epoch: 1 cost time: 4.363044500350952
Epoch: 1, Steps: 979 | Train Loss: 0.7957761 Vali Loss: 0.6421703 Best vali loss: 0.6421703
	iters: 100, epoch: 2 | loss: 0.6467825
	speed: 0.0129s/iter; left time: 87.2164s
	iters: 200, epoch: 2 | loss: 0.3473868
	speed: 0.0039s/iter; left time: 25.6302s
	iters: 300, epoch: 2 | loss: 0.8856343
	speed: 0.0038s/iter; left time: 25.0861s
	iters: 400, epoch: 2 | loss: 0.7476214
	speed: 0.0039s/iter; left time: 25.0346s
	iters: 500, epoch: 2 | loss: 0.6907877
	speed: 0.0039s/iter; left time: 24.6192s
	iters: 600, epoch: 2 | loss: 1.5904417
	speed: 0.0039s/iter; left time: 24.1285s
	iters: 700, epoch: 2 | loss: 0.9291414
	speed: 0.0039s/iter; left time: 23.8236s
	iters: 800, epoch: 2 | loss: 0.3392234
	speed: 0.0038s/iter; left time: 23.0549s
	iters: 900, epoch: 2 | loss: 0.8144705
	speed: 0.0038s/iter; left time: 22.4748s
Updating learning rate to 0.004191537451168922
Epoch: 2 cost time: 3.816215991973877
Epoch: 2, Steps: 979 | Train Loss: 0.7768322 Vali Loss: 0.6537884 Best vali loss: 0.6421703
	iters: 100, epoch: 3 | loss: 1.0497653
	speed: 0.0127s/iter; left time: 73.1019s
	iters: 200, epoch: 3 | loss: 0.4280875
	speed: 0.0044s/iter; left time: 24.8849s
	iters: 300, epoch: 3 | loss: 0.4667214
	speed: 0.0045s/iter; left time: 24.8567s
	iters: 400, epoch: 3 | loss: 1.3590467
	speed: 0.0045s/iter; left time: 24.8131s
	iters: 500, epoch: 3 | loss: 0.8441050
	speed: 0.0043s/iter; left time: 22.9209s
	iters: 600, epoch: 3 | loss: 1.3224100
	speed: 0.0044s/iter; left time: 23.2004s
	iters: 700, epoch: 3 | loss: 0.4628425
	speed: 0.0045s/iter; left time: 23.1609s
	iters: 800, epoch: 3 | loss: 0.3789353
	speed: 0.0045s/iter; left time: 22.8481s
	iters: 900, epoch: 3 | loss: 1.0111251
	speed: 0.0044s/iter; left time: 21.9422s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 4.357008934020996
Epoch: 3, Steps: 979 | Train Loss: 0.8136710 Vali Loss: 0.6446507 Best vali loss: 0.6421703

best validation loss 0.6421702669374041

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3224714
	speed: 0.0103s/iter; left time: 49.2674s
	iters: 200, epoch: 4 | loss: 0.5741968
	speed: 0.0040s/iter; left time: 18.9988s
	iters: 300, epoch: 4 | loss: 0.3900985
	speed: 0.0039s/iter; left time: 17.7018s
	iters: 400, epoch: 4 | loss: 1.4955970
	speed: 0.0040s/iter; left time: 17.8495s
	iters: 500, epoch: 4 | loss: 0.7428774
	speed: 0.0039s/iter; left time: 17.1053s
	iters: 600, epoch: 4 | loss: 1.1885504
	speed: 0.0039s/iter; left time: 16.9297s
	iters: 700, epoch: 4 | loss: 1.2086020
	speed: 0.0038s/iter; left time: 15.9521s
	iters: 800, epoch: 4 | loss: 0.2446020
	speed: 0.0038s/iter; left time: 15.4298s
	iters: 900, epoch: 4 | loss: 0.3598434
	speed: 0.0040s/iter; left time: 16.0212s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 4.206341505050659
Epoch: 4, Steps: 979 | Train Loss: 0.7252043 Vali Loss: 0.6113074 Best vali loss: 0.6066877
	iters: 100, epoch: 5 | loss: 0.4605966
	speed: 0.0132s/iter; left time: 50.3524s
	iters: 200, epoch: 5 | loss: 0.9718550
	speed: 0.0045s/iter; left time: 16.5898s
	iters: 300, epoch: 5 | loss: 0.8537255
	speed: 0.0044s/iter; left time: 16.0349s
	iters: 400, epoch: 5 | loss: 0.3038392
	speed: 0.0043s/iter; left time: 14.9841s
	iters: 500, epoch: 5 | loss: 0.6579611
	speed: 0.0042s/iter; left time: 14.5084s
	iters: 600, epoch: 5 | loss: 0.6239565
	speed: 0.0043s/iter; left time: 14.2431s
	iters: 700, epoch: 5 | loss: 0.8280265
	speed: 0.0044s/iter; left time: 14.2921s
	iters: 800, epoch: 5 | loss: 0.4306644
	speed: 0.0044s/iter; left time: 13.8109s
	iters: 900, epoch: 5 | loss: 0.6778789
	speed: 0.0045s/iter; left time: 13.4975s
Updating learning rate to 6.332566576875e-05
Validation loss decreased (0.6067 --> 0.6019).  Saving model state dict ...
Epoch: 5 cost time: 4.32181978225708
Epoch: 5, Steps: 979 | Train Loss: 0.6453893 Vali Loss: 0.6018784 Best vali loss: 0.6018784
	iters: 100, epoch: 6 | loss: 1.7104092
	speed: 0.0137s/iter; left time: 38.9304s
	iters: 200, epoch: 6 | loss: 1.0166295
	speed: 0.0044s/iter; left time: 11.9198s
	iters: 300, epoch: 6 | loss: 0.4745589
	speed: 0.0040s/iter; left time: 10.5623s
	iters: 400, epoch: 6 | loss: 0.7247572
	speed: 0.0039s/iter; left time: 9.9328s
	iters: 500, epoch: 6 | loss: 0.8616039
	speed: 0.0040s/iter; left time: 9.7800s
	iters: 600, epoch: 6 | loss: 1.4493386
	speed: 0.0039s/iter; left time: 9.2087s
	iters: 700, epoch: 6 | loss: 1.0729947
	speed: 0.0040s/iter; left time: 8.8952s
	iters: 800, epoch: 6 | loss: 0.4304886
	speed: 0.0040s/iter; left time: 8.6404s
	iters: 900, epoch: 6 | loss: 0.4576493
	speed: 0.0040s/iter; left time: 8.2006s
Updating learning rate to 3.1662832884375e-05
Epoch: 6 cost time: 4.004295110702515
Epoch: 6, Steps: 979 | Train Loss: 0.9109366 Vali Loss: 0.6102347 Best vali loss: 0.6018784
	iters: 100, epoch: 7 | loss: 0.6201230
	speed: 0.0132s/iter; left time: 24.4621s
	iters: 200, epoch: 7 | loss: 1.1359278
	speed: 0.0045s/iter; left time: 7.8428s
	iters: 300, epoch: 7 | loss: 0.9591004
	speed: 0.0043s/iter; left time: 7.1506s
	iters: 400, epoch: 7 | loss: 0.8386663
	speed: 0.0045s/iter; left time: 6.9924s
	iters: 500, epoch: 7 | loss: 0.7139235
	speed: 0.0045s/iter; left time: 6.5179s
	iters: 600, epoch: 7 | loss: 1.0539101
	speed: 0.0044s/iter; left time: 6.0109s
	iters: 700, epoch: 7 | loss: 0.6490679
	speed: 0.0043s/iter; left time: 5.3667s
	iters: 800, epoch: 7 | loss: 0.3451806
	speed: 0.0044s/iter; left time: 5.0961s
	iters: 900, epoch: 7 | loss: 0.9211996
	speed: 0.0044s/iter; left time: 4.7039s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 4.3438332080841064
Epoch: 7, Steps: 979 | Train Loss: 0.8041221 Vali Loss: 0.6157314 Best vali loss: 0.6018784
	iters: 100, epoch: 8 | loss: 0.6615092
	speed: 0.0135s/iter; left time: 11.8494s
	iters: 200, epoch: 8 | loss: 0.8457419
	speed: 0.0044s/iter; left time: 3.4165s
	iters: 300, epoch: 8 | loss: 0.2960629
	speed: 0.0043s/iter; left time: 2.9260s
	iters: 400, epoch: 8 | loss: 0.3501222
	speed: 0.0045s/iter; left time: 2.5869s
	iters: 500, epoch: 8 | loss: 0.7738999
	speed: 0.0044s/iter; left time: 2.0984s
	iters: 600, epoch: 8 | loss: 0.8221604
	speed: 0.0043s/iter; left time: 1.6183s
	iters: 700, epoch: 8 | loss: 0.8914396
	speed: 0.0043s/iter; left time: 1.1907s
	iters: 800, epoch: 8 | loss: 0.8722168
	speed: 0.0044s/iter; left time: 0.7905s
	iters: 900, epoch: 8 | loss: 0.5122795
	speed: 0.0045s/iter; left time: 0.3600s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 4.330962657928467
Epoch: 8, Steps: 979 | Train Loss: 0.6694925 Vali Loss: 0.6137609 Best vali loss: 0.6018784

best validation loss 0.6018784110852824

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7869624
	speed: 0.0095s/iter; left time: 73.4553s
	iters: 200, epoch: 1 | loss: 1.8842272
	speed: 0.0035s/iter; left time: 26.7596s
	iters: 300, epoch: 1 | loss: 0.9156777
	speed: 0.0034s/iter; left time: 25.4705s
	iters: 400, epoch: 1 | loss: 0.5668554
	speed: 0.0035s/iter; left time: 26.0231s
	iters: 500, epoch: 1 | loss: 0.6073607
	speed: 0.0036s/iter; left time: 26.1350s
	iters: 600, epoch: 1 | loss: 0.3772707
	speed: 0.0034s/iter; left time: 24.7918s
	iters: 700, epoch: 1 | loss: 0.4204795
	speed: 0.0032s/iter; left time: 22.6813s
	iters: 800, epoch: 1 | loss: 0.5531597
	speed: 0.0031s/iter; left time: 21.8694s
	iters: 900, epoch: 1 | loss: 1.1640552
	speed: 0.0030s/iter; left time: 20.7646s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.6234).  Saving model state dict ...
Epoch: 1 cost time: 3.60618257522583
Epoch: 1, Steps: 979 | Train Loss: 0.8084498 Vali Loss: 0.6234348 Best vali loss: 0.6234348
	iters: 100, epoch: 2 | loss: 1.2078246
	speed: 0.0106s/iter; left time: 71.5957s
	iters: 200, epoch: 2 | loss: 0.9860088
	speed: 0.0030s/iter; left time: 20.2809s
	iters: 300, epoch: 2 | loss: 0.7530969
	speed: 0.0030s/iter; left time: 19.6155s
	iters: 400, epoch: 2 | loss: 0.3269463
	speed: 0.0030s/iter; left time: 19.4133s
	iters: 500, epoch: 2 | loss: 0.6658002
	speed: 0.0030s/iter; left time: 18.9903s
	iters: 600, epoch: 2 | loss: 0.8685859
	speed: 0.0030s/iter; left time: 18.8966s
	iters: 700, epoch: 2 | loss: 0.4904343
	speed: 0.0030s/iter; left time: 18.4086s
	iters: 800, epoch: 2 | loss: 0.5692296
	speed: 0.0030s/iter; left time: 18.1739s
	iters: 900, epoch: 2 | loss: 1.0133417
	speed: 0.0030s/iter; left time: 18.1103s
Updating learning rate to 0.0014756908020130246
Epoch: 2 cost time: 2.9934184551239014
Epoch: 2, Steps: 979 | Train Loss: 0.7645854 Vali Loss: 0.6249963 Best vali loss: 0.6234348
	iters: 100, epoch: 3 | loss: 0.8561957
	speed: 0.0105s/iter; left time: 60.3577s
	iters: 200, epoch: 3 | loss: 0.2729160
	speed: 0.0030s/iter; left time: 17.2249s
	iters: 300, epoch: 3 | loss: 1.6812539
	speed: 0.0031s/iter; left time: 17.1951s
	iters: 400, epoch: 3 | loss: 0.6735297
	speed: 0.0030s/iter; left time: 16.6641s
	iters: 500, epoch: 3 | loss: 0.4757822
	speed: 0.0032s/iter; left time: 17.0513s
	iters: 600, epoch: 3 | loss: 0.3764105
	speed: 0.0030s/iter; left time: 16.0057s
	iters: 700, epoch: 3 | loss: 0.7617466
	speed: 0.0031s/iter; left time: 15.8705s
	iters: 800, epoch: 3 | loss: 0.6833801
	speed: 0.0031s/iter; left time: 15.5810s
	iters: 900, epoch: 3 | loss: 0.7855031
	speed: 0.0031s/iter; left time: 15.3087s
Updating learning rate to 0.0011952463933268102
Epoch: 3 cost time: 3.0305097103118896
Epoch: 3, Steps: 979 | Train Loss: 0.7296353 Vali Loss: 0.6240530 Best vali loss: 0.6234348
	iters: 100, epoch: 4 | loss: 0.7730220
	speed: 0.0105s/iter; left time: 50.2687s
	iters: 200, epoch: 4 | loss: 0.7387361
	speed: 0.0031s/iter; left time: 14.5003s
	iters: 300, epoch: 4 | loss: 0.6404305
	speed: 0.0031s/iter; left time: 14.4502s
	iters: 400, epoch: 4 | loss: 0.7010214
	speed: 0.0032s/iter; left time: 14.1979s
	iters: 500, epoch: 4 | loss: 0.3674809
	speed: 0.0031s/iter; left time: 13.5424s
	iters: 600, epoch: 4 | loss: 0.7525488
	speed: 0.0031s/iter; left time: 13.2598s
	iters: 700, epoch: 4 | loss: 1.5208309
	speed: 0.0031s/iter; left time: 13.0102s
	iters: 800, epoch: 4 | loss: 1.0721689
	speed: 0.0031s/iter; left time: 12.6690s
	iters: 900, epoch: 4 | loss: 0.6823901
	speed: 0.0031s/iter; left time: 12.2015s
Updating learning rate to 0.00086443965795
Validation loss decreased (0.6234 --> 0.6136).  Saving model state dict ...
Epoch: 4 cost time: 3.0645604133605957
Epoch: 4, Steps: 979 | Train Loss: 0.8054033 Vali Loss: 0.6135893 Best vali loss: 0.6135893
	iters: 100, epoch: 5 | loss: 0.3428977
	speed: 0.0115s/iter; left time: 43.8177s
	iters: 200, epoch: 5 | loss: 0.5350555
	speed: 0.0032s/iter; left time: 11.7316s
	iters: 300, epoch: 5 | loss: 0.7790213
	speed: 0.0030s/iter; left time: 10.9351s
	iters: 400, epoch: 5 | loss: 1.6032296
	speed: 0.0029s/iter; left time: 10.3716s
	iters: 500, epoch: 5 | loss: 1.0867966
	speed: 0.0030s/iter; left time: 10.1553s
	iters: 600, epoch: 5 | loss: 1.1561408
	speed: 0.0030s/iter; left time: 9.8286s
	iters: 700, epoch: 5 | loss: 1.0053326
	speed: 0.0030s/iter; left time: 9.7268s
	iters: 800, epoch: 5 | loss: 0.3962136
	speed: 0.0030s/iter; left time: 9.3955s
	iters: 900, epoch: 5 | loss: 0.3496681
	speed: 0.0031s/iter; left time: 9.2594s
Updating learning rate to 0.0005336329225731899
Epoch: 5 cost time: 3.0897469520568848
Epoch: 5, Steps: 979 | Train Loss: 0.8060395 Vali Loss: 0.6365578 Best vali loss: 0.6135893
	iters: 100, epoch: 6 | loss: 1.3323646
	speed: 0.0107s/iter; left time: 30.3399s
	iters: 200, epoch: 6 | loss: 1.4172211
	speed: 0.0030s/iter; left time: 8.3209s
	iters: 300, epoch: 6 | loss: 0.4883200
	speed: 0.0030s/iter; left time: 7.9767s
	iters: 400, epoch: 6 | loss: 0.9519663
	speed: 0.0030s/iter; left time: 7.5699s
	iters: 500, epoch: 6 | loss: 1.0643395
	speed: 0.0030s/iter; left time: 7.2412s
	iters: 600, epoch: 6 | loss: 1.2372611
	speed: 0.0030s/iter; left time: 6.9546s
	iters: 700, epoch: 6 | loss: 1.3881042
	speed: 0.0030s/iter; left time: 6.6875s
	iters: 800, epoch: 6 | loss: 1.3853953
	speed: 0.0030s/iter; left time: 6.3834s
	iters: 900, epoch: 6 | loss: 0.3497602
	speed: 0.0030s/iter; left time: 6.0676s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 2.975782632827759
Epoch: 6, Steps: 979 | Train Loss: 1.0683036 Vali Loss: 0.6242964 Best vali loss: 0.6135893
	iters: 100, epoch: 7 | loss: 0.8143049
	speed: 0.0101s/iter; left time: 18.8261s
	iters: 200, epoch: 7 | loss: 0.9513094
	speed: 0.0029s/iter; left time: 5.1678s
	iters: 300, epoch: 7 | loss: 0.4469917
	speed: 0.0030s/iter; left time: 4.9960s
	iters: 400, epoch: 7 | loss: 0.3326588
	speed: 0.0031s/iter; left time: 4.7721s
	iters: 500, epoch: 7 | loss: 0.4022051
	speed: 0.0032s/iter; left time: 4.6614s
	iters: 600, epoch: 7 | loss: 0.7785848
	speed: 0.0032s/iter; left time: 4.3283s
	iters: 700, epoch: 7 | loss: 0.3009402
	speed: 0.0031s/iter; left time: 3.8854s
	iters: 800, epoch: 7 | loss: 0.4314297
	speed: 0.0032s/iter; left time: 3.6757s
	iters: 900, epoch: 7 | loss: 0.8415952
	speed: 0.0030s/iter; left time: 3.2247s
Updating learning rate to 6.580155087893739e-05
Epoch: 7 cost time: 3.037327527999878
Epoch: 7, Steps: 979 | Train Loss: 0.5888911 Vali Loss: 0.6527419 Best vali loss: 0.6135893
	iters: 100, epoch: 8 | loss: 0.8673542
	speed: 0.0105s/iter; left time: 9.2044s
	iters: 200, epoch: 8 | loss: 0.6623871
	speed: 0.0032s/iter; left time: 2.4834s
	iters: 300, epoch: 8 | loss: 0.5265580
	speed: 0.0032s/iter; left time: 2.2043s
	iters: 400, epoch: 8 | loss: 0.3766642
	speed: 0.0031s/iter; left time: 1.7894s
	iters: 500, epoch: 8 | loss: 0.9696240
	speed: 0.0033s/iter; left time: 1.5754s
	iters: 600, epoch: 8 | loss: 0.9689035
	speed: 0.0032s/iter; left time: 1.2214s
	iters: 700, epoch: 8 | loss: 1.2272933
	speed: 0.0030s/iter; left time: 0.8474s
	iters: 800, epoch: 8 | loss: 0.9870216
	speed: 0.0031s/iter; left time: 0.5578s
	iters: 900, epoch: 8 | loss: 0.4630099
	speed: 0.0031s/iter; left time: 0.2458s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.119980573654175
Epoch: 8, Steps: 979 | Train Loss: 0.7832017 Vali Loss: 0.6576577 Best vali loss: 0.6135893

best validation loss 0.6135892594980454

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3016968
	speed: 0.0099s/iter; left time: 37.6414s
	iters: 200, epoch: 1 | loss: 0.7697039
	speed: 0.0039s/iter; left time: 14.3412s
	iters: 300, epoch: 1 | loss: 0.6770568
	speed: 0.0036s/iter; left time: 13.0996s
	iters: 400, epoch: 1 | loss: 0.8014593
	speed: 0.0035s/iter; left time: 12.2053s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.6118).  Saving model state dict ...
Epoch: 1 cost time: 2.1227409839630127
Epoch: 1, Steps: 490 | Train Loss: 0.8874792 Vali Loss: 0.6117814 Best vali loss: 0.6117814
	iters: 100, epoch: 2 | loss: 0.8451676
	speed: 0.0104s/iter; left time: 34.5610s
	iters: 200, epoch: 2 | loss: 0.7672077
	speed: 0.0038s/iter; left time: 12.1578s
	iters: 300, epoch: 2 | loss: 0.7120758
	speed: 0.0038s/iter; left time: 12.0420s
	iters: 400, epoch: 2 | loss: 0.8243380
	speed: 0.0038s/iter; left time: 11.5325s
Updating learning rate to 0.00035114641265
Epoch: 2 cost time: 1.9176156520843506
Epoch: 2, Steps: 490 | Train Loss: 0.7871973 Vali Loss: 0.6253204 Best vali loss: 0.6117814
	iters: 100, epoch: 3 | loss: 0.7468582
	speed: 0.0099s/iter; left time: 28.2538s
	iters: 200, epoch: 3 | loss: 1.0622580
	speed: 0.0033s/iter; left time: 9.0882s
	iters: 300, epoch: 3 | loss: 0.5730724
	speed: 0.0032s/iter; left time: 8.5252s
	iters: 400, epoch: 3 | loss: 0.9861863
	speed: 0.0033s/iter; left time: 8.2857s
Updating learning rate to 0.000175573206325
Epoch: 3 cost time: 1.639655351638794
Epoch: 3, Steps: 490 | Train Loss: 0.8420937 Vali Loss: 0.6192825 Best vali loss: 0.6117814
	iters: 100, epoch: 4 | loss: 0.9213895
	speed: 0.0098s/iter; left time: 23.0724s
	iters: 200, epoch: 4 | loss: 0.8906927
	speed: 0.0038s/iter; left time: 8.5288s
	iters: 300, epoch: 4 | loss: 0.6292514
	speed: 0.0038s/iter; left time: 8.2070s
	iters: 400, epoch: 4 | loss: 0.5645785
	speed: 0.0037s/iter; left time: 7.4913s
Updating learning rate to 8.77866031625e-05
Epoch: 4 cost time: 1.847200870513916
Epoch: 4, Steps: 490 | Train Loss: 0.7514780 Vali Loss: 0.6251756 Best vali loss: 0.6117814
	iters: 100, epoch: 5 | loss: 0.6692436
	speed: 0.0098s/iter; left time: 18.3256s
	iters: 200, epoch: 5 | loss: 0.6467344
	speed: 0.0031s/iter; left time: 5.5466s
	iters: 300, epoch: 5 | loss: 0.5089422
	speed: 0.0033s/iter; left time: 5.4173s
	iters: 400, epoch: 5 | loss: 0.4400151
	speed: 0.0034s/iter; left time: 5.2854s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 1.6671068668365479
Epoch: 5, Steps: 490 | Train Loss: 0.5662338 Vali Loss: 0.6305576 Best vali loss: 0.6117814
	iters: 100, epoch: 6 | loss: 0.7056263
	speed: 0.0096s/iter; left time: 13.1634s
	iters: 200, epoch: 6 | loss: 0.2664383
	speed: 0.0033s/iter; left time: 4.1537s
	iters: 300, epoch: 6 | loss: 0.4984215
	speed: 0.0033s/iter; left time: 3.8443s
	iters: 400, epoch: 6 | loss: 1.4871241
	speed: 0.0033s/iter; left time: 3.4847s
Updating learning rate to 2.1946650790625e-05
Epoch: 6 cost time: 1.6527080535888672
Epoch: 6, Steps: 490 | Train Loss: 0.7394026 Vali Loss: 0.6260412 Best vali loss: 0.6117814
	iters: 100, epoch: 7 | loss: 0.9363524
	speed: 0.0096s/iter; left time: 8.4302s
	iters: 200, epoch: 7 | loss: 0.4373276
	speed: 0.0034s/iter; left time: 2.6421s
	iters: 300, epoch: 7 | loss: 0.8441100
	speed: 0.0033s/iter; left time: 2.2594s
	iters: 400, epoch: 7 | loss: 0.9476359
	speed: 0.0033s/iter; left time: 1.8893s
Updating learning rate to 1.09733253953125e-05
Epoch: 7 cost time: 1.6735584735870361
Epoch: 7, Steps: 490 | Train Loss: 0.7913565 Vali Loss: 0.6261010 Best vali loss: 0.6117814
	iters: 100, epoch: 8 | loss: 0.7602220
	speed: 0.0094s/iter; left time: 3.6910s
	iters: 200, epoch: 8 | loss: 0.9930502
	speed: 0.0033s/iter; left time: 0.9548s
	iters: 300, epoch: 8 | loss: 1.0554156
	speed: 0.0033s/iter; left time: 0.6315s
	iters: 400, epoch: 8 | loss: 0.6617247
	speed: 0.0033s/iter; left time: 0.3006s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 1.6522715091705322
Epoch: 8, Steps: 490 | Train Loss: 0.8676031 Vali Loss: 0.6244093 Best vali loss: 0.6117814

best validation loss 0.6117814335763482

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1225199
	speed: 0.0095s/iter; left time: 36.2097s
	iters: 200, epoch: 1 | loss: 0.8586401
	speed: 0.0032s/iter; left time: 12.0320s
	iters: 300, epoch: 1 | loss: 0.9221448
	speed: 0.0033s/iter; left time: 11.8535s
	iters: 400, epoch: 1 | loss: 0.4856284
	speed: 0.0033s/iter; left time: 11.4738s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 1.9543700218200684
Epoch: 1, Steps: 490 | Train Loss: 0.8472333 Vali Loss: 0.6143520 Best vali loss: 0.6143520
	iters: 100, epoch: 2 | loss: 0.9060518
	speed: 0.0096s/iter; left time: 31.9676s
	iters: 200, epoch: 2 | loss: 0.6541671
	speed: 0.0034s/iter; left time: 11.0049s
	iters: 300, epoch: 2 | loss: 1.6566864
	speed: 0.0033s/iter; left time: 10.4241s
	iters: 400, epoch: 2 | loss: 1.0581297
	speed: 0.0033s/iter; left time: 9.9725s
Updating learning rate to 0.0001951505909
Epoch: 2 cost time: 1.6924114227294922
Epoch: 2, Steps: 490 | Train Loss: 1.0687588 Vali Loss: 0.6224058 Best vali loss: 0.6143520
	iters: 100, epoch: 3 | loss: 0.5244895
	speed: 0.0094s/iter; left time: 26.8213s
	iters: 200, epoch: 3 | loss: 0.6344822
	speed: 0.0032s/iter; left time: 8.7956s
	iters: 300, epoch: 3 | loss: 0.5238267
	speed: 0.0032s/iter; left time: 8.4241s
	iters: 400, epoch: 3 | loss: 1.3195301
	speed: 0.0032s/iter; left time: 8.1804s
Updating learning rate to 9.757529545e-05
Validation loss decreased (0.6144 --> 0.6065).  Saving model state dict ...
Epoch: 3 cost time: 1.6085302829742432
Epoch: 3, Steps: 490 | Train Loss: 0.7505821 Vali Loss: 0.6064614 Best vali loss: 0.6064614

best validation loss 0.6064613731521966

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9740961
	speed: 0.0112s/iter; left time: 9.8935s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.6991).  Saving model state dict ...
Epoch: 1 cost time: 0.9756059646606445
Epoch: 1, Steps: 123 | Train Loss: 0.9740961 Vali Loss: 0.6991325 Best vali loss: 0.6991325
	iters: 100, epoch: 2 | loss: 0.9244600
	speed: 0.0086s/iter; left time: 6.5443s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.6991 --> 0.6833).  Saving model state dict ...
Epoch: 2 cost time: 0.6991925239562988
Epoch: 2, Steps: 123 | Train Loss: 0.9244600 Vali Loss: 0.6833243 Best vali loss: 0.6833243
	iters: 100, epoch: 3 | loss: 0.8166215
	speed: 0.0087s/iter; left time: 5.5574s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.6833 --> 0.6702).  Saving model state dict ...
Epoch: 3 cost time: 0.7025954723358154
Epoch: 3, Steps: 123 | Train Loss: 0.8166215 Vali Loss: 0.6702165 Best vali loss: 0.6702165

best validation loss 0.6702164572071886

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8437455
	speed: 0.0096s/iter; left time: 36.6401s
	iters: 200, epoch: 1 | loss: 0.8308352
	speed: 0.0035s/iter; left time: 12.9102s
	iters: 300, epoch: 1 | loss: 0.7118268
	speed: 0.0033s/iter; left time: 12.1202s
	iters: 400, epoch: 1 | loss: 1.4484546
	speed: 0.0033s/iter; left time: 11.6494s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 1.9959733486175537
Epoch: 1, Steps: 490 | Train Loss: 0.9587155 Vali Loss: 0.6164607 Best vali loss: 0.6164607
	iters: 100, epoch: 2 | loss: 0.6168627
	speed: 0.0094s/iter; left time: 31.4103s
	iters: 200, epoch: 2 | loss: 0.6932133
	speed: 0.0033s/iter; left time: 10.6135s
	iters: 300, epoch: 2 | loss: 0.8161432
	speed: 0.0032s/iter; left time: 10.1542s
	iters: 400, epoch: 2 | loss: 0.9102001
	speed: 0.0032s/iter; left time: 9.8184s
Updating learning rate to 0.00017030763336576413
Validation loss decreased (0.6165 --> 0.5847).  Saving model state dict ...
Epoch: 2 cost time: 1.6368179321289062
Epoch: 2, Steps: 490 | Train Loss: 0.7591048 Vali Loss: 0.5847152 Best vali loss: 0.5847152
	iters: 100, epoch: 3 | loss: 0.9212307
	speed: 0.0096s/iter; left time: 27.3331s
	iters: 200, epoch: 3 | loss: 0.6790133
	speed: 0.0032s/iter; left time: 8.7402s
	iters: 300, epoch: 3 | loss: 0.4619488
	speed: 0.0032s/iter; left time: 8.4170s
	iters: 400, epoch: 3 | loss: 0.6773651
	speed: 0.0032s/iter; left time: 8.1500s
Updating learning rate to 0.00013794189423609193
Validation loss decreased (0.5847 --> 0.5504).  Saving model state dict ...
Epoch: 3 cost time: 1.6156070232391357
Epoch: 3, Steps: 490 | Train Loss: 0.6848895 Vali Loss: 0.5503828 Best vali loss: 0.5503828

best validation loss 0.5503828109055413

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6633658
	speed: 0.0099s/iter; left time: 23.3863s
	iters: 200, epoch: 4 | loss: 0.5667263
	speed: 0.0035s/iter; left time: 7.9304s
	iters: 300, epoch: 4 | loss: 0.6088941
	speed: 0.0037s/iter; left time: 7.9904s
	iters: 400, epoch: 4 | loss: 1.0934488
	speed: 0.0037s/iter; left time: 7.6906s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 2.152200222015381
Epoch: 4, Steps: 490 | Train Loss: 0.7331087 Vali Loss: 0.5567359 Best vali loss: 0.5503828
	iters: 100, epoch: 5 | loss: 0.5012863
	speed: 0.0102s/iter; left time: 19.0382s
	iters: 200, epoch: 5 | loss: 0.5023825
	speed: 0.0036s/iter; left time: 6.3178s
	iters: 300, epoch: 5 | loss: 0.6977221
	speed: 0.0036s/iter; left time: 6.0364s
	iters: 400, epoch: 5 | loss: 0.8124139
	speed: 0.0035s/iter; left time: 5.4601s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 1.7922766208648682
Epoch: 5, Steps: 490 | Train Loss: 0.6284512 Vali Loss: 0.5750431 Best vali loss: 0.5503828
	iters: 100, epoch: 6 | loss: 0.7934365
	speed: 0.0101s/iter; left time: 13.9063s
	iters: 200, epoch: 6 | loss: 0.5888352
	speed: 0.0036s/iter; left time: 4.5912s
	iters: 300, epoch: 6 | loss: 0.4048544
	speed: 0.0035s/iter; left time: 4.0722s
	iters: 400, epoch: 6 | loss: 0.5320092
	speed: 0.0035s/iter; left time: 3.7252s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 1.776125431060791
Epoch: 6, Steps: 490 | Train Loss: 0.5797839 Vali Loss: 0.5764439 Best vali loss: 0.5503828
	iters: 100, epoch: 7 | loss: 0.4490513
	speed: 0.0097s/iter; left time: 8.5317s
	iters: 200, epoch: 7 | loss: 0.8833134
	speed: 0.0033s/iter; left time: 2.5943s
	iters: 300, epoch: 7 | loss: 0.5418618
	speed: 0.0032s/iter; left time: 2.1651s
	iters: 400, epoch: 7 | loss: 0.6021130
	speed: 0.0032s/iter; left time: 1.8598s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 1.639737606048584
Epoch: 7, Steps: 490 | Train Loss: 0.6190849 Vali Loss: 0.5890247 Best vali loss: 0.5503828
	iters: 100, epoch: 8 | loss: 1.0533047
	speed: 0.0096s/iter; left time: 3.7563s
	iters: 200, epoch: 8 | loss: 0.6366273
	speed: 0.0033s/iter; left time: 0.9672s
	iters: 300, epoch: 8 | loss: 0.4416476
	speed: 0.0033s/iter; left time: 0.6313s
	iters: 400, epoch: 8 | loss: 0.2423613
	speed: 0.0033s/iter; left time: 0.3004s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.681182622909546
Epoch: 8, Steps: 490 | Train Loss: 0.5934852 Vali Loss: 0.5874027 Best vali loss: 0.5503828

best validation loss 0.5503828109055413

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5469100
	speed: 0.0086s/iter; left time: 32.8004s
	iters: 200, epoch: 1 | loss: 0.9099700
	speed: 0.0026s/iter; left time: 9.7876s
	iters: 300, epoch: 1 | loss: 0.8177491
	speed: 0.0026s/iter; left time: 9.2994s
	iters: 400, epoch: 1 | loss: 0.8645873
	speed: 0.0025s/iter; left time: 8.9310s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.5974).  Saving model state dict ...
Epoch: 1 cost time: 1.609955072402954
Epoch: 1, Steps: 490 | Train Loss: 0.7848041 Vali Loss: 0.5973586 Best vali loss: 0.5973586
	iters: 100, epoch: 2 | loss: 1.3767776
	speed: 0.0082s/iter; left time: 27.2944s
	iters: 200, epoch: 2 | loss: 1.1118970
	speed: 0.0027s/iter; left time: 8.7822s
	iters: 300, epoch: 2 | loss: 1.0110449
	speed: 0.0027s/iter; left time: 8.5043s
	iters: 400, epoch: 2 | loss: 0.7697318
	speed: 0.0027s/iter; left time: 8.2169s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 1.3811821937561035
Epoch: 2, Steps: 490 | Train Loss: 1.0673628 Vali Loss: 0.6065106 Best vali loss: 0.5973586
	iters: 100, epoch: 3 | loss: 0.6886570
	speed: 0.0082s/iter; left time: 23.3597s
	iters: 200, epoch: 3 | loss: 1.3202924
	speed: 0.0027s/iter; left time: 7.3475s
	iters: 300, epoch: 3 | loss: 1.2351921
	speed: 0.0026s/iter; left time: 6.7947s
	iters: 400, epoch: 3 | loss: 0.8484108
	speed: 0.0025s/iter; left time: 6.4580s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 1.3261911869049072
Epoch: 3, Steps: 490 | Train Loss: 1.0231381 Vali Loss: 0.6256551 Best vali loss: 0.5973586
	iters: 100, epoch: 4 | loss: 0.8949385
	speed: 0.0080s/iter; left time: 18.9204s
	iters: 200, epoch: 4 | loss: 0.6012453
	speed: 0.0027s/iter; left time: 6.0632s
	iters: 300, epoch: 4 | loss: 0.4619666
	speed: 0.0027s/iter; left time: 5.8074s
	iters: 400, epoch: 4 | loss: 0.8381323
	speed: 0.0027s/iter; left time: 5.5275s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 1.3628687858581543
Epoch: 4, Steps: 490 | Train Loss: 0.6990706 Vali Loss: 0.6255983 Best vali loss: 0.5973586
	iters: 100, epoch: 5 | loss: 0.5024807
	speed: 0.0080s/iter; left time: 14.8138s
	iters: 200, epoch: 5 | loss: 0.6411353
	speed: 0.0027s/iter; left time: 4.8237s
	iters: 300, epoch: 5 | loss: 1.2151924
	speed: 0.0028s/iter; left time: 4.6703s
	iters: 400, epoch: 5 | loss: 0.8006669
	speed: 0.0028s/iter; left time: 4.4230s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 1.3992598056793213
Epoch: 5, Steps: 490 | Train Loss: 0.7898689 Vali Loss: 0.6272903 Best vali loss: 0.5973586
	iters: 100, epoch: 6 | loss: 0.7332959
	speed: 0.0081s/iter; left time: 11.1428s
	iters: 200, epoch: 6 | loss: 0.8365889
	speed: 0.0027s/iter; left time: 3.3694s
	iters: 300, epoch: 6 | loss: 0.5290437
	speed: 0.0027s/iter; left time: 3.1238s
	iters: 400, epoch: 6 | loss: 0.6260394
	speed: 0.0027s/iter; left time: 2.8393s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 1.3353900909423828
Epoch: 6, Steps: 490 | Train Loss: 0.6812420 Vali Loss: 0.6506202 Best vali loss: 0.5973586
	iters: 100, epoch: 7 | loss: 0.7590489
	speed: 0.0081s/iter; left time: 7.0972s
	iters: 200, epoch: 7 | loss: 0.6061973
	speed: 0.0025s/iter; left time: 1.9880s
	iters: 300, epoch: 7 | loss: 0.3682435
	speed: 0.0026s/iter; left time: 1.7374s
	iters: 400, epoch: 7 | loss: 0.6374236
	speed: 0.0025s/iter; left time: 1.4743s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 1.3092715740203857
Epoch: 7, Steps: 490 | Train Loss: 0.5927283 Vali Loss: 0.6472083 Best vali loss: 0.5973586
	iters: 100, epoch: 8 | loss: 1.2217623
	speed: 0.0081s/iter; left time: 3.1584s
	iters: 200, epoch: 8 | loss: 0.6501502
	speed: 0.0027s/iter; left time: 0.7754s
	iters: 300, epoch: 8 | loss: 0.8304710
	speed: 0.0027s/iter; left time: 0.5153s
	iters: 400, epoch: 8 | loss: 0.4673981
	speed: 0.0025s/iter; left time: 0.2282s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3134129047393799
Epoch: 8, Steps: 490 | Train Loss: 0.7924454 Vali Loss: 0.6475901 Best vali loss: 0.5973586

best validation loss 0.5973585844591557

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9126434
	speed: 0.0097s/iter; left time: 18.0523s
	iters: 200, epoch: 1 | loss: 1.0371568
	speed: 0.0040s/iter; left time: 7.0732s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 1.3021645545959473
Epoch: 1, Steps: 245 | Train Loss: 0.9749001 Vali Loss: 0.6121161 Best vali loss: 0.6121161
	iters: 100, epoch: 2 | loss: 0.7804722
	speed: 0.0080s/iter; left time: 12.9376s
	iters: 200, epoch: 2 | loss: 0.9156274
	speed: 0.0040s/iter; left time: 6.1321s
Updating learning rate to 0.0001389884753
Epoch: 2 cost time: 1.016258955001831
Epoch: 2, Steps: 245 | Train Loss: 0.8480498 Vali Loss: 0.6123588 Best vali loss: 0.6121161
	iters: 100, epoch: 3 | loss: 0.9210566
	speed: 0.0082s/iter; left time: 11.2946s
	iters: 200, epoch: 3 | loss: 0.6525767
	speed: 0.0039s/iter; left time: 4.9515s
Updating learning rate to 6.949423765e-05
Validation loss decreased (0.6121 --> 0.5949).  Saving model state dict ...
Epoch: 3 cost time: 1.007366418838501
Epoch: 3, Steps: 245 | Train Loss: 0.7868166 Vali Loss: 0.5949089 Best vali loss: 0.5949089
	iters: 100, epoch: 4 | loss: 0.9057432
	speed: 0.0084s/iter; left time: 9.4328s
	iters: 200, epoch: 4 | loss: 0.8615676
	speed: 0.0039s/iter; left time: 4.0357s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 1.0259873867034912
Epoch: 4, Steps: 245 | Train Loss: 0.8836554 Vali Loss: 0.6053853 Best vali loss: 0.5949089
	iters: 100, epoch: 5 | loss: 0.9926251
	speed: 0.0081s/iter; left time: 7.1747s
	iters: 200, epoch: 5 | loss: 0.7335877
	speed: 0.0041s/iter; left time: 3.2217s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 1.0318269729614258
Epoch: 5, Steps: 245 | Train Loss: 0.8631064 Vali Loss: 0.6068173 Best vali loss: 0.5949089
	iters: 100, epoch: 6 | loss: 0.5084516
	speed: 0.0082s/iter; left time: 5.2078s
	iters: 200, epoch: 6 | loss: 0.5732493
	speed: 0.0038s/iter; left time: 2.0412s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 0.9970934391021729
Epoch: 6, Steps: 245 | Train Loss: 0.5408505 Vali Loss: 0.6050979 Best vali loss: 0.5949089
	iters: 100, epoch: 7 | loss: 0.6570248
	speed: 0.0079s/iter; left time: 3.0924s
	iters: 200, epoch: 7 | loss: 0.7601365
	speed: 0.0038s/iter; left time: 1.1146s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 0.9835569858551025
Epoch: 7, Steps: 245 | Train Loss: 0.7085806 Vali Loss: 0.5993775 Best vali loss: 0.5949089
	iters: 100, epoch: 8 | loss: 0.6293487
	speed: 0.0081s/iter; left time: 1.1846s
	iters: 200, epoch: 8 | loss: 0.4989414
	speed: 0.0040s/iter; left time: 0.1859s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 1.021620512008667
Epoch: 8, Steps: 245 | Train Loss: 0.5641450 Vali Loss: 0.6000512 Best vali loss: 0.5949089

best validation loss 0.5949088796759469

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5701923
	speed: 0.0113s/iter; left time: 43.3351s
	iters: 200, epoch: 1 | loss: 0.9123039
	speed: 0.0053s/iter; left time: 19.9056s
	iters: 300, epoch: 1 | loss: 0.5543014
	speed: 0.0052s/iter; left time: 18.8250s
	iters: 400, epoch: 1 | loss: 0.9930238
	speed: 0.0050s/iter; left time: 17.6059s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.6531).  Saving model state dict ...
Epoch: 1 cost time: 2.882887601852417
Epoch: 1, Steps: 490 | Train Loss: 0.7574554 Vali Loss: 0.6531041 Best vali loss: 0.6531041
	iters: 100, epoch: 2 | loss: 1.2614996
	speed: 0.0135s/iter; left time: 44.9733s
	iters: 200, epoch: 2 | loss: 1.6656134
	speed: 0.0050s/iter; left time: 16.2720s
	iters: 300, epoch: 2 | loss: 1.0848757
	speed: 0.0051s/iter; left time: 15.9823s
	iters: 400, epoch: 2 | loss: 0.8743588
	speed: 0.0049s/iter; left time: 14.7892s
Updating learning rate to 0.0024210654541
Validation loss decreased (0.6531 --> 0.6449).  Saving model state dict ...
Epoch: 2 cost time: 2.4826810359954834
Epoch: 2, Steps: 490 | Train Loss: 1.2215869 Vali Loss: 0.6448972 Best vali loss: 0.6448972
	iters: 100, epoch: 3 | loss: 0.7543312
	speed: 0.0133s/iter; left time: 37.7420s
	iters: 200, epoch: 3 | loss: 0.6092875
	speed: 0.0054s/iter; left time: 14.7969s
	iters: 300, epoch: 3 | loss: 0.8437186
	speed: 0.0054s/iter; left time: 14.2465s
	iters: 400, epoch: 3 | loss: 0.5261093
	speed: 0.0053s/iter; left time: 13.5560s
Updating learning rate to 0.00121053272705
Validation loss decreased (0.6449 --> 0.6420).  Saving model state dict ...
Epoch: 3 cost time: 2.656352996826172
Epoch: 3, Steps: 490 | Train Loss: 0.6833616 Vali Loss: 0.6419964 Best vali loss: 0.6419964

best validation loss 0.641996372441129

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.6790).  Saving model state dict ...
Epoch: 1 cost time: 0.6869800090789795
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6790325 Best vali loss: 0.6790325
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.6790 --> 0.6496).  Saving model state dict ...
Epoch: 2 cost time: 0.421741247177124
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6496326 Best vali loss: 0.6496326
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.6496 --> 0.6393).  Saving model state dict ...
Epoch: 3 cost time: 0.4340999126434326
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6392830 Best vali loss: 0.6392830

best validation loss 0.6392830228264935

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8196780
	speed: 0.0119s/iter; left time: 10.5406s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.6453).  Saving model state dict ...
Epoch: 1 cost time: 1.0815341472625732
Epoch: 1, Steps: 123 | Train Loss: 0.8196780 Vali Loss: 0.6452655 Best vali loss: 0.6452655
	iters: 100, epoch: 2 | loss: 0.6158441
	speed: 0.0097s/iter; left time: 7.3681s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.6453 --> 0.6303).  Saving model state dict ...
Epoch: 2 cost time: 0.8053135871887207
Epoch: 2, Steps: 123 | Train Loss: 0.6158441 Vali Loss: 0.6302534 Best vali loss: 0.6302534
	iters: 100, epoch: 3 | loss: 0.9642088
	speed: 0.0097s/iter; left time: 6.2059s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.6303 --> 0.6206).  Saving model state dict ...
Epoch: 3 cost time: 0.797865629196167
Epoch: 3, Steps: 123 | Train Loss: 0.9642088 Vali Loss: 0.6205734 Best vali loss: 0.6205734

best validation loss 0.6205734186070984

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7719416
	speed: 0.0119s/iter; left time: 6.1209s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.6206 --> 0.6133).  Saving model state dict ...
Epoch: 4 cost time: 1.0523343086242676
Epoch: 4, Steps: 123 | Train Loss: 0.7719416 Vali Loss: 0.6133191 Best vali loss: 0.6133191
	iters: 100, epoch: 5 | loss: 0.6048579
	speed: 0.0096s/iter; left time: 3.7576s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.6133 --> 0.6130).  Saving model state dict ...
Epoch: 5 cost time: 0.7878210544586182
Epoch: 5, Steps: 123 | Train Loss: 0.6048579 Vali Loss: 0.6130250 Best vali loss: 0.6130250
	iters: 100, epoch: 6 | loss: 0.9492203
	speed: 0.0096s/iter; left time: 2.5821s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.6130 --> 0.6128).  Saving model state dict ...
Epoch: 6 cost time: 0.798896074295044
Epoch: 6, Steps: 123 | Train Loss: 0.9492203 Vali Loss: 0.6127587 Best vali loss: 0.6127587
	iters: 100, epoch: 7 | loss: 0.7582101
	speed: 0.0096s/iter; left time: 1.4135s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.6128 --> 0.6125).  Saving model state dict ...
Epoch: 7 cost time: 0.7936129570007324
Epoch: 7, Steps: 123 | Train Loss: 0.7582101 Vali Loss: 0.6124764 Best vali loss: 0.6124764
	iters: 100, epoch: 8 | loss: 0.6598144
	speed: 0.0092s/iter; left time: 0.2214s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.6125 --> 0.6122).  Saving model state dict ...
Epoch: 8 cost time: 0.7460944652557373
Epoch: 8, Steps: 123 | Train Loss: 0.6598144 Vali Loss: 0.6121887 Best vali loss: 0.6121887

best validation loss 0.6121887004193417

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8297476
	speed: 0.0105s/iter; left time: 19.5470s
	iters: 200, epoch: 1 | loss: 0.7578320
	speed: 0.0047s/iter; left time: 8.2464s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.5926).  Saving model state dict ...
Epoch: 1 cost time: 1.4924240112304688
Epoch: 1, Steps: 245 | Train Loss: 0.7937898 Vali Loss: 0.5926248 Best vali loss: 0.5926248
	iters: 100, epoch: 2 | loss: 0.8706770
	speed: 0.0099s/iter; left time: 16.0215s
	iters: 200, epoch: 2 | loss: 0.4427856
	speed: 0.0048s/iter; left time: 7.2803s
Updating learning rate to 6.69828834e-05
Validation loss decreased (0.5926 --> 0.5797).  Saving model state dict ...
Epoch: 2 cost time: 1.2357983589172363
Epoch: 2, Steps: 245 | Train Loss: 0.6567313 Vali Loss: 0.5797294 Best vali loss: 0.5797294
	iters: 100, epoch: 3 | loss: 0.9963231
	speed: 0.0097s/iter; left time: 13.2939s
	iters: 200, epoch: 3 | loss: 0.7942613
	speed: 0.0048s/iter; left time: 6.1291s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 1.242316484451294
Epoch: 3, Steps: 245 | Train Loss: 0.8952922 Vali Loss: 0.6022060 Best vali loss: 0.5797294
	iters: 100, epoch: 4 | loss: 1.1962453
	speed: 0.0095s/iter; left time: 10.6537s
	iters: 200, epoch: 4 | loss: 0.8589458
	speed: 0.0044s/iter; left time: 4.4740s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 1.1588149070739746
Epoch: 4, Steps: 245 | Train Loss: 1.0275956 Vali Loss: 0.5966720 Best vali loss: 0.5797294
	iters: 100, epoch: 5 | loss: 0.7746086
	speed: 0.0092s/iter; left time: 8.0854s
	iters: 200, epoch: 5 | loss: 0.7275243
	speed: 0.0049s/iter; left time: 3.8076s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 1.1964256763458252
Epoch: 5, Steps: 245 | Train Loss: 0.7510664 Vali Loss: 0.5828373 Best vali loss: 0.5797294
	iters: 100, epoch: 6 | loss: 0.7407755
	speed: 0.0095s/iter; left time: 6.0456s
	iters: 200, epoch: 6 | loss: 0.8317480
	speed: 0.0047s/iter; left time: 2.5224s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 1.1946430206298828
Epoch: 6, Steps: 245 | Train Loss: 0.7862618 Vali Loss: 0.5799923 Best vali loss: 0.5797294
	iters: 100, epoch: 7 | loss: 1.0036212
	speed: 0.0091s/iter; left time: 3.5645s
	iters: 200, epoch: 7 | loss: 0.8864225
	speed: 0.0043s/iter; left time: 1.2651s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 1.1226961612701416
Epoch: 7, Steps: 245 | Train Loss: 0.9450219 Vali Loss: 0.5806356 Best vali loss: 0.5797294
	iters: 100, epoch: 8 | loss: 0.6645079
	speed: 0.0090s/iter; left time: 1.3085s
	iters: 200, epoch: 8 | loss: 0.7535369
	speed: 0.0043s/iter; left time: 0.1982s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 1.1076722145080566
Epoch: 8, Steps: 245 | Train Loss: 0.7090224 Vali Loss: 0.5811624 Best vali loss: 0.5797294

best validation loss 0.579729391959242

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9302072
	speed: 0.0086s/iter; left time: 15.9630s
	iters: 200, epoch: 1 | loss: 0.8174270
	speed: 0.0029s/iter; left time: 5.0671s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.6635).  Saving model state dict ...
Epoch: 1 cost time: 1.0281944274902344
Epoch: 1, Steps: 245 | Train Loss: 0.8738171 Vali Loss: 0.6635078 Best vali loss: 0.6635078
	iters: 100, epoch: 2 | loss: 0.6303961
	speed: 0.0064s/iter; left time: 10.3012s
	iters: 200, epoch: 2 | loss: 0.6980567
	speed: 0.0028s/iter; left time: 4.2625s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.6635 --> 0.6372).  Saving model state dict ...
Epoch: 2 cost time: 0.737166166305542
Epoch: 2, Steps: 245 | Train Loss: 0.6642264 Vali Loss: 0.6371735 Best vali loss: 0.6371735
	iters: 100, epoch: 3 | loss: 0.8072785
	speed: 0.0063s/iter; left time: 8.6851s
	iters: 200, epoch: 3 | loss: 0.7242541
	speed: 0.0028s/iter; left time: 3.5995s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.6372 --> 0.6286).  Saving model state dict ...
Epoch: 3 cost time: 0.7201826572418213
Epoch: 3, Steps: 245 | Train Loss: 0.7657663 Vali Loss: 0.6286354 Best vali loss: 0.6286354
	iters: 100, epoch: 4 | loss: 0.8334219
	speed: 0.0064s/iter; left time: 7.1821s
	iters: 200, epoch: 4 | loss: 0.7610663
	speed: 0.0027s/iter; left time: 2.8028s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.6286 --> 0.6249).  Saving model state dict ...
Epoch: 4 cost time: 0.7170767784118652
Epoch: 4, Steps: 245 | Train Loss: 0.7972441 Vali Loss: 0.6249389 Best vali loss: 0.6249389
	iters: 100, epoch: 5 | loss: 0.7762634
	speed: 0.0062s/iter; left time: 5.4801s
	iters: 200, epoch: 5 | loss: 1.1175545
	speed: 0.0028s/iter; left time: 2.1528s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.6249 --> 0.6232).  Saving model state dict ...
Epoch: 5 cost time: 0.7162349224090576
Epoch: 5, Steps: 245 | Train Loss: 0.9469090 Vali Loss: 0.6231789 Best vali loss: 0.6231789
	iters: 100, epoch: 6 | loss: 0.5667970
	speed: 0.0065s/iter; left time: 4.1603s
	iters: 200, epoch: 6 | loss: 0.9434093
	speed: 0.0027s/iter; left time: 1.4452s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.6232 --> 0.6224).  Saving model state dict ...
Epoch: 6 cost time: 0.7378878593444824
Epoch: 6, Steps: 245 | Train Loss: 0.7551031 Vali Loss: 0.6223545 Best vali loss: 0.6223545
	iters: 100, epoch: 7 | loss: 0.5875416
	speed: 0.0062s/iter; left time: 2.4327s
	iters: 200, epoch: 7 | loss: 0.9025226
	speed: 0.0029s/iter; left time: 0.8484s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.6224 --> 0.6220).  Saving model state dict ...
Epoch: 7 cost time: 0.7441153526306152
Epoch: 7, Steps: 245 | Train Loss: 0.7450321 Vali Loss: 0.6219729 Best vali loss: 0.6219729
	iters: 100, epoch: 8 | loss: 0.8374912
	speed: 0.0064s/iter; left time: 0.9360s
	iters: 200, epoch: 8 | loss: 1.4370627
	speed: 0.0031s/iter; left time: 0.1408s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.6220 --> 0.6218).  Saving model state dict ...
Epoch: 8 cost time: 0.7786755561828613
Epoch: 8, Steps: 245 | Train Loss: 1.1372770 Vali Loss: 0.6217914 Best vali loss: 0.6217914

best validation loss 0.6217914487630446

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4719185
	speed: 0.0113s/iter; left time: 43.1943s
	iters: 200, epoch: 1 | loss: 1.0632576
	speed: 0.0054s/iter; left time: 20.2710s
	iters: 300, epoch: 1 | loss: 1.1117439
	speed: 0.0054s/iter; left time: 19.5960s
	iters: 400, epoch: 1 | loss: 0.5448257
	speed: 0.0054s/iter; left time: 18.8377s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.6278).  Saving model state dict ...
Epoch: 1 cost time: 2.976191759109497
Epoch: 1, Steps: 490 | Train Loss: 0.7979364 Vali Loss: 0.6277631 Best vali loss: 0.6277631
	iters: 100, epoch: 2 | loss: 1.0840703
	speed: 0.0142s/iter; left time: 47.2079s
	iters: 200, epoch: 2 | loss: 0.9342816
	speed: 0.0049s/iter; left time: 15.7344s
	iters: 300, epoch: 2 | loss: 1.3005854
	speed: 0.0052s/iter; left time: 16.2064s
	iters: 400, epoch: 2 | loss: 0.9999411
	speed: 0.0052s/iter; left time: 15.7109s
Updating learning rate to 0.0022202606486
Epoch: 2 cost time: 2.559626340866089
Epoch: 2, Steps: 490 | Train Loss: 1.0797196 Vali Loss: 0.6632441 Best vali loss: 0.6277631
	iters: 100, epoch: 3 | loss: 1.0831825
	speed: 0.0139s/iter; left time: 39.4456s
	iters: 200, epoch: 3 | loss: 1.1171596
	speed: 0.0051s/iter; left time: 14.0722s
	iters: 300, epoch: 3 | loss: 0.6939582
	speed: 0.0054s/iter; left time: 14.1713s
	iters: 400, epoch: 3 | loss: 0.6769297
	speed: 0.0053s/iter; left time: 13.5099s
Updating learning rate to 0.0011101303243
Epoch: 3 cost time: 2.6138088703155518
Epoch: 3, Steps: 490 | Train Loss: 0.8928075 Vali Loss: 0.6529308 Best vali loss: 0.6277631

best validation loss 0.6277631112184309

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6727017
	speed: 0.0095s/iter; left time: 8.3854s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 0.7772994041442871
Epoch: 1, Steps: 123 | Train Loss: 0.6727017 Vali Loss: 0.6167024 Best vali loss: 0.6167024
	iters: 100, epoch: 2 | loss: 0.8896103
	speed: 0.0067s/iter; left time: 5.0869s
Updating learning rate to 0.0005602820643
Validation loss decreased (0.6167 --> 0.6010).  Saving model state dict ...
Epoch: 2 cost time: 0.5034334659576416
Epoch: 2, Steps: 123 | Train Loss: 0.8896103 Vali Loss: 0.6010150 Best vali loss: 0.6010150
	iters: 100, epoch: 3 | loss: 0.7186646
	speed: 0.0064s/iter; left time: 4.1001s
Updating learning rate to 0.00028014103215
Epoch: 3 cost time: 0.48389506340026855
Epoch: 3, Steps: 123 | Train Loss: 0.7186646 Vali Loss: 0.6131354 Best vali loss: 0.6010150

best validation loss 0.6010149901578515

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7700563
	speed: 0.0088s/iter; left time: 33.4388s
	iters: 200, epoch: 1 | loss: 0.6977828
	speed: 0.0026s/iter; left time: 9.7762s
	iters: 300, epoch: 1 | loss: 2.0160580
	speed: 0.0026s/iter; left time: 9.3079s
	iters: 400, epoch: 1 | loss: 1.2605433
	speed: 0.0026s/iter; left time: 9.0345s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 1.6225049495697021
Epoch: 1, Steps: 490 | Train Loss: 1.1861101 Vali Loss: 0.6165462 Best vali loss: 0.6165462
	iters: 100, epoch: 2 | loss: 0.3904528
	speed: 0.0080s/iter; left time: 26.7907s
	iters: 200, epoch: 2 | loss: 0.4396462
	speed: 0.0026s/iter; left time: 8.3561s
	iters: 300, epoch: 2 | loss: 0.7252049
	speed: 0.0027s/iter; left time: 8.3263s
	iters: 400, epoch: 2 | loss: 0.7680517
	speed: 0.0026s/iter; left time: 7.9511s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.6165 --> 0.6080).  Saving model state dict ...
Epoch: 2 cost time: 1.3386030197143555
Epoch: 2, Steps: 490 | Train Loss: 0.5808389 Vali Loss: 0.6080412 Best vali loss: 0.6080412
	iters: 100, epoch: 3 | loss: 0.9479238
	speed: 0.0080s/iter; left time: 22.6429s
	iters: 200, epoch: 3 | loss: 0.8577951
	speed: 0.0027s/iter; left time: 7.4008s
	iters: 300, epoch: 3 | loss: 0.3161325
	speed: 0.0028s/iter; left time: 7.2662s
	iters: 400, epoch: 3 | loss: 0.3846283
	speed: 0.0028s/iter; left time: 7.1042s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 1.3857262134552002
Epoch: 3, Steps: 490 | Train Loss: 0.6266199 Vali Loss: 0.6185992 Best vali loss: 0.6080412

best validation loss 0.6080412366968346

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6478126
	speed: 0.0098s/iter; left time: 5.0354s
Updating learning rate to 0.000140070516075
Epoch: 4 cost time: 0.7936804294586182
Epoch: 4, Steps: 123 | Train Loss: 0.6478126 Vali Loss: 0.6092081 Best vali loss: 0.6010150
	iters: 100, epoch: 5 | loss: 0.8572293
	speed: 0.0064s/iter; left time: 2.5187s
Updating learning rate to 7.00352580375e-05
Epoch: 5 cost time: 0.49077701568603516
Epoch: 5, Steps: 123 | Train Loss: 0.8572293 Vali Loss: 0.6122516 Best vali loss: 0.6010150
	iters: 100, epoch: 6 | loss: 0.7045121
	speed: 0.0064s/iter; left time: 1.7329s
Updating learning rate to 3.501762901875e-05
Epoch: 6 cost time: 0.48408079147338867
Epoch: 6, Steps: 123 | Train Loss: 0.7045121 Vali Loss: 0.6102284 Best vali loss: 0.6010150
	iters: 100, epoch: 7 | loss: 0.6454180
	speed: 0.0065s/iter; left time: 0.9595s
Updating learning rate to 1.7508814509375e-05
Epoch: 7 cost time: 0.495042085647583
Epoch: 7, Steps: 123 | Train Loss: 0.6454180 Vali Loss: 0.6101027 Best vali loss: 0.6010150
	iters: 100, epoch: 8 | loss: 0.7262754
	speed: 0.0069s/iter; left time: 0.1651s
Updating learning rate to 8.7544072546875e-06
Epoch: 8 cost time: 0.5084493160247803
Epoch: 8, Steps: 123 | Train Loss: 0.7262754 Vali Loss: 0.6088441 Best vali loss: 0.6010150

best validation loss 0.6010149901578515

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4009410
	speed: 0.0093s/iter; left time: 71.8035s
	iters: 200, epoch: 1 | loss: 0.5259801
	speed: 0.0035s/iter; left time: 26.8491s
	iters: 300, epoch: 1 | loss: 0.9413303
	speed: 0.0036s/iter; left time: 26.9316s
	iters: 400, epoch: 1 | loss: 1.3539673
	speed: 0.0036s/iter; left time: 26.4755s
	iters: 500, epoch: 1 | loss: 1.3641868
	speed: 0.0036s/iter; left time: 26.1941s
	iters: 600, epoch: 1 | loss: 0.4325314
	speed: 0.0036s/iter; left time: 25.8698s
	iters: 700, epoch: 1 | loss: 0.8631662
	speed: 0.0036s/iter; left time: 25.3999s
	iters: 800, epoch: 1 | loss: 1.2109801
	speed: 0.0033s/iter; left time: 23.4859s
	iters: 900, epoch: 1 | loss: 0.8118829
	speed: 0.0034s/iter; left time: 23.2941s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.6481).  Saving model state dict ...
Epoch: 1 cost time: 3.7623097896575928
Epoch: 1, Steps: 979 | Train Loss: 0.9894407 Vali Loss: 0.6480561 Best vali loss: 0.6480561
	iters: 100, epoch: 2 | loss: 0.5342993
	speed: 0.0112s/iter; left time: 75.9230s
	iters: 200, epoch: 2 | loss: 1.2938075
	speed: 0.0034s/iter; left time: 22.9063s
	iters: 300, epoch: 2 | loss: 1.0198264
	speed: 0.0032s/iter; left time: 20.8929s
	iters: 400, epoch: 2 | loss: 0.7846322
	speed: 0.0031s/iter; left time: 19.9674s
	iters: 500, epoch: 2 | loss: 0.5177442
	speed: 0.0030s/iter; left time: 19.1696s
	iters: 600, epoch: 2 | loss: 0.4877748
	speed: 0.0030s/iter; left time: 18.8315s
	iters: 700, epoch: 2 | loss: 0.5474561
	speed: 0.0030s/iter; left time: 18.7546s
	iters: 800, epoch: 2 | loss: 0.6380721
	speed: 0.0030s/iter; left time: 18.4393s
	iters: 900, epoch: 2 | loss: 0.7716473
	speed: 0.0031s/iter; left time: 18.3206s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.6481 --> 0.6205).  Saving model state dict ...
Epoch: 2 cost time: 3.096834897994995
Epoch: 2, Steps: 979 | Train Loss: 0.7328067 Vali Loss: 0.6204591 Best vali loss: 0.6204591
	iters: 100, epoch: 3 | loss: 0.3738311
	speed: 0.0109s/iter; left time: 63.0154s
	iters: 200, epoch: 3 | loss: 1.2276367
	speed: 0.0031s/iter; left time: 17.7640s
	iters: 300, epoch: 3 | loss: 1.6671251
	speed: 0.0031s/iter; left time: 17.5338s
	iters: 400, epoch: 3 | loss: 0.6470243
	speed: 0.0032s/iter; left time: 17.3584s
	iters: 500, epoch: 3 | loss: 0.7336237
	speed: 0.0031s/iter; left time: 16.8750s
	iters: 600, epoch: 3 | loss: 1.4432522
	speed: 0.0031s/iter; left time: 16.4117s
	iters: 700, epoch: 3 | loss: 0.4203655
	speed: 0.0031s/iter; left time: 15.9512s
	iters: 800, epoch: 3 | loss: 0.6061695
	speed: 0.0031s/iter; left time: 15.6811s
	iters: 900, epoch: 3 | loss: 0.4650858
	speed: 0.0030s/iter; left time: 15.0700s
Updating learning rate to 0.0001037776569
Validation loss decreased (0.6205 --> 0.6022).  Saving model state dict ...
Epoch: 3 cost time: 3.0745222568511963
Epoch: 3, Steps: 979 | Train Loss: 0.8426793 Vali Loss: 0.6022229 Best vali loss: 0.6022229
	iters: 100, epoch: 4 | loss: 1.2519296
	speed: 0.0109s/iter; left time: 52.2393s
	iters: 200, epoch: 4 | loss: 0.6150422
	speed: 0.0029s/iter; left time: 13.7874s
	iters: 300, epoch: 4 | loss: 0.4943559
	speed: 0.0031s/iter; left time: 14.0663s
	iters: 400, epoch: 4 | loss: 0.8571324
	speed: 0.0030s/iter; left time: 13.3658s
	iters: 500, epoch: 4 | loss: 0.8483106
	speed: 0.0030s/iter; left time: 13.1896s
	iters: 600, epoch: 4 | loss: 0.4570717
	speed: 0.0030s/iter; left time: 12.8687s
	iters: 700, epoch: 4 | loss: 1.0869044
	speed: 0.0032s/iter; left time: 13.3239s
	iters: 800, epoch: 4 | loss: 0.6998726
	speed: 0.0031s/iter; left time: 12.8140s
	iters: 900, epoch: 4 | loss: 0.7917461
	speed: 0.0030s/iter; left time: 12.1220s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 3.0275228023529053
Epoch: 4, Steps: 979 | Train Loss: 0.7891517 Vali Loss: 0.6376779 Best vali loss: 0.6022229
	iters: 100, epoch: 5 | loss: 0.5711576
	speed: 0.0112s/iter; left time: 42.8741s
	iters: 200, epoch: 5 | loss: 0.5191041
	speed: 0.0037s/iter; left time: 13.6377s
	iters: 300, epoch: 5 | loss: 0.4221721
	speed: 0.0035s/iter; left time: 12.8254s
	iters: 400, epoch: 5 | loss: 0.4957927
	speed: 0.0035s/iter; left time: 12.2798s
	iters: 500, epoch: 5 | loss: 0.5784106
	speed: 0.0035s/iter; left time: 12.0639s
	iters: 600, epoch: 5 | loss: 1.0657340
	speed: 0.0035s/iter; left time: 11.7424s
	iters: 700, epoch: 5 | loss: 0.3022627
	speed: 0.0035s/iter; left time: 11.4117s
	iters: 800, epoch: 5 | loss: 0.6583661
	speed: 0.0036s/iter; left time: 11.1439s
	iters: 900, epoch: 5 | loss: 0.5198566
	speed: 0.0035s/iter; left time: 10.4092s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 3.510977029800415
Epoch: 5, Steps: 979 | Train Loss: 0.5703174 Vali Loss: 0.6485363 Best vali loss: 0.6022229
	iters: 100, epoch: 6 | loss: 0.4212973
	speed: 0.0114s/iter; left time: 32.2403s
	iters: 200, epoch: 6 | loss: 0.2790726
	speed: 0.0036s/iter; left time: 9.8803s
	iters: 300, epoch: 6 | loss: 0.5820783
	speed: 0.0037s/iter; left time: 9.7785s
	iters: 400, epoch: 6 | loss: 1.3872631
	speed: 0.0037s/iter; left time: 9.5041s
	iters: 500, epoch: 6 | loss: 0.4891180
	speed: 0.0034s/iter; left time: 8.2717s
	iters: 600, epoch: 6 | loss: 0.8932300
	speed: 0.0034s/iter; left time: 7.8493s
	iters: 700, epoch: 6 | loss: 1.2755960
	speed: 0.0034s/iter; left time: 7.5862s
	iters: 800, epoch: 6 | loss: 0.5945895
	speed: 0.0034s/iter; left time: 7.1931s
	iters: 900, epoch: 6 | loss: 0.6442001
	speed: 0.0035s/iter; left time: 7.1106s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 3.475198745727539
Epoch: 6, Steps: 979 | Train Loss: 0.7296050 Vali Loss: 0.6588396 Best vali loss: 0.6022229
	iters: 100, epoch: 7 | loss: 0.3877834
	speed: 0.0114s/iter; left time: 21.2752s
	iters: 200, epoch: 7 | loss: 0.7880499
	speed: 0.0035s/iter; left time: 6.1214s
	iters: 300, epoch: 7 | loss: 1.0082613
	speed: 0.0035s/iter; left time: 5.8104s
	iters: 400, epoch: 7 | loss: 0.6587670
	speed: 0.0036s/iter; left time: 5.6501s
	iters: 500, epoch: 7 | loss: 0.3613232
	speed: 0.0035s/iter; left time: 5.1289s
	iters: 600, epoch: 7 | loss: 0.4718281
	speed: 0.0035s/iter; left time: 4.7710s
	iters: 700, epoch: 7 | loss: 1.1034898
	speed: 0.0035s/iter; left time: 4.3701s
	iters: 800, epoch: 7 | loss: 0.7549211
	speed: 0.0034s/iter; left time: 3.9118s
	iters: 900, epoch: 7 | loss: 0.8425917
	speed: 0.0034s/iter; left time: 3.6133s
Updating learning rate to 6.48610355625e-06
Epoch: 7 cost time: 3.4344112873077393
Epoch: 7, Steps: 979 | Train Loss: 0.7085573 Vali Loss: 0.6546597 Best vali loss: 0.6022229
	iters: 100, epoch: 8 | loss: 0.6647547
	speed: 0.0120s/iter; left time: 10.5190s
	iters: 200, epoch: 8 | loss: 0.4164192
	speed: 0.0037s/iter; left time: 2.8782s
	iters: 300, epoch: 8 | loss: 0.2263368
	speed: 0.0037s/iter; left time: 2.5033s
	iters: 400, epoch: 8 | loss: 0.2588203
	speed: 0.0036s/iter; left time: 2.1133s
	iters: 500, epoch: 8 | loss: 0.8079415
	speed: 0.0035s/iter; left time: 1.6791s
	iters: 600, epoch: 8 | loss: 0.8657331
	speed: 0.0036s/iter; left time: 1.3651s
	iters: 700, epoch: 8 | loss: 0.2267524
	speed: 0.0035s/iter; left time: 0.9908s
	iters: 800, epoch: 8 | loss: 0.4548513
	speed: 0.0037s/iter; left time: 0.6574s
	iters: 900, epoch: 8 | loss: 0.7978462
	speed: 0.0037s/iter; left time: 0.2966s
Updating learning rate to 3.243051778125e-06
Epoch: 8 cost time: 3.5935933589935303
Epoch: 8, Steps: 979 | Train Loss: 0.5243840 Vali Loss: 0.6562393 Best vali loss: 0.6022229

best validation loss 0.6022228526329895

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8020836
	speed: 0.0091s/iter; left time: 70.5695s
	iters: 200, epoch: 1 | loss: 1.2618625
	speed: 0.0035s/iter; left time: 26.6610s
	iters: 300, epoch: 1 | loss: 1.7969416
	speed: 0.0034s/iter; left time: 25.3996s
	iters: 400, epoch: 1 | loss: 0.7139260
	speed: 0.0035s/iter; left time: 25.8140s
	iters: 500, epoch: 1 | loss: 0.9272870
	speed: 0.0035s/iter; left time: 25.5262s
	iters: 600, epoch: 1 | loss: 0.8149925
	speed: 0.0035s/iter; left time: 25.1197s
	iters: 700, epoch: 1 | loss: 0.6342350
	speed: 0.0034s/iter; left time: 24.3996s
	iters: 800, epoch: 1 | loss: 1.4142890
	speed: 0.0030s/iter; left time: 20.8639s
	iters: 900, epoch: 1 | loss: 0.9237294
	speed: 0.0030s/iter; left time: 21.0446s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.6555).  Saving model state dict ...
Epoch: 1 cost time: 3.5720810890197754
Epoch: 1, Steps: 979 | Train Loss: 1.0321496 Vali Loss: 0.6555166 Best vali loss: 0.6555166
	iters: 100, epoch: 2 | loss: 1.7013413
	speed: 0.0110s/iter; left time: 74.2387s
	iters: 200, epoch: 2 | loss: 0.7247878
	speed: 0.0035s/iter; left time: 23.0750s
	iters: 300, epoch: 2 | loss: 0.8501540
	speed: 0.0034s/iter; left time: 22.1700s
	iters: 400, epoch: 2 | loss: 1.1681274
	speed: 0.0033s/iter; left time: 21.3883s
	iters: 500, epoch: 2 | loss: 0.5089455
	speed: 0.0033s/iter; left time: 20.8051s
	iters: 600, epoch: 2 | loss: 0.8438725
	speed: 0.0034s/iter; left time: 21.5105s
	iters: 700, epoch: 2 | loss: 0.7126907
	speed: 0.0035s/iter; left time: 21.4463s
	iters: 800, epoch: 2 | loss: 0.3269002
	speed: 0.0031s/iter; left time: 18.8932s
	iters: 900, epoch: 2 | loss: 0.3780701
	speed: 0.0030s/iter; left time: 17.7460s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.6555 --> 0.6310).  Saving model state dict ...
Epoch: 2 cost time: 3.279629945755005
Epoch: 2, Steps: 979 | Train Loss: 0.8016544 Vali Loss: 0.6310155 Best vali loss: 0.6310155
	iters: 100, epoch: 3 | loss: 1.8601493
	speed: 0.0105s/iter; left time: 60.6241s
	iters: 200, epoch: 3 | loss: 0.7951894
	speed: 0.0033s/iter; left time: 18.8845s
	iters: 300, epoch: 3 | loss: 0.3657803
	speed: 0.0033s/iter; left time: 18.2358s
	iters: 400, epoch: 3 | loss: 1.3800873
	speed: 0.0033s/iter; left time: 17.9407s
	iters: 500, epoch: 3 | loss: 1.5857460
	speed: 0.0031s/iter; left time: 16.8161s
	iters: 600, epoch: 3 | loss: 0.5328349
	speed: 0.0032s/iter; left time: 16.6416s
	iters: 700, epoch: 3 | loss: 1.0826854
	speed: 0.0033s/iter; left time: 16.9105s
	iters: 800, epoch: 3 | loss: 0.4076346
	speed: 0.0033s/iter; left time: 16.8057s
	iters: 900, epoch: 3 | loss: 0.4790212
	speed: 0.0031s/iter; left time: 15.6402s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.6310 --> 0.6209).  Saving model state dict ...
Epoch: 3 cost time: 3.2095534801483154
Epoch: 3, Steps: 979 | Train Loss: 0.9432365 Vali Loss: 0.6208881 Best vali loss: 0.6208881
	iters: 100, epoch: 4 | loss: 0.8158340
	speed: 0.0111s/iter; left time: 53.4726s
	iters: 200, epoch: 4 | loss: 1.0802386
	speed: 0.0032s/iter; left time: 15.1932s
	iters: 300, epoch: 4 | loss: 1.3857452
	speed: 0.0033s/iter; left time: 14.9445s
	iters: 400, epoch: 4 | loss: 0.4759391
	speed: 0.0031s/iter; left time: 14.1094s
	iters: 500, epoch: 4 | loss: 0.8823439
	speed: 0.0031s/iter; left time: 13.8279s
	iters: 600, epoch: 4 | loss: 1.3685875
	speed: 0.0031s/iter; left time: 13.3420s
	iters: 700, epoch: 4 | loss: 0.6793145
	speed: 0.0033s/iter; left time: 13.8473s
	iters: 800, epoch: 4 | loss: 0.4829091
	speed: 0.0032s/iter; left time: 13.1386s
	iters: 900, epoch: 4 | loss: 0.6080295
	speed: 0.0031s/iter; left time: 12.1906s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.6209 --> 0.6179).  Saving model state dict ...
Epoch: 4 cost time: 3.1510117053985596
Epoch: 4, Steps: 979 | Train Loss: 0.8643268 Vali Loss: 0.6179046 Best vali loss: 0.6179046
	iters: 100, epoch: 5 | loss: 0.6748661
	speed: 0.0110s/iter; left time: 42.1050s
	iters: 200, epoch: 5 | loss: 0.2831047
	speed: 0.0030s/iter; left time: 11.1110s
	iters: 300, epoch: 5 | loss: 1.1764995
	speed: 0.0031s/iter; left time: 11.1407s
	iters: 400, epoch: 5 | loss: 1.1470335
	speed: 0.0030s/iter; left time: 10.6351s
	iters: 500, epoch: 5 | loss: 0.5087966
	speed: 0.0031s/iter; left time: 10.6813s
	iters: 600, epoch: 5 | loss: 0.3287249
	speed: 0.0030s/iter; left time: 10.1165s
	iters: 700, epoch: 5 | loss: 1.4702433
	speed: 0.0032s/iter; left time: 10.2306s
	iters: 800, epoch: 5 | loss: 0.8919598
	speed: 0.0030s/iter; left time: 9.4391s
	iters: 900, epoch: 5 | loss: 2.4643469
	speed: 0.0030s/iter; left time: 9.0383s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.6179 --> 0.6167).  Saving model state dict ...
Epoch: 5 cost time: 3.069760799407959
Epoch: 5, Steps: 979 | Train Loss: 0.9939528 Vali Loss: 0.6166768 Best vali loss: 0.6166768
	iters: 100, epoch: 6 | loss: 0.6565214
	speed: 0.0100s/iter; left time: 28.4791s
	iters: 200, epoch: 6 | loss: 1.7724689
	speed: 0.0030s/iter; left time: 8.0969s
	iters: 300, epoch: 6 | loss: 1.5976059
	speed: 0.0030s/iter; left time: 7.8513s
	iters: 400, epoch: 6 | loss: 1.0764723
	speed: 0.0030s/iter; left time: 7.7197s
	iters: 500, epoch: 6 | loss: 0.3585307
	speed: 0.0030s/iter; left time: 7.3928s
	iters: 600, epoch: 6 | loss: 0.8163016
	speed: 0.0031s/iter; left time: 7.2920s
	iters: 700, epoch: 6 | loss: 0.7175550
	speed: 0.0030s/iter; left time: 6.7285s
	iters: 800, epoch: 6 | loss: 1.0408250
	speed: 0.0030s/iter; left time: 6.4793s
	iters: 900, epoch: 6 | loss: 0.8738590
	speed: 0.0030s/iter; left time: 6.1732s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.6167 --> 0.6159).  Saving model state dict ...
Epoch: 6 cost time: 2.9959518909454346
Epoch: 6, Steps: 979 | Train Loss: 0.9900156 Vali Loss: 0.6158844 Best vali loss: 0.6158844
	iters: 100, epoch: 7 | loss: 0.9978275
	speed: 0.0106s/iter; left time: 19.7862s
	iters: 200, epoch: 7 | loss: 1.7073016
	speed: 0.0031s/iter; left time: 5.3765s
	iters: 300, epoch: 7 | loss: 0.3809454
	speed: 0.0030s/iter; left time: 5.0592s
	iters: 400, epoch: 7 | loss: 1.3481585
	speed: 0.0031s/iter; left time: 4.7924s
	iters: 500, epoch: 7 | loss: 1.0730591
	speed: 0.0030s/iter; left time: 4.4093s
	iters: 600, epoch: 7 | loss: 1.1228719
	speed: 0.0031s/iter; left time: 4.1904s
	iters: 700, epoch: 7 | loss: 1.0338259
	speed: 0.0030s/iter; left time: 3.8360s
	iters: 800, epoch: 7 | loss: 0.9568713
	speed: 0.0031s/iter; left time: 3.6211s
	iters: 900, epoch: 7 | loss: 0.3908818
	speed: 0.0030s/iter; left time: 3.2048s
Updating learning rate to 1.0771095203125e-06
Validation loss decreased (0.6159 --> 0.6156).  Saving model state dict ...
Epoch: 7 cost time: 3.036973714828491
Epoch: 7, Steps: 979 | Train Loss: 1.0013048 Vali Loss: 0.6155581 Best vali loss: 0.6155581
	iters: 100, epoch: 8 | loss: 0.4589221
	speed: 0.0111s/iter; left time: 9.7505s
	iters: 200, epoch: 8 | loss: 0.7444280
	speed: 0.0037s/iter; left time: 2.8702s
	iters: 300, epoch: 8 | loss: 1.2757962
	speed: 0.0036s/iter; left time: 2.4341s
	iters: 400, epoch: 8 | loss: 0.6730143
	speed: 0.0036s/iter; left time: 2.0781s
	iters: 500, epoch: 8 | loss: 1.0364351
	speed: 0.0035s/iter; left time: 1.6627s
	iters: 600, epoch: 8 | loss: 0.9134109
	speed: 0.0035s/iter; left time: 1.3340s
	iters: 700, epoch: 8 | loss: 0.8844785
	speed: 0.0034s/iter; left time: 0.9448s
	iters: 800, epoch: 8 | loss: 0.5224215
	speed: 0.0030s/iter; left time: 0.5470s
	iters: 900, epoch: 8 | loss: 0.6516110
	speed: 0.0033s/iter; left time: 0.2678s
Updating learning rate to 5.3855476015625e-07
Validation loss decreased (0.6156 --> 0.6154).  Saving model state dict ...
Epoch: 8 cost time: 3.433267116546631
Epoch: 8, Steps: 979 | Train Loss: 0.7956131 Vali Loss: 0.6153904 Best vali loss: 0.6153904

best validation loss 0.6153904032039731

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0355920
	speed: 0.0120s/iter; left time: 10.5838s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.6738).  Saving model state dict ...
Epoch: 1 cost time: 1.0596179962158203
Epoch: 1, Steps: 123 | Train Loss: 1.0355920 Vali Loss: 0.6738270 Best vali loss: 0.6738270
	iters: 100, epoch: 2 | loss: 0.9656726
	speed: 0.0096s/iter; left time: 7.2902s
Updating learning rate to 0.0019699025932
Validation loss decreased (0.6738 --> 0.6306).  Saving model state dict ...
Epoch: 2 cost time: 0.795759916305542
Epoch: 2, Steps: 123 | Train Loss: 0.9656726 Vali Loss: 0.6306002 Best vali loss: 0.6306002
	iters: 100, epoch: 3 | loss: 1.3154256
	speed: 0.0101s/iter; left time: 6.4551s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 0.8414442539215088
Epoch: 3, Steps: 123 | Train Loss: 1.3154256 Vali Loss: 0.6564364 Best vali loss: 0.6306002

best validation loss 0.6306002162386565

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6057808
	speed: 0.0102s/iter; left time: 39.1505s
	iters: 200, epoch: 1 | loss: 0.9099761
	speed: 0.0043s/iter; left time: 16.1043s
	iters: 300, epoch: 1 | loss: 1.1499507
	speed: 0.0044s/iter; left time: 16.0924s
	iters: 400, epoch: 1 | loss: 1.1276221
	speed: 0.0045s/iter; left time: 15.8582s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.6276).  Saving model state dict ...
Epoch: 1 cost time: 2.514566421508789
Epoch: 1, Steps: 490 | Train Loss: 0.9483324 Vali Loss: 0.6276189 Best vali loss: 0.6276189
	iters: 100, epoch: 2 | loss: 1.1607152
	speed: 0.0121s/iter; left time: 40.3454s
	iters: 200, epoch: 2 | loss: 0.6182223
	speed: 0.0046s/iter; left time: 14.9164s
	iters: 300, epoch: 2 | loss: 0.9676126
	speed: 0.0044s/iter; left time: 13.9150s
	iters: 400, epoch: 2 | loss: 0.5355896
	speed: 0.0044s/iter; left time: 13.4509s
Updating learning rate to 0.000552421030539641
Validation loss decreased (0.6276 --> 0.6202).  Saving model state dict ...
Epoch: 2 cost time: 2.2457807064056396
Epoch: 2, Steps: 490 | Train Loss: 0.8205349 Vali Loss: 0.6202179 Best vali loss: 0.6202179
	iters: 100, epoch: 3 | loss: 0.8285242
	speed: 0.0121s/iter; left time: 34.4729s
	iters: 200, epoch: 3 | loss: 1.0112342
	speed: 0.0046s/iter; left time: 12.6491s
	iters: 300, epoch: 3 | loss: 1.2093744
	speed: 0.0045s/iter; left time: 11.8458s
	iters: 400, epoch: 3 | loss: 0.4508401
	speed: 0.0044s/iter; left time: 11.1597s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.6202 --> 0.6043).  Saving model state dict ...
Epoch: 3 cost time: 2.247790813446045
Epoch: 3, Steps: 490 | Train Loss: 0.8749932 Vali Loss: 0.6042530 Best vali loss: 0.6042530

best validation loss 0.6042529792214146

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7254710
	speed: 0.0087s/iter; left time: 33.3663s
	iters: 200, epoch: 1 | loss: 0.8976727
	speed: 0.0024s/iter; left time: 9.0934s
	iters: 300, epoch: 1 | loss: 0.8006351
	speed: 0.0024s/iter; left time: 8.5957s
	iters: 400, epoch: 1 | loss: 0.6139483
	speed: 0.0024s/iter; left time: 8.4256s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 1.54671049118042
Epoch: 1, Steps: 490 | Train Loss: 0.7594318 Vali Loss: 0.6064926 Best vali loss: 0.6064926
	iters: 100, epoch: 2 | loss: 0.8544254
	speed: 0.0075s/iter; left time: 24.9869s
	iters: 200, epoch: 2 | loss: 1.0067028
	speed: 0.0025s/iter; left time: 8.1946s
	iters: 300, epoch: 2 | loss: 0.9941320
	speed: 0.0025s/iter; left time: 7.7716s
	iters: 400, epoch: 2 | loss: 0.7606754
	speed: 0.0024s/iter; left time: 7.1710s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.6065 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 1.2404255867004395
Epoch: 2, Steps: 490 | Train Loss: 0.9039839 Vali Loss: 0.6007088 Best vali loss: 0.6007088
	iters: 100, epoch: 3 | loss: 0.6673989
	speed: 0.0078s/iter; left time: 22.1993s
	iters: 200, epoch: 3 | loss: 0.8415149
	speed: 0.0027s/iter; left time: 7.2928s
	iters: 300, epoch: 3 | loss: 0.7162102
	speed: 0.0027s/iter; left time: 7.0078s
	iters: 400, epoch: 3 | loss: 1.1109309
	speed: 0.0027s/iter; left time: 6.8332s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 1.340062141418457
Epoch: 3, Steps: 490 | Train Loss: 0.8340137 Vali Loss: 0.6023368 Best vali loss: 0.6007088

best validation loss 0.6007088384160506

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7275408
	speed: 0.0088s/iter; left time: 20.6589s
	iters: 200, epoch: 4 | loss: 0.8849952
	speed: 0.0027s/iter; left time: 6.0259s
	iters: 300, epoch: 4 | loss: 0.7968936
	speed: 0.0026s/iter; left time: 5.5623s
	iters: 400, epoch: 4 | loss: 0.5565302
	speed: 0.0025s/iter; left time: 5.2263s
Updating learning rate to 6.2661798975e-05
Epoch: 4 cost time: 1.6233341693878174
Epoch: 4, Steps: 490 | Train Loss: 0.7414899 Vali Loss: 0.6067590 Best vali loss: 0.6007088
	iters: 100, epoch: 5 | loss: 0.7893050
	speed: 0.0079s/iter; left time: 14.6405s
	iters: 200, epoch: 5 | loss: 0.9532582
	speed: 0.0026s/iter; left time: 4.5731s
	iters: 300, epoch: 5 | loss: 0.9537767
	speed: 0.0025s/iter; left time: 4.2327s
	iters: 400, epoch: 5 | loss: 0.7566023
	speed: 0.0026s/iter; left time: 4.0022s
Updating learning rate to 3.13308994875e-05
Epoch: 5 cost time: 1.3033366203308105
Epoch: 5, Steps: 490 | Train Loss: 0.8632355 Vali Loss: 0.6116303 Best vali loss: 0.6007088
	iters: 100, epoch: 6 | loss: 0.6555150
	speed: 0.0077s/iter; left time: 10.5905s
	iters: 200, epoch: 6 | loss: 0.8170093
	speed: 0.0026s/iter; left time: 3.3389s
	iters: 300, epoch: 6 | loss: 0.7138243
	speed: 0.0025s/iter; left time: 2.9854s
	iters: 400, epoch: 6 | loss: 1.0880332
	speed: 0.0026s/iter; left time: 2.8098s
Updating learning rate to 1.566544974375e-05
Epoch: 6 cost time: 1.300668478012085
Epoch: 6, Steps: 490 | Train Loss: 0.8185954 Vali Loss: 0.6146294 Best vali loss: 0.6007088
	iters: 100, epoch: 7 | loss: 0.5837271
	speed: 0.0077s/iter; left time: 6.8207s
	iters: 200, epoch: 7 | loss: 1.3065283
	speed: 0.0025s/iter; left time: 1.9436s
	iters: 300, epoch: 7 | loss: 0.4584107
	speed: 0.0026s/iter; left time: 1.7623s
	iters: 400, epoch: 7 | loss: 0.9619825
	speed: 0.0026s/iter; left time: 1.5142s
Updating learning rate to 7.832724871875e-06
Epoch: 7 cost time: 1.2978582382202148
Epoch: 7, Steps: 490 | Train Loss: 0.8276622 Vali Loss: 0.6125985 Best vali loss: 0.6007088
	iters: 100, epoch: 8 | loss: 0.4871590
	speed: 0.0080s/iter; left time: 3.1293s
	iters: 200, epoch: 8 | loss: 0.5188171
	speed: 0.0025s/iter; left time: 0.7415s
	iters: 300, epoch: 8 | loss: 0.7078368
	speed: 0.0025s/iter; left time: 0.4778s
	iters: 400, epoch: 8 | loss: 1.1676017
	speed: 0.0025s/iter; left time: 0.2237s
Updating learning rate to 3.9163624359375e-06
Epoch: 8 cost time: 1.2740530967712402
Epoch: 8, Steps: 490 | Train Loss: 0.7203536 Vali Loss: 0.6144188 Best vali loss: 0.6007088

best validation loss 0.6007088384160506

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1167998
	speed: 0.0102s/iter; left time: 79.2335s
	iters: 200, epoch: 1 | loss: 0.8973094
	speed: 0.0044s/iter; left time: 33.2413s
	iters: 300, epoch: 1 | loss: 1.5763246
	speed: 0.0045s/iter; left time: 33.5267s
	iters: 400, epoch: 1 | loss: 1.0300531
	speed: 0.0044s/iter; left time: 32.4993s
	iters: 500, epoch: 1 | loss: 1.3133734
	speed: 0.0044s/iter; left time: 32.1318s
	iters: 600, epoch: 1 | loss: 0.8939286
	speed: 0.0042s/iter; left time: 30.5276s
	iters: 700, epoch: 1 | loss: 0.5178520
	speed: 0.0044s/iter; left time: 31.4135s
	iters: 800, epoch: 1 | loss: 0.7725320
	speed: 0.0043s/iter; left time: 29.9513s
	iters: 900, epoch: 1 | loss: 0.8806133
	speed: 0.0043s/iter; left time: 29.7488s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.6378).  Saving model state dict ...
Epoch: 1 cost time: 4.598690748214722
Epoch: 1, Steps: 979 | Train Loss: 0.9998652 Vali Loss: 0.6377914 Best vali loss: 0.6377914
	iters: 100, epoch: 2 | loss: 1.0810018
	speed: 0.0132s/iter; left time: 88.9079s
	iters: 200, epoch: 2 | loss: 0.5861552
	speed: 0.0038s/iter; left time: 25.3239s
	iters: 300, epoch: 2 | loss: 1.0212495
	speed: 0.0038s/iter; left time: 25.0020s
	iters: 400, epoch: 2 | loss: 0.4895345
	speed: 0.0039s/iter; left time: 25.0002s
	iters: 500, epoch: 2 | loss: 1.0147280
	speed: 0.0042s/iter; left time: 26.4551s
	iters: 600, epoch: 2 | loss: 0.6241865
	speed: 0.0041s/iter; left time: 25.7035s
	iters: 700, epoch: 2 | loss: 0.8292337
	speed: 0.0045s/iter; left time: 27.4955s
	iters: 800, epoch: 2 | loss: 0.6444453
	speed: 0.0045s/iter; left time: 27.3034s
	iters: 900, epoch: 2 | loss: 1.7471452
	speed: 0.0045s/iter; left time: 26.6149s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.6378 --> 0.6179).  Saving model state dict ...
Epoch: 2 cost time: 4.0962512493133545
Epoch: 2, Steps: 979 | Train Loss: 0.8930755 Vali Loss: 0.6179335 Best vali loss: 0.6179335
	iters: 100, epoch: 3 | loss: 0.5507707
	speed: 0.0135s/iter; left time: 77.8845s
	iters: 200, epoch: 3 | loss: 0.4938047
	speed: 0.0044s/iter; left time: 25.0889s
	iters: 300, epoch: 3 | loss: 1.2405481
	speed: 0.0044s/iter; left time: 24.7142s
	iters: 400, epoch: 3 | loss: 0.5594750
	speed: 0.0044s/iter; left time: 24.3244s
	iters: 500, epoch: 3 | loss: 0.3144234
	speed: 0.0044s/iter; left time: 23.8113s
	iters: 600, epoch: 3 | loss: 0.5255617
	speed: 0.0043s/iter; left time: 22.7841s
	iters: 700, epoch: 3 | loss: 0.6796204
	speed: 0.0044s/iter; left time: 22.6818s
	iters: 800, epoch: 3 | loss: 1.0178982
	speed: 0.0044s/iter; left time: 22.5029s
	iters: 900, epoch: 3 | loss: 1.2635134
	speed: 0.0044s/iter; left time: 22.0618s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.6179 --> 0.6094).  Saving model state dict ...
Epoch: 3 cost time: 4.364949941635132
Epoch: 3, Steps: 979 | Train Loss: 0.7384018 Vali Loss: 0.6094149 Best vali loss: 0.6094149
	iters: 100, epoch: 4 | loss: 1.0616391
	speed: 0.0129s/iter; left time: 62.0728s
	iters: 200, epoch: 4 | loss: 1.2230835
	speed: 0.0038s/iter; left time: 17.7915s
	iters: 300, epoch: 4 | loss: 1.5388240
	speed: 0.0040s/iter; left time: 18.1745s
	iters: 400, epoch: 4 | loss: 0.8344025
	speed: 0.0039s/iter; left time: 17.3587s
	iters: 500, epoch: 4 | loss: 0.7724993
	speed: 0.0039s/iter; left time: 16.9709s
	iters: 600, epoch: 4 | loss: 0.8406651
	speed: 0.0039s/iter; left time: 16.6994s
	iters: 700, epoch: 4 | loss: 0.6981606
	speed: 0.0038s/iter; left time: 15.9310s
	iters: 800, epoch: 4 | loss: 0.2872311
	speed: 0.0037s/iter; left time: 14.9942s
	iters: 900, epoch: 4 | loss: 0.7714839
	speed: 0.0039s/iter; left time: 15.4392s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.6094 --> 0.6067).  Saving model state dict ...
Epoch: 4 cost time: 3.7799103260040283
Epoch: 4, Steps: 979 | Train Loss: 0.8919988 Vali Loss: 0.6066549 Best vali loss: 0.6066549
	iters: 100, epoch: 5 | loss: 0.5446658
	speed: 0.0123s/iter; left time: 47.0319s
	iters: 200, epoch: 5 | loss: 0.2943320
	speed: 0.0038s/iter; left time: 14.1618s
	iters: 300, epoch: 5 | loss: 0.4454595
	speed: 0.0038s/iter; left time: 13.8832s
	iters: 400, epoch: 5 | loss: 1.4329592
	speed: 0.0037s/iter; left time: 12.8786s
	iters: 500, epoch: 5 | loss: 1.3125234
	speed: 0.0038s/iter; left time: 13.0308s
	iters: 600, epoch: 5 | loss: 0.5150740
	speed: 0.0038s/iter; left time: 12.7424s
	iters: 700, epoch: 5 | loss: 1.1274695
	speed: 0.0038s/iter; left time: 12.2495s
	iters: 800, epoch: 5 | loss: 0.5659073
	speed: 0.0038s/iter; left time: 11.9385s
	iters: 900, epoch: 5 | loss: 0.3055024
	speed: 0.0039s/iter; left time: 11.7855s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.6067 --> 0.6038).  Saving model state dict ...
Epoch: 5 cost time: 3.771355390548706
Epoch: 5, Steps: 979 | Train Loss: 0.7270992 Vali Loss: 0.6037740 Best vali loss: 0.6037740
	iters: 100, epoch: 6 | loss: 1.7646809
	speed: 0.0130s/iter; left time: 36.9540s
	iters: 200, epoch: 6 | loss: 1.7833261
	speed: 0.0043s/iter; left time: 11.6763s
	iters: 300, epoch: 6 | loss: 0.9613150
	speed: 0.0043s/iter; left time: 11.2592s
	iters: 400, epoch: 6 | loss: 0.9051069
	speed: 0.0044s/iter; left time: 11.1088s
	iters: 500, epoch: 6 | loss: 1.2497820
	speed: 0.0044s/iter; left time: 10.8215s
	iters: 600, epoch: 6 | loss: 0.4408534
	speed: 0.0044s/iter; left time: 10.3991s
	iters: 700, epoch: 6 | loss: 0.6272479
	speed: 0.0044s/iter; left time: 9.9116s
	iters: 800, epoch: 6 | loss: 2.4030516
	speed: 0.0044s/iter; left time: 9.4675s
	iters: 900, epoch: 6 | loss: 1.2392557
	speed: 0.0039s/iter; left time: 8.0449s
Updating learning rate to 7.442412677412731e-06
Validation loss decreased (0.6038 --> 0.6026).  Saving model state dict ...
Epoch: 6 cost time: 4.241620779037476
Epoch: 6, Steps: 979 | Train Loss: 1.2638466 Vali Loss: 0.6025840 Best vali loss: 0.6025840
	iters: 100, epoch: 7 | loss: 0.4428875
	speed: 0.0132s/iter; left time: 24.4782s
	iters: 200, epoch: 7 | loss: 0.9064389
	speed: 0.0038s/iter; left time: 6.7289s
	iters: 300, epoch: 7 | loss: 0.3250679
	speed: 0.0038s/iter; left time: 6.3840s
	iters: 400, epoch: 7 | loss: 0.6544363
	speed: 0.0037s/iter; left time: 5.7967s
	iters: 500, epoch: 7 | loss: 0.7618397
	speed: 0.0040s/iter; left time: 5.7794s
	iters: 600, epoch: 7 | loss: 0.4963531
	speed: 0.0040s/iter; left time: 5.4969s
	iters: 700, epoch: 7 | loss: 0.5938497
	speed: 0.0043s/iter; left time: 5.3862s
	iters: 800, epoch: 7 | loss: 0.9272078
	speed: 0.0045s/iter; left time: 5.1814s
	iters: 900, epoch: 7 | loss: 0.2954711
	speed: 0.0043s/iter; left time: 4.5904s
Updating learning rate to 1.934220036037799e-06
Epoch: 7 cost time: 4.038922071456909
Epoch: 7, Steps: 979 | Train Loss: 0.6003947 Vali Loss: 0.6036122 Best vali loss: 0.6025840
	iters: 100, epoch: 8 | loss: 0.9844056
	speed: 0.0136s/iter; left time: 11.9279s
	iters: 200, epoch: 8 | loss: 2.0846303
	speed: 0.0044s/iter; left time: 3.4660s
	iters: 300, epoch: 8 | loss: 0.9808614
	speed: 0.0043s/iter; left time: 2.9261s
	iters: 400, epoch: 8 | loss: 0.9912956
	speed: 0.0044s/iter; left time: 2.5690s
	iters: 500, epoch: 8 | loss: 0.5128349
	speed: 0.0043s/iter; left time: 2.0836s
	iters: 600, epoch: 8 | loss: 0.4431283
	speed: 0.0044s/iter; left time: 1.6841s
	iters: 700, epoch: 8 | loss: 0.5204834
	speed: 0.0044s/iter; left time: 1.2366s
	iters: 800, epoch: 8 | loss: 1.2359452
	speed: 0.0044s/iter; left time: 0.7995s
	iters: 900, epoch: 8 | loss: 0.6132044
	speed: 0.0044s/iter; left time: 0.3523s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.351870536804199
Epoch: 8, Steps: 979 | Train Loss: 0.9296432 Vali Loss: 0.6035667 Best vali loss: 0.6025840

best validation loss 0.602583955030428

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4769707
	speed: 0.0102s/iter; left time: 78.8347s
	iters: 200, epoch: 1 | loss: 1.1197680
	speed: 0.0045s/iter; left time: 34.0906s
	iters: 300, epoch: 1 | loss: 0.9347841
	speed: 0.0043s/iter; left time: 32.3497s
	iters: 400, epoch: 1 | loss: 1.1067550
	speed: 0.0040s/iter; left time: 29.6831s
	iters: 500, epoch: 1 | loss: 1.0752699
	speed: 0.0039s/iter; left time: 28.6963s
	iters: 600, epoch: 1 | loss: 0.8411887
	speed: 0.0040s/iter; left time: 28.7153s
	iters: 700, epoch: 1 | loss: 0.5879174
	speed: 0.0040s/iter; left time: 28.3122s
	iters: 800, epoch: 1 | loss: 1.4085689
	speed: 0.0040s/iter; left time: 27.9907s
	iters: 900, epoch: 1 | loss: 0.8772579
	speed: 0.0039s/iter; left time: 27.2723s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.6189).  Saving model state dict ...
Epoch: 1 cost time: 4.327601432800293
Epoch: 1, Steps: 979 | Train Loss: 0.9364978 Vali Loss: 0.6189170 Best vali loss: 0.6189170
	iters: 100, epoch: 2 | loss: 0.9441136
	speed: 0.0130s/iter; left time: 87.7977s
	iters: 200, epoch: 2 | loss: 1.0134835
	speed: 0.0037s/iter; left time: 24.5825s
	iters: 300, epoch: 2 | loss: 1.0824895
	speed: 0.0037s/iter; left time: 24.5130s
	iters: 400, epoch: 2 | loss: 0.4775163
	speed: 0.0037s/iter; left time: 23.7952s
	iters: 500, epoch: 2 | loss: 0.4676824
	speed: 0.0037s/iter; left time: 23.4746s
	iters: 600, epoch: 2 | loss: 0.4992415
	speed: 0.0037s/iter; left time: 23.2600s
	iters: 700, epoch: 2 | loss: 0.6074965
	speed: 0.0041s/iter; left time: 25.3586s
	iters: 800, epoch: 2 | loss: 1.2172902
	speed: 0.0043s/iter; left time: 26.0793s
	iters: 900, epoch: 2 | loss: 0.7553254
	speed: 0.0044s/iter; left time: 26.2831s
Updating learning rate to 0.0003908218029551133
Validation loss decreased (0.6189 --> 0.6174).  Saving model state dict ...
Epoch: 2 cost time: 3.926651954650879
Epoch: 2, Steps: 979 | Train Loss: 0.7849599 Vali Loss: 0.6174281 Best vali loss: 0.6174281
	iters: 100, epoch: 3 | loss: 1.0280925
	speed: 0.0138s/iter; left time: 79.9086s
	iters: 200, epoch: 3 | loss: 0.8025762
	speed: 0.0043s/iter; left time: 24.1992s
	iters: 300, epoch: 3 | loss: 0.3462227
	speed: 0.0043s/iter; left time: 23.8324s
	iters: 400, epoch: 3 | loss: 0.7623401
	speed: 0.0043s/iter; left time: 23.3603s
	iters: 500, epoch: 3 | loss: 1.4845735
	speed: 0.0043s/iter; left time: 23.2451s
	iters: 600, epoch: 3 | loss: 1.7245131
	speed: 0.0042s/iter; left time: 22.2758s
	iters: 700, epoch: 3 | loss: 1.4403876
	speed: 0.0041s/iter; left time: 21.2725s
	iters: 800, epoch: 3 | loss: 0.9076523
	speed: 0.0042s/iter; left time: 21.3279s
	iters: 900, epoch: 3 | loss: 1.1014072
	speed: 0.0041s/iter; left time: 20.4210s
Updating learning rate to 0.00031654893408453833
Epoch: 3 cost time: 4.204058885574341
Epoch: 3, Steps: 979 | Train Loss: 1.0664183 Vali Loss: 0.6194008 Best vali loss: 0.6174281
	iters: 100, epoch: 4 | loss: 0.6887374
	speed: 0.0137s/iter; left time: 65.8135s
	iters: 200, epoch: 4 | loss: 0.3399682
	speed: 0.0039s/iter; left time: 18.4266s
	iters: 300, epoch: 4 | loss: 0.5994348
	speed: 0.0040s/iter; left time: 18.1780s
	iters: 400, epoch: 4 | loss: 0.9898750
	speed: 0.0039s/iter; left time: 17.5771s
	iters: 500, epoch: 4 | loss: 0.7076402
	speed: 0.0038s/iter; left time: 16.6986s
	iters: 600, epoch: 4 | loss: 0.6950269
	speed: 0.0039s/iter; left time: 16.8701s
	iters: 700, epoch: 4 | loss: 0.4797789
	speed: 0.0039s/iter; left time: 16.2767s
	iters: 800, epoch: 4 | loss: 0.6014603
	speed: 0.0039s/iter; left time: 15.8864s
	iters: 900, epoch: 4 | loss: 0.6648326
	speed: 0.0039s/iter; left time: 15.5630s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 3.896414041519165
Epoch: 4, Steps: 979 | Train Loss: 0.6407505 Vali Loss: 0.6441775 Best vali loss: 0.6174281
	iters: 100, epoch: 5 | loss: 0.9094303
	speed: 0.0129s/iter; left time: 49.3447s
	iters: 200, epoch: 5 | loss: 1.0068167
	speed: 0.0039s/iter; left time: 14.5991s
	iters: 300, epoch: 5 | loss: 0.4384920
	speed: 0.0038s/iter; left time: 13.7076s
	iters: 400, epoch: 5 | loss: 0.2684452
	speed: 0.0037s/iter; left time: 13.1403s
	iters: 500, epoch: 5 | loss: 0.4487837
	speed: 0.0042s/iter; left time: 14.1956s
	iters: 600, epoch: 5 | loss: 0.2046350
	speed: 0.0043s/iter; left time: 14.1516s
	iters: 700, epoch: 5 | loss: 1.0324252
	speed: 0.0044s/iter; left time: 14.0325s
	iters: 800, epoch: 5 | loss: 0.4575674
	speed: 0.0044s/iter; left time: 13.6566s
	iters: 900, epoch: 5 | loss: 0.4295436
	speed: 0.0042s/iter; left time: 12.6108s
Updating learning rate to 0.0001413272893154617
Epoch: 5 cost time: 4.002882719039917
Epoch: 5, Steps: 979 | Train Loss: 0.5773488 Vali Loss: 0.6206705 Best vali loss: 0.6174281
	iters: 100, epoch: 6 | loss: 0.7859999
	speed: 0.0124s/iter; left time: 35.0769s
	iters: 200, epoch: 6 | loss: 0.3375204
	speed: 0.0039s/iter; left time: 10.6830s
	iters: 300, epoch: 6 | loss: 0.5388912
	speed: 0.0038s/iter; left time: 10.0627s
	iters: 400, epoch: 6 | loss: 1.1260270
	speed: 0.0037s/iter; left time: 9.2783s
	iters: 500, epoch: 6 | loss: 1.0883069
	speed: 0.0038s/iter; left time: 9.2890s
	iters: 600, epoch: 6 | loss: 0.3510659
	speed: 0.0041s/iter; left time: 9.5366s
	iters: 700, epoch: 6 | loss: 1.1858917
	speed: 0.0039s/iter; left time: 8.8029s
	iters: 800, epoch: 6 | loss: 0.3340752
	speed: 0.0040s/iter; left time: 8.4693s
	iters: 900, epoch: 6 | loss: 0.4745663
	speed: 0.0039s/iter; left time: 7.8758s
Updating learning rate to 6.705442044488674e-05
Validation loss decreased (0.6174 --> 0.6145).  Saving model state dict ...
Epoch: 6 cost time: 3.8286240100860596
Epoch: 6, Steps: 979 | Train Loss: 0.6913716 Vali Loss: 0.6145250 Best vali loss: 0.6145250
	iters: 100, epoch: 7 | loss: 0.3066217
	speed: 0.0133s/iter; left time: 24.7627s
	iters: 200, epoch: 7 | loss: 0.7007170
	speed: 0.0044s/iter; left time: 7.6697s
	iters: 300, epoch: 7 | loss: 0.2471437
	speed: 0.0041s/iter; left time: 6.8533s
	iters: 400, epoch: 7 | loss: 1.1633811
	speed: 0.0044s/iter; left time: 6.7926s
	iters: 500, epoch: 7 | loss: 0.8210168
	speed: 0.0044s/iter; left time: 6.3512s
	iters: 600, epoch: 7 | loss: 0.3564449
	speed: 0.0044s/iter; left time: 6.0020s
	iters: 700, epoch: 7 | loss: 0.7625170
	speed: 0.0045s/iter; left time: 5.6352s
	iters: 800, epoch: 7 | loss: 0.3851959
	speed: 0.0044s/iter; left time: 5.0988s
	iters: 900, epoch: 7 | loss: 0.9353262
	speed: 0.0045s/iter; left time: 4.7208s
Updating learning rate to 1.7426876088587254e-05
Epoch: 7 cost time: 4.302062511444092
Epoch: 7, Steps: 979 | Train Loss: 0.6309294 Vali Loss: 0.6252080 Best vali loss: 0.6145250
	iters: 100, epoch: 8 | loss: 0.8443561
	speed: 0.0132s/iter; left time: 11.6275s
	iters: 200, epoch: 8 | loss: 0.2585154
	speed: 0.0039s/iter; left time: 3.0650s
	iters: 300, epoch: 8 | loss: 1.1222682
	speed: 0.0039s/iter; left time: 2.6527s
	iters: 400, epoch: 8 | loss: 0.2455174
	speed: 0.0037s/iter; left time: 2.1362s
	iters: 500, epoch: 8 | loss: 0.2687787
	speed: 0.0039s/iter; left time: 1.8925s
	iters: 600, epoch: 8 | loss: 0.3282365
	speed: 0.0038s/iter; left time: 1.4467s
	iters: 700, epoch: 8 | loss: 0.7641841
	speed: 0.0039s/iter; left time: 1.0863s
	iters: 800, epoch: 8 | loss: 0.2418809
	speed: 0.0039s/iter; left time: 0.6998s
	iters: 900, epoch: 8 | loss: 0.5498987
	speed: 0.0039s/iter; left time: 0.3149s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8542914390563965
Epoch: 8, Steps: 979 | Train Loss: 0.5137373 Vali Loss: 0.6183195 Best vali loss: 0.6145250

best validation loss 0.6145250010702799

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.6653).  Saving model state dict ...
Epoch: 1 cost time: 0.804706335067749
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6653030 Best vali loss: 0.6653030
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.6653 --> 0.6392).  Saving model state dict ...
Epoch: 2 cost time: 0.507422924041748
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6391787 Best vali loss: 0.6391787
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.6392 --> 0.6286).  Saving model state dict ...
Epoch: 3 cost time: 0.4870915412902832
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6285765 Best vali loss: 0.6285765

best validation loss 0.6285764637339838

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5897909
	speed: 0.0150s/iter; left time: 13.3165s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.5983).  Saving model state dict ...
Epoch: 1 cost time: 1.4579925537109375
Epoch: 1, Steps: 123 | Train Loss: 0.5897909 Vali Loss: 0.5983324 Best vali loss: 0.5983324
	iters: 100, epoch: 2 | loss: 0.8541566
	speed: 0.0141s/iter; left time: 10.7421s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.5983 --> 0.5514).  Saving model state dict ...
Epoch: 2 cost time: 1.1656107902526855
Epoch: 2, Steps: 123 | Train Loss: 0.8541566 Vali Loss: 0.5514426 Best vali loss: 0.5514426
	iters: 100, epoch: 3 | loss: 0.8217607
	speed: 0.0144s/iter; left time: 9.2131s
Updating learning rate to 0.00016268287006193248
Epoch: 3 cost time: 1.1714742183685303
Epoch: 3, Steps: 123 | Train Loss: 0.8217607 Vali Loss: 0.5586777 Best vali loss: 0.5514426

best validation loss 0.5514425721669407

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8767589
	speed: 0.0117s/iter; left time: 21.7904s
	iters: 200, epoch: 1 | loss: 0.9527043
	speed: 0.0057s/iter; left time: 10.1050s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.6082).  Saving model state dict ...
Epoch: 1 cost time: 1.7434473037719727
Epoch: 1, Steps: 245 | Train Loss: 0.9147316 Vali Loss: 0.6081694 Best vali loss: 0.6081694
	iters: 100, epoch: 2 | loss: 0.6973079
	speed: 0.0109s/iter; left time: 17.6505s
	iters: 200, epoch: 2 | loss: 0.7684135
	speed: 0.0056s/iter; left time: 8.5122s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.6082 --> 0.6076).  Saving model state dict ...
Epoch: 2 cost time: 1.4219675064086914
Epoch: 2, Steps: 245 | Train Loss: 0.7328607 Vali Loss: 0.6076418 Best vali loss: 0.6076418
	iters: 100, epoch: 3 | loss: 0.8515368
	speed: 0.0101s/iter; left time: 13.9085s
	iters: 200, epoch: 3 | loss: 0.8256285
	speed: 0.0052s/iter; left time: 6.5508s
Updating learning rate to 5.637801725e-05
Validation loss decreased (0.6076 --> 0.5830).  Saving model state dict ...
Epoch: 3 cost time: 1.2910706996917725
Epoch: 3, Steps: 245 | Train Loss: 0.8385826 Vali Loss: 0.5829885 Best vali loss: 0.5829885

best validation loss 0.5829884939754191

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5082465
	speed: 0.0160s/iter; left time: 8.2396s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 1.4932007789611816
Epoch: 4, Steps: 123 | Train Loss: 0.5082465 Vali Loss: 0.5566780 Best vali loss: 0.5514426
	iters: 100, epoch: 5 | loss: 0.7456414
	speed: 0.0139s/iter; left time: 5.4590s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 1.1662259101867676
Epoch: 5, Steps: 123 | Train Loss: 0.7456414 Vali Loss: 0.5862902 Best vali loss: 0.5514426
	iters: 100, epoch: 6 | loss: 0.7236981
	speed: 0.0140s/iter; left time: 3.7696s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 1.175415277481079
Epoch: 6, Steps: 123 | Train Loss: 0.7236981 Vali Loss: 0.5844978 Best vali loss: 0.5514426
	iters: 100, epoch: 7 | loss: 0.7528521
	speed: 0.0140s/iter; left time: 2.0646s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 1.1766552925109863
Epoch: 7, Steps: 123 | Train Loss: 0.7528521 Vali Loss: 0.6015961 Best vali loss: 0.5514426
	iters: 100, epoch: 8 | loss: 1.0102061
	speed: 0.0140s/iter; left time: 0.3362s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1696133613586426
Epoch: 8, Steps: 123 | Train Loss: 1.0102061 Vali Loss: 0.5946920 Best vali loss: 0.5514426

best validation loss 0.5514425721669407

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 0.68886399269104
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6171360 Best vali loss: 0.6171360
Updating learning rate to 0.0024817206738164837
Epoch: 2 cost time: 0.4157373905181885
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6664085 Best vali loss: 0.6171360
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 0.445540189743042
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6217971 Best vali loss: 0.6171360
Updating learning rate to 0.0014537583127
Validation loss decreased (0.6171 --> 0.6005).  Saving model state dict ...
Epoch: 4 cost time: 0.45224666595458984
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6005097 Best vali loss: 0.6005097
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 0.42205238342285156
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6592780 Best vali loss: 0.6005097
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 0.45414137840270996
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6440625 Best vali loss: 0.6005097
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 0.4307420253753662
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6298096 Best vali loss: 0.6005097
Updating learning rate to 0.0
Epoch: 8 cost time: 0.434859037399292
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6306270 Best vali loss: 0.6005097

best validation loss 0.6005097145506874

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9524001
	speed: 0.0108s/iter; left time: 9.5225s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.6247).  Saving model state dict ...
Epoch: 1 cost time: 0.9309942722320557
Epoch: 1, Steps: 123 | Train Loss: 0.9524001 Vali Loss: 0.6246860 Best vali loss: 0.6246860
	iters: 100, epoch: 2 | loss: 0.8732345
	speed: 0.0080s/iter; left time: 6.0766s
Updating learning rate to 0.00110292920845
Validation loss decreased (0.6247 --> 0.6137).  Saving model state dict ...
Epoch: 2 cost time: 0.6225094795227051
Epoch: 2, Steps: 123 | Train Loss: 0.8732345 Vali Loss: 0.6136754 Best vali loss: 0.6136754
	iters: 100, epoch: 3 | loss: 0.6779578
	speed: 0.0079s/iter; left time: 5.0238s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.6137 --> 0.6056).  Saving model state dict ...
Epoch: 3 cost time: 0.6161839962005615
Epoch: 3, Steps: 123 | Train Loss: 0.6779578 Vali Loss: 0.6056440 Best vali loss: 0.6056440
	iters: 100, epoch: 4 | loss: 1.1634884
	speed: 0.0079s/iter; left time: 4.0715s
Updating learning rate to 0.0002757323021125
Epoch: 4 cost time: 0.6198761463165283
Epoch: 4, Steps: 123 | Train Loss: 1.1634884 Vali Loss: 0.6146947 Best vali loss: 0.6056440
	iters: 100, epoch: 5 | loss: 1.0257372
	speed: 0.0077s/iter; left time: 3.0379s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 0.6043257713317871
Epoch: 5, Steps: 123 | Train Loss: 1.0257372 Vali Loss: 0.6095001 Best vali loss: 0.6056440
	iters: 100, epoch: 6 | loss: 0.9217154
	speed: 0.0076s/iter; left time: 2.0565s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 0.6076846122741699
Epoch: 6, Steps: 123 | Train Loss: 0.9217154 Vali Loss: 0.6258388 Best vali loss: 0.6056440
	iters: 100, epoch: 7 | loss: 0.8142138
	speed: 0.0073s/iter; left time: 1.0795s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 0.5669317245483398
Epoch: 7, Steps: 123 | Train Loss: 0.8142138 Vali Loss: 0.6278311 Best vali loss: 0.6056440
	iters: 100, epoch: 8 | loss: 0.5973458
	speed: 0.0074s/iter; left time: 0.1778s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 0.5930323600769043
Epoch: 8, Steps: 123 | Train Loss: 0.5973458 Vali Loss: 0.6264031 Best vali loss: 0.6056440

best validation loss 0.6056439650935853

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9394412
	speed: 0.0090s/iter; left time: 16.7024s
	iters: 200, epoch: 1 | loss: 0.6095254
	speed: 0.0031s/iter; left time: 5.4412s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0800507068634033
Epoch: 1, Steps: 245 | Train Loss: 0.7744833 Vali Loss: 0.6171308 Best vali loss: 0.6171308
	iters: 100, epoch: 2 | loss: 0.9086120
	speed: 0.0068s/iter; left time: 10.9903s
	iters: 200, epoch: 2 | loss: 1.0357687
	speed: 0.0032s/iter; left time: 4.8742s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.6171 --> 0.5876).  Saving model state dict ...
Epoch: 2 cost time: 0.8344821929931641
Epoch: 2, Steps: 245 | Train Loss: 0.9721904 Vali Loss: 0.5875502 Best vali loss: 0.5875502
	iters: 100, epoch: 3 | loss: 1.6747396
	speed: 0.0067s/iter; left time: 9.2280s
	iters: 200, epoch: 3 | loss: 0.6135320
	speed: 0.0027s/iter; left time: 3.4293s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 0.7350113391876221
Epoch: 3, Steps: 245 | Train Loss: 1.1441358 Vali Loss: 0.6204701 Best vali loss: 0.5875502

best validation loss 0.5875501530085488

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.6729).  Saving model state dict ...
Epoch: 1 cost time: 0.7685346603393555
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6729034 Best vali loss: 0.6729034
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.6729 --> 0.6415).  Saving model state dict ...
Epoch: 2 cost time: 0.46869540214538574
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6415093 Best vali loss: 0.6415093
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.6415 --> 0.6291).  Saving model state dict ...
Epoch: 3 cost time: 0.4813086986541748
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6290618 Best vali loss: 0.6290618

best validation loss 0.6290617655240403

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5304448
	speed: 0.0107s/iter; left time: 19.8263s
	iters: 200, epoch: 1 | loss: 0.6314977
	speed: 0.0047s/iter; left time: 8.3324s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.6294).  Saving model state dict ...
Epoch: 1 cost time: 1.4850456714630127
Epoch: 1, Steps: 245 | Train Loss: 0.5809713 Vali Loss: 0.6294373 Best vali loss: 0.6294373
	iters: 100, epoch: 2 | loss: 0.6687557
	speed: 0.0095s/iter; left time: 15.3166s
	iters: 200, epoch: 2 | loss: 1.0127143
	speed: 0.0048s/iter; left time: 7.3409s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 1.2381913661956787
Epoch: 2, Steps: 245 | Train Loss: 0.8407350 Vali Loss: 0.6550818 Best vali loss: 0.6294373
	iters: 100, epoch: 3 | loss: 1.0067443
	speed: 0.0094s/iter; left time: 12.8571s
	iters: 200, epoch: 3 | loss: 0.8223826
	speed: 0.0046s/iter; left time: 5.9023s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 1.1804277896881104
Epoch: 3, Steps: 245 | Train Loss: 0.9145634 Vali Loss: 0.6363619 Best vali loss: 0.6294373

best validation loss 0.6294372611330483

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8141781
	speed: 0.0093s/iter; left time: 10.4723s
	iters: 200, epoch: 4 | loss: 0.5156237
	speed: 0.0030s/iter; left time: 3.0370s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 1.0829107761383057
Epoch: 4, Steps: 245 | Train Loss: 0.6649009 Vali Loss: 0.6295721 Best vali loss: 0.5875502
	iters: 100, epoch: 5 | loss: 0.8298882
	speed: 0.0066s/iter; left time: 5.7754s
	iters: 200, epoch: 5 | loss: 0.9663600
	speed: 0.0029s/iter; left time: 2.2503s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 0.7559633255004883
Epoch: 5, Steps: 245 | Train Loss: 0.8981241 Vali Loss: 0.6488134 Best vali loss: 0.5875502
	iters: 100, epoch: 6 | loss: 0.7515063
	speed: 0.0064s/iter; left time: 4.0714s
	iters: 200, epoch: 6 | loss: 0.5283498
	speed: 0.0028s/iter; left time: 1.4989s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 0.7278196811676025
Epoch: 6, Steps: 245 | Train Loss: 0.6399281 Vali Loss: 0.6754198 Best vali loss: 0.5875502
	iters: 100, epoch: 7 | loss: 0.3799561
	speed: 0.0063s/iter; left time: 2.4588s
	iters: 200, epoch: 7 | loss: 0.6893539
	speed: 0.0027s/iter; left time: 0.7859s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 0.7161152362823486
Epoch: 7, Steps: 245 | Train Loss: 0.5346550 Vali Loss: 0.6647093 Best vali loss: 0.5875502
	iters: 100, epoch: 8 | loss: 0.5683563
	speed: 0.0060s/iter; left time: 0.8826s
	iters: 200, epoch: 8 | loss: 0.4495089
	speed: 0.0027s/iter; left time: 0.1224s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7057323455810547
Epoch: 8, Steps: 245 | Train Loss: 0.5089326 Vali Loss: 0.6718574 Best vali loss: 0.5875502

best validation loss 0.5875501530085488

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7009785
	speed: 0.0100s/iter; left time: 18.6386s
	iters: 200, epoch: 1 | loss: 0.6608922
	speed: 0.0041s/iter; left time: 7.1850s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.6009).  Saving model state dict ...
Epoch: 1 cost time: 1.33366060256958
Epoch: 1, Steps: 245 | Train Loss: 0.6809354 Vali Loss: 0.6008588 Best vali loss: 0.6008588
	iters: 100, epoch: 2 | loss: 0.3765644
	speed: 0.0083s/iter; left time: 13.4481s
	iters: 200, epoch: 2 | loss: 0.8807611
	speed: 0.0037s/iter; left time: 5.5773s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 0.957838773727417
Epoch: 2, Steps: 245 | Train Loss: 0.6286628 Vali Loss: 0.6017963 Best vali loss: 0.6008588
	iters: 100, epoch: 3 | loss: 0.7972597
	speed: 0.0077s/iter; left time: 10.5537s
	iters: 200, epoch: 3 | loss: 0.6581842
	speed: 0.0036s/iter; left time: 4.6117s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 0.9451289176940918
Epoch: 3, Steps: 245 | Train Loss: 0.7277220 Vali Loss: 0.6105465 Best vali loss: 0.6008588
	iters: 100, epoch: 4 | loss: 0.7245772
	speed: 0.0081s/iter; left time: 9.1056s
	iters: 200, epoch: 4 | loss: 0.7678013
	speed: 0.0037s/iter; left time: 3.8007s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 0.9726815223693848
Epoch: 4, Steps: 245 | Train Loss: 0.7461893 Vali Loss: 0.6145850 Best vali loss: 0.6008588
	iters: 100, epoch: 5 | loss: 0.8657176
	speed: 0.0078s/iter; left time: 6.8623s
	iters: 200, epoch: 5 | loss: 0.9035603
	speed: 0.0037s/iter; left time: 2.9211s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 0.9632391929626465
Epoch: 5, Steps: 245 | Train Loss: 0.8846390 Vali Loss: 0.6146066 Best vali loss: 0.6008588
	iters: 100, epoch: 6 | loss: 1.0705574
	speed: 0.0081s/iter; left time: 5.1559s
	iters: 200, epoch: 6 | loss: 0.8922628
	speed: 0.0039s/iter; left time: 2.0802s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 1.0138978958129883
Epoch: 6, Steps: 245 | Train Loss: 0.9814101 Vali Loss: 0.6140986 Best vali loss: 0.6008588
	iters: 100, epoch: 7 | loss: 0.8542031
	speed: 0.0082s/iter; left time: 3.1907s
	iters: 200, epoch: 7 | loss: 0.6489883
	speed: 0.0039s/iter; left time: 1.1283s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 1.0016677379608154
Epoch: 7, Steps: 245 | Train Loss: 0.7515957 Vali Loss: 0.6145621 Best vali loss: 0.6008588
	iters: 100, epoch: 8 | loss: 0.7631882
	speed: 0.0080s/iter; left time: 1.1656s
	iters: 200, epoch: 8 | loss: 1.0270927
	speed: 0.0039s/iter; left time: 0.1786s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 0.9963805675506592
Epoch: 8, Steps: 245 | Train Loss: 0.8951404 Vali Loss: 0.6139698 Best vali loss: 0.6008588

best validation loss 0.6008588288294833

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7584117
	speed: 0.0087s/iter; left time: 67.6529s
	iters: 200, epoch: 1 | loss: 1.0837867
	speed: 0.0026s/iter; left time: 19.7900s
	iters: 300, epoch: 1 | loss: 1.3170573
	speed: 0.0026s/iter; left time: 19.5018s
	iters: 400, epoch: 1 | loss: 0.6943889
	speed: 0.0025s/iter; left time: 18.6730s
	iters: 500, epoch: 1 | loss: 0.7730120
	speed: 0.0024s/iter; left time: 17.8937s
	iters: 600, epoch: 1 | loss: 0.8581119
	speed: 0.0024s/iter; left time: 17.5774s
	iters: 700, epoch: 1 | loss: 1.3544631
	speed: 0.0024s/iter; left time: 17.3301s
	iters: 800, epoch: 1 | loss: 1.4088398
	speed: 0.0024s/iter; left time: 17.1275s
	iters: 900, epoch: 1 | loss: 1.4364223
	speed: 0.0024s/iter; left time: 16.7793s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.6467).  Saving model state dict ...
Epoch: 1 cost time: 2.7898781299591064
Epoch: 1, Steps: 979 | Train Loss: 1.0760549 Vali Loss: 0.6466931 Best vali loss: 0.6466931
	iters: 100, epoch: 2 | loss: 0.6091095
	speed: 0.0092s/iter; left time: 62.3774s
	iters: 200, epoch: 2 | loss: 0.8875582
	speed: 0.0023s/iter; left time: 15.5501s
	iters: 300, epoch: 2 | loss: 0.6466188
	speed: 0.0024s/iter; left time: 15.4152s
	iters: 400, epoch: 2 | loss: 0.6506981
	speed: 0.0024s/iter; left time: 15.3860s
	iters: 500, epoch: 2 | loss: 2.1116312
	speed: 0.0024s/iter; left time: 14.9682s
	iters: 600, epoch: 2 | loss: 0.9000413
	speed: 0.0024s/iter; left time: 14.8870s
	iters: 700, epoch: 2 | loss: 0.2862469
	speed: 0.0023s/iter; left time: 14.3362s
	iters: 800, epoch: 2 | loss: 0.9390205
	speed: 0.0024s/iter; left time: 14.4358s
	iters: 900, epoch: 2 | loss: 1.1463523
	speed: 0.0024s/iter; left time: 14.2581s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.6467 --> 0.5847).  Saving model state dict ...
Epoch: 2 cost time: 2.365640878677368
Epoch: 2, Steps: 979 | Train Loss: 0.9085863 Vali Loss: 0.5846718 Best vali loss: 0.5846718
	iters: 100, epoch: 3 | loss: 0.5987027
	speed: 0.0092s/iter; left time: 52.8944s
	iters: 200, epoch: 3 | loss: 1.1086594
	speed: 0.0023s/iter; left time: 13.2241s
	iters: 300, epoch: 3 | loss: 0.5928872
	speed: 0.0024s/iter; left time: 13.3700s
	iters: 400, epoch: 3 | loss: 0.9710010
	speed: 0.0024s/iter; left time: 12.9188s
	iters: 500, epoch: 3 | loss: 0.5959847
	speed: 0.0023s/iter; left time: 12.4376s
	iters: 600, epoch: 3 | loss: 1.0453671
	speed: 0.0023s/iter; left time: 12.2335s
	iters: 700, epoch: 3 | loss: 1.7980829
	speed: 0.0023s/iter; left time: 12.0807s
	iters: 800, epoch: 3 | loss: 0.6843312
	speed: 0.0024s/iter; left time: 12.1962s
	iters: 900, epoch: 3 | loss: 1.1551108
	speed: 0.0024s/iter; left time: 11.7733s
Updating learning rate to 0.0004533601436
Validation loss decreased (0.5847 --> 0.5807).  Saving model state dict ...
Epoch: 3 cost time: 2.349198818206787
Epoch: 3, Steps: 979 | Train Loss: 0.9500141 Vali Loss: 0.5807126 Best vali loss: 0.5807126
	iters: 100, epoch: 4 | loss: 0.4964791
	speed: 0.0095s/iter; left time: 45.4058s
	iters: 200, epoch: 4 | loss: 1.3356310
	speed: 0.0024s/iter; left time: 11.4968s
	iters: 300, epoch: 4 | loss: 0.2933791
	speed: 0.0025s/iter; left time: 11.4507s
	iters: 400, epoch: 4 | loss: 0.3676149
	speed: 0.0025s/iter; left time: 11.3754s
	iters: 500, epoch: 4 | loss: 0.7518328
	speed: 0.0025s/iter; left time: 11.2017s
	iters: 600, epoch: 4 | loss: 0.4110796
	speed: 0.0026s/iter; left time: 11.0294s
	iters: 700, epoch: 4 | loss: 0.4554754
	speed: 0.0026s/iter; left time: 10.7906s
	iters: 800, epoch: 4 | loss: 0.8020997
	speed: 0.0026s/iter; left time: 10.5238s
	iters: 900, epoch: 4 | loss: 0.9708830
	speed: 0.0025s/iter; left time: 9.9509s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 2.520534038543701
Epoch: 4, Steps: 979 | Train Loss: 0.6538305 Vali Loss: 0.5958964 Best vali loss: 0.5807126
	iters: 100, epoch: 5 | loss: 0.8589917
	speed: 0.0089s/iter; left time: 33.9916s
	iters: 200, epoch: 5 | loss: 0.8996664
	speed: 0.0024s/iter; left time: 9.0302s
	iters: 300, epoch: 5 | loss: 0.3661706
	speed: 0.0024s/iter; left time: 8.7610s
	iters: 400, epoch: 5 | loss: 1.1354368
	speed: 0.0024s/iter; left time: 8.5957s
	iters: 500, epoch: 5 | loss: 0.8607676
	speed: 0.0025s/iter; left time: 8.3828s
	iters: 600, epoch: 5 | loss: 0.8520684
	speed: 0.0024s/iter; left time: 7.8966s
	iters: 700, epoch: 5 | loss: 1.4339676
	speed: 0.0023s/iter; left time: 7.4939s
	iters: 800, epoch: 5 | loss: 0.9376504
	speed: 0.0023s/iter; left time: 7.2298s
	iters: 900, epoch: 5 | loss: 0.6254026
	speed: 0.0024s/iter; left time: 7.2491s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 2.4013302326202393
Epoch: 5, Steps: 979 | Train Loss: 0.8855691 Vali Loss: 0.5858504 Best vali loss: 0.5807126
	iters: 100, epoch: 6 | loss: 0.7096080
	speed: 0.0091s/iter; left time: 25.7032s
	iters: 200, epoch: 6 | loss: 1.0383046
	speed: 0.0026s/iter; left time: 7.0629s
	iters: 300, epoch: 6 | loss: 0.3097647
	speed: 0.0025s/iter; left time: 6.6909s
	iters: 400, epoch: 6 | loss: 0.5518014
	speed: 0.0026s/iter; left time: 6.4925s
	iters: 500, epoch: 6 | loss: 0.4746187
	speed: 0.0026s/iter; left time: 6.2901s
	iters: 600, epoch: 6 | loss: 0.4544873
	speed: 0.0026s/iter; left time: 6.0146s
	iters: 700, epoch: 6 | loss: 0.9073927
	speed: 0.0026s/iter; left time: 5.7384s
	iters: 800, epoch: 6 | loss: 1.1085141
	speed: 0.0025s/iter; left time: 5.3915s
	iters: 900, epoch: 6 | loss: 0.6501168
	speed: 0.0025s/iter; left time: 5.0877s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 2.5316779613494873
Epoch: 6, Steps: 979 | Train Loss: 0.6894009 Vali Loss: 0.5850844 Best vali loss: 0.5807126
	iters: 100, epoch: 7 | loss: 1.0461875
	speed: 0.0094s/iter; left time: 17.4725s
	iters: 200, epoch: 7 | loss: 0.2596434
	speed: 0.0025s/iter; left time: 4.4226s
	iters: 300, epoch: 7 | loss: 0.6063083
	speed: 0.0026s/iter; left time: 4.2395s
	iters: 400, epoch: 7 | loss: 0.5559909
	speed: 0.0026s/iter; left time: 3.9970s
	iters: 500, epoch: 7 | loss: 1.8279536
	speed: 0.0026s/iter; left time: 3.7331s
	iters: 600, epoch: 7 | loss: 0.4235749
	speed: 0.0025s/iter; left time: 3.4650s
	iters: 700, epoch: 7 | loss: 0.6714557
	speed: 0.0026s/iter; left time: 3.2231s
	iters: 800, epoch: 7 | loss: 1.0197628
	speed: 0.0025s/iter; left time: 2.9551s
	iters: 900, epoch: 7 | loss: 1.1940567
	speed: 0.0025s/iter; left time: 2.6937s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 2.523336172103882
Epoch: 7, Steps: 979 | Train Loss: 0.8449926 Vali Loss: 0.5928452 Best vali loss: 0.5807126
	iters: 100, epoch: 8 | loss: 0.4318188
	speed: 0.0089s/iter; left time: 7.8201s
	iters: 200, epoch: 8 | loss: 0.6509242
	speed: 0.0026s/iter; left time: 2.0357s
	iters: 300, epoch: 8 | loss: 0.8570777
	speed: 0.0026s/iter; left time: 1.7722s
	iters: 400, epoch: 8 | loss: 0.3733908
	speed: 0.0025s/iter; left time: 1.4691s
	iters: 500, epoch: 8 | loss: 0.6193485
	speed: 0.0025s/iter; left time: 1.1908s
	iters: 600, epoch: 8 | loss: 1.0235531
	speed: 0.0024s/iter; left time: 0.9234s
	iters: 700, epoch: 8 | loss: 0.8260942
	speed: 0.0025s/iter; left time: 0.6880s
	iters: 800, epoch: 8 | loss: 0.4069418
	speed: 0.0024s/iter; left time: 0.4372s
	iters: 900, epoch: 8 | loss: 0.9978020
	speed: 0.0026s/iter; left time: 0.2041s
Updating learning rate to 1.41675044875e-05
Epoch: 8 cost time: 2.5077600479125977
Epoch: 8, Steps: 979 | Train Loss: 0.6874390 Vali Loss: 0.5884717 Best vali loss: 0.5807126

best validation loss 0.5807125919784235

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.6603).  Saving model state dict ...
Epoch: 1 cost time: 0.7119925022125244
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6602601 Best vali loss: 0.6602601
Updating learning rate to 0.0002257411363
Validation loss decreased (0.6603 --> 0.6267).  Saving model state dict ...
Epoch: 2 cost time: 0.4407386779785156
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6266590 Best vali loss: 0.6266590
Updating learning rate to 0.00011287056815
Validation loss decreased (0.6267 --> 0.6200).  Saving model state dict ...
Epoch: 3 cost time: 0.4488942623138428
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6199643 Best vali loss: 0.6199643

best validation loss 0.6199642525454022

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0366331
	speed: 0.0099s/iter; left time: 8.7432s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.6089).  Saving model state dict ...
Epoch: 1 cost time: 0.8225617408752441
Epoch: 1, Steps: 123 | Train Loss: 1.0366331 Vali Loss: 0.6089155 Best vali loss: 0.6089155
	iters: 100, epoch: 2 | loss: 0.6541998
	speed: 0.0067s/iter; left time: 5.1178s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.6089 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 0.5062780380249023
Epoch: 2, Steps: 123 | Train Loss: 0.6541998 Vali Loss: 0.6069120 Best vali loss: 0.6069120
	iters: 100, epoch: 3 | loss: 0.7972841
	speed: 0.0067s/iter; left time: 4.3126s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.6069 --> 0.6030).  Saving model state dict ...
Epoch: 3 cost time: 0.49375152587890625
Epoch: 3, Steps: 123 | Train Loss: 0.7972841 Vali Loss: 0.6030117 Best vali loss: 0.6030117

best validation loss 0.6030116897664209

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6920349
	speed: 0.0092s/iter; left time: 17.1672s
	iters: 200, epoch: 1 | loss: 1.3515167
	speed: 0.0028s/iter; left time: 4.9278s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.6149).  Saving model state dict ...
Epoch: 1 cost time: 1.058988332748413
Epoch: 1, Steps: 245 | Train Loss: 1.0217758 Vali Loss: 0.6149432 Best vali loss: 0.6149432
	iters: 100, epoch: 2 | loss: 0.8714641
	speed: 0.0065s/iter; left time: 10.5532s
	iters: 200, epoch: 2 | loss: 0.3793433
	speed: 0.0028s/iter; left time: 4.1838s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 0.7334785461425781
Epoch: 2, Steps: 245 | Train Loss: 0.6254037 Vali Loss: 0.6338814 Best vali loss: 0.6149432
	iters: 100, epoch: 3 | loss: 1.0114591
	speed: 0.0065s/iter; left time: 8.9765s
	iters: 200, epoch: 3 | loss: 0.8901668
	speed: 0.0030s/iter; left time: 3.7577s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 0.7668511867523193
Epoch: 3, Steps: 245 | Train Loss: 0.9508129 Vali Loss: 0.6242000 Best vali loss: 0.6149432

best validation loss 0.6149431942293678

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0140613
	speed: 0.0101s/iter; left time: 5.1871s
Updating learning rate to 8.53825975e-06
Validation loss decreased (0.6030 --> 0.6028).  Saving model state dict ...
Epoch: 4 cost time: 0.8318479061126709
Epoch: 4, Steps: 123 | Train Loss: 1.0140613 Vali Loss: 0.6028259 Best vali loss: 0.6028259
	iters: 100, epoch: 5 | loss: 0.6503785
	speed: 0.0066s/iter; left time: 2.5940s
Updating learning rate to 4.269129875e-06
Epoch: 5 cost time: 0.47774672508239746
Epoch: 5, Steps: 123 | Train Loss: 0.6503785 Vali Loss: 0.6050870 Best vali loss: 0.6028259
	iters: 100, epoch: 6 | loss: 0.7845382
	speed: 0.0066s/iter; left time: 1.7921s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 0.5123231410980225
Epoch: 6, Steps: 123 | Train Loss: 0.7845382 Vali Loss: 0.6049494 Best vali loss: 0.6028259
	iters: 100, epoch: 7 | loss: 1.0978216
	speed: 0.0067s/iter; left time: 0.9885s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 0.516716718673706
Epoch: 7, Steps: 123 | Train Loss: 1.0978216 Vali Loss: 0.6051946 Best vali loss: 0.6028259
	iters: 100, epoch: 8 | loss: 0.6612026
	speed: 0.0067s/iter; left time: 0.1608s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 0.5044856071472168
Epoch: 8, Steps: 123 | Train Loss: 0.6612026 Vali Loss: 0.6052301 Best vali loss: 0.6028259

best validation loss 0.6028258996890243

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9660220
	speed: 0.0099s/iter; left time: 18.5110s
	iters: 200, epoch: 1 | loss: 0.9020447
	speed: 0.0040s/iter; left time: 7.0482s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.3254997730255127
Epoch: 1, Steps: 245 | Train Loss: 0.9340334 Vali Loss: 0.6040087 Best vali loss: 0.6040087
	iters: 100, epoch: 2 | loss: 1.0952461
	speed: 0.0079s/iter; left time: 12.8353s
	iters: 200, epoch: 2 | loss: 0.5863059
	speed: 0.0037s/iter; left time: 5.6261s
Updating learning rate to 0.0011100975329
Epoch: 2 cost time: 0.9551572799682617
Epoch: 2, Steps: 245 | Train Loss: 0.8407760 Vali Loss: 0.6081345 Best vali loss: 0.6040087
	iters: 100, epoch: 3 | loss: 0.9699066
	speed: 0.0077s/iter; left time: 10.5634s
	iters: 200, epoch: 3 | loss: 1.0216160
	speed: 0.0035s/iter; left time: 4.4798s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 0.9351902008056641
Epoch: 3, Steps: 245 | Train Loss: 0.9957613 Vali Loss: 0.6739932 Best vali loss: 0.6040087
	iters: 100, epoch: 4 | loss: 0.5371025
	speed: 0.0075s/iter; left time: 8.4686s
	iters: 200, epoch: 4 | loss: 0.7862545
	speed: 0.0036s/iter; left time: 3.7006s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 0.9164209365844727
Epoch: 4, Steps: 245 | Train Loss: 0.6616785 Vali Loss: 0.6375329 Best vali loss: 0.6040087
	iters: 100, epoch: 5 | loss: 0.5398117
	speed: 0.0075s/iter; left time: 6.6180s
	iters: 200, epoch: 5 | loss: 0.5553857
	speed: 0.0036s/iter; left time: 2.7901s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 0.9070913791656494
Epoch: 5, Steps: 245 | Train Loss: 0.5475987 Vali Loss: 0.6623029 Best vali loss: 0.6040087
	iters: 100, epoch: 6 | loss: 1.0712121
	speed: 0.0075s/iter; left time: 4.7769s
	iters: 200, epoch: 6 | loss: 0.5165262
	speed: 0.0036s/iter; left time: 1.9321s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 0.9319465160369873
Epoch: 6, Steps: 245 | Train Loss: 0.7938691 Vali Loss: 0.6423522 Best vali loss: 0.6040087
	iters: 100, epoch: 7 | loss: 0.4137741
	speed: 0.0077s/iter; left time: 2.9995s
	iters: 200, epoch: 7 | loss: 0.8540576
	speed: 0.0036s/iter; left time: 1.0402s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 0.9313657283782959
Epoch: 7, Steps: 245 | Train Loss: 0.6339159 Vali Loss: 0.6453954 Best vali loss: 0.6040087
	iters: 100, epoch: 8 | loss: 0.9190345
	speed: 0.0074s/iter; left time: 1.0847s
	iters: 200, epoch: 8 | loss: 0.5188770
	speed: 0.0034s/iter; left time: 0.1541s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 0.8811805248260498
Epoch: 8, Steps: 245 | Train Loss: 0.7189558 Vali Loss: 0.6506783 Best vali loss: 0.6040087

best validation loss 0.6040086972939642

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.6664).  Saving model state dict ...
Epoch: 1 cost time: 0.7529282569885254
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6663814 Best vali loss: 0.6663814
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.6664 --> 0.6384).  Saving model state dict ...
Epoch: 2 cost time: 0.41718435287475586
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6384326 Best vali loss: 0.6384326
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.6384 --> 0.6262).  Saving model state dict ...
Epoch: 3 cost time: 0.41625452041625977
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6261585 Best vali loss: 0.6261585
Updating learning rate to 0.00017563123165
Validation loss decreased (0.6262 --> 0.6165).  Saving model state dict ...
Epoch: 4 cost time: 0.4274020195007324
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6164508 Best vali loss: 0.6164508
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.6165 --> 0.6146).  Saving model state dict ...
Epoch: 5 cost time: 0.4325523376464844
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6145596 Best vali loss: 0.6145596
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.6146 --> 0.6124).  Saving model state dict ...
Epoch: 6 cost time: 0.46143460273742676
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6123517 Best vali loss: 0.6123517
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.6124 --> 0.6116).  Saving model state dict ...
Epoch: 7 cost time: 0.4262373447418213
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6116121 Best vali loss: 0.6116121
Updating learning rate to 0.0
Validation loss decreased (0.6116 --> 0.6114).  Saving model state dict ...
Epoch: 8 cost time: 0.4467298984527588
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6113793 Best vali loss: 0.6113793

best validation loss 0.6113793455798667

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1740562
	speed: 0.0097s/iter; left time: 37.0655s
	iters: 200, epoch: 1 | loss: 1.1978114
	speed: 0.0037s/iter; left time: 13.6804s
	iters: 300, epoch: 1 | loss: 0.6273263
	speed: 0.0035s/iter; left time: 12.8076s
	iters: 400, epoch: 1 | loss: 1.1035664
	speed: 0.0036s/iter; left time: 12.8363s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.5997).  Saving model state dict ...
Epoch: 1 cost time: 2.1355702877044678
Epoch: 1, Steps: 490 | Train Loss: 1.0256901 Vali Loss: 0.5996911 Best vali loss: 0.5996911
	iters: 100, epoch: 2 | loss: 0.8819800
	speed: 0.0102s/iter; left time: 34.1368s
	iters: 200, epoch: 2 | loss: 0.8823318
	speed: 0.0036s/iter; left time: 11.5621s
	iters: 300, epoch: 2 | loss: 0.9039207
	speed: 0.0035s/iter; left time: 11.0034s
	iters: 400, epoch: 2 | loss: 1.0277607
	speed: 0.0037s/iter; left time: 11.1181s
Updating learning rate to 4.67349404e-05
Validation loss decreased (0.5997 --> 0.5850).  Saving model state dict ...
Epoch: 2 cost time: 1.8089537620544434
Epoch: 2, Steps: 490 | Train Loss: 0.9239983 Vali Loss: 0.5850183 Best vali loss: 0.5850183
	iters: 100, epoch: 3 | loss: 0.5545235
	speed: 0.0104s/iter; left time: 29.4631s
	iters: 200, epoch: 3 | loss: 0.6562951
	speed: 0.0038s/iter; left time: 10.3694s
	iters: 300, epoch: 3 | loss: 0.3734279
	speed: 0.0037s/iter; left time: 9.8896s
	iters: 400, epoch: 3 | loss: 0.6900953
	speed: 0.0037s/iter; left time: 9.4884s
Updating learning rate to 2.33674702e-05
Epoch: 3 cost time: 1.8840811252593994
Epoch: 3, Steps: 490 | Train Loss: 0.5685855 Vali Loss: 0.6208820 Best vali loss: 0.5850183

best validation loss 0.5850183171621355

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2042421
	speed: 0.0111s/iter; left time: 42.4266s
	iters: 200, epoch: 1 | loss: 0.3855742
	speed: 0.0052s/iter; left time: 19.4239s
	iters: 300, epoch: 1 | loss: 0.5746676
	speed: 0.0053s/iter; left time: 19.3240s
	iters: 400, epoch: 1 | loss: 1.0443676
	speed: 0.0054s/iter; left time: 18.8708s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.5985).  Saving model state dict ...
Epoch: 1 cost time: 2.921210765838623
Epoch: 1, Steps: 490 | Train Loss: 0.8022129 Vali Loss: 0.5985390 Best vali loss: 0.5985390
	iters: 100, epoch: 2 | loss: 1.9946237
	speed: 0.0140s/iter; left time: 46.5456s
	iters: 200, epoch: 2 | loss: 0.8799880
	speed: 0.0053s/iter; left time: 17.1537s
	iters: 300, epoch: 2 | loss: 0.8482473
	speed: 0.0054s/iter; left time: 16.8421s
	iters: 400, epoch: 2 | loss: 0.5518042
	speed: 0.0054s/iter; left time: 16.3630s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 2.6670501232147217
Epoch: 2, Steps: 490 | Train Loss: 1.0686658 Vali Loss: 0.5995943 Best vali loss: 0.5985390
	iters: 100, epoch: 3 | loss: 0.9125831
	speed: 0.0137s/iter; left time: 38.9718s
	iters: 200, epoch: 3 | loss: 0.6522782
	speed: 0.0051s/iter; left time: 13.9877s
	iters: 300, epoch: 3 | loss: 0.7498344
	speed: 0.0052s/iter; left time: 13.6272s
	iters: 400, epoch: 3 | loss: 0.5275347
	speed: 0.0049s/iter; left time: 12.4828s
Updating learning rate to 0.000170244824075
Validation loss decreased (0.5985 --> 0.5673).  Saving model state dict ...
Epoch: 3 cost time: 2.5057373046875
Epoch: 3, Steps: 490 | Train Loss: 0.7105576 Vali Loss: 0.5673004 Best vali loss: 0.5673004

best validation loss 0.5673003665334039

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.6618).  Saving model state dict ...
Epoch: 1 cost time: 0.6818022727966309
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6617667 Best vali loss: 0.6617667
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.6618 --> 0.6294).  Saving model state dict ...
Epoch: 2 cost time: 0.4204564094543457
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6294398 Best vali loss: 0.6294398
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.6294 --> 0.6205).  Saving model state dict ...
Epoch: 3 cost time: 0.41810083389282227
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6205024 Best vali loss: 0.6205024

best validation loss 0.6205023785312658

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0241462
	speed: 0.0114s/iter; left time: 26.8611s
	iters: 200, epoch: 4 | loss: 0.3119469
	speed: 0.0051s/iter; left time: 11.3879s
	iters: 300, epoch: 4 | loss: 0.4976002
	speed: 0.0051s/iter; left time: 10.8947s
	iters: 400, epoch: 4 | loss: 0.8459934
	speed: 0.0050s/iter; left time: 10.3387s
Updating learning rate to 8.51224120375e-05
Validation loss decreased (0.5673 --> 0.5506).  Saving model state dict ...
Epoch: 4 cost time: 2.8455278873443604
Epoch: 4, Steps: 490 | Train Loss: 0.6699217 Vali Loss: 0.5505865 Best vali loss: 0.5505865
	iters: 100, epoch: 5 | loss: 1.3421296
	speed: 0.0138s/iter; left time: 25.6018s
	iters: 200, epoch: 5 | loss: 0.8237901
	speed: 0.0052s/iter; left time: 9.2282s
	iters: 300, epoch: 5 | loss: 0.8102024
	speed: 0.0052s/iter; left time: 8.5916s
	iters: 400, epoch: 5 | loss: 0.5120167
	speed: 0.0052s/iter; left time: 8.0520s
Updating learning rate to 4.256120601875e-05
Epoch: 5 cost time: 2.582685947418213
Epoch: 5, Steps: 490 | Train Loss: 0.8720347 Vali Loss: 0.5566992 Best vali loss: 0.5505865
	iters: 100, epoch: 6 | loss: 0.6868811
	speed: 0.0135s/iter; left time: 18.5541s
	iters: 200, epoch: 6 | loss: 0.6257582
	speed: 0.0049s/iter; left time: 6.2501s
	iters: 300, epoch: 6 | loss: 0.7078272
	speed: 0.0050s/iter; left time: 5.8582s
	iters: 400, epoch: 6 | loss: 0.4789426
	speed: 0.0049s/iter; left time: 5.2458s
Updating learning rate to 2.1280603009375e-05
Epoch: 6 cost time: 2.4640650749206543
Epoch: 6, Steps: 490 | Train Loss: 0.6248523 Vali Loss: 0.5560498 Best vali loss: 0.5505865
	iters: 100, epoch: 7 | loss: 0.7994286
	speed: 0.0135s/iter; left time: 11.9287s
	iters: 200, epoch: 7 | loss: 0.2902839
	speed: 0.0053s/iter; left time: 4.1155s
	iters: 300, epoch: 7 | loss: 0.8012778
	speed: 0.0052s/iter; left time: 3.5716s
	iters: 400, epoch: 7 | loss: 0.8068563
	speed: 0.0052s/iter; left time: 3.0345s
Updating learning rate to 1.06403015046875e-05
Epoch: 7 cost time: 2.6157760620117188
Epoch: 7, Steps: 490 | Train Loss: 0.6744616 Vali Loss: 0.5560592 Best vali loss: 0.5505865
	iters: 100, epoch: 8 | loss: 0.7688867
	speed: 0.0136s/iter; left time: 5.3356s
	iters: 200, epoch: 8 | loss: 1.0791886
	speed: 0.0053s/iter; left time: 1.5342s
	iters: 300, epoch: 8 | loss: 0.7168204
	speed: 0.0053s/iter; left time: 1.0181s
	iters: 400, epoch: 8 | loss: 0.6244248
	speed: 0.0053s/iter; left time: 0.4863s
Updating learning rate to 5.32015075234375e-06
Epoch: 8 cost time: 2.6380386352539062
Epoch: 8, Steps: 490 | Train Loss: 0.7973301 Vali Loss: 0.5559387 Best vali loss: 0.5505865

best validation loss 0.5505864805007963

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.7050).  Saving model state dict ...
Epoch: 1 cost time: 0.7337231636047363
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7049747 Best vali loss: 0.7049747
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.7050 --> 0.6941).  Saving model state dict ...
Epoch: 2 cost time: 0.43697285652160645
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6940604 Best vali loss: 0.6940604
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.6941 --> 0.6889).  Saving model state dict ...
Epoch: 3 cost time: 0.44838404655456543
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6888544 Best vali loss: 0.6888544
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.6889 --> 0.6864).  Saving model state dict ...
Epoch: 4 cost time: 0.442990779876709
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6864056 Best vali loss: 0.6864056
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.6864 --> 0.6852).  Saving model state dict ...
Epoch: 5 cost time: 0.42144083976745605
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6852221 Best vali loss: 0.6852221
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.6852 --> 0.6846).  Saving model state dict ...
Epoch: 6 cost time: 0.4358792304992676
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6846244 Best vali loss: 0.6846244
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.6846 --> 0.6843).  Saving model state dict ...
Epoch: 7 cost time: 0.4348621368408203
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6843317 Best vali loss: 0.6843317
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.6843 --> 0.6842).  Saving model state dict ...
Epoch: 8 cost time: 0.4591948986053467
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6841823 Best vali loss: 0.6841823

best validation loss 0.6841822911721035

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6639593
	speed: 0.0107s/iter; left time: 19.9494s
	iters: 200, epoch: 1 | loss: 0.8535681
	speed: 0.0043s/iter; left time: 7.5999s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 1.4327456951141357
Epoch: 1, Steps: 245 | Train Loss: 0.7587637 Vali Loss: 0.6140098 Best vali loss: 0.6140098
	iters: 100, epoch: 2 | loss: 0.6790031
	speed: 0.0089s/iter; left time: 14.4025s
	iters: 200, epoch: 2 | loss: 0.7351314
	speed: 0.0043s/iter; left time: 6.5220s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 1.095062255859375
Epoch: 2, Steps: 245 | Train Loss: 0.7070672 Vali Loss: 0.6828928 Best vali loss: 0.6140098
	iters: 100, epoch: 3 | loss: 0.8068680
	speed: 0.0089s/iter; left time: 12.2392s
	iters: 200, epoch: 3 | loss: 0.6656123
	speed: 0.0045s/iter; left time: 5.7658s
Updating learning rate to 0.00030491694074585157
Validation loss decreased (0.6140 --> 0.6047).  Saving model state dict ...
Epoch: 3 cost time: 1.1762540340423584
Epoch: 3, Steps: 245 | Train Loss: 0.7362402 Vali Loss: 0.6047032 Best vali loss: 0.6047032
	iters: 100, epoch: 4 | loss: 0.8655283
	speed: 0.0094s/iter; left time: 10.5431s
	iters: 200, epoch: 4 | loss: 0.8601351
	speed: 0.0045s/iter; left time: 4.6417s
Updating learning rate to 0.0002205254895
Validation loss decreased (0.6047 --> 0.5356).  Saving model state dict ...
Epoch: 4 cost time: 1.1551735401153564
Epoch: 4, Steps: 245 | Train Loss: 0.8628317 Vali Loss: 0.5356371 Best vali loss: 0.5356371
	iters: 100, epoch: 5 | loss: 0.5973833
	speed: 0.0090s/iter; left time: 7.8980s
	iters: 200, epoch: 5 | loss: 0.6516000
	speed: 0.0046s/iter; left time: 3.6004s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.1547393798828125
Epoch: 5, Steps: 245 | Train Loss: 0.6244916 Vali Loss: 0.5374324 Best vali loss: 0.5356371
	iters: 100, epoch: 6 | loss: 0.9142206
	speed: 0.0093s/iter; left time: 5.8913s
	iters: 200, epoch: 6 | loss: 0.4888127
	speed: 0.0050s/iter; left time: 2.6662s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.2185533046722412
Epoch: 6, Steps: 245 | Train Loss: 0.7015166 Vali Loss: 0.5557638 Best vali loss: 0.5356371
	iters: 100, epoch: 7 | loss: 0.7461542
	speed: 0.0096s/iter; left time: 3.7450s
	iters: 200, epoch: 7 | loss: 0.7973536
	speed: 0.0045s/iter; left time: 1.2989s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.1613447666168213
Epoch: 7, Steps: 245 | Train Loss: 0.7717539 Vali Loss: 0.5669678 Best vali loss: 0.5356371
	iters: 100, epoch: 8 | loss: 0.5054745
	speed: 0.0095s/iter; left time: 1.3907s
	iters: 200, epoch: 8 | loss: 0.6621027
	speed: 0.0049s/iter; left time: 0.2265s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2667927742004395
Epoch: 8, Steps: 245 | Train Loss: 0.5837886 Vali Loss: 0.5692674 Best vali loss: 0.5356371

best validation loss 0.5356371417358925

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2034616
	speed: 0.0120s/iter; left time: 22.2608s
	iters: 200, epoch: 1 | loss: 0.7864718
	speed: 0.0060s/iter; left time: 10.5890s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.6540).  Saving model state dict ...
Epoch: 1 cost time: 1.8046023845672607
Epoch: 1, Steps: 245 | Train Loss: 0.9949667 Vali Loss: 0.6539882 Best vali loss: 0.6539882
	iters: 100, epoch: 2 | loss: 0.7707129
	speed: 0.0118s/iter; left time: 19.0339s
	iters: 200, epoch: 2 | loss: 1.2606068
	speed: 0.0058s/iter; left time: 8.8474s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.6540 --> 0.6316).  Saving model state dict ...
Epoch: 2 cost time: 1.4791030883789062
Epoch: 2, Steps: 245 | Train Loss: 1.0156598 Vali Loss: 0.6315617 Best vali loss: 0.6315617
	iters: 100, epoch: 3 | loss: 0.9593814
	speed: 0.0121s/iter; left time: 16.5357s
	iters: 200, epoch: 3 | loss: 1.1422479
	speed: 0.0058s/iter; left time: 7.3715s
Updating learning rate to 0.0006965792210563318
Epoch: 3 cost time: 1.463355302810669
Epoch: 3, Steps: 245 | Train Loss: 1.0508147 Vali Loss: 0.6317101 Best vali loss: 0.6315617

best validation loss 0.6315616729468011

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0217180
	speed: 0.0118s/iter; left time: 10.4834s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.6438).  Saving model state dict ...
Epoch: 1 cost time: 1.051276445388794
Epoch: 1, Steps: 123 | Train Loss: 1.0217180 Vali Loss: 0.6438304 Best vali loss: 0.6438304
	iters: 100, epoch: 2 | loss: 0.8586527
	speed: 0.0085s/iter; left time: 6.5046s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.6438 --> 0.6232).  Saving model state dict ...
Epoch: 2 cost time: 0.6784906387329102
Epoch: 2, Steps: 123 | Train Loss: 0.8586527 Vali Loss: 0.6231897 Best vali loss: 0.6231897
	iters: 100, epoch: 3 | loss: 0.8987868
	speed: 0.0083s/iter; left time: 5.3276s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.6232 --> 0.6159).  Saving model state dict ...
Epoch: 3 cost time: 0.665865421295166
Epoch: 3, Steps: 123 | Train Loss: 0.8987868 Vali Loss: 0.6159359 Best vali loss: 0.6159359

best validation loss 0.6159359394869612

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0297775
	speed: 0.0094s/iter; left time: 8.3426s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.6123).  Saving model state dict ...
Epoch: 1 cost time: 0.7574608325958252
Epoch: 1, Steps: 123 | Train Loss: 1.0297775 Vali Loss: 0.6122975 Best vali loss: 0.6122975
	iters: 100, epoch: 2 | loss: 0.8511786
	speed: 0.0067s/iter; left time: 5.0727s
Updating learning rate to 0.001511336270922462
Validation loss decreased (0.6123 --> 0.6027).  Saving model state dict ...
Epoch: 2 cost time: 0.5150027275085449
Epoch: 2, Steps: 123 | Train Loss: 0.8511786 Vali Loss: 0.6027492 Best vali loss: 0.6027492
	iters: 100, epoch: 3 | loss: 0.6749825
	speed: 0.0066s/iter; left time: 4.2232s
Updating learning rate to 0.0012241176975961933
Validation loss decreased (0.6027 --> 0.5894).  Saving model state dict ...
Epoch: 3 cost time: 0.49415087699890137
Epoch: 3, Steps: 123 | Train Loss: 0.6749825 Vali Loss: 0.5893820 Best vali loss: 0.5893820

best validation loss 0.5893819629732298

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9781250
	speed: 0.0097s/iter; left time: 4.9991s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 0.7867295742034912
Epoch: 4, Steps: 123 | Train Loss: 0.9781250 Vali Loss: 0.6236107 Best vali loss: 0.5893820
	iters: 100, epoch: 5 | loss: 0.7803482
	speed: 0.0064s/iter; left time: 2.5016s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 0.4788703918457031
Epoch: 5, Steps: 123 | Train Loss: 0.7803482 Vali Loss: 0.6203498 Best vali loss: 0.5893820
	iters: 100, epoch: 6 | loss: 0.6572651
	speed: 0.0065s/iter; left time: 1.7563s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 0.4974541664123535
Epoch: 6, Steps: 123 | Train Loss: 0.6572651 Vali Loss: 0.6053112 Best vali loss: 0.5893820
	iters: 100, epoch: 7 | loss: 0.9545114
	speed: 0.0065s/iter; left time: 0.9549s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 0.49063587188720703
Epoch: 7, Steps: 123 | Train Loss: 0.9545114 Vali Loss: 0.6230699 Best vali loss: 0.5893820
	iters: 100, epoch: 8 | loss: 0.4991679
	speed: 0.0066s/iter; left time: 0.1594s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.49999046325683594
Epoch: 8, Steps: 123 | Train Loss: 0.4991679 Vali Loss: 0.6269926 Best vali loss: 0.5893820

best validation loss 0.5893819629732298

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3006382
	speed: 0.0112s/iter; left time: 86.7448s
	iters: 200, epoch: 1 | loss: 1.0652275
	speed: 0.0052s/iter; left time: 39.3468s
	iters: 300, epoch: 1 | loss: 0.7258043
	speed: 0.0050s/iter; left time: 37.8093s
	iters: 400, epoch: 1 | loss: 1.5029094
	speed: 0.0051s/iter; left time: 38.0818s
	iters: 500, epoch: 1 | loss: 0.9351162
	speed: 0.0051s/iter; left time: 37.6546s
	iters: 600, epoch: 1 | loss: 1.4987140
	speed: 0.0051s/iter; left time: 37.1010s
	iters: 700, epoch: 1 | loss: 0.7734556
	speed: 0.0051s/iter; left time: 36.7106s
	iters: 800, epoch: 1 | loss: 1.2052027
	speed: 0.0052s/iter; left time: 36.3618s
	iters: 900, epoch: 1 | loss: 0.3400652
	speed: 0.0050s/iter; left time: 34.6367s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.6261).  Saving model state dict ...
Epoch: 1 cost time: 5.341213941574097
Epoch: 1, Steps: 979 | Train Loss: 1.0385703 Vali Loss: 0.6261428 Best vali loss: 0.6261428
	iters: 100, epoch: 2 | loss: 0.7776306
	speed: 0.0155s/iter; left time: 104.9288s
	iters: 200, epoch: 2 | loss: 0.3036362
	speed: 0.0050s/iter; left time: 33.2032s
	iters: 300, epoch: 2 | loss: 0.9124209
	speed: 0.0049s/iter; left time: 31.8182s
	iters: 400, epoch: 2 | loss: 0.9256549
	speed: 0.0046s/iter; left time: 29.8907s
	iters: 500, epoch: 2 | loss: 0.7198018
	speed: 0.0045s/iter; left time: 28.6286s
	iters: 600, epoch: 2 | loss: 0.7219809
	speed: 0.0046s/iter; left time: 28.6705s
	iters: 700, epoch: 2 | loss: 0.3174458
	speed: 0.0046s/iter; left time: 28.1699s
	iters: 800, epoch: 2 | loss: 0.7559130
	speed: 0.0047s/iter; left time: 28.4692s
	iters: 900, epoch: 2 | loss: 1.5923561
	speed: 0.0047s/iter; left time: 27.8058s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.6261 --> 0.6157).  Saving model state dict ...
Epoch: 2 cost time: 4.6798014640808105
Epoch: 2, Steps: 979 | Train Loss: 0.7807600 Vali Loss: 0.6157395 Best vali loss: 0.6157395
	iters: 100, epoch: 3 | loss: 0.4051180
	speed: 0.0151s/iter; left time: 87.0273s
	iters: 200, epoch: 3 | loss: 0.6041010
	speed: 0.0046s/iter; left time: 26.1844s
	iters: 300, epoch: 3 | loss: 0.6608056
	speed: 0.0046s/iter; left time: 25.6569s
	iters: 400, epoch: 3 | loss: 1.0473127
	speed: 0.0050s/iter; left time: 27.1321s
	iters: 500, epoch: 3 | loss: 0.3575315
	speed: 0.0048s/iter; left time: 25.8036s
	iters: 600, epoch: 3 | loss: 0.8291587
	speed: 0.0048s/iter; left time: 25.0821s
	iters: 700, epoch: 3 | loss: 0.8603330
	speed: 0.0048s/iter; left time: 24.6117s
	iters: 800, epoch: 3 | loss: 0.4934986
	speed: 0.0047s/iter; left time: 24.0168s
	iters: 900, epoch: 3 | loss: 0.4416466
	speed: 0.0049s/iter; left time: 24.2792s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.6157 --> 0.6086).  Saving model state dict ...
Epoch: 3 cost time: 4.68986177444458
Epoch: 3, Steps: 979 | Train Loss: 0.6332784 Vali Loss: 0.6085592 Best vali loss: 0.6085592
	iters: 100, epoch: 4 | loss: 1.8696094
	speed: 0.0150s/iter; left time: 72.1693s
	iters: 200, epoch: 4 | loss: 0.9935935
	speed: 0.0048s/iter; left time: 22.6430s
	iters: 300, epoch: 4 | loss: 0.6709436
	speed: 0.0047s/iter; left time: 21.4976s
	iters: 400, epoch: 4 | loss: 0.6199753
	speed: 0.0048s/iter; left time: 21.6977s
	iters: 500, epoch: 4 | loss: 0.6560701
	speed: 0.0047s/iter; left time: 20.5688s
	iters: 600, epoch: 4 | loss: 0.8981258
	speed: 0.0049s/iter; left time: 20.9325s
	iters: 700, epoch: 4 | loss: 0.7889972
	speed: 0.0049s/iter; left time: 20.5739s
	iters: 800, epoch: 4 | loss: 0.7806983
	speed: 0.0049s/iter; left time: 19.9378s
	iters: 900, epoch: 4 | loss: 0.9307540
	speed: 0.0047s/iter; left time: 18.9286s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.6086 --> 0.6044).  Saving model state dict ...
Epoch: 4 cost time: 4.765603303909302
Epoch: 4, Steps: 979 | Train Loss: 0.9120852 Vali Loss: 0.6043814 Best vali loss: 0.6043814
	iters: 100, epoch: 5 | loss: 0.4772818
	speed: 0.0151s/iter; left time: 57.5611s
	iters: 200, epoch: 5 | loss: 0.4625564
	speed: 0.0046s/iter; left time: 17.1226s
	iters: 300, epoch: 5 | loss: 0.5642360
	speed: 0.0045s/iter; left time: 16.0964s
	iters: 400, epoch: 5 | loss: 0.4798046
	speed: 0.0046s/iter; left time: 16.0865s
	iters: 500, epoch: 5 | loss: 0.6008216
	speed: 0.0048s/iter; left time: 16.4659s
	iters: 600, epoch: 5 | loss: 0.5886721
	speed: 0.0048s/iter; left time: 16.0242s
	iters: 700, epoch: 5 | loss: 0.8498126
	speed: 0.0047s/iter; left time: 15.2538s
	iters: 800, epoch: 5 | loss: 0.9087123
	speed: 0.0049s/iter; left time: 15.2029s
	iters: 900, epoch: 5 | loss: 0.4933065
	speed: 0.0050s/iter; left time: 15.1490s
Updating learning rate to 2.8686326433764354e-05
Validation loss decreased (0.6044 --> 0.6040).  Saving model state dict ...
Epoch: 5 cost time: 4.705228090286255
Epoch: 5, Steps: 979 | Train Loss: 0.6028004 Vali Loss: 0.6039568 Best vali loss: 0.6039568
	iters: 100, epoch: 6 | loss: 0.9117445
	speed: 0.0149s/iter; left time: 42.1900s
	iters: 200, epoch: 6 | loss: 0.4389592
	speed: 0.0049s/iter; left time: 13.3824s
	iters: 300, epoch: 6 | loss: 0.4449275
	speed: 0.0048s/iter; left time: 12.7193s
	iters: 400, epoch: 6 | loss: 1.1382850
	speed: 0.0048s/iter; left time: 12.2580s
	iters: 500, epoch: 6 | loss: 1.2197155
	speed: 0.0050s/iter; left time: 12.1807s
	iters: 600, epoch: 6 | loss: 0.7892318
	speed: 0.0051s/iter; left time: 11.9610s
	iters: 700, epoch: 6 | loss: 0.8065403
	speed: 0.0051s/iter; left time: 11.3561s
	iters: 800, epoch: 6 | loss: 0.5735573
	speed: 0.0050s/iter; left time: 10.6889s
	iters: 900, epoch: 6 | loss: 0.8487501
	speed: 0.0050s/iter; left time: 10.2202s
Updating learning rate to 1.3610570209234607e-05
Epoch: 6 cost time: 4.902277946472168
Epoch: 6, Steps: 979 | Train Loss: 0.7968568 Vali Loss: 0.6050673 Best vali loss: 0.6039568
	iters: 100, epoch: 7 | loss: 0.6756282
	speed: 0.0150s/iter; left time: 27.9196s
	iters: 200, epoch: 7 | loss: 1.2358066
	speed: 0.0050s/iter; left time: 8.8066s
	iters: 300, epoch: 7 | loss: 1.0147169
	speed: 0.0051s/iter; left time: 8.4793s
	iters: 400, epoch: 7 | loss: 0.8892633
	speed: 0.0051s/iter; left time: 7.9833s
	iters: 500, epoch: 7 | loss: 1.4456462
	speed: 0.0050s/iter; left time: 7.3676s
	iters: 600, epoch: 7 | loss: 1.4559481
	speed: 0.0050s/iter; left time: 6.8082s
	iters: 700, epoch: 7 | loss: 0.3827913
	speed: 0.0050s/iter; left time: 6.2655s
	iters: 800, epoch: 7 | loss: 1.3169478
	speed: 0.0049s/iter; left time: 5.6606s
	iters: 900, epoch: 7 | loss: 0.8709746
	speed: 0.0050s/iter; left time: 5.2937s
Updating learning rate to 3.5372719495249264e-06
Epoch: 7 cost time: 4.9609215259552
Epoch: 7, Steps: 979 | Train Loss: 1.0319692 Vali Loss: 0.6090056 Best vali loss: 0.6039568
	iters: 100, epoch: 8 | loss: 0.2659643
	speed: 0.0154s/iter; left time: 13.5340s
	iters: 200, epoch: 8 | loss: 1.1909781
	speed: 0.0050s/iter; left time: 3.9168s
	iters: 300, epoch: 8 | loss: 0.9351075
	speed: 0.0050s/iter; left time: 3.4324s
	iters: 400, epoch: 8 | loss: 1.4028506
	speed: 0.0051s/iter; left time: 2.9555s
	iters: 500, epoch: 8 | loss: 0.3525066
	speed: 0.0051s/iter; left time: 2.4281s
	iters: 600, epoch: 8 | loss: 0.8207684
	speed: 0.0050s/iter; left time: 1.9179s
	iters: 700, epoch: 8 | loss: 0.9673797
	speed: 0.0050s/iter; left time: 1.4069s
	iters: 800, epoch: 8 | loss: 1.3288565
	speed: 0.0050s/iter; left time: 0.9002s
	iters: 900, epoch: 8 | loss: 0.3631659
	speed: 0.0049s/iter; left time: 0.3950s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.967931032180786
Epoch: 8, Steps: 979 | Train Loss: 0.8475086 Vali Loss: 0.6078440 Best vali loss: 0.6039568

best validation loss 0.6039567547973137

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6459640
	speed: 0.0139s/iter; left time: 25.8274s
	iters: 200, epoch: 1 | loss: 0.8913867
	speed: 0.0077s/iter; left time: 13.6142s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.6005).  Saving model state dict ...
Epoch: 1 cost time: 2.2499186992645264
Epoch: 1, Steps: 245 | Train Loss: 0.7686754 Vali Loss: 0.6004714 Best vali loss: 0.6004714
	iters: 100, epoch: 2 | loss: 0.5716314
	speed: 0.0149s/iter; left time: 24.1082s
	iters: 200, epoch: 2 | loss: 0.5956779
	speed: 0.0076s/iter; left time: 11.5964s
Updating learning rate to 5.35870624e-05
Validation loss decreased (0.6005 --> 0.5481).  Saving model state dict ...
Epoch: 2 cost time: 1.9384222030639648
Epoch: 2, Steps: 245 | Train Loss: 0.5836546 Vali Loss: 0.5480708 Best vali loss: 0.5480708
	iters: 100, epoch: 3 | loss: 0.6129770
	speed: 0.0156s/iter; left time: 21.4113s
	iters: 200, epoch: 3 | loss: 0.9380121
	speed: 0.0077s/iter; left time: 9.7841s
Updating learning rate to 2.67935312e-05
Epoch: 3 cost time: 1.9368093013763428
Epoch: 3, Steps: 245 | Train Loss: 0.7754946 Vali Loss: 0.5489986 Best vali loss: 0.5480708
	iters: 100, epoch: 4 | loss: 0.6043586
	speed: 0.0145s/iter; left time: 16.3714s
	iters: 200, epoch: 4 | loss: 0.7186126
	speed: 0.0077s/iter; left time: 7.9067s
Updating learning rate to 1.33967656e-05
Validation loss decreased (0.5481 --> 0.5442).  Saving model state dict ...
Epoch: 4 cost time: 1.9362387657165527
Epoch: 4, Steps: 245 | Train Loss: 0.6614856 Vali Loss: 0.5442210 Best vali loss: 0.5442210
	iters: 100, epoch: 5 | loss: 0.5261971
	speed: 0.0153s/iter; left time: 13.4987s
	iters: 200, epoch: 5 | loss: 0.9130175
	speed: 0.0078s/iter; left time: 6.0583s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 1.9465923309326172
Epoch: 5, Steps: 245 | Train Loss: 0.7196073 Vali Loss: 0.5473159 Best vali loss: 0.5442210
	iters: 100, epoch: 6 | loss: 0.7811809
	speed: 0.0147s/iter; left time: 9.3297s
	iters: 200, epoch: 6 | loss: 0.8050258
	speed: 0.0077s/iter; left time: 4.1369s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 1.9320380687713623
Epoch: 6, Steps: 245 | Train Loss: 0.7931033 Vali Loss: 0.5476951 Best vali loss: 0.5442210
	iters: 100, epoch: 7 | loss: 0.7008203
	speed: 0.0145s/iter; left time: 5.6825s
	iters: 200, epoch: 7 | loss: 0.7685374
	speed: 0.0077s/iter; left time: 2.2479s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 1.94028639793396
Epoch: 7, Steps: 245 | Train Loss: 0.7346789 Vali Loss: 0.5458510 Best vali loss: 0.5442210
	iters: 100, epoch: 8 | loss: 0.9787893
	speed: 0.0146s/iter; left time: 2.1368s
	iters: 200, epoch: 8 | loss: 0.7546162
	speed: 0.0077s/iter; left time: 0.3557s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 1.9460201263427734
Epoch: 8, Steps: 245 | Train Loss: 0.8667028 Vali Loss: 0.5449279 Best vali loss: 0.5442210

best validation loss 0.5442209974696712

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1254139
	speed: 0.0096s/iter; left time: 36.5433s
	iters: 200, epoch: 1 | loss: 0.8589230
	speed: 0.0033s/iter; left time: 12.3542s
	iters: 300, epoch: 1 | loss: 0.4963244
	speed: 0.0034s/iter; left time: 12.1998s
	iters: 400, epoch: 1 | loss: 1.0904958
	speed: 0.0034s/iter; left time: 11.8236s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.6034).  Saving model state dict ...
Epoch: 1 cost time: 2.0183117389678955
Epoch: 1, Steps: 490 | Train Loss: 0.8927893 Vali Loss: 0.6034121 Best vali loss: 0.6034121
	iters: 100, epoch: 2 | loss: 0.9748202
	speed: 0.0105s/iter; left time: 34.8362s
	iters: 200, epoch: 2 | loss: 0.8648350
	speed: 0.0036s/iter; left time: 11.6977s
	iters: 300, epoch: 2 | loss: 0.4418303
	speed: 0.0034s/iter; left time: 10.6482s
	iters: 400, epoch: 2 | loss: 0.9689833
	speed: 0.0032s/iter; left time: 9.8304s
Updating learning rate to 0.00014998138555
Epoch: 2 cost time: 1.7515525817871094
Epoch: 2, Steps: 490 | Train Loss: 0.8126172 Vali Loss: 0.6170439 Best vali loss: 0.6034121
	iters: 100, epoch: 3 | loss: 0.6625212
	speed: 0.0097s/iter; left time: 27.6967s
	iters: 200, epoch: 3 | loss: 0.8388131
	speed: 0.0031s/iter; left time: 8.6156s
	iters: 300, epoch: 3 | loss: 0.7480331
	speed: 0.0031s/iter; left time: 8.1744s
	iters: 400, epoch: 3 | loss: 1.1255716
	speed: 0.0033s/iter; left time: 8.3967s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 1.6186327934265137
Epoch: 3, Steps: 490 | Train Loss: 0.8437348 Vali Loss: 0.6128077 Best vali loss: 0.6034121

best validation loss 0.6034121145974812

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7880313
	speed: 0.0100s/iter; left time: 18.6660s
	iters: 200, epoch: 1 | loss: 0.7014838
	speed: 0.0039s/iter; left time: 6.7994s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.6060).  Saving model state dict ...
Epoch: 1 cost time: 1.3043053150177002
Epoch: 1, Steps: 245 | Train Loss: 0.7447576 Vali Loss: 0.6060374 Best vali loss: 0.6060374
	iters: 100, epoch: 2 | loss: 0.7485138
	speed: 0.0081s/iter; left time: 13.1436s
	iters: 200, epoch: 2 | loss: 0.6592117
	speed: 0.0035s/iter; left time: 5.2579s
Updating learning rate to 0.0005873811600929365
Validation loss decreased (0.6060 --> 0.6006).  Saving model state dict ...
Epoch: 2 cost time: 0.9265260696411133
Epoch: 2, Steps: 245 | Train Loss: 0.7038628 Vali Loss: 0.6005598 Best vali loss: 0.6005598
	iters: 100, epoch: 3 | loss: 0.7216545
	speed: 0.0081s/iter; left time: 11.1506s
	iters: 200, epoch: 3 | loss: 0.9015654
	speed: 0.0038s/iter; left time: 4.8320s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 0.9814887046813965
Epoch: 3, Steps: 245 | Train Loss: 0.8116100 Vali Loss: 0.6087119 Best vali loss: 0.6005598

best validation loss 0.6005598216462831

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.6088).  Saving model state dict ...
Epoch: 1 cost time: 1.1339795589447021
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6088416 Best vali loss: 0.6088416
Updating learning rate to 0.0003362272142
Epoch: 2 cost time: 0.7889435291290283
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6291059 Best vali loss: 0.6088416
Updating learning rate to 0.0001681136071
Validation loss decreased (0.6088 --> 0.6066).  Saving model state dict ...
Epoch: 3 cost time: 0.7795186042785645
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6066254 Best vali loss: 0.6066254

best validation loss 0.6066254322476985

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7695438
	speed: 0.0100s/iter; left time: 11.2922s
	iters: 200, epoch: 4 | loss: 0.6880395
	speed: 0.0038s/iter; left time: 3.9291s
Updating learning rate to 0.0003440799173
Validation loss decreased (0.6006 --> 0.5908).  Saving model state dict ...
Epoch: 4 cost time: 1.288062334060669
Epoch: 4, Steps: 245 | Train Loss: 0.7287917 Vali Loss: 0.5907990 Best vali loss: 0.5907990
	iters: 100, epoch: 5 | loss: 0.7408212
	speed: 0.0085s/iter; left time: 7.5061s
	iters: 200, epoch: 5 | loss: 0.6742083
	speed: 0.0037s/iter; left time: 2.8939s
Updating learning rate to 0.0002124062335397398
Epoch: 5 cost time: 0.9949929714202881
Epoch: 5, Steps: 245 | Train Loss: 0.7075147 Vali Loss: 0.6074621 Best vali loss: 0.5907990
	iters: 100, epoch: 6 | loss: 0.7212605
	speed: 0.0084s/iter; left time: 5.3674s
	iters: 200, epoch: 6 | loss: 0.8876140
	speed: 0.0038s/iter; left time: 2.0297s
Updating learning rate to 0.00010077867450706355
Epoch: 6 cost time: 1.0019338130950928
Epoch: 6, Steps: 245 | Train Loss: 0.8044372 Vali Loss: 0.6091219 Best vali loss: 0.5907990
	iters: 100, epoch: 7 | loss: 0.9931071
	speed: 0.0082s/iter; left time: 3.2191s
	iters: 200, epoch: 7 | loss: 0.7905390
	speed: 0.0036s/iter; left time: 1.0573s
Updating learning rate to 2.61915241583538e-05
Epoch: 7 cost time: 0.9548213481903076
Epoch: 7, Steps: 245 | Train Loss: 0.8918230 Vali Loss: 0.6030635 Best vali loss: 0.5907990
	iters: 100, epoch: 8 | loss: 1.1953683
	speed: 0.0079s/iter; left time: 1.1569s
	iters: 200, epoch: 8 | loss: 0.7179245
	speed: 0.0036s/iter; left time: 0.1648s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9473006725311279
Epoch: 8, Steps: 245 | Train Loss: 0.9566464 Vali Loss: 0.6055605 Best vali loss: 0.5907990

best validation loss 0.5907989570742567

[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4238090
	speed: 0.0105s/iter; left time: 81.4045s
	iters: 200, epoch: 1 | loss: 0.8232827
	speed: 0.0044s/iter; left time: 33.4668s
	iters: 300, epoch: 1 | loss: 0.3376901
	speed: 0.0042s/iter; left time: 31.4395s
	iters: 400, epoch: 1 | loss: 0.7491043
	speed: 0.0045s/iter; left time: 33.3953s
	iters: 500, epoch: 1 | loss: 1.7856492
	speed: 0.0041s/iter; left time: 30.2813s
	iters: 600, epoch: 1 | loss: 0.7842693
	speed: 0.0044s/iter; left time: 31.7244s
	iters: 700, epoch: 1 | loss: 1.2623675
	speed: 0.0045s/iter; left time: 32.1647s
	iters: 800, epoch: 1 | loss: 0.8504682
	speed: 0.0045s/iter; left time: 31.7244s
	iters: 900, epoch: 1 | loss: 0.4717492
	speed: 0.0045s/iter; left time: 31.3507s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 4.669879674911499
Epoch: 1, Steps: 979 | Train Loss: 0.8320433 Vali Loss: 0.6075144 Best vali loss: 0.6075144
	iters: 100, epoch: 2 | loss: 0.9365053
	speed: 0.0132s/iter; left time: 89.4477s
	iters: 200, epoch: 2 | loss: 0.4475595
	speed: 0.0037s/iter; left time: 24.7596s
	iters: 300, epoch: 2 | loss: 0.7971194
	speed: 0.0039s/iter; left time: 25.5513s
	iters: 400, epoch: 2 | loss: 0.6128285
	speed: 0.0038s/iter; left time: 24.2420s
	iters: 500, epoch: 2 | loss: 0.6098112
	speed: 0.0037s/iter; left time: 23.4068s
	iters: 600, epoch: 2 | loss: 0.5711924
	speed: 0.0037s/iter; left time: 23.2708s
	iters: 700, epoch: 2 | loss: 0.4333030
	speed: 0.0039s/iter; left time: 23.8165s
	iters: 800, epoch: 2 | loss: 1.2040470
	speed: 0.0038s/iter; left time: 23.2625s
	iters: 900, epoch: 2 | loss: 1.6071460
	speed: 0.0039s/iter; left time: 22.9780s
Updating learning rate to 5.854811365e-05
Epoch: 2 cost time: 3.8039612770080566
Epoch: 2, Steps: 979 | Train Loss: 0.8021680 Vali Loss: 0.6151067 Best vali loss: 0.6075144
	iters: 100, epoch: 3 | loss: 0.7907164
	speed: 0.0138s/iter; left time: 79.5926s
	iters: 200, epoch: 3 | loss: 1.5016187
	speed: 0.0045s/iter; left time: 25.4352s
	iters: 300, epoch: 3 | loss: 1.0413941
	speed: 0.0044s/iter; left time: 24.3914s
	iters: 400, epoch: 3 | loss: 0.6470269
	speed: 0.0045s/iter; left time: 24.4747s
	iters: 500, epoch: 3 | loss: 1.1864246
	speed: 0.0043s/iter; left time: 23.3260s
	iters: 600, epoch: 3 | loss: 1.1243122
	speed: 0.0043s/iter; left time: 22.6576s
	iters: 700, epoch: 3 | loss: 0.3796629
	speed: 0.0045s/iter; left time: 23.4940s
	iters: 800, epoch: 3 | loss: 0.5750815
	speed: 0.0044s/iter; left time: 22.5285s
	iters: 900, epoch: 3 | loss: 0.5295492
	speed: 0.0044s/iter; left time: 21.7936s
Updating learning rate to 2.9274056825e-05
Epoch: 3 cost time: 4.395702838897705
Epoch: 3, Steps: 979 | Train Loss: 0.8639763 Vali Loss: 0.6080339 Best vali loss: 0.6075144
	iters: 100, epoch: 4 | loss: 1.5943861
	speed: 0.0139s/iter; left time: 66.8737s
	iters: 200, epoch: 4 | loss: 0.3320773
	speed: 0.0045s/iter; left time: 20.9075s
	iters: 300, epoch: 4 | loss: 0.6748531
	speed: 0.0045s/iter; left time: 20.5889s
	iters: 400, epoch: 4 | loss: 0.3025432
	speed: 0.0044s/iter; left time: 20.0011s
	iters: 500, epoch: 4 | loss: 0.2858830
	speed: 0.0044s/iter; left time: 19.2863s
	iters: 600, epoch: 4 | loss: 0.7350642
	speed: 0.0043s/iter; left time: 18.6432s
	iters: 700, epoch: 4 | loss: 1.2105044
	speed: 0.0043s/iter; left time: 18.1406s
	iters: 800, epoch: 4 | loss: 0.3577662
	speed: 0.0045s/iter; left time: 18.5554s
	iters: 900, epoch: 4 | loss: 1.1871674
	speed: 0.0045s/iter; left time: 17.8419s
Updating learning rate to 1.46370284125e-05
Validation loss decreased (0.6075 --> 0.6053).  Saving model state dict ...
Epoch: 4 cost time: 4.360189914703369
Epoch: 4, Steps: 979 | Train Loss: 0.7422494 Vali Loss: 0.6052566 Best vali loss: 0.6052566
	iters: 100, epoch: 5 | loss: 0.9921427
	speed: 0.0134s/iter; left time: 51.2083s
	iters: 200, epoch: 5 | loss: 0.9721151
	speed: 0.0039s/iter; left time: 14.5825s
	iters: 300, epoch: 5 | loss: 0.2891204
	speed: 0.0039s/iter; left time: 14.0689s
	iters: 400, epoch: 5 | loss: 1.1626482
	speed: 0.0039s/iter; left time: 13.7933s
	iters: 500, epoch: 5 | loss: 0.9165031
	speed: 0.0039s/iter; left time: 13.3430s
	iters: 600, epoch: 5 | loss: 0.5549742
	speed: 0.0040s/iter; left time: 13.4280s
	iters: 700, epoch: 5 | loss: 0.6136599
	speed: 0.0044s/iter; left time: 14.0615s
	iters: 800, epoch: 5 | loss: 1.1554269
	speed: 0.0043s/iter; left time: 13.4291s
	iters: 900, epoch: 5 | loss: 0.9849085
	speed: 0.0043s/iter; left time: 13.0159s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 4.0703465938568115
Epoch: 5, Steps: 979 | Train Loss: 0.8490554 Vali Loss: 0.6071967 Best vali loss: 0.6052566
	iters: 100, epoch: 6 | loss: 0.6350474
	speed: 0.0139s/iter; left time: 39.5217s
	iters: 200, epoch: 6 | loss: 0.4369642
	speed: 0.0044s/iter; left time: 12.0335s
	iters: 300, epoch: 6 | loss: 1.3086793
	speed: 0.0045s/iter; left time: 11.8831s
	iters: 400, epoch: 6 | loss: 0.4395476
	speed: 0.0045s/iter; left time: 11.4069s
	iters: 500, epoch: 6 | loss: 0.5140092
	speed: 0.0043s/iter; left time: 10.5823s
	iters: 600, epoch: 6 | loss: 1.4834961
	speed: 0.0045s/iter; left time: 10.4385s
	iters: 700, epoch: 6 | loss: 0.5481111
	speed: 0.0045s/iter; left time: 10.0740s
	iters: 800, epoch: 6 | loss: 0.3094759
	speed: 0.0045s/iter; left time: 9.6696s
	iters: 900, epoch: 6 | loss: 0.8215832
	speed: 0.0044s/iter; left time: 9.0342s
Updating learning rate to 3.659257103125e-06
Epoch: 6 cost time: 4.4085612297058105
Epoch: 6, Steps: 979 | Train Loss: 0.7218793 Vali Loss: 0.6068596 Best vali loss: 0.6052566
	iters: 100, epoch: 7 | loss: 0.9197339
	speed: 0.0140s/iter; left time: 26.1125s
	iters: 200, epoch: 7 | loss: 0.4115172
	speed: 0.0044s/iter; left time: 7.7493s
	iters: 300, epoch: 7 | loss: 1.3313832
	speed: 0.0044s/iter; left time: 7.3278s
	iters: 400, epoch: 7 | loss: 0.8774306
	speed: 0.0044s/iter; left time: 6.8283s
	iters: 500, epoch: 7 | loss: 1.4649838
	speed: 0.0042s/iter; left time: 6.1968s
	iters: 600, epoch: 7 | loss: 1.3643643
	speed: 0.0043s/iter; left time: 5.8510s
	iters: 700, epoch: 7 | loss: 1.0761514
	speed: 0.0042s/iter; left time: 5.2971s
	iters: 800, epoch: 7 | loss: 0.7634639
	speed: 0.0045s/iter; left time: 5.1622s
	iters: 900, epoch: 7 | loss: 1.1822876
	speed: 0.0045s/iter; left time: 4.7191s
Updating learning rate to 1.8296285515625e-06
Epoch: 7 cost time: 4.353989839553833
Epoch: 7, Steps: 979 | Train Loss: 1.0434795 Vali Loss: 0.6067333 Best vali loss: 0.6052566
	iters: 100, epoch: 8 | loss: 0.8344245
	speed: 0.0144s/iter; left time: 12.6632s
	iters: 200, epoch: 8 | loss: 0.2480248
	speed: 0.0043s/iter; left time: 3.3331s
	iters: 300, epoch: 8 | loss: 0.3844759
	speed: 0.0043s/iter; left time: 2.9442s
	iters: 400, epoch: 8 | loss: 0.2921945
	speed: 0.0044s/iter; left time: 2.5464s
	iters: 500, epoch: 8 | loss: 0.2797925
	speed: 0.0045s/iter; left time: 2.1485s
	iters: 600, epoch: 8 | loss: 1.3470855
	speed: 0.0044s/iter; left time: 1.6757s
	iters: 700, epoch: 8 | loss: 0.4674886
	speed: 0.0044s/iter; left time: 1.2218s
	iters: 800, epoch: 8 | loss: 0.9369174
	speed: 0.0043s/iter; left time: 0.7773s
	iters: 900, epoch: 8 | loss: 1.1115903
	speed: 0.0044s/iter; left time: 0.3487s
Updating learning rate to 9.1481427578125e-07
Epoch: 8 cost time: 4.3616862297058105
Epoch: 8, Steps: 979 | Train Loss: 0.6557771 Vali Loss: 0.6067526 Best vali loss: 0.6052566

best validation loss 0.6052566274952303

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0380404
	speed: 0.0134s/iter; left time: 25.0096s
	iters: 200, epoch: 1 | loss: 0.7656878
	speed: 0.0072s/iter; left time: 12.6630s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 2.135788917541504
Epoch: 1, Steps: 245 | Train Loss: 0.9018641 Vali Loss: 0.6023327 Best vali loss: 0.6023327
	iters: 100, epoch: 2 | loss: 0.7388382
	speed: 0.0143s/iter; left time: 23.1373s
	iters: 200, epoch: 2 | loss: 0.9678885
	speed: 0.0072s/iter; left time: 10.9723s
Updating learning rate to 4.073901425e-05
Validation loss decreased (0.6023 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 1.8350274562835693
Epoch: 2, Steps: 245 | Train Loss: 0.8533633 Vali Loss: 0.5611202 Best vali loss: 0.5611202
	iters: 100, epoch: 3 | loss: 0.7624771
	speed: 0.0144s/iter; left time: 19.7712s
	iters: 200, epoch: 3 | loss: 0.7481120
	speed: 0.0072s/iter; left time: 9.2144s
Updating learning rate to 2.0369507125e-05
Validation loss decreased (0.5611 --> 0.5414).  Saving model state dict ...
Epoch: 3 cost time: 1.8135263919830322
Epoch: 3, Steps: 245 | Train Loss: 0.7552946 Vali Loss: 0.5413730 Best vali loss: 0.5413730
	iters: 100, epoch: 4 | loss: 0.4458867
	speed: 0.0146s/iter; left time: 16.4082s
	iters: 200, epoch: 4 | loss: 0.6507152
	speed: 0.0073s/iter; left time: 7.5199s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 1.8414793014526367
Epoch: 4, Steps: 245 | Train Loss: 0.5483010 Vali Loss: 0.5429289 Best vali loss: 0.5413730
	iters: 100, epoch: 5 | loss: 0.8604481
	speed: 0.0138s/iter; left time: 12.1284s
	iters: 200, epoch: 5 | loss: 0.5540229
	speed: 0.0072s/iter; left time: 5.6553s
Updating learning rate to 5.09237678125e-06
Validation loss decreased (0.5414 --> 0.5374).  Saving model state dict ...
Epoch: 5 cost time: 1.8154163360595703
Epoch: 5, Steps: 245 | Train Loss: 0.7072355 Vali Loss: 0.5374155 Best vali loss: 0.5374155
	iters: 100, epoch: 6 | loss: 0.5483689
	speed: 0.0146s/iter; left time: 9.2890s
	iters: 200, epoch: 6 | loss: 0.6455269
	speed: 0.0073s/iter; left time: 3.8916s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 1.833678960800171
Epoch: 6, Steps: 245 | Train Loss: 0.5969479 Vali Loss: 0.5378662 Best vali loss: 0.5374155
	iters: 100, epoch: 7 | loss: 0.8950592
	speed: 0.0140s/iter; left time: 5.4679s
	iters: 200, epoch: 7 | loss: 0.7231864
	speed: 0.0073s/iter; left time: 2.1148s
Updating learning rate to 1.2730941953125e-06
Validation loss decreased (0.5374 --> 0.5365).  Saving model state dict ...
Epoch: 7 cost time: 1.8267033100128174
Epoch: 7, Steps: 245 | Train Loss: 0.8091228 Vali Loss: 0.5364782 Best vali loss: 0.5364782
	iters: 100, epoch: 8 | loss: 0.5493280
	speed: 0.0144s/iter; left time: 2.0994s
	iters: 200, epoch: 8 | loss: 0.5497683
	speed: 0.0073s/iter; left time: 0.3343s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 1.819828748703003
Epoch: 8, Steps: 245 | Train Loss: 0.5495481 Vali Loss: 0.5366230 Best vali loss: 0.5364782

best validation loss 0.536478236338321

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9758059
	speed: 0.0113s/iter; left time: 87.6964s
	iters: 200, epoch: 1 | loss: 0.9431406
	speed: 0.0052s/iter; left time: 39.8308s
	iters: 300, epoch: 1 | loss: 0.6976689
	speed: 0.0052s/iter; left time: 39.1089s
	iters: 400, epoch: 1 | loss: 1.4450992
	speed: 0.0052s/iter; left time: 38.8805s
	iters: 500, epoch: 1 | loss: 0.8785642
	speed: 0.0052s/iter; left time: 37.9132s
	iters: 600, epoch: 1 | loss: 1.4419153
	speed: 0.0051s/iter; left time: 36.7135s
	iters: 700, epoch: 1 | loss: 0.7316644
	speed: 0.0047s/iter; left time: 33.5726s
	iters: 800, epoch: 1 | loss: 1.2680320
	speed: 0.0046s/iter; left time: 32.2298s
	iters: 900, epoch: 1 | loss: 0.3207407
	speed: 0.0046s/iter; left time: 32.0941s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 5.219396352767944
Epoch: 1, Steps: 979 | Train Loss: 0.9669590 Vali Loss: 0.6093562 Best vali loss: 0.6093562
	iters: 100, epoch: 2 | loss: 0.7542716
	speed: 0.0146s/iter; left time: 98.8895s
	iters: 200, epoch: 2 | loss: 0.2908051
	speed: 0.0046s/iter; left time: 30.5316s
	iters: 300, epoch: 2 | loss: 0.8474507
	speed: 0.0045s/iter; left time: 29.7445s
	iters: 400, epoch: 2 | loss: 0.9111412
	speed: 0.0046s/iter; left time: 29.4986s
	iters: 500, epoch: 2 | loss: 0.7146733
	speed: 0.0046s/iter; left time: 28.9623s
	iters: 600, epoch: 2 | loss: 0.7030737
	speed: 0.0047s/iter; left time: 29.3725s
	iters: 700, epoch: 2 | loss: 0.2975605
	speed: 0.0050s/iter; left time: 30.8716s
	iters: 800, epoch: 2 | loss: 0.6844412
	speed: 0.0049s/iter; left time: 29.5435s
	iters: 900, epoch: 2 | loss: 1.6116143
	speed: 0.0046s/iter; left time: 27.3152s
Updating learning rate to 0.0028552868313678737
Epoch: 2 cost time: 4.622205495834351
Epoch: 2, Steps: 979 | Train Loss: 0.7572257 Vali Loss: 0.6128048 Best vali loss: 0.6093562
	iters: 100, epoch: 3 | loss: 0.4145770
	speed: 0.0145s/iter; left time: 83.4572s
	iters: 200, epoch: 3 | loss: 0.5493796
	speed: 0.0045s/iter; left time: 25.3826s
	iters: 300, epoch: 3 | loss: 0.6430373
	speed: 0.0043s/iter; left time: 23.9451s
	iters: 400, epoch: 3 | loss: 1.0502162
	speed: 0.0046s/iter; left time: 25.2887s
	iters: 500, epoch: 3 | loss: 0.3514380
	speed: 0.0047s/iter; left time: 25.1467s
	iters: 600, epoch: 3 | loss: 0.8337346
	speed: 0.0048s/iter; left time: 25.2488s
	iters: 700, epoch: 3 | loss: 0.8792161
	speed: 0.0045s/iter; left time: 23.4101s
	iters: 800, epoch: 3 | loss: 0.4839236
	speed: 0.0047s/iter; left time: 23.6408s
	iters: 900, epoch: 3 | loss: 0.3893657
	speed: 0.0046s/iter; left time: 22.8042s
Updating learning rate to 0.0023126601334443136
Epoch: 3 cost time: 4.527343034744263
Epoch: 3, Steps: 979 | Train Loss: 0.6216542 Vali Loss: 0.6180915 Best vali loss: 0.6093562

best validation loss 0.6093561572920443

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7840931
	speed: 0.0090s/iter; left time: 16.6709s
	iters: 200, epoch: 1 | loss: 0.6132924
	speed: 0.0030s/iter; left time: 5.3097s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 1.081263542175293
Epoch: 1, Steps: 245 | Train Loss: 0.6986927 Vali Loss: 0.6045928 Best vali loss: 0.6045928
	iters: 100, epoch: 2 | loss: 0.5936723
	speed: 0.0067s/iter; left time: 10.8949s
	iters: 200, epoch: 2 | loss: 1.0533895
	speed: 0.0031s/iter; left time: 4.6737s
Updating learning rate to 0.0014281993853242025
Validation loss decreased (0.6046 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 0.7962079048156738
Epoch: 2, Steps: 245 | Train Loss: 0.8235309 Vali Loss: 0.6036258 Best vali loss: 0.6036258
	iters: 100, epoch: 3 | loss: 0.6098482
	speed: 0.0065s/iter; left time: 8.9431s
	iters: 200, epoch: 3 | loss: 1.1434793
	speed: 0.0029s/iter; left time: 3.7387s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 0.7643270492553711
Epoch: 3, Steps: 245 | Train Loss: 0.8766638 Vali Loss: 0.6039103 Best vali loss: 0.6036258

best validation loss 0.6036257508285395

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7993760
	speed: 0.0084s/iter; left time: 65.2372s
	iters: 200, epoch: 1 | loss: 1.7963995
	speed: 0.0026s/iter; left time: 19.4859s
	iters: 300, epoch: 1 | loss: 1.0501722
	speed: 0.0023s/iter; left time: 17.6177s
	iters: 400, epoch: 1 | loss: 0.8839092
	speed: 0.0023s/iter; left time: 17.2386s
	iters: 500, epoch: 1 | loss: 2.5003421
	speed: 0.0024s/iter; left time: 17.8144s
	iters: 600, epoch: 1 | loss: 0.3335260
	speed: 0.0024s/iter; left time: 17.6848s
	iters: 700, epoch: 1 | loss: 0.5194107
	speed: 0.0024s/iter; left time: 16.9512s
	iters: 800, epoch: 1 | loss: 0.6949794
	speed: 0.0024s/iter; left time: 16.6572s
	iters: 900, epoch: 1 | loss: 0.7088260
	speed: 0.0025s/iter; left time: 17.2960s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 2.7238755226135254
Epoch: 1, Steps: 979 | Train Loss: 1.0318823 Vali Loss: 0.6018607 Best vali loss: 0.6018607
	iters: 100, epoch: 2 | loss: 1.2866235
	speed: 0.0092s/iter; left time: 62.3974s
	iters: 200, epoch: 2 | loss: 0.3615738
	speed: 0.0024s/iter; left time: 16.0938s
	iters: 300, epoch: 2 | loss: 0.8818869
	speed: 0.0023s/iter; left time: 15.1416s
	iters: 400, epoch: 2 | loss: 1.0035955
	speed: 0.0023s/iter; left time: 14.8791s
	iters: 500, epoch: 2 | loss: 0.4679526
	speed: 0.0024s/iter; left time: 15.3809s
	iters: 600, epoch: 2 | loss: 0.5670235
	speed: 0.0024s/iter; left time: 15.1429s
	iters: 700, epoch: 2 | loss: 0.3918726
	speed: 0.0024s/iter; left time: 14.9580s
	iters: 800, epoch: 2 | loss: 1.0601960
	speed: 0.0024s/iter; left time: 14.4774s
	iters: 900, epoch: 2 | loss: 0.8424385
	speed: 0.0024s/iter; left time: 14.4000s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 2.3994369506835938
Epoch: 2, Steps: 979 | Train Loss: 0.7625736 Vali Loss: 0.6179834 Best vali loss: 0.6018607
	iters: 100, epoch: 3 | loss: 0.9929616
	speed: 0.0091s/iter; left time: 52.3525s
	iters: 200, epoch: 3 | loss: 0.5913290
	speed: 0.0024s/iter; left time: 13.5567s
	iters: 300, epoch: 3 | loss: 1.1289873
	speed: 0.0023s/iter; left time: 13.0014s
	iters: 400, epoch: 3 | loss: 0.6627959
	speed: 0.0025s/iter; left time: 13.6313s
	iters: 500, epoch: 3 | loss: 0.2764741
	speed: 0.0025s/iter; left time: 13.3285s
	iters: 600, epoch: 3 | loss: 0.4058414
	speed: 0.0024s/iter; left time: 12.5004s
	iters: 700, epoch: 3 | loss: 0.1981618
	speed: 0.0023s/iter; left time: 11.9671s
	iters: 800, epoch: 3 | loss: 1.2230295
	speed: 0.0023s/iter; left time: 11.7184s
	iters: 900, epoch: 3 | loss: 0.3904726
	speed: 0.0024s/iter; left time: 11.9606s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 2.382540225982666
Epoch: 3, Steps: 979 | Train Loss: 0.6522281 Vali Loss: 0.6349610 Best vali loss: 0.6018607

best validation loss 0.6018607486306601

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7603615
	speed: 0.0086s/iter; left time: 41.1406s
	iters: 200, epoch: 4 | loss: 0.9540316
	speed: 0.0025s/iter; left time: 11.7371s
	iters: 300, epoch: 4 | loss: 0.8758383
	speed: 0.0025s/iter; left time: 11.4208s
	iters: 400, epoch: 4 | loss: 0.9183007
	speed: 0.0025s/iter; left time: 11.2295s
	iters: 500, epoch: 4 | loss: 1.3433588
	speed: 0.0025s/iter; left time: 10.9568s
	iters: 600, epoch: 4 | loss: 0.3059245
	speed: 0.0025s/iter; left time: 10.7231s
	iters: 700, epoch: 4 | loss: 0.4884639
	speed: 0.0025s/iter; left time: 10.4070s
	iters: 800, epoch: 4 | loss: 0.5991417
	speed: 0.0025s/iter; left time: 10.1450s
	iters: 900, epoch: 4 | loss: 0.6603178
	speed: 0.0025s/iter; left time: 9.8386s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 2.7725863456726074
Epoch: 4, Steps: 979 | Train Loss: 0.7673043 Vali Loss: 0.6389165 Best vali loss: 0.6018607
	iters: 100, epoch: 5 | loss: 0.9319026
	speed: 0.0089s/iter; left time: 33.8966s
	iters: 200, epoch: 5 | loss: 0.3149918
	speed: 0.0024s/iter; left time: 9.0347s
	iters: 300, epoch: 5 | loss: 0.8227271
	speed: 0.0025s/iter; left time: 8.8644s
	iters: 400, epoch: 5 | loss: 0.9905884
	speed: 0.0024s/iter; left time: 8.3270s
	iters: 500, epoch: 5 | loss: 0.4159639
	speed: 0.0024s/iter; left time: 8.1778s
	iters: 600, epoch: 5 | loss: 0.4011666
	speed: 0.0025s/iter; left time: 8.2417s
	iters: 700, epoch: 5 | loss: 0.3494625
	speed: 0.0024s/iter; left time: 7.6974s
	iters: 800, epoch: 5 | loss: 0.6995342
	speed: 0.0023s/iter; left time: 7.3085s
	iters: 900, epoch: 5 | loss: 0.6008883
	speed: 0.0024s/iter; left time: 7.1967s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 2.3961939811706543
Epoch: 5, Steps: 979 | Train Loss: 0.6141361 Vali Loss: 0.6465986 Best vali loss: 0.6018607
	iters: 100, epoch: 6 | loss: 0.9496946
	speed: 0.0091s/iter; left time: 25.7094s
	iters: 200, epoch: 6 | loss: 0.5646994
	speed: 0.0026s/iter; left time: 7.1216s
	iters: 300, epoch: 6 | loss: 1.1043934
	speed: 0.0026s/iter; left time: 6.8589s
	iters: 400, epoch: 6 | loss: 0.5988724
	speed: 0.0026s/iter; left time: 6.6138s
	iters: 500, epoch: 6 | loss: 0.2540196
	speed: 0.0026s/iter; left time: 6.3406s
	iters: 600, epoch: 6 | loss: 0.3751329
	speed: 0.0025s/iter; left time: 5.8345s
	iters: 700, epoch: 6 | loss: 0.1948500
	speed: 0.0025s/iter; left time: 5.4958s
	iters: 800, epoch: 6 | loss: 1.1022915
	speed: 0.0025s/iter; left time: 5.3886s
	iters: 900, epoch: 6 | loss: 0.3266618
	speed: 0.0024s/iter; left time: 4.9376s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 2.5317912101745605
Epoch: 6, Steps: 979 | Train Loss: 0.6078462 Vali Loss: 0.6543064 Best vali loss: 0.6018607
	iters: 100, epoch: 7 | loss: 0.4834647
	speed: 0.0088s/iter; left time: 16.2791s
	iters: 200, epoch: 7 | loss: 1.0560725
	speed: 0.0026s/iter; left time: 4.5188s
	iters: 300, epoch: 7 | loss: 0.2600938
	speed: 0.0025s/iter; left time: 4.2225s
	iters: 400, epoch: 7 | loss: 0.2830046
	speed: 0.0026s/iter; left time: 3.9991s
	iters: 500, epoch: 7 | loss: 0.5936509
	speed: 0.0025s/iter; left time: 3.6745s
	iters: 600, epoch: 7 | loss: 0.4028451
	speed: 0.0025s/iter; left time: 3.3830s
	iters: 700, epoch: 7 | loss: 0.5098736
	speed: 0.0025s/iter; left time: 3.1218s
	iters: 800, epoch: 7 | loss: 0.9708300
	speed: 0.0025s/iter; left time: 2.8811s
	iters: 900, epoch: 7 | loss: 1.1117076
	speed: 0.0024s/iter; left time: 2.5849s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 2.492931604385376
Epoch: 7, Steps: 979 | Train Loss: 0.6301714 Vali Loss: 0.6550924 Best vali loss: 0.6018607
	iters: 100, epoch: 8 | loss: 0.7633056
	speed: 0.0088s/iter; left time: 7.7177s
	iters: 200, epoch: 8 | loss: 0.3090342
	speed: 0.0026s/iter; left time: 2.0127s
	iters: 300, epoch: 8 | loss: 0.6272674
	speed: 0.0026s/iter; left time: 1.7409s
	iters: 400, epoch: 8 | loss: 0.3750373
	speed: 0.0026s/iter; left time: 1.4850s
	iters: 500, epoch: 8 | loss: 1.4155151
	speed: 0.0026s/iter; left time: 1.2313s
	iters: 600, epoch: 8 | loss: 1.4167874
	speed: 0.0026s/iter; left time: 0.9729s
	iters: 700, epoch: 8 | loss: 1.2633859
	speed: 0.0026s/iter; left time: 0.7169s
	iters: 800, epoch: 8 | loss: 1.3756770
	speed: 0.0026s/iter; left time: 0.4610s
	iters: 900, epoch: 8 | loss: 1.2388024
	speed: 0.0025s/iter; left time: 0.2034s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 2.553462028503418
Epoch: 8, Steps: 979 | Train Loss: 0.9760903 Vali Loss: 0.6530525 Best vali loss: 0.6018607

best validation loss 0.6018607486306601

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8686433
	speed: 0.0112s/iter; left time: 9.9478s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.6696).  Saving model state dict ...
Epoch: 1 cost time: 0.9808721542358398
Epoch: 1, Steps: 123 | Train Loss: 0.8686433 Vali Loss: 0.6696063 Best vali loss: 0.6696063
	iters: 100, epoch: 2 | loss: 0.9477624
	speed: 0.0087s/iter; left time: 6.6326s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.6696 --> 0.6536).  Saving model state dict ...
Epoch: 2 cost time: 0.6830246448516846
Epoch: 2, Steps: 123 | Train Loss: 0.9477624 Vali Loss: 0.6535709 Best vali loss: 0.6535709
	iters: 100, epoch: 3 | loss: 0.9926209
	speed: 0.0089s/iter; left time: 5.6800s
Updating learning rate to 0.002165706536403478
Validation loss decreased (0.6536 --> 0.6383).  Saving model state dict ...
Epoch: 3 cost time: 0.6993870735168457
Epoch: 3, Steps: 123 | Train Loss: 0.9926209 Vali Loss: 0.6383439 Best vali loss: 0.6383439
	iters: 100, epoch: 4 | loss: 0.8374660
	speed: 0.0090s/iter; left time: 4.6257s
Updating learning rate to 0.00156630685355
Validation loss decreased (0.6383 --> 0.6293).  Saving model state dict ...
Epoch: 4 cost time: 0.6915409564971924
Epoch: 4, Steps: 123 | Train Loss: 0.8374660 Vali Loss: 0.6292773 Best vali loss: 0.6292773
	iters: 100, epoch: 5 | loss: 0.8535478
	speed: 0.0089s/iter; left time: 3.4844s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 0.6872062683105469
Epoch: 5, Steps: 123 | Train Loss: 0.8535478 Vali Loss: 0.6480951 Best vali loss: 0.6292773
	iters: 100, epoch: 6 | loss: 1.0680537
	speed: 0.0087s/iter; left time: 2.3476s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 0.6943409442901611
Epoch: 6, Steps: 123 | Train Loss: 1.0680537 Vali Loss: 0.6426367 Best vali loss: 0.6292773
	iters: 100, epoch: 7 | loss: 1.0066153
	speed: 0.0087s/iter; left time: 1.2845s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 0.6945176124572754
Epoch: 7, Steps: 123 | Train Loss: 1.0066153 Vali Loss: 0.6437660 Best vali loss: 0.6292773
	iters: 100, epoch: 8 | loss: 0.9091750
	speed: 0.0086s/iter; left time: 0.2059s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6869721412658691
Epoch: 8, Steps: 123 | Train Loss: 0.9091750 Vali Loss: 0.6315343 Best vali loss: 0.6292773

best validation loss 0.6292772659655248

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0288702
	speed: 0.0099s/iter; left time: 8.7239s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.6339).  Saving model state dict ...
Epoch: 1 cost time: 0.8124339580535889
Epoch: 1, Steps: 123 | Train Loss: 1.0288702 Vali Loss: 0.6338710 Best vali loss: 0.6338710
	iters: 100, epoch: 2 | loss: 0.9993788
	speed: 0.0067s/iter; left time: 5.1418s
Updating learning rate to 0.002295210804720494
Epoch: 2 cost time: 0.49756312370300293
Epoch: 2, Steps: 123 | Train Loss: 0.9993788 Vali Loss: 0.6396821 Best vali loss: 0.6338710
	iters: 100, epoch: 3 | loss: 0.6465854
	speed: 0.0064s/iter; left time: 4.1072s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 0.47754955291748047
Epoch: 3, Steps: 123 | Train Loss: 0.6465854 Vali Loss: 0.6399315 Best vali loss: 0.6338710
	iters: 100, epoch: 4 | loss: 0.8240925
	speed: 0.0065s/iter; left time: 3.3425s
Updating learning rate to 0.0013445033609
Validation loss decreased (0.6339 --> 0.5942).  Saving model state dict ...
Epoch: 4 cost time: 0.49903035163879395
Epoch: 4, Steps: 123 | Train Loss: 0.8240925 Vali Loss: 0.5941670 Best vali loss: 0.5941670
	iters: 100, epoch: 5 | loss: 0.6575221
	speed: 0.0069s/iter; left time: 2.6958s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 0.5093450546264648
Epoch: 5, Steps: 123 | Train Loss: 0.6575221 Vali Loss: 0.6332774 Best vali loss: 0.5941670
	iters: 100, epoch: 6 | loss: 0.4387689
	speed: 0.0067s/iter; left time: 1.7997s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 0.4978303909301758
Epoch: 6, Steps: 123 | Train Loss: 0.4387689 Vali Loss: 0.5994011 Best vali loss: 0.5941670
	iters: 100, epoch: 7 | loss: 0.5414772
	speed: 0.0065s/iter; left time: 0.9567s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 0.49210476875305176
Epoch: 7, Steps: 123 | Train Loss: 0.5414772 Vali Loss: 0.6056062 Best vali loss: 0.5941670
	iters: 100, epoch: 8 | loss: 0.6659731
	speed: 0.0065s/iter; left time: 0.1552s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4826958179473877
Epoch: 8, Steps: 123 | Train Loss: 0.6659731 Vali Loss: 0.6110417 Best vali loss: 0.5941670

best validation loss 0.5941669866201338

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3315206
	speed: 0.0110s/iter; left time: 42.1348s
	iters: 200, epoch: 1 | loss: 0.7746350
	speed: 0.0050s/iter; left time: 18.6635s
	iters: 300, epoch: 1 | loss: 0.5214956
	speed: 0.0049s/iter; left time: 17.8377s
	iters: 400, epoch: 1 | loss: 0.5262787
	speed: 0.0050s/iter; left time: 17.4609s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.6484).  Saving model state dict ...
Epoch: 1 cost time: 2.7912230491638184
Epoch: 1, Steps: 490 | Train Loss: 0.5384825 Vali Loss: 0.6484084 Best vali loss: 0.6484084
	iters: 100, epoch: 2 | loss: 0.7205979
	speed: 0.0135s/iter; left time: 45.0332s
	iters: 200, epoch: 2 | loss: 1.0390346
	speed: 0.0047s/iter; left time: 15.2982s
	iters: 300, epoch: 2 | loss: 1.1318545
	speed: 0.0049s/iter; left time: 15.4490s
	iters: 400, epoch: 2 | loss: 0.9636194
	speed: 0.0050s/iter; left time: 15.0730s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.6484 --> 0.6313).  Saving model state dict ...
Epoch: 2 cost time: 2.437422037124634
Epoch: 2, Steps: 490 | Train Loss: 0.9637766 Vali Loss: 0.6313189 Best vali loss: 0.6313189
	iters: 100, epoch: 3 | loss: 0.7004134
	speed: 0.0130s/iter; left time: 37.0641s
	iters: 200, epoch: 3 | loss: 1.0233756
	speed: 0.0049s/iter; left time: 13.3383s
	iters: 300, epoch: 3 | loss: 0.7775263
	speed: 0.0047s/iter; left time: 12.4237s
	iters: 400, epoch: 3 | loss: 0.4457768
	speed: 0.0049s/iter; left time: 12.3461s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.6313 --> 0.6236).  Saving model state dict ...
Epoch: 3 cost time: 2.438035488128662
Epoch: 3, Steps: 490 | Train Loss: 0.7367730 Vali Loss: 0.6236137 Best vali loss: 0.6236137

best validation loss 0.6236137351204764

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0961958
	speed: 0.0090s/iter; left time: 69.5605s
	iters: 200, epoch: 1 | loss: 0.9028274
	speed: 0.0035s/iter; left time: 26.5021s
	iters: 300, epoch: 1 | loss: 1.1882370
	speed: 0.0034s/iter; left time: 25.7109s
	iters: 400, epoch: 1 | loss: 0.5570403
	speed: 0.0035s/iter; left time: 25.9478s
	iters: 500, epoch: 1 | loss: 1.2732174
	speed: 0.0035s/iter; left time: 25.7100s
	iters: 600, epoch: 1 | loss: 0.9396411
	speed: 0.0033s/iter; left time: 23.5542s
	iters: 700, epoch: 1 | loss: 0.9499931
	speed: 0.0033s/iter; left time: 23.6550s
	iters: 800, epoch: 1 | loss: 1.1420341
	speed: 0.0034s/iter; left time: 23.8035s
	iters: 900, epoch: 1 | loss: 1.2361540
	speed: 0.0034s/iter; left time: 23.5269s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.6015).  Saving model state dict ...
Epoch: 1 cost time: 3.628122568130493
Epoch: 1, Steps: 979 | Train Loss: 1.0317045 Vali Loss: 0.6014630 Best vali loss: 0.6014630
	iters: 100, epoch: 2 | loss: 0.4886860
	speed: 0.0111s/iter; left time: 75.2702s
	iters: 200, epoch: 2 | loss: 0.5081944
	speed: 0.0035s/iter; left time: 23.1614s
	iters: 300, epoch: 2 | loss: 0.6308609
	speed: 0.0035s/iter; left time: 22.8323s
	iters: 400, epoch: 2 | loss: 1.0384233
	speed: 0.0035s/iter; left time: 22.4810s
	iters: 500, epoch: 2 | loss: 1.3225856
	speed: 0.0034s/iter; left time: 21.8553s
	iters: 600, epoch: 2 | loss: 0.8571072
	speed: 0.0033s/iter; left time: 20.7765s
	iters: 700, epoch: 2 | loss: 0.4602526
	speed: 0.0035s/iter; left time: 21.5959s
	iters: 800, epoch: 2 | loss: 0.7504718
	speed: 0.0034s/iter; left time: 20.4127s
	iters: 900, epoch: 2 | loss: 0.8764069
	speed: 0.0034s/iter; left time: 20.5254s
Updating learning rate to 0.00029247785775
Epoch: 2 cost time: 3.415139675140381
Epoch: 2, Steps: 979 | Train Loss: 0.7703321 Vali Loss: 0.6045505 Best vali loss: 0.6014630
	iters: 100, epoch: 3 | loss: 0.6128839
	speed: 0.0113s/iter; left time: 65.0934s
	iters: 200, epoch: 3 | loss: 1.1777992
	speed: 0.0033s/iter; left time: 18.6761s
	iters: 300, epoch: 3 | loss: 0.4327598
	speed: 0.0034s/iter; left time: 18.6807s
	iters: 400, epoch: 3 | loss: 0.9730780
	speed: 0.0034s/iter; left time: 18.8303s
	iters: 500, epoch: 3 | loss: 0.9724970
	speed: 0.0032s/iter; left time: 17.3439s
	iters: 600, epoch: 3 | loss: 0.4392151
	speed: 0.0034s/iter; left time: 18.1659s
	iters: 700, epoch: 3 | loss: 0.4926546
	speed: 0.0035s/iter; left time: 17.9825s
	iters: 800, epoch: 3 | loss: 0.5457087
	speed: 0.0035s/iter; left time: 17.6313s
	iters: 900, epoch: 3 | loss: 0.5636624
	speed: 0.0035s/iter; left time: 17.2645s
Updating learning rate to 0.000146238928875
Epoch: 3 cost time: 3.3725359439849854
Epoch: 3, Steps: 979 | Train Loss: 0.6900287 Vali Loss: 0.6395180 Best vali loss: 0.6014630

best validation loss 0.6014629650700705

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4707351
	speed: 0.0110s/iter; left time: 84.7447s
	iters: 200, epoch: 1 | loss: 0.9214772
	speed: 0.0052s/iter; left time: 39.4969s
	iters: 300, epoch: 1 | loss: 1.0271642
	speed: 0.0052s/iter; left time: 38.8655s
	iters: 400, epoch: 1 | loss: 0.4611393
	speed: 0.0052s/iter; left time: 38.5658s
	iters: 500, epoch: 1 | loss: 0.5764194
	speed: 0.0051s/iter; left time: 37.7584s
	iters: 600, epoch: 1 | loss: 0.7745081
	speed: 0.0050s/iter; left time: 36.3125s
	iters: 700, epoch: 1 | loss: 0.9306949
	speed: 0.0048s/iter; left time: 34.5487s
	iters: 800, epoch: 1 | loss: 0.2119989
	speed: 0.0049s/iter; left time: 34.4125s
	iters: 900, epoch: 1 | loss: 0.9381531
	speed: 0.0048s/iter; left time: 33.5761s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.5984).  Saving model state dict ...
Epoch: 1 cost time: 5.241434097290039
Epoch: 1, Steps: 979 | Train Loss: 0.7013656 Vali Loss: 0.5984487 Best vali loss: 0.5984487
	iters: 100, epoch: 2 | loss: 0.3792777
	speed: 0.0157s/iter; left time: 105.7845s
	iters: 200, epoch: 2 | loss: 1.5408961
	speed: 0.0049s/iter; left time: 32.5721s
	iters: 300, epoch: 2 | loss: 0.6407424
	speed: 0.0049s/iter; left time: 32.4250s
	iters: 400, epoch: 2 | loss: 0.2311381
	speed: 0.0050s/iter; left time: 32.5123s
	iters: 500, epoch: 2 | loss: 0.8705788
	speed: 0.0049s/iter; left time: 30.8365s
	iters: 600, epoch: 2 | loss: 0.6682368
	speed: 0.0047s/iter; left time: 29.5373s
	iters: 700, epoch: 2 | loss: 0.7348717
	speed: 0.0048s/iter; left time: 29.7235s
	iters: 800, epoch: 2 | loss: 1.4678880
	speed: 0.0048s/iter; left time: 29.2543s
	iters: 900, epoch: 2 | loss: 0.8373167
	speed: 0.0050s/iter; left time: 29.5916s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.5984 --> 0.5762).  Saving model state dict ...
Epoch: 2 cost time: 4.846588134765625
Epoch: 2, Steps: 979 | Train Loss: 0.8189940 Vali Loss: 0.5761599 Best vali loss: 0.5761599
	iters: 100, epoch: 3 | loss: 0.3804228
	speed: 0.0154s/iter; left time: 89.1282s
	iters: 200, epoch: 3 | loss: 0.4603672
	speed: 0.0050s/iter; left time: 28.5905s
	iters: 300, epoch: 3 | loss: 0.9856781
	speed: 0.0047s/iter; left time: 25.9458s
	iters: 400, epoch: 3 | loss: 1.7846409
	speed: 0.0046s/iter; left time: 25.1043s
	iters: 500, epoch: 3 | loss: 1.1407996
	speed: 0.0046s/iter; left time: 24.7467s
	iters: 600, epoch: 3 | loss: 0.3542331
	speed: 0.0046s/iter; left time: 24.4513s
	iters: 700, epoch: 3 | loss: 0.8755879
	speed: 0.0049s/iter; left time: 25.4735s
	iters: 800, epoch: 3 | loss: 0.2192959
	speed: 0.0052s/iter; left time: 26.5037s
	iters: 900, epoch: 3 | loss: 0.6650866
	speed: 0.0052s/iter; left time: 25.9604s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 4.850864887237549
Epoch: 3, Steps: 979 | Train Loss: 0.7629013 Vali Loss: 0.5765824 Best vali loss: 0.5761599

best validation loss 0.5761599035408694

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4548878
	speed: 0.0112s/iter; left time: 53.6988s
	iters: 200, epoch: 4 | loss: 0.6903430
	speed: 0.0051s/iter; left time: 24.0331s
	iters: 300, epoch: 4 | loss: 0.7204676
	speed: 0.0052s/iter; left time: 23.8825s
	iters: 400, epoch: 4 | loss: 0.4473029
	speed: 0.0052s/iter; left time: 23.2563s
	iters: 500, epoch: 4 | loss: 0.4793217
	speed: 0.0052s/iter; left time: 22.7809s
	iters: 600, epoch: 4 | loss: 0.7296180
	speed: 0.0051s/iter; left time: 21.7863s
	iters: 700, epoch: 4 | loss: 0.9246818
	speed: 0.0052s/iter; left time: 21.7154s
	iters: 800, epoch: 4 | loss: 0.2352158
	speed: 0.0052s/iter; left time: 21.2377s
	iters: 900, epoch: 4 | loss: 0.9299696
	speed: 0.0052s/iter; left time: 20.6768s
Updating learning rate to 0.0001477158077
Validation loss decreased (0.5762 --> 0.5607).  Saving model state dict ...
Epoch: 4 cost time: 5.386002063751221
Epoch: 4, Steps: 979 | Train Loss: 0.6235342 Vali Loss: 0.5606856 Best vali loss: 0.5606856
	iters: 100, epoch: 5 | loss: 0.3595628
	speed: 0.0154s/iter; left time: 58.7932s
	iters: 200, epoch: 5 | loss: 1.5151719
	speed: 0.0052s/iter; left time: 19.1771s
	iters: 300, epoch: 5 | loss: 0.5975339
	speed: 0.0051s/iter; left time: 18.4727s
	iters: 400, epoch: 5 | loss: 0.2430754
	speed: 0.0052s/iter; left time: 18.1270s
	iters: 500, epoch: 5 | loss: 0.8596045
	speed: 0.0051s/iter; left time: 17.4600s
	iters: 600, epoch: 5 | loss: 0.6256528
	speed: 0.0052s/iter; left time: 17.0908s
	iters: 700, epoch: 5 | loss: 0.5465571
	speed: 0.0051s/iter; left time: 16.5052s
	iters: 800, epoch: 5 | loss: 1.2806702
	speed: 0.0051s/iter; left time: 15.8703s
	iters: 900, epoch: 5 | loss: 0.8038408
	speed: 0.0051s/iter; left time: 15.3813s
Updating learning rate to 9.118741539478246e-05
Validation loss decreased (0.5607 --> 0.5567).  Saving model state dict ...
Epoch: 5 cost time: 5.058539628982544
Epoch: 5, Steps: 979 | Train Loss: 0.7590744 Vali Loss: 0.5567091 Best vali loss: 0.5567091
	iters: 100, epoch: 6 | loss: 0.3786893
	speed: 0.0155s/iter; left time: 44.1018s
	iters: 200, epoch: 6 | loss: 0.4147065
	speed: 0.0050s/iter; left time: 13.7423s
	iters: 300, epoch: 6 | loss: 0.8126183
	speed: 0.0050s/iter; left time: 13.3150s
	iters: 400, epoch: 6 | loss: 1.5000579
	speed: 0.0050s/iter; left time: 12.6946s
	iters: 500, epoch: 6 | loss: 1.1088307
	speed: 0.0048s/iter; left time: 11.7398s
	iters: 600, epoch: 6 | loss: 0.2424278
	speed: 0.0047s/iter; left time: 11.0454s
	iters: 700, epoch: 6 | loss: 0.8353704
	speed: 0.0047s/iter; left time: 10.4966s
	iters: 800, epoch: 6 | loss: 0.2063348
	speed: 0.0048s/iter; left time: 10.2410s
	iters: 900, epoch: 6 | loss: 0.5523394
	speed: 0.0047s/iter; left time: 9.5612s
Updating learning rate to 4.326495838688198e-05
Validation loss decreased (0.5567 --> 0.5549).  Saving model state dict ...
Epoch: 6 cost time: 4.794289827346802
Epoch: 6, Steps: 979 | Train Loss: 0.6723750 Vali Loss: 0.5548921 Best vali loss: 0.5548921
	iters: 100, epoch: 7 | loss: 0.5372220
	speed: 0.0154s/iter; left time: 28.5630s
	iters: 200, epoch: 7 | loss: 0.8098506
	speed: 0.0051s/iter; left time: 9.0238s
	iters: 300, epoch: 7 | loss: 0.1997503
	speed: 0.0052s/iter; left time: 8.5926s
	iters: 400, epoch: 7 | loss: 0.6655732
	speed: 0.0051s/iter; left time: 7.9597s
	iters: 500, epoch: 7 | loss: 0.7198297
	speed: 0.0052s/iter; left time: 7.5211s
	iters: 600, epoch: 7 | loss: 0.4881665
	speed: 0.0052s/iter; left time: 7.0482s
	iters: 700, epoch: 7 | loss: 1.2917229
	speed: 0.0052s/iter; left time: 6.5262s
	iters: 800, epoch: 7 | loss: 0.4348227
	speed: 0.0051s/iter; left time: 5.9636s
	iters: 900, epoch: 7 | loss: 0.3614931
	speed: 0.0052s/iter; left time: 5.5383s
Updating learning rate to 1.124419633759687e-05
Epoch: 7 cost time: 5.096431493759155
Epoch: 7, Steps: 979 | Train Loss: 0.6120479 Vali Loss: 0.5590323 Best vali loss: 0.5548921
	iters: 100, epoch: 8 | loss: 1.0318402
	speed: 0.0151s/iter; left time: 13.2962s
	iters: 200, epoch: 8 | loss: 0.9056216
	speed: 0.0047s/iter; left time: 3.6460s
	iters: 300, epoch: 8 | loss: 0.4616587
	speed: 0.0044s/iter; left time: 2.9713s
	iters: 400, epoch: 8 | loss: 0.2348142
	speed: 0.0046s/iter; left time: 2.6786s
	iters: 500, epoch: 8 | loss: 0.7337242
	speed: 0.0047s/iter; left time: 2.2508s
	iters: 600, epoch: 8 | loss: 0.7558138
	speed: 0.0048s/iter; left time: 1.8215s
	iters: 700, epoch: 8 | loss: 0.3637642
	speed: 0.0049s/iter; left time: 1.3836s
	iters: 800, epoch: 8 | loss: 0.2925401
	speed: 0.0050s/iter; left time: 0.8993s
	iters: 900, epoch: 8 | loss: 1.0505928
	speed: 0.0048s/iter; left time: 0.3856s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.659372329711914
Epoch: 8, Steps: 979 | Train Loss: 0.6478189 Vali Loss: 0.5591945 Best vali loss: 0.5548921

best validation loss 0.5548921171739553

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8814884
	speed: 0.0104s/iter; left time: 9.2456s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.6541).  Saving model state dict ...
Epoch: 1 cost time: 0.8835961818695068
Epoch: 1, Steps: 123 | Train Loss: 0.8814884 Vali Loss: 0.6541116 Best vali loss: 0.6541116
	iters: 100, epoch: 2 | loss: 0.8264772
	speed: 0.0075s/iter; left time: 5.7069s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.6541 --> 0.6233).  Saving model state dict ...
Epoch: 2 cost time: 0.5968120098114014
Epoch: 2, Steps: 123 | Train Loss: 0.8264772 Vali Loss: 0.6233295 Best vali loss: 0.6233295
	iters: 100, epoch: 3 | loss: 0.8398587
	speed: 0.0077s/iter; left time: 4.9479s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.6233 --> 0.6134).  Saving model state dict ...
Epoch: 3 cost time: 0.6107254028320312
Epoch: 3, Steps: 123 | Train Loss: 0.8398587 Vali Loss: 0.6133839 Best vali loss: 0.6133839
	iters: 100, epoch: 4 | loss: 1.1781151
	speed: 0.0074s/iter; left time: 3.8418s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.6134 --> 0.6094).  Saving model state dict ...
Epoch: 4 cost time: 0.5889766216278076
Epoch: 4, Steps: 123 | Train Loss: 1.1781151 Vali Loss: 0.6094445 Best vali loss: 0.6094445
	iters: 100, epoch: 5 | loss: 0.6293311
	speed: 0.0077s/iter; left time: 3.0381s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.6094 --> 0.6060).  Saving model state dict ...
Epoch: 5 cost time: 0.6057472229003906
Epoch: 5, Steps: 123 | Train Loss: 0.6293311 Vali Loss: 0.6060345 Best vali loss: 0.6060345
	iters: 100, epoch: 6 | loss: 0.5971664
	speed: 0.0075s/iter; left time: 2.0198s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.6060 --> 0.6057).  Saving model state dict ...
Epoch: 6 cost time: 0.5926957130432129
Epoch: 6, Steps: 123 | Train Loss: 0.5971664 Vali Loss: 0.6057358 Best vali loss: 0.6057358
	iters: 100, epoch: 7 | loss: 0.8493176
	speed: 0.0077s/iter; left time: 1.1376s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.6057 --> 0.6049).  Saving model state dict ...
Epoch: 7 cost time: 0.6087594032287598
Epoch: 7, Steps: 123 | Train Loss: 0.8493176 Vali Loss: 0.6048817 Best vali loss: 0.6048817
	iters: 100, epoch: 8 | loss: 0.8832586
	speed: 0.0076s/iter; left time: 0.1831s
Updating learning rate to 0.0
Validation loss decreased (0.6049 --> 0.6048).  Saving model state dict ...
Epoch: 8 cost time: 0.5875439643859863
Epoch: 8, Steps: 123 | Train Loss: 0.8832586 Vali Loss: 0.6047628 Best vali loss: 0.6047628

best validation loss 0.6047627839265406

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5834743
	speed: 0.0088s/iter; left time: 16.4292s
	iters: 200, epoch: 1 | loss: 0.7879714
	speed: 0.0029s/iter; left time: 5.1001s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.6193).  Saving model state dict ...
Epoch: 1 cost time: 1.0465502738952637
Epoch: 1, Steps: 245 | Train Loss: 0.6857229 Vali Loss: 0.6193133 Best vali loss: 0.6193133
	iters: 100, epoch: 2 | loss: 0.7902344
	speed: 0.0066s/iter; left time: 10.6662s
	iters: 200, epoch: 2 | loss: 1.1255476
	speed: 0.0030s/iter; left time: 4.5203s
Updating learning rate to 0.000492952456
Validation loss decreased (0.6193 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 0.7931411266326904
Epoch: 2, Steps: 245 | Train Loss: 0.9578910 Vali Loss: 0.6048410 Best vali loss: 0.6048410
	iters: 100, epoch: 3 | loss: 1.0105031
	speed: 0.0068s/iter; left time: 9.3166s
	iters: 200, epoch: 3 | loss: 0.5771964
	speed: 0.0029s/iter; left time: 3.7243s
Updating learning rate to 0.000246476228
Epoch: 3 cost time: 0.766782283782959
Epoch: 3, Steps: 245 | Train Loss: 0.7938497 Vali Loss: 0.6257346 Best vali loss: 0.6048410
	iters: 100, epoch: 4 | loss: 0.7580621
	speed: 0.0063s/iter; left time: 7.1033s
	iters: 200, epoch: 4 | loss: 0.8703737
	speed: 0.0028s/iter; left time: 2.9224s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 0.7373752593994141
Epoch: 4, Steps: 245 | Train Loss: 0.8142179 Vali Loss: 0.6205835 Best vali loss: 0.6048410
	iters: 100, epoch: 5 | loss: 0.8504981
	speed: 0.0065s/iter; left time: 5.7620s
	iters: 200, epoch: 5 | loss: 0.6596811
	speed: 0.0030s/iter; left time: 2.3360s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 0.7726902961730957
Epoch: 5, Steps: 245 | Train Loss: 0.7550896 Vali Loss: 0.6237678 Best vali loss: 0.6048410
	iters: 100, epoch: 6 | loss: 0.5511391
	speed: 0.0065s/iter; left time: 4.1104s
	iters: 200, epoch: 6 | loss: 0.6750317
	speed: 0.0028s/iter; left time: 1.5263s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 0.7463626861572266
Epoch: 6, Steps: 245 | Train Loss: 0.6130854 Vali Loss: 0.6293749 Best vali loss: 0.6048410
	iters: 100, epoch: 7 | loss: 0.4105996
	speed: 0.0068s/iter; left time: 2.6405s
	iters: 200, epoch: 7 | loss: 0.7639289
	speed: 0.0031s/iter; left time: 0.8900s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 0.8017580509185791
Epoch: 7, Steps: 245 | Train Loss: 0.5872643 Vali Loss: 0.6357530 Best vali loss: 0.6048410
	iters: 100, epoch: 8 | loss: 0.7066257
	speed: 0.0067s/iter; left time: 0.9813s
	iters: 200, epoch: 8 | loss: 0.3118826
	speed: 0.0027s/iter; left time: 0.1254s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 0.7390177249908447
Epoch: 8, Steps: 245 | Train Loss: 0.5092542 Vali Loss: 0.6337390 Best vali loss: 0.6048410

best validation loss 0.6048410219320927

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2593104
	speed: 0.0095s/iter; left time: 36.4788s
	iters: 200, epoch: 1 | loss: 0.5042582
	speed: 0.0033s/iter; left time: 12.2627s
	iters: 300, epoch: 1 | loss: 1.0177982
	speed: 0.0033s/iter; left time: 11.8414s
	iters: 400, epoch: 1 | loss: 0.9807774
	speed: 0.0032s/iter; left time: 11.3008s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.6617).  Saving model state dict ...
Epoch: 1 cost time: 1.97212815284729
Epoch: 1, Steps: 490 | Train Loss: 0.9405360 Vali Loss: 0.6616529 Best vali loss: 0.6616529
	iters: 100, epoch: 2 | loss: 1.7275096
	speed: 0.0095s/iter; left time: 31.7461s
	iters: 200, epoch: 2 | loss: 1.4360590
	speed: 0.0033s/iter; left time: 10.7125s
	iters: 300, epoch: 2 | loss: 0.7356061
	speed: 0.0032s/iter; left time: 10.0941s
	iters: 400, epoch: 2 | loss: 0.5101873
	speed: 0.0034s/iter; left time: 10.1751s
Updating learning rate to 0.0006752130564
Validation loss decreased (0.6617 --> 0.6199).  Saving model state dict ...
Epoch: 2 cost time: 1.655219316482544
Epoch: 2, Steps: 490 | Train Loss: 1.1023405 Vali Loss: 0.6198504 Best vali loss: 0.6198504
	iters: 100, epoch: 3 | loss: 0.9368058
	speed: 0.0098s/iter; left time: 27.7912s
	iters: 200, epoch: 3 | loss: 1.5195544
	speed: 0.0033s/iter; left time: 9.1384s
	iters: 300, epoch: 3 | loss: 0.6794641
	speed: 0.0032s/iter; left time: 8.3922s
	iters: 400, epoch: 3 | loss: 1.4400300
	speed: 0.0032s/iter; left time: 8.0398s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.6199 --> 0.6058).  Saving model state dict ...
Epoch: 3 cost time: 1.6262974739074707
Epoch: 3, Steps: 490 | Train Loss: 1.1439636 Vali Loss: 0.6058215 Best vali loss: 0.6058215

best validation loss 0.6058215185593037

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2316747
	speed: 0.0098s/iter; left time: 37.5045s
	iters: 200, epoch: 1 | loss: 0.3707284
	speed: 0.0036s/iter; left time: 13.3921s
	iters: 300, epoch: 1 | loss: 0.9053365
	speed: 0.0035s/iter; left time: 12.6982s
	iters: 400, epoch: 1 | loss: 0.9310809
	speed: 0.0035s/iter; left time: 12.3540s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.6287).  Saving model state dict ...
Epoch: 1 cost time: 2.106168270111084
Epoch: 1, Steps: 490 | Train Loss: 0.8597051 Vali Loss: 0.6287454 Best vali loss: 0.6287454
	iters: 100, epoch: 2 | loss: 1.3408583
	speed: 0.0100s/iter; left time: 33.2863s
	iters: 200, epoch: 2 | loss: 0.9779740
	speed: 0.0034s/iter; left time: 10.9655s
	iters: 300, epoch: 2 | loss: 0.6196385
	speed: 0.0034s/iter; left time: 10.7467s
	iters: 400, epoch: 2 | loss: 0.8584324
	speed: 0.0034s/iter; left time: 10.2681s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.6287 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 1.713036060333252
Epoch: 2, Steps: 490 | Train Loss: 0.9492258 Vali Loss: 0.6068855 Best vali loss: 0.6068855
	iters: 100, epoch: 3 | loss: 0.7699869
	speed: 0.0103s/iter; left time: 29.3816s
	iters: 200, epoch: 3 | loss: 0.7785657
	speed: 0.0035s/iter; left time: 9.7072s
	iters: 300, epoch: 3 | loss: 0.8200800
	speed: 0.0037s/iter; left time: 9.7167s
	iters: 400, epoch: 3 | loss: 0.9771779
	speed: 0.0036s/iter; left time: 9.2596s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.6069 --> 0.6060).  Saving model state dict ...
Epoch: 3 cost time: 1.81764817237854
Epoch: 3, Steps: 490 | Train Loss: 0.8364526 Vali Loss: 0.6060186 Best vali loss: 0.6060186

best validation loss 0.6060186134533218

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0056075
	speed: 0.0102s/iter; left time: 9.0642s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.6270).  Saving model state dict ...
Epoch: 1 cost time: 0.867417573928833
Epoch: 1, Steps: 123 | Train Loss: 1.0056075 Vali Loss: 0.6270124 Best vali loss: 0.6270124
	iters: 100, epoch: 2 | loss: 0.7778403
	speed: 0.0074s/iter; left time: 5.6701s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.6270 --> 0.6127).  Saving model state dict ...
Epoch: 2 cost time: 0.587691068649292
Epoch: 2, Steps: 123 | Train Loss: 0.7778403 Vali Loss: 0.6126502 Best vali loss: 0.6126502
	iters: 100, epoch: 3 | loss: 0.9143332
	speed: 0.0076s/iter; left time: 4.8516s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.6127 --> 0.6065).  Saving model state dict ...
Epoch: 3 cost time: 0.5869519710540771
Epoch: 3, Steps: 123 | Train Loss: 0.9143332 Vali Loss: 0.6064647 Best vali loss: 0.6064647

best validation loss 0.6064647425384998

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2763748
	speed: 0.0096s/iter; left time: 22.6106s
	iters: 200, epoch: 4 | loss: 0.5079107
	speed: 0.0038s/iter; left time: 8.4654s
	iters: 300, epoch: 4 | loss: 0.9877424
	speed: 0.0037s/iter; left time: 7.9744s
	iters: 400, epoch: 4 | loss: 0.9038481
	speed: 0.0035s/iter; left time: 7.2763s
Updating learning rate to 0.0001688032641
Epoch: 4 cost time: 2.127917766571045
Epoch: 4, Steps: 490 | Train Loss: 0.9189690 Vali Loss: 0.6078756 Best vali loss: 0.6058215
	iters: 100, epoch: 5 | loss: 1.6713269
	speed: 0.0103s/iter; left time: 19.0872s
	iters: 200, epoch: 5 | loss: 1.3897839
	speed: 0.0038s/iter; left time: 6.6348s
	iters: 300, epoch: 5 | loss: 0.6356441
	speed: 0.0038s/iter; left time: 6.2319s
	iters: 400, epoch: 5 | loss: 0.4907759
	speed: 0.0036s/iter; left time: 5.6297s
Updating learning rate to 8.440163205e-05
Epoch: 5 cost time: 1.8721809387207031
Epoch: 5, Steps: 490 | Train Loss: 1.0468827 Vali Loss: 0.6172812 Best vali loss: 0.6058215
	iters: 100, epoch: 6 | loss: 0.8925209
	speed: 0.0100s/iter; left time: 13.7134s
	iters: 200, epoch: 6 | loss: 1.2886544
	speed: 0.0034s/iter; left time: 4.3284s
	iters: 300, epoch: 6 | loss: 0.6803208
	speed: 0.0034s/iter; left time: 3.9678s
	iters: 400, epoch: 6 | loss: 1.3956804
	speed: 0.0033s/iter; left time: 3.5671s
Updating learning rate to 4.2200816025e-05
Epoch: 6 cost time: 1.6954286098480225
Epoch: 6, Steps: 490 | Train Loss: 1.0642941 Vali Loss: 0.6190583 Best vali loss: 0.6058215
	iters: 100, epoch: 7 | loss: 0.9738927
	speed: 0.0094s/iter; left time: 8.2914s
	iters: 200, epoch: 7 | loss: 0.9252003
	speed: 0.0033s/iter; left time: 2.5518s
	iters: 300, epoch: 7 | loss: 0.7233030
	speed: 0.0032s/iter; left time: 2.1825s
	iters: 400, epoch: 7 | loss: 0.6140118
	speed: 0.0033s/iter; left time: 1.9064s
Updating learning rate to 2.11004080125e-05
Epoch: 7 cost time: 1.645031452178955
Epoch: 7, Steps: 490 | Train Loss: 0.8091020 Vali Loss: 0.6225428 Best vali loss: 0.6058215
	iters: 100, epoch: 8 | loss: 0.7196755
	speed: 0.0099s/iter; left time: 3.8734s
	iters: 200, epoch: 8 | loss: 0.6696162
	speed: 0.0032s/iter; left time: 0.9209s
	iters: 300, epoch: 8 | loss: 0.9056032
	speed: 0.0032s/iter; left time: 0.6083s
	iters: 400, epoch: 8 | loss: 1.0176736
	speed: 0.0033s/iter; left time: 0.2964s
Updating learning rate to 1.055020400625e-05
Epoch: 8 cost time: 1.6711509227752686
Epoch: 8, Steps: 490 | Train Loss: 0.8281421 Vali Loss: 0.6266686 Best vali loss: 0.6058215

best validation loss 0.6058215185593037

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6428643
	speed: 0.0087s/iter; left time: 66.9365s
	iters: 200, epoch: 1 | loss: 0.9858434
	speed: 0.0026s/iter; left time: 19.9194s
	iters: 300, epoch: 1 | loss: 0.6853002
	speed: 0.0026s/iter; left time: 19.6798s
	iters: 400, epoch: 1 | loss: 0.4967229
	speed: 0.0026s/iter; left time: 19.2703s
	iters: 500, epoch: 1 | loss: 0.6751224
	speed: 0.0026s/iter; left time: 18.9917s
	iters: 600, epoch: 1 | loss: 0.8107519
	speed: 0.0026s/iter; left time: 19.0198s
	iters: 700, epoch: 1 | loss: 0.9764891
	speed: 0.0027s/iter; left time: 18.9324s
	iters: 800, epoch: 1 | loss: 0.8228440
	speed: 0.0026s/iter; left time: 18.2970s
	iters: 900, epoch: 1 | loss: 0.8666231
	speed: 0.0026s/iter; left time: 18.0340s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.6351).  Saving model state dict ...
Epoch: 1 cost time: 2.90063738822937
Epoch: 1, Steps: 979 | Train Loss: 0.7736179 Vali Loss: 0.6351439 Best vali loss: 0.6351439
	iters: 100, epoch: 2 | loss: 1.1872803
	speed: 0.0091s/iter; left time: 61.1649s
	iters: 200, epoch: 2 | loss: 0.5148379
	speed: 0.0026s/iter; left time: 17.2821s
	iters: 300, epoch: 2 | loss: 0.6759478
	speed: 0.0025s/iter; left time: 16.3714s
	iters: 400, epoch: 2 | loss: 1.2946001
	speed: 0.0026s/iter; left time: 16.8785s
	iters: 500, epoch: 2 | loss: 0.3174016
	speed: 0.0026s/iter; left time: 16.5068s
	iters: 600, epoch: 2 | loss: 0.9188021
	speed: 0.0026s/iter; left time: 16.2249s
	iters: 700, epoch: 2 | loss: 0.4648733
	speed: 0.0026s/iter; left time: 15.9563s
	iters: 800, epoch: 2 | loss: 1.1980981
	speed: 0.0025s/iter; left time: 15.3455s
	iters: 900, epoch: 2 | loss: 1.2234169
	speed: 0.0025s/iter; left time: 15.0668s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.6351 --> 0.6237).  Saving model state dict ...
Epoch: 2 cost time: 2.5442121028900146
Epoch: 2, Steps: 979 | Train Loss: 0.8661398 Vali Loss: 0.6237332 Best vali loss: 0.6237332
	iters: 100, epoch: 3 | loss: 1.0175266
	speed: 0.0088s/iter; left time: 50.6605s
	iters: 200, epoch: 3 | loss: 0.8609635
	speed: 0.0023s/iter; left time: 12.8050s
	iters: 300, epoch: 3 | loss: 1.1703978
	speed: 0.0023s/iter; left time: 12.5509s
	iters: 400, epoch: 3 | loss: 1.3491871
	speed: 0.0023s/iter; left time: 12.4507s
	iters: 500, epoch: 3 | loss: 0.5340598
	speed: 0.0023s/iter; left time: 12.1053s
	iters: 600, epoch: 3 | loss: 1.0405077
	speed: 0.0023s/iter; left time: 11.8690s
	iters: 700, epoch: 3 | loss: 1.2485420
	speed: 0.0023s/iter; left time: 11.7818s
	iters: 800, epoch: 3 | loss: 0.6067438
	speed: 0.0023s/iter; left time: 11.5460s
	iters: 900, epoch: 3 | loss: 1.1588031
	speed: 0.0023s/iter; left time: 11.2158s
Updating learning rate to 0.001330348698804596
Epoch: 3 cost time: 2.263998031616211
Epoch: 3, Steps: 979 | Train Loss: 0.9985257 Vali Loss: 0.6377781 Best vali loss: 0.6237332
	iters: 100, epoch: 4 | loss: 0.9177212
	speed: 0.0086s/iter; left time: 41.2308s
	iters: 200, epoch: 4 | loss: 0.5786377
	speed: 0.0022s/iter; left time: 10.3205s
	iters: 300, epoch: 4 | loss: 1.1005070
	speed: 0.0022s/iter; left time: 10.2641s
	iters: 400, epoch: 4 | loss: 0.3122427
	speed: 0.0023s/iter; left time: 10.4205s
	iters: 500, epoch: 4 | loss: 0.3015873
	speed: 0.0022s/iter; left time: 9.6512s
	iters: 600, epoch: 4 | loss: 0.5718580
	speed: 0.0023s/iter; left time: 9.7396s
	iters: 700, epoch: 4 | loss: 0.6950983
	speed: 0.0023s/iter; left time: 9.8341s
	iters: 800, epoch: 4 | loss: 0.4531235
	speed: 0.0023s/iter; left time: 9.3233s
	iters: 900, epoch: 4 | loss: 0.2297505
	speed: 0.0023s/iter; left time: 9.1771s
Updating learning rate to 0.0009621498802
Epoch: 4 cost time: 2.2591359615325928
Epoch: 4, Steps: 979 | Train Loss: 0.5733918 Vali Loss: 0.6507766 Best vali loss: 0.6237332
	iters: 100, epoch: 5 | loss: 0.9715108
	speed: 0.0086s/iter; left time: 32.6998s
	iters: 200, epoch: 5 | loss: 0.5071674
	speed: 0.0025s/iter; left time: 9.1587s
	iters: 300, epoch: 5 | loss: 0.2445570
	speed: 0.0025s/iter; left time: 8.9115s
	iters: 400, epoch: 5 | loss: 1.2769419
	speed: 0.0025s/iter; left time: 8.9224s
	iters: 500, epoch: 5 | loss: 0.6226594
	speed: 0.0026s/iter; left time: 8.7438s
	iters: 600, epoch: 5 | loss: 0.3511614
	speed: 0.0027s/iter; left time: 8.8095s
	iters: 700, epoch: 5 | loss: 0.5423728
	speed: 0.0026s/iter; left time: 8.3182s
	iters: 800, epoch: 5 | loss: 0.3674095
	speed: 0.0025s/iter; left time: 7.8341s
	iters: 900, epoch: 5 | loss: 1.2094420
	speed: 0.0026s/iter; left time: 7.7038s
Updating learning rate to 0.0005939510615954041
Epoch: 5 cost time: 2.5125062465667725
Epoch: 5, Steps: 979 | Train Loss: 0.6770247 Vali Loss: 0.6452353 Best vali loss: 0.6237332
	iters: 100, epoch: 6 | loss: 0.5193803
	speed: 0.0089s/iter; left time: 25.1614s
	iters: 200, epoch: 6 | loss: 1.2245414
	speed: 0.0025s/iter; left time: 6.7730s
	iters: 300, epoch: 6 | loss: 0.3709016
	speed: 0.0026s/iter; left time: 6.8288s
	iters: 400, epoch: 6 | loss: 0.8421053
	speed: 0.0026s/iter; left time: 6.5824s
	iters: 500, epoch: 6 | loss: 0.3020107
	speed: 0.0025s/iter; left time: 6.1152s
	iters: 600, epoch: 6 | loss: 0.7761723
	speed: 0.0024s/iter; left time: 5.5455s
	iters: 700, epoch: 6 | loss: 0.6879596
	speed: 0.0023s/iter; left time: 5.2406s
	iters: 800, epoch: 6 | loss: 0.7226998
	speed: 0.0024s/iter; left time: 5.0627s
	iters: 900, epoch: 6 | loss: 0.8202045
	speed: 0.0024s/iter; left time: 4.9236s
Updating learning rate to 0.0002818071753927558
Validation loss decreased (0.6237 --> 0.6005).  Saving model state dict ...
Epoch: 6 cost time: 2.4465408325195312
Epoch: 6, Steps: 979 | Train Loss: 0.6962195 Vali Loss: 0.6004855 Best vali loss: 0.6004855
	iters: 100, epoch: 7 | loss: 0.7002710
	speed: 0.0090s/iter; left time: 16.6949s
	iters: 200, epoch: 7 | loss: 1.3656328
	speed: 0.0025s/iter; left time: 4.3973s
	iters: 300, epoch: 7 | loss: 0.9385592
	speed: 0.0023s/iter; left time: 3.8451s
	iters: 400, epoch: 7 | loss: 1.1427071
	speed: 0.0024s/iter; left time: 3.7178s
	iters: 500, epoch: 7 | loss: 1.0289224
	speed: 0.0023s/iter; left time: 3.4251s
	iters: 600, epoch: 7 | loss: 0.3891008
	speed: 0.0023s/iter; left time: 3.1474s
	iters: 700, epoch: 7 | loss: 0.7302976
	speed: 0.0023s/iter; left time: 2.9186s
	iters: 800, epoch: 7 | loss: 0.3080257
	speed: 0.0024s/iter; left time: 2.7612s
	iters: 900, epoch: 7 | loss: 0.7042188
	speed: 0.0023s/iter; left time: 2.4318s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 2.367943286895752
Epoch: 7, Steps: 979 | Train Loss: 0.8119706 Vali Loss: 0.6012550 Best vali loss: 0.6004855
	iters: 100, epoch: 8 | loss: 0.7121531
	speed: 0.0090s/iter; left time: 7.8835s
	iters: 200, epoch: 8 | loss: 0.3635290
	speed: 0.0025s/iter; left time: 1.9636s
	iters: 300, epoch: 8 | loss: 0.4938026
	speed: 0.0024s/iter; left time: 1.6280s
	iters: 400, epoch: 8 | loss: 1.0377785
	speed: 0.0024s/iter; left time: 1.3795s
	iters: 500, epoch: 8 | loss: 1.2490187
	speed: 0.0024s/iter; left time: 1.1529s
	iters: 600, epoch: 8 | loss: 0.5185841
	speed: 0.0024s/iter; left time: 0.9216s
	iters: 700, epoch: 8 | loss: 1.3262328
	speed: 0.0025s/iter; left time: 0.6998s
	iters: 800, epoch: 8 | loss: 1.1330253
	speed: 0.0025s/iter; left time: 0.4506s
	iters: 900, epoch: 8 | loss: 1.1693730
	speed: 0.0025s/iter; left time: 0.2012s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.462388038635254
Epoch: 8, Steps: 979 | Train Loss: 0.8892774 Vali Loss: 0.6115597 Best vali loss: 0.6004855

best validation loss 0.6004854711475112

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3444832
	speed: 0.0113s/iter; left time: 87.5715s
	iters: 200, epoch: 1 | loss: 0.5062711
	speed: 0.0054s/iter; left time: 41.4147s
	iters: 300, epoch: 1 | loss: 0.7729748
	speed: 0.0054s/iter; left time: 40.6552s
	iters: 400, epoch: 1 | loss: 0.9866288
	speed: 0.0051s/iter; left time: 37.5569s
	iters: 500, epoch: 1 | loss: 0.4038266
	speed: 0.0050s/iter; left time: 36.9516s
	iters: 600, epoch: 1 | loss: 0.5609060
	speed: 0.0051s/iter; left time: 37.0773s
	iters: 700, epoch: 1 | loss: 1.0351169
	speed: 0.0052s/iter; left time: 36.8466s
	iters: 800, epoch: 1 | loss: 0.7972245
	speed: 0.0052s/iter; left time: 36.3639s
	iters: 900, epoch: 1 | loss: 0.4634576
	speed: 0.0051s/iter; left time: 35.4618s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.6139).  Saving model state dict ...
Epoch: 1 cost time: 5.448472023010254
Epoch: 1, Steps: 979 | Train Loss: 0.6523210 Vali Loss: 0.6138815 Best vali loss: 0.6138815
	iters: 100, epoch: 2 | loss: 0.9670258
	speed: 0.0158s/iter; left time: 106.7413s
	iters: 200, epoch: 2 | loss: 1.1555128
	speed: 0.0050s/iter; left time: 33.0621s
	iters: 300, epoch: 2 | loss: 0.5375369
	speed: 0.0048s/iter; left time: 31.2692s
	iters: 400, epoch: 2 | loss: 0.6264237
	speed: 0.0053s/iter; left time: 34.4149s
	iters: 500, epoch: 2 | loss: 0.6175783
	speed: 0.0051s/iter; left time: 32.6367s
	iters: 600, epoch: 2 | loss: 0.3779808
	speed: 0.0049s/iter; left time: 30.4868s
	iters: 700, epoch: 2 | loss: 0.3872306
	speed: 0.0049s/iter; left time: 29.9412s
	iters: 800, epoch: 2 | loss: 0.5248107
	speed: 0.0052s/iter; left time: 31.3880s
	iters: 900, epoch: 2 | loss: 1.6599191
	speed: 0.0048s/iter; left time: 28.8590s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.6139 --> 0.6086).  Saving model state dict ...
Epoch: 2 cost time: 4.903334379196167
Epoch: 2, Steps: 979 | Train Loss: 0.7615576 Vali Loss: 0.6085670 Best vali loss: 0.6085670
	iters: 100, epoch: 3 | loss: 0.4821854
	speed: 0.0158s/iter; left time: 91.3361s
	iters: 200, epoch: 3 | loss: 1.0497065
	speed: 0.0054s/iter; left time: 30.7622s
	iters: 300, epoch: 3 | loss: 1.1929309
	speed: 0.0055s/iter; left time: 30.4286s
	iters: 400, epoch: 3 | loss: 0.4176454
	speed: 0.0054s/iter; left time: 29.6626s
	iters: 500, epoch: 3 | loss: 0.7074066
	speed: 0.0054s/iter; left time: 29.0064s
	iters: 600, epoch: 3 | loss: 1.0725141
	speed: 0.0054s/iter; left time: 28.4977s
	iters: 700, epoch: 3 | loss: 0.8484003
	speed: 0.0053s/iter; left time: 27.4510s
	iters: 800, epoch: 3 | loss: 0.7821472
	speed: 0.0054s/iter; left time: 27.4276s
	iters: 900, epoch: 3 | loss: 0.5859364
	speed: 0.0054s/iter; left time: 27.0810s
Updating learning rate to 0.00010582472311828629
Validation loss decreased (0.6086 --> 0.5919).  Saving model state dict ...
Epoch: 3 cost time: 5.2969512939453125
Epoch: 3, Steps: 979 | Train Loss: 0.7932081 Vali Loss: 0.5919348 Best vali loss: 0.5919348
	iters: 100, epoch: 4 | loss: 0.6508787
	speed: 0.0162s/iter; left time: 77.8544s
	iters: 200, epoch: 4 | loss: 0.9556156
	speed: 0.0050s/iter; left time: 23.4116s
	iters: 300, epoch: 4 | loss: 0.6500445
	speed: 0.0049s/iter; left time: 22.4909s
	iters: 400, epoch: 4 | loss: 0.8227727
	speed: 0.0050s/iter; left time: 22.2876s
	iters: 500, epoch: 4 | loss: 0.3361123
	speed: 0.0049s/iter; left time: 21.5904s
	iters: 600, epoch: 4 | loss: 0.3380698
	speed: 0.0048s/iter; left time: 20.6965s
	iters: 700, epoch: 4 | loss: 0.2946194
	speed: 0.0049s/iter; left time: 20.7000s
	iters: 800, epoch: 4 | loss: 0.9139125
	speed: 0.0049s/iter; left time: 20.2441s
	iters: 900, epoch: 4 | loss: 0.4300253
	speed: 0.0050s/iter; left time: 19.8913s
Updating learning rate to 7.653575695e-05
Validation loss decreased (0.5919 --> 0.5915).  Saving model state dict ...
Epoch: 4 cost time: 4.870233535766602
Epoch: 4, Steps: 979 | Train Loss: 0.5991168 Vali Loss: 0.5915247 Best vali loss: 0.5915247
	iters: 100, epoch: 5 | loss: 0.5121216
	speed: 0.0159s/iter; left time: 60.7817s
	iters: 200, epoch: 5 | loss: 1.4930860
	speed: 0.0053s/iter; left time: 19.7574s
	iters: 300, epoch: 5 | loss: 0.7250523
	speed: 0.0051s/iter; left time: 18.3799s
	iters: 400, epoch: 5 | loss: 0.2568771
	speed: 0.0049s/iter; left time: 17.0878s
	iters: 500, epoch: 5 | loss: 0.7228045
	speed: 0.0047s/iter; left time: 16.2292s
	iters: 600, epoch: 5 | loss: 0.4274099
	speed: 0.0049s/iter; left time: 16.1283s
	iters: 700, epoch: 5 | loss: 0.3575677
	speed: 0.0046s/iter; left time: 14.9034s
	iters: 800, epoch: 5 | loss: 1.2647172
	speed: 0.0048s/iter; left time: 15.0135s
	iters: 900, epoch: 5 | loss: 0.2956820
	speed: 0.0048s/iter; left time: 14.3911s
Updating learning rate to 4.724679078171373e-05
Validation loss decreased (0.5915 --> 0.5606).  Saving model state dict ...
Epoch: 5 cost time: 4.847296953201294
Epoch: 5, Steps: 979 | Train Loss: 0.6728131 Vali Loss: 0.5606486 Best vali loss: 0.5606486
	iters: 100, epoch: 6 | loss: 0.7665531
	speed: 0.0150s/iter; left time: 42.4339s
	iters: 200, epoch: 6 | loss: 0.4025215
	speed: 0.0046s/iter; left time: 12.6974s
	iters: 300, epoch: 6 | loss: 0.8719901
	speed: 0.0047s/iter; left time: 12.3988s
	iters: 400, epoch: 6 | loss: 0.6431674
	speed: 0.0048s/iter; left time: 12.0634s
	iters: 500, epoch: 6 | loss: 0.3499995
	speed: 0.0048s/iter; left time: 11.7016s
	iters: 600, epoch: 6 | loss: 0.7500123
	speed: 0.0050s/iter; left time: 11.6385s
	iters: 700, epoch: 6 | loss: 0.4592994
	speed: 0.0050s/iter; left time: 11.1075s
	iters: 800, epoch: 6 | loss: 0.8983808
	speed: 0.0050s/iter; left time: 10.6433s
	iters: 900, epoch: 6 | loss: 0.4001070
	speed: 0.0050s/iter; left time: 10.1494s
Updating learning rate to 2.2416804207409573e-05
Validation loss decreased (0.5606 --> 0.5584).  Saving model state dict ...
Epoch: 6 cost time: 4.777986526489258
Epoch: 6, Steps: 979 | Train Loss: 0.6157812 Vali Loss: 0.5584413 Best vali loss: 0.5584413
	iters: 100, epoch: 7 | loss: 0.8523867
	speed: 0.0165s/iter; left time: 30.6705s
	iters: 200, epoch: 7 | loss: 0.6971147
	speed: 0.0054s/iter; left time: 9.4877s
	iters: 300, epoch: 7 | loss: 0.6672301
	speed: 0.0054s/iter; left time: 8.9896s
	iters: 400, epoch: 7 | loss: 0.3910116
	speed: 0.0055s/iter; left time: 8.5178s
	iters: 500, epoch: 7 | loss: 0.6734374
	speed: 0.0054s/iter; left time: 7.9210s
	iters: 600, epoch: 7 | loss: 0.7478874
	speed: 0.0053s/iter; left time: 7.1886s
	iters: 700, epoch: 7 | loss: 0.3401123
	speed: 0.0050s/iter; left time: 6.2825s
	iters: 800, epoch: 7 | loss: 0.9090350
	speed: 0.0050s/iter; left time: 5.7829s
	iters: 900, epoch: 7 | loss: 0.9385306
	speed: 0.0050s/iter; left time: 5.2676s
Updating learning rate to 5.825937598636536e-06
Epoch: 7 cost time: 5.162919282913208
Epoch: 7, Steps: 979 | Train Loss: 0.6907495 Vali Loss: 0.5643135 Best vali loss: 0.5584413
	iters: 100, epoch: 8 | loss: 0.6853324
	speed: 0.0158s/iter; left time: 13.9401s
	iters: 200, epoch: 8 | loss: 0.3888500
	speed: 0.0054s/iter; left time: 4.2390s
	iters: 300, epoch: 8 | loss: 0.3660751
	speed: 0.0054s/iter; left time: 3.6450s
	iters: 400, epoch: 8 | loss: 0.6787592
	speed: 0.0050s/iter; left time: 2.8762s
	iters: 500, epoch: 8 | loss: 0.3873985
	speed: 0.0050s/iter; left time: 2.3777s
	iters: 600, epoch: 8 | loss: 0.4327507
	speed: 0.0049s/iter; left time: 1.8696s
	iters: 700, epoch: 8 | loss: 0.9562258
	speed: 0.0047s/iter; left time: 1.3273s
	iters: 800, epoch: 8 | loss: 0.6778560
	speed: 0.0049s/iter; left time: 0.8812s
	iters: 900, epoch: 8 | loss: 0.6925738
	speed: 0.0049s/iter; left time: 0.3948s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.9841532707214355
Epoch: 8, Steps: 979 | Train Loss: 0.5850913 Vali Loss: 0.5781117 Best vali loss: 0.5584413

best validation loss 0.5584413460811384

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0037634
	speed: 0.0089s/iter; left time: 16.6064s
	iters: 200, epoch: 1 | loss: 0.8231159
	speed: 0.0030s/iter; left time: 5.2656s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.6513).  Saving model state dict ...
Epoch: 1 cost time: 1.0612494945526123
Epoch: 1, Steps: 245 | Train Loss: 0.9134397 Vali Loss: 0.6512656 Best vali loss: 0.6512656
	iters: 100, epoch: 2 | loss: 1.1371554
	speed: 0.0067s/iter; left time: 10.7574s
	iters: 200, epoch: 2 | loss: 0.8199081
	speed: 0.0031s/iter; left time: 4.6524s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.6513 --> 0.6219).  Saving model state dict ...
Epoch: 2 cost time: 0.7858445644378662
Epoch: 2, Steps: 245 | Train Loss: 0.9785318 Vali Loss: 0.6219101 Best vali loss: 0.6219101
	iters: 100, epoch: 3 | loss: 1.0939517
	speed: 0.0067s/iter; left time: 9.1470s
	iters: 200, epoch: 3 | loss: 0.8753358
	speed: 0.0031s/iter; left time: 3.9843s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.6219 --> 0.6114).  Saving model state dict ...
Epoch: 3 cost time: 0.7835400104522705
Epoch: 3, Steps: 245 | Train Loss: 0.9846438 Vali Loss: 0.6114300 Best vali loss: 0.6114300

best validation loss 0.6114299931718155

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.6683).  Saving model state dict ...
Epoch: 1 cost time: 0.689401388168335
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6683088 Best vali loss: 0.6683088
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.6683 --> 0.6368).  Saving model state dict ...
Epoch: 2 cost time: 0.4363090991973877
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6367987 Best vali loss: 0.6367987
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.6368 --> 0.6260).  Saving model state dict ...
Epoch: 3 cost time: 0.45177745819091797
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6260435 Best vali loss: 0.6260435

best validation loss 0.6260434816910789

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9497964
	speed: 0.0120s/iter; left time: 10.6464s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.6614).  Saving model state dict ...
Epoch: 1 cost time: 1.0796458721160889
Epoch: 1, Steps: 123 | Train Loss: 0.9497964 Vali Loss: 0.6614366 Best vali loss: 0.6614366
	iters: 100, epoch: 2 | loss: 0.9964226
	speed: 0.0096s/iter; left time: 7.3064s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.6614 --> 0.6316).  Saving model state dict ...
Epoch: 2 cost time: 0.8013322353363037
Epoch: 2, Steps: 123 | Train Loss: 0.9964226 Vali Loss: 0.6315588 Best vali loss: 0.6315588
	iters: 100, epoch: 3 | loss: 1.0094527
	speed: 0.0095s/iter; left time: 6.0709s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.6316 --> 0.6242).  Saving model state dict ...
Epoch: 3 cost time: 0.7785553932189941
Epoch: 3, Steps: 123 | Train Loss: 1.0094527 Vali Loss: 0.6242187 Best vali loss: 0.6242187

best validation loss 0.6242186557303309

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9408702
	speed: 0.0090s/iter; left time: 10.1367s
	iters: 200, epoch: 4 | loss: 0.7542283
	speed: 0.0030s/iter; left time: 3.0954s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.6114 --> 0.6074).  Saving model state dict ...
Epoch: 4 cost time: 1.069906234741211
Epoch: 4, Steps: 245 | Train Loss: 0.8475493 Vali Loss: 0.6073936 Best vali loss: 0.6073936
	iters: 100, epoch: 5 | loss: 1.0869259
	speed: 0.0067s/iter; left time: 5.8739s
	iters: 200, epoch: 5 | loss: 0.8039693
	speed: 0.0030s/iter; left time: 2.3069s
Updating learning rate to 1.7856066821212585e-05
Validation loss decreased (0.6074 --> 0.6059).  Saving model state dict ...
Epoch: 5 cost time: 0.7708728313446045
Epoch: 5, Steps: 245 | Train Loss: 0.9454476 Vali Loss: 0.6058632 Best vali loss: 0.6058632
	iters: 100, epoch: 6 | loss: 1.0765002
	speed: 0.0067s/iter; left time: 4.2386s
	iters: 200, epoch: 6 | loss: 0.8540121
	speed: 0.0029s/iter; left time: 1.5373s
Updating learning rate to 8.472024178210777e-06
Validation loss decreased (0.6059 --> 0.6044).  Saving model state dict ...
Epoch: 6 cost time: 0.7601079940795898
Epoch: 6, Steps: 245 | Train Loss: 0.9652562 Vali Loss: 0.6044420 Best vali loss: 0.6044420
	iters: 100, epoch: 7 | loss: 0.8513699
	speed: 0.0067s/iter; left time: 2.6101s
	iters: 200, epoch: 7 | loss: 0.8731174
	speed: 0.0028s/iter; left time: 0.8142s
Updating learning rate to 2.2018073468332077e-06
Validation loss decreased (0.6044 --> 0.6038).  Saving model state dict ...
Epoch: 7 cost time: 0.741156816482544
Epoch: 7, Steps: 245 | Train Loss: 0.8622437 Vali Loss: 0.6038236 Best vali loss: 0.6038236
	iters: 100, epoch: 8 | loss: 0.8540491
	speed: 0.0065s/iter; left time: 0.9530s
	iters: 200, epoch: 8 | loss: 1.0508453
	speed: 0.0028s/iter; left time: 0.1301s
Updating learning rate to 0.0
Validation loss decreased (0.6038 --> 0.6038).  Saving model state dict ...
Epoch: 8 cost time: 0.7495758533477783
Epoch: 8, Steps: 245 | Train Loss: 0.9524472 Vali Loss: 0.6037619 Best vali loss: 0.6037619

best validation loss 0.6037619087719245

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8357700
	speed: 0.0120s/iter; left time: 10.6477s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.6215).  Saving model state dict ...
Epoch: 1 cost time: 1.096703052520752
Epoch: 1, Steps: 123 | Train Loss: 0.8357700 Vali Loss: 0.6215077 Best vali loss: 0.6215077
	iters: 100, epoch: 2 | loss: 1.0895234
	speed: 0.0097s/iter; left time: 7.3536s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.6215 --> 0.6156).  Saving model state dict ...
Epoch: 2 cost time: 0.8110852241516113
Epoch: 2, Steps: 123 | Train Loss: 1.0895234 Vali Loss: 0.6156296 Best vali loss: 0.6156296
	iters: 100, epoch: 3 | loss: 0.9160407
	speed: 0.0096s/iter; left time: 6.1535s
Updating learning rate to 0.000956145404075
Validation loss decreased (0.6156 --> 0.6079).  Saving model state dict ...
Epoch: 3 cost time: 0.798018217086792
Epoch: 3, Steps: 123 | Train Loss: 0.9160407 Vali Loss: 0.6079129 Best vali loss: 0.6079129
	iters: 100, epoch: 4 | loss: 0.9680784
	speed: 0.0096s/iter; left time: 4.9322s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 0.7873899936676025
Epoch: 4, Steps: 123 | Train Loss: 0.9680784 Vali Loss: 0.6184219 Best vali loss: 0.6079129
	iters: 100, epoch: 5 | loss: 0.6717370
	speed: 0.0094s/iter; left time: 3.6760s
Updating learning rate to 0.00023903635101875
Epoch: 5 cost time: 0.7935004234313965
Epoch: 5, Steps: 123 | Train Loss: 0.6717370 Vali Loss: 0.6292739 Best vali loss: 0.6079129
	iters: 100, epoch: 6 | loss: 0.6698985
	speed: 0.0099s/iter; left time: 2.6725s
Updating learning rate to 0.000119518175509375
Epoch: 6 cost time: 0.8279874324798584
Epoch: 6, Steps: 123 | Train Loss: 0.6698985 Vali Loss: 0.6387959 Best vali loss: 0.6079129
	iters: 100, epoch: 7 | loss: 0.7518154
	speed: 0.0095s/iter; left time: 1.3942s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 0.741523265838623
Epoch: 7, Steps: 123 | Train Loss: 0.7518154 Vali Loss: 0.6523724 Best vali loss: 0.6079129
	iters: 100, epoch: 8 | loss: 0.8292481
	speed: 0.0099s/iter; left time: 0.2364s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 0.8271286487579346
Epoch: 8, Steps: 123 | Train Loss: 0.8292481 Vali Loss: 0.6517182 Best vali loss: 0.6079129

best validation loss 0.6079129449805967

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6155293
	speed: 0.0102s/iter; left time: 39.0186s
	iters: 200, epoch: 1 | loss: 1.0215986
	speed: 0.0044s/iter; left time: 16.5025s
	iters: 300, epoch: 1 | loss: 1.2023854
	speed: 0.0046s/iter; left time: 16.5563s
	iters: 400, epoch: 1 | loss: 1.2934557
	speed: 0.0046s/iter; left time: 16.1110s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.6429).  Saving model state dict ...
Epoch: 1 cost time: 2.556666374206543
Epoch: 1, Steps: 490 | Train Loss: 1.0332423 Vali Loss: 0.6429420 Best vali loss: 0.6429420
	iters: 100, epoch: 2 | loss: 1.1258864
	speed: 0.0127s/iter; left time: 42.3999s
	iters: 200, epoch: 2 | loss: 0.6351326
	speed: 0.0047s/iter; left time: 15.0604s
	iters: 300, epoch: 2 | loss: 0.9982633
	speed: 0.0045s/iter; left time: 14.0509s
	iters: 400, epoch: 2 | loss: 0.6124632
	speed: 0.0045s/iter; left time: 13.6357s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 2.278787612915039
Epoch: 2, Steps: 490 | Train Loss: 0.8429364 Vali Loss: 0.6516967 Best vali loss: 0.6429420
	iters: 100, epoch: 3 | loss: 0.8821185
	speed: 0.0116s/iter; left time: 32.9148s
	iters: 200, epoch: 3 | loss: 1.1098062
	speed: 0.0042s/iter; left time: 11.3882s
	iters: 300, epoch: 3 | loss: 1.3558046
	speed: 0.0041s/iter; left time: 10.8785s
	iters: 400, epoch: 3 | loss: 0.4648288
	speed: 0.0042s/iter; left time: 10.6392s
Updating learning rate to 0.000821473589325
Epoch: 3 cost time: 2.070103168487549
Epoch: 3, Steps: 490 | Train Loss: 0.9531395 Vali Loss: 0.6486213 Best vali loss: 0.6429420
	iters: 100, epoch: 4 | loss: 0.5903202
	speed: 0.0115s/iter; left time: 27.0590s
	iters: 200, epoch: 4 | loss: 1.6451471
	speed: 0.0041s/iter; left time: 9.1389s
	iters: 300, epoch: 4 | loss: 1.6488529
	speed: 0.0040s/iter; left time: 8.6923s
	iters: 400, epoch: 4 | loss: 0.4599191
	speed: 0.0040s/iter; left time: 8.2528s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 2.062023878097534
Epoch: 4, Steps: 490 | Train Loss: 1.0860598 Vali Loss: 0.6470261 Best vali loss: 0.6429420
	iters: 100, epoch: 5 | loss: 0.4412525
	speed: 0.0118s/iter; left time: 21.8913s
	iters: 200, epoch: 5 | loss: 0.6693639
	speed: 0.0046s/iter; left time: 8.0187s
	iters: 300, epoch: 5 | loss: 0.7009842
	speed: 0.0046s/iter; left time: 7.6123s
	iters: 400, epoch: 5 | loss: 0.8546910
	speed: 0.0044s/iter; left time: 6.8718s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 2.2614901065826416
Epoch: 5, Steps: 490 | Train Loss: 0.6665729 Vali Loss: 0.6440470 Best vali loss: 0.6429420
	iters: 100, epoch: 6 | loss: 0.9238557
	speed: 0.0122s/iter; left time: 16.6903s
	iters: 200, epoch: 6 | loss: 1.1774719
	speed: 0.0045s/iter; left time: 5.6702s
	iters: 300, epoch: 6 | loss: 1.0715787
	speed: 0.0044s/iter; left time: 5.1949s
	iters: 400, epoch: 6 | loss: 1.2368819
	speed: 0.0045s/iter; left time: 4.7853s
Updating learning rate to 0.000102684198665625
Epoch: 6 cost time: 2.2444751262664795
Epoch: 6, Steps: 490 | Train Loss: 1.1024470 Vali Loss: 0.6443405 Best vali loss: 0.6429420
	iters: 100, epoch: 7 | loss: 1.3717992
	speed: 0.0119s/iter; left time: 10.5150s
	iters: 200, epoch: 7 | loss: 0.7113996
	speed: 0.0044s/iter; left time: 3.4318s
	iters: 300, epoch: 7 | loss: 1.0504811
	speed: 0.0044s/iter; left time: 3.0083s
	iters: 400, epoch: 7 | loss: 0.3865946
	speed: 0.0044s/iter; left time: 2.5311s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 2.1968846321105957
Epoch: 7, Steps: 490 | Train Loss: 0.8800686 Vali Loss: 0.6437403 Best vali loss: 0.6429420
	iters: 100, epoch: 8 | loss: 1.1154791
	speed: 0.0119s/iter; left time: 4.6627s
	iters: 200, epoch: 8 | loss: 0.4639243
	speed: 0.0045s/iter; left time: 1.2983s
	iters: 300, epoch: 8 | loss: 1.3972625
	speed: 0.0046s/iter; left time: 0.8709s
	iters: 400, epoch: 8 | loss: 0.6109996
	speed: 0.0045s/iter; left time: 0.4120s
Updating learning rate to 2.567104966640625e-05
Epoch: 8 cost time: 2.256300926208496
Epoch: 8, Steps: 490 | Train Loss: 0.8969164 Vali Loss: 0.6437566 Best vali loss: 0.6429420

best validation loss 0.6429420081844268

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.6220).  Saving model state dict ...
Epoch: 1 cost time: 0.7440075874328613
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6219932 Best vali loss: 0.6219932
Updating learning rate to 0.0025938006666821026
Validation loss decreased (0.6220 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 0.45615649223327637
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6044004 Best vali loss: 0.6044004
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.44299936294555664
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6245452 Best vali loss: 0.6044004

best validation loss 0.6044003769017545

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.6547).  Saving model state dict ...
Epoch: 1 cost time: 0.7430398464202881
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6547121 Best vali loss: 0.6547121
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.6547 --> 0.6256).  Saving model state dict ...
Epoch: 2 cost time: 0.43826842308044434
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6255850 Best vali loss: 0.6255850
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.6256 --> 0.6174).  Saving model state dict ...
Epoch: 3 cost time: 0.43983006477355957
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6174312 Best vali loss: 0.6174312

best validation loss 0.6174311707660811

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6373712
	speed: 0.0104s/iter; left time: 80.0458s
	iters: 200, epoch: 1 | loss: 0.4130161
	speed: 0.0044s/iter; left time: 33.7981s
	iters: 300, epoch: 1 | loss: 0.5004481
	speed: 0.0045s/iter; left time: 33.5444s
	iters: 400, epoch: 1 | loss: 0.7782217
	speed: 0.0044s/iter; left time: 32.9133s
	iters: 500, epoch: 1 | loss: 0.4061608
	speed: 0.0044s/iter; left time: 32.5950s
	iters: 600, epoch: 1 | loss: 0.4427283
	speed: 0.0044s/iter; left time: 31.9252s
	iters: 700, epoch: 1 | loss: 0.7275916
	speed: 0.0043s/iter; left time: 30.8792s
	iters: 800, epoch: 1 | loss: 1.2920719
	speed: 0.0044s/iter; left time: 30.9678s
	iters: 900, epoch: 1 | loss: 0.5835672
	speed: 0.0043s/iter; left time: 29.8414s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.6514).  Saving model state dict ...
Epoch: 1 cost time: 4.632052659988403
Epoch: 1, Steps: 979 | Train Loss: 0.6423530 Vali Loss: 0.6513962 Best vali loss: 0.6513962
	iters: 100, epoch: 2 | loss: 1.9094083
	speed: 0.0135s/iter; left time: 90.9953s
	iters: 200, epoch: 2 | loss: 1.4287565
	speed: 0.0043s/iter; left time: 28.4347s
	iters: 300, epoch: 2 | loss: 1.9397777
	speed: 0.0043s/iter; left time: 28.4125s
	iters: 400, epoch: 2 | loss: 0.2411164
	speed: 0.0044s/iter; left time: 28.2307s
	iters: 500, epoch: 2 | loss: 1.7432973
	speed: 0.0042s/iter; left time: 26.9622s
	iters: 600, epoch: 2 | loss: 1.1119339
	speed: 0.0043s/iter; left time: 26.8628s
	iters: 700, epoch: 2 | loss: 1.0743432
	speed: 0.0042s/iter; left time: 26.0159s
	iters: 800, epoch: 2 | loss: 0.5703191
	speed: 0.0042s/iter; left time: 25.3322s
	iters: 900, epoch: 2 | loss: 1.4315767
	speed: 0.0040s/iter; left time: 24.0355s
Updating learning rate to 0.0013641652329598032
Validation loss decreased (0.6514 --> 0.6476).  Saving model state dict ...
Epoch: 2 cost time: 4.168965816497803
Epoch: 2, Steps: 979 | Train Loss: 1.2722810 Vali Loss: 0.6476287 Best vali loss: 0.6476287
	iters: 100, epoch: 3 | loss: 0.6666306
	speed: 0.0133s/iter; left time: 76.8751s
	iters: 200, epoch: 3 | loss: 1.6211934
	speed: 0.0040s/iter; left time: 22.5755s
	iters: 300, epoch: 3 | loss: 0.4450488
	speed: 0.0038s/iter; left time: 21.1859s
	iters: 400, epoch: 3 | loss: 0.6974230
	speed: 0.0040s/iter; left time: 21.6487s
	iters: 500, epoch: 3 | loss: 1.2698518
	speed: 0.0038s/iter; left time: 20.5408s
	iters: 600, epoch: 3 | loss: 0.2961606
	speed: 0.0040s/iter; left time: 21.2016s
	iters: 700, epoch: 3 | loss: 0.7767845
	speed: 0.0040s/iter; left time: 20.7443s
	iters: 800, epoch: 3 | loss: 2.4997973
	speed: 0.0040s/iter; left time: 20.0511s
	iters: 900, epoch: 3 | loss: 0.9908343
	speed: 0.0041s/iter; left time: 20.2468s
Updating learning rate to 0.0011049154554414859
Epoch: 3 cost time: 3.9408833980560303
Epoch: 3, Steps: 979 | Train Loss: 1.0293027 Vali Loss: 0.6478522 Best vali loss: 0.6476287

best validation loss 0.647628743054965

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 0.7564435005187988
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6225106 Best vali loss: 0.6044004
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 0.45508527755737305
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6303778 Best vali loss: 0.6044004
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 0.4554266929626465
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6453573 Best vali loss: 0.6044004
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 0.46071910858154297
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6451424 Best vali loss: 0.6044004
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4725627899169922
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6460907 Best vali loss: 0.6044004

best validation loss 0.6044003769017545

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5331389
	speed: 0.0082s/iter; left time: 63.5535s
	iters: 200, epoch: 1 | loss: 0.2211926
	speed: 0.0023s/iter; left time: 17.2874s
	iters: 300, epoch: 1 | loss: 1.1474055
	speed: 0.0023s/iter; left time: 17.6226s
	iters: 400, epoch: 1 | loss: 0.9626920
	speed: 0.0022s/iter; left time: 16.4168s
	iters: 500, epoch: 1 | loss: 0.3885189
	speed: 0.0022s/iter; left time: 16.0972s
	iters: 600, epoch: 1 | loss: 0.8265908
	speed: 0.0022s/iter; left time: 15.9687s
	iters: 700, epoch: 1 | loss: 0.7065563
	speed: 0.0022s/iter; left time: 15.7090s
	iters: 800, epoch: 1 | loss: 1.3169612
	speed: 0.0023s/iter; left time: 16.0222s
	iters: 900, epoch: 1 | loss: 0.8081266
	speed: 0.0023s/iter; left time: 15.7802s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.5996).  Saving model state dict ...
Epoch: 1 cost time: 2.551725387573242
Epoch: 1, Steps: 979 | Train Loss: 0.8790203 Vali Loss: 0.5996236 Best vali loss: 0.5996236
	iters: 100, epoch: 2 | loss: 0.2720300
	speed: 0.0090s/iter; left time: 61.0327s
	iters: 200, epoch: 2 | loss: 2.3371568
	speed: 0.0026s/iter; left time: 17.3038s
	iters: 300, epoch: 2 | loss: 0.9995251
	speed: 0.0025s/iter; left time: 16.5266s
	iters: 400, epoch: 2 | loss: 0.8440530
	speed: 0.0026s/iter; left time: 16.7710s
	iters: 500, epoch: 2 | loss: 0.5499016
	speed: 0.0026s/iter; left time: 16.6578s
	iters: 600, epoch: 2 | loss: 1.2634333
	speed: 0.0027s/iter; left time: 16.6583s
	iters: 700, epoch: 2 | loss: 0.8341156
	speed: 0.0027s/iter; left time: 16.8963s
	iters: 800, epoch: 2 | loss: 0.3389435
	speed: 0.0026s/iter; left time: 15.9781s
	iters: 900, epoch: 2 | loss: 0.9368269
	speed: 0.0026s/iter; left time: 15.7174s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 2.608294725418091
Epoch: 2, Steps: 979 | Train Loss: 0.9306651 Vali Loss: 0.6185614 Best vali loss: 0.5996236
	iters: 100, epoch: 3 | loss: 0.6626145
	speed: 0.0088s/iter; left time: 50.8589s
	iters: 200, epoch: 3 | loss: 0.6011151
	speed: 0.0023s/iter; left time: 13.1148s
	iters: 300, epoch: 3 | loss: 0.4902907
	speed: 0.0024s/iter; left time: 13.2122s
	iters: 400, epoch: 3 | loss: 1.4172765
	speed: 0.0024s/iter; left time: 13.0212s
	iters: 500, epoch: 3 | loss: 1.3675388
	speed: 0.0023s/iter; left time: 12.1759s
	iters: 600, epoch: 3 | loss: 1.1288098
	speed: 0.0023s/iter; left time: 11.9815s
	iters: 700, epoch: 3 | loss: 0.8045313
	speed: 0.0023s/iter; left time: 11.8832s
	iters: 800, epoch: 3 | loss: 0.5418088
	speed: 0.0022s/iter; left time: 11.2588s
	iters: 900, epoch: 3 | loss: 1.0070282
	speed: 0.0025s/iter; left time: 12.3159s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 2.3291451930999756
Epoch: 3, Steps: 979 | Train Loss: 0.8912238 Vali Loss: 0.6407418 Best vali loss: 0.5996236
	iters: 100, epoch: 4 | loss: 0.9948934
	speed: 0.0089s/iter; left time: 42.8738s
	iters: 200, epoch: 4 | loss: 0.9443582
	speed: 0.0024s/iter; left time: 11.3758s
	iters: 300, epoch: 4 | loss: 0.6199676
	speed: 0.0025s/iter; left time: 11.4795s
	iters: 400, epoch: 4 | loss: 0.2617428
	speed: 0.0025s/iter; left time: 11.2786s
	iters: 500, epoch: 4 | loss: 1.1193501
	speed: 0.0026s/iter; left time: 11.2516s
	iters: 600, epoch: 4 | loss: 0.2721828
	speed: 0.0025s/iter; left time: 10.6745s
	iters: 700, epoch: 4 | loss: 0.9727780
	speed: 0.0025s/iter; left time: 10.6271s
	iters: 800, epoch: 4 | loss: 0.6139354
	speed: 0.0025s/iter; left time: 10.3039s
	iters: 900, epoch: 4 | loss: 0.6764691
	speed: 0.0025s/iter; left time: 9.8051s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 2.483743190765381
Epoch: 4, Steps: 979 | Train Loss: 0.7195197 Vali Loss: 0.6690971 Best vali loss: 0.5996236
	iters: 100, epoch: 5 | loss: 0.6209447
	speed: 0.0088s/iter; left time: 33.4959s
	iters: 200, epoch: 5 | loss: 0.3530464
	speed: 0.0026s/iter; left time: 9.7207s
	iters: 300, epoch: 5 | loss: 0.3865631
	speed: 0.0026s/iter; left time: 9.2476s
	iters: 400, epoch: 5 | loss: 0.3267079
	speed: 0.0025s/iter; left time: 8.8509s
	iters: 500, epoch: 5 | loss: 0.4755707
	speed: 0.0025s/iter; left time: 8.5171s
	iters: 600, epoch: 5 | loss: 1.0446516
	speed: 0.0026s/iter; left time: 8.5071s
	iters: 700, epoch: 5 | loss: 0.8477780
	speed: 0.0025s/iter; left time: 8.1989s
	iters: 800, epoch: 5 | loss: 0.6223668
	speed: 0.0025s/iter; left time: 7.9306s
	iters: 900, epoch: 5 | loss: 0.5444632
	speed: 0.0025s/iter; left time: 7.3990s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 2.5220940113067627
Epoch: 5, Steps: 979 | Train Loss: 0.5802325 Vali Loss: 0.6478510 Best vali loss: 0.5996236
	iters: 100, epoch: 6 | loss: 0.4686192
	speed: 0.0087s/iter; left time: 24.8124s
	iters: 200, epoch: 6 | loss: 0.8120765
	speed: 0.0022s/iter; left time: 6.0446s
	iters: 300, epoch: 6 | loss: 0.6914338
	speed: 0.0023s/iter; left time: 6.0044s
	iters: 400, epoch: 6 | loss: 0.8692842
	speed: 0.0022s/iter; left time: 5.6066s
	iters: 500, epoch: 6 | loss: 0.5087116
	speed: 0.0022s/iter; left time: 5.3577s
	iters: 600, epoch: 6 | loss: 0.6977777
	speed: 0.0022s/iter; left time: 5.1800s
	iters: 700, epoch: 6 | loss: 0.5929801
	speed: 0.0022s/iter; left time: 4.8909s
	iters: 800, epoch: 6 | loss: 0.8112724
	speed: 0.0023s/iter; left time: 4.9644s
	iters: 900, epoch: 6 | loss: 0.4724400
	speed: 0.0023s/iter; left time: 4.7111s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 2.255801200866699
Epoch: 6, Steps: 979 | Train Loss: 0.6582884 Vali Loss: 0.6504070 Best vali loss: 0.5996236
	iters: 100, epoch: 7 | loss: 1.2495917
	speed: 0.0090s/iter; left time: 16.6618s
	iters: 200, epoch: 7 | loss: 1.0932893
	speed: 0.0026s/iter; left time: 4.5605s
	iters: 300, epoch: 7 | loss: 0.9940850
	speed: 0.0026s/iter; left time: 4.2443s
	iters: 400, epoch: 7 | loss: 0.4732685
	speed: 0.0025s/iter; left time: 3.9016s
	iters: 500, epoch: 7 | loss: 1.1148750
	speed: 0.0024s/iter; left time: 3.5493s
	iters: 600, epoch: 7 | loss: 0.4225768
	speed: 0.0024s/iter; left time: 3.2531s
	iters: 700, epoch: 7 | loss: 1.1005131
	speed: 0.0024s/iter; left time: 3.0700s
	iters: 800, epoch: 7 | loss: 0.9262400
	speed: 0.0024s/iter; left time: 2.7605s
	iters: 900, epoch: 7 | loss: 0.4593694
	speed: 0.0024s/iter; left time: 2.5761s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 2.4639556407928467
Epoch: 7, Steps: 979 | Train Loss: 0.8704232 Vali Loss: 0.6561743 Best vali loss: 0.5996236
	iters: 100, epoch: 8 | loss: 0.2553410
	speed: 0.0089s/iter; left time: 7.7892s
	iters: 200, epoch: 8 | loss: 1.2535341
	speed: 0.0025s/iter; left time: 1.9502s
	iters: 300, epoch: 8 | loss: 0.6262520
	speed: 0.0025s/iter; left time: 1.6881s
	iters: 400, epoch: 8 | loss: 0.5717208
	speed: 0.0024s/iter; left time: 1.4142s
	iters: 500, epoch: 8 | loss: 0.9710172
	speed: 0.0025s/iter; left time: 1.1800s
	iters: 600, epoch: 8 | loss: 0.9785136
	speed: 0.0025s/iter; left time: 0.9601s
	iters: 700, epoch: 8 | loss: 0.4878305
	speed: 0.0025s/iter; left time: 0.6904s
	iters: 800, epoch: 8 | loss: 0.6224914
	speed: 0.0025s/iter; left time: 0.4520s
	iters: 900, epoch: 8 | loss: 0.5322659
	speed: 0.0025s/iter; left time: 0.1997s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 2.46486234664917
Epoch: 8, Steps: 979 | Train Loss: 0.6998852 Vali Loss: 0.6571684 Best vali loss: 0.5996236

best validation loss 0.5996236012027198

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9576374
	speed: 0.0108s/iter; left time: 20.0140s
	iters: 200, epoch: 1 | loss: 0.8051615
	speed: 0.0049s/iter; left time: 8.6488s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.6303).  Saving model state dict ...
Epoch: 1 cost time: 1.5351653099060059
Epoch: 1, Steps: 245 | Train Loss: 0.8813995 Vali Loss: 0.6303369 Best vali loss: 0.6303369
	iters: 100, epoch: 2 | loss: 1.0535364
	speed: 0.0089s/iter; left time: 14.3324s
	iters: 200, epoch: 2 | loss: 0.5950061
	speed: 0.0044s/iter; left time: 6.6263s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.6303 --> 0.6072).  Saving model state dict ...
Epoch: 2 cost time: 1.1108756065368652
Epoch: 2, Steps: 245 | Train Loss: 0.8242713 Vali Loss: 0.6071559 Best vali loss: 0.6071559
	iters: 100, epoch: 3 | loss: 0.8402239
	speed: 0.0089s/iter; left time: 12.2636s
	iters: 200, epoch: 3 | loss: 0.8077331
	speed: 0.0044s/iter; left time: 5.5817s
Updating learning rate to 3.8746933325e-05
Epoch: 3 cost time: 1.1146936416625977
Epoch: 3, Steps: 245 | Train Loss: 0.8239785 Vali Loss: 0.6103819 Best vali loss: 0.6071559
	iters: 100, epoch: 4 | loss: 0.8815715
	speed: 0.0087s/iter; left time: 9.8198s
	iters: 200, epoch: 4 | loss: 0.5975599
	speed: 0.0042s/iter; left time: 4.2923s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.6072 --> 0.6068).  Saving model state dict ...
Epoch: 4 cost time: 1.0799200534820557
Epoch: 4, Steps: 245 | Train Loss: 0.7395657 Vali Loss: 0.6067570 Best vali loss: 0.6067570
	iters: 100, epoch: 5 | loss: 1.2628063
	speed: 0.0096s/iter; left time: 8.4341s
	iters: 200, epoch: 5 | loss: 0.7336659
	speed: 0.0044s/iter; left time: 3.4073s
Updating learning rate to 9.68673333125e-06
Validation loss decreased (0.6068 --> 0.6064).  Saving model state dict ...
Epoch: 5 cost time: 1.1700282096862793
Epoch: 5, Steps: 245 | Train Loss: 0.9982361 Vali Loss: 0.6064300 Best vali loss: 0.6064300
	iters: 100, epoch: 6 | loss: 0.7033538
	speed: 0.0089s/iter; left time: 5.6917s
	iters: 200, epoch: 6 | loss: 0.7256936
	speed: 0.0043s/iter; left time: 2.3216s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 1.125443935394287
Epoch: 6, Steps: 245 | Train Loss: 0.7145237 Vali Loss: 0.6065016 Best vali loss: 0.6064300
	iters: 100, epoch: 7 | loss: 0.8392672
	speed: 0.0089s/iter; left time: 3.4628s
	iters: 200, epoch: 7 | loss: 0.8167204
	speed: 0.0044s/iter; left time: 1.2701s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 1.1269848346710205
Epoch: 7, Steps: 245 | Train Loss: 0.8279938 Vali Loss: 0.6064515 Best vali loss: 0.6064300
	iters: 100, epoch: 8 | loss: 0.4770941
	speed: 0.0094s/iter; left time: 1.3785s
	iters: 200, epoch: 8 | loss: 0.7186532
	speed: 0.0048s/iter; left time: 0.2193s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 1.2155964374542236
Epoch: 8, Steps: 245 | Train Loss: 0.5978737 Vali Loss: 0.6064338 Best vali loss: 0.6064300

best validation loss 0.6064300043529959

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7980891
	speed: 0.0106s/iter; left time: 9.3624s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 0.9080343246459961
Epoch: 1, Steps: 123 | Train Loss: 0.7980891 Vali Loss: 0.6111710 Best vali loss: 0.6111710
	iters: 100, epoch: 2 | loss: 0.6816033
	speed: 0.0075s/iter; left time: 5.7223s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 0.5937845706939697
Epoch: 2, Steps: 123 | Train Loss: 0.6816033 Vali Loss: 0.6613818 Best vali loss: 0.6111710
	iters: 100, epoch: 3 | loss: 0.8049802
	speed: 0.0075s/iter; left time: 4.7921s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 0.5989937782287598
Epoch: 3, Steps: 123 | Train Loss: 0.8049802 Vali Loss: 0.6524794 Best vali loss: 0.6111710

best validation loss 0.6111710422406423

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.6280).  Saving model state dict ...
Epoch: 1 cost time: 0.8177170753479004
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6279658 Best vali loss: 0.6279658
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.6280 --> 0.6041).  Saving model state dict ...
Epoch: 2 cost time: 0.5257737636566162
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6040902 Best vali loss: 0.6040902
Updating learning rate to 0.0013279966230694852
Validation loss decreased (0.6041 --> 0.5743).  Saving model state dict ...
Epoch: 3 cost time: 0.4826512336730957
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5743345 Best vali loss: 0.5743345

best validation loss 0.5743344542275198

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9254093
	speed: 0.0090s/iter; left time: 16.7197s
	iters: 200, epoch: 1 | loss: 1.1073973
	speed: 0.0031s/iter; left time: 5.4160s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0777201652526855
Epoch: 1, Steps: 245 | Train Loss: 1.0164033 Vali Loss: 0.6171626 Best vali loss: 0.6171626
	iters: 100, epoch: 2 | loss: 0.9790778
	speed: 0.0065s/iter; left time: 10.4856s
	iters: 200, epoch: 2 | loss: 0.7935567
	speed: 0.0026s/iter; left time: 3.9731s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.6172 --> 0.5979).  Saving model state dict ...
Epoch: 2 cost time: 0.7067229747772217
Epoch: 2, Steps: 245 | Train Loss: 0.8863173 Vali Loss: 0.5978794 Best vali loss: 0.5978794
	iters: 100, epoch: 3 | loss: 0.6041198
	speed: 0.0065s/iter; left time: 8.9109s
	iters: 200, epoch: 3 | loss: 0.7181655
	speed: 0.0029s/iter; left time: 3.7461s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 0.7794544696807861
Epoch: 3, Steps: 245 | Train Loss: 0.6611426 Vali Loss: 0.6140603 Best vali loss: 0.5978794

best validation loss 0.5978794068663499

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0009604487853
Validation loss decreased (0.5743 --> 0.5738).  Saving model state dict ...
Epoch: 4 cost time: 0.8070085048675537
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5737637 Best vali loss: 0.5737637
Updating learning rate to 0.0005929009475305148
Epoch: 5 cost time: 0.4817335605621338
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5762735 Best vali loss: 0.5737637
Updating learning rate to 0.0002813089362319876
Validation loss decreased (0.5738 --> 0.5669).  Saving model state dict ...
Epoch: 6 cost time: 0.4761970043182373
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5668823 Best vali loss: 0.5668823
Updating learning rate to 7.31098105360028e-05
Validation loss decreased (0.5669 --> 0.5560).  Saving model state dict ...
Epoch: 7 cost time: 0.4633967876434326
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5559946 Best vali loss: 0.5559946
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5109941959381104
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5571175 Best vali loss: 0.5559946

best validation loss 0.5559946273223828

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.6813).  Saving model state dict ...
Epoch: 1 cost time: 0.6980717182159424
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6812706 Best vali loss: 0.6812706
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.6813 --> 0.6541).  Saving model state dict ...
Epoch: 2 cost time: 0.41650390625
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6540830 Best vali loss: 0.6540830
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.6541 --> 0.6367).  Saving model state dict ...
Epoch: 3 cost time: 0.41290926933288574
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6366734 Best vali loss: 0.6366734
Updating learning rate to 0.00012607677965
Validation loss decreased (0.6367 --> 0.6262).  Saving model state dict ...
Epoch: 4 cost time: 0.4358811378479004
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6261700 Best vali loss: 0.6261700
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.6262 --> 0.6213).  Saving model state dict ...
Epoch: 5 cost time: 0.4037630558013916
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6212587 Best vali loss: 0.6212587
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.6213 --> 0.6186).  Saving model state dict ...
Epoch: 6 cost time: 0.4277944564819336
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6186482 Best vali loss: 0.6186482
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.6186 --> 0.6172).  Saving model state dict ...
Epoch: 7 cost time: 0.4521348476409912
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6171625 Best vali loss: 0.6171625
Updating learning rate to 0.0
Validation loss decreased (0.6172 --> 0.6170).  Saving model state dict ...
Epoch: 8 cost time: 0.44271278381347656
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6169781 Best vali loss: 0.6169781

best validation loss 0.6169780835074884

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0061377
	speed: 0.0115s/iter; left time: 10.2116s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 1.0367162227630615
Epoch: 1, Steps: 123 | Train Loss: 1.0061377 Vali Loss: 0.6026967 Best vali loss: 0.6026967
	iters: 100, epoch: 2 | loss: 0.7721919
	speed: 0.0085s/iter; left time: 6.5032s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 0.662468671798706
Epoch: 2, Steps: 123 | Train Loss: 0.7721919 Vali Loss: 0.6427876 Best vali loss: 0.6026967
	iters: 100, epoch: 3 | loss: 0.6380255
	speed: 0.0081s/iter; left time: 5.1720s
Updating learning rate to 0.000162871860575
Validation loss decreased (0.6027 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 0.6509804725646973
Epoch: 3, Steps: 123 | Train Loss: 0.6380255 Vali Loss: 0.5566061 Best vali loss: 0.5566061
	iters: 100, epoch: 4 | loss: 0.8467974
	speed: 0.0090s/iter; left time: 4.6641s
Updating learning rate to 8.14359302875e-05
Validation loss decreased (0.5566 --> 0.5496).  Saving model state dict ...
Epoch: 4 cost time: 0.7431337833404541
Epoch: 4, Steps: 123 | Train Loss: 0.8467974 Vali Loss: 0.5495641 Best vali loss: 0.5495641
	iters: 100, epoch: 5 | loss: 0.7397822
	speed: 0.0086s/iter; left time: 3.3794s
Updating learning rate to 4.071796514375e-05
Validation loss decreased (0.5496 --> 0.5446).  Saving model state dict ...
Epoch: 5 cost time: 0.6816987991333008
Epoch: 5, Steps: 123 | Train Loss: 0.7397822 Vali Loss: 0.5446328 Best vali loss: 0.5446328
	iters: 100, epoch: 6 | loss: 0.5131750
	speed: 0.0084s/iter; left time: 2.2662s
Updating learning rate to 2.0358982571875e-05
Validation loss decreased (0.5446 --> 0.5422).  Saving model state dict ...
Epoch: 6 cost time: 0.6662094593048096
Epoch: 6, Steps: 123 | Train Loss: 0.5131750 Vali Loss: 0.5422452 Best vali loss: 0.5422452
	iters: 100, epoch: 7 | loss: 0.9092557
	speed: 0.0088s/iter; left time: 1.2947s
Updating learning rate to 1.01794912859375e-05
Validation loss decreased (0.5422 --> 0.5420).  Saving model state dict ...
Epoch: 7 cost time: 0.7328264713287354
Epoch: 7, Steps: 123 | Train Loss: 0.9092557 Vali Loss: 0.5419669 Best vali loss: 0.5419669
	iters: 100, epoch: 8 | loss: 0.8723897
	speed: 0.0091s/iter; left time: 0.2178s
Updating learning rate to 5.08974564296875e-06
Validation loss decreased (0.5420 --> 0.5414).  Saving model state dict ...
Epoch: 8 cost time: 0.7301697731018066
Epoch: 8, Steps: 123 | Train Loss: 0.8723897 Vali Loss: 0.5414124 Best vali loss: 0.5414124

best validation loss 0.5414123852073126

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8163943
	speed: 0.0093s/iter; left time: 8.2414s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.6198).  Saving model state dict ...
Epoch: 1 cost time: 0.757296085357666
Epoch: 1, Steps: 123 | Train Loss: 0.8163943 Vali Loss: 0.6197633 Best vali loss: 0.6197633
	iters: 100, epoch: 2 | loss: 0.6871451
	speed: 0.0065s/iter; left time: 4.9236s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.6198 --> 0.6053).  Saving model state dict ...
Epoch: 2 cost time: 0.49767398834228516
Epoch: 2, Steps: 123 | Train Loss: 0.6871451 Vali Loss: 0.6053376 Best vali loss: 0.6053376
	iters: 100, epoch: 3 | loss: 0.8797929
	speed: 0.0067s/iter; left time: 4.2740s
Updating learning rate to 0.00046564185792360155
Validation loss decreased (0.6053 --> 0.6002).  Saving model state dict ...
Epoch: 3 cost time: 0.5167303085327148
Epoch: 3, Steps: 123 | Train Loss: 0.8797929 Vali Loss: 0.6002454 Best vali loss: 0.6002454

best validation loss 0.6002453846657845

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5704647
	speed: 0.0094s/iter; left time: 72.6755s
	iters: 200, epoch: 1 | loss: 0.5382348
	speed: 0.0033s/iter; left time: 25.5543s
	iters: 300, epoch: 1 | loss: 0.4674197
	speed: 0.0033s/iter; left time: 25.1440s
	iters: 400, epoch: 1 | loss: 0.3604046
	speed: 0.0035s/iter; left time: 25.7834s
	iters: 500, epoch: 1 | loss: 0.4510529
	speed: 0.0035s/iter; left time: 25.9036s
	iters: 600, epoch: 1 | loss: 0.3289902
	speed: 0.0036s/iter; left time: 25.7631s
	iters: 700, epoch: 1 | loss: 0.9856008
	speed: 0.0036s/iter; left time: 25.3946s
	iters: 800, epoch: 1 | loss: 0.8639445
	speed: 0.0034s/iter; left time: 23.9238s
	iters: 900, epoch: 1 | loss: 0.8617792
	speed: 0.0035s/iter; left time: 24.4015s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.6327).  Saving model state dict ...
Epoch: 1 cost time: 3.7441303730010986
Epoch: 1, Steps: 979 | Train Loss: 0.6030991 Vali Loss: 0.6326870 Best vali loss: 0.6326870
	iters: 100, epoch: 2 | loss: 0.5188016
	speed: 0.0115s/iter; left time: 77.8421s
	iters: 200, epoch: 2 | loss: 0.6576025
	speed: 0.0036s/iter; left time: 23.9441s
	iters: 300, epoch: 2 | loss: 0.9634458
	speed: 0.0035s/iter; left time: 23.1692s
	iters: 400, epoch: 2 | loss: 0.8716251
	speed: 0.0035s/iter; left time: 22.6002s
	iters: 500, epoch: 2 | loss: 1.2497258
	speed: 0.0035s/iter; left time: 22.3827s
	iters: 600, epoch: 2 | loss: 0.5465289
	speed: 0.0035s/iter; left time: 21.9383s
	iters: 700, epoch: 2 | loss: 0.2740017
	speed: 0.0035s/iter; left time: 21.3887s
	iters: 800, epoch: 2 | loss: 1.5904983
	speed: 0.0034s/iter; left time: 20.5652s
	iters: 900, epoch: 2 | loss: 0.8291895
	speed: 0.0034s/iter; left time: 20.3936s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 3.4699337482452393
Epoch: 2, Steps: 979 | Train Loss: 0.8334910 Vali Loss: 0.6428513 Best vali loss: 0.6326870
	iters: 100, epoch: 3 | loss: 0.4407874
	speed: 0.0109s/iter; left time: 62.6992s
	iters: 200, epoch: 3 | loss: 1.1755047
	speed: 0.0032s/iter; left time: 18.0670s
	iters: 300, epoch: 3 | loss: 0.9043165
	speed: 0.0033s/iter; left time: 18.5205s
	iters: 400, epoch: 3 | loss: 0.4739835
	speed: 0.0032s/iter; left time: 17.6050s
	iters: 500, epoch: 3 | loss: 1.0825881
	speed: 0.0033s/iter; left time: 17.8121s
	iters: 600, epoch: 3 | loss: 1.5902764
	speed: 0.0032s/iter; left time: 17.0639s
	iters: 700, epoch: 3 | loss: 0.4477338
	speed: 0.0033s/iter; left time: 16.8224s
	iters: 800, epoch: 3 | loss: 1.4808344
	speed: 0.0033s/iter; left time: 16.9107s
	iters: 900, epoch: 3 | loss: 0.6927936
	speed: 0.0034s/iter; left time: 16.9628s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 3.2359447479248047
Epoch: 3, Steps: 979 | Train Loss: 0.9209798 Vali Loss: 0.6411844 Best vali loss: 0.6326870

best validation loss 0.6326870019860094

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.6005).  Saving model state dict ...
Epoch: 1 cost time: 0.8414146900177002
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6005051 Best vali loss: 0.6005051
Updating learning rate to 7.955686575e-05
Validation loss decreased (0.6005 --> 0.5941).  Saving model state dict ...
Epoch: 2 cost time: 0.5229170322418213
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5941438 Best vali loss: 0.5941438
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.5941 --> 0.5756).  Saving model state dict ...
Epoch: 3 cost time: 0.5281858444213867
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5756471 Best vali loss: 0.5756471

best validation loss 0.5756470847604231

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Validation loss decreased (0.5756 --> 0.5438).  Saving model state dict ...
Epoch: 4 cost time: 0.827838659286499
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5438290 Best vali loss: 0.5438290
Updating learning rate to 9.94460821875e-06
Validation loss decreased (0.5438 --> 0.5423).  Saving model state dict ...
Epoch: 5 cost time: 0.5303704738616943
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5422513 Best vali loss: 0.5422513
Updating learning rate to 4.972304109375e-06
Validation loss decreased (0.5423 --> 0.5408).  Saving model state dict ...
Epoch: 6 cost time: 0.5260741710662842
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5407964 Best vali loss: 0.5407964
Updating learning rate to 2.4861520546875e-06
Validation loss decreased (0.5408 --> 0.5402).  Saving model state dict ...
Epoch: 7 cost time: 0.5315742492675781
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5402488 Best vali loss: 0.5402488
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 0.5267906188964844
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5403135 Best vali loss: 0.5402488

best validation loss 0.5402488162924658

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.6030).  Saving model state dict ...
Epoch: 1 cost time: 0.9070906639099121
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6029714 Best vali loss: 0.6029714
Updating learning rate to 0.0001110827988
Validation loss decreased (0.6030 --> 0.6016).  Saving model state dict ...
Epoch: 2 cost time: 0.6010489463806152
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6016124 Best vali loss: 0.6016124
Updating learning rate to 5.55413994e-05
Epoch: 3 cost time: 0.5976779460906982
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6036696 Best vali loss: 0.6016124
Updating learning rate to 2.77706997e-05
Validation loss decreased (0.6016 --> 0.5905).  Saving model state dict ...
Epoch: 4 cost time: 0.6050314903259277
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5905448 Best vali loss: 0.5905448
Updating learning rate to 1.388534985e-05
Validation loss decreased (0.5905 --> 0.5663).  Saving model state dict ...
Epoch: 5 cost time: 0.6117746829986572
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5662638 Best vali loss: 0.5662638
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 0.5955612659454346
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5671657 Best vali loss: 0.5662638
Updating learning rate to 3.4713374625e-06
Validation loss decreased (0.5663 --> 0.5606).  Saving model state dict ...
Epoch: 7 cost time: 0.598574161529541
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5605679 Best vali loss: 0.5605679
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 0.6021969318389893
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5615809 Best vali loss: 0.5605679

best validation loss 0.5605679168187044

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.6062).  Saving model state dict ...
Epoch: 1 cost time: 0.7877180576324463
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6061768 Best vali loss: 0.6061768
Updating learning rate to 0.00054448552275
Epoch: 2 cost time: 0.495776891708374
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6126596 Best vali loss: 0.6061768
Updating learning rate to 0.000272242761375
Epoch: 3 cost time: 0.49303603172302246
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6138443 Best vali loss: 0.6061768
Updating learning rate to 0.0001361213806875
Epoch: 4 cost time: 0.4927079677581787
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6161120 Best vali loss: 0.6061768
Updating learning rate to 6.806069034375e-05
Epoch: 5 cost time: 0.5018289089202881
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6206774 Best vali loss: 0.6061768
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.4962654113769531
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6199405 Best vali loss: 0.6061768
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 0.5016157627105713
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6148121 Best vali loss: 0.6061768
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.49458932876586914
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6130196 Best vali loss: 0.6061768

best validation loss 0.6061767907343436

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 0.7008836269378662
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6490142 Best vali loss: 0.6490142
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.6490 --> 0.6195).  Saving model state dict ...
Epoch: 2 cost time: 0.43808698654174805
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6195363 Best vali loss: 0.6195363
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.6195 --> 0.6107).  Saving model state dict ...
Epoch: 3 cost time: 0.4432544708251953
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6106937 Best vali loss: 0.6106937

best validation loss 0.6106936591524373

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5346898
	speed: 0.0092s/iter; left time: 71.4971s
	iters: 200, epoch: 1 | loss: 0.3633380
	speed: 0.0034s/iter; left time: 25.7323s
	iters: 300, epoch: 1 | loss: 1.1729894
	speed: 0.0034s/iter; left time: 25.4373s
	iters: 400, epoch: 1 | loss: 1.5081192
	speed: 0.0034s/iter; left time: 25.1964s
	iters: 500, epoch: 1 | loss: 0.7183405
	speed: 0.0034s/iter; left time: 24.9600s
	iters: 600, epoch: 1 | loss: 0.6193319
	speed: 0.0034s/iter; left time: 24.6011s
	iters: 700, epoch: 1 | loss: 0.6700582
	speed: 0.0034s/iter; left time: 24.2844s
	iters: 800, epoch: 1 | loss: 1.1022677
	speed: 0.0035s/iter; left time: 24.5173s
	iters: 900, epoch: 1 | loss: 0.6428863
	speed: 0.0035s/iter; left time: 24.5706s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.6358).  Saving model state dict ...
Epoch: 1 cost time: 3.6901910305023193
Epoch: 1, Steps: 979 | Train Loss: 0.8146690 Vali Loss: 0.6357881 Best vali loss: 0.6357881
	iters: 100, epoch: 2 | loss: 0.6522033
	speed: 0.0116s/iter; left time: 78.3029s
	iters: 200, epoch: 2 | loss: 0.6811314
	speed: 0.0036s/iter; left time: 23.8939s
	iters: 300, epoch: 2 | loss: 0.3642897
	speed: 0.0036s/iter; left time: 23.4563s
	iters: 400, epoch: 2 | loss: 0.6319972
	speed: 0.0036s/iter; left time: 23.0764s
	iters: 500, epoch: 2 | loss: 1.3262037
	speed: 0.0035s/iter; left time: 22.5035s
	iters: 600, epoch: 2 | loss: 0.5037419
	speed: 0.0036s/iter; left time: 22.6101s
	iters: 700, epoch: 2 | loss: 1.3301237
	speed: 0.0036s/iter; left time: 22.2876s
	iters: 800, epoch: 2 | loss: 0.3509944
	speed: 0.0036s/iter; left time: 21.6778s
	iters: 900, epoch: 2 | loss: 0.6873802
	speed: 0.0033s/iter; left time: 19.9103s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.6358 --> 0.6281).  Saving model state dict ...
Epoch: 2 cost time: 3.498114585876465
Epoch: 2, Steps: 979 | Train Loss: 0.7253406 Vali Loss: 0.6281245 Best vali loss: 0.6281245
	iters: 100, epoch: 3 | loss: 1.0794163
	speed: 0.0112s/iter; left time: 64.4300s
	iters: 200, epoch: 3 | loss: 0.8651470
	speed: 0.0033s/iter; left time: 18.9067s
	iters: 300, epoch: 3 | loss: 0.8007134
	speed: 0.0033s/iter; left time: 18.6019s
	iters: 400, epoch: 3 | loss: 0.9314712
	speed: 0.0033s/iter; left time: 18.2486s
	iters: 500, epoch: 3 | loss: 0.3100969
	speed: 0.0035s/iter; left time: 18.8943s
	iters: 600, epoch: 3 | loss: 1.8759712
	speed: 0.0034s/iter; left time: 18.1878s
	iters: 700, epoch: 3 | loss: 0.3276834
	speed: 0.0035s/iter; left time: 18.0997s
	iters: 800, epoch: 3 | loss: 1.8352711
	speed: 0.0033s/iter; left time: 16.8838s
	iters: 900, epoch: 3 | loss: 1.4503117
	speed: 0.0035s/iter; left time: 17.2121s
Updating learning rate to 0.0011058191498174795
Epoch: 3 cost time: 3.374229669570923
Epoch: 3, Steps: 979 | Train Loss: 1.0528980 Vali Loss: 0.6363079 Best vali loss: 0.6281245

best validation loss 0.6281244521723583

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1141102
	speed: 0.0109s/iter; left time: 20.2682s
	iters: 200, epoch: 1 | loss: 1.2054535
	speed: 0.0048s/iter; left time: 8.5006s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.6379).  Saving model state dict ...
Epoch: 1 cost time: 1.5287017822265625
Epoch: 1, Steps: 245 | Train Loss: 1.1597819 Vali Loss: 0.6379330 Best vali loss: 0.6379330
	iters: 100, epoch: 2 | loss: 0.7794569
	speed: 0.0091s/iter; left time: 14.7339s
	iters: 200, epoch: 2 | loss: 0.6804292
	speed: 0.0049s/iter; left time: 7.4605s
Updating learning rate to 0.003014973004077762
Epoch: 2 cost time: 1.2038402557373047
Epoch: 2, Steps: 245 | Train Loss: 0.7299431 Vali Loss: 0.6510786 Best vali loss: 0.6379330
	iters: 100, epoch: 3 | loss: 1.0016328
	speed: 0.0092s/iter; left time: 12.6392s
	iters: 200, epoch: 3 | loss: 0.7257563
	speed: 0.0044s/iter; left time: 5.5736s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 1.1258776187896729
Epoch: 3, Steps: 245 | Train Loss: 0.8636945 Vali Loss: 0.6517941 Best vali loss: 0.6379330

best validation loss 0.6379330453636579

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.6107 --> 0.6052).  Saving model state dict ...
Epoch: 4 cost time: 0.688446044921875
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6051859 Best vali loss: 0.6051859
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.6052 --> 0.6048).  Saving model state dict ...
Epoch: 5 cost time: 0.4289071559906006
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6048019 Best vali loss: 0.6048019
Updating learning rate to 8.769766730464429e-05
Validation loss decreased (0.6048 --> 0.6045).  Saving model state dict ...
Epoch: 6 cost time: 0.4212064743041992
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6044792 Best vali loss: 0.6044792
Updating learning rate to 2.2791881150211728e-05
Validation loss decreased (0.6045 --> 0.6032).  Saving model state dict ...
Epoch: 7 cost time: 0.4458496570587158
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6032432 Best vali loss: 0.6032432
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4484562873840332
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6034570 Best vali loss: 0.6032432

best validation loss 0.6032431891868093

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.7088408470153809
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6047514 Best vali loss: 0.6047514
Updating learning rate to 0.00010898825745
Validation loss decreased (0.6048 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.4261288642883301
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5995222 Best vali loss: 0.5995222
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.5995 --> 0.5952).  Saving model state dict ...
Epoch: 3 cost time: 0.4312732219696045
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5952188 Best vali loss: 0.5952188
Updating learning rate to 2.72470643625e-05
Epoch: 4 cost time: 0.4398837089538574
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5971925 Best vali loss: 0.5952188
Updating learning rate to 1.362353218125e-05
Epoch: 5 cost time: 0.4347360134124756
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5967002 Best vali loss: 0.5952188
Updating learning rate to 6.811766090625e-06
Epoch: 6 cost time: 0.4236447811126709
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5969657 Best vali loss: 0.5952188
Updating learning rate to 3.4058830453125e-06
Validation loss decreased (0.5952 --> 0.5929).  Saving model state dict ...
Epoch: 7 cost time: 0.4465935230255127
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5929279 Best vali loss: 0.5929279
Updating learning rate to 1.70294152265625e-06
Epoch: 8 cost time: 0.4338340759277344
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5954905 Best vali loss: 0.5929279

best validation loss 0.5929279381729066

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 0.7134706974029541
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6142382 Best vali loss: 0.6142382
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.4360809326171875
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6605304 Best vali loss: 0.6142382
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.4300501346588135
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6469987 Best vali loss: 0.6142382
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.4137382507324219
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6170462 Best vali loss: 0.6142382
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.4197511672973633
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6266702 Best vali loss: 0.6142382
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.4368324279785156
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6182788 Best vali loss: 0.6142382
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.398639440536499
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6204185 Best vali loss: 0.6142382
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.4174971580505371
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6223171 Best vali loss: 0.6142382

best validation loss 0.6142382401109349

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5338737
	speed: 0.0095s/iter; left time: 73.4442s
	iters: 200, epoch: 1 | loss: 0.8667485
	speed: 0.0036s/iter; left time: 27.4636s
	iters: 300, epoch: 1 | loss: 0.7143742
	speed: 0.0033s/iter; left time: 25.2221s
	iters: 400, epoch: 1 | loss: 1.0189171
	speed: 0.0033s/iter; left time: 24.7469s
	iters: 500, epoch: 1 | loss: 0.7206213
	speed: 0.0033s/iter; left time: 24.4469s
	iters: 600, epoch: 1 | loss: 1.0155475
	speed: 0.0033s/iter; left time: 24.1044s
	iters: 700, epoch: 1 | loss: 1.1085594
	speed: 0.0036s/iter; left time: 25.4690s
	iters: 800, epoch: 1 | loss: 0.7220566
	speed: 0.0036s/iter; left time: 25.2012s
	iters: 900, epoch: 1 | loss: 1.4720411
	speed: 0.0034s/iter; left time: 23.4043s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.6178).  Saving model state dict ...
Epoch: 1 cost time: 3.7054691314697266
Epoch: 1, Steps: 979 | Train Loss: 0.9080822 Vali Loss: 0.6178114 Best vali loss: 0.6178114
	iters: 100, epoch: 2 | loss: 0.7114739
	speed: 0.0112s/iter; left time: 75.6802s
	iters: 200, epoch: 2 | loss: 0.7394748
	speed: 0.0032s/iter; left time: 21.1120s
	iters: 300, epoch: 2 | loss: 0.9123279
	speed: 0.0032s/iter; left time: 20.8125s
	iters: 400, epoch: 2 | loss: 1.0220423
	speed: 0.0032s/iter; left time: 20.4366s
	iters: 500, epoch: 2 | loss: 0.4863554
	speed: 0.0031s/iter; left time: 19.7539s
	iters: 600, epoch: 2 | loss: 0.7003620
	speed: 0.0031s/iter; left time: 19.0922s
	iters: 700, epoch: 2 | loss: 0.3521734
	speed: 0.0031s/iter; left time: 18.7988s
	iters: 800, epoch: 2 | loss: 0.5943288
	speed: 0.0031s/iter; left time: 18.6833s
	iters: 900, epoch: 2 | loss: 1.2279910
	speed: 0.0031s/iter; left time: 18.2961s
Updating learning rate to 0.0006333048484408287
Epoch: 2 cost time: 3.1061360836029053
Epoch: 2, Steps: 979 | Train Loss: 0.7496144 Vali Loss: 0.6193442 Best vali loss: 0.6178114
	iters: 100, epoch: 3 | loss: 0.7086952
	speed: 0.0108s/iter; left time: 62.2270s
	iters: 200, epoch: 3 | loss: 1.7272403
	speed: 0.0030s/iter; left time: 17.2236s
	iters: 300, epoch: 3 | loss: 0.5148710
	speed: 0.0031s/iter; left time: 17.2746s
	iters: 400, epoch: 3 | loss: 1.4723506
	speed: 0.0029s/iter; left time: 15.8501s
	iters: 500, epoch: 3 | loss: 0.4062868
	speed: 0.0029s/iter; left time: 15.7299s
	iters: 600, epoch: 3 | loss: 0.5268981
	speed: 0.0030s/iter; left time: 16.0236s
	iters: 700, epoch: 3 | loss: 0.8942195
	speed: 0.0031s/iter; left time: 15.9501s
	iters: 800, epoch: 3 | loss: 1.7551068
	speed: 0.0030s/iter; left time: 15.4005s
	iters: 900, epoch: 3 | loss: 0.9943930
	speed: 0.0031s/iter; left time: 15.6434s
Updating learning rate to 0.0005129498231897238
Epoch: 3 cost time: 3.0157761573791504
Epoch: 3, Steps: 979 | Train Loss: 1.0000068 Vali Loss: 0.6294752 Best vali loss: 0.6178114

best validation loss 0.6178114128741662

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7134443
	speed: 0.0119s/iter; left time: 10.5065s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 1.0412230491638184
Epoch: 1, Steps: 123 | Train Loss: 0.7134443 Vali Loss: 0.6067003 Best vali loss: 0.6067003
	iters: 100, epoch: 2 | loss: 0.9056057
	speed: 0.0092s/iter; left time: 7.0370s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.6067 --> 0.5947).  Saving model state dict ...
Epoch: 2 cost time: 0.7213454246520996
Epoch: 2, Steps: 123 | Train Loss: 0.9056057 Vali Loss: 0.5947141 Best vali loss: 0.5947141
	iters: 100, epoch: 3 | loss: 1.0188292
	speed: 0.0093s/iter; left time: 5.9352s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.5947 --> 0.5904).  Saving model state dict ...
Epoch: 3 cost time: 0.7161364555358887
Epoch: 3, Steps: 123 | Train Loss: 1.0188292 Vali Loss: 0.5903607 Best vali loss: 0.5903607

best validation loss 0.590360685445158

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.6419).  Saving model state dict ...
Epoch: 1 cost time: 1.3133108615875244
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6418515 Best vali loss: 0.6418515
Updating learning rate to 0.004084227711283759
Epoch: 2 cost time: 1.0351486206054688
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6523321 Best vali loss: 0.6418515
Updating learning rate to 0.0033080496502235694
Epoch: 3 cost time: 1.0306684970855713
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6512734 Best vali loss: 0.6418515

best validation loss 0.6418515220112074

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6560725
	speed: 0.0119s/iter; left time: 6.1405s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.5904 --> 0.5696).  Saving model state dict ...
Epoch: 4 cost time: 1.0221219062805176
Epoch: 4, Steps: 123 | Train Loss: 0.6560725 Vali Loss: 0.5695630 Best vali loss: 0.5695630
	iters: 100, epoch: 5 | loss: 0.8271378
	speed: 0.0094s/iter; left time: 3.6909s
Updating learning rate to 4.50666261875e-06
Validation loss decreased (0.5696 --> 0.5647).  Saving model state dict ...
Epoch: 5 cost time: 0.7254617214202881
Epoch: 5, Steps: 123 | Train Loss: 0.8271378 Vali Loss: 0.5646946 Best vali loss: 0.5646946
	iters: 100, epoch: 6 | loss: 0.9709435
	speed: 0.0095s/iter; left time: 2.5632s
Updating learning rate to 2.253331309375e-06
Validation loss decreased (0.5647 --> 0.5618).  Saving model state dict ...
Epoch: 6 cost time: 0.7220299243927002
Epoch: 6, Steps: 123 | Train Loss: 0.9709435 Vali Loss: 0.5618321 Best vali loss: 0.5618321
	iters: 100, epoch: 7 | loss: 0.5755252
	speed: 0.0092s/iter; left time: 1.3554s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 0.7228589057922363
Epoch: 7, Steps: 123 | Train Loss: 0.5755252 Vali Loss: 0.5620683 Best vali loss: 0.5618321
	iters: 100, epoch: 8 | loss: 0.8019488
	speed: 0.0090s/iter; left time: 0.2148s
Updating learning rate to 5.6333282734375e-07
Validation loss decreased (0.5618 --> 0.5603).  Saving model state dict ...
Epoch: 8 cost time: 0.7198152542114258
Epoch: 8, Steps: 123 | Train Loss: 0.8019488 Vali Loss: 0.5603272 Best vali loss: 0.5603272

best validation loss 0.5603272477988014

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3880655
	speed: 0.0107s/iter; left time: 40.9275s
	iters: 200, epoch: 1 | loss: 0.6491840
	speed: 0.0047s/iter; left time: 17.3043s
	iters: 300, epoch: 1 | loss: 0.7220223
	speed: 0.0047s/iter; left time: 17.1535s
	iters: 400, epoch: 1 | loss: 1.1033143
	speed: 0.0049s/iter; left time: 17.3775s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.6198).  Saving model state dict ...
Epoch: 1 cost time: 2.690492868423462
Epoch: 1, Steps: 490 | Train Loss: 0.7156465 Vali Loss: 0.6197946 Best vali loss: 0.6197946
	iters: 100, epoch: 2 | loss: 1.1894859
	speed: 0.0137s/iter; left time: 45.5796s
	iters: 200, epoch: 2 | loss: 1.2882708
	speed: 0.0053s/iter; left time: 17.2644s
	iters: 300, epoch: 2 | loss: 0.7951719
	speed: 0.0054s/iter; left time: 16.8062s
	iters: 400, epoch: 2 | loss: 0.7047057
	speed: 0.0050s/iter; left time: 15.0501s
Updating learning rate to 0.000558034214
Validation loss decreased (0.6198 --> 0.6029).  Saving model state dict ...
Epoch: 2 cost time: 2.603872299194336
Epoch: 2, Steps: 490 | Train Loss: 0.9944086 Vali Loss: 0.6029459 Best vali loss: 0.6029459
	iters: 100, epoch: 3 | loss: 1.0647353
	speed: 0.0137s/iter; left time: 39.0490s
	iters: 200, epoch: 3 | loss: 1.0541003
	speed: 0.0054s/iter; left time: 14.8111s
	iters: 300, epoch: 3 | loss: 1.1633674
	speed: 0.0052s/iter; left time: 13.7625s
	iters: 400, epoch: 3 | loss: 0.7354255
	speed: 0.0053s/iter; left time: 13.3754s
Updating learning rate to 0.000279017107
Epoch: 3 cost time: 2.636676788330078
Epoch: 3, Steps: 490 | Train Loss: 1.0044071 Vali Loss: 0.6165920 Best vali loss: 0.6029459
	iters: 100, epoch: 4 | loss: 0.5486169
	speed: 0.0142s/iter; left time: 33.3503s
	iters: 200, epoch: 4 | loss: 0.5754220
	speed: 0.0052s/iter; left time: 11.7023s
	iters: 300, epoch: 4 | loss: 0.4692042
	speed: 0.0052s/iter; left time: 11.1254s
	iters: 400, epoch: 4 | loss: 0.6499951
	speed: 0.0052s/iter; left time: 10.6368s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 2.5900731086730957
Epoch: 4, Steps: 490 | Train Loss: 0.5608096 Vali Loss: 0.6325516 Best vali loss: 0.6029459
	iters: 100, epoch: 5 | loss: 0.6929433
	speed: 0.0135s/iter; left time: 25.0435s
	iters: 200, epoch: 5 | loss: 1.5188463
	speed: 0.0050s/iter; left time: 8.7577s
	iters: 300, epoch: 5 | loss: 0.7279920
	speed: 0.0050s/iter; left time: 8.2741s
	iters: 400, epoch: 5 | loss: 1.0041760
	speed: 0.0050s/iter; left time: 7.7559s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 2.481909990310669
Epoch: 5, Steps: 490 | Train Loss: 0.9859894 Vali Loss: 0.6370154 Best vali loss: 0.6029459
	iters: 100, epoch: 6 | loss: 0.8381578
	speed: 0.0138s/iter; left time: 18.9635s
	iters: 200, epoch: 6 | loss: 0.6469113
	speed: 0.0051s/iter; left time: 6.4434s
	iters: 300, epoch: 6 | loss: 0.4614048
	speed: 0.0052s/iter; left time: 6.0695s
	iters: 400, epoch: 6 | loss: 0.3701988
	speed: 0.0051s/iter; left time: 5.4465s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 2.554264783859253
Epoch: 6, Steps: 490 | Train Loss: 0.5791682 Vali Loss: 0.6371386 Best vali loss: 0.6029459
	iters: 100, epoch: 7 | loss: 0.8807338
	speed: 0.0130s/iter; left time: 11.4426s
	iters: 200, epoch: 7 | loss: 0.9159064
	speed: 0.0048s/iter; left time: 3.7724s
	iters: 300, epoch: 7 | loss: 0.7954435
	speed: 0.0049s/iter; left time: 3.3123s
	iters: 400, epoch: 7 | loss: 0.8767421
	speed: 0.0047s/iter; left time: 2.7550s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 2.4043707847595215
Epoch: 7, Steps: 490 | Train Loss: 0.8672065 Vali Loss: 0.6389605 Best vali loss: 0.6029459
	iters: 100, epoch: 8 | loss: 1.0947444
	speed: 0.0128s/iter; left time: 5.0027s
	iters: 200, epoch: 8 | loss: 0.5507262
	speed: 0.0047s/iter; left time: 1.3635s
	iters: 300, epoch: 8 | loss: 0.5514662
	speed: 0.0051s/iter; left time: 0.9680s
	iters: 400, epoch: 8 | loss: 0.9641449
	speed: 0.0053s/iter; left time: 0.4855s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 2.502553701400757
Epoch: 8, Steps: 490 | Train Loss: 0.7902704 Vali Loss: 0.6391952 Best vali loss: 0.6029459

best validation loss 0.6029459243844583

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6736109
	speed: 0.0085s/iter; left time: 32.5456s
	iters: 200, epoch: 1 | loss: 0.6142273
	speed: 0.0026s/iter; left time: 9.5507s
	iters: 300, epoch: 1 | loss: 0.6718441
	speed: 0.0025s/iter; left time: 9.1515s
	iters: 400, epoch: 1 | loss: 0.7801357
	speed: 0.0025s/iter; left time: 8.8815s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 1.5788037776947021
Epoch: 1, Steps: 490 | Train Loss: 0.6849545 Vali Loss: 0.6080926 Best vali loss: 0.6080926
	iters: 100, epoch: 2 | loss: 0.3637897
	speed: 0.0080s/iter; left time: 26.5592s
	iters: 200, epoch: 2 | loss: 0.5212378
	speed: 0.0026s/iter; left time: 8.2445s
	iters: 300, epoch: 2 | loss: 1.0055985
	speed: 0.0025s/iter; left time: 7.8245s
	iters: 400, epoch: 2 | loss: 1.2992508
	speed: 0.0025s/iter; left time: 7.6785s
Updating learning rate to 0.0008313570410112075
Validation loss decreased (0.6081 --> 0.6045).  Saving model state dict ...
Epoch: 2 cost time: 1.2931938171386719
Epoch: 2, Steps: 490 | Train Loss: 0.7974692 Vali Loss: 0.6045314 Best vali loss: 0.6045314
	iters: 100, epoch: 3 | loss: 1.2100384
	speed: 0.0077s/iter; left time: 21.8665s
	iters: 200, epoch: 3 | loss: 0.6886875
	speed: 0.0025s/iter; left time: 6.7331s
	iters: 300, epoch: 3 | loss: 0.8827255
	speed: 0.0025s/iter; left time: 6.5089s
	iters: 400, epoch: 3 | loss: 0.9527988
	speed: 0.0026s/iter; left time: 6.5730s
Updating learning rate to 0.0006733636229757597
Validation loss decreased (0.6045 --> 0.5992).  Saving model state dict ...
Epoch: 3 cost time: 1.2615551948547363
Epoch: 3, Steps: 490 | Train Loss: 0.9335626 Vali Loss: 0.5991522 Best vali loss: 0.5991522
	iters: 100, epoch: 4 | loss: 0.9155626
	speed: 0.0080s/iter; left time: 18.8037s
	iters: 200, epoch: 4 | loss: 1.0748837
	speed: 0.0027s/iter; left time: 6.1268s
	iters: 300, epoch: 4 | loss: 1.0955126
	speed: 0.0026s/iter; left time: 5.5584s
	iters: 400, epoch: 4 | loss: 0.6972817
	speed: 0.0025s/iter; left time: 5.1670s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 1.318739414215088
Epoch: 4, Steps: 490 | Train Loss: 0.9458102 Vali Loss: 0.6183542 Best vali loss: 0.5991522
	iters: 100, epoch: 5 | loss: 0.5742648
	speed: 0.0076s/iter; left time: 14.0662s
	iters: 200, epoch: 5 | loss: 1.2295313
	speed: 0.0025s/iter; left time: 4.3423s
	iters: 300, epoch: 5 | loss: 0.6428149
	speed: 0.0024s/iter; left time: 3.9978s
	iters: 400, epoch: 5 | loss: 0.5830310
	speed: 0.0025s/iter; left time: 3.9290s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 1.2537665367126465
Epoch: 5, Steps: 490 | Train Loss: 0.7574105 Vali Loss: 0.6633981 Best vali loss: 0.5991522
	iters: 100, epoch: 6 | loss: 0.9192279
	speed: 0.0078s/iter; left time: 10.6732s
	iters: 200, epoch: 6 | loss: 1.1213313
	speed: 0.0027s/iter; left time: 3.3951s
	iters: 300, epoch: 6 | loss: 0.6840057
	speed: 0.0026s/iter; left time: 3.0749s
	iters: 400, epoch: 6 | loss: 0.5108120
	speed: 0.0027s/iter; left time: 2.8694s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 1.3358793258666992
Epoch: 6, Steps: 490 | Train Loss: 0.8088442 Vali Loss: 0.6673216 Best vali loss: 0.5991522
	iters: 100, epoch: 7 | loss: 0.5840156
	speed: 0.0079s/iter; left time: 6.9847s
	iters: 200, epoch: 7 | loss: 1.2034781
	speed: 0.0027s/iter; left time: 2.0944s
	iters: 300, epoch: 7 | loss: 1.2573729
	speed: 0.0026s/iter; left time: 1.7707s
	iters: 400, epoch: 7 | loss: 0.6710153
	speed: 0.0025s/iter; left time: 1.4666s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 1.3166749477386475
Epoch: 7, Steps: 490 | Train Loss: 0.9289705 Vali Loss: 0.6547293 Best vali loss: 0.5991522
	iters: 100, epoch: 8 | loss: 0.7416728
	speed: 0.0081s/iter; left time: 3.1804s
	iters: 200, epoch: 8 | loss: 0.2483915
	speed: 0.0028s/iter; left time: 0.8028s
	iters: 300, epoch: 8 | loss: 1.0939908
	speed: 0.0028s/iter; left time: 0.5259s
	iters: 400, epoch: 8 | loss: 0.9620011
	speed: 0.0028s/iter; left time: 0.2505s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.39280104637146
Epoch: 8, Steps: 490 | Train Loss: 0.7615141 Vali Loss: 0.6596772 Best vali loss: 0.5991522

best validation loss 0.5991521823301408

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1271521
	speed: 0.0107s/iter; left time: 9.4378s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.5950).  Saving model state dict ...
Epoch: 1 cost time: 0.917579174041748
Epoch: 1, Steps: 123 | Train Loss: 1.1271521 Vali Loss: 0.5950398 Best vali loss: 0.5950398
	iters: 100, epoch: 2 | loss: 0.9988377
	speed: 0.0078s/iter; left time: 5.9581s
Updating learning rate to 0.00056621315495
Validation loss decreased (0.5950 --> 0.5870).  Saving model state dict ...
Epoch: 2 cost time: 0.6110885143280029
Epoch: 2, Steps: 123 | Train Loss: 0.9988377 Vali Loss: 0.5870192 Best vali loss: 0.5870192
	iters: 100, epoch: 3 | loss: 0.7977760
	speed: 0.0078s/iter; left time: 4.9672s
Updating learning rate to 0.000283106577475
Epoch: 3 cost time: 0.5972659587860107
Epoch: 3, Steps: 123 | Train Loss: 0.7977760 Vali Loss: 0.6150389 Best vali loss: 0.5870192

best validation loss 0.5870192060863348

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1019068
	speed: 0.0098s/iter; left time: 37.2568s
	iters: 200, epoch: 1 | loss: 0.8525612
	speed: 0.0036s/iter; left time: 13.4545s
	iters: 300, epoch: 1 | loss: 0.4649942
	speed: 0.0036s/iter; left time: 13.1146s
	iters: 400, epoch: 1 | loss: 1.0959760
	speed: 0.0035s/iter; left time: 12.4865s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 2.0916852951049805
Epoch: 1, Steps: 490 | Train Loss: 0.8788595 Vali Loss: 0.6011506 Best vali loss: 0.6011506
	iters: 100, epoch: 2 | loss: 0.9613062
	speed: 0.0102s/iter; left time: 34.1385s
	iters: 200, epoch: 2 | loss: 0.8726684
	speed: 0.0036s/iter; left time: 11.7637s
	iters: 300, epoch: 2 | loss: 0.4419131
	speed: 0.0037s/iter; left time: 11.6067s
	iters: 400, epoch: 2 | loss: 1.0144031
	speed: 0.0035s/iter; left time: 10.5865s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 1.8269984722137451
Epoch: 2, Steps: 490 | Train Loss: 0.8225727 Vali Loss: 0.6208474 Best vali loss: 0.6011506
	iters: 100, epoch: 3 | loss: 0.6749448
	speed: 0.0103s/iter; left time: 29.1501s
	iters: 200, epoch: 3 | loss: 0.8893609
	speed: 0.0037s/iter; left time: 10.2544s
	iters: 300, epoch: 3 | loss: 0.7207703
	speed: 0.0036s/iter; left time: 9.4300s
	iters: 400, epoch: 3 | loss: 1.1983418
	speed: 0.0033s/iter; left time: 8.3647s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 1.7757189273834229
Epoch: 3, Steps: 490 | Train Loss: 0.8708545 Vali Loss: 0.6130094 Best vali loss: 0.6011506

best validation loss 0.601150638276038

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8206423
	speed: 0.0106s/iter; left time: 40.5278s
	iters: 200, epoch: 1 | loss: 1.3290091
	speed: 0.0043s/iter; left time: 15.8874s
	iters: 300, epoch: 1 | loss: 1.4595271
	speed: 0.0043s/iter; left time: 15.5953s
	iters: 400, epoch: 1 | loss: 0.6739191
	speed: 0.0045s/iter; left time: 15.8292s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 2.5217626094818115
Epoch: 1, Steps: 490 | Train Loss: 1.0707744 Vali Loss: 0.6111087 Best vali loss: 0.6111087
	iters: 100, epoch: 2 | loss: 0.7706538
	speed: 0.0124s/iter; left time: 41.1418s
	iters: 200, epoch: 2 | loss: 0.8069733
	speed: 0.0046s/iter; left time: 14.8100s
	iters: 300, epoch: 2 | loss: 0.8728619
	speed: 0.0046s/iter; left time: 14.5069s
	iters: 400, epoch: 2 | loss: 0.6803001
	speed: 0.0045s/iter; left time: 13.7446s
Updating learning rate to 0.00021781340639583926
Validation loss decreased (0.6111 --> 0.5807).  Saving model state dict ...
Epoch: 2 cost time: 2.2988903522491455
Epoch: 2, Steps: 490 | Train Loss: 0.7826973 Vali Loss: 0.5806578 Best vali loss: 0.5806578
	iters: 100, epoch: 3 | loss: 0.5911035
	speed: 0.0117s/iter; left time: 33.2030s
	iters: 200, epoch: 3 | loss: 0.6125342
	speed: 0.0041s/iter; left time: 11.1039s
	iters: 300, epoch: 3 | loss: 0.9497427
	speed: 0.0041s/iter; left time: 10.8821s
	iters: 400, epoch: 3 | loss: 0.8154100
	speed: 0.0047s/iter; left time: 11.8753s
Updating learning rate to 0.000176419537248397
Validation loss decreased (0.5807 --> 0.5754).  Saving model state dict ...
Epoch: 3 cost time: 2.1441338062286377
Epoch: 3, Steps: 490 | Train Loss: 0.7421976 Vali Loss: 0.5753621 Best vali loss: 0.5753621

best validation loss 0.5753620802142564

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7782959
	speed: 0.0104s/iter; left time: 24.5154s
	iters: 200, epoch: 4 | loss: 1.2144930
	speed: 0.0047s/iter; left time: 10.5650s
	iters: 300, epoch: 4 | loss: 1.3650556
	speed: 0.0045s/iter; left time: 9.6859s
	iters: 400, epoch: 4 | loss: 0.6901193
	speed: 0.0040s/iter; left time: 8.2938s
Updating learning rate to 0.0001275921394
Validation loss decreased (0.5754 --> 0.5598).  Saving model state dict ...
Epoch: 4 cost time: 2.4900102615356445
Epoch: 4, Steps: 490 | Train Loss: 1.0119910 Vali Loss: 0.5598214 Best vali loss: 0.5598214
	iters: 100, epoch: 5 | loss: 0.7476431
	speed: 0.0117s/iter; left time: 21.8658s
	iters: 200, epoch: 5 | loss: 0.7031423
	speed: 0.0041s/iter; left time: 7.2861s
	iters: 300, epoch: 5 | loss: 0.6033351
	speed: 0.0041s/iter; left time: 6.8170s
	iters: 400, epoch: 5 | loss: 0.5825711
	speed: 0.0041s/iter; left time: 6.4011s
Updating learning rate to 7.8764741551603e-05
Validation loss decreased (0.5598 --> 0.5562).  Saving model state dict ...
Epoch: 5 cost time: 2.072262763977051
Epoch: 5, Steps: 490 | Train Loss: 0.6591729 Vali Loss: 0.5561910 Best vali loss: 0.5561910
	iters: 100, epoch: 6 | loss: 0.5593723
	speed: 0.0114s/iter; left time: 15.6751s
	iters: 200, epoch: 6 | loss: 0.5449201
	speed: 0.0041s/iter; left time: 5.1501s
	iters: 300, epoch: 6 | loss: 0.9237542
	speed: 0.0042s/iter; left time: 4.8984s
	iters: 400, epoch: 6 | loss: 0.7662500
	speed: 0.0042s/iter; left time: 4.4838s
Updating learning rate to 3.7370872404160736e-05
Validation loss decreased (0.5562 --> 0.5452).  Saving model state dict ...
Epoch: 6 cost time: 2.0947439670562744
Epoch: 6, Steps: 490 | Train Loss: 0.6985742 Vali Loss: 0.5452032 Best vali loss: 0.5452032
	iters: 100, epoch: 7 | loss: 1.0015696
	speed: 0.0118s/iter; left time: 10.3564s
	iters: 200, epoch: 7 | loss: 0.7117624
	speed: 0.0042s/iter; left time: 3.2754s
	iters: 300, epoch: 7 | loss: 1.0818207
	speed: 0.0042s/iter; left time: 2.8348s
	iters: 400, epoch: 7 | loss: 0.4446172
	speed: 0.0041s/iter; left time: 2.3581s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 2.0625956058502197
Epoch: 7, Steps: 490 | Train Loss: 0.8099425 Vali Loss: 0.5465897 Best vali loss: 0.5452032
	iters: 100, epoch: 8 | loss: 0.3859452
	speed: 0.0117s/iter; left time: 4.5688s
	iters: 200, epoch: 8 | loss: 1.0555060
	speed: 0.0041s/iter; left time: 1.2050s
	iters: 300, epoch: 8 | loss: 0.5769273
	speed: 0.0041s/iter; left time: 0.7773s
	iters: 400, epoch: 8 | loss: 0.7573251
	speed: 0.0041s/iter; left time: 0.3752s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.087543487548828
Epoch: 8, Steps: 490 | Train Loss: 0.6939259 Vali Loss: 0.5456141 Best vali loss: 0.5452032

best validation loss 0.5452031509736135

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6686826
	speed: 0.0099s/iter; left time: 18.4229s
	iters: 200, epoch: 1 | loss: 0.9702815
	speed: 0.0037s/iter; left time: 6.5121s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 1.2665112018585205
Epoch: 1, Steps: 245 | Train Loss: 0.8194821 Vali Loss: 0.6116770 Best vali loss: 0.6116770
	iters: 100, epoch: 2 | loss: 0.8815933
	speed: 0.0077s/iter; left time: 12.4972s
	iters: 200, epoch: 2 | loss: 0.7922813
	speed: 0.0036s/iter; left time: 5.4408s
Updating learning rate to 0.0001961474641
Epoch: 2 cost time: 0.9228191375732422
Epoch: 2, Steps: 245 | Train Loss: 0.8369373 Vali Loss: 0.6336536 Best vali loss: 0.6116770
	iters: 100, epoch: 3 | loss: 0.8306745
	speed: 0.0079s/iter; left time: 10.7901s
	iters: 200, epoch: 3 | loss: 0.7862145
	speed: 0.0036s/iter; left time: 4.5627s
Updating learning rate to 9.807373205e-05
Epoch: 3 cost time: 0.9538462162017822
Epoch: 3, Steps: 245 | Train Loss: 0.8084445 Vali Loss: 0.6240454 Best vali loss: 0.6116770
	iters: 100, epoch: 4 | loss: 1.0525427
	speed: 0.0077s/iter; left time: 8.6869s
	iters: 200, epoch: 4 | loss: 0.6267747
	speed: 0.0036s/iter; left time: 3.6692s
Updating learning rate to 4.9036866025e-05
Validation loss decreased (0.6117 --> 0.6075).  Saving model state dict ...
Epoch: 4 cost time: 0.9341926574707031
Epoch: 4, Steps: 245 | Train Loss: 0.8396587 Vali Loss: 0.6075215 Best vali loss: 0.6075215
	iters: 100, epoch: 5 | loss: 0.6857036
	speed: 0.0078s/iter; left time: 6.8376s
	iters: 200, epoch: 5 | loss: 0.8167127
	speed: 0.0036s/iter; left time: 2.7938s
Updating learning rate to 2.45184330125e-05
Validation loss decreased (0.6075 --> 0.6023).  Saving model state dict ...
Epoch: 5 cost time: 0.9227797985076904
Epoch: 5, Steps: 245 | Train Loss: 0.7512082 Vali Loss: 0.6023428 Best vali loss: 0.6023428
	iters: 100, epoch: 6 | loss: 0.6584880
	speed: 0.0077s/iter; left time: 4.8796s
	iters: 200, epoch: 6 | loss: 1.0451483
	speed: 0.0035s/iter; left time: 1.8685s
Updating learning rate to 1.225921650625e-05
Validation loss decreased (0.6023 --> 0.5951).  Saving model state dict ...
Epoch: 6 cost time: 0.8989074230194092
Epoch: 6, Steps: 245 | Train Loss: 0.8518181 Vali Loss: 0.5950914 Best vali loss: 0.5950914
	iters: 100, epoch: 7 | loss: 0.7382416
	speed: 0.0080s/iter; left time: 3.1367s
	iters: 200, epoch: 7 | loss: 0.7910897
	speed: 0.0041s/iter; left time: 1.1851s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 1.0190773010253906
Epoch: 7, Steps: 245 | Train Loss: 0.7646656 Vali Loss: 0.5977907 Best vali loss: 0.5950914
	iters: 100, epoch: 8 | loss: 0.7367312
	speed: 0.0082s/iter; left time: 1.1957s
	iters: 200, epoch: 8 | loss: 0.6359352
	speed: 0.0039s/iter; left time: 0.1800s
Updating learning rate to 3.0648041265625e-06
Validation loss decreased (0.5951 --> 0.5950).  Saving model state dict ...
Epoch: 8 cost time: 1.0044341087341309
Epoch: 8, Steps: 245 | Train Loss: 0.6863332 Vali Loss: 0.5950163 Best vali loss: 0.5950163

best validation loss 0.5950162577882844

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.6957).  Saving model state dict ...
Epoch: 1 cost time: 0.7988710403442383
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6956972 Best vali loss: 0.6956972
Updating learning rate to 0.0020052808113
Validation loss decreased (0.6957 --> 0.6682).  Saving model state dict ...
Epoch: 2 cost time: 0.5120139122009277
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6681644 Best vali loss: 0.6681644
Updating learning rate to 0.00100264040565
Validation loss decreased (0.6682 --> 0.6384).  Saving model state dict ...
Epoch: 3 cost time: 0.5069851875305176
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6384286 Best vali loss: 0.6384286
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 0.4968912601470947
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6489285 Best vali loss: 0.6384286
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 0.49947381019592285
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6442709 Best vali loss: 0.6384286
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 0.49553680419921875
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6435096 Best vali loss: 0.6384286
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 0.4973418712615967
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6432731 Best vali loss: 0.6384286
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 0.5005545616149902
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6442136 Best vali loss: 0.6384286

best validation loss 0.6384286338783204

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0873592
	speed: 0.0110s/iter; left time: 20.4189s
	iters: 200, epoch: 1 | loss: 0.8709227
	speed: 0.0049s/iter; left time: 8.6173s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 1.5395464897155762
Epoch: 1, Steps: 245 | Train Loss: 0.9791410 Vali Loss: 0.6142324 Best vali loss: 0.6142324
	iters: 100, epoch: 2 | loss: 0.8823961
	speed: 0.0095s/iter; left time: 15.4167s
	iters: 200, epoch: 2 | loss: 0.6004291
	speed: 0.0048s/iter; left time: 7.2089s
Updating learning rate to 0.00131427676225
Epoch: 2 cost time: 1.2126498222351074
Epoch: 2, Steps: 245 | Train Loss: 0.7414126 Vali Loss: 0.6156083 Best vali loss: 0.6142324
	iters: 100, epoch: 3 | loss: 0.9052472
	speed: 0.0096s/iter; left time: 13.1590s
	iters: 200, epoch: 3 | loss: 0.8247291
	speed: 0.0048s/iter; left time: 6.0619s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 1.2289602756500244
Epoch: 3, Steps: 245 | Train Loss: 0.8649882 Vali Loss: 0.6441520 Best vali loss: 0.6142324

best validation loss 0.6142324282581306

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0893747
	speed: 0.0106s/iter; left time: 40.4011s
	iters: 200, epoch: 1 | loss: 0.9830200
	speed: 0.0045s/iter; left time: 16.8588s
	iters: 300, epoch: 1 | loss: 1.8776864
	speed: 0.0046s/iter; left time: 16.5696s
	iters: 400, epoch: 1 | loss: 1.6139472
	speed: 0.0046s/iter; left time: 16.0634s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.6296).  Saving model state dict ...
Epoch: 1 cost time: 2.5818519592285156
Epoch: 1, Steps: 490 | Train Loss: 1.3910071 Vali Loss: 0.6296116 Best vali loss: 0.6296116
	iters: 100, epoch: 2 | loss: 1.3462584
	speed: 0.0120s/iter; left time: 40.0781s
	iters: 200, epoch: 2 | loss: 0.5645007
	speed: 0.0041s/iter; left time: 13.1781s
	iters: 300, epoch: 2 | loss: 0.3988667
	speed: 0.0042s/iter; left time: 13.0388s
	iters: 400, epoch: 2 | loss: 0.5023317
	speed: 0.0040s/iter; left time: 12.1663s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 2.0549967288970947
Epoch: 2, Steps: 490 | Train Loss: 0.7029894 Vali Loss: 0.6489207 Best vali loss: 0.6296116
	iters: 100, epoch: 3 | loss: 1.2192285
	speed: 0.0116s/iter; left time: 32.8189s
	iters: 200, epoch: 3 | loss: 1.6504675
	speed: 0.0040s/iter; left time: 11.0918s
	iters: 300, epoch: 3 | loss: 0.7880698
	speed: 0.0041s/iter; left time: 10.8360s
	iters: 400, epoch: 3 | loss: 1.0252451
	speed: 0.0041s/iter; left time: 10.4706s
Updating learning rate to 0.001124521370275
Epoch: 3 cost time: 2.0566747188568115
Epoch: 3, Steps: 490 | Train Loss: 1.1707527 Vali Loss: 0.6464700 Best vali loss: 0.6296116

best validation loss 0.6296116115317638

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4722600
	speed: 0.0096s/iter; left time: 36.8451s
	iters: 200, epoch: 1 | loss: 1.1080253
	speed: 0.0036s/iter; left time: 13.4620s
	iters: 300, epoch: 1 | loss: 0.7752842
	speed: 0.0036s/iter; left time: 13.0579s
	iters: 400, epoch: 1 | loss: 0.8584426
	speed: 0.0034s/iter; left time: 12.0372s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.6080).  Saving model state dict ...
Epoch: 1 cost time: 2.095789909362793
Epoch: 1, Steps: 490 | Train Loss: 0.8035030 Vali Loss: 0.6080072 Best vali loss: 0.6080072
	iters: 100, epoch: 2 | loss: 0.7378332
	speed: 0.0100s/iter; left time: 33.1620s
	iters: 200, epoch: 2 | loss: 1.0180970
	speed: 0.0034s/iter; left time: 10.9061s
	iters: 300, epoch: 2 | loss: 0.7033864
	speed: 0.0034s/iter; left time: 10.7135s
	iters: 400, epoch: 2 | loss: 1.0121577
	speed: 0.0034s/iter; left time: 10.3609s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.6080 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 1.7104589939117432
Epoch: 2, Steps: 490 | Train Loss: 0.8678686 Vali Loss: 0.6035977 Best vali loss: 0.6035977
	iters: 100, epoch: 3 | loss: 0.3874836
	speed: 0.0098s/iter; left time: 27.8997s
	iters: 200, epoch: 3 | loss: 0.6220633
	speed: 0.0034s/iter; left time: 9.3568s
	iters: 300, epoch: 3 | loss: 0.9997923
	speed: 0.0032s/iter; left time: 8.5590s
	iters: 400, epoch: 3 | loss: 1.0604683
	speed: 0.0034s/iter; left time: 8.5888s
Updating learning rate to 0.0001187482146823405
Validation loss decreased (0.6036 --> 0.5792).  Saving model state dict ...
Epoch: 3 cost time: 1.7145705223083496
Epoch: 3, Steps: 490 | Train Loss: 0.7674519 Vali Loss: 0.5792136 Best vali loss: 0.5792136

best validation loss 0.5792135723014498

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3953515
	speed: 0.0094s/iter; left time: 21.9874s
	iters: 200, epoch: 4 | loss: 0.9748363
	speed: 0.0036s/iter; left time: 8.0177s
	iters: 300, epoch: 4 | loss: 0.6983349
	speed: 0.0037s/iter; left time: 7.9017s
	iters: 400, epoch: 4 | loss: 0.6158554
	speed: 0.0035s/iter; left time: 7.2567s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 2.073704481124878
Epoch: 4, Steps: 490 | Train Loss: 0.6710945 Vali Loss: 0.5916663 Best vali loss: 0.5792136
	iters: 100, epoch: 5 | loss: 0.6294439
	speed: 0.0100s/iter; left time: 18.6012s
	iters: 200, epoch: 5 | loss: 0.9288768
	speed: 0.0034s/iter; left time: 6.0527s
	iters: 300, epoch: 5 | loss: 0.6832405
	speed: 0.0032s/iter; left time: 5.3891s
	iters: 400, epoch: 5 | loss: 0.8915109
	speed: 0.0032s/iter; left time: 5.0678s
Updating learning rate to 5.30166476176595e-05
Epoch: 5 cost time: 1.6780879497528076
Epoch: 5, Steps: 490 | Train Loss: 0.7832680 Vali Loss: 0.5793927 Best vali loss: 0.5792136
	iters: 100, epoch: 6 | loss: 0.2949459
	speed: 0.0099s/iter; left time: 13.6068s
	iters: 200, epoch: 6 | loss: 0.5764488
	speed: 0.0037s/iter; left time: 4.7295s
	iters: 300, epoch: 6 | loss: 1.0277253
	speed: 0.0037s/iter; left time: 4.3438s
	iters: 400, epoch: 6 | loss: 1.0019473
	speed: 0.0037s/iter; left time: 3.9293s
Updating learning rate to 2.515438169904822e-05
Validation loss decreased (0.5792 --> 0.5758).  Saving model state dict ...
Epoch: 6 cost time: 1.8119440078735352
Epoch: 6, Steps: 490 | Train Loss: 0.7252668 Vali Loss: 0.5758107 Best vali loss: 0.5758107
	iters: 100, epoch: 7 | loss: 0.8386093
	speed: 0.0097s/iter; left time: 8.5309s
	iters: 200, epoch: 7 | loss: 0.6049752
	speed: 0.0034s/iter; left time: 2.6488s
	iters: 300, epoch: 7 | loss: 0.9076607
	speed: 0.0033s/iter; left time: 2.2222s
	iters: 400, epoch: 7 | loss: 0.5461298
	speed: 0.0033s/iter; left time: 1.8962s
Updating learning rate to 6.53741080820523e-06
Validation loss decreased (0.5758 --> 0.5709).  Saving model state dict ...
Epoch: 7 cost time: 1.6838302612304688
Epoch: 7, Steps: 490 | Train Loss: 0.7243437 Vali Loss: 0.5709492 Best vali loss: 0.5709492
	iters: 100, epoch: 8 | loss: 0.8064892
	speed: 0.0095s/iter; left time: 3.7334s
	iters: 200, epoch: 8 | loss: 0.8697260
	speed: 0.0032s/iter; left time: 0.9361s
	iters: 300, epoch: 8 | loss: 1.0616667
	speed: 0.0031s/iter; left time: 0.5936s
	iters: 400, epoch: 8 | loss: 0.7384604
	speed: 0.0031s/iter; left time: 0.2808s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.575465202331543
Epoch: 8, Steps: 490 | Train Loss: 0.8690856 Vali Loss: 0.5767977 Best vali loss: 0.5709492

best validation loss 0.5709491926506127

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6255270
	speed: 0.0098s/iter; left time: 8.6500s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.6257).  Saving model state dict ...
Epoch: 1 cost time: 0.7933459281921387
Epoch: 1, Steps: 123 | Train Loss: 0.6255270 Vali Loss: 0.6256756 Best vali loss: 0.6256756
	iters: 100, epoch: 2 | loss: 0.8165213
	speed: 0.0068s/iter; left time: 5.1729s
Updating learning rate to 0.0009572352247034093
Validation loss decreased (0.6257 --> 0.5927).  Saving model state dict ...
Epoch: 2 cost time: 0.5122725963592529
Epoch: 2, Steps: 123 | Train Loss: 0.8165213 Vali Loss: 0.5926582 Best vali loss: 0.5926582
	iters: 100, epoch: 3 | loss: 0.6167362
	speed: 0.0066s/iter; left time: 4.2401s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 0.4834887981414795
Epoch: 3, Steps: 123 | Train Loss: 0.6167362 Vali Loss: 0.6429960 Best vali loss: 0.5926582
	iters: 100, epoch: 4 | loss: 0.6279167
	speed: 0.0063s/iter; left time: 3.2629s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 0.4718165397644043
Epoch: 4, Steps: 123 | Train Loss: 0.6279167 Vali Loss: 0.6837962 Best vali loss: 0.5926582
	iters: 100, epoch: 5 | loss: 0.7165577
	speed: 0.0064s/iter; left time: 2.5005s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 0.47464728355407715
Epoch: 5, Steps: 123 | Train Loss: 0.7165577 Vali Loss: 0.6972653 Best vali loss: 0.5926582
	iters: 100, epoch: 6 | loss: 0.5537786
	speed: 0.0066s/iter; left time: 1.7856s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 0.492936372756958
Epoch: 6, Steps: 123 | Train Loss: 0.5537786 Vali Loss: 0.7107511 Best vali loss: 0.5926582
	iters: 100, epoch: 7 | loss: 0.4864729
	speed: 0.0066s/iter; left time: 0.9633s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 0.4934673309326172
Epoch: 7, Steps: 123 | Train Loss: 0.4864729 Vali Loss: 0.6982811 Best vali loss: 0.5926582
	iters: 100, epoch: 8 | loss: 0.6774684
	speed: 0.0066s/iter; left time: 0.1576s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5021653175354004
Epoch: 8, Steps: 123 | Train Loss: 0.6774684 Vali Loss: 0.7013592 Best vali loss: 0.5926582

best validation loss 0.592658223955789

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3669400
	speed: 0.0084s/iter; left time: 65.0714s
	iters: 200, epoch: 1 | loss: 1.0899391
	speed: 0.0024s/iter; left time: 18.4056s
	iters: 300, epoch: 1 | loss: 2.2668598
	speed: 0.0023s/iter; left time: 17.6411s
	iters: 400, epoch: 1 | loss: 1.4456425
	speed: 0.0023s/iter; left time: 17.3132s
	iters: 500, epoch: 1 | loss: 0.4185710
	speed: 0.0024s/iter; left time: 17.6925s
	iters: 600, epoch: 1 | loss: 1.5171481
	speed: 0.0024s/iter; left time: 17.2025s
	iters: 700, epoch: 1 | loss: 1.0852828
	speed: 0.0024s/iter; left time: 17.1539s
	iters: 800, epoch: 1 | loss: 0.3866083
	speed: 0.0024s/iter; left time: 16.8292s
	iters: 900, epoch: 1 | loss: 0.7292988
	speed: 0.0024s/iter; left time: 16.5811s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.6605).  Saving model state dict ...
Epoch: 1 cost time: 2.6853244304656982
Epoch: 1, Steps: 979 | Train Loss: 1.0340323 Vali Loss: 0.6605234 Best vali loss: 0.6605234
	iters: 100, epoch: 2 | loss: 0.8431761
	speed: 0.0089s/iter; left time: 59.8869s
	iters: 200, epoch: 2 | loss: 0.5104728
	speed: 0.0023s/iter; left time: 15.2113s
	iters: 300, epoch: 2 | loss: 1.0040751
	speed: 0.0023s/iter; left time: 14.9704s
	iters: 400, epoch: 2 | loss: 1.0646977
	speed: 0.0023s/iter; left time: 14.8382s
	iters: 500, epoch: 2 | loss: 0.6740787
	speed: 0.0023s/iter; left time: 14.5378s
	iters: 600, epoch: 2 | loss: 0.8560758
	speed: 0.0023s/iter; left time: 14.3080s
	iters: 700, epoch: 2 | loss: 0.3480907
	speed: 0.0023s/iter; left time: 14.3648s
	iters: 800, epoch: 2 | loss: 0.3202366
	speed: 0.0024s/iter; left time: 14.3644s
	iters: 900, epoch: 2 | loss: 1.3685505
	speed: 0.0023s/iter; left time: 13.9708s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.6605 --> 0.6324).  Saving model state dict ...
Epoch: 2 cost time: 2.3102784156799316
Epoch: 2, Steps: 979 | Train Loss: 0.7766060 Vali Loss: 0.6324027 Best vali loss: 0.6324027
	iters: 100, epoch: 3 | loss: 1.2020258
	speed: 0.0089s/iter; left time: 51.5574s
	iters: 200, epoch: 3 | loss: 0.6650561
	speed: 0.0023s/iter; left time: 12.9392s
	iters: 300, epoch: 3 | loss: 0.9050957
	speed: 0.0024s/iter; left time: 13.1231s
	iters: 400, epoch: 3 | loss: 1.1488576
	speed: 0.0024s/iter; left time: 13.1380s
	iters: 500, epoch: 3 | loss: 1.4972460
	speed: 0.0024s/iter; left time: 13.0893s
	iters: 600, epoch: 3 | loss: 0.6070856
	speed: 0.0023s/iter; left time: 12.3346s
	iters: 700, epoch: 3 | loss: 1.4209853
	speed: 0.0024s/iter; left time: 12.2507s
	iters: 800, epoch: 3 | loss: 0.3254345
	speed: 0.0024s/iter; left time: 12.0068s
	iters: 900, epoch: 3 | loss: 0.6542218
	speed: 0.0023s/iter; left time: 11.6152s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.6324 --> 0.6198).  Saving model state dict ...
Epoch: 3 cost time: 2.3717281818389893
Epoch: 3, Steps: 979 | Train Loss: 0.9362232 Vali Loss: 0.6197961 Best vali loss: 0.6197961
	iters: 100, epoch: 4 | loss: 0.8216932
	speed: 0.0087s/iter; left time: 41.9119s
	iters: 200, epoch: 4 | loss: 0.2930053
	speed: 0.0024s/iter; left time: 11.3436s
	iters: 300, epoch: 4 | loss: 1.5456034
	speed: 0.0023s/iter; left time: 10.7920s
	iters: 400, epoch: 4 | loss: 1.4539295
	speed: 0.0023s/iter; left time: 10.5331s
	iters: 500, epoch: 4 | loss: 0.6714984
	speed: 0.0024s/iter; left time: 10.4392s
	iters: 600, epoch: 4 | loss: 0.5479513
	speed: 0.0024s/iter; left time: 10.1863s
	iters: 700, epoch: 4 | loss: 0.8247321
	speed: 0.0024s/iter; left time: 10.0969s
	iters: 800, epoch: 4 | loss: 0.3956457
	speed: 0.0023s/iter; left time: 9.5240s
	iters: 900, epoch: 4 | loss: 1.2621766
	speed: 0.0023s/iter; left time: 9.1129s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.6198 --> 0.6126).  Saving model state dict ...
Epoch: 4 cost time: 2.353780508041382
Epoch: 4, Steps: 979 | Train Loss: 0.8684706 Vali Loss: 0.6125663 Best vali loss: 0.6125663
	iters: 100, epoch: 5 | loss: 0.3690605
	speed: 0.0085s/iter; left time: 32.5074s
	iters: 200, epoch: 5 | loss: 0.6541413
	speed: 0.0023s/iter; left time: 8.5323s
	iters: 300, epoch: 5 | loss: 1.3857880
	speed: 0.0023s/iter; left time: 8.2845s
	iters: 400, epoch: 5 | loss: 1.4199719
	speed: 0.0023s/iter; left time: 7.9440s
	iters: 500, epoch: 5 | loss: 0.7677814
	speed: 0.0023s/iter; left time: 7.7792s
	iters: 600, epoch: 5 | loss: 0.8176607
	speed: 0.0022s/iter; left time: 7.3957s
	iters: 700, epoch: 5 | loss: 1.6506568
	speed: 0.0024s/iter; left time: 7.5943s
	iters: 800, epoch: 5 | loss: 0.4684058
	speed: 0.0024s/iter; left time: 7.4123s
	iters: 900, epoch: 5 | loss: 0.5618960
	speed: 0.0023s/iter; left time: 6.8685s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.6126 --> 0.6097).  Saving model state dict ...
Epoch: 5 cost time: 2.283872365951538
Epoch: 5, Steps: 979 | Train Loss: 0.8994847 Vali Loss: 0.6096801 Best vali loss: 0.6096801
	iters: 100, epoch: 6 | loss: 0.2841910
	speed: 0.0089s/iter; left time: 25.1190s
	iters: 200, epoch: 6 | loss: 0.1929577
	speed: 0.0023s/iter; left time: 6.3116s
	iters: 300, epoch: 6 | loss: 0.8004982
	speed: 0.0023s/iter; left time: 6.0705s
	iters: 400, epoch: 6 | loss: 1.3766426
	speed: 0.0024s/iter; left time: 5.9947s
	iters: 500, epoch: 6 | loss: 0.6398773
	speed: 0.0023s/iter; left time: 5.5908s
	iters: 600, epoch: 6 | loss: 0.8821185
	speed: 0.0024s/iter; left time: 5.5089s
	iters: 700, epoch: 6 | loss: 0.4423704
	speed: 0.0023s/iter; left time: 5.1965s
	iters: 800, epoch: 6 | loss: 1.2016762
	speed: 0.0023s/iter; left time: 4.9673s
	iters: 900, epoch: 6 | loss: 0.8393733
	speed: 0.0023s/iter; left time: 4.7202s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.6097 --> 0.6081).  Saving model state dict ...
Epoch: 6 cost time: 2.3283824920654297
Epoch: 6, Steps: 979 | Train Loss: 0.7399672 Vali Loss: 0.6081238 Best vali loss: 0.6081238
	iters: 100, epoch: 7 | loss: 1.5542837
	speed: 0.0088s/iter; left time: 16.3686s
	iters: 200, epoch: 7 | loss: 0.6749647
	speed: 0.0023s/iter; left time: 4.0635s
	iters: 300, epoch: 7 | loss: 0.6875260
	speed: 0.0024s/iter; left time: 4.0028s
	iters: 400, epoch: 7 | loss: 1.1496406
	speed: 0.0023s/iter; left time: 3.6570s
	iters: 500, epoch: 7 | loss: 1.0286915
	speed: 0.0023s/iter; left time: 3.4111s
	iters: 600, epoch: 7 | loss: 1.4970345
	speed: 0.0023s/iter; left time: 3.1402s
	iters: 700, epoch: 7 | loss: 1.1968461
	speed: 0.0023s/iter; left time: 2.9038s
	iters: 800, epoch: 7 | loss: 0.6211924
	speed: 0.0023s/iter; left time: 2.6599s
	iters: 900, epoch: 7 | loss: 1.3848803
	speed: 0.0023s/iter; left time: 2.4359s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.6081 --> 0.6075).  Saving model state dict ...
Epoch: 7 cost time: 2.3332066535949707
Epoch: 7, Steps: 979 | Train Loss: 1.0883400 Vali Loss: 0.6074691 Best vali loss: 0.6074691
	iters: 100, epoch: 8 | loss: 0.6467670
	speed: 0.0089s/iter; left time: 7.7932s
	iters: 200, epoch: 8 | loss: 0.8372874
	speed: 0.0025s/iter; left time: 1.9624s
	iters: 300, epoch: 8 | loss: 0.3214650
	speed: 0.0025s/iter; left time: 1.6839s
	iters: 400, epoch: 8 | loss: 1.0277750
	speed: 0.0024s/iter; left time: 1.4184s
	iters: 500, epoch: 8 | loss: 0.9231015
	speed: 0.0025s/iter; left time: 1.2150s
	iters: 600, epoch: 8 | loss: 0.7831371
	speed: 0.0024s/iter; left time: 0.9007s
	iters: 700, epoch: 8 | loss: 0.4786863
	speed: 0.0024s/iter; left time: 0.6661s
	iters: 800, epoch: 8 | loss: 0.6543583
	speed: 0.0024s/iter; left time: 0.4292s
	iters: 900, epoch: 8 | loss: 0.6885794
	speed: 0.0024s/iter; left time: 0.1907s
Updating learning rate to 0.0
Validation loss decreased (0.6075 --> 0.6073).  Saving model state dict ...
Epoch: 8 cost time: 2.437847375869751
Epoch: 8, Steps: 979 | Train Loss: 0.7067952 Vali Loss: 0.6072811 Best vali loss: 0.6072811

best validation loss 0.6072811475786442

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5488361
	speed: 0.0087s/iter; left time: 33.1350s
	iters: 200, epoch: 1 | loss: 0.9104599
	speed: 0.0028s/iter; left time: 10.3003s
	iters: 300, epoch: 1 | loss: 0.8165500
	speed: 0.0027s/iter; left time: 9.6289s
	iters: 400, epoch: 1 | loss: 0.8647278
	speed: 0.0025s/iter; left time: 8.8932s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.5970).  Saving model state dict ...
Epoch: 1 cost time: 1.6416049003601074
Epoch: 1, Steps: 490 | Train Loss: 0.7851434 Vali Loss: 0.5969615 Best vali loss: 0.5969615
	iters: 100, epoch: 2 | loss: 1.3703148
	speed: 0.0081s/iter; left time: 27.0720s
	iters: 200, epoch: 2 | loss: 1.1077530
	speed: 0.0026s/iter; left time: 8.3259s
	iters: 300, epoch: 2 | loss: 1.0163432
	speed: 0.0026s/iter; left time: 8.2849s
	iters: 400, epoch: 2 | loss: 0.7814420
	speed: 0.0027s/iter; left time: 8.0829s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 1.3382060527801514
Epoch: 2, Steps: 490 | Train Loss: 1.0689633 Vali Loss: 0.6065319 Best vali loss: 0.5969615
	iters: 100, epoch: 3 | loss: 0.6883507
	speed: 0.0082s/iter; left time: 23.2960s
	iters: 200, epoch: 3 | loss: 1.3268162
	speed: 0.0026s/iter; left time: 7.0788s
	iters: 300, epoch: 3 | loss: 1.1940416
	speed: 0.0025s/iter; left time: 6.7251s
	iters: 400, epoch: 3 | loss: 0.8334951
	speed: 0.0025s/iter; left time: 6.4608s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.3128776550292969
Epoch: 3, Steps: 490 | Train Loss: 1.0106759 Vali Loss: 0.6255814 Best vali loss: 0.5969615

best validation loss 0.5969614789255346

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 0.7314457893371582
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6023024 Best vali loss: 0.6023024
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 0.4555389881134033
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6360082 Best vali loss: 0.6023024
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 0.450577974319458
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6119794 Best vali loss: 0.6023024

best validation loss 0.6023024492989751

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9083424
	speed: 0.0095s/iter; left time: 8.4406s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 0.7781035900115967
Epoch: 1, Steps: 123 | Train Loss: 0.9083424 Vali Loss: 0.6080645 Best vali loss: 0.6080645
	iters: 100, epoch: 2 | loss: 0.6621289
	speed: 0.0066s/iter; left time: 5.0351s
Updating learning rate to 0.00093122262415
Epoch: 2 cost time: 0.5176656246185303
Epoch: 2, Steps: 123 | Train Loss: 0.6621289 Vali Loss: 0.6117494 Best vali loss: 0.6080645
	iters: 100, epoch: 3 | loss: 0.7142416
	speed: 0.0068s/iter; left time: 4.3517s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.5088834762573242
Epoch: 3, Steps: 123 | Train Loss: 0.7142416 Vali Loss: 0.6160212 Best vali loss: 0.6080645

best validation loss 0.608064544002307

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4767892
	speed: 0.0086s/iter; left time: 20.3319s
	iters: 200, epoch: 4 | loss: 0.8665721
	speed: 0.0027s/iter; left time: 6.0080s
	iters: 300, epoch: 4 | loss: 0.8068974
	speed: 0.0026s/iter; left time: 5.6224s
	iters: 400, epoch: 4 | loss: 0.8258692
	speed: 0.0026s/iter; left time: 5.3567s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 1.6437125205993652
Epoch: 4, Steps: 490 | Train Loss: 0.7440320 Vali Loss: 0.6270356 Best vali loss: 0.5969615
	iters: 100, epoch: 5 | loss: 1.2741219
	speed: 0.0081s/iter; left time: 15.0425s
	iters: 200, epoch: 5 | loss: 0.9830168
	speed: 0.0025s/iter; left time: 4.4484s
	iters: 300, epoch: 5 | loss: 0.8313431
	speed: 0.0025s/iter; left time: 4.1950s
	iters: 400, epoch: 5 | loss: 0.6813534
	speed: 0.0026s/iter; left time: 3.9880s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 1.2891192436218262
Epoch: 5, Steps: 490 | Train Loss: 0.9424588 Vali Loss: 0.6222866 Best vali loss: 0.5969615
	iters: 100, epoch: 6 | loss: 0.6372730
	speed: 0.0079s/iter; left time: 10.8923s
	iters: 200, epoch: 6 | loss: 1.2259952
	speed: 0.0025s/iter; left time: 3.1171s
	iters: 300, epoch: 6 | loss: 0.9341689
	speed: 0.0025s/iter; left time: 2.9062s
	iters: 400, epoch: 6 | loss: 0.7024385
	speed: 0.0025s/iter; left time: 2.6484s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 1.2612965106964111
Epoch: 6, Steps: 490 | Train Loss: 0.8749689 Vali Loss: 0.6341988 Best vali loss: 0.5969615
	iters: 100, epoch: 7 | loss: 0.8013918
	speed: 0.0077s/iter; left time: 6.7965s
	iters: 200, epoch: 7 | loss: 0.5973569
	speed: 0.0027s/iter; left time: 2.1232s
	iters: 300, epoch: 7 | loss: 0.4326625
	speed: 0.0026s/iter; left time: 1.7690s
	iters: 400, epoch: 7 | loss: 0.8441743
	speed: 0.0026s/iter; left time: 1.5072s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 1.316852331161499
Epoch: 7, Steps: 490 | Train Loss: 0.6688964 Vali Loss: 0.6442538 Best vali loss: 0.5969615
	iters: 100, epoch: 8 | loss: 0.5052016
	speed: 0.0078s/iter; left time: 3.0550s
	iters: 200, epoch: 8 | loss: 0.6362518
	speed: 0.0025s/iter; left time: 0.7319s
	iters: 300, epoch: 8 | loss: 1.1664357
	speed: 0.0025s/iter; left time: 0.4855s
	iters: 400, epoch: 8 | loss: 0.7650482
	speed: 0.0025s/iter; left time: 0.2312s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.289963722229004
Epoch: 8, Steps: 490 | Train Loss: 0.7682343 Vali Loss: 0.6360034 Best vali loss: 0.5969615

best validation loss 0.5969614789255346

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7298276
	speed: 0.0122s/iter; left time: 10.8156s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.6893).  Saving model state dict ...
Epoch: 1 cost time: 1.1146762371063232
Epoch: 1, Steps: 123 | Train Loss: 0.7298276 Vali Loss: 0.6892920 Best vali loss: 0.6892920
	iters: 100, epoch: 2 | loss: 0.8042785
	speed: 0.0092s/iter; left time: 7.0372s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.6893 --> 0.6669).  Saving model state dict ...
Epoch: 2 cost time: 0.7451848983764648
Epoch: 2, Steps: 123 | Train Loss: 0.8042785 Vali Loss: 0.6668589 Best vali loss: 0.6668589
	iters: 100, epoch: 3 | loss: 0.7262220
	speed: 0.0090s/iter; left time: 5.7319s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.6669 --> 0.6577).  Saving model state dict ...
Epoch: 3 cost time: 0.7218892574310303
Epoch: 3, Steps: 123 | Train Loss: 0.7262220 Vali Loss: 0.6577387 Best vali loss: 0.6577387
	iters: 100, epoch: 4 | loss: 0.9470800
	speed: 0.0090s/iter; left time: 4.6301s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.6577 --> 0.6540).  Saving model state dict ...
Epoch: 4 cost time: 0.7307422161102295
Epoch: 4, Steps: 123 | Train Loss: 0.9470800 Vali Loss: 0.6539880 Best vali loss: 0.6539880
	iters: 100, epoch: 5 | loss: 0.8880276
	speed: 0.0093s/iter; left time: 3.6668s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.6540 --> 0.6522).  Saving model state dict ...
Epoch: 5 cost time: 0.7448329925537109
Epoch: 5, Steps: 123 | Train Loss: 0.8880276 Vali Loss: 0.6521990 Best vali loss: 0.6521990
	iters: 100, epoch: 6 | loss: 0.7166625
	speed: 0.0092s/iter; left time: 2.4968s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.6522 --> 0.6512).  Saving model state dict ...
Epoch: 6 cost time: 0.7660343647003174
Epoch: 6, Steps: 123 | Train Loss: 0.7166625 Vali Loss: 0.6512492 Best vali loss: 0.6512492
	iters: 100, epoch: 7 | loss: 1.0188190
	speed: 0.0092s/iter; left time: 1.3458s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.6512 --> 0.6508).  Saving model state dict ...
Epoch: 7 cost time: 0.7526793479919434
Epoch: 7, Steps: 123 | Train Loss: 1.0188190 Vali Loss: 0.6507832 Best vali loss: 0.6507832
	iters: 100, epoch: 8 | loss: 0.8727856
	speed: 0.0092s/iter; left time: 0.2205s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.6508 --> 0.6506).  Saving model state dict ...
Epoch: 8 cost time: 0.7476348876953125
Epoch: 8, Steps: 123 | Train Loss: 0.8727856 Vali Loss: 0.6505579 Best vali loss: 0.6505579

best validation loss 0.6505579168131262

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1229898
	speed: 0.0110s/iter; left time: 85.1161s
	iters: 200, epoch: 1 | loss: 0.6842577
	speed: 0.0050s/iter; left time: 38.2413s
	iters: 300, epoch: 1 | loss: 0.6314104
	speed: 0.0046s/iter; left time: 35.0032s
	iters: 400, epoch: 1 | loss: 1.3943937
	speed: 0.0051s/iter; left time: 38.0955s
	iters: 500, epoch: 1 | loss: 0.3469688
	speed: 0.0052s/iter; left time: 37.9307s
	iters: 600, epoch: 1 | loss: 1.1916485
	speed: 0.0052s/iter; left time: 37.4438s
	iters: 700, epoch: 1 | loss: 0.7797660
	speed: 0.0052s/iter; left time: 36.7610s
	iters: 800, epoch: 1 | loss: 1.1259617
	speed: 0.0051s/iter; left time: 36.0841s
	iters: 900, epoch: 1 | loss: 1.6351322
	speed: 0.0052s/iter; left time: 35.9654s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.6143).  Saving model state dict ...
Epoch: 1 cost time: 5.305380582809448
Epoch: 1, Steps: 979 | Train Loss: 0.9902810 Vali Loss: 0.6142982 Best vali loss: 0.6142982
	iters: 100, epoch: 2 | loss: 0.7287021
	speed: 0.0147s/iter; left time: 99.3721s
	iters: 200, epoch: 2 | loss: 0.8648013
	speed: 0.0047s/iter; left time: 31.1689s
	iters: 300, epoch: 2 | loss: 1.1433771
	speed: 0.0047s/iter; left time: 30.5917s
	iters: 400, epoch: 2 | loss: 0.2986928
	speed: 0.0047s/iter; left time: 30.2031s
	iters: 500, epoch: 2 | loss: 0.8609083
	speed: 0.0045s/iter; left time: 28.6067s
	iters: 600, epoch: 2 | loss: 0.5790685
	speed: 0.0046s/iter; left time: 28.5190s
	iters: 700, epoch: 2 | loss: 1.1690422
	speed: 0.0046s/iter; left time: 28.3649s
	iters: 800, epoch: 2 | loss: 0.2726389
	speed: 0.0046s/iter; left time: 27.5554s
	iters: 900, epoch: 2 | loss: 0.6607988
	speed: 0.0047s/iter; left time: 28.1396s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.6143 --> 0.6126).  Saving model state dict ...
Epoch: 2 cost time: 4.571288108825684
Epoch: 2, Steps: 979 | Train Loss: 0.7308922 Vali Loss: 0.6126452 Best vali loss: 0.6126452
	iters: 100, epoch: 3 | loss: 0.2902883
	speed: 0.0146s/iter; left time: 84.2323s
	iters: 200, epoch: 3 | loss: 1.0740634
	speed: 0.0048s/iter; left time: 27.0990s
	iters: 300, epoch: 3 | loss: 0.5474721
	speed: 0.0046s/iter; left time: 25.7125s
	iters: 400, epoch: 3 | loss: 0.3432440
	speed: 0.0047s/iter; left time: 25.9491s
	iters: 500, epoch: 3 | loss: 1.1718125
	speed: 0.0046s/iter; left time: 24.6132s
	iters: 600, epoch: 3 | loss: 1.0101314
	speed: 0.0047s/iter; left time: 24.8021s
	iters: 700, epoch: 3 | loss: 1.4803792
	speed: 0.0047s/iter; left time: 24.3867s
	iters: 800, epoch: 3 | loss: 0.4199820
	speed: 0.0047s/iter; left time: 23.9751s
	iters: 900, epoch: 3 | loss: 1.7118926
	speed: 0.0047s/iter; left time: 23.5179s
Updating learning rate to 0.002771304313062916
Validation loss decreased (0.6126 --> 0.6055).  Saving model state dict ...
Epoch: 3 cost time: 4.652053356170654
Epoch: 3, Steps: 979 | Train Loss: 0.8943628 Vali Loss: 0.6055256 Best vali loss: 0.6055256
	iters: 100, epoch: 4 | loss: 0.3757310
	speed: 0.0143s/iter; left time: 68.6627s
	iters: 200, epoch: 4 | loss: 0.8577887
	speed: 0.0047s/iter; left time: 21.9902s
	iters: 300, epoch: 4 | loss: 0.6990990
	speed: 0.0046s/iter; left time: 21.2017s
	iters: 400, epoch: 4 | loss: 1.1321032
	speed: 0.0046s/iter; left time: 20.5243s
	iters: 500, epoch: 4 | loss: 0.7069370
	speed: 0.0046s/iter; left time: 20.3176s
	iters: 600, epoch: 4 | loss: 0.9040940
	speed: 0.0044s/iter; left time: 18.8429s
	iters: 700, epoch: 4 | loss: 1.1558371
	speed: 0.0045s/iter; left time: 19.0226s
	iters: 800, epoch: 4 | loss: 0.7610879
	speed: 0.0045s/iter; left time: 18.5901s
	iters: 900, epoch: 4 | loss: 0.3367952
	speed: 0.0045s/iter; left time: 18.0745s
Updating learning rate to 0.00200429414875
Epoch: 4 cost time: 4.480859756469727
Epoch: 4, Steps: 979 | Train Loss: 0.7699415 Vali Loss: 0.6083807 Best vali loss: 0.6055256
	iters: 100, epoch: 5 | loss: 0.5953571
	speed: 0.0141s/iter; left time: 53.8297s
	iters: 200, epoch: 5 | loss: 0.6357927
	speed: 0.0046s/iter; left time: 16.9276s
	iters: 300, epoch: 5 | loss: 1.0196728
	speed: 0.0045s/iter; left time: 16.4445s
	iters: 400, epoch: 5 | loss: 0.5541417
	speed: 0.0046s/iter; left time: 16.1450s
	iters: 500, epoch: 5 | loss: 1.0797904
	speed: 0.0047s/iter; left time: 16.0871s
	iters: 600, epoch: 5 | loss: 0.6595044
	speed: 0.0046s/iter; left time: 15.3125s
	iters: 700, epoch: 5 | loss: 0.5038588
	speed: 0.0047s/iter; left time: 15.0207s
	iters: 800, epoch: 5 | loss: 0.3369835
	speed: 0.0046s/iter; left time: 14.4030s
	iters: 900, epoch: 5 | loss: 1.3660065
	speed: 0.0045s/iter; left time: 13.4485s
Updating learning rate to 0.0012372839844370842
Validation loss decreased (0.6055 --> 0.5990).  Saving model state dict ...
Epoch: 5 cost time: 4.534390211105347
Epoch: 5, Steps: 979 | Train Loss: 0.7501231 Vali Loss: 0.5989870 Best vali loss: 0.5989870
	iters: 100, epoch: 6 | loss: 0.7439830
	speed: 0.0147s/iter; left time: 41.6414s
	iters: 200, epoch: 6 | loss: 0.8540804
	speed: 0.0050s/iter; left time: 13.7142s
	iters: 300, epoch: 6 | loss: 1.5121986
	speed: 0.0048s/iter; left time: 12.6715s
	iters: 400, epoch: 6 | loss: 1.5619112
	speed: 0.0051s/iter; left time: 12.8806s
	iters: 500, epoch: 6 | loss: 0.6209517
	speed: 0.0048s/iter; left time: 11.7823s
	iters: 600, epoch: 6 | loss: 0.9752753
	speed: 0.0050s/iter; left time: 11.7882s
	iters: 700, epoch: 6 | loss: 0.8338780
	speed: 0.0050s/iter; left time: 11.2457s
	iters: 800, epoch: 6 | loss: 1.0139488
	speed: 0.0049s/iter; left time: 10.5199s
	iters: 900, epoch: 6 | loss: 0.2948795
	speed: 0.0050s/iter; left time: 10.1347s
Updating learning rate to 0.0005870441646763563
Epoch: 6 cost time: 4.881351709365845
Epoch: 6, Steps: 979 | Train Loss: 0.9345674 Vali Loss: 0.6137513 Best vali loss: 0.5989870
	iters: 100, epoch: 7 | loss: 0.2573412
	speed: 0.0152s/iter; left time: 28.3365s
	iters: 200, epoch: 7 | loss: 0.5914881
	speed: 0.0047s/iter; left time: 8.2274s
	iters: 300, epoch: 7 | loss: 0.5750077
	speed: 0.0047s/iter; left time: 7.8336s
	iters: 400, epoch: 7 | loss: 0.3979648
	speed: 0.0047s/iter; left time: 7.4026s
	iters: 500, epoch: 7 | loss: 0.5911593
	speed: 0.0047s/iter; left time: 6.8453s
	iters: 600, epoch: 7 | loss: 0.2328245
	speed: 0.0047s/iter; left time: 6.3322s
	iters: 700, epoch: 7 | loss: 1.0323642
	speed: 0.0047s/iter; left time: 5.9151s
	iters: 800, epoch: 7 | loss: 0.8218923
	speed: 0.0047s/iter; left time: 5.4674s
	iters: 900, epoch: 7 | loss: 1.2523628
	speed: 0.0047s/iter; left time: 4.9790s
Updating learning rate to 0.0001525678075877426
Validation loss decreased (0.5990 --> 0.5989).  Saving model state dict ...
Epoch: 7 cost time: 4.631416082382202
Epoch: 7, Steps: 979 | Train Loss: 0.6391561 Vali Loss: 0.5989495 Best vali loss: 0.5989495
	iters: 100, epoch: 8 | loss: 0.3043996
	speed: 0.0143s/iter; left time: 12.5927s
	iters: 200, epoch: 8 | loss: 0.4575082
	speed: 0.0047s/iter; left time: 3.6605s
	iters: 300, epoch: 8 | loss: 0.5320931
	speed: 0.0047s/iter; left time: 3.1840s
	iters: 400, epoch: 8 | loss: 0.4082665
	speed: 0.0047s/iter; left time: 2.7359s
	iters: 500, epoch: 8 | loss: 0.4653433
	speed: 0.0047s/iter; left time: 2.2538s
	iters: 600, epoch: 8 | loss: 0.2866594
	speed: 0.0047s/iter; left time: 1.7893s
	iters: 700, epoch: 8 | loss: 1.5052288
	speed: 0.0046s/iter; left time: 1.2757s
	iters: 800, epoch: 8 | loss: 0.2258676
	speed: 0.0045s/iter; left time: 0.8181s
	iters: 900, epoch: 8 | loss: 0.3966605
	speed: 0.0046s/iter; left time: 0.3708s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.601546049118042
Epoch: 8, Steps: 979 | Train Loss: 0.5091141 Vali Loss: 0.6044970 Best vali loss: 0.5989495

best validation loss 0.5989495160015906

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.7023).  Saving model state dict ...
Epoch: 1 cost time: 0.769688606262207
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7023241 Best vali loss: 0.7023241
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.7023 --> 0.6906).  Saving model state dict ...
Epoch: 2 cost time: 0.4821927547454834
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6905501 Best vali loss: 0.6905501
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.6906 --> 0.6844).  Saving model state dict ...
Epoch: 3 cost time: 0.5168068408966064
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6843642 Best vali loss: 0.6843642

best validation loss 0.6843642090162377

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9864634
	speed: 0.0138s/iter; left time: 12.2023s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 1.3059873580932617
Epoch: 1, Steps: 123 | Train Loss: 0.9864634 Vali Loss: 0.6489548 Best vali loss: 0.6489548
	iters: 100, epoch: 2 | loss: 0.9342741
	speed: 0.0123s/iter; left time: 9.3510s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 0.9903969764709473
Epoch: 2, Steps: 123 | Train Loss: 0.9342741 Vali Loss: 0.6536773 Best vali loss: 0.6489548
	iters: 100, epoch: 3 | loss: 0.9002891
	speed: 0.0119s/iter; left time: 7.5887s
Updating learning rate to 0.0019497966725057021
Validation loss decreased (0.6490 --> 0.6308).  Saving model state dict ...
Epoch: 3 cost time: 0.9886758327484131
Epoch: 3, Steps: 123 | Train Loss: 0.9002891 Vali Loss: 0.6308338 Best vali loss: 0.6308338

best validation loss 0.6308337723916463

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9795899
	speed: 0.0114s/iter; left time: 21.2301s
	iters: 200, epoch: 1 | loss: 0.9814952
	speed: 0.0055s/iter; left time: 9.6634s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 1.6780407428741455
Epoch: 1, Steps: 245 | Train Loss: 0.9805425 Vali Loss: 0.6099366 Best vali loss: 0.6099366
	iters: 100, epoch: 2 | loss: 0.8904633
	speed: 0.0106s/iter; left time: 17.2093s
	iters: 200, epoch: 2 | loss: 0.4917381
	speed: 0.0052s/iter; left time: 7.9517s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.6099 --> 0.6009).  Saving model state dict ...
Epoch: 2 cost time: 1.3361485004425049
Epoch: 2, Steps: 245 | Train Loss: 0.6911007 Vali Loss: 0.6008632 Best vali loss: 0.6008632
	iters: 100, epoch: 3 | loss: 0.5471919
	speed: 0.0102s/iter; left time: 14.0307s
	iters: 200, epoch: 3 | loss: 0.9876345
	speed: 0.0055s/iter; left time: 7.0331s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 1.3618011474609375
Epoch: 3, Steps: 245 | Train Loss: 0.7674132 Vali Loss: 0.6283531 Best vali loss: 0.6008632

best validation loss 0.6008632414763528

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9662765
	speed: 0.0114s/iter; left time: 12.7907s
	iters: 200, epoch: 4 | loss: 0.9064848
	speed: 0.0055s/iter; left time: 5.6888s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 1.6800456047058105
Epoch: 4, Steps: 245 | Train Loss: 0.9363807 Vali Loss: 0.6009239 Best vali loss: 0.6008632
	iters: 100, epoch: 5 | loss: 0.7862912
	speed: 0.0106s/iter; left time: 9.3120s
	iters: 200, epoch: 5 | loss: 0.4628003
	speed: 0.0056s/iter; left time: 4.3418s
Updating learning rate to 0.00010198984921612144
Validation loss decreased (0.6009 --> 0.5788).  Saving model state dict ...
Epoch: 5 cost time: 1.398974895477295
Epoch: 5, Steps: 245 | Train Loss: 0.6245457 Vali Loss: 0.5787884 Best vali loss: 0.5787884
	iters: 100, epoch: 6 | loss: 0.4980102
	speed: 0.0108s/iter; left time: 6.8912s
	iters: 200, epoch: 6 | loss: 0.9651957
	speed: 0.0055s/iter; left time: 2.9669s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 1.418262004852295
Epoch: 6, Steps: 245 | Train Loss: 0.7316030 Vali Loss: 0.5794349 Best vali loss: 0.5787884
	iters: 100, epoch: 7 | loss: 0.5172390
	speed: 0.0107s/iter; left time: 4.1950s
	iters: 200, epoch: 7 | loss: 0.9373893
	speed: 0.0056s/iter; left time: 1.6219s
Updating learning rate to 1.2576229779768348e-05
Validation loss decreased (0.5788 --> 0.5677).  Saving model state dict ...
Epoch: 7 cost time: 1.4171388149261475
Epoch: 7, Steps: 245 | Train Loss: 0.7273141 Vali Loss: 0.5677318 Best vali loss: 0.5677318
	iters: 100, epoch: 8 | loss: 0.4771596
	speed: 0.0107s/iter; left time: 1.5692s
	iters: 200, epoch: 8 | loss: 0.7972421
	speed: 0.0056s/iter; left time: 0.2561s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4115324020385742
Epoch: 8, Steps: 245 | Train Loss: 0.6372008 Vali Loss: 0.5710406 Best vali loss: 0.5677318

best validation loss 0.567731796481553

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8322867
	speed: 0.0100s/iter; left time: 18.5538s
	iters: 200, epoch: 1 | loss: 0.8576851
	speed: 0.0037s/iter; left time: 6.5036s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.6422).  Saving model state dict ...
Epoch: 1 cost time: 1.2739875316619873
Epoch: 1, Steps: 245 | Train Loss: 0.8449859 Vali Loss: 0.6421780 Best vali loss: 0.6421780
	iters: 100, epoch: 2 | loss: 1.1132956
	speed: 0.0079s/iter; left time: 12.7116s
	iters: 200, epoch: 2 | loss: 0.5623901
	speed: 0.0036s/iter; left time: 5.4202s
Updating learning rate to 0.00132457724675
Validation loss decreased (0.6422 --> 0.6125).  Saving model state dict ...
Epoch: 2 cost time: 0.9252364635467529
Epoch: 2, Steps: 245 | Train Loss: 0.8378429 Vali Loss: 0.6125425 Best vali loss: 0.6125425
	iters: 100, epoch: 3 | loss: 1.4260246
	speed: 0.0081s/iter; left time: 11.0948s
	iters: 200, epoch: 3 | loss: 0.8295649
	speed: 0.0039s/iter; left time: 4.8996s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 1.005356788635254
Epoch: 3, Steps: 245 | Train Loss: 1.1277947 Vali Loss: 0.6152249 Best vali loss: 0.6125425
	iters: 100, epoch: 4 | loss: 0.8607835
	speed: 0.0077s/iter; left time: 8.6889s
	iters: 200, epoch: 4 | loss: 0.6067667
	speed: 0.0037s/iter; left time: 3.8199s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 0.938274621963501
Epoch: 4, Steps: 245 | Train Loss: 0.7337751 Vali Loss: 0.6212106 Best vali loss: 0.6125425
	iters: 100, epoch: 5 | loss: 0.6904489
	speed: 0.0077s/iter; left time: 6.8113s
	iters: 200, epoch: 5 | loss: 0.5999576
	speed: 0.0038s/iter; left time: 2.9645s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 0.9584994316101074
Epoch: 5, Steps: 245 | Train Loss: 0.6452033 Vali Loss: 0.6584342 Best vali loss: 0.6125425
	iters: 100, epoch: 6 | loss: 0.9237863
	speed: 0.0081s/iter; left time: 5.1357s
	iters: 200, epoch: 6 | loss: 0.7776871
	speed: 0.0040s/iter; left time: 2.1374s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 1.0173637866973877
Epoch: 6, Steps: 245 | Train Loss: 0.8507367 Vali Loss: 0.6514942 Best vali loss: 0.6125425
	iters: 100, epoch: 7 | loss: 0.6325665
	speed: 0.0079s/iter; left time: 3.0726s
	iters: 200, epoch: 7 | loss: 0.7297678
	speed: 0.0036s/iter; left time: 1.0621s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 0.9446470737457275
Epoch: 7, Steps: 245 | Train Loss: 0.6811671 Vali Loss: 0.6575045 Best vali loss: 0.6125425
	iters: 100, epoch: 8 | loss: 0.7240881
	speed: 0.0076s/iter; left time: 1.1165s
	iters: 200, epoch: 8 | loss: 0.8473750
	speed: 0.0036s/iter; left time: 0.1672s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 0.9343922138214111
Epoch: 8, Steps: 245 | Train Loss: 0.7857316 Vali Loss: 0.6555248 Best vali loss: 0.6125425

best validation loss 0.6125425465787687

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0531026
	speed: 0.0101s/iter; left time: 18.7675s
	iters: 200, epoch: 1 | loss: 0.9411644
	speed: 0.0040s/iter; left time: 7.0852s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.6567).  Saving model state dict ...
Epoch: 1 cost time: 1.3171300888061523
Epoch: 1, Steps: 245 | Train Loss: 0.9971335 Vali Loss: 0.6566760 Best vali loss: 0.6566760
	iters: 100, epoch: 2 | loss: 1.2253671
	speed: 0.0078s/iter; left time: 12.5469s
	iters: 200, epoch: 2 | loss: 0.6172056
	speed: 0.0037s/iter; left time: 5.6378s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.6567 --> 0.6258).  Saving model state dict ...
Epoch: 2 cost time: 0.9428908824920654
Epoch: 2, Steps: 245 | Train Loss: 0.9212863 Vali Loss: 0.6258133 Best vali loss: 0.6258133
	iters: 100, epoch: 3 | loss: 0.9084243
	speed: 0.0075s/iter; left time: 10.3215s
	iters: 200, epoch: 3 | loss: 1.1467143
	speed: 0.0034s/iter; left time: 4.3210s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.6258 --> 0.6132).  Saving model state dict ...
Epoch: 3 cost time: 0.8919413089752197
Epoch: 3, Steps: 245 | Train Loss: 1.0275693 Vali Loss: 0.6131853 Best vali loss: 0.6131853
	iters: 100, epoch: 4 | loss: 0.6193898
	speed: 0.0074s/iter; left time: 8.3850s
	iters: 200, epoch: 4 | loss: 1.1053578
	speed: 0.0037s/iter; left time: 3.8463s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.6132 --> 0.6072).  Saving model state dict ...
Epoch: 4 cost time: 0.9481298923492432
Epoch: 4, Steps: 245 | Train Loss: 0.8623738 Vali Loss: 0.6071878 Best vali loss: 0.6071878
	iters: 100, epoch: 5 | loss: 0.7004663
	speed: 0.0081s/iter; left time: 7.1238s
	iters: 200, epoch: 5 | loss: 0.6647416
	speed: 0.0039s/iter; left time: 3.0565s
Updating learning rate to 2.986130394788764e-05
Validation loss decreased (0.6072 --> 0.6070).  Saving model state dict ...
Epoch: 5 cost time: 1.0231943130493164
Epoch: 5, Steps: 245 | Train Loss: 0.6826040 Vali Loss: 0.6069971 Best vali loss: 0.6069971
	iters: 100, epoch: 6 | loss: 1.3680311
	speed: 0.0080s/iter; left time: 5.1040s
	iters: 200, epoch: 6 | loss: 0.6187954
	speed: 0.0037s/iter; left time: 2.0088s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.6070 --> 0.6062).  Saving model state dict ...
Epoch: 6 cost time: 0.9821710586547852
Epoch: 6, Steps: 245 | Train Loss: 0.9934133 Vali Loss: 0.6061677 Best vali loss: 0.6061677
	iters: 100, epoch: 7 | loss: 0.5323001
	speed: 0.0080s/iter; left time: 3.1342s
	iters: 200, epoch: 7 | loss: 0.9171790
	speed: 0.0038s/iter; left time: 1.1153s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.6062 --> 0.6053).  Saving model state dict ...
Epoch: 7 cost time: 0.9817245006561279
Epoch: 7, Steps: 245 | Train Loss: 0.7247396 Vali Loss: 0.6053373 Best vali loss: 0.6053373
	iters: 100, epoch: 8 | loss: 1.0966666
	speed: 0.0082s/iter; left time: 1.1953s
	iters: 200, epoch: 8 | loss: 0.6901372
	speed: 0.0037s/iter; left time: 0.1719s
Updating learning rate to 0.0
Validation loss decreased (0.6053 --> 0.6052).  Saving model state dict ...
Epoch: 8 cost time: 0.9701254367828369
Epoch: 8, Steps: 245 | Train Loss: 0.8934019 Vali Loss: 0.6052422 Best vali loss: 0.6052422

best validation loss 0.6052422236370191

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5596438
	speed: 0.0101s/iter; left time: 18.8851s
	iters: 200, epoch: 1 | loss: 1.2127477
	speed: 0.0039s/iter; left time: 6.8447s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 1.3114967346191406
Epoch: 1, Steps: 245 | Train Loss: 0.8861957 Vali Loss: 0.6090265 Best vali loss: 0.6090265
	iters: 100, epoch: 2 | loss: 1.1160457
	speed: 0.0078s/iter; left time: 12.6304s
	iters: 200, epoch: 2 | loss: 0.6734317
	speed: 0.0037s/iter; left time: 5.6336s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 0.9446127414703369
Epoch: 2, Steps: 245 | Train Loss: 0.8947387 Vali Loss: 0.6334385 Best vali loss: 0.6090265
	iters: 100, epoch: 3 | loss: 0.7951878
	speed: 0.0082s/iter; left time: 11.2766s
	iters: 200, epoch: 3 | loss: 0.9345948
	speed: 0.0038s/iter; left time: 4.8219s
Updating learning rate to 0.00020740251485476345
Validation loss decreased (0.6090 --> 0.5755).  Saving model state dict ...
Epoch: 3 cost time: 1.0057833194732666
Epoch: 3, Steps: 245 | Train Loss: 0.8648913 Vali Loss: 0.5754589 Best vali loss: 0.5754589

best validation loss 0.5754589374310327

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016424434527, 'e_layers': 4, 'learning_rate': 0.000318346104, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8126701
	speed: 0.0129s/iter; left time: 11.4598s
Updating learning rate to 0.0003062297768701548
Validation loss decreased (inf --> 0.5937).  Saving model state dict ...
Epoch: 1 cost time: 1.1854546070098877
Epoch: 1, Steps: 123 | Train Loss: 0.8126701 Vali Loss: 0.5937476 Best vali loss: 0.5937476
	iters: 100, epoch: 2 | loss: 0.9242951
	speed: 0.0103s/iter; left time: 7.8283s
Updating learning rate to 0.00027172539645135894
Validation loss decreased (0.5937 --> 0.5672).  Saving model state dict ...
Epoch: 2 cost time: 0.8473014831542969
Epoch: 2, Steps: 123 | Train Loss: 0.9242951 Vali Loss: 0.5671919 Best vali loss: 0.5671919
	iters: 100, epoch: 3 | loss: 0.6959636
	speed: 0.0101s/iter; left time: 6.4620s
Updating learning rate to 0.00022008594187938695
Validation loss decreased (0.5672 --> 0.5537).  Saving model state dict ...
Epoch: 3 cost time: 0.8254384994506836
Epoch: 3, Steps: 123 | Train Loss: 0.6959636 Vali Loss: 0.5537395 Best vali loss: 0.5537395

best validation loss 0.5537395408339988

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017167867055, 'e_layers': 4, 'learning_rate': 0.0003226628243, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5694373
	speed: 0.0116s/iter; left time: 44.4698s
	iters: 200, epoch: 1 | loss: 0.6172417
	speed: 0.0055s/iter; left time: 20.3482s
	iters: 300, epoch: 1 | loss: 0.9396616
	speed: 0.0055s/iter; left time: 19.7683s
	iters: 400, epoch: 1 | loss: 0.7548615
	speed: 0.0054s/iter; left time: 19.0055s
Updating learning rate to 0.0003103822017865277
Validation loss decreased (inf --> 0.6004).  Saving model state dict ...
Epoch: 1 cost time: 2.994168281555176
Epoch: 1, Steps: 490 | Train Loss: 0.9703005 Vali Loss: 0.6003552 Best vali loss: 0.6003552
	iters: 100, epoch: 2 | loss: 2.2010207
	speed: 0.0137s/iter; left time: 45.6833s
	iters: 200, epoch: 2 | loss: 0.7805907
	speed: 0.0049s/iter; left time: 15.9494s
	iters: 300, epoch: 2 | loss: 0.5054625
	speed: 0.0048s/iter; left time: 14.9424s
	iters: 400, epoch: 2 | loss: 0.6760227
	speed: 0.0050s/iter; left time: 15.0849s
Updating learning rate to 0.00027540994769966674
Validation loss decreased (0.6004 --> 0.5767).  Saving model state dict ...
Epoch: 2 cost time: 2.4549129009246826
Epoch: 2, Steps: 490 | Train Loss: 1.0407742 Vali Loss: 0.5767429 Best vali loss: 0.5767429
	iters: 100, epoch: 3 | loss: 0.6286905
	speed: 0.0136s/iter; left time: 38.6175s
	iters: 200, epoch: 3 | loss: 1.2296607
	speed: 0.0048s/iter; left time: 13.0559s
	iters: 300, epoch: 3 | loss: 0.9660087
	speed: 0.0046s/iter; left time: 12.1402s
	iters: 400, epoch: 3 | loss: 0.7452599
	speed: 0.0047s/iter; left time: 11.9674s
Updating learning rate to 0.00022307027069986895
Validation loss decreased (0.5767 --> 0.5615).  Saving model state dict ...
Epoch: 3 cost time: 2.3677518367767334
Epoch: 3, Steps: 490 | Train Loss: 0.8924049 Vali Loss: 0.5614551 Best vali loss: 0.5614551

best validation loss 0.5614550887628156

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016424434527, 'e_layers': 4, 'learning_rate': 0.000318346104, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7578329
	speed: 0.0133s/iter; left time: 6.8667s
Updating learning rate to 0.000159173052
Epoch: 4 cost time: 1.1881299018859863
Epoch: 4, Steps: 123 | Train Loss: 0.7578329 Vali Loss: 0.5563823 Best vali loss: 0.5537395
	iters: 100, epoch: 5 | loss: 0.8041663
	speed: 0.0100s/iter; left time: 3.9248s
Updating learning rate to 9.82601621206131e-05
Validation loss decreased (0.5537 --> 0.5475).  Saving model state dict ...
Epoch: 5 cost time: 0.8137643337249756
Epoch: 5, Steps: 123 | Train Loss: 0.8041663 Vali Loss: 0.5474535 Best vali loss: 0.5474535
	iters: 100, epoch: 6 | loss: 0.6359674
	speed: 0.0102s/iter; left time: 2.7454s
Updating learning rate to 4.662070754864106e-05
Validation loss decreased (0.5475 --> 0.5463).  Saving model state dict ...
Epoch: 6 cost time: 0.8215069770812988
Epoch: 6, Steps: 123 | Train Loss: 0.6359674 Vali Loss: 0.5463186 Best vali loss: 0.5463186
	iters: 100, epoch: 7 | loss: 0.8031749
	speed: 0.0100s/iter; left time: 1.4748s
Updating learning rate to 1.2116327129845267e-05
Validation loss decreased (0.5463 --> 0.5428).  Saving model state dict ...
Epoch: 7 cost time: 0.8089494705200195
Epoch: 7, Steps: 123 | Train Loss: 0.8031749 Vali Loss: 0.5427977 Best vali loss: 0.5427977
	iters: 100, epoch: 8 | loss: 0.5876732
	speed: 0.0105s/iter; left time: 0.2518s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8722872734069824
Epoch: 8, Steps: 123 | Train Loss: 0.5876732 Vali Loss: 0.5445865 Best vali loss: 0.5427977

best validation loss 0.5427977106241317

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016699881937, 'e_layers': 4, 'learning_rate': 0.0003071271644, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5700476
	speed: 0.0114s/iter; left time: 43.5238s
	iters: 200, epoch: 1 | loss: 0.6172417
	speed: 0.0055s/iter; left time: 20.4692s
	iters: 300, epoch: 1 | loss: 0.9584381
	speed: 0.0051s/iter; left time: 18.4305s
	iters: 400, epoch: 1 | loss: 0.7611154
	speed: 0.0049s/iter; left time: 17.3423s
Updating learning rate to 0.00029543783273369457
Validation loss decreased (inf --> 0.5965).  Saving model state dict ...
Epoch: 1 cost time: 2.8647079467773438
Epoch: 1, Steps: 490 | Train Loss: 0.9767107 Vali Loss: 0.5964603 Best vali loss: 0.5964603
	iters: 100, epoch: 2 | loss: 2.3043008
	speed: 0.0137s/iter; left time: 45.7410s
	iters: 200, epoch: 2 | loss: 1.0701864
	speed: 0.0054s/iter; left time: 17.5833s
	iters: 300, epoch: 2 | loss: 0.5067301
	speed: 0.0054s/iter; left time: 17.0064s
	iters: 400, epoch: 2 | loss: 0.6324458
	speed: 0.0051s/iter; left time: 15.6031s
Updating learning rate to 0.0002621494325169178
Validation loss decreased (0.5965 --> 0.5750).  Saving model state dict ...
Epoch: 2 cost time: 2.608962297439575
Epoch: 2, Steps: 490 | Train Loss: 1.1284158 Vali Loss: 0.5750208 Best vali loss: 0.5750208
	iters: 100, epoch: 3 | loss: 0.6321622
	speed: 0.0138s/iter; left time: 39.0794s
	iters: 200, epoch: 3 | loss: 1.2391293
	speed: 0.0054s/iter; left time: 14.9159s
	iters: 300, epoch: 3 | loss: 1.0172794
	speed: 0.0055s/iter; left time: 14.4369s
	iters: 400, epoch: 3 | loss: 0.7457250
	speed: 0.0055s/iter; left time: 13.8487s
Updating learning rate to 0.0002123298209225746
Epoch: 3 cost time: 2.6971521377563477
Epoch: 3, Steps: 490 | Train Loss: 0.9085740 Vali Loss: 0.6030958 Best vali loss: 0.5750208
	iters: 100, epoch: 4 | loss: 0.9849027
	speed: 0.0138s/iter; left time: 32.4890s
	iters: 200, epoch: 4 | loss: 0.7879722
	speed: 0.0051s/iter; left time: 11.4727s
	iters: 300, epoch: 4 | loss: 1.1355860
	speed: 0.0050s/iter; left time: 10.8158s
	iters: 400, epoch: 4 | loss: 0.8542756
	speed: 0.0050s/iter; left time: 10.2370s
Updating learning rate to 0.0001535635822
Validation loss decreased (0.5750 --> 0.5508).  Saving model state dict ...
Epoch: 4 cost time: 2.5098936557769775
Epoch: 4, Steps: 490 | Train Loss: 0.9406841 Vali Loss: 0.5507591 Best vali loss: 0.5507591
	iters: 100, epoch: 5 | loss: 0.4900316
	speed: 0.0141s/iter; left time: 26.2022s
	iters: 200, epoch: 5 | loss: 0.8011444
	speed: 0.0054s/iter; left time: 9.4929s
	iters: 300, epoch: 5 | loss: 0.9937686
	speed: 0.0054s/iter; left time: 9.0452s
	iters: 400, epoch: 5 | loss: 0.5654140
	speed: 0.0054s/iter; left time: 8.5004s
Updating learning rate to 9.47973434774254e-05
Epoch: 5 cost time: 2.700042963027954
Epoch: 5, Steps: 490 | Train Loss: 0.7125897 Vali Loss: 0.5616196 Best vali loss: 0.5507591
	iters: 100, epoch: 6 | loss: 0.9533378
	speed: 0.0141s/iter; left time: 19.3318s
	iters: 200, epoch: 6 | loss: 0.5778578
	speed: 0.0054s/iter; left time: 6.8694s
	iters: 300, epoch: 6 | loss: 0.4896009
	speed: 0.0052s/iter; left time: 6.0333s
	iters: 400, epoch: 6 | loss: 0.3940533
	speed: 0.0050s/iter; left time: 5.3434s
Updating learning rate to 4.49777318830822e-05
Epoch: 6 cost time: 2.5894358158111572
Epoch: 6, Steps: 490 | Train Loss: 0.6037124 Vali Loss: 0.5569129 Best vali loss: 0.5507591
	iters: 100, epoch: 7 | loss: 0.6320060
	speed: 0.0136s/iter; left time: 11.9675s
	iters: 200, epoch: 7 | loss: 0.4823259
	speed: 0.0050s/iter; left time: 3.9379s
	iters: 300, epoch: 7 | loss: 0.6887964
	speed: 0.0050s/iter; left time: 3.3777s
	iters: 400, epoch: 7 | loss: 1.0999981
	speed: 0.0049s/iter; left time: 2.8689s
Updating learning rate to 1.1689331666305446e-05
Epoch: 7 cost time: 2.477593421936035
Epoch: 7, Steps: 490 | Train Loss: 0.7257816 Vali Loss: 0.5577223 Best vali loss: 0.5507591
	iters: 100, epoch: 8 | loss: 0.5971706
	speed: 0.0133s/iter; left time: 5.2090s
	iters: 200, epoch: 8 | loss: 0.4094570
	speed: 0.0051s/iter; left time: 1.4752s
	iters: 300, epoch: 8 | loss: 0.5138223
	speed: 0.0053s/iter; left time: 1.0130s
	iters: 400, epoch: 8 | loss: 0.6593947
	speed: 0.0055s/iter; left time: 0.4963s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6195340156555176
Epoch: 8, Steps: 490 | Train Loss: 0.5449611 Vali Loss: 0.5641647 Best vali loss: 0.5507591

best validation loss 0.5507591027785429

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017197148698, 'e_layers': 4, 'learning_rate': 0.0002630761816, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8123335
	speed: 0.0126s/iter; left time: 11.1584s
Updating learning rate to 0.0002530634406357312
Validation loss decreased (inf --> 0.5951).  Saving model state dict ...
Epoch: 1 cost time: 1.127781629562378
Epoch: 1, Steps: 123 | Train Loss: 0.8123335 Vali Loss: 0.5950676 Best vali loss: 0.5950676
	iters: 100, epoch: 2 | loss: 0.9249822
	speed: 0.0100s/iter; left time: 7.6296s
Updating learning rate to 0.00022454956678901182
Validation loss decreased (0.5951 --> 0.5767).  Saving model state dict ...
Epoch: 2 cost time: 0.8077435493469238
Epoch: 2, Steps: 123 | Train Loss: 0.9249822 Vali Loss: 0.5767111 Best vali loss: 0.5767111
	iters: 100, epoch: 3 | loss: 0.6966977
	speed: 0.0099s/iter; left time: 6.3501s
Updating learning rate to 0.00018187553887409486
Validation loss decreased (0.5767 --> 0.5604).  Saving model state dict ...
Epoch: 3 cost time: 0.8086216449737549
Epoch: 3, Steps: 123 | Train Loss: 0.6966977 Vali Loss: 0.5604138 Best vali loss: 0.5604138
	iters: 100, epoch: 4 | loss: 0.8557561
	speed: 0.0099s/iter; left time: 5.1240s
Updating learning rate to 0.0001315380908
Epoch: 4 cost time: 0.8070492744445801
Epoch: 4, Steps: 123 | Train Loss: 0.8557561 Vali Loss: 0.5622763 Best vali loss: 0.5604138
	iters: 100, epoch: 5 | loss: 0.6284756
	speed: 0.0098s/iter; left time: 3.8334s
Updating learning rate to 8.120064272590517e-05
Validation loss decreased (0.5604 --> 0.5498).  Saving model state dict ...
Epoch: 5 cost time: 0.7933378219604492
Epoch: 5, Steps: 123 | Train Loss: 0.6284756 Vali Loss: 0.5498248 Best vali loss: 0.5498248
	iters: 100, epoch: 6 | loss: 0.7166266
	speed: 0.0099s/iter; left time: 2.6761s
Updating learning rate to 3.852661481098819e-05
Validation loss decreased (0.5498 --> 0.5462).  Saving model state dict ...
Epoch: 6 cost time: 0.8005411624908447
Epoch: 6, Steps: 123 | Train Loss: 0.7166266 Vali Loss: 0.5462235 Best vali loss: 0.5462235
	iters: 100, epoch: 7 | loss: 0.7257770
	speed: 0.0099s/iter; left time: 1.4594s
Updating learning rate to 1.0012740964268813e-05
Validation loss decreased (0.5462 --> 0.5454).  Saving model state dict ...
Epoch: 7 cost time: 0.8124516010284424
Epoch: 7, Steps: 123 | Train Loss: 0.7257770 Vali Loss: 0.5454199 Best vali loss: 0.5454199
	iters: 100, epoch: 8 | loss: 0.6899670
	speed: 0.0098s/iter; left time: 0.2360s
Updating learning rate to 0.0
Validation loss decreased (0.5454 --> 0.5452).  Saving model state dict ...
Epoch: 8 cost time: 0.7965571880340576
Epoch: 8, Steps: 123 | Train Loss: 0.6899670 Vali Loss: 0.5451910 Best vali loss: 0.5451910

best validation loss 0.5451909735185136

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016168799661, 'e_layers': 4, 'learning_rate': 0.0003237091032, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8127478
	speed: 0.0126s/iter; left time: 11.1702s
Updating learning rate to 0.00031138865906703197
Validation loss decreased (inf --> 0.5936).  Saving model state dict ...
Epoch: 1 cost time: 1.1310639381408691
Epoch: 1, Steps: 123 | Train Loss: 0.8127478 Vali Loss: 0.5935919 Best vali loss: 0.5935919
	iters: 100, epoch: 2 | loss: 0.9286284
	speed: 0.0101s/iter; left time: 7.6987s
Updating learning rate to 0.000276303002602268
Validation loss decreased (0.5936 --> 0.5866).  Saving model state dict ...
Epoch: 2 cost time: 0.8116073608398438
Epoch: 2, Steps: 123 | Train Loss: 0.9286284 Vali Loss: 0.5866449 Best vali loss: 0.5866449
	iters: 100, epoch: 3 | loss: 0.6995161
	speed: 0.0106s/iter; left time: 6.7476s
Updating learning rate to 0.00022379360695020057
Validation loss decreased (0.5866 --> 0.5450).  Saving model state dict ...
Epoch: 3 cost time: 0.8515040874481201
Epoch: 3, Steps: 123 | Train Loss: 0.6995161 Vali Loss: 0.5449868 Best vali loss: 0.5449868

best validation loss 0.5449867926775885

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016493492289, 'e_layers': 4, 'learning_rate': 0.0003059958767, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5700686
	speed: 0.0115s/iter; left time: 43.8644s
	iters: 200, epoch: 1 | loss: 0.6173565
	speed: 0.0053s/iter; left time: 19.7117s
	iters: 300, epoch: 1 | loss: 0.9566252
	speed: 0.0054s/iter; left time: 19.5573s
	iters: 400, epoch: 1 | loss: 0.7606719
	speed: 0.0052s/iter; left time: 18.4326s
Updating learning rate to 0.0002943496021079887
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 2.9266180992126465
Epoch: 1, Steps: 490 | Train Loss: 0.9761806 Vali Loss: 0.6041453 Best vali loss: 0.6041453
	iters: 100, epoch: 2 | loss: 2.2286797
	speed: 0.0138s/iter; left time: 45.9446s
	iters: 200, epoch: 2 | loss: 1.0373647
	speed: 0.0050s/iter; left time: 16.1939s
	iters: 300, epoch: 2 | loss: 0.5129288
	speed: 0.0050s/iter; left time: 15.8054s
	iters: 400, epoch: 2 | loss: 0.6505287
	speed: 0.0050s/iter; left time: 15.1540s
Updating learning rate to 0.00026118381806484634
Validation loss decreased (0.6041 --> 0.5761).  Saving model state dict ...
Epoch: 2 cost time: 2.5246126651763916
Epoch: 2, Steps: 490 | Train Loss: 1.1073755 Vali Loss: 0.5761346 Best vali loss: 0.5761346
	iters: 100, epoch: 3 | loss: 0.6274123
	speed: 0.0142s/iter; left time: 40.2944s
	iters: 200, epoch: 3 | loss: 1.2343205
	speed: 0.0050s/iter; left time: 13.6522s
	iters: 300, epoch: 3 | loss: 1.0165156
	speed: 0.0049s/iter; left time: 12.9145s
	iters: 400, epoch: 3 | loss: 0.7544039
	speed: 0.0048s/iter; left time: 12.1021s
Updating learning rate to 0.00021154771454256043
Validation loss decreased (0.5761 --> 0.5548).  Saving model state dict ...
Epoch: 3 cost time: 2.4683969020843506
Epoch: 3, Steps: 490 | Train Loss: 0.9081631 Vali Loss: 0.5548033 Best vali loss: 0.5548033

best validation loss 0.5548033263053347

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017372113857, 'e_layers': 4, 'learning_rate': 0.0002657949308, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8123612
	speed: 0.0129s/iter; left time: 11.3748s
Updating learning rate to 0.00025567871360568687
Validation loss decreased (inf --> 0.5950).  Saving model state dict ...
Epoch: 1 cost time: 1.173290729522705
Epoch: 1, Steps: 123 | Train Loss: 0.8123612 Vali Loss: 0.5949967 Best vali loss: 0.5949967
	iters: 100, epoch: 2 | loss: 0.9238317
	speed: 0.0103s/iter; left time: 7.8584s
Updating learning rate to 0.00022687016438684455
Validation loss decreased (0.5950 --> 0.5808).  Saving model state dict ...
Epoch: 2 cost time: 0.8457648754119873
Epoch: 2, Steps: 123 | Train Loss: 0.9238317 Vali Loss: 0.5808221 Best vali loss: 0.5808221
	iters: 100, epoch: 3 | loss: 0.7085283
	speed: 0.0101s/iter; left time: 6.4660s
Updating learning rate to 0.00018375512361189274
Validation loss decreased (0.5808 --> 0.5568).  Saving model state dict ...
Epoch: 3 cost time: 0.8133509159088135
Epoch: 3, Steps: 123 | Train Loss: 0.7085283 Vali Loss: 0.5567598 Best vali loss: 0.5567598

best validation loss 0.5567597889999503

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016168799661, 'e_layers': 4, 'learning_rate': 0.0003237091032, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7529647
	speed: 0.0130s/iter; left time: 6.7001s
Updating learning rate to 0.0001618545516
Epoch: 4 cost time: 1.148576259613037
Epoch: 4, Steps: 123 | Train Loss: 0.7529647 Vali Loss: 0.5471923 Best vali loss: 0.5449868
	iters: 100, epoch: 5 | loss: 0.7960702
	speed: 0.0103s/iter; left time: 4.0487s
Updating learning rate to 9.991549624979948e-05
Epoch: 5 cost time: 0.8566751480102539
Epoch: 5, Steps: 123 | Train Loss: 0.7960702 Vali Loss: 0.5514640 Best vali loss: 0.5449868
	iters: 100, epoch: 6 | loss: 0.6336222
	speed: 0.0098s/iter; left time: 2.6549s
Updating learning rate to 4.740610059773205e-05
Epoch: 6 cost time: 0.8000304698944092
Epoch: 6, Steps: 123 | Train Loss: 0.6336222 Vali Loss: 0.5532327 Best vali loss: 0.5449868
	iters: 100, epoch: 7 | loss: 0.7932880
	speed: 0.0097s/iter; left time: 1.4307s
Updating learning rate to 1.2320444132968064e-05
Epoch: 7 cost time: 0.8067460060119629
Epoch: 7, Steps: 123 | Train Loss: 0.7932880 Vali Loss: 0.5479210 Best vali loss: 0.5449868
	iters: 100, epoch: 8 | loss: 0.5821504
	speed: 0.0101s/iter; left time: 0.2419s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8474102020263672
Epoch: 8, Steps: 123 | Train Loss: 0.5821504 Vali Loss: 0.5493621 Best vali loss: 0.5449868

best validation loss 0.5449867926775885

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016125469832, 'e_layers': 4, 'learning_rate': 0.0002705517934, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5651244
	speed: 0.0111s/iter; left time: 42.2417s
	iters: 200, epoch: 1 | loss: 0.6207339
	speed: 0.0048s/iter; left time: 18.0188s
	iters: 300, epoch: 1 | loss: 0.9449800
	speed: 0.0051s/iter; left time: 18.3118s
	iters: 400, epoch: 1 | loss: 0.7526229
	speed: 0.0051s/iter; left time: 17.7912s
Updating learning rate to 0.0002602545289032411
Validation loss decreased (inf --> 0.5974).  Saving model state dict ...
Epoch: 1 cost time: 2.7928757667541504
Epoch: 1, Steps: 490 | Train Loss: 0.9708653 Vali Loss: 0.5973669 Best vali loss: 0.5973669
	iters: 100, epoch: 2 | loss: 2.1535392
	speed: 0.0139s/iter; left time: 46.3394s
	iters: 200, epoch: 2 | loss: 0.7771787
	speed: 0.0050s/iter; left time: 16.2662s
	iters: 300, epoch: 2 | loss: 0.5077786
	speed: 0.0050s/iter; left time: 15.7642s
	iters: 400, epoch: 2 | loss: 0.6632825
	speed: 0.0051s/iter; left time: 15.3195s
Updating learning rate to 0.0002309304005876609
Validation loss decreased (0.5974 --> 0.5548).  Saving model state dict ...
Epoch: 2 cost time: 2.542443037033081
Epoch: 2, Steps: 490 | Train Loss: 1.0254447 Vali Loss: 0.5548034 Best vali loss: 0.5548034
	iters: 100, epoch: 3 | loss: 0.6382993
	speed: 0.0139s/iter; left time: 39.4557s
	iters: 200, epoch: 3 | loss: 1.2344313
	speed: 0.0054s/iter; left time: 14.7050s
	iters: 300, epoch: 3 | loss: 0.9727202
	speed: 0.0054s/iter; left time: 14.1296s
	iters: 400, epoch: 3 | loss: 0.7359205
	speed: 0.0053s/iter; left time: 13.5365s
Updating learning rate to 0.00018704374116542132
Epoch: 3 cost time: 2.6597952842712402
Epoch: 3, Steps: 490 | Train Loss: 0.8953428 Vali Loss: 0.5603517 Best vali loss: 0.5548034
	iters: 100, epoch: 4 | loss: 0.8824416
	speed: 0.0140s/iter; left time: 32.9707s
	iters: 200, epoch: 4 | loss: 0.7140489
	speed: 0.0053s/iter; left time: 12.0399s
	iters: 300, epoch: 4 | loss: 1.0717224
	speed: 0.0052s/iter; left time: 11.2683s
	iters: 400, epoch: 4 | loss: 0.8111712
	speed: 0.0049s/iter; left time: 10.0721s
Updating learning rate to 0.0001352758967
Validation loss decreased (0.5548 --> 0.5498).  Saving model state dict ...
Epoch: 4 cost time: 2.5666093826293945
Epoch: 4, Steps: 490 | Train Loss: 0.8698460 Vali Loss: 0.5497570 Best vali loss: 0.5497570
	iters: 100, epoch: 5 | loss: 0.4965517
	speed: 0.0138s/iter; left time: 25.6536s
	iters: 200, epoch: 5 | loss: 0.7510686
	speed: 0.0049s/iter; left time: 8.6280s
	iters: 300, epoch: 5 | loss: 0.9581718
	speed: 0.0050s/iter; left time: 8.3533s
	iters: 400, epoch: 5 | loss: 0.5485570
	speed: 0.0051s/iter; left time: 7.9015s
Updating learning rate to 8.350805223457868e-05
Epoch: 5 cost time: 2.504775047302246
Epoch: 5, Steps: 490 | Train Loss: 0.6885873 Vali Loss: 0.5633798 Best vali loss: 0.5497570
	iters: 100, epoch: 6 | loss: 0.9325781
	speed: 0.0137s/iter; left time: 18.8057s
	iters: 200, epoch: 6 | loss: 0.5257251
	speed: 0.0050s/iter; left time: 6.3798s
	iters: 300, epoch: 6 | loss: 0.4922180
	speed: 0.0051s/iter; left time: 5.9321s
	iters: 400, epoch: 6 | loss: 0.3713705
	speed: 0.0050s/iter; left time: 5.3522s
Updating learning rate to 3.96213928123391e-05
Epoch: 6 cost time: 2.5233750343322754
Epoch: 6, Steps: 490 | Train Loss: 0.5804730 Vali Loss: 0.5750695 Best vali loss: 0.5497570
	iters: 100, epoch: 7 | loss: 0.6054278
	speed: 0.0136s/iter; left time: 11.9377s
	iters: 200, epoch: 7 | loss: 0.4562545
	speed: 0.0050s/iter; left time: 3.8790s
	iters: 300, epoch: 7 | loss: 0.6154420
	speed: 0.0051s/iter; left time: 3.5043s
	iters: 400, epoch: 7 | loss: 1.0461221
	speed: 0.0050s/iter; left time: 2.9289s
Updating learning rate to 1.0297264496758884e-05
Epoch: 7 cost time: 2.516890287399292
Epoch: 7, Steps: 490 | Train Loss: 0.6808116 Vali Loss: 0.5860299 Best vali loss: 0.5497570
	iters: 100, epoch: 8 | loss: 0.5385073
	speed: 0.0138s/iter; left time: 5.3780s
	iters: 200, epoch: 8 | loss: 0.3737949
	speed: 0.0054s/iter; left time: 1.5608s
	iters: 300, epoch: 8 | loss: 0.4823327
	speed: 0.0053s/iter; left time: 1.0192s
	iters: 400, epoch: 8 | loss: 0.6302028
	speed: 0.0054s/iter; left time: 0.4883s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6593217849731445
Epoch: 8, Steps: 490 | Train Loss: 0.5062095 Vali Loss: 0.5932713 Best vali loss: 0.5497570

best validation loss 0.5497570099073779

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018575806594, 'e_layers': 2, 'learning_rate': 0.0002897671991, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0348783
	speed: 0.0112s/iter; left time: 9.8837s
Updating learning rate to 0.0002787385917708065
Validation loss decreased (inf --> 0.5971).  Saving model state dict ...
Epoch: 1 cost time: 0.9576241970062256
Epoch: 1, Steps: 123 | Train Loss: 1.0348783 Vali Loss: 0.5971313 Best vali loss: 0.5971313
	iters: 100, epoch: 2 | loss: 0.6378570
	speed: 0.0079s/iter; left time: 5.9904s
Updating learning rate to 0.0002473317752745212
Validation loss decreased (0.5971 --> 0.5439).  Saving model state dict ...
Epoch: 2 cost time: 0.6029782295227051
Epoch: 2, Steps: 123 | Train Loss: 0.6378570 Vali Loss: 0.5439363 Best vali loss: 0.5439363
	iters: 100, epoch: 3 | loss: 0.7573804
	speed: 0.0083s/iter; left time: 5.2838s
Updating learning rate to 0.0002003281527192032
Epoch: 3 cost time: 0.6429970264434814
Epoch: 3, Steps: 123 | Train Loss: 0.7573804 Vali Loss: 0.5597469 Best vali loss: 0.5439363
	iters: 100, epoch: 4 | loss: 0.6481723
	speed: 0.0080s/iter; left time: 4.1095s
Updating learning rate to 0.00014488359955
Epoch: 4 cost time: 0.6328091621398926
Epoch: 4, Steps: 123 | Train Loss: 0.6481723 Vali Loss: 0.5508119 Best vali loss: 0.5439363
	iters: 100, epoch: 5 | loss: 0.5181888
	speed: 0.0078s/iter; left time: 3.0838s
Updating learning rate to 8.943904638079684e-05
Epoch: 5 cost time: 0.6194808483123779
Epoch: 5, Steps: 123 | Train Loss: 0.5181888 Vali Loss: 0.5556161 Best vali loss: 0.5439363
	iters: 100, epoch: 6 | loss: 0.7284746
	speed: 0.0079s/iter; left time: 2.1230s
Updating learning rate to 4.2435423825478784e-05
Epoch: 6 cost time: 0.6230435371398926
Epoch: 6, Steps: 123 | Train Loss: 0.7284746 Vali Loss: 0.5468636 Best vali loss: 0.5439363
	iters: 100, epoch: 7 | loss: 0.4932643
	speed: 0.0079s/iter; left time: 1.1555s
Updating learning rate to 1.1028607329193526e-05
Epoch: 7 cost time: 0.6153459548950195
Epoch: 7, Steps: 123 | Train Loss: 0.4932643 Vali Loss: 0.5450277 Best vali loss: 0.5439363
	iters: 100, epoch: 8 | loss: 0.6068177
	speed: 0.0078s/iter; left time: 0.1871s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6141178607940674
Epoch: 8, Steps: 123 | Train Loss: 0.6068177 Vali Loss: 0.5488052 Best vali loss: 0.5439363

best validation loss 0.5439363404149978

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019678546212, 'e_layers': 2, 'learning_rate': 0.0003037599418, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0330602
	speed: 0.0110s/iter; left time: 9.7133s
Updating learning rate to 0.0002921987674129198
Validation loss decreased (inf --> 0.5965).  Saving model state dict ...
Epoch: 1 cost time: 0.9438848495483398
Epoch: 1, Steps: 123 | Train Loss: 1.0330602 Vali Loss: 0.5965317 Best vali loss: 0.5965317
	iters: 100, epoch: 2 | loss: 0.6293827
	speed: 0.0079s/iter; left time: 6.0242s
Updating learning rate to 0.0002592753282498055
Validation loss decreased (0.5965 --> 0.5451).  Saving model state dict ...
Epoch: 2 cost time: 0.6105384826660156
Epoch: 2, Steps: 123 | Train Loss: 0.6293827 Vali Loss: 0.5451306 Best vali loss: 0.5451306
	iters: 100, epoch: 3 | loss: 0.7253624
	speed: 0.0081s/iter; left time: 5.2020s
Updating learning rate to 0.00021000191947152195
Epoch: 3 cost time: 0.6288454532623291
Epoch: 3, Steps: 123 | Train Loss: 0.7253624 Vali Loss: 0.5487916 Best vali loss: 0.5451306

best validation loss 0.5451306250982404

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021542325148, 'e_layers': 2, 'learning_rate': 0.000270592024, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0346558
	speed: 0.0110s/iter; left time: 9.7014s
Updating learning rate to 0.00026029322831720144
Validation loss decreased (inf --> 0.5985).  Saving model state dict ...
Epoch: 1 cost time: 0.9565010070800781
Epoch: 1, Steps: 123 | Train Loss: 1.0346558 Vali Loss: 0.5984899 Best vali loss: 0.5984899
	iters: 100, epoch: 2 | loss: 0.6393430
	speed: 0.0081s/iter; left time: 6.1402s
Updating learning rate to 0.00023096473955269651
Validation loss decreased (0.5985 --> 0.5565).  Saving model state dict ...
Epoch: 2 cost time: 0.6303751468658447
Epoch: 2, Steps: 123 | Train Loss: 0.6393430 Vali Loss: 0.5565322 Best vali loss: 0.5565322
	iters: 100, epoch: 3 | loss: 0.7252139
	speed: 0.0079s/iter; left time: 5.0437s
Updating learning rate to 0.0001870715542574684
Validation loss decreased (0.5565 --> 0.5554).  Saving model state dict ...
Epoch: 3 cost time: 0.6035997867584229
Epoch: 3, Steps: 123 | Train Loss: 0.7252139 Vali Loss: 0.5553574 Best vali loss: 0.5553574

best validation loss 0.5553574376721891

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019192736002, 'e_layers': 2, 'learning_rate': 0.0002770150629, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0349052
	speed: 0.0111s/iter; left time: 9.8104s
Updating learning rate to 0.00026647180485531836
Validation loss decreased (inf --> 0.5983).  Saving model state dict ...
Epoch: 1 cost time: 0.9668440818786621
Epoch: 1, Steps: 123 | Train Loss: 1.0349052 Vali Loss: 0.5982515 Best vali loss: 0.5982515
	iters: 100, epoch: 2 | loss: 0.6373409
	speed: 0.0077s/iter; left time: 5.8783s
Updating learning rate to 0.000236447146183704
Validation loss decreased (0.5983 --> 0.5473).  Saving model state dict ...
Epoch: 2 cost time: 0.5758299827575684
Epoch: 2, Steps: 123 | Train Loss: 0.6373409 Vali Loss: 0.5473037 Best vali loss: 0.5473037
	iters: 100, epoch: 3 | loss: 0.7264014
	speed: 0.0080s/iter; left time: 5.1155s
Updating learning rate to 0.00019151206899370164
Epoch: 3 cost time: 0.6246135234832764
Epoch: 3, Steps: 123 | Train Loss: 0.7264014 Vali Loss: 0.5513853 Best vali loss: 0.5473037

best validation loss 0.5473037266940886

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019678546212, 'e_layers': 2, 'learning_rate': 0.0003037599418, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9232734
	speed: 0.0114s/iter; left time: 5.8623s
Updating learning rate to 0.0001518799709
Validation loss decreased (0.5451 --> 0.5400).  Saving model state dict ...
Epoch: 4 cost time: 0.9691133499145508
Epoch: 4, Steps: 123 | Train Loss: 0.9232734 Vali Loss: 0.5399588 Best vali loss: 0.5399588
	iters: 100, epoch: 5 | loss: 0.5952286
	speed: 0.0081s/iter; left time: 3.1897s
Updating learning rate to 9.375802232847805e-05
Epoch: 5 cost time: 0.6185200214385986
Epoch: 5, Steps: 123 | Train Loss: 0.5952286 Vali Loss: 0.5454598 Best vali loss: 0.5399588
	iters: 100, epoch: 6 | loss: 0.6497147
	speed: 0.0075s/iter; left time: 2.0260s
Updating learning rate to 4.44846135501945e-05
Epoch: 6 cost time: 0.5897705554962158
Epoch: 6, Steps: 123 | Train Loss: 0.6497147 Vali Loss: 0.5460740 Best vali loss: 0.5399588
	iters: 100, epoch: 7 | loss: 0.6124849
	speed: 0.0076s/iter; left time: 1.1231s
Updating learning rate to 1.1561174387080165e-05
Validation loss decreased (0.5400 --> 0.5373).  Saving model state dict ...
Epoch: 7 cost time: 0.5909116268157959
Epoch: 7, Steps: 123 | Train Loss: 0.6124849 Vali Loss: 0.5373230 Best vali loss: 0.5373230
	iters: 100, epoch: 8 | loss: 0.4837461
	speed: 0.0081s/iter; left time: 0.1934s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6192059516906738
Epoch: 8, Steps: 123 | Train Loss: 0.4837461 Vali Loss: 0.5430656 Best vali loss: 0.5373230

best validation loss 0.5373230130514686

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017744911912, 'e_layers': 2, 'learning_rate': 0.0002998025969, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0335588
	speed: 0.0110s/iter; left time: 9.7616s
Updating learning rate to 0.0002883920399848209
Validation loss decreased (inf --> 0.5964).  Saving model state dict ...
Epoch: 1 cost time: 0.9617094993591309
Epoch: 1, Steps: 123 | Train Loss: 1.0335588 Vali Loss: 0.5963523 Best vali loss: 0.5963523
	iters: 100, epoch: 2 | loss: 0.6401032
	speed: 0.0080s/iter; left time: 6.1324s
Updating learning rate to 0.0002558975230926635
Validation loss decreased (0.5964 --> 0.5541).  Saving model state dict ...
Epoch: 2 cost time: 0.6261787414550781
Epoch: 2, Steps: 123 | Train Loss: 0.6401032 Vali Loss: 0.5540953 Best vali loss: 0.5540953
	iters: 100, epoch: 3 | loss: 0.7306226
	speed: 0.0081s/iter; left time: 5.1766s
Updating learning rate to 0.00020726604185682975
Validation loss decreased (0.5541 --> 0.5496).  Saving model state dict ...
Epoch: 3 cost time: 0.6212780475616455
Epoch: 3, Steps: 123 | Train Loss: 0.7306226 Vali Loss: 0.5495723 Best vali loss: 0.5495723
	iters: 100, epoch: 4 | loss: 0.6469086
	speed: 0.0081s/iter; left time: 4.1785s
Updating learning rate to 0.00014990129845
Validation loss decreased (0.5496 --> 0.5412).  Saving model state dict ...
Epoch: 4 cost time: 0.6154422760009766
Epoch: 4, Steps: 123 | Train Loss: 0.6469086 Vali Loss: 0.5412330 Best vali loss: 0.5412330
	iters: 100, epoch: 5 | loss: 0.5093129
	speed: 0.0080s/iter; left time: 3.1481s
Updating learning rate to 9.25365550431703e-05
Epoch: 5 cost time: 0.6023995876312256
Epoch: 5, Steps: 123 | Train Loss: 0.5093129 Vali Loss: 0.5438384 Best vali loss: 0.5412330
	iters: 100, epoch: 6 | loss: 0.7236429
	speed: 0.0080s/iter; left time: 2.1498s
Updating learning rate to 4.3905073807336505e-05
Validation loss decreased (0.5412 --> 0.5388).  Saving model state dict ...
Epoch: 6 cost time: 0.611102819442749
Epoch: 6, Steps: 123 | Train Loss: 0.7236429 Vali Loss: 0.5388276 Best vali loss: 0.5388276
	iters: 100, epoch: 7 | loss: 0.4976850
	speed: 0.0081s/iter; left time: 1.1954s
Updating learning rate to 1.141055691517913e-05
Validation loss decreased (0.5388 --> 0.5363).  Saving model state dict ...
Epoch: 7 cost time: 0.6211245059967041
Epoch: 7, Steps: 123 | Train Loss: 0.4976850 Vali Loss: 0.5363359 Best vali loss: 0.5363359
	iters: 100, epoch: 8 | loss: 0.5975771
	speed: 0.0080s/iter; left time: 0.1915s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.611818790435791
Epoch: 8, Steps: 123 | Train Loss: 0.5975771 Vali Loss: 0.5374223 Best vali loss: 0.5363359

best validation loss 0.5363358969574777

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5040696
	speed: 0.0114s/iter; left time: 21.2698s
	iters: 200, epoch: 1 | loss: 1.0248811
	speed: 0.0055s/iter; left time: 9.7510s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.6221).  Saving model state dict ...
Epoch: 1 cost time: 1.685755968093872
Epoch: 1, Steps: 245 | Train Loss: 0.7644754 Vali Loss: 0.6221151 Best vali loss: 0.6221151
	iters: 100, epoch: 2 | loss: 1.0887665
	speed: 0.0108s/iter; left time: 17.4536s
	iters: 200, epoch: 2 | loss: 0.7042484
	speed: 0.0056s/iter; left time: 8.5652s
Updating learning rate to 0.0004603128331928716
Validation loss decreased (0.6221 --> 0.6206).  Saving model state dict ...
Epoch: 2 cost time: 1.4228148460388184
Epoch: 2, Steps: 245 | Train Loss: 0.8965074 Vali Loss: 0.6206188 Best vali loss: 0.6206188
	iters: 100, epoch: 3 | loss: 0.6831721
	speed: 0.0102s/iter; left time: 13.9944s
	iters: 200, epoch: 3 | loss: 0.7133320
	speed: 0.0051s/iter; left time: 6.5449s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 1.3153061866760254
Epoch: 3, Steps: 245 | Train Loss: 0.6982521 Vali Loss: 0.6232503 Best vali loss: 0.6206188
	iters: 100, epoch: 4 | loss: 0.9237421
	speed: 0.0102s/iter; left time: 11.4752s
	iters: 200, epoch: 4 | loss: 0.6961773
	speed: 0.0050s/iter; left time: 5.1041s
Updating learning rate to 0.00026964501475
Validation loss decreased (0.6206 --> 0.6151).  Saving model state dict ...
Epoch: 4 cost time: 1.301208257675171
Epoch: 4, Steps: 245 | Train Loss: 0.8099597 Vali Loss: 0.6150575 Best vali loss: 0.6150575
	iters: 100, epoch: 5 | loss: 0.8110390
	speed: 0.0104s/iter; left time: 9.1571s
	iters: 200, epoch: 5 | loss: 0.8511132
	speed: 0.0054s/iter; left time: 4.1983s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 1.3550970554351807
Epoch: 5, Steps: 245 | Train Loss: 0.8310761 Vali Loss: 0.6211950 Best vali loss: 0.6150575
	iters: 100, epoch: 6 | loss: 0.7125608
	speed: 0.0106s/iter; left time: 6.7358s
	iters: 200, epoch: 6 | loss: 1.0635175
	speed: 0.0055s/iter; left time: 2.9215s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 1.3801491260528564
Epoch: 6, Steps: 245 | Train Loss: 0.8880391 Vali Loss: 0.6230876 Best vali loss: 0.6150575
	iters: 100, epoch: 7 | loss: 0.7398782
	speed: 0.0107s/iter; left time: 4.2021s
	iters: 200, epoch: 7 | loss: 0.6865613
	speed: 0.0056s/iter; left time: 1.6176s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 1.415841817855835
Epoch: 7, Steps: 245 | Train Loss: 0.7132198 Vali Loss: 0.6223994 Best vali loss: 0.6150575
	iters: 100, epoch: 8 | loss: 0.8188084
	speed: 0.0107s/iter; left time: 1.5591s
	iters: 200, epoch: 8 | loss: 0.7181499
	speed: 0.0054s/iter; left time: 0.2478s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3662328720092773
Epoch: 8, Steps: 245 | Train Loss: 0.7684792 Vali Loss: 0.6228969 Best vali loss: 0.6150575

best validation loss 0.6150574718620533

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020819777573, 'e_layers': 2, 'learning_rate': 0.0002951222723, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0349145
	speed: 0.0109s/iter; left time: 9.6904s
Updating learning rate to 0.00028388984963309636
Validation loss decreased (inf --> 0.5978).  Saving model state dict ...
Epoch: 1 cost time: 0.947718620300293
Epoch: 1, Steps: 123 | Train Loss: 1.0349145 Vali Loss: 0.5978459 Best vali loss: 0.5978459
	iters: 100, epoch: 2 | loss: 0.6441575
	speed: 0.0082s/iter; left time: 6.2267s
Updating learning rate to 0.00025190261616125643
Validation loss decreased (0.5978 --> 0.5529).  Saving model state dict ...
Epoch: 2 cost time: 0.6324455738067627
Epoch: 2, Steps: 123 | Train Loss: 0.6441575 Vali Loss: 0.5528888 Best vali loss: 0.5528888
	iters: 100, epoch: 3 | loss: 0.7229391
	speed: 0.0082s/iter; left time: 5.2178s
Updating learning rate to 0.00020403033821557434
Validation loss decreased (0.5529 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 0.6234073638916016
Epoch: 3, Steps: 123 | Train Loss: 0.7229391 Vali Loss: 0.5464152 Best vali loss: 0.5464152

best validation loss 0.5464152032056929

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.002721607578, 'e_layers': 2, 'learning_rate': 0.0006315212558, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7662253
	speed: 0.0106s/iter; left time: 9.3603s
Updating learning rate to 0.0006074854091897224
Validation loss decreased (inf --> 0.6201).  Saving model state dict ...
Epoch: 1 cost time: 0.9042706489562988
Epoch: 1, Steps: 123 | Train Loss: 0.7662253 Vali Loss: 0.6200589 Best vali loss: 0.6200589
	iters: 100, epoch: 2 | loss: 0.9211395
	speed: 0.0076s/iter; left time: 5.7778s
Updating learning rate to 0.0005390371091198122
Validation loss decreased (0.6201 --> 0.6087).  Saving model state dict ...
Epoch: 2 cost time: 0.5967094898223877
Epoch: 2, Steps: 123 | Train Loss: 0.9211395 Vali Loss: 0.6086835 Best vali loss: 0.6086835
	iters: 100, epoch: 3 | loss: 1.0214025
	speed: 0.0078s/iter; left time: 4.9940s
Updating learning rate to 0.00043659698879052795
Validation loss decreased (0.6087 --> 0.5604).  Saving model state dict ...
Epoch: 3 cost time: 0.6056711673736572
Epoch: 3, Steps: 123 | Train Loss: 1.0214025 Vali Loss: 0.5603547 Best vali loss: 0.5603547

best validation loss 0.5603546854358533

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0407976
	speed: 0.0106s/iter; left time: 9.4090s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.6169).  Saving model state dict ...
Epoch: 1 cost time: 0.9019432067871094
Epoch: 1, Steps: 123 | Train Loss: 1.0407976 Vali Loss: 0.6169147 Best vali loss: 0.6169147
	iters: 100, epoch: 2 | loss: 0.9655769
	speed: 0.0076s/iter; left time: 5.8166s
Updating learning rate to 0.0013289867186133768
Epoch: 2 cost time: 0.5824193954467773
Epoch: 2, Steps: 123 | Train Loss: 0.9655769 Vali Loss: 0.6298867 Best vali loss: 0.6169147
	iters: 100, epoch: 3 | loss: 1.0160837
	speed: 0.0075s/iter; left time: 4.7977s
Updating learning rate to 0.0010764223643835189
Validation loss decreased (0.6169 --> 0.6142).  Saving model state dict ...
Epoch: 3 cost time: 0.5961802005767822
Epoch: 3, Steps: 123 | Train Loss: 1.0160837 Vali Loss: 0.6142055 Best vali loss: 0.6142055

best validation loss 0.6142054898823813

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020819777573, 'e_layers': 2, 'learning_rate': 0.0002951222723, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9144149
	speed: 0.0112s/iter; left time: 5.7969s
Updating learning rate to 0.00014756113615
Validation loss decreased (0.5464 --> 0.5432).  Saving model state dict ...
Epoch: 4 cost time: 0.9468879699707031
Epoch: 4, Steps: 123 | Train Loss: 0.9144149 Vali Loss: 0.5432124 Best vali loss: 0.5432124
	iters: 100, epoch: 5 | loss: 0.5982913
	speed: 0.0081s/iter; left time: 3.1977s
Updating learning rate to 9.109193408442569e-05
Epoch: 5 cost time: 0.6291816234588623
Epoch: 5, Steps: 123 | Train Loss: 0.5982913 Vali Loss: 0.5442929 Best vali loss: 0.5432124
	iters: 100, epoch: 6 | loss: 0.6550574
	speed: 0.0081s/iter; left time: 2.1807s
Updating learning rate to 4.321965613874361e-05
Epoch: 6 cost time: 0.6398181915283203
Epoch: 6, Steps: 123 | Train Loss: 0.6550574 Vali Loss: 0.5478166 Best vali loss: 0.5432124
	iters: 100, epoch: 7 | loss: 0.6159468
	speed: 0.0079s/iter; left time: 1.1559s
Updating learning rate to 1.1232422666903667e-05
Validation loss decreased (0.5432 --> 0.5372).  Saving model state dict ...
Epoch: 7 cost time: 0.6049201488494873
Epoch: 7, Steps: 123 | Train Loss: 0.6159468 Vali Loss: 0.5371588 Best vali loss: 0.5371588
	iters: 100, epoch: 8 | loss: 0.4897189
	speed: 0.0079s/iter; left time: 0.1895s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6020655632019043
Epoch: 8, Steps: 123 | Train Loss: 0.4897189 Vali Loss: 0.5436601 Best vali loss: 0.5371588

best validation loss 0.5371587624543246

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 0.7895462512969971
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6111795 Best vali loss: 0.6111795
Updating learning rate to 0.0009137180420535848
Validation loss decreased (0.6112 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.5078744888305664
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5994600 Best vali loss: 0.5994600
Updating learning rate to 0.0007400725089513316
Validation loss decreased (0.5995 --> 0.5910).  Saving model state dict ...
Epoch: 3 cost time: 0.5093457698822021
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5910370 Best vali loss: 0.5910370
Updating learning rate to 0.00053524363685
Validation loss decreased (0.5910 --> 0.5890).  Saving model state dict ...
Epoch: 4 cost time: 0.5082111358642578
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5889950 Best vali loss: 0.5889950
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.5003397464752197
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5935864 Best vali loss: 0.5889950
Updating learning rate to 0.00015676923164641517
Validation loss decreased (0.5890 --> 0.5785).  Saving model state dict ...
Epoch: 6 cost time: 0.5173966884613037
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5784736 Best vali loss: 0.5784736
Updating learning rate to 4.0742995857381066e-05
Validation loss decreased (0.5785 --> 0.5773).  Saving model state dict ...
Epoch: 7 cost time: 0.5109539031982422
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5773495 Best vali loss: 0.5773495
Updating learning rate to 0.0
Validation loss decreased (0.5773 --> 0.5742).  Saving model state dict ...
Epoch: 8 cost time: 0.49477195739746094
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5742282 Best vali loss: 0.5742282

best validation loss 0.5742281729123594

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010009396295, 'e_layers': 2, 'learning_rate': 0.0003000150065, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744895
	speed: 0.0117s/iter; left time: 10.3334s
Updating learning rate to 0.00028859636522579537
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0125377178192139
Epoch: 1, Steps: 123 | Train Loss: 0.7744895 Vali Loss: 0.6174202 Best vali loss: 0.6174202
	iters: 100, epoch: 2 | loss: 0.9553176
	speed: 0.0091s/iter; left time: 6.9237s
Updating learning rate to 0.00025607882602693806
Validation loss decreased (0.6174 --> 0.5644).  Saving model state dict ...
Epoch: 2 cost time: 0.7067289352416992
Epoch: 2, Steps: 123 | Train Loss: 0.9553176 Vali Loss: 0.5643597 Best vali loss: 0.5643597
	iters: 100, epoch: 3 | loss: 0.8591191
	speed: 0.0091s/iter; left time: 5.8059s
Updating learning rate to 0.00020741288947422737
Validation loss decreased (0.5644 --> 0.5523).  Saving model state dict ...
Epoch: 3 cost time: 0.7107827663421631
Epoch: 3, Steps: 123 | Train Loss: 0.8591191 Vali Loss: 0.5523093 Best vali loss: 0.5523093
	iters: 100, epoch: 4 | loss: 0.4887874
	speed: 0.0092s/iter; left time: 4.7499s
Updating learning rate to 0.00015000750325
Validation loss decreased (0.5523 --> 0.5389).  Saving model state dict ...
Epoch: 4 cost time: 0.711897611618042
Epoch: 4, Steps: 123 | Train Loss: 0.4887874 Vali Loss: 0.5389432 Best vali loss: 0.5389432
	iters: 100, epoch: 5 | loss: 0.5748597
	speed: 0.0092s/iter; left time: 3.6195s
Updating learning rate to 9.260211702577265e-05
Validation loss decreased (0.5389 --> 0.5298).  Saving model state dict ...
Epoch: 5 cost time: 0.7162883281707764
Epoch: 5, Steps: 123 | Train Loss: 0.5748597 Vali Loss: 0.5297563 Best vali loss: 0.5297563
	iters: 100, epoch: 6 | loss: 0.5914973
	speed: 0.0091s/iter; left time: 2.4649s
Updating learning rate to 4.3936180473061945e-05
Epoch: 6 cost time: 0.7184405326843262
Epoch: 6, Steps: 123 | Train Loss: 0.5914973 Vali Loss: 0.5420622 Best vali loss: 0.5297563
	iters: 100, epoch: 7 | loss: 0.5364335
	speed: 0.0089s/iter; left time: 1.3025s
Updating learning rate to 1.1418641274204675e-05
Epoch: 7 cost time: 0.7062990665435791
Epoch: 7, Steps: 123 | Train Loss: 0.5364335 Vali Loss: 0.5384202 Best vali loss: 0.5297563
	iters: 100, epoch: 8 | loss: 0.6960828
	speed: 0.0089s/iter; left time: 0.2129s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7087588310241699
Epoch: 8, Steps: 123 | Train Loss: 0.6960828 Vali Loss: 0.5491590 Best vali loss: 0.5297563

best validation loss 0.529756282226513

[INFO][abstract_intensifier.py:595] Added config 224010 and rejected config 134b22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010130180295, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7743426
	speed: 0.0118s/iter; left time: 10.4245s
Updating learning rate to 0.0002856364909941232
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0264289379119873
Epoch: 1, Steps: 123 | Train Loss: 0.7743426 Vali Loss: 0.6172638 Best vali loss: 0.6172638
	iters: 100, epoch: 2 | loss: 0.9482998
	speed: 0.0091s/iter; left time: 6.9411s
Updating learning rate to 0.0002534524550473834
Validation loss decreased (0.6173 --> 0.5679).  Saving model state dict ...
Epoch: 2 cost time: 0.7128617763519287
Epoch: 2, Steps: 123 | Train Loss: 0.9482998 Vali Loss: 0.5678760 Best vali loss: 0.5678760
	iters: 100, epoch: 3 | loss: 0.8537055
	speed: 0.0093s/iter; left time: 5.9118s
Updating learning rate to 0.0002052856413836594
Validation loss decreased (0.5679 --> 0.5457).  Saving model state dict ...
Epoch: 3 cost time: 0.7173867225646973
Epoch: 3, Steps: 123 | Train Loss: 0.8537055 Vali Loss: 0.5456771 Best vali loss: 0.5456771

best validation loss 0.5456770663181978

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011753821497, 'e_layers': 2, 'learning_rate': 0.0002995012541, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8426409
	speed: 0.0112s/iter; left time: 9.8900s
Updating learning rate to 0.00028810216636222607
Validation loss decreased (inf --> 0.5942).  Saving model state dict ...
Epoch: 1 cost time: 0.942267656326294
Epoch: 1, Steps: 123 | Train Loss: 0.8426409 Vali Loss: 0.5941850 Best vali loss: 0.5941850
	iters: 100, epoch: 2 | loss: 0.7468863
	speed: 0.0075s/iter; left time: 5.6983s
Updating learning rate to 0.0002556403109239926
Validation loss decreased (0.5942 --> 0.5842).  Saving model state dict ...
Epoch: 2 cost time: 0.5757451057434082
Epoch: 2, Steps: 123 | Train Loss: 0.7468863 Vali Loss: 0.5842364 Best vali loss: 0.5842364
	iters: 100, epoch: 3 | loss: 0.6731074
	speed: 0.0079s/iter; left time: 5.0445s
Updating learning rate to 0.00020705771100831848
Validation loss decreased (0.5842 --> 0.5573).  Saving model state dict ...
Epoch: 3 cost time: 0.6215622425079346
Epoch: 3, Steps: 123 | Train Loss: 0.6731074 Vali Loss: 0.5573023 Best vali loss: 0.5573023

best validation loss 0.5573023057050145

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008034602277, 'e_layers': 2, 'learning_rate': 0.0002965424755, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8426582
	speed: 0.0109s/iter; left time: 9.6761s
Updating learning rate to 0.00028525599956733986
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9313383102416992
Epoch: 1, Steps: 123 | Train Loss: 0.8426582 Vali Loss: 0.5942755 Best vali loss: 0.5942755
	iters: 100, epoch: 2 | loss: 0.7272866
	speed: 0.0075s/iter; left time: 5.7304s
Updating learning rate to 0.0002531148354179478
Validation loss decreased (0.5943 --> 0.5758).  Saving model state dict ...
Epoch: 2 cost time: 0.5890395641326904
Epoch: 2, Steps: 123 | Train Loss: 0.7272866 Vali Loss: 0.5757846 Best vali loss: 0.5757846
	iters: 100, epoch: 3 | loss: 0.6512867
	speed: 0.0081s/iter; left time: 5.1872s
Updating learning rate to 0.0002050121839331903
Validation loss decreased (0.5758 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 0.6320037841796875
Epoch: 3, Steps: 123 | Train Loss: 0.6512867 Vali Loss: 0.5520537 Best vali loss: 0.5520537

best validation loss 0.5520537162698678

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010130180295, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5912713
	speed: 0.0119s/iter; left time: 6.1172s
Updating learning rate to 0.00014846901075
Validation loss decreased (0.5457 --> 0.5326).  Saving model state dict ...
Epoch: 4 cost time: 1.0175492763519287
Epoch: 4, Steps: 123 | Train Loss: 0.5912713 Vali Loss: 0.5325838 Best vali loss: 0.5325838
	iters: 100, epoch: 5 | loss: 0.8272696
	speed: 0.0092s/iter; left time: 3.6123s
Updating learning rate to 9.16523801163406e-05
Validation loss decreased (0.5326 --> 0.5285).  Saving model state dict ...
Epoch: 5 cost time: 0.717698335647583
Epoch: 5, Steps: 123 | Train Loss: 0.8272696 Vali Loss: 0.5284560 Best vali loss: 0.5284560
	iters: 100, epoch: 6 | loss: 0.7653378
	speed: 0.0091s/iter; left time: 2.4682s
Updating learning rate to 4.3485566452616585e-05
Epoch: 6 cost time: 0.7161288261413574
Epoch: 6, Steps: 123 | Train Loss: 0.7653378 Vali Loss: 0.5348272 Best vali loss: 0.5284560
	iters: 100, epoch: 7 | loss: 0.4341620
	speed: 0.0089s/iter; left time: 1.3015s
Updating learning rate to 1.1301530505876794e-05
Epoch: 7 cost time: 0.7059762477874756
Epoch: 7, Steps: 123 | Train Loss: 0.4341620 Vali Loss: 0.5383913 Best vali loss: 0.5284560
	iters: 100, epoch: 8 | loss: 0.5090151
	speed: 0.0088s/iter; left time: 0.2120s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.711035966873169
Epoch: 8, Steps: 123 | Train Loss: 0.5090151 Vali Loss: 0.5387849 Best vali loss: 0.5284560

best validation loss 0.5284560396681225

[INFO][abstract_intensifier.py:595] Added config 242b38 and rejected config 224010 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745802
	speed: 0.0117s/iter; left time: 10.3346s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0224230289459229
Epoch: 1, Steps: 123 | Train Loss: 0.7745802 Vali Loss: 0.6171102 Best vali loss: 0.6171102
	iters: 100, epoch: 2 | loss: 0.9544499
	speed: 0.0092s/iter; left time: 6.9849s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6171 --> 0.5546).  Saving model state dict ...
Epoch: 2 cost time: 0.7168009281158447
Epoch: 2, Steps: 123 | Train Loss: 0.9544499 Vali Loss: 0.5545789 Best vali loss: 0.5545789
	iters: 100, epoch: 3 | loss: 0.8472199
	speed: 0.0092s/iter; left time: 5.8976s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5546 --> 0.5449).  Saving model state dict ...
Epoch: 3 cost time: 0.7213394641876221
Epoch: 3, Steps: 123 | Train Loss: 0.8472199 Vali Loss: 0.5448908 Best vali loss: 0.5448908
	iters: 100, epoch: 4 | loss: 0.4887462
	speed: 0.0092s/iter; left time: 4.7565s
Updating learning rate to 0.0001489167575
Epoch: 4 cost time: 0.7234656810760498
Epoch: 4, Steps: 123 | Train Loss: 0.4887462 Vali Loss: 0.5485595 Best vali loss: 0.5448908
	iters: 100, epoch: 5 | loss: 0.5630013
	speed: 0.0089s/iter; left time: 3.4908s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5449 --> 0.5275).  Saving model state dict ...
Epoch: 5 cost time: 0.719386100769043
Epoch: 5, Steps: 123 | Train Loss: 0.5630013 Vali Loss: 0.5274810 Best vali loss: 0.5274810
	iters: 100, epoch: 6 | loss: 0.5893302
	speed: 0.0093s/iter; left time: 2.5134s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7223389148712158
Epoch: 6, Steps: 123 | Train Loss: 0.5893302 Vali Loss: 0.5404660 Best vali loss: 0.5274810
	iters: 100, epoch: 7 | loss: 0.5425379
	speed: 0.0090s/iter; left time: 1.3239s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7224955558776855
Epoch: 7, Steps: 123 | Train Loss: 0.5425379 Vali Loss: 0.5391989 Best vali loss: 0.5274810
	iters: 100, epoch: 8 | loss: 0.6988305
	speed: 0.0089s/iter; left time: 0.2140s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7149467468261719
Epoch: 8, Steps: 123 | Train Loss: 0.6988305 Vali Loss: 0.5442483 Best vali loss: 0.5274810

best validation loss 0.5274810271647064

[INFO][abstract_intensifier.py:595] Added config 948305 and rejected config 242b38 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009262709091, 'e_layers': 2, 'learning_rate': 0.0002990987163, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8427082
	speed: 0.0110s/iter; left time: 9.6985s
Updating learning rate to 0.000287714949244985
Validation loss decreased (inf --> 0.5942).  Saving model state dict ...
Epoch: 1 cost time: 0.9302067756652832
Epoch: 1, Steps: 123 | Train Loss: 0.8427082 Vali Loss: 0.5942209 Best vali loss: 0.5942209
	iters: 100, epoch: 2 | loss: 0.7616809
	speed: 0.0080s/iter; left time: 6.0722s
Updating learning rate to 0.00025529672341996067
Validation loss decreased (0.5942 --> 0.5856).  Saving model state dict ...
Epoch: 2 cost time: 0.6069173812866211
Epoch: 2, Steps: 123 | Train Loss: 0.7616809 Vali Loss: 0.5855864 Best vali loss: 0.5855864
	iters: 100, epoch: 3 | loss: 0.6661965
	speed: 0.0076s/iter; left time: 4.8287s
Updating learning rate to 0.0002067794198348381
Validation loss decreased (0.5856 --> 0.5558).  Saving model state dict ...
Epoch: 3 cost time: 0.571765661239624
Epoch: 3, Steps: 123 | Train Loss: 0.6661965 Vali Loss: 0.5557867 Best vali loss: 0.5557867
	iters: 100, epoch: 4 | loss: 0.6713341
	speed: 0.0079s/iter; left time: 4.0845s
Updating learning rate to 0.00014954935815
Validation loss decreased (0.5558 --> 0.5542).  Saving model state dict ...
Epoch: 4 cost time: 0.6063435077667236
Epoch: 4, Steps: 123 | Train Loss: 0.6713341 Vali Loss: 0.5542314 Best vali loss: 0.5542314
	iters: 100, epoch: 5 | loss: 0.4947367
	speed: 0.0077s/iter; left time: 3.0090s
Updating learning rate to 9.231929646516189e-05
Validation loss decreased (0.5542 --> 0.5411).  Saving model state dict ...
Epoch: 5 cost time: 0.5926108360290527
Epoch: 5, Steps: 123 | Train Loss: 0.4947367 Vali Loss: 0.5410541 Best vali loss: 0.5410541
	iters: 100, epoch: 6 | loss: 0.7684036
	speed: 0.0080s/iter; left time: 2.1574s
Updating learning rate to 4.380199288003933e-05
Validation loss decreased (0.5411 --> 0.5392).  Saving model state dict ...
Epoch: 6 cost time: 0.6348552703857422
Epoch: 6, Steps: 123 | Train Loss: 0.7684036 Vali Loss: 0.5392085 Best vali loss: 0.5392085
	iters: 100, epoch: 7 | loss: 0.5997790
	speed: 0.0075s/iter; left time: 1.1054s
Updating learning rate to 1.138376705501501e-05
Epoch: 7 cost time: 0.5634386539459229
Epoch: 7, Steps: 123 | Train Loss: 0.5997790 Vali Loss: 0.5445068 Best vali loss: 0.5392085
	iters: 100, epoch: 8 | loss: 0.8481183
	speed: 0.0076s/iter; left time: 0.1826s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5881936550140381
Epoch: 8, Steps: 123 | Train Loss: 0.8481183 Vali Loss: 0.5402118 Best vali loss: 0.5392085

best validation loss 0.5392085077695303

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472309171, 'e_layers': 2, 'learning_rate': 0.0002974376527, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4809817
	speed: 0.0097s/iter; left time: 37.1523s
	iters: 200, epoch: 1 | loss: 1.1571374
	speed: 0.0037s/iter; left time: 13.9522s
	iters: 300, epoch: 1 | loss: 0.9517710
	speed: 0.0038s/iter; left time: 13.5933s
	iters: 400, epoch: 1 | loss: 0.9033924
	speed: 0.0037s/iter; left time: 12.9956s
Updating learning rate to 0.00028611710611386527
Validation loss decreased (inf --> 0.6022).  Saving model state dict ...
Epoch: 1 cost time: 2.1771693229675293
Epoch: 1, Steps: 490 | Train Loss: 1.1233206 Vali Loss: 0.6021637 Best vali loss: 0.6021637
	iters: 100, epoch: 2 | loss: 0.3007450
	speed: 0.0107s/iter; left time: 35.5796s
	iters: 200, epoch: 2 | loss: 1.0621248
	speed: 0.0036s/iter; left time: 11.5280s
	iters: 300, epoch: 2 | loss: 1.3192039
	speed: 0.0036s/iter; left time: 11.1785s
	iters: 400, epoch: 2 | loss: 0.3856592
	speed: 0.0036s/iter; left time: 11.0110s
Updating learning rate to 0.0002538789169521896
Epoch: 2 cost time: 1.8245325088500977
Epoch: 2, Steps: 490 | Train Loss: 0.7669332 Vali Loss: 0.6188779 Best vali loss: 0.6021637
	iters: 100, epoch: 3 | loss: 1.0134889
	speed: 0.0106s/iter; left time: 30.0171s
	iters: 200, epoch: 3 | loss: 0.9314197
	speed: 0.0037s/iter; left time: 10.1132s
	iters: 300, epoch: 3 | loss: 0.4040006
	speed: 0.0036s/iter; left time: 9.5858s
	iters: 400, epoch: 3 | loss: 1.5525346
	speed: 0.0037s/iter; left time: 9.3436s
Updating learning rate to 0.00020563105727492578
Validation loss decreased (0.6022 --> 0.6009).  Saving model state dict ...
Epoch: 3 cost time: 1.8573970794677734
Epoch: 3, Steps: 490 | Train Loss: 0.9753609 Vali Loss: 0.6008924 Best vali loss: 0.6008924

best validation loss 0.6008924266107101

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010758803653, 'e_layers': 2, 'learning_rate': 0.0002990987163, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4809005
	speed: 0.0099s/iter; left time: 37.9350s
	iters: 200, epoch: 1 | loss: 1.1579280
	speed: 0.0036s/iter; left time: 13.3784s
	iters: 300, epoch: 1 | loss: 0.9517198
	speed: 0.0038s/iter; left time: 13.7205s
	iters: 400, epoch: 1 | loss: 0.9276215
	speed: 0.0036s/iter; left time: 12.8110s
Updating learning rate to 0.000287714949244985
Validation loss decreased (inf --> 0.6037).  Saving model state dict ...
Epoch: 1 cost time: 2.1641175746917725
Epoch: 1, Steps: 490 | Train Loss: 1.1295425 Vali Loss: 0.6037419 Best vali loss: 0.6037419
	iters: 100, epoch: 2 | loss: 0.3131953
	speed: 0.0108s/iter; left time: 36.0245s
	iters: 200, epoch: 2 | loss: 1.0882373
	speed: 0.0036s/iter; left time: 11.7277s
	iters: 300, epoch: 2 | loss: 1.2499574
	speed: 0.0036s/iter; left time: 11.3671s
	iters: 400, epoch: 2 | loss: 0.4044083
	speed: 0.0035s/iter; left time: 10.4992s
Updating learning rate to 0.00025529672341996067
Epoch: 2 cost time: 1.7875378131866455
Epoch: 2, Steps: 490 | Train Loss: 0.7639496 Vali Loss: 0.6158446 Best vali loss: 0.6037419
	iters: 100, epoch: 3 | loss: 1.0368263
	speed: 0.0102s/iter; left time: 28.8549s
	iters: 200, epoch: 3 | loss: 0.9262934
	speed: 0.0037s/iter; left time: 10.0441s
	iters: 300, epoch: 3 | loss: 0.3893016
	speed: 0.0037s/iter; left time: 9.7633s
	iters: 400, epoch: 3 | loss: 1.5318536
	speed: 0.0037s/iter; left time: 9.4423s
Updating learning rate to 0.0002067794198348381
Validation loss decreased (0.6037 --> 0.6021).  Saving model state dict ...
Epoch: 3 cost time: 1.8677117824554443
Epoch: 3, Steps: 490 | Train Loss: 0.9710687 Vali Loss: 0.6020556 Best vali loss: 0.6020556

best validation loss 0.6020556269062718

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010514468849, 'e_layers': 1, 'learning_rate': 6.02610618e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0276065
	speed: 0.0097s/iter; left time: 8.5842s
Updating learning rate to 5.796751170220888e-05
Validation loss decreased (inf --> 0.6122).  Saving model state dict ...
Epoch: 1 cost time: 0.7867758274078369
Epoch: 1, Steps: 123 | Train Loss: 1.0276065 Vali Loss: 0.6122449 Best vali loss: 0.6122449
	iters: 100, epoch: 2 | loss: 0.7176148
	speed: 0.0065s/iter; left time: 4.9729s
Updating learning rate to 5.1436033620140804e-05
Validation loss decreased (0.6122 --> 0.6021).  Saving model state dict ...
Epoch: 2 cost time: 0.49379444122314453
Epoch: 2, Steps: 123 | Train Loss: 0.7176148 Vali Loss: 0.6020940 Best vali loss: 0.6020940
	iters: 100, epoch: 3 | loss: 0.6471149
	speed: 0.0071s/iter; left time: 4.5317s
Updating learning rate to 4.16609858837944e-05
Epoch: 3 cost time: 0.4991002082824707
Epoch: 3, Steps: 123 | Train Loss: 0.6471149 Vali Loss: 0.6024114 Best vali loss: 0.6020940

best validation loss 0.6020939778752042

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472309171, 'e_layers': 2, 'learning_rate': 0.0002974376527, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.4099787
	speed: 0.0100s/iter; left time: 23.4758s
	iters: 200, epoch: 4 | loss: 1.1035465
	speed: 0.0037s/iter; left time: 8.2213s
	iters: 300, epoch: 4 | loss: 0.8735166
	speed: 0.0036s/iter; left time: 7.7994s
	iters: 400, epoch: 4 | loss: 0.6747413
	speed: 0.0036s/iter; left time: 7.4573s
Updating learning rate to 0.00014871882635
Validation loss decreased (0.6009 --> 0.5711).  Saving model state dict ...
Epoch: 4 cost time: 2.14839506149292
Epoch: 4, Steps: 490 | Train Loss: 1.0154458 Vali Loss: 0.5710780 Best vali loss: 0.5710780
	iters: 100, epoch: 5 | loss: 0.2841341
	speed: 0.0109s/iter; left time: 20.2218s
	iters: 200, epoch: 5 | loss: 0.9624574
	speed: 0.0037s/iter; left time: 6.4449s
	iters: 300, epoch: 5 | loss: 1.0130953
	speed: 0.0037s/iter; left time: 6.1347s
	iters: 400, epoch: 5 | loss: 0.3248127
	speed: 0.0038s/iter; left time: 5.8877s
Updating learning rate to 9.180659542507426e-05
Validation loss decreased (0.5711 --> 0.5597).  Saving model state dict ...
Epoch: 5 cost time: 1.8459603786468506
Epoch: 5, Steps: 490 | Train Loss: 0.6461248 Vali Loss: 0.5597334 Best vali loss: 0.5597334
	iters: 100, epoch: 6 | loss: 0.9671859
	speed: 0.0107s/iter; left time: 14.6979s
	iters: 200, epoch: 6 | loss: 0.8784743
	speed: 0.0035s/iter; left time: 4.4948s
	iters: 300, epoch: 6 | loss: 0.3375077
	speed: 0.0035s/iter; left time: 4.0616s
	iters: 400, epoch: 6 | loss: 1.4037499
	speed: 0.0035s/iter; left time: 3.7144s
Updating learning rate to 4.35587357478104e-05
Epoch: 6 cost time: 1.7606523036956787
Epoch: 6, Steps: 490 | Train Loss: 0.8967294 Vali Loss: 0.5795304 Best vali loss: 0.5597334
	iters: 100, epoch: 7 | loss: 0.4311194
	speed: 0.0100s/iter; left time: 8.7930s
	iters: 200, epoch: 7 | loss: 0.6929238
	speed: 0.0034s/iter; left time: 2.6288s
	iters: 300, epoch: 7 | loss: 0.7924815
	speed: 0.0033s/iter; left time: 2.2287s
	iters: 400, epoch: 7 | loss: 0.5394740
	speed: 0.0033s/iter; left time: 1.9020s
Updating learning rate to 1.1320546586134769e-05
Epoch: 7 cost time: 1.6758689880371094
Epoch: 7, Steps: 490 | Train Loss: 0.6139997 Vali Loss: 0.5828535 Best vali loss: 0.5597334
	iters: 100, epoch: 8 | loss: 0.4517894
	speed: 0.0101s/iter; left time: 3.9396s
	iters: 200, epoch: 8 | loss: 0.6478503
	speed: 0.0034s/iter; left time: 1.0025s
	iters: 300, epoch: 8 | loss: 0.6000284
	speed: 0.0035s/iter; left time: 0.6780s
	iters: 400, epoch: 8 | loss: 0.6807742
	speed: 0.0035s/iter; left time: 0.3140s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7464935779571533
Epoch: 8, Steps: 490 | Train Loss: 0.5951106 Vali Loss: 0.5859866 Best vali loss: 0.5597334

best validation loss 0.5597333837057473

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001055205604, 'e_layers': 1, 'learning_rate': 5.38266041e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0300264
	speed: 0.0097s/iter; left time: 8.6173s
Updating learning rate to 5.1777950966289055e-05
Validation loss decreased (inf --> 0.6155).  Saving model state dict ...
Epoch: 1 cost time: 0.7992215156555176
Epoch: 1, Steps: 123 | Train Loss: 1.0300264 Vali Loss: 0.6155165 Best vali loss: 0.6155165
	iters: 100, epoch: 2 | loss: 0.7180842
	speed: 0.0067s/iter; left time: 5.1086s
Updating learning rate to 4.594388043367681e-05
Validation loss decreased (0.6155 --> 0.6029).  Saving model state dict ...
Epoch: 2 cost time: 0.49230432510375977
Epoch: 2, Steps: 123 | Train Loss: 0.7180842 Vali Loss: 0.6028516 Best vali loss: 0.6028516
	iters: 100, epoch: 3 | loss: 0.6469284
	speed: 0.0066s/iter; left time: 4.2170s
Updating learning rate to 3.721257685477241e-05
Validation loss decreased (0.6029 --> 0.6027).  Saving model state dict ...
Epoch: 3 cost time: 0.482574462890625
Epoch: 3, Steps: 123 | Train Loss: 0.6469284 Vali Loss: 0.6027051 Best vali loss: 0.6027051
	iters: 100, epoch: 4 | loss: 0.7017209
	speed: 0.0066s/iter; left time: 3.4140s
Updating learning rate to 2.691330205e-05
Epoch: 4 cost time: 0.4920511245727539
Epoch: 4, Steps: 123 | Train Loss: 0.7017209 Vali Loss: 0.6055182 Best vali loss: 0.6027051
	iters: 100, epoch: 5 | loss: 0.6542613
	speed: 0.0064s/iter; left time: 2.5054s
Updating learning rate to 1.6614027245227593e-05
Epoch: 5 cost time: 0.4844400882720947
Epoch: 5, Steps: 123 | Train Loss: 0.6542613 Vali Loss: 0.6036994 Best vali loss: 0.6027051
	iters: 100, epoch: 6 | loss: 0.7766158
	speed: 0.0064s/iter; left time: 1.7368s
Updating learning rate to 7.88272366632319e-06
Epoch: 6 cost time: 0.4865586757659912
Epoch: 6, Steps: 123 | Train Loss: 0.7766158 Vali Loss: 0.6039310 Best vali loss: 0.6027051
	iters: 100, epoch: 7 | loss: 0.7040679
	speed: 0.0066s/iter; left time: 0.9731s
Updating learning rate to 2.048653133710945e-06
Epoch: 7 cost time: 0.5016908645629883
Epoch: 7, Steps: 123 | Train Loss: 0.7040679 Vali Loss: 0.6035728 Best vali loss: 0.6027051
	iters: 100, epoch: 8 | loss: 0.6704918
	speed: 0.0066s/iter; left time: 0.1579s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5002343654632568
Epoch: 8, Steps: 123 | Train Loss: 0.6704918 Vali Loss: 0.6033596 Best vali loss: 0.6027051

best validation loss 0.602705086893861

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010707413432, 'e_layers': 1, 'learning_rate': 0.0002949280094, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6453524
	speed: 0.0088s/iter; left time: 33.6348s
	iters: 200, epoch: 1 | loss: 0.7125347
	speed: 0.0026s/iter; left time: 9.8270s
	iters: 300, epoch: 1 | loss: 1.0193950
	speed: 0.0026s/iter; left time: 9.5746s
	iters: 400, epoch: 1 | loss: 0.6437675
	speed: 0.0028s/iter; left time: 9.8009s
Updating learning rate to 0.0002837029804244782
Validation loss decreased (inf --> 0.6151).  Saving model state dict ...
Epoch: 1 cost time: 1.6635677814483643
Epoch: 1, Steps: 490 | Train Loss: 0.7552624 Vali Loss: 0.6150966 Best vali loss: 0.6150966
	iters: 100, epoch: 2 | loss: 1.1452004
	speed: 0.0084s/iter; left time: 27.9845s
	iters: 200, epoch: 2 | loss: 0.8493786
	speed: 0.0027s/iter; left time: 8.7559s
	iters: 300, epoch: 2 | loss: 0.4450568
	speed: 0.0027s/iter; left time: 8.3409s
	iters: 400, epoch: 2 | loss: 0.4878719
	speed: 0.0027s/iter; left time: 8.0364s
Updating learning rate to 0.00025173680240429494
Validation loss decreased (0.6151 --> 0.6087).  Saving model state dict ...
Epoch: 2 cost time: 1.3460760116577148
Epoch: 2, Steps: 490 | Train Loss: 0.7318769 Vali Loss: 0.6086794 Best vali loss: 0.6086794
	iters: 100, epoch: 3 | loss: 0.7815678
	speed: 0.0083s/iter; left time: 23.6002s
	iters: 200, epoch: 3 | loss: 0.6315019
	speed: 0.0027s/iter; left time: 7.3698s
	iters: 300, epoch: 3 | loss: 0.7455720
	speed: 0.0027s/iter; left time: 7.2354s
	iters: 400, epoch: 3 | loss: 0.7653777
	speed: 0.0027s/iter; left time: 6.9116s
Updating learning rate to 0.00020389603616889775
Epoch: 3 cost time: 1.364194631576538
Epoch: 3, Steps: 490 | Train Loss: 0.7310048 Vali Loss: 0.6162432 Best vali loss: 0.6086794
	iters: 100, epoch: 4 | loss: 0.7221636
	speed: 0.0082s/iter; left time: 19.1661s
	iters: 200, epoch: 4 | loss: 0.7219757
	speed: 0.0027s/iter; left time: 6.0266s
	iters: 300, epoch: 4 | loss: 1.2715820
	speed: 0.0025s/iter; left time: 5.4353s
	iters: 400, epoch: 4 | loss: 0.5426651
	speed: 0.0026s/iter; left time: 5.2938s
Updating learning rate to 0.0001474640047
Epoch: 4 cost time: 1.3229503631591797
Epoch: 4, Steps: 490 | Train Loss: 0.8145966 Vali Loss: 0.6405668 Best vali loss: 0.6086794
	iters: 100, epoch: 5 | loss: 0.6662193
	speed: 0.0081s/iter; left time: 15.0771s
	iters: 200, epoch: 5 | loss: 0.6753318
	speed: 0.0025s/iter; left time: 4.4739s
	iters: 300, epoch: 5 | loss: 0.8861976
	speed: 0.0026s/iter; left time: 4.2623s
	iters: 400, epoch: 5 | loss: 0.2881964
	speed: 0.0026s/iter; left time: 4.0027s
Updating learning rate to 9.103197323110228e-05
Epoch: 5 cost time: 1.312105417251587
Epoch: 5, Steps: 490 | Train Loss: 0.6289863 Vali Loss: 0.6304898 Best vali loss: 0.6086794
	iters: 100, epoch: 6 | loss: 1.0237758
	speed: 0.0080s/iter; left time: 10.9010s
	iters: 200, epoch: 6 | loss: 0.3857132
	speed: 0.0025s/iter; left time: 3.2195s
	iters: 300, epoch: 6 | loss: 0.4080295
	speed: 0.0025s/iter; left time: 2.9090s
	iters: 400, epoch: 6 | loss: 0.3701995
	speed: 0.0024s/iter; left time: 2.6093s
Updating learning rate to 4.3191206995705096e-05
Epoch: 6 cost time: 1.2642717361450195
Epoch: 6, Steps: 490 | Train Loss: 0.5469295 Vali Loss: 0.6504828 Best vali loss: 0.6086794
	iters: 100, epoch: 7 | loss: 0.3925683
	speed: 0.0078s/iter; left time: 6.8883s
	iters: 200, epoch: 7 | loss: 0.4545189
	speed: 0.0026s/iter; left time: 2.0434s
	iters: 300, epoch: 7 | loss: 0.8677180
	speed: 0.0026s/iter; left time: 1.7559s
	iters: 400, epoch: 7 | loss: 0.7170891
	speed: 0.0025s/iter; left time: 1.4771s
Updating learning rate to 1.122502897552181e-05
Epoch: 7 cost time: 1.3063759803771973
Epoch: 7, Steps: 490 | Train Loss: 0.6079736 Vali Loss: 0.6551634 Best vali loss: 0.6086794
	iters: 100, epoch: 8 | loss: 0.5665390
	speed: 0.0078s/iter; left time: 3.0554s
	iters: 200, epoch: 8 | loss: 0.4584390
	speed: 0.0025s/iter; left time: 0.7393s
	iters: 300, epoch: 8 | loss: 0.5156670
	speed: 0.0025s/iter; left time: 0.4820s
	iters: 400, epoch: 8 | loss: 0.4489834
	speed: 0.0026s/iter; left time: 0.2402s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3056483268737793
Epoch: 8, Steps: 490 | Train Loss: 0.4974071 Vali Loss: 0.6522295 Best vali loss: 0.6086794

best validation loss 0.6086793778837417

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010659718099, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8153280
	speed: 0.0110s/iter; left time: 9.7444s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.5958).  Saving model state dict ...
Epoch: 1 cost time: 0.9570465087890625
Epoch: 1, Steps: 123 | Train Loss: 0.8153280 Vali Loss: 0.5958354 Best vali loss: 0.5958354
	iters: 100, epoch: 2 | loss: 1.0194609
	speed: 0.0087s/iter; left time: 6.5920s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.5958 --> 0.5449).  Saving model state dict ...
Epoch: 2 cost time: 0.6615839004516602
Epoch: 2, Steps: 123 | Train Loss: 1.0194609 Vali Loss: 0.5448794 Best vali loss: 0.5448794
	iters: 100, epoch: 3 | loss: 0.9248051
	speed: 0.0086s/iter; left time: 5.5211s
Updating learning rate to 0.00020590473339677975
Epoch: 3 cost time: 0.6666641235351562
Epoch: 3, Steps: 123 | Train Loss: 0.9248051 Vali Loss: 0.5499857 Best vali loss: 0.5448794

best validation loss 0.5448793507405643

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0121773
	speed: 0.0102s/iter; left time: 79.1864s
	iters: 200, epoch: 1 | loss: 0.4066912
	speed: 0.0043s/iter; left time: 32.6295s
	iters: 300, epoch: 1 | loss: 0.9715086
	speed: 0.0044s/iter; left time: 33.0825s
	iters: 400, epoch: 1 | loss: 0.7919140
	speed: 0.0043s/iter; left time: 32.2182s
	iters: 500, epoch: 1 | loss: 0.4371356
	speed: 0.0043s/iter; left time: 31.1809s
	iters: 600, epoch: 1 | loss: 1.2259285
	speed: 0.0041s/iter; left time: 29.9550s
	iters: 700, epoch: 1 | loss: 0.8209591
	speed: 0.0042s/iter; left time: 29.7141s
	iters: 800, epoch: 1 | loss: 0.9911216
	speed: 0.0040s/iter; left time: 27.9791s
	iters: 900, epoch: 1 | loss: 0.9431592
	speed: 0.0038s/iter; left time: 26.4563s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.6149).  Saving model state dict ...
Epoch: 1 cost time: 4.409304141998291
Epoch: 1, Steps: 979 | Train Loss: 0.8445106 Vali Loss: 0.6149054 Best vali loss: 0.6149054
	iters: 100, epoch: 2 | loss: 1.1198839
	speed: 0.0129s/iter; left time: 86.8291s
	iters: 200, epoch: 2 | loss: 1.2812928
	speed: 0.0040s/iter; left time: 26.5850s
	iters: 300, epoch: 2 | loss: 0.5733182
	speed: 0.0040s/iter; left time: 26.4304s
	iters: 400, epoch: 2 | loss: 0.4534515
	speed: 0.0040s/iter; left time: 25.8289s
	iters: 500, epoch: 2 | loss: 1.3925740
	speed: 0.0040s/iter; left time: 25.7182s
	iters: 600, epoch: 2 | loss: 0.9132429
	speed: 0.0039s/iter; left time: 24.6417s
	iters: 700, epoch: 2 | loss: 0.6662502
	speed: 0.0040s/iter; left time: 24.8719s
	iters: 800, epoch: 2 | loss: 0.9487270
	speed: 0.0040s/iter; left time: 24.2102s
	iters: 900, epoch: 2 | loss: 1.3637649
	speed: 0.0040s/iter; left time: 23.7822s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.6149 --> 0.6019).  Saving model state dict ...
Epoch: 2 cost time: 3.9425806999206543
Epoch: 2, Steps: 979 | Train Loss: 0.9680562 Vali Loss: 0.6018669 Best vali loss: 0.6018669
	iters: 100, epoch: 3 | loss: 0.3106252
	speed: 0.0129s/iter; left time: 74.3539s
	iters: 200, epoch: 3 | loss: 1.5609865
	speed: 0.0040s/iter; left time: 22.4224s
	iters: 300, epoch: 3 | loss: 0.6572632
	speed: 0.0040s/iter; left time: 22.3813s
	iters: 400, epoch: 3 | loss: 0.3971199
	speed: 0.0040s/iter; left time: 22.1122s
	iters: 500, epoch: 3 | loss: 0.3578473
	speed: 0.0039s/iter; left time: 20.9687s
	iters: 600, epoch: 3 | loss: 0.2608480
	speed: 0.0039s/iter; left time: 20.4044s
	iters: 700, epoch: 3 | loss: 0.7742628
	speed: 0.0039s/iter; left time: 20.0486s
	iters: 800, epoch: 3 | loss: 1.1487795
	speed: 0.0039s/iter; left time: 19.6875s
	iters: 900, epoch: 3 | loss: 0.6868919
	speed: 0.0039s/iter; left time: 19.3360s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 3.8833372592926025
Epoch: 3, Steps: 979 | Train Loss: 0.6838472 Vali Loss: 0.6054687 Best vali loss: 0.6018669

best validation loss 0.6018668856404545

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010502138737, 'e_layers': 2, 'learning_rate': 0.0002004718415, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8148571
	speed: 0.0112s/iter; left time: 9.9169s
Updating learning rate to 0.00019284183635334839
Validation loss decreased (inf --> 0.5961).  Saving model state dict ...
Epoch: 1 cost time: 0.9767003059387207
Epoch: 1, Steps: 123 | Train Loss: 0.8148571 Vali Loss: 0.5961237 Best vali loss: 0.5961237
	iters: 100, epoch: 2 | loss: 1.0120332
	speed: 0.0086s/iter; left time: 6.5167s
Updating learning rate to 0.00017111342003080235
Epoch: 2 cost time: 0.6663498878479004
Epoch: 2, Steps: 123 | Train Loss: 1.0120332 Vali Loss: 0.6398758 Best vali loss: 0.5961237
	iters: 100, epoch: 3 | loss: 0.9256971
	speed: 0.0084s/iter; left time: 5.3715s
Updating learning rate to 0.00013859454694888513
Validation loss decreased (0.5961 --> 0.5529).  Saving model state dict ...
Epoch: 3 cost time: 0.6643252372741699
Epoch: 3, Steps: 123 | Train Loss: 0.9256971 Vali Loss: 0.5529473 Best vali loss: 0.5529473

best validation loss 0.5529472903210164

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010659718099, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6621975
	speed: 0.0113s/iter; left time: 5.8291s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5449 --> 0.5343).  Saving model state dict ...
Epoch: 4 cost time: 0.9584019184112549
Epoch: 4, Steps: 123 | Train Loss: 0.6621975 Vali Loss: 0.5343327 Best vali loss: 0.5343327
	iters: 100, epoch: 5 | loss: 0.8787202
	speed: 0.0088s/iter; left time: 3.4770s
Updating learning rate to 9.192878160322029e-05
Epoch: 5 cost time: 0.6710693836212158
Epoch: 5, Steps: 123 | Train Loss: 0.8787202 Vali Loss: 0.5377478 Best vali loss: 0.5343327
	iters: 100, epoch: 6 | loss: 0.8077624
	speed: 0.0083s/iter; left time: 2.2475s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.6638481616973877
Epoch: 6, Steps: 123 | Train Loss: 0.8077624 Vali Loss: 0.5463126 Best vali loss: 0.5343327
	iters: 100, epoch: 7 | loss: 0.6667194
	speed: 0.0083s/iter; left time: 1.2263s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.6575307846069336
Epoch: 7, Steps: 123 | Train Loss: 0.6667194 Vali Loss: 0.5604401 Best vali loss: 0.5343327
	iters: 100, epoch: 8 | loss: 0.6533976
	speed: 0.0084s/iter; left time: 0.2021s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6694445610046387
Epoch: 8, Steps: 123 | Train Loss: 0.6533976 Vali Loss: 0.5574338 Best vali loss: 0.5343327

best validation loss 0.5343327473733559

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010389572031, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8413925
	speed: 0.0122s/iter; left time: 10.7909s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.5915).  Saving model state dict ...
Epoch: 1 cost time: 1.0403192043304443
Epoch: 1, Steps: 123 | Train Loss: 0.8413925 Vali Loss: 0.5915445 Best vali loss: 0.5915445
	iters: 100, epoch: 2 | loss: 0.6707217
	speed: 0.0094s/iter; left time: 7.1953s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.5915 --> 0.5890).  Saving model state dict ...
Epoch: 2 cost time: 0.742257833480835
Epoch: 2, Steps: 123 | Train Loss: 0.6707217 Vali Loss: 0.5890336 Best vali loss: 0.5890336
	iters: 100, epoch: 3 | loss: 0.5557539
	speed: 0.0096s/iter; left time: 6.1107s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5890 --> 0.5687).  Saving model state dict ...
Epoch: 3 cost time: 0.7393357753753662
Epoch: 3, Steps: 123 | Train Loss: 0.5557539 Vali Loss: 0.5687436 Best vali loss: 0.5687436
	iters: 100, epoch: 4 | loss: 0.7881002
	speed: 0.0096s/iter; left time: 4.9300s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5687 --> 0.5374).  Saving model state dict ...
Epoch: 4 cost time: 0.7376627922058105
Epoch: 4, Steps: 123 | Train Loss: 0.7881002 Vali Loss: 0.5373515 Best vali loss: 0.5373515
	iters: 100, epoch: 5 | loss: 0.5375060
	speed: 0.0094s/iter; left time: 3.6985s
Updating learning rate to 9.192878160322029e-05
Epoch: 5 cost time: 0.7419652938842773
Epoch: 5, Steps: 123 | Train Loss: 0.5375060 Vali Loss: 0.5428936 Best vali loss: 0.5373515
	iters: 100, epoch: 6 | loss: 0.7273364
	speed: 0.0092s/iter; left time: 2.4872s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7419450283050537
Epoch: 6, Steps: 123 | Train Loss: 0.7273364 Vali Loss: 0.5635696 Best vali loss: 0.5373515
	iters: 100, epoch: 7 | loss: 0.5227831
	speed: 0.0092s/iter; left time: 1.3546s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.745107889175415
Epoch: 7, Steps: 123 | Train Loss: 0.5227831 Vali Loss: 0.5676608 Best vali loss: 0.5373515
	iters: 100, epoch: 8 | loss: 0.6071731
	speed: 0.0092s/iter; left time: 0.2220s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7411823272705078
Epoch: 8, Steps: 123 | Train Loss: 0.6071731 Vali Loss: 0.5742835 Best vali loss: 0.5373515

best validation loss 0.5373515171455266

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010374706829, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8413355
	speed: 0.0124s/iter; left time: 10.9366s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.5917).  Saving model state dict ...
Epoch: 1 cost time: 1.0440025329589844
Epoch: 1, Steps: 123 | Train Loss: 0.8413355 Vali Loss: 0.5917443 Best vali loss: 0.5917443
	iters: 100, epoch: 2 | loss: 0.6750795
	speed: 0.0094s/iter; left time: 7.1780s
Updating learning rate to 0.0002542168065605627
Epoch: 2 cost time: 0.7442188262939453
Epoch: 2, Steps: 123 | Train Loss: 0.6750795 Vali Loss: 0.6087753 Best vali loss: 0.5917443
	iters: 100, epoch: 3 | loss: 0.5562989
	speed: 0.0093s/iter; left time: 5.9278s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5917 --> 0.5480).  Saving model state dict ...
Epoch: 3 cost time: 0.7476339340209961
Epoch: 3, Steps: 123 | Train Loss: 0.5562989 Vali Loss: 0.5480301 Best vali loss: 0.5480301
	iters: 100, epoch: 4 | loss: 0.7868530
	speed: 0.0097s/iter; left time: 5.0010s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5480 --> 0.5429).  Saving model state dict ...
Epoch: 4 cost time: 0.750739574432373
Epoch: 4, Steps: 123 | Train Loss: 0.7868530 Vali Loss: 0.5429371 Best vali loss: 0.5429371
	iters: 100, epoch: 5 | loss: 0.5421049
	speed: 0.0096s/iter; left time: 3.7907s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5429 --> 0.5403).  Saving model state dict ...
Epoch: 5 cost time: 0.7460122108459473
Epoch: 5, Steps: 123 | Train Loss: 0.5421049 Vali Loss: 0.5403058 Best vali loss: 0.5403058
	iters: 100, epoch: 6 | loss: 0.7368276
	speed: 0.0095s/iter; left time: 2.5522s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7450211048126221
Epoch: 6, Steps: 123 | Train Loss: 0.7368276 Vali Loss: 0.5578895 Best vali loss: 0.5403058
	iters: 100, epoch: 7 | loss: 0.5296447
	speed: 0.0092s/iter; left time: 1.3493s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7438795566558838
Epoch: 7, Steps: 123 | Train Loss: 0.5296447 Vali Loss: 0.5632521 Best vali loss: 0.5403058
	iters: 100, epoch: 8 | loss: 0.6129618
	speed: 0.0092s/iter; left time: 0.2218s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7466979026794434
Epoch: 8, Steps: 123 | Train Loss: 0.6129618 Vali Loss: 0.5723396 Best vali loss: 0.5403058

best validation loss 0.5403058197640644

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010377110816, 'e_layers': 2, 'learning_rate': 0.0002978602508, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8412973
	speed: 0.0123s/iter; left time: 10.8806s
Updating learning rate to 0.00028652362003139933
Validation loss decreased (inf --> 0.5918).  Saving model state dict ...
Epoch: 1 cost time: 1.0363504886627197
Epoch: 1, Steps: 123 | Train Loss: 0.8412973 Vali Loss: 0.5917914 Best vali loss: 0.5917914
	iters: 100, epoch: 2 | loss: 0.6643654
	speed: 0.0096s/iter; left time: 7.2803s
Updating learning rate to 0.0002542396269933029
Epoch: 2 cost time: 0.745295524597168
Epoch: 2, Steps: 123 | Train Loss: 0.6643654 Vali Loss: 0.6020857 Best vali loss: 0.5917914
	iters: 100, epoch: 3 | loss: 0.5501396
	speed: 0.0092s/iter; left time: 5.8891s
Updating learning rate to 0.00020592321697063525
Validation loss decreased (0.5918 --> 0.5554).  Saving model state dict ...
Epoch: 3 cost time: 0.7429451942443848
Epoch: 3, Steps: 123 | Train Loss: 0.5501396 Vali Loss: 0.5553803 Best vali loss: 0.5553803

best validation loss 0.5553803115959026

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010348046808, 'e_layers': 2, 'learning_rate': 0.0002981695816, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8414330
	speed: 0.0124s/iter; left time: 10.9403s
Updating learning rate to 0.000286821177628847
Validation loss decreased (inf --> 0.5912).  Saving model state dict ...
Epoch: 1 cost time: 1.0410068035125732
Epoch: 1, Steps: 123 | Train Loss: 0.8414330 Vali Loss: 0.5911941 Best vali loss: 0.5911941
	iters: 100, epoch: 2 | loss: 0.6543576
	speed: 0.0097s/iter; left time: 7.3738s
Updating learning rate to 0.0002545036573464578
Epoch: 2 cost time: 0.7434389591217041
Epoch: 2, Steps: 123 | Train Loss: 0.6543576 Vali Loss: 0.6008776 Best vali loss: 0.5911941
	iters: 100, epoch: 3 | loss: 0.5602785
	speed: 0.0091s/iter; left time: 5.8467s
Updating learning rate to 0.0002061370702567754
Validation loss decreased (0.5912 --> 0.5719).  Saving model state dict ...
Epoch: 3 cost time: 0.737715482711792
Epoch: 3, Steps: 123 | Train Loss: 0.5602785 Vali Loss: 0.5718891 Best vali loss: 0.5718891

best validation loss 0.5718891423700695

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010373146669, 'e_layers': 2, 'learning_rate': 0.0002975618571, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8415149
	speed: 0.0123s/iter; left time: 10.8628s
Updating learning rate to 0.00028623658326536915
Validation loss decreased (inf --> 0.5919).  Saving model state dict ...
Epoch: 1 cost time: 1.0475118160247803
Epoch: 1, Steps: 123 | Train Loss: 0.8415149 Vali Loss: 0.5918530 Best vali loss: 0.5918530
	iters: 100, epoch: 2 | loss: 0.6796057
	speed: 0.0098s/iter; left time: 7.4308s
Updating learning rate to 0.00025398493203893617
Validation loss decreased (0.5919 --> 0.5892).  Saving model state dict ...
Epoch: 2 cost time: 0.7542724609375
Epoch: 2, Steps: 123 | Train Loss: 0.6796057 Vali Loss: 0.5891809 Best vali loss: 0.5891809
	iters: 100, epoch: 3 | loss: 0.5542186
	speed: 0.0098s/iter; left time: 6.2406s
Updating learning rate to 0.00020571692495797918
Validation loss decreased (0.5892 --> 0.5592).  Saving model state dict ...
Epoch: 3 cost time: 0.7602057456970215
Epoch: 3, Steps: 123 | Train Loss: 0.5542186 Vali Loss: 0.5592182 Best vali loss: 0.5592182

best validation loss 0.5592181788777268

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010377110816, 'e_layers': 2, 'learning_rate': 0.0002978602508, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7365946
	speed: 0.0126s/iter; left time: 6.4830s
Updating learning rate to 0.0001489301254
Validation loss decreased (0.5554 --> 0.5357).  Saving model state dict ...
Epoch: 4 cost time: 1.0422039031982422
Epoch: 4, Steps: 123 | Train Loss: 0.7365946 Vali Loss: 0.5356744 Best vali loss: 0.5356744
	iters: 100, epoch: 5 | loss: 0.5351908
	speed: 0.0099s/iter; left time: 3.8828s
Updating learning rate to 9.193703382936478e-05
Epoch: 5 cost time: 0.7508482933044434
Epoch: 5, Steps: 123 | Train Loss: 0.5351908 Vali Loss: 0.5445297 Best vali loss: 0.5356744
	iters: 100, epoch: 6 | loss: 0.4905709
	speed: 0.0095s/iter; left time: 2.5645s
Updating learning rate to 4.3620623806697126e-05
Epoch: 6 cost time: 0.7557570934295654
Epoch: 6, Steps: 123 | Train Loss: 0.4905709 Vali Loss: 0.5655311 Best vali loss: 0.5356744
	iters: 100, epoch: 7 | loss: 0.6951847
	speed: 0.0096s/iter; left time: 1.4072s
Updating learning rate to 1.133663076860069e-05
Epoch: 7 cost time: 0.7604491710662842
Epoch: 7, Steps: 123 | Train Loss: 0.6951847 Vali Loss: 0.5580438 Best vali loss: 0.5356744
	iters: 100, epoch: 8 | loss: 0.4832869
	speed: 0.0095s/iter; left time: 0.2272s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7555761337280273
Epoch: 8, Steps: 123 | Train Loss: 0.4832869 Vali Loss: 0.5624876 Best vali loss: 0.5356744

best validation loss 0.5356744245101543

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.001037754584, 'e_layers': 2, 'learning_rate': 0.0002991960112, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8419209
	speed: 0.0126s/iter; left time: 11.1350s
Updating learning rate to 0.00028780854107834887
Validation loss decreased (inf --> 0.5910).  Saving model state dict ...
Epoch: 1 cost time: 1.06707763671875
Epoch: 1, Steps: 123 | Train Loss: 0.8419209 Vali Loss: 0.5909901 Best vali loss: 0.5909901
	iters: 100, epoch: 2 | loss: 0.6612067
	speed: 0.0098s/iter; left time: 7.4463s
Updating learning rate to 0.00025537976981174313
Validation loss decreased (0.5910 --> 0.5792).  Saving model state dict ...
Epoch: 2 cost time: 0.7625210285186768
Epoch: 2, Steps: 123 | Train Loss: 0.6612067 Vali Loss: 0.5792482 Best vali loss: 0.5792482
	iters: 100, epoch: 3 | loss: 0.5669727
	speed: 0.0099s/iter; left time: 6.3476s
Updating learning rate to 0.00020684668385797993
Validation loss decreased (0.5792 --> 0.5618).  Saving model state dict ...
Epoch: 3 cost time: 0.759516716003418
Epoch: 3, Steps: 123 | Train Loss: 0.5669727 Vali Loss: 0.5617612 Best vali loss: 0.5617612
	iters: 100, epoch: 4 | loss: 0.7881079
	speed: 0.0098s/iter; left time: 5.0821s
Updating learning rate to 0.0001495980056
Validation loss decreased (0.5618 --> 0.5379).  Saving model state dict ...
Epoch: 4 cost time: 0.7607378959655762
Epoch: 4, Steps: 123 | Train Loss: 0.7881079 Vali Loss: 0.5379453 Best vali loss: 0.5379453
	iters: 100, epoch: 5 | loss: 0.5305651
	speed: 0.0098s/iter; left time: 3.8525s
Updating learning rate to 9.234932734202009e-05
Epoch: 5 cost time: 0.7628881931304932
Epoch: 5, Steps: 123 | Train Loss: 0.5305651 Vali Loss: 0.5495139 Best vali loss: 0.5379453
	iters: 100, epoch: 6 | loss: 0.7273044
	speed: 0.0096s/iter; left time: 2.5831s
Updating learning rate to 4.38162413882569e-05
Epoch: 6 cost time: 0.759986162185669
Epoch: 6, Steps: 123 | Train Loss: 0.7273044 Vali Loss: 0.5517897 Best vali loss: 0.5379453
	iters: 100, epoch: 7 | loss: 0.5210441
	speed: 0.0096s/iter; left time: 1.4051s
Updating learning rate to 1.1387470121651145e-05
Epoch: 7 cost time: 0.7627382278442383
Epoch: 7, Steps: 123 | Train Loss: 0.5210441 Vali Loss: 0.5636810 Best vali loss: 0.5379453
	iters: 100, epoch: 8 | loss: 0.6095958
	speed: 0.0094s/iter; left time: 0.2257s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7469487190246582
Epoch: 8, Steps: 123 | Train Loss: 0.6095958 Vali Loss: 0.5764852 Best vali loss: 0.5379453

best validation loss 0.5379452922177612

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010432666739, 'e_layers': 2, 'learning_rate': 0.0003026228729, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2666076
	speed: 0.0130s/iter; left time: 11.5137s
Updating learning rate to 0.0003026228729
Validation loss decreased (inf --> 0.6255).  Saving model state dict ...
Epoch: 1 cost time: 1.1074979305267334
Epoch: 1, Steps: 123 | Train Loss: 1.2666076 Vali Loss: 0.6255015 Best vali loss: 0.6255015
	iters: 100, epoch: 2 | loss: 1.0024279
	speed: 0.0103s/iter; left time: 7.8219s
Updating learning rate to 0.00015131143645
Validation loss decreased (0.6255 --> 0.6202).  Saving model state dict ...
Epoch: 2 cost time: 0.7976169586181641
Epoch: 2, Steps: 123 | Train Loss: 1.0024279 Vali Loss: 0.6201516 Best vali loss: 0.6201516
	iters: 100, epoch: 3 | loss: 0.6947039
	speed: 0.0103s/iter; left time: 6.5702s
Updating learning rate to 7.5655718225e-05
Validation loss decreased (0.6202 --> 0.5673).  Saving model state dict ...
Epoch: 3 cost time: 0.7929530143737793
Epoch: 3, Steps: 123 | Train Loss: 0.6947039 Vali Loss: 0.5673153 Best vali loss: 0.5673153
	iters: 100, epoch: 4 | loss: 0.8586943
	speed: 0.0102s/iter; left time: 5.2410s
Updating learning rate to 3.78278591125e-05
Validation loss decreased (0.5673 --> 0.5631).  Saving model state dict ...
Epoch: 4 cost time: 0.791038990020752
Epoch: 4, Steps: 123 | Train Loss: 0.8586943 Vali Loss: 0.5630808 Best vali loss: 0.5630808
	iters: 100, epoch: 5 | loss: 0.7144141
	speed: 0.0102s/iter; left time: 3.9912s
Updating learning rate to 1.891392955625e-05
Epoch: 5 cost time: 0.7825760841369629
Epoch: 5, Steps: 123 | Train Loss: 0.7144141 Vali Loss: 0.5673566 Best vali loss: 0.5630808
	iters: 100, epoch: 6 | loss: 0.6974092
	speed: 0.0099s/iter; left time: 2.6840s
Updating learning rate to 9.456964778125e-06
Epoch: 6 cost time: 0.7866511344909668
Epoch: 6, Steps: 123 | Train Loss: 0.6974092 Vali Loss: 0.5673613 Best vali loss: 0.5630808
	iters: 100, epoch: 7 | loss: 0.4950639
	speed: 0.0098s/iter; left time: 1.4478s
Updating learning rate to 4.7284823890625e-06
Epoch: 7 cost time: 0.7831058502197266
Epoch: 7, Steps: 123 | Train Loss: 0.4950639 Vali Loss: 0.5675043 Best vali loss: 0.5630808
	iters: 100, epoch: 8 | loss: 0.5905835
	speed: 0.0098s/iter; left time: 0.2345s
Updating learning rate to 2.36424119453125e-06
Epoch: 8 cost time: 0.7850112915039062
Epoch: 8, Steps: 123 | Train Loss: 0.5905835 Vali Loss: 0.5673798 Best vali loss: 0.5630808

best validation loss 0.563080791216766

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010358632834, 'e_layers': 2, 'learning_rate': 0.0003020188159, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2660832
	speed: 0.0121s/iter; left time: 10.7310s
Updating learning rate to 0.0002905239091716522
Validation loss decreased (inf --> 0.6265).  Saving model state dict ...
Epoch: 1 cost time: 1.0889484882354736
Epoch: 1, Steps: 123 | Train Loss: 1.2660832 Vali Loss: 0.6265365 Best vali loss: 0.6265365
	iters: 100, epoch: 2 | loss: 1.0261644
	speed: 0.0101s/iter; left time: 7.7324s
Updating learning rate to 0.0002577891843344107
Validation loss decreased (0.6265 --> 0.6218).  Saving model state dict ...
Epoch: 2 cost time: 0.7936060428619385
Epoch: 2, Steps: 123 | Train Loss: 1.0261644 Vali Loss: 0.6217585 Best vali loss: 0.6217585
	iters: 100, epoch: 3 | loss: 0.7122662
	speed: 0.0102s/iter; left time: 6.5321s
Updating learning rate to 0.00020879820650372607
Validation loss decreased (0.6218 --> 0.5629).  Saving model state dict ...
Epoch: 3 cost time: 0.7791182994842529
Epoch: 3, Steps: 123 | Train Loss: 0.7122662 Vali Loss: 0.5629356 Best vali loss: 0.5629356

best validation loss 0.5629355996254141

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010401692254, 'e_layers': 2, 'learning_rate': 0.0003827307709, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7761489
	speed: 0.0117s/iter; left time: 10.3234s
Updating learning rate to 0.0003681639482983882
Validation loss decreased (inf --> 0.6175).  Saving model state dict ...
Epoch: 1 cost time: 1.0285658836364746
Epoch: 1, Steps: 123 | Train Loss: 0.7761489 Vali Loss: 0.6175268 Best vali loss: 0.6175268
	iters: 100, epoch: 2 | loss: 0.9581752
	speed: 0.0091s/iter; left time: 6.9295s
Updating learning rate to 0.00032668114718607246
Validation loss decreased (0.6175 --> 0.5714).  Saving model state dict ...
Epoch: 2 cost time: 0.7136082649230957
Epoch: 2, Steps: 123 | Train Loss: 0.9581752 Vali Loss: 0.5713766 Best vali loss: 0.5713766
	iters: 100, epoch: 3 | loss: 0.8463875
	speed: 0.0092s/iter; left time: 5.8558s
Updating learning rate to 0.0002645977479898744
Validation loss decreased (0.5714 --> 0.5641).  Saving model state dict ...
Epoch: 3 cost time: 0.712294340133667
Epoch: 3, Steps: 123 | Train Loss: 0.8463875 Vali Loss: 0.5640709 Best vali loss: 0.5640709

best validation loss 0.5640708940109683

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.6164).  Saving model state dict ...
Epoch: 1 cost time: 0.7444391250610352
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6163998 Best vali loss: 0.6163998
Updating learning rate to 0.0020113971511072134
Validation loss decreased (0.6164 --> 0.6012).  Saving model state dict ...
Epoch: 2 cost time: 0.44727325439453125
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6011962 Best vali loss: 0.6011962
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.4560527801513672
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6123616 Best vali loss: 0.6011962

best validation loss 0.6011962271961334

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010358632834, 'e_layers': 2, 'learning_rate': 0.0003020188159, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9767019
	speed: 0.0126s/iter; left time: 6.4822s
Updating learning rate to 0.00015100940795
Validation loss decreased (0.5629 --> 0.5574).  Saving model state dict ...
Epoch: 4 cost time: 1.085860013961792
Epoch: 4, Steps: 123 | Train Loss: 0.9767019 Vali Loss: 0.5573656 Best vali loss: 0.5573656
	iters: 100, epoch: 5 | loss: 0.8039365
	speed: 0.0099s/iter; left time: 3.8918s
Updating learning rate to 9.322060939627393e-05
Epoch: 5 cost time: 0.7710790634155273
Epoch: 5, Steps: 123 | Train Loss: 0.8039365 Vali Loss: 0.5771053 Best vali loss: 0.5573656
	iters: 100, epoch: 6 | loss: 0.6350934
	speed: 0.0097s/iter; left time: 2.6149s
Updating learning rate to 4.422963156558927e-05
Epoch: 6 cost time: 0.7726373672485352
Epoch: 6, Steps: 123 | Train Loss: 0.6350934 Vali Loss: 0.5754888 Best vali loss: 0.5573656
	iters: 100, epoch: 7 | loss: 0.7645549
	speed: 0.0095s/iter; left time: 1.3973s
Updating learning rate to 1.1494906728347813e-05
Epoch: 7 cost time: 0.7637865543365479
Epoch: 7, Steps: 123 | Train Loss: 0.7645549 Vali Loss: 0.5859299 Best vali loss: 0.5573656
	iters: 100, epoch: 8 | loss: 0.6763120
	speed: 0.0095s/iter; left time: 0.2272s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7643775939941406
Epoch: 8, Steps: 123 | Train Loss: 0.6763120 Vali Loss: 0.5834894 Best vali loss: 0.5573656

best validation loss 0.5573656424390447

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010330018392, 'e_layers': 2, 'learning_rate': 0.0003941386366, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7778784
	speed: 0.0115s/iter; left time: 10.2160s
Updating learning rate to 0.000379137627963322
Validation loss decreased (inf --> 0.6163).  Saving model state dict ...
Epoch: 1 cost time: 1.0200035572052002
Epoch: 1, Steps: 123 | Train Loss: 0.7778784 Vali Loss: 0.6162599 Best vali loss: 0.6162599
	iters: 100, epoch: 2 | loss: 0.9213850
	speed: 0.0092s/iter; left time: 7.0043s
Updating learning rate to 0.0003364183696337402
Validation loss decreased (0.6163 --> 0.6093).  Saving model state dict ...
Epoch: 2 cost time: 0.7147774696350098
Epoch: 2, Steps: 123 | Train Loss: 0.9213850 Vali Loss: 0.6092742 Best vali loss: 0.6092742
	iters: 100, epoch: 3 | loss: 0.8426365
	speed: 0.0091s/iter; left time: 5.7860s
Updating learning rate to 0.00027248448144089244
Validation loss decreased (0.6093 --> 0.5654).  Saving model state dict ...
Epoch: 3 cost time: 0.7091233730316162
Epoch: 3, Steps: 123 | Train Loss: 0.8426365 Vali Loss: 0.5653652 Best vali loss: 0.5653652
	iters: 100, epoch: 4 | loss: 0.4846380
	speed: 0.0092s/iter; left time: 4.7493s
Updating learning rate to 0.0001970693183
Validation loss decreased (0.5654 --> 0.5541).  Saving model state dict ...
Epoch: 4 cost time: 0.7264919281005859
Epoch: 4, Steps: 123 | Train Loss: 0.4846380 Vali Loss: 0.5540629 Best vali loss: 0.5540629
	iters: 100, epoch: 5 | loss: 0.5484360
	speed: 0.0093s/iter; left time: 3.6469s
Updating learning rate to 0.00012165415515910762
Validation loss decreased (0.5541 --> 0.5345).  Saving model state dict ...
Epoch: 5 cost time: 0.7204961776733398
Epoch: 5, Steps: 123 | Train Loss: 0.5484360 Vali Loss: 0.5345260 Best vali loss: 0.5345260
	iters: 100, epoch: 6 | loss: 0.5702147
	speed: 0.0092s/iter; left time: 2.4918s
Updating learning rate to 5.772026696625983e-05
Epoch: 6 cost time: 0.7233963012695312
Epoch: 6, Steps: 123 | Train Loss: 0.5702147 Vali Loss: 0.5498331 Best vali loss: 0.5345260
	iters: 100, epoch: 7 | loss: 0.5152116
	speed: 0.0090s/iter; left time: 1.3298s
Updating learning rate to 1.5001008636678037e-05
Epoch: 7 cost time: 0.7177557945251465
Epoch: 7, Steps: 123 | Train Loss: 0.5152116 Vali Loss: 0.5637174 Best vali loss: 0.5345260
	iters: 100, epoch: 8 | loss: 0.6744281
	speed: 0.0089s/iter; left time: 0.2138s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7240626811981201
Epoch: 8, Steps: 123 | Train Loss: 0.6744281 Vali Loss: 0.5689197 Best vali loss: 0.5345260

best validation loss 0.5345260053528288

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010322421022, 'e_layers': 2, 'learning_rate': 0.0004672558097, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7882372
	speed: 0.0115s/iter; left time: 10.2040s
Updating learning rate to 0.0004494719443644094
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 1.0171349048614502
Epoch: 1, Steps: 123 | Train Loss: 0.7882372 Vali Loss: 0.6157205 Best vali loss: 0.6157205
	iters: 100, epoch: 2 | loss: 0.9548919
	speed: 0.0092s/iter; left time: 7.0180s
Updating learning rate to 0.00039882778064384046
Validation loss decreased (0.6157 --> 0.6087).  Saving model state dict ...
Epoch: 2 cost time: 0.7158477306365967
Epoch: 2, Steps: 123 | Train Loss: 0.9548919 Vali Loss: 0.6087358 Best vali loss: 0.6087358
	iters: 100, epoch: 3 | loss: 0.8754040
	speed: 0.0092s/iter; left time: 5.9069s
Updating learning rate to 0.0003230334333742626
Epoch: 3 cost time: 0.718034029006958
Epoch: 3, Steps: 123 | Train Loss: 0.8754040 Vali Loss: 0.6315113 Best vali loss: 0.6087358
	iters: 100, epoch: 4 | loss: 0.5058939
	speed: 0.0089s/iter; left time: 4.5810s
Updating learning rate to 0.00023362790485
Epoch: 4 cost time: 0.7104933261871338
Epoch: 4, Steps: 123 | Train Loss: 0.5058939 Vali Loss: 0.6210286 Best vali loss: 0.6087358
	iters: 100, epoch: 5 | loss: 0.5514001
	speed: 0.0089s/iter; left time: 3.5067s
Updating learning rate to 0.0001442223763257374
Validation loss decreased (0.6087 --> 0.5901).  Saving model state dict ...
Epoch: 5 cost time: 0.7098567485809326
Epoch: 5, Steps: 123 | Train Loss: 0.5514001 Vali Loss: 0.5900983 Best vali loss: 0.5900983
	iters: 100, epoch: 6 | loss: 0.5611362
	speed: 0.0092s/iter; left time: 2.4867s
Updating learning rate to 6.842802905615951e-05
Epoch: 6 cost time: 0.7097907066345215
Epoch: 6, Steps: 123 | Train Loss: 0.5611362 Vali Loss: 0.6134529 Best vali loss: 0.5900983
	iters: 100, epoch: 7 | loss: 0.5149569
	speed: 0.0090s/iter; left time: 1.3181s
Updating learning rate to 1.778386533559062e-05
Epoch: 7 cost time: 0.7176291942596436
Epoch: 7, Steps: 123 | Train Loss: 0.5149569 Vali Loss: 0.6078416 Best vali loss: 0.5900983
	iters: 100, epoch: 8 | loss: 0.6666028
	speed: 0.0089s/iter; left time: 0.2144s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7096171379089355
Epoch: 8, Steps: 123 | Train Loss: 0.6666028 Vali Loss: 0.6117415 Best vali loss: 0.5900983

best validation loss 0.5900982542205663

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010329946999, 'e_layers': 2, 'learning_rate': 0.0004220851229, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7834899
	speed: 0.0115s/iter; left time: 10.2100s
Updating learning rate to 0.00040602046446241053
Validation loss decreased (inf --> 0.6159).  Saving model state dict ...
Epoch: 1 cost time: 1.0092062950134277
Epoch: 1, Steps: 123 | Train Loss: 0.7834899 Vali Loss: 0.6159203 Best vali loss: 0.6159203
	iters: 100, epoch: 2 | loss: 0.9564246
	speed: 0.0093s/iter; left time: 7.0551s
Updating learning rate to 0.00036027218777027364
Epoch: 2 cost time: 0.7190265655517578
Epoch: 2, Steps: 123 | Train Loss: 0.9564246 Vali Loss: 0.6166093 Best vali loss: 0.6159203
	iters: 100, epoch: 3 | loss: 0.8630513
	speed: 0.0090s/iter; left time: 5.7310s
Updating learning rate to 0.0002918050532408064
Epoch: 3 cost time: 0.7203044891357422
Epoch: 3, Steps: 123 | Train Loss: 0.8630513 Vali Loss: 0.6258687 Best vali loss: 0.6159203

best validation loss 0.6159203372471644

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010365349719, 'e_layers': 2, 'learning_rate': 0.0004077326406, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8845965
	speed: 0.0104s/iter; left time: 19.3791s
	iters: 200, epoch: 1 | loss: 0.6747765
	speed: 0.0042s/iter; left time: 7.4385s
Updating learning rate to 0.0003922142409935603
Validation loss decreased (inf --> 0.6106).  Saving model state dict ...
Epoch: 1 cost time: 1.3894457817077637
Epoch: 1, Steps: 245 | Train Loss: 0.7796865 Vali Loss: 0.6106286 Best vali loss: 0.6106286
	iters: 100, epoch: 2 | loss: 0.7646915
	speed: 0.0088s/iter; left time: 14.2012s
	iters: 200, epoch: 2 | loss: 0.9118828
	speed: 0.0041s/iter; left time: 6.1683s
Updating learning rate to 0.00034802157783967873
Validation loss decreased (0.6106 --> 0.6101).  Saving model state dict ...
Epoch: 2 cost time: 1.029679298400879
Epoch: 2, Steps: 245 | Train Loss: 0.8382871 Vali Loss: 0.6100920 Best vali loss: 0.6100920
	iters: 100, epoch: 3 | loss: 0.8309137
	speed: 0.0091s/iter; left time: 12.5362s
	iters: 200, epoch: 3 | loss: 0.9459391
	speed: 0.0042s/iter; left time: 5.3412s
Updating learning rate to 0.0002818825834960448
Validation loss decreased (0.6101 --> 0.5827).  Saving model state dict ...
Epoch: 3 cost time: 1.083899974822998
Epoch: 3, Steps: 245 | Train Loss: 0.8884264 Vali Loss: 0.5826873 Best vali loss: 0.5826873

best validation loss 0.5826873484721398

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010315775197, 'e_layers': 2, 'learning_rate': 0.0004856536357, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8850983
	speed: 0.0102s/iter; left time: 19.0227s
	iters: 200, epoch: 1 | loss: 0.6648487
	speed: 0.0042s/iter; left time: 7.3419s
Updating learning rate to 0.0004671695448064614
Validation loss decreased (inf --> 0.6107).  Saving model state dict ...
Epoch: 1 cost time: 1.3587398529052734
Epoch: 1, Steps: 245 | Train Loss: 0.7749735 Vali Loss: 0.6107151 Best vali loss: 0.6107151
	iters: 100, epoch: 2 | loss: 0.7529629
	speed: 0.0090s/iter; left time: 14.4744s
	iters: 200, epoch: 2 | loss: 0.9132500
	speed: 0.0041s/iter; left time: 6.1667s
Updating learning rate to 0.0004145313074056856
Epoch: 2 cost time: 1.0534613132476807
Epoch: 2, Steps: 245 | Train Loss: 0.8331064 Vali Loss: 0.6238680 Best vali loss: 0.6107151
	iters: 100, epoch: 3 | loss: 0.8388773
	speed: 0.0089s/iter; left time: 12.2069s
	iters: 200, epoch: 3 | loss: 0.9573592
	speed: 0.0042s/iter; left time: 5.3489s
Updating learning rate to 0.00033575261797513047
Epoch: 3 cost time: 1.0804951190948486
Epoch: 3, Steps: 245 | Train Loss: 0.8981182 Vali Loss: 0.6252039 Best vali loss: 0.6107151

best validation loss 0.6107151451236613

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010365349719, 'e_layers': 2, 'learning_rate': 0.0004077326406, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8464434
	speed: 0.0106s/iter; left time: 11.9199s
	iters: 200, epoch: 4 | loss: 0.5405564
	speed: 0.0042s/iter; left time: 4.2689s
Updating learning rate to 0.0002038663203
Validation loss decreased (0.5827 --> 0.5650).  Saving model state dict ...
Epoch: 4 cost time: 1.3700997829437256
Epoch: 4, Steps: 245 | Train Loss: 0.6934999 Vali Loss: 0.5649755 Best vali loss: 0.5649755
	iters: 100, epoch: 5 | loss: 0.6614310
	speed: 0.0090s/iter; left time: 7.9176s
	iters: 200, epoch: 5 | loss: 0.7919807
	speed: 0.0040s/iter; left time: 3.1385s
Updating learning rate to 0.00012585005710395524
Validation loss decreased (0.5650 --> 0.5538).  Saving model state dict ...
Epoch: 5 cost time: 1.0517346858978271
Epoch: 5, Steps: 245 | Train Loss: 0.7267058 Vali Loss: 0.5538291 Best vali loss: 0.5538291
	iters: 100, epoch: 6 | loss: 0.6614698
	speed: 0.0092s/iter; left time: 5.8655s
	iters: 200, epoch: 6 | loss: 0.8096849
	speed: 0.0042s/iter; left time: 2.2587s
Updating learning rate to 5.9711062760321305e-05
Epoch: 6 cost time: 1.0902111530303955
Epoch: 6, Steps: 245 | Train Loss: 0.7355773 Vali Loss: 0.5780553 Best vali loss: 0.5538291
	iters: 100, epoch: 7 | loss: 0.5362400
	speed: 0.0087s/iter; left time: 3.4187s
	iters: 200, epoch: 7 | loss: 0.4508757
	speed: 0.0040s/iter; left time: 1.1688s
Updating learning rate to 1.5518399606439755e-05
Epoch: 7 cost time: 1.0454754829406738
Epoch: 7, Steps: 245 | Train Loss: 0.4935579 Vali Loss: 0.6129168 Best vali loss: 0.5538291
	iters: 100, epoch: 8 | loss: 0.6742463
	speed: 0.0084s/iter; left time: 1.2242s
	iters: 200, epoch: 8 | loss: 0.4764639
	speed: 0.0040s/iter; left time: 0.1845s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0167951583862305
Epoch: 8, Steps: 245 | Train Loss: 0.5753551 Vali Loss: 0.6072791 Best vali loss: 0.5538291

best validation loss 0.5538291191955453

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010328077025, 'e_layers': 2, 'learning_rate': 0.000470102839, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7878296
	speed: 0.0113s/iter; left time: 10.0117s
Updating learning rate to 0.0004522106150637743
Validation loss decreased (inf --> 0.6166).  Saving model state dict ...
Epoch: 1 cost time: 1.006556510925293
Epoch: 1, Steps: 123 | Train Loss: 0.7878296 Vali Loss: 0.6165625 Best vali loss: 0.6165625
	iters: 100, epoch: 2 | loss: 0.9410561
	speed: 0.0092s/iter; left time: 7.0411s
Updating learning rate to 0.0004012578721559739
Validation loss decreased (0.6166 --> 0.6089).  Saving model state dict ...
Epoch: 2 cost time: 0.7164530754089355
Epoch: 2, Steps: 123 | Train Loss: 0.9410561 Vali Loss: 0.6089477 Best vali loss: 0.6089477
	iters: 100, epoch: 3 | loss: 0.8587837
	speed: 0.0093s/iter; left time: 5.9403s
Updating learning rate to 0.0003250017034965466
Epoch: 3 cost time: 0.7264232635498047
Epoch: 3, Steps: 123 | Train Loss: 0.8587837 Vali Loss: 0.6673978 Best vali loss: 0.6089477
	iters: 100, epoch: 4 | loss: 0.4913977
	speed: 0.0090s/iter; left time: 4.6382s
Updating learning rate to 0.0002350514195
Epoch: 4 cost time: 0.7204232215881348
Epoch: 4, Steps: 123 | Train Loss: 0.4913977 Vali Loss: 0.6581299 Best vali loss: 0.6089477
	iters: 100, epoch: 5 | loss: 0.5445597
	speed: 0.0088s/iter; left time: 3.4771s
Updating learning rate to 0.00014510113550345342
Epoch: 5 cost time: 0.7135906219482422
Epoch: 5, Steps: 123 | Train Loss: 0.5445597 Vali Loss: 0.6092173 Best vali loss: 0.6089477
	iters: 100, epoch: 6 | loss: 0.5689099
	speed: 0.0088s/iter; left time: 2.3893s
Updating learning rate to 6.884496684402613e-05
Epoch: 6 cost time: 0.7153723239898682
Epoch: 6, Steps: 123 | Train Loss: 0.5689099 Vali Loss: 0.6172403 Best vali loss: 0.6089477
	iters: 100, epoch: 7 | loss: 0.5145478
	speed: 0.0089s/iter; left time: 1.3141s
Updating learning rate to 1.7892223936225653e-05
Epoch: 7 cost time: 0.7190470695495605
Epoch: 7, Steps: 123 | Train Loss: 0.5145478 Vali Loss: 0.6313148 Best vali loss: 0.6089477
	iters: 100, epoch: 8 | loss: 0.6677732
	speed: 0.0090s/iter; left time: 0.2156s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7200956344604492
Epoch: 8, Steps: 123 | Train Loss: 0.6677732 Vali Loss: 0.6301664 Best vali loss: 0.6089477

best validation loss 0.6089476994042703

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010459987578, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8426734
	speed: 0.0108s/iter; left time: 9.5475s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9291207790374756
Epoch: 1, Steps: 123 | Train Loss: 0.8426734 Vali Loss: 0.5942517 Best vali loss: 0.5942517
	iters: 100, epoch: 2 | loss: 0.7256148
	speed: 0.0077s/iter; left time: 5.8438s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5943 --> 0.5657).  Saving model state dict ...
Epoch: 2 cost time: 0.6019034385681152
Epoch: 2, Steps: 123 | Train Loss: 0.7256148 Vali Loss: 0.5657356 Best vali loss: 0.5657356
	iters: 100, epoch: 3 | loss: 0.6556480
	speed: 0.0079s/iter; left time: 5.0765s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.5657 --> 0.5613).  Saving model state dict ...
Epoch: 3 cost time: 0.6053159236907959
Epoch: 3, Steps: 123 | Train Loss: 0.6556480 Vali Loss: 0.5612945 Best vali loss: 0.5612945
	iters: 100, epoch: 4 | loss: 0.6557909
	speed: 0.0076s/iter; left time: 3.9011s
Updating learning rate to 3.7229189375e-05
Epoch: 4 cost time: 0.5792181491851807
Epoch: 4, Steps: 123 | Train Loss: 0.6557909 Vali Loss: 0.5863802 Best vali loss: 0.5612945
	iters: 100, epoch: 5 | loss: 0.4766656
	speed: 0.0076s/iter; left time: 2.9804s
Updating learning rate to 1.86145946875e-05
Epoch: 5 cost time: 0.5886452198028564
Epoch: 5, Steps: 123 | Train Loss: 0.4766656 Vali Loss: 0.5653219 Best vali loss: 0.5612945
	iters: 100, epoch: 6 | loss: 0.7904697
	speed: 0.0072s/iter; left time: 1.9448s
Updating learning rate to 9.30729734375e-06
Epoch: 6 cost time: 0.5655663013458252
Epoch: 6, Steps: 123 | Train Loss: 0.7904697 Vali Loss: 0.5661826 Best vali loss: 0.5612945
	iters: 100, epoch: 7 | loss: 0.6138324
	speed: 0.0074s/iter; left time: 1.0822s
Updating learning rate to 4.653648671875e-06
Validation loss decreased (0.5613 --> 0.5611).  Saving model state dict ...
Epoch: 7 cost time: 0.5759012699127197
Epoch: 7, Steps: 123 | Train Loss: 0.6138324 Vali Loss: 0.5611061 Best vali loss: 0.5611061
	iters: 100, epoch: 8 | loss: 0.8732185
	speed: 0.0074s/iter; left time: 0.1775s
Updating learning rate to 2.3268243359375e-06
Epoch: 8 cost time: 0.5820074081420898
Epoch: 8, Steps: 123 | Train Loss: 0.8732185 Vali Loss: 0.5619280 Best vali loss: 0.5611061

best validation loss 0.5611060902179804

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010414233059, 'e_layers': 2, 'learning_rate': 0.000298693949, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8168775
	speed: 0.0113s/iter; left time: 10.0117s
Updating learning rate to 0.00028732558748303504
Validation loss decreased (inf --> 0.5944).  Saving model state dict ...
Epoch: 1 cost time: 0.9777669906616211
Epoch: 1, Steps: 123 | Train Loss: 0.8168775 Vali Loss: 0.5944310 Best vali loss: 0.5944310
	iters: 100, epoch: 2 | loss: 0.9651029
	speed: 0.0085s/iter; left time: 6.5115s
Updating learning rate to 0.0002549512329186444
Validation loss decreased (0.5944 --> 0.5873).  Saving model state dict ...
Epoch: 2 cost time: 0.6642658710479736
Epoch: 2, Steps: 123 | Train Loss: 0.9651029 Vali Loss: 0.5872544 Best vali loss: 0.5872544
	iters: 100, epoch: 3 | loss: 0.7227263
	speed: 0.0085s/iter; left time: 5.4456s
Updating learning rate to 0.00020649958731500155
Validation loss decreased (0.5873 --> 0.5864).  Saving model state dict ...
Epoch: 3 cost time: 0.6583073139190674
Epoch: 3, Steps: 123 | Train Loss: 0.7227263 Vali Loss: 0.5863858 Best vali loss: 0.5863858

best validation loss 0.5863858219210277

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7334877
	speed: 0.0121s/iter; left time: 10.7266s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.6959).  Saving model state dict ...
Epoch: 1 cost time: 1.1036040782928467
Epoch: 1, Steps: 123 | Train Loss: 0.7334877 Vali Loss: 0.6958525 Best vali loss: 0.6958525
	iters: 100, epoch: 2 | loss: 0.8157593
	speed: 0.0091s/iter; left time: 6.9009s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.6959 --> 0.6802).  Saving model state dict ...
Epoch: 2 cost time: 0.7156932353973389
Epoch: 2, Steps: 123 | Train Loss: 0.8157593 Vali Loss: 0.6802234 Best vali loss: 0.6802234
	iters: 100, epoch: 3 | loss: 0.7322897
	speed: 0.0093s/iter; left time: 5.9544s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.6802 --> 0.6684).  Saving model state dict ...
Epoch: 3 cost time: 0.7789187431335449
Epoch: 3, Steps: 123 | Train Loss: 0.7322897 Vali Loss: 0.6683783 Best vali loss: 0.6683783

best validation loss 0.6683783261988904

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010144921995, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7743914
	speed: 0.0114s/iter; left time: 10.1254s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0127758979797363
Epoch: 1, Steps: 123 | Train Loss: 0.7743914 Vali Loss: 0.6172877 Best vali loss: 0.6172877
	iters: 100, epoch: 2 | loss: 0.9467987
	speed: 0.0092s/iter; left time: 6.9975s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5718).  Saving model state dict ...
Epoch: 2 cost time: 0.7270388603210449
Epoch: 2, Steps: 123 | Train Loss: 0.9467987 Vali Loss: 0.5717949 Best vali loss: 0.5717949
	iters: 100, epoch: 3 | loss: 0.8567691
	speed: 0.0093s/iter; left time: 5.9659s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5718 --> 0.5595).  Saving model state dict ...
Epoch: 3 cost time: 0.7214040756225586
Epoch: 3, Steps: 123 | Train Loss: 0.8567691 Vali Loss: 0.5595236 Best vali loss: 0.5595236

best validation loss 0.559523569991444

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010144921995, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5886054
	speed: 0.0120s/iter; left time: 6.1812s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5595 --> 0.5345).  Saving model state dict ...
Epoch: 4 cost time: 1.0314724445343018
Epoch: 4, Steps: 123 | Train Loss: 0.5886054 Vali Loss: 0.5345250 Best vali loss: 0.5345250
	iters: 100, epoch: 5 | loss: 0.8261915
	speed: 0.0092s/iter; left time: 3.6335s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5345 --> 0.5282).  Saving model state dict ...
Epoch: 5 cost time: 0.7210712432861328
Epoch: 5, Steps: 123 | Train Loss: 0.8261915 Vali Loss: 0.5281627 Best vali loss: 0.5281627
	iters: 100, epoch: 6 | loss: 0.7601166
	speed: 0.0093s/iter; left time: 2.5109s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7259700298309326
Epoch: 6, Steps: 123 | Train Loss: 0.7601166 Vali Loss: 0.5311719 Best vali loss: 0.5281627
	iters: 100, epoch: 7 | loss: 0.4318236
	speed: 0.0090s/iter; left time: 1.3164s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7150623798370361
Epoch: 7, Steps: 123 | Train Loss: 0.4318236 Vali Loss: 0.5406004 Best vali loss: 0.5281627
	iters: 100, epoch: 8 | loss: 0.5084915
	speed: 0.0088s/iter; left time: 0.2123s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7077651023864746
Epoch: 8, Steps: 123 | Train Loss: 0.5084915 Vali Loss: 0.5401967 Best vali loss: 0.5281627

best validation loss 0.5281626755360485

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010139487826, 'e_layers': 2, 'learning_rate': 0.0003342194191, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7758628
	speed: 0.0116s/iter; left time: 10.2730s
Updating learning rate to 0.0003342194191
Validation loss decreased (inf --> 0.6188).  Saving model state dict ...
Epoch: 1 cost time: 1.0206422805786133
Epoch: 1, Steps: 123 | Train Loss: 0.7758628 Vali Loss: 0.6187757 Best vali loss: 0.6187757
	iters: 100, epoch: 2 | loss: 0.9424725
	speed: 0.0092s/iter; left time: 6.9913s
Updating learning rate to 0.00016710970955
Validation loss decreased (0.6188 --> 0.6140).  Saving model state dict ...
Epoch: 2 cost time: 0.7211883068084717
Epoch: 2, Steps: 123 | Train Loss: 0.9424725 Vali Loss: 0.6140369 Best vali loss: 0.6140369
	iters: 100, epoch: 3 | loss: 0.8518687
	speed: 0.0093s/iter; left time: 5.9285s
Updating learning rate to 8.3554854775e-05
Validation loss decreased (0.6140 --> 0.5513).  Saving model state dict ...
Epoch: 3 cost time: 0.7256884574890137
Epoch: 3, Steps: 123 | Train Loss: 0.8518687 Vali Loss: 0.5512543 Best vali loss: 0.5512543
	iters: 100, epoch: 4 | loss: 0.4904411
	speed: 0.0092s/iter; left time: 4.7445s
Updating learning rate to 4.17774273875e-05
Validation loss decreased (0.5513 --> 0.5394).  Saving model state dict ...
Epoch: 4 cost time: 0.7159576416015625
Epoch: 4, Steps: 123 | Train Loss: 0.4904411 Vali Loss: 0.5394217 Best vali loss: 0.5394217
	iters: 100, epoch: 5 | loss: 0.5705131
	speed: 0.0092s/iter; left time: 3.6038s
Updating learning rate to 2.088871369375e-05
Validation loss decreased (0.5394 --> 0.5377).  Saving model state dict ...
Epoch: 5 cost time: 0.7160849571228027
Epoch: 5, Steps: 123 | Train Loss: 0.5705131 Vali Loss: 0.5377449 Best vali loss: 0.5377449
	iters: 100, epoch: 6 | loss: 0.6213318
	speed: 0.0092s/iter; left time: 2.4757s
Updating learning rate to 1.0444356846875e-05
Validation loss decreased (0.5377 --> 0.5319).  Saving model state dict ...
Epoch: 6 cost time: 0.7154827117919922
Epoch: 6, Steps: 123 | Train Loss: 0.6213318 Vali Loss: 0.5318774 Best vali loss: 0.5318774
	iters: 100, epoch: 7 | loss: 0.5825024
	speed: 0.0093s/iter; left time: 1.3737s
Updating learning rate to 5.2221784234375e-06
Epoch: 7 cost time: 0.7246813774108887
Epoch: 7, Steps: 123 | Train Loss: 0.5825024 Vali Loss: 0.5337437 Best vali loss: 0.5318774
	iters: 100, epoch: 8 | loss: 0.7480173
	speed: 0.0090s/iter; left time: 0.2158s
Updating learning rate to 2.61108921171875e-06
Epoch: 8 cost time: 0.7196981906890869
Epoch: 8, Steps: 123 | Train Loss: 0.7480173 Vali Loss: 0.5320460 Best vali loss: 0.5318774

best validation loss 0.531877393057257

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010130180295, 'e_layers': 2, 'learning_rate': 0.000328051691, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7753695
	speed: 0.0114s/iter; left time: 10.0707s
Updating learning rate to 0.00031556596696030855
Validation loss decreased (inf --> 0.6185).  Saving model state dict ...
Epoch: 1 cost time: 1.012580394744873
Epoch: 1, Steps: 123 | Train Loss: 0.7753695 Vali Loss: 0.6185197 Best vali loss: 0.6185197
	iters: 100, epoch: 2 | loss: 0.9313446
	speed: 0.0092s/iter; left time: 6.9843s
Updating learning rate to 0.0002800096331429069
Validation loss decreased (0.6185 --> 0.5620).  Saving model state dict ...
Epoch: 2 cost time: 0.7248125076293945
Epoch: 2, Steps: 123 | Train Loss: 0.9313446 Vali Loss: 0.5619846 Best vali loss: 0.5619846
	iters: 100, epoch: 3 | loss: 0.8483590
	speed: 0.0094s/iter; left time: 5.9845s
Updating learning rate to 0.00022679581905252593
Validation loss decreased (0.5620 --> 0.5537).  Saving model state dict ...
Epoch: 3 cost time: 0.7229607105255127
Epoch: 3, Steps: 123 | Train Loss: 0.8483590 Vali Loss: 0.5537234 Best vali loss: 0.5537234
	iters: 100, epoch: 4 | loss: 0.4959528
	speed: 0.0092s/iter; left time: 4.7701s
Updating learning rate to 0.0001640258455
Validation loss decreased (0.5537 --> 0.5526).  Saving model state dict ...
Epoch: 4 cost time: 0.7257075309753418
Epoch: 4, Steps: 123 | Train Loss: 0.4959528 Vali Loss: 0.5526419 Best vali loss: 0.5526419
	iters: 100, epoch: 5 | loss: 0.5461663
	speed: 0.0094s/iter; left time: 3.6822s
Updating learning rate to 0.0001012558719474741
Validation loss decreased (0.5526 --> 0.5365).  Saving model state dict ...
Epoch: 5 cost time: 0.7226889133453369
Epoch: 5, Steps: 123 | Train Loss: 0.5461663 Vali Loss: 0.5365189 Best vali loss: 0.5365189
	iters: 100, epoch: 6 | loss: 0.5772864
	speed: 0.0093s/iter; left time: 2.5191s
Updating learning rate to 4.804205785709306e-05
Epoch: 6 cost time: 0.7213068008422852
Epoch: 6, Steps: 123 | Train Loss: 0.5772864 Vali Loss: 0.5513478 Best vali loss: 0.5365189
	iters: 100, epoch: 7 | loss: 0.5269221
	speed: 0.0090s/iter; left time: 1.3163s
Updating learning rate to 1.2485724039691454e-05
Epoch: 7 cost time: 0.7252473831176758
Epoch: 7, Steps: 123 | Train Loss: 0.5269221 Vali Loss: 0.5489593 Best vali loss: 0.5365189
	iters: 100, epoch: 8 | loss: 0.6849473
	speed: 0.0090s/iter; left time: 0.2171s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7277998924255371
Epoch: 8, Steps: 123 | Train Loss: 0.6849473 Vali Loss: 0.5518319 Best vali loss: 0.5365189

best validation loss 0.5365189391945535

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010136140057, 'e_layers': 4, 'learning_rate': 0.0002967987663, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7439681
	speed: 0.0131s/iter; left time: 11.6246s
Updating learning rate to 0.0002967987663
Validation loss decreased (inf --> 0.6116).  Saving model state dict ...
Epoch: 1 cost time: 1.2213184833526611
Epoch: 1, Steps: 123 | Train Loss: 0.7439681 Vali Loss: 0.6115935 Best vali loss: 0.6115935
	iters: 100, epoch: 2 | loss: 0.8879642
	speed: 0.0113s/iter; left time: 8.5732s
Updating learning rate to 0.00014839938315
Epoch: 2 cost time: 0.9272539615631104
Epoch: 2, Steps: 123 | Train Loss: 0.8879642 Vali Loss: 0.6206326 Best vali loss: 0.6115935
	iters: 100, epoch: 3 | loss: 0.8007466
	speed: 0.0111s/iter; left time: 7.0838s
Updating learning rate to 7.4199691575e-05
Validation loss decreased (0.6116 --> 0.5695).  Saving model state dict ...
Epoch: 3 cost time: 0.9220118522644043
Epoch: 3, Steps: 123 | Train Loss: 0.8007466 Vali Loss: 0.5694725 Best vali loss: 0.5694725

best validation loss 0.5694724597736731

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010129208369, 'e_layers': 4, 'learning_rate': 0.0002956832378, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8182291
	speed: 0.0151s/iter; left time: 13.3663s
Updating learning rate to 0.0002956832378
Validation loss decreased (inf --> 0.6154).  Saving model state dict ...
Epoch: 1 cost time: 1.4608299732208252
Epoch: 1, Steps: 123 | Train Loss: 0.8182291 Vali Loss: 0.6153941 Best vali loss: 0.6153941
	iters: 100, epoch: 2 | loss: 0.9670779
	speed: 0.0141s/iter; left time: 10.7419s
Updating learning rate to 0.0001478416189
Validation loss decreased (0.6154 --> 0.5817).  Saving model state dict ...
Epoch: 2 cost time: 1.1668214797973633
Epoch: 2, Steps: 123 | Train Loss: 0.9670779 Vali Loss: 0.5816996 Best vali loss: 0.5816996
	iters: 100, epoch: 3 | loss: 0.5886657
	speed: 0.0145s/iter; left time: 9.2798s
Updating learning rate to 7.392080945e-05
Validation loss decreased (0.5817 --> 0.5500).  Saving model state dict ...
Epoch: 3 cost time: 1.1689457893371582
Epoch: 3, Steps: 123 | Train Loss: 0.5886657 Vali Loss: 0.5499658 Best vali loss: 0.5499658

best validation loss 0.5499658147420446

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010177447263, 'e_layers': 2, 'learning_rate': 0.0002965424755, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9035218
	speed: 0.0118s/iter; left time: 10.4653s
Updating learning rate to 0.0002965424755
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 1.0368273258209229
Epoch: 1, Steps: 123 | Train Loss: 0.9035218 Vali Loss: 0.6029496 Best vali loss: 0.6029496
	iters: 100, epoch: 2 | loss: 0.8326547
	speed: 0.0094s/iter; left time: 7.1616s
Updating learning rate to 0.00014827123775
Validation loss decreased (0.6029 --> 0.5994).  Saving model state dict ...
Epoch: 2 cost time: 0.7400081157684326
Epoch: 2, Steps: 123 | Train Loss: 0.8326547 Vali Loss: 0.5993845 Best vali loss: 0.5993845
	iters: 100, epoch: 3 | loss: 0.6708589
	speed: 0.0094s/iter; left time: 6.0334s
Updating learning rate to 7.4135618875e-05
Epoch: 3 cost time: 0.73337721824646
Epoch: 3, Steps: 123 | Train Loss: 0.6708589 Vali Loss: 0.6323708 Best vali loss: 0.5993845

best validation loss 0.5993844869510822

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010129208369, 'e_layers': 4, 'learning_rate': 0.0002956832378, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7199622
	speed: 0.0159s/iter; left time: 8.1926s
Updating learning rate to 3.6960404725e-05
Validation loss decreased (0.5500 --> 0.5364).  Saving model state dict ...
Epoch: 4 cost time: 1.4752748012542725
Epoch: 4, Steps: 123 | Train Loss: 0.7199622 Vali Loss: 0.5363600 Best vali loss: 0.5363600
	iters: 100, epoch: 5 | loss: 0.7998537
	speed: 0.0144s/iter; left time: 5.6572s
Updating learning rate to 1.84802023625e-05
Epoch: 5 cost time: 1.1703593730926514
Epoch: 5, Steps: 123 | Train Loss: 0.7998537 Vali Loss: 0.5393691 Best vali loss: 0.5363600
	iters: 100, epoch: 6 | loss: 0.5552216
	speed: 0.0138s/iter; left time: 3.7376s
Updating learning rate to 9.24010118125e-06
Validation loss decreased (0.5364 --> 0.5338).  Saving model state dict ...
Epoch: 6 cost time: 1.1627624034881592
Epoch: 6, Steps: 123 | Train Loss: 0.5552216 Vali Loss: 0.5338134 Best vali loss: 0.5338134
	iters: 100, epoch: 7 | loss: 0.7986636
	speed: 0.0144s/iter; left time: 2.1193s
Updating learning rate to 4.620050590625e-06
Validation loss decreased (0.5338 --> 0.5330).  Saving model state dict ...
Epoch: 7 cost time: 1.1709976196289062
Epoch: 7, Steps: 123 | Train Loss: 0.7986636 Vali Loss: 0.5329984 Best vali loss: 0.5329984
	iters: 100, epoch: 8 | loss: 0.7100140
	speed: 0.0145s/iter; left time: 0.3476s
Updating learning rate to 2.3100252953125e-06
Validation loss decreased (0.5330 --> 0.5324).  Saving model state dict ...
Epoch: 8 cost time: 1.1692321300506592
Epoch: 8, Steps: 123 | Train Loss: 0.7100140 Vali Loss: 0.5324058 Best vali loss: 0.5324058

best validation loss 0.532405807885347

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010191111146, 'e_layers': 2, 'learning_rate': 0.0002955483069, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0352982
	speed: 0.0116s/iter; left time: 10.2352s
Updating learning rate to 0.0002955483069
Validation loss decreased (inf --> 0.5972).  Saving model state dict ...
Epoch: 1 cost time: 0.9663374423980713
Epoch: 1, Steps: 123 | Train Loss: 1.0352982 Vali Loss: 0.5971640 Best vali loss: 0.5971640
	iters: 100, epoch: 2 | loss: 0.6364352
	speed: 0.0080s/iter; left time: 6.0607s
Updating learning rate to 0.00014777415345
Validation loss decreased (0.5972 --> 0.5683).  Saving model state dict ...
Epoch: 2 cost time: 0.603792667388916
Epoch: 2, Steps: 123 | Train Loss: 0.6364352 Vali Loss: 0.5683100 Best vali loss: 0.5683100
	iters: 100, epoch: 3 | loss: 0.7196975
	speed: 0.0079s/iter; left time: 5.0389s
Updating learning rate to 7.3887076725e-05
Validation loss decreased (0.5683 --> 0.5527).  Saving model state dict ...
Epoch: 3 cost time: 0.5984847545623779
Epoch: 3, Steps: 123 | Train Loss: 0.7196975 Vali Loss: 0.5526855 Best vali loss: 0.5526855
	iters: 100, epoch: 4 | loss: 0.6572863
	speed: 0.0081s/iter; left time: 4.2014s
Updating learning rate to 3.69435383625e-05
Validation loss decreased (0.5527 --> 0.5487).  Saving model state dict ...
Epoch: 4 cost time: 0.6316931247711182
Epoch: 4, Steps: 123 | Train Loss: 0.6572863 Vali Loss: 0.5486844 Best vali loss: 0.5486844
	iters: 100, epoch: 5 | loss: 0.5140424
	speed: 0.0082s/iter; left time: 3.2267s
Updating learning rate to 1.847176918125e-05
Epoch: 5 cost time: 0.6109578609466553
Epoch: 5, Steps: 123 | Train Loss: 0.5140424 Vali Loss: 0.5533465 Best vali loss: 0.5486844
	iters: 100, epoch: 6 | loss: 0.7496700
	speed: 0.0076s/iter; left time: 2.0625s
Updating learning rate to 9.235884590625e-06
Validation loss decreased (0.5487 --> 0.5480).  Saving model state dict ...
Epoch: 6 cost time: 0.5966758728027344
Epoch: 6, Steps: 123 | Train Loss: 0.7496700 Vali Loss: 0.5479578 Best vali loss: 0.5479578
	iters: 100, epoch: 7 | loss: 0.5127585
	speed: 0.0082s/iter; left time: 1.2057s
Updating learning rate to 4.6179422953125e-06
Validation loss decreased (0.5480 --> 0.5472).  Saving model state dict ...
Epoch: 7 cost time: 0.6187899112701416
Epoch: 7, Steps: 123 | Train Loss: 0.5127585 Vali Loss: 0.5471522 Best vali loss: 0.5471522
	iters: 100, epoch: 8 | loss: 0.6372199
	speed: 0.0082s/iter; left time: 0.1963s
Updating learning rate to 2.30897114765625e-06
Validation loss decreased (0.5472 --> 0.5462).  Saving model state dict ...
Epoch: 8 cost time: 0.6264126300811768
Epoch: 8, Steps: 123 | Train Loss: 0.6372199 Vali Loss: 0.5462446 Best vali loss: 0.5462446

best validation loss 0.5462446070997211

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010184900931, 'e_layers': 2, 'learning_rate': 0.0002845207528, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1747078
	speed: 0.0096s/iter; left time: 74.5600s
	iters: 200, epoch: 1 | loss: 0.6901348
	speed: 0.0036s/iter; left time: 27.1364s
	iters: 300, epoch: 1 | loss: 0.5524670
	speed: 0.0035s/iter; left time: 26.4617s
	iters: 400, epoch: 1 | loss: 1.4982125
	speed: 0.0034s/iter; left time: 25.0646s
	iters: 500, epoch: 1 | loss: 1.0683846
	speed: 0.0034s/iter; left time: 25.1933s
	iters: 600, epoch: 1 | loss: 1.0973713
	speed: 0.0033s/iter; left time: 24.0952s
	iters: 700, epoch: 1 | loss: 1.1286383
	speed: 0.0034s/iter; left time: 23.9828s
	iters: 800, epoch: 1 | loss: 2.0120180
	speed: 0.0035s/iter; left time: 24.5478s
	iters: 900, epoch: 1 | loss: 0.4264558
	speed: 0.0035s/iter; left time: 24.1166s
Updating learning rate to 0.0002845207528
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 3.717540740966797
Epoch: 1, Steps: 979 | Train Loss: 1.0720433 Vali Loss: 0.5976163 Best vali loss: 0.5976163
	iters: 100, epoch: 2 | loss: 1.7991041
	speed: 0.0114s/iter; left time: 77.2288s
	iters: 200, epoch: 2 | loss: 0.8974816
	speed: 0.0036s/iter; left time: 23.7596s
	iters: 300, epoch: 2 | loss: 0.9087268
	speed: 0.0034s/iter; left time: 22.4216s
	iters: 400, epoch: 2 | loss: 0.6460966
	speed: 0.0034s/iter; left time: 21.9251s
	iters: 500, epoch: 2 | loss: 0.8281667
	speed: 0.0034s/iter; left time: 21.8957s
	iters: 600, epoch: 2 | loss: 1.1269444
	speed: 0.0034s/iter; left time: 21.3111s
	iters: 700, epoch: 2 | loss: 1.5066651
	speed: 0.0035s/iter; left time: 21.5451s
	iters: 800, epoch: 2 | loss: 0.5188934
	speed: 0.0035s/iter; left time: 20.9197s
	iters: 900, epoch: 2 | loss: 1.0793451
	speed: 0.0034s/iter; left time: 20.5172s
Updating learning rate to 0.0001422603764
Epoch: 2 cost time: 3.4181220531463623
Epoch: 2, Steps: 979 | Train Loss: 1.0346026 Vali Loss: 0.6158169 Best vali loss: 0.5976163
	iters: 100, epoch: 3 | loss: 1.2886678
	speed: 0.0114s/iter; left time: 65.9271s
	iters: 200, epoch: 3 | loss: 1.0207088
	speed: 0.0034s/iter; left time: 19.2390s
	iters: 300, epoch: 3 | loss: 1.1270924
	speed: 0.0035s/iter; left time: 19.3801s
	iters: 400, epoch: 3 | loss: 0.9480532
	speed: 0.0034s/iter; left time: 18.3566s
	iters: 500, epoch: 3 | loss: 0.7141110
	speed: 0.0033s/iter; left time: 17.9138s
	iters: 600, epoch: 3 | loss: 0.4001996
	speed: 0.0035s/iter; left time: 18.7234s
	iters: 700, epoch: 3 | loss: 0.6298946
	speed: 0.0035s/iter; left time: 18.1423s
	iters: 800, epoch: 3 | loss: 0.4612147
	speed: 0.0035s/iter; left time: 17.8503s
	iters: 900, epoch: 3 | loss: 0.9891418
	speed: 0.0036s/iter; left time: 17.8373s
Updating learning rate to 7.11301882e-05
Epoch: 3 cost time: 3.4468884468078613
Epoch: 3, Steps: 979 | Train Loss: 0.8421204 Vali Loss: 0.6257315 Best vali loss: 0.5976163
	iters: 100, epoch: 4 | loss: 0.3754221
	speed: 0.0113s/iter; left time: 54.3829s
	iters: 200, epoch: 4 | loss: 1.0653912
	speed: 0.0033s/iter; left time: 15.7117s
	iters: 300, epoch: 4 | loss: 1.2303795
	speed: 0.0033s/iter; left time: 15.1136s
	iters: 400, epoch: 4 | loss: 0.7242191
	speed: 0.0033s/iter; left time: 14.8537s
	iters: 500, epoch: 4 | loss: 1.1165713
	speed: 0.0033s/iter; left time: 14.5636s
	iters: 600, epoch: 4 | loss: 0.4595748
	speed: 0.0033s/iter; left time: 14.1460s
	iters: 700, epoch: 4 | loss: 0.5641171
	speed: 0.0033s/iter; left time: 13.7722s
	iters: 800, epoch: 4 | loss: 0.8671430
	speed: 0.0033s/iter; left time: 13.5580s
	iters: 900, epoch: 4 | loss: 0.6346197
	speed: 0.0033s/iter; left time: 13.3811s
Updating learning rate to 3.55650941e-05
Epoch: 4 cost time: 3.284510850906372
Epoch: 4, Steps: 979 | Train Loss: 0.7819375 Vali Loss: 0.6237847 Best vali loss: 0.5976163
	iters: 100, epoch: 5 | loss: 0.6914409
	speed: 0.0111s/iter; left time: 42.3288s
	iters: 200, epoch: 5 | loss: 0.4589739
	speed: 0.0034s/iter; left time: 12.5576s
	iters: 300, epoch: 5 | loss: 0.4666702
	speed: 0.0033s/iter; left time: 12.0693s
	iters: 400, epoch: 5 | loss: 0.9579515
	speed: 0.0033s/iter; left time: 11.6982s
	iters: 500, epoch: 5 | loss: 1.3711830
	speed: 0.0033s/iter; left time: 11.1898s
	iters: 600, epoch: 5 | loss: 0.5785895
	speed: 0.0033s/iter; left time: 11.0721s
	iters: 700, epoch: 5 | loss: 0.5236660
	speed: 0.0032s/iter; left time: 10.3270s
	iters: 800, epoch: 5 | loss: 0.3162696
	speed: 0.0033s/iter; left time: 10.2206s
	iters: 900, epoch: 5 | loss: 0.7369834
	speed: 0.0033s/iter; left time: 9.9127s
Updating learning rate to 1.778254705e-05
Epoch: 5 cost time: 3.2888147830963135
Epoch: 5, Steps: 979 | Train Loss: 0.6779698 Vali Loss: 0.6310087 Best vali loss: 0.5976163
	iters: 100, epoch: 6 | loss: 0.4443876
	speed: 0.0110s/iter; left time: 31.0779s
	iters: 200, epoch: 6 | loss: 0.5413316
	speed: 0.0032s/iter; left time: 8.7373s
	iters: 300, epoch: 6 | loss: 0.5356020
	speed: 0.0032s/iter; left time: 8.3592s
	iters: 400, epoch: 6 | loss: 1.0252229
	speed: 0.0032s/iter; left time: 8.2324s
	iters: 500, epoch: 6 | loss: 0.6902008
	speed: 0.0032s/iter; left time: 7.8340s
	iters: 600, epoch: 6 | loss: 1.3911587
	speed: 0.0032s/iter; left time: 7.3664s
	iters: 700, epoch: 6 | loss: 0.6311764
	speed: 0.0032s/iter; left time: 7.1645s
	iters: 800, epoch: 6 | loss: 1.3089743
	speed: 0.0033s/iter; left time: 7.0183s
	iters: 900, epoch: 6 | loss: 0.8564482
	speed: 0.0033s/iter; left time: 6.7657s
Updating learning rate to 8.891273525e-06
Epoch: 6 cost time: 3.1931984424591064
Epoch: 6, Steps: 979 | Train Loss: 0.8249447 Vali Loss: 0.6305064 Best vali loss: 0.5976163
	iters: 100, epoch: 7 | loss: 0.8915344
	speed: 0.0108s/iter; left time: 20.0110s
	iters: 200, epoch: 7 | loss: 0.9097113
	speed: 0.0032s/iter; left time: 5.5757s
	iters: 300, epoch: 7 | loss: 0.7734464
	speed: 0.0032s/iter; left time: 5.3127s
	iters: 400, epoch: 7 | loss: 0.4518780
	speed: 0.0032s/iter; left time: 4.9412s
	iters: 500, epoch: 7 | loss: 0.2261918
	speed: 0.0031s/iter; left time: 4.5906s
	iters: 600, epoch: 7 | loss: 0.2943375
	speed: 0.0032s/iter; left time: 4.3129s
	iters: 700, epoch: 7 | loss: 0.3779790
	speed: 0.0033s/iter; left time: 4.1260s
	iters: 800, epoch: 7 | loss: 0.6179101
	speed: 0.0033s/iter; left time: 3.7955s
	iters: 900, epoch: 7 | loss: 0.5276948
	speed: 0.0033s/iter; left time: 3.4541s
Updating learning rate to 4.4456367625e-06
Epoch: 7 cost time: 3.1807801723480225
Epoch: 7, Steps: 979 | Train Loss: 0.5634093 Vali Loss: 0.6315543 Best vali loss: 0.5976163
	iters: 100, epoch: 8 | loss: 0.4679607
	speed: 0.0115s/iter; left time: 10.0858s
	iters: 200, epoch: 8 | loss: 0.6957297
	speed: 0.0035s/iter; left time: 2.7524s
	iters: 300, epoch: 8 | loss: 0.3224060
	speed: 0.0035s/iter; left time: 2.3944s
	iters: 400, epoch: 8 | loss: 0.6465380
	speed: 0.0035s/iter; left time: 2.0430s
	iters: 500, epoch: 8 | loss: 0.4733825
	speed: 0.0035s/iter; left time: 1.6897s
	iters: 600, epoch: 8 | loss: 0.4493332
	speed: 0.0033s/iter; left time: 1.2631s
	iters: 700, epoch: 8 | loss: 0.5117787
	speed: 0.0034s/iter; left time: 0.9557s
	iters: 800, epoch: 8 | loss: 0.2453234
	speed: 0.0034s/iter; left time: 0.6074s
	iters: 900, epoch: 8 | loss: 0.3843496
	speed: 0.0034s/iter; left time: 0.2751s
Updating learning rate to 2.22281838125e-06
Epoch: 8 cost time: 3.421879291534424
Epoch: 8, Steps: 979 | Train Loss: 0.4663113 Vali Loss: 0.6308408 Best vali loss: 0.5976163

best validation loss 0.5976162793624186

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.001019220671, 'e_layers': 2, 'learning_rate': 0.0002918148209, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8425515
	speed: 0.0094s/iter; left time: 72.3417s
	iters: 200, epoch: 1 | loss: 0.8428099
	speed: 0.0032s/iter; left time: 24.1155s
	iters: 300, epoch: 1 | loss: 0.5274705
	speed: 0.0031s/iter; left time: 23.4219s
	iters: 400, epoch: 1 | loss: 1.5016396
	speed: 0.0030s/iter; left time: 22.6503s
	iters: 500, epoch: 1 | loss: 1.1519618
	speed: 0.0030s/iter; left time: 22.2228s
	iters: 600, epoch: 1 | loss: 0.5351908
	speed: 0.0030s/iter; left time: 21.6663s
	iters: 700, epoch: 1 | loss: 0.9766607
	speed: 0.0029s/iter; left time: 21.0033s
	iters: 800, epoch: 1 | loss: 1.5804951
	speed: 0.0031s/iter; left time: 22.0673s
	iters: 900, epoch: 1 | loss: 0.8908550
	speed: 0.0032s/iter; left time: 22.1902s
Updating learning rate to 0.0002918148209
Validation loss decreased (inf --> 0.6129).  Saving model state dict ...
Epoch: 1 cost time: 3.385310649871826
Epoch: 1, Steps: 979 | Train Loss: 0.9832928 Vali Loss: 0.6128703 Best vali loss: 0.6128703
	iters: 100, epoch: 2 | loss: 1.6349040
	speed: 0.0113s/iter; left time: 76.3600s
	iters: 200, epoch: 2 | loss: 0.8220453
	speed: 0.0035s/iter; left time: 23.1346s
	iters: 300, epoch: 2 | loss: 0.5852215
	speed: 0.0035s/iter; left time: 23.0843s
	iters: 400, epoch: 2 | loss: 1.0568717
	speed: 0.0034s/iter; left time: 22.1776s
	iters: 500, epoch: 2 | loss: 1.0501717
	speed: 0.0035s/iter; left time: 21.9725s
	iters: 600, epoch: 2 | loss: 0.7082869
	speed: 0.0036s/iter; left time: 22.4895s
	iters: 700, epoch: 2 | loss: 0.8276469
	speed: 0.0035s/iter; left time: 21.4648s
	iters: 800, epoch: 2 | loss: 0.9656064
	speed: 0.0036s/iter; left time: 21.6919s
	iters: 900, epoch: 2 | loss: 0.6989018
	speed: 0.0035s/iter; left time: 20.5543s
Updating learning rate to 0.00014590741045
Validation loss decreased (0.6129 --> 0.6001).  Saving model state dict ...
Epoch: 2 cost time: 3.4909112453460693
Epoch: 2, Steps: 979 | Train Loss: 0.9277396 Vali Loss: 0.6001426 Best vali loss: 0.6001426
	iters: 100, epoch: 3 | loss: 0.4743977
	speed: 0.0119s/iter; left time: 68.7999s
	iters: 200, epoch: 3 | loss: 1.0025067
	speed: 0.0031s/iter; left time: 17.4908s
	iters: 300, epoch: 3 | loss: 0.6186762
	speed: 0.0030s/iter; left time: 16.9879s
	iters: 400, epoch: 3 | loss: 1.1024700
	speed: 0.0030s/iter; left time: 16.6638s
	iters: 500, epoch: 3 | loss: 0.9369305
	speed: 0.0031s/iter; left time: 16.5902s
	iters: 600, epoch: 3 | loss: 0.2600293
	speed: 0.0031s/iter; left time: 16.4893s
	iters: 700, epoch: 3 | loss: 0.5169010
	speed: 0.0031s/iter; left time: 15.8426s
	iters: 800, epoch: 3 | loss: 1.2192811
	speed: 0.0031s/iter; left time: 15.7083s
	iters: 900, epoch: 3 | loss: 0.6678624
	speed: 0.0030s/iter; left time: 15.1400s
Updating learning rate to 7.2953705225e-05
Epoch: 3 cost time: 3.0692222118377686
Epoch: 3, Steps: 979 | Train Loss: 0.7554505 Vali Loss: 0.6048011 Best vali loss: 0.6001426

best validation loss 0.6001425635505748

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010197187268, 'e_layers': 2, 'learning_rate': 0.0002866150965, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8430048
	speed: 0.0092s/iter; left time: 70.9878s
	iters: 200, epoch: 1 | loss: 0.8436871
	speed: 0.0031s/iter; left time: 24.0309s
	iters: 300, epoch: 1 | loss: 0.5195399
	speed: 0.0031s/iter; left time: 23.6623s
	iters: 400, epoch: 1 | loss: 1.4897355
	speed: 0.0032s/iter; left time: 23.4242s
	iters: 500, epoch: 1 | loss: 1.1814544
	speed: 0.0031s/iter; left time: 23.0013s
	iters: 600, epoch: 1 | loss: 0.5478492
	speed: 0.0031s/iter; left time: 22.5664s
	iters: 700, epoch: 1 | loss: 0.9689804
	speed: 0.0031s/iter; left time: 22.4050s
	iters: 800, epoch: 1 | loss: 1.6011229
	speed: 0.0032s/iter; left time: 22.6660s
	iters: 900, epoch: 1 | loss: 0.9166348
	speed: 0.0033s/iter; left time: 22.6684s
Updating learning rate to 0.0002866150965
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 3.4371609687805176
Epoch: 1, Steps: 979 | Train Loss: 0.9902232 Vali Loss: 0.6217023 Best vali loss: 0.6217023
	iters: 100, epoch: 2 | loss: 1.6882519
	speed: 0.0113s/iter; left time: 76.4237s
	iters: 200, epoch: 2 | loss: 0.8379523
	speed: 0.0031s/iter; left time: 20.4039s
	iters: 300, epoch: 2 | loss: 0.6184800
	speed: 0.0035s/iter; left time: 22.6662s
	iters: 400, epoch: 2 | loss: 1.0848377
	speed: 0.0035s/iter; left time: 22.3735s
	iters: 500, epoch: 2 | loss: 1.0387566
	speed: 0.0033s/iter; left time: 21.1837s
	iters: 600, epoch: 2 | loss: 0.7047504
	speed: 0.0031s/iter; left time: 19.6003s
	iters: 700, epoch: 2 | loss: 0.8141097
	speed: 0.0031s/iter; left time: 19.2047s
	iters: 800, epoch: 2 | loss: 0.8435278
	speed: 0.0031s/iter; left time: 18.7159s
	iters: 900, epoch: 2 | loss: 0.6857527
	speed: 0.0030s/iter; left time: 18.0438s
Updating learning rate to 0.00014330754825
Validation loss decreased (0.6217 --> 0.5924).  Saving model state dict ...
Epoch: 2 cost time: 3.2020299434661865
Epoch: 2, Steps: 979 | Train Loss: 0.9240465 Vali Loss: 0.5924469 Best vali loss: 0.5924469
	iters: 100, epoch: 3 | loss: 0.4610903
	speed: 0.0117s/iter; left time: 67.8018s
	iters: 200, epoch: 3 | loss: 1.0251734
	speed: 0.0033s/iter; left time: 18.9863s
	iters: 300, epoch: 3 | loss: 0.5929368
	speed: 0.0032s/iter; left time: 18.0355s
	iters: 400, epoch: 3 | loss: 1.0762203
	speed: 0.0032s/iter; left time: 17.2644s
	iters: 500, epoch: 3 | loss: 0.7676703
	speed: 0.0031s/iter; left time: 16.7919s
	iters: 600, epoch: 3 | loss: 0.2580107
	speed: 0.0031s/iter; left time: 16.5622s
	iters: 700, epoch: 3 | loss: 0.4003171
	speed: 0.0032s/iter; left time: 16.5588s
	iters: 800, epoch: 3 | loss: 1.2552592
	speed: 0.0032s/iter; left time: 16.2369s
	iters: 900, epoch: 3 | loss: 0.5985335
	speed: 0.0032s/iter; left time: 15.9771s
Updating learning rate to 7.1653774125e-05
Epoch: 3 cost time: 3.206042766571045
Epoch: 3, Steps: 979 | Train Loss: 0.7150235 Vali Loss: 0.6093181 Best vali loss: 0.5924469

best validation loss 0.5924468949016516

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010138993538, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5083573
	speed: 0.0112s/iter; left time: 9.9362s
Updating learning rate to 0.0002969380215
Validation loss decreased (inf --> 0.5879).  Saving model state dict ...
Epoch: 1 cost time: 0.9738550186157227
Epoch: 1, Steps: 123 | Train Loss: 0.5083573 Vali Loss: 0.5879209 Best vali loss: 0.5879209
	iters: 100, epoch: 2 | loss: 0.6185849
	speed: 0.0088s/iter; left time: 6.6762s
Updating learning rate to 0.00014846901075
Validation loss decreased (0.5879 --> 0.5675).  Saving model state dict ...
Epoch: 2 cost time: 0.678753137588501
Epoch: 2, Steps: 123 | Train Loss: 0.6185849 Vali Loss: 0.5674984 Best vali loss: 0.5674984
	iters: 100, epoch: 3 | loss: 0.6597236
	speed: 0.0088s/iter; left time: 5.6346s
Updating learning rate to 7.4234505375e-05
Validation loss decreased (0.5675 --> 0.5532).  Saving model state dict ...
Epoch: 3 cost time: 0.6848347187042236
Epoch: 3, Steps: 123 | Train Loss: 0.6597236 Vali Loss: 0.5532444 Best vali loss: 0.5532444

best validation loss 0.5532443751509903

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010138993538, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4443603
	speed: 0.0115s/iter; left time: 5.9121s
Updating learning rate to 3.71172526875e-05
Validation loss decreased (0.5532 --> 0.5512).  Saving model state dict ...
Epoch: 4 cost time: 0.9763345718383789
Epoch: 4, Steps: 123 | Train Loss: 0.4443603 Vali Loss: 0.5511934 Best vali loss: 0.5511934
	iters: 100, epoch: 5 | loss: 0.5665784
	speed: 0.0087s/iter; left time: 3.4168s
Updating learning rate to 1.855862634375e-05
Validation loss decreased (0.5512 --> 0.5460).  Saving model state dict ...
Epoch: 5 cost time: 0.6636648178100586
Epoch: 5, Steps: 123 | Train Loss: 0.5665784 Vali Loss: 0.5460292 Best vali loss: 0.5460292
	iters: 100, epoch: 6 | loss: 0.6173650
	speed: 0.0087s/iter; left time: 2.3494s
Updating learning rate to 9.279313171875e-06
Validation loss decreased (0.5460 --> 0.5448).  Saving model state dict ...
Epoch: 6 cost time: 0.6726248264312744
Epoch: 6, Steps: 123 | Train Loss: 0.6173650 Vali Loss: 0.5447730 Best vali loss: 0.5447730
	iters: 100, epoch: 7 | loss: 0.5564467
	speed: 0.0087s/iter; left time: 1.2791s
Updating learning rate to 4.6396565859375e-06
Epoch: 7 cost time: 0.6773660182952881
Epoch: 7, Steps: 123 | Train Loss: 0.5564467 Vali Loss: 0.5448167 Best vali loss: 0.5447730
	iters: 100, epoch: 8 | loss: 0.6078256
	speed: 0.0085s/iter; left time: 0.2031s
Updating learning rate to 2.31982829296875e-06
Epoch: 8 cost time: 0.669588565826416
Epoch: 8, Steps: 123 | Train Loss: 0.6078256 Vali Loss: 0.5466889 Best vali loss: 0.5447730

best validation loss 0.544773018012605

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010144921995, 'e_layers': 2, 'learning_rate': 0.00029711881, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6853244
	speed: 0.0116s/iter; left time: 10.2313s
Updating learning rate to 0.0002858103986415549
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 1.0138931274414062
Epoch: 1, Steps: 123 | Train Loss: 0.6853244 Vali Loss: 0.6208340 Best vali loss: 0.6208340
	iters: 100, epoch: 2 | loss: 0.8093424
	speed: 0.0091s/iter; left time: 6.9696s
Updating learning rate to 0.0002536067676845387
Validation loss decreased (0.6208 --> 0.5752).  Saving model state dict ...
Epoch: 2 cost time: 0.7192752361297607
Epoch: 2, Steps: 123 | Train Loss: 0.8093424 Vali Loss: 0.5752172 Best vali loss: 0.5752172
	iters: 100, epoch: 3 | loss: 0.8390861
	speed: 0.0092s/iter; left time: 5.9074s
Updating learning rate to 0.0002054106280155155
Validation loss decreased (0.5752 --> 0.5576).  Saving model state dict ...
Epoch: 3 cost time: 0.7175683975219727
Epoch: 3, Steps: 123 | Train Loss: 0.8390861 Vali Loss: 0.5575663 Best vali loss: 0.5575663
	iters: 100, epoch: 4 | loss: 0.7418269
	speed: 0.0094s/iter; left time: 4.8496s
Updating learning rate to 0.000148559405
Validation loss decreased (0.5576 --> 0.5437).  Saving model state dict ...
Epoch: 4 cost time: 0.7212145328521729
Epoch: 4, Steps: 123 | Train Loss: 0.7418269 Vali Loss: 0.5436679 Best vali loss: 0.5436679
	iters: 100, epoch: 5 | loss: 0.6142977
	speed: 0.0092s/iter; left time: 3.5968s
Updating learning rate to 9.170818198448453e-05
Epoch: 5 cost time: 0.7122280597686768
Epoch: 5, Steps: 123 | Train Loss: 0.6142977 Vali Loss: 0.5462936 Best vali loss: 0.5436679
	iters: 100, epoch: 6 | loss: 0.6073754
	speed: 0.0090s/iter; left time: 2.4408s
Updating learning rate to 4.3512042315461315e-05
Epoch: 6 cost time: 0.720283031463623
Epoch: 6, Steps: 123 | Train Loss: 0.6073754 Vali Loss: 0.5599042 Best vali loss: 0.5436679
	iters: 100, epoch: 7 | loss: 0.5099798
	speed: 0.0089s/iter; left time: 1.3104s
Updating learning rate to 1.1308411358445085e-05
Epoch: 7 cost time: 0.7168457508087158
Epoch: 7, Steps: 123 | Train Loss: 0.5099798 Vali Loss: 0.5576659 Best vali loss: 0.5436679
	iters: 100, epoch: 8 | loss: 0.5256184
	speed: 0.0090s/iter; left time: 0.2168s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7165622711181641
Epoch: 8, Steps: 123 | Train Loss: 0.5256184 Vali Loss: 0.5661120 Best vali loss: 0.5436679

best validation loss 0.5436679081804274

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010185516746, 'e_layers': 2, 'learning_rate': 0.0001205203068, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3782394
	speed: 0.0097s/iter; left time: 75.3853s
	iters: 200, epoch: 1 | loss: 1.3678898
	speed: 0.0034s/iter; left time: 25.8034s
	iters: 300, epoch: 1 | loss: 0.8401685
	speed: 0.0034s/iter; left time: 25.9743s
	iters: 400, epoch: 1 | loss: 1.3912630
	speed: 0.0037s/iter; left time: 27.4885s
	iters: 500, epoch: 1 | loss: 0.9151081
	speed: 0.0036s/iter; left time: 26.4319s
	iters: 600, epoch: 1 | loss: 1.5148526
	speed: 0.0036s/iter; left time: 25.8697s
	iters: 700, epoch: 1 | loss: 0.8119935
	speed: 0.0036s/iter; left time: 25.5976s
	iters: 800, epoch: 1 | loss: 0.7671437
	speed: 0.0035s/iter; left time: 24.6487s
	iters: 900, epoch: 1 | loss: 0.9889870
	speed: 0.0034s/iter; left time: 23.8468s
Updating learning rate to 0.0001205203068
Validation loss decreased (inf --> 0.5813).  Saving model state dict ...
Epoch: 1 cost time: 3.8100333213806152
Epoch: 1, Steps: 979 | Train Loss: 0.9972940 Vali Loss: 0.5812848 Best vali loss: 0.5812848
	iters: 100, epoch: 2 | loss: 0.9923315
	speed: 0.0117s/iter; left time: 79.0432s
	iters: 200, epoch: 2 | loss: 0.3282649
	speed: 0.0036s/iter; left time: 23.9539s
	iters: 300, epoch: 2 | loss: 0.3925082
	speed: 0.0036s/iter; left time: 23.4221s
	iters: 400, epoch: 2 | loss: 1.4533936
	speed: 0.0035s/iter; left time: 22.5166s
	iters: 500, epoch: 2 | loss: 0.9562892
	speed: 0.0035s/iter; left time: 22.4897s
	iters: 600, epoch: 2 | loss: 1.2932708
	speed: 0.0035s/iter; left time: 22.1718s
	iters: 700, epoch: 2 | loss: 0.9987249
	speed: 0.0034s/iter; left time: 21.1812s
	iters: 800, epoch: 2 | loss: 0.2661819
	speed: 0.0034s/iter; left time: 20.8181s
	iters: 900, epoch: 2 | loss: 0.8892617
	speed: 0.0033s/iter; left time: 19.9098s
Updating learning rate to 6.02601534e-05
Validation loss decreased (0.5813 --> 0.5585).  Saving model state dict ...
Epoch: 2 cost time: 3.4703898429870605
Epoch: 2, Steps: 979 | Train Loss: 0.8411363 Vali Loss: 0.5584835 Best vali loss: 0.5584835
	iters: 100, epoch: 3 | loss: 0.7094185
	speed: 0.0119s/iter; left time: 68.6606s
	iters: 200, epoch: 3 | loss: 0.6554221
	speed: 0.0034s/iter; left time: 19.2920s
	iters: 300, epoch: 3 | loss: 1.1292259
	speed: 0.0035s/iter; left time: 19.4373s
	iters: 400, epoch: 3 | loss: 1.0737642
	speed: 0.0033s/iter; left time: 18.3294s
	iters: 500, epoch: 3 | loss: 1.0126134
	speed: 0.0031s/iter; left time: 16.5611s
	iters: 600, epoch: 3 | loss: 0.4216414
	speed: 0.0032s/iter; left time: 16.9742s
	iters: 700, epoch: 3 | loss: 0.7106065
	speed: 0.0031s/iter; left time: 16.1544s
	iters: 800, epoch: 3 | loss: 1.6707168
	speed: 0.0031s/iter; left time: 15.8556s
	iters: 900, epoch: 3 | loss: 0.2650469
	speed: 0.0030s/iter; left time: 15.1045s
Updating learning rate to 3.01300767e-05
Validation loss decreased (0.5585 --> 0.5504).  Saving model state dict ...
Epoch: 3 cost time: 3.2134358882904053
Epoch: 3, Steps: 979 | Train Loss: 0.8498284 Vali Loss: 0.5504494 Best vali loss: 0.5504494
	iters: 100, epoch: 4 | loss: 0.9277884
	speed: 0.0111s/iter; left time: 53.2721s
	iters: 200, epoch: 4 | loss: 0.2109149
	speed: 0.0032s/iter; left time: 14.9912s
	iters: 300, epoch: 4 | loss: 0.8292303
	speed: 0.0032s/iter; left time: 14.7252s
	iters: 400, epoch: 4 | loss: 0.2985380
	speed: 0.0032s/iter; left time: 14.2901s
	iters: 500, epoch: 4 | loss: 0.4498085
	speed: 0.0032s/iter; left time: 13.9645s
	iters: 600, epoch: 4 | loss: 0.7364542
	speed: 0.0032s/iter; left time: 13.7908s
	iters: 700, epoch: 4 | loss: 1.1593158
	speed: 0.0032s/iter; left time: 13.4214s
	iters: 800, epoch: 4 | loss: 0.2649162
	speed: 0.0033s/iter; left time: 13.3902s
	iters: 900, epoch: 4 | loss: 0.9601504
	speed: 0.0031s/iter; left time: 12.5389s
Updating learning rate to 1.506503835e-05
Validation loss decreased (0.5504 --> 0.5418).  Saving model state dict ...
Epoch: 4 cost time: 3.174858570098877
Epoch: 4, Steps: 979 | Train Loss: 0.6485685 Vali Loss: 0.5418166 Best vali loss: 0.5418166
	iters: 100, epoch: 5 | loss: 0.7993222
	speed: 0.0119s/iter; left time: 45.3735s
	iters: 200, epoch: 5 | loss: 0.5929787
	speed: 0.0036s/iter; left time: 13.2433s
	iters: 300, epoch: 5 | loss: 1.0012698
	speed: 0.0035s/iter; left time: 12.4934s
	iters: 400, epoch: 5 | loss: 0.8801280
	speed: 0.0036s/iter; left time: 12.5988s
	iters: 500, epoch: 5 | loss: 0.3467081
	speed: 0.0036s/iter; left time: 12.3913s
	iters: 600, epoch: 5 | loss: 1.0060188
	speed: 0.0035s/iter; left time: 11.6171s
	iters: 700, epoch: 5 | loss: 0.6611481
	speed: 0.0035s/iter; left time: 11.2644s
	iters: 800, epoch: 5 | loss: 0.4027328
	speed: 0.0033s/iter; left time: 10.3718s
	iters: 900, epoch: 5 | loss: 0.4932946
	speed: 0.0034s/iter; left time: 10.3757s
Updating learning rate to 7.532519175e-06
Validation loss decreased (0.5418 --> 0.5333).  Saving model state dict ...
Epoch: 5 cost time: 3.4757866859436035
Epoch: 5, Steps: 979 | Train Loss: 0.6870668 Vali Loss: 0.5332524 Best vali loss: 0.5332524
	iters: 100, epoch: 6 | loss: 1.1095359
	speed: 0.0118s/iter; left time: 33.4094s
	iters: 200, epoch: 6 | loss: 0.3700204
	speed: 0.0034s/iter; left time: 9.2838s
	iters: 300, epoch: 6 | loss: 1.0867152
	speed: 0.0034s/iter; left time: 9.0554s
	iters: 400, epoch: 6 | loss: 0.2841040
	speed: 0.0036s/iter; left time: 9.0294s
	iters: 500, epoch: 6 | loss: 0.4756965
	speed: 0.0036s/iter; left time: 8.6692s
	iters: 600, epoch: 6 | loss: 1.0131067
	speed: 0.0034s/iter; left time: 7.9484s
	iters: 700, epoch: 6 | loss: 1.0855907
	speed: 0.0035s/iter; left time: 7.9000s
	iters: 800, epoch: 6 | loss: 0.7774946
	speed: 0.0036s/iter; left time: 7.7817s
	iters: 900, epoch: 6 | loss: 0.4266537
	speed: 0.0037s/iter; left time: 7.4391s
Updating learning rate to 3.7662595875e-06
Epoch: 6 cost time: 3.4837329387664795
Epoch: 6, Steps: 979 | Train Loss: 0.7365464 Vali Loss: 0.5340255 Best vali loss: 0.5332524
	iters: 100, epoch: 7 | loss: 0.8142350
	speed: 0.0117s/iter; left time: 21.7778s
	iters: 200, epoch: 7 | loss: 0.7227232
	speed: 0.0036s/iter; left time: 6.3206s
	iters: 300, epoch: 7 | loss: 0.5297594
	speed: 0.0033s/iter; left time: 5.5016s
	iters: 400, epoch: 7 | loss: 1.0204368
	speed: 0.0032s/iter; left time: 5.0296s
	iters: 500, epoch: 7 | loss: 0.2886057
	speed: 0.0032s/iter; left time: 4.6940s
	iters: 600, epoch: 7 | loss: 0.4246165
	speed: 0.0032s/iter; left time: 4.3987s
	iters: 700, epoch: 7 | loss: 0.7395549
	speed: 0.0033s/iter; left time: 4.1132s
	iters: 800, epoch: 7 | loss: 0.8060712
	speed: 0.0034s/iter; left time: 3.9438s
	iters: 900, epoch: 7 | loss: 0.6413025
	speed: 0.0032s/iter; left time: 3.4282s
Updating learning rate to 1.88312979375e-06
Epoch: 7 cost time: 3.308102607727051
Epoch: 7, Steps: 979 | Train Loss: 0.6652561 Vali Loss: 0.5335017 Best vali loss: 0.5332524
	iters: 100, epoch: 8 | loss: 0.4987298
	speed: 0.0113s/iter; left time: 9.9381s
	iters: 200, epoch: 8 | loss: 0.5372081
	speed: 0.0033s/iter; left time: 2.5431s
	iters: 300, epoch: 8 | loss: 0.8968390
	speed: 0.0033s/iter; left time: 2.2244s
	iters: 400, epoch: 8 | loss: 0.2621821
	speed: 0.0033s/iter; left time: 1.9374s
	iters: 500, epoch: 8 | loss: 0.8161993
	speed: 0.0032s/iter; left time: 1.5518s
	iters: 600, epoch: 8 | loss: 1.0868344
	speed: 0.0033s/iter; left time: 1.2632s
	iters: 700, epoch: 8 | loss: 0.6093923
	speed: 0.0034s/iter; left time: 0.9523s
	iters: 800, epoch: 8 | loss: 0.9532917
	speed: 0.0035s/iter; left time: 0.6290s
	iters: 900, epoch: 8 | loss: 0.9073457
	speed: 0.0034s/iter; left time: 0.2751s
Updating learning rate to 9.41564896875e-07
Validation loss decreased (0.5333 --> 0.5325).  Saving model state dict ...
Epoch: 8 cost time: 3.323829174041748
Epoch: 8, Steps: 979 | Train Loss: 0.7297803 Vali Loss: 0.5325376 Best vali loss: 0.5325376

best validation loss 0.5325376474846297

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010826978283, 'e_layers': 3, 'learning_rate': 0.000733585835, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4620650
	speed: 0.0107s/iter; left time: 40.8065s
	iters: 200, epoch: 1 | loss: 0.7978627
	speed: 0.0047s/iter; left time: 17.5161s
	iters: 300, epoch: 1 | loss: 0.8089733
	speed: 0.0047s/iter; left time: 16.9905s
	iters: 400, epoch: 1 | loss: 0.9908828
	speed: 0.0046s/iter; left time: 16.2870s
Updating learning rate to 0.000733585835
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 2.626037836074829
Epoch: 1, Steps: 490 | Train Loss: 0.7649459 Vali Loss: 0.6073560 Best vali loss: 0.6073560
	iters: 100, epoch: 2 | loss: 0.6977006
	speed: 0.0117s/iter; left time: 38.8416s
	iters: 200, epoch: 2 | loss: 0.7612135
	speed: 0.0044s/iter; left time: 14.1599s
	iters: 300, epoch: 2 | loss: 0.7007305
	speed: 0.0045s/iter; left time: 14.2034s
	iters: 400, epoch: 2 | loss: 1.0189060
	speed: 0.0047s/iter; left time: 14.3285s
Updating learning rate to 0.0003667929175
Epoch: 2 cost time: 2.2130069732666016
Epoch: 2, Steps: 490 | Train Loss: 0.7946377 Vali Loss: 0.6264266 Best vali loss: 0.6073560
	iters: 100, epoch: 3 | loss: 1.0418710
	speed: 0.0122s/iter; left time: 34.7771s
	iters: 200, epoch: 3 | loss: 1.3147402
	speed: 0.0044s/iter; left time: 12.1252s
	iters: 300, epoch: 3 | loss: 1.7187787
	speed: 0.0044s/iter; left time: 11.7510s
	iters: 400, epoch: 3 | loss: 0.9921757
	speed: 0.0045s/iter; left time: 11.4235s
Updating learning rate to 0.00018339645875
Epoch: 3 cost time: 2.2404723167419434
Epoch: 3, Steps: 490 | Train Loss: 1.2668914 Vali Loss: 0.6107662 Best vali loss: 0.6073560

best validation loss 0.6073560167771145

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010165933135, 'e_layers': 4, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7439951
	speed: 0.0132s/iter; left time: 11.6920s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6116).  Saving model state dict ...
Epoch: 1 cost time: 1.226592779159546
Epoch: 1, Steps: 123 | Train Loss: 0.7439951 Vali Loss: 0.6116150 Best vali loss: 0.6116150
	iters: 100, epoch: 2 | loss: 0.8963869
	speed: 0.0113s/iter; left time: 8.5837s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6116 --> 0.5771).  Saving model state dict ...
Epoch: 2 cost time: 0.917090892791748
Epoch: 2, Steps: 123 | Train Loss: 0.8963869 Vali Loss: 0.5770680 Best vali loss: 0.5770680
	iters: 100, epoch: 3 | loss: 0.7960153
	speed: 0.0112s/iter; left time: 7.1800s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5771 --> 0.5648).  Saving model state dict ...
Epoch: 3 cost time: 0.9093790054321289
Epoch: 3, Steps: 123 | Train Loss: 0.7960153 Vali Loss: 0.5647766 Best vali loss: 0.5647766

best validation loss 0.5647766405595005

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010183152905, 'e_layers': 3, 'learning_rate': 0.0002977206743, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6182150
	speed: 0.0137s/iter; left time: 12.0994s
Updating learning rate to 0.00028638935584561454
Validation loss decreased (inf --> 0.6160).  Saving model state dict ...
Epoch: 1 cost time: 1.2885234355926514
Epoch: 1, Steps: 123 | Train Loss: 0.6182150 Vali Loss: 0.6160432 Best vali loss: 0.6160432
	iters: 100, epoch: 2 | loss: 0.7288657
	speed: 0.0121s/iter; left time: 9.2374s
Updating learning rate to 0.00025412049099848074
Validation loss decreased (0.6160 --> 0.5592).  Saving model state dict ...
Epoch: 2 cost time: 0.9867613315582275
Epoch: 2, Steps: 123 | Train Loss: 0.7288657 Vali Loss: 0.5591739 Best vali loss: 0.5591739
	iters: 100, epoch: 3 | loss: 0.6464931
	speed: 0.0124s/iter; left time: 7.9096s
Updating learning rate to 0.00020582672191358652
Validation loss decreased (0.5592 --> 0.5570).  Saving model state dict ...
Epoch: 3 cost time: 0.9925613403320312
Epoch: 3, Steps: 123 | Train Loss: 0.6464931 Vali Loss: 0.5570385 Best vali loss: 0.5570385

best validation loss 0.5570384962643699

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010183152905, 'e_layers': 3, 'learning_rate': 0.0002977206743, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5292878
	speed: 0.0142s/iter; left time: 7.3059s
Updating learning rate to 0.00014886033715
Validation loss decreased (0.5570 --> 0.5566).  Saving model state dict ...
Epoch: 4 cost time: 1.2939105033874512
Epoch: 4, Steps: 123 | Train Loss: 0.5292878 Vali Loss: 0.5566011 Best vali loss: 0.5566011
	iters: 100, epoch: 5 | loss: 0.6462625
	speed: 0.0124s/iter; left time: 4.8729s
Updating learning rate to 9.189395238641353e-05
Validation loss decreased (0.5566 --> 0.5527).  Saving model state dict ...
Epoch: 5 cost time: 0.9899783134460449
Epoch: 5, Steps: 123 | Train Loss: 0.6462625 Vali Loss: 0.5527228 Best vali loss: 0.5527228
	iters: 100, epoch: 6 | loss: 0.5641245
	speed: 0.0123s/iter; left time: 3.3192s
Updating learning rate to 4.360018330151927e-05
Validation loss decreased (0.5527 --> 0.5378).  Saving model state dict ...
Epoch: 6 cost time: 0.9918124675750732
Epoch: 6, Steps: 123 | Train Loss: 0.5641245 Vali Loss: 0.5378158 Best vali loss: 0.5378158
	iters: 100, epoch: 7 | loss: 0.7760138
	speed: 0.0124s/iter; left time: 1.8233s
Updating learning rate to 1.133131845438547e-05
Epoch: 7 cost time: 0.9962236881256104
Epoch: 7, Steps: 123 | Train Loss: 0.7760138 Vali Loss: 0.5449176 Best vali loss: 0.5378158
	iters: 100, epoch: 8 | loss: 0.6176217
	speed: 0.0119s/iter; left time: 0.2860s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9886326789855957
Epoch: 8, Steps: 123 | Train Loss: 0.6176217 Vali Loss: 0.5532175 Best vali loss: 0.5378158

best validation loss 0.5378157578370792

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023127490055, 'e_layers': 1, 'learning_rate': 0.0017907228824, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017907228824
Validation loss decreased (inf --> 0.6330).  Saving model state dict ...
Epoch: 1 cost time: 0.6758608818054199
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6330164 Best vali loss: 0.6330164
Updating learning rate to 0.0008953614412
Epoch: 2 cost time: 0.4076352119445801
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6596422 Best vali loss: 0.6330164
Updating learning rate to 0.0004476807206
Epoch: 3 cost time: 0.4189746379852295
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6496743 Best vali loss: 0.6330164
Updating learning rate to 0.0002238403603
Epoch: 4 cost time: 0.41739654541015625
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6511416 Best vali loss: 0.6330164
Updating learning rate to 0.00011192018015
Epoch: 5 cost time: 0.4078938961029053
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6679726 Best vali loss: 0.6330164
Updating learning rate to 5.5960090075e-05
Epoch: 6 cost time: 0.4190330505371094
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6645516 Best vali loss: 0.6330164
Updating learning rate to 2.79800450375e-05
Epoch: 7 cost time: 0.410930871963501
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6701630 Best vali loss: 0.6330164
Updating learning rate to 1.399002251875e-05
Epoch: 8 cost time: 0.40009355545043945
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6693394 Best vali loss: 0.6330164

best validation loss 0.6330163820040331

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6191300
	speed: 0.0139s/iter; left time: 12.2660s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 1.2963917255401611
Epoch: 1, Steps: 123 | Train Loss: 0.6191300 Vali Loss: 0.6116755 Best vali loss: 0.6116755
	iters: 100, epoch: 2 | loss: 0.7470622
	speed: 0.0122s/iter; left time: 9.3117s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6117 --> 0.5836).  Saving model state dict ...
Epoch: 2 cost time: 0.994408369064331
Epoch: 2, Steps: 123 | Train Loss: 0.7470622 Vali Loss: 0.5836098 Best vali loss: 0.5836098
	iters: 100, epoch: 3 | loss: 0.6381714
	speed: 0.0124s/iter; left time: 7.9244s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5836 --> 0.5486).  Saving model state dict ...
Epoch: 3 cost time: 0.9959228038787842
Epoch: 3, Steps: 123 | Train Loss: 0.6381714 Vali Loss: 0.5486466 Best vali loss: 0.5486466
	iters: 100, epoch: 4 | loss: 0.8486820
	speed: 0.0123s/iter; left time: 6.3422s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5486 --> 0.5346).  Saving model state dict ...
Epoch: 4 cost time: 0.9888849258422852
Epoch: 4, Steps: 123 | Train Loss: 0.8486820 Vali Loss: 0.5346115 Best vali loss: 0.5346115
	iters: 100, epoch: 5 | loss: 0.6729226
	speed: 0.0123s/iter; left time: 4.8323s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5346 --> 0.5269).  Saving model state dict ...
Epoch: 5 cost time: 1.0005674362182617
Epoch: 5, Steps: 123 | Train Loss: 0.6729226 Vali Loss: 0.5268741 Best vali loss: 0.5268741
	iters: 100, epoch: 6 | loss: 0.4372891
	speed: 0.0125s/iter; left time: 3.3648s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.9962637424468994
Epoch: 6, Steps: 123 | Train Loss: 0.4372891 Vali Loss: 0.5269158 Best vali loss: 0.5268741
	iters: 100, epoch: 7 | loss: 0.7688791
	speed: 0.0119s/iter; left time: 1.7468s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.990485668182373
Epoch: 7, Steps: 123 | Train Loss: 0.7688791 Vali Loss: 0.5535958 Best vali loss: 0.5268741
	iters: 100, epoch: 8 | loss: 0.6616213
	speed: 0.0120s/iter; left time: 0.2870s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0009894371032715
Epoch: 8, Steps: 123 | Train Loss: 0.6616213 Vali Loss: 0.5493017 Best vali loss: 0.5268741

best validation loss 0.526874079962452

[INFO][abstract_intensifier.py:595] Added config c87f5c and rejected config 948305 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5807309
	speed: 0.0111s/iter; left time: 20.5643s
	iters: 200, epoch: 1 | loss: 0.7409284
	speed: 0.0050s/iter; left time: 8.8164s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.6367).  Saving model state dict ...
Epoch: 1 cost time: 1.5575525760650635
Epoch: 1, Steps: 245 | Train Loss: 0.6608296 Vali Loss: 0.6367342 Best vali loss: 0.6367342
	iters: 100, epoch: 2 | loss: 1.0173423
	speed: 0.0092s/iter; left time: 14.7975s
	iters: 200, epoch: 2 | loss: 0.8443964
	speed: 0.0044s/iter; left time: 6.6342s
Updating learning rate to 0.00164194791575
Epoch: 2 cost time: 1.1194148063659668
Epoch: 2, Steps: 245 | Train Loss: 0.9308694 Vali Loss: 0.6379378 Best vali loss: 0.6367342
	iters: 100, epoch: 3 | loss: 0.6295751
	speed: 0.0088s/iter; left time: 12.0993s
	iters: 200, epoch: 3 | loss: 1.1159779
	speed: 0.0044s/iter; left time: 5.5477s
Updating learning rate to 0.000820973957875
Epoch: 3 cost time: 1.1092028617858887
Epoch: 3, Steps: 245 | Train Loss: 0.8727765 Vali Loss: 0.6442756 Best vali loss: 0.6367342

best validation loss 0.6367341952983674

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.001013730465, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5192914
	speed: 0.0117s/iter; left time: 21.7737s
	iters: 200, epoch: 1 | loss: 0.6115485
	speed: 0.0056s/iter; left time: 9.8005s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 1.7137525081634521
Epoch: 1, Steps: 245 | Train Loss: 0.5654200 Vali Loss: 0.6069579 Best vali loss: 0.6069579
	iters: 100, epoch: 2 | loss: 0.7094566
	speed: 0.0114s/iter; left time: 18.4885s
	iters: 200, epoch: 2 | loss: 0.9871541
	speed: 0.0056s/iter; left time: 8.5620s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6070 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 1.4246251583099365
Epoch: 2, Steps: 245 | Train Loss: 0.8483053 Vali Loss: 0.6066713 Best vali loss: 0.6066713
	iters: 100, epoch: 3 | loss: 0.7016383
	speed: 0.0116s/iter; left time: 15.9399s
	iters: 200, epoch: 3 | loss: 0.6780868
	speed: 0.0057s/iter; left time: 7.2080s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6067 --> 0.5719).  Saving model state dict ...
Epoch: 3 cost time: 1.4300687313079834
Epoch: 3, Steps: 245 | Train Loss: 0.6898626 Vali Loss: 0.5719211 Best vali loss: 0.5719211

best validation loss 0.5719210931902845

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010405698861, 'e_layers': 3, 'learning_rate': 0.0002982045808, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6183425
	speed: 0.0136s/iter; left time: 12.0390s
Updating learning rate to 0.0002868548447511141
Validation loss decreased (inf --> 0.6152).  Saving model state dict ...
Epoch: 1 cost time: 1.281742811203003
Epoch: 1, Steps: 123 | Train Loss: 0.6183425 Vali Loss: 0.6152108 Best vali loss: 0.6152108
	iters: 100, epoch: 2 | loss: 0.7399263
	speed: 0.0123s/iter; left time: 9.3474s
Updating learning rate to 0.00025453353103228584
Validation loss decreased (0.6152 --> 0.6000).  Saving model state dict ...
Epoch: 2 cost time: 1.005568504333496
Epoch: 2, Steps: 123 | Train Loss: 0.7399263 Vali Loss: 0.6000456 Best vali loss: 0.6000456
	iters: 100, epoch: 3 | loss: 0.6366648
	speed: 0.0124s/iter; left time: 7.9377s
Updating learning rate to 0.00020616126666376839
Validation loss decreased (0.6000 --> 0.5459).  Saving model state dict ...
Epoch: 3 cost time: 0.9956841468811035
Epoch: 3, Steps: 123 | Train Loss: 0.6366648 Vali Loss: 0.5459254 Best vali loss: 0.5459254

best validation loss 0.5459254383489193

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010405698861, 'e_layers': 3, 'learning_rate': 0.0002982045808, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5436522
	speed: 0.0142s/iter; left time: 7.3212s
Updating learning rate to 0.0001491022904
Validation loss decreased (0.5459 --> 0.5397).  Saving model state dict ...
Epoch: 4 cost time: 1.3029866218566895
Epoch: 4, Steps: 123 | Train Loss: 0.5436522 Vali Loss: 0.5396654 Best vali loss: 0.5396654
	iters: 100, epoch: 5 | loss: 0.6388324
	speed: 0.0124s/iter; left time: 4.8742s
Updating learning rate to 9.204331413623163e-05
Epoch: 5 cost time: 0.989673376083374
Epoch: 5, Steps: 123 | Train Loss: 0.6388324 Vali Loss: 0.5563697 Best vali loss: 0.5396654
	iters: 100, epoch: 6 | loss: 0.5656924
	speed: 0.0119s/iter; left time: 3.2256s
Updating learning rate to 4.367104976771414e-05
Validation loss decreased (0.5397 --> 0.5339).  Saving model state dict ...
Epoch: 6 cost time: 0.9937503337860107
Epoch: 6, Steps: 123 | Train Loss: 0.5656924 Vali Loss: 0.5338918 Best vali loss: 0.5338918
	iters: 100, epoch: 7 | loss: 0.7614774
	speed: 0.0124s/iter; left time: 1.8221s
Updating learning rate to 1.1349736048885882e-05
Epoch: 7 cost time: 0.9984490871429443
Epoch: 7, Steps: 123 | Train Loss: 0.7614774 Vali Loss: 0.5549786 Best vali loss: 0.5338918
	iters: 100, epoch: 8 | loss: 0.6142688
	speed: 0.0120s/iter; left time: 0.2871s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9884388446807861
Epoch: 8, Steps: 123 | Train Loss: 0.6142688 Vali Loss: 0.5710541 Best vali loss: 0.5338918

best validation loss 0.5338917831920021

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8789834
	speed: 0.0117s/iter; left time: 10.3550s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6021).  Saving model state dict ...
Epoch: 1 cost time: 1.0220682621002197
Epoch: 1, Steps: 123 | Train Loss: 0.8789834 Vali Loss: 0.6020631 Best vali loss: 0.6020631
	iters: 100, epoch: 2 | loss: 0.7741222
	speed: 0.0089s/iter; left time: 6.7896s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6021 --> 0.5406).  Saving model state dict ...
Epoch: 2 cost time: 0.7147178649902344
Epoch: 2, Steps: 123 | Train Loss: 0.7741222 Vali Loss: 0.5405830 Best vali loss: 0.5405830
	iters: 100, epoch: 3 | loss: 0.8041893
	speed: 0.0087s/iter; left time: 5.5800s
Updating learning rate to 0.00020590473339677975
Epoch: 3 cost time: 0.6949965953826904
Epoch: 3, Steps: 123 | Train Loss: 0.8041893 Vali Loss: 0.5570935 Best vali loss: 0.5405830
	iters: 100, epoch: 4 | loss: 0.8040780
	speed: 0.0089s/iter; left time: 4.6168s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5406 --> 0.5384).  Saving model state dict ...
Epoch: 4 cost time: 0.7256350517272949
Epoch: 4, Steps: 123 | Train Loss: 0.8040780 Vali Loss: 0.5384449 Best vali loss: 0.5384449
	iters: 100, epoch: 5 | loss: 0.7712345
	speed: 0.0089s/iter; left time: 3.5150s
Updating learning rate to 9.192878160322029e-05
Epoch: 5 cost time: 0.701899528503418
Epoch: 5, Steps: 123 | Train Loss: 0.7712345 Vali Loss: 0.5408940 Best vali loss: 0.5384449
	iters: 100, epoch: 6 | loss: 0.5015134
	speed: 0.0087s/iter; left time: 2.3507s
Updating learning rate to 4.361670843943735e-05
Validation loss decreased (0.5384 --> 0.5328).  Saving model state dict ...
Epoch: 6 cost time: 0.7081489562988281
Epoch: 6, Steps: 123 | Train Loss: 0.5015134 Vali Loss: 0.5327985 Best vali loss: 0.5327985
	iters: 100, epoch: 7 | loss: 0.5942904
	speed: 0.0089s/iter; left time: 1.3024s
Updating learning rate to 1.1335613197803346e-05
Validation loss decreased (0.5328 --> 0.5315).  Saving model state dict ...
Epoch: 7 cost time: 0.7078819274902344
Epoch: 7, Steps: 123 | Train Loss: 0.5942904 Vali Loss: 0.5314962 Best vali loss: 0.5314962
	iters: 100, epoch: 8 | loss: 0.8040656
	speed: 0.0090s/iter; left time: 0.2170s
Updating learning rate to 0.0
Validation loss decreased (0.5315 --> 0.5308).  Saving model state dict ...
Epoch: 8 cost time: 0.732893705368042
Epoch: 8, Steps: 123 | Train Loss: 0.8040656 Vali Loss: 0.5307788 Best vali loss: 0.5307788

best validation loss 0.5307787718016039

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005459653869797237
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 0.7060534954071045
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6086420 Best vali loss: 0.6086420
Updating learning rate to 0.0004844488434208944
Epoch: 2 cost time: 0.4180107116699219
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6545948 Best vali loss: 0.6086420
Updating learning rate to 0.00039238282983148796
Validation loss decreased (0.6086 --> 0.5814).  Saving model state dict ...
Epoch: 3 cost time: 0.44309115409851074
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5814122 Best vali loss: 0.5814122
Updating learning rate to 0.0002837835622
Validation loss decreased (0.5814 --> 0.5470).  Saving model state dict ...
Epoch: 4 cost time: 0.43549680709838867
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5470387 Best vali loss: 0.5470387
Updating learning rate to 0.00017518429456851207
Epoch: 5 cost time: 0.44293832778930664
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5546035 Best vali loss: 0.5470387
Updating learning rate to 8.311828097910562e-05
Epoch: 6 cost time: 0.41887831687927246
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5571392 Best vali loss: 0.5470387
Updating learning rate to 2.1601737420276337e-05
Epoch: 7 cost time: 0.44830870628356934
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5538679 Best vali loss: 0.5470387
Updating learning rate to 0.0
Epoch: 8 cost time: 0.44643735885620117
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5549552 Best vali loss: 0.5470387

best validation loss 0.5470387437507986

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0351082
	speed: 0.0112s/iter; left time: 9.9246s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.5978).  Saving model state dict ...
Epoch: 1 cost time: 0.9539594650268555
Epoch: 1, Steps: 123 | Train Loss: 1.0351082 Vali Loss: 0.5978021 Best vali loss: 0.5978021
	iters: 100, epoch: 2 | loss: 0.6343727
	speed: 0.0081s/iter; left time: 6.1613s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.5978 --> 0.5563).  Saving model state dict ...
Epoch: 2 cost time: 0.6165337562561035
Epoch: 2, Steps: 123 | Train Loss: 0.6343727 Vali Loss: 0.5562854 Best vali loss: 0.5562854
	iters: 100, epoch: 3 | loss: 0.7388818
	speed: 0.0078s/iter; left time: 4.9956s
Updating learning rate to 0.00020590473339677975
Epoch: 3 cost time: 0.6099808216094971
Epoch: 3, Steps: 123 | Train Loss: 0.7388818 Vali Loss: 0.5598428 Best vali loss: 0.5562854

best validation loss 0.556285445527973

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010419563997, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744440
	speed: 0.0117s/iter; left time: 10.3240s
Updating learning rate to 0.0002856364909941232
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0129811763763428
Epoch: 1, Steps: 123 | Train Loss: 0.7744440 Vali Loss: 0.6173230 Best vali loss: 0.6173230
	iters: 100, epoch: 2 | loss: 0.9463878
	speed: 0.0092s/iter; left time: 7.0141s
Updating learning rate to 0.0002534524550473834
Validation loss decreased (0.6173 --> 0.5880).  Saving model state dict ...
Epoch: 2 cost time: 0.7186384201049805
Epoch: 2, Steps: 123 | Train Loss: 0.9463878 Vali Loss: 0.5880342 Best vali loss: 0.5880342
	iters: 100, epoch: 3 | loss: 0.8529696
	speed: 0.0093s/iter; left time: 5.9685s
Updating learning rate to 0.0002052856413836594
Validation loss decreased (0.5880 --> 0.5451).  Saving model state dict ...
Epoch: 3 cost time: 0.7198593616485596
Epoch: 3, Steps: 123 | Train Loss: 0.8529696 Vali Loss: 0.5450776 Best vali loss: 0.5450776

best validation loss 0.5450776092215083

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7197578
	speed: 0.0092s/iter; left time: 17.2117s
	iters: 200, epoch: 1 | loss: 0.9926225
	speed: 0.0030s/iter; left time: 5.2947s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.0870156288146973
Epoch: 1, Steps: 245 | Train Loss: 0.8561901 Vali Loss: 0.6077624 Best vali loss: 0.6077624
	iters: 100, epoch: 2 | loss: 0.9781685
	speed: 0.0067s/iter; left time: 10.8598s
	iters: 200, epoch: 2 | loss: 0.8433773
	speed: 0.0029s/iter; left time: 4.4204s
Updating learning rate to 0.00021594413975
Validation loss decreased (0.6078 --> 0.6070).  Saving model state dict ...
Epoch: 2 cost time: 0.7517101764678955
Epoch: 2, Steps: 245 | Train Loss: 0.9107729 Vali Loss: 0.6070031 Best vali loss: 0.6070031
	iters: 100, epoch: 3 | loss: 1.1971464
	speed: 0.0065s/iter; left time: 8.9786s
	iters: 200, epoch: 3 | loss: 0.6087537
	speed: 0.0027s/iter; left time: 3.4867s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.7246708869934082
Epoch: 3, Steps: 245 | Train Loss: 0.9029500 Vali Loss: 0.6315957 Best vali loss: 0.6070031

best validation loss 0.6070031016747856

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010419563997, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5837472
	speed: 0.0118s/iter; left time: 6.0885s
Updating learning rate to 0.00014846901075
Validation loss decreased (0.5451 --> 0.5299).  Saving model state dict ...
Epoch: 4 cost time: 1.011336088180542
Epoch: 4, Steps: 123 | Train Loss: 0.5837472 Vali Loss: 0.5298936 Best vali loss: 0.5298936
	iters: 100, epoch: 5 | loss: 0.8175272
	speed: 0.0092s/iter; left time: 3.6185s
Updating learning rate to 9.16523801163406e-05
Validation loss decreased (0.5299 --> 0.5284).  Saving model state dict ...
Epoch: 5 cost time: 0.719763994216919
Epoch: 5, Steps: 123 | Train Loss: 0.8175272 Vali Loss: 0.5284351 Best vali loss: 0.5284351
	iters: 100, epoch: 6 | loss: 0.7545159
	speed: 0.0092s/iter; left time: 2.4769s
Updating learning rate to 4.3485566452616585e-05
Epoch: 6 cost time: 0.7131991386413574
Epoch: 6, Steps: 123 | Train Loss: 0.7545159 Vali Loss: 0.5330880 Best vali loss: 0.5284351
	iters: 100, epoch: 7 | loss: 0.4366449
	speed: 0.0090s/iter; left time: 1.3185s
Updating learning rate to 1.1301530505876794e-05
Epoch: 7 cost time: 0.7249312400817871
Epoch: 7, Steps: 123 | Train Loss: 0.4366449 Vali Loss: 0.5389803 Best vali loss: 0.5284351
	iters: 100, epoch: 8 | loss: 0.5091466
	speed: 0.0090s/iter; left time: 0.2151s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7146091461181641
Epoch: 8, Steps: 123 | Train Loss: 0.5091466 Vali Loss: 0.5428063 Best vali loss: 0.5284351

best validation loss 0.5284350629152936

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7025761
	speed: 0.0130s/iter; left time: 11.5450s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 1.1801660060882568
Epoch: 1, Steps: 123 | Train Loss: 0.7025761 Vali Loss: 0.6100594 Best vali loss: 0.6100594
	iters: 100, epoch: 2 | loss: 1.0044965
	speed: 0.0100s/iter; left time: 7.6241s
Updating learning rate to 6.252043389458952e-05
Validation loss decreased (0.6101 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 0.8039965629577637
Epoch: 2, Steps: 123 | Train Loss: 1.0044965 Vali Loss: 0.6063891 Best vali loss: 0.6063891
	iters: 100, epoch: 3 | loss: 0.7285230
	speed: 0.0100s/iter; left time: 6.3898s
Updating learning rate to 5.063887571827247e-05
Validation loss decreased (0.6064 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 0.8076562881469727
Epoch: 3, Steps: 123 | Train Loss: 0.7285230 Vali Loss: 0.6030534 Best vali loss: 0.6030534
	iters: 100, epoch: 4 | loss: 0.8062402
	speed: 0.0098s/iter; left time: 5.0539s
Updating learning rate to 3.662362225e-05
Validation loss decreased (0.6031 --> 0.5952).  Saving model state dict ...
Epoch: 4 cost time: 0.7990412712097168
Epoch: 4, Steps: 123 | Train Loss: 0.8062402 Vali Loss: 0.5951983 Best vali loss: 0.5951983
	iters: 100, epoch: 5 | loss: 0.9836579
	speed: 0.0099s/iter; left time: 3.9043s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.5952 --> 0.5714).  Saving model state dict ...
Epoch: 5 cost time: 0.8108928203582764
Epoch: 5, Steps: 123 | Train Loss: 0.9836579 Vali Loss: 0.5713671 Best vali loss: 0.5713671
	iters: 100, epoch: 6 | loss: 0.6842610
	speed: 0.0100s/iter; left time: 2.6914s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.5714 --> 0.5653).  Saving model state dict ...
Epoch: 6 cost time: 0.8092284202575684
Epoch: 6, Steps: 123 | Train Loss: 0.6842610 Vali Loss: 0.5652615 Best vali loss: 0.5652615
	iters: 100, epoch: 7 | loss: 0.9271832
	speed: 0.0104s/iter; left time: 1.5270s
Updating learning rate to 2.7878072468000404e-06
Validation loss decreased (0.5653 --> 0.5542).  Saving model state dict ...
Epoch: 7 cost time: 0.8587076663970947
Epoch: 7, Steps: 123 | Train Loss: 0.9271832 Vali Loss: 0.5542402 Best vali loss: 0.5542402
	iters: 100, epoch: 8 | loss: 0.8825958
	speed: 0.0105s/iter; left time: 0.2519s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8577725887298584
Epoch: 8, Steps: 123 | Train Loss: 0.8825958 Vali Loss: 0.5558105 Best vali loss: 0.5542402

best validation loss 0.5542401946677703

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010449663587, 'e_layers': 2, 'learning_rate': 0.0002975184157, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744475
	speed: 0.0115s/iter; left time: 10.2124s
Updating learning rate to 0.00028619479525520737
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0117628574371338
Epoch: 1, Steps: 123 | Train Loss: 0.7744475 Vali Loss: 0.6172032 Best vali loss: 0.6172032
	iters: 100, epoch: 2 | loss: 0.9450629
	speed: 0.0092s/iter; left time: 7.0405s
Updating learning rate to 0.0002539478524846741
Epoch: 2 cost time: 0.7223949432373047
Epoch: 2, Steps: 123 | Train Loss: 0.9450629 Vali Loss: 0.6193554 Best vali loss: 0.6172032
	iters: 100, epoch: 3 | loss: 0.8414047
	speed: 0.0091s/iter; left time: 5.7917s
Updating learning rate to 0.00020568689210594983
Validation loss decreased (0.6172 --> 0.5440).  Saving model state dict ...
Epoch: 3 cost time: 0.7207081317901611
Epoch: 3, Steps: 123 | Train Loss: 0.8414047 Vali Loss: 0.5439741 Best vali loss: 0.5439741
	iters: 100, epoch: 4 | loss: 0.4925719
	speed: 0.0094s/iter; left time: 4.8509s
Updating learning rate to 0.00014875920785
Epoch: 4 cost time: 0.7228662967681885
Epoch: 4, Steps: 123 | Train Loss: 0.4925719 Vali Loss: 0.5471982 Best vali loss: 0.5439741
	iters: 100, epoch: 5 | loss: 0.5551530
	speed: 0.0090s/iter; left time: 3.5201s
Updating learning rate to 9.18315235940502e-05
Validation loss decreased (0.5440 --> 0.5286).  Saving model state dict ...
Epoch: 5 cost time: 0.7140095233917236
Epoch: 5, Steps: 123 | Train Loss: 0.5551530 Vali Loss: 0.5286459 Best vali loss: 0.5286459
	iters: 100, epoch: 6 | loss: 0.5889986
	speed: 0.0093s/iter; left time: 2.5091s
Updating learning rate to 4.357056321532592e-05
Epoch: 6 cost time: 0.7194569110870361
Epoch: 6, Steps: 123 | Train Loss: 0.5889986 Vali Loss: 0.5377792 Best vali loss: 0.5286459
	iters: 100, epoch: 7 | loss: 0.5341248
	speed: 0.0090s/iter; left time: 1.3177s
Updating learning rate to 1.1323620444792665e-05
Epoch: 7 cost time: 0.7198290824890137
Epoch: 7, Steps: 123 | Train Loss: 0.5341248 Vali Loss: 0.5405970 Best vali loss: 0.5286459
	iters: 100, epoch: 8 | loss: 0.6951153
	speed: 0.0089s/iter; left time: 0.2145s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7154932022094727
Epoch: 8, Steps: 123 | Train Loss: 0.6951153 Vali Loss: 0.5495925 Best vali loss: 0.5286459

best validation loss 0.5286459108570669

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010444015985, 'e_layers': 2, 'learning_rate': 0.0002965424755, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9522343
	speed: 0.0108s/iter; left time: 9.5889s
Updating learning rate to 0.00028525599956733986
Validation loss decreased (inf --> 0.5996).  Saving model state dict ...
Epoch: 1 cost time: 0.9181385040283203
Epoch: 1, Steps: 123 | Train Loss: 0.9522343 Vali Loss: 0.5996284 Best vali loss: 0.5996284
	iters: 100, epoch: 2 | loss: 0.8421914
	speed: 0.0078s/iter; left time: 5.9290s
Updating learning rate to 0.0002531148354179478
Epoch: 2 cost time: 0.6132450103759766
Epoch: 2, Steps: 123 | Train Loss: 0.8421914 Vali Loss: 0.6039994 Best vali loss: 0.5996284
	iters: 100, epoch: 3 | loss: 0.6567920
	speed: 0.0076s/iter; left time: 4.8804s
Updating learning rate to 0.0002050121839331903
Validation loss decreased (0.5996 --> 0.5882).  Saving model state dict ...
Epoch: 3 cost time: 0.5993404388427734
Epoch: 3, Steps: 123 | Train Loss: 0.6567920 Vali Loss: 0.5882351 Best vali loss: 0.5882351

best validation loss 0.5882350602452262

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7004151
	speed: 0.0117s/iter; left time: 10.3685s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 1.0410361289978027
Epoch: 1, Steps: 123 | Train Loss: 0.7004151 Vali Loss: 0.6156442 Best vali loss: 0.6156442
	iters: 100, epoch: 2 | loss: 0.6621813
	speed: 0.0093s/iter; left time: 7.1161s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.6156 --> 0.5514).  Saving model state dict ...
Epoch: 2 cost time: 0.735802173614502
Epoch: 2, Steps: 123 | Train Loss: 0.6621813 Vali Loss: 0.5514224 Best vali loss: 0.5514224
	iters: 100, epoch: 3 | loss: 0.8405717
	speed: 0.0095s/iter; left time: 6.0399s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.5514 --> 0.5484).  Saving model state dict ...
Epoch: 3 cost time: 0.7517600059509277
Epoch: 3, Steps: 123 | Train Loss: 0.8405717 Vali Loss: 0.5483977 Best vali loss: 0.5483977

best validation loss 0.5483977195566752

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8054365
	speed: 0.0118s/iter; left time: 10.4807s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.6091).  Saving model state dict ...
Epoch: 1 cost time: 1.0459814071655273
Epoch: 1, Steps: 123 | Train Loss: 0.8054365 Vali Loss: 0.6090748 Best vali loss: 0.6090748
	iters: 100, epoch: 2 | loss: 0.9287331
	speed: 0.0094s/iter; left time: 7.1548s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.6091 --> 0.5693).  Saving model state dict ...
Epoch: 2 cost time: 0.7406518459320068
Epoch: 2, Steps: 123 | Train Loss: 0.9287331 Vali Loss: 0.5693131 Best vali loss: 0.5693131
	iters: 100, epoch: 3 | loss: 0.7659122
	speed: 0.0094s/iter; left time: 6.0136s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.5693 --> 0.5573).  Saving model state dict ...
Epoch: 3 cost time: 0.7347040176391602
Epoch: 3, Steps: 123 | Train Loss: 0.7659122 Vali Loss: 0.5573066 Best vali loss: 0.5573066

best validation loss 0.5573066448183426

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5893679
	speed: 0.0121s/iter; left time: 6.2356s
Updating learning rate to 3.7229189375e-05
Validation loss decreased (0.5484 --> 0.5352).  Saving model state dict ...
Epoch: 4 cost time: 1.0388116836547852
Epoch: 4, Steps: 123 | Train Loss: 0.5893679 Vali Loss: 0.5352154 Best vali loss: 0.5352154
	iters: 100, epoch: 5 | loss: 0.6138642
	speed: 0.0093s/iter; left time: 3.6737s
Updating learning rate to 1.86145946875e-05
Epoch: 5 cost time: 0.7443861961364746
Epoch: 5, Steps: 123 | Train Loss: 0.6138642 Vali Loss: 0.5365260 Best vali loss: 0.5352154
	iters: 100, epoch: 6 | loss: 0.7954011
	speed: 0.0090s/iter; left time: 2.4204s
Updating learning rate to 9.30729734375e-06
Epoch: 6 cost time: 0.7249817848205566
Epoch: 6, Steps: 123 | Train Loss: 0.7954011 Vali Loss: 0.5367955 Best vali loss: 0.5352154
	iters: 100, epoch: 7 | loss: 0.5207376
	speed: 0.0090s/iter; left time: 1.3253s
Updating learning rate to 4.653648671875e-06
Epoch: 7 cost time: 0.7372722625732422
Epoch: 7, Steps: 123 | Train Loss: 0.5207376 Vali Loss: 0.5364669 Best vali loss: 0.5352154
	iters: 100, epoch: 8 | loss: 0.6013213
	speed: 0.0090s/iter; left time: 0.2149s
Updating learning rate to 2.3268243359375e-06
Validation loss decreased (0.5352 --> 0.5346).  Saving model state dict ...
Epoch: 8 cost time: 0.7307517528533936
Epoch: 8, Steps: 123 | Train Loss: 0.6013213 Vali Loss: 0.5345612 Best vali loss: 0.5345612

best validation loss 0.5345611894698895

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 1, 'learning_rate': 0.0002993433646, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00028795028617350187
Validation loss decreased (inf --> 0.5970).  Saving model state dict ...
Epoch: 1 cost time: 0.6939318180084229
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5969782 Best vali loss: 0.5969782
Updating learning rate to 0.00025550554380592857
Epoch: 2 cost time: 0.4223926067352295
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6020346 Best vali loss: 0.5969782
Updating learning rate to 0.00020694855541042128
Epoch: 3 cost time: 0.44637417793273926
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6031094 Best vali loss: 0.5969782
Updating learning rate to 0.0001496716823
Epoch: 4 cost time: 0.4129157066345215
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6171608 Best vali loss: 0.5969782
Updating learning rate to 9.239480918957876e-05
Epoch: 5 cost time: 0.43087267875671387
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6170471 Best vali loss: 0.5969782
Updating learning rate to 4.383782079407146e-05
Epoch: 6 cost time: 0.4217233657836914
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6210721 Best vali loss: 0.5969782
Updating learning rate to 1.1393078426498171e-05
Epoch: 7 cost time: 0.41109752655029297
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6217576 Best vali loss: 0.5969782
Updating learning rate to 0.0
Epoch: 8 cost time: 0.39728856086730957
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6247028 Best vali loss: 0.5969782

best validation loss 0.5969782232521089

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010435525035, 'e_layers': 1, 'learning_rate': 0.0002976906406, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002976906406
Validation loss decreased (inf --> 0.5971).  Saving model state dict ...
Epoch: 1 cost time: 0.7220568656921387
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5970549 Best vali loss: 0.5970549
Updating learning rate to 0.0001488453203
Epoch: 2 cost time: 0.43819475173950195
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6021994 Best vali loss: 0.5970549
Updating learning rate to 7.442266015e-05
Epoch: 3 cost time: 0.4501512050628662
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6015883 Best vali loss: 0.5970549
Updating learning rate to 3.7211330075e-05
Epoch: 4 cost time: 0.4505934715270996
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6056136 Best vali loss: 0.5970549
Updating learning rate to 1.86056650375e-05
Epoch: 5 cost time: 0.43854188919067383
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6076342 Best vali loss: 0.5970549
Updating learning rate to 9.30283251875e-06
Epoch: 6 cost time: 0.454470157623291
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6075830 Best vali loss: 0.5970549
Updating learning rate to 4.651416259375e-06
Epoch: 7 cost time: 0.4306221008300781
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6079500 Best vali loss: 0.5970549
Updating learning rate to 2.3257081296875e-06
Epoch: 8 cost time: 0.40395116806030273
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6067312 Best vali loss: 0.5970549

best validation loss 0.5970549232040716

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010439794891, 'e_layers': 1, 'learning_rate': 0.0002979326977, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002865933095854512
Validation loss decreased (inf --> 0.5970).  Saving model state dict ...
Epoch: 1 cost time: 0.7239346504211426
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5970429 Best vali loss: 0.5970429
Updating learning rate to 0.0002543014642904358
Epoch: 2 cost time: 0.4317800998687744
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6020019 Best vali loss: 0.5970429
Updating learning rate to 0.00020597330253481334
Epoch: 3 cost time: 0.41669154167175293
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6030942 Best vali loss: 0.5970429

best validation loss 0.5970428556493453

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010432840424, 'e_layers': 1, 'learning_rate': 0.000297330819, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000286014338529459
Validation loss decreased (inf --> 0.5971).  Saving model state dict ...
Epoch: 1 cost time: 0.7150406837463379
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5970704 Best vali loss: 0.5970704
Updating learning rate to 0.00025378772868532497
Epoch: 2 cost time: 0.4392225742340088
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6020859 Best vali loss: 0.5970704
Updating learning rate to 0.0002055571986814216
Epoch: 3 cost time: 0.4513232707977295
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6031259 Best vali loss: 0.5970704

best validation loss 0.5970704339544622

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8481805
	speed: 0.0122s/iter; left time: 10.8224s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 1.1024177074432373
Epoch: 1, Steps: 123 | Train Loss: 0.8481805 Vali Loss: 0.6699286 Best vali loss: 0.6699286
	iters: 100, epoch: 2 | loss: 0.6296231
	speed: 0.0098s/iter; left time: 7.4639s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.6699 --> 0.6448).  Saving model state dict ...
Epoch: 2 cost time: 0.8083980083465576
Epoch: 2, Steps: 123 | Train Loss: 0.6296231 Vali Loss: 0.6447909 Best vali loss: 0.6447909
	iters: 100, epoch: 3 | loss: 0.9809685
	speed: 0.0099s/iter; left time: 6.2942s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.6448 --> 0.6316).  Saving model state dict ...
Epoch: 3 cost time: 0.8193659782409668
Epoch: 3, Steps: 123 | Train Loss: 0.9809685 Vali Loss: 0.6316080 Best vali loss: 0.6316080

best validation loss 0.6316079751643137

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010439794891, 'e_layers': 1, 'learning_rate': 0.0002979326977, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00014896634885
Epoch: 4 cost time: 0.7360100746154785
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6012178 Best vali loss: 0.5970429
Updating learning rate to 9.195939516518666e-05
Epoch: 5 cost time: 0.44567012786865234
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6076684 Best vali loss: 0.5970429
Updating learning rate to 4.3631233409564154e-05
Epoch: 6 cost time: 0.442058801651001
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6245581 Best vali loss: 0.5970429
Updating learning rate to 1.1339388114548742e-05
Epoch: 7 cost time: 0.4331493377685547
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6333376 Best vali loss: 0.5970429
Updating learning rate to 0.0
Epoch: 8 cost time: 0.44079065322875977
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6256428 Best vali loss: 0.5970429

best validation loss 0.5970428556493453

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010435338265, 'e_layers': 3, 'learning_rate': 8.97148235e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8139935
	speed: 0.0119s/iter; left time: 10.5250s
Updating learning rate to 8.97148235e-05
Validation loss decreased (inf --> 0.6044).  Saving model state dict ...
Epoch: 1 cost time: 1.0389866828918457
Epoch: 1, Steps: 123 | Train Loss: 0.8139935 Vali Loss: 0.6044402 Best vali loss: 0.6044402
	iters: 100, epoch: 2 | loss: 0.9731796
	speed: 0.0093s/iter; left time: 7.1085s
Updating learning rate to 4.485741175e-05
Validation loss decreased (0.6044 --> 0.5953).  Saving model state dict ...
Epoch: 2 cost time: 0.7522058486938477
Epoch: 2, Steps: 123 | Train Loss: 0.9731796 Vali Loss: 0.5953242 Best vali loss: 0.5953242
	iters: 100, epoch: 3 | loss: 0.8119334
	speed: 0.0093s/iter; left time: 5.9148s
Updating learning rate to 2.2428705875e-05
Validation loss decreased (0.5953 --> 0.5821).  Saving model state dict ...
Epoch: 3 cost time: 0.7425508499145508
Epoch: 3, Steps: 123 | Train Loss: 0.8119334 Vali Loss: 0.5821026 Best vali loss: 0.5821026
	iters: 100, epoch: 4 | loss: 0.5760620
	speed: 0.0093s/iter; left time: 4.8133s
Updating learning rate to 1.12143529375e-05
Validation loss decreased (0.5821 --> 0.5639).  Saving model state dict ...
Epoch: 4 cost time: 0.7447218894958496
Epoch: 4, Steps: 123 | Train Loss: 0.5760620 Vali Loss: 0.5639365 Best vali loss: 0.5639365
	iters: 100, epoch: 5 | loss: 0.9376547
	speed: 0.0092s/iter; left time: 3.6092s
Updating learning rate to 5.60717646875e-06
Epoch: 5 cost time: 0.7271575927734375
Epoch: 5, Steps: 123 | Train Loss: 0.9376547 Vali Loss: 0.5666879 Best vali loss: 0.5639365
	iters: 100, epoch: 6 | loss: 0.7547819
	speed: 0.0094s/iter; left time: 2.5460s
Updating learning rate to 2.803588234375e-06
Validation loss decreased (0.5639 --> 0.5601).  Saving model state dict ...
Epoch: 6 cost time: 0.7589983940124512
Epoch: 6, Steps: 123 | Train Loss: 0.7547819 Vali Loss: 0.5601399 Best vali loss: 0.5601399
	iters: 100, epoch: 7 | loss: 0.8707125
	speed: 0.0095s/iter; left time: 1.3970s
Updating learning rate to 1.4017941171875e-06
Validation loss decreased (0.5601 --> 0.5574).  Saving model state dict ...
Epoch: 7 cost time: 0.7410171031951904
Epoch: 7, Steps: 123 | Train Loss: 0.8707125 Vali Loss: 0.5573905 Best vali loss: 0.5573905
	iters: 100, epoch: 8 | loss: 0.9813539
	speed: 0.0094s/iter; left time: 0.2255s
Updating learning rate to 7.0089705859375e-07
Epoch: 8 cost time: 0.7446050643920898
Epoch: 8, Steps: 123 | Train Loss: 0.9813539 Vali Loss: 0.5585011 Best vali loss: 0.5573905

best validation loss 0.5573905054091965

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010435636565, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8156303
	speed: 0.0114s/iter; left time: 10.0495s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.5941).  Saving model state dict ...
Epoch: 1 cost time: 0.9735033512115479
Epoch: 1, Steps: 123 | Train Loss: 0.8156303 Vali Loss: 0.5941156 Best vali loss: 0.5941156
	iters: 100, epoch: 2 | loss: 0.9073023
	speed: 0.0085s/iter; left time: 6.5117s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5941 --> 0.5626).  Saving model state dict ...
Epoch: 2 cost time: 0.6690926551818848
Epoch: 2, Steps: 123 | Train Loss: 0.9073023 Vali Loss: 0.5625956 Best vali loss: 0.5625956
	iters: 100, epoch: 3 | loss: 0.7097151
	speed: 0.0089s/iter; left time: 5.7105s
Updating learning rate to 7.445837875e-05
Epoch: 3 cost time: 0.666607141494751
Epoch: 3, Steps: 123 | Train Loss: 0.7097151 Vali Loss: 0.5728253 Best vali loss: 0.5625956
	iters: 100, epoch: 4 | loss: 0.6529732
	speed: 0.0084s/iter; left time: 4.3543s
Updating learning rate to 3.7229189375e-05
Validation loss decreased (0.5626 --> 0.5541).  Saving model state dict ...
Epoch: 4 cost time: 0.6631875038146973
Epoch: 4, Steps: 123 | Train Loss: 0.6529732 Vali Loss: 0.5541277 Best vali loss: 0.5541277
	iters: 100, epoch: 5 | loss: 0.7177783
	speed: 0.0087s/iter; left time: 3.4131s
Updating learning rate to 1.86145946875e-05
Validation loss decreased (0.5541 --> 0.5479).  Saving model state dict ...
Epoch: 5 cost time: 0.6713080406188965
Epoch: 5, Steps: 123 | Train Loss: 0.7177783 Vali Loss: 0.5479458 Best vali loss: 0.5479458
	iters: 100, epoch: 6 | loss: 0.8937048
	speed: 0.0087s/iter; left time: 2.3417s
Updating learning rate to 9.30729734375e-06
Validation loss decreased (0.5479 --> 0.5463).  Saving model state dict ...
Epoch: 6 cost time: 0.6731312274932861
Epoch: 6, Steps: 123 | Train Loss: 0.8937048 Vali Loss: 0.5463167 Best vali loss: 0.5463167
	iters: 100, epoch: 7 | loss: 0.6031977
	speed: 0.0087s/iter; left time: 1.2759s
Updating learning rate to 4.653648671875e-06
Validation loss decreased (0.5463 --> 0.5451).  Saving model state dict ...
Epoch: 7 cost time: 0.6700825691223145
Epoch: 7, Steps: 123 | Train Loss: 0.6031977 Vali Loss: 0.5450526 Best vali loss: 0.5450526
	iters: 100, epoch: 8 | loss: 0.6662791
	speed: 0.0086s/iter; left time: 0.2068s
Updating learning rate to 2.3268243359375e-06
Validation loss decreased (0.5451 --> 0.5435).  Saving model state dict ...
Epoch: 8 cost time: 0.6672320365905762
Epoch: 8, Steps: 123 | Train Loss: 0.6662791 Vali Loss: 0.5435441 Best vali loss: 0.5435441

best validation loss 0.5435440913222003

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010430740522, 'e_layers': 2, 'learning_rate': 0.0002978257308, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8156344
	speed: 0.0111s/iter; left time: 9.7982s
Updating learning rate to 0.0002978257308
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.950425386428833
Epoch: 1, Steps: 123 | Train Loss: 0.8156344 Vali Loss: 0.5942679 Best vali loss: 0.5942679
	iters: 100, epoch: 2 | loss: 0.9418730
	speed: 0.0086s/iter; left time: 6.5183s
Updating learning rate to 0.0001489128654
Epoch: 2 cost time: 0.6686666011810303
Epoch: 2, Steps: 123 | Train Loss: 0.9418730 Vali Loss: 0.5955583 Best vali loss: 0.5942679
	iters: 100, epoch: 3 | loss: 0.7353548
	speed: 0.0085s/iter; left time: 5.4226s
Updating learning rate to 7.44564327e-05
Validation loss decreased (0.5943 --> 0.5635).  Saving model state dict ...
Epoch: 3 cost time: 0.6690173149108887
Epoch: 3, Steps: 123 | Train Loss: 0.7353548 Vali Loss: 0.5634766 Best vali loss: 0.5634766

best validation loss 0.5634766323927209

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010428446084, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8159499
	speed: 0.0113s/iter; left time: 9.9661s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9614720344543457
Epoch: 1, Steps: 123 | Train Loss: 0.8159499 Vali Loss: 0.5942832 Best vali loss: 0.5942832
	iters: 100, epoch: 2 | loss: 0.9106870
	speed: 0.0086s/iter; left time: 6.5250s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5943 --> 0.5633).  Saving model state dict ...
Epoch: 2 cost time: 0.6672911643981934
Epoch: 2, Steps: 123 | Train Loss: 0.9106870 Vali Loss: 0.5633131 Best vali loss: 0.5633131
	iters: 100, epoch: 3 | loss: 0.6961856
	speed: 0.0088s/iter; left time: 5.5986s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.5633 --> 0.5575).  Saving model state dict ...
Epoch: 3 cost time: 0.6738026142120361
Epoch: 3, Steps: 123 | Train Loss: 0.6961856 Vali Loss: 0.5574760 Best vali loss: 0.5574760

best validation loss 0.5574760200082566

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.0003698969511, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6880385
	speed: 0.0134s/iter; left time: 11.8545s
Updating learning rate to 0.0003698969511
Validation loss decreased (inf --> 0.6059).  Saving model state dict ...
Epoch: 1 cost time: 1.2224161624908447
Epoch: 1, Steps: 123 | Train Loss: 0.6880385 Vali Loss: 0.6059067 Best vali loss: 0.6059067
	iters: 100, epoch: 2 | loss: 1.1119505
	speed: 0.0114s/iter; left time: 8.7113s
Updating learning rate to 0.00018494847555
Validation loss decreased (0.6059 --> 0.5502).  Saving model state dict ...
Epoch: 2 cost time: 0.9236431121826172
Epoch: 2, Steps: 123 | Train Loss: 1.1119505 Vali Loss: 0.5502382 Best vali loss: 0.5502382
	iters: 100, epoch: 3 | loss: 0.6002450
	speed: 0.0116s/iter; left time: 7.3881s
Updating learning rate to 9.2474237775e-05
Epoch: 3 cost time: 0.9170360565185547
Epoch: 3, Steps: 123 | Train Loss: 0.6002450 Vali Loss: 0.5524104 Best vali loss: 0.5502382

best validation loss 0.5502382275242874

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.0003698969511, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5396308
	speed: 0.0136s/iter; left time: 7.0163s
Updating learning rate to 4.62371188875e-05
Validation loss decreased (0.5502 --> 0.5477).  Saving model state dict ...
Epoch: 4 cost time: 1.2221977710723877
Epoch: 4, Steps: 123 | Train Loss: 0.5396308 Vali Loss: 0.5477246 Best vali loss: 0.5477246
	iters: 100, epoch: 5 | loss: 0.9916216
	speed: 0.0114s/iter; left time: 4.4751s
Updating learning rate to 2.311855944375e-05
Epoch: 5 cost time: 0.9122662544250488
Epoch: 5, Steps: 123 | Train Loss: 0.9916216 Vali Loss: 0.5480263 Best vali loss: 0.5477246
	iters: 100, epoch: 6 | loss: 0.5667909
	speed: 0.0112s/iter; left time: 3.0218s
Updating learning rate to 1.1559279721875e-05
Validation loss decreased (0.5477 --> 0.5421).  Saving model state dict ...
Epoch: 6 cost time: 0.9122164249420166
Epoch: 6, Steps: 123 | Train Loss: 0.5667909 Vali Loss: 0.5420879 Best vali loss: 0.5420879
	iters: 100, epoch: 7 | loss: 0.7392260
	speed: 0.0114s/iter; left time: 1.6786s
Updating learning rate to 5.7796398609375e-06
Epoch: 7 cost time: 0.9108138084411621
Epoch: 7, Steps: 123 | Train Loss: 0.7392260 Vali Loss: 0.5436338 Best vali loss: 0.5420879
	iters: 100, epoch: 8 | loss: 0.4933165
	speed: 0.0112s/iter; left time: 0.2693s
Updating learning rate to 2.88981993046875e-06
Epoch: 8 cost time: 0.9211287498474121
Epoch: 8, Steps: 123 | Train Loss: 0.4933165 Vali Loss: 0.5462877 Best vali loss: 0.5420879

best validation loss 0.5420879218960073

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010444015985, 'e_layers': 3, 'learning_rate': 0.0002970292487, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6188813
	speed: 0.0140s/iter; left time: 12.3953s
Updating learning rate to 0.0002857242460655674
Validation loss decreased (inf --> 0.6147).  Saving model state dict ...
Epoch: 1 cost time: 1.2913932800292969
Epoch: 1, Steps: 123 | Train Loss: 0.6188813 Vali Loss: 0.6146842 Best vali loss: 0.6146842
	iters: 100, epoch: 2 | loss: 0.7350374
	speed: 0.0123s/iter; left time: 9.3455s
Updating learning rate to 0.00025353032233325776
Validation loss decreased (0.6147 --> 0.5679).  Saving model state dict ...
Epoch: 2 cost time: 0.9979903697967529
Epoch: 2, Steps: 123 | Train Loss: 0.7350374 Vali Loss: 0.5679275 Best vali loss: 0.5679275
	iters: 100, epoch: 3 | loss: 0.6472868
	speed: 0.0125s/iter; left time: 7.9659s
Updating learning rate to 0.00020534871055266998
Validation loss decreased (0.5679 --> 0.5545).  Saving model state dict ...
Epoch: 3 cost time: 0.9946000576019287
Epoch: 3, Steps: 123 | Train Loss: 0.6472868 Vali Loss: 0.5544653 Best vali loss: 0.5544653
	iters: 100, epoch: 4 | loss: 0.8553445
	speed: 0.0123s/iter; left time: 6.3691s
Updating learning rate to 0.00014851462435
Validation loss decreased (0.5545 --> 0.5477).  Saving model state dict ...
Epoch: 4 cost time: 1.0015113353729248
Epoch: 4, Steps: 123 | Train Loss: 0.8553445 Vali Loss: 0.5476528 Best vali loss: 0.5476528
	iters: 100, epoch: 5 | loss: 0.6730960
	speed: 0.0124s/iter; left time: 4.8824s
Updating learning rate to 9.168053814733007e-05
Validation loss decreased (0.5477 --> 0.5333).  Saving model state dict ...
Epoch: 5 cost time: 0.9999134540557861
Epoch: 5, Steps: 123 | Train Loss: 0.6730960 Vali Loss: 0.5332602 Best vali loss: 0.5332602
	iters: 100, epoch: 6 | loss: 0.4314047
	speed: 0.0124s/iter; left time: 3.3446s
Updating learning rate to 4.349892636674226e-05
Epoch: 6 cost time: 1.0044145584106445
Epoch: 6, Steps: 123 | Train Loss: 0.4314047 Vali Loss: 0.5492895 Best vali loss: 0.5332602
	iters: 100, epoch: 7 | loss: 0.7689590
	speed: 0.0121s/iter; left time: 1.7779s
Updating learning rate to 1.130500263443264e-05
Epoch: 7 cost time: 1.0031137466430664
Epoch: 7, Steps: 123 | Train Loss: 0.7689590 Vali Loss: 0.5623460 Best vali loss: 0.5332602
	iters: 100, epoch: 8 | loss: 0.6641682
	speed: 0.0120s/iter; left time: 0.2883s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9973509311676025
Epoch: 8, Steps: 123 | Train Loss: 0.6641682 Vali Loss: 0.5701384 Best vali loss: 0.5332602

best validation loss 0.5332602238500631

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9379280
	speed: 0.0112s/iter; left time: 20.8528s
	iters: 200, epoch: 1 | loss: 0.8380154
	speed: 0.0050s/iter; left time: 8.7472s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.6161).  Saving model state dict ...
Epoch: 1 cost time: 1.5591413974761963
Epoch: 1, Steps: 245 | Train Loss: 0.8879717 Vali Loss: 0.6161222 Best vali loss: 0.6161222
	iters: 100, epoch: 2 | loss: 1.0010203
	speed: 0.0097s/iter; left time: 15.7359s
	iters: 200, epoch: 2 | loss: 0.7101033
	speed: 0.0049s/iter; left time: 7.4360s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.6161 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 1.2479486465454102
Epoch: 2, Steps: 245 | Train Loss: 0.8555618 Vali Loss: 0.6038301 Best vali loss: 0.6038301
	iters: 100, epoch: 3 | loss: 1.1486980
	speed: 0.0092s/iter; left time: 12.6529s
	iters: 200, epoch: 3 | loss: 0.9286205
	speed: 0.0042s/iter; left time: 5.3762s
Updating learning rate to 7.441812635926816e-05
Validation loss decreased (0.6038 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 1.0950546264648438
Epoch: 3, Steps: 245 | Train Loss: 1.0386592 Vali Loss: 0.6012048 Best vali loss: 0.6012048
	iters: 100, epoch: 4 | loss: 0.6674048
	speed: 0.0087s/iter; left time: 9.8196s
	iters: 200, epoch: 4 | loss: 0.6504672
	speed: 0.0045s/iter; left time: 4.5994s
Updating learning rate to 5.38215217e-05
Validation loss decreased (0.6012 --> 0.5866).  Saving model state dict ...
Epoch: 4 cost time: 1.1307590007781982
Epoch: 4, Steps: 245 | Train Loss: 0.6589360 Vali Loss: 0.5865524 Best vali loss: 0.5865524
	iters: 100, epoch: 5 | loss: 0.8646617
	speed: 0.0091s/iter; left time: 7.9750s
	iters: 200, epoch: 5 | loss: 0.7574525
	speed: 0.0044s/iter; left time: 3.4467s
Updating learning rate to 3.3224917040731837e-05
Epoch: 5 cost time: 1.1291029453277588
Epoch: 5, Steps: 245 | Train Loss: 0.8110571 Vali Loss: 0.5940066 Best vali loss: 0.5865524
	iters: 100, epoch: 6 | loss: 0.7044720
	speed: 0.0095s/iter; left time: 6.0552s
	iters: 200, epoch: 6 | loss: 0.9268692
	speed: 0.0047s/iter; left time: 2.5006s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 1.201814889907837
Epoch: 6, Steps: 245 | Train Loss: 0.8156706 Vali Loss: 0.5929250 Best vali loss: 0.5865524
	iters: 100, epoch: 7 | loss: 0.4613200
	speed: 0.0094s/iter; left time: 3.6795s
	iters: 200, epoch: 7 | loss: 0.8241265
	speed: 0.0049s/iter; left time: 1.4206s
Updating learning rate to 4.096919392757925e-06
Validation loss decreased (0.5866 --> 0.5856).  Saving model state dict ...
Epoch: 7 cost time: 1.2470834255218506
Epoch: 7, Steps: 245 | Train Loss: 0.6427233 Vali Loss: 0.5855853 Best vali loss: 0.5855853
	iters: 100, epoch: 8 | loss: 0.8310553
	speed: 0.0096s/iter; left time: 1.4009s
	iters: 200, epoch: 8 | loss: 0.7265063
	speed: 0.0047s/iter; left time: 0.2158s
Updating learning rate to 0.0
Validation loss decreased (0.5856 --> 0.5855).  Saving model state dict ...
Epoch: 8 cost time: 1.2106797695159912
Epoch: 8, Steps: 245 | Train Loss: 0.7787808 Vali Loss: 0.5855052 Best vali loss: 0.5855052

best validation loss 0.5855051721482848

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010128859473, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6855921
	speed: 0.0132s/iter; left time: 11.6515s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6191).  Saving model state dict ...
Epoch: 1 cost time: 1.2218177318572998
Epoch: 1, Steps: 123 | Train Loss: 0.6855921 Vali Loss: 0.6191144 Best vali loss: 0.6191144
	iters: 100, epoch: 2 | loss: 1.1073254
	speed: 0.0113s/iter; left time: 8.6238s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6191 --> 0.5549).  Saving model state dict ...
Epoch: 2 cost time: 0.9127554893493652
Epoch: 2, Steps: 123 | Train Loss: 1.1073254 Vali Loss: 0.5548761 Best vali loss: 0.5548761
	iters: 100, epoch: 3 | loss: 0.6057525
	speed: 0.0114s/iter; left time: 7.2776s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.9077794551849365
Epoch: 3, Steps: 123 | Train Loss: 0.6057525 Vali Loss: 0.5733921 Best vali loss: 0.5548761

best validation loss 0.5548760896201268

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010134430632, 'e_layers': 2, 'learning_rate': 0.0002913217318, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7737870
	speed: 0.0116s/iter; left time: 10.2517s
Updating learning rate to 0.0002802339585928812
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0243782997131348
Epoch: 1, Steps: 123 | Train Loss: 0.7737870 Vali Loss: 0.6171084 Best vali loss: 0.6171084
	iters: 100, epoch: 2 | loss: 0.9427289
	speed: 0.0091s/iter; left time: 6.9448s
Updating learning rate to 0.0002486586519313943
Validation loss decreased (0.6171 --> 0.5616).  Saving model state dict ...
Epoch: 2 cost time: 0.7162094116210938
Epoch: 2, Steps: 123 | Train Loss: 0.9427289 Vali Loss: 0.5615785 Best vali loss: 0.5615785
	iters: 100, epoch: 3 | loss: 0.8428026
	speed: 0.0093s/iter; left time: 5.9144s
Updating learning rate to 0.00020140286602388305
Validation loss decreased (0.5616 --> 0.5511).  Saving model state dict ...
Epoch: 3 cost time: 0.7133903503417969
Epoch: 3, Steps: 123 | Train Loss: 0.8428026 Vali Loss: 0.5510724 Best vali loss: 0.5510724

best validation loss 0.5510723999891497

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 2, 'learning_rate': 0.0003806404214, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7758595
	speed: 0.0116s/iter; left time: 10.2727s
Updating learning rate to 0.0003661531579889656
Validation loss decreased (inf --> 0.6176).  Saving model state dict ...
Epoch: 1 cost time: 1.0097770690917969
Epoch: 1, Steps: 123 | Train Loss: 0.7758595 Vali Loss: 0.6176003 Best vali loss: 0.6176003
	iters: 100, epoch: 2 | loss: 0.9439967
	speed: 0.0090s/iter; left time: 6.8868s
Updating learning rate to 0.0003248969222828225
Validation loss decreased (0.6176 --> 0.6128).  Saving model state dict ...
Epoch: 2 cost time: 0.7109375
Epoch: 2, Steps: 123 | Train Loss: 0.9439967 Vali Loss: 0.6127626 Best vali loss: 0.6127626
	iters: 100, epoch: 3 | loss: 0.8387237
	speed: 0.0092s/iter; left time: 5.9107s
Updating learning rate to 0.0002631526021791231
Validation loss decreased (0.6128 --> 0.5533).  Saving model state dict ...
Epoch: 3 cost time: 0.7208366394042969
Epoch: 3, Steps: 123 | Train Loss: 0.8387237 Vali Loss: 0.5533265 Best vali loss: 0.5533265

best validation loss 0.5533264672684481

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010134430632, 'e_layers': 2, 'learning_rate': 0.0002913217318, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5887410
	speed: 0.0119s/iter; left time: 6.1361s
Updating learning rate to 0.0001456608659
Validation loss decreased (0.5511 --> 0.5322).  Saving model state dict ...
Epoch: 4 cost time: 1.0137457847595215
Epoch: 4, Steps: 123 | Train Loss: 0.5887410 Vali Loss: 0.5321929 Best vali loss: 0.5321929
	iters: 100, epoch: 5 | loss: 0.8165572
	speed: 0.0093s/iter; left time: 3.6681s
Updating learning rate to 8.991886577611694e-05
Epoch: 5 cost time: 0.7159054279327393
Epoch: 5, Steps: 123 | Train Loss: 0.8165572 Vali Loss: 0.5328614 Best vali loss: 0.5321929
	iters: 100, epoch: 6 | loss: 0.7595608
	speed: 0.0089s/iter; left time: 2.4130s
Updating learning rate to 4.266307986860566e-05
Epoch: 6 cost time: 0.7181246280670166
Epoch: 6, Steps: 123 | Train Loss: 0.7595608 Vali Loss: 0.5370324 Best vali loss: 0.5321929
	iters: 100, epoch: 7 | loss: 0.4356731
	speed: 0.0090s/iter; left time: 1.3189s
Updating learning rate to 1.1087773207118772e-05
Epoch: 7 cost time: 0.7190964221954346
Epoch: 7, Steps: 123 | Train Loss: 0.4356731 Vali Loss: 0.5437017 Best vali loss: 0.5321929
	iters: 100, epoch: 8 | loss: 0.5094709
	speed: 0.0089s/iter; left time: 0.2141s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7129220962524414
Epoch: 8, Steps: 123 | Train Loss: 0.5094709 Vali Loss: 0.5432531 Best vali loss: 0.5321929

best validation loss 0.5321929012664431

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 4, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7511771
	speed: 0.0161s/iter; left time: 14.2287s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6092).  Saving model state dict ...
Epoch: 1 cost time: 1.5754048824310303
Epoch: 1, Steps: 123 | Train Loss: 0.7511771 Vali Loss: 0.6092332 Best vali loss: 0.6092332
	iters: 100, epoch: 2 | loss: 0.9678333
	speed: 0.0153s/iter; left time: 11.6839s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6092 --> 0.6005).  Saving model state dict ...
Epoch: 2 cost time: 1.268575668334961
Epoch: 2, Steps: 123 | Train Loss: 0.9678333 Vali Loss: 0.6005213 Best vali loss: 0.6005213
	iters: 100, epoch: 3 | loss: 0.7707123
	speed: 0.0156s/iter; left time: 9.9873s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6005 --> 0.5743).  Saving model state dict ...
Epoch: 3 cost time: 1.275719404220581
Epoch: 3, Steps: 123 | Train Loss: 0.7707123 Vali Loss: 0.5743370 Best vali loss: 0.5743370
	iters: 100, epoch: 4 | loss: 0.5829194
	speed: 0.0155s/iter; left time: 7.9952s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5743 --> 0.5648).  Saving model state dict ...
Epoch: 4 cost time: 1.2700095176696777
Epoch: 4, Steps: 123 | Train Loss: 0.5829194 Vali Loss: 0.5648155 Best vali loss: 0.5648155
	iters: 100, epoch: 5 | loss: 0.6199592
	speed: 0.0156s/iter; left time: 6.1255s
Updating learning rate to 9.192878160322029e-05
Epoch: 5 cost time: 1.2761430740356445
Epoch: 5, Steps: 123 | Train Loss: 0.6199592 Vali Loss: 0.5669068 Best vali loss: 0.5648155
	iters: 100, epoch: 6 | loss: 0.6763483
	speed: 0.0150s/iter; left time: 4.0625s
Updating learning rate to 4.361670843943735e-05
Validation loss decreased (0.5648 --> 0.5557).  Saving model state dict ...
Epoch: 6 cost time: 1.2760357856750488
Epoch: 6, Steps: 123 | Train Loss: 0.6763483 Vali Loss: 0.5556834 Best vali loss: 0.5556834
	iters: 100, epoch: 7 | loss: 0.6463442
	speed: 0.0155s/iter; left time: 2.2769s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 1.268552541732788
Epoch: 7, Steps: 123 | Train Loss: 0.6463442 Vali Loss: 0.5708526 Best vali loss: 0.5556834
	iters: 100, epoch: 8 | loss: 0.5847679
	speed: 0.0150s/iter; left time: 0.3608s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2805299758911133
Epoch: 8, Steps: 123 | Train Loss: 0.5847679 Vali Loss: 0.5719003 Best vali loss: 0.5556834

best validation loss 0.5556833774389243

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.6042).  Saving model state dict ...
Epoch: 1 cost time: 0.8215117454528809
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6042384 Best vali loss: 0.6042384
Updating learning rate to 0.0005975820137081337
Epoch: 2 cost time: 0.5335996150970459
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6099734 Best vali loss: 0.6042384
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.5012009143829346
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6121767 Best vali loss: 0.6042384
Updating learning rate to 0.000350055439
Validation loss decreased (0.6042 --> 0.5692).  Saving model state dict ...
Epoch: 4 cost time: 0.5070557594299316
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5691661 Best vali loss: 0.5691661
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.5692 --> 0.5659).  Saving model state dict ...
Epoch: 5 cost time: 0.5323665142059326
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5658606 Best vali loss: 0.5658606
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.508709192276001
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5665126 Best vali loss: 0.5658606
Updating learning rate to 2.6646383663646746e-05
Validation loss decreased (0.5659 --> 0.5613).  Saving model state dict ...
Epoch: 7 cost time: 0.5150811672210693
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5613317 Best vali loss: 0.5613317
Updating learning rate to 0.0
Validation loss decreased (0.5613 --> 0.5551).  Saving model state dict ...
Epoch: 8 cost time: 0.5131015777587891
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5551088 Best vali loss: 0.5551088

best validation loss 0.5551087700730394

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 2.3358383
	speed: 0.0112s/iter; left time: 86.4250s
	iters: 200, epoch: 1 | loss: 1.2123019
	speed: 0.0052s/iter; left time: 39.8117s
	iters: 300, epoch: 1 | loss: 1.1163514
	speed: 0.0051s/iter; left time: 38.1303s
	iters: 400, epoch: 1 | loss: 0.3345290
	speed: 0.0052s/iter; left time: 38.4314s
	iters: 500, epoch: 1 | loss: 0.7807001
	speed: 0.0047s/iter; left time: 34.5206s
	iters: 600, epoch: 1 | loss: 1.4049903
	speed: 0.0047s/iter; left time: 34.1071s
	iters: 700, epoch: 1 | loss: 1.0068423
	speed: 0.0047s/iter; left time: 33.8322s
	iters: 800, epoch: 1 | loss: 0.8660811
	speed: 0.0048s/iter; left time: 33.6866s
	iters: 900, epoch: 1 | loss: 1.3942084
	speed: 0.0046s/iter; left time: 32.1583s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.6066).  Saving model state dict ...
Epoch: 1 cost time: 5.126302480697632
Epoch: 1, Steps: 979 | Train Loss: 1.1613159 Vali Loss: 0.6065905 Best vali loss: 0.6065905
	iters: 100, epoch: 2 | loss: 0.2503504
	speed: 0.0152s/iter; left time: 102.8103s
	iters: 200, epoch: 2 | loss: 0.2390729
	speed: 0.0050s/iter; left time: 33.2679s
	iters: 300, epoch: 2 | loss: 1.4310956
	speed: 0.0049s/iter; left time: 32.1258s
	iters: 400, epoch: 2 | loss: 1.0047297
	speed: 0.0051s/iter; left time: 32.9799s
	iters: 500, epoch: 2 | loss: 1.4901714
	speed: 0.0050s/iter; left time: 31.8943s
	iters: 600, epoch: 2 | loss: 1.0131340
	speed: 0.0047s/iter; left time: 29.2270s
	iters: 700, epoch: 2 | loss: 0.5593860
	speed: 0.0048s/iter; left time: 29.5959s
	iters: 800, epoch: 2 | loss: 1.2332467
	speed: 0.0050s/iter; left time: 30.0972s
	iters: 900, epoch: 2 | loss: 1.1524289
	speed: 0.0048s/iter; left time: 28.5554s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.6066 --> 0.5988).  Saving model state dict ...
Epoch: 2 cost time: 4.893677473068237
Epoch: 2, Steps: 979 | Train Loss: 0.9304017 Vali Loss: 0.5987726 Best vali loss: 0.5987726
	iters: 100, epoch: 3 | loss: 0.2479328
	speed: 0.0153s/iter; left time: 88.3968s
	iters: 200, epoch: 3 | loss: 1.2457858
	speed: 0.0051s/iter; left time: 28.9235s
	iters: 300, epoch: 3 | loss: 1.1723920
	speed: 0.0050s/iter; left time: 27.8172s
	iters: 400, epoch: 3 | loss: 0.4425430
	speed: 0.0049s/iter; left time: 27.0434s
	iters: 500, epoch: 3 | loss: 0.9554387
	speed: 0.0050s/iter; left time: 26.7526s
	iters: 600, epoch: 3 | loss: 1.2925987
	speed: 0.0050s/iter; left time: 26.3137s
	iters: 700, epoch: 3 | loss: 0.6577125
	speed: 0.0049s/iter; left time: 25.5081s
	iters: 800, epoch: 3 | loss: 0.7982015
	speed: 0.0050s/iter; left time: 25.3918s
	iters: 900, epoch: 3 | loss: 0.5916257
	speed: 0.0050s/iter; left time: 25.0437s
Updating learning rate to 0.0004164486617318853
Validation loss decreased (0.5988 --> 0.5796).  Saving model state dict ...
Epoch: 3 cost time: 4.924410343170166
Epoch: 3, Steps: 979 | Train Loss: 0.8226923 Vali Loss: 0.5796386 Best vali loss: 0.5796386

best validation loss 0.5796385643963238

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010423606993, 'e_layers': 2, 'learning_rate': 0.0002975184157, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744008
	speed: 0.0116s/iter; left time: 10.2537s
Updating learning rate to 0.00028619479525520737
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.011448621749878
Epoch: 1, Steps: 123 | Train Loss: 0.7744008 Vali Loss: 0.6173323 Best vali loss: 0.6173323
	iters: 100, epoch: 2 | loss: 0.9501677
	speed: 0.0091s/iter; left time: 6.9629s
Updating learning rate to 0.0002539478524846741
Validation loss decreased (0.6173 --> 0.5568).  Saving model state dict ...
Epoch: 2 cost time: 0.7190096378326416
Epoch: 2, Steps: 123 | Train Loss: 0.9501677 Vali Loss: 0.5567995 Best vali loss: 0.5567995
	iters: 100, epoch: 3 | loss: 0.8396186
	speed: 0.0094s/iter; left time: 5.9784s
Updating learning rate to 0.00020568689210594983
Validation loss decreased (0.5568 --> 0.5435).  Saving model state dict ...
Epoch: 3 cost time: 0.7207584381103516
Epoch: 3, Steps: 123 | Train Loss: 0.8396186 Vali Loss: 0.5435324 Best vali loss: 0.5435324

best validation loss 0.543532394579526

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010143802384, 'e_layers': 2, 'learning_rate': 0.0002969366468, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0689946
	speed: 0.0104s/iter; left time: 9.2032s
Updating learning rate to 0.0002856351686155265
Validation loss decreased (inf --> 0.6491).  Saving model state dict ...
Epoch: 1 cost time: 0.8783550262451172
Epoch: 1, Steps: 123 | Train Loss: 1.0689946 Vali Loss: 0.6491239 Best vali loss: 0.6491239
	iters: 100, epoch: 2 | loss: 0.8245571
	speed: 0.0078s/iter; left time: 5.9528s
Updating learning rate to 0.00025345128166753735
Validation loss decreased (0.6491 --> 0.6227).  Saving model state dict ...
Epoch: 2 cost time: 0.6281833648681641
Epoch: 2, Steps: 123 | Train Loss: 0.8245571 Vali Loss: 0.6226877 Best vali loss: 0.6226877
	iters: 100, epoch: 3 | loss: 0.9388508
	speed: 0.0079s/iter; left time: 5.0163s
Updating learning rate to 0.00020528469099620217
Validation loss decreased (0.6227 --> 0.6156).  Saving model state dict ...
Epoch: 3 cost time: 0.6036593914031982
Epoch: 3, Steps: 123 | Train Loss: 0.9388508 Vali Loss: 0.6155854 Best vali loss: 0.6155854

best validation loss 0.6155853703142261

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010423606993, 'e_layers': 2, 'learning_rate': 0.0002975184157, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5879593
	speed: 0.0119s/iter; left time: 6.1628s
Updating learning rate to 0.00014875920785
Validation loss decreased (0.5435 --> 0.5299).  Saving model state dict ...
Epoch: 4 cost time: 1.028315544128418
Epoch: 4, Steps: 123 | Train Loss: 0.5879593 Vali Loss: 0.5299152 Best vali loss: 0.5299152
	iters: 100, epoch: 5 | loss: 0.8214910
	speed: 0.0092s/iter; left time: 3.6350s
Updating learning rate to 9.18315235940502e-05
Epoch: 5 cost time: 0.715308666229248
Epoch: 5, Steps: 123 | Train Loss: 0.8214910 Vali Loss: 0.5307189 Best vali loss: 0.5299152
	iters: 100, epoch: 6 | loss: 0.7590648
	speed: 0.0090s/iter; left time: 2.4310s
Updating learning rate to 4.357056321532592e-05
Epoch: 6 cost time: 0.7183742523193359
Epoch: 6, Steps: 123 | Train Loss: 0.7590648 Vali Loss: 0.5355187 Best vali loss: 0.5299152
	iters: 100, epoch: 7 | loss: 0.4349363
	speed: 0.0089s/iter; left time: 1.3147s
Updating learning rate to 1.1323620444792665e-05
Epoch: 7 cost time: 0.7173101902008057
Epoch: 7, Steps: 123 | Train Loss: 0.4349363 Vali Loss: 0.5422843 Best vali loss: 0.5299152
	iters: 100, epoch: 8 | loss: 0.5054367
	speed: 0.0089s/iter; left time: 0.2133s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7103595733642578
Epoch: 8, Steps: 123 | Train Loss: 0.5054367 Vali Loss: 0.5398801 Best vali loss: 0.5299152

best validation loss 0.529915207185882

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010444015985, 'e_layers': 2, 'learning_rate': 0.0003624826547, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7751577
	speed: 0.0115s/iter; left time: 10.1701s
Updating learning rate to 0.0003486864801338431
Validation loss decreased (inf --> 0.6181).  Saving model state dict ...
Epoch: 1 cost time: 1.0122654438018799
Epoch: 1, Steps: 123 | Train Loss: 0.7751577 Vali Loss: 0.6181370 Best vali loss: 0.6181370
	iters: 100, epoch: 2 | loss: 0.9354378
	speed: 0.0091s/iter; left time: 6.8992s
Updating learning rate to 0.00030939829895043587
Validation loss decreased (0.6181 --> 0.5657).  Saving model state dict ...
Epoch: 2 cost time: 0.7143146991729736
Epoch: 2, Steps: 123 | Train Loss: 0.9354378 Vali Loss: 0.5656851 Best vali loss: 0.5656851
	iters: 100, epoch: 3 | loss: 0.8381919
	speed: 0.0093s/iter; left time: 5.9305s
Updating learning rate to 0.00025059938058670284
Validation loss decreased (0.5657 --> 0.5431).  Saving model state dict ...
Epoch: 3 cost time: 0.7122900485992432
Epoch: 3, Steps: 123 | Train Loss: 0.8381919 Vali Loss: 0.5431282 Best vali loss: 0.5431282
	iters: 100, epoch: 4 | loss: 0.4940859
	speed: 0.0092s/iter; left time: 4.7258s
Updating learning rate to 0.00018124132735
Validation loss decreased (0.5431 --> 0.5409).  Saving model state dict ...
Epoch: 4 cost time: 0.7151687145233154
Epoch: 4, Steps: 123 | Train Loss: 0.4940859 Vali Loss: 0.5408890 Best vali loss: 0.5408890
	iters: 100, epoch: 5 | loss: 0.5489059
	speed: 0.0091s/iter; left time: 3.5644s
Updating learning rate to 0.00011188327411329719
Validation loss decreased (0.5409 --> 0.5397).  Saving model state dict ...
Epoch: 5 cost time: 0.7092685699462891
Epoch: 5, Steps: 123 | Train Loss: 0.5489059 Vali Loss: 0.5396925 Best vali loss: 0.5396925
	iters: 100, epoch: 6 | loss: 0.5765348
	speed: 0.0093s/iter; left time: 2.5116s
Updating learning rate to 5.3084355749564134e-05
Epoch: 6 cost time: 0.7139780521392822
Epoch: 6, Steps: 123 | Train Loss: 0.5765348 Vali Loss: 0.5559030 Best vali loss: 0.5396925
	iters: 100, epoch: 7 | loss: 0.5122181
	speed: 0.0088s/iter; left time: 1.2929s
Updating learning rate to 1.3796174566156912e-05
Epoch: 7 cost time: 0.705040454864502
Epoch: 7, Steps: 123 | Train Loss: 0.5122181 Vali Loss: 0.5602507 Best vali loss: 0.5396925
	iters: 100, epoch: 8 | loss: 0.6768759
	speed: 0.0089s/iter; left time: 0.2128s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7146303653717041
Epoch: 8, Steps: 123 | Train Loss: 0.6768759 Vali Loss: 0.5656214 Best vali loss: 0.5396925

best validation loss 0.5396924706478463

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010107146625, 'e_layers': 2, 'learning_rate': 0.0002974334673, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8426892
	speed: 0.0108s/iter; left time: 9.5662s
Updating learning rate to 0.00028611308001116756
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9152731895446777
Epoch: 1, Steps: 123 | Train Loss: 0.8426892 Vali Loss: 0.5942964 Best vali loss: 0.5942964
	iters: 100, epoch: 2 | loss: 0.7314903
	speed: 0.0079s/iter; left time: 6.0300s
Updating learning rate to 0.0002538753444898286
Validation loss decreased (0.5943 --> 0.5762).  Saving model state dict ...
Epoch: 2 cost time: 0.6199345588684082
Epoch: 2, Steps: 123 | Train Loss: 0.7314903 Vali Loss: 0.5762292 Best vali loss: 0.5762292
	iters: 100, epoch: 3 | loss: 0.6692700
	speed: 0.0079s/iter; left time: 5.0686s
Updating learning rate to 0.00020562816373330688
Validation loss decreased (0.5762 --> 0.5660).  Saving model state dict ...
Epoch: 3 cost time: 0.625335693359375
Epoch: 3, Steps: 123 | Train Loss: 0.6692700 Vali Loss: 0.5659731 Best vali loss: 0.5659731
	iters: 100, epoch: 4 | loss: 0.6734681
	speed: 0.0076s/iter; left time: 3.9449s
Updating learning rate to 0.00014871673365
Validation loss decreased (0.5660 --> 0.5608).  Saving model state dict ...
Epoch: 4 cost time: 0.595909595489502
Epoch: 4, Steps: 123 | Train Loss: 0.6734681 Vali Loss: 0.5607619 Best vali loss: 0.5607619
	iters: 100, epoch: 5 | loss: 0.4774473
	speed: 0.0080s/iter; left time: 3.1253s
Updating learning rate to 9.180530356669316e-05
Validation loss decreased (0.5608 --> 0.5535).  Saving model state dict ...
Epoch: 5 cost time: 0.611370325088501
Epoch: 5, Steps: 123 | Train Loss: 0.4774473 Vali Loss: 0.5534894 Best vali loss: 0.5534894
	iters: 100, epoch: 6 | loss: 0.7692423
	speed: 0.0076s/iter; left time: 2.0493s
Updating learning rate to 4.3558122810171394e-05
Epoch: 6 cost time: 0.5876858234405518
Epoch: 6, Steps: 123 | Train Loss: 0.7692423 Vali Loss: 0.5535441 Best vali loss: 0.5534894
	iters: 100, epoch: 7 | loss: 0.6018603
	speed: 0.0079s/iter; left time: 1.1624s
Updating learning rate to 1.1320387288832455e-05
Validation loss decreased (0.5535 --> 0.5497).  Saving model state dict ...
Epoch: 7 cost time: 0.6204972267150879
Epoch: 7, Steps: 123 | Train Loss: 0.6018603 Vali Loss: 0.5496752 Best vali loss: 0.5496752
	iters: 100, epoch: 8 | loss: 0.8520802
	speed: 0.0079s/iter; left time: 0.1899s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6193234920501709
Epoch: 8, Steps: 123 | Train Loss: 0.8520802 Vali Loss: 0.5497713 Best vali loss: 0.5496752

best validation loss 0.5496751700546497

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010436244709, 'e_layers': 3, 'learning_rate': 0.0002978484029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5579387
	speed: 0.0105s/iter; left time: 40.1421s
	iters: 200, epoch: 1 | loss: 0.7280256
	speed: 0.0047s/iter; left time: 17.3354s
	iters: 300, epoch: 1 | loss: 0.8450172
	speed: 0.0047s/iter; left time: 16.9442s
	iters: 400, epoch: 1 | loss: 0.6905920
	speed: 0.0046s/iter; left time: 16.3294s
Updating learning rate to 0.0002865122230652427
Validation loss decreased (inf --> 0.6130).  Saving model state dict ...
Epoch: 1 cost time: 2.600630283355713
Epoch: 1, Steps: 490 | Train Loss: 0.7053934 Vali Loss: 0.6129795 Best vali loss: 0.6129795
	iters: 100, epoch: 2 | loss: 0.9064271
	speed: 0.0130s/iter; left time: 43.3207s
	iters: 200, epoch: 2 | loss: 0.3607047
	speed: 0.0046s/iter; left time: 14.7230s
	iters: 300, epoch: 2 | loss: 0.4909183
	speed: 0.0044s/iter; left time: 13.9303s
	iters: 400, epoch: 2 | loss: 1.0467002
	speed: 0.0043s/iter; left time: 13.0384s
Updating learning rate to 0.00025422951417808647
Epoch: 2 cost time: 2.215085029602051
Epoch: 2, Steps: 490 | Train Loss: 0.7011876 Vali Loss: 0.6191768 Best vali loss: 0.6129795
	iters: 100, epoch: 3 | loss: 0.3606031
	speed: 0.0122s/iter; left time: 34.7554s
	iters: 200, epoch: 3 | loss: 1.0629772
	speed: 0.0045s/iter; left time: 12.4371s
	iters: 300, epoch: 3 | loss: 0.6380812
	speed: 0.0045s/iter; left time: 11.8729s
	iters: 400, epoch: 3 | loss: 0.8001258
	speed: 0.0046s/iter; left time: 11.6746s
Updating learning rate to 0.0002059150260231161
Validation loss decreased (0.6130 --> 0.6122).  Saving model state dict ...
Epoch: 3 cost time: 2.2810497283935547
Epoch: 3, Steps: 490 | Train Loss: 0.7154468 Vali Loss: 0.6121666 Best vali loss: 0.6121666

best validation loss 0.612166620442736

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6191300
	speed: 0.0138s/iter; left time: 12.1769s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 1.2868554592132568
Epoch: 1, Steps: 123 | Train Loss: 0.6191300 Vali Loss: 0.6116755 Best vali loss: 0.6116755
	iters: 100, epoch: 2 | loss: 0.7540644
	speed: 0.0121s/iter; left time: 9.2580s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.6117 --> 0.5987).  Saving model state dict ...
Epoch: 2 cost time: 0.9906735420227051
Epoch: 2, Steps: 123 | Train Loss: 0.7540644 Vali Loss: 0.5986742 Best vali loss: 0.5986742
	iters: 100, epoch: 3 | loss: 0.6285874
	speed: 0.0124s/iter; left time: 7.9537s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.5987 --> 0.5536).  Saving model state dict ...
Epoch: 3 cost time: 0.990576982498169
Epoch: 3, Steps: 123 | Train Loss: 0.6285874 Vali Loss: 0.5535586 Best vali loss: 0.5535586

best validation loss 0.5535586363515717

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010431450913, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7036931
	speed: 0.0115s/iter; left time: 10.2004s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 1.0114917755126953
Epoch: 1, Steps: 123 | Train Loss: 0.7036931 Vali Loss: 0.6103376 Best vali loss: 0.6103376
	iters: 100, epoch: 2 | loss: 0.8185957
	speed: 0.0087s/iter; left time: 6.6497s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6103 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 0.6992034912109375
Epoch: 2, Steps: 123 | Train Loss: 0.8185957 Vali Loss: 0.6069363 Best vali loss: 0.6069363
	iters: 100, epoch: 3 | loss: 0.8318475
	speed: 0.0087s/iter; left time: 5.5335s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6069 --> 0.5886).  Saving model state dict ...
Epoch: 3 cost time: 0.7056164741516113
Epoch: 3, Steps: 123 | Train Loss: 0.8318475 Vali Loss: 0.5886124 Best vali loss: 0.5886124

best validation loss 0.5886124333315897

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5444032
	speed: 0.0141s/iter; left time: 7.2894s
Updating learning rate to 3.7229189375e-05
Validation loss decreased (0.5536 --> 0.5478).  Saving model state dict ...
Epoch: 4 cost time: 1.2931368350982666
Epoch: 4, Steps: 123 | Train Loss: 0.5444032 Vali Loss: 0.5478009 Best vali loss: 0.5478009
	iters: 100, epoch: 5 | loss: 0.6519296
	speed: 0.0123s/iter; left time: 4.8351s
Updating learning rate to 1.86145946875e-05
Validation loss decreased (0.5478 --> 0.5349).  Saving model state dict ...
Epoch: 5 cost time: 0.9967985153198242
Epoch: 5, Steps: 123 | Train Loss: 0.6519296 Vali Loss: 0.5348626 Best vali loss: 0.5348626
	iters: 100, epoch: 6 | loss: 0.5864070
	speed: 0.0123s/iter; left time: 3.3241s
Updating learning rate to 9.30729734375e-06
Validation loss decreased (0.5349 --> 0.5324).  Saving model state dict ...
Epoch: 6 cost time: 0.9907197952270508
Epoch: 6, Steps: 123 | Train Loss: 0.5864070 Vali Loss: 0.5324446 Best vali loss: 0.5324446
	iters: 100, epoch: 7 | loss: 0.8410720
	speed: 0.0125s/iter; left time: 1.8362s
Updating learning rate to 4.653648671875e-06
Epoch: 7 cost time: 1.0032427310943604
Epoch: 7, Steps: 123 | Train Loss: 0.8410720 Vali Loss: 0.5355268 Best vali loss: 0.5324446
	iters: 100, epoch: 8 | loss: 0.6782750
	speed: 0.0120s/iter; left time: 0.2870s
Updating learning rate to 2.3268243359375e-06
Epoch: 8 cost time: 0.9924209117889404
Epoch: 8, Steps: 123 | Train Loss: 0.6782750 Vali Loss: 0.5363918 Best vali loss: 0.5324446

best validation loss 0.5324445751076328

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010423606993, 'e_layers': 3, 'learning_rate': 0.000297787465, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7036951
	speed: 0.0117s/iter; left time: 10.3280s
Updating learning rate to 0.0002864536044759606
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 1.0284805297851562
Epoch: 1, Steps: 123 | Train Loss: 0.7036951 Vali Loss: 0.6103379 Best vali loss: 0.6103379
	iters: 100, epoch: 2 | loss: 0.8185939
	speed: 0.0083s/iter; left time: 6.3150s
Updating learning rate to 0.0002541775004269258
Validation loss decreased (0.6103 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 0.651146650314331
Epoch: 2, Steps: 123 | Train Loss: 0.8185939 Vali Loss: 0.6069435 Best vali loss: 0.6069435
	iters: 100, epoch: 3 | loss: 0.8314787
	speed: 0.0081s/iter; left time: 5.1802s
Updating learning rate to 0.00020587289711074955
Validation loss decreased (0.6069 --> 0.5875).  Saving model state dict ...
Epoch: 3 cost time: 0.6507587432861328
Epoch: 3, Steps: 123 | Train Loss: 0.8314787 Vali Loss: 0.5874866 Best vali loss: 0.5874866
	iters: 100, epoch: 4 | loss: 0.6362320
	speed: 0.0080s/iter; left time: 4.1087s
Updating learning rate to 0.0001488937325
Validation loss decreased (0.5875 --> 0.5725).  Saving model state dict ...
Epoch: 4 cost time: 0.6329696178436279
Epoch: 4, Steps: 123 | Train Loss: 0.6362320 Vali Loss: 0.5725258 Best vali loss: 0.5725258
	iters: 100, epoch: 5 | loss: 0.7949104
	speed: 0.0085s/iter; left time: 3.3313s
Updating learning rate to 9.191456788925049e-05
Epoch: 5 cost time: 0.7087783813476562
Epoch: 5, Steps: 123 | Train Loss: 0.7949104 Vali Loss: 0.5740934 Best vali loss: 0.5725258
	iters: 100, epoch: 6 | loss: 0.6023498
	speed: 0.0083s/iter; left time: 2.2529s
Updating learning rate to 4.360996457307417e-05
Validation loss decreased (0.5725 --> 0.5600).  Saving model state dict ...
Epoch: 6 cost time: 0.6415047645568848
Epoch: 6, Steps: 123 | Train Loss: 0.6023498 Vali Loss: 0.5600314 Best vali loss: 0.5600314
	iters: 100, epoch: 7 | loss: 0.8435018
	speed: 0.0081s/iter; left time: 1.1955s
Updating learning rate to 1.133386052403942e-05
Validation loss decreased (0.5600 --> 0.5584).  Saving model state dict ...
Epoch: 7 cost time: 0.6507265567779541
Epoch: 7, Steps: 123 | Train Loss: 0.8435018 Vali Loss: 0.5583905 Best vali loss: 0.5583905
	iters: 100, epoch: 8 | loss: 0.5433114
	speed: 0.0087s/iter; left time: 0.2076s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7379817962646484
Epoch: 8, Steps: 123 | Train Loss: 0.5433114 Vali Loss: 0.5603359 Best vali loss: 0.5583905

best validation loss 0.558390484508239

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 0.7976131439208984
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6050603 Best vali loss: 0.6050603
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.5149083137512207
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6211952 Best vali loss: 0.6050603
Updating learning rate to 0.0008072813968307993
Validation loss decreased (0.6051 --> 0.6050).  Saving model state dict ...
Epoch: 3 cost time: 0.4916956424713135
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6049728 Best vali loss: 0.6049728
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 0.5063996315002441
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6122909 Best vali loss: 0.6049728
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.47861647605895996
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6083465 Best vali loss: 0.6049728
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.5134851932525635
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6092801 Best vali loss: 0.6049728
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.5024423599243164
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6265578 Best vali loss: 0.6049728
Updating learning rate to 0.0
Epoch: 8 cost time: 0.511486291885376
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6233591 Best vali loss: 0.6049728

best validation loss 0.6049728142558728

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010436651223, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7036917
	speed: 0.0116s/iter; left time: 10.2273s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 1.0140981674194336
Epoch: 1, Steps: 123 | Train Loss: 0.7036917 Vali Loss: 0.6103367 Best vali loss: 0.6103367
	iters: 100, epoch: 2 | loss: 0.8185942
	speed: 0.0085s/iter; left time: 6.4410s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6103 --> 0.6069).  Saving model state dict ...
Epoch: 2 cost time: 0.6782360076904297
Epoch: 2, Steps: 123 | Train Loss: 0.8185942 Vali Loss: 0.6069218 Best vali loss: 0.6069218
	iters: 100, epoch: 3 | loss: 0.8310251
	speed: 0.0086s/iter; left time: 5.4707s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6069 --> 0.5880).  Saving model state dict ...
Epoch: 3 cost time: 0.6770341396331787
Epoch: 3, Steps: 123 | Train Loss: 0.8310251 Vali Loss: 0.5879792 Best vali loss: 0.5879792

best validation loss 0.5879792291938238

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010144921995, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8824857
	speed: 0.0101s/iter; left time: 18.8399s
	iters: 200, epoch: 1 | loss: 0.6444409
	speed: 0.0042s/iter; left time: 7.3223s
Updating learning rate to 0.0002978326994
Validation loss decreased (inf --> 0.6021).  Saving model state dict ...
Epoch: 1 cost time: 1.360743522644043
Epoch: 1, Steps: 245 | Train Loss: 0.7634633 Vali Loss: 0.6020616 Best vali loss: 0.6020616
	iters: 100, epoch: 2 | loss: 0.7636315
	speed: 0.0088s/iter; left time: 14.1555s
	iters: 200, epoch: 2 | loss: 0.9444417
	speed: 0.0041s/iter; left time: 6.1574s
Updating learning rate to 0.0001489163497
Epoch: 2 cost time: 1.040968418121338
Epoch: 2, Steps: 245 | Train Loss: 0.8540366 Vali Loss: 0.6195766 Best vali loss: 0.6020616
	iters: 100, epoch: 3 | loss: 0.7761865
	speed: 0.0086s/iter; left time: 11.8002s
	iters: 200, epoch: 3 | loss: 0.9152637
	speed: 0.0040s/iter; left time: 5.0647s
Updating learning rate to 7.445817485e-05
Validation loss decreased (0.6021 --> 0.5892).  Saving model state dict ...
Epoch: 3 cost time: 1.024742841720581
Epoch: 3, Steps: 245 | Train Loss: 0.8457251 Vali Loss: 0.5892289 Best vali loss: 0.5892289

best validation loss 0.5892288757799291

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010419563997, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8825325
	speed: 0.0103s/iter; left time: 19.1051s
	iters: 200, epoch: 1 | loss: 0.6448537
	speed: 0.0043s/iter; left time: 7.4881s
Updating learning rate to 0.0002856364909941232
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 1.3810501098632812
Epoch: 1, Steps: 245 | Train Loss: 0.7636931 Vali Loss: 0.6020403 Best vali loss: 0.6020403
	iters: 100, epoch: 2 | loss: 0.7669395
	speed: 0.0089s/iter; left time: 14.3146s
	iters: 200, epoch: 2 | loss: 0.9064755
	speed: 0.0040s/iter; left time: 6.0993s
Updating learning rate to 0.0002534524550473834
Epoch: 2 cost time: 1.037214756011963
Epoch: 2, Steps: 245 | Train Loss: 0.8367075 Vali Loss: 0.6178580 Best vali loss: 0.6020403
	iters: 100, epoch: 3 | loss: 0.8027211
	speed: 0.0085s/iter; left time: 11.6414s
	iters: 200, epoch: 3 | loss: 0.9086182
	speed: 0.0039s/iter; left time: 5.0071s
Updating learning rate to 0.0002052856413836594
Epoch: 3 cost time: 1.0179553031921387
Epoch: 3, Steps: 245 | Train Loss: 0.8556696 Vali Loss: 0.6037675 Best vali loss: 0.6020403

best validation loss 0.6020402596373075

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010436651223, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6034113
	speed: 0.0112s/iter; left time: 5.7661s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5880 --> 0.5640).  Saving model state dict ...
Epoch: 4 cost time: 0.9678101539611816
Epoch: 4, Steps: 123 | Train Loss: 0.6034113 Vali Loss: 0.5639579 Best vali loss: 0.5639579
	iters: 100, epoch: 5 | loss: 0.6730425
	speed: 0.0085s/iter; left time: 3.3434s
Updating learning rate to 9.192878160322029e-05
Epoch: 5 cost time: 0.6866264343261719
Epoch: 5, Steps: 123 | Train Loss: 0.6730425 Vali Loss: 0.5709364 Best vali loss: 0.5639579
	iters: 100, epoch: 6 | loss: 0.8021671
	speed: 0.0082s/iter; left time: 2.2022s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.6477830410003662
Epoch: 6, Steps: 123 | Train Loss: 0.8021671 Vali Loss: 0.5689920 Best vali loss: 0.5639579
	iters: 100, epoch: 7 | loss: 0.6209215
	speed: 0.0089s/iter; left time: 1.3057s
Updating learning rate to 1.1335613197803346e-05
Validation loss decreased (0.5640 --> 0.5607).  Saving model state dict ...
Epoch: 7 cost time: 0.7378895282745361
Epoch: 7, Steps: 123 | Train Loss: 0.6209215 Vali Loss: 0.5606508 Best vali loss: 0.5606508
	iters: 100, epoch: 8 | loss: 0.7642877
	speed: 0.0089s/iter; left time: 0.2128s
Updating learning rate to 0.0
Validation loss decreased (0.5607 --> 0.5586).  Saving model state dict ...
Epoch: 8 cost time: 0.6840577125549316
Epoch: 8, Steps: 123 | Train Loss: 0.7642877 Vali Loss: 0.5585771 Best vali loss: 0.5585771

best validation loss 0.5585770921429127

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0437458
	speed: 0.0127s/iter; left time: 11.2047s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.5863).  Saving model state dict ...
Epoch: 1 cost time: 1.1230335235595703
Epoch: 1, Steps: 123 | Train Loss: 1.0437458 Vali Loss: 0.5862605 Best vali loss: 0.5862605
	iters: 100, epoch: 2 | loss: 0.7110209
	speed: 0.0097s/iter; left time: 7.3817s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.5863 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 0.7909960746765137
Epoch: 2, Steps: 123 | Train Loss: 0.7110209 Vali Loss: 0.5611274 Best vali loss: 0.5611274
	iters: 100, epoch: 3 | loss: 0.8771235
	speed: 0.0094s/iter; left time: 6.0346s
Updating learning rate to 0.000178512795825
Validation loss decreased (0.5611 --> 0.5591).  Saving model state dict ...
Epoch: 3 cost time: 0.7704145908355713
Epoch: 3, Steps: 123 | Train Loss: 0.8771235 Vali Loss: 0.5590721 Best vali loss: 0.5590721
	iters: 100, epoch: 4 | loss: 0.7080939
	speed: 0.0095s/iter; left time: 4.9238s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 0.7811110019683838
Epoch: 4, Steps: 123 | Train Loss: 0.7080939 Vali Loss: 0.5596363 Best vali loss: 0.5590721
	iters: 100, epoch: 5 | loss: 0.8091006
	speed: 0.0097s/iter; left time: 3.8101s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 0.8121469020843506
Epoch: 5, Steps: 123 | Train Loss: 0.8091006 Vali Loss: 0.5595547 Best vali loss: 0.5590721
	iters: 100, epoch: 6 | loss: 0.7275994
	speed: 0.0096s/iter; left time: 2.5913s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 0.7832655906677246
Epoch: 6, Steps: 123 | Train Loss: 0.7275994 Vali Loss: 0.5594869 Best vali loss: 0.5590721
	iters: 100, epoch: 7 | loss: 0.6018368
	speed: 0.0102s/iter; left time: 1.5037s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 0.8626365661621094
Epoch: 7, Steps: 123 | Train Loss: 0.6018368 Vali Loss: 0.5600702 Best vali loss: 0.5590721
	iters: 100, epoch: 8 | loss: 0.6674206
	speed: 0.0096s/iter; left time: 0.2313s
Updating learning rate to 5.57852486953125e-06
Validation loss decreased (0.5591 --> 0.5586).  Saving model state dict ...
Epoch: 8 cost time: 0.7853868007659912
Epoch: 8, Steps: 123 | Train Loss: 0.6674206 Vali Loss: 0.5586327 Best vali loss: 0.5586327

best validation loss 0.5586326635584463

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442663497, 'e_layers': 2, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7746023
	speed: 0.0117s/iter; left time: 10.3893s
Updating learning rate to 0.00028656042375066227
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.020402193069458
Epoch: 1, Steps: 123 | Train Loss: 0.7746023 Vali Loss: 0.6171538 Best vali loss: 0.6171538
	iters: 100, epoch: 2 | loss: 0.9519194
	speed: 0.0092s/iter; left time: 6.9817s
Updating learning rate to 0.0002542722838606716
Validation loss decreased (0.6172 --> 0.6015).  Saving model state dict ...
Epoch: 2 cost time: 0.7200706005096436
Epoch: 2, Steps: 123 | Train Loss: 0.9519194 Vali Loss: 0.6015197 Best vali loss: 0.6015197
	iters: 100, epoch: 3 | loss: 0.8426580
	speed: 0.0094s/iter; left time: 6.0283s
Updating learning rate to 0.0002059496676355622
Validation loss decreased (0.6015 --> 0.5459).  Saving model state dict ...
Epoch: 3 cost time: 0.7147436141967773
Epoch: 3, Steps: 123 | Train Loss: 0.8426580 Vali Loss: 0.5458681 Best vali loss: 0.5458681
	iters: 100, epoch: 4 | loss: 0.4988884
	speed: 0.0093s/iter; left time: 4.7982s
Updating learning rate to 0.00014894925535
Validation loss decreased (0.5459 --> 0.5339).  Saving model state dict ...
Epoch: 4 cost time: 0.7164640426635742
Epoch: 4, Steps: 123 | Train Loss: 0.4988884 Vali Loss: 0.5338572 Best vali loss: 0.5338572
	iters: 100, epoch: 5 | loss: 0.5576628
	speed: 0.0093s/iter; left time: 3.6457s
Updating learning rate to 9.19488430644378e-05
Validation loss decreased (0.5339 --> 0.5253).  Saving model state dict ...
Epoch: 5 cost time: 0.7138657569885254
Epoch: 5, Steps: 123 | Train Loss: 0.5576628 Vali Loss: 0.5253398 Best vali loss: 0.5253398
	iters: 100, epoch: 6 | loss: 0.5883400
	speed: 0.0091s/iter; left time: 2.4613s
Updating learning rate to 4.362622683932836e-05
Epoch: 6 cost time: 0.7115719318389893
Epoch: 6, Steps: 123 | Train Loss: 0.5883400 Vali Loss: 0.5420120 Best vali loss: 0.5253398
	iters: 100, epoch: 7 | loss: 0.5356608
	speed: 0.0089s/iter; left time: 1.3151s
Updating learning rate to 1.1338086949337725e-05
Epoch: 7 cost time: 0.7183692455291748
Epoch: 7, Steps: 123 | Train Loss: 0.5356608 Vali Loss: 0.5366757 Best vali loss: 0.5253398
	iters: 100, epoch: 8 | loss: 0.6907849
	speed: 0.0092s/iter; left time: 0.2214s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7177865505218506
Epoch: 8, Steps: 123 | Train Loss: 0.6907849 Vali Loss: 0.5434580 Best vali loss: 0.5253398

best validation loss 0.5253397927467385

[INFO][abstract_intensifier.py:595] Added config c1c3e7 and rejected config c87f5c as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010146262811, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8666613101959229
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020253 Best vali loss: 0.6020253
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6020 --> 0.5664).  Saving model state dict ...
Epoch: 2 cost time: 0.5718042850494385
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5663638 Best vali loss: 0.5663638
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5664 --> 0.5506).  Saving model state dict ...
Epoch: 3 cost time: 0.568917989730835
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5506049 Best vali loss: 0.5506049

best validation loss 0.5506049341098516

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010148482563, 'e_layers': 2, 'learning_rate': 0.0002988613407, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9049953
	speed: 0.0118s/iter; left time: 10.4611s
Updating learning rate to 0.00028748660821580616
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 1.0422985553741455
Epoch: 1, Steps: 123 | Train Loss: 0.9049953 Vali Loss: 0.6031592 Best vali loss: 0.6031592
	iters: 100, epoch: 2 | loss: 0.8233895
	speed: 0.0093s/iter; left time: 7.1163s
Updating learning rate to 0.00025509411067173657
Validation loss decreased (0.6032 --> 0.5996).  Saving model state dict ...
Epoch: 2 cost time: 0.7275581359863281
Epoch: 2, Steps: 123 | Train Loss: 0.8233895 Vali Loss: 0.5996157 Best vali loss: 0.5996157
	iters: 100, epoch: 3 | loss: 0.6518619
	speed: 0.0094s/iter; left time: 5.9938s
Updating learning rate to 0.00020661531218015426
Epoch: 3 cost time: 0.7346506118774414
Epoch: 3, Steps: 123 | Train Loss: 0.6518619 Vali Loss: 0.6447315 Best vali loss: 0.5996157

best validation loss 0.599615744339653

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010145513934, 'e_layers': 2, 'learning_rate': 0.0002969380215, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002856364909941232
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8764445781707764
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020144 Best vali loss: 0.6020144
Updating learning rate to 0.0002534524550473834
Validation loss decreased (0.6020 --> 0.5721).  Saving model state dict ...
Epoch: 2 cost time: 0.5713615417480469
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5721446 Best vali loss: 0.5721446
Updating learning rate to 0.0002052856413836594
Validation loss decreased (0.5721 --> 0.5608).  Saving model state dict ...
Epoch: 3 cost time: 0.5649862289428711
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5608322 Best vali loss: 0.5608322

best validation loss 0.5608322317817597

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010146262811, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 0.8654885292053223
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5618803 Best vali loss: 0.5506049
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5506 --> 0.5395).  Saving model state dict ...
Epoch: 5 cost time: 0.5685410499572754
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5395469 Best vali loss: 0.5395469
Updating learning rate to 4.361658899758271e-05
Validation loss decreased (0.5395 --> 0.5366).  Saving model state dict ...
Epoch: 6 cost time: 0.5699014663696289
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5365763 Best vali loss: 0.5365763
Updating learning rate to 1.1335582155876705e-05
Validation loss decreased (0.5366 --> 0.5357).  Saving model state dict ...
Epoch: 7 cost time: 0.5645780563354492
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5357276 Best vali loss: 0.5357276
Updating learning rate to 0.0
Validation loss decreased (0.5357 --> 0.5344).  Saving model state dict ...
Epoch: 8 cost time: 0.5708584785461426
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5344304 Best vali loss: 0.5344304

best validation loss 0.5344304140107271

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010148154839, 'e_layers': 3, 'learning_rate': 0.0002984874242, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6513201
	speed: 0.0141s/iter; left time: 12.4491s
Updating learning rate to 0.00028712692306519705
Validation loss decreased (inf --> 0.6220).  Saving model state dict ...
Epoch: 1 cost time: 1.3093039989471436
Epoch: 1, Steps: 123 | Train Loss: 0.6513201 Vali Loss: 0.6220461 Best vali loss: 0.6220461
	iters: 100, epoch: 2 | loss: 0.9133996
	speed: 0.0124s/iter; left time: 9.4583s
Updating learning rate to 0.0002547749529753628
Validation loss decreased (0.6220 --> 0.5610).  Saving model state dict ...
Epoch: 2 cost time: 1.0022268295288086
Epoch: 2, Steps: 123 | Train Loss: 0.9133996 Vali Loss: 0.5609581 Best vali loss: 0.5609581
	iters: 100, epoch: 3 | loss: 0.8894047
	speed: 0.0125s/iter; left time: 7.9842s
Updating learning rate to 0.0002063568081053353
Epoch: 3 cost time: 1.0003440380096436
Epoch: 3, Steps: 123 | Train Loss: 0.8894047 Vali Loss: 0.5617612 Best vali loss: 0.5609581
	iters: 100, epoch: 4 | loss: 0.6059583
	speed: 0.0121s/iter; left time: 6.2591s
Updating learning rate to 0.0001492437121
Validation loss decreased (0.5610 --> 0.5509).  Saving model state dict ...
Epoch: 4 cost time: 1.0075509548187256
Epoch: 4, Steps: 123 | Train Loss: 0.6059583 Vali Loss: 0.5509054 Best vali loss: 0.5509054
	iters: 100, epoch: 5 | loss: 0.7960079
	speed: 0.0125s/iter; left time: 4.9223s
Updating learning rate to 9.213061609466473e-05
Validation loss decreased (0.5509 --> 0.5468).  Saving model state dict ...
Epoch: 5 cost time: 1.0002176761627197
Epoch: 5, Steps: 123 | Train Loss: 0.7960079 Vali Loss: 0.5468144 Best vali loss: 0.5468144
	iters: 100, epoch: 6 | loss: 0.5226399
	speed: 0.0126s/iter; left time: 3.3917s
Updating learning rate to 4.3712471224637216e-05
Epoch: 6 cost time: 1.0141575336456299
Epoch: 6, Steps: 123 | Train Loss: 0.5226399 Vali Loss: 0.5650991 Best vali loss: 0.5468144
	iters: 100, epoch: 7 | loss: 0.7197977
	speed: 0.0123s/iter; left time: 1.8072s
Updating learning rate to 1.1360501134802932e-05
Epoch: 7 cost time: 1.0137603282928467
Epoch: 7, Steps: 123 | Train Loss: 0.7197977 Vali Loss: 0.5806432 Best vali loss: 0.5468144
	iters: 100, epoch: 8 | loss: 0.7035327
	speed: 0.0121s/iter; left time: 0.2911s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0057387351989746
Epoch: 8, Steps: 123 | Train Loss: 0.7035327 Vali Loss: 0.5793632 Best vali loss: 0.5468144

best validation loss 0.5468144403569735

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001016367108, 'e_layers': 2, 'learning_rate': 0.0002971688101, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00028585849572606165
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8553280830383301
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020041 Best vali loss: 0.6020041
Updating learning rate to 0.0002536494454394237
Validation loss decreased (0.6020 --> 0.5740).  Saving model state dict ...
Epoch: 2 cost time: 0.5655360221862793
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5739663 Best vali loss: 0.5739663
Updating learning rate to 0.00020544519517045877
Validation loss decreased (0.5740 --> 0.5486).  Saving model state dict ...
Epoch: 3 cost time: 0.5698730945587158
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5486489 Best vali loss: 0.5486489
Updating learning rate to 0.00014858440505
Epoch: 4 cost time: 0.5649738311767578
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5571062 Best vali loss: 0.5486489
Updating learning rate to 9.172361492954122e-05
Epoch: 5 cost time: 0.5736105442047119
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5489922 Best vali loss: 0.5486489
Updating learning rate to 4.351936466057631e-05
Validation loss decreased (0.5486 --> 0.5380).  Saving model state dict ...
Epoch: 6 cost time: 0.572770357131958
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5380201 Best vali loss: 0.5380201
Updating learning rate to 1.1310314373938326e-05
Validation loss decreased (0.5380 --> 0.5360).  Saving model state dict ...
Epoch: 7 cost time: 0.5764250755310059
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5359820 Best vali loss: 0.5359820
Updating learning rate to 0.0
Validation loss decreased (0.5360 --> 0.5327).  Saving model state dict ...
Epoch: 8 cost time: 0.5777404308319092
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5327175 Best vali loss: 0.5327175

best validation loss 0.5327174962532294

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010170375172, 'e_layers': 2, 'learning_rate': 0.0002974585787, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002861372356654139
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8650550842285156
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6019618 Best vali loss: 0.6019618
Updating learning rate to 0.0002538967784104411
Validation loss decreased (0.6020 --> 0.5848).  Saving model state dict ...
Epoch: 2 cost time: 0.571793794631958
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5847742 Best vali loss: 0.5847742
Updating learning rate to 0.00020564552429167858
Validation loss decreased (0.5848 --> 0.5699).  Saving model state dict ...
Epoch: 3 cost time: 0.5683493614196777
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5698527 Best vali loss: 0.5698527

best validation loss 0.5698526749341701

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010514701529, 'e_layers': 2, 'learning_rate': 0.0002979115343, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745212
	speed: 0.0115s/iter; left time: 10.2000s
Updating learning rate to 0.0002865729516694021
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0189025402069092
Epoch: 1, Steps: 123 | Train Loss: 0.7745212 Vali Loss: 0.6172617 Best vali loss: 0.6172617
	iters: 100, epoch: 2 | loss: 0.9507353
	speed: 0.0092s/iter; left time: 6.9984s
Updating learning rate to 0.0002542834001986094
Validation loss decreased (0.6173 --> 0.5965).  Saving model state dict ...
Epoch: 2 cost time: 0.7268152236938477
Epoch: 2, Steps: 123 | Train Loss: 0.9507353 Vali Loss: 0.5964874 Best vali loss: 0.5964874
	iters: 100, epoch: 3 | loss: 0.8451095
	speed: 0.0093s/iter; left time: 5.9686s
Updating learning rate to 0.0002059586713935371
Validation loss decreased (0.5965 --> 0.5428).  Saving model state dict ...
Epoch: 3 cost time: 0.7261562347412109
Epoch: 3, Steps: 123 | Train Loss: 0.8451095 Vali Loss: 0.5427621 Best vali loss: 0.5427621

best validation loss 0.5427620589098738

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010441802697, 'e_layers': 2, 'learning_rate': 0.0002958142804, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7742321
	speed: 0.0116s/iter; left time: 10.2456s
Updating learning rate to 0.0002845555197430574
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0254085063934326
Epoch: 1, Steps: 123 | Train Loss: 0.7742321 Vali Loss: 0.6172579 Best vali loss: 0.6172579
	iters: 100, epoch: 2 | loss: 0.9518605
	speed: 0.0093s/iter; left time: 7.1068s
Updating learning rate to 0.0002524932820213294
Validation loss decreased (0.6173 --> 0.5741).  Saving model state dict ...
Epoch: 2 cost time: 0.7274422645568848
Epoch: 2, Steps: 123 | Train Loss: 0.9518605 Vali Loss: 0.5741075 Best vali loss: 0.5741075
	iters: 100, epoch: 3 | loss: 0.8456922
	speed: 0.0095s/iter; left time: 6.0936s
Updating learning rate to 0.00020450875228304058
Validation loss decreased (0.5741 --> 0.5583).  Saving model state dict ...
Epoch: 3 cost time: 0.724890947341919
Epoch: 3, Steps: 123 | Train Loss: 0.8456922 Vali Loss: 0.5582519 Best vali loss: 0.5582519

best validation loss 0.558251899792496

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010514701529, 'e_layers': 2, 'learning_rate': 0.0002979115343, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5860361
	speed: 0.0121s/iter; left time: 6.2324s
Updating learning rate to 0.00014895576715
Validation loss decreased (0.5428 --> 0.5326).  Saving model state dict ...
Epoch: 4 cost time: 1.034480094909668
Epoch: 4, Steps: 123 | Train Loss: 0.5860361 Vali Loss: 0.5325824 Best vali loss: 0.5325824
	iters: 100, epoch: 5 | loss: 0.8207917
	speed: 0.0093s/iter; left time: 3.6665s
Updating learning rate to 9.195286290646292e-05
Epoch: 5 cost time: 0.7223348617553711
Epoch: 5, Steps: 123 | Train Loss: 0.8207917 Vali Loss: 0.5331784 Best vali loss: 0.5325824
	iters: 100, epoch: 6 | loss: 0.7574506
	speed: 0.0091s/iter; left time: 2.4521s
Updating learning rate to 4.362813410139064e-05
Validation loss decreased (0.5326 --> 0.5302).  Saving model state dict ...
Epoch: 6 cost time: 0.7211208343505859
Epoch: 6, Steps: 123 | Train Loss: 0.7574506 Vali Loss: 0.5301619 Best vali loss: 0.5301619
	iters: 100, epoch: 7 | loss: 0.4349446
	speed: 0.0094s/iter; left time: 1.3865s
Updating learning rate to 1.1338582630597919e-05
Epoch: 7 cost time: 0.7202222347259521
Epoch: 7, Steps: 123 | Train Loss: 0.4349446 Vali Loss: 0.5399403 Best vali loss: 0.5301619
	iters: 100, epoch: 8 | loss: 0.5076597
	speed: 0.0089s/iter; left time: 0.2137s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7113690376281738
Epoch: 8, Steps: 123 | Train Loss: 0.5076597 Vali Loss: 0.5409429 Best vali loss: 0.5301619

best validation loss 0.5301619437159018

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0035464357287, 'e_layers': 2, 'learning_rate': 0.0003036080774, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8133618
	speed: 0.0097s/iter; left time: 18.1397s
	iters: 200, epoch: 1 | loss: 0.7339203
	speed: 0.0035s/iter; left time: 6.1830s
Updating learning rate to 0.0002920526830074813
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 1.2138218879699707
Epoch: 1, Steps: 245 | Train Loss: 0.7736410 Vali Loss: 0.6058206 Best vali loss: 0.6058206
	iters: 100, epoch: 2 | loss: 0.8960077
	speed: 0.0073s/iter; left time: 11.8658s
	iters: 200, epoch: 2 | loss: 0.9012186
	speed: 0.0036s/iter; left time: 5.4999s
Updating learning rate to 0.0002591457038762751
Epoch: 2 cost time: 0.930537223815918
Epoch: 2, Steps: 245 | Train Loss: 0.8986132 Vali Loss: 0.6084513 Best vali loss: 0.6058206
	iters: 100, epoch: 3 | loss: 0.7752612
	speed: 0.0077s/iter; left time: 10.4884s
	iters: 200, epoch: 3 | loss: 1.1431519
	speed: 0.0035s/iter; left time: 4.4596s
Updating learning rate to 0.00020989692927659895
Epoch: 3 cost time: 0.8969082832336426
Epoch: 3, Steps: 245 | Train Loss: 0.9592066 Vali Loss: 0.6183804 Best vali loss: 0.6058206
	iters: 100, epoch: 4 | loss: 0.7807703
	speed: 0.0076s/iter; left time: 8.5902s
	iters: 200, epoch: 4 | loss: 0.6772203
	speed: 0.0037s/iter; left time: 3.8220s
Updating learning rate to 0.0001518040387
Epoch: 4 cost time: 0.9482519626617432
Epoch: 4, Steps: 245 | Train Loss: 0.7289953 Vali Loss: 0.6182124 Best vali loss: 0.6058206
	iters: 100, epoch: 5 | loss: 0.7717107
	speed: 0.0077s/iter; left time: 6.7957s
	iters: 200, epoch: 5 | loss: 0.6378943
	speed: 0.0037s/iter; left time: 2.8662s
Updating learning rate to 9.371114812340109e-05
Epoch: 5 cost time: 0.940619945526123
Epoch: 5, Steps: 245 | Train Loss: 0.7048025 Vali Loss: 0.6171999 Best vali loss: 0.6058206
	iters: 100, epoch: 6 | loss: 0.5567003
	speed: 0.0079s/iter; left time: 5.0043s
	iters: 200, epoch: 6 | loss: 0.4580900
	speed: 0.0036s/iter; left time: 1.9390s
Updating learning rate to 4.446237352372492e-05
Epoch: 6 cost time: 0.9581608772277832
Epoch: 6, Steps: 245 | Train Loss: 0.5073951 Vali Loss: 0.6274545 Best vali loss: 0.6058206
	iters: 100, epoch: 7 | loss: 0.7453965
	speed: 0.0078s/iter; left time: 3.0383s
	iters: 200, epoch: 7 | loss: 0.9105740
	speed: 0.0035s/iter; left time: 1.0276s
Updating learning rate to 1.155539439251872e-05
Epoch: 7 cost time: 0.9229865074157715
Epoch: 7, Steps: 245 | Train Loss: 0.8279853 Vali Loss: 0.6202870 Best vali loss: 0.6058206
	iters: 100, epoch: 8 | loss: 1.0402292
	speed: 0.0077s/iter; left time: 1.1314s
	iters: 200, epoch: 8 | loss: 0.7514689
	speed: 0.0035s/iter; left time: 0.1596s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.915684700012207
Epoch: 8, Steps: 245 | Train Loss: 0.8958490 Vali Loss: 0.6227154 Best vali loss: 0.6058206

best validation loss 0.6058206238000826

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010439560764, 'e_layers': 2, 'learning_rate': 0.000292722734, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7739260
	speed: 0.0119s/iter; left time: 10.5044s
Updating learning rate to 0.00028158163832167285
Validation loss decreased (inf --> 0.6170).  Saving model state dict ...
Epoch: 1 cost time: 1.0433557033538818
Epoch: 1, Steps: 123 | Train Loss: 0.7739260 Vali Loss: 0.6170074 Best vali loss: 0.6170074
	iters: 100, epoch: 2 | loss: 0.9524537
	speed: 0.0092s/iter; left time: 7.0340s
Updating learning rate to 0.0002498544821094329
Validation loss decreased (0.6170 --> 0.5580).  Saving model state dict ...
Epoch: 2 cost time: 0.7136459350585938
Epoch: 2, Steps: 123 | Train Loss: 0.9524537 Vali Loss: 0.5579976 Best vali loss: 0.5579976
	iters: 100, epoch: 3 | loss: 0.8403863
	speed: 0.0094s/iter; left time: 6.0216s
Updating learning rate to 0.00020237143728920657
Validation loss decreased (0.5580 --> 0.5430).  Saving model state dict ...
Epoch: 3 cost time: 0.7212731838226318
Epoch: 3, Steps: 123 | Train Loss: 0.8403863 Vali Loss: 0.5430227 Best vali loss: 0.5430227
	iters: 100, epoch: 4 | loss: 0.4887840
	speed: 0.0093s/iter; left time: 4.8142s
Updating learning rate to 0.000146361367
Epoch: 4 cost time: 0.7190213203430176
Epoch: 4, Steps: 123 | Train Loss: 0.4887840 Vali Loss: 0.5444854 Best vali loss: 0.5430227
	iters: 100, epoch: 5 | loss: 0.5555792
	speed: 0.0089s/iter; left time: 3.5148s
Updating learning rate to 9.035129671079342e-05
Validation loss decreased (0.5430 --> 0.5312).  Saving model state dict ...
Epoch: 5 cost time: 0.714057445526123
Epoch: 5, Steps: 123 | Train Loss: 0.5555792 Vali Loss: 0.5311646 Best vali loss: 0.5311646
	iters: 100, epoch: 6 | loss: 0.5865092
	speed: 0.0092s/iter; left time: 2.4934s
Updating learning rate to 4.286825189056703e-05
Epoch: 6 cost time: 0.7182002067565918
Epoch: 6, Steps: 123 | Train Loss: 0.5865092 Vali Loss: 0.5518204 Best vali loss: 0.5311646
	iters: 100, epoch: 7 | loss: 0.5333290
	speed: 0.0091s/iter; left time: 1.3304s
Updating learning rate to 1.1141095678327129e-05
Epoch: 7 cost time: 0.7146797180175781
Epoch: 7, Steps: 123 | Train Loss: 0.5333290 Vali Loss: 0.5454121 Best vali loss: 0.5311646
	iters: 100, epoch: 8 | loss: 0.6962861
	speed: 0.0090s/iter; left time: 0.2161s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7184243202209473
Epoch: 8, Steps: 123 | Train Loss: 0.6962861 Vali Loss: 0.5529413 Best vali loss: 0.5311646

best validation loss 0.5311645595137028

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001043287273, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 1.078894853591919
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6022641 Best vali loss: 0.6022641
Updating learning rate to 0.0002542161104024173
Epoch: 2 cost time: 0.7814121246337891
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6084551 Best vali loss: 0.6022641
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.6023 --> 0.5589).  Saving model state dict ...
Epoch: 3 cost time: 0.7840697765350342
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5589028 Best vali loss: 0.5589028

best validation loss 0.558902764061103

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.008272144464, 'e_layers': 3, 'learning_rate': 0.0038747038275, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003727231694135197
Validation loss decreased (inf --> 0.6183).  Saving model state dict ...
Epoch: 1 cost time: 0.7749314308166504
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6183445 Best vali loss: 0.6183445
Updating learning rate to 0.00330726658950736
Epoch: 2 cost time: 0.47846007347106934
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6332664 Best vali loss: 0.6183445
Updating learning rate to 0.0026787443938029254
Epoch: 3 cost time: 0.4762229919433594
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6221207 Best vali loss: 0.6183445

best validation loss 0.618344501509042

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010131997618, 'e_layers': 2, 'learning_rate': 0.0002926973418, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7739601
	speed: 0.0116s/iter; left time: 10.2739s
Updating learning rate to 0.0002815572125547401
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0244100093841553
Epoch: 1, Steps: 123 | Train Loss: 0.7739601 Vali Loss: 0.6172240 Best vali loss: 0.6172240
	iters: 100, epoch: 2 | loss: 0.9421933
	speed: 0.0093s/iter; left time: 7.0836s
Updating learning rate to 0.0002498328085110283
Validation loss decreased (0.6172 --> 0.5593).  Saving model state dict ...
Epoch: 2 cost time: 0.7316014766693115
Epoch: 2, Steps: 123 | Train Loss: 0.9421933 Vali Loss: 0.5593052 Best vali loss: 0.5593052
	iters: 100, epoch: 3 | loss: 0.8389333
	speed: 0.0094s/iter; left time: 6.0104s
Updating learning rate to 0.00020235388260208094
Validation loss decreased (0.5593 --> 0.5329).  Saving model state dict ...
Epoch: 3 cost time: 0.7311882972717285
Epoch: 3, Steps: 123 | Train Loss: 0.8389333 Vali Loss: 0.5328692 Best vali loss: 0.5328692

best validation loss 0.5328692224554197

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010131997618, 'e_layers': 2, 'learning_rate': 0.0002926973418, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5803149
	speed: 0.0121s/iter; left time: 6.2608s
Updating learning rate to 0.0001463486709
Validation loss decreased (0.5329 --> 0.5314).  Saving model state dict ...
Epoch: 4 cost time: 1.0383267402648926
Epoch: 4, Steps: 123 | Train Loss: 0.5803149 Vali Loss: 0.5313757 Best vali loss: 0.5313757
	iters: 100, epoch: 5 | loss: 0.8156936
	speed: 0.0093s/iter; left time: 3.6604s
Updating learning rate to 9.034345919791907e-05
Epoch: 5 cost time: 0.7116093635559082
Epoch: 5, Steps: 123 | Train Loss: 0.8156936 Vali Loss: 0.5336063 Best vali loss: 0.5313757
	iters: 100, epoch: 6 | loss: 0.7447320
	speed: 0.0090s/iter; left time: 2.4385s
Updating learning rate to 4.286453328897165e-05
Epoch: 6 cost time: 0.7174587249755859
Epoch: 6, Steps: 123 | Train Loss: 0.7447320 Vali Loss: 0.5355290 Best vali loss: 0.5313757
	iters: 100, epoch: 7 | loss: 0.4290214
	speed: 0.0089s/iter; left time: 1.3137s
Updating learning rate to 1.1140129245259846e-05
Epoch: 7 cost time: 0.7162618637084961
Epoch: 7, Steps: 123 | Train Loss: 0.4290214 Vali Loss: 0.5532009 Best vali loss: 0.5313757
	iters: 100, epoch: 8 | loss: 0.5021498
	speed: 0.0091s/iter; left time: 0.2173s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7216436862945557
Epoch: 8, Steps: 123 | Train Loss: 0.5021498 Vali Loss: 0.5518765 Best vali loss: 0.5313757

best validation loss 0.5313757333364932

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010446592422, 'e_layers': 2, 'learning_rate': 0.0003028357916, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7748665
	speed: 0.0117s/iter; left time: 10.3111s
Updating learning rate to 0.0003028357916
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0084271430969238
Epoch: 1, Steps: 123 | Train Loss: 0.7748665 Vali Loss: 0.6174376 Best vali loss: 0.6174376
	iters: 100, epoch: 2 | loss: 0.9511604
	speed: 0.0091s/iter; left time: 6.9131s
Updating learning rate to 0.0001514178958
Validation loss decreased (0.6174 --> 0.5829).  Saving model state dict ...
Epoch: 2 cost time: 0.7175960540771484
Epoch: 2, Steps: 123 | Train Loss: 0.9511604 Vali Loss: 0.5829441 Best vali loss: 0.5829441
	iters: 100, epoch: 3 | loss: 0.8532285
	speed: 0.0094s/iter; left time: 6.0361s
Updating learning rate to 7.57089479e-05
Validation loss decreased (0.5829 --> 0.5499).  Saving model state dict ...
Epoch: 3 cost time: 0.7239899635314941
Epoch: 3, Steps: 123 | Train Loss: 0.8532285 Vali Loss: 0.5498979 Best vali loss: 0.5498979
	iters: 100, epoch: 4 | loss: 0.4868747
	speed: 0.0093s/iter; left time: 4.8203s
Updating learning rate to 3.785447395e-05
Validation loss decreased (0.5499 --> 0.5406).  Saving model state dict ...
Epoch: 4 cost time: 0.7227463722229004
Epoch: 4, Steps: 123 | Train Loss: 0.4868747 Vali Loss: 0.5405724 Best vali loss: 0.5405724
	iters: 100, epoch: 5 | loss: 0.5701090
	speed: 0.0093s/iter; left time: 3.6361s
Updating learning rate to 1.8927236975e-05
Validation loss decreased (0.5406 --> 0.5339).  Saving model state dict ...
Epoch: 5 cost time: 0.7201125621795654
Epoch: 5, Steps: 123 | Train Loss: 0.5701090 Vali Loss: 0.5338722 Best vali loss: 0.5338722
	iters: 100, epoch: 6 | loss: 0.6174845
	speed: 0.0093s/iter; left time: 2.5190s
Updating learning rate to 9.4636184875e-06
Validation loss decreased (0.5339 --> 0.5285).  Saving model state dict ...
Epoch: 6 cost time: 0.7175025939941406
Epoch: 6, Steps: 123 | Train Loss: 0.6174845 Vali Loss: 0.5284605 Best vali loss: 0.5284605
	iters: 100, epoch: 7 | loss: 0.5819780
	speed: 0.0093s/iter; left time: 1.3651s
Updating learning rate to 4.73180924375e-06
Epoch: 7 cost time: 0.7241642475128174
Epoch: 7, Steps: 123 | Train Loss: 0.5819780 Vali Loss: 0.5285227 Best vali loss: 0.5284605
	iters: 100, epoch: 8 | loss: 0.7483507
	speed: 0.0090s/iter; left time: 0.2171s
Updating learning rate to 2.365904621875e-06
Validation loss decreased (0.5285 --> 0.5277).  Saving model state dict ...
Epoch: 8 cost time: 0.7203574180603027
Epoch: 8, Steps: 123 | Train Loss: 0.7483507 Vali Loss: 0.5276545 Best vali loss: 0.5276545

best validation loss 0.5276545197088814

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010441303786, 'e_layers': 2, 'learning_rate': 0.0002979767218, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745451
	speed: 0.0115s/iter; left time: 10.1955s
Updating learning rate to 0.0002979767218
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0115172863006592
Epoch: 1, Steps: 123 | Train Loss: 0.7745451 Vali Loss: 0.6171482 Best vali loss: 0.6171482
	iters: 100, epoch: 2 | loss: 0.9390697
	speed: 0.0091s/iter; left time: 6.9514s
Updating learning rate to 0.0001489883609
Epoch: 2 cost time: 0.71449875831604
Epoch: 2, Steps: 123 | Train Loss: 0.9390697 Vali Loss: 0.6296837 Best vali loss: 0.6171482
	iters: 100, epoch: 3 | loss: 0.8574971
	speed: 0.0091s/iter; left time: 5.7951s
Updating learning rate to 7.449418045e-05
Validation loss decreased (0.6171 --> 0.5508).  Saving model state dict ...
Epoch: 3 cost time: 0.7206873893737793
Epoch: 3, Steps: 123 | Train Loss: 0.8574971 Vali Loss: 0.5507940 Best vali loss: 0.5507940
	iters: 100, epoch: 4 | loss: 0.4925611
	speed: 0.0094s/iter; left time: 4.8540s
Updating learning rate to 3.7247090225e-05
Validation loss decreased (0.5508 --> 0.5392).  Saving model state dict ...
Epoch: 4 cost time: 0.7144420146942139
Epoch: 4, Steps: 123 | Train Loss: 0.4925611 Vali Loss: 0.5392398 Best vali loss: 0.5392398
	iters: 100, epoch: 5 | loss: 0.5733235
	speed: 0.0094s/iter; left time: 3.6918s
Updating learning rate to 1.86235451125e-05
Validation loss decreased (0.5392 --> 0.5354).  Saving model state dict ...
Epoch: 5 cost time: 0.7277512550354004
Epoch: 5, Steps: 123 | Train Loss: 0.5733235 Vali Loss: 0.5354193 Best vali loss: 0.5354193
	iters: 100, epoch: 6 | loss: 0.6212967
	speed: 0.0092s/iter; left time: 2.4950s
Updating learning rate to 9.31177255625e-06
Validation loss decreased (0.5354 --> 0.5278).  Saving model state dict ...
Epoch: 6 cost time: 0.7183358669281006
Epoch: 6, Steps: 123 | Train Loss: 0.6212967 Vali Loss: 0.5278386 Best vali loss: 0.5278386
	iters: 100, epoch: 7 | loss: 0.5884602
	speed: 0.0094s/iter; left time: 1.3813s
Updating learning rate to 4.655886278125e-06
Epoch: 7 cost time: 0.7273752689361572
Epoch: 7, Steps: 123 | Train Loss: 0.5884602 Vali Loss: 0.5299079 Best vali loss: 0.5278386
	iters: 100, epoch: 8 | loss: 0.7509118
	speed: 0.0091s/iter; left time: 0.2191s
Updating learning rate to 2.3279431390625e-06
Epoch: 8 cost time: 0.7265944480895996
Epoch: 8, Steps: 123 | Train Loss: 0.7509118 Vali Loss: 0.5290199 Best vali loss: 0.5278386

best validation loss 0.5278385763144062

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010442663497, 'e_layers': 2, 'learning_rate': 0.0002980094111, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8426791
	speed: 0.0110s/iter; left time: 9.7050s
Updating learning rate to 0.0002866671032555159
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9209470748901367
Epoch: 1, Steps: 123 | Train Loss: 0.8426791 Vali Loss: 0.5943348 Best vali loss: 0.5943348
	iters: 100, epoch: 2 | loss: 0.7205825
	speed: 0.0077s/iter; left time: 5.8674s
Updating learning rate to 0.00025436694327310975
Validation loss decreased (0.5943 --> 0.5577).  Saving model state dict ...
Epoch: 2 cost time: 0.6037788391113281
Epoch: 2, Steps: 123 | Train Loss: 0.7205825 Vali Loss: 0.5577395 Best vali loss: 0.5577395
	iters: 100, epoch: 3 | loss: 0.6541792
	speed: 0.0077s/iter; left time: 4.9294s
Updating learning rate to 0.00020602633770842353
Epoch: 3 cost time: 0.5927579402923584
Epoch: 3, Steps: 123 | Train Loss: 0.6541792 Vali Loss: 0.5583593 Best vali loss: 0.5577395

best validation loss 0.5577395228476836

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.006258308639, 'e_layers': 2, 'learning_rate': 0.0015600129814, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0015600129814
Validation loss decreased (inf --> 0.6085).  Saving model state dict ...
Epoch: 1 cost time: 0.713456392288208
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6084535 Best vali loss: 0.6084535
Updating learning rate to 0.0007800064907
Validation loss decreased (0.6085 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 0.42923879623413086
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6007066 Best vali loss: 0.6007066
Updating learning rate to 0.00039000324535
Epoch: 3 cost time: 0.44880247116088867
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6099095 Best vali loss: 0.6007066

best validation loss 0.6007065586556113

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010441802697, 'e_layers': 2, 'learning_rate': 0.0002980554522, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8825335
	speed: 0.0105s/iter; left time: 19.4699s
	iters: 200, epoch: 1 | loss: 0.6448832
	speed: 0.0040s/iter; left time: 7.0954s
Updating learning rate to 0.0002867113920204881
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 1.3558015823364258
Epoch: 1, Steps: 245 | Train Loss: 0.7637083 Vali Loss: 0.6030690 Best vali loss: 0.6030690
	iters: 100, epoch: 2 | loss: 0.7433354
	speed: 0.0089s/iter; left time: 14.3536s
	iters: 200, epoch: 2 | loss: 0.8812254
	speed: 0.0041s/iter; left time: 6.2217s
Updating learning rate to 0.00025440624181012145
Epoch: 2 cost time: 1.0497639179229736
Epoch: 2, Steps: 245 | Train Loss: 0.8122804 Vali Loss: 0.6115948 Best vali loss: 0.6030690
	iters: 100, epoch: 3 | loss: 0.7605692
	speed: 0.0086s/iter; left time: 11.8107s
	iters: 200, epoch: 3 | loss: 0.9042549
	speed: 0.0040s/iter; left time: 5.0904s
Updating learning rate to 0.0002060581678415125
Validation loss decreased (0.6031 --> 0.5650).  Saving model state dict ...
Epoch: 3 cost time: 1.0384538173675537
Epoch: 3, Steps: 245 | Train Loss: 0.8324120 Vali Loss: 0.5650450 Best vali loss: 0.5650450

best validation loss 0.5650450041149568

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010442663497, 'e_layers': 2, 'learning_rate': 0.0002980094111, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7525315
	speed: 0.0114s/iter; left time: 5.9032s
Updating learning rate to 0.00014900470555
Validation loss decreased (0.5577 --> 0.5570).  Saving model state dict ...
Epoch: 4 cost time: 0.9521594047546387
Epoch: 4, Steps: 123 | Train Loss: 0.7525315 Vali Loss: 0.5570099 Best vali loss: 0.5570099
	iters: 100, epoch: 5 | loss: 0.6460509
	speed: 0.0079s/iter; left time: 3.1162s
Updating learning rate to 9.198307339157646e-05
Validation loss decreased (0.5570 --> 0.5488).  Saving model state dict ...
Epoch: 5 cost time: 0.6201677322387695
Epoch: 5, Steps: 123 | Train Loss: 0.6460509 Vali Loss: 0.5487983 Best vali loss: 0.5487983
	iters: 100, epoch: 6 | loss: 0.6273777
	speed: 0.0077s/iter; left time: 2.0671s
Updating learning rate to 4.364246782689021e-05
Validation loss decreased (0.5488 --> 0.5431).  Saving model state dict ...
Epoch: 6 cost time: 0.5861008167266846
Epoch: 6, Steps: 123 | Train Loss: 0.6273777 Vali Loss: 0.5430985 Best vali loss: 0.5430985
	iters: 100, epoch: 7 | loss: 0.6284618
	speed: 0.0074s/iter; left time: 1.0837s
Updating learning rate to 1.1342307844484067e-05
Validation loss decreased (0.5431 --> 0.5422).  Saving model state dict ...
Epoch: 7 cost time: 0.5747439861297607
Epoch: 7, Steps: 123 | Train Loss: 0.6284618 Vali Loss: 0.5421680 Best vali loss: 0.5421680
	iters: 100, epoch: 8 | loss: 0.4654725
	speed: 0.0077s/iter; left time: 0.1854s
Updating learning rate to 0.0
Validation loss decreased (0.5422 --> 0.5403).  Saving model state dict ...
Epoch: 8 cost time: 0.6074910163879395
Epoch: 8, Steps: 123 | Train Loss: 0.4654725 Vali Loss: 0.5402636 Best vali loss: 0.5402636

best validation loss 0.5402635694901626

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010443327773, 'e_layers': 2, 'learning_rate': 0.0002987065158, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8825229
	speed: 0.0105s/iter; left time: 19.5101s
	iters: 200, epoch: 1 | loss: 0.6446856
	speed: 0.0043s/iter; left time: 7.5203s
Updating learning rate to 0.0002987065158
Validation loss decreased (inf --> 0.6011).  Saving model state dict ...
Epoch: 1 cost time: 1.3899385929107666
Epoch: 1, Steps: 245 | Train Loss: 0.7636043 Vali Loss: 0.6011212 Best vali loss: 0.6011212
	iters: 100, epoch: 2 | loss: 0.7576983
	speed: 0.0088s/iter; left time: 14.2965s
	iters: 200, epoch: 2 | loss: 0.8872901
	speed: 0.0040s/iter; left time: 6.0151s
Updating learning rate to 0.0001493532579
Validation loss decreased (0.6011 --> 0.5824).  Saving model state dict ...
Epoch: 2 cost time: 1.0239410400390625
Epoch: 2, Steps: 245 | Train Loss: 0.8224942 Vali Loss: 0.5824119 Best vali loss: 0.5824119
	iters: 100, epoch: 3 | loss: 0.7458259
	speed: 0.0091s/iter; left time: 12.4415s
	iters: 200, epoch: 3 | loss: 0.9009331
	speed: 0.0040s/iter; left time: 5.1320s
Updating learning rate to 7.467662895e-05
Validation loss decreased (0.5824 --> 0.5433).  Saving model state dict ...
Epoch: 3 cost time: 1.0555236339569092
Epoch: 3, Steps: 245 | Train Loss: 0.8233795 Vali Loss: 0.5432854 Best vali loss: 0.5432854
	iters: 100, epoch: 4 | loss: 0.6185449
	speed: 0.0090s/iter; left time: 10.1853s
	iters: 200, epoch: 4 | loss: 0.5342938
	speed: 0.0040s/iter; left time: 4.0545s
Updating learning rate to 3.7338314475e-05
Epoch: 4 cost time: 1.0213816165924072
Epoch: 4, Steps: 245 | Train Loss: 0.5764193 Vali Loss: 0.5465254 Best vali loss: 0.5432854
	iters: 100, epoch: 5 | loss: 0.7460037
	speed: 0.0085s/iter; left time: 7.4607s
	iters: 200, epoch: 5 | loss: 0.5616563
	speed: 0.0042s/iter; left time: 3.2875s
Updating learning rate to 1.86691572375e-05
Validation loss decreased (0.5433 --> 0.5417).  Saving model state dict ...
Epoch: 5 cost time: 1.0594871044158936
Epoch: 5, Steps: 245 | Train Loss: 0.6538300 Vali Loss: 0.5417078 Best vali loss: 0.5417078
	iters: 100, epoch: 6 | loss: 0.3739750
	speed: 0.0093s/iter; left time: 5.8880s
	iters: 200, epoch: 6 | loss: 0.6053541
	speed: 0.0040s/iter; left time: 2.1492s
Updating learning rate to 9.33457861875e-06
Validation loss decreased (0.5417 --> 0.5369).  Saving model state dict ...
Epoch: 6 cost time: 1.040705919265747
Epoch: 6, Steps: 245 | Train Loss: 0.4896645 Vali Loss: 0.5369457 Best vali loss: 0.5369457
	iters: 100, epoch: 7 | loss: 0.8020180
	speed: 0.0089s/iter; left time: 3.4673s
	iters: 200, epoch: 7 | loss: 0.5908090
	speed: 0.0042s/iter; left time: 1.2222s
Updating learning rate to 4.667289309375e-06
Validation loss decreased (0.5369 --> 0.5365).  Saving model state dict ...
Epoch: 7 cost time: 1.0620341300964355
Epoch: 7, Steps: 245 | Train Loss: 0.6964135 Vali Loss: 0.5365298 Best vali loss: 0.5365298
	iters: 100, epoch: 8 | loss: 0.7021695
	speed: 0.0092s/iter; left time: 1.3422s
	iters: 200, epoch: 8 | loss: 0.8801619
	speed: 0.0040s/iter; left time: 0.1833s
Updating learning rate to 2.3336446546875e-06
Epoch: 8 cost time: 1.0405824184417725
Epoch: 8, Steps: 245 | Train Loss: 0.7911657 Vali Loss: 0.5373077 Best vali loss: 0.5365298

best validation loss 0.536529818048967

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442887559, 'e_layers': 2, 'learning_rate': 0.0003009100649, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8825174
	speed: 0.0107s/iter; left time: 19.8655s
	iters: 200, epoch: 1 | loss: 0.6472315
	speed: 0.0042s/iter; left time: 7.3592s
Updating learning rate to 0.0003009100649
Validation loss decreased (inf --> 0.6010).  Saving model state dict ...
Epoch: 1 cost time: 1.3937363624572754
Epoch: 1, Steps: 245 | Train Loss: 0.7648744 Vali Loss: 0.6009933 Best vali loss: 0.6009933
	iters: 100, epoch: 2 | loss: 0.7532615
	speed: 0.0088s/iter; left time: 14.1561s
	iters: 200, epoch: 2 | loss: 0.9141555
	speed: 0.0040s/iter; left time: 6.0187s
Updating learning rate to 0.00015045503245
Epoch: 2 cost time: 1.017878770828247
Epoch: 2, Steps: 245 | Train Loss: 0.8337085 Vali Loss: 0.6488703 Best vali loss: 0.6009933
	iters: 100, epoch: 3 | loss: 0.7559084
	speed: 0.0084s/iter; left time: 11.4736s
	iters: 200, epoch: 3 | loss: 0.9009305
	speed: 0.0040s/iter; left time: 5.0308s
Updating learning rate to 7.5227516225e-05
Validation loss decreased (0.6010 --> 0.5700).  Saving model state dict ...
Epoch: 3 cost time: 1.0106632709503174
Epoch: 3, Steps: 245 | Train Loss: 0.8284194 Vali Loss: 0.5700457 Best vali loss: 0.5700457
	iters: 100, epoch: 4 | loss: 0.6180413
	speed: 0.0088s/iter; left time: 9.8771s
	iters: 200, epoch: 4 | loss: 0.5377759
	speed: 0.0039s/iter; left time: 4.0364s
Updating learning rate to 3.76137581125e-05
Validation loss decreased (0.5700 --> 0.5580).  Saving model state dict ...
Epoch: 4 cost time: 1.013171672821045
Epoch: 4, Steps: 245 | Train Loss: 0.5779086 Vali Loss: 0.5579684 Best vali loss: 0.5579684
	iters: 100, epoch: 5 | loss: 0.7652944
	speed: 0.0086s/iter; left time: 7.5735s
	iters: 200, epoch: 5 | loss: 0.5602385
	speed: 0.0040s/iter; left time: 3.1325s
Updating learning rate to 1.880687905625e-05
Validation loss decreased (0.5580 --> 0.5494).  Saving model state dict ...
Epoch: 5 cost time: 1.0166642665863037
Epoch: 5, Steps: 245 | Train Loss: 0.6627665 Vali Loss: 0.5494071 Best vali loss: 0.5494071
	iters: 100, epoch: 6 | loss: 0.3826120
	speed: 0.0088s/iter; left time: 5.5769s
	iters: 200, epoch: 6 | loss: 0.6077742
	speed: 0.0039s/iter; left time: 2.1017s
Updating learning rate to 9.403439528125e-06
Validation loss decreased (0.5494 --> 0.5487).  Saving model state dict ...
Epoch: 6 cost time: 1.011547327041626
Epoch: 6, Steps: 245 | Train Loss: 0.4951931 Vali Loss: 0.5487469 Best vali loss: 0.5487469
	iters: 100, epoch: 7 | loss: 0.8136955
	speed: 0.0087s/iter; left time: 3.3940s
	iters: 200, epoch: 7 | loss: 0.5864919
	speed: 0.0040s/iter; left time: 1.1517s
Updating learning rate to 4.7017197640625e-06
Validation loss decreased (0.5487 --> 0.5487).  Saving model state dict ...
Epoch: 7 cost time: 1.0203425884246826
Epoch: 7, Steps: 245 | Train Loss: 0.7000937 Vali Loss: 0.5486651 Best vali loss: 0.5486651
	iters: 100, epoch: 8 | loss: 0.7142950
	speed: 0.0092s/iter; left time: 1.3458s
	iters: 200, epoch: 8 | loss: 0.8874824
	speed: 0.0044s/iter; left time: 0.2014s
Updating learning rate to 2.35085988203125e-06
Validation loss decreased (0.5487 --> 0.5474).  Saving model state dict ...
Epoch: 8 cost time: 1.1233208179473877
Epoch: 8, Steps: 245 | Train Loss: 0.8008887 Vali Loss: 0.5473843 Best vali loss: 0.5473843

best validation loss 0.5473843077331271

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010445577909, 'e_layers': 2, 'learning_rate': 0.0003077398856, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8825319
	speed: 0.0104s/iter; left time: 19.3685s
	iters: 200, epoch: 1 | loss: 0.6480632
	speed: 0.0042s/iter; left time: 7.4130s
Updating learning rate to 0.0003077398856
Validation loss decreased (inf --> 0.5994).  Saving model state dict ...
Epoch: 1 cost time: 1.3878822326660156
Epoch: 1, Steps: 245 | Train Loss: 0.7652976 Vali Loss: 0.5993980 Best vali loss: 0.5993980
	iters: 100, epoch: 2 | loss: 0.7581183
	speed: 0.0090s/iter; left time: 14.5797s
	iters: 200, epoch: 2 | loss: 0.8997758
	speed: 0.0041s/iter; left time: 6.2746s
Updating learning rate to 0.0001538699428
Validation loss decreased (0.5994 --> 0.5907).  Saving model state dict ...
Epoch: 2 cost time: 1.062654733657837
Epoch: 2, Steps: 245 | Train Loss: 0.8289471 Vali Loss: 0.5907285 Best vali loss: 0.5907285
	iters: 100, epoch: 3 | loss: 0.7552696
	speed: 0.0093s/iter; left time: 12.7343s
	iters: 200, epoch: 3 | loss: 0.8983050
	speed: 0.0042s/iter; left time: 5.3021s
Updating learning rate to 7.69349714e-05
Validation loss decreased (0.5907 --> 0.5591).  Saving model state dict ...
Epoch: 3 cost time: 1.0760526657104492
Epoch: 3, Steps: 245 | Train Loss: 0.8267873 Vali Loss: 0.5591089 Best vali loss: 0.5591089

best validation loss 0.5591089358102498

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010443816984, 'e_layers': 2, 'learning_rate': 0.0003032075607, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8825015
	speed: 0.0106s/iter; left time: 19.6459s
	iters: 200, epoch: 1 | loss: 0.6466256
	speed: 0.0041s/iter; left time: 7.1916s
Updating learning rate to 0.0003032075607
Validation loss decreased (inf --> 0.6007).  Saving model state dict ...
Epoch: 1 cost time: 1.3775901794433594
Epoch: 1, Steps: 245 | Train Loss: 0.7645636 Vali Loss: 0.6007495 Best vali loss: 0.6007495
	iters: 100, epoch: 2 | loss: 0.7518705
	speed: 0.0089s/iter; left time: 14.3311s
	iters: 200, epoch: 2 | loss: 0.8964501
	speed: 0.0041s/iter; left time: 6.1597s
Updating learning rate to 0.00015160378035
Epoch: 2 cost time: 1.0481295585632324
Epoch: 2, Steps: 245 | Train Loss: 0.8241603 Vali Loss: 0.6240833 Best vali loss: 0.6007495
	iters: 100, epoch: 3 | loss: 0.7531385
	speed: 0.0087s/iter; left time: 11.9253s
	iters: 200, epoch: 3 | loss: 0.9018282
	speed: 0.0043s/iter; left time: 5.4834s
Updating learning rate to 7.5801890175e-05
Validation loss decreased (0.6007 --> 0.5508).  Saving model state dict ...
Epoch: 3 cost time: 1.0834383964538574
Epoch: 3, Steps: 245 | Train Loss: 0.8274833 Vali Loss: 0.5508462 Best vali loss: 0.5508462

best validation loss 0.5508462261099994

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442663497, 'e_layers': 3, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8981749
	speed: 0.0101s/iter; left time: 77.7475s
	iters: 200, epoch: 1 | loss: 0.6005667
	speed: 0.0040s/iter; left time: 30.5600s
	iters: 300, epoch: 1 | loss: 0.6347498
	speed: 0.0040s/iter; left time: 30.2437s
	iters: 400, epoch: 1 | loss: 0.9863746
	speed: 0.0038s/iter; left time: 27.9011s
	iters: 500, epoch: 1 | loss: 0.5714081
	speed: 0.0037s/iter; left time: 27.3061s
	iters: 600, epoch: 1 | loss: 0.9226630
	speed: 0.0038s/iter; left time: 27.3814s
	iters: 700, epoch: 1 | loss: 1.0029442
	speed: 0.0038s/iter; left time: 27.2647s
	iters: 800, epoch: 1 | loss: 0.5802655
	speed: 0.0038s/iter; left time: 26.7301s
	iters: 900, epoch: 1 | loss: 0.9067307
	speed: 0.0039s/iter; left time: 27.2128s
Updating learning rate to 0.00028656042375066227
Validation loss decreased (inf --> 0.6437).  Saving model state dict ...
Epoch: 1 cost time: 4.1347692012786865
Epoch: 1, Steps: 979 | Train Loss: 0.7893197 Vali Loss: 0.6437044 Best vali loss: 0.6437044
	iters: 100, epoch: 2 | loss: 0.8442573
	speed: 0.0139s/iter; left time: 94.0337s
	iters: 200, epoch: 2 | loss: 0.5461112
	speed: 0.0041s/iter; left time: 27.5322s
	iters: 300, epoch: 2 | loss: 0.5474767
	speed: 0.0037s/iter; left time: 24.3795s
	iters: 400, epoch: 2 | loss: 0.5159142
	speed: 0.0038s/iter; left time: 24.2647s
	iters: 500, epoch: 2 | loss: 0.6373863
	speed: 0.0039s/iter; left time: 24.4787s
	iters: 600, epoch: 2 | loss: 0.6845785
	speed: 0.0040s/iter; left time: 24.9990s
	iters: 700, epoch: 2 | loss: 0.4580525
	speed: 0.0040s/iter; left time: 24.6900s
	iters: 800, epoch: 2 | loss: 1.1880050
	speed: 0.0042s/iter; left time: 25.2047s
	iters: 900, epoch: 2 | loss: 0.3703242
	speed: 0.0044s/iter; left time: 25.9134s
Updating learning rate to 0.0002542722838606716
Epoch: 2 cost time: 4.031444549560547
Epoch: 2, Steps: 979 | Train Loss: 0.6435673 Vali Loss: 0.6561233 Best vali loss: 0.6437044
	iters: 100, epoch: 3 | loss: 1.3148546
	speed: 0.0140s/iter; left time: 80.5696s
	iters: 200, epoch: 3 | loss: 0.2612015
	speed: 0.0044s/iter; left time: 25.1286s
	iters: 300, epoch: 3 | loss: 0.5125158
	speed: 0.0045s/iter; left time: 25.0314s
	iters: 400, epoch: 3 | loss: 1.3215175
	speed: 0.0044s/iter; left time: 23.8984s
	iters: 500, epoch: 3 | loss: 0.9281655
	speed: 0.0045s/iter; left time: 24.3062s
	iters: 600, epoch: 3 | loss: 0.7751932
	speed: 0.0038s/iter; left time: 20.2104s
	iters: 700, epoch: 3 | loss: 0.9457248
	speed: 0.0038s/iter; left time: 19.5131s
	iters: 800, epoch: 3 | loss: 0.6456246
	speed: 0.0038s/iter; left time: 19.3090s
	iters: 900, epoch: 3 | loss: 0.7645686
	speed: 0.0040s/iter; left time: 19.7050s
Updating learning rate to 0.0002059496676355622
Validation loss decreased (0.6437 --> 0.6331).  Saving model state dict ...
Epoch: 3 cost time: 4.1127636432647705
Epoch: 3, Steps: 979 | Train Loss: 0.8299296 Vali Loss: 0.6331202 Best vali loss: 0.6331202

best validation loss 0.6331202235833079

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010443816984, 'e_layers': 2, 'learning_rate': 0.0003032075607, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8278471
	speed: 0.0108s/iter; left time: 12.1952s
	iters: 200, epoch: 4 | loss: 0.5143459
	speed: 0.0041s/iter; left time: 4.2530s
Updating learning rate to 3.79009450875e-05
Validation loss decreased (0.5508 --> 0.5440).  Saving model state dict ...
Epoch: 4 cost time: 1.3705697059631348
Epoch: 4, Steps: 245 | Train Loss: 0.6710965 Vali Loss: 0.5440342 Best vali loss: 0.5440342
	iters: 100, epoch: 5 | loss: 0.6527523
	speed: 0.0090s/iter; left time: 7.9682s
	iters: 200, epoch: 5 | loss: 0.8206254
	speed: 0.0043s/iter; left time: 3.3222s
Updating learning rate to 1.895047254375e-05
Validation loss decreased (0.5440 --> 0.5392).  Saving model state dict ...
Epoch: 5 cost time: 1.0912692546844482
Epoch: 5, Steps: 245 | Train Loss: 0.7366889 Vali Loss: 0.5392100 Best vali loss: 0.5392100
	iters: 100, epoch: 6 | loss: 0.6902532
	speed: 0.0092s/iter; left time: 5.8745s
	iters: 200, epoch: 6 | loss: 0.8509988
	speed: 0.0041s/iter; left time: 2.2171s
Updating learning rate to 9.475236271875e-06
Epoch: 6 cost time: 1.0761427879333496
Epoch: 6, Steps: 245 | Train Loss: 0.7706260 Vali Loss: 0.5413403 Best vali loss: 0.5392100
	iters: 100, epoch: 7 | loss: 0.5868012
	speed: 0.0088s/iter; left time: 3.4259s
	iters: 200, epoch: 7 | loss: 0.5003599
	speed: 0.0042s/iter; left time: 1.2152s
Updating learning rate to 4.7376181359375e-06
Epoch: 7 cost time: 1.0672290325164795
Epoch: 7, Steps: 245 | Train Loss: 0.5435806 Vali Loss: 0.5404895 Best vali loss: 0.5392100
	iters: 100, epoch: 8 | loss: 0.7327337
	speed: 0.0088s/iter; left time: 1.2853s
	iters: 200, epoch: 8 | loss: 0.5356703
	speed: 0.0043s/iter; left time: 0.1963s
Updating learning rate to 2.36880906796875e-06
Validation loss decreased (0.5392 --> 0.5390).  Saving model state dict ...
Epoch: 8 cost time: 1.0855026245117188
Epoch: 8, Steps: 245 | Train Loss: 0.6342020 Vali Loss: 0.5389802 Best vali loss: 0.5389802

best validation loss 0.5389802121056941

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0008236849278, 'e_layers': 4, 'learning_rate': 0.0005271398534, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4621518
	speed: 0.0112s/iter; left time: 42.7061s
	iters: 200, epoch: 1 | loss: 1.2502326
	speed: 0.0051s/iter; left time: 18.8033s
	iters: 300, epoch: 1 | loss: 0.3338449
	speed: 0.0051s/iter; left time: 18.2920s
	iters: 400, epoch: 1 | loss: 0.7990481
	speed: 0.0049s/iter; left time: 17.1502s
Updating learning rate to 0.0005271398534
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 2.805088520050049
Epoch: 1, Steps: 490 | Train Loss: 0.7113193 Vali Loss: 0.6073582 Best vali loss: 0.6073582
	iters: 100, epoch: 2 | loss: 1.1873174
	speed: 0.0134s/iter; left time: 44.6641s
	iters: 200, epoch: 2 | loss: 0.7475232
	speed: 0.0048s/iter; left time: 15.5780s
	iters: 300, epoch: 2 | loss: 1.1511314
	speed: 0.0049s/iter; left time: 15.2311s
	iters: 400, epoch: 2 | loss: 0.5384033
	speed: 0.0049s/iter; left time: 14.9252s
Updating learning rate to 0.0002635699267
Epoch: 2 cost time: 2.4309451580047607
Epoch: 2, Steps: 490 | Train Loss: 0.9060938 Vali Loss: 0.6099828 Best vali loss: 0.6073582
	iters: 100, epoch: 3 | loss: 0.7969070
	speed: 0.0135s/iter; left time: 38.3779s
	iters: 200, epoch: 3 | loss: 0.3314344
	speed: 0.0051s/iter; left time: 14.0433s
	iters: 300, epoch: 3 | loss: 0.6000684
	speed: 0.0052s/iter; left time: 13.7829s
	iters: 400, epoch: 3 | loss: 1.0802017
	speed: 0.0050s/iter; left time: 12.7862s
Updating learning rate to 0.00013178496335
Validation loss decreased (0.6074 --> 0.6008).  Saving model state dict ...
Epoch: 3 cost time: 2.5577821731567383
Epoch: 3, Steps: 490 | Train Loss: 0.7021529 Vali Loss: 0.6007667 Best vali loss: 0.6007667
	iters: 100, epoch: 4 | loss: 0.9507311
	speed: 0.0129s/iter; left time: 30.3376s
	iters: 200, epoch: 4 | loss: 0.4736241
	speed: 0.0047s/iter; left time: 10.6702s
	iters: 300, epoch: 4 | loss: 1.1083024
	speed: 0.0047s/iter; left time: 10.1779s
	iters: 400, epoch: 4 | loss: 1.0646099
	speed: 0.0048s/iter; left time: 9.8265s
Updating learning rate to 6.5892481675e-05
Validation loss decreased (0.6008 --> 0.5614).  Saving model state dict ...
Epoch: 4 cost time: 2.372659683227539
Epoch: 4, Steps: 490 | Train Loss: 0.8993168 Vali Loss: 0.5614036 Best vali loss: 0.5614036
	iters: 100, epoch: 5 | loss: 0.7689130
	speed: 0.0130s/iter; left time: 24.1794s
	iters: 200, epoch: 5 | loss: 0.3950458
	speed: 0.0048s/iter; left time: 8.4766s
	iters: 300, epoch: 5 | loss: 0.2881283
	speed: 0.0049s/iter; left time: 8.1013s
	iters: 400, epoch: 5 | loss: 0.6941449
	speed: 0.0047s/iter; left time: 7.4143s
Updating learning rate to 3.29462408375e-05
Validation loss decreased (0.5614 --> 0.5479).  Saving model state dict ...
Epoch: 5 cost time: 2.3966522216796875
Epoch: 5, Steps: 490 | Train Loss: 0.5365580 Vali Loss: 0.5478755 Best vali loss: 0.5478755
	iters: 100, epoch: 6 | loss: 0.4837488
	speed: 0.0138s/iter; left time: 18.9701s
	iters: 200, epoch: 6 | loss: 1.0280342
	speed: 0.0054s/iter; left time: 6.8035s
	iters: 300, epoch: 6 | loss: 0.8336107
	speed: 0.0054s/iter; left time: 6.2923s
	iters: 400, epoch: 6 | loss: 0.9018629
	speed: 0.0054s/iter; left time: 5.7410s
Updating learning rate to 1.647312041875e-05
Epoch: 6 cost time: 2.6738266944885254
Epoch: 6, Steps: 490 | Train Loss: 0.8118142 Vali Loss: 0.5481641 Best vali loss: 0.5478755
	iters: 100, epoch: 7 | loss: 1.2979580
	speed: 0.0143s/iter; left time: 12.5700s
	iters: 200, epoch: 7 | loss: 0.7502568
	speed: 0.0049s/iter; left time: 3.8262s
	iters: 300, epoch: 7 | loss: 0.9351268
	speed: 0.0050s/iter; left time: 3.4388s
	iters: 400, epoch: 7 | loss: 0.6511546
	speed: 0.0050s/iter; left time: 2.8828s
Updating learning rate to 8.236560209375e-06
Epoch: 7 cost time: 2.5231430530548096
Epoch: 7, Steps: 490 | Train Loss: 0.9086241 Vali Loss: 0.5498687 Best vali loss: 0.5478755
	iters: 100, epoch: 8 | loss: 0.6694918
	speed: 0.0135s/iter; left time: 5.2676s
	iters: 200, epoch: 8 | loss: 0.8666293
	speed: 0.0054s/iter; left time: 1.5575s
	iters: 300, epoch: 8 | loss: 0.8215240
	speed: 0.0053s/iter; left time: 1.0191s
	iters: 400, epoch: 8 | loss: 0.8522694
	speed: 0.0052s/iter; left time: 0.4756s
Updating learning rate to 4.1182801046875e-06
Epoch: 8 cost time: 2.643125295639038
Epoch: 8, Steps: 490 | Train Loss: 0.8024786 Vali Loss: 0.5481931 Best vali loss: 0.5478755

best validation loss 0.5478754667483342

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.0002979255561, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8983997
	speed: 0.0104s/iter; left time: 80.7428s
	iters: 200, epoch: 1 | loss: 0.5992941
	speed: 0.0043s/iter; left time: 33.0734s
	iters: 300, epoch: 1 | loss: 0.6184564
	speed: 0.0044s/iter; left time: 33.4545s
	iters: 400, epoch: 1 | loss: 0.8911226
	speed: 0.0045s/iter; left time: 33.2307s
	iters: 500, epoch: 1 | loss: 0.5623693
	speed: 0.0045s/iter; left time: 33.1019s
	iters: 600, epoch: 1 | loss: 0.9125594
	speed: 0.0045s/iter; left time: 32.3805s
	iters: 700, epoch: 1 | loss: 0.9967760
	speed: 0.0045s/iter; left time: 32.2200s
	iters: 800, epoch: 1 | loss: 0.5079197
	speed: 0.0045s/iter; left time: 31.7305s
	iters: 900, epoch: 1 | loss: 0.9199975
	speed: 0.0044s/iter; left time: 30.6375s
Updating learning rate to 0.0002865864397964166
Validation loss decreased (inf --> 0.6413).  Saving model state dict ...
Epoch: 1 cost time: 4.68825101852417
Epoch: 1, Steps: 979 | Train Loss: 0.7674327 Vali Loss: 0.6413493 Best vali loss: 0.6413493
	iters: 100, epoch: 2 | loss: 0.8594492
	speed: 0.0133s/iter; left time: 89.8536s
	iters: 200, epoch: 2 | loss: 0.5394741
	speed: 0.0040s/iter; left time: 26.3697s
	iters: 300, epoch: 2 | loss: 0.4848762
	speed: 0.0040s/iter; left time: 26.2266s
	iters: 400, epoch: 2 | loss: 0.5179603
	speed: 0.0038s/iter; left time: 24.4293s
	iters: 500, epoch: 2 | loss: 0.7384160
	speed: 0.0037s/iter; left time: 23.5234s
	iters: 600, epoch: 2 | loss: 0.6917803
	speed: 0.0037s/iter; left time: 23.2186s
	iters: 700, epoch: 2 | loss: 0.4545913
	speed: 0.0044s/iter; left time: 27.0214s
	iters: 800, epoch: 2 | loss: 1.2540599
	speed: 0.0045s/iter; left time: 27.2196s
	iters: 900, epoch: 2 | loss: 0.3969137
	speed: 0.0045s/iter; left time: 26.7433s
Updating learning rate to 0.0002542953685535416
Validation loss decreased (0.6413 --> 0.6410).  Saving model state dict ...
Epoch: 2 cost time: 4.056361198425293
Epoch: 2, Steps: 979 | Train Loss: 0.6597246 Vali Loss: 0.6409548 Best vali loss: 0.6409548
	iters: 100, epoch: 3 | loss: 1.3116388
	speed: 0.0140s/iter; left time: 81.0903s
	iters: 200, epoch: 3 | loss: 0.2682519
	speed: 0.0039s/iter; left time: 22.2410s
	iters: 300, epoch: 3 | loss: 0.4835215
	speed: 0.0039s/iter; left time: 21.7161s
	iters: 400, epoch: 3 | loss: 1.2729727
	speed: 0.0037s/iter; left time: 20.2791s
	iters: 500, epoch: 3 | loss: 0.8919635
	speed: 0.0039s/iter; left time: 20.8722s
	iters: 600, epoch: 3 | loss: 0.7956714
	speed: 0.0039s/iter; left time: 20.3453s
	iters: 700, epoch: 3 | loss: 0.8676398
	speed: 0.0040s/iter; left time: 20.4591s
	iters: 800, epoch: 3 | loss: 0.6435593
	speed: 0.0040s/iter; left time: 20.0465s
	iters: 900, epoch: 3 | loss: 0.6964816
	speed: 0.0039s/iter; left time: 19.4310s
Updating learning rate to 0.00020596836524881308
Validation loss decreased (0.6410 --> 0.6146).  Saving model state dict ...
Epoch: 3 cost time: 3.863069772720337
Epoch: 3, Steps: 979 | Train Loss: 0.8035223 Vali Loss: 0.6146350 Best vali loss: 0.6146350
	iters: 100, epoch: 4 | loss: 0.5562409
	speed: 0.0130s/iter; left time: 62.4125s
	iters: 200, epoch: 4 | loss: 1.0832752
	speed: 0.0040s/iter; left time: 18.6287s
	iters: 300, epoch: 4 | loss: 1.1143404
	speed: 0.0043s/iter; left time: 19.6066s
	iters: 400, epoch: 4 | loss: 1.0344479
	speed: 0.0043s/iter; left time: 19.1141s
	iters: 500, epoch: 4 | loss: 2.1010635
	speed: 0.0044s/iter; left time: 19.2961s
	iters: 600, epoch: 4 | loss: 0.9832127
	speed: 0.0043s/iter; left time: 18.4849s
	iters: 700, epoch: 4 | loss: 0.3429079
	speed: 0.0044s/iter; left time: 18.2655s
	iters: 800, epoch: 4 | loss: 0.4980670
	speed: 0.0043s/iter; left time: 17.6341s
	iters: 900, epoch: 4 | loss: 0.4287631
	speed: 0.0045s/iter; left time: 17.8474s
Updating learning rate to 0.00014896277805
Epoch: 4 cost time: 4.208682537078857
Epoch: 4, Steps: 979 | Train Loss: 0.9047021 Vali Loss: 0.6217474 Best vali loss: 0.6146350
	iters: 100, epoch: 5 | loss: 0.6077152
	speed: 0.0136s/iter; left time: 51.7443s
	iters: 200, epoch: 5 | loss: 0.6195340
	speed: 0.0044s/iter; left time: 16.4434s
	iters: 300, epoch: 5 | loss: 0.9611869
	speed: 0.0044s/iter; left time: 15.9372s
	iters: 400, epoch: 5 | loss: 0.2721066
	speed: 0.0044s/iter; left time: 15.5749s
	iters: 500, epoch: 5 | loss: 0.6112096
	speed: 0.0044s/iter; left time: 14.9198s
	iters: 600, epoch: 5 | loss: 0.8490918
	speed: 0.0045s/iter; left time: 14.8135s
	iters: 700, epoch: 5 | loss: 1.8738573
	speed: 0.0043s/iter; left time: 13.8163s
	iters: 800, epoch: 5 | loss: 0.4514028
	speed: 0.0045s/iter; left time: 13.8745s
	iters: 900, epoch: 5 | loss: 0.9350652
	speed: 0.0043s/iter; left time: 13.0884s
Updating learning rate to 9.195719085118696e-05
Epoch: 5 cost time: 4.339740037918091
Epoch: 5, Steps: 979 | Train Loss: 0.7979077 Vali Loss: 0.6157086 Best vali loss: 0.6146350
	iters: 100, epoch: 6 | loss: 0.5844064
	speed: 0.0131s/iter; left time: 37.2873s
	iters: 200, epoch: 6 | loss: 1.2835397
	speed: 0.0038s/iter; left time: 10.3719s
	iters: 300, epoch: 6 | loss: 0.4672591
	speed: 0.0040s/iter; left time: 10.5581s
	iters: 400, epoch: 6 | loss: 0.9098743
	speed: 0.0040s/iter; left time: 10.1884s
	iters: 500, epoch: 6 | loss: 0.5471773
	speed: 0.0039s/iter; left time: 9.6164s
	iters: 600, epoch: 6 | loss: 0.3162077
	speed: 0.0039s/iter; left time: 9.0624s
	iters: 700, epoch: 6 | loss: 0.9878123
	speed: 0.0040s/iter; left time: 8.9698s
	iters: 800, epoch: 6 | loss: 0.3149925
	speed: 0.0038s/iter; left time: 8.2105s
	iters: 900, epoch: 6 | loss: 1.5087740
	speed: 0.0038s/iter; left time: 7.7375s
Updating learning rate to 4.363018754645842e-05
Epoch: 6 cost time: 3.8462963104248047
Epoch: 6, Steps: 979 | Train Loss: 0.7688937 Vali Loss: 0.6199385 Best vali loss: 0.6146350
	iters: 100, epoch: 7 | loss: 0.4373906
	speed: 0.0125s/iter; left time: 23.1469s
	iters: 200, epoch: 7 | loss: 0.9466710
	speed: 0.0040s/iter; left time: 7.0676s
	iters: 300, epoch: 7 | loss: 0.6528543
	speed: 0.0039s/iter; left time: 6.5444s
	iters: 400, epoch: 7 | loss: 1.1478909
	speed: 0.0040s/iter; left time: 6.2289s
	iters: 500, epoch: 7 | loss: 1.2568638
	speed: 0.0041s/iter; left time: 5.9437s
	iters: 600, epoch: 7 | loss: 1.1762035
	speed: 0.0040s/iter; left time: 5.4124s
	iters: 700, epoch: 7 | loss: 0.3852715
	speed: 0.0040s/iter; left time: 5.0540s
	iters: 800, epoch: 7 | loss: 0.9176330
	speed: 0.0039s/iter; left time: 4.4888s
	iters: 900, epoch: 7 | loss: 0.8554845
	speed: 0.0039s/iter; left time: 4.1248s
Updating learning rate to 1.1339116303583435e-05
Validation loss decreased (0.6146 --> 0.6131).  Saving model state dict ...
Epoch: 7 cost time: 3.93182110786438
Epoch: 7, Steps: 979 | Train Loss: 0.8640292 Vali Loss: 0.6130749 Best vali loss: 0.6130749
	iters: 100, epoch: 8 | loss: 0.3025964
	speed: 0.0130s/iter; left time: 11.4140s
	iters: 200, epoch: 8 | loss: 0.6618289
	speed: 0.0037s/iter; left time: 2.8866s
	iters: 300, epoch: 8 | loss: 0.7217215
	speed: 0.0038s/iter; left time: 2.5616s
	iters: 400, epoch: 8 | loss: 0.3824433
	speed: 0.0037s/iter; left time: 2.1657s
	iters: 500, epoch: 8 | loss: 0.4106942
	speed: 0.0038s/iter; left time: 1.8218s
	iters: 600, epoch: 8 | loss: 1.0252562
	speed: 0.0039s/iter; left time: 1.4823s
	iters: 700, epoch: 8 | loss: 0.2668099
	speed: 0.0040s/iter; left time: 1.1162s
	iters: 800, epoch: 8 | loss: 0.2653801
	speed: 0.0039s/iter; left time: 0.6956s
	iters: 900, epoch: 8 | loss: 1.1085063
	speed: 0.0040s/iter; left time: 0.3195s
Updating learning rate to 0.0
Validation loss decreased (0.6131 --> 0.6068).  Saving model state dict ...
Epoch: 8 cost time: 3.8063313961029053
Epoch: 8, Steps: 979 | Train Loss: 0.5716930 Vali Loss: 0.6067837 Best vali loss: 0.6067837

best validation loss 0.6067837324960538

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8983675
	speed: 0.0106s/iter; left time: 81.9252s
	iters: 200, epoch: 1 | loss: 0.5991769
	speed: 0.0043s/iter; left time: 33.0917s
	iters: 300, epoch: 1 | loss: 0.5977255
	speed: 0.0043s/iter; left time: 32.1542s
	iters: 400, epoch: 1 | loss: 0.9234383
	speed: 0.0043s/iter; left time: 31.8478s
	iters: 500, epoch: 1 | loss: 0.5923854
	speed: 0.0043s/iter; left time: 31.4426s
	iters: 600, epoch: 1 | loss: 1.0472348
	speed: 0.0043s/iter; left time: 31.0824s
	iters: 700, epoch: 1 | loss: 1.0023868
	speed: 0.0045s/iter; left time: 31.8107s
	iters: 800, epoch: 1 | loss: 0.5145205
	speed: 0.0045s/iter; left time: 31.3526s
	iters: 900, epoch: 1 | loss: 0.8841919
	speed: 0.0044s/iter; left time: 30.6583s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6365).  Saving model state dict ...
Epoch: 1 cost time: 4.578880310058594
Epoch: 1, Steps: 979 | Train Loss: 0.7843808 Vali Loss: 0.6364931 Best vali loss: 0.6364931
	iters: 100, epoch: 2 | loss: 0.8566873
	speed: 0.0134s/iter; left time: 90.4319s
	iters: 200, epoch: 2 | loss: 0.5437399
	speed: 0.0042s/iter; left time: 27.9871s
	iters: 300, epoch: 2 | loss: 0.4482551
	speed: 0.0039s/iter; left time: 25.3638s
	iters: 400, epoch: 2 | loss: 0.5586925
	speed: 0.0040s/iter; left time: 25.7622s
	iters: 500, epoch: 2 | loss: 0.6710249
	speed: 0.0039s/iter; left time: 24.8585s
	iters: 600, epoch: 2 | loss: 0.6806950
	speed: 0.0039s/iter; left time: 24.1215s
	iters: 700, epoch: 2 | loss: 0.4682932
	speed: 0.0038s/iter; left time: 23.5594s
	iters: 800, epoch: 2 | loss: 1.3169670
	speed: 0.0038s/iter; left time: 23.1846s
	iters: 900, epoch: 2 | loss: 0.3893936
	speed: 0.0038s/iter; left time: 22.8286s
Updating learning rate to 0.0002542168065605627
Epoch: 2 cost time: 3.9183192253112793
Epoch: 2, Steps: 979 | Train Loss: 0.6593054 Vali Loss: 0.6394440 Best vali loss: 0.6364931
	iters: 100, epoch: 3 | loss: 1.2793769
	speed: 0.0130s/iter; left time: 74.8102s
	iters: 200, epoch: 3 | loss: 0.2625794
	speed: 0.0038s/iter; left time: 21.7114s
	iters: 300, epoch: 3 | loss: 0.4922199
	speed: 0.0038s/iter; left time: 21.4202s
	iters: 400, epoch: 3 | loss: 1.1893228
	speed: 0.0040s/iter; left time: 21.6620s
	iters: 500, epoch: 3 | loss: 0.8788868
	speed: 0.0039s/iter; left time: 21.0239s
	iters: 600, epoch: 3 | loss: 0.7836120
	speed: 0.0040s/iter; left time: 21.3032s
	iters: 700, epoch: 3 | loss: 0.9335378
	speed: 0.0039s/iter; left time: 19.9805s
	iters: 800, epoch: 3 | loss: 0.6553177
	speed: 0.0040s/iter; left time: 20.1376s
	iters: 900, epoch: 3 | loss: 0.7640467
	speed: 0.0038s/iter; left time: 19.1189s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6365 --> 0.6232).  Saving model state dict ...
Epoch: 3 cost time: 3.881110906600952
Epoch: 3, Steps: 979 | Train Loss: 0.8043222 Vali Loss: 0.6232034 Best vali loss: 0.6232034

best validation loss 0.6232034207659152

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0018258606945, 'e_layers': 4, 'learning_rate': 0.0003552315203, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7770532
	speed: 0.0113s/iter; left time: 43.2146s
	iters: 200, epoch: 1 | loss: 0.9667913
	speed: 0.0053s/iter; left time: 19.6940s
	iters: 300, epoch: 1 | loss: 0.7142649
	speed: 0.0054s/iter; left time: 19.4247s
	iters: 400, epoch: 1 | loss: 0.7344939
	speed: 0.0054s/iter; left time: 18.9861s
Updating learning rate to 0.0003417113256040188
Validation loss decreased (inf --> 0.6093).  Saving model state dict ...
Epoch: 1 cost time: 2.9352846145629883
Epoch: 1, Steps: 490 | Train Loss: 0.7981508 Vali Loss: 0.6092632 Best vali loss: 0.6092632
	iters: 100, epoch: 2 | loss: 0.7897302
	speed: 0.0138s/iter; left time: 45.8606s
	iters: 200, epoch: 2 | loss: 0.7610635
	speed: 0.0049s/iter; left time: 15.9423s
	iters: 300, epoch: 2 | loss: 1.1244928
	speed: 0.0050s/iter; left time: 15.6400s
	iters: 400, epoch: 2 | loss: 0.7725989
	speed: 0.0050s/iter; left time: 15.1672s
Updating learning rate to 0.0003032090685976683
Epoch: 2 cost time: 2.5010952949523926
Epoch: 2, Steps: 490 | Train Loss: 0.8619713 Vali Loss: 0.6093462 Best vali loss: 0.6092632
	iters: 100, epoch: 3 | loss: 1.3243728
	speed: 0.0136s/iter; left time: 38.5489s
	iters: 200, epoch: 3 | loss: 1.1526914
	speed: 0.0050s/iter; left time: 13.6595s
	iters: 300, epoch: 3 | loss: 0.8334486
	speed: 0.0050s/iter; left time: 13.1956s
	iters: 400, epoch: 3 | loss: 1.1311830
	speed: 0.0049s/iter; left time: 12.3454s
Updating learning rate to 0.0002455863688863365
Validation loss decreased (0.6093 --> 0.5768).  Saving model state dict ...
Epoch: 3 cost time: 2.475022315979004
Epoch: 3, Steps: 490 | Train Loss: 1.1104240 Vali Loss: 0.5767912 Best vali loss: 0.5767912

best validation loss 0.5767911871182373

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010496128093, 'e_layers': 3, 'learning_rate': 0.0002979115343, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7358638
	speed: 0.0142s/iter; left time: 12.5908s
Updating learning rate to 0.0002865729516694021
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 1.3382644653320312
Epoch: 1, Steps: 123 | Train Loss: 0.7358638 Vali Loss: 0.6090031 Best vali loss: 0.6090031
	iters: 100, epoch: 2 | loss: 1.1305026
	speed: 0.0127s/iter; left time: 9.7032s
Updating learning rate to 0.0002542834001986094
Validation loss decreased (0.6090 --> 0.5657).  Saving model state dict ...
Epoch: 2 cost time: 1.0386462211608887
Epoch: 2, Steps: 123 | Train Loss: 1.1305026 Vali Loss: 0.5656563 Best vali loss: 0.5656563
	iters: 100, epoch: 3 | loss: 0.8600213
	speed: 0.0130s/iter; left time: 8.3092s
Updating learning rate to 0.0002059586713935371
Epoch: 3 cost time: 1.040750503540039
Epoch: 3, Steps: 123 | Train Loss: 0.8600213 Vali Loss: 0.5682419 Best vali loss: 0.5656563

best validation loss 0.5656562676478293

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010496128093, 'e_layers': 3, 'learning_rate': 0.0002979115343, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6438655
	speed: 0.0147s/iter; left time: 7.5937s
Updating learning rate to 0.00014895576715
Validation loss decreased (0.5657 --> 0.5480).  Saving model state dict ...
Epoch: 4 cost time: 1.3401682376861572
Epoch: 4, Steps: 123 | Train Loss: 0.6438655 Vali Loss: 0.5479603 Best vali loss: 0.5479603
	iters: 100, epoch: 5 | loss: 0.9409155
	speed: 0.0129s/iter; left time: 5.0749s
Updating learning rate to 9.195286290646292e-05
Epoch: 5 cost time: 1.0352509021759033
Epoch: 5, Steps: 123 | Train Loss: 0.9409155 Vali Loss: 0.5632043 Best vali loss: 0.5479603
	iters: 100, epoch: 6 | loss: 0.7783162
	speed: 0.0124s/iter; left time: 3.3607s
Updating learning rate to 4.362813410139064e-05
Epoch: 6 cost time: 1.0304465293884277
Epoch: 6, Steps: 123 | Train Loss: 0.7783162 Vali Loss: 0.5956330 Best vali loss: 0.5479603
	iters: 100, epoch: 7 | loss: 0.5723951
	speed: 0.0124s/iter; left time: 1.8268s
Updating learning rate to 1.1338582630597919e-05
Epoch: 7 cost time: 1.0331799983978271
Epoch: 7, Steps: 123 | Train Loss: 0.5723951 Vali Loss: 0.5991855 Best vali loss: 0.5479603
	iters: 100, epoch: 8 | loss: 0.5831077
	speed: 0.0124s/iter; left time: 0.2966s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0291469097137451
Epoch: 8, Steps: 123 | Train Loss: 0.5831077 Vali Loss: 0.5983252 Best vali loss: 0.5479603

best validation loss 0.5479602567965319

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010441802697, 'e_layers': 3, 'learning_rate': 0.000292913088, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9008877
	speed: 0.0104s/iter; left time: 80.3959s
	iters: 200, epoch: 1 | loss: 0.5931830
	speed: 0.0044s/iter; left time: 33.2828s
	iters: 300, epoch: 1 | loss: 0.5797365
	speed: 0.0044s/iter; left time: 33.0293s
	iters: 400, epoch: 1 | loss: 0.9458215
	speed: 0.0042s/iter; left time: 30.9682s
	iters: 500, epoch: 1 | loss: 0.5765740
	speed: 0.0041s/iter; left time: 30.3623s
	iters: 600, epoch: 1 | loss: 0.9332557
	speed: 0.0041s/iter; left time: 29.9760s
	iters: 700, epoch: 1 | loss: 1.0253440
	speed: 0.0041s/iter; left time: 29.1129s
	iters: 800, epoch: 1 | loss: 0.5200822
	speed: 0.0040s/iter; left time: 28.0548s
	iters: 900, epoch: 1 | loss: 0.8863723
	speed: 0.0040s/iter; left time: 27.7969s
Updating learning rate to 0.0002817647474039387
Validation loss decreased (inf --> 0.6243).  Saving model state dict ...
Epoch: 1 cost time: 4.430933952331543
Epoch: 1, Steps: 979 | Train Loss: 0.7734730 Vali Loss: 0.6243079 Best vali loss: 0.6243079
	iters: 100, epoch: 2 | loss: 0.8181143
	speed: 0.0138s/iter; left time: 93.0460s
	iters: 200, epoch: 2 | loss: 0.5298236
	speed: 0.0043s/iter; left time: 28.5415s
	iters: 300, epoch: 2 | loss: 0.6462705
	speed: 0.0043s/iter; left time: 28.0129s
	iters: 400, epoch: 2 | loss: 0.5062513
	speed: 0.0042s/iter; left time: 27.2487s
	iters: 500, epoch: 2 | loss: 0.6028830
	speed: 0.0042s/iter; left time: 26.7932s
	iters: 600, epoch: 2 | loss: 0.6728271
	speed: 0.0041s/iter; left time: 25.8153s
	iters: 700, epoch: 2 | loss: 0.4053311
	speed: 0.0043s/iter; left time: 26.1614s
	iters: 800, epoch: 2 | loss: 1.2169411
	speed: 0.0044s/iter; left time: 26.6182s
	iters: 900, epoch: 2 | loss: 0.3604875
	speed: 0.0044s/iter; left time: 26.0185s
Updating learning rate to 0.00025001695941154596
Epoch: 2 cost time: 4.256181478500366
Epoch: 2, Steps: 979 | Train Loss: 0.6398810 Vali Loss: 0.6247409 Best vali loss: 0.6243079
	iters: 100, epoch: 3 | loss: 1.2752850
	speed: 0.0135s/iter; left time: 78.1739s
	iters: 200, epoch: 3 | loss: 0.2517932
	speed: 0.0044s/iter; left time: 25.0603s
	iters: 300, epoch: 3 | loss: 0.5229387
	speed: 0.0045s/iter; left time: 24.9268s
	iters: 400, epoch: 3 | loss: 1.1949853
	speed: 0.0045s/iter; left time: 24.5552s
	iters: 500, epoch: 3 | loss: 0.8652129
	speed: 0.0044s/iter; left time: 23.4588s
	iters: 600, epoch: 3 | loss: 0.7680991
	speed: 0.0044s/iter; left time: 23.1061s
	iters: 700, epoch: 3 | loss: 0.9165159
	speed: 0.0044s/iter; left time: 23.0057s
	iters: 800, epoch: 3 | loss: 0.6465953
	speed: 0.0044s/iter; left time: 22.5421s
	iters: 900, epoch: 3 | loss: 0.7256255
	speed: 0.0041s/iter; left time: 20.6103s
Updating learning rate to 0.00020250303695024878
Validation loss decreased (0.6243 --> 0.6103).  Saving model state dict ...
Epoch: 3 cost time: 4.321120023727417
Epoch: 3, Steps: 979 | Train Loss: 0.7963390 Vali Loss: 0.6103148 Best vali loss: 0.6103148
	iters: 100, epoch: 4 | loss: 0.5475360
	speed: 0.0138s/iter; left time: 66.1775s
	iters: 200, epoch: 4 | loss: 1.0586516
	speed: 0.0043s/iter; left time: 20.0898s
	iters: 300, epoch: 4 | loss: 1.0682099
	speed: 0.0043s/iter; left time: 19.5929s
	iters: 400, epoch: 4 | loss: 1.3854263
	speed: 0.0043s/iter; left time: 19.5306s
	iters: 500, epoch: 4 | loss: 2.1957705
	speed: 0.0043s/iter; left time: 18.8692s
	iters: 600, epoch: 4 | loss: 0.9890733
	speed: 0.0045s/iter; left time: 19.1221s
	iters: 700, epoch: 4 | loss: 0.3031110
	speed: 0.0044s/iter; left time: 18.5443s
	iters: 800, epoch: 4 | loss: 0.4734428
	speed: 0.0044s/iter; left time: 18.0433s
	iters: 900, epoch: 4 | loss: 0.3764288
	speed: 0.0044s/iter; left time: 17.5844s
Updating learning rate to 0.000146456544
Epoch: 4 cost time: 4.284103631973267
Epoch: 4, Steps: 979 | Train Loss: 0.9330722 Vali Loss: 0.6106415 Best vali loss: 0.6103148
	iters: 100, epoch: 5 | loss: 0.6294346
	speed: 0.0132s/iter; left time: 50.5255s
	iters: 200, epoch: 5 | loss: 0.5629616
	speed: 0.0043s/iter; left time: 15.9100s
	iters: 300, epoch: 5 | loss: 0.9541056
	speed: 0.0041s/iter; left time: 14.9689s
	iters: 400, epoch: 5 | loss: 0.2746191
	speed: 0.0042s/iter; left time: 14.8014s
	iters: 500, epoch: 5 | loss: 0.5735687
	speed: 0.0041s/iter; left time: 14.0946s
	iters: 600, epoch: 5 | loss: 0.8314252
	speed: 0.0039s/iter; left time: 12.9778s
	iters: 700, epoch: 5 | loss: 1.9099125
	speed: 0.0039s/iter; left time: 12.6048s
	iters: 800, epoch: 5 | loss: 0.4670742
	speed: 0.0041s/iter; left time: 12.7471s
	iters: 900, epoch: 5 | loss: 0.9425490
	speed: 0.0041s/iter; left time: 12.2263s
Updating learning rate to 9.04100510497512e-05
Epoch: 5 cost time: 4.044703245162964
Epoch: 5, Steps: 979 | Train Loss: 0.7939612 Vali Loss: 0.6133355 Best vali loss: 0.6103148
	iters: 100, epoch: 6 | loss: 0.5861000
	speed: 0.0131s/iter; left time: 37.1858s
	iters: 200, epoch: 6 | loss: 1.2590537
	speed: 0.0044s/iter; left time: 12.1075s
	iters: 300, epoch: 6 | loss: 0.4713115
	speed: 0.0045s/iter; left time: 11.8152s
	iters: 400, epoch: 6 | loss: 0.8625936
	speed: 0.0045s/iter; left time: 11.3320s
	iters: 500, epoch: 6 | loss: 0.5019835
	speed: 0.0045s/iter; left time: 10.9668s
	iters: 600, epoch: 6 | loss: 0.3124263
	speed: 0.0044s/iter; left time: 10.3843s
	iters: 700, epoch: 6 | loss: 0.9845841
	speed: 0.0043s/iter; left time: 9.6725s
	iters: 800, epoch: 6 | loss: 0.3160535
	speed: 0.0045s/iter; left time: 9.6338s
	iters: 900, epoch: 6 | loss: 1.4933490
	speed: 0.0044s/iter; left time: 9.0311s
Updating learning rate to 4.289612858845404e-05
Epoch: 6 cost time: 4.362616777420044
Epoch: 6, Steps: 979 | Train Loss: 0.7541617 Vali Loss: 0.6323591 Best vali loss: 0.6103148
	iters: 100, epoch: 7 | loss: 0.4209144
	speed: 0.0138s/iter; left time: 25.7136s
	iters: 200, epoch: 7 | loss: 0.9274173
	speed: 0.0043s/iter; left time: 7.6486s
	iters: 300, epoch: 7 | loss: 0.5636135
	speed: 0.0042s/iter; left time: 7.0420s
	iters: 400, epoch: 7 | loss: 0.9708562
	speed: 0.0043s/iter; left time: 6.6448s
	iters: 500, epoch: 7 | loss: 1.2105638
	speed: 0.0043s/iter; left time: 6.2470s
	iters: 600, epoch: 7 | loss: 0.7378963
	speed: 0.0044s/iter; left time: 6.0217s
	iters: 700, epoch: 7 | loss: 0.3804994
	speed: 0.0045s/iter; left time: 5.7252s
	iters: 800, epoch: 7 | loss: 0.9384283
	speed: 0.0046s/iter; left time: 5.2773s
	iters: 900, epoch: 7 | loss: 0.6921396
	speed: 0.0046s/iter; left time: 4.8827s
Updating learning rate to 1.1148340596061302e-05
Epoch: 7 cost time: 4.366628646850586
Epoch: 7, Steps: 979 | Train Loss: 0.7602588 Vali Loss: 0.6262653 Best vali loss: 0.6103148
	iters: 100, epoch: 8 | loss: 0.2772868
	speed: 0.0139s/iter; left time: 12.2204s
	iters: 200, epoch: 8 | loss: 0.6409917
	speed: 0.0045s/iter; left time: 3.4718s
	iters: 300, epoch: 8 | loss: 0.7192740
	speed: 0.0044s/iter; left time: 2.9622s
	iters: 400, epoch: 8 | loss: 0.3945471
	speed: 0.0044s/iter; left time: 2.5544s
	iters: 500, epoch: 8 | loss: 0.4135303
	speed: 0.0044s/iter; left time: 2.1166s
	iters: 600, epoch: 8 | loss: 0.7783510
	speed: 0.0045s/iter; left time: 1.7274s
	iters: 700, epoch: 8 | loss: 0.2379931
	speed: 0.0044s/iter; left time: 1.2376s
	iters: 800, epoch: 8 | loss: 0.2604228
	speed: 0.0043s/iter; left time: 0.7829s
	iters: 900, epoch: 8 | loss: 1.1889360
	speed: 0.0042s/iter; left time: 0.3371s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.340415954589844
Epoch: 8, Steps: 979 | Train Loss: 0.5457036 Vali Loss: 0.6270646 Best vali loss: 0.6103148

best validation loss 0.6103148434047398

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6186935
	speed: 0.0137s/iter; left time: 12.1467s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6147).  Saving model state dict ...
Epoch: 1 cost time: 1.2766575813293457
Epoch: 1, Steps: 123 | Train Loss: 0.6186935 Vali Loss: 0.6147271 Best vali loss: 0.6147271
	iters: 100, epoch: 2 | loss: 0.7200728
	speed: 0.0122s/iter; left time: 9.2782s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6147 --> 0.5916).  Saving model state dict ...
Epoch: 2 cost time: 0.9951152801513672
Epoch: 2, Steps: 123 | Train Loss: 0.7200728 Vali Loss: 0.5916000 Best vali loss: 0.5916000
	iters: 100, epoch: 3 | loss: 0.6348609
	speed: 0.0126s/iter; left time: 8.0478s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5916 --> 0.5324).  Saving model state dict ...
Epoch: 3 cost time: 1.0024003982543945
Epoch: 3, Steps: 123 | Train Loss: 0.6348609 Vali Loss: 0.5324225 Best vali loss: 0.5324225
	iters: 100, epoch: 4 | loss: 0.8570705
	speed: 0.0124s/iter; left time: 6.3861s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5324 --> 0.5323).  Saving model state dict ...
Epoch: 4 cost time: 0.9905359745025635
Epoch: 4, Steps: 123 | Train Loss: 0.8570705 Vali Loss: 0.5322897 Best vali loss: 0.5322897
	iters: 100, epoch: 5 | loss: 0.6715804
	speed: 0.0125s/iter; left time: 4.8945s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5323 --> 0.5256).  Saving model state dict ...
Epoch: 5 cost time: 0.9991097450256348
Epoch: 5, Steps: 123 | Train Loss: 0.6715804 Vali Loss: 0.5256101 Best vali loss: 0.5256101
	iters: 100, epoch: 6 | loss: 0.4281190
	speed: 0.0123s/iter; left time: 3.3268s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.9985148906707764
Epoch: 6, Steps: 123 | Train Loss: 0.4281190 Vali Loss: 0.5414144 Best vali loss: 0.5256101
	iters: 100, epoch: 7 | loss: 0.7751223
	speed: 0.0119s/iter; left time: 1.7508s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.9961955547332764
Epoch: 7, Steps: 123 | Train Loss: 0.7751223 Vali Loss: 0.5409761 Best vali loss: 0.5256101
	iters: 100, epoch: 8 | loss: 0.6697902
	speed: 0.0120s/iter; left time: 0.2873s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9965023994445801
Epoch: 8, Steps: 123 | Train Loss: 0.6697902 Vali Loss: 0.5450660 Best vali loss: 0.5256101

best validation loss 0.5256100687259108

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442963919, 'e_layers': 2, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7746023
	speed: 0.0115s/iter; left time: 10.1704s
Updating learning rate to 0.00028656042375066227
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0115411281585693
Epoch: 1, Steps: 123 | Train Loss: 0.7746023 Vali Loss: 0.6171538 Best vali loss: 0.6171538
	iters: 100, epoch: 2 | loss: 0.9519194
	speed: 0.0091s/iter; left time: 6.9614s
Updating learning rate to 0.0002542722838606716
Validation loss decreased (0.6172 --> 0.6015).  Saving model state dict ...
Epoch: 2 cost time: 0.7209491729736328
Epoch: 2, Steps: 123 | Train Loss: 0.9519194 Vali Loss: 0.6015197 Best vali loss: 0.6015197
	iters: 100, epoch: 3 | loss: 0.8426580
	speed: 0.0092s/iter; left time: 5.9079s
Updating learning rate to 0.0002059496676355622
Validation loss decreased (0.6015 --> 0.5459).  Saving model state dict ...
Epoch: 3 cost time: 0.7282402515411377
Epoch: 3, Steps: 123 | Train Loss: 0.8426580 Vali Loss: 0.5458681 Best vali loss: 0.5458681

best validation loss 0.54586805849371

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4488580
	speed: 0.0114s/iter; left time: 43.6103s
	iters: 200, epoch: 1 | loss: 1.0155113
	speed: 0.0055s/iter; left time: 20.4173s
	iters: 300, epoch: 1 | loss: 1.1276838
	speed: 0.0055s/iter; left time: 20.0619s
	iters: 400, epoch: 1 | loss: 0.4916812
	speed: 0.0054s/iter; left time: 19.1404s
Updating learning rate to 7.464840260592189e-05
Validation loss decreased (inf --> 0.5877).  Saving model state dict ...
Epoch: 1 cost time: 2.995535373687744
Epoch: 1, Steps: 490 | Train Loss: 0.7709336 Vali Loss: 0.5876838 Best vali loss: 0.5876838
	iters: 100, epoch: 2 | loss: 1.0814559
	speed: 0.0144s/iter; left time: 47.9521s
	iters: 200, epoch: 2 | loss: 0.7068046
	speed: 0.0052s/iter; left time: 16.9254s
	iters: 300, epoch: 2 | loss: 1.1761651
	speed: 0.0051s/iter; left time: 16.0427s
	iters: 400, epoch: 2 | loss: 0.9413446
	speed: 0.0053s/iter; left time: 16.0938s
Updating learning rate to 6.623740839270309e-05
Validation loss decreased (0.5877 --> 0.5791).  Saving model state dict ...
Epoch: 2 cost time: 2.6137404441833496
Epoch: 2, Steps: 490 | Train Loss: 0.9764426 Vali Loss: 0.5790685 Best vali loss: 0.5790685
	iters: 100, epoch: 3 | loss: 0.8701695
	speed: 0.0141s/iter; left time: 40.0583s
	iters: 200, epoch: 3 | loss: 1.0203592
	speed: 0.0053s/iter; left time: 14.6404s
	iters: 300, epoch: 3 | loss: 0.5881769
	speed: 0.0053s/iter; left time: 13.9797s
	iters: 400, epoch: 3 | loss: 0.6276909
	speed: 0.0053s/iter; left time: 13.4477s
Updating learning rate to 5.3649465983453756e-05
Validation loss decreased (0.5791 --> 0.5664).  Saving model state dict ...
Epoch: 3 cost time: 2.6326072216033936
Epoch: 3, Steps: 490 | Train Loss: 0.7765991 Vali Loss: 0.5664227 Best vali loss: 0.5664227

best validation loss 0.5664227230785512

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010468985501, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744345
	speed: 0.0116s/iter; left time: 10.2241s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0127182006835938
Epoch: 1, Steps: 123 | Train Loss: 0.7744345 Vali Loss: 0.6172906 Best vali loss: 0.6172906
	iters: 100, epoch: 2 | loss: 0.9538522
	speed: 0.0091s/iter; left time: 6.9443s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5970).  Saving model state dict ...
Epoch: 2 cost time: 0.7137701511383057
Epoch: 2, Steps: 123 | Train Loss: 0.9538522 Vali Loss: 0.5969538 Best vali loss: 0.5969538
	iters: 100, epoch: 3 | loss: 0.8536800
	speed: 0.0093s/iter; left time: 5.9674s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5970 --> 0.5546).  Saving model state dict ...
Epoch: 3 cost time: 0.7219500541687012
Epoch: 3, Steps: 123 | Train Loss: 0.8536800 Vali Loss: 0.5545851 Best vali loss: 0.5545851

best validation loss 0.5545851038540475

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442963919, 'e_layers': 2, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5836552
	speed: 0.0119s/iter; left time: 6.1174s
Updating learning rate to 0.00014894925535
Validation loss decreased (0.5459 --> 0.5294).  Saving model state dict ...
Epoch: 4 cost time: 1.0139625072479248
Epoch: 4, Steps: 123 | Train Loss: 0.5836552 Vali Loss: 0.5294353 Best vali loss: 0.5294353
	iters: 100, epoch: 5 | loss: 0.8209971
	speed: 0.0093s/iter; left time: 3.6402s
Updating learning rate to 9.19488430644378e-05
Epoch: 5 cost time: 0.7219314575195312
Epoch: 5, Steps: 123 | Train Loss: 0.8209971 Vali Loss: 0.5301164 Best vali loss: 0.5294353
	iters: 100, epoch: 6 | loss: 0.7610666
	speed: 0.0091s/iter; left time: 2.4458s
Updating learning rate to 4.362622683932836e-05
Epoch: 6 cost time: 0.719656229019165
Epoch: 6, Steps: 123 | Train Loss: 0.7610666 Vali Loss: 0.5360701 Best vali loss: 0.5294353
	iters: 100, epoch: 7 | loss: 0.4273873
	speed: 0.0091s/iter; left time: 1.3369s
Updating learning rate to 1.1338086949337725e-05
Epoch: 7 cost time: 0.719865083694458
Epoch: 7, Steps: 123 | Train Loss: 0.4273873 Vali Loss: 0.5389559 Best vali loss: 0.5294353
	iters: 100, epoch: 8 | loss: 0.5038233
	speed: 0.0089s/iter; left time: 0.2144s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7142226696014404
Epoch: 8, Steps: 123 | Train Loss: 0.5038233 Vali Loss: 0.5426641 Best vali loss: 0.5294353

best validation loss 0.5294352738408235

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010491368168, 'e_layers': 3, 'learning_rate': 0.000305083139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6177232
	speed: 0.0138s/iter; left time: 12.2113s
Updating learning rate to 0.00029347160341819796
Validation loss decreased (inf --> 0.6177).  Saving model state dict ...
Epoch: 1 cost time: 1.2925450801849365
Epoch: 1, Steps: 123 | Train Loss: 0.6177232 Vali Loss: 0.6177413 Best vali loss: 0.6177413
	iters: 100, epoch: 2 | loss: 0.7406162
	speed: 0.0124s/iter; left time: 9.4256s
Updating learning rate to 0.000260404747706289
Validation loss decreased (0.6177 --> 0.5626).  Saving model state dict ...
Epoch: 2 cost time: 1.0071487426757812
Epoch: 2, Steps: 123 | Train Loss: 0.7406162 Vali Loss: 0.5626089 Best vali loss: 0.5626089
	iters: 100, epoch: 3 | loss: 0.6243684
	speed: 0.0126s/iter; left time: 8.0624s
Updating learning rate to 0.00021091670089461788
Validation loss decreased (0.5626 --> 0.5543).  Saving model state dict ...
Epoch: 3 cost time: 1.0001206398010254
Epoch: 3, Steps: 123 | Train Loss: 0.6243684 Vali Loss: 0.5542698 Best vali loss: 0.5542698
	iters: 100, epoch: 4 | loss: 0.8545228
	speed: 0.0125s/iter; left time: 6.4559s
Updating learning rate to 0.0001525415695
Validation loss decreased (0.5543 --> 0.5372).  Saving model state dict ...
Epoch: 4 cost time: 0.999793291091919
Epoch: 4, Steps: 123 | Train Loss: 0.8545228 Vali Loss: 0.5372015 Best vali loss: 0.5372015
	iters: 100, epoch: 5 | loss: 0.6716495
	speed: 0.0126s/iter; left time: 4.9542s
Updating learning rate to 9.416643810538211e-05
Validation loss decreased (0.5372 --> 0.5274).  Saving model state dict ...
Epoch: 5 cost time: 1.0029516220092773
Epoch: 5, Steps: 123 | Train Loss: 0.6716495 Vali Loss: 0.5273743 Best vali loss: 0.5273743
	iters: 100, epoch: 6 | loss: 0.4296112
	speed: 0.0123s/iter; left time: 3.3322s
Updating learning rate to 4.4678391293710976e-05
Epoch: 6 cost time: 0.9964842796325684
Epoch: 6, Steps: 123 | Train Loss: 0.4296112 Vali Loss: 0.5391943 Best vali loss: 0.5273743
	iters: 100, epoch: 7 | loss: 0.7799775
	speed: 0.0120s/iter; left time: 1.7640s
Updating learning rate to 1.1611535581802044e-05
Epoch: 7 cost time: 0.9997203350067139
Epoch: 7, Steps: 123 | Train Loss: 0.7799775 Vali Loss: 0.5452143 Best vali loss: 0.5273743
	iters: 100, epoch: 8 | loss: 0.6565139
	speed: 0.0120s/iter; left time: 0.2888s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9992244243621826
Epoch: 8, Steps: 123 | Train Loss: 0.6565139 Vali Loss: 0.5444085 Best vali loss: 0.5273743

best validation loss 0.5273743355125258

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010516213274, 'e_layers': 2, 'learning_rate': 0.0002978403325, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744502
	speed: 0.0116s/iter; left time: 10.2516s
Updating learning rate to 0.00028650445982655306
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0243592262268066
Epoch: 1, Steps: 123 | Train Loss: 0.7744502 Vali Loss: 0.6173135 Best vali loss: 0.6173135
	iters: 100, epoch: 2 | loss: 0.9538156
	speed: 0.0092s/iter; left time: 6.9950s
Updating learning rate to 0.000254222625660803
Validation loss decreased (0.6173 --> 0.5624).  Saving model state dict ...
Epoch: 2 cost time: 0.7242522239685059
Epoch: 2, Steps: 123 | Train Loss: 0.9538156 Vali Loss: 0.5624350 Best vali loss: 0.5624350
	iters: 100, epoch: 3 | loss: 0.8609933
	speed: 0.0093s/iter; left time: 5.9477s
Updating learning rate to 0.0002059094466189298
Validation loss decreased (0.5624 --> 0.5409).  Saving model state dict ...
Epoch: 3 cost time: 0.7141923904418945
Epoch: 3, Steps: 123 | Train Loss: 0.8609933 Vali Loss: 0.5408681 Best vali loss: 0.5408681
	iters: 100, epoch: 4 | loss: 0.4899691
	speed: 0.0092s/iter; left time: 4.7380s
Updating learning rate to 0.00014892016625
Validation loss decreased (0.5409 --> 0.5334).  Saving model state dict ...
Epoch: 4 cost time: 0.7207615375518799
Epoch: 4, Steps: 123 | Train Loss: 0.4899691 Vali Loss: 0.5334455 Best vali loss: 0.5334455
	iters: 100, epoch: 5 | loss: 0.5612391
	speed: 0.0092s/iter; left time: 3.6060s
Updating learning rate to 9.19308858810702e-05
Validation loss decreased (0.5334 --> 0.5245).  Saving model state dict ...
Epoch: 5 cost time: 0.7229056358337402
Epoch: 5, Steps: 123 | Train Loss: 0.5612391 Vali Loss: 0.5244515 Best vali loss: 0.5244515
	iters: 100, epoch: 6 | loss: 0.5893496
	speed: 0.0093s/iter; left time: 2.5075s
Updating learning rate to 4.3617706839196975e-05
Epoch: 6 cost time: 0.7169384956359863
Epoch: 6, Steps: 123 | Train Loss: 0.5893496 Vali Loss: 0.5371495 Best vali loss: 0.5244515
	iters: 100, epoch: 7 | loss: 0.5440267
	speed: 0.0090s/iter; left time: 1.3238s
Updating learning rate to 1.1335872673446898e-05
Epoch: 7 cost time: 0.7245121002197266
Epoch: 7, Steps: 123 | Train Loss: 0.5440267 Vali Loss: 0.5336626 Best vali loss: 0.5244515
	iters: 100, epoch: 8 | loss: 0.6982543
	speed: 0.0090s/iter; left time: 0.2167s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.713259220123291
Epoch: 8, Steps: 123 | Train Loss: 0.6982543 Vali Loss: 0.5444966 Best vali loss: 0.5244515

best validation loss 0.5244515111246687

[INFO][abstract_intensifier.py:595] Added config eceebc and rejected config c1c3e7 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010476133154, 'e_layers': 3, 'learning_rate': 0.0003134590432, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6173720
	speed: 0.0139s/iter; left time: 12.3457s
Updating learning rate to 0.0003015287187465256
Validation loss decreased (inf --> 0.5965).  Saving model state dict ...
Epoch: 1 cost time: 1.306659460067749
Epoch: 1, Steps: 123 | Train Loss: 0.6173720 Vali Loss: 0.5965078 Best vali loss: 0.5965078
	iters: 100, epoch: 2 | loss: 0.7333810
	speed: 0.0124s/iter; left time: 9.4413s
Updating learning rate to 0.00026755402913548345
Validation loss decreased (0.5965 --> 0.5588).  Saving model state dict ...
Epoch: 2 cost time: 1.0059607028961182
Epoch: 2, Steps: 123 | Train Loss: 0.7333810 Vali Loss: 0.5587802 Best vali loss: 0.5587802
	iters: 100, epoch: 3 | loss: 0.6298387
	speed: 0.0125s/iter; left time: 7.9584s
Updating learning rate to 0.00021670731287882648
Validation loss decreased (0.5588 --> 0.5485).  Saving model state dict ...
Epoch: 3 cost time: 0.994706392288208
Epoch: 3, Steps: 123 | Train Loss: 0.6298387 Vali Loss: 0.5485218 Best vali loss: 0.5485218

best validation loss 0.5485218476774736

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010547756014, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6186414
	speed: 0.0138s/iter; left time: 12.1779s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6145).  Saving model state dict ...
Epoch: 1 cost time: 1.297358751296997
Epoch: 1, Steps: 123 | Train Loss: 0.6186414 Vali Loss: 0.6145344 Best vali loss: 0.6145344
	iters: 100, epoch: 2 | loss: 0.7164739
	speed: 0.0123s/iter; left time: 9.3751s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6145 --> 0.5836).  Saving model state dict ...
Epoch: 2 cost time: 1.0020935535430908
Epoch: 2, Steps: 123 | Train Loss: 0.7164739 Vali Loss: 0.5835867 Best vali loss: 0.5835867
	iters: 100, epoch: 3 | loss: 0.6456946
	speed: 0.0125s/iter; left time: 8.0107s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5836 --> 0.5408).  Saving model state dict ...
Epoch: 3 cost time: 1.0021917819976807
Epoch: 3, Steps: 123 | Train Loss: 0.6456946 Vali Loss: 0.5408000 Best vali loss: 0.5408000

best validation loss 0.5407999705407753

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010440035224, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8825197
	speed: 0.0103s/iter; left time: 19.1517s
	iters: 200, epoch: 1 | loss: 0.6446471
	speed: 0.0040s/iter; left time: 7.1131s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 1.3526954650878906
Epoch: 1, Steps: 245 | Train Loss: 0.7635834 Vali Loss: 0.6047622 Best vali loss: 0.6047622
	iters: 100, epoch: 2 | loss: 0.7397797
	speed: 0.0089s/iter; left time: 14.3249s
	iters: 200, epoch: 2 | loss: 0.8804385
	speed: 0.0040s/iter; left time: 6.0235s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6048 --> 0.5583).  Saving model state dict ...
Epoch: 2 cost time: 1.0392017364501953
Epoch: 2, Steps: 245 | Train Loss: 0.8101091 Vali Loss: 0.5583105 Best vali loss: 0.5583105
	iters: 100, epoch: 3 | loss: 0.7555698
	speed: 0.0089s/iter; left time: 12.2354s
	iters: 200, epoch: 3 | loss: 0.9019690
	speed: 0.0041s/iter; left time: 5.2361s
Updating learning rate to 0.00020590473339677975
Epoch: 3 cost time: 1.056593656539917
Epoch: 3, Steps: 245 | Train Loss: 0.8287694 Vali Loss: 0.5797854 Best vali loss: 0.5583105

best validation loss 0.5583105034874524

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010547756014, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5330709
	speed: 0.0145s/iter; left time: 7.4853s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5408 --> 0.5391).  Saving model state dict ...
Epoch: 4 cost time: 1.3195490837097168
Epoch: 4, Steps: 123 | Train Loss: 0.5330709 Vali Loss: 0.5391284 Best vali loss: 0.5391284
	iters: 100, epoch: 5 | loss: 0.6338259
	speed: 0.0126s/iter; left time: 4.9330s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5391 --> 0.5304).  Saving model state dict ...
Epoch: 5 cost time: 1.0053703784942627
Epoch: 5, Steps: 123 | Train Loss: 0.6338259 Vali Loss: 0.5304489 Best vali loss: 0.5304489
	iters: 100, epoch: 6 | loss: 0.5481823
	speed: 0.0127s/iter; left time: 3.4156s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 1.0071146488189697
Epoch: 6, Steps: 123 | Train Loss: 0.5481823 Vali Loss: 0.5305059 Best vali loss: 0.5304489
	iters: 100, epoch: 7 | loss: 0.7602766
	speed: 0.0120s/iter; left time: 1.7607s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.9971461296081543
Epoch: 7, Steps: 123 | Train Loss: 0.7602766 Vali Loss: 0.5463527 Best vali loss: 0.5304489
	iters: 100, epoch: 8 | loss: 0.6196152
	speed: 0.0120s/iter; left time: 0.2878s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0001072883605957
Epoch: 8, Steps: 123 | Train Loss: 0.6196152 Vali Loss: 0.5510856 Best vali loss: 0.5304489

best validation loss 0.5304488731942095

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0068284338186, 'e_layers': 3, 'learning_rate': 0.0033773752512, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5792127
	speed: 0.0105s/iter; left time: 81.2824s
	iters: 200, epoch: 1 | loss: 1.3514962
	speed: 0.0043s/iter; left time: 32.7519s
	iters: 300, epoch: 1 | loss: 0.9138895
	speed: 0.0044s/iter; left time: 32.7789s
	iters: 400, epoch: 1 | loss: 2.2739165
	speed: 0.0042s/iter; left time: 31.0674s
	iters: 500, epoch: 1 | loss: 0.5976573
	speed: 0.0039s/iter; left time: 28.4193s
	iters: 600, epoch: 1 | loss: 0.2961893
	speed: 0.0041s/iter; left time: 29.3617s
	iters: 700, epoch: 1 | loss: 0.7683784
	speed: 0.0040s/iter; left time: 28.8659s
	iters: 800, epoch: 1 | loss: 0.6087684
	speed: 0.0040s/iter; left time: 28.1174s
	iters: 900, epoch: 1 | loss: 0.6515518
	speed: 0.0040s/iter; left time: 27.7095s
Updating learning rate to 0.0033773752512
Validation loss decreased (inf --> 0.6294).  Saving model state dict ...
Epoch: 1 cost time: 4.36547064781189
Epoch: 1, Steps: 979 | Train Loss: 0.8934511 Vali Loss: 0.6293589 Best vali loss: 0.6293589
	iters: 100, epoch: 2 | loss: 0.9516756
	speed: 0.0128s/iter; left time: 86.3140s
	iters: 200, epoch: 2 | loss: 0.5565640
	speed: 0.0040s/iter; left time: 26.8659s
	iters: 300, epoch: 2 | loss: 1.3534461
	speed: 0.0040s/iter; left time: 26.0675s
	iters: 400, epoch: 2 | loss: 0.6338114
	speed: 0.0042s/iter; left time: 26.8727s
	iters: 500, epoch: 2 | loss: 2.0593889
	speed: 0.0042s/iter; left time: 26.6392s
	iters: 600, epoch: 2 | loss: 0.4485180
	speed: 0.0039s/iter; left time: 24.4544s
	iters: 700, epoch: 2 | loss: 0.7856531
	speed: 0.0037s/iter; left time: 22.6222s
	iters: 800, epoch: 2 | loss: 0.3320670
	speed: 0.0037s/iter; left time: 22.1444s
	iters: 900, epoch: 2 | loss: 0.2618158
	speed: 0.0036s/iter; left time: 21.5331s
Updating learning rate to 0.0016886876256
Epoch: 2 cost time: 3.8404147624969482
Epoch: 2, Steps: 979 | Train Loss: 0.8203266 Vali Loss: 0.6407183 Best vali loss: 0.6293589
	iters: 100, epoch: 3 | loss: 0.4912204
	speed: 0.0126s/iter; left time: 72.9985s
	iters: 200, epoch: 3 | loss: 0.3352371
	speed: 0.0038s/iter; left time: 21.6891s
	iters: 300, epoch: 3 | loss: 0.8173749
	speed: 0.0037s/iter; left time: 20.8422s
	iters: 400, epoch: 3 | loss: 0.4873146
	speed: 0.0036s/iter; left time: 19.8807s
	iters: 500, epoch: 3 | loss: 0.7754502
	speed: 0.0037s/iter; left time: 19.8870s
	iters: 600, epoch: 3 | loss: 1.1766082
	speed: 0.0039s/iter; left time: 20.5187s
	iters: 700, epoch: 3 | loss: 0.3452820
	speed: 0.0038s/iter; left time: 19.5795s
	iters: 800, epoch: 3 | loss: 1.0107242
	speed: 0.0038s/iter; left time: 19.2853s
	iters: 900, epoch: 3 | loss: 0.6591592
	speed: 0.0036s/iter; left time: 18.0157s
Updating learning rate to 0.0008443438128
Epoch: 3 cost time: 3.7136285305023193
Epoch: 3, Steps: 979 | Train Loss: 0.6775968 Vali Loss: 0.6412677 Best vali loss: 0.6293589
	iters: 100, epoch: 4 | loss: 0.4244230
	speed: 0.0130s/iter; left time: 62.5065s
	iters: 200, epoch: 4 | loss: 0.4829997
	speed: 0.0044s/iter; left time: 20.4698s
	iters: 300, epoch: 4 | loss: 0.8378948
	speed: 0.0038s/iter; left time: 17.5215s
	iters: 400, epoch: 4 | loss: 0.7514963
	speed: 0.0038s/iter; left time: 17.2956s
	iters: 500, epoch: 4 | loss: 0.5004711
	speed: 0.0039s/iter; left time: 17.1310s
	iters: 600, epoch: 4 | loss: 0.4519164
	speed: 0.0038s/iter; left time: 16.4186s
	iters: 700, epoch: 4 | loss: 0.3950554
	speed: 0.0038s/iter; left time: 16.1419s
	iters: 800, epoch: 4 | loss: 0.7110230
	speed: 0.0037s/iter; left time: 14.9889s
	iters: 900, epoch: 4 | loss: 0.6555620
	speed: 0.0037s/iter; left time: 14.7393s
Updating learning rate to 0.0004221719064
Epoch: 4 cost time: 3.861952543258667
Epoch: 4, Steps: 979 | Train Loss: 0.5789824 Vali Loss: 0.6402978 Best vali loss: 0.6293589
	iters: 100, epoch: 5 | loss: 1.2298030
	speed: 0.0131s/iter; left time: 50.1060s
	iters: 200, epoch: 5 | loss: 0.3958523
	speed: 0.0043s/iter; left time: 16.1504s
	iters: 300, epoch: 5 | loss: 1.1361129
	speed: 0.0044s/iter; left time: 15.8527s
	iters: 400, epoch: 5 | loss: 0.6204879
	speed: 0.0044s/iter; left time: 15.3823s
	iters: 500, epoch: 5 | loss: 1.2891966
	speed: 0.0043s/iter; left time: 14.8399s
	iters: 600, epoch: 5 | loss: 0.4291832
	speed: 0.0043s/iter; left time: 14.3206s
	iters: 700, epoch: 5 | loss: 1.3535962
	speed: 0.0042s/iter; left time: 13.5647s
	iters: 800, epoch: 5 | loss: 0.5460284
	speed: 0.0042s/iter; left time: 13.0294s
	iters: 900, epoch: 5 | loss: 0.7694570
	speed: 0.0043s/iter; left time: 12.8945s
Updating learning rate to 0.0002110859532
Epoch: 5 cost time: 4.272401571273804
Epoch: 5, Steps: 979 | Train Loss: 0.8633019 Vali Loss: 0.6379232 Best vali loss: 0.6293589
	iters: 100, epoch: 6 | loss: 1.1205915
	speed: 0.0130s/iter; left time: 36.9697s
	iters: 200, epoch: 6 | loss: 1.6562314
	speed: 0.0038s/iter; left time: 10.5193s
	iters: 300, epoch: 6 | loss: 0.4925444
	speed: 0.0038s/iter; left time: 10.0232s
	iters: 400, epoch: 6 | loss: 0.5714492
	speed: 0.0036s/iter; left time: 9.1296s
	iters: 500, epoch: 6 | loss: 1.0644581
	speed: 0.0036s/iter; left time: 8.7850s
	iters: 600, epoch: 6 | loss: 0.5583284
	speed: 0.0037s/iter; left time: 8.7410s
	iters: 700, epoch: 6 | loss: 0.3287077
	speed: 0.0036s/iter; left time: 8.1292s
	iters: 800, epoch: 6 | loss: 0.5204573
	speed: 0.0037s/iter; left time: 7.8131s
	iters: 900, epoch: 6 | loss: 1.1334610
	speed: 0.0041s/iter; left time: 8.3619s
Updating learning rate to 0.0001055429766
Epoch: 6 cost time: 3.7606303691864014
Epoch: 6, Steps: 979 | Train Loss: 0.8273588 Vali Loss: 0.6374138 Best vali loss: 0.6293589
	iters: 100, epoch: 7 | loss: 0.5524145
	speed: 0.0132s/iter; left time: 24.5524s
	iters: 200, epoch: 7 | loss: 0.7911838
	speed: 0.0044s/iter; left time: 7.6763s
	iters: 300, epoch: 7 | loss: 0.9936934
	speed: 0.0044s/iter; left time: 7.2637s
	iters: 400, epoch: 7 | loss: 1.2504820
	speed: 0.0043s/iter; left time: 6.6307s
	iters: 500, epoch: 7 | loss: 0.7174442
	speed: 0.0044s/iter; left time: 6.4163s
	iters: 600, epoch: 7 | loss: 1.2632432
	speed: 0.0043s/iter; left time: 5.8773s
	iters: 700, epoch: 7 | loss: 0.5507755
	speed: 0.0042s/iter; left time: 5.2759s
	iters: 800, epoch: 7 | loss: 1.7708008
	speed: 0.0044s/iter; left time: 5.0939s
	iters: 900, epoch: 7 | loss: 0.9242160
	speed: 0.0044s/iter; left time: 4.6417s
Updating learning rate to 5.27714883e-05
Epoch: 7 cost time: 4.281357049942017
Epoch: 7, Steps: 979 | Train Loss: 0.9793615 Vali Loss: 0.6364152 Best vali loss: 0.6293589
	iters: 100, epoch: 8 | loss: 1.1854689
	speed: 0.0133s/iter; left time: 11.7268s
	iters: 200, epoch: 8 | loss: 0.4762276
	speed: 0.0043s/iter; left time: 3.3493s
	iters: 300, epoch: 8 | loss: 0.8631302
	speed: 0.0044s/iter; left time: 2.9864s
	iters: 400, epoch: 8 | loss: 0.8732326
	speed: 0.0043s/iter; left time: 2.5055s
	iters: 500, epoch: 8 | loss: 0.6278419
	speed: 0.0044s/iter; left time: 2.1295s
	iters: 600, epoch: 8 | loss: 1.2585205
	speed: 0.0045s/iter; left time: 1.6912s
	iters: 700, epoch: 8 | loss: 2.3554049
	speed: 0.0042s/iter; left time: 1.1780s
	iters: 800, epoch: 8 | loss: 0.5430590
	speed: 0.0045s/iter; left time: 0.8039s
	iters: 900, epoch: 8 | loss: 1.4587811
	speed: 0.0044s/iter; left time: 0.3491s
Updating learning rate to 2.638574415e-05
Epoch: 8 cost time: 4.298504829406738
Epoch: 8, Steps: 979 | Train Loss: 1.0712963 Vali Loss: 0.6358545 Best vali loss: 0.6293589

best validation loss 0.6293588893273427

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010516213274, 'e_layers': 2, 'learning_rate': 0.0002978403325, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7139150
	speed: 0.0108s/iter; left time: 9.5200s
Updating learning rate to 0.00028650445982655306
Validation loss decreased (inf --> 0.6225).  Saving model state dict ...
Epoch: 1 cost time: 0.8990397453308105
Epoch: 1, Steps: 123 | Train Loss: 0.7139150 Vali Loss: 0.6225343 Best vali loss: 0.6225343
	iters: 100, epoch: 2 | loss: 0.9677548
	speed: 0.0076s/iter; left time: 5.7817s
Updating learning rate to 0.000254222625660803
Validation loss decreased (0.6225 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.589806079864502
Epoch: 2, Steps: 123 | Train Loss: 0.9677548 Vali Loss: 0.6065320 Best vali loss: 0.6065320
	iters: 100, epoch: 3 | loss: 1.0062683
	speed: 0.0075s/iter; left time: 4.8158s
Updating learning rate to 0.0002059094466189298
Epoch: 3 cost time: 0.5902502536773682
Epoch: 3, Steps: 123 | Train Loss: 1.0062683 Vali Loss: 0.6134489 Best vali loss: 0.6065320
	iters: 100, epoch: 4 | loss: 0.9558939
	speed: 0.0073s/iter; left time: 3.7587s
Updating learning rate to 0.00014892016625
Validation loss decreased (0.6065 --> 0.6057).  Saving model state dict ...
Epoch: 4 cost time: 0.5634748935699463
Epoch: 4, Steps: 123 | Train Loss: 0.9558939 Vali Loss: 0.6056772 Best vali loss: 0.6056772
	iters: 100, epoch: 5 | loss: 0.9353185
	speed: 0.0074s/iter; left time: 2.9184s
Updating learning rate to 9.19308858810702e-05
Epoch: 5 cost time: 0.579970121383667
Epoch: 5, Steps: 123 | Train Loss: 0.9353185 Vali Loss: 0.6128816 Best vali loss: 0.6056772
	iters: 100, epoch: 6 | loss: 1.0987394
	speed: 0.0078s/iter; left time: 2.1147s
Updating learning rate to 4.3617706839196975e-05
Epoch: 6 cost time: 0.6261107921600342
Epoch: 6, Steps: 123 | Train Loss: 1.0987394 Vali Loss: 0.6094676 Best vali loss: 0.6056772
	iters: 100, epoch: 7 | loss: 0.6698110
	speed: 0.0079s/iter; left time: 1.1611s
Updating learning rate to 1.1335872673446898e-05
Epoch: 7 cost time: 0.6242198944091797
Epoch: 7, Steps: 123 | Train Loss: 0.6698110 Vali Loss: 0.6118155 Best vali loss: 0.6056772
	iters: 100, epoch: 8 | loss: 1.1888179
	speed: 0.0073s/iter; left time: 0.1757s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5624799728393555
Epoch: 8, Steps: 123 | Train Loss: 1.1888179 Vali Loss: 0.6119344 Best vali loss: 0.6056772

best validation loss 0.605677229643199

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010514701529, 'e_layers': 2, 'learning_rate': 0.0002979115343, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7139090
	speed: 0.0108s/iter; left time: 9.5946s
Updating learning rate to 0.0002865729516694021
Validation loss decreased (inf --> 0.6225).  Saving model state dict ...
Epoch: 1 cost time: 0.9257729053497314
Epoch: 1, Steps: 123 | Train Loss: 0.7139090 Vali Loss: 0.6225237 Best vali loss: 0.6225237
	iters: 100, epoch: 2 | loss: 0.9677474
	speed: 0.0080s/iter; left time: 6.0581s
Updating learning rate to 0.0002542834001986094
Validation loss decreased (0.6225 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.621368408203125
Epoch: 2, Steps: 123 | Train Loss: 0.9677474 Vali Loss: 0.6065273 Best vali loss: 0.6065273
	iters: 100, epoch: 3 | loss: 1.0061951
	speed: 0.0078s/iter; left time: 5.0151s
Updating learning rate to 0.0002059586713935371
Epoch: 3 cost time: 0.6124172210693359
Epoch: 3, Steps: 123 | Train Loss: 1.0061951 Vali Loss: 0.6132633 Best vali loss: 0.6065273

best validation loss 0.6065273046879678

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010505106287, 'e_layers': 2, 'learning_rate': 0.000300157133, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7137187
	speed: 0.0109s/iter; left time: 9.6296s
Updating learning rate to 0.0002887330823579841
Validation loss decreased (inf --> 0.6222).  Saving model state dict ...
Epoch: 1 cost time: 0.9237332344055176
Epoch: 1, Steps: 123 | Train Loss: 0.7137187 Vali Loss: 0.6221859 Best vali loss: 0.6221859
	iters: 100, epoch: 2 | loss: 0.9675947
	speed: 0.0078s/iter; left time: 5.9799s
Updating learning rate to 0.0002562001385829062
Validation loss decreased (0.6222 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 0.6257367134094238
Epoch: 2, Steps: 123 | Train Loss: 0.9675947 Vali Loss: 0.6063922 Best vali loss: 0.6063922
	iters: 100, epoch: 3 | loss: 1.0061790
	speed: 0.0079s/iter; left time: 5.0720s
Updating learning rate to 0.0002075111474526524
Epoch: 3 cost time: 0.614344596862793
Epoch: 3, Steps: 123 | Train Loss: 1.0061790 Vali Loss: 0.6132395 Best vali loss: 0.6063922

best validation loss 0.606392151776534

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010506491862, 'e_layers': 2, 'learning_rate': 0.0002983019187, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7138758
	speed: 0.0106s/iter; left time: 9.3719s
Updating learning rate to 0.0002869484779478879
Validation loss decreased (inf --> 0.6225).  Saving model state dict ...
Epoch: 1 cost time: 0.8784389495849609
Epoch: 1, Steps: 123 | Train Loss: 0.7138758 Vali Loss: 0.6224651 Best vali loss: 0.6224651
	iters: 100, epoch: 2 | loss: 0.9677175
	speed: 0.0077s/iter; left time: 5.8691s
Updating learning rate to 0.00025461661412686404
Validation loss decreased (0.6225 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.6159896850585938
Epoch: 2, Steps: 123 | Train Loss: 0.9677175 Vali Loss: 0.6065038 Best vali loss: 0.6065038
	iters: 100, epoch: 3 | loss: 1.0062028
	speed: 0.0079s/iter; left time: 5.0309s
Updating learning rate to 0.00020622856041460397
Epoch: 3 cost time: 0.6195707321166992
Epoch: 3, Steps: 123 | Train Loss: 1.0062028 Vali Loss: 0.6132635 Best vali loss: 0.6065038

best validation loss 0.6065037583984859

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010505106287, 'e_layers': 2, 'learning_rate': 0.000300157133, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7236345
	speed: 0.0104s/iter; left time: 5.3551s
Updating learning rate to 0.0001500785665
Epoch: 4 cost time: 0.8619039058685303
Epoch: 4, Steps: 123 | Train Loss: 0.7236345 Vali Loss: 0.6080509 Best vali loss: 0.6063922
	iters: 100, epoch: 5 | loss: 0.9576359
	speed: 0.0077s/iter; left time: 3.0067s
Updating learning rate to 9.264598554734763e-05
Validation loss decreased (0.6064 --> 0.6045).  Saving model state dict ...
Epoch: 5 cost time: 0.6130175590515137
Epoch: 5, Steps: 123 | Train Loss: 0.9576359 Vali Loss: 0.6044767 Best vali loss: 0.6044767
	iters: 100, epoch: 6 | loss: 0.9877849
	speed: 0.0078s/iter; left time: 2.1120s
Updating learning rate to 4.395699441709379e-05
Epoch: 6 cost time: 0.6151363849639893
Epoch: 6, Steps: 123 | Train Loss: 0.9877849 Vali Loss: 0.6152333 Best vali loss: 0.6044767
	iters: 100, epoch: 7 | loss: 0.8838266
	speed: 0.0075s/iter; left time: 1.1083s
Updating learning rate to 1.1424050642015942e-05
Epoch: 7 cost time: 0.5812332630157471
Epoch: 7, Steps: 123 | Train Loss: 0.8838266 Vali Loss: 0.6081207 Best vali loss: 0.6044767
	iters: 100, epoch: 8 | loss: 0.9282688
	speed: 0.0072s/iter; left time: 0.1724s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5612022876739502
Epoch: 8, Steps: 123 | Train Loss: 0.9282688 Vali Loss: 0.6109803 Best vali loss: 0.6044767

best validation loss 0.6044767117787158

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010513659471, 'e_layers': 2, 'learning_rate': 6.22395663e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7748811
	speed: 0.0110s/iter; left time: 9.6955s
Updating learning rate to 6.22395663e-05
Validation loss decreased (inf --> 0.6811).  Saving model state dict ...
Epoch: 1 cost time: 0.9254095554351807
Epoch: 1, Steps: 123 | Train Loss: 0.7748811 Vali Loss: 0.6811172 Best vali loss: 0.6811172
	iters: 100, epoch: 2 | loss: 1.0379994
	speed: 0.0076s/iter; left time: 5.7768s
Updating learning rate to 3.111978315e-05
Validation loss decreased (0.6811 --> 0.6574).  Saving model state dict ...
Epoch: 2 cost time: 0.5940580368041992
Epoch: 2, Steps: 123 | Train Loss: 1.0379994 Vali Loss: 0.6574342 Best vali loss: 0.6574342
	iters: 100, epoch: 3 | loss: 1.0609350
	speed: 0.0076s/iter; left time: 4.8502s
Updating learning rate to 1.5559891575e-05
Validation loss decreased (0.6574 --> 0.6492).  Saving model state dict ...
Epoch: 3 cost time: 0.5919547080993652
Epoch: 3, Steps: 123 | Train Loss: 1.0609350 Vali Loss: 0.6491908 Best vali loss: 0.6491908
	iters: 100, epoch: 4 | loss: 1.0267030
	speed: 0.0077s/iter; left time: 3.9951s
Updating learning rate to 7.7799457875e-06
Validation loss decreased (0.6492 --> 0.6454).  Saving model state dict ...
Epoch: 4 cost time: 0.6066944599151611
Epoch: 4, Steps: 123 | Train Loss: 1.0267030 Vali Loss: 0.6453788 Best vali loss: 0.6453788
	iters: 100, epoch: 5 | loss: 0.9653540
	speed: 0.0076s/iter; left time: 2.9827s
Updating learning rate to 3.88997289375e-06
Validation loss decreased (0.6454 --> 0.6435).  Saving model state dict ...
Epoch: 5 cost time: 0.5926048755645752
Epoch: 5, Steps: 123 | Train Loss: 0.9653540 Vali Loss: 0.6435305 Best vali loss: 0.6435305
	iters: 100, epoch: 6 | loss: 1.1679107
	speed: 0.0079s/iter; left time: 2.1325s
Updating learning rate to 1.944986446875e-06
Validation loss decreased (0.6435 --> 0.6426).  Saving model state dict ...
Epoch: 6 cost time: 0.6194329261779785
Epoch: 6, Steps: 123 | Train Loss: 1.1679107 Vali Loss: 0.6426426 Best vali loss: 0.6426426
	iters: 100, epoch: 7 | loss: 0.7562677
	speed: 0.0075s/iter; left time: 1.1069s
Updating learning rate to 9.724932234375e-07
Validation loss decreased (0.6426 --> 0.6422).  Saving model state dict ...
Epoch: 7 cost time: 0.5994877815246582
Epoch: 7, Steps: 123 | Train Loss: 0.7562677 Vali Loss: 0.6422187 Best vali loss: 0.6422187
	iters: 100, epoch: 8 | loss: 1.2984143
	speed: 0.0077s/iter; left time: 0.1843s
Updating learning rate to 4.8624661171875e-07
Validation loss decreased (0.6422 --> 0.6420).  Saving model state dict ...
Epoch: 8 cost time: 0.5965282917022705
Epoch: 8, Steps: 123 | Train Loss: 1.2984143 Vali Loss: 0.6420025 Best vali loss: 0.6420025

best validation loss 0.6420024817930996

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001050019704, 'e_layers': 2, 'learning_rate': 5.20957186e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7643641
	speed: 0.0119s/iter; left time: 10.4907s
Updating learning rate to 5.20957186e-05
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 1.02903151512146
Epoch: 1, Steps: 123 | Train Loss: 0.7643641 Vali Loss: 0.6031120 Best vali loss: 0.6031120
	iters: 100, epoch: 2 | loss: 0.9587001
	speed: 0.0091s/iter; left time: 6.9092s
Updating learning rate to 2.60478593e-05
Validation loss decreased (0.6031 --> 0.6022).  Saving model state dict ...
Epoch: 2 cost time: 0.7147016525268555
Epoch: 2, Steps: 123 | Train Loss: 0.9587001 Vali Loss: 0.6022457 Best vali loss: 0.6022457
	iters: 100, epoch: 3 | loss: 0.9449714
	speed: 0.0091s/iter; left time: 5.8268s
Updating learning rate to 1.302392965e-05
Validation loss decreased (0.6022 --> 0.5960).  Saving model state dict ...
Epoch: 3 cost time: 0.7114684581756592
Epoch: 3, Steps: 123 | Train Loss: 0.9449714 Vali Loss: 0.5959633 Best vali loss: 0.5959633
	iters: 100, epoch: 4 | loss: 0.5197154
	speed: 0.0091s/iter; left time: 4.7037s
Updating learning rate to 6.511964825e-06
Epoch: 4 cost time: 0.7113840579986572
Epoch: 4, Steps: 123 | Train Loss: 0.5197154 Vali Loss: 0.6010145 Best vali loss: 0.5959633
	iters: 100, epoch: 5 | loss: 0.7087389
	speed: 0.0088s/iter; left time: 3.4759s
Updating learning rate to 3.2559824125e-06
Epoch: 5 cost time: 0.7084171772003174
Epoch: 5, Steps: 123 | Train Loss: 0.7087389 Vali Loss: 0.5995514 Best vali loss: 0.5959633
	iters: 100, epoch: 6 | loss: 0.6522657
	speed: 0.0089s/iter; left time: 2.4082s
Updating learning rate to 1.62799120625e-06
Epoch: 6 cost time: 0.7062909603118896
Epoch: 6, Steps: 123 | Train Loss: 0.6522657 Vali Loss: 0.5993591 Best vali loss: 0.5959633
	iters: 100, epoch: 7 | loss: 0.7414110
	speed: 0.0089s/iter; left time: 1.3068s
Updating learning rate to 8.13995603125e-07
Epoch: 7 cost time: 0.7082822322845459
Epoch: 7, Steps: 123 | Train Loss: 0.7414110 Vali Loss: 0.5993362 Best vali loss: 0.5959633
	iters: 100, epoch: 8 | loss: 0.8236216
	speed: 0.0089s/iter; left time: 0.2134s
Updating learning rate to 4.069978015625e-07
Epoch: 8 cost time: 0.7123916149139404
Epoch: 8, Steps: 123 | Train Loss: 0.8236216 Vali Loss: 0.5995574 Best vali loss: 0.5959633

best validation loss 0.5959632970678866

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010477623961, 'e_layers': 1, 'learning_rate': 0.0002979613309, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0814118
	speed: 0.0102s/iter; left time: 9.0659s
Updating learning rate to 0.0002979613309
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 0.8358883857727051
Epoch: 1, Steps: 123 | Train Loss: 1.0814118 Vali Loss: 0.6057785 Best vali loss: 0.6057785
	iters: 100, epoch: 2 | loss: 0.7547110
	speed: 0.0065s/iter; left time: 4.9190s
Updating learning rate to 0.00014898066545
Epoch: 2 cost time: 0.47591090202331543
Epoch: 2, Steps: 123 | Train Loss: 0.7547110 Vali Loss: 0.6168621 Best vali loss: 0.6057785
	iters: 100, epoch: 3 | loss: 0.8159104
	speed: 0.0063s/iter; left time: 3.9995s
Updating learning rate to 7.4490332725e-05
Epoch: 3 cost time: 0.4630699157714844
Epoch: 3, Steps: 123 | Train Loss: 0.8159104 Vali Loss: 0.6159993 Best vali loss: 0.6057785

best validation loss 0.6057784652500338

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0019109744059, 'e_layers': 3, 'learning_rate': 6.42802958e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5717750
	speed: 0.0101s/iter; left time: 78.2526s
	iters: 200, epoch: 1 | loss: 0.3245668
	speed: 0.0043s/iter; left time: 32.5964s
	iters: 300, epoch: 1 | loss: 0.6840990
	speed: 0.0043s/iter; left time: 32.3071s
	iters: 400, epoch: 1 | loss: 0.4496154
	speed: 0.0042s/iter; left time: 31.4335s
	iters: 500, epoch: 1 | loss: 0.5344719
	speed: 0.0042s/iter; left time: 30.4513s
	iters: 600, epoch: 1 | loss: 1.6838429
	speed: 0.0042s/iter; left time: 30.4499s
	iters: 700, epoch: 1 | loss: 0.3124356
	speed: 0.0043s/iter; left time: 30.5904s
	iters: 800, epoch: 1 | loss: 1.4109408
	speed: 0.0043s/iter; left time: 30.2517s
	iters: 900, epoch: 1 | loss: 1.2075799
	speed: 0.0043s/iter; left time: 29.8933s
Updating learning rate to 6.42802958e-05
Validation loss decreased (inf --> 0.6554).  Saving model state dict ...
Epoch: 1 cost time: 4.484595060348511
Epoch: 1, Steps: 979 | Train Loss: 0.7977030 Vali Loss: 0.6553869 Best vali loss: 0.6553869
	iters: 100, epoch: 2 | loss: 0.8024518
	speed: 0.0128s/iter; left time: 86.6944s
	iters: 200, epoch: 2 | loss: 0.5337784
	speed: 0.0037s/iter; left time: 24.9028s
	iters: 300, epoch: 2 | loss: 0.6110637
	speed: 0.0039s/iter; left time: 25.2839s
	iters: 400, epoch: 2 | loss: 0.6482959
	speed: 0.0039s/iter; left time: 25.4360s
	iters: 500, epoch: 2 | loss: 0.7494361
	speed: 0.0040s/iter; left time: 25.5091s
	iters: 600, epoch: 2 | loss: 0.5410295
	speed: 0.0040s/iter; left time: 24.7612s
	iters: 700, epoch: 2 | loss: 1.5019777
	speed: 0.0038s/iter; left time: 23.3847s
	iters: 800, epoch: 2 | loss: 0.7733712
	speed: 0.0039s/iter; left time: 23.8258s
	iters: 900, epoch: 2 | loss: 0.6606578
	speed: 0.0039s/iter; left time: 23.4690s
Updating learning rate to 3.21401479e-05
Validation loss decreased (0.6554 --> 0.6325).  Saving model state dict ...
Epoch: 2 cost time: 3.87869930267334
Epoch: 2, Steps: 979 | Train Loss: 0.7580069 Vali Loss: 0.6324715 Best vali loss: 0.6324715
	iters: 100, epoch: 3 | loss: 0.8910900
	speed: 0.0129s/iter; left time: 74.5580s
	iters: 200, epoch: 3 | loss: 1.2361373
	speed: 0.0040s/iter; left time: 22.8481s
	iters: 300, epoch: 3 | loss: 1.0818092
	speed: 0.0039s/iter; left time: 21.5184s
	iters: 400, epoch: 3 | loss: 0.3358248
	speed: 0.0039s/iter; left time: 21.5132s
	iters: 500, epoch: 3 | loss: 0.8803219
	speed: 0.0039s/iter; left time: 21.1405s
	iters: 600, epoch: 3 | loss: 0.6359738
	speed: 0.0039s/iter; left time: 20.5418s
	iters: 700, epoch: 3 | loss: 0.7999920
	speed: 0.0038s/iter; left time: 19.5915s
	iters: 800, epoch: 3 | loss: 0.6952119
	speed: 0.0037s/iter; left time: 18.8925s
	iters: 900, epoch: 3 | loss: 0.8792269
	speed: 0.0038s/iter; left time: 18.8396s
Updating learning rate to 1.607007395e-05
Validation loss decreased (0.6325 --> 0.6245).  Saving model state dict ...
Epoch: 3 cost time: 3.83888840675354
Epoch: 3, Steps: 979 | Train Loss: 0.8261764 Vali Loss: 0.6245119 Best vali loss: 0.6245119

best validation loss 0.6245119476665892

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010516213274, 'e_layers': 2, 'learning_rate': 0.0002978403325, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744502
	speed: 0.0115s/iter; left time: 10.1430s
Updating learning rate to 0.0002978403325
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0105335712432861
Epoch: 1, Steps: 123 | Train Loss: 0.7744502 Vali Loss: 0.6173135 Best vali loss: 0.6173135
	iters: 100, epoch: 2 | loss: 0.9422079
	speed: 0.0092s/iter; left time: 7.0284s
Updating learning rate to 0.00014892016625
Epoch: 2 cost time: 0.7134201526641846
Epoch: 2, Steps: 123 | Train Loss: 0.9422079 Vali Loss: 0.6314821 Best vali loss: 0.6173135
	iters: 100, epoch: 3 | loss: 0.8631930
	speed: 0.0090s/iter; left time: 5.7456s
Updating learning rate to 7.4460083125e-05
Validation loss decreased (0.6173 --> 0.5536).  Saving model state dict ...
Epoch: 3 cost time: 0.7123839855194092
Epoch: 3, Steps: 123 | Train Loss: 0.8631930 Vali Loss: 0.5535904 Best vali loss: 0.5535904

best validation loss 0.5535903717289915

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010516213274, 'e_layers': 2, 'learning_rate': 0.0002978403325, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5965229
	speed: 0.0118s/iter; left time: 6.1065s
Updating learning rate to 3.72300415625e-05
Validation loss decreased (0.5536 --> 0.5414).  Saving model state dict ...
Epoch: 4 cost time: 1.0143394470214844
Epoch: 4, Steps: 123 | Train Loss: 0.5965229 Vali Loss: 0.5413786 Best vali loss: 0.5413786
	iters: 100, epoch: 5 | loss: 0.8609075
	speed: 0.0092s/iter; left time: 3.6227s
Updating learning rate to 1.861502078125e-05
Validation loss decreased (0.5414 --> 0.5305).  Saving model state dict ...
Epoch: 5 cost time: 0.7111055850982666
Epoch: 5, Steps: 123 | Train Loss: 0.8609075 Vali Loss: 0.5304578 Best vali loss: 0.5304578
	iters: 100, epoch: 6 | loss: 0.8067592
	speed: 0.0091s/iter; left time: 2.4610s
Updating learning rate to 9.307510390625e-06
Validation loss decreased (0.5305 --> 0.5299).  Saving model state dict ...
Epoch: 6 cost time: 0.711418867111206
Epoch: 6, Steps: 123 | Train Loss: 0.8067592 Vali Loss: 0.5298952 Best vali loss: 0.5298952
	iters: 100, epoch: 7 | loss: 0.4890088
	speed: 0.0091s/iter; left time: 1.3404s
Updating learning rate to 4.6537551953125e-06
Epoch: 7 cost time: 0.7121717929840088
Epoch: 7, Steps: 123 | Train Loss: 0.4890088 Vali Loss: 0.5304648 Best vali loss: 0.5298952
	iters: 100, epoch: 8 | loss: 0.5621643
	speed: 0.0089s/iter; left time: 0.2142s
Updating learning rate to 2.32687759765625e-06
Validation loss decreased (0.5299 --> 0.5294).  Saving model state dict ...
Epoch: 8 cost time: 0.7056577205657959
Epoch: 8, Steps: 123 | Train Loss: 0.5621643 Vali Loss: 0.5294015 Best vali loss: 0.5294015

best validation loss 0.5294014985282242

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010507853614, 'e_layers': 2, 'learning_rate': 0.0002978986341, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745954
	speed: 0.0115s/iter; left time: 10.1451s
Updating learning rate to 0.0002978986341
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0037987232208252
Epoch: 1, Steps: 123 | Train Loss: 0.7745954 Vali Loss: 0.6172309 Best vali loss: 0.6172309
	iters: 100, epoch: 2 | loss: 0.9369013
	speed: 0.0091s/iter; left time: 6.9584s
Updating learning rate to 0.00014894931705
Epoch: 2 cost time: 0.7163007259368896
Epoch: 2, Steps: 123 | Train Loss: 0.9369013 Vali Loss: 0.6329306 Best vali loss: 0.6172309
	iters: 100, epoch: 3 | loss: 0.8487040
	speed: 0.0090s/iter; left time: 5.7325s
Updating learning rate to 7.4474658525e-05
Validation loss decreased (0.6172 --> 0.5466).  Saving model state dict ...
Epoch: 3 cost time: 0.7109799385070801
Epoch: 3, Steps: 123 | Train Loss: 0.8487040 Vali Loss: 0.5465934 Best vali loss: 0.5465934
	iters: 100, epoch: 4 | loss: 0.4915781
	speed: 0.0094s/iter; left time: 4.8455s
Updating learning rate to 3.72373292625e-05
Validation loss decreased (0.5466 --> 0.5380).  Saving model state dict ...
Epoch: 4 cost time: 0.7202010154724121
Epoch: 4, Steps: 123 | Train Loss: 0.4915781 Vali Loss: 0.5379581 Best vali loss: 0.5379581
	iters: 100, epoch: 5 | loss: 0.5704834
	speed: 0.0092s/iter; left time: 3.6233s
Updating learning rate to 1.861866463125e-05
Validation loss decreased (0.5380 --> 0.5346).  Saving model state dict ...
Epoch: 5 cost time: 0.7095026969909668
Epoch: 5, Steps: 123 | Train Loss: 0.5704834 Vali Loss: 0.5345774 Best vali loss: 0.5345774
	iters: 100, epoch: 6 | loss: 0.6212944
	speed: 0.0091s/iter; left time: 2.4513s
Updating learning rate to 9.309332315625e-06
Validation loss decreased (0.5346 --> 0.5267).  Saving model state dict ...
Epoch: 6 cost time: 0.7093608379364014
Epoch: 6, Steps: 123 | Train Loss: 0.6212944 Vali Loss: 0.5267480 Best vali loss: 0.5267480
	iters: 100, epoch: 7 | loss: 0.5875306
	speed: 0.0092s/iter; left time: 1.3499s
Updating learning rate to 4.6546661578125e-06
Epoch: 7 cost time: 0.7121293544769287
Epoch: 7, Steps: 123 | Train Loss: 0.5875306 Vali Loss: 0.5274345 Best vali loss: 0.5267480
	iters: 100, epoch: 8 | loss: 0.7479895
	speed: 0.0090s/iter; left time: 0.2168s
Updating learning rate to 2.32733307890625e-06
Epoch: 8 cost time: 0.7170839309692383
Epoch: 8, Steps: 123 | Train Loss: 0.7479895 Vali Loss: 0.5269648 Best vali loss: 0.5267480

best validation loss 0.5267479534725081

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010514701529, 'e_layers': 2, 'learning_rate': 0.0002976686668, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744122
	speed: 0.0115s/iter; left time: 10.1639s
Updating learning rate to 0.0002976686668
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.008737325668335
Epoch: 1, Steps: 123 | Train Loss: 0.7744122 Vali Loss: 0.6173239 Best vali loss: 0.6173239
	iters: 100, epoch: 2 | loss: 0.9386297
	speed: 0.0090s/iter; left time: 6.8876s
Updating learning rate to 0.0001488343334
Epoch: 2 cost time: 0.711993932723999
Epoch: 2, Steps: 123 | Train Loss: 0.9386297 Vali Loss: 0.6335162 Best vali loss: 0.6173239
	iters: 100, epoch: 3 | loss: 0.8612366
	speed: 0.0089s/iter; left time: 5.6587s
Updating learning rate to 7.44171667e-05
Validation loss decreased (0.6173 --> 0.5696).  Saving model state dict ...
Epoch: 3 cost time: 0.7146644592285156
Epoch: 3, Steps: 123 | Train Loss: 0.8612366 Vali Loss: 0.5696015 Best vali loss: 0.5696015
	iters: 100, epoch: 4 | loss: 0.4963239
	speed: 0.0093s/iter; left time: 4.7936s
Updating learning rate to 3.720858335e-05
Validation loss decreased (0.5696 --> 0.5452).  Saving model state dict ...
Epoch: 4 cost time: 0.716623067855835
Epoch: 4, Steps: 123 | Train Loss: 0.4963239 Vali Loss: 0.5451837 Best vali loss: 0.5451837
	iters: 100, epoch: 5 | loss: 0.5768641
	speed: 0.0094s/iter; left time: 3.6929s
Updating learning rate to 1.8604291675e-05
Validation loss decreased (0.5452 --> 0.5407).  Saving model state dict ...
Epoch: 5 cost time: 0.7179534435272217
Epoch: 5, Steps: 123 | Train Loss: 0.5768641 Vali Loss: 0.5407390 Best vali loss: 0.5407390
	iters: 100, epoch: 6 | loss: 0.6188629
	speed: 0.0091s/iter; left time: 2.4590s
Updating learning rate to 9.3021458375e-06
Validation loss decreased (0.5407 --> 0.5338).  Saving model state dict ...
Epoch: 6 cost time: 0.7119364738464355
Epoch: 6, Steps: 123 | Train Loss: 0.6188629 Vali Loss: 0.5337635 Best vali loss: 0.5337635
	iters: 100, epoch: 7 | loss: 0.5868284
	speed: 0.0092s/iter; left time: 1.3493s
Updating learning rate to 4.65107291875e-06
Epoch: 7 cost time: 0.720226526260376
Epoch: 7, Steps: 123 | Train Loss: 0.5868284 Vali Loss: 0.5346464 Best vali loss: 0.5337635
	iters: 100, epoch: 8 | loss: 0.7503184
	speed: 0.0089s/iter; left time: 0.2132s
Updating learning rate to 2.325536459375e-06
Validation loss decreased (0.5338 --> 0.5337).  Saving model state dict ...
Epoch: 8 cost time: 0.7129895687103271
Epoch: 8, Steps: 123 | Train Loss: 0.7503184 Vali Loss: 0.5336824 Best vali loss: 0.5336824

best validation loss 0.5336824150093172

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0037214799094, 'e_layers': 4, 'learning_rate': 0.000105263012, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9890022
	speed: 0.0122s/iter; left time: 10.7973s
Updating learning rate to 0.00010125667715864499
Validation loss decreased (inf --> 0.6842).  Saving model state dict ...
Epoch: 1 cost time: 1.1069281101226807
Epoch: 1, Steps: 123 | Train Loss: 0.9890022 Vali Loss: 0.6841914 Best vali loss: 0.6841914
	iters: 100, epoch: 2 | loss: 1.0265325
	speed: 0.0099s/iter; left time: 7.5596s
Updating learning rate to 8.984760079666046e-05
Validation loss decreased (0.6842 --> 0.6593).  Saving model state dict ...
Epoch: 2 cost time: 0.8107740879058838
Epoch: 2, Steps: 123 | Train Loss: 1.0265325 Vali Loss: 0.6592942 Best vali loss: 0.6592942
	iters: 100, epoch: 3 | loss: 1.0556560
	speed: 0.0099s/iter; left time: 6.2991s
Updating learning rate to 7.277271136662382e-05
Validation loss decreased (0.6593 --> 0.6440).  Saving model state dict ...
Epoch: 3 cost time: 0.8273718357086182
Epoch: 3, Steps: 123 | Train Loss: 1.0556560 Vali Loss: 0.6440070 Best vali loss: 0.6440070

best validation loss 0.6440069819975098

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0083132513184, 'e_layers': 1, 'learning_rate': 0.0005105414965, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7883677
	speed: 0.0095s/iter; left time: 8.3818s
Updating learning rate to 0.0005105414965
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 0.7761585712432861
Epoch: 1, Steps: 123 | Train Loss: 0.7883677 Vali Loss: 0.6070270 Best vali loss: 0.6070270
	iters: 100, epoch: 2 | loss: 0.6593445
	speed: 0.0067s/iter; left time: 5.1424s
Updating learning rate to 0.00025527074825
Validation loss decreased (0.6070 --> 0.6014).  Saving model state dict ...
Epoch: 2 cost time: 0.5054349899291992
Epoch: 2, Steps: 123 | Train Loss: 0.6593445 Vali Loss: 0.6013878 Best vali loss: 0.6013878
	iters: 100, epoch: 3 | loss: 0.7686845
	speed: 0.0068s/iter; left time: 4.3691s
Updating learning rate to 0.000127635374125
Epoch: 3 cost time: 0.5008299350738525
Epoch: 3, Steps: 123 | Train Loss: 0.7686845 Vali Loss: 0.6207403 Best vali loss: 0.6013878

best validation loss 0.6013877991998929

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0027225049879, 'e_layers': 2, 'learning_rate': 5.63360614e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3404871
	speed: 0.0095s/iter; left time: 36.3163s
	iters: 200, epoch: 1 | loss: 1.0060034
	speed: 0.0035s/iter; left time: 12.9666s
	iters: 300, epoch: 1 | loss: 1.0609900
	speed: 0.0037s/iter; left time: 13.3870s
	iters: 400, epoch: 1 | loss: 0.9226943
	speed: 0.0035s/iter; left time: 12.3602s
Updating learning rate to 5.419189773487957e-05
Validation loss decreased (inf --> 0.6786).  Saving model state dict ...
Epoch: 1 cost time: 2.0865638256073
Epoch: 1, Steps: 490 | Train Loss: 1.0825437 Vali Loss: 0.6785850 Best vali loss: 0.6785850
	iters: 100, epoch: 2 | loss: 0.4751954
	speed: 0.0102s/iter; left time: 33.9564s
	iters: 200, epoch: 2 | loss: 0.7630956
	speed: 0.0032s/iter; left time: 10.3434s
	iters: 300, epoch: 2 | loss: 1.1670042
	speed: 0.0032s/iter; left time: 9.9604s
	iters: 400, epoch: 2 | loss: 0.8632227
	speed: 0.0031s/iter; left time: 9.4875s
Updating learning rate to 4.8085836220640846e-05
Validation loss decreased (0.6786 --> 0.6551).  Saving model state dict ...
Epoch: 2 cost time: 1.60914945602417
Epoch: 2, Steps: 490 | Train Loss: 0.8171295 Vali Loss: 0.6551403 Best vali loss: 0.6551403
	iters: 100, epoch: 3 | loss: 0.5718484
	speed: 0.0094s/iter; left time: 26.8332s
	iters: 200, epoch: 3 | loss: 1.0123667
	speed: 0.0032s/iter; left time: 8.7362s
	iters: 300, epoch: 3 | loss: 0.7362102
	speed: 0.0032s/iter; left time: 8.5363s
	iters: 400, epoch: 3 | loss: 0.8766005
	speed: 0.0032s/iter; left time: 8.1154s
Updating learning rate to 3.894746937124122e-05
Validation loss decreased (0.6551 --> 0.6407).  Saving model state dict ...
Epoch: 3 cost time: 1.6234745979309082
Epoch: 3, Steps: 490 | Train Loss: 0.7992564 Vali Loss: 0.6406841 Best vali loss: 0.6406841

best validation loss 0.6406841369648324

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0083132513184, 'e_layers': 1, 'learning_rate': 0.0005105414965, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7510427
	speed: 0.0097s/iter; left time: 4.9884s
Updating learning rate to 6.38176870625e-05
Epoch: 4 cost time: 0.7896733283996582
Epoch: 4, Steps: 123 | Train Loss: 0.7510427 Vali Loss: 0.6092723 Best vali loss: 0.6013878
	iters: 100, epoch: 5 | loss: 0.6202039
	speed: 0.0064s/iter; left time: 2.5315s
Updating learning rate to 3.190884353125e-05
Epoch: 5 cost time: 0.47850513458251953
Epoch: 5, Steps: 123 | Train Loss: 0.6202039 Vali Loss: 0.6079206 Best vali loss: 0.6013878
	iters: 100, epoch: 6 | loss: 0.7559503
	speed: 0.0063s/iter; left time: 1.7082s
Updating learning rate to 1.5954421765625e-05
Epoch: 6 cost time: 0.47676897048950195
Epoch: 6, Steps: 123 | Train Loss: 0.7559503 Vali Loss: 0.6128077 Best vali loss: 0.6013878
	iters: 100, epoch: 7 | loss: 0.8629217
	speed: 0.0062s/iter; left time: 0.9182s
Updating learning rate to 7.9772108828125e-06
Epoch: 7 cost time: 0.47673535346984863
Epoch: 7, Steps: 123 | Train Loss: 0.8629217 Vali Loss: 0.6092985 Best vali loss: 0.6013878
	iters: 100, epoch: 8 | loss: 0.7870630
	speed: 0.0065s/iter; left time: 0.1562s
Updating learning rate to 3.98860544140625e-06
Epoch: 8 cost time: 0.4976179599761963
Epoch: 8, Steps: 123 | Train Loss: 0.7870630 Vali Loss: 0.6099589 Best vali loss: 0.6013878

best validation loss 0.6013877991998929

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010529217557, 'e_layers': 2, 'learning_rate': 0.0003002044737, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745829
	speed: 0.0117s/iter; left time: 10.3519s
Updating learning rate to 0.0003002044737
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0300045013427734
Epoch: 1, Steps: 123 | Train Loss: 0.7745829 Vali Loss: 0.6173166 Best vali loss: 0.6173166
	iters: 100, epoch: 2 | loss: 0.9304232
	speed: 0.0092s/iter; left time: 6.9819s
Updating learning rate to 0.00015010223685
Validation loss decreased (0.6173 --> 0.5637).  Saving model state dict ...
Epoch: 2 cost time: 0.7077596187591553
Epoch: 2, Steps: 123 | Train Loss: 0.9304232 Vali Loss: 0.5636768 Best vali loss: 0.5636768
	iters: 100, epoch: 3 | loss: 0.8532031
	speed: 0.0093s/iter; left time: 5.9353s
Updating learning rate to 7.5051118425e-05
Validation loss decreased (0.5637 --> 0.5533).  Saving model state dict ...
Epoch: 3 cost time: 0.7190728187561035
Epoch: 3, Steps: 123 | Train Loss: 0.8532031 Vali Loss: 0.5533405 Best vali loss: 0.5533405
	iters: 100, epoch: 4 | loss: 0.4903266
	speed: 0.0093s/iter; left time: 4.7920s
Updating learning rate to 3.75255592125e-05
Validation loss decreased (0.5533 --> 0.5422).  Saving model state dict ...
Epoch: 4 cost time: 0.7118268013000488
Epoch: 4, Steps: 123 | Train Loss: 0.4903266 Vali Loss: 0.5421597 Best vali loss: 0.5421597
	iters: 100, epoch: 5 | loss: 0.5740843
	speed: 0.0092s/iter; left time: 3.6321s
Updating learning rate to 1.876277960625e-05
Validation loss decreased (0.5422 --> 0.5353).  Saving model state dict ...
Epoch: 5 cost time: 0.7152552604675293
Epoch: 5, Steps: 123 | Train Loss: 0.5740843 Vali Loss: 0.5352627 Best vali loss: 0.5352627
	iters: 100, epoch: 6 | loss: 0.6195781
	speed: 0.0093s/iter; left time: 2.5023s
Updating learning rate to 9.381389803125e-06
Validation loss decreased (0.5353 --> 0.5289).  Saving model state dict ...
Epoch: 6 cost time: 0.7222747802734375
Epoch: 6, Steps: 123 | Train Loss: 0.6195781 Vali Loss: 0.5289307 Best vali loss: 0.5289307
	iters: 100, epoch: 7 | loss: 0.5869920
	speed: 0.0092s/iter; left time: 1.3588s
Updating learning rate to 4.6906949015625e-06
Validation loss decreased (0.5289 --> 0.5289).  Saving model state dict ...
Epoch: 7 cost time: 0.7182931900024414
Epoch: 7, Steps: 123 | Train Loss: 0.5869920 Vali Loss: 0.5289268 Best vali loss: 0.5289268
	iters: 100, epoch: 8 | loss: 0.7475879
	speed: 0.0092s/iter; left time: 0.2219s
Updating learning rate to 2.34534745078125e-06
Validation loss decreased (0.5289 --> 0.5282).  Saving model state dict ...
Epoch: 8 cost time: 0.719170093536377
Epoch: 8, Steps: 123 | Train Loss: 0.7475879 Vali Loss: 0.5282325 Best vali loss: 0.5282325

best validation loss 0.5282325210366079

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010516213274, 'e_layers': 2, 'learning_rate': 0.0002978403325, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0177795
	speed: 0.0109s/iter; left time: 9.6670s
Updating learning rate to 0.00028650445982655306
Validation loss decreased (inf --> 0.6044).  Saving model state dict ...
Epoch: 1 cost time: 0.9424214363098145
Epoch: 1, Steps: 123 | Train Loss: 1.0177795 Vali Loss: 0.6043752 Best vali loss: 0.6043752
	iters: 100, epoch: 2 | loss: 0.8477103
	speed: 0.0081s/iter; left time: 6.2017s
Updating learning rate to 0.000254222625660803
Validation loss decreased (0.6044 --> 0.5858).  Saving model state dict ...
Epoch: 2 cost time: 0.6348013877868652
Epoch: 2, Steps: 123 | Train Loss: 0.8477103 Vali Loss: 0.5857897 Best vali loss: 0.5857897
	iters: 100, epoch: 3 | loss: 0.8288952
	speed: 0.0080s/iter; left time: 5.1169s
Updating learning rate to 0.0002059094466189298
Validation loss decreased (0.5858 --> 0.5649).  Saving model state dict ...
Epoch: 3 cost time: 0.620525598526001
Epoch: 3, Steps: 123 | Train Loss: 0.8288952 Vali Loss: 0.5648762 Best vali loss: 0.5648762
	iters: 100, epoch: 4 | loss: 0.7889000
	speed: 0.0081s/iter; left time: 4.1982s
Updating learning rate to 0.00014892016625
Validation loss decreased (0.5649 --> 0.5448).  Saving model state dict ...
Epoch: 4 cost time: 0.630840539932251
Epoch: 4, Steps: 123 | Train Loss: 0.7889000 Vali Loss: 0.5447573 Best vali loss: 0.5447573
	iters: 100, epoch: 5 | loss: 0.6687862
	speed: 0.0077s/iter; left time: 3.0183s
Updating learning rate to 9.19308858810702e-05
Validation loss decreased (0.5448 --> 0.5320).  Saving model state dict ...
Epoch: 5 cost time: 0.5918686389923096
Epoch: 5, Steps: 123 | Train Loss: 0.6687862 Vali Loss: 0.5319859 Best vali loss: 0.5319859
	iters: 100, epoch: 6 | loss: 0.5239324
	speed: 0.0074s/iter; left time: 1.9926s
Updating learning rate to 4.3617706839196975e-05
Epoch: 6 cost time: 0.56943678855896
Epoch: 6, Steps: 123 | Train Loss: 0.5239324 Vali Loss: 0.5371864 Best vali loss: 0.5319859
	iters: 100, epoch: 7 | loss: 0.8713515
	speed: 0.0078s/iter; left time: 1.1472s
Updating learning rate to 1.1335872673446898e-05
Epoch: 7 cost time: 0.6329989433288574
Epoch: 7, Steps: 123 | Train Loss: 0.8713515 Vali Loss: 0.5386753 Best vali loss: 0.5319859
	iters: 100, epoch: 8 | loss: 0.8054330
	speed: 0.0077s/iter; left time: 0.1838s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5942597389221191
Epoch: 8, Steps: 123 | Train Loss: 0.8054330 Vali Loss: 0.5372953 Best vali loss: 0.5319859

best validation loss 0.5319858917700147

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442663497, 'e_layers': 2, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0173119
	speed: 0.0109s/iter; left time: 9.6616s
Updating learning rate to 0.00028656042375066227
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.9280738830566406
Epoch: 1, Steps: 123 | Train Loss: 1.0173119 Vali Loss: 0.6047775 Best vali loss: 0.6047775
	iters: 100, epoch: 2 | loss: 0.8243705
	speed: 0.0082s/iter; left time: 6.2191s
Updating learning rate to 0.0002542722838606716
Validation loss decreased (0.6048 --> 0.5872).  Saving model state dict ...
Epoch: 2 cost time: 0.6230919361114502
Epoch: 2, Steps: 123 | Train Loss: 0.8243705 Vali Loss: 0.5872082 Best vali loss: 0.5872082
	iters: 100, epoch: 3 | loss: 0.8109400
	speed: 0.0077s/iter; left time: 4.9318s
Updating learning rate to 0.0002059496676355622
Validation loss decreased (0.5872 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 0.5863039493560791
Epoch: 3, Steps: 123 | Train Loss: 0.8109400 Vali Loss: 0.5537961 Best vali loss: 0.5537961

best validation loss 0.5537960804043849

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070937849963, 'e_layers': 1, 'learning_rate': 7.51775533e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0019556
	speed: 0.0098s/iter; left time: 8.6858s
Updating learning rate to 7.231627804907318e-05
Validation loss decreased (inf --> 0.6844).  Saving model state dict ...
Epoch: 1 cost time: 0.803358793258667
Epoch: 1, Steps: 123 | Train Loss: 1.0019556 Vali Loss: 0.6843664 Best vali loss: 0.6843664
	iters: 100, epoch: 2 | loss: 0.9310741
	speed: 0.0066s/iter; left time: 5.0256s
Updating learning rate to 6.416805551572156e-05
Validation loss decreased (0.6844 --> 0.6623).  Saving model state dict ...
Epoch: 2 cost time: 0.48983001708984375
Epoch: 2, Steps: 123 | Train Loss: 0.9310741 Vali Loss: 0.6622653 Best vali loss: 0.6622653
	iters: 100, epoch: 3 | loss: 1.0215845
	speed: 0.0065s/iter; left time: 4.1540s
Updating learning rate to 5.1973378716826744e-05
Validation loss decreased (0.6623 --> 0.6466).  Saving model state dict ...
Epoch: 3 cost time: 0.4820706844329834
Epoch: 3, Steps: 123 | Train Loss: 1.0215845 Vali Loss: 0.6466439 Best vali loss: 0.6466439

best validation loss 0.6466439422332043

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010534174388, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0177119
	speed: 0.0107s/iter; left time: 9.4502s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6042).  Saving model state dict ...
Epoch: 1 cost time: 0.9034461975097656
Epoch: 1, Steps: 123 | Train Loss: 1.0177119 Vali Loss: 0.6042392 Best vali loss: 0.6042392
	iters: 100, epoch: 2 | loss: 0.8293524
	speed: 0.0078s/iter; left time: 5.9151s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6042 --> 0.5551).  Saving model state dict ...
Epoch: 2 cost time: 0.6140766143798828
Epoch: 2, Steps: 123 | Train Loss: 0.8293524 Vali Loss: 0.5551412 Best vali loss: 0.5551412
	iters: 100, epoch: 3 | loss: 0.8140391
	speed: 0.0079s/iter; left time: 5.0357s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.6068739891052246
Epoch: 3, Steps: 123 | Train Loss: 0.8140391 Vali Loss: 0.5582394 Best vali loss: 0.5551412

best validation loss 0.5551412156586953

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010442663497, 'e_layers': 2, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8511484
	speed: 0.0109s/iter; left time: 5.6336s
Updating learning rate to 0.00014894925535
Epoch: 4 cost time: 0.9091017246246338
Epoch: 4, Steps: 123 | Train Loss: 0.8511484 Vali Loss: 0.5602232 Best vali loss: 0.5537961
	iters: 100, epoch: 5 | loss: 0.7368832
	speed: 0.0076s/iter; left time: 2.9861s
Updating learning rate to 9.19488430644378e-05
Validation loss decreased (0.5538 --> 0.5348).  Saving model state dict ...
Epoch: 5 cost time: 0.5966637134552002
Epoch: 5, Steps: 123 | Train Loss: 0.7368832 Vali Loss: 0.5347611 Best vali loss: 0.5347611
	iters: 100, epoch: 6 | loss: 0.6998779
	speed: 0.0080s/iter; left time: 2.1529s
Updating learning rate to 4.362622683932836e-05
Epoch: 6 cost time: 0.6268274784088135
Epoch: 6, Steps: 123 | Train Loss: 0.6998779 Vali Loss: 0.5365675 Best vali loss: 0.5347611
	iters: 100, epoch: 7 | loss: 0.7261232
	speed: 0.0078s/iter; left time: 1.1426s
Updating learning rate to 1.1338086949337725e-05
Validation loss decreased (0.5348 --> 0.5329).  Saving model state dict ...
Epoch: 7 cost time: 0.609673023223877
Epoch: 7, Steps: 123 | Train Loss: 0.7261232 Vali Loss: 0.5329483 Best vali loss: 0.5329483
	iters: 100, epoch: 8 | loss: 0.6302983
	speed: 0.0079s/iter; left time: 0.1901s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6021687984466553
Epoch: 8, Steps: 123 | Train Loss: 0.6302983 Vali Loss: 0.5365419 Best vali loss: 0.5329483

best validation loss 0.532948301876656

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010517213764, 'e_layers': 1, 'learning_rate': 0.0003015312038, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0187514
	speed: 0.0099s/iter; left time: 8.8018s
Updating learning rate to 0.0002900548557021548
Validation loss decreased (inf --> 0.5963).  Saving model state dict ...
Epoch: 1 cost time: 0.7954821586608887
Epoch: 1, Steps: 123 | Train Loss: 1.0187514 Vali Loss: 0.5963257 Best vali loss: 0.5963257
	iters: 100, epoch: 2 | loss: 0.7039742
	speed: 0.0068s/iter; left time: 5.1925s
Updating learning rate to 0.0002573729813731614
Epoch: 2 cost time: 0.5204982757568359
Epoch: 2, Steps: 123 | Train Loss: 0.7039742 Vali Loss: 0.6014992 Best vali loss: 0.5963257
	iters: 100, epoch: 3 | loss: 0.6496793
	speed: 0.0067s/iter; left time: 4.2505s
Updating learning rate to 0.00020846109991768072
Epoch: 3 cost time: 0.48728394508361816
Epoch: 3, Steps: 123 | Train Loss: 0.6496793 Vali Loss: 0.6122664 Best vali loss: 0.5963257
	iters: 100, epoch: 4 | loss: 0.6471388
	speed: 0.0068s/iter; left time: 3.4957s
Updating learning rate to 0.0001507656019
Epoch: 4 cost time: 0.5044920444488525
Epoch: 4, Steps: 123 | Train Loss: 0.6471388 Vali Loss: 0.6379192 Best vali loss: 0.5963257
	iters: 100, epoch: 5 | loss: 0.5801368
	speed: 0.0065s/iter; left time: 2.5376s
Updating learning rate to 9.30701038823193e-05
Epoch: 5 cost time: 0.48548436164855957
Epoch: 5, Steps: 123 | Train Loss: 0.5801368 Vali Loss: 0.6204891 Best vali loss: 0.5963257
	iters: 100, epoch: 6 | loss: 0.6566218
	speed: 0.0065s/iter; left time: 1.7574s
Updating learning rate to 4.415822242683858e-05
Epoch: 6 cost time: 0.4968421459197998
Epoch: 6, Steps: 123 | Train Loss: 0.6566218 Vali Loss: 0.6391516 Best vali loss: 0.5963257
	iters: 100, epoch: 7 | loss: 0.5653988
	speed: 0.0065s/iter; left time: 0.9608s
Updating learning rate to 1.1476348097845236e-05
Epoch: 7 cost time: 0.4896430969238281
Epoch: 7, Steps: 123 | Train Loss: 0.5653988 Vali Loss: 0.6378778 Best vali loss: 0.5963257
	iters: 100, epoch: 8 | loss: 0.5321187
	speed: 0.0065s/iter; left time: 0.1568s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.48198676109313965
Epoch: 8, Steps: 123 | Train Loss: 0.5321187 Vali Loss: 0.6365445 Best vali loss: 0.5963257

best validation loss 0.5963256763452074

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010528117455, 'e_layers': 2, 'learning_rate': 0.0003083717211, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0208715
	speed: 0.0109s/iter; left time: 9.6166s
Updating learning rate to 0.00029663502131478447
Validation loss decreased (inf --> 0.6045).  Saving model state dict ...
Epoch: 1 cost time: 0.9080767631530762
Epoch: 1, Steps: 123 | Train Loss: 1.0208715 Vali Loss: 0.6044682 Best vali loss: 0.6044682
	iters: 100, epoch: 2 | loss: 0.8234699
	speed: 0.0077s/iter; left time: 5.8994s
Updating learning rate to 0.0002632117281079884
Validation loss decreased (0.6045 --> 0.5761).  Saving model state dict ...
Epoch: 2 cost time: 0.607410192489624
Epoch: 2, Steps: 123 | Train Loss: 0.8234699 Vali Loss: 0.5760538 Best vali loss: 0.5760538
	iters: 100, epoch: 3 | loss: 0.8039194
	speed: 0.0079s/iter; left time: 5.0547s
Updating learning rate to 0.0002131902348874391
Validation loss decreased (0.5761 --> 0.5495).  Saving model state dict ...
Epoch: 3 cost time: 0.6065981388092041
Epoch: 3, Steps: 123 | Train Loss: 0.8039194 Vali Loss: 0.5495386 Best vali loss: 0.5495386
	iters: 100, epoch: 4 | loss: 0.7956445
	speed: 0.0080s/iter; left time: 4.1479s
Updating learning rate to 0.00015418586055
Validation loss decreased (0.5495 --> 0.5445).  Saving model state dict ...
Epoch: 4 cost time: 0.6218655109405518
Epoch: 4, Steps: 123 | Train Loss: 0.7956445 Vali Loss: 0.5445148 Best vali loss: 0.5445148
	iters: 100, epoch: 5 | loss: 0.6790399
	speed: 0.0079s/iter; left time: 3.1185s
Updating learning rate to 9.518148621256092e-05
Validation loss decreased (0.5445 --> 0.5344).  Saving model state dict ...
Epoch: 5 cost time: 0.6213400363922119
Epoch: 5, Steps: 123 | Train Loss: 0.6790399 Vali Loss: 0.5343553 Best vali loss: 0.5343553
	iters: 100, epoch: 6 | loss: 0.5271559
	speed: 0.0078s/iter; left time: 2.1176s
Updating learning rate to 4.5159992992011634e-05
Validation loss decreased (0.5344 --> 0.5302).  Saving model state dict ...
Epoch: 6 cost time: 0.6089422702789307
Epoch: 6, Steps: 123 | Train Loss: 0.5271559 Vali Loss: 0.5302416 Best vali loss: 0.5302416
	iters: 100, epoch: 7 | loss: 0.8783499
	speed: 0.0078s/iter; left time: 1.1436s
Updating learning rate to 1.1736699785215552e-05
Validation loss decreased (0.5302 --> 0.5288).  Saving model state dict ...
Epoch: 7 cost time: 0.6053934097290039
Epoch: 7, Steps: 123 | Train Loss: 0.8783499 Vali Loss: 0.5287639 Best vali loss: 0.5287639
	iters: 100, epoch: 8 | loss: 0.8139734
	speed: 0.0077s/iter; left time: 0.1852s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5999798774719238
Epoch: 8, Steps: 123 | Train Loss: 0.8139734 Vali Loss: 0.5287686 Best vali loss: 0.5287639

best validation loss 0.5287639088842506

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010506642658, 'e_layers': 4, 'learning_rate': 0.0003289216013, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8067499
	speed: 0.0151s/iter; left time: 13.3981s
Updating learning rate to 0.00031640276827095393
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 1.4713876247406006
Epoch: 1, Steps: 123 | Train Loss: 0.8067499 Vali Loss: 0.6164782 Best vali loss: 0.6164782
	iters: 100, epoch: 2 | loss: 0.9648998
	speed: 0.0142s/iter; left time: 10.8186s
Updating learning rate to 0.000280752148028984
Epoch: 2 cost time: 1.1651291847229004
Epoch: 2, Steps: 123 | Train Loss: 0.9648998 Vali Loss: 0.6198863 Best vali loss: 0.6164782
	iters: 100, epoch: 3 | loss: 0.6262742
	speed: 0.0140s/iter; left time: 8.9183s
Updating learning rate to 0.0002273972243322528
Validation loss decreased (0.6165 --> 0.5821).  Saving model state dict ...
Epoch: 3 cost time: 1.1657288074493408
Epoch: 3, Steps: 123 | Train Loss: 0.6262742 Vali Loss: 0.5820719 Best vali loss: 0.5820719

best validation loss 0.5820718876248651

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0078803887102, 'e_layers': 2, 'learning_rate': 0.0029971854148, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7340357
	speed: 0.0093s/iter; left time: 35.5826s
	iters: 200, epoch: 1 | loss: 0.6021373
	speed: 0.0033s/iter; left time: 12.1356s
	iters: 300, epoch: 1 | loss: 0.6241052
	speed: 0.0032s/iter; left time: 11.6642s
	iters: 400, epoch: 1 | loss: 0.6373243
	speed: 0.0034s/iter; left time: 11.8469s
Updating learning rate to 0.0029971854148
Validation loss decreased (inf --> 0.6181).  Saving model state dict ...
Epoch: 1 cost time: 1.9375948905944824
Epoch: 1, Steps: 490 | Train Loss: 0.6494006 Vali Loss: 0.6181152 Best vali loss: 0.6181152
	iters: 100, epoch: 2 | loss: 1.0419130
	speed: 0.0092s/iter; left time: 30.7549s
	iters: 200, epoch: 2 | loss: 0.9045128
	speed: 0.0034s/iter; left time: 10.9975s
	iters: 300, epoch: 2 | loss: 1.0103936
	speed: 0.0034s/iter; left time: 10.5469s
	iters: 400, epoch: 2 | loss: 0.5758394
	speed: 0.0033s/iter; left time: 9.9575s
Updating learning rate to 0.0014985927074
Validation loss decreased (0.6181 --> 0.5869).  Saving model state dict ...
Epoch: 2 cost time: 1.6785311698913574
Epoch: 2, Steps: 490 | Train Loss: 0.8831647 Vali Loss: 0.5869303 Best vali loss: 0.5869303
	iters: 100, epoch: 3 | loss: 0.6641558
	speed: 0.0096s/iter; left time: 27.1882s
	iters: 200, epoch: 3 | loss: 0.6094140
	speed: 0.0032s/iter; left time: 8.6915s
	iters: 300, epoch: 3 | loss: 0.6842361
	speed: 0.0031s/iter; left time: 8.2985s
	iters: 400, epoch: 3 | loss: 0.8970556
	speed: 0.0032s/iter; left time: 8.0684s
Updating learning rate to 0.0007492963537
Epoch: 3 cost time: 1.6027758121490479
Epoch: 3, Steps: 490 | Train Loss: 0.7137154 Vali Loss: 0.6235783 Best vali loss: 0.5869303

best validation loss 0.5869303491382012

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010485522523, 'e_layers': 2, 'learning_rate': 0.0002978624409, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7175491
	speed: 0.0118s/iter; left time: 10.4729s
Updating learning rate to 0.0002865257267756814
Validation loss decreased (inf --> 0.6209).  Saving model state dict ...
Epoch: 1 cost time: 1.0363738536834717
Epoch: 1, Steps: 123 | Train Loss: 0.7175491 Vali Loss: 0.6209114 Best vali loss: 0.6209114
	iters: 100, epoch: 2 | loss: 0.8556563
	speed: 0.0091s/iter; left time: 6.9645s
Updating learning rate to 0.00025424149636058365
Validation loss decreased (0.6209 --> 0.5532).  Saving model state dict ...
Epoch: 2 cost time: 0.7222533226013184
Epoch: 2, Steps: 123 | Train Loss: 0.8556563 Vali Loss: 0.5532481 Best vali loss: 0.5532481
	iters: 100, epoch: 3 | loss: 0.9629592
	speed: 0.0094s/iter; left time: 6.0205s
Updating learning rate to 0.00020592473107812787
Validation loss decreased (0.5532 --> 0.5335).  Saving model state dict ...
Epoch: 3 cost time: 0.7177784442901611
Epoch: 3, Steps: 123 | Train Loss: 0.9629592 Vali Loss: 0.5335090 Best vali loss: 0.5335090

best validation loss 0.5335090342135078

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010485522523, 'e_layers': 2, 'learning_rate': 0.0002978624409, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6103421
	speed: 0.0120s/iter; left time: 6.1890s
Updating learning rate to 0.00014893122045
Epoch: 4 cost time: 1.0225985050201416
Epoch: 4, Steps: 123 | Train Loss: 0.6103421 Vali Loss: 0.5571360 Best vali loss: 0.5335090
	iters: 100, epoch: 5 | loss: 0.7470929
	speed: 0.0091s/iter; left time: 3.5632s
Updating learning rate to 9.193770982187216e-05
Epoch: 5 cost time: 0.7286844253540039
Epoch: 5, Steps: 123 | Train Loss: 0.7470929 Vali Loss: 0.5529170 Best vali loss: 0.5335090
	iters: 100, epoch: 6 | loss: 0.8513137
	speed: 0.0091s/iter; left time: 2.4439s
Updating learning rate to 4.362094453941639e-05
Epoch: 6 cost time: 0.7229468822479248
Epoch: 6, Steps: 123 | Train Loss: 0.8513137 Vali Loss: 0.5629529 Best vali loss: 0.5335090
	iters: 100, epoch: 7 | loss: 0.5003369
	speed: 0.0090s/iter; left time: 1.3189s
Updating learning rate to 1.1336714124318613e-05
Epoch: 7 cost time: 0.7181646823883057
Epoch: 7, Steps: 123 | Train Loss: 0.5003369 Vali Loss: 0.5783330 Best vali loss: 0.5335090
	iters: 100, epoch: 8 | loss: 0.6689298
	speed: 0.0090s/iter; left time: 0.2156s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7168257236480713
Epoch: 8, Steps: 123 | Train Loss: 0.6689298 Vali Loss: 0.5788009 Best vali loss: 0.5335090

best validation loss 0.5335090342135078

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744406
	speed: 0.0115s/iter; left time: 10.2021s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.008399248123169
Epoch: 1, Steps: 123 | Train Loss: 0.7744406 Vali Loss: 0.6173628 Best vali loss: 0.6173628
	iters: 100, epoch: 2 | loss: 0.9522128
	speed: 0.0091s/iter; left time: 6.9530s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6174 --> 0.5660).  Saving model state dict ...
Epoch: 2 cost time: 0.7185001373291016
Epoch: 2, Steps: 123 | Train Loss: 0.9522128 Vali Loss: 0.5659796 Best vali loss: 0.5659796
	iters: 100, epoch: 3 | loss: 0.8589671
	speed: 0.0092s/iter; left time: 5.8815s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5660 --> 0.5424).  Saving model state dict ...
Epoch: 3 cost time: 0.7148044109344482
Epoch: 3, Steps: 123 | Train Loss: 0.8589671 Vali Loss: 0.5423834 Best vali loss: 0.5423834
	iters: 100, epoch: 4 | loss: 0.4881703
	speed: 0.0092s/iter; left time: 4.7351s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5424 --> 0.5310).  Saving model state dict ...
Epoch: 4 cost time: 0.7192871570587158
Epoch: 4, Steps: 123 | Train Loss: 0.4881703 Vali Loss: 0.5309547 Best vali loss: 0.5309547
	iters: 100, epoch: 5 | loss: 0.5556188
	speed: 0.0091s/iter; left time: 3.5959s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5310 --> 0.5246).  Saving model state dict ...
Epoch: 5 cost time: 0.7151117324829102
Epoch: 5, Steps: 123 | Train Loss: 0.5556188 Vali Loss: 0.5246109 Best vali loss: 0.5246109
	iters: 100, epoch: 6 | loss: 0.5830603
	speed: 0.0091s/iter; left time: 2.4508s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7129940986633301
Epoch: 6, Steps: 123 | Train Loss: 0.5830603 Vali Loss: 0.5409448 Best vali loss: 0.5246109
	iters: 100, epoch: 7 | loss: 0.5360242
	speed: 0.0089s/iter; left time: 1.3109s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7136425971984863
Epoch: 7, Steps: 123 | Train Loss: 0.5360242 Vali Loss: 0.5399084 Best vali loss: 0.5246109
	iters: 100, epoch: 8 | loss: 0.6928470
	speed: 0.0089s/iter; left time: 0.2137s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7165095806121826
Epoch: 8, Steps: 123 | Train Loss: 0.6928470 Vali Loss: 0.5443950 Best vali loss: 0.5246109

best validation loss 0.5246108722377849

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744652
	speed: 0.0116s/iter; left time: 10.2602s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.012178897857666
Epoch: 1, Steps: 123 | Train Loss: 0.7744652 Vali Loss: 0.6172923 Best vali loss: 0.6172923
	iters: 100, epoch: 2 | loss: 0.9520369
	speed: 0.0092s/iter; left time: 6.9864s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5712).  Saving model state dict ...
Epoch: 2 cost time: 0.722496509552002
Epoch: 2, Steps: 123 | Train Loss: 0.9520369 Vali Loss: 0.5711821 Best vali loss: 0.5711821
	iters: 100, epoch: 3 | loss: 0.8509780
	speed: 0.0093s/iter; left time: 5.9384s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5712 --> 0.5492).  Saving model state dict ...
Epoch: 3 cost time: 0.724163293838501
Epoch: 3, Steps: 123 | Train Loss: 0.8509780 Vali Loss: 0.5491628 Best vali loss: 0.5491628
	iters: 100, epoch: 4 | loss: 0.4937056
	speed: 0.0093s/iter; left time: 4.7793s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5492 --> 0.5415).  Saving model state dict ...
Epoch: 4 cost time: 0.720844030380249
Epoch: 4, Steps: 123 | Train Loss: 0.4937056 Vali Loss: 0.5414747 Best vali loss: 0.5414747
	iters: 100, epoch: 5 | loss: 0.5629661
	speed: 0.0093s/iter; left time: 3.6614s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5415 --> 0.5210).  Saving model state dict ...
Epoch: 5 cost time: 0.7196893692016602
Epoch: 5, Steps: 123 | Train Loss: 0.5629661 Vali Loss: 0.5210092 Best vali loss: 0.5210092
	iters: 100, epoch: 6 | loss: 0.5875892
	speed: 0.0093s/iter; left time: 2.5063s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.719963788986206
Epoch: 6, Steps: 123 | Train Loss: 0.5875892 Vali Loss: 0.5401662 Best vali loss: 0.5210092
	iters: 100, epoch: 7 | loss: 0.5347210
	speed: 0.0091s/iter; left time: 1.3313s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7227010726928711
Epoch: 7, Steps: 123 | Train Loss: 0.5347210 Vali Loss: 0.5430018 Best vali loss: 0.5210092
	iters: 100, epoch: 8 | loss: 0.6936415
	speed: 0.0090s/iter; left time: 0.2164s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7225971221923828
Epoch: 8, Steps: 123 | Train Loss: 0.6936415 Vali Loss: 0.5492468 Best vali loss: 0.5210092

best validation loss 0.5210092379394806

[INFO][abstract_intensifier.py:595] Added config 2ed099 and rejected config eceebc as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010486079146, 'e_layers': 3, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6511805
	speed: 0.0139s/iter; left time: 12.3040s
Updating learning rate to 0.00028656042375066227
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 1.3006341457366943
Epoch: 1, Steps: 123 | Train Loss: 0.6511805 Vali Loss: 0.6208440 Best vali loss: 0.6208440
	iters: 100, epoch: 2 | loss: 0.9114721
	speed: 0.0124s/iter; left time: 9.4677s
Updating learning rate to 0.0002542722838606716
Validation loss decreased (0.6208 --> 0.5562).  Saving model state dict ...
Epoch: 2 cost time: 1.0151071548461914
Epoch: 2, Steps: 123 | Train Loss: 0.9114721 Vali Loss: 0.5561924 Best vali loss: 0.5561924
	iters: 100, epoch: 3 | loss: 0.8758519
	speed: 0.0126s/iter; left time: 8.0566s
Updating learning rate to 0.0002059496676355622
Epoch: 3 cost time: 1.0082030296325684
Epoch: 3, Steps: 123 | Train Loss: 0.8758519 Vali Loss: 0.5773546 Best vali loss: 0.5561924

best validation loss 0.5561923758126365

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001049527453, 'e_layers': 3, 'learning_rate': 0.0003028021701, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6169065
	speed: 0.0138s/iter; left time: 12.2389s
Updating learning rate to 0.00029127744872769557
Validation loss decreased (inf --> 0.5878).  Saving model state dict ...
Epoch: 1 cost time: 1.3053526878356934
Epoch: 1, Steps: 123 | Train Loss: 0.6169065 Vali Loss: 0.5878150 Best vali loss: 0.5878150
	iters: 100, epoch: 2 | loss: 0.7231472
	speed: 0.0123s/iter; left time: 9.3509s
Updating learning rate to 0.00025845781896785623
Epoch: 2 cost time: 0.9965438842773438
Epoch: 2, Steps: 123 | Train Loss: 0.7231472 Vali Loss: 0.6108693 Best vali loss: 0.5878150
	iters: 100, epoch: 3 | loss: 0.6248063
	speed: 0.0121s/iter; left time: 7.7440s
Updating learning rate to 0.00020933977194073292
Validation loss decreased (0.5878 --> 0.5487).  Saving model state dict ...
Epoch: 3 cost time: 1.0023465156555176
Epoch: 3, Steps: 123 | Train Loss: 0.6248063 Vali Loss: 0.5486756 Best vali loss: 0.5486756

best validation loss 0.5486755802751636

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010502396256, 'e_layers': 3, 'learning_rate': 0.0003108186652, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6513330
	speed: 0.0139s/iter; left time: 12.2804s
Updating learning rate to 0.00029898883415037906
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 1.295982837677002
Epoch: 1, Steps: 123 | Train Loss: 0.6513330 Vali Loss: 0.6167109 Best vali loss: 0.6167109
	iters: 100, epoch: 2 | loss: 0.9448093
	speed: 0.0125s/iter; left time: 9.4932s
Updating learning rate to 0.00026530032554113555
Epoch: 2 cost time: 1.0065159797668457
Epoch: 2, Steps: 123 | Train Loss: 0.9448093 Vali Loss: 0.6182984 Best vali loss: 0.6167109
	iters: 100, epoch: 3 | loss: 0.8915839
	speed: 0.0122s/iter; left time: 7.7827s
Updating learning rate to 0.00021488190942093585
Validation loss decreased (0.6167 --> 0.5633).  Saving model state dict ...
Epoch: 3 cost time: 1.0120935440063477
Epoch: 3, Steps: 123 | Train Loss: 0.8915839 Vali Loss: 0.5632880 Best vali loss: 0.5632880

best validation loss 0.5632879822853262

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001049527453, 'e_layers': 3, 'learning_rate': 0.0003028021701, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5340764
	speed: 0.0144s/iter; left time: 7.4559s
Updating learning rate to 0.00015140108505
Validation loss decreased (0.5487 --> 0.5464).  Saving model state dict ...
Epoch: 4 cost time: 1.3111543655395508
Epoch: 4, Steps: 123 | Train Loss: 0.5340764 Vali Loss: 0.5464218 Best vali loss: 0.5464218
	iters: 100, epoch: 5 | loss: 0.6304139
	speed: 0.0127s/iter; left time: 4.9760s
Updating learning rate to 9.346239815926713e-05
Epoch: 5 cost time: 1.0026226043701172
Epoch: 5, Steps: 123 | Train Loss: 0.6304139 Vali Loss: 0.5478466 Best vali loss: 0.5464218
	iters: 100, epoch: 6 | loss: 0.5653887
	speed: 0.0120s/iter; left time: 3.2480s
Updating learning rate to 4.434435113214379e-05
Validation loss decreased (0.5464 --> 0.5407).  Saving model state dict ...
Epoch: 6 cost time: 0.9992759227752686
Epoch: 6, Steps: 123 | Train Loss: 0.5653887 Vali Loss: 0.5406971 Best vali loss: 0.5406971
	iters: 100, epoch: 7 | loss: 0.7569323
	speed: 0.0127s/iter; left time: 1.8612s
Updating learning rate to 1.1524721372304437e-05
Epoch: 7 cost time: 1.0024232864379883
Epoch: 7, Steps: 123 | Train Loss: 0.7569323 Vali Loss: 0.5478343 Best vali loss: 0.5406971
	iters: 100, epoch: 8 | loss: 0.6190941
	speed: 0.0121s/iter; left time: 0.2901s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.998988151550293
Epoch: 8, Steps: 123 | Train Loss: 0.6190941 Vali Loss: 0.5478738 Best vali loss: 0.5406971

best validation loss 0.5406970956269264

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0101053328956, 'e_layers': 3, 'learning_rate': 0.000152294015, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6395288
	speed: 0.0103s/iter; left time: 39.5343s
	iters: 200, epoch: 1 | loss: 0.5705718
	speed: 0.0046s/iter; left time: 16.9569s
	iters: 300, epoch: 1 | loss: 0.9314217
	speed: 0.0046s/iter; left time: 16.7294s
	iters: 400, epoch: 1 | loss: 0.5662711
	speed: 0.0046s/iter; left time: 16.1778s
Updating learning rate to 0.000152294015
Validation loss decreased (inf --> 0.6108).  Saving model state dict ...
Epoch: 1 cost time: 2.5406501293182373
Epoch: 1, Steps: 490 | Train Loss: 0.6769484 Vali Loss: 0.6107897 Best vali loss: 0.6107897
	iters: 100, epoch: 2 | loss: 0.3595761
	speed: 0.0117s/iter; left time: 38.9646s
	iters: 200, epoch: 2 | loss: 1.0082483
	speed: 0.0044s/iter; left time: 14.2002s
	iters: 300, epoch: 2 | loss: 0.4337465
	speed: 0.0046s/iter; left time: 14.3454s
	iters: 400, epoch: 2 | loss: 0.8807937
	speed: 0.0049s/iter; left time: 14.8134s
Updating learning rate to 7.61470075e-05
Epoch: 2 cost time: 2.2632408142089844
Epoch: 2, Steps: 490 | Train Loss: 0.6705912 Vali Loss: 0.6149532 Best vali loss: 0.6107897
	iters: 100, epoch: 3 | loss: 0.9426568
	speed: 0.0117s/iter; left time: 33.3004s
	iters: 200, epoch: 3 | loss: 0.7202059
	speed: 0.0045s/iter; left time: 12.2842s
	iters: 300, epoch: 3 | loss: 0.8420263
	speed: 0.0044s/iter; left time: 11.6880s
	iters: 400, epoch: 3 | loss: 0.6162583
	speed: 0.0045s/iter; left time: 11.3115s
Updating learning rate to 3.807350375e-05
Validation loss decreased (0.6108 --> 0.6047).  Saving model state dict ...
Epoch: 3 cost time: 2.2210724353790283
Epoch: 3, Steps: 490 | Train Loss: 0.7802868 Vali Loss: 0.6047108 Best vali loss: 0.6047108
	iters: 100, epoch: 4 | loss: 0.6835164
	speed: 0.0119s/iter; left time: 28.0234s
	iters: 200, epoch: 4 | loss: 0.5004320
	speed: 0.0044s/iter; left time: 9.9522s
	iters: 300, epoch: 4 | loss: 0.8140491
	speed: 0.0045s/iter; left time: 9.6736s
	iters: 400, epoch: 4 | loss: 0.5003685
	speed: 0.0045s/iter; left time: 9.1530s
Updating learning rate to 1.9036751875e-05
Validation loss decreased (0.6047 --> 0.6020).  Saving model state dict ...
Epoch: 4 cost time: 2.2254812717437744
Epoch: 4, Steps: 490 | Train Loss: 0.6245915 Vali Loss: 0.6019742 Best vali loss: 0.6019742
	iters: 100, epoch: 5 | loss: 0.9026796
	speed: 0.0120s/iter; left time: 22.3265s
	iters: 200, epoch: 5 | loss: 0.9718522
	speed: 0.0043s/iter; left time: 7.6442s
	iters: 300, epoch: 5 | loss: 0.5208516
	speed: 0.0046s/iter; left time: 7.5671s
	iters: 400, epoch: 5 | loss: 0.8027576
	speed: 0.0045s/iter; left time: 6.9693s
Updating learning rate to 9.5183759375e-06
Epoch: 5 cost time: 2.215345859527588
Epoch: 5, Steps: 490 | Train Loss: 0.7995352 Vali Loss: 0.6043475 Best vali loss: 0.6019742
	iters: 100, epoch: 6 | loss: 0.3650649
	speed: 0.0121s/iter; left time: 16.5546s
	iters: 200, epoch: 6 | loss: 0.5139894
	speed: 0.0045s/iter; left time: 5.7139s
	iters: 300, epoch: 6 | loss: 1.2099274
	speed: 0.0045s/iter; left time: 5.2950s
	iters: 400, epoch: 6 | loss: 0.6533096
	speed: 0.0045s/iter; left time: 4.8316s
Updating learning rate to 4.75918796875e-06
Epoch: 6 cost time: 2.2622225284576416
Epoch: 6, Steps: 490 | Train Loss: 0.6855728 Vali Loss: 0.6032910 Best vali loss: 0.6019742
	iters: 100, epoch: 7 | loss: 0.4226144
	speed: 0.0121s/iter; left time: 10.6190s
	iters: 200, epoch: 7 | loss: 1.0922065
	speed: 0.0042s/iter; left time: 3.2580s
	iters: 300, epoch: 7 | loss: 1.2307482
	speed: 0.0042s/iter; left time: 2.8501s
	iters: 400, epoch: 7 | loss: 0.5492601
	speed: 0.0041s/iter; left time: 2.4062s
Updating learning rate to 2.379593984375e-06
Epoch: 7 cost time: 2.0802371501922607
Epoch: 7, Steps: 490 | Train Loss: 0.8237073 Vali Loss: 0.6035873 Best vali loss: 0.6019742
	iters: 100, epoch: 8 | loss: 0.5127382
	speed: 0.0112s/iter; left time: 4.3905s
	iters: 200, epoch: 8 | loss: 0.5759934
	speed: 0.0045s/iter; left time: 1.2997s
	iters: 300, epoch: 8 | loss: 1.0146320
	speed: 0.0045s/iter; left time: 0.8580s
	iters: 400, epoch: 8 | loss: 1.0392128
	speed: 0.0046s/iter; left time: 0.4181s
Updating learning rate to 1.1897969921875e-06
Epoch: 8 cost time: 2.2305519580841064
Epoch: 8, Steps: 490 | Train Loss: 0.7856441 Vali Loss: 0.6031931 Best vali loss: 0.6019742

best validation loss 0.6019742369706959

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018391244049, 'e_layers': 2, 'learning_rate': 0.0002979767218, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745590
	speed: 0.0116s/iter; left time: 10.2841s
Updating learning rate to 0.0002979767218
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.00827956199646
Epoch: 1, Steps: 123 | Train Loss: 0.7745590 Vali Loss: 0.6174367 Best vali loss: 0.6174367
	iters: 100, epoch: 2 | loss: 0.9205503
	speed: 0.0091s/iter; left time: 6.8998s
Updating learning rate to 0.0001489883609
Validation loss decreased (0.6174 --> 0.5550).  Saving model state dict ...
Epoch: 2 cost time: 0.7159664630889893
Epoch: 2, Steps: 123 | Train Loss: 0.9205503 Vali Loss: 0.5549681 Best vali loss: 0.5549681
	iters: 100, epoch: 3 | loss: 0.8447899
	speed: 0.0093s/iter; left time: 5.9691s
Updating learning rate to 7.449418045e-05
Validation loss decreased (0.5550 --> 0.5524).  Saving model state dict ...
Epoch: 3 cost time: 0.7173616886138916
Epoch: 3, Steps: 123 | Train Loss: 0.8447899 Vali Loss: 0.5524476 Best vali loss: 0.5524476
	iters: 100, epoch: 4 | loss: 0.4886398
	speed: 0.0092s/iter; left time: 4.7453s
Updating learning rate to 3.7247090225e-05
Validation loss decreased (0.5524 --> 0.5437).  Saving model state dict ...
Epoch: 4 cost time: 0.7155160903930664
Epoch: 4, Steps: 123 | Train Loss: 0.4886398 Vali Loss: 0.5436608 Best vali loss: 0.5436608
	iters: 100, epoch: 5 | loss: 0.5746394
	speed: 0.0092s/iter; left time: 3.6246s
Updating learning rate to 1.86235451125e-05
Validation loss decreased (0.5437 --> 0.5353).  Saving model state dict ...
Epoch: 5 cost time: 0.7190117835998535
Epoch: 5, Steps: 123 | Train Loss: 0.5746394 Vali Loss: 0.5353231 Best vali loss: 0.5353231
	iters: 100, epoch: 6 | loss: 0.6186374
	speed: 0.0094s/iter; left time: 2.5256s
Updating learning rate to 9.31177255625e-06
Validation loss decreased (0.5353 --> 0.5294).  Saving model state dict ...
Epoch: 6 cost time: 0.7169361114501953
Epoch: 6, Steps: 123 | Train Loss: 0.6186374 Vali Loss: 0.5294118 Best vali loss: 0.5294118
	iters: 100, epoch: 7 | loss: 0.5909415
	speed: 0.0092s/iter; left time: 1.3504s
Updating learning rate to 4.655886278125e-06
Validation loss decreased (0.5294 --> 0.5287).  Saving model state dict ...
Epoch: 7 cost time: 0.7157282829284668
Epoch: 7, Steps: 123 | Train Loss: 0.5909415 Vali Loss: 0.5287114 Best vali loss: 0.5287114
	iters: 100, epoch: 8 | loss: 0.7450644
	speed: 0.0093s/iter; left time: 0.2223s
Updating learning rate to 2.3279431390625e-06
Validation loss decreased (0.5287 --> 0.5280).  Saving model state dict ...
Epoch: 8 cost time: 0.7157363891601562
Epoch: 8, Steps: 123 | Train Loss: 0.7450644 Vali Loss: 0.5279679 Best vali loss: 0.5279679

best validation loss 0.5279679002032573

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0020063969917, 'e_layers': 3, 'learning_rate': 0.0012225670436, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3092295
	speed: 0.0114s/iter; left time: 88.3930s
	iters: 200, epoch: 1 | loss: 0.9606372
	speed: 0.0043s/iter; left time: 32.5085s
	iters: 300, epoch: 1 | loss: 1.5053849
	speed: 0.0042s/iter; left time: 31.2986s
	iters: 400, epoch: 1 | loss: 1.2386638
	speed: 0.0042s/iter; left time: 30.9739s
	iters: 500, epoch: 1 | loss: 1.3148013
	speed: 0.0039s/iter; left time: 28.8186s
	iters: 600, epoch: 1 | loss: 0.5577559
	speed: 0.0038s/iter; left time: 27.2668s
	iters: 700, epoch: 1 | loss: 0.4431615
	speed: 0.0038s/iter; left time: 27.2495s
	iters: 800, epoch: 1 | loss: 0.9514284
	speed: 0.0041s/iter; left time: 28.7392s
	iters: 900, epoch: 1 | loss: 1.0187130
	speed: 0.0040s/iter; left time: 27.5124s
Updating learning rate to 0.0012225670436
Validation loss decreased (inf --> 0.6139).  Saving model state dict ...
Epoch: 1 cost time: 4.460149049758911
Epoch: 1, Steps: 979 | Train Loss: 0.9221973 Vali Loss: 0.6138911 Best vali loss: 0.6138911
	iters: 100, epoch: 2 | loss: 0.8773105
	speed: 0.0128s/iter; left time: 86.5815s
	iters: 200, epoch: 2 | loss: 0.7846774
	speed: 0.0040s/iter; left time: 26.5531s
	iters: 300, epoch: 2 | loss: 0.5832193
	speed: 0.0037s/iter; left time: 24.5554s
	iters: 400, epoch: 2 | loss: 0.8520448
	speed: 0.0040s/iter; left time: 25.5529s
	iters: 500, epoch: 2 | loss: 1.3343693
	speed: 0.0038s/iter; left time: 24.0915s
	iters: 600, epoch: 2 | loss: 0.9907550
	speed: 0.0039s/iter; left time: 24.5588s
	iters: 700, epoch: 2 | loss: 0.5441463
	speed: 0.0039s/iter; left time: 23.7643s
	iters: 800, epoch: 2 | loss: 0.5612805
	speed: 0.0039s/iter; left time: 23.6786s
	iters: 900, epoch: 2 | loss: 1.2086017
	speed: 0.0038s/iter; left time: 22.4151s
Updating learning rate to 0.0006112835218
Validation loss decreased (0.6139 --> 0.6104).  Saving model state dict ...
Epoch: 2 cost time: 3.8405797481536865
Epoch: 2, Steps: 979 | Train Loss: 0.8596005 Vali Loss: 0.6103661 Best vali loss: 0.6103661
	iters: 100, epoch: 3 | loss: 0.7314758
	speed: 0.0127s/iter; left time: 73.3237s
	iters: 200, epoch: 3 | loss: 0.5764760
	speed: 0.0040s/iter; left time: 22.6158s
	iters: 300, epoch: 3 | loss: 0.3540142
	speed: 0.0040s/iter; left time: 22.0222s
	iters: 400, epoch: 3 | loss: 0.6062500
	speed: 0.0040s/iter; left time: 21.6713s
	iters: 500, epoch: 3 | loss: 0.6061907
	speed: 0.0040s/iter; left time: 21.3599s
	iters: 600, epoch: 3 | loss: 0.5691250
	speed: 0.0040s/iter; left time: 21.2919s
	iters: 700, epoch: 3 | loss: 0.9866674
	speed: 0.0040s/iter; left time: 20.5816s
	iters: 800, epoch: 3 | loss: 1.5291916
	speed: 0.0040s/iter; left time: 20.0952s
	iters: 900, epoch: 3 | loss: 0.8410445
	speed: 0.0040s/iter; left time: 20.0938s
Updating learning rate to 0.0003056417609
Epoch: 3 cost time: 3.947702407836914
Epoch: 3, Steps: 979 | Train Loss: 0.7556039 Vali Loss: 0.6131147 Best vali loss: 0.6103661

best validation loss 0.6103660609092165

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010504832106, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744523
	speed: 0.0128s/iter; left time: 11.3068s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.198573112487793
Epoch: 1, Steps: 123 | Train Loss: 0.7744523 Vali Loss: 0.6173793 Best vali loss: 0.6173793
	iters: 100, epoch: 2 | loss: 0.9453925
	speed: 0.0092s/iter; left time: 7.0078s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6174 --> 0.5833).  Saving model state dict ...
Epoch: 2 cost time: 0.7217175960540771
Epoch: 2, Steps: 123 | Train Loss: 0.9453925 Vali Loss: 0.5832735 Best vali loss: 0.5832735
	iters: 100, epoch: 3 | loss: 0.8403483
	speed: 0.0094s/iter; left time: 6.0054s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5833 --> 0.5409).  Saving model state dict ...
Epoch: 3 cost time: 0.7251636981964111
Epoch: 3, Steps: 123 | Train Loss: 0.8403483 Vali Loss: 0.5409014 Best vali loss: 0.5409014

best validation loss 0.5409014134261411

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012228413212, 'e_layers': 3, 'learning_rate': 0.0003253069217, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031292566422144085
Validation loss decreased (inf --> 0.5994).  Saving model state dict ...
Epoch: 1 cost time: 0.7818119525909424
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5993740 Best vali loss: 0.5993740
Updating learning rate to 0.00027766682600049563
Epoch: 2 cost time: 0.4763162136077881
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5994193 Best vali loss: 0.5993740
Updating learning rate to 0.00022489824553413877
Validation loss decreased (0.5994 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 0.48069024085998535
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5537688 Best vali loss: 0.5537688

best validation loss 0.5537687909376947

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010504832106, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5892895
	speed: 0.0119s/iter; left time: 6.1366s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5409 --> 0.5323).  Saving model state dict ...
Epoch: 4 cost time: 1.0130078792572021
Epoch: 4, Steps: 123 | Train Loss: 0.5892895 Vali Loss: 0.5323375 Best vali loss: 0.5323375
	iters: 100, epoch: 5 | loss: 0.8268212
	speed: 0.0092s/iter; left time: 3.6042s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5323 --> 0.5275).  Saving model state dict ...
Epoch: 5 cost time: 0.7069733142852783
Epoch: 5, Steps: 123 | Train Loss: 0.8268212 Vali Loss: 0.5275250 Best vali loss: 0.5275250
	iters: 100, epoch: 6 | loss: 0.7691230
	speed: 0.0092s/iter; left time: 2.4835s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7172813415527344
Epoch: 6, Steps: 123 | Train Loss: 0.7691230 Vali Loss: 0.5303365 Best vali loss: 0.5275250
	iters: 100, epoch: 7 | loss: 0.4381804
	speed: 0.0090s/iter; left time: 1.3194s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7111961841583252
Epoch: 7, Steps: 123 | Train Loss: 0.4381804 Vali Loss: 0.5390363 Best vali loss: 0.5275250
	iters: 100, epoch: 8 | loss: 0.5060374
	speed: 0.0089s/iter; left time: 0.2131s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7153596878051758
Epoch: 8, Steps: 123 | Train Loss: 0.5060374 Vali Loss: 0.5423986 Best vali loss: 0.5275250

best validation loss 0.5275250450431721

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745463
	speed: 0.0118s/iter; left time: 10.4025s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0218448638916016
Epoch: 1, Steps: 123 | Train Loss: 0.7745463 Vali Loss: 0.6172840 Best vali loss: 0.6172840
	iters: 100, epoch: 2 | loss: 0.9513600
	speed: 0.0091s/iter; left time: 6.9513s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5734).  Saving model state dict ...
Epoch: 2 cost time: 0.7146594524383545
Epoch: 2, Steps: 123 | Train Loss: 0.9513600 Vali Loss: 0.5733840 Best vali loss: 0.5733840
	iters: 100, epoch: 3 | loss: 0.8482819
	speed: 0.0094s/iter; left time: 5.9979s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5734 --> 0.5476).  Saving model state dict ...
Epoch: 3 cost time: 0.717942476272583
Epoch: 3, Steps: 123 | Train Loss: 0.8482819 Vali Loss: 0.5476413 Best vali loss: 0.5476413
	iters: 100, epoch: 4 | loss: 0.4959763
	speed: 0.0092s/iter; left time: 4.7464s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5476 --> 0.5421).  Saving model state dict ...
Epoch: 4 cost time: 0.7182509899139404
Epoch: 4, Steps: 123 | Train Loss: 0.4959763 Vali Loss: 0.5420817 Best vali loss: 0.5420817
	iters: 100, epoch: 5 | loss: 0.5592461
	speed: 0.0092s/iter; left time: 3.6160s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5421 --> 0.5229).  Saving model state dict ...
Epoch: 5 cost time: 0.7213897705078125
Epoch: 5, Steps: 123 | Train Loss: 0.5592461 Vali Loss: 0.5229412 Best vali loss: 0.5229412
	iters: 100, epoch: 6 | loss: 0.5820529
	speed: 0.0092s/iter; left time: 2.4870s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.71236252784729
Epoch: 6, Steps: 123 | Train Loss: 0.5820529 Vali Loss: 0.5390276 Best vali loss: 0.5229412
	iters: 100, epoch: 7 | loss: 0.5359135
	speed: 0.0088s/iter; left time: 1.2889s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7094054222106934
Epoch: 7, Steps: 123 | Train Loss: 0.5359135 Vali Loss: 0.5373225 Best vali loss: 0.5229412
	iters: 100, epoch: 8 | loss: 0.6959219
	speed: 0.0089s/iter; left time: 0.2134s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7092735767364502
Epoch: 8, Steps: 123 | Train Loss: 0.6959219 Vali Loss: 0.5417136 Best vali loss: 0.5229412

best validation loss 0.522941220336245

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0017159356462, 'e_layers': 2, 'learning_rate': 0.0019301088022, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4455327
	speed: 0.0097s/iter; left time: 37.0851s
	iters: 200, epoch: 1 | loss: 0.8825287
	speed: 0.0035s/iter; left time: 12.8630s
	iters: 300, epoch: 1 | loss: 1.1655918
	speed: 0.0034s/iter; left time: 12.3227s
	iters: 400, epoch: 1 | loss: 1.4176148
	speed: 0.0037s/iter; left time: 12.9670s
Updating learning rate to 0.0019301088022
Validation loss decreased (inf --> 0.6061).  Saving model state dict ...
Epoch: 1 cost time: 2.079519748687744
Epoch: 1, Steps: 490 | Train Loss: 0.9778170 Vali Loss: 0.6061177 Best vali loss: 0.6061177
	iters: 100, epoch: 2 | loss: 0.8771020
	speed: 0.0101s/iter; left time: 33.7009s
	iters: 200, epoch: 2 | loss: 0.6566172
	speed: 0.0034s/iter; left time: 10.8543s
	iters: 300, epoch: 2 | loss: 1.0581266
	speed: 0.0033s/iter; left time: 10.2394s
	iters: 400, epoch: 2 | loss: 1.0501950
	speed: 0.0032s/iter; left time: 9.7649s
Updating learning rate to 0.0009650544011
Validation loss decreased (0.6061 --> 0.6052).  Saving model state dict ...
Epoch: 2 cost time: 1.6789307594299316
Epoch: 2, Steps: 490 | Train Loss: 0.9105102 Vali Loss: 0.6051892 Best vali loss: 0.6051892
	iters: 100, epoch: 3 | loss: 0.7353037
	speed: 0.0103s/iter; left time: 29.1840s
	iters: 200, epoch: 3 | loss: 0.7490754
	speed: 0.0039s/iter; left time: 10.7277s
	iters: 300, epoch: 3 | loss: 0.9527129
	speed: 0.0038s/iter; left time: 9.9931s
	iters: 400, epoch: 3 | loss: 1.0234166
	speed: 0.0036s/iter; left time: 9.1451s
Updating learning rate to 0.00048252720055
Epoch: 3 cost time: 1.886138677597046
Epoch: 3, Steps: 490 | Train Loss: 0.8651271 Vali Loss: 0.6363012 Best vali loss: 0.6051892
	iters: 100, epoch: 4 | loss: 0.4529322
	speed: 0.0099s/iter; left time: 23.2651s
	iters: 200, epoch: 4 | loss: 0.7926348
	speed: 0.0032s/iter; left time: 7.2304s
	iters: 300, epoch: 4 | loss: 1.1368500
	speed: 0.0033s/iter; left time: 7.0540s
	iters: 400, epoch: 4 | loss: 0.6705589
	speed: 0.0034s/iter; left time: 6.8969s
Updating learning rate to 0.000241263600275
Epoch: 4 cost time: 1.6604409217834473
Epoch: 4, Steps: 490 | Train Loss: 0.7632440 Vali Loss: 0.6492469 Best vali loss: 0.6051892
	iters: 100, epoch: 5 | loss: 0.9218519
	speed: 0.0096s/iter; left time: 17.7941s
	iters: 200, epoch: 5 | loss: 0.6898723
	speed: 0.0031s/iter; left time: 5.5142s
	iters: 300, epoch: 5 | loss: 1.0215088
	speed: 0.0032s/iter; left time: 5.3236s
	iters: 400, epoch: 5 | loss: 1.1801554
	speed: 0.0033s/iter; left time: 5.1883s
Updating learning rate to 0.0001206318001375
Epoch: 5 cost time: 1.6063430309295654
Epoch: 5, Steps: 490 | Train Loss: 0.9533471 Vali Loss: 0.6462979 Best vali loss: 0.6051892
	iters: 100, epoch: 6 | loss: 0.4280277
	speed: 0.0091s/iter; left time: 12.5317s
	iters: 200, epoch: 6 | loss: 0.6870492
	speed: 0.0032s/iter; left time: 4.1188s
	iters: 300, epoch: 6 | loss: 0.5445367
	speed: 0.0034s/iter; left time: 3.9882s
	iters: 400, epoch: 6 | loss: 0.6978273
	speed: 0.0032s/iter; left time: 3.4058s
Updating learning rate to 6.031590006875e-05
Epoch: 6 cost time: 1.6375534534454346
Epoch: 6, Steps: 490 | Train Loss: 0.5893602 Vali Loss: 0.6477870 Best vali loss: 0.6051892
	iters: 100, epoch: 7 | loss: 0.8955783
	speed: 0.0093s/iter; left time: 8.2039s
	iters: 200, epoch: 7 | loss: 0.8663731
	speed: 0.0034s/iter; left time: 2.6594s
	iters: 300, epoch: 7 | loss: 0.9248690
	speed: 0.0034s/iter; left time: 2.3291s
	iters: 400, epoch: 7 | loss: 0.6028831
	speed: 0.0033s/iter; left time: 1.9236s
Updating learning rate to 3.0157950034375e-05
Epoch: 7 cost time: 1.6684238910675049
Epoch: 7, Steps: 490 | Train Loss: 0.8224259 Vali Loss: 0.6469379 Best vali loss: 0.6051892
	iters: 100, epoch: 8 | loss: 0.9393845
	speed: 0.0093s/iter; left time: 3.6510s
	iters: 200, epoch: 8 | loss: 0.8189449
	speed: 0.0033s/iter; left time: 0.9539s
	iters: 300, epoch: 8 | loss: 0.8219730
	speed: 0.0032s/iter; left time: 0.6048s
	iters: 400, epoch: 8 | loss: 0.4952345
	speed: 0.0032s/iter; left time: 0.2923s
Updating learning rate to 1.50789750171875e-05
Epoch: 8 cost time: 1.6255426406860352
Epoch: 8, Steps: 490 | Train Loss: 0.7688842 Vali Loss: 0.6491435 Best vali loss: 0.6051892

best validation loss 0.6051892029610236

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.000250178092, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7684267
	speed: 0.0119s/iter; left time: 10.5366s
Updating learning rate to 0.00024065625534076284
Validation loss decreased (inf --> 0.6141).  Saving model state dict ...
Epoch: 1 cost time: 1.0333824157714844
Epoch: 1, Steps: 123 | Train Loss: 0.7684267 Vali Loss: 0.6140732 Best vali loss: 0.6140732
	iters: 100, epoch: 2 | loss: 0.9290708
	speed: 0.0092s/iter; left time: 6.9833s
Updating learning rate to 0.00021354035867875596
Validation loss decreased (0.6141 --> 0.5533).  Saving model state dict ...
Epoch: 2 cost time: 0.7209341526031494
Epoch: 2, Steps: 123 | Train Loss: 0.9290708 Vali Loss: 0.5532830 Best vali loss: 0.5532830
	iters: 100, epoch: 3 | loss: 0.8515464
	speed: 0.0093s/iter; left time: 5.9327s
Updating learning rate to 0.0001729585514745546
Validation loss decreased (0.5533 --> 0.5494).  Saving model state dict ...
Epoch: 3 cost time: 0.7150211334228516
Epoch: 3, Steps: 123 | Train Loss: 0.8515464 Vali Loss: 0.5493960 Best vali loss: 0.5493960

best validation loss 0.5493960397655023

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010473680636, 'e_layers': 2, 'learning_rate': 0.0002557496037, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7694035
	speed: 0.0118s/iter; left time: 10.4042s
Updating learning rate to 0.0002460157140031514
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 1.0163490772247314
Epoch: 1, Steps: 123 | Train Loss: 0.7694035 Vali Loss: 0.6143537 Best vali loss: 0.6143537
	iters: 100, epoch: 2 | loss: 0.9380482
	speed: 0.0090s/iter; left time: 6.8710s
Updating learning rate to 0.00021829594138102104
Validation loss decreased (0.6144 --> 0.5540).  Saving model state dict ...
Epoch: 2 cost time: 0.711561918258667
Epoch: 2, Steps: 123 | Train Loss: 0.9380482 Vali Loss: 0.5539638 Best vali loss: 0.5539638
	iters: 100, epoch: 3 | loss: 0.8509983
	speed: 0.0092s/iter; left time: 5.8965s
Updating learning rate to 0.00017681036993496372
Validation loss decreased (0.5540 --> 0.5447).  Saving model state dict ...
Epoch: 3 cost time: 0.7148151397705078
Epoch: 3, Steps: 123 | Train Loss: 0.8509983 Vali Loss: 0.5447023 Best vali loss: 0.5447023

best validation loss 0.5447023131129147

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013724012848, 'e_layers': 2, 'learning_rate': 0.0002472878907, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7681638
	speed: 0.0118s/iter; left time: 10.4294s
Updating learning rate to 0.00023787605577780906
Validation loss decreased (inf --> 0.6138).  Saving model state dict ...
Epoch: 1 cost time: 1.023998498916626
Epoch: 1, Steps: 123 | Train Loss: 0.7681638 Vali Loss: 0.6137924 Best vali loss: 0.6137924
	iters: 100, epoch: 2 | loss: 0.9225493
	speed: 0.0092s/iter; left time: 7.0175s
Updating learning rate to 0.00021107341755964386
Validation loss decreased (0.6138 --> 0.5639).  Saving model state dict ...
Epoch: 2 cost time: 0.7204971313476562
Epoch: 2, Steps: 123 | Train Loss: 0.9225493 Vali Loss: 0.5638859 Best vali loss: 0.5638859
	iters: 100, epoch: 3 | loss: 0.8446996
	speed: 0.0094s/iter; left time: 5.9812s
Updating learning rate to 0.00017096043474769957
Epoch: 3 cost time: 0.716728925704956
Epoch: 3, Steps: 123 | Train Loss: 0.8446996 Vali Loss: 0.5652652 Best vali loss: 0.5638859

best validation loss 0.5638859125542894

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010473680636, 'e_layers': 2, 'learning_rate': 0.0002557496037, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5948015
	speed: 0.0114s/iter; left time: 5.8583s
Updating learning rate to 0.00012787480185
Validation loss decreased (0.5447 --> 0.5313).  Saving model state dict ...
Epoch: 4 cost time: 1.024543285369873
Epoch: 4, Steps: 123 | Train Loss: 0.5948015 Vali Loss: 0.5313111 Best vali loss: 0.5313111
	iters: 100, epoch: 5 | loss: 0.8315200
	speed: 0.0092s/iter; left time: 3.6071s
Updating learning rate to 7.893923376503627e-05
Validation loss decreased (0.5313 --> 0.5260).  Saving model state dict ...
Epoch: 5 cost time: 0.7098276615142822
Epoch: 5, Steps: 123 | Train Loss: 0.8315200 Vali Loss: 0.5260085 Best vali loss: 0.5260085
	iters: 100, epoch: 6 | loss: 0.7731240
	speed: 0.0092s/iter; left time: 2.4869s
Updating learning rate to 3.745366231897893e-05
Epoch: 6 cost time: 0.7179603576660156
Epoch: 6, Steps: 123 | Train Loss: 0.7731240 Vali Loss: 0.5301546 Best vali loss: 0.5260085
	iters: 100, epoch: 7 | loss: 0.4608571
	speed: 0.0090s/iter; left time: 1.3185s
Updating learning rate to 9.733889696848575e-06
Epoch: 7 cost time: 0.7239723205566406
Epoch: 7, Steps: 123 | Train Loss: 0.4608571 Vali Loss: 0.5342031 Best vali loss: 0.5260085
	iters: 100, epoch: 8 | loss: 0.5237325
	speed: 0.0090s/iter; left time: 0.2157s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7110257148742676
Epoch: 8, Steps: 123 | Train Loss: 0.5237325 Vali Loss: 0.5328806 Best vali loss: 0.5260085

best validation loss 0.5260085125093049

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001049483612, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8612115383148193
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020114 Best vali loss: 0.6020114
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6020 --> 0.5715).  Saving model state dict ...
Epoch: 2 cost time: 0.5742323398590088
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5715333 Best vali loss: 0.5715333
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5715 --> 0.5603).  Saving model state dict ...
Epoch: 3 cost time: 0.5716509819030762
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5602911 Best vali loss: 0.5602911
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5603 --> 0.5414).  Saving model state dict ...
Epoch: 4 cost time: 0.5737283229827881
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5414307 Best vali loss: 0.5414307
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 0.5743899345397949
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5451651 Best vali loss: 0.5414307
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.5798346996307373
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5446871 Best vali loss: 0.5414307
Updating learning rate to 1.1335582155876705e-05
Validation loss decreased (0.5414 --> 0.5379).  Saving model state dict ...
Epoch: 7 cost time: 0.5671591758728027
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5378824 Best vali loss: 0.5378824
Updating learning rate to 0.0
Validation loss decreased (0.5379 --> 0.5350).  Saving model state dict ...
Epoch: 8 cost time: 0.5666189193725586
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5350087 Best vali loss: 0.5350087

best validation loss 0.5350086688719542

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011239943661, 'e_layers': 2, 'learning_rate': 0.0015763529433, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8055534
	speed: 0.0109s/iter; left time: 9.6454s
Updating learning rate to 0.0015763529433
Validation loss decreased (inf --> 0.6146).  Saving model state dict ...
Epoch: 1 cost time: 0.9209659099578857
Epoch: 1, Steps: 123 | Train Loss: 0.8055534 Vali Loss: 0.6145860 Best vali loss: 0.6145860
	iters: 100, epoch: 2 | loss: 0.8633461
	speed: 0.0074s/iter; left time: 5.6446s
Updating learning rate to 0.00078817647165
Epoch: 2 cost time: 0.5668160915374756
Epoch: 2, Steps: 123 | Train Loss: 0.8633461 Vali Loss: 0.6192961 Best vali loss: 0.6145860
	iters: 100, epoch: 3 | loss: 0.7698997
	speed: 0.0073s/iter; left time: 4.6821s
Updating learning rate to 0.000394088235825
Validation loss decreased (0.6146 --> 0.6120).  Saving model state dict ...
Epoch: 3 cost time: 0.5751285552978516
Epoch: 3, Steps: 123 | Train Loss: 0.7698997 Vali Loss: 0.6120487 Best vali loss: 0.6120487
	iters: 100, epoch: 4 | loss: 0.6658048
	speed: 0.0078s/iter; left time: 4.0091s
Updating learning rate to 0.0001970441179125
Epoch: 4 cost time: 0.6184122562408447
Epoch: 4, Steps: 123 | Train Loss: 0.6658048 Vali Loss: 0.6235745 Best vali loss: 0.6120487
	iters: 100, epoch: 5 | loss: 0.8511853
	speed: 0.0079s/iter; left time: 3.1173s
Updating learning rate to 9.852205895625e-05
Validation loss decreased (0.6120 --> 0.6118).  Saving model state dict ...
Epoch: 5 cost time: 0.6257929801940918
Epoch: 5, Steps: 123 | Train Loss: 0.8511853 Vali Loss: 0.6117782 Best vali loss: 0.6117782
	iters: 100, epoch: 6 | loss: 0.9174321
	speed: 0.0079s/iter; left time: 2.1324s
Updating learning rate to 4.9261029478125e-05
Epoch: 6 cost time: 0.6075015068054199
Epoch: 6, Steps: 123 | Train Loss: 0.9174321 Vali Loss: 0.6453690 Best vali loss: 0.6117782
	iters: 100, epoch: 7 | loss: 0.7457116
	speed: 0.0075s/iter; left time: 1.0993s
Updating learning rate to 2.46305147390625e-05
Epoch: 7 cost time: 0.5837829113006592
Epoch: 7, Steps: 123 | Train Loss: 0.7457116 Vali Loss: 0.6500759 Best vali loss: 0.6117782
	iters: 100, epoch: 8 | loss: 0.8110290
	speed: 0.0078s/iter; left time: 0.1861s
Updating learning rate to 1.231525736953125e-05
Epoch: 8 cost time: 0.6208624839782715
Epoch: 8, Steps: 123 | Train Loss: 0.8110290 Vali Loss: 0.6566140 Best vali loss: 0.6117782

best validation loss 0.6117781612785919

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8534436225891113
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020114 Best vali loss: 0.6020114
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6020 --> 0.5715).  Saving model state dict ...
Epoch: 2 cost time: 0.5721774101257324
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5715333 Best vali loss: 0.5715333
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5715 --> 0.5603).  Saving model state dict ...
Epoch: 3 cost time: 0.5704946517944336
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5602911 Best vali loss: 0.5602911

best validation loss 0.5602911412853822

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494070746, 'e_layers': 2, 'learning_rate': 0.0002975184157, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028619479525520737
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 0.7379357814788818
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5981526 Best vali loss: 0.5981526
Updating learning rate to 0.0002539478524846741
Validation loss decreased (0.5982 --> 0.5825).  Saving model state dict ...
Epoch: 2 cost time: 0.4715390205383301
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5824968 Best vali loss: 0.5824968
Updating learning rate to 0.00020568689210594983
Validation loss decreased (0.5825 --> 0.5610).  Saving model state dict ...
Epoch: 3 cost time: 0.4657771587371826
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5609865 Best vali loss: 0.5609865

best validation loss 0.5609865311614235

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012955190993, 'e_layers': 2, 'learning_rate': 0.0002059893081, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9178789
	speed: 0.0099s/iter; left time: 18.3774s
	iters: 200, epoch: 1 | loss: 0.7413179
	speed: 0.0037s/iter; left time: 6.5562s
Updating learning rate to 0.0002059893081
Validation loss decreased (inf --> 0.6176).  Saving model state dict ...
Epoch: 1 cost time: 1.2581794261932373
Epoch: 1, Steps: 245 | Train Loss: 0.8295984 Vali Loss: 0.6175904 Best vali loss: 0.6175904
	iters: 100, epoch: 2 | loss: 0.9159256
	speed: 0.0079s/iter; left time: 12.7744s
	iters: 200, epoch: 2 | loss: 0.9924146
	speed: 0.0038s/iter; left time: 5.8286s
Updating learning rate to 0.00010299465405
Validation loss decreased (0.6176 --> 0.6035).  Saving model state dict ...
Epoch: 2 cost time: 0.9899005889892578
Epoch: 2, Steps: 245 | Train Loss: 0.9541701 Vali Loss: 0.6035065 Best vali loss: 0.6035065
	iters: 100, epoch: 3 | loss: 0.8636138
	speed: 0.0080s/iter; left time: 10.9620s
	iters: 200, epoch: 3 | loss: 0.9996598
	speed: 0.0037s/iter; left time: 4.7530s
Updating learning rate to 5.1497327025e-05
Epoch: 3 cost time: 0.9765326976776123
Epoch: 3, Steps: 245 | Train Loss: 0.9316368 Vali Loss: 0.6077217 Best vali loss: 0.6035065

best validation loss 0.6035065052686935

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5603 --> 0.5459).  Saving model state dict ...
Epoch: 4 cost time: 0.8800582885742188
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5459120 Best vali loss: 0.5459120
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5459 --> 0.5345).  Saving model state dict ...
Epoch: 5 cost time: 0.5616676807403564
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5344933 Best vali loss: 0.5344933
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.562450647354126
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5387110 Best vali loss: 0.5344933
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.5725917816162109
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5357739 Best vali loss: 0.5344933
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5695736408233643
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5354920 Best vali loss: 0.5344933

best validation loss 0.5344933046063357

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472163264, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744676
	speed: 0.0116s/iter; left time: 10.2249s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.016589641571045
Epoch: 1, Steps: 123 | Train Loss: 0.7744676 Vali Loss: 0.6172257 Best vali loss: 0.6172257
	iters: 100, epoch: 2 | loss: 0.9525086
	speed: 0.0093s/iter; left time: 7.1116s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6172 --> 0.5598).  Saving model state dict ...
Epoch: 2 cost time: 0.7317509651184082
Epoch: 2, Steps: 123 | Train Loss: 0.9525086 Vali Loss: 0.5597717 Best vali loss: 0.5597717
	iters: 100, epoch: 3 | loss: 0.8484182
	speed: 0.0094s/iter; left time: 5.9862s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5598 --> 0.5547).  Saving model state dict ...
Epoch: 3 cost time: 0.7215242385864258
Epoch: 3, Steps: 123 | Train Loss: 0.8484182 Vali Loss: 0.5546850 Best vali loss: 0.5546850
	iters: 100, epoch: 4 | loss: 0.4909346
	speed: 0.0093s/iter; left time: 4.7981s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5547 --> 0.5411).  Saving model state dict ...
Epoch: 4 cost time: 0.7211203575134277
Epoch: 4, Steps: 123 | Train Loss: 0.4909346 Vali Loss: 0.5410889 Best vali loss: 0.5410889
	iters: 100, epoch: 5 | loss: 0.5603034
	speed: 0.0092s/iter; left time: 3.6122s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5411 --> 0.5244).  Saving model state dict ...
Epoch: 5 cost time: 0.7183079719543457
Epoch: 5, Steps: 123 | Train Loss: 0.5603034 Vali Loss: 0.5244237 Best vali loss: 0.5244237
	iters: 100, epoch: 6 | loss: 0.5875745
	speed: 0.0093s/iter; left time: 2.5214s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7223103046417236
Epoch: 6, Steps: 123 | Train Loss: 0.5875745 Vali Loss: 0.5357476 Best vali loss: 0.5244237
	iters: 100, epoch: 7 | loss: 0.5366915
	speed: 0.0090s/iter; left time: 1.3164s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7167572975158691
Epoch: 7, Steps: 123 | Train Loss: 0.5366915 Vali Loss: 0.5356720 Best vali loss: 0.5244237
	iters: 100, epoch: 8 | loss: 0.6983885
	speed: 0.0091s/iter; left time: 0.2180s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7224998474121094
Epoch: 8, Steps: 123 | Train Loss: 0.6983885 Vali Loss: 0.5399690 Best vali loss: 0.5244237

best validation loss 0.5244236911187179

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002968587958, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002855602806427838
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 0.7322325706481934
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5981519 Best vali loss: 0.5981519
Updating learning rate to 0.0002533848316825263
Validation loss decreased (0.5982 --> 0.5812).  Saving model state dict ...
Epoch: 2 cost time: 0.4601297378540039
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5811598 Best vali loss: 0.5811598
Updating learning rate to 0.00020523086935225567
Validation loss decreased (0.5812 --> 0.5750).  Saving model state dict ...
Epoch: 3 cost time: 0.46090102195739746
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5749822 Best vali loss: 0.5749822
Updating learning rate to 0.0001484293979
Validation loss decreased (0.5750 --> 0.5494).  Saving model state dict ...
Epoch: 4 cost time: 0.4574716091156006
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5493954 Best vali loss: 0.5493954
Updating learning rate to 9.162792644774436e-05
Epoch: 5 cost time: 0.4572784900665283
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5576879 Best vali loss: 0.5493954
Updating learning rate to 4.347396411747371e-05
Validation loss decreased (0.5494 --> 0.5434).  Saving model state dict ...
Epoch: 6 cost time: 0.4507429599761963
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5433652 Best vali loss: 0.5433652
Updating learning rate to 1.1298515157216235e-05
Epoch: 7 cost time: 0.4560527801513672
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5475166 Best vali loss: 0.5433652
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4530978202819824
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5445395 Best vali loss: 0.5433652

best validation loss 0.5433651585095682

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010492537659, 'e_layers': 2, 'learning_rate': 0.0002978985107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028656042375066227
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8631200790405273
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020125 Best vali loss: 0.6020125
Updating learning rate to 0.0002542722838606716
Validation loss decreased (0.6020 --> 0.5639).  Saving model state dict ...
Epoch: 2 cost time: 0.5677342414855957
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5638800 Best vali loss: 0.5638800
Updating learning rate to 0.0002059496676355622
Epoch: 3 cost time: 0.5725817680358887
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6084719 Best vali loss: 0.5638800

best validation loss 0.5638800462822515

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0001703584323, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7605262
	speed: 0.0116s/iter; left time: 10.2840s
Updating learning rate to 0.00016387455054633985
Validation loss decreased (inf --> 0.6072).  Saving model state dict ...
Epoch: 1 cost time: 1.0181636810302734
Epoch: 1, Steps: 123 | Train Loss: 0.7605262 Vali Loss: 0.6071633 Best vali loss: 0.6071633
	iters: 100, epoch: 2 | loss: 0.9444020
	speed: 0.0093s/iter; left time: 7.0638s
Updating learning rate to 0.0001454100175058197
Validation loss decreased (0.6072 --> 0.5880).  Saving model state dict ...
Epoch: 2 cost time: 0.7253608703613281
Epoch: 2, Steps: 123 | Train Loss: 0.9444020 Vali Loss: 0.5879600 Best vali loss: 0.5879600
	iters: 100, epoch: 3 | loss: 0.8621479
	speed: 0.0092s/iter; left time: 5.8854s
Updating learning rate to 0.0001177758909524499
Validation loss decreased (0.5880 --> 0.5616).  Saving model state dict ...
Epoch: 3 cost time: 0.7147738933563232
Epoch: 3, Steps: 123 | Train Loss: 0.8621479 Vali Loss: 0.5615733 Best vali loss: 0.5615733

best validation loss 0.5615732650522941

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0001687746532, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7604868
	speed: 0.0115s/iter; left time: 10.1584s
Updating learning rate to 0.0001623510504490853
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 1.0190227031707764
Epoch: 1, Steps: 123 | Train Loss: 0.7604868 Vali Loss: 0.6069990 Best vali loss: 0.6069990
	iters: 100, epoch: 2 | loss: 0.9461961
	speed: 0.0093s/iter; left time: 7.0775s
Updating learning rate to 0.0001440581774850639
Validation loss decreased (0.6070 --> 0.5858).  Saving model state dict ...
Epoch: 2 cost time: 0.722841739654541
Epoch: 2, Steps: 123 | Train Loss: 0.9461961 Vali Loss: 0.5857855 Best vali loss: 0.5857855
	iters: 100, epoch: 3 | loss: 0.8606423
	speed: 0.0094s/iter; left time: 5.9906s
Updating learning rate to 0.00011668095839140186
Validation loss decreased (0.5858 --> 0.5498).  Saving model state dict ...
Epoch: 3 cost time: 0.725334644317627
Epoch: 3, Steps: 123 | Train Loss: 0.8606423 Vali Loss: 0.5497507 Best vali loss: 0.5497507

best validation loss 0.5497507402489771

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0001687746532, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5997663
	speed: 0.0119s/iter; left time: 6.1519s
Updating learning rate to 8.43873266e-05
Validation loss decreased (0.5498 --> 0.5369).  Saving model state dict ...
Epoch: 4 cost time: 1.0238487720489502
Epoch: 4, Steps: 123 | Train Loss: 0.5997663 Vali Loss: 0.5369102 Best vali loss: 0.5369102
	iters: 100, epoch: 5 | loss: 0.8456030
	speed: 0.0102s/iter; left time: 4.0110s
Updating learning rate to 5.2093694808598166e-05
Validation loss decreased (0.5369 --> 0.5300).  Saving model state dict ...
Epoch: 5 cost time: 0.7957103252410889
Epoch: 5, Steps: 123 | Train Loss: 0.8456030 Vali Loss: 0.5300040 Best vali loss: 0.5300040
	iters: 100, epoch: 6 | loss: 0.7997077
	speed: 0.0108s/iter; left time: 2.9128s
Updating learning rate to 2.4716475714936087e-05
Validation loss decreased (0.5300 --> 0.5253).  Saving model state dict ...
Epoch: 6 cost time: 0.7987711429595947
Epoch: 6, Steps: 123 | Train Loss: 0.7997077 Vali Loss: 0.5253151 Best vali loss: 0.5253151
	iters: 100, epoch: 7 | loss: 0.4787692
	speed: 0.0111s/iter; left time: 1.6249s
Updating learning rate to 6.4236027509147285e-06
Epoch: 7 cost time: 0.8015429973602295
Epoch: 7, Steps: 123 | Train Loss: 0.4787692 Vali Loss: 0.5306102 Best vali loss: 0.5253151
	iters: 100, epoch: 8 | loss: 0.5521193
	speed: 0.0107s/iter; left time: 0.2561s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7972640991210938
Epoch: 8, Steps: 123 | Train Loss: 0.5521193 Vali Loss: 0.5265271 Best vali loss: 0.5253151

best validation loss 0.5253151389582739

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.000173267255, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7609435
	speed: 0.0116s/iter; left time: 10.2538s
Updating learning rate to 0.00016667266277445696
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 1.017059326171875
Epoch: 1, Steps: 123 | Train Loss: 0.7609435 Vali Loss: 0.6074258 Best vali loss: 0.6074258
	iters: 100, epoch: 2 | loss: 0.9473825
	speed: 0.0092s/iter; left time: 6.9992s
Updating learning rate to 0.00014789285298403936
Validation loss decreased (0.6074 --> 0.5898).  Saving model state dict ...
Epoch: 2 cost time: 0.7242536544799805
Epoch: 2, Steps: 123 | Train Loss: 0.9473825 Vali Loss: 0.5897999 Best vali loss: 0.5897999
	iters: 100, epoch: 3 | loss: 0.8511087
	speed: 0.0094s/iter; left time: 5.9937s
Updating learning rate to 0.00011978688142993863
Validation loss decreased (0.5898 --> 0.5474).  Saving model state dict ...
Epoch: 3 cost time: 0.7224094867706299
Epoch: 3, Steps: 123 | Train Loss: 0.8511087 Vali Loss: 0.5474316 Best vali loss: 0.5474316
	iters: 100, epoch: 4 | loss: 0.5015399
	speed: 0.0093s/iter; left time: 4.8037s
Updating learning rate to 8.66336275e-05
Validation loss decreased (0.5474 --> 0.5474).  Saving model state dict ...
Epoch: 4 cost time: 0.7181482315063477
Epoch: 4, Steps: 123 | Train Loss: 0.5015399 Vali Loss: 0.5473614 Best vali loss: 0.5473614
	iters: 100, epoch: 5 | loss: 0.5718443
	speed: 0.0092s/iter; left time: 3.6280s
Updating learning rate to 5.348037357006137e-05
Validation loss decreased (0.5474 --> 0.5350).  Saving model state dict ...
Epoch: 5 cost time: 0.7177987098693848
Epoch: 5, Steps: 123 | Train Loss: 0.5718443 Vali Loss: 0.5349769 Best vali loss: 0.5349769
	iters: 100, epoch: 6 | loss: 0.6202508
	speed: 0.0092s/iter; left time: 2.4956s
Updating learning rate to 2.537440201596064e-05
Validation loss decreased (0.5350 --> 0.5294).  Saving model state dict ...
Epoch: 6 cost time: 0.7270479202270508
Epoch: 6, Steps: 123 | Train Loss: 0.6202508 Vali Loss: 0.5294231 Best vali loss: 0.5294231
	iters: 100, epoch: 7 | loss: 0.5784723
	speed: 0.0094s/iter; left time: 1.3858s
Updating learning rate to 6.594592225543045e-06
Validation loss decreased (0.5294 --> 0.5277).  Saving model state dict ...
Epoch: 7 cost time: 0.7266309261322021
Epoch: 7, Steps: 123 | Train Loss: 0.5784723 Vali Loss: 0.5277366 Best vali loss: 0.5277366
	iters: 100, epoch: 8 | loss: 0.7438815
	speed: 0.0094s/iter; left time: 0.2251s
Updating learning rate to 0.0
Validation loss decreased (0.5277 --> 0.5250).  Saving model state dict ...
Epoch: 8 cost time: 0.7225711345672607
Epoch: 8, Steps: 123 | Train Loss: 0.7438815 Vali Loss: 0.5250348 Best vali loss: 0.5250348

best validation loss 0.5250347993099155

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0101455890769, 'e_layers': 3, 'learning_rate': 0.0007259579335, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007259579335
Validation loss decreased (inf --> 0.6009).  Saving model state dict ...
Epoch: 1 cost time: 0.9415721893310547
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6008900 Best vali loss: 0.6008900
Updating learning rate to 0.00036297896675
Validation loss decreased (0.6009 --> 0.5550).  Saving model state dict ...
Epoch: 2 cost time: 0.6275053024291992
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5550164 Best vali loss: 0.5550164
Updating learning rate to 0.000181489483375
Epoch: 3 cost time: 0.7101678848266602
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5625855 Best vali loss: 0.5550164
Updating learning rate to 9.07447416875e-05
Validation loss decreased (0.5550 --> 0.5490).  Saving model state dict ...
Epoch: 4 cost time: 0.630854606628418
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5489633 Best vali loss: 0.5489633
Updating learning rate to 4.537237084375e-05
Validation loss decreased (0.5490 --> 0.5397).  Saving model state dict ...
Epoch: 5 cost time: 0.7072606086730957
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5396599 Best vali loss: 0.5396599
Updating learning rate to 2.2686185421875e-05
Epoch: 6 cost time: 0.6284327507019043
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5408720 Best vali loss: 0.5396599
Updating learning rate to 1.13430927109375e-05
Validation loss decreased (0.5397 --> 0.5392).  Saving model state dict ...
Epoch: 7 cost time: 0.7177677154541016
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5392028 Best vali loss: 0.5392028
Updating learning rate to 5.67154635546875e-06
Epoch: 8 cost time: 0.6386246681213379
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5430858 Best vali loss: 0.5392028

best validation loss 0.5392028373295044

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010495464749, 'e_layers': 2, 'learning_rate': 0.000165747938, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7599926
	speed: 0.0117s/iter; left time: 10.3140s
Updating learning rate to 0.00015943953273707485
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 1.0241973400115967
Epoch: 1, Steps: 123 | Train Loss: 0.7599926 Vali Loss: 0.6067202 Best vali loss: 0.6067202
	iters: 100, epoch: 2 | loss: 0.9440956
	speed: 0.0092s/iter; left time: 7.0386s
Updating learning rate to 0.0001414747144637437
Validation loss decreased (0.6067 --> 0.5834).  Saving model state dict ...
Epoch: 2 cost time: 0.7292666435241699
Epoch: 2, Steps: 123 | Train Loss: 0.9440956 Vali Loss: 0.5834008 Best vali loss: 0.5834008
	iters: 100, epoch: 3 | loss: 0.8600403
	speed: 0.0102s/iter; left time: 6.4938s
Updating learning rate to 0.00011458846391063805
Validation loss decreased (0.5834 --> 0.5514).  Saving model state dict ...
Epoch: 3 cost time: 0.8046684265136719
Epoch: 3, Steps: 123 | Train Loss: 0.8600403 Vali Loss: 0.5513903 Best vali loss: 0.5513903

best validation loss 0.5513903319090949

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010491444122, 'e_layers': 2, 'learning_rate': 0.0002237417775, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7655345
	speed: 0.0116s/iter; left time: 10.2783s
Updating learning rate to 0.00021522611314997217
Validation loss decreased (inf --> 0.6118).  Saving model state dict ...
Epoch: 1 cost time: 1.0318639278411865
Epoch: 1, Steps: 123 | Train Loss: 0.7655345 Vali Loss: 0.6118296 Best vali loss: 0.6118296
	iters: 100, epoch: 2 | loss: 0.9250271
	speed: 0.0092s/iter; left time: 7.0335s
Updating learning rate to 0.00019097555280249084
Validation loss decreased (0.6118 --> 0.5454).  Saving model state dict ...
Epoch: 2 cost time: 0.7226765155792236
Epoch: 2, Steps: 123 | Train Loss: 0.9250271 Vali Loss: 0.5454042 Best vali loss: 0.5454042
	iters: 100, epoch: 3 | loss: 0.8443680
	speed: 0.0102s/iter; left time: 6.4870s
Updating learning rate to 0.0001546820244385831
Epoch: 3 cost time: 0.8111319541931152
Epoch: 3, Steps: 123 | Train Loss: 0.8443680 Vali Loss: 0.5463004 Best vali loss: 0.5454042

best validation loss 0.5454042332970065

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0018070556985, 'e_layers': 2, 'learning_rate': 0.0003857584807, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4502076
	speed: 0.0097s/iter; left time: 36.9268s
	iters: 200, epoch: 1 | loss: 1.2570430
	speed: 0.0033s/iter; left time: 12.2990s
	iters: 300, epoch: 1 | loss: 0.9723444
	speed: 0.0033s/iter; left time: 12.0628s
	iters: 400, epoch: 1 | loss: 0.4837520
	speed: 0.0033s/iter; left time: 11.5649s
Updating learning rate to 0.0003857584807
Validation loss decreased (inf --> 0.6063).  Saving model state dict ...
Epoch: 1 cost time: 1.9984016418457031
Epoch: 1, Steps: 490 | Train Loss: 0.7908367 Vali Loss: 0.6062633 Best vali loss: 0.6062633
	iters: 100, epoch: 2 | loss: 0.5262887
	speed: 0.0097s/iter; left time: 32.2653s
	iters: 200, epoch: 2 | loss: 0.6574762
	speed: 0.0033s/iter; left time: 10.7417s
	iters: 300, epoch: 2 | loss: 1.2254118
	speed: 0.0032s/iter; left time: 10.1495s
	iters: 400, epoch: 2 | loss: 1.2849989
	speed: 0.0033s/iter; left time: 9.9705s
Updating learning rate to 0.00019287924035
Epoch: 2 cost time: 1.680396318435669
Epoch: 2, Steps: 490 | Train Loss: 0.9235439 Vali Loss: 0.6146668 Best vali loss: 0.6062633
	iters: 100, epoch: 3 | loss: 0.7968552
	speed: 0.0100s/iter; left time: 28.3671s
	iters: 200, epoch: 3 | loss: 0.5320244
	speed: 0.0035s/iter; left time: 9.7086s
	iters: 300, epoch: 3 | loss: 0.5408825
	speed: 0.0037s/iter; left time: 9.6421s
	iters: 400, epoch: 3 | loss: 0.6086727
	speed: 0.0037s/iter; left time: 9.3908s
Updating learning rate to 9.6439620175e-05
Epoch: 3 cost time: 1.7913992404937744
Epoch: 3, Steps: 490 | Train Loss: 0.6196087 Vali Loss: 0.6103544 Best vali loss: 0.6062633

best validation loss 0.6062632737364939

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010491444122, 'e_layers': 2, 'learning_rate': 0.0002237417775, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5971723
	speed: 0.0121s/iter; left time: 6.2301s
Updating learning rate to 0.00011187088875
Validation loss decreased (0.5454 --> 0.5360).  Saving model state dict ...
Epoch: 4 cost time: 1.047593355178833
Epoch: 4, Steps: 123 | Train Loss: 0.5971723 Vali Loss: 0.5360086 Best vali loss: 0.5360086
	iters: 100, epoch: 5 | loss: 0.8347012
	speed: 0.0094s/iter; left time: 3.6999s
Updating learning rate to 6.90597530614169e-05
Validation loss decreased (0.5360 --> 0.5276).  Saving model state dict ...
Epoch: 5 cost time: 0.7228047847747803
Epoch: 5, Steps: 123 | Train Loss: 0.8347012 Vali Loss: 0.5275624 Best vali loss: 0.5275624
	iters: 100, epoch: 6 | loss: 0.7866893
	speed: 0.0093s/iter; left time: 2.5244s
Updating learning rate to 3.276622469750915e-05
Validation loss decreased (0.5276 --> 0.5274).  Saving model state dict ...
Epoch: 6 cost time: 0.728888750076294
Epoch: 6, Steps: 123 | Train Loss: 0.7866893 Vali Loss: 0.5273912 Best vali loss: 0.5273912
	iters: 100, epoch: 7 | loss: 0.4694481
	speed: 0.0093s/iter; left time: 1.3744s
Updating learning rate to 8.515664350027833e-06
Epoch: 7 cost time: 0.7259535789489746
Epoch: 7, Steps: 123 | Train Loss: 0.4694481 Vali Loss: 0.5295591 Best vali loss: 0.5273912
	iters: 100, epoch: 8 | loss: 0.5312647
	speed: 0.0090s/iter; left time: 0.2153s
Updating learning rate to 0.0
Validation loss decreased (0.5274 --> 0.5262).  Saving model state dict ...
Epoch: 8 cost time: 0.718935489654541
Epoch: 8, Steps: 123 | Train Loss: 0.5312647 Vali Loss: 0.5261546 Best vali loss: 0.5261546

best validation loss 0.5261545795524964

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 4, 'learning_rate': 0.0001861412533, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7458595
	speed: 0.0161s/iter; left time: 14.2788s
Updating learning rate to 0.00017905667368993451
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 1.5851249694824219
Epoch: 1, Steps: 123 | Train Loss: 0.7458595 Vali Loss: 0.6034641 Best vali loss: 0.6034641
	iters: 100, epoch: 2 | loss: 0.9746998
	speed: 0.0155s/iter; left time: 11.7830s
Updating learning rate to 0.0001588814978834964
Validation loss decreased (0.6035 --> 0.6035).  Saving model state dict ...
Epoch: 2 cost time: 1.2749969959259033
Epoch: 2, Steps: 123 | Train Loss: 0.9746998 Vali Loss: 0.6034508 Best vali loss: 0.6034508
	iters: 100, epoch: 3 | loss: 0.7553483
	speed: 0.0156s/iter; left time: 9.9824s
Updating learning rate to 0.0001286872135087918
Validation loss decreased (0.6035 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 1.2728655338287354
Epoch: 3, Steps: 123 | Train Loss: 0.7553483 Vali Loss: 0.5537885 Best vali loss: 0.5537885
	iters: 100, epoch: 4 | loss: 0.5784402
	speed: 0.0156s/iter; left time: 8.0678s
Updating learning rate to 9.307062665e-05
Validation loss decreased (0.5538 --> 0.5475).  Saving model state dict ...
Epoch: 4 cost time: 1.2804033756256104
Epoch: 4, Steps: 123 | Train Loss: 0.5784402 Vali Loss: 0.5474796 Best vali loss: 0.5474796
	iters: 100, epoch: 5 | loss: 0.5980348
	speed: 0.0157s/iter; left time: 6.1506s
Updating learning rate to 5.745403979120821e-05
Validation loss decreased (0.5475 --> 0.5427).  Saving model state dict ...
Epoch: 5 cost time: 1.2740364074707031
Epoch: 5, Steps: 123 | Train Loss: 0.5980348 Vali Loss: 0.5426769 Best vali loss: 0.5426769
	iters: 100, epoch: 6 | loss: 0.6647630
	speed: 0.0157s/iter; left time: 4.2388s
Updating learning rate to 2.7259755416503596e-05
Epoch: 6 cost time: 1.2826900482177734
Epoch: 6, Steps: 123 | Train Loss: 0.6647630 Vali Loss: 0.5642941 Best vali loss: 0.5426769
	iters: 100, epoch: 7 | loss: 0.6471426
	speed: 0.0150s/iter; left time: 2.2066s
Updating learning rate to 7.084579610065495e-06
Epoch: 7 cost time: 1.2782392501831055
Epoch: 7, Steps: 123 | Train Loss: 0.6471426 Vali Loss: 0.5793197 Best vali loss: 0.5426769
	iters: 100, epoch: 8 | loss: 0.6035601
	speed: 0.0151s/iter; left time: 0.3635s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2764842510223389
Epoch: 8, Steps: 123 | Train Loss: 0.6035601 Vali Loss: 0.5850651 Best vali loss: 0.5426769

best validation loss 0.5426768520980563

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745875
	speed: 0.0117s/iter; left time: 10.3448s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0254876613616943
Epoch: 1, Steps: 123 | Train Loss: 0.7745875 Vali Loss: 0.6172987 Best vali loss: 0.6172987
	iters: 100, epoch: 2 | loss: 0.9521514
	speed: 0.0093s/iter; left time: 7.0754s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5963).  Saving model state dict ...
Epoch: 2 cost time: 0.7317659854888916
Epoch: 2, Steps: 123 | Train Loss: 0.9521514 Vali Loss: 0.5963138 Best vali loss: 0.5963138
	iters: 100, epoch: 3 | loss: 0.8584358
	speed: 0.0094s/iter; left time: 5.9772s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5963 --> 0.5410).  Saving model state dict ...
Epoch: 3 cost time: 0.7197971343994141
Epoch: 3, Steps: 123 | Train Loss: 0.8584358 Vali Loss: 0.5410318 Best vali loss: 0.5410318
	iters: 100, epoch: 4 | loss: 0.4900856
	speed: 0.0094s/iter; left time: 4.8290s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.7258772850036621
Epoch: 4, Steps: 123 | Train Loss: 0.4900856 Vali Loss: 0.5459835 Best vali loss: 0.5410318
	iters: 100, epoch: 5 | loss: 0.5566387
	speed: 0.0090s/iter; left time: 3.5392s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5410 --> 0.5212).  Saving model state dict ...
Epoch: 5 cost time: 0.7231287956237793
Epoch: 5, Steps: 123 | Train Loss: 0.5566387 Vali Loss: 0.5211808 Best vali loss: 0.5211808
	iters: 100, epoch: 6 | loss: 0.5932326
	speed: 0.0094s/iter; left time: 2.5362s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7252800464630127
Epoch: 6, Steps: 123 | Train Loss: 0.5932326 Vali Loss: 0.5368833 Best vali loss: 0.5211808
	iters: 100, epoch: 7 | loss: 0.5453162
	speed: 0.0090s/iter; left time: 1.3196s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7171955108642578
Epoch: 7, Steps: 123 | Train Loss: 0.5453162 Vali Loss: 0.5403834 Best vali loss: 0.5211808
	iters: 100, epoch: 8 | loss: 0.6957404
	speed: 0.0090s/iter; left time: 0.2150s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.721043586730957
Epoch: 8, Steps: 123 | Train Loss: 0.6957404 Vali Loss: 0.5450044 Best vali loss: 0.5211808

best validation loss 0.5211807734598887

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002939402649, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7739357
	speed: 0.0118s/iter; left time: 10.4232s
Updating learning rate to 0.0002939402649
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.024538278579712
Epoch: 1, Steps: 123 | Train Loss: 0.7739357 Vali Loss: 0.6171243 Best vali loss: 0.6171243
	iters: 100, epoch: 2 | loss: 0.9445661
	speed: 0.0093s/iter; left time: 7.0864s
Updating learning rate to 0.00014697013245
Validation loss decreased (0.6171 --> 0.6011).  Saving model state dict ...
Epoch: 2 cost time: 0.7300114631652832
Epoch: 2, Steps: 123 | Train Loss: 0.9445661 Vali Loss: 0.6011021 Best vali loss: 0.6011021
	iters: 100, epoch: 3 | loss: 0.8613617
	speed: 0.0094s/iter; left time: 6.0197s
Updating learning rate to 7.3485066225e-05
Validation loss decreased (0.6011 --> 0.5532).  Saving model state dict ...
Epoch: 3 cost time: 0.7289772033691406
Epoch: 3, Steps: 123 | Train Loss: 0.8613617 Vali Loss: 0.5532095 Best vali loss: 0.5532095

best validation loss 0.55320948635412

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002928891323, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7738986
	speed: 0.0116s/iter; left time: 10.2982s
Updating learning rate to 0.0002928891323
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0168821811676025
Epoch: 1, Steps: 123 | Train Loss: 0.7738986 Vali Loss: 0.6171993 Best vali loss: 0.6171993
	iters: 100, epoch: 2 | loss: 0.9352454
	speed: 0.0092s/iter; left time: 7.0308s
Updating learning rate to 0.00014644456615
Validation loss decreased (0.6172 --> 0.5542).  Saving model state dict ...
Epoch: 2 cost time: 0.721592903137207
Epoch: 2, Steps: 123 | Train Loss: 0.9352454 Vali Loss: 0.5541629 Best vali loss: 0.5541629
	iters: 100, epoch: 3 | loss: 0.8586321
	speed: 0.0094s/iter; left time: 6.0281s
Updating learning rate to 7.3222283075e-05
Epoch: 3 cost time: 0.7271707057952881
Epoch: 3, Steps: 123 | Train Loss: 0.8586321 Vali Loss: 0.5552083 Best vali loss: 0.5541629

best validation loss 0.5541629311057606

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.00593010544, 'e_layers': 4, 'learning_rate': 0.0009408349469, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3316597
	speed: 0.0114s/iter; left time: 43.7426s
	iters: 200, epoch: 1 | loss: 0.9199544
	speed: 0.0054s/iter; left time: 20.0433s
	iters: 300, epoch: 1 | loss: 0.7327879
	speed: 0.0053s/iter; left time: 19.3570s
	iters: 400, epoch: 1 | loss: 0.7783405
	speed: 0.0053s/iter; left time: 18.8345s
Updating learning rate to 0.0009408349469
Validation loss decreased (inf --> 0.6396).  Saving model state dict ...
Epoch: 1 cost time: 2.985020399093628
Epoch: 1, Steps: 490 | Train Loss: 0.9406856 Vali Loss: 0.6396093 Best vali loss: 0.6396093
	iters: 100, epoch: 2 | loss: 1.2107555
	speed: 0.0139s/iter; left time: 46.2184s
	iters: 200, epoch: 2 | loss: 1.4628496
	speed: 0.0050s/iter; left time: 16.1365s
	iters: 300, epoch: 2 | loss: 0.4391005
	speed: 0.0050s/iter; left time: 15.5000s
	iters: 400, epoch: 2 | loss: 1.1536908
	speed: 0.0050s/iter; left time: 15.1298s
Updating learning rate to 0.00047041747345
Epoch: 2 cost time: 2.4615399837493896
Epoch: 2, Steps: 490 | Train Loss: 1.0665991 Vali Loss: 0.6491692 Best vali loss: 0.6396093
	iters: 100, epoch: 3 | loss: 1.2803689
	speed: 0.0130s/iter; left time: 37.0022s
	iters: 200, epoch: 3 | loss: 0.4686364
	speed: 0.0048s/iter; left time: 13.1841s
	iters: 300, epoch: 3 | loss: 0.4371856
	speed: 0.0048s/iter; left time: 12.7162s
	iters: 400, epoch: 3 | loss: 0.9980590
	speed: 0.0047s/iter; left time: 11.9536s
Updating learning rate to 0.000235208736725
Validation loss decreased (0.6396 --> 0.6379).  Saving model state dict ...
Epoch: 3 cost time: 2.422152519226074
Epoch: 3, Steps: 490 | Train Loss: 0.7960625 Vali Loss: 0.6379286 Best vali loss: 0.6379286

best validation loss 0.6379286294069515

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002939402649, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5947315
	speed: 0.0120s/iter; left time: 6.1689s
Updating learning rate to 3.67425331125e-05
Validation loss decreased (0.5532 --> 0.5367).  Saving model state dict ...
Epoch: 4 cost time: 1.013761281967163
Epoch: 4, Steps: 123 | Train Loss: 0.5947315 Vali Loss: 0.5366701 Best vali loss: 0.5366701
	iters: 100, epoch: 5 | loss: 0.8506629
	speed: 0.0092s/iter; left time: 3.6139s
Updating learning rate to 1.837126655625e-05
Validation loss decreased (0.5367 --> 0.5286).  Saving model state dict ...
Epoch: 5 cost time: 0.7169601917266846
Epoch: 5, Steps: 123 | Train Loss: 0.8506629 Vali Loss: 0.5285941 Best vali loss: 0.5285941
	iters: 100, epoch: 6 | loss: 0.8049291
	speed: 0.0095s/iter; left time: 2.5639s
Updating learning rate to 9.185633278125e-06
Validation loss decreased (0.5286 --> 0.5283).  Saving model state dict ...
Epoch: 6 cost time: 0.7301077842712402
Epoch: 6, Steps: 123 | Train Loss: 0.8049291 Vali Loss: 0.5282870 Best vali loss: 0.5282870
	iters: 100, epoch: 7 | loss: 0.4788706
	speed: 0.0092s/iter; left time: 1.3479s
Updating learning rate to 4.5928166390625e-06
Epoch: 7 cost time: 0.7129120826721191
Epoch: 7, Steps: 123 | Train Loss: 0.4788706 Vali Loss: 0.5284593 Best vali loss: 0.5282870
	iters: 100, epoch: 8 | loss: 0.5593870
	speed: 0.0091s/iter; left time: 0.2173s
Updating learning rate to 2.29640831953125e-06
Validation loss decreased (0.5283 --> 0.5274).  Saving model state dict ...
Epoch: 8 cost time: 0.7149651050567627
Epoch: 8, Steps: 123 | Train Loss: 0.5593870 Vali Loss: 0.5274209 Best vali loss: 0.5274209

best validation loss 0.527420928719859

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002823879248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7726822
	speed: 0.0117s/iter; left time: 10.3256s
Updating learning rate to 0.0002823879248
Validation loss decreased (inf --> 0.6168).  Saving model state dict ...
Epoch: 1 cost time: 1.017777919769287
Epoch: 1, Steps: 123 | Train Loss: 0.7726822 Vali Loss: 0.6168086 Best vali loss: 0.6168086
	iters: 100, epoch: 2 | loss: 0.9382408
	speed: 0.0093s/iter; left time: 7.0915s
Updating learning rate to 0.0001411939624
Validation loss decreased (0.6168 --> 0.5522).  Saving model state dict ...
Epoch: 2 cost time: 0.7211213111877441
Epoch: 2, Steps: 123 | Train Loss: 0.9382408 Vali Loss: 0.5521904 Best vali loss: 0.5521904
	iters: 100, epoch: 3 | loss: 0.8432676
	speed: 0.0093s/iter; left time: 5.9511s
Updating learning rate to 7.05969812e-05
Validation loss decreased (0.5522 --> 0.5482).  Saving model state dict ...
Epoch: 3 cost time: 0.7191023826599121
Epoch: 3, Steps: 123 | Train Loss: 0.8432676 Vali Loss: 0.5482116 Best vali loss: 0.5482116
	iters: 100, epoch: 4 | loss: 0.4887251
	speed: 0.0092s/iter; left time: 4.7391s
Updating learning rate to 3.52984906e-05
Validation loss decreased (0.5482 --> 0.5431).  Saving model state dict ...
Epoch: 4 cost time: 0.7178843021392822
Epoch: 4, Steps: 123 | Train Loss: 0.4887251 Vali Loss: 0.5430964 Best vali loss: 0.5430964
	iters: 100, epoch: 5 | loss: 0.5719725
	speed: 0.0091s/iter; left time: 3.5927s
Updating learning rate to 1.76492453e-05
Validation loss decreased (0.5431 --> 0.5352).  Saving model state dict ...
Epoch: 5 cost time: 0.7152931690216064
Epoch: 5, Steps: 123 | Train Loss: 0.5719725 Vali Loss: 0.5351586 Best vali loss: 0.5351586
	iters: 100, epoch: 6 | loss: 0.6212441
	speed: 0.0091s/iter; left time: 2.4589s
Updating learning rate to 8.82462265e-06
Validation loss decreased (0.5352 --> 0.5291).  Saving model state dict ...
Epoch: 6 cost time: 0.7103297710418701
Epoch: 6, Steps: 123 | Train Loss: 0.6212441 Vali Loss: 0.5291199 Best vali loss: 0.5291199
	iters: 100, epoch: 7 | loss: 0.5909190
	speed: 0.0093s/iter; left time: 1.3625s
Updating learning rate to 4.412311325e-06
Epoch: 7 cost time: 0.7212138175964355
Epoch: 7, Steps: 123 | Train Loss: 0.5909190 Vali Loss: 0.5291364 Best vali loss: 0.5291199
	iters: 100, epoch: 8 | loss: 0.7506191
	speed: 0.0090s/iter; left time: 0.2150s
Updating learning rate to 2.2061556625e-06
Validation loss decreased (0.5291 --> 0.5285).  Saving model state dict ...
Epoch: 8 cost time: 0.71354079246521
Epoch: 8, Steps: 123 | Train Loss: 0.7506191 Vali Loss: 0.5285130 Best vali loss: 0.5285130

best validation loss 0.5285130075589753

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489805462, 'e_layers': 2, 'learning_rate': 0.0002863461793, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7731117
	speed: 0.0116s/iter; left time: 10.2507s
Updating learning rate to 0.0002754477767840386
Validation loss decreased (inf --> 0.6169).  Saving model state dict ...
Epoch: 1 cost time: 1.0154778957366943
Epoch: 1, Steps: 123 | Train Loss: 0.7731117 Vali Loss: 0.6169121 Best vali loss: 0.6169121
	iters: 100, epoch: 2 | loss: 0.9304532
	speed: 0.0092s/iter; left time: 7.0480s
Updating learning rate to 0.0002444117522249445
Validation loss decreased (0.6169 --> 0.5629).  Saving model state dict ...
Epoch: 2 cost time: 0.7221791744232178
Epoch: 2, Steps: 123 | Train Loss: 0.9304532 Vali Loss: 0.5629059 Best vali loss: 0.5629059
	iters: 100, epoch: 3 | loss: 0.8561656
	speed: 0.0093s/iter; left time: 5.9609s
Updating learning rate to 0.00019796305901957674
Validation loss decreased (0.5629 --> 0.5449).  Saving model state dict ...
Epoch: 3 cost time: 0.7190158367156982
Epoch: 3, Steps: 123 | Train Loss: 0.8561656 Vali Loss: 0.5449104 Best vali loss: 0.5449104
	iters: 100, epoch: 4 | loss: 0.4942590
	speed: 0.0094s/iter; left time: 4.8652s
Updating learning rate to 0.00014317308965
Validation loss decreased (0.5449 --> 0.5422).  Saving model state dict ...
Epoch: 4 cost time: 0.7222170829772949
Epoch: 4, Steps: 123 | Train Loss: 0.4942590 Vali Loss: 0.5422458 Best vali loss: 0.5422458
	iters: 100, epoch: 5 | loss: 0.5570195
	speed: 0.0093s/iter; left time: 3.6550s
Updating learning rate to 8.83831202804233e-05
Validation loss decreased (0.5422 --> 0.5261).  Saving model state dict ...
Epoch: 5 cost time: 0.7225890159606934
Epoch: 5, Steps: 123 | Train Loss: 0.5570195 Vali Loss: 0.5260872 Best vali loss: 0.5260872
	iters: 100, epoch: 6 | loss: 0.5920551
	speed: 0.0093s/iter; left time: 2.5184s
Updating learning rate to 4.193442707505551e-05
Epoch: 6 cost time: 0.7216663360595703
Epoch: 6, Steps: 123 | Train Loss: 0.5920551 Vali Loss: 0.5414714 Best vali loss: 0.5260872
	iters: 100, epoch: 7 | loss: 0.5370333
	speed: 0.0091s/iter; left time: 1.3343s
Updating learning rate to 1.0898402515961454e-05
Epoch: 7 cost time: 0.7192585468292236
Epoch: 7, Steps: 123 | Train Loss: 0.5370333 Vali Loss: 0.5385306 Best vali loss: 0.5260872
	iters: 100, epoch: 8 | loss: 0.6996183
	speed: 0.0091s/iter; left time: 0.2181s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7274353504180908
Epoch: 8, Steps: 123 | Train Loss: 0.6996183 Vali Loss: 0.5432457 Best vali loss: 0.5260872

best validation loss 0.5260871643272057

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.0002881965507, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7733409
	speed: 0.0116s/iter; left time: 10.2668s
Updating learning rate to 0.0002881965507
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 1.0314645767211914
Epoch: 1, Steps: 123 | Train Loss: 0.7733409 Vali Loss: 0.6167193 Best vali loss: 0.6167193
	iters: 100, epoch: 2 | loss: 0.9418479
	speed: 0.0092s/iter; left time: 7.0321s
Updating learning rate to 0.00014409827535
Validation loss decreased (0.6167 --> 0.5550).  Saving model state dict ...
Epoch: 2 cost time: 0.719811201095581
Epoch: 2, Steps: 123 | Train Loss: 0.9418479 Vali Loss: 0.5549825 Best vali loss: 0.5549825
	iters: 100, epoch: 3 | loss: 0.8466035
	speed: 0.0094s/iter; left time: 5.9871s
Updating learning rate to 7.2049137675e-05
Validation loss decreased (0.5550 --> 0.5494).  Saving model state dict ...
Epoch: 3 cost time: 0.714318037033081
Epoch: 3, Steps: 123 | Train Loss: 0.8466035 Vali Loss: 0.5494006 Best vali loss: 0.5494006

best validation loss 0.5494005733317437

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0020485462427, 'e_layers': 3, 'learning_rate': 0.000221227392, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0603758
	speed: 0.0105s/iter; left time: 81.3190s
	iters: 200, epoch: 1 | loss: 0.8641162
	speed: 0.0044s/iter; left time: 33.8611s
	iters: 300, epoch: 1 | loss: 1.2066498
	speed: 0.0044s/iter; left time: 32.9717s
	iters: 400, epoch: 1 | loss: 1.0054488
	speed: 0.0043s/iter; left time: 32.0228s
	iters: 500, epoch: 1 | loss: 1.2988740
	speed: 0.0043s/iter; left time: 31.1969s
	iters: 600, epoch: 1 | loss: 0.8414705
	speed: 0.0042s/iter; left time: 30.1838s
	iters: 700, epoch: 1 | loss: 0.5134355
	speed: 0.0039s/iter; left time: 27.8002s
	iters: 800, epoch: 1 | loss: 0.7845506
	speed: 0.0039s/iter; left time: 27.0925s
	iters: 900, epoch: 1 | loss: 0.8266538
	speed: 0.0038s/iter; left time: 26.2541s
Updating learning rate to 0.00021280742574982558
Validation loss decreased (inf --> 0.6114).  Saving model state dict ...
Epoch: 1 cost time: 4.392261505126953
Epoch: 1, Steps: 979 | Train Loss: 0.9335083 Vali Loss: 0.6113722 Best vali loss: 0.6113722
	iters: 100, epoch: 2 | loss: 1.1009074
	speed: 0.0129s/iter; left time: 87.2357s
	iters: 200, epoch: 2 | loss: 0.5502448
	speed: 0.0038s/iter; left time: 25.4291s
	iters: 300, epoch: 2 | loss: 0.9707322
	speed: 0.0037s/iter; left time: 24.2689s
	iters: 400, epoch: 2 | loss: 0.4656667
	speed: 0.0040s/iter; left time: 25.5001s
	iters: 500, epoch: 2 | loss: 0.9774694
	speed: 0.0038s/iter; left time: 24.3269s
	iters: 600, epoch: 2 | loss: 0.6123475
	speed: 0.0037s/iter; left time: 23.0509s
	iters: 700, epoch: 2 | loss: 0.8146678
	speed: 0.0038s/iter; left time: 23.1212s
	iters: 800, epoch: 2 | loss: 0.6171085
	speed: 0.0037s/iter; left time: 22.1885s
	iters: 900, epoch: 2 | loss: 1.8180707
	speed: 0.0038s/iter; left time: 22.8567s
Updating learning rate to 0.0001888293905337073
Validation loss decreased (0.6114 --> 0.6012).  Saving model state dict ...
Epoch: 2 cost time: 3.760985851287842
Epoch: 2, Steps: 979 | Train Loss: 0.8808017 Vali Loss: 0.6011513 Best vali loss: 0.6011513
	iters: 100, epoch: 3 | loss: 0.5438995
	speed: 0.0126s/iter; left time: 72.8653s
	iters: 200, epoch: 3 | loss: 0.4836824
	speed: 0.0039s/iter; left time: 22.3675s
	iters: 300, epoch: 3 | loss: 1.2360307
	speed: 0.0039s/iter; left time: 21.9173s
	iters: 400, epoch: 3 | loss: 0.5533462
	speed: 0.0039s/iter; left time: 21.5345s
	iters: 500, epoch: 3 | loss: 0.3149794
	speed: 0.0039s/iter; left time: 21.0456s
	iters: 600, epoch: 3 | loss: 0.5144642
	speed: 0.0039s/iter; left time: 20.4378s
	iters: 700, epoch: 3 | loss: 0.6792902
	speed: 0.0037s/iter; left time: 19.2881s
	iters: 800, epoch: 3 | loss: 0.9368139
	speed: 0.0039s/iter; left time: 19.5956s
	iters: 900, epoch: 3 | loss: 1.1453640
	speed: 0.0038s/iter; left time: 18.8433s
Updating learning rate to 0.0001529437248518686
Epoch: 3 cost time: 3.8457703590393066
Epoch: 3, Steps: 979 | Train Loss: 0.7119856 Vali Loss: 0.6144420 Best vali loss: 0.6011513

best validation loss 0.6011513255912361

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745875
	speed: 0.0116s/iter; left time: 10.2850s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0134193897247314
Epoch: 1, Steps: 123 | Train Loss: 0.7745875 Vali Loss: 0.6172987 Best vali loss: 0.6172987
	iters: 100, epoch: 2 | loss: 0.9414679
	speed: 0.0091s/iter; left time: 6.9358s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6173 --> 0.6113).  Saving model state dict ...
Epoch: 2 cost time: 0.7192995548248291
Epoch: 2, Steps: 123 | Train Loss: 0.9414679 Vali Loss: 0.6113299 Best vali loss: 0.6113299
	iters: 100, epoch: 3 | loss: 0.8459045
	speed: 0.0094s/iter; left time: 5.9794s
Updating learning rate to 7.442084605e-05
Validation loss decreased (0.6113 --> 0.5455).  Saving model state dict ...
Epoch: 3 cost time: 0.7157125473022461
Epoch: 3, Steps: 123 | Train Loss: 0.8459045 Vali Loss: 0.5455288 Best vali loss: 0.5455288

best validation loss 0.5455288201336064

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5945695
	speed: 0.0119s/iter; left time: 6.1233s
Updating learning rate to 3.7210423025e-05
Validation loss decreased (0.5455 --> 0.5348).  Saving model state dict ...
Epoch: 4 cost time: 1.0245473384857178
Epoch: 4, Steps: 123 | Train Loss: 0.5945695 Vali Loss: 0.5348311 Best vali loss: 0.5348311
	iters: 100, epoch: 5 | loss: 0.8475780
	speed: 0.0093s/iter; left time: 3.6633s
Updating learning rate to 1.86052115125e-05
Validation loss decreased (0.5348 --> 0.5256).  Saving model state dict ...
Epoch: 5 cost time: 0.7221534252166748
Epoch: 5, Steps: 123 | Train Loss: 0.8475780 Vali Loss: 0.5255861 Best vali loss: 0.5255861
	iters: 100, epoch: 6 | loss: 0.8002608
	speed: 0.0093s/iter; left time: 2.4992s
Updating learning rate to 9.30260575625e-06
Epoch: 6 cost time: 0.7246074676513672
Epoch: 6, Steps: 123 | Train Loss: 0.8002608 Vali Loss: 0.5260433 Best vali loss: 0.5255861
	iters: 100, epoch: 7 | loss: 0.4776468
	speed: 0.0090s/iter; left time: 1.3234s
Updating learning rate to 4.651302878125e-06
Validation loss decreased (0.5256 --> 0.5256).  Saving model state dict ...
Epoch: 7 cost time: 0.7218191623687744
Epoch: 7, Steps: 123 | Train Loss: 0.4776468 Vali Loss: 0.5255573 Best vali loss: 0.5255573
	iters: 100, epoch: 8 | loss: 0.5558510
	speed: 0.0093s/iter; left time: 0.2240s
Updating learning rate to 2.3256514390625e-06
Validation loss decreased (0.5256 --> 0.5242).  Saving model state dict ...
Epoch: 8 cost time: 0.7248368263244629
Epoch: 8, Steps: 123 | Train Loss: 0.5558510 Vali Loss: 0.5241811 Best vali loss: 0.5241811

best validation loss 0.5241811344161292

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0047743851308, 'e_layers': 1, 'learning_rate': 0.0017326778616, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017326778616
Validation loss decreased (inf --> 0.6113).  Saving model state dict ...
Epoch: 1 cost time: 0.6963214874267578
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6112512 Best vali loss: 0.6112512
Updating learning rate to 0.0008663389308
Validation loss decreased (0.6113 --> 0.6090).  Saving model state dict ...
Epoch: 2 cost time: 0.46002817153930664
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6090152 Best vali loss: 0.6090152
Updating learning rate to 0.0004331694654
Validation loss decreased (0.6090 --> 0.5994).  Saving model state dict ...
Epoch: 3 cost time: 0.4202916622161865
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5994397 Best vali loss: 0.5994397
Updating learning rate to 0.0002165847327
Validation loss decreased (0.5994 --> 0.5971).  Saving model state dict ...
Epoch: 4 cost time: 0.43247294425964355
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5971138 Best vali loss: 0.5971138
Updating learning rate to 0.00010829236635
Epoch: 5 cost time: 0.4252457618713379
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5982795 Best vali loss: 0.5971138
Updating learning rate to 5.4146183175e-05
Epoch: 6 cost time: 0.43474602699279785
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5975935 Best vali loss: 0.5971138
Updating learning rate to 2.70730915875e-05
Epoch: 7 cost time: 0.4231431484222412
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5980422 Best vali loss: 0.5971138
Updating learning rate to 1.353654579375e-05
Epoch: 8 cost time: 0.41901206970214844
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5981631 Best vali loss: 0.5971138

best validation loss 0.5971137878796614

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0356685
	speed: 0.0110s/iter; left time: 9.7552s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.5986).  Saving model state dict ...
Epoch: 1 cost time: 0.9529623985290527
Epoch: 1, Steps: 123 | Train Loss: 1.0356685 Vali Loss: 0.5985574 Best vali loss: 0.5985574
	iters: 100, epoch: 2 | loss: 0.6357484
	speed: 0.0082s/iter; left time: 6.2565s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.5986 --> 0.5385).  Saving model state dict ...
Epoch: 2 cost time: 0.63106369972229
Epoch: 2, Steps: 123 | Train Loss: 0.6357484 Vali Loss: 0.5384589 Best vali loss: 0.5384589
	iters: 100, epoch: 3 | loss: 0.7312601
	speed: 0.0082s/iter; left time: 5.2486s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.6267704963684082
Epoch: 3, Steps: 123 | Train Loss: 0.7312601 Vali Loss: 0.5799103 Best vali loss: 0.5384589
	iters: 100, epoch: 4 | loss: 0.6473584
	speed: 0.0079s/iter; left time: 4.0710s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 0.6212902069091797
Epoch: 4, Steps: 123 | Train Loss: 0.6473584 Vali Loss: 0.5531495 Best vali loss: 0.5384589
	iters: 100, epoch: 5 | loss: 0.5198032
	speed: 0.0079s/iter; left time: 3.1238s
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 0.6229751110076904
Epoch: 5, Steps: 123 | Train Loss: 0.5198032 Vali Loss: 0.5643171 Best vali loss: 0.5384589
	iters: 100, epoch: 6 | loss: 0.7227808
	speed: 0.0078s/iter; left time: 2.0985s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.6191062927246094
Epoch: 6, Steps: 123 | Train Loss: 0.7227808 Vali Loss: 0.5545864 Best vali loss: 0.5384589
	iters: 100, epoch: 7 | loss: 0.4856866
	speed: 0.0077s/iter; left time: 1.1302s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.6019363403320312
Epoch: 7, Steps: 123 | Train Loss: 0.4856866 Vali Loss: 0.5552829 Best vali loss: 0.5384589
	iters: 100, epoch: 8 | loss: 0.6029756
	speed: 0.0079s/iter; left time: 0.1888s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6045680046081543
Epoch: 8, Steps: 123 | Train Loss: 0.6029756 Vali Loss: 0.5586601 Best vali loss: 0.5384589

best validation loss 0.5384589227218972

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002957136862, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0346063
	speed: 0.0114s/iter; left time: 10.0498s
Updating learning rate to 0.00028445875418182264
Validation loss decreased (inf --> 0.5969).  Saving model state dict ...
Epoch: 1 cost time: 0.9823668003082275
Epoch: 1, Steps: 123 | Train Loss: 1.0346063 Vali Loss: 0.5969444 Best vali loss: 0.5969444
	iters: 100, epoch: 2 | loss: 0.6474088
	speed: 0.0086s/iter; left time: 6.5282s
Updating learning rate to 0.00025240741950084537
Validation loss decreased (0.5969 --> 0.5710).  Saving model state dict ...
Epoch: 2 cost time: 0.6544790267944336
Epoch: 2, Steps: 123 | Train Loss: 0.6474088 Vali Loss: 0.5710341 Best vali loss: 0.5710341
	iters: 100, epoch: 3 | loss: 0.7295613
	speed: 0.0084s/iter; left time: 5.3508s
Updating learning rate to 0.00020443920731617456
Validation loss decreased (0.5710 --> 0.5528).  Saving model state dict ...
Epoch: 3 cost time: 0.6280467510223389
Epoch: 3, Steps: 123 | Train Loss: 0.7295613 Vali Loss: 0.5527989 Best vali loss: 0.5527989

best validation loss 0.5527989340567688

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0013930444637, 'e_layers': 3, 'learning_rate': 0.0047522616321, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9046544
	speed: 0.0101s/iter; left time: 77.7645s
	iters: 200, epoch: 1 | loss: 0.4214190
	speed: 0.0042s/iter; left time: 31.8170s
	iters: 300, epoch: 1 | loss: 0.9264787
	speed: 0.0041s/iter; left time: 30.8346s
	iters: 400, epoch: 1 | loss: 0.7897660
	speed: 0.0043s/iter; left time: 31.8976s
	iters: 500, epoch: 1 | loss: 0.4655206
	speed: 0.0042s/iter; left time: 30.8655s
	iters: 600, epoch: 1 | loss: 1.2231833
	speed: 0.0042s/iter; left time: 30.5797s
	iters: 700, epoch: 1 | loss: 0.8326691
	speed: 0.0044s/iter; left time: 31.4453s
	iters: 800, epoch: 1 | loss: 0.9854493
	speed: 0.0043s/iter; left time: 30.4970s
	iters: 900, epoch: 1 | loss: 0.8534142
	speed: 0.0043s/iter; left time: 30.1015s
Updating learning rate to 0.004571389443567936
Validation loss decreased (inf --> 0.6502).  Saving model state dict ...
Epoch: 1 cost time: 4.4714765548706055
Epoch: 1, Steps: 979 | Train Loss: 0.8225061 Vali Loss: 0.6501936 Best vali loss: 0.6501936
	iters: 100, epoch: 2 | loss: 1.4519268
	speed: 0.0132s/iter; left time: 89.3048s
	iters: 200, epoch: 2 | loss: 1.7149937
	speed: 0.0044s/iter; left time: 29.1309s
	iters: 300, epoch: 2 | loss: 0.5622342
	speed: 0.0044s/iter; left time: 28.9184s
	iters: 400, epoch: 2 | loss: 0.5131374
	speed: 0.0043s/iter; left time: 27.5084s
	iters: 500, epoch: 2 | loss: 1.4396485
	speed: 0.0042s/iter; left time: 26.8774s
	iters: 600, epoch: 2 | loss: 1.0166003
	speed: 0.0041s/iter; left time: 25.8345s
	iters: 700, epoch: 2 | loss: 0.6717694
	speed: 0.0042s/iter; left time: 26.0259s
	iters: 800, epoch: 2 | loss: 1.3295530
	speed: 0.0043s/iter; left time: 26.2521s
	iters: 900, epoch: 2 | loss: 1.3871429
	speed: 0.0044s/iter; left time: 26.2166s
Updating learning rate to 0.00405630902906528
Validation loss decreased (0.6502 --> 0.6418).  Saving model state dict ...
Epoch: 2 cost time: 4.249451398849487
Epoch: 2, Steps: 979 | Train Loss: 1.1207785 Vali Loss: 0.6417793 Best vali loss: 0.6417793
	iters: 100, epoch: 3 | loss: 0.3536350
	speed: 0.0137s/iter; left time: 79.0843s
	iters: 200, epoch: 3 | loss: 1.5923576
	speed: 0.0044s/iter; left time: 24.6973s
	iters: 300, epoch: 3 | loss: 0.7504562
	speed: 0.0044s/iter; left time: 24.3075s
	iters: 400, epoch: 3 | loss: 0.3920529
	speed: 0.0042s/iter; left time: 22.7671s
	iters: 500, epoch: 3 | loss: 0.5425149
	speed: 0.0043s/iter; left time: 22.8467s
	iters: 600, epoch: 3 | loss: 0.2876265
	speed: 0.0043s/iter; left time: 22.5245s
	iters: 700, epoch: 3 | loss: 0.8420235
	speed: 0.0042s/iter; left time: 21.7192s
	iters: 800, epoch: 3 | loss: 1.5040613
	speed: 0.0042s/iter; left time: 21.1283s
	iters: 900, epoch: 3 | loss: 0.7521642
	speed: 0.0043s/iter; left time: 21.4230s
Updating learning rate to 0.0032854367124844756
Epoch: 3 cost time: 4.2133283615112305
Epoch: 3, Steps: 979 | Train Loss: 0.7796547 Vali Loss: 0.6438348 Best vali loss: 0.6417793

best validation loss 0.6417792801336247

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.0002975947152, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745455
	speed: 0.0117s/iter; left time: 10.3423s
Updating learning rate to 0.0002862681907784028
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0342564582824707
Epoch: 1, Steps: 123 | Train Loss: 0.7745455 Vali Loss: 0.6173179 Best vali loss: 0.6173179
	iters: 100, epoch: 2 | loss: 0.9475407
	speed: 0.0093s/iter; left time: 7.0653s
Updating learning rate to 0.00025401297818159965
Validation loss decreased (0.6173 --> 0.5758).  Saving model state dict ...
Epoch: 2 cost time: 0.7263600826263428
Epoch: 2, Steps: 123 | Train Loss: 0.9475407 Vali Loss: 0.5757579 Best vali loss: 0.5757579
	iters: 100, epoch: 3 | loss: 0.8487118
	speed: 0.0094s/iter; left time: 6.0104s
Updating learning rate to 0.0002057396411332237
Validation loss decreased (0.5758 --> 0.5477).  Saving model state dict ...
Epoch: 3 cost time: 0.7189316749572754
Epoch: 3, Steps: 123 | Train Loss: 0.8487118 Vali Loss: 0.5476541 Best vali loss: 0.5476541

best validation loss 0.5476540586618515

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.0002975947152, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5882203
	speed: 0.0119s/iter; left time: 6.1286s
Updating learning rate to 0.0001487973576
Validation loss decreased (0.5477 --> 0.5276).  Saving model state dict ...
Epoch: 4 cost time: 1.0137546062469482
Epoch: 4, Steps: 123 | Train Loss: 0.5882203 Vali Loss: 0.5276293 Best vali loss: 0.5276293
	iters: 100, epoch: 5 | loss: 0.8228761
	speed: 0.0092s/iter; left time: 3.6290s
Updating learning rate to 9.185507406677633e-05
Validation loss decreased (0.5276 --> 0.5267).  Saving model state dict ...
Epoch: 5 cost time: 0.7181475162506104
Epoch: 5, Steps: 123 | Train Loss: 0.8228761 Vali Loss: 0.5266926 Best vali loss: 0.5266926
	iters: 100, epoch: 6 | loss: 0.7606115
	speed: 0.0093s/iter; left time: 2.5196s
Updating learning rate to 4.3581737018400345e-05
Epoch: 6 cost time: 0.7230560779571533
Epoch: 6, Steps: 123 | Train Loss: 0.7606115 Vali Loss: 0.5289813 Best vali loss: 0.5266926
	iters: 100, epoch: 7 | loss: 0.4308883
	speed: 0.0090s/iter; left time: 1.3203s
Updating learning rate to 1.132652442159724e-05
Epoch: 7 cost time: 0.7190127372741699
Epoch: 7, Steps: 123 | Train Loss: 0.4308883 Vali Loss: 0.5406968 Best vali loss: 0.5266926
	iters: 100, epoch: 8 | loss: 0.5083143
	speed: 0.0090s/iter; left time: 0.2170s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7161829471588135
Epoch: 8, Steps: 123 | Train Loss: 0.5083143 Vali Loss: 0.5420877 Best vali loss: 0.5266926

best validation loss 0.5266925642359097

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0225031
	speed: 0.0112s/iter; left time: 9.9045s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6066).  Saving model state dict ...
Epoch: 1 cost time: 0.9615325927734375
Epoch: 1, Steps: 123 | Train Loss: 1.0225031 Vali Loss: 0.6065988 Best vali loss: 0.6065988
	iters: 100, epoch: 2 | loss: 0.7834808
	speed: 0.0084s/iter; left time: 6.3871s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6066 --> 0.5940).  Saving model state dict ...
Epoch: 2 cost time: 0.6354353427886963
Epoch: 2, Steps: 123 | Train Loss: 0.7834808 Vali Loss: 0.5940287 Best vali loss: 0.5940287
	iters: 100, epoch: 3 | loss: 0.7622617
	speed: 0.0079s/iter; left time: 5.0632s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5940 --> 0.5508).  Saving model state dict ...
Epoch: 3 cost time: 0.5956411361694336
Epoch: 3, Steps: 123 | Train Loss: 0.7622617 Vali Loss: 0.5508255 Best vali loss: 0.5508255
	iters: 100, epoch: 4 | loss: 0.5283285
	speed: 0.0079s/iter; left time: 4.0806s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5508 --> 0.5494).  Saving model state dict ...
Epoch: 4 cost time: 0.603661060333252
Epoch: 4, Steps: 123 | Train Loss: 0.5283285 Vali Loss: 0.5493836 Best vali loss: 0.5493836
	iters: 100, epoch: 5 | loss: 0.7713388
	speed: 0.0082s/iter; left time: 3.2323s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5494 --> 0.5449).  Saving model state dict ...
Epoch: 5 cost time: 0.6398580074310303
Epoch: 5, Steps: 123 | Train Loss: 0.7713388 Vali Loss: 0.5449347 Best vali loss: 0.5449347
	iters: 100, epoch: 6 | loss: 0.4723810
	speed: 0.0084s/iter; left time: 2.2798s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.6411087512969971
Epoch: 6, Steps: 123 | Train Loss: 0.4723810 Vali Loss: 0.5511716 Best vali loss: 0.5449347
	iters: 100, epoch: 7 | loss: 0.5471646
	speed: 0.0080s/iter; left time: 1.1721s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.6251370906829834
Epoch: 7, Steps: 123 | Train Loss: 0.5471646 Vali Loss: 0.5520817 Best vali loss: 0.5449347
	iters: 100, epoch: 8 | loss: 0.5445915
	speed: 0.0081s/iter; left time: 0.1952s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6396315097808838
Epoch: 8, Steps: 123 | Train Loss: 0.5445915 Vali Loss: 0.5450818 Best vali loss: 0.5449347

best validation loss 0.5449347229315031

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010489805462, 'e_layers': 2, 'learning_rate': 0.0002970547504, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8409839
	speed: 0.0111s/iter; left time: 9.8077s
Updating learning rate to 0.0002857487771649045
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 0.9603087902069092
Epoch: 1, Steps: 123 | Train Loss: 0.8409839 Vali Loss: 0.6099100 Best vali loss: 0.6099100
	iters: 100, epoch: 2 | loss: 1.0358865
	speed: 0.0082s/iter; left time: 6.2385s
Updating learning rate to 0.00025355208939575863
Validation loss decreased (0.6099 --> 0.5521).  Saving model state dict ...
Epoch: 2 cost time: 0.6349444389343262
Epoch: 2, Steps: 123 | Train Loss: 1.0358865 Vali Loss: 0.5520559 Best vali loss: 0.5520559
	iters: 100, epoch: 3 | loss: 0.5713192
	speed: 0.0081s/iter; left time: 5.1559s
Updating learning rate to 0.0002053663409417135
Epoch: 3 cost time: 0.612661600112915
Epoch: 3, Steps: 123 | Train Loss: 0.5713192 Vali Loss: 0.5797715 Best vali loss: 0.5520559
	iters: 100, epoch: 4 | loss: 0.9861475
	speed: 0.0079s/iter; left time: 4.0875s
Updating learning rate to 0.0001485273752
Validation loss decreased (0.5521 --> 0.5344).  Saving model state dict ...
Epoch: 4 cost time: 0.6235241889953613
Epoch: 4, Steps: 123 | Train Loss: 0.9861475 Vali Loss: 0.5343910 Best vali loss: 0.5343910
	iters: 100, epoch: 5 | loss: 0.7829809
	speed: 0.0081s/iter; left time: 3.1709s
Updating learning rate to 9.16884094582865e-05
Epoch: 5 cost time: 0.6239335536956787
Epoch: 5, Steps: 123 | Train Loss: 0.7829809 Vali Loss: 0.5424690 Best vali loss: 0.5343910
	iters: 100, epoch: 6 | loss: 0.8115392
	speed: 0.0081s/iter; left time: 2.1789s
Updating learning rate to 4.3502661004241364e-05
Epoch: 6 cost time: 0.643918514251709
Epoch: 6, Steps: 123 | Train Loss: 0.8115392 Vali Loss: 0.5384759 Best vali loss: 0.5343910
	iters: 100, epoch: 7 | loss: 0.8657886
	speed: 0.0081s/iter; left time: 1.1834s
Updating learning rate to 1.1305973235095517e-05
Epoch: 7 cost time: 0.6374123096466064
Epoch: 7, Steps: 123 | Train Loss: 0.8657886 Vali Loss: 0.5412576 Best vali loss: 0.5343910
	iters: 100, epoch: 8 | loss: 0.6352132
	speed: 0.0080s/iter; left time: 0.1909s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6290130615234375
Epoch: 8, Steps: 123 | Train Loss: 0.6352132 Vali Loss: 0.5508542 Best vali loss: 0.5343910

best validation loss 0.5343910364131583

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0175251
	speed: 0.0111s/iter; left time: 9.8149s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 0.9394402503967285
Epoch: 1, Steps: 123 | Train Loss: 1.0175251 Vali Loss: 0.6041423 Best vali loss: 0.6041423
	iters: 100, epoch: 2 | loss: 0.8300665
	speed: 0.0080s/iter; left time: 6.0655s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6041 --> 0.5567).  Saving model state dict ...
Epoch: 2 cost time: 0.6084568500518799
Epoch: 2, Steps: 123 | Train Loss: 0.8300665 Vali Loss: 0.5566550 Best vali loss: 0.5566550
	iters: 100, epoch: 3 | loss: 0.8165420
	speed: 0.0081s/iter; left time: 5.1876s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.6165261268615723
Epoch: 3, Steps: 123 | Train Loss: 0.8165420 Vali Loss: 0.5916885 Best vali loss: 0.5566550

best validation loss 0.5566550363329261

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0035088875694, 'e_layers': 3, 'learning_rate': 0.0017998985296, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0017998985296
Validation loss decreased (inf --> 0.5999).  Saving model state dict ...
Epoch: 1 cost time: 0.7579007148742676
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5998946 Best vali loss: 0.5998946
Updating learning rate to 0.0008999492648
Epoch: 2 cost time: 0.4602699279785156
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6129561 Best vali loss: 0.5998946
Updating learning rate to 0.0004499746324
Epoch: 3 cost time: 0.46243834495544434
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6051622 Best vali loss: 0.5998946

best validation loss 0.599894634527721

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0174350
	speed: 0.0109s/iter; left time: 9.6067s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6043).  Saving model state dict ...
Epoch: 1 cost time: 0.9068396091461182
Epoch: 1, Steps: 123 | Train Loss: 1.0174350 Vali Loss: 0.6042816 Best vali loss: 0.6042816
	iters: 100, epoch: 2 | loss: 0.8362682
	speed: 0.0080s/iter; left time: 6.1282s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6043 --> 0.5675).  Saving model state dict ...
Epoch: 2 cost time: 0.6326563358306885
Epoch: 2, Steps: 123 | Train Loss: 0.8362682 Vali Loss: 0.5674937 Best vali loss: 0.5674937
	iters: 100, epoch: 3 | loss: 0.8020939
	speed: 0.0081s/iter; left time: 5.1792s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5675 --> 0.5510).  Saving model state dict ...
Epoch: 3 cost time: 0.6286273002624512
Epoch: 3, Steps: 123 | Train Loss: 0.8020939 Vali Loss: 0.5509720 Best vali loss: 0.5509720

best validation loss 0.550971991345045

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8493249
	speed: 0.0112s/iter; left time: 5.7594s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.92551589012146
Epoch: 4, Steps: 123 | Train Loss: 0.8493249 Vali Loss: 0.5523494 Best vali loss: 0.5509720
	iters: 100, epoch: 5 | loss: 0.7445127
	speed: 0.0077s/iter; left time: 3.0207s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5510 --> 0.5328).  Saving model state dict ...
Epoch: 5 cost time: 0.6092727184295654
Epoch: 5, Steps: 123 | Train Loss: 0.7445127 Vali Loss: 0.5327516 Best vali loss: 0.5327516
	iters: 100, epoch: 6 | loss: 0.7036229
	speed: 0.0078s/iter; left time: 2.1176s
Updating learning rate to 4.3594722292809835e-05
Validation loss decreased (0.5328 --> 0.5302).  Saving model state dict ...
Epoch: 6 cost time: 0.6037096977233887
Epoch: 6, Steps: 123 | Train Loss: 0.7036229 Vali Loss: 0.5302434 Best vali loss: 0.5302434
	iters: 100, epoch: 7 | loss: 0.7268419
	speed: 0.0077s/iter; left time: 1.1330s
Updating learning rate to 1.132989918446312e-05
Validation loss decreased (0.5302 --> 0.5291).  Saving model state dict ...
Epoch: 7 cost time: 0.6004776954650879
Epoch: 7, Steps: 123 | Train Loss: 0.7268419 Vali Loss: 0.5291324 Best vali loss: 0.5291324
	iters: 100, epoch: 8 | loss: 0.6330953
	speed: 0.0080s/iter; left time: 0.1919s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6171867847442627
Epoch: 8, Steps: 123 | Train Loss: 0.6330953 Vali Loss: 0.5312841 Best vali loss: 0.5291324

best validation loss 0.5291324330942877

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0003787214096, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7761341
	speed: 0.0117s/iter; left time: 10.3752s
Updating learning rate to 0.0003643071842266318
Validation loss decreased (inf --> 0.6170).  Saving model state dict ...
Epoch: 1 cost time: 1.0264880657196045
Epoch: 1, Steps: 123 | Train Loss: 0.7761341 Vali Loss: 0.6170448 Best vali loss: 0.6170448
	iters: 100, epoch: 2 | loss: 0.9243187
	speed: 0.0093s/iter; left time: 7.0927s
Updating learning rate to 0.00032325894325434403
Validation loss decreased (0.6170 --> 0.5803).  Saving model state dict ...
Epoch: 2 cost time: 0.7267882823944092
Epoch: 2, Steps: 123 | Train Loss: 0.9243187 Vali Loss: 0.5802567 Best vali loss: 0.5802567
	iters: 100, epoch: 3 | loss: 0.8499229
	speed: 0.0092s/iter; left time: 5.8564s
Updating learning rate to 0.00026182590926793653
Validation loss decreased (0.5803 --> 0.5474).  Saving model state dict ...
Epoch: 3 cost time: 0.7167882919311523
Epoch: 3, Steps: 123 | Train Loss: 0.8499229 Vali Loss: 0.5474472 Best vali loss: 0.5474472
	iters: 100, epoch: 4 | loss: 0.4825065
	speed: 0.0093s/iter; left time: 4.7990s
Updating learning rate to 0.0001893607048
Epoch: 4 cost time: 0.7178146839141846
Epoch: 4, Steps: 123 | Train Loss: 0.4825065 Vali Loss: 0.5476734 Best vali loss: 0.5474472
	iters: 100, epoch: 5 | loss: 0.5462967
	speed: 0.0090s/iter; left time: 3.5455s
Updating learning rate to 0.00011689550033206348
Validation loss decreased (0.5474 --> 0.5441).  Saving model state dict ...
Epoch: 5 cost time: 0.7297961711883545
Epoch: 5, Steps: 123 | Train Loss: 0.5462967 Vali Loss: 0.5441481 Best vali loss: 0.5441481
	iters: 100, epoch: 6 | loss: 0.5647052
	speed: 0.0094s/iter; left time: 2.5281s
Updating learning rate to 5.546246634565599e-05
Epoch: 6 cost time: 0.7210659980773926
Epoch: 6, Steps: 123 | Train Loss: 0.5647052 Vali Loss: 0.5631894 Best vali loss: 0.5441481
	iters: 100, epoch: 7 | loss: 0.5093201
	speed: 0.0091s/iter; left time: 1.3367s
Updating learning rate to 1.441422537336823e-05
Epoch: 7 cost time: 0.7219159603118896
Epoch: 7, Steps: 123 | Train Loss: 0.5093201 Vali Loss: 0.5684142 Best vali loss: 0.5441481
	iters: 100, epoch: 8 | loss: 0.6662506
	speed: 0.0090s/iter; left time: 0.2164s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7178401947021484
Epoch: 8, Steps: 123 | Train Loss: 0.6662506 Vali Loss: 0.5742720 Best vali loss: 0.5441481

best validation loss 0.5441480942591094

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0003820982618, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7762624
	speed: 0.0117s/iter; left time: 10.3817s
Updating learning rate to 0.00036755551264257963
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0203754901885986
Epoch: 1, Steps: 123 | Train Loss: 0.7762624 Vali Loss: 0.6172015 Best vali loss: 0.6172015
	iters: 100, epoch: 2 | loss: 0.9364696
	speed: 0.0092s/iter; left time: 6.9951s
Updating learning rate to 0.00032614126689918635
Validation loss decreased (0.6172 --> 0.5750).  Saving model state dict ...
Epoch: 2 cost time: 0.7208926677703857
Epoch: 2, Steps: 123 | Train Loss: 0.9364696 Vali Loss: 0.5750488 Best vali loss: 0.5750488
	iters: 100, epoch: 3 | loss: 0.8428740
	speed: 0.0094s/iter; left time: 5.9913s
Updating learning rate to 0.00026416046806317935
Validation loss decreased (0.5750 --> 0.5406).  Saving model state dict ...
Epoch: 3 cost time: 0.7281897068023682
Epoch: 3, Steps: 123 | Train Loss: 0.8428740 Vali Loss: 0.5406398 Best vali loss: 0.5406398
	iters: 100, epoch: 4 | loss: 0.4906769
	speed: 0.0095s/iter; left time: 4.8875s
Updating learning rate to 0.0001910491309
Epoch: 4 cost time: 0.7267875671386719
Epoch: 4, Steps: 123 | Train Loss: 0.4906769 Vali Loss: 0.5509542 Best vali loss: 0.5406398
	iters: 100, epoch: 5 | loss: 0.5476761
	speed: 0.0089s/iter; left time: 3.5111s
Updating learning rate to 0.00011793779373682067
Epoch: 5 cost time: 0.7161076068878174
Epoch: 5, Steps: 123 | Train Loss: 0.5476761 Vali Loss: 0.5457618 Best vali loss: 0.5406398
	iters: 100, epoch: 6 | loss: 0.5682036
	speed: 0.0090s/iter; left time: 2.4266s
Updating learning rate to 5.595699490081364e-05
Epoch: 6 cost time: 0.7158775329589844
Epoch: 6, Steps: 123 | Train Loss: 0.5682036 Vali Loss: 0.5544529 Best vali loss: 0.5406398
	iters: 100, epoch: 7 | loss: 0.5120631
	speed: 0.0089s/iter; left time: 1.3074s
Updating learning rate to 1.4542749157420375e-05
Epoch: 7 cost time: 0.7135889530181885
Epoch: 7, Steps: 123 | Train Loss: 0.5120631 Vali Loss: 0.5595472 Best vali loss: 0.5406398
	iters: 100, epoch: 8 | loss: 0.6730946
	speed: 0.0089s/iter; left time: 0.2143s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7172729969024658
Epoch: 8, Steps: 123 | Train Loss: 0.6730946 Vali Loss: 0.5598433 Best vali loss: 0.5406398

best validation loss 0.54063981685965

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0021089990006, 'e_layers': 1, 'learning_rate': 0.0001821272917, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5346723
	speed: 0.0088s/iter; left time: 68.2695s
	iters: 200, epoch: 1 | loss: 0.6747292
	speed: 0.0026s/iter; left time: 19.7410s
	iters: 300, epoch: 1 | loss: 0.7258198
	speed: 0.0026s/iter; left time: 19.4264s
	iters: 400, epoch: 1 | loss: 0.7685342
	speed: 0.0026s/iter; left time: 19.3932s
	iters: 500, epoch: 1 | loss: 0.6446900
	speed: 0.0026s/iter; left time: 19.0635s
	iters: 600, epoch: 1 | loss: 1.0404104
	speed: 0.0026s/iter; left time: 18.7670s
	iters: 700, epoch: 1 | loss: 1.3601595
	speed: 0.0024s/iter; left time: 17.4060s
	iters: 800, epoch: 1 | loss: 0.7730694
	speed: 0.0026s/iter; left time: 18.4343s
	iters: 900, epoch: 1 | loss: 0.7182964
	speed: 0.0025s/iter; left time: 17.1502s
Updating learning rate to 0.0001821272917
Validation loss decreased (inf --> 0.6083).  Saving model state dict ...
Epoch: 1 cost time: 2.8575730323791504
Epoch: 1, Steps: 979 | Train Loss: 0.9155979 Vali Loss: 0.6083480 Best vali loss: 0.6083480
	iters: 100, epoch: 2 | loss: 1.1493027
	speed: 0.0092s/iter; left time: 62.4519s
	iters: 200, epoch: 2 | loss: 0.3230243
	speed: 0.0024s/iter; left time: 16.2339s
	iters: 300, epoch: 2 | loss: 1.2092931
	speed: 0.0024s/iter; left time: 15.8695s
	iters: 400, epoch: 2 | loss: 0.6008320
	speed: 0.0024s/iter; left time: 15.4087s
	iters: 500, epoch: 2 | loss: 0.3221238
	speed: 0.0024s/iter; left time: 15.1943s
	iters: 600, epoch: 2 | loss: 0.6312689
	speed: 0.0024s/iter; left time: 14.9107s
	iters: 700, epoch: 2 | loss: 0.9788237
	speed: 0.0024s/iter; left time: 14.7273s
	iters: 800, epoch: 2 | loss: 0.7175299
	speed: 0.0024s/iter; left time: 14.3725s
	iters: 900, epoch: 2 | loss: 0.3305897
	speed: 0.0024s/iter; left time: 14.1541s
Updating learning rate to 9.106364585e-05
Validation loss decreased (0.6083 --> 0.6063).  Saving model state dict ...
Epoch: 2 cost time: 2.3983240127563477
Epoch: 2, Steps: 979 | Train Loss: 0.6958654 Vali Loss: 0.6063249 Best vali loss: 0.6063249
	iters: 100, epoch: 3 | loss: 1.1691430
	speed: 0.0091s/iter; left time: 52.3731s
	iters: 200, epoch: 3 | loss: 0.7535945
	speed: 0.0026s/iter; left time: 14.6401s
	iters: 300, epoch: 3 | loss: 0.3991590
	speed: 0.0026s/iter; left time: 14.3691s
	iters: 400, epoch: 3 | loss: 1.0698432
	speed: 0.0026s/iter; left time: 14.0950s
	iters: 500, epoch: 3 | loss: 1.0142567
	speed: 0.0025s/iter; left time: 13.6777s
	iters: 600, epoch: 3 | loss: 1.3703024
	speed: 0.0025s/iter; left time: 12.9556s
	iters: 700, epoch: 3 | loss: 0.5555869
	speed: 0.0024s/iter; left time: 12.4954s
	iters: 800, epoch: 3 | loss: 0.7366368
	speed: 0.0024s/iter; left time: 12.1116s
	iters: 900, epoch: 3 | loss: 1.5465938
	speed: 0.0024s/iter; left time: 12.0812s
Updating learning rate to 4.5531822925e-05
Epoch: 3 cost time: 2.50376033782959
Epoch: 3, Steps: 979 | Train Loss: 0.9572351 Vali Loss: 0.6312479 Best vali loss: 0.6063249

best validation loss 0.6063248750817053

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.0003796130001, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7761945
	speed: 0.0117s/iter; left time: 10.3777s
Updating learning rate to 0.0003651648405837975
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.019129991531372
Epoch: 1, Steps: 123 | Train Loss: 0.7761945 Vali Loss: 0.6172643 Best vali loss: 0.6172643
	iters: 100, epoch: 2 | loss: 0.9402956
	speed: 0.0093s/iter; left time: 7.0581s
Updating learning rate to 0.0003240199633486397
Validation loss decreased (0.6173 --> 0.5831).  Saving model state dict ...
Epoch: 2 cost time: 0.7193636894226074
Epoch: 2, Steps: 123 | Train Loss: 0.9402956 Vali Loss: 0.5831098 Best vali loss: 0.5831098
	iters: 100, epoch: 3 | loss: 0.8356439
	speed: 0.0094s/iter; left time: 6.0253s
Updating learning rate to 0.0002624423029743386
Validation loss decreased (0.5831 --> 0.5477).  Saving model state dict ...
Epoch: 3 cost time: 0.7232530117034912
Epoch: 3, Steps: 123 | Train Loss: 0.8356439 Vali Loss: 0.5476541 Best vali loss: 0.5476541

best validation loss 0.5476540687844357

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010491444122, 'e_layers': 2, 'learning_rate': 0.0003780328476, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7762262
	speed: 0.0117s/iter; left time: 10.3531s
Updating learning rate to 0.00036364482905729926
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0281579494476318
Epoch: 1, Steps: 123 | Train Loss: 0.7762262 Vali Loss: 0.6174180 Best vali loss: 0.6174180
	iters: 100, epoch: 2 | loss: 0.9441096
	speed: 0.0092s/iter; left time: 7.0142s
Updating learning rate to 0.0003226712188246103
Validation loss decreased (0.6174 --> 0.5845).  Saving model state dict ...
Epoch: 2 cost time: 0.7191281318664551
Epoch: 2, Steps: 123 | Train Loss: 0.9441096 Vali Loss: 0.5844671 Best vali loss: 0.5844671
	iters: 100, epoch: 3 | loss: 0.8325691
	speed: 0.0093s/iter; left time: 5.9355s
Updating learning rate to 0.00026134987763315844
Validation loss decreased (0.5845 --> 0.5525).  Saving model state dict ...
Epoch: 3 cost time: 0.7162685394287109
Epoch: 3, Steps: 123 | Train Loss: 0.8325691 Vali Loss: 0.5524501 Best vali loss: 0.5524501

best validation loss 0.5524501322541508

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.0003796130001, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5834662
	speed: 0.0122s/iter; left time: 6.2812s
Updating learning rate to 0.00018980650005
Validation loss decreased (0.5477 --> 0.5388).  Saving model state dict ...
Epoch: 4 cost time: 1.0351653099060059
Epoch: 4, Steps: 123 | Train Loss: 0.5834662 Vali Loss: 0.5388476 Best vali loss: 0.5388476
	iters: 100, epoch: 5 | loss: 0.8143137
	speed: 0.0093s/iter; left time: 3.6550s
Updating learning rate to 0.00011717069712566141
Epoch: 5 cost time: 0.7185766696929932
Epoch: 5, Steps: 123 | Train Loss: 0.8143137 Vali Loss: 0.5430419 Best vali loss: 0.5388476
	iters: 100, epoch: 6 | loss: 0.7277267
	speed: 0.0091s/iter; left time: 2.4485s
Updating learning rate to 5.559303675136024e-05
Epoch: 6 cost time: 0.7225916385650635
Epoch: 6, Steps: 123 | Train Loss: 0.7277267 Vali Loss: 0.5558576 Best vali loss: 0.5388476
	iters: 100, epoch: 7 | loss: 0.4107330
	speed: 0.0091s/iter; left time: 1.3308s
Updating learning rate to 1.4448159516202476e-05
Epoch: 7 cost time: 0.7179689407348633
Epoch: 7, Steps: 123 | Train Loss: 0.4107330 Vali Loss: 0.5725092 Best vali loss: 0.5388476
	iters: 100, epoch: 8 | loss: 0.4827329
	speed: 0.0092s/iter; left time: 0.2211s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7314198017120361
Epoch: 8, Steps: 123 | Train Loss: 0.4827329 Vali Loss: 0.5737206 Best vali loss: 0.5388476

best validation loss 0.5388476442044006

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8426675
	speed: 0.0107s/iter; left time: 9.4942s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9207613468170166
Epoch: 1, Steps: 123 | Train Loss: 0.8426675 Vali Loss: 0.5942753 Best vali loss: 0.5942753
	iters: 100, epoch: 2 | loss: 0.7218131
	speed: 0.0080s/iter; left time: 6.0906s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.5943 --> 0.5645).  Saving model state dict ...
Epoch: 2 cost time: 0.6136453151702881
Epoch: 2, Steps: 123 | Train Loss: 0.7218131 Vali Loss: 0.5644585 Best vali loss: 0.5644585
	iters: 100, epoch: 3 | loss: 0.6653974
	speed: 0.0079s/iter; left time: 5.0467s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5645 --> 0.5597).  Saving model state dict ...
Epoch: 3 cost time: 0.6260669231414795
Epoch: 3, Steps: 123 | Train Loss: 0.6653974 Vali Loss: 0.5597005 Best vali loss: 0.5597005
	iters: 100, epoch: 4 | loss: 0.6604081
	speed: 0.0077s/iter; left time: 3.9905s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5597 --> 0.5542).  Saving model state dict ...
Epoch: 4 cost time: 0.5933337211608887
Epoch: 4, Steps: 123 | Train Loss: 0.6604081 Vali Loss: 0.5541794 Best vali loss: 0.5541794
	iters: 100, epoch: 5 | loss: 0.4752128
	speed: 0.0080s/iter; left time: 3.1298s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5542 --> 0.5472).  Saving model state dict ...
Epoch: 5 cost time: 0.6157677173614502
Epoch: 5, Steps: 123 | Train Loss: 0.4752128 Vali Loss: 0.5472241 Best vali loss: 0.5472241
	iters: 100, epoch: 6 | loss: 0.7658316
	speed: 0.0078s/iter; left time: 2.1035s
Updating learning rate to 4.3594722292809835e-05
Validation loss decreased (0.5472 --> 0.5430).  Saving model state dict ...
Epoch: 6 cost time: 0.6056437492370605
Epoch: 6, Steps: 123 | Train Loss: 0.7658316 Vali Loss: 0.5429973 Best vali loss: 0.5429973
	iters: 100, epoch: 7 | loss: 0.5971807
	speed: 0.0077s/iter; left time: 1.1372s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.6016449928283691
Epoch: 7, Steps: 123 | Train Loss: 0.5971807 Vali Loss: 0.5434086 Best vali loss: 0.5429973
	iters: 100, epoch: 8 | loss: 0.8504223
	speed: 0.0077s/iter; left time: 0.1837s
Updating learning rate to 0.0
Validation loss decreased (0.5430 --> 0.5421).  Saving model state dict ...
Epoch: 8 cost time: 0.5953614711761475
Epoch: 8, Steps: 123 | Train Loss: 0.8504223 Vali Loss: 0.5421359 Best vali loss: 0.5421359

best validation loss 0.5421359246663063

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0001417018368, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7565885
	speed: 0.0118s/iter; left time: 10.4620s
Updating learning rate to 0.00013630863176938732
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 1.0355961322784424
Epoch: 1, Steps: 123 | Train Loss: 0.7565885 Vali Loss: 0.6046317 Best vali loss: 0.6046317
	iters: 100, epoch: 2 | loss: 0.9383983
	speed: 0.0093s/iter; left time: 7.0563s
Updating learning rate to 0.00012095008325393472
Validation loss decreased (0.6046 --> 0.5760).  Saving model state dict ...
Epoch: 2 cost time: 0.7241156101226807
Epoch: 2, Steps: 123 | Train Loss: 0.9383983 Vali Loss: 0.5760258 Best vali loss: 0.5760258
	iters: 100, epoch: 3 | loss: 0.8593762
	speed: 0.0099s/iter; left time: 6.3097s
Updating learning rate to 9.79643910395309e-05
Validation loss decreased (0.5760 --> 0.5610).  Saving model state dict ...
Epoch: 3 cost time: 0.7806594371795654
Epoch: 3, Steps: 123 | Train Loss: 0.8593762 Vali Loss: 0.5610448 Best vali loss: 0.5610448
	iters: 100, epoch: 4 | loss: 0.5060481
	speed: 0.0099s/iter; left time: 5.1303s
Updating learning rate to 7.08509184e-05
Validation loss decreased (0.5610 --> 0.5465).  Saving model state dict ...
Epoch: 4 cost time: 0.7511048316955566
Epoch: 4, Steps: 123 | Train Loss: 0.5060481 Vali Loss: 0.5465126 Best vali loss: 0.5465126
	iters: 100, epoch: 5 | loss: 0.5787606
	speed: 0.0095s/iter; left time: 3.7503s
Updating learning rate to 4.373744576046911e-05
Validation loss decreased (0.5465 --> 0.5402).  Saving model state dict ...
Epoch: 5 cost time: 0.732996940612793
Epoch: 5, Steps: 123 | Train Loss: 0.5787606 Vali Loss: 0.5402075 Best vali loss: 0.5402075
	iters: 100, epoch: 6 | loss: 0.6304039
	speed: 0.0096s/iter; left time: 2.5787s
Updating learning rate to 2.075175354606527e-05
Validation loss decreased (0.5402 --> 0.5360).  Saving model state dict ...
Epoch: 6 cost time: 0.7428257465362549
Epoch: 6, Steps: 123 | Train Loss: 0.6304039 Vali Loss: 0.5359597 Best vali loss: 0.5359597
	iters: 100, epoch: 7 | loss: 0.5912648
	speed: 0.0097s/iter; left time: 1.4291s
Updating learning rate to 5.393205030612676e-06
Validation loss decreased (0.5360 --> 0.5322).  Saving model state dict ...
Epoch: 7 cost time: 0.7541229724884033
Epoch: 7, Steps: 123 | Train Loss: 0.5912648 Vali Loss: 0.5322158 Best vali loss: 0.5322158
	iters: 100, epoch: 8 | loss: 0.7555159
	speed: 0.0098s/iter; left time: 0.2341s
Updating learning rate to 0.0
Validation loss decreased (0.5322 --> 0.5296).  Saving model state dict ...
Epoch: 8 cost time: 0.7588098049163818
Epoch: 8, Steps: 123 | Train Loss: 0.7555159 Vali Loss: 0.5295798 Best vali loss: 0.5295798

best validation loss 0.5295798467133455

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0001321711789, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7549834
	speed: 0.0120s/iter; left time: 10.6615s
Updating learning rate to 0.00012714071293679882
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 1.0557236671447754
Epoch: 1, Steps: 123 | Train Loss: 0.7549834 Vali Loss: 0.6038032 Best vali loss: 0.6038032
	iters: 100, epoch: 2 | loss: 0.9364911
	speed: 0.0095s/iter; left time: 7.2082s
Updating learning rate to 0.00011281515788880516
Validation loss decreased (0.6038 --> 0.5841).  Saving model state dict ...
Epoch: 2 cost time: 0.7344667911529541
Epoch: 2, Steps: 123 | Train Loss: 0.9364911 Vali Loss: 0.5841252 Best vali loss: 0.5841252
	iters: 100, epoch: 3 | loss: 0.8634651
	speed: 0.0096s/iter; left time: 6.1305s
Updating learning rate to 9.137544965059617e-05
Validation loss decreased (0.5841 --> 0.5726).  Saving model state dict ...
Epoch: 3 cost time: 0.7428081035614014
Epoch: 3, Steps: 123 | Train Loss: 0.8634651 Vali Loss: 0.5726496 Best vali loss: 0.5726496

best validation loss 0.5726496410116119

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8426727
	speed: 0.0112s/iter; left time: 9.9155s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9517638683319092
Epoch: 1, Steps: 123 | Train Loss: 0.8426727 Vali Loss: 0.5942909 Best vali loss: 0.5942909
	iters: 100, epoch: 2 | loss: 0.7265192
	speed: 0.0078s/iter; left time: 5.9359s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.5943 --> 0.5587).  Saving model state dict ...
Epoch: 2 cost time: 0.606781005859375
Epoch: 2, Steps: 123 | Train Loss: 0.7265192 Vali Loss: 0.5586841 Best vali loss: 0.5586841
	iters: 100, epoch: 3 | loss: 0.6636052
	speed: 0.0081s/iter; left time: 5.1446s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5587 --> 0.5499).  Saving model state dict ...
Epoch: 3 cost time: 0.6199922561645508
Epoch: 3, Steps: 123 | Train Loss: 0.6636052 Vali Loss: 0.5498615 Best vali loss: 0.5498615

best validation loss 0.5498614834724119

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010608387508, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744904
	speed: 0.0117s/iter; left time: 10.3760s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0319468975067139
Epoch: 1, Steps: 123 | Train Loss: 0.7744904 Vali Loss: 0.6173735 Best vali loss: 0.6173735
	iters: 100, epoch: 2 | loss: 0.9486086
	speed: 0.0095s/iter; left time: 7.2745s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6174 --> 0.5851).  Saving model state dict ...
Epoch: 2 cost time: 0.7495498657226562
Epoch: 2, Steps: 123 | Train Loss: 0.9486086 Vali Loss: 0.5851206 Best vali loss: 0.5851206
	iters: 100, epoch: 3 | loss: 0.8476519
	speed: 0.0095s/iter; left time: 6.0980s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5851 --> 0.5435).  Saving model state dict ...
Epoch: 3 cost time: 0.7324581146240234
Epoch: 3, Steps: 123 | Train Loss: 0.8476519 Vali Loss: 0.5435015 Best vali loss: 0.5435015

best validation loss 0.543501546790014

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010608387508, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5861713
	speed: 0.0121s/iter; left time: 6.2665s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5435 --> 0.5340).  Saving model state dict ...
Epoch: 4 cost time: 1.0406229496002197
Epoch: 4, Steps: 123 | Train Loss: 0.5861713 Vali Loss: 0.5339564 Best vali loss: 0.5339564
	iters: 100, epoch: 5 | loss: 0.8276709
	speed: 0.0095s/iter; left time: 3.7221s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5340 --> 0.5270).  Saving model state dict ...
Epoch: 5 cost time: 0.7305340766906738
Epoch: 5, Steps: 123 | Train Loss: 0.8276709 Vali Loss: 0.5269767 Best vali loss: 0.5269767
	iters: 100, epoch: 6 | loss: 0.7568071
	speed: 0.0096s/iter; left time: 2.5838s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7406604290008545
Epoch: 6, Steps: 123 | Train Loss: 0.7568071 Vali Loss: 0.5324987 Best vali loss: 0.5269767
	iters: 100, epoch: 7 | loss: 0.4316071
	speed: 0.0093s/iter; left time: 1.3628s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7305400371551514
Epoch: 7, Steps: 123 | Train Loss: 0.4316071 Vali Loss: 0.5473034 Best vali loss: 0.5269767
	iters: 100, epoch: 8 | loss: 0.5033616
	speed: 0.0093s/iter; left time: 0.2244s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7421157360076904
Epoch: 8, Steps: 123 | Train Loss: 0.5033616 Vali Loss: 0.5453117 Best vali loss: 0.5269767

best validation loss 0.5269767476805158

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0013546169955, 'e_layers': 2, 'learning_rate': 0.0008314527275, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7841685
	speed: 0.0107s/iter; left time: 9.4925s
Updating learning rate to 0.0008314527275
Validation loss decreased (inf --> 0.6034).  Saving model state dict ...
Epoch: 1 cost time: 0.922304630279541
Epoch: 1, Steps: 123 | Train Loss: 0.7841685 Vali Loss: 0.6034177 Best vali loss: 0.6034177
	iters: 100, epoch: 2 | loss: 0.8658754
	speed: 0.0074s/iter; left time: 5.6034s
Updating learning rate to 0.00041572636375
Validation loss decreased (0.6034 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 0.5405559539794922
Epoch: 2, Steps: 123 | Train Loss: 0.8658754 Vali Loss: 0.5611113 Best vali loss: 0.5611113
	iters: 100, epoch: 3 | loss: 0.5849338
	speed: 0.0074s/iter; left time: 4.7030s
Updating learning rate to 0.000207863181875
Epoch: 3 cost time: 0.5783312320709229
Epoch: 3, Steps: 123 | Train Loss: 0.5849338 Vali Loss: 0.5614739 Best vali loss: 0.5611113
	iters: 100, epoch: 4 | loss: 0.8455766
	speed: 0.0079s/iter; left time: 4.0744s
Updating learning rate to 0.0001039315909375
Validation loss decreased (0.5611 --> 0.5602).  Saving model state dict ...
Epoch: 4 cost time: 0.6389458179473877
Epoch: 4, Steps: 123 | Train Loss: 0.8455766 Vali Loss: 0.5601791 Best vali loss: 0.5601791
	iters: 100, epoch: 5 | loss: 0.7367814
	speed: 0.0076s/iter; left time: 2.9988s
Updating learning rate to 5.196579546875e-05
Validation loss decreased (0.5602 --> 0.5516).  Saving model state dict ...
Epoch: 5 cost time: 0.5864524841308594
Epoch: 5, Steps: 123 | Train Loss: 0.7367814 Vali Loss: 0.5516130 Best vali loss: 0.5516130
	iters: 100, epoch: 6 | loss: 0.7142540
	speed: 0.0075s/iter; left time: 2.0188s
Updating learning rate to 2.5982897734375e-05
Epoch: 6 cost time: 0.5787346363067627
Epoch: 6, Steps: 123 | Train Loss: 0.7142540 Vali Loss: 0.5562526 Best vali loss: 0.5516130
	iters: 100, epoch: 7 | loss: 0.5275497
	speed: 0.0077s/iter; left time: 1.1344s
Updating learning rate to 1.29914488671875e-05
Epoch: 7 cost time: 0.6195762157440186
Epoch: 7, Steps: 123 | Train Loss: 0.5275497 Vali Loss: 0.5545364 Best vali loss: 0.5516130
	iters: 100, epoch: 8 | loss: 0.8679932
	speed: 0.0076s/iter; left time: 0.1835s
Updating learning rate to 6.49572443359375e-06
Epoch: 8 cost time: 0.5822675228118896
Epoch: 8, Steps: 123 | Train Loss: 0.8679932 Vali Loss: 0.5535744 Best vali loss: 0.5516130

best validation loss 0.5516129595877008

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010512919799, 'e_layers': 2, 'learning_rate': 0.0002978403325, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8426740
	speed: 0.0110s/iter; left time: 9.6945s
Updating learning rate to 0.00028650445982655306
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9414315223693848
Epoch: 1, Steps: 123 | Train Loss: 0.8426740 Vali Loss: 0.5942904 Best vali loss: 0.5942904
	iters: 100, epoch: 2 | loss: 0.7269223
	speed: 0.0076s/iter; left time: 5.7579s
Updating learning rate to 0.000254222625660803
Validation loss decreased (0.5943 --> 0.5586).  Saving model state dict ...
Epoch: 2 cost time: 0.5772659778594971
Epoch: 2, Steps: 123 | Train Loss: 0.7269223 Vali Loss: 0.5586377 Best vali loss: 0.5586377
	iters: 100, epoch: 3 | loss: 0.6549706
	speed: 0.0079s/iter; left time: 5.0647s
Updating learning rate to 0.0002059094466189298
Validation loss decreased (0.5586 --> 0.5447).  Saving model state dict ...
Epoch: 3 cost time: 0.6014490127563477
Epoch: 3, Steps: 123 | Train Loss: 0.6549706 Vali Loss: 0.5447052 Best vali loss: 0.5447052
	iters: 100, epoch: 4 | loss: 0.6683530
	speed: 0.0079s/iter; left time: 4.0929s
Updating learning rate to 0.00014892016625
Validation loss decreased (0.5447 --> 0.5443).  Saving model state dict ...
Epoch: 4 cost time: 0.6025772094726562
Epoch: 4, Steps: 123 | Train Loss: 0.6683530 Vali Loss: 0.5442888 Best vali loss: 0.5442888
	iters: 100, epoch: 5 | loss: 0.4777829
	speed: 0.0079s/iter; left time: 3.1010s
Updating learning rate to 9.19308858810702e-05
Validation loss decreased (0.5443 --> 0.5390).  Saving model state dict ...
Epoch: 5 cost time: 0.6179087162017822
Epoch: 5, Steps: 123 | Train Loss: 0.4777829 Vali Loss: 0.5389649 Best vali loss: 0.5389649
	iters: 100, epoch: 6 | loss: 0.7664890
	speed: 0.0081s/iter; left time: 2.1929s
Updating learning rate to 4.3617706839196975e-05
Epoch: 6 cost time: 0.6191494464874268
Epoch: 6, Steps: 123 | Train Loss: 0.7664890 Vali Loss: 0.5405477 Best vali loss: 0.5389649
	iters: 100, epoch: 7 | loss: 0.6005086
	speed: 0.0080s/iter; left time: 1.1832s
Updating learning rate to 1.1335872673446898e-05
Epoch: 7 cost time: 0.6256318092346191
Epoch: 7, Steps: 123 | Train Loss: 0.6005086 Vali Loss: 0.5394846 Best vali loss: 0.5389649
	iters: 100, epoch: 8 | loss: 0.8484105
	speed: 0.0079s/iter; left time: 0.1885s
Updating learning rate to 0.0
Validation loss decreased (0.5390 --> 0.5386).  Saving model state dict ...
Epoch: 8 cost time: 0.6295011043548584
Epoch: 8, Steps: 123 | Train Loss: 0.8484105 Vali Loss: 0.5385737 Best vali loss: 0.5385737

best validation loss 0.5385736837148777

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010485814089, 'e_layers': 2, 'learning_rate': 0.0001535580318, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7583576
	speed: 0.0116s/iter; left time: 10.2881s
Updating learning rate to 0.00014771357721636867
Validation loss decreased (inf --> 0.6057).  Saving model state dict ...
Epoch: 1 cost time: 1.0183558464050293
Epoch: 1, Steps: 123 | Train Loss: 0.7583576 Vali Loss: 0.6056585 Best vali loss: 0.6056585
	iters: 100, epoch: 2 | loss: 0.9439443
	speed: 0.0094s/iter; left time: 7.1402s
Updating learning rate to 0.00013106997869571975
Validation loss decreased (0.6057 --> 0.5895).  Saving model state dict ...
Epoch: 2 cost time: 0.7285487651824951
Epoch: 2, Steps: 123 | Train Loss: 0.9439443 Vali Loss: 0.5894936 Best vali loss: 0.5894936
	iters: 100, epoch: 3 | loss: 0.8669940
	speed: 0.0095s/iter; left time: 6.0465s
Updating learning rate to 0.00010616107323822582
Validation loss decreased (0.5895 --> 0.5554).  Saving model state dict ...
Epoch: 3 cost time: 0.7310125827789307
Epoch: 3, Steps: 123 | Train Loss: 0.8669940 Vali Loss: 0.5554239 Best vali loss: 0.5554239

best validation loss 0.5554239017055411

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744652
	speed: 0.0120s/iter; left time: 10.6345s
Updating learning rate to 0.0002978326994
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.042065143585205
Epoch: 1, Steps: 123 | Train Loss: 0.7744652 Vali Loss: 0.6172923 Best vali loss: 0.6172923
	iters: 100, epoch: 2 | loss: 0.9447311
	speed: 0.0094s/iter; left time: 7.1423s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.6173 --> 0.5956).  Saving model state dict ...
Epoch: 2 cost time: 0.7233338356018066
Epoch: 2, Steps: 123 | Train Loss: 0.9447311 Vali Loss: 0.5956076 Best vali loss: 0.5956076
	iters: 100, epoch: 3 | loss: 0.8630919
	speed: 0.0095s/iter; left time: 6.0766s
Updating learning rate to 7.445817485e-05
Validation loss decreased (0.5956 --> 0.5545).  Saving model state dict ...
Epoch: 3 cost time: 0.729405403137207
Epoch: 3, Steps: 123 | Train Loss: 0.8630919 Vali Loss: 0.5544652 Best vali loss: 0.5544652

best validation loss 0.5544652324868042

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0056450327832, 'e_layers': 2, 'learning_rate': 0.0043276705688, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3250116
	speed: 0.0100s/iter; left time: 38.0564s
	iters: 200, epoch: 1 | loss: 0.8133702
	speed: 0.0035s/iter; left time: 13.0069s
	iters: 300, epoch: 1 | loss: 0.7762493
	speed: 0.0034s/iter; left time: 12.3221s
	iters: 400, epoch: 1 | loss: 0.8668293
	speed: 0.0034s/iter; left time: 11.9941s
Updating learning rate to 0.0043276705688
Validation loss decreased (inf --> 0.6486).  Saving model state dict ...
Epoch: 1 cost time: 2.054867744445801
Epoch: 1, Steps: 490 | Train Loss: 0.9453651 Vali Loss: 0.6486222 Best vali loss: 0.6486222
	iters: 100, epoch: 2 | loss: 0.8402200
	speed: 0.0101s/iter; left time: 33.7303s
	iters: 200, epoch: 2 | loss: 0.8338449
	speed: 0.0036s/iter; left time: 11.6319s
	iters: 300, epoch: 2 | loss: 0.7502692
	speed: 0.0036s/iter; left time: 11.2181s
	iters: 400, epoch: 2 | loss: 0.9004852
	speed: 0.0037s/iter; left time: 11.1846s
Updating learning rate to 0.0021638352844
Epoch: 2 cost time: 1.8348429203033447
Epoch: 2, Steps: 490 | Train Loss: 0.8312048 Vali Loss: 0.6537758 Best vali loss: 0.6486222
	iters: 100, epoch: 3 | loss: 0.8278578
	speed: 0.0101s/iter; left time: 28.7878s
	iters: 200, epoch: 3 | loss: 1.1316683
	speed: 0.0035s/iter; left time: 9.4987s
	iters: 300, epoch: 3 | loss: 0.7109672
	speed: 0.0035s/iter; left time: 9.2082s
	iters: 400, epoch: 3 | loss: 1.0036937
	speed: 0.0037s/iter; left time: 9.2836s
Updating learning rate to 0.0010819176422
Validation loss decreased (0.6486 --> 0.6463).  Saving model state dict ...
Epoch: 3 cost time: 1.7884564399719238
Epoch: 3, Steps: 490 | Train Loss: 0.9185468 Vali Loss: 0.6463429 Best vali loss: 0.6463429

best validation loss 0.6463428505147734

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5962684
	speed: 0.0122s/iter; left time: 6.2954s
Updating learning rate to 3.7229087425e-05
Validation loss decreased (0.5545 --> 0.5376).  Saving model state dict ...
Epoch: 4 cost time: 1.0295698642730713
Epoch: 4, Steps: 123 | Train Loss: 0.5962684 Vali Loss: 0.5375998 Best vali loss: 0.5375998
	iters: 100, epoch: 5 | loss: 0.8493953
	speed: 0.0095s/iter; left time: 3.7263s
Updating learning rate to 1.86145437125e-05
Validation loss decreased (0.5376 --> 0.5295).  Saving model state dict ...
Epoch: 5 cost time: 0.7292330265045166
Epoch: 5, Steps: 123 | Train Loss: 0.8493953 Vali Loss: 0.5295462 Best vali loss: 0.5295462
	iters: 100, epoch: 6 | loss: 0.8054898
	speed: 0.0094s/iter; left time: 2.5461s
Updating learning rate to 9.30727185625e-06
Validation loss decreased (0.5295 --> 0.5295).  Saving model state dict ...
Epoch: 6 cost time: 0.7174839973449707
Epoch: 6, Steps: 123 | Train Loss: 0.8054898 Vali Loss: 0.5294989 Best vali loss: 0.5294989
	iters: 100, epoch: 7 | loss: 0.4812375
	speed: 0.0093s/iter; left time: 1.3684s
Updating learning rate to 4.653635928125e-06
Validation loss decreased (0.5295 --> 0.5288).  Saving model state dict ...
Epoch: 7 cost time: 0.722459077835083
Epoch: 7, Steps: 123 | Train Loss: 0.4812375 Vali Loss: 0.5287554 Best vali loss: 0.5287554
	iters: 100, epoch: 8 | loss: 0.5623574
	speed: 0.0093s/iter; left time: 0.2230s
Updating learning rate to 2.3268179640625e-06
Validation loss decreased (0.5288 --> 0.5279).  Saving model state dict ...
Epoch: 8 cost time: 0.7204446792602539
Epoch: 8, Steps: 123 | Train Loss: 0.5623574 Vali Loss: 0.5279114 Best vali loss: 0.5279114

best validation loss 0.5279113601226048

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745875
	speed: 0.0115s/iter; left time: 10.2039s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0079221725463867
Epoch: 1, Steps: 123 | Train Loss: 0.7745875 Vali Loss: 0.6172987 Best vali loss: 0.6172987
	iters: 100, epoch: 2 | loss: 0.9414679
	speed: 0.0092s/iter; left time: 6.9805s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6173 --> 0.6113).  Saving model state dict ...
Epoch: 2 cost time: 0.726499080657959
Epoch: 2, Steps: 123 | Train Loss: 0.9414679 Vali Loss: 0.6113299 Best vali loss: 0.6113299
	iters: 100, epoch: 3 | loss: 0.8459045
	speed: 0.0095s/iter; left time: 6.0661s
Updating learning rate to 7.442084605e-05
Validation loss decreased (0.6113 --> 0.5455).  Saving model state dict ...
Epoch: 3 cost time: 0.7245960235595703
Epoch: 3, Steps: 123 | Train Loss: 0.8459045 Vali Loss: 0.5455288 Best vali loss: 0.5455288
	iters: 100, epoch: 4 | loss: 0.4876142
	speed: 0.0093s/iter; left time: 4.8171s
Updating learning rate to 3.7210423025e-05
Validation loss decreased (0.5455 --> 0.5352).  Saving model state dict ...
Epoch: 4 cost time: 0.7280230522155762
Epoch: 4, Steps: 123 | Train Loss: 0.4876142 Vali Loss: 0.5352025 Best vali loss: 0.5352025
	iters: 100, epoch: 5 | loss: 0.5704911
	speed: 0.0094s/iter; left time: 3.6947s
Updating learning rate to 1.86052115125e-05
Validation loss decreased (0.5352 --> 0.5307).  Saving model state dict ...
Epoch: 5 cost time: 0.7281043529510498
Epoch: 5, Steps: 123 | Train Loss: 0.5704911 Vali Loss: 0.5307164 Best vali loss: 0.5307164
	iters: 100, epoch: 6 | loss: 0.6205536
	speed: 0.0094s/iter; left time: 2.5250s
Updating learning rate to 9.30260575625e-06
Validation loss decreased (0.5307 --> 0.5243).  Saving model state dict ...
Epoch: 6 cost time: 0.7256956100463867
Epoch: 6, Steps: 123 | Train Loss: 0.6205536 Vali Loss: 0.5242575 Best vali loss: 0.5242575
	iters: 100, epoch: 7 | loss: 0.5858904
	speed: 0.0094s/iter; left time: 1.3863s
Updating learning rate to 4.651302878125e-06
Epoch: 7 cost time: 0.7289395332336426
Epoch: 7, Steps: 123 | Train Loss: 0.5858904 Vali Loss: 0.5250566 Best vali loss: 0.5242575
	iters: 100, epoch: 8 | loss: 0.7460527
	speed: 0.0090s/iter; left time: 0.2163s
Updating learning rate to 2.3256514390625e-06
Validation loss decreased (0.5243 --> 0.5242).  Saving model state dict ...
Epoch: 8 cost time: 0.7222304344177246
Epoch: 8, Steps: 123 | Train Loss: 0.7460527 Vali Loss: 0.5241979 Best vali loss: 0.5241979

best validation loss 0.5241979016495325

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.001324244122, 'e_layers': 2, 'learning_rate': 0.0001358332017, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2104585
	speed: 0.0098s/iter; left time: 37.5770s
	iters: 200, epoch: 1 | loss: 0.8714379
	speed: 0.0035s/iter; left time: 12.9749s
	iters: 300, epoch: 1 | loss: 0.5199817
	speed: 0.0035s/iter; left time: 12.6024s
	iters: 400, epoch: 1 | loss: 1.0918442
	speed: 0.0035s/iter; left time: 12.1864s
Updating learning rate to 0.00013066335829305364
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 2.0435304641723633
Epoch: 1, Steps: 490 | Train Loss: 0.9234306 Vali Loss: 0.6184336 Best vali loss: 0.6184336
	iters: 100, epoch: 2 | loss: 0.9960411
	speed: 0.0096s/iter; left time: 32.0383s
	iters: 200, epoch: 2 | loss: 0.8685604
	speed: 0.0034s/iter; left time: 10.9384s
	iters: 300, epoch: 2 | loss: 0.4506092
	speed: 0.0034s/iter; left time: 10.6675s
	iters: 400, epoch: 2 | loss: 0.9814662
	speed: 0.0034s/iter; left time: 10.3729s
Updating learning rate to 0.00011594088986617503
Validation loss decreased (0.6184 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 1.708479404449463
Epoch: 2, Steps: 490 | Train Loss: 0.8241692 Vali Loss: 0.6044366 Best vali loss: 0.6044366
	iters: 100, epoch: 3 | loss: 0.6705906
	speed: 0.0098s/iter; left time: 27.9252s
	iters: 200, epoch: 3 | loss: 0.8453686
	speed: 0.0034s/iter; left time: 9.3204s
	iters: 300, epoch: 3 | loss: 0.8284083
	speed: 0.0035s/iter; left time: 9.1435s
	iters: 400, epoch: 3 | loss: 1.1568482
	speed: 0.0033s/iter; left time: 8.4957s
Updating learning rate to 9.390715877784777e-05
Epoch: 3 cost time: 1.7131798267364502
Epoch: 3, Steps: 490 | Train Loss: 0.8753039 Vali Loss: 0.6090106 Best vali loss: 0.6044366
	iters: 100, epoch: 4 | loss: 0.9518206
	speed: 0.0098s/iter; left time: 23.1182s
	iters: 200, epoch: 4 | loss: 1.3964233
	speed: 0.0034s/iter; left time: 7.6746s
	iters: 300, epoch: 4 | loss: 0.5569932
	speed: 0.0035s/iter; left time: 7.4452s
	iters: 400, epoch: 4 | loss: 0.7111472
	speed: 0.0034s/iter; left time: 6.9760s
Updating learning rate to 6.791660085e-05
Validation loss decreased (0.6044 --> 0.6039).  Saving model state dict ...
Epoch: 4 cost time: 1.7232232093811035
Epoch: 4, Steps: 490 | Train Loss: 0.9040961 Vali Loss: 0.6038833 Best vali loss: 0.6038833
	iters: 100, epoch: 5 | loss: 0.9708281
	speed: 0.0098s/iter; left time: 18.2703s
	iters: 200, epoch: 5 | loss: 0.7166294
	speed: 0.0036s/iter; left time: 6.3142s
	iters: 300, epoch: 5 | loss: 0.6012295
	speed: 0.0036s/iter; left time: 5.9498s
	iters: 400, epoch: 5 | loss: 0.6293021
	speed: 0.0034s/iter; left time: 5.3089s
Updating learning rate to 4.1926042922152226e-05
Epoch: 5 cost time: 1.7437663078308105
Epoch: 5, Steps: 490 | Train Loss: 0.7294973 Vali Loss: 0.6111083 Best vali loss: 0.6038833
	iters: 100, epoch: 6 | loss: 1.0455103
	speed: 0.0097s/iter; left time: 13.3342s
	iters: 200, epoch: 6 | loss: 0.7356274
	speed: 0.0033s/iter; left time: 4.2047s
	iters: 300, epoch: 6 | loss: 0.5901951
	speed: 0.0035s/iter; left time: 4.0882s
	iters: 400, epoch: 6 | loss: 1.9562229
	speed: 0.0034s/iter; left time: 3.6595s
Updating learning rate to 1.9892311833824965e-05
Epoch: 6 cost time: 1.7241168022155762
Epoch: 6, Steps: 490 | Train Loss: 1.0818889 Vali Loss: 0.6085903 Best vali loss: 0.6038833
	iters: 100, epoch: 7 | loss: 0.7582733
	speed: 0.0102s/iter; left time: 8.9429s
	iters: 200, epoch: 7 | loss: 0.9845624
	speed: 0.0036s/iter; left time: 2.8259s
	iters: 300, epoch: 7 | loss: 1.1358190
	speed: 0.0036s/iter; left time: 2.4560s
	iters: 400, epoch: 7 | loss: 0.6831225
	speed: 0.0036s/iter; left time: 2.1086s
Updating learning rate to 5.16984340694634e-06
Epoch: 7 cost time: 1.8252501487731934
Epoch: 7, Steps: 490 | Train Loss: 0.8904443 Vali Loss: 0.6099721 Best vali loss: 0.6038833
	iters: 100, epoch: 8 | loss: 0.9702269
	speed: 0.0100s/iter; left time: 3.9018s
	iters: 200, epoch: 8 | loss: 0.6147444
	speed: 0.0035s/iter; left time: 1.0265s
	iters: 300, epoch: 8 | loss: 0.8524769
	speed: 0.0036s/iter; left time: 0.6810s
	iters: 400, epoch: 8 | loss: 1.0666096
	speed: 0.0035s/iter; left time: 0.3158s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7745141983032227
Epoch: 8, Steps: 490 | Train Loss: 0.8760144 Vali Loss: 0.6107136 Best vali loss: 0.6038833

best validation loss 0.6038833132280017

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 1, 'learning_rate': 0.000296256208, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0187235
	speed: 0.0101s/iter; left time: 8.9766s
Updating learning rate to 0.00028498062747530327
Validation loss decreased (inf --> 0.5964).  Saving model state dict ...
Epoch: 1 cost time: 0.8210289478302002
Epoch: 1, Steps: 123 | Train Loss: 1.0187235 Vali Loss: 0.5964206 Best vali loss: 0.5964206
	iters: 100, epoch: 2 | loss: 0.7017415
	speed: 0.0069s/iter; left time: 5.2250s
Updating learning rate to 0.00025287049082270614
Epoch: 2 cost time: 0.5058684349060059
Epoch: 2, Steps: 123 | Train Loss: 0.7017415 Vali Loss: 0.6003097 Best vali loss: 0.5964206
	iters: 100, epoch: 3 | loss: 0.6462443
	speed: 0.0065s/iter; left time: 4.1371s
Updating learning rate to 0.000204814275268453
Epoch: 3 cost time: 0.478809118270874
Epoch: 3, Steps: 123 | Train Loss: 0.6462443 Vali Loss: 0.6168251 Best vali loss: 0.5964206

best validation loss 0.5964205894189982

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 1, 'learning_rate': 0.0002952638843, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0186708
	speed: 0.0102s/iter; left time: 9.0066s
Updating learning rate to 0.00028402607184727536
Validation loss decreased (inf --> 0.5964).  Saving model state dict ...
Epoch: 1 cost time: 0.8193297386169434
Epoch: 1, Steps: 123 | Train Loss: 1.0186708 Vali Loss: 0.5963674 Best vali loss: 0.5963674
	iters: 100, epoch: 2 | loss: 0.7037979
	speed: 0.0069s/iter; left time: 5.2879s
Updating learning rate to 0.0002520234895640051
Epoch: 2 cost time: 0.508800745010376
Epoch: 2, Steps: 123 | Train Loss: 0.7037979 Vali Loss: 0.6011100 Best vali loss: 0.5963674
	iters: 100, epoch: 3 | loss: 0.6525759
	speed: 0.0066s/iter; left time: 4.1996s
Updating learning rate to 0.0002041282404986864
Epoch: 3 cost time: 0.49045443534851074
Epoch: 3, Steps: 123 | Train Loss: 0.6525759 Vali Loss: 0.6119930 Best vali loss: 0.5963674

best validation loss 0.5963673690081415

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 1, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0187247
	speed: 0.0101s/iter; left time: 8.9184s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.5964).  Saving model state dict ...
Epoch: 1 cost time: 0.8109707832336426
Epoch: 1, Steps: 123 | Train Loss: 1.0187247 Vali Loss: 0.5964151 Best vali loss: 0.5964151
	iters: 100, epoch: 2 | loss: 0.7021378
	speed: 0.0069s/iter; left time: 5.2323s
Updating learning rate to 0.0002542168065605627
Epoch: 2 cost time: 0.5197904109954834
Epoch: 2, Steps: 123 | Train Loss: 0.7021378 Vali Loss: 0.6005012 Best vali loss: 0.5964151
	iters: 100, epoch: 3 | loss: 0.6476951
	speed: 0.0068s/iter; left time: 4.3222s
Updating learning rate to 0.00020590473339677975
Epoch: 3 cost time: 0.49482202529907227
Epoch: 3, Steps: 123 | Train Loss: 0.6476951 Vali Loss: 0.6175117 Best vali loss: 0.5964151

best validation loss 0.5964151153626237

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 1, 'learning_rate': 0.0002952638843, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9458525
	speed: 0.0104s/iter; left time: 5.3713s
Updating learning rate to 0.00014763194215
Epoch: 4 cost time: 0.8264143466949463
Epoch: 4, Steps: 123 | Train Loss: 0.9458525 Vali Loss: 0.6243866 Best vali loss: 0.5963674
	iters: 100, epoch: 5 | loss: 0.6421707
	speed: 0.0067s/iter; left time: 2.6266s
Updating learning rate to 9.113564380131364e-05
Epoch: 5 cost time: 0.4936361312866211
Epoch: 5, Steps: 123 | Train Loss: 0.6421707 Vali Loss: 0.6245442 Best vali loss: 0.5963674
	iters: 100, epoch: 6 | loss: 0.6270050
	speed: 0.0070s/iter; left time: 1.9019s
Updating learning rate to 4.324039473599492e-05
Epoch: 6 cost time: 0.5436713695526123
Epoch: 6, Steps: 123 | Train Loss: 0.6270050 Vali Loss: 0.6286151 Best vali loss: 0.5963674
	iters: 100, epoch: 7 | loss: 0.5818121
	speed: 0.0069s/iter; left time: 1.0085s
Updating learning rate to 1.1237812452724672e-05
Epoch: 7 cost time: 0.48768115043640137
Epoch: 7, Steps: 123 | Train Loss: 0.5818121 Vali Loss: 0.6348242 Best vali loss: 0.5963674
	iters: 100, epoch: 8 | loss: 0.5592762
	speed: 0.0066s/iter; left time: 0.1591s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5075764656066895
Epoch: 8, Steps: 123 | Train Loss: 0.5592762 Vali Loss: 0.6357447 Best vali loss: 0.5963674

best validation loss 0.5963673690081415

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 1, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0186968
	speed: 0.0100s/iter; left time: 8.8253s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.5965).  Saving model state dict ...
Epoch: 1 cost time: 0.8135275840759277
Epoch: 1, Steps: 123 | Train Loss: 1.0186968 Vali Loss: 0.5964612 Best vali loss: 0.5964612
	iters: 100, epoch: 2 | loss: 0.7029291
	speed: 0.0068s/iter; left time: 5.1939s
Updating learning rate to 0.0002540886619071902
Epoch: 2 cost time: 0.5040345191955566
Epoch: 2, Steps: 123 | Train Loss: 0.7029291 Vali Loss: 0.6004778 Best vali loss: 0.5964612
	iters: 100, epoch: 3 | loss: 0.6537976
	speed: 0.0068s/iter; left time: 4.3205s
Updating learning rate to 0.0002058009417118559
Epoch: 3 cost time: 0.5094823837280273
Epoch: 3, Steps: 123 | Train Loss: 0.6537976 Vali Loss: 0.6127797 Best vali loss: 0.5964612
	iters: 100, epoch: 4 | loss: 0.6433088
	speed: 0.0067s/iter; left time: 3.4640s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.5031802654266357
Epoch: 4, Steps: 123 | Train Loss: 0.6433088 Vali Loss: 0.6339050 Best vali loss: 0.5964612
	iters: 100, epoch: 5 | loss: 0.5855999
	speed: 0.0068s/iter; left time: 2.6831s
Updating learning rate to 9.188244248814415e-05
Epoch: 5 cost time: 0.5206665992736816
Epoch: 5, Steps: 123 | Train Loss: 0.5855999 Vali Loss: 0.6293370 Best vali loss: 0.5964612
	iters: 100, epoch: 6 | loss: 0.6577743
	speed: 0.0068s/iter; left time: 1.8378s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.5007073879241943
Epoch: 6, Steps: 123 | Train Loss: 0.6577743 Vali Loss: 0.6345415 Best vali loss: 0.5964612
	iters: 100, epoch: 7 | loss: 0.5634788
	speed: 0.0066s/iter; left time: 0.9653s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.48497819900512695
Epoch: 7, Steps: 123 | Train Loss: 0.5634788 Vali Loss: 0.6399679 Best vali loss: 0.5964612
	iters: 100, epoch: 8 | loss: 0.5333301
	speed: 0.0066s/iter; left time: 0.1585s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4884066581726074
Epoch: 8, Steps: 123 | Train Loss: 0.5333301 Vali Loss: 0.6363136 Best vali loss: 0.5964612

best validation loss 0.5964612020270132

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0032025338939, 'e_layers': 3, 'learning_rate': 0.0001479892669, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9546183
	speed: 0.0107s/iter; left time: 40.7764s
	iters: 200, epoch: 1 | loss: 0.4430390
	speed: 0.0042s/iter; left time: 15.7030s
	iters: 300, epoch: 1 | loss: 1.0701592
	speed: 0.0043s/iter; left time: 15.4021s
	iters: 400, epoch: 1 | loss: 1.0038669
	speed: 0.0042s/iter; left time: 14.6528s
Updating learning rate to 0.00014235676081013001
Validation loss decreased (inf --> 0.5993).  Saving model state dict ...
Epoch: 1 cost time: 2.4628257751464844
Epoch: 1, Steps: 490 | Train Loss: 0.8679209 Vali Loss: 0.5992874 Best vali loss: 0.5992874
	iters: 100, epoch: 2 | loss: 0.9267668
	speed: 0.0121s/iter; left time: 40.4641s
	iters: 200, epoch: 2 | loss: 0.6247046
	speed: 0.0046s/iter; left time: 14.7918s
	iters: 300, epoch: 2 | loss: 0.8673526
	speed: 0.0045s/iter; left time: 13.9563s
	iters: 400, epoch: 2 | loss: 0.9412681
	speed: 0.0044s/iter; left time: 13.4070s
Updating learning rate to 0.00012631674053390792
Validation loss decreased (0.5993 --> 0.5578).  Saving model state dict ...
Epoch: 2 cost time: 2.236206531524658
Epoch: 2, Steps: 490 | Train Loss: 0.8400230 Vali Loss: 0.5578392 Best vali loss: 0.5578392
	iters: 100, epoch: 3 | loss: 0.8821646
	speed: 0.0120s/iter; left time: 34.0742s
	iters: 200, epoch: 3 | loss: 0.6577301
	speed: 0.0043s/iter; left time: 11.8453s
	iters: 300, epoch: 3 | loss: 0.9950622
	speed: 0.0042s/iter; left time: 11.0896s
	iters: 400, epoch: 3 | loss: 0.7362875
	speed: 0.0042s/iter; left time: 10.7857s
Updating learning rate to 0.00010231115375524269
Epoch: 3 cost time: 2.132507085800171
Epoch: 3, Steps: 490 | Train Loss: 0.8178111 Vali Loss: 0.5586280 Best vali loss: 0.5578392
	iters: 100, epoch: 4 | loss: 0.6670816
	speed: 0.0117s/iter; left time: 27.4483s
	iters: 200, epoch: 4 | loss: 0.6965724
	speed: 0.0042s/iter; left time: 9.3870s
	iters: 300, epoch: 4 | loss: 0.8276948
	speed: 0.0043s/iter; left time: 9.2537s
	iters: 400, epoch: 4 | loss: 1.1496701
	speed: 0.0042s/iter; left time: 8.6000s
Updating learning rate to 7.399463345e-05
Validation loss decreased (0.5578 --> 0.5438).  Saving model state dict ...
Epoch: 4 cost time: 2.124361991882324
Epoch: 4, Steps: 490 | Train Loss: 0.8352547 Vali Loss: 0.5438274 Best vali loss: 0.5438274
	iters: 100, epoch: 5 | loss: 0.5207067
	speed: 0.0121s/iter; left time: 22.4653s
	iters: 200, epoch: 5 | loss: 0.6834862
	speed: 0.0041s/iter; left time: 7.2170s
	iters: 300, epoch: 5 | loss: 0.7403416
	speed: 0.0041s/iter; left time: 6.8280s
	iters: 400, epoch: 5 | loss: 0.6442214
	speed: 0.0040s/iter; left time: 6.2994s
Updating learning rate to 4.5678113144757315e-05
Epoch: 5 cost time: 2.0571975708007812
Epoch: 5, Steps: 490 | Train Loss: 0.6471890 Vali Loss: 0.5550592 Best vali loss: 0.5438274
	iters: 100, epoch: 6 | loss: 0.7368748
	speed: 0.0117s/iter; left time: 15.9866s
	iters: 200, epoch: 6 | loss: 0.7017264
	speed: 0.0044s/iter; left time: 5.5993s
	iters: 300, epoch: 6 | loss: 0.4848196
	speed: 0.0043s/iter; left time: 4.9844s
	iters: 400, epoch: 6 | loss: 0.4249601
	speed: 0.0047s/iter; left time: 5.0068s
Updating learning rate to 2.1672526366092062e-05
Epoch: 6 cost time: 2.2642431259155273
Epoch: 6, Steps: 490 | Train Loss: 0.5870952 Vali Loss: 0.5612422 Best vali loss: 0.5438274
	iters: 100, epoch: 7 | loss: 0.7786195
	speed: 0.0118s/iter; left time: 10.4208s
	iters: 200, epoch: 7 | loss: 0.6332323
	speed: 0.0039s/iter; left time: 3.0307s
	iters: 300, epoch: 7 | loss: 0.7115328
	speed: 0.0040s/iter; left time: 2.6948s
	iters: 400, epoch: 7 | loss: 0.3888899
	speed: 0.0039s/iter; left time: 2.2699s
Updating learning rate to 5.632506089869979e-06
Epoch: 7 cost time: 1.9631175994873047
Epoch: 7, Steps: 490 | Train Loss: 0.6280686 Vali Loss: 0.5562899 Best vali loss: 0.5438274
	iters: 100, epoch: 8 | loss: 0.5617015
	speed: 0.0113s/iter; left time: 4.4192s
	iters: 200, epoch: 8 | loss: 0.8056142
	speed: 0.0043s/iter; left time: 1.2435s
	iters: 300, epoch: 8 | loss: 0.9031852
	speed: 0.0041s/iter; left time: 0.7918s
	iters: 400, epoch: 8 | loss: 0.4296010
	speed: 0.0040s/iter; left time: 0.3666s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.044952869415283
Epoch: 8, Steps: 490 | Train Loss: 0.6750255 Vali Loss: 0.5588509 Best vali loss: 0.5438274

best validation loss 0.5438273831105574

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010466650921, 'e_layers': 2, 'learning_rate': 0.0002976850629, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744812
	speed: 0.0119s/iter; left time: 10.4895s
Updating learning rate to 0.0002863550998238225
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0333583354949951
Epoch: 1, Steps: 123 | Train Loss: 0.7744812 Vali Loss: 0.6172179 Best vali loss: 0.6172179
	iters: 100, epoch: 2 | loss: 0.9523199
	speed: 0.0095s/iter; left time: 7.2187s
Updating learning rate to 0.00025409009476726695
Validation loss decreased (0.6172 --> 0.5659).  Saving model state dict ...
Epoch: 2 cost time: 0.7362411022186279
Epoch: 2, Steps: 123 | Train Loss: 0.9523199 Vali Loss: 0.5658562 Best vali loss: 0.5658562
	iters: 100, epoch: 3 | loss: 0.8591629
	speed: 0.0094s/iter; left time: 5.9799s
Updating learning rate to 0.00020580210226719484
Validation loss decreased (0.5659 --> 0.5550).  Saving model state dict ...
Epoch: 3 cost time: 0.7179477214813232
Epoch: 3, Steps: 123 | Train Loss: 0.8591629 Vali Loss: 0.5550422 Best vali loss: 0.5550422

best validation loss 0.5550421704191237

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9043654
	speed: 0.0121s/iter; left time: 10.7382s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 1.0669639110565186
Epoch: 1, Steps: 123 | Train Loss: 0.9043654 Vali Loss: 0.6029427 Best vali loss: 0.6029427
	iters: 100, epoch: 2 | loss: 0.8267753
	speed: 0.0097s/iter; left time: 7.3638s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6029 --> 0.5990).  Saving model state dict ...
Epoch: 2 cost time: 0.7481935024261475
Epoch: 2, Steps: 123 | Train Loss: 0.8267753 Vali Loss: 0.5990159 Best vali loss: 0.5990159
	iters: 100, epoch: 3 | loss: 0.6596291
	speed: 0.0098s/iter; left time: 6.2857s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.7543148994445801
Epoch: 3, Steps: 123 | Train Loss: 0.6596291 Vali Loss: 0.6339314 Best vali loss: 0.5990159

best validation loss 0.5990158664247935

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010491990586, 'e_layers': 4, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7512329
	speed: 0.0165s/iter; left time: 14.6317s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6093).  Saving model state dict ...
Epoch: 1 cost time: 1.605762243270874
Epoch: 1, Steps: 123 | Train Loss: 0.7512329 Vali Loss: 0.6092709 Best vali loss: 0.6092709
	iters: 100, epoch: 2 | loss: 0.9982513
	speed: 0.0157s/iter; left time: 11.9764s
Updating learning rate to 0.0002542168065605627
Epoch: 2 cost time: 1.2961676120758057
Epoch: 2, Steps: 123 | Train Loss: 0.9982513 Vali Loss: 0.6417358 Best vali loss: 0.6092709
	iters: 100, epoch: 3 | loss: 0.7596560
	speed: 0.0154s/iter; left time: 9.8318s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6093 --> 0.5601).  Saving model state dict ...
Epoch: 3 cost time: 1.293776512145996
Epoch: 3, Steps: 123 | Train Loss: 0.7596560 Vali Loss: 0.5600765 Best vali loss: 0.5600765

best validation loss 0.560076548732138

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010466650921, 'e_layers': 2, 'learning_rate': 0.0002976850629, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5929231
	speed: 0.0122s/iter; left time: 6.3117s
Updating learning rate to 0.00014884253145
Validation loss decreased (0.5550 --> 0.5349).  Saving model state dict ...
Epoch: 4 cost time: 1.0560669898986816
Epoch: 4, Steps: 123 | Train Loss: 0.5929231 Vali Loss: 0.5348790 Best vali loss: 0.5348790
	iters: 100, epoch: 5 | loss: 0.8298237
	speed: 0.0096s/iter; left time: 3.7785s
Updating learning rate to 9.188296063280518e-05
Validation loss decreased (0.5349 --> 0.5286).  Saving model state dict ...
Epoch: 5 cost time: 0.7312397956848145
Epoch: 5, Steps: 123 | Train Loss: 0.8298237 Vali Loss: 0.5286305 Best vali loss: 0.5286305
	iters: 100, epoch: 6 | loss: 0.7626243
	speed: 0.0096s/iter; left time: 2.6033s
Updating learning rate to 4.359496813273304e-05
Epoch: 6 cost time: 0.7369635105133057
Epoch: 6, Steps: 123 | Train Loss: 0.7626243 Vali Loss: 0.5359274 Best vali loss: 0.5286305
	iters: 100, epoch: 7 | loss: 0.4279367
	speed: 0.0093s/iter; left time: 1.3681s
Updating learning rate to 1.1329963076177505e-05
Epoch: 7 cost time: 0.7423603534698486
Epoch: 7, Steps: 123 | Train Loss: 0.4279367 Vali Loss: 0.5430595 Best vali loss: 0.5286305
	iters: 100, epoch: 8 | loss: 0.5074926
	speed: 0.0096s/iter; left time: 0.2294s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7493681907653809
Epoch: 8, Steps: 123 | Train Loss: 0.5074926 Vali Loss: 0.5431402 Best vali loss: 0.5286305

best validation loss 0.5286305097726031

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.003379519863, 'e_layers': 1, 'learning_rate': 0.0005483618872, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9638359
	speed: 0.0094s/iter; left time: 35.7593s
	iters: 200, epoch: 1 | loss: 0.3705414
	speed: 0.0028s/iter; left time: 10.5958s
	iters: 300, epoch: 1 | loss: 0.7783275
	speed: 0.0028s/iter; left time: 10.1266s
	iters: 400, epoch: 1 | loss: 0.7990553
	speed: 0.0027s/iter; left time: 9.6052s
Updating learning rate to 0.0005274911055966715
Validation loss decreased (inf --> 0.6073).  Saving model state dict ...
Epoch: 1 cost time: 1.7446532249450684
Epoch: 1, Steps: 490 | Train Loss: 0.7279400 Vali Loss: 0.6073291 Best vali loss: 0.6073291
	iters: 100, epoch: 2 | loss: 0.5309113
	speed: 0.0086s/iter; left time: 28.8017s
	iters: 200, epoch: 2 | loss: 0.6030126
	speed: 0.0027s/iter; left time: 8.7084s
	iters: 300, epoch: 2 | loss: 0.8968611
	speed: 0.0027s/iter; left time: 8.4058s
	iters: 400, epoch: 2 | loss: 0.7866776
	speed: 0.0027s/iter; left time: 8.1470s
Updating learning rate to 0.0004680561480916863
Epoch: 2 cost time: 1.3837833404541016
Epoch: 2, Steps: 490 | Train Loss: 0.7043657 Vali Loss: 0.6310024 Best vali loss: 0.6073291
	iters: 100, epoch: 3 | loss: 0.4409584
	speed: 0.0086s/iter; left time: 24.3503s
	iters: 200, epoch: 3 | loss: 0.7195571
	speed: 0.0027s/iter; left time: 7.3764s
	iters: 300, epoch: 3 | loss: 1.0430834
	speed: 0.0027s/iter; left time: 7.1949s
	iters: 400, epoch: 3 | loss: 0.6269900
	speed: 0.0029s/iter; left time: 7.2830s
Updating learning rate to 0.00037910544818594715
Validation loss decreased (0.6073 --> 0.5943).  Saving model state dict ...
Epoch: 3 cost time: 1.4205076694488525
Epoch: 3, Steps: 490 | Train Loss: 0.7076472 Vali Loss: 0.5943373 Best vali loss: 0.5943373
	iters: 100, epoch: 4 | loss: 0.3442967
	speed: 0.0086s/iter; left time: 20.1557s
	iters: 200, epoch: 4 | loss: 0.8416461
	speed: 0.0027s/iter; left time: 6.0345s
	iters: 300, epoch: 4 | loss: 0.8168843
	speed: 0.0027s/iter; left time: 5.8031s
	iters: 400, epoch: 4 | loss: 0.5158809
	speed: 0.0025s/iter; left time: 5.0387s
Updating learning rate to 0.0002741809436
Epoch: 4 cost time: 1.3348290920257568
Epoch: 4, Steps: 490 | Train Loss: 0.6296770 Vali Loss: 0.6348278 Best vali loss: 0.5943373
	iters: 100, epoch: 5 | loss: 0.5561392
	speed: 0.0083s/iter; left time: 15.3979s
	iters: 200, epoch: 5 | loss: 0.9007288
	speed: 0.0026s/iter; left time: 4.6099s
	iters: 300, epoch: 5 | loss: 0.3480625
	speed: 0.0026s/iter; left time: 4.2559s
	iters: 400, epoch: 5 | loss: 0.5421137
	speed: 0.0027s/iter; left time: 4.1607s
Updating learning rate to 0.00016925643901405293
Epoch: 5 cost time: 1.3505096435546875
Epoch: 5, Steps: 490 | Train Loss: 0.5867610 Vali Loss: 0.6311447 Best vali loss: 0.5943373
	iters: 100, epoch: 6 | loss: 0.9659095
	speed: 0.0087s/iter; left time: 11.9128s
	iters: 200, epoch: 6 | loss: 0.6482192
	speed: 0.0025s/iter; left time: 3.2141s
	iters: 300, epoch: 6 | loss: 0.5931449
	speed: 0.0025s/iter; left time: 2.9859s
	iters: 400, epoch: 6 | loss: 0.6268997
	speed: 0.0025s/iter; left time: 2.7104s
Updating learning rate to 8.03057391083137e-05
Epoch: 6 cost time: 1.3222956657409668
Epoch: 6, Steps: 490 | Train Loss: 0.7085433 Vali Loss: 0.6468167 Best vali loss: 0.5943373
	iters: 100, epoch: 7 | loss: 0.5912003
	speed: 0.0086s/iter; left time: 7.5326s
	iters: 200, epoch: 7 | loss: 0.3988340
	speed: 0.0026s/iter; left time: 1.9939s
	iters: 300, epoch: 7 | loss: 0.6719804
	speed: 0.0026s/iter; left time: 1.7459s
	iters: 400, epoch: 7 | loss: 0.7785120
	speed: 0.0026s/iter; left time: 1.4887s
Updating learning rate to 2.0870781603328526e-05
Epoch: 7 cost time: 1.3312768936157227
Epoch: 7, Steps: 490 | Train Loss: 0.6101317 Vali Loss: 0.6400438 Best vali loss: 0.5943373
	iters: 100, epoch: 8 | loss: 0.4100116
	speed: 0.0083s/iter; left time: 3.2425s
	iters: 200, epoch: 8 | loss: 0.9097866
	speed: 0.0025s/iter; left time: 0.7320s
	iters: 300, epoch: 8 | loss: 0.4648013
	speed: 0.0024s/iter; left time: 0.4679s
	iters: 400, epoch: 8 | loss: 0.5729953
	speed: 0.0025s/iter; left time: 0.2230s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.286982536315918
Epoch: 8, Steps: 490 | Train Loss: 0.5893987 Vali Loss: 0.6408533 Best vali loss: 0.5943373

best validation loss 0.5943373017347504

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010490976855, 'e_layers': 4, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7512383
	speed: 0.0163s/iter; left time: 14.4683s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 1.601975679397583
Epoch: 1, Steps: 123 | Train Loss: 0.7512383 Vali Loss: 0.6093693 Best vali loss: 0.6093693
	iters: 100, epoch: 2 | loss: 0.9855366
	speed: 0.0153s/iter; left time: 11.6677s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6094 --> 0.5808).  Saving model state dict ...
Epoch: 2 cost time: 1.2727718353271484
Epoch: 2, Steps: 123 | Train Loss: 0.9855366 Vali Loss: 0.5808368 Best vali loss: 0.5808368
	iters: 100, epoch: 3 | loss: 0.7603066
	speed: 0.0156s/iter; left time: 9.9610s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5808 --> 0.5622).  Saving model state dict ...
Epoch: 3 cost time: 1.274366855621338
Epoch: 3, Steps: 123 | Train Loss: 0.7603066 Vali Loss: 0.5622005 Best vali loss: 0.5622005
	iters: 100, epoch: 4 | loss: 0.5706248
	speed: 0.0156s/iter; left time: 8.0579s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 1.2759292125701904
Epoch: 4, Steps: 123 | Train Loss: 0.5706248 Vali Loss: 0.5792995 Best vali loss: 0.5622005
	iters: 100, epoch: 5 | loss: 0.6075493
	speed: 0.0150s/iter; left time: 5.8974s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5622 --> 0.5605).  Saving model state dict ...
Epoch: 5 cost time: 1.2739098072052002
Epoch: 5, Steps: 123 | Train Loss: 0.6075493 Vali Loss: 0.5605430 Best vali loss: 0.5605430
	iters: 100, epoch: 6 | loss: 0.6594055
	speed: 0.0156s/iter; left time: 4.2101s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 1.2737302780151367
Epoch: 6, Steps: 123 | Train Loss: 0.6594055 Vali Loss: 0.5866214 Best vali loss: 0.5605430
	iters: 100, epoch: 7 | loss: 0.6254871
	speed: 0.0150s/iter; left time: 2.2098s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 1.277090072631836
Epoch: 7, Steps: 123 | Train Loss: 0.6254871 Vali Loss: 0.6060032 Best vali loss: 0.5605430
	iters: 100, epoch: 8 | loss: 0.5653644
	speed: 0.0151s/iter; left time: 0.3623s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2794289588928223
Epoch: 8, Steps: 123 | Train Loss: 0.5653644 Vali Loss: 0.6021411 Best vali loss: 0.5605430

best validation loss 0.5605429858589879

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010488970086, 'e_layers': 3, 'learning_rate': 0.0003477165221, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00033448234999209925
Validation loss decreased (inf --> 0.5969).  Saving model state dict ...
Epoch: 1 cost time: 0.7735381126403809
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5968768 Best vali loss: 0.5968768
Updating learning rate to 0.00029679461640375596
Validation loss decreased (0.5969 --> 0.5955).  Saving model state dict ...
Epoch: 2 cost time: 0.473128080368042
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5954947 Best vali loss: 0.5954947
Updating learning rate to 0.0002403909371336398
Validation loss decreased (0.5955 --> 0.5499).  Saving model state dict ...
Epoch: 3 cost time: 0.470123291015625
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5498614 Best vali loss: 0.5498614

best validation loss 0.5498614327767446

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042709596571, 'e_layers': 3, 'learning_rate': 0.001787831536, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0234824
	speed: 0.0107s/iter; left time: 82.9029s
	iters: 200, epoch: 1 | loss: 1.2097809
	speed: 0.0042s/iter; left time: 32.4289s
	iters: 300, epoch: 1 | loss: 0.3566707
	speed: 0.0043s/iter; left time: 32.5181s
	iters: 400, epoch: 1 | loss: 1.8822641
	speed: 0.0043s/iter; left time: 32.2350s
	iters: 500, epoch: 1 | loss: 0.8360360
	speed: 0.0043s/iter; left time: 31.5755s
	iters: 600, epoch: 1 | loss: 1.0904421
	speed: 0.0041s/iter; left time: 29.3645s
	iters: 700, epoch: 1 | loss: 0.5758387
	speed: 0.0038s/iter; left time: 27.4466s
	iters: 800, epoch: 1 | loss: 0.8065040
	speed: 0.0038s/iter; left time: 27.0565s
	iters: 900, epoch: 1 | loss: 1.9083952
	speed: 0.0038s/iter; left time: 26.5515s
Updating learning rate to 0.001787831536
Validation loss decreased (inf --> 0.6406).  Saving model state dict ...
Epoch: 1 cost time: 4.37156867980957
Epoch: 1, Steps: 979 | Train Loss: 1.0766016 Vali Loss: 0.6405587 Best vali loss: 0.6405587
	iters: 100, epoch: 2 | loss: 1.0330745
	speed: 0.0130s/iter; left time: 88.0187s
	iters: 200, epoch: 2 | loss: 0.8877468
	speed: 0.0045s/iter; left time: 29.6310s
	iters: 300, epoch: 2 | loss: 0.9690769
	speed: 0.0042s/iter; left time: 27.6714s
	iters: 400, epoch: 2 | loss: 0.7452459
	speed: 0.0043s/iter; left time: 27.4895s
	iters: 500, epoch: 2 | loss: 1.5751760
	speed: 0.0044s/iter; left time: 28.2591s
	iters: 600, epoch: 2 | loss: 1.5965990
	speed: 0.0043s/iter; left time: 26.9134s
	iters: 700, epoch: 2 | loss: 0.6481499
	speed: 0.0044s/iter; left time: 27.0215s
	iters: 800, epoch: 2 | loss: 0.4111234
	speed: 0.0045s/iter; left time: 27.1673s
	iters: 900, epoch: 2 | loss: 1.3117236
	speed: 0.0045s/iter; left time: 26.6206s
Updating learning rate to 0.000893915768
Validation loss decreased (0.6406 --> 0.6251).  Saving model state dict ...
Epoch: 2 cost time: 4.3511903285980225
Epoch: 2, Steps: 979 | Train Loss: 1.0197684 Vali Loss: 0.6251278 Best vali loss: 0.6251278
	iters: 100, epoch: 3 | loss: 0.7439722
	speed: 0.0138s/iter; left time: 79.8435s
	iters: 200, epoch: 3 | loss: 0.3960671
	speed: 0.0044s/iter; left time: 25.1469s
	iters: 300, epoch: 3 | loss: 1.3269863
	speed: 0.0044s/iter; left time: 24.6618s
	iters: 400, epoch: 3 | loss: 0.8120432
	speed: 0.0044s/iter; left time: 24.2026s
	iters: 500, epoch: 3 | loss: 0.7073972
	speed: 0.0043s/iter; left time: 23.0776s
	iters: 600, epoch: 3 | loss: 0.2789923
	speed: 0.0045s/iter; left time: 23.8468s
	iters: 700, epoch: 3 | loss: 1.6373644
	speed: 0.0044s/iter; left time: 22.7824s
	iters: 800, epoch: 3 | loss: 1.4680142
	speed: 0.0039s/iter; left time: 19.7372s
	iters: 900, epoch: 3 | loss: 0.6659366
	speed: 0.0042s/iter; left time: 20.7329s
Updating learning rate to 0.000446957884
Validation loss decreased (0.6251 --> 0.6206).  Saving model state dict ...
Epoch: 3 cost time: 4.266882658004761
Epoch: 3, Steps: 979 | Train Loss: 0.8929748 Vali Loss: 0.6205621 Best vali loss: 0.6205621

best validation loss 0.6205620709418809

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0018065797833, 'e_layers': 1, 'learning_rate': 0.000233013056, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7696524
	speed: 0.0087s/iter; left time: 67.4883s
	iters: 200, epoch: 1 | loss: 1.1506855
	speed: 0.0026s/iter; left time: 20.1330s
	iters: 300, epoch: 1 | loss: 0.6002151
	speed: 0.0025s/iter; left time: 18.6506s
	iters: 400, epoch: 1 | loss: 0.5843810
	speed: 0.0024s/iter; left time: 17.9467s
	iters: 500, epoch: 1 | loss: 0.9052927
	speed: 0.0023s/iter; left time: 17.1917s
	iters: 600, epoch: 1 | loss: 0.9094209
	speed: 0.0023s/iter; left time: 16.6365s
	iters: 700, epoch: 1 | loss: 0.8401460
	speed: 0.0023s/iter; left time: 16.0770s
	iters: 800, epoch: 1 | loss: 0.5232367
	speed: 0.0023s/iter; left time: 16.1395s
	iters: 900, epoch: 1 | loss: 1.6672150
	speed: 0.0023s/iter; left time: 16.0484s
Updating learning rate to 0.00022414452462315315
Validation loss decreased (inf --> 0.6120).  Saving model state dict ...
Epoch: 1 cost time: 2.7040469646453857
Epoch: 1, Steps: 979 | Train Loss: 0.8833606 Vali Loss: 0.6120405 Best vali loss: 0.6120405
	iters: 100, epoch: 2 | loss: 0.8719335
	speed: 0.0087s/iter; left time: 58.6176s
	iters: 200, epoch: 2 | loss: 1.1062691
	speed: 0.0023s/iter; left time: 15.6274s
	iters: 300, epoch: 2 | loss: 0.3307848
	speed: 0.0024s/iter; left time: 15.5885s
	iters: 400, epoch: 2 | loss: 0.2497587
	speed: 0.0024s/iter; left time: 15.2827s
	iters: 500, epoch: 2 | loss: 0.4912268
	speed: 0.0023s/iter; left time: 14.8978s
	iters: 600, epoch: 2 | loss: 0.6242279
	speed: 0.0024s/iter; left time: 14.7410s
	iters: 700, epoch: 2 | loss: 0.7226119
	speed: 0.0023s/iter; left time: 14.0839s
	iters: 800, epoch: 2 | loss: 0.3005709
	speed: 0.0023s/iter; left time: 14.0772s
	iters: 900, epoch: 2 | loss: 0.5178686
	speed: 0.0023s/iter; left time: 13.6291s
Updating learning rate to 0.00019888908400130038
Epoch: 2 cost time: 2.3290536403656006
Epoch: 2, Steps: 979 | Train Loss: 0.5794725 Vali Loss: 0.6165041 Best vali loss: 0.6120405
	iters: 100, epoch: 3 | loss: 0.3360645
	speed: 0.0090s/iter; left time: 52.1739s
	iters: 200, epoch: 3 | loss: 0.7375242
	speed: 0.0026s/iter; left time: 14.6841s
	iters: 300, epoch: 3 | loss: 0.7306954
	speed: 0.0025s/iter; left time: 14.0901s
	iters: 400, epoch: 3 | loss: 0.3651324
	speed: 0.0026s/iter; left time: 14.0891s
	iters: 500, epoch: 3 | loss: 0.7375694
	speed: 0.0025s/iter; left time: 13.5789s
	iters: 600, epoch: 3 | loss: 0.3394418
	speed: 0.0026s/iter; left time: 13.5442s
	iters: 700, epoch: 3 | loss: 1.5049689
	speed: 0.0025s/iter; left time: 12.7470s
	iters: 800, epoch: 3 | loss: 1.0529115
	speed: 0.0024s/iter; left time: 11.9467s
	iters: 900, epoch: 3 | loss: 0.6871006
	speed: 0.0024s/iter; left time: 11.7754s
Updating learning rate to 0.00016109164602797944
Epoch: 3 cost time: 2.4795212745666504
Epoch: 3, Steps: 979 | Train Loss: 0.7212676 Vali Loss: 0.6134181 Best vali loss: 0.6120405

best validation loss 0.6120405171423364

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010488970086, 'e_layers': 3, 'learning_rate': 0.0003477165221, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00017385826105
Validation loss decreased (0.5499 --> 0.5454).  Saving model state dict ...
Epoch: 4 cost time: 0.7735729217529297
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5454036 Best vali loss: 0.5454036
Updating learning rate to 0.0001073255849663602
Epoch: 5 cost time: 0.4807419776916504
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5570780 Best vali loss: 0.5454036
Updating learning rate to 5.0921905696244e-05
Validation loss decreased (0.5454 --> 0.5418).  Saving model state dict ...
Epoch: 6 cost time: 0.47929835319519043
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5418299 Best vali loss: 0.5418299
Updating learning rate to 1.3234172107900747e-05
Validation loss decreased (0.5418 --> 0.5414).  Saving model state dict ...
Epoch: 7 cost time: 0.47151970863342285
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5414465 Best vali loss: 0.5414465
Updating learning rate to 0.0
Validation loss decreased (0.5414 --> 0.5397).  Saving model state dict ...
Epoch: 8 cost time: 0.4728536605834961
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5396516 Best vali loss: 0.5396516

best validation loss 0.5396515988520261

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014210591018, 'e_layers': 1, 'learning_rate': 0.0035809930956, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0035809930956
Validation loss decreased (inf --> 0.6001).  Saving model state dict ...
Epoch: 1 cost time: 0.7015335559844971
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6001053 Best vali loss: 0.6001053
Updating learning rate to 0.0017904965478
Epoch: 2 cost time: 0.4475440979003906
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6422543 Best vali loss: 0.6001053
Updating learning rate to 0.0008952482739
Epoch: 3 cost time: 0.4304938316345215
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6345932 Best vali loss: 0.6001053
Updating learning rate to 0.00044762413695
Epoch: 4 cost time: 0.43282222747802734
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6295431 Best vali loss: 0.6001053
Updating learning rate to 0.000223812068475
Epoch: 5 cost time: 0.43627429008483887
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6482354 Best vali loss: 0.6001053
Updating learning rate to 0.0001119060342375
Epoch: 6 cost time: 0.3991978168487549
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6399975 Best vali loss: 0.6001053
Updating learning rate to 5.595301711875e-05
Epoch: 7 cost time: 0.44492530822753906
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6298585 Best vali loss: 0.6001053
Updating learning rate to 2.7976508559375e-05
Epoch: 8 cost time: 0.4324171543121338
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6318926 Best vali loss: 0.6001053

best validation loss 0.6001053323408124

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0022308531207, 'e_layers': 1, 'learning_rate': 0.000106760062, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4953808
	speed: 0.0095s/iter; left time: 73.3784s
	iters: 200, epoch: 1 | loss: 0.4291825
	speed: 0.0025s/iter; left time: 19.3531s
	iters: 300, epoch: 1 | loss: 0.5113663
	speed: 0.0025s/iter; left time: 18.4768s
	iters: 400, epoch: 1 | loss: 0.7891204
	speed: 0.0024s/iter; left time: 17.5327s
	iters: 500, epoch: 1 | loss: 0.5842794
	speed: 0.0023s/iter; left time: 17.1205s
	iters: 600, epoch: 1 | loss: 0.9962298
	speed: 0.0024s/iter; left time: 17.2033s
	iters: 700, epoch: 1 | loss: 1.1787781
	speed: 0.0024s/iter; left time: 17.2866s
	iters: 800, epoch: 1 | loss: 0.7096264
	speed: 0.0023s/iter; left time: 16.5017s
	iters: 900, epoch: 1 | loss: 0.3491513
	speed: 0.0023s/iter; left time: 16.2643s
Updating learning rate to 0.000106760062
Validation loss decreased (inf --> 0.6189).  Saving model state dict ...
Epoch: 1 cost time: 2.717717409133911
Epoch: 1, Steps: 979 | Train Loss: 0.6714572 Vali Loss: 0.6188794 Best vali loss: 0.6188794
	iters: 100, epoch: 2 | loss: 1.2796541
	speed: 0.0091s/iter; left time: 61.4515s
	iters: 200, epoch: 2 | loss: 0.4524306
	speed: 0.0026s/iter; left time: 17.0554s
	iters: 300, epoch: 2 | loss: 0.6616403
	speed: 0.0025s/iter; left time: 16.3247s
	iters: 400, epoch: 2 | loss: 0.8442747
	speed: 0.0025s/iter; left time: 16.0644s
	iters: 500, epoch: 2 | loss: 1.2469130
	speed: 0.0026s/iter; left time: 16.3057s
	iters: 600, epoch: 2 | loss: 0.4752974
	speed: 0.0025s/iter; left time: 15.4667s
	iters: 700, epoch: 2 | loss: 0.9325686
	speed: 0.0024s/iter; left time: 14.8369s
	iters: 800, epoch: 2 | loss: 0.6062087
	speed: 0.0024s/iter; left time: 14.4397s
	iters: 900, epoch: 2 | loss: 1.7443712
	speed: 0.0025s/iter; left time: 14.7146s
Updating learning rate to 5.3380031e-05
Validation loss decreased (0.6189 --> 0.6109).  Saving model state dict ...
Epoch: 2 cost time: 2.478549003601074
Epoch: 2, Steps: 979 | Train Loss: 0.9159287 Vali Loss: 0.6109292 Best vali loss: 0.6109292
	iters: 100, epoch: 3 | loss: 0.6253588
	speed: 0.0088s/iter; left time: 50.6202s
	iters: 200, epoch: 3 | loss: 1.0691148
	speed: 0.0025s/iter; left time: 14.3239s
	iters: 300, epoch: 3 | loss: 1.3987793
	speed: 0.0025s/iter; left time: 13.8502s
	iters: 400, epoch: 3 | loss: 0.8621809
	speed: 0.0025s/iter; left time: 13.5076s
	iters: 500, epoch: 3 | loss: 0.9585413
	speed: 0.0025s/iter; left time: 13.3460s
	iters: 600, epoch: 3 | loss: 1.1980391
	speed: 0.0025s/iter; left time: 13.0580s
	iters: 700, epoch: 3 | loss: 1.5580509
	speed: 0.0023s/iter; left time: 12.1212s
	iters: 800, epoch: 3 | loss: 1.6100820
	speed: 0.0023s/iter; left time: 11.5402s
	iters: 900, epoch: 3 | loss: 1.4284534
	speed: 0.0022s/iter; left time: 11.1782s
Updating learning rate to 2.66900155e-05
Validation loss decreased (0.6109 --> 0.6015).  Saving model state dict ...
Epoch: 3 cost time: 2.398817539215088
Epoch: 3, Steps: 979 | Train Loss: 1.1898445 Vali Loss: 0.6015135 Best vali loss: 0.6015135
	iters: 100, epoch: 4 | loss: 0.7828068
	speed: 0.0088s/iter; left time: 42.0011s
	iters: 200, epoch: 4 | loss: 0.9450573
	speed: 0.0025s/iter; left time: 11.9311s
	iters: 300, epoch: 4 | loss: 1.2198629
	speed: 0.0026s/iter; left time: 12.0283s
	iters: 400, epoch: 4 | loss: 1.0093516
	speed: 0.0026s/iter; left time: 11.8064s
	iters: 500, epoch: 4 | loss: 1.0804936
	speed: 0.0026s/iter; left time: 11.4565s
	iters: 600, epoch: 4 | loss: 1.4577552
	speed: 0.0026s/iter; left time: 11.2998s
	iters: 700, epoch: 4 | loss: 0.3382846
	speed: 0.0026s/iter; left time: 10.9407s
	iters: 800, epoch: 4 | loss: 0.8710646
	speed: 0.0026s/iter; left time: 10.7052s
	iters: 900, epoch: 4 | loss: 0.4487935
	speed: 0.0026s/iter; left time: 10.4060s
Updating learning rate to 1.334500775e-05
Epoch: 4 cost time: 2.566274881362915
Epoch: 4, Steps: 979 | Train Loss: 0.9059411 Vali Loss: 0.6028794 Best vali loss: 0.6015135
	iters: 100, epoch: 5 | loss: 0.9394313
	speed: 0.0086s/iter; left time: 32.7195s
	iters: 200, epoch: 5 | loss: 0.9978148
	speed: 0.0022s/iter; left time: 8.2012s
	iters: 300, epoch: 5 | loss: 1.8108073
	speed: 0.0023s/iter; left time: 8.4599s
	iters: 400, epoch: 5 | loss: 1.1966819
	speed: 0.0022s/iter; left time: 7.8842s
	iters: 500, epoch: 5 | loss: 1.5136949
	speed: 0.0022s/iter; left time: 7.5980s
	iters: 600, epoch: 5 | loss: 1.3282121
	speed: 0.0023s/iter; left time: 7.7471s
	iters: 700, epoch: 5 | loss: 0.9920700
	speed: 0.0022s/iter; left time: 7.2139s
	iters: 800, epoch: 5 | loss: 0.2901183
	speed: 0.0023s/iter; left time: 7.0713s
	iters: 900, epoch: 5 | loss: 0.6511769
	speed: 0.0022s/iter; left time: 6.7378s
Updating learning rate to 6.672503875e-06
Epoch: 5 cost time: 2.254655122756958
Epoch: 5, Steps: 979 | Train Loss: 1.0800008 Vali Loss: 0.6022543 Best vali loss: 0.6015135
	iters: 100, epoch: 6 | loss: 1.1011271
	speed: 0.0083s/iter; left time: 23.4337s
	iters: 200, epoch: 6 | loss: 0.4291925
	speed: 0.0023s/iter; left time: 6.3029s
	iters: 300, epoch: 6 | loss: 0.7705384
	speed: 0.0022s/iter; left time: 5.9160s
	iters: 400, epoch: 6 | loss: 0.7536843
	speed: 0.0023s/iter; left time: 5.8088s
	iters: 500, epoch: 6 | loss: 1.7752112
	speed: 0.0022s/iter; left time: 5.3883s
	iters: 600, epoch: 6 | loss: 1.7554934
	speed: 0.0023s/iter; left time: 5.3832s
	iters: 700, epoch: 6 | loss: 0.3479425
	speed: 0.0024s/iter; left time: 5.4046s
	iters: 800, epoch: 6 | loss: 0.7614356
	speed: 0.0022s/iter; left time: 4.6599s
	iters: 900, epoch: 6 | loss: 0.4166746
	speed: 0.0023s/iter; left time: 4.5954s
Updating learning rate to 3.3362519375e-06
Epoch: 6 cost time: 2.270822286605835
Epoch: 6, Steps: 979 | Train Loss: 0.9012555 Vali Loss: 0.6015552 Best vali loss: 0.6015135
	iters: 100, epoch: 7 | loss: 1.0895587
	speed: 0.0085s/iter; left time: 15.8404s
	iters: 200, epoch: 7 | loss: 0.3796906
	speed: 0.0023s/iter; left time: 4.0012s
	iters: 300, epoch: 7 | loss: 0.7155339
	speed: 0.0022s/iter; left time: 3.7308s
	iters: 400, epoch: 7 | loss: 2.2944901
	speed: 0.0023s/iter; left time: 3.5257s
	iters: 500, epoch: 7 | loss: 1.4456061
	speed: 0.0023s/iter; left time: 3.2835s
	iters: 600, epoch: 7 | loss: 0.7894424
	speed: 0.0023s/iter; left time: 3.0582s
	iters: 700, epoch: 7 | loss: 1.0878282
	speed: 0.0022s/iter; left time: 2.7472s
	iters: 800, epoch: 7 | loss: 1.4133552
	speed: 0.0022s/iter; left time: 2.6035s
	iters: 900, epoch: 7 | loss: 0.4978290
	speed: 0.0023s/iter; left time: 2.4626s
Updating learning rate to 1.66812596875e-06
Validation loss decreased (0.6015 --> 0.6015).  Saving model state dict ...
Epoch: 7 cost time: 2.255384922027588
Epoch: 7, Steps: 979 | Train Loss: 1.0792594 Vali Loss: 0.6015132 Best vali loss: 0.6015132
	iters: 100, epoch: 8 | loss: 0.5155820
	speed: 0.0084s/iter; left time: 7.3988s
	iters: 200, epoch: 8 | loss: 0.8866672
	speed: 0.0022s/iter; left time: 1.7499s
	iters: 300, epoch: 8 | loss: 0.5264478
	speed: 0.0023s/iter; left time: 1.5600s
	iters: 400, epoch: 8 | loss: 0.9468510
	speed: 0.0022s/iter; left time: 1.2742s
	iters: 500, epoch: 8 | loss: 0.7259263
	speed: 0.0022s/iter; left time: 1.0539s
	iters: 600, epoch: 8 | loss: 0.7251177
	speed: 0.0022s/iter; left time: 0.8284s
	iters: 700, epoch: 8 | loss: 1.3215902
	speed: 0.0022s/iter; left time: 0.6145s
	iters: 800, epoch: 8 | loss: 0.7042186
	speed: 0.0022s/iter; left time: 0.3928s
	iters: 900, epoch: 8 | loss: 0.3743524
	speed: 0.0022s/iter; left time: 0.1730s
Updating learning rate to 8.34062984375e-07
Validation loss decreased (0.6015 --> 0.6014).  Saving model state dict ...
Epoch: 8 cost time: 2.206874132156372
Epoch: 8, Steps: 979 | Train Loss: 0.7474170 Vali Loss: 0.6014216 Best vali loss: 0.6014216

best validation loss 0.6014215973503664

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010715793303, 'e_layers': 2, 'learning_rate': 0.0001906535911, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7626822
	speed: 0.0124s/iter; left time: 10.9554s
Updating learning rate to 0.000183397270858533
Validation loss decreased (inf --> 0.6089).  Saving model state dict ...
Epoch: 1 cost time: 1.0271365642547607
Epoch: 1, Steps: 123 | Train Loss: 0.7626822 Vali Loss: 0.6089301 Best vali loss: 0.6089301
	iters: 100, epoch: 2 | loss: 0.9307411
	speed: 0.0092s/iter; left time: 6.9729s
Updating learning rate to 0.00016273301911218859
Validation loss decreased (0.6089 --> 0.5636).  Saving model state dict ...
Epoch: 2 cost time: 0.7142384052276611
Epoch: 2, Steps: 123 | Train Loss: 0.9307411 Vali Loss: 0.5636117 Best vali loss: 0.5636117
	iters: 100, epoch: 3 | loss: 0.8557152
	speed: 0.0094s/iter; left time: 6.0206s
Updating learning rate to 0.00013180678086743917
Validation loss decreased (0.5636 --> 0.5558).  Saving model state dict ...
Epoch: 3 cost time: 0.7193365097045898
Epoch: 3, Steps: 123 | Train Loss: 0.8557152 Vali Loss: 0.5557574 Best vali loss: 0.5557574

best validation loss 0.5557574094969164

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0068317105002, 'e_layers': 2, 'learning_rate': 0.0044094389851, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0483528
	speed: 0.0100s/iter; left time: 38.3503s
	iters: 200, epoch: 1 | loss: 1.0847548
	speed: 0.0034s/iter; left time: 12.5777s
	iters: 300, epoch: 1 | loss: 0.8804978
	speed: 0.0034s/iter; left time: 12.3426s
	iters: 400, epoch: 1 | loss: 0.9939056
	speed: 0.0034s/iter; left time: 11.9064s
Updating learning rate to 0.0044094389851
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 2.004502296447754
Epoch: 1, Steps: 490 | Train Loss: 1.0018778 Vali Loss: 0.6112126 Best vali loss: 0.6112126
	iters: 100, epoch: 2 | loss: 1.0168554
	speed: 0.0095s/iter; left time: 31.5402s
	iters: 200, epoch: 2 | loss: 1.2282041
	speed: 0.0031s/iter; left time: 10.1244s
	iters: 300, epoch: 2 | loss: 1.0028046
	speed: 0.0031s/iter; left time: 9.7156s
	iters: 400, epoch: 2 | loss: 0.4757445
	speed: 0.0031s/iter; left time: 9.4805s
Updating learning rate to 0.00220471949255
Epoch: 2 cost time: 1.5764062404632568
Epoch: 2, Steps: 490 | Train Loss: 0.9309022 Vali Loss: 0.6481550 Best vali loss: 0.6112126
	iters: 100, epoch: 3 | loss: 0.7197255
	speed: 0.0093s/iter; left time: 26.4352s
	iters: 200, epoch: 3 | loss: 0.8589911
	speed: 0.0032s/iter; left time: 8.6775s
	iters: 300, epoch: 3 | loss: 0.5044038
	speed: 0.0032s/iter; left time: 8.3773s
	iters: 400, epoch: 3 | loss: 1.3160399
	speed: 0.0031s/iter; left time: 7.9073s
Updating learning rate to 0.001102359746275
Epoch: 3 cost time: 1.5876147747039795
Epoch: 3, Steps: 490 | Train Loss: 0.8497901 Vali Loss: 0.6470421 Best vali loss: 0.6112126

best validation loss 0.6112125738524331

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010867793309, 'e_layers': 2, 'learning_rate': 0.0001914661655, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7626027
	speed: 0.0123s/iter; left time: 10.8534s
Updating learning rate to 0.0001841789184869343
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 1.034162998199463
Epoch: 1, Steps: 123 | Train Loss: 0.7626027 Vali Loss: 0.6089580 Best vali loss: 0.6089580
	iters: 100, epoch: 2 | loss: 0.9275742
	speed: 0.0091s/iter; left time: 6.9346s
Updating learning rate to 0.00016342659474641788
Validation loss decreased (0.6090 --> 0.5509).  Saving model state dict ...
Epoch: 2 cost time: 0.7209265232086182
Epoch: 2, Steps: 123 | Train Loss: 0.9275742 Vali Loss: 0.5509064 Best vali loss: 0.5509064
	iters: 100, epoch: 3 | loss: 0.8525943
	speed: 0.0094s/iter; left time: 5.9820s
Updating learning rate to 0.00013236854744766115
Epoch: 3 cost time: 0.7274627685546875
Epoch: 3, Steps: 123 | Train Loss: 0.8525943 Vali Loss: 0.5562140 Best vali loss: 0.5509064

best validation loss 0.5509063610871706

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010867793309, 'e_layers': 2, 'learning_rate': 0.0001914661655, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5983565
	speed: 0.0127s/iter; left time: 6.5443s
Updating learning rate to 9.573308275e-05
Validation loss decreased (0.5509 --> 0.5347).  Saving model state dict ...
Epoch: 4 cost time: 1.0379092693328857
Epoch: 4, Steps: 123 | Train Loss: 0.5983565 Vali Loss: 0.5347278 Best vali loss: 0.5347278
	iters: 100, epoch: 5 | loss: 0.8473758
	speed: 0.0092s/iter; left time: 3.6349s
Updating learning rate to 5.9097618052338834e-05
Validation loss decreased (0.5347 --> 0.5333).  Saving model state dict ...
Epoch: 5 cost time: 0.7178657054901123
Epoch: 5, Steps: 123 | Train Loss: 0.8473758 Vali Loss: 0.5333387 Best vali loss: 0.5333387
	iters: 100, epoch: 6 | loss: 0.7992266
	speed: 0.0092s/iter; left time: 2.4763s
Updating learning rate to 2.8039570753582106e-05
Epoch: 6 cost time: 0.7148594856262207
Epoch: 6, Steps: 123 | Train Loss: 0.7992266 Vali Loss: 0.5351896 Best vali loss: 0.5333387
	iters: 100, epoch: 7 | loss: 0.4794179
	speed: 0.0089s/iter; left time: 1.3153s
Updating learning rate to 7.287247013065671e-06
Epoch: 7 cost time: 0.714834451675415
Epoch: 7, Steps: 123 | Train Loss: 0.4794179 Vali Loss: 0.5336952 Best vali loss: 0.5333387
	iters: 100, epoch: 8 | loss: 0.5463104
	speed: 0.0092s/iter; left time: 0.2197s
Updating learning rate to 0.0
Validation loss decreased (0.5333 --> 0.5292).  Saving model state dict ...
Epoch: 8 cost time: 0.7247159481048584
Epoch: 8, Steps: 123 | Train Loss: 0.5463104 Vali Loss: 0.5292244 Best vali loss: 0.5292244

best validation loss 0.5292244421172506

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010757653858, 'e_layers': 2, 'learning_rate': 0.0001932994346, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7629496
	speed: 0.0121s/iter; left time: 10.7480s
Updating learning rate to 0.00018594241293647202
Validation loss decreased (inf --> 0.6092).  Saving model state dict ...
Epoch: 1 cost time: 1.0264248847961426
Epoch: 1, Steps: 123 | Train Loss: 0.7629496 Vali Loss: 0.6091722 Best vali loss: 0.6091722
	iters: 100, epoch: 2 | loss: 0.9293820
	speed: 0.0091s/iter; left time: 6.9582s
Updating learning rate to 0.00016499138780259277
Validation loss decreased (0.6092 --> 0.5559).  Saving model state dict ...
Epoch: 2 cost time: 0.7154836654663086
Epoch: 2, Steps: 123 | Train Loss: 0.9293820 Vali Loss: 0.5558735 Best vali loss: 0.5558735
	iters: 100, epoch: 3 | loss: 0.8503526
	speed: 0.0092s/iter; left time: 5.8802s
Updating learning rate to 0.0001336359628534796
Validation loss decreased (0.5559 --> 0.5501).  Saving model state dict ...
Epoch: 3 cost time: 0.7144498825073242
Epoch: 3, Steps: 123 | Train Loss: 0.8503526 Vali Loss: 0.5500844 Best vali loss: 0.5500844
	iters: 100, epoch: 4 | loss: 0.4946861
	speed: 0.0092s/iter; left time: 4.7360s
Updating learning rate to 9.66497173e-05
Epoch: 4 cost time: 0.7153675556182861
Epoch: 4, Steps: 123 | Train Loss: 0.4946861 Vali Loss: 0.5520082 Best vali loss: 0.5500844
	iters: 100, epoch: 5 | loss: 0.5743430
	speed: 0.0088s/iter; left time: 3.4654s
Updating learning rate to 5.966347174652041e-05
Validation loss decreased (0.5501 --> 0.5331).  Saving model state dict ...
Epoch: 5 cost time: 0.7070543766021729
Epoch: 5, Steps: 123 | Train Loss: 0.5743430 Vali Loss: 0.5330766 Best vali loss: 0.5330766
	iters: 100, epoch: 6 | loss: 0.6171809
	speed: 0.0091s/iter; left time: 2.4566s
Updating learning rate to 2.8308046797407228e-05
Epoch: 6 cost time: 0.7109811305999756
Epoch: 6, Steps: 123 | Train Loss: 0.6171809 Vali Loss: 0.5338738 Best vali loss: 0.5330766
	iters: 100, epoch: 7 | loss: 0.5714060
	speed: 0.0089s/iter; left time: 1.3069s
Updating learning rate to 7.357021663527977e-06
Validation loss decreased (0.5331 --> 0.5291).  Saving model state dict ...
Epoch: 7 cost time: 0.7138082981109619
Epoch: 7, Steps: 123 | Train Loss: 0.5714060 Vali Loss: 0.5290749 Best vali loss: 0.5290749
	iters: 100, epoch: 8 | loss: 0.7385715
	speed: 0.0094s/iter; left time: 0.2254s
Updating learning rate to 0.0
Validation loss decreased (0.5291 --> 0.5280).  Saving model state dict ...
Epoch: 8 cost time: 0.7231652736663818
Epoch: 8, Steps: 123 | Train Loss: 0.7385715 Vali Loss: 0.5280321 Best vali loss: 0.5280321

best validation loss 0.528032068795818

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 4, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7512142
	speed: 0.0167s/iter; left time: 14.7852s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 1.573782205581665
Epoch: 1, Steps: 123 | Train Loss: 0.7512142 Vali Loss: 0.6093965 Best vali loss: 0.6093965
	iters: 100, epoch: 2 | loss: 1.0231225
	speed: 0.0153s/iter; left time: 11.6827s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6094 --> 0.5788).  Saving model state dict ...
Epoch: 2 cost time: 1.2758381366729736
Epoch: 2, Steps: 123 | Train Loss: 1.0231225 Vali Loss: 0.5788051 Best vali loss: 0.5788051
	iters: 100, epoch: 3 | loss: 0.7618738
	speed: 0.0155s/iter; left time: 9.9074s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5788 --> 0.5448).  Saving model state dict ...
Epoch: 3 cost time: 1.2715792655944824
Epoch: 3, Steps: 123 | Train Loss: 0.7618738 Vali Loss: 0.5447857 Best vali loss: 0.5447857
	iters: 100, epoch: 4 | loss: 0.5731004
	speed: 0.0156s/iter; left time: 8.0541s
Updating learning rate to 0.0001489167575
Epoch: 4 cost time: 1.2844336032867432
Epoch: 4, Steps: 123 | Train Loss: 0.5731004 Vali Loss: 0.5522189 Best vali loss: 0.5447857
	iters: 100, epoch: 5 | loss: 0.6099455
	speed: 0.0149s/iter; left time: 5.8717s
Updating learning rate to 9.192878160322029e-05
Epoch: 5 cost time: 1.2705459594726562
Epoch: 5, Steps: 123 | Train Loss: 0.6099455 Vali Loss: 0.5475596 Best vali loss: 0.5447857
	iters: 100, epoch: 6 | loss: 0.6632065
	speed: 0.0150s/iter; left time: 4.0532s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 1.2785146236419678
Epoch: 6, Steps: 123 | Train Loss: 0.6632065 Vali Loss: 0.5628502 Best vali loss: 0.5447857
	iters: 100, epoch: 7 | loss: 0.6350339
	speed: 0.0149s/iter; left time: 2.1912s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 1.26983642578125
Epoch: 7, Steps: 123 | Train Loss: 0.6350339 Vali Loss: 0.5788074 Best vali loss: 0.5447857
	iters: 100, epoch: 8 | loss: 0.5743862
	speed: 0.0149s/iter; left time: 0.3581s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2659544944763184
Epoch: 8, Steps: 123 | Train Loss: 0.5743862 Vali Loss: 0.5921567 Best vali loss: 0.5447857

best validation loss 0.5447856918742733

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0003033589061, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7747883
	speed: 0.0119s/iter; left time: 10.5031s
Updating learning rate to 0.0002918129952254017
Validation loss decreased (inf --> 0.6177).  Saving model state dict ...
Epoch: 1 cost time: 1.0368573665618896
Epoch: 1, Steps: 123 | Train Loss: 0.7747883 Vali Loss: 0.6177500 Best vali loss: 0.6177500
	iters: 100, epoch: 2 | loss: 0.9541159
	speed: 0.0094s/iter; left time: 7.1595s
Updating learning rate to 0.00025893302286832153
Validation loss decreased (0.6177 --> 0.5634).  Saving model state dict ...
Epoch: 2 cost time: 0.7328455448150635
Epoch: 2, Steps: 123 | Train Loss: 0.9541159 Vali Loss: 0.5633558 Best vali loss: 0.5633558
	iters: 100, epoch: 3 | loss: 0.8451710
	speed: 0.0096s/iter; left time: 6.1390s
Updating learning rate to 0.0002097246667624335
Validation loss decreased (0.5634 --> 0.5511).  Saving model state dict ...
Epoch: 3 cost time: 0.7336182594299316
Epoch: 3, Steps: 123 | Train Loss: 0.8451710 Vali Loss: 0.5510702 Best vali loss: 0.5510702

best validation loss 0.5510701526099474

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002992128684, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744260
	speed: 0.0117s/iter; left time: 10.3741s
Updating learning rate to 0.0002878247566893766
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0212435722351074
Epoch: 1, Steps: 123 | Train Loss: 0.7744260 Vali Loss: 0.6170805 Best vali loss: 0.6170805
	iters: 100, epoch: 2 | loss: 0.9505968
	speed: 0.0092s/iter; left time: 7.0237s
Updating learning rate to 0.000255394158331959
Validation loss decreased (0.6171 --> 0.5627).  Saving model state dict ...
Epoch: 2 cost time: 0.7263281345367432
Epoch: 2, Steps: 123 | Train Loss: 0.9505968 Vali Loss: 0.5627275 Best vali loss: 0.5627275
	iters: 100, epoch: 3 | loss: 0.8469257
	speed: 0.0093s/iter; left time: 5.9485s
Updating learning rate to 0.00020685833794355796
Validation loss decreased (0.5627 --> 0.5512).  Saving model state dict ...
Epoch: 3 cost time: 0.720705509185791
Epoch: 3, Steps: 123 | Train Loss: 0.8469257 Vali Loss: 0.5512135 Best vali loss: 0.5512135

best validation loss 0.5512135079038303

[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0003118060106, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7755401
	speed: 0.0116s/iter; left time: 10.2733s
Updating learning rate to 0.0002999386009536687
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 1.023482084274292
Epoch: 1, Steps: 123 | Train Loss: 0.7755401 Vali Loss: 0.6183893 Best vali loss: 0.6183893
	iters: 100, epoch: 2 | loss: 0.9473771
	speed: 0.0092s/iter; left time: 7.0320s
Updating learning rate to 0.00026614307755499226
Validation loss decreased (0.6184 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 0.7240025997161865
Epoch: 2, Steps: 123 | Train Loss: 0.9473771 Vali Loss: 0.6037805 Best vali loss: 0.6037805
	iters: 100, epoch: 3 | loss: 0.8623820
	speed: 0.0093s/iter; left time: 5.9237s
Updating learning rate to 0.0002155645024842368
Validation loss decreased (0.6038 --> 0.5470).  Saving model state dict ...
Epoch: 3 cost time: 0.7279818058013916
Epoch: 3, Steps: 123 | Train Loss: 0.8623820 Vali Loss: 0.5469728 Best vali loss: 0.5469728

best validation loss 0.5469728010719102

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0003118060106, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5878729
	speed: 0.0120s/iter; left time: 6.2160s
Updating learning rate to 0.0001559030053
Validation loss decreased (0.5470 --> 0.5340).  Saving model state dict ...
Epoch: 4 cost time: 1.0294091701507568
Epoch: 4, Steps: 123 | Train Loss: 0.5878729 Vali Loss: 0.5340366 Best vali loss: 0.5340366
	iters: 100, epoch: 5 | loss: 0.8236111
	speed: 0.0094s/iter; left time: 3.6813s
Updating learning rate to 9.624150811576323e-05
Validation loss decreased (0.5340 --> 0.5326).  Saving model state dict ...
Epoch: 5 cost time: 0.7250361442565918
Epoch: 5, Steps: 123 | Train Loss: 0.8236111 Vali Loss: 0.5326322 Best vali loss: 0.5326322
	iters: 100, epoch: 6 | loss: 0.7626901
	speed: 0.0093s/iter; left time: 2.5147s
Updating learning rate to 4.5662933045007756e-05
Epoch: 6 cost time: 0.7230527400970459
Epoch: 6, Steps: 123 | Train Loss: 0.7626901 Vali Loss: 0.5355390 Best vali loss: 0.5326322
	iters: 100, epoch: 7 | loss: 0.4412108
	speed: 0.0090s/iter; left time: 1.3170s
Updating learning rate to 1.1867409646331342e-05
Epoch: 7 cost time: 0.7241899967193604
Epoch: 7, Steps: 123 | Train Loss: 0.4412108 Vali Loss: 0.5371789 Best vali loss: 0.5326322
	iters: 100, epoch: 8 | loss: 0.5082014
	speed: 0.0091s/iter; left time: 0.2176s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7141625881195068
Epoch: 8, Steps: 123 | Train Loss: 0.5082014 Vali Loss: 0.5429356 Best vali loss: 0.5326322

best validation loss 0.5326321822578628

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472163264, 'e_layers': 3, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6184639
	speed: 0.0139s/iter; left time: 12.3146s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 1.2920551300048828
Epoch: 1, Steps: 123 | Train Loss: 0.6184639 Vali Loss: 0.6157392 Best vali loss: 0.6157392
	iters: 100, epoch: 2 | loss: 0.7488043
	speed: 0.0122s/iter; left time: 9.3103s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6157 --> 0.6109).  Saving model state dict ...
Epoch: 2 cost time: 0.9938592910766602
Epoch: 2, Steps: 123 | Train Loss: 0.7488043 Vali Loss: 0.6109383 Best vali loss: 0.6109383
	iters: 100, epoch: 3 | loss: 0.6335329
	speed: 0.0124s/iter; left time: 7.9387s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.6109 --> 0.5667).  Saving model state dict ...
Epoch: 3 cost time: 1.0046849250793457
Epoch: 3, Steps: 123 | Train Loss: 0.6335329 Vali Loss: 0.5667337 Best vali loss: 0.5667337
	iters: 100, epoch: 4 | loss: 0.8636672
	speed: 0.0126s/iter; left time: 6.5062s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5667 --> 0.5405).  Saving model state dict ...
Epoch: 4 cost time: 1.0008513927459717
Epoch: 4, Steps: 123 | Train Loss: 0.8636672 Vali Loss: 0.5404645 Best vali loss: 0.5404645
	iters: 100, epoch: 5 | loss: 0.6719505
	speed: 0.0123s/iter; left time: 4.8315s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5405 --> 0.5340).  Saving model state dict ...
Epoch: 5 cost time: 0.9936721324920654
Epoch: 5, Steps: 123 | Train Loss: 0.6719505 Vali Loss: 0.5340179 Best vali loss: 0.5340179
	iters: 100, epoch: 6 | loss: 0.4314112
	speed: 0.0125s/iter; left time: 3.3818s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 1.0053410530090332
Epoch: 6, Steps: 123 | Train Loss: 0.4314112 Vali Loss: 0.5366447 Best vali loss: 0.5340179
	iters: 100, epoch: 7 | loss: 0.7783071
	speed: 0.0121s/iter; left time: 1.7844s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 1.011756181716919
Epoch: 7, Steps: 123 | Train Loss: 0.7783071 Vali Loss: 0.5372420 Best vali loss: 0.5340179
	iters: 100, epoch: 8 | loss: 0.6703360
	speed: 0.0123s/iter; left time: 0.2959s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0090041160583496
Epoch: 8, Steps: 123 | Train Loss: 0.6703360 Vali Loss: 0.5349669 Best vali loss: 0.5340179

best validation loss 0.5340178736323066

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.001737848117, 'e_layers': 3, 'learning_rate': 0.0022825435795, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2220007
	speed: 0.0112s/iter; left time: 20.8199s
	iters: 200, epoch: 1 | loss: 0.8612821
	speed: 0.0052s/iter; left time: 9.1273s
Updating learning rate to 0.0022825435795
Validation loss decreased (inf --> 0.6308).  Saving model state dict ...
Epoch: 1 cost time: 1.604227066040039
Epoch: 1, Steps: 245 | Train Loss: 1.0416414 Vali Loss: 0.6307547 Best vali loss: 0.6307547
	iters: 100, epoch: 2 | loss: 0.7507143
	speed: 0.0106s/iter; left time: 17.1358s
	iters: 200, epoch: 2 | loss: 0.8108120
	speed: 0.0051s/iter; left time: 7.7937s
Updating learning rate to 0.00114127178975
Epoch: 2 cost time: 1.3198680877685547
Epoch: 2, Steps: 245 | Train Loss: 0.7807631 Vali Loss: 0.6400302 Best vali loss: 0.6307547
	iters: 100, epoch: 3 | loss: 0.7953128
	speed: 0.0104s/iter; left time: 14.2035s
	iters: 200, epoch: 3 | loss: 0.7643383
	speed: 0.0052s/iter; left time: 6.6068s
Updating learning rate to 0.000570635894875
Epoch: 3 cost time: 1.3164405822753906
Epoch: 3, Steps: 245 | Train Loss: 0.7798256 Vali Loss: 0.6540001 Best vali loss: 0.6307547
	iters: 100, epoch: 4 | loss: 0.7784194
	speed: 0.0103s/iter; left time: 11.6300s
	iters: 200, epoch: 4 | loss: 0.7763066
	speed: 0.0051s/iter; left time: 5.2241s
Updating learning rate to 0.0002853179474375
Epoch: 4 cost time: 1.300081729888916
Epoch: 4, Steps: 245 | Train Loss: 0.7773630 Vali Loss: 0.6419276 Best vali loss: 0.6307547
	iters: 100, epoch: 5 | loss: 0.6739933
	speed: 0.0103s/iter; left time: 9.0943s
	iters: 200, epoch: 5 | loss: 0.7216607
	speed: 0.0050s/iter; left time: 3.9341s
Updating learning rate to 0.00014265897371875
Epoch: 5 cost time: 1.2898118495941162
Epoch: 5, Steps: 245 | Train Loss: 0.6978270 Vali Loss: 0.6341830 Best vali loss: 0.6307547
	iters: 100, epoch: 6 | loss: 0.8117657
	speed: 0.0103s/iter; left time: 6.5824s
	iters: 200, epoch: 6 | loss: 0.7740001
	speed: 0.0051s/iter; left time: 2.7430s
Updating learning rate to 7.1329486859375e-05
Epoch: 6 cost time: 1.3050930500030518
Epoch: 6, Steps: 245 | Train Loss: 0.7928829 Vali Loss: 0.6323509 Best vali loss: 0.6307547
	iters: 100, epoch: 7 | loss: 0.8954077
	speed: 0.0104s/iter; left time: 4.0575s
	iters: 200, epoch: 7 | loss: 0.8030213
	speed: 0.0051s/iter; left time: 1.4920s
Updating learning rate to 3.56647434296875e-05
Validation loss decreased (0.6308 --> 0.6265).  Saving model state dict ...
Epoch: 7 cost time: 1.2996721267700195
Epoch: 7, Steps: 245 | Train Loss: 0.8492145 Vali Loss: 0.6264910 Best vali loss: 0.6264910
	iters: 100, epoch: 8 | loss: 0.5549206
	speed: 0.0108s/iter; left time: 1.5797s
	iters: 200, epoch: 8 | loss: 0.5808243
	speed: 0.0051s/iter; left time: 0.2335s
Updating learning rate to 1.783237171484375e-05
Validation loss decreased (0.6265 --> 0.6264).  Saving model state dict ...
Epoch: 8 cost time: 1.3012971878051758
Epoch: 8, Steps: 245 | Train Loss: 0.5678724 Vali Loss: 0.6263938 Best vali loss: 0.6263938

best validation loss 0.6263937751681978

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010639632501, 'e_layers': 2, 'learning_rate': 0.0001084536077, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7510177
	speed: 0.0117s/iter; left time: 10.3837s
Updating learning rate to 0.00010432583804051924
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 1.0207068920135498
Epoch: 1, Steps: 123 | Train Loss: 0.7510177 Vali Loss: 0.6018780 Best vali loss: 0.6018780
	iters: 100, epoch: 2 | loss: 0.9473248
	speed: 0.0092s/iter; left time: 7.0397s
Updating learning rate to 9.257094457440778e-05
Epoch: 2 cost time: 0.7261664867401123
Epoch: 2, Steps: 123 | Train Loss: 0.9473248 Vali Loss: 0.6042134 Best vali loss: 0.6018780
	iters: 100, epoch: 3 | loss: 0.8769922
	speed: 0.0091s/iter; left time: 5.8073s
Updating learning rate to 7.497850327350646e-05
Epoch: 3 cost time: 0.730518102645874
Epoch: 3, Steps: 123 | Train Loss: 0.8769922 Vali Loss: 0.6061713 Best vali loss: 0.6018780

best validation loss 0.6018779908601248

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7174107
	speed: 0.0118s/iter; left time: 10.4619s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6209).  Saving model state dict ...
Epoch: 1 cost time: 1.0329992771148682
Epoch: 1, Steps: 123 | Train Loss: 0.7174107 Vali Loss: 0.6208641 Best vali loss: 0.6208641
	iters: 100, epoch: 2 | loss: 0.8483258
	speed: 0.0092s/iter; left time: 7.0131s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6209 --> 0.5549).  Saving model state dict ...
Epoch: 2 cost time: 0.7260441780090332
Epoch: 2, Steps: 123 | Train Loss: 0.8483258 Vali Loss: 0.5548966 Best vali loss: 0.5548966
	iters: 100, epoch: 3 | loss: 0.9526643
	speed: 0.0093s/iter; left time: 5.9715s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5549 --> 0.5423).  Saving model state dict ...
Epoch: 3 cost time: 0.7350711822509766
Epoch: 3, Steps: 123 | Train Loss: 0.9526643 Vali Loss: 0.5422631 Best vali loss: 0.5422631

best validation loss 0.5422631015605477

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 3, 'learning_rate': 0.0001754498296, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5205830
	speed: 0.0120s/iter; left time: 22.3977s
	iters: 200, epoch: 1 | loss: 0.6132658
	speed: 0.0057s/iter; left time: 10.0713s
Updating learning rate to 0.00016877216807501645
Validation loss decreased (inf --> 0.6001).  Saving model state dict ...
Epoch: 1 cost time: 1.7617120742797852
Epoch: 1, Steps: 245 | Train Loss: 0.5669244 Vali Loss: 0.6000627 Best vali loss: 0.6000627
	iters: 100, epoch: 2 | loss: 0.6813738
	speed: 0.0115s/iter; left time: 18.6588s
	iters: 200, epoch: 2 | loss: 0.9311126
	speed: 0.0056s/iter; left time: 8.5440s
Updating learning rate to 0.0001497557969340921
Validation loss decreased (0.6001 --> 0.5582).  Saving model state dict ...
Epoch: 2 cost time: 1.4278059005737305
Epoch: 2, Steps: 245 | Train Loss: 0.8062432 Vali Loss: 0.5581847 Best vali loss: 0.5581847
	iters: 100, epoch: 3 | loss: 0.8051733
	speed: 0.0117s/iter; left time: 16.0810s
	iters: 200, epoch: 3 | loss: 0.6381224
	speed: 0.0057s/iter; left time: 7.2107s
Updating learning rate to 0.00012129578629959906
Epoch: 3 cost time: 1.4388344287872314
Epoch: 3, Steps: 245 | Train Loss: 0.7216479 Vali Loss: 0.5624338 Best vali loss: 0.5581847

best validation loss 0.5581847285849251

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6190435
	speed: 0.0121s/iter; left time: 6.2558s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 1.0413575172424316
Epoch: 4, Steps: 123 | Train Loss: 0.6190435 Vali Loss: 0.5431276 Best vali loss: 0.5422631
	iters: 100, epoch: 5 | loss: 0.7483894
	speed: 0.0090s/iter; left time: 3.5513s
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 0.7261242866516113
Epoch: 5, Steps: 123 | Train Loss: 0.7483894 Vali Loss: 0.5525700 Best vali loss: 0.5422631
	iters: 100, epoch: 6 | loss: 0.8483019
	speed: 0.0091s/iter; left time: 2.4482s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7260570526123047
Epoch: 6, Steps: 123 | Train Loss: 0.8483019 Vali Loss: 0.5479087 Best vali loss: 0.5422631
	iters: 100, epoch: 7 | loss: 0.5065585
	speed: 0.0091s/iter; left time: 1.3414s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7226853370666504
Epoch: 7, Steps: 123 | Train Loss: 0.5065585 Vali Loss: 0.5571042 Best vali loss: 0.5422631
	iters: 100, epoch: 8 | loss: 0.6730279
	speed: 0.0092s/iter; left time: 0.2213s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7423992156982422
Epoch: 8, Steps: 123 | Train Loss: 0.6730279 Vali Loss: 0.5581395 Best vali loss: 0.5422631

best validation loss 0.5422631015605477

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0099664009457, 'e_layers': 2, 'learning_rate': 0.0020534115208, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4251496
	speed: 0.0099s/iter; left time: 18.4877s
	iters: 200, epoch: 1 | loss: 0.7906968
	speed: 0.0038s/iter; left time: 6.7120s
Updating learning rate to 0.0019752581983449972
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 1.2846143245697021
Epoch: 1, Steps: 245 | Train Loss: 0.6079232 Vali Loss: 0.6111763 Best vali loss: 0.6111763
	iters: 100, epoch: 2 | loss: 0.6644425
	speed: 0.0080s/iter; left time: 12.9060s
	iters: 200, epoch: 2 | loss: 0.7931412
	speed: 0.0037s/iter; left time: 5.6652s
Updating learning rate to 0.0017526963658621307
Epoch: 2 cost time: 0.9850351810455322
Epoch: 2, Steps: 245 | Train Loss: 0.7287919 Vali Loss: 0.6120327 Best vali loss: 0.6111763
	iters: 100, epoch: 3 | loss: 0.8296626
	speed: 0.0081s/iter; left time: 11.0538s
	iters: 200, epoch: 3 | loss: 0.8066469
	speed: 0.0038s/iter; left time: 4.8379s
Updating learning rate to 0.0014196090448188815
Validation loss decreased (0.6112 --> 0.6041).  Saving model state dict ...
Epoch: 3 cost time: 0.9725990295410156
Epoch: 3, Steps: 245 | Train Loss: 0.8181548 Vali Loss: 0.6041426 Best vali loss: 0.6041426
	iters: 100, epoch: 4 | loss: 0.8118203
	speed: 0.0082s/iter; left time: 9.2777s
	iters: 200, epoch: 4 | loss: 0.7024716
	speed: 0.0040s/iter; left time: 4.0967s
Updating learning rate to 0.0010267057604
Epoch: 4 cost time: 1.0245678424835205
Epoch: 4, Steps: 245 | Train Loss: 0.7571459 Vali Loss: 0.6510118 Best vali loss: 0.6041426
	iters: 100, epoch: 5 | loss: 0.8289272
	speed: 0.0080s/iter; left time: 7.0713s
	iters: 200, epoch: 5 | loss: 0.9078799
	speed: 0.0038s/iter; left time: 3.0009s
Updating learning rate to 0.0006338024759811186
Epoch: 5 cost time: 0.99153733253479
Epoch: 5, Steps: 245 | Train Loss: 0.8684036 Vali Loss: 0.6629745 Best vali loss: 0.6041426
	iters: 100, epoch: 6 | loss: 0.6349037
	speed: 0.0081s/iter; left time: 5.1292s
	iters: 200, epoch: 6 | loss: 0.8007399
	speed: 0.0039s/iter; left time: 2.0702s
Updating learning rate to 0.0003007151549378694
Epoch: 6 cost time: 0.9941585063934326
Epoch: 6, Steps: 245 | Train Loss: 0.7178218 Vali Loss: 0.6525568 Best vali loss: 0.6041426
	iters: 100, epoch: 7 | loss: 0.9617339
	speed: 0.0081s/iter; left time: 3.1783s
	iters: 200, epoch: 7 | loss: 0.5640659
	speed: 0.0039s/iter; left time: 1.1347s
Updating learning rate to 7.815332245500283e-05
Epoch: 7 cost time: 1.0039665699005127
Epoch: 7, Steps: 245 | Train Loss: 0.7628999 Vali Loss: 0.6547959 Best vali loss: 0.6041426
	iters: 100, epoch: 8 | loss: 0.4614362
	speed: 0.0079s/iter; left time: 1.1579s
	iters: 200, epoch: 8 | loss: 0.7887530
	speed: 0.0038s/iter; left time: 0.1741s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9760558605194092
Epoch: 8, Steps: 245 | Train Loss: 0.6250946 Vali Loss: 0.6589869 Best vali loss: 0.6041426

best validation loss 0.6041425959427342

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0054281751581, 'e_layers': 4, 'learning_rate': 0.0002338137051, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3802940
	speed: 0.0113s/iter; left time: 43.2380s
	iters: 200, epoch: 1 | loss: 0.7422318
	speed: 0.0048s/iter; left time: 17.8896s
	iters: 300, epoch: 1 | loss: 0.8020041
	speed: 0.0048s/iter; left time: 17.5266s
	iters: 400, epoch: 1 | loss: 0.7988151
	speed: 0.0049s/iter; left time: 17.2306s
Updating learning rate to 0.00022491470083125994
Validation loss decreased (inf --> 0.5936).  Saving model state dict ...
Epoch: 1 cost time: 2.7882332801818848
Epoch: 1, Steps: 490 | Train Loss: 0.9308363 Vali Loss: 0.5935909 Best vali loss: 0.5935909
	iters: 100, epoch: 2 | loss: 1.1342431
	speed: 0.0144s/iter; left time: 48.0156s
	iters: 200, epoch: 2 | loss: 0.5298163
	speed: 0.0055s/iter; left time: 17.7941s
	iters: 300, epoch: 2 | loss: 0.6282381
	speed: 0.0055s/iter; left time: 17.1356s
	iters: 400, epoch: 2 | loss: 0.8866723
	speed: 0.0051s/iter; left time: 15.5847s
Updating learning rate to 0.00019957248075528082
Epoch: 2 cost time: 2.626241683959961
Epoch: 2, Steps: 490 | Train Loss: 0.7947425 Vali Loss: 0.6214959 Best vali loss: 0.5935909
	iters: 100, epoch: 3 | loss: 0.5522331
	speed: 0.0129s/iter; left time: 36.6268s
	iters: 200, epoch: 3 | loss: 0.4012220
	speed: 0.0045s/iter; left time: 12.3533s
	iters: 300, epoch: 3 | loss: 0.6007175
	speed: 0.0045s/iter; left time: 11.9575s
	iters: 400, epoch: 3 | loss: 0.7941568
	speed: 0.0049s/iter; left time: 12.4320s
Updating learning rate to 0.00016164516815083346
Validation loss decreased (0.5936 --> 0.5873).  Saving model state dict ...
Epoch: 3 cost time: 2.3551740646362305
Epoch: 3, Steps: 490 | Train Loss: 0.5870824 Vali Loss: 0.5873393 Best vali loss: 0.5873393
	iters: 100, epoch: 4 | loss: 0.7760577
	speed: 0.0133s/iter; left time: 31.1533s
	iters: 200, epoch: 4 | loss: 0.9583630
	speed: 0.0045s/iter; left time: 10.1563s
	iters: 300, epoch: 4 | loss: 0.6142871
	speed: 0.0048s/iter; left time: 10.2880s
	iters: 400, epoch: 4 | loss: 0.5354514
	speed: 0.0046s/iter; left time: 9.5067s
Updating learning rate to 0.00011690685255
Validation loss decreased (0.5873 --> 0.5845).  Saving model state dict ...
Epoch: 4 cost time: 2.31516170501709
Epoch: 4, Steps: 490 | Train Loss: 0.7210398 Vali Loss: 0.5844782 Best vali loss: 0.5844782
	iters: 100, epoch: 5 | loss: 0.6812515
	speed: 0.0130s/iter; left time: 24.1248s
	iters: 200, epoch: 5 | loss: 0.7131308
	speed: 0.0047s/iter; left time: 8.2420s
	iters: 300, epoch: 5 | loss: 0.2610318
	speed: 0.0045s/iter; left time: 7.5388s
	iters: 400, epoch: 5 | loss: 0.8853205
	speed: 0.0049s/iter; left time: 7.6465s
Updating learning rate to 7.216853694916656e-05
Epoch: 5 cost time: 2.3837504386901855
Epoch: 5, Steps: 490 | Train Loss: 0.6351837 Vali Loss: 0.6061329 Best vali loss: 0.5844782
	iters: 100, epoch: 6 | loss: 0.6491809
	speed: 0.0135s/iter; left time: 18.4424s
	iters: 200, epoch: 6 | loss: 0.2980269
	speed: 0.0052s/iter; left time: 6.6574s
	iters: 300, epoch: 6 | loss: 0.3836366
	speed: 0.0054s/iter; left time: 6.3176s
	iters: 400, epoch: 6 | loss: 0.3518026
	speed: 0.0050s/iter; left time: 5.3467s
Updating learning rate to 3.4241224344719186e-05
Epoch: 6 cost time: 2.5587193965911865
Epoch: 6, Steps: 490 | Train Loss: 0.4206618 Vali Loss: 0.6167257 Best vali loss: 0.5844782
	iters: 100, epoch: 7 | loss: 0.4029984
	speed: 0.0131s/iter; left time: 11.5101s
	iters: 200, epoch: 7 | loss: 0.7562353
	speed: 0.0049s/iter; left time: 3.8393s
	iters: 300, epoch: 7 | loss: 0.3476975
	speed: 0.0049s/iter; left time: 3.3361s
	iters: 400, epoch: 7 | loss: 0.3585180
	speed: 0.0048s/iter; left time: 2.7767s
Updating learning rate to 8.899004268740071e-06
Epoch: 7 cost time: 2.4346749782562256
Epoch: 7, Steps: 490 | Train Loss: 0.4663623 Vali Loss: 0.6441277 Best vali loss: 0.5844782
	iters: 100, epoch: 8 | loss: 1.1792496
	speed: 0.0136s/iter; left time: 5.3296s
	iters: 200, epoch: 8 | loss: 0.5554397
	speed: 0.0054s/iter; left time: 1.5583s
	iters: 300, epoch: 8 | loss: 0.5201317
	speed: 0.0054s/iter; left time: 1.0373s
	iters: 400, epoch: 8 | loss: 0.6865138
	speed: 0.0053s/iter; left time: 0.4846s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.630857229232788
Epoch: 8, Steps: 490 | Train Loss: 0.7353337 Vali Loss: 0.6516400 Best vali loss: 0.5844782

best validation loss 0.5844782336560294

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009419981319, 'e_layers': 3, 'learning_rate': 0.0003485276821, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0485606
	speed: 0.0122s/iter; left time: 10.7842s
Updating learning rate to 0.0003352626370528952
Validation loss decreased (inf --> 0.6068).  Saving model state dict ...
Epoch: 1 cost time: 1.0840504169464111
Epoch: 1, Steps: 123 | Train Loss: 1.0485606 Vali Loss: 0.6068343 Best vali loss: 0.6068343
	iters: 100, epoch: 2 | loss: 0.6964945
	speed: 0.0088s/iter; left time: 6.7271s
Updating learning rate to 0.0002974869847720697
Validation loss decreased (0.6068 --> 0.5667).  Saving model state dict ...
Epoch: 2 cost time: 0.6929206848144531
Epoch: 2, Steps: 123 | Train Loss: 0.6964945 Vali Loss: 0.5667108 Best vali loss: 0.5667108
	iters: 100, epoch: 3 | loss: 1.0428383
	speed: 0.0088s/iter; left time: 5.5938s
Updating learning rate to 0.00024095172588013846
Validation loss decreased (0.5667 --> 0.5527).  Saving model state dict ...
Epoch: 3 cost time: 0.700535774230957
Epoch: 3, Steps: 123 | Train Loss: 1.0428383 Vali Loss: 0.5526688 Best vali loss: 0.5526688

best validation loss 0.552668776544141

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029811727209, 'e_layers': 2, 'learning_rate': 0.0011257385315, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010828926598560812
Validation loss decreased (inf --> 0.6097).  Saving model state dict ...
Epoch: 1 cost time: 0.6888060569763184
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6097437 Best vali loss: 0.6097437
Updating learning rate to 0.0009608779404833179
Epoch: 2 cost time: 0.43712782859802246
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6478444 Best vali loss: 0.6097437
Updating learning rate to 0.000778270008340028
Epoch: 3 cost time: 0.4417400360107422
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6474657 Best vali loss: 0.6097437

best validation loss 0.6097436751385962

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745875
	speed: 0.0116s/iter; left time: 10.2236s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0219964981079102
Epoch: 1, Steps: 123 | Train Loss: 0.7745875 Vali Loss: 0.6172987 Best vali loss: 0.6172987
	iters: 100, epoch: 2 | loss: 0.9521514
	speed: 0.0092s/iter; left time: 6.9959s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5963).  Saving model state dict ...
Epoch: 2 cost time: 0.7230579853057861
Epoch: 2, Steps: 123 | Train Loss: 0.9521514 Vali Loss: 0.5963138 Best vali loss: 0.5963138
	iters: 100, epoch: 3 | loss: 0.8584358
	speed: 0.0094s/iter; left time: 6.0095s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5963 --> 0.5410).  Saving model state dict ...
Epoch: 3 cost time: 0.7228951454162598
Epoch: 3, Steps: 123 | Train Loss: 0.8584358 Vali Loss: 0.5410318 Best vali loss: 0.5410318

best validation loss 0.5410317823821778

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5810273
	speed: 0.0119s/iter; left time: 6.1470s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5410 --> 0.5297).  Saving model state dict ...
Epoch: 4 cost time: 1.0176165103912354
Epoch: 4, Steps: 123 | Train Loss: 0.5810273 Vali Loss: 0.5297465 Best vali loss: 0.5297465
	iters: 100, epoch: 5 | loss: 0.8234033
	speed: 0.0093s/iter; left time: 3.6379s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5297 --> 0.5240).  Saving model state dict ...
Epoch: 5 cost time: 0.7104263305664062
Epoch: 5, Steps: 123 | Train Loss: 0.8234033 Vali Loss: 0.5240269 Best vali loss: 0.5240269
	iters: 100, epoch: 6 | loss: 0.7579811
	speed: 0.0092s/iter; left time: 2.4801s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7174787521362305
Epoch: 6, Steps: 123 | Train Loss: 0.7579811 Vali Loss: 0.5278244 Best vali loss: 0.5240269
	iters: 100, epoch: 7 | loss: 0.4336554
	speed: 0.0090s/iter; left time: 1.3171s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7167558670043945
Epoch: 7, Steps: 123 | Train Loss: 0.4336554 Vali Loss: 0.5430051 Best vali loss: 0.5240269
	iters: 100, epoch: 8 | loss: 0.5065859
	speed: 0.0090s/iter; left time: 0.2154s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7253921031951904
Epoch: 8, Steps: 123 | Train Loss: 0.5065859 Vali Loss: 0.5425444 Best vali loss: 0.5240269

best validation loss 0.5240269434887852

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8825335
	speed: 0.0101s/iter; left time: 18.7109s
	iters: 200, epoch: 1 | loss: 0.6447718
	speed: 0.0041s/iter; left time: 7.1521s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 1.3425383567810059
Epoch: 1, Steps: 245 | Train Loss: 0.7636526 Vali Loss: 0.6019315 Best vali loss: 0.6019315
	iters: 100, epoch: 2 | loss: 0.7576300
	speed: 0.0091s/iter; left time: 14.7026s
	iters: 200, epoch: 2 | loss: 0.8834569
	speed: 0.0043s/iter; left time: 6.4707s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6019 --> 0.5606).  Saving model state dict ...
Epoch: 2 cost time: 1.091949462890625
Epoch: 2, Steps: 245 | Train Loss: 0.8205434 Vali Loss: 0.5605877 Best vali loss: 0.5605877
	iters: 100, epoch: 3 | loss: 0.7630719
	speed: 0.0091s/iter; left time: 12.4759s
	iters: 200, epoch: 3 | loss: 0.9216782
	speed: 0.0042s/iter; left time: 5.2906s
Updating learning rate to 0.0002058009417118559
Epoch: 3 cost time: 1.0584819316864014
Epoch: 3, Steps: 245 | Train Loss: 0.8423751 Vali Loss: 0.5713199 Best vali loss: 0.5605877
	iters: 100, epoch: 4 | loss: 0.6231413
	speed: 0.0087s/iter; left time: 9.7437s
	iters: 200, epoch: 4 | loss: 0.5254845
	speed: 0.0041s/iter; left time: 4.2259s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 1.058239221572876
Epoch: 4, Steps: 245 | Train Loss: 0.5743129 Vali Loss: 0.5689756 Best vali loss: 0.5605877
	iters: 100, epoch: 5 | loss: 0.7503070
	speed: 0.0087s/iter; left time: 7.6900s
	iters: 200, epoch: 5 | loss: 0.5493644
	speed: 0.0040s/iter; left time: 3.1016s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5606 --> 0.5526).  Saving model state dict ...
Epoch: 5 cost time: 1.0253815650939941
Epoch: 5, Steps: 245 | Train Loss: 0.6498357 Vali Loss: 0.5525631 Best vali loss: 0.5525631
	iters: 100, epoch: 6 | loss: 0.3619238
	speed: 0.0092s/iter; left time: 5.8320s
	iters: 200, epoch: 6 | loss: 0.5602981
	speed: 0.0040s/iter; left time: 2.1287s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 1.043060064315796
Epoch: 6, Steps: 245 | Train Loss: 0.4611110 Vali Loss: 0.5799724 Best vali loss: 0.5525631
	iters: 100, epoch: 7 | loss: 0.7378141
	speed: 0.0085s/iter; left time: 3.3400s
	iters: 200, epoch: 7 | loss: 0.5474278
	speed: 0.0041s/iter; left time: 1.1838s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 1.0402987003326416
Epoch: 7, Steps: 245 | Train Loss: 0.6426210 Vali Loss: 0.5775652 Best vali loss: 0.5525631
	iters: 100, epoch: 8 | loss: 0.6485298
	speed: 0.0087s/iter; left time: 1.2708s
	iters: 200, epoch: 8 | loss: 0.8242430
	speed: 0.0040s/iter; left time: 0.1842s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.038170576095581
Epoch: 8, Steps: 245 | Train Loss: 0.7363864 Vali Loss: 0.5798045 Best vali loss: 0.5525631

best validation loss 0.5525630798564912

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0003010585925, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744737
	speed: 0.0118s/iter; left time: 10.4688s
Updating learning rate to 0.000289600232098703
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0382592678070068
Epoch: 1, Steps: 123 | Train Loss: 0.7744737 Vali Loss: 0.6173631 Best vali loss: 0.6173631
	iters: 100, epoch: 2 | loss: 0.9420716
	speed: 0.0094s/iter; left time: 7.1527s
Updating learning rate to 0.00025696958239561374
Validation loss decreased (0.6174 --> 0.6108).  Saving model state dict ...
Epoch: 2 cost time: 0.7296345233917236
Epoch: 2, Steps: 123 | Train Loss: 0.9420716 Vali Loss: 0.6107583 Best vali loss: 0.6107583
	iters: 100, epoch: 3 | loss: 0.8524560
	speed: 0.0094s/iter; left time: 6.0145s
Updating learning rate to 0.00020813436401045146
Validation loss decreased (0.6108 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 0.7251865863800049
Epoch: 3, Steps: 123 | Train Loss: 0.8524560 Vali Loss: 0.5464285 Best vali loss: 0.5464285
	iters: 100, epoch: 4 | loss: 0.4873278
	speed: 0.0093s/iter; left time: 4.8230s
Updating learning rate to 0.00015052929625
Epoch: 4 cost time: 0.7274918556213379
Epoch: 4, Steps: 123 | Train Loss: 0.4873278 Vali Loss: 0.5498215 Best vali loss: 0.5464285
	iters: 100, epoch: 5 | loss: 0.5597618
	speed: 0.0091s/iter; left time: 3.5800s
Updating learning rate to 9.292422848954858e-05
Validation loss decreased (0.5464 --> 0.5259).  Saving model state dict ...
Epoch: 5 cost time: 0.7150568962097168
Epoch: 5, Steps: 123 | Train Loss: 0.5597618 Vali Loss: 0.5258780 Best vali loss: 0.5258780
	iters: 100, epoch: 6 | loss: 0.5841690
	speed: 0.0095s/iter; left time: 2.5527s
Updating learning rate to 4.408901010438627e-05
Epoch: 6 cost time: 0.7193827629089355
Epoch: 6, Steps: 123 | Train Loss: 0.5841690 Vali Loss: 0.5468872 Best vali loss: 0.5258780
	iters: 100, epoch: 7 | loss: 0.5308440
	speed: 0.0090s/iter; left time: 1.3169s
Updating learning rate to 1.1458360401297013e-05
Epoch: 7 cost time: 0.71694016456604
Epoch: 7, Steps: 123 | Train Loss: 0.5308440 Vali Loss: 0.5396263 Best vali loss: 0.5258780
	iters: 100, epoch: 8 | loss: 0.6873132
	speed: 0.0089s/iter; left time: 0.2145s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7221910953521729
Epoch: 8, Steps: 123 | Train Loss: 0.6873132 Vali Loss: 0.5448909 Best vali loss: 0.5258780

best validation loss 0.525878032342751

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010680095372, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745306
	speed: 0.0118s/iter; left time: 10.4303s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0236015319824219
Epoch: 1, Steps: 123 | Train Loss: 0.7745306 Vali Loss: 0.6174095 Best vali loss: 0.6174095
	iters: 100, epoch: 2 | loss: 0.9481240
	speed: 0.0092s/iter; left time: 7.0424s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6174 --> 0.5862).  Saving model state dict ...
Epoch: 2 cost time: 0.725717306137085
Epoch: 2, Steps: 123 | Train Loss: 0.9481240 Vali Loss: 0.5861982 Best vali loss: 0.5861982
	iters: 100, epoch: 3 | loss: 0.8558879
	speed: 0.0094s/iter; left time: 6.0109s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5862 --> 0.5606).  Saving model state dict ...
Epoch: 3 cost time: 0.7177789211273193
Epoch: 3, Steps: 123 | Train Loss: 0.8558879 Vali Loss: 0.5605745 Best vali loss: 0.5605745

best validation loss 0.5605744696888092

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010494915317, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9040689
	speed: 0.0120s/iter; left time: 10.6294s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6030).  Saving model state dict ...
Epoch: 1 cost time: 1.0434939861297607
Epoch: 1, Steps: 123 | Train Loss: 0.9040689 Vali Loss: 0.6030430 Best vali loss: 0.6030430
	iters: 100, epoch: 2 | loss: 0.8278350
	speed: 0.0093s/iter; left time: 7.0628s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6030 --> 0.5998).  Saving model state dict ...
Epoch: 2 cost time: 0.7305538654327393
Epoch: 2, Steps: 123 | Train Loss: 0.8278350 Vali Loss: 0.5998319 Best vali loss: 0.5998319
	iters: 100, epoch: 3 | loss: 0.6623088
	speed: 0.0094s/iter; left time: 6.0347s
Updating learning rate to 0.0002058009417118559
Epoch: 3 cost time: 0.7376821041107178
Epoch: 3, Steps: 123 | Train Loss: 0.6623088 Vali Loss: 0.6346956 Best vali loss: 0.5998319

best validation loss 0.5998318873307926

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9040163
	speed: 0.0118s/iter; left time: 10.4729s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 1.0462427139282227
Epoch: 1, Steps: 123 | Train Loss: 0.9040163 Vali Loss: 0.6030706 Best vali loss: 0.6030706
	iters: 100, epoch: 2 | loss: 0.8300824
	speed: 0.0094s/iter; left time: 7.1959s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6031 --> 0.5994).  Saving model state dict ...
Epoch: 2 cost time: 0.7410573959350586
Epoch: 2, Steps: 123 | Train Loss: 0.8300824 Vali Loss: 0.5993634 Best vali loss: 0.5993634
	iters: 100, epoch: 3 | loss: 0.6754602
	speed: 0.0096s/iter; left time: 6.1359s
Updating learning rate to 0.0002058009417118559
Epoch: 3 cost time: 0.7403378486633301
Epoch: 3, Steps: 123 | Train Loss: 0.6754602 Vali Loss: 0.6377012 Best vali loss: 0.5993634

best validation loss 0.5993633519328893

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010680095372, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5884910
	speed: 0.0120s/iter; left time: 6.2026s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5606 --> 0.5325).  Saving model state dict ...
Epoch: 4 cost time: 1.0322513580322266
Epoch: 4, Steps: 123 | Train Loss: 0.5884910 Vali Loss: 0.5324914 Best vali loss: 0.5324914
	iters: 100, epoch: 5 | loss: 0.8244121
	speed: 0.0093s/iter; left time: 3.6499s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5325 --> 0.5297).  Saving model state dict ...
Epoch: 5 cost time: 0.7200548648834229
Epoch: 5, Steps: 123 | Train Loss: 0.8244121 Vali Loss: 0.5297101 Best vali loss: 0.5297101
	iters: 100, epoch: 6 | loss: 0.7588255
	speed: 0.0092s/iter; left time: 2.4880s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7181589603424072
Epoch: 6, Steps: 123 | Train Loss: 0.7588255 Vali Loss: 0.5321155 Best vali loss: 0.5297101
	iters: 100, epoch: 7 | loss: 0.4358942
	speed: 0.0090s/iter; left time: 1.3276s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7216999530792236
Epoch: 7, Steps: 123 | Train Loss: 0.4358942 Vali Loss: 0.5384115 Best vali loss: 0.5297101
	iters: 100, epoch: 8 | loss: 0.5073744
	speed: 0.0090s/iter; left time: 0.2159s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7179586887359619
Epoch: 8, Steps: 123 | Train Loss: 0.5073744 Vali Loss: 0.5423300 Best vali loss: 0.5297101

best validation loss 0.5297100833310733

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2656397
	speed: 0.0120s/iter; left time: 10.6031s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6265).  Saving model state dict ...
Epoch: 1 cost time: 1.0678954124450684
Epoch: 1, Steps: 123 | Train Loss: 1.2656397 Vali Loss: 0.6265226 Best vali loss: 0.6265226
	iters: 100, epoch: 2 | loss: 1.0374508
	speed: 0.0100s/iter; left time: 7.5822s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6265 --> 0.6235).  Saving model state dict ...
Epoch: 2 cost time: 0.7804973125457764
Epoch: 2, Steps: 123 | Train Loss: 1.0374508 Vali Loss: 0.6234680 Best vali loss: 0.6234680
	iters: 100, epoch: 3 | loss: 0.6914040
	speed: 0.0100s/iter; left time: 6.3777s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.6235 --> 0.5610).  Saving model state dict ...
Epoch: 3 cost time: 0.7832770347595215
Epoch: 3, Steps: 123 | Train Loss: 0.6914040 Vali Loss: 0.5609734 Best vali loss: 0.5609734
	iters: 100, epoch: 4 | loss: 0.8602457
	speed: 0.0100s/iter; left time: 5.1614s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 0.7814171314239502
Epoch: 4, Steps: 123 | Train Loss: 0.8602457 Vali Loss: 0.5626095 Best vali loss: 0.5609734
	iters: 100, epoch: 5 | loss: 0.7085291
	speed: 0.0097s/iter; left time: 3.8015s
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 0.7764596939086914
Epoch: 5, Steps: 123 | Train Loss: 0.7085291 Vali Loss: 0.5649362 Best vali loss: 0.5609734
	iters: 100, epoch: 6 | loss: 0.6670079
	speed: 0.0097s/iter; left time: 2.6219s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7784824371337891
Epoch: 6, Steps: 123 | Train Loss: 0.6670079 Vali Loss: 0.5663612 Best vali loss: 0.5609734
	iters: 100, epoch: 7 | loss: 0.4685263
	speed: 0.0096s/iter; left time: 1.4065s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7703402042388916
Epoch: 7, Steps: 123 | Train Loss: 0.4685263 Vali Loss: 0.5806624 Best vali loss: 0.5609734
	iters: 100, epoch: 8 | loss: 0.5613825
	speed: 0.0097s/iter; left time: 0.2330s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7764408588409424
Epoch: 8, Steps: 123 | Train Loss: 0.5613825 Vali Loss: 0.5869740 Best vali loss: 0.5609734

best validation loss 0.5609734478729403

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 3, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6184638
	speed: 0.0139s/iter; left time: 12.3125s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6150).  Saving model state dict ...
Epoch: 1 cost time: 1.2999300956726074
Epoch: 1, Steps: 123 | Train Loss: 0.6184638 Vali Loss: 0.6150202 Best vali loss: 0.6150202
	iters: 100, epoch: 2 | loss: 0.7264096
	speed: 0.0124s/iter; left time: 9.4126s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6150 --> 0.5900).  Saving model state dict ...
Epoch: 2 cost time: 1.0025711059570312
Epoch: 2, Steps: 123 | Train Loss: 0.7264096 Vali Loss: 0.5899518 Best vali loss: 0.5899518
	iters: 100, epoch: 3 | loss: 0.6389859
	speed: 0.0125s/iter; left time: 7.9755s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5900 --> 0.5534).  Saving model state dict ...
Epoch: 3 cost time: 0.9971625804901123
Epoch: 3, Steps: 123 | Train Loss: 0.6389859 Vali Loss: 0.5533740 Best vali loss: 0.5533740
	iters: 100, epoch: 4 | loss: 0.8604065
	speed: 0.0126s/iter; left time: 6.5091s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5534 --> 0.5381).  Saving model state dict ...
Epoch: 4 cost time: 1.0048799514770508
Epoch: 4, Steps: 123 | Train Loss: 0.8604065 Vali Loss: 0.5380997 Best vali loss: 0.5380997
	iters: 100, epoch: 5 | loss: 0.6742175
	speed: 0.0125s/iter; left time: 4.9131s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5381 --> 0.5350).  Saving model state dict ...
Epoch: 5 cost time: 1.0108602046966553
Epoch: 5, Steps: 123 | Train Loss: 0.6742175 Vali Loss: 0.5349939 Best vali loss: 0.5349939
	iters: 100, epoch: 6 | loss: 0.4342331
	speed: 0.0126s/iter; left time: 3.4069s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 1.0072872638702393
Epoch: 6, Steps: 123 | Train Loss: 0.4342331 Vali Loss: 0.5380846 Best vali loss: 0.5349939
	iters: 100, epoch: 7 | loss: 0.7764323
	speed: 0.0120s/iter; left time: 1.7698s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.9987025260925293
Epoch: 7, Steps: 123 | Train Loss: 0.7764323 Vali Loss: 0.5481077 Best vali loss: 0.5349939
	iters: 100, epoch: 8 | loss: 0.6789399
	speed: 0.0121s/iter; left time: 0.2901s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0062766075134277
Epoch: 8, Steps: 123 | Train Loss: 0.6789399 Vali Loss: 0.5499329 Best vali loss: 0.5349939

best validation loss 0.5349938964634127

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010496912273, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744632
	speed: 0.0118s/iter; left time: 10.4589s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.026141881942749
Epoch: 1, Steps: 123 | Train Loss: 0.7744632 Vali Loss: 0.6172551 Best vali loss: 0.6172551
	iters: 100, epoch: 2 | loss: 0.9579894
	speed: 0.0092s/iter; left time: 7.0348s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6173 --> 0.5624).  Saving model state dict ...
Epoch: 2 cost time: 0.7273480892181396
Epoch: 2, Steps: 123 | Train Loss: 0.9579894 Vali Loss: 0.5623647 Best vali loss: 0.5623647
	iters: 100, epoch: 3 | loss: 0.8548928
	speed: 0.0094s/iter; left time: 6.0160s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5624 --> 0.5456).  Saving model state dict ...
Epoch: 3 cost time: 0.7261397838592529
Epoch: 3, Steps: 123 | Train Loss: 0.8548928 Vali Loss: 0.5455914 Best vali loss: 0.5455914

best validation loss 0.5455914386054643

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494632914, 'e_layers': 2, 'learning_rate': 0.0002975989186, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745380
	speed: 0.0118s/iter; left time: 10.4108s
Updating learning rate to 0.0002862722341960162
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.02170729637146
Epoch: 1, Steps: 123 | Train Loss: 0.7745380 Vali Loss: 0.6173256 Best vali loss: 0.6173256
	iters: 100, epoch: 2 | loss: 0.9482978
	speed: 0.0093s/iter; left time: 7.1172s
Updating learning rate to 0.00025401656600792166
Validation loss decreased (0.6173 --> 0.5591).  Saving model state dict ...
Epoch: 2 cost time: 0.734201192855835
Epoch: 2, Steps: 123 | Train Loss: 0.9482978 Vali Loss: 0.5590887 Best vali loss: 0.5590887
	iters: 100, epoch: 3 | loss: 0.8536230
	speed: 0.0095s/iter; left time: 6.0405s
Updating learning rate to 0.00020574254711899347
Validation loss decreased (0.5591 --> 0.5448).  Saving model state dict ...
Epoch: 3 cost time: 0.7320756912231445
Epoch: 3, Steps: 123 | Train Loss: 0.8536230 Vali Loss: 0.5447867 Best vali loss: 0.5447867

best validation loss 0.5447866614358065

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002995364913, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9051403
	speed: 0.0118s/iter; left time: 10.4503s
Updating learning rate to 0.0002881360624261576
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 1.0285015106201172
Epoch: 1, Steps: 123 | Train Loss: 0.9051403 Vali Loss: 0.6033022 Best vali loss: 0.6033022
	iters: 100, epoch: 2 | loss: 0.8224463
	speed: 0.0093s/iter; left time: 7.1227s
Updating learning rate to 0.00025567038775552766
Validation loss decreased (0.6033 --> 0.5999).  Saving model state dict ...
Epoch: 2 cost time: 0.7331595420837402
Epoch: 2, Steps: 123 | Train Loss: 0.8224463 Vali Loss: 0.5999219 Best vali loss: 0.5999219
	iters: 100, epoch: 3 | loss: 0.6659523
	speed: 0.0095s/iter; left time: 6.0734s
Updating learning rate to 0.00020708207195463995
Epoch: 3 cost time: 0.7419030666351318
Epoch: 3, Steps: 123 | Train Loss: 0.6659523 Vali Loss: 0.6292613 Best vali loss: 0.5999219

best validation loss 0.599921899143053

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494632914, 'e_layers': 2, 'learning_rate': 0.0002975989186, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5840099
	speed: 0.0122s/iter; left time: 6.2883s
Updating learning rate to 0.0001487994593
Validation loss decreased (0.5448 --> 0.5288).  Saving model state dict ...
Epoch: 4 cost time: 1.0369288921356201
Epoch: 4, Steps: 123 | Train Loss: 0.5840099 Vali Loss: 0.5288450 Best vali loss: 0.5288450
	iters: 100, epoch: 5 | loss: 0.8177601
	speed: 0.0093s/iter; left time: 3.6683s
Updating learning rate to 9.185637148100653e-05
Epoch: 5 cost time: 0.723747730255127
Epoch: 5, Steps: 123 | Train Loss: 0.8177601 Vali Loss: 0.5326898 Best vali loss: 0.5288450
	iters: 100, epoch: 6 | loss: 0.7559379
	speed: 0.0091s/iter; left time: 2.4645s
Updating learning rate to 4.358235259207832e-05
Epoch: 6 cost time: 0.7273118495941162
Epoch: 6, Steps: 123 | Train Loss: 0.7559379 Vali Loss: 0.5370135 Best vali loss: 0.5288450
	iters: 100, epoch: 7 | loss: 0.4290891
	speed: 0.0090s/iter; left time: 1.3252s
Updating learning rate to 1.1326684403983762e-05
Epoch: 7 cost time: 0.7258439064025879
Epoch: 7, Steps: 123 | Train Loss: 0.4290891 Vali Loss: 0.5486245 Best vali loss: 0.5288450
	iters: 100, epoch: 8 | loss: 0.5057774
	speed: 0.0089s/iter; left time: 0.2138s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7164709568023682
Epoch: 8, Steps: 123 | Train Loss: 0.5057774 Vali Loss: 0.5465281 Best vali loss: 0.5288450

best validation loss 0.5288450143393517

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010678804595, 'e_layers': 2, 'learning_rate': 0.0001833534148, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0635390
	speed: 0.0093s/iter; left time: 72.0953s
	iters: 200, epoch: 1 | loss: 0.4625279
	speed: 0.0031s/iter; left time: 23.8333s
	iters: 300, epoch: 1 | loss: 0.2524052
	speed: 0.0031s/iter; left time: 23.1832s
	iters: 400, epoch: 1 | loss: 1.1316922
	speed: 0.0030s/iter; left time: 22.6219s
	iters: 500, epoch: 1 | loss: 0.3823238
	speed: 0.0031s/iter; left time: 22.6440s
	iters: 600, epoch: 1 | loss: 0.8121769
	speed: 0.0032s/iter; left time: 22.8358s
	iters: 700, epoch: 1 | loss: 0.7420188
	speed: 0.0031s/iter; left time: 22.2866s
	iters: 800, epoch: 1 | loss: 0.7465461
	speed: 0.0030s/iter; left time: 20.9523s
	iters: 900, epoch: 1 | loss: 0.7779507
	speed: 0.0030s/iter; left time: 20.4884s
Updating learning rate to 0.000176374940974886
Validation loss decreased (inf --> 0.6196).  Saving model state dict ...
Epoch: 1 cost time: 3.3538341522216797
Epoch: 1, Steps: 979 | Train Loss: 0.7079090 Vali Loss: 0.6196011 Best vali loss: 0.6196011
	iters: 100, epoch: 2 | loss: 0.9765757
	speed: 0.0108s/iter; left time: 73.2767s
	iters: 200, epoch: 2 | loss: 0.5394768
	speed: 0.0032s/iter; left time: 21.0509s
	iters: 300, epoch: 2 | loss: 0.4347540
	speed: 0.0030s/iter; left time: 19.6896s
	iters: 400, epoch: 2 | loss: 0.5397133
	speed: 0.0030s/iter; left time: 19.0622s
	iters: 500, epoch: 2 | loss: 0.6061011
	speed: 0.0030s/iter; left time: 19.3568s
	iters: 600, epoch: 2 | loss: 0.9019026
	speed: 0.0032s/iter; left time: 19.8533s
	iters: 700, epoch: 2 | loss: 0.5581545
	speed: 0.0032s/iter; left time: 19.5138s
	iters: 800, epoch: 2 | loss: 1.5824625
	speed: 0.0032s/iter; left time: 19.4324s
	iters: 900, epoch: 2 | loss: 0.3279839
	speed: 0.0031s/iter; left time: 18.6252s
Updating learning rate to 0.00015650192887939492
Validation loss decreased (0.6196 --> 0.6096).  Saving model state dict ...
Epoch: 2 cost time: 3.101970911026001
Epoch: 2, Steps: 979 | Train Loss: 0.7185694 Vali Loss: 0.6096288 Best vali loss: 0.6096288
	iters: 100, epoch: 3 | loss: 1.7584260
	speed: 0.0112s/iter; left time: 64.4383s
	iters: 200, epoch: 3 | loss: 1.2616647
	speed: 0.0031s/iter; left time: 17.8640s
	iters: 300, epoch: 3 | loss: 0.6220669
	speed: 0.0031s/iter; left time: 17.3933s
	iters: 400, epoch: 3 | loss: 1.0108020
	speed: 0.0031s/iter; left time: 17.0204s
	iters: 500, epoch: 3 | loss: 0.3922488
	speed: 0.0031s/iter; left time: 16.4781s
	iters: 600, epoch: 3 | loss: 0.7332062
	speed: 0.0031s/iter; left time: 16.2134s
	iters: 700, epoch: 3 | loss: 0.2986640
	speed: 0.0031s/iter; left time: 16.0843s
	iters: 800, epoch: 3 | loss: 0.5666332
	speed: 0.0033s/iter; left time: 16.9696s
	iters: 900, epoch: 3 | loss: 0.7713709
	speed: 0.0037s/iter; left time: 18.1719s
Updating learning rate to 0.00012675986445576202
Epoch: 3 cost time: 3.2291486263275146
Epoch: 3, Steps: 979 | Train Loss: 0.8238981 Vali Loss: 0.6124555 Best vali loss: 0.6096288
	iters: 100, epoch: 4 | loss: 0.6732855
	speed: 0.0117s/iter; left time: 55.9350s
	iters: 200, epoch: 4 | loss: 0.7555285
	speed: 0.0036s/iter; left time: 16.7075s
	iters: 300, epoch: 4 | loss: 1.4393456
	speed: 0.0036s/iter; left time: 16.7067s
	iters: 400, epoch: 4 | loss: 0.3014839
	speed: 0.0036s/iter; left time: 16.2520s
	iters: 500, epoch: 4 | loss: 0.7470427
	speed: 0.0036s/iter; left time: 15.9492s
	iters: 600, epoch: 4 | loss: 1.3140383
	speed: 0.0035s/iter; left time: 14.9759s
	iters: 700, epoch: 4 | loss: 0.5417970
	speed: 0.0032s/iter; left time: 13.5937s
	iters: 800, epoch: 4 | loss: 1.0197026
	speed: 0.0032s/iter; left time: 12.9819s
	iters: 900, epoch: 4 | loss: 0.5878010
	speed: 0.0031s/iter; left time: 12.5078s
Updating learning rate to 9.16767074e-05
Epoch: 4 cost time: 3.3832433223724365
Epoch: 4, Steps: 979 | Train Loss: 0.8200028 Vali Loss: 0.6099283 Best vali loss: 0.6096288
	iters: 100, epoch: 5 | loss: 0.4795890
	speed: 0.0107s/iter; left time: 40.8862s
	iters: 200, epoch: 5 | loss: 0.4965524
	speed: 0.0031s/iter; left time: 11.6623s
	iters: 300, epoch: 5 | loss: 0.5552744
	speed: 0.0031s/iter; left time: 11.0322s
	iters: 400, epoch: 5 | loss: 1.4499909
	speed: 0.0031s/iter; left time: 10.8967s
	iters: 500, epoch: 5 | loss: 0.9356629
	speed: 0.0031s/iter; left time: 10.5787s
	iters: 600, epoch: 5 | loss: 0.2746291
	speed: 0.0031s/iter; left time: 10.4162s
	iters: 700, epoch: 5 | loss: 0.4574150
	speed: 0.0030s/iter; left time: 9.7239s
	iters: 800, epoch: 5 | loss: 0.4611916
	speed: 0.0031s/iter; left time: 9.7637s
	iters: 900, epoch: 5 | loss: 0.6171994
	speed: 0.0031s/iter; left time: 9.3680s
Updating learning rate to 5.6593550344237974e-05
Validation loss decreased (0.6096 --> 0.6066).  Saving model state dict ...
Epoch: 5 cost time: 3.0860276222229004
Epoch: 5, Steps: 979 | Train Loss: 0.6363894 Vali Loss: 0.6065517 Best vali loss: 0.6065517
	iters: 100, epoch: 6 | loss: 0.5675895
	speed: 0.0112s/iter; left time: 31.8376s
	iters: 200, epoch: 6 | loss: 0.3659341
	speed: 0.0034s/iter; left time: 9.2090s
	iters: 300, epoch: 6 | loss: 0.4431530
	speed: 0.0035s/iter; left time: 9.2148s
	iters: 400, epoch: 6 | loss: 1.5089324
	speed: 0.0036s/iter; left time: 9.1144s
	iters: 500, epoch: 6 | loss: 0.3667347
	speed: 0.0036s/iter; left time: 8.8718s
	iters: 600, epoch: 6 | loss: 1.2795367
	speed: 0.0036s/iter; left time: 8.4810s
	iters: 700, epoch: 6 | loss: 0.2259049
	speed: 0.0035s/iter; left time: 7.8706s
	iters: 800, epoch: 6 | loss: 0.7769799
	speed: 0.0032s/iter; left time: 6.8221s
	iters: 900, epoch: 6 | loss: 0.2667812
	speed: 0.0032s/iter; left time: 6.4603s
Updating learning rate to 2.685148592060506e-05
Validation loss decreased (0.6066 --> 0.6048).  Saving model state dict ...
Epoch: 6 cost time: 3.386841297149658
Epoch: 6, Steps: 979 | Train Loss: 0.6446163 Vali Loss: 0.6048117 Best vali loss: 0.6048117
	iters: 100, epoch: 7 | loss: 0.5104933
	speed: 0.0109s/iter; left time: 20.2010s
	iters: 200, epoch: 7 | loss: 1.4172697
	speed: 0.0031s/iter; left time: 5.4209s
	iters: 300, epoch: 7 | loss: 0.6681548
	speed: 0.0031s/iter; left time: 5.1814s
	iters: 400, epoch: 7 | loss: 0.5096861
	speed: 0.0031s/iter; left time: 4.7977s
	iters: 500, epoch: 7 | loss: 0.7814154
	speed: 0.0031s/iter; left time: 4.4709s
	iters: 600, epoch: 7 | loss: 0.9746111
	speed: 0.0031s/iter; left time: 4.2289s
	iters: 700, epoch: 7 | loss: 0.7477282
	speed: 0.0032s/iter; left time: 4.0153s
	iters: 800, epoch: 7 | loss: 0.2881844
	speed: 0.0031s/iter; left time: 3.6250s
	iters: 900, epoch: 7 | loss: 0.9736621
	speed: 0.0031s/iter; left time: 3.3240s
Updating learning rate to 6.978473825113978e-06
Epoch: 7 cost time: 3.0788114070892334
Epoch: 7, Steps: 979 | Train Loss: 0.7634672 Vali Loss: 0.6167545 Best vali loss: 0.6048117
	iters: 100, epoch: 8 | loss: 0.4346843
	speed: 0.0104s/iter; left time: 9.1629s
	iters: 200, epoch: 8 | loss: 0.7142276
	speed: 0.0031s/iter; left time: 2.4116s
	iters: 300, epoch: 8 | loss: 0.7296109
	speed: 0.0030s/iter; left time: 2.0646s
	iters: 400, epoch: 8 | loss: 0.2154343
	speed: 0.0030s/iter; left time: 1.7416s
	iters: 500, epoch: 8 | loss: 0.2972828
	speed: 0.0030s/iter; left time: 1.4619s
	iters: 600, epoch: 8 | loss: 0.6064056
	speed: 0.0032s/iter; left time: 1.2076s
	iters: 700, epoch: 8 | loss: 0.8677385
	speed: 0.0031s/iter; left time: 0.8760s
	iters: 800, epoch: 8 | loss: 0.5927449
	speed: 0.0030s/iter; left time: 0.5362s
	iters: 900, epoch: 8 | loss: 0.8811748
	speed: 0.0031s/iter; left time: 0.2518s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0446391105651855
Epoch: 8, Steps: 979 | Train Loss: 0.5932560 Vali Loss: 0.6218796 Best vali loss: 0.6048117

best validation loss 0.6048117010806348

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0100772434817, 'e_layers': 4, 'learning_rate': 0.0018010364765, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3964150
	speed: 0.0119s/iter; left time: 22.2372s
	iters: 200, epoch: 1 | loss: 0.7932242
	speed: 0.0058s/iter; left time: 10.2407s
Updating learning rate to 0.0018010364765
Validation loss decreased (inf --> 0.6349).  Saving model state dict ...
Epoch: 1 cost time: 1.7778842449188232
Epoch: 1, Steps: 245 | Train Loss: 1.0948196 Vali Loss: 0.6349020 Best vali loss: 0.6349020
	iters: 100, epoch: 2 | loss: 1.0919065
	speed: 0.0112s/iter; left time: 18.1217s
	iters: 200, epoch: 2 | loss: 0.7346938
	speed: 0.0055s/iter; left time: 8.3127s
Updating learning rate to 0.00090051823825
Validation loss decreased (0.6349 --> 0.6310).  Saving model state dict ...
Epoch: 2 cost time: 1.3921010494232178
Epoch: 2, Steps: 245 | Train Loss: 0.9133002 Vali Loss: 0.6309563 Best vali loss: 0.6309563
	iters: 100, epoch: 3 | loss: 0.9542349
	speed: 0.0111s/iter; left time: 15.1667s
	iters: 200, epoch: 3 | loss: 0.6450120
	speed: 0.0054s/iter; left time: 6.9147s
Updating learning rate to 0.000450259119125
Epoch: 3 cost time: 1.3939497470855713
Epoch: 3, Steps: 245 | Train Loss: 0.7996234 Vali Loss: 0.6463631 Best vali loss: 0.6309563
	iters: 100, epoch: 4 | loss: 1.0748472
	speed: 0.0107s/iter; left time: 12.0602s
	iters: 200, epoch: 4 | loss: 0.9868146
	speed: 0.0056s/iter; left time: 5.7165s
Updating learning rate to 0.0002251295595625
Epoch: 4 cost time: 1.4051268100738525
Epoch: 4, Steps: 245 | Train Loss: 1.0308309 Vali Loss: 0.6394966 Best vali loss: 0.6309563
	iters: 100, epoch: 5 | loss: 1.0984666
	speed: 0.0109s/iter; left time: 9.6049s
	iters: 200, epoch: 5 | loss: 0.8398861
	speed: 0.0054s/iter; left time: 4.2338s
Updating learning rate to 0.00011256477978125
Epoch: 5 cost time: 1.4038941860198975
Epoch: 5, Steps: 245 | Train Loss: 0.9691764 Vali Loss: 0.6411565 Best vali loss: 0.6309563
	iters: 100, epoch: 6 | loss: 0.7103812
	speed: 0.0108s/iter; left time: 6.8928s
	iters: 200, epoch: 6 | loss: 0.7922149
	speed: 0.0056s/iter; left time: 2.9881s
Updating learning rate to 5.6282389890625e-05
Epoch: 6 cost time: 1.410914421081543
Epoch: 6, Steps: 245 | Train Loss: 0.7512980 Vali Loss: 0.6419973 Best vali loss: 0.6309563
	iters: 100, epoch: 7 | loss: 1.0818404
	speed: 0.0110s/iter; left time: 4.2876s
	iters: 200, epoch: 7 | loss: 1.1808131
	speed: 0.0056s/iter; left time: 1.6374s
Updating learning rate to 2.81411949453125e-05
Epoch: 7 cost time: 1.414158821105957
Epoch: 7, Steps: 245 | Train Loss: 1.1313267 Vali Loss: 0.6425753 Best vali loss: 0.6309563
	iters: 100, epoch: 8 | loss: 0.9493372
	speed: 0.0107s/iter; left time: 1.5673s
	iters: 200, epoch: 8 | loss: 0.8684164
	speed: 0.0056s/iter; left time: 0.2554s
Updating learning rate to 1.407059747265625e-05
Epoch: 8 cost time: 1.401212453842163
Epoch: 8, Steps: 245 | Train Loss: 0.9088768 Vali Loss: 0.6428923 Best vali loss: 0.6309563

best validation loss 0.630956327347003

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0020189180521, 'e_layers': 3, 'learning_rate': 0.0003096232923, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002978389574223647
Validation loss decreased (inf --> 0.5949).  Saving model state dict ...
Epoch: 1 cost time: 1.1331629753112793
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5948532 Best vali loss: 0.5948532
Updating learning rate to 0.00026428001094931723
Validation loss decreased (0.5949 --> 0.5801).  Saving model state dict ...
Epoch: 2 cost time: 0.8369491100311279
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5801453 Best vali loss: 0.5801453
Updating learning rate to 0.00021405549826877172
Validation loss decreased (0.5801 --> 0.5615).  Saving model state dict ...
Epoch: 3 cost time: 0.8457794189453125
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5615406 Best vali loss: 0.5615406

best validation loss 0.5615406376186867

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0009640876736, 'e_layers': 4, 'learning_rate': 0.0004243758587, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004082240143224159
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8147728443145752
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020352 Best vali loss: 0.6020352
Updating learning rate to 0.000362227453079317
Validation loss decreased (0.6020 --> 0.5935).  Saving model state dict ...
Epoch: 2 cost time: 0.5061931610107422
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5934979 Best vali loss: 0.5934979
Updating learning rate to 0.0002933887344600992
Epoch: 3 cost time: 0.5154645442962646
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6036343 Best vali loss: 0.5934979

best validation loss 0.5934978972315402

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010482288628, 'e_layers': 2, 'learning_rate': 0.0001548595663, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7585865
	speed: 0.0116s/iter; left time: 10.2890s
Updating learning rate to 0.00014896557500907232
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 1.0262913703918457
Epoch: 1, Steps: 123 | Train Loss: 0.7585865 Vali Loss: 0.6057667 Best vali loss: 0.6057667
	iters: 100, epoch: 2 | loss: 0.9428728
	speed: 0.0092s/iter; left time: 7.0284s
Updating learning rate to 0.00013218090788116887
Validation loss decreased (0.6058 --> 0.5875).  Saving model state dict ...
Epoch: 2 cost time: 0.7201049327850342
Epoch: 2, Steps: 123 | Train Loss: 0.9428728 Vali Loss: 0.5874947 Best vali loss: 0.5874947
	iters: 100, epoch: 3 | loss: 0.8610383
	speed: 0.0092s/iter; left time: 5.9012s
Updating learning rate to 0.0001070608783331266
Validation loss decreased (0.5875 --> 0.5527).  Saving model state dict ...
Epoch: 3 cost time: 0.7183704376220703
Epoch: 3, Steps: 123 | Train Loss: 0.8610383 Vali Loss: 0.5526865 Best vali loss: 0.5526865

best validation loss 0.5526864606712991

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010482288628, 'e_layers': 2, 'learning_rate': 0.0001548595663, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6078298
	speed: 0.0118s/iter; left time: 6.1111s
Updating learning rate to 7.742978315e-05
Validation loss decreased (0.5527 --> 0.5362).  Saving model state dict ...
Epoch: 4 cost time: 1.0194594860076904
Epoch: 4, Steps: 123 | Train Loss: 0.6078298 Vali Loss: 0.5361765 Best vali loss: 0.5361765
	iters: 100, epoch: 5 | loss: 0.8495499
	speed: 0.0093s/iter; left time: 3.6587s
Updating learning rate to 4.779868796687341e-05
Validation loss decreased (0.5362 --> 0.5320).  Saving model state dict ...
Epoch: 5 cost time: 0.720587968826294
Epoch: 5, Steps: 123 | Train Loss: 0.8495499 Vali Loss: 0.5320070 Best vali loss: 0.5320070
	iters: 100, epoch: 6 | loss: 0.8099724
	speed: 0.0094s/iter; left time: 2.5304s
Updating learning rate to 2.267865841883113e-05
Validation loss decreased (0.5320 --> 0.5313).  Saving model state dict ...
Epoch: 6 cost time: 0.725743293762207
Epoch: 6, Steps: 123 | Train Loss: 0.8099724 Vali Loss: 0.5313170 Best vali loss: 0.5313170
	iters: 100, epoch: 7 | loss: 0.4880854
	speed: 0.0093s/iter; left time: 1.3667s
Updating learning rate to 5.8939912909276935e-06
Epoch: 7 cost time: 0.7247226238250732
Epoch: 7, Steps: 123 | Train Loss: 0.4880854 Vali Loss: 0.5316483 Best vali loss: 0.5313170
	iters: 100, epoch: 8 | loss: 0.5565858
	speed: 0.0090s/iter; left time: 0.2148s
Updating learning rate to 0.0
Validation loss decreased (0.5313 --> 0.5285).  Saving model state dict ...
Epoch: 8 cost time: 0.719151496887207
Epoch: 8, Steps: 123 | Train Loss: 0.5565858 Vali Loss: 0.5285064 Best vali loss: 0.5285064

best validation loss 0.5285064477106313

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745463
	speed: 0.0116s/iter; left time: 10.3028s
Updating learning rate to 0.0002978326994
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0205769538879395
Epoch: 1, Steps: 123 | Train Loss: 0.7745463 Vali Loss: 0.6172840 Best vali loss: 0.6172840
	iters: 100, epoch: 2 | loss: 0.9463207
	speed: 0.0092s/iter; left time: 7.0119s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.6173 --> 0.5894).  Saving model state dict ...
Epoch: 2 cost time: 0.723841667175293
Epoch: 2, Steps: 123 | Train Loss: 0.9463207 Vali Loss: 0.5894396 Best vali loss: 0.5894396
	iters: 100, epoch: 3 | loss: 0.8624302
	speed: 0.0094s/iter; left time: 6.0366s
Updating learning rate to 7.445817485e-05
Validation loss decreased (0.5894 --> 0.5532).  Saving model state dict ...
Epoch: 3 cost time: 0.7267873287200928
Epoch: 3, Steps: 123 | Train Loss: 0.8624302 Vali Loss: 0.5531814 Best vali loss: 0.5531814
	iters: 100, epoch: 4 | loss: 0.4919542
	speed: 0.0094s/iter; left time: 4.8546s
Updating learning rate to 3.7229087425e-05
Validation loss decreased (0.5532 --> 0.5379).  Saving model state dict ...
Epoch: 4 cost time: 0.7256052494049072
Epoch: 4, Steps: 123 | Train Loss: 0.4919542 Vali Loss: 0.5378753 Best vali loss: 0.5378753
	iters: 100, epoch: 5 | loss: 0.5732123
	speed: 0.0095s/iter; left time: 3.7460s
Updating learning rate to 1.86145437125e-05
Validation loss decreased (0.5379 --> 0.5324).  Saving model state dict ...
Epoch: 5 cost time: 0.7293338775634766
Epoch: 5, Steps: 123 | Train Loss: 0.5732123 Vali Loss: 0.5324486 Best vali loss: 0.5324486
	iters: 100, epoch: 6 | loss: 0.6200594
	speed: 0.0094s/iter; left time: 2.5328s
Updating learning rate to 9.30727185625e-06
Validation loss decreased (0.5324 --> 0.5268).  Saving model state dict ...
Epoch: 6 cost time: 0.7259695529937744
Epoch: 6, Steps: 123 | Train Loss: 0.6200594 Vali Loss: 0.5268268 Best vali loss: 0.5268268
	iters: 100, epoch: 7 | loss: 0.5895875
	speed: 0.0095s/iter; left time: 1.3913s
Updating learning rate to 4.653635928125e-06
Epoch: 7 cost time: 0.7319488525390625
Epoch: 7, Steps: 123 | Train Loss: 0.5895875 Vali Loss: 0.5273558 Best vali loss: 0.5268268
	iters: 100, epoch: 8 | loss: 0.7476370
	speed: 0.0090s/iter; left time: 0.2168s
Updating learning rate to 2.3268179640625e-06
Epoch: 8 cost time: 0.7239372730255127
Epoch: 8, Steps: 123 | Train Loss: 0.7476370 Vali Loss: 0.5269424 Best vali loss: 0.5268268

best validation loss 0.5268267604941739

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0014409846388, 'e_layers': 2, 'learning_rate': 0.001937799707, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2555945
	speed: 0.0094s/iter; left time: 72.9361s
	iters: 200, epoch: 1 | loss: 0.5337670
	speed: 0.0035s/iter; left time: 26.8852s
	iters: 300, epoch: 1 | loss: 0.9139583
	speed: 0.0034s/iter; left time: 25.3488s
	iters: 400, epoch: 1 | loss: 1.3336899
	speed: 0.0035s/iter; left time: 25.7585s
	iters: 500, epoch: 1 | loss: 1.4492455
	speed: 0.0035s/iter; left time: 25.4936s
	iters: 600, epoch: 1 | loss: 0.5666675
	speed: 0.0035s/iter; left time: 25.4483s
	iters: 700, epoch: 1 | loss: 0.8606517
	speed: 0.0035s/iter; left time: 24.7904s
	iters: 800, epoch: 1 | loss: 1.2121006
	speed: 0.0033s/iter; left time: 23.4574s
	iters: 900, epoch: 1 | loss: 0.8073963
	speed: 0.0033s/iter; left time: 23.0388s
Updating learning rate to 0.001937799707
Validation loss decreased (inf --> 0.6558).  Saving model state dict ...
Epoch: 1 cost time: 3.7115702629089355
Epoch: 1, Steps: 979 | Train Loss: 0.9925635 Vali Loss: 0.6557772 Best vali loss: 0.6557772
	iters: 100, epoch: 2 | loss: 0.5368588
	speed: 0.0115s/iter; left time: 77.6298s
	iters: 200, epoch: 2 | loss: 1.3631501
	speed: 0.0035s/iter; left time: 23.5151s
	iters: 300, epoch: 2 | loss: 1.0962404
	speed: 0.0035s/iter; left time: 22.9432s
	iters: 400, epoch: 2 | loss: 0.7891766
	speed: 0.0035s/iter; left time: 22.8078s
	iters: 500, epoch: 2 | loss: 0.4976234
	speed: 0.0035s/iter; left time: 22.4933s
	iters: 600, epoch: 2 | loss: 0.4961835
	speed: 0.0036s/iter; left time: 22.5000s
	iters: 700, epoch: 2 | loss: 0.5486755
	speed: 0.0036s/iter; left time: 21.9148s
	iters: 800, epoch: 2 | loss: 0.6351549
	speed: 0.0036s/iter; left time: 21.7590s
	iters: 900, epoch: 2 | loss: 0.7667086
	speed: 0.0034s/iter; left time: 20.5412s
Updating learning rate to 0.0009688998535
Validation loss decreased (0.6558 --> 0.6363).  Saving model state dict ...
Epoch: 2 cost time: 3.493239641189575
Epoch: 2, Steps: 979 | Train Loss: 0.7477524 Vali Loss: 0.6362573 Best vali loss: 0.6362573
	iters: 100, epoch: 3 | loss: 0.3669232
	speed: 0.0117s/iter; left time: 67.7418s
	iters: 200, epoch: 3 | loss: 1.5433902
	speed: 0.0032s/iter; left time: 18.3644s
	iters: 300, epoch: 3 | loss: 1.6649821
	speed: 0.0033s/iter; left time: 18.3202s
	iters: 400, epoch: 3 | loss: 0.6761743
	speed: 0.0033s/iter; left time: 17.8596s
	iters: 500, epoch: 3 | loss: 0.7607771
	speed: 0.0033s/iter; left time: 17.5426s
	iters: 600, epoch: 3 | loss: 1.4095641
	speed: 0.0033s/iter; left time: 17.5092s
	iters: 700, epoch: 3 | loss: 0.4333945
	speed: 0.0032s/iter; left time: 16.6822s
	iters: 800, epoch: 3 | loss: 0.6766808
	speed: 0.0033s/iter; left time: 16.6407s
	iters: 900, epoch: 3 | loss: 0.4380528
	speed: 0.0032s/iter; left time: 15.8558s
Updating learning rate to 0.00048444992675
Epoch: 3 cost time: 3.232820987701416
Epoch: 3, Steps: 979 | Train Loss: 0.8855488 Vali Loss: 0.6410194 Best vali loss: 0.6362573
	iters: 100, epoch: 4 | loss: 1.8762244
	speed: 0.0107s/iter; left time: 51.4342s
	iters: 200, epoch: 4 | loss: 0.6018500
	speed: 0.0033s/iter; left time: 15.2886s
	iters: 300, epoch: 4 | loss: 0.4848993
	speed: 0.0032s/iter; left time: 14.8548s
	iters: 400, epoch: 4 | loss: 1.0826802
	speed: 0.0032s/iter; left time: 14.5960s
	iters: 500, epoch: 4 | loss: 0.8815108
	speed: 0.0034s/iter; left time: 14.9353s
	iters: 600, epoch: 4 | loss: 1.0921085
	speed: 0.0033s/iter; left time: 13.9930s
	iters: 700, epoch: 4 | loss: 0.9507911
	speed: 0.0033s/iter; left time: 14.0325s
	iters: 800, epoch: 4 | loss: 1.3101423
	speed: 0.0034s/iter; left time: 13.8296s
	iters: 900, epoch: 4 | loss: 0.9868798
	speed: 0.0034s/iter; left time: 13.5853s
Updating learning rate to 0.000242224963375
Epoch: 4 cost time: 3.2644288539886475
Epoch: 4, Steps: 979 | Train Loss: 1.0296763 Vali Loss: 0.6427530 Best vali loss: 0.6362573
	iters: 100, epoch: 5 | loss: 0.7418302
	speed: 0.0108s/iter; left time: 41.1757s
	iters: 200, epoch: 5 | loss: 0.6210080
	speed: 0.0031s/iter; left time: 11.6445s
	iters: 300, epoch: 5 | loss: 0.5293093
	speed: 0.0031s/iter; left time: 11.3622s
	iters: 400, epoch: 5 | loss: 0.5134166
	speed: 0.0031s/iter; left time: 10.7504s
	iters: 500, epoch: 5 | loss: 0.6424376
	speed: 0.0031s/iter; left time: 10.7218s
	iters: 600, epoch: 5 | loss: 1.0925649
	speed: 0.0031s/iter; left time: 10.3156s
	iters: 700, epoch: 5 | loss: 0.3579870
	speed: 0.0032s/iter; left time: 10.2034s
	iters: 800, epoch: 5 | loss: 0.6742109
	speed: 0.0032s/iter; left time: 9.9939s
	iters: 900, epoch: 5 | loss: 0.5567809
	speed: 0.0032s/iter; left time: 9.7696s
Updating learning rate to 0.0001211124816875
Epoch: 5 cost time: 3.120988607406616
Epoch: 5, Steps: 979 | Train Loss: 0.6366162 Vali Loss: 0.6450051 Best vali loss: 0.6362573
	iters: 100, epoch: 6 | loss: 0.4276063
	speed: 0.0111s/iter; left time: 31.4927s
	iters: 200, epoch: 6 | loss: 0.3621303
	speed: 0.0033s/iter; left time: 9.0811s
	iters: 300, epoch: 6 | loss: 0.6805791
	speed: 0.0033s/iter; left time: 8.7540s
	iters: 400, epoch: 6 | loss: 1.5048908
	speed: 0.0033s/iter; left time: 8.2743s
	iters: 500, epoch: 6 | loss: 0.5464953
	speed: 0.0034s/iter; left time: 8.1982s
	iters: 600, epoch: 6 | loss: 0.9764321
	speed: 0.0033s/iter; left time: 7.6526s
	iters: 700, epoch: 6 | loss: 1.4241768
	speed: 0.0034s/iter; left time: 7.5118s
	iters: 800, epoch: 6 | loss: 0.6570066
	speed: 0.0032s/iter; left time: 6.9020s
	iters: 900, epoch: 6 | loss: 0.7714497
	speed: 0.0034s/iter; left time: 6.9400s
Updating learning rate to 6.055624084375e-05
Epoch: 6 cost time: 3.29154372215271
Epoch: 6, Steps: 979 | Train Loss: 0.8167519 Vali Loss: 0.6448583 Best vali loss: 0.6362573
	iters: 100, epoch: 7 | loss: 0.4451249
	speed: 0.0109s/iter; left time: 20.2399s
	iters: 200, epoch: 7 | loss: 1.0145161
	speed: 0.0032s/iter; left time: 5.6966s
	iters: 300, epoch: 7 | loss: 1.0832695
	speed: 0.0034s/iter; left time: 5.5837s
	iters: 400, epoch: 7 | loss: 0.7668377
	speed: 0.0032s/iter; left time: 4.9829s
	iters: 500, epoch: 7 | loss: 0.7291168
	speed: 0.0032s/iter; left time: 4.7014s
	iters: 600, epoch: 7 | loss: 0.6457567
	speed: 0.0031s/iter; left time: 4.1822s
	iters: 700, epoch: 7 | loss: 1.1986998
	speed: 0.0031s/iter; left time: 3.9197s
	iters: 800, epoch: 7 | loss: 0.9541289
	speed: 0.0033s/iter; left time: 3.8016s
	iters: 900, epoch: 7 | loss: 1.3837037
	speed: 0.0033s/iter; left time: 3.4633s
Updating learning rate to 3.0278120421875e-05
Epoch: 7 cost time: 3.1946253776550293
Epoch: 7, Steps: 979 | Train Loss: 0.9134616 Vali Loss: 0.6430915 Best vali loss: 0.6362573
	iters: 100, epoch: 8 | loss: 0.8179716
	speed: 0.0113s/iter; left time: 9.9794s
	iters: 200, epoch: 8 | loss: 0.5031670
	speed: 0.0035s/iter; left time: 2.7491s
	iters: 300, epoch: 8 | loss: 0.4127546
	speed: 0.0033s/iter; left time: 2.2679s
	iters: 400, epoch: 8 | loss: 0.3292099
	speed: 0.0033s/iter; left time: 1.9354s
	iters: 500, epoch: 8 | loss: 1.1701564
	speed: 0.0033s/iter; left time: 1.5983s
	iters: 600, epoch: 8 | loss: 0.9447367
	speed: 0.0033s/iter; left time: 1.2675s
	iters: 700, epoch: 8 | loss: 0.2666931
	speed: 0.0033s/iter; left time: 0.9350s
	iters: 800, epoch: 8 | loss: 0.5586724
	speed: 0.0034s/iter; left time: 0.6155s
	iters: 900, epoch: 8 | loss: 1.1253114
	speed: 0.0035s/iter; left time: 0.2815s
Updating learning rate to 1.51390602109375e-05
Epoch: 8 cost time: 3.392717123031616
Epoch: 8, Steps: 979 | Train Loss: 0.6809637 Vali Loss: 0.6433288 Best vali loss: 0.6362573

best validation loss 0.6362572547077636

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010486320975, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745578
	speed: 0.0120s/iter; left time: 10.6155s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.047450065612793
Epoch: 1, Steps: 123 | Train Loss: 0.7745578 Vali Loss: 0.6172749 Best vali loss: 0.6172749
	iters: 100, epoch: 2 | loss: 0.9436368
	speed: 0.0093s/iter; left time: 7.1050s
Updating learning rate to 0.0001489167575
Epoch: 2 cost time: 0.7298355102539062
Epoch: 2, Steps: 123 | Train Loss: 0.9436368 Vali Loss: 0.6294051 Best vali loss: 0.6172749
	iters: 100, epoch: 3 | loss: 0.8988285
	speed: 0.0091s/iter; left time: 5.8007s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.6173 --> 0.6089).  Saving model state dict ...
Epoch: 3 cost time: 0.7183423042297363
Epoch: 3, Steps: 123 | Train Loss: 0.8988285 Vali Loss: 0.6088767 Best vali loss: 0.6088767

best validation loss 0.6088767266008711

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472163264, 'e_layers': 2, 'learning_rate': 0.0001536158676, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7583735
	speed: 0.0117s/iter; left time: 10.3905s
Updating learning rate to 0.00014776921177230186
Validation loss decreased (inf --> 0.6057).  Saving model state dict ...
Epoch: 1 cost time: 1.0317978858947754
Epoch: 1, Steps: 123 | Train Loss: 0.7583735 Vali Loss: 0.6056653 Best vali loss: 0.6056653
	iters: 100, epoch: 2 | loss: 0.9442338
	speed: 0.0093s/iter; left time: 7.0626s
Updating learning rate to 0.0001311193446389074
Validation loss decreased (0.6057 --> 0.5894).  Saving model state dict ...
Epoch: 2 cost time: 0.7267651557922363
Epoch: 2, Steps: 123 | Train Loss: 0.9442338 Vali Loss: 0.5893529 Best vali loss: 0.5893529
	iters: 100, epoch: 3 | loss: 0.8607481
	speed: 0.0094s/iter; left time: 6.0276s
Updating learning rate to 0.00010620105753945459
Validation loss decreased (0.5894 --> 0.5594).  Saving model state dict ...
Epoch: 3 cost time: 0.7234203815460205
Epoch: 3, Steps: 123 | Train Loss: 0.8607481 Vali Loss: 0.5594268 Best vali loss: 0.5594268

best validation loss 0.5594267883768571

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011034125428, 'e_layers': 2, 'learning_rate': 5.96702009e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0140576
	speed: 0.0109s/iter; left time: 9.6219s
Updating learning rate to 5.96702009e-05
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 0.9276809692382812
Epoch: 1, Steps: 123 | Train Loss: 1.0140576 Vali Loss: 0.6090402 Best vali loss: 0.6090402
	iters: 100, epoch: 2 | loss: 0.9198173
	speed: 0.0078s/iter; left time: 5.9800s
Updating learning rate to 2.983510045e-05
Validation loss decreased (0.6090 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 0.6170382499694824
Epoch: 2, Steps: 123 | Train Loss: 0.9198173 Vali Loss: 0.6047756 Best vali loss: 0.6047756
	iters: 100, epoch: 3 | loss: 0.9404151
	speed: 0.0079s/iter; left time: 5.0652s
Updating learning rate to 1.4917550225e-05
Validation loss decreased (0.6048 --> 0.5931).  Saving model state dict ...
Epoch: 3 cost time: 0.5893330574035645
Epoch: 3, Steps: 123 | Train Loss: 0.9404151 Vali Loss: 0.5931275 Best vali loss: 0.5931275

best validation loss 0.5931275095282083

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472163264, 'e_layers': 2, 'learning_rate': 0.0001536158676, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6052563
	speed: 0.0123s/iter; left time: 6.3394s
Updating learning rate to 7.68079338e-05
Validation loss decreased (0.5594 --> 0.5351).  Saving model state dict ...
Epoch: 4 cost time: 1.0399463176727295
Epoch: 4, Steps: 123 | Train Loss: 0.6052563 Vali Loss: 0.5351281 Best vali loss: 0.5351281
	iters: 100, epoch: 5 | loss: 0.8547623
	speed: 0.0095s/iter; left time: 3.7423s
Updating learning rate to 4.7414810060545406e-05
Validation loss decreased (0.5351 --> 0.5292).  Saving model state dict ...
Epoch: 5 cost time: 0.7176873683929443
Epoch: 5, Steps: 123 | Train Loss: 0.8547623 Vali Loss: 0.5291940 Best vali loss: 0.5291940
	iters: 100, epoch: 6 | loss: 0.8136539
	speed: 0.0093s/iter; left time: 2.5047s
Updating learning rate to 2.2496522961092575e-05
Epoch: 6 cost time: 0.7258012294769287
Epoch: 6, Steps: 123 | Train Loss: 0.8136539 Vali Loss: 0.5299477 Best vali loss: 0.5291940
	iters: 100, epoch: 7 | loss: 0.4875700
	speed: 0.0090s/iter; left time: 1.3285s
Updating learning rate to 5.84665582769814e-06
Epoch: 7 cost time: 0.7265214920043945
Epoch: 7, Steps: 123 | Train Loss: 0.4875700 Vali Loss: 0.5309409 Best vali loss: 0.5291940
	iters: 100, epoch: 8 | loss: 0.5600086
	speed: 0.0091s/iter; left time: 0.2173s
Updating learning rate to 0.0
Validation loss decreased (0.5292 --> 0.5270).  Saving model state dict ...
Epoch: 8 cost time: 0.7230443954467773
Epoch: 8, Steps: 123 | Train Loss: 0.5600086 Vali Loss: 0.5270019 Best vali loss: 0.5270019

best validation loss 0.5270018580333881

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010920108382, 'e_layers': 2, 'learning_rate': 5.95267383e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0141811
	speed: 0.0110s/iter; left time: 9.7525s
Updating learning rate to 5.95267383e-05
Validation loss decreased (inf --> 0.6091).  Saving model state dict ...
Epoch: 1 cost time: 0.9285428524017334
Epoch: 1, Steps: 123 | Train Loss: 1.0141811 Vali Loss: 0.6091006 Best vali loss: 0.6091006
	iters: 100, epoch: 2 | loss: 0.9198830
	speed: 0.0077s/iter; left time: 5.8573s
Updating learning rate to 2.976336915e-05
Validation loss decreased (0.6091 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 0.5824377536773682
Epoch: 2, Steps: 123 | Train Loss: 0.9198830 Vali Loss: 0.6047895 Best vali loss: 0.6047895
	iters: 100, epoch: 3 | loss: 0.9405143
	speed: 0.0075s/iter; left time: 4.7780s
Updating learning rate to 1.4881684575e-05
Validation loss decreased (0.6048 --> 0.5932).  Saving model state dict ...
Epoch: 3 cost time: 0.5801525115966797
Epoch: 3, Steps: 123 | Train Loss: 0.9405143 Vali Loss: 0.5931775 Best vali loss: 0.5931775
	iters: 100, epoch: 4 | loss: 0.8858921
	speed: 0.0082s/iter; left time: 4.2166s
Updating learning rate to 7.4408422875e-06
Validation loss decreased (0.5932 --> 0.5911).  Saving model state dict ...
Epoch: 4 cost time: 0.6385633945465088
Epoch: 4, Steps: 123 | Train Loss: 0.8858921 Vali Loss: 0.5911226 Best vali loss: 0.5911226
	iters: 100, epoch: 5 | loss: 0.8237345
	speed: 0.0082s/iter; left time: 3.2153s
Updating learning rate to 3.72042114375e-06
Validation loss decreased (0.5911 --> 0.5885).  Saving model state dict ...
Epoch: 5 cost time: 0.6378233432769775
Epoch: 5, Steps: 123 | Train Loss: 0.8237345 Vali Loss: 0.5884777 Best vali loss: 0.5884777
	iters: 100, epoch: 6 | loss: 0.6727757
	speed: 0.0082s/iter; left time: 2.2117s
Updating learning rate to 1.860210571875e-06
Validation loss decreased (0.5885 --> 0.5873).  Saving model state dict ...
Epoch: 6 cost time: 0.6310203075408936
Epoch: 6, Steps: 123 | Train Loss: 0.6727757 Vali Loss: 0.5872511 Best vali loss: 0.5872511
	iters: 100, epoch: 7 | loss: 1.0615529
	speed: 0.0082s/iter; left time: 1.1984s
Updating learning rate to 9.301052859375e-07
Validation loss decreased (0.5873 --> 0.5866).  Saving model state dict ...
Epoch: 7 cost time: 0.6428444385528564
Epoch: 7, Steps: 123 | Train Loss: 1.0615529 Vali Loss: 0.5866318 Best vali loss: 0.5866318
	iters: 100, epoch: 8 | loss: 0.8658926
	speed: 0.0079s/iter; left time: 0.1889s
Updating learning rate to 4.6505264296875e-07
Validation loss decreased (0.5866 --> 0.5862).  Saving model state dict ...
Epoch: 8 cost time: 0.6061348915100098
Epoch: 8, Steps: 123 | Train Loss: 0.8658926 Vali Loss: 0.5862013 Best vali loss: 0.5862013

best validation loss 0.5862012639579702

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011504230455, 'e_layers': 2, 'learning_rate': 6.30392698e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7548607
	speed: 0.0116s/iter; left time: 10.2906s
Updating learning rate to 6.30392698e-05
Validation loss decreased (inf --> 0.6011).  Saving model state dict ...
Epoch: 1 cost time: 1.0168960094451904
Epoch: 1, Steps: 123 | Train Loss: 0.7548607 Vali Loss: 0.6010692 Best vali loss: 0.6010692
	iters: 100, epoch: 2 | loss: 0.9557527
	speed: 0.0092s/iter; left time: 7.0454s
Updating learning rate to 3.15196349e-05
Epoch: 2 cost time: 0.7211456298828125
Epoch: 2, Steps: 123 | Train Loss: 0.9557527 Vali Loss: 0.6026575 Best vali loss: 0.6010692
	iters: 100, epoch: 3 | loss: 0.9377333
	speed: 0.0089s/iter; left time: 5.6901s
Updating learning rate to 1.575981745e-05
Validation loss decreased (0.6011 --> 0.5940).  Saving model state dict ...
Epoch: 3 cost time: 0.7155423164367676
Epoch: 3, Steps: 123 | Train Loss: 0.9377333 Vali Loss: 0.5940495 Best vali loss: 0.5940495
	iters: 100, epoch: 4 | loss: 0.5181408
	speed: 0.0094s/iter; left time: 4.8739s
Updating learning rate to 7.879908725e-06
Epoch: 4 cost time: 0.7202918529510498
Epoch: 4, Steps: 123 | Train Loss: 0.5181408 Vali Loss: 0.5986403 Best vali loss: 0.5940495
	iters: 100, epoch: 5 | loss: 0.7039156
	speed: 0.0090s/iter; left time: 3.5406s
Updating learning rate to 3.9399543625e-06
Epoch: 5 cost time: 0.7211761474609375
Epoch: 5, Steps: 123 | Train Loss: 0.7039156 Vali Loss: 0.5969790 Best vali loss: 0.5940495
	iters: 100, epoch: 6 | loss: 0.6491244
	speed: 0.0090s/iter; left time: 2.4267s
Updating learning rate to 1.96997718125e-06
Epoch: 6 cost time: 0.7174937725067139
Epoch: 6, Steps: 123 | Train Loss: 0.6491244 Vali Loss: 0.5964115 Best vali loss: 0.5940495
	iters: 100, epoch: 7 | loss: 0.7247717
	speed: 0.0090s/iter; left time: 1.3275s
Updating learning rate to 9.84988590625e-07
Epoch: 7 cost time: 0.7228503227233887
Epoch: 7, Steps: 123 | Train Loss: 0.7247717 Vali Loss: 0.5965394 Best vali loss: 0.5940495
	iters: 100, epoch: 8 | loss: 0.8161414
	speed: 0.0091s/iter; left time: 0.2173s
Updating learning rate to 4.924942953125e-07
Epoch: 8 cost time: 0.7221002578735352
Epoch: 8, Steps: 123 | Train Loss: 0.8161414 Vali Loss: 0.5967263 Best vali loss: 0.5940495

best validation loss 0.5940494567142047

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010490343734, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4808693
	speed: 0.0099s/iter; left time: 37.9064s
	iters: 200, epoch: 1 | loss: 1.1568238
	speed: 0.0036s/iter; left time: 13.4146s
	iters: 300, epoch: 1 | loss: 0.9472811
	speed: 0.0036s/iter; left time: 12.9636s
	iters: 400, epoch: 1 | loss: 0.8445283
	speed: 0.0035s/iter; left time: 12.4073s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6100).  Saving model state dict ...
Epoch: 1 cost time: 2.110640525817871
Epoch: 1, Steps: 490 | Train Loss: 1.1073756 Vali Loss: 0.6100002 Best vali loss: 0.6100002
	iters: 100, epoch: 2 | loss: 0.3106324
	speed: 0.0105s/iter; left time: 34.9034s
	iters: 200, epoch: 2 | loss: 1.0927287
	speed: 0.0035s/iter; left time: 11.1886s
	iters: 300, epoch: 2 | loss: 1.2833493
	speed: 0.0035s/iter; left time: 11.0434s
	iters: 400, epoch: 2 | loss: 0.3706207
	speed: 0.0035s/iter; left time: 10.6416s
Updating learning rate to 0.0002542161104024173
Epoch: 2 cost time: 1.758005142211914
Epoch: 2, Steps: 490 | Train Loss: 0.7643328 Vali Loss: 0.6381045 Best vali loss: 0.6100002
	iters: 100, epoch: 3 | loss: 0.9959010
	speed: 0.0103s/iter; left time: 29.1536s
	iters: 200, epoch: 3 | loss: 0.9318799
	speed: 0.0037s/iter; left time: 10.0531s
	iters: 300, epoch: 3 | loss: 0.3935003
	speed: 0.0038s/iter; left time: 9.9507s
	iters: 400, epoch: 3 | loss: 1.5147415
	speed: 0.0038s/iter; left time: 9.5495s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 1.879570484161377
Epoch: 3, Steps: 490 | Train Loss: 0.9590057 Vali Loss: 0.6211839 Best vali loss: 0.6100002

best validation loss 0.6100001716878557

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4809135
	speed: 0.0098s/iter; left time: 37.3184s
	iters: 200, epoch: 1 | loss: 1.1574038
	speed: 0.0038s/iter; left time: 14.1685s
	iters: 300, epoch: 1 | loss: 0.9492854
	speed: 0.0036s/iter; left time: 13.1356s
	iters: 400, epoch: 1 | loss: 0.8977966
	speed: 0.0036s/iter; left time: 12.7343s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6060).  Saving model state dict ...
Epoch: 1 cost time: 2.148916721343994
Epoch: 1, Steps: 490 | Train Loss: 1.1213498 Vali Loss: 0.6060204 Best vali loss: 0.6060204
	iters: 100, epoch: 2 | loss: 0.3062861
	speed: 0.0106s/iter; left time: 35.3495s
	iters: 200, epoch: 2 | loss: 1.0728991
	speed: 0.0035s/iter; left time: 11.2280s
	iters: 300, epoch: 2 | loss: 1.5147814
	speed: 0.0035s/iter; left time: 10.9509s
	iters: 400, epoch: 2 | loss: 0.4179831
	speed: 0.0033s/iter; left time: 10.1415s
Updating learning rate to 0.0002540886619071902
Epoch: 2 cost time: 1.7365620136260986
Epoch: 2, Steps: 490 | Train Loss: 0.8279874 Vali Loss: 0.6133097 Best vali loss: 0.6060204
	iters: 100, epoch: 3 | loss: 1.0304757
	speed: 0.0099s/iter; left time: 28.0953s
	iters: 200, epoch: 3 | loss: 0.9337511
	speed: 0.0034s/iter; left time: 9.2954s
	iters: 300, epoch: 3 | loss: 0.3916218
	speed: 0.0035s/iter; left time: 9.1814s
	iters: 400, epoch: 3 | loss: 1.5677453
	speed: 0.0035s/iter; left time: 8.9722s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.6060 --> 0.6037).  Saving model state dict ...
Epoch: 3 cost time: 1.7330536842346191
Epoch: 3, Steps: 490 | Train Loss: 0.9808985 Vali Loss: 0.6036945 Best vali loss: 0.6036945

best validation loss 0.6036944637167294

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010493536196, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0647156
	speed: 0.0107s/iter; left time: 9.4767s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 0.8952598571777344
Epoch: 1, Steps: 123 | Train Loss: 1.0647156 Vali Loss: 0.6063798 Best vali loss: 0.6063798
	iters: 100, epoch: 2 | loss: 1.0112970
	speed: 0.0077s/iter; left time: 5.8542s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6064 --> 0.6026).  Saving model state dict ...
Epoch: 2 cost time: 0.615201473236084
Epoch: 2, Steps: 123 | Train Loss: 1.0112970 Vali Loss: 0.6025588 Best vali loss: 0.6025588
	iters: 100, epoch: 3 | loss: 1.1462563
	speed: 0.0077s/iter; left time: 4.9246s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.6026 --> 0.5982).  Saving model state dict ...
Epoch: 3 cost time: 0.6140491962432861
Epoch: 3, Steps: 123 | Train Loss: 1.1462563 Vali Loss: 0.5982334 Best vali loss: 0.5982334

best validation loss 0.5982334317569653

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010493536196, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0260867
	speed: 0.0110s/iter; left time: 5.6839s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.9194469451904297
Epoch: 4, Steps: 123 | Train Loss: 1.0260867 Vali Loss: 0.6168149 Best vali loss: 0.5982334
	iters: 100, epoch: 5 | loss: 0.8102290
	speed: 0.0075s/iter; left time: 2.9564s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5982 --> 0.5751).  Saving model state dict ...
Epoch: 5 cost time: 0.5801780223846436
Epoch: 5, Steps: 123 | Train Loss: 0.8102290 Vali Loss: 0.5750530 Best vali loss: 0.5750530
	iters: 100, epoch: 6 | loss: 1.1174183
	speed: 0.0075s/iter; left time: 2.0211s
Updating learning rate to 4.3594722292809835e-05
Validation loss decreased (0.5751 --> 0.5689).  Saving model state dict ...
Epoch: 6 cost time: 0.5799789428710938
Epoch: 6, Steps: 123 | Train Loss: 1.1174183 Vali Loss: 0.5688881 Best vali loss: 0.5688881
	iters: 100, epoch: 7 | loss: 0.5635676
	speed: 0.0075s/iter; left time: 1.1065s
Updating learning rate to 1.132989918446312e-05
Validation loss decreased (0.5689 --> 0.5662).  Saving model state dict ...
Epoch: 7 cost time: 0.5852701663970947
Epoch: 7, Steps: 123 | Train Loss: 0.5635676 Vali Loss: 0.5661744 Best vali loss: 0.5661744
	iters: 100, epoch: 8 | loss: 0.8852006
	speed: 0.0076s/iter; left time: 0.1821s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5905518531799316
Epoch: 8, Steps: 123 | Train Loss: 0.8852006 Vali Loss: 0.5695683 Best vali loss: 0.5661744

best validation loss 0.5661744166170762

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010471225619, 'e_layers': 2, 'learning_rate': 0.0002455238706, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4842271
	speed: 0.0100s/iter; left time: 38.2349s
	iters: 200, epoch: 1 | loss: 1.1493957
	speed: 0.0039s/iter; left time: 14.4122s
	iters: 300, epoch: 1 | loss: 0.9392229
	speed: 0.0039s/iter; left time: 13.9922s
	iters: 400, epoch: 1 | loss: 0.8533774
	speed: 0.0039s/iter; left time: 13.6068s
Updating learning rate to 0.00023617917469514484
Validation loss decreased (inf --> 0.5809).  Saving model state dict ...
Epoch: 1 cost time: 2.2306978702545166
Epoch: 1, Steps: 490 | Train Loss: 1.1065558 Vali Loss: 0.5808517 Best vali loss: 0.5808517
	iters: 100, epoch: 2 | loss: 0.2742820
	speed: 0.0105s/iter; left time: 34.8165s
	iters: 200, epoch: 2 | loss: 1.0681791
	speed: 0.0034s/iter; left time: 11.0578s
	iters: 300, epoch: 2 | loss: 1.0616045
	speed: 0.0034s/iter; left time: 10.7576s
	iters: 400, epoch: 2 | loss: 0.3764229
	speed: 0.0035s/iter; left time: 10.5567s
Updating learning rate to 0.0002095677322222142
Epoch: 2 cost time: 1.7299444675445557
Epoch: 2, Steps: 490 | Train Loss: 0.6951221 Vali Loss: 0.6266960 Best vali loss: 0.5808517
	iters: 100, epoch: 3 | loss: 0.9877440
	speed: 0.0097s/iter; left time: 27.6712s
	iters: 200, epoch: 3 | loss: 0.9176312
	speed: 0.0035s/iter; left time: 9.5901s
	iters: 300, epoch: 3 | loss: 0.3659622
	speed: 0.0035s/iter; left time: 9.2040s
	iters: 400, epoch: 3 | loss: 1.5469017
	speed: 0.0034s/iter; left time: 8.6919s
Updating learning rate to 0.0001697408940643851
Validation loss decreased (0.5809 --> 0.5582).  Saving model state dict ...
Epoch: 3 cost time: 1.6997077465057373
Epoch: 3, Steps: 490 | Train Loss: 0.9545598 Vali Loss: 0.5582431 Best vali loss: 0.5582431
	iters: 100, epoch: 4 | loss: 0.5212074
	speed: 0.0099s/iter; left time: 23.2604s
	iters: 200, epoch: 4 | loss: 0.7662609
	speed: 0.0034s/iter; left time: 7.5985s
	iters: 300, epoch: 4 | loss: 0.9258257
	speed: 0.0033s/iter; left time: 7.1430s
	iters: 400, epoch: 4 | loss: 0.5634218
	speed: 0.0034s/iter; left time: 6.9451s
Updating learning rate to 0.0001227619353
Validation loss decreased (0.5582 --> 0.5390).  Saving model state dict ...
Epoch: 4 cost time: 1.680006504058838
Epoch: 4, Steps: 490 | Train Loss: 0.6941790 Vali Loss: 0.5390043 Best vali loss: 0.5390043
	iters: 100, epoch: 5 | loss: 0.4969056
	speed: 0.0104s/iter; left time: 19.2966s
	iters: 200, epoch: 5 | loss: 0.6678285
	speed: 0.0036s/iter; left time: 6.2660s
	iters: 300, epoch: 5 | loss: 0.6275021
	speed: 0.0034s/iter; left time: 5.6689s
	iters: 400, epoch: 5 | loss: 0.7411705
	speed: 0.0034s/iter; left time: 5.2588s
Updating learning rate to 7.578297653561493e-05
Epoch: 5 cost time: 1.747997522354126
Epoch: 5, Steps: 490 | Train Loss: 0.6333517 Vali Loss: 0.5487898 Best vali loss: 0.5390043
	iters: 100, epoch: 6 | loss: 0.6571522
	speed: 0.0097s/iter; left time: 13.3584s
	iters: 200, epoch: 6 | loss: 0.3238120
	speed: 0.0034s/iter; left time: 4.2691s
	iters: 300, epoch: 6 | loss: 1.4438739
	speed: 0.0033s/iter; left time: 3.9187s
	iters: 400, epoch: 6 | loss: 0.5229173
	speed: 0.0033s/iter; left time: 3.4990s
Updating learning rate to 3.5956138377785805e-05
Epoch: 6 cost time: 1.6607308387756348
Epoch: 6, Steps: 490 | Train Loss: 0.7369388 Vali Loss: 0.5569705 Best vali loss: 0.5390043
	iters: 100, epoch: 7 | loss: 0.9152917
	speed: 0.0096s/iter; left time: 8.4970s
	iters: 200, epoch: 7 | loss: 0.7285337
	speed: 0.0036s/iter; left time: 2.8118s
	iters: 300, epoch: 7 | loss: 0.7195255
	speed: 0.0034s/iter; left time: 2.3357s
	iters: 400, epoch: 7 | loss: 0.5670813
	speed: 0.0034s/iter; left time: 1.9503s
Updating learning rate to 9.34469590485517e-06
Epoch: 7 cost time: 1.7169547080993652
Epoch: 7, Steps: 490 | Train Loss: 0.7326080 Vali Loss: 0.5831911 Best vali loss: 0.5390043
	iters: 100, epoch: 8 | loss: 0.4627145
	speed: 0.0096s/iter; left time: 3.7409s
	iters: 200, epoch: 8 | loss: 0.5713995
	speed: 0.0033s/iter; left time: 0.9504s
	iters: 300, epoch: 8 | loss: 0.7771670
	speed: 0.0032s/iter; left time: 0.6205s
	iters: 400, epoch: 8 | loss: 0.6329678
	speed: 0.0034s/iter; left time: 0.3081s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6703643798828125
Epoch: 8, Steps: 490 | Train Loss: 0.6110622 Vali Loss: 0.5821409 Best vali loss: 0.5390043

best validation loss 0.5390042933337614

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8155444
	speed: 0.0114s/iter; left time: 10.0959s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.5941).  Saving model state dict ...
Epoch: 1 cost time: 0.9740657806396484
Epoch: 1, Steps: 123 | Train Loss: 0.8155444 Vali Loss: 0.5940515 Best vali loss: 0.5940515
	iters: 100, epoch: 2 | loss: 0.9073039
	speed: 0.0088s/iter; left time: 6.6844s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.5941 --> 0.5520).  Saving model state dict ...
Epoch: 2 cost time: 0.6764986515045166
Epoch: 2, Steps: 123 | Train Loss: 0.9073039 Vali Loss: 0.5520353 Best vali loss: 0.5520353
	iters: 100, epoch: 3 | loss: 0.7288604
	speed: 0.0088s/iter; left time: 5.6482s
Updating learning rate to 0.00020590473339677975
Epoch: 3 cost time: 0.6782872676849365
Epoch: 3, Steps: 123 | Train Loss: 0.7288604 Vali Loss: 0.5632998 Best vali loss: 0.5520353
	iters: 100, epoch: 4 | loss: 0.6929405
	speed: 0.0085s/iter; left time: 4.3688s
Updating learning rate to 0.0001489167575
Epoch: 4 cost time: 0.6687238216400146
Epoch: 4, Steps: 123 | Train Loss: 0.6929405 Vali Loss: 0.5626527 Best vali loss: 0.5520353
	iters: 100, epoch: 5 | loss: 0.7358303
	speed: 0.0085s/iter; left time: 3.3510s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5520 --> 0.5493).  Saving model state dict ...
Epoch: 5 cost time: 0.6659252643585205
Epoch: 5, Steps: 123 | Train Loss: 0.7358303 Vali Loss: 0.5492523 Best vali loss: 0.5492523
	iters: 100, epoch: 6 | loss: 0.8529789
	speed: 0.0087s/iter; left time: 2.3551s
Updating learning rate to 4.361670843943735e-05
Validation loss decreased (0.5493 --> 0.5422).  Saving model state dict ...
Epoch: 6 cost time: 0.6673765182495117
Epoch: 6, Steps: 123 | Train Loss: 0.8529789 Vali Loss: 0.5422260 Best vali loss: 0.5422260
	iters: 100, epoch: 7 | loss: 0.5771537
	speed: 0.0087s/iter; left time: 1.2722s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.667015552520752
Epoch: 7, Steps: 123 | Train Loss: 0.5771537 Vali Loss: 0.5450078 Best vali loss: 0.5422260
	iters: 100, epoch: 8 | loss: 0.6329915
	speed: 0.0085s/iter; left time: 0.2044s
Updating learning rate to 0.0
Validation loss decreased (0.5422 --> 0.5401).  Saving model state dict ...
Epoch: 8 cost time: 0.6759133338928223
Epoch: 8, Steps: 123 | Train Loss: 0.6329915 Vali Loss: 0.5400807 Best vali loss: 0.5400807

best validation loss 0.5400806572745102

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010617942677, 'e_layers': 2, 'learning_rate': 0.000129541772, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7548372
	speed: 0.0115s/iter; left time: 10.1948s
Updating learning rate to 0.000129541772
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 1.0185174942016602
Epoch: 1, Steps: 123 | Train Loss: 0.7548372 Vali Loss: 0.6034831 Best vali loss: 0.6034831
	iters: 100, epoch: 2 | loss: 0.9363878
	speed: 0.0092s/iter; left time: 7.0370s
Updating learning rate to 6.4770886e-05
Validation loss decreased (0.6035 --> 0.5849).  Saving model state dict ...
Epoch: 2 cost time: 0.7220306396484375
Epoch: 2, Steps: 123 | Train Loss: 0.9363878 Vali Loss: 0.5849237 Best vali loss: 0.5849237
	iters: 100, epoch: 3 | loss: 0.8697960
	speed: 0.0094s/iter; left time: 6.0040s
Updating learning rate to 3.2385443e-05
Validation loss decreased (0.5849 --> 0.5666).  Saving model state dict ...
Epoch: 3 cost time: 0.7282686233520508
Epoch: 3, Steps: 123 | Train Loss: 0.8697960 Vali Loss: 0.5666263 Best vali loss: 0.5666263

best validation loss 0.5666262694996079

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010616339374, 'e_layers': 2, 'learning_rate': 0.0001330510176, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7551015
	speed: 0.0117s/iter; left time: 10.3219s
Updating learning rate to 0.0001330510176
Validation loss decreased (inf --> 0.6039).  Saving model state dict ...
Epoch: 1 cost time: 1.0186491012573242
Epoch: 1, Steps: 123 | Train Loss: 0.7551015 Vali Loss: 0.6039017 Best vali loss: 0.6039017
	iters: 100, epoch: 2 | loss: 0.9346367
	speed: 0.0092s/iter; left time: 7.0383s
Updating learning rate to 6.65255088e-05
Validation loss decreased (0.6039 --> 0.5763).  Saving model state dict ...
Epoch: 2 cost time: 0.7275044918060303
Epoch: 2, Steps: 123 | Train Loss: 0.9346367 Vali Loss: 0.5762525 Best vali loss: 0.5762525
	iters: 100, epoch: 3 | loss: 0.8662225
	speed: 0.0095s/iter; left time: 6.0389s
Updating learning rate to 3.32627544e-05
Validation loss decreased (0.5763 --> 0.5699).  Saving model state dict ...
Epoch: 3 cost time: 0.7275569438934326
Epoch: 3, Steps: 123 | Train Loss: 0.8662225 Vali Loss: 0.5699277 Best vali loss: 0.5699277

best validation loss 0.5699276679205376

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0175681
	speed: 0.0108s/iter; left time: 9.5560s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6044).  Saving model state dict ...
Epoch: 1 cost time: 0.9141905307769775
Epoch: 1, Steps: 123 | Train Loss: 1.0175681 Vali Loss: 0.6043502 Best vali loss: 0.6043502
	iters: 100, epoch: 2 | loss: 0.8247012
	speed: 0.0078s/iter; left time: 5.9371s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6044 --> 0.5925).  Saving model state dict ...
Epoch: 2 cost time: 0.6069462299346924
Epoch: 2, Steps: 123 | Train Loss: 0.8247012 Vali Loss: 0.5924755 Best vali loss: 0.5924755
	iters: 100, epoch: 3 | loss: 0.8099983
	speed: 0.0078s/iter; left time: 4.9888s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5925 --> 0.5519).  Saving model state dict ...
Epoch: 3 cost time: 0.6062881946563721
Epoch: 3, Steps: 123 | Train Loss: 0.8099983 Vali Loss: 0.5518749 Best vali loss: 0.5518749

best validation loss 0.5518749424673131

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8438742
	speed: 0.0111s/iter; left time: 5.7510s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5519 --> 0.5442).  Saving model state dict ...
Epoch: 4 cost time: 0.9302804470062256
Epoch: 4, Steps: 123 | Train Loss: 0.8438742 Vali Loss: 0.5442056 Best vali loss: 0.5442056
	iters: 100, epoch: 5 | loss: 0.7394272
	speed: 0.0082s/iter; left time: 3.2341s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5442 --> 0.5284).  Saving model state dict ...
Epoch: 5 cost time: 0.6317992210388184
Epoch: 5, Steps: 123 | Train Loss: 0.7394272 Vali Loss: 0.5284167 Best vali loss: 0.5284167
	iters: 100, epoch: 6 | loss: 0.7049528
	speed: 0.0078s/iter; left time: 2.1111s
Updating learning rate to 4.361658899758271e-05
Validation loss decreased (0.5284 --> 0.5283).  Saving model state dict ...
Epoch: 6 cost time: 0.5988123416900635
Epoch: 6, Steps: 123 | Train Loss: 0.7049528 Vali Loss: 0.5282761 Best vali loss: 0.5282761
	iters: 100, epoch: 7 | loss: 0.7127295
	speed: 0.0079s/iter; left time: 1.1622s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.6182224750518799
Epoch: 7, Steps: 123 | Train Loss: 0.7127295 Vali Loss: 0.5303844 Best vali loss: 0.5282761
	iters: 100, epoch: 8 | loss: 0.6183205
	speed: 0.0078s/iter; left time: 0.1867s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6188027858734131
Epoch: 8, Steps: 123 | Train Loss: 0.6183205 Vali Loss: 0.5339436 Best vali loss: 0.5282761

best validation loss 0.5282761050506303

[INFO][smbo.py:320] Finished 550 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001064777634, 'e_layers': 2, 'learning_rate': 0.0001347638582, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7554095
	speed: 0.0115s/iter; left time: 10.1954s
Updating learning rate to 0.0001347638582
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.0161495208740234
Epoch: 1, Steps: 123 | Train Loss: 0.7554095 Vali Loss: 0.6040307 Best vali loss: 0.6040307
	iters: 100, epoch: 2 | loss: 0.9347131
	speed: 0.0093s/iter; left time: 7.1020s
Updating learning rate to 6.73819291e-05
Validation loss decreased (0.6040 --> 0.5754).  Saving model state dict ...
Epoch: 2 cost time: 0.7270693778991699
Epoch: 2, Steps: 123 | Train Loss: 0.9347131 Vali Loss: 0.5753724 Best vali loss: 0.5753724
	iters: 100, epoch: 3 | loss: 0.8656949
	speed: 0.0095s/iter; left time: 6.0514s
Updating learning rate to 3.369096455e-05
Validation loss decreased (0.5754 --> 0.5718).  Saving model state dict ...
Epoch: 3 cost time: 0.7236330509185791
Epoch: 3, Steps: 123 | Train Loss: 0.8656949 Vali Loss: 0.5717614 Best vali loss: 0.5717614
	iters: 100, epoch: 4 | loss: 0.5020832
	speed: 0.0093s/iter; left time: 4.7854s
Updating learning rate to 1.6845482275e-05
Validation loss decreased (0.5718 --> 0.5518).  Saving model state dict ...
Epoch: 4 cost time: 0.7261824607849121
Epoch: 4, Steps: 123 | Train Loss: 0.5020832 Vali Loss: 0.5518272 Best vali loss: 0.5518272
	iters: 100, epoch: 5 | loss: 0.5920639
	speed: 0.0094s/iter; left time: 3.7033s
Updating learning rate to 8.4227411375e-06
Validation loss decreased (0.5518 --> 0.5427).  Saving model state dict ...
Epoch: 5 cost time: 0.7305042743682861
Epoch: 5, Steps: 123 | Train Loss: 0.5920639 Vali Loss: 0.5426927 Best vali loss: 0.5426927
	iters: 100, epoch: 6 | loss: 0.6308888
	speed: 0.0094s/iter; left time: 2.5339s
Updating learning rate to 4.21137056875e-06
Validation loss decreased (0.5427 --> 0.5390).  Saving model state dict ...
Epoch: 6 cost time: 0.7246222496032715
Epoch: 6, Steps: 123 | Train Loss: 0.6308888 Vali Loss: 0.5390239 Best vali loss: 0.5390239
	iters: 100, epoch: 7 | loss: 0.6218104
	speed: 0.0093s/iter; left time: 1.3725s
Updating learning rate to 2.105685284375e-06
Epoch: 7 cost time: 0.7230403423309326
Epoch: 7, Steps: 123 | Train Loss: 0.6218104 Vali Loss: 0.5406423 Best vali loss: 0.5390239
	iters: 100, epoch: 8 | loss: 0.7797660
	speed: 0.0091s/iter; left time: 0.2191s
Updating learning rate to 1.0528426421875e-06
Validation loss decreased (0.5390 --> 0.5384).  Saving model state dict ...
Epoch: 8 cost time: 0.7257816791534424
Epoch: 8, Steps: 123 | Train Loss: 0.7797660 Vali Loss: 0.5383696 Best vali loss: 0.5383696

best validation loss 0.5383695715116936

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010472163264, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0169883
	speed: 0.0109s/iter; left time: 9.6630s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 0.9315547943115234
Epoch: 1, Steps: 123 | Train Loss: 1.0169883 Vali Loss: 0.6049410 Best vali loss: 0.6049410
	iters: 100, epoch: 2 | loss: 0.8287009
	speed: 0.0082s/iter; left time: 6.2288s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6049 --> 0.5817).  Saving model state dict ...
Epoch: 2 cost time: 0.6432125568389893
Epoch: 2, Steps: 123 | Train Loss: 0.8287009 Vali Loss: 0.5816829 Best vali loss: 0.5816829
	iters: 100, epoch: 3 | loss: 0.8219948
	speed: 0.0079s/iter; left time: 5.0798s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5817 --> 0.5480).  Saving model state dict ...
Epoch: 3 cost time: 0.610062837600708
Epoch: 3, Steps: 123 | Train Loss: 0.8219948 Vali Loss: 0.5480001 Best vali loss: 0.5480001
	iters: 100, epoch: 4 | loss: 0.7881101
	speed: 0.0078s/iter; left time: 4.0048s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5480 --> 0.5408).  Saving model state dict ...
Epoch: 4 cost time: 0.5948343276977539
Epoch: 4, Steps: 123 | Train Loss: 0.7881101 Vali Loss: 0.5408474 Best vali loss: 0.5408474
	iters: 100, epoch: 5 | loss: 0.6695901
	speed: 0.0081s/iter; left time: 3.1870s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5408 --> 0.5377).  Saving model state dict ...
Epoch: 5 cost time: 0.6098158359527588
Epoch: 5, Steps: 123 | Train Loss: 0.6695901 Vali Loss: 0.5376670 Best vali loss: 0.5376670
	iters: 100, epoch: 6 | loss: 0.5297746
	speed: 0.0079s/iter; left time: 2.1372s
Updating learning rate to 4.361670843943735e-05
Validation loss decreased (0.5377 --> 0.5321).  Saving model state dict ...
Epoch: 6 cost time: 0.6104750633239746
Epoch: 6, Steps: 123 | Train Loss: 0.5297746 Vali Loss: 0.5320862 Best vali loss: 0.5320862
	iters: 100, epoch: 7 | loss: 0.8695877
	speed: 0.0081s/iter; left time: 1.1928s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.6277158260345459
Epoch: 7, Steps: 123 | Train Loss: 0.8695877 Vali Loss: 0.5327725 Best vali loss: 0.5320862
	iters: 100, epoch: 8 | loss: 0.8087194
	speed: 0.0080s/iter; left time: 0.1919s
Updating learning rate to 0.0
Validation loss decreased (0.5321 --> 0.5317).  Saving model state dict ...
Epoch: 8 cost time: 0.6315264701843262
Epoch: 8, Steps: 123 | Train Loss: 0.8087194 Vali Loss: 0.5317158 Best vali loss: 0.5317158

best validation loss 0.5317157564589073

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0110727870401, 'e_layers': 2, 'learning_rate': 5.43835607e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5753868
	speed: 0.0095s/iter; left time: 73.4632s
	iters: 200, epoch: 1 | loss: 0.5898579
	speed: 0.0034s/iter; left time: 26.0949s
	iters: 300, epoch: 1 | loss: 0.4791965
	speed: 0.0035s/iter; left time: 26.4318s
	iters: 400, epoch: 1 | loss: 0.3670077
	speed: 0.0034s/iter; left time: 25.0387s
	iters: 500, epoch: 1 | loss: 0.3875544
	speed: 0.0034s/iter; left time: 24.6873s
	iters: 600, epoch: 1 | loss: 0.3105967
	speed: 0.0032s/iter; left time: 23.0820s
	iters: 700, epoch: 1 | loss: 0.6096597
	speed: 0.0031s/iter; left time: 22.3606s
	iters: 800, epoch: 1 | loss: 0.8453194
	speed: 0.0030s/iter; left time: 21.1940s
	iters: 900, epoch: 1 | loss: 0.8042219
	speed: 0.0032s/iter; left time: 22.0464s
Updating learning rate to 5.43835607e-05
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 3.5569369792938232
Epoch: 1, Steps: 979 | Train Loss: 0.5520890 Vali Loss: 0.6018898 Best vali loss: 0.6018898
	iters: 100, epoch: 2 | loss: 0.4685162
	speed: 0.0105s/iter; left time: 71.1790s
	iters: 200, epoch: 2 | loss: 0.5958803
	speed: 0.0030s/iter; left time: 19.6797s
	iters: 300, epoch: 2 | loss: 1.1214085
	speed: 0.0031s/iter; left time: 20.0533s
	iters: 400, epoch: 2 | loss: 0.8543399
	speed: 0.0031s/iter; left time: 19.7781s
	iters: 500, epoch: 2 | loss: 1.2602428
	speed: 0.0030s/iter; left time: 18.7801s
	iters: 600, epoch: 2 | loss: 0.5287411
	speed: 0.0030s/iter; left time: 18.6624s
	iters: 700, epoch: 2 | loss: 0.2503189
	speed: 0.0031s/iter; left time: 19.3295s
	iters: 800, epoch: 2 | loss: 1.5591564
	speed: 0.0030s/iter; left time: 18.2553s
	iters: 900, epoch: 2 | loss: 0.8127640
	speed: 0.0030s/iter; left time: 17.8830s
Updating learning rate to 2.719178035e-05
Validation loss decreased (0.6019 --> 0.5992).  Saving model state dict ...
Epoch: 2 cost time: 2.9975597858428955
Epoch: 2, Steps: 979 | Train Loss: 0.8279298 Vali Loss: 0.5992039 Best vali loss: 0.5992039
	iters: 100, epoch: 3 | loss: 0.4117988
	speed: 0.0108s/iter; left time: 62.2666s
	iters: 200, epoch: 3 | loss: 1.0756242
	speed: 0.0031s/iter; left time: 17.8364s
	iters: 300, epoch: 3 | loss: 0.7716692
	speed: 0.0032s/iter; left time: 17.5683s
	iters: 400, epoch: 3 | loss: 0.4279318
	speed: 0.0030s/iter; left time: 16.5752s
	iters: 500, epoch: 3 | loss: 1.0812854
	speed: 0.0030s/iter; left time: 16.3872s
	iters: 600, epoch: 3 | loss: 1.4110509
	speed: 0.0031s/iter; left time: 16.4848s
	iters: 700, epoch: 3 | loss: 0.4197072
	speed: 0.0031s/iter; left time: 16.1741s
	iters: 800, epoch: 3 | loss: 1.2441508
	speed: 0.0031s/iter; left time: 15.9160s
	iters: 900, epoch: 3 | loss: 0.6855977
	speed: 0.0032s/iter; left time: 15.7063s
Updating learning rate to 1.3595890175e-05
Epoch: 3 cost time: 3.0977389812469482
Epoch: 3, Steps: 979 | Train Loss: 0.8365351 Vali Loss: 0.6076080 Best vali loss: 0.5992039

best validation loss 0.5992039415032044

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010464617686, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744790
	speed: 0.0117s/iter; left time: 10.3950s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.030275821685791
Epoch: 1, Steps: 123 | Train Loss: 0.7744790 Vali Loss: 0.6171711 Best vali loss: 0.6171711
	iters: 100, epoch: 2 | loss: 0.9376642
	speed: 0.0092s/iter; left time: 7.0361s
Updating learning rate to 0.0001488416921
Epoch: 2 cost time: 0.7235226631164551
Epoch: 2, Steps: 123 | Train Loss: 0.9376642 Vali Loss: 0.6300476 Best vali loss: 0.6171711
	iters: 100, epoch: 3 | loss: 0.8521647
	speed: 0.0091s/iter; left time: 5.8146s
Updating learning rate to 7.442084605e-05
Validation loss decreased (0.6172 --> 0.5536).  Saving model state dict ...
Epoch: 3 cost time: 0.7167260646820068
Epoch: 3, Steps: 123 | Train Loss: 0.8521647 Vali Loss: 0.5536441 Best vali loss: 0.5536441

best validation loss 0.5536441327741112

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011490518547, 'e_layers': 1, 'learning_rate': 6.43791407e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7194259
	speed: 0.0101s/iter; left time: 8.9232s
Updating learning rate to 6.43791407e-05
Validation loss decreased (inf --> 0.6203).  Saving model state dict ...
Epoch: 1 cost time: 0.8222203254699707
Epoch: 1, Steps: 123 | Train Loss: 0.7194259 Vali Loss: 0.6203092 Best vali loss: 0.6203092
	iters: 100, epoch: 2 | loss: 0.9110552
	speed: 0.0069s/iter; left time: 5.2324s
Updating learning rate to 3.218957035e-05
Validation loss decreased (0.6203 --> 0.6065).  Saving model state dict ...
Epoch: 2 cost time: 0.5169198513031006
Epoch: 2, Steps: 123 | Train Loss: 0.9110552 Vali Loss: 0.6065399 Best vali loss: 0.6065399
	iters: 100, epoch: 3 | loss: 0.6853762
	speed: 0.0066s/iter; left time: 4.2132s
Updating learning rate to 1.6094785175e-05
Validation loss decreased (0.6065 --> 0.6028).  Saving model state dict ...
Epoch: 3 cost time: 0.4961836338043213
Epoch: 3, Steps: 123 | Train Loss: 0.6853762 Vali Loss: 0.6027600 Best vali loss: 0.6027600

best validation loss 0.602760034984375

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010464617686, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5959237
	speed: 0.0121s/iter; left time: 6.2343s
Updating learning rate to 3.7210423025e-05
Validation loss decreased (0.5536 --> 0.5372).  Saving model state dict ...
Epoch: 4 cost time: 1.0283019542694092
Epoch: 4, Steps: 123 | Train Loss: 0.5959237 Vali Loss: 0.5372048 Best vali loss: 0.5372048
	iters: 100, epoch: 5 | loss: 0.8512523
	speed: 0.0095s/iter; left time: 3.7410s
Updating learning rate to 1.86052115125e-05
Validation loss decreased (0.5372 --> 0.5289).  Saving model state dict ...
Epoch: 5 cost time: 0.7288546562194824
Epoch: 5, Steps: 123 | Train Loss: 0.8512523 Vali Loss: 0.5289402 Best vali loss: 0.5289402
	iters: 100, epoch: 6 | loss: 0.8041736
	speed: 0.0094s/iter; left time: 2.5292s
Updating learning rate to 9.30260575625e-06
Epoch: 6 cost time: 0.7194344997406006
Epoch: 6, Steps: 123 | Train Loss: 0.8041736 Vali Loss: 0.5297978 Best vali loss: 0.5289402
	iters: 100, epoch: 7 | loss: 0.4864556
	speed: 0.0090s/iter; left time: 1.3207s
Updating learning rate to 4.651302878125e-06
Validation loss decreased (0.5289 --> 0.5288).  Saving model state dict ...
Epoch: 7 cost time: 0.7196052074432373
Epoch: 7, Steps: 123 | Train Loss: 0.4864556 Vali Loss: 0.5288072 Best vali loss: 0.5288072
	iters: 100, epoch: 8 | loss: 0.5592605
	speed: 0.0094s/iter; left time: 0.2260s
Updating learning rate to 2.3256514390625e-06
Validation loss decreased (0.5288 --> 0.5273).  Saving model state dict ...
Epoch: 8 cost time: 0.7196800708770752
Epoch: 8, Steps: 123 | Train Loss: 0.5592605 Vali Loss: 0.5273426 Best vali loss: 0.5273426

best validation loss 0.5273425882196934

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0114897536296, 'e_layers': 2, 'learning_rate': 0.000751723546, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000751723546
Validation loss decreased (inf --> 0.6370).  Saving model state dict ...
Epoch: 1 cost time: 0.7169559001922607
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6369692 Best vali loss: 0.6369692
Updating learning rate to 0.000375861773
Validation loss decreased (0.6370 --> 0.6118).  Saving model state dict ...
Epoch: 2 cost time: 0.43639397621154785
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6118053 Best vali loss: 0.6118053
Updating learning rate to 0.0001879308865
Validation loss decreased (0.6118 --> 0.6041).  Saving model state dict ...
Epoch: 3 cost time: 0.43802690505981445
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6040516 Best vali loss: 0.6040516
Updating learning rate to 9.396544325e-05
Epoch: 4 cost time: 0.42125940322875977
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6045473 Best vali loss: 0.6040516
Updating learning rate to 4.6982721625e-05
Epoch: 5 cost time: 0.43262290954589844
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6046607 Best vali loss: 0.6040516
Updating learning rate to 2.34913608125e-05
Validation loss decreased (0.6041 --> 0.6034).  Saving model state dict ...
Epoch: 6 cost time: 0.47075629234313965
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6033669 Best vali loss: 0.6033669
Updating learning rate to 1.174568040625e-05
Validation loss decreased (0.6034 --> 0.6032).  Saving model state dict ...
Epoch: 7 cost time: 0.422069787979126
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6031774 Best vali loss: 0.6031774
Updating learning rate to 5.872840203125e-06
Validation loss decreased (0.6032 --> 0.6030).  Saving model state dict ...
Epoch: 8 cost time: 0.4328782558441162
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6030069 Best vali loss: 0.6030069

best validation loss 0.6030068542051514

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010495306785, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745778
	speed: 0.0111s/iter; left time: 9.8379s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0314505100250244
Epoch: 1, Steps: 123 | Train Loss: 0.7745778 Vali Loss: 0.6172955 Best vali loss: 0.6172955
	iters: 100, epoch: 2 | loss: 0.9494799
	speed: 0.0092s/iter; left time: 7.0181s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5536).  Saving model state dict ...
Epoch: 2 cost time: 0.7280993461608887
Epoch: 2, Steps: 123 | Train Loss: 0.9494799 Vali Loss: 0.5536315 Best vali loss: 0.5536315
	iters: 100, epoch: 3 | loss: 0.8490741
	speed: 0.0094s/iter; left time: 6.0154s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5536 --> 0.5425).  Saving model state dict ...
Epoch: 3 cost time: 0.7273249626159668
Epoch: 3, Steps: 123 | Train Loss: 0.8490741 Vali Loss: 0.5424772 Best vali loss: 0.5424772
	iters: 100, epoch: 4 | loss: 0.4877937
	speed: 0.0095s/iter; left time: 4.8907s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5425 --> 0.5419).  Saving model state dict ...
Epoch: 4 cost time: 0.7299489974975586
Epoch: 4, Steps: 123 | Train Loss: 0.4877937 Vali Loss: 0.5418817 Best vali loss: 0.5418817
	iters: 100, epoch: 5 | loss: 0.5608877
	speed: 0.0093s/iter; left time: 3.6731s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5419 --> 0.5249).  Saving model state dict ...
Epoch: 5 cost time: 0.7251265048980713
Epoch: 5, Steps: 123 | Train Loss: 0.5608877 Vali Loss: 0.5248684 Best vali loss: 0.5248684
	iters: 100, epoch: 6 | loss: 0.5850490
	speed: 0.0094s/iter; left time: 2.5268s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.726630449295044
Epoch: 6, Steps: 123 | Train Loss: 0.5850490 Vali Loss: 0.5356384 Best vali loss: 0.5248684
	iters: 100, epoch: 7 | loss: 0.5446326
	speed: 0.0090s/iter; left time: 1.3253s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7210626602172852
Epoch: 7, Steps: 123 | Train Loss: 0.5446326 Vali Loss: 0.5358956 Best vali loss: 0.5248684
	iters: 100, epoch: 8 | loss: 0.7001122
	speed: 0.0091s/iter; left time: 0.2184s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7281920909881592
Epoch: 8, Steps: 123 | Train Loss: 0.7001122 Vali Loss: 0.5428073 Best vali loss: 0.5248684

best validation loss 0.5248683750326023

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744652
	speed: 0.0110s/iter; left time: 9.6999s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0156738758087158
Epoch: 1, Steps: 123 | Train Loss: 0.7744652 Vali Loss: 0.6172923 Best vali loss: 0.6172923
	iters: 100, epoch: 2 | loss: 0.9520369
	speed: 0.0092s/iter; left time: 7.0021s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5712).  Saving model state dict ...
Epoch: 2 cost time: 0.7201416492462158
Epoch: 2, Steps: 123 | Train Loss: 0.9520369 Vali Loss: 0.5711821 Best vali loss: 0.5711821
	iters: 100, epoch: 3 | loss: 0.8509780
	speed: 0.0094s/iter; left time: 5.9785s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5712 --> 0.5492).  Saving model state dict ...
Epoch: 3 cost time: 0.7204992771148682
Epoch: 3, Steps: 123 | Train Loss: 0.8509780 Vali Loss: 0.5491628 Best vali loss: 0.5491628

best validation loss 0.5491628322210758

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0096174126847, 'e_layers': 1, 'learning_rate': 0.0009915605872, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4316708
	speed: 0.0079s/iter; left time: 60.8656s
	iters: 200, epoch: 1 | loss: 1.3739446
	speed: 0.0025s/iter; left time: 18.9054s
	iters: 300, epoch: 1 | loss: 0.7454479
	speed: 0.0025s/iter; left time: 18.8729s
	iters: 400, epoch: 1 | loss: 0.5993765
	speed: 0.0024s/iter; left time: 18.1625s
	iters: 500, epoch: 1 | loss: 0.9341406
	speed: 0.0025s/iter; left time: 18.3181s
	iters: 600, epoch: 1 | loss: 0.9568131
	speed: 0.0024s/iter; left time: 17.5689s
	iters: 700, epoch: 1 | loss: 1.1543775
	speed: 0.0025s/iter; left time: 17.8173s
	iters: 800, epoch: 1 | loss: 1.5163794
	speed: 0.0024s/iter; left time: 17.2126s
	iters: 900, epoch: 1 | loss: 0.5273331
	speed: 0.0026s/iter; left time: 17.9754s
Updating learning rate to 0.0009538215594794765
Validation loss decreased (inf --> 0.6072).  Saving model state dict ...
Epoch: 1 cost time: 2.7586278915405273
Epoch: 1, Steps: 979 | Train Loss: 1.0266093 Vali Loss: 0.6072426 Best vali loss: 0.6072426
	iters: 100, epoch: 2 | loss: 0.4527664
	speed: 0.0087s/iter; left time: 59.0555s
	iters: 200, epoch: 2 | loss: 2.0417511
	speed: 0.0022s/iter; left time: 14.8164s
	iters: 300, epoch: 2 | loss: 1.3060327
	speed: 0.0023s/iter; left time: 15.1741s
	iters: 400, epoch: 2 | loss: 0.3071497
	speed: 0.0022s/iter; left time: 14.3689s
	iters: 500, epoch: 2 | loss: 0.5461265
	speed: 0.0022s/iter; left time: 14.2258s
	iters: 600, epoch: 2 | loss: 0.7656978
	speed: 0.0022s/iter; left time: 13.9589s
	iters: 700, epoch: 2 | loss: 0.7665699
	speed: 0.0022s/iter; left time: 13.8403s
	iters: 800, epoch: 2 | loss: 0.6891491
	speed: 0.0023s/iter; left time: 13.6839s
	iters: 900, epoch: 2 | loss: 0.5291833
	speed: 0.0022s/iter; left time: 13.3077s
Updating learning rate to 0.0008463499011832175
Epoch: 2 cost time: 2.2449450492858887
Epoch: 2, Steps: 979 | Train Loss: 0.8227140 Vali Loss: 0.6125007 Best vali loss: 0.6072426
	iters: 100, epoch: 3 | loss: 0.9815531
	speed: 0.0089s/iter; left time: 51.5962s
	iters: 200, epoch: 3 | loss: 1.0218534
	speed: 0.0025s/iter; left time: 14.2833s
	iters: 300, epoch: 3 | loss: 0.4903322
	speed: 0.0025s/iter; left time: 14.1305s
	iters: 400, epoch: 3 | loss: 0.5264991
	speed: 0.0025s/iter; left time: 13.9322s
	iters: 500, epoch: 3 | loss: 0.7999080
	speed: 0.0025s/iter; left time: 13.5225s
	iters: 600, epoch: 3 | loss: 0.8207536
	speed: 0.0025s/iter; left time: 13.0807s
	iters: 700, epoch: 3 | loss: 0.3415872
	speed: 0.0024s/iter; left time: 12.6523s
	iters: 800, epoch: 3 | loss: 0.3929261
	speed: 0.0025s/iter; left time: 12.8292s
	iters: 900, epoch: 3 | loss: 1.0664830
	speed: 0.0026s/iter; left time: 12.7525s
Updating learning rate to 0.00068550719805382
Validation loss decreased (0.6072 --> 0.6041).  Saving model state dict ...
Epoch: 3 cost time: 2.515777111053467
Epoch: 3, Steps: 979 | Train Loss: 0.7157662 Vali Loss: 0.6040999 Best vali loss: 0.6040999

best validation loss 0.6040998509309734

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002977549344, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0688468
	speed: 0.0107s/iter; left time: 9.4619s
Updating learning rate to 0.00028642231199820043
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 0.9009027481079102
Epoch: 1, Steps: 123 | Train Loss: 1.0688468 Vali Loss: 0.6490111 Best vali loss: 0.6490111
	iters: 100, epoch: 2 | loss: 0.8244626
	speed: 0.0077s/iter; left time: 5.8859s
Updating learning rate to 0.00025414973382299776
Validation loss decreased (0.6490 --> 0.6226).  Saving model state dict ...
Epoch: 2 cost time: 0.6014435291290283
Epoch: 2, Steps: 123 | Train Loss: 0.8244626 Vali Loss: 0.6225967 Best vali loss: 0.6225967
	iters: 100, epoch: 3 | loss: 0.9387717
	speed: 0.0077s/iter; left time: 4.9135s
Updating learning rate to 0.00020585040734991708
Validation loss decreased (0.6226 --> 0.6155).  Saving model state dict ...
Epoch: 3 cost time: 0.5932908058166504
Epoch: 3, Steps: 123 | Train Loss: 0.9387717 Vali Loss: 0.6155314 Best vali loss: 0.6155314

best validation loss 0.6155313540531054

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5866887
	speed: 0.0123s/iter; left time: 6.3545s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5492 --> 0.5361).  Saving model state dict ...
Epoch: 4 cost time: 1.0464377403259277
Epoch: 4, Steps: 123 | Train Loss: 0.5866887 Vali Loss: 0.5361437 Best vali loss: 0.5361437
	iters: 100, epoch: 5 | loss: 0.8192176
	speed: 0.0093s/iter; left time: 3.6745s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5361 --> 0.5243).  Saving model state dict ...
Epoch: 5 cost time: 0.7261741161346436
Epoch: 5, Steps: 123 | Train Loss: 0.8192176 Vali Loss: 0.5243311 Best vali loss: 0.5243311
	iters: 100, epoch: 6 | loss: 0.7614688
	speed: 0.0093s/iter; left time: 2.5008s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7181034088134766
Epoch: 6, Steps: 123 | Train Loss: 0.7614688 Vali Loss: 0.5404086 Best vali loss: 0.5243311
	iters: 100, epoch: 7 | loss: 0.4342849
	speed: 0.0091s/iter; left time: 1.3309s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7231185436248779
Epoch: 7, Steps: 123 | Train Loss: 0.4342849 Vali Loss: 0.5497061 Best vali loss: 0.5243311
	iters: 100, epoch: 8 | loss: 0.5060830
	speed: 0.0091s/iter; left time: 0.2174s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7170746326446533
Epoch: 8, Steps: 123 | Train Loss: 0.5060830 Vali Loss: 0.5522728 Best vali loss: 0.5243311

best validation loss 0.5243311359175153

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010831013118, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7742699
	speed: 0.0119s/iter; left time: 10.5590s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0364725589752197
Epoch: 1, Steps: 123 | Train Loss: 0.7742699 Vali Loss: 0.6173278 Best vali loss: 0.6173278
	iters: 100, epoch: 2 | loss: 0.9448293
	speed: 0.0093s/iter; left time: 7.0713s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5824).  Saving model state dict ...
Epoch: 2 cost time: 0.7182137966156006
Epoch: 2, Steps: 123 | Train Loss: 0.9448293 Vali Loss: 0.5824339 Best vali loss: 0.5824339
	iters: 100, epoch: 3 | loss: 0.8502408
	speed: 0.0093s/iter; left time: 5.9602s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5824 --> 0.5422).  Saving model state dict ...
Epoch: 3 cost time: 0.7228925228118896
Epoch: 3, Steps: 123 | Train Loss: 0.8502408 Vali Loss: 0.5422389 Best vali loss: 0.5422389
	iters: 100, epoch: 4 | loss: 0.4987653
	speed: 0.0093s/iter; left time: 4.7783s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5422 --> 0.5412).  Saving model state dict ...
Epoch: 4 cost time: 0.7250711917877197
Epoch: 4, Steps: 123 | Train Loss: 0.4987653 Vali Loss: 0.5412136 Best vali loss: 0.5412136
	iters: 100, epoch: 5 | loss: 0.5621773
	speed: 0.0095s/iter; left time: 3.7287s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5412 --> 0.5237).  Saving model state dict ...
Epoch: 5 cost time: 0.7372312545776367
Epoch: 5, Steps: 123 | Train Loss: 0.5621773 Vali Loss: 0.5236949 Best vali loss: 0.5236949
	iters: 100, epoch: 6 | loss: 0.5833673
	speed: 0.0095s/iter; left time: 2.5561s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7329230308532715
Epoch: 6, Steps: 123 | Train Loss: 0.5833673 Vali Loss: 0.5356103 Best vali loss: 0.5236949
	iters: 100, epoch: 7 | loss: 0.5349550
	speed: 0.0090s/iter; left time: 1.3271s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7147252559661865
Epoch: 7, Steps: 123 | Train Loss: 0.5349550 Vali Loss: 0.5409137 Best vali loss: 0.5236949
	iters: 100, epoch: 8 | loss: 0.6930517
	speed: 0.0090s/iter; left time: 0.2157s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7213504314422607
Epoch: 8, Steps: 123 | Train Loss: 0.6930517 Vali Loss: 0.5434038 Best vali loss: 0.5236949

best validation loss 0.5236949033342209

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010550989263, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0688878
	speed: 0.0111s/iter; left time: 9.8459s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 0.9345450401306152
Epoch: 1, Steps: 123 | Train Loss: 1.0688878 Vali Loss: 0.6490126 Best vali loss: 0.6490126
	iters: 100, epoch: 2 | loss: 0.8244596
	speed: 0.0078s/iter; left time: 5.9397s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6490 --> 0.6226).  Saving model state dict ...
Epoch: 2 cost time: 0.6150918006896973
Epoch: 2, Steps: 123 | Train Loss: 0.8244596 Vali Loss: 0.6225941 Best vali loss: 0.6225941
	iters: 100, epoch: 3 | loss: 0.9387287
	speed: 0.0076s/iter; left time: 4.8576s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.6226 --> 0.6155).  Saving model state dict ...
Epoch: 3 cost time: 0.5923705101013184
Epoch: 3, Steps: 123 | Train Loss: 0.9387287 Vali Loss: 0.6155287 Best vali loss: 0.6155287
	iters: 100, epoch: 4 | loss: 0.6974871
	speed: 0.0076s/iter; left time: 3.9036s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6155 --> 0.6114).  Saving model state dict ...
Epoch: 4 cost time: 0.5964107513427734
Epoch: 4, Steps: 123 | Train Loss: 0.6974871 Vali Loss: 0.6114355 Best vali loss: 0.6114355
	iters: 100, epoch: 5 | loss: 0.6137595
	speed: 0.0075s/iter; left time: 2.9366s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.6114 --> 0.6052).  Saving model state dict ...
Epoch: 5 cost time: 0.5895037651062012
Epoch: 5, Steps: 123 | Train Loss: 0.6137595 Vali Loss: 0.6052417 Best vali loss: 0.6052417
	iters: 100, epoch: 6 | loss: 0.8117347
	speed: 0.0077s/iter; left time: 2.0792s
Updating learning rate to 4.3594722292809835e-05
Validation loss decreased (0.6052 --> 0.6045).  Saving model state dict ...
Epoch: 6 cost time: 0.6078994274139404
Epoch: 6, Steps: 123 | Train Loss: 0.8117347 Vali Loss: 0.6044589 Best vali loss: 0.6044589
	iters: 100, epoch: 7 | loss: 0.7003209
	speed: 0.0075s/iter; left time: 1.0987s
Updating learning rate to 1.132989918446312e-05
Validation loss decreased (0.6045 --> 0.6043).  Saving model state dict ...
Epoch: 7 cost time: 0.5704329013824463
Epoch: 7, Steps: 123 | Train Loss: 0.7003209 Vali Loss: 0.6042530 Best vali loss: 0.6042530
	iters: 100, epoch: 8 | loss: 0.8513635
	speed: 0.0078s/iter; left time: 0.1866s
Updating learning rate to 0.0
Validation loss decreased (0.6043 --> 0.6041).  Saving model state dict ...
Epoch: 8 cost time: 0.6073317527770996
Epoch: 8, Steps: 123 | Train Loss: 0.8513635 Vali Loss: 0.6040800 Best vali loss: 0.6040800

best validation loss 0.6040799824632135

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002992430103, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0685945
	speed: 0.0108s/iter; left time: 9.5859s
Updating learning rate to 0.00028785375138161705
Validation loss decreased (inf --> 0.6488).  Saving model state dict ...
Epoch: 1 cost time: 0.9042303562164307
Epoch: 1, Steps: 123 | Train Loss: 1.0685945 Vali Loss: 0.6488046 Best vali loss: 0.6488046
	iters: 100, epoch: 2 | loss: 0.8242868
	speed: 0.0076s/iter; left time: 5.7600s
Updating learning rate to 0.0002554198860529029
Validation loss decreased (0.6488 --> 0.6224).  Saving model state dict ...
Epoch: 2 cost time: 0.6007969379425049
Epoch: 2, Steps: 123 | Train Loss: 0.8242868 Vali Loss: 0.6224392 Best vali loss: 0.6224392
	iters: 100, epoch: 3 | loss: 0.9385446
	speed: 0.0075s/iter; left time: 4.8195s
Updating learning rate to 0.00020687917629643295
Validation loss decreased (0.6224 --> 0.6154).  Saving model state dict ...
Epoch: 3 cost time: 0.5971400737762451
Epoch: 3, Steps: 123 | Train Loss: 0.9385446 Vali Loss: 0.6154293 Best vali loss: 0.6154293

best validation loss 0.6154292594057054

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011207835119, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0165746
	speed: 0.0108s/iter; left time: 9.6014s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 0.9141168594360352
Epoch: 1, Steps: 123 | Train Loss: 1.0165746 Vali Loss: 0.6040926 Best vali loss: 0.6040926
	iters: 100, epoch: 2 | loss: 0.8362287
	speed: 0.0075s/iter; left time: 5.6870s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6041 --> 0.5795).  Saving model state dict ...
Epoch: 2 cost time: 0.5736794471740723
Epoch: 2, Steps: 123 | Train Loss: 0.8362287 Vali Loss: 0.5794501 Best vali loss: 0.5794501
	iters: 100, epoch: 3 | loss: 0.8029634
	speed: 0.0076s/iter; left time: 4.8830s
Updating learning rate to 7.442084605e-05
Validation loss decreased (0.5795 --> 0.5517).  Saving model state dict ...
Epoch: 3 cost time: 0.5891170501708984
Epoch: 3, Steps: 123 | Train Loss: 0.8029634 Vali Loss: 0.5516847 Best vali loss: 0.5516847

best validation loss 0.5516847097890237

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011271143237, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0159365
	speed: 0.0111s/iter; left time: 9.8277s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 0.9437229633331299
Epoch: 1, Steps: 123 | Train Loss: 1.0159365 Vali Loss: 0.6048779 Best vali loss: 0.6048779
	iters: 100, epoch: 2 | loss: 0.8256071
	speed: 0.0080s/iter; left time: 6.1314s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6049 --> 0.5950).  Saving model state dict ...
Epoch: 2 cost time: 0.6293487548828125
Epoch: 2, Steps: 123 | Train Loss: 0.8256071 Vali Loss: 0.5949896 Best vali loss: 0.5949896
	iters: 100, epoch: 3 | loss: 0.7968105
	speed: 0.0079s/iter; left time: 5.0233s
Updating learning rate to 7.442084605e-05
Validation loss decreased (0.5950 --> 0.5569).  Saving model state dict ...
Epoch: 3 cost time: 0.6025958061218262
Epoch: 3, Steps: 123 | Train Loss: 0.7968105 Vali Loss: 0.5569367 Best vali loss: 0.5569367

best validation loss 0.5569367116935161

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011207835119, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8770958
	speed: 0.0111s/iter; left time: 5.7056s
Updating learning rate to 3.7210423025e-05
Validation loss decreased (0.5517 --> 0.5419).  Saving model state dict ...
Epoch: 4 cost time: 0.9316420555114746
Epoch: 4, Steps: 123 | Train Loss: 0.8770958 Vali Loss: 0.5418729 Best vali loss: 0.5418729
	iters: 100, epoch: 5 | loss: 0.7743318
	speed: 0.0078s/iter; left time: 3.0663s
Updating learning rate to 1.86052115125e-05
Epoch: 5 cost time: 0.5877320766448975
Epoch: 5, Steps: 123 | Train Loss: 0.7743318 Vali Loss: 0.5423645 Best vali loss: 0.5418729
	iters: 100, epoch: 6 | loss: 0.7525244
	speed: 0.0078s/iter; left time: 2.1072s
Updating learning rate to 9.30260575625e-06
Validation loss decreased (0.5419 --> 0.5384).  Saving model state dict ...
Epoch: 6 cost time: 0.6053693294525146
Epoch: 6, Steps: 123 | Train Loss: 0.7525244 Vali Loss: 0.5383897 Best vali loss: 0.5383897
	iters: 100, epoch: 7 | loss: 0.7811432
	speed: 0.0080s/iter; left time: 1.1739s
Updating learning rate to 4.651302878125e-06
Epoch: 7 cost time: 0.6195101737976074
Epoch: 7, Steps: 123 | Train Loss: 0.7811432 Vali Loss: 0.5397147 Best vali loss: 0.5383897
	iters: 100, epoch: 8 | loss: 0.6776996
	speed: 0.0080s/iter; left time: 0.1928s
Updating learning rate to 2.3256514390625e-06
Epoch: 8 cost time: 0.6111855506896973
Epoch: 8, Steps: 123 | Train Loss: 0.6776996 Vali Loss: 0.5397579 Best vali loss: 0.5383897

best validation loss 0.5383896791703279

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010477416085, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744356
	speed: 0.0117s/iter; left time: 10.3872s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0353355407714844
Epoch: 1, Steps: 123 | Train Loss: 0.7744356 Vali Loss: 0.6171834 Best vali loss: 0.6171834
	iters: 100, epoch: 2 | loss: 0.9494268
	speed: 0.0092s/iter; left time: 7.0381s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6172 --> 0.5885).  Saving model state dict ...
Epoch: 2 cost time: 0.7265365123748779
Epoch: 2, Steps: 123 | Train Loss: 0.9494268 Vali Loss: 0.5885379 Best vali loss: 0.5885379
	iters: 100, epoch: 3 | loss: 0.8452036
	speed: 0.0093s/iter; left time: 5.9635s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5885 --> 0.5479).  Saving model state dict ...
Epoch: 3 cost time: 0.7261896133422852
Epoch: 3, Steps: 123 | Train Loss: 0.8452036 Vali Loss: 0.5479275 Best vali loss: 0.5479275
	iters: 100, epoch: 4 | loss: 0.4863507
	speed: 0.0094s/iter; left time: 4.8472s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5479 --> 0.5374).  Saving model state dict ...
Epoch: 4 cost time: 0.7264227867126465
Epoch: 4, Steps: 123 | Train Loss: 0.4863507 Vali Loss: 0.5374358 Best vali loss: 0.5374358
	iters: 100, epoch: 5 | loss: 0.5569028
	speed: 0.0094s/iter; left time: 3.6919s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5374 --> 0.5268).  Saving model state dict ...
Epoch: 5 cost time: 0.7226002216339111
Epoch: 5, Steps: 123 | Train Loss: 0.5569028 Vali Loss: 0.5268009 Best vali loss: 0.5268009
	iters: 100, epoch: 6 | loss: 0.5811036
	speed: 0.0094s/iter; left time: 2.5383s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7287139892578125
Epoch: 6, Steps: 123 | Train Loss: 0.5811036 Vali Loss: 0.5471303 Best vali loss: 0.5268009
	iters: 100, epoch: 7 | loss: 0.5360597
	speed: 0.0091s/iter; left time: 1.3423s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7327563762664795
Epoch: 7, Steps: 123 | Train Loss: 0.5360597 Vali Loss: 0.5450077 Best vali loss: 0.5268009
	iters: 100, epoch: 8 | loss: 0.6921190
	speed: 0.0090s/iter; left time: 0.2162s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7191448211669922
Epoch: 8, Steps: 123 | Train Loss: 0.6921190 Vali Loss: 0.5523965 Best vali loss: 0.5268009

best validation loss 0.5268009179778146

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002990864001, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745047
	speed: 0.0118s/iter; left time: 10.4603s
Updating learning rate to 0.00028770310180243583
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0283880233764648
Epoch: 1, Steps: 123 | Train Loss: 0.7745047 Vali Loss: 0.6172506 Best vali loss: 0.6172506
	iters: 100, epoch: 2 | loss: 0.9422573
	speed: 0.0093s/iter; left time: 7.0829s
Updating learning rate to 0.00025528621088569147
Validation loss decreased (0.6173 --> 0.5818).  Saving model state dict ...
Epoch: 2 cost time: 0.7323472499847412
Epoch: 2, Steps: 123 | Train Loss: 0.9422573 Vali Loss: 0.5818154 Best vali loss: 0.5818154
	iters: 100, epoch: 3 | loss: 0.8625560
	speed: 0.0095s/iter; left time: 6.0498s
Updating learning rate to 0.00020677090513199328
Validation loss decreased (0.5818 --> 0.5495).  Saving model state dict ...
Epoch: 3 cost time: 0.7268521785736084
Epoch: 3, Steps: 123 | Train Loss: 0.8625560 Vali Loss: 0.5494892 Best vali loss: 0.5494892
	iters: 100, epoch: 4 | loss: 0.4875432
	speed: 0.0093s/iter; left time: 4.8129s
Updating learning rate to 0.00014954320005
Validation loss decreased (0.5495 --> 0.5419).  Saving model state dict ...
Epoch: 4 cost time: 0.7243094444274902
Epoch: 4, Steps: 123 | Train Loss: 0.4875432 Vali Loss: 0.5418844 Best vali loss: 0.5418844
	iters: 100, epoch: 5 | loss: 0.5534729
	speed: 0.0093s/iter; left time: 3.6674s
Updating learning rate to 9.231549496800674e-05
Validation loss decreased (0.5419 --> 0.5260).  Saving model state dict ...
Epoch: 5 cost time: 0.7287642955780029
Epoch: 5, Steps: 123 | Train Loss: 0.5534729 Vali Loss: 0.5259548 Best vali loss: 0.5259548
	iters: 100, epoch: 6 | loss: 0.5901639
	speed: 0.0093s/iter; left time: 2.5152s
Updating learning rate to 4.3800189214308556e-05
Epoch: 6 cost time: 0.7262516021728516
Epoch: 6, Steps: 123 | Train Loss: 0.5901639 Vali Loss: 0.5433432 Best vali loss: 0.5259548
	iters: 100, epoch: 7 | loss: 0.5354151
	speed: 0.0091s/iter; left time: 1.3401s
Updating learning rate to 1.1383298297564168e-05
Epoch: 7 cost time: 0.7239420413970947
Epoch: 7, Steps: 123 | Train Loss: 0.5354151 Vali Loss: 0.5338455 Best vali loss: 0.5259548
	iters: 100, epoch: 8 | loss: 0.6965724
	speed: 0.0090s/iter; left time: 0.2164s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7223770618438721
Epoch: 8, Steps: 123 | Train Loss: 0.6965724 Vali Loss: 0.5391398 Best vali loss: 0.5259548

best validation loss 0.525954792450998

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010813236561, 'e_layers': 2, 'learning_rate': 0.0002925694855, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4374649
	speed: 0.0098s/iter; left time: 75.6638s
	iters: 200, epoch: 1 | loss: 1.3907382
	speed: 0.0035s/iter; left time: 26.7868s
	iters: 300, epoch: 1 | loss: 0.8154105
	speed: 0.0034s/iter; left time: 25.9014s
	iters: 400, epoch: 1 | loss: 1.4229749
	speed: 0.0035s/iter; left time: 26.1639s
	iters: 500, epoch: 1 | loss: 0.9342780
	speed: 0.0033s/iter; left time: 24.5147s
	iters: 600, epoch: 1 | loss: 1.6224375
	speed: 0.0033s/iter; left time: 24.1617s
	iters: 700, epoch: 1 | loss: 0.8161189
	speed: 0.0035s/iter; left time: 24.6662s
	iters: 800, epoch: 1 | loss: 0.7040335
	speed: 0.0034s/iter; left time: 23.6944s
	iters: 900, epoch: 1 | loss: 1.0645360
	speed: 0.0033s/iter; left time: 23.1569s
Updating learning rate to 0.0002925694855
Validation loss decreased (inf --> 0.5960).  Saving model state dict ...
Epoch: 1 cost time: 3.6996796131134033
Epoch: 1, Steps: 979 | Train Loss: 1.0231103 Vali Loss: 0.5959781 Best vali loss: 0.5959781
	iters: 100, epoch: 2 | loss: 1.0111220
	speed: 0.0115s/iter; left time: 77.3894s
	iters: 200, epoch: 2 | loss: 0.3767252
	speed: 0.0033s/iter; left time: 21.9872s
	iters: 300, epoch: 2 | loss: 0.4376733
	speed: 0.0034s/iter; left time: 22.5575s
	iters: 400, epoch: 2 | loss: 1.5044658
	speed: 0.0034s/iter; left time: 21.9014s
	iters: 500, epoch: 2 | loss: 1.0126727
	speed: 0.0033s/iter; left time: 21.0065s
	iters: 600, epoch: 2 | loss: 1.4183811
	speed: 0.0034s/iter; left time: 21.5227s
	iters: 700, epoch: 2 | loss: 1.0883383
	speed: 0.0033s/iter; left time: 20.3894s
	iters: 800, epoch: 2 | loss: 0.3085673
	speed: 0.0034s/iter; left time: 20.3906s
	iters: 900, epoch: 2 | loss: 0.8895023
	speed: 0.0034s/iter; left time: 20.4957s
Updating learning rate to 0.00014628474275
Epoch: 2 cost time: 3.3650059700012207
Epoch: 2, Steps: 979 | Train Loss: 0.8941609 Vali Loss: 0.6196321 Best vali loss: 0.5959781
	iters: 100, epoch: 3 | loss: 0.7222723
	speed: 0.0116s/iter; left time: 66.8433s
	iters: 200, epoch: 3 | loss: 0.6683382
	speed: 0.0034s/iter; left time: 19.3601s
	iters: 300, epoch: 3 | loss: 1.5286338
	speed: 0.0036s/iter; left time: 20.1944s
	iters: 400, epoch: 3 | loss: 1.0690254
	speed: 0.0036s/iter; left time: 19.6953s
	iters: 500, epoch: 3 | loss: 1.0832729
	speed: 0.0037s/iter; left time: 19.7325s
	iters: 600, epoch: 3 | loss: 0.4918543
	speed: 0.0035s/iter; left time: 18.7020s
	iters: 700, epoch: 3 | loss: 0.7082664
	speed: 0.0035s/iter; left time: 18.0690s
	iters: 800, epoch: 3 | loss: 1.7971207
	speed: 0.0035s/iter; left time: 17.6582s
	iters: 900, epoch: 3 | loss: 0.2751503
	speed: 0.0033s/iter; left time: 16.6458s
Updating learning rate to 7.3142371375e-05
Epoch: 3 cost time: 3.4754014015197754
Epoch: 3, Steps: 979 | Train Loss: 0.9271038 Vali Loss: 0.6044064 Best vali loss: 0.5959781

best validation loss 0.5959781166278119

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010602663095, 'e_layers': 3, 'learning_rate': 0.0002333046789, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5587403
	speed: 0.0108s/iter; left time: 41.1618s
	iters: 200, epoch: 1 | loss: 0.4103101
	speed: 0.0046s/iter; left time: 17.1959s
	iters: 300, epoch: 1 | loss: 0.6165735
	speed: 0.0047s/iter; left time: 17.0404s
	iters: 400, epoch: 1 | loss: 0.9353585
	speed: 0.0046s/iter; left time: 16.2050s
Updating learning rate to 0.00022442504828741394
Validation loss decreased (inf --> 0.5995).  Saving model state dict ...
Epoch: 1 cost time: 2.630831003189087
Epoch: 1, Steps: 490 | Train Loss: 0.6302456 Vali Loss: 0.5994784 Best vali loss: 0.5994784
	iters: 100, epoch: 2 | loss: 0.7324893
	speed: 0.0127s/iter; left time: 42.2500s
	iters: 200, epoch: 2 | loss: 1.4558699
	speed: 0.0046s/iter; left time: 14.9537s
	iters: 300, epoch: 2 | loss: 1.0112972
	speed: 0.0047s/iter; left time: 14.6391s
	iters: 400, epoch: 2 | loss: 0.5891436
	speed: 0.0046s/iter; left time: 13.9726s
Updating learning rate to 0.00019913799971637002
Validation loss decreased (0.5995 --> 0.5979).  Saving model state dict ...
Epoch: 2 cost time: 2.3076834678649902
Epoch: 2, Steps: 490 | Train Loss: 0.9472000 Vali Loss: 0.5978674 Best vali loss: 0.5978674
	iters: 100, epoch: 3 | loss: 1.2972796
	speed: 0.0126s/iter; left time: 35.8228s
	iters: 200, epoch: 3 | loss: 1.4377760
	speed: 0.0047s/iter; left time: 12.9317s
	iters: 300, epoch: 3 | loss: 0.9452242
	speed: 0.0048s/iter; left time: 12.5494s
	iters: 400, epoch: 3 | loss: 0.9151106
	speed: 0.0047s/iter; left time: 11.8894s
Updating learning rate to 0.00016129325710414357
Validation loss decreased (0.5979 --> 0.5455).  Saving model state dict ...
Epoch: 3 cost time: 2.353166341781616
Epoch: 3, Steps: 490 | Train Loss: 1.1488476 Vali Loss: 0.5454787 Best vali loss: 0.5454787

best validation loss 0.5454787430747798

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0018227001247, 'e_layers': 2, 'learning_rate': 0.0012639591691, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0012639591691
Validation loss decreased (inf --> 0.5980).  Saving model state dict ...
Epoch: 1 cost time: 0.7566096782684326
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5979850 Best vali loss: 0.5979850
Updating learning rate to 0.00063197958455
Epoch: 2 cost time: 0.4624321460723877
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6020101 Best vali loss: 0.5979850
Updating learning rate to 0.000315989792275
Epoch: 3 cost time: 0.47128987312316895
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6295699 Best vali loss: 0.5979850

best validation loss 0.5979850215252105

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010602663095, 'e_layers': 3, 'learning_rate': 0.0002333046789, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4665477
	speed: 0.0114s/iter; left time: 26.7081s
	iters: 200, epoch: 4 | loss: 0.4022246
	speed: 0.0047s/iter; left time: 10.5772s
	iters: 300, epoch: 4 | loss: 0.5404357
	speed: 0.0047s/iter; left time: 10.2024s
	iters: 400, epoch: 4 | loss: 0.8259551
	speed: 0.0042s/iter; left time: 8.6761s
Updating learning rate to 0.00011665233945
Epoch: 4 cost time: 2.5758440494537354
Epoch: 4, Steps: 490 | Train Loss: 0.5587908 Vali Loss: 0.5649043 Best vali loss: 0.5454787
	iters: 100, epoch: 5 | loss: 0.4953831
	speed: 0.0119s/iter; left time: 22.2155s
	iters: 200, epoch: 5 | loss: 1.2511566
	speed: 0.0046s/iter; left time: 8.1570s
	iters: 300, epoch: 5 | loss: 0.8629424
	speed: 0.0045s/iter; left time: 7.4915s
	iters: 400, epoch: 5 | loss: 0.5361817
	speed: 0.0045s/iter; left time: 7.0454s
Updating learning rate to 7.201142179585643e-05
Epoch: 5 cost time: 2.262026071548462
Epoch: 5, Steps: 490 | Train Loss: 0.7864159 Vali Loss: 0.5712512 Best vali loss: 0.5454787
	iters: 100, epoch: 6 | loss: 1.1232476
	speed: 0.0123s/iter; left time: 16.8348s
	iters: 200, epoch: 6 | loss: 0.9324793
	speed: 0.0047s/iter; left time: 5.9863s
	iters: 300, epoch: 6 | loss: 0.7591807
	speed: 0.0045s/iter; left time: 5.2938s
	iters: 400, epoch: 6 | loss: 0.7716541
	speed: 0.0043s/iter; left time: 4.5746s
Updating learning rate to 3.4166679183629996e-05
Epoch: 6 cost time: 2.2550644874572754
Epoch: 6, Steps: 490 | Train Loss: 0.8966404 Vali Loss: 0.5886288 Best vali loss: 0.5454787
	iters: 100, epoch: 7 | loss: 0.6749201
	speed: 0.0118s/iter; left time: 10.4233s
	iters: 200, epoch: 7 | loss: 1.3119882
	speed: 0.0040s/iter; left time: 3.0988s
	iters: 300, epoch: 7 | loss: 0.5350617
	speed: 0.0039s/iter; left time: 2.6551s
	iters: 400, epoch: 7 | loss: 0.4419961
	speed: 0.0046s/iter; left time: 2.6812s
Updating learning rate to 8.879630612586068e-06
Epoch: 7 cost time: 2.125147581100464
Epoch: 7, Steps: 490 | Train Loss: 0.7409915 Vali Loss: 0.5960085 Best vali loss: 0.5454787
	iters: 100, epoch: 8 | loss: 0.5678350
	speed: 0.0120s/iter; left time: 4.6798s
	iters: 200, epoch: 8 | loss: 0.4853409
	speed: 0.0040s/iter; left time: 1.1509s
	iters: 300, epoch: 8 | loss: 0.4838119
	speed: 0.0041s/iter; left time: 0.7910s
	iters: 400, epoch: 8 | loss: 0.6787568
	speed: 0.0043s/iter; left time: 0.3897s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0514180660247803
Epoch: 8, Steps: 490 | Train Loss: 0.5539362 Vali Loss: 0.6048286 Best vali loss: 0.5454787

best validation loss 0.5454787430747798

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017727959163, 'e_layers': 2, 'learning_rate': 0.0010509529098, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010509529098
Validation loss decreased (inf --> 0.5825).  Saving model state dict ...
Epoch: 1 cost time: 0.7522265911102295
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5824735 Best vali loss: 0.5824735
Updating learning rate to 0.0005254764549
Validation loss decreased (0.5825 --> 0.5588).  Saving model state dict ...
Epoch: 2 cost time: 0.46291613578796387
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5587740 Best vali loss: 0.5587740
Updating learning rate to 0.00026273822745
Validation loss decreased (0.5588 --> 0.5515).  Saving model state dict ...
Epoch: 3 cost time: 0.463759183883667
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5514822 Best vali loss: 0.5514822
Updating learning rate to 0.000131369113725
Validation loss decreased (0.5515 --> 0.5448).  Saving model state dict ...
Epoch: 4 cost time: 0.4648585319519043
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5447685 Best vali loss: 0.5447685
Updating learning rate to 6.56845568625e-05
Validation loss decreased (0.5448 --> 0.5442).  Saving model state dict ...
Epoch: 5 cost time: 0.47167181968688965
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5442266 Best vali loss: 0.5442266
Updating learning rate to 3.284227843125e-05
Epoch: 6 cost time: 0.459486722946167
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5556705 Best vali loss: 0.5442266
Updating learning rate to 1.6421139215625e-05
Epoch: 7 cost time: 0.461047887802124
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5509396 Best vali loss: 0.5442266
Updating learning rate to 8.2105696078125e-06
Epoch: 8 cost time: 0.46018528938293457
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5491310 Best vali loss: 0.5442266

best validation loss 0.5442265680353711

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.010526406376, 'e_layers': 2, 'learning_rate': 0.0003004367544, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7763916
	speed: 0.0117s/iter; left time: 10.3601s
Updating learning rate to 0.00028900206130214013
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0247747898101807
Epoch: 1, Steps: 123 | Train Loss: 0.7763916 Vali Loss: 0.6172191 Best vali loss: 0.6172191
	iters: 100, epoch: 2 | loss: 0.9578977
	speed: 0.0091s/iter; left time: 6.9532s
Updating learning rate to 0.0002564388103769586
Validation loss decreased (0.6172 --> 0.5863).  Saving model state dict ...
Epoch: 2 cost time: 0.7219738960266113
Epoch: 2, Steps: 123 | Train Loss: 0.9578977 Vali Loss: 0.5862550 Best vali loss: 0.5862550
	iters: 100, epoch: 3 | loss: 0.8583136
	speed: 0.0095s/iter; left time: 6.0669s
Updating learning rate to 0.00020770446139120976
Validation loss decreased (0.5863 --> 0.5540).  Saving model state dict ...
Epoch: 3 cost time: 0.7297425270080566
Epoch: 3, Steps: 123 | Train Loss: 0.8583136 Vali Loss: 0.5540246 Best vali loss: 0.5540246
	iters: 100, epoch: 4 | loss: 0.4920965
	speed: 0.0094s/iter; left time: 4.8694s
Updating learning rate to 0.0001502183772
Validation loss decreased (0.5540 --> 0.5533).  Saving model state dict ...
Epoch: 4 cost time: 0.7321953773498535
Epoch: 4, Steps: 123 | Train Loss: 0.4920965 Vali Loss: 0.5532547 Best vali loss: 0.5532547
	iters: 100, epoch: 5 | loss: 0.5554937
	speed: 0.0094s/iter; left time: 3.6835s
Updating learning rate to 9.273229300879026e-05
Validation loss decreased (0.5533 --> 0.5278).  Saving model state dict ...
Epoch: 5 cost time: 0.7280921936035156
Epoch: 5, Steps: 123 | Train Loss: 0.5554937 Vali Loss: 0.5277943 Best vali loss: 0.5277943
	iters: 100, epoch: 6 | loss: 0.5850881
	speed: 0.0093s/iter; left time: 2.5245s
Updating learning rate to 4.399794402304135e-05
Epoch: 6 cost time: 0.7239055633544922
Epoch: 6, Steps: 123 | Train Loss: 0.5850881 Vali Loss: 0.5414165 Best vali loss: 0.5277943
	iters: 100, epoch: 7 | loss: 0.5357832
	speed: 0.0092s/iter; left time: 1.3506s
Updating learning rate to 1.1434693097859866e-05
Epoch: 7 cost time: 0.7222504615783691
Epoch: 7, Steps: 123 | Train Loss: 0.5357832 Vali Loss: 0.5403252 Best vali loss: 0.5277943
	iters: 100, epoch: 8 | loss: 0.7017008
	speed: 0.0091s/iter; left time: 0.2183s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7223448753356934
Epoch: 8, Steps: 123 | Train Loss: 0.7017008 Vali Loss: 0.5463752 Best vali loss: 0.5277943

best validation loss 0.5277943487853598

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022322709383, 'e_layers': 2, 'learning_rate': 0.0002977020662, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7748476
	speed: 0.0116s/iter; left time: 10.2572s
Updating learning rate to 0.0002863714559742501
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0282185077667236
Epoch: 1, Steps: 123 | Train Loss: 0.7748476 Vali Loss: 0.6172898 Best vali loss: 0.6172898
	iters: 100, epoch: 2 | loss: 0.9545662
	speed: 0.0092s/iter; left time: 7.0376s
Updating learning rate to 0.0002541046079916332
Validation loss decreased (0.6173 --> 0.5925).  Saving model state dict ...
Epoch: 2 cost time: 0.7205650806427002
Epoch: 2, Steps: 123 | Train Loss: 0.9545662 Vali Loss: 0.5924932 Best vali loss: 0.5924932
	iters: 100, epoch: 3 | loss: 0.8522007
	speed: 0.0094s/iter; left time: 6.0385s
Updating learning rate to 0.0002058138573577976
Validation loss decreased (0.5925 --> 0.5436).  Saving model state dict ...
Epoch: 3 cost time: 0.7207093238830566
Epoch: 3, Steps: 123 | Train Loss: 0.8522007 Vali Loss: 0.5436409 Best vali loss: 0.5436409

best validation loss 0.5436409419744669

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021472806532, 'e_layers': 2, 'learning_rate': 0.0002903352297, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7736769
	speed: 0.0115s/iter; left time: 10.2178s
Updating learning rate to 0.0002792850029933965
Validation loss decreased (inf --> 0.6168).  Saving model state dict ...
Epoch: 1 cost time: 1.021629810333252
Epoch: 1, Steps: 123 | Train Loss: 0.7736769 Vali Loss: 0.6167792 Best vali loss: 0.6167792
	iters: 100, epoch: 2 | loss: 0.9454339
	speed: 0.0093s/iter; left time: 7.0539s
Updating learning rate to 0.00024781661971911195
Validation loss decreased (0.6168 --> 0.5530).  Saving model state dict ...
Epoch: 2 cost time: 0.723912239074707
Epoch: 2, Steps: 123 | Train Loss: 0.9454339 Vali Loss: 0.5530288 Best vali loss: 0.5530288
	iters: 100, epoch: 3 | loss: 0.8412241
	speed: 0.0095s/iter; left time: 6.0904s
Updating learning rate to 0.00020072085596905138
Validation loss decreased (0.5530 --> 0.5367).  Saving model state dict ...
Epoch: 3 cost time: 0.7373690605163574
Epoch: 3, Steps: 123 | Train Loss: 0.8412241 Vali Loss: 0.5366598 Best vali loss: 0.5366598

best validation loss 0.5366598177375422

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.002132223649, 'e_layers': 2, 'learning_rate': 0.0002793486638, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7725806
	speed: 0.0117s/iter; left time: 10.3874s
Updating learning rate to 0.0002687165883595983
Validation loss decreased (inf --> 0.6161).  Saving model state dict ...
Epoch: 1 cost time: 1.0360069274902344
Epoch: 1, Steps: 123 | Train Loss: 0.7725806 Vali Loss: 0.6161214 Best vali loss: 0.6161214
	iters: 100, epoch: 2 | loss: 0.9317164
	speed: 0.0093s/iter; left time: 7.0814s
Updating learning rate to 0.0002384389991441905
Validation loss decreased (0.6161 --> 0.5606).  Saving model state dict ...
Epoch: 2 cost time: 0.7256205081939697
Epoch: 2, Steps: 123 | Train Loss: 0.9317164 Vali Loss: 0.5606164 Best vali loss: 0.5606164
	iters: 100, epoch: 3 | loss: 0.8580016
	speed: 0.0093s/iter; left time: 5.9442s
Updating learning rate to 0.00019312538464479276
Validation loss decreased (0.5606 --> 0.5526).  Saving model state dict ...
Epoch: 3 cost time: 0.7282426357269287
Epoch: 3, Steps: 123 | Train Loss: 0.8580016 Vali Loss: 0.5525521 Best vali loss: 0.5525521

best validation loss 0.552552092356684

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021472806532, 'e_layers': 2, 'learning_rate': 0.0002903352297, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5835612
	speed: 0.0120s/iter; left time: 6.2155s
Updating learning rate to 0.00014516761485
Validation loss decreased (0.5367 --> 0.5287).  Saving model state dict ...
Epoch: 4 cost time: 1.0380923748016357
Epoch: 4, Steps: 123 | Train Loss: 0.5835612 Vali Loss: 0.5286734 Best vali loss: 0.5286734
	iters: 100, epoch: 5 | loss: 0.8196926
	speed: 0.0093s/iter; left time: 3.6677s
Updating learning rate to 8.961437373094863e-05
Epoch: 5 cost time: 0.7199292182922363
Epoch: 5, Steps: 123 | Train Loss: 0.8196926 Vali Loss: 0.5362428 Best vali loss: 0.5286734
	iters: 100, epoch: 6 | loss: 0.7556733
	speed: 0.0091s/iter; left time: 2.4586s
Updating learning rate to 4.251860998088805e-05
Epoch: 6 cost time: 0.7264549732208252
Epoch: 6, Steps: 123 | Train Loss: 0.7556733 Vali Loss: 0.5433134 Best vali loss: 0.5286734
	iters: 100, epoch: 7 | loss: 0.4354607
	speed: 0.0091s/iter; left time: 1.3347s
Updating learning rate to 1.1050226706603473e-05
Epoch: 7 cost time: 0.7190392017364502
Epoch: 7, Steps: 123 | Train Loss: 0.4354607 Vali Loss: 0.5559502 Best vali loss: 0.5286734
	iters: 100, epoch: 8 | loss: 0.5081146
	speed: 0.0090s/iter; left time: 0.2158s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.718355655670166
Epoch: 8, Steps: 123 | Train Loss: 0.5081146 Vali Loss: 0.5517046 Best vali loss: 0.5286734

best validation loss 0.5286734156010604

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045463403253, 'e_layers': 1, 'learning_rate': 0.000135104334, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6501467
	speed: 0.0087s/iter; left time: 33.3291s
	iters: 200, epoch: 1 | loss: 0.7244094
	speed: 0.0027s/iter; left time: 9.8637s
	iters: 300, epoch: 1 | loss: 0.9718246
	speed: 0.0025s/iter; left time: 9.1702s
	iters: 400, epoch: 1 | loss: 0.6464210
	speed: 0.0025s/iter; left time: 8.6741s
Updating learning rate to 0.000135104334
Validation loss decreased (inf --> 0.6025).  Saving model state dict ...
Epoch: 1 cost time: 1.6086397171020508
Epoch: 1, Steps: 490 | Train Loss: 0.7482004 Vali Loss: 0.6024726 Best vali loss: 0.6024726
	iters: 100, epoch: 2 | loss: 1.2634764
	speed: 0.0081s/iter; left time: 27.0398s
	iters: 200, epoch: 2 | loss: 0.9183723
	speed: 0.0028s/iter; left time: 8.9688s
	iters: 300, epoch: 2 | loss: 0.4357047
	speed: 0.0028s/iter; left time: 8.8073s
	iters: 400, epoch: 2 | loss: 0.4902032
	speed: 0.0028s/iter; left time: 8.4835s
Updating learning rate to 6.7552167e-05
Epoch: 2 cost time: 1.4103364944458008
Epoch: 2, Steps: 490 | Train Loss: 0.7769391 Vali Loss: 0.6069090 Best vali loss: 0.6024726
	iters: 100, epoch: 3 | loss: 0.7985689
	speed: 0.0086s/iter; left time: 24.4403s
	iters: 200, epoch: 3 | loss: 0.6389423
	speed: 0.0027s/iter; left time: 7.4873s
	iters: 300, epoch: 3 | loss: 0.7227913
	speed: 0.0026s/iter; left time: 6.9665s
	iters: 400, epoch: 3 | loss: 0.7598959
	speed: 0.0027s/iter; left time: 6.8006s
Updating learning rate to 3.37760835e-05
Epoch: 3 cost time: 1.3796205520629883
Epoch: 3, Steps: 490 | Train Loss: 0.7300496 Vali Loss: 0.6143242 Best vali loss: 0.6024726
	iters: 100, epoch: 4 | loss: 0.8051328
	speed: 0.0080s/iter; left time: 18.8918s
	iters: 200, epoch: 4 | loss: 0.7441324
	speed: 0.0025s/iter; left time: 5.7366s
	iters: 300, epoch: 4 | loss: 1.2818675
	speed: 0.0026s/iter; left time: 5.5633s
	iters: 400, epoch: 4 | loss: 0.5650536
	speed: 0.0028s/iter; left time: 5.7069s
Updating learning rate to 1.688804175e-05
Epoch: 4 cost time: 1.3586299419403076
Epoch: 4, Steps: 490 | Train Loss: 0.8490466 Vali Loss: 0.6149679 Best vali loss: 0.6024726
	iters: 100, epoch: 5 | loss: 0.7337233
	speed: 0.0085s/iter; left time: 15.7272s
	iters: 200, epoch: 5 | loss: 0.6979196
	speed: 0.0027s/iter; left time: 4.8274s
	iters: 300, epoch: 5 | loss: 0.9278378
	speed: 0.0028s/iter; left time: 4.6249s
	iters: 400, epoch: 5 | loss: 0.2949820
	speed: 0.0028s/iter; left time: 4.3116s
Updating learning rate to 8.444020875e-06
Epoch: 5 cost time: 1.370074987411499
Epoch: 5, Steps: 490 | Train Loss: 0.6636157 Vali Loss: 0.6108867 Best vali loss: 0.6024726
	iters: 100, epoch: 6 | loss: 1.0630083
	speed: 0.0082s/iter; left time: 11.1822s
	iters: 200, epoch: 6 | loss: 0.4090008
	speed: 0.0028s/iter; left time: 3.4957s
	iters: 300, epoch: 6 | loss: 0.4750199
	speed: 0.0028s/iter; left time: 3.2257s
	iters: 400, epoch: 6 | loss: 0.4467455
	speed: 0.0027s/iter; left time: 2.8523s
Updating learning rate to 4.2220104375e-06
Epoch: 6 cost time: 1.3637416362762451
Epoch: 6, Steps: 490 | Train Loss: 0.5984436 Vali Loss: 0.6143872 Best vali loss: 0.6024726
	iters: 100, epoch: 7 | loss: 0.5619692
	speed: 0.0079s/iter; left time: 6.9184s
	iters: 200, epoch: 7 | loss: 0.5220874
	speed: 0.0024s/iter; left time: 1.9071s
	iters: 300, epoch: 7 | loss: 0.9628580
	speed: 0.0025s/iter; left time: 1.6690s
	iters: 400, epoch: 7 | loss: 0.8936623
	speed: 0.0025s/iter; left time: 1.4508s
Updating learning rate to 2.11100521875e-06
Epoch: 7 cost time: 1.2560646533966064
Epoch: 7, Steps: 490 | Train Loss: 0.7351442 Vali Loss: 0.6131207 Best vali loss: 0.6024726
	iters: 100, epoch: 8 | loss: 0.6572507
	speed: 0.0081s/iter; left time: 3.1794s
	iters: 200, epoch: 8 | loss: 0.5163782
	speed: 0.0027s/iter; left time: 0.7933s
	iters: 300, epoch: 8 | loss: 0.5813733
	speed: 0.0025s/iter; left time: 0.4783s
	iters: 400, epoch: 8 | loss: 0.5331244
	speed: 0.0026s/iter; left time: 0.2327s
Updating learning rate to 1.055502609375e-06
Epoch: 8 cost time: 1.3395237922668457
Epoch: 8, Steps: 490 | Train Loss: 0.5720316 Vali Loss: 0.6144131 Best vali loss: 0.6024726

best validation loss 0.6024725911298432

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0044569563553, 'e_layers': 3, 'learning_rate': 0.0004304920175, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3679982
	speed: 0.0103s/iter; left time: 79.6177s
	iters: 200, epoch: 1 | loss: 1.3392303
	speed: 0.0040s/iter; left time: 30.5304s
	iters: 300, epoch: 1 | loss: 1.0569049
	speed: 0.0038s/iter; left time: 28.8737s
	iters: 400, epoch: 1 | loss: 0.4977782
	speed: 0.0039s/iter; left time: 28.9689s
	iters: 500, epoch: 1 | loss: 0.3804144
	speed: 0.0039s/iter; left time: 28.2694s
	iters: 600, epoch: 1 | loss: 1.7479700
	speed: 0.0039s/iter; left time: 28.4043s
	iters: 700, epoch: 1 | loss: 1.0817322
	speed: 0.0039s/iter; left time: 27.5294s
	iters: 800, epoch: 1 | loss: 0.4880208
	speed: 0.0038s/iter; left time: 26.4390s
	iters: 900, epoch: 1 | loss: 1.5229230
	speed: 0.0038s/iter; left time: 26.4854s
Updating learning rate to 0.0004304920175
Validation loss decreased (inf --> 0.6132).  Saving model state dict ...
Epoch: 1 cost time: 4.189236402511597
Epoch: 1, Steps: 979 | Train Loss: 0.9425524 Vali Loss: 0.6131785 Best vali loss: 0.6131785
	iters: 100, epoch: 2 | loss: 0.3070238
	speed: 0.0136s/iter; left time: 91.6209s
	iters: 200, epoch: 2 | loss: 0.3007553
	speed: 0.0043s/iter; left time: 28.5179s
	iters: 300, epoch: 2 | loss: 0.6417732
	speed: 0.0044s/iter; left time: 28.5658s
	iters: 400, epoch: 2 | loss: 1.8836845
	speed: 0.0044s/iter; left time: 28.4614s
	iters: 500, epoch: 2 | loss: 1.0824111
	speed: 0.0044s/iter; left time: 28.2356s
	iters: 600, epoch: 2 | loss: 0.4271191
	speed: 0.0044s/iter; left time: 27.5889s
	iters: 700, epoch: 2 | loss: 0.8031913
	speed: 0.0044s/iter; left time: 26.8797s
	iters: 800, epoch: 2 | loss: 0.3253430
	speed: 0.0040s/iter; left time: 24.3287s
	iters: 900, epoch: 2 | loss: 0.5883548
	speed: 0.0040s/iter; left time: 24.0125s
Updating learning rate to 0.00021524600875
Epoch: 2 cost time: 4.224653482437134
Epoch: 2, Steps: 979 | Train Loss: 0.7066284 Vali Loss: 0.6159015 Best vali loss: 0.6131785
	iters: 100, epoch: 3 | loss: 1.3080345
	speed: 0.0133s/iter; left time: 76.9876s
	iters: 200, epoch: 3 | loss: 1.2894338
	speed: 0.0042s/iter; left time: 23.9203s
	iters: 300, epoch: 3 | loss: 1.0920449
	speed: 0.0043s/iter; left time: 24.2202s
	iters: 400, epoch: 3 | loss: 0.6070998
	speed: 0.0043s/iter; left time: 23.5799s
	iters: 500, epoch: 3 | loss: 1.1835723
	speed: 0.0042s/iter; left time: 22.8237s
	iters: 600, epoch: 3 | loss: 0.3490988
	speed: 0.0041s/iter; left time: 21.8090s
	iters: 700, epoch: 3 | loss: 0.3254145
	speed: 0.0043s/iter; left time: 22.2786s
	iters: 800, epoch: 3 | loss: 1.1186014
	speed: 0.0043s/iter; left time: 21.7362s
	iters: 900, epoch: 3 | loss: 0.5709477
	speed: 0.0043s/iter; left time: 21.4984s
Updating learning rate to 0.000107623004375
Validation loss decreased (0.6132 --> 0.6085).  Saving model state dict ...
Epoch: 3 cost time: 4.221240282058716
Epoch: 3, Steps: 979 | Train Loss: 0.8715831 Vali Loss: 0.6085198 Best vali loss: 0.6085198
	iters: 100, epoch: 4 | loss: 0.2963172
	speed: 0.0132s/iter; left time: 63.3082s
	iters: 200, epoch: 4 | loss: 1.1159685
	speed: 0.0041s/iter; left time: 19.3942s
	iters: 300, epoch: 4 | loss: 1.0771457
	speed: 0.0044s/iter; left time: 19.9945s
	iters: 400, epoch: 4 | loss: 0.5745164
	speed: 0.0044s/iter; left time: 19.5779s
	iters: 500, epoch: 4 | loss: 0.9735379
	speed: 0.0043s/iter; left time: 18.8850s
	iters: 600, epoch: 4 | loss: 0.3480749
	speed: 0.0043s/iter; left time: 18.3521s
	iters: 700, epoch: 4 | loss: 0.6962720
	speed: 0.0043s/iter; left time: 18.1026s
	iters: 800, epoch: 4 | loss: 0.7999777
	speed: 0.0043s/iter; left time: 17.5288s
	iters: 900, epoch: 4 | loss: 0.6562342
	speed: 0.0043s/iter; left time: 17.0299s
Updating learning rate to 5.38115021875e-05
Validation loss decreased (0.6085 --> 0.6062).  Saving model state dict ...
Epoch: 4 cost time: 4.22059965133667
Epoch: 4, Steps: 979 | Train Loss: 0.7264494 Vali Loss: 0.6061666 Best vali loss: 0.6061666
	iters: 100, epoch: 5 | loss: 0.7148442
	speed: 0.0135s/iter; left time: 51.5367s
	iters: 200, epoch: 5 | loss: 0.7999843
	speed: 0.0043s/iter; left time: 15.9094s
	iters: 300, epoch: 5 | loss: 0.5957705
	speed: 0.0043s/iter; left time: 15.6144s
	iters: 400, epoch: 5 | loss: 1.9397362
	speed: 0.0043s/iter; left time: 15.1596s
	iters: 500, epoch: 5 | loss: 0.6162257
	speed: 0.0043s/iter; left time: 14.8353s
	iters: 600, epoch: 5 | loss: 1.7260754
	speed: 0.0044s/iter; left time: 14.5710s
	iters: 700, epoch: 5 | loss: 1.2593066
	speed: 0.0043s/iter; left time: 13.9278s
	iters: 800, epoch: 5 | loss: 1.5357859
	speed: 0.0044s/iter; left time: 13.5891s
	iters: 900, epoch: 5 | loss: 0.7175257
	speed: 0.0044s/iter; left time: 13.1965s
Updating learning rate to 2.690575109375e-05
Epoch: 5 cost time: 4.284634828567505
Epoch: 5, Steps: 979 | Train Loss: 1.1005838 Vali Loss: 0.6151785 Best vali loss: 0.6061666
	iters: 100, epoch: 6 | loss: 0.9239581
	speed: 0.0137s/iter; left time: 38.8448s
	iters: 200, epoch: 6 | loss: 0.6248292
	speed: 0.0041s/iter; left time: 11.1931s
	iters: 300, epoch: 6 | loss: 1.1604297
	speed: 0.0043s/iter; left time: 11.2552s
	iters: 400, epoch: 6 | loss: 0.8683683
	speed: 0.0043s/iter; left time: 10.9528s
	iters: 500, epoch: 6 | loss: 0.2619869
	speed: 0.0044s/iter; left time: 10.6433s
	iters: 600, epoch: 6 | loss: 1.1550318
	speed: 0.0042s/iter; left time: 9.8200s
	iters: 700, epoch: 6 | loss: 1.4367285
	speed: 0.0042s/iter; left time: 9.3969s
	iters: 800, epoch: 6 | loss: 0.4859675
	speed: 0.0043s/iter; left time: 9.1940s
	iters: 900, epoch: 6 | loss: 0.4846444
	speed: 0.0043s/iter; left time: 8.8530s
Updating learning rate to 1.3452875546875e-05
Epoch: 6 cost time: 4.229052305221558
Epoch: 6, Steps: 979 | Train Loss: 0.8224383 Vali Loss: 0.6126845 Best vali loss: 0.6061666
	iters: 100, epoch: 7 | loss: 0.5350989
	speed: 0.0136s/iter; left time: 25.2068s
	iters: 200, epoch: 7 | loss: 1.7210557
	speed: 0.0039s/iter; left time: 6.9267s
	iters: 300, epoch: 7 | loss: 0.8726789
	speed: 0.0041s/iter; left time: 6.7723s
	iters: 400, epoch: 7 | loss: 1.0261710
	speed: 0.0040s/iter; left time: 6.2881s
	iters: 500, epoch: 7 | loss: 0.3310744
	speed: 0.0040s/iter; left time: 5.8793s
	iters: 600, epoch: 7 | loss: 0.8559611
	speed: 0.0040s/iter; left time: 5.4797s
	iters: 700, epoch: 7 | loss: 0.7760317
	speed: 0.0039s/iter; left time: 4.9095s
	iters: 800, epoch: 7 | loss: 0.9580899
	speed: 0.0040s/iter; left time: 4.5849s
	iters: 900, epoch: 7 | loss: 1.1296958
	speed: 0.0040s/iter; left time: 4.2254s
Updating learning rate to 6.7264377734375e-06
Epoch: 7 cost time: 3.9575464725494385
Epoch: 7, Steps: 979 | Train Loss: 0.9117619 Vali Loss: 0.6124733 Best vali loss: 0.6061666
	iters: 100, epoch: 8 | loss: 0.7045044
	speed: 0.0131s/iter; left time: 11.5670s
	iters: 200, epoch: 8 | loss: 1.2191978
	speed: 0.0044s/iter; left time: 3.4000s
	iters: 300, epoch: 8 | loss: 1.3814309
	speed: 0.0042s/iter; left time: 2.8897s
	iters: 400, epoch: 8 | loss: 0.7525204
	speed: 0.0044s/iter; left time: 2.5447s
	iters: 500, epoch: 8 | loss: 1.0024728
	speed: 0.0044s/iter; left time: 2.1134s
	iters: 600, epoch: 8 | loss: 0.5430224
	speed: 0.0042s/iter; left time: 1.6036s
	iters: 700, epoch: 8 | loss: 0.7916233
	speed: 0.0042s/iter; left time: 1.1682s
	iters: 800, epoch: 8 | loss: 0.9430509
	speed: 0.0043s/iter; left time: 0.7719s
	iters: 900, epoch: 8 | loss: 1.4011593
	speed: 0.0042s/iter; left time: 0.3389s
Updating learning rate to 3.36321888671875e-06
Epoch: 8 cost time: 4.2577431201934814
Epoch: 8, Steps: 979 | Train Loss: 0.9709980 Vali Loss: 0.6128090 Best vali loss: 0.6061666

best validation loss 0.6061665832803295

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010888593332, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7743747
	speed: 0.0117s/iter; left time: 10.3515s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0273079872131348
Epoch: 1, Steps: 123 | Train Loss: 0.7743747 Vali Loss: 0.6172996 Best vali loss: 0.6172996
	iters: 100, epoch: 2 | loss: 0.9438657
	speed: 0.0091s/iter; left time: 6.9168s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5563).  Saving model state dict ...
Epoch: 2 cost time: 0.7165060043334961
Epoch: 2, Steps: 123 | Train Loss: 0.9438657 Vali Loss: 0.5562935 Best vali loss: 0.5562935
	iters: 100, epoch: 3 | loss: 0.8431522
	speed: 0.0095s/iter; left time: 6.0575s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5563 --> 0.5424).  Saving model state dict ...
Epoch: 3 cost time: 0.7241339683532715
Epoch: 3, Steps: 123 | Train Loss: 0.8431522 Vali Loss: 0.5424260 Best vali loss: 0.5424260

best validation loss 0.5424259931386923

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010890038917, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744145
	speed: 0.0118s/iter; left time: 10.4614s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.029611349105835
Epoch: 1, Steps: 123 | Train Loss: 0.7744145 Vali Loss: 0.6172102 Best vali loss: 0.6172102
	iters: 100, epoch: 2 | loss: 0.9428591
	speed: 0.0092s/iter; left time: 7.0439s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6172 --> 0.5667).  Saving model state dict ...
Epoch: 2 cost time: 0.7199404239654541
Epoch: 2, Steps: 123 | Train Loss: 0.9428591 Vali Loss: 0.5667189 Best vali loss: 0.5667189
	iters: 100, epoch: 3 | loss: 0.8478416
	speed: 0.0093s/iter; left time: 5.9396s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5667 --> 0.5409).  Saving model state dict ...
Epoch: 3 cost time: 0.7158634662628174
Epoch: 3, Steps: 123 | Train Loss: 0.8478416 Vali Loss: 0.5408592 Best vali loss: 0.5408592

best validation loss 0.5408592258322741

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001049569184, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745714
	speed: 0.0119s/iter; left time: 10.5480s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0245964527130127
Epoch: 1, Steps: 123 | Train Loss: 0.7745714 Vali Loss: 0.6173343 Best vali loss: 0.6173343
	iters: 100, epoch: 2 | loss: 0.9465801
	speed: 0.0093s/iter; left time: 7.0622s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5801).  Saving model state dict ...
Epoch: 2 cost time: 0.7202985286712646
Epoch: 2, Steps: 123 | Train Loss: 0.9465801 Vali Loss: 0.5800643 Best vali loss: 0.5800643
	iters: 100, epoch: 3 | loss: 0.8501413
	speed: 0.0095s/iter; left time: 6.0748s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5801 --> 0.5443).  Saving model state dict ...
Epoch: 3 cost time: 0.72501540184021
Epoch: 3, Steps: 123 | Train Loss: 0.8501413 Vali Loss: 0.5442788 Best vali loss: 0.5442788

best validation loss 0.5442788408675275

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010890038917, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5878382
	speed: 0.0121s/iter; left time: 6.2204s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5409 --> 0.5296).  Saving model state dict ...
Epoch: 4 cost time: 1.0334765911102295
Epoch: 4, Steps: 123 | Train Loss: 0.5878382 Vali Loss: 0.5296385 Best vali loss: 0.5296385
	iters: 100, epoch: 5 | loss: 0.8251672
	speed: 0.0092s/iter; left time: 3.6244s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5296 --> 0.5262).  Saving model state dict ...
Epoch: 5 cost time: 0.7153489589691162
Epoch: 5, Steps: 123 | Train Loss: 0.8251672 Vali Loss: 0.5262182 Best vali loss: 0.5262182
	iters: 100, epoch: 6 | loss: 0.7603425
	speed: 0.0091s/iter; left time: 2.4669s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7143871784210205
Epoch: 6, Steps: 123 | Train Loss: 0.7603425 Vali Loss: 0.5370854 Best vali loss: 0.5262182
	iters: 100, epoch: 7 | loss: 0.4332163
	speed: 0.0088s/iter; left time: 1.2979s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7126302719116211
Epoch: 7, Steps: 123 | Train Loss: 0.4332163 Vali Loss: 0.5394159 Best vali loss: 0.5262182
	iters: 100, epoch: 8 | loss: 0.5090656
	speed: 0.0088s/iter; left time: 0.2111s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7076115608215332
Epoch: 8, Steps: 123 | Train Loss: 0.5090656 Vali Loss: 0.5356292 Best vali loss: 0.5262182

best validation loss 0.526218178535931

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010797445631, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4385079
	speed: 0.0099s/iter; left time: 76.4404s
	iters: 200, epoch: 1 | loss: 1.3947177
	speed: 0.0034s/iter; left time: 25.7770s
	iters: 300, epoch: 1 | loss: 0.8506533
	speed: 0.0034s/iter; left time: 25.3447s
	iters: 400, epoch: 1 | loss: 1.3924929
	speed: 0.0036s/iter; left time: 27.0329s
	iters: 500, epoch: 1 | loss: 0.9659061
	speed: 0.0034s/iter; left time: 25.2391s
	iters: 600, epoch: 1 | loss: 1.6766505
	speed: 0.0035s/iter; left time: 25.1514s
	iters: 700, epoch: 1 | loss: 0.8010889
	speed: 0.0034s/iter; left time: 24.4700s
	iters: 800, epoch: 1 | loss: 0.7001350
	speed: 0.0034s/iter; left time: 23.8193s
	iters: 900, epoch: 1 | loss: 1.0501904
	speed: 0.0033s/iter; left time: 23.0701s
Updating learning rate to 0.0002978326994
Validation loss decreased (inf --> 0.6097).  Saving model state dict ...
Epoch: 1 cost time: 3.7385969161987305
Epoch: 1, Steps: 979 | Train Loss: 1.0300381 Vali Loss: 0.6096874 Best vali loss: 0.6096874
	iters: 100, epoch: 2 | loss: 1.0460905
	speed: 0.0121s/iter; left time: 81.7511s
	iters: 200, epoch: 2 | loss: 0.3993331
	speed: 0.0034s/iter; left time: 22.3670s
	iters: 300, epoch: 2 | loss: 0.4423860
	speed: 0.0033s/iter; left time: 21.9153s
	iters: 400, epoch: 2 | loss: 1.4639627
	speed: 0.0033s/iter; left time: 21.4675s
	iters: 500, epoch: 2 | loss: 1.0023704
	speed: 0.0032s/iter; left time: 20.3336s
	iters: 600, epoch: 2 | loss: 1.4647645
	speed: 0.0033s/iter; left time: 20.3744s
	iters: 700, epoch: 2 | loss: 1.0777826
	speed: 0.0032s/iter; left time: 19.7267s
	iters: 800, epoch: 2 | loss: 0.3003904
	speed: 0.0032s/iter; left time: 19.4843s
	iters: 900, epoch: 2 | loss: 0.8857349
	speed: 0.0033s/iter; left time: 19.5401s
Updating learning rate to 0.0001489163497
Epoch: 2 cost time: 3.2709977626800537
Epoch: 2, Steps: 979 | Train Loss: 0.8980906 Vali Loss: 0.6243615 Best vali loss: 0.6096874
	iters: 100, epoch: 3 | loss: 0.7281994
	speed: 0.0111s/iter; left time: 64.2194s
	iters: 200, epoch: 3 | loss: 0.6719444
	speed: 0.0032s/iter; left time: 18.3878s
	iters: 300, epoch: 3 | loss: 1.3331549
	speed: 0.0033s/iter; left time: 18.1672s
	iters: 400, epoch: 3 | loss: 1.1020844
	speed: 0.0032s/iter; left time: 17.7788s
	iters: 500, epoch: 3 | loss: 1.0438169
	speed: 0.0032s/iter; left time: 16.9694s
	iters: 600, epoch: 3 | loss: 0.4916157
	speed: 0.0031s/iter; left time: 16.3294s
	iters: 700, epoch: 3 | loss: 0.7075253
	speed: 0.0032s/iter; left time: 16.3417s
	iters: 800, epoch: 3 | loss: 1.6853312
	speed: 0.0034s/iter; left time: 17.1432s
	iters: 900, epoch: 3 | loss: 0.3014892
	speed: 0.0032s/iter; left time: 15.8384s
Updating learning rate to 7.445817485e-05
Epoch: 3 cost time: 3.1809520721435547
Epoch: 3, Steps: 979 | Train Loss: 0.8961290 Vali Loss: 0.6368101 Best vali loss: 0.6096874
	iters: 100, epoch: 4 | loss: 0.9571669
	speed: 0.0111s/iter; left time: 53.3791s
	iters: 200, epoch: 4 | loss: 0.2553868
	speed: 0.0034s/iter; left time: 16.0746s
	iters: 300, epoch: 4 | loss: 0.8726097
	speed: 0.0035s/iter; left time: 16.1328s
	iters: 400, epoch: 4 | loss: 0.3084987
	speed: 0.0035s/iter; left time: 15.8429s
	iters: 500, epoch: 4 | loss: 0.5299857
	speed: 0.0035s/iter; left time: 15.4876s
	iters: 600, epoch: 4 | loss: 0.7853389
	speed: 0.0034s/iter; left time: 14.6707s
	iters: 700, epoch: 4 | loss: 1.1931443
	speed: 0.0033s/iter; left time: 13.8006s
	iters: 800, epoch: 4 | loss: 0.2822390
	speed: 0.0034s/iter; left time: 13.9598s
	iters: 900, epoch: 4 | loss: 1.0890876
	speed: 0.0035s/iter; left time: 13.9997s
Updating learning rate to 3.7229087425e-05
Epoch: 4 cost time: 3.418748378753662
Epoch: 4, Steps: 979 | Train Loss: 0.6970509 Vali Loss: 0.6403308 Best vali loss: 0.6096874
	iters: 100, epoch: 5 | loss: 0.9215299
	speed: 0.0109s/iter; left time: 41.5965s
	iters: 200, epoch: 5 | loss: 0.5869576
	speed: 0.0034s/iter; left time: 12.4642s
	iters: 300, epoch: 5 | loss: 1.1230904
	speed: 0.0031s/iter; left time: 11.3249s
	iters: 400, epoch: 5 | loss: 0.9080295
	speed: 0.0033s/iter; left time: 11.5076s
	iters: 500, epoch: 5 | loss: 0.3438454
	speed: 0.0031s/iter; left time: 10.6167s
	iters: 600, epoch: 5 | loss: 1.0724272
	speed: 0.0033s/iter; left time: 11.0037s
	iters: 700, epoch: 5 | loss: 0.6743934
	speed: 0.0033s/iter; left time: 10.5915s
	iters: 800, epoch: 5 | loss: 0.4432362
	speed: 0.0033s/iter; left time: 10.2174s
	iters: 900, epoch: 5 | loss: 0.6225996
	speed: 0.0033s/iter; left time: 10.0214s
Updating learning rate to 1.86145437125e-05
Epoch: 5 cost time: 3.2376773357391357
Epoch: 5, Steps: 979 | Train Loss: 0.7440121 Vali Loss: 0.6406981 Best vali loss: 0.6096874
	iters: 100, epoch: 6 | loss: 1.1320324
	speed: 0.0112s/iter; left time: 31.8131s
	iters: 200, epoch: 6 | loss: 0.4007719
	speed: 0.0032s/iter; left time: 8.8853s
	iters: 300, epoch: 6 | loss: 1.1050242
	speed: 0.0033s/iter; left time: 8.7943s
	iters: 400, epoch: 6 | loss: 0.3340128
	speed: 0.0033s/iter; left time: 8.3879s
	iters: 500, epoch: 6 | loss: 0.4892068
	speed: 0.0032s/iter; left time: 7.7661s
	iters: 600, epoch: 6 | loss: 1.0085837
	speed: 0.0033s/iter; left time: 7.7543s
	iters: 700, epoch: 6 | loss: 1.1722383
	speed: 0.0034s/iter; left time: 7.6275s
	iters: 800, epoch: 6 | loss: 0.7331204
	speed: 0.0034s/iter; left time: 7.2101s
	iters: 900, epoch: 6 | loss: 0.4454341
	speed: 0.0031s/iter; left time: 6.4112s
Updating learning rate to 9.30727185625e-06
Epoch: 6 cost time: 3.260822057723999
Epoch: 6, Steps: 979 | Train Loss: 0.7578250 Vali Loss: 0.6449222 Best vali loss: 0.6096874
	iters: 100, epoch: 7 | loss: 0.8348402
	speed: 0.0111s/iter; left time: 20.6005s
	iters: 200, epoch: 7 | loss: 0.7359274
	speed: 0.0032s/iter; left time: 5.6009s
	iters: 300, epoch: 7 | loss: 0.5182246
	speed: 0.0031s/iter; left time: 5.0896s
	iters: 400, epoch: 7 | loss: 1.0420139
	speed: 0.0031s/iter; left time: 4.8406s
	iters: 500, epoch: 7 | loss: 0.3105842
	speed: 0.0031s/iter; left time: 4.4700s
	iters: 600, epoch: 7 | loss: 0.4750547
	speed: 0.0031s/iter; left time: 4.1544s
	iters: 700, epoch: 7 | loss: 0.7781866
	speed: 0.0032s/iter; left time: 4.0397s
	iters: 800, epoch: 7 | loss: 0.8428507
	speed: 0.0034s/iter; left time: 3.9551s
	iters: 900, epoch: 7 | loss: 0.6564689
	speed: 0.0033s/iter; left time: 3.4742s
Updating learning rate to 4.653635928125e-06
Epoch: 7 cost time: 3.14922833442688
Epoch: 7, Steps: 979 | Train Loss: 0.6882390 Vali Loss: 0.6444434 Best vali loss: 0.6096874
	iters: 100, epoch: 8 | loss: 0.4906062
	speed: 0.0110s/iter; left time: 9.7183s
	iters: 200, epoch: 8 | loss: 0.5605304
	speed: 0.0032s/iter; left time: 2.5319s
	iters: 300, epoch: 8 | loss: 0.8917130
	speed: 0.0033s/iter; left time: 2.2102s
	iters: 400, epoch: 8 | loss: 0.2929010
	speed: 0.0032s/iter; left time: 1.8804s
	iters: 500, epoch: 8 | loss: 0.8618311
	speed: 0.0033s/iter; left time: 1.5627s
	iters: 600, epoch: 8 | loss: 1.1029118
	speed: 0.0033s/iter; left time: 1.2447s
	iters: 700, epoch: 8 | loss: 0.6299222
	speed: 0.0033s/iter; left time: 0.9129s
	iters: 800, epoch: 8 | loss: 0.9846885
	speed: 0.0034s/iter; left time: 0.6034s
	iters: 900, epoch: 8 | loss: 0.9115910
	speed: 0.0032s/iter; left time: 0.2599s
Updating learning rate to 2.3268179640625e-06
Epoch: 8 cost time: 3.2482123374938965
Epoch: 8, Steps: 979 | Train Loss: 0.7474106 Vali Loss: 0.6414386 Best vali loss: 0.6096874

best validation loss 0.6096873750900682

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010799774229, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4385107
	speed: 0.0099s/iter; left time: 76.7686s
	iters: 200, epoch: 1 | loss: 1.3947479
	speed: 0.0036s/iter; left time: 27.1257s
	iters: 300, epoch: 1 | loss: 0.8507704
	speed: 0.0034s/iter; left time: 25.6967s
	iters: 400, epoch: 1 | loss: 1.3925598
	speed: 0.0036s/iter; left time: 26.7086s
	iters: 500, epoch: 1 | loss: 0.9759481
	speed: 0.0035s/iter; left time: 25.9273s
	iters: 600, epoch: 1 | loss: 1.6076294
	speed: 0.0036s/iter; left time: 26.1826s
	iters: 700, epoch: 1 | loss: 0.8097720
	speed: 0.0035s/iter; left time: 25.1299s
	iters: 800, epoch: 1 | loss: 0.7171196
	speed: 0.0036s/iter; left time: 25.4072s
	iters: 900, epoch: 1 | loss: 1.0552371
	speed: 0.0035s/iter; left time: 24.3895s
Updating learning rate to 0.000297833515
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 3.83764386177063
Epoch: 1, Steps: 979 | Train Loss: 1.0269216 Vali Loss: 0.6094477 Best vali loss: 0.6094477
	iters: 100, epoch: 2 | loss: 1.0407588
	speed: 0.0114s/iter; left time: 77.0400s
	iters: 200, epoch: 2 | loss: 0.3878894
	speed: 0.0032s/iter; left time: 21.3391s
	iters: 300, epoch: 2 | loss: 0.4438322
	speed: 0.0031s/iter; left time: 20.1422s
	iters: 400, epoch: 2 | loss: 1.4774827
	speed: 0.0030s/iter; left time: 19.5645s
	iters: 500, epoch: 2 | loss: 0.9914975
	speed: 0.0030s/iter; left time: 18.9437s
	iters: 600, epoch: 2 | loss: 1.5669616
	speed: 0.0030s/iter; left time: 19.0298s
	iters: 700, epoch: 2 | loss: 1.0889908
	speed: 0.0031s/iter; left time: 19.1794s
	iters: 800, epoch: 2 | loss: 0.3034279
	speed: 0.0033s/iter; left time: 20.1490s
	iters: 900, epoch: 2 | loss: 0.8521159
	speed: 0.0032s/iter; left time: 19.2423s
Updating learning rate to 0.0001489167575
Epoch: 2 cost time: 3.1093685626983643
Epoch: 2, Steps: 979 | Train Loss: 0.9058841 Vali Loss: 0.6201739 Best vali loss: 0.6094477
	iters: 100, epoch: 3 | loss: 0.7302302
	speed: 0.0109s/iter; left time: 62.8169s
	iters: 200, epoch: 3 | loss: 0.6768143
	speed: 0.0030s/iter; left time: 17.2339s
	iters: 300, epoch: 3 | loss: 1.5077459
	speed: 0.0033s/iter; left time: 18.1902s
	iters: 400, epoch: 3 | loss: 1.0655015
	speed: 0.0034s/iter; left time: 18.4657s
	iters: 500, epoch: 3 | loss: 1.1410943
	speed: 0.0034s/iter; left time: 18.1932s
	iters: 600, epoch: 3 | loss: 0.4808295
	speed: 0.0030s/iter; left time: 16.0093s
	iters: 700, epoch: 3 | loss: 0.7240152
	speed: 0.0031s/iter; left time: 15.8696s
	iters: 800, epoch: 3 | loss: 1.7858684
	speed: 0.0031s/iter; left time: 15.5545s
	iters: 900, epoch: 3 | loss: 0.2858590
	speed: 0.0031s/iter; left time: 15.4142s
Updating learning rate to 7.445837875e-05
Validation loss decreased (0.6094 --> 0.6034).  Saving model state dict ...
Epoch: 3 cost time: 3.143446922302246
Epoch: 3, Steps: 979 | Train Loss: 0.9331065 Vali Loss: 0.6033662 Best vali loss: 0.6033662
	iters: 100, epoch: 4 | loss: 0.9906492
	speed: 0.0112s/iter; left time: 53.7472s
	iters: 200, epoch: 4 | loss: 0.2334614
	speed: 0.0030s/iter; left time: 14.2763s
	iters: 300, epoch: 4 | loss: 0.8656662
	speed: 0.0031s/iter; left time: 14.2731s
	iters: 400, epoch: 4 | loss: 0.3058430
	speed: 0.0031s/iter; left time: 13.7883s
	iters: 500, epoch: 4 | loss: 0.5739763
	speed: 0.0030s/iter; left time: 13.1098s
	iters: 600, epoch: 4 | loss: 0.8362651
	speed: 0.0031s/iter; left time: 13.2128s
	iters: 700, epoch: 4 | loss: 1.1731582
	speed: 0.0031s/iter; left time: 13.1816s
	iters: 800, epoch: 4 | loss: 0.2750061
	speed: 0.0030s/iter; left time: 12.4881s
	iters: 900, epoch: 4 | loss: 1.1251928
	speed: 0.0031s/iter; left time: 12.2012s
Updating learning rate to 3.7229189375e-05
Epoch: 4 cost time: 3.0536277294158936
Epoch: 4, Steps: 979 | Train Loss: 0.7088020 Vali Loss: 0.6043733 Best vali loss: 0.6033662
	iters: 100, epoch: 5 | loss: 0.8723131
	speed: 0.0106s/iter; left time: 40.2891s
	iters: 200, epoch: 5 | loss: 0.6413684
	speed: 0.0031s/iter; left time: 11.4848s
	iters: 300, epoch: 5 | loss: 1.2095321
	speed: 0.0031s/iter; left time: 11.2739s
	iters: 400, epoch: 5 | loss: 1.1390636
	speed: 0.0031s/iter; left time: 10.8873s
	iters: 500, epoch: 5 | loss: 0.3899139
	speed: 0.0032s/iter; left time: 10.9428s
	iters: 600, epoch: 5 | loss: 1.1075505
	speed: 0.0031s/iter; left time: 10.3608s
	iters: 700, epoch: 5 | loss: 0.7033631
	speed: 0.0032s/iter; left time: 10.1570s
	iters: 800, epoch: 5 | loss: 0.4590397
	speed: 0.0032s/iter; left time: 9.9477s
	iters: 900, epoch: 5 | loss: 1.0056076
	speed: 0.0034s/iter; left time: 10.2835s
Updating learning rate to 1.86145946875e-05
Epoch: 5 cost time: 3.12699556350708
Epoch: 5, Steps: 979 | Train Loss: 0.8364169 Vali Loss: 0.6091533 Best vali loss: 0.6033662
	iters: 100, epoch: 6 | loss: 1.1712122
	speed: 0.0110s/iter; left time: 31.0890s
	iters: 200, epoch: 6 | loss: 0.4424301
	speed: 0.0031s/iter; left time: 8.4511s
	iters: 300, epoch: 6 | loss: 1.1279947
	speed: 0.0031s/iter; left time: 8.2756s
	iters: 400, epoch: 6 | loss: 0.4090413
	speed: 0.0031s/iter; left time: 7.7953s
	iters: 500, epoch: 6 | loss: 0.4879756
	speed: 0.0030s/iter; left time: 7.2187s
	iters: 600, epoch: 6 | loss: 1.0279022
	speed: 0.0030s/iter; left time: 6.9310s
	iters: 700, epoch: 6 | loss: 1.2797281
	speed: 0.0030s/iter; left time: 6.6493s
	iters: 800, epoch: 6 | loss: 0.8533579
	speed: 0.0030s/iter; left time: 6.3399s
	iters: 900, epoch: 6 | loss: 0.4719369
	speed: 0.0029s/iter; left time: 6.0016s
Updating learning rate to 9.30729734375e-06
Epoch: 6 cost time: 3.01137638092041
Epoch: 6, Steps: 979 | Train Loss: 0.8079532 Vali Loss: 0.6173241 Best vali loss: 0.6033662
	iters: 100, epoch: 7 | loss: 0.8734152
	speed: 0.0107s/iter; left time: 19.9160s
	iters: 200, epoch: 7 | loss: 0.7443217
	speed: 0.0031s/iter; left time: 5.4691s
	iters: 300, epoch: 7 | loss: 0.5423385
	speed: 0.0031s/iter; left time: 5.1941s
	iters: 400, epoch: 7 | loss: 1.1116617
	speed: 0.0033s/iter; left time: 5.1202s
	iters: 500, epoch: 7 | loss: 0.5893178
	speed: 0.0032s/iter; left time: 4.7257s
	iters: 600, epoch: 7 | loss: 0.7743789
	speed: 0.0032s/iter; left time: 4.3387s
	iters: 700, epoch: 7 | loss: 0.8128986
	speed: 0.0031s/iter; left time: 3.8882s
	iters: 800, epoch: 7 | loss: 0.8356184
	speed: 0.0032s/iter; left time: 3.7023s
	iters: 900, epoch: 7 | loss: 0.6862244
	speed: 0.0031s/iter; left time: 3.2772s
Updating learning rate to 4.653648671875e-06
Epoch: 7 cost time: 3.146559238433838
Epoch: 7, Steps: 979 | Train Loss: 0.7744639 Vali Loss: 0.6266718 Best vali loss: 0.6033662
	iters: 100, epoch: 8 | loss: 0.6275501
	speed: 0.0114s/iter; left time: 9.9988s
	iters: 200, epoch: 8 | loss: 0.6669263
	speed: 0.0035s/iter; left time: 2.7671s
	iters: 300, epoch: 8 | loss: 0.9697411
	speed: 0.0035s/iter; left time: 2.3761s
	iters: 400, epoch: 8 | loss: 0.3149524
	speed: 0.0034s/iter; left time: 1.9837s
	iters: 500, epoch: 8 | loss: 0.8567627
	speed: 0.0035s/iter; left time: 1.6749s
	iters: 600, epoch: 8 | loss: 1.2524421
	speed: 0.0033s/iter; left time: 1.2670s
	iters: 700, epoch: 8 | loss: 0.6791618
	speed: 0.0034s/iter; left time: 0.9640s
	iters: 800, epoch: 8 | loss: 0.9942319
	speed: 0.0035s/iter; left time: 0.6288s
	iters: 900, epoch: 8 | loss: 0.9912323
	speed: 0.0035s/iter; left time: 0.2771s
Updating learning rate to 2.3268243359375e-06
Epoch: 8 cost time: 3.4258334636688232
Epoch: 8, Steps: 979 | Train Loss: 0.8170001 Vali Loss: 0.6290968 Best vali loss: 0.6033662

best validation loss 0.6033662166351634

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002979435752, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9257272
	speed: 0.0109s/iter; left time: 9.6428s
Updating learning rate to 0.0002866037730852587
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 0.9321997165679932
Epoch: 1, Steps: 123 | Train Loss: 0.9257272 Vali Loss: 0.6075541 Best vali loss: 0.6075541
	iters: 100, epoch: 2 | loss: 0.7864310
	speed: 0.0080s/iter; left time: 6.1145s
Updating learning rate to 0.000254310748817442
Validation loss decreased (0.6076 --> 0.5834).  Saving model state dict ...
Epoch: 2 cost time: 0.6075642108917236
Epoch: 2, Steps: 123 | Train Loss: 0.7864310 Vali Loss: 0.5834218 Best vali loss: 0.5834218
	iters: 100, epoch: 3 | loss: 0.9405925
	speed: 0.0081s/iter; left time: 5.1793s
Updating learning rate to 0.00020598082260433112
Validation loss decreased (0.5834 --> 0.5691).  Saving model state dict ...
Epoch: 3 cost time: 0.6344623565673828
Epoch: 3, Steps: 123 | Train Loss: 0.9405925 Vali Loss: 0.5690807 Best vali loss: 0.5690807

best validation loss 0.569080721664517

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010842670161, 'e_layers': 2, 'learning_rate': 0.000319680719, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8399135
	speed: 0.0119s/iter; left time: 10.5329s
Updating learning rate to 0.000307513596111296
Validation loss decreased (inf --> 0.5903).  Saving model state dict ...
Epoch: 1 cost time: 1.054866075515747
Epoch: 1, Steps: 123 | Train Loss: 0.8399135 Vali Loss: 0.5902621 Best vali loss: 0.5902621
	iters: 100, epoch: 2 | loss: 0.6765159
	speed: 0.0095s/iter; left time: 7.2343s
Updating learning rate to 0.0002728645616097456
Epoch: 2 cost time: 0.7506484985351562
Epoch: 2, Steps: 123 | Train Loss: 0.6765159 Vali Loss: 0.5930125 Best vali loss: 0.5902621
	iters: 100, epoch: 3 | loss: 0.5493635
	speed: 0.0094s/iter; left time: 6.0179s
Updating learning rate to 0.00022100861690392987
Validation loss decreased (0.5903 --> 0.5751).  Saving model state dict ...
Epoch: 3 cost time: 0.7510268688201904
Epoch: 3, Steps: 123 | Train Loss: 0.5493635 Vali Loss: 0.5750765 Best vali loss: 0.5750765

best validation loss 0.5750764621346707

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021637058603, 'e_layers': 2, 'learning_rate': 0.0003040002704, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00029242994905022835
Validation loss decreased (inf --> 0.6021).  Saving model state dict ...
Epoch: 1 cost time: 0.8630638122558594
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6021148 Best vali loss: 0.6021148
Updating learning rate to 0.000259480461541192
Validation loss decreased (0.6021 --> 0.5692).  Saving model state dict ...
Epoch: 2 cost time: 0.574455976486206
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5691637 Best vali loss: 0.5691637
Updating learning rate to 0.0002101680686582937
Epoch: 3 cost time: 0.5684316158294678
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5723528 Best vali loss: 0.5691637

best validation loss 0.5691637257799292

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002979435752, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8287758
	speed: 0.0113s/iter; left time: 5.8135s
Updating learning rate to 0.0001489717876
Validation loss decreased (0.5691 --> 0.5570).  Saving model state dict ...
Epoch: 4 cost time: 0.9322946071624756
Epoch: 4, Steps: 123 | Train Loss: 0.8287758 Vali Loss: 0.5570335 Best vali loss: 0.5570335
	iters: 100, epoch: 5 | loss: 0.6952050
	speed: 0.0081s/iter; left time: 3.1945s
Updating learning rate to 9.196275259566889e-05
Validation loss decreased (0.5570 --> 0.5526).  Saving model state dict ...
Epoch: 5 cost time: 0.6335124969482422
Epoch: 5, Steps: 123 | Train Loss: 0.6952050 Vali Loss: 0.5526461 Best vali loss: 0.5526461
	iters: 100, epoch: 6 | loss: 0.8063356
	speed: 0.0081s/iter; left time: 2.1973s
Updating learning rate to 4.3632826382557976e-05
Epoch: 6 cost time: 0.637406587600708
Epoch: 6, Steps: 123 | Train Loss: 0.8063356 Vali Loss: 0.5692876 Best vali loss: 0.5526461
	iters: 100, epoch: 7 | loss: 0.7822337
	speed: 0.0080s/iter; left time: 1.1820s
Updating learning rate to 1.1339802114741297e-05
Epoch: 7 cost time: 0.6415431499481201
Epoch: 7, Steps: 123 | Train Loss: 0.7822337 Vali Loss: 0.5694593 Best vali loss: 0.5526461
	iters: 100, epoch: 8 | loss: 0.5377648
	speed: 0.0078s/iter; left time: 0.1863s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6026887893676758
Epoch: 8, Steps: 123 | Train Loss: 0.5377648 Vali Loss: 0.5729700 Best vali loss: 0.5526461

best validation loss 0.552646146045135

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010498914303, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9261420
	speed: 0.0108s/iter; left time: 9.5307s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 0.9069993495941162
Epoch: 1, Steps: 123 | Train Loss: 0.9261420 Vali Loss: 0.6077321 Best vali loss: 0.6077321
	iters: 100, epoch: 2 | loss: 0.7831517
	speed: 0.0076s/iter; left time: 5.7918s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6077 --> 0.5700).  Saving model state dict ...
Epoch: 2 cost time: 0.5900657176971436
Epoch: 2, Steps: 123 | Train Loss: 0.7831517 Vali Loss: 0.5700274 Best vali loss: 0.5700274
	iters: 100, epoch: 3 | loss: 0.9268565
	speed: 0.0077s/iter; left time: 4.9244s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5700 --> 0.5519).  Saving model state dict ...
Epoch: 3 cost time: 0.6019186973571777
Epoch: 3, Steps: 123 | Train Loss: 0.9268565 Vali Loss: 0.5518590 Best vali loss: 0.5518590
	iters: 100, epoch: 4 | loss: 0.8527511
	speed: 0.0082s/iter; left time: 4.2200s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5519 --> 0.5504).  Saving model state dict ...
Epoch: 4 cost time: 0.652458667755127
Epoch: 4, Steps: 123 | Train Loss: 0.8527511 Vali Loss: 0.5503691 Best vali loss: 0.5503691
	iters: 100, epoch: 5 | loss: 0.6008623
	speed: 0.0084s/iter; left time: 3.2816s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5504 --> 0.5459).  Saving model state dict ...
Epoch: 5 cost time: 0.6470849514007568
Epoch: 5, Steps: 123 | Train Loss: 0.6008623 Vali Loss: 0.5459216 Best vali loss: 0.5459216
	iters: 100, epoch: 6 | loss: 0.5231315
	speed: 0.0080s/iter; left time: 2.1553s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.6049039363861084
Epoch: 6, Steps: 123 | Train Loss: 0.5231315 Vali Loss: 0.5632453 Best vali loss: 0.5459216
	iters: 100, epoch: 7 | loss: 0.7712162
	speed: 0.0078s/iter; left time: 1.1525s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.6341843605041504
Epoch: 7, Steps: 123 | Train Loss: 0.7712162 Vali Loss: 0.5672876 Best vali loss: 0.5459216
	iters: 100, epoch: 8 | loss: 0.6381884
	speed: 0.0081s/iter; left time: 0.1940s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6410913467407227
Epoch: 8, Steps: 123 | Train Loss: 0.6381884 Vali Loss: 0.5719234 Best vali loss: 0.5459216

best validation loss 0.545921575424573

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9255527
	speed: 0.0111s/iter; left time: 9.7973s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6088).  Saving model state dict ...
Epoch: 1 cost time: 0.9350073337554932
Epoch: 1, Steps: 123 | Train Loss: 0.9255527 Vali Loss: 0.6087989 Best vali loss: 0.6087989
	iters: 100, epoch: 2 | loss: 0.7814639
	speed: 0.0078s/iter; left time: 5.9685s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6088 --> 0.5703).  Saving model state dict ...
Epoch: 2 cost time: 0.6053206920623779
Epoch: 2, Steps: 123 | Train Loss: 0.7814639 Vali Loss: 0.5702912 Best vali loss: 0.5702912
	iters: 100, epoch: 3 | loss: 0.9347624
	speed: 0.0081s/iter; left time: 5.1543s
Updating learning rate to 0.0002058009417118559
Epoch: 3 cost time: 0.6189730167388916
Epoch: 3, Steps: 123 | Train Loss: 0.9347624 Vali Loss: 0.5747016 Best vali loss: 0.5702912
	iters: 100, epoch: 4 | loss: 0.8506301
	speed: 0.0078s/iter; left time: 4.0409s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5703 --> 0.5658).  Saving model state dict ...
Epoch: 4 cost time: 0.6274149417877197
Epoch: 4, Steps: 123 | Train Loss: 0.8506301 Vali Loss: 0.5657733 Best vali loss: 0.5657733
	iters: 100, epoch: 5 | loss: 0.5869232
	speed: 0.0079s/iter; left time: 3.1126s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5658 --> 0.5497).  Saving model state dict ...
Epoch: 5 cost time: 0.5928268432617188
Epoch: 5, Steps: 123 | Train Loss: 0.5869232 Vali Loss: 0.5497289 Best vali loss: 0.5497289
	iters: 100, epoch: 6 | loss: 0.5195969
	speed: 0.0080s/iter; left time: 2.1532s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.6349263191223145
Epoch: 6, Steps: 123 | Train Loss: 0.5195969 Vali Loss: 0.5636201 Best vali loss: 0.5497289
	iters: 100, epoch: 7 | loss: 0.7649583
	speed: 0.0077s/iter; left time: 1.1386s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.6051921844482422
Epoch: 7, Steps: 123 | Train Loss: 0.7649583 Vali Loss: 0.5751967 Best vali loss: 0.5497289
	iters: 100, epoch: 8 | loss: 0.6393054
	speed: 0.0080s/iter; left time: 0.1908s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6401138305664062
Epoch: 8, Steps: 123 | Train Loss: 0.6393054 Vali Loss: 0.5779457 Best vali loss: 0.5497289

best validation loss 0.5497289310997694

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0028795076365, 'e_layers': 1, 'learning_rate': 0.0002980256847, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028668275747849607
Validation loss decreased (inf --> 0.6056).  Saving model state dict ...
Epoch: 1 cost time: 0.7158892154693604
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6056277 Best vali loss: 0.6056277
Updating learning rate to 0.0002543808336595669
Epoch: 2 cost time: 0.4582514762878418
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6140464 Best vali loss: 0.6056277
Updating learning rate to 0.000206037588326976
Epoch: 3 cost time: 0.45851755142211914
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6102261 Best vali loss: 0.6056277

best validation loss 0.6056276960044148

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0088091786737, 'e_layers': 4, 'learning_rate': 6.86796557e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7454259
	speed: 0.0133s/iter; left time: 24.7075s
	iters: 200, epoch: 1 | loss: 0.9575045
	speed: 0.0069s/iter; left time: 12.1184s
Updating learning rate to 6.606569195057607e-05
Validation loss decreased (inf --> 0.6073).  Saving model state dict ...
Epoch: 1 cost time: 2.071572780609131
Epoch: 1, Steps: 245 | Train Loss: 0.8514652 Vali Loss: 0.6073074 Best vali loss: 0.6073074
	iters: 100, epoch: 2 | loss: 0.5005761
	speed: 0.0138s/iter; left time: 22.2280s
	iters: 200, epoch: 2 | loss: 0.5845224
	speed: 0.0070s/iter; left time: 10.6244s
Updating learning rate to 5.8621752987513664e-05
Validation loss decreased (0.6073 --> 0.5707).  Saving model state dict ...
Epoch: 2 cost time: 1.7553541660308838
Epoch: 2, Steps: 245 | Train Loss: 0.5425493 Vali Loss: 0.5707458 Best vali loss: 0.5707458
	iters: 100, epoch: 3 | loss: 0.9788917
	speed: 0.0138s/iter; left time: 18.9486s
	iters: 200, epoch: 3 | loss: 0.7553004
	speed: 0.0069s/iter; left time: 8.7641s
Updating learning rate to 4.748111103846431e-05
Validation loss decreased (0.5707 --> 0.5353).  Saving model state dict ...
Epoch: 3 cost time: 1.7340903282165527
Epoch: 3, Steps: 245 | Train Loss: 0.8670961 Vali Loss: 0.5353361 Best vali loss: 0.5353361

best validation loss 0.5353360842191086

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0015296095277, 'e_layers': 1, 'learning_rate': 0.0002578881273, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002480728448950676
Validation loss decreased (inf --> 0.6806).  Saving model state dict ...
Epoch: 1 cost time: 0.7325856685638428
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6806193 Best vali loss: 0.6806193
Updating learning rate to 0.00022012128545066478
Validation loss decreased (0.6806 --> 0.6543).  Saving model state dict ...
Epoch: 2 cost time: 0.43773770332336426
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6543024 Best vali loss: 0.6543024
Updating learning rate to 0.0001782888205106846
Validation loss decreased (0.6543 --> 0.6382).  Saving model state dict ...
Epoch: 3 cost time: 0.4251570701599121
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6382246 Best vali loss: 0.6382246

best validation loss 0.6382245558767835

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0088091786737, 'e_layers': 4, 'learning_rate': 6.86796557e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5756320
	speed: 0.0139s/iter; left time: 15.6353s
	iters: 200, epoch: 4 | loss: 0.9051301
	speed: 0.0070s/iter; left time: 7.2009s
Updating learning rate to 3.433982785e-05
Epoch: 4 cost time: 2.0850400924682617
Epoch: 4, Steps: 245 | Train Loss: 0.7403810 Vali Loss: 0.5503793 Best vali loss: 0.5353361
	iters: 100, epoch: 5 | loss: 0.4764453
	speed: 0.0135s/iter; left time: 11.8796s
	iters: 200, epoch: 5 | loss: 0.4853428
	speed: 0.0070s/iter; left time: 5.4989s
Updating learning rate to 2.11985446615357e-05
Epoch: 5 cost time: 1.7737300395965576
Epoch: 5, Steps: 245 | Train Loss: 0.4808941 Vali Loss: 0.5364225 Best vali loss: 0.5353361
	iters: 100, epoch: 6 | loss: 0.8742488
	speed: 0.0135s/iter; left time: 8.5993s
	iters: 200, epoch: 6 | loss: 0.7052529
	speed: 0.0071s/iter; left time: 3.8008s
Updating learning rate to 1.0057902712486342e-05
Epoch: 6 cost time: 1.7768542766571045
Epoch: 6, Steps: 245 | Train Loss: 0.7897509 Vali Loss: 0.5425615 Best vali loss: 0.5353361
	iters: 100, epoch: 7 | loss: 0.9005362
	speed: 0.0132s/iter; left time: 5.1580s
	iters: 200, epoch: 7 | loss: 0.5649021
	speed: 0.0069s/iter; left time: 2.0119s
Updating learning rate to 2.6139637494239353e-06
Epoch: 7 cost time: 1.7330918312072754
Epoch: 7, Steps: 245 | Train Loss: 0.7327192 Vali Loss: 0.5399977 Best vali loss: 0.5353361
	iters: 100, epoch: 8 | loss: 1.0614748
	speed: 0.0135s/iter; left time: 1.9735s
	iters: 200, epoch: 8 | loss: 0.4842082
	speed: 0.0071s/iter; left time: 0.3287s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8005468845367432
Epoch: 8, Steps: 245 | Train Loss: 0.7728415 Vali Loss: 0.5391694 Best vali loss: 0.5353361

best validation loss 0.5353360842191086

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016512921995, 'e_layers': 2, 'learning_rate': 0.0002044917142, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7640701
	speed: 0.0117s/iter; left time: 10.3136s
Updating learning rate to 0.00019670871175876383
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 1.0345039367675781
Epoch: 1, Steps: 123 | Train Loss: 0.7640701 Vali Loss: 0.6100756 Best vali loss: 0.6100756
	iters: 100, epoch: 2 | loss: 0.9258776
	speed: 0.0092s/iter; left time: 7.0039s
Updating learning rate to 0.0001745445960036407
Validation loss decreased (0.6101 --> 0.5400).  Saving model state dict ...
Epoch: 2 cost time: 0.7240746021270752
Epoch: 2, Steps: 123 | Train Loss: 0.9258776 Vali Loss: 0.5399580 Best vali loss: 0.5399580
	iters: 100, epoch: 3 | loss: 0.8580542
	speed: 0.0093s/iter; left time: 5.9123s
Updating learning rate to 0.0001413736526401385
Epoch: 3 cost time: 0.7229444980621338
Epoch: 3, Steps: 123 | Train Loss: 0.8580542 Vali Loss: 0.5511959 Best vali loss: 0.5399580
	iters: 100, epoch: 4 | loss: 0.4945172
	speed: 0.0090s/iter; left time: 4.6582s
Updating learning rate to 0.0001022458571
Validation loss decreased (0.5400 --> 0.5388).  Saving model state dict ...
Epoch: 4 cost time: 0.7199869155883789
Epoch: 4, Steps: 123 | Train Loss: 0.4945172 Vali Loss: 0.5387519 Best vali loss: 0.5387519
	iters: 100, epoch: 5 | loss: 0.5754316
	speed: 0.0094s/iter; left time: 3.7120s
Updating learning rate to 6.311806155986153e-05
Validation loss decreased (0.5388 --> 0.5285).  Saving model state dict ...
Epoch: 5 cost time: 0.7242906093597412
Epoch: 5, Steps: 123 | Train Loss: 0.5754316 Vali Loss: 0.5284920 Best vali loss: 0.5284920
	iters: 100, epoch: 6 | loss: 0.6173030
	speed: 0.0093s/iter; left time: 2.5083s
Updating learning rate to 2.9947118196359302e-05
Epoch: 6 cost time: 0.7223598957061768
Epoch: 6, Steps: 123 | Train Loss: 0.6173030 Vali Loss: 0.5311314 Best vali loss: 0.5284920
	iters: 100, epoch: 7 | loss: 0.5667969
	speed: 0.0090s/iter; left time: 1.3185s
Updating learning rate to 7.783002441236173e-06
Validation loss decreased (0.5285 --> 0.5267).  Saving model state dict ...
Epoch: 7 cost time: 0.7175352573394775
Epoch: 7, Steps: 123 | Train Loss: 0.5667969 Vali Loss: 0.5266713 Best vali loss: 0.5266713
	iters: 100, epoch: 8 | loss: 0.7341760
	speed: 0.0095s/iter; left time: 0.2268s
Updating learning rate to 0.0
Validation loss decreased (0.5267 --> 0.5261).  Saving model state dict ...
Epoch: 8 cost time: 0.7265000343322754
Epoch: 8, Steps: 123 | Train Loss: 0.7341760 Vali Loss: 0.5260678 Best vali loss: 0.5260678

best validation loss 0.5260678086910795

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010818704735, 'e_layers': 4, 'learning_rate': 0.0004125733695, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7560264
	speed: 0.0163s/iter; left time: 14.4252s
Updating learning rate to 0.0004125733695
Validation loss decreased (inf --> 0.6114).  Saving model state dict ...
Epoch: 1 cost time: 1.6051297187805176
Epoch: 1, Steps: 123 | Train Loss: 0.7560264 Vali Loss: 0.6114111 Best vali loss: 0.6114111
	iters: 100, epoch: 2 | loss: 1.0332645
	speed: 0.0155s/iter; left time: 11.8408s
Updating learning rate to 0.00020628668475
Epoch: 2 cost time: 1.2860898971557617
Epoch: 2, Steps: 123 | Train Loss: 1.0332645 Vali Loss: 0.6225294 Best vali loss: 0.6114111
	iters: 100, epoch: 3 | loss: 0.8230669
	speed: 0.0153s/iter; left time: 9.7809s
Updating learning rate to 0.000103143342375
Epoch: 3 cost time: 1.2862956523895264
Epoch: 3, Steps: 123 | Train Loss: 0.8230669 Vali Loss: 0.6249710 Best vali loss: 0.6114111
	iters: 100, epoch: 4 | loss: 0.6118482
	speed: 0.0150s/iter; left time: 7.7434s
Updating learning rate to 5.15716711875e-05
Validation loss decreased (0.6114 --> 0.5904).  Saving model state dict ...
Epoch: 4 cost time: 1.278472661972046
Epoch: 4, Steps: 123 | Train Loss: 0.6118482 Vali Loss: 0.5904446 Best vali loss: 0.5904446
	iters: 100, epoch: 5 | loss: 0.6546757
	speed: 0.0158s/iter; left time: 6.1922s
Updating learning rate to 2.578583559375e-05
Validation loss decreased (0.5904 --> 0.5557).  Saving model state dict ...
Epoch: 5 cost time: 1.2841482162475586
Epoch: 5, Steps: 123 | Train Loss: 0.6546757 Vali Loss: 0.5556937 Best vali loss: 0.5556937
	iters: 100, epoch: 6 | loss: 0.7523951
	speed: 0.0158s/iter; left time: 4.2786s
Updating learning rate to 1.2892917796875e-05
Validation loss decreased (0.5557 --> 0.5496).  Saving model state dict ...
Epoch: 6 cost time: 1.287846326828003
Epoch: 6, Steps: 123 | Train Loss: 0.7523951 Vali Loss: 0.5496045 Best vali loss: 0.5496045
	iters: 100, epoch: 7 | loss: 0.6968672
	speed: 0.0157s/iter; left time: 2.3094s
Updating learning rate to 6.4464588984375e-06
Epoch: 7 cost time: 1.2816801071166992
Epoch: 7, Steps: 123 | Train Loss: 0.6968672 Vali Loss: 0.5527527 Best vali loss: 0.5496045
	iters: 100, epoch: 8 | loss: 0.7207097
	speed: 0.0151s/iter; left time: 0.3622s
Updating learning rate to 3.22322944921875e-06
Epoch: 8 cost time: 1.2844350337982178
Epoch: 8, Steps: 123 | Train Loss: 0.7207097 Vali Loss: 0.5502726 Best vali loss: 0.5496045

best validation loss 0.5496044890961124

[INFO][smbo.py:320] Finished 600 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016219944517, 'e_layers': 2, 'learning_rate': 0.0002931626741, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002931626741
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8623409271240234
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020170 Best vali loss: 0.6020170
Updating learning rate to 0.00014658133705
Validation loss decreased (0.6020 --> 0.5659).  Saving model state dict ...
Epoch: 2 cost time: 0.5721499919891357
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5658913 Best vali loss: 0.5658913
Updating learning rate to 7.3290668525e-05
Validation loss decreased (0.5659 --> 0.5655).  Saving model state dict ...
Epoch: 3 cost time: 0.5648877620697021
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5655274 Best vali loss: 0.5655274

best validation loss 0.56552737410672

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017674931828, 'e_layers': 2, 'learning_rate': 0.0002927361549, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002927361549
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8713552951812744
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6019867 Best vali loss: 0.6019867
Updating learning rate to 0.00014636807745
Validation loss decreased (0.6020 --> 0.5617).  Saving model state dict ...
Epoch: 2 cost time: 0.5724568367004395
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5616602 Best vali loss: 0.5616602
Updating learning rate to 7.3184038725e-05
Epoch: 3 cost time: 0.5754225254058838
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5729800 Best vali loss: 0.5616602

best validation loss 0.561660170279295

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0018372798972, 'e_layers': 4, 'learning_rate': 0.0039378592374, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7896261
	speed: 0.0114s/iter; left time: 43.7344s
	iters: 200, epoch: 1 | loss: 1.1761252
	speed: 0.0053s/iter; left time: 19.6473s
	iters: 300, epoch: 1 | loss: 0.5393884
	speed: 0.0050s/iter; left time: 17.9417s
	iters: 400, epoch: 1 | loss: 1.2743018
	speed: 0.0050s/iter; left time: 17.6067s
Updating learning rate to 0.003787983394372182
Validation loss decreased (inf --> 0.6563).  Saving model state dict ...
Epoch: 1 cost time: 2.8722431659698486
Epoch: 1, Steps: 490 | Train Loss: 0.9448603 Vali Loss: 0.6563202 Best vali loss: 0.6563202
	iters: 100, epoch: 2 | loss: 0.5498038
	speed: 0.0136s/iter; left time: 45.3965s
	iters: 200, epoch: 2 | loss: 0.9583347
	speed: 0.0050s/iter; left time: 16.1011s
	iters: 300, epoch: 2 | loss: 1.2225640
	speed: 0.0050s/iter; left time: 15.6243s
	iters: 400, epoch: 2 | loss: 0.5372673
	speed: 0.0050s/iter; left time: 15.0911s
Updating learning rate to 0.0033611731037618132
Validation loss decreased (0.6563 --> 0.6075).  Saving model state dict ...
Epoch: 2 cost time: 2.4937846660614014
Epoch: 2, Steps: 490 | Train Loss: 0.8169924 Vali Loss: 0.6075407 Best vali loss: 0.6075407
	iters: 100, epoch: 3 | loss: 0.9497493
	speed: 0.0134s/iter; left time: 38.1866s
	iters: 200, epoch: 3 | loss: 0.7828699
	speed: 0.0051s/iter; left time: 14.0227s
	iters: 300, epoch: 3 | loss: 0.8679910
	speed: 0.0049s/iter; left time: 12.8801s
	iters: 400, epoch: 3 | loss: 1.0354474
	speed: 0.0049s/iter; left time: 12.3750s
Updating learning rate to 0.0027224063632694034
Epoch: 3 cost time: 2.51143741607666
Epoch: 3, Steps: 490 | Train Loss: 0.9090144 Vali Loss: 0.6131017 Best vali loss: 0.6075407

best validation loss 0.6075406698979806

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017674931828, 'e_layers': 2, 'learning_rate': 0.0002927361549, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.65920193625e-05
Validation loss decreased (0.5617 --> 0.5523).  Saving model state dict ...
Epoch: 4 cost time: 0.8787858486175537
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5523337 Best vali loss: 0.5523337
Updating learning rate to 1.829600968125e-05
Epoch: 5 cost time: 0.572462797164917
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5539659 Best vali loss: 0.5523337
Updating learning rate to 9.148004840625e-06
Validation loss decreased (0.5523 --> 0.5491).  Saving model state dict ...
Epoch: 6 cost time: 0.5632762908935547
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5491343 Best vali loss: 0.5491343
Updating learning rate to 4.5740024203125e-06
Epoch: 7 cost time: 0.5681366920471191
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5497134 Best vali loss: 0.5491343
Updating learning rate to 2.28700121015625e-06
Epoch: 8 cost time: 0.5673544406890869
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5511427 Best vali loss: 0.5491343

best validation loss 0.5491343137843915

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010810535218, 'e_layers': 2, 'learning_rate': 0.000179600861, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617264
	speed: 0.0119s/iter; left time: 10.5743s
Updating learning rate to 0.0001727652102496523
Validation loss decreased (inf --> 0.6080).  Saving model state dict ...
Epoch: 1 cost time: 1.040158987045288
Epoch: 1, Steps: 123 | Train Loss: 0.7617264 Vali Loss: 0.6080131 Best vali loss: 0.6080131
	iters: 100, epoch: 2 | loss: 0.9414305
	speed: 0.0092s/iter; left time: 7.0468s
Updating learning rate to 0.00015329892386002126
Validation loss decreased (0.6080 --> 0.5849).  Saving model state dict ...
Epoch: 2 cost time: 0.7191214561462402
Epoch: 2, Steps: 123 | Train Loss: 0.9414305 Vali Loss: 0.5849321 Best vali loss: 0.5849321
	iters: 100, epoch: 3 | loss: 0.8513030
	speed: 0.0094s/iter; left time: 6.0367s
Updating learning rate to 0.0001241655674716027
Validation loss decreased (0.5849 --> 0.5458).  Saving model state dict ...
Epoch: 3 cost time: 0.7269139289855957
Epoch: 3, Steps: 123 | Train Loss: 0.8513030 Vali Loss: 0.5458227 Best vali loss: 0.5458227
	iters: 100, epoch: 4 | loss: 0.5067814
	speed: 0.0093s/iter; left time: 4.8244s
Updating learning rate to 8.98004305e-05
Epoch: 4 cost time: 0.7220096588134766
Epoch: 4, Steps: 123 | Train Loss: 0.5067814 Vali Loss: 0.5480549 Best vali loss: 0.5458227
	iters: 100, epoch: 5 | loss: 0.5770725
	speed: 0.0090s/iter; left time: 3.5188s
Updating learning rate to 5.543529352839731e-05
Validation loss decreased (0.5458 --> 0.5344).  Saving model state dict ...
Epoch: 5 cost time: 0.716444730758667
Epoch: 5, Steps: 123 | Train Loss: 0.5770725 Vali Loss: 0.5343917 Best vali loss: 0.5343917
	iters: 100, epoch: 6 | loss: 0.6202658
	speed: 0.0096s/iter; left time: 2.6027s
Updating learning rate to 2.6301937139978738e-05
Validation loss decreased (0.5344 --> 0.5303).  Saving model state dict ...
Epoch: 6 cost time: 0.7325987815856934
Epoch: 6, Steps: 123 | Train Loss: 0.6202658 Vali Loss: 0.5303093 Best vali loss: 0.5303093
	iters: 100, epoch: 7 | loss: 0.5726141
	speed: 0.0093s/iter; left time: 1.3666s
Updating learning rate to 6.835650750347705e-06
Validation loss decreased (0.5303 --> 0.5284).  Saving model state dict ...
Epoch: 7 cost time: 0.7252702713012695
Epoch: 7, Steps: 123 | Train Loss: 0.5726141 Vali Loss: 0.5284132 Best vali loss: 0.5284132
	iters: 100, epoch: 8 | loss: 0.7406447
	speed: 0.0092s/iter; left time: 0.2216s
Updating learning rate to 0.0
Validation loss decreased (0.5284 --> 0.5272).  Saving model state dict ...
Epoch: 8 cost time: 0.7201840877532959
Epoch: 8, Steps: 123 | Train Loss: 0.7406447 Vali Loss: 0.5272266 Best vali loss: 0.5272266

best validation loss 0.5272266133854313

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010810405378, 'e_layers': 2, 'learning_rate': 0.0001801553739, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617983
	speed: 0.0117s/iter; left time: 10.3972s
Updating learning rate to 0.00017329861825906404
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 1.0316905975341797
Epoch: 1, Steps: 123 | Train Loss: 0.7617983 Vali Loss: 0.6080522 Best vali loss: 0.6080522
	iters: 100, epoch: 2 | loss: 0.9420933
	speed: 0.0092s/iter; left time: 7.0226s
Updating learning rate to 0.00015377223022594399
Validation loss decreased (0.6081 --> 0.5835).  Saving model state dict ...
Epoch: 2 cost time: 0.7248458862304688
Epoch: 2, Steps: 123 | Train Loss: 0.9420933 Vali Loss: 0.5835297 Best vali loss: 0.5835297
	iters: 100, epoch: 3 | loss: 0.8568518
	speed: 0.0094s/iter; left time: 5.9834s
Updating learning rate to 0.00012454892537153405
Validation loss decreased (0.5835 --> 0.5571).  Saving model state dict ...
Epoch: 3 cost time: 0.7246990203857422
Epoch: 3, Steps: 123 | Train Loss: 0.8568518 Vali Loss: 0.5570779 Best vali loss: 0.5570779
	iters: 100, epoch: 4 | loss: 0.5026045
	speed: 0.0095s/iter; left time: 4.9045s
Updating learning rate to 9.007768695e-05
Validation loss decreased (0.5571 --> 0.5432).  Saving model state dict ...
Epoch: 4 cost time: 0.7227442264556885
Epoch: 4, Steps: 123 | Train Loss: 0.5026045 Vali Loss: 0.5431721 Best vali loss: 0.5431721
	iters: 100, epoch: 5 | loss: 0.5743164
	speed: 0.0093s/iter; left time: 3.6615s
Updating learning rate to 5.560644852846595e-05
Validation loss decreased (0.5432 --> 0.5355).  Saving model state dict ...
Epoch: 5 cost time: 0.7172281742095947
Epoch: 5, Steps: 123 | Train Loss: 0.5743164 Vali Loss: 0.5354544 Best vali loss: 0.5354544
	iters: 100, epoch: 6 | loss: 0.6183526
	speed: 0.0094s/iter; left time: 2.5277s
Updating learning rate to 2.638314367405603e-05
Validation loss decreased (0.5355 --> 0.5346).  Saving model state dict ...
Epoch: 6 cost time: 0.7232785224914551
Epoch: 6, Steps: 123 | Train Loss: 0.6183526 Vali Loss: 0.5345995 Best vali loss: 0.5345995
	iters: 100, epoch: 7 | loss: 0.5729044
	speed: 0.0093s/iter; left time: 1.3733s
Updating learning rate to 6.856755640935966e-06
Validation loss decreased (0.5346 --> 0.5293).  Saving model state dict ...
Epoch: 7 cost time: 0.7246251106262207
Epoch: 7, Steps: 123 | Train Loss: 0.5729044 Vali Loss: 0.5293405 Best vali loss: 0.5293405
	iters: 100, epoch: 8 | loss: 0.7418270
	speed: 0.0094s/iter; left time: 0.2252s
Updating learning rate to 0.0
Validation loss decreased (0.5293 --> 0.5272).  Saving model state dict ...
Epoch: 8 cost time: 0.7241148948669434
Epoch: 8, Steps: 123 | Train Loss: 0.7418270 Vali Loss: 0.5272357 Best vali loss: 0.5272357

best validation loss 0.5272356988047626

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017356288535, 'e_layers': 2, 'learning_rate': 0.0001809537409, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7618908
	speed: 0.0117s/iter; left time: 10.3527s
Updating learning rate to 0.00017406659922443023
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 1.029815673828125
Epoch: 1, Steps: 123 | Train Loss: 0.7618908 Vali Loss: 0.6080748 Best vali loss: 0.6080748
	iters: 100, epoch: 2 | loss: 0.9410131
	speed: 0.0093s/iter; left time: 7.1168s
Updating learning rate to 0.00015445367908573175
Validation loss decreased (0.6081 --> 0.5751).  Saving model state dict ...
Epoch: 2 cost time: 0.7282469272613525
Epoch: 2, Steps: 123 | Train Loss: 0.9410131 Vali Loss: 0.5750522 Best vali loss: 0.5750522
	iters: 100, epoch: 3 | loss: 0.8574045
	speed: 0.0094s/iter; left time: 6.0172s
Updating learning rate to 0.00012510086978345756
Validation loss decreased (0.5751 --> 0.5553).  Saving model state dict ...
Epoch: 3 cost time: 0.7263779640197754
Epoch: 3, Steps: 123 | Train Loss: 0.8574045 Vali Loss: 0.5553057 Best vali loss: 0.5553057

best validation loss 0.5553057381037704

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017279730156, 'e_layers': 2, 'learning_rate': 0.0001716426569, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7608234
	speed: 0.0118s/iter; left time: 10.4836s
Updating learning rate to 0.0001651098972578836
Validation loss decreased (inf --> 0.6073).  Saving model state dict ...
Epoch: 1 cost time: 1.0312321186065674
Epoch: 1, Steps: 123 | Train Loss: 0.7608234 Vali Loss: 0.6073269 Best vali loss: 0.6073269
	iters: 100, epoch: 2 | loss: 0.9476468
	speed: 0.0093s/iter; left time: 7.0914s
Updating learning rate to 0.00014650617176743298
Validation loss decreased (0.6073 --> 0.5922).  Saving model state dict ...
Epoch: 2 cost time: 0.7239725589752197
Epoch: 2, Steps: 123 | Train Loss: 0.9476468 Vali Loss: 0.5922237 Best vali loss: 0.5922237
	iters: 100, epoch: 3 | loss: 0.8481147
	speed: 0.0094s/iter; left time: 5.9974s
Updating learning rate to 0.00011866372899137775
Validation loss decreased (0.5922 --> 0.5569).  Saving model state dict ...
Epoch: 3 cost time: 0.726428747177124
Epoch: 3, Steps: 123 | Train Loss: 0.8481147 Vali Loss: 0.5568776 Best vali loss: 0.5568776

best validation loss 0.5568776152741849

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001700441615, 'e_layers': 2, 'learning_rate': 0.0001778332531, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7614419
	speed: 0.0120s/iter; left time: 10.5893s
Updating learning rate to 0.00017106487791949466
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.0392699241638184
Epoch: 1, Steps: 123 | Train Loss: 0.7614419 Vali Loss: 0.6078437 Best vali loss: 0.6078437
	iters: 100, epoch: 2 | loss: 0.9395533
	speed: 0.0092s/iter; left time: 6.9960s
Updating learning rate to 0.00015179017614373679
Validation loss decreased (0.6078 --> 0.5833).  Saving model state dict ...
Epoch: 2 cost time: 0.7223367691040039
Epoch: 2, Steps: 123 | Train Loss: 0.9395533 Vali Loss: 0.5833098 Best vali loss: 0.5833098
	iters: 100, epoch: 3 | loss: 0.8577307
	speed: 0.0095s/iter; left time: 6.0609s
Updating learning rate to 0.00012294354639247887
Validation loss decreased (0.5833 --> 0.5703).  Saving model state dict ...
Epoch: 3 cost time: 0.7306332588195801
Epoch: 3, Steps: 123 | Train Loss: 0.8577307 Vali Loss: 0.5702964 Best vali loss: 0.5702964

best validation loss 0.5702963841562744

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017356288535, 'e_layers': 2, 'learning_rate': 0.0001809537409, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5997426
	speed: 0.0123s/iter; left time: 6.3311s
Updating learning rate to 9.047687045e-05
Validation loss decreased (0.5553 --> 0.5329).  Saving model state dict ...
Epoch: 4 cost time: 1.040090560913086
Epoch: 4, Steps: 123 | Train Loss: 0.5997426 Vali Loss: 0.5328794 Best vali loss: 0.5328794
	iters: 100, epoch: 5 | loss: 0.8442236
	speed: 0.0094s/iter; left time: 3.6762s
Updating learning rate to 5.585287111654244e-05
Validation loss decreased (0.5329 --> 0.5286).  Saving model state dict ...
Epoch: 5 cost time: 0.7206740379333496
Epoch: 5, Steps: 123 | Train Loss: 0.8442236 Vali Loss: 0.5285949 Best vali loss: 0.5285949
	iters: 100, epoch: 6 | loss: 0.8019528
	speed: 0.0094s/iter; left time: 2.5475s
Updating learning rate to 2.6500061814268246e-05
Epoch: 6 cost time: 0.7194223403930664
Epoch: 6, Steps: 123 | Train Loss: 0.8019528 Vali Loss: 0.5294258 Best vali loss: 0.5285949
	iters: 100, epoch: 7 | loss: 0.4787999
	speed: 0.0091s/iter; left time: 1.3363s
Updating learning rate to 6.887141675569746e-06
Epoch: 7 cost time: 0.7224583625793457
Epoch: 7, Steps: 123 | Train Loss: 0.4787999 Vali Loss: 0.5312377 Best vali loss: 0.5285949
	iters: 100, epoch: 8 | loss: 0.5505670
	speed: 0.0091s/iter; left time: 0.2173s
Updating learning rate to 0.0
Validation loss decreased (0.5286 --> 0.5260).  Saving model state dict ...
Epoch: 8 cost time: 0.7218718528747559
Epoch: 8, Steps: 123 | Train Loss: 0.5505670 Vali Loss: 0.5259927 Best vali loss: 0.5259927

best validation loss 0.5259926589149835

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0040028231093, 'e_layers': 2, 'learning_rate': 0.0001736779693, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7613825
	speed: 0.0117s/iter; left time: 10.3823s
Updating learning rate to 0.0001670677451921968
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 1.0279781818389893
Epoch: 1, Steps: 123 | Train Loss: 0.7613825 Vali Loss: 0.6073811 Best vali loss: 0.6073811
	iters: 100, epoch: 2 | loss: 0.9400517
	speed: 0.0092s/iter; left time: 6.9996s
Updating learning rate to 0.0001482434195673695
Validation loss decreased (0.6074 --> 0.5798).  Saving model state dict ...
Epoch: 2 cost time: 0.7234506607055664
Epoch: 2, Steps: 123 | Train Loss: 0.9400517 Vali Loss: 0.5798207 Best vali loss: 0.5798207
	iters: 100, epoch: 3 | loss: 0.8548641
	speed: 0.0093s/iter; left time: 5.9437s
Updating learning rate to 0.00012007082535896135
Validation loss decreased (0.5798 --> 0.5575).  Saving model state dict ...
Epoch: 3 cost time: 0.727081298828125
Epoch: 3, Steps: 123 | Train Loss: 0.8548641 Vali Loss: 0.5575482 Best vali loss: 0.5575482
	iters: 100, epoch: 4 | loss: 0.5072020
	speed: 0.0094s/iter; left time: 4.8247s
Updating learning rate to 8.683898465e-05
Epoch: 4 cost time: 0.7225463390350342
Epoch: 4, Steps: 123 | Train Loss: 0.5072020 Vali Loss: 0.5629540 Best vali loss: 0.5575482
	iters: 100, epoch: 5 | loss: 0.5774852
	speed: 0.0090s/iter; left time: 3.5376s
Updating learning rate to 5.3607143941038664e-05
Validation loss decreased (0.5575 --> 0.5368).  Saving model state dict ...
Epoch: 5 cost time: 0.7177722454071045
Epoch: 5, Steps: 123 | Train Loss: 0.5774852 Vali Loss: 0.5368010 Best vali loss: 0.5368010
	iters: 100, epoch: 6 | loss: 0.6163809
	speed: 0.0094s/iter; left time: 2.5295s
Updating learning rate to 2.5434549732630498e-05
Validation loss decreased (0.5368 --> 0.5333).  Saving model state dict ...
Epoch: 6 cost time: 0.7225327491760254
Epoch: 6, Steps: 123 | Train Loss: 0.6163809 Vali Loss: 0.5333092 Best vali loss: 0.5333092
	iters: 100, epoch: 7 | loss: 0.5803509
	speed: 0.0093s/iter; left time: 1.3626s
Updating learning rate to 6.610224107803195e-06
Validation loss decreased (0.5333 --> 0.5307).  Saving model state dict ...
Epoch: 7 cost time: 0.7213573455810547
Epoch: 7, Steps: 123 | Train Loss: 0.5803509 Vali Loss: 0.5307088 Best vali loss: 0.5307088
	iters: 100, epoch: 8 | loss: 0.7498138
	speed: 0.0093s/iter; left time: 0.2238s
Updating learning rate to 0.0
Validation loss decreased (0.5307 --> 0.5298).  Saving model state dict ...
Epoch: 8 cost time: 0.7324075698852539
Epoch: 8, Steps: 123 | Train Loss: 0.7498138 Vali Loss: 0.5297992 Best vali loss: 0.5297992

best validation loss 0.5297991920267747

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616866
	speed: 0.0117s/iter; left time: 10.3254s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0252087116241455
Epoch: 1, Steps: 123 | Train Loss: 0.7616866 Vali Loss: 0.6075502 Best vali loss: 0.6075502
	iters: 100, epoch: 2 | loss: 0.9368417
	speed: 0.0093s/iter; left time: 7.1025s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5713).  Saving model state dict ...
Epoch: 2 cost time: 0.7243659496307373
Epoch: 2, Steps: 123 | Train Loss: 0.9368417 Vali Loss: 0.5712871 Best vali loss: 0.5712871
	iters: 100, epoch: 3 | loss: 0.8554940
	speed: 0.0094s/iter; left time: 6.0274s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5713 --> 0.5424).  Saving model state dict ...
Epoch: 3 cost time: 0.7287518978118896
Epoch: 3, Steps: 123 | Train Loss: 0.8554940 Vali Loss: 0.5423675 Best vali loss: 0.5423675
	iters: 100, epoch: 4 | loss: 0.5046452
	speed: 0.0094s/iter; left time: 4.8376s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5424 --> 0.5391).  Saving model state dict ...
Epoch: 4 cost time: 0.7254478931427002
Epoch: 4, Steps: 123 | Train Loss: 0.5046452 Vali Loss: 0.5390658 Best vali loss: 0.5390658
	iters: 100, epoch: 5 | loss: 0.5721505
	speed: 0.0093s/iter; left time: 3.6486s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5391 --> 0.5252).  Saving model state dict ...
Epoch: 5 cost time: 0.7182989120483398
Epoch: 5, Steps: 123 | Train Loss: 0.5721505 Vali Loss: 0.5251675 Best vali loss: 0.5251675
	iters: 100, epoch: 6 | loss: 0.6175165
	speed: 0.0095s/iter; left time: 2.5570s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7287144660949707
Epoch: 6, Steps: 123 | Train Loss: 0.6175165 Vali Loss: 0.5264017 Best vali loss: 0.5251675
	iters: 100, epoch: 7 | loss: 0.5775301
	speed: 0.0091s/iter; left time: 1.3389s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5252 --> 0.5218).  Saving model state dict ...
Epoch: 7 cost time: 0.7336061000823975
Epoch: 7, Steps: 123 | Train Loss: 0.5775301 Vali Loss: 0.5217838 Best vali loss: 0.5217838
	iters: 100, epoch: 8 | loss: 0.7406800
	speed: 0.0093s/iter; left time: 0.2242s
Updating learning rate to 0.0
Validation loss decreased (0.5218 --> 0.5209).  Saving model state dict ...
Epoch: 8 cost time: 0.7245049476623535
Epoch: 8, Steps: 123 | Train Loss: 0.7406800 Vali Loss: 0.5208690 Best vali loss: 0.5208690

best validation loss 0.5208690469875097

[INFO][abstract_intensifier.py:595] Added config 99d3ef and rejected config 2ed099 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010496912273, 'e_layers': 2, 'learning_rate': 0.0001861198925, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0011423
	speed: 0.0108s/iter; left time: 9.5719s
Updating learning rate to 0.00017903612588697547
Validation loss decreased (inf --> 0.5998).  Saving model state dict ...
Epoch: 1 cost time: 0.9087913036346436
Epoch: 1, Steps: 123 | Train Loss: 1.0011423 Vali Loss: 0.5997755 Best vali loss: 0.5997755
	iters: 100, epoch: 2 | loss: 0.8546094
	speed: 0.0075s/iter; left time: 5.7512s
Updating learning rate to 0.00015886326530023062
Validation loss decreased (0.5998 --> 0.5773).  Saving model state dict ...
Epoch: 2 cost time: 0.5812821388244629
Epoch: 2, Steps: 123 | Train Loss: 0.8546094 Vali Loss: 0.5773292 Best vali loss: 0.5773292
	iters: 100, epoch: 3 | loss: 0.8409752
	speed: 0.0077s/iter; left time: 4.9147s
Updating learning rate to 0.00012867244589666077
Validation loss decreased (0.5773 --> 0.5510).  Saving model state dict ...
Epoch: 3 cost time: 0.600313663482666
Epoch: 3, Steps: 123 | Train Loss: 0.8409752 Vali Loss: 0.5509712 Best vali loss: 0.5509712

best validation loss 0.5509712203461392

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004496103464, 'e_layers': 2, 'learning_rate': 0.0001753114565, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617373
	speed: 0.0117s/iter; left time: 10.3114s
Updating learning rate to 0.0001753114565
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0271122455596924
Epoch: 1, Steps: 123 | Train Loss: 0.7617373 Vali Loss: 0.6074972 Best vali loss: 0.6074972
	iters: 100, epoch: 2 | loss: 0.9373364
	speed: 0.0093s/iter; left time: 7.0986s
Updating learning rate to 8.765572825e-05
Validation loss decreased (0.6075 --> 0.5695).  Saving model state dict ...
Epoch: 2 cost time: 0.7252697944641113
Epoch: 2, Steps: 123 | Train Loss: 0.9373364 Vali Loss: 0.5695078 Best vali loss: 0.5695078
	iters: 100, epoch: 3 | loss: 0.8663670
	speed: 0.0094s/iter; left time: 6.0167s
Updating learning rate to 4.3827864125e-05
Validation loss decreased (0.5695 --> 0.5591).  Saving model state dict ...
Epoch: 3 cost time: 0.7254574298858643
Epoch: 3, Steps: 123 | Train Loss: 0.8663670 Vali Loss: 0.5590786 Best vali loss: 0.5590786

best validation loss 0.5590786081064305

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0046311692492, 'e_layers': 2, 'learning_rate': 0.0001749160751, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7615213
	speed: 0.0116s/iter; left time: 10.2678s
Updating learning rate to 0.0001749160751
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0259699821472168
Epoch: 1, Steps: 123 | Train Loss: 0.7615213 Vali Loss: 0.6074731 Best vali loss: 0.6074731
	iters: 100, epoch: 2 | loss: 0.9328341
	speed: 0.0093s/iter; left time: 7.1091s
Updating learning rate to 8.745803755e-05
Validation loss decreased (0.6075 --> 0.5565).  Saving model state dict ...
Epoch: 2 cost time: 0.7288379669189453
Epoch: 2, Steps: 123 | Train Loss: 0.9328341 Vali Loss: 0.5565260 Best vali loss: 0.5565260
	iters: 100, epoch: 3 | loss: 0.8554584
	speed: 0.0095s/iter; left time: 6.0950s
Updating learning rate to 4.3729018775e-05
Validation loss decreased (0.5565 --> 0.5563).  Saving model state dict ...
Epoch: 3 cost time: 0.7340049743652344
Epoch: 3, Steps: 123 | Train Loss: 0.8554584 Vali Loss: 0.5562699 Best vali loss: 0.5562699

best validation loss 0.5562699335088116

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010496912273, 'e_layers': 2, 'learning_rate': 0.0001861198925, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8713810
	speed: 0.0115s/iter; left time: 5.9204s
Updating learning rate to 9.305994625e-05
Epoch: 4 cost time: 0.9664700031280518
Epoch: 4, Steps: 123 | Train Loss: 0.8713810 Vali Loss: 0.5578560 Best vali loss: 0.5509712
	iters: 100, epoch: 5 | loss: 0.7811613
	speed: 0.0080s/iter; left time: 3.1487s
Updating learning rate to 5.7447446603339245e-05
Validation loss decreased (0.5510 --> 0.5441).  Saving model state dict ...
Epoch: 5 cost time: 0.6426236629486084
Epoch: 5, Steps: 123 | Train Loss: 0.7811613 Vali Loss: 0.5440832 Best vali loss: 0.5440832
	iters: 100, epoch: 6 | loss: 0.7502266
	speed: 0.0081s/iter; left time: 2.1854s
Updating learning rate to 2.7256627199769383e-05
Epoch: 6 cost time: 0.6190133094787598
Epoch: 6, Steps: 123 | Train Loss: 0.7502266 Vali Loss: 0.5474680 Best vali loss: 0.5440832
	iters: 100, epoch: 7 | loss: 0.7810924
	speed: 0.0079s/iter; left time: 1.1662s
Updating learning rate to 7.083766613024529e-06
Validation loss decreased (0.5441 --> 0.5400).  Saving model state dict ...
Epoch: 7 cost time: 0.624420166015625
Epoch: 7, Steps: 123 | Train Loss: 0.7810924 Vali Loss: 0.5399500 Best vali loss: 0.5399500
	iters: 100, epoch: 8 | loss: 0.6748194
	speed: 0.0079s/iter; left time: 0.1900s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6001343727111816
Epoch: 8, Steps: 123 | Train Loss: 0.6748194 Vali Loss: 0.5404080 Best vali loss: 0.5399500

best validation loss 0.5399500338471857

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047516892064, 'e_layers': 2, 'learning_rate': 0.0001754742464, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7615589
	speed: 0.0116s/iter; left time: 10.3013s
Updating learning rate to 0.0001754742464
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0280444622039795
Epoch: 1, Steps: 123 | Train Loss: 0.7615589 Vali Loss: 0.6075531 Best vali loss: 0.6075531
	iters: 100, epoch: 2 | loss: 0.9346862
	speed: 0.0093s/iter; left time: 7.1208s
Updating learning rate to 8.77371232e-05
Validation loss decreased (0.6076 --> 0.5634).  Saving model state dict ...
Epoch: 2 cost time: 0.7297897338867188
Epoch: 2, Steps: 123 | Train Loss: 0.9346862 Vali Loss: 0.5634464 Best vali loss: 0.5634464
	iters: 100, epoch: 3 | loss: 0.8570610
	speed: 0.0095s/iter; left time: 6.0692s
Updating learning rate to 4.38685616e-05
Validation loss decreased (0.5634 --> 0.5553).  Saving model state dict ...
Epoch: 3 cost time: 0.7345058917999268
Epoch: 3, Steps: 123 | Train Loss: 0.8570610 Vali Loss: 0.5553329 Best vali loss: 0.5553329
	iters: 100, epoch: 4 | loss: 0.4961232
	speed: 0.0096s/iter; left time: 4.9287s
Updating learning rate to 2.19342808e-05
Validation loss decreased (0.5553 --> 0.5533).  Saving model state dict ...
Epoch: 4 cost time: 0.7285876274108887
Epoch: 4, Steps: 123 | Train Loss: 0.4961232 Vali Loss: 0.5532554 Best vali loss: 0.5532554
	iters: 100, epoch: 5 | loss: 0.5858306
	speed: 0.0094s/iter; left time: 3.6915s
Updating learning rate to 1.09671404e-05
Validation loss decreased (0.5533 --> 0.5436).  Saving model state dict ...
Epoch: 5 cost time: 0.7334983348846436
Epoch: 5, Steps: 123 | Train Loss: 0.5858306 Vali Loss: 0.5436292 Best vali loss: 0.5436292
	iters: 100, epoch: 6 | loss: 0.6302485
	speed: 0.0095s/iter; left time: 2.5528s
Updating learning rate to 5.4835702e-06
Validation loss decreased (0.5436 --> 0.5386).  Saving model state dict ...
Epoch: 6 cost time: 0.7293314933776855
Epoch: 6, Steps: 123 | Train Loss: 0.6302485 Vali Loss: 0.5385548 Best vali loss: 0.5385548
	iters: 100, epoch: 7 | loss: 0.6154901
	speed: 0.0093s/iter; left time: 1.3727s
Updating learning rate to 2.7417851e-06
Validation loss decreased (0.5386 --> 0.5384).  Saving model state dict ...
Epoch: 7 cost time: 0.7269165515899658
Epoch: 7, Steps: 123 | Train Loss: 0.6154901 Vali Loss: 0.5383981 Best vali loss: 0.5383981
	iters: 100, epoch: 8 | loss: 0.7705929
	speed: 0.0093s/iter; left time: 0.2233s
Updating learning rate to 1.37089255e-06
Validation loss decreased (0.5384 --> 0.5363).  Saving model state dict ...
Epoch: 8 cost time: 0.7238152027130127
Epoch: 8, Steps: 123 | Train Loss: 0.7705929 Vali Loss: 0.5362766 Best vali loss: 0.5362766

best validation loss 0.5362766401075975

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0027098120737, 'e_layers': 3, 'learning_rate': 0.0013106890831, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7737862
	speed: 0.0111s/iter; left time: 20.6064s
	iters: 200, epoch: 1 | loss: 0.9023495
	speed: 0.0048s/iter; left time: 8.4178s
Updating learning rate to 0.0012608039502310375
Validation loss decreased (inf --> 0.6066).  Saving model state dict ...
Epoch: 1 cost time: 1.5277397632598877
Epoch: 1, Steps: 245 | Train Loss: 0.8380678 Vali Loss: 0.6066014 Best vali loss: 0.6066014
	iters: 100, epoch: 2 | loss: 0.5577813
	speed: 0.0098s/iter; left time: 15.8325s
	iters: 200, epoch: 2 | loss: 1.1081560
	speed: 0.0050s/iter; left time: 7.5385s
Updating learning rate to 0.0011187431108935942
Epoch: 2 cost time: 1.258427619934082
Epoch: 2, Steps: 245 | Train Loss: 0.8329687 Vali Loss: 0.6156294 Best vali loss: 0.6066014
	iters: 100, epoch: 3 | loss: 1.3326285
	speed: 0.0096s/iter; left time: 13.1794s
	iters: 200, epoch: 3 | loss: 0.6355883
	speed: 0.0049s/iter; left time: 6.2254s
Updating learning rate to 0.0009061340400920802
Epoch: 3 cost time: 1.2178969383239746
Epoch: 3, Steps: 245 | Train Loss: 0.9841084 Vali Loss: 0.6103929 Best vali loss: 0.6066014
	iters: 100, epoch: 4 | loss: 0.9971862
	speed: 0.0092s/iter; left time: 10.3578s
	iters: 200, epoch: 4 | loss: 0.7065225
	speed: 0.0046s/iter; left time: 4.7697s
Updating learning rate to 0.00065534454155
Epoch: 4 cost time: 1.1778137683868408
Epoch: 4, Steps: 245 | Train Loss: 0.8518543 Vali Loss: 0.6223776 Best vali loss: 0.6066014
	iters: 100, epoch: 5 | loss: 0.6610087
	speed: 0.0094s/iter; left time: 8.2558s
	iters: 200, epoch: 5 | loss: 1.1185278
	speed: 0.0048s/iter; left time: 3.7408s
Updating learning rate to 0.00040455504300791984
Epoch: 5 cost time: 1.2143285274505615
Epoch: 5, Steps: 245 | Train Loss: 0.8897682 Vali Loss: 0.6283000 Best vali loss: 0.6066014
	iters: 100, epoch: 6 | loss: 0.9610577
	speed: 0.0095s/iter; left time: 6.0526s
	iters: 200, epoch: 6 | loss: 0.8427097
	speed: 0.0048s/iter; left time: 2.5521s
Updating learning rate to 0.0001919459722064059
Epoch: 6 cost time: 1.2121844291687012
Epoch: 6, Steps: 245 | Train Loss: 0.9018837 Vali Loss: 0.6118413 Best vali loss: 0.6066014
	iters: 100, epoch: 7 | loss: 0.8944065
	speed: 0.0096s/iter; left time: 3.7628s
	iters: 200, epoch: 7 | loss: 0.6527032
	speed: 0.0048s/iter; left time: 1.4077s
Updating learning rate to 4.9885132868962476e-05
Epoch: 7 cost time: 1.2340333461761475
Epoch: 7, Steps: 245 | Train Loss: 0.7735549 Vali Loss: 0.6201614 Best vali loss: 0.6066014
	iters: 100, epoch: 8 | loss: 0.7500857
	speed: 0.0093s/iter; left time: 1.3526s
	iters: 200, epoch: 8 | loss: 0.7305355
	speed: 0.0043s/iter; left time: 0.1996s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1397335529327393
Epoch: 8, Steps: 245 | Train Loss: 0.7403106 Vali Loss: 0.6201194 Best vali loss: 0.6066014

best validation loss 0.6066013956886372

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0119165296481, 'e_layers': 2, 'learning_rate': 0.00017810065, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7630960
	speed: 0.0118s/iter; left time: 10.4738s
Updating learning rate to 0.00017810065
Validation loss decreased (inf --> 0.6079).  Saving model state dict ...
Epoch: 1 cost time: 1.0464401245117188
Epoch: 1, Steps: 123 | Train Loss: 0.7630960 Vali Loss: 0.6078580 Best vali loss: 0.6078580
	iters: 100, epoch: 2 | loss: 0.9422277
	speed: 0.0093s/iter; left time: 7.1027s
Updating learning rate to 8.9050325e-05
Validation loss decreased (0.6079 --> 0.5730).  Saving model state dict ...
Epoch: 2 cost time: 0.7269878387451172
Epoch: 2, Steps: 123 | Train Loss: 0.9422277 Vali Loss: 0.5729833 Best vali loss: 0.5729833
	iters: 100, epoch: 3 | loss: 0.8590954
	speed: 0.0094s/iter; left time: 6.0362s
Updating learning rate to 4.45251625e-05
Validation loss decreased (0.5730 --> 0.5535).  Saving model state dict ...
Epoch: 3 cost time: 0.7216007709503174
Epoch: 3, Steps: 123 | Train Loss: 0.8590954 Vali Loss: 0.5534969 Best vali loss: 0.5534969

best validation loss 0.553496930125906

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.011783308852, 'e_layers': 2, 'learning_rate': 0.0001756782711, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7628281
	speed: 0.0117s/iter; left time: 10.3570s
Updating learning rate to 0.0001756782711
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0403237342834473
Epoch: 1, Steps: 123 | Train Loss: 0.7628281 Vali Loss: 0.6076351 Best vali loss: 0.6076351
	iters: 100, epoch: 2 | loss: 0.9397942
	speed: 0.0093s/iter; left time: 7.0690s
Updating learning rate to 8.783913555e-05
Validation loss decreased (0.6076 --> 0.5770).  Saving model state dict ...
Epoch: 2 cost time: 0.724456787109375
Epoch: 2, Steps: 123 | Train Loss: 0.9397942 Vali Loss: 0.5769805 Best vali loss: 0.5769805
	iters: 100, epoch: 3 | loss: 0.8581390
	speed: 0.0094s/iter; left time: 6.0231s
Updating learning rate to 4.3919567775e-05
Validation loss decreased (0.5770 --> 0.5568).  Saving model state dict ...
Epoch: 3 cost time: 0.7250838279724121
Epoch: 3, Steps: 123 | Train Loss: 0.8581390 Vali Loss: 0.5568263 Best vali loss: 0.5568263

best validation loss 0.5568263171062267

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0032542875463, 'e_layers': 2, 'learning_rate': 0.0004543928087, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8000114
	speed: 0.0103s/iter; left time: 19.0935s
	iters: 200, epoch: 1 | loss: 0.7690631
	speed: 0.0037s/iter; left time: 6.4442s
Updating learning rate to 0.0004543928087
Validation loss decreased (inf --> 0.6280).  Saving model state dict ...
Epoch: 1 cost time: 1.2890913486480713
Epoch: 1, Steps: 245 | Train Loss: 0.7845373 Vali Loss: 0.6279637 Best vali loss: 0.6279637
	iters: 100, epoch: 2 | loss: 1.1221561
	speed: 0.0083s/iter; left time: 13.3838s
	iters: 200, epoch: 2 | loss: 0.9154525
	speed: 0.0037s/iter; left time: 5.6785s
Updating learning rate to 0.00022719640435
Validation loss decreased (0.6280 --> 0.6045).  Saving model state dict ...
Epoch: 2 cost time: 0.9730689525604248
Epoch: 2, Steps: 245 | Train Loss: 1.0188043 Vali Loss: 0.6045292 Best vali loss: 0.6045292
	iters: 100, epoch: 3 | loss: 0.8939306
	speed: 0.0086s/iter; left time: 11.8167s
	iters: 200, epoch: 3 | loss: 0.6851529
	speed: 0.0042s/iter; left time: 5.2971s
Updating learning rate to 0.000113598202175
Epoch: 3 cost time: 1.066727876663208
Epoch: 3, Steps: 245 | Train Loss: 0.7895418 Vali Loss: 0.6263500 Best vali loss: 0.6045292

best validation loss 0.6045291516473038

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0119165296481, 'e_layers': 2, 'learning_rate': 0.00017810065, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6104372
	speed: 0.0121s/iter; left time: 6.2489s
Updating learning rate to 2.226258125e-05
Validation loss decreased (0.5535 --> 0.5417).  Saving model state dict ...
Epoch: 4 cost time: 1.042649269104004
Epoch: 4, Steps: 123 | Train Loss: 0.6104372 Vali Loss: 0.5417258 Best vali loss: 0.5417258
	iters: 100, epoch: 5 | loss: 0.8615376
	speed: 0.0094s/iter; left time: 3.6841s
Updating learning rate to 1.1131290625e-05
Validation loss decreased (0.5417 --> 0.5377).  Saving model state dict ...
Epoch: 5 cost time: 0.7165842056274414
Epoch: 5, Steps: 123 | Train Loss: 0.8615376 Vali Loss: 0.5377108 Best vali loss: 0.5377108
	iters: 100, epoch: 6 | loss: 0.8290421
	speed: 0.0093s/iter; left time: 2.4980s
Updating learning rate to 5.5656453125e-06
Validation loss decreased (0.5377 --> 0.5359).  Saving model state dict ...
Epoch: 6 cost time: 0.7164103984832764
Epoch: 6, Steps: 123 | Train Loss: 0.8290421 Vali Loss: 0.5358887 Best vali loss: 0.5358887
	iters: 100, epoch: 7 | loss: 0.4946819
	speed: 0.0094s/iter; left time: 1.3778s
Updating learning rate to 2.78282265625e-06
Epoch: 7 cost time: 0.7250936031341553
Epoch: 7, Steps: 123 | Train Loss: 0.4946819 Vali Loss: 0.5363092 Best vali loss: 0.5358887
	iters: 100, epoch: 8 | loss: 0.5789059
	speed: 0.0089s/iter; left time: 0.2136s
Updating learning rate to 1.391411328125e-06
Validation loss decreased (0.5359 --> 0.5349).  Saving model state dict ...
Epoch: 8 cost time: 0.7144625186920166
Epoch: 8, Steps: 123 | Train Loss: 0.5789059 Vali Loss: 0.5348838 Best vali loss: 0.5348838

best validation loss 0.5348838321426741

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0104778458975, 'e_layers': 2, 'learning_rate': 0.0001750098247, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7626227
	speed: 0.0118s/iter; left time: 10.4021s
Updating learning rate to 0.0001750098247
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.039494514465332
Epoch: 1, Steps: 123 | Train Loss: 0.7626227 Vali Loss: 0.6075516 Best vali loss: 0.6075516
	iters: 100, epoch: 2 | loss: 0.9430345
	speed: 0.0093s/iter; left time: 7.0621s
Updating learning rate to 8.750491235e-05
Validation loss decreased (0.6076 --> 0.5781).  Saving model state dict ...
Epoch: 2 cost time: 0.7220818996429443
Epoch: 2, Steps: 123 | Train Loss: 0.9430345 Vali Loss: 0.5780505 Best vali loss: 0.5780505
	iters: 100, epoch: 3 | loss: 0.8660960
	speed: 0.0094s/iter; left time: 5.9966s
Updating learning rate to 4.3752456175e-05
Validation loss decreased (0.5781 --> 0.5568).  Saving model state dict ...
Epoch: 3 cost time: 0.7197747230529785
Epoch: 3, Steps: 123 | Train Loss: 0.8660960 Vali Loss: 0.5568328 Best vali loss: 0.5568328
	iters: 100, epoch: 4 | loss: 0.4999711
	speed: 0.0092s/iter; left time: 4.7495s
Updating learning rate to 2.18762280875e-05
Validation loss decreased (0.5568 --> 0.5547).  Saving model state dict ...
Epoch: 4 cost time: 0.7173357009887695
Epoch: 4, Steps: 123 | Train Loss: 0.4999711 Vali Loss: 0.5546895 Best vali loss: 0.5546895
	iters: 100, epoch: 5 | loss: 0.5880722
	speed: 0.0094s/iter; left time: 3.6780s
Updating learning rate to 1.093811404375e-05
Validation loss decreased (0.5547 --> 0.5463).  Saving model state dict ...
Epoch: 5 cost time: 0.7298190593719482
Epoch: 5, Steps: 123 | Train Loss: 0.5880722 Vali Loss: 0.5462530 Best vali loss: 0.5462530
	iters: 100, epoch: 6 | loss: 0.6294587
	speed: 0.0093s/iter; left time: 2.5095s
Updating learning rate to 5.469057021875e-06
Validation loss decreased (0.5463 --> 0.5402).  Saving model state dict ...
Epoch: 6 cost time: 0.7288515567779541
Epoch: 6, Steps: 123 | Train Loss: 0.6294587 Vali Loss: 0.5401560 Best vali loss: 0.5401560
	iters: 100, epoch: 7 | loss: 0.6159282
	speed: 0.0094s/iter; left time: 1.3803s
Updating learning rate to 2.7345285109375e-06
Validation loss decreased (0.5402 --> 0.5399).  Saving model state dict ...
Epoch: 7 cost time: 0.7284550666809082
Epoch: 7, Steps: 123 | Train Loss: 0.6159282 Vali Loss: 0.5398718 Best vali loss: 0.5398718
	iters: 100, epoch: 8 | loss: 0.7782003
	speed: 0.0093s/iter; left time: 0.2227s
Updating learning rate to 1.36726425546875e-06
Validation loss decreased (0.5399 --> 0.5379).  Saving model state dict ...
Epoch: 8 cost time: 0.7190611362457275
Epoch: 8, Steps: 123 | Train Loss: 0.7782003 Vali Loss: 0.5379192 Best vali loss: 0.5379192

best validation loss 0.5379191731369534

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0087932658569, 'e_layers': 4, 'learning_rate': 0.0002601337376, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2844385
	speed: 0.0114s/iter; left time: 88.3638s
	iters: 200, epoch: 1 | loss: 0.5329714
	speed: 0.0052s/iter; left time: 39.5010s
	iters: 300, epoch: 1 | loss: 0.8183239
	speed: 0.0052s/iter; left time: 39.2437s
	iters: 400, epoch: 1 | loss: 0.9436459
	speed: 0.0052s/iter; left time: 38.8562s
	iters: 500, epoch: 1 | loss: 0.9100276
	speed: 0.0052s/iter; left time: 38.4374s
	iters: 600, epoch: 1 | loss: 1.0553023
	speed: 0.0052s/iter; left time: 37.8920s
	iters: 700, epoch: 1 | loss: 0.2585091
	speed: 0.0051s/iter; left time: 36.6060s
	iters: 800, epoch: 1 | loss: 0.5398960
	speed: 0.0052s/iter; left time: 36.6638s
	iters: 900, epoch: 1 | loss: 1.1537495
	speed: 0.0052s/iter; left time: 36.3106s
Updating learning rate to 0.0002601337376
Validation loss decreased (inf --> 0.5935).  Saving model state dict ...
Epoch: 1 cost time: 5.452152729034424
Epoch: 1, Steps: 979 | Train Loss: 0.7218738 Vali Loss: 0.5934665 Best vali loss: 0.5934665
	iters: 100, epoch: 2 | loss: 0.3027807
	speed: 0.0162s/iter; left time: 109.4335s
	iters: 200, epoch: 2 | loss: 0.7793850
	speed: 0.0052s/iter; left time: 34.3282s
	iters: 300, epoch: 2 | loss: 1.4003999
	speed: 0.0050s/iter; left time: 32.8058s
	iters: 400, epoch: 2 | loss: 0.5739073
	speed: 0.0049s/iter; left time: 31.3190s
	iters: 500, epoch: 2 | loss: 0.8753101
	speed: 0.0046s/iter; left time: 29.1957s
	iters: 600, epoch: 2 | loss: 1.0138727
	speed: 0.0044s/iter; left time: 27.7926s
	iters: 700, epoch: 2 | loss: 0.5223737
	speed: 0.0045s/iter; left time: 27.4124s
	iters: 800, epoch: 2 | loss: 1.1111557
	speed: 0.0044s/iter; left time: 26.8340s
	iters: 900, epoch: 2 | loss: 1.3572701
	speed: 0.0044s/iter; left time: 26.4747s
Updating learning rate to 0.0001300668688
Epoch: 2 cost time: 4.659823179244995
Epoch: 2, Steps: 979 | Train Loss: 0.8818284 Vali Loss: 0.6299688 Best vali loss: 0.5934665
	iters: 100, epoch: 3 | loss: 0.5880414
	speed: 0.0150s/iter; left time: 86.5925s
	iters: 200, epoch: 3 | loss: 1.0076571
	speed: 0.0053s/iter; left time: 30.1290s
	iters: 300, epoch: 3 | loss: 0.7297493
	speed: 0.0053s/iter; left time: 29.7198s
	iters: 400, epoch: 3 | loss: 0.8684395
	speed: 0.0051s/iter; left time: 27.9567s
	iters: 500, epoch: 3 | loss: 1.6904104
	speed: 0.0051s/iter; left time: 27.1786s
	iters: 600, epoch: 3 | loss: 0.5939898
	speed: 0.0049s/iter; left time: 25.9476s
	iters: 700, epoch: 3 | loss: 1.3841642
	speed: 0.0044s/iter; left time: 23.0213s
	iters: 800, epoch: 3 | loss: 0.5362279
	speed: 0.0044s/iter; left time: 22.5044s
	iters: 900, epoch: 3 | loss: 0.7486781
	speed: 0.0047s/iter; left time: 23.4183s
Updating learning rate to 6.50334344e-05
Epoch: 3 cost time: 4.862967014312744
Epoch: 3, Steps: 979 | Train Loss: 0.9052620 Vali Loss: 0.6089782 Best vali loss: 0.5934665
	iters: 100, epoch: 4 | loss: 0.9509242
	speed: 0.0145s/iter; left time: 69.5570s
	iters: 200, epoch: 4 | loss: 1.4823657
	speed: 0.0046s/iter; left time: 21.6132s
	iters: 300, epoch: 4 | loss: 0.8627667
	speed: 0.0046s/iter; left time: 21.2680s
	iters: 400, epoch: 4 | loss: 0.3780762
	speed: 0.0048s/iter; left time: 21.4894s
	iters: 500, epoch: 4 | loss: 0.7518546
	speed: 0.0045s/iter; left time: 19.6224s
	iters: 600, epoch: 4 | loss: 0.9593998
	speed: 0.0047s/iter; left time: 19.9857s
	iters: 700, epoch: 4 | loss: 0.8203199
	speed: 0.0047s/iter; left time: 19.5796s
	iters: 800, epoch: 4 | loss: 0.7117860
	speed: 0.0047s/iter; left time: 19.0821s
	iters: 900, epoch: 4 | loss: 0.8303297
	speed: 0.0047s/iter; left time: 18.6493s
Updating learning rate to 3.25167172e-05
Validation loss decreased (0.5935 --> 0.5750).  Saving model state dict ...
Epoch: 4 cost time: 4.590203285217285
Epoch: 4, Steps: 979 | Train Loss: 0.8608692 Vali Loss: 0.5750044 Best vali loss: 0.5750044
	iters: 100, epoch: 5 | loss: 0.4457763
	speed: 0.0151s/iter; left time: 57.5329s
	iters: 200, epoch: 5 | loss: 1.0069685
	speed: 0.0048s/iter; left time: 17.7372s
	iters: 300, epoch: 5 | loss: 0.9732117
	speed: 0.0047s/iter; left time: 17.1478s
	iters: 400, epoch: 5 | loss: 0.2765813
	speed: 0.0047s/iter; left time: 16.5775s
	iters: 500, epoch: 5 | loss: 0.9878314
	speed: 0.0048s/iter; left time: 16.3284s
	iters: 600, epoch: 5 | loss: 0.2565802
	speed: 0.0046s/iter; left time: 15.3996s
	iters: 700, epoch: 5 | loss: 0.5837706
	speed: 0.0045s/iter; left time: 14.6239s
	iters: 800, epoch: 5 | loss: 1.0588136
	speed: 0.0044s/iter; left time: 13.7957s
	iters: 900, epoch: 5 | loss: 0.9980792
	speed: 0.0045s/iter; left time: 13.6287s
Updating learning rate to 1.62583586e-05
Epoch: 5 cost time: 4.586565971374512
Epoch: 5, Steps: 979 | Train Loss: 0.7319570 Vali Loss: 0.5802566 Best vali loss: 0.5750044
	iters: 100, epoch: 6 | loss: 0.6289814
	speed: 0.0144s/iter; left time: 40.8482s
	iters: 200, epoch: 6 | loss: 0.5359015
	speed: 0.0048s/iter; left time: 13.0056s
	iters: 300, epoch: 6 | loss: 0.8889455
	speed: 0.0047s/iter; left time: 12.3958s
	iters: 400, epoch: 6 | loss: 0.9305230
	speed: 0.0047s/iter; left time: 12.0455s
	iters: 500, epoch: 6 | loss: 0.6075270
	speed: 0.0047s/iter; left time: 11.5773s
	iters: 600, epoch: 6 | loss: 0.7027946
	speed: 0.0048s/iter; left time: 11.1587s
	iters: 700, epoch: 6 | loss: 0.3996351
	speed: 0.0048s/iter; left time: 10.7083s
	iters: 800, epoch: 6 | loss: 0.5868152
	speed: 0.0046s/iter; left time: 9.9048s
	iters: 900, epoch: 6 | loss: 0.9691828
	speed: 0.0047s/iter; left time: 9.6439s
Updating learning rate to 8.1291793e-06
Epoch: 6 cost time: 4.643146753311157
Epoch: 6, Steps: 979 | Train Loss: 0.6944785 Vali Loss: 0.5886286 Best vali loss: 0.5750044
	iters: 100, epoch: 7 | loss: 0.5705859
	speed: 0.0148s/iter; left time: 27.5103s
	iters: 200, epoch: 7 | loss: 0.8972478
	speed: 0.0053s/iter; left time: 9.3302s
	iters: 300, epoch: 7 | loss: 1.5596365
	speed: 0.0051s/iter; left time: 8.4974s
	iters: 400, epoch: 7 | loss: 0.3790870
	speed: 0.0050s/iter; left time: 7.8716s
	iters: 500, epoch: 7 | loss: 0.4503857
	speed: 0.0050s/iter; left time: 7.2596s
	iters: 600, epoch: 7 | loss: 1.1143112
	speed: 0.0051s/iter; left time: 6.8860s
	iters: 700, epoch: 7 | loss: 0.4248075
	speed: 0.0050s/iter; left time: 6.2541s
	iters: 800, epoch: 7 | loss: 0.7136438
	speed: 0.0046s/iter; left time: 5.3786s
	iters: 900, epoch: 7 | loss: 1.3373514
	speed: 0.0045s/iter; left time: 4.7582s
Updating learning rate to 4.06458965e-06
Epoch: 7 cost time: 4.856019020080566
Epoch: 7, Steps: 979 | Train Loss: 0.8274508 Vali Loss: 0.5873703 Best vali loss: 0.5750044
	iters: 100, epoch: 8 | loss: 0.7051250
	speed: 0.0150s/iter; left time: 13.2117s
	iters: 200, epoch: 8 | loss: 0.7663569
	speed: 0.0049s/iter; left time: 3.8296s
	iters: 300, epoch: 8 | loss: 0.8110020
	speed: 0.0048s/iter; left time: 3.2324s
	iters: 400, epoch: 8 | loss: 0.8159540
	speed: 0.0048s/iter; left time: 2.7896s
	iters: 500, epoch: 8 | loss: 1.0207218
	speed: 0.0050s/iter; left time: 2.3837s
	iters: 600, epoch: 8 | loss: 0.4422469
	speed: 0.0052s/iter; left time: 1.9678s
	iters: 700, epoch: 8 | loss: 0.4199249
	speed: 0.0051s/iter; left time: 1.4208s
	iters: 800, epoch: 8 | loss: 0.2301280
	speed: 0.0050s/iter; left time: 0.9089s
	iters: 900, epoch: 8 | loss: 0.6034148
	speed: 0.0051s/iter; left time: 0.4061s
Updating learning rate to 2.032294825e-06
Epoch: 8 cost time: 4.933244466781616
Epoch: 8, Steps: 979 | Train Loss: 0.6460971 Vali Loss: 0.5844779 Best vali loss: 0.5750044

best validation loss 0.5750043585531031

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044356443272, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617257
	speed: 0.0128s/iter; left time: 11.3066s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.197542428970337
Epoch: 1, Steps: 123 | Train Loss: 0.7617257 Vali Loss: 0.6075469 Best vali loss: 0.6075469
	iters: 100, epoch: 2 | loss: 0.9354843
	speed: 0.0092s/iter; left time: 7.0271s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6075 --> 0.5681).  Saving model state dict ...
Epoch: 2 cost time: 0.7278933525085449
Epoch: 2, Steps: 123 | Train Loss: 0.9354843 Vali Loss: 0.5680708 Best vali loss: 0.5680708
	iters: 100, epoch: 3 | loss: 0.8610733
	speed: 0.0095s/iter; left time: 6.0427s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5681 --> 0.5410).  Saving model state dict ...
Epoch: 3 cost time: 0.7261803150177002
Epoch: 3, Steps: 123 | Train Loss: 0.8610733 Vali Loss: 0.5410391 Best vali loss: 0.5410391

best validation loss 0.5410390904467175

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0056683409559, 'e_layers': 2, 'learning_rate': 0.0001758432838, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617046
	speed: 0.0118s/iter; left time: 10.4794s
Updating learning rate to 0.00016915064731619676
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.02842116355896
Epoch: 1, Steps: 123 | Train Loss: 0.7617046 Vali Loss: 0.6074695 Best vali loss: 0.6074695
	iters: 100, epoch: 2 | loss: 0.9312277
	speed: 0.0092s/iter; left time: 7.0185s
Updating learning rate to 0.0001500916311005453
Validation loss decreased (0.6075 --> 0.5624).  Saving model state dict ...
Epoch: 2 cost time: 0.7221760749816895
Epoch: 2, Steps: 123 | Train Loss: 0.9312277 Vali Loss: 0.5624000 Best vali loss: 0.5624000
	iters: 100, epoch: 3 | loss: 0.8553482
	speed: 0.0093s/iter; left time: 5.9743s
Updating learning rate to 0.0001215677976014663
Validation loss decreased (0.5624 --> 0.5580).  Saving model state dict ...
Epoch: 3 cost time: 0.7181339263916016
Epoch: 3, Steps: 123 | Train Loss: 0.8553482 Vali Loss: 0.5579529 Best vali loss: 0.5579529

best validation loss 0.5579528563941645

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0021375647588, 'e_layers': 1, 'learning_rate': 0.0011575940559, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9554556
	speed: 0.0099s/iter; left time: 8.7393s
Updating learning rate to 0.0011135357555513681
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 0.7951207160949707
Epoch: 1, Steps: 123 | Train Loss: 0.9554556 Vali Loss: 0.6080799 Best vali loss: 0.6080799
	iters: 100, epoch: 2 | loss: 0.8576602
	speed: 0.0064s/iter; left time: 4.8892s
Updating learning rate to 0.0009880683313440645
Validation loss decreased (0.6081 --> 0.5965).  Saving model state dict ...
Epoch: 2 cost time: 0.475466251373291
Epoch: 2, Steps: 123 | Train Loss: 0.8576602 Vali Loss: 0.5964779 Best vali loss: 0.5964779
	iters: 100, epoch: 3 | loss: 0.7642062
	speed: 0.0065s/iter; left time: 4.1547s
Updating learning rate to 0.0008002930612486188
Epoch: 3 cost time: 0.4816570281982422
Epoch: 3, Steps: 123 | Train Loss: 0.7642062 Vali Loss: 0.6373778 Best vali loss: 0.5964779

best validation loss 0.5964779011467329

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044356443272, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6004393
	speed: 0.0123s/iter; left time: 6.3302s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5410 --> 0.5342).  Saving model state dict ...
Epoch: 4 cost time: 1.0390853881835938
Epoch: 4, Steps: 123 | Train Loss: 0.6004393 Vali Loss: 0.5342368 Best vali loss: 0.5342368
	iters: 100, epoch: 5 | loss: 0.8452519
	speed: 0.0093s/iter; left time: 3.6630s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5342 --> 0.5297).  Saving model state dict ...
Epoch: 5 cost time: 0.7237834930419922
Epoch: 5, Steps: 123 | Train Loss: 0.8452519 Vali Loss: 0.5297025 Best vali loss: 0.5297025
	iters: 100, epoch: 6 | loss: 0.8072990
	speed: 0.0093s/iter; left time: 2.5217s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7263178825378418
Epoch: 6, Steps: 123 | Train Loss: 0.8072990 Vali Loss: 0.5298413 Best vali loss: 0.5297025
	iters: 100, epoch: 7 | loss: 0.4799093
	speed: 0.0090s/iter; left time: 1.3247s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5297 --> 0.5291).  Saving model state dict ...
Epoch: 7 cost time: 0.7164924144744873
Epoch: 7, Steps: 123 | Train Loss: 0.4799093 Vali Loss: 0.5290680 Best vali loss: 0.5290680
	iters: 100, epoch: 8 | loss: 0.5507452
	speed: 0.0095s/iter; left time: 0.2272s
Updating learning rate to 0.0
Validation loss decreased (0.5291 --> 0.5265).  Saving model state dict ...
Epoch: 8 cost time: 0.7254316806793213
Epoch: 8, Steps: 123 | Train Loss: 0.5507452 Vali Loss: 0.5265153 Best vali loss: 0.5265153

best validation loss 0.5265153469944486

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0001704899343, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7606067
	speed: 0.0117s/iter; left time: 10.3581s
Updating learning rate to 0.0001704899343
Validation loss decreased (inf --> 0.6071).  Saving model state dict ...
Epoch: 1 cost time: 1.027367115020752
Epoch: 1, Steps: 123 | Train Loss: 0.7606067 Vali Loss: 0.6070596 Best vali loss: 0.6070596
	iters: 100, epoch: 2 | loss: 0.9344482
	speed: 0.0093s/iter; left time: 7.1093s
Updating learning rate to 8.524496715e-05
Validation loss decreased (0.6071 --> 0.5631).  Saving model state dict ...
Epoch: 2 cost time: 0.7239623069763184
Epoch: 2, Steps: 123 | Train Loss: 0.9344482 Vali Loss: 0.5630536 Best vali loss: 0.5630536
	iters: 100, epoch: 3 | loss: 0.8584986
	speed: 0.0094s/iter; left time: 5.9930s
Updating learning rate to 4.2622483575e-05
Validation loss decreased (0.5631 --> 0.5543).  Saving model state dict ...
Epoch: 3 cost time: 0.7281970977783203
Epoch: 3, Steps: 123 | Train Loss: 0.8584986 Vali Loss: 0.5543168 Best vali loss: 0.5543168
	iters: 100, epoch: 4 | loss: 0.4984024
	speed: 0.0094s/iter; left time: 4.8319s
Updating learning rate to 2.13112417875e-05
Validation loss decreased (0.5543 --> 0.5498).  Saving model state dict ...
Epoch: 4 cost time: 0.724125862121582
Epoch: 4, Steps: 123 | Train Loss: 0.4984024 Vali Loss: 0.5498004 Best vali loss: 0.5498004
	iters: 100, epoch: 5 | loss: 0.5840963
	speed: 0.0094s/iter; left time: 3.6819s
Updating learning rate to 1.065562089375e-05
Validation loss decreased (0.5498 --> 0.5420).  Saving model state dict ...
Epoch: 5 cost time: 0.7340071201324463
Epoch: 5, Steps: 123 | Train Loss: 0.5840963 Vali Loss: 0.5420370 Best vali loss: 0.5420370
	iters: 100, epoch: 6 | loss: 0.6274457
	speed: 0.0093s/iter; left time: 2.5185s
Updating learning rate to 5.327810446875e-06
Validation loss decreased (0.5420 --> 0.5371).  Saving model state dict ...
Epoch: 6 cost time: 0.7175948619842529
Epoch: 6, Steps: 123 | Train Loss: 0.6274457 Vali Loss: 0.5371083 Best vali loss: 0.5371083
	iters: 100, epoch: 7 | loss: 0.6135116
	speed: 0.0094s/iter; left time: 1.3805s
Updating learning rate to 2.6639052234375e-06
Epoch: 7 cost time: 0.7240712642669678
Epoch: 7, Steps: 123 | Train Loss: 0.6135116 Vali Loss: 0.5383950 Best vali loss: 0.5371083
	iters: 100, epoch: 8 | loss: 0.7719192
	speed: 0.0090s/iter; left time: 0.2161s
Updating learning rate to 1.33195261171875e-06
Validation loss decreased (0.5371 --> 0.5362).  Saving model state dict ...
Epoch: 8 cost time: 0.7234337329864502
Epoch: 8, Steps: 123 | Train Loss: 0.7719192 Vali Loss: 0.5361747 Best vali loss: 0.5361747

best validation loss 0.5361747285217557

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0072390953006, 'e_layers': 4, 'learning_rate': 8.09814118e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9776880
	speed: 0.0118s/iter; left time: 22.0224s
	iters: 200, epoch: 1 | loss: 0.9215061
	speed: 0.0054s/iter; left time: 9.5435s
Updating learning rate to 8.09814118e-05
Validation loss decreased (inf --> 0.6277).  Saving model state dict ...
Epoch: 1 cost time: 1.6830928325653076
Epoch: 1, Steps: 245 | Train Loss: 0.9495970 Vali Loss: 0.6277181 Best vali loss: 0.6277181
	iters: 100, epoch: 2 | loss: 0.8934289
	speed: 0.0101s/iter; left time: 16.3932s
	iters: 200, epoch: 2 | loss: 0.9211912
	speed: 0.0052s/iter; left time: 7.8444s
Updating learning rate to 4.04907059e-05
Validation loss decreased (0.6277 --> 0.6075).  Saving model state dict ...
Epoch: 2 cost time: 1.3220674991607666
Epoch: 2, Steps: 245 | Train Loss: 0.9073100 Vali Loss: 0.6075032 Best vali loss: 0.6075032
	iters: 100, epoch: 3 | loss: 0.6963152
	speed: 0.0109s/iter; left time: 14.9057s
	iters: 200, epoch: 3 | loss: 0.6447050
	speed: 0.0058s/iter; left time: 7.3820s
Updating learning rate to 2.024535295e-05
Validation loss decreased (0.6075 --> 0.6005).  Saving model state dict ...
Epoch: 3 cost time: 1.4712467193603516
Epoch: 3, Steps: 245 | Train Loss: 0.6705101 Vali Loss: 0.6004905 Best vali loss: 0.6004905
	iters: 100, epoch: 4 | loss: 0.9039679
	speed: 0.0108s/iter; left time: 12.1113s
	iters: 200, epoch: 4 | loss: 0.8196279
	speed: 0.0051s/iter; left time: 5.2099s
Updating learning rate to 1.0122676475e-05
Epoch: 4 cost time: 1.3143041133880615
Epoch: 4, Steps: 245 | Train Loss: 0.8617979 Vali Loss: 0.6005784 Best vali loss: 0.6004905
	iters: 100, epoch: 5 | loss: 1.0808421
	speed: 0.0101s/iter; left time: 8.9144s
	iters: 200, epoch: 5 | loss: 0.7944309
	speed: 0.0051s/iter; left time: 4.0216s
Updating learning rate to 5.0613382375e-06
Epoch: 5 cost time: 1.3030941486358643
Epoch: 5, Steps: 245 | Train Loss: 0.9376365 Vali Loss: 0.6011659 Best vali loss: 0.6004905
	iters: 100, epoch: 6 | loss: 0.5583506
	speed: 0.0101s/iter; left time: 6.4067s
	iters: 200, epoch: 6 | loss: 0.5416334
	speed: 0.0051s/iter; left time: 2.7374s
Updating learning rate to 2.53066911875e-06
Epoch: 6 cost time: 1.303497314453125
Epoch: 6, Steps: 245 | Train Loss: 0.5499920 Vali Loss: 0.6009953 Best vali loss: 0.6004905
	iters: 100, epoch: 7 | loss: 0.9734432
	speed: 0.0108s/iter; left time: 4.2147s
	iters: 200, epoch: 7 | loss: 0.7091067
	speed: 0.0057s/iter; left time: 1.6679s
Updating learning rate to 1.265334559375e-06
Epoch: 7 cost time: 1.4553165435791016
Epoch: 7, Steps: 245 | Train Loss: 0.8412749 Vali Loss: 0.6007804 Best vali loss: 0.6004905
	iters: 100, epoch: 8 | loss: 0.8473099
	speed: 0.0113s/iter; left time: 1.6452s
	iters: 200, epoch: 8 | loss: 0.7865281
	speed: 0.0058s/iter; left time: 0.2665s
Updating learning rate to 6.326672796875e-07
Epoch: 8 cost time: 1.469815731048584
Epoch: 8, Steps: 245 | Train Loss: 0.8169190 Vali Loss: 0.6007202 Best vali loss: 0.6004905

best validation loss 0.6004904884257177

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010963522504, 'e_layers': 1, 'learning_rate': 0.0001301536978, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4158127
	speed: 0.0087s/iter; left time: 67.1019s
	iters: 200, epoch: 1 | loss: 1.1827942
	speed: 0.0026s/iter; left time: 19.7538s
	iters: 300, epoch: 1 | loss: 1.1710404
	speed: 0.0026s/iter; left time: 19.6512s
	iters: 400, epoch: 1 | loss: 0.6127303
	speed: 0.0025s/iter; left time: 18.6601s
	iters: 500, epoch: 1 | loss: 1.0866984
	speed: 0.0024s/iter; left time: 17.8317s
	iters: 600, epoch: 1 | loss: 0.7102204
	speed: 0.0025s/iter; left time: 17.9062s
	iters: 700, epoch: 1 | loss: 0.3895162
	speed: 0.0026s/iter; left time: 18.5953s
	iters: 800, epoch: 1 | loss: 0.9491851
	speed: 0.0025s/iter; left time: 17.8218s
	iters: 900, epoch: 1 | loss: 0.9003316
	speed: 0.0025s/iter; left time: 17.2936s
Updating learning rate to 0.00012520001763903965
Validation loss decreased (inf --> 0.6036).  Saving model state dict ...
Epoch: 1 cost time: 2.8234972953796387
Epoch: 1, Steps: 979 | Train Loss: 0.9353699 Vali Loss: 0.6035996 Best vali loss: 0.6035996
	iters: 100, epoch: 2 | loss: 1.7086622
	speed: 0.0092s/iter; left time: 62.0800s
	iters: 200, epoch: 2 | loss: 0.4486898
	speed: 0.0025s/iter; left time: 16.8937s
	iters: 300, epoch: 2 | loss: 0.7601961
	speed: 0.0025s/iter; left time: 16.1210s
	iters: 400, epoch: 2 | loss: 0.4928459
	speed: 0.0024s/iter; left time: 15.2616s
	iters: 500, epoch: 2 | loss: 0.5628809
	speed: 0.0024s/iter; left time: 15.0576s
	iters: 600, epoch: 2 | loss: 0.3635559
	speed: 0.0023s/iter; left time: 14.5913s
	iters: 700, epoch: 2 | loss: 0.6528949
	speed: 0.0023s/iter; left time: 14.0975s
	iters: 800, epoch: 2 | loss: 0.5076731
	speed: 0.0022s/iter; left time: 13.4569s
	iters: 900, epoch: 2 | loss: 1.0632876
	speed: 0.0023s/iter; left time: 13.8609s
Updating learning rate to 0.00011109313005544232
Validation loss decreased (0.6036 --> 0.6025).  Saving model state dict ...
Epoch: 2 cost time: 2.3667795658111572
Epoch: 2, Steps: 979 | Train Loss: 0.7289652 Vali Loss: 0.6025261 Best vali loss: 0.6025261
	iters: 100, epoch: 3 | loss: 1.7194288
	speed: 0.0085s/iter; left time: 48.9162s
	iters: 200, epoch: 3 | loss: 0.4746650
	speed: 0.0022s/iter; left time: 12.6450s
	iters: 300, epoch: 3 | loss: 1.2659048
	speed: 0.0023s/iter; left time: 12.5592s
	iters: 400, epoch: 3 | loss: 0.5071421
	speed: 0.0023s/iter; left time: 12.7010s
	iters: 500, epoch: 3 | loss: 1.1744874
	speed: 0.0023s/iter; left time: 12.1091s
	iters: 600, epoch: 3 | loss: 0.7091543
	speed: 0.0022s/iter; left time: 11.7892s
	iters: 700, epoch: 3 | loss: 0.3981467
	speed: 0.0023s/iter; left time: 11.6999s
	iters: 800, epoch: 3 | loss: 0.3620174
	speed: 0.0023s/iter; left time: 11.6032s
	iters: 900, epoch: 3 | loss: 0.6982436
	speed: 0.0023s/iter; left time: 11.3582s
Updating learning rate to 8.998068080455633e-05
Epoch: 3 cost time: 2.255547046661377
Epoch: 3, Steps: 979 | Train Loss: 0.8121322 Vali Loss: 0.6151264 Best vali loss: 0.6025261

best validation loss 0.6025261091226122

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008560546691, 'e_layers': 2, 'learning_rate': 5.472126e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0508605
	speed: 0.0104s/iter; left time: 19.4268s
	iters: 200, epoch: 1 | loss: 0.8787634
	speed: 0.0040s/iter; left time: 7.1125s
Updating learning rate to 5.2638556053614286e-05
Validation loss decreased (inf --> 0.6131).  Saving model state dict ...
Epoch: 1 cost time: 1.3491415977478027
Epoch: 1, Steps: 245 | Train Loss: 0.9648120 Vali Loss: 0.6130791 Best vali loss: 0.6130791
	iters: 100, epoch: 2 | loss: 0.7742443
	speed: 0.0079s/iter; left time: 12.8077s
	iters: 200, epoch: 2 | loss: 0.7467456
	speed: 0.0037s/iter; left time: 5.6345s
Updating learning rate to 4.6707517010536086e-05
Validation loss decreased (0.6131 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 0.941058874130249
Epoch: 2, Steps: 245 | Train Loss: 0.7604950 Vali Loss: 0.6035674 Best vali loss: 0.6035674
	iters: 100, epoch: 3 | loss: 0.7271760
	speed: 0.0076s/iter; left time: 10.4337s
	iters: 200, epoch: 3 | loss: 0.6345374
	speed: 0.0038s/iter; left time: 4.8233s
Updating learning rate to 3.7831089800071246e-05
Validation loss decreased (0.6036 --> 0.6026).  Saving model state dict ...
Epoch: 3 cost time: 0.9402413368225098
Epoch: 3, Steps: 245 | Train Loss: 0.6808567 Vali Loss: 0.6026307 Best vali loss: 0.6026307

best validation loss 0.602630748538053

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001775619858, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617711
	speed: 0.0118s/iter; left time: 10.4003s
Updating learning rate to 0.00017080393511633986
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.0375010967254639
Epoch: 1, Steps: 123 | Train Loss: 0.7617711 Vali Loss: 0.6077155 Best vali loss: 0.6077155
	iters: 100, epoch: 2 | loss: 0.9303288
	speed: 0.0093s/iter; left time: 7.0671s
Updating learning rate to 0.00015155863502006473
Validation loss decreased (0.6077 --> 0.5576).  Saving model state dict ...
Epoch: 2 cost time: 0.7225537300109863
Epoch: 2, Steps: 123 | Train Loss: 0.9303288 Vali Loss: 0.5575752 Best vali loss: 0.5575752
	iters: 100, epoch: 3 | loss: 0.8595979
	speed: 0.0095s/iter; left time: 6.0614s
Updating learning rate to 0.00012275600799175267
Validation loss decreased (0.5576 --> 0.5535).  Saving model state dict ...
Epoch: 3 cost time: 0.7204959392547607
Epoch: 3, Steps: 123 | Train Loss: 0.8595979 Vali Loss: 0.5535272 Best vali loss: 0.5535272

best validation loss 0.5535272254760704

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001775619858, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5974885
	speed: 0.0120s/iter; left time: 6.2118s
Updating learning rate to 8.87809929e-05
Validation loss decreased (0.5535 --> 0.5342).  Saving model state dict ...
Epoch: 4 cost time: 1.0331308841705322
Epoch: 4, Steps: 123 | Train Loss: 0.5974885 Vali Loss: 0.5341597 Best vali loss: 0.5341597
	iters: 100, epoch: 5 | loss: 0.8441790
	speed: 0.0093s/iter; left time: 3.6459s
Updating learning rate to 5.4805977808247336e-05
Validation loss decreased (0.5342 --> 0.5274).  Saving model state dict ...
Epoch: 5 cost time: 0.7233943939208984
Epoch: 5, Steps: 123 | Train Loss: 0.8441790 Vali Loss: 0.5273800 Best vali loss: 0.5273800
	iters: 100, epoch: 6 | loss: 0.8028151
	speed: 0.0093s/iter; left time: 2.5111s
Updating learning rate to 2.6003350779935275e-05
Epoch: 6 cost time: 0.7241723537445068
Epoch: 6, Steps: 123 | Train Loss: 0.8028151 Vali Loss: 0.5291552 Best vali loss: 0.5273800
	iters: 100, epoch: 7 | loss: 0.4679073
	speed: 0.0090s/iter; left time: 1.3302s
Updating learning rate to 6.758050683660133e-06
Epoch: 7 cost time: 0.7166874408721924
Epoch: 7, Steps: 123 | Train Loss: 0.4679073 Vali Loss: 0.5294023 Best vali loss: 0.5273800
	iters: 100, epoch: 8 | loss: 0.5506470
	speed: 0.0091s/iter; left time: 0.2174s
Updating learning rate to 0.0
Validation loss decreased (0.5274 --> 0.5245).  Saving model state dict ...
Epoch: 8 cost time: 0.7193458080291748
Epoch: 8, Steps: 123 | Train Loss: 0.5506470 Vali Loss: 0.5244914 Best vali loss: 0.5244914

best validation loss 0.5244914035673552

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0064444713866, 'e_layers': 2, 'learning_rate': 0.0001757177626, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7619219
	speed: 0.0117s/iter; left time: 10.3204s
Updating learning rate to 0.00016902990348240864
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.014591932296753
Epoch: 1, Steps: 123 | Train Loss: 0.7619219 Vali Loss: 0.6074685 Best vali loss: 0.6074685
	iters: 100, epoch: 2 | loss: 0.9333056
	speed: 0.0091s/iter; left time: 6.9324s
Updating learning rate to 0.00014998449205469395
Validation loss decreased (0.6075 --> 0.5684).  Saving model state dict ...
Epoch: 2 cost time: 0.7190704345703125
Epoch: 2, Steps: 123 | Train Loss: 0.9333056 Vali Loss: 0.5683572 Best vali loss: 0.5683572
	iters: 100, epoch: 3 | loss: 0.8508987
	speed: 0.0093s/iter; left time: 5.9279s
Updating learning rate to 0.00012148101955964101
Validation loss decreased (0.5684 --> 0.5537).  Saving model state dict ...
Epoch: 3 cost time: 0.7147669792175293
Epoch: 3, Steps: 123 | Train Loss: 0.8508987 Vali Loss: 0.5537247 Best vali loss: 0.5537247
	iters: 100, epoch: 4 | loss: 0.5113452
	speed: 0.0094s/iter; left time: 4.8334s
Updating learning rate to 8.78588813e-05
Epoch: 4 cost time: 0.7158045768737793
Epoch: 4, Steps: 123 | Train Loss: 0.5113452 Vali Loss: 0.5582921 Best vali loss: 0.5537247
	iters: 100, epoch: 5 | loss: 0.5759491
	speed: 0.0090s/iter; left time: 3.5206s
Updating learning rate to 5.4236743040359005e-05
Validation loss decreased (0.5537 --> 0.5323).  Saving model state dict ...
Epoch: 5 cost time: 0.7169859409332275
Epoch: 5, Steps: 123 | Train Loss: 0.5759491 Vali Loss: 0.5322759 Best vali loss: 0.5322759
	iters: 100, epoch: 6 | loss: 0.6209376
	speed: 0.0092s/iter; left time: 2.4884s
Updating learning rate to 2.5733270545306053e-05
Validation loss decreased (0.5323 --> 0.5291).  Saving model state dict ...
Epoch: 6 cost time: 0.7204036712646484
Epoch: 6, Steps: 123 | Train Loss: 0.6209376 Vali Loss: 0.5290605 Best vali loss: 0.5290605
	iters: 100, epoch: 7 | loss: 0.5771416
	speed: 0.0092s/iter; left time: 1.3560s
Updating learning rate to 6.687859117591368e-06
Validation loss decreased (0.5291 --> 0.5262).  Saving model state dict ...
Epoch: 7 cost time: 0.7237498760223389
Epoch: 7, Steps: 123 | Train Loss: 0.5771416 Vali Loss: 0.5262386 Best vali loss: 0.5262386
	iters: 100, epoch: 8 | loss: 0.7414507
	speed: 0.0094s/iter; left time: 0.2252s
Updating learning rate to 0.0
Validation loss decreased (0.5262 --> 0.5241).  Saving model state dict ...
Epoch: 8 cost time: 0.7264070510864258
Epoch: 8, Steps: 123 | Train Loss: 0.7414507 Vali Loss: 0.5240645 Best vali loss: 0.5240645

best validation loss 0.524064509681616

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0069366064377, 'e_layers': 2, 'learning_rate': 0.0001756702666, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7618693
	speed: 0.0117s/iter; left time: 10.3296s
Updating learning rate to 0.00016898421519127054
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0190443992614746
Epoch: 1, Steps: 123 | Train Loss: 0.7618693 Vali Loss: 0.6075036 Best vali loss: 0.6075036
	iters: 100, epoch: 2 | loss: 0.9331897
	speed: 0.0092s/iter; left time: 6.9810s
Updating learning rate to 0.00014994395168285433
Validation loss decreased (0.6075 --> 0.5625).  Saving model state dict ...
Epoch: 2 cost time: 0.716332197189331
Epoch: 2, Steps: 123 | Train Loss: 0.9331897 Vali Loss: 0.5625191 Best vali loss: 0.5625191
	iters: 100, epoch: 3 | loss: 0.8617794
	speed: 0.0093s/iter; left time: 5.9249s
Updating learning rate to 0.0001214481835934892
Validation loss decreased (0.5625 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 0.7201588153839111
Epoch: 3, Steps: 123 | Train Loss: 0.8617794 Vali Loss: 0.5538251 Best vali loss: 0.5538251
	iters: 100, epoch: 4 | loss: 0.5000924
	speed: 0.0093s/iter; left time: 4.7941s
Updating learning rate to 8.78351333e-05
Validation loss decreased (0.5538 --> 0.5529).  Saving model state dict ...
Epoch: 4 cost time: 0.7214815616607666
Epoch: 4, Steps: 123 | Train Loss: 0.5000924 Vali Loss: 0.5529149 Best vali loss: 0.5529149
	iters: 100, epoch: 5 | loss: 0.5799258
	speed: 0.0093s/iter; left time: 3.6508s
Updating learning rate to 5.422208300651081e-05
Validation loss decreased (0.5529 --> 0.5346).  Saving model state dict ...
Epoch: 5 cost time: 0.7245020866394043
Epoch: 5, Steps: 123 | Train Loss: 0.5799258 Vali Loss: 0.5346357 Best vali loss: 0.5346357
	iters: 100, epoch: 6 | loss: 0.6193036
	speed: 0.0095s/iter; left time: 2.5580s
Updating learning rate to 2.5726314917145672e-05
Validation loss decreased (0.5346 --> 0.5306).  Saving model state dict ...
Epoch: 6 cost time: 0.7215049266815186
Epoch: 6, Steps: 123 | Train Loss: 0.6193036 Vali Loss: 0.5305877 Best vali loss: 0.5305877
	iters: 100, epoch: 7 | loss: 0.5768398
	speed: 0.0093s/iter; left time: 1.3682s
Updating learning rate to 6.6860514087294454e-06
Validation loss decreased (0.5306 --> 0.5281).  Saving model state dict ...
Epoch: 7 cost time: 0.7173960208892822
Epoch: 7, Steps: 123 | Train Loss: 0.5768398 Vali Loss: 0.5280538 Best vali loss: 0.5280538
	iters: 100, epoch: 8 | loss: 0.7422829
	speed: 0.0093s/iter; left time: 0.2237s
Updating learning rate to 0.0
Validation loss decreased (0.5281 --> 0.5264).  Saving model state dict ...
Epoch: 8 cost time: 0.7248833179473877
Epoch: 8, Steps: 123 | Train Loss: 0.7422829 Vali Loss: 0.5263515 Best vali loss: 0.5263515

best validation loss 0.5263514541079192

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.008140831986, 'e_layers': 3, 'learning_rate': 0.0001207735082, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6825990
	speed: 0.0108s/iter; left time: 41.1114s
	iters: 200, epoch: 1 | loss: 0.6965422
	speed: 0.0046s/iter; left time: 17.0691s
	iters: 300, epoch: 1 | loss: 0.8483348
	speed: 0.0045s/iter; left time: 16.4076s
	iters: 400, epoch: 1 | loss: 0.6513896
	speed: 0.0047s/iter; left time: 16.5493s
Updating learning rate to 0.0001207735082
Validation loss decreased (inf --> 0.5994).  Saving model state dict ...
Epoch: 1 cost time: 2.6122756004333496
Epoch: 1, Steps: 490 | Train Loss: 0.7197164 Vali Loss: 0.5994375 Best vali loss: 0.5994375
	iters: 100, epoch: 2 | loss: 1.4311960
	speed: 0.0124s/iter; left time: 41.3868s
	iters: 200, epoch: 2 | loss: 0.9861189
	speed: 0.0043s/iter; left time: 13.7886s
	iters: 300, epoch: 2 | loss: 0.9535868
	speed: 0.0041s/iter; left time: 12.7760s
	iters: 400, epoch: 2 | loss: 0.7432631
	speed: 0.0041s/iter; left time: 12.3670s
Updating learning rate to 6.03867541e-05
Validation loss decreased (0.5994 --> 0.5654).  Saving model state dict ...
Epoch: 2 cost time: 2.103032350540161
Epoch: 2, Steps: 490 | Train Loss: 1.0285412 Vali Loss: 0.5653515 Best vali loss: 0.5653515
	iters: 100, epoch: 3 | loss: 0.5279478
	speed: 0.0113s/iter; left time: 32.0238s
	iters: 200, epoch: 3 | loss: 0.4663966
	speed: 0.0045s/iter; left time: 12.2752s
	iters: 300, epoch: 3 | loss: 0.7823392
	speed: 0.0046s/iter; left time: 12.2666s
	iters: 400, epoch: 3 | loss: 0.5713277
	speed: 0.0044s/iter; left time: 11.2602s
Updating learning rate to 3.019337705e-05
Epoch: 3 cost time: 2.1942403316497803
Epoch: 3, Steps: 490 | Train Loss: 0.5870028 Vali Loss: 0.5901760 Best vali loss: 0.5653515

best validation loss 0.5653514929498472

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0063180492627, 'e_layers': 2, 'learning_rate': 0.0016488852575, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7511023
	speed: 0.0104s/iter; left time: 19.4382s
	iters: 200, epoch: 1 | loss: 0.9538664
	speed: 0.0039s/iter; left time: 6.7819s
Updating learning rate to 0.0016488852575
Validation loss decreased (inf --> 0.6073).  Saving model state dict ...
Epoch: 1 cost time: 1.3317172527313232
Epoch: 1, Steps: 245 | Train Loss: 0.8524843 Vali Loss: 0.6073085 Best vali loss: 0.6073085
	iters: 100, epoch: 2 | loss: 1.1576613
	speed: 0.0081s/iter; left time: 13.0336s
	iters: 200, epoch: 2 | loss: 0.7457783
	speed: 0.0038s/iter; left time: 5.7051s
Updating learning rate to 0.00082444262875
Epoch: 2 cost time: 0.9748036861419678
Epoch: 2, Steps: 245 | Train Loss: 0.9517198 Vali Loss: 0.6373357 Best vali loss: 0.6073085
	iters: 100, epoch: 3 | loss: 0.7815431
	speed: 0.0079s/iter; left time: 10.8409s
	iters: 200, epoch: 3 | loss: 1.1707287
	speed: 0.0039s/iter; left time: 4.9956s
Updating learning rate to 0.000412221314375
Validation loss decreased (0.6073 --> 0.6035).  Saving model state dict ...
Epoch: 3 cost time: 0.9822654724121094
Epoch: 3, Steps: 245 | Train Loss: 0.9761359 Vali Loss: 0.6035155 Best vali loss: 0.6035155

best validation loss 0.6035154959991098

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977135694, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745790
	speed: 0.0119s/iter; left time: 10.4952s
Updating learning rate to 0.0002863825213597692
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0357048511505127
Epoch: 1, Steps: 123 | Train Loss: 0.7745790 Vali Loss: 0.6173347 Best vali loss: 0.6173347
	iters: 100, epoch: 2 | loss: 0.9494876
	speed: 0.0093s/iter; left time: 7.0886s
Updating learning rate to 0.00025411442658699587
Validation loss decreased (0.6173 --> 0.5608).  Saving model state dict ...
Epoch: 2 cost time: 0.7143378257751465
Epoch: 2, Steps: 123 | Train Loss: 0.9494876 Vali Loss: 0.5608025 Best vali loss: 0.5608025
	iters: 100, epoch: 3 | loss: 0.8505913
	speed: 0.0093s/iter; left time: 5.9249s
Updating learning rate to 0.0002058218099998272
Validation loss decreased (0.5608 --> 0.5489).  Saving model state dict ...
Epoch: 3 cost time: 0.728834867477417
Epoch: 3, Steps: 123 | Train Loss: 0.8505913 Vali Loss: 0.5488572 Best vali loss: 0.5488572

best validation loss 0.5488572116805027

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977135694, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5844876
	speed: 0.0120s/iter; left time: 6.1839s
Updating learning rate to 0.0001488567847
Validation loss decreased (0.5489 --> 0.5311).  Saving model state dict ...
Epoch: 4 cost time: 1.0260365009307861
Epoch: 4, Steps: 123 | Train Loss: 0.5844876 Vali Loss: 0.5311211 Best vali loss: 0.5311211
	iters: 100, epoch: 5 | loss: 0.8187580
	speed: 0.0094s/iter; left time: 3.6851s
Updating learning rate to 9.189175940017282e-05
Epoch: 5 cost time: 0.7240810394287109
Epoch: 5, Steps: 123 | Train Loss: 0.8187580 Vali Loss: 0.5328371 Best vali loss: 0.5311211
	iters: 100, epoch: 6 | loss: 0.7600098
	speed: 0.0091s/iter; left time: 2.4438s
Updating learning rate to 4.359914281300409e-05
Epoch: 6 cost time: 0.7157292366027832
Epoch: 6, Steps: 123 | Train Loss: 0.7600098 Vali Loss: 0.5347053 Best vali loss: 0.5311211
	iters: 100, epoch: 7 | loss: 0.4246681
	speed: 0.0089s/iter; left time: 1.3139s
Updating learning rate to 1.133104804023074e-05
Epoch: 7 cost time: 0.721513032913208
Epoch: 7, Steps: 123 | Train Loss: 0.4246681 Vali Loss: 0.5451901 Best vali loss: 0.5311211
	iters: 100, epoch: 8 | loss: 0.5065455
	speed: 0.0091s/iter; left time: 0.2176s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7180335521697998
Epoch: 8, Steps: 123 | Train Loss: 0.5065455 Vali Loss: 0.5434751 Best vali loss: 0.5311211

best validation loss 0.531121078021876

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010963618454, 'e_layers': 2, 'learning_rate': 0.0001218184611, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7533984
	speed: 0.0117s/iter; left time: 10.3798s
Updating learning rate to 0.00011718202199615618
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 1.03184175491333
Epoch: 1, Steps: 123 | Train Loss: 0.7533984 Vali Loss: 0.6028913 Best vali loss: 0.6028913
	iters: 100, epoch: 2 | loss: 0.9422954
	speed: 0.0093s/iter; left time: 7.0750s
Updating learning rate to 0.00010397856050875982
Validation loss decreased (0.6029 --> 0.5996).  Saving model state dict ...
Epoch: 2 cost time: 0.73211669921875
Epoch: 2, Steps: 123 | Train Loss: 0.9422954 Vali Loss: 0.5996187 Best vali loss: 0.5996187
	iters: 100, epoch: 3 | loss: 0.8730425
	speed: 0.0095s/iter; left time: 6.0655s
Updating learning rate to 8.421818395959059e-05
Validation loss decreased (0.5996 --> 0.5633).  Saving model state dict ...
Epoch: 3 cost time: 0.73380446434021
Epoch: 3, Steps: 123 | Train Loss: 0.8730425 Vali Loss: 0.5633358 Best vali loss: 0.5633358
	iters: 100, epoch: 4 | loss: 0.5088864
	speed: 0.0093s/iter; left time: 4.8014s
Updating learning rate to 6.090923055e-05
Validation loss decreased (0.5633 --> 0.5612).  Saving model state dict ...
Epoch: 4 cost time: 0.7287392616271973
Epoch: 4, Steps: 123 | Train Loss: 0.5088864 Vali Loss: 0.5611696 Best vali loss: 0.5611696
	iters: 100, epoch: 5 | loss: 0.5875655
	speed: 0.0094s/iter; left time: 3.7138s
Updating learning rate to 3.7600277140409416e-05
Validation loss decreased (0.5612 --> 0.5491).  Saving model state dict ...
Epoch: 5 cost time: 0.7246713638305664
Epoch: 5, Steps: 123 | Train Loss: 0.5875655 Vali Loss: 0.5490789 Best vali loss: 0.5490789
	iters: 100, epoch: 6 | loss: 0.6364484
	speed: 0.0094s/iter; left time: 2.5319s
Updating learning rate to 1.7839900591240176e-05
Validation loss decreased (0.5491 --> 0.5463).  Saving model state dict ...
Epoch: 6 cost time: 0.7210934162139893
Epoch: 6, Steps: 123 | Train Loss: 0.6364484 Vali Loss: 0.5463091 Best vali loss: 0.5463091
	iters: 100, epoch: 7 | loss: 0.6065001
	speed: 0.0094s/iter; left time: 1.3816s
Updating learning rate to 4.636439103843815e-06
Validation loss decreased (0.5463 --> 0.5406).  Saving model state dict ...
Epoch: 7 cost time: 0.7283463478088379
Epoch: 7, Steps: 123 | Train Loss: 0.6065001 Vali Loss: 0.5405800 Best vali loss: 0.5405800
	iters: 100, epoch: 8 | loss: 0.7667587
	speed: 0.0093s/iter; left time: 0.2236s
Updating learning rate to 0.0
Validation loss decreased (0.5406 --> 0.5383).  Saving model state dict ...
Epoch: 8 cost time: 0.7216925621032715
Epoch: 8, Steps: 123 | Train Loss: 0.7667587 Vali Loss: 0.5382557 Best vali loss: 0.5382557

best validation loss 0.5382556799990554

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0009512883247, 'e_layers': 2, 'learning_rate': 5.42615791e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.8032715
	speed: 0.0098s/iter; left time: 76.0445s
	iters: 200, epoch: 1 | loss: 0.4926576
	speed: 0.0036s/iter; left time: 27.4232s
	iters: 300, epoch: 1 | loss: 1.2395644
	speed: 0.0035s/iter; left time: 26.3938s
	iters: 400, epoch: 1 | loss: 0.4253992
	speed: 0.0037s/iter; left time: 27.3951s
	iters: 500, epoch: 1 | loss: 1.8018163
	speed: 0.0037s/iter; left time: 27.0518s
	iters: 600, epoch: 1 | loss: 0.2889997
	speed: 0.0037s/iter; left time: 26.6557s
	iters: 700, epoch: 1 | loss: 0.8527319
	speed: 0.0037s/iter; left time: 26.1042s
	iters: 800, epoch: 1 | loss: 1.2830504
	speed: 0.0037s/iter; left time: 25.7627s
	iters: 900, epoch: 1 | loss: 1.3008441
	speed: 0.0037s/iter; left time: 25.3682s
Updating learning rate to 5.42615791e-05
Validation loss decreased (inf --> 0.5956).  Saving model state dict ...
Epoch: 1 cost time: 3.928802728652954
Epoch: 1, Steps: 979 | Train Loss: 1.0542595 Vali Loss: 0.5955501 Best vali loss: 0.5955501
	iters: 100, epoch: 2 | loss: 1.6044343
	speed: 0.0118s/iter; left time: 79.7068s
	iters: 200, epoch: 2 | loss: 0.6278039
	speed: 0.0036s/iter; left time: 23.6241s
	iters: 300, epoch: 2 | loss: 1.1198595
	speed: 0.0034s/iter; left time: 22.5407s
	iters: 400, epoch: 2 | loss: 0.5728598
	speed: 0.0034s/iter; left time: 22.1600s
	iters: 500, epoch: 2 | loss: 1.6289747
	speed: 0.0035s/iter; left time: 22.0235s
	iters: 600, epoch: 2 | loss: 0.3225758
	speed: 0.0034s/iter; left time: 21.5371s
	iters: 700, epoch: 2 | loss: 0.3868414
	speed: 0.0034s/iter; left time: 20.8153s
	iters: 800, epoch: 2 | loss: 0.6401117
	speed: 0.0030s/iter; left time: 18.3798s
	iters: 900, epoch: 2 | loss: 0.8314090
	speed: 0.0031s/iter; left time: 18.3743s
Updating learning rate to 2.713078955e-05
Validation loss decreased (0.5956 --> 0.5952).  Saving model state dict ...
Epoch: 2 cost time: 3.3407769203186035
Epoch: 2, Steps: 979 | Train Loss: 0.8594300 Vali Loss: 0.5952185 Best vali loss: 0.5952185
	iters: 100, epoch: 3 | loss: 0.4823085
	speed: 0.0111s/iter; left time: 64.3640s
	iters: 200, epoch: 3 | loss: 0.4426729
	speed: 0.0032s/iter; left time: 17.9682s
	iters: 300, epoch: 3 | loss: 2.5237157
	speed: 0.0032s/iter; left time: 17.6360s
	iters: 400, epoch: 3 | loss: 0.7087922
	speed: 0.0031s/iter; left time: 17.0552s
	iters: 500, epoch: 3 | loss: 1.2876619
	speed: 0.0030s/iter; left time: 16.3885s
	iters: 600, epoch: 3 | loss: 0.5032629
	speed: 0.0032s/iter; left time: 16.7036s
	iters: 700, epoch: 3 | loss: 0.4716141
	speed: 0.0033s/iter; left time: 17.2624s
	iters: 800, epoch: 3 | loss: 0.3444569
	speed: 0.0033s/iter; left time: 16.9869s
	iters: 900, epoch: 3 | loss: 0.3111230
	speed: 0.0032s/iter; left time: 16.1195s
Updating learning rate to 1.3565394775e-05
Validation loss decreased (0.5952 --> 0.5730).  Saving model state dict ...
Epoch: 3 cost time: 3.1593449115753174
Epoch: 3, Steps: 979 | Train Loss: 0.7861787 Vali Loss: 0.5730038 Best vali loss: 0.5730038
	iters: 100, epoch: 4 | loss: 0.7042639
	speed: 0.0108s/iter; left time: 51.5920s
	iters: 200, epoch: 4 | loss: 0.4453703
	speed: 0.0031s/iter; left time: 14.4831s
	iters: 300, epoch: 4 | loss: 0.6308010
	speed: 0.0031s/iter; left time: 14.1235s
	iters: 400, epoch: 4 | loss: 0.7381901
	speed: 0.0031s/iter; left time: 13.8771s
	iters: 500, epoch: 4 | loss: 0.9444093
	speed: 0.0032s/iter; left time: 13.9463s
	iters: 600, epoch: 4 | loss: 0.6743003
	speed: 0.0031s/iter; left time: 13.2240s
	iters: 700, epoch: 4 | loss: 0.4226294
	speed: 0.0031s/iter; left time: 12.9517s
	iters: 800, epoch: 4 | loss: 0.3118305
	speed: 0.0031s/iter; left time: 12.6800s
	iters: 900, epoch: 4 | loss: 1.0779040
	speed: 0.0031s/iter; left time: 12.3515s
Updating learning rate to 6.7826973875e-06
Validation loss decreased (0.5730 --> 0.5653).  Saving model state dict ...
Epoch: 4 cost time: 3.0769290924072266
Epoch: 4, Steps: 979 | Train Loss: 0.6610776 Vali Loss: 0.5652683 Best vali loss: 0.5652683
	iters: 100, epoch: 5 | loss: 0.8203825
	speed: 0.0112s/iter; left time: 42.8086s
	iters: 200, epoch: 5 | loss: 0.8781658
	speed: 0.0030s/iter; left time: 11.3231s
	iters: 300, epoch: 5 | loss: 0.9060088
	speed: 0.0032s/iter; left time: 11.7204s
	iters: 400, epoch: 5 | loss: 0.8075508
	speed: 0.0031s/iter; left time: 11.0136s
	iters: 500, epoch: 5 | loss: 0.4377483
	speed: 0.0032s/iter; left time: 11.0319s
	iters: 600, epoch: 5 | loss: 1.1118944
	speed: 0.0032s/iter; left time: 10.7615s
	iters: 700, epoch: 5 | loss: 0.2613247
	speed: 0.0032s/iter; left time: 10.1783s
	iters: 800, epoch: 5 | loss: 0.5483963
	speed: 0.0031s/iter; left time: 9.7763s
	iters: 900, epoch: 5 | loss: 0.9561208
	speed: 0.0032s/iter; left time: 9.6744s
Updating learning rate to 3.39134869375e-06
Epoch: 5 cost time: 3.1806650161743164
Epoch: 5, Steps: 979 | Train Loss: 0.7475103 Vali Loss: 0.5653973 Best vali loss: 0.5652683
	iters: 100, epoch: 6 | loss: 0.3611588
	speed: 0.0106s/iter; left time: 30.0171s
	iters: 200, epoch: 6 | loss: 0.2476717
	speed: 0.0033s/iter; left time: 8.9401s
	iters: 300, epoch: 6 | loss: 0.2742551
	speed: 0.0031s/iter; left time: 8.2625s
	iters: 400, epoch: 6 | loss: 1.0899546
	speed: 0.0031s/iter; left time: 7.8682s
	iters: 500, epoch: 6 | loss: 0.7236689
	speed: 0.0032s/iter; left time: 7.7223s
	iters: 600, epoch: 6 | loss: 1.2073045
	speed: 0.0031s/iter; left time: 7.3456s
	iters: 700, epoch: 6 | loss: 0.9445109
	speed: 0.0031s/iter; left time: 6.9783s
	iters: 800, epoch: 6 | loss: 0.4266138
	speed: 0.0032s/iter; left time: 6.7703s
	iters: 900, epoch: 6 | loss: 0.9885678
	speed: 0.0031s/iter; left time: 6.3231s
Updating learning rate to 1.695674346875e-06
Validation loss decreased (0.5653 --> 0.5632).  Saving model state dict ...
Epoch: 6 cost time: 3.1242728233337402
Epoch: 6, Steps: 979 | Train Loss: 0.6959674 Vali Loss: 0.5631508 Best vali loss: 0.5631508
	iters: 100, epoch: 7 | loss: 0.4938159
	speed: 0.0114s/iter; left time: 21.2062s
	iters: 200, epoch: 7 | loss: 0.6020060
	speed: 0.0036s/iter; left time: 6.3224s
	iters: 300, epoch: 7 | loss: 0.8801973
	speed: 0.0035s/iter; left time: 5.8798s
	iters: 400, epoch: 7 | loss: 0.2848889
	speed: 0.0035s/iter; left time: 5.5056s
	iters: 500, epoch: 7 | loss: 0.3008856
	speed: 0.0033s/iter; left time: 4.8724s
	iters: 600, epoch: 7 | loss: 0.7032269
	speed: 0.0033s/iter; left time: 4.5445s
	iters: 700, epoch: 7 | loss: 1.1004447
	speed: 0.0036s/iter; left time: 4.4984s
	iters: 800, epoch: 7 | loss: 0.6096066
	speed: 0.0036s/iter; left time: 4.1273s
	iters: 900, epoch: 7 | loss: 0.3031784
	speed: 0.0036s/iter; left time: 3.7932s
Updating learning rate to 8.478371734375e-07
Validation loss decreased (0.5632 --> 0.5613).  Saving model state dict ...
Epoch: 7 cost time: 3.482570171356201
Epoch: 7, Steps: 979 | Train Loss: 0.5864723 Vali Loss: 0.5613006 Best vali loss: 0.5613006
	iters: 100, epoch: 8 | loss: 0.4256176
	speed: 0.0116s/iter; left time: 10.2366s
	iters: 200, epoch: 8 | loss: 0.3475897
	speed: 0.0031s/iter; left time: 2.4022s
	iters: 300, epoch: 8 | loss: 0.9614823
	speed: 0.0031s/iter; left time: 2.0869s
	iters: 400, epoch: 8 | loss: 0.9034488
	speed: 0.0030s/iter; left time: 1.7633s
	iters: 500, epoch: 8 | loss: 0.9412879
	speed: 0.0032s/iter; left time: 1.5246s
	iters: 600, epoch: 8 | loss: 0.8426921
	speed: 0.0031s/iter; left time: 1.1898s
	iters: 700, epoch: 8 | loss: 1.2287011
	speed: 0.0031s/iter; left time: 0.8592s
	iters: 800, epoch: 8 | loss: 1.0518475
	speed: 0.0031s/iter; left time: 0.5666s
	iters: 900, epoch: 8 | loss: 0.4542969
	speed: 0.0031s/iter; left time: 0.2450s
Updating learning rate to 4.2391858671875e-07
Epoch: 8 cost time: 3.0874521732330322
Epoch: 8, Steps: 979 | Train Loss: 0.7952182 Vali Loss: 0.5628571 Best vali loss: 0.5613006

best validation loss 0.5613006247463518

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0041803840129, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616949
	speed: 0.0119s/iter; left time: 10.5246s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0511884689331055
Epoch: 1, Steps: 123 | Train Loss: 0.7616949 Vali Loss: 0.6076340 Best vali loss: 0.6076340
	iters: 100, epoch: 2 | loss: 0.9382303
	speed: 0.0092s/iter; left time: 7.0350s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5734).  Saving model state dict ...
Epoch: 2 cost time: 0.7197942733764648
Epoch: 2, Steps: 123 | Train Loss: 0.9382303 Vali Loss: 0.5734153 Best vali loss: 0.5734153
	iters: 100, epoch: 3 | loss: 0.8561884
	speed: 0.0093s/iter; left time: 5.9609s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5734 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 0.7207989692687988
Epoch: 3, Steps: 123 | Train Loss: 0.8561884 Vali Loss: 0.5452847 Best vali loss: 0.5452847

best validation loss 0.5452847451261215

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0093727885064, 'e_layers': 4, 'learning_rate': 0.0003028294233, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2564551
	speed: 0.0116s/iter; left time: 21.5798s
	iters: 200, epoch: 1 | loss: 1.1435095
	speed: 0.0057s/iter; left time: 9.9530s
Updating learning rate to 0.0003028294233
Validation loss decreased (inf --> 0.6100).  Saving model state dict ...
Epoch: 1 cost time: 1.7429804801940918
Epoch: 1, Steps: 245 | Train Loss: 1.1999823 Vali Loss: 0.6100405 Best vali loss: 0.6100405
	iters: 100, epoch: 2 | loss: 0.6788456
	speed: 0.0108s/iter; left time: 17.4809s
	iters: 200, epoch: 2 | loss: 0.8815911
	speed: 0.0051s/iter; left time: 7.7319s
Updating learning rate to 0.00015141471165
Validation loss decreased (0.6100 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 1.3079864978790283
Epoch: 2, Steps: 245 | Train Loss: 0.7802184 Vali Loss: 0.5995404 Best vali loss: 0.5995404
	iters: 100, epoch: 3 | loss: 0.6591587
	speed: 0.0110s/iter; left time: 15.0155s
	iters: 200, epoch: 3 | loss: 0.6110330
	speed: 0.0058s/iter; left time: 7.3784s
Updating learning rate to 7.5707355825e-05
Validation loss decreased (0.5995 --> 0.5742).  Saving model state dict ...
Epoch: 3 cost time: 1.4777534008026123
Epoch: 3, Steps: 245 | Train Loss: 0.6350958 Vali Loss: 0.5741587 Best vali loss: 0.5741587

best validation loss 0.5741587349354587

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.001505924338, 'e_layers': 4, 'learning_rate': 0.0038885836786, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003740583274857994
Validation loss decreased (inf --> 0.6190).  Saving model state dict ...
Epoch: 1 cost time: 0.8083920478820801
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6189580 Best vali loss: 0.6189580
Updating learning rate to 0.003319113783474695
Validation loss decreased (0.6190 --> 0.6115).  Saving model state dict ...
Epoch: 2 cost time: 0.5098028182983398
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6114563 Best vali loss: 0.6114563
Updating learning rate to 0.002688340113882758
Epoch: 3 cost time: 0.49957799911499023
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6149634 Best vali loss: 0.6114563

best validation loss 0.6114563324670999

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0041803840129, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6060286
	speed: 0.0121s/iter; left time: 6.2459s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5453 --> 0.5314).  Saving model state dict ...
Epoch: 4 cost time: 1.0338630676269531
Epoch: 4, Steps: 123 | Train Loss: 0.6060286 Vali Loss: 0.5314148 Best vali loss: 0.5314148
	iters: 100, epoch: 5 | loss: 0.8483788
	speed: 0.0093s/iter; left time: 3.6674s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5314 --> 0.5289).  Saving model state dict ...
Epoch: 5 cost time: 0.7237980365753174
Epoch: 5, Steps: 123 | Train Loss: 0.8483788 Vali Loss: 0.5288831 Best vali loss: 0.5288831
	iters: 100, epoch: 6 | loss: 0.8000891
	speed: 0.0093s/iter; left time: 2.5224s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5289 --> 0.5280).  Saving model state dict ...
Epoch: 6 cost time: 0.7246828079223633
Epoch: 6, Steps: 123 | Train Loss: 0.8000891 Vali Loss: 0.5279892 Best vali loss: 0.5279892
	iters: 100, epoch: 7 | loss: 0.4775221
	speed: 0.0095s/iter; left time: 1.3913s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.7285382747650146
Epoch: 7, Steps: 123 | Train Loss: 0.4775221 Vali Loss: 0.5301258 Best vali loss: 0.5279892
	iters: 100, epoch: 8 | loss: 0.5503429
	speed: 0.0089s/iter; left time: 0.2141s
Updating learning rate to 0.0
Validation loss decreased (0.5280 --> 0.5254).  Saving model state dict ...
Epoch: 8 cost time: 0.7122161388397217
Epoch: 8, Steps: 123 | Train Loss: 0.5503429 Vali Loss: 0.5253592 Best vali loss: 0.5253592

best validation loss 0.5253592258192554

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002976522752, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745570
	speed: 0.0117s/iter; left time: 10.3274s
Updating learning rate to 0.00028632356003134845
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0331757068634033
Epoch: 1, Steps: 123 | Train Loss: 0.7745570 Vali Loss: 0.6173101 Best vali loss: 0.6173101
	iters: 100, epoch: 2 | loss: 0.9494173
	speed: 0.0092s/iter; left time: 6.9997s
Updating learning rate to 0.00025406210871476223
Validation loss decreased (0.6173 --> 0.5754).  Saving model state dict ...
Epoch: 2 cost time: 0.7247805595397949
Epoch: 2, Steps: 123 | Train Loss: 0.9494173 Vali Loss: 0.5754199 Best vali loss: 0.5754199
	iters: 100, epoch: 3 | loss: 0.8495677
	speed: 0.0093s/iter; left time: 5.9656s
Updating learning rate to 0.00020577943476240718
Validation loss decreased (0.5754 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 0.7271580696105957
Epoch: 3, Steps: 123 | Train Loss: 0.8495677 Vali Loss: 0.5464466 Best vali loss: 0.5464466
	iters: 100, epoch: 4 | loss: 0.4843382
	speed: 0.0094s/iter; left time: 4.8676s
Updating learning rate to 0.0001488261376
Validation loss decreased (0.5464 --> 0.5365).  Saving model state dict ...
Epoch: 4 cost time: 0.7285077571868896
Epoch: 4, Steps: 123 | Train Loss: 0.4843382 Vali Loss: 0.5365074 Best vali loss: 0.5365074
	iters: 100, epoch: 5 | loss: 0.5605156
	speed: 0.0094s/iter; left time: 3.6899s
Updating learning rate to 9.187284043759287e-05
Validation loss decreased (0.5365 --> 0.5264).  Saving model state dict ...
Epoch: 5 cost time: 0.7305748462677002
Epoch: 5, Steps: 123 | Train Loss: 0.5605156 Vali Loss: 0.5263519 Best vali loss: 0.5263519
	iters: 100, epoch: 6 | loss: 0.5795848
	speed: 0.0093s/iter; left time: 2.5222s
Updating learning rate to 4.35901664852378e-05
Epoch: 6 cost time: 0.7257034778594971
Epoch: 6, Steps: 123 | Train Loss: 0.5795848 Vali Loss: 0.5427455 Best vali loss: 0.5263519
	iters: 100, epoch: 7 | loss: 0.5307398
	speed: 0.0090s/iter; left time: 1.3302s
Updating learning rate to 1.1328715168651568e-05
Epoch: 7 cost time: 0.72389817237854
Epoch: 7, Steps: 123 | Train Loss: 0.5307398 Vali Loss: 0.5433794 Best vali loss: 0.5263519
	iters: 100, epoch: 8 | loss: 0.6939288
	speed: 0.0091s/iter; left time: 0.2193s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7264533042907715
Epoch: 8, Steps: 123 | Train Loss: 0.6939288 Vali Loss: 0.5493357 Best vali loss: 0.5263519

best validation loss 0.5263519302003641

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011119442545, 'e_layers': 2, 'learning_rate': 0.0001763694629, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7613160
	speed: 0.0118s/iter; left time: 10.4327s
Updating learning rate to 0.00016965679991665935
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.0335028171539307
Epoch: 1, Steps: 123 | Train Loss: 0.7613160 Vali Loss: 0.6076915 Best vali loss: 0.6076915
	iters: 100, epoch: 2 | loss: 0.9398699
	speed: 0.0092s/iter; left time: 7.0250s
Updating learning rate to 0.0001505407530554096
Validation loss decreased (0.6077 --> 0.5751).  Saving model state dict ...
Epoch: 2 cost time: 0.7205297946929932
Epoch: 2, Steps: 123 | Train Loss: 0.9398699 Vali Loss: 0.5750529 Best vali loss: 0.5750529
	iters: 100, epoch: 3 | loss: 0.8583083
	speed: 0.0094s/iter; left time: 6.0277s
Updating learning rate to 0.00012193156716347968
Validation loss decreased (0.5751 --> 0.5443).  Saving model state dict ...
Epoch: 3 cost time: 0.7296252250671387
Epoch: 3, Steps: 123 | Train Loss: 0.8583083 Vali Loss: 0.5442724 Best vali loss: 0.5442724
	iters: 100, epoch: 4 | loss: 0.4993982
	speed: 0.0094s/iter; left time: 4.8685s
Updating learning rate to 8.818473145e-05
Validation loss decreased (0.5443 --> 0.5436).  Saving model state dict ...
Epoch: 4 cost time: 0.7264440059661865
Epoch: 4, Steps: 123 | Train Loss: 0.4993982 Vali Loss: 0.5435851 Best vali loss: 0.5435851
	iters: 100, epoch: 5 | loss: 0.5724766
	speed: 0.0095s/iter; left time: 3.7276s
Updating learning rate to 5.4437895736520324e-05
Validation loss decreased (0.5436 --> 0.5307).  Saving model state dict ...
Epoch: 5 cost time: 0.731163501739502
Epoch: 5, Steps: 123 | Train Loss: 0.5724766 Vali Loss: 0.5307018 Best vali loss: 0.5307018
	iters: 100, epoch: 6 | loss: 0.6216968
	speed: 0.0094s/iter; left time: 2.5478s
Updating learning rate to 2.58287098445904e-05
Validation loss decreased (0.5307 --> 0.5289).  Saving model state dict ...
Epoch: 6 cost time: 0.7348694801330566
Epoch: 6, Steps: 123 | Train Loss: 0.6216968 Vali Loss: 0.5289401 Best vali loss: 0.5289401
	iters: 100, epoch: 7 | loss: 0.5739487
	speed: 0.0094s/iter; left time: 1.3821s
Updating learning rate to 6.7126629833406345e-06
Validation loss decreased (0.5289 --> 0.5263).  Saving model state dict ...
Epoch: 7 cost time: 0.7230100631713867
Epoch: 7, Steps: 123 | Train Loss: 0.5739487 Vali Loss: 0.5263218 Best vali loss: 0.5263218
	iters: 100, epoch: 8 | loss: 0.7394038
	speed: 0.0093s/iter; left time: 0.2233s
Updating learning rate to 0.0
Validation loss decreased (0.5263 --> 0.5235).  Saving model state dict ...
Epoch: 8 cost time: 0.7236232757568359
Epoch: 8, Steps: 123 | Train Loss: 0.7394038 Vali Loss: 0.5235441 Best vali loss: 0.5235441

best validation loss 0.5235441095268545

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019156594113, 'e_layers': 1, 'learning_rate': 8.7419881e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9751374
	speed: 0.0091s/iter; left time: 16.9671s
	iters: 200, epoch: 1 | loss: 0.5918092
	speed: 0.0030s/iter; left time: 5.2530s
Updating learning rate to 8.7419881e-05
Validation loss decreased (inf --> 0.6137).  Saving model state dict ...
Epoch: 1 cost time: 1.0735893249511719
Epoch: 1, Steps: 245 | Train Loss: 0.7834733 Vali Loss: 0.6137434 Best vali loss: 0.6137434
	iters: 100, epoch: 2 | loss: 0.6969663
	speed: 0.0067s/iter; left time: 10.8976s
	iters: 200, epoch: 2 | loss: 0.5857970
	speed: 0.0029s/iter; left time: 4.4419s
Updating learning rate to 4.37099405e-05
Validation loss decreased (0.6137 --> 0.6104).  Saving model state dict ...
Epoch: 2 cost time: 0.768911600112915
Epoch: 2, Steps: 245 | Train Loss: 0.6413817 Vali Loss: 0.6104246 Best vali loss: 0.6104246
	iters: 100, epoch: 3 | loss: 0.7109855
	speed: 0.0068s/iter; left time: 9.2581s
	iters: 200, epoch: 3 | loss: 0.6163533
	speed: 0.0030s/iter; left time: 3.7774s
Updating learning rate to 2.185497025e-05
Validation loss decreased (0.6104 --> 0.6052).  Saving model state dict ...
Epoch: 3 cost time: 0.7785546779632568
Epoch: 3, Steps: 245 | Train Loss: 0.6636694 Vali Loss: 0.6052153 Best vali loss: 0.6052153

best validation loss 0.6052152543142955

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042349220364, 'e_layers': 2, 'learning_rate': 0.0001775619858, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7619146
	speed: 0.0117s/iter; left time: 10.3642s
Updating learning rate to 0.0001775619858
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.0281999111175537
Epoch: 1, Steps: 123 | Train Loss: 0.7619146 Vali Loss: 0.6077146 Best vali loss: 0.6077146
	iters: 100, epoch: 2 | loss: 0.9314298
	speed: 0.0092s/iter; left time: 7.0048s
Updating learning rate to 8.87809929e-05
Validation loss decreased (0.6077 --> 0.5581).  Saving model state dict ...
Epoch: 2 cost time: 0.720304012298584
Epoch: 2, Steps: 123 | Train Loss: 0.9314298 Vali Loss: 0.5580993 Best vali loss: 0.5580993
	iters: 100, epoch: 3 | loss: 0.8570181
	speed: 0.0094s/iter; left time: 5.9990s
Updating learning rate to 4.439049645e-05
Epoch: 3 cost time: 0.729254961013794
Epoch: 3, Steps: 123 | Train Loss: 0.8570181 Vali Loss: 0.5581337 Best vali loss: 0.5580993

best validation loss 0.5580992902776037

[INFO][smbo.py:320] Finished 650 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0040760257039, 'e_layers': 2, 'learning_rate': 0.0003132856312, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9999902
	speed: 0.0108s/iter; left time: 20.1650s
	iters: 200, epoch: 1 | loss: 0.8141389
	speed: 0.0039s/iter; left time: 6.8886s
Updating learning rate to 0.0003132856312
Validation loss decreased (inf --> 0.6090).  Saving model state dict ...
Epoch: 1 cost time: 1.3216111660003662
Epoch: 1, Steps: 245 | Train Loss: 0.9070646 Vali Loss: 0.6089510 Best vali loss: 0.6089510
	iters: 100, epoch: 2 | loss: 0.7540593
	speed: 0.0083s/iter; left time: 13.4421s
	iters: 200, epoch: 2 | loss: 0.9285168
	speed: 0.0039s/iter; left time: 5.9401s
Updating learning rate to 0.0001566428156
Validation loss decreased (0.6090 --> 0.5747).  Saving model state dict ...
Epoch: 2 cost time: 1.0210719108581543
Epoch: 2, Steps: 245 | Train Loss: 0.8412880 Vali Loss: 0.5747035 Best vali loss: 0.5747035
	iters: 100, epoch: 3 | loss: 0.5028538
	speed: 0.0079s/iter; left time: 10.8290s
	iters: 200, epoch: 3 | loss: 0.6448607
	speed: 0.0036s/iter; left time: 4.6121s
Updating learning rate to 7.83214078e-05
Validation loss decreased (0.5747 --> 0.5729).  Saving model state dict ...
Epoch: 3 cost time: 0.9250953197479248
Epoch: 3, Steps: 245 | Train Loss: 0.5738573 Vali Loss: 0.5729336 Best vali loss: 0.5729336

best validation loss 0.5729336143367437

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042349220364, 'e_layers': 2, 'learning_rate': 0.0001775619858, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6114462
	speed: 0.0126s/iter; left time: 6.4835s
Updating learning rate to 2.2195248225e-05
Validation loss decreased (0.5581 --> 0.5434).  Saving model state dict ...
Epoch: 4 cost time: 1.038114309310913
Epoch: 4, Steps: 123 | Train Loss: 0.6114462 Vali Loss: 0.5434348 Best vali loss: 0.5434348
	iters: 100, epoch: 5 | loss: 0.8619316
	speed: 0.0094s/iter; left time: 3.7131s
Updating learning rate to 1.10976241125e-05
Validation loss decreased (0.5434 --> 0.5380).  Saving model state dict ...
Epoch: 5 cost time: 0.7229597568511963
Epoch: 5, Steps: 123 | Train Loss: 0.8619316 Vali Loss: 0.5380038 Best vali loss: 0.5380038
	iters: 100, epoch: 6 | loss: 0.8321251
	speed: 0.0094s/iter; left time: 2.5402s
Updating learning rate to 5.54881205625e-06
Validation loss decreased (0.5380 --> 0.5367).  Saving model state dict ...
Epoch: 6 cost time: 0.7270646095275879
Epoch: 6, Steps: 123 | Train Loss: 0.8321251 Vali Loss: 0.5367481 Best vali loss: 0.5367481
	iters: 100, epoch: 7 | loss: 0.4979890
	speed: 0.0094s/iter; left time: 1.3811s
Updating learning rate to 2.774406028125e-06
Validation loss decreased (0.5367 --> 0.5361).  Saving model state dict ...
Epoch: 7 cost time: 0.7257704734802246
Epoch: 7, Steps: 123 | Train Loss: 0.4979890 Vali Loss: 0.5361329 Best vali loss: 0.5361329
	iters: 100, epoch: 8 | loss: 0.5795228
	speed: 0.0094s/iter; left time: 0.2263s
Updating learning rate to 1.3872030140625e-06
Validation loss decreased (0.5361 --> 0.5356).  Saving model state dict ...
Epoch: 8 cost time: 0.7277998924255371
Epoch: 8, Steps: 123 | Train Loss: 0.5795228 Vali Loss: 0.5356154 Best vali loss: 0.5356154

best validation loss 0.5356154497824902

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617033
	speed: 0.0117s/iter; left time: 10.3811s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0293657779693604
Epoch: 1, Steps: 123 | Train Loss: 0.7617033 Vali Loss: 0.6075518 Best vali loss: 0.6075518
	iters: 100, epoch: 2 | loss: 0.9368430
	speed: 0.0093s/iter; left time: 7.0748s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5668).  Saving model state dict ...
Epoch: 2 cost time: 0.7267313003540039
Epoch: 2, Steps: 123 | Train Loss: 0.9368430 Vali Loss: 0.5667805 Best vali loss: 0.5667805
	iters: 100, epoch: 3 | loss: 0.8641790
	speed: 0.0094s/iter; left time: 5.9833s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5668 --> 0.5442).  Saving model state dict ...
Epoch: 3 cost time: 0.7278480529785156
Epoch: 3, Steps: 123 | Train Loss: 0.8641790 Vali Loss: 0.5441794 Best vali loss: 0.5441794
	iters: 100, epoch: 4 | loss: 0.4995762
	speed: 0.0093s/iter; left time: 4.7736s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5442 --> 0.5349).  Saving model state dict ...
Epoch: 4 cost time: 0.7198138236999512
Epoch: 4, Steps: 123 | Train Loss: 0.4995762 Vali Loss: 0.5348563 Best vali loss: 0.5348563
	iters: 100, epoch: 5 | loss: 0.5737962
	speed: 0.0092s/iter; left time: 3.6113s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5349 --> 0.5302).  Saving model state dict ...
Epoch: 5 cost time: 0.7154824733734131
Epoch: 5, Steps: 123 | Train Loss: 0.5737962 Vali Loss: 0.5301699 Best vali loss: 0.5301699
	iters: 100, epoch: 6 | loss: 0.6215551
	speed: 0.0091s/iter; left time: 2.4694s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5302 --> 0.5289).  Saving model state dict ...
Epoch: 6 cost time: 0.7159972190856934
Epoch: 6, Steps: 123 | Train Loss: 0.6215551 Vali Loss: 0.5289169 Best vali loss: 0.5289169
	iters: 100, epoch: 7 | loss: 0.5743751
	speed: 0.0093s/iter; left time: 1.3655s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5289 --> 0.5247).  Saving model state dict ...
Epoch: 7 cost time: 0.7161366939544678
Epoch: 7, Steps: 123 | Train Loss: 0.5743751 Vali Loss: 0.5247265 Best vali loss: 0.5247265
	iters: 100, epoch: 8 | loss: 0.7396039
	speed: 0.0093s/iter; left time: 0.2224s
Updating learning rate to 0.0
Validation loss decreased (0.5247 --> 0.5224).  Saving model state dict ...
Epoch: 8 cost time: 0.7260735034942627
Epoch: 8, Steps: 123 | Train Loss: 0.7396039 Vali Loss: 0.5224254 Best vali loss: 0.5224254

best validation loss 0.522425428632783

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.003526495781, 'e_layers': 3, 'learning_rate': 0.0004321124385, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8373196
	speed: 0.0109s/iter; left time: 41.4819s
	iters: 200, epoch: 1 | loss: 0.6917887
	speed: 0.0046s/iter; left time: 17.2556s
	iters: 300, epoch: 1 | loss: 0.8857124
	speed: 0.0047s/iter; left time: 17.0847s
	iters: 400, epoch: 1 | loss: 0.7841015
	speed: 0.0048s/iter; left time: 16.9127s
Updating learning rate to 0.0004156661380868461
Validation loss decreased (inf --> 0.6550).  Saving model state dict ...
Epoch: 1 cost time: 2.6668691635131836
Epoch: 1, Steps: 490 | Train Loss: 0.7997306 Vali Loss: 0.6550332 Best vali loss: 0.6550332
	iters: 100, epoch: 2 | loss: 0.7437751
	speed: 0.0125s/iter; left time: 41.6515s
	iters: 200, epoch: 2 | loss: 0.6210220
	speed: 0.0042s/iter; left time: 13.7043s
	iters: 300, epoch: 2 | loss: 1.5166718
	speed: 0.0042s/iter; left time: 13.2084s
	iters: 400, epoch: 2 | loss: 0.8303983
	speed: 0.0044s/iter; left time: 13.3308s
Updating learning rate to 0.0003688310369992025
Validation loss decreased (0.6550 --> 0.6531).  Saving model state dict ...
Epoch: 2 cost time: 2.1354377269744873
Epoch: 2, Steps: 490 | Train Loss: 0.9279668 Vali Loss: 0.6531426 Best vali loss: 0.6531426
	iters: 100, epoch: 3 | loss: 1.0368568
	speed: 0.0126s/iter; left time: 35.8102s
	iters: 200, epoch: 3 | loss: 1.4347007
	speed: 0.0042s/iter; left time: 11.5135s
	iters: 300, epoch: 3 | loss: 0.9362179
	speed: 0.0042s/iter; left time: 11.1212s
	iters: 400, epoch: 3 | loss: 1.1255926
	speed: 0.0042s/iter; left time: 10.6209s
Updating learning rate to 0.0002987373548164144
Validation loss decreased (0.6531 --> 0.6411).  Saving model state dict ...
Epoch: 3 cost time: 2.125692367553711
Epoch: 3, Steps: 490 | Train Loss: 1.1333420 Vali Loss: 0.6411166 Best vali loss: 0.6411166
	iters: 100, epoch: 4 | loss: 0.4702048
	speed: 0.0123s/iter; left time: 29.0203s
	iters: 200, epoch: 4 | loss: 0.9451773
	speed: 0.0042s/iter; left time: 9.4505s
	iters: 300, epoch: 4 | loss: 1.7734306
	speed: 0.0042s/iter; left time: 9.0109s
	iters: 400, epoch: 4 | loss: 1.3517748
	speed: 0.0042s/iter; left time: 8.5825s
Updating learning rate to 0.00021605621925
Epoch: 4 cost time: 2.127685785293579
Epoch: 4, Steps: 490 | Train Loss: 1.1351469 Vali Loss: 0.6460257 Best vali loss: 0.6411166
	iters: 100, epoch: 5 | loss: 0.8714322
	speed: 0.0119s/iter; left time: 22.2194s
	iters: 200, epoch: 5 | loss: 0.8299449
	speed: 0.0043s/iter; left time: 7.5134s
	iters: 300, epoch: 5 | loss: 0.8701034
	speed: 0.0042s/iter; left time: 7.0266s
	iters: 400, epoch: 5 | loss: 1.0606439
	speed: 0.0043s/iter; left time: 6.6853s
Updating learning rate to 0.00013337508368358562
Validation loss decreased (0.6411 --> 0.6373).  Saving model state dict ...
Epoch: 5 cost time: 2.125979423522949
Epoch: 5, Steps: 490 | Train Loss: 0.9080311 Vali Loss: 0.6372501 Best vali loss: 0.6372501
	iters: 100, epoch: 6 | loss: 0.8409242
	speed: 0.0127s/iter; left time: 17.4780s
	iters: 200, epoch: 6 | loss: 0.8609456
	speed: 0.0048s/iter; left time: 6.0711s
	iters: 300, epoch: 6 | loss: 0.6008009
	speed: 0.0048s/iter; left time: 5.6082s
	iters: 400, epoch: 6 | loss: 1.5089685
	speed: 0.0047s/iter; left time: 5.0730s
Updating learning rate to 6.328140150079753e-05
Epoch: 6 cost time: 2.382697105407715
Epoch: 6, Steps: 490 | Train Loss: 0.9529098 Vali Loss: 0.6429324 Best vali loss: 0.6372501
	iters: 100, epoch: 7 | loss: 0.9970934
	speed: 0.0127s/iter; left time: 11.1796s
	iters: 200, epoch: 7 | loss: 0.8159652
	speed: 0.0047s/iter; left time: 3.6611s
	iters: 300, epoch: 7 | loss: 0.3191023
	speed: 0.0046s/iter; left time: 3.1455s
	iters: 400, epoch: 7 | loss: 0.7532670
	speed: 0.0047s/iter; left time: 2.7098s
Updating learning rate to 1.644630041315393e-05
Epoch: 7 cost time: 2.337463617324829
Epoch: 7, Steps: 490 | Train Loss: 0.7213570 Vali Loss: 0.6399956 Best vali loss: 0.6372501
	iters: 100, epoch: 8 | loss: 0.4801857
	speed: 0.0128s/iter; left time: 5.0224s
	iters: 200, epoch: 8 | loss: 0.9659738
	speed: 0.0048s/iter; left time: 1.3856s
	iters: 300, epoch: 8 | loss: 0.7629802
	speed: 0.0048s/iter; left time: 0.9112s
	iters: 400, epoch: 8 | loss: 1.1513752
	speed: 0.0048s/iter; left time: 0.4355s
Updating learning rate to 0.0
Validation loss decreased (0.6373 --> 0.6351).  Saving model state dict ...
Epoch: 8 cost time: 2.3783886432647705
Epoch: 8, Steps: 490 | Train Loss: 0.8401287 Vali Loss: 0.6350581 Best vali loss: 0.6350581

best validation loss 0.635058103805888

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043847626055, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617062
	speed: 0.0117s/iter; left time: 10.3542s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0183792114257812
Epoch: 1, Steps: 123 | Train Loss: 0.7617062 Vali Loss: 0.6075521 Best vali loss: 0.6075521
	iters: 100, epoch: 2 | loss: 0.9358482
	speed: 0.0092s/iter; left time: 6.9908s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5693).  Saving model state dict ...
Epoch: 2 cost time: 0.7177069187164307
Epoch: 2, Steps: 123 | Train Loss: 0.9358482 Vali Loss: 0.5693472 Best vali loss: 0.5693472
	iters: 100, epoch: 3 | loss: 0.8577304
	speed: 0.0094s/iter; left time: 5.9837s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5693 --> 0.5444).  Saving model state dict ...
Epoch: 3 cost time: 0.7208552360534668
Epoch: 3, Steps: 123 | Train Loss: 0.8577304 Vali Loss: 0.5444379 Best vali loss: 0.5444379

best validation loss 0.5444378688179856

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043671158531, 'e_layers': 2, 'learning_rate': 0.000175360323, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616217
	speed: 0.0120s/iter; left time: 10.5826s
Updating learning rate to 0.00016868606811713414
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0390276908874512
Epoch: 1, Steps: 123 | Train Loss: 0.7616217 Vali Loss: 0.6075405 Best vali loss: 0.6075405
	iters: 100, epoch: 2 | loss: 0.9355847
	speed: 0.0093s/iter; left time: 7.0717s
Updating learning rate to 0.00014967939827218165
Validation loss decreased (0.6075 --> 0.5663).  Saving model state dict ...
Epoch: 2 cost time: 0.7266840934753418
Epoch: 2, Steps: 123 | Train Loss: 0.9355847 Vali Loss: 0.5663399 Best vali loss: 0.5663399
	iters: 100, epoch: 3 | loss: 0.8557003
	speed: 0.0094s/iter; left time: 5.9801s
Updating learning rate to 0.0001212339066531454
Validation loss decreased (0.5663 --> 0.5431).  Saving model state dict ...
Epoch: 3 cost time: 0.7267966270446777
Epoch: 3, Steps: 123 | Train Loss: 0.8557003 Vali Loss: 0.5430722 Best vali loss: 0.5430722

best validation loss 0.5430722063418507

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0009467872673, 'e_layers': 2, 'learning_rate': 0.0009549074204, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2986238
	speed: 0.0095s/iter; left time: 73.5607s
	iters: 200, epoch: 1 | loss: 1.1658585
	speed: 0.0035s/iter; left time: 26.7553s
	iters: 300, epoch: 1 | loss: 0.9672560
	speed: 0.0034s/iter; left time: 25.7206s
	iters: 400, epoch: 1 | loss: 0.4150248
	speed: 0.0034s/iter; left time: 25.0026s
	iters: 500, epoch: 1 | loss: 1.0066788
	speed: 0.0035s/iter; left time: 25.5405s
	iters: 600, epoch: 1 | loss: 0.9401823
	speed: 0.0035s/iter; left time: 25.0439s
	iters: 700, epoch: 1 | loss: 0.4436067
	speed: 0.0032s/iter; left time: 22.7127s
	iters: 800, epoch: 1 | loss: 0.3289646
	speed: 0.0030s/iter; left time: 21.1243s
	iters: 900, epoch: 1 | loss: 1.4167645
	speed: 0.0030s/iter; left time: 20.8279s
Updating learning rate to 0.0009185634207753554
Validation loss decreased (inf --> 0.5981).  Saving model state dict ...
Epoch: 1 cost time: 3.5724685192108154
Epoch: 1, Steps: 979 | Train Loss: 0.7758844 Vali Loss: 0.5980761 Best vali loss: 0.5980761
	iters: 100, epoch: 2 | loss: 0.2493244
	speed: 0.0111s/iter; left time: 74.6883s
	iters: 200, epoch: 2 | loss: 0.4188779
	speed: 0.0033s/iter; left time: 21.9199s
	iters: 300, epoch: 2 | loss: 0.8604394
	speed: 0.0034s/iter; left time: 21.9590s
	iters: 400, epoch: 2 | loss: 1.0784798
	speed: 0.0034s/iter; left time: 22.0191s
	iters: 500, epoch: 2 | loss: 1.0217167
	speed: 0.0031s/iter; left time: 19.9200s
	iters: 600, epoch: 2 | loss: 0.7133919
	speed: 0.0030s/iter; left time: 18.8548s
	iters: 700, epoch: 2 | loss: 1.1532888
	speed: 0.0030s/iter; left time: 18.6861s
	iters: 800, epoch: 2 | loss: 0.3054219
	speed: 0.0031s/iter; left time: 18.6557s
	iters: 900, epoch: 2 | loss: 0.3485983
	speed: 0.0030s/iter; left time: 18.1259s
Updating learning rate to 0.0008150644663850967
Epoch: 2 cost time: 3.144155502319336
Epoch: 2, Steps: 979 | Train Loss: 0.6832821 Vali Loss: 0.6202253 Best vali loss: 0.5980761
	iters: 100, epoch: 3 | loss: 1.1468632
	speed: 0.0106s/iter; left time: 61.1615s
	iters: 200, epoch: 3 | loss: 0.4862844
	speed: 0.0032s/iter; left time: 17.9405s
	iters: 300, epoch: 3 | loss: 1.0998498
	speed: 0.0032s/iter; left time: 17.7564s
	iters: 400, epoch: 3 | loss: 0.4205406
	speed: 0.0032s/iter; left time: 17.2546s
	iters: 500, epoch: 3 | loss: 1.0581880
	speed: 0.0031s/iter; left time: 16.6075s
	iters: 600, epoch: 3 | loss: 0.6752968
	speed: 0.0031s/iter; left time: 16.3017s
	iters: 700, epoch: 3 | loss: 0.9403406
	speed: 0.0030s/iter; left time: 15.5119s
	iters: 800, epoch: 3 | loss: 1.2974137
	speed: 0.0031s/iter; left time: 15.9565s
	iters: 900, epoch: 3 | loss: 1.7832037
	speed: 0.0031s/iter; left time: 15.2718s
Updating learning rate to 0.0006601673348147829
Epoch: 3 cost time: 3.0985169410705566
Epoch: 3, Steps: 979 | Train Loss: 0.9897757 Vali Loss: 0.6304920 Best vali loss: 0.5980761

best validation loss 0.59807612583186

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043671158531, 'e_layers': 2, 'learning_rate': 0.000175360323, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6064569
	speed: 0.0123s/iter; left time: 6.3210s
Updating learning rate to 8.76801615e-05
Validation loss decreased (0.5431 --> 0.5325).  Saving model state dict ...
Epoch: 4 cost time: 1.0400724411010742
Epoch: 4, Steps: 123 | Train Loss: 0.6064569 Vali Loss: 0.5324734 Best vali loss: 0.5324734
	iters: 100, epoch: 5 | loss: 0.8501101
	speed: 0.0094s/iter; left time: 3.6934s
Updating learning rate to 5.412641634685461e-05
Validation loss decreased (0.5325 --> 0.5275).  Saving model state dict ...
Epoch: 5 cost time: 0.7200107574462891
Epoch: 5, Steps: 123 | Train Loss: 0.8501101 Vali Loss: 0.5274508 Best vali loss: 0.5274508
	iters: 100, epoch: 6 | loss: 0.8078348
	speed: 0.0093s/iter; left time: 2.5097s
Updating learning rate to 2.5680924727818358e-05
Validation loss decreased (0.5275 --> 0.5269).  Saving model state dict ...
Epoch: 6 cost time: 0.7118966579437256
Epoch: 6, Steps: 123 | Train Loss: 0.8078348 Vali Loss: 0.5268918 Best vali loss: 0.5268918
	iters: 100, epoch: 7 | loss: 0.4821473
	speed: 0.0093s/iter; left time: 1.3680s
Updating learning rate to 6.674254882865879e-06
Epoch: 7 cost time: 0.7199091911315918
Epoch: 7, Steps: 123 | Train Loss: 0.4821473 Vali Loss: 0.5291762 Best vali loss: 0.5268918
	iters: 100, epoch: 8 | loss: 0.5517474
	speed: 0.0090s/iter; left time: 0.2162s
Updating learning rate to 0.0
Validation loss decreased (0.5269 --> 0.5253).  Saving model state dict ...
Epoch: 8 cost time: 0.7176988124847412
Epoch: 8, Steps: 123 | Train Loss: 0.5517474 Vali Loss: 0.5253270 Best vali loss: 0.5253270

best validation loss 0.5253269821060637

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0080678775264, 'e_layers': 2, 'learning_rate': 0.0001773652499, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7624492
	speed: 0.0118s/iter; left time: 10.4217s
Updating learning rate to 0.00017061468703067977
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.0236024856567383
Epoch: 1, Steps: 123 | Train Loss: 0.7624492 Vali Loss: 0.6076842 Best vali loss: 0.6076842
	iters: 100, epoch: 2 | loss: 0.9310643
	speed: 0.0092s/iter; left time: 7.0008s
Updating learning rate to 0.0001513907104255683
Validation loss decreased (0.6077 --> 0.5594).  Saving model state dict ...
Epoch: 2 cost time: 0.720588207244873
Epoch: 2, Steps: 123 | Train Loss: 0.9310643 Vali Loss: 0.5593689 Best vali loss: 0.5593689
	iters: 100, epoch: 3 | loss: 0.8553438
	speed: 0.0093s/iter; left time: 5.9652s
Updating learning rate to 0.00012261999625701195
Validation loss decreased (0.5594 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 0.7282490730285645
Epoch: 3, Steps: 123 | Train Loss: 0.8553438 Vali Loss: 0.5538143 Best vali loss: 0.5538143
	iters: 100, epoch: 4 | loss: 0.4908795
	speed: 0.0094s/iter; left time: 4.8627s
Updating learning rate to 8.868262495e-05
Validation loss decreased (0.5538 --> 0.5362).  Saving model state dict ...
Epoch: 4 cost time: 0.7264378070831299
Epoch: 4, Steps: 123 | Train Loss: 0.4908795 Vali Loss: 0.5361789 Best vali loss: 0.5361789
	iters: 100, epoch: 5 | loss: 0.5752046
	speed: 0.0092s/iter; left time: 3.6338s
Updating learning rate to 5.4745253642988054e-05
Epoch: 5 cost time: 0.7233428955078125
Epoch: 5, Steps: 123 | Train Loss: 0.5752046 Vali Loss: 0.5384086 Best vali loss: 0.5361789
	iters: 100, epoch: 6 | loss: 0.6152729
	speed: 0.0090s/iter; left time: 2.4298s
Updating learning rate to 2.5974539474431695e-05
Validation loss decreased (0.5362 --> 0.5293).  Saving model state dict ...
Epoch: 6 cost time: 0.7185430526733398
Epoch: 6, Steps: 123 | Train Loss: 0.6152729 Vali Loss: 0.5292931 Best vali loss: 0.5292931
	iters: 100, epoch: 7 | loss: 0.5748848
	speed: 0.0093s/iter; left time: 1.3614s
Updating learning rate to 6.750562869320226e-06
Validation loss decreased (0.5293 --> 0.5251).  Saving model state dict ...
Epoch: 7 cost time: 0.723283052444458
Epoch: 7, Steps: 123 | Train Loss: 0.5748848 Vali Loss: 0.5251233 Best vali loss: 0.5251233
	iters: 100, epoch: 8 | loss: 0.7372000
	speed: 0.0093s/iter; left time: 0.2237s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7272098064422607
Epoch: 8, Steps: 123 | Train Loss: 0.7372000 Vali Loss: 0.5252033 Best vali loss: 0.5251233

best validation loss 0.5251233325077395

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010521650253, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744317
	speed: 0.0118s/iter; left time: 10.3991s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0206029415130615
Epoch: 1, Steps: 123 | Train Loss: 0.7744317 Vali Loss: 0.6173302 Best vali loss: 0.6173302
	iters: 100, epoch: 2 | loss: 0.9544360
	speed: 0.0092s/iter; left time: 6.9752s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5681).  Saving model state dict ...
Epoch: 2 cost time: 0.7171101570129395
Epoch: 2, Steps: 123 | Train Loss: 0.9544360 Vali Loss: 0.5681105 Best vali loss: 0.5681105
	iters: 100, epoch: 3 | loss: 0.8592822
	speed: 0.0094s/iter; left time: 6.0166s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5681 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 0.7234489917755127
Epoch: 3, Steps: 123 | Train Loss: 0.8592822 Vali Loss: 0.5463822 Best vali loss: 0.5463822
	iters: 100, epoch: 4 | loss: 0.4901368
	speed: 0.0093s/iter; left time: 4.8129s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5464 --> 0.5427).  Saving model state dict ...
Epoch: 4 cost time: 0.7214405536651611
Epoch: 4, Steps: 123 | Train Loss: 0.4901368 Vali Loss: 0.5426961 Best vali loss: 0.5426961
	iters: 100, epoch: 5 | loss: 0.5601608
	speed: 0.0094s/iter; left time: 3.7003s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5427 --> 0.5238).  Saving model state dict ...
Epoch: 5 cost time: 0.726233720779419
Epoch: 5, Steps: 123 | Train Loss: 0.5601608 Vali Loss: 0.5238464 Best vali loss: 0.5238464
	iters: 100, epoch: 6 | loss: 0.5887474
	speed: 0.0094s/iter; left time: 2.5282s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7263901233673096
Epoch: 6, Steps: 123 | Train Loss: 0.5887474 Vali Loss: 0.5345430 Best vali loss: 0.5238464
	iters: 100, epoch: 7 | loss: 0.5392254
	speed: 0.0090s/iter; left time: 1.3272s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7264177799224854
Epoch: 7, Steps: 123 | Train Loss: 0.5392254 Vali Loss: 0.5402095 Best vali loss: 0.5238464
	iters: 100, epoch: 8 | loss: 0.6991394
	speed: 0.0091s/iter; left time: 0.2188s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.721778392791748
Epoch: 8, Steps: 123 | Train Loss: 0.6991394 Vali Loss: 0.5453000 Best vali loss: 0.5238464

best validation loss 0.5238464338147271

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002981586264, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744241
	speed: 0.0118s/iter; left time: 10.4295s
Updating learning rate to 0.0002868106393863197
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.032933235168457
Epoch: 1, Steps: 123 | Train Loss: 0.7744241 Vali Loss: 0.6173599 Best vali loss: 0.6173599
	iters: 100, epoch: 2 | loss: 0.9418541
	speed: 0.0093s/iter; left time: 7.0918s
Updating learning rate to 0.00025449430649835314
Validation loss decreased (0.6174 --> 0.5741).  Saving model state dict ...
Epoch: 2 cost time: 0.7193195819854736
Epoch: 2, Steps: 123 | Train Loss: 0.9418541 Vali Loss: 0.5740549 Best vali loss: 0.5740549
	iters: 100, epoch: 3 | loss: 0.8575449
	speed: 0.0094s/iter; left time: 5.9996s
Updating learning rate to 0.00020612949647000624
Validation loss decreased (0.5741 --> 0.5434).  Saving model state dict ...
Epoch: 3 cost time: 0.7274701595306396
Epoch: 3, Steps: 123 | Train Loss: 0.8575449 Vali Loss: 0.5434197 Best vali loss: 0.5434197

best validation loss 0.5434197304647094

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0060809426983, 'e_layers': 3, 'learning_rate': 0.0002732309873, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002628317520571607
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 0.9445271492004395
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6037670 Best vali loss: 0.6037670
Updating learning rate to 0.00023321723562506273
Validation loss decreased (0.6038 --> 0.5663).  Saving model state dict ...
Epoch: 2 cost time: 0.647625207901001
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5662945 Best vali loss: 0.5662945
Updating learning rate to 0.00018889597967423313
Validation loss decreased (0.5663 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 0.6478555202484131
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5565999 Best vali loss: 0.5565999

best validation loss 0.556599850871948

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043945186606, 'e_layers': 2, 'learning_rate': 0.0001757177626, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616791
	speed: 0.0117s/iter; left time: 10.3298s
Updating learning rate to 0.00016902990348240864
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0180644989013672
Epoch: 1, Steps: 123 | Train Loss: 0.7616791 Vali Loss: 0.6075402 Best vali loss: 0.6075402
	iters: 100, epoch: 2 | loss: 0.9366703
	speed: 0.0093s/iter; left time: 7.0993s
Updating learning rate to 0.00014998449205469395
Validation loss decreased (0.6075 --> 0.5685).  Saving model state dict ...
Epoch: 2 cost time: 0.7267985343933105
Epoch: 2, Steps: 123 | Train Loss: 0.9366703 Vali Loss: 0.5685174 Best vali loss: 0.5685174
	iters: 100, epoch: 3 | loss: 0.8563149
	speed: 0.0095s/iter; left time: 6.0617s
Updating learning rate to 0.00012148101955964101
Validation loss decreased (0.5685 --> 0.5445).  Saving model state dict ...
Epoch: 3 cost time: 0.727806806564331
Epoch: 3, Steps: 123 | Train Loss: 0.8563149 Vali Loss: 0.5444822 Best vali loss: 0.5444822

best validation loss 0.5444822226724708

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002981586264, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5917575
	speed: 0.0120s/iter; left time: 6.1737s
Updating learning rate to 0.0001490793132
Validation loss decreased (0.5434 --> 0.5279).  Saving model state dict ...
Epoch: 4 cost time: 1.0353379249572754
Epoch: 4, Steps: 123 | Train Loss: 0.5917575 Vali Loss: 0.5279045 Best vali loss: 0.5279045
	iters: 100, epoch: 5 | loss: 0.8209425
	speed: 0.0093s/iter; left time: 3.6531s
Updating learning rate to 9.202912992999376e-05
Epoch: 5 cost time: 0.7168700695037842
Epoch: 5, Steps: 123 | Train Loss: 0.8209425 Vali Loss: 0.5296841 Best vali loss: 0.5279045
	iters: 100, epoch: 6 | loss: 0.7615317
	speed: 0.0088s/iter; left time: 2.3852s
Updating learning rate to 4.366431990164682e-05
Epoch: 6 cost time: 0.7142400741577148
Epoch: 6, Steps: 123 | Train Loss: 0.7615317 Vali Loss: 0.5358118 Best vali loss: 0.5279045
	iters: 100, epoch: 7 | loss: 0.4307229
	speed: 0.0090s/iter; left time: 1.3179s
Updating learning rate to 1.1347987013680302e-05
Epoch: 7 cost time: 0.7145891189575195
Epoch: 7, Steps: 123 | Train Loss: 0.4307229 Vali Loss: 0.5493093 Best vali loss: 0.5279045
	iters: 100, epoch: 8 | loss: 0.5105252
	speed: 0.0089s/iter; left time: 0.2146s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7148654460906982
Epoch: 8, Steps: 123 | Train Loss: 0.5105252 Vali Loss: 0.5458571 Best vali loss: 0.5279045

best validation loss 0.5279044828057454

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001757835615, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616820
	speed: 0.0115s/iter; left time: 10.1830s
Updating learning rate to 0.00016909319806089452
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0182750225067139
Epoch: 1, Steps: 123 | Train Loss: 0.7616820 Vali Loss: 0.6075430 Best vali loss: 0.6075430
	iters: 100, epoch: 2 | loss: 0.9381215
	speed: 0.0092s/iter; left time: 7.0084s
Updating learning rate to 0.00015004065492888626
Validation loss decreased (0.6075 --> 0.5738).  Saving model state dict ...
Epoch: 2 cost time: 0.7172961235046387
Epoch: 2, Steps: 123 | Train Loss: 0.9381215 Vali Loss: 0.5738485 Best vali loss: 0.5738485
	iters: 100, epoch: 3 | loss: 0.8614773
	speed: 0.0094s/iter; left time: 5.9815s
Updating learning rate to 0.00012152650908408994
Validation loss decreased (0.5738 --> 0.5443).  Saving model state dict ...
Epoch: 3 cost time: 0.717461347579956
Epoch: 3, Steps: 123 | Train Loss: 0.8614773 Vali Loss: 0.5442876 Best vali loss: 0.5442876
	iters: 100, epoch: 4 | loss: 0.4930307
	speed: 0.0092s/iter; left time: 4.7703s
Updating learning rate to 8.789178075e-05
Validation loss decreased (0.5443 --> 0.5382).  Saving model state dict ...
Epoch: 4 cost time: 0.7220566272735596
Epoch: 4, Steps: 123 | Train Loss: 0.4930307 Vali Loss: 0.5382141 Best vali loss: 0.5382141
	iters: 100, epoch: 5 | loss: 0.5800917
	speed: 0.0094s/iter; left time: 3.6784s
Updating learning rate to 5.425705241591008e-05
Validation loss decreased (0.5382 --> 0.5314).  Saving model state dict ...
Epoch: 5 cost time: 0.7260379791259766
Epoch: 5, Steps: 123 | Train Loss: 0.5800917 Vali Loss: 0.5313824 Best vali loss: 0.5313824
	iters: 100, epoch: 6 | loss: 0.6239419
	speed: 0.0094s/iter; left time: 2.5343s
Updating learning rate to 2.5742906571113747e-05
Validation loss decreased (0.5314 --> 0.5311).  Saving model state dict ...
Epoch: 6 cost time: 0.7271718978881836
Epoch: 6, Steps: 123 | Train Loss: 0.6239419 Vali Loss: 0.5311015 Best vali loss: 0.5311015
	iters: 100, epoch: 7 | loss: 0.5774400
	speed: 0.0094s/iter; left time: 1.3890s
Updating learning rate to 6.690363439105489e-06
Validation loss decreased (0.5311 --> 0.5249).  Saving model state dict ...
Epoch: 7 cost time: 0.734705924987793
Epoch: 7, Steps: 123 | Train Loss: 0.5774400 Vali Loss: 0.5248557 Best vali loss: 0.5248557
	iters: 100, epoch: 8 | loss: 0.7410354
	speed: 0.0093s/iter; left time: 0.2226s
Updating learning rate to 0.0
Validation loss decreased (0.5249 --> 0.5245).  Saving model state dict ...
Epoch: 8 cost time: 0.7174272537231445
Epoch: 8, Steps: 123 | Train Loss: 0.7410354 Vali Loss: 0.5244562 Best vali loss: 0.5244562

best validation loss 0.5244561722713287

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043942624159, 'e_layers': 2, 'learning_rate': 0.0001768500329, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7618356
	speed: 0.0116s/iter; left time: 10.2522s
Updating learning rate to 0.00017011907931012882
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.025536060333252
Epoch: 1, Steps: 123 | Train Loss: 0.7618356 Vali Loss: 0.6076359 Best vali loss: 0.6076359
	iters: 100, epoch: 2 | loss: 0.9392532
	speed: 0.0092s/iter; left time: 7.0314s
Updating learning rate to 0.000150950945208327
Validation loss decreased (0.6076 --> 0.5763).  Saving model state dict ...
Epoch: 2 cost time: 0.7177159786224365
Epoch: 2, Steps: 123 | Train Loss: 0.9392532 Vali Loss: 0.5763307 Best vali loss: 0.5763307
	iters: 100, epoch: 3 | loss: 0.8594775
	speed: 0.0093s/iter; left time: 5.9727s
Updating learning rate to 0.00012226380525202552
Validation loss decreased (0.5763 --> 0.5439).  Saving model state dict ...
Epoch: 3 cost time: 0.7241952419281006
Epoch: 3, Steps: 123 | Train Loss: 0.8594775 Vali Loss: 0.5438816 Best vali loss: 0.5438816
	iters: 100, epoch: 4 | loss: 0.4973757
	speed: 0.0095s/iter; left time: 4.8768s
Updating learning rate to 8.842501645e-05
Validation loss decreased (0.5439 --> 0.5368).  Saving model state dict ...
Epoch: 4 cost time: 0.7287554740905762
Epoch: 4, Steps: 123 | Train Loss: 0.4973757 Vali Loss: 0.5368091 Best vali loss: 0.5368091
	iters: 100, epoch: 5 | loss: 0.5800826
	speed: 0.0095s/iter; left time: 3.7364s
Updating learning rate to 5.4586227647974475e-05
Validation loss decreased (0.5368 --> 0.5295).  Saving model state dict ...
Epoch: 5 cost time: 0.7303340435028076
Epoch: 5, Steps: 123 | Train Loss: 0.5800826 Vali Loss: 0.5294800 Best vali loss: 0.5294800
	iters: 100, epoch: 6 | loss: 0.6201018
	speed: 0.0093s/iter; left time: 2.5142s
Updating learning rate to 2.5899087691672988e-05
Epoch: 6 cost time: 0.7287318706512451
Epoch: 6, Steps: 123 | Train Loss: 0.6201018 Vali Loss: 0.5302322 Best vali loss: 0.5294800
	iters: 100, epoch: 7 | loss: 0.5749156
	speed: 0.0091s/iter; left time: 1.3311s
Updating learning rate to 6.7309535898711595e-06
Validation loss decreased (0.5295 --> 0.5253).  Saving model state dict ...
Epoch: 7 cost time: 0.7195897102355957
Epoch: 7, Steps: 123 | Train Loss: 0.5749156 Vali Loss: 0.5252887 Best vali loss: 0.5252887
	iters: 100, epoch: 8 | loss: 0.7402409
	speed: 0.0094s/iter; left time: 0.2249s
Updating learning rate to 0.0
Validation loss decreased (0.5253 --> 0.5247).  Saving model state dict ...
Epoch: 8 cost time: 0.7330482006072998
Epoch: 8, Steps: 123 | Train Loss: 0.7402409 Vali Loss: 0.5246845 Best vali loss: 0.5246845

best validation loss 0.5246844577022528

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043976689674, 'e_layers': 2, 'learning_rate': 0.0001762950642, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617681
	speed: 0.0117s/iter; left time: 10.3195s
Updating learning rate to 0.00016958523284857165
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0226922035217285
Epoch: 1, Steps: 123 | Train Loss: 0.7617681 Vali Loss: 0.6075882 Best vali loss: 0.6075882
	iters: 100, epoch: 2 | loss: 0.9369544
	speed: 0.0094s/iter; left time: 7.1523s
Updating learning rate to 0.00015047724979276887
Validation loss decreased (0.6076 --> 0.5746).  Saving model state dict ...
Epoch: 2 cost time: 0.7273421287536621
Epoch: 2, Steps: 123 | Train Loss: 0.9369544 Vali Loss: 0.5745798 Best vali loss: 0.5745798
	iters: 100, epoch: 3 | loss: 0.8545390
	speed: 0.0094s/iter; left time: 5.9955s
Updating learning rate to 0.00012188013223853993
Validation loss decreased (0.5746 --> 0.5491).  Saving model state dict ...
Epoch: 3 cost time: 0.7285730838775635
Epoch: 3, Steps: 123 | Train Loss: 0.8545390 Vali Loss: 0.5490932 Best vali loss: 0.5490932

best validation loss 0.5490931614523186

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0050418836604, 'e_layers': 1, 'learning_rate': 5.9603423e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.733490278865624e-05
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 0.7332065105438232
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6698565 Best vali loss: 0.6698565
Updating learning rate to 5.0874703792615117e-05
Validation loss decreased (0.6699 --> 0.6409).  Saving model state dict ...
Epoch: 2 cost time: 0.4336357116699219
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6409063 Best vali loss: 0.6409063
Updating learning rate to 4.120633274717417e-05
Validation loss decreased (0.6409 --> 0.6244).  Saving model state dict ...
Epoch: 3 cost time: 0.4270670413970947
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6244068 Best vali loss: 0.6244068

best validation loss 0.6244068376061432

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043907963512, 'e_layers': 2, 'learning_rate': 0.0001751528999, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7615871
	speed: 0.0117s/iter; left time: 10.3960s
Updating learning rate to 0.0001684865395888041
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0307528972625732
Epoch: 1, Steps: 123 | Train Loss: 0.7615871 Vali Loss: 0.6075238 Best vali loss: 0.6075238
	iters: 100, epoch: 2 | loss: 0.9348190
	speed: 0.0092s/iter; left time: 7.0110s
Updating learning rate to 0.00014950235158188929
Validation loss decreased (0.6075 --> 0.5724).  Saving model state dict ...
Epoch: 2 cost time: 0.7260913848876953
Epoch: 2, Steps: 123 | Train Loss: 0.9348190 Vali Loss: 0.5723811 Best vali loss: 0.5723811
	iters: 100, epoch: 3 | loss: 0.8587660
	speed: 0.0094s/iter; left time: 5.9966s
Updating learning rate to 0.0001210905064112155
Validation loss decreased (0.5724 --> 0.5552).  Saving model state dict ...
Epoch: 3 cost time: 0.7236900329589844
Epoch: 3, Steps: 123 | Train Loss: 0.8587660 Vali Loss: 0.5552052 Best vali loss: 0.5552052

best validation loss 0.5552052197937389

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043976689674, 'e_layers': 2, 'learning_rate': 0.0001762950642, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6087657
	speed: 0.0121s/iter; left time: 6.2446s
Updating learning rate to 8.81475321e-05
Validation loss decreased (0.5491 --> 0.5314).  Saving model state dict ...
Epoch: 4 cost time: 1.0326924324035645
Epoch: 4, Steps: 123 | Train Loss: 0.6087657 Vali Loss: 0.5314114 Best vali loss: 0.5314114
	iters: 100, epoch: 5 | loss: 0.8449546
	speed: 0.0093s/iter; left time: 3.6502s
Updating learning rate to 5.4414931961460076e-05
Validation loss decreased (0.5314 --> 0.5274).  Saving model state dict ...
Epoch: 5 cost time: 0.7264699935913086
Epoch: 5, Steps: 123 | Train Loss: 0.8449546 Vali Loss: 0.5273502 Best vali loss: 0.5273502
	iters: 100, epoch: 6 | loss: 0.8030381
	speed: 0.0094s/iter; left time: 2.5316s
Updating learning rate to 2.581781440723113e-05
Validation loss decreased (0.5274 --> 0.5255).  Saving model state dict ...
Epoch: 6 cost time: 0.7216770648956299
Epoch: 6, Steps: 123 | Train Loss: 0.8030381 Vali Loss: 0.5254859 Best vali loss: 0.5254859
	iters: 100, epoch: 7 | loss: 0.4780125
	speed: 0.0092s/iter; left time: 1.3584s
Updating learning rate to 6.7098313514283586e-06
Epoch: 7 cost time: 0.7231738567352295
Epoch: 7, Steps: 123 | Train Loss: 0.4780125 Vali Loss: 0.5259243 Best vali loss: 0.5254859
	iters: 100, epoch: 8 | loss: 0.5513102
	speed: 0.0090s/iter; left time: 0.2150s
Updating learning rate to 0.0
Validation loss decreased (0.5255 --> 0.5230).  Saving model state dict ...
Epoch: 8 cost time: 0.7164113521575928
Epoch: 8, Steps: 123 | Train Loss: 0.5513102 Vali Loss: 0.5229710 Best vali loss: 0.5229710

best validation loss 0.5229709554137812

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043931775366, 'e_layers': 2, 'learning_rate': 0.0001749328436, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7615598
	speed: 0.0118s/iter; left time: 10.4566s
Updating learning rate to 0.00016827485868301903
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0392229557037354
Epoch: 1, Steps: 123 | Train Loss: 0.7615598 Vali Loss: 0.6075084 Best vali loss: 0.6075084
	iters: 100, epoch: 2 | loss: 0.9366488
	speed: 0.0093s/iter; left time: 7.1032s
Updating learning rate to 0.00014931452178090288
Validation loss decreased (0.6075 --> 0.5715).  Saving model state dict ...
Epoch: 2 cost time: 0.7199201583862305
Epoch: 2, Steps: 123 | Train Loss: 0.9366488 Vali Loss: 0.5715187 Best vali loss: 0.5715187
	iters: 100, epoch: 3 | loss: 0.8590599
	speed: 0.0093s/iter; left time: 5.9299s
Updating learning rate to 0.00012093837231111672
Validation loss decreased (0.5715 --> 0.5520).  Saving model state dict ...
Epoch: 3 cost time: 0.7230865955352783
Epoch: 3, Steps: 123 | Train Loss: 0.8590599 Vali Loss: 0.5520120 Best vali loss: 0.5520120
	iters: 100, epoch: 4 | loss: 0.5011672
	speed: 0.0092s/iter; left time: 4.7708s
Updating learning rate to 8.74664218e-05
Validation loss decreased (0.5520 --> 0.5400).  Saving model state dict ...
Epoch: 4 cost time: 0.7195804119110107
Epoch: 4, Steps: 123 | Train Loss: 0.5011672 Vali Loss: 0.5400498 Best vali loss: 0.5400498
	iters: 100, epoch: 5 | loss: 0.5715897
	speed: 0.0093s/iter; left time: 3.6382s
Updating learning rate to 5.399447128888329e-05
Validation loss decreased (0.5400 --> 0.5306).  Saving model state dict ...
Epoch: 5 cost time: 0.7275848388671875
Epoch: 5, Steps: 123 | Train Loss: 0.5715897 Vali Loss: 0.5305850 Best vali loss: 0.5305850
	iters: 100, epoch: 6 | loss: 0.6160713
	speed: 0.0095s/iter; left time: 2.5607s
Updating learning rate to 2.5618321819097136e-05
Validation loss decreased (0.5306 --> 0.5299).  Saving model state dict ...
Epoch: 6 cost time: 0.7335200309753418
Epoch: 6, Steps: 123 | Train Loss: 0.6160713 Vali Loss: 0.5299053 Best vali loss: 0.5299053
	iters: 100, epoch: 7 | loss: 0.5847074
	speed: 0.0093s/iter; left time: 1.3650s
Updating learning rate to 6.657984916980981e-06
Validation loss decreased (0.5299 --> 0.5272).  Saving model state dict ...
Epoch: 7 cost time: 0.7237818241119385
Epoch: 7, Steps: 123 | Train Loss: 0.5847074 Vali Loss: 0.5271833 Best vali loss: 0.5271833
	iters: 100, epoch: 8 | loss: 0.7395974
	speed: 0.0093s/iter; left time: 0.2241s
Updating learning rate to 0.0
Validation loss decreased (0.5272 --> 0.5263).  Saving model state dict ...
Epoch: 8 cost time: 0.7325484752655029
Epoch: 8, Steps: 123 | Train Loss: 0.7395974 Vali Loss: 0.5263354 Best vali loss: 0.5263354

best validation loss 0.5263354386487861

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043935043026, 'e_layers': 2, 'learning_rate': 0.0001758432838, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616869
	speed: 0.0120s/iter; left time: 10.5766s
Updating learning rate to 0.00016915064731619676
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0411114692687988
Epoch: 1, Steps: 123 | Train Loss: 0.7616869 Vali Loss: 0.6075472 Best vali loss: 0.6075472
	iters: 100, epoch: 2 | loss: 0.9363132
	speed: 0.0093s/iter; left time: 7.1196s
Updating learning rate to 0.0001500916311005453
Validation loss decreased (0.6075 --> 0.5720).  Saving model state dict ...
Epoch: 2 cost time: 0.7364566326141357
Epoch: 2, Steps: 123 | Train Loss: 0.9363132 Vali Loss: 0.5719530 Best vali loss: 0.5719530
	iters: 100, epoch: 3 | loss: 0.8560445
	speed: 0.0096s/iter; left time: 6.1073s
Updating learning rate to 0.0001215677976014663
Validation loss decreased (0.5720 --> 0.5411).  Saving model state dict ...
Epoch: 3 cost time: 0.740034818649292
Epoch: 3, Steps: 123 | Train Loss: 0.8560445 Vali Loss: 0.5411292 Best vali loss: 0.5411292
	iters: 100, epoch: 4 | loss: 0.4978424
	speed: 0.0095s/iter; left time: 4.9242s
Updating learning rate to 8.79216419e-05
Validation loss decreased (0.5411 --> 0.5293).  Saving model state dict ...
Epoch: 4 cost time: 0.7230315208435059
Epoch: 4, Steps: 123 | Train Loss: 0.4978424 Vali Loss: 0.5293273 Best vali loss: 0.5293273
	iters: 100, epoch: 5 | loss: 0.5720338
	speed: 0.0093s/iter; left time: 3.6738s
Updating learning rate to 5.4275486198533715e-05
Validation loss decreased (0.5293 --> 0.5268).  Saving model state dict ...
Epoch: 5 cost time: 0.7272448539733887
Epoch: 5, Steps: 123 | Train Loss: 0.5720338 Vali Loss: 0.5268202 Best vali loss: 0.5268202
	iters: 100, epoch: 6 | loss: 0.6244794
	speed: 0.0094s/iter; left time: 2.5350s
Updating learning rate to 2.5751652699454717e-05
Epoch: 6 cost time: 0.7320358753204346
Epoch: 6, Steps: 123 | Train Loss: 0.6244794 Vali Loss: 0.5307618 Best vali loss: 0.5268202
	iters: 100, epoch: 7 | loss: 0.5758423
	speed: 0.0091s/iter; left time: 1.3397s
Updating learning rate to 6.69263648380324e-06
Validation loss decreased (0.5268 --> 0.5243).  Saving model state dict ...
Epoch: 7 cost time: 0.7277042865753174
Epoch: 7, Steps: 123 | Train Loss: 0.5758423 Vali Loss: 0.5242687 Best vali loss: 0.5242687
	iters: 100, epoch: 8 | loss: 0.7427868
	speed: 0.0095s/iter; left time: 0.2274s
Updating learning rate to 0.0
Validation loss decreased (0.5243 --> 0.5234).  Saving model state dict ...
Epoch: 8 cost time: 0.736372709274292
Epoch: 8, Steps: 123 | Train Loss: 0.7427868 Vali Loss: 0.5233632 Best vali loss: 0.5233632

best validation loss 0.5233632339641265

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043953689742, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616900
	speed: 0.0119s/iter; left time: 10.5074s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0297911167144775
Epoch: 1, Steps: 123 | Train Loss: 0.7616900 Vali Loss: 0.6075478 Best vali loss: 0.6075478
	iters: 100, epoch: 2 | loss: 0.9372789
	speed: 0.0093s/iter; left time: 7.0625s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6075 --> 0.5725).  Saving model state dict ...
Epoch: 2 cost time: 0.7254717350006104
Epoch: 2, Steps: 123 | Train Loss: 0.9372789 Vali Loss: 0.5725287 Best vali loss: 0.5725287
	iters: 100, epoch: 3 | loss: 0.8556064
	speed: 0.0093s/iter; left time: 5.9728s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5725 --> 0.5477).  Saving model state dict ...
Epoch: 3 cost time: 0.733471155166626
Epoch: 3, Steps: 123 | Train Loss: 0.8556064 Vali Loss: 0.5476674 Best vali loss: 0.5476674

best validation loss 0.5476673791828888

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044056862492, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617131
	speed: 0.0119s/iter; left time: 10.5029s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.045231580734253
Epoch: 1, Steps: 123 | Train Loss: 0.7617131 Vali Loss: 0.6075571 Best vali loss: 0.6075571
	iters: 100, epoch: 2 | loss: 0.9367505
	speed: 0.0094s/iter; left time: 7.1416s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5731).  Saving model state dict ...
Epoch: 2 cost time: 0.7257554531097412
Epoch: 2, Steps: 123 | Train Loss: 0.9367505 Vali Loss: 0.5730529 Best vali loss: 0.5730529
	iters: 100, epoch: 3 | loss: 0.8580090
	speed: 0.0095s/iter; left time: 6.0803s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5731 --> 0.5526).  Saving model state dict ...
Epoch: 3 cost time: 0.7271442413330078
Epoch: 3, Steps: 123 | Train Loss: 0.8580090 Vali Loss: 0.5526436 Best vali loss: 0.5526436

best validation loss 0.5526435818731757

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0009281507612, 'e_layers': 1, 'learning_rate': 0.0017721427386, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4024819
	speed: 0.0090s/iter; left time: 69.6272s
	iters: 200, epoch: 1 | loss: 0.4732345
	speed: 0.0026s/iter; left time: 19.5391s
	iters: 300, epoch: 1 | loss: 0.5857510
	speed: 0.0025s/iter; left time: 19.1664s
	iters: 400, epoch: 1 | loss: 0.4432279
	speed: 0.0026s/iter; left time: 19.3372s
	iters: 500, epoch: 1 | loss: 0.4610924
	speed: 0.0026s/iter; left time: 18.8859s
	iters: 600, epoch: 1 | loss: 0.2504354
	speed: 0.0026s/iter; left time: 18.4943s
	iters: 700, epoch: 1 | loss: 1.0848795
	speed: 0.0026s/iter; left time: 18.3343s
	iters: 800, epoch: 1 | loss: 1.7537354
	speed: 0.0025s/iter; left time: 17.5859s
	iters: 900, epoch: 1 | loss: 0.7776309
	speed: 0.0025s/iter; left time: 17.4651s
Updating learning rate to 0.0017046945717405196
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 2.858696937561035
Epoch: 1, Steps: 979 | Train Loss: 0.6924966 Vali Loss: 0.6097721 Best vali loss: 0.6097721
	iters: 100, epoch: 2 | loss: 0.6279376
	speed: 0.0095s/iter; left time: 63.8469s
	iters: 200, epoch: 2 | loss: 0.9417421
	speed: 0.0025s/iter; left time: 16.9447s
	iters: 300, epoch: 2 | loss: 0.4566899
	speed: 0.0025s/iter; left time: 16.2700s
	iters: 400, epoch: 2 | loss: 0.9321392
	speed: 0.0024s/iter; left time: 15.7087s
	iters: 500, epoch: 2 | loss: 0.9579519
	speed: 0.0024s/iter; left time: 15.5121s
	iters: 600, epoch: 2 | loss: 0.8696382
	speed: 0.0026s/iter; left time: 15.9755s
	iters: 700, epoch: 2 | loss: 1.1063594
	speed: 0.0025s/iter; left time: 15.3267s
	iters: 800, epoch: 2 | loss: 1.0395250
	speed: 0.0023s/iter; left time: 14.1597s
	iters: 900, epoch: 2 | loss: 0.6067633
	speed: 0.0023s/iter; left time: 13.8916s
Updating learning rate to 0.0015126184431472796
Epoch: 2 cost time: 2.449432373046875
Epoch: 2, Steps: 979 | Train Loss: 0.8376385 Vali Loss: 0.6541518 Best vali loss: 0.6097721
	iters: 100, epoch: 3 | loss: 0.4960806
	speed: 0.0091s/iter; left time: 52.7480s
	iters: 200, epoch: 3 | loss: 0.5971857
	speed: 0.0024s/iter; left time: 13.5790s
	iters: 300, epoch: 3 | loss: 0.7817513
	speed: 0.0024s/iter; left time: 13.1753s
	iters: 400, epoch: 3 | loss: 0.5712026
	speed: 0.0023s/iter; left time: 12.6280s
	iters: 500, epoch: 3 | loss: 1.4016097
	speed: 0.0023s/iter; left time: 12.3275s
	iters: 600, epoch: 3 | loss: 0.4531489
	speed: 0.0023s/iter; left time: 12.1309s
	iters: 700, epoch: 3 | loss: 0.4216208
	speed: 0.0023s/iter; left time: 12.1472s
	iters: 800, epoch: 3 | loss: 0.5167685
	speed: 0.0023s/iter; left time: 11.7042s
	iters: 900, epoch: 3 | loss: 0.7381803
	speed: 0.0023s/iter; left time: 11.5113s
Updating learning rate to 0.001225156202224159
Validation loss decreased (0.6098 --> 0.6004).  Saving model state dict ...
Epoch: 3 cost time: 2.335330009460449
Epoch: 3, Steps: 979 | Train Loss: 0.6641721 Vali Loss: 0.6004066 Best vali loss: 0.6004066

best validation loss 0.6004065767806308

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043953689742, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6003810
	speed: 0.0119s/iter; left time: 6.1622s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5477 --> 0.5343).  Saving model state dict ...
Epoch: 4 cost time: 1.019479513168335
Epoch: 4, Steps: 123 | Train Loss: 0.6003810 Vali Loss: 0.5343242 Best vali loss: 0.5343242
	iters: 100, epoch: 5 | loss: 0.8464184
	speed: 0.0095s/iter; left time: 3.7204s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5343 --> 0.5308).  Saving model state dict ...
Epoch: 5 cost time: 0.7273087501525879
Epoch: 5, Steps: 123 | Train Loss: 0.8464184 Vali Loss: 0.5307962 Best vali loss: 0.5307962
	iters: 100, epoch: 6 | loss: 0.8058050
	speed: 0.0093s/iter; left time: 2.5090s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5308 --> 0.5278).  Saving model state dict ...
Epoch: 6 cost time: 0.7191605567932129
Epoch: 6, Steps: 123 | Train Loss: 0.8058050 Vali Loss: 0.5278299 Best vali loss: 0.5278299
	iters: 100, epoch: 7 | loss: 0.4784294
	speed: 0.0093s/iter; left time: 1.3687s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.7261459827423096
Epoch: 7, Steps: 123 | Train Loss: 0.4784294 Vali Loss: 0.5293362 Best vali loss: 0.5278299
	iters: 100, epoch: 8 | loss: 0.5522646
	speed: 0.0091s/iter; left time: 0.2179s
Updating learning rate to 0.0
Validation loss decreased (0.5278 --> 0.5249).  Saving model state dict ...
Epoch: 8 cost time: 0.7220075130462646
Epoch: 8, Steps: 123 | Train Loss: 0.5522646 Vali Loss: 0.5249499 Best vali loss: 0.5249499

best validation loss 0.5249498722896373

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044071791311, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617106
	speed: 0.0118s/iter; left time: 10.4072s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0223586559295654
Epoch: 1, Steps: 123 | Train Loss: 0.7617106 Vali Loss: 0.6075526 Best vali loss: 0.6075526
	iters: 100, epoch: 2 | loss: 0.9356009
	speed: 0.0093s/iter; left time: 7.0887s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5705).  Saving model state dict ...
Epoch: 2 cost time: 0.7254452705383301
Epoch: 2, Steps: 123 | Train Loss: 0.9356009 Vali Loss: 0.5704926 Best vali loss: 0.5704926
	iters: 100, epoch: 3 | loss: 0.8536571
	speed: 0.0093s/iter; left time: 5.9668s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5705 --> 0.5461).  Saving model state dict ...
Epoch: 3 cost time: 0.7172574996948242
Epoch: 3, Steps: 123 | Train Loss: 0.8536571 Vali Loss: 0.5460919 Best vali loss: 0.5460919
	iters: 100, epoch: 4 | loss: 0.4995095
	speed: 0.0092s/iter; left time: 4.7582s
Updating learning rate to 8.79186073e-05
Epoch: 4 cost time: 0.7180640697479248
Epoch: 4, Steps: 123 | Train Loss: 0.4995095 Vali Loss: 0.5493956 Best vali loss: 0.5460919
	iters: 100, epoch: 5 | loss: 0.5757124
	speed: 0.0091s/iter; left time: 3.5579s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5461 --> 0.5320).  Saving model state dict ...
Epoch: 5 cost time: 0.7262351512908936
Epoch: 5, Steps: 123 | Train Loss: 0.5757124 Vali Loss: 0.5319610 Best vali loss: 0.5319610
	iters: 100, epoch: 6 | loss: 0.6208543
	speed: 0.0095s/iter; left time: 2.5592s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5320 --> 0.5312).  Saving model state dict ...
Epoch: 6 cost time: 0.7262892723083496
Epoch: 6, Steps: 123 | Train Loss: 0.6208543 Vali Loss: 0.5312163 Best vali loss: 0.5312163
	iters: 100, epoch: 7 | loss: 0.5801249
	speed: 0.0095s/iter; left time: 1.3932s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5312 --> 0.5281).  Saving model state dict ...
Epoch: 7 cost time: 0.7356085777282715
Epoch: 7, Steps: 123 | Train Loss: 0.5801249 Vali Loss: 0.5281475 Best vali loss: 0.5281475
	iters: 100, epoch: 8 | loss: 0.7413222
	speed: 0.0094s/iter; left time: 0.2263s
Updating learning rate to 0.0
Validation loss decreased (0.5281 --> 0.5272).  Saving model state dict ...
Epoch: 8 cost time: 0.724278450012207
Epoch: 8, Steps: 123 | Train Loss: 0.7413222 Vali Loss: 0.5272151 Best vali loss: 0.5272151

best validation loss 0.5272150984079624

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010495067178, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745778
	speed: 0.0119s/iter; left time: 10.5430s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0396654605865479
Epoch: 1, Steps: 123 | Train Loss: 0.7745778 Vali Loss: 0.6172955 Best vali loss: 0.6172955
	iters: 100, epoch: 2 | loss: 0.9494799
	speed: 0.0093s/iter; left time: 7.0829s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5536).  Saving model state dict ...
Epoch: 2 cost time: 0.7301485538482666
Epoch: 2, Steps: 123 | Train Loss: 0.9494799 Vali Loss: 0.5536315 Best vali loss: 0.5536315
	iters: 100, epoch: 3 | loss: 0.8490741
	speed: 0.0094s/iter; left time: 5.9987s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5536 --> 0.5425).  Saving model state dict ...
Epoch: 3 cost time: 0.7210614681243896
Epoch: 3, Steps: 123 | Train Loss: 0.8490741 Vali Loss: 0.5424772 Best vali loss: 0.5424772
	iters: 100, epoch: 4 | loss: 0.4877937
	speed: 0.0095s/iter; left time: 4.8858s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5425 --> 0.5419).  Saving model state dict ...
Epoch: 4 cost time: 0.7300782203674316
Epoch: 4, Steps: 123 | Train Loss: 0.4877937 Vali Loss: 0.5418817 Best vali loss: 0.5418817
	iters: 100, epoch: 5 | loss: 0.5608877
	speed: 0.0095s/iter; left time: 3.7311s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5419 --> 0.5249).  Saving model state dict ...
Epoch: 5 cost time: 0.7374997138977051
Epoch: 5, Steps: 123 | Train Loss: 0.5608877 Vali Loss: 0.5248684 Best vali loss: 0.5248684
	iters: 100, epoch: 6 | loss: 0.5850490
	speed: 0.0095s/iter; left time: 2.5657s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7389519214630127
Epoch: 6, Steps: 123 | Train Loss: 0.5850490 Vali Loss: 0.5356384 Best vali loss: 0.5248684
	iters: 100, epoch: 7 | loss: 0.5446326
	speed: 0.0091s/iter; left time: 1.3441s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7283775806427002
Epoch: 7, Steps: 123 | Train Loss: 0.5446326 Vali Loss: 0.5358956 Best vali loss: 0.5248684
	iters: 100, epoch: 8 | loss: 0.7001122
	speed: 0.0090s/iter; left time: 0.2157s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7199680805206299
Epoch: 8, Steps: 123 | Train Loss: 0.7001122 Vali Loss: 0.5428073 Best vali loss: 0.5248684

best validation loss 0.5248683750326023

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010487986976, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745502
	speed: 0.0118s/iter; left time: 10.4535s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0287222862243652
Epoch: 1, Steps: 123 | Train Loss: 0.7745502 Vali Loss: 0.6172630 Best vali loss: 0.6172630
	iters: 100, epoch: 2 | loss: 0.9471647
	speed: 0.0093s/iter; left time: 7.0713s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.6160).  Saving model state dict ...
Epoch: 2 cost time: 0.7263717651367188
Epoch: 2, Steps: 123 | Train Loss: 0.9471647 Vali Loss: 0.6159786 Best vali loss: 0.6159786
	iters: 100, epoch: 3 | loss: 0.8499228
	speed: 0.0092s/iter; left time: 5.9083s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.6160 --> 0.5480).  Saving model state dict ...
Epoch: 3 cost time: 0.7232933044433594
Epoch: 3, Steps: 123 | Train Loss: 0.8499228 Vali Loss: 0.5479835 Best vali loss: 0.5479835

best validation loss 0.5479835062212328

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.000937833068, 'e_layers': 2, 'learning_rate': 5.01092253e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.820205647233337e-05
Validation loss decreased (inf --> 0.6213).  Saving model state dict ...
Epoch: 1 cost time: 0.9037573337554932
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6213026 Best vali loss: 0.6213026
Updating learning rate to 4.277089915481726e-05
Validation loss decreased (0.6213 --> 0.6046).  Saving model state dict ...
Epoch: 2 cost time: 0.6152405738830566
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6045767 Best vali loss: 0.6045767
Updating learning rate to 3.46425978154798e-05
Validation loss decreased (0.6046 --> 0.6013).  Saving model state dict ...
Epoch: 3 cost time: 0.6181316375732422
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6012583 Best vali loss: 0.6012583

best validation loss 0.6012583264097578

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001150642175, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7524608
	speed: 0.0117s/iter; left time: 10.3577s
Updating learning rate to 0.00011068484648633852
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 1.021312952041626
Epoch: 1, Steps: 123 | Train Loss: 0.7524608 Vali Loss: 0.6023342 Best vali loss: 0.6023342
	iters: 100, epoch: 2 | loss: 0.9468455
	speed: 0.0092s/iter; left time: 7.0310s
Updating learning rate to 9.82134529830869e-05
Epoch: 2 cost time: 0.7260313034057617
Epoch: 2, Steps: 123 | Train Loss: 0.9468455 Vali Loss: 0.6050827 Best vali loss: 0.6023342
	iters: 100, epoch: 3 | loss: 0.8717331
	speed: 0.0092s/iter; left time: 5.8474s
Updating learning rate to 7.954869359765162e-05
Validation loss decreased (0.6023 --> 0.5695).  Saving model state dict ...
Epoch: 3 cost time: 0.7291409969329834
Epoch: 3, Steps: 123 | Train Loss: 0.8717331 Vali Loss: 0.5694728 Best vali loss: 0.5694728

best validation loss 0.5694728081339987

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010487986976, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5881269
	speed: 0.0122s/iter; left time: 6.2837s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5480 --> 0.5302).  Saving model state dict ...
Epoch: 4 cost time: 1.0444555282592773
Epoch: 4, Steps: 123 | Train Loss: 0.5881269 Vali Loss: 0.5302119 Best vali loss: 0.5302119
	iters: 100, epoch: 5 | loss: 0.8223592
	speed: 0.0092s/iter; left time: 3.6179s
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 0.7139022350311279
Epoch: 5, Steps: 123 | Train Loss: 0.8223592 Vali Loss: 0.5313155 Best vali loss: 0.5302119
	iters: 100, epoch: 6 | loss: 0.7625450
	speed: 0.0091s/iter; left time: 2.4652s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7292914390563965
Epoch: 6, Steps: 123 | Train Loss: 0.7625450 Vali Loss: 0.5332702 Best vali loss: 0.5302119
	iters: 100, epoch: 7 | loss: 0.4367789
	speed: 0.0091s/iter; left time: 1.3444s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7264611721038818
Epoch: 7, Steps: 123 | Train Loss: 0.4367789 Vali Loss: 0.5450510 Best vali loss: 0.5302119
	iters: 100, epoch: 8 | loss: 0.5099781
	speed: 0.0090s/iter; left time: 0.2171s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7294595241546631
Epoch: 8, Steps: 123 | Train Loss: 0.5099781 Vali Loss: 0.5425054 Best vali loss: 0.5302119

best validation loss 0.530211869046292

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 3, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6235158
	speed: 0.0139s/iter; left time: 12.3274s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5939).  Saving model state dict ...
Epoch: 1 cost time: 1.3093147277832031
Epoch: 1, Steps: 123 | Train Loss: 0.6235158 Vali Loss: 0.5939000 Best vali loss: 0.5939000
	iters: 100, epoch: 2 | loss: 0.7121657
	speed: 0.0123s/iter; left time: 9.3999s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.5939 --> 0.5666).  Saving model state dict ...
Epoch: 2 cost time: 1.0020217895507812
Epoch: 2, Steps: 123 | Train Loss: 0.7121657 Vali Loss: 0.5666335 Best vali loss: 0.5666335
	iters: 100, epoch: 3 | loss: 0.6397327
	speed: 0.0127s/iter; left time: 8.1338s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5666 --> 0.5514).  Saving model state dict ...
Epoch: 3 cost time: 1.01442289352417
Epoch: 3, Steps: 123 | Train Loss: 0.6397327 Vali Loss: 0.5514500 Best vali loss: 0.5514500
	iters: 100, epoch: 4 | loss: 0.8466547
	speed: 0.0127s/iter; left time: 6.5288s
Updating learning rate to 8.79186073e-05
Epoch: 4 cost time: 1.009866714477539
Epoch: 4, Steps: 123 | Train Loss: 0.8466547 Vali Loss: 0.5527631 Best vali loss: 0.5514500
	iters: 100, epoch: 5 | loss: 0.6839207
	speed: 0.0121s/iter; left time: 4.7624s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5514 --> 0.5377).  Saving model state dict ...
Epoch: 5 cost time: 1.0010888576507568
Epoch: 5, Steps: 123 | Train Loss: 0.6839207 Vali Loss: 0.5376847 Best vali loss: 0.5376847
	iters: 100, epoch: 6 | loss: 0.4481794
	speed: 0.0125s/iter; left time: 3.3777s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 1.0016789436340332
Epoch: 6, Steps: 123 | Train Loss: 0.4481794 Vali Loss: 0.5389171 Best vali loss: 0.5376847
	iters: 100, epoch: 7 | loss: 0.8076993
	speed: 0.0122s/iter; left time: 1.7888s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5377 --> 0.5365).  Saving model state dict ...
Epoch: 7 cost time: 1.0078444480895996
Epoch: 7, Steps: 123 | Train Loss: 0.8076993 Vali Loss: 0.5365313 Best vali loss: 0.5365313
	iters: 100, epoch: 8 | loss: 0.7072241
	speed: 0.0126s/iter; left time: 0.3013s
Updating learning rate to 0.0
Validation loss decreased (0.5365 --> 0.5347).  Saving model state dict ...
Epoch: 8 cost time: 1.0047168731689453
Epoch: 8, Steps: 123 | Train Loss: 0.7072241 Vali Loss: 0.5347149 Best vali loss: 0.5347149

best validation loss 0.534714903835895

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042695685271, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616305
	speed: 0.0116s/iter; left time: 10.3100s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0279572010040283
Epoch: 1, Steps: 123 | Train Loss: 0.7616305 Vali Loss: 0.6075543 Best vali loss: 0.6075543
	iters: 100, epoch: 2 | loss: 0.9375358
	speed: 0.0093s/iter; left time: 7.0636s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5736).  Saving model state dict ...
Epoch: 2 cost time: 0.7253062725067139
Epoch: 2, Steps: 123 | Train Loss: 0.9375358 Vali Loss: 0.5735877 Best vali loss: 0.5735877
	iters: 100, epoch: 3 | loss: 0.8621381
	speed: 0.0094s/iter; left time: 6.0371s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5736 --> 0.5505).  Saving model state dict ...
Epoch: 3 cost time: 0.7327613830566406
Epoch: 3, Steps: 123 | Train Loss: 0.8621381 Vali Loss: 0.5504661 Best vali loss: 0.5504661
	iters: 100, epoch: 4 | loss: 0.4972365
	speed: 0.0094s/iter; left time: 4.8407s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5505 --> 0.5371).  Saving model state dict ...
Epoch: 4 cost time: 0.7263615131378174
Epoch: 4, Steps: 123 | Train Loss: 0.4972365 Vali Loss: 0.5371485 Best vali loss: 0.5371485
	iters: 100, epoch: 5 | loss: 0.5750858
	speed: 0.0094s/iter; left time: 3.6949s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5371 --> 0.5332).  Saving model state dict ...
Epoch: 5 cost time: 0.7293620109558105
Epoch: 5, Steps: 123 | Train Loss: 0.5750858 Vali Loss: 0.5332323 Best vali loss: 0.5332323
	iters: 100, epoch: 6 | loss: 0.6164734
	speed: 0.0095s/iter; left time: 2.5641s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5332 --> 0.5318).  Saving model state dict ...
Epoch: 6 cost time: 0.729562520980835
Epoch: 6, Steps: 123 | Train Loss: 0.6164734 Vali Loss: 0.5317799 Best vali loss: 0.5317799
	iters: 100, epoch: 7 | loss: 0.5806394
	speed: 0.0095s/iter; left time: 1.3957s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5318 --> 0.5278).  Saving model state dict ...
Epoch: 7 cost time: 0.7354214191436768
Epoch: 7, Steps: 123 | Train Loss: 0.5806394 Vali Loss: 0.5277716 Best vali loss: 0.5277716
	iters: 100, epoch: 8 | loss: 0.7421914
	speed: 0.0094s/iter; left time: 0.2263s
Updating learning rate to 0.0
Validation loss decreased (0.5278 --> 0.5260).  Saving model state dict ...
Epoch: 8 cost time: 0.7308609485626221
Epoch: 8, Steps: 123 | Train Loss: 0.7421914 Vali Loss: 0.5259804 Best vali loss: 0.5259804

best validation loss 0.5259804454654082

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010521650253, 'e_layers': 3, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6184830
	speed: 0.0139s/iter; left time: 12.3038s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 1.3052220344543457
Epoch: 1, Steps: 123 | Train Loss: 0.6184830 Vali Loss: 0.6156900 Best vali loss: 0.6156900
	iters: 100, epoch: 2 | loss: 0.7405718
	speed: 0.0123s/iter; left time: 9.3600s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6157 --> 0.5595).  Saving model state dict ...
Epoch: 2 cost time: 1.003204107284546
Epoch: 2, Steps: 123 | Train Loss: 0.7405718 Vali Loss: 0.5594924 Best vali loss: 0.5594924
	iters: 100, epoch: 3 | loss: 0.6369345
	speed: 0.0126s/iter; left time: 8.0449s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5595 --> 0.5517).  Saving model state dict ...
Epoch: 3 cost time: 1.0046589374542236
Epoch: 3, Steps: 123 | Train Loss: 0.6369345 Vali Loss: 0.5517415 Best vali loss: 0.5517415

best validation loss 0.5517414592858102

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6185610
	speed: 0.0140s/iter; left time: 12.3579s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 1.302079677581787
Epoch: 1, Steps: 123 | Train Loss: 0.6185610 Vali Loss: 0.6156297 Best vali loss: 0.6156297
	iters: 100, epoch: 2 | loss: 0.7327351
	speed: 0.0123s/iter; left time: 9.3571s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6156 --> 0.5506).  Saving model state dict ...
Epoch: 2 cost time: 0.9988441467285156
Epoch: 2, Steps: 123 | Train Loss: 0.7327351 Vali Loss: 0.5505654 Best vali loss: 0.5505654
	iters: 100, epoch: 3 | loss: 0.6352561
	speed: 0.0126s/iter; left time: 8.0695s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5506 --> 0.5352).  Saving model state dict ...
Epoch: 3 cost time: 1.0075633525848389
Epoch: 3, Steps: 123 | Train Loss: 0.6352561 Vali Loss: 0.5352190 Best vali loss: 0.5352190

best validation loss 0.5352189706630698

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010743902634, 'e_layers': 3, 'learning_rate': 5.62684488e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.412685848623964e-05
Validation loss decreased (inf --> 0.6458).  Saving model state dict ...
Epoch: 1 cost time: 0.7905831336975098
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6458322 Best vali loss: 0.6458322
Updating learning rate to 4.8028125256664024e-05
Validation loss decreased (0.6458 --> 0.6207).  Saving model state dict ...
Epoch: 2 cost time: 0.48362135887145996
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6206936 Best vali loss: 0.6206936
Updating learning rate to 3.890072596032166e-05
Validation loss decreased (0.6207 --> 0.6099).  Saving model state dict ...
Epoch: 3 cost time: 0.48773908615112305
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6099362 Best vali loss: 0.6099362

best validation loss 0.6099362399830746

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5298876
	speed: 0.0145s/iter; left time: 7.4621s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 1.3087542057037354
Epoch: 4, Steps: 123 | Train Loss: 0.5298876 Vali Loss: 0.5361952 Best vali loss: 0.5352190
	iters: 100, epoch: 5 | loss: 0.6291969
	speed: 0.0120s/iter; left time: 4.7214s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5352 --> 0.5346).  Saving model state dict ...
Epoch: 5 cost time: 1.0056629180908203
Epoch: 5, Steps: 123 | Train Loss: 0.6291969 Vali Loss: 0.5346127 Best vali loss: 0.5346127
	iters: 100, epoch: 6 | loss: 0.5526941
	speed: 0.0126s/iter; left time: 3.3999s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 1.0086324214935303
Epoch: 6, Steps: 123 | Train Loss: 0.5526941 Vali Loss: 0.5402666 Best vali loss: 0.5346127
	iters: 100, epoch: 7 | loss: 0.7544724
	speed: 0.0122s/iter; left time: 1.7886s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 1.0068919658660889
Epoch: 7, Steps: 123 | Train Loss: 0.7544724 Vali Loss: 0.5576413 Best vali loss: 0.5346127
	iters: 100, epoch: 8 | loss: 0.6120418
	speed: 0.0121s/iter; left time: 0.2894s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.000363826751709
Epoch: 8, Steps: 123 | Train Loss: 0.6120418 Vali Loss: 0.5657325 Best vali loss: 0.5346127

best validation loss 0.5346126985571993

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021090900333, 'e_layers': 3, 'learning_rate': 0.0006300402232, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6506749
	speed: 0.0139s/iter; left time: 12.3305s
Updating learning rate to 0.0006300402232
Validation loss decreased (inf --> 0.6214).  Saving model state dict ...
Epoch: 1 cost time: 1.2976877689361572
Epoch: 1, Steps: 123 | Train Loss: 0.6506749 Vali Loss: 0.6214477 Best vali loss: 0.6214477
	iters: 100, epoch: 2 | loss: 0.8310357
	speed: 0.0125s/iter; left time: 9.5155s
Updating learning rate to 0.0003150201116
Epoch: 2 cost time: 1.0066072940826416
Epoch: 2, Steps: 123 | Train Loss: 0.8310357 Vali Loss: 0.6757251 Best vali loss: 0.6214477
	iters: 100, epoch: 3 | loss: 0.7552726
	speed: 0.0120s/iter; left time: 7.6765s
Updating learning rate to 0.0001575100558
Epoch: 3 cost time: 1.004004955291748
Epoch: 3, Steps: 123 | Train Loss: 0.7552726 Vali Loss: 0.6422681 Best vali loss: 0.6214477
	iters: 100, epoch: 4 | loss: 0.9731284
	speed: 0.0121s/iter; left time: 6.2439s
Updating learning rate to 7.87550279e-05
Epoch: 4 cost time: 1.0047948360443115
Epoch: 4, Steps: 123 | Train Loss: 0.9731284 Vali Loss: 0.6406412 Best vali loss: 0.6214477
	iters: 100, epoch: 5 | loss: 0.8817828
	speed: 0.0121s/iter; left time: 4.7409s
Updating learning rate to 3.937751395e-05
Epoch: 5 cost time: 0.9996898174285889
Epoch: 5, Steps: 123 | Train Loss: 0.8817828 Vali Loss: 0.6374972 Best vali loss: 0.6214477
	iters: 100, epoch: 6 | loss: 0.5927681
	speed: 0.0121s/iter; left time: 3.2681s
Updating learning rate to 1.9688756975e-05
Epoch: 6 cost time: 1.0027499198913574
Epoch: 6, Steps: 123 | Train Loss: 0.5927681 Vali Loss: 0.6390257 Best vali loss: 0.6214477
	iters: 100, epoch: 7 | loss: 0.9826670
	speed: 0.0121s/iter; left time: 1.7723s
Updating learning rate to 9.8443784875e-06
Epoch: 7 cost time: 1.0024769306182861
Epoch: 7, Steps: 123 | Train Loss: 0.9826670 Vali Loss: 0.6368618 Best vali loss: 0.6214477
	iters: 100, epoch: 8 | loss: 0.9373692
	speed: 0.0121s/iter; left time: 0.2895s
Updating learning rate to 4.92218924375e-06
Epoch: 8 cost time: 1.0039379596710205
Epoch: 8, Steps: 123 | Train Loss: 0.9373692 Vali Loss: 0.6374370 Best vali loss: 0.6214477

best validation loss 0.6214477323592122

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023579741829, 'e_layers': 3, 'learning_rate': 0.0004665575931, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6154296
	speed: 0.0139s/iter; left time: 12.3252s
Updating learning rate to 0.0004665575931
Validation loss decreased (inf --> 0.6106).  Saving model state dict ...
Epoch: 1 cost time: 1.299853801727295
Epoch: 1, Steps: 123 | Train Loss: 0.6154296 Vali Loss: 0.6106350 Best vali loss: 0.6106350
	iters: 100, epoch: 2 | loss: 0.7697737
	speed: 0.0123s/iter; left time: 9.3557s
Updating learning rate to 0.00023327879655
Epoch: 2 cost time: 1.0028133392333984
Epoch: 2, Steps: 123 | Train Loss: 0.7697737 Vali Loss: 0.6321504 Best vali loss: 0.6106350
	iters: 100, epoch: 3 | loss: 0.6805710
	speed: 0.0120s/iter; left time: 7.6787s
Updating learning rate to 0.000116639398275
Epoch: 3 cost time: 0.9990663528442383
Epoch: 3, Steps: 123 | Train Loss: 0.6805710 Vali Loss: 0.6151837 Best vali loss: 0.6106350
	iters: 100, epoch: 4 | loss: 0.9241623
	speed: 0.0119s/iter; left time: 6.1603s
Updating learning rate to 5.83196991375e-05
Epoch: 4 cost time: 0.9929025173187256
Epoch: 4, Steps: 123 | Train Loss: 0.9241623 Vali Loss: 0.6511786 Best vali loss: 0.6106350
	iters: 100, epoch: 5 | loss: 0.7583712
	speed: 0.0121s/iter; left time: 4.7390s
Updating learning rate to 2.915984956875e-05
Epoch: 5 cost time: 1.006681203842163
Epoch: 5, Steps: 123 | Train Loss: 0.7583712 Vali Loss: 0.6266752 Best vali loss: 0.6106350
	iters: 100, epoch: 6 | loss: 0.4991081
	speed: 0.0122s/iter; left time: 3.2941s
Updating learning rate to 1.4579924784375e-05
Epoch: 6 cost time: 1.0184297561645508
Epoch: 6, Steps: 123 | Train Loss: 0.4991081 Vali Loss: 0.6283521 Best vali loss: 0.6106350
	iters: 100, epoch: 7 | loss: 0.8526015
	speed: 0.0121s/iter; left time: 1.7821s
Updating learning rate to 7.2899623921875e-06
Epoch: 7 cost time: 1.0005555152893066
Epoch: 7, Steps: 123 | Train Loss: 0.8526015 Vali Loss: 0.6208183 Best vali loss: 0.6106350
	iters: 100, epoch: 8 | loss: 0.7400825
	speed: 0.0120s/iter; left time: 0.2880s
Updating learning rate to 3.64498119609375e-06
Epoch: 8 cost time: 1.0005841255187988
Epoch: 8, Steps: 123 | Train Loss: 0.7400825 Vali Loss: 0.6209757 Best vali loss: 0.6106350

best validation loss 0.6106350214489077

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0029066887493, 'e_layers': 3, 'learning_rate': 0.0045471347367, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9557676
	speed: 0.0106s/iter; left time: 40.6539s
	iters: 200, epoch: 1 | loss: 0.6308039
	speed: 0.0042s/iter; left time: 15.6013s
	iters: 300, epoch: 1 | loss: 1.2006103
	speed: 0.0040s/iter; left time: 14.5837s
	iters: 400, epoch: 1 | loss: 0.5456568
	speed: 0.0043s/iter; left time: 15.1762s
Updating learning rate to 0.004374069725754114
Validation loss decreased (inf --> 0.6105).  Saving model state dict ...
Epoch: 1 cost time: 2.434845447540283
Epoch: 1, Steps: 490 | Train Loss: 0.8332097 Vali Loss: 0.6104756 Best vali loss: 0.6104756
	iters: 100, epoch: 2 | loss: 0.4545594
	speed: 0.0124s/iter; left time: 41.1815s
	iters: 200, epoch: 2 | loss: 1.4771301
	speed: 0.0046s/iter; left time: 14.7158s
	iters: 300, epoch: 2 | loss: 0.4693280
	speed: 0.0042s/iter; left time: 13.0540s
	iters: 400, epoch: 2 | loss: 0.3407371
	speed: 0.0041s/iter; left time: 12.5600s
Updating learning rate to 0.003881222271994738
Epoch: 2 cost time: 2.164748191833496
Epoch: 2, Steps: 490 | Train Loss: 0.6854386 Vali Loss: 0.6236404 Best vali loss: 0.6104756
	iters: 100, epoch: 3 | loss: 0.9860133
	speed: 0.0116s/iter; left time: 32.9535s
	iters: 200, epoch: 3 | loss: 0.7125623
	speed: 0.0042s/iter; left time: 11.4776s
	iters: 300, epoch: 3 | loss: 0.5908505
	speed: 0.0042s/iter; left time: 11.1322s
	iters: 400, epoch: 3 | loss: 1.0982965
	speed: 0.0041s/iter; left time: 10.3006s
Updating learning rate to 0.0031436239325834427
Epoch: 3 cost time: 2.0814738273620605
Epoch: 3, Steps: 490 | Train Loss: 0.8469307 Vali Loss: 0.6192823 Best vali loss: 0.6104756

best validation loss 0.6104756339950067

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758613431, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616889
	speed: 0.0120s/iter; left time: 10.5972s
Updating learning rate to 0.00016916801927501749
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0396831035614014
Epoch: 1, Steps: 123 | Train Loss: 0.7616889 Vali Loss: 0.6075523 Best vali loss: 0.6075523
	iters: 100, epoch: 2 | loss: 0.9371006
	speed: 0.0094s/iter; left time: 7.1772s
Updating learning rate to 0.00015010704567729202
Validation loss decreased (0.6076 --> 0.5721).  Saving model state dict ...
Epoch: 2 cost time: 0.729302167892456
Epoch: 2, Steps: 123 | Train Loss: 0.9371006 Vali Loss: 0.5720907 Best vali loss: 0.5720907
	iters: 100, epoch: 3 | loss: 0.8579695
	speed: 0.0092s/iter; left time: 5.8904s
Updating learning rate to 0.00012158028274892135
Validation loss decreased (0.5721 --> 0.5396).  Saving model state dict ...
Epoch: 3 cost time: 0.715782642364502
Epoch: 3, Steps: 123 | Train Loss: 0.8579695 Vali Loss: 0.5396471 Best vali loss: 0.5396471

best validation loss 0.5396471352060875

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0026127412855, 'e_layers': 3, 'learning_rate': 0.0046067646314, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7277018
	speed: 0.0108s/iter; left time: 41.1497s
	iters: 200, epoch: 1 | loss: 0.6914667
	speed: 0.0046s/iter; left time: 16.9486s
	iters: 300, epoch: 1 | loss: 1.1599257
	speed: 0.0043s/iter; left time: 15.5411s
	iters: 400, epoch: 1 | loss: 0.5609062
	speed: 0.0045s/iter; left time: 15.9128s
Updating learning rate to 0.0046067646314
Validation loss decreased (inf --> 0.6408).  Saving model state dict ...
Epoch: 1 cost time: 2.539384603500366
Epoch: 1, Steps: 490 | Train Loss: 0.7850001 Vali Loss: 0.6408014 Best vali loss: 0.6408014
	iters: 100, epoch: 2 | loss: 0.6292716
	speed: 0.0121s/iter; left time: 40.4568s
	iters: 200, epoch: 2 | loss: 0.6670707
	speed: 0.0046s/iter; left time: 14.9669s
	iters: 300, epoch: 2 | loss: 0.7604567
	speed: 0.0046s/iter; left time: 14.4973s
	iters: 400, epoch: 2 | loss: 0.6629257
	speed: 0.0047s/iter; left time: 14.1201s
Updating learning rate to 0.0023033823157
Validation loss decreased (0.6408 --> 0.6402).  Saving model state dict ...
Epoch: 2 cost time: 2.315992832183838
Epoch: 2, Steps: 490 | Train Loss: 0.6799312 Vali Loss: 0.6402075 Best vali loss: 0.6402075
	iters: 100, epoch: 3 | loss: 1.0335628
	speed: 0.0121s/iter; left time: 34.2997s
	iters: 200, epoch: 3 | loss: 1.1439987
	speed: 0.0043s/iter; left time: 11.7017s
	iters: 300, epoch: 3 | loss: 0.6420394
	speed: 0.0043s/iter; left time: 11.4709s
	iters: 400, epoch: 3 | loss: 1.5272471
	speed: 0.0042s/iter; left time: 10.7556s
Updating learning rate to 0.00115169115785
Epoch: 3 cost time: 2.1458778381347656
Epoch: 3, Steps: 490 | Train Loss: 1.0867120 Vali Loss: 0.6409837 Best vali loss: 0.6402075

best validation loss 0.6402074950870018

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758613431, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6012596
	speed: 0.0123s/iter; left time: 6.3250s
Updating learning rate to 8.793067155e-05
Validation loss decreased (0.5396 --> 0.5347).  Saving model state dict ...
Epoch: 4 cost time: 1.0405299663543701
Epoch: 4, Steps: 123 | Train Loss: 0.6012596 Vali Loss: 0.5346763 Best vali loss: 0.5346763
	iters: 100, epoch: 5 | loss: 0.8484477
	speed: 0.0094s/iter; left time: 3.6953s
Updating learning rate to 5.428106035107865e-05
Validation loss decreased (0.5347 --> 0.5299).  Saving model state dict ...
Epoch: 5 cost time: 0.7238800525665283
Epoch: 5, Steps: 123 | Train Loss: 0.8484477 Vali Loss: 0.5298522 Best vali loss: 0.5298522
	iters: 100, epoch: 6 | loss: 0.8058214
	speed: 0.0094s/iter; left time: 2.5328s
Updating learning rate to 2.5754297422707974e-05
Validation loss decreased (0.5299 --> 0.5281).  Saving model state dict ...
Epoch: 6 cost time: 0.7229831218719482
Epoch: 6, Steps: 123 | Train Loss: 0.8058214 Vali Loss: 0.5280797 Best vali loss: 0.5280797
	iters: 100, epoch: 7 | loss: 0.4788309
	speed: 0.0094s/iter; left time: 1.3755s
Updating learning rate to 6.693323824982499e-06
Epoch: 7 cost time: 0.7256605625152588
Epoch: 7, Steps: 123 | Train Loss: 0.4788309 Vali Loss: 0.5285321 Best vali loss: 0.5280797
	iters: 100, epoch: 8 | loss: 0.5497376
	speed: 0.0092s/iter; left time: 0.2204s
Updating learning rate to 0.0
Validation loss decreased (0.5281 --> 0.5243).  Saving model state dict ...
Epoch: 8 cost time: 0.7247302532196045
Epoch: 8, Steps: 123 | Train Loss: 0.5497376 Vali Loss: 0.5243181 Best vali loss: 0.5243181

best validation loss 0.5243181497451609

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092406227872, 'e_layers': 4, 'learning_rate': 0.0007576592775, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4562244
	speed: 0.0112s/iter; left time: 86.8357s
	iters: 200, epoch: 1 | loss: 1.2098324
	speed: 0.0049s/iter; left time: 37.3208s
	iters: 300, epoch: 1 | loss: 0.4457601
	speed: 0.0049s/iter; left time: 36.9289s
	iters: 400, epoch: 1 | loss: 0.6157010
	speed: 0.0050s/iter; left time: 36.8146s
	iters: 500, epoch: 1 | loss: 0.9156696
	speed: 0.0049s/iter; left time: 36.1617s
	iters: 600, epoch: 1 | loss: 0.9467887
	speed: 0.0048s/iter; left time: 34.6760s
	iters: 700, epoch: 1 | loss: 1.0086989
	speed: 0.0047s/iter; left time: 33.7190s
	iters: 800, epoch: 1 | loss: 0.6994977
	speed: 0.0047s/iter; left time: 32.9581s
	iters: 900, epoch: 1 | loss: 0.9080900
	speed: 0.0047s/iter; left time: 32.6841s
Updating learning rate to 0.0007576592775
Validation loss decreased (inf --> 0.6452).  Saving model state dict ...
Epoch: 1 cost time: 5.0741705894470215
Epoch: 1, Steps: 979 | Train Loss: 0.8006959 Vali Loss: 0.6451745 Best vali loss: 0.6451745
	iters: 100, epoch: 2 | loss: 0.3483433
	speed: 0.0157s/iter; left time: 106.1416s
	iters: 200, epoch: 2 | loss: 1.7434658
	speed: 0.0052s/iter; left time: 34.7999s
	iters: 300, epoch: 2 | loss: 0.8931173
	speed: 0.0052s/iter; left time: 34.1687s
	iters: 400, epoch: 2 | loss: 0.6002766
	speed: 0.0052s/iter; left time: 33.3886s
	iters: 500, epoch: 2 | loss: 0.5397794
	speed: 0.0052s/iter; left time: 33.0426s
	iters: 600, epoch: 2 | loss: 1.8181462
	speed: 0.0052s/iter; left time: 32.5311s
	iters: 700, epoch: 2 | loss: 0.3090871
	speed: 0.0052s/iter; left time: 32.1067s
	iters: 800, epoch: 2 | loss: 0.4278789
	speed: 0.0051s/iter; left time: 31.0859s
	iters: 900, epoch: 2 | loss: 0.6595177
	speed: 0.0050s/iter; left time: 29.9494s
Updating learning rate to 0.00037882963875
Epoch: 2 cost time: 5.120713472366333
Epoch: 2, Steps: 979 | Train Loss: 0.8155125 Vali Loss: 0.6592577 Best vali loss: 0.6451745
	iters: 100, epoch: 3 | loss: 0.6686116
	speed: 0.0155s/iter; left time: 89.3389s
	iters: 200, epoch: 3 | loss: 0.5784323
	speed: 0.0053s/iter; left time: 30.1122s
	iters: 300, epoch: 3 | loss: 1.0135262
	speed: 0.0048s/iter; left time: 26.5946s
	iters: 400, epoch: 3 | loss: 0.5442975
	speed: 0.0046s/iter; left time: 25.2772s
	iters: 500, epoch: 3 | loss: 0.9694040
	speed: 0.0047s/iter; left time: 25.0040s
	iters: 600, epoch: 3 | loss: 0.2802011
	speed: 0.0047s/iter; left time: 24.8689s
	iters: 700, epoch: 3 | loss: 0.4408201
	speed: 0.0050s/iter; left time: 25.8845s
	iters: 800, epoch: 3 | loss: 0.6631388
	speed: 0.0049s/iter; left time: 24.8508s
	iters: 900, epoch: 3 | loss: 0.5310971
	speed: 0.0050s/iter; left time: 24.6702s
Updating learning rate to 0.000189414819375
Validation loss decreased (0.6452 --> 0.6426).  Saving model state dict ...
Epoch: 3 cost time: 4.833345413208008
Epoch: 3, Steps: 979 | Train Loss: 0.6321699 Vali Loss: 0.6426293 Best vali loss: 0.6426293
	iters: 100, epoch: 4 | loss: 0.4485921
	speed: 0.0158s/iter; left time: 75.5794s
	iters: 200, epoch: 4 | loss: 0.5237439
	speed: 0.0049s/iter; left time: 22.8830s
	iters: 300, epoch: 4 | loss: 1.2196398
	speed: 0.0050s/iter; left time: 22.9477s
	iters: 400, epoch: 4 | loss: 0.6077032
	speed: 0.0050s/iter; left time: 22.2987s
	iters: 500, epoch: 4 | loss: 0.5594386
	speed: 0.0049s/iter; left time: 21.7441s
	iters: 600, epoch: 4 | loss: 0.7150725
	speed: 0.0049s/iter; left time: 21.0272s
	iters: 700, epoch: 4 | loss: 0.4864817
	speed: 0.0049s/iter; left time: 20.3791s
	iters: 800, epoch: 4 | loss: 0.6129100
	speed: 0.0049s/iter; left time: 19.9329s
	iters: 900, epoch: 4 | loss: 1.0110811
	speed: 0.0050s/iter; left time: 19.9767s
Updating learning rate to 9.47074096875e-05
Validation loss decreased (0.6426 --> 0.6279).  Saving model state dict ...
Epoch: 4 cost time: 4.865101099014282
Epoch: 4, Steps: 979 | Train Loss: 0.6871848 Vali Loss: 0.6279337 Best vali loss: 0.6279337
	iters: 100, epoch: 5 | loss: 0.8445837
	speed: 0.0158s/iter; left time: 60.2418s
	iters: 200, epoch: 5 | loss: 0.2082832
	speed: 0.0051s/iter; left time: 18.8026s
	iters: 300, epoch: 5 | loss: 0.9979149
	speed: 0.0051s/iter; left time: 18.3761s
	iters: 400, epoch: 5 | loss: 1.0818845
	speed: 0.0051s/iter; left time: 17.7678s
	iters: 500, epoch: 5 | loss: 1.2670648
	speed: 0.0052s/iter; left time: 17.6036s
	iters: 600, epoch: 5 | loss: 1.0742221
	speed: 0.0052s/iter; left time: 17.2706s
	iters: 700, epoch: 5 | loss: 1.0240798
	speed: 0.0052s/iter; left time: 16.6667s
	iters: 800, epoch: 5 | loss: 0.3079477
	speed: 0.0052s/iter; left time: 16.1555s
	iters: 900, epoch: 5 | loss: 0.5223384
	speed: 0.0053s/iter; left time: 15.8464s
Updating learning rate to 4.735370484375e-05
Epoch: 5 cost time: 5.074035406112671
Epoch: 5, Steps: 979 | Train Loss: 0.8142577 Vali Loss: 0.6426482 Best vali loss: 0.6279337
	iters: 100, epoch: 6 | loss: 0.8200548
	speed: 0.0154s/iter; left time: 43.7532s
	iters: 200, epoch: 6 | loss: 2.6850696
	speed: 0.0052s/iter; left time: 14.1510s
	iters: 300, epoch: 6 | loss: 0.6230134
	speed: 0.0051s/iter; left time: 13.4425s
	iters: 400, epoch: 6 | loss: 0.7787211
	speed: 0.0048s/iter; left time: 12.1718s
	iters: 500, epoch: 6 | loss: 1.5397766
	speed: 0.0048s/iter; left time: 11.7476s
	iters: 600, epoch: 6 | loss: 1.1721231
	speed: 0.0046s/iter; left time: 10.8543s
	iters: 700, epoch: 6 | loss: 0.9205917
	speed: 0.0047s/iter; left time: 10.4377s
	iters: 800, epoch: 6 | loss: 0.5875173
	speed: 0.0048s/iter; left time: 10.1638s
	iters: 900, epoch: 6 | loss: 1.1538832
	speed: 0.0045s/iter; left time: 9.2599s
Updating learning rate to 2.3676852421875e-05
Epoch: 6 cost time: 4.7780022621154785
Epoch: 6, Steps: 979 | Train Loss: 1.1423056 Vali Loss: 0.6431132 Best vali loss: 0.6279337
	iters: 100, epoch: 7 | loss: 1.2924514
	speed: 0.0150s/iter; left time: 27.9403s
	iters: 200, epoch: 7 | loss: 0.7962410
	speed: 0.0052s/iter; left time: 9.1605s
	iters: 300, epoch: 7 | loss: 0.5766429
	speed: 0.0053s/iter; left time: 8.7313s
	iters: 400, epoch: 7 | loss: 0.4717042
	speed: 0.0048s/iter; left time: 7.4053s
	iters: 500, epoch: 7 | loss: 1.0146043
	speed: 0.0048s/iter; left time: 7.0148s
	iters: 600, epoch: 7 | loss: 1.5791348
	speed: 0.0048s/iter; left time: 6.5641s
	iters: 700, epoch: 7 | loss: 1.1194488
	speed: 0.0047s/iter; left time: 5.9776s
	iters: 800, epoch: 7 | loss: 1.5135944
	speed: 0.0046s/iter; left time: 5.3689s
	iters: 900, epoch: 7 | loss: 1.1177566
	speed: 0.0048s/iter; left time: 5.0421s
Updating learning rate to 1.18384262109375e-05
Epoch: 7 cost time: 4.854900598526001
Epoch: 7, Steps: 979 | Train Loss: 1.0535087 Vali Loss: 0.6436844 Best vali loss: 0.6279337
	iters: 100, epoch: 8 | loss: 0.5538770
	speed: 0.0156s/iter; left time: 13.6867s
	iters: 200, epoch: 8 | loss: 1.0014962
	speed: 0.0053s/iter; left time: 4.1320s
	iters: 300, epoch: 8 | loss: 0.8421891
	speed: 0.0052s/iter; left time: 3.5690s
	iters: 400, epoch: 8 | loss: 0.5033801
	speed: 0.0053s/iter; left time: 3.0505s
	iters: 500, epoch: 8 | loss: 1.1154140
	speed: 0.0052s/iter; left time: 2.5076s
	iters: 600, epoch: 8 | loss: 1.4669553
	speed: 0.0053s/iter; left time: 2.0084s
	iters: 700, epoch: 8 | loss: 0.7819993
	speed: 0.0053s/iter; left time: 1.4709s
	iters: 800, epoch: 8 | loss: 0.3521828
	speed: 0.0053s/iter; left time: 0.9590s
	iters: 900, epoch: 8 | loss: 0.4845077
	speed: 0.0053s/iter; left time: 0.4254s
Updating learning rate to 5.91921310546875e-06
Epoch: 8 cost time: 5.220022439956665
Epoch: 8, Steps: 979 | Train Loss: 0.7891113 Vali Loss: 0.6435493 Best vali loss: 0.6279337

best validation loss 0.6279336526155582

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744619
	speed: 0.0117s/iter; left time: 10.3899s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0120949745178223
Epoch: 1, Steps: 123 | Train Loss: 0.7744619 Vali Loss: 0.6173000 Best vali loss: 0.6173000
	iters: 100, epoch: 2 | loss: 0.9486355
	speed: 0.0091s/iter; left time: 6.9563s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5708).  Saving model state dict ...
Epoch: 2 cost time: 0.7183830738067627
Epoch: 2, Steps: 123 | Train Loss: 0.9486355 Vali Loss: 0.5708126 Best vali loss: 0.5708126
	iters: 100, epoch: 3 | loss: 0.8464749
	speed: 0.0093s/iter; left time: 5.9176s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5708 --> 0.5479).  Saving model state dict ...
Epoch: 3 cost time: 0.7174437046051025
Epoch: 3, Steps: 123 | Train Loss: 0.8464749 Vali Loss: 0.5478885 Best vali loss: 0.5478885
	iters: 100, epoch: 4 | loss: 0.4891837
	speed: 0.0093s/iter; left time: 4.7739s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5479 --> 0.5381).  Saving model state dict ...
Epoch: 4 cost time: 0.7233574390411377
Epoch: 4, Steps: 123 | Train Loss: 0.4891837 Vali Loss: 0.5380577 Best vali loss: 0.5380577
	iters: 100, epoch: 5 | loss: 0.5555906
	speed: 0.0095s/iter; left time: 3.7304s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5381 --> 0.5215).  Saving model state dict ...
Epoch: 5 cost time: 0.7350177764892578
Epoch: 5, Steps: 123 | Train Loss: 0.5555906 Vali Loss: 0.5215249 Best vali loss: 0.5215249
	iters: 100, epoch: 6 | loss: 0.5862713
	speed: 0.0093s/iter; left time: 2.5238s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7222065925598145
Epoch: 6, Steps: 123 | Train Loss: 0.5862713 Vali Loss: 0.5384878 Best vali loss: 0.5215249
	iters: 100, epoch: 7 | loss: 0.5412305
	speed: 0.0090s/iter; left time: 1.3184s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7121758460998535
Epoch: 7, Steps: 123 | Train Loss: 0.5412305 Vali Loss: 0.5423332 Best vali loss: 0.5215249
	iters: 100, epoch: 8 | loss: 0.6952995
	speed: 0.0090s/iter; left time: 0.2164s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7213046550750732
Epoch: 8, Steps: 123 | Train Loss: 0.6952995 Vali Loss: 0.5490463 Best vali loss: 0.5215249

best validation loss 0.5215249111232025

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0022948170926, 'e_layers': 3, 'learning_rate': 0.0022069707317, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1739645
	speed: 0.0106s/iter; left time: 81.8235s
	iters: 200, epoch: 1 | loss: 1.1864516
	speed: 0.0043s/iter; left time: 32.8077s
	iters: 300, epoch: 1 | loss: 1.4974539
	speed: 0.0044s/iter; left time: 33.4287s
	iters: 400, epoch: 1 | loss: 1.4113770
	speed: 0.0044s/iter; left time: 32.5388s
	iters: 500, epoch: 1 | loss: 1.0353105
	speed: 0.0040s/iter; left time: 29.3480s
	iters: 600, epoch: 1 | loss: 0.5249354
	speed: 0.0040s/iter; left time: 28.6552s
	iters: 700, epoch: 1 | loss: 0.5499856
	speed: 0.0040s/iter; left time: 28.3329s
	iters: 800, epoch: 1 | loss: 1.3431624
	speed: 0.0040s/iter; left time: 27.8276s
	iters: 900, epoch: 1 | loss: 1.7274805
	speed: 0.0039s/iter; left time: 27.3370s
Updating learning rate to 0.002122972909784544
Validation loss decreased (inf --> 0.6519).  Saving model state dict ...
Epoch: 1 cost time: 4.379220008850098
Epoch: 1, Steps: 979 | Train Loss: 1.1611246 Vali Loss: 0.6519162 Best vali loss: 0.6519162
	iters: 100, epoch: 2 | loss: 0.9282214
	speed: 0.0132s/iter; left time: 89.4649s
	iters: 200, epoch: 2 | loss: 1.3848025
	speed: 0.0044s/iter; left time: 29.2014s
	iters: 300, epoch: 2 | loss: 0.6822447
	speed: 0.0044s/iter; left time: 29.0212s
	iters: 400, epoch: 2 | loss: 1.4576521
	speed: 0.0041s/iter; left time: 26.7133s
	iters: 500, epoch: 2 | loss: 0.8442883
	speed: 0.0038s/iter; left time: 24.3218s
	iters: 600, epoch: 2 | loss: 1.3594924
	speed: 0.0040s/iter; left time: 24.8618s
	iters: 700, epoch: 2 | loss: 1.4344517
	speed: 0.0040s/iter; left time: 24.8156s
	iters: 800, epoch: 2 | loss: 0.3472241
	speed: 0.0039s/iter; left time: 23.4898s
	iters: 900, epoch: 2 | loss: 1.0578516
	speed: 0.0038s/iter; left time: 22.5318s
Updating learning rate to 0.0018837673509826533
Validation loss decreased (0.6519 --> 0.6384).  Saving model state dict ...
Epoch: 2 cost time: 3.989089012145996
Epoch: 2, Steps: 979 | Train Loss: 1.0551365 Vali Loss: 0.6384204 Best vali loss: 0.6384204
	iters: 100, epoch: 3 | loss: 1.8035263
	speed: 0.0125s/iter; left time: 72.0160s
	iters: 200, epoch: 3 | loss: 0.2731409
	speed: 0.0039s/iter; left time: 22.2833s
	iters: 300, epoch: 3 | loss: 0.8361299
	speed: 0.0039s/iter; left time: 21.6084s
	iters: 400, epoch: 3 | loss: 0.5107792
	speed: 0.0039s/iter; left time: 21.3970s
	iters: 500, epoch: 3 | loss: 0.6744801
	speed: 0.0037s/iter; left time: 19.8844s
	iters: 600, epoch: 3 | loss: 1.8538496
	speed: 0.0039s/iter; left time: 20.4265s
	iters: 700, epoch: 3 | loss: 2.0795321
	speed: 0.0039s/iter; left time: 20.1689s
	iters: 800, epoch: 3 | loss: 0.8656992
	speed: 0.0038s/iter; left time: 19.1004s
	iters: 900, epoch: 3 | loss: 1.2610127
	speed: 0.0039s/iter; left time: 19.4944s
Updating learning rate to 0.0015257709332181248
Epoch: 3 cost time: 3.8265626430511475
Epoch: 3, Steps: 979 | Train Loss: 1.1286834 Vali Loss: 0.6469645 Best vali loss: 0.6384204

best validation loss 0.6384204436319396

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010888136339, 'e_layers': 3, 'learning_rate': 0.000176127781, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1031438
	speed: 0.0120s/iter; left time: 10.6579s
Updating learning rate to 0.000176127781
Validation loss decreased (inf --> 0.5945).  Saving model state dict ...
Epoch: 1 cost time: 1.0472357273101807
Epoch: 1, Steps: 123 | Train Loss: 1.1031438 Vali Loss: 0.5945114 Best vali loss: 0.5945114
	iters: 100, epoch: 2 | loss: 0.6521810
	speed: 0.0089s/iter; left time: 6.7741s
Updating learning rate to 8.80638905e-05
Validation loss decreased (0.5945 --> 0.5876).  Saving model state dict ...
Epoch: 2 cost time: 0.7158327102661133
Epoch: 2, Steps: 123 | Train Loss: 0.6521810 Vali Loss: 0.5876300 Best vali loss: 0.5876300
	iters: 100, epoch: 3 | loss: 0.8399174
	speed: 0.0091s/iter; left time: 5.8178s
Updating learning rate to 4.403194525e-05
Validation loss decreased (0.5876 --> 0.5696).  Saving model state dict ...
Epoch: 3 cost time: 0.7254250049591064
Epoch: 3, Steps: 123 | Train Loss: 0.8399174 Vali Loss: 0.5695922 Best vali loss: 0.5695922

best validation loss 0.5695922108007658

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0037565946735, 'e_layers': 2, 'learning_rate': 0.0035165732668, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003382731666286436
Validation loss decreased (inf --> 0.6063).  Saving model state dict ...
Epoch: 1 cost time: 0.7051575183868408
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6062658 Best vali loss: 0.6062658
Updating learning rate to 0.003001583035146805
Epoch: 2 cost time: 0.46493077278137207
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6167770 Best vali loss: 0.6062658
Updating learning rate to 0.0024311537973511705
Epoch: 3 cost time: 0.44118571281433105
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6188504 Best vali loss: 0.6062658

best validation loss 0.6062657699050974

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010888136339, 'e_layers': 3, 'learning_rate': 0.000176127781, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9724578
	speed: 0.0123s/iter; left time: 6.3422s
Updating learning rate to 2.2015972625e-05
Epoch: 4 cost time: 1.0532786846160889
Epoch: 4, Steps: 123 | Train Loss: 0.9724578 Vali Loss: 0.5723542 Best vali loss: 0.5695922
	iters: 100, epoch: 5 | loss: 0.6363340
	speed: 0.0090s/iter; left time: 3.5462s
Updating learning rate to 1.10079863125e-05
Validation loss decreased (0.5696 --> 0.5689).  Saving model state dict ...
Epoch: 5 cost time: 0.7412898540496826
Epoch: 5, Steps: 123 | Train Loss: 0.6363340 Vali Loss: 0.5688675 Best vali loss: 0.5688675
	iters: 100, epoch: 6 | loss: 0.7617236
	speed: 0.0091s/iter; left time: 2.4480s
Updating learning rate to 5.50399315625e-06
Validation loss decreased (0.5689 --> 0.5629).  Saving model state dict ...
Epoch: 6 cost time: 0.7141058444976807
Epoch: 6, Steps: 123 | Train Loss: 0.7617236 Vali Loss: 0.5628611 Best vali loss: 0.5628611
	iters: 100, epoch: 7 | loss: 0.9043097
	speed: 0.0091s/iter; left time: 1.3435s
Updating learning rate to 2.751996578125e-06
Epoch: 7 cost time: 0.7269299030303955
Epoch: 7, Steps: 123 | Train Loss: 0.9043097 Vali Loss: 0.5634066 Best vali loss: 0.5628611
	iters: 100, epoch: 8 | loss: 0.6843840
	speed: 0.0088s/iter; left time: 0.2100s
Updating learning rate to 1.3759982890625e-06
Validation loss decreased (0.5629 --> 0.5625).  Saving model state dict ...
Epoch: 8 cost time: 0.7005083560943604
Epoch: 8, Steps: 123 | Train Loss: 0.6843840 Vali Loss: 0.5624725 Best vali loss: 0.5624725

best validation loss 0.5624724553448908

[INFO][smbo.py:320] Finished 700 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043891091461, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616594
	speed: 0.0116s/iter; left time: 10.2702s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.020925521850586
Epoch: 1, Steps: 123 | Train Loss: 0.7616594 Vali Loss: 0.6075769 Best vali loss: 0.6075769
	iters: 100, epoch: 2 | loss: 0.9383174
	speed: 0.0091s/iter; left time: 6.9522s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5709).  Saving model state dict ...
Epoch: 2 cost time: 0.7160413265228271
Epoch: 2, Steps: 123 | Train Loss: 0.9383174 Vali Loss: 0.5708885 Best vali loss: 0.5708885
	iters: 100, epoch: 3 | loss: 0.8562521
	speed: 0.0093s/iter; left time: 5.9649s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5709 --> 0.5387).  Saving model state dict ...
Epoch: 3 cost time: 0.7198686599731445
Epoch: 3, Steps: 123 | Train Loss: 0.8562521 Vali Loss: 0.5387478 Best vali loss: 0.5387478
	iters: 100, epoch: 4 | loss: 0.4975470
	speed: 0.0092s/iter; left time: 4.7454s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5387 --> 0.5298).  Saving model state dict ...
Epoch: 4 cost time: 0.7146410942077637
Epoch: 4, Steps: 123 | Train Loss: 0.4975470 Vali Loss: 0.5297600 Best vali loss: 0.5297600
	iters: 100, epoch: 5 | loss: 0.5721365
	speed: 0.0093s/iter; left time: 3.6463s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5298 --> 0.5284).  Saving model state dict ...
Epoch: 5 cost time: 0.7244281768798828
Epoch: 5, Steps: 123 | Train Loss: 0.5721365 Vali Loss: 0.5283530 Best vali loss: 0.5283530
	iters: 100, epoch: 6 | loss: 0.6190997
	speed: 0.0094s/iter; left time: 2.5246s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7298462390899658
Epoch: 6, Steps: 123 | Train Loss: 0.6190997 Vali Loss: 0.5287489 Best vali loss: 0.5283530
	iters: 100, epoch: 7 | loss: 0.5778685
	speed: 0.0091s/iter; left time: 1.3412s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5284 --> 0.5247).  Saving model state dict ...
Epoch: 7 cost time: 0.7142698764801025
Epoch: 7, Steps: 123 | Train Loss: 0.5778685 Vali Loss: 0.5246560 Best vali loss: 0.5246560
	iters: 100, epoch: 8 | loss: 0.7400350
	speed: 0.0094s/iter; left time: 0.2250s
Updating learning rate to 0.0
Validation loss decreased (0.5247 --> 0.5230).  Saving model state dict ...
Epoch: 8 cost time: 0.7260541915893555
Epoch: 8, Steps: 123 | Train Loss: 0.7400350 Vali Loss: 0.5230435 Best vali loss: 0.5230435

best validation loss 0.52304347032532

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001757229123, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616766
	speed: 0.0116s/iter; left time: 10.2622s
Updating learning rate to 0.00016903485718362292
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.021623134613037
Epoch: 1, Steps: 123 | Train Loss: 0.7616766 Vali Loss: 0.6075352 Best vali loss: 0.6075352
	iters: 100, epoch: 2 | loss: 0.9389388
	speed: 0.0091s/iter; left time: 6.9654s
Updating learning rate to 0.0001499888875985895
Validation loss decreased (0.6075 --> 0.5724).  Saving model state dict ...
Epoch: 2 cost time: 0.7186737060546875
Epoch: 2, Steps: 123 | Train Loss: 0.9389388 Vali Loss: 0.5724303 Best vali loss: 0.5724303
	iters: 100, epoch: 3 | loss: 0.8645164
	speed: 0.0094s/iter; left time: 6.0194s
Updating learning rate to 0.00012148457976207684
Validation loss decreased (0.5724 --> 0.5442).  Saving model state dict ...
Epoch: 3 cost time: 0.724388837814331
Epoch: 3, Steps: 123 | Train Loss: 0.8645164 Vali Loss: 0.5442290 Best vali loss: 0.5442290
	iters: 100, epoch: 4 | loss: 0.4991386
	speed: 0.0094s/iter; left time: 4.8268s
Updating learning rate to 8.786145615e-05
Validation loss decreased (0.5442 --> 0.5312).  Saving model state dict ...
Epoch: 4 cost time: 0.7202441692352295
Epoch: 4, Steps: 123 | Train Loss: 0.4991386 Vali Loss: 0.5312185 Best vali loss: 0.5312185
	iters: 100, epoch: 5 | loss: 0.5745658
	speed: 0.0094s/iter; left time: 3.6895s
Updating learning rate to 5.423833253792318e-05
Validation loss decreased (0.5312 --> 0.5289).  Saving model state dict ...
Epoch: 5 cost time: 0.7256574630737305
Epoch: 5, Steps: 123 | Train Loss: 0.5745658 Vali Loss: 0.5288780 Best vali loss: 0.5288780
	iters: 100, epoch: 6 | loss: 0.6215305
	speed: 0.0094s/iter; left time: 2.5283s
Updating learning rate to 2.5734024701410518e-05
Epoch: 6 cost time: 0.7226190567016602
Epoch: 6, Steps: 123 | Train Loss: 0.6215305 Vali Loss: 0.5304959 Best vali loss: 0.5288780
	iters: 100, epoch: 7 | loss: 0.5767509
	speed: 0.0090s/iter; left time: 1.3278s
Updating learning rate to 6.688055116377081e-06
Validation loss decreased (0.5289 --> 0.5256).  Saving model state dict ...
Epoch: 7 cost time: 0.7187809944152832
Epoch: 7, Steps: 123 | Train Loss: 0.5767509 Vali Loss: 0.5255969 Best vali loss: 0.5255969
	iters: 100, epoch: 8 | loss: 0.7433070
	speed: 0.0093s/iter; left time: 0.2243s
Updating learning rate to 0.0
Validation loss decreased (0.5256 --> 0.5243).  Saving model state dict ...
Epoch: 8 cost time: 0.7206416130065918
Epoch: 8, Steps: 123 | Train Loss: 0.7433070 Vali Loss: 0.5242796 Best vali loss: 0.5242796

best validation loss 0.5242795978691334

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0063756200241, 'e_layers': 2, 'learning_rate': 0.0036156866667, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2787155
	speed: 0.0096s/iter; left time: 74.6158s
	iters: 200, epoch: 1 | loss: 0.3924515
	speed: 0.0034s/iter; left time: 26.0975s
	iters: 300, epoch: 1 | loss: 1.0312890
	speed: 0.0034s/iter; left time: 25.8820s
	iters: 400, epoch: 1 | loss: 1.0151001
	speed: 0.0032s/iter; left time: 24.0360s
	iters: 500, epoch: 1 | loss: 0.6034905
	speed: 0.0033s/iter; left time: 23.9263s
	iters: 600, epoch: 1 | loss: 0.3735839
	speed: 0.0033s/iter; left time: 23.9038s
	iters: 700, epoch: 1 | loss: 0.7936856
	speed: 0.0034s/iter; left time: 24.5815s
	iters: 800, epoch: 1 | loss: 1.1484911
	speed: 0.0035s/iter; left time: 24.4733s
	iters: 900, epoch: 1 | loss: 0.3956575
	speed: 0.0033s/iter; left time: 22.7727s
Updating learning rate to 0.0036156866667
Validation loss decreased (inf --> 0.6240).  Saving model state dict ...
Epoch: 1 cost time: 3.6513359546661377
Epoch: 1, Steps: 979 | Train Loss: 0.6702739 Vali Loss: 0.6239622 Best vali loss: 0.6239622
	iters: 100, epoch: 2 | loss: 1.9696518
	speed: 0.0112s/iter; left time: 75.7210s
	iters: 200, epoch: 2 | loss: 1.0502707
	speed: 0.0033s/iter; left time: 21.7667s
	iters: 300, epoch: 2 | loss: 0.4496671
	speed: 0.0032s/iter; left time: 21.1676s
	iters: 400, epoch: 2 | loss: 1.2652920
	speed: 0.0032s/iter; left time: 20.4493s
	iters: 500, epoch: 2 | loss: 0.5552596
	speed: 0.0034s/iter; left time: 21.3002s
	iters: 600, epoch: 2 | loss: 0.6171335
	speed: 0.0032s/iter; left time: 20.2380s
	iters: 700, epoch: 2 | loss: 1.5291184
	speed: 0.0031s/iter; left time: 19.3182s
	iters: 800, epoch: 2 | loss: 0.7146461
	speed: 0.0033s/iter; left time: 19.8241s
	iters: 900, epoch: 2 | loss: 0.5331799
	speed: 0.0030s/iter; left time: 18.1284s
Updating learning rate to 0.00180784333335
Epoch: 2 cost time: 3.2074878215789795
Epoch: 2, Steps: 979 | Train Loss: 0.9649132 Vali Loss: 0.6384942 Best vali loss: 0.6239622
	iters: 100, epoch: 3 | loss: 0.2893431
	speed: 0.0109s/iter; left time: 63.0351s
	iters: 200, epoch: 3 | loss: 0.9501417
	speed: 0.0032s/iter; left time: 18.2393s
	iters: 300, epoch: 3 | loss: 0.8090748
	speed: 0.0031s/iter; left time: 17.3045s
	iters: 400, epoch: 3 | loss: 0.6304075
	speed: 0.0032s/iter; left time: 17.6739s
	iters: 500, epoch: 3 | loss: 0.5218032
	speed: 0.0032s/iter; left time: 17.0710s
	iters: 600, epoch: 3 | loss: 0.5379525
	speed: 0.0031s/iter; left time: 16.5811s
	iters: 700, epoch: 3 | loss: 0.5327215
	speed: 0.0031s/iter; left time: 16.0919s
	iters: 800, epoch: 3 | loss: 0.2470110
	speed: 0.0033s/iter; left time: 16.5914s
	iters: 900, epoch: 3 | loss: 2.0936394
	speed: 0.0033s/iter; left time: 16.1796s
Updating learning rate to 0.000903921666675
Epoch: 3 cost time: 3.1529526710510254
Epoch: 3, Steps: 979 | Train Loss: 0.7346772 Vali Loss: 0.6281667 Best vali loss: 0.6239622

best validation loss 0.6239621953410387

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0112220482915, 'e_layers': 2, 'learning_rate': 0.0001050535456, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7518303
	speed: 0.0118s/iter; left time: 10.4688s
Updating learning rate to 0.00010105518309879058
Validation loss decreased (inf --> 0.6016).  Saving model state dict ...
Epoch: 1 cost time: 1.0413317680358887
Epoch: 1, Steps: 123 | Train Loss: 0.7518303 Vali Loss: 0.6015506 Best vali loss: 0.6015506
	iters: 100, epoch: 2 | loss: 0.9500926
	speed: 0.0092s/iter; left time: 6.9752s
Updating learning rate to 8.96688100407251e-05
Epoch: 2 cost time: 0.717383623123169
Epoch: 2, Steps: 123 | Train Loss: 0.9500926 Vali Loss: 0.6043891 Best vali loss: 0.6015506
	iters: 100, epoch: 3 | loss: 0.8768760
	speed: 0.0089s/iter; left time: 5.7150s
Updating learning rate to 7.262789850616524e-05
Validation loss decreased (0.6016 --> 0.5693).  Saving model state dict ...
Epoch: 3 cost time: 0.7168631553649902
Epoch: 3, Steps: 123 | Train Loss: 0.8768760 Vali Loss: 0.5693288 Best vali loss: 0.5693288

best validation loss 0.5693288426165336

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.000870007429, 'e_layers': 4, 'learning_rate': 6.59948534e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.348307385367146e-05
Validation loss decreased (inf --> 0.6319).  Saving model state dict ...
Epoch: 1 cost time: 0.9142613410949707
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6319218 Best vali loss: 0.6319218
Updating learning rate to 5.633013088127604e-05
Validation loss decreased (0.6319 --> 0.6124).  Saving model state dict ...
Epoch: 2 cost time: 0.6078345775604248
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6123650 Best vali loss: 0.6123650
Updating learning rate to 4.562499520877146e-05
Validation loss decreased (0.6124 --> 0.6030).  Saving model state dict ...
Epoch: 3 cost time: 0.5975947380065918
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6029863 Best vali loss: 0.6029863

best validation loss 0.602986348745504

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0112220482915, 'e_layers': 2, 'learning_rate': 0.0001050535456, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6338684
	speed: 0.0122s/iter; left time: 6.3185s
Updating learning rate to 5.25267728e-05
Validation loss decreased (0.5693 --> 0.5377).  Saving model state dict ...
Epoch: 4 cost time: 1.0480618476867676
Epoch: 4, Steps: 123 | Train Loss: 0.6338684 Vali Loss: 0.5376888 Best vali loss: 0.5376888
	iters: 100, epoch: 5 | loss: 0.8712708
	speed: 0.0093s/iter; left time: 3.6615s
Updating learning rate to 3.242564709383477e-05
Epoch: 5 cost time: 0.7180294990539551
Epoch: 5, Steps: 123 | Train Loss: 0.8712708 Vali Loss: 0.5451335 Best vali loss: 0.5376888
	iters: 100, epoch: 6 | loss: 0.8367410
	speed: 0.0090s/iter; left time: 2.4372s
Updating learning rate to 1.5384735559274907e-05
Epoch: 6 cost time: 0.7157080173492432
Epoch: 6, Steps: 123 | Train Loss: 0.8367410 Vali Loss: 0.5416352 Best vali loss: 0.5376888
	iters: 100, epoch: 7 | loss: 0.5032164
	speed: 0.0090s/iter; left time: 1.3268s
Updating learning rate to 3.998362501209428e-06
Epoch: 7 cost time: 0.7212662696838379
Epoch: 7, Steps: 123 | Train Loss: 0.5032164 Vali Loss: 0.5393956 Best vali loss: 0.5376888
	iters: 100, epoch: 8 | loss: 0.5788990
	speed: 0.0091s/iter; left time: 0.2172s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7125959396362305
Epoch: 8, Steps: 123 | Train Loss: 0.5788990 Vali Loss: 0.5380620 Best vali loss: 0.5376888

best validation loss 0.5376888231125655

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0024101229607, 'e_layers': 3, 'learning_rate': 5.52167659e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1534375
	speed: 0.0114s/iter; left time: 21.1553s
	iters: 200, epoch: 1 | loss: 0.8060596
	speed: 0.0052s/iter; left time: 9.2047s
Updating learning rate to 5.52167659e-05
Validation loss decreased (inf --> 0.6059).  Saving model state dict ...
Epoch: 1 cost time: 1.6228549480438232
Epoch: 1, Steps: 245 | Train Loss: 0.9797485 Vali Loss: 0.6059302 Best vali loss: 0.6059302
	iters: 100, epoch: 2 | loss: 0.6746668
	speed: 0.0107s/iter; left time: 17.3465s
	iters: 200, epoch: 2 | loss: 0.7013025
	speed: 0.0051s/iter; left time: 7.8009s
Updating learning rate to 2.760838295e-05
Validation loss decreased (0.6059 --> 0.5905).  Saving model state dict ...
Epoch: 2 cost time: 1.3122491836547852
Epoch: 2, Steps: 245 | Train Loss: 0.6879847 Vali Loss: 0.5905107 Best vali loss: 0.5905107
	iters: 100, epoch: 3 | loss: 0.7542317
	speed: 0.0108s/iter; left time: 14.8290s
	iters: 200, epoch: 3 | loss: 0.7122742
	speed: 0.0050s/iter; left time: 6.3511s
Updating learning rate to 1.3804191475e-05
Validation loss decreased (0.5905 --> 0.5808).  Saving model state dict ...
Epoch: 3 cost time: 1.2853047847747803
Epoch: 3, Steps: 245 | Train Loss: 0.7332529 Vali Loss: 0.5807509 Best vali loss: 0.5807509
	iters: 100, epoch: 4 | loss: 0.7239114
	speed: 0.0106s/iter; left time: 11.9784s
	iters: 200, epoch: 4 | loss: 0.6620212
	speed: 0.0051s/iter; left time: 5.2252s
Updating learning rate to 6.9020957375e-06
Epoch: 4 cost time: 1.2886836528778076
Epoch: 4, Steps: 245 | Train Loss: 0.6929663 Vali Loss: 0.5826033 Best vali loss: 0.5807509
	iters: 100, epoch: 5 | loss: 0.6140487
	speed: 0.0104s/iter; left time: 9.1694s
	iters: 200, epoch: 5 | loss: 0.6162724
	speed: 0.0052s/iter; left time: 4.0449s
Updating learning rate to 3.45104786875e-06
Validation loss decreased (0.5808 --> 0.5799).  Saving model state dict ...
Epoch: 5 cost time: 1.3236546516418457
Epoch: 5, Steps: 245 | Train Loss: 0.6151606 Vali Loss: 0.5799039 Best vali loss: 0.5799039
	iters: 100, epoch: 6 | loss: 0.7655908
	speed: 0.0108s/iter; left time: 6.8885s
	iters: 200, epoch: 6 | loss: 0.6574489
	speed: 0.0052s/iter; left time: 2.8102s
Updating learning rate to 1.725523934375e-06
Validation loss decreased (0.5799 --> 0.5792).  Saving model state dict ...
Epoch: 6 cost time: 1.3291335105895996
Epoch: 6, Steps: 245 | Train Loss: 0.7115198 Vali Loss: 0.5791906 Best vali loss: 0.5791906
	iters: 100, epoch: 7 | loss: 0.7191535
	speed: 0.0108s/iter; left time: 4.2241s
	iters: 200, epoch: 7 | loss: 0.6445400
	speed: 0.0051s/iter; left time: 1.4717s
Updating learning rate to 8.627619671875e-07
Epoch: 7 cost time: 1.2907023429870605
Epoch: 7, Steps: 245 | Train Loss: 0.6818467 Vali Loss: 0.5798161 Best vali loss: 0.5791906
	iters: 100, epoch: 8 | loss: 0.5196747
	speed: 0.0104s/iter; left time: 1.5239s
	iters: 200, epoch: 8 | loss: 0.5051815
	speed: 0.0053s/iter; left time: 0.2432s
Updating learning rate to 4.3138098359375e-07
Epoch: 8 cost time: 1.3360230922698975
Epoch: 8, Steps: 245 | Train Loss: 0.5124281 Vali Loss: 0.5802235 Best vali loss: 0.5791906

best validation loss 0.5791906116462207

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0111601361116, 'e_layers': 4, 'learning_rate': 0.0001789273609, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8512933
	speed: 0.0115s/iter; left time: 43.8619s
	iters: 200, epoch: 1 | loss: 1.0672363
	speed: 0.0050s/iter; left time: 18.6905s
	iters: 300, epoch: 1 | loss: 0.6288068
	speed: 0.0051s/iter; left time: 18.3530s
	iters: 400, epoch: 1 | loss: 1.0941174
	speed: 0.0051s/iter; left time: 18.0600s
Updating learning rate to 0.0001789273609
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 2.8647263050079346
Epoch: 1, Steps: 490 | Train Loss: 0.9103634 Vali Loss: 0.6066637 Best vali loss: 0.6066637
	iters: 100, epoch: 2 | loss: 0.5257037
	speed: 0.0140s/iter; left time: 46.7717s
	iters: 200, epoch: 2 | loss: 1.1589551
	speed: 0.0050s/iter; left time: 16.1557s
	iters: 300, epoch: 2 | loss: 0.7360164
	speed: 0.0051s/iter; left time: 16.0125s
	iters: 400, epoch: 2 | loss: 0.7208246
	speed: 0.0051s/iter; left time: 15.4763s
Updating learning rate to 8.946368045e-05
Validation loss decreased (0.6067 --> 0.5565).  Saving model state dict ...
Epoch: 2 cost time: 2.5292482376098633
Epoch: 2, Steps: 490 | Train Loss: 0.7853750 Vali Loss: 0.5565054 Best vali loss: 0.5565054
	iters: 100, epoch: 3 | loss: 0.9187060
	speed: 0.0143s/iter; left time: 40.6751s
	iters: 200, epoch: 3 | loss: 0.5051049
	speed: 0.0053s/iter; left time: 14.5134s
	iters: 300, epoch: 3 | loss: 1.2588538
	speed: 0.0050s/iter; left time: 13.3149s
	iters: 400, epoch: 3 | loss: 0.5115288
	speed: 0.0051s/iter; left time: 12.9356s
Updating learning rate to 4.4731840225e-05
Epoch: 3 cost time: 2.601439952850342
Epoch: 3, Steps: 490 | Train Loss: 0.7985484 Vali Loss: 0.5588532 Best vali loss: 0.5565054
	iters: 100, epoch: 4 | loss: 0.5171376
	speed: 0.0138s/iter; left time: 32.5082s
	iters: 200, epoch: 4 | loss: 0.9210749
	speed: 0.0054s/iter; left time: 12.1926s
	iters: 300, epoch: 4 | loss: 1.2949662
	speed: 0.0052s/iter; left time: 11.2865s
	iters: 400, epoch: 4 | loss: 0.6052077
	speed: 0.0051s/iter; left time: 10.4323s
Updating learning rate to 2.23659201125e-05
Validation loss decreased (0.5565 --> 0.5565).  Saving model state dict ...
Epoch: 4 cost time: 2.6093969345092773
Epoch: 4, Steps: 490 | Train Loss: 0.8345966 Vali Loss: 0.5564850 Best vali loss: 0.5564850
	iters: 100, epoch: 5 | loss: 0.9469888
	speed: 0.0143s/iter; left time: 26.5369s
	iters: 200, epoch: 5 | loss: 0.2532765
	speed: 0.0055s/iter; left time: 9.6905s
	iters: 300, epoch: 5 | loss: 0.6103479
	speed: 0.0055s/iter; left time: 9.0971s
	iters: 400, epoch: 5 | loss: 1.1645346
	speed: 0.0056s/iter; left time: 8.6939s
Updating learning rate to 1.118296005625e-05
Validation loss decreased (0.5565 --> 0.5536).  Saving model state dict ...
Epoch: 5 cost time: 2.7507402896881104
Epoch: 5, Steps: 490 | Train Loss: 0.7437869 Vali Loss: 0.5535538 Best vali loss: 0.5535538
	iters: 100, epoch: 6 | loss: 0.7305047
	speed: 0.0143s/iter; left time: 19.6272s
	iters: 200, epoch: 6 | loss: 0.6982592
	speed: 0.0051s/iter; left time: 6.5383s
	iters: 300, epoch: 6 | loss: 0.5850415
	speed: 0.0050s/iter; left time: 5.8288s
	iters: 400, epoch: 6 | loss: 0.5139418
	speed: 0.0050s/iter; left time: 5.3461s
Updating learning rate to 5.591480028125e-06
Validation loss decreased (0.5536 --> 0.5490).  Saving model state dict ...
Epoch: 6 cost time: 2.5336544513702393
Epoch: 6, Steps: 490 | Train Loss: 0.6319368 Vali Loss: 0.5489662 Best vali loss: 0.5489662
	iters: 100, epoch: 7 | loss: 0.6225454
	speed: 0.0138s/iter; left time: 12.1729s
	iters: 200, epoch: 7 | loss: 0.5833060
	speed: 0.0051s/iter; left time: 4.0206s
	iters: 300, epoch: 7 | loss: 0.5734053
	speed: 0.0051s/iter; left time: 3.4595s
	iters: 400, epoch: 7 | loss: 1.1277593
	speed: 0.0051s/iter; left time: 2.9461s
Updating learning rate to 2.7957400140625e-06
Validation loss decreased (0.5490 --> 0.5475).  Saving model state dict ...
Epoch: 7 cost time: 2.565727710723877
Epoch: 7, Steps: 490 | Train Loss: 0.7267540 Vali Loss: 0.5474782 Best vali loss: 0.5474782
	iters: 100, epoch: 8 | loss: 0.4557939
	speed: 0.0138s/iter; left time: 5.4009s
	iters: 200, epoch: 8 | loss: 0.8406276
	speed: 0.0050s/iter; left time: 1.4557s
	iters: 300, epoch: 8 | loss: 0.6664680
	speed: 0.0050s/iter; left time: 0.9506s
	iters: 400, epoch: 8 | loss: 0.6775665
	speed: 0.0049s/iter; left time: 0.4464s
Updating learning rate to 1.39787000703125e-06
Epoch: 8 cost time: 2.473468780517578
Epoch: 8, Steps: 490 | Train Loss: 0.6601140 Vali Loss: 0.5485061 Best vali loss: 0.5474782

best validation loss 0.547478169740653

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0023972159696, 'e_layers': 3, 'learning_rate': 5.52722461e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7913568
	speed: 0.0117s/iter; left time: 21.8070s
	iters: 200, epoch: 1 | loss: 0.8838558
	speed: 0.0055s/iter; left time: 9.6756s
Updating learning rate to 5.52722461e-05
Validation loss decreased (inf --> 0.6024).  Saving model state dict ...
Epoch: 1 cost time: 1.6940639019012451
Epoch: 1, Steps: 245 | Train Loss: 0.8376063 Vali Loss: 0.6023980 Best vali loss: 0.6023980
	iters: 100, epoch: 2 | loss: 0.9046212
	speed: 0.0110s/iter; left time: 17.7196s
	iters: 200, epoch: 2 | loss: 0.8637032
	speed: 0.0052s/iter; left time: 7.9222s
Updating learning rate to 2.763612305e-05
Epoch: 2 cost time: 1.3465912342071533
Epoch: 2, Steps: 245 | Train Loss: 0.8841622 Vali Loss: 0.6047038 Best vali loss: 0.6023980
	iters: 100, epoch: 3 | loss: 0.9377943
	speed: 0.0108s/iter; left time: 14.8346s
	iters: 200, epoch: 3 | loss: 0.7513523
	speed: 0.0055s/iter; left time: 6.9975s
Updating learning rate to 1.3818061525e-05
Validation loss decreased (0.6024 --> 0.5717).  Saving model state dict ...
Epoch: 3 cost time: 1.3856439590454102
Epoch: 3, Steps: 245 | Train Loss: 0.8445733 Vali Loss: 0.5717003 Best vali loss: 0.5717003

best validation loss 0.5717003053672222

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0075044801523, 'e_layers': 4, 'learning_rate': 0.0008154271282, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008154271282
Validation loss decreased (inf --> 0.6342).  Saving model state dict ...
Epoch: 1 cost time: 1.1740577220916748
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6342218 Best vali loss: 0.6342218
Updating learning rate to 0.0004077135641
Validation loss decreased (0.6342 --> 0.6168).  Saving model state dict ...
Epoch: 2 cost time: 0.8565542697906494
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6168065 Best vali loss: 0.6168065
Updating learning rate to 0.00020385678205
Epoch: 3 cost time: 0.8582658767700195
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6224350 Best vali loss: 0.6168065

best validation loss 0.6168065267765428

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0045764849105, 'e_layers': 3, 'learning_rate': 0.0039394749135, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9482729
	speed: 0.0111s/iter; left time: 20.5732s
	iters: 200, epoch: 1 | loss: 0.8534291
	speed: 0.0049s/iter; left time: 8.6796s
Updating learning rate to 0.0037895375774621605
Validation loss decreased (inf --> 0.6468).  Saving model state dict ...
Epoch: 1 cost time: 1.5458102226257324
Epoch: 1, Steps: 245 | Train Loss: 0.9008510 Vali Loss: 0.6468068 Best vali loss: 0.6468068
	iters: 100, epoch: 2 | loss: 1.0266882
	speed: 0.0097s/iter; left time: 15.6440s
	iters: 200, epoch: 2 | loss: 0.7479048
	speed: 0.0049s/iter; left time: 7.3557s
Updating learning rate to 0.0033625521695750684
Validation loss decreased (0.6468 --> 0.6446).  Saving model state dict ...
Epoch: 2 cost time: 1.2369725704193115
Epoch: 2, Steps: 245 | Train Loss: 0.8872965 Vali Loss: 0.6445857 Best vali loss: 0.6445857
	iters: 100, epoch: 3 | loss: 1.1308742
	speed: 0.0096s/iter; left time: 13.1360s
	iters: 200, epoch: 3 | loss: 0.9636983
	speed: 0.0049s/iter; left time: 6.1760s
Updating learning rate to 0.0027235233475571725
Validation loss decreased (0.6446 --> 0.6406).  Saving model state dict ...
Epoch: 3 cost time: 1.2277336120605469
Epoch: 3, Steps: 245 | Train Loss: 1.0472862 Vali Loss: 0.6406018 Best vali loss: 0.6406018

best validation loss 0.6406017726684599

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0023972159696, 'e_layers': 3, 'learning_rate': 5.52722461e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6007523
	speed: 0.0122s/iter; left time: 13.7189s
	iters: 200, epoch: 4 | loss: 0.8559736
	speed: 0.0054s/iter; left time: 5.5859s
Updating learning rate to 6.9090307625e-06
Epoch: 4 cost time: 1.693556785583496
Epoch: 4, Steps: 245 | Train Loss: 0.7283629 Vali Loss: 0.5759483 Best vali loss: 0.5717003
	iters: 100, epoch: 5 | loss: 0.8115745
	speed: 0.0109s/iter; left time: 9.5742s
	iters: 200, epoch: 5 | loss: 0.7975660
	speed: 0.0054s/iter; left time: 4.1905s
Updating learning rate to 3.45451538125e-06
Validation loss decreased (0.5717 --> 0.5698).  Saving model state dict ...
Epoch: 5 cost time: 1.3764657974243164
Epoch: 5, Steps: 245 | Train Loss: 0.8045703 Vali Loss: 0.5697984 Best vali loss: 0.5697984
	iters: 100, epoch: 6 | loss: 0.9136387
	speed: 0.0115s/iter; left time: 7.3238s
	iters: 200, epoch: 6 | loss: 0.7255629
	speed: 0.0056s/iter; left time: 2.9814s
Updating learning rate to 1.727257690625e-06
Validation loss decreased (0.5698 --> 0.5650).  Saving model state dict ...
Epoch: 6 cost time: 1.4179761409759521
Epoch: 6, Steps: 245 | Train Loss: 0.8196008 Vali Loss: 0.5650306 Best vali loss: 0.5650306
	iters: 100, epoch: 7 | loss: 0.8551169
	speed: 0.0113s/iter; left time: 4.4316s
	iters: 200, epoch: 7 | loss: 0.9045926
	speed: 0.0055s/iter; left time: 1.5947s
Updating learning rate to 8.636288453125e-07
Validation loss decreased (0.5650 --> 0.5635).  Saving model state dict ...
Epoch: 7 cost time: 1.385690689086914
Epoch: 7, Steps: 245 | Train Loss: 0.8798547 Vali Loss: 0.5634662 Best vali loss: 0.5634662
	iters: 100, epoch: 8 | loss: 0.8028753
	speed: 0.0113s/iter; left time: 1.6488s
	iters: 200, epoch: 8 | loss: 0.8332498
	speed: 0.0055s/iter; left time: 0.2520s
Updating learning rate to 4.3181442265625e-07
Epoch: 8 cost time: 1.3780977725982666
Epoch: 8, Steps: 245 | Train Loss: 0.8180625 Vali Loss: 0.5644978 Best vali loss: 0.5634662

best validation loss 0.5634662131367321

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043909987985, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616874
	speed: 0.0118s/iter; left time: 10.4610s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0338547229766846
Epoch: 1, Steps: 123 | Train Loss: 0.7616874 Vali Loss: 0.6075597 Best vali loss: 0.6075597
	iters: 100, epoch: 2 | loss: 0.9380960
	speed: 0.0093s/iter; left time: 7.0585s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5714).  Saving model state dict ...
Epoch: 2 cost time: 0.7283153533935547
Epoch: 2, Steps: 123 | Train Loss: 0.9380960 Vali Loss: 0.5713563 Best vali loss: 0.5713563
	iters: 100, epoch: 3 | loss: 0.8587791
	speed: 0.0094s/iter; left time: 6.0194s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5714 --> 0.5454).  Saving model state dict ...
Epoch: 3 cost time: 0.7243669033050537
Epoch: 3, Steps: 123 | Train Loss: 0.8587791 Vali Loss: 0.5453953 Best vali loss: 0.5453953
	iters: 100, epoch: 4 | loss: 0.5071049
	speed: 0.0093s/iter; left time: 4.7952s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5454 --> 0.5403).  Saving model state dict ...
Epoch: 4 cost time: 0.7227554321289062
Epoch: 4, Steps: 123 | Train Loss: 0.5071049 Vali Loss: 0.5403237 Best vali loss: 0.5403237
	iters: 100, epoch: 5 | loss: 0.5717897
	speed: 0.0093s/iter; left time: 3.6626s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5403 --> 0.5283).  Saving model state dict ...
Epoch: 5 cost time: 0.7244617938995361
Epoch: 5, Steps: 123 | Train Loss: 0.5717897 Vali Loss: 0.5283001 Best vali loss: 0.5283001
	iters: 100, epoch: 6 | loss: 0.6220881
	speed: 0.0093s/iter; left time: 2.4980s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5283 --> 0.5276).  Saving model state dict ...
Epoch: 6 cost time: 0.7244007587432861
Epoch: 6, Steps: 123 | Train Loss: 0.6220881 Vali Loss: 0.5276355 Best vali loss: 0.5276355
	iters: 100, epoch: 7 | loss: 0.5762806
	speed: 0.0093s/iter; left time: 1.3716s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5276 --> 0.5250).  Saving model state dict ...
Epoch: 7 cost time: 0.7240135669708252
Epoch: 7, Steps: 123 | Train Loss: 0.5762806 Vali Loss: 0.5250121 Best vali loss: 0.5250121
	iters: 100, epoch: 8 | loss: 0.7416102
	speed: 0.0093s/iter; left time: 0.2222s
Updating learning rate to 0.0
Validation loss decreased (0.5250 --> 0.5236).  Saving model state dict ...
Epoch: 8 cost time: 0.7205970287322998
Epoch: 8, Steps: 123 | Train Loss: 0.7416102 Vali Loss: 0.5235851 Best vali loss: 0.5235851

best validation loss 0.5235850688540676

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2503031
	speed: 0.0123s/iter; left time: 10.8492s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6097).  Saving model state dict ...
Epoch: 1 cost time: 1.0917587280273438
Epoch: 1, Steps: 123 | Train Loss: 1.2503031 Vali Loss: 0.6097466 Best vali loss: 0.6097466
	iters: 100, epoch: 2 | loss: 0.9654905
	speed: 0.0099s/iter; left time: 7.5636s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6097 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 0.7839603424072266
Epoch: 2, Steps: 123 | Train Loss: 0.9654905 Vali Loss: 0.6043958 Best vali loss: 0.6043958
	iters: 100, epoch: 3 | loss: 0.6879352
	speed: 0.0101s/iter; left time: 6.4604s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.6044 --> 0.5563).  Saving model state dict ...
Epoch: 3 cost time: 0.780522346496582
Epoch: 3, Steps: 123 | Train Loss: 0.6879352 Vali Loss: 0.5562700 Best vali loss: 0.5562700
	iters: 100, epoch: 4 | loss: 0.8639761
	speed: 0.0100s/iter; left time: 5.1488s
Updating learning rate to 8.79186073e-05
Epoch: 4 cost time: 0.7809789180755615
Epoch: 4, Steps: 123 | Train Loss: 0.8639761 Vali Loss: 0.5663556 Best vali loss: 0.5562700
	iters: 100, epoch: 5 | loss: 0.7226846
	speed: 0.0096s/iter; left time: 3.7617s
Updating learning rate to 5.427361288967756e-05
Epoch: 5 cost time: 0.7748215198516846
Epoch: 5, Steps: 123 | Train Loss: 0.7226846 Vali Loss: 0.5707506 Best vali loss: 0.5562700
	iters: 100, epoch: 6 | loss: 0.6959876
	speed: 0.0098s/iter; left time: 2.6337s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7829713821411133
Epoch: 6, Steps: 123 | Train Loss: 0.6959876 Vali Loss: 0.5576632 Best vali loss: 0.5562700
	iters: 100, epoch: 7 | loss: 0.4906308
	speed: 0.0097s/iter; left time: 1.4255s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.7752354145050049
Epoch: 7, Steps: 123 | Train Loss: 0.4906308 Vali Loss: 0.5563646 Best vali loss: 0.5562700
	iters: 100, epoch: 8 | loss: 0.5828506
	speed: 0.0096s/iter; left time: 0.2308s
Updating learning rate to 0.0
Validation loss decreased (0.5563 --> 0.5534).  Saving model state dict ...
Epoch: 8 cost time: 0.7731404304504395
Epoch: 8, Steps: 123 | Train Loss: 0.5828506 Vali Loss: 0.5533900 Best vali loss: 0.5533900

best validation loss 0.553390048268436

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0043976689674, 'e_layers': 2, 'learning_rate': 0.0001762950642, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2503433
	speed: 0.0121s/iter; left time: 10.7350s
Updating learning rate to 0.00016958523284857165
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 1.0759618282318115
Epoch: 1, Steps: 123 | Train Loss: 1.2503433 Vali Loss: 0.6098458 Best vali loss: 0.6098458
	iters: 100, epoch: 2 | loss: 0.9648194
	speed: 0.0099s/iter; left time: 7.5361s
Updating learning rate to 0.00015047724979276887
Validation loss decreased (0.6098 --> 0.6041).  Saving model state dict ...
Epoch: 2 cost time: 0.7747259140014648
Epoch: 2, Steps: 123 | Train Loss: 0.9648194 Vali Loss: 0.6040810 Best vali loss: 0.6040810
	iters: 100, epoch: 3 | loss: 0.6879859
	speed: 0.0099s/iter; left time: 6.3064s
Updating learning rate to 0.00012188013223853993
Validation loss decreased (0.6041 --> 0.5611).  Saving model state dict ...
Epoch: 3 cost time: 0.7707562446594238
Epoch: 3, Steps: 123 | Train Loss: 0.6879859 Vali Loss: 0.5611435 Best vali loss: 0.5611435

best validation loss 0.5611434624681645

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0016685003108, 'e_layers': 3, 'learning_rate': 7.01523206e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.748230688025496e-05
Validation loss decreased (inf --> 0.6679).  Saving model state dict ...
Epoch: 1 cost time: 0.7591977119445801
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6678536 Best vali loss: 0.6678536
Updating learning rate to 5.987875110611636e-05
Validation loss decreased (0.6679 --> 0.6411).  Saving model state dict ...
Epoch: 2 cost time: 0.453399658203125
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6410964 Best vali loss: 0.6410964
Updating learning rate to 4.84992257177921e-05
Validation loss decreased (0.6411 --> 0.6261).  Saving model state dict ...
Epoch: 3 cost time: 0.45371294021606445
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6260919 Best vali loss: 0.6260919

best validation loss 0.6260918819314073

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0043985671968, 'e_layers': 2, 'learning_rate': 0.0001758432838, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2503678
	speed: 0.0120s/iter; left time: 10.6594s
Updating learning rate to 0.00016915064731619676
Validation loss decreased (inf --> 0.6097).  Saving model state dict ...
Epoch: 1 cost time: 1.0740203857421875
Epoch: 1, Steps: 123 | Train Loss: 1.2503678 Vali Loss: 0.6097025 Best vali loss: 0.6097025
	iters: 100, epoch: 2 | loss: 0.9647362
	speed: 0.0100s/iter; left time: 7.6175s
Updating learning rate to 0.0001500916311005453
Validation loss decreased (0.6097 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 0.7800803184509277
Epoch: 2, Steps: 123 | Train Loss: 0.9647362 Vali Loss: 0.6037859 Best vali loss: 0.6037859
	iters: 100, epoch: 3 | loss: 0.6892235
	speed: 0.0102s/iter; left time: 6.4911s
Updating learning rate to 0.0001215677976014663
Validation loss decreased (0.6038 --> 0.5597).  Saving model state dict ...
Epoch: 3 cost time: 0.7805111408233643
Epoch: 3, Steps: 123 | Train Loss: 0.6892235 Vali Loss: 0.5596566 Best vali loss: 0.5596566

best validation loss 0.5596566044418197

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0043985671968, 'e_layers': 2, 'learning_rate': 0.0001758432838, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0225044
	speed: 0.0125s/iter; left time: 6.4426s
Updating learning rate to 8.79216419e-05
Epoch: 4 cost time: 1.0804872512817383
Epoch: 4, Steps: 123 | Train Loss: 1.0225044 Vali Loss: 0.5611847 Best vali loss: 0.5596566
	iters: 100, epoch: 5 | loss: 0.8254536
	speed: 0.0096s/iter; left time: 3.7865s
Updating learning rate to 5.4275486198533715e-05
Epoch: 5 cost time: 0.7743227481842041
Epoch: 5, Steps: 123 | Train Loss: 0.8254536 Vali Loss: 0.5623038 Best vali loss: 0.5596566
	iters: 100, epoch: 6 | loss: 0.6600783
	speed: 0.0095s/iter; left time: 2.5707s
Updating learning rate to 2.5751652699454717e-05
Validation loss decreased (0.5597 --> 0.5558).  Saving model state dict ...
Epoch: 6 cost time: 0.7694766521453857
Epoch: 6, Steps: 123 | Train Loss: 0.6600783 Vali Loss: 0.5557660 Best vali loss: 0.5557660
	iters: 100, epoch: 7 | loss: 0.8222710
	speed: 0.0101s/iter; left time: 1.4887s
Updating learning rate to 6.69263648380324e-06
Validation loss decreased (0.5558 --> 0.5545).  Saving model state dict ...
Epoch: 7 cost time: 0.7739386558532715
Epoch: 7, Steps: 123 | Train Loss: 0.8222710 Vali Loss: 0.5545290 Best vali loss: 0.5545290
	iters: 100, epoch: 8 | loss: 0.7133159
	speed: 0.0100s/iter; left time: 0.2400s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7683351039886475
Epoch: 8, Steps: 123 | Train Loss: 0.7133159 Vali Loss: 0.5565544 Best vali loss: 0.5545290

best validation loss 0.554529040762254

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.004343664277, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0933752
	speed: 0.0109s/iter; left time: 9.6096s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 0.9265892505645752
Epoch: 1, Steps: 123 | Train Loss: 1.0933752 Vali Loss: 0.6699120 Best vali loss: 0.6699120
	iters: 100, epoch: 2 | loss: 0.8478754
	speed: 0.0075s/iter; left time: 5.7144s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6699 --> 0.6422).  Saving model state dict ...
Epoch: 2 cost time: 0.55953049659729
Epoch: 2, Steps: 123 | Train Loss: 0.8478754 Vali Loss: 0.6421904 Best vali loss: 0.6421904
	iters: 100, epoch: 3 | loss: 0.9624729
	speed: 0.0072s/iter; left time: 4.6183s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.6422 --> 0.6291).  Saving model state dict ...
Epoch: 3 cost time: 0.5587782859802246
Epoch: 3, Steps: 123 | Train Loss: 0.9624729 Vali Loss: 0.6290850 Best vali loss: 0.6290850
	iters: 100, epoch: 4 | loss: 0.6998508
	speed: 0.0071s/iter; left time: 3.6803s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.6291 --> 0.6229).  Saving model state dict ...
Epoch: 4 cost time: 0.5552480220794678
Epoch: 4, Steps: 123 | Train Loss: 0.6998508 Vali Loss: 0.6228685 Best vali loss: 0.6228685
	iters: 100, epoch: 5 | loss: 0.6188334
	speed: 0.0072s/iter; left time: 2.8167s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.6229 --> 0.6174).  Saving model state dict ...
Epoch: 5 cost time: 0.5501890182495117
Epoch: 5, Steps: 123 | Train Loss: 0.6188334 Vali Loss: 0.6173795 Best vali loss: 0.6173795
	iters: 100, epoch: 6 | loss: 0.8160788
	speed: 0.0076s/iter; left time: 2.0581s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.6174 --> 0.6152).  Saving model state dict ...
Epoch: 6 cost time: 0.6105680465698242
Epoch: 6, Steps: 123 | Train Loss: 0.8160788 Vali Loss: 0.6152407 Best vali loss: 0.6152407
	iters: 100, epoch: 7 | loss: 0.7100579
	speed: 0.0075s/iter; left time: 1.1058s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.6152 --> 0.6143).  Saving model state dict ...
Epoch: 7 cost time: 0.5761682987213135
Epoch: 7, Steps: 123 | Train Loss: 0.7100579 Vali Loss: 0.6143106 Best vali loss: 0.6143106
	iters: 100, epoch: 8 | loss: 0.8565491
	speed: 0.0071s/iter; left time: 0.1715s
Updating learning rate to 0.0
Validation loss decreased (0.6143 --> 0.6140).  Saving model state dict ...
Epoch: 8 cost time: 0.565086841583252
Epoch: 8, Steps: 123 | Train Loss: 0.8565491 Vali Loss: 0.6140316 Best vali loss: 0.6140316

best validation loss 0.6140315967652049

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043910382713, 'e_layers': 2, 'learning_rate': 0.0001612669615, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7599514
	speed: 0.0119s/iter; left time: 10.5166s
Updating learning rate to 0.00015512910325006784
Validation loss decreased (inf --> 0.6062).  Saving model state dict ...
Epoch: 1 cost time: 1.043257474899292
Epoch: 1, Steps: 123 | Train Loss: 0.7599514 Vali Loss: 0.6062117 Best vali loss: 0.6062117
	iters: 100, epoch: 2 | loss: 0.9345847
	speed: 0.0092s/iter; left time: 7.0151s
Updating learning rate to 0.00013764996177899994
Validation loss decreased (0.6062 --> 0.5647).  Saving model state dict ...
Epoch: 2 cost time: 0.7142956256866455
Epoch: 2, Steps: 123 | Train Loss: 0.9345847 Vali Loss: 0.5646787 Best vali loss: 0.5646787
	iters: 100, epoch: 3 | loss: 0.8583449
	speed: 0.0094s/iter; left time: 6.0126s
Updating learning rate to 0.0001114905779269544
Validation loss decreased (0.5647 --> 0.5476).  Saving model state dict ...
Epoch: 3 cost time: 0.7239611148834229
Epoch: 3, Steps: 123 | Train Loss: 0.8583449 Vali Loss: 0.5476021 Best vali loss: 0.5476021
	iters: 100, epoch: 4 | loss: 0.5038000
	speed: 0.0093s/iter; left time: 4.8002s
Updating learning rate to 8.063348075e-05
Validation loss decreased (0.5476 --> 0.5461).  Saving model state dict ...
Epoch: 4 cost time: 0.723717212677002
Epoch: 4, Steps: 123 | Train Loss: 0.5038000 Vali Loss: 0.5461461 Best vali loss: 0.5461461
	iters: 100, epoch: 5 | loss: 0.5738876
	speed: 0.0092s/iter; left time: 3.6336s
Updating learning rate to 4.977638357304561e-05
Validation loss decreased (0.5461 --> 0.5342).  Saving model state dict ...
Epoch: 5 cost time: 0.7315719127655029
Epoch: 5, Steps: 123 | Train Loss: 0.5738876 Vali Loss: 0.5342159 Best vali loss: 0.5342159
	iters: 100, epoch: 6 | loss: 0.6239769
	speed: 0.0094s/iter; left time: 2.5498s
Updating learning rate to 2.3616999721000064e-05
Validation loss decreased (0.5342 --> 0.5327).  Saving model state dict ...
Epoch: 6 cost time: 0.7297370433807373
Epoch: 6, Steps: 123 | Train Loss: 0.6239769 Vali Loss: 0.5326614 Best vali loss: 0.5326614
	iters: 100, epoch: 7 | loss: 0.5819778
	speed: 0.0094s/iter; left time: 1.3810s
Updating learning rate to 6.137858249932162e-06
Validation loss decreased (0.5327 --> 0.5275).  Saving model state dict ...
Epoch: 7 cost time: 0.7236058712005615
Epoch: 7, Steps: 123 | Train Loss: 0.5819778 Vali Loss: 0.5275120 Best vali loss: 0.5275120
	iters: 100, epoch: 8 | loss: 0.7476971
	speed: 0.0094s/iter; left time: 0.2245s
Updating learning rate to 0.0
Validation loss decreased (0.5275 --> 0.5252).  Saving model state dict ...
Epoch: 8 cost time: 0.7191524505615234
Epoch: 8, Steps: 123 | Train Loss: 0.7476971 Vali Loss: 0.5252165 Best vali loss: 0.5252165

best validation loss 0.525216497960106

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001677493996, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7607335
	speed: 0.0119s/iter; left time: 10.5275s
Updating learning rate to 0.0001613648182407485
Validation loss decreased (inf --> 0.6069).  Saving model state dict ...
Epoch: 1 cost time: 1.0364317893981934
Epoch: 1, Steps: 123 | Train Loss: 0.7607335 Vali Loss: 0.6068543 Best vali loss: 0.6068543
	iters: 100, epoch: 2 | loss: 0.9407573
	speed: 0.0093s/iter; left time: 7.1018s
Updating learning rate to 0.00014318306879856595
Validation loss decreased (0.6069 --> 0.5781).  Saving model state dict ...
Epoch: 2 cost time: 0.7278826236724854
Epoch: 2, Steps: 123 | Train Loss: 0.9407573 Vali Loss: 0.5780881 Best vali loss: 0.5780881
	iters: 100, epoch: 3 | loss: 0.8658862
	speed: 0.0094s/iter; left time: 6.0378s
Updating learning rate to 0.00011597215780805552
Validation loss decreased (0.5781 --> 0.5477).  Saving model state dict ...
Epoch: 3 cost time: 0.7248759269714355
Epoch: 3, Steps: 123 | Train Loss: 0.8658862 Vali Loss: 0.5477001 Best vali loss: 0.5477001

best validation loss 0.5477001387617313

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0093071111658, 'e_layers': 1, 'learning_rate': 0.00113935621, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9308941
	speed: 0.0087s/iter; left time: 67.0938s
	iters: 200, epoch: 1 | loss: 1.0318758
	speed: 0.0025s/iter; left time: 19.2313s
	iters: 300, epoch: 1 | loss: 0.7707284
	speed: 0.0024s/iter; left time: 17.8382s
	iters: 400, epoch: 1 | loss: 0.2930546
	speed: 0.0024s/iter; left time: 17.4916s
	iters: 500, epoch: 1 | loss: 1.2382829
	speed: 0.0024s/iter; left time: 17.8142s
	iters: 600, epoch: 1 | loss: 0.5448286
	speed: 0.0026s/iter; left time: 18.4931s
	iters: 700, epoch: 1 | loss: 1.2718720
	speed: 0.0026s/iter; left time: 18.2784s
	iters: 800, epoch: 1 | loss: 2.1031935
	speed: 0.0026s/iter; left time: 18.0883s
	iters: 900, epoch: 1 | loss: 0.3426713
	speed: 0.0025s/iter; left time: 17.5436s
Updating learning rate to 0.0010959920463293157
Validation loss decreased (inf --> 0.6015).  Saving model state dict ...
Epoch: 1 cost time: 2.7757556438446045
Epoch: 1, Steps: 979 | Train Loss: 0.9474890 Vali Loss: 0.6014501 Best vali loss: 0.6014501
	iters: 100, epoch: 2 | loss: 0.2686590
	speed: 0.0091s/iter; left time: 61.5664s
	iters: 200, epoch: 2 | loss: 1.5856501
	speed: 0.0025s/iter; left time: 16.6387s
	iters: 300, epoch: 2 | loss: 0.5637137
	speed: 0.0025s/iter; left time: 16.4603s
	iters: 400, epoch: 2 | loss: 0.9925289
	speed: 0.0025s/iter; left time: 15.8789s
	iters: 500, epoch: 2 | loss: 1.0840044
	speed: 0.0025s/iter; left time: 15.8517s
	iters: 600, epoch: 2 | loss: 0.7868045
	speed: 0.0025s/iter; left time: 15.5599s
	iters: 700, epoch: 2 | loss: 0.8045586
	speed: 0.0024s/iter; left time: 14.9125s
	iters: 800, epoch: 2 | loss: 0.6864330
	speed: 0.0022s/iter; left time: 13.5722s
	iters: 900, epoch: 2 | loss: 0.5117491
	speed: 0.0023s/iter; left time: 13.5214s
Updating learning rate to 0.000972501356139002
Epoch: 2 cost time: 2.4125444889068604
Epoch: 2, Steps: 979 | Train Loss: 0.8093446 Vali Loss: 0.6186727 Best vali loss: 0.6014501
	iters: 100, epoch: 3 | loss: 1.1877967
	speed: 0.0091s/iter; left time: 52.3579s
	iters: 200, epoch: 3 | loss: 0.3265942
	speed: 0.0026s/iter; left time: 14.7405s
	iters: 300, epoch: 3 | loss: 0.8760731
	speed: 0.0025s/iter; left time: 13.7110s
	iters: 400, epoch: 3 | loss: 0.8365605
	speed: 0.0025s/iter; left time: 13.8623s
	iters: 500, epoch: 3 | loss: 0.7639126
	speed: 0.0025s/iter; left time: 13.6317s
	iters: 600, epoch: 3 | loss: 0.2928590
	speed: 0.0025s/iter; left time: 13.3374s
	iters: 700, epoch: 3 | loss: 1.1397837
	speed: 0.0026s/iter; left time: 13.4144s
	iters: 800, epoch: 3 | loss: 0.6159564
	speed: 0.0026s/iter; left time: 13.2070s
	iters: 900, epoch: 3 | loss: 0.4074027
	speed: 0.0026s/iter; left time: 12.8629s
Updating learning rate to 0.00078768447756464
Epoch: 3 cost time: 2.565364360809326
Epoch: 3, Steps: 979 | Train Loss: 0.7163266 Vali Loss: 0.6365535 Best vali loss: 0.6014501

best validation loss 0.601450070607778

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009648878104, 'e_layers': 1, 'learning_rate': 0.0042098780726, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7667605
	speed: 0.0093s/iter; left time: 17.2265s
	iters: 200, epoch: 1 | loss: 0.9297843
	speed: 0.0031s/iter; left time: 5.4263s
Updating learning rate to 0.0042098780726
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 1.089745283126831
Epoch: 1, Steps: 245 | Train Loss: 0.8482724 Vali Loss: 0.6069560 Best vali loss: 0.6069560
	iters: 100, epoch: 2 | loss: 0.6568115
	speed: 0.0067s/iter; left time: 10.8352s
	iters: 200, epoch: 2 | loss: 1.1308111
	speed: 0.0030s/iter; left time: 4.4802s
Updating learning rate to 0.0021049390363
Epoch: 2 cost time: 0.7815303802490234
Epoch: 2, Steps: 245 | Train Loss: 0.8938113 Vali Loss: 0.6306776 Best vali loss: 0.6069560
	iters: 100, epoch: 3 | loss: 0.5170317
	speed: 0.0068s/iter; left time: 9.2634s
	iters: 200, epoch: 3 | loss: 0.6696219
	speed: 0.0031s/iter; left time: 3.9089s
Updating learning rate to 0.00105246951815
Epoch: 3 cost time: 0.8055384159088135
Epoch: 3, Steps: 245 | Train Loss: 0.5933268 Vali Loss: 0.6244161 Best vali loss: 0.6069560

best validation loss 0.6069559645785164

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001677493996, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6019279
	speed: 0.0121s/iter; left time: 6.2424s
Updating learning rate to 8.38746998e-05
Validation loss decreased (0.5477 --> 0.5367).  Saving model state dict ...
Epoch: 4 cost time: 1.0382728576660156
Epoch: 4, Steps: 123 | Train Loss: 0.6019279 Vali Loss: 0.5367178 Best vali loss: 0.5367178
	iters: 100, epoch: 5 | loss: 0.8507955
	speed: 0.0094s/iter; left time: 3.6877s
Updating learning rate to 5.1777241791944494e-05
Validation loss decreased (0.5367 --> 0.5298).  Saving model state dict ...
Epoch: 5 cost time: 0.711622953414917
Epoch: 5, Steps: 123 | Train Loss: 0.8507955 Vali Loss: 0.5298400 Best vali loss: 0.5298400
	iters: 100, epoch: 6 | loss: 0.7986007
	speed: 0.0094s/iter; left time: 2.5407s
Updating learning rate to 2.4566330801434044e-05
Epoch: 6 cost time: 0.7218482494354248
Epoch: 6, Steps: 123 | Train Loss: 0.7986007 Vali Loss: 0.5304576 Best vali loss: 0.5298400
	iters: 100, epoch: 7 | loss: 0.4817403
	speed: 0.0091s/iter; left time: 1.3340s
Updating learning rate to 6.384581359251485e-06
Epoch: 7 cost time: 0.7129027843475342
Epoch: 7, Steps: 123 | Train Loss: 0.4817403 Vali Loss: 0.5309572 Best vali loss: 0.5298400
	iters: 100, epoch: 8 | loss: 0.5542508
	speed: 0.0090s/iter; left time: 0.2162s
Updating learning rate to 0.0
Validation loss decreased (0.5298 --> 0.5271).  Saving model state dict ...
Epoch: 8 cost time: 0.7243752479553223
Epoch: 8, Steps: 123 | Train Loss: 0.5542508 Vali Loss: 0.5271449 Best vali loss: 0.5271449

best validation loss 0.5271448814058017

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001762628226, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617166
	speed: 0.0117s/iter; left time: 10.3176s
Updating learning rate to 0.0001762628226
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.017057180404663
Epoch: 1, Steps: 123 | Train Loss: 0.7617166 Vali Loss: 0.6075941 Best vali loss: 0.6075941
	iters: 100, epoch: 2 | loss: 0.9366608
	speed: 0.0092s/iter; left time: 7.0115s
Updating learning rate to 8.81314113e-05
Validation loss decreased (0.6076 --> 0.5720).  Saving model state dict ...
Epoch: 2 cost time: 0.7182061672210693
Epoch: 2, Steps: 123 | Train Loss: 0.9366608 Vali Loss: 0.5719795 Best vali loss: 0.5719795
	iters: 100, epoch: 3 | loss: 0.8586947
	speed: 0.0094s/iter; left time: 6.0265s
Updating learning rate to 4.406570565e-05
Validation loss decreased (0.5720 --> 0.5529).  Saving model state dict ...
Epoch: 3 cost time: 0.7210373878479004
Epoch: 3, Steps: 123 | Train Loss: 0.8586947 Vali Loss: 0.5529461 Best vali loss: 0.5529461
	iters: 100, epoch: 4 | loss: 0.4944532
	speed: 0.0093s/iter; left time: 4.7731s
Updating learning rate to 2.2032852825e-05
Validation loss decreased (0.5529 --> 0.5475).  Saving model state dict ...
Epoch: 4 cost time: 0.7213680744171143
Epoch: 4, Steps: 123 | Train Loss: 0.4944532 Vali Loss: 0.5474853 Best vali loss: 0.5474853
	iters: 100, epoch: 5 | loss: 0.5844879
	speed: 0.0093s/iter; left time: 3.6591s
Updating learning rate to 1.10164264125e-05
Validation loss decreased (0.5475 --> 0.5405).  Saving model state dict ...
Epoch: 5 cost time: 0.71596360206604
Epoch: 5, Steps: 123 | Train Loss: 0.5844879 Vali Loss: 0.5405067 Best vali loss: 0.5405067
	iters: 100, epoch: 6 | loss: 0.6276289
	speed: 0.0093s/iter; left time: 2.5103s
Updating learning rate to 5.50821320625e-06
Validation loss decreased (0.5405 --> 0.5373).  Saving model state dict ...
Epoch: 6 cost time: 0.7189369201660156
Epoch: 6, Steps: 123 | Train Loss: 0.6276289 Vali Loss: 0.5373151 Best vali loss: 0.5373151
	iters: 100, epoch: 7 | loss: 0.6114423
	speed: 0.0093s/iter; left time: 1.3701s
Updating learning rate to 2.754106603125e-06
Validation loss decreased (0.5373 --> 0.5368).  Saving model state dict ...
Epoch: 7 cost time: 0.7215309143066406
Epoch: 7, Steps: 123 | Train Loss: 0.6114423 Vali Loss: 0.5367824 Best vali loss: 0.5367824
	iters: 100, epoch: 8 | loss: 0.7718898
	speed: 0.0092s/iter; left time: 0.2217s
Updating learning rate to 1.3770533015625e-06
Validation loss decreased (0.5368 --> 0.5346).  Saving model state dict ...
Epoch: 8 cost time: 0.7237949371337891
Epoch: 8, Steps: 123 | Train Loss: 0.7718898 Vali Loss: 0.5346228 Best vali loss: 0.5346228

best validation loss 0.5346227874363092

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043994268797, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617147
	speed: 0.0118s/iter; left time: 10.4295s
Updating learning rate to 0.0001758372146
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0265967845916748
Epoch: 1, Steps: 123 | Train Loss: 0.7617147 Vali Loss: 0.6075682 Best vali loss: 0.6075682
	iters: 100, epoch: 2 | loss: 0.9373876
	speed: 0.0092s/iter; left time: 7.0460s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.6076 --> 0.5717).  Saving model state dict ...
Epoch: 2 cost time: 0.7333672046661377
Epoch: 2, Steps: 123 | Train Loss: 0.9373876 Vali Loss: 0.5716970 Best vali loss: 0.5716970
	iters: 100, epoch: 3 | loss: 0.8652204
	speed: 0.0095s/iter; left time: 6.0439s
Updating learning rate to 4.395930365e-05
Validation loss decreased (0.5717 --> 0.5509).  Saving model state dict ...
Epoch: 3 cost time: 0.7221379280090332
Epoch: 3, Steps: 123 | Train Loss: 0.8652204 Vali Loss: 0.5508601 Best vali loss: 0.5508601
	iters: 100, epoch: 4 | loss: 0.4955506
	speed: 0.0093s/iter; left time: 4.7752s
Updating learning rate to 2.1979651825e-05
Validation loss decreased (0.5509 --> 0.5447).  Saving model state dict ...
Epoch: 4 cost time: 0.7180705070495605
Epoch: 4, Steps: 123 | Train Loss: 0.4955506 Vali Loss: 0.5447472 Best vali loss: 0.5447472
	iters: 100, epoch: 5 | loss: 0.5832127
	speed: 0.0093s/iter; left time: 3.6387s
Updating learning rate to 1.09898259125e-05
Validation loss decreased (0.5447 --> 0.5389).  Saving model state dict ...
Epoch: 5 cost time: 0.7193608283996582
Epoch: 5, Steps: 123 | Train Loss: 0.5832127 Vali Loss: 0.5388700 Best vali loss: 0.5388700
	iters: 100, epoch: 6 | loss: 0.6287103
	speed: 0.0093s/iter; left time: 2.5191s
Updating learning rate to 5.49491295625e-06
Validation loss decreased (0.5389 --> 0.5338).  Saving model state dict ...
Epoch: 6 cost time: 0.7259340286254883
Epoch: 6, Steps: 123 | Train Loss: 0.6287103 Vali Loss: 0.5337965 Best vali loss: 0.5337965
	iters: 100, epoch: 7 | loss: 0.6128827
	speed: 0.0093s/iter; left time: 1.3718s
Updating learning rate to 2.747456478125e-06
Epoch: 7 cost time: 0.7253594398498535
Epoch: 7, Steps: 123 | Train Loss: 0.6128827 Vali Loss: 0.5342045 Best vali loss: 0.5337965
	iters: 100, epoch: 8 | loss: 0.7690487
	speed: 0.0090s/iter; left time: 0.2170s
Updating learning rate to 1.3737282390625e-06
Validation loss decreased (0.5338 --> 0.5319).  Saving model state dict ...
Epoch: 8 cost time: 0.7192552089691162
Epoch: 8, Steps: 123 | Train Loss: 0.7690487 Vali Loss: 0.5318739 Best vali loss: 0.5318739

best validation loss 0.5318739445658538

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043891091461, 'e_layers': 2, 'learning_rate': 0.0001619019395, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7600779
	speed: 0.0117s/iter; left time: 10.3370s
Updating learning rate to 0.0001557399138389653
Validation loss decreased (inf --> 0.6063).  Saving model state dict ...
Epoch: 1 cost time: 1.0311694145202637
Epoch: 1, Steps: 123 | Train Loss: 0.7600779 Vali Loss: 0.6062621 Best vali loss: 0.6062621
	iters: 100, epoch: 2 | loss: 0.9282861
	speed: 0.0093s/iter; left time: 7.0668s
Updating learning rate to 0.00013819194940385208
Validation loss decreased (0.6063 --> 0.5597).  Saving model state dict ...
Epoch: 2 cost time: 0.7230503559112549
Epoch: 2, Steps: 123 | Train Loss: 0.9282861 Vali Loss: 0.5596898 Best vali loss: 0.5596898
	iters: 100, epoch: 3 | loss: 0.8596755
	speed: 0.0093s/iter; left time: 5.9393s
Updating learning rate to 0.00011192956470721257
Validation loss decreased (0.5597 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 0.7244737148284912
Epoch: 3, Steps: 123 | Train Loss: 0.8596755 Vali Loss: 0.5520873 Best vali loss: 0.5520873

best validation loss 0.5520872534672897

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043935043026, 'e_layers': 2, 'learning_rate': 0.0001688965273, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7608676
	speed: 0.0114s/iter; left time: 10.1294s
Updating learning rate to 0.0001624682859923519
Validation loss decreased (inf --> 0.6069).  Saving model state dict ...
Epoch: 1 cost time: 1.013514518737793
Epoch: 1, Steps: 123 | Train Loss: 0.7608676 Vali Loss: 0.6069265 Best vali loss: 0.6069265
	iters: 100, epoch: 2 | loss: 0.9377807
	speed: 0.0092s/iter; left time: 6.9831s
Updating learning rate to 0.00014416220353634441
Validation loss decreased (0.6069 --> 0.5726).  Saving model state dict ...
Epoch: 2 cost time: 0.7187657356262207
Epoch: 2, Steps: 123 | Train Loss: 0.9377807 Vali Loss: 0.5725977 Best vali loss: 0.5725977
	iters: 100, epoch: 3 | loss: 0.8597943
	speed: 0.0094s/iter; left time: 5.9921s
Updating learning rate to 0.00011676521504085404
Validation loss decreased (0.5726 --> 0.5486).  Saving model state dict ...
Epoch: 3 cost time: 0.7254960536956787
Epoch: 3, Steps: 123 | Train Loss: 0.8597943 Vali Loss: 0.5485934 Best vali loss: 0.5485934

best validation loss 0.5485934157274432

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010461313189, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745506
	speed: 0.0118s/iter; left time: 10.4424s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0378568172454834
Epoch: 1, Steps: 123 | Train Loss: 0.7745506 Vali Loss: 0.6171797 Best vali loss: 0.6171797
	iters: 100, epoch: 2 | loss: 0.9471020
	speed: 0.0092s/iter; left time: 7.0284s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6172 --> 0.5741).  Saving model state dict ...
Epoch: 2 cost time: 0.7230949401855469
Epoch: 2, Steps: 123 | Train Loss: 0.9471020 Vali Loss: 0.5740921 Best vali loss: 0.5740921
	iters: 100, epoch: 3 | loss: 0.8490227
	speed: 0.0094s/iter; left time: 6.0355s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5741 --> 0.5598).  Saving model state dict ...
Epoch: 3 cost time: 0.7272617816925049
Epoch: 3, Steps: 123 | Train Loss: 0.8490227 Vali Loss: 0.5598481 Best vali loss: 0.5598481

best validation loss 0.559848103904989

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043935043026, 'e_layers': 2, 'learning_rate': 0.0001688965273, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6027786
	speed: 0.0125s/iter; left time: 6.4406s
Updating learning rate to 8.444826365e-05
Validation loss decreased (0.5486 --> 0.5381).  Saving model state dict ...
Epoch: 4 cost time: 1.0226914882659912
Epoch: 4, Steps: 123 | Train Loss: 0.6027786 Vali Loss: 0.5380979 Best vali loss: 0.5380979
	iters: 100, epoch: 5 | loss: 0.8512455
	speed: 0.0093s/iter; left time: 3.6505s
Updating learning rate to 5.213131225914596e-05
Validation loss decreased (0.5381 --> 0.5332).  Saving model state dict ...
Epoch: 5 cost time: 0.7203636169433594
Epoch: 5, Steps: 123 | Train Loss: 0.8512455 Vali Loss: 0.5331650 Best vali loss: 0.5331650
	iters: 100, epoch: 6 | loss: 0.8044192
	speed: 0.0093s/iter; left time: 2.5114s
Updating learning rate to 2.473432376365558e-05
Validation loss decreased (0.5332 --> 0.5316).  Saving model state dict ...
Epoch: 6 cost time: 0.7202117443084717
Epoch: 6, Steps: 123 | Train Loss: 0.8044192 Vali Loss: 0.5316280 Best vali loss: 0.5316280
	iters: 100, epoch: 7 | loss: 0.4840519
	speed: 0.0092s/iter; left time: 1.3572s
Updating learning rate to 6.428241307648111e-06
Epoch: 7 cost time: 0.7187256813049316
Epoch: 7, Steps: 123 | Train Loss: 0.4840519 Vali Loss: 0.5319553 Best vali loss: 0.5316280
	iters: 100, epoch: 8 | loss: 0.5546441
	speed: 0.0090s/iter; left time: 0.2159s
Updating learning rate to 0.0
Validation loss decreased (0.5316 --> 0.5281).  Saving model state dict ...
Epoch: 8 cost time: 0.723822832107544
Epoch: 8, Steps: 123 | Train Loss: 0.5546441 Vali Loss: 0.5280903 Best vali loss: 0.5280903

best validation loss 0.5280902547893674

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0071172473201, 'e_layers': 3, 'learning_rate': 0.0003421153584, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8052557
	speed: 0.0125s/iter; left time: 11.0785s
Updating learning rate to 0.00032909436789176164
Validation loss decreased (inf --> 0.6079).  Saving model state dict ...
Epoch: 1 cost time: 1.0761957168579102
Epoch: 1, Steps: 123 | Train Loss: 0.8052557 Vali Loss: 0.6079373 Best vali loss: 0.6079373
	iters: 100, epoch: 2 | loss: 0.9311576
	speed: 0.0093s/iter; left time: 7.0846s
Updating learning rate to 0.000292013724136353
Validation loss decreased (0.6079 --> 0.5608).  Saving model state dict ...
Epoch: 2 cost time: 0.7274694442749023
Epoch: 2, Steps: 123 | Train Loss: 0.9311576 Vali Loss: 0.5607956 Best vali loss: 0.5607956
	iters: 100, epoch: 3 | loss: 0.7566808
	speed: 0.0093s/iter; left time: 5.9718s
Updating learning rate to 0.00023651861900866243
Epoch: 3 cost time: 0.7460296154022217
Epoch: 3, Steps: 123 | Train Loss: 0.7566808 Vali Loss: 0.5611369 Best vali loss: 0.5607956
	iters: 100, epoch: 4 | loss: 0.5484161
	speed: 0.0092s/iter; left time: 4.7497s
Updating learning rate to 0.0001710576792
Epoch: 4 cost time: 0.7539477348327637
Epoch: 4, Steps: 123 | Train Loss: 0.5484161 Vali Loss: 0.5704428 Best vali loss: 0.5607956
	iters: 100, epoch: 5 | loss: 0.8315368
	speed: 0.0093s/iter; left time: 3.6540s
Updating learning rate to 0.00010559673939133758
Validation loss decreased (0.5608 --> 0.5451).  Saving model state dict ...
Epoch: 5 cost time: 0.749255895614624
Epoch: 5, Steps: 123 | Train Loss: 0.8315368 Vali Loss: 0.5450680 Best vali loss: 0.5450680
	iters: 100, epoch: 6 | loss: 0.6837481
	speed: 0.0094s/iter; left time: 2.5350s
Updating learning rate to 5.010163426364697e-05
Epoch: 6 cost time: 0.727816104888916
Epoch: 6, Steps: 123 | Train Loss: 0.6837481 Vali Loss: 0.5464764 Best vali loss: 0.5450680
	iters: 100, epoch: 7 | loss: 0.7718958
	speed: 0.0092s/iter; left time: 1.3457s
Updating learning rate to 1.3020990508238343e-05
Epoch: 7 cost time: 0.7455019950866699
Epoch: 7, Steps: 123 | Train Loss: 0.7718958 Vali Loss: 0.5474796 Best vali loss: 0.5450680
	iters: 100, epoch: 8 | loss: 0.8694836
	speed: 0.0091s/iter; left time: 0.2173s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7242128849029541
Epoch: 8, Steps: 123 | Train Loss: 0.8694836 Vali Loss: 0.5478948 Best vali loss: 0.5450680

best validation loss 0.5450680172592333

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0059023802652, 'e_layers': 3, 'learning_rate': 0.0003459417204, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8039700
	speed: 0.0118s/iter; left time: 10.4289s
Updating learning rate to 0.00033277509765965114
Validation loss decreased (inf --> 0.6158).  Saving model state dict ...
Epoch: 1 cost time: 1.054389476776123
Epoch: 1, Steps: 123 | Train Loss: 0.8039700 Vali Loss: 0.6158368 Best vali loss: 0.6158368
	iters: 100, epoch: 2 | loss: 0.9260897
	speed: 0.0093s/iter; left time: 7.0927s
Updating learning rate to 0.0002952797283950903
Validation loss decreased (0.6158 --> 0.5468).  Saving model state dict ...
Epoch: 2 cost time: 0.74098801612854
Epoch: 2, Steps: 123 | Train Loss: 0.9260897 Vali Loss: 0.5467729 Best vali loss: 0.5467729
	iters: 100, epoch: 3 | loss: 0.7808290
	speed: 0.0093s/iter; left time: 5.9572s
Updating learning rate to 0.0002391639426804781
Epoch: 3 cost time: 0.7312881946563721
Epoch: 3, Steps: 123 | Train Loss: 0.7808290 Vali Loss: 0.5655002 Best vali loss: 0.5467729
	iters: 100, epoch: 4 | loss: 0.5508897
	speed: 0.0092s/iter; left time: 4.7704s
Updating learning rate to 0.0001729708602
Validation loss decreased (0.5468 --> 0.5429).  Saving model state dict ...
Epoch: 4 cost time: 0.7514660358428955
Epoch: 4, Steps: 123 | Train Loss: 0.5508897 Vali Loss: 0.5428660 Best vali loss: 0.5428660
	iters: 100, epoch: 5 | loss: 0.8261624
	speed: 0.0095s/iter; left time: 3.7432s
Updating learning rate to 0.00010677777771952192
Validation loss decreased (0.5429 --> 0.5417).  Saving model state dict ...
Epoch: 5 cost time: 0.7420394420623779
Epoch: 5, Steps: 123 | Train Loss: 0.8261624 Vali Loss: 0.5416645 Best vali loss: 0.5416645
	iters: 100, epoch: 6 | loss: 0.6786437
	speed: 0.0094s/iter; left time: 2.5247s
Updating learning rate to 5.066199200490971e-05
Epoch: 6 cost time: 0.7383513450622559
Epoch: 6, Steps: 123 | Train Loss: 0.6786437 Vali Loss: 0.5446295 Best vali loss: 0.5416645
	iters: 100, epoch: 7 | loss: 0.7683158
	speed: 0.0091s/iter; left time: 1.3315s
Updating learning rate to 1.3166622740348867e-05
Epoch: 7 cost time: 0.736891508102417
Epoch: 7, Steps: 123 | Train Loss: 0.7683158 Vali Loss: 0.5476002 Best vali loss: 0.5416645
	iters: 100, epoch: 8 | loss: 0.8695458
	speed: 0.0091s/iter; left time: 0.2187s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7386035919189453
Epoch: 8, Steps: 123 | Train Loss: 0.8695458 Vali Loss: 0.5456525 Best vali loss: 0.5416645

best validation loss 0.5416644767223272

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043847626055, 'e_layers': 3, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6235372
	speed: 0.0138s/iter; left time: 12.1826s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5939).  Saving model state dict ...
Epoch: 1 cost time: 1.3009412288665771
Epoch: 1, Steps: 123 | Train Loss: 0.6235372 Vali Loss: 0.5939085 Best vali loss: 0.5939085
	iters: 100, epoch: 2 | loss: 0.7438833
	speed: 0.0123s/iter; left time: 9.3640s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.5939 --> 0.5571).  Saving model state dict ...
Epoch: 2 cost time: 0.9998884201049805
Epoch: 2, Steps: 123 | Train Loss: 0.7438833 Vali Loss: 0.5570863 Best vali loss: 0.5570863
	iters: 100, epoch: 3 | loss: 0.6338033
	speed: 0.0125s/iter; left time: 7.9971s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5571 --> 0.5499).  Saving model state dict ...
Epoch: 3 cost time: 0.999950647354126
Epoch: 3, Steps: 123 | Train Loss: 0.6338033 Vali Loss: 0.5498849 Best vali loss: 0.5498849

best validation loss 0.5498849251986322

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0038023873116, 'e_layers': 2, 'learning_rate': 0.0001771966177, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8855250
	speed: 0.0117s/iter; left time: 10.3638s
Updating learning rate to 0.0001704524730116286
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 1.0322558879852295
Epoch: 1, Steps: 123 | Train Loss: 0.8855250 Vali Loss: 0.6032893 Best vali loss: 0.6032893
	iters: 100, epoch: 2 | loss: 0.7597992
	speed: 0.0092s/iter; left time: 7.0146s
Updating learning rate to 0.0001512467738394951
Validation loss decreased (0.6033 --> 0.5578).  Saving model state dict ...
Epoch: 2 cost time: 0.7251136302947998
Epoch: 2, Steps: 123 | Train Loss: 0.7597992 Vali Loss: 0.5577961 Best vali loss: 0.5577961
	iters: 100, epoch: 3 | loss: 0.6303076
	speed: 0.0094s/iter; left time: 6.0090s
Updating learning rate to 0.00012250341378246032
Validation loss decreased (0.5578 --> 0.5545).  Saving model state dict ...
Epoch: 3 cost time: 0.7362973690032959
Epoch: 3, Steps: 123 | Train Loss: 0.6303076 Vali Loss: 0.5545305 Best vali loss: 0.5545305

best validation loss 0.5545305366981697

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0035117734093, 'e_layers': 2, 'learning_rate': 0.0001764157429, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8854043
	speed: 0.0119s/iter; left time: 10.5559s
Updating learning rate to 0.0001697013184890417
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 1.0516257286071777
Epoch: 1, Steps: 123 | Train Loss: 0.8854043 Vali Loss: 0.6032668 Best vali loss: 0.6032668
	iters: 100, epoch: 2 | loss: 0.7544331
	speed: 0.0094s/iter; left time: 7.1938s
Updating learning rate to 0.00015058025550632626
Validation loss decreased (0.6033 --> 0.5672).  Saving model state dict ...
Epoch: 2 cost time: 0.7430338859558105
Epoch: 2, Steps: 123 | Train Loss: 0.7544331 Vali Loss: 0.5671928 Best vali loss: 0.5671928
	iters: 100, epoch: 3 | loss: 0.6297106
	speed: 0.0094s/iter; left time: 6.0362s
Updating learning rate to 0.00012196356245810461
Validation loss decreased (0.5672 --> 0.5500).  Saving model state dict ...
Epoch: 3 cost time: 0.7357714176177979
Epoch: 3, Steps: 123 | Train Loss: 0.6297106 Vali Loss: 0.5500031 Best vali loss: 0.5500031

best validation loss 0.5500030778227775

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043847626055, 'e_layers': 3, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5484864
	speed: 0.0150s/iter; left time: 7.7479s
Updating learning rate to 8.79186073e-05
Epoch: 4 cost time: 1.300142526626587
Epoch: 4, Steps: 123 | Train Loss: 0.5484864 Vali Loss: 0.5674833 Best vali loss: 0.5498849
	iters: 100, epoch: 5 | loss: 0.6432373
	speed: 0.0120s/iter; left time: 4.7051s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5499 --> 0.5386).  Saving model state dict ...
Epoch: 5 cost time: 0.9999487400054932
Epoch: 5, Steps: 123 | Train Loss: 0.6432373 Vali Loss: 0.5386293 Best vali loss: 0.5386293
	iters: 100, epoch: 6 | loss: 0.5850328
	speed: 0.0126s/iter; left time: 3.4118s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5386 --> 0.5311).  Saving model state dict ...
Epoch: 6 cost time: 1.004594087600708
Epoch: 6, Steps: 123 | Train Loss: 0.5850328 Vali Loss: 0.5310831 Best vali loss: 0.5310831
	iters: 100, epoch: 7 | loss: 0.8064900
	speed: 0.0126s/iter; left time: 1.8532s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 1.0097529888153076
Epoch: 7, Steps: 123 | Train Loss: 0.8064900 Vali Loss: 0.5362059 Best vali loss: 0.5310831
	iters: 100, epoch: 8 | loss: 0.6540640
	speed: 0.0122s/iter; left time: 0.2934s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0071818828582764
Epoch: 8, Steps: 123 | Train Loss: 0.6540640 Vali Loss: 0.5326992 Best vali loss: 0.5310831

best validation loss 0.5310831446164408

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.000889881514, 'e_layers': 3, 'learning_rate': 9.08782211e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.741937476266267e-05
Validation loss decreased (inf --> 0.6232).  Saving model state dict ...
Epoch: 1 cost time: 0.8654031753540039
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6232282 Best vali loss: 0.6232282
Updating learning rate to 7.756941375099019e-05
Validation loss decreased (0.6232 --> 0.6067).  Saving model state dict ...
Epoch: 2 cost time: 0.5778772830963135
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6067284 Best vali loss: 0.6067284
Updating learning rate to 6.282790533889076e-05
Epoch: 3 cost time: 0.5829849243164062
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6090753 Best vali loss: 0.6067284
Updating learning rate to 4.543911055e-05
Validation loss decreased (0.6067 --> 0.5948).  Saving model state dict ...
Epoch: 4 cost time: 0.5849411487579346
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5948192 Best vali loss: 0.5948192
Updating learning rate to 2.805031576110924e-05
Epoch: 5 cost time: 0.5831449031829834
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5971285 Best vali loss: 0.5948192
Updating learning rate to 1.3308807349009808e-05
Validation loss decreased (0.5948 --> 0.5933).  Saving model state dict ...
Epoch: 6 cost time: 0.573880672454834
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5932574 Best vali loss: 0.5932574
Updating learning rate to 3.4588463373373225e-06
Epoch: 7 cost time: 0.5818376541137695
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6047105 Best vali loss: 0.5932574
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5805892944335938
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6054369 Best vali loss: 0.5932574

best validation loss 0.5932573894006905

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0013706680765, 'e_layers': 4, 'learning_rate': 6.80478831e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8612180
	speed: 0.0125s/iter; left time: 23.1713s
	iters: 200, epoch: 1 | loss: 0.9513035
	speed: 0.0056s/iter; left time: 9.8015s
Updating learning rate to 6.80478831e-05
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 1.721278190612793
Epoch: 1, Steps: 245 | Train Loss: 0.9062607 Vali Loss: 0.6063531 Best vali loss: 0.6063531
	iters: 100, epoch: 2 | loss: 0.8268738
	speed: 0.0111s/iter; left time: 17.9851s
	iters: 200, epoch: 2 | loss: 0.8038064
	speed: 0.0057s/iter; left time: 8.7154s
Updating learning rate to 3.402394155e-05
Validation loss decreased (0.6064 --> 0.6059).  Saving model state dict ...
Epoch: 2 cost time: 1.4692471027374268
Epoch: 2, Steps: 245 | Train Loss: 0.8153401 Vali Loss: 0.6059123 Best vali loss: 0.6059123
	iters: 100, epoch: 3 | loss: 0.8029009
	speed: 0.0112s/iter; left time: 15.4132s
	iters: 200, epoch: 3 | loss: 0.7821100
	speed: 0.0055s/iter; left time: 7.0269s
Updating learning rate to 1.7011970775e-05
Validation loss decreased (0.6059 --> 0.5891).  Saving model state dict ...
Epoch: 3 cost time: 1.4239871501922607
Epoch: 3, Steps: 245 | Train Loss: 0.7925054 Vali Loss: 0.5891260 Best vali loss: 0.5891260
	iters: 100, epoch: 4 | loss: 0.8771827
	speed: 0.0113s/iter; left time: 12.6741s
	iters: 200, epoch: 4 | loss: 0.8179137
	speed: 0.0057s/iter; left time: 5.8445s
Updating learning rate to 8.5059853875e-06
Validation loss decreased (0.5891 --> 0.5859).  Saving model state dict ...
Epoch: 4 cost time: 1.4481456279754639
Epoch: 4, Steps: 245 | Train Loss: 0.8475482 Vali Loss: 0.5858688 Best vali loss: 0.5858688
	iters: 100, epoch: 5 | loss: 0.4388223
	speed: 0.0108s/iter; left time: 9.5133s
	iters: 200, epoch: 5 | loss: 1.0325633
	speed: 0.0057s/iter; left time: 4.4196s
Updating learning rate to 4.25299269375e-06
Validation loss decreased (0.5859 --> 0.5806).  Saving model state dict ...
Epoch: 5 cost time: 1.4216947555541992
Epoch: 5, Steps: 245 | Train Loss: 0.7356928 Vali Loss: 0.5806172 Best vali loss: 0.5806172
	iters: 100, epoch: 6 | loss: 0.7697244
	speed: 0.0106s/iter; left time: 6.7157s
	iters: 200, epoch: 6 | loss: 0.8245893
	speed: 0.0054s/iter; left time: 2.8758s
Updating learning rate to 2.126496346875e-06
Epoch: 6 cost time: 1.3331341743469238
Epoch: 6, Steps: 245 | Train Loss: 0.7971568 Vali Loss: 0.5849453 Best vali loss: 0.5806172
	iters: 100, epoch: 7 | loss: 0.8511078
	speed: 0.0104s/iter; left time: 4.0756s
	iters: 200, epoch: 7 | loss: 0.9205533
	speed: 0.0052s/iter; left time: 1.4992s
Updating learning rate to 1.0632481734375e-06
Epoch: 7 cost time: 1.324495792388916
Epoch: 7, Steps: 245 | Train Loss: 0.8858305 Vali Loss: 0.5829259 Best vali loss: 0.5806172
	iters: 100, epoch: 8 | loss: 1.0706401
	speed: 0.0103s/iter; left time: 1.5040s
	iters: 200, epoch: 8 | loss: 0.8000851
	speed: 0.0052s/iter; left time: 0.2382s
Updating learning rate to 5.3162408671875e-07
Epoch: 8 cost time: 1.3217575550079346
Epoch: 8, Steps: 245 | Train Loss: 0.9353626 Vali Loss: 0.5814501 Best vali loss: 0.5806172

best validation loss 0.5806171954478009

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043138534479, 'e_layers': 2, 'learning_rate': 0.000301263799, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7751952
	speed: 0.0116s/iter; left time: 10.2577s
Updating learning rate to 0.00028979762839134715
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0190088748931885
Epoch: 1, Steps: 123 | Train Loss: 0.7751952 Vali Loss: 0.6173545 Best vali loss: 0.6173545
	iters: 100, epoch: 2 | loss: 0.9468994
	speed: 0.0094s/iter; left time: 7.1539s
Updating learning rate to 0.0002571447370994605
Validation loss decreased (0.6174 --> 0.5678).  Saving model state dict ...
Epoch: 2 cost time: 0.7253801822662354
Epoch: 2, Steps: 123 | Train Loss: 0.9468994 Vali Loss: 0.5678144 Best vali loss: 0.5678144
	iters: 100, epoch: 3 | loss: 0.8485361
	speed: 0.0095s/iter; left time: 6.0825s
Updating learning rate to 0.00020827623182433327
Validation loss decreased (0.5678 --> 0.5523).  Saving model state dict ...
Epoch: 3 cost time: 0.7307744026184082
Epoch: 3, Steps: 123 | Train Loss: 0.8485361 Vali Loss: 0.5522518 Best vali loss: 0.5522518

best validation loss 0.5522518249806956

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0081965174442, 'e_layers': 2, 'learning_rate': 0.0003012972145, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7759161
	speed: 0.0116s/iter; left time: 10.2447s
Updating learning rate to 0.00028982977208960646
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0174779891967773
Epoch: 1, Steps: 123 | Train Loss: 0.7759161 Vali Loss: 0.6172875 Best vali loss: 0.6172875
	iters: 100, epoch: 2 | loss: 0.9500113
	speed: 0.0092s/iter; left time: 7.0133s
Updating learning rate to 0.0002571732590127839
Validation loss decreased (0.6173 --> 0.5685).  Saving model state dict ...
Epoch: 2 cost time: 0.7246663570404053
Epoch: 2, Steps: 123 | Train Loss: 0.9500113 Vali Loss: 0.5685287 Best vali loss: 0.5685287
	iters: 100, epoch: 3 | loss: 0.8469804
	speed: 0.0093s/iter; left time: 5.9682s
Updating learning rate to 0.00020829933335345037
Validation loss decreased (0.5685 --> 0.5511).  Saving model state dict ...
Epoch: 3 cost time: 0.7254493236541748
Epoch: 3, Steps: 123 | Train Loss: 0.8469804 Vali Loss: 0.5511430 Best vali loss: 0.5511430

best validation loss 0.5511429548704861

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0101440716798, 'e_layers': 4, 'learning_rate': 0.0010727233067, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9389701
	speed: 0.0113s/iter; left time: 87.3096s
	iters: 200, epoch: 1 | loss: 0.6583738
	speed: 0.0051s/iter; left time: 39.0539s
	iters: 300, epoch: 1 | loss: 1.4096329
	speed: 0.0050s/iter; left time: 37.3864s
	iters: 400, epoch: 1 | loss: 1.2104647
	speed: 0.0052s/iter; left time: 38.4916s
	iters: 500, epoch: 1 | loss: 0.7843508
	speed: 0.0051s/iter; left time: 37.3915s
	iters: 600, epoch: 1 | loss: 0.6701491
	speed: 0.0049s/iter; left time: 35.5609s
	iters: 700, epoch: 1 | loss: 0.4378563
	speed: 0.0049s/iter; left time: 34.9364s
	iters: 800, epoch: 1 | loss: 0.8946972
	speed: 0.0048s/iter; left time: 34.0847s
	iters: 900, epoch: 1 | loss: 0.5646367
	speed: 0.0049s/iter; left time: 33.9796s
Updating learning rate to 0.0010727233067
Validation loss decreased (inf --> 0.6326).  Saving model state dict ...
Epoch: 1 cost time: 5.2527079582214355
Epoch: 1, Steps: 979 | Train Loss: 0.8410146 Vali Loss: 0.6325514 Best vali loss: 0.6325514
	iters: 100, epoch: 2 | loss: 1.1634672
	speed: 0.0156s/iter; left time: 105.1127s
	iters: 200, epoch: 2 | loss: 0.3541541
	speed: 0.0051s/iter; left time: 34.1235s
	iters: 300, epoch: 2 | loss: 0.8278871
	speed: 0.0052s/iter; left time: 33.9949s
	iters: 400, epoch: 2 | loss: 1.8613259
	speed: 0.0053s/iter; left time: 34.0285s
	iters: 500, epoch: 2 | loss: 0.7003589
	speed: 0.0053s/iter; left time: 33.6194s
	iters: 600, epoch: 2 | loss: 0.4896290
	speed: 0.0053s/iter; left time: 33.0382s
	iters: 700, epoch: 2 | loss: 1.5181769
	speed: 0.0052s/iter; left time: 31.9766s
	iters: 800, epoch: 2 | loss: 0.8189290
	speed: 0.0052s/iter; left time: 31.7693s
	iters: 900, epoch: 2 | loss: 0.7323208
	speed: 0.0052s/iter; left time: 31.1177s
Updating learning rate to 0.00053636165335
Epoch: 2 cost time: 5.158434152603149
Epoch: 2, Steps: 979 | Train Loss: 0.9406943 Vali Loss: 0.6421161 Best vali loss: 0.6325514
	iters: 100, epoch: 3 | loss: 1.3519943
	speed: 0.0157s/iter; left time: 90.8606s
	iters: 200, epoch: 3 | loss: 0.9536035
	speed: 0.0051s/iter; left time: 29.1680s
	iters: 300, epoch: 3 | loss: 1.1964238
	speed: 0.0045s/iter; left time: 25.1075s
	iters: 400, epoch: 3 | loss: 0.8458655
	speed: 0.0044s/iter; left time: 24.0485s
	iters: 500, epoch: 3 | loss: 1.0442852
	speed: 0.0046s/iter; left time: 24.7321s
	iters: 600, epoch: 3 | loss: 1.4184270
	speed: 0.0049s/iter; left time: 25.7555s
	iters: 700, epoch: 3 | loss: 0.6009792
	speed: 0.0049s/iter; left time: 25.2762s
	iters: 800, epoch: 3 | loss: 0.9156562
	speed: 0.0049s/iter; left time: 24.8284s
	iters: 900, epoch: 3 | loss: 0.4717124
	speed: 0.0049s/iter; left time: 24.1810s
Updating learning rate to 0.000268180826675
Epoch: 3 cost time: 4.771571159362793
Epoch: 3, Steps: 979 | Train Loss: 0.9776608 Vali Loss: 0.6445465 Best vali loss: 0.6325514

best validation loss 0.6325514213678076

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0081965174442, 'e_layers': 2, 'learning_rate': 0.0003012972145, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5873425
	speed: 0.0120s/iter; left time: 6.1922s
Updating learning rate to 0.00015064860725
Validation loss decreased (0.5511 --> 0.5344).  Saving model state dict ...
Epoch: 4 cost time: 1.0173046588897705
Epoch: 4, Steps: 123 | Train Loss: 0.5873425 Vali Loss: 0.5344141 Best vali loss: 0.5344141
	iters: 100, epoch: 5 | loss: 0.8329419
	speed: 0.0096s/iter; left time: 3.7648s
Updating learning rate to 9.299788114654966e-05
Validation loss decreased (0.5344 --> 0.5336).  Saving model state dict ...
Epoch: 5 cost time: 0.7310535907745361
Epoch: 5, Steps: 123 | Train Loss: 0.8329419 Vali Loss: 0.5335507 Best vali loss: 0.5335507
	iters: 100, epoch: 6 | loss: 0.7527454
	speed: 0.0094s/iter; left time: 2.5252s
Updating learning rate to 4.4123955487216126e-05
Epoch: 6 cost time: 0.7187697887420654
Epoch: 6, Steps: 123 | Train Loss: 0.7527454 Vali Loss: 0.5350583 Best vali loss: 0.5335507
	iters: 100, epoch: 7 | loss: 0.4247639
	speed: 0.0090s/iter; left time: 1.3166s
Updating learning rate to 1.146744241039356e-05
Epoch: 7 cost time: 0.7187552452087402
Epoch: 7, Steps: 123 | Train Loss: 0.4247639 Vali Loss: 0.5416157 Best vali loss: 0.5335507
	iters: 100, epoch: 8 | loss: 0.5046960
	speed: 0.0091s/iter; left time: 0.2180s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7189595699310303
Epoch: 8, Steps: 123 | Train Loss: 0.5046960 Vali Loss: 0.5411111 Best vali loss: 0.5335507

best validation loss 0.5335506832693419

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043460687908, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616078
	speed: 0.0117s/iter; left time: 10.3755s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0329396724700928
Epoch: 1, Steps: 123 | Train Loss: 0.7616078 Vali Loss: 0.6075701 Best vali loss: 0.6075701
	iters: 100, epoch: 2 | loss: 0.9374456
	speed: 0.0093s/iter; left time: 7.0739s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5648).  Saving model state dict ...
Epoch: 2 cost time: 0.7248826026916504
Epoch: 2, Steps: 123 | Train Loss: 0.9374456 Vali Loss: 0.5647594 Best vali loss: 0.5647594
	iters: 100, epoch: 3 | loss: 0.8523058
	speed: 0.0094s/iter; left time: 6.0131s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5648 --> 0.5468).  Saving model state dict ...
Epoch: 3 cost time: 0.7317471504211426
Epoch: 3, Steps: 123 | Train Loss: 0.8523058 Vali Loss: 0.5467598 Best vali loss: 0.5467598
	iters: 100, epoch: 4 | loss: 0.5042077
	speed: 0.0093s/iter; left time: 4.7913s
Updating learning rate to 8.79186073e-05
Epoch: 4 cost time: 0.7198145389556885
Epoch: 4, Steps: 123 | Train Loss: 0.5042077 Vali Loss: 0.5506502 Best vali loss: 0.5467598
	iters: 100, epoch: 5 | loss: 0.5735415
	speed: 0.0090s/iter; left time: 3.5364s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5468 --> 0.5320).  Saving model state dict ...
Epoch: 5 cost time: 0.718590259552002
Epoch: 5, Steps: 123 | Train Loss: 0.5735415 Vali Loss: 0.5320150 Best vali loss: 0.5320150
	iters: 100, epoch: 6 | loss: 0.6151267
	speed: 0.0093s/iter; left time: 2.5191s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5320 --> 0.5292).  Saving model state dict ...
Epoch: 6 cost time: 0.7228102684020996
Epoch: 6, Steps: 123 | Train Loss: 0.6151267 Vali Loss: 0.5292138 Best vali loss: 0.5292138
	iters: 100, epoch: 7 | loss: 0.5772819
	speed: 0.0094s/iter; left time: 1.3753s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5292 --> 0.5272).  Saving model state dict ...
Epoch: 7 cost time: 0.7263128757476807
Epoch: 7, Steps: 123 | Train Loss: 0.5772819 Vali Loss: 0.5272041 Best vali loss: 0.5272041
	iters: 100, epoch: 8 | loss: 0.7390081
	speed: 0.0093s/iter; left time: 0.2224s
Updating learning rate to 0.0
Validation loss decreased (0.5272 --> 0.5242).  Saving model state dict ...
Epoch: 8 cost time: 0.7190685272216797
Epoch: 8, Steps: 123 | Train Loss: 0.7390081 Vali Loss: 0.5242473 Best vali loss: 0.5242473

best validation loss 0.524247342295693

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0043750069749, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8463669
	speed: 0.0107s/iter; left time: 9.4710s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5996).  Saving model state dict ...
Epoch: 1 cost time: 0.9014978408813477
Epoch: 1, Steps: 123 | Train Loss: 0.8463669 Vali Loss: 0.5996225 Best vali loss: 0.5996225
	iters: 100, epoch: 2 | loss: 0.7496343
	speed: 0.0076s/iter; left time: 5.7892s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.5996 --> 0.5990).  Saving model state dict ...
Epoch: 2 cost time: 0.5897178649902344
Epoch: 2, Steps: 123 | Train Loss: 0.7496343 Vali Loss: 0.5989707 Best vali loss: 0.5989707
	iters: 100, epoch: 3 | loss: 0.6688672
	speed: 0.0078s/iter; left time: 4.9640s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5990 --> 0.5618).  Saving model state dict ...
Epoch: 3 cost time: 0.6135427951812744
Epoch: 3, Steps: 123 | Train Loss: 0.6688672 Vali Loss: 0.5618419 Best vali loss: 0.5618419
	iters: 100, epoch: 4 | loss: 0.7093698
	speed: 0.0079s/iter; left time: 4.0548s
Updating learning rate to 8.79186073e-05
Epoch: 4 cost time: 0.611710786819458
Epoch: 4, Steps: 123 | Train Loss: 0.7093698 Vali Loss: 0.6124293 Best vali loss: 0.5618419
	iters: 100, epoch: 5 | loss: 0.4821667
	speed: 0.0080s/iter; left time: 3.1372s
Updating learning rate to 5.427361288967756e-05
Epoch: 5 cost time: 0.6380157470703125
Epoch: 5, Steps: 123 | Train Loss: 0.4821667 Vali Loss: 0.5644211 Best vali loss: 0.5618419
	iters: 100, epoch: 6 | loss: 0.7950955
	speed: 0.0079s/iter; left time: 2.1311s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.6187670230865479
Epoch: 6, Steps: 123 | Train Loss: 0.7950955 Vali Loss: 0.5648300 Best vali loss: 0.5618419
	iters: 100, epoch: 7 | loss: 0.6133771
	speed: 0.0076s/iter; left time: 1.1228s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5618 --> 0.5566).  Saving model state dict ...
Epoch: 7 cost time: 0.6048440933227539
Epoch: 7, Steps: 123 | Train Loss: 0.6133771 Vali Loss: 0.5566452 Best vali loss: 0.5566452
	iters: 100, epoch: 8 | loss: 0.8683019
	speed: 0.0081s/iter; left time: 0.1932s
Updating learning rate to 0.0
Validation loss decreased (0.5566 --> 0.5566).  Saving model state dict ...
Epoch: 8 cost time: 0.6265056133270264
Epoch: 8, Steps: 123 | Train Loss: 0.8683019 Vali Loss: 0.5565588 Best vali loss: 0.5565588

best validation loss 0.5565587753556713

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0040542551351, 'e_layers': 2, 'learning_rate': 0.0011827895548, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3055459
	speed: 0.0095s/iter; left time: 73.6243s
	iters: 200, epoch: 1 | loss: 0.4908806
	speed: 0.0034s/iter; left time: 26.3076s
	iters: 300, epoch: 1 | loss: 1.1832712
	speed: 0.0031s/iter; left time: 23.6559s
	iters: 400, epoch: 1 | loss: 0.3846881
	speed: 0.0030s/iter; left time: 22.4449s
	iters: 500, epoch: 1 | loss: 0.6589039
	speed: 0.0029s/iter; left time: 21.0857s
	iters: 600, epoch: 1 | loss: 0.5652719
	speed: 0.0029s/iter; left time: 21.0760s
	iters: 700, epoch: 1 | loss: 1.6113176
	speed: 0.0029s/iter; left time: 20.7675s
	iters: 800, epoch: 1 | loss: 0.9699827
	speed: 0.0030s/iter; left time: 21.1120s
	iters: 900, epoch: 1 | loss: 0.3589690
	speed: 0.0030s/iter; left time: 20.5413s
Updating learning rate to 0.0011377723078739286
Validation loss decreased (inf --> 0.6139).  Saving model state dict ...
Epoch: 1 cost time: 3.3405301570892334
Epoch: 1, Steps: 979 | Train Loss: 0.7254257 Vali Loss: 0.6139142 Best vali loss: 0.6139142
	iters: 100, epoch: 2 | loss: 1.4456158
	speed: 0.0106s/iter; left time: 71.6163s
	iters: 200, epoch: 2 | loss: 1.0808500
	speed: 0.0035s/iter; left time: 23.1837s
	iters: 300, epoch: 2 | loss: 1.1071839
	speed: 0.0036s/iter; left time: 23.6516s
	iters: 400, epoch: 2 | loss: 0.6147608
	speed: 0.0034s/iter; left time: 21.7123s
	iters: 500, epoch: 2 | loss: 0.5453175
	speed: 0.0030s/iter; left time: 18.9861s
	iters: 600, epoch: 2 | loss: 0.8528962
	speed: 0.0031s/iter; left time: 19.3333s
	iters: 700, epoch: 2 | loss: 0.3956670
	speed: 0.0031s/iter; left time: 18.8408s
	iters: 800, epoch: 2 | loss: 1.0960991
	speed: 0.0031s/iter; left time: 18.9561s
	iters: 900, epoch: 2 | loss: 1.5594044
	speed: 0.0031s/iter; left time: 18.3365s
Updating learning rate to 0.0010095740348578489
Validation loss decreased (0.6139 --> 0.6114).  Saving model state dict ...
Epoch: 2 cost time: 3.1999480724334717
Epoch: 2, Steps: 979 | Train Loss: 0.9664216 Vali Loss: 0.6113670 Best vali loss: 0.6113670
	iters: 100, epoch: 3 | loss: 0.8756106
	speed: 0.0106s/iter; left time: 60.9398s
	iters: 200, epoch: 3 | loss: 0.8844533
	speed: 0.0032s/iter; left time: 18.1359s
	iters: 300, epoch: 3 | loss: 0.8805184
	speed: 0.0031s/iter; left time: 17.0935s
	iters: 400, epoch: 3 | loss: 0.7655507
	speed: 0.0031s/iter; left time: 16.9428s
	iters: 500, epoch: 3 | loss: 0.9039616
	speed: 0.0030s/iter; left time: 16.3156s
	iters: 600, epoch: 3 | loss: 1.0112660
	speed: 0.0031s/iter; left time: 16.3443s
	iters: 700, epoch: 3 | loss: 0.6822833
	speed: 0.0031s/iter; left time: 15.8707s
	iters: 800, epoch: 3 | loss: 0.2921921
	speed: 0.0032s/iter; left time: 16.1054s
	iters: 900, epoch: 3 | loss: 0.3454301
	speed: 0.0031s/iter; left time: 15.4268s
Updating learning rate to 0.0008177117606982203
Epoch: 3 cost time: 3.072253942489624
Epoch: 3, Steps: 979 | Train Loss: 0.7379185 Vali Loss: 0.6219078 Best vali loss: 0.6113670

best validation loss 0.6113669574398621

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0031283983815, 'e_layers': 1, 'learning_rate': 0.0001797868895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7216102
	speed: 0.0091s/iter; left time: 34.7192s
	iters: 200, epoch: 1 | loss: 0.7246161
	speed: 0.0028s/iter; left time: 10.3466s
	iters: 300, epoch: 1 | loss: 0.5769825
	speed: 0.0028s/iter; left time: 10.0808s
	iters: 400, epoch: 1 | loss: 0.7627692
	speed: 0.0027s/iter; left time: 9.3930s
Updating learning rate to 0.0001729441584614592
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 1.6994633674621582
Epoch: 1, Steps: 490 | Train Loss: 0.6964945 Vali Loss: 0.6103286 Best vali loss: 0.6103286
	iters: 100, epoch: 2 | loss: 1.0718006
	speed: 0.0084s/iter; left time: 27.8684s
	iters: 200, epoch: 2 | loss: 0.6490970
	speed: 0.0027s/iter; left time: 8.6666s
	iters: 300, epoch: 2 | loss: 1.0876584
	speed: 0.0027s/iter; left time: 8.3097s
	iters: 400, epoch: 2 | loss: 0.8739714
	speed: 0.0026s/iter; left time: 7.9429s
Updating learning rate to 0.00015345770911694324
Epoch: 2 cost time: 1.359102487564087
Epoch: 2, Steps: 490 | Train Loss: 0.9206319 Vali Loss: 0.6174913 Best vali loss: 0.6103286
	iters: 100, epoch: 3 | loss: 1.6539848
	speed: 0.0080s/iter; left time: 22.6687s
	iters: 200, epoch: 3 | loss: 0.7343681
	speed: 0.0024s/iter; left time: 6.6635s
	iters: 300, epoch: 3 | loss: 0.5402158
	speed: 0.0024s/iter; left time: 6.3093s
	iters: 400, epoch: 3 | loss: 0.9850817
	speed: 0.0024s/iter; left time: 5.9842s
Updating learning rate to 0.00012429417673405157
Epoch: 3 cost time: 1.2283210754394531
Epoch: 3, Steps: 490 | Train Loss: 0.9784126 Vali Loss: 0.6161740 Best vali loss: 0.6103286

best validation loss 0.6103286034858982

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7154686
	speed: 0.0120s/iter; left time: 10.5793s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6135).  Saving model state dict ...
Epoch: 1 cost time: 1.0564701557159424
Epoch: 1, Steps: 123 | Train Loss: 0.7154686 Vali Loss: 0.6135132 Best vali loss: 0.6135132
	iters: 100, epoch: 2 | loss: 0.8422371
	speed: 0.0092s/iter; left time: 6.9822s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6135 --> 0.5586).  Saving model state dict ...
Epoch: 2 cost time: 0.715667724609375
Epoch: 2, Steps: 123 | Train Loss: 0.8422371 Vali Loss: 0.5586323 Best vali loss: 0.5586323
	iters: 100, epoch: 3 | loss: 0.9605801
	speed: 0.0094s/iter; left time: 6.0058s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5586 --> 0.5402).  Saving model state dict ...
Epoch: 3 cost time: 0.7291970252990723
Epoch: 3, Steps: 123 | Train Loss: 0.9605801 Vali Loss: 0.5401677 Best vali loss: 0.5401677

best validation loss 0.5401677200221618

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6234909
	speed: 0.0121s/iter; left time: 6.2293s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5402 --> 0.5387).  Saving model state dict ...
Epoch: 4 cost time: 1.0393569469451904
Epoch: 4, Steps: 123 | Train Loss: 0.6234909 Vali Loss: 0.5387320 Best vali loss: 0.5387320
	iters: 100, epoch: 5 | loss: 0.7720169
	speed: 0.0095s/iter; left time: 3.7401s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5387 --> 0.5381).  Saving model state dict ...
Epoch: 5 cost time: 0.7276110649108887
Epoch: 5, Steps: 123 | Train Loss: 0.7720169 Vali Loss: 0.5381437 Best vali loss: 0.5381437
	iters: 100, epoch: 6 | loss: 0.9014175
	speed: 0.0093s/iter; left time: 2.5154s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5381 --> 0.5354).  Saving model state dict ...
Epoch: 6 cost time: 0.7240550518035889
Epoch: 6, Steps: 123 | Train Loss: 0.9014175 Vali Loss: 0.5353815 Best vali loss: 0.5353815
	iters: 100, epoch: 7 | loss: 0.5348119
	speed: 0.0094s/iter; left time: 1.3791s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5354 --> 0.5349).  Saving model state dict ...
Epoch: 7 cost time: 0.7246758937835693
Epoch: 7, Steps: 123 | Train Loss: 0.5348119 Vali Loss: 0.5348610 Best vali loss: 0.5348610
	iters: 100, epoch: 8 | loss: 0.7093782
	speed: 0.0094s/iter; left time: 0.2248s
Updating learning rate to 0.0
Validation loss decreased (0.5349 --> 0.5305).  Saving model state dict ...
Epoch: 8 cost time: 0.7252397537231445
Epoch: 8, Steps: 123 | Train Loss: 0.7093782 Vali Loss: 0.5305446 Best vali loss: 0.5305446

best validation loss 0.5305445740091641

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010487711496, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744513
	speed: 0.0116s/iter; left time: 10.2796s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0332365036010742
Epoch: 1, Steps: 123 | Train Loss: 0.7744513 Vali Loss: 0.6172239 Best vali loss: 0.6172239
	iters: 100, epoch: 2 | loss: 0.9506890
	speed: 0.0093s/iter; left time: 7.0520s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6172 --> 0.5607).  Saving model state dict ...
Epoch: 2 cost time: 0.7315843105316162
Epoch: 2, Steps: 123 | Train Loss: 0.9506890 Vali Loss: 0.5607235 Best vali loss: 0.5607235
	iters: 100, epoch: 3 | loss: 0.8446518
	speed: 0.0094s/iter; left time: 6.0118s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5607 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 0.7207651138305664
Epoch: 3, Steps: 123 | Train Loss: 0.8446518 Vali Loss: 0.5452980 Best vali loss: 0.5452980
	iters: 100, epoch: 4 | loss: 0.4863892
	speed: 0.0094s/iter; left time: 4.8388s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.7239940166473389
Epoch: 4, Steps: 123 | Train Loss: 0.4863892 Vali Loss: 0.5457828 Best vali loss: 0.5452980
	iters: 100, epoch: 5 | loss: 0.5559488
	speed: 0.0090s/iter; left time: 3.5206s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5453 --> 0.5297).  Saving model state dict ...
Epoch: 5 cost time: 0.7211487293243408
Epoch: 5, Steps: 123 | Train Loss: 0.5559488 Vali Loss: 0.5296971 Best vali loss: 0.5296971
	iters: 100, epoch: 6 | loss: 0.5792383
	speed: 0.0095s/iter; left time: 2.5569s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7173216342926025
Epoch: 6, Steps: 123 | Train Loss: 0.5792383 Vali Loss: 0.5442357 Best vali loss: 0.5296971
	iters: 100, epoch: 7 | loss: 0.5354329
	speed: 0.0090s/iter; left time: 1.3277s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7265820503234863
Epoch: 7, Steps: 123 | Train Loss: 0.5354329 Vali Loss: 0.5406709 Best vali loss: 0.5296971
	iters: 100, epoch: 8 | loss: 0.6973925
	speed: 0.0090s/iter; left time: 0.2171s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7241213321685791
Epoch: 8, Steps: 123 | Train Loss: 0.6973925 Vali Loss: 0.5491897 Best vali loss: 0.5296971

best validation loss 0.5296971080535984

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0003025721201, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7748883
	speed: 0.0117s/iter; left time: 10.3787s
Updating learning rate to 0.00029105615448446844
Validation loss decreased (inf --> 0.6176).  Saving model state dict ...
Epoch: 1 cost time: 1.024256944656372
Epoch: 1, Steps: 123 | Train Loss: 0.7748883 Vali Loss: 0.6176456 Best vali loss: 0.6176456
	iters: 100, epoch: 2 | loss: 0.9439135
	speed: 0.0093s/iter; left time: 7.0652s
Updating learning rate to 0.00025826145901035026
Validation loss decreased (0.6176 --> 0.6124).  Saving model state dict ...
Epoch: 2 cost time: 0.7251217365264893
Epoch: 2, Steps: 123 | Train Loss: 0.9439135 Vali Loss: 0.6124287 Best vali loss: 0.6124287
	iters: 100, epoch: 3 | loss: 0.8488568
	speed: 0.0094s/iter; left time: 5.9957s
Updating learning rate to 0.0002091807287789251
Validation loss decreased (0.6124 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 0.7219705581665039
Epoch: 3, Steps: 123 | Train Loss: 0.8488568 Vali Loss: 0.5453160 Best vali loss: 0.5453160
	iters: 100, epoch: 4 | loss: 0.4875849
	speed: 0.0094s/iter; left time: 4.8539s
Updating learning rate to 0.00015128606005
Validation loss decreased (0.5453 --> 0.5390).  Saving model state dict ...
Epoch: 4 cost time: 0.7195851802825928
Epoch: 4, Steps: 123 | Train Loss: 0.4875849 Vali Loss: 0.5390297 Best vali loss: 0.5390297
	iters: 100, epoch: 5 | loss: 0.5517849
	speed: 0.0094s/iter; left time: 3.6832s
Updating learning rate to 9.339139132107492e-05
Validation loss decreased (0.5390 --> 0.5311).  Saving model state dict ...
Epoch: 5 cost time: 0.7259459495544434
Epoch: 5, Steps: 123 | Train Loss: 0.5517849 Vali Loss: 0.5310984 Best vali loss: 0.5310984
	iters: 100, epoch: 6 | loss: 0.5763139
	speed: 0.0095s/iter; left time: 2.5656s
Updating learning rate to 4.431066108964977e-05
Epoch: 6 cost time: 0.7271702289581299
Epoch: 6, Steps: 123 | Train Loss: 0.5763139 Vali Loss: 0.5596778 Best vali loss: 0.5310984
	iters: 100, epoch: 7 | loss: 0.5288504
	speed: 0.0091s/iter; left time: 1.3417s
Updating learning rate to 1.1515965615531549e-05
Epoch: 7 cost time: 0.7166924476623535
Epoch: 7, Steps: 123 | Train Loss: 0.5288504 Vali Loss: 0.5545307 Best vali loss: 0.5310984
	iters: 100, epoch: 8 | loss: 0.6858784
	speed: 0.0090s/iter; left time: 0.2153s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7196152210235596
Epoch: 8, Steps: 123 | Train Loss: 0.6858784 Vali Loss: 0.5632061 Best vali loss: 0.5310984

best validation loss 0.5310983631358219

[INFO][smbo.py:320] Finished 750 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010492397808, 'e_layers': 2, 'learning_rate': 0.0003030275053, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7748520
	speed: 0.0117s/iter; left time: 10.3476s
Updating learning rate to 0.00029149420761731277
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0244996547698975
Epoch: 1, Steps: 123 | Train Loss: 0.7748520 Vali Loss: 0.6173048 Best vali loss: 0.6173048
	iters: 100, epoch: 2 | loss: 0.9448174
	speed: 0.0092s/iter; left time: 7.0162s
Updating learning rate to 0.0002586501545918362
Validation loss decreased (0.6173 --> 0.5843).  Saving model state dict ...
Epoch: 2 cost time: 0.7237105369567871
Epoch: 2, Steps: 123 | Train Loss: 0.9448174 Vali Loss: 0.5843479 Best vali loss: 0.5843479
	iters: 100, epoch: 3 | loss: 0.8467150
	speed: 0.0093s/iter; left time: 5.9294s
Updating learning rate to 0.00020949555556461723
Validation loss decreased (0.5843 --> 0.5519).  Saving model state dict ...
Epoch: 3 cost time: 0.7243435382843018
Epoch: 3, Steps: 123 | Train Loss: 0.8467150 Vali Loss: 0.5518706 Best vali loss: 0.5518706

best validation loss 0.5518706421618217

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043891091461, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5991).  Saving model state dict ...
Epoch: 1 cost time: 0.8674600124359131
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5991309 Best vali loss: 0.5991309
Updating learning rate to 0.0001500864507143071
Epoch: 2 cost time: 0.5712063312530518
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6049130 Best vali loss: 0.5991309
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5991 --> 0.5884).  Saving model state dict ...
Epoch: 3 cost time: 0.5678696632385254
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5883984 Best vali loss: 0.5883984

best validation loss 0.5883984293224965

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043847626055, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5991).  Saving model state dict ...
Epoch: 1 cost time: 0.8636617660522461
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5991292 Best vali loss: 0.5991292
Updating learning rate to 0.0001500864507143071
Epoch: 2 cost time: 0.5699570178985596
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6048588 Best vali loss: 0.5991292
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5991 --> 0.5912).  Saving model state dict ...
Epoch: 3 cost time: 0.5742084980010986
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5912102 Best vali loss: 0.5912102

best validation loss 0.5912101943699203

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010492397808, 'e_layers': 2, 'learning_rate': 0.0003030275053, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5915728
	speed: 0.0119s/iter; left time: 6.1602s
Updating learning rate to 0.00015151375265
Validation loss decreased (0.5519 --> 0.5374).  Saving model state dict ...
Epoch: 4 cost time: 1.0308501720428467
Epoch: 4, Steps: 123 | Train Loss: 0.5915728 Vali Loss: 0.5373705 Best vali loss: 0.5373705
	iters: 100, epoch: 5 | loss: 0.8220170
	speed: 0.0093s/iter; left time: 3.6582s
Updating learning rate to 9.35319497353828e-05
Validation loss decreased (0.5374 --> 0.5276).  Saving model state dict ...
Epoch: 5 cost time: 0.7193613052368164
Epoch: 5, Steps: 123 | Train Loss: 0.8220170 Vali Loss: 0.5275845 Best vali loss: 0.5275845
	iters: 100, epoch: 6 | loss: 0.7585136
	speed: 0.0095s/iter; left time: 2.5602s
Updating learning rate to 4.4377350708163776e-05
Epoch: 6 cost time: 0.7224011421203613
Epoch: 6, Steps: 123 | Train Loss: 0.7585136 Vali Loss: 0.5369200 Best vali loss: 0.5275845
	iters: 100, epoch: 7 | loss: 0.4255588
	speed: 0.0090s/iter; left time: 1.3300s
Updating learning rate to 1.1533297682687268e-05
Epoch: 7 cost time: 0.7181973457336426
Epoch: 7, Steps: 123 | Train Loss: 0.4255588 Vali Loss: 0.5439769 Best vali loss: 0.5275845
	iters: 100, epoch: 8 | loss: 0.4998654
	speed: 0.0090s/iter; left time: 0.2163s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7204575538635254
Epoch: 8, Steps: 123 | Train Loss: 0.4998654 Vali Loss: 0.5482016 Best vali loss: 0.5275845

best validation loss 0.5275844506012627

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022140681945, 'e_layers': 3, 'learning_rate': 7.74241153e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7351031
	speed: 0.0106s/iter; left time: 81.5962s
	iters: 200, epoch: 1 | loss: 0.5638443
	speed: 0.0045s/iter; left time: 34.6263s
	iters: 300, epoch: 1 | loss: 0.7170057
	speed: 0.0045s/iter; left time: 34.0826s
	iters: 400, epoch: 1 | loss: 0.4635655
	speed: 0.0044s/iter; left time: 32.8849s
	iters: 500, epoch: 1 | loss: 1.0707252
	speed: 0.0044s/iter; left time: 31.9421s
	iters: 600, epoch: 1 | loss: 0.5099825
	speed: 0.0040s/iter; left time: 28.9370s
	iters: 700, epoch: 1 | loss: 0.7647955
	speed: 0.0041s/iter; left time: 29.3968s
	iters: 800, epoch: 1 | loss: 0.9069229
	speed: 0.0041s/iter; left time: 28.8688s
	iters: 900, epoch: 1 | loss: 0.5646299
	speed: 0.0041s/iter; left time: 28.7651s
Updating learning rate to 7.447733537423198e-05
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 4.540153980255127
Epoch: 1, Steps: 979 | Train Loss: 0.6996194 Vali Loss: 0.6073574 Best vali loss: 0.6073574
	iters: 100, epoch: 2 | loss: 0.5162942
	speed: 0.0131s/iter; left time: 88.4080s
	iters: 200, epoch: 2 | loss: 1.0316144
	speed: 0.0040s/iter; left time: 26.8837s
	iters: 300, epoch: 2 | loss: 0.6686990
	speed: 0.0040s/iter; left time: 26.3685s
	iters: 400, epoch: 2 | loss: 1.2335006
	speed: 0.0039s/iter; left time: 25.3012s
	iters: 500, epoch: 2 | loss: 0.7708237
	speed: 0.0041s/iter; left time: 25.7842s
	iters: 600, epoch: 2 | loss: 2.0568604
	speed: 0.0040s/iter; left time: 25.0572s
	iters: 700, epoch: 2 | loss: 0.9552102
	speed: 0.0042s/iter; left time: 25.6500s
	iters: 800, epoch: 2 | loss: 0.6918272
	speed: 0.0041s/iter; left time: 24.5399s
	iters: 900, epoch: 2 | loss: 1.3834020
	speed: 0.0039s/iter; left time: 23.4476s
Updating learning rate to 6.608561612799956e-05
Validation loss decreased (0.6074 --> 0.5687).  Saving model state dict ...
Epoch: 2 cost time: 3.9792842864990234
Epoch: 2, Steps: 979 | Train Loss: 1.0342480 Vali Loss: 0.5687259 Best vali loss: 0.5687259
	iters: 100, epoch: 3 | loss: 0.5917502
	speed: 0.0130s/iter; left time: 74.8920s
	iters: 200, epoch: 3 | loss: 1.3673286
	speed: 0.0041s/iter; left time: 23.1877s
	iters: 300, epoch: 3 | loss: 0.7357842
	speed: 0.0041s/iter; left time: 23.0453s
	iters: 400, epoch: 3 | loss: 0.5823702
	speed: 0.0042s/iter; left time: 22.7785s
	iters: 500, epoch: 3 | loss: 1.3478128
	speed: 0.0041s/iter; left time: 22.2217s
	iters: 600, epoch: 3 | loss: 0.6611297
	speed: 0.0041s/iter; left time: 21.6676s
	iters: 700, epoch: 3 | loss: 0.8072814
	speed: 0.0040s/iter; left time: 20.5270s
	iters: 800, epoch: 3 | loss: 0.3691089
	speed: 0.0041s/iter; left time: 20.5931s
	iters: 900, epoch: 3 | loss: 0.8825586
	speed: 0.0039s/iter; left time: 19.4224s
Updating learning rate to 5.3526520745417235e-05
Validation loss decreased (0.5687 --> 0.5667).  Saving model state dict ...
Epoch: 3 cost time: 4.0004518032073975
Epoch: 3, Steps: 979 | Train Loss: 0.8161250 Vali Loss: 0.5666626 Best vali loss: 0.5666626
	iters: 100, epoch: 4 | loss: 0.9407000
	speed: 0.0131s/iter; left time: 62.9958s
	iters: 200, epoch: 4 | loss: 1.3973454
	speed: 0.0039s/iter; left time: 18.3738s
	iters: 300, epoch: 4 | loss: 0.8483164
	speed: 0.0038s/iter; left time: 17.6518s
	iters: 400, epoch: 4 | loss: 1.7547294
	speed: 0.0039s/iter; left time: 17.6810s
	iters: 500, epoch: 4 | loss: 0.6629609
	speed: 0.0040s/iter; left time: 17.5333s
	iters: 600, epoch: 4 | loss: 0.2756566
	speed: 0.0040s/iter; left time: 17.2150s
	iters: 700, epoch: 4 | loss: 1.0202664
	speed: 0.0040s/iter; left time: 16.9242s
	iters: 800, epoch: 4 | loss: 0.9434001
	speed: 0.0040s/iter; left time: 16.3970s
	iters: 900, epoch: 4 | loss: 0.9978378
	speed: 0.0040s/iter; left time: 16.1196s
Updating learning rate to 3.871205765e-05
Validation loss decreased (0.5667 --> 0.5573).  Saving model state dict ...
Epoch: 4 cost time: 3.946037530899048
Epoch: 4, Steps: 979 | Train Loss: 0.9823570 Vali Loss: 0.5573185 Best vali loss: 0.5573185
	iters: 100, epoch: 5 | loss: 0.3619374
	speed: 0.0135s/iter; left time: 51.4001s
	iters: 200, epoch: 5 | loss: 0.2838706
	speed: 0.0040s/iter; left time: 14.9944s
	iters: 300, epoch: 5 | loss: 0.9481063
	speed: 0.0040s/iter; left time: 14.6397s
	iters: 400, epoch: 5 | loss: 0.8038077
	speed: 0.0039s/iter; left time: 13.8647s
	iters: 500, epoch: 5 | loss: 1.3652136
	speed: 0.0040s/iter; left time: 13.5838s
	iters: 600, epoch: 5 | loss: 0.3268003
	speed: 0.0040s/iter; left time: 13.2185s
	iters: 700, epoch: 5 | loss: 0.6437030
	speed: 0.0038s/iter; left time: 12.3721s
	iters: 800, epoch: 5 | loss: 0.2901486
	speed: 0.0039s/iter; left time: 12.2796s
	iters: 900, epoch: 5 | loss: 0.4802727
	speed: 0.0038s/iter; left time: 11.4389s
Updating learning rate to 2.389759455458277e-05
Epoch: 5 cost time: 3.9122915267944336
Epoch: 5, Steps: 979 | Train Loss: 0.6115400 Vali Loss: 0.5610177 Best vali loss: 0.5573185
	iters: 100, epoch: 6 | loss: 1.0888484
	speed: 0.0127s/iter; left time: 35.9111s
	iters: 200, epoch: 6 | loss: 0.2920702
	speed: 0.0038s/iter; left time: 10.5375s
	iters: 300, epoch: 6 | loss: 0.4996116
	speed: 0.0040s/iter; left time: 10.4488s
	iters: 400, epoch: 6 | loss: 0.5699419
	speed: 0.0039s/iter; left time: 9.8321s
	iters: 500, epoch: 6 | loss: 0.4766655
	speed: 0.0039s/iter; left time: 9.3895s
	iters: 600, epoch: 6 | loss: 1.1384655
	speed: 0.0039s/iter; left time: 9.0395s
	iters: 700, epoch: 6 | loss: 0.3109848
	speed: 0.0039s/iter; left time: 8.8189s
	iters: 800, epoch: 6 | loss: 0.2547219
	speed: 0.0040s/iter; left time: 8.4472s
	iters: 900, epoch: 6 | loss: 1.0666355
	speed: 0.0038s/iter; left time: 7.7754s
Updating learning rate to 1.1338499172000439e-05
Epoch: 6 cost time: 3.847909927368164
Epoch: 6, Steps: 979 | Train Loss: 0.6331050 Vali Loss: 0.5598077 Best vali loss: 0.5573185
	iters: 100, epoch: 7 | loss: 0.6194634
	speed: 0.0128s/iter; left time: 23.7404s
	iters: 200, epoch: 7 | loss: 0.5347235
	speed: 0.0041s/iter; left time: 7.2711s
	iters: 300, epoch: 7 | loss: 0.7567912
	speed: 0.0040s/iter; left time: 6.6909s
	iters: 400, epoch: 7 | loss: 1.0971366
	speed: 0.0040s/iter; left time: 6.2112s
	iters: 500, epoch: 7 | loss: 0.7379575
	speed: 0.0041s/iter; left time: 5.9487s
	iters: 600, epoch: 7 | loss: 0.5370003
	speed: 0.0041s/iter; left time: 5.5327s
	iters: 700, epoch: 7 | loss: 0.4899009
	speed: 0.0041s/iter; left time: 5.1225s
	iters: 800, epoch: 7 | loss: 0.5700800
	speed: 0.0041s/iter; left time: 4.7335s
	iters: 900, epoch: 7 | loss: 0.3623609
	speed: 0.0040s/iter; left time: 4.2045s
Updating learning rate to 2.9467799257680186e-06
Validation loss decreased (0.5573 --> 0.5533).  Saving model state dict ...
Epoch: 7 cost time: 4.022236108779907
Epoch: 7, Steps: 979 | Train Loss: 0.6339349 Vali Loss: 0.5532619 Best vali loss: 0.5532619
	iters: 100, epoch: 8 | loss: 0.5987191
	speed: 0.0133s/iter; left time: 11.7164s
	iters: 200, epoch: 8 | loss: 0.8923880
	speed: 0.0039s/iter; left time: 3.0718s
	iters: 300, epoch: 8 | loss: 0.3380081
	speed: 0.0040s/iter; left time: 2.6983s
	iters: 400, epoch: 8 | loss: 1.3648744
	speed: 0.0040s/iter; left time: 2.3055s
	iters: 500, epoch: 8 | loss: 0.6187897
	speed: 0.0038s/iter; left time: 1.8352s
	iters: 600, epoch: 8 | loss: 0.8511391
	speed: 0.0039s/iter; left time: 1.4867s
	iters: 700, epoch: 8 | loss: 1.2260752
	speed: 0.0038s/iter; left time: 1.0624s
	iters: 800, epoch: 8 | loss: 0.3002168
	speed: 0.0040s/iter; left time: 0.7248s
	iters: 900, epoch: 8 | loss: 0.8602406
	speed: 0.0042s/iter; left time: 0.3371s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.9437711238861084
Epoch: 8, Steps: 979 | Train Loss: 0.7833835 Vali Loss: 0.5551567 Best vali loss: 0.5532619

best validation loss 0.5532619082392614

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0087864856129, 'e_layers': 4, 'learning_rate': 0.0011480879308, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5531585
	speed: 0.0116s/iter; left time: 21.6162s
	iters: 200, epoch: 1 | loss: 0.8467187
	speed: 0.0056s/iter; left time: 9.8741s
Updating learning rate to 0.0011480879308
Validation loss decreased (inf --> 0.6618).  Saving model state dict ...
Epoch: 1 cost time: 1.7209937572479248
Epoch: 1, Steps: 245 | Train Loss: 0.6999386 Vali Loss: 0.6618388 Best vali loss: 0.6618388
	iters: 100, epoch: 2 | loss: 0.3961299
	speed: 0.0105s/iter; left time: 16.9343s
	iters: 200, epoch: 2 | loss: 0.6476675
	speed: 0.0053s/iter; left time: 8.0790s
Updating learning rate to 0.0005740439654
Validation loss decreased (0.6618 --> 0.6433).  Saving model state dict ...
Epoch: 2 cost time: 1.3571717739105225
Epoch: 2, Steps: 245 | Train Loss: 0.5218987 Vali Loss: 0.6432760 Best vali loss: 0.6432760
	iters: 100, epoch: 3 | loss: 0.7601230
	speed: 0.0112s/iter; left time: 15.4122s
	iters: 200, epoch: 3 | loss: 0.9533891
	speed: 0.0057s/iter; left time: 7.2250s
Updating learning rate to 0.0002870219827
Epoch: 3 cost time: 1.4407072067260742
Epoch: 3, Steps: 245 | Train Loss: 0.8567560 Vali Loss: 0.6524106 Best vali loss: 0.6432760
	iters: 100, epoch: 4 | loss: 1.1734632
	speed: 0.0109s/iter; left time: 12.3005s
	iters: 200, epoch: 4 | loss: 1.3659537
	speed: 0.0057s/iter; left time: 5.8945s
Updating learning rate to 0.00014351099135
Validation loss decreased (0.6433 --> 0.6393).  Saving model state dict ...
Epoch: 4 cost time: 1.4460904598236084
Epoch: 4, Steps: 245 | Train Loss: 1.2697085 Vali Loss: 0.6393151 Best vali loss: 0.6393151
	iters: 100, epoch: 5 | loss: 0.7678290
	speed: 0.0108s/iter; left time: 9.5286s
	iters: 200, epoch: 5 | loss: 1.2253343
	speed: 0.0052s/iter; left time: 4.0918s
Updating learning rate to 7.1755495675e-05
Epoch: 5 cost time: 1.339421033859253
Epoch: 5, Steps: 245 | Train Loss: 0.9965816 Vali Loss: 0.6443198 Best vali loss: 0.6393151
	iters: 100, epoch: 6 | loss: 0.6923352
	speed: 0.0108s/iter; left time: 6.8928s
	iters: 200, epoch: 6 | loss: 0.9459148
	speed: 0.0057s/iter; left time: 3.0349s
Updating learning rate to 3.58777478375e-05
Epoch: 6 cost time: 1.4337103366851807
Epoch: 6, Steps: 245 | Train Loss: 0.8191250 Vali Loss: 0.6455758 Best vali loss: 0.6393151
	iters: 100, epoch: 7 | loss: 0.8924211
	speed: 0.0108s/iter; left time: 4.2409s
	iters: 200, epoch: 7 | loss: 1.1935132
	speed: 0.0056s/iter; left time: 1.6335s
Updating learning rate to 1.793887391875e-05
Epoch: 7 cost time: 1.4277429580688477
Epoch: 7, Steps: 245 | Train Loss: 1.0429671 Vali Loss: 0.6435862 Best vali loss: 0.6393151
	iters: 100, epoch: 8 | loss: 0.6203606
	speed: 0.0110s/iter; left time: 1.6132s
	iters: 200, epoch: 8 | loss: 1.0758446
	speed: 0.0058s/iter; left time: 0.2650s
Updating learning rate to 8.969436959375e-06
Epoch: 8 cost time: 1.4536418914794922
Epoch: 8, Steps: 245 | Train Loss: 0.8481026 Vali Loss: 0.6437133 Best vali loss: 0.6393151

best validation loss 0.6393151445721984

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010663730876, 'e_layers': 2, 'learning_rate': 0.0004714612298, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00045351730519241015
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 0.7360572814941406
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5981819 Best vali loss: 0.5981819
Updating learning rate to 0.0004024173312290646
Validation loss decreased (0.5982 --> 0.5903).  Saving model state dict ...
Epoch: 2 cost time: 0.4561183452606201
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5902738 Best vali loss: 0.5902738
Updating learning rate to 0.00032594081572346516
Validation loss decreased (0.5903 --> 0.5592).  Saving model state dict ...
Epoch: 3 cost time: 0.46357011795043945
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5592094 Best vali loss: 0.5592094

best validation loss 0.5592093945156364

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0029122714186, 'e_layers': 1, 'learning_rate': 0.0001292197576, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0938741
	speed: 0.0100s/iter; left time: 8.8336s
Updating learning rate to 0.0001292197576
Validation loss decreased (inf --> 0.6856).  Saving model state dict ...
Epoch: 1 cost time: 0.8002746105194092
Epoch: 1, Steps: 123 | Train Loss: 1.0938741 Vali Loss: 0.6855544 Best vali loss: 0.6855544
	iters: 100, epoch: 2 | loss: 0.8181755
	speed: 0.0064s/iter; left time: 4.8591s
Updating learning rate to 6.46098788e-05
Validation loss decreased (0.6856 --> 0.6618).  Saving model state dict ...
Epoch: 2 cost time: 0.4755899906158447
Epoch: 2, Steps: 123 | Train Loss: 0.8181755 Vali Loss: 0.6617894 Best vali loss: 0.6617894
	iters: 100, epoch: 3 | loss: 0.9917856
	speed: 0.0064s/iter; left time: 4.0764s
Updating learning rate to 3.23049394e-05
Validation loss decreased (0.6618 --> 0.6525).  Saving model state dict ...
Epoch: 3 cost time: 0.4766049385070801
Epoch: 3, Steps: 123 | Train Loss: 0.9917856 Vali Loss: 0.6525329 Best vali loss: 0.6525329

best validation loss 0.6525329201379235

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.008878536377, 'e_layers': 2, 'learning_rate': 5.0035027e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.81306821769748e-05
Validation loss decreased (inf --> 0.6847).  Saving model state dict ...
Epoch: 1 cost time: 0.7300853729248047
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6847219 Best vali loss: 0.6847219
Updating learning rate to 4.270756694427599e-05
Validation loss decreased (0.6847 --> 0.6632).  Saving model state dict ...
Epoch: 2 cost time: 0.42919421195983887
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6632049 Best vali loss: 0.6632049
Updating learning rate to 3.459130143541997e-05
Validation loss decreased (0.6632 --> 0.6478).  Saving model state dict ...
Epoch: 3 cost time: 0.44089365005493164
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6478290 Best vali loss: 0.6478290

best validation loss 0.647829011875631

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010663730876, 'e_layers': 2, 'learning_rate': 0.0004714612298, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002357306149
Validation loss decreased (0.5592 --> 0.5499).  Saving model state dict ...
Epoch: 4 cost time: 0.7546694278717041
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5499336 Best vali loss: 0.5499336
Updating learning rate to 0.00014552041407653484
Validation loss decreased (0.5499 --> 0.5267).  Saving model state dict ...
Epoch: 5 cost time: 0.45711231231689453
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5267145 Best vali loss: 0.5267145
Updating learning rate to 6.904389857093542e-05
Epoch: 6 cost time: 0.45049428939819336
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5289385 Best vali loss: 0.5267145
Updating learning rate to 1.7943924607589837e-05
Epoch: 7 cost time: 0.45562124252319336
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5269281 Best vali loss: 0.5267145
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4525926113128662
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5280040 Best vali loss: 0.5267145

best validation loss 0.5267144647090317

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0001328123591, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7550891
	speed: 0.0119s/iter; left time: 10.5533s
Updating learning rate to 0.00012775748966851457
Validation loss decreased (inf --> 0.6039).  Saving model state dict ...
Epoch: 1 cost time: 1.0366568565368652
Epoch: 1, Steps: 123 | Train Loss: 0.7550891 Vali Loss: 0.6038819 Best vali loss: 0.6038819
	iters: 100, epoch: 2 | loss: 0.9377958
	speed: 0.0093s/iter; left time: 7.0671s
Updating learning rate to 0.00011336243942249644
Validation loss decreased (0.6039 --> 0.5850).  Saving model state dict ...
Epoch: 2 cost time: 0.7174968719482422
Epoch: 2, Steps: 123 | Train Loss: 0.9377958 Vali Loss: 0.5849660 Best vali loss: 0.5849660
	iters: 100, epoch: 3 | loss: 0.8636518
	speed: 0.0093s/iter; left time: 5.9304s
Updating learning rate to 9.181872427044644e-05
Validation loss decreased (0.5850 --> 0.5561).  Saving model state dict ...
Epoch: 3 cost time: 0.717322826385498
Epoch: 3, Steps: 123 | Train Loss: 0.8636518 Vali Loss: 0.5560774 Best vali loss: 0.5560774
	iters: 100, epoch: 4 | loss: 0.5072623
	speed: 0.0092s/iter; left time: 4.7369s
Updating learning rate to 6.640617955e-05
Validation loss decreased (0.5561 --> 0.5558).  Saving model state dict ...
Epoch: 4 cost time: 0.72019362449646
Epoch: 4, Steps: 123 | Train Loss: 0.5072623 Vali Loss: 0.5557832 Best vali loss: 0.5557832
	iters: 100, epoch: 5 | loss: 0.5853510
	speed: 0.0094s/iter; left time: 3.6876s
Updating learning rate to 4.0993634829553575e-05
Validation loss decreased (0.5558 --> 0.5425).  Saving model state dict ...
Epoch: 5 cost time: 0.7296566963195801
Epoch: 5, Steps: 123 | Train Loss: 0.5853510 Vali Loss: 0.5425307 Best vali loss: 0.5425307
	iters: 100, epoch: 6 | loss: 0.6328988
	speed: 0.0094s/iter; left time: 2.5321s
Updating learning rate to 1.944991967750357e-05
Validation loss decreased (0.5425 --> 0.5411).  Saving model state dict ...
Epoch: 6 cost time: 0.7291886806488037
Epoch: 6, Steps: 123 | Train Loss: 0.6328988 Vali Loss: 0.5410920 Best vali loss: 0.5410920
	iters: 100, epoch: 7 | loss: 0.5985466
	speed: 0.0093s/iter; left time: 1.3658s
Updating learning rate to 5.054869431485431e-06
Validation loss decreased (0.5411 --> 0.5352).  Saving model state dict ...
Epoch: 7 cost time: 0.7171990871429443
Epoch: 7, Steps: 123 | Train Loss: 0.5985466 Vali Loss: 0.5352069 Best vali loss: 0.5352069
	iters: 100, epoch: 8 | loss: 0.7584171
	speed: 0.0094s/iter; left time: 0.2267s
Updating learning rate to 0.0
Validation loss decreased (0.5352 --> 0.5331).  Saving model state dict ...
Epoch: 8 cost time: 0.7361345291137695
Epoch: 8, Steps: 123 | Train Loss: 0.7584171 Vali Loss: 0.5331345 Best vali loss: 0.5331345

best validation loss 0.5331344692202863

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0027526171971, 'e_layers': 4, 'learning_rate': 0.0001237621899, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9486688
	speed: 0.0117s/iter; left time: 21.7297s
	iters: 200, epoch: 1 | loss: 0.6171440
	speed: 0.0054s/iter; left time: 9.5045s
Updating learning rate to 0.0001237621899
Validation loss decreased (inf --> 0.6003).  Saving model state dict ...
Epoch: 1 cost time: 1.683765172958374
Epoch: 1, Steps: 245 | Train Loss: 0.7829064 Vali Loss: 0.6003354 Best vali loss: 0.6003354
	iters: 100, epoch: 2 | loss: 0.9412800
	speed: 0.0110s/iter; left time: 17.7300s
	iters: 200, epoch: 2 | loss: 1.3173407
	speed: 0.0052s/iter; left time: 7.9011s
Updating learning rate to 6.188109495e-05
Validation loss decreased (0.6003 --> 0.5938).  Saving model state dict ...
Epoch: 2 cost time: 1.3467068672180176
Epoch: 2, Steps: 245 | Train Loss: 1.1293104 Vali Loss: 0.5937606 Best vali loss: 0.5937606
	iters: 100, epoch: 3 | loss: 0.5442414
	speed: 0.0111s/iter; left time: 15.2091s
	iters: 200, epoch: 3 | loss: 0.7753701
	speed: 0.0057s/iter; left time: 7.2808s
Updating learning rate to 3.0940547475e-05
Validation loss decreased (0.5938 --> 0.5559).  Saving model state dict ...
Epoch: 3 cost time: 1.4495375156402588
Epoch: 3, Steps: 245 | Train Loss: 0.6598057 Vali Loss: 0.5558502 Best vali loss: 0.5558502
	iters: 100, epoch: 4 | loss: 0.8236770
	speed: 0.0112s/iter; left time: 12.5953s
	iters: 200, epoch: 4 | loss: 0.5219545
	speed: 0.0058s/iter; left time: 5.9651s
Updating learning rate to 1.54702737375e-05
Epoch: 4 cost time: 1.4673006534576416
Epoch: 4, Steps: 245 | Train Loss: 0.6728157 Vali Loss: 0.5568309 Best vali loss: 0.5558502
	iters: 100, epoch: 5 | loss: 0.8501887
	speed: 0.0111s/iter; left time: 9.7979s
	iters: 200, epoch: 5 | loss: 0.7924449
	speed: 0.0056s/iter; left time: 4.3872s
Updating learning rate to 7.73513686875e-06
Validation loss decreased (0.5559 --> 0.5487).  Saving model state dict ...
Epoch: 5 cost time: 1.4383080005645752
Epoch: 5, Steps: 245 | Train Loss: 0.8213168 Vali Loss: 0.5486896 Best vali loss: 0.5486896
	iters: 100, epoch: 6 | loss: 0.7247165
	speed: 0.0108s/iter; left time: 6.8551s
	iters: 200, epoch: 6 | loss: 0.7314053
	speed: 0.0056s/iter; left time: 2.9836s
Updating learning rate to 3.867568434375e-06
Validation loss decreased (0.5487 --> 0.5481).  Saving model state dict ...
Epoch: 6 cost time: 1.4001555442810059
Epoch: 6, Steps: 245 | Train Loss: 0.7280609 Vali Loss: 0.5480822 Best vali loss: 0.5480822
	iters: 100, epoch: 7 | loss: 0.7143412
	speed: 0.0111s/iter; left time: 4.3539s
	iters: 200, epoch: 7 | loss: 0.4284504
	speed: 0.0058s/iter; left time: 1.6772s
Updating learning rate to 1.9337842171875e-06
Epoch: 7 cost time: 1.457496166229248
Epoch: 7, Steps: 245 | Train Loss: 0.5713958 Vali Loss: 0.5496094 Best vali loss: 0.5480822
	iters: 100, epoch: 8 | loss: 0.7324380
	speed: 0.0110s/iter; left time: 1.6095s
	iters: 200, epoch: 8 | loss: 0.6852121
	speed: 0.0058s/iter; left time: 0.2669s
Updating learning rate to 9.6689210859375e-07
Epoch: 8 cost time: 1.464169979095459
Epoch: 8, Steps: 245 | Train Loss: 0.7088251 Vali Loss: 0.5503618 Best vali loss: 0.5480822

best validation loss 0.5480821746358823

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043944941741, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616891
	speed: 0.0118s/iter; left time: 10.4157s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0348310470581055
Epoch: 1, Steps: 123 | Train Loss: 0.7616891 Vali Loss: 0.6075471 Best vali loss: 0.6075471
	iters: 100, epoch: 2 | loss: 0.9369404
	speed: 0.0092s/iter; left time: 7.0053s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6075 --> 0.5725).  Saving model state dict ...
Epoch: 2 cost time: 0.7213358879089355
Epoch: 2, Steps: 123 | Train Loss: 0.9369404 Vali Loss: 0.5724545 Best vali loss: 0.5724545
	iters: 100, epoch: 3 | loss: 0.8545300
	speed: 0.0095s/iter; left time: 6.0401s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5725 --> 0.5427).  Saving model state dict ...
Epoch: 3 cost time: 0.7259109020233154
Epoch: 3, Steps: 123 | Train Loss: 0.8545300 Vali Loss: 0.5427419 Best vali loss: 0.5427419

best validation loss 0.5427418627544776

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043832053364, 'e_layers': 2, 'learning_rate': 0.000135392147, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7559019
	speed: 0.0116s/iter; left time: 10.2467s
Updating learning rate to 0.0001302390902380297
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.0177512168884277
Epoch: 1, Steps: 123 | Train Loss: 0.7559019 Vali Loss: 0.6040365 Best vali loss: 0.6040365
	iters: 100, epoch: 2 | loss: 0.9373202
	speed: 0.0093s/iter; left time: 7.0724s
Updating learning rate to 0.00011556442613155294
Validation loss decreased (0.6040 --> 0.5833).  Saving model state dict ...
Epoch: 2 cost time: 0.7181634902954102
Epoch: 2, Steps: 123 | Train Loss: 0.9373202 Vali Loss: 0.5833288 Best vali loss: 0.5833288
	iters: 100, epoch: 3 | loss: 0.8715799
	speed: 0.0094s/iter; left time: 6.0286s
Updating learning rate to 9.36022392646194e-05
Validation loss decreased (0.5833 --> 0.5598).  Saving model state dict ...
Epoch: 3 cost time: 0.7210922241210938
Epoch: 3, Steps: 123 | Train Loss: 0.8715799 Vali Loss: 0.5598097 Best vali loss: 0.5598097

best validation loss 0.5598096985168227

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043821658323, 'e_layers': 2, 'learning_rate': 0.0001350450529, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7558346
	speed: 0.0117s/iter; left time: 10.3347s
Updating learning rate to 0.000129905206620607
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.024219036102295
Epoch: 1, Steps: 123 | Train Loss: 0.7558346 Vali Loss: 0.6039874 Best vali loss: 0.6039874
	iters: 100, epoch: 2 | loss: 0.9402921
	speed: 0.0093s/iter; left time: 7.0551s
Updating learning rate to 0.00011526816278564302
Validation loss decreased (0.6040 --> 0.5882).  Saving model state dict ...
Epoch: 2 cost time: 0.7236099243164062
Epoch: 2, Steps: 123 | Train Loss: 0.9402921 Vali Loss: 0.5882416 Best vali loss: 0.5882416
	iters: 100, epoch: 3 | loss: 0.8623338
	speed: 0.0094s/iter; left time: 5.9792s
Updating learning rate to 9.336227863384857e-05
Validation loss decreased (0.5882 --> 0.5602).  Saving model state dict ...
Epoch: 3 cost time: 0.7305190563201904
Epoch: 3, Steps: 123 | Train Loss: 0.8623338 Vali Loss: 0.5601896 Best vali loss: 0.5601896

best validation loss 0.5601896430429956

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043944941741, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5992897
	speed: 0.0119s/iter; left time: 6.1521s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5427 --> 0.5351).  Saving model state dict ...
Epoch: 4 cost time: 1.0249419212341309
Epoch: 4, Steps: 123 | Train Loss: 0.5992897 Vali Loss: 0.5350787 Best vali loss: 0.5350787
	iters: 100, epoch: 5 | loss: 0.8434851
	speed: 0.0093s/iter; left time: 3.6490s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5351 --> 0.5295).  Saving model state dict ...
Epoch: 5 cost time: 0.7235622406005859
Epoch: 5, Steps: 123 | Train Loss: 0.8434851 Vali Loss: 0.5295400 Best vali loss: 0.5295400
	iters: 100, epoch: 6 | loss: 0.8087053
	speed: 0.0094s/iter; left time: 2.5371s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7251670360565186
Epoch: 6, Steps: 123 | Train Loss: 0.8087053 Vali Loss: 0.5301899 Best vali loss: 0.5295400
	iters: 100, epoch: 7 | loss: 0.4789566
	speed: 0.0091s/iter; left time: 1.3367s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5295 --> 0.5286).  Saving model state dict ...
Epoch: 7 cost time: 0.7216556072235107
Epoch: 7, Steps: 123 | Train Loss: 0.4789566 Vali Loss: 0.5286154 Best vali loss: 0.5286154
	iters: 100, epoch: 8 | loss: 0.5503602
	speed: 0.0095s/iter; left time: 0.2290s
Updating learning rate to 0.0
Validation loss decreased (0.5286 --> 0.5252).  Saving model state dict ...
Epoch: 8 cost time: 0.7242231369018555
Epoch: 8, Steps: 123 | Train Loss: 0.5503602 Vali Loss: 0.5252136 Best vali loss: 0.5252136

best validation loss 0.525213649321463

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043729038743, 'e_layers': 2, 'learning_rate': 0.0001331099106, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7555022
	speed: 0.0116s/iter; left time: 10.2272s
Updating learning rate to 0.00012804371628887359
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 1.0262839794158936
Epoch: 1, Steps: 123 | Train Loss: 0.7555022 Vali Loss: 0.6038246 Best vali loss: 0.6038246
	iters: 100, epoch: 2 | loss: 0.9400179
	speed: 0.0092s/iter; left time: 7.0341s
Updating learning rate to 0.00011361641551419753
Validation loss decreased (0.6038 --> 0.5891).  Saving model state dict ...
Epoch: 2 cost time: 0.72389817237854
Epoch: 2, Steps: 123 | Train Loss: 0.9400179 Vali Loss: 0.5890889 Best vali loss: 0.5890889
	iters: 100, epoch: 3 | loss: 0.8652580
	speed: 0.0094s/iter; left time: 5.9860s
Updating learning rate to 9.202443403510912e-05
Validation loss decreased (0.5891 --> 0.5599).  Saving model state dict ...
Epoch: 3 cost time: 0.7243564128875732
Epoch: 3, Steps: 123 | Train Loss: 0.8652580 Vali Loss: 0.5598576 Best vali loss: 0.5598576
	iters: 100, epoch: 4 | loss: 0.5062683
	speed: 0.0092s/iter; left time: 4.7632s
Updating learning rate to 6.65549553e-05
Validation loss decreased (0.5599 --> 0.5436).  Saving model state dict ...
Epoch: 4 cost time: 0.7163758277893066
Epoch: 4, Steps: 123 | Train Loss: 0.5062683 Vali Loss: 0.5435582 Best vali loss: 0.5435582
	iters: 100, epoch: 5 | loss: 0.5805338
	speed: 0.0092s/iter; left time: 3.6245s
Updating learning rate to 4.108547656489087e-05
Validation loss decreased (0.5436 --> 0.5373).  Saving model state dict ...
Epoch: 5 cost time: 0.7121853828430176
Epoch: 5, Steps: 123 | Train Loss: 0.5805338 Vali Loss: 0.5373106 Best vali loss: 0.5373106
	iters: 100, epoch: 6 | loss: 0.6332777
	speed: 0.0092s/iter; left time: 2.4887s
Updating learning rate to 1.949349508580245e-05
Validation loss decreased (0.5373 --> 0.5358).  Saving model state dict ...
Epoch: 6 cost time: 0.71695876121521
Epoch: 6, Steps: 123 | Train Loss: 0.6332777 Vali Loss: 0.5357606 Best vali loss: 0.5357606
	iters: 100, epoch: 7 | loss: 0.5990087
	speed: 0.0093s/iter; left time: 1.3665s
Updating learning rate to 5.066194311126414e-06
Validation loss decreased (0.5358 --> 0.5326).  Saving model state dict ...
Epoch: 7 cost time: 0.7203989028930664
Epoch: 7, Steps: 123 | Train Loss: 0.5990087 Vali Loss: 0.5325991 Best vali loss: 0.5325991
	iters: 100, epoch: 8 | loss: 0.7593648
	speed: 0.0094s/iter; left time: 0.2248s
Updating learning rate to 0.0
Validation loss decreased (0.5326 --> 0.5294).  Saving model state dict ...
Epoch: 8 cost time: 0.720426082611084
Epoch: 8, Steps: 123 | Train Loss: 0.7593648 Vali Loss: 0.5294421 Best vali loss: 0.5294421

best validation loss 0.529442113508289

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978670278, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744470
	speed: 0.0116s/iter; left time: 10.2930s
Updating learning rate to 0.0002865301390971952
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.017195463180542
Epoch: 1, Steps: 123 | Train Loss: 0.7744470 Vali Loss: 0.6172640 Best vali loss: 0.6172640
	iters: 100, epoch: 2 | loss: 0.9497870
	speed: 0.0091s/iter; left time: 6.9588s
Updating learning rate to 0.0002542454115246309
Validation loss decreased (0.6173 --> 0.5782).  Saving model state dict ...
Epoch: 2 cost time: 0.7225043773651123
Epoch: 2, Steps: 123 | Train Loss: 0.9497870 Vali Loss: 0.5781831 Best vali loss: 0.5781831
	iters: 100, epoch: 3 | loss: 0.8429810
	speed: 0.0095s/iter; left time: 6.0388s
Updating learning rate to 0.0002059279021934458
Validation loss decreased (0.5782 --> 0.5428).  Saving model state dict ...
Epoch: 3 cost time: 0.7216999530792236
Epoch: 3, Steps: 123 | Train Loss: 0.8429810 Vali Loss: 0.5428308 Best vali loss: 0.5428308
	iters: 100, epoch: 4 | loss: 0.5025613
	speed: 0.0094s/iter; left time: 4.8263s
Updating learning rate to 0.0001489335139
Validation loss decreased (0.5428 --> 0.5376).  Saving model state dict ...
Epoch: 4 cost time: 0.7228450775146484
Epoch: 4, Steps: 123 | Train Loss: 0.5025613 Vali Loss: 0.5376397 Best vali loss: 0.5376397
	iters: 100, epoch: 5 | loss: 0.5576718
	speed: 0.0093s/iter; left time: 3.6501s
Updating learning rate to 9.19391256065542e-05
Validation loss decreased (0.5376 --> 0.5225).  Saving model state dict ...
Epoch: 5 cost time: 0.7219746112823486
Epoch: 5, Steps: 123 | Train Loss: 0.5576718 Vali Loss: 0.5224642 Best vali loss: 0.5224642
	iters: 100, epoch: 6 | loss: 0.5819016
	speed: 0.0093s/iter; left time: 2.5124s
Updating learning rate to 4.3621616275369076e-05
Epoch: 6 cost time: 0.7190442085266113
Epoch: 6, Steps: 123 | Train Loss: 0.5819016 Vali Loss: 0.5340598 Best vali loss: 0.5224642
	iters: 100, epoch: 7 | loss: 0.5340999
	speed: 0.0089s/iter; left time: 1.3102s
Updating learning rate to 1.1336888702804773e-05
Epoch: 7 cost time: 0.7147183418273926
Epoch: 7, Steps: 123 | Train Loss: 0.5340999 Vali Loss: 0.5362807 Best vali loss: 0.5224642
	iters: 100, epoch: 8 | loss: 0.6947572
	speed: 0.0091s/iter; left time: 0.2195s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7217116355895996
Epoch: 8, Steps: 123 | Train Loss: 0.6947572 Vali Loss: 0.5433763 Best vali loss: 0.5224642

best validation loss 0.5224641991235326

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001065394999, 'e_layers': 2, 'learning_rate': 0.0010974296678, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010556612381255404
Validation loss decreased (inf --> 0.6095).  Saving model state dict ...
Epoch: 1 cost time: 0.8388230800628662
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6095072 Best vali loss: 0.6095072
Updating learning rate to 0.00093671481388834
Validation loss decreased (0.6095 --> 0.6031).  Saving model state dict ...
Epoch: 2 cost time: 0.5377178192138672
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6031450 Best vali loss: 0.6031450
Updating learning rate to 0.0007586989099264922
Epoch: 3 cost time: 0.5489263534545898
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6068011 Best vali loss: 0.6031450

best validation loss 0.6031449736405831

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067483075993, 'e_layers': 1, 'learning_rate': 0.0005240520398, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7317579
	speed: 0.0089s/iter; left time: 33.9016s
	iters: 200, epoch: 1 | loss: 0.8440443
	speed: 0.0027s/iter; left time: 10.0439s
	iters: 300, epoch: 1 | loss: 0.9309601
	speed: 0.0028s/iter; left time: 10.1222s
	iters: 400, epoch: 1 | loss: 0.7544223
	speed: 0.0029s/iter; left time: 10.0837s
Updating learning rate to 0.0005041064966710051
Validation loss decreased (inf --> 0.6026).  Saving model state dict ...
Epoch: 1 cost time: 1.698822021484375
Epoch: 1, Steps: 490 | Train Loss: 0.8152962 Vali Loss: 0.6026313 Best vali loss: 0.6026313
	iters: 100, epoch: 2 | loss: 1.0777212
	speed: 0.0083s/iter; left time: 27.6052s
	iters: 200, epoch: 2 | loss: 0.7384226
	speed: 0.0025s/iter; left time: 8.1735s
	iters: 300, epoch: 2 | loss: 0.9987431
	speed: 0.0025s/iter; left time: 7.8969s
	iters: 400, epoch: 2 | loss: 1.2077445
	speed: 0.0025s/iter; left time: 7.6350s
Updating learning rate to 0.00044730639541861123
Epoch: 2 cost time: 1.2836558818817139
Epoch: 2, Steps: 490 | Train Loss: 1.0056579 Vali Loss: 0.6062525 Best vali loss: 0.6026313
	iters: 100, epoch: 3 | loss: 0.7886538
	speed: 0.0080s/iter; left time: 22.6224s
	iters: 200, epoch: 3 | loss: 0.8486762
	speed: 0.0028s/iter; left time: 7.6156s
	iters: 300, epoch: 3 | loss: 0.7735808
	speed: 0.0027s/iter; left time: 7.2418s
	iters: 400, epoch: 3 | loss: 0.7583683
	speed: 0.0028s/iter; left time: 7.2404s
Updating learning rate to 0.00036229903656429533
Epoch: 3 cost time: 1.40976881980896
Epoch: 3, Steps: 490 | Train Loss: 0.7923198 Vali Loss: 0.6048546 Best vali loss: 0.6026313

best validation loss 0.6026313091968287

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010964070211, 'e_layers': 2, 'learning_rate': 0.0008097628606, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007789430968480651
Validation loss decreased (inf --> 0.5988).  Saving model state dict ...
Epoch: 1 cost time: 0.8355321884155273
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5988059 Best vali loss: 0.5988059
Updating learning rate to 0.0006911758352416385
Epoch: 2 cost time: 0.5291187763214111
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6122877 Best vali loss: 0.5988059
Updating learning rate to 0.0005598228457480909
Epoch: 3 cost time: 0.5271604061126709
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6128388 Best vali loss: 0.5988059

best validation loss 0.5988058861567432

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010964070211, 'e_layers': 2, 'learning_rate': 0.0008097628606, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0004048814303
Epoch: 4 cost time: 0.8329207897186279
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6241016 Best vali loss: 0.5988059
Updating learning rate to 0.0002499400148519092
Epoch: 5 cost time: 0.5401029586791992
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6431730 Best vali loss: 0.5988059
Updating learning rate to 0.00011858702535836154
Epoch: 6 cost time: 0.5430400371551514
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6084671 Best vali loss: 0.5988059
Updating learning rate to 3.0819763751934876e-05
Epoch: 7 cost time: 0.5350911617279053
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6214899 Best vali loss: 0.5988059
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5465114116668701
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6218097 Best vali loss: 0.5988059

best validation loss 0.5988058861567432

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001107131387, 'e_layers': 2, 'learning_rate': 0.0009010299086, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0008667364996680277
Validation loss decreased (inf --> 0.5958).  Saving model state dict ...
Epoch: 1 cost time: 0.8481111526489258
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5958304 Best vali loss: 0.5958304
Updating learning rate to 0.0007690771335114774
Validation loss decreased (0.5958 --> 0.5524).  Saving model state dict ...
Epoch: 2 cost time: 0.5285758972167969
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5524222 Best vali loss: 0.5524222
Updating learning rate to 0.0006229195633433255
Epoch: 3 cost time: 0.5396614074707031
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5620677 Best vali loss: 0.5524222
Updating learning rate to 0.0004505149543
Epoch: 4 cost time: 0.5355191230773926
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5576853 Best vali loss: 0.5524222
Updating learning rate to 0.00027811034525667447
Epoch: 5 cost time: 0.5376603603363037
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5600376 Best vali loss: 0.5524222
Updating learning rate to 0.00013195277508852246
Epoch: 6 cost time: 0.5401294231414795
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5728763 Best vali loss: 0.5524222
Updating learning rate to 3.429340893197229e-05
Epoch: 7 cost time: 0.532548189163208
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5910643 Best vali loss: 0.5524222
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5323944091796875
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5873992 Best vali loss: 0.5524222

best validation loss 0.5524222373355598

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011015595043, 'e_layers': 2, 'learning_rate': 0.0010735676603, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010327074242086
Validation loss decreased (inf --> 0.6047).  Saving model state dict ...
Epoch: 1 cost time: 0.8411507606506348
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6047299 Best vali loss: 0.6047299
Updating learning rate to 0.000916347316480353
Validation loss decreased (0.6047 --> 0.6025).  Saving model state dict ...
Epoch: 2 cost time: 0.5378224849700928
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6025289 Best vali loss: 0.6025289
Updating learning rate to 0.0007422021087098814
Epoch: 3 cost time: 0.5365936756134033
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6206752 Best vali loss: 0.6025289
Updating learning rate to 0.00053678383015
Epoch: 4 cost time: 0.5360310077667236
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6536493 Best vali loss: 0.6025289
Updating learning rate to 0.0003313655515901187
Epoch: 5 cost time: 0.5350463390350342
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6292184 Best vali loss: 0.6025289
Updating learning rate to 0.0001572203438196471
Epoch: 6 cost time: 0.5412874221801758
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6269795 Best vali loss: 0.6025289
Updating learning rate to 4.086023609140006e-05
Epoch: 7 cost time: 0.5353505611419678
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6401039 Best vali loss: 0.6025289
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5413312911987305
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6416723 Best vali loss: 0.6025289

best validation loss 0.602528946562974

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0065414485283, 'e_layers': 2, 'learning_rate': 0.0020888666457, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020093638929038677
Validation loss decreased (inf --> 0.6168).  Saving model state dict ...
Epoch: 1 cost time: 0.7474467754364014
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6168490 Best vali loss: 0.6168490
Updating learning rate to 0.0017829592079344335
Epoch: 2 cost time: 0.46085453033447266
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6393374 Best vali loss: 0.6168490
Updating learning rate to 0.001444120651714714
Epoch: 3 cost time: 0.4589669704437256
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6270433 Best vali loss: 0.6168490

best validation loss 0.6168489991542864

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.005593408041, 'e_layers': 2, 'learning_rate': 0.0022765011284, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0021898569633338042
Validation loss decreased (inf --> 0.6400).  Saving model state dict ...
Epoch: 1 cost time: 0.7876019477844238
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6399707 Best vali loss: 0.6399707
Updating learning rate to 0.0019431152568352337
Validation loss decreased (0.6400 --> 0.6106).  Saving model state dict ...
Epoch: 2 cost time: 0.4617185592651367
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6106363 Best vali loss: 0.6106363
Updating learning rate to 0.0015738401969995562
Epoch: 3 cost time: 0.4597744941711426
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6258506 Best vali loss: 0.6106363

best validation loss 0.6106362732291939

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0040175802363, 'e_layers': 3, 'learning_rate': 0.0026083875, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0026083875
Validation loss decreased (inf --> 0.6396).  Saving model state dict ...
Epoch: 1 cost time: 0.7420575618743896
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6396065 Best vali loss: 0.6396065
Updating learning rate to 0.00130419375
Validation loss decreased (0.6396 --> 0.6283).  Saving model state dict ...
Epoch: 2 cost time: 0.46107006072998047
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6282960 Best vali loss: 0.6282960
Updating learning rate to 0.000652096875
Validation loss decreased (0.6283 --> 0.6216).  Saving model state dict ...
Epoch: 3 cost time: 0.46106553077697754
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6215606 Best vali loss: 0.6215606

best validation loss 0.6215605649171412

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.005593408041, 'e_layers': 2, 'learning_rate': 0.0022765011284, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0011382505642
Epoch: 4 cost time: 0.7625253200531006
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6234247 Best vali loss: 0.6106363
Updating learning rate to 0.0007026609314004441
Epoch: 5 cost time: 0.46269893646240234
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6113315 Best vali loss: 0.6106363
Updating learning rate to 0.00033338587156476644
Epoch: 6 cost time: 0.45680832862854004
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6334611 Best vali loss: 0.6106363
Updating learning rate to 8.664416506619564e-05
Epoch: 7 cost time: 0.4577748775482178
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6500140 Best vali loss: 0.6106363
Updating learning rate to 0.0
Epoch: 8 cost time: 0.46405553817749023
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6394155 Best vali loss: 0.6106363

best validation loss 0.6106362732291939

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.001237572349, 'e_layers': 4, 'learning_rate': 0.0001621301522, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0137053
	speed: 0.0128s/iter; left time: 11.3479s
Updating learning rate to 0.0001621301522
Validation loss decreased (inf --> 0.6178).  Saving model state dict ...
Epoch: 1 cost time: 1.1519277095794678
Epoch: 1, Steps: 123 | Train Loss: 1.0137053 Vali Loss: 0.6177905 Best vali loss: 0.6177905
	iters: 100, epoch: 2 | loss: 0.9260867
	speed: 0.0101s/iter; left time: 7.7207s
Updating learning rate to 8.10650761e-05
Validation loss decreased (0.6178 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 0.8446731567382812
Epoch: 2, Steps: 123 | Train Loss: 0.9260867 Vali Loss: 0.6035828 Best vali loss: 0.6035828
	iters: 100, epoch: 3 | loss: 1.2416883
	speed: 0.0097s/iter; left time: 6.2258s
Updating learning rate to 4.053253805e-05
Epoch: 3 cost time: 0.7830612659454346
Epoch: 3, Steps: 123 | Train Loss: 1.2416883 Vali Loss: 0.6051349 Best vali loss: 0.6035828
	iters: 100, epoch: 4 | loss: 0.7635975
	speed: 0.0096s/iter; left time: 4.9662s
Updating learning rate to 2.0266269025e-05
Epoch: 4 cost time: 0.8096661567687988
Epoch: 4, Steps: 123 | Train Loss: 0.7635975 Vali Loss: 0.6051207 Best vali loss: 0.6035828
	iters: 100, epoch: 5 | loss: 0.7595669
	speed: 0.0097s/iter; left time: 3.8101s
Updating learning rate to 1.01331345125e-05
Validation loss decreased (0.6036 --> 0.6035).  Saving model state dict ...
Epoch: 5 cost time: 0.7980132102966309
Epoch: 5, Steps: 123 | Train Loss: 0.7595669 Vali Loss: 0.6035198 Best vali loss: 0.6035198
	iters: 100, epoch: 6 | loss: 0.7565507
	speed: 0.0099s/iter; left time: 2.6664s
Updating learning rate to 5.06656725625e-06
Epoch: 6 cost time: 0.81221604347229
Epoch: 6, Steps: 123 | Train Loss: 0.7565507 Vali Loss: 0.6042831 Best vali loss: 0.6035198
	iters: 100, epoch: 7 | loss: 0.7607445
	speed: 0.0097s/iter; left time: 1.4239s
Updating learning rate to 2.533283628125e-06
Epoch: 7 cost time: 0.7905433177947998
Epoch: 7, Steps: 123 | Train Loss: 0.7607445 Vali Loss: 0.6048623 Best vali loss: 0.6035198
	iters: 100, epoch: 8 | loss: 0.8601574
	speed: 0.0098s/iter; left time: 0.2357s
Updating learning rate to 1.2666418140625e-06
Epoch: 8 cost time: 0.8261620998382568
Epoch: 8, Steps: 123 | Train Loss: 0.8601574 Vali Loss: 0.6050373 Best vali loss: 0.6035198

best validation loss 0.6035197586276254

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010327316655, 'e_layers': 2, 'learning_rate': 0.0004754164545, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004754164545
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 0.7454876899719238
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6031311 Best vali loss: 0.6031311
Updating learning rate to 0.00023770822725
Validation loss decreased (0.6031 --> 0.5695).  Saving model state dict ...
Epoch: 2 cost time: 0.45509839057922363
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5694634 Best vali loss: 0.5694634
Updating learning rate to 0.000118854113625
Validation loss decreased (0.5695 --> 0.5559).  Saving model state dict ...
Epoch: 3 cost time: 0.45505213737487793
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5559214 Best vali loss: 0.5559214
Updating learning rate to 5.94270568125e-05
Epoch: 4 cost time: 0.4592602252960205
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5675872 Best vali loss: 0.5559214
Updating learning rate to 2.971352840625e-05
Validation loss decreased (0.5559 --> 0.5551).  Saving model state dict ...
Epoch: 5 cost time: 0.45047545433044434
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5550651 Best vali loss: 0.5550651
Updating learning rate to 1.4856764203125e-05
Validation loss decreased (0.5551 --> 0.5515).  Saving model state dict ...
Epoch: 6 cost time: 0.4609386920928955
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5514634 Best vali loss: 0.5514634
Updating learning rate to 7.4283821015625e-06
Validation loss decreased (0.5515 --> 0.5496).  Saving model state dict ...
Epoch: 7 cost time: 0.4606456756591797
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5495647 Best vali loss: 0.5495647
Updating learning rate to 3.71419105078125e-06
Epoch: 8 cost time: 0.4564213752746582
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5502847 Best vali loss: 0.5495647

best validation loss 0.5495646728624187

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010650118274, 'e_layers': 2, 'learning_rate': 0.0004720022756, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004720022756
Validation loss decreased (inf --> 0.5983).  Saving model state dict ...
Epoch: 1 cost time: 0.7500607967376709
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5983453 Best vali loss: 0.5983453
Updating learning rate to 0.0002360011378
Validation loss decreased (0.5983 --> 0.5666).  Saving model state dict ...
Epoch: 2 cost time: 0.4629936218261719
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5666142 Best vali loss: 0.5666142
Updating learning rate to 0.0001180005689
Epoch: 3 cost time: 0.46141672134399414
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5723047 Best vali loss: 0.5666142

best validation loss 0.5666141644333976

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0084933762683, 'e_layers': 2, 'learning_rate': 0.0003122235144, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7313586
	speed: 0.0116s/iter; left time: 10.2967s
Updating learning rate to 0.0003003402144614515
Validation loss decreased (inf --> 0.5946).  Saving model state dict ...
Epoch: 1 cost time: 0.9918704032897949
Epoch: 1, Steps: 123 | Train Loss: 0.7313586 Vali Loss: 0.5946434 Best vali loss: 0.5946434
	iters: 100, epoch: 2 | loss: 0.7812908
	speed: 0.0084s/iter; left time: 6.4244s
Updating learning rate to 0.00026649943933906785
Validation loss decreased (0.5946 --> 0.5759).  Saving model state dict ...
Epoch: 2 cost time: 0.6603841781616211
Epoch: 2, Steps: 123 | Train Loss: 0.7812908 Vali Loss: 0.5759411 Best vali loss: 0.5759411
	iters: 100, epoch: 3 | loss: 0.7304028
	speed: 0.0082s/iter; left time: 5.2487s
Updating learning rate to 0.00021585314027784154
Epoch: 3 cost time: 0.6191229820251465
Epoch: 3, Steps: 123 | Train Loss: 0.7304028 Vali Loss: 0.5778033 Best vali loss: 0.5759411

best validation loss 0.5759411395589051

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010674455935, 'e_layers': 2, 'learning_rate': 0.0006335633007, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006335633007
Validation loss decreased (inf --> 0.6451).  Saving model state dict ...
Epoch: 1 cost time: 0.7570199966430664
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6451123 Best vali loss: 0.6451123
Updating learning rate to 0.00031678165035
Validation loss decreased (0.6451 --> 0.5555).  Saving model state dict ...
Epoch: 2 cost time: 0.4651167392730713
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5554857 Best vali loss: 0.5554857
Updating learning rate to 0.000158390825175
Validation loss decreased (0.5555 --> 0.5472).  Saving model state dict ...
Epoch: 3 cost time: 0.4659850597381592
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5471733 Best vali loss: 0.5471733

best validation loss 0.547173333631407

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010674455935, 'e_layers': 2, 'learning_rate': 0.0006335633007, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 7.91954125875e-05
Validation loss decreased (0.5472 --> 0.5419).  Saving model state dict ...
Epoch: 4 cost time: 0.748023509979248
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5419471 Best vali loss: 0.5419471
Updating learning rate to 3.959770629375e-05
Validation loss decreased (0.5419 --> 0.5417).  Saving model state dict ...
Epoch: 5 cost time: 0.4694063663482666
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5416963 Best vali loss: 0.5416963
Updating learning rate to 1.9798853146875e-05
Validation loss decreased (0.5417 --> 0.5400).  Saving model state dict ...
Epoch: 6 cost time: 0.4667630195617676
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5400432 Best vali loss: 0.5400432
Updating learning rate to 9.8994265734375e-06
Epoch: 7 cost time: 0.4679410457611084
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5424720 Best vali loss: 0.5400432
Updating learning rate to 4.94971328671875e-06
Validation loss decreased (0.5400 --> 0.5399).  Saving model state dict ...
Epoch: 8 cost time: 0.4637331962585449
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5399432 Best vali loss: 0.5399432

best validation loss 0.5399432000270986

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010538741601, 'e_layers': 4, 'learning_rate': 0.0004671081209, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004671081209
Validation loss decreased (inf --> 0.6113).  Saving model state dict ...
Epoch: 1 cost time: 1.0624291896820068
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6112508 Best vali loss: 0.6112508
Updating learning rate to 0.00023355406045
Validation loss decreased (0.6113 --> 0.6030).  Saving model state dict ...
Epoch: 2 cost time: 0.7698953151702881
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6029825 Best vali loss: 0.6029825
Updating learning rate to 0.000116777030225
Validation loss decreased (0.6030 --> 0.5587).  Saving model state dict ...
Epoch: 3 cost time: 0.7696287631988525
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5587367 Best vali loss: 0.5587367
Updating learning rate to 5.83885151125e-05
Validation loss decreased (0.5587 --> 0.5446).  Saving model state dict ...
Epoch: 4 cost time: 0.7726271152496338
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5446329 Best vali loss: 0.5446329
Updating learning rate to 2.919425755625e-05
Epoch: 5 cost time: 0.7747073173522949
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5476661 Best vali loss: 0.5446329
Updating learning rate to 1.4597128778125e-05
Epoch: 6 cost time: 0.7727341651916504
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5465422 Best vali loss: 0.5446329
Updating learning rate to 7.2985643890625e-06
Validation loss decreased (0.5446 --> 0.5436).  Saving model state dict ...
Epoch: 7 cost time: 0.7741446495056152
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5436166 Best vali loss: 0.5436166
Updating learning rate to 3.64928219453125e-06
Epoch: 8 cost time: 0.7706851959228516
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5445261 Best vali loss: 0.5436166

best validation loss 0.5436165518145052

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010467233269, 'e_layers': 4, 'learning_rate': 0.0004727438249, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004547510844231048
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 1.0492963790893555
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6111396 Best vali loss: 0.6111396
Updating learning rate to 0.0004035120946254279
Validation loss decreased (0.6111 --> 0.5992).  Saving model state dict ...
Epoch: 2 cost time: 0.7753190994262695
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5991705 Best vali loss: 0.5991705
Updating learning rate to 0.0003268275272210665
Validation loss decreased (0.5992 --> 0.5542).  Saving model state dict ...
Epoch: 3 cost time: 0.7726237773895264
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5542336 Best vali loss: 0.5542336
Updating learning rate to 0.00023637191245
Validation loss decreased (0.5542 --> 0.5406).  Saving model state dict ...
Epoch: 4 cost time: 0.7725849151611328
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5406233 Best vali loss: 0.5406233
Updating learning rate to 0.0001459162976789335
Epoch: 5 cost time: 0.7762107849121094
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5513759 Best vali loss: 0.5406233
Updating learning rate to 6.92317302745721e-05
Epoch: 6 cost time: 0.7654623985290527
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5668475 Best vali loss: 0.5406233
Updating learning rate to 1.7992740476895203e-05
Epoch: 7 cost time: 0.7675011157989502
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5820346 Best vali loss: 0.5406233
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7660353183746338
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5847836 Best vali loss: 0.5406233

best validation loss 0.5406232937680853

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043915924708, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616583
	speed: 0.0118s/iter; left time: 10.4111s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.033421277999878
Epoch: 1, Steps: 123 | Train Loss: 0.7616583 Vali Loss: 0.6075469 Best vali loss: 0.6075469
	iters: 100, epoch: 2 | loss: 0.9345808
	speed: 0.0093s/iter; left time: 7.0781s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6075 --> 0.5636).  Saving model state dict ...
Epoch: 2 cost time: 0.7292346954345703
Epoch: 2, Steps: 123 | Train Loss: 0.9345808 Vali Loss: 0.5635762 Best vali loss: 0.5635762
	iters: 100, epoch: 3 | loss: 0.8624537
	speed: 0.0095s/iter; left time: 6.0445s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5636 --> 0.5504).  Saving model state dict ...
Epoch: 3 cost time: 0.7260959148406982
Epoch: 3, Steps: 123 | Train Loss: 0.8624537 Vali Loss: 0.5503652 Best vali loss: 0.5503652

best validation loss 0.550365210379345

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0074709463546, 'e_layers': 2, 'learning_rate': 5.27648032e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.27648032e-05
Validation loss decreased (inf --> 0.6637).  Saving model state dict ...
Epoch: 1 cost time: 0.711928129196167
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6637237 Best vali loss: 0.6637237
Updating learning rate to 2.63824016e-05
Validation loss decreased (0.6637 --> 0.6319).  Saving model state dict ...
Epoch: 2 cost time: 0.4460892677307129
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6318985 Best vali loss: 0.6318985
Updating learning rate to 1.31912008e-05
Validation loss decreased (0.6319 --> 0.6225).  Saving model state dict ...
Epoch: 3 cost time: 0.4372715950012207
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6225391 Best vali loss: 0.6225391

best validation loss 0.6225390723600039

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095911119992, 'e_layers': 2, 'learning_rate': 0.0004790597987, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8869623
	speed: 0.0105s/iter; left time: 9.3203s
Updating learning rate to 0.0004790597987
Validation loss decreased (inf --> 0.6085).  Saving model state dict ...
Epoch: 1 cost time: 0.8984389305114746
Epoch: 1, Steps: 123 | Train Loss: 0.8869623 Vali Loss: 0.6085497 Best vali loss: 0.6085497
	iters: 100, epoch: 2 | loss: 0.9429975
	speed: 0.0078s/iter; left time: 5.9788s
Updating learning rate to 0.00023952989935
Validation loss decreased (0.6085 --> 0.5612).  Saving model state dict ...
Epoch: 2 cost time: 0.618370532989502
Epoch: 2, Steps: 123 | Train Loss: 0.9429975 Vali Loss: 0.5612434 Best vali loss: 0.5612434
	iters: 100, epoch: 3 | loss: 0.6991752
	speed: 0.0079s/iter; left time: 5.0656s
Updating learning rate to 0.000119764949675
Epoch: 3 cost time: 0.6272406578063965
Epoch: 3, Steps: 123 | Train Loss: 0.6991752 Vali Loss: 0.5723537 Best vali loss: 0.5612434

best validation loss 0.5612433665828096

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043915924708, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6018406
	speed: 0.0121s/iter; left time: 6.2272s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5504 --> 0.5333).  Saving model state dict ...
Epoch: 4 cost time: 1.0335097312927246
Epoch: 4, Steps: 123 | Train Loss: 0.6018406 Vali Loss: 0.5332526 Best vali loss: 0.5332526
	iters: 100, epoch: 5 | loss: 0.8485394
	speed: 0.0095s/iter; left time: 3.7291s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5333 --> 0.5305).  Saving model state dict ...
Epoch: 5 cost time: 0.72513747215271
Epoch: 5, Steps: 123 | Train Loss: 0.8485394 Vali Loss: 0.5304981 Best vali loss: 0.5304981
	iters: 100, epoch: 6 | loss: 0.8042758
	speed: 0.0095s/iter; left time: 2.5526s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5305 --> 0.5293).  Saving model state dict ...
Epoch: 6 cost time: 0.7289547920227051
Epoch: 6, Steps: 123 | Train Loss: 0.8042758 Vali Loss: 0.5292506 Best vali loss: 0.5292506
	iters: 100, epoch: 7 | loss: 0.4779864
	speed: 0.0094s/iter; left time: 1.3821s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.7348203659057617
Epoch: 7, Steps: 123 | Train Loss: 0.4779864 Vali Loss: 0.5299402 Best vali loss: 0.5292506
	iters: 100, epoch: 8 | loss: 0.5520611
	speed: 0.0091s/iter; left time: 0.2189s
Updating learning rate to 0.0
Validation loss decreased (0.5293 --> 0.5268).  Saving model state dict ...
Epoch: 8 cost time: 0.7225415706634521
Epoch: 8, Steps: 123 | Train Loss: 0.5520611 Vali Loss: 0.5267890 Best vali loss: 0.5267890

best validation loss 0.5267889752591004

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0016570955056, 'e_layers': 3, 'learning_rate': 0.0005757009055, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8788590
	speed: 0.0115s/iter; left time: 10.1538s
Updating learning rate to 0.0005537895944698323
Validation loss decreased (inf --> 0.5952).  Saving model state dict ...
Epoch: 1 cost time: 1.0073041915893555
Epoch: 1, Steps: 123 | Train Loss: 0.8788590 Vali Loss: 0.5951811 Best vali loss: 0.5951811
	iters: 100, epoch: 2 | loss: 0.9071218
	speed: 0.0092s/iter; left time: 6.9763s
Updating learning rate to 0.0004913914598571429
Validation loss decreased (0.5952 --> 0.5719).  Saving model state dict ...
Epoch: 2 cost time: 0.7492811679840088
Epoch: 2, Steps: 123 | Train Loss: 0.9071218 Vali Loss: 0.5719245 Best vali loss: 0.5719245
	iters: 100, epoch: 3 | loss: 0.9474919
	speed: 0.0089s/iter; left time: 5.6987s
Updating learning rate to 0.00039800605201621513
Validation loss decreased (0.5719 --> 0.5602).  Saving model state dict ...
Epoch: 3 cost time: 0.693882942199707
Epoch: 3, Steps: 123 | Train Loss: 0.9474919 Vali Loss: 0.5601659 Best vali loss: 0.5601659
	iters: 100, epoch: 4 | loss: 0.8008859
	speed: 0.0090s/iter; left time: 4.6667s
Updating learning rate to 0.00028785045275
Validation loss decreased (0.5602 --> 0.5537).  Saving model state dict ...
Epoch: 4 cost time: 0.7160882949829102
Epoch: 4, Steps: 123 | Train Loss: 0.8008859 Vali Loss: 0.5537290 Best vali loss: 0.5537290
	iters: 100, epoch: 5 | loss: 0.9606467
	speed: 0.0091s/iter; left time: 3.5882s
Updating learning rate to 0.00017769485348378492
Epoch: 5 cost time: 0.7389802932739258
Epoch: 5, Steps: 123 | Train Loss: 0.9606467 Vali Loss: 0.5783825 Best vali loss: 0.5537290
	iters: 100, epoch: 6 | loss: 0.5333619
	speed: 0.0087s/iter; left time: 2.3565s
Updating learning rate to 8.430944564285714e-05
Epoch: 6 cost time: 0.6866519451141357
Epoch: 6, Steps: 123 | Train Loss: 0.5333619 Vali Loss: 0.5559587 Best vali loss: 0.5537290
	iters: 100, epoch: 7 | loss: 0.8129612
	speed: 0.0085s/iter; left time: 1.2523s
Updating learning rate to 2.1911311030167768e-05
Epoch: 7 cost time: 0.6807241439819336
Epoch: 7, Steps: 123 | Train Loss: 0.8129612 Vali Loss: 0.5652707 Best vali loss: 0.5537290
	iters: 100, epoch: 8 | loss: 0.5632254
	speed: 0.0089s/iter; left time: 0.2139s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7356081008911133
Epoch: 8, Steps: 123 | Train Loss: 0.5632254 Vali Loss: 0.5629842 Best vali loss: 0.5537290

best validation loss 0.5537290430521314

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043869720727, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616883
	speed: 0.0118s/iter; left time: 10.4109s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0312633514404297
Epoch: 1, Steps: 123 | Train Loss: 0.7616883 Vali Loss: 0.6075420 Best vali loss: 0.6075420
	iters: 100, epoch: 2 | loss: 0.9380141
	speed: 0.0092s/iter; left time: 7.0296s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6075 --> 0.5740).  Saving model state dict ...
Epoch: 2 cost time: 0.721992015838623
Epoch: 2, Steps: 123 | Train Loss: 0.9380141 Vali Loss: 0.5739771 Best vali loss: 0.5739771
	iters: 100, epoch: 3 | loss: 0.8614533
	speed: 0.0094s/iter; left time: 6.0186s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5740 --> 0.5448).  Saving model state dict ...
Epoch: 3 cost time: 0.727543830871582
Epoch: 3, Steps: 123 | Train Loss: 0.8614533 Vali Loss: 0.5448483 Best vali loss: 0.5448483
	iters: 100, epoch: 4 | loss: 0.4981260
	speed: 0.0093s/iter; left time: 4.7827s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5448 --> 0.5416).  Saving model state dict ...
Epoch: 4 cost time: 0.727388858795166
Epoch: 4, Steps: 123 | Train Loss: 0.4981260 Vali Loss: 0.5415654 Best vali loss: 0.5415654
	iters: 100, epoch: 5 | loss: 0.5729082
	speed: 0.0094s/iter; left time: 3.6955s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5416 --> 0.5315).  Saving model state dict ...
Epoch: 5 cost time: 0.7221024036407471
Epoch: 5, Steps: 123 | Train Loss: 0.5729082 Vali Loss: 0.5314625 Best vali loss: 0.5314625
	iters: 100, epoch: 6 | loss: 0.6229511
	speed: 0.0094s/iter; left time: 2.5326s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7246685028076172
Epoch: 6, Steps: 123 | Train Loss: 0.6229511 Vali Loss: 0.5315899 Best vali loss: 0.5314625
	iters: 100, epoch: 7 | loss: 0.5772118
	speed: 0.0091s/iter; left time: 1.3307s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5315 --> 0.5258).  Saving model state dict ...
Epoch: 7 cost time: 0.7197644710540771
Epoch: 7, Steps: 123 | Train Loss: 0.5772118 Vali Loss: 0.5257753 Best vali loss: 0.5257753
	iters: 100, epoch: 8 | loss: 0.7404172
	speed: 0.0095s/iter; left time: 0.2282s
Updating learning rate to 0.0
Validation loss decreased (0.5258 --> 0.5243).  Saving model state dict ...
Epoch: 8 cost time: 0.7257394790649414
Epoch: 8, Steps: 123 | Train Loss: 0.7404172 Vali Loss: 0.5243232 Best vali loss: 0.5243232

best validation loss 0.5243232351577376

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0012505125428, 'e_layers': 2, 'learning_rate': 8.26598813e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0628031
	speed: 0.0097s/iter; left time: 37.1171s
	iters: 200, epoch: 1 | loss: 1.1188209
	speed: 0.0039s/iter; left time: 14.3984s
	iters: 300, epoch: 1 | loss: 0.8795838
	speed: 0.0039s/iter; left time: 14.0545s
	iters: 400, epoch: 1 | loss: 1.0012262
	speed: 0.0038s/iter; left time: 13.4191s
Updating learning rate to 7.951382689644122e-05
Validation loss decreased (inf --> 0.6390).  Saving model state dict ...
Epoch: 1 cost time: 2.190910577774048
Epoch: 1, Steps: 490 | Train Loss: 1.0156085 Vali Loss: 0.6389636 Best vali loss: 0.6389636
	iters: 100, epoch: 2 | loss: 0.9579695
	speed: 0.0103s/iter; left time: 34.2130s
	iters: 200, epoch: 2 | loss: 1.0606698
	speed: 0.0037s/iter; left time: 12.0894s
	iters: 300, epoch: 2 | loss: 0.8967042
	speed: 0.0037s/iter; left time: 11.7119s
	iters: 400, epoch: 2 | loss: 0.4555590
	speed: 0.0037s/iter; left time: 11.1998s
Updating learning rate to 7.055462194965255e-05
Validation loss decreased (0.6390 --> 0.6153).  Saving model state dict ...
Epoch: 2 cost time: 1.8492162227630615
Epoch: 2, Steps: 490 | Train Loss: 0.8427256 Vali Loss: 0.6152711 Best vali loss: 0.6152711
	iters: 100, epoch: 3 | loss: 0.7342488
	speed: 0.0099s/iter; left time: 28.0005s
	iters: 200, epoch: 3 | loss: 0.7854846
	speed: 0.0033s/iter; left time: 9.0332s
	iters: 300, epoch: 3 | loss: 0.4280488
	speed: 0.0032s/iter; left time: 8.4406s
	iters: 400, epoch: 3 | loss: 1.3531275
	speed: 0.0033s/iter; left time: 8.3850s
Updating learning rate to 5.714622419738745e-05
Validation loss decreased (0.6153 --> 0.6074).  Saving model state dict ...
Epoch: 3 cost time: 1.639352560043335
Epoch: 3, Steps: 490 | Train Loss: 0.8252274 Vali Loss: 0.6074373 Best vali loss: 0.6074373

best validation loss 0.6074372617418377

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043762320208, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617000
	speed: 0.0116s/iter; left time: 10.3033s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0302138328552246
Epoch: 1, Steps: 123 | Train Loss: 0.7617000 Vali Loss: 0.6075579 Best vali loss: 0.6075579
	iters: 100, epoch: 2 | loss: 0.9383333
	speed: 0.0092s/iter; left time: 7.0073s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5710).  Saving model state dict ...
Epoch: 2 cost time: 0.7200469970703125
Epoch: 2, Steps: 123 | Train Loss: 0.9383333 Vali Loss: 0.5710318 Best vali loss: 0.5710318
	iters: 100, epoch: 3 | loss: 0.8643868
	speed: 0.0094s/iter; left time: 6.0126s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5710 --> 0.5516).  Saving model state dict ...
Epoch: 3 cost time: 0.7197580337524414
Epoch: 3, Steps: 123 | Train Loss: 0.8643868 Vali Loss: 0.5516221 Best vali loss: 0.5516221

best validation loss 0.5516221243052061

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0013671936155, 'e_layers': 2, 'learning_rate': 0.0005560871009, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005349222958575243
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 0.7709345817565918
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6100843 Best vali loss: 0.6100843
Updating learning rate to 0.0004746500304383789
Validation loss decreased (0.6101 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 0.4745607376098633
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6007219 Best vali loss: 0.6007219
Updating learning rate to 0.000384446210683182
Validation loss decreased (0.6007 --> 0.5594).  Saving model state dict ...
Epoch: 3 cost time: 0.48111629486083984
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5593902 Best vali loss: 0.5593902

best validation loss 0.5593901521516365

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043762320208, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6024031
	speed: 0.0120s/iter; left time: 6.1971s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5516 --> 0.5369).  Saving model state dict ...
Epoch: 4 cost time: 1.0358350276947021
Epoch: 4, Steps: 123 | Train Loss: 0.6024031 Vali Loss: 0.5368847 Best vali loss: 0.5368847
	iters: 100, epoch: 5 | loss: 0.8458824
	speed: 0.0094s/iter; left time: 3.7055s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5369 --> 0.5332).  Saving model state dict ...
Epoch: 5 cost time: 0.7282779216766357
Epoch: 5, Steps: 123 | Train Loss: 0.8458824 Vali Loss: 0.5331641 Best vali loss: 0.5331641
	iters: 100, epoch: 6 | loss: 0.8008446
	speed: 0.0093s/iter; left time: 2.5057s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5332 --> 0.5298).  Saving model state dict ...
Epoch: 6 cost time: 0.7140557765960693
Epoch: 6, Steps: 123 | Train Loss: 0.8008446 Vali Loss: 0.5297808 Best vali loss: 0.5297808
	iters: 100, epoch: 7 | loss: 0.4778655
	speed: 0.0093s/iter; left time: 1.3724s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.722783088684082
Epoch: 7, Steps: 123 | Train Loss: 0.4778655 Vali Loss: 0.5311981 Best vali loss: 0.5297808
	iters: 100, epoch: 8 | loss: 0.5523213
	speed: 0.0089s/iter; left time: 0.2146s
Updating learning rate to 0.0
Validation loss decreased (0.5298 --> 0.5265).  Saving model state dict ...
Epoch: 8 cost time: 0.7189044952392578
Epoch: 8, Steps: 123 | Train Loss: 0.5523213 Vali Loss: 0.5264731 Best vali loss: 0.5264731

best validation loss 0.5264731024989703

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494417602, 'e_layers': 2, 'learning_rate': 0.0002976970772, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745740
	speed: 0.0118s/iter; left time: 10.4406s
Updating learning rate to 0.00028636665685675625
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0338666439056396
Epoch: 1, Steps: 123 | Train Loss: 0.7745740 Vali Loss: 0.6173434 Best vali loss: 0.6173434
	iters: 100, epoch: 2 | loss: 0.9506391
	speed: 0.0093s/iter; left time: 7.0621s
Updating learning rate to 0.00025410034961376757
Validation loss decreased (0.6173 --> 0.5717).  Saving model state dict ...
Epoch: 2 cost time: 0.7210133075714111
Epoch: 2, Steps: 123 | Train Loss: 0.9506391 Vali Loss: 0.5717169 Best vali loss: 0.5717169
	iters: 100, epoch: 3 | loss: 0.8494121
	speed: 0.0093s/iter; left time: 5.9144s
Updating learning rate to 0.00020581040825397556
Validation loss decreased (0.5717 --> 0.5457).  Saving model state dict ...
Epoch: 3 cost time: 0.7178435325622559
Epoch: 3, Steps: 123 | Train Loss: 0.8494121 Vali Loss: 0.5457466 Best vali loss: 0.5457466
	iters: 100, epoch: 4 | loss: 0.4869984
	speed: 0.0093s/iter; left time: 4.8003s
Updating learning rate to 0.0001488485386
Validation loss decreased (0.5457 --> 0.5380).  Saving model state dict ...
Epoch: 4 cost time: 0.7231898307800293
Epoch: 4, Steps: 123 | Train Loss: 0.4869984 Vali Loss: 0.5379527 Best vali loss: 0.5379527
	iters: 100, epoch: 5 | loss: 0.5540931
	speed: 0.0092s/iter; left time: 3.6133s
Updating learning rate to 9.188666894602445e-05
Validation loss decreased (0.5380 --> 0.5293).  Saving model state dict ...
Epoch: 5 cost time: 0.7164320945739746
Epoch: 5, Steps: 123 | Train Loss: 0.5540931 Vali Loss: 0.5293252 Best vali loss: 0.5293252
	iters: 100, epoch: 6 | loss: 0.5880409
	speed: 0.0093s/iter; left time: 2.4998s
Updating learning rate to 4.359672758623244e-05
Epoch: 6 cost time: 0.7162814140319824
Epoch: 6, Steps: 123 | Train Loss: 0.5880409 Vali Loss: 0.5384903 Best vali loss: 0.5293252
	iters: 100, epoch: 7 | loss: 0.5344371
	speed: 0.0090s/iter; left time: 1.3295s
Updating learning rate to 1.1330420343243782e-05
Epoch: 7 cost time: 0.7239196300506592
Epoch: 7, Steps: 123 | Train Loss: 0.5344371 Vali Loss: 0.5408285 Best vali loss: 0.5293252
	iters: 100, epoch: 8 | loss: 0.6937442
	speed: 0.0090s/iter; left time: 0.2149s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7167494297027588
Epoch: 8, Steps: 123 | Train Loss: 0.6937442 Vali Loss: 0.5430589 Best vali loss: 0.5293252

best validation loss 0.5293252425081252

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001768566254, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7618368
	speed: 0.0118s/iter; left time: 10.4108s
Updating learning rate to 0.00017012542089803786
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.033083438873291
Epoch: 1, Steps: 123 | Train Loss: 0.7618368 Vali Loss: 0.6076691 Best vali loss: 0.6076691
	iters: 100, epoch: 2 | loss: 0.9379544
	speed: 0.0093s/iter; left time: 7.0524s
Updating learning rate to 0.00015095657225905448
Validation loss decreased (0.6077 --> 0.5736).  Saving model state dict ...
Epoch: 2 cost time: 0.7264218330383301
Epoch: 2, Steps: 123 | Train Loss: 0.9379544 Vali Loss: 0.5735780 Best vali loss: 0.5735780
	iters: 100, epoch: 3 | loss: 0.8670976
	speed: 0.0096s/iter; left time: 6.1322s
Updating learning rate to 0.00012226836292228945
Validation loss decreased (0.5736 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 0.7262287139892578
Epoch: 3, Steps: 123 | Train Loss: 0.8670976 Vali Loss: 0.5452928 Best vali loss: 0.5452928
	iters: 100, epoch: 4 | loss: 0.4936700
	speed: 0.0093s/iter; left time: 4.8207s
Updating learning rate to 8.84283127e-05
Validation loss decreased (0.5453 --> 0.5403).  Saving model state dict ...
Epoch: 4 cost time: 0.7230091094970703
Epoch: 4, Steps: 123 | Train Loss: 0.4936700 Vali Loss: 0.5402946 Best vali loss: 0.5402946
	iters: 100, epoch: 5 | loss: 0.5808390
	speed: 0.0094s/iter; left time: 3.6999s
Updating learning rate to 5.458826247771054e-05
Validation loss decreased (0.5403 --> 0.5305).  Saving model state dict ...
Epoch: 5 cost time: 0.7276668548583984
Epoch: 5, Steps: 123 | Train Loss: 0.5808390 Vali Loss: 0.5304933 Best vali loss: 0.5304933
	iters: 100, epoch: 6 | loss: 0.6211579
	speed: 0.0094s/iter; left time: 2.5283s
Updating learning rate to 2.5900053140945504e-05
Epoch: 6 cost time: 0.7233076095581055
Epoch: 6, Steps: 123 | Train Loss: 0.6211579 Vali Loss: 0.5312300 Best vali loss: 0.5304933
	iters: 100, epoch: 7 | loss: 0.5790153
	speed: 0.0091s/iter; left time: 1.3433s
Updating learning rate to 6.7312045019621195e-06
Validation loss decreased (0.5305 --> 0.5278).  Saving model state dict ...
Epoch: 7 cost time: 0.7279558181762695
Epoch: 7, Steps: 123 | Train Loss: 0.5790153 Vali Loss: 0.5278246 Best vali loss: 0.5278246
	iters: 100, epoch: 8 | loss: 0.7375519
	speed: 0.0093s/iter; left time: 0.2244s
Updating learning rate to 0.0
Validation loss decreased (0.5278 --> 0.5251).  Saving model state dict ...
Epoch: 8 cost time: 0.7151613235473633
Epoch: 8, Steps: 123 | Train Loss: 0.7375519 Vali Loss: 0.5251339 Best vali loss: 0.5251339

best validation loss 0.5251339080431902

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010493375841, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745637
	speed: 0.0118s/iter; left time: 10.4195s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0327849388122559
Epoch: 1, Steps: 123 | Train Loss: 0.7745637 Vali Loss: 0.6172993 Best vali loss: 0.6172993
	iters: 100, epoch: 2 | loss: 0.9487512
	speed: 0.0092s/iter; left time: 7.0379s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5700).  Saving model state dict ...
Epoch: 2 cost time: 0.7226550579071045
Epoch: 2, Steps: 123 | Train Loss: 0.9487512 Vali Loss: 0.5699738 Best vali loss: 0.5699738
	iters: 100, epoch: 3 | loss: 0.8460982
	speed: 0.0094s/iter; left time: 5.9800s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5700 --> 0.5360).  Saving model state dict ...
Epoch: 3 cost time: 0.7251498699188232
Epoch: 3, Steps: 123 | Train Loss: 0.8460982 Vali Loss: 0.5360091 Best vali loss: 0.5360091

best validation loss 0.5360090895859746

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037549600958, 'e_layers': 4, 'learning_rate': 0.0005464479098, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8131918
	speed: 0.0128s/iter; left time: 11.2933s
Updating learning rate to 0.0005256499746238969
Validation loss decreased (inf --> 0.6038).  Saving model state dict ...
Epoch: 1 cost time: 1.1523659229278564
Epoch: 1, Steps: 123 | Train Loss: 0.8131918 Vali Loss: 0.6038186 Best vali loss: 0.6038186
	iters: 100, epoch: 2 | loss: 0.9802289
	speed: 0.0104s/iter; left time: 7.9548s
Updating learning rate to 0.00046642246619239743
Epoch: 2 cost time: 0.8646359443664551
Epoch: 2, Steps: 123 | Train Loss: 0.9802289 Vali Loss: 0.6108977 Best vali loss: 0.6038186
	iters: 100, epoch: 3 | loss: 0.7447217
	speed: 0.0103s/iter; left time: 6.6081s
Updating learning rate to 0.00037778223576549654
Validation loss decreased (0.6038 --> 0.5969).  Saving model state dict ...
Epoch: 3 cost time: 0.8630425930023193
Epoch: 3, Steps: 123 | Train Loss: 0.7447217 Vali Loss: 0.5969037 Best vali loss: 0.5969037

best validation loss 0.5969037154050736

[INFO][smbo.py:320] Finished 800 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0040685918158, 'e_layers': 2, 'learning_rate': 0.0003713915357, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.8821061
	speed: 0.0098s/iter; left time: 76.1590s
	iters: 200, epoch: 1 | loss: 0.7429155
	speed: 0.0036s/iter; left time: 27.5324s
	iters: 300, epoch: 1 | loss: 1.0920498
	speed: 0.0036s/iter; left time: 27.1572s
	iters: 400, epoch: 1 | loss: 1.0150430
	speed: 0.0036s/iter; left time: 27.1140s
	iters: 500, epoch: 1 | loss: 1.2460576
	speed: 0.0036s/iter; left time: 26.5776s
	iters: 600, epoch: 1 | loss: 0.8779166
	speed: 0.0036s/iter; left time: 26.2238s
	iters: 700, epoch: 1 | loss: 0.4173383
	speed: 0.0034s/iter; left time: 23.9931s
	iters: 800, epoch: 1 | loss: 0.7941801
	speed: 0.0031s/iter; left time: 21.7730s
	iters: 900, epoch: 1 | loss: 0.8064989
	speed: 0.0031s/iter; left time: 21.2441s
Updating learning rate to 0.0003713915357
Validation loss decreased (inf --> 0.6474).  Saving model state dict ...
Epoch: 1 cost time: 3.729600191116333
Epoch: 1, Steps: 979 | Train Loss: 0.9860118 Vali Loss: 0.6473942 Best vali loss: 0.6473942
	iters: 100, epoch: 2 | loss: 1.5170680
	speed: 0.0114s/iter; left time: 77.1956s
	iters: 200, epoch: 2 | loss: 0.9885138
	speed: 0.0034s/iter; left time: 22.7974s
	iters: 300, epoch: 2 | loss: 0.7717124
	speed: 0.0035s/iter; left time: 22.6167s
	iters: 400, epoch: 2 | loss: 1.1913704
	speed: 0.0034s/iter; left time: 21.8722s
	iters: 500, epoch: 2 | loss: 0.7033657
	speed: 0.0035s/iter; left time: 22.0805s
	iters: 600, epoch: 2 | loss: 1.2543617
	speed: 0.0034s/iter; left time: 21.1301s
	iters: 700, epoch: 2 | loss: 0.7126770
	speed: 0.0034s/iter; left time: 20.9073s
	iters: 800, epoch: 2 | loss: 0.8644613
	speed: 0.0035s/iter; left time: 20.9141s
	iters: 900, epoch: 2 | loss: 0.6767993
	speed: 0.0035s/iter; left time: 21.0434s
Updating learning rate to 0.00018569576785
Validation loss decreased (0.6474 --> 0.6327).  Saving model state dict ...
Epoch: 2 cost time: 3.418349027633667
Epoch: 2, Steps: 979 | Train Loss: 0.9644811 Vali Loss: 0.6327375 Best vali loss: 0.6327375
	iters: 100, epoch: 3 | loss: 0.7342027
	speed: 0.0114s/iter; left time: 65.7869s
	iters: 200, epoch: 3 | loss: 1.0773169
	speed: 0.0033s/iter; left time: 18.8712s
	iters: 300, epoch: 3 | loss: 0.7792265
	speed: 0.0033s/iter; left time: 18.5871s
	iters: 400, epoch: 3 | loss: 1.0546598
	speed: 0.0033s/iter; left time: 18.2485s
	iters: 500, epoch: 3 | loss: 0.7342081
	speed: 0.0033s/iter; left time: 17.7444s
	iters: 600, epoch: 3 | loss: 1.1741288
	speed: 0.0033s/iter; left time: 17.5712s
	iters: 700, epoch: 3 | loss: 0.2990154
	speed: 0.0033s/iter; left time: 17.3103s
	iters: 800, epoch: 3 | loss: 0.3979192
	speed: 0.0034s/iter; left time: 17.4482s
	iters: 900, epoch: 3 | loss: 0.2605550
	speed: 0.0034s/iter; left time: 17.0207s
Updating learning rate to 9.2847883925e-05
Validation loss decreased (0.6327 --> 0.6156).  Saving model state dict ...
Epoch: 3 cost time: 3.332707166671753
Epoch: 3, Steps: 979 | Train Loss: 0.7234703 Vali Loss: 0.6155706 Best vali loss: 0.6155706

best validation loss 0.6155705677172146

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010493375841, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5833415
	speed: 0.0122s/iter; left time: 6.3126s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5360 --> 0.5318).  Saving model state dict ...
Epoch: 4 cost time: 1.0363047122955322
Epoch: 4, Steps: 123 | Train Loss: 0.5833415 Vali Loss: 0.5317802 Best vali loss: 0.5317802
	iters: 100, epoch: 5 | loss: 0.8229041
	speed: 0.0093s/iter; left time: 3.6491s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5318 --> 0.5302).  Saving model state dict ...
Epoch: 5 cost time: 0.7180328369140625
Epoch: 5, Steps: 123 | Train Loss: 0.8229041 Vali Loss: 0.5301601 Best vali loss: 0.5301601
	iters: 100, epoch: 6 | loss: 0.7592295
	speed: 0.0092s/iter; left time: 2.4891s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7233240604400635
Epoch: 6, Steps: 123 | Train Loss: 0.7592295 Vali Loss: 0.5349398 Best vali loss: 0.5301601
	iters: 100, epoch: 7 | loss: 0.4300718
	speed: 0.0090s/iter; left time: 1.3237s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7178585529327393
Epoch: 7, Steps: 123 | Train Loss: 0.4300718 Vali Loss: 0.5529740 Best vali loss: 0.5301601
	iters: 100, epoch: 8 | loss: 0.5037482
	speed: 0.0089s/iter; left time: 0.2141s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.715569257736206
Epoch: 8, Steps: 123 | Train Loss: 0.5037482 Vali Loss: 0.5512768 Best vali loss: 0.5301601

best validation loss 0.5301600943997413

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0001499030976, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7578640
	speed: 0.0119s/iter; left time: 10.5435s
Updating learning rate to 0.0001441977506663409
Validation loss decreased (inf --> 0.6053).  Saving model state dict ...
Epoch: 1 cost time: 1.0373709201812744
Epoch: 1, Steps: 123 | Train Loss: 0.7578640 Vali Loss: 0.6053347 Best vali loss: 0.6053347
	iters: 100, epoch: 2 | loss: 0.9393484
	speed: 0.0094s/iter; left time: 7.1432s
Updating learning rate to 0.00012795029721691443
Validation loss decreased (0.6053 --> 0.5797).  Saving model state dict ...
Epoch: 2 cost time: 0.7259058952331543
Epoch: 2, Steps: 123 | Train Loss: 0.9393484 Vali Loss: 0.5796930 Best vali loss: 0.5796930
	iters: 100, epoch: 3 | loss: 0.8599077
	speed: 0.0094s/iter; left time: 6.0159s
Updating learning rate to 0.00010363426475586353
Validation loss decreased (0.5797 --> 0.5473).  Saving model state dict ...
Epoch: 3 cost time: 0.7283704280853271
Epoch: 3, Steps: 123 | Train Loss: 0.8599077 Vali Loss: 0.5473387 Best vali loss: 0.5473387
	iters: 100, epoch: 4 | loss: 0.4985929
	speed: 0.0094s/iter; left time: 4.8404s
Updating learning rate to 7.49515488e-05
Epoch: 4 cost time: 0.7311995029449463
Epoch: 4, Steps: 123 | Train Loss: 0.4985929 Vali Loss: 0.5519805 Best vali loss: 0.5473387
	iters: 100, epoch: 5 | loss: 0.5820720
	speed: 0.0090s/iter; left time: 3.5472s
Updating learning rate to 4.6268832844136475e-05
Validation loss decreased (0.5473 --> 0.5403).  Saving model state dict ...
Epoch: 5 cost time: 0.7222437858581543
Epoch: 5, Steps: 123 | Train Loss: 0.5820720 Vali Loss: 0.5402630 Best vali loss: 0.5402630
	iters: 100, epoch: 6 | loss: 0.6194886
	speed: 0.0095s/iter; left time: 2.5537s
Updating learning rate to 2.1952800383085566e-05
Validation loss decreased (0.5403 --> 0.5335).  Saving model state dict ...
Epoch: 6 cost time: 0.7291665077209473
Epoch: 6, Steps: 123 | Train Loss: 0.6194886 Vali Loss: 0.5335248 Best vali loss: 0.5335248
	iters: 100, epoch: 7 | loss: 0.5914267
	speed: 0.0093s/iter; left time: 1.3673s
Updating learning rate to 5.705346933659105e-06
Validation loss decreased (0.5335 --> 0.5301).  Saving model state dict ...
Epoch: 7 cost time: 0.7239587306976318
Epoch: 7, Steps: 123 | Train Loss: 0.5914267 Vali Loss: 0.5301205 Best vali loss: 0.5301205
	iters: 100, epoch: 8 | loss: 0.7506188
	speed: 0.0093s/iter; left time: 0.2236s
Updating learning rate to 0.0
Validation loss decreased (0.5301 --> 0.5281).  Saving model state dict ...
Epoch: 8 cost time: 0.7277822494506836
Epoch: 8, Steps: 123 | Train Loss: 0.7506188 Vali Loss: 0.5280611 Best vali loss: 0.5280611

best validation loss 0.5280610687034321

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043915172007, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616858
	speed: 0.0117s/iter; left time: 10.3934s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0263032913208008
Epoch: 1, Steps: 123 | Train Loss: 0.7616858 Vali Loss: 0.6075478 Best vali loss: 0.6075478
	iters: 100, epoch: 2 | loss: 0.9376088
	speed: 0.0093s/iter; left time: 7.0518s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6075 --> 0.5715).  Saving model state dict ...
Epoch: 2 cost time: 0.7215292453765869
Epoch: 2, Steps: 123 | Train Loss: 0.9376088 Vali Loss: 0.5715436 Best vali loss: 0.5715436
	iters: 100, epoch: 3 | loss: 0.8616164
	speed: 0.0093s/iter; left time: 5.9681s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5715 --> 0.5536).  Saving model state dict ...
Epoch: 3 cost time: 0.7281067371368408
Epoch: 3, Steps: 123 | Train Loss: 0.8616164 Vali Loss: 0.5536441 Best vali loss: 0.5536441
	iters: 100, epoch: 4 | loss: 0.5005547
	speed: 0.0094s/iter; left time: 4.8539s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5536 --> 0.5422).  Saving model state dict ...
Epoch: 4 cost time: 0.7268896102905273
Epoch: 4, Steps: 123 | Train Loss: 0.5005547 Vali Loss: 0.5422392 Best vali loss: 0.5422392
	iters: 100, epoch: 5 | loss: 0.5738752
	speed: 0.0093s/iter; left time: 3.6640s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5422 --> 0.5265).  Saving model state dict ...
Epoch: 5 cost time: 0.7275753021240234
Epoch: 5, Steps: 123 | Train Loss: 0.5738752 Vali Loss: 0.5264958 Best vali loss: 0.5264958
	iters: 100, epoch: 6 | loss: 0.6181261
	speed: 0.0095s/iter; left time: 2.5671s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7278847694396973
Epoch: 6, Steps: 123 | Train Loss: 0.6181261 Vali Loss: 0.5275886 Best vali loss: 0.5264958
	iters: 100, epoch: 7 | loss: 0.5766692
	speed: 0.0092s/iter; left time: 1.3506s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5265 --> 0.5250).  Saving model state dict ...
Epoch: 7 cost time: 0.7286632061004639
Epoch: 7, Steps: 123 | Train Loss: 0.5766692 Vali Loss: 0.5249629 Best vali loss: 0.5249629
	iters: 100, epoch: 8 | loss: 0.7438052
	speed: 0.0094s/iter; left time: 0.2252s
Updating learning rate to 0.0
Validation loss decreased (0.5250 --> 0.5234).  Saving model state dict ...
Epoch: 8 cost time: 0.7283265590667725
Epoch: 8, Steps: 123 | Train Loss: 0.7438052 Vali Loss: 0.5233899 Best vali loss: 0.5233899

best validation loss 0.523389889831512

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043891091461, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7965089
	speed: 0.0112s/iter; left time: 9.9503s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5942).  Saving model state dict ...
Epoch: 1 cost time: 0.9713377952575684
Epoch: 1, Steps: 123 | Train Loss: 0.7965089 Vali Loss: 0.5941684 Best vali loss: 0.5941684
	iters: 100, epoch: 2 | loss: 0.9394111
	speed: 0.0086s/iter; left time: 6.5645s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.5942 --> 0.5923).  Saving model state dict ...
Epoch: 2 cost time: 0.6672272682189941
Epoch: 2, Steps: 123 | Train Loss: 0.9394111 Vali Loss: 0.5923007 Best vali loss: 0.5923007
	iters: 100, epoch: 3 | loss: 0.7418833
	speed: 0.0088s/iter; left time: 5.6010s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5923 --> 0.5589).  Saving model state dict ...
Epoch: 3 cost time: 0.6737432479858398
Epoch: 3, Steps: 123 | Train Loss: 0.7418833 Vali Loss: 0.5589460 Best vali loss: 0.5589460

best validation loss 0.558946020290952

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002921494666, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7737685
	speed: 0.0116s/iter; left time: 10.3092s
Updating learning rate to 0.0002810301896129149
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0195138454437256
Epoch: 1, Steps: 123 | Train Loss: 0.7737685 Vali Loss: 0.6172184 Best vali loss: 0.6172184
	iters: 100, epoch: 2 | loss: 0.9373662
	speed: 0.0091s/iter; left time: 6.9691s
Updating learning rate to 0.0002493651677764464
Validation loss decreased (0.6172 --> 0.5735).  Saving model state dict ...
Epoch: 2 cost time: 0.7195231914520264
Epoch: 2, Steps: 123 | Train Loss: 0.9373662 Vali Loss: 0.5735140 Best vali loss: 0.5735140
	iters: 100, epoch: 3 | loss: 0.8496907
	speed: 0.0093s/iter; left time: 5.9469s
Updating learning rate to 0.0002019751136210591
Validation loss decreased (0.5735 --> 0.5502).  Saving model state dict ...
Epoch: 3 cost time: 0.7265253067016602
Epoch: 3, Steps: 123 | Train Loss: 0.8496907 Vali Loss: 0.5501971 Best vali loss: 0.5501971

best validation loss 0.5501970503408563

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0001768374788, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7614498
	speed: 0.0119s/iter; left time: 10.5286s
Updating learning rate to 0.0001701070030221093
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.0435833930969238
Epoch: 1, Steps: 123 | Train Loss: 0.7614498 Vali Loss: 0.6077210 Best vali loss: 0.6077210
	iters: 100, epoch: 2 | loss: 0.9347986
	speed: 0.0093s/iter; left time: 7.0613s
Updating learning rate to 0.00015094022961370616
Validation loss decreased (0.6077 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 0.7234537601470947
Epoch: 2, Steps: 123 | Train Loss: 0.9347986 Vali Loss: 0.5610521 Best vali loss: 0.5610521
	iters: 100, epoch: 3 | loss: 0.8541628
	speed: 0.0093s/iter; left time: 5.9353s
Updating learning rate to 0.0001222551260789864
Validation loss decreased (0.5611 --> 0.5504).  Saving model state dict ...
Epoch: 3 cost time: 0.728766679763794
Epoch: 3, Steps: 123 | Train Loss: 0.8541628 Vali Loss: 0.5503866 Best vali loss: 0.5503866

best validation loss 0.5503865662739819

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002921494666, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5825541
	speed: 0.0121s/iter; left time: 6.2300s
Updating learning rate to 0.0001460747333
Validation loss decreased (0.5502 --> 0.5316).  Saving model state dict ...
Epoch: 4 cost time: 1.0305464267730713
Epoch: 4, Steps: 123 | Train Loss: 0.5825541 Vali Loss: 0.5315667 Best vali loss: 0.5315667
	iters: 100, epoch: 5 | loss: 0.8198400
	speed: 0.0094s/iter; left time: 3.7001s
Updating learning rate to 9.017435297894094e-05
Epoch: 5 cost time: 0.7291147708892822
Epoch: 5, Steps: 123 | Train Loss: 0.8198400 Vali Loss: 0.5327539 Best vali loss: 0.5315667
	iters: 100, epoch: 6 | loss: 0.7540011
	speed: 0.0091s/iter; left time: 2.4548s
Updating learning rate to 4.2784298823553625e-05
Epoch: 6 cost time: 0.7278926372528076
Epoch: 6, Steps: 123 | Train Loss: 0.7540011 Vali Loss: 0.5455840 Best vali loss: 0.5315667
	iters: 100, epoch: 7 | loss: 0.4389797
	speed: 0.0091s/iter; left time: 1.3380s
Updating learning rate to 1.1119276987085112e-05
Epoch: 7 cost time: 0.7252194881439209
Epoch: 7, Steps: 123 | Train Loss: 0.4389797 Vali Loss: 0.5469217 Best vali loss: 0.5315667
	iters: 100, epoch: 8 | loss: 0.5077491
	speed: 0.0091s/iter; left time: 0.2185s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7203929424285889
Epoch: 8, Steps: 123 | Train Loss: 0.5077491 Vali Loss: 0.5513385 Best vali loss: 0.5315667

best validation loss 0.5315667322971709

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010284941658, 'e_layers': 4, 'learning_rate': 0.0018883006449, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0018164314809754867
Validation loss decreased (inf --> 0.6122).  Saving model state dict ...
Epoch: 1 cost time: 0.8159027099609375
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6122448 Best vali loss: 0.6122448
Updating learning rate to 0.0016117654179138604
Validation loss decreased (0.6122 --> 0.6119).  Saving model state dict ...
Epoch: 2 cost time: 0.5273959636688232
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6118673 Best vali loss: 0.6118673
Updating learning rate to 0.0013054610085137723
Validation loss decreased (0.6119 --> 0.6062).  Saving model state dict ...
Epoch: 3 cost time: 0.5209987163543701
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6062197 Best vali loss: 0.6062197
Updating learning rate to 0.00094415032245
Epoch: 4 cost time: 0.4871394634246826
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6473338 Best vali loss: 0.6062197
Updating learning rate to 0.0005828396363862278
Epoch: 5 cost time: 0.49112606048583984
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6455755 Best vali loss: 0.6062197
Updating learning rate to 0.00027653522698613964
Validation loss decreased (0.6062 --> 0.5942).  Saving model state dict ...
Epoch: 6 cost time: 0.4825632572174072
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5942089 Best vali loss: 0.5942089
Updating learning rate to 7.186916392451337e-05
Epoch: 7 cost time: 0.48822474479675293
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5944292 Best vali loss: 0.5942089
Updating learning rate to 0.0
Validation loss decreased (0.5942 --> 0.5895).  Saving model state dict ...
Epoch: 8 cost time: 0.4859769344329834
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5895492 Best vali loss: 0.5895492

best validation loss 0.58954919628499

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043903957001, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616512
	speed: 0.0118s/iter; left time: 10.3992s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0226781368255615
Epoch: 1, Steps: 123 | Train Loss: 0.7616512 Vali Loss: 0.6075774 Best vali loss: 0.6075774
	iters: 100, epoch: 2 | loss: 0.9372246
	speed: 0.0092s/iter; left time: 7.0311s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5736).  Saving model state dict ...
Epoch: 2 cost time: 0.7195777893066406
Epoch: 2, Steps: 123 | Train Loss: 0.9372246 Vali Loss: 0.5736160 Best vali loss: 0.5736160
	iters: 100, epoch: 3 | loss: 0.8600611
	speed: 0.0093s/iter; left time: 5.9614s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5736 --> 0.5399).  Saving model state dict ...
Epoch: 3 cost time: 0.7299208641052246
Epoch: 3, Steps: 123 | Train Loss: 0.8600611 Vali Loss: 0.5399384 Best vali loss: 0.5399384
	iters: 100, epoch: 4 | loss: 0.5061472
	speed: 0.0094s/iter; left time: 4.8419s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5399 --> 0.5399).  Saving model state dict ...
Epoch: 4 cost time: 0.7215609550476074
Epoch: 4, Steps: 123 | Train Loss: 0.5061472 Vali Loss: 0.5398934 Best vali loss: 0.5398934
	iters: 100, epoch: 5 | loss: 0.5718853
	speed: 0.0093s/iter; left time: 3.6395s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5399 --> 0.5304).  Saving model state dict ...
Epoch: 5 cost time: 0.7204229831695557
Epoch: 5, Steps: 123 | Train Loss: 0.5718853 Vali Loss: 0.5304151 Best vali loss: 0.5304151
	iters: 100, epoch: 6 | loss: 0.6212369
	speed: 0.0093s/iter; left time: 2.5089s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5304 --> 0.5275).  Saving model state dict ...
Epoch: 6 cost time: 0.7281014919281006
Epoch: 6, Steps: 123 | Train Loss: 0.6212369 Vali Loss: 0.5275400 Best vali loss: 0.5275400
	iters: 100, epoch: 7 | loss: 0.5834485
	speed: 0.0093s/iter; left time: 1.3674s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5275 --> 0.5260).  Saving model state dict ...
Epoch: 7 cost time: 0.7176620960235596
Epoch: 7, Steps: 123 | Train Loss: 0.5834485 Vali Loss: 0.5259564 Best vali loss: 0.5259564
	iters: 100, epoch: 8 | loss: 0.7445501
	speed: 0.0093s/iter; left time: 0.2239s
Updating learning rate to 0.0
Validation loss decreased (0.5260 --> 0.5247).  Saving model state dict ...
Epoch: 8 cost time: 0.7243037223815918
Epoch: 8, Steps: 123 | Train Loss: 0.7445501 Vali Loss: 0.5246522 Best vali loss: 0.5246522

best validation loss 0.5246522319862987

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0043869831588, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9500839
	speed: 0.0106s/iter; left time: 9.3720s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6720).  Saving model state dict ...
Epoch: 1 cost time: 0.8970029354095459
Epoch: 1, Steps: 123 | Train Loss: 0.9500839 Vali Loss: 0.6719558 Best vali loss: 0.6719558
	iters: 100, epoch: 2 | loss: 1.1261382
	speed: 0.0076s/iter; left time: 5.7668s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6720 --> 0.6428).  Saving model state dict ...
Epoch: 2 cost time: 0.6029179096221924
Epoch: 2, Steps: 123 | Train Loss: 1.1261382 Vali Loss: 0.6427875 Best vali loss: 0.6427875
	iters: 100, epoch: 3 | loss: 0.6690506
	speed: 0.0078s/iter; left time: 4.9576s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.6428 --> 0.6290).  Saving model state dict ...
Epoch: 3 cost time: 0.6133472919464111
Epoch: 3, Steps: 123 | Train Loss: 0.6690506 Vali Loss: 0.6290444 Best vali loss: 0.6290444

best validation loss 0.6290443849916648

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002547721938, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7692986
	speed: 0.0117s/iter; left time: 10.3287s
Updating learning rate to 0.00024507550455240944
Validation loss decreased (inf --> 0.6143).  Saving model state dict ...
Epoch: 1 cost time: 1.0271644592285156
Epoch: 1, Steps: 123 | Train Loss: 0.7692986 Vali Loss: 0.6143399 Best vali loss: 0.6143399
	iters: 100, epoch: 2 | loss: 0.9386084
	speed: 0.0094s/iter; left time: 7.1469s
Updating learning rate to 0.00021746166984687663
Validation loss decreased (0.6143 --> 0.5518).  Saving model state dict ...
Epoch: 2 cost time: 0.7302596569061279
Epoch: 2, Steps: 123 | Train Loss: 0.9386084 Vali Loss: 0.5517561 Best vali loss: 0.5517561
	iters: 100, epoch: 3 | loss: 0.8574814
	speed: 0.0095s/iter; left time: 6.0611s
Updating learning rate to 0.0001761346456972839
Validation loss decreased (0.5518 --> 0.5403).  Saving model state dict ...
Epoch: 3 cost time: 0.7281503677368164
Epoch: 3, Steps: 123 | Train Loss: 0.8574814 Vali Loss: 0.5402723 Best vali loss: 0.5402723

best validation loss 0.5402722948957847

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043978104591, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0003157
	speed: 0.0110s/iter; left time: 9.7043s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.5994).  Saving model state dict ...
Epoch: 1 cost time: 0.9342622756958008
Epoch: 1, Steps: 123 | Train Loss: 1.0003157 Vali Loss: 0.5994447 Best vali loss: 0.5994447
	iters: 100, epoch: 2 | loss: 0.8550022
	speed: 0.0080s/iter; left time: 6.1272s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.5994 --> 0.5558).  Saving model state dict ...
Epoch: 2 cost time: 0.6343986988067627
Epoch: 2, Steps: 123 | Train Loss: 0.8550022 Vali Loss: 0.5558431 Best vali loss: 0.5558431
	iters: 100, epoch: 3 | loss: 0.8168552
	speed: 0.0079s/iter; left time: 5.0174s
Updating learning rate to 0.00012156360171032244
Epoch: 3 cost time: 0.6045138835906982
Epoch: 3, Steps: 123 | Train Loss: 0.8168552 Vali Loss: 0.5617145 Best vali loss: 0.5558431

best validation loss 0.5558430678808044

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002547721938, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5888252
	speed: 0.0120s/iter; left time: 6.2131s
Updating learning rate to 0.0001273860969
Validation loss decreased (0.5403 --> 0.5367).  Saving model state dict ...
Epoch: 4 cost time: 1.041762351989746
Epoch: 4, Steps: 123 | Train Loss: 0.5888252 Vali Loss: 0.5366837 Best vali loss: 0.5366837
	iters: 100, epoch: 5 | loss: 0.8309525
	speed: 0.0094s/iter; left time: 3.7070s
Updating learning rate to 7.863754810271607e-05
Validation loss decreased (0.5367 --> 0.5280).  Saving model state dict ...
Epoch: 5 cost time: 0.725142240524292
Epoch: 5, Steps: 123 | Train Loss: 0.8309525 Vali Loss: 0.5279854 Best vali loss: 0.5279854
	iters: 100, epoch: 6 | loss: 0.7778302
	speed: 0.0094s/iter; left time: 2.5306s
Updating learning rate to 3.731052395312337e-05
Epoch: 6 cost time: 0.7268500328063965
Epoch: 6, Steps: 123 | Train Loss: 0.7778302 Vali Loss: 0.5316947 Best vali loss: 0.5279854
	iters: 100, epoch: 7 | loss: 0.4632413
	speed: 0.0091s/iter; left time: 1.3331s
Updating learning rate to 9.696689247590527e-06
Epoch: 7 cost time: 0.7268314361572266
Epoch: 7, Steps: 123 | Train Loss: 0.4632413 Vali Loss: 0.5356298 Best vali loss: 0.5279854
	iters: 100, epoch: 8 | loss: 0.5235364
	speed: 0.0090s/iter; left time: 0.2164s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7223155498504639
Epoch: 8, Steps: 123 | Train Loss: 0.5235364 Vali Loss: 0.5338270 Best vali loss: 0.5279854

best validation loss 0.5279854288370396

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010632561295, 'e_layers': 3, 'learning_rate': 0.0002979640764, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002979640764
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 1.0301399230957031
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6217324 Best vali loss: 0.6217324
Updating learning rate to 0.0001489820382
Validation loss decreased (0.6217 --> 0.5525).  Saving model state dict ...
Epoch: 2 cost time: 0.7313876152038574
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5525356 Best vali loss: 0.5525356
Updating learning rate to 7.44910191e-05
Epoch: 3 cost time: 0.7429511547088623
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5599220 Best vali loss: 0.5525356
Updating learning rate to 3.724550955e-05
Validation loss decreased (0.5525 --> 0.5372).  Saving model state dict ...
Epoch: 4 cost time: 0.7374348640441895
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5372285 Best vali loss: 0.5372285
Updating learning rate to 1.8622754775e-05
Validation loss decreased (0.5372 --> 0.5327).  Saving model state dict ...
Epoch: 5 cost time: 0.7396576404571533
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5327492 Best vali loss: 0.5327492
Updating learning rate to 9.3113773875e-06
Validation loss decreased (0.5327 --> 0.5320).  Saving model state dict ...
Epoch: 6 cost time: 0.7340466976165771
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5319711 Best vali loss: 0.5319711
Updating learning rate to 4.65568869375e-06
Epoch: 7 cost time: 0.7335257530212402
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5327399 Best vali loss: 0.5319711
Updating learning rate to 2.327844346875e-06
Validation loss decreased (0.5320 --> 0.5310).  Saving model state dict ...
Epoch: 8 cost time: 0.733586311340332
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5310228 Best vali loss: 0.5310228

best validation loss 0.5310228264260104

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0035669298905, 'e_layers': 4, 'learning_rate': 0.0007289180204, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0753796
	speed: 0.0118s/iter; left time: 21.9826s
	iters: 200, epoch: 1 | loss: 0.7673564
	speed: 0.0057s/iter; left time: 10.0343s
Updating learning rate to 0.0007011752301631023
Validation loss decreased (inf --> 0.6118).  Saving model state dict ...
Epoch: 1 cost time: 1.7242224216461182
Epoch: 1, Steps: 245 | Train Loss: 0.9213680 Vali Loss: 0.6117939 Best vali loss: 0.6117939
	iters: 100, epoch: 2 | loss: 0.6103877
	speed: 0.0109s/iter; left time: 17.5687s
	iters: 200, epoch: 2 | loss: 0.7754009
	speed: 0.0058s/iter; left time: 8.7638s
Updating learning rate to 0.000622170447776957
Validation loss decreased (0.6118 --> 0.5925).  Saving model state dict ...
Epoch: 2 cost time: 1.4314265251159668
Epoch: 2, Steps: 245 | Train Loss: 0.6928943 Vali Loss: 0.5925479 Best vali loss: 0.5925479
	iters: 100, epoch: 3 | loss: 1.3509949
	speed: 0.0111s/iter; left time: 15.1650s
	iters: 200, epoch: 3 | loss: 0.6356317
	speed: 0.0057s/iter; left time: 7.2332s
Updating learning rate to 0.0005039314351797193
Validation loss decreased (0.5925 --> 0.5646).  Saving model state dict ...
Epoch: 3 cost time: 1.451737642288208
Epoch: 3, Steps: 245 | Train Loss: 0.9933133 Vali Loss: 0.5645841 Best vali loss: 0.5645841
	iters: 100, epoch: 4 | loss: 0.7652965
	speed: 0.0111s/iter; left time: 12.4954s
	iters: 200, epoch: 4 | loss: 0.9096576
	speed: 0.0056s/iter; left time: 5.7849s
Updating learning rate to 0.0003644590102
Validation loss decreased (0.5646 --> 0.5493).  Saving model state dict ...
Epoch: 4 cost time: 1.4379894733428955
Epoch: 4, Steps: 245 | Train Loss: 0.8374771 Vali Loss: 0.5492729 Best vali loss: 0.5492729
	iters: 100, epoch: 5 | loss: 0.5910510
	speed: 0.0108s/iter; left time: 9.5129s
	iters: 200, epoch: 5 | loss: 0.4967207
	speed: 0.0056s/iter; left time: 4.3694s
Updating learning rate to 0.00022498658522028075
Epoch: 5 cost time: 1.4052577018737793
Epoch: 5, Steps: 245 | Train Loss: 0.5438859 Vali Loss: 0.5498972 Best vali loss: 0.5492729
	iters: 100, epoch: 6 | loss: 0.6938165
	speed: 0.0109s/iter; left time: 6.9410s
	iters: 200, epoch: 6 | loss: 0.7836604
	speed: 0.0057s/iter; left time: 3.0524s
Updating learning rate to 0.00010674757262304294
Epoch: 6 cost time: 1.4473915100097656
Epoch: 6, Steps: 245 | Train Loss: 0.7387385 Vali Loss: 0.5557267 Best vali loss: 0.5492729
	iters: 100, epoch: 7 | loss: 0.7517387
	speed: 0.0106s/iter; left time: 4.1260s
	iters: 200, epoch: 7 | loss: 0.5841660
	speed: 0.0052s/iter; left time: 1.5232s
Updating learning rate to 2.7742790236897715e-05
Epoch: 7 cost time: 1.3265821933746338
Epoch: 7, Steps: 245 | Train Loss: 0.6679523 Vali Loss: 0.5601092 Best vali loss: 0.5492729
	iters: 100, epoch: 8 | loss: 0.6455145
	speed: 0.0107s/iter; left time: 1.5601s
	iters: 200, epoch: 8 | loss: 0.4341022
	speed: 0.0053s/iter; left time: 0.2454s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3846018314361572
Epoch: 8, Steps: 245 | Train Loss: 0.5398084 Vali Loss: 0.5580178 Best vali loss: 0.5492729

best validation loss 0.5492728858951725

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494665051, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744684
	speed: 0.0120s/iter; left time: 10.6363s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0464661121368408
Epoch: 1, Steps: 123 | Train Loss: 0.7744684 Vali Loss: 0.6172481 Best vali loss: 0.6172481
	iters: 100, epoch: 2 | loss: 0.9521384
	speed: 0.0092s/iter; left time: 7.0055s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6172 --> 0.5663).  Saving model state dict ...
Epoch: 2 cost time: 0.7171716690063477
Epoch: 2, Steps: 123 | Train Loss: 0.9521384 Vali Loss: 0.5663413 Best vali loss: 0.5663413
	iters: 100, epoch: 3 | loss: 0.8422508
	speed: 0.0095s/iter; left time: 6.0831s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5663 --> 0.5380).  Saving model state dict ...
Epoch: 3 cost time: 0.7298355102539062
Epoch: 3, Steps: 123 | Train Loss: 0.8422508 Vali Loss: 0.5379613 Best vali loss: 0.5379613

best validation loss 0.5379612545953862

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0001768563292, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7614532
	speed: 0.0117s/iter; left time: 10.3297s
Updating learning rate to 0.0001701251359714791
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.0246813297271729
Epoch: 1, Steps: 123 | Train Loss: 0.7614532 Vali Loss: 0.6077229 Best vali loss: 0.6077229
	iters: 100, epoch: 2 | loss: 0.9347333
	speed: 0.0094s/iter; left time: 7.1435s
Updating learning rate to 0.0001509563194365402
Validation loss decreased (0.6077 --> 0.5622).  Saving model state dict ...
Epoch: 2 cost time: 0.7275049686431885
Epoch: 2, Steps: 123 | Train Loss: 0.9347333 Vali Loss: 0.5622346 Best vali loss: 0.5622346
	iters: 100, epoch: 3 | loss: 0.8602597
	speed: 0.0094s/iter; left time: 5.9772s
Updating learning rate to 0.00012226815814687312
Validation loss decreased (0.5622 --> 0.5508).  Saving model state dict ...
Epoch: 3 cost time: 0.7245323657989502
Epoch: 3, Steps: 123 | Train Loss: 0.8602597 Vali Loss: 0.5507627 Best vali loss: 0.5507627

best validation loss 0.5507626583431673

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.001035595987, 'e_layers': 2, 'learning_rate': 8.18793321e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3689597
	speed: 0.0096s/iter; left time: 74.2373s
	iters: 200, epoch: 1 | loss: 1.3706956
	speed: 0.0034s/iter; left time: 26.1621s
	iters: 300, epoch: 1 | loss: 0.8339272
	speed: 0.0035s/iter; left time: 26.3177s
	iters: 400, epoch: 1 | loss: 1.3915360
	speed: 0.0034s/iter; left time: 25.4603s
	iters: 500, epoch: 1 | loss: 0.9135841
	speed: 0.0035s/iter; left time: 25.4018s
	iters: 600, epoch: 1 | loss: 1.5126370
	speed: 0.0033s/iter; left time: 23.9777s
	iters: 700, epoch: 1 | loss: 0.8105534
	speed: 0.0035s/iter; left time: 24.8951s
	iters: 800, epoch: 1 | loss: 0.7267911
	speed: 0.0034s/iter; left time: 23.9404s
	iters: 900, epoch: 1 | loss: 1.0518280
	speed: 0.0035s/iter; left time: 24.1121s
Updating learning rate to 8.18793321e-05
Validation loss decreased (inf --> 0.5926).  Saving model state dict ...
Epoch: 1 cost time: 3.704943895339966
Epoch: 1, Steps: 979 | Train Loss: 0.9978347 Vali Loss: 0.5926206 Best vali loss: 0.5926206
	iters: 100, epoch: 2 | loss: 0.9845368
	speed: 0.0118s/iter; left time: 79.8876s
	iters: 200, epoch: 2 | loss: 0.3278515
	speed: 0.0036s/iter; left time: 23.6251s
	iters: 300, epoch: 2 | loss: 0.3926893
	speed: 0.0035s/iter; left time: 23.2629s
	iters: 400, epoch: 2 | loss: 1.4066051
	speed: 0.0034s/iter; left time: 21.7532s
	iters: 500, epoch: 2 | loss: 0.9772204
	speed: 0.0033s/iter; left time: 21.2568s
	iters: 600, epoch: 2 | loss: 1.3054724
	speed: 0.0033s/iter; left time: 20.8220s
	iters: 700, epoch: 2 | loss: 1.0077840
	speed: 0.0034s/iter; left time: 21.1800s
	iters: 800, epoch: 2 | loss: 0.2653819
	speed: 0.0034s/iter; left time: 20.3228s
	iters: 900, epoch: 2 | loss: 0.8829792
	speed: 0.0035s/iter; left time: 21.1285s
Updating learning rate to 4.093966605e-05
Epoch: 2 cost time: 3.4398744106292725
Epoch: 2, Steps: 979 | Train Loss: 0.8389467 Vali Loss: 0.6025276 Best vali loss: 0.5926206
	iters: 100, epoch: 3 | loss: 0.7067266
	speed: 0.0115s/iter; left time: 66.4811s
	iters: 200, epoch: 3 | loss: 0.6509955
	speed: 0.0036s/iter; left time: 20.4765s
	iters: 300, epoch: 3 | loss: 1.1399350
	speed: 0.0036s/iter; left time: 20.0549s
	iters: 400, epoch: 3 | loss: 1.0693750
	speed: 0.0036s/iter; left time: 19.8045s
	iters: 500, epoch: 3 | loss: 1.0123053
	speed: 0.0035s/iter; left time: 18.7018s
	iters: 600, epoch: 3 | loss: 0.4154245
	speed: 0.0035s/iter; left time: 18.3064s
	iters: 700, epoch: 3 | loss: 0.7353213
	speed: 0.0036s/iter; left time: 18.5454s
	iters: 800, epoch: 3 | loss: 1.6432565
	speed: 0.0035s/iter; left time: 17.9481s
	iters: 900, epoch: 3 | loss: 0.2690558
	speed: 0.0035s/iter; left time: 17.1801s
Updating learning rate to 2.0469833025e-05
Validation loss decreased (0.5926 --> 0.5534).  Saving model state dict ...
Epoch: 3 cost time: 3.517183780670166
Epoch: 3, Steps: 979 | Train Loss: 0.8491551 Vali Loss: 0.5533870 Best vali loss: 0.5533870

best validation loss 0.5533869847455327

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494665051, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5800053
	speed: 0.0121s/iter; left time: 6.2221s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5380 --> 0.5268).  Saving model state dict ...
Epoch: 4 cost time: 1.027242660522461
Epoch: 4, Steps: 123 | Train Loss: 0.5800053 Vali Loss: 0.5268328 Best vali loss: 0.5268328
	iters: 100, epoch: 5 | loss: 0.8152536
	speed: 0.0094s/iter; left time: 3.7040s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5268 --> 0.5204).  Saving model state dict ...
Epoch: 5 cost time: 0.7308378219604492
Epoch: 5, Steps: 123 | Train Loss: 0.8152536 Vali Loss: 0.5203712 Best vali loss: 0.5203712
	iters: 100, epoch: 6 | loss: 0.7597842
	speed: 0.0093s/iter; left time: 2.5197s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7209172248840332
Epoch: 6, Steps: 123 | Train Loss: 0.7597842 Vali Loss: 0.5276957 Best vali loss: 0.5203712
	iters: 100, epoch: 7 | loss: 0.4339425
	speed: 0.0090s/iter; left time: 1.3288s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7187116146087646
Epoch: 7, Steps: 123 | Train Loss: 0.4339425 Vali Loss: 0.5386950 Best vali loss: 0.5203712
	iters: 100, epoch: 8 | loss: 0.5072024
	speed: 0.0090s/iter; left time: 0.2156s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7155020236968994
Epoch: 8, Steps: 123 | Train Loss: 0.5072024 Vali Loss: 0.5356798 Best vali loss: 0.5203712

best validation loss 0.5203712052186845

[INFO][abstract_intensifier.py:595] Added config e3cdb4 and rejected config 99d3ef as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 3, 'learning_rate': 0.0001429550301, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6511413
	speed: 0.0140s/iter; left time: 12.3766s
Updating learning rate to 0.00013751412823946246
Validation loss decreased (inf --> 0.6063).  Saving model state dict ...
Epoch: 1 cost time: 1.307213544845581
Epoch: 1, Steps: 123 | Train Loss: 0.6511413 Vali Loss: 0.6062571 Best vali loss: 0.6062571
	iters: 100, epoch: 2 | loss: 0.9343647
	speed: 0.0126s/iter; left time: 9.5832s
Updating learning rate to 0.0001220197506442185
Validation loss decreased (0.6063 --> 0.5720).  Saving model state dict ...
Epoch: 2 cost time: 1.0077228546142578
Epoch: 2, Steps: 123 | Train Loss: 0.9343647 Vali Loss: 0.5720331 Best vali loss: 0.5720331
	iters: 100, epoch: 3 | loss: 0.8717946
	speed: 0.0126s/iter; left time: 8.0790s
Updating learning rate to 9.883077584626137e-05
Validation loss decreased (0.5720 --> 0.5473).  Saving model state dict ...
Epoch: 3 cost time: 1.0118584632873535
Epoch: 3, Steps: 123 | Train Loss: 0.8717946 Vali Loss: 0.5473365 Best vali loss: 0.5473365
	iters: 100, epoch: 4 | loss: 0.6203976
	speed: 0.0126s/iter; left time: 6.5234s
Updating learning rate to 7.147751505e-05
Validation loss decreased (0.5473 --> 0.5397).  Saving model state dict ...
Epoch: 4 cost time: 1.005845546722412
Epoch: 4, Steps: 123 | Train Loss: 0.6203976 Vali Loss: 0.5397410 Best vali loss: 0.5397410
	iters: 100, epoch: 5 | loss: 0.8278275
	speed: 0.0124s/iter; left time: 4.8776s
Updating learning rate to 4.412425425373864e-05
Validation loss decreased (0.5397 --> 0.5388).  Saving model state dict ...
Epoch: 5 cost time: 1.0039632320404053
Epoch: 5, Steps: 123 | Train Loss: 0.8278275 Vali Loss: 0.5388207 Best vali loss: 0.5388207
	iters: 100, epoch: 6 | loss: 0.5564638
	speed: 0.0126s/iter; left time: 3.3968s
Updating learning rate to 2.0935279455781495e-05
Epoch: 6 cost time: 1.0095806121826172
Epoch: 6, Steps: 123 | Train Loss: 0.5564638 Vali Loss: 0.5459556 Best vali loss: 0.5388207
	iters: 100, epoch: 7 | loss: 0.7657053
	speed: 0.0122s/iter; left time: 1.7920s
Updating learning rate to 5.4409018605375375e-06
Epoch: 7 cost time: 1.0042932033538818
Epoch: 7, Steps: 123 | Train Loss: 0.7657053 Vali Loss: 0.5416043 Best vali loss: 0.5388207
	iters: 100, epoch: 8 | loss: 0.7622292
	speed: 0.0122s/iter; left time: 0.2923s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0135009288787842
Epoch: 8, Steps: 123 | Train Loss: 0.7622292 Vali Loss: 0.5434057 Best vali loss: 0.5388207

best validation loss 0.5388206818323342

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.002000895637, 'e_layers': 2, 'learning_rate': 8.56357954e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8234906
	speed: 0.0115s/iter; left time: 10.1792s
Updating learning rate to 8.23764770101921e-05
Validation loss decreased (inf --> 0.5971).  Saving model state dict ...
Epoch: 1 cost time: 0.9840302467346191
Epoch: 1, Steps: 123 | Train Loss: 0.8234906 Vali Loss: 0.5971026 Best vali loss: 0.5971026
	iters: 100, epoch: 2 | loss: 1.0923218
	speed: 0.0089s/iter; left time: 6.7512s
Updating learning rate to 7.309472351982188e-05
Epoch: 2 cost time: 0.6911101341247559
Epoch: 2, Steps: 123 | Train Loss: 1.0923218 Vali Loss: 0.6030386 Best vali loss: 0.5971026
	iters: 100, epoch: 3 | loss: 0.9885378
	speed: 0.0087s/iter; left time: 5.5489s
Updating learning rate to 5.9203597758493286e-05
Validation loss decreased (0.5971 --> 0.5707).  Saving model state dict ...
Epoch: 3 cost time: 0.688176155090332
Epoch: 3, Steps: 123 | Train Loss: 0.9885378 Vali Loss: 0.5706745 Best vali loss: 0.5706745
	iters: 100, epoch: 4 | loss: 0.7685059
	speed: 0.0091s/iter; left time: 4.6855s
Updating learning rate to 4.28178977e-05
Validation loss decreased (0.5707 --> 0.5437).  Saving model state dict ...
Epoch: 4 cost time: 0.6728370189666748
Epoch: 4, Steps: 123 | Train Loss: 0.7685059 Vali Loss: 0.5437045 Best vali loss: 0.5437045
	iters: 100, epoch: 5 | loss: 0.7423483
	speed: 0.0089s/iter; left time: 3.5147s
Updating learning rate to 2.643219764150672e-05
Validation loss decreased (0.5437 --> 0.5434).  Saving model state dict ...
Epoch: 5 cost time: 0.6779801845550537
Epoch: 5, Steps: 123 | Train Loss: 0.7423483 Vali Loss: 0.5433523 Best vali loss: 0.5433523
	iters: 100, epoch: 6 | loss: 0.8956910
	speed: 0.0088s/iter; left time: 2.3826s
Updating learning rate to 1.2541071880178127e-05
Validation loss decreased (0.5434 --> 0.5387).  Saving model state dict ...
Epoch: 6 cost time: 0.6833713054656982
Epoch: 6, Steps: 123 | Train Loss: 0.8956910 Vali Loss: 0.5386505 Best vali loss: 0.5386505
	iters: 100, epoch: 7 | loss: 1.0879592
	speed: 0.0088s/iter; left time: 1.2974s
Updating learning rate to 3.2593183898079004e-06
Epoch: 7 cost time: 0.6759591102600098
Epoch: 7, Steps: 123 | Train Loss: 1.0879592 Vali Loss: 0.5476338 Best vali loss: 0.5386505
	iters: 100, epoch: 8 | loss: 0.7116175
	speed: 0.0084s/iter; left time: 0.2024s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6722776889801025
Epoch: 8, Steps: 123 | Train Loss: 0.7116175 Vali Loss: 0.5495778 Best vali loss: 0.5386505

best validation loss 0.5386504971942434

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019531302979, 'e_layers': 2, 'learning_rate': 6.85884356e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8290231
	speed: 0.0112s/iter; left time: 9.9484s
Updating learning rate to 6.597794370890424e-05
Validation loss decreased (inf --> 0.5989).  Saving model state dict ...
Epoch: 1 cost time: 0.976212739944458
Epoch: 1, Steps: 123 | Train Loss: 0.8290231 Vali Loss: 0.5989323 Best vali loss: 0.5989323
	iters: 100, epoch: 2 | loss: 1.1008817
	speed: 0.0088s/iter; left time: 6.6878s
Updating learning rate to 5.85438917618684e-05
Epoch: 2 cost time: 0.6753664016723633
Epoch: 2, Steps: 123 | Train Loss: 1.1008817 Vali Loss: 0.6019276 Best vali loss: 0.5989323
	iters: 100, epoch: 3 | loss: 1.0148965
	speed: 0.0086s/iter; left time: 5.5017s
Updating learning rate to 4.741804677797996e-05
Validation loss decreased (0.5989 --> 0.5801).  Saving model state dict ...
Epoch: 3 cost time: 0.6791384220123291
Epoch: 3, Steps: 123 | Train Loss: 1.0148965 Vali Loss: 0.5801103 Best vali loss: 0.5801103

best validation loss 0.5801102667150537

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019868077963, 'e_layers': 2, 'learning_rate': 7.07945135e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8281990
	speed: 0.0114s/iter; left time: 10.1198s
Updating learning rate to 6.810005776837198e-05
Validation loss decreased (inf --> 0.5986).  Saving model state dict ...
Epoch: 1 cost time: 0.9823782444000244
Epoch: 1, Steps: 123 | Train Loss: 0.8281990 Vali Loss: 0.5985868 Best vali loss: 0.5985868
	iters: 100, epoch: 2 | loss: 1.0996974
	speed: 0.0088s/iter; left time: 6.6700s
Updating learning rate to 6.042689703332629e-05
Epoch: 2 cost time: 0.674187421798706
Epoch: 2, Steps: 123 | Train Loss: 1.0996974 Vali Loss: 0.6021062 Best vali loss: 0.5985868
	iters: 100, epoch: 3 | loss: 1.0121500
	speed: 0.0086s/iter; left time: 5.4818s
Updating learning rate to 4.8943200459398344e-05
Validation loss decreased (0.5986 --> 0.5780).  Saving model state dict ...
Epoch: 3 cost time: 0.676969051361084
Epoch: 3, Steps: 123 | Train Loss: 1.0121500 Vali Loss: 0.5779543 Best vali loss: 0.5779543

best validation loss 0.5779543244855264

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015912624251, 'e_layers': 1, 'learning_rate': 0.0002259194388, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002173208921518781
Validation loss decreased (inf --> 0.6016).  Saving model state dict ...
Epoch: 1 cost time: 0.712385892868042
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6015651 Best vali loss: 0.6015651
Updating learning rate to 0.0001928343029886696
Epoch: 2 cost time: 0.44173455238342285
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6221969 Best vali loss: 0.6015651
Updating learning rate to 0.00015618753253898943
Epoch: 3 cost time: 0.41094112396240234
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6026869 Best vali loss: 0.6015651

best validation loss 0.6015651371952341

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0019868077963, 'e_layers': 2, 'learning_rate': 7.07945135e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7547780
	speed: 0.0116s/iter; left time: 6.0104s
Updating learning rate to 3.539725675e-05
Validation loss decreased (0.5780 --> 0.5690).  Saving model state dict ...
Epoch: 4 cost time: 0.9779980182647705
Epoch: 4, Steps: 123 | Train Loss: 0.7547780 Vali Loss: 0.5689845 Best vali loss: 0.5689845
	iters: 100, epoch: 5 | loss: 0.9728018
	speed: 0.0090s/iter; left time: 3.5318s
Updating learning rate to 2.1851313040601658e-05
Validation loss decreased (0.5690 --> 0.5556).  Saving model state dict ...
Epoch: 5 cost time: 0.6832196712493896
Epoch: 5, Steps: 123 | Train Loss: 0.9728018 Vali Loss: 0.5555857 Best vali loss: 0.5555857
	iters: 100, epoch: 6 | loss: 0.9328672
	speed: 0.0088s/iter; left time: 2.3648s
Updating learning rate to 1.036761646667371e-05
Validation loss decreased (0.5556 --> 0.5509).  Saving model state dict ...
Epoch: 6 cost time: 0.6748878955841064
Epoch: 6, Steps: 123 | Train Loss: 0.9328672 Vali Loss: 0.5508778 Best vali loss: 0.5508778
	iters: 100, epoch: 7 | loss: 0.7630390
	speed: 0.0088s/iter; left time: 1.2903s
Updating learning rate to 2.694455731628011e-06
Validation loss decreased (0.5509 --> 0.5508).  Saving model state dict ...
Epoch: 7 cost time: 0.6754417419433594
Epoch: 7, Steps: 123 | Train Loss: 0.7630390 Vali Loss: 0.5508320 Best vali loss: 0.5508320
	iters: 100, epoch: 8 | loss: 0.7436512
	speed: 0.0089s/iter; left time: 0.2125s
Updating learning rate to 0.0
Validation loss decreased (0.5508 --> 0.5505).  Saving model state dict ...
Epoch: 8 cost time: 0.6797149181365967
Epoch: 8, Steps: 123 | Train Loss: 0.7436512 Vali Loss: 0.5505340 Best vali loss: 0.5505340

best validation loss 0.5505340452383978

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0009130075991, 'e_layers': 4, 'learning_rate': 0.0009215492938, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6384268
	speed: 0.0118s/iter; left time: 21.8731s
	iters: 200, epoch: 1 | loss: 1.2176657
	speed: 0.0056s/iter; left time: 9.9078s
Updating learning rate to 0.0008864749122710252
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 1.7200400829315186
Epoch: 1, Steps: 245 | Train Loss: 0.9280463 Vali Loss: 0.6031889 Best vali loss: 0.6031889
	iters: 100, epoch: 2 | loss: 0.9037299
	speed: 0.0112s/iter; left time: 18.0204s
	iters: 200, epoch: 2 | loss: 0.7946318
	speed: 0.0058s/iter; left time: 8.7483s
Updating learning rate to 0.000786591524321827
Epoch: 2 cost time: 1.4654650688171387
Epoch: 2, Steps: 245 | Train Loss: 0.8491809 Vali Loss: 0.6203999 Best vali loss: 0.6031889
	iters: 100, epoch: 3 | loss: 0.6034462
	speed: 0.0110s/iter; left time: 15.0866s
	iters: 200, epoch: 3 | loss: 0.8337207
	speed: 0.0058s/iter; left time: 7.3813s
Updating learning rate to 0.0006371054703225043
Epoch: 3 cost time: 1.4646918773651123
Epoch: 3, Steps: 245 | Train Loss: 0.7185835 Vali Loss: 0.6163397 Best vali loss: 0.6031889
	iters: 100, epoch: 4 | loss: 0.9031723
	speed: 0.0106s/iter; left time: 11.9757s
	iters: 200, epoch: 4 | loss: 0.7987338
	speed: 0.0053s/iter; left time: 5.3903s
Updating learning rate to 0.0004607746469
Epoch: 4 cost time: 1.3311309814453125
Epoch: 4, Steps: 245 | Train Loss: 0.8509530 Vali Loss: 0.6266299 Best vali loss: 0.6031889
	iters: 100, epoch: 5 | loss: 0.7405016
	speed: 0.0109s/iter; left time: 9.6103s
	iters: 200, epoch: 5 | loss: 0.8249886
	speed: 0.0058s/iter; left time: 4.5651s
Updating learning rate to 0.0002844438234774957
Validation loss decreased (0.6032 --> 0.5886).  Saving model state dict ...
Epoch: 5 cost time: 1.483224630355835
Epoch: 5, Steps: 245 | Train Loss: 0.7827451 Vali Loss: 0.5885851 Best vali loss: 0.5885851
	iters: 100, epoch: 6 | loss: 0.5644803
	speed: 0.0109s/iter; left time: 6.9072s
	iters: 200, epoch: 6 | loss: 0.8282177
	speed: 0.0055s/iter; left time: 2.9437s
Updating learning rate to 0.00013495776947817302
Validation loss decreased (0.5886 --> 0.5586).  Saving model state dict ...
Epoch: 6 cost time: 1.3758418560028076
Epoch: 6, Steps: 245 | Train Loss: 0.6963490 Vali Loss: 0.5586315 Best vali loss: 0.5586315
	iters: 100, epoch: 7 | loss: 0.8618333
	speed: 0.0100s/iter; left time: 3.9294s
	iters: 200, epoch: 7 | loss: 0.6557338
	speed: 0.0049s/iter; left time: 1.4251s
Updating learning rate to 3.5074381528974785e-05
Epoch: 7 cost time: 1.2732977867126465
Epoch: 7, Steps: 245 | Train Loss: 0.7587835 Vali Loss: 0.5606328 Best vali loss: 0.5586315
	iters: 100, epoch: 8 | loss: 0.4913145
	speed: 0.0101s/iter; left time: 1.4715s
	iters: 200, epoch: 8 | loss: 0.4971480
	speed: 0.0051s/iter; left time: 0.2346s
Updating learning rate to 0.0
Validation loss decreased (0.5586 --> 0.5573).  Saving model state dict ...
Epoch: 8 cost time: 1.3070807456970215
Epoch: 8, Steps: 245 | Train Loss: 0.4942313 Vali Loss: 0.5573268 Best vali loss: 0.5573268

best validation loss 0.5573267532492721

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744631
	speed: 0.0116s/iter; left time: 10.2349s
Updating learning rate to 0.00028649739841911696
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0191268920898438
Epoch: 1, Steps: 123 | Train Loss: 0.7744631 Vali Loss: 0.6172548 Best vali loss: 0.6172548
	iters: 100, epoch: 2 | loss: 0.9467874
	speed: 0.0093s/iter; left time: 7.1241s
Updating learning rate to 0.00025421635989607337
Validation loss decreased (0.6173 --> 0.5938).  Saving model state dict ...
Epoch: 2 cost time: 0.7291607856750488
Epoch: 2, Steps: 123 | Train Loss: 0.9467874 Vali Loss: 0.5937871 Best vali loss: 0.5937871
	iters: 100, epoch: 3 | loss: 0.8467565
	speed: 0.0095s/iter; left time: 6.0671s
Updating learning rate to 0.00020590437161765966
Validation loss decreased (0.5938 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 0.7283644676208496
Epoch: 3, Steps: 123 | Train Loss: 0.8467565 Vali Loss: 0.5520784 Best vali loss: 0.5520784
	iters: 100, epoch: 4 | loss: 0.4934998
	speed: 0.0093s/iter; left time: 4.8186s
Updating learning rate to 0.00014891649585
Validation loss decreased (0.5521 --> 0.5403).  Saving model state dict ...
Epoch: 4 cost time: 0.7281160354614258
Epoch: 4, Steps: 123 | Train Loss: 0.4934998 Vali Loss: 0.5403430 Best vali loss: 0.5403430
	iters: 100, epoch: 5 | loss: 0.5582215
	speed: 0.0093s/iter; left time: 3.6595s
Updating learning rate to 9.192862008234036e-05
Validation loss decreased (0.5403 --> 0.5239).  Saving model state dict ...
Epoch: 5 cost time: 0.7258667945861816
Epoch: 5, Steps: 123 | Train Loss: 0.5582215 Vali Loss: 0.5239276 Best vali loss: 0.5239276
	iters: 100, epoch: 6 | loss: 0.5888581
	speed: 0.0094s/iter; left time: 2.5433s
Updating learning rate to 4.3616631803926644e-05
Epoch: 6 cost time: 0.7286231517791748
Epoch: 6, Steps: 123 | Train Loss: 0.5888581 Vali Loss: 0.5300456 Best vali loss: 0.5239276
	iters: 100, epoch: 7 | loss: 0.5378510
	speed: 0.0092s/iter; left time: 1.3463s
Updating learning rate to 1.1335593280883028e-05
Epoch: 7 cost time: 0.7267773151397705
Epoch: 7, Steps: 123 | Train Loss: 0.5378510 Vali Loss: 0.5330446 Best vali loss: 0.5239276
	iters: 100, epoch: 8 | loss: 0.6973385
	speed: 0.0091s/iter; left time: 0.2184s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7240955829620361
Epoch: 8, Steps: 123 | Train Loss: 0.6973385 Vali Loss: 0.5397226 Best vali loss: 0.5239276

best validation loss 0.5239275814978296

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010712571798, 'e_layers': 3, 'learning_rate': 0.0005248429393, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005048672943511668
Validation loss decreased (inf --> 0.5922).  Saving model state dict ...
Epoch: 1 cost time: 0.9049265384674072
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5922069 Best vali loss: 0.5922069
Updating learning rate to 0.0004479814703684547
Validation loss decreased (0.5922 --> 0.5522).  Saving model state dict ...
Epoch: 2 cost time: 0.6100471019744873
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5521598 Best vali loss: 0.5521598
Updating learning rate to 0.00036284581838195323
Validation loss decreased (0.5522 --> 0.5460).  Saving model state dict ...
Epoch: 3 cost time: 0.6156399250030518
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5460327 Best vali loss: 0.5460327

best validation loss 0.5460327026856161

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010690954359, 'e_layers': 3, 'learning_rate': 0.0004780067133, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00045981366606043033
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 0.9020233154296875
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5982406 Best vali loss: 0.5982406
Updating learning rate to 0.0004080042508635619
Validation loss decreased (0.5982 --> 0.5576).  Saving model state dict ...
Epoch: 2 cost time: 0.6076247692108154
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5576449 Best vali loss: 0.5576449
Updating learning rate to 0.00033046598151959976
Epoch: 3 cost time: 0.6038849353790283
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5686445 Best vali loss: 0.5576449

best validation loss 0.5576449467428632

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010775826635, 'e_layers': 3, 'learning_rate': 0.0005100586664, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004906457143334812
Validation loss decreased (inf --> 0.5846).  Saving model state dict ...
Epoch: 1 cost time: 0.8987064361572266
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5845968 Best vali loss: 0.5845968
Updating learning rate to 0.00043536230410720357
Validation loss decreased (0.5846 --> 0.5687).  Saving model state dict ...
Epoch: 2 cost time: 0.611072301864624
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5687430 Best vali loss: 0.5687430
Updating learning rate to 0.00035262483378275617
Validation loss decreased (0.5687 --> 0.5637).  Saving model state dict ...
Epoch: 3 cost time: 0.606701135635376
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5636927 Best vali loss: 0.5636927

best validation loss 0.5636927126624528

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010712571798, 'e_layers': 3, 'learning_rate': 0.0005248429393, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00026242146965
Epoch: 4 cost time: 0.8924274444580078
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5575761 Best vali loss: 0.5460327
Updating learning rate to 0.00016199712091804678
Validation loss decreased (0.5460 --> 0.5361).  Saving model state dict ...
Epoch: 5 cost time: 0.6113767623901367
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5361271 Best vali loss: 0.5361271
Updating learning rate to 7.686146893154524e-05
Epoch: 6 cost time: 0.6140809059143066
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5458254 Best vali loss: 0.5361271
Updating learning rate to 1.9975644948833178e-05
Epoch: 7 cost time: 0.6100044250488281
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5450360 Best vali loss: 0.5361271
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6145932674407959
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5454943 Best vali loss: 0.5361271

best validation loss 0.5361270544872081

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010489148705, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9041325
	speed: 0.0118s/iter; left time: 10.4625s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 1.0370986461639404
Epoch: 1, Steps: 123 | Train Loss: 0.9041325 Vali Loss: 0.6030813 Best vali loss: 0.6030813
	iters: 100, epoch: 2 | loss: 0.8214096
	speed: 0.0094s/iter; left time: 7.1516s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6031 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.7422258853912354
Epoch: 2, Steps: 123 | Train Loss: 0.8214096 Vali Loss: 0.5995172 Best vali loss: 0.5995172
	iters: 100, epoch: 3 | loss: 0.6630944
	speed: 0.0096s/iter; left time: 6.1212s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.738976240158081
Epoch: 3, Steps: 123 | Train Loss: 0.6630944 Vali Loss: 0.6311602 Best vali loss: 0.5995172
	iters: 100, epoch: 4 | loss: 0.9069754
	speed: 0.0092s/iter; left time: 4.7334s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 0.7346103191375732
Epoch: 4, Steps: 123 | Train Loss: 0.9069754 Vali Loss: 0.6216669 Best vali loss: 0.5995172
	iters: 100, epoch: 5 | loss: 0.8005125
	speed: 0.0092s/iter; left time: 3.6081s
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 0.7361187934875488
Epoch: 5, Steps: 123 | Train Loss: 0.8005125 Vali Loss: 0.6342606 Best vali loss: 0.5995172
	iters: 100, epoch: 6 | loss: 0.7157475
	speed: 0.0093s/iter; left time: 2.5045s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7408256530761719
Epoch: 6, Steps: 123 | Train Loss: 0.7157475 Vali Loss: 0.6446471 Best vali loss: 0.5995172
	iters: 100, epoch: 7 | loss: 0.7236931
	speed: 0.0092s/iter; left time: 1.3474s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.736241340637207
Epoch: 7, Steps: 123 | Train Loss: 0.7236931 Vali Loss: 0.6509483 Best vali loss: 0.5995172
	iters: 100, epoch: 8 | loss: 0.8113725
	speed: 0.0092s/iter; left time: 0.2214s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7462191581726074
Epoch: 8, Steps: 123 | Train Loss: 0.8113725 Vali Loss: 0.6444695 Best vali loss: 0.5995172

best validation loss 0.5995172474848788

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0055131722371, 'e_layers': 3, 'learning_rate': 0.0001237703353, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7143160
	speed: 0.0125s/iter; left time: 11.0907s
Updating learning rate to 0.0001237703353
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 1.1294078826904297
Epoch: 1, Steps: 123 | Train Loss: 0.7143160 Vali Loss: 0.6020466 Best vali loss: 0.6020466
	iters: 100, epoch: 2 | loss: 0.7013391
	speed: 0.0101s/iter; left time: 7.7084s
Updating learning rate to 6.188516765e-05
Validation loss decreased (0.6020 --> 0.6016).  Saving model state dict ...
Epoch: 2 cost time: 0.7907111644744873
Epoch: 2, Steps: 123 | Train Loss: 0.7013391 Vali Loss: 0.6016264 Best vali loss: 0.6016264
	iters: 100, epoch: 3 | loss: 0.7664026
	speed: 0.0103s/iter; left time: 6.5687s
Updating learning rate to 3.0942583825e-05
Validation loss decreased (0.6016 --> 0.5694).  Saving model state dict ...
Epoch: 3 cost time: 0.804462194442749
Epoch: 3, Steps: 123 | Train Loss: 0.7664026 Vali Loss: 0.5693748 Best vali loss: 0.5693748
	iters: 100, epoch: 4 | loss: 0.6951758
	speed: 0.0102s/iter; left time: 5.2812s
Updating learning rate to 1.54712919125e-05
Validation loss decreased (0.5694 --> 0.5534).  Saving model state dict ...
Epoch: 4 cost time: 0.7958447933197021
Epoch: 4, Steps: 123 | Train Loss: 0.6951758 Vali Loss: 0.5534377 Best vali loss: 0.5534377
	iters: 100, epoch: 5 | loss: 0.7490919
	speed: 0.0101s/iter; left time: 3.9609s
Updating learning rate to 7.73564595625e-06
Validation loss decreased (0.5534 --> 0.5512).  Saving model state dict ...
Epoch: 5 cost time: 0.7902071475982666
Epoch: 5, Steps: 123 | Train Loss: 0.7490919 Vali Loss: 0.5511636 Best vali loss: 0.5511636
	iters: 100, epoch: 6 | loss: 0.8508849
	speed: 0.0101s/iter; left time: 2.7192s
Updating learning rate to 3.867822978125e-06
Epoch: 6 cost time: 0.7866630554199219
Epoch: 6, Steps: 123 | Train Loss: 0.8508849 Vali Loss: 0.5532053 Best vali loss: 0.5511636
	iters: 100, epoch: 7 | loss: 0.7443651
	speed: 0.0096s/iter; left time: 1.4151s
Updating learning rate to 1.9339114890625e-06
Validation loss decreased (0.5512 --> 0.5506).  Saving model state dict ...
Epoch: 7 cost time: 0.7803630828857422
Epoch: 7, Steps: 123 | Train Loss: 0.7443651 Vali Loss: 0.5506146 Best vali loss: 0.5506146
	iters: 100, epoch: 8 | loss: 0.8733633
	speed: 0.0102s/iter; left time: 0.2441s
Updating learning rate to 9.6695574453125e-07
Epoch: 8 cost time: 0.7913475036621094
Epoch: 8, Steps: 123 | Train Loss: 0.8733633 Vali Loss: 0.5508959 Best vali loss: 0.5506146

best validation loss 0.5506146044325133

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0106655673933, 'e_layers': 4, 'learning_rate': 0.000249129675, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000249129675
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 1.3258213996887207
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6085952 Best vali loss: 0.6085952
Updating learning rate to 0.0001245648375
Validation loss decreased (0.6086 --> 0.5554).  Saving model state dict ...
Epoch: 2 cost time: 1.0122201442718506
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5553702 Best vali loss: 0.5553702
Updating learning rate to 6.228241875e-05
Validation loss decreased (0.5554 --> 0.5462).  Saving model state dict ...
Epoch: 3 cost time: 1.0105633735656738
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5462454 Best vali loss: 0.5462454

best validation loss 0.5462454043290836

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494472739, 'e_layers': 2, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744631
	speed: 0.0120s/iter; left time: 10.6491s
Updating learning rate to 0.00028649739841911696
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.043548583984375
Epoch: 1, Steps: 123 | Train Loss: 0.7744631 Vali Loss: 0.6172548 Best vali loss: 0.6172548
	iters: 100, epoch: 2 | loss: 0.9467874
	speed: 0.0093s/iter; left time: 7.1056s
Updating learning rate to 0.00025421635989607337
Validation loss decreased (0.6173 --> 0.5938).  Saving model state dict ...
Epoch: 2 cost time: 0.7264728546142578
Epoch: 2, Steps: 123 | Train Loss: 0.9467874 Vali Loss: 0.5937871 Best vali loss: 0.5937871
	iters: 100, epoch: 3 | loss: 0.8467565
	speed: 0.0093s/iter; left time: 5.9159s
Updating learning rate to 0.00020590437161765966
Validation loss decreased (0.5938 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 0.7249939441680908
Epoch: 3, Steps: 123 | Train Loss: 0.8467565 Vali Loss: 0.5520784 Best vali loss: 0.5520784

best validation loss 0.5520783780019408

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0085423901193, 'e_layers': 1, 'learning_rate': 0.0001401146583, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8515415
	speed: 0.0088s/iter; left time: 33.8061s
	iters: 200, epoch: 1 | loss: 0.8050573
	speed: 0.0026s/iter; left time: 9.6736s
	iters: 300, epoch: 1 | loss: 2.2854750
	speed: 0.0025s/iter; left time: 9.1981s
	iters: 400, epoch: 1 | loss: 1.2888131
	speed: 0.0025s/iter; left time: 8.6829s
Updating learning rate to 0.00013478186165409136
Validation loss decreased (inf --> 0.6532).  Saving model state dict ...
Epoch: 1 cost time: 1.583153486251831
Epoch: 1, Steps: 490 | Train Loss: 1.3077217 Vali Loss: 0.6532282 Best vali loss: 0.6532282
	iters: 100, epoch: 2 | loss: 0.4270926
	speed: 0.0078s/iter; left time: 26.1428s
	iters: 200, epoch: 2 | loss: 0.4720018
	speed: 0.0025s/iter; left time: 8.2213s
	iters: 300, epoch: 2 | loss: 0.8229725
	speed: 0.0025s/iter; left time: 7.9577s
	iters: 400, epoch: 2 | loss: 0.8690893
	speed: 0.0026s/iter; left time: 7.8161s
Updating learning rate to 0.000119595341663783
Validation loss decreased (0.6532 --> 0.6242).  Saving model state dict ...
Epoch: 2 cost time: 1.2940666675567627
Epoch: 2, Steps: 490 | Train Loss: 0.6477890 Vali Loss: 0.6241660 Best vali loss: 0.6241660
	iters: 100, epoch: 3 | loss: 1.0184480
	speed: 0.0081s/iter; left time: 22.9574s
	iters: 200, epoch: 3 | loss: 0.9432436
	speed: 0.0026s/iter; left time: 7.0242s
	iters: 300, epoch: 3 | loss: 0.3562215
	speed: 0.0025s/iter; left time: 6.6554s
	iters: 400, epoch: 3 | loss: 0.4167876
	speed: 0.0024s/iter; left time: 6.1868s
Updating learning rate to 9.686710833145286e-05
Validation loss decreased (0.6242 --> 0.6116).  Saving model state dict ...
Epoch: 3 cost time: 1.284221887588501
Epoch: 3, Steps: 490 | Train Loss: 0.6836752 Vali Loss: 0.6115598 Best vali loss: 0.6115598

best validation loss 0.6115597697222249

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0106655673933, 'e_layers': 4, 'learning_rate': 0.000249129675, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.1141209375e-05
Epoch: 4 cost time: 1.3472373485565186
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5517157 Best vali loss: 0.5462454
Updating learning rate to 1.55706046875e-05
Validation loss decreased (0.5462 --> 0.5434).  Saving model state dict ...
Epoch: 5 cost time: 1.0056986808776855
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5434289 Best vali loss: 0.5434289
Updating learning rate to 7.78530234375e-06
Validation loss decreased (0.5434 --> 0.5401).  Saving model state dict ...
Epoch: 6 cost time: 1.0112700462341309
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5401452 Best vali loss: 0.5401452
Updating learning rate to 3.892651171875e-06
Validation loss decreased (0.5401 --> 0.5385).  Saving model state dict ...
Epoch: 7 cost time: 1.0140762329101562
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5384785 Best vali loss: 0.5384785
Updating learning rate to 1.9463255859375e-06
Epoch: 8 cost time: 1.0122129917144775
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5387497 Best vali loss: 0.5384785

best validation loss 0.5384785376285746

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0032832648739, 'e_layers': 2, 'learning_rate': 0.0035734327895, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1201414
	speed: 0.0097s/iter; left time: 75.0454s
	iters: 200, epoch: 1 | loss: 0.3139409
	speed: 0.0033s/iter; left time: 25.5013s
	iters: 300, epoch: 1 | loss: 0.4338813
	speed: 0.0036s/iter; left time: 26.8866s
	iters: 400, epoch: 1 | loss: 0.5943029
	speed: 0.0036s/iter; left time: 26.4397s
	iters: 500, epoch: 1 | loss: 0.9140556
	speed: 0.0035s/iter; left time: 25.5586s
	iters: 600, epoch: 1 | loss: 0.6448372
	speed: 0.0036s/iter; left time: 25.7995s
	iters: 700, epoch: 1 | loss: 0.4014771
	speed: 0.0034s/iter; left time: 24.5871s
	iters: 800, epoch: 1 | loss: 0.8502225
	speed: 0.0034s/iter; left time: 23.9406s
	iters: 900, epoch: 1 | loss: 0.8607988
	speed: 0.0036s/iter; left time: 25.0359s
Updating learning rate to 0.003437427102261882
Validation loss decreased (inf --> 0.6690).  Saving model state dict ...
Epoch: 1 cost time: 3.77306866645813
Epoch: 1, Steps: 979 | Train Loss: 0.6815175 Vali Loss: 0.6689745 Best vali loss: 0.6689745
	iters: 100, epoch: 2 | loss: 1.1998246
	speed: 0.0115s/iter; left time: 77.5402s
	iters: 200, epoch: 2 | loss: 1.4737062
	speed: 0.0034s/iter; left time: 22.7154s
	iters: 300, epoch: 2 | loss: 1.1119031
	speed: 0.0033s/iter; left time: 21.6638s
	iters: 400, epoch: 2 | loss: 0.7006634
	speed: 0.0035s/iter; left time: 22.8053s
	iters: 500, epoch: 2 | loss: 1.5031246
	speed: 0.0035s/iter; left time: 22.3865s
	iters: 600, epoch: 2 | loss: 0.6063067
	speed: 0.0034s/iter; left time: 21.4137s
	iters: 700, epoch: 2 | loss: 0.6073909
	speed: 0.0034s/iter; left time: 21.0593s
	iters: 800, epoch: 2 | loss: 0.5679042
	speed: 0.0034s/iter; left time: 20.6757s
	iters: 900, epoch: 2 | loss: 0.8586661
	speed: 0.0033s/iter; left time: 19.6281s
Updating learning rate to 0.0030501156735349053
Validation loss decreased (0.6690 --> 0.6429).  Saving model state dict ...
Epoch: 2 cost time: 3.3767690658569336
Epoch: 2, Steps: 979 | Train Loss: 0.9588322 Vali Loss: 0.6429008 Best vali loss: 0.6429008
	iters: 100, epoch: 3 | loss: 0.9511804
	speed: 0.0111s/iter; left time: 64.2303s
	iters: 200, epoch: 3 | loss: 0.5026227
	speed: 0.0032s/iter; left time: 18.2536s
	iters: 300, epoch: 3 | loss: 0.8492721
	speed: 0.0035s/iter; left time: 19.4450s
	iters: 400, epoch: 3 | loss: 0.7787924
	speed: 0.0036s/iter; left time: 19.9358s
	iters: 500, epoch: 3 | loss: 0.8699658
	speed: 0.0036s/iter; left time: 19.4526s
	iters: 600, epoch: 3 | loss: 1.7378255
	speed: 0.0036s/iter; left time: 19.1966s
	iters: 700, epoch: 3 | loss: 0.3994768
	speed: 0.0036s/iter; left time: 18.7106s
	iters: 800, epoch: 3 | loss: 0.4278833
	speed: 0.0034s/iter; left time: 17.0883s
	iters: 900, epoch: 3 | loss: 0.6244281
	speed: 0.0034s/iter; left time: 16.7738s
Updating learning rate to 0.002470463157355909
Epoch: 3 cost time: 3.425137996673584
Epoch: 3, Steps: 979 | Train Loss: 0.7934941 Vali Loss: 0.6564212 Best vali loss: 0.6429008
	iters: 100, epoch: 4 | loss: 0.6540868
	speed: 0.0111s/iter; left time: 53.3462s
	iters: 200, epoch: 4 | loss: 1.4093201
	speed: 0.0032s/iter; left time: 15.2424s
	iters: 300, epoch: 4 | loss: 0.6149163
	speed: 0.0033s/iter; left time: 15.3194s
	iters: 400, epoch: 4 | loss: 0.3794091
	speed: 0.0032s/iter; left time: 14.5147s
	iters: 500, epoch: 4 | loss: 1.2054663
	speed: 0.0032s/iter; left time: 14.1293s
	iters: 600, epoch: 4 | loss: 0.7767897
	speed: 0.0033s/iter; left time: 14.0432s
	iters: 700, epoch: 4 | loss: 0.8021410
	speed: 0.0032s/iter; left time: 13.6089s
	iters: 800, epoch: 4 | loss: 0.9879063
	speed: 0.0032s/iter; left time: 13.2379s
	iters: 900, epoch: 4 | loss: 0.4455094
	speed: 0.0034s/iter; left time: 13.4423s
Updating learning rate to 0.00178671639475
Validation loss decreased (0.6429 --> 0.6413).  Saving model state dict ...
Epoch: 4 cost time: 3.2497975826263428
Epoch: 4, Steps: 979 | Train Loss: 0.8083939 Vali Loss: 0.6413494 Best vali loss: 0.6413494
	iters: 100, epoch: 5 | loss: 1.6237375
	speed: 0.0121s/iter; left time: 46.2358s
	iters: 200, epoch: 5 | loss: 0.3790131
	speed: 0.0032s/iter; left time: 11.9362s
	iters: 300, epoch: 5 | loss: 0.8888161
	speed: 0.0034s/iter; left time: 12.1379s
	iters: 400, epoch: 5 | loss: 1.6092989
	speed: 0.0034s/iter; left time: 11.9468s
	iters: 500, epoch: 5 | loss: 0.2952290
	speed: 0.0033s/iter; left time: 11.3098s
	iters: 600, epoch: 5 | loss: 1.3868023
	speed: 0.0034s/iter; left time: 11.1210s
	iters: 700, epoch: 5 | loss: 0.5757868
	speed: 0.0034s/iter; left time: 10.8914s
	iters: 800, epoch: 5 | loss: 1.8639430
	speed: 0.0034s/iter; left time: 10.6175s
	iters: 900, epoch: 5 | loss: 0.2595215
	speed: 0.0033s/iter; left time: 10.0641s
Updating learning rate to 0.0011029696321440915
Epoch: 5 cost time: 3.344095230102539
Epoch: 5, Steps: 979 | Train Loss: 0.9869054 Vali Loss: 0.6451311 Best vali loss: 0.6413494
	iters: 100, epoch: 6 | loss: 0.7698495
	speed: 0.0114s/iter; left time: 32.2407s
	iters: 200, epoch: 6 | loss: 1.1385727
	speed: 0.0032s/iter; left time: 8.8397s
	iters: 300, epoch: 6 | loss: 0.9356183
	speed: 0.0033s/iter; left time: 8.6823s
	iters: 400, epoch: 6 | loss: 1.2180928
	speed: 0.0033s/iter; left time: 8.4850s
	iters: 500, epoch: 6 | loss: 1.9575436
	speed: 0.0032s/iter; left time: 7.7756s
	iters: 600, epoch: 6 | loss: 0.8254151
	speed: 0.0033s/iter; left time: 7.7528s
	iters: 700, epoch: 6 | loss: 0.9146118
	speed: 0.0034s/iter; left time: 7.6450s
	iters: 800, epoch: 6 | loss: 0.5825526
	speed: 0.0034s/iter; left time: 7.2600s
	iters: 900, epoch: 6 | loss: 1.0629904
	speed: 0.0034s/iter; left time: 6.9117s
Updating learning rate to 0.0005233171159650949
Epoch: 6 cost time: 3.2917771339416504
Epoch: 6, Steps: 979 | Train Loss: 1.0450274 Vali Loss: 0.6449992 Best vali loss: 0.6413494
	iters: 100, epoch: 7 | loss: 0.3085605
	speed: 0.0113s/iter; left time: 21.0845s
	iters: 200, epoch: 7 | loss: 1.5410124
	speed: 0.0033s/iter; left time: 5.8751s
	iters: 300, epoch: 7 | loss: 0.6088338
	speed: 0.0033s/iter; left time: 5.4310s
	iters: 400, epoch: 7 | loss: 0.7770779
	speed: 0.0032s/iter; left time: 4.9878s
	iters: 500, epoch: 7 | loss: 1.0635390
	speed: 0.0031s/iter; left time: 4.5574s
	iters: 600, epoch: 7 | loss: 1.8514258
	speed: 0.0032s/iter; left time: 4.4153s
	iters: 700, epoch: 7 | loss: 0.8257427
	speed: 0.0032s/iter; left time: 4.0481s
	iters: 800, epoch: 7 | loss: 1.2511988
	speed: 0.0031s/iter; left time: 3.6164s
	iters: 900, epoch: 7 | loss: 1.3338583
	speed: 0.0031s/iter; left time: 3.2695s
Updating learning rate to 0.00013600568723811835
Epoch: 7 cost time: 3.179499626159668
Epoch: 7, Steps: 979 | Train Loss: 1.0623610 Vali Loss: 0.6441092 Best vali loss: 0.6413494
	iters: 100, epoch: 8 | loss: 0.6403117
	speed: 0.0111s/iter; left time: 9.7760s
	iters: 200, epoch: 8 | loss: 0.7103442
	speed: 0.0035s/iter; left time: 2.7445s
	iters: 300, epoch: 8 | loss: 1.0286520
	speed: 0.0035s/iter; left time: 2.4009s
	iters: 400, epoch: 8 | loss: 0.8852469
	speed: 0.0035s/iter; left time: 2.0423s
	iters: 500, epoch: 8 | loss: 1.0325633
	speed: 0.0035s/iter; left time: 1.6824s
	iters: 600, epoch: 8 | loss: 0.9415156
	speed: 0.0033s/iter; left time: 1.2649s
	iters: 700, epoch: 8 | loss: 0.7825145
	speed: 0.0034s/iter; left time: 0.9382s
	iters: 800, epoch: 8 | loss: 0.9325279
	speed: 0.0033s/iter; left time: 0.5908s
	iters: 900, epoch: 8 | loss: 0.5558609
	speed: 0.0035s/iter; left time: 0.2765s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4007766246795654
Epoch: 8, Steps: 979 | Train Loss: 0.8343930 Vali Loss: 0.6435123 Best vali loss: 0.6413494

best validation loss 0.641349359995124

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0017645666364, 'e_layers': 4, 'learning_rate': 8.23281501e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.23281501e-05
Validation loss decreased (inf --> 0.7004).  Saving model state dict ...
Epoch: 1 cost time: 0.817878007888794
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7003684 Best vali loss: 0.7003684
Updating learning rate to 4.116407505e-05
Validation loss decreased (0.7004 --> 0.6866).  Saving model state dict ...
Epoch: 2 cost time: 0.5132856369018555
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6866388 Best vali loss: 0.6866388
Updating learning rate to 2.0582037525e-05
Validation loss decreased (0.6866 --> 0.6802).  Saving model state dict ...
Epoch: 3 cost time: 0.519716739654541
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6802359 Best vali loss: 0.6802359
Updating learning rate to 1.02910187625e-05
Validation loss decreased (0.6802 --> 0.6771).  Saving model state dict ...
Epoch: 4 cost time: 0.5193471908569336
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6770881 Best vali loss: 0.6770881
Updating learning rate to 5.14550938125e-06
Validation loss decreased (0.6771 --> 0.6756).  Saving model state dict ...
Epoch: 5 cost time: 0.5182795524597168
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6755625 Best vali loss: 0.6755625
Updating learning rate to 2.572754690625e-06
Validation loss decreased (0.6756 --> 0.6748).  Saving model state dict ...
Epoch: 6 cost time: 0.519218921661377
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6748207 Best vali loss: 0.6748207
Updating learning rate to 1.2863773453125e-06
Validation loss decreased (0.6748 --> 0.6744).  Saving model state dict ...
Epoch: 7 cost time: 0.5004651546478271
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6744469 Best vali loss: 0.6744469
Updating learning rate to 6.4318867265625e-07
Validation loss decreased (0.6744 --> 0.6743).  Saving model state dict ...
Epoch: 8 cost time: 0.4958310127258301
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6742575 Best vali loss: 0.6742575

best validation loss 0.6742574691717297

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9043654
	speed: 0.0120s/iter; left time: 10.6215s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6029).  Saving model state dict ...
Epoch: 1 cost time: 1.047956943511963
Epoch: 1, Steps: 123 | Train Loss: 0.9043654 Vali Loss: 0.6029427 Best vali loss: 0.6029427
	iters: 100, epoch: 2 | loss: 0.8267753
	speed: 0.0094s/iter; left time: 7.1260s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6029 --> 0.5990).  Saving model state dict ...
Epoch: 2 cost time: 0.7385296821594238
Epoch: 2, Steps: 123 | Train Loss: 0.8267753 Vali Loss: 0.5990159 Best vali loss: 0.5990159
	iters: 100, epoch: 3 | loss: 0.6596291
	speed: 0.0095s/iter; left time: 6.0662s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 0.7348651885986328
Epoch: 3, Steps: 123 | Train Loss: 0.6596291 Vali Loss: 0.6339314 Best vali loss: 0.5990159

best validation loss 0.5990158664247935

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8853170
	speed: 0.0119s/iter; left time: 10.5705s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 1.0355403423309326
Epoch: 1, Steps: 123 | Train Loss: 0.8853170 Vali Loss: 0.6032576 Best vali loss: 0.6032576
	iters: 100, epoch: 2 | loss: 0.7535180
	speed: 0.0093s/iter; left time: 7.0723s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6033 --> 0.5596).  Saving model state dict ...
Epoch: 2 cost time: 0.7318840026855469
Epoch: 2, Steps: 123 | Train Loss: 0.7535180 Vali Loss: 0.5596399 Best vali loss: 0.5596399
	iters: 100, epoch: 3 | loss: 0.6323516
	speed: 0.0095s/iter; left time: 6.1013s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5596 --> 0.5510).  Saving model state dict ...
Epoch: 3 cost time: 0.7383742332458496
Epoch: 3, Steps: 123 | Train Loss: 0.6323516 Vali Loss: 0.5510250 Best vali loss: 0.5510250

best validation loss 0.5510249511614159

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002978670278, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9043760
	speed: 0.0120s/iter; left time: 10.6491s
Updating learning rate to 0.0002865301390971952
Validation loss decreased (inf --> 0.6031).  Saving model state dict ...
Epoch: 1 cost time: 1.049330472946167
Epoch: 1, Steps: 123 | Train Loss: 0.9043760 Vali Loss: 0.6030949 Best vali loss: 0.6030949
	iters: 100, epoch: 2 | loss: 0.8259358
	speed: 0.0097s/iter; left time: 7.3679s
Updating learning rate to 0.0002542454115246309
Validation loss decreased (0.6031 --> 0.5997).  Saving model state dict ...
Epoch: 2 cost time: 0.7467634677886963
Epoch: 2, Steps: 123 | Train Loss: 0.8259358 Vali Loss: 0.5996555 Best vali loss: 0.5996555
	iters: 100, epoch: 3 | loss: 0.6681899
	speed: 0.0095s/iter; left time: 6.0760s
Updating learning rate to 0.0002059279021934458
Epoch: 3 cost time: 0.7389853000640869
Epoch: 3, Steps: 123 | Train Loss: 0.6681899 Vali Loss: 0.6346070 Best vali loss: 0.5996555

best validation loss 0.5996555073677197

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7572210
	speed: 0.0122s/iter; left time: 6.2734s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5510 --> 0.5503).  Saving model state dict ...
Epoch: 4 cost time: 1.039309024810791
Epoch: 4, Steps: 123 | Train Loss: 0.7572210 Vali Loss: 0.5502893 Best vali loss: 0.5502893
	iters: 100, epoch: 5 | loss: 0.6137043
	speed: 0.0097s/iter; left time: 3.8003s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5503 --> 0.5455).  Saving model state dict ...
Epoch: 5 cost time: 0.7386996746063232
Epoch: 5, Steps: 123 | Train Loss: 0.6137043 Vali Loss: 0.5454834 Best vali loss: 0.5454834
	iters: 100, epoch: 6 | loss: 0.5942359
	speed: 0.0096s/iter; left time: 2.5788s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.732607364654541
Epoch: 6, Steps: 123 | Train Loss: 0.5942359 Vali Loss: 0.5456273 Best vali loss: 0.5454834
	iters: 100, epoch: 7 | loss: 0.8596697
	speed: 0.0092s/iter; left time: 1.3568s
Updating learning rate to 6.692405488632598e-06
Validation loss decreased (0.5455 --> 0.5375).  Saving model state dict ...
Epoch: 7 cost time: 0.7412526607513428
Epoch: 7, Steps: 123 | Train Loss: 0.8596697 Vali Loss: 0.5375065 Best vali loss: 0.5375065
	iters: 100, epoch: 8 | loss: 0.7907815
	speed: 0.0097s/iter; left time: 0.2320s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7391972541809082
Epoch: 8, Steps: 123 | Train Loss: 0.7907815 Vali Loss: 0.5390338 Best vali loss: 0.5375065

best validation loss 0.5375064733347259

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0033757691473, 'e_layers': 2, 'learning_rate': 0.001273298678, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2264729
	speed: 0.0098s/iter; left time: 75.4007s
	iters: 200, epoch: 1 | loss: 1.4719183
	speed: 0.0036s/iter; left time: 27.6584s
	iters: 300, epoch: 1 | loss: 0.7307551
	speed: 0.0037s/iter; left time: 27.6161s
	iters: 400, epoch: 1 | loss: 0.8582049
	speed: 0.0036s/iter; left time: 26.9060s
	iters: 500, epoch: 1 | loss: 0.9689574
	speed: 0.0036s/iter; left time: 26.3166s
	iters: 600, epoch: 1 | loss: 1.3319985
	speed: 0.0037s/iter; left time: 26.7728s
	iters: 700, epoch: 1 | loss: 1.2444317
	speed: 0.0037s/iter; left time: 26.5909s
	iters: 800, epoch: 1 | loss: 1.8975476
	speed: 0.0037s/iter; left time: 25.7250s
	iters: 900, epoch: 1 | loss: 0.5831029
	speed: 0.0035s/iter; left time: 24.4842s
Updating learning rate to 0.0012248366326889398
Validation loss decreased (inf --> 0.6565).  Saving model state dict ...
Epoch: 1 cost time: 3.903332471847534
Epoch: 1, Steps: 979 | Train Loss: 1.1459322 Vali Loss: 0.6565431 Best vali loss: 0.6565431
	iters: 100, epoch: 2 | loss: 0.2808934
	speed: 0.0113s/iter; left time: 76.1801s
	iters: 200, epoch: 2 | loss: 0.7577348
	speed: 0.0034s/iter; left time: 22.6560s
	iters: 300, epoch: 2 | loss: 1.0351207
	speed: 0.0032s/iter; left time: 20.8006s
	iters: 400, epoch: 2 | loss: 1.0281423
	speed: 0.0032s/iter; left time: 20.3777s
	iters: 500, epoch: 2 | loss: 1.1001149
	speed: 0.0033s/iter; left time: 20.7191s
	iters: 600, epoch: 2 | loss: 0.4017408
	speed: 0.0031s/iter; left time: 19.4175s
	iters: 700, epoch: 2 | loss: 0.8161230
	speed: 0.0031s/iter; left time: 19.0534s
	iters: 800, epoch: 2 | loss: 0.7513870
	speed: 0.0031s/iter; left time: 18.9186s
	iters: 900, epoch: 2 | loss: 0.4775108
	speed: 0.0032s/iter; left time: 19.2116s
Updating learning rate to 0.0010868284038448332
Validation loss decreased (0.6565 --> 0.6402).  Saving model state dict ...
Epoch: 2 cost time: 3.1868910789489746
Epoch: 2, Steps: 979 | Train Loss: 0.7387520 Vali Loss: 0.6401559 Best vali loss: 0.6401559
	iters: 100, epoch: 3 | loss: 0.5052652
	speed: 0.0116s/iter; left time: 67.1489s
	iters: 200, epoch: 3 | loss: 2.1586797
	speed: 0.0031s/iter; left time: 17.6244s
	iters: 300, epoch: 3 | loss: 1.5293690
	speed: 0.0031s/iter; left time: 17.5328s
	iters: 400, epoch: 3 | loss: 1.1876047
	speed: 0.0032s/iter; left time: 17.6707s
	iters: 500, epoch: 3 | loss: 0.3205371
	speed: 0.0033s/iter; left time: 17.5809s
	iters: 600, epoch: 3 | loss: 0.2990446
	speed: 0.0033s/iter; left time: 17.3155s
	iters: 700, epoch: 3 | loss: 0.6805885
	speed: 0.0032s/iter; left time: 16.7365s
	iters: 800, epoch: 3 | loss: 1.0871758
	speed: 0.0032s/iter; left time: 16.4133s
	iters: 900, epoch: 3 | loss: 0.6983056
	speed: 0.0031s/iter; left time: 15.3906s
Updating learning rate to 0.0008802844932614858
Validation loss decreased (0.6402 --> 0.6391).  Saving model state dict ...
Epoch: 3 cost time: 3.2097911834716797
Epoch: 3, Steps: 979 | Train Loss: 0.9407300 Vali Loss: 0.6390655 Best vali loss: 0.6390655
	iters: 100, epoch: 4 | loss: 0.7114321
	speed: 0.0108s/iter; left time: 51.6428s
	iters: 200, epoch: 4 | loss: 0.5217946
	speed: 0.0032s/iter; left time: 15.0751s
	iters: 300, epoch: 4 | loss: 0.7959110
	speed: 0.0032s/iter; left time: 14.7378s
	iters: 400, epoch: 4 | loss: 1.2994673
	speed: 0.0030s/iter; left time: 13.4852s
	iters: 500, epoch: 4 | loss: 0.9277390
	speed: 0.0030s/iter; left time: 13.3957s
	iters: 600, epoch: 4 | loss: 0.3126292
	speed: 0.0030s/iter; left time: 12.8850s
	iters: 700, epoch: 4 | loss: 1.4497433
	speed: 0.0029s/iter; left time: 12.3150s
	iters: 800, epoch: 4 | loss: 0.6121653
	speed: 0.0031s/iter; left time: 12.5585s
	iters: 900, epoch: 4 | loss: 0.8894029
	speed: 0.0031s/iter; left time: 12.4459s
Updating learning rate to 0.000636649339
Epoch: 4 cost time: 3.062114953994751
Epoch: 4, Steps: 979 | Train Loss: 0.8355872 Vali Loss: 0.6430081 Best vali loss: 0.6390655
	iters: 100, epoch: 5 | loss: 1.1801965
	speed: 0.0114s/iter; left time: 43.4404s
	iters: 200, epoch: 5 | loss: 0.8600243
	speed: 0.0036s/iter; left time: 13.3434s
	iters: 300, epoch: 5 | loss: 0.9914278
	speed: 0.0035s/iter; left time: 12.5763s
	iters: 400, epoch: 5 | loss: 0.9591171
	speed: 0.0036s/iter; left time: 12.5705s
	iters: 500, epoch: 5 | loss: 1.1820632
	speed: 0.0034s/iter; left time: 11.5993s
	iters: 600, epoch: 5 | loss: 1.2150718
	speed: 0.0034s/iter; left time: 11.2536s
	iters: 700, epoch: 5 | loss: 0.6356539
	speed: 0.0034s/iter; left time: 10.9329s
	iters: 800, epoch: 5 | loss: 1.3342396
	speed: 0.0033s/iter; left time: 10.3749s
	iters: 900, epoch: 5 | loss: 0.9390976
	speed: 0.0033s/iter; left time: 9.9616s
Updating learning rate to 0.00039301418473851443
Epoch: 5 cost time: 3.4092423915863037
Epoch: 5, Steps: 979 | Train Loss: 1.0329880 Vali Loss: 0.6399998 Best vali loss: 0.6390655
	iters: 100, epoch: 6 | loss: 1.7818390
	speed: 0.0110s/iter; left time: 31.1933s
	iters: 200, epoch: 6 | loss: 1.5027624
	speed: 0.0032s/iter; left time: 8.6647s
	iters: 300, epoch: 6 | loss: 1.3668082
	speed: 0.0031s/iter; left time: 8.2981s
	iters: 400, epoch: 6 | loss: 0.5661672
	speed: 0.0030s/iter; left time: 7.6932s
	iters: 500, epoch: 6 | loss: 0.6986759
	speed: 0.0030s/iter; left time: 7.3724s
	iters: 600, epoch: 6 | loss: 0.9316863
	speed: 0.0030s/iter; left time: 7.0793s
	iters: 700, epoch: 6 | loss: 1.7402718
	speed: 0.0030s/iter; left time: 6.7753s
	iters: 800, epoch: 6 | loss: 1.2026852
	speed: 0.0032s/iter; left time: 6.7410s
	iters: 900, epoch: 6 | loss: 0.9397872
	speed: 0.0032s/iter; left time: 6.4406s
Updating learning rate to 0.00018647027415516693
Epoch: 6 cost time: 3.089921236038208
Epoch: 6, Steps: 979 | Train Loss: 1.1922982 Vali Loss: 0.6404399 Best vali loss: 0.6390655
	iters: 100, epoch: 7 | loss: 0.5000741
	speed: 0.0105s/iter; left time: 19.4857s
	iters: 200, epoch: 7 | loss: 1.1038408
	speed: 0.0030s/iter; left time: 5.2278s
	iters: 300, epoch: 7 | loss: 0.8569189
	speed: 0.0030s/iter; left time: 4.9589s
	iters: 400, epoch: 7 | loss: 0.8964466
	speed: 0.0030s/iter; left time: 4.7489s
	iters: 500, epoch: 7 | loss: 0.5450922
	speed: 0.0029s/iter; left time: 4.2479s
	iters: 600, epoch: 7 | loss: 0.9163005
	speed: 0.0029s/iter; left time: 3.9529s
	iters: 700, epoch: 7 | loss: 0.7058175
	speed: 0.0031s/iter; left time: 3.8549s
	iters: 800, epoch: 7 | loss: 0.9951135
	speed: 0.0030s/iter; left time: 3.5337s
	iters: 900, epoch: 7 | loss: 1.8567220
	speed: 0.0030s/iter; left time: 3.1785s
Updating learning rate to 4.846204531106029e-05
Epoch: 7 cost time: 2.9743223190307617
Epoch: 7, Steps: 979 | Train Loss: 0.9307029 Vali Loss: 0.6416815 Best vali loss: 0.6390655
	iters: 100, epoch: 8 | loss: 1.1282150
	speed: 0.0106s/iter; left time: 9.3099s
	iters: 200, epoch: 8 | loss: 1.3582269
	speed: 0.0031s/iter; left time: 2.4373s
	iters: 300, epoch: 8 | loss: 0.9010558
	speed: 0.0031s/iter; left time: 2.1192s
	iters: 400, epoch: 8 | loss: 1.3189830
	speed: 0.0031s/iter; left time: 1.7919s
	iters: 500, epoch: 8 | loss: 0.5262828
	speed: 0.0032s/iter; left time: 1.5335s
	iters: 600, epoch: 8 | loss: 0.9831180
	speed: 0.0030s/iter; left time: 1.1364s
	iters: 700, epoch: 8 | loss: 1.1862812
	speed: 0.0032s/iter; left time: 0.8951s
	iters: 800, epoch: 8 | loss: 0.5762448
	speed: 0.0030s/iter; left time: 0.5436s
	iters: 900, epoch: 8 | loss: 0.4643323
	speed: 0.0031s/iter; left time: 0.2446s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0729403495788574
Epoch: 8, Steps: 979 | Train Loss: 0.9380822 Vali Loss: 0.6460012 Best vali loss: 0.6390655

best validation loss 0.6390654926275776

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010670915121, 'e_layers': 2, 'learning_rate': 8.184057e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.184057e-05
Validation loss decreased (inf --> 0.7015).  Saving model state dict ...
Epoch: 1 cost time: 0.7366666793823242
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7014965 Best vali loss: 0.7014965
Updating learning rate to 4.0920285e-05
Validation loss decreased (0.7015 --> 0.6894).  Saving model state dict ...
Epoch: 2 cost time: 0.45947957038879395
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6893584 Best vali loss: 0.6893584
Updating learning rate to 2.04601425e-05
Validation loss decreased (0.6894 --> 0.6833).  Saving model state dict ...
Epoch: 3 cost time: 0.4246954917907715
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6833225 Best vali loss: 0.6833225
Updating learning rate to 1.023007125e-05
Validation loss decreased (0.6833 --> 0.6806).  Saving model state dict ...
Epoch: 4 cost time: 0.45012331008911133
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6805877 Best vali loss: 0.6805877
Updating learning rate to 5.115035625e-06
Validation loss decreased (0.6806 --> 0.6792).  Saving model state dict ...
Epoch: 5 cost time: 0.4314079284667969
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6792157 Best vali loss: 0.6792157
Updating learning rate to 2.5575178125e-06
Validation loss decreased (0.6792 --> 0.6785).  Saving model state dict ...
Epoch: 6 cost time: 0.3934159278869629
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6785360 Best vali loss: 0.6785360
Updating learning rate to 1.27875890625e-06
Validation loss decreased (0.6785 --> 0.6782).  Saving model state dict ...
Epoch: 7 cost time: 0.4262583255767822
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6781975 Best vali loss: 0.6781975
Updating learning rate to 6.39379453125e-07
Validation loss decreased (0.6782 --> 0.6780).  Saving model state dict ...
Epoch: 8 cost time: 0.40343403816223145
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6780274 Best vali loss: 0.6780274

best validation loss 0.6780273811180577

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010670878977, 'e_layers': 2, 'learning_rate': 8.27855117e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.27855117e-05
Validation loss decreased (inf --> 0.7013).  Saving model state dict ...
Epoch: 1 cost time: 0.7094511985778809
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7013431 Best vali loss: 0.7013431
Updating learning rate to 4.139275585e-05
Validation loss decreased (0.7013 --> 0.6891).  Saving model state dict ...
Epoch: 2 cost time: 0.4355432987213135
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6890895 Best vali loss: 0.6890895
Updating learning rate to 2.0696377925e-05
Validation loss decreased (0.6891 --> 0.6830).  Saving model state dict ...
Epoch: 3 cost time: 0.4158942699432373
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6829968 Best vali loss: 0.6829968

best validation loss 0.6829967803008464

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010665365602, 'e_layers': 2, 'learning_rate': 0.0004812188727, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004812188727
Validation loss decreased (inf --> 0.6531).  Saving model state dict ...
Epoch: 1 cost time: 0.7264304161071777
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6531129 Best vali loss: 0.6531129
Updating learning rate to 0.00024060943635
Validation loss decreased (0.6531 --> 0.6240).  Saving model state dict ...
Epoch: 2 cost time: 0.44041013717651367
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6239974 Best vali loss: 0.6239974
Updating learning rate to 0.000120304718175
Validation loss decreased (0.6240 --> 0.6188).  Saving model state dict ...
Epoch: 3 cost time: 0.4584372043609619
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6188239 Best vali loss: 0.6188239

best validation loss 0.6188238915719682

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010642143859, 'e_layers': 2, 'learning_rate': 0.0001181693442, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001181693442
Validation loss decreased (inf --> 0.6958).  Saving model state dict ...
Epoch: 1 cost time: 0.710418701171875
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6957959 Best vali loss: 0.6957959
Updating learning rate to 5.90846721e-05
Validation loss decreased (0.6958 --> 0.6794).  Saving model state dict ...
Epoch: 2 cost time: 0.4368555545806885
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6794420 Best vali loss: 0.6794420
Updating learning rate to 2.954233605e-05
Validation loss decreased (0.6794 --> 0.6714).  Saving model state dict ...
Epoch: 3 cost time: 0.46153736114501953
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6713661 Best vali loss: 0.6713661

best validation loss 0.6713660509980205

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010665365602, 'e_layers': 2, 'learning_rate': 0.0004812188727, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.01523590875e-05
Validation loss decreased (0.6188 --> 0.6160).  Saving model state dict ...
Epoch: 4 cost time: 0.7308239936828613
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6160323 Best vali loss: 0.6160323
Updating learning rate to 3.007617954375e-05
Validation loss decreased (0.6160 --> 0.6148).  Saving model state dict ...
Epoch: 5 cost time: 0.4648623466491699
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6148306 Best vali loss: 0.6148306
Updating learning rate to 1.5038089771875e-05
Validation loss decreased (0.6148 --> 0.6138).  Saving model state dict ...
Epoch: 6 cost time: 0.43266844749450684
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6137670 Best vali loss: 0.6137670
Updating learning rate to 7.5190448859375e-06
Validation loss decreased (0.6138 --> 0.6133).  Saving model state dict ...
Epoch: 7 cost time: 0.45197510719299316
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6133345 Best vali loss: 0.6133345
Updating learning rate to 3.75952244296875e-06
Validation loss decreased (0.6133 --> 0.6132).  Saving model state dict ...
Epoch: 8 cost time: 0.4633784294128418
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6132022 Best vali loss: 0.6132022

best validation loss 0.6132022384855825

[INFO][smbo.py:320] Finished 850 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0098256784052, 'e_layers': 2, 'learning_rate': 0.0001759025494, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7627205
	speed: 0.0119s/iter; left time: 10.5523s
Updating learning rate to 0.00016920765725360776
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.040773868560791
Epoch: 1, Steps: 123 | Train Loss: 0.7627205 Vali Loss: 0.6075619 Best vali loss: 0.6075619
	iters: 100, epoch: 2 | loss: 0.9385483
	speed: 0.0092s/iter; left time: 6.9927s
Updating learning rate to 0.0001501422174543708
Validation loss decreased (0.6076 --> 0.5699).  Saving model state dict ...
Epoch: 2 cost time: 0.7212789058685303
Epoch: 2, Steps: 123 | Train Loss: 0.9385483 Vali Loss: 0.5699497 Best vali loss: 0.5699497
	iters: 100, epoch: 3 | loss: 0.8646861
	speed: 0.0094s/iter; left time: 5.9844s
Updating learning rate to 0.00012160877038308089
Validation loss decreased (0.5699 --> 0.5552).  Saving model state dict ...
Epoch: 3 cost time: 0.7181622982025146
Epoch: 3, Steps: 123 | Train Loss: 0.8646861 Vali Loss: 0.5551744 Best vali loss: 0.5551744
	iters: 100, epoch: 4 | loss: 0.5073019
	speed: 0.0092s/iter; left time: 4.7346s
Updating learning rate to 8.79512747e-05
Epoch: 4 cost time: 0.7145516872406006
Epoch: 4, Steps: 123 | Train Loss: 0.5073019 Vali Loss: 0.5615775 Best vali loss: 0.5551744
	iters: 100, epoch: 5 | loss: 0.5737614
	speed: 0.0090s/iter; left time: 3.5356s
Updating learning rate to 5.429377901691912e-05
Validation loss decreased (0.5552 --> 0.5339).  Saving model state dict ...
Epoch: 5 cost time: 0.7219724655151367
Epoch: 5, Steps: 123 | Train Loss: 0.5737614 Vali Loss: 0.5338720 Best vali loss: 0.5338720
	iters: 100, epoch: 6 | loss: 0.6140343
	speed: 0.0092s/iter; left time: 2.4935s
Updating learning rate to 2.576033194562917e-05
Validation loss decreased (0.5339 --> 0.5310).  Saving model state dict ...
Epoch: 6 cost time: 0.7146439552307129
Epoch: 6, Steps: 123 | Train Loss: 0.6140343 Vali Loss: 0.5310331 Best vali loss: 0.5310331
	iters: 100, epoch: 7 | loss: 0.5764803
	speed: 0.0095s/iter; left time: 1.3960s
Updating learning rate to 6.694892146392239e-06
Validation loss decreased (0.5310 --> 0.5274).  Saving model state dict ...
Epoch: 7 cost time: 0.7318980693817139
Epoch: 7, Steps: 123 | Train Loss: 0.5764803 Vali Loss: 0.5274427 Best vali loss: 0.5274427
	iters: 100, epoch: 8 | loss: 0.7405187
	speed: 0.0093s/iter; left time: 0.2229s
Updating learning rate to 0.0
Validation loss decreased (0.5274 --> 0.5253).  Saving model state dict ...
Epoch: 8 cost time: 0.7219398021697998
Epoch: 8, Steps: 123 | Train Loss: 0.7405187 Vali Loss: 0.5253027 Best vali loss: 0.5253027

best validation loss 0.5253026908688498

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0003017851022, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7748303
	speed: 0.0117s/iter; left time: 10.3397s
Updating learning rate to 0.0003017851022
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0182991027832031
Epoch: 1, Steps: 123 | Train Loss: 0.7748303 Vali Loss: 0.6171458 Best vali loss: 0.6171458
	iters: 100, epoch: 2 | loss: 0.9438756
	speed: 0.0094s/iter; left time: 7.1480s
Updating learning rate to 0.0001508925511
Validation loss decreased (0.6171 --> 0.5698).  Saving model state dict ...
Epoch: 2 cost time: 0.7304043769836426
Epoch: 2, Steps: 123 | Train Loss: 0.9438756 Vali Loss: 0.5698010 Best vali loss: 0.5698010
	iters: 100, epoch: 3 | loss: 0.8507497
	speed: 0.0093s/iter; left time: 5.9615s
Updating learning rate to 7.544627555e-05
Validation loss decreased (0.5698 --> 0.5525).  Saving model state dict ...
Epoch: 3 cost time: 0.7221949100494385
Epoch: 3, Steps: 123 | Train Loss: 0.8507497 Vali Loss: 0.5524699 Best vali loss: 0.5524699
	iters: 100, epoch: 4 | loss: 0.4879887
	speed: 0.0093s/iter; left time: 4.7918s
Updating learning rate to 3.7723137775e-05
Validation loss decreased (0.5525 --> 0.5392).  Saving model state dict ...
Epoch: 4 cost time: 0.7257332801818848
Epoch: 4, Steps: 123 | Train Loss: 0.4879887 Vali Loss: 0.5392180 Best vali loss: 0.5392180
	iters: 100, epoch: 5 | loss: 0.5738295
	speed: 0.0093s/iter; left time: 3.6721s
Updating learning rate to 1.88615688875e-05
Validation loss decreased (0.5392 --> 0.5305).  Saving model state dict ...
Epoch: 5 cost time: 0.7243480682373047
Epoch: 5, Steps: 123 | Train Loss: 0.5738295 Vali Loss: 0.5305420 Best vali loss: 0.5305420
	iters: 100, epoch: 6 | loss: 0.6185805
	speed: 0.0093s/iter; left time: 2.5001s
Updating learning rate to 9.43078444375e-06
Validation loss decreased (0.5305 --> 0.5258).  Saving model state dict ...
Epoch: 6 cost time: 0.7262325286865234
Epoch: 6, Steps: 123 | Train Loss: 0.6185805 Vali Loss: 0.5258252 Best vali loss: 0.5258252
	iters: 100, epoch: 7 | loss: 0.5882508
	speed: 0.0094s/iter; left time: 1.3793s
Updating learning rate to 4.715392221875e-06
Epoch: 7 cost time: 0.7261061668395996
Epoch: 7, Steps: 123 | Train Loss: 0.5882508 Vali Loss: 0.5261543 Best vali loss: 0.5258252
	iters: 100, epoch: 8 | loss: 0.7440925
	speed: 0.0091s/iter; left time: 0.2189s
Updating learning rate to 2.3576961109375e-06
Validation loss decreased (0.5258 --> 0.5254).  Saving model state dict ...
Epoch: 8 cost time: 0.7223813533782959
Epoch: 8, Steps: 123 | Train Loss: 0.7440925 Vali Loss: 0.5253864 Best vali loss: 0.5253864

best validation loss 0.5253864355740422

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 3, 'learning_rate': 0.0003927140213, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6127753
	speed: 0.0133s/iter; left time: 11.7713s
Updating learning rate to 0.0003777672338546358
Validation loss decreased (inf --> 0.6162).  Saving model state dict ...
Epoch: 1 cost time: 1.3084502220153809
Epoch: 1, Steps: 123 | Train Loss: 0.6127753 Vali Loss: 0.6161596 Best vali loss: 0.6161596
	iters: 100, epoch: 2 | loss: 0.7864468
	speed: 0.0122s/iter; left time: 9.3257s
Updating learning rate to 0.00033520238441413414
Validation loss decreased (0.6162 --> 0.5641).  Saving model state dict ...
Epoch: 2 cost time: 0.998422384262085
Epoch: 2, Steps: 123 | Train Loss: 0.7864468 Vali Loss: 0.5641276 Best vali loss: 0.5641276
	iters: 100, epoch: 3 | loss: 0.6598476
	speed: 0.0124s/iter; left time: 7.9393s
Updating learning rate to 0.0002714995854544905
Validation loss decreased (0.5641 --> 0.5615).  Saving model state dict ...
Epoch: 3 cost time: 1.0011630058288574
Epoch: 3, Steps: 123 | Train Loss: 0.6598476 Vali Loss: 0.5615497 Best vali loss: 0.5615497

best validation loss 0.561549735587816

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043909912073, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616874
	speed: 0.0111s/iter; left time: 9.8528s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0354986190795898
Epoch: 1, Steps: 123 | Train Loss: 0.7616874 Vali Loss: 0.6075597 Best vali loss: 0.6075597
	iters: 100, epoch: 2 | loss: 0.9380960
	speed: 0.0092s/iter; left time: 7.0321s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5714).  Saving model state dict ...
Epoch: 2 cost time: 0.720867395401001
Epoch: 2, Steps: 123 | Train Loss: 0.9380960 Vali Loss: 0.5713563 Best vali loss: 0.5713563
	iters: 100, epoch: 3 | loss: 0.8587791
	speed: 0.0094s/iter; left time: 6.0220s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5714 --> 0.5454).  Saving model state dict ...
Epoch: 3 cost time: 0.7158148288726807
Epoch: 3, Steps: 123 | Train Loss: 0.8587791 Vali Loss: 0.5453953 Best vali loss: 0.5453953

best validation loss 0.5453953133695162

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001321226527, 'e_layers': 2, 'learning_rate': 0.0004711481159, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004711481159
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 0.7499253749847412
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5981821 Best vali loss: 0.5981821
Updating learning rate to 0.00023557405795
Validation loss decreased (0.5982 --> 0.5746).  Saving model state dict ...
Epoch: 2 cost time: 0.47405052185058594
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5745645 Best vali loss: 0.5745645
Updating learning rate to 0.000117787028975
Validation loss decreased (0.5746 --> 0.5674).  Saving model state dict ...
Epoch: 3 cost time: 0.4532597064971924
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5673644 Best vali loss: 0.5673644

best validation loss 0.5673643716613985

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043909912073, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5994968
	speed: 0.0121s/iter; left time: 6.2585s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5454 --> 0.5311).  Saving model state dict ...
Epoch: 4 cost time: 1.036407709121704
Epoch: 4, Steps: 123 | Train Loss: 0.5994968 Vali Loss: 0.5311358 Best vali loss: 0.5311358
	iters: 100, epoch: 5 | loss: 0.8469464
	speed: 0.0094s/iter; left time: 3.7049s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5311 --> 0.5271).  Saving model state dict ...
Epoch: 5 cost time: 0.7311203479766846
Epoch: 5, Steps: 123 | Train Loss: 0.8469464 Vali Loss: 0.5270941 Best vali loss: 0.5270941
	iters: 100, epoch: 6 | loss: 0.8000396
	speed: 0.0093s/iter; left time: 2.5178s
Updating learning rate to 2.5750763885692906e-05
Epoch: 6 cost time: 0.7236051559448242
Epoch: 6, Steps: 123 | Train Loss: 0.8000396 Vali Loss: 0.5279144 Best vali loss: 0.5270941
	iters: 100, epoch: 7 | loss: 0.4798005
	speed: 0.0089s/iter; left time: 1.3124s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.7136156558990479
Epoch: 7, Steps: 123 | Train Loss: 0.4798005 Vali Loss: 0.5283535 Best vali loss: 0.5270941
	iters: 100, epoch: 8 | loss: 0.5523482
	speed: 0.0090s/iter; left time: 0.2160s
Updating learning rate to 0.0
Validation loss decreased (0.5271 --> 0.5250).  Saving model state dict ...
Epoch: 8 cost time: 0.7204220294952393
Epoch: 8, Steps: 123 | Train Loss: 0.5523482 Vali Loss: 0.5250489 Best vali loss: 0.5250489

best validation loss 0.5250488553318586

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0101024862735, 'e_layers': 2, 'learning_rate': 0.000471438815, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000471438815
Validation loss decreased (inf --> 0.5978).  Saving model state dict ...
Epoch: 1 cost time: 0.7435696125030518
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5978078 Best vali loss: 0.5978078
Updating learning rate to 0.0002357194075
Validation loss decreased (0.5978 --> 0.5709).  Saving model state dict ...
Epoch: 2 cost time: 0.46919965744018555
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5708552 Best vali loss: 0.5708552
Updating learning rate to 0.00011785970375
Epoch: 3 cost time: 0.4579043388366699
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5747849 Best vali loss: 0.5708552
Updating learning rate to 5.8929851875e-05
Validation loss decreased (0.5709 --> 0.5494).  Saving model state dict ...
Epoch: 4 cost time: 0.4589540958404541
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5493827 Best vali loss: 0.5493827
Updating learning rate to 2.94649259375e-05
Validation loss decreased (0.5494 --> 0.5461).  Saving model state dict ...
Epoch: 5 cost time: 0.45744967460632324
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5460900 Best vali loss: 0.5460900
Updating learning rate to 1.473246296875e-05
Validation loss decreased (0.5461 --> 0.5360).  Saving model state dict ...
Epoch: 6 cost time: 0.449415922164917
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5360444 Best vali loss: 0.5360444
Updating learning rate to 7.366231484375e-06
Epoch: 7 cost time: 0.4551234245300293
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5383778 Best vali loss: 0.5360444
Updating learning rate to 3.6831157421875e-06
Validation loss decreased (0.5360 --> 0.5353).  Saving model state dict ...
Epoch: 8 cost time: 0.4519798755645752
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5353433 Best vali loss: 0.5353433

best validation loss 0.5353433205429352

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0089691600634, 'e_layers': 2, 'learning_rate': 0.0004721110912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004721110912
Validation loss decreased (inf --> 0.5995).  Saving model state dict ...
Epoch: 1 cost time: 0.7532351016998291
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5995402 Best vali loss: 0.5995402
Updating learning rate to 0.0002360555456
Validation loss decreased (0.5995 --> 0.5666).  Saving model state dict ...
Epoch: 2 cost time: 0.4577150344848633
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5665675 Best vali loss: 0.5665675
Updating learning rate to 0.0001180277728
Epoch: 3 cost time: 0.4538264274597168
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5686032 Best vali loss: 0.5665675
Updating learning rate to 5.90138864e-05
Validation loss decreased (0.5666 --> 0.5530).  Saving model state dict ...
Epoch: 4 cost time: 0.44791412353515625
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5529677 Best vali loss: 0.5529677
Updating learning rate to 2.95069432e-05
Validation loss decreased (0.5530 --> 0.5523).  Saving model state dict ...
Epoch: 5 cost time: 0.45803022384643555
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5522567 Best vali loss: 0.5522567
Updating learning rate to 1.47534716e-05
Validation loss decreased (0.5523 --> 0.5414).  Saving model state dict ...
Epoch: 6 cost time: 0.45095157623291016
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5413858 Best vali loss: 0.5413858
Updating learning rate to 7.3767358e-06
Epoch: 7 cost time: 0.45227599143981934
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5440920 Best vali loss: 0.5413858
Updating learning rate to 3.6883679e-06
Validation loss decreased (0.5414 --> 0.5404).  Saving model state dict ...
Epoch: 8 cost time: 0.46569061279296875
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5404203 Best vali loss: 0.5404203

best validation loss 0.5404202724319539

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0086596745584, 'e_layers': 2, 'learning_rate': 0.0004722505698, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004722505698
Validation loss decreased (inf --> 0.6001).  Saving model state dict ...
Epoch: 1 cost time: 0.7332842350006104
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6000801 Best vali loss: 0.6000801
Updating learning rate to 0.0002361252849
Validation loss decreased (0.6001 --> 0.5552).  Saving model state dict ...
Epoch: 2 cost time: 0.4702916145324707
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5551545 Best vali loss: 0.5551545
Updating learning rate to 0.00011806264245
Epoch: 3 cost time: 0.46761202812194824
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5649063 Best vali loss: 0.5551545

best validation loss 0.5551545063912013

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.006716844918, 'e_layers': 2, 'learning_rate': 0.0004719863439, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004719863439
Validation loss decreased (inf --> 0.5977).  Saving model state dict ...
Epoch: 1 cost time: 0.7737710475921631
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5976633 Best vali loss: 0.5976633
Updating learning rate to 0.00023599317195
Validation loss decreased (0.5977 --> 0.5689).  Saving model state dict ...
Epoch: 2 cost time: 0.6413311958312988
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5689276 Best vali loss: 0.5689276
Updating learning rate to 0.000117996585975
Validation loss decreased (0.5689 --> 0.5672).  Saving model state dict ...
Epoch: 3 cost time: 0.4706721305847168
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5672321 Best vali loss: 0.5672321

best validation loss 0.5672321224146449

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0052339965762, 'e_layers': 2, 'learning_rate': 0.0004707864872, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004707864872
Validation loss decreased (inf --> 0.5992).  Saving model state dict ...
Epoch: 1 cost time: 0.754279613494873
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5991960 Best vali loss: 0.5991960
Updating learning rate to 0.0002353932436
Validation loss decreased (0.5992 --> 0.5745).  Saving model state dict ...
Epoch: 2 cost time: 0.45943403244018555
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5745074 Best vali loss: 0.5745074
Updating learning rate to 0.0001176966218
Validation loss decreased (0.5745 --> 0.5662).  Saving model state dict ...
Epoch: 3 cost time: 0.46542787551879883
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5661882 Best vali loss: 0.5661882

best validation loss 0.5661881725747295

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0086596745584, 'e_layers': 2, 'learning_rate': 0.0004722505698, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.9031321225e-05
Validation loss decreased (0.5552 --> 0.5512).  Saving model state dict ...
Epoch: 4 cost time: 0.7422018051147461
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5511792 Best vali loss: 0.5511792
Updating learning rate to 2.95156606125e-05
Validation loss decreased (0.5512 --> 0.5501).  Saving model state dict ...
Epoch: 5 cost time: 0.46038150787353516
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5500896 Best vali loss: 0.5500896
Updating learning rate to 1.475783030625e-05
Validation loss decreased (0.5501 --> 0.5490).  Saving model state dict ...
Epoch: 6 cost time: 0.457444429397583
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5489875 Best vali loss: 0.5489875
Updating learning rate to 7.378915153125e-06
Validation loss decreased (0.5490 --> 0.5466).  Saving model state dict ...
Epoch: 7 cost time: 0.4555790424346924
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5466319 Best vali loss: 0.5466319
Updating learning rate to 3.6894575765625e-06
Epoch: 8 cost time: 0.4518623352050781
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5473403 Best vali loss: 0.5466319

best validation loss 0.5466319278730721

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011407392847, 'e_layers': 2, 'learning_rate': 0.0004617007765, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004617007765
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 0.7527971267700195
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5976467 Best vali loss: 0.5976467
Updating learning rate to 0.00023085038825
Validation loss decreased (0.5976 --> 0.5721).  Saving model state dict ...
Epoch: 2 cost time: 0.4596383571624756
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5721028 Best vali loss: 0.5721028
Updating learning rate to 0.000115425194125
Validation loss decreased (0.5721 --> 0.5639).  Saving model state dict ...
Epoch: 3 cost time: 0.4642598628997803
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5639172 Best vali loss: 0.5639172
Updating learning rate to 5.77125970625e-05
Validation loss decreased (0.5639 --> 0.5458).  Saving model state dict ...
Epoch: 4 cost time: 0.46953606605529785
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5458177 Best vali loss: 0.5458177
Updating learning rate to 2.885629853125e-05
Epoch: 5 cost time: 0.47123026847839355
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5460259 Best vali loss: 0.5458177
Updating learning rate to 1.4428149265625e-05
Validation loss decreased (0.5458 --> 0.5406).  Saving model state dict ...
Epoch: 6 cost time: 0.4609568119049072
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5405791 Best vali loss: 0.5405791
Updating learning rate to 7.2140746328125e-06
Epoch: 7 cost time: 0.4568955898284912
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5440882 Best vali loss: 0.5405791
Updating learning rate to 3.60703731640625e-06
Validation loss decreased (0.5406 --> 0.5397).  Saving model state dict ...
Epoch: 8 cost time: 0.4658472537994385
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5397388 Best vali loss: 0.5397388

best validation loss 0.5397387600673232

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012458782223, 'e_layers': 2, 'learning_rate': 0.0004814975106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6235843
	speed: 0.0103s/iter; left time: 19.1993s
	iters: 200, epoch: 1 | loss: 0.7835956
	speed: 0.0036s/iter; left time: 6.2604s
Updating learning rate to 0.00046317160279923817
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.290381908416748
Epoch: 1, Steps: 245 | Train Loss: 0.7035900 Vali Loss: 0.6170976 Best vali loss: 0.6170976
	iters: 100, epoch: 2 | loss: 1.0179120
	speed: 0.0081s/iter; left time: 13.1535s
	iters: 200, epoch: 2 | loss: 0.7161016
	speed: 0.0041s/iter; left time: 6.1794s
Updating learning rate to 0.00041098383273485077
Validation loss decreased (0.6171 --> 0.5952).  Saving model state dict ...
Epoch: 2 cost time: 1.0319175720214844
Epoch: 2, Steps: 245 | Train Loss: 0.8670068 Vali Loss: 0.5951944 Best vali loss: 0.5951944
	iters: 100, epoch: 3 | loss: 0.7388264
	speed: 0.0081s/iter; left time: 11.0618s
	iters: 200, epoch: 3 | loss: 0.6236622
	speed: 0.0038s/iter; left time: 4.7816s
Updating learning rate to 0.0003328793153158271
Validation loss decreased (0.5952 --> 0.5714).  Saving model state dict ...
Epoch: 3 cost time: 0.9727888107299805
Epoch: 3, Steps: 245 | Train Loss: 0.6812443 Vali Loss: 0.5713748 Best vali loss: 0.5713748
	iters: 100, epoch: 4 | loss: 0.8589405
	speed: 0.0082s/iter; left time: 9.2883s
	iters: 200, epoch: 4 | loss: 0.7427341
	speed: 0.0041s/iter; left time: 4.2436s
Updating learning rate to 0.0002407487553
Validation loss decreased (0.5714 --> 0.5689).  Saving model state dict ...
Epoch: 4 cost time: 1.0524089336395264
Epoch: 4, Steps: 245 | Train Loss: 0.8008373 Vali Loss: 0.5688789 Best vali loss: 0.5688789
	iters: 100, epoch: 5 | loss: 0.7837058
	speed: 0.0083s/iter; left time: 7.2684s
	iters: 200, epoch: 5 | loss: 0.8527511
	speed: 0.0037s/iter; left time: 2.9116s
Updating learning rate to 0.0001486181952841729
Validation loss decreased (0.5689 --> 0.5619).  Saving model state dict ...
Epoch: 5 cost time: 0.9724197387695312
Epoch: 5, Steps: 245 | Train Loss: 0.8182285 Vali Loss: 0.5619143 Best vali loss: 0.5619143
	iters: 100, epoch: 6 | loss: 0.8784106
	speed: 0.0080s/iter; left time: 5.0688s
	iters: 200, epoch: 6 | loss: 0.6348400
	speed: 0.0037s/iter; left time: 2.0055s
Updating learning rate to 7.051367786514925e-05
Validation loss decreased (0.5619 --> 0.5615).  Saving model state dict ...
Epoch: 6 cost time: 0.9707260131835938
Epoch: 6, Steps: 245 | Train Loss: 0.7566253 Vali Loss: 0.5614592 Best vali loss: 0.5614592
	iters: 100, epoch: 7 | loss: 0.6391395
	speed: 0.0078s/iter; left time: 3.0557s
	iters: 200, epoch: 7 | loss: 0.4635845
	speed: 0.0036s/iter; left time: 1.0469s
Updating learning rate to 1.8325907800761834e-05
Validation loss decreased (0.5615 --> 0.5522).  Saving model state dict ...
Epoch: 7 cost time: 0.9234280586242676
Epoch: 7, Steps: 245 | Train Loss: 0.5513620 Vali Loss: 0.5521636 Best vali loss: 0.5521636
	iters: 100, epoch: 8 | loss: 0.4659458
	speed: 0.0082s/iter; left time: 1.2031s
	iters: 200, epoch: 8 | loss: 0.9383464
	speed: 0.0039s/iter; left time: 0.1790s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0216917991638184
Epoch: 8, Steps: 245 | Train Loss: 0.7021461 Vali Loss: 0.5554473 Best vali loss: 0.5521636

best validation loss 0.5521635586936294

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758379018, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616863
	speed: 0.0119s/iter; left time: 10.5231s
Updating learning rate to 0.00016914547015637476
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0469152927398682
Epoch: 1, Steps: 123 | Train Loss: 0.7616863 Vali Loss: 0.6075503 Best vali loss: 0.6075503
	iters: 100, epoch: 2 | loss: 0.9371526
	speed: 0.0092s/iter; left time: 7.0471s
Updating learning rate to 0.0001500870372761971
Validation loss decreased (0.6076 --> 0.5718).  Saving model state dict ...
Epoch: 2 cost time: 0.7242810726165771
Epoch: 2, Steps: 123 | Train Loss: 0.9371526 Vali Loss: 0.5717975 Best vali loss: 0.5717975
	iters: 100, epoch: 3 | loss: 0.8550514
	speed: 0.0095s/iter; left time: 6.0420s
Updating learning rate to 0.0001215640768003498
Validation loss decreased (0.5718 --> 0.5401).  Saving model state dict ...
Epoch: 3 cost time: 0.7237615585327148
Epoch: 3, Steps: 123 | Train Loss: 0.8550514 Vali Loss: 0.5401322 Best vali loss: 0.5401322

best validation loss 0.5401322363924506

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010632218108, 'e_layers': 3, 'learning_rate': 0.00029811417, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00029811417
Validation loss decreased (inf --> 0.6091).  Saving model state dict ...
Epoch: 1 cost time: 1.0944855213165283
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6090776 Best vali loss: 0.6090776
Updating learning rate to 0.000149057085
Validation loss decreased (0.6091 --> 0.5739).  Saving model state dict ...
Epoch: 2 cost time: 0.7980000972747803
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5738802 Best vali loss: 0.5738802
Updating learning rate to 7.45285425e-05
Validation loss decreased (0.5739 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 0.7954599857330322
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5464176 Best vali loss: 0.5464176

best validation loss 0.5464175734625873

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010646885529, 'e_layers': 3, 'learning_rate': 0.0002769043587, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002769043587
Validation loss decreased (inf --> 0.6083).  Saving model state dict ...
Epoch: 1 cost time: 1.0949420928955078
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6082850 Best vali loss: 0.6082850
Updating learning rate to 0.00013845217935
Validation loss decreased (0.6083 --> 0.5590).  Saving model state dict ...
Epoch: 2 cost time: 0.8029694557189941
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5589945 Best vali loss: 0.5589945
Updating learning rate to 6.9226089675e-05
Validation loss decreased (0.5590 --> 0.5435).  Saving model state dict ...
Epoch: 3 cost time: 0.8017559051513672
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5434658 Best vali loss: 0.5434658

best validation loss 0.5434658024279071

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758379018, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6054441
	speed: 0.0121s/iter; left time: 6.2535s
Updating learning rate to 8.79189509e-05
Validation loss decreased (0.5401 --> 0.5349).  Saving model state dict ...
Epoch: 4 cost time: 1.0279972553253174
Epoch: 4, Steps: 123 | Train Loss: 0.6054441 Vali Loss: 0.5349145 Best vali loss: 0.5349145
	iters: 100, epoch: 5 | loss: 0.8474638
	speed: 0.0096s/iter; left time: 3.7533s
Updating learning rate to 5.4273824999650206e-05
Validation loss decreased (0.5349 --> 0.5285).  Saving model state dict ...
Epoch: 5 cost time: 0.725062370300293
Epoch: 5, Steps: 123 | Train Loss: 0.8474638 Vali Loss: 0.5284731 Best vali loss: 0.5284731
	iters: 100, epoch: 6 | loss: 0.7989091
	speed: 0.0094s/iter; left time: 2.5368s
Updating learning rate to 2.575086452380289e-05
Epoch: 6 cost time: 0.7312684059143066
Epoch: 6, Steps: 123 | Train Loss: 0.7989091 Vali Loss: 0.5289793 Best vali loss: 0.5284731
	iters: 100, epoch: 7 | loss: 0.4780607
	speed: 0.0092s/iter; left time: 1.3462s
Updating learning rate to 6.692431643625227e-06
Epoch: 7 cost time: 0.7217922210693359
Epoch: 7, Steps: 123 | Train Loss: 0.4780607 Vali Loss: 0.5296452 Best vali loss: 0.5284731
	iters: 100, epoch: 8 | loss: 0.5524477
	speed: 0.0091s/iter; left time: 0.2174s
Updating learning rate to 0.0
Validation loss decreased (0.5285 --> 0.5252).  Saving model state dict ...
Epoch: 8 cost time: 0.7176134586334229
Epoch: 8, Steps: 123 | Train Loss: 0.5524477 Vali Loss: 0.5251931 Best vali loss: 0.5251931

best validation loss 0.5251931412139462

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010662366314, 'e_layers': 3, 'learning_rate': 0.0002607858289, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002607858289
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.1014444828033447
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6075710 Best vali loss: 0.6075710
Updating learning rate to 0.00013039291445
Validation loss decreased (0.6076 --> 0.5652).  Saving model state dict ...
Epoch: 2 cost time: 0.7999234199523926
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5652104 Best vali loss: 0.5652104
Updating learning rate to 6.5196457225e-05
Validation loss decreased (0.5652 --> 0.5469).  Saving model state dict ...
Epoch: 3 cost time: 0.8061835765838623
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5468641 Best vali loss: 0.5468641
Updating learning rate to 3.25982286125e-05
Epoch: 4 cost time: 0.8034029006958008
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5531604 Best vali loss: 0.5468641
Updating learning rate to 1.629911430625e-05
Epoch: 5 cost time: 0.8056325912475586
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5494904 Best vali loss: 0.5468641
Updating learning rate to 8.149557153125e-06
Epoch: 6 cost time: 0.8003659248352051
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5504233 Best vali loss: 0.5468641
Updating learning rate to 4.0747785765625e-06
Validation loss decreased (0.5469 --> 0.5459).  Saving model state dict ...
Epoch: 7 cost time: 0.7982921600341797
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5458756 Best vali loss: 0.5458756
Updating learning rate to 2.03738928828125e-06
Epoch: 8 cost time: 0.8019962310791016
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5467593 Best vali loss: 0.5458756

best validation loss 0.5458755814218235

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020571620121, 'e_layers': 3, 'learning_rate': 0.0027296385159, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9802905
	speed: 0.0110s/iter; left time: 41.9208s
	iters: 200, epoch: 1 | loss: 0.9094002
	speed: 0.0042s/iter; left time: 15.6852s
	iters: 300, epoch: 1 | loss: 1.0810163
	speed: 0.0043s/iter; left time: 15.4593s
	iters: 400, epoch: 1 | loss: 0.8945985
	speed: 0.0042s/iter; left time: 14.8092s
Updating learning rate to 0.0026257478359472475
Validation loss decreased (inf --> 0.6631).  Saving model state dict ...
Epoch: 1 cost time: 2.457263708114624
Epoch: 1, Steps: 490 | Train Loss: 0.9663264 Vali Loss: 0.6630694 Best vali loss: 0.6630694
	iters: 100, epoch: 2 | loss: 0.6475750
	speed: 0.0120s/iter; left time: 39.9359s
	iters: 200, epoch: 2 | loss: 1.2481683
	speed: 0.0047s/iter; left time: 15.0705s
	iters: 300, epoch: 2 | loss: 1.2517353
	speed: 0.0046s/iter; left time: 14.4384s
	iters: 400, epoch: 2 | loss: 0.7730535
	speed: 0.0046s/iter; left time: 14.0780s
Updating learning rate to 0.002329892210340437
Validation loss decreased (0.6631 --> 0.6475).  Saving model state dict ...
Epoch: 2 cost time: 2.3071649074554443
Epoch: 2, Steps: 490 | Train Loss: 0.9801330 Vali Loss: 0.6475425 Best vali loss: 0.6475425
	iters: 100, epoch: 3 | loss: 1.3536638
	speed: 0.0126s/iter; left time: 35.8315s
	iters: 200, epoch: 3 | loss: 1.1915504
	speed: 0.0046s/iter; left time: 12.5166s
	iters: 300, epoch: 3 | loss: 1.2764922
	speed: 0.0046s/iter; left time: 12.1674s
	iters: 400, epoch: 3 | loss: 0.9349128
	speed: 0.0045s/iter; left time: 11.4522s
Updating learning rate to 0.001887112976140281
Validation loss decreased (0.6475 --> 0.6457).  Saving model state dict ...
Epoch: 3 cost time: 2.2758212089538574
Epoch: 3, Steps: 490 | Train Loss: 1.1891548 Vali Loss: 0.6456868 Best vali loss: 0.6456868
	iters: 100, epoch: 4 | loss: 0.8968291
	speed: 0.0115s/iter; left time: 27.1477s
	iters: 200, epoch: 4 | loss: 0.8616568
	speed: 0.0040s/iter; left time: 9.0851s
	iters: 300, epoch: 4 | loss: 0.4532042
	speed: 0.0039s/iter; left time: 8.4577s
	iters: 400, epoch: 4 | loss: 0.5986859
	speed: 0.0038s/iter; left time: 7.7897s
Updating learning rate to 0.00136481925795
Validation loss decreased (0.6457 --> 0.6350).  Saving model state dict ...
Epoch: 4 cost time: 1.9681057929992676
Epoch: 4, Steps: 490 | Train Loss: 0.7025940 Vali Loss: 0.6349739 Best vali loss: 0.6349739
	iters: 100, epoch: 5 | loss: 0.6648840
	speed: 0.0113s/iter; left time: 21.0965s
	iters: 200, epoch: 5 | loss: 0.6149426
	speed: 0.0042s/iter; left time: 7.4343s
	iters: 300, epoch: 5 | loss: 0.4474253
	speed: 0.0043s/iter; left time: 7.1041s
	iters: 400, epoch: 5 | loss: 0.4943287
	speed: 0.0043s/iter; left time: 6.7027s
Updating learning rate to 0.0008425255397597192
Epoch: 5 cost time: 2.1708028316497803
Epoch: 5, Steps: 490 | Train Loss: 0.5553951 Vali Loss: 0.6417032 Best vali loss: 0.6349739
	iters: 100, epoch: 6 | loss: 0.6727007
	speed: 0.0115s/iter; left time: 15.7983s
	iters: 200, epoch: 6 | loss: 0.8330255
	speed: 0.0042s/iter; left time: 5.3169s
	iters: 300, epoch: 6 | loss: 0.6284520
	speed: 0.0045s/iter; left time: 5.2684s
	iters: 400, epoch: 6 | loss: 1.2447519
	speed: 0.0045s/iter; left time: 4.8189s
Updating learning rate to 0.0003997463055595633
Epoch: 6 cost time: 2.1539697647094727
Epoch: 6, Steps: 490 | Train Loss: 0.8447325 Vali Loss: 0.6409970 Best vali loss: 0.6349739
	iters: 100, epoch: 7 | loss: 0.4780146
	speed: 0.0124s/iter; left time: 10.9067s
	iters: 200, epoch: 7 | loss: 0.8182649
	speed: 0.0044s/iter; left time: 3.4608s
	iters: 300, epoch: 7 | loss: 0.6836250
	speed: 0.0045s/iter; left time: 3.0677s
	iters: 400, epoch: 7 | loss: 1.3691331
	speed: 0.0046s/iter; left time: 2.6895s
Updating learning rate to 0.00010389067995275274
Validation loss decreased (0.6350 --> 0.6313).  Saving model state dict ...
Epoch: 7 cost time: 2.288156032562256
Epoch: 7, Steps: 490 | Train Loss: 0.8372594 Vali Loss: 0.6313271 Best vali loss: 0.6313271
	iters: 100, epoch: 8 | loss: 0.6145311
	speed: 0.0121s/iter; left time: 4.7343s
	iters: 200, epoch: 8 | loss: 0.5031563
	speed: 0.0041s/iter; left time: 1.1793s
	iters: 300, epoch: 8 | loss: 1.1025490
	speed: 0.0040s/iter; left time: 0.7646s
	iters: 400, epoch: 8 | loss: 0.9244207
	speed: 0.0040s/iter; left time: 0.3617s
Updating learning rate to 0.0
Validation loss decreased (0.6313 --> 0.6293).  Saving model state dict ...
Epoch: 8 cost time: 2.0123274326324463
Epoch: 8, Steps: 490 | Train Loss: 0.7861643 Vali Loss: 0.6293104 Best vali loss: 0.6293104

best validation loss 0.6293104415356919

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.001061895744, 'e_layers': 3, 'learning_rate': 0.0004225709173, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004225709173
Validation loss decreased (inf --> 0.6092).  Saving model state dict ...
Epoch: 1 cost time: 1.1111564636230469
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6092041 Best vali loss: 0.6092041
Updating learning rate to 0.00021128545865
Validation loss decreased (0.6092 --> 0.5685).  Saving model state dict ...
Epoch: 2 cost time: 0.7981770038604736
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5684794 Best vali loss: 0.5684794
Updating learning rate to 0.000105642729325
Validation loss decreased (0.5685 --> 0.5429).  Saving model state dict ...
Epoch: 3 cost time: 0.7987167835235596
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5429187 Best vali loss: 0.5429187

best validation loss 0.5429186698795744

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 2, 'learning_rate': 0.0002978074948, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744592
	speed: 0.0115s/iter; left time: 10.1870s
Updating learning rate to 0.00028647287193709074
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.018427848815918
Epoch: 1, Steps: 123 | Train Loss: 0.7744592 Vali Loss: 0.6172967 Best vali loss: 0.6172967
	iters: 100, epoch: 2 | loss: 0.9509270
	speed: 0.0091s/iter; left time: 6.9673s
Updating learning rate to 0.00025419459693062875
Validation loss decreased (0.6173 --> 0.5727).  Saving model state dict ...
Epoch: 2 cost time: 0.7169811725616455
Epoch: 2, Steps: 123 | Train Loss: 0.9509270 Vali Loss: 0.5726851 Best vali loss: 0.5726851
	iters: 100, epoch: 3 | loss: 0.8479736
	speed: 0.0093s/iter; left time: 5.9744s
Updating learning rate to 0.00020588674454705632
Validation loss decreased (0.5727 --> 0.5527).  Saving model state dict ...
Epoch: 3 cost time: 0.7238626480102539
Epoch: 3, Steps: 123 | Train Loss: 0.8479736 Vali Loss: 0.5526774 Best vali loss: 0.5526774

best validation loss 0.5526773571030291

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0091244500092, 'e_layers': 4, 'learning_rate': 0.0002982034403, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002868537476588107
Validation loss decreased (inf --> 0.6147).  Saving model state dict ...
Epoch: 1 cost time: 1.2973856925964355
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6147493 Best vali loss: 0.6147493
Updating learning rate to 0.00025453255755464386
Epoch: 2 cost time: 1.0063281059265137
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6310742 Best vali loss: 0.6147493
Updating learning rate to 0.00020616047818854108
Epoch: 3 cost time: 1.0003728866577148
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6653841 Best vali loss: 0.6147493

best validation loss 0.6147492751099897

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.001061895744, 'e_layers': 3, 'learning_rate': 0.0004225709173, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.28213646625e-05
Epoch: 4 cost time: 1.105818271636963
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5483111 Best vali loss: 0.5429187
Updating learning rate to 2.641068233125e-05
Epoch: 5 cost time: 0.7937097549438477
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5508322 Best vali loss: 0.5429187
Updating learning rate to 1.3205341165625e-05
Epoch: 6 cost time: 0.7992653846740723
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5478481 Best vali loss: 0.5429187
Updating learning rate to 6.6026705828125e-06
Epoch: 7 cost time: 0.8066365718841553
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5445453 Best vali loss: 0.5429187
Updating learning rate to 3.30133529140625e-06
Epoch: 8 cost time: 0.7971615791320801
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5472754 Best vali loss: 0.5429187

best validation loss 0.5429186698795744

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0102900350234, 'e_layers': 4, 'learning_rate': 0.000298986314, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00028760682500279637
Validation loss decreased (inf --> 0.6148).  Saving model state dict ...
Epoch: 1 cost time: 1.3026230335235596
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6148211 Best vali loss: 0.6148211
Updating learning rate to 0.00025520078205568515
Validation loss decreased (0.6148 --> 0.5799).  Saving model state dict ...
Epoch: 2 cost time: 1.0063867568969727
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5798888 Best vali loss: 0.5798888
Updating learning rate to 0.00020670171143585326
Validation loss decreased (0.5799 --> 0.5456).  Saving model state dict ...
Epoch: 3 cost time: 0.9996335506439209
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5455763 Best vali loss: 0.5455763
Updating learning rate to 0.000149493157
Validation loss decreased (0.5456 --> 0.5401).  Saving model state dict ...
Epoch: 4 cost time: 0.9983766078948975
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5401161 Best vali loss: 0.5401161
Updating learning rate to 9.228460256414676e-05
Epoch: 5 cost time: 1.002094030380249
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5453994 Best vali loss: 0.5401161
Updating learning rate to 4.378553194431481e-05
Epoch: 6 cost time: 1.00193452835083
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5746738 Best vali loss: 0.5401161
Updating learning rate to 1.1379488997203607e-05
Epoch: 7 cost time: 0.9998815059661865
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5637388 Best vali loss: 0.5401161
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0046968460083008
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5618118 Best vali loss: 0.5401161

best validation loss 0.5401161117776573

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016367640994, 'e_layers': 3, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8056852
	speed: 0.0118s/iter; left time: 10.4103s
Updating learning rate to 0.00028649739841911696
Validation loss decreased (inf --> 0.6105).  Saving model state dict ...
Epoch: 1 cost time: 1.0475478172302246
Epoch: 1, Steps: 123 | Train Loss: 0.8056852 Vali Loss: 0.6105189 Best vali loss: 0.6105189
	iters: 100, epoch: 2 | loss: 0.9399238
	speed: 0.0093s/iter; left time: 7.0853s
Updating learning rate to 0.00025421635989607337
Validation loss decreased (0.6105 --> 0.5522).  Saving model state dict ...
Epoch: 2 cost time: 0.7473709583282471
Epoch: 2, Steps: 123 | Train Loss: 0.9399238 Vali Loss: 0.5521926 Best vali loss: 0.5521926
	iters: 100, epoch: 3 | loss: 0.7664816
	speed: 0.0095s/iter; left time: 6.0499s
Updating learning rate to 0.00020590437161765966
Epoch: 3 cost time: 0.7537777423858643
Epoch: 3, Steps: 123 | Train Loss: 0.7664816 Vali Loss: 0.5585491 Best vali loss: 0.5521926
	iters: 100, epoch: 4 | loss: 0.5350435
	speed: 0.0092s/iter; left time: 4.7234s
Updating learning rate to 0.00014891649585
Epoch: 4 cost time: 0.745006799697876
Epoch: 4, Steps: 123 | Train Loss: 0.5350435 Vali Loss: 0.5668157 Best vali loss: 0.5521926
	iters: 100, epoch: 5 | loss: 0.8394173
	speed: 0.0091s/iter; left time: 3.5609s
Updating learning rate to 9.192862008234036e-05
Validation loss decreased (0.5522 --> 0.5347).  Saving model state dict ...
Epoch: 5 cost time: 0.7283241748809814
Epoch: 5, Steps: 123 | Train Loss: 0.8394173 Vali Loss: 0.5346564 Best vali loss: 0.5346564
	iters: 100, epoch: 6 | loss: 0.6897215
	speed: 0.0093s/iter; left time: 2.5100s
Updating learning rate to 4.3616631803926644e-05
Validation loss decreased (0.5347 --> 0.5306).  Saving model state dict ...
Epoch: 6 cost time: 0.7431273460388184
Epoch: 6, Steps: 123 | Train Loss: 0.6897215 Vali Loss: 0.5306358 Best vali loss: 0.5306358
	iters: 100, epoch: 7 | loss: 0.7743469
	speed: 0.0092s/iter; left time: 1.3546s
Updating learning rate to 1.1335593280883028e-05
Epoch: 7 cost time: 0.7271475791931152
Epoch: 7, Steps: 123 | Train Loss: 0.7743469 Vali Loss: 0.5387567 Best vali loss: 0.5306358
	iters: 100, epoch: 8 | loss: 0.8789331
	speed: 0.0089s/iter; left time: 0.2136s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7262790203094482
Epoch: 8, Steps: 123 | Train Loss: 0.8789331 Vali Loss: 0.5368167 Best vali loss: 0.5306358

best validation loss 0.5306357822998538

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0014155549695, 'e_layers': 2, 'learning_rate': 5.9557712e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.9557712e-05
Validation loss decreased (inf --> 0.6857).  Saving model state dict ...
Epoch: 1 cost time: 0.7303342819213867
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6856590 Best vali loss: 0.6856590
Updating learning rate to 2.9778856e-05
Validation loss decreased (0.6857 --> 0.6625).  Saving model state dict ...
Epoch: 2 cost time: 0.4476447105407715
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6625000 Best vali loss: 0.6625000
Updating learning rate to 1.4889428e-05
Validation loss decreased (0.6625 --> 0.6531).  Saving model state dict ...
Epoch: 3 cost time: 0.43769264221191406
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6530750 Best vali loss: 0.6530750

best validation loss 0.6530750007168223

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0056973676267, 'e_layers': 2, 'learning_rate': 0.0002984524327, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028709326334986615
Validation loss decreased (inf --> 0.5980).  Saving model state dict ...
Epoch: 1 cost time: 0.7466914653778076
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5980145 Best vali loss: 0.5980145
Updating learning rate to 0.00025474508586189584
Validation loss decreased (0.5980 --> 0.5871).  Saving model state dict ...
Epoch: 2 cost time: 0.4640390872955322
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5871285 Best vali loss: 0.5871285
Updating learning rate to 0.0002063326170216735
Validation loss decreased (0.5871 --> 0.5571).  Saving model state dict ...
Epoch: 3 cost time: 0.46306800842285156
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5570506 Best vali loss: 0.5570506

best validation loss 0.5570505904632826

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0037736907283, 'e_layers': 2, 'learning_rate': 0.0004198606236, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004038806301257327
Validation loss decreased (inf --> 0.5966).  Saving model state dict ...
Epoch: 1 cost time: 0.7479770183563232
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5965879 Best vali loss: 0.5965879
Updating learning rate to 0.0003583734588503863
Validation loss decreased (0.5966 --> 0.5910).  Saving model state dict ...
Epoch: 2 cost time: 0.45925283432006836
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5910326 Best vali loss: 0.5910326
Updating learning rate to 0.00029026716407709753
Validation loss decreased (0.5910 --> 0.5527).  Saving model state dict ...
Epoch: 3 cost time: 0.4652242660522461
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5526844 Best vali loss: 0.5526844

best validation loss 0.5526843799423807

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0037736907283, 'e_layers': 2, 'learning_rate': 0.0004198606236, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002099303118
Validation loss decreased (0.5527 --> 0.5480).  Saving model state dict ...
Epoch: 4 cost time: 0.741753101348877
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5480470 Best vali loss: 0.5480470
Updating learning rate to 0.0001295934595229025
Epoch: 5 cost time: 0.46103358268737793
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5487311 Best vali loss: 0.5480470
Updating learning rate to 6.148716474961372e-05
Validation loss decreased (0.5480 --> 0.5364).  Saving model state dict ...
Epoch: 6 cost time: 0.45920252799987793
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5363821 Best vali loss: 0.5363821
Updating learning rate to 1.5979993474267337e-05
Epoch: 7 cost time: 0.46828556060791016
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5370968 Best vali loss: 0.5363821
Updating learning rate to 0.0
Validation loss decreased (0.5364 --> 0.5359).  Saving model state dict ...
Epoch: 8 cost time: 0.46573615074157715
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5359482 Best vali loss: 0.5359482

best validation loss 0.5359481649506925

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047059415471, 'e_layers': 2, 'learning_rate': 0.0003056897302, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002940551076153387
Validation loss decreased (inf --> 0.5978).  Saving model state dict ...
Epoch: 1 cost time: 0.7472660541534424
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5978385 Best vali loss: 0.5978385
Updating learning rate to 0.00026092250568175306
Validation loss decreased (0.5978 --> 0.5739).  Saving model state dict ...
Epoch: 2 cost time: 0.4592463970184326
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5738531 Best vali loss: 0.5738531
Updating learning rate to 0.00021133606269584714
Validation loss decreased (0.5739 --> 0.5604).  Saving model state dict ...
Epoch: 3 cost time: 0.4553337097167969
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5604466 Best vali loss: 0.5604466
Updating learning rate to 0.0001528448651
Validation loss decreased (0.5604 --> 0.5542).  Saving model state dict ...
Epoch: 4 cost time: 0.4592018127441406
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5542403 Best vali loss: 0.5542403
Updating learning rate to 9.435366750415289e-05
Epoch: 5 cost time: 0.4540414810180664
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5574985 Best vali loss: 0.5542403
Updating learning rate to 4.476722451824694e-05
Validation loss decreased (0.5542 --> 0.5494).  Saving model state dict ...
Epoch: 6 cost time: 0.4573354721069336
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5494082 Best vali loss: 0.5494082
Updating learning rate to 1.1634622584661314e-05
Validation loss decreased (0.5494 --> 0.5464).  Saving model state dict ...
Epoch: 7 cost time: 0.46430063247680664
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5463950 Best vali loss: 0.5463950
Updating learning rate to 0.0
Validation loss decreased (0.5464 --> 0.5405).  Saving model state dict ...
Epoch: 8 cost time: 0.46427106857299805
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5405004 Best vali loss: 0.5405004

best validation loss 0.540500442582333

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001772685364, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7618903
	speed: 0.0123s/iter; left time: 10.8642s
Updating learning rate to 0.000170521654469096
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.028855562210083
Epoch: 1, Steps: 123 | Train Loss: 0.7618903 Vali Loss: 0.6077367 Best vali loss: 0.6077367
	iters: 100, epoch: 2 | loss: 0.9378654
	speed: 0.0092s/iter; left time: 6.9777s
Updating learning rate to 0.00015130816028972717
Validation loss decreased (0.6077 --> 0.5782).  Saving model state dict ...
Epoch: 2 cost time: 0.7222321033477783
Epoch: 2, Steps: 123 | Train Loss: 0.9378654 Vali Loss: 0.5781946 Best vali loss: 0.5781946
	iters: 100, epoch: 3 | loss: 0.8541994
	speed: 0.0093s/iter; left time: 5.9121s
Updating learning rate to 0.00012255313417994395
Validation loss decreased (0.5782 --> 0.5433).  Saving model state dict ...
Epoch: 3 cost time: 0.721606969833374
Epoch: 3, Steps: 123 | Train Loss: 0.8541994 Vali Loss: 0.5432621 Best vali loss: 0.5432621
	iters: 100, epoch: 4 | loss: 0.4981365
	speed: 0.0095s/iter; left time: 4.9150s
Updating learning rate to 8.86342682e-05
Epoch: 4 cost time: 0.7244770526885986
Epoch: 4, Steps: 123 | Train Loss: 0.4981365 Vali Loss: 0.5462289 Best vali loss: 0.5432621
	iters: 100, epoch: 5 | loss: 0.5748205
	speed: 0.0091s/iter; left time: 3.5624s
Updating learning rate to 5.4715402220056077e-05
Validation loss decreased (0.5433 --> 0.5350).  Saving model state dict ...
Epoch: 5 cost time: 0.722907543182373
Epoch: 5, Steps: 123 | Train Loss: 0.5748205 Vali Loss: 0.5349701 Best vali loss: 0.5349701
	iters: 100, epoch: 6 | loss: 0.6241424
	speed: 0.0094s/iter; left time: 2.5322s
Updating learning rate to 2.5960376110272838e-05
Validation loss decreased (0.5350 --> 0.5329).  Saving model state dict ...
Epoch: 6 cost time: 0.7258081436157227
Epoch: 6, Steps: 123 | Train Loss: 0.6241424 Vali Loss: 0.5329107 Best vali loss: 0.5329107
	iters: 100, epoch: 7 | loss: 0.5817327
	speed: 0.0095s/iter; left time: 1.3912s
Updating learning rate to 6.746881930903992e-06
Validation loss decreased (0.5329 --> 0.5301).  Saving model state dict ...
Epoch: 7 cost time: 0.7217986583709717
Epoch: 7, Steps: 123 | Train Loss: 0.5817327 Vali Loss: 0.5301107 Best vali loss: 0.5301107
	iters: 100, epoch: 8 | loss: 0.7432654
	speed: 0.0093s/iter; left time: 0.2226s
Updating learning rate to 0.0
Validation loss decreased (0.5301 --> 0.5287).  Saving model state dict ...
Epoch: 8 cost time: 0.7225651741027832
Epoch: 8, Steps: 123 | Train Loss: 0.7432654 Vali Loss: 0.5286652 Best vali loss: 0.5286652

best validation loss 0.5286651769483162

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008436095614, 'e_layers': 3, 'learning_rate': 0.0014370549788, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9394063
	speed: 0.0105s/iter; left time: 40.3021s
	iters: 200, epoch: 1 | loss: 0.6335037
	speed: 0.0042s/iter; left time: 15.6424s
	iters: 300, epoch: 1 | loss: 1.2808590
	speed: 0.0042s/iter; left time: 15.3342s
	iters: 400, epoch: 1 | loss: 0.5467494
	speed: 0.0044s/iter; left time: 15.5921s
Updating learning rate to 0.0014370549788
Validation loss decreased (inf --> 0.6180).  Saving model state dict ...
Epoch: 1 cost time: 2.4829907417297363
Epoch: 1, Steps: 490 | Train Loss: 0.8501296 Vali Loss: 0.6179928 Best vali loss: 0.6179928
	iters: 100, epoch: 2 | loss: 0.6382622
	speed: 0.0120s/iter; left time: 40.1215s
	iters: 200, epoch: 2 | loss: 0.8999488
	speed: 0.0044s/iter; left time: 14.1636s
	iters: 300, epoch: 2 | loss: 0.9354099
	speed: 0.0045s/iter; left time: 14.0846s
	iters: 400, epoch: 2 | loss: 0.7704961
	speed: 0.0045s/iter; left time: 13.5870s
Updating learning rate to 0.0007185274894
Epoch: 2 cost time: 2.2067465782165527
Epoch: 2, Steps: 490 | Train Loss: 0.8110293 Vali Loss: 0.6407581 Best vali loss: 0.6179928
	iters: 100, epoch: 3 | loss: 0.7558459
	speed: 0.0116s/iter; left time: 32.9715s
	iters: 200, epoch: 3 | loss: 1.0444379
	speed: 0.0043s/iter; left time: 11.8536s
	iters: 300, epoch: 3 | loss: 0.5050721
	speed: 0.0044s/iter; left time: 11.5034s
	iters: 400, epoch: 3 | loss: 0.8018678
	speed: 0.0043s/iter; left time: 10.9391s
Updating learning rate to 0.0003592637447
Validation loss decreased (0.6180 --> 0.6060).  Saving model state dict ...
Epoch: 3 cost time: 2.1617610454559326
Epoch: 3, Steps: 490 | Train Loss: 0.7768059 Vali Loss: 0.6059772 Best vali loss: 0.6059772

best validation loss 0.6059772039883008

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0010867939746, 'e_layers': 4, 'learning_rate': 0.0001642416202, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4500403
	speed: 0.0112s/iter; left time: 86.5911s
	iters: 200, epoch: 1 | loss: 1.0454464
	speed: 0.0050s/iter; left time: 38.0254s
	iters: 300, epoch: 1 | loss: 0.8734232
	speed: 0.0050s/iter; left time: 37.9702s
	iters: 400, epoch: 1 | loss: 0.5378233
	speed: 0.0051s/iter; left time: 37.8805s
	iters: 500, epoch: 1 | loss: 0.8308048
	speed: 0.0053s/iter; left time: 38.6361s
	iters: 600, epoch: 1 | loss: 0.5655971
	speed: 0.0052s/iter; left time: 37.6794s
	iters: 700, epoch: 1 | loss: 0.9348176
	speed: 0.0052s/iter; left time: 37.0594s
	iters: 800, epoch: 1 | loss: 0.5098939
	speed: 0.0053s/iter; left time: 37.2472s
	iters: 900, epoch: 1 | loss: 0.8131344
	speed: 0.0053s/iter; left time: 36.5922s
Updating learning rate to 0.0001642416202
Validation loss decreased (inf --> 0.6108).  Saving model state dict ...
Epoch: 1 cost time: 5.4102623462677
Epoch: 1, Steps: 979 | Train Loss: 0.7289979 Vali Loss: 0.6107728 Best vali loss: 0.6107728
	iters: 100, epoch: 2 | loss: 0.9492559
	speed: 0.0158s/iter; left time: 106.7830s
	iters: 200, epoch: 2 | loss: 0.3058268
	speed: 0.0053s/iter; left time: 35.1367s
	iters: 300, epoch: 2 | loss: 1.9436450
	speed: 0.0051s/iter; left time: 33.1241s
	iters: 400, epoch: 2 | loss: 1.1495496
	speed: 0.0048s/iter; left time: 30.7293s
	iters: 500, epoch: 2 | loss: 1.0097092
	speed: 0.0047s/iter; left time: 30.1214s
	iters: 600, epoch: 2 | loss: 0.5266093
	speed: 0.0048s/iter; left time: 30.2286s
	iters: 700, epoch: 2 | loss: 0.4074155
	speed: 0.0047s/iter; left time: 29.0232s
	iters: 800, epoch: 2 | loss: 0.8732767
	speed: 0.0047s/iter; left time: 28.5204s
	iters: 900, epoch: 2 | loss: 0.8473715
	speed: 0.0047s/iter; left time: 27.8870s
Updating learning rate to 8.21208101e-05
Validation loss decreased (0.6108 --> 0.6061).  Saving model state dict ...
Epoch: 2 cost time: 4.8248560428619385
Epoch: 2, Steps: 979 | Train Loss: 0.8902955 Vali Loss: 0.6060560 Best vali loss: 0.6060560
	iters: 100, epoch: 3 | loss: 1.8585504
	speed: 0.0152s/iter; left time: 87.6613s
	iters: 200, epoch: 3 | loss: 1.4119509
	speed: 0.0051s/iter; left time: 29.0216s
	iters: 300, epoch: 3 | loss: 0.9395543
	speed: 0.0044s/iter; left time: 24.4752s
	iters: 400, epoch: 3 | loss: 0.5994229
	speed: 0.0044s/iter; left time: 24.0287s
	iters: 500, epoch: 3 | loss: 0.9758600
	speed: 0.0045s/iter; left time: 24.1708s
	iters: 600, epoch: 3 | loss: 0.7645372
	speed: 0.0047s/iter; left time: 24.9490s
	iters: 700, epoch: 3 | loss: 0.7789612
	speed: 0.0047s/iter; left time: 24.2577s
	iters: 800, epoch: 3 | loss: 1.0724542
	speed: 0.0048s/iter; left time: 24.2824s
	iters: 900, epoch: 3 | loss: 0.4265271
	speed: 0.0047s/iter; left time: 23.5923s
Updating learning rate to 4.106040505e-05
Validation loss decreased (0.6061 --> 0.6021).  Saving model state dict ...
Epoch: 3 cost time: 4.652301788330078
Epoch: 3, Steps: 979 | Train Loss: 0.9808687 Vali Loss: 0.6020770 Best vali loss: 0.6020770

best validation loss 0.6020769748986733

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0090064644795, 'e_layers': 3, 'learning_rate': 0.0012380235145, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8742976
	speed: 0.0116s/iter; left time: 21.4989s
	iters: 200, epoch: 1 | loss: 0.9248072
	speed: 0.0053s/iter; left time: 9.3432s
Updating learning rate to 0.0012380235145
Validation loss decreased (inf --> 0.6619).  Saving model state dict ...
Epoch: 1 cost time: 1.6465444564819336
Epoch: 1, Steps: 245 | Train Loss: 0.8995524 Vali Loss: 0.6619382 Best vali loss: 0.6619382
	iters: 100, epoch: 2 | loss: 0.9799662
	speed: 0.0108s/iter; left time: 17.4161s
	iters: 200, epoch: 2 | loss: 0.9041437
	speed: 0.0053s/iter; left time: 8.0105s
Updating learning rate to 0.00061901175725
Validation loss decreased (0.6619 --> 0.6557).  Saving model state dict ...
Epoch: 2 cost time: 1.338571548461914
Epoch: 2, Steps: 245 | Train Loss: 0.9420549 Vali Loss: 0.6556779 Best vali loss: 0.6556779
	iters: 100, epoch: 3 | loss: 1.0396488
	speed: 0.0113s/iter; left time: 15.5161s
	iters: 200, epoch: 3 | loss: 0.9862696
	speed: 0.0055s/iter; left time: 6.9862s
Updating learning rate to 0.000309505878625
Validation loss decreased (0.6557 --> 0.6312).  Saving model state dict ...
Epoch: 3 cost time: 1.393157720565796
Epoch: 3, Steps: 245 | Train Loss: 1.0129592 Vali Loss: 0.6311942 Best vali loss: 0.6311942

best validation loss 0.6311942284331173

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0010867939746, 'e_layers': 4, 'learning_rate': 0.0001642416202, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4191951
	speed: 0.0112s/iter; left time: 53.6852s
	iters: 200, epoch: 4 | loss: 0.9283276
	speed: 0.0050s/iter; left time: 23.5028s
	iters: 300, epoch: 4 | loss: 0.8092814
	speed: 0.0050s/iter; left time: 23.1492s
	iters: 400, epoch: 4 | loss: 0.5378667
	speed: 0.0052s/iter; left time: 23.4016s
	iters: 500, epoch: 4 | loss: 0.8269120
	speed: 0.0052s/iter; left time: 22.6986s
	iters: 600, epoch: 4 | loss: 0.5749268
	speed: 0.0048s/iter; left time: 20.6548s
	iters: 700, epoch: 4 | loss: 0.9143720
	speed: 0.0048s/iter; left time: 20.2306s
	iters: 800, epoch: 4 | loss: 0.4473500
	speed: 0.0048s/iter; left time: 19.7640s
	iters: 900, epoch: 4 | loss: 0.7235959
	speed: 0.0048s/iter; left time: 19.3039s
Updating learning rate to 2.0530202525e-05
Validation loss decreased (0.6021 --> 0.6012).  Saving model state dict ...
Epoch: 4 cost time: 5.189899206161499
Epoch: 4, Steps: 979 | Train Loss: 0.6868697 Vali Loss: 0.6012392 Best vali loss: 0.6012392
	iters: 100, epoch: 5 | loss: 0.9297625
	speed: 0.0151s/iter; left time: 57.6260s
	iters: 200, epoch: 5 | loss: 0.2826779
	speed: 0.0049s/iter; left time: 18.2492s
	iters: 300, epoch: 5 | loss: 1.7691306
	speed: 0.0047s/iter; left time: 16.8680s
	iters: 400, epoch: 5 | loss: 1.1540557
	speed: 0.0048s/iter; left time: 16.8305s
	iters: 500, epoch: 5 | loss: 0.9791605
	speed: 0.0048s/iter; left time: 16.2915s
	iters: 600, epoch: 5 | loss: 0.4548488
	speed: 0.0047s/iter; left time: 15.5060s
	iters: 700, epoch: 5 | loss: 0.3986276
	speed: 0.0048s/iter; left time: 15.5685s
	iters: 800, epoch: 5 | loss: 0.8836086
	speed: 0.0048s/iter; left time: 15.0194s
	iters: 900, epoch: 5 | loss: 0.8517318
	speed: 0.0048s/iter; left time: 14.6093s
Updating learning rate to 1.02651012625e-05
Validation loss decreased (0.6012 --> 0.5996).  Saving model state dict ...
Epoch: 5 cost time: 4.720721244812012
Epoch: 5, Steps: 979 | Train Loss: 0.8559560 Vali Loss: 0.5995796 Best vali loss: 0.5995796
	iters: 100, epoch: 6 | loss: 1.6941925
	speed: 0.0150s/iter; left time: 42.5128s
	iters: 200, epoch: 6 | loss: 1.3296529
	speed: 0.0045s/iter; left time: 12.2562s
	iters: 300, epoch: 6 | loss: 0.7592371
	speed: 0.0044s/iter; left time: 11.5926s
	iters: 400, epoch: 6 | loss: 0.5976468
	speed: 0.0044s/iter; left time: 11.1749s
	iters: 500, epoch: 6 | loss: 0.9443870
	speed: 0.0044s/iter; left time: 10.7346s
	iters: 600, epoch: 6 | loss: 0.7526531
	speed: 0.0044s/iter; left time: 10.3492s
	iters: 700, epoch: 6 | loss: 0.6950135
	speed: 0.0044s/iter; left time: 9.9096s
	iters: 800, epoch: 6 | loss: 1.0547357
	speed: 0.0044s/iter; left time: 9.4491s
	iters: 900, epoch: 6 | loss: 0.4161846
	speed: 0.0044s/iter; left time: 9.0281s
Updating learning rate to 5.13255063125e-06
Epoch: 6 cost time: 4.391159772872925
Epoch: 6, Steps: 979 | Train Loss: 0.9159670 Vali Loss: 0.6001247 Best vali loss: 0.5995796
	iters: 100, epoch: 7 | loss: 1.1359324
	speed: 0.0151s/iter; left time: 28.0661s
	iters: 200, epoch: 7 | loss: 1.2577125
	speed: 0.0052s/iter; left time: 9.1246s
	iters: 300, epoch: 7 | loss: 0.3977292
	speed: 0.0052s/iter; left time: 8.5627s
	iters: 400, epoch: 7 | loss: 0.9274385
	speed: 0.0052s/iter; left time: 8.0785s
	iters: 500, epoch: 7 | loss: 0.6096328
	speed: 0.0053s/iter; left time: 7.7058s
	iters: 600, epoch: 7 | loss: 0.3713233
	speed: 0.0052s/iter; left time: 7.0766s
	iters: 700, epoch: 7 | loss: 0.2456179
	speed: 0.0052s/iter; left time: 6.4978s
	iters: 800, epoch: 7 | loss: 1.0546651
	speed: 0.0052s/iter; left time: 6.0654s
	iters: 900, epoch: 7 | loss: 0.8690996
	speed: 0.0052s/iter; left time: 5.5152s
Updating learning rate to 2.566275315625e-06
Epoch: 7 cost time: 5.145948648452759
Epoch: 7, Steps: 979 | Train Loss: 0.7632390 Vali Loss: 0.5995967 Best vali loss: 0.5995796
	iters: 100, epoch: 8 | loss: 0.8316949
	speed: 0.0160s/iter; left time: 14.0660s
	iters: 200, epoch: 8 | loss: 1.5574391
	speed: 0.0051s/iter; left time: 3.9769s
	iters: 300, epoch: 8 | loss: 1.2486947
	speed: 0.0052s/iter; left time: 3.5082s
	iters: 400, epoch: 8 | loss: 0.9850913
	speed: 0.0052s/iter; left time: 3.0158s
	iters: 500, epoch: 8 | loss: 1.0374781
	speed: 0.0053s/iter; left time: 2.5222s
	iters: 600, epoch: 8 | loss: 0.6254638
	speed: 0.0052s/iter; left time: 1.9872s
	iters: 700, epoch: 8 | loss: 0.6215801
	speed: 0.0052s/iter; left time: 1.4635s
	iters: 800, epoch: 8 | loss: 0.6681574
	speed: 0.0051s/iter; left time: 0.9224s
	iters: 900, epoch: 8 | loss: 1.0703596
	speed: 0.0049s/iter; left time: 0.3918s
Updating learning rate to 1.2831376578125e-06
Epoch: 8 cost time: 5.056763648986816
Epoch: 8, Steps: 979 | Train Loss: 0.9606621 Vali Loss: 0.6003023 Best vali loss: 0.5995796

best validation loss 0.5995796092306227

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010490240749, 'e_layers': 2, 'learning_rate': 0.0002978670278, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745586
	speed: 0.0119s/iter; left time: 10.5034s
Updating learning rate to 0.0002865301390971952
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.029688835144043
Epoch: 1, Steps: 123 | Train Loss: 0.7745586 Vali Loss: 0.6172542 Best vali loss: 0.6172542
	iters: 100, epoch: 2 | loss: 0.9475847
	speed: 0.0091s/iter; left time: 6.9677s
Updating learning rate to 0.0002542454115246309
Validation loss decreased (0.6173 --> 0.5802).  Saving model state dict ...
Epoch: 2 cost time: 0.7193725109100342
Epoch: 2, Steps: 123 | Train Loss: 0.9475847 Vali Loss: 0.5802475 Best vali loss: 0.5802475
	iters: 100, epoch: 3 | loss: 0.8441440
	speed: 0.0092s/iter; left time: 5.8639s
Updating learning rate to 0.0002059279021934458
Validation loss decreased (0.5802 --> 0.5511).  Saving model state dict ...
Epoch: 3 cost time: 0.7164905071258545
Epoch: 3, Steps: 123 | Train Loss: 0.8441440 Vali Loss: 0.5511180 Best vali loss: 0.5511180
	iters: 100, epoch: 4 | loss: 0.4844958
	speed: 0.0092s/iter; left time: 4.7621s
Updating learning rate to 0.0001489335139
Validation loss decreased (0.5511 --> 0.5340).  Saving model state dict ...
Epoch: 4 cost time: 0.7183325290679932
Epoch: 4, Steps: 123 | Train Loss: 0.4844958 Vali Loss: 0.5340431 Best vali loss: 0.5340431
	iters: 100, epoch: 5 | loss: 0.5587732
	speed: 0.0093s/iter; left time: 3.6673s
Updating learning rate to 9.19391256065542e-05
Validation loss decreased (0.5340 --> 0.5280).  Saving model state dict ...
Epoch: 5 cost time: 0.7231316566467285
Epoch: 5, Steps: 123 | Train Loss: 0.5587732 Vali Loss: 0.5279838 Best vali loss: 0.5279838
	iters: 100, epoch: 6 | loss: 0.5887831
	speed: 0.0094s/iter; left time: 2.5408s
Updating learning rate to 4.3621616275369076e-05
Epoch: 6 cost time: 0.7222094535827637
Epoch: 6, Steps: 123 | Train Loss: 0.5887831 Vali Loss: 0.5431840 Best vali loss: 0.5279838
	iters: 100, epoch: 7 | loss: 0.5393677
	speed: 0.0090s/iter; left time: 1.3220s
Updating learning rate to 1.1336888702804773e-05
Epoch: 7 cost time: 0.7226510047912598
Epoch: 7, Steps: 123 | Train Loss: 0.5393677 Vali Loss: 0.5409429 Best vali loss: 0.5279838
	iters: 100, epoch: 8 | loss: 0.6974988
	speed: 0.0091s/iter; left time: 0.2179s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7219326496124268
Epoch: 8, Steps: 123 | Train Loss: 0.6974988 Vali Loss: 0.5490527 Best vali loss: 0.5279838

best validation loss 0.5279838413289718

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494799637, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6186935
	speed: 0.0141s/iter; left time: 12.4700s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6147).  Saving model state dict ...
Epoch: 1 cost time: 1.3065106868743896
Epoch: 1, Steps: 123 | Train Loss: 0.6186935 Vali Loss: 0.6147271 Best vali loss: 0.6147271
	iters: 100, epoch: 2 | loss: 0.7200728
	speed: 0.0124s/iter; left time: 9.4201s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6147 --> 0.5916).  Saving model state dict ...
Epoch: 2 cost time: 0.9996814727783203
Epoch: 2, Steps: 123 | Train Loss: 0.7200728 Vali Loss: 0.5916000 Best vali loss: 0.5916000
	iters: 100, epoch: 3 | loss: 0.6348609
	speed: 0.0127s/iter; left time: 8.1032s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5916 --> 0.5324).  Saving model state dict ...
Epoch: 3 cost time: 1.004680871963501
Epoch: 3, Steps: 123 | Train Loss: 0.6348609 Vali Loss: 0.5324225 Best vali loss: 0.5324225
	iters: 100, epoch: 4 | loss: 0.8570705
	speed: 0.0126s/iter; left time: 6.5009s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5324 --> 0.5323).  Saving model state dict ...
Epoch: 4 cost time: 1.0053191184997559
Epoch: 4, Steps: 123 | Train Loss: 0.8570705 Vali Loss: 0.5322897 Best vali loss: 0.5322897
	iters: 100, epoch: 5 | loss: 0.6715804
	speed: 0.0125s/iter; left time: 4.9239s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5323 --> 0.5256).  Saving model state dict ...
Epoch: 5 cost time: 0.994800329208374
Epoch: 5, Steps: 123 | Train Loss: 0.6715804 Vali Loss: 0.5256101 Best vali loss: 0.5256101
	iters: 100, epoch: 6 | loss: 0.4281190
	speed: 0.0126s/iter; left time: 3.3954s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.9968099594116211
Epoch: 6, Steps: 123 | Train Loss: 0.4281190 Vali Loss: 0.5414144 Best vali loss: 0.5256101
	iters: 100, epoch: 7 | loss: 0.7751223
	speed: 0.0120s/iter; left time: 1.7605s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.993772029876709
Epoch: 7, Steps: 123 | Train Loss: 0.7751223 Vali Loss: 0.5409761 Best vali loss: 0.5256101
	iters: 100, epoch: 8 | loss: 0.6697902
	speed: 0.0120s/iter; left time: 0.2875s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9927229881286621
Epoch: 8, Steps: 123 | Train Loss: 0.6697902 Vali Loss: 0.5450660 Best vali loss: 0.5256101

best validation loss 0.5256100687259108

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001760928865, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617504
	speed: 0.0118s/iter; left time: 10.4331s
Updating learning rate to 0.00016939075007909153
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0321674346923828
Epoch: 1, Steps: 123 | Train Loss: 0.7617504 Vali Loss: 0.6075919 Best vali loss: 0.6075919
	iters: 100, epoch: 2 | loss: 0.9351233
	speed: 0.0092s/iter; left time: 7.0363s
Updating learning rate to 0.00015030468033143152
Validation loss decreased (0.6076 --> 0.5671).  Saving model state dict ...
Epoch: 2 cost time: 0.72098708152771
Epoch: 2, Steps: 123 | Train Loss: 0.9351233 Vali Loss: 0.5671427 Best vali loss: 0.5671427
	iters: 100, epoch: 3 | loss: 0.8578074
	speed: 0.0095s/iter; left time: 6.0717s
Updating learning rate to 0.00012174035836044808
Validation loss decreased (0.5671 --> 0.5457).  Saving model state dict ...
Epoch: 3 cost time: 0.7205286026000977
Epoch: 3, Steps: 123 | Train Loss: 0.8578074 Vali Loss: 0.5457003 Best vali loss: 0.5457003

best validation loss 0.5457002715014132

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010656571398, 'e_layers': 2, 'learning_rate': 0.0010580986111, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010178271306369548
Validation loss decreased (inf --> 0.6189).  Saving model state dict ...
Epoch: 1 cost time: 0.7396485805511475
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6189436 Best vali loss: 0.6189436
Updating learning rate to 0.0009031436570864387
Epoch: 2 cost time: 0.4668576717376709
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6355485 Best vali loss: 0.6189436
Updating learning rate to 0.0007315077096882412
Epoch: 3 cost time: 0.4569103717803955
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6317581 Best vali loss: 0.6189436

best validation loss 0.6189436399511914

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0109090431738, 'e_layers': 3, 'learning_rate': 6.71377235e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8518746
	speed: 0.0106s/iter; left time: 40.6136s
	iters: 200, epoch: 1 | loss: 1.3619235
	speed: 0.0045s/iter; left time: 16.6203s
	iters: 300, epoch: 1 | loss: 1.4689656
	speed: 0.0045s/iter; left time: 16.3138s
	iters: 400, epoch: 1 | loss: 0.6813343
	speed: 0.0047s/iter; left time: 16.3741s
Updating learning rate to 6.71377235e-05
Validation loss decreased (inf --> 0.6179).  Saving model state dict ...
Epoch: 1 cost time: 2.5610692501068115
Epoch: 1, Steps: 490 | Train Loss: 1.0910245 Vali Loss: 0.6178617 Best vali loss: 0.6178617
	iters: 100, epoch: 2 | loss: 0.7775189
	speed: 0.0122s/iter; left time: 40.6438s
	iters: 200, epoch: 2 | loss: 0.8091091
	speed: 0.0045s/iter; left time: 14.4980s
	iters: 300, epoch: 2 | loss: 0.9618317
	speed: 0.0044s/iter; left time: 13.9017s
	iters: 400, epoch: 2 | loss: 0.7205295
	speed: 0.0044s/iter; left time: 13.3640s
Updating learning rate to 3.356886175e-05
Validation loss decreased (0.6179 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 2.214536190032959
Epoch: 2, Steps: 490 | Train Loss: 0.8172473 Vali Loss: 0.6037844 Best vali loss: 0.6037844
	iters: 100, epoch: 3 | loss: 0.5810991
	speed: 0.0118s/iter; left time: 33.6299s
	iters: 200, epoch: 3 | loss: 0.5741554
	speed: 0.0044s/iter; left time: 12.0054s
	iters: 300, epoch: 3 | loss: 0.9420611
	speed: 0.0044s/iter; left time: 11.5389s
	iters: 400, epoch: 3 | loss: 0.9082600
	speed: 0.0045s/iter; left time: 11.4541s
Updating learning rate to 1.6784430875e-05
Validation loss decreased (0.6038 --> 0.5987).  Saving model state dict ...
Epoch: 3 cost time: 2.1793406009674072
Epoch: 3, Steps: 490 | Train Loss: 0.7513939 Vali Loss: 0.5987063 Best vali loss: 0.5987063

best validation loss 0.5987062742593166

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001760928865, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6012166
	speed: 0.0122s/iter; left time: 6.3078s
Updating learning rate to 8.804644325e-05
Validation loss decreased (0.5457 --> 0.5337).  Saving model state dict ...
Epoch: 4 cost time: 1.037898302078247
Epoch: 4, Steps: 123 | Train Loss: 0.6012166 Vali Loss: 0.5337440 Best vali loss: 0.5337440
	iters: 100, epoch: 5 | loss: 0.8476394
	speed: 0.0093s/iter; left time: 3.6740s
Updating learning rate to 5.435252813955191e-05
Validation loss decreased (0.5337 --> 0.5295).  Saving model state dict ...
Epoch: 5 cost time: 0.7186000347137451
Epoch: 5, Steps: 123 | Train Loss: 0.8476394 Vali Loss: 0.5294933 Best vali loss: 0.5294933
	iters: 100, epoch: 6 | loss: 0.8056620
	speed: 0.0093s/iter; left time: 2.5002s
Updating learning rate to 2.578820616856848e-05
Validation loss decreased (0.5295 --> 0.5282).  Saving model state dict ...
Epoch: 6 cost time: 0.71199631690979
Epoch: 6, Steps: 123 | Train Loss: 0.8056620 Vali Loss: 0.5282490 Best vali loss: 0.5282490
	iters: 100, epoch: 7 | loss: 0.4785571
	speed: 0.0093s/iter; left time: 1.3654s
Updating learning rate to 6.702136420908462e-06
Epoch: 7 cost time: 0.7243566513061523
Epoch: 7, Steps: 123 | Train Loss: 0.4785571 Vali Loss: 0.5290758 Best vali loss: 0.5282490
	iters: 100, epoch: 8 | loss: 0.5488023
	speed: 0.0090s/iter; left time: 0.2162s
Updating learning rate to 0.0
Validation loss decreased (0.5282 --> 0.5250).  Saving model state dict ...
Epoch: 8 cost time: 0.7186846733093262
Epoch: 8, Steps: 123 | Train Loss: 0.5488023 Vali Loss: 0.5249716 Best vali loss: 0.5249716

best validation loss 0.5249716000996051

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0036899747942, 'e_layers': 3, 'learning_rate': 0.0009105249569, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4455392
	speed: 0.0105s/iter; left time: 40.0623s
	iters: 200, epoch: 1 | loss: 0.7550487
	speed: 0.0046s/iter; left time: 17.2285s
	iters: 300, epoch: 1 | loss: 0.9143514
	speed: 0.0045s/iter; left time: 16.4504s
	iters: 400, epoch: 1 | loss: 0.9406043
	speed: 0.0045s/iter; left time: 15.9091s
Updating learning rate to 0.0009105249569
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 2.563436269760132
Epoch: 1, Steps: 490 | Train Loss: 1.0138859 Vali Loss: 0.6019359 Best vali loss: 0.6019359
	iters: 100, epoch: 2 | loss: 0.7079177
	speed: 0.0116s/iter; left time: 38.6380s
	iters: 200, epoch: 2 | loss: 0.6517597
	speed: 0.0040s/iter; left time: 12.8754s
	iters: 300, epoch: 2 | loss: 1.0850306
	speed: 0.0040s/iter; left time: 12.6768s
	iters: 400, epoch: 2 | loss: 0.7429185
	speed: 0.0040s/iter; left time: 11.9917s
Updating learning rate to 0.00045526247845
Epoch: 2 cost time: 2.0079448223114014
Epoch: 2, Steps: 490 | Train Loss: 0.7969066 Vali Loss: 0.6189995 Best vali loss: 0.6019359
	iters: 100, epoch: 3 | loss: 1.0700178
	speed: 0.0118s/iter; left time: 33.4872s
	iters: 200, epoch: 3 | loss: 0.5319529
	speed: 0.0044s/iter; left time: 11.9997s
	iters: 300, epoch: 3 | loss: 0.3447689
	speed: 0.0044s/iter; left time: 11.5769s
	iters: 400, epoch: 3 | loss: 0.8314678
	speed: 0.0044s/iter; left time: 11.1862s
Updating learning rate to 0.000227631239225
Validation loss decreased (0.6019 --> 0.6014).  Saving model state dict ...
Epoch: 3 cost time: 2.2051963806152344
Epoch: 3, Steps: 490 | Train Loss: 0.6945519 Vali Loss: 0.6013888 Best vali loss: 0.6013888
	iters: 100, epoch: 4 | loss: 0.9142580
	speed: 0.0121s/iter; left time: 28.4140s
	iters: 200, epoch: 4 | loss: 1.0406265
	speed: 0.0043s/iter; left time: 9.6054s
	iters: 300, epoch: 4 | loss: 0.6160748
	speed: 0.0046s/iter; left time: 9.8289s
	iters: 400, epoch: 4 | loss: 0.7262521
	speed: 0.0041s/iter; left time: 8.4085s
Updating learning rate to 0.0001138156196125
Epoch: 4 cost time: 2.1649110317230225
Epoch: 4, Steps: 490 | Train Loss: 0.8243029 Vali Loss: 0.6133774 Best vali loss: 0.6013888
	iters: 100, epoch: 5 | loss: 0.2781880
	speed: 0.0116s/iter; left time: 21.6734s
	iters: 200, epoch: 5 | loss: 0.9724309
	speed: 0.0042s/iter; left time: 7.3978s
	iters: 300, epoch: 5 | loss: 0.6582512
	speed: 0.0043s/iter; left time: 7.1119s
	iters: 400, epoch: 5 | loss: 0.6511090
	speed: 0.0041s/iter; left time: 6.4531s
Updating learning rate to 5.690780980625e-05
Epoch: 5 cost time: 2.103863477706909
Epoch: 5, Steps: 490 | Train Loss: 0.6399948 Vali Loss: 0.6198605 Best vali loss: 0.6013888
	iters: 100, epoch: 6 | loss: 1.1293468
	speed: 0.0117s/iter; left time: 15.9794s
	iters: 200, epoch: 6 | loss: 0.7817873
	speed: 0.0045s/iter; left time: 5.7595s
	iters: 300, epoch: 6 | loss: 1.1427398
	speed: 0.0046s/iter; left time: 5.4176s
	iters: 400, epoch: 6 | loss: 0.5114027
	speed: 0.0046s/iter; left time: 4.8994s
Updating learning rate to 2.8453904903125e-05
Epoch: 6 cost time: 2.2724449634552
Epoch: 6, Steps: 490 | Train Loss: 0.8913192 Vali Loss: 0.6208293 Best vali loss: 0.6013888
	iters: 100, epoch: 7 | loss: 0.7285047
	speed: 0.0119s/iter; left time: 10.5171s
	iters: 200, epoch: 7 | loss: 0.8242060
	speed: 0.0044s/iter; left time: 3.4655s
	iters: 300, epoch: 7 | loss: 0.3336431
	speed: 0.0044s/iter; left time: 3.0099s
	iters: 400, epoch: 7 | loss: 0.6127203
	speed: 0.0045s/iter; left time: 2.5947s
Updating learning rate to 1.42269524515625e-05
Epoch: 7 cost time: 2.2190537452697754
Epoch: 7, Steps: 490 | Train Loss: 0.6247685 Vali Loss: 0.6217019 Best vali loss: 0.6013888
	iters: 100, epoch: 8 | loss: 1.3714541
	speed: 0.0120s/iter; left time: 4.7070s
	iters: 200, epoch: 8 | loss: 1.2311460
	speed: 0.0044s/iter; left time: 1.2802s
	iters: 300, epoch: 8 | loss: 0.3511026
	speed: 0.0045s/iter; left time: 0.8614s
	iters: 400, epoch: 8 | loss: 2.0336156
	speed: 0.0043s/iter; left time: 0.3938s
Updating learning rate to 7.11347622578125e-06
Epoch: 8 cost time: 2.2031149864196777
Epoch: 8, Steps: 490 | Train Loss: 1.2468296 Vali Loss: 0.6228567 Best vali loss: 0.6013888

best validation loss 0.6013888400056637

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0039738050619, 'e_layers': 2, 'learning_rate': 0.0004717127857, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004537592868160564
Validation loss decreased (inf --> 0.6155).  Saving model state dict ...
Epoch: 1 cost time: 0.7935409545898438
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6154949 Best vali loss: 0.6154949
Updating learning rate to 0.00040263204762043336
Validation loss decreased (0.6155 --> 0.5757).  Saving model state dict ...
Epoch: 2 cost time: 0.4959084987640381
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5756791 Best vali loss: 0.5756791
Updating learning rate to 0.000326114726811087
Validation loss decreased (0.5757 --> 0.5621).  Saving model state dict ...
Epoch: 3 cost time: 0.48879504203796387
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5621367 Best vali loss: 0.5621367
Updating learning rate to 0.00023585639285
Validation loss decreased (0.5621 --> 0.5583).  Saving model state dict ...
Epoch: 4 cost time: 0.49251532554626465
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5582537 Best vali loss: 0.5582537
Updating learning rate to 0.000145598058888913
Validation loss decreased (0.5583 --> 0.5534).  Saving model state dict ...
Epoch: 5 cost time: 0.4917881488800049
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5533659 Best vali loss: 0.5533659
Updating learning rate to 6.908073807956667e-05
Validation loss decreased (0.5534 --> 0.5510).  Saving model state dict ...
Epoch: 6 cost time: 0.49725890159606934
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5510329 Best vali loss: 0.5510329
Updating learning rate to 1.795349888394361e-05
Epoch: 7 cost time: 0.49231815338134766
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5673179 Best vali loss: 0.5510329
Updating learning rate to 0.0
Epoch: 8 cost time: 0.49106597900390625
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5600533 Best vali loss: 0.5510329

best validation loss 0.5510328997621267

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.011137096492, 'e_layers': 2, 'learning_rate': 0.0004612859753, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8000014
	speed: 0.0104s/iter; left time: 19.2961s
	iters: 200, epoch: 1 | loss: 0.7393339
	speed: 0.0041s/iter; left time: 7.3038s
Updating learning rate to 0.0004437293232570885
Validation loss decreased (inf --> 0.6195).  Saving model state dict ...
Epoch: 1 cost time: 1.3624320030212402
Epoch: 1, Steps: 245 | Train Loss: 0.7696676 Vali Loss: 0.6194780 Best vali loss: 0.6194780
	iters: 100, epoch: 2 | loss: 1.1352175
	speed: 0.0089s/iter; left time: 14.3524s
	iters: 200, epoch: 2 | loss: 0.9625227
	speed: 0.0040s/iter; left time: 6.1374s
Updating learning rate to 0.00039373220825044016
Validation loss decreased (0.6195 --> 0.5737).  Saving model state dict ...
Epoch: 2 cost time: 1.0667319297790527
Epoch: 2, Steps: 245 | Train Loss: 1.0488701 Vali Loss: 0.5737424 Best vali loss: 0.5737424
	iters: 100, epoch: 3 | loss: 0.9012028
	speed: 0.0087s/iter; left time: 11.9066s
	iters: 200, epoch: 3 | loss: 0.7291389
	speed: 0.0040s/iter; left time: 5.1189s
Updating learning rate to 0.00031890623781484105
Validation loss decreased (0.5737 --> 0.5543).  Saving model state dict ...
Epoch: 3 cost time: 1.0313150882720947
Epoch: 3, Steps: 245 | Train Loss: 0.8151708 Vali Loss: 0.5543329 Best vali loss: 0.5543329

best validation loss 0.554332895612121

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0109608208355, 'e_layers': 2, 'learning_rate': 0.0004452254386, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7997962
	speed: 0.0100s/iter; left time: 18.5976s
	iters: 200, epoch: 1 | loss: 0.7224422
	speed: 0.0037s/iter; left time: 6.6008s
Updating learning rate to 0.00042828005433795033
Validation loss decreased (inf --> 0.5946).  Saving model state dict ...
Epoch: 1 cost time: 1.2870733737945557
Epoch: 1, Steps: 245 | Train Loss: 0.7611192 Vali Loss: 0.5946361 Best vali loss: 0.5946361
	iters: 100, epoch: 2 | loss: 1.1074005
	speed: 0.0084s/iter; left time: 13.5973s
	iters: 200, epoch: 2 | loss: 0.9818211
	speed: 0.0037s/iter; left time: 5.6520s
Updating learning rate to 0.0003800236826954074
Epoch: 2 cost time: 0.9928834438323975
Epoch: 2, Steps: 245 | Train Loss: 1.0446108 Vali Loss: 0.6062143 Best vali loss: 0.5946361
	iters: 100, epoch: 3 | loss: 0.8550432
	speed: 0.0079s/iter; left time: 10.8657s
	iters: 200, epoch: 3 | loss: 0.6997837
	speed: 0.0037s/iter; left time: 4.6521s
Updating learning rate to 0.0003078029188098503
Epoch: 3 cost time: 0.9536399841308594
Epoch: 3, Steps: 245 | Train Loss: 0.7774134 Vali Loss: 0.6093104 Best vali loss: 0.5946361

best validation loss 0.5946361125205083

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0041972282371, 'e_layers': 2, 'learning_rate': 0.000444857566, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00042792618305509443
Validation loss decreased (inf --> 0.6001).  Saving model state dict ...
Epoch: 1 cost time: 0.7979130744934082
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6000507 Best vali loss: 0.6000507
Updating learning rate to 0.00037970968379037105
Epoch: 2 cost time: 0.48388147354125977
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6331000 Best vali loss: 0.6000507
Updating learning rate to 0.0003075485931352298
Validation loss decreased (0.6001 --> 0.5508).  Saving model state dict ...
Epoch: 3 cost time: 0.48110079765319824
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5508213 Best vali loss: 0.5508213

best validation loss 0.5508213197120303

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0041972282371, 'e_layers': 2, 'learning_rate': 0.000444857566, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.000222428783
Epoch: 4 cost time: 0.8021848201751709
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5520226 Best vali loss: 0.5508213
Updating learning rate to 0.0001373089728647703
Validation loss decreased (0.5508 --> 0.5494).  Saving model state dict ...
Epoch: 5 cost time: 0.47329044342041016
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5494197 Best vali loss: 0.5494197
Updating learning rate to 6.514788220962895e-05
Epoch: 6 cost time: 0.4883155822753906
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5560085 Best vali loss: 0.5494197
Updating learning rate to 1.6931382944905557e-05
Epoch: 7 cost time: 0.4746263027191162
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5558755 Best vali loss: 0.5494197
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4758732318878174
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5546783 Best vali loss: 0.5494197

best validation loss 0.5494197430239955

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0058619919205, 'e_layers': 2, 'learning_rate': 0.0004662918488, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7963850
	speed: 0.0103s/iter; left time: 19.2128s
	iters: 200, epoch: 1 | loss: 0.8681815
	speed: 0.0042s/iter; left time: 7.4041s
Updating learning rate to 0.0004485446720415838
Validation loss decreased (inf --> 0.6070).  Saving model state dict ...
Epoch: 1 cost time: 1.3835830688476562
Epoch: 1, Steps: 245 | Train Loss: 0.8322833 Vali Loss: 0.6069841 Best vali loss: 0.6069841
	iters: 100, epoch: 2 | loss: 0.7458481
	speed: 0.0089s/iter; left time: 14.4388s
	iters: 200, epoch: 2 | loss: 0.6597455
	speed: 0.0042s/iter; left time: 6.3404s
Updating learning rate to 0.00039800498854924613
Epoch: 2 cost time: 1.0777888298034668
Epoch: 2, Steps: 245 | Train Loss: 0.7027968 Vali Loss: 0.6177987 Best vali loss: 0.6069841
	iters: 100, epoch: 3 | loss: 0.5021435
	speed: 0.0088s/iter; left time: 12.0514s
	iters: 200, epoch: 3 | loss: 0.6779587
	speed: 0.0042s/iter; left time: 5.3049s
Updating learning rate to 0.00032236700699132375
Epoch: 3 cost time: 1.069718837738037
Epoch: 3, Steps: 245 | Train Loss: 0.5900511 Vali Loss: 0.6167581 Best vali loss: 0.6069841
	iters: 100, epoch: 4 | loss: 0.7543068
	speed: 0.0088s/iter; left time: 9.8978s
	iters: 200, epoch: 4 | loss: 0.7999979
	speed: 0.0042s/iter; left time: 4.2754s
Updating learning rate to 0.0002331459244
Epoch: 4 cost time: 1.06900954246521
Epoch: 4, Steps: 245 | Train Loss: 0.7771523 Vali Loss: 0.6256240 Best vali loss: 0.6069841
	iters: 100, epoch: 5 | loss: 0.7793623
	speed: 0.0090s/iter; left time: 7.9482s
	iters: 200, epoch: 5 | loss: 0.6846337
	speed: 0.0042s/iter; left time: 3.2503s
Updating learning rate to 0.00014392484180867626
Epoch: 5 cost time: 1.0922141075134277
Epoch: 5, Steps: 245 | Train Loss: 0.7319980 Vali Loss: 0.6252414 Best vali loss: 0.6069841
	iters: 100, epoch: 6 | loss: 0.5967314
	speed: 0.0088s/iter; left time: 5.5712s
	iters: 200, epoch: 6 | loss: 0.5878032
	speed: 0.0043s/iter; left time: 2.2876s
Updating learning rate to 6.828686025075387e-05
Epoch: 6 cost time: 1.075946569442749
Epoch: 6, Steps: 245 | Train Loss: 0.5922673 Vali Loss: 0.6413748 Best vali loss: 0.6069841
	iters: 100, epoch: 7 | loss: 0.7084624
	speed: 0.0087s/iter; left time: 3.4030s
	iters: 200, epoch: 7 | loss: 0.6739374
	speed: 0.0044s/iter; left time: 1.2692s
Updating learning rate to 1.77471767584162e-05
Epoch: 7 cost time: 1.090472936630249
Epoch: 7, Steps: 245 | Train Loss: 0.6911999 Vali Loss: 0.6268072 Best vali loss: 0.6069841
	iters: 100, epoch: 8 | loss: 0.7332259
	speed: 0.0089s/iter; left time: 1.3065s
	iters: 200, epoch: 8 | loss: 0.8135911
	speed: 0.0043s/iter; left time: 0.1976s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0981981754302979
Epoch: 8, Steps: 245 | Train Loss: 0.7734085 Vali Loss: 0.6279114 Best vali loss: 0.6069841

best validation loss 0.6069841350410229

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0037405555987, 'e_layers': 2, 'learning_rate': 0.00046535138, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004476399977039411
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 0.7819006443023682
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6155933 Best vali loss: 0.6155933
Updating learning rate to 0.00039720224821625894
Validation loss decreased (0.6156 --> 0.5782).  Saving model state dict ...
Epoch: 2 cost time: 0.49358105659484863
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5782377 Best vali loss: 0.5782377
Updating learning rate to 0.0003217168216771156
Validation loss decreased (0.5782 --> 0.5589).  Saving model state dict ...
Epoch: 3 cost time: 0.49898362159729004
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5589432 Best vali loss: 0.5589432
Updating learning rate to 0.00023267569
Validation loss decreased (0.5589 --> 0.5538).  Saving model state dict ...
Epoch: 4 cost time: 0.4972507953643799
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5537962 Best vali loss: 0.5537962
Updating learning rate to 0.0001436345583228844
Validation loss decreased (0.5538 --> 0.5438).  Saving model state dict ...
Epoch: 5 cost time: 0.49089622497558594
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5437516 Best vali loss: 0.5437516
Updating learning rate to 6.814913178374105e-05
Epoch: 6 cost time: 0.5008299350738525
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5494970 Best vali loss: 0.5437516
Updating learning rate to 1.7711382296058925e-05
Epoch: 7 cost time: 0.49605870246887207
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5644304 Best vali loss: 0.5437516
Updating learning rate to 0.0
Epoch: 8 cost time: 0.49832963943481445
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5549774 Best vali loss: 0.5437516

best validation loss 0.5437516118298521

[INFO][smbo.py:320] Finished 900 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0041842844212, 'e_layers': 2, 'learning_rate': 0.0004307682606, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004143731199119141
Validation loss decreased (inf --> 0.6148).  Saving model state dict ...
Epoch: 1 cost time: 0.7706291675567627
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6147590 Best vali loss: 0.6147590
Updating learning rate to 0.0003676837093950969
Validation loss decreased (0.6148 --> 0.5781).  Saving model state dict ...
Epoch: 2 cost time: 0.4879767894744873
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5781495 Best vali loss: 0.5781495
Updating learning rate to 0.00029780806856017375
Validation loss decreased (0.5781 --> 0.5663).  Saving model state dict ...
Epoch: 3 cost time: 0.49471378326416016
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5663387 Best vali loss: 0.5663387

best validation loss 0.5663387307079232

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0119659252535, 'e_layers': 4, 'learning_rate': 0.0017895954814, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2952060
	speed: 0.0113s/iter; left time: 87.1343s
	iters: 200, epoch: 1 | loss: 1.1619554
	speed: 0.0052s/iter; left time: 39.4240s
	iters: 300, epoch: 1 | loss: 0.9954197
	speed: 0.0052s/iter; left time: 39.0560s
	iters: 400, epoch: 1 | loss: 0.6590370
	speed: 0.0052s/iter; left time: 38.3473s
	iters: 500, epoch: 1 | loss: 0.7962575
	speed: 0.0052s/iter; left time: 38.2354s
	iters: 600, epoch: 1 | loss: 1.1539105
	speed: 0.0053s/iter; left time: 38.2237s
	iters: 700, epoch: 1 | loss: 0.5899106
	speed: 0.0052s/iter; left time: 37.1782s
	iters: 800, epoch: 1 | loss: 0.6837072
	speed: 0.0051s/iter; left time: 36.0735s
	iters: 900, epoch: 1 | loss: 0.9722310
	speed: 0.0051s/iter; left time: 35.1808s
Updating learning rate to 0.0017214830590700717
Validation loss decreased (inf --> 0.6279).  Saving model state dict ...
Epoch: 1 cost time: 5.398905277252197
Epoch: 1, Steps: 979 | Train Loss: 0.9230705 Vali Loss: 0.6279437 Best vali loss: 0.6279437
	iters: 100, epoch: 2 | loss: 0.7018478
	speed: 0.0157s/iter; left time: 105.9214s
	iters: 200, epoch: 2 | loss: 1.4244745
	speed: 0.0051s/iter; left time: 34.0821s
	iters: 300, epoch: 2 | loss: 0.5953595
	speed: 0.0052s/iter; left time: 33.7586s
	iters: 400, epoch: 2 | loss: 0.4407410
	speed: 0.0053s/iter; left time: 34.1231s
	iters: 500, epoch: 2 | loss: 0.8969959
	speed: 0.0051s/iter; left time: 32.6674s
	iters: 600, epoch: 2 | loss: 0.9183261
	speed: 0.0052s/iter; left time: 32.2833s
	iters: 700, epoch: 2 | loss: 0.5018095
	speed: 0.0051s/iter; left time: 31.5345s
	iters: 800, epoch: 2 | loss: 0.4202759
	speed: 0.0051s/iter; left time: 30.8252s
	iters: 900, epoch: 2 | loss: 0.5298485
	speed: 0.0051s/iter; left time: 30.4626s
Updating learning rate to 0.0015275152909393721
Epoch: 2 cost time: 5.088148832321167
Epoch: 2, Steps: 979 | Train Loss: 0.7144087 Vali Loss: 0.6512814 Best vali loss: 0.6279437
	iters: 100, epoch: 3 | loss: 0.8832611
	speed: 0.0150s/iter; left time: 86.4729s
	iters: 200, epoch: 3 | loss: 1.2090168
	speed: 0.0044s/iter; left time: 24.7878s
	iters: 300, epoch: 3 | loss: 0.5084996
	speed: 0.0044s/iter; left time: 24.4014s
	iters: 400, epoch: 3 | loss: 0.4444613
	speed: 0.0044s/iter; left time: 24.3103s
	iters: 500, epoch: 3 | loss: 1.0680416
	speed: 0.0045s/iter; left time: 24.4019s
	iters: 600, epoch: 3 | loss: 0.7127445
	speed: 0.0048s/iter; left time: 25.3759s
	iters: 700, epoch: 3 | loss: 1.8441449
	speed: 0.0048s/iter; left time: 24.8680s
	iters: 800, epoch: 3 | loss: 1.3135254
	speed: 0.0048s/iter; left time: 24.3900s
	iters: 900, epoch: 3 | loss: 0.7363055
	speed: 0.0047s/iter; left time: 23.4470s
Updating learning rate to 0.0012372220113836038
Epoch: 3 cost time: 4.5397350788116455
Epoch: 3, Steps: 979 | Train Loss: 0.9688890 Vali Loss: 0.6425419 Best vali loss: 0.6279437

best validation loss 0.62794365528721

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020785306445, 'e_layers': 2, 'learning_rate': 0.0001352482814, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0366732
	speed: 0.0115s/iter; left time: 10.1770s
Updating learning rate to 0.00013010070019639348
Validation loss decreased (inf --> 0.6055).  Saving model state dict ...
Epoch: 1 cost time: 0.9808714389801025
Epoch: 1, Steps: 123 | Train Loss: 1.0366732 Vali Loss: 0.6054864 Best vali loss: 0.6054864
	iters: 100, epoch: 2 | loss: 0.6394398
	speed: 0.0080s/iter; left time: 6.1247s
Updating learning rate to 0.0001154416291608832
Validation loss decreased (0.6055 --> 0.5717).  Saving model state dict ...
Epoch: 2 cost time: 0.6102008819580078
Epoch: 2, Steps: 123 | Train Loss: 0.6394398 Vali Loss: 0.5717342 Best vali loss: 0.5717342
	iters: 100, epoch: 3 | loss: 0.7381395
	speed: 0.0079s/iter; left time: 5.0442s
Updating learning rate to 9.350277897381578e-05
Validation loss decreased (0.5717 --> 0.5645).  Saving model state dict ...
Epoch: 3 cost time: 0.605008602142334
Epoch: 3, Steps: 123 | Train Loss: 0.7381395 Vali Loss: 0.5644739 Best vali loss: 0.5644739

best validation loss 0.56447390484512

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020785306445, 'e_layers': 2, 'learning_rate': 0.0001352482814, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9431369
	speed: 0.0117s/iter; left time: 6.0235s
Updating learning rate to 6.76241407e-05
Validation loss decreased (0.5645 --> 0.5564).  Saving model state dict ...
Epoch: 4 cost time: 0.9803223609924316
Epoch: 4, Steps: 123 | Train Loss: 0.9431369 Vali Loss: 0.5563863 Best vali loss: 0.5563863
	iters: 100, epoch: 5 | loss: 0.6157983
	speed: 0.0086s/iter; left time: 3.3713s
Updating learning rate to 4.174550242618424e-05
Epoch: 5 cost time: 0.6553223133087158
Epoch: 5, Steps: 123 | Train Loss: 0.6157983 Vali Loss: 0.5693257 Best vali loss: 0.5563863
	iters: 100, epoch: 6 | loss: 0.6911098
	speed: 0.0082s/iter; left time: 2.2132s
Updating learning rate to 1.9806652239116805e-05
Validation loss decreased (0.5564 --> 0.5543).  Saving model state dict ...
Epoch: 6 cost time: 0.6275084018707275
Epoch: 6, Steps: 123 | Train Loss: 0.6911098 Vali Loss: 0.5542545 Best vali loss: 0.5542545
	iters: 100, epoch: 7 | loss: 0.6442025
	speed: 0.0083s/iter; left time: 1.2176s
Updating learning rate to 5.1475812036065215e-06
Validation loss decreased (0.5543 --> 0.5484).  Saving model state dict ...
Epoch: 7 cost time: 0.6395940780639648
Epoch: 7, Steps: 123 | Train Loss: 0.6442025 Vali Loss: 0.5483666 Best vali loss: 0.5483666
	iters: 100, epoch: 8 | loss: 0.5229754
	speed: 0.0082s/iter; left time: 0.1969s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.608475923538208
Epoch: 8, Steps: 123 | Train Loss: 0.5229754 Vali Loss: 0.5492851 Best vali loss: 0.5483666

best validation loss 0.5483665937132882

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043815864203, 'e_layers': 2, 'learning_rate': 0.0001755477619, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616885
	speed: 0.0117s/iter; left time: 10.3944s
Updating learning rate to 0.00016886637304878733
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0175583362579346
Epoch: 1, Steps: 123 | Train Loss: 0.7616885 Vali Loss: 0.6075184 Best vali loss: 0.6075184
	iters: 100, epoch: 2 | loss: 0.9347040
	speed: 0.0092s/iter; left time: 6.9846s
Updating learning rate to 0.0001498393873808057
Validation loss decreased (0.6075 --> 0.5666).  Saving model state dict ...
Epoch: 2 cost time: 0.7208502292633057
Epoch: 2, Steps: 123 | Train Loss: 0.9347040 Vali Loss: 0.5666199 Best vali loss: 0.5666199
	iters: 100, epoch: 3 | loss: 0.8644886
	speed: 0.0094s/iter; left time: 5.9821s
Updating learning rate to 0.00012136349098395077
Validation loss decreased (0.5666 --> 0.5512).  Saving model state dict ...
Epoch: 3 cost time: 0.7206268310546875
Epoch: 3, Steps: 123 | Train Loss: 0.8644886 Vali Loss: 0.5512105 Best vali loss: 0.5512105
	iters: 100, epoch: 4 | loss: 0.4957463
	speed: 0.0092s/iter; left time: 4.7729s
Updating learning rate to 8.777388095e-05
Validation loss decreased (0.5512 --> 0.5350).  Saving model state dict ...
Epoch: 4 cost time: 0.7178990840911865
Epoch: 4, Steps: 123 | Train Loss: 0.4957463 Vali Loss: 0.5350152 Best vali loss: 0.5350152
	iters: 100, epoch: 5 | loss: 0.5778896
	speed: 0.0093s/iter; left time: 3.6680s
Updating learning rate to 5.418427091604924e-05
Validation loss decreased (0.5350 --> 0.5314).  Saving model state dict ...
Epoch: 5 cost time: 0.7213478088378906
Epoch: 5, Steps: 123 | Train Loss: 0.5778896 Vali Loss: 0.5313609 Best vali loss: 0.5313609
	iters: 100, epoch: 6 | loss: 0.6187309
	speed: 0.0093s/iter; left time: 2.5227s
Updating learning rate to 2.5708374519194285e-05
Validation loss decreased (0.5314 --> 0.5296).  Saving model state dict ...
Epoch: 6 cost time: 0.7236790657043457
Epoch: 6, Steps: 123 | Train Loss: 0.6187309 Vali Loss: 0.5295928 Best vali loss: 0.5295928
	iters: 100, epoch: 7 | loss: 0.5815746
	speed: 0.0093s/iter; left time: 1.3621s
Updating learning rate to 6.681388851212663e-06
Validation loss decreased (0.5296 --> 0.5257).  Saving model state dict ...
Epoch: 7 cost time: 0.7205684185028076
Epoch: 7, Steps: 123 | Train Loss: 0.5815746 Vali Loss: 0.5256777 Best vali loss: 0.5256777
	iters: 100, epoch: 8 | loss: 0.7421445
	speed: 0.0093s/iter; left time: 0.2225s
Updating learning rate to 0.0
Validation loss decreased (0.5257 --> 0.5236).  Saving model state dict ...
Epoch: 8 cost time: 0.7195134162902832
Epoch: 8, Steps: 123 | Train Loss: 0.7421445 Vali Loss: 0.5236346 Best vali loss: 0.5236346

best validation loss 0.5236346489822683

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.000929841701, 'e_layers': 1, 'learning_rate': 0.000126863224, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9770318
	speed: 0.0092s/iter; left time: 17.1037s
	iters: 200, epoch: 1 | loss: 0.9281132
	speed: 0.0030s/iter; left time: 5.3245s
Updating learning rate to 0.00012203478004099733
Validation loss decreased (inf --> 0.6059).  Saving model state dict ...
Epoch: 1 cost time: 1.0776665210723877
Epoch: 1, Steps: 245 | Train Loss: 0.9525725 Vali Loss: 0.6059483 Best vali loss: 0.6059483
	iters: 100, epoch: 2 | loss: 0.7804040
	speed: 0.0066s/iter; left time: 10.6909s
	iters: 200, epoch: 2 | loss: 0.6564777
	speed: 0.0030s/iter; left time: 4.5380s
Updating learning rate to 0.00010828453498679398
Epoch: 2 cost time: 0.781787633895874
Epoch: 2, Steps: 245 | Train Loss: 0.7184409 Vali Loss: 0.6066663 Best vali loss: 0.6059483
	iters: 100, epoch: 3 | loss: 0.6697937
	speed: 0.0070s/iter; left time: 9.6047s
	iters: 200, epoch: 3 | loss: 0.8213295
	speed: 0.0031s/iter; left time: 3.9584s
Updating learning rate to 8.770583900061063e-05
Epoch: 3 cost time: 0.8067357540130615
Epoch: 3, Steps: 245 | Train Loss: 0.7455616 Vali Loss: 0.6068866 Best vali loss: 0.6059483
	iters: 100, epoch: 4 | loss: 0.6567384
	speed: 0.0067s/iter; left time: 7.5271s
	iters: 200, epoch: 4 | loss: 0.9799328
	speed: 0.0030s/iter; left time: 3.1059s
Updating learning rate to 6.3431612e-05
Validation loss decreased (0.6059 --> 0.6039).  Saving model state dict ...
Epoch: 4 cost time: 0.7729237079620361
Epoch: 4, Steps: 245 | Train Loss: 0.8183356 Vali Loss: 0.6038906 Best vali loss: 0.6038906
	iters: 100, epoch: 5 | loss: 0.6223023
	speed: 0.0067s/iter; left time: 5.8815s
	iters: 200, epoch: 5 | loss: 0.6018394
	speed: 0.0030s/iter; left time: 2.3282s
Updating learning rate to 3.915738499938939e-05
Epoch: 5 cost time: 0.7834007740020752
Epoch: 5, Steps: 245 | Train Loss: 0.6120709 Vali Loss: 0.6150158 Best vali loss: 0.6038906
	iters: 100, epoch: 6 | loss: 0.9706870
	speed: 0.0066s/iter; left time: 4.1807s
	iters: 200, epoch: 6 | loss: 0.6388435
	speed: 0.0029s/iter; left time: 1.5712s
Updating learning rate to 1.857868901320602e-05
Epoch: 6 cost time: 0.7565114498138428
Epoch: 6, Steps: 245 | Train Loss: 0.8047652 Vali Loss: 0.6074791 Best vali loss: 0.6038906
	iters: 100, epoch: 7 | loss: 1.0036138
	speed: 0.0064s/iter; left time: 2.5117s
	iters: 200, epoch: 7 | loss: 0.6831723
	speed: 0.0030s/iter; left time: 0.8830s
Updating learning rate to 4.828443959002674e-06
Epoch: 7 cost time: 0.7671041488647461
Epoch: 7, Steps: 245 | Train Loss: 0.8433931 Vali Loss: 0.6096259 Best vali loss: 0.6038906
	iters: 100, epoch: 8 | loss: 0.8141866
	speed: 0.0067s/iter; left time: 0.9712s
	iters: 200, epoch: 8 | loss: 1.1571703
	speed: 0.0030s/iter; left time: 0.1366s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7805867195129395
Epoch: 8, Steps: 245 | Train Loss: 0.9856785 Vali Loss: 0.6114218 Best vali loss: 0.6038906

best validation loss 0.6038906136523348

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.002185782857, 'e_layers': 1, 'learning_rate': 0.0004529287536, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6890910
	speed: 0.0093s/iter; left time: 17.2594s
	iters: 200, epoch: 1 | loss: 1.3496900
	speed: 0.0028s/iter; left time: 4.9612s
Updating learning rate to 0.0004356901793684439
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 1.0496742725372314
Epoch: 1, Steps: 245 | Train Loss: 1.0193905 Vali Loss: 0.6064739 Best vali loss: 0.6064739
	iters: 100, epoch: 2 | loss: 0.8493629
	speed: 0.0065s/iter; left time: 10.4975s
	iters: 200, epoch: 2 | loss: 0.3697371
	speed: 0.0027s/iter; left time: 4.1573s
Updating learning rate to 0.00038659887333246547
Epoch: 2 cost time: 0.7289106845855713
Epoch: 2, Steps: 245 | Train Loss: 0.6095500 Vali Loss: 0.6153010 Best vali loss: 0.6064739
	iters: 100, epoch: 3 | loss: 1.0158653
	speed: 0.0065s/iter; left time: 8.9691s
	iters: 200, epoch: 3 | loss: 0.8901815
	speed: 0.0031s/iter; left time: 3.8853s
Updating learning rate to 0.00031312854182224503
Epoch: 3 cost time: 0.7697148323059082
Epoch: 3, Steps: 245 | Train Loss: 0.9530234 Vali Loss: 0.6278049 Best vali loss: 0.6064739

best validation loss 0.6064738882244434

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043847626055, 'e_layers': 2, 'learning_rate': 0.0001748930962, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7615716
	speed: 0.0119s/iter; left time: 10.5201s
Updating learning rate to 0.00016823662407835374
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0296862125396729
Epoch: 1, Steps: 123 | Train Loss: 0.7615716 Vali Loss: 0.6074881 Best vali loss: 0.6074881
	iters: 100, epoch: 2 | loss: 0.9367558
	speed: 0.0092s/iter; left time: 6.9981s
Updating learning rate to 0.0001492805952528656
Validation loss decreased (0.6075 --> 0.5685).  Saving model state dict ...
Epoch: 2 cost time: 0.7176914215087891
Epoch: 2, Steps: 123 | Train Loss: 0.9367558 Vali Loss: 0.5684812 Best vali loss: 0.5684812
	iters: 100, epoch: 3 | loss: 0.8590167
	speed: 0.0094s/iter; left time: 5.9749s
Updating learning rate to 0.00012091089327538692
Validation loss decreased (0.5685 --> 0.5472).  Saving model state dict ...
Epoch: 3 cost time: 0.7176673412322998
Epoch: 3, Steps: 123 | Train Loss: 0.8590167 Vali Loss: 0.5471970 Best vali loss: 0.5471970

best validation loss 0.5471969513030364

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.000875789215, 'e_layers': 2, 'learning_rate': 0.0008604307339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008276825390469377
Validation loss decreased (inf --> 0.6175).  Saving model state dict ...
Epoch: 1 cost time: 0.7446990013122559
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6174955 Best vali loss: 0.6174955
Updating learning rate to 0.0007344235702910039
Epoch: 2 cost time: 0.4651768207550049
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6192548 Best vali loss: 0.6174955
Updating learning rate to 0.0005948516602306326
Validation loss decreased (0.6175 --> 0.5712).  Saving model state dict ...
Epoch: 3 cost time: 0.4597907066345215
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5712078 Best vali loss: 0.5712078

best validation loss 0.5712077520556716

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043847626055, 'e_layers': 2, 'learning_rate': 0.0001748930962, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6045430
	speed: 0.0120s/iter; left time: 6.1896s
Updating learning rate to 8.74465481e-05
Validation loss decreased (0.5472 --> 0.5355).  Saving model state dict ...
Epoch: 4 cost time: 1.0240488052368164
Epoch: 4, Steps: 123 | Train Loss: 0.6045430 Vali Loss: 0.5354999 Best vali loss: 0.5354999
	iters: 100, epoch: 5 | loss: 0.8493768
	speed: 0.0095s/iter; left time: 3.7291s
Updating learning rate to 5.3982202924613086e-05
Validation loss decreased (0.5355 --> 0.5304).  Saving model state dict ...
Epoch: 5 cost time: 0.716310977935791
Epoch: 5, Steps: 123 | Train Loss: 0.8493768 Vali Loss: 0.5303669 Best vali loss: 0.5303669
	iters: 100, epoch: 6 | loss: 0.8025255
	speed: 0.0092s/iter; left time: 2.4792s
Updating learning rate to 2.5612500947134402e-05
Epoch: 6 cost time: 0.7166132926940918
Epoch: 6, Steps: 123 | Train Loss: 0.8025255 Vali Loss: 0.5315779 Best vali loss: 0.5303669
	iters: 100, epoch: 7 | loss: 0.4773991
	speed: 0.0090s/iter; left time: 1.3166s
Updating learning rate to 6.65647212164625e-06
Validation loss decreased (0.5304 --> 0.5303).  Saving model state dict ...
Epoch: 7 cost time: 0.7159104347229004
Epoch: 7, Steps: 123 | Train Loss: 0.4773991 Vali Loss: 0.5303273 Best vali loss: 0.5303273
	iters: 100, epoch: 8 | loss: 0.5510187
	speed: 0.0093s/iter; left time: 0.2240s
Updating learning rate to 0.0
Validation loss decreased (0.5303 --> 0.5263).  Saving model state dict ...
Epoch: 8 cost time: 0.7165896892547607
Epoch: 8, Steps: 123 | Train Loss: 0.5510187 Vali Loss: 0.5262609 Best vali loss: 0.5262609

best validation loss 0.5262608543858932

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010098376571, 'e_layers': 2, 'learning_rate': 0.0008960480889, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000861944289190282
Validation loss decreased (inf --> 0.6159).  Saving model state dict ...
Epoch: 1 cost time: 0.7523150444030762
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6159417 Best vali loss: 0.6159417
Updating learning rate to 0.0007648248844152181
Epoch: 2 cost time: 0.46047472953796387
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6286611 Best vali loss: 0.6159417
Updating learning rate to 0.0006194754235622155
Validation loss decreased (0.6159 --> 0.5904).  Saving model state dict ...
Epoch: 3 cost time: 0.4567246437072754
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5903799 Best vali loss: 0.5903799
Updating learning rate to 0.00044802404445
Validation loss decreased (0.5904 --> 0.5778).  Saving model state dict ...
Epoch: 4 cost time: 0.4569661617279053
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5777782 Best vali loss: 0.5777782
Updating learning rate to 0.0002765726653377845
Epoch: 5 cost time: 0.45346665382385254
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5867587 Best vali loss: 0.5777782
Updating learning rate to 0.00013122320448478184
Epoch: 6 cost time: 0.4509303569793701
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5876885 Best vali loss: 0.5777782
Updating learning rate to 3.410379970971805e-05
Epoch: 7 cost time: 0.4502072334289551
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5986547 Best vali loss: 0.5777782
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45650553703308105
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5982122 Best vali loss: 0.5777782

best validation loss 0.5777782376912499

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0018396560006, 'e_layers': 4, 'learning_rate': 0.0048794613533, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5094667
	speed: 0.0110s/iter; left time: 84.7203s
	iters: 200, epoch: 1 | loss: 0.4513274
	speed: 0.0052s/iter; left time: 39.3846s
	iters: 300, epoch: 1 | loss: 0.8081921
	speed: 0.0052s/iter; left time: 38.8769s
	iters: 400, epoch: 1 | loss: 2.0294383
	speed: 0.0051s/iter; left time: 38.0114s
	iters: 500, epoch: 1 | loss: 0.5723832
	speed: 0.0051s/iter; left time: 37.4636s
	iters: 600, epoch: 1 | loss: 0.7657400
	speed: 0.0052s/iter; left time: 37.5274s
	iters: 700, epoch: 1 | loss: 1.6180369
	speed: 0.0052s/iter; left time: 36.7840s
	iters: 800, epoch: 1 | loss: 1.0547323
	speed: 0.0051s/iter; left time: 35.5678s
	iters: 900, epoch: 1 | loss: 1.3552412
	speed: 0.0051s/iter; left time: 35.4061s
Updating learning rate to 0.0048794613533
Validation loss decreased (inf --> 0.6292).  Saving model state dict ...
Epoch: 1 cost time: 5.346718788146973
Epoch: 1, Steps: 979 | Train Loss: 1.0182842 Vali Loss: 0.6291899 Best vali loss: 0.6291899
	iters: 100, epoch: 2 | loss: 0.8549617
	speed: 0.0154s/iter; left time: 104.2800s
	iters: 200, epoch: 2 | loss: 0.5577422
	speed: 0.0051s/iter; left time: 34.1587s
	iters: 300, epoch: 2 | loss: 0.5984073
	speed: 0.0050s/iter; left time: 33.0092s
	iters: 400, epoch: 2 | loss: 0.8320480
	speed: 0.0051s/iter; left time: 32.8427s
	iters: 500, epoch: 2 | loss: 0.8606473
	speed: 0.0052s/iter; left time: 33.0049s
	iters: 600, epoch: 2 | loss: 0.7214935
	speed: 0.0052s/iter; left time: 32.6969s
	iters: 700, epoch: 2 | loss: 0.7625507
	speed: 0.0052s/iter; left time: 32.1955s
	iters: 800, epoch: 2 | loss: 1.1356610
	speed: 0.0052s/iter; left time: 31.2957s
	iters: 900, epoch: 2 | loss: 0.4534232
	speed: 0.0051s/iter; left time: 30.5596s
Updating learning rate to 0.00243973067665
Epoch: 2 cost time: 5.087880611419678
Epoch: 2, Steps: 979 | Train Loss: 0.7529928 Vali Loss: 0.6386103 Best vali loss: 0.6291899
	iters: 100, epoch: 3 | loss: 0.9650510
	speed: 0.0152s/iter; left time: 87.8830s
	iters: 200, epoch: 3 | loss: 1.0366280
	speed: 0.0050s/iter; left time: 28.1723s
	iters: 300, epoch: 3 | loss: 0.3392309
	speed: 0.0049s/iter; left time: 27.0803s
	iters: 400, epoch: 3 | loss: 0.3314684
	speed: 0.0048s/iter; left time: 26.5175s
	iters: 500, epoch: 3 | loss: 0.5196182
	speed: 0.0049s/iter; left time: 26.3709s
	iters: 600, epoch: 3 | loss: 0.5892966
	speed: 0.0049s/iter; left time: 25.9438s
	iters: 700, epoch: 3 | loss: 0.5572417
	speed: 0.0050s/iter; left time: 25.7094s
	iters: 800, epoch: 3 | loss: 0.9206284
	speed: 0.0049s/iter; left time: 24.7988s
	iters: 900, epoch: 3 | loss: 0.6372389
	speed: 0.0048s/iter; left time: 24.0308s
Updating learning rate to 0.001219865338325
Epoch: 3 cost time: 4.826843976974487
Epoch: 3, Steps: 979 | Train Loss: 0.6551558 Vali Loss: 0.6422793 Best vali loss: 0.6291899
	iters: 100, epoch: 4 | loss: 0.3262146
	speed: 0.0150s/iter; left time: 72.0977s
	iters: 200, epoch: 4 | loss: 0.5166015
	speed: 0.0049s/iter; left time: 22.9702s
	iters: 300, epoch: 4 | loss: 1.0492892
	speed: 0.0048s/iter; left time: 22.1670s
	iters: 400, epoch: 4 | loss: 1.3085166
	speed: 0.0047s/iter; left time: 20.9344s
	iters: 500, epoch: 4 | loss: 0.9075557
	speed: 0.0046s/iter; left time: 20.3616s
	iters: 600, epoch: 4 | loss: 1.1256918
	speed: 0.0047s/iter; left time: 20.3474s
	iters: 700, epoch: 4 | loss: 1.3190249
	speed: 0.0047s/iter; left time: 19.7670s
	iters: 800, epoch: 4 | loss: 0.6639515
	speed: 0.0049s/iter; left time: 20.2501s
	iters: 900, epoch: 4 | loss: 0.2841168
	speed: 0.0049s/iter; left time: 19.5672s
Updating learning rate to 0.0006099326691625
Epoch: 4 cost time: 4.759317398071289
Epoch: 4, Steps: 979 | Train Loss: 0.8334403 Vali Loss: 0.6460125 Best vali loss: 0.6291899
	iters: 100, epoch: 5 | loss: 0.9770398
	speed: 0.0161s/iter; left time: 61.3979s
	iters: 200, epoch: 5 | loss: 0.5331107
	speed: 0.0051s/iter; left time: 18.9666s
	iters: 300, epoch: 5 | loss: 1.5415077
	speed: 0.0052s/iter; left time: 18.7446s
	iters: 400, epoch: 5 | loss: 0.2851972
	speed: 0.0051s/iter; left time: 17.8001s
	iters: 500, epoch: 5 | loss: 0.9994576
	speed: 0.0052s/iter; left time: 17.7860s
	iters: 600, epoch: 5 | loss: 1.1541374
	speed: 0.0052s/iter; left time: 17.2160s
	iters: 700, epoch: 5 | loss: 0.3732120
	speed: 0.0051s/iter; left time: 16.3994s
	iters: 800, epoch: 5 | loss: 1.1527137
	speed: 0.0051s/iter; left time: 15.7768s
	iters: 900, epoch: 5 | loss: 0.9895814
	speed: 0.0050s/iter; left time: 15.0472s
Updating learning rate to 0.00030496633458125
Epoch: 5 cost time: 5.0629894733428955
Epoch: 5, Steps: 979 | Train Loss: 0.8895508 Vali Loss: 0.6439410 Best vali loss: 0.6291899
	iters: 100, epoch: 6 | loss: 0.4888468
	speed: 0.0156s/iter; left time: 44.1615s
	iters: 200, epoch: 6 | loss: 0.4186351
	speed: 0.0051s/iter; left time: 13.9411s
	iters: 300, epoch: 6 | loss: 0.4807253
	speed: 0.0049s/iter; left time: 13.0107s
	iters: 400, epoch: 6 | loss: 0.5860158
	speed: 0.0049s/iter; left time: 12.4265s
	iters: 500, epoch: 6 | loss: 1.0749320
	speed: 0.0050s/iter; left time: 12.2072s
	iters: 600, epoch: 6 | loss: 0.2960832
	speed: 0.0050s/iter; left time: 11.7655s
	iters: 700, epoch: 6 | loss: 1.4347982
	speed: 0.0051s/iter; left time: 11.4135s
	iters: 800, epoch: 6 | loss: 0.3897060
	speed: 0.0051s/iter; left time: 10.8996s
	iters: 900, epoch: 6 | loss: 0.5782563
	speed: 0.0051s/iter; left time: 10.4395s
Updating learning rate to 0.000152483167290625
Epoch: 6 cost time: 5.00905966758728
Epoch: 6, Steps: 979 | Train Loss: 0.6386665 Vali Loss: 0.6439052 Best vali loss: 0.6291899
	iters: 100, epoch: 7 | loss: 0.6909391
	speed: 0.0154s/iter; left time: 28.5769s
	iters: 200, epoch: 7 | loss: 0.8328561
	speed: 0.0051s/iter; left time: 8.9802s
	iters: 300, epoch: 7 | loss: 1.7782965
	speed: 0.0052s/iter; left time: 8.5481s
	iters: 400, epoch: 7 | loss: 1.4975898
	speed: 0.0051s/iter; left time: 8.0059s
	iters: 500, epoch: 7 | loss: 0.6318460
	speed: 0.0051s/iter; left time: 7.4675s
	iters: 600, epoch: 7 | loss: 0.6512015
	speed: 0.0052s/iter; left time: 7.0245s
	iters: 700, epoch: 7 | loss: 0.7233452
	speed: 0.0051s/iter; left time: 6.4729s
	iters: 800, epoch: 7 | loss: 0.7280883
	speed: 0.0051s/iter; left time: 5.9473s
	iters: 900, epoch: 7 | loss: 0.5818325
	speed: 0.0052s/iter; left time: 5.4617s
Updating learning rate to 7.62415836453125e-05
Epoch: 7 cost time: 5.0877602100372314
Epoch: 7, Steps: 979 | Train Loss: 0.9017772 Vali Loss: 0.6436808 Best vali loss: 0.6291899
	iters: 100, epoch: 8 | loss: 0.5712171
	speed: 0.0155s/iter; left time: 13.6331s
	iters: 200, epoch: 8 | loss: 0.8846658
	speed: 0.0050s/iter; left time: 3.9180s
	iters: 300, epoch: 8 | loss: 0.4935690
	speed: 0.0050s/iter; left time: 3.4147s
	iters: 400, epoch: 8 | loss: 0.4549169
	speed: 0.0050s/iter; left time: 2.9107s
	iters: 500, epoch: 8 | loss: 1.0257168
	speed: 0.0050s/iter; left time: 2.4165s
	iters: 600, epoch: 8 | loss: 0.4445557
	speed: 0.0050s/iter; left time: 1.9075s
	iters: 700, epoch: 8 | loss: 0.7190539
	speed: 0.0050s/iter; left time: 1.4035s
	iters: 800, epoch: 8 | loss: 0.6194480
	speed: 0.0049s/iter; left time: 0.8790s
	iters: 900, epoch: 8 | loss: 1.2065091
	speed: 0.0048s/iter; left time: 0.3859s
Updating learning rate to 3.812079182265625e-05
Epoch: 8 cost time: 4.919890642166138
Epoch: 8, Steps: 979 | Train Loss: 0.7132947 Vali Loss: 0.6436521 Best vali loss: 0.6291899

best validation loss 0.6291899078149368

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010623024887, 'e_layers': 2, 'learning_rate': 0.0004673913384, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0285654
	speed: 0.0099s/iter; left time: 37.9592s
	iters: 200, epoch: 1 | loss: 0.6649954
	speed: 0.0036s/iter; left time: 13.5768s
	iters: 300, epoch: 1 | loss: 1.3476850
	speed: 0.0037s/iter; left time: 13.3650s
	iters: 400, epoch: 1 | loss: 1.1762136
	speed: 0.0035s/iter; left time: 12.2476s
Updating learning rate to 0.00044960231481040833
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 2.1119470596313477
Epoch: 1, Steps: 490 | Train Loss: 1.0543649 Vali Loss: 0.6207681 Best vali loss: 0.6207681
	iters: 100, epoch: 2 | loss: 1.4665228
	speed: 0.0100s/iter; left time: 33.4629s
	iters: 200, epoch: 2 | loss: 1.2820107
	speed: 0.0035s/iter; left time: 11.1795s
	iters: 300, epoch: 2 | loss: 1.2853218
	speed: 0.0035s/iter; left time: 10.8136s
	iters: 400, epoch: 2 | loss: 0.9134177
	speed: 0.0035s/iter; left time: 10.5462s
Updating learning rate to 0.0003989434616252482
Epoch: 2 cost time: 1.7592120170593262
Epoch: 2, Steps: 490 | Train Loss: 1.2368183 Vali Loss: 0.6245611 Best vali loss: 0.6207681
	iters: 100, epoch: 3 | loss: 0.6193513
	speed: 0.0103s/iter; left time: 29.1921s
	iters: 200, epoch: 3 | loss: 0.6291409
	speed: 0.0037s/iter; left time: 10.1654s
	iters: 300, epoch: 3 | loss: 0.9001562
	speed: 0.0035s/iter; left time: 9.2982s
	iters: 400, epoch: 3 | loss: 0.8481047
	speed: 0.0036s/iter; left time: 9.0375s
Updating learning rate to 0.0003231271300183126
Epoch: 3 cost time: 1.8278322219848633
Epoch: 3, Steps: 490 | Train Loss: 0.7491883 Vali Loss: 0.6323824 Best vali loss: 0.6207681

best validation loss 0.6207680842601718

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001761447582, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617202
	speed: 0.0115s/iter; left time: 10.2217s
Updating learning rate to 0.00016944064753006484
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.020031213760376
Epoch: 1, Steps: 123 | Train Loss: 0.7617202 Vali Loss: 0.6075992 Best vali loss: 0.6075992
	iters: 100, epoch: 2 | loss: 0.9370862
	speed: 0.0093s/iter; left time: 7.0652s
Updating learning rate to 0.00015034895559684237
Validation loss decreased (0.6076 --> 0.5747).  Saving model state dict ...
Epoch: 2 cost time: 0.7182180881500244
Epoch: 2, Steps: 123 | Train Loss: 0.9370862 Vali Loss: 0.5747005 Best vali loss: 0.5747005
	iters: 100, epoch: 3 | loss: 0.8572872
	speed: 0.0093s/iter; left time: 5.9529s
Updating learning rate to 0.0001217762194305474
Validation loss decreased (0.5747 --> 0.5499).  Saving model state dict ...
Epoch: 3 cost time: 0.7188189029693604
Epoch: 3, Steps: 123 | Train Loss: 0.8572872 Vali Loss: 0.5498871 Best vali loss: 0.5498871

best validation loss 0.5498871449406971

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0049319088651, 'e_layers': 2, 'learning_rate': 0.0004704935207, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0281268
	speed: 0.0098s/iter; left time: 37.3373s
	iters: 200, epoch: 1 | loss: 0.6570837
	speed: 0.0036s/iter; left time: 13.5500s
	iters: 300, epoch: 1 | loss: 1.3293818
	speed: 0.0036s/iter; left time: 12.9726s
	iters: 400, epoch: 1 | loss: 0.9569995
	speed: 0.0035s/iter; left time: 12.4486s
Updating learning rate to 0.0004525864273269527
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 2.0945050716400146
Epoch: 1, Steps: 490 | Train Loss: 0.9928980 Vali Loss: 0.6098352 Best vali loss: 0.6098352
	iters: 100, epoch: 2 | loss: 1.5539187
	speed: 0.0099s/iter; left time: 32.8474s
	iters: 200, epoch: 2 | loss: 1.3701377
	speed: 0.0035s/iter; left time: 11.2738s
	iters: 300, epoch: 2 | loss: 1.2127415
	speed: 0.0034s/iter; left time: 10.6363s
	iters: 400, epoch: 2 | loss: 0.9078025
	speed: 0.0034s/iter; left time: 10.3237s
Updating learning rate to 0.0004015913398456516
Epoch: 2 cost time: 1.7179851531982422
Epoch: 2, Steps: 490 | Train Loss: 1.2611501 Vali Loss: 0.6216432 Best vali loss: 0.6098352
	iters: 100, epoch: 3 | loss: 0.5879476
	speed: 0.0096s/iter; left time: 27.1822s
	iters: 200, epoch: 3 | loss: 0.5872990
	speed: 0.0032s/iter; left time: 8.8363s
	iters: 300, epoch: 3 | loss: 0.8734490
	speed: 0.0033s/iter; left time: 8.7864s
	iters: 400, epoch: 3 | loss: 0.6705443
	speed: 0.0032s/iter; left time: 8.1549s
Updating learning rate to 0.00032527179805350574
Epoch: 3 cost time: 1.647463083267212
Epoch: 3, Steps: 490 | Train Loss: 0.6798100 Vali Loss: 0.6253622 Best vali loss: 0.6098352

best validation loss 0.6098352327273985

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001761447582, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5965640
	speed: 0.0120s/iter; left time: 6.1777s
Updating learning rate to 8.80723791e-05
Validation loss decreased (0.5499 --> 0.5320).  Saving model state dict ...
Epoch: 4 cost time: 1.0193841457366943
Epoch: 4, Steps: 123 | Train Loss: 0.5965640 Vali Loss: 0.5319592 Best vali loss: 0.5319592
	iters: 100, epoch: 5 | loss: 0.8459229
	speed: 0.0094s/iter; left time: 3.6930s
Updating learning rate to 5.436853876945261e-05
Validation loss decreased (0.5320 --> 0.5292).  Saving model state dict ...
Epoch: 5 cost time: 0.7233281135559082
Epoch: 5, Steps: 123 | Train Loss: 0.8459229 Vali Loss: 0.5291654 Best vali loss: 0.5291654
	iters: 100, epoch: 6 | loss: 0.8005192
	speed: 0.0093s/iter; left time: 2.5232s
Updating learning rate to 2.5795802603157644e-05
Validation loss decreased (0.5292 --> 0.5291).  Saving model state dict ...
Epoch: 6 cost time: 0.7237074375152588
Epoch: 6, Steps: 123 | Train Loss: 0.8005192 Vali Loss: 0.5290868 Best vali loss: 0.5290868
	iters: 100, epoch: 7 | loss: 0.4803317
	speed: 0.0093s/iter; left time: 1.3683s
Updating learning rate to 6.70411066993518e-06
Epoch: 7 cost time: 0.728003978729248
Epoch: 7, Steps: 123 | Train Loss: 0.4803317 Vali Loss: 0.5293413 Best vali loss: 0.5290868
	iters: 100, epoch: 8 | loss: 0.5518163
	speed: 0.0090s/iter; left time: 0.2148s
Updating learning rate to 0.0
Validation loss decreased (0.5291 --> 0.5249).  Saving model state dict ...
Epoch: 8 cost time: 0.7175891399383545
Epoch: 8, Steps: 123 | Train Loss: 0.5518163 Vali Loss: 0.5248901 Best vali loss: 0.5248901

best validation loss 0.5248901219568778

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045288169067, 'e_layers': 2, 'learning_rate': 9.51355988e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7495680
	speed: 0.0116s/iter; left time: 10.2970s
Updating learning rate to 9.151471567226267e-05
Validation loss decreased (inf --> 0.6010).  Saving model state dict ...
Epoch: 1 cost time: 1.0268151760101318
Epoch: 1, Steps: 123 | Train Loss: 0.7495680 Vali Loss: 0.6009811 Best vali loss: 0.6009811
	iters: 100, epoch: 2 | loss: 0.9520339
	speed: 0.0093s/iter; left time: 7.0602s
Updating learning rate to 8.120331292186138e-05
Epoch: 2 cost time: 0.7291567325592041
Epoch: 2, Steps: 123 | Train Loss: 0.9520339 Vali Loss: 0.6032272 Best vali loss: 0.6009811
	iters: 100, epoch: 3 | loss: 0.8854489
	speed: 0.0090s/iter; left time: 5.7207s
Updating learning rate to 6.577120814444606e-05
Validation loss decreased (0.6010 --> 0.5678).  Saving model state dict ...
Epoch: 3 cost time: 0.7168397903442383
Epoch: 3, Steps: 123 | Train Loss: 0.8854489 Vali Loss: 0.5677504 Best vali loss: 0.5677504
	iters: 100, epoch: 4 | loss: 0.5051827
	speed: 0.0094s/iter; left time: 4.8653s
Updating learning rate to 4.75677994e-05
Validation loss decreased (0.5678 --> 0.5471).  Saving model state dict ...
Epoch: 4 cost time: 0.7174105644226074
Epoch: 4, Steps: 123 | Train Loss: 0.5051827 Vali Loss: 0.5470634 Best vali loss: 0.5470634
	iters: 100, epoch: 5 | loss: 0.5940746
	speed: 0.0093s/iter; left time: 3.6518s
Updating learning rate to 2.9364390655553945e-05
Validation loss decreased (0.5471 --> 0.5469).  Saving model state dict ...
Epoch: 5 cost time: 0.7216536998748779
Epoch: 5, Steps: 123 | Train Loss: 0.5940746 Vali Loss: 0.5468836 Best vali loss: 0.5468836
	iters: 100, epoch: 6 | loss: 0.6301358
	speed: 0.0092s/iter; left time: 2.4973s
Updating learning rate to 1.3932285878138615e-05
Validation loss decreased (0.5469 --> 0.5379).  Saving model state dict ...
Epoch: 6 cost time: 0.7177677154541016
Epoch: 6, Steps: 123 | Train Loss: 0.6301358 Vali Loss: 0.5379100 Best vali loss: 0.5379100
	iters: 100, epoch: 7 | loss: 0.6177700
	speed: 0.0093s/iter; left time: 1.3680s
Updating learning rate to 3.620883127737334e-06
Validation loss decreased (0.5379 --> 0.5371).  Saving model state dict ...
Epoch: 7 cost time: 0.7180488109588623
Epoch: 7, Steps: 123 | Train Loss: 0.6177700 Vali Loss: 0.5371118 Best vali loss: 0.5371118
	iters: 100, epoch: 8 | loss: 0.7742977
	speed: 0.0093s/iter; left time: 0.2239s
Updating learning rate to 0.0
Validation loss decreased (0.5371 --> 0.5354).  Saving model state dict ...
Epoch: 8 cost time: 0.7281880378723145
Epoch: 8, Steps: 123 | Train Loss: 0.7742977 Vali Loss: 0.5353508 Best vali loss: 0.5353508

best validation loss 0.5353508099037869

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0079187711832, 'e_layers': 2, 'learning_rate': 0.0001000168613, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7503439
	speed: 0.0116s/iter; left time: 10.2464s
Updating learning rate to 9.62101961805451e-05
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 1.021425485610962
Epoch: 1, Steps: 123 | Train Loss: 0.7503439 Vali Loss: 0.6012289 Best vali loss: 0.6012289
	iters: 100, epoch: 2 | loss: 0.9510216
	speed: 0.0092s/iter; left time: 6.9789s
Updating learning rate to 8.536973107911218e-05
Epoch: 2 cost time: 0.7191057205200195
Epoch: 2, Steps: 123 | Train Loss: 0.9510216 Vali Loss: 0.6033971 Best vali loss: 0.6012289
	iters: 100, epoch: 3 | loss: 0.8809258
	speed: 0.0089s/iter; left time: 5.7170s
Updating learning rate to 6.914582853833357e-05
Validation loss decreased (0.6012 --> 0.5658).  Saving model state dict ...
Epoch: 3 cost time: 0.716677188873291
Epoch: 3, Steps: 123 | Train Loss: 0.8809258 Vali Loss: 0.5658066 Best vali loss: 0.5658066
	iters: 100, epoch: 4 | loss: 0.5060872
	speed: 0.0094s/iter; left time: 4.8482s
Updating learning rate to 5.000843065e-05
Validation loss decreased (0.5658 --> 0.5486).  Saving model state dict ...
Epoch: 4 cost time: 0.7190892696380615
Epoch: 4, Steps: 123 | Train Loss: 0.5060872 Vali Loss: 0.5486183 Best vali loss: 0.5486183
	iters: 100, epoch: 5 | loss: 0.6016878
	speed: 0.0092s/iter; left time: 3.6178s
Updating learning rate to 3.087103276166644e-05
Validation loss decreased (0.5486 --> 0.5461).  Saving model state dict ...
Epoch: 5 cost time: 0.7159698009490967
Epoch: 5, Steps: 123 | Train Loss: 0.6016878 Vali Loss: 0.5461489 Best vali loss: 0.5461489
	iters: 100, epoch: 6 | loss: 0.6372889
	speed: 0.0092s/iter; left time: 2.4934s
Updating learning rate to 1.4647130220887817e-05
Validation loss decreased (0.5461 --> 0.5440).  Saving model state dict ...
Epoch: 6 cost time: 0.7220678329467773
Epoch: 6, Steps: 123 | Train Loss: 0.6372889 Vali Loss: 0.5439794 Best vali loss: 0.5439794
	iters: 100, epoch: 7 | loss: 0.6169595
	speed: 0.0093s/iter; left time: 1.3638s
Updating learning rate to 3.806665119454897e-06
Validation loss decreased (0.5440 --> 0.5402).  Saving model state dict ...
Epoch: 7 cost time: 0.7215797901153564
Epoch: 7, Steps: 123 | Train Loss: 0.6169595 Vali Loss: 0.5401846 Best vali loss: 0.5401846
	iters: 100, epoch: 8 | loss: 0.7714928
	speed: 0.0093s/iter; left time: 0.2226s
Updating learning rate to 0.0
Validation loss decreased (0.5402 --> 0.5378).  Saving model state dict ...
Epoch: 8 cost time: 0.7132353782653809
Epoch: 8, Steps: 123 | Train Loss: 0.7714928 Vali Loss: 0.5377957 Best vali loss: 0.5377957

best validation loss 0.537795653253835

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0027179334397, 'e_layers': 2, 'learning_rate': 0.0004622861236, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004446914056790114
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.8371732234954834
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5942564 Best vali loss: 0.5942564
Updating learning rate to 0.0003945858882230012
Validation loss decreased (0.5943 --> 0.5643).  Saving model state dict ...
Epoch: 2 cost time: 0.5392601490020752
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5642595 Best vali loss: 0.5642595
Updating learning rate to 0.0003195976820570001
Epoch: 3 cost time: 0.5373039245605469
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6042540 Best vali loss: 0.5642595

best validation loss 0.5642594620344099

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0119373694861, 'e_layers': 1, 'learning_rate': 0.0007279755826, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8133091
	speed: 0.0099s/iter; left time: 8.7587s
Updating learning rate to 0.0007002686617660598
Validation loss decreased (inf --> 0.6170).  Saving model state dict ...
Epoch: 1 cost time: 0.7962446212768555
Epoch: 1, Steps: 123 | Train Loss: 0.8133091 Vali Loss: 0.6169771 Best vali loss: 0.6169771
	iters: 100, epoch: 2 | loss: 0.6869106
	speed: 0.0065s/iter; left time: 4.9434s
Updating learning rate to 0.0006213660267973438
Validation loss decreased (0.6170 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 0.47769951820373535
Epoch: 2, Steps: 123 | Train Loss: 0.6869106 Vali Loss: 0.6048239 Best vali loss: 0.6048239
	iters: 100, epoch: 3 | loss: 0.8797313
	speed: 0.0064s/iter; left time: 4.1116s
Updating learning rate to 0.0005032798886136719
Validation loss decreased (0.6048 --> 0.5987).  Saving model state dict ...
Epoch: 3 cost time: 0.48072123527526855
Epoch: 3, Steps: 123 | Train Loss: 0.8797313 Vali Loss: 0.5986850 Best vali loss: 0.5986850

best validation loss 0.5986850415044005

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010493149738, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744235
	speed: 0.0118s/iter; left time: 10.4509s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.025463581085205
Epoch: 1, Steps: 123 | Train Loss: 0.7744235 Vali Loss: 0.6173679 Best vali loss: 0.6173679
	iters: 100, epoch: 2 | loss: 0.9520103
	speed: 0.0092s/iter; left time: 7.0316s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6174 --> 0.5679).  Saving model state dict ...
Epoch: 2 cost time: 0.7191123962402344
Epoch: 2, Steps: 123 | Train Loss: 0.9520103 Vali Loss: 0.5678547 Best vali loss: 0.5678547
	iters: 100, epoch: 3 | loss: 0.8559514
	speed: 0.0093s/iter; left time: 5.9552s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5679 --> 0.5404).  Saving model state dict ...
Epoch: 3 cost time: 0.722041130065918
Epoch: 3, Steps: 123 | Train Loss: 0.8559514 Vali Loss: 0.5403680 Best vali loss: 0.5403680

best validation loss 0.5403679869396716

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010493149738, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5874576
	speed: 0.0121s/iter; left time: 6.2521s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5404 --> 0.5287).  Saving model state dict ...
Epoch: 4 cost time: 1.0238497257232666
Epoch: 4, Steps: 123 | Train Loss: 0.5874576 Vali Loss: 0.5287307 Best vali loss: 0.5287307
	iters: 100, epoch: 5 | loss: 0.8250266
	speed: 0.0092s/iter; left time: 3.6174s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5287 --> 0.5284).  Saving model state dict ...
Epoch: 5 cost time: 0.7165622711181641
Epoch: 5, Steps: 123 | Train Loss: 0.8250266 Vali Loss: 0.5283914 Best vali loss: 0.5283914
	iters: 100, epoch: 6 | loss: 0.7623099
	speed: 0.0093s/iter; left time: 2.5191s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7184116840362549
Epoch: 6, Steps: 123 | Train Loss: 0.7623099 Vali Loss: 0.5362630 Best vali loss: 0.5283914
	iters: 100, epoch: 7 | loss: 0.4331748
	speed: 0.0089s/iter; left time: 1.3121s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7205326557159424
Epoch: 7, Steps: 123 | Train Loss: 0.4331748 Vali Loss: 0.5513763 Best vali loss: 0.5283914
	iters: 100, epoch: 8 | loss: 0.5028912
	speed: 0.0090s/iter; left time: 0.2162s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7165508270263672
Epoch: 8, Steps: 123 | Train Loss: 0.5028912 Vali Loss: 0.5509411 Best vali loss: 0.5283914

best validation loss 0.5283914076570337

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013499715416, 'e_layers': 3, 'learning_rate': 0.0003063326576, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6180565
	speed: 0.0140s/iter; left time: 12.3839s
Updating learning rate to 0.0003063326576
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.3017518520355225
Epoch: 1, Steps: 123 | Train Loss: 0.6180565 Vali Loss: 0.6174478 Best vali loss: 0.6174478
	iters: 100, epoch: 2 | loss: 0.7462658
	speed: 0.0124s/iter; left time: 9.4425s
Updating learning rate to 0.0001531663288
Validation loss decreased (0.6174 --> 0.6161).  Saving model state dict ...
Epoch: 2 cost time: 1.006486415863037
Epoch: 2, Steps: 123 | Train Loss: 0.7462658 Vali Loss: 0.6160890 Best vali loss: 0.6160890
	iters: 100, epoch: 3 | loss: 0.6265246
	speed: 0.0125s/iter; left time: 7.9964s
Updating learning rate to 7.65831644e-05
Validation loss decreased (0.6161 --> 0.5524).  Saving model state dict ...
Epoch: 3 cost time: 1.0021464824676514
Epoch: 3, Steps: 123 | Train Loss: 0.6265246 Vali Loss: 0.5523612 Best vali loss: 0.5523612
	iters: 100, epoch: 4 | loss: 0.8449311
	speed: 0.0126s/iter; left time: 6.4855s
Updating learning rate to 3.82915822e-05
Validation loss decreased (0.5524 --> 0.5459).  Saving model state dict ...
Epoch: 4 cost time: 1.006253957748413
Epoch: 4, Steps: 123 | Train Loss: 0.8449311 Vali Loss: 0.5459394 Best vali loss: 0.5459394
	iters: 100, epoch: 5 | loss: 0.6879957
	speed: 0.0126s/iter; left time: 4.9327s
Updating learning rate to 1.91457911e-05
Validation loss decreased (0.5459 --> 0.5422).  Saving model state dict ...
Epoch: 5 cost time: 1.002634048461914
Epoch: 5, Steps: 123 | Train Loss: 0.6879957 Vali Loss: 0.5421752 Best vali loss: 0.5421752
	iters: 100, epoch: 6 | loss: 0.4774697
	speed: 0.0126s/iter; left time: 3.4017s
Updating learning rate to 9.57289555e-06
Epoch: 6 cost time: 1.0122947692871094
Epoch: 6, Steps: 123 | Train Loss: 0.4774697 Vali Loss: 0.5428014 Best vali loss: 0.5421752
	iters: 100, epoch: 7 | loss: 0.8342924
	speed: 0.0121s/iter; left time: 1.7852s
Updating learning rate to 4.786447775e-06
Epoch: 7 cost time: 1.0012571811676025
Epoch: 7, Steps: 123 | Train Loss: 0.8342924 Vali Loss: 0.5436718 Best vali loss: 0.5421752
	iters: 100, epoch: 8 | loss: 0.7191754
	speed: 0.0121s/iter; left time: 0.2897s
Updating learning rate to 2.3932238875e-06
Validation loss decreased (0.5422 --> 0.5417).  Saving model state dict ...
Epoch: 8 cost time: 0.999793291091919
Epoch: 8, Steps: 123 | Train Loss: 0.7191754 Vali Loss: 0.5416619 Best vali loss: 0.5416619

best validation loss 0.5416619411115016

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0047856662184, 'e_layers': 2, 'learning_rate': 0.0016412673739, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4169066
	speed: 0.0099s/iter; left time: 37.9176s
	iters: 200, epoch: 1 | loss: 0.9121279
	speed: 0.0038s/iter; left time: 13.9674s
	iters: 300, epoch: 1 | loss: 0.6505529
	speed: 0.0037s/iter; left time: 13.2302s
	iters: 400, epoch: 1 | loss: 0.5641685
	speed: 0.0037s/iter; left time: 12.9681s
Updating learning rate to 0.0015788003540123797
Validation loss decreased (inf --> 0.6196).  Saving model state dict ...
Epoch: 1 cost time: 2.1546177864074707
Epoch: 1, Steps: 490 | Train Loss: 0.8859390 Vali Loss: 0.6195611 Best vali loss: 0.6195611
	iters: 100, epoch: 2 | loss: 0.9877516
	speed: 0.0102s/iter; left time: 33.9142s
	iters: 200, epoch: 2 | loss: 0.4369037
	speed: 0.0033s/iter; left time: 10.7054s
	iters: 300, epoch: 2 | loss: 0.8097774
	speed: 0.0033s/iter; left time: 10.1910s
	iters: 400, epoch: 2 | loss: 0.5193955
	speed: 0.0032s/iter; left time: 9.7266s
Updating learning rate to 0.0014009093318624634
Validation loss decreased (0.6196 --> 0.6154).  Saving model state dict ...
Epoch: 2 cost time: 1.6526329517364502
Epoch: 2, Steps: 490 | Train Loss: 0.6884570 Vali Loss: 0.6154460 Best vali loss: 0.6154460
	iters: 100, epoch: 3 | loss: 0.2961121
	speed: 0.0094s/iter; left time: 26.8299s
	iters: 200, epoch: 3 | loss: 0.9335402
	speed: 0.0032s/iter; left time: 8.8986s
	iters: 300, epoch: 3 | loss: 0.6960177
	speed: 0.0033s/iter; left time: 8.6054s
	iters: 400, epoch: 3 | loss: 0.7456956
	speed: 0.0030s/iter; left time: 7.7374s
Updating learning rate to 0.0011346766029864447
Epoch: 3 cost time: 1.6170411109924316
Epoch: 3, Steps: 490 | Train Loss: 0.6678414 Vali Loss: 0.6199560 Best vali loss: 0.6154460
	iters: 100, epoch: 4 | loss: 0.6385427
	speed: 0.0094s/iter; left time: 22.0318s
	iters: 200, epoch: 4 | loss: 0.6741509
	speed: 0.0032s/iter; left time: 7.2934s
	iters: 300, epoch: 4 | loss: 1.1792524
	speed: 0.0032s/iter; left time: 6.9075s
	iters: 400, epoch: 4 | loss: 1.4026731
	speed: 0.0033s/iter; left time: 6.7078s
Updating learning rate to 0.00082063368695
Epoch: 4 cost time: 1.642671823501587
Epoch: 4, Steps: 490 | Train Loss: 0.9736548 Vali Loss: 0.6261749 Best vali loss: 0.6154460
	iters: 100, epoch: 5 | loss: 0.4814576
	speed: 0.0092s/iter; left time: 17.0859s
	iters: 200, epoch: 5 | loss: 1.0670919
	speed: 0.0032s/iter; left time: 5.5513s
	iters: 300, epoch: 5 | loss: 0.9755927
	speed: 0.0031s/iter; left time: 5.2309s
	iters: 400, epoch: 5 | loss: 0.8713388
	speed: 0.0031s/iter; left time: 4.8445s
Updating learning rate to 0.0005065907709135554
Epoch: 5 cost time: 1.5917575359344482
Epoch: 5, Steps: 490 | Train Loss: 0.8488703 Vali Loss: 0.6562851 Best vali loss: 0.6154460
	iters: 100, epoch: 6 | loss: 1.1223990
	speed: 0.0092s/iter; left time: 12.6355s
	iters: 200, epoch: 6 | loss: 0.6640779
	speed: 0.0031s/iter; left time: 3.9480s
	iters: 300, epoch: 6 | loss: 0.8852133
	speed: 0.0031s/iter; left time: 3.6102s
	iters: 400, epoch: 6 | loss: 0.8907151
	speed: 0.0032s/iter; left time: 3.4157s
Updating learning rate to 0.00024035804203753665
Epoch: 6 cost time: 1.5817248821258545
Epoch: 6, Steps: 490 | Train Loss: 0.8906013 Vali Loss: 0.6632805 Best vali loss: 0.6154460
	iters: 100, epoch: 7 | loss: 1.0528791
	speed: 0.0093s/iter; left time: 8.1535s
	iters: 200, epoch: 7 | loss: 0.4972368
	speed: 0.0031s/iter; left time: 2.4584s
	iters: 300, epoch: 7 | loss: 0.8427847
	speed: 0.0032s/iter; left time: 2.1916s
	iters: 400, epoch: 7 | loss: 0.7319948
	speed: 0.0033s/iter; left time: 1.9421s
Updating learning rate to 6.246701988762037e-05
Epoch: 7 cost time: 1.6326336860656738
Epoch: 7, Steps: 490 | Train Loss: 0.7812239 Vali Loss: 0.6772256 Best vali loss: 0.6154460
	iters: 100, epoch: 8 | loss: 0.4741473
	speed: 0.0100s/iter; left time: 3.8907s
	iters: 200, epoch: 8 | loss: 0.8710861
	speed: 0.0038s/iter; left time: 1.1011s
	iters: 300, epoch: 8 | loss: 0.7050825
	speed: 0.0038s/iter; left time: 0.7282s
	iters: 400, epoch: 8 | loss: 0.8168601
	speed: 0.0037s/iter; left time: 0.3401s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.882828950881958
Epoch: 8, Steps: 490 | Train Loss: 0.7167940 Vali Loss: 0.6789310 Best vali loss: 0.6154460

best validation loss 0.615446022143247

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010058436573, 'e_layers': 2, 'learning_rate': 0.0001132918857, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3753606
	speed: 0.0098s/iter; left time: 75.7359s
	iters: 200, epoch: 1 | loss: 1.3682081
	speed: 0.0036s/iter; left time: 27.6366s
	iters: 300, epoch: 1 | loss: 0.8384320
	speed: 0.0034s/iter; left time: 25.4870s
	iters: 400, epoch: 1 | loss: 1.3906672
	speed: 0.0035s/iter; left time: 26.3485s
	iters: 500, epoch: 1 | loss: 0.9150342
	speed: 0.0034s/iter; left time: 25.1184s
	iters: 600, epoch: 1 | loss: 1.5130879
	speed: 0.0034s/iter; left time: 24.2460s
	iters: 700, epoch: 1 | loss: 0.8126236
	speed: 0.0034s/iter; left time: 24.5568s
	iters: 800, epoch: 1 | loss: 0.7632846
	speed: 0.0034s/iter; left time: 24.2403s
	iters: 900, epoch: 1 | loss: 1.0374960
	speed: 0.0036s/iter; left time: 24.9285s
Updating learning rate to 0.00010897997004891907
Validation loss decreased (inf --> 0.5672).  Saving model state dict ...
Epoch: 1 cost time: 3.7637064456939697
Epoch: 1, Steps: 979 | Train Loss: 1.0015771 Vali Loss: 0.5672224 Best vali loss: 0.5672224
	iters: 100, epoch: 2 | loss: 1.0240469
	speed: 0.0113s/iter; left time: 76.3864s
	iters: 200, epoch: 2 | loss: 0.3027154
	speed: 0.0031s/iter; left time: 20.8766s
	iters: 300, epoch: 2 | loss: 0.4198519
	speed: 0.0032s/iter; left time: 20.9324s
	iters: 400, epoch: 2 | loss: 1.3968039
	speed: 0.0031s/iter; left time: 20.2308s
	iters: 500, epoch: 2 | loss: 0.9493003
	speed: 0.0032s/iter; left time: 20.2223s
	iters: 600, epoch: 2 | loss: 1.8150885
	speed: 0.0032s/iter; left time: 19.9402s
	iters: 700, epoch: 2 | loss: 1.0073152
	speed: 0.0032s/iter; left time: 19.5290s
	iters: 800, epoch: 2 | loss: 0.2540332
	speed: 0.0031s/iter; left time: 18.6753s
	iters: 900, epoch: 2 | loss: 0.8610772
	speed: 0.0031s/iter; left time: 18.3658s
Updating learning rate to 9.670067316594063e-05
Validation loss decreased (0.5672 --> 0.5436).  Saving model state dict ...
Epoch: 2 cost time: 3.1218576431274414
Epoch: 2, Steps: 979 | Train Loss: 0.8922481 Vali Loss: 0.5436062 Best vali loss: 0.5436062
	iters: 100, epoch: 3 | loss: 0.7140924
	speed: 0.0110s/iter; left time: 63.6836s
	iters: 200, epoch: 3 | loss: 0.6589807
	speed: 0.0031s/iter; left time: 17.4417s
	iters: 300, epoch: 3 | loss: 1.1674315
	speed: 0.0031s/iter; left time: 17.2889s
	iters: 400, epoch: 3 | loss: 1.0672268
	speed: 0.0031s/iter; left time: 16.7368s
	iters: 500, epoch: 3 | loss: 0.9484344
	speed: 0.0031s/iter; left time: 16.5793s
	iters: 600, epoch: 3 | loss: 0.4765895
	speed: 0.0031s/iter; left time: 16.2858s
	iters: 700, epoch: 3 | loss: 0.7142804
	speed: 0.0031s/iter; left time: 16.0237s
	iters: 800, epoch: 3 | loss: 1.6670934
	speed: 0.0031s/iter; left time: 15.9755s
	iters: 900, epoch: 3 | loss: 0.2828949
	speed: 0.0032s/iter; left time: 15.7442s
Updating learning rate to 7.832340668939473e-05
Epoch: 3 cost time: 3.0969130992889404
Epoch: 3, Steps: 979 | Train Loss: 0.8552249 Vali Loss: 0.5537570 Best vali loss: 0.5436062

best validation loss 0.543606219358987

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010414282688, 'e_layers': 3, 'learning_rate': 5.08381642e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8863677
	speed: 0.0122s/iter; left time: 10.7551s
Updating learning rate to 4.890325178741402e-05
Validation loss decreased (inf --> 0.6302).  Saving model state dict ...
Epoch: 1 cost time: 1.057133436203003
Epoch: 1, Steps: 123 | Train Loss: 0.8863677 Vali Loss: 0.6301514 Best vali loss: 0.6301514
	iters: 100, epoch: 2 | loss: 0.8599220
	speed: 0.0090s/iter; left time: 6.8251s
Updating learning rate to 4.339308742444759e-05
Validation loss decreased (0.6302 --> 0.6130).  Saving model state dict ...
Epoch: 2 cost time: 0.709017276763916
Epoch: 2, Steps: 123 | Train Loss: 0.8599220 Vali Loss: 0.6129652 Best vali loss: 0.6129652
	iters: 100, epoch: 3 | loss: 0.7531842
	speed: 0.0093s/iter; left time: 5.9345s
Updating learning rate to 3.514654368559802e-05
Validation loss decreased (0.6130 --> 0.6046).  Saving model state dict ...
Epoch: 3 cost time: 0.7442004680633545
Epoch: 3, Steps: 123 | Train Loss: 0.7531842 Vali Loss: 0.6045705 Best vali loss: 0.6045705

best validation loss 0.604570540163816

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015366822451, 'e_layers': 2, 'learning_rate': 0.000469438476, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9021744
	speed: 0.0101s/iter; left time: 18.8369s
	iters: 200, epoch: 1 | loss: 1.0124259
	speed: 0.0037s/iter; left time: 6.5305s
Updating learning rate to 0.00045157153787484547
Validation loss decreased (inf --> 0.6175).  Saving model state dict ...
Epoch: 1 cost time: 1.276474952697754
Epoch: 1, Steps: 245 | Train Loss: 0.9573002 Vali Loss: 0.6175135 Best vali loss: 0.6175135
	iters: 100, epoch: 2 | loss: 0.7369038
	speed: 0.0083s/iter; left time: 13.4107s
	iters: 200, epoch: 2 | loss: 0.9772209
	speed: 0.0039s/iter; left time: 5.9844s
Updating learning rate to 0.0004006908028647392
Validation loss decreased (0.6175 --> 0.5570).  Saving model state dict ...
Epoch: 2 cost time: 1.04146146774292
Epoch: 2, Steps: 245 | Train Loss: 0.8570623 Vali Loss: 0.5569701 Best vali loss: 0.5569701
	iters: 100, epoch: 3 | loss: 0.6827563
	speed: 0.0081s/iter; left time: 11.0468s
	iters: 200, epoch: 3 | loss: 0.4755569
	speed: 0.0035s/iter; left time: 4.4588s
Updating learning rate to 0.0003245424016399584
Validation loss decreased (0.5570 --> 0.5381).  Saving model state dict ...
Epoch: 3 cost time: 0.9201321601867676
Epoch: 3, Steps: 245 | Train Loss: 0.5791566 Vali Loss: 0.5380791 Best vali loss: 0.5380791

best validation loss 0.5380791322824194

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015366822451, 'e_layers': 2, 'learning_rate': 0.000469438476, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8824369
	speed: 0.0103s/iter; left time: 11.5816s
	iters: 200, epoch: 4 | loss: 0.8785131
	speed: 0.0040s/iter; left time: 4.1449s
Updating learning rate to 0.000234719238
Epoch: 4 cost time: 1.3296282291412354
Epoch: 4, Steps: 245 | Train Loss: 0.8804750 Vali Loss: 0.5410456 Best vali loss: 0.5380791
	iters: 100, epoch: 5 | loss: 0.7061971
	speed: 0.0081s/iter; left time: 7.1426s
	iters: 200, epoch: 5 | loss: 0.8982194
	speed: 0.0040s/iter; left time: 3.0852s
Updating learning rate to 0.0001448960743600416
Epoch: 5 cost time: 1.0063178539276123
Epoch: 5, Steps: 245 | Train Loss: 0.8022082 Vali Loss: 0.5406448 Best vali loss: 0.5380791
	iters: 100, epoch: 6 | loss: 0.5779014
	speed: 0.0081s/iter; left time: 5.1257s
	iters: 200, epoch: 6 | loss: 0.4323421
	speed: 0.0039s/iter; left time: 2.1126s
Updating learning rate to 6.874767313526085e-05
Epoch: 6 cost time: 1.008448600769043
Epoch: 6, Steps: 245 | Train Loss: 0.5051218 Vali Loss: 0.5415684 Best vali loss: 0.5380791
	iters: 100, epoch: 7 | loss: 0.4298720
	speed: 0.0080s/iter; left time: 3.1333s
	iters: 200, epoch: 7 | loss: 0.9707021
	speed: 0.0039s/iter; left time: 1.1344s
Updating learning rate to 1.786693812515455e-05
Epoch: 7 cost time: 1.0075764656066895
Epoch: 7, Steps: 245 | Train Loss: 0.7002870 Vali Loss: 0.5485809 Best vali loss: 0.5380791
	iters: 100, epoch: 8 | loss: 0.4659447
	speed: 0.0080s/iter; left time: 1.1656s
	iters: 200, epoch: 8 | loss: 0.8873520
	speed: 0.0038s/iter; left time: 0.1745s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9678170680999756
Epoch: 8, Steps: 245 | Train Loss: 0.6766484 Vali Loss: 0.5542855 Best vali loss: 0.5380791

best validation loss 0.5380791322824194

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0097235241821, 'e_layers': 2, 'learning_rate': 0.0001288410913, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8180953
	speed: 0.0097s/iter; left time: 74.6472s
	iters: 200, epoch: 1 | loss: 1.5591565
	speed: 0.0035s/iter; left time: 26.4260s
	iters: 300, epoch: 1 | loss: 1.0360260
	speed: 0.0034s/iter; left time: 25.8525s
	iters: 400, epoch: 1 | loss: 0.7198926
	speed: 0.0035s/iter; left time: 26.0509s
	iters: 500, epoch: 1 | loss: 0.7513624
	speed: 0.0035s/iter; left time: 25.7424s
	iters: 600, epoch: 1 | loss: 0.2552651
	speed: 0.0035s/iter; left time: 25.2412s
	iters: 700, epoch: 1 | loss: 1.6128983
	speed: 0.0035s/iter; left time: 24.9225s
	iters: 800, epoch: 1 | loss: 1.3133631
	speed: 0.0036s/iter; left time: 25.6335s
	iters: 900, epoch: 1 | loss: 0.7316545
	speed: 0.0036s/iter; left time: 25.0403s
Updating learning rate to 0.0001288410913
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 3.7698118686676025
Epoch: 1, Steps: 979 | Train Loss: 0.9775238 Vali Loss: 0.6094197 Best vali loss: 0.6094197
	iters: 100, epoch: 2 | loss: 0.6101542
	speed: 0.0111s/iter; left time: 74.9620s
	iters: 200, epoch: 2 | loss: 0.8174890
	speed: 0.0031s/iter; left time: 20.3580s
	iters: 300, epoch: 2 | loss: 0.7811991
	speed: 0.0031s/iter; left time: 20.2775s
	iters: 400, epoch: 2 | loss: 0.5950055
	speed: 0.0031s/iter; left time: 19.8476s
	iters: 500, epoch: 2 | loss: 0.7986935
	speed: 0.0030s/iter; left time: 19.3250s
	iters: 600, epoch: 2 | loss: 0.6892418
	speed: 0.0031s/iter; left time: 19.6392s
	iters: 700, epoch: 2 | loss: 0.6488820
	speed: 0.0031s/iter; left time: 18.8116s
	iters: 800, epoch: 2 | loss: 0.7209697
	speed: 0.0031s/iter; left time: 18.6952s
	iters: 900, epoch: 2 | loss: 0.9341189
	speed: 0.0031s/iter; left time: 18.2790s
Updating learning rate to 6.442054565e-05
Epoch: 2 cost time: 3.0621986389160156
Epoch: 2, Steps: 979 | Train Loss: 0.7328615 Vali Loss: 0.6268392 Best vali loss: 0.6094197
	iters: 100, epoch: 3 | loss: 0.7899534
	speed: 0.0111s/iter; left time: 64.0748s
	iters: 200, epoch: 3 | loss: 0.9244348
	speed: 0.0032s/iter; left time: 18.3568s
	iters: 300, epoch: 3 | loss: 0.5327095
	speed: 0.0032s/iter; left time: 18.0038s
	iters: 400, epoch: 3 | loss: 1.2084178
	speed: 0.0032s/iter; left time: 17.4506s
	iters: 500, epoch: 3 | loss: 0.4264608
	speed: 0.0033s/iter; left time: 17.6542s
	iters: 600, epoch: 3 | loss: 0.6425084
	speed: 0.0032s/iter; left time: 16.8512s
	iters: 700, epoch: 3 | loss: 0.7143803
	speed: 0.0031s/iter; left time: 16.2961s
	iters: 800, epoch: 3 | loss: 0.5799959
	speed: 0.0031s/iter; left time: 15.7607s
	iters: 900, epoch: 3 | loss: 1.0465736
	speed: 0.0032s/iter; left time: 15.6731s
Updating learning rate to 3.2210272825e-05
Validation loss decreased (0.6094 --> 0.5972).  Saving model state dict ...
Epoch: 3 cost time: 3.1710028648376465
Epoch: 3, Steps: 979 | Train Loss: 0.7628260 Vali Loss: 0.5972085 Best vali loss: 0.5972085
	iters: 100, epoch: 4 | loss: 1.2640659
	speed: 0.0114s/iter; left time: 54.4498s
	iters: 200, epoch: 4 | loss: 0.5270399
	speed: 0.0034s/iter; left time: 15.8868s
	iters: 300, epoch: 4 | loss: 1.2449366
	speed: 0.0035s/iter; left time: 16.1905s
	iters: 400, epoch: 4 | loss: 0.7304710
	speed: 0.0037s/iter; left time: 16.4615s
	iters: 500, epoch: 4 | loss: 0.8552018
	speed: 0.0038s/iter; left time: 16.5997s
	iters: 600, epoch: 4 | loss: 0.6595092
	speed: 0.0036s/iter; left time: 15.3728s
	iters: 700, epoch: 4 | loss: 1.2460206
	speed: 0.0036s/iter; left time: 15.2961s
	iters: 800, epoch: 4 | loss: 0.9309951
	speed: 0.0036s/iter; left time: 14.8006s
	iters: 900, epoch: 4 | loss: 0.5588328
	speed: 0.0036s/iter; left time: 14.3844s
Updating learning rate to 1.61051364125e-05
Epoch: 4 cost time: 3.551176071166992
Epoch: 4, Steps: 979 | Train Loss: 0.8907859 Vali Loss: 0.6054362 Best vali loss: 0.5972085
	iters: 100, epoch: 5 | loss: 0.3040556
	speed: 0.0116s/iter; left time: 44.2484s
	iters: 200, epoch: 5 | loss: 0.6928105
	speed: 0.0034s/iter; left time: 12.5857s
	iters: 300, epoch: 5 | loss: 1.7477194
	speed: 0.0035s/iter; left time: 12.5348s
	iters: 400, epoch: 5 | loss: 1.3287467
	speed: 0.0036s/iter; left time: 12.7132s
	iters: 500, epoch: 5 | loss: 0.4545815
	speed: 0.0034s/iter; left time: 11.4711s
	iters: 600, epoch: 5 | loss: 0.4969616
	speed: 0.0034s/iter; left time: 11.1203s
	iters: 700, epoch: 5 | loss: 1.8717010
	speed: 0.0034s/iter; left time: 10.9071s
	iters: 800, epoch: 5 | loss: 0.4647684
	speed: 0.0034s/iter; left time: 10.7072s
	iters: 900, epoch: 5 | loss: 0.6003849
	speed: 0.0034s/iter; left time: 10.2615s
Updating learning rate to 8.05256820625e-06
Epoch: 5 cost time: 3.391550064086914
Epoch: 5, Steps: 979 | Train Loss: 0.8846366 Vali Loss: 0.6075320 Best vali loss: 0.5972085
	iters: 100, epoch: 6 | loss: 0.9308708
	speed: 0.0113s/iter; left time: 32.1311s
	iters: 200, epoch: 6 | loss: 1.3992773
	speed: 0.0036s/iter; left time: 9.7425s
	iters: 300, epoch: 6 | loss: 0.7111821
	speed: 0.0035s/iter; left time: 9.2032s
	iters: 400, epoch: 6 | loss: 0.4323861
	speed: 0.0033s/iter; left time: 8.3807s
	iters: 500, epoch: 6 | loss: 0.3176303
	speed: 0.0035s/iter; left time: 8.5368s
	iters: 600, epoch: 6 | loss: 0.5580688
	speed: 0.0034s/iter; left time: 7.9224s
	iters: 700, epoch: 6 | loss: 1.5944226
	speed: 0.0035s/iter; left time: 7.7613s
	iters: 800, epoch: 6 | loss: 0.7093522
	speed: 0.0035s/iter; left time: 7.5882s
	iters: 900, epoch: 6 | loss: 0.7389634
	speed: 0.0036s/iter; left time: 7.2567s
Updating learning rate to 4.026284103125e-06
Epoch: 6 cost time: 3.4627304077148438
Epoch: 6, Steps: 979 | Train Loss: 0.8213504 Vali Loss: 0.6106574 Best vali loss: 0.5972085
	iters: 100, epoch: 7 | loss: 1.5044717
	speed: 0.0114s/iter; left time: 21.2524s
	iters: 200, epoch: 7 | loss: 1.5936291
	speed: 0.0035s/iter; left time: 6.0776s
	iters: 300, epoch: 7 | loss: 1.2114102
	speed: 0.0034s/iter; left time: 5.6609s
	iters: 400, epoch: 7 | loss: 0.5911221
	speed: 0.0036s/iter; left time: 5.5824s
	iters: 500, epoch: 7 | loss: 1.1593508
	speed: 0.0035s/iter; left time: 5.0598s
	iters: 600, epoch: 7 | loss: 0.6433619
	speed: 0.0035s/iter; left time: 4.7908s
	iters: 700, epoch: 7 | loss: 0.6070469
	speed: 0.0034s/iter; left time: 4.3078s
	iters: 800, epoch: 7 | loss: 0.8932647
	speed: 0.0034s/iter; left time: 3.9512s
	iters: 900, epoch: 7 | loss: 1.2710788
	speed: 0.0036s/iter; left time: 3.7883s
Updating learning rate to 2.0131420515625e-06
Epoch: 7 cost time: 3.461052417755127
Epoch: 7, Steps: 979 | Train Loss: 1.0527485 Vali Loss: 0.6076430 Best vali loss: 0.5972085
	iters: 100, epoch: 8 | loss: 0.7888050
	speed: 0.0114s/iter; left time: 9.9952s
	iters: 200, epoch: 8 | loss: 0.5124018
	speed: 0.0031s/iter; left time: 2.4158s
	iters: 300, epoch: 8 | loss: 0.5139818
	speed: 0.0031s/iter; left time: 2.0765s
	iters: 400, epoch: 8 | loss: 1.0492363
	speed: 0.0030s/iter; left time: 1.7621s
	iters: 500, epoch: 8 | loss: 0.6963098
	speed: 0.0030s/iter; left time: 1.4462s
	iters: 600, epoch: 8 | loss: 0.3907763
	speed: 0.0030s/iter; left time: 1.1439s
	iters: 700, epoch: 8 | loss: 1.6796770
	speed: 0.0031s/iter; left time: 0.8732s
	iters: 800, epoch: 8 | loss: 0.4826339
	speed: 0.0032s/iter; left time: 0.5703s
	iters: 900, epoch: 8 | loss: 1.0570935
	speed: 0.0031s/iter; left time: 0.2472s
Updating learning rate to 1.00657102578125e-06
Epoch: 8 cost time: 3.0673699378967285
Epoch: 8, Steps: 979 | Train Loss: 0.7967684 Vali Loss: 0.6083610 Best vali loss: 0.5972085

best validation loss 0.5972085379026157

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010428537123, 'e_layers': 3, 'learning_rate': 0.0004699789092, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9430063
	speed: 0.0106s/iter; left time: 40.3765s
	iters: 200, epoch: 1 | loss: 1.0642061
	speed: 0.0045s/iter; left time: 16.5950s
	iters: 300, epoch: 1 | loss: 1.4534847
	speed: 0.0045s/iter; left time: 16.1544s
	iters: 400, epoch: 1 | loss: 0.7100461
	speed: 0.0045s/iter; left time: 15.8796s
Updating learning rate to 0.00045209140206093024
Validation loss decreased (inf --> 0.6080).  Saving model state dict ...
Epoch: 1 cost time: 2.520129919052124
Epoch: 1, Steps: 490 | Train Loss: 1.0426858 Vali Loss: 0.6080385 Best vali loss: 0.6080385
	iters: 100, epoch: 2 | loss: 0.9439607
	speed: 0.0120s/iter; left time: 40.1298s
	iters: 200, epoch: 2 | loss: 0.8679455
	speed: 0.0046s/iter; left time: 14.8196s
	iters: 300, epoch: 2 | loss: 0.5140301
	speed: 0.0044s/iter; left time: 13.6975s
	iters: 400, epoch: 2 | loss: 0.4063832
	speed: 0.0044s/iter; left time: 13.4412s
Updating learning rate to 0.00040115209145498833
Validation loss decreased (0.6080 --> 0.6008).  Saving model state dict ...
Epoch: 2 cost time: 2.229550361633301
Epoch: 2, Steps: 490 | Train Loss: 0.6830799 Vali Loss: 0.6007644 Best vali loss: 0.6007644
	iters: 100, epoch: 3 | loss: 0.8340369
	speed: 0.0122s/iter; left time: 34.7760s
	iters: 200, epoch: 3 | loss: 1.0230298
	speed: 0.0047s/iter; left time: 12.8148s
	iters: 300, epoch: 3 | loss: 0.5794411
	speed: 0.0047s/iter; left time: 12.3415s
	iters: 400, epoch: 3 | loss: 0.5374383
	speed: 0.0047s/iter; left time: 11.8612s
Updating learning rate to 0.0003249160256559284
Epoch: 3 cost time: 2.3391201496124268
Epoch: 3, Steps: 490 | Train Loss: 0.7434865 Vali Loss: 0.6437287 Best vali loss: 0.6007644
	iters: 100, epoch: 4 | loss: 0.7568926
	speed: 0.0122s/iter; left time: 28.7198s
	iters: 200, epoch: 4 | loss: 1.2308588
	speed: 0.0042s/iter; left time: 9.4650s
	iters: 300, epoch: 4 | loss: 0.8151290
	speed: 0.0042s/iter; left time: 8.9690s
	iters: 400, epoch: 4 | loss: 0.8128505
	speed: 0.0042s/iter; left time: 8.6889s
Updating learning rate to 0.0002349894546
Epoch: 4 cost time: 2.1177570819854736
Epoch: 4, Steps: 490 | Train Loss: 0.9039327 Vali Loss: 0.6117930 Best vali loss: 0.6007644
	iters: 100, epoch: 5 | loss: 0.5790020
	speed: 0.0114s/iter; left time: 21.3063s
	iters: 200, epoch: 5 | loss: 0.4522170
	speed: 0.0043s/iter; left time: 7.5516s
	iters: 300, epoch: 5 | loss: 0.4756989
	speed: 0.0044s/iter; left time: 7.2751s
	iters: 400, epoch: 5 | loss: 0.5245571
	speed: 0.0042s/iter; left time: 6.6293s
Updating learning rate to 0.00014506288354407157
Epoch: 5 cost time: 2.1409966945648193
Epoch: 5, Steps: 490 | Train Loss: 0.5078687 Vali Loss: 0.6041879 Best vali loss: 0.6007644
	iters: 100, epoch: 6 | loss: 0.4631031
	speed: 0.0115s/iter; left time: 15.8239s
	iters: 200, epoch: 6 | loss: 0.5789891
	speed: 0.0044s/iter; left time: 5.6362s
	iters: 300, epoch: 6 | loss: 0.3917414
	speed: 0.0044s/iter; left time: 5.1586s
	iters: 400, epoch: 6 | loss: 0.8614886
	speed: 0.0044s/iter; left time: 4.7411s
Updating learning rate to 6.882681774501167e-05
Epoch: 6 cost time: 2.1658437252044678
Epoch: 6, Steps: 490 | Train Loss: 0.5738306 Vali Loss: 0.6193332 Best vali loss: 0.6007644
	iters: 100, epoch: 7 | loss: 0.4017936
	speed: 0.0117s/iter; left time: 10.2938s
	iters: 200, epoch: 7 | loss: 0.8068454
	speed: 0.0041s/iter; left time: 3.2112s
	iters: 300, epoch: 7 | loss: 1.1083983
	speed: 0.0040s/iter; left time: 2.7235s
	iters: 400, epoch: 7 | loss: 0.6911946
	speed: 0.0041s/iter; left time: 2.3625s
Updating learning rate to 1.788750713906976e-05
Epoch: 7 cost time: 2.0243756771087646
Epoch: 7, Steps: 490 | Train Loss: 0.7520580 Vali Loss: 0.6160163 Best vali loss: 0.6007644
	iters: 100, epoch: 8 | loss: 0.8266800
	speed: 0.0114s/iter; left time: 4.4685s
	iters: 200, epoch: 8 | loss: 0.6619939
	speed: 0.0042s/iter; left time: 1.2314s
	iters: 300, epoch: 8 | loss: 0.3317350
	speed: 0.0044s/iter; left time: 0.8319s
	iters: 400, epoch: 8 | loss: 0.5084059
	speed: 0.0040s/iter; left time: 0.3605s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.07297682762146
Epoch: 8, Steps: 490 | Train Loss: 0.5822037 Vali Loss: 0.6193965 Best vali loss: 0.6007644

best validation loss 0.6007644014190822

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616678
	speed: 0.0118s/iter; left time: 10.4601s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.037468671798706
Epoch: 1, Steps: 123 | Train Loss: 0.7616678 Vali Loss: 0.6075860 Best vali loss: 0.6075860
	iters: 100, epoch: 2 | loss: 0.9350239
	speed: 0.0092s/iter; left time: 6.9804s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.6076 --> 0.5726).  Saving model state dict ...
Epoch: 2 cost time: 0.715482234954834
Epoch: 2, Steps: 123 | Train Loss: 0.9350239 Vali Loss: 0.5725781 Best vali loss: 0.5725781
	iters: 100, epoch: 3 | loss: 0.8591589
	speed: 0.0094s/iter; left time: 5.9766s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.5726 --> 0.5460).  Saving model state dict ...
Epoch: 3 cost time: 0.7140958309173584
Epoch: 3, Steps: 123 | Train Loss: 0.8591589 Vali Loss: 0.5459795 Best vali loss: 0.5459795

best validation loss 0.545979534763255

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043796298025, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616921
	speed: 0.0116s/iter; left time: 10.2949s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0247802734375
Epoch: 1, Steps: 123 | Train Loss: 0.7616921 Vali Loss: 0.6075610 Best vali loss: 0.6075610
	iters: 100, epoch: 2 | loss: 0.9374487
	speed: 0.0091s/iter; left time: 6.9525s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5673).  Saving model state dict ...
Epoch: 2 cost time: 0.7125730514526367
Epoch: 2, Steps: 123 | Train Loss: 0.9374487 Vali Loss: 0.5673319 Best vali loss: 0.5673319
	iters: 100, epoch: 3 | loss: 0.8519615
	speed: 0.0093s/iter; left time: 5.9176s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5673 --> 0.5470).  Saving model state dict ...
Epoch: 3 cost time: 0.7177915573120117
Epoch: 3, Steps: 123 | Train Loss: 0.8519615 Vali Loss: 0.5470479 Best vali loss: 0.5470479

best validation loss 0.5470479236935533

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0038056475004, 'e_layers': 1, 'learning_rate': 0.0001748793085, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8568891
	speed: 0.0101s/iter; left time: 8.9389s
Updating learning rate to 0.0001748793085
Validation loss decreased (inf --> 0.6072).  Saving model state dict ...
Epoch: 1 cost time: 0.8161094188690186
Epoch: 1, Steps: 123 | Train Loss: 0.8568891 Vali Loss: 0.6071866 Best vali loss: 0.6071866
	iters: 100, epoch: 2 | loss: 0.6948667
	speed: 0.0067s/iter; left time: 5.0685s
Updating learning rate to 8.743965425e-05
Epoch: 2 cost time: 0.4931526184082031
Epoch: 2, Steps: 123 | Train Loss: 0.6948667 Vali Loss: 0.6237916 Best vali loss: 0.6071866
	iters: 100, epoch: 3 | loss: 0.7513496
	speed: 0.0066s/iter; left time: 4.1931s
Updating learning rate to 4.3719827125e-05
Epoch: 3 cost time: 0.4937577247619629
Epoch: 3, Steps: 123 | Train Loss: 0.7513496 Vali Loss: 0.6118097 Best vali loss: 0.6071866

best validation loss 0.607186598311084

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6024107
	speed: 0.0118s/iter; left time: 6.0940s
Updating learning rate to 8.79643783e-05
Validation loss decreased (0.5460 --> 0.5305).  Saving model state dict ...
Epoch: 4 cost time: 1.0190269947052002
Epoch: 4, Steps: 123 | Train Loss: 0.6024107 Vali Loss: 0.5304565 Best vali loss: 0.5304565
	iters: 100, epoch: 5 | loss: 0.8451093
	speed: 0.0094s/iter; left time: 3.6789s
Updating learning rate to 5.430186808629478e-05
Validation loss decreased (0.5305 --> 0.5268).  Saving model state dict ...
Epoch: 5 cost time: 0.7216763496398926
Epoch: 5, Steps: 123 | Train Loss: 0.8451093 Vali Loss: 0.5267752 Best vali loss: 0.5267752
	iters: 100, epoch: 6 | loss: 0.8048926
	speed: 0.0092s/iter; left time: 2.4801s
Updating learning rate to 2.5764169901211216e-05
Validation loss decreased (0.5268 --> 0.5260).  Saving model state dict ...
Epoch: 6 cost time: 0.7134783267974854
Epoch: 6, Steps: 123 | Train Loss: 0.8048926 Vali Loss: 0.5260358 Best vali loss: 0.5260358
	iters: 100, epoch: 7 | loss: 0.4784960
	speed: 0.0092s/iter; left time: 1.3569s
Updating learning rate to 6.695889598550024e-06
Epoch: 7 cost time: 0.7153241634368896
Epoch: 7, Steps: 123 | Train Loss: 0.4784960 Vali Loss: 0.5262741 Best vali loss: 0.5260358
	iters: 100, epoch: 8 | loss: 0.5505207
	speed: 0.0090s/iter; left time: 0.2150s
Updating learning rate to 0.0
Validation loss decreased (0.5260 --> 0.5223).  Saving model state dict ...
Epoch: 8 cost time: 0.7147924900054932
Epoch: 8, Steps: 123 | Train Loss: 0.5505207 Vali Loss: 0.5222543 Best vali loss: 0.5222543

best validation loss 0.5222543191987019

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010465356658, 'e_layers': 4, 'learning_rate': 6.78543203e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3678468
	speed: 0.0116s/iter; left time: 89.8848s
	iters: 200, epoch: 1 | loss: 0.7462812
	speed: 0.0054s/iter; left time: 41.3603s
	iters: 300, epoch: 1 | loss: 0.9151028
	speed: 0.0053s/iter; left time: 39.6362s
	iters: 400, epoch: 1 | loss: 2.1755087
	speed: 0.0048s/iter; left time: 35.8977s
	iters: 500, epoch: 1 | loss: 0.5471597
	speed: 0.0055s/iter; left time: 40.0265s
	iters: 600, epoch: 1 | loss: 0.4696144
	speed: 0.0052s/iter; left time: 37.8294s
	iters: 700, epoch: 1 | loss: 0.7096881
	speed: 0.0054s/iter; left time: 38.4354s
	iters: 800, epoch: 1 | loss: 0.5216158
	speed: 0.0054s/iter; left time: 37.7158s
	iters: 900, epoch: 1 | loss: 0.7407123
	speed: 0.0054s/iter; left time: 37.2070s
Updating learning rate to 6.78543203e-05
Validation loss decreased (inf --> 0.5818).  Saving model state dict ...
Epoch: 1 cost time: 5.5490944385528564
Epoch: 1, Steps: 979 | Train Loss: 0.7992811 Vali Loss: 0.5817696 Best vali loss: 0.5817696
	iters: 100, epoch: 2 | loss: 0.6631331
	speed: 0.0159s/iter; left time: 107.1034s
	iters: 200, epoch: 2 | loss: 0.4869813
	speed: 0.0048s/iter; left time: 31.7343s
	iters: 300, epoch: 2 | loss: 0.9098097
	speed: 0.0048s/iter; left time: 31.6821s
	iters: 400, epoch: 2 | loss: 0.6930304
	speed: 0.0049s/iter; left time: 31.6431s
	iters: 500, epoch: 2 | loss: 0.4588938
	speed: 0.0051s/iter; left time: 32.2633s
	iters: 600, epoch: 2 | loss: 1.0989522
	speed: 0.0053s/iter; left time: 33.1253s
	iters: 700, epoch: 2 | loss: 1.1191119
	speed: 0.0053s/iter; left time: 32.3309s
	iters: 800, epoch: 2 | loss: 1.4236493
	speed: 0.0052s/iter; left time: 31.5524s
	iters: 900, epoch: 2 | loss: 1.3632021
	speed: 0.0046s/iter; left time: 27.5858s
Updating learning rate to 3.392716015e-05
Epoch: 2 cost time: 4.91044545173645
Epoch: 2, Steps: 979 | Train Loss: 0.9129738 Vali Loss: 0.6063939 Best vali loss: 0.5817696
	iters: 100, epoch: 3 | loss: 0.6959224
	speed: 0.0157s/iter; left time: 90.7553s
	iters: 200, epoch: 3 | loss: 0.8990799
	speed: 0.0052s/iter; left time: 29.3387s
	iters: 300, epoch: 3 | loss: 0.3217695
	speed: 0.0050s/iter; left time: 27.8660s
	iters: 400, epoch: 3 | loss: 0.4904699
	speed: 0.0049s/iter; left time: 26.7261s
	iters: 500, epoch: 3 | loss: 0.3039491
	speed: 0.0050s/iter; left time: 27.0880s
	iters: 600, epoch: 3 | loss: 1.3729602
	speed: 0.0050s/iter; left time: 26.1422s
	iters: 700, epoch: 3 | loss: 0.8389655
	speed: 0.0050s/iter; left time: 25.9990s
	iters: 800, epoch: 3 | loss: 0.5022578
	speed: 0.0049s/iter; left time: 25.0141s
	iters: 900, epoch: 3 | loss: 0.7569861
	speed: 0.0050s/iter; left time: 24.8416s
Updating learning rate to 1.6963580075e-05
Validation loss decreased (0.5818 --> 0.5584).  Saving model state dict ...
Epoch: 3 cost time: 4.984545946121216
Epoch: 3, Steps: 979 | Train Loss: 0.6869290 Vali Loss: 0.5584231 Best vali loss: 0.5584231
	iters: 100, epoch: 4 | loss: 0.9911543
	speed: 0.0166s/iter; left time: 79.7273s
	iters: 200, epoch: 4 | loss: 1.0423501
	speed: 0.0052s/iter; left time: 24.5668s
	iters: 300, epoch: 4 | loss: 0.6218576
	speed: 0.0053s/iter; left time: 24.5344s
	iters: 400, epoch: 4 | loss: 0.2528259
	speed: 0.0053s/iter; left time: 23.6683s
	iters: 500, epoch: 4 | loss: 1.1473562
	speed: 0.0053s/iter; left time: 23.4234s
	iters: 600, epoch: 4 | loss: 0.3531186
	speed: 0.0053s/iter; left time: 22.7658s
	iters: 700, epoch: 4 | loss: 0.3320179
	speed: 0.0053s/iter; left time: 22.2958s
	iters: 800, epoch: 4 | loss: 0.5600282
	speed: 0.0053s/iter; left time: 21.5820s
	iters: 900, epoch: 4 | loss: 1.0110250
	speed: 0.0052s/iter; left time: 20.7705s
Updating learning rate to 8.4817900375e-06
Validation loss decreased (0.5584 --> 0.5418).  Saving model state dict ...
Epoch: 4 cost time: 5.213329315185547
Epoch: 4, Steps: 979 | Train Loss: 0.7013037 Vali Loss: 0.5418255 Best vali loss: 0.5418255
	iters: 100, epoch: 5 | loss: 0.9544169
	speed: 0.0165s/iter; left time: 62.9852s
	iters: 200, epoch: 5 | loss: 0.3820038
	speed: 0.0048s/iter; left time: 17.9695s
	iters: 300, epoch: 5 | loss: 0.2807438
	speed: 0.0048s/iter; left time: 17.4972s
	iters: 400, epoch: 5 | loss: 0.7073227
	speed: 0.0048s/iter; left time: 17.0020s
	iters: 500, epoch: 5 | loss: 1.1461990
	speed: 0.0049s/iter; left time: 16.6001s
	iters: 600, epoch: 5 | loss: 0.3581358
	speed: 0.0048s/iter; left time: 16.0067s
	iters: 700, epoch: 5 | loss: 0.5306070
	speed: 0.0047s/iter; left time: 15.1894s
	iters: 800, epoch: 5 | loss: 0.5642086
	speed: 0.0049s/iter; left time: 15.3078s
	iters: 900, epoch: 5 | loss: 1.0505795
	speed: 0.0053s/iter; left time: 15.9780s
Updating learning rate to 4.24089501875e-06
Validation loss decreased (0.5418 --> 0.5368).  Saving model state dict ...
Epoch: 5 cost time: 4.894944190979004
Epoch: 5, Steps: 979 | Train Loss: 0.6638019 Vali Loss: 0.5367538 Best vali loss: 0.5367538
	iters: 100, epoch: 6 | loss: 0.5003941
	speed: 0.0167s/iter; left time: 47.5080s
	iters: 200, epoch: 6 | loss: 0.4628724
	speed: 0.0052s/iter; left time: 14.2215s
	iters: 300, epoch: 6 | loss: 0.3797211
	speed: 0.0052s/iter; left time: 13.7861s
	iters: 400, epoch: 6 | loss: 0.2858269
	speed: 0.0046s/iter; left time: 11.7852s
	iters: 500, epoch: 6 | loss: 0.6840020
	speed: 0.0052s/iter; left time: 12.6307s
	iters: 600, epoch: 6 | loss: 0.2699731
	speed: 0.0052s/iter; left time: 12.1634s
	iters: 700, epoch: 6 | loss: 0.8044272
	speed: 0.0051s/iter; left time: 11.3558s
	iters: 800, epoch: 6 | loss: 0.3404503
	speed: 0.0050s/iter; left time: 10.6810s
	iters: 900, epoch: 6 | loss: 1.2460296
	speed: 0.0050s/iter; left time: 10.1637s
Updating learning rate to 2.120447509375e-06
Epoch: 6 cost time: 5.0138397216796875
Epoch: 6, Steps: 979 | Train Loss: 0.5526330 Vali Loss: 0.5375472 Best vali loss: 0.5367538
	iters: 100, epoch: 7 | loss: 1.2031035
	speed: 0.0161s/iter; left time: 29.9758s
	iters: 200, epoch: 7 | loss: 0.5302010
	speed: 0.0056s/iter; left time: 9.8035s
	iters: 300, epoch: 7 | loss: 0.2801121
	speed: 0.0055s/iter; left time: 9.1170s
	iters: 400, epoch: 7 | loss: 0.9811051
	speed: 0.0056s/iter; left time: 8.7431s
	iters: 500, epoch: 7 | loss: 0.8316348
	speed: 0.0049s/iter; left time: 7.1267s
	iters: 600, epoch: 7 | loss: 1.0212861
	speed: 0.0051s/iter; left time: 6.8690s
	iters: 700, epoch: 7 | loss: 0.7913007
	speed: 0.0050s/iter; left time: 6.2774s
	iters: 800, epoch: 7 | loss: 0.2946711
	speed: 0.0050s/iter; left time: 5.7563s
	iters: 900, epoch: 7 | loss: 0.4629995
	speed: 0.0047s/iter; left time: 4.9583s
Updating learning rate to 1.0602237546875e-06
Validation loss decreased (0.5368 --> 0.5366).  Saving model state dict ...
Epoch: 7 cost time: 5.11244010925293
Epoch: 7, Steps: 979 | Train Loss: 0.7107127 Vali Loss: 0.5366012 Best vali loss: 0.5366012
	iters: 100, epoch: 8 | loss: 0.9326501
	speed: 0.0156s/iter; left time: 13.7176s
	iters: 200, epoch: 8 | loss: 0.7692719
	speed: 0.0048s/iter; left time: 3.7550s
	iters: 300, epoch: 8 | loss: 0.9610326
	speed: 0.0048s/iter; left time: 3.2894s
	iters: 400, epoch: 8 | loss: 0.5749750
	speed: 0.0050s/iter; left time: 2.8840s
	iters: 500, epoch: 8 | loss: 0.2851049
	speed: 0.0051s/iter; left time: 2.4351s
	iters: 600, epoch: 8 | loss: 0.2991030
	speed: 0.0051s/iter; left time: 1.9434s
	iters: 700, epoch: 8 | loss: 0.2554718
	speed: 0.0051s/iter; left time: 1.4360s
	iters: 800, epoch: 8 | loss: 0.5299250
	speed: 0.0048s/iter; left time: 0.8716s
	iters: 900, epoch: 8 | loss: 0.9424160
	speed: 0.0049s/iter; left time: 0.3912s
Updating learning rate to 5.3011187734375e-07
Epoch: 8 cost time: 4.881093978881836
Epoch: 8, Steps: 979 | Train Loss: 0.6166611 Vali Loss: 0.5373190 Best vali loss: 0.5366012

best validation loss 0.5366012181798819

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0063862244573, 'e_layers': 2, 'learning_rate': 0.0038735508481, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0038735508481
Validation loss decreased (inf --> 0.5955).  Saving model state dict ...
Epoch: 1 cost time: 0.7299180030822754
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5955179 Best vali loss: 0.5955179
Updating learning rate to 0.00193677542405
Epoch: 2 cost time: 0.44521021842956543
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6090645 Best vali loss: 0.5955179
Updating learning rate to 0.000968387712025
Epoch: 3 cost time: 0.47081828117370605
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6183122 Best vali loss: 0.5955179
Updating learning rate to 0.0004841938560125
Epoch: 4 cost time: 0.44330906867980957
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6149456 Best vali loss: 0.5955179
Updating learning rate to 0.00024209692800625
Epoch: 5 cost time: 0.45093512535095215
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6368132 Best vali loss: 0.5955179
Updating learning rate to 0.000121048464003125
Epoch: 6 cost time: 0.4480149745941162
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6307797 Best vali loss: 0.5955179
Updating learning rate to 6.05242320015625e-05
Epoch: 7 cost time: 0.43404483795166016
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6431503 Best vali loss: 0.5955179
Updating learning rate to 3.026211600078125e-05
Epoch: 8 cost time: 0.44138145446777344
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6409734 Best vali loss: 0.5955179

best validation loss 0.595517898836052

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009801915658, 'e_layers': 4, 'learning_rate': 7.35831747e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3668997
	speed: 0.0115s/iter; left time: 89.1109s
	iters: 200, epoch: 1 | loss: 0.7443031
	speed: 0.0053s/iter; left time: 40.8045s
	iters: 300, epoch: 1 | loss: 0.9169714
	speed: 0.0054s/iter; left time: 40.8806s
	iters: 400, epoch: 1 | loss: 2.1883259
	speed: 0.0057s/iter; left time: 42.2835s
	iters: 500, epoch: 1 | loss: 0.5498453
	speed: 0.0055s/iter; left time: 40.0521s
	iters: 600, epoch: 1 | loss: 0.4694280
	speed: 0.0055s/iter; left time: 39.9775s
	iters: 700, epoch: 1 | loss: 0.7000657
	speed: 0.0055s/iter; left time: 39.5260s
	iters: 800, epoch: 1 | loss: 0.5154402
	speed: 0.0054s/iter; left time: 38.2921s
	iters: 900, epoch: 1 | loss: 0.7333729
	speed: 0.0056s/iter; left time: 38.9052s
Updating learning rate to 7.35831747e-05
Validation loss decreased (inf --> 0.5919).  Saving model state dict ...
Epoch: 1 cost time: 5.728212833404541
Epoch: 1, Steps: 979 | Train Loss: 0.7982947 Vali Loss: 0.5918931 Best vali loss: 0.5918931
	iters: 100, epoch: 2 | loss: 0.7590295
	speed: 0.0165s/iter; left time: 111.1970s
	iters: 200, epoch: 2 | loss: 0.5232508
	speed: 0.0054s/iter; left time: 35.8152s
	iters: 300, epoch: 2 | loss: 0.8776025
	speed: 0.0052s/iter; left time: 33.8103s
	iters: 400, epoch: 2 | loss: 0.6772412
	speed: 0.0054s/iter; left time: 34.5876s
	iters: 500, epoch: 2 | loss: 0.4505554
	speed: 0.0054s/iter; left time: 34.1101s
	iters: 600, epoch: 2 | loss: 1.0697459
	speed: 0.0050s/iter; left time: 31.5031s
	iters: 700, epoch: 2 | loss: 1.1098992
	speed: 0.0047s/iter; left time: 28.6494s
	iters: 800, epoch: 2 | loss: 1.4026245
	speed: 0.0046s/iter; left time: 27.9415s
	iters: 900, epoch: 2 | loss: 1.3919188
	speed: 0.0046s/iter; left time: 27.5495s
Updating learning rate to 3.679158735e-05
Epoch: 2 cost time: 5.009886264801025
Epoch: 2, Steps: 979 | Train Loss: 0.9179853 Vali Loss: 0.5996611 Best vali loss: 0.5918931
	iters: 100, epoch: 3 | loss: 0.6955354
	speed: 0.0160s/iter; left time: 92.2795s
	iters: 200, epoch: 3 | loss: 0.9485406
	speed: 0.0052s/iter; left time: 29.6026s
	iters: 300, epoch: 3 | loss: 0.3157885
	speed: 0.0051s/iter; left time: 28.6316s
	iters: 400, epoch: 3 | loss: 0.4949101
	speed: 0.0053s/iter; left time: 29.2780s
	iters: 500, epoch: 3 | loss: 0.3199939
	speed: 0.0054s/iter; left time: 28.9168s
	iters: 600, epoch: 3 | loss: 1.3606825
	speed: 0.0054s/iter; left time: 28.6458s
	iters: 700, epoch: 3 | loss: 0.8345789
	speed: 0.0054s/iter; left time: 27.9138s
	iters: 800, epoch: 3 | loss: 0.4974152
	speed: 0.0055s/iter; left time: 27.8301s
	iters: 900, epoch: 3 | loss: 0.7344475
	speed: 0.0054s/iter; left time: 26.6242s
Updating learning rate to 1.8395793675e-05
Validation loss decreased (0.5919 --> 0.5434).  Saving model state dict ...
Epoch: 3 cost time: 5.295470952987671
Epoch: 3, Steps: 979 | Train Loss: 0.6890992 Vali Loss: 0.5433522 Best vali loss: 0.5433522

best validation loss 0.5433521830528105

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008306776163, 'e_layers': 4, 'learning_rate': 7.03899754e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3674111
	speed: 0.0115s/iter; left time: 88.9562s
	iters: 200, epoch: 1 | loss: 0.7452682
	speed: 0.0053s/iter; left time: 40.5371s
	iters: 300, epoch: 1 | loss: 0.9156888
	speed: 0.0054s/iter; left time: 40.4443s
	iters: 400, epoch: 1 | loss: 2.1814849
	speed: 0.0054s/iter; left time: 40.1096s
	iters: 500, epoch: 1 | loss: 0.5485434
	speed: 0.0054s/iter; left time: 39.7715s
	iters: 600, epoch: 1 | loss: 0.4694986
	speed: 0.0053s/iter; left time: 38.6697s
	iters: 700, epoch: 1 | loss: 0.7059862
	speed: 0.0053s/iter; left time: 37.6283s
	iters: 800, epoch: 1 | loss: 0.5176126
	speed: 0.0054s/iter; left time: 37.9051s
	iters: 900, epoch: 1 | loss: 0.7248955
	speed: 0.0052s/iter; left time: 36.3790s
Updating learning rate to 7.03899754e-05
Validation loss decreased (inf --> 0.5835).  Saving model state dict ...
Epoch: 1 cost time: 5.545790433883667
Epoch: 1, Steps: 979 | Train Loss: 0.7973766 Vali Loss: 0.5834860 Best vali loss: 0.5834860
	iters: 100, epoch: 2 | loss: 0.6698590
	speed: 0.0158s/iter; left time: 106.8107s
	iters: 200, epoch: 2 | loss: 0.4868971
	speed: 0.0050s/iter; left time: 33.4878s
	iters: 300, epoch: 2 | loss: 0.8465567
	speed: 0.0051s/iter; left time: 33.1771s
	iters: 400, epoch: 2 | loss: 0.6527607
	speed: 0.0050s/iter; left time: 32.3058s
	iters: 500, epoch: 2 | loss: 0.4522113
	speed: 0.0051s/iter; left time: 32.2080s
	iters: 600, epoch: 2 | loss: 1.0909455
	speed: 0.0050s/iter; left time: 31.5604s
	iters: 700, epoch: 2 | loss: 1.1400044
	speed: 0.0053s/iter; left time: 32.4767s
	iters: 800, epoch: 2 | loss: 1.4211293
	speed: 0.0052s/iter; left time: 31.2276s
	iters: 900, epoch: 2 | loss: 1.3649085
	speed: 0.0052s/iter; left time: 30.7879s
Updating learning rate to 3.51949877e-05
Epoch: 2 cost time: 5.049205541610718
Epoch: 2, Steps: 979 | Train Loss: 0.9028080 Vali Loss: 0.6247486 Best vali loss: 0.5834860
	iters: 100, epoch: 3 | loss: 0.6961046
	speed: 0.0158s/iter; left time: 91.3717s
	iters: 200, epoch: 3 | loss: 0.8975154
	speed: 0.0050s/iter; left time: 28.2745s
	iters: 300, epoch: 3 | loss: 0.3256587
	speed: 0.0051s/iter; left time: 28.3293s
	iters: 400, epoch: 3 | loss: 0.5123551
	speed: 0.0051s/iter; left time: 27.9527s
	iters: 500, epoch: 3 | loss: 0.3069984
	speed: 0.0052s/iter; left time: 27.7633s
	iters: 600, epoch: 3 | loss: 1.3663572
	speed: 0.0051s/iter; left time: 26.6730s
	iters: 700, epoch: 3 | loss: 0.8362874
	speed: 0.0050s/iter; left time: 25.9446s
	iters: 800, epoch: 3 | loss: 0.5012398
	speed: 0.0051s/iter; left time: 26.0836s
	iters: 900, epoch: 3 | loss: 0.7316752
	speed: 0.0048s/iter; left time: 23.8565s
Updating learning rate to 1.759749385e-05
Validation loss decreased (0.5835 --> 0.5550).  Saving model state dict ...
Epoch: 3 cost time: 4.972481966018677
Epoch: 3, Steps: 979 | Train Loss: 0.6860213 Vali Loss: 0.5550259 Best vali loss: 0.5550259

best validation loss 0.5550258560265616

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0070436160023, 'e_layers': 2, 'learning_rate': 0.0003185365471, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9891191
	speed: 0.0098s/iter; left time: 37.5129s
	iters: 200, epoch: 1 | loss: 1.1047419
	speed: 0.0034s/iter; left time: 12.6719s
	iters: 300, epoch: 1 | loss: 0.3309566
	speed: 0.0033s/iter; left time: 11.8003s
	iters: 400, epoch: 1 | loss: 0.6832322
	speed: 0.0032s/iter; left time: 11.1598s
Updating learning rate to 0.0003185365471
Validation loss decreased (inf --> 0.6110).  Saving model state dict ...
Epoch: 1 cost time: 1.9922518730163574
Epoch: 1, Steps: 490 | Train Loss: 0.7770125 Vali Loss: 0.6110477 Best vali loss: 0.6110477
	iters: 100, epoch: 2 | loss: 1.0159476
	speed: 0.0100s/iter; left time: 33.2488s
	iters: 200, epoch: 2 | loss: 0.7459509
	speed: 0.0036s/iter; left time: 11.7476s
	iters: 300, epoch: 2 | loss: 0.8464950
	speed: 0.0036s/iter; left time: 11.2855s
	iters: 400, epoch: 2 | loss: 1.3363411
	speed: 0.0036s/iter; left time: 10.7619s
Updating learning rate to 0.00015926827355
Epoch: 2 cost time: 1.8215861320495605
Epoch: 2, Steps: 490 | Train Loss: 0.9861837 Vali Loss: 0.6144526 Best vali loss: 0.6110477
	iters: 100, epoch: 3 | loss: 1.3467036
	speed: 0.0105s/iter; left time: 29.9502s
	iters: 200, epoch: 3 | loss: 0.5896062
	speed: 0.0037s/iter; left time: 10.0316s
	iters: 300, epoch: 3 | loss: 0.5378076
	speed: 0.0037s/iter; left time: 9.6795s
	iters: 400, epoch: 3 | loss: 0.4909247
	speed: 0.0038s/iter; left time: 9.6960s
Updating learning rate to 7.9634136775e-05
Epoch: 3 cost time: 1.8939859867095947
Epoch: 3, Steps: 490 | Train Loss: 0.7412605 Vali Loss: 0.6132332 Best vali loss: 0.6110477

best validation loss 0.6110476645977615

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009801915658, 'e_layers': 4, 'learning_rate': 7.35831747e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2938097
	speed: 0.0124s/iter; left time: 59.2393s
	iters: 200, epoch: 4 | loss: 0.5536975
	speed: 0.0054s/iter; left time: 25.3157s
	iters: 300, epoch: 4 | loss: 0.8764160
	speed: 0.0053s/iter; left time: 24.5611s
	iters: 400, epoch: 4 | loss: 1.5190701
	speed: 0.0054s/iter; left time: 24.1233s
	iters: 500, epoch: 4 | loss: 0.4325367
	speed: 0.0053s/iter; left time: 23.4236s
	iters: 600, epoch: 4 | loss: 0.4454325
	speed: 0.0052s/iter; left time: 22.3216s
	iters: 700, epoch: 4 | loss: 0.5303909
	speed: 0.0053s/iter; left time: 22.0590s
	iters: 800, epoch: 4 | loss: 0.4985591
	speed: 0.0055s/iter; left time: 22.7140s
	iters: 900, epoch: 4 | loss: 0.6926293
	speed: 0.0054s/iter; left time: 21.6265s
Updating learning rate to 9.1978968375e-06
Epoch: 4 cost time: 5.608844995498657
Epoch: 4, Steps: 979 | Train Loss: 0.6491713 Vali Loss: 0.5584775 Best vali loss: 0.5433522
	iters: 100, epoch: 5 | loss: 0.5891129
	speed: 0.0159s/iter; left time: 60.5934s
	iters: 200, epoch: 5 | loss: 0.4670172
	speed: 0.0050s/iter; left time: 18.6196s
	iters: 300, epoch: 5 | loss: 0.7112977
	speed: 0.0049s/iter; left time: 17.7702s
	iters: 400, epoch: 5 | loss: 0.6313815
	speed: 0.0050s/iter; left time: 17.5898s
	iters: 500, epoch: 5 | loss: 0.4268640
	speed: 0.0051s/iter; left time: 17.5886s
	iters: 600, epoch: 5 | loss: 1.0104125
	speed: 0.0054s/iter; left time: 18.0542s
	iters: 700, epoch: 5 | loss: 0.9498573
	speed: 0.0054s/iter; left time: 17.3090s
	iters: 800, epoch: 5 | loss: 1.3240707
	speed: 0.0053s/iter; left time: 16.6190s
	iters: 900, epoch: 5 | loss: 1.3042203
	speed: 0.0054s/iter; left time: 16.3756s
Updating learning rate to 4.59894841875e-06
Epoch: 5 cost time: 5.154824256896973
Epoch: 5, Steps: 979 | Train Loss: 0.8238038 Vali Loss: 0.5464933 Best vali loss: 0.5433522
	iters: 100, epoch: 6 | loss: 0.6934599
	speed: 0.0169s/iter; left time: 47.9533s
	iters: 200, epoch: 6 | loss: 0.8680019
	speed: 0.0054s/iter; left time: 14.7053s
	iters: 300, epoch: 6 | loss: 0.3178629
	speed: 0.0054s/iter; left time: 14.2846s
	iters: 400, epoch: 6 | loss: 0.4764492
	speed: 0.0055s/iter; left time: 14.0519s
	iters: 500, epoch: 6 | loss: 0.2671395
	speed: 0.0055s/iter; left time: 13.5294s
	iters: 600, epoch: 6 | loss: 1.3261691
	speed: 0.0058s/iter; left time: 13.5376s
	iters: 700, epoch: 6 | loss: 0.8067213
	speed: 0.0056s/iter; left time: 12.5315s
	iters: 800, epoch: 6 | loss: 0.4776515
	speed: 0.0055s/iter; left time: 11.8398s
	iters: 900, epoch: 6 | loss: 0.7172461
	speed: 0.0054s/iter; left time: 11.0804s
Updating learning rate to 2.299474209375e-06
Epoch: 6 cost time: 5.439420461654663
Epoch: 6, Steps: 979 | Train Loss: 0.6611890 Vali Loss: 0.5518517 Best vali loss: 0.5433522
	iters: 100, epoch: 7 | loss: 0.8714439
	speed: 0.0164s/iter; left time: 30.4888s
	iters: 200, epoch: 7 | loss: 1.0113153
	speed: 0.0056s/iter; left time: 9.7926s
	iters: 300, epoch: 7 | loss: 0.5695071
	speed: 0.0057s/iter; left time: 9.4731s
	iters: 400, epoch: 7 | loss: 0.2481117
	speed: 0.0055s/iter; left time: 8.5300s
	iters: 500, epoch: 7 | loss: 1.1349472
	speed: 0.0058s/iter; left time: 8.4903s
	iters: 600, epoch: 7 | loss: 0.3682482
	speed: 0.0056s/iter; left time: 7.6037s
	iters: 700, epoch: 7 | loss: 0.3019927
	speed: 0.0055s/iter; left time: 6.9593s
	iters: 800, epoch: 7 | loss: 0.5195609
	speed: 0.0056s/iter; left time: 6.4917s
	iters: 900, epoch: 7 | loss: 0.9686925
	speed: 0.0057s/iter; left time: 6.0271s
Updating learning rate to 1.1497371046875e-06
Epoch: 7 cost time: 5.520543336868286
Epoch: 7, Steps: 979 | Train Loss: 0.6659799 Vali Loss: 0.5479022 Best vali loss: 0.5433522
	iters: 100, epoch: 8 | loss: 0.9419891
	speed: 0.0167s/iter; left time: 14.6756s
	iters: 200, epoch: 8 | loss: 0.3700419
	speed: 0.0056s/iter; left time: 4.3832s
	iters: 300, epoch: 8 | loss: 0.2484481
	speed: 0.0054s/iter; left time: 3.6735s
	iters: 400, epoch: 8 | loss: 0.6790950
	speed: 0.0052s/iter; left time: 2.9989s
	iters: 500, epoch: 8 | loss: 1.0985903
	speed: 0.0052s/iter; left time: 2.5102s
	iters: 600, epoch: 8 | loss: 0.3504972
	speed: 0.0052s/iter; left time: 1.9733s
	iters: 700, epoch: 8 | loss: 0.4202757
	speed: 0.0053s/iter; left time: 1.4771s
	iters: 800, epoch: 8 | loss: 0.5537916
	speed: 0.0051s/iter; left time: 0.9165s
	iters: 900, epoch: 8 | loss: 1.0260105
	speed: 0.0052s/iter; left time: 0.4125s
Updating learning rate to 5.7486855234375e-07
Epoch: 8 cost time: 5.240712881088257
Epoch: 8, Steps: 979 | Train Loss: 0.6320822 Vali Loss: 0.5464341 Best vali loss: 0.5433522

best validation loss 0.5433521830528105

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0057815646796, 'e_layers': 3, 'learning_rate': 0.0002015534199, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002015534199
Validation loss decreased (inf --> 0.6071).  Saving model state dict ...
Epoch: 1 cost time: 1.0731244087219238
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6070583 Best vali loss: 0.6070583
Updating learning rate to 0.00010077670995
Validation loss decreased (0.6071 --> 0.5975).  Saving model state dict ...
Epoch: 2 cost time: 0.7851405143737793
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5975143 Best vali loss: 0.5975143
Updating learning rate to 5.0388354975e-05
Validation loss decreased (0.5975 --> 0.5549).  Saving model state dict ...
Epoch: 3 cost time: 0.7827010154724121
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5548884 Best vali loss: 0.5548884
Updating learning rate to 2.51941774875e-05
Validation loss decreased (0.5549 --> 0.5539).  Saving model state dict ...
Epoch: 4 cost time: 0.8078758716583252
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5539380 Best vali loss: 0.5539380
Updating learning rate to 1.259708874375e-05
Validation loss decreased (0.5539 --> 0.5391).  Saving model state dict ...
Epoch: 5 cost time: 0.7719471454620361
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5391313 Best vali loss: 0.5391313
Updating learning rate to 6.298544371875e-06
Epoch: 6 cost time: 0.7664663791656494
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5451668 Best vali loss: 0.5391313
Updating learning rate to 3.1492721859375e-06
Epoch: 7 cost time: 0.7665951251983643
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5463310 Best vali loss: 0.5391313
Updating learning rate to 1.57463609296875e-06
Epoch: 8 cost time: 0.7457797527313232
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5456954 Best vali loss: 0.5391313

best validation loss 0.539131259625844

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489712039, 'e_layers': 2, 'learning_rate': 0.0002964294311, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7742981
	speed: 0.0118s/iter; left time: 10.4261s
Updating learning rate to 0.00028514725766362733
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0276262760162354
Epoch: 1, Steps: 123 | Train Loss: 0.7742981 Vali Loss: 0.6171833 Best vali loss: 0.6171833
	iters: 100, epoch: 2 | loss: 0.9624587
	speed: 0.0093s/iter; left time: 7.1247s
Updating learning rate to 0.0002530183459870402
Validation loss decreased (0.6172 --> 0.5577).  Saving model state dict ...
Epoch: 2 cost time: 0.7271482944488525
Epoch: 2, Steps: 123 | Train Loss: 0.9624587 Vali Loss: 0.5576914 Best vali loss: 0.5576914
	iters: 100, epoch: 3 | loss: 0.8540279
	speed: 0.0093s/iter; left time: 5.9701s
Updating learning rate to 0.00020493403162368947
Validation loss decreased (0.5577 --> 0.5550).  Saving model state dict ...
Epoch: 3 cost time: 0.7206735610961914
Epoch: 3, Steps: 123 | Train Loss: 0.8540279 Vali Loss: 0.5549992 Best vali loss: 0.5549992
	iters: 100, epoch: 4 | loss: 0.4902945
	speed: 0.0095s/iter; left time: 4.8777s
Updating learning rate to 0.00014821471555
Epoch: 4 cost time: 0.7231700420379639
Epoch: 4, Steps: 123 | Train Loss: 0.4902945 Vali Loss: 0.5565603 Best vali loss: 0.5549992
	iters: 100, epoch: 5 | loss: 0.5573199
	speed: 0.0090s/iter; left time: 3.5346s
Updating learning rate to 9.149539947631057e-05
Validation loss decreased (0.5550 --> 0.5263).  Saving model state dict ...
Epoch: 5 cost time: 0.7284786701202393
Epoch: 5, Steps: 123 | Train Loss: 0.5573199 Vali Loss: 0.5262642 Best vali loss: 0.5262642
	iters: 100, epoch: 6 | loss: 0.5879677
	speed: 0.0093s/iter; left time: 2.5242s
Updating learning rate to 4.341108511295978e-05
Epoch: 6 cost time: 0.7253634929656982
Epoch: 6, Steps: 123 | Train Loss: 0.5879677 Vali Loss: 0.5330650 Best vali loss: 0.5262642
	iters: 100, epoch: 7 | loss: 0.5391302
	speed: 0.0089s/iter; left time: 1.3091s
Updating learning rate to 1.128217343637266e-05
Epoch: 7 cost time: 0.7237124443054199
Epoch: 7, Steps: 123 | Train Loss: 0.5391302 Vali Loss: 0.5403537 Best vali loss: 0.5262642
	iters: 100, epoch: 8 | loss: 0.6972409
	speed: 0.0090s/iter; left time: 0.2154s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7147362232208252
Epoch: 8, Steps: 123 | Train Loss: 0.6972409 Vali Loss: 0.5436964 Best vali loss: 0.5262642

best validation loss 0.5262641682772656

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0069636340132, 'e_layers': 4, 'learning_rate': 0.0003069692346, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1796708
	speed: 0.0133s/iter; left time: 11.8146s
Updating learning rate to 0.00029528591377879775
Validation loss decreased (inf --> 0.6077).  Saving model state dict ...
Epoch: 1 cost time: 1.2068190574645996
Epoch: 1, Steps: 123 | Train Loss: 1.1796708 Vali Loss: 0.6076703 Best vali loss: 0.6076703
	iters: 100, epoch: 2 | loss: 0.6730027
	speed: 0.0107s/iter; left time: 8.1655s
Updating learning rate to 0.0002620146310006521
Validation loss decreased (0.6077 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.8803207874298096
Epoch: 2, Steps: 123 | Train Loss: 0.6730027 Vali Loss: 0.5995150 Best vali loss: 0.5995150
	iters: 100, epoch: 3 | loss: 0.6547125
	speed: 0.0112s/iter; left time: 7.1308s
Updating learning rate to 0.00021222063746360626
Validation loss decreased (0.5995 --> 0.5655).  Saving model state dict ...
Epoch: 3 cost time: 0.9234554767608643
Epoch: 3, Steps: 123 | Train Loss: 0.6547125 Vali Loss: 0.5655041 Best vali loss: 0.5655041

best validation loss 0.5655041084914006

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010648312846, 'e_layers': 4, 'learning_rate': 0.0004706723624, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6569715
	speed: 0.0118s/iter; left time: 21.9041s
	iters: 200, epoch: 1 | loss: 0.7724425
	speed: 0.0055s/iter; left time: 9.6661s
Updating learning rate to 0.0004706723624
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 1.6962406635284424
Epoch: 1, Steps: 245 | Train Loss: 0.7147070 Vali Loss: 0.6099017 Best vali loss: 0.6099017
	iters: 100, epoch: 2 | loss: 0.8319617
	speed: 0.0109s/iter; left time: 17.6407s
	iters: 200, epoch: 2 | loss: 0.7767953
	speed: 0.0053s/iter; left time: 7.9783s
Updating learning rate to 0.0002353361812
Validation loss decreased (0.6099 --> 0.5916).  Saving model state dict ...
Epoch: 2 cost time: 1.3767414093017578
Epoch: 2, Steps: 245 | Train Loss: 0.8043785 Vali Loss: 0.5915818 Best vali loss: 0.5915818
	iters: 100, epoch: 3 | loss: 1.1251167
	speed: 0.0112s/iter; left time: 15.3889s
	iters: 200, epoch: 3 | loss: 0.7202424
	speed: 0.0057s/iter; left time: 7.2659s
Updating learning rate to 0.0001176680906
Validation loss decreased (0.5916 --> 0.5473).  Saving model state dict ...
Epoch: 3 cost time: 1.4534554481506348
Epoch: 3, Steps: 245 | Train Loss: 0.9226796 Vali Loss: 0.5473075 Best vali loss: 0.5473075

best validation loss 0.5473075081274941

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010526483111, 'e_layers': 2, 'learning_rate': 0.00043787105, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0316699
	speed: 0.0111s/iter; left time: 9.7848s
Updating learning rate to 0.00043787105
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 0.9332289695739746
Epoch: 1, Steps: 123 | Train Loss: 1.0316699 Vali Loss: 0.6139600 Best vali loss: 0.6139600
	iters: 100, epoch: 2 | loss: 0.8585438
	speed: 0.0081s/iter; left time: 6.1775s
Updating learning rate to 0.000218935525
Validation loss decreased (0.6140 --> 0.5828).  Saving model state dict ...
Epoch: 2 cost time: 0.6410512924194336
Epoch: 2, Steps: 123 | Train Loss: 0.8585438 Vali Loss: 0.5828267 Best vali loss: 0.5828267
	iters: 100, epoch: 3 | loss: 0.7987844
	speed: 0.0079s/iter; left time: 5.0534s
Updating learning rate to 0.0001094677625
Validation loss decreased (0.5828 --> 0.5501).  Saving model state dict ...
Epoch: 3 cost time: 0.6102597713470459
Epoch: 3, Steps: 123 | Train Loss: 0.7987844 Vali Loss: 0.5500797 Best vali loss: 0.5500797

best validation loss 0.5500796521526418

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010648312846, 'e_layers': 4, 'learning_rate': 0.0004706723624, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5518303
	speed: 0.0122s/iter; left time: 13.7633s
	iters: 200, epoch: 4 | loss: 0.6997322
	speed: 0.0056s/iter; left time: 5.7446s
Updating learning rate to 5.88340453e-05
Validation loss decreased (0.5473 --> 0.5425).  Saving model state dict ...
Epoch: 4 cost time: 1.7385411262512207
Epoch: 4, Steps: 245 | Train Loss: 0.6257813 Vali Loss: 0.5425478 Best vali loss: 0.5425478
	iters: 100, epoch: 5 | loss: 0.6192203
	speed: 0.0115s/iter; left time: 10.1664s
	iters: 200, epoch: 5 | loss: 0.5688250
	speed: 0.0059s/iter; left time: 4.5968s
Updating learning rate to 2.941702265e-05
Validation loss decreased (0.5425 --> 0.5365).  Saving model state dict ...
Epoch: 5 cost time: 1.483555793762207
Epoch: 5, Steps: 245 | Train Loss: 0.5940227 Vali Loss: 0.5365002 Best vali loss: 0.5365002
	iters: 100, epoch: 6 | loss: 1.0645911
	speed: 0.0113s/iter; left time: 7.1938s
	iters: 200, epoch: 6 | loss: 0.6825966
	speed: 0.0059s/iter; left time: 3.1634s
Updating learning rate to 1.4708511325e-05
Epoch: 6 cost time: 1.4876782894134521
Epoch: 6, Steps: 245 | Train Loss: 0.8735938 Vali Loss: 0.5372121 Best vali loss: 0.5365002
	iters: 100, epoch: 7 | loss: 0.6890610
	speed: 0.0110s/iter; left time: 4.3193s
	iters: 200, epoch: 7 | loss: 0.6937284
	speed: 0.0053s/iter; left time: 1.5405s
Updating learning rate to 7.3542556625e-06
Epoch: 7 cost time: 1.372041940689087
Epoch: 7, Steps: 245 | Train Loss: 0.6913947 Vali Loss: 0.5372672 Best vali loss: 0.5365002
	iters: 100, epoch: 8 | loss: 0.8893042
	speed: 0.0107s/iter; left time: 1.5653s
	iters: 200, epoch: 8 | loss: 0.6822137
	speed: 0.0059s/iter; left time: 0.2723s
Updating learning rate to 3.67712783125e-06
Epoch: 8 cost time: 1.4878394603729248
Epoch: 8, Steps: 245 | Train Loss: 0.7857589 Vali Loss: 0.5381727 Best vali loss: 0.5365002

best validation loss 0.5365001972159651

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.001042883632, 'e_layers': 4, 'learning_rate': 0.0004297808198, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004297808198
Validation loss decreased (inf --> 0.6020).  Saving model state dict ...
Epoch: 1 cost time: 0.8897659778594971
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6020321 Best vali loss: 0.6020321
Updating learning rate to 0.0002148904099
Validation loss decreased (0.6020 --> 0.5518).  Saving model state dict ...
Epoch: 2 cost time: 0.5870072841644287
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5517584 Best vali loss: 0.5517584
Updating learning rate to 0.00010744520495
Epoch: 3 cost time: 0.6191520690917969
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5536934 Best vali loss: 0.5517584
Updating learning rate to 5.3722602475e-05
Validation loss decreased (0.5518 --> 0.5420).  Saving model state dict ...
Epoch: 4 cost time: 0.6188223361968994
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5419908 Best vali loss: 0.5419908
Updating learning rate to 2.68613012375e-05
Validation loss decreased (0.5420 --> 0.5413).  Saving model state dict ...
Epoch: 5 cost time: 0.5852377414703369
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5413162 Best vali loss: 0.5413162
Updating learning rate to 1.343065061875e-05
Epoch: 6 cost time: 0.5918564796447754
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5452815 Best vali loss: 0.5413162
Updating learning rate to 6.715325309375e-06
Epoch: 7 cost time: 0.5952663421630859
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5463539 Best vali loss: 0.5413162
Updating learning rate to 3.3576626546875e-06
Epoch: 8 cost time: 0.5953123569488525
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5458988 Best vali loss: 0.5413162

best validation loss 0.5413162017629853

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0010658857152, 'e_layers': 4, 'learning_rate': 0.0036506999494, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4170057
	speed: 0.0116s/iter; left time: 44.1936s
	iters: 200, epoch: 1 | loss: 1.1955668
	speed: 0.0052s/iter; left time: 19.3234s
	iters: 300, epoch: 1 | loss: 1.4316003
	speed: 0.0053s/iter; left time: 19.0991s
	iters: 400, epoch: 1 | loss: 0.8130372
	speed: 0.0055s/iter; left time: 19.5035s
Updating learning rate to 0.0036506999494
Validation loss decreased (inf --> 0.6554).  Saving model state dict ...
Epoch: 1 cost time: 2.95310640335083
Epoch: 1, Steps: 490 | Train Loss: 0.9643025 Vali Loss: 0.6553566 Best vali loss: 0.6553566
	iters: 100, epoch: 2 | loss: 0.9062392
	speed: 0.0137s/iter; left time: 45.7681s
	iters: 200, epoch: 2 | loss: 0.9074579
	speed: 0.0051s/iter; left time: 16.3696s
	iters: 300, epoch: 2 | loss: 1.3384675
	speed: 0.0048s/iter; left time: 14.9825s
	iters: 400, epoch: 2 | loss: 0.5266422
	speed: 0.0050s/iter; left time: 15.1363s
Updating learning rate to 0.0018253499747
Validation loss decreased (0.6554 --> 0.6492).  Saving model state dict ...
Epoch: 2 cost time: 2.4640743732452393
Epoch: 2, Steps: 490 | Train Loss: 0.9197017 Vali Loss: 0.6491796 Best vali loss: 0.6491796
	iters: 100, epoch: 3 | loss: 1.2867467
	speed: 0.0136s/iter; left time: 38.6088s
	iters: 200, epoch: 3 | loss: 0.9692968
	speed: 0.0053s/iter; left time: 14.4360s
	iters: 300, epoch: 3 | loss: 0.9338703
	speed: 0.0052s/iter; left time: 13.6268s
	iters: 400, epoch: 3 | loss: 1.6219110
	speed: 0.0052s/iter; left time: 13.2661s
Updating learning rate to 0.00091267498735
Validation loss decreased (0.6492 --> 0.6469).  Saving model state dict ...
Epoch: 3 cost time: 2.5789833068847656
Epoch: 3, Steps: 490 | Train Loss: 1.2029562 Vali Loss: 0.6468780 Best vali loss: 0.6468780
	iters: 100, epoch: 4 | loss: 1.1622953
	speed: 0.0140s/iter; left time: 32.9095s
	iters: 200, epoch: 4 | loss: 0.8504944
	speed: 0.0055s/iter; left time: 12.4768s
	iters: 300, epoch: 4 | loss: 0.5940406
	speed: 0.0056s/iter; left time: 12.0008s
	iters: 400, epoch: 4 | loss: 0.4497745
	speed: 0.0054s/iter; left time: 11.1300s
Updating learning rate to 0.000456337493675
Epoch: 4 cost time: 2.7448952198028564
Epoch: 4, Steps: 490 | Train Loss: 0.7641512 Vali Loss: 0.6497719 Best vali loss: 0.6468780
	iters: 100, epoch: 5 | loss: 0.8788344
	speed: 0.0143s/iter; left time: 26.5248s
	iters: 200, epoch: 5 | loss: 0.7402275
	speed: 0.0052s/iter; left time: 9.2067s
	iters: 300, epoch: 5 | loss: 0.6125536
	speed: 0.0053s/iter; left time: 8.7970s
	iters: 400, epoch: 5 | loss: 1.2035780
	speed: 0.0051s/iter; left time: 7.9787s
Updating learning rate to 0.0002281687468375
Validation loss decreased (0.6469 --> 0.6440).  Saving model state dict ...
Epoch: 5 cost time: 2.5699193477630615
Epoch: 5, Steps: 490 | Train Loss: 0.8587984 Vali Loss: 0.6440163 Best vali loss: 0.6440163
	iters: 100, epoch: 6 | loss: 1.1919781
	speed: 0.0138s/iter; left time: 18.8880s
	iters: 200, epoch: 6 | loss: 0.4646753
	speed: 0.0052s/iter; left time: 6.5675s
	iters: 300, epoch: 6 | loss: 0.9019870
	speed: 0.0051s/iter; left time: 6.0231s
	iters: 400, epoch: 6 | loss: 0.5912361
	speed: 0.0051s/iter; left time: 5.4381s
Updating learning rate to 0.00011408437341875
Validation loss decreased (0.6440 --> 0.6431).  Saving model state dict ...
Epoch: 6 cost time: 2.5533103942871094
Epoch: 6, Steps: 490 | Train Loss: 0.7874691 Vali Loss: 0.6430904 Best vali loss: 0.6430904
	iters: 100, epoch: 7 | loss: 1.2897788
	speed: 0.0142s/iter; left time: 12.5047s
	iters: 200, epoch: 7 | loss: 1.1755081
	speed: 0.0053s/iter; left time: 4.1171s
	iters: 300, epoch: 7 | loss: 0.7077985
	speed: 0.0056s/iter; left time: 3.8088s
	iters: 400, epoch: 7 | loss: 1.0774447
	speed: 0.0056s/iter; left time: 3.2724s
Updating learning rate to 5.7042186709375e-05
Epoch: 7 cost time: 2.7464873790740967
Epoch: 7, Steps: 490 | Train Loss: 1.0626325 Vali Loss: 0.6434654 Best vali loss: 0.6430904
	iters: 100, epoch: 8 | loss: 0.4563145
	speed: 0.0146s/iter; left time: 5.7076s
	iters: 200, epoch: 8 | loss: 0.7957315
	speed: 0.0056s/iter; left time: 1.6314s
	iters: 300, epoch: 8 | loss: 0.8288196
	speed: 0.0056s/iter; left time: 1.0621s
	iters: 400, epoch: 8 | loss: 0.6521648
	speed: 0.0055s/iter; left time: 0.5003s
Updating learning rate to 2.85210933546875e-05
Epoch: 8 cost time: 2.7611310482025146
Epoch: 8, Steps: 490 | Train Loss: 0.6832576 Vali Loss: 0.6438037 Best vali loss: 0.6430904

best validation loss 0.6430904302868452

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010653163857, 'e_layers': 3, 'learning_rate': 0.0031935310842, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8380638
	speed: 0.0108s/iter; left time: 41.1791s
	iters: 200, epoch: 1 | loss: 1.3610375
	speed: 0.0045s/iter; left time: 16.9042s
	iters: 300, epoch: 1 | loss: 1.4884866
	speed: 0.0046s/iter; left time: 16.6375s
	iters: 400, epoch: 1 | loss: 0.6857572
	speed: 0.0048s/iter; left time: 16.8977s
Updating learning rate to 0.0030719845446654796
Validation loss decreased (inf --> 0.6631).  Saving model state dict ...
Epoch: 1 cost time: 2.621492624282837
Epoch: 1, Steps: 490 | Train Loss: 1.0933363 Vali Loss: 0.6631472 Best vali loss: 0.6631472
	iters: 100, epoch: 2 | loss: 0.7957879
	speed: 0.0123s/iter; left time: 41.0549s
	iters: 200, epoch: 2 | loss: 0.8751450
	speed: 0.0045s/iter; left time: 14.6667s
	iters: 300, epoch: 2 | loss: 0.8788398
	speed: 0.0043s/iter; left time: 13.5710s
	iters: 400, epoch: 2 | loss: 0.7424981
	speed: 0.0041s/iter; left time: 12.5063s
Updating learning rate to 0.0027258492848839235
Validation loss decreased (0.6631 --> 0.6428).  Saving model state dict ...
Epoch: 2 cost time: 2.1354146003723145
Epoch: 2, Steps: 490 | Train Loss: 0.8230677 Vali Loss: 0.6427636 Best vali loss: 0.6427636
	iters: 100, epoch: 3 | loss: 0.6233974
	speed: 0.0112s/iter; left time: 31.8440s
	iters: 200, epoch: 3 | loss: 0.5928187
	speed: 0.0040s/iter; left time: 11.0683s
	iters: 300, epoch: 3 | loss: 0.9834734
	speed: 0.0040s/iter; left time: 10.5398s
	iters: 400, epoch: 3 | loss: 1.1209214
	speed: 0.0040s/iter; left time: 10.1208s
Updating learning rate to 0.0022078212604331317
Validation loss decreased (0.6428 --> 0.6399).  Saving model state dict ...
Epoch: 3 cost time: 2.023902654647827
Epoch: 3, Steps: 490 | Train Loss: 0.8301527 Vali Loss: 0.6399217 Best vali loss: 0.6399217

best validation loss 0.6399217083436479

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.001044313366, 'e_layers': 3, 'learning_rate': 0.0019538028257, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6884791
	speed: 0.0115s/iter; left time: 10.2133s
Updating learning rate to 0.0018794406334634733
Validation loss decreased (inf --> 0.6037).  Saving model state dict ...
Epoch: 1 cost time: 1.0100784301757812
Epoch: 1, Steps: 123 | Train Loss: 0.6884791 Vali Loss: 0.6036585 Best vali loss: 0.6036585
	iters: 100, epoch: 2 | loss: 0.7052666
	speed: 0.0088s/iter; left time: 6.6868s
Updating learning rate to 0.001667675026426954
Epoch: 2 cost time: 0.7122488021850586
Epoch: 2, Steps: 123 | Train Loss: 0.7052666 Vali Loss: 0.6094489 Best vali loss: 0.6036585
	iters: 100, epoch: 3 | loss: 0.9003810
	speed: 0.0085s/iter; left time: 5.4461s
Updating learning rate to 0.0013507453986017436
Epoch: 3 cost time: 0.6905477046966553
Epoch: 3, Steps: 123 | Train Loss: 0.9003810 Vali Loss: 0.6098698 Best vali loss: 0.6036585

best validation loss 0.6036585308456245

[INFO][smbo.py:320] Finished 950 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008153470326, 'e_layers': 1, 'learning_rate': 0.0002984485292, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6854748
	speed: 0.0088s/iter; left time: 33.5815s
	iters: 200, epoch: 1 | loss: 0.7957083
	speed: 0.0026s/iter; left time: 9.7130s
	iters: 300, epoch: 1 | loss: 1.6252167
	speed: 0.0025s/iter; left time: 9.0301s
	iters: 400, epoch: 1 | loss: 0.6567050
	speed: 0.0026s/iter; left time: 9.0636s
Updating learning rate to 0.00028708950841798857
Validation loss decreased (inf --> 0.5946).  Saving model state dict ...
Epoch: 1 cost time: 1.6063177585601807
Epoch: 1, Steps: 490 | Train Loss: 0.9407762 Vali Loss: 0.5945718 Best vali loss: 0.5945718
	iters: 100, epoch: 2 | loss: 1.1938909
	speed: 0.0083s/iter; left time: 27.7431s
	iters: 200, epoch: 2 | loss: 0.7923488
	speed: 0.0026s/iter; left time: 8.5116s
	iters: 300, epoch: 2 | loss: 0.7286354
	speed: 0.0027s/iter; left time: 8.3430s
	iters: 400, epoch: 2 | loss: 0.4534408
	speed: 0.0026s/iter; left time: 7.9150s
Updating learning rate to 0.00025474175401623563
Epoch: 2 cost time: 1.3442001342773438
Epoch: 2, Steps: 490 | Train Loss: 0.7920790 Vali Loss: 0.6071212 Best vali loss: 0.5945718
	iters: 100, epoch: 3 | loss: 0.9335868
	speed: 0.0083s/iter; left time: 23.6936s
	iters: 200, epoch: 3 | loss: 0.8016619
	speed: 0.0028s/iter; left time: 7.6895s
	iters: 300, epoch: 3 | loss: 0.8894162
	speed: 0.0028s/iter; left time: 7.3370s
	iters: 400, epoch: 3 | loss: 0.8392117
	speed: 0.0028s/iter; left time: 7.0210s
Updating learning rate to 0.00020632991836928437
Epoch: 3 cost time: 1.4111106395721436
Epoch: 3, Steps: 490 | Train Loss: 0.8659691 Vali Loss: 0.6246396 Best vali loss: 0.5945718

best validation loss 0.5945717928476877

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008153470326, 'e_layers': 1, 'learning_rate': 0.0002984485292, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3588516
	speed: 0.0090s/iter; left time: 21.0772s
	iters: 200, epoch: 4 | loss: 0.7622840
	speed: 0.0025s/iter; left time: 5.6004s
	iters: 300, epoch: 4 | loss: 1.2267187
	speed: 0.0025s/iter; left time: 5.3344s
	iters: 400, epoch: 4 | loss: 0.5364267
	speed: 0.0025s/iter; left time: 5.1357s
Updating learning rate to 0.0001492242646
Epoch: 4 cost time: 1.5816011428833008
Epoch: 4, Steps: 490 | Train Loss: 0.7210702 Vali Loss: 0.6385984 Best vali loss: 0.5945718
	iters: 100, epoch: 5 | loss: 1.0697289
	speed: 0.0082s/iter; left time: 15.2683s
	iters: 200, epoch: 5 | loss: 0.7242185
	speed: 0.0028s/iter; left time: 4.8570s
	iters: 300, epoch: 5 | loss: 0.6921133
	speed: 0.0028s/iter; left time: 4.6270s
	iters: 400, epoch: 5 | loss: 0.4294141
	speed: 0.0028s/iter; left time: 4.3556s
Updating learning rate to 9.211861083071564e-05
Epoch: 5 cost time: 1.3900575637817383
Epoch: 5, Steps: 490 | Train Loss: 0.7288687 Vali Loss: 0.6490102 Best vali loss: 0.5945718
	iters: 100, epoch: 6 | loss: 0.8744588
	speed: 0.0081s/iter; left time: 11.0957s
	iters: 200, epoch: 6 | loss: 0.7582951
	speed: 0.0026s/iter; left time: 3.3435s
	iters: 300, epoch: 6 | loss: 0.8392888
	speed: 0.0028s/iter; left time: 3.2388s
	iters: 400, epoch: 6 | loss: 0.7916774
	speed: 0.0027s/iter; left time: 2.8391s
Updating learning rate to 4.370677518376434e-05
Epoch: 6 cost time: 1.3536601066589355
Epoch: 6, Steps: 490 | Train Loss: 0.8159300 Vali Loss: 0.6305126 Best vali loss: 0.5945718
	iters: 100, epoch: 7 | loss: 0.3500374
	speed: 0.0079s/iter; left time: 7.0028s
	iters: 200, epoch: 7 | loss: 0.5964616
	speed: 0.0027s/iter; left time: 2.0753s
	iters: 300, epoch: 7 | loss: 0.5580565
	speed: 0.0026s/iter; left time: 1.7542s
	iters: 400, epoch: 7 | loss: 0.5426660
	speed: 0.0026s/iter; left time: 1.5037s
Updating learning rate to 1.1359020782011444e-05
Epoch: 7 cost time: 1.315068006515503
Epoch: 7, Steps: 490 | Train Loss: 0.5118054 Vali Loss: 0.6396293 Best vali loss: 0.5945718
	iters: 100, epoch: 8 | loss: 0.8945230
	speed: 0.0081s/iter; left time: 3.1641s
	iters: 200, epoch: 8 | loss: 0.4550471
	speed: 0.0026s/iter; left time: 0.7592s
	iters: 300, epoch: 8 | loss: 0.8057414
	speed: 0.0026s/iter; left time: 0.4930s
	iters: 400, epoch: 8 | loss: 0.6215519
	speed: 0.0026s/iter; left time: 0.2336s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3259813785552979
Epoch: 8, Steps: 490 | Train Loss: 0.6942158 Vali Loss: 0.6386725 Best vali loss: 0.5945718

best validation loss 0.5945717928476877

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.000862815022, 'e_layers': 3, 'learning_rate': 0.0005295919605, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4885021
	speed: 0.0102s/iter; left time: 39.0682s
	iters: 200, epoch: 1 | loss: 1.0157470
	speed: 0.0039s/iter; left time: 14.6759s
	iters: 300, epoch: 1 | loss: 0.3752763
	speed: 0.0039s/iter; left time: 13.9779s
	iters: 400, epoch: 1 | loss: 0.4592877
	speed: 0.0039s/iter; left time: 13.6997s
Updating learning rate to 0.0005094355666942379
Validation loss decreased (inf --> 0.6136).  Saving model state dict ...
Epoch: 1 cost time: 2.276695966720581
Epoch: 1, Steps: 490 | Train Loss: 0.5847032 Vali Loss: 0.6136063 Best vali loss: 0.6136063
	iters: 100, epoch: 2 | loss: 1.0216191
	speed: 0.0113s/iter; left time: 37.7650s
	iters: 200, epoch: 2 | loss: 0.5282223
	speed: 0.0041s/iter; left time: 13.0916s
	iters: 300, epoch: 2 | loss: 0.6095573
	speed: 0.0040s/iter; left time: 12.4866s
	iters: 400, epoch: 2 | loss: 0.8477092
	speed: 0.0039s/iter; left time: 11.8754s
Updating learning rate to 0.0004520350135157141
Epoch: 2 cost time: 2.015496253967285
Epoch: 2, Steps: 490 | Train Loss: 0.7517769 Vali Loss: 0.6157138 Best vali loss: 0.6136063
	iters: 100, epoch: 3 | loss: 0.9678779
	speed: 0.0112s/iter; left time: 31.6828s
	iters: 200, epoch: 3 | loss: 0.6825800
	speed: 0.0042s/iter; left time: 11.5820s
	iters: 300, epoch: 3 | loss: 0.6664689
	speed: 0.0046s/iter; left time: 12.1760s
	iters: 400, epoch: 3 | loss: 0.9462478
	speed: 0.0047s/iter; left time: 11.8693s
Updating learning rate to 0.00036612901484854853
Epoch: 3 cost time: 2.2243690490722656
Epoch: 3, Steps: 490 | Train Loss: 0.8157936 Vali Loss: 0.6706630 Best vali loss: 0.6136063
	iters: 100, epoch: 4 | loss: 0.8204586
	speed: 0.0120s/iter; left time: 28.2952s
	iters: 200, epoch: 4 | loss: 0.8933135
	speed: 0.0043s/iter; left time: 9.5882s
	iters: 300, epoch: 4 | loss: 0.9182988
	speed: 0.0042s/iter; left time: 8.9660s
	iters: 400, epoch: 4 | loss: 0.8634809
	speed: 0.0041s/iter; left time: 8.4453s
Updating learning rate to 0.00026479598025
Epoch: 4 cost time: 2.1202728748321533
Epoch: 4, Steps: 490 | Train Loss: 0.8738879 Vali Loss: 0.6276430 Best vali loss: 0.6136063
	iters: 100, epoch: 5 | loss: 0.4209863
	speed: 0.0120s/iter; left time: 22.4143s
	iters: 200, epoch: 5 | loss: 1.0532267
	speed: 0.0041s/iter; left time: 7.2453s
	iters: 300, epoch: 5 | loss: 0.9996263
	speed: 0.0041s/iter; left time: 6.7314s
	iters: 400, epoch: 5 | loss: 0.6634256
	speed: 0.0040s/iter; left time: 6.2978s
Updating learning rate to 0.0001634629456514515
Epoch: 5 cost time: 2.049696922302246
Epoch: 5, Steps: 490 | Train Loss: 0.7843162 Vali Loss: 0.6568006 Best vali loss: 0.6136063
	iters: 100, epoch: 6 | loss: 0.2465325
	speed: 0.0114s/iter; left time: 15.6021s
	iters: 200, epoch: 6 | loss: 0.6731689
	speed: 0.0042s/iter; left time: 5.3065s
	iters: 300, epoch: 6 | loss: 0.8424256
	speed: 0.0042s/iter; left time: 4.9289s
	iters: 400, epoch: 6 | loss: 0.6249986
	speed: 0.0040s/iter; left time: 4.2602s
Updating learning rate to 7.755694698428591e-05
Epoch: 6 cost time: 2.0799407958984375
Epoch: 6, Steps: 490 | Train Loss: 0.5967814 Vali Loss: 0.6668853 Best vali loss: 0.6136063
	iters: 100, epoch: 7 | loss: 0.6741875
	speed: 0.0121s/iter; left time: 10.7014s
	iters: 200, epoch: 7 | loss: 0.7298808
	speed: 0.0044s/iter; left time: 3.4014s
	iters: 300, epoch: 7 | loss: 0.8306242
	speed: 0.0043s/iter; left time: 2.9084s
	iters: 400, epoch: 7 | loss: 0.4513431
	speed: 0.0042s/iter; left time: 2.4614s
Updating learning rate to 2.0156393805762083e-05
Epoch: 7 cost time: 2.18196177482605
Epoch: 7, Steps: 490 | Train Loss: 0.6715089 Vali Loss: 0.6561027 Best vali loss: 0.6136063
	iters: 100, epoch: 8 | loss: 0.6211556
	speed: 0.0123s/iter; left time: 4.8080s
	iters: 200, epoch: 8 | loss: 0.7250204
	speed: 0.0044s/iter; left time: 1.2705s
	iters: 300, epoch: 8 | loss: 0.4201209
	speed: 0.0043s/iter; left time: 0.8125s
	iters: 400, epoch: 8 | loss: 0.5932625
	speed: 0.0043s/iter; left time: 0.3952s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1829452514648438
Epoch: 8, Steps: 490 | Train Loss: 0.5898898 Vali Loss: 0.6507398 Best vali loss: 0.6136063

best validation loss 0.6136062604748833

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009235247803, 'e_layers': 3, 'learning_rate': 0.0005151856679, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4882753
	speed: 0.0105s/iter; left time: 40.0190s
	iters: 200, epoch: 1 | loss: 1.0158104
	speed: 0.0042s/iter; left time: 15.6460s
	iters: 300, epoch: 1 | loss: 0.3833420
	speed: 0.0042s/iter; left time: 15.1639s
	iters: 400, epoch: 1 | loss: 0.4665199
	speed: 0.0042s/iter; left time: 14.8164s
Updating learning rate to 0.0004955775809579835
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 2.417278528213501
Epoch: 1, Steps: 490 | Train Loss: 0.5884869 Vali Loss: 0.6058368 Best vali loss: 0.6058368
	iters: 100, epoch: 2 | loss: 1.0286899
	speed: 0.0123s/iter; left time: 40.8069s
	iters: 200, epoch: 2 | loss: 0.5272736
	speed: 0.0045s/iter; left time: 14.6207s
	iters: 300, epoch: 2 | loss: 0.6161135
	speed: 0.0045s/iter; left time: 14.1374s
	iters: 400, epoch: 2 | loss: 0.8655171
	speed: 0.0047s/iter; left time: 14.2080s
Updating learning rate to 0.0004397384736211053
Epoch: 2 cost time: 2.3155698776245117
Epoch: 2, Steps: 490 | Train Loss: 0.7593985 Vali Loss: 0.6272061 Best vali loss: 0.6058368
	iters: 100, epoch: 3 | loss: 0.9366258
	speed: 0.0127s/iter; left time: 36.1691s
	iters: 200, epoch: 3 | loss: 0.6843982
	speed: 0.0043s/iter; left time: 11.7611s
	iters: 300, epoch: 3 | loss: 0.6689875
	speed: 0.0040s/iter; left time: 10.5553s
	iters: 400, epoch: 3 | loss: 0.9374353
	speed: 0.0041s/iter; left time: 10.4762s
Updating learning rate to 0.0003561693437986366
Epoch: 3 cost time: 2.1164257526397705
Epoch: 3, Steps: 490 | Train Loss: 0.8068617 Vali Loss: 0.6238545 Best vali loss: 0.6058368
	iters: 100, epoch: 4 | loss: 0.8206291
	speed: 0.0112s/iter; left time: 26.3490s
	iters: 200, epoch: 4 | loss: 1.0265137
	speed: 0.0042s/iter; left time: 9.3421s
	iters: 300, epoch: 4 | loss: 0.8809802
	speed: 0.0042s/iter; left time: 9.0605s
	iters: 400, epoch: 4 | loss: 0.8513990
	speed: 0.0044s/iter; left time: 8.9813s
Updating learning rate to 0.00025759283395
Validation loss decreased (0.6058 --> 0.5566).  Saving model state dict ...
Epoch: 4 cost time: 2.1038315296173096
Epoch: 4, Steps: 490 | Train Loss: 0.8948805 Vali Loss: 0.5566343 Best vali loss: 0.5566343
	iters: 100, epoch: 5 | loss: 0.4023598
	speed: 0.0122s/iter; left time: 22.7639s
	iters: 200, epoch: 5 | loss: 1.1275938
	speed: 0.0046s/iter; left time: 8.0486s
	iters: 300, epoch: 5 | loss: 0.9482840
	speed: 0.0045s/iter; left time: 7.5566s
	iters: 400, epoch: 5 | loss: 0.6239905
	speed: 0.0042s/iter; left time: 6.6128s
Updating learning rate to 0.0001590163241013634
Validation loss decreased (0.5566 --> 0.5528).  Saving model state dict ...
Epoch: 5 cost time: 2.2106316089630127
Epoch: 5, Steps: 490 | Train Loss: 0.7755570 Vali Loss: 0.5528309 Best vali loss: 0.5528309
	iters: 100, epoch: 6 | loss: 0.2195720
	speed: 0.0117s/iter; left time: 16.0082s
	iters: 200, epoch: 6 | loss: 0.6940089
	speed: 0.0043s/iter; left time: 5.5223s
	iters: 300, epoch: 6 | loss: 0.8042042
	speed: 0.0045s/iter; left time: 5.3094s
	iters: 400, epoch: 6 | loss: 0.5809368
	speed: 0.0047s/iter; left time: 4.9977s
Updating learning rate to 7.54471942788947e-05
Epoch: 6 cost time: 2.231044054031372
Epoch: 6, Steps: 490 | Train Loss: 0.5746805 Vali Loss: 0.5720403 Best vali loss: 0.5528309
	iters: 100, epoch: 7 | loss: 0.6038707
	speed: 0.0121s/iter; left time: 10.6924s
	iters: 200, epoch: 7 | loss: 0.6594301
	speed: 0.0041s/iter; left time: 3.2171s
	iters: 300, epoch: 7 | loss: 0.7976894
	speed: 0.0041s/iter; left time: 2.8184s
	iters: 400, epoch: 7 | loss: 0.3738931
	speed: 0.0040s/iter; left time: 2.2987s
Updating learning rate to 1.960808694201649e-05
Epoch: 7 cost time: 2.046811103820801
Epoch: 7, Steps: 490 | Train Loss: 0.6087208 Vali Loss: 0.5840894 Best vali loss: 0.5528309
	iters: 100, epoch: 8 | loss: 0.5613229
	speed: 0.0119s/iter; left time: 4.6364s
	iters: 200, epoch: 8 | loss: 0.6465461
	speed: 0.0046s/iter; left time: 1.3436s
	iters: 300, epoch: 8 | loss: 0.3551650
	speed: 0.0044s/iter; left time: 0.8436s
	iters: 400, epoch: 8 | loss: 0.5508471
	speed: 0.0045s/iter; left time: 0.4127s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.277573585510254
Epoch: 8, Steps: 490 | Train Loss: 0.5284703 Vali Loss: 0.5859748 Best vali loss: 0.5528309

best validation loss 0.5528308827945448

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001760801989, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8855202
	speed: 0.0118s/iter; left time: 10.4103s
Updating learning rate to 0.0001693785453721132
Validation loss decreased (inf --> 0.6032).  Saving model state dict ...
Epoch: 1 cost time: 1.0386996269226074
Epoch: 1, Steps: 123 | Train Loss: 0.8855202 Vali Loss: 0.6032147 Best vali loss: 0.6032147
	iters: 100, epoch: 2 | loss: 0.7471736
	speed: 0.0094s/iter; left time: 7.1467s
Updating learning rate to 0.000150293850787433
Validation loss decreased (0.6032 --> 0.5586).  Saving model state dict ...
Epoch: 2 cost time: 0.7389163970947266
Epoch: 2, Steps: 123 | Train Loss: 0.7471736 Vali Loss: 0.5586288 Best vali loss: 0.5586288
	iters: 100, epoch: 3 | loss: 0.6294105
	speed: 0.0095s/iter; left time: 6.0903s
Updating learning rate to 0.00012173158689328986
Epoch: 3 cost time: 0.7371916770935059
Epoch: 3, Steps: 123 | Train Loss: 0.6294105 Vali Loss: 0.5602805 Best vali loss: 0.5586288

best validation loss 0.5586288082880976

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0108004270441, 'e_layers': 4, 'learning_rate': 0.0036436229594, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8571610
	speed: 0.0127s/iter; left time: 11.2452s
Updating learning rate to 0.0035049458178889317
Validation loss decreased (inf --> 0.6243).  Saving model state dict ...
Epoch: 1 cost time: 1.150083065032959
Epoch: 1, Steps: 123 | Train Loss: 0.8571610 Vali Loss: 0.6243096 Best vali loss: 0.6243096
	iters: 100, epoch: 2 | loss: 0.8094019
	speed: 0.0102s/iter; left time: 7.8024s
Updating learning rate to 0.003110026731039368
Validation loss decreased (0.6243 --> 0.6207).  Saving model state dict ...
Epoch: 2 cost time: 0.845210075378418
Epoch: 2, Steps: 123 | Train Loss: 0.8094019 Vali Loss: 0.6206786 Best vali loss: 0.6206786
	iters: 100, epoch: 3 | loss: 0.7305512
	speed: 0.0104s/iter; left time: 6.6438s
Updating learning rate to 0.0025189885498737193
Validation loss decreased (0.6207 --> 0.6125).  Saving model state dict ...
Epoch: 3 cost time: 0.8326544761657715
Epoch: 3, Steps: 123 | Train Loss: 0.7305512 Vali Loss: 0.6125204 Best vali loss: 0.6125204

best validation loss 0.6125204028050583

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.001409823179, 'e_layers': 2, 'learning_rate': 0.0002636962103, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9943599
	speed: 0.0096s/iter; left time: 74.4915s
	iters: 200, epoch: 1 | loss: 0.8810650
	speed: 0.0034s/iter; left time: 26.3222s
	iters: 300, epoch: 1 | loss: 0.3788778
	speed: 0.0036s/iter; left time: 27.2189s
	iters: 400, epoch: 1 | loss: 0.2652372
	speed: 0.0036s/iter; left time: 26.7470s
	iters: 500, epoch: 1 | loss: 1.5146883
	speed: 0.0036s/iter; left time: 26.0375s
	iters: 600, epoch: 1 | loss: 0.6039992
	speed: 0.0035s/iter; left time: 24.9924s
	iters: 700, epoch: 1 | loss: 1.0705756
	speed: 0.0034s/iter; left time: 24.1710s
	iters: 800, epoch: 1 | loss: 0.9803220
	speed: 0.0031s/iter; left time: 21.8485s
	iters: 900, epoch: 1 | loss: 0.3555450
	speed: 0.0033s/iter; left time: 22.9967s
Updating learning rate to 0.000253659870898481
Validation loss decreased (inf --> 0.6188).  Saving model state dict ...
Epoch: 1 cost time: 3.68302845954895
Epoch: 1, Steps: 979 | Train Loss: 0.7827411 Vali Loss: 0.6187650 Best vali loss: 0.6187650
	iters: 100, epoch: 2 | loss: 0.7437115
	speed: 0.0112s/iter; left time: 75.5075s
	iters: 200, epoch: 2 | loss: 1.7839094
	speed: 0.0032s/iter; left time: 21.4455s
	iters: 300, epoch: 2 | loss: 0.2515829
	speed: 0.0033s/iter; left time: 21.3707s
	iters: 400, epoch: 2 | loss: 0.9714167
	speed: 0.0032s/iter; left time: 20.6108s
	iters: 500, epoch: 2 | loss: 0.6167769
	speed: 0.0031s/iter; left time: 20.0038s
	iters: 600, epoch: 2 | loss: 0.8969291
	speed: 0.0033s/iter; left time: 20.4556s
	iters: 700, epoch: 2 | loss: 0.6277382
	speed: 0.0033s/iter; left time: 20.0797s
	iters: 800, epoch: 2 | loss: 1.3536803
	speed: 0.0030s/iter; left time: 18.3388s
	iters: 900, epoch: 2 | loss: 1.1213689
	speed: 0.0031s/iter; left time: 18.4039s
Updating learning rate to 0.00022507879438816197
Validation loss decreased (0.6188 --> 0.5960).  Saving model state dict ...
Epoch: 2 cost time: 3.2079713344573975
Epoch: 2, Steps: 979 | Train Loss: 0.9296793 Vali Loss: 0.5959892 Best vali loss: 0.5959892
	iters: 100, epoch: 3 | loss: 0.6573627
	speed: 0.0115s/iter; left time: 66.5627s
	iters: 200, epoch: 3 | loss: 0.7529141
	speed: 0.0036s/iter; left time: 20.5806s
	iters: 300, epoch: 3 | loss: 0.7852109
	speed: 0.0034s/iter; left time: 19.1066s
	iters: 400, epoch: 3 | loss: 0.6229555
	speed: 0.0034s/iter; left time: 18.7141s
	iters: 500, epoch: 3 | loss: 0.4439588
	speed: 0.0035s/iter; left time: 18.6632s
	iters: 600, epoch: 3 | loss: 0.3798462
	speed: 0.0033s/iter; left time: 17.3646s
	iters: 700, epoch: 3 | loss: 0.2834664
	speed: 0.0031s/iter; left time: 16.1967s
	iters: 800, epoch: 3 | loss: 0.8569366
	speed: 0.0031s/iter; left time: 15.9475s
	iters: 900, epoch: 3 | loss: 1.0722046
	speed: 0.0031s/iter; left time: 15.5324s
Updating learning rate to 0.0001823041905796353
Epoch: 3 cost time: 3.2958171367645264
Epoch: 3, Steps: 979 | Train Loss: 0.6505395 Vali Loss: 0.6101509 Best vali loss: 0.5959892

best validation loss 0.5959891984717596

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001760801989, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7593380
	speed: 0.0123s/iter; left time: 6.3232s
Updating learning rate to 8.804009945e-05
Epoch: 4 cost time: 1.053107738494873
Epoch: 4, Steps: 123 | Train Loss: 0.7593380 Vali Loss: 0.5604458 Best vali loss: 0.5586288
	iters: 100, epoch: 5 | loss: 0.6140092
	speed: 0.0091s/iter; left time: 3.5798s
Updating learning rate to 5.434861200671015e-05
Validation loss decreased (0.5586 --> 0.5458).  Saving model state dict ...
Epoch: 5 cost time: 0.7278008460998535
Epoch: 5, Steps: 123 | Train Loss: 0.6140092 Vali Loss: 0.5457910 Best vali loss: 0.5457910
	iters: 100, epoch: 6 | loss: 0.5975971
	speed: 0.0095s/iter; left time: 2.5517s
Updating learning rate to 2.578634811256697e-05
Validation loss decreased (0.5458 --> 0.5407).  Saving model state dict ...
Epoch: 6 cost time: 0.7304952144622803
Epoch: 6, Steps: 123 | Train Loss: 0.5975971 Vali Loss: 0.5406645 Best vali loss: 0.5406645
	iters: 100, epoch: 7 | loss: 0.8625234
	speed: 0.0093s/iter; left time: 1.3719s
Updating learning rate to 6.701653527886807e-06
Validation loss decreased (0.5407 --> 0.5354).  Saving model state dict ...
Epoch: 7 cost time: 0.7336108684539795
Epoch: 7, Steps: 123 | Train Loss: 0.8625234 Vali Loss: 0.5353968 Best vali loss: 0.5353968
	iters: 100, epoch: 8 | loss: 0.7876794
	speed: 0.0093s/iter; left time: 0.2239s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7274243831634521
Epoch: 8, Steps: 123 | Train Loss: 0.7876794 Vali Loss: 0.5366612 Best vali loss: 0.5353968

best validation loss 0.5353967653055646

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0012486497136, 'e_layers': 1, 'learning_rate': 0.0003433151636, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4998106
	speed: 0.0089s/iter; left time: 68.6238s
	iters: 200, epoch: 1 | loss: 1.1330576
	speed: 0.0024s/iter; left time: 18.6604s
	iters: 300, epoch: 1 | loss: 0.8754656
	speed: 0.0025s/iter; left time: 18.7155s
	iters: 400, epoch: 1 | loss: 1.0827678
	speed: 0.0026s/iter; left time: 19.0546s
	iters: 500, epoch: 1 | loss: 0.8715344
	speed: 0.0026s/iter; left time: 18.7226s
	iters: 600, epoch: 1 | loss: 0.8354467
	speed: 0.0026s/iter; left time: 18.9200s
	iters: 700, epoch: 1 | loss: 0.2592671
	speed: 0.0026s/iter; left time: 18.8827s
	iters: 800, epoch: 1 | loss: 0.8184499
	speed: 0.0027s/iter; left time: 18.9363s
	iters: 900, epoch: 1 | loss: 1.2287202
	speed: 0.0026s/iter; left time: 18.0905s
Updating learning rate to 0.0003433151636
Validation loss decreased (inf --> 0.6489).  Saving model state dict ...
Epoch: 1 cost time: 2.880869150161743
Epoch: 1, Steps: 979 | Train Loss: 0.9560578 Vali Loss: 0.6489232 Best vali loss: 0.6489232
	iters: 100, epoch: 2 | loss: 0.7287335
	speed: 0.0090s/iter; left time: 61.1043s
	iters: 200, epoch: 2 | loss: 0.2927081
	speed: 0.0023s/iter; left time: 15.0640s
	iters: 300, epoch: 2 | loss: 0.6862012
	speed: 0.0023s/iter; left time: 15.0033s
	iters: 400, epoch: 2 | loss: 0.9842834
	speed: 0.0023s/iter; left time: 14.5314s
	iters: 500, epoch: 2 | loss: 0.9909984
	speed: 0.0022s/iter; left time: 13.9503s
	iters: 600, epoch: 2 | loss: 1.3014024
	speed: 0.0023s/iter; left time: 14.1243s
	iters: 700, epoch: 2 | loss: 0.9689822
	speed: 0.0023s/iter; left time: 14.3094s
	iters: 800, epoch: 2 | loss: 0.3605126
	speed: 0.0023s/iter; left time: 13.8833s
	iters: 900, epoch: 2 | loss: 0.8293777
	speed: 0.0023s/iter; left time: 13.5170s
Updating learning rate to 0.0001716575818
Validation loss decreased (0.6489 --> 0.6093).  Saving model state dict ...
Epoch: 2 cost time: 2.261134147644043
Epoch: 2, Steps: 979 | Train Loss: 0.7936888 Vali Loss: 0.6092631 Best vali loss: 0.6092631
	iters: 100, epoch: 3 | loss: 0.4948272
	speed: 0.0087s/iter; left time: 50.2653s
	iters: 200, epoch: 3 | loss: 0.2519474
	speed: 0.0024s/iter; left time: 13.3703s
	iters: 300, epoch: 3 | loss: 1.5511432
	speed: 0.0023s/iter; left time: 12.6349s
	iters: 400, epoch: 3 | loss: 0.5135681
	speed: 0.0023s/iter; left time: 12.6196s
	iters: 500, epoch: 3 | loss: 0.4880446
	speed: 0.0024s/iter; left time: 12.6957s
	iters: 600, epoch: 3 | loss: 0.2791136
	speed: 0.0023s/iter; left time: 12.1946s
	iters: 700, epoch: 3 | loss: 0.3646764
	speed: 0.0024s/iter; left time: 12.2039s
	iters: 800, epoch: 3 | loss: 0.6307901
	speed: 0.0023s/iter; left time: 11.7102s
	iters: 900, epoch: 3 | loss: 0.5928424
	speed: 0.0024s/iter; left time: 12.1322s
Updating learning rate to 8.58287909e-05
Epoch: 3 cost time: 2.3365442752838135
Epoch: 3, Steps: 979 | Train Loss: 0.5741059 Vali Loss: 0.6569260 Best vali loss: 0.6092631
	iters: 100, epoch: 4 | loss: 0.7835270
	speed: 0.0091s/iter; left time: 43.6859s
	iters: 200, epoch: 4 | loss: 1.2132615
	speed: 0.0024s/iter; left time: 11.4901s
	iters: 300, epoch: 4 | loss: 1.4376144
	speed: 0.0023s/iter; left time: 10.7771s
	iters: 400, epoch: 4 | loss: 1.1411375
	speed: 0.0024s/iter; left time: 10.6607s
	iters: 500, epoch: 4 | loss: 0.4145425
	speed: 0.0024s/iter; left time: 10.7613s
	iters: 600, epoch: 4 | loss: 1.4780430
	speed: 0.0024s/iter; left time: 10.2268s
	iters: 700, epoch: 4 | loss: 0.4743370
	speed: 0.0025s/iter; left time: 10.6184s
	iters: 800, epoch: 4 | loss: 0.5290736
	speed: 0.0025s/iter; left time: 10.0396s
	iters: 900, epoch: 4 | loss: 0.4460083
	speed: 0.0023s/iter; left time: 9.2170s
Updating learning rate to 4.291439545e-05
Epoch: 4 cost time: 2.423299551010132
Epoch: 4, Steps: 979 | Train Loss: 0.8797272 Vali Loss: 0.6517219 Best vali loss: 0.6092631
	iters: 100, epoch: 5 | loss: 0.8092443
	speed: 0.0089s/iter; left time: 34.1460s
	iters: 200, epoch: 5 | loss: 0.7444097
	speed: 0.0026s/iter; left time: 9.5318s
	iters: 300, epoch: 5 | loss: 0.2794302
	speed: 0.0026s/iter; left time: 9.2663s
	iters: 400, epoch: 5 | loss: 1.3033526
	speed: 0.0024s/iter; left time: 8.5137s
	iters: 500, epoch: 5 | loss: 0.4929319
	speed: 0.0024s/iter; left time: 8.2658s
	iters: 600, epoch: 5 | loss: 1.1410218
	speed: 0.0024s/iter; left time: 7.8537s
	iters: 700, epoch: 5 | loss: 0.5228815
	speed: 0.0023s/iter; left time: 7.5485s
	iters: 800, epoch: 5 | loss: 0.4195824
	speed: 0.0024s/iter; left time: 7.4848s
	iters: 900, epoch: 5 | loss: 0.3506200
	speed: 0.0024s/iter; left time: 7.1661s
Updating learning rate to 2.1457197725e-05
Epoch: 5 cost time: 2.446540117263794
Epoch: 5, Steps: 979 | Train Loss: 0.6737194 Vali Loss: 0.6608241 Best vali loss: 0.6092631
	iters: 100, epoch: 6 | loss: 0.5475864
	speed: 0.0088s/iter; left time: 24.9240s
	iters: 200, epoch: 6 | loss: 0.6593432
	speed: 0.0025s/iter; left time: 6.7092s
	iters: 300, epoch: 6 | loss: 0.7846780
	speed: 0.0025s/iter; left time: 6.6093s
	iters: 400, epoch: 6 | loss: 0.5201177
	speed: 0.0024s/iter; left time: 6.1864s
	iters: 500, epoch: 6 | loss: 0.9723449
	speed: 0.0024s/iter; left time: 5.8593s
	iters: 600, epoch: 6 | loss: 0.2782686
	speed: 0.0025s/iter; left time: 5.7781s
	iters: 700, epoch: 6 | loss: 1.1353226
	speed: 0.0024s/iter; left time: 5.3368s
	iters: 800, epoch: 6 | loss: 0.3201295
	speed: 0.0025s/iter; left time: 5.2794s
	iters: 900, epoch: 6 | loss: 0.3041816
	speed: 0.0026s/iter; left time: 5.3332s
Updating learning rate to 1.07285988625e-05
Epoch: 6 cost time: 2.474119186401367
Epoch: 6, Steps: 979 | Train Loss: 0.6135525 Vali Loss: 0.6608815 Best vali loss: 0.6092631
	iters: 100, epoch: 7 | loss: 0.4169319
	speed: 0.0089s/iter; left time: 16.4863s
	iters: 200, epoch: 7 | loss: 0.2024949
	speed: 0.0025s/iter; left time: 4.4669s
	iters: 300, epoch: 7 | loss: 0.6077259
	speed: 0.0025s/iter; left time: 4.1643s
	iters: 400, epoch: 7 | loss: 0.4736988
	speed: 0.0025s/iter; left time: 3.8457s
	iters: 500, epoch: 7 | loss: 0.4656843
	speed: 0.0024s/iter; left time: 3.4961s
	iters: 600, epoch: 7 | loss: 0.9049295
	speed: 0.0024s/iter; left time: 3.2355s
	iters: 700, epoch: 7 | loss: 0.8135620
	speed: 0.0024s/iter; left time: 2.9899s
	iters: 800, epoch: 7 | loss: 0.6728166
	speed: 0.0024s/iter; left time: 2.7249s
	iters: 900, epoch: 7 | loss: 0.7256088
	speed: 0.0023s/iter; left time: 2.4817s
Updating learning rate to 5.36429943125e-06
Epoch: 7 cost time: 2.4189600944519043
Epoch: 7, Steps: 979 | Train Loss: 0.5870503 Vali Loss: 0.6655608 Best vali loss: 0.6092631
	iters: 100, epoch: 8 | loss: 0.6670564
	speed: 0.0090s/iter; left time: 7.8979s
	iters: 200, epoch: 8 | loss: 0.3683765
	speed: 0.0025s/iter; left time: 1.9499s
	iters: 300, epoch: 8 | loss: 0.2422395
	speed: 0.0025s/iter; left time: 1.7032s
	iters: 400, epoch: 8 | loss: 0.7461889
	speed: 0.0025s/iter; left time: 1.4219s
	iters: 500, epoch: 8 | loss: 0.5223868
	speed: 0.0024s/iter; left time: 1.1707s
	iters: 600, epoch: 8 | loss: 0.5459250
	speed: 0.0023s/iter; left time: 0.8552s
	iters: 700, epoch: 8 | loss: 0.4286650
	speed: 0.0022s/iter; left time: 0.6297s
	iters: 800, epoch: 8 | loss: 0.6801677
	speed: 0.0023s/iter; left time: 0.4164s
	iters: 900, epoch: 8 | loss: 0.9562641
	speed: 0.0023s/iter; left time: 0.1825s
Updating learning rate to 2.682149715625e-06
Epoch: 8 cost time: 2.394888162612915
Epoch: 8, Steps: 979 | Train Loss: 0.5730300 Vali Loss: 0.6639058 Best vali loss: 0.6092631

best validation loss 0.6092631325353246

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0061531287642, 'e_layers': 4, 'learning_rate': 0.0003189267352, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0236566
	speed: 0.0116s/iter; left time: 44.3983s
	iters: 200, epoch: 1 | loss: 1.4672935
	speed: 0.0051s/iter; left time: 18.8974s
	iters: 300, epoch: 1 | loss: 0.7020149
	speed: 0.0053s/iter; left time: 19.1093s
	iters: 400, epoch: 1 | loss: 0.7586286
	speed: 0.0053s/iter; left time: 18.8061s
Updating learning rate to 0.0003189267352
Validation loss decreased (inf --> 0.6241).  Saving model state dict ...
Epoch: 1 cost time: 2.9079911708831787
Epoch: 1, Steps: 490 | Train Loss: 0.9878984 Vali Loss: 0.6240684 Best vali loss: 0.6240684
	iters: 100, epoch: 2 | loss: 0.3792331
	speed: 0.0137s/iter; left time: 45.6896s
	iters: 200, epoch: 2 | loss: 0.6509027
	speed: 0.0051s/iter; left time: 16.3412s
	iters: 300, epoch: 2 | loss: 0.7974548
	speed: 0.0050s/iter; left time: 15.5515s
	iters: 400, epoch: 2 | loss: 0.8922466
	speed: 0.0047s/iter; left time: 14.2492s
Updating learning rate to 0.0001594633676
Validation loss decreased (0.6241 --> 0.6109).  Saving model state dict ...
Epoch: 2 cost time: 2.4380900859832764
Epoch: 2, Steps: 490 | Train Loss: 0.6799593 Vali Loss: 0.6108720 Best vali loss: 0.6108720
	iters: 100, epoch: 3 | loss: 0.5526908
	speed: 0.0132s/iter; left time: 37.4404s
	iters: 200, epoch: 3 | loss: 0.7435665
	speed: 0.0049s/iter; left time: 13.5460s
	iters: 300, epoch: 3 | loss: 0.6983957
	speed: 0.0050s/iter; left time: 13.0746s
	iters: 400, epoch: 3 | loss: 0.3636463
	speed: 0.0050s/iter; left time: 12.6565s
Updating learning rate to 7.97316838e-05
Validation loss decreased (0.6109 --> 0.6104).  Saving model state dict ...
Epoch: 3 cost time: 2.490081548690796
Epoch: 3, Steps: 490 | Train Loss: 0.5895748 Vali Loss: 0.6103543 Best vali loss: 0.6103543
	iters: 100, epoch: 4 | loss: 0.9732649
	speed: 0.0138s/iter; left time: 32.3698s
	iters: 200, epoch: 4 | loss: 0.7750168
	speed: 0.0053s/iter; left time: 12.0033s
	iters: 300, epoch: 4 | loss: 0.4462231
	speed: 0.0050s/iter; left time: 10.6946s
	iters: 400, epoch: 4 | loss: 0.6856668
	speed: 0.0049s/iter; left time: 10.0548s
Updating learning rate to 3.98658419e-05
Epoch: 4 cost time: 2.553201675415039
Epoch: 4, Steps: 490 | Train Loss: 0.7200429 Vali Loss: 0.6104040 Best vali loss: 0.6103543
	iters: 100, epoch: 5 | loss: 1.1275321
	speed: 0.0138s/iter; left time: 25.6638s
	iters: 200, epoch: 5 | loss: 0.6135762
	speed: 0.0051s/iter; left time: 9.0641s
	iters: 300, epoch: 5 | loss: 1.0074878
	speed: 0.0051s/iter; left time: 8.4512s
	iters: 400, epoch: 5 | loss: 0.9046298
	speed: 0.0051s/iter; left time: 7.9792s
Updating learning rate to 1.993292095e-05
Epoch: 5 cost time: 2.567267656326294
Epoch: 5, Steps: 490 | Train Loss: 0.9133065 Vali Loss: 0.6116743 Best vali loss: 0.6103543
	iters: 100, epoch: 6 | loss: 0.8114395
	speed: 0.0137s/iter; left time: 18.8291s
	iters: 200, epoch: 6 | loss: 0.8552175
	speed: 0.0052s/iter; left time: 6.6584s
	iters: 300, epoch: 6 | loss: 0.9602328
	speed: 0.0053s/iter; left time: 6.1593s
	iters: 400, epoch: 6 | loss: 0.9209242
	speed: 0.0054s/iter; left time: 5.8148s
Updating learning rate to 9.966460475e-06
Epoch: 6 cost time: 2.616161346435547
Epoch: 6, Steps: 490 | Train Loss: 0.8869535 Vali Loss: 0.6110852 Best vali loss: 0.6103543
	iters: 100, epoch: 7 | loss: 0.4871872
	speed: 0.0132s/iter; left time: 11.6691s
	iters: 200, epoch: 7 | loss: 1.1600058
	speed: 0.0050s/iter; left time: 3.8757s
	iters: 300, epoch: 7 | loss: 0.6841413
	speed: 0.0049s/iter; left time: 3.3695s
	iters: 400, epoch: 7 | loss: 0.4662743
	speed: 0.0050s/iter; left time: 2.9125s
Updating learning rate to 4.9832302375e-06
Epoch: 7 cost time: 2.4768970012664795
Epoch: 7, Steps: 490 | Train Loss: 0.6994022 Vali Loss: 0.6116672 Best vali loss: 0.6103543
	iters: 100, epoch: 8 | loss: 0.9214725
	speed: 0.0135s/iter; left time: 5.2677s
	iters: 200, epoch: 8 | loss: 0.8824629
	speed: 0.0050s/iter; left time: 1.4431s
	iters: 300, epoch: 8 | loss: 0.4669282
	speed: 0.0055s/iter; left time: 1.0499s
	iters: 400, epoch: 8 | loss: 0.7138138
	speed: 0.0055s/iter; left time: 0.5000s
Updating learning rate to 2.49161511875e-06
Epoch: 8 cost time: 2.579209089279175
Epoch: 8, Steps: 490 | Train Loss: 0.7461693 Vali Loss: 0.6119495 Best vali loss: 0.6103543

best validation loss 0.6103543243105904

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977363133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745922
	speed: 0.0119s/iter; left time: 10.5436s
Updating learning rate to 0.000286404399621619
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0237841606140137
Epoch: 1, Steps: 123 | Train Loss: 0.7745922 Vali Loss: 0.6173379 Best vali loss: 0.6173379
	iters: 100, epoch: 2 | loss: 0.9504019
	speed: 0.0093s/iter; left time: 7.0575s
Updating learning rate to 0.0002541338397199562
Validation loss decreased (0.6173 --> 0.5759).  Saving model state dict ...
Epoch: 2 cost time: 0.7190957069396973
Epoch: 2, Steps: 123 | Train Loss: 0.9504019 Vali Loss: 0.5759332 Best vali loss: 0.5759332
	iters: 100, epoch: 3 | loss: 0.8541041
	speed: 0.0094s/iter; left time: 6.0039s
Updating learning rate to 0.00020583753380668587
Validation loss decreased (0.5759 --> 0.5528).  Saving model state dict ...
Epoch: 3 cost time: 0.7140805721282959
Epoch: 3, Steps: 123 | Train Loss: 0.8541041 Vali Loss: 0.5528456 Best vali loss: 0.5528456

best validation loss 0.5528455536048869

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0071286195352, 'e_layers': 3, 'learning_rate': 7.48821158e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4305343
	speed: 0.0106s/iter; left time: 40.5814s
	iters: 200, epoch: 1 | loss: 1.3707640
	speed: 0.0045s/iter; left time: 16.8574s
	iters: 300, epoch: 1 | loss: 1.0567172
	speed: 0.0045s/iter; left time: 16.3952s
	iters: 400, epoch: 1 | loss: 1.0205444
	speed: 0.0046s/iter; left time: 16.2886s
Updating learning rate to 7.48821158e-05
Validation loss decreased (inf --> 0.6629).  Saving model state dict ...
Epoch: 1 cost time: 2.581153154373169
Epoch: 1, Steps: 490 | Train Loss: 0.9696400 Vali Loss: 0.6629298 Best vali loss: 0.6629298
	iters: 100, epoch: 2 | loss: 0.8814964
	speed: 0.0121s/iter; left time: 40.4479s
	iters: 200, epoch: 2 | loss: 0.4461369
	speed: 0.0042s/iter; left time: 13.4107s
	iters: 300, epoch: 2 | loss: 0.9586831
	speed: 0.0041s/iter; left time: 12.7568s
	iters: 400, epoch: 2 | loss: 0.9739124
	speed: 0.0039s/iter; left time: 11.8412s
Updating learning rate to 3.74410579e-05
Validation loss decreased (0.6629 --> 0.6380).  Saving model state dict ...
Epoch: 2 cost time: 2.0388567447662354
Epoch: 2, Steps: 490 | Train Loss: 0.8150572 Vali Loss: 0.6379882 Best vali loss: 0.6379882
	iters: 100, epoch: 3 | loss: 1.0526553
	speed: 0.0112s/iter; left time: 31.9216s
	iters: 200, epoch: 3 | loss: 0.6113845
	speed: 0.0038s/iter; left time: 10.5408s
	iters: 300, epoch: 3 | loss: 0.7792276
	speed: 0.0039s/iter; left time: 10.3203s
	iters: 400, epoch: 3 | loss: 1.0475285
	speed: 0.0046s/iter; left time: 11.7619s
Updating learning rate to 1.872052895e-05
Validation loss decreased (0.6380 --> 0.6327).  Saving model state dict ...
Epoch: 3 cost time: 2.1009252071380615
Epoch: 3, Steps: 490 | Train Loss: 0.8726990 Vali Loss: 0.6327379 Best vali loss: 0.6327379

best validation loss 0.632737884569477

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001048904935, 'e_layers': 2, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745512
	speed: 0.0119s/iter; left time: 10.5704s
Updating learning rate to 0.00028649739841911696
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0298058986663818
Epoch: 1, Steps: 123 | Train Loss: 0.7745512 Vali Loss: 0.6172789 Best vali loss: 0.6172789
	iters: 100, epoch: 2 | loss: 0.9480273
	speed: 0.0091s/iter; left time: 6.9622s
Updating learning rate to 0.00025421635989607337
Validation loss decreased (0.6173 --> 0.5801).  Saving model state dict ...
Epoch: 2 cost time: 0.7127532958984375
Epoch: 2, Steps: 123 | Train Loss: 0.9480273 Vali Loss: 0.5800597 Best vali loss: 0.5800597
	iters: 100, epoch: 3 | loss: 0.8592752
	speed: 0.0091s/iter; left time: 5.8364s
Updating learning rate to 0.00020590437161765966
Validation loss decreased (0.5801 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 0.7080855369567871
Epoch: 3, Steps: 123 | Train Loss: 0.8592752 Vali Loss: 0.5521328 Best vali loss: 0.5521328

best validation loss 0.5521328049586471

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001048904935, 'e_layers': 2, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5921008
	speed: 0.0122s/iter; left time: 6.2864s
Updating learning rate to 0.00014891649585
Validation loss decreased (0.5521 --> 0.5289).  Saving model state dict ...
Epoch: 4 cost time: 1.0234417915344238
Epoch: 4, Steps: 123 | Train Loss: 0.5921008 Vali Loss: 0.5288513 Best vali loss: 0.5288513
	iters: 100, epoch: 5 | loss: 0.8293358
	speed: 0.0093s/iter; left time: 3.6479s
Updating learning rate to 9.192862008234036e-05
Epoch: 5 cost time: 0.7138683795928955
Epoch: 5, Steps: 123 | Train Loss: 0.8293358 Vali Loss: 0.5312291 Best vali loss: 0.5288513
	iters: 100, epoch: 6 | loss: 0.7604482
	speed: 0.0089s/iter; left time: 2.4108s
Updating learning rate to 4.3616631803926644e-05
Epoch: 6 cost time: 0.7230911254882812
Epoch: 6, Steps: 123 | Train Loss: 0.7604482 Vali Loss: 0.5319190 Best vali loss: 0.5288513
	iters: 100, epoch: 7 | loss: 0.4324657
	speed: 0.0089s/iter; left time: 1.3093s
Updating learning rate to 1.1335593280883028e-05
Epoch: 7 cost time: 0.7130708694458008
Epoch: 7, Steps: 123 | Train Loss: 0.4324657 Vali Loss: 0.5398109 Best vali loss: 0.5288513
	iters: 100, epoch: 8 | loss: 0.5139931
	speed: 0.0089s/iter; left time: 0.2147s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7135624885559082
Epoch: 8, Steps: 123 | Train Loss: 0.5139931 Vali Loss: 0.5409454 Best vali loss: 0.5288513

best validation loss 0.528851310338537

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001054498294, 'e_layers': 2, 'learning_rate': 0.0003947127997, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0279886
	speed: 0.0108s/iter; left time: 9.5612s
Updating learning rate to 0.00037968993828152854
Validation loss decreased (inf --> 0.5770).  Saving model state dict ...
Epoch: 1 cost time: 0.919663667678833
Epoch: 1, Steps: 123 | Train Loss: 1.0279886 Vali Loss: 0.5770217 Best vali loss: 0.5770217
	iters: 100, epoch: 2 | loss: 0.8363088
	speed: 0.0080s/iter; left time: 6.0846s
Updating learning rate to 0.0003369084484944987
Validation loss decreased (0.5770 --> 0.5702).  Saving model state dict ...
Epoch: 2 cost time: 0.6155333518981934
Epoch: 2, Steps: 123 | Train Loss: 0.8363088 Vali Loss: 0.5701575 Best vali loss: 0.5701575
	iters: 100, epoch: 3 | loss: 0.7955825
	speed: 0.0078s/iter; left time: 4.9873s
Updating learning rate to 0.00027288142434381507
Validation loss decreased (0.5702 --> 0.5470).  Saving model state dict ...
Epoch: 3 cost time: 0.6109580993652344
Epoch: 3, Steps: 123 | Train Loss: 0.7955825 Vali Loss: 0.5469772 Best vali loss: 0.5469772
	iters: 100, epoch: 4 | loss: 0.7703145
	speed: 0.0077s/iter; left time: 3.9700s
Updating learning rate to 0.00019735639985
Validation loss decreased (0.5470 --> 0.5391).  Saving model state dict ...
Epoch: 4 cost time: 0.5952677726745605
Epoch: 4, Steps: 123 | Train Loss: 0.7703145 Vali Loss: 0.5391388 Best vali loss: 0.5391388
	iters: 100, epoch: 5 | loss: 0.6577047
	speed: 0.0076s/iter; left time: 2.9697s
Updating learning rate to 0.00012183137535618492
Validation loss decreased (0.5391 --> 0.5342).  Saving model state dict ...
Epoch: 5 cost time: 0.5675914287567139
Epoch: 5, Steps: 123 | Train Loss: 0.6577047 Vali Loss: 0.5341767 Best vali loss: 0.5341767
	iters: 100, epoch: 6 | loss: 0.5071111
	speed: 0.0076s/iter; left time: 2.0394s
Updating learning rate to 5.7804351205501277e-05
Epoch: 6 cost time: 0.5622811317443848
Epoch: 6, Steps: 123 | Train Loss: 0.5071111 Vali Loss: 0.5485164 Best vali loss: 0.5341767
	iters: 100, epoch: 7 | loss: 0.8356770
	speed: 0.0074s/iter; left time: 1.0871s
Updating learning rate to 1.502286141847142e-05
Epoch: 7 cost time: 0.5867841243743896
Epoch: 7, Steps: 123 | Train Loss: 0.8356770 Vali Loss: 0.5526221 Best vali loss: 0.5341767
	iters: 100, epoch: 8 | loss: 0.7951991
	speed: 0.0078s/iter; left time: 0.1864s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.615675687789917
Epoch: 8, Steps: 123 | Train Loss: 0.7951991 Vali Loss: 0.5557267 Best vali loss: 0.5341767

best validation loss 0.5341766626401281

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.008015298221, 'e_layers': 3, 'learning_rate': 6.46692532e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.46692532e-05
Validation loss decreased (inf --> 0.7040).  Saving model state dict ...
Epoch: 1 cost time: 0.7330660820007324
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.7040314 Best vali loss: 0.7040314
Updating learning rate to 3.23346266e-05
Validation loss decreased (0.7040 --> 0.6949).  Saving model state dict ...
Epoch: 2 cost time: 0.4688248634338379
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6949253 Best vali loss: 0.6949253
Updating learning rate to 1.61673133e-05
Validation loss decreased (0.6949 --> 0.6905).  Saving model state dict ...
Epoch: 3 cost time: 0.4503161907196045
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6905034 Best vali loss: 0.6905034
Updating learning rate to 8.08365665e-06
Validation loss decreased (0.6905 --> 0.6883).  Saving model state dict ...
Epoch: 4 cost time: 0.46768999099731445
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6883407 Best vali loss: 0.6883407
Updating learning rate to 4.041828325e-06
Validation loss decreased (0.6883 --> 0.6872).  Saving model state dict ...
Epoch: 5 cost time: 0.44259142875671387
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6872376 Best vali loss: 0.6872376
Updating learning rate to 2.0209141625e-06
Validation loss decreased (0.6872 --> 0.6867).  Saving model state dict ...
Epoch: 6 cost time: 0.4287421703338623
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6866897 Best vali loss: 0.6866897
Updating learning rate to 1.01045708125e-06
Validation loss decreased (0.6867 --> 0.6864).  Saving model state dict ...
Epoch: 7 cost time: 0.4266970157623291
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6864092 Best vali loss: 0.6864092
Updating learning rate to 5.05228540625e-07
Validation loss decreased (0.6864 --> 0.6863).  Saving model state dict ...
Epoch: 8 cost time: 0.42992711067199707
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6862709 Best vali loss: 0.6862709

best validation loss 0.6862708661138102

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0933799
	speed: 0.0106s/iter; left time: 9.4057s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 0.8799395561218262
Epoch: 1, Steps: 123 | Train Loss: 1.0933799 Vali Loss: 0.6698933 Best vali loss: 0.6698933
	iters: 100, epoch: 2 | loss: 0.8478518
	speed: 0.0076s/iter; left time: 5.7637s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.6699 --> 0.6422).  Saving model state dict ...
Epoch: 2 cost time: 0.5788943767547607
Epoch: 2, Steps: 123 | Train Loss: 0.8478518 Vali Loss: 0.6421682 Best vali loss: 0.6421682
	iters: 100, epoch: 3 | loss: 0.9624719
	speed: 0.0074s/iter; left time: 4.7193s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.6422 --> 0.6291).  Saving model state dict ...
Epoch: 3 cost time: 0.5820584297180176
Epoch: 3, Steps: 123 | Train Loss: 0.9624719 Vali Loss: 0.6290662 Best vali loss: 0.6290662

best validation loss 0.6290662392098172

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0072096429683, 'e_layers': 4, 'learning_rate': 0.0010750292518, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7738525
	speed: 0.0114s/iter; left time: 88.1386s
	iters: 200, epoch: 1 | loss: 0.4021475
	speed: 0.0052s/iter; left time: 39.6201s
	iters: 300, epoch: 1 | loss: 0.5352071
	speed: 0.0051s/iter; left time: 38.5695s
	iters: 400, epoch: 1 | loss: 1.4789431
	speed: 0.0053s/iter; left time: 39.1824s
	iters: 500, epoch: 1 | loss: 0.4634700
	speed: 0.0053s/iter; left time: 38.7076s
	iters: 600, epoch: 1 | loss: 0.7138146
	speed: 0.0052s/iter; left time: 37.7712s
	iters: 700, epoch: 1 | loss: 1.3161142
	speed: 0.0050s/iter; left time: 35.8850s
	iters: 800, epoch: 1 | loss: 0.9817127
	speed: 0.0050s/iter; left time: 35.3717s
	iters: 900, epoch: 1 | loss: 1.7919736
	speed: 0.0050s/iter; left time: 34.9362s
Updating learning rate to 0.0010750292518
Validation loss decreased (inf --> 0.6576).  Saving model state dict ...
Epoch: 1 cost time: 5.366767644882202
Epoch: 1, Steps: 979 | Train Loss: 0.9396928 Vali Loss: 0.6575768 Best vali loss: 0.6575768
	iters: 100, epoch: 2 | loss: 1.6030147
	speed: 0.0155s/iter; left time: 105.0144s
	iters: 200, epoch: 2 | loss: 1.1802889
	speed: 0.0050s/iter; left time: 33.5458s
	iters: 300, epoch: 2 | loss: 0.4244132
	speed: 0.0048s/iter; left time: 31.2489s
	iters: 400, epoch: 2 | loss: 0.5877717
	speed: 0.0048s/iter; left time: 30.9530s
	iters: 500, epoch: 2 | loss: 0.3671479
	speed: 0.0045s/iter; left time: 28.3448s
	iters: 600, epoch: 2 | loss: 1.2081925
	speed: 0.0044s/iter; left time: 27.4316s
	iters: 700, epoch: 2 | loss: 0.7070495
	speed: 0.0046s/iter; left time: 28.3313s
	iters: 800, epoch: 2 | loss: 0.3802907
	speed: 0.0046s/iter; left time: 27.9295s
	iters: 900, epoch: 2 | loss: 1.3789335
	speed: 0.0049s/iter; left time: 29.4187s
Updating learning rate to 0.0005375146259
Validation loss decreased (0.6576 --> 0.6515).  Saving model state dict ...
Epoch: 2 cost time: 4.711386442184448
Epoch: 2, Steps: 979 | Train Loss: 0.8707892 Vali Loss: 0.6514991 Best vali loss: 0.6514991
	iters: 100, epoch: 3 | loss: 0.8609410
	speed: 0.0148s/iter; left time: 85.6749s
	iters: 200, epoch: 3 | loss: 0.5079318
	speed: 0.0045s/iter; left time: 25.7718s
	iters: 300, epoch: 3 | loss: 0.4497562
	speed: 0.0046s/iter; left time: 25.4837s
	iters: 400, epoch: 3 | loss: 1.6125370
	speed: 0.0046s/iter; left time: 25.4501s
	iters: 500, epoch: 3 | loss: 1.0404134
	speed: 0.0048s/iter; left time: 25.8450s
	iters: 600, epoch: 3 | loss: 0.8884572
	speed: 0.0048s/iter; left time: 25.3543s
	iters: 700, epoch: 3 | loss: 0.9006617
	speed: 0.0047s/iter; left time: 24.3323s
	iters: 800, epoch: 3 | loss: 2.1849930
	speed: 0.0048s/iter; left time: 24.2716s
	iters: 900, epoch: 3 | loss: 1.1088018
	speed: 0.0048s/iter; left time: 23.7336s
Updating learning rate to 0.00026875731295
Validation loss decreased (0.6515 --> 0.6470).  Saving model state dict ...
Epoch: 3 cost time: 4.627823829650879
Epoch: 3, Steps: 979 | Train Loss: 1.0616103 Vali Loss: 0.6469917 Best vali loss: 0.6469917

best validation loss 0.6469917448512497

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494559455, 'e_layers': 2, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744631
	speed: 0.0121s/iter; left time: 10.6719s
Updating learning rate to 0.00028649739841911696
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.048628330230713
Epoch: 1, Steps: 123 | Train Loss: 0.7744631 Vali Loss: 0.6172548 Best vali loss: 0.6172548
	iters: 100, epoch: 2 | loss: 0.9467874
	speed: 0.0093s/iter; left time: 7.0685s
Updating learning rate to 0.00025421635989607337
Validation loss decreased (0.6173 --> 0.5938).  Saving model state dict ...
Epoch: 2 cost time: 0.7206990718841553
Epoch: 2, Steps: 123 | Train Loss: 0.9467874 Vali Loss: 0.5937871 Best vali loss: 0.5937871
	iters: 100, epoch: 3 | loss: 0.8467565
	speed: 0.0093s/iter; left time: 5.9390s
Updating learning rate to 0.00020590437161765966
Validation loss decreased (0.5938 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 0.7140555381774902
Epoch: 3, Steps: 123 | Train Loss: 0.8467565 Vali Loss: 0.5520784 Best vali loss: 0.5520784

best validation loss 0.5520783780019408

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494559455, 'e_layers': 2, 'learning_rate': 0.0002978329917, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5866299
	speed: 0.0120s/iter; left time: 6.2094s
Updating learning rate to 0.00014891649585
Validation loss decreased (0.5521 --> 0.5276).  Saving model state dict ...
Epoch: 4 cost time: 1.0296225547790527
Epoch: 4, Steps: 123 | Train Loss: 0.5866299 Vali Loss: 0.5276115 Best vali loss: 0.5276115
	iters: 100, epoch: 5 | loss: 0.8247809
	speed: 0.0094s/iter; left time: 3.7002s
Updating learning rate to 9.192862008234036e-05
Validation loss decreased (0.5276 --> 0.5253).  Saving model state dict ...
Epoch: 5 cost time: 0.7205181121826172
Epoch: 5, Steps: 123 | Train Loss: 0.8247809 Vali Loss: 0.5252512 Best vali loss: 0.5252512
	iters: 100, epoch: 6 | loss: 0.7550898
	speed: 0.0093s/iter; left time: 2.5142s
Updating learning rate to 4.3616631803926644e-05
Epoch: 6 cost time: 0.722379207611084
Epoch: 6, Steps: 123 | Train Loss: 0.7550898 Vali Loss: 0.5301334 Best vali loss: 0.5252512
	iters: 100, epoch: 7 | loss: 0.4354511
	speed: 0.0089s/iter; left time: 1.3153s
Updating learning rate to 1.1335593280883028e-05
Epoch: 7 cost time: 0.7118659019470215
Epoch: 7, Steps: 123 | Train Loss: 0.4354511 Vali Loss: 0.5318259 Best vali loss: 0.5252512
	iters: 100, epoch: 8 | loss: 0.5075886
	speed: 0.0091s/iter; left time: 0.2186s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7193751335144043
Epoch: 8, Steps: 123 | Train Loss: 0.5075886 Vali Loss: 0.5364404 Best vali loss: 0.5252512

best validation loss 0.5252511748170919

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0003643
	speed: 0.0107s/iter; left time: 9.5117s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.5995).  Saving model state dict ...
Epoch: 1 cost time: 0.9118857383728027
Epoch: 1, Steps: 123 | Train Loss: 1.0003643 Vali Loss: 0.5994796 Best vali loss: 0.5994796
	iters: 100, epoch: 2 | loss: 0.8552063
	speed: 0.0077s/iter; left time: 5.8560s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.5995 --> 0.5549).  Saving model state dict ...
Epoch: 2 cost time: 0.5878481864929199
Epoch: 2, Steps: 123 | Train Loss: 0.8552063 Vali Loss: 0.5548693 Best vali loss: 0.5548693
	iters: 100, epoch: 3 | loss: 0.8270527
	speed: 0.0079s/iter; left time: 5.0671s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.5549 --> 0.5476).  Saving model state dict ...
Epoch: 3 cost time: 0.6226706504821777
Epoch: 3, Steps: 123 | Train Loss: 0.8270527 Vali Loss: 0.5475767 Best vali loss: 0.5475767
	iters: 100, epoch: 4 | loss: 0.8135434
	speed: 0.0080s/iter; left time: 4.1532s
Updating learning rate to 8.79643783e-05
Validation loss decreased (0.5476 --> 0.5448).  Saving model state dict ...
Epoch: 4 cost time: 0.6178419589996338
Epoch: 4, Steps: 123 | Train Loss: 0.8135434 Vali Loss: 0.5447999 Best vali loss: 0.5447999
	iters: 100, epoch: 5 | loss: 0.6966797
	speed: 0.0079s/iter; left time: 3.1077s
Updating learning rate to 5.430186808629478e-05
Epoch: 5 cost time: 0.6021442413330078
Epoch: 5, Steps: 123 | Train Loss: 0.6966797 Vali Loss: 0.5485470 Best vali loss: 0.5447999
	iters: 100, epoch: 6 | loss: 0.5687452
	speed: 0.0077s/iter; left time: 2.0819s
Updating learning rate to 2.5764169901211216e-05
Validation loss decreased (0.5448 --> 0.5406).  Saving model state dict ...
Epoch: 6 cost time: 0.6080794334411621
Epoch: 6, Steps: 123 | Train Loss: 0.5687452 Vali Loss: 0.5406452 Best vali loss: 0.5406452
	iters: 100, epoch: 7 | loss: 0.9371782
	speed: 0.0080s/iter; left time: 1.1776s
Updating learning rate to 6.695889598550024e-06
Epoch: 7 cost time: 0.6288361549377441
Epoch: 7, Steps: 123 | Train Loss: 0.9371782 Vali Loss: 0.5459587 Best vali loss: 0.5406452
	iters: 100, epoch: 8 | loss: 0.8317798
	speed: 0.0076s/iter; left time: 0.1826s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6048552989959717
Epoch: 8, Steps: 123 | Train Loss: 0.8317798 Vali Loss: 0.5418519 Best vali loss: 0.5406452

best validation loss 0.540645164342348

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044090101876, 'e_layers': 2, 'learning_rate': 0.0002118624333, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0030572
	speed: 0.0109s/iter; left time: 9.6649s
Updating learning rate to 0.00020379889956695382
Validation loss decreased (inf --> 0.6014).  Saving model state dict ...
Epoch: 1 cost time: 0.9136676788330078
Epoch: 1, Steps: 123 | Train Loss: 1.0030572 Vali Loss: 0.6013790 Best vali loss: 0.6013790
	iters: 100, epoch: 2 | loss: 0.8493928
	speed: 0.0075s/iter; left time: 5.7494s
Updating learning rate to 0.0001808358982825563
Epoch: 2 cost time: 0.5795583724975586
Epoch: 2, Steps: 123 | Train Loss: 0.8493928 Vali Loss: 0.6084423 Best vali loss: 0.6013790
	iters: 100, epoch: 3 | loss: 0.8145003
	speed: 0.0074s/iter; left time: 4.7213s
Updating learning rate to 0.00014646933823223195
Validation loss decreased (0.6014 --> 0.5577).  Saving model state dict ...
Epoch: 3 cost time: 0.5852668285369873
Epoch: 3, Steps: 123 | Train Loss: 0.8145003 Vali Loss: 0.5576541 Best vali loss: 0.5576541
	iters: 100, epoch: 4 | loss: 0.8152589
	speed: 0.0077s/iter; left time: 3.9768s
Updating learning rate to 0.00010593121665
Validation loss decreased (0.5577 --> 0.5441).  Saving model state dict ...
Epoch: 4 cost time: 0.5983867645263672
Epoch: 4, Steps: 123 | Train Loss: 0.8152589 Vali Loss: 0.5441470 Best vali loss: 0.5441470
	iters: 100, epoch: 5 | loss: 0.6870693
	speed: 0.0078s/iter; left time: 3.0754s
Updating learning rate to 6.539309506776806e-05
Epoch: 5 cost time: 0.6113491058349609
Epoch: 5, Steps: 123 | Train Loss: 0.6870693 Vali Loss: 0.5455756 Best vali loss: 0.5441470
	iters: 100, epoch: 6 | loss: 0.5598807
	speed: 0.0076s/iter; left time: 2.0523s
Updating learning rate to 3.1026535017443696e-05
Validation loss decreased (0.5441 --> 0.5333).  Saving model state dict ...
Epoch: 6 cost time: 0.6083700656890869
Epoch: 6, Steps: 123 | Train Loss: 0.5598807 Vali Loss: 0.5333352 Best vali loss: 0.5333352
	iters: 100, epoch: 7 | loss: 0.9210552
	speed: 0.0081s/iter; left time: 1.1954s
Updating learning rate to 8.063533733046165e-06
Epoch: 7 cost time: 0.6362180709838867
Epoch: 7, Steps: 123 | Train Loss: 0.9210552 Vali Loss: 0.5347457 Best vali loss: 0.5333352
	iters: 100, epoch: 8 | loss: 0.8265328
	speed: 0.0080s/iter; left time: 0.1913s
Updating learning rate to 0.0
Validation loss decreased (0.5333 --> 0.5329).  Saving model state dict ...
Epoch: 8 cost time: 0.6354937553405762
Epoch: 8, Steps: 123 | Train Loss: 0.8265328 Vali Loss: 0.5329207 Best vali loss: 0.5329207

best validation loss 0.5329206937278437

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0031527978925, 'e_layers': 3, 'learning_rate': 0.0002985214991, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5192487
	speed: 0.0119s/iter; left time: 22.1244s
	iters: 200, epoch: 1 | loss: 0.6121575
	speed: 0.0056s/iter; left time: 9.9292s
Updating learning rate to 0.0002985214991
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 1.73624587059021
Epoch: 1, Steps: 245 | Train Loss: 0.5657031 Vali Loss: 0.6099169 Best vali loss: 0.6099169
	iters: 100, epoch: 2 | loss: 0.7088935
	speed: 0.0115s/iter; left time: 18.5298s
	iters: 200, epoch: 2 | loss: 0.9656596
	speed: 0.0057s/iter; left time: 8.5948s
Updating learning rate to 0.00014926074955
Validation loss decreased (0.6099 --> 0.5747).  Saving model state dict ...
Epoch: 2 cost time: 1.4346067905426025
Epoch: 2, Steps: 245 | Train Loss: 0.8372766 Vali Loss: 0.5746627 Best vali loss: 0.5746627
	iters: 100, epoch: 3 | loss: 0.6758943
	speed: 0.0116s/iter; left time: 15.9512s
	iters: 200, epoch: 3 | loss: 0.6780195
	speed: 0.0056s/iter; left time: 7.1380s
Updating learning rate to 7.4630374775e-05
Validation loss decreased (0.5747 --> 0.5538).  Saving model state dict ...
Epoch: 3 cost time: 1.420149564743042
Epoch: 3, Steps: 245 | Train Loss: 0.6769569 Vali Loss: 0.5537898 Best vali loss: 0.5537898

best validation loss 0.5537897805713051

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010964217531, 'e_layers': 4, 'learning_rate': 0.0003237782309, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7506294
	speed: 0.0127s/iter; left time: 23.6858s
	iters: 200, epoch: 1 | loss: 0.9044108
	speed: 0.0064s/iter; left time: 11.2541s
Updating learning rate to 0.0003237782309
Validation loss decreased (inf --> 0.6182).  Saving model state dict ...
Epoch: 1 cost time: 1.9300203323364258
Epoch: 1, Steps: 245 | Train Loss: 0.8275201 Vali Loss: 0.6182234 Best vali loss: 0.6182234
	iters: 100, epoch: 2 | loss: 0.9536091
	speed: 0.0130s/iter; left time: 20.9863s
	iters: 200, epoch: 2 | loss: 0.8455057
	speed: 0.0064s/iter; left time: 9.6997s
Updating learning rate to 0.00016188911545
Validation loss decreased (0.6182 --> 0.6057).  Saving model state dict ...
Epoch: 2 cost time: 1.6353464126586914
Epoch: 2, Steps: 245 | Train Loss: 0.8995574 Vali Loss: 0.6056988 Best vali loss: 0.6056988
	iters: 100, epoch: 3 | loss: 0.4469394
	speed: 0.0131s/iter; left time: 18.0029s
	iters: 200, epoch: 3 | loss: 0.4235351
	speed: 0.0065s/iter; left time: 8.2830s
Updating learning rate to 8.0944557725e-05
Validation loss decreased (0.6057 --> 0.5648).  Saving model state dict ...
Epoch: 3 cost time: 1.6417293548583984
Epoch: 3, Steps: 245 | Train Loss: 0.4352373 Vali Loss: 0.5648152 Best vali loss: 0.5648152

best validation loss 0.5648152216724199

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029757164247, 'e_layers': 3, 'learning_rate': 0.0003188036619, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6154225
	speed: 0.0113s/iter; left time: 20.9924s
	iters: 200, epoch: 1 | loss: 0.5938438
	speed: 0.0053s/iter; left time: 9.3083s
Updating learning rate to 0.0003188036619
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 1.617560625076294
Epoch: 1, Steps: 245 | Train Loss: 0.6046332 Vali Loss: 0.6207902 Best vali loss: 0.6207902
	iters: 100, epoch: 2 | loss: 0.5599282
	speed: 0.0105s/iter; left time: 16.9531s
	iters: 200, epoch: 2 | loss: 1.2966120
	speed: 0.0051s/iter; left time: 7.7348s
Updating learning rate to 0.00015940183095
Validation loss decreased (0.6208 --> 0.5600).  Saving model state dict ...
Epoch: 2 cost time: 1.304081916809082
Epoch: 2, Steps: 245 | Train Loss: 0.9282701 Vali Loss: 0.5599569 Best vali loss: 0.5599569
	iters: 100, epoch: 3 | loss: 0.7739973
	speed: 0.0105s/iter; left time: 14.3300s
	iters: 200, epoch: 3 | loss: 0.4748534
	speed: 0.0049s/iter; left time: 6.2860s
Updating learning rate to 7.9700915475e-05
Epoch: 3 cost time: 1.2665879726409912
Epoch: 3, Steps: 245 | Train Loss: 0.6244253 Vali Loss: 0.5715537 Best vali loss: 0.5599569

best validation loss 0.5599569189002369

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0031527978925, 'e_layers': 3, 'learning_rate': 0.0002985214991, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4179333
	speed: 0.0124s/iter; left time: 13.9364s
	iters: 200, epoch: 4 | loss: 0.5312495
	speed: 0.0057s/iter; left time: 5.8278s
Updating learning rate to 3.73151873875e-05
Validation loss decreased (0.5538 --> 0.5434).  Saving model state dict ...
Epoch: 4 cost time: 1.7364397048950195
Epoch: 4, Steps: 245 | Train Loss: 0.4745914 Vali Loss: 0.5434346 Best vali loss: 0.5434346
	iters: 100, epoch: 5 | loss: 0.4989443
	speed: 0.0119s/iter; left time: 10.4609s
	iters: 200, epoch: 5 | loss: 0.8362122
	speed: 0.0056s/iter; left time: 4.3854s
Updating learning rate to 1.865759369375e-05
Validation loss decreased (0.5434 --> 0.5310).  Saving model state dict ...
Epoch: 5 cost time: 1.4367444515228271
Epoch: 5, Steps: 245 | Train Loss: 0.6675782 Vali Loss: 0.5310466 Best vali loss: 0.5310466
	iters: 100, epoch: 6 | loss: 0.6251645
	speed: 0.0117s/iter; left time: 7.4552s
	iters: 200, epoch: 6 | loss: 0.5887768
	speed: 0.0056s/iter; left time: 2.9823s
Updating learning rate to 9.328796846875e-06
Epoch: 6 cost time: 1.4264347553253174
Epoch: 6, Steps: 245 | Train Loss: 0.6069706 Vali Loss: 0.5343881 Best vali loss: 0.5310466
	iters: 100, epoch: 7 | loss: 0.7220100
	speed: 0.0112s/iter; left time: 4.3763s
	iters: 200, epoch: 7 | loss: 0.8698789
	speed: 0.0056s/iter; left time: 1.6401s
Updating learning rate to 4.6643984234375e-06
Epoch: 7 cost time: 1.4283859729766846
Epoch: 7, Steps: 245 | Train Loss: 0.7959445 Vali Loss: 0.5357598 Best vali loss: 0.5310466
	iters: 100, epoch: 8 | loss: 0.6866408
	speed: 0.0113s/iter; left time: 1.6512s
	iters: 200, epoch: 8 | loss: 0.6785723
	speed: 0.0057s/iter; left time: 0.2616s
Updating learning rate to 2.33219921171875e-06
Epoch: 8 cost time: 1.4495155811309814
Epoch: 8, Steps: 245 | Train Loss: 0.6826065 Vali Loss: 0.5323079 Best vali loss: 0.5310466

best validation loss 0.5310466394883403

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010212330925, 'e_layers': 2, 'learning_rate': 0.000136380131, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3848520
	speed: 0.0099s/iter; left time: 76.7147s
	iters: 200, epoch: 1 | loss: 1.3677427
	speed: 0.0036s/iter; left time: 27.6533s
	iters: 300, epoch: 1 | loss: 0.8434352
	speed: 0.0035s/iter; left time: 26.4032s
	iters: 400, epoch: 1 | loss: 1.3921279
	speed: 0.0035s/iter; left time: 26.2109s
	iters: 500, epoch: 1 | loss: 0.9152094
	speed: 0.0034s/iter; left time: 25.0473s
	iters: 600, epoch: 1 | loss: 1.5123192
	speed: 0.0034s/iter; left time: 24.4917s
	iters: 700, epoch: 1 | loss: 0.8136000
	speed: 0.0034s/iter; left time: 24.1646s
	iters: 800, epoch: 1 | loss: 0.7635312
	speed: 0.0033s/iter; left time: 23.0770s
	iters: 900, epoch: 1 | loss: 1.0284204
	speed: 0.0034s/iter; left time: 23.3595s
Updating learning rate to 0.00013118947133605404
Validation loss decreased (inf --> 0.5734).  Saving model state dict ...
Epoch: 1 cost time: 3.748338460922241
Epoch: 1, Steps: 979 | Train Loss: 1.0023598 Vali Loss: 0.5733583 Best vali loss: 0.5733583
	iters: 100, epoch: 2 | loss: 1.0205861
	speed: 0.0119s/iter; left time: 80.1166s
	iters: 200, epoch: 2 | loss: 0.3065566
	speed: 0.0034s/iter; left time: 22.7750s
	iters: 300, epoch: 2 | loss: 0.5239809
	speed: 0.0033s/iter; left time: 21.8473s
	iters: 400, epoch: 2 | loss: 1.4260765
	speed: 0.0033s/iter; left time: 21.4886s
	iters: 500, epoch: 2 | loss: 0.9452435
	speed: 0.0033s/iter; left time: 21.1734s
	iters: 600, epoch: 2 | loss: 1.2953029
	speed: 0.0033s/iter; left time: 20.8597s
	iters: 700, epoch: 2 | loss: 1.0023886
	speed: 0.0033s/iter; left time: 20.3733s
	iters: 800, epoch: 2 | loss: 0.2638445
	speed: 0.0033s/iter; left time: 20.1205s
	iters: 900, epoch: 2 | loss: 0.8582971
	speed: 0.0033s/iter; left time: 19.4265s
Updating learning rate to 0.00011640772322460485
Epoch: 2 cost time: 3.2951087951660156
Epoch: 2, Steps: 979 | Train Loss: 0.8491419 Vali Loss: 0.6353292 Best vali loss: 0.5733583
	iters: 100, epoch: 3 | loss: 0.6889831
	speed: 0.0114s/iter; left time: 65.9855s
	iters: 200, epoch: 3 | loss: 0.6555645
	speed: 0.0035s/iter; left time: 20.0412s
	iters: 300, epoch: 3 | loss: 1.1809664
	speed: 0.0037s/iter; left time: 20.5427s
	iters: 400, epoch: 3 | loss: 1.0833683
	speed: 0.0035s/iter; left time: 19.0288s
	iters: 500, epoch: 3 | loss: 0.9513121
	speed: 0.0034s/iter; left time: 18.4957s
	iters: 600, epoch: 3 | loss: 0.4393131
	speed: 0.0036s/iter; left time: 19.2247s
	iters: 700, epoch: 3 | loss: 0.7660700
	speed: 0.0034s/iter; left time: 17.3647s
	iters: 800, epoch: 3 | loss: 1.6515350
	speed: 0.0036s/iter; left time: 18.2767s
	iters: 900, epoch: 3 | loss: 0.2701763
	speed: 0.0036s/iter; left time: 18.0200s
Updating learning rate to 9.42852738187403e-05
Validation loss decreased (0.5734 --> 0.5592).  Saving model state dict ...
Epoch: 3 cost time: 3.508904218673706
Epoch: 3, Steps: 979 | Train Loss: 0.8541432 Vali Loss: 0.5591940 Best vali loss: 0.5591940
	iters: 100, epoch: 4 | loss: 0.9425682
	speed: 0.0120s/iter; left time: 57.6435s
	iters: 200, epoch: 4 | loss: 0.2125923
	speed: 0.0036s/iter; left time: 16.9165s
	iters: 300, epoch: 4 | loss: 0.8158413
	speed: 0.0036s/iter; left time: 16.5069s
	iters: 400, epoch: 4 | loss: 0.3046958
	speed: 0.0034s/iter; left time: 15.2448s
	iters: 500, epoch: 4 | loss: 0.4365770
	speed: 0.0033s/iter; left time: 14.6494s
	iters: 600, epoch: 4 | loss: 0.6876494
	speed: 0.0035s/iter; left time: 14.9671s
	iters: 700, epoch: 4 | loss: 1.1672139
	speed: 0.0035s/iter; left time: 14.4821s
	iters: 800, epoch: 4 | loss: 0.2635964
	speed: 0.0036s/iter; left time: 14.6785s
	iters: 900, epoch: 4 | loss: 0.9544811
	speed: 0.0036s/iter; left time: 14.2705s
Updating learning rate to 6.81900655e-05
Validation loss decreased (0.5592 --> 0.5415).  Saving model state dict ...
Epoch: 4 cost time: 3.490799903869629
Epoch: 4, Steps: 979 | Train Loss: 0.6428017 Vali Loss: 0.5415405 Best vali loss: 0.5415405
	iters: 100, epoch: 5 | loss: 0.7927383
	speed: 0.0120s/iter; left time: 45.8067s
	iters: 200, epoch: 5 | loss: 0.5720909
	speed: 0.0033s/iter; left time: 12.1752s
	iters: 300, epoch: 5 | loss: 0.9375610
	speed: 0.0032s/iter; left time: 11.4086s
	iters: 400, epoch: 5 | loss: 0.8656876
	speed: 0.0031s/iter; left time: 10.7727s
	iters: 500, epoch: 5 | loss: 0.2771267
	speed: 0.0031s/iter; left time: 10.5323s
	iters: 600, epoch: 5 | loss: 0.9628466
	speed: 0.0031s/iter; left time: 10.2735s
	iters: 700, epoch: 5 | loss: 0.6114102
	speed: 0.0031s/iter; left time: 9.8870s
	iters: 800, epoch: 5 | loss: 0.3704977
	speed: 0.0031s/iter; left time: 9.7853s
	iters: 900, epoch: 5 | loss: 0.3888090
	speed: 0.0031s/iter; left time: 9.2136s
Updating learning rate to 4.2094857181259716e-05
Epoch: 5 cost time: 3.1211771965026855
Epoch: 5, Steps: 979 | Train Loss: 0.6420853 Vali Loss: 0.5588695 Best vali loss: 0.5415405
	iters: 100, epoch: 6 | loss: 1.0833449
	speed: 0.0109s/iter; left time: 30.8203s
	iters: 200, epoch: 6 | loss: 0.3227986
	speed: 0.0031s/iter; left time: 8.4289s
	iters: 300, epoch: 6 | loss: 1.0189328
	speed: 0.0032s/iter; left time: 8.4899s
	iters: 400, epoch: 6 | loss: 0.2494190
	speed: 0.0031s/iter; left time: 7.9243s
	iters: 500, epoch: 6 | loss: 0.4710335
	speed: 0.0031s/iter; left time: 7.4980s
	iters: 600, epoch: 6 | loss: 0.9460194
	speed: 0.0032s/iter; left time: 7.4396s
	iters: 700, epoch: 6 | loss: 0.9343291
	speed: 0.0031s/iter; left time: 6.9426s
	iters: 800, epoch: 6 | loss: 0.7113906
	speed: 0.0034s/iter; left time: 7.1637s
	iters: 900, epoch: 6 | loss: 0.3659225
	speed: 0.0034s/iter; left time: 6.9745s
Updating learning rate to 1.9972407775395164e-05
Epoch: 6 cost time: 3.173383951187134
Epoch: 6, Steps: 979 | Train Loss: 0.6781323 Vali Loss: 0.5616817 Best vali loss: 0.5415405
	iters: 100, epoch: 7 | loss: 0.7511838
	speed: 0.0114s/iter; left time: 21.1196s
	iters: 200, epoch: 7 | loss: 0.6934283
	speed: 0.0036s/iter; left time: 6.3225s
	iters: 300, epoch: 7 | loss: 0.4815563
	speed: 0.0034s/iter; left time: 5.6333s
	iters: 400, epoch: 7 | loss: 0.8884099
	speed: 0.0035s/iter; left time: 5.4966s
	iters: 500, epoch: 7 | loss: 0.2154091
	speed: 0.0036s/iter; left time: 5.2127s
	iters: 600, epoch: 7 | loss: 0.4051027
	speed: 0.0036s/iter; left time: 4.8484s
	iters: 700, epoch: 7 | loss: 0.6381214
	speed: 0.0034s/iter; left time: 4.3257s
	iters: 800, epoch: 7 | loss: 0.7427445
	speed: 0.0033s/iter; left time: 3.8426s
	iters: 900, epoch: 7 | loss: 0.5882412
	speed: 0.0032s/iter; left time: 3.4401s
Updating learning rate to 5.190659663945978e-06
Epoch: 7 cost time: 3.420248508453369
Epoch: 7, Steps: 979 | Train Loss: 0.6004664 Vali Loss: 0.5726518 Best vali loss: 0.5415405
	iters: 100, epoch: 8 | loss: 0.4361872
	speed: 0.0112s/iter; left time: 9.8901s
	iters: 200, epoch: 8 | loss: 0.4726802
	speed: 0.0035s/iter; left time: 2.7286s
	iters: 300, epoch: 8 | loss: 0.8159189
	speed: 0.0034s/iter; left time: 2.2996s
	iters: 400, epoch: 8 | loss: 0.2169146
	speed: 0.0033s/iter; left time: 1.9409s
	iters: 500, epoch: 8 | loss: 0.7610809
	speed: 0.0034s/iter; left time: 1.6143s
	iters: 600, epoch: 8 | loss: 1.0039347
	speed: 0.0034s/iter; left time: 1.2831s
	iters: 700, epoch: 8 | loss: 0.5944337
	speed: 0.0034s/iter; left time: 0.9415s
	iters: 800, epoch: 8 | loss: 0.9232063
	speed: 0.0033s/iter; left time: 0.6024s
	iters: 900, epoch: 8 | loss: 0.8193430
	speed: 0.0033s/iter; left time: 0.2637s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.3457648754119873
Epoch: 8, Steps: 979 | Train Loss: 0.6715222 Vali Loss: 0.5740995 Best vali loss: 0.5415405

best validation loss 0.541540534821223

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0041980254907, 'e_layers': 2, 'learning_rate': 0.0004682911695, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004504678981284119
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 0.7781152725219727
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6078109 Best vali loss: 0.6078109
Updating learning rate to 0.00039971151551161443
Validation loss decreased (0.6078 --> 0.5747).  Saving model state dict ...
Epoch: 2 cost time: 0.47477126121520996
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5747101 Best vali loss: 0.5747101
Updating learning rate to 0.00032374922079526106
Validation loss decreased (0.5747 --> 0.5671).  Saving model state dict ...
Epoch: 3 cost time: 0.4739866256713867
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5671095 Best vali loss: 0.5671095
Updating learning rate to 0.00023414558475
Validation loss decreased (0.5671 --> 0.5612).  Saving model state dict ...
Epoch: 4 cost time: 0.47102880477905273
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5612394 Best vali loss: 0.5612394
Updating learning rate to 0.000144541948704739
Validation loss decreased (0.5612 --> 0.5516).  Saving model state dict ...
Epoch: 5 cost time: 0.4719388484954834
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5516043 Best vali loss: 0.5516043
Updating learning rate to 6.857965398838555e-05
Validation loss decreased (0.5516 --> 0.5439).  Saving model state dict ...
Epoch: 6 cost time: 0.46791958808898926
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5439465 Best vali loss: 0.5439465
Updating learning rate to 1.782327137158813e-05
Epoch: 7 cost time: 0.4746253490447998
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5461657 Best vali loss: 0.5439465
Updating learning rate to 0.0
Epoch: 8 cost time: 0.46749114990234375
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5455957 Best vali loss: 0.5439465

best validation loss 0.5439465093921589

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0026386471719, 'e_layers': 3, 'learning_rate': 0.0002216054732, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9328805
	speed: 0.0125s/iter; left time: 11.0287s
Updating learning rate to 0.0002216054732
Validation loss decreased (inf --> 0.6330).  Saving model state dict ...
Epoch: 1 cost time: 1.0428595542907715
Epoch: 1, Steps: 123 | Train Loss: 0.9328805 Vali Loss: 0.6330273 Best vali loss: 0.6330273
	iters: 100, epoch: 2 | loss: 0.8582198
	speed: 0.0087s/iter; left time: 6.6249s
Updating learning rate to 0.0001108027366
Validation loss decreased (0.6330 --> 0.6077).  Saving model state dict ...
Epoch: 2 cost time: 0.6900131702423096
Epoch: 2, Steps: 123 | Train Loss: 0.8582198 Vali Loss: 0.6077402 Best vali loss: 0.6077402
	iters: 100, epoch: 3 | loss: 0.8587905
	speed: 0.0081s/iter; left time: 5.1888s
Updating learning rate to 5.54013683e-05
Epoch: 3 cost time: 0.6547212600708008
Epoch: 3, Steps: 123 | Train Loss: 0.8587905 Vali Loss: 0.6109147 Best vali loss: 0.6077402

best validation loss 0.6077402316271735

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0011356229351, 'e_layers': 4, 'learning_rate': 0.0008253037637, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9947957
	speed: 0.0113s/iter; left time: 43.3380s
	iters: 200, epoch: 1 | loss: 1.4138328
	speed: 0.0055s/iter; left time: 20.4233s
	iters: 300, epoch: 1 | loss: 1.4124552
	speed: 0.0053s/iter; left time: 19.1471s
	iters: 400, epoch: 1 | loss: 1.1492696
	speed: 0.0054s/iter; left time: 18.8760s
Updating learning rate to 0.0007938925095434808
Validation loss decreased (inf --> 0.6220).  Saving model state dict ...
Epoch: 1 cost time: 2.997288942337036
Epoch: 1, Steps: 490 | Train Loss: 1.2425883 Vali Loss: 0.6220055 Best vali loss: 0.6220055
	iters: 100, epoch: 2 | loss: 0.6173329
	speed: 0.0138s/iter; left time: 46.1018s
	iters: 200, epoch: 2 | loss: 0.7852613
	speed: 0.0048s/iter; left time: 15.5316s
	iters: 300, epoch: 2 | loss: 0.6978207
	speed: 0.0048s/iter; left time: 15.0283s
	iters: 400, epoch: 2 | loss: 0.7490587
	speed: 0.0049s/iter; left time: 14.7339s
Updating learning rate to 0.000704440825775525
Validation loss decreased (0.6220 --> 0.6095).  Saving model state dict ...
Epoch: 2 cost time: 2.41838002204895
Epoch: 2, Steps: 490 | Train Loss: 0.7123684 Vali Loss: 0.6095041 Best vali loss: 0.6095041
	iters: 100, epoch: 3 | loss: 1.4028289
	speed: 0.0134s/iter; left time: 38.0890s
	iters: 200, epoch: 3 | loss: 0.5586213
	speed: 0.0049s/iter; left time: 13.5348s
	iters: 300, epoch: 3 | loss: 0.6810936
	speed: 0.0050s/iter; left time: 13.1586s
	iters: 400, epoch: 3 | loss: 1.2134548
	speed: 0.0049s/iter; left time: 12.5506s
Updating learning rate to 0.0005705669203682715
Epoch: 3 cost time: 2.4707448482513428
Epoch: 3, Steps: 490 | Train Loss: 0.9639997 Vali Loss: 0.6147037 Best vali loss: 0.6095041

best validation loss 0.6095041071634941

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0024593037047, 'e_layers': 3, 'learning_rate': 0.0034447493485, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0405540
	speed: 0.0105s/iter; left time: 80.9795s
	iters: 200, epoch: 1 | loss: 0.7730771
	speed: 0.0042s/iter; left time: 32.1769s
	iters: 300, epoch: 1 | loss: 0.4339173
	speed: 0.0043s/iter; left time: 32.0418s
	iters: 400, epoch: 1 | loss: 0.5182307
	speed: 0.0044s/iter; left time: 32.5713s
	iters: 500, epoch: 1 | loss: 0.5184426
	speed: 0.0044s/iter; left time: 32.3034s
	iters: 600, epoch: 1 | loss: 0.7712420
	speed: 0.0044s/iter; left time: 31.5389s
	iters: 700, epoch: 1 | loss: 1.0425563
	speed: 0.0043s/iter; left time: 30.6928s
	iters: 800, epoch: 1 | loss: 0.9106332
	speed: 0.0044s/iter; left time: 30.9160s
	iters: 900, epoch: 1 | loss: 1.3143559
	speed: 0.0044s/iter; left time: 30.6106s
Updating learning rate to 0.00331364138310537
Validation loss decreased (inf --> 0.6249).  Saving model state dict ...
Epoch: 1 cost time: 4.584200859069824
Epoch: 1, Steps: 979 | Train Loss: 0.8136677 Vali Loss: 0.6249111 Best vali loss: 0.6249111
	iters: 100, epoch: 2 | loss: 0.3298584
	speed: 0.0134s/iter; left time: 90.3664s
	iters: 200, epoch: 2 | loss: 0.9835742
	speed: 0.0044s/iter; left time: 29.2051s
	iters: 300, epoch: 2 | loss: 1.3224028
	speed: 0.0044s/iter; left time: 28.8143s
	iters: 400, epoch: 2 | loss: 0.7486131
	speed: 0.0044s/iter; left time: 28.3186s
	iters: 500, epoch: 2 | loss: 0.3361275
	speed: 0.0044s/iter; left time: 28.0732s
	iters: 600, epoch: 2 | loss: 0.4065581
	speed: 0.0043s/iter; left time: 26.9086s
	iters: 700, epoch: 2 | loss: 0.5354974
	speed: 0.0044s/iter; left time: 26.9700s
	iters: 800, epoch: 2 | loss: 0.9465322
	speed: 0.0044s/iter; left time: 26.6367s
	iters: 900, epoch: 2 | loss: 0.3821965
	speed: 0.0044s/iter; left time: 26.2260s
Updating learning rate to 0.002940277486156146
Epoch: 2 cost time: 4.336909294128418
Epoch: 2, Steps: 979 | Train Loss: 0.6657067 Vali Loss: 0.6358532 Best vali loss: 0.6249111
	iters: 100, epoch: 3 | loss: 1.4319223
	speed: 0.0133s/iter; left time: 76.5714s
	iters: 200, epoch: 3 | loss: 0.5253364
	speed: 0.0040s/iter; left time: 22.7008s
	iters: 300, epoch: 3 | loss: 0.4863686
	speed: 0.0040s/iter; left time: 22.1932s
	iters: 400, epoch: 3 | loss: 1.2085165
	speed: 0.0039s/iter; left time: 21.5264s
	iters: 500, epoch: 3 | loss: 0.9635462
	speed: 0.0039s/iter; left time: 20.7459s
	iters: 600, epoch: 3 | loss: 0.9953028
	speed: 0.0043s/iter; left time: 22.8031s
	iters: 700, epoch: 3 | loss: 0.8941918
	speed: 0.0045s/iter; left time: 23.0911s
	iters: 800, epoch: 3 | loss: 1.1888815
	speed: 0.0043s/iter; left time: 22.0451s
	iters: 900, epoch: 3 | loss: 1.0251697
	speed: 0.0043s/iter; left time: 21.6276s
Updating learning rate to 0.0023814989264106935
Epoch: 3 cost time: 4.112882614135742
Epoch: 3, Steps: 979 | Train Loss: 0.9688040 Vali Loss: 0.6432636 Best vali loss: 0.6249111

best validation loss 0.6249111269026209

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0026386471719, 'e_layers': 3, 'learning_rate': 0.0002216054732, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9158885
	speed: 0.0119s/iter; left time: 6.1224s
Updating learning rate to 2.770068415e-05
Validation loss decreased (0.6077 --> 0.6066).  Saving model state dict ...
Epoch: 4 cost time: 1.0180325508117676
Epoch: 4, Steps: 123 | Train Loss: 0.9158885 Vali Loss: 0.6066019 Best vali loss: 0.6066019
	iters: 100, epoch: 5 | loss: 0.8410042
	speed: 0.0087s/iter; left time: 3.4054s
Updating learning rate to 1.3850342075e-05
Validation loss decreased (0.6066 --> 0.6062).  Saving model state dict ...
Epoch: 5 cost time: 0.7080965042114258
Epoch: 5, Steps: 123 | Train Loss: 0.8410042 Vali Loss: 0.6061984 Best vali loss: 0.6061984
	iters: 100, epoch: 6 | loss: 0.8542932
	speed: 0.0089s/iter; left time: 2.4029s
Updating learning rate to 6.9251710375e-06
Validation loss decreased (0.6062 --> 0.6061).  Saving model state dict ...
Epoch: 6 cost time: 0.7218613624572754
Epoch: 6, Steps: 123 | Train Loss: 0.8542932 Vali Loss: 0.6060539 Best vali loss: 0.6060539
	iters: 100, epoch: 7 | loss: 0.9576659
	speed: 0.0086s/iter; left time: 1.2573s
Updating learning rate to 3.46258551875e-06
Validation loss decreased (0.6061 --> 0.6060).  Saving model state dict ...
Epoch: 7 cost time: 0.6828627586364746
Epoch: 7, Steps: 123 | Train Loss: 0.9576659 Vali Loss: 0.6059987 Best vali loss: 0.6059987
	iters: 100, epoch: 8 | loss: 0.6166947
	speed: 0.0081s/iter; left time: 0.1941s
Updating learning rate to 1.731292759375e-06
Validation loss decreased (0.6060 --> 0.6059).  Saving model state dict ...
Epoch: 8 cost time: 0.6442966461181641
Epoch: 8, Steps: 123 | Train Loss: 0.6166947 Vali Loss: 0.6059000 Best vali loss: 0.6059000

best validation loss 0.6058999785445786

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976934783, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7745721
	speed: 0.0119s/iter; left time: 10.5088s
Updating learning rate to 0.00028636319493173144
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0229387283325195
Epoch: 1, Steps: 123 | Train Loss: 0.7745721 Vali Loss: 0.6173268 Best vali loss: 0.6173268
	iters: 100, epoch: 2 | loss: 0.9486846
	speed: 0.0092s/iter; left time: 7.0295s
Updating learning rate to 0.00025409727776047017
Validation loss decreased (0.6173 --> 0.5574).  Saving model state dict ...
Epoch: 2 cost time: 0.7177789211273193
Epoch: 2, Steps: 123 | Train Loss: 0.9486846 Vali Loss: 0.5573700 Best vali loss: 0.5573700
	iters: 100, epoch: 3 | loss: 0.8395152
	speed: 0.0092s/iter; left time: 5.8949s
Updating learning rate to 0.0002058079201842732
Validation loss decreased (0.5574 --> 0.5493).  Saving model state dict ...
Epoch: 3 cost time: 0.7146480083465576
Epoch: 3, Steps: 123 | Train Loss: 0.8395152 Vali Loss: 0.5493379 Best vali loss: 0.5493379
	iters: 100, epoch: 4 | loss: 0.4911281
	speed: 0.0091s/iter; left time: 4.7043s
Updating learning rate to 0.00014884673915
Validation loss decreased (0.5493 --> 0.5430).  Saving model state dict ...
Epoch: 4 cost time: 0.7169198989868164
Epoch: 4, Steps: 123 | Train Loss: 0.4911281 Vali Loss: 0.5429660 Best vali loss: 0.5429660
	iters: 100, epoch: 5 | loss: 0.5642740
	speed: 0.0092s/iter; left time: 3.6172s
Updating learning rate to 9.188555811572682e-05
Validation loss decreased (0.5430 --> 0.5310).  Saving model state dict ...
Epoch: 5 cost time: 0.7131221294403076
Epoch: 5, Steps: 123 | Train Loss: 0.5642740 Vali Loss: 0.5310364 Best vali loss: 0.5310364
	iters: 100, epoch: 6 | loss: 0.5817475
	speed: 0.0092s/iter; left time: 2.4754s
Updating learning rate to 4.359620053952984e-05
Epoch: 6 cost time: 0.7115573883056641
Epoch: 6, Steps: 123 | Train Loss: 0.5817475 Vali Loss: 0.5418723 Best vali loss: 0.5310364
	iters: 100, epoch: 7 | loss: 0.5429049
	speed: 0.0090s/iter; left time: 1.3241s
Updating learning rate to 1.1330283368268559e-05
Epoch: 7 cost time: 0.7274875640869141
Epoch: 7, Steps: 123 | Train Loss: 0.5429049 Vali Loss: 0.5403405 Best vali loss: 0.5310364
	iters: 100, epoch: 8 | loss: 0.6941861
	speed: 0.0090s/iter; left time: 0.2150s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7086765766143799
Epoch: 8, Steps: 123 | Train Loss: 0.6941861 Vali Loss: 0.5461248 Best vali loss: 0.5310364

best validation loss 0.5310363719607878

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0109287328069, 'e_layers': 1, 'learning_rate': 0.0006278104375, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006039158255016032
Validation loss decreased (inf --> 0.6137).  Saving model state dict ...
Epoch: 1 cost time: 0.7388782501220703
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6137400 Best vali loss: 0.6137400
Updating learning rate to 0.0005358697275779715
Validation loss decreased (0.6137 --> 0.6002).  Saving model state dict ...
Epoch: 2 cost time: 0.45586276054382324
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6002406 Best vali loss: 0.6002406
Updating learning rate to 0.00043403154529856437
Epoch: 3 cost time: 0.4347188472747803
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6009509 Best vali loss: 0.6002406
Updating learning rate to 0.00031390521875
Epoch: 4 cost time: 0.42377758026123047
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6119137 Best vali loss: 0.6002406
Updating learning rate to 0.00019377889220143567
Epoch: 5 cost time: 0.46109604835510254
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6351843 Best vali loss: 0.6002406
Updating learning rate to 9.194070992202843e-05
Epoch: 6 cost time: 0.4230647087097168
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6393315 Best vali loss: 0.6002406
Updating learning rate to 2.38946119983968e-05
Epoch: 7 cost time: 0.44412994384765625
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6404589 Best vali loss: 0.6002406
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4513881206512451
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6403023 Best vali loss: 0.6002406

best validation loss 0.6002406129292016

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010685214627, 'e_layers': 3, 'learning_rate': 0.0004709259838, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004709259838
Validation loss decreased (inf --> 0.5674).  Saving model state dict ...
Epoch: 1 cost time: 1.079866647720337
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5673599 Best vali loss: 0.5673599
Updating learning rate to 0.0002354629919
Validation loss decreased (0.5674 --> 0.5632).  Saving model state dict ...
Epoch: 2 cost time: 0.7847573757171631
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5632241 Best vali loss: 0.5632241
Updating learning rate to 0.00011773149595
Validation loss decreased (0.5632 --> 0.5555).  Saving model state dict ...
Epoch: 3 cost time: 0.7783796787261963
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5554870 Best vali loss: 0.5554870

best validation loss 0.5554870196041936

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039297584698, 'e_layers': 3, 'learning_rate': 0.0005222675569, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6347569
	speed: 0.0113s/iter; left time: 21.0183s
	iters: 200, epoch: 1 | loss: 0.6033171
	speed: 0.0050s/iter; left time: 8.8523s
Updating learning rate to 0.000502389931607292
Validation loss decreased (inf --> 0.6404).  Saving model state dict ...
Epoch: 1 cost time: 1.5899953842163086
Epoch: 1, Steps: 245 | Train Loss: 0.6190370 Vali Loss: 0.6403785 Best vali loss: 0.6403785
	iters: 100, epoch: 2 | loss: 0.5582522
	speed: 0.0105s/iter; left time: 16.8956s
	iters: 200, epoch: 2 | loss: 1.3310829
	speed: 0.0048s/iter; left time: 7.3496s
Updating learning rate to 0.0004457832439888606
Validation loss decreased (0.6404 --> 0.6293).  Saving model state dict ...
Epoch: 2 cost time: 1.2594141960144043
Epoch: 2, Steps: 245 | Train Loss: 0.9446676 Vali Loss: 0.6292853 Best vali loss: 0.6292853
	iters: 100, epoch: 3 | loss: 0.8661175
	speed: 0.0105s/iter; left time: 14.4504s
	iters: 200, epoch: 3 | loss: 0.5201590
	speed: 0.0050s/iter; left time: 6.3268s
Updating learning rate to 0.00036106534909371096
Validation loss decreased (0.6293 --> 0.6237).  Saving model state dict ...
Epoch: 3 cost time: 1.277224063873291
Epoch: 3, Steps: 245 | Train Loss: 0.6931382 Vali Loss: 0.6236751 Best vali loss: 0.6236751

best validation loss 0.6236751219951572

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039790507996, 'e_layers': 3, 'learning_rate': 0.0005253286605, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6280739
	speed: 0.0115s/iter; left time: 21.4187s
	iters: 200, epoch: 1 | loss: 0.6113385
	speed: 0.0052s/iter; left time: 9.1275s
Updating learning rate to 0.0005053345288887602
Validation loss decreased (inf --> 0.6303).  Saving model state dict ...
Epoch: 1 cost time: 1.6128942966461182
Epoch: 1, Steps: 245 | Train Loss: 0.6197062 Vali Loss: 0.6303494 Best vali loss: 0.6303494
	iters: 100, epoch: 2 | loss: 0.5724465
	speed: 0.0104s/iter; left time: 16.7947s
	iters: 200, epoch: 2 | loss: 1.3865567
	speed: 0.0052s/iter; left time: 7.8266s
Updating learning rate to 0.00044839605934559777
Validation loss decreased (0.6303 --> 0.6231).  Saving model state dict ...
Epoch: 2 cost time: 1.3040788173675537
Epoch: 2, Steps: 245 | Train Loss: 0.9795016 Vali Loss: 0.6230521 Best vali loss: 0.6230521
	iters: 100, epoch: 3 | loss: 0.8705851
	speed: 0.0105s/iter; left time: 14.4581s
	iters: 200, epoch: 3 | loss: 0.4884310
	speed: 0.0049s/iter; left time: 6.2521s
Updating learning rate to 0.0003631816177099475
Validation loss decreased (0.6231 --> 0.6165).  Saving model state dict ...
Epoch: 3 cost time: 1.2685494422912598
Epoch: 3, Steps: 245 | Train Loss: 0.6795081 Vali Loss: 0.6165409 Best vali loss: 0.6165409

best validation loss 0.6165409348784415

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010685214627, 'e_layers': 3, 'learning_rate': 0.0004709259838, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.8865747975e-05
Validation loss decreased (0.5555 --> 0.5465).  Saving model state dict ...
Epoch: 4 cost time: 1.0906932353973389
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5464798 Best vali loss: 0.5464798
Updating learning rate to 2.94328739875e-05
Validation loss decreased (0.5465 --> 0.5419).  Saving model state dict ...
Epoch: 5 cost time: 0.7891063690185547
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5418845 Best vali loss: 0.5418845
Updating learning rate to 1.471643699375e-05
Validation loss decreased (0.5419 --> 0.5417).  Saving model state dict ...
Epoch: 6 cost time: 0.7950568199157715
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5417454 Best vali loss: 0.5417454
Updating learning rate to 7.358218496875e-06
Validation loss decreased (0.5417 --> 0.5405).  Saving model state dict ...
Epoch: 7 cost time: 0.7941446304321289
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5404633 Best vali loss: 0.5404633
Updating learning rate to 3.6791092484375e-06
Validation loss decreased (0.5405 --> 0.5373).  Saving model state dict ...
Epoch: 8 cost time: 0.7933831214904785
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5373150 Best vali loss: 0.5373150

best validation loss 0.5373149603288078

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0062779694891, 'e_layers': 2, 'learning_rate': 0.000613679785, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8545653
	speed: 0.0097s/iter; left time: 37.0464s
	iters: 200, epoch: 1 | loss: 0.9317515
	speed: 0.0034s/iter; left time: 12.7731s
	iters: 300, epoch: 1 | loss: 0.4351329
	speed: 0.0036s/iter; left time: 13.0015s
	iters: 400, epoch: 1 | loss: 1.3148899
	speed: 0.0036s/iter; left time: 12.5721s
Updating learning rate to 0.0005903229889387135
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 2.086503505706787
Epoch: 1, Steps: 490 | Train Loss: 0.8840849 Vali Loss: 0.6066591 Best vali loss: 0.6066591
	iters: 100, epoch: 2 | loss: 1.0414029
	speed: 0.0100s/iter; left time: 33.4108s
	iters: 200, epoch: 2 | loss: 1.3154104
	speed: 0.0031s/iter; left time: 10.0368s
	iters: 300, epoch: 2 | loss: 1.2799395
	speed: 0.0031s/iter; left time: 9.6944s
	iters: 400, epoch: 2 | loss: 0.4696887
	speed: 0.0031s/iter; left time: 9.3937s
Updating learning rate to 0.0005238084612253013
Validation loss decreased (0.6067 --> 0.5944).  Saving model state dict ...
Epoch: 2 cost time: 1.5769925117492676
Epoch: 2, Steps: 490 | Train Loss: 1.0266104 Vali Loss: 0.5944377 Best vali loss: 0.5944377
	iters: 100, epoch: 3 | loss: 1.4690106
	speed: 0.0091s/iter; left time: 25.7347s
	iters: 200, epoch: 3 | loss: 0.6862723
	speed: 0.0031s/iter; left time: 8.5918s
	iters: 300, epoch: 3 | loss: 1.0136021
	speed: 0.0031s/iter; left time: 8.1786s
	iters: 400, epoch: 3 | loss: 0.7994080
	speed: 0.0031s/iter; left time: 7.9183s
Updating learning rate to 0.0004242624357484352
Epoch: 3 cost time: 1.581099271774292
Epoch: 3, Steps: 490 | Train Loss: 0.9920732 Vali Loss: 0.6088008 Best vali loss: 0.5944377
	iters: 100, epoch: 4 | loss: 0.5325078
	speed: 0.0098s/iter; left time: 22.9508s
	iters: 200, epoch: 4 | loss: 0.3414501
	speed: 0.0037s/iter; left time: 8.3698s
	iters: 300, epoch: 4 | loss: 1.6785253
	speed: 0.0037s/iter; left time: 7.9415s
	iters: 400, epoch: 4 | loss: 0.5936068
	speed: 0.0035s/iter; left time: 7.1255s
Updating learning rate to 0.0003068398925
Epoch: 4 cost time: 1.8303656578063965
Epoch: 4, Steps: 490 | Train Loss: 0.7865225 Vali Loss: 0.6075643 Best vali loss: 0.5944377
	iters: 100, epoch: 5 | loss: 0.8594639
	speed: 0.0104s/iter; left time: 19.4012s
	iters: 200, epoch: 5 | loss: 1.0939806
	speed: 0.0037s/iter; left time: 6.5262s
	iters: 300, epoch: 5 | loss: 0.7549624
	speed: 0.0037s/iter; left time: 6.1390s
	iters: 400, epoch: 5 | loss: 0.6781955
	speed: 0.0037s/iter; left time: 5.7696s
Updating learning rate to 0.00018941734925156486
Epoch: 5 cost time: 1.8631513118743896
Epoch: 5, Steps: 490 | Train Loss: 0.8466506 Vali Loss: 0.6101472 Best vali loss: 0.5944377
	iters: 100, epoch: 6 | loss: 0.8584765
	speed: 0.0103s/iter; left time: 14.1305s
	iters: 200, epoch: 6 | loss: 0.9530625
	speed: 0.0035s/iter; left time: 4.4314s
	iters: 300, epoch: 6 | loss: 0.8570398
	speed: 0.0034s/iter; left time: 4.0309s
	iters: 400, epoch: 6 | loss: 0.5249221
	speed: 0.0035s/iter; left time: 3.7017s
Updating learning rate to 8.987132377469875e-05
Epoch: 6 cost time: 1.7594075202941895
Epoch: 6, Steps: 490 | Train Loss: 0.7983752 Vali Loss: 0.6108877 Best vali loss: 0.5944377
	iters: 100, epoch: 7 | loss: 0.6374121
	speed: 0.0099s/iter; left time: 8.7084s
	iters: 200, epoch: 7 | loss: 0.4377700
	speed: 0.0033s/iter; left time: 2.5935s
	iters: 300, epoch: 7 | loss: 0.7093117
	speed: 0.0034s/iter; left time: 2.2840s
	iters: 400, epoch: 7 | loss: 0.9885740
	speed: 0.0033s/iter; left time: 1.9449s
Updating learning rate to 2.3356796061286522e-05
Epoch: 7 cost time: 1.703345537185669
Epoch: 7, Steps: 490 | Train Loss: 0.6932669 Vali Loss: 0.6152063 Best vali loss: 0.5944377
	iters: 100, epoch: 8 | loss: 0.9536613
	speed: 0.0096s/iter; left time: 3.7488s
	iters: 200, epoch: 8 | loss: 0.4531718
	speed: 0.0031s/iter; left time: 0.8991s
	iters: 300, epoch: 8 | loss: 0.8040541
	speed: 0.0031s/iter; left time: 0.5905s
	iters: 400, epoch: 8 | loss: 0.9868412
	speed: 0.0031s/iter; left time: 0.2791s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5555202960968018
Epoch: 8, Steps: 490 | Train Loss: 0.7994321 Vali Loss: 0.6144202 Best vali loss: 0.5944377

best validation loss 0.5944377057037107

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0013678400693, 'e_layers': 2, 'learning_rate': 9.41598014e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9826000
	speed: 0.0106s/iter; left time: 9.3751s
Updating learning rate to 9.05760573493938e-05
Validation loss decreased (inf --> 0.6901).  Saving model state dict ...
Epoch: 1 cost time: 0.8973424434661865
Epoch: 1, Steps: 123 | Train Loss: 0.9826000 Vali Loss: 0.6900820 Best vali loss: 0.6900820
	iters: 100, epoch: 2 | loss: 1.1545596
	speed: 0.0077s/iter; left time: 5.8915s
Updating learning rate to 8.037041774255927e-05
Validation loss decreased (0.6901 --> 0.6694).  Saving model state dict ...
Epoch: 2 cost time: 0.6065018177032471
Epoch: 2, Steps: 123 | Train Loss: 1.1545596 Vali Loss: 0.6694067 Best vali loss: 0.6694067
	iters: 100, epoch: 3 | loss: 0.6687329
	speed: 0.0077s/iter; left time: 4.8892s
Updating learning rate to 6.509659869528359e-05
Validation loss decreased (0.6694 --> 0.6534).  Saving model state dict ...
Epoch: 3 cost time: 0.6067357063293457
Epoch: 3, Steps: 123 | Train Loss: 0.6687329 Vali Loss: 0.6533688 Best vali loss: 0.6533688
	iters: 100, epoch: 4 | loss: 0.8611085
	speed: 0.0076s/iter; left time: 3.9209s
Updating learning rate to 4.70799007e-05
Validation loss decreased (0.6534 --> 0.6443).  Saving model state dict ...
Epoch: 4 cost time: 0.5780074596405029
Epoch: 4, Steps: 123 | Train Loss: 0.8611085 Vali Loss: 0.6442600 Best vali loss: 0.6442600
	iters: 100, epoch: 5 | loss: 0.9548948
	speed: 0.0078s/iter; left time: 3.0742s
Updating learning rate to 2.9063202704716408e-05
Validation loss decreased (0.6443 --> 0.6391).  Saving model state dict ...
Epoch: 5 cost time: 0.6138243675231934
Epoch: 5, Steps: 123 | Train Loss: 0.9548948 Vali Loss: 0.6390764 Best vali loss: 0.6390764
	iters: 100, epoch: 6 | loss: 0.6924617
	speed: 0.0076s/iter; left time: 2.0489s
Updating learning rate to 1.3789383657440716e-05
Validation loss decreased (0.6391 --> 0.6362).  Saving model state dict ...
Epoch: 6 cost time: 0.6062831878662109
Epoch: 6, Steps: 123 | Train Loss: 0.6924617 Vali Loss: 0.6361804 Best vali loss: 0.6361804
	iters: 100, epoch: 7 | loss: 0.9530076
	speed: 0.0075s/iter; left time: 1.1086s
Updating learning rate to 3.5837440506061986e-06
Validation loss decreased (0.6362 --> 0.6352).  Saving model state dict ...
Epoch: 7 cost time: 0.5820062160491943
Epoch: 7, Steps: 123 | Train Loss: 0.9530076 Vali Loss: 0.6352258 Best vali loss: 0.6352258
	iters: 100, epoch: 8 | loss: 0.7419076
	speed: 0.0073s/iter; left time: 0.1752s
Updating learning rate to 0.0
Validation loss decreased (0.6352 --> 0.6349).  Saving model state dict ...
Epoch: 8 cost time: 0.5643332004547119
Epoch: 8, Steps: 123 | Train Loss: 0.7419076 Vali Loss: 0.6349123 Best vali loss: 0.6349123

best validation loss 0.6349122515435243

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0029690240218, 'e_layers': 4, 'learning_rate': 0.0001089771709, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9873018
	speed: 0.0123s/iter; left time: 10.8922s
Updating learning rate to 0.0001089771709
Validation loss decreased (inf --> 0.6832).  Saving model state dict ...
Epoch: 1 cost time: 1.1003797054290771
Epoch: 1, Steps: 123 | Train Loss: 0.9873018 Vali Loss: 0.6832154 Best vali loss: 0.6832154
	iters: 100, epoch: 2 | loss: 1.0241619
	speed: 0.0098s/iter; left time: 7.4937s
Updating learning rate to 5.448858545e-05
Validation loss decreased (0.6832 --> 0.6568).  Saving model state dict ...
Epoch: 2 cost time: 0.817582368850708
Epoch: 2, Steps: 123 | Train Loss: 1.0241619 Vali Loss: 0.6568322 Best vali loss: 0.6568322
	iters: 100, epoch: 3 | loss: 1.0614245
	speed: 0.0099s/iter; left time: 6.3012s
Updating learning rate to 2.7244292725e-05
Validation loss decreased (0.6568 --> 0.6471).  Saving model state dict ...
Epoch: 3 cost time: 0.825242280960083
Epoch: 3, Steps: 123 | Train Loss: 1.0614245 Vali Loss: 0.6471306 Best vali loss: 0.6471306

best validation loss 0.6471306170814846

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001049520064, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744735
	speed: 0.0117s/iter; left time: 10.3276s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.013171911239624
Epoch: 1, Steps: 123 | Train Loss: 0.7744735 Vali Loss: 0.6173171 Best vali loss: 0.6173171
	iters: 100, epoch: 2 | loss: 0.9495761
	speed: 0.0092s/iter; left time: 7.0202s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6173 --> 0.5879).  Saving model state dict ...
Epoch: 2 cost time: 0.7099521160125732
Epoch: 2, Steps: 123 | Train Loss: 0.9495761 Vali Loss: 0.5879330 Best vali loss: 0.5879330
	iters: 100, epoch: 3 | loss: 0.8477493
	speed: 0.0092s/iter; left time: 5.8612s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5879 --> 0.5469).  Saving model state dict ...
Epoch: 3 cost time: 0.7118673324584961
Epoch: 3, Steps: 123 | Train Loss: 0.8477493 Vali Loss: 0.5469369 Best vali loss: 0.5469369

best validation loss 0.5469369407827686

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494792795, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744652
	speed: 0.0119s/iter; left time: 10.5318s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.036015272140503
Epoch: 1, Steps: 123 | Train Loss: 0.7744652 Vali Loss: 0.6172923 Best vali loss: 0.6172923
	iters: 100, epoch: 2 | loss: 0.9520369
	speed: 0.0093s/iter; left time: 7.0518s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5712).  Saving model state dict ...
Epoch: 2 cost time: 0.7242980003356934
Epoch: 2, Steps: 123 | Train Loss: 0.9520369 Vali Loss: 0.5711821 Best vali loss: 0.5711821
	iters: 100, epoch: 3 | loss: 0.8509780
	speed: 0.0092s/iter; left time: 5.8679s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5712 --> 0.5492).  Saving model state dict ...
Epoch: 3 cost time: 0.7136728763580322
Epoch: 3, Steps: 123 | Train Loss: 0.8509780 Vali Loss: 0.5491628 Best vali loss: 0.5491628

best validation loss 0.5491628322210758

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001049520064, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5891035
	speed: 0.0122s/iter; left time: 6.2813s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5469 --> 0.5356).  Saving model state dict ...
Epoch: 4 cost time: 1.0355031490325928
Epoch: 4, Steps: 123 | Train Loss: 0.5891035 Vali Loss: 0.5356305 Best vali loss: 0.5356305
	iters: 100, epoch: 5 | loss: 0.8249690
	speed: 0.0095s/iter; left time: 3.7237s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5356 --> 0.5252).  Saving model state dict ...
Epoch: 5 cost time: 0.7282097339630127
Epoch: 5, Steps: 123 | Train Loss: 0.8249690 Vali Loss: 0.5252165 Best vali loss: 0.5252165
	iters: 100, epoch: 6 | loss: 0.7549374
	speed: 0.0096s/iter; left time: 2.5876s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7352981567382812
Epoch: 6, Steps: 123 | Train Loss: 0.7549374 Vali Loss: 0.5307369 Best vali loss: 0.5252165
	iters: 100, epoch: 7 | loss: 0.4303425
	speed: 0.0094s/iter; left time: 1.3790s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.7361404895782471
Epoch: 7, Steps: 123 | Train Loss: 0.4303425 Vali Loss: 0.5400272 Best vali loss: 0.5252165
	iters: 100, epoch: 8 | loss: 0.5097890
	speed: 0.0095s/iter; left time: 0.2274s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.742119312286377
Epoch: 8, Steps: 123 | Train Loss: 0.5097890 Vali Loss: 0.5394473 Best vali loss: 0.5252165

best validation loss 0.5252165062071161

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0011687686777, 'e_layers': 1, 'learning_rate': 0.0001286576775, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001286576775
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 0.7670109272003174
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6063602 Best vali loss: 0.6063602
Updating learning rate to 6.432883875e-05
Validation loss decreased (0.6064 --> 0.6059).  Saving model state dict ...
Epoch: 2 cost time: 0.4345095157623291
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6059446 Best vali loss: 0.6059446
Updating learning rate to 3.2164419375e-05
Epoch: 3 cost time: 0.42289185523986816
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6083501 Best vali loss: 0.6059446
Updating learning rate to 1.60822096875e-05
Validation loss decreased (0.6059 --> 0.6045).  Saving model state dict ...
Epoch: 4 cost time: 0.45728015899658203
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6045358 Best vali loss: 0.6045358
Updating learning rate to 8.04110484375e-06
Epoch: 5 cost time: 0.4366450309753418
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6059055 Best vali loss: 0.6045358
Updating learning rate to 4.020552421875e-06
Epoch: 6 cost time: 0.44604992866516113
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6046392 Best vali loss: 0.6045358
Updating learning rate to 2.0102762109375e-06
Validation loss decreased (0.6045 --> 0.6043).  Saving model state dict ...
Epoch: 7 cost time: 0.47313547134399414
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6042978 Best vali loss: 0.6042978
Updating learning rate to 1.00513810546875e-06
Epoch: 8 cost time: 0.4168972969055176
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6046135 Best vali loss: 0.6042978

best validation loss 0.6042978065756393

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0108976879386, 'e_layers': 1, 'learning_rate': 8.93412174e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.93412174e-05
Validation loss decreased (inf --> 0.6469).  Saving model state dict ...
Epoch: 1 cost time: 0.7066473960876465
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6468918 Best vali loss: 0.6468918
Updating learning rate to 4.46706087e-05
Validation loss decreased (0.6469 --> 0.6171).  Saving model state dict ...
Epoch: 2 cost time: 0.4542810916900635
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6171230 Best vali loss: 0.6171230
Updating learning rate to 2.233530435e-05
Validation loss decreased (0.6171 --> 0.6105).  Saving model state dict ...
Epoch: 3 cost time: 0.4347822666168213
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6104576 Best vali loss: 0.6104576
Updating learning rate to 1.1167652175e-05
Validation loss decreased (0.6105 --> 0.6083).  Saving model state dict ...
Epoch: 4 cost time: 0.439380407333374
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6082662 Best vali loss: 0.6082662
Updating learning rate to 5.5838260875e-06
Validation loss decreased (0.6083 --> 0.6080).  Saving model state dict ...
Epoch: 5 cost time: 0.45408201217651367
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6080156 Best vali loss: 0.6080156
Updating learning rate to 2.79191304375e-06
Validation loss decreased (0.6080 --> 0.6076).  Saving model state dict ...
Epoch: 6 cost time: 0.4422924518585205
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6076030 Best vali loss: 0.6076030
Updating learning rate to 1.395956521875e-06
Validation loss decreased (0.6076 --> 0.6074).  Saving model state dict ...
Epoch: 7 cost time: 0.42084789276123047
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6074353 Best vali loss: 0.6074353
Updating learning rate to 6.979782609375e-07
Validation loss decreased (0.6074 --> 0.6072).  Saving model state dict ...
Epoch: 8 cost time: 0.4573941230773926
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6071830 Best vali loss: 0.6071830

best validation loss 0.6071829593385717

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0083349778281, 'e_layers': 3, 'learning_rate': 0.0006900105855, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5483860
	speed: 0.0115s/iter; left time: 21.3135s
	iters: 200, epoch: 1 | loss: 0.6682683
	speed: 0.0056s/iter; left time: 9.8469s
Updating learning rate to 0.0006637486213297896
Validation loss decreased (inf --> 0.6598).  Saving model state dict ...
Epoch: 1 cost time: 1.7571144104003906
Epoch: 1, Steps: 245 | Train Loss: 0.6083271 Vali Loss: 0.6597870 Best vali loss: 0.6597870
	iters: 100, epoch: 2 | loss: 0.8126035
	speed: 0.0118s/iter; left time: 19.1078s
	iters: 200, epoch: 2 | loss: 0.9959916
	speed: 0.0056s/iter; left time: 8.4978s
Updating learning rate to 0.000588960874798775
Epoch: 2 cost time: 1.4430327415466309
Epoch: 2, Steps: 245 | Train Loss: 0.9042976 Vali Loss: 0.6656768 Best vali loss: 0.6597870
	iters: 100, epoch: 3 | loss: 0.8634379
	speed: 0.0115s/iter; left time: 15.8168s
	iters: 200, epoch: 3 | loss: 0.7727426
	speed: 0.0057s/iter; left time: 7.1962s
Updating learning rate to 0.00047703310236369263
Validation loss decreased (0.6598 --> 0.6334).  Saving model state dict ...
Epoch: 3 cost time: 1.4513249397277832
Epoch: 3, Steps: 245 | Train Loss: 0.8180903 Vali Loss: 0.6334360 Best vali loss: 0.6334360

best validation loss 0.6334359720866474

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494665051, 'e_layers': 2, 'learning_rate': 0.0002991065195, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745131
	speed: 0.0129s/iter; left time: 11.3939s
Updating learning rate to 0.000287722455453369
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.2115521430969238
Epoch: 1, Steps: 123 | Train Loss: 0.7745131 Vali Loss: 0.6172411 Best vali loss: 0.6172411
	iters: 100, epoch: 2 | loss: 0.9474227
	speed: 0.0093s/iter; left time: 7.0629s
Updating learning rate to 0.00025530338386777813
Validation loss decreased (0.6172 --> 0.5569).  Saving model state dict ...
Epoch: 2 cost time: 0.7189154624938965
Epoch: 2, Steps: 123 | Train Loss: 0.9474227 Vali Loss: 0.5569423 Best vali loss: 0.5569423
	iters: 100, epoch: 3 | loss: 0.8599491
	speed: 0.0092s/iter; left time: 5.9070s
Updating learning rate to 0.00020678481451251782
Validation loss decreased (0.5569 --> 0.5458).  Saving model state dict ...
Epoch: 3 cost time: 0.7149784564971924
Epoch: 3, Steps: 123 | Train Loss: 0.8599491 Vali Loss: 0.5458037 Best vali loss: 0.5458037

best validation loss 0.5458037488331458

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010715423488, 'e_layers': 2, 'learning_rate': 0.0028153301589, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0028153301589
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 0.7474792003631592
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6076121 Best vali loss: 0.6076121
Updating learning rate to 0.00140766507945
Epoch: 2 cost time: 0.4492034912109375
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6206069 Best vali loss: 0.6076121
Updating learning rate to 0.000703832539725
Epoch: 3 cost time: 0.42661046981811523
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6223271 Best vali loss: 0.6076121

best validation loss 0.6076120898051706

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494665051, 'e_layers': 2, 'learning_rate': 0.0002991065195, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5890543
	speed: 0.0123s/iter; left time: 6.3332s
Updating learning rate to 0.00014955325975
Validation loss decreased (0.5458 --> 0.5286).  Saving model state dict ...
Epoch: 4 cost time: 1.0506763458251953
Epoch: 4, Steps: 123 | Train Loss: 0.5890543 Vali Loss: 0.5285637 Best vali loss: 0.5285637
	iters: 100, epoch: 5 | loss: 0.8234487
	speed: 0.0093s/iter; left time: 3.6546s
Updating learning rate to 9.232170498748217e-05
Epoch: 5 cost time: 0.7199325561523438
Epoch: 5, Steps: 123 | Train Loss: 0.8234487 Vali Loss: 0.5299105 Best vali loss: 0.5285637
	iters: 100, epoch: 6 | loss: 0.7649820
	speed: 0.0089s/iter; left time: 2.3967s
Updating learning rate to 4.380313563222185e-05
Epoch: 6 cost time: 0.7074446678161621
Epoch: 6, Steps: 123 | Train Loss: 0.7649820 Vali Loss: 0.5348005 Best vali loss: 0.5285637
	iters: 100, epoch: 7 | loss: 0.4305229
	speed: 0.0090s/iter; left time: 1.3172s
Updating learning rate to 1.1384064046630964e-05
Epoch: 7 cost time: 0.7160835266113281
Epoch: 7, Steps: 123 | Train Loss: 0.4305229 Vali Loss: 0.5414952 Best vali loss: 0.5285637
	iters: 100, epoch: 8 | loss: 0.5062097
	speed: 0.0089s/iter; left time: 0.2133s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7115993499755859
Epoch: 8, Steps: 123 | Train Loss: 0.5062097 Vali Loss: 0.5412333 Best vali loss: 0.5285637

best validation loss 0.5285636738239202

[INFO][smbo.py:320] Finished 1000 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008795135082, 'e_layers': 2, 'learning_rate': 0.0002119451777, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8894971
	speed: 0.0098s/iter; left time: 37.5495s
	iters: 200, epoch: 1 | loss: 0.5721750
	speed: 0.0034s/iter; left time: 12.5886s
	iters: 300, epoch: 1 | loss: 1.1303414
	speed: 0.0034s/iter; left time: 12.3031s
	iters: 400, epoch: 1 | loss: 0.9234900
	speed: 0.0036s/iter; left time: 12.6161s
Updating learning rate to 0.0002038784946957488
Validation loss decreased (inf --> 0.6284).  Saving model state dict ...
Epoch: 1 cost time: 2.0547330379486084
Epoch: 1, Steps: 490 | Train Loss: 0.8788759 Vali Loss: 0.6284086 Best vali loss: 0.6284086
	iters: 100, epoch: 2 | loss: 0.7811922
	speed: 0.0099s/iter; left time: 32.9776s
	iters: 200, epoch: 2 | loss: 0.6634334
	speed: 0.0036s/iter; left time: 11.6033s
	iters: 300, epoch: 2 | loss: 1.1425941
	speed: 0.0036s/iter; left time: 11.2808s
	iters: 400, epoch: 2 | loss: 0.4775620
	speed: 0.0036s/iter; left time: 10.8765s
Updating learning rate to 0.00018090652504572892
Validation loss decreased (0.6284 --> 0.6144).  Saving model state dict ...
Epoch: 2 cost time: 1.7845990657806396
Epoch: 2, Steps: 490 | Train Loss: 0.7661954 Vali Loss: 0.6144439 Best vali loss: 0.6144439
	iters: 100, epoch: 3 | loss: 0.7029622
	speed: 0.0095s/iter; left time: 27.1169s
	iters: 200, epoch: 3 | loss: 0.7202548
	speed: 0.0034s/iter; left time: 9.2915s
	iters: 300, epoch: 3 | loss: 0.7206205
	speed: 0.0034s/iter; left time: 8.9532s
	iters: 400, epoch: 3 | loss: 1.0672880
	speed: 0.0036s/iter; left time: 9.0974s
Updating learning rate to 0.00014652654288773245
Validation loss decreased (0.6144 --> 0.6084).  Saving model state dict ...
Epoch: 3 cost time: 1.7472198009490967
Epoch: 3, Steps: 490 | Train Loss: 0.8027814 Vali Loss: 0.6084016 Best vali loss: 0.6084016
	iters: 100, epoch: 4 | loss: 1.1185842
	speed: 0.0103s/iter; left time: 24.1004s
	iters: 200, epoch: 4 | loss: 0.9456892
	speed: 0.0036s/iter; left time: 8.0140s
	iters: 300, epoch: 4 | loss: 1.0499103
	speed: 0.0036s/iter; left time: 7.8178s
	iters: 400, epoch: 4 | loss: 0.7377942
	speed: 0.0036s/iter; left time: 7.4372s
Updating learning rate to 0.00010597258885
Validation loss decreased (0.6084 --> 0.6014).  Saving model state dict ...
Epoch: 4 cost time: 1.8215386867523193
Epoch: 4, Steps: 490 | Train Loss: 0.9629945 Vali Loss: 0.6014188 Best vali loss: 0.6014188
	iters: 100, epoch: 5 | loss: 0.7487172
	speed: 0.0100s/iter; left time: 18.6536s
	iters: 200, epoch: 5 | loss: 0.8793637
	speed: 0.0035s/iter; left time: 6.1428s
	iters: 300, epoch: 5 | loss: 0.8478020
	speed: 0.0034s/iter; left time: 5.7293s
	iters: 400, epoch: 5 | loss: 0.5799416
	speed: 0.0033s/iter; left time: 5.0894s
Updating learning rate to 6.541863481226756e-05
Epoch: 5 cost time: 1.7339003086090088
Epoch: 5, Steps: 490 | Train Loss: 0.7639561 Vali Loss: 0.6039776 Best vali loss: 0.6014188
	iters: 100, epoch: 6 | loss: 0.6824169
	speed: 0.0097s/iter; left time: 13.3588s
	iters: 200, epoch: 6 | loss: 0.5293825
	speed: 0.0034s/iter; left time: 4.3672s
	iters: 300, epoch: 6 | loss: 0.6815457
	speed: 0.0034s/iter; left time: 3.9935s
	iters: 400, epoch: 6 | loss: 1.2169679
	speed: 0.0034s/iter; left time: 3.5902s
Updating learning rate to 3.103865265427109e-05
Epoch: 6 cost time: 1.7148559093475342
Epoch: 6, Steps: 490 | Train Loss: 0.7775782 Vali Loss: 0.6072618 Best vali loss: 0.6014188
	iters: 100, epoch: 7 | loss: 0.9119763
	speed: 0.0101s/iter; left time: 8.8652s
	iters: 200, epoch: 7 | loss: 0.5365403
	speed: 0.0036s/iter; left time: 2.8180s
	iters: 300, epoch: 7 | loss: 0.9749936
	speed: 0.0034s/iter; left time: 2.3029s
	iters: 400, epoch: 7 | loss: 0.7194960
	speed: 0.0034s/iter; left time: 1.9876s
Updating learning rate to 8.066683004251203e-06
Epoch: 7 cost time: 1.7597222328186035
Epoch: 7, Steps: 490 | Train Loss: 0.7857516 Vali Loss: 0.6049226 Best vali loss: 0.6014188
	iters: 100, epoch: 8 | loss: 1.0134984
	speed: 0.0097s/iter; left time: 3.8004s
	iters: 200, epoch: 8 | loss: 0.8465905
	speed: 0.0036s/iter; left time: 1.0427s
	iters: 300, epoch: 8 | loss: 1.1216446
	speed: 0.0035s/iter; left time: 0.6655s
	iters: 400, epoch: 8 | loss: 0.6574450
	speed: 0.0036s/iter; left time: 0.3312s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7796828746795654
Epoch: 8, Steps: 490 | Train Loss: 0.9097946 Vali Loss: 0.6047477 Best vali loss: 0.6014188

best validation loss 0.601418814605058

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010335187698, 'e_layers': 2, 'learning_rate': 0.0001625336828, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3963808
	speed: 0.0109s/iter; left time: 84.3650s
	iters: 200, epoch: 1 | loss: 1.3686361
	speed: 0.0035s/iter; left time: 26.3620s
	iters: 300, epoch: 1 | loss: 0.8456883
	speed: 0.0033s/iter; left time: 24.9563s
	iters: 400, epoch: 1 | loss: 1.3913971
	speed: 0.0035s/iter; left time: 25.8813s
	iters: 500, epoch: 1 | loss: 0.9244559
	speed: 0.0036s/iter; left time: 26.1623s
	iters: 600, epoch: 1 | loss: 1.5175343
	speed: 0.0037s/iter; left time: 26.6242s
	iters: 700, epoch: 1 | loss: 0.8157327
	speed: 0.0037s/iter; left time: 26.5728s
	iters: 800, epoch: 1 | loss: 0.7420364
	speed: 0.0037s/iter; left time: 25.9887s
	iters: 900, epoch: 1 | loss: 0.9994079
	speed: 0.0036s/iter; left time: 24.9322s
Updating learning rate to 0.0001625336828
Validation loss decreased (inf --> 0.6130).  Saving model state dict ...
Epoch: 1 cost time: 4.0293097496032715
Epoch: 1, Steps: 979 | Train Loss: 1.0001411 Vali Loss: 0.6129726 Best vali loss: 0.6129726
	iters: 100, epoch: 2 | loss: 1.0046383
	speed: 0.0112s/iter; left time: 75.9275s
	iters: 200, epoch: 2 | loss: 0.3436959
	speed: 0.0031s/iter; left time: 20.3093s
	iters: 300, epoch: 2 | loss: 0.4324908
	speed: 0.0031s/iter; left time: 20.4004s
	iters: 400, epoch: 2 | loss: 1.4249992
	speed: 0.0031s/iter; left time: 19.8521s
	iters: 500, epoch: 2 | loss: 1.0021259
	speed: 0.0031s/iter; left time: 19.5458s
	iters: 600, epoch: 2 | loss: 1.3794177
	speed: 0.0031s/iter; left time: 19.0826s
	iters: 700, epoch: 2 | loss: 1.0356824
	speed: 0.0031s/iter; left time: 18.8364s
	iters: 800, epoch: 2 | loss: 0.2620190
	speed: 0.0031s/iter; left time: 18.5195s
	iters: 900, epoch: 2 | loss: 0.8712212
	speed: 0.0031s/iter; left time: 18.2863s
Updating learning rate to 8.12668414e-05
Epoch: 2 cost time: 3.0513663291931152
Epoch: 2, Steps: 979 | Train Loss: 0.8618101 Vali Loss: 0.6434252 Best vali loss: 0.6129726
	iters: 100, epoch: 3 | loss: 0.7057833
	speed: 0.0105s/iter; left time: 60.3666s
	iters: 200, epoch: 3 | loss: 0.6572288
	speed: 0.0031s/iter; left time: 17.5058s
	iters: 300, epoch: 3 | loss: 1.1176678
	speed: 0.0030s/iter; left time: 16.9133s
	iters: 400, epoch: 3 | loss: 1.0623587
	speed: 0.0032s/iter; left time: 17.4117s
	iters: 500, epoch: 3 | loss: 1.0681075
	speed: 0.0033s/iter; left time: 17.7808s
	iters: 600, epoch: 3 | loss: 0.4159367
	speed: 0.0033s/iter; left time: 17.2632s
	iters: 700, epoch: 3 | loss: 0.7216650
	speed: 0.0032s/iter; left time: 16.8034s
	iters: 800, epoch: 3 | loss: 1.6277276
	speed: 0.0031s/iter; left time: 15.7483s
	iters: 900, epoch: 3 | loss: 0.2733385
	speed: 0.0031s/iter; left time: 15.2516s
Updating learning rate to 4.06334207e-05
Validation loss decreased (0.6130 --> 0.5539).  Saving model state dict ...
Epoch: 3 cost time: 3.1293411254882812
Epoch: 3, Steps: 979 | Train Loss: 0.8499793 Vali Loss: 0.5539057 Best vali loss: 0.5539057
	iters: 100, epoch: 4 | loss: 0.9338227
	speed: 0.0113s/iter; left time: 53.9834s
	iters: 200, epoch: 4 | loss: 0.2138478
	speed: 0.0031s/iter; left time: 14.4818s
	iters: 300, epoch: 4 | loss: 0.8168831
	speed: 0.0031s/iter; left time: 14.1572s
	iters: 400, epoch: 4 | loss: 0.3085826
	speed: 0.0031s/iter; left time: 13.8791s
	iters: 500, epoch: 4 | loss: 0.4482237
	speed: 0.0031s/iter; left time: 13.5385s
	iters: 600, epoch: 4 | loss: 0.7191603
	speed: 0.0031s/iter; left time: 13.1803s
	iters: 700, epoch: 4 | loss: 1.1748905
	speed: 0.0031s/iter; left time: 12.9328s
	iters: 800, epoch: 4 | loss: 0.2695551
	speed: 0.0032s/iter; left time: 13.0141s
	iters: 900, epoch: 4 | loss: 0.9515656
	speed: 0.0032s/iter; left time: 12.5896s
Updating learning rate to 2.031671035e-05
Epoch: 4 cost time: 3.0996973514556885
Epoch: 4, Steps: 979 | Train Loss: 0.6485035 Vali Loss: 0.5547982 Best vali loss: 0.5539057
	iters: 100, epoch: 5 | loss: 0.8014215
	speed: 0.0106s/iter; left time: 40.4019s
	iters: 200, epoch: 5 | loss: 0.5882983
	speed: 0.0030s/iter; left time: 11.2491s
	iters: 300, epoch: 5 | loss: 0.9611274
	speed: 0.0031s/iter; left time: 11.0419s
	iters: 400, epoch: 5 | loss: 0.8699387
	speed: 0.0032s/iter; left time: 11.0802s
	iters: 500, epoch: 5 | loss: 0.3196132
	speed: 0.0030s/iter; left time: 10.2722s
	iters: 600, epoch: 5 | loss: 0.9848230
	speed: 0.0030s/iter; left time: 9.9205s
	iters: 700, epoch: 5 | loss: 0.6424110
	speed: 0.0030s/iter; left time: 9.5857s
	iters: 800, epoch: 5 | loss: 0.3950539
	speed: 0.0030s/iter; left time: 9.2102s
	iters: 900, epoch: 5 | loss: 0.4350432
	speed: 0.0029s/iter; left time: 8.8755s
Updating learning rate to 1.0158355175e-05
Validation loss decreased (0.5539 --> 0.5416).  Saving model state dict ...
Epoch: 5 cost time: 2.9892444610595703
Epoch: 5, Steps: 979 | Train Loss: 0.6664145 Vali Loss: 0.5416482 Best vali loss: 0.5416482
	iters: 100, epoch: 6 | loss: 1.1181645
	speed: 0.0104s/iter; left time: 29.4890s
	iters: 200, epoch: 6 | loss: 0.3756834
	speed: 0.0031s/iter; left time: 8.5765s
	iters: 300, epoch: 6 | loss: 1.0688156
	speed: 0.0031s/iter; left time: 8.1152s
	iters: 400, epoch: 6 | loss: 0.2858385
	speed: 0.0031s/iter; left time: 7.7706s
	iters: 500, epoch: 6 | loss: 0.4582851
	speed: 0.0030s/iter; left time: 7.4127s
	iters: 600, epoch: 6 | loss: 1.0098362
	speed: 0.0030s/iter; left time: 7.0181s
	iters: 700, epoch: 6 | loss: 1.0864066
	speed: 0.0030s/iter; left time: 6.7231s
	iters: 800, epoch: 6 | loss: 0.7385234
	speed: 0.0031s/iter; left time: 6.5280s
	iters: 900, epoch: 6 | loss: 0.4050087
	speed: 0.0031s/iter; left time: 6.2776s
Updating learning rate to 5.0791775875e-06
Epoch: 6 cost time: 3.0302553176879883
Epoch: 6, Steps: 979 | Train Loss: 0.7273958 Vali Loss: 0.5496528 Best vali loss: 0.5416482
	iters: 100, epoch: 7 | loss: 0.8039140
	speed: 0.0111s/iter; left time: 20.7160s
	iters: 200, epoch: 7 | loss: 0.7172524
	speed: 0.0033s/iter; left time: 5.8796s
	iters: 300, epoch: 7 | loss: 0.5303841
	speed: 0.0033s/iter; left time: 5.5511s
	iters: 400, epoch: 7 | loss: 0.9880821
	speed: 0.0034s/iter; left time: 5.2281s
	iters: 500, epoch: 7 | loss: 0.2624717
	speed: 0.0033s/iter; left time: 4.8679s
	iters: 600, epoch: 7 | loss: 0.4341456
	speed: 0.0034s/iter; left time: 4.6592s
	iters: 700, epoch: 7 | loss: 0.7161987
	speed: 0.0035s/iter; left time: 4.3625s
	iters: 800, epoch: 7 | loss: 0.7639691
	speed: 0.0033s/iter; left time: 3.8105s
	iters: 900, epoch: 7 | loss: 0.6653281
	speed: 0.0032s/iter; left time: 3.3637s
Updating learning rate to 2.53958879375e-06
Epoch: 7 cost time: 3.311660051345825
Epoch: 7, Steps: 979 | Train Loss: 0.6535273 Vali Loss: 0.5498178 Best vali loss: 0.5416482
	iters: 100, epoch: 8 | loss: 0.4912495
	speed: 0.0105s/iter; left time: 9.2487s
	iters: 200, epoch: 8 | loss: 0.5112392
	speed: 0.0031s/iter; left time: 2.3869s
	iters: 300, epoch: 8 | loss: 0.8766574
	speed: 0.0031s/iter; left time: 2.1003s
	iters: 400, epoch: 8 | loss: 0.2563521
	speed: 0.0030s/iter; left time: 1.7411s
	iters: 500, epoch: 8 | loss: 0.8041625
	speed: 0.0030s/iter; left time: 1.4494s
	iters: 600, epoch: 8 | loss: 1.0777090
	speed: 0.0030s/iter; left time: 1.1485s
	iters: 700, epoch: 8 | loss: 0.6158125
	speed: 0.0030s/iter; left time: 0.8451s
	iters: 800, epoch: 8 | loss: 0.9736716
	speed: 0.0030s/iter; left time: 0.5456s
	iters: 900, epoch: 8 | loss: 0.8851175
	speed: 0.0032s/iter; left time: 0.2540s
Updating learning rate to 1.269794396875e-06
Epoch: 8 cost time: 3.0483357906341553
Epoch: 8, Steps: 979 | Train Loss: 0.7213301 Vali Loss: 0.5499064 Best vali loss: 0.5416482

best validation loss 0.5416481876913898

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032080428094, 'e_layers': 3, 'learning_rate': 0.0001644478975, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6232767
	speed: 0.0139s/iter; left time: 12.2631s
Updating learning rate to 0.000158188972082382
Validation loss decreased (inf --> 0.5940).  Saving model state dict ...
Epoch: 1 cost time: 1.2902309894561768
Epoch: 1, Steps: 123 | Train Loss: 0.6232767 Vali Loss: 0.5940225 Best vali loss: 0.5940225
	iters: 100, epoch: 2 | loss: 0.7364076
	speed: 0.0123s/iter; left time: 9.3966s
Updating learning rate to 0.00014036506048706015
Validation loss decreased (0.5940 --> 0.5546).  Saving model state dict ...
Epoch: 2 cost time: 0.9906308650970459
Epoch: 2, Steps: 123 | Train Loss: 0.7364076 Vali Loss: 0.5546473 Best vali loss: 0.5546473
	iters: 100, epoch: 3 | loss: 0.6361017
	speed: 0.0125s/iter; left time: 7.9843s
Updating learning rate to 0.00011368969168026125
Validation loss decreased (0.5546 --> 0.5511).  Saving model state dict ...
Epoch: 3 cost time: 0.9988968372344971
Epoch: 3, Steps: 123 | Train Loss: 0.6361017 Vali Loss: 0.5510656 Best vali loss: 0.5510656

best validation loss 0.5510656131963275

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010625216564, 'e_layers': 3, 'learning_rate': 0.0001273348345, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8152720
	speed: 0.0110s/iter; left time: 41.9151s
	iters: 200, epoch: 1 | loss: 0.8687387
	speed: 0.0047s/iter; left time: 17.3942s
	iters: 300, epoch: 1 | loss: 0.8774704
	speed: 0.0045s/iter; left time: 16.1240s
	iters: 400, epoch: 1 | loss: 0.7746757
	speed: 0.0046s/iter; left time: 16.2360s
Updating learning rate to 0.0001273348345
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 2.629056930541992
Epoch: 1, Steps: 490 | Train Loss: 0.8340392 Vali Loss: 0.6100707 Best vali loss: 0.6100707
	iters: 100, epoch: 2 | loss: 0.7348759
	speed: 0.0128s/iter; left time: 42.5854s
	iters: 200, epoch: 2 | loss: 0.5709228
	speed: 0.0048s/iter; left time: 15.5071s
	iters: 300, epoch: 2 | loss: 1.4930041
	speed: 0.0048s/iter; left time: 14.9610s
	iters: 400, epoch: 2 | loss: 0.8035855
	speed: 0.0048s/iter; left time: 14.5055s
Updating learning rate to 6.366741725e-05
Validation loss decreased (0.6101 --> 0.5773).  Saving model state dict ...
Epoch: 2 cost time: 2.3386662006378174
Epoch: 2, Steps: 490 | Train Loss: 0.9005971 Vali Loss: 0.5773398 Best vali loss: 0.5773398
	iters: 100, epoch: 3 | loss: 0.9905601
	speed: 0.0133s/iter; left time: 37.6575s
	iters: 200, epoch: 3 | loss: 1.2218595
	speed: 0.0045s/iter; left time: 12.2879s
	iters: 300, epoch: 3 | loss: 0.8702315
	speed: 0.0046s/iter; left time: 12.1182s
	iters: 400, epoch: 3 | loss: 0.6676084
	speed: 0.0047s/iter; left time: 12.0512s
Updating learning rate to 3.1833708625e-05
Validation loss decreased (0.5773 --> 0.5552).  Saving model state dict ...
Epoch: 3 cost time: 2.3087611198425293
Epoch: 3, Steps: 490 | Train Loss: 0.9375649 Vali Loss: 0.5551631 Best vali loss: 0.5551631

best validation loss 0.5551631250270038

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010194602782, 'e_layers': 3, 'learning_rate': 7.81780597e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.520258447413774e-05
Validation loss decreased (inf --> 0.6324).  Saving model state dict ...
Epoch: 1 cost time: 0.7916991710662842
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6323919 Best vali loss: 0.6323919
Updating learning rate to 6.672914792693838e-05
Validation loss decreased (0.6324 --> 0.6102).  Saving model state dict ...
Epoch: 2 cost time: 0.4846305847167969
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6101931 Best vali loss: 0.6101931
Updating learning rate to 5.404775396081945e-05
Validation loss decreased (0.6102 --> 0.6047).  Saving model state dict ...
Epoch: 3 cost time: 0.4782540798187256
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6047387 Best vali loss: 0.6047387

best validation loss 0.6047387464296923

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032080428094, 'e_layers': 3, 'learning_rate': 0.0001644478975, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5418062
	speed: 0.0145s/iter; left time: 7.4843s
Updating learning rate to 8.222394875e-05
Epoch: 4 cost time: 1.3115875720977783
Epoch: 4, Steps: 123 | Train Loss: 0.5418062 Vali Loss: 0.5513360 Best vali loss: 0.5510656
	iters: 100, epoch: 5 | loss: 0.6448237
	speed: 0.0121s/iter; left time: 4.7475s
Updating learning rate to 5.075820581973877e-05
Validation loss decreased (0.5511 --> 0.5294).  Saving model state dict ...
Epoch: 5 cost time: 1.004652976989746
Epoch: 5, Steps: 123 | Train Loss: 0.6448237 Vali Loss: 0.5293570 Best vali loss: 0.5293570
	iters: 100, epoch: 6 | loss: 0.5842477
	speed: 0.0126s/iter; left time: 3.3887s
Updating learning rate to 2.408283701293986e-05
Validation loss decreased (0.5294 --> 0.5275).  Saving model state dict ...
Epoch: 6 cost time: 1.0004873275756836
Epoch: 6, Steps: 123 | Train Loss: 0.5842477 Vali Loss: 0.5274605 Best vali loss: 0.5274605
	iters: 100, epoch: 7 | loss: 0.8043662
	speed: 0.0126s/iter; left time: 1.8453s
Updating learning rate to 6.258925417618001e-06
Epoch: 7 cost time: 0.9978888034820557
Epoch: 7, Steps: 123 | Train Loss: 0.8043662 Vali Loss: 0.5275945 Best vali loss: 0.5274605
	iters: 100, epoch: 8 | loss: 0.6634195
	speed: 0.0120s/iter; left time: 0.2869s
Updating learning rate to 0.0
Validation loss decreased (0.5275 --> 0.5241).  Saving model state dict ...
Epoch: 8 cost time: 0.9907877445220947
Epoch: 8, Steps: 123 | Train Loss: 0.6634195 Vali Loss: 0.5240857 Best vali loss: 0.5240857

best validation loss 0.5240857186884529

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010256394408, 'e_layers': 3, 'learning_rate': 7.01570134e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7097276
	speed: 0.0103s/iter; left time: 39.4075s
	iters: 200, epoch: 1 | loss: 0.7614790
	speed: 0.0041s/iter; left time: 15.3757s
	iters: 300, epoch: 1 | loss: 0.7365947
	speed: 0.0040s/iter; left time: 14.5850s
	iters: 400, epoch: 1 | loss: 1.0832163
	speed: 0.0040s/iter; left time: 14.1005s
Updating learning rate to 7.01570134e-05
Validation loss decreased (inf --> 0.6115).  Saving model state dict ...
Epoch: 1 cost time: 2.3374857902526855
Epoch: 1, Steps: 490 | Train Loss: 0.8227544 Vali Loss: 0.6115248 Best vali loss: 0.6115248
	iters: 100, epoch: 2 | loss: 1.2350818
	speed: 0.0118s/iter; left time: 39.1835s
	iters: 200, epoch: 2 | loss: 0.9267471
	speed: 0.0042s/iter; left time: 13.4394s
	iters: 300, epoch: 2 | loss: 1.0907695
	speed: 0.0046s/iter; left time: 14.5560s
	iters: 400, epoch: 2 | loss: 0.4287069
	speed: 0.0047s/iter; left time: 14.2249s
Updating learning rate to 3.50785067e-05
Validation loss decreased (0.6115 --> 0.5560).  Saving model state dict ...
Epoch: 2 cost time: 2.220338821411133
Epoch: 2, Steps: 490 | Train Loss: 0.9203263 Vali Loss: 0.5560223 Best vali loss: 0.5560223
	iters: 100, epoch: 3 | loss: 1.0054913
	speed: 0.0125s/iter; left time: 35.5774s
	iters: 200, epoch: 3 | loss: 0.7265134
	speed: 0.0041s/iter; left time: 11.3739s
	iters: 300, epoch: 3 | loss: 0.7086197
	speed: 0.0042s/iter; left time: 11.0511s
	iters: 400, epoch: 3 | loss: 0.7633514
	speed: 0.0042s/iter; left time: 10.5500s
Updating learning rate to 1.753925335e-05
Epoch: 3 cost time: 2.1049976348876953
Epoch: 3, Steps: 490 | Train Loss: 0.8009939 Vali Loss: 0.5583582 Best vali loss: 0.5560223
	iters: 100, epoch: 4 | loss: 0.6418689
	speed: 0.0125s/iter; left time: 29.2862s
	iters: 200, epoch: 4 | loss: 1.1110092
	speed: 0.0042s/iter; left time: 9.5026s
	iters: 300, epoch: 4 | loss: 0.3964064
	speed: 0.0045s/iter; left time: 9.7188s
	iters: 400, epoch: 4 | loss: 0.5317299
	speed: 0.0047s/iter; left time: 9.6635s
Updating learning rate to 8.769626675e-06
Validation loss decreased (0.5560 --> 0.5541).  Saving model state dict ...
Epoch: 4 cost time: 2.2766082286834717
Epoch: 4, Steps: 490 | Train Loss: 0.6702536 Vali Loss: 0.5540727 Best vali loss: 0.5540727
	iters: 100, epoch: 5 | loss: 0.6157463
	speed: 0.0126s/iter; left time: 23.4879s
	iters: 200, epoch: 5 | loss: 0.5943181
	speed: 0.0041s/iter; left time: 7.2299s
	iters: 300, epoch: 5 | loss: 0.8147965
	speed: 0.0042s/iter; left time: 6.9214s
	iters: 400, epoch: 5 | loss: 0.6989719
	speed: 0.0042s/iter; left time: 6.5491s
Updating learning rate to 4.3848133375e-06
Validation loss decreased (0.5541 --> 0.5486).  Saving model state dict ...
Epoch: 5 cost time: 2.0849437713623047
Epoch: 5, Steps: 490 | Train Loss: 0.6809582 Vali Loss: 0.5485964 Best vali loss: 0.5485964
	iters: 100, epoch: 6 | loss: 0.7220347
	speed: 0.0119s/iter; left time: 16.2543s
	iters: 200, epoch: 6 | loss: 0.7525421
	speed: 0.0041s/iter; left time: 5.1641s
	iters: 300, epoch: 6 | loss: 0.5537806
	speed: 0.0041s/iter; left time: 4.8368s
	iters: 400, epoch: 6 | loss: 0.7819705
	speed: 0.0043s/iter; left time: 4.5614s
Updating learning rate to 2.19240666875e-06
Epoch: 6 cost time: 2.076624870300293
Epoch: 6, Steps: 490 | Train Loss: 0.7025820 Vali Loss: 0.5495278 Best vali loss: 0.5485964
	iters: 100, epoch: 7 | loss: 0.6798886
	speed: 0.0115s/iter; left time: 10.1081s
	iters: 200, epoch: 7 | loss: 0.9286520
	speed: 0.0043s/iter; left time: 3.3319s
	iters: 300, epoch: 7 | loss: 0.4460320
	speed: 0.0042s/iter; left time: 2.8687s
	iters: 400, epoch: 7 | loss: 0.9718366
	speed: 0.0046s/iter; left time: 2.6669s
Updating learning rate to 1.096203334375e-06
Epoch: 7 cost time: 2.1863746643066406
Epoch: 7, Steps: 490 | Train Loss: 0.7566023 Vali Loss: 0.5486839 Best vali loss: 0.5485964
	iters: 100, epoch: 8 | loss: 0.3861889
	speed: 0.0126s/iter; left time: 4.9312s
	iters: 200, epoch: 8 | loss: 0.7693390
	speed: 0.0046s/iter; left time: 1.3531s
	iters: 300, epoch: 8 | loss: 1.1531518
	speed: 0.0046s/iter; left time: 0.8748s
	iters: 400, epoch: 8 | loss: 0.8414514
	speed: 0.0047s/iter; left time: 0.4266s
Updating learning rate to 5.481016671875e-07
Epoch: 8 cost time: 2.309461832046509
Epoch: 8, Steps: 490 | Train Loss: 0.7875328 Vali Loss: 0.5492296 Best vali loss: 0.5485964

best validation loss 0.5485964387669049

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0029510196531, 'e_layers': 2, 'learning_rate': 0.0009003752385, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6378044
	speed: 0.0100s/iter; left time: 18.6491s
	iters: 200, epoch: 1 | loss: 0.8077723
	speed: 0.0037s/iter; left time: 6.4809s
Updating learning rate to 0.0009003752385
Validation loss decreased (inf --> 0.6114).  Saving model state dict ...
Epoch: 1 cost time: 1.2657971382141113
Epoch: 1, Steps: 245 | Train Loss: 0.7227884 Vali Loss: 0.6114087 Best vali loss: 0.6114087
	iters: 100, epoch: 2 | loss: 1.1930459
	speed: 0.0081s/iter; left time: 13.0698s
	iters: 200, epoch: 2 | loss: 0.9458575
	speed: 0.0040s/iter; left time: 6.0704s
Updating learning rate to 0.00045018761925
Validation loss decreased (0.6114 --> 0.6083).  Saving model state dict ...
Epoch: 2 cost time: 1.0292835235595703
Epoch: 2, Steps: 245 | Train Loss: 1.0694517 Vali Loss: 0.6083187 Best vali loss: 0.6083187
	iters: 100, epoch: 3 | loss: 0.7588771
	speed: 0.0079s/iter; left time: 10.8866s
	iters: 200, epoch: 3 | loss: 0.9394460
	speed: 0.0038s/iter; left time: 4.8403s
Updating learning rate to 0.000225093809625
Validation loss decreased (0.6083 --> 0.6033).  Saving model state dict ...
Epoch: 3 cost time: 0.9635496139526367
Epoch: 3, Steps: 245 | Train Loss: 0.8491615 Vali Loss: 0.6033464 Best vali loss: 0.6033464
	iters: 100, epoch: 4 | loss: 0.7573337
	speed: 0.0080s/iter; left time: 8.9721s
	iters: 200, epoch: 4 | loss: 0.6669295
	speed: 0.0036s/iter; left time: 3.6998s
Updating learning rate to 0.0001125469048125
Epoch: 4 cost time: 0.942451000213623
Epoch: 4, Steps: 245 | Train Loss: 0.7121316 Vali Loss: 0.6294135 Best vali loss: 0.6033464
	iters: 100, epoch: 5 | loss: 0.5539579
	speed: 0.0080s/iter; left time: 7.0575s
	iters: 200, epoch: 5 | loss: 0.6012295
	speed: 0.0038s/iter; left time: 2.9347s
Updating learning rate to 5.627345240625e-05
Epoch: 5 cost time: 0.9703428745269775
Epoch: 5, Steps: 245 | Train Loss: 0.5775937 Vali Loss: 0.6455989 Best vali loss: 0.6033464
	iters: 100, epoch: 6 | loss: 1.0202506
	speed: 0.0078s/iter; left time: 4.9674s
	iters: 200, epoch: 6 | loss: 0.9770494
	speed: 0.0037s/iter; left time: 1.9813s
Updating learning rate to 2.8136726203125e-05
Epoch: 6 cost time: 0.9507150650024414
Epoch: 6, Steps: 245 | Train Loss: 0.9986500 Vali Loss: 0.6461466 Best vali loss: 0.6033464
	iters: 100, epoch: 7 | loss: 0.7784154
	speed: 0.0079s/iter; left time: 3.0862s
	iters: 200, epoch: 7 | loss: 0.7879880
	speed: 0.0038s/iter; left time: 1.0933s
Updating learning rate to 1.40683631015625e-05
Epoch: 7 cost time: 0.9615516662597656
Epoch: 7, Steps: 245 | Train Loss: 0.7832017 Vali Loss: 0.6431999 Best vali loss: 0.6033464
	iters: 100, epoch: 8 | loss: 0.6366411
	speed: 0.0078s/iter; left time: 1.1409s
	iters: 200, epoch: 8 | loss: 0.6176143
	speed: 0.0039s/iter; left time: 0.1797s
Updating learning rate to 7.03418155078125e-06
Epoch: 8 cost time: 0.9823787212371826
Epoch: 8, Steps: 245 | Train Loss: 0.6271277 Vali Loss: 0.6401021 Best vali loss: 0.6033464

best validation loss 0.6033464111646311

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758291257, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616850
	speed: 0.0117s/iter; left time: 10.3913s
Updating learning rate to 0.00016913702807679214
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0363993644714355
Epoch: 1, Steps: 123 | Train Loss: 0.7616850 Vali Loss: 0.6075495 Best vali loss: 0.6075495
	iters: 100, epoch: 2 | loss: 0.9367071
	speed: 0.0092s/iter; left time: 7.0182s
Updating learning rate to 0.00015007954640628592
Validation loss decreased (0.6075 --> 0.5712).  Saving model state dict ...
Epoch: 2 cost time: 0.716376543045044
Epoch: 2, Steps: 123 | Train Loss: 0.9367071 Vali Loss: 0.5712394 Best vali loss: 0.5712394
	iters: 100, epoch: 3 | loss: 0.8576982
	speed: 0.0094s/iter; left time: 5.9915s
Updating learning rate to 0.00012155800951631442
Validation loss decreased (0.5712 --> 0.5465).  Saving model state dict ...
Epoch: 3 cost time: 0.716543436050415
Epoch: 3, Steps: 123 | Train Loss: 0.8576982 Vali Loss: 0.5464744 Best vali loss: 0.5464744

best validation loss 0.5464743568300373

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020872364785, 'e_layers': 3, 'learning_rate': 8.49808417e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6225184
	speed: 0.0140s/iter; left time: 12.3634s
Updating learning rate to 8.49808417e-05
Validation loss decreased (inf --> 0.5992).  Saving model state dict ...
Epoch: 1 cost time: 1.3030648231506348
Epoch: 1, Steps: 123 | Train Loss: 0.6225184 Vali Loss: 0.5992253 Best vali loss: 0.5992253
	iters: 100, epoch: 2 | loss: 0.7393271
	speed: 0.0123s/iter; left time: 9.3596s
Updating learning rate to 4.249042085e-05
Validation loss decreased (0.5992 --> 0.5671).  Saving model state dict ...
Epoch: 2 cost time: 0.9982168674468994
Epoch: 2, Steps: 123 | Train Loss: 0.7393271 Vali Loss: 0.5671384 Best vali loss: 0.5671384
	iters: 100, epoch: 3 | loss: 0.6473163
	speed: 0.0125s/iter; left time: 7.9930s
Updating learning rate to 2.1245210425e-05
Validation loss decreased (0.5671 --> 0.5472).  Saving model state dict ...
Epoch: 3 cost time: 0.9945032596588135
Epoch: 3, Steps: 123 | Train Loss: 0.6473163 Vali Loss: 0.5471981 Best vali loss: 0.5471981

best validation loss 0.5471980624980035

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0078739869482, 'e_layers': 3, 'learning_rate': 8.56634843e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6224222
	speed: 0.0139s/iter; left time: 12.3143s
Updating learning rate to 8.56634843e-05
Validation loss decreased (inf --> 0.5991).  Saving model state dict ...
Epoch: 1 cost time: 1.3055052757263184
Epoch: 1, Steps: 123 | Train Loss: 0.6224222 Vali Loss: 0.5991082 Best vali loss: 0.5991082
	iters: 100, epoch: 2 | loss: 0.7395263
	speed: 0.0124s/iter; left time: 9.4422s
Updating learning rate to 4.283174215e-05
Validation loss decreased (0.5991 --> 0.5688).  Saving model state dict ...
Epoch: 2 cost time: 0.996671199798584
Epoch: 2, Steps: 123 | Train Loss: 0.7395263 Vali Loss: 0.5688135 Best vali loss: 0.5688135
	iters: 100, epoch: 3 | loss: 0.6468377
	speed: 0.0126s/iter; left time: 8.0513s
Updating learning rate to 2.1415871075e-05
Validation loss decreased (0.5688 --> 0.5458).  Saving model state dict ...
Epoch: 3 cost time: 0.9984242916107178
Epoch: 3, Steps: 123 | Train Loss: 0.6468377 Vali Loss: 0.5457564 Best vali loss: 0.5457564

best validation loss 0.5457563860887512

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0078739869482, 'e_layers': 3, 'learning_rate': 8.56634843e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5511492
	speed: 0.0145s/iter; left time: 7.4929s
Updating learning rate to 1.07079355375e-05
Validation loss decreased (0.5458 --> 0.5454).  Saving model state dict ...
Epoch: 4 cost time: 1.30704665184021
Epoch: 4, Steps: 123 | Train Loss: 0.5511492 Vali Loss: 0.5453841 Best vali loss: 0.5453841
	iters: 100, epoch: 5 | loss: 0.6721002
	speed: 0.0126s/iter; left time: 4.9356s
Updating learning rate to 5.35396776875e-06
Validation loss decreased (0.5454 --> 0.5405).  Saving model state dict ...
Epoch: 5 cost time: 1.0007741451263428
Epoch: 5, Steps: 123 | Train Loss: 0.6721002 Vali Loss: 0.5405048 Best vali loss: 0.5405048
	iters: 100, epoch: 6 | loss: 0.6162181
	speed: 0.0125s/iter; left time: 3.3808s
Updating learning rate to 2.676983884375e-06
Validation loss decreased (0.5405 --> 0.5394).  Saving model state dict ...
Epoch: 6 cost time: 0.9980547428131104
Epoch: 6, Steps: 123 | Train Loss: 0.6162181 Vali Loss: 0.5393911 Best vali loss: 0.5393911
	iters: 100, epoch: 7 | loss: 0.8723322
	speed: 0.0126s/iter; left time: 1.8463s
Updating learning rate to 1.3384919421875e-06
Validation loss decreased (0.5394 --> 0.5388).  Saving model state dict ...
Epoch: 7 cost time: 0.9997196197509766
Epoch: 7, Steps: 123 | Train Loss: 0.8723322 Vali Loss: 0.5387793 Best vali loss: 0.5387793
	iters: 100, epoch: 8 | loss: 0.7232940
	speed: 0.0124s/iter; left time: 0.2976s
Updating learning rate to 6.6924597109375e-07
Validation loss decreased (0.5388 --> 0.5387).  Saving model state dict ...
Epoch: 8 cost time: 0.9912447929382324
Epoch: 8, Steps: 123 | Train Loss: 0.7232940 Vali Loss: 0.5387029 Best vali loss: 0.5387029

best validation loss 0.5387028909733537

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0055388826388, 'e_layers': 3, 'learning_rate': 0.0004712861179, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8547916
	speed: 0.0118s/iter; left time: 21.9786s
	iters: 200, epoch: 1 | loss: 0.7801365
	speed: 0.0056s/iter; left time: 9.8927s
Updating learning rate to 0.0004533488580922556
Validation loss decreased (inf --> 0.6523).  Saving model state dict ...
Epoch: 1 cost time: 1.7229492664337158
Epoch: 1, Steps: 245 | Train Loss: 0.8174640 Vali Loss: 0.6523287 Best vali loss: 0.6523287
	iters: 100, epoch: 2 | loss: 0.8057153
	speed: 0.0116s/iter; left time: 18.6855s
	iters: 200, epoch: 2 | loss: 1.1185548
	speed: 0.0057s/iter; left time: 8.6548s
Updating learning rate to 0.00040226786387308634
Validation loss decreased (0.6523 --> 0.6420).  Saving model state dict ...
Epoch: 2 cost time: 1.4372196197509766
Epoch: 2, Steps: 245 | Train Loss: 0.9621351 Vali Loss: 0.6420311 Best vali loss: 0.6420311
	iters: 100, epoch: 3 | loss: 0.5846849
	speed: 0.0117s/iter; left time: 16.0491s
	iters: 200, epoch: 3 | loss: 0.8367303
	speed: 0.0056s/iter; left time: 7.1080s
Updating learning rate to 0.0003258197535619952
Validation loss decreased (0.6420 --> 0.6218).  Saving model state dict ...
Epoch: 3 cost time: 1.4261009693145752
Epoch: 3, Steps: 245 | Train Loss: 0.7107076 Vali Loss: 0.6218316 Best vali loss: 0.6218316
	iters: 100, epoch: 4 | loss: 0.8613749
	speed: 0.0116s/iter; left time: 13.0397s
	iters: 200, epoch: 4 | loss: 0.8244207
	speed: 0.0056s/iter; left time: 5.7662s
Updating learning rate to 0.00023564305895
Validation loss decreased (0.6218 --> 0.6188).  Saving model state dict ...
Epoch: 4 cost time: 1.420684814453125
Epoch: 4, Steps: 245 | Train Loss: 0.8428978 Vali Loss: 0.6187872 Best vali loss: 0.6187872
	iters: 100, epoch: 5 | loss: 0.7282398
	speed: 0.0118s/iter; left time: 10.3589s
	iters: 200, epoch: 5 | loss: 0.7497864
	speed: 0.0056s/iter; left time: 4.3827s
Updating learning rate to 0.00014546636433800483
Validation loss decreased (0.6188 --> 0.6154).  Saving model state dict ...
Epoch: 5 cost time: 1.432312250137329
Epoch: 5, Steps: 245 | Train Loss: 0.7390131 Vali Loss: 0.6154416 Best vali loss: 0.6154416
	iters: 100, epoch: 6 | loss: 0.6737831
	speed: 0.0116s/iter; left time: 7.3486s
	iters: 200, epoch: 6 | loss: 0.7493339
	speed: 0.0056s/iter; left time: 2.9958s
Updating learning rate to 6.901825402691365e-05
Epoch: 6 cost time: 1.4128074645996094
Epoch: 6, Steps: 245 | Train Loss: 0.7115585 Vali Loss: 0.6198479 Best vali loss: 0.6154416
	iters: 100, epoch: 7 | loss: 0.8456645
	speed: 0.0111s/iter; left time: 4.3566s
	iters: 200, epoch: 7 | loss: 0.9078276
	speed: 0.0057s/iter; left time: 1.6492s
Updating learning rate to 1.7937259807744418e-05
Epoch: 7 cost time: 1.4259693622589111
Epoch: 7, Steps: 245 | Train Loss: 0.8767461 Vali Loss: 0.6260662 Best vali loss: 0.6154416
	iters: 100, epoch: 8 | loss: 0.8175845
	speed: 0.0112s/iter; left time: 1.6418s
	iters: 200, epoch: 8 | loss: 0.7730752
	speed: 0.0057s/iter; left time: 0.2635s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.445986270904541
Epoch: 8, Steps: 245 | Train Loss: 0.7953298 Vali Loss: 0.6319169 Best vali loss: 0.6154416

best validation loss 0.6154416383884947

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0014792085315, 'e_layers': 3, 'learning_rate': 0.0004717588789, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8627151
	speed: 0.0116s/iter; left time: 21.6595s
	iters: 200, epoch: 1 | loss: 0.7201228
	speed: 0.0057s/iter; left time: 9.9771s
Updating learning rate to 0.00045380362569809036
Validation loss decreased (inf --> 0.6250).  Saving model state dict ...
Epoch: 1 cost time: 1.7257258892059326
Epoch: 1, Steps: 245 | Train Loss: 0.7914189 Vali Loss: 0.6249808 Best vali loss: 0.6249808
	iters: 100, epoch: 2 | loss: 0.9057878
	speed: 0.0115s/iter; left time: 18.6594s
	iters: 200, epoch: 2 | loss: 1.1060438
	speed: 0.0057s/iter; left time: 8.5870s
Updating learning rate to 0.0004026713906275766
Validation loss decreased (0.6250 --> 0.6230).  Saving model state dict ...
Epoch: 2 cost time: 1.430511474609375
Epoch: 2, Steps: 245 | Train Loss: 1.0059158 Vali Loss: 0.6230231 Best vali loss: 0.6230231
	iters: 100, epoch: 3 | loss: 0.5950984
	speed: 0.0117s/iter; left time: 16.0850s
	iters: 200, epoch: 3 | loss: 0.8317730
	speed: 0.0056s/iter; left time: 7.1361s
Updating learning rate to 0.0003261465929630794
Validation loss decreased (0.6230 --> 0.6174).  Saving model state dict ...
Epoch: 3 cost time: 1.4308102130889893
Epoch: 3, Steps: 245 | Train Loss: 0.7134357 Vali Loss: 0.6174291 Best vali loss: 0.6174291
	iters: 100, epoch: 4 | loss: 0.8558701
	speed: 0.0118s/iter; left time: 13.3003s
	iters: 200, epoch: 4 | loss: 0.7975164
	speed: 0.0056s/iter; left time: 5.7768s
Updating learning rate to 0.00023587943945
Epoch: 4 cost time: 1.4348013401031494
Epoch: 4, Steps: 245 | Train Loss: 0.8266932 Vali Loss: 0.6375789 Best vali loss: 0.6174291
	iters: 100, epoch: 5 | loss: 0.7537065
	speed: 0.0112s/iter; left time: 9.8336s
	iters: 200, epoch: 5 | loss: 0.7351136
	speed: 0.0056s/iter; left time: 4.4105s
Updating learning rate to 0.00014561228593692064
Epoch: 5 cost time: 1.4317295551300049
Epoch: 5, Steps: 245 | Train Loss: 0.7444100 Vali Loss: 0.6227683 Best vali loss: 0.6174291
	iters: 100, epoch: 6 | loss: 0.5887393
	speed: 0.0112s/iter; left time: 7.1172s
	iters: 200, epoch: 6 | loss: 0.6602304
	speed: 0.0056s/iter; left time: 3.0148s
Updating learning rate to 6.908748827242337e-05
Epoch: 6 cost time: 1.423760175704956
Epoch: 6, Steps: 245 | Train Loss: 0.6244848 Vali Loss: 0.6287291 Best vali loss: 0.6174291
	iters: 100, epoch: 7 | loss: 0.7884475
	speed: 0.0114s/iter; left time: 4.4394s
	iters: 200, epoch: 7 | loss: 0.8691346
	speed: 0.0056s/iter; left time: 1.6417s
Updating learning rate to 1.7955253201909634e-05
Epoch: 7 cost time: 1.4381868839263916
Epoch: 7, Steps: 245 | Train Loss: 0.8287911 Vali Loss: 0.6453982 Best vali loss: 0.6174291
	iters: 100, epoch: 8 | loss: 0.8089745
	speed: 0.0111s/iter; left time: 1.6223s
	iters: 200, epoch: 8 | loss: 0.7087265
	speed: 0.0056s/iter; left time: 0.2592s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.418729543685913
Epoch: 8, Steps: 245 | Train Loss: 0.7588505 Vali Loss: 0.6417799 Best vali loss: 0.6174291

best validation loss 0.6174291140058977

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010405077472, 'e_layers': 3, 'learning_rate': 0.0003171115731, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4623429
	speed: 0.0101s/iter; left time: 78.4546s
	iters: 200, epoch: 1 | loss: 0.4971553
	speed: 0.0041s/iter; left time: 31.5142s
	iters: 300, epoch: 1 | loss: 1.1796309
	speed: 0.0041s/iter; left time: 30.7266s
	iters: 400, epoch: 1 | loss: 1.2129551
	speed: 0.0042s/iter; left time: 31.1938s
	iters: 500, epoch: 1 | loss: 0.7122729
	speed: 0.0043s/iter; left time: 31.8479s
	iters: 600, epoch: 1 | loss: 0.4747834
	speed: 0.0042s/iter; left time: 30.1014s
	iters: 700, epoch: 1 | loss: 0.9446803
	speed: 0.0040s/iter; left time: 28.4278s
	iters: 800, epoch: 1 | loss: 0.3664495
	speed: 0.0038s/iter; left time: 27.0086s
	iters: 900, epoch: 1 | loss: 1.2158864
	speed: 0.0037s/iter; left time: 25.5411s
Updating learning rate to 0.0003171115731
Validation loss decreased (inf --> 0.5935).  Saving model state dict ...
Epoch: 1 cost time: 4.300690412521362
Epoch: 1, Steps: 979 | Train Loss: 0.8962396 Vali Loss: 0.5935330 Best vali loss: 0.5935330
	iters: 100, epoch: 2 | loss: 1.6461825
	speed: 0.0123s/iter; left time: 83.0460s
	iters: 200, epoch: 2 | loss: 1.3886629
	speed: 0.0038s/iter; left time: 25.4553s
	iters: 300, epoch: 2 | loss: 0.3794320
	speed: 0.0040s/iter; left time: 25.9134s
	iters: 400, epoch: 2 | loss: 0.5845088
	speed: 0.0038s/iter; left time: 24.6706s
	iters: 500, epoch: 2 | loss: 0.4423015
	speed: 0.0038s/iter; left time: 24.1324s
	iters: 600, epoch: 2 | loss: 0.7855292
	speed: 0.0039s/iter; left time: 24.4564s
	iters: 700, epoch: 2 | loss: 0.3374075
	speed: 0.0039s/iter; left time: 23.7089s
	iters: 800, epoch: 2 | loss: 0.5295213
	speed: 0.0039s/iter; left time: 23.7593s
	iters: 900, epoch: 2 | loss: 0.7458224
	speed: 0.0040s/iter; left time: 23.6305s
Updating learning rate to 0.00015855578655
Validation loss decreased (0.5935 --> 0.5821).  Saving model state dict ...
Epoch: 2 cost time: 3.831341028213501
Epoch: 2, Steps: 979 | Train Loss: 0.7599298 Vali Loss: 0.5821067 Best vali loss: 0.5821067
	iters: 100, epoch: 3 | loss: 1.4447196
	speed: 0.0131s/iter; left time: 75.8646s
	iters: 200, epoch: 3 | loss: 0.6820565
	speed: 0.0044s/iter; left time: 24.7155s
	iters: 300, epoch: 3 | loss: 0.8884348
	speed: 0.0043s/iter; left time: 23.9019s
	iters: 400, epoch: 3 | loss: 1.0825658
	speed: 0.0043s/iter; left time: 23.3494s
	iters: 500, epoch: 3 | loss: 1.1452270
	speed: 0.0042s/iter; left time: 22.4357s
	iters: 600, epoch: 3 | loss: 0.7617909
	speed: 0.0040s/iter; left time: 21.1522s
	iters: 700, epoch: 3 | loss: 0.2984235
	speed: 0.0040s/iter; left time: 20.4662s
	iters: 800, epoch: 3 | loss: 0.9532613
	speed: 0.0038s/iter; left time: 19.1972s
	iters: 900, epoch: 3 | loss: 1.0110308
	speed: 0.0038s/iter; left time: 18.8155s
Updating learning rate to 7.9277893275e-05
Epoch: 3 cost time: 4.033472299575806
Epoch: 3, Steps: 979 | Train Loss: 0.9186122 Vali Loss: 0.5832344 Best vali loss: 0.5821067

best validation loss 0.5821066642458491

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0098427794814, 'e_layers': 3, 'learning_rate': 0.0002989798042, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8955361
	speed: 0.0116s/iter; left time: 21.5620s
	iters: 200, epoch: 1 | loss: 0.7194628
	speed: 0.0056s/iter; left time: 9.8543s
Updating learning rate to 0.000287600562967306
Validation loss decreased (inf --> 0.6109).  Saving model state dict ...
Epoch: 1 cost time: 1.7213077545166016
Epoch: 1, Steps: 245 | Train Loss: 0.8074995 Vali Loss: 0.6109193 Best vali loss: 0.6109193
	iters: 100, epoch: 2 | loss: 0.8629646
	speed: 0.0116s/iter; left time: 18.7731s
	iters: 200, epoch: 2 | loss: 1.0272868
	speed: 0.0057s/iter; left time: 8.5882s
Updating learning rate to 0.0002551952255938231
Epoch: 2 cost time: 1.431997537612915
Epoch: 2, Steps: 245 | Train Loss: 0.9451257 Vali Loss: 0.6645028 Best vali loss: 0.6109193
	iters: 100, epoch: 3 | loss: 0.5130449
	speed: 0.0111s/iter; left time: 15.2135s
	iters: 200, epoch: 3 | loss: 0.8347177
	speed: 0.0056s/iter; left time: 7.1132s
Updating learning rate to 0.00020669721093954924
Validation loss decreased (0.6109 --> 0.5741).  Saving model state dict ...
Epoch: 3 cost time: 1.4245274066925049
Epoch: 3, Steps: 245 | Train Loss: 0.6738813 Vali Loss: 0.5740904 Best vali loss: 0.5740904

best validation loss 0.5740903817851585

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0078413757149, 'e_layers': 4, 'learning_rate': 0.0019448937028, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7839040
	speed: 0.0138s/iter; left time: 12.1853s
Updating learning rate to 0.0018708705938635046
Validation loss decreased (inf --> 0.6259).  Saving model state dict ...
Epoch: 1 cost time: 1.276594877243042
Epoch: 1, Steps: 123 | Train Loss: 0.7839040 Vali Loss: 0.6258781 Best vali loss: 0.6258781
	iters: 100, epoch: 2 | loss: 0.8240494
	speed: 0.0097s/iter; left time: 7.3587s
Updating learning rate to 0.0016600706143684468
Validation loss decreased (0.6259 --> 0.6244).  Saving model state dict ...
Epoch: 2 cost time: 0.7849159240722656
Epoch: 2, Steps: 123 | Train Loss: 0.8240494 Vali Loss: 0.6243543 Best vali loss: 0.6243543
	iters: 100, epoch: 3 | loss: 0.8900586
	speed: 0.0096s/iter; left time: 6.1058s
Updating learning rate to 0.0013445861502863765
Epoch: 3 cost time: 0.7787322998046875
Epoch: 3, Steps: 123 | Train Loss: 0.8900586 Vali Loss: 0.6524250 Best vali loss: 0.6243543

best validation loss 0.6243542757149043

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0098427794814, 'e_layers': 3, 'learning_rate': 0.0002989798042, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7330893
	speed: 0.0128s/iter; left time: 14.4303s
	iters: 200, epoch: 4 | loss: 0.6440486
	speed: 0.0057s/iter; left time: 5.8524s
Updating learning rate to 0.0001494899021
Validation loss decreased (0.5741 --> 0.5457).  Saving model state dict ...
Epoch: 4 cost time: 1.7265348434448242
Epoch: 4, Steps: 245 | Train Loss: 0.6885690 Vali Loss: 0.5457070 Best vali loss: 0.5457070
	iters: 100, epoch: 5 | loss: 0.7223725
	speed: 0.0117s/iter; left time: 10.3288s
	iters: 200, epoch: 5 | loss: 0.9212465
	speed: 0.0056s/iter; left time: 4.3762s
Updating learning rate to 9.228259326045077e-05
Epoch: 5 cost time: 1.4275083541870117
Epoch: 5, Steps: 245 | Train Loss: 0.8218095 Vali Loss: 0.5804855 Best vali loss: 0.5457070
	iters: 100, epoch: 6 | loss: 0.4271716
	speed: 0.0113s/iter; left time: 7.1629s
	iters: 200, epoch: 6 | loss: 0.7055798
	speed: 0.0057s/iter; left time: 3.0531s
Updating learning rate to 4.37845786061769e-05
Epoch: 6 cost time: 1.439161777496338
Epoch: 6, Steps: 245 | Train Loss: 0.5663757 Vali Loss: 0.5863769 Best vali loss: 0.5457070
	iters: 100, epoch: 7 | loss: 0.6715524
	speed: 0.0113s/iter; left time: 4.4312s
	iters: 200, epoch: 7 | loss: 0.6412451
	speed: 0.0057s/iter; left time: 1.6575s
Updating learning rate to 1.1379241232693977e-05
Epoch: 7 cost time: 1.4419264793395996
Epoch: 7, Steps: 245 | Train Loss: 0.6563987 Vali Loss: 0.6064312 Best vali loss: 0.5457070
	iters: 100, epoch: 8 | loss: 0.5354884
	speed: 0.0114s/iter; left time: 1.6691s
	iters: 200, epoch: 8 | loss: 0.5593387
	speed: 0.0057s/iter; left time: 0.2616s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4521658420562744
Epoch: 8, Steps: 245 | Train Loss: 0.5474136 Vali Loss: 0.6040600 Best vali loss: 0.5457070

best validation loss 0.5457069823334803

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021452492799, 'e_layers': 3, 'learning_rate': 5.05475812e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6269315
	speed: 0.0139s/iter; left time: 12.3423s
Updating learning rate to 4.862372844431616e-05
Validation loss decreased (inf --> 0.6059).  Saving model state dict ...
Epoch: 1 cost time: 1.3005304336547852
Epoch: 1, Steps: 123 | Train Loss: 0.6269315 Vali Loss: 0.6059434 Best vali loss: 0.6059434
	iters: 100, epoch: 2 | loss: 0.7435175
	speed: 0.0123s/iter; left time: 9.3950s
Updating learning rate to 4.314505931954882e-05
Validation loss decreased (0.6059 --> 0.6034).  Saving model state dict ...
Epoch: 2 cost time: 0.9979264736175537
Epoch: 2, Steps: 123 | Train Loss: 0.7435175 Vali Loss: 0.6033626 Best vali loss: 0.6033626
	iters: 100, epoch: 3 | loss: 0.6637063
	speed: 0.0125s/iter; left time: 7.9778s
Updating learning rate to 3.4945651535684547e-05
Validation loss decreased (0.6034 --> 0.5947).  Saving model state dict ...
Epoch: 3 cost time: 0.9926114082336426
Epoch: 3, Steps: 123 | Train Loss: 0.6637063 Vali Loss: 0.5947123 Best vali loss: 0.5947123
	iters: 100, epoch: 4 | loss: 0.8971186
	speed: 0.0124s/iter; left time: 6.3734s
Updating learning rate to 2.52737906e-05
Validation loss decreased (0.5947 --> 0.5463).  Saving model state dict ...
Epoch: 4 cost time: 0.996131181716919
Epoch: 4, Steps: 123 | Train Loss: 0.8971186 Vali Loss: 0.5462776 Best vali loss: 0.5462776
	iters: 100, epoch: 5 | loss: 0.7377621
	speed: 0.0123s/iter; left time: 4.8492s
Updating learning rate to 1.560192966431546e-05
Validation loss decreased (0.5463 --> 0.5449).  Saving model state dict ...
Epoch: 5 cost time: 0.992682695388794
Epoch: 5, Steps: 123 | Train Loss: 0.7377621 Vali Loss: 0.5449200 Best vali loss: 0.5449200
	iters: 100, epoch: 6 | loss: 0.4945006
	speed: 0.0123s/iter; left time: 3.3261s
Updating learning rate to 7.40252188045118e-06
Epoch: 6 cost time: 0.9923038482666016
Epoch: 6, Steps: 123 | Train Loss: 0.4945006 Vali Loss: 0.5537799 Best vali loss: 0.5449200
	iters: 100, epoch: 7 | loss: 0.8555267
	speed: 0.0120s/iter; left time: 1.7658s
Updating learning rate to 1.9238527556838467e-06
Validation loss decreased (0.5449 --> 0.5439).  Saving model state dict ...
Epoch: 7 cost time: 0.9981510639190674
Epoch: 7, Steps: 123 | Train Loss: 0.8555267 Vali Loss: 0.5439289 Best vali loss: 0.5439289
	iters: 100, epoch: 8 | loss: 0.7468344
	speed: 0.0124s/iter; left time: 0.2984s
Updating learning rate to 0.0
Validation loss decreased (0.5439 --> 0.5383).  Saving model state dict ...
Epoch: 8 cost time: 0.9886095523834229
Epoch: 8, Steps: 123 | Train Loss: 0.7468344 Vali Loss: 0.5383220 Best vali loss: 0.5383220

best validation loss 0.5383219874219617

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.010141452236, 'e_layers': 3, 'learning_rate': 0.0001568519492, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8852677
	speed: 0.0115s/iter; left time: 10.1588s
Updating learning rate to 0.0001568519492
Validation loss decreased (inf --> 0.6053).  Saving model state dict ...
Epoch: 1 cost time: 1.0023603439331055
Epoch: 1, Steps: 123 | Train Loss: 0.8852677 Vali Loss: 0.6053348 Best vali loss: 0.6053348
	iters: 100, epoch: 2 | loss: 0.8308869
	speed: 0.0087s/iter; left time: 6.6091s
Updating learning rate to 7.84259746e-05
Validation loss decreased (0.6053 --> 0.6036).  Saving model state dict ...
Epoch: 2 cost time: 0.6956732273101807
Epoch: 2, Steps: 123 | Train Loss: 0.8308869 Vali Loss: 0.6036495 Best vali loss: 0.6036495
	iters: 100, epoch: 3 | loss: 0.8240386
	speed: 0.0084s/iter; left time: 5.3699s
Updating learning rate to 3.92129873e-05
Validation loss decreased (0.6036 --> 0.5630).  Saving model state dict ...
Epoch: 3 cost time: 0.6648259162902832
Epoch: 3, Steps: 123 | Train Loss: 0.8240386 Vali Loss: 0.5629996 Best vali loss: 0.5629996
	iters: 100, epoch: 4 | loss: 0.8395988
	speed: 0.0087s/iter; left time: 4.4834s
Updating learning rate to 1.960649365e-05
Validation loss decreased (0.5630 --> 0.5625).  Saving model state dict ...
Epoch: 4 cost time: 0.6769418716430664
Epoch: 4, Steps: 123 | Train Loss: 0.8395988 Vali Loss: 0.5624954 Best vali loss: 0.5624954
	iters: 100, epoch: 5 | loss: 0.8068727
	speed: 0.0086s/iter; left time: 3.3754s
Updating learning rate to 9.803246825e-06
Epoch: 5 cost time: 0.6835284233093262
Epoch: 5, Steps: 123 | Train Loss: 0.8068727 Vali Loss: 0.5668091 Best vali loss: 0.5624954
	iters: 100, epoch: 6 | loss: 0.5691189
	speed: 0.0083s/iter; left time: 2.2474s
Updating learning rate to 4.9016234125e-06
Epoch: 6 cost time: 0.671471357345581
Epoch: 6, Steps: 123 | Train Loss: 0.5691189 Vali Loss: 0.5642250 Best vali loss: 0.5624954
	iters: 100, epoch: 7 | loss: 0.6477898
	speed: 0.0086s/iter; left time: 1.2640s
Updating learning rate to 2.45081170625e-06
Epoch: 7 cost time: 0.6872711181640625
Epoch: 7, Steps: 123 | Train Loss: 0.6477898 Vali Loss: 0.5628067 Best vali loss: 0.5624954
	iters: 100, epoch: 8 | loss: 0.8575649
	speed: 0.0087s/iter; left time: 0.2095s
Updating learning rate to 1.225405853125e-06
Epoch: 8 cost time: 0.705733060836792
Epoch: 8, Steps: 123 | Train Loss: 0.8575649 Vali Loss: 0.5645223 Best vali loss: 0.5624954

best validation loss 0.5624953673868917

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0105452378301, 'e_layers': 1, 'learning_rate': 0.0011111493958, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9390602
	speed: 0.0090s/iter; left time: 34.2184s
	iters: 200, epoch: 1 | loss: 0.5441594
	speed: 0.0027s/iter; left time: 10.1748s
	iters: 300, epoch: 1 | loss: 0.8085862
	speed: 0.0026s/iter; left time: 9.4536s
	iters: 400, epoch: 1 | loss: 0.9202260
	speed: 0.0028s/iter; left time: 9.8238s
Updating learning rate to 0.0011111493958
Validation loss decreased (inf --> 0.6314).  Saving model state dict ...
Epoch: 1 cost time: 1.69303297996521
Epoch: 1, Steps: 490 | Train Loss: 0.8030079 Vali Loss: 0.6313816 Best vali loss: 0.6313816
	iters: 100, epoch: 2 | loss: 1.3626345
	speed: 0.0086s/iter; left time: 28.6443s
	iters: 200, epoch: 2 | loss: 1.3007314
	speed: 0.0027s/iter; left time: 8.8220s
	iters: 300, epoch: 2 | loss: 0.6970599
	speed: 0.0027s/iter; left time: 8.3754s
	iters: 400, epoch: 2 | loss: 0.9304791
	speed: 0.0027s/iter; left time: 8.3054s
Updating learning rate to 0.0005555746979
Validation loss decreased (0.6314 --> 0.6197).  Saving model state dict ...
Epoch: 2 cost time: 1.3872296810150146
Epoch: 2, Steps: 490 | Train Loss: 1.0727262 Vali Loss: 0.6196867 Best vali loss: 0.6196867
	iters: 100, epoch: 3 | loss: 0.9458714
	speed: 0.0084s/iter; left time: 23.8391s
	iters: 200, epoch: 3 | loss: 0.9366677
	speed: 0.0026s/iter; left time: 7.0179s
	iters: 300, epoch: 3 | loss: 0.7980510
	speed: 0.0026s/iter; left time: 6.8288s
	iters: 400, epoch: 3 | loss: 0.8255443
	speed: 0.0027s/iter; left time: 6.8342s
Updating learning rate to 0.00027778734895
Epoch: 3 cost time: 1.335425853729248
Epoch: 3, Steps: 490 | Train Loss: 0.8765336 Vali Loss: 0.6479033 Best vali loss: 0.6196867

best validation loss 0.6196866705427563

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010501434081, 'e_layers': 2, 'learning_rate': 0.0004347044141, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0305841
	speed: 0.0112s/iter; left time: 9.8938s
Updating learning rate to 0.0004181594624896504
Validation loss decreased (inf --> 0.6431).  Saving model state dict ...
Epoch: 1 cost time: 0.9101474285125732
Epoch: 1, Steps: 123 | Train Loss: 1.0305841 Vali Loss: 0.6430645 Best vali loss: 0.6430645
	iters: 100, epoch: 2 | loss: 0.8215339
	speed: 0.0077s/iter; left time: 5.8726s
Updating learning rate to 0.0003710434265609175
Validation loss decreased (0.6431 --> 0.5653).  Saving model state dict ...
Epoch: 2 cost time: 0.5923960208892822
Epoch: 2, Steps: 123 | Train Loss: 0.8215339 Vali Loss: 0.5652613 Best vali loss: 0.5652613
	iters: 100, epoch: 3 | loss: 0.8190600
	speed: 0.0078s/iter; left time: 5.0023s
Updating learning rate to 0.0003005292956760217
Validation loss decreased (0.5653 --> 0.5466).  Saving model state dict ...
Epoch: 3 cost time: 0.6104087829589844
Epoch: 3, Steps: 123 | Train Loss: 0.8190600 Vali Loss: 0.5466318 Best vali loss: 0.5466318

best validation loss 0.5466317692905154

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010677841355, 'e_layers': 2, 'learning_rate': 0.0007251287061, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007251287061
Validation loss decreased (inf --> 0.6064).  Saving model state dict ...
Epoch: 1 cost time: 0.7578294277191162
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6064199 Best vali loss: 0.6064199
Updating learning rate to 0.00036256435305
Validation loss decreased (0.6064 --> 0.5986).  Saving model state dict ...
Epoch: 2 cost time: 0.45743536949157715
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5986207 Best vali loss: 0.5986207
Updating learning rate to 0.000181282176525
Epoch: 3 cost time: 0.4604191780090332
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6246072 Best vali loss: 0.5986207

best validation loss 0.5986206664469771

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010501434081, 'e_layers': 2, 'learning_rate': 0.0004347044141, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8550988
	speed: 0.0111s/iter; left time: 5.7376s
Updating learning rate to 0.00021735220705
Epoch: 4 cost time: 0.9312400817871094
Epoch: 4, Steps: 123 | Train Loss: 0.8550988 Vali Loss: 0.5472641 Best vali loss: 0.5466318
	iters: 100, epoch: 5 | loss: 0.7105518
	speed: 0.0078s/iter; left time: 3.0575s
Updating learning rate to 0.00013417511842397836
Validation loss decreased (0.5466 --> 0.5456).  Saving model state dict ...
Epoch: 5 cost time: 0.6112825870513916
Epoch: 5, Steps: 123 | Train Loss: 0.7105518 Vali Loss: 0.5456118 Best vali loss: 0.5456118
	iters: 100, epoch: 6 | loss: 0.6574035
	speed: 0.0080s/iter; left time: 2.1584s
Updating learning rate to 6.366098753908249e-05
Validation loss decreased (0.5456 --> 0.5424).  Saving model state dict ...
Epoch: 6 cost time: 0.5969903469085693
Epoch: 6, Steps: 123 | Train Loss: 0.6574035 Vali Loss: 0.5423991 Best vali loss: 0.5423991
	iters: 100, epoch: 7 | loss: 0.6800979
	speed: 0.0080s/iter; left time: 1.1828s
Updating learning rate to 1.6544951610349598e-05
Epoch: 7 cost time: 0.6196486949920654
Epoch: 7, Steps: 123 | Train Loss: 0.6800979 Vali Loss: 0.5525230 Best vali loss: 0.5423991
	iters: 100, epoch: 8 | loss: 0.5749464
	speed: 0.0078s/iter; left time: 0.1880s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6179869174957275
Epoch: 8, Steps: 123 | Train Loss: 0.5749464 Vali Loss: 0.5583423 Best vali loss: 0.5423991

best validation loss 0.5423990834619865

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.005101946936, 'e_layers': 3, 'learning_rate': 0.000162106736, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8848726
	speed: 0.0135s/iter; left time: 11.9508s
Updating learning rate to 0.000162106736
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 1.2199490070343018
Epoch: 1, Steps: 123 | Train Loss: 0.8848726 Vali Loss: 0.6049355 Best vali loss: 0.6049355
	iters: 100, epoch: 2 | loss: 0.8288729
	speed: 0.0092s/iter; left time: 6.9928s
Updating learning rate to 8.1053368e-05
Validation loss decreased (0.6049 --> 0.6025).  Saving model state dict ...
Epoch: 2 cost time: 0.7318291664123535
Epoch: 2, Steps: 123 | Train Loss: 0.8288729 Vali Loss: 0.6024808 Best vali loss: 0.6024808
	iters: 100, epoch: 3 | loss: 0.8218173
	speed: 0.0091s/iter; left time: 5.8084s
Updating learning rate to 4.0526684e-05
Validation loss decreased (0.6025 --> 0.5614).  Saving model state dict ...
Epoch: 3 cost time: 0.7281463146209717
Epoch: 3, Steps: 123 | Train Loss: 0.8218173 Vali Loss: 0.5614263 Best vali loss: 0.5614263
	iters: 100, epoch: 4 | loss: 0.8356250
	speed: 0.0088s/iter; left time: 4.5315s
Updating learning rate to 2.0263342e-05
Epoch: 4 cost time: 0.7094993591308594
Epoch: 4, Steps: 123 | Train Loss: 0.8356250 Vali Loss: 0.5628682 Best vali loss: 0.5614263
	iters: 100, epoch: 5 | loss: 0.8027539
	speed: 0.0090s/iter; left time: 3.5299s
Updating learning rate to 1.0131671e-05
Epoch: 5 cost time: 0.7308835983276367
Epoch: 5, Steps: 123 | Train Loss: 0.8027539 Vali Loss: 0.5649632 Best vali loss: 0.5614263
	iters: 100, epoch: 6 | loss: 0.5659864
	speed: 0.0088s/iter; left time: 2.3775s
Updating learning rate to 5.0658355e-06
Epoch: 6 cost time: 0.7204740047454834
Epoch: 6, Steps: 123 | Train Loss: 0.5659864 Vali Loss: 0.5623649 Best vali loss: 0.5614263
	iters: 100, epoch: 7 | loss: 0.6420152
	speed: 0.0089s/iter; left time: 1.3029s
Updating learning rate to 2.53291775e-06
Validation loss decreased (0.5614 --> 0.5613).  Saving model state dict ...
Epoch: 7 cost time: 0.7056365013122559
Epoch: 7, Steps: 123 | Train Loss: 0.6420152 Vali Loss: 0.5613168 Best vali loss: 0.5613168
	iters: 100, epoch: 8 | loss: 0.8577974
	speed: 0.0089s/iter; left time: 0.2127s
Updating learning rate to 1.266458875e-06
Epoch: 8 cost time: 0.7017936706542969
Epoch: 8, Steps: 123 | Train Loss: 0.8577974 Vali Loss: 0.5622622 Best vali loss: 0.5613168

best validation loss 0.5613167645588124

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0009567025712, 'e_layers': 3, 'learning_rate': 0.0004708803636, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6020817
	speed: 0.0115s/iter; left time: 21.3381s
	iters: 200, epoch: 1 | loss: 0.8492637
	speed: 0.0049s/iter; left time: 8.6989s
Updating learning rate to 0.0004708803636
Validation loss decreased (inf --> 0.6015).  Saving model state dict ...
Epoch: 1 cost time: 1.5441007614135742
Epoch: 1, Steps: 245 | Train Loss: 0.7256727 Vali Loss: 0.6015025 Best vali loss: 0.6015025
	iters: 100, epoch: 2 | loss: 0.7678783
	speed: 0.0096s/iter; left time: 15.4621s
	iters: 200, epoch: 2 | loss: 1.1329547
	speed: 0.0045s/iter; left time: 6.7920s
Updating learning rate to 0.0002354401818
Validation loss decreased (0.6015 --> 0.5849).  Saving model state dict ...
Epoch: 2 cost time: 1.163517951965332
Epoch: 2, Steps: 245 | Train Loss: 0.9504165 Vali Loss: 0.5848959 Best vali loss: 0.5848959
	iters: 100, epoch: 3 | loss: 0.7245377
	speed: 0.0096s/iter; left time: 13.1815s
	iters: 200, epoch: 3 | loss: 0.8304099
	speed: 0.0047s/iter; left time: 5.9184s
Updating learning rate to 0.0001177200909
Validation loss decreased (0.5849 --> 0.5741).  Saving model state dict ...
Epoch: 3 cost time: 1.1975281238555908
Epoch: 3, Steps: 245 | Train Loss: 0.7774738 Vali Loss: 0.5741023 Best vali loss: 0.5741023
	iters: 100, epoch: 4 | loss: 0.6196623
	speed: 0.0095s/iter; left time: 10.7180s
	iters: 200, epoch: 4 | loss: 0.9064325
	speed: 0.0047s/iter; left time: 4.8617s
Updating learning rate to 5.886004545e-05
Validation loss decreased (0.5741 --> 0.5488).  Saving model state dict ...
Epoch: 4 cost time: 1.2075581550598145
Epoch: 4, Steps: 245 | Train Loss: 0.7630474 Vali Loss: 0.5488263 Best vali loss: 0.5488263
	iters: 100, epoch: 5 | loss: 0.5118123
	speed: 0.0096s/iter; left time: 8.5002s
	iters: 200, epoch: 5 | loss: 0.7121074
	speed: 0.0047s/iter; left time: 3.6580s
Updating learning rate to 2.9430022725e-05
Epoch: 5 cost time: 1.2087533473968506
Epoch: 5, Steps: 245 | Train Loss: 0.6119599 Vali Loss: 0.5493322 Best vali loss: 0.5488263
	iters: 100, epoch: 6 | loss: 0.4368334
	speed: 0.0092s/iter; left time: 5.8801s
	iters: 200, epoch: 6 | loss: 0.9027904
	speed: 0.0045s/iter; left time: 2.4347s
Updating learning rate to 1.47150113625e-05
Validation loss decreased (0.5488 --> 0.5448).  Saving model state dict ...
Epoch: 6 cost time: 1.1582584381103516
Epoch: 6, Steps: 245 | Train Loss: 0.6698119 Vali Loss: 0.5447696 Best vali loss: 0.5447696
	iters: 100, epoch: 7 | loss: 1.2100722
	speed: 0.0094s/iter; left time: 3.6904s
	iters: 200, epoch: 7 | loss: 0.5876045
	speed: 0.0045s/iter; left time: 1.3119s
Updating learning rate to 7.35750568125e-06
Epoch: 7 cost time: 1.165334701538086
Epoch: 7, Steps: 245 | Train Loss: 0.8988383 Vali Loss: 0.5520953 Best vali loss: 0.5447696
	iters: 100, epoch: 8 | loss: 0.5445294
	speed: 0.0097s/iter; left time: 1.4179s
	iters: 200, epoch: 8 | loss: 0.8187976
	speed: 0.0049s/iter; left time: 0.2252s
Updating learning rate to 3.678752840625e-06
Epoch: 8 cost time: 1.2599434852600098
Epoch: 8, Steps: 245 | Train Loss: 0.6816635 Vali Loss: 0.5470589 Best vali loss: 0.5447696

best validation loss 0.5447696132110479

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0100772771973, 'e_layers': 4, 'learning_rate': 0.0007009690071, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7122347
	speed: 0.0122s/iter; left time: 10.7923s
Updating learning rate to 0.0006742899628422245
Validation loss decreased (inf --> 0.5866).  Saving model state dict ...
Epoch: 1 cost time: 1.0831408500671387
Epoch: 1, Steps: 123 | Train Loss: 0.7122347 Vali Loss: 0.5866442 Best vali loss: 0.5866442
	iters: 100, epoch: 2 | loss: 0.9642504
	speed: 0.0100s/iter; left time: 7.6380s
Updating learning rate to 0.0005983144727110056
Epoch: 2 cost time: 0.84751296043396
Epoch: 2, Steps: 123 | Train Loss: 0.9642504 Vali Loss: 0.6073347 Best vali loss: 0.5866442
	iters: 100, epoch: 3 | loss: 0.6645465
	speed: 0.0099s/iter; left time: 6.3033s
Updating learning rate to 0.0004846091163592885
Validation loss decreased (0.5866 --> 0.5697).  Saving model state dict ...
Epoch: 3 cost time: 0.8076329231262207
Epoch: 3, Steps: 123 | Train Loss: 0.6645465 Vali Loss: 0.5697279 Best vali loss: 0.5697279

best validation loss 0.5697278744476032

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0020395211564, 'e_layers': 2, 'learning_rate': 0.0001060030032, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6354276
	speed: 0.0098s/iter; left time: 37.2764s
	iters: 200, epoch: 1 | loss: 0.7035691
	speed: 0.0036s/iter; left time: 13.5511s
	iters: 300, epoch: 1 | loss: 0.8264211
	speed: 0.0035s/iter; left time: 12.5399s
	iters: 400, epoch: 1 | loss: 0.4919638
	speed: 0.0038s/iter; left time: 13.3287s
Updating learning rate to 0.0001060030032
Validation loss decreased (inf --> 0.6201).  Saving model state dict ...
Epoch: 1 cost time: 2.139914035797119
Epoch: 1, Steps: 490 | Train Loss: 0.6643454 Vali Loss: 0.6200931 Best vali loss: 0.6200931
	iters: 100, epoch: 2 | loss: 1.1566616
	speed: 0.0101s/iter; left time: 33.5408s
	iters: 200, epoch: 2 | loss: 0.9142275
	speed: 0.0032s/iter; left time: 10.2354s
	iters: 300, epoch: 2 | loss: 0.7004515
	speed: 0.0032s/iter; left time: 9.8665s
	iters: 400, epoch: 2 | loss: 0.5191996
	speed: 0.0033s/iter; left time: 9.9545s
Updating learning rate to 5.30015016e-05
Validation loss decreased (0.6201 --> 0.6089).  Saving model state dict ...
Epoch: 2 cost time: 1.637331485748291
Epoch: 2, Steps: 490 | Train Loss: 0.8226351 Vali Loss: 0.6089231 Best vali loss: 0.6089231
	iters: 100, epoch: 3 | loss: 0.4377810
	speed: 0.0098s/iter; left time: 27.8326s
	iters: 200, epoch: 3 | loss: 0.7127188
	speed: 0.0038s/iter; left time: 10.3123s
	iters: 300, epoch: 3 | loss: 1.0161675
	speed: 0.0035s/iter; left time: 9.2535s
	iters: 400, epoch: 3 | loss: 1.1935861
	speed: 0.0033s/iter; left time: 8.3514s
Updating learning rate to 2.65007508e-05
Epoch: 3 cost time: 1.7586729526519775
Epoch: 3, Steps: 490 | Train Loss: 0.8400633 Vali Loss: 0.6105349 Best vali loss: 0.6089231

best validation loss 0.6089231238658646

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019872822391, 'e_layers': 3, 'learning_rate': 0.0001367997195, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6225781
	speed: 0.0140s/iter; left time: 12.4274s
Updating learning rate to 0.00013159309019966759
Validation loss decreased (inf --> 0.5953).  Saving model state dict ...
Epoch: 1 cost time: 1.2993645668029785
Epoch: 1, Steps: 123 | Train Loss: 0.6225781 Vali Loss: 0.5953016 Best vali loss: 0.5953016
	iters: 100, epoch: 2 | loss: 0.7270386
	speed: 0.0121s/iter; left time: 9.2306s
Updating learning rate to 0.00011676586441143379
Validation loss decreased (0.5953 --> 0.5590).  Saving model state dict ...
Epoch: 2 cost time: 0.9870316982269287
Epoch: 2, Steps: 123 | Train Loss: 0.7270386 Vali Loss: 0.5589976 Best vali loss: 0.5589976
	iters: 100, epoch: 3 | loss: 0.6417367
	speed: 0.0125s/iter; left time: 7.9707s
Updating learning rate to 9.457535285242075e-05
Validation loss decreased (0.5590 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 0.9912035465240479
Epoch: 3, Steps: 123 | Train Loss: 0.6417367 Vali Loss: 0.5452553 Best vali loss: 0.5452553

best validation loss 0.5452552593896258

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019872822391, 'e_layers': 3, 'learning_rate': 0.0001367997195, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5402412
	speed: 0.0145s/iter; left time: 7.4764s
Updating learning rate to 6.839985975e-05
Epoch: 4 cost time: 1.3074183464050293
Epoch: 4, Steps: 123 | Train Loss: 0.5402412 Vali Loss: 0.5546382 Best vali loss: 0.5452553
	iters: 100, epoch: 5 | loss: 0.6499677
	speed: 0.0120s/iter; left time: 4.7074s
Updating learning rate to 4.2224366647579255e-05
Validation loss decreased (0.5453 --> 0.5300).  Saving model state dict ...
Epoch: 5 cost time: 0.9966063499450684
Epoch: 5, Steps: 123 | Train Loss: 0.6499677 Vali Loss: 0.5299649 Best vali loss: 0.5299649
	iters: 100, epoch: 6 | loss: 0.5912262
	speed: 0.0124s/iter; left time: 3.3463s
Updating learning rate to 2.0033855088566214e-05
Epoch: 6 cost time: 0.9935615062713623
Epoch: 6, Steps: 123 | Train Loss: 0.5912262 Vali Loss: 0.5346765 Best vali loss: 0.5299649
	iters: 100, epoch: 7 | loss: 0.8259954
	speed: 0.0120s/iter; left time: 1.7620s
Updating learning rate to 5.206629300332422e-06
Epoch: 7 cost time: 0.9975802898406982
Epoch: 7, Steps: 123 | Train Loss: 0.8259954 Vali Loss: 0.5359341 Best vali loss: 0.5299649
	iters: 100, epoch: 8 | loss: 0.6783637
	speed: 0.0118s/iter; left time: 0.2844s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9872150421142578
Epoch: 8, Steps: 123 | Train Loss: 0.6783637 Vali Loss: 0.5346426 Best vali loss: 0.5299649

best validation loss 0.5299649434694258

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0116554669811, 'e_layers': 2, 'learning_rate': 0.0003702357929, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4928886
	speed: 0.0094s/iter; left time: 72.5225s
	iters: 200, epoch: 1 | loss: 0.9394861
	speed: 0.0033s/iter; left time: 25.0198s
	iters: 300, epoch: 1 | loss: 0.8090042
	speed: 0.0033s/iter; left time: 25.1410s
	iters: 400, epoch: 1 | loss: 0.6338953
	speed: 0.0034s/iter; left time: 25.4149s
	iters: 500, epoch: 1 | loss: 0.2446675
	speed: 0.0034s/iter; left time: 24.7326s
	iters: 600, epoch: 1 | loss: 0.9207541
	speed: 0.0034s/iter; left time: 24.8005s
	iters: 700, epoch: 1 | loss: 0.7178569
	speed: 0.0034s/iter; left time: 24.4240s
	iters: 800, epoch: 1 | loss: 0.8505208
	speed: 0.0033s/iter; left time: 23.0689s
	iters: 900, epoch: 1 | loss: 0.5262851
	speed: 0.0033s/iter; left time: 22.7967s
Updating learning rate to 0.00035614453208169877
Validation loss decreased (inf --> 0.6088).  Saving model state dict ...
Epoch: 1 cost time: 3.6148481369018555
Epoch: 1, Steps: 979 | Train Loss: 0.6817065 Vali Loss: 0.6087982 Best vali loss: 0.6087982
	iters: 100, epoch: 2 | loss: 0.7271073
	speed: 0.0111s/iter; left time: 75.1915s
	iters: 200, epoch: 2 | loss: 0.9304978
	speed: 0.0034s/iter; left time: 22.6457s
	iters: 300, epoch: 2 | loss: 0.9957500
	speed: 0.0032s/iter; left time: 21.2328s
	iters: 400, epoch: 2 | loss: 1.0897176
	speed: 0.0032s/iter; left time: 20.6158s
	iters: 500, epoch: 2 | loss: 1.3506991
	speed: 0.0033s/iter; left time: 20.9972s
	iters: 600, epoch: 2 | loss: 1.6541884
	speed: 0.0033s/iter; left time: 20.3591s
	iters: 700, epoch: 2 | loss: 0.4781282
	speed: 0.0033s/iter; left time: 20.0461s
	iters: 800, epoch: 2 | loss: 1.0202980
	speed: 0.0033s/iter; left time: 19.9167s
	iters: 900, epoch: 2 | loss: 0.3098022
	speed: 0.0032s/iter; left time: 18.8656s
Updating learning rate to 0.0003160160163487841
Epoch: 2 cost time: 3.243861198425293
Epoch: 2, Steps: 979 | Train Loss: 0.9506876 Vali Loss: 0.6093079 Best vali loss: 0.6087982
	iters: 100, epoch: 3 | loss: 0.6897767
	speed: 0.0108s/iter; left time: 62.5311s
	iters: 200, epoch: 3 | loss: 1.0359625
	speed: 0.0034s/iter; left time: 19.1881s
	iters: 300, epoch: 3 | loss: 0.7077677
	speed: 0.0035s/iter; left time: 19.4693s
	iters: 400, epoch: 3 | loss: 0.5690780
	speed: 0.0035s/iter; left time: 18.9570s
	iters: 500, epoch: 3 | loss: 0.9497284
	speed: 0.0034s/iter; left time: 18.5245s
	iters: 600, epoch: 3 | loss: 0.4138460
	speed: 0.0034s/iter; left time: 17.9919s
	iters: 700, epoch: 3 | loss: 0.7117683
	speed: 0.0031s/iter; left time: 15.8754s
	iters: 800, epoch: 3 | loss: 0.6587191
	speed: 0.0030s/iter; left time: 15.2201s
	iters: 900, epoch: 3 | loss: 0.4809504
	speed: 0.0030s/iter; left time: 14.9515s
Updating learning rate to 0.0002559594484556913
Validation loss decreased (0.6088 --> 0.6016).  Saving model state dict ...
Epoch: 3 cost time: 3.241586685180664
Epoch: 3, Steps: 979 | Train Loss: 0.6908441 Vali Loss: 0.6015738 Best vali loss: 0.6015738
	iters: 100, epoch: 4 | loss: 0.5525667
	speed: 0.0109s/iter; left time: 52.2887s
	iters: 200, epoch: 4 | loss: 0.7919899
	speed: 0.0031s/iter; left time: 14.5278s
	iters: 300, epoch: 4 | loss: 1.9467463
	speed: 0.0031s/iter; left time: 14.0583s
	iters: 400, epoch: 4 | loss: 0.2746631
	speed: 0.0031s/iter; left time: 14.1343s
	iters: 500, epoch: 4 | loss: 1.2665344
	speed: 0.0032s/iter; left time: 13.8730s
	iters: 600, epoch: 4 | loss: 1.0423470
	speed: 0.0031s/iter; left time: 13.1211s
	iters: 700, epoch: 4 | loss: 0.9815821
	speed: 0.0031s/iter; left time: 12.8432s
	iters: 800, epoch: 4 | loss: 1.1549190
	speed: 0.0029s/iter; left time: 12.0763s
	iters: 900, epoch: 4 | loss: 1.7411267
	speed: 0.0030s/iter; left time: 12.0626s
Updating learning rate to 0.00018511789645
Epoch: 4 cost time: 3.064615249633789
Epoch: 4, Steps: 979 | Train Loss: 1.0836084 Vali Loss: 0.6121073 Best vali loss: 0.6015738
	iters: 100, epoch: 5 | loss: 1.0657632
	speed: 0.0110s/iter; left time: 41.8270s
	iters: 200, epoch: 5 | loss: 1.6250696
	speed: 0.0030s/iter; left time: 11.2478s
	iters: 300, epoch: 5 | loss: 0.5556065
	speed: 0.0032s/iter; left time: 11.4755s
	iters: 400, epoch: 5 | loss: 0.3918203
	speed: 0.0033s/iter; left time: 11.6964s
	iters: 500, epoch: 5 | loss: 1.4455924
	speed: 0.0035s/iter; left time: 11.9237s
	iters: 600, epoch: 5 | loss: 0.9116274
	speed: 0.0035s/iter; left time: 11.5778s
	iters: 700, epoch: 5 | loss: 0.9847211
	speed: 0.0031s/iter; left time: 9.9132s
	iters: 800, epoch: 5 | loss: 0.9212279
	speed: 0.0032s/iter; left time: 10.0454s
	iters: 900, epoch: 5 | loss: 0.5849937
	speed: 0.0032s/iter; left time: 9.5060s
Updating learning rate to 0.00011427634444430874
Epoch: 5 cost time: 3.208545207977295
Epoch: 5, Steps: 979 | Train Loss: 0.9429358 Vali Loss: 0.6216090 Best vali loss: 0.6015738
	iters: 100, epoch: 6 | loss: 0.5236872
	speed: 0.0107s/iter; left time: 30.3600s
	iters: 200, epoch: 6 | loss: 0.5471179
	speed: 0.0031s/iter; left time: 8.6067s
	iters: 300, epoch: 6 | loss: 0.4893038
	speed: 0.0031s/iter; left time: 8.1189s
	iters: 400, epoch: 6 | loss: 0.8516501
	speed: 0.0030s/iter; left time: 7.6045s
	iters: 500, epoch: 6 | loss: 0.8375143
	speed: 0.0031s/iter; left time: 7.4459s
	iters: 600, epoch: 6 | loss: 0.4568275
	speed: 0.0031s/iter; left time: 7.1501s
	iters: 700, epoch: 6 | loss: 0.4923670
	speed: 0.0030s/iter; left time: 6.7302s
	iters: 800, epoch: 6 | loss: 1.0807216
	speed: 0.0031s/iter; left time: 6.6898s
	iters: 900, epoch: 6 | loss: 0.3597831
	speed: 0.0030s/iter; left time: 6.0631s
Updating learning rate to 5.42197765512159e-05
Epoch: 6 cost time: 3.031470775604248
Epoch: 6, Steps: 979 | Train Loss: 0.6265525 Vali Loss: 0.6449118 Best vali loss: 0.6015738
	iters: 100, epoch: 7 | loss: 1.3315451
	speed: 0.0102s/iter; left time: 18.9512s
	iters: 200, epoch: 7 | loss: 0.6240206
	speed: 0.0029s/iter; left time: 5.0920s
	iters: 300, epoch: 7 | loss: 0.4082028
	speed: 0.0030s/iter; left time: 4.9113s
	iters: 400, epoch: 7 | loss: 0.7674193
	speed: 0.0030s/iter; left time: 4.6330s
	iters: 500, epoch: 7 | loss: 0.6662759
	speed: 0.0031s/iter; left time: 4.4871s
	iters: 600, epoch: 7 | loss: 0.6259411
	speed: 0.0030s/iter; left time: 4.0634s
	iters: 700, epoch: 7 | loss: 0.2852672
	speed: 0.0030s/iter; left time: 3.7910s
	iters: 800, epoch: 7 | loss: 1.5175394
	speed: 0.0030s/iter; left time: 3.4480s
	iters: 900, epoch: 7 | loss: 0.4744207
	speed: 0.0030s/iter; left time: 3.1784s
Updating learning rate to 1.4091260818301213e-05
Epoch: 7 cost time: 2.9623537063598633
Epoch: 7, Steps: 979 | Train Loss: 0.7445147 Vali Loss: 0.6507945 Best vali loss: 0.6015738
	iters: 100, epoch: 8 | loss: 0.4922093
	speed: 0.0103s/iter; left time: 9.0637s
	iters: 200, epoch: 8 | loss: 0.4650491
	speed: 0.0032s/iter; left time: 2.4704s
	iters: 300, epoch: 8 | loss: 0.2413747
	speed: 0.0031s/iter; left time: 2.0902s
	iters: 400, epoch: 8 | loss: 0.7668330
	speed: 0.0032s/iter; left time: 1.8285s
	iters: 500, epoch: 8 | loss: 1.9477973
	speed: 0.0031s/iter; left time: 1.4717s
	iters: 600, epoch: 8 | loss: 0.6240712
	speed: 0.0030s/iter; left time: 1.1472s
	iters: 700, epoch: 8 | loss: 0.4181391
	speed: 0.0031s/iter; left time: 0.8550s
	iters: 800, epoch: 8 | loss: 1.3239861
	speed: 0.0031s/iter; left time: 0.5586s
	iters: 900, epoch: 8 | loss: 0.5503392
	speed: 0.0030s/iter; left time: 0.2416s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0550425052642822
Epoch: 8, Steps: 979 | Train Loss: 0.7588665 Vali Loss: 0.6475973 Best vali loss: 0.6015738

best validation loss 0.6015738255031017

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017712717656, 'e_layers': 3, 'learning_rate': 0.0001367642932, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6225672
	speed: 0.0140s/iter; left time: 12.4065s
Updating learning rate to 0.00013155901223292627
Validation loss decreased (inf --> 0.5953).  Saving model state dict ...
Epoch: 1 cost time: 1.2984750270843506
Epoch: 1, Steps: 123 | Train Loss: 0.6225672 Vali Loss: 0.5952508 Best vali loss: 0.5952508
	iters: 100, epoch: 2 | loss: 0.7285657
	speed: 0.0122s/iter; left time: 9.2618s
Updating learning rate to 0.00011673562617295261
Validation loss decreased (0.5953 --> 0.5479).  Saving model state dict ...
Epoch: 2 cost time: 0.9861321449279785
Epoch: 2, Steps: 123 | Train Loss: 0.7285657 Vali Loss: 0.5479162 Best vali loss: 0.5479162
	iters: 100, epoch: 3 | loss: 0.6321090
	speed: 0.0123s/iter; left time: 7.8526s
Updating learning rate to 9.455086117338076e-05
Epoch: 3 cost time: 0.9907879829406738
Epoch: 3, Steps: 123 | Train Loss: 0.6321090 Vali Loss: 0.5483923 Best vali loss: 0.5479162
	iters: 100, epoch: 4 | loss: 0.8606609
	speed: 0.0119s/iter; left time: 6.1449s
Updating learning rate to 6.83821466e-05
Epoch: 4 cost time: 0.9908974170684814
Epoch: 4, Steps: 123 | Train Loss: 0.8606609 Vali Loss: 0.5627047 Best vali loss: 0.5479162
	iters: 100, epoch: 5 | loss: 0.6939014
	speed: 0.0120s/iter; left time: 4.7004s
Updating learning rate to 4.221343202661925e-05
Epoch: 5 cost time: 0.9947538375854492
Epoch: 5, Steps: 123 | Train Loss: 0.6939014 Vali Loss: 0.5506559 Best vali loss: 0.5479162
	iters: 100, epoch: 6 | loss: 0.4552997
	speed: 0.0119s/iter; left time: 3.2247s
Updating learning rate to 2.0028667027047388e-05
Validation loss decreased (0.5479 --> 0.5459).  Saving model state dict ...
Epoch: 6 cost time: 0.9881322383880615
Epoch: 6, Steps: 123 | Train Loss: 0.4552997 Vali Loss: 0.5458859 Best vali loss: 0.5458859
	iters: 100, epoch: 7 | loss: 0.8245800
	speed: 0.0125s/iter; left time: 1.8355s
Updating learning rate to 5.205280967073724e-06
Validation loss decreased (0.5459 --> 0.5408).  Saving model state dict ...
Epoch: 7 cost time: 0.9921867847442627
Epoch: 7, Steps: 123 | Train Loss: 0.8245800 Vali Loss: 0.5408158 Best vali loss: 0.5408158
	iters: 100, epoch: 8 | loss: 0.7150047
	speed: 0.0124s/iter; left time: 0.2978s
Updating learning rate to 0.0
Validation loss decreased (0.5408 --> 0.5342).  Saving model state dict ...
Epoch: 8 cost time: 0.9906635284423828
Epoch: 8, Steps: 123 | Train Loss: 0.7150047 Vali Loss: 0.5342356 Best vali loss: 0.5342356

best validation loss 0.5342355506086945

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018723076898, 'e_layers': 3, 'learning_rate': 0.0001378593321, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6225865
	speed: 0.0137s/iter; left time: 12.1297s
Updating learning rate to 0.00013261237369643312
Validation loss decreased (inf --> 0.5952).  Saving model state dict ...
Epoch: 1 cost time: 1.2818467617034912
Epoch: 1, Steps: 123 | Train Loss: 0.6225865 Vali Loss: 0.5952260 Best vali loss: 0.5952260
	iters: 100, epoch: 2 | loss: 0.7268733
	speed: 0.0122s/iter; left time: 9.3111s
Updating learning rate to 0.00011767030033887914
Epoch: 2 cost time: 0.9942605495452881
Epoch: 2, Steps: 123 | Train Loss: 0.7268733 Vali Loss: 0.5953373 Best vali loss: 0.5952260
	iters: 100, epoch: 3 | loss: 0.6325715
	speed: 0.0120s/iter; left time: 7.6831s
Updating learning rate to 9.530790724579341e-05
Validation loss decreased (0.5952 --> 0.5434).  Saving model state dict ...
Epoch: 3 cost time: 0.9926142692565918
Epoch: 3, Steps: 123 | Train Loss: 0.6325715 Vali Loss: 0.5434091 Best vali loss: 0.5434091

best validation loss 0.5434090904977684

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020221572807, 'e_layers': 3, 'learning_rate': 0.0001378067991, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6226243
	speed: 0.0139s/iter; left time: 12.2729s
Updating learning rate to 0.00013256184011469242
Validation loss decreased (inf --> 0.5954).  Saving model state dict ...
Epoch: 1 cost time: 1.2898797988891602
Epoch: 1, Steps: 123 | Train Loss: 0.6226243 Vali Loss: 0.5953619 Best vali loss: 0.5953619
	iters: 100, epoch: 2 | loss: 0.7383892
	speed: 0.0123s/iter; left time: 9.3755s
Updating learning rate to 0.00011762546061861111
Validation loss decreased (0.5954 --> 0.5535).  Saving model state dict ...
Epoch: 2 cost time: 0.9918215274810791
Epoch: 2, Steps: 123 | Train Loss: 0.7383892 Vali Loss: 0.5535384 Best vali loss: 0.5535384
	iters: 100, epoch: 3 | loss: 0.6326863
	speed: 0.0124s/iter; left time: 7.9469s
Updating learning rate to 9.527158899141719e-05
Validation loss decreased (0.5535 --> 0.5469).  Saving model state dict ...
Epoch: 3 cost time: 0.9914827346801758
Epoch: 3, Steps: 123 | Train Loss: 0.6326863 Vali Loss: 0.5468743 Best vali loss: 0.5468743

best validation loss 0.5468743299235354

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0113762621552, 'e_layers': 2, 'learning_rate': 0.0001253219318, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5338996
	speed: 0.0095s/iter; left time: 73.1210s
	iters: 200, epoch: 1 | loss: 0.5196271
	speed: 0.0032s/iter; left time: 24.3887s
	iters: 300, epoch: 1 | loss: 0.4379782
	speed: 0.0032s/iter; left time: 24.0668s
	iters: 400, epoch: 1 | loss: 0.9632251
	speed: 0.0032s/iter; left time: 23.9703s
	iters: 500, epoch: 1 | loss: 0.6227280
	speed: 0.0032s/iter; left time: 23.7754s
	iters: 600, epoch: 1 | loss: 0.8135408
	speed: 0.0034s/iter; left time: 24.4581s
	iters: 700, epoch: 1 | loss: 0.6199574
	speed: 0.0034s/iter; left time: 24.1212s
	iters: 800, epoch: 1 | loss: 0.4229437
	speed: 0.0034s/iter; left time: 24.1289s
	iters: 900, epoch: 1 | loss: 0.9729719
	speed: 0.0034s/iter; left time: 23.8530s
Updating learning rate to 0.0001253219318
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 3.5889933109283447
Epoch: 1, Steps: 979 | Train Loss: 0.6563191 Vali Loss: 0.6065134 Best vali loss: 0.6065134
	iters: 100, epoch: 2 | loss: 0.7238604
	speed: 0.0114s/iter; left time: 77.2061s
	iters: 200, epoch: 2 | loss: 0.8944563
	speed: 0.0034s/iter; left time: 22.8107s
	iters: 300, epoch: 2 | loss: 1.4143059
	speed: 0.0034s/iter; left time: 22.1387s
	iters: 400, epoch: 2 | loss: 1.1528229
	speed: 0.0033s/iter; left time: 21.3397s
	iters: 500, epoch: 2 | loss: 0.3653652
	speed: 0.0033s/iter; left time: 20.9956s
	iters: 600, epoch: 2 | loss: 0.9609770
	speed: 0.0033s/iter; left time: 20.6969s
	iters: 700, epoch: 2 | loss: 1.1722264
	speed: 0.0033s/iter; left time: 20.4958s
	iters: 800, epoch: 2 | loss: 1.3961625
	speed: 0.0034s/iter; left time: 20.8391s
	iters: 900, epoch: 2 | loss: 0.3833319
	speed: 0.0035s/iter; left time: 21.0920s
Updating learning rate to 6.26609659e-05
Validation loss decreased (0.6065 --> 0.5961).  Saving model state dict ...
Epoch: 2 cost time: 3.3777759075164795
Epoch: 2, Steps: 979 | Train Loss: 0.9403898 Vali Loss: 0.5960677 Best vali loss: 0.5960677
	iters: 100, epoch: 3 | loss: 1.1768653
	speed: 0.0114s/iter; left time: 65.6125s
	iters: 200, epoch: 3 | loss: 0.4178413
	speed: 0.0032s/iter; left time: 18.3644s
	iters: 300, epoch: 3 | loss: 1.0553075
	speed: 0.0032s/iter; left time: 18.1155s
	iters: 400, epoch: 3 | loss: 0.7383484
	speed: 0.0032s/iter; left time: 17.7278s
	iters: 500, epoch: 3 | loss: 0.3789189
	speed: 0.0032s/iter; left time: 17.0842s
	iters: 600, epoch: 3 | loss: 1.3772025
	speed: 0.0031s/iter; left time: 16.1977s
	iters: 700, epoch: 3 | loss: 0.2447030
	speed: 0.0031s/iter; left time: 16.1122s
	iters: 800, epoch: 3 | loss: 1.3798393
	speed: 0.0032s/iter; left time: 16.1056s
	iters: 900, epoch: 3 | loss: 0.5651863
	speed: 0.0031s/iter; left time: 15.6051s
Updating learning rate to 3.133048295e-05
Validation loss decreased (0.5961 --> 0.5875).  Saving model state dict ...
Epoch: 3 cost time: 3.1610918045043945
Epoch: 3, Steps: 979 | Train Loss: 0.8149125 Vali Loss: 0.5874698 Best vali loss: 0.5874698

best validation loss 0.5874698166009289

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018723076898, 'e_layers': 3, 'learning_rate': 0.0001378593321, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5427821
	speed: 0.0146s/iter; left time: 7.5278s
Updating learning rate to 6.892966605e-05
Epoch: 4 cost time: 1.3157203197479248
Epoch: 4, Steps: 123 | Train Loss: 0.5427821 Vali Loss: 0.5467296 Best vali loss: 0.5434091
	iters: 100, epoch: 5 | loss: 0.6473753
	speed: 0.0119s/iter; left time: 4.6775s
Updating learning rate to 4.2551424854206604e-05
Validation loss decreased (0.5434 --> 0.5387).  Saving model state dict ...
Epoch: 5 cost time: 0.9869387149810791
Epoch: 5, Steps: 123 | Train Loss: 0.6473753 Vali Loss: 0.5387180 Best vali loss: 0.5387180
	iters: 100, epoch: 6 | loss: 0.5947347
	speed: 0.0125s/iter; left time: 3.3680s
Updating learning rate to 2.018903176112086e-05
Validation loss decreased (0.5387 --> 0.5331).  Saving model state dict ...
Epoch: 6 cost time: 0.9962258338928223
Epoch: 6, Steps: 123 | Train Loss: 0.5947347 Vali Loss: 0.5330745 Best vali loss: 0.5330745
	iters: 100, epoch: 7 | loss: 0.8241439
	speed: 0.0126s/iter; left time: 1.8501s
Updating learning rate to 5.246958403566888e-06
Epoch: 7 cost time: 1.0049571990966797
Epoch: 7, Steps: 123 | Train Loss: 0.8241439 Vali Loss: 0.5387384 Best vali loss: 0.5330745
	iters: 100, epoch: 8 | loss: 0.6762587
	speed: 0.0119s/iter; left time: 0.2865s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9924426078796387
Epoch: 8, Steps: 123 | Train Loss: 0.6762587 Vali Loss: 0.5335581 Best vali loss: 0.5330745

best validation loss 0.5330744628440667

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0009148186297, 'e_layers': 2, 'learning_rate': 0.001638045288, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1901034
	speed: 0.0102s/iter; left time: 9.0411s
Updating learning rate to 0.001575700901454878
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.8459219932556152
Epoch: 1, Steps: 123 | Train Loss: 1.1901034 Vali Loss: 0.6047707 Best vali loss: 0.6047707
	iters: 100, epoch: 2 | loss: 0.8471038
	speed: 0.0076s/iter; left time: 5.7557s
Updating learning rate to 0.0013981591095177355
Validation loss decreased (0.6048 --> 0.5998).  Saving model state dict ...
Epoch: 2 cost time: 0.6063272953033447
Epoch: 2, Steps: 123 | Train Loss: 0.8471038 Vali Loss: 0.5998171 Best vali loss: 0.5998171
	iters: 100, epoch: 3 | loss: 1.0420939
	speed: 0.0075s/iter; left time: 4.7851s
Updating learning rate to 0.001132449040590651
Epoch: 3 cost time: 0.5759451389312744
Epoch: 3, Steps: 123 | Train Loss: 1.0420939 Vali Loss: 0.6132121 Best vali loss: 0.5998171
	iters: 100, epoch: 4 | loss: 0.7790731
	speed: 0.0074s/iter; left time: 3.8130s
Updating learning rate to 0.000819022644
Epoch: 4 cost time: 0.5787692070007324
Epoch: 4, Steps: 123 | Train Loss: 0.7790731 Vali Loss: 0.6112670 Best vali loss: 0.5998171
	iters: 100, epoch: 5 | loss: 0.7407259
	speed: 0.0074s/iter; left time: 2.8946s
Updating learning rate to 0.0005055962474093491
Epoch: 5 cost time: 0.5795180797576904
Epoch: 5, Steps: 123 | Train Loss: 0.7407259 Vali Loss: 0.6255753 Best vali loss: 0.5998171
	iters: 100, epoch: 6 | loss: 0.7381690
	speed: 0.0075s/iter; left time: 2.0376s
Updating learning rate to 0.00023988617848226445
Epoch: 6 cost time: 0.5993225574493408
Epoch: 6, Steps: 123 | Train Loss: 0.7381690 Vali Loss: 0.6186933 Best vali loss: 0.5998171
	iters: 100, epoch: 7 | loss: 0.8071463
	speed: 0.0075s/iter; left time: 1.1058s
Updating learning rate to 6.234438654512197e-05
Epoch: 7 cost time: 0.5858092308044434
Epoch: 7, Steps: 123 | Train Loss: 0.8071463 Vali Loss: 0.6206341 Best vali loss: 0.5998171
	iters: 100, epoch: 8 | loss: 0.5301908
	speed: 0.0074s/iter; left time: 0.1783s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5812559127807617
Epoch: 8, Steps: 123 | Train Loss: 0.5301908 Vali Loss: 0.6264535 Best vali loss: 0.5998171

best validation loss 0.5998171071992986

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488717986, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744619
	speed: 0.0115s/iter; left time: 10.1976s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0189580917358398
Epoch: 1, Steps: 123 | Train Loss: 0.7744619 Vali Loss: 0.6173000 Best vali loss: 0.6173000
	iters: 100, epoch: 2 | loss: 0.9486355
	speed: 0.0091s/iter; left time: 6.9433s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5708).  Saving model state dict ...
Epoch: 2 cost time: 0.7164633274078369
Epoch: 2, Steps: 123 | Train Loss: 0.9486355 Vali Loss: 0.5708126 Best vali loss: 0.5708126
	iters: 100, epoch: 3 | loss: 0.8464749
	speed: 0.0093s/iter; left time: 5.9722s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5708 --> 0.5479).  Saving model state dict ...
Epoch: 3 cost time: 0.717090368270874
Epoch: 3, Steps: 123 | Train Loss: 0.8464749 Vali Loss: 0.5478885 Best vali loss: 0.5478885
	iters: 100, epoch: 4 | loss: 0.4891837
	speed: 0.0092s/iter; left time: 4.7319s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5479 --> 0.5381).  Saving model state dict ...
Epoch: 4 cost time: 0.7146005630493164
Epoch: 4, Steps: 123 | Train Loss: 0.4891837 Vali Loss: 0.5380577 Best vali loss: 0.5380577
	iters: 100, epoch: 5 | loss: 0.5555906
	speed: 0.0091s/iter; left time: 3.5930s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5381 --> 0.5215).  Saving model state dict ...
Epoch: 5 cost time: 0.715374231338501
Epoch: 5, Steps: 123 | Train Loss: 0.5555906 Vali Loss: 0.5215249 Best vali loss: 0.5215249
	iters: 100, epoch: 6 | loss: 0.5862713
	speed: 0.0092s/iter; left time: 2.4804s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7153482437133789
Epoch: 6, Steps: 123 | Train Loss: 0.5862713 Vali Loss: 0.5384878 Best vali loss: 0.5215249
	iters: 100, epoch: 7 | loss: 0.5412305
	speed: 0.0090s/iter; left time: 1.3190s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7107934951782227
Epoch: 7, Steps: 123 | Train Loss: 0.5412305 Vali Loss: 0.5423332 Best vali loss: 0.5215249
	iters: 100, epoch: 8 | loss: 0.6952995
	speed: 0.0089s/iter; left time: 0.2147s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.708808422088623
Epoch: 8, Steps: 123 | Train Loss: 0.6952995 Vali Loss: 0.5490463 Best vali loss: 0.5215249

best validation loss 0.5215249111232025

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.002616377629, 'e_layers': 2, 'learning_rate': 0.0003454126704, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0700848
	speed: 0.0098s/iter; left time: 18.2109s
	iters: 200, epoch: 1 | loss: 0.7779168
	speed: 0.0038s/iter; left time: 6.6529s
Updating learning rate to 0.0003322661834263136
Validation loss decreased (inf --> 0.6123).  Saving model state dict ...
Epoch: 1 cost time: 1.2576625347137451
Epoch: 1, Steps: 245 | Train Loss: 0.9240008 Vali Loss: 0.6123297 Best vali loss: 0.6123297
	iters: 100, epoch: 2 | loss: 0.6725366
	speed: 0.0081s/iter; left time: 13.0670s
	iters: 200, epoch: 2 | loss: 1.5563709
	speed: 0.0039s/iter; left time: 5.9601s
Updating learning rate to 0.00029482815597379694
Epoch: 2 cost time: 1.0216948986053467
Epoch: 2, Steps: 245 | Train Loss: 1.1144537 Vali Loss: 0.6156459 Best vali loss: 0.6123297
	iters: 100, epoch: 3 | loss: 0.4734602
	speed: 0.0081s/iter; left time: 11.0646s
	iters: 200, epoch: 3 | loss: 0.6882793
	speed: 0.0038s/iter; left time: 4.8110s
Updating learning rate to 0.00023879818834553174
Validation loss decreased (0.6123 --> 0.6122).  Saving model state dict ...
Epoch: 3 cost time: 0.9781613349914551
Epoch: 3, Steps: 245 | Train Loss: 0.5808697 Vali Loss: 0.6121813 Best vali loss: 0.6121813

best validation loss 0.6121812956524028

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043945884032, 'e_layers': 3, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6235374
	speed: 0.0140s/iter; left time: 12.3912s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.5939).  Saving model state dict ...
Epoch: 1 cost time: 1.3088700771331787
Epoch: 1, Steps: 123 | Train Loss: 0.6235374 Vali Loss: 0.5939356 Best vali loss: 0.5939356
	iters: 100, epoch: 2 | loss: 0.7117559
	speed: 0.0123s/iter; left time: 9.3788s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.5939 --> 0.5644).  Saving model state dict ...
Epoch: 2 cost time: 0.9962360858917236
Epoch: 2, Steps: 123 | Train Loss: 0.7117559 Vali Loss: 0.5643973 Best vali loss: 0.5643973
	iters: 100, epoch: 3 | loss: 0.6412293
	speed: 0.0125s/iter; left time: 7.9668s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.5644 --> 0.5569).  Saving model state dict ...
Epoch: 3 cost time: 0.9959497451782227
Epoch: 3, Steps: 123 | Train Loss: 0.6412293 Vali Loss: 0.5569295 Best vali loss: 0.5569295

best validation loss 0.5569295185354781

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015645780147, 'e_layers': 3, 'learning_rate': 0.0004716473632, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6481908
	speed: 0.0107s/iter; left time: 19.8281s
	iters: 200, epoch: 1 | loss: 0.5491014
	speed: 0.0047s/iter; left time: 8.2560s
Updating learning rate to 0.0004716473632
Validation loss decreased (inf --> 0.6196).  Saving model state dict ...
Epoch: 1 cost time: 1.4753022193908691
Epoch: 1, Steps: 245 | Train Loss: 0.5986461 Vali Loss: 0.6195519 Best vali loss: 0.6195519
	iters: 100, epoch: 2 | loss: 0.7916194
	speed: 0.0093s/iter; left time: 15.0840s
	iters: 200, epoch: 2 | loss: 0.8584719
	speed: 0.0046s/iter; left time: 6.9281s
Updating learning rate to 0.0002358236816
Validation loss decreased (0.6196 --> 0.6003).  Saving model state dict ...
Epoch: 2 cost time: 1.1546614170074463
Epoch: 2, Steps: 245 | Train Loss: 0.8250456 Vali Loss: 0.6002551 Best vali loss: 0.6002551
	iters: 100, epoch: 3 | loss: 0.9042371
	speed: 0.0094s/iter; left time: 12.8302s
	iters: 200, epoch: 3 | loss: 0.9360625
	speed: 0.0047s/iter; left time: 6.0065s
Updating learning rate to 0.0001179118408
Validation loss decreased (0.6003 --> 0.5584).  Saving model state dict ...
Epoch: 3 cost time: 1.1841151714324951
Epoch: 3, Steps: 245 | Train Loss: 0.9201498 Vali Loss: 0.5583586 Best vali loss: 0.5583586

best validation loss 0.558358561821637

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043945884032, 'e_layers': 3, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5362199
	speed: 0.0142s/iter; left time: 7.3255s
Updating learning rate to 8.79643783e-05
Epoch: 4 cost time: 1.3026409149169922
Epoch: 4, Steps: 123 | Train Loss: 0.5362199 Vali Loss: 0.5764611 Best vali loss: 0.5569295
	iters: 100, epoch: 5 | loss: 0.6433226
	speed: 0.0119s/iter; left time: 4.6572s
Updating learning rate to 5.430186808629478e-05
Epoch: 5 cost time: 0.9898309707641602
Epoch: 5, Steps: 123 | Train Loss: 0.6433226 Vali Loss: 0.5588461 Best vali loss: 0.5569295
	iters: 100, epoch: 6 | loss: 0.5861893
	speed: 0.0119s/iter; left time: 3.2033s
Updating learning rate to 2.5764169901211216e-05
Validation loss decreased (0.5569 --> 0.5563).  Saving model state dict ...
Epoch: 6 cost time: 0.9869825839996338
Epoch: 6, Steps: 123 | Train Loss: 0.5861893 Vali Loss: 0.5562639 Best vali loss: 0.5562639
	iters: 100, epoch: 7 | loss: 0.8150945
	speed: 0.0125s/iter; left time: 1.8315s
Updating learning rate to 6.695889598550024e-06
Epoch: 7 cost time: 0.9954636096954346
Epoch: 7, Steps: 123 | Train Loss: 0.8150945 Vali Loss: 0.5683532 Best vali loss: 0.5562639
	iters: 100, epoch: 8 | loss: 0.6675156
	speed: 0.0119s/iter; left time: 0.2863s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9936485290527344
Epoch: 8, Steps: 123 | Train Loss: 0.6675156 Vali Loss: 0.5598577 Best vali loss: 0.5562639

best validation loss 0.5562639499030583

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0016577593456, 'e_layers': 4, 'learning_rate': 0.0002380535596, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8088387
	speed: 0.0109s/iter; left time: 84.4607s
	iters: 200, epoch: 1 | loss: 0.3760858
	speed: 0.0050s/iter; left time: 38.5011s
	iters: 300, epoch: 1 | loss: 0.4246050
	speed: 0.0051s/iter; left time: 38.2171s
	iters: 400, epoch: 1 | loss: 0.5420058
	speed: 0.0050s/iter; left time: 37.2057s
	iters: 500, epoch: 1 | loss: 0.3675980
	speed: 0.0050s/iter; left time: 36.8358s
	iters: 600, epoch: 1 | loss: 0.3877600
	speed: 0.0050s/iter; left time: 36.2164s
	iters: 700, epoch: 1 | loss: 0.4186493
	speed: 0.0051s/iter; left time: 36.1209s
	iters: 800, epoch: 1 | loss: 0.3970968
	speed: 0.0050s/iter; left time: 35.1474s
	iters: 900, epoch: 1 | loss: 0.3644388
	speed: 0.0050s/iter; left time: 34.3957s
Updating learning rate to 0.0002380535596
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 5.245999097824097
Epoch: 1, Steps: 979 | Train Loss: 0.4541198 Vali Loss: 0.6066890 Best vali loss: 0.6066890
	iters: 100, epoch: 2 | loss: 1.1019070
	speed: 0.0151s/iter; left time: 102.0478s
	iters: 200, epoch: 2 | loss: 0.3892611
	speed: 0.0048s/iter; left time: 31.6728s
	iters: 300, epoch: 2 | loss: 0.2282711
	speed: 0.0048s/iter; left time: 31.2491s
	iters: 400, epoch: 2 | loss: 0.2954298
	speed: 0.0047s/iter; left time: 30.3118s
	iters: 500, epoch: 2 | loss: 1.3568044
	speed: 0.0049s/iter; left time: 31.3763s
	iters: 600, epoch: 2 | loss: 0.4335401
	speed: 0.0050s/iter; left time: 31.2846s
	iters: 700, epoch: 2 | loss: 0.3769259
	speed: 0.0048s/iter; left time: 29.2532s
	iters: 800, epoch: 2 | loss: 0.4375160
	speed: 0.0046s/iter; left time: 28.0393s
	iters: 900, epoch: 2 | loss: 0.7752181
	speed: 0.0045s/iter; left time: 27.0624s
Updating learning rate to 0.0001190267798
Validation loss decreased (0.6067 --> 0.6041).  Saving model state dict ...
Epoch: 2 cost time: 4.68612003326416
Epoch: 2, Steps: 979 | Train Loss: 0.5994304 Vali Loss: 0.6041219 Best vali loss: 0.6041219
	iters: 100, epoch: 3 | loss: 0.5006595
	speed: 0.0149s/iter; left time: 86.0118s
	iters: 200, epoch: 3 | loss: 0.9209507
	speed: 0.0051s/iter; left time: 28.6841s
	iters: 300, epoch: 3 | loss: 0.2914795
	speed: 0.0050s/iter; left time: 27.9312s
	iters: 400, epoch: 3 | loss: 1.4690834
	speed: 0.0050s/iter; left time: 27.4911s
	iters: 500, epoch: 3 | loss: 0.8942665
	speed: 0.0050s/iter; left time: 26.7237s
	iters: 600, epoch: 3 | loss: 0.7350770
	speed: 0.0050s/iter; left time: 26.4430s
	iters: 700, epoch: 3 | loss: 0.3196134
	speed: 0.0051s/iter; left time: 26.2592s
	iters: 800, epoch: 3 | loss: 0.7794890
	speed: 0.0051s/iter; left time: 25.7064s
	iters: 900, epoch: 3 | loss: 0.4626642
	speed: 0.0050s/iter; left time: 24.9385s
Updating learning rate to 5.95133899e-05
Validation loss decreased (0.6041 --> 0.5986).  Saving model state dict ...
Epoch: 3 cost time: 4.976612567901611
Epoch: 3, Steps: 979 | Train Loss: 0.7081426 Vali Loss: 0.5986069 Best vali loss: 0.5986069
	iters: 100, epoch: 4 | loss: 0.8249865
	speed: 0.0152s/iter; left time: 72.6828s
	iters: 200, epoch: 4 | loss: 1.2110448
	speed: 0.0051s/iter; left time: 23.8366s
	iters: 300, epoch: 4 | loss: 0.6067060
	speed: 0.0050s/iter; left time: 23.0650s
	iters: 400, epoch: 4 | loss: 0.7377877
	speed: 0.0050s/iter; left time: 22.6269s
	iters: 500, epoch: 4 | loss: 0.8574756
	speed: 0.0049s/iter; left time: 21.7185s
	iters: 600, epoch: 4 | loss: 0.8624818
	speed: 0.0049s/iter; left time: 20.8686s
	iters: 700, epoch: 4 | loss: 1.0572382
	speed: 0.0045s/iter; left time: 18.6764s
	iters: 800, epoch: 4 | loss: 0.7587526
	speed: 0.0046s/iter; left time: 18.9494s
	iters: 900, epoch: 4 | loss: 0.7044696
	speed: 0.0047s/iter; left time: 18.8227s
Updating learning rate to 2.975669495e-05
Epoch: 4 cost time: 4.79578423500061
Epoch: 4, Steps: 979 | Train Loss: 0.8467714 Vali Loss: 0.6005501 Best vali loss: 0.5986069
	iters: 100, epoch: 5 | loss: 0.7607041
	speed: 0.0146s/iter; left time: 55.6244s
	iters: 200, epoch: 5 | loss: 0.9772478
	speed: 0.0047s/iter; left time: 17.4679s
	iters: 300, epoch: 5 | loss: 1.0737863
	speed: 0.0047s/iter; left time: 16.9943s
	iters: 400, epoch: 5 | loss: 1.2677194
	speed: 0.0047s/iter; left time: 16.6760s
	iters: 500, epoch: 5 | loss: 1.5313264
	speed: 0.0046s/iter; left time: 15.8258s
	iters: 600, epoch: 5 | loss: 0.5498214
	speed: 0.0046s/iter; left time: 15.1953s
	iters: 700, epoch: 5 | loss: 0.9547437
	speed: 0.0047s/iter; left time: 15.1098s
	iters: 800, epoch: 5 | loss: 0.7452944
	speed: 0.0046s/iter; left time: 14.2332s
	iters: 900, epoch: 5 | loss: 0.6829021
	speed: 0.0046s/iter; left time: 13.8377s
Updating learning rate to 1.4878347475e-05
Validation loss decreased (0.5986 --> 0.5934).  Saving model state dict ...
Epoch: 5 cost time: 4.5793938636779785
Epoch: 5, Steps: 979 | Train Loss: 0.9492828 Vali Loss: 0.5934018 Best vali loss: 0.5934018
	iters: 100, epoch: 6 | loss: 1.3739884
	speed: 0.0151s/iter; left time: 42.9424s
	iters: 200, epoch: 6 | loss: 0.7639589
	speed: 0.0051s/iter; left time: 13.9266s
	iters: 300, epoch: 6 | loss: 0.5926407
	speed: 0.0051s/iter; left time: 13.5381s
	iters: 400, epoch: 6 | loss: 0.7910304
	speed: 0.0052s/iter; left time: 13.0871s
	iters: 500, epoch: 6 | loss: 0.7349696
	speed: 0.0052s/iter; left time: 12.6382s
	iters: 600, epoch: 6 | loss: 1.8298553
	speed: 0.0052s/iter; left time: 12.0676s
	iters: 700, epoch: 6 | loss: 0.8042154
	speed: 0.0051s/iter; left time: 11.4827s
	iters: 800, epoch: 6 | loss: 0.7058682
	speed: 0.0051s/iter; left time: 10.9876s
	iters: 900, epoch: 6 | loss: 0.4610487
	speed: 0.0051s/iter; left time: 10.4940s
Updating learning rate to 7.4391737375e-06
Validation loss decreased (0.5934 --> 0.5874).  Saving model state dict ...
Epoch: 6 cost time: 5.043264389038086
Epoch: 6, Steps: 979 | Train Loss: 0.8952862 Vali Loss: 0.5874045 Best vali loss: 0.5874045
	iters: 100, epoch: 7 | loss: 0.3014856
	speed: 0.0150s/iter; left time: 27.8755s
	iters: 200, epoch: 7 | loss: 0.5161906
	speed: 0.0048s/iter; left time: 8.3899s
	iters: 300, epoch: 7 | loss: 0.4974206
	speed: 0.0048s/iter; left time: 7.9286s
	iters: 400, epoch: 7 | loss: 1.2027800
	speed: 0.0047s/iter; left time: 7.3619s
	iters: 500, epoch: 7 | loss: 0.3485189
	speed: 0.0047s/iter; left time: 6.9244s
	iters: 600, epoch: 7 | loss: 0.9952585
	speed: 0.0046s/iter; left time: 6.2274s
	iters: 700, epoch: 7 | loss: 1.1442554
	speed: 0.0046s/iter; left time: 5.7896s
	iters: 800, epoch: 7 | loss: 1.2445832
	speed: 0.0046s/iter; left time: 5.2827s
	iters: 900, epoch: 7 | loss: 0.6125203
	speed: 0.0044s/iter; left time: 4.6636s
Updating learning rate to 3.71958686875e-06
Validation loss decreased (0.5874 --> 0.5864).  Saving model state dict ...
Epoch: 7 cost time: 4.60123872756958
Epoch: 7, Steps: 979 | Train Loss: 0.7625570 Vali Loss: 0.5864021 Best vali loss: 0.5864021
	iters: 100, epoch: 8 | loss: 1.0992296
	speed: 0.0143s/iter; left time: 12.6142s
	iters: 200, epoch: 8 | loss: 0.9906221
	speed: 0.0045s/iter; left time: 3.4966s
	iters: 300, epoch: 8 | loss: 0.9592161
	speed: 0.0044s/iter; left time: 2.9793s
	iters: 400, epoch: 8 | loss: 0.3383539
	speed: 0.0043s/iter; left time: 2.4844s
	iters: 500, epoch: 8 | loss: 0.8834859
	speed: 0.0043s/iter; left time: 2.0543s
	iters: 600, epoch: 8 | loss: 1.3832104
	speed: 0.0046s/iter; left time: 1.7349s
	iters: 700, epoch: 8 | loss: 0.8935153
	speed: 0.0046s/iter; left time: 1.3019s
	iters: 800, epoch: 8 | loss: 0.7814037
	speed: 0.0046s/iter; left time: 0.8302s
	iters: 900, epoch: 8 | loss: 0.9159329
	speed: 0.0046s/iter; left time: 0.3673s
Updating learning rate to 1.859793434375e-06
Validation loss decreased (0.5864 --> 0.5842).  Saving model state dict ...
Epoch: 8 cost time: 4.451752185821533
Epoch: 8, Steps: 979 | Train Loss: 0.9161078 Vali Loss: 0.5841980 Best vali loss: 0.5841980

best validation loss 0.5841980118654437

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017512660598, 'e_layers': 4, 'learning_rate': 0.0004717556308, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8478773
	speed: 0.0119s/iter; left time: 22.2129s
	iters: 200, epoch: 1 | loss: 0.7841901
	speed: 0.0051s/iter; left time: 8.9849s
Updating learning rate to 0.0004538005012215356
Validation loss decreased (inf --> 0.6054).  Saving model state dict ...
Epoch: 1 cost time: 1.600830078125
Epoch: 1, Steps: 245 | Train Loss: 0.8160337 Vali Loss: 0.6054079 Best vali loss: 0.6054079
	iters: 100, epoch: 2 | loss: 0.7533308
	speed: 0.0104s/iter; left time: 16.8627s
	iters: 200, epoch: 2 | loss: 1.0246909
	speed: 0.0054s/iter; left time: 8.1408s
Updating learning rate to 0.00040266861820080865
Epoch: 2 cost time: 1.3398144245147705
Epoch: 2, Steps: 245 | Train Loss: 0.8890108 Vali Loss: 0.6223667 Best vali loss: 0.6054079
	iters: 100, epoch: 3 | loss: 0.6639326
	speed: 0.0105s/iter; left time: 14.4236s
	iters: 200, epoch: 3 | loss: 0.8328563
	speed: 0.0051s/iter; left time: 6.5449s
Updating learning rate to 0.00032614434741605106
Epoch: 3 cost time: 1.349273681640625
Epoch: 3, Steps: 245 | Train Loss: 0.7483944 Vali Loss: 0.6085298 Best vali loss: 0.6054079
	iters: 100, epoch: 4 | loss: 0.9048018
	speed: 0.0110s/iter; left time: 12.4106s
	iters: 200, epoch: 4 | loss: 0.9312260
	speed: 0.0052s/iter; left time: 5.3200s
Updating learning rate to 0.0002358778154
Validation loss decreased (0.6054 --> 0.6038).  Saving model state dict ...
Epoch: 4 cost time: 1.3917808532714844
Epoch: 4, Steps: 245 | Train Loss: 0.9180139 Vali Loss: 0.6038142 Best vali loss: 0.6038142
	iters: 100, epoch: 5 | loss: 1.0456635
	speed: 0.0110s/iter; left time: 9.6479s
	iters: 200, epoch: 5 | loss: 1.0478685
	speed: 0.0058s/iter; left time: 4.5284s
Updating learning rate to 0.00014561128338394898
Epoch: 5 cost time: 1.4487755298614502
Epoch: 5, Steps: 245 | Train Loss: 1.0467660 Vali Loss: 0.6525922 Best vali loss: 0.6038142
	iters: 100, epoch: 6 | loss: 0.4160618
	speed: 0.0106s/iter; left time: 6.7683s
	iters: 200, epoch: 6 | loss: 0.5557753
	speed: 0.0052s/iter; left time: 2.7722s
Updating learning rate to 6.908701259919137e-05
Epoch: 6 cost time: 1.3072175979614258
Epoch: 6, Steps: 245 | Train Loss: 0.4859186 Vali Loss: 0.6194542 Best vali loss: 0.6038142
	iters: 100, epoch: 7 | loss: 0.7727702
	speed: 0.0109s/iter; left time: 4.2453s
	iters: 200, epoch: 7 | loss: 0.6181557
	speed: 0.0053s/iter; left time: 1.5356s
Updating learning rate to 1.7955129578464407e-05
Epoch: 7 cost time: 1.3597385883331299
Epoch: 7, Steps: 245 | Train Loss: 0.6954630 Vali Loss: 0.6415911 Best vali loss: 0.6038142
	iters: 100, epoch: 8 | loss: 0.7066722
	speed: 0.0104s/iter; left time: 1.5249s
	iters: 200, epoch: 8 | loss: 0.5671771
	speed: 0.0053s/iter; left time: 0.2452s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3518047332763672
Epoch: 8, Steps: 245 | Train Loss: 0.6369247 Vali Loss: 0.6380334 Best vali loss: 0.6038142

best validation loss 0.6038142401881926

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.002442240319, 'e_layers': 4, 'learning_rate': 8.41699045e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.41699045e-05
Validation loss decreased (inf --> 0.6538).  Saving model state dict ...
Epoch: 1 cost time: 0.7950916290283203
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6537926 Best vali loss: 0.6537926
Updating learning rate to 4.208495225e-05
Validation loss decreased (0.6538 --> 0.6250).  Saving model state dict ...
Epoch: 2 cost time: 0.5082066059112549
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6250305 Best vali loss: 0.6250305
Updating learning rate to 2.1042476125e-05
Validation loss decreased (0.6250 --> 0.6201).  Saving model state dict ...
Epoch: 3 cost time: 0.49669814109802246
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6201389 Best vali loss: 0.6201389

best validation loss 0.6201389455949747

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0022734391568, 'e_layers': 1, 'learning_rate': 0.0002840468134, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002840468134
Validation loss decreased (inf --> 0.6797).  Saving model state dict ...
Epoch: 1 cost time: 0.7368271350860596
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6796540 Best vali loss: 0.6796540
Updating learning rate to 0.0001420234067
Validation loss decreased (0.6797 --> 0.6532).  Saving model state dict ...
Epoch: 2 cost time: 0.4242887496948242
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6532289 Best vali loss: 0.6532289
Updating learning rate to 7.101170335e-05
Validation loss decreased (0.6532 --> 0.6424).  Saving model state dict ...
Epoch: 3 cost time: 0.41326236724853516
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6424491 Best vali loss: 0.6424491

best validation loss 0.6424490631261064

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043969911079, 'e_layers': 3, 'learning_rate': 0.0001504310551, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6230243
	speed: 0.0138s/iter; left time: 12.2208s
Updating learning rate to 0.0001447056139804838
Validation loss decreased (inf --> 0.5947).  Saving model state dict ...
Epoch: 1 cost time: 1.2909138202667236
Epoch: 1, Steps: 123 | Train Loss: 0.6230243 Vali Loss: 0.5946702 Best vali loss: 0.5946702
	iters: 100, epoch: 2 | loss: 0.7205008
	speed: 0.0121s/iter; left time: 9.2512s
Updating learning rate to 0.0001284009371311286
Validation loss decreased (0.5947 --> 0.5876).  Saving model state dict ...
Epoch: 2 cost time: 0.9913506507873535
Epoch: 2, Steps: 123 | Train Loss: 0.7205008 Vali Loss: 0.5876020 Best vali loss: 0.5876020
	iters: 100, epoch: 3 | loss: 0.6342025
	speed: 0.0124s/iter; left time: 7.9066s
Updating learning rate to 0.00010399926379998498
Validation loss decreased (0.5876 --> 0.5506).  Saving model state dict ...
Epoch: 3 cost time: 0.9889400005340576
Epoch: 3, Steps: 123 | Train Loss: 0.6342025 Vali Loss: 0.5505903 Best vali loss: 0.5505903

best validation loss 0.5505902927432663

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043969911079, 'e_layers': 3, 'learning_rate': 0.0001504310551, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5390267
	speed: 0.0143s/iter; left time: 7.3999s
Updating learning rate to 7.521552755e-05
Epoch: 4 cost time: 1.28432035446167
Epoch: 4, Steps: 123 | Train Loss: 0.5390267 Vali Loss: 0.5523159 Best vali loss: 0.5505903
	iters: 100, epoch: 5 | loss: 0.6539301
	speed: 0.0119s/iter; left time: 4.6659s
Updating learning rate to 4.643179130001503e-05
Validation loss decreased (0.5506 --> 0.5491).  Saving model state dict ...
Epoch: 5 cost time: 0.9921436309814453
Epoch: 5, Steps: 123 | Train Loss: 0.6539301 Vali Loss: 0.5490629 Best vali loss: 0.5490629
	iters: 100, epoch: 6 | loss: 0.5919313
	speed: 0.0126s/iter; left time: 3.3889s
Updating learning rate to 2.2030117968871417e-05
Validation loss decreased (0.5491 --> 0.5430).  Saving model state dict ...
Epoch: 6 cost time: 0.9929077625274658
Epoch: 6, Steps: 123 | Train Loss: 0.5919313 Vali Loss: 0.5430282 Best vali loss: 0.5430282
	iters: 100, epoch: 7 | loss: 0.8257744
	speed: 0.0125s/iter; left time: 1.8348s
Updating learning rate to 5.725441119516191e-06
Epoch: 7 cost time: 0.9937875270843506
Epoch: 7, Steps: 123 | Train Loss: 0.8257744 Vali Loss: 0.5448711 Best vali loss: 0.5430282
	iters: 100, epoch: 8 | loss: 0.6769460
	speed: 0.0120s/iter; left time: 0.2870s
Updating learning rate to 0.0
Validation loss decreased (0.5430 --> 0.5429).  Saving model state dict ...
Epoch: 8 cost time: 0.9970700740814209
Epoch: 8, Steps: 123 | Train Loss: 0.6769460 Vali Loss: 0.5428782 Best vali loss: 0.5428782

best validation loss 0.5428781954296646

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0026687489151, 'e_layers': 3, 'learning_rate': 0.0003505408775, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6629604
	speed: 0.0109s/iter; left time: 41.6410s
	iters: 200, epoch: 1 | loss: 0.8626907
	speed: 0.0046s/iter; left time: 16.9769s
	iters: 300, epoch: 1 | loss: 0.4012384
	speed: 0.0046s/iter; left time: 16.5859s
	iters: 400, epoch: 1 | loss: 1.0011537
	speed: 0.0046s/iter; left time: 16.1229s
Updating learning rate to 0.0003505408775
Validation loss decreased (inf --> 0.6207).  Saving model state dict ...
Epoch: 1 cost time: 2.6006972789764404
Epoch: 1, Steps: 490 | Train Loss: 0.7320108 Vali Loss: 0.6207476 Best vali loss: 0.6207476
	iters: 100, epoch: 2 | loss: 1.0176075
	speed: 0.0126s/iter; left time: 42.1336s
	iters: 200, epoch: 2 | loss: 0.8051062
	speed: 0.0045s/iter; left time: 14.5719s
	iters: 300, epoch: 2 | loss: 0.9713758
	speed: 0.0045s/iter; left time: 14.1220s
	iters: 400, epoch: 2 | loss: 0.7526466
	speed: 0.0046s/iter; left time: 13.8722s
Updating learning rate to 0.00017527043875
Validation loss decreased (0.6207 --> 0.6139).  Saving model state dict ...
Epoch: 2 cost time: 2.271393060684204
Epoch: 2, Steps: 490 | Train Loss: 0.8866840 Vali Loss: 0.6138934 Best vali loss: 0.6138934
	iters: 100, epoch: 3 | loss: 1.5396601
	speed: 0.0129s/iter; left time: 36.6991s
	iters: 200, epoch: 3 | loss: 0.7604707
	speed: 0.0043s/iter; left time: 11.6883s
	iters: 300, epoch: 3 | loss: 0.9946526
	speed: 0.0043s/iter; left time: 11.3672s
	iters: 400, epoch: 3 | loss: 0.6545300
	speed: 0.0043s/iter; left time: 10.8388s
Updating learning rate to 8.7635219375e-05
Epoch: 3 cost time: 2.2028892040252686
Epoch: 3, Steps: 490 | Train Loss: 0.9873284 Vali Loss: 0.6420843 Best vali loss: 0.6138934
	iters: 100, epoch: 4 | loss: 0.7355407
	speed: 0.0122s/iter; left time: 28.5708s
	iters: 200, epoch: 4 | loss: 1.0703715
	speed: 0.0046s/iter; left time: 10.2902s
	iters: 300, epoch: 4 | loss: 1.2908003
	speed: 0.0046s/iter; left time: 9.9089s
	iters: 400, epoch: 4 | loss: 0.5052555
	speed: 0.0045s/iter; left time: 9.1466s
Updating learning rate to 4.38176096875e-05
Epoch: 4 cost time: 2.2508108615875244
Epoch: 4, Steps: 490 | Train Loss: 0.9004920 Vali Loss: 0.6313727 Best vali loss: 0.6138934
	iters: 100, epoch: 5 | loss: 0.6015086
	speed: 0.0120s/iter; left time: 22.2771s
	iters: 200, epoch: 5 | loss: 1.3148733
	speed: 0.0046s/iter; left time: 8.1375s
	iters: 300, epoch: 5 | loss: 0.5897115
	speed: 0.0047s/iter; left time: 7.7335s
	iters: 400, epoch: 5 | loss: 0.6950681
	speed: 0.0046s/iter; left time: 7.2272s
Updating learning rate to 2.190880484375e-05
Epoch: 5 cost time: 2.293041229248047
Epoch: 5, Steps: 490 | Train Loss: 0.8002904 Vali Loss: 0.6188206 Best vali loss: 0.6138934
	iters: 100, epoch: 6 | loss: 1.5067703
	speed: 0.0119s/iter; left time: 16.3821s
	iters: 200, epoch: 6 | loss: 0.8086971
	speed: 0.0043s/iter; left time: 5.4609s
	iters: 300, epoch: 6 | loss: 1.0702980
	speed: 0.0044s/iter; left time: 5.1297s
	iters: 400, epoch: 6 | loss: 0.9876465
	speed: 0.0045s/iter; left time: 4.8718s
Updating learning rate to 1.0954402421875e-05
Epoch: 6 cost time: 2.2101824283599854
Epoch: 6, Steps: 490 | Train Loss: 1.0933530 Vali Loss: 0.6266559 Best vali loss: 0.6138934
	iters: 100, epoch: 7 | loss: 0.6327280
	speed: 0.0125s/iter; left time: 11.0556s
	iters: 200, epoch: 7 | loss: 0.4435471
	speed: 0.0046s/iter; left time: 3.6203s
	iters: 300, epoch: 7 | loss: 0.6629720
	speed: 0.0046s/iter; left time: 3.1562s
	iters: 400, epoch: 7 | loss: 0.5989061
	speed: 0.0045s/iter; left time: 2.6310s
Updating learning rate to 5.4772012109375e-06
Epoch: 7 cost time: 2.290431261062622
Epoch: 7, Steps: 490 | Train Loss: 0.5845383 Vali Loss: 0.6276373 Best vali loss: 0.6138934
	iters: 100, epoch: 8 | loss: 0.6780764
	speed: 0.0123s/iter; left time: 4.8045s
	iters: 200, epoch: 8 | loss: 0.6608174
	speed: 0.0046s/iter; left time: 1.3330s
	iters: 300, epoch: 8 | loss: 0.6210350
	speed: 0.0047s/iter; left time: 0.8902s
	iters: 400, epoch: 8 | loss: 1.0212902
	speed: 0.0043s/iter; left time: 0.3922s
Updating learning rate to 2.73860060546875e-06
Epoch: 8 cost time: 2.22774338722229
Epoch: 8, Steps: 490 | Train Loss: 0.7453048 Vali Loss: 0.6267995 Best vali loss: 0.6138934

best validation loss 0.6138934340812386

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0024213944665, 'e_layers': 4, 'learning_rate': 0.0011461524121, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8230975
	speed: 0.0118s/iter; left time: 21.8772s
	iters: 200, epoch: 1 | loss: 0.5939301
	speed: 0.0058s/iter; left time: 10.1365s
Updating learning rate to 0.0011025295833888159
Validation loss decreased (inf --> 0.6341).  Saving model state dict ...
Epoch: 1 cost time: 1.7441844940185547
Epoch: 1, Steps: 245 | Train Loss: 0.7085138 Vali Loss: 0.6341313 Best vali loss: 0.6341313
	iters: 100, epoch: 2 | loss: 0.5494089
	speed: 0.0107s/iter; left time: 17.3538s
	iters: 200, epoch: 2 | loss: 0.9104684
	speed: 0.0053s/iter; left time: 8.0974s
Updating learning rate to 0.0009783022774846142
Validation loss decreased (0.6341 --> 0.6321).  Saving model state dict ...
Epoch: 2 cost time: 1.3610682487487793
Epoch: 2, Steps: 245 | Train Loss: 0.7299386 Vali Loss: 0.6320565 Best vali loss: 0.6320565
	iters: 100, epoch: 3 | loss: 0.9075469
	speed: 0.0111s/iter; left time: 15.2231s
	iters: 200, epoch: 3 | loss: 0.9089925
	speed: 0.0058s/iter; left time: 7.3753s
Updating learning rate to 0.0007923829755879775
Epoch: 3 cost time: 1.4622395038604736
Epoch: 3, Steps: 245 | Train Loss: 0.9082697 Vali Loss: 0.6354033 Best vali loss: 0.6320565
	iters: 100, epoch: 4 | loss: 0.9096842
	speed: 0.0111s/iter; left time: 12.5252s
	iters: 200, epoch: 4 | loss: 1.0631980
	speed: 0.0058s/iter; left time: 5.9096s
Updating learning rate to 0.00057307620605
Epoch: 4 cost time: 1.4561855792999268
Epoch: 4, Steps: 245 | Train Loss: 0.9864411 Vali Loss: 0.6484920 Best vali loss: 0.6320565
	iters: 100, epoch: 5 | loss: 0.7352237
	speed: 0.0110s/iter; left time: 9.7265s
	iters: 200, epoch: 5 | loss: 0.7762329
	speed: 0.0057s/iter; left time: 4.4450s
Updating learning rate to 0.00035376943651202263
Epoch: 5 cost time: 1.448530912399292
Epoch: 5, Steps: 245 | Train Loss: 0.7557283 Vali Loss: 0.6365050 Best vali loss: 0.6320565
	iters: 100, epoch: 6 | loss: 1.0080872
	speed: 0.0113s/iter; left time: 7.2154s
	iters: 200, epoch: 6 | loss: 0.7955310
	speed: 0.0058s/iter; left time: 3.0865s
Updating learning rate to 0.00016785013461538588
Epoch: 6 cost time: 1.4850270748138428
Epoch: 6, Steps: 245 | Train Loss: 0.9018091 Vali Loss: 0.6466606 Best vali loss: 0.6320565
	iters: 100, epoch: 7 | loss: 1.3052212
	speed: 0.0111s/iter; left time: 4.3355s
	iters: 200, epoch: 7 | loss: 1.4311641
	speed: 0.0058s/iter; left time: 1.6963s
Updating learning rate to 4.362282871118417e-05
Epoch: 7 cost time: 1.482224941253662
Epoch: 7, Steps: 245 | Train Loss: 1.3681927 Vali Loss: 0.6410908 Best vali loss: 0.6320565
	iters: 100, epoch: 8 | loss: 0.9732376
	speed: 0.0108s/iter; left time: 1.5697s
	iters: 200, epoch: 8 | loss: 1.2364330
	speed: 0.0054s/iter; left time: 0.2492s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.36979079246521
Epoch: 8, Steps: 245 | Train Loss: 1.1048353 Vali Loss: 0.6423013 Best vali loss: 0.6320565

best validation loss 0.6320565386758475

[INFO][smbo.py:320] Finished 1050 trials.
{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010657134793, 'e_layers': 2, 'learning_rate': 8.19697442e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.884995657578289e-05
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 0.8302407264709473
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6065314 Best vali loss: 0.6065314
Updating learning rate to 6.996555308797334e-05
Validation loss decreased (0.6065 --> 0.5998).  Saving model state dict ...
Epoch: 2 cost time: 0.53836989402771
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5998406 Best vali loss: 0.5998406
Updating learning rate to 5.666910363027221e-05
Validation loss decreased (0.5998 --> 0.5963).  Saving model state dict ...
Epoch: 3 cost time: 0.5432705879211426
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5962585 Best vali loss: 0.5962585

best validation loss 0.5962584928360762

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0060292651759, 'e_layers': 3, 'learning_rate': 0.0003478691891, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6197020
	speed: 0.0111s/iter; left time: 20.6934s
	iters: 200, epoch: 1 | loss: 0.5821660
	speed: 0.0049s/iter; left time: 8.5743s
Updating learning rate to 0.0003478691891
Validation loss decreased (inf --> 0.5653).  Saving model state dict ...
Epoch: 1 cost time: 1.5425477027893066
Epoch: 1, Steps: 245 | Train Loss: 0.6009340 Vali Loss: 0.5652743 Best vali loss: 0.5652743
	iters: 100, epoch: 2 | loss: 0.5745363
	speed: 0.0107s/iter; left time: 17.2199s
	iters: 200, epoch: 2 | loss: 1.2075679
	speed: 0.0053s/iter; left time: 8.0066s
Updating learning rate to 0.00017393459455
Validation loss decreased (0.5653 --> 0.5552).  Saving model state dict ...
Epoch: 2 cost time: 1.3426487445831299
Epoch: 2, Steps: 245 | Train Loss: 0.8910521 Vali Loss: 0.5551521 Best vali loss: 0.5551521
	iters: 100, epoch: 3 | loss: 0.7537876
	speed: 0.0108s/iter; left time: 14.8256s
	iters: 200, epoch: 3 | loss: 0.4844806
	speed: 0.0052s/iter; left time: 6.5957s
Updating learning rate to 8.6967297275e-05
Epoch: 3 cost time: 1.3228328227996826
Epoch: 3, Steps: 245 | Train Loss: 0.6191341 Vali Loss: 0.5704582 Best vali loss: 0.5551521

best validation loss 0.5551521279148789

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010634181407, 'e_layers': 2, 'learning_rate': 8.44706094e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0671229
	speed: 0.0099s/iter; left time: 76.5393s
	iters: 200, epoch: 1 | loss: 1.2428391
	speed: 0.0036s/iter; left time: 27.7621s
	iters: 300, epoch: 1 | loss: 0.8277466
	speed: 0.0036s/iter; left time: 27.3152s
	iters: 400, epoch: 1 | loss: 1.1303906
	speed: 0.0036s/iter; left time: 26.9974s
	iters: 500, epoch: 1 | loss: 0.9001097
	speed: 0.0037s/iter; left time: 26.7872s
	iters: 600, epoch: 1 | loss: 0.7002529
	speed: 0.0036s/iter; left time: 26.2504s
	iters: 700, epoch: 1 | loss: 1.1582124
	speed: 0.0034s/iter; left time: 24.3433s
	iters: 800, epoch: 1 | loss: 0.7489983
	speed: 0.0032s/iter; left time: 22.1607s
	iters: 900, epoch: 1 | loss: 0.7969072
	speed: 0.0032s/iter; left time: 22.4513s
Updating learning rate to 8.44706094e-05
Validation loss decreased (inf --> 0.5885).  Saving model state dict ...
Epoch: 1 cost time: 3.7779712677001953
Epoch: 1, Steps: 979 | Train Loss: 0.9525089 Vali Loss: 0.5884967 Best vali loss: 0.5884967
	iters: 100, epoch: 2 | loss: 0.9985271
	speed: 0.0110s/iter; left time: 74.1127s
	iters: 200, epoch: 2 | loss: 0.8431652
	speed: 0.0030s/iter; left time: 20.0761s
	iters: 300, epoch: 2 | loss: 0.3649748
	speed: 0.0031s/iter; left time: 20.0041s
	iters: 400, epoch: 2 | loss: 0.5674768
	speed: 0.0031s/iter; left time: 20.0399s
	iters: 500, epoch: 2 | loss: 1.0268167
	speed: 0.0031s/iter; left time: 19.5690s
	iters: 600, epoch: 2 | loss: 0.3505510
	speed: 0.0031s/iter; left time: 19.2623s
	iters: 700, epoch: 2 | loss: 0.9374728
	speed: 0.0031s/iter; left time: 19.3555s
	iters: 800, epoch: 2 | loss: 1.1009899
	speed: 0.0031s/iter; left time: 18.5678s
	iters: 900, epoch: 2 | loss: 0.7868236
	speed: 0.0031s/iter; left time: 18.1616s
Updating learning rate to 4.22353047e-05
Epoch: 2 cost time: 3.050276756286621
Epoch: 2, Steps: 979 | Train Loss: 0.7751998 Vali Loss: 0.5953781 Best vali loss: 0.5884967
	iters: 100, epoch: 3 | loss: 0.8268329
	speed: 0.0105s/iter; left time: 60.4431s
	iters: 200, epoch: 3 | loss: 0.5194595
	speed: 0.0031s/iter; left time: 17.5674s
	iters: 300, epoch: 3 | loss: 0.4723271
	speed: 0.0030s/iter; left time: 16.9727s
	iters: 400, epoch: 3 | loss: 0.3399602
	speed: 0.0031s/iter; left time: 17.2108s
	iters: 500, epoch: 3 | loss: 0.9223090
	speed: 0.0032s/iter; left time: 17.1978s
	iters: 600, epoch: 3 | loss: 0.6477500
	speed: 0.0031s/iter; left time: 16.4077s
	iters: 700, epoch: 3 | loss: 0.4601641
	speed: 0.0031s/iter; left time: 15.9771s
	iters: 800, epoch: 3 | loss: 0.2688593
	speed: 0.0031s/iter; left time: 15.5958s
	iters: 900, epoch: 3 | loss: 0.8853423
	speed: 0.0031s/iter; left time: 15.4631s
Updating learning rate to 2.111765235e-05
Validation loss decreased (0.5885 --> 0.5677).  Saving model state dict ...
Epoch: 3 cost time: 3.086057662963867
Epoch: 3, Steps: 979 | Train Loss: 0.5936672 Vali Loss: 0.5677171 Best vali loss: 0.5677171

best validation loss 0.5677171050674769

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0060292651759, 'e_layers': 3, 'learning_rate': 0.0003478691891, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4504099
	speed: 0.0120s/iter; left time: 13.5257s
	iters: 200, epoch: 4 | loss: 0.4086088
	speed: 0.0053s/iter; left time: 5.4442s
Updating learning rate to 4.34836486375e-05
Validation loss decreased (0.5552 --> 0.5420).  Saving model state dict ...
Epoch: 4 cost time: 1.650965929031372
Epoch: 4, Steps: 245 | Train Loss: 0.4295094 Vali Loss: 0.5419667 Best vali loss: 0.5419667
	iters: 100, epoch: 5 | loss: 0.4845006
	speed: 0.0110s/iter; left time: 9.6735s
	iters: 200, epoch: 5 | loss: 1.0346421
	speed: 0.0053s/iter; left time: 4.1417s
Updating learning rate to 2.174182431875e-05
Epoch: 5 cost time: 1.3296689987182617
Epoch: 5, Steps: 245 | Train Loss: 0.7595714 Vali Loss: 0.5463511 Best vali loss: 0.5419667
	iters: 100, epoch: 6 | loss: 0.6427182
	speed: 0.0100s/iter; left time: 6.3826s
	iters: 200, epoch: 6 | loss: 0.4298245
	speed: 0.0049s/iter; left time: 2.6447s
Updating learning rate to 1.0870912159375e-05
Epoch: 6 cost time: 1.2613351345062256
Epoch: 6, Steps: 245 | Train Loss: 0.5362714 Vali Loss: 0.5475250 Best vali loss: 0.5419667
	iters: 100, epoch: 7 | loss: 0.6282343
	speed: 0.0100s/iter; left time: 3.8954s
	iters: 200, epoch: 7 | loss: 0.6533990
	speed: 0.0050s/iter; left time: 1.4494s
Updating learning rate to 5.4354560796875e-06
Epoch: 7 cost time: 1.2587287425994873
Epoch: 7, Steps: 245 | Train Loss: 0.6408167 Vali Loss: 0.5456919 Best vali loss: 0.5419667
	iters: 100, epoch: 8 | loss: 0.7426437
	speed: 0.0104s/iter; left time: 1.5234s
	iters: 200, epoch: 8 | loss: 0.5024995
	speed: 0.0051s/iter; left time: 0.2365s
Updating learning rate to 2.71772803984375e-06
Epoch: 8 cost time: 1.325441837310791
Epoch: 8, Steps: 245 | Train Loss: 0.6225716 Vali Loss: 0.5467332 Best vali loss: 0.5419667

best validation loss 0.5419666951919584

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015446153334, 'e_layers': 4, 'learning_rate': 0.0007554464483, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007554464483
Validation loss decreased (inf --> 0.6171).  Saving model state dict ...
Epoch: 1 cost time: 1.0364162921905518
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6171472 Best vali loss: 0.6171472
Updating learning rate to 0.00037772322415
Epoch: 2 cost time: 0.769784688949585
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6258928 Best vali loss: 0.6171472
Updating learning rate to 0.000188861612075
Validation loss decreased (0.6171 --> 0.5933).  Saving model state dict ...
Epoch: 3 cost time: 0.8522145748138428
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5933263 Best vali loss: 0.5933263
Updating learning rate to 9.44308060375e-05
Validation loss decreased (0.5933 --> 0.5695).  Saving model state dict ...
Epoch: 4 cost time: 0.765566349029541
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5695061 Best vali loss: 0.5695061
Updating learning rate to 4.721540301875e-05
Epoch: 5 cost time: 0.848665714263916
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5710499 Best vali loss: 0.5695061
Updating learning rate to 2.3607701509375e-05
Validation loss decreased (0.5695 --> 0.5666).  Saving model state dict ...
Epoch: 6 cost time: 0.7682070732116699
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5665918 Best vali loss: 0.5665918
Updating learning rate to 1.18038507546875e-05
Epoch: 7 cost time: 0.8511569499969482
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5700583 Best vali loss: 0.5665918
Updating learning rate to 5.90192537734375e-06
Epoch: 8 cost time: 0.7665140628814697
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5708789 Best vali loss: 0.5665918

best validation loss 0.5665918080026714

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0043387007736, 'e_layers': 4, 'learning_rate': 0.0001432655052, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3731614
	speed: 0.0109s/iter; left time: 84.4997s
	iters: 200, epoch: 1 | loss: 1.1279548
	speed: 0.0047s/iter; left time: 35.6922s
	iters: 300, epoch: 1 | loss: 0.3060642
	speed: 0.0050s/iter; left time: 37.4234s
	iters: 400, epoch: 1 | loss: 0.8301354
	speed: 0.0049s/iter; left time: 36.3758s
	iters: 500, epoch: 1 | loss: 0.5503018
	speed: 0.0049s/iter; left time: 36.1940s
	iters: 600, epoch: 1 | loss: 0.4679411
	speed: 0.0049s/iter; left time: 35.3641s
	iters: 700, epoch: 1 | loss: 1.3267522
	speed: 0.0050s/iter; left time: 35.5568s
	iters: 800, epoch: 1 | loss: 1.4977793
	speed: 0.0050s/iter; left time: 35.1917s
	iters: 900, epoch: 1 | loss: 1.3426229
	speed: 0.0050s/iter; left time: 34.5487s
Updating learning rate to 0.0001432655052
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 5.147525310516357
Epoch: 1, Steps: 979 | Train Loss: 0.9803015 Vali Loss: 0.5976104 Best vali loss: 0.5976104
	iters: 100, epoch: 2 | loss: 1.2261543
	speed: 0.0147s/iter; left time: 99.5179s
	iters: 200, epoch: 2 | loss: 0.3456416
	speed: 0.0046s/iter; left time: 30.4634s
	iters: 300, epoch: 2 | loss: 0.7363055
	speed: 0.0050s/iter; left time: 32.9583s
	iters: 400, epoch: 2 | loss: 2.0695455
	speed: 0.0049s/iter; left time: 31.7680s
	iters: 500, epoch: 2 | loss: 0.9243924
	speed: 0.0050s/iter; left time: 32.0298s
	iters: 600, epoch: 2 | loss: 0.8137521
	speed: 0.0050s/iter; left time: 31.5064s
	iters: 700, epoch: 2 | loss: 1.2665771
	speed: 0.0049s/iter; left time: 30.2113s
	iters: 800, epoch: 2 | loss: 0.3179611
	speed: 0.0049s/iter; left time: 29.6927s
	iters: 900, epoch: 2 | loss: 0.6774140
	speed: 0.0049s/iter; left time: 29.0950s
Updating learning rate to 7.16327526e-05
Validation loss decreased (0.5976 --> 0.5622).  Saving model state dict ...
Epoch: 2 cost time: 4.8129377365112305
Epoch: 2, Steps: 979 | Train Loss: 0.9308604 Vali Loss: 0.5621505 Best vali loss: 0.5621505
	iters: 100, epoch: 3 | loss: 0.8336047
	speed: 0.0153s/iter; left time: 88.5726s
	iters: 200, epoch: 3 | loss: 0.8571219
	speed: 0.0051s/iter; left time: 29.2165s
	iters: 300, epoch: 3 | loss: 0.3060134
	speed: 0.0049s/iter; left time: 27.4854s
	iters: 400, epoch: 3 | loss: 0.6964065
	speed: 0.0048s/iter; left time: 26.5494s
	iters: 500, epoch: 3 | loss: 0.4494492
	speed: 0.0050s/iter; left time: 26.7611s
	iters: 600, epoch: 3 | loss: 1.0159217
	speed: 0.0049s/iter; left time: 25.7803s
	iters: 700, epoch: 3 | loss: 0.8827614
	speed: 0.0050s/iter; left time: 25.7094s
	iters: 800, epoch: 3 | loss: 0.4544092
	speed: 0.0049s/iter; left time: 24.9289s
	iters: 900, epoch: 3 | loss: 1.1149480
	speed: 0.0047s/iter; left time: 23.3365s
Updating learning rate to 3.58163763e-05
Validation loss decreased (0.5622 --> 0.5595).  Saving model state dict ...
Epoch: 3 cost time: 4.880518913269043
Epoch: 3, Steps: 979 | Train Loss: 0.7345151 Vali Loss: 0.5594937 Best vali loss: 0.5594937
	iters: 100, epoch: 4 | loss: 0.9883193
	speed: 0.0159s/iter; left time: 76.4016s
	iters: 200, epoch: 4 | loss: 0.4855230
	speed: 0.0052s/iter; left time: 24.6222s
	iters: 300, epoch: 4 | loss: 0.7029552
	speed: 0.0052s/iter; left time: 23.8551s
	iters: 400, epoch: 4 | loss: 1.2856315
	speed: 0.0051s/iter; left time: 23.0303s
	iters: 500, epoch: 4 | loss: 0.8439186
	speed: 0.0052s/iter; left time: 22.6786s
	iters: 600, epoch: 4 | loss: 1.0126920
	speed: 0.0051s/iter; left time: 22.0445s
	iters: 700, epoch: 4 | loss: 0.9234422
	speed: 0.0052s/iter; left time: 21.8917s
	iters: 800, epoch: 4 | loss: 0.5896192
	speed: 0.0052s/iter; left time: 21.3045s
	iters: 900, epoch: 4 | loss: 1.0064610
	speed: 0.0052s/iter; left time: 20.7757s
Updating learning rate to 1.790818815e-05
Validation loss decreased (0.5595 --> 0.5524).  Saving model state dict ...
Epoch: 4 cost time: 5.121779918670654
Epoch: 4, Steps: 979 | Train Loss: 0.8709513 Vali Loss: 0.5524306 Best vali loss: 0.5524306
	iters: 100, epoch: 5 | loss: 0.6918305
	speed: 0.0161s/iter; left time: 61.5348s
	iters: 200, epoch: 5 | loss: 0.6854057
	speed: 0.0053s/iter; left time: 19.6821s
	iters: 300, epoch: 5 | loss: 0.4518714
	speed: 0.0053s/iter; left time: 19.1134s
	iters: 400, epoch: 5 | loss: 0.2890187
	speed: 0.0053s/iter; left time: 18.6709s
	iters: 500, epoch: 5 | loss: 0.9491222
	speed: 0.0050s/iter; left time: 17.2218s
	iters: 600, epoch: 5 | loss: 0.4113855
	speed: 0.0049s/iter; left time: 16.4183s
	iters: 700, epoch: 5 | loss: 1.4938107
	speed: 0.0049s/iter; left time: 15.8097s
	iters: 800, epoch: 5 | loss: 0.8890593
	speed: 0.0049s/iter; left time: 15.3052s
	iters: 900, epoch: 5 | loss: 1.1370409
	speed: 0.0049s/iter; left time: 14.9067s
Updating learning rate to 8.954094075e-06
Validation loss decreased (0.5524 --> 0.5498).  Saving model state dict ...
Epoch: 5 cost time: 5.026286840438843
Epoch: 5, Steps: 979 | Train Loss: 0.7776161 Vali Loss: 0.5497558 Best vali loss: 0.5497558
	iters: 100, epoch: 6 | loss: 1.0941511
	speed: 0.0154s/iter; left time: 43.6876s
	iters: 200, epoch: 6 | loss: 0.7569541
	speed: 0.0050s/iter; left time: 13.7164s
	iters: 300, epoch: 6 | loss: 0.6491248
	speed: 0.0049s/iter; left time: 12.9004s
	iters: 400, epoch: 6 | loss: 0.4232955
	speed: 0.0049s/iter; left time: 12.5608s
	iters: 500, epoch: 6 | loss: 1.0587499
	speed: 0.0049s/iter; left time: 11.8505s
	iters: 600, epoch: 6 | loss: 0.3852720
	speed: 0.0047s/iter; left time: 11.0822s
	iters: 700, epoch: 6 | loss: 0.5323831
	speed: 0.0048s/iter; left time: 10.7919s
	iters: 800, epoch: 6 | loss: 0.9080561
	speed: 0.0049s/iter; left time: 10.5073s
	iters: 900, epoch: 6 | loss: 0.7092705
	speed: 0.0050s/iter; left time: 10.1002s
Updating learning rate to 4.4770470375e-06
Validation loss decreased (0.5498 --> 0.5487).  Saving model state dict ...
Epoch: 6 cost time: 4.870411396026611
Epoch: 6, Steps: 979 | Train Loss: 0.7241397 Vali Loss: 0.5487230 Best vali loss: 0.5487230
	iters: 100, epoch: 7 | loss: 0.6397516
	speed: 0.0156s/iter; left time: 28.9410s
	iters: 200, epoch: 7 | loss: 0.8777214
	speed: 0.0049s/iter; left time: 8.6067s
	iters: 300, epoch: 7 | loss: 1.4200321
	speed: 0.0052s/iter; left time: 8.6188s
	iters: 400, epoch: 7 | loss: 1.2280231
	speed: 0.0050s/iter; left time: 7.8485s
	iters: 500, epoch: 7 | loss: 0.5534517
	speed: 0.0051s/iter; left time: 7.3724s
	iters: 600, epoch: 7 | loss: 0.7049059
	speed: 0.0050s/iter; left time: 6.8493s
	iters: 700, epoch: 7 | loss: 0.4259821
	speed: 0.0049s/iter; left time: 6.1379s
	iters: 800, epoch: 7 | loss: 0.6427333
	speed: 0.0048s/iter; left time: 5.6074s
	iters: 900, epoch: 7 | loss: 0.3900820
	speed: 0.0048s/iter; left time: 5.1350s
Updating learning rate to 2.23852351875e-06
Validation loss decreased (0.5487 --> 0.5438).  Saving model state dict ...
Epoch: 7 cost time: 4.886262893676758
Epoch: 7, Steps: 979 | Train Loss: 0.7647426 Vali Loss: 0.5437998 Best vali loss: 0.5437998
	iters: 100, epoch: 8 | loss: 1.0131886
	speed: 0.0160s/iter; left time: 14.0747s
	iters: 200, epoch: 8 | loss: 0.8679131
	speed: 0.0050s/iter; left time: 3.8679s
	iters: 300, epoch: 8 | loss: 0.2764553
	speed: 0.0050s/iter; left time: 3.3820s
	iters: 400, epoch: 8 | loss: 0.4982510
	speed: 0.0049s/iter; left time: 2.8282s
	iters: 500, epoch: 8 | loss: 0.7518573
	speed: 0.0049s/iter; left time: 2.3546s
	iters: 600, epoch: 8 | loss: 0.9882067
	speed: 0.0045s/iter; left time: 1.7273s
	iters: 700, epoch: 8 | loss: 0.6624215
	speed: 0.0046s/iter; left time: 1.2912s
	iters: 800, epoch: 8 | loss: 1.5606874
	speed: 0.0049s/iter; left time: 0.8874s
	iters: 900, epoch: 8 | loss: 0.9543167
	speed: 0.0048s/iter; left time: 0.3853s
Updating learning rate to 1.119261759375e-06
Epoch: 8 cost time: 4.793370008468628
Epoch: 8, Steps: 979 | Train Loss: 0.8414775 Vali Loss: 0.5453127 Best vali loss: 0.5437998

best validation loss 0.5437997760236511

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977758777, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744365
	speed: 0.0114s/iter; left time: 10.1074s
Updating learning rate to 0.00028644245819130703
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.00901198387146
Epoch: 1, Steps: 123 | Train Loss: 0.7744365 Vali Loss: 0.6172815 Best vali loss: 0.6172815
	iters: 100, epoch: 2 | loss: 0.9501175
	speed: 0.0092s/iter; left time: 6.9948s
Updating learning rate to 0.000254167610047723
Validation loss decreased (0.6173 --> 0.5539).  Saving model state dict ...
Epoch: 2 cost time: 0.716130256652832
Epoch: 2, Steps: 123 | Train Loss: 0.9501175 Vali Loss: 0.5538979 Best vali loss: 0.5538979
	iters: 100, epoch: 3 | loss: 0.8438976
	speed: 0.0093s/iter; left time: 5.9597s
Updating learning rate to 0.0002058648863268816
Validation loss decreased (0.5539 --> 0.5444).  Saving model state dict ...
Epoch: 3 cost time: 0.7152271270751953
Epoch: 3, Steps: 123 | Train Loss: 0.8438976 Vali Loss: 0.5444231 Best vali loss: 0.5444231

best validation loss 0.5444230500441467

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759349934, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616693
	speed: 0.0114s/iter; left time: 10.1187s
Updating learning rate to 0.00016923886642738415
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0102405548095703
Epoch: 1, Steps: 123 | Train Loss: 0.7616693 Vali Loss: 0.6075849 Best vali loss: 0.6075849
	iters: 100, epoch: 2 | loss: 0.9356158
	speed: 0.0092s/iter; left time: 6.9793s
Updating learning rate to 0.00015016991014057523
Validation loss decreased (0.6076 --> 0.5707).  Saving model state dict ...
Epoch: 2 cost time: 0.7114932537078857
Epoch: 2, Steps: 123 | Train Loss: 0.9356158 Vali Loss: 0.5706809 Best vali loss: 0.5706809
	iters: 100, epoch: 3 | loss: 0.8643374
	speed: 0.0093s/iter; left time: 5.9581s
Updating learning rate to 0.0001216312002737207
Validation loss decreased (0.5707 --> 0.5489).  Saving model state dict ...
Epoch: 3 cost time: 0.7159831523895264
Epoch: 3, Steps: 123 | Train Loss: 0.8643374 Vali Loss: 0.5488625 Best vali loss: 0.5488625

best validation loss 0.5488624737142468

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050408571173, 'e_layers': 3, 'learning_rate': 0.0001189187798, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5242071
	speed: 0.0105s/iter; left time: 19.4673s
	iters: 200, epoch: 1 | loss: 0.9527131
	speed: 0.0047s/iter; left time: 8.2731s
Updating learning rate to 0.0001189187798
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 1.4870383739471436
Epoch: 1, Steps: 245 | Train Loss: 0.7384601 Vali Loss: 0.6120726 Best vali loss: 0.6120726
	iters: 100, epoch: 2 | loss: 0.8709769
	speed: 0.0099s/iter; left time: 15.9242s
	iters: 200, epoch: 2 | loss: 1.0298396
	speed: 0.0050s/iter; left time: 7.5904s
Updating learning rate to 5.94593899e-05
Validation loss decreased (0.6121 --> 0.6022).  Saving model state dict ...
Epoch: 2 cost time: 1.254594087600708
Epoch: 2, Steps: 245 | Train Loss: 0.9504083 Vali Loss: 0.6022280 Best vali loss: 0.6022280
	iters: 100, epoch: 3 | loss: 1.1492679
	speed: 0.0093s/iter; left time: 12.7100s
	iters: 200, epoch: 3 | loss: 0.8646852
	speed: 0.0048s/iter; left time: 6.1320s
Updating learning rate to 2.972969495e-05
Validation loss decreased (0.6022 --> 0.6003).  Saving model state dict ...
Epoch: 3 cost time: 1.1812045574188232
Epoch: 3, Steps: 245 | Train Loss: 1.0069765 Vali Loss: 0.6002939 Best vali loss: 0.6002939

best validation loss 0.6002938720927311

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977758777, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5870028
	speed: 0.0127s/iter; left time: 6.5520s
Updating learning rate to 0.00014888793885
Validation loss decreased (0.5444 --> 0.5342).  Saving model state dict ...
Epoch: 4 cost time: 1.0417752265930176
Epoch: 4, Steps: 123 | Train Loss: 0.5870028 Vali Loss: 0.5342084 Best vali loss: 0.5342084
	iters: 100, epoch: 5 | loss: 0.8206607
	speed: 0.0094s/iter; left time: 3.6866s
Updating learning rate to 9.191099137311841e-05
Validation loss decreased (0.5342 --> 0.5312).  Saving model state dict ...
Epoch: 5 cost time: 0.7093095779418945
Epoch: 5, Steps: 123 | Train Loss: 0.8206607 Vali Loss: 0.5311694 Best vali loss: 0.5311694
	iters: 100, epoch: 6 | loss: 0.7530121
	speed: 0.0093s/iter; left time: 2.5002s
Updating learning rate to 4.360826765227699e-05
Epoch: 6 cost time: 0.7232654094696045
Epoch: 6, Steps: 123 | Train Loss: 0.7530121 Vali Loss: 0.5374051 Best vali loss: 0.5311694
	iters: 100, epoch: 7 | loss: 0.4289771
	speed: 0.0089s/iter; left time: 1.3090s
Updating learning rate to 1.1333419508692952e-05
Epoch: 7 cost time: 0.7105894088745117
Epoch: 7, Steps: 123 | Train Loss: 0.4289771 Vali Loss: 0.5558433 Best vali loss: 0.5311694
	iters: 100, epoch: 8 | loss: 0.5041596
	speed: 0.0090s/iter; left time: 0.2161s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7196457386016846
Epoch: 8, Steps: 123 | Train Loss: 0.5041596 Vali Loss: 0.5510649 Best vali loss: 0.5311694

best validation loss 0.5311693867452163

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0087963078164, 'e_layers': 1, 'learning_rate': 6.1277984e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8344362
	speed: 0.0099s/iter; left time: 8.7557s
Updating learning rate to 6.1277984e-05
Validation loss decreased (inf --> 0.6892).  Saving model state dict ...
Epoch: 1 cost time: 0.8071088790893555
Epoch: 1, Steps: 123 | Train Loss: 0.8344362 Vali Loss: 0.6891756 Best vali loss: 0.6891756
	iters: 100, epoch: 2 | loss: 0.9553322
	speed: 0.0064s/iter; left time: 4.8754s
Updating learning rate to 3.0638992e-05
Validation loss decreased (0.6892 --> 0.6666).  Saving model state dict ...
Epoch: 2 cost time: 0.46724557876586914
Epoch: 2, Steps: 123 | Train Loss: 0.9553322 Vali Loss: 0.6666362 Best vali loss: 0.6666362
	iters: 100, epoch: 3 | loss: 1.2715076
	speed: 0.0062s/iter; left time: 3.9729s
Updating learning rate to 1.5319496e-05
Validation loss decreased (0.6666 --> 0.6567).  Saving model state dict ...
Epoch: 3 cost time: 0.46268749237060547
Epoch: 3, Steps: 123 | Train Loss: 1.2715076 Vali Loss: 0.6567318 Best vali loss: 0.6567318
	iters: 100, epoch: 4 | loss: 1.1966614
	speed: 0.0061s/iter; left time: 3.1399s
Updating learning rate to 7.659748e-06
Validation loss decreased (0.6567 --> 0.6524).  Saving model state dict ...
Epoch: 4 cost time: 0.45672178268432617
Epoch: 4, Steps: 123 | Train Loss: 1.1966614 Vali Loss: 0.6523744 Best vali loss: 0.6523744
	iters: 100, epoch: 5 | loss: 1.0412344
	speed: 0.0061s/iter; left time: 2.4090s
Updating learning rate to 3.829874e-06
Validation loss decreased (0.6524 --> 0.6503).  Saving model state dict ...
Epoch: 5 cost time: 0.47122788429260254
Epoch: 5, Steps: 123 | Train Loss: 1.0412344 Vali Loss: 0.6503205 Best vali loss: 0.6503205
	iters: 100, epoch: 6 | loss: 0.7275846
	speed: 0.0062s/iter; left time: 1.6715s
Updating learning rate to 1.914937e-06
Validation loss decreased (0.6503 --> 0.6494).  Saving model state dict ...
Epoch: 6 cost time: 0.47487616539001465
Epoch: 6, Steps: 123 | Train Loss: 0.7275846 Vali Loss: 0.6493524 Best vali loss: 0.6493524
	iters: 100, epoch: 7 | loss: 0.9192538
	speed: 0.0066s/iter; left time: 0.9681s
Updating learning rate to 9.574685e-07
Validation loss decreased (0.6494 --> 0.6489).  Saving model state dict ...
Epoch: 7 cost time: 0.5023806095123291
Epoch: 7, Steps: 123 | Train Loss: 0.9192538 Vali Loss: 0.6488557 Best vali loss: 0.6488557
	iters: 100, epoch: 8 | loss: 0.8347982
	speed: 0.0066s/iter; left time: 0.1589s
Updating learning rate to 4.7873425e-07
Validation loss decreased (0.6489 --> 0.6486).  Saving model state dict ...
Epoch: 8 cost time: 0.4978787899017334
Epoch: 8, Steps: 123 | Train Loss: 0.8347982 Vali Loss: 0.6486151 Best vali loss: 0.6486151

best validation loss 0.6486151221448324

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0095540282877, 'e_layers': 3, 'learning_rate': 0.0021503787559, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2029982
	speed: 0.0113s/iter; left time: 21.1138s
	iters: 200, epoch: 1 | loss: 0.8673599
	speed: 0.0052s/iter; left time: 9.2017s
Updating learning rate to 0.0021503787559
Validation loss decreased (inf --> 0.6257).  Saving model state dict ...
Epoch: 1 cost time: 1.6276848316192627
Epoch: 1, Steps: 245 | Train Loss: 1.0351790 Vali Loss: 0.6256644 Best vali loss: 0.6256644
	iters: 100, epoch: 2 | loss: 0.7530516
	speed: 0.0104s/iter; left time: 16.8192s
	iters: 200, epoch: 2 | loss: 0.8079916
	speed: 0.0050s/iter; left time: 7.5501s
Updating learning rate to 0.00107518937795
Epoch: 2 cost time: 1.2736492156982422
Epoch: 2, Steps: 245 | Train Loss: 0.7805216 Vali Loss: 0.6296648 Best vali loss: 0.6256644
	iters: 100, epoch: 3 | loss: 0.7946601
	speed: 0.0102s/iter; left time: 14.0156s
	iters: 200, epoch: 3 | loss: 0.7619760
	speed: 0.0051s/iter; left time: 6.4840s
Updating learning rate to 0.000537594688975
Epoch: 3 cost time: 1.2837536334991455
Epoch: 3, Steps: 245 | Train Loss: 0.7783180 Vali Loss: 0.6562358 Best vali loss: 0.6256644
	iters: 100, epoch: 4 | loss: 0.7776160
	speed: 0.0103s/iter; left time: 11.5856s
	iters: 200, epoch: 4 | loss: 0.7783570
	speed: 0.0050s/iter; left time: 5.1779s
Updating learning rate to 0.0002687973444875
Epoch: 4 cost time: 1.282944917678833
Epoch: 4, Steps: 245 | Train Loss: 0.7779865 Vali Loss: 0.6442007 Best vali loss: 0.6256644
	iters: 100, epoch: 5 | loss: 0.6850083
	speed: 0.0103s/iter; left time: 9.0426s
	iters: 200, epoch: 5 | loss: 0.7125802
	speed: 0.0051s/iter; left time: 4.0065s
Updating learning rate to 0.00013439867224375
Epoch: 5 cost time: 1.3162314891815186
Epoch: 5, Steps: 245 | Train Loss: 0.6987943 Vali Loss: 0.6382225 Best vali loss: 0.6256644
	iters: 100, epoch: 6 | loss: 0.8302153
	speed: 0.0103s/iter; left time: 6.5420s
	iters: 200, epoch: 6 | loss: 0.8061035
	speed: 0.0050s/iter; left time: 2.6856s
Updating learning rate to 6.7199336121875e-05
Epoch: 6 cost time: 1.2807891368865967
Epoch: 6, Steps: 245 | Train Loss: 0.8181594 Vali Loss: 0.6412299 Best vali loss: 0.6256644
	iters: 100, epoch: 7 | loss: 0.9911355
	speed: 0.0102s/iter; left time: 3.9959s
	iters: 200, epoch: 7 | loss: 0.8007165
	speed: 0.0050s/iter; left time: 1.4646s
Updating learning rate to 3.35996680609375e-05
Epoch: 7 cost time: 1.2811641693115234
Epoch: 7, Steps: 245 | Train Loss: 0.8959260 Vali Loss: 0.6413717 Best vali loss: 0.6256644
	iters: 100, epoch: 8 | loss: 0.5493235
	speed: 0.0102s/iter; left time: 1.4911s
	iters: 200, epoch: 8 | loss: 0.5778590
	speed: 0.0050s/iter; left time: 0.2302s
Updating learning rate to 1.679983403046875e-05
Epoch: 8 cost time: 1.2742271423339844
Epoch: 8, Steps: 245 | Train Loss: 0.5635913 Vali Loss: 0.6428907 Best vali loss: 0.6256644

best validation loss 0.6256644188502717

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0073759748974, 'e_layers': 3, 'learning_rate': 5.22927375e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5432400
	speed: 0.0102s/iter; left time: 38.9758s
	iters: 200, epoch: 1 | loss: 0.6677968
	speed: 0.0040s/iter; left time: 14.9078s
	iters: 300, epoch: 1 | loss: 1.0205631
	speed: 0.0044s/iter; left time: 15.9506s
	iters: 400, epoch: 1 | loss: 1.0781176
	speed: 0.0046s/iter; left time: 16.0693s
Updating learning rate to 5.22927375e-05
Validation loss decreased (inf --> 0.6569).  Saving model state dict ...
Epoch: 1 cost time: 2.438056468963623
Epoch: 1, Steps: 490 | Train Loss: 0.8274294 Vali Loss: 0.6568773 Best vali loss: 0.6568773
	iters: 100, epoch: 2 | loss: 1.3536940
	speed: 0.0119s/iter; left time: 39.6712s
	iters: 200, epoch: 2 | loss: 0.6214607
	speed: 0.0044s/iter; left time: 14.1311s
	iters: 300, epoch: 2 | loss: 1.0759372
	speed: 0.0043s/iter; left time: 13.3715s
	iters: 400, epoch: 2 | loss: 0.7132847
	speed: 0.0039s/iter; left time: 11.7875s
Updating learning rate to 2.614636875e-05
Validation loss decreased (0.6569 --> 0.6249).  Saving model state dict ...
Epoch: 2 cost time: 2.0910484790802
Epoch: 2, Steps: 490 | Train Loss: 0.9410941 Vali Loss: 0.6248532 Best vali loss: 0.6248532
	iters: 100, epoch: 3 | loss: 1.0773494
	speed: 0.0116s/iter; left time: 33.0291s
	iters: 200, epoch: 3 | loss: 1.1060563
	speed: 0.0044s/iter; left time: 12.1519s
	iters: 300, epoch: 3 | loss: 0.7358348
	speed: 0.0044s/iter; left time: 11.7234s
	iters: 400, epoch: 3 | loss: 1.1829911
	speed: 0.0043s/iter; left time: 10.8387s
Updating learning rate to 1.3073184375e-05
Validation loss decreased (0.6249 --> 0.6179).  Saving model state dict ...
Epoch: 3 cost time: 2.2191226482391357
Epoch: 3, Steps: 490 | Train Loss: 1.0255579 Vali Loss: 0.6179002 Best vali loss: 0.6179002

best validation loss 0.6179002202919709

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032441710596, 'e_layers': 3, 'learning_rate': 0.0003872785149, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6224591
	speed: 0.0140s/iter; left time: 12.4155s
Updating learning rate to 0.0003725386040987387
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 1.3012619018554688
Epoch: 1, Steps: 123 | Train Loss: 0.6224591 Vali Loss: 0.6073562 Best vali loss: 0.6073562
	iters: 100, epoch: 2 | loss: 0.7352448
	speed: 0.0123s/iter; left time: 9.3866s
Updating learning rate to 0.00033056288949682267
Validation loss decreased (0.6074 --> 0.5842).  Saving model state dict ...
Epoch: 2 cost time: 0.9971084594726562
Epoch: 2, Steps: 123 | Train Loss: 0.7352448 Vali Loss: 0.5842031 Best vali loss: 0.5842031
	iters: 100, epoch: 3 | loss: 0.6506094
	speed: 0.0124s/iter; left time: 7.9466s
Updating learning rate to 0.0002677417931315933
Validation loss decreased (0.5842 --> 0.5645).  Saving model state dict ...
Epoch: 3 cost time: 0.9931628704071045
Epoch: 3, Steps: 123 | Train Loss: 0.6506094 Vali Loss: 0.5645348 Best vali loss: 0.5645348

best validation loss 0.5645347854319903

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.010453728855, 'e_layers': 3, 'learning_rate': 0.0040180848806, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6499578
	speed: 0.0109s/iter; left time: 20.3119s
	iters: 200, epoch: 1 | loss: 1.2024574
	speed: 0.0049s/iter; left time: 8.5570s
Updating learning rate to 0.0038651556308396985
Validation loss decreased (inf --> 0.6685).  Saving model state dict ...
Epoch: 1 cost time: 1.5254759788513184
Epoch: 1, Steps: 245 | Train Loss: 0.9262076 Vali Loss: 0.6685352 Best vali loss: 0.6685352
	iters: 100, epoch: 2 | loss: 1.1395596
	speed: 0.0092s/iter; left time: 14.8630s
	iters: 200, epoch: 2 | loss: 0.6115556
	speed: 0.0043s/iter; left time: 6.5563s
Updating learning rate to 0.0034296499735276993
Validation loss decreased (0.6685 --> 0.6526).  Saving model state dict ...
Epoch: 2 cost time: 1.118044376373291
Epoch: 2, Steps: 245 | Train Loss: 0.8755576 Vali Loss: 0.6525886 Best vali loss: 0.6525886
	iters: 100, epoch: 3 | loss: 0.8940532
	speed: 0.0094s/iter; left time: 12.8495s
	iters: 200, epoch: 3 | loss: 1.0250944
	speed: 0.0045s/iter; left time: 5.7411s
Updating learning rate to 0.00277786969712114
Validation loss decreased (0.6526 --> 0.6458).  Saving model state dict ...
Epoch: 3 cost time: 1.1707384586334229
Epoch: 3, Steps: 245 | Train Loss: 0.9595738 Vali Loss: 0.6457885 Best vali loss: 0.6457885

best validation loss 0.6457885268494686

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032441710596, 'e_layers': 3, 'learning_rate': 0.0003872785149, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5429262
	speed: 0.0143s/iter; left time: 7.3806s
Updating learning rate to 0.00019363925745
Validation loss decreased (0.5645 --> 0.5485).  Saving model state dict ...
Epoch: 4 cost time: 1.2865312099456787
Epoch: 4, Steps: 123 | Train Loss: 0.5429262 Vali Loss: 0.5485446 Best vali loss: 0.5485446
	iters: 100, epoch: 5 | loss: 0.6472085
	speed: 0.0124s/iter; left time: 4.8720s
Updating learning rate to 0.00011953672176840672
Epoch: 5 cost time: 0.9920282363891602
Epoch: 5, Steps: 123 | Train Loss: 0.6472085 Vali Loss: 0.5659298 Best vali loss: 0.5485446
	iters: 100, epoch: 6 | loss: 0.5407605
	speed: 0.0120s/iter; left time: 3.2325s
Updating learning rate to 5.671562540317732e-05
Epoch: 6 cost time: 0.9952025413513184
Epoch: 6, Steps: 123 | Train Loss: 0.5407605 Vali Loss: 0.5564556 Best vali loss: 0.5485446
	iters: 100, epoch: 7 | loss: 0.7426041
	speed: 0.0121s/iter; left time: 1.7738s
Updating learning rate to 1.4739910801261301e-05
Epoch: 7 cost time: 0.9966363906860352
Epoch: 7, Steps: 123 | Train Loss: 0.7426041 Vali Loss: 0.5715448 Best vali loss: 0.5485446
	iters: 100, epoch: 8 | loss: 0.6008291
	speed: 0.0120s/iter; left time: 0.2883s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9949774742126465
Epoch: 8, Steps: 123 | Train Loss: 0.6008291 Vali Loss: 0.5730320 Best vali loss: 0.5485446

best validation loss 0.5485445548129931

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0033858432282, 'e_layers': 3, 'learning_rate': 0.0002992265245, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2050688
	speed: 0.0120s/iter; left time: 22.2411s
	iters: 200, epoch: 1 | loss: 0.7599940
	speed: 0.0059s/iter; left time: 10.3357s
Updating learning rate to 0.0002992265245
Validation loss decreased (inf --> 0.6249).  Saving model state dict ...
Epoch: 1 cost time: 1.766338586807251
Epoch: 1, Steps: 245 | Train Loss: 0.9825314 Vali Loss: 0.6249450 Best vali loss: 0.6249450
	iters: 100, epoch: 2 | loss: 0.7159912
	speed: 0.0118s/iter; left time: 18.9928s
	iters: 200, epoch: 2 | loss: 1.1972891
	speed: 0.0058s/iter; left time: 8.8654s
Updating learning rate to 0.00014961326225
Validation loss decreased (0.6249 --> 0.6241).  Saving model state dict ...
Epoch: 2 cost time: 1.478135347366333
Epoch: 2, Steps: 245 | Train Loss: 0.9566402 Vali Loss: 0.6240819 Best vali loss: 0.6240819
	iters: 100, epoch: 3 | loss: 0.7969873
	speed: 0.0121s/iter; left time: 16.5497s
	iters: 200, epoch: 3 | loss: 1.0312642
	speed: 0.0059s/iter; left time: 7.5053s
Updating learning rate to 7.4806631125e-05
Validation loss decreased (0.6241 --> 0.6154).  Saving model state dict ...
Epoch: 3 cost time: 1.487849473953247
Epoch: 3, Steps: 245 | Train Loss: 0.9141257 Vali Loss: 0.6154269 Best vali loss: 0.6154269
	iters: 100, epoch: 4 | loss: 0.7384564
	speed: 0.0120s/iter; left time: 13.5459s
	iters: 200, epoch: 4 | loss: 0.9164043
	speed: 0.0059s/iter; left time: 6.0903s
Updating learning rate to 3.74033155625e-05
Epoch: 4 cost time: 1.491518497467041
Epoch: 4, Steps: 245 | Train Loss: 0.8274304 Vali Loss: 0.6534122 Best vali loss: 0.6154269
	iters: 100, epoch: 5 | loss: 0.6314482
	speed: 0.0115s/iter; left time: 10.1495s
	iters: 200, epoch: 5 | loss: 0.7521656
	speed: 0.0059s/iter; left time: 4.5918s
Updating learning rate to 1.870165778125e-05
Epoch: 5 cost time: 1.4824597835540771
Epoch: 5, Steps: 245 | Train Loss: 0.6918069 Vali Loss: 0.6460282 Best vali loss: 0.6154269
	iters: 100, epoch: 6 | loss: 0.5137902
	speed: 0.0117s/iter; left time: 7.4278s
	iters: 200, epoch: 6 | loss: 1.1319472
	speed: 0.0058s/iter; left time: 3.1289s
Updating learning rate to 9.350828890625e-06
Epoch: 6 cost time: 1.4802699089050293
Epoch: 6, Steps: 245 | Train Loss: 0.8228687 Vali Loss: 0.6618935 Best vali loss: 0.6154269
	iters: 100, epoch: 7 | loss: 0.6935962
	speed: 0.0115s/iter; left time: 4.4800s
	iters: 200, epoch: 7 | loss: 0.6595560
	speed: 0.0059s/iter; left time: 1.7098s
Updating learning rate to 4.6754144453125e-06
Epoch: 7 cost time: 1.4866440296173096
Epoch: 7, Steps: 245 | Train Loss: 0.6765761 Vali Loss: 0.6390424 Best vali loss: 0.6154269
	iters: 100, epoch: 8 | loss: 0.6573923
	speed: 0.0118s/iter; left time: 1.7196s
	iters: 200, epoch: 8 | loss: 0.4965826
	speed: 0.0059s/iter; left time: 0.2727s
Updating learning rate to 2.33770722265625e-06
Epoch: 8 cost time: 1.4994125366210938
Epoch: 8, Steps: 245 | Train Loss: 0.5769874 Vali Loss: 0.6448019 Best vali loss: 0.6154269

best validation loss 0.6154269039327488

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0095358168119, 'e_layers': 4, 'learning_rate': 0.0010414832542, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010414832542
Validation loss decreased (inf --> 0.5962).  Saving model state dict ...
Epoch: 1 cost time: 0.8013193607330322
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5961910 Best vali loss: 0.5961910
Updating learning rate to 0.0005207416271
Epoch: 2 cost time: 0.4948441982269287
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6163627 Best vali loss: 0.5961910
Updating learning rate to 0.00026037081355
Validation loss decreased (0.5962 --> 0.5775).  Saving model state dict ...
Epoch: 3 cost time: 0.5006351470947266
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5774776 Best vali loss: 0.5774776
Updating learning rate to 0.000130185406775
Validation loss decreased (0.5775 --> 0.5693).  Saving model state dict ...
Epoch: 4 cost time: 0.49675989151000977
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5693026 Best vali loss: 0.5693026
Updating learning rate to 6.50927033875e-05
Validation loss decreased (0.5693 --> 0.5676).  Saving model state dict ...
Epoch: 5 cost time: 0.49808502197265625
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5676345 Best vali loss: 0.5676345
Updating learning rate to 3.254635169375e-05
Validation loss decreased (0.5676 --> 0.5673).  Saving model state dict ...
Epoch: 6 cost time: 0.49117136001586914
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5673262 Best vali loss: 0.5673262
Updating learning rate to 1.6273175846875e-05
Epoch: 7 cost time: 0.49408626556396484
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5685480 Best vali loss: 0.5673262
Updating learning rate to 8.1365879234375e-06
Validation loss decreased (0.5673 --> 0.5667).  Saving model state dict ...
Epoch: 8 cost time: 0.5169370174407959
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5666738 Best vali loss: 0.5666738

best validation loss 0.5666737571351785

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0013142990725, 'e_layers': 1, 'learning_rate': 0.000158269042, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9648103
	speed: 0.0098s/iter; left time: 8.6943s
Updating learning rate to 0.00015224528526698458
Validation loss decreased (inf --> 0.6264).  Saving model state dict ...
Epoch: 1 cost time: 0.7834835052490234
Epoch: 1, Steps: 123 | Train Loss: 0.9648103 Vali Loss: 0.6263672 Best vali loss: 0.6263672
	iters: 100, epoch: 2 | loss: 0.8886732
	speed: 0.0066s/iter; left time: 5.0301s
Updating learning rate to 0.00013509107742504925
Validation loss decreased (0.6264 --> 0.6066).  Saving model state dict ...
Epoch: 2 cost time: 0.5049738883972168
Epoch: 2, Steps: 123 | Train Loss: 0.8886732 Vali Loss: 0.6066390 Best vali loss: 0.6066390
	iters: 100, epoch: 3 | loss: 0.7917140
	speed: 0.0066s/iter; left time: 4.2100s
Updating learning rate to 0.00010941799111484728
Epoch: 3 cost time: 0.4903547763824463
Epoch: 3, Steps: 123 | Train Loss: 0.7917140 Vali Loss: 0.6088831 Best vali loss: 0.6066390

best validation loss 0.6066390339393739

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.003466683617, 'e_layers': 3, 'learning_rate': 0.0003022405346, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2023050
	speed: 0.0123s/iter; left time: 22.8463s
	iters: 200, epoch: 1 | loss: 0.7746146
	speed: 0.0060s/iter; left time: 10.5068s
Updating learning rate to 0.0003022405346
Validation loss decreased (inf --> 0.6215).  Saving model state dict ...
Epoch: 1 cost time: 1.8151030540466309
Epoch: 1, Steps: 245 | Train Loss: 0.9884598 Vali Loss: 0.6215473 Best vali loss: 0.6215473
	iters: 100, epoch: 2 | loss: 0.6939309
	speed: 0.0119s/iter; left time: 19.2172s
	iters: 200, epoch: 2 | loss: 1.2153386
	speed: 0.0059s/iter; left time: 8.8949s
Updating learning rate to 0.0001511202673
Validation loss decreased (0.6215 --> 0.6145).  Saving model state dict ...
Epoch: 2 cost time: 1.4809849262237549
Epoch: 2, Steps: 245 | Train Loss: 0.9546347 Vali Loss: 0.6144788 Best vali loss: 0.6144788
	iters: 100, epoch: 3 | loss: 0.7770119
	speed: 0.0120s/iter; left time: 16.4125s
	iters: 200, epoch: 3 | loss: 0.9465408
	speed: 0.0059s/iter; left time: 7.4767s
Updating learning rate to 7.556013365e-05
Validation loss decreased (0.6145 --> 0.5956).  Saving model state dict ...
Epoch: 3 cost time: 1.4821248054504395
Epoch: 3, Steps: 245 | Train Loss: 0.8617763 Vali Loss: 0.5956462 Best vali loss: 0.5956462

best validation loss 0.5956461995026404

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0039640944745, 'e_layers': 1, 'learning_rate': 0.0005308430071, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005106389981682168
Validation loss decreased (inf --> 0.6506).  Saving model state dict ...
Epoch: 1 cost time: 0.6983110904693604
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6506097 Best vali loss: 0.6506097
Updating learning rate to 0.00045310284858293427
Validation loss decreased (0.6506 --> 0.6226).  Saving model state dict ...
Epoch: 2 cost time: 0.4159586429595947
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6225761 Best vali loss: 0.6225761
Updating learning rate to 0.0003669939155520169
Validation loss decreased (0.6226 --> 0.6089).  Saving model state dict ...
Epoch: 3 cost time: 0.41338562965393066
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6088936 Best vali loss: 0.6088936

best validation loss 0.6088935564039814

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.003466683617, 'e_layers': 3, 'learning_rate': 0.0003022405346, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0424210
	speed: 0.0126s/iter; left time: 14.2172s
	iters: 200, epoch: 4 | loss: 0.7106892
	speed: 0.0058s/iter; left time: 5.9860s
Updating learning rate to 3.7780066825e-05
Validation loss decreased (0.5956 --> 0.5674).  Saving model state dict ...
Epoch: 4 cost time: 1.7911107540130615
Epoch: 4, Steps: 245 | Train Loss: 0.8765551 Vali Loss: 0.5674175 Best vali loss: 0.5674175
	iters: 100, epoch: 5 | loss: 0.6354634
	speed: 0.0121s/iter; left time: 10.6606s
	iters: 200, epoch: 5 | loss: 0.9521381
	speed: 0.0059s/iter; left time: 4.6146s
Updating learning rate to 1.88900334125e-05
Epoch: 5 cost time: 1.4923663139343262
Epoch: 5, Steps: 245 | Train Loss: 0.7938007 Vali Loss: 0.5741624 Best vali loss: 0.5674175
	iters: 100, epoch: 6 | loss: 0.6634372
	speed: 0.0117s/iter; left time: 7.4402s
	iters: 200, epoch: 6 | loss: 0.8866144
	speed: 0.0059s/iter; left time: 3.1535s
Updating learning rate to 9.44501670625e-06
Epoch: 6 cost time: 1.492168664932251
Epoch: 6, Steps: 245 | Train Loss: 0.7750258 Vali Loss: 0.5700332 Best vali loss: 0.5674175
	iters: 100, epoch: 7 | loss: 0.5852969
	speed: 0.0116s/iter; left time: 4.5304s
	iters: 200, epoch: 7 | loss: 0.8200549
	speed: 0.0059s/iter; left time: 1.7269s
Updating learning rate to 4.722508353125e-06
Epoch: 7 cost time: 1.497582197189331
Epoch: 7, Steps: 245 | Train Loss: 0.7026759 Vali Loss: 0.5779857 Best vali loss: 0.5674175
	iters: 100, epoch: 8 | loss: 0.6062045
	speed: 0.0116s/iter; left time: 1.6997s
	iters: 200, epoch: 8 | loss: 0.7006890
	speed: 0.0059s/iter; left time: 0.2707s
Updating learning rate to 2.3612541765625e-06
Epoch: 8 cost time: 1.4849421977996826
Epoch: 8, Steps: 245 | Train Loss: 0.6534467 Vali Loss: 0.5811771 Best vali loss: 0.5674175

best validation loss 0.567417487095264

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 3, 'learning_rate': 0.0001582091301, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6232553
	speed: 0.0140s/iter; left time: 12.3997s
Updating learning rate to 0.00015218765362790267
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 1.3027026653289795
Epoch: 1, Steps: 123 | Train Loss: 0.6232553 Vali Loss: 0.5942645 Best vali loss: 0.5942645
	iters: 100, epoch: 2 | loss: 0.7496060
	speed: 0.0122s/iter; left time: 9.3239s
Updating learning rate to 0.00013503993941966737
Validation loss decreased (0.5943 --> 0.5470).  Saving model state dict ...
Epoch: 2 cost time: 0.9982273578643799
Epoch: 2, Steps: 123 | Train Loss: 0.7496060 Vali Loss: 0.5469661 Best vali loss: 0.5469661
	iters: 100, epoch: 3 | loss: 0.6417771
	speed: 0.0125s/iter; left time: 8.0112s
Updating learning rate to 0.00010937657151908152
Validation loss decreased (0.5470 --> 0.5415).  Saving model state dict ...
Epoch: 3 cost time: 0.9981939792633057
Epoch: 3, Steps: 123 | Train Loss: 0.6417771 Vali Loss: 0.5415331 Best vali loss: 0.5415331
	iters: 100, epoch: 4 | loss: 0.8516847
	speed: 0.0124s/iter; left time: 6.4145s
Updating learning rate to 7.910456505e-05
Validation loss decreased (0.5415 --> 0.5405).  Saving model state dict ...
Epoch: 4 cost time: 0.9953806400299072
Epoch: 4, Steps: 123 | Train Loss: 0.8516847 Vali Loss: 0.5404836 Best vali loss: 0.5404836
	iters: 100, epoch: 5 | loss: 0.6949459
	speed: 0.0125s/iter; left time: 4.8940s
Updating learning rate to 4.883255858091849e-05
Validation loss decreased (0.5405 --> 0.5399).  Saving model state dict ...
Epoch: 5 cost time: 1.0042448043823242
Epoch: 5, Steps: 123 | Train Loss: 0.6949459 Vali Loss: 0.5399461 Best vali loss: 0.5399461
	iters: 100, epoch: 6 | loss: 0.4547448
	speed: 0.0124s/iter; left time: 3.3541s
Updating learning rate to 2.316919068033264e-05
Validation loss decreased (0.5399 --> 0.5386).  Saving model state dict ...
Epoch: 6 cost time: 0.9990742206573486
Epoch: 6, Steps: 123 | Train Loss: 0.4547448 Vali Loss: 0.5385699 Best vali loss: 0.5385699
	iters: 100, epoch: 7 | loss: 0.8228321
	speed: 0.0124s/iter; left time: 1.8211s
Updating learning rate to 6.021476472097328e-06
Validation loss decreased (0.5386 --> 0.5312).  Saving model state dict ...
Epoch: 7 cost time: 0.9915573596954346
Epoch: 7, Steps: 123 | Train Loss: 0.8228321 Vali Loss: 0.5311618 Best vali loss: 0.5311618
	iters: 100, epoch: 8 | loss: 0.7124583
	speed: 0.0123s/iter; left time: 0.2949s
Updating learning rate to 0.0
Validation loss decreased (0.5312 --> 0.5293).  Saving model state dict ...
Epoch: 8 cost time: 0.9941294193267822
Epoch: 8, Steps: 123 | Train Loss: 0.7124583 Vali Loss: 0.5292988 Best vali loss: 0.5292988

best validation loss 0.5292987595383407

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0048800808759, 'e_layers': 3, 'learning_rate': 0.0002766492346, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6668665
	speed: 0.0121s/iter; left time: 22.4662s
	iters: 200, epoch: 1 | loss: 0.6139279
	speed: 0.0058s/iter; left time: 10.2116s
Updating learning rate to 0.0002661199000659266
Validation loss decreased (inf --> 0.5913).  Saving model state dict ...
Epoch: 1 cost time: 1.7702667713165283
Epoch: 1, Steps: 245 | Train Loss: 0.6403972 Vali Loss: 0.5912606 Best vali loss: 0.5912606
	iters: 100, epoch: 2 | loss: 1.0739344
	speed: 0.0117s/iter; left time: 18.8715s
	iters: 200, epoch: 2 | loss: 0.4815710
	speed: 0.0057s/iter; left time: 8.6385s
Updating learning rate to 0.000236134892197864
Validation loss decreased (0.5913 --> 0.5575).  Saving model state dict ...
Epoch: 2 cost time: 1.4542348384857178
Epoch: 2, Steps: 245 | Train Loss: 0.7777527 Vali Loss: 0.5574924 Best vali loss: 0.5574924
	iters: 100, epoch: 3 | loss: 0.7713161
	speed: 0.0118s/iter; left time: 16.2178s
	iters: 200, epoch: 3 | loss: 1.0103487
	speed: 0.0058s/iter; left time: 7.3858s
Updating learning rate to 0.00019125915662895147
Validation loss decreased (0.5575 --> 0.5475).  Saving model state dict ...
Epoch: 3 cost time: 1.461683750152588
Epoch: 3, Steps: 245 | Train Loss: 0.8908324 Vali Loss: 0.5475315 Best vali loss: 0.5475315
	iters: 100, epoch: 4 | loss: 0.6301280
	speed: 0.0119s/iter; left time: 13.3697s
	iters: 200, epoch: 4 | loss: 0.5290280
	speed: 0.0057s/iter; left time: 5.8631s
Updating learning rate to 0.0001383246173
Validation loss decreased (0.5475 --> 0.5456).  Saving model state dict ...
Epoch: 4 cost time: 1.4565110206604004
Epoch: 4, Steps: 245 | Train Loss: 0.5795780 Vali Loss: 0.5455921 Best vali loss: 0.5455921
	iters: 100, epoch: 5 | loss: 0.6018391
	speed: 0.0118s/iter; left time: 10.3747s
	iters: 200, epoch: 5 | loss: 0.7915046
	speed: 0.0057s/iter; left time: 4.4598s
Updating learning rate to 8.539007797104852e-05
Epoch: 5 cost time: 1.4327669143676758
Epoch: 5, Steps: 245 | Train Loss: 0.6966719 Vali Loss: 0.5531648 Best vali loss: 0.5455921
	iters: 100, epoch: 6 | loss: 0.5696318
	speed: 0.0112s/iter; left time: 7.1134s
	iters: 200, epoch: 6 | loss: 0.7173562
	speed: 0.0058s/iter; left time: 3.0841s
Updating learning rate to 4.051434240213598e-05
Epoch: 6 cost time: 1.453064203262329
Epoch: 6, Steps: 245 | Train Loss: 0.6434940 Vali Loss: 0.5654349 Best vali loss: 0.5455921
	iters: 100, epoch: 7 | loss: 0.7619838
	speed: 0.0114s/iter; left time: 4.4716s
	iters: 200, epoch: 7 | loss: 0.3642351
	speed: 0.0058s/iter; left time: 1.6886s
Updating learning rate to 1.0529334534073352e-05
Epoch: 7 cost time: 1.465423822402954
Epoch: 7, Steps: 245 | Train Loss: 0.5631094 Vali Loss: 0.5690708 Best vali loss: 0.5455921
	iters: 100, epoch: 8 | loss: 0.7004308
	speed: 0.0114s/iter; left time: 1.6596s
	iters: 200, epoch: 8 | loss: 0.7239351
	speed: 0.0058s/iter; left time: 0.2671s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.451359510421753
Epoch: 8, Steps: 245 | Train Loss: 0.7121829 Vali Loss: 0.5797048 Best vali loss: 0.5455921

best validation loss 0.5455920748112655

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0109386052628, 'e_layers': 2, 'learning_rate': 0.0014390866331, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8685427
	speed: 0.0105s/iter; left time: 9.2652s
Updating learning rate to 0.0014390866331
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 0.8798263072967529
Epoch: 1, Steps: 123 | Train Loss: 0.8685427 Vali Loss: 0.6039796 Best vali loss: 0.6039796
	iters: 100, epoch: 2 | loss: 0.8875992
	speed: 0.0075s/iter; left time: 5.6894s
Updating learning rate to 0.00071954331655
Epoch: 2 cost time: 0.5900588035583496
Epoch: 2, Steps: 123 | Train Loss: 0.8875992 Vali Loss: 0.6112373 Best vali loss: 0.6039796
	iters: 100, epoch: 3 | loss: 0.8940453
	speed: 0.0078s/iter; left time: 5.0130s
Updating learning rate to 0.000359771658275
Epoch: 3 cost time: 0.6010022163391113
Epoch: 3, Steps: 123 | Train Loss: 0.8940453 Vali Loss: 0.6089797 Best vali loss: 0.6039796

best validation loss 0.6039795796664872

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0031156874861, 'e_layers': 3, 'learning_rate': 0.0002297722477, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00022102706224457177
Validation loss decreased (inf --> 0.6547).  Saving model state dict ...
Epoch: 1 cost time: 0.7833845615386963
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6547234 Best vali loss: 0.6547234
Updating learning rate to 0.00019612288108857253
Validation loss decreased (0.6547 --> 0.6271).  Saving model state dict ...
Epoch: 2 cost time: 0.4708847999572754
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6271257 Best vali loss: 0.6271257
Updating learning rate to 0.00015885114005603882
Validation loss decreased (0.6271 --> 0.6180).  Saving model state dict ...
Epoch: 3 cost time: 0.4228963851928711
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6179653 Best vali loss: 0.6179653

best validation loss 0.6179652838781993

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0058620215566, 'e_layers': 2, 'learning_rate': 0.0002464868092, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9542755
	speed: 0.0109s/iter; left time: 9.6516s
Updating learning rate to 0.00023710546362694737
Validation loss decreased (inf --> 0.5990).  Saving model state dict ...
Epoch: 1 cost time: 0.9219610691070557
Epoch: 1, Steps: 123 | Train Loss: 0.9542755 Vali Loss: 0.5989730 Best vali loss: 0.5989730
	iters: 100, epoch: 2 | loss: 0.8440161
	speed: 0.0074s/iter; left time: 5.6458s
Updating learning rate to 0.00021038965172917733
Epoch: 2 cost time: 0.5650978088378906
Epoch: 2, Steps: 123 | Train Loss: 0.8440161 Vali Loss: 0.6013175 Best vali loss: 0.5989730
	iters: 100, epoch: 3 | loss: 0.6527504
	speed: 0.0075s/iter; left time: 4.7836s
Updating learning rate to 0.0001704066136886875
Validation loss decreased (0.5990 --> 0.5852).  Saving model state dict ...
Epoch: 3 cost time: 0.5886859893798828
Epoch: 3, Steps: 123 | Train Loss: 0.6527504 Vali Loss: 0.5852396 Best vali loss: 0.5852396

best validation loss 0.5852396009918276

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0058620215566, 'e_layers': 2, 'learning_rate': 0.0002464868092, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8182340
	speed: 0.0109s/iter; left time: 5.6120s
Updating learning rate to 0.0001232434046
Validation loss decreased (0.5852 --> 0.5438).  Saving model state dict ...
Epoch: 4 cost time: 0.9086577892303467
Epoch: 4, Steps: 123 | Train Loss: 0.8182340 Vali Loss: 0.5438083 Best vali loss: 0.5438083
	iters: 100, epoch: 5 | loss: 0.7372385
	speed: 0.0079s/iter; left time: 3.0934s
Updating learning rate to 7.60801955113125e-05
Validation loss decreased (0.5438 --> 0.5430).  Saving model state dict ...
Epoch: 5 cost time: 0.6098687648773193
Epoch: 5, Steps: 123 | Train Loss: 0.7372385 Vali Loss: 0.5429526 Best vali loss: 0.5429526
	iters: 100, epoch: 6 | loss: 0.6280096
	speed: 0.0079s/iter; left time: 2.1296s
Updating learning rate to 3.609715747082266e-05
Validation loss decreased (0.5430 --> 0.5415).  Saving model state dict ...
Epoch: 6 cost time: 0.631511926651001
Epoch: 6, Steps: 123 | Train Loss: 0.6280096 Vali Loss: 0.5414910 Best vali loss: 0.5414910
	iters: 100, epoch: 7 | loss: 1.0207044
	speed: 0.0078s/iter; left time: 1.1487s
Updating learning rate to 9.381345573052635e-06
Validation loss decreased (0.5415 --> 0.5409).  Saving model state dict ...
Epoch: 7 cost time: 0.6143620014190674
Epoch: 7, Steps: 123 | Train Loss: 1.0207044 Vali Loss: 0.5409206 Best vali loss: 0.5409206
	iters: 100, epoch: 8 | loss: 0.9791085
	speed: 0.0078s/iter; left time: 0.1877s
Updating learning rate to 0.0
Validation loss decreased (0.5409 --> 0.5379).  Saving model state dict ...
Epoch: 8 cost time: 0.6129004955291748
Epoch: 8, Steps: 123 | Train Loss: 0.9791085 Vali Loss: 0.5379335 Best vali loss: 0.5379335

best validation loss 0.5379335460757724

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0057792554645, 'e_layers': 3, 'learning_rate': 9.388559e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.388559e-05
Validation loss decreased (inf --> 0.6347).  Saving model state dict ...
Epoch: 1 cost time: 0.7294151782989502
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6346583 Best vali loss: 0.6346583
Updating learning rate to 4.6942795e-05
Validation loss decreased (0.6347 --> 0.6088).  Saving model state dict ...
Epoch: 2 cost time: 0.4448997974395752
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6088399 Best vali loss: 0.6088399
Updating learning rate to 2.34713975e-05
Validation loss decreased (0.6088 --> 0.6062).  Saving model state dict ...
Epoch: 3 cost time: 0.45254087448120117
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6061863 Best vali loss: 0.6061863
Updating learning rate to 1.173569875e-05
Validation loss decreased (0.6062 --> 0.6038).  Saving model state dict ...
Epoch: 4 cost time: 0.45897388458251953
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6037818 Best vali loss: 0.6037818
Updating learning rate to 5.867849375e-06
Validation loss decreased (0.6038 --> 0.6029).  Saving model state dict ...
Epoch: 5 cost time: 0.4545140266418457
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6029407 Best vali loss: 0.6029407
Updating learning rate to 2.9339246875e-06
Validation loss decreased (0.6029 --> 0.6026).  Saving model state dict ...
Epoch: 6 cost time: 0.4456911087036133
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6026450 Best vali loss: 0.6026450
Updating learning rate to 1.46696234375e-06
Validation loss decreased (0.6026 --> 0.6026).  Saving model state dict ...
Epoch: 7 cost time: 0.4466552734375
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6025751 Best vali loss: 0.6025751
Updating learning rate to 7.33481171875e-07
Validation loss decreased (0.6026 --> 0.6025).  Saving model state dict ...
Epoch: 8 cost time: 0.44495701789855957
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6024967 Best vali loss: 0.6024967

best validation loss 0.6024966998433471

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0105586926441, 'e_layers': 2, 'learning_rate': 0.0004262141086, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9273790
	speed: 0.0102s/iter; left time: 18.9083s
	iters: 200, epoch: 1 | loss: 0.8770255
	speed: 0.0039s/iter; left time: 6.8067s
Updating learning rate to 0.0004262141086
Validation loss decreased (inf --> 0.5931).  Saving model state dict ...
Epoch: 1 cost time: 1.3136341571807861
Epoch: 1, Steps: 245 | Train Loss: 0.9022022 Vali Loss: 0.5930904 Best vali loss: 0.5930904
	iters: 100, epoch: 2 | loss: 0.9978234
	speed: 0.0081s/iter; left time: 13.0746s
	iters: 200, epoch: 2 | loss: 0.6437873
	speed: 0.0037s/iter; left time: 5.6571s
Updating learning rate to 0.0002131070543
Validation loss decreased (0.5931 --> 0.5752).  Saving model state dict ...
Epoch: 2 cost time: 0.9618508815765381
Epoch: 2, Steps: 245 | Train Loss: 0.8208053 Vali Loss: 0.5752246 Best vali loss: 0.5752246
	iters: 100, epoch: 3 | loss: 1.0644648
	speed: 0.0081s/iter; left time: 11.0995s
	iters: 200, epoch: 3 | loss: 1.1314564
	speed: 0.0038s/iter; left time: 4.7962s
Updating learning rate to 0.00010655352715
Validation loss decreased (0.5752 --> 0.5472).  Saving model state dict ...
Epoch: 3 cost time: 0.985943078994751
Epoch: 3, Steps: 245 | Train Loss: 1.0979606 Vali Loss: 0.5471584 Best vali loss: 0.5471584
	iters: 100, epoch: 4 | loss: 0.8656421
	speed: 0.0080s/iter; left time: 9.0480s
	iters: 200, epoch: 4 | loss: 0.6812111
	speed: 0.0040s/iter; left time: 4.0837s
Updating learning rate to 5.3276763575e-05
Validation loss decreased (0.5472 --> 0.5357).  Saving model state dict ...
Epoch: 4 cost time: 0.9963042736053467
Epoch: 4, Steps: 245 | Train Loss: 0.7734266 Vali Loss: 0.5357381 Best vali loss: 0.5357381
	iters: 100, epoch: 5 | loss: 0.4489813
	speed: 0.0079s/iter; left time: 6.9941s
	iters: 200, epoch: 5 | loss: 0.7947633
	speed: 0.0037s/iter; left time: 2.9074s
Updating learning rate to 2.66383817875e-05
Epoch: 5 cost time: 0.956493616104126
Epoch: 5, Steps: 245 | Train Loss: 0.6218723 Vali Loss: 0.5368761 Best vali loss: 0.5357381
	iters: 100, epoch: 6 | loss: 0.8388717
	speed: 0.0078s/iter; left time: 4.9663s
	iters: 200, epoch: 6 | loss: 0.6986641
	speed: 0.0035s/iter; left time: 1.8940s
Updating learning rate to 1.331919089375e-05
Epoch: 6 cost time: 0.9277939796447754
Epoch: 6, Steps: 245 | Train Loss: 0.7687679 Vali Loss: 0.5357581 Best vali loss: 0.5357381
	iters: 100, epoch: 7 | loss: 0.6693841
	speed: 0.0074s/iter; left time: 2.8995s
	iters: 200, epoch: 7 | loss: 0.8013167
	speed: 0.0036s/iter; left time: 1.0491s
Updating learning rate to 6.659595446875e-06
Validation loss decreased (0.5357 --> 0.5356).  Saving model state dict ...
Epoch: 7 cost time: 0.9144749641418457
Epoch: 7, Steps: 245 | Train Loss: 0.7353504 Vali Loss: 0.5356179 Best vali loss: 0.5356179
	iters: 100, epoch: 8 | loss: 0.6189199
	speed: 0.0079s/iter; left time: 1.1492s
	iters: 200, epoch: 8 | loss: 0.8066009
	speed: 0.0036s/iter; left time: 0.1652s
Updating learning rate to 3.3297977234375e-06
Epoch: 8 cost time: 0.9543383121490479
Epoch: 8, Steps: 245 | Train Loss: 0.7127604 Vali Loss: 0.5356657 Best vali loss: 0.5356179

best validation loss 0.5356178921662453

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0009478334402, 'e_layers': 1, 'learning_rate': 9.53160302e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6208606
	speed: 0.0090s/iter; left time: 16.8274s
	iters: 200, epoch: 1 | loss: 0.5654581
	speed: 0.0030s/iter; left time: 5.3212s
Updating learning rate to 9.53160302e-05
Validation loss decreased (inf --> 0.6068).  Saving model state dict ...
Epoch: 1 cost time: 1.068162441253662
Epoch: 1, Steps: 245 | Train Loss: 0.5931593 Vali Loss: 0.6068415 Best vali loss: 0.6068415
	iters: 100, epoch: 2 | loss: 0.6559106
	speed: 0.0064s/iter; left time: 10.4177s
	iters: 200, epoch: 2 | loss: 1.3824714
	speed: 0.0027s/iter; left time: 4.1647s
Updating learning rate to 4.76580151e-05
Epoch: 2 cost time: 0.7290325164794922
Epoch: 2, Steps: 245 | Train Loss: 1.0191910 Vali Loss: 0.6087860 Best vali loss: 0.6068415
	iters: 100, epoch: 3 | loss: 0.6107556
	speed: 0.0066s/iter; left time: 9.0409s
	iters: 200, epoch: 3 | loss: 1.2106988
	speed: 0.0030s/iter; left time: 3.8235s
Updating learning rate to 2.382900755e-05
Validation loss decreased (0.6068 --> 0.6006).  Saving model state dict ...
Epoch: 3 cost time: 0.7827548980712891
Epoch: 3, Steps: 245 | Train Loss: 0.9107272 Vali Loss: 0.6005761 Best vali loss: 0.6005761

best validation loss 0.6005761490161636

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0063950360511, 'e_layers': 2, 'learning_rate': 0.0005447376253, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0974835
	speed: 0.0093s/iter; left time: 72.0628s
	iters: 200, epoch: 1 | loss: 0.9051006
	speed: 0.0035s/iter; left time: 26.6160s
	iters: 300, epoch: 1 | loss: 1.2033536
	speed: 0.0034s/iter; left time: 25.6040s
	iters: 400, epoch: 1 | loss: 0.5572442
	speed: 0.0031s/iter; left time: 23.0863s
	iters: 500, epoch: 1 | loss: 1.2650406
	speed: 0.0031s/iter; left time: 22.6915s
	iters: 600, epoch: 1 | loss: 0.9389878
	speed: 0.0030s/iter; left time: 21.8837s
	iters: 700, epoch: 1 | loss: 0.9525653
	speed: 0.0031s/iter; left time: 22.1029s
	iters: 800, epoch: 1 | loss: 1.1393803
	speed: 0.0031s/iter; left time: 21.5069s
	iters: 900, epoch: 1 | loss: 1.2447109
	speed: 0.0031s/iter; left time: 21.5820s
Updating learning rate to 0.0005447376253
Validation loss decreased (inf --> 0.6010).  Saving model state dict ...
Epoch: 1 cost time: 3.4627106189727783
Epoch: 1, Steps: 979 | Train Loss: 1.0337630 Vali Loss: 0.6009970 Best vali loss: 0.6009970
	iters: 100, epoch: 2 | loss: 0.4808006
	speed: 0.0113s/iter; left time: 75.9847s
	iters: 200, epoch: 2 | loss: 0.5074175
	speed: 0.0035s/iter; left time: 23.4503s
	iters: 300, epoch: 2 | loss: 0.6325397
	speed: 0.0035s/iter; left time: 23.1981s
	iters: 400, epoch: 2 | loss: 1.0378354
	speed: 0.0035s/iter; left time: 22.4768s
	iters: 500, epoch: 2 | loss: 1.3067133
	speed: 0.0035s/iter; left time: 22.1583s
	iters: 600, epoch: 2 | loss: 0.8527464
	speed: 0.0036s/iter; left time: 22.8009s
	iters: 700, epoch: 2 | loss: 0.4602602
	speed: 0.0037s/iter; left time: 22.5663s
	iters: 800, epoch: 2 | loss: 0.7537147
	speed: 0.0035s/iter; left time: 21.4447s
	iters: 900, epoch: 2 | loss: 0.8771887
	speed: 0.0033s/iter; left time: 19.9058s
Updating learning rate to 0.00027236881265
Epoch: 2 cost time: 3.501800060272217
Epoch: 2, Steps: 979 | Train Loss: 0.7676907 Vali Loss: 0.6032967 Best vali loss: 0.6009970
	iters: 100, epoch: 3 | loss: 0.6106740
	speed: 0.0108s/iter; left time: 62.6303s
	iters: 200, epoch: 3 | loss: 1.1646923
	speed: 0.0030s/iter; left time: 17.2570s
	iters: 300, epoch: 3 | loss: 0.4342594
	speed: 0.0031s/iter; left time: 17.0723s
	iters: 400, epoch: 3 | loss: 0.9716764
	speed: 0.0031s/iter; left time: 16.7505s
	iters: 500, epoch: 3 | loss: 0.9772845
	speed: 0.0030s/iter; left time: 16.2113s
	iters: 600, epoch: 3 | loss: 0.4432289
	speed: 0.0031s/iter; left time: 16.3494s
	iters: 700, epoch: 3 | loss: 0.5007558
	speed: 0.0031s/iter; left time: 15.7909s
	iters: 800, epoch: 3 | loss: 0.5728092
	speed: 0.0029s/iter; left time: 14.7679s
	iters: 900, epoch: 3 | loss: 0.5822352
	speed: 0.0030s/iter; left time: 15.1343s
Updating learning rate to 0.000136184406325
Epoch: 3 cost time: 3.0062851905822754
Epoch: 3, Steps: 979 | Train Loss: 0.6952906 Vali Loss: 0.6279394 Best vali loss: 0.6009970

best validation loss 0.6009969825768902

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010664264686, 'e_layers': 2, 'learning_rate': 0.0018950488404, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7610562
	speed: 0.0103s/iter; left time: 9.1079s
Updating learning rate to 0.0018950488404
Validation loss decreased (inf --> 0.6142).  Saving model state dict ...
Epoch: 1 cost time: 0.8657839298248291
Epoch: 1, Steps: 123 | Train Loss: 0.7610562 Vali Loss: 0.6142033 Best vali loss: 0.6142033
	iters: 100, epoch: 2 | loss: 0.7357457
	speed: 0.0074s/iter; left time: 5.6695s
Updating learning rate to 0.0009475244202
Validation loss decreased (0.6142 --> 0.5918).  Saving model state dict ...
Epoch: 2 cost time: 0.5820498466491699
Epoch: 2, Steps: 123 | Train Loss: 0.7357457 Vali Loss: 0.5918067 Best vali loss: 0.5918067
	iters: 100, epoch: 3 | loss: 0.8919675
	speed: 0.0076s/iter; left time: 4.8469s
Updating learning rate to 0.0004737622101
Epoch: 3 cost time: 0.6042733192443848
Epoch: 3, Steps: 123 | Train Loss: 0.8919675 Vali Loss: 0.6179944 Best vali loss: 0.5918067

best validation loss 0.5918066709033872

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010664264686, 'e_layers': 2, 'learning_rate': 0.0018950488404, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7268468
	speed: 0.0104s/iter; left time: 5.3680s
Updating learning rate to 0.00023688110505
Epoch: 4 cost time: 0.8790111541748047
Epoch: 4, Steps: 123 | Train Loss: 0.7268468 Vali Loss: 0.6380646 Best vali loss: 0.5918067
	iters: 100, epoch: 5 | loss: 0.7001289
	speed: 0.0076s/iter; left time: 2.9758s
Updating learning rate to 0.000118440552525
Epoch: 5 cost time: 0.6024284362792969
Epoch: 5, Steps: 123 | Train Loss: 0.7001289 Vali Loss: 0.6353122 Best vali loss: 0.5918067
	iters: 100, epoch: 6 | loss: 0.8205638
	speed: 0.0075s/iter; left time: 2.0319s
Updating learning rate to 5.92202762625e-05
Epoch: 6 cost time: 0.5982065200805664
Epoch: 6, Steps: 123 | Train Loss: 0.8205638 Vali Loss: 0.6404388 Best vali loss: 0.5918067
	iters: 100, epoch: 7 | loss: 0.7472947
	speed: 0.0075s/iter; left time: 1.1038s
Updating learning rate to 2.961013813125e-05
Epoch: 7 cost time: 0.5947878360748291
Epoch: 7, Steps: 123 | Train Loss: 0.7472947 Vali Loss: 0.6392962 Best vali loss: 0.5918067
	iters: 100, epoch: 8 | loss: 0.9321374
	speed: 0.0073s/iter; left time: 0.1747s
Updating learning rate to 1.4805069065625e-05
Epoch: 8 cost time: 0.5659165382385254
Epoch: 8, Steps: 123 | Train Loss: 0.9321374 Vali Loss: 0.6369973 Best vali loss: 0.5918067

best validation loss 0.5918066709033872

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0025904414853, 'e_layers': 2, 'learning_rate': 0.0009839018796, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7625892
	speed: 0.0108s/iter; left time: 9.5865s
Updating learning rate to 0.0009464543440809121
Validation loss decreased (inf --> 0.6100).  Saving model state dict ...
Epoch: 1 cost time: 0.8994905948638916
Epoch: 1, Steps: 123 | Train Loss: 0.7625892 Vali Loss: 0.6100372 Best vali loss: 0.6100372
	iters: 100, epoch: 2 | loss: 0.8520787
	speed: 0.0074s/iter; left time: 5.6414s
Updating learning rate to 0.000839812785343675
Validation loss decreased (0.6100 --> 0.6099).  Saving model state dict ...
Epoch: 2 cost time: 0.5805859565734863
Epoch: 2, Steps: 123 | Train Loss: 0.8520787 Vali Loss: 0.6099010 Best vali loss: 0.6099010
	iters: 100, epoch: 3 | loss: 0.7759085
	speed: 0.0073s/iter; left time: 4.6566s
Updating learning rate to 0.0006802124139978957
Epoch: 3 cost time: 0.5668861865997314
Epoch: 3, Steps: 123 | Train Loss: 0.7759085 Vali Loss: 0.6202171 Best vali loss: 0.6099010
	iters: 100, epoch: 4 | loss: 0.6678160
	speed: 0.0071s/iter; left time: 3.6609s
Updating learning rate to 0.0004919509398
Epoch: 4 cost time: 0.572728157043457
Epoch: 4, Steps: 123 | Train Loss: 0.6678160 Vali Loss: 0.6291474 Best vali loss: 0.6099010
	iters: 100, epoch: 5 | loss: 0.8509275
	speed: 0.0072s/iter; left time: 2.8236s
Updating learning rate to 0.00030368946560210434
Epoch: 5 cost time: 0.5629761219024658
Epoch: 5, Steps: 123 | Train Loss: 0.8509275 Vali Loss: 0.6546501 Best vali loss: 0.6099010
	iters: 100, epoch: 6 | loss: 0.8505722
	speed: 0.0071s/iter; left time: 1.9180s
Updating learning rate to 0.00014408909425632502
Epoch: 6 cost time: 0.561227560043335
Epoch: 6, Steps: 123 | Train Loss: 0.8505722 Vali Loss: 0.6603144 Best vali loss: 0.6099010
	iters: 100, epoch: 7 | loss: 0.6840022
	speed: 0.0074s/iter; left time: 1.0839s
Updating learning rate to 3.744753551908783e-05
Epoch: 7 cost time: 0.57924485206604
Epoch: 7, Steps: 123 | Train Loss: 0.6840022 Vali Loss: 0.6453779 Best vali loss: 0.6099010
	iters: 100, epoch: 8 | loss: 0.7270502
	speed: 0.0074s/iter; left time: 0.1786s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5796196460723877
Epoch: 8, Steps: 123 | Train Loss: 0.7270502 Vali Loss: 0.6472544 Best vali loss: 0.6099010

best validation loss 0.6099010011985422

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489413247, 'e_layers': 2, 'learning_rate': 0.0002973594297, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744175
	speed: 0.0117s/iter; left time: 10.3762s
Updating learning rate to 0.00028604186029952943
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0191304683685303
Epoch: 1, Steps: 123 | Train Loss: 0.7744175 Vali Loss: 0.6171958 Best vali loss: 0.6171958
	iters: 100, epoch: 2 | loss: 0.9541745
	speed: 0.0091s/iter; left time: 6.9453s
Updating learning rate to 0.0002538121494453172
Validation loss decreased (0.6172 --> 0.5558).  Saving model state dict ...
Epoch: 2 cost time: 0.7099752426147461
Epoch: 2, Steps: 123 | Train Loss: 0.9541745 Vali Loss: 0.5557525 Best vali loss: 0.5557525
	iters: 100, epoch: 3 | loss: 0.8579419
	speed: 0.0093s/iter; left time: 5.9393s
Updating learning rate to 0.0002055769784518608
Validation loss decreased (0.5558 --> 0.5446).  Saving model state dict ...
Epoch: 3 cost time: 0.7209007740020752
Epoch: 3, Steps: 123 | Train Loss: 0.8579419 Vali Loss: 0.5446434 Best vali loss: 0.5446434
	iters: 100, epoch: 4 | loss: 0.4861835
	speed: 0.0094s/iter; left time: 4.8714s
Updating learning rate to 0.00014867971485
Validation loss decreased (0.5446 --> 0.5446).  Saving model state dict ...
Epoch: 4 cost time: 0.728705644607544
Epoch: 4, Steps: 123 | Train Loss: 0.4861835 Vali Loss: 0.5445754 Best vali loss: 0.5445754
	iters: 100, epoch: 5 | loss: 0.5556914
	speed: 0.0092s/iter; left time: 3.6276s
Updating learning rate to 9.178245124813919e-05
Validation loss decreased (0.5446 --> 0.5264).  Saving model state dict ...
Epoch: 5 cost time: 0.7117993831634521
Epoch: 5, Steps: 123 | Train Loss: 0.5556914 Vali Loss: 0.5264108 Best vali loss: 0.5264108
	iters: 100, epoch: 6 | loss: 0.5808369
	speed: 0.0092s/iter; left time: 2.4754s
Updating learning rate to 4.354728025468278e-05
Epoch: 6 cost time: 0.7134380340576172
Epoch: 6, Steps: 123 | Train Loss: 0.5808369 Vali Loss: 0.5386111 Best vali loss: 0.5264108
	iters: 100, epoch: 7 | loss: 0.5363284
	speed: 0.0088s/iter; left time: 1.2958s
Updating learning rate to 1.1317569400470583e-05
Epoch: 7 cost time: 0.7082440853118896
Epoch: 7, Steps: 123 | Train Loss: 0.5363284 Vali Loss: 0.5379157 Best vali loss: 0.5264108
	iters: 100, epoch: 8 | loss: 0.6964763
	speed: 0.0089s/iter; left time: 0.2126s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7114706039428711
Epoch: 8, Steps: 123 | Train Loss: 0.6964763 Vali Loss: 0.5451893 Best vali loss: 0.5264108

best validation loss 0.526410781278041

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913880807, 'e_layers': 2, 'learning_rate': 0.0001759349934, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616644
	speed: 0.0117s/iter; left time: 10.3145s
Updating learning rate to 0.00016923886642738415
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.010603666305542
Epoch: 1, Steps: 123 | Train Loss: 0.7616644 Vali Loss: 0.6075866 Best vali loss: 0.6075866
	iters: 100, epoch: 2 | loss: 0.9348408
	speed: 0.0093s/iter; left time: 7.0720s
Updating learning rate to 0.00015016991014057523
Validation loss decreased (0.6076 --> 0.5698).  Saving model state dict ...
Epoch: 2 cost time: 0.7201321125030518
Epoch: 2, Steps: 123 | Train Loss: 0.9348408 Vali Loss: 0.5698076 Best vali loss: 0.5698076
	iters: 100, epoch: 3 | loss: 0.8570109
	speed: 0.0092s/iter; left time: 5.8863s
Updating learning rate to 0.0001216312002737207
Validation loss decreased (0.5698 --> 0.5480).  Saving model state dict ...
Epoch: 3 cost time: 0.713120698928833
Epoch: 3, Steps: 123 | Train Loss: 0.8570109 Vali Loss: 0.5480411 Best vali loss: 0.5480411

best validation loss 0.5480411079734191

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009023044692, 'e_layers': 2, 'learning_rate': 5.053156e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9345279
	speed: 0.0097s/iter; left time: 75.3634s
	iters: 200, epoch: 1 | loss: 0.6666602
	speed: 0.0036s/iter; left time: 27.3586s
	iters: 300, epoch: 1 | loss: 0.6430853
	speed: 0.0034s/iter; left time: 25.3676s
	iters: 400, epoch: 1 | loss: 1.2403811
	speed: 0.0032s/iter; left time: 23.9960s
	iters: 500, epoch: 1 | loss: 1.4385977
	speed: 0.0032s/iter; left time: 23.3756s
	iters: 600, epoch: 1 | loss: 0.4022035
	speed: 0.0031s/iter; left time: 22.0659s
	iters: 700, epoch: 1 | loss: 0.5192999
	speed: 0.0030s/iter; left time: 21.1238s
	iters: 800, epoch: 1 | loss: 0.8475512
	speed: 0.0030s/iter; left time: 21.1995s
	iters: 900, epoch: 1 | loss: 1.0498532
	speed: 0.0030s/iter; left time: 20.9564s
Updating learning rate to 4.8608317014933015e-05
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 3.490692138671875
Epoch: 1, Steps: 979 | Train Loss: 0.8602400 Vali Loss: 0.6011769 Best vali loss: 0.6011769
	iters: 100, epoch: 2 | loss: 0.7536522
	speed: 0.0113s/iter; left time: 76.6389s
	iters: 200, epoch: 2 | loss: 0.3648029
	speed: 0.0031s/iter; left time: 20.3101s
	iters: 300, epoch: 2 | loss: 0.4552198
	speed: 0.0030s/iter; left time: 19.3468s
	iters: 400, epoch: 2 | loss: 0.8925902
	speed: 0.0031s/iter; left time: 19.7568s
	iters: 500, epoch: 2 | loss: 0.5944141
	speed: 0.0031s/iter; left time: 19.7404s
	iters: 600, epoch: 2 | loss: 1.3134681
	speed: 0.0031s/iter; left time: 19.4244s
	iters: 700, epoch: 2 | loss: 0.8164439
	speed: 0.0031s/iter; left time: 19.0157s
	iters: 800, epoch: 2 | loss: 0.8876634
	speed: 0.0032s/iter; left time: 19.2847s
	iters: 900, epoch: 2 | loss: 0.4583702
	speed: 0.0031s/iter; left time: 18.6050s
Updating learning rate to 4.3131384369967445e-05
Validation loss decreased (0.6012 --> 0.5542).  Saving model state dict ...
Epoch: 2 cost time: 3.0602376461029053
Epoch: 2, Steps: 979 | Train Loss: 0.7262916 Vali Loss: 0.5541977 Best vali loss: 0.5541977
	iters: 100, epoch: 3 | loss: 0.6452184
	speed: 0.0107s/iter; left time: 61.9751s
	iters: 200, epoch: 3 | loss: 1.0400248
	speed: 0.0031s/iter; left time: 17.3432s
	iters: 300, epoch: 3 | loss: 0.8678533
	speed: 0.0031s/iter; left time: 17.2596s
	iters: 400, epoch: 3 | loss: 0.7642804
	speed: 0.0031s/iter; left time: 16.9347s
	iters: 500, epoch: 3 | loss: 0.9525183
	speed: 0.0032s/iter; left time: 16.9722s
	iters: 600, epoch: 3 | loss: 0.4891471
	speed: 0.0031s/iter; left time: 16.1892s
	iters: 700, epoch: 3 | loss: 0.5772402
	speed: 0.0032s/iter; left time: 16.3692s
	iters: 800, epoch: 3 | loss: 0.5567425
	speed: 0.0031s/iter; left time: 15.5578s
	iters: 900, epoch: 3 | loss: 1.4389685
	speed: 0.0030s/iter; left time: 15.1357s
Updating learning rate to 3.493457541178124e-05
Epoch: 3 cost time: 3.0675203800201416
Epoch: 3, Steps: 979 | Train Loss: 0.8146660 Vali Loss: 0.5678536 Best vali loss: 0.5541977

best validation loss 0.5541977255860725

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016077547059, 'e_layers': 4, 'learning_rate': 0.0002410495534, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9908619
	speed: 0.0120s/iter; left time: 22.3456s
	iters: 200, epoch: 1 | loss: 0.8274603
	speed: 0.0056s/iter; left time: 9.8469s
Updating learning rate to 0.0002410495534
Validation loss decreased (inf --> 0.6084).  Saving model state dict ...
Epoch: 1 cost time: 1.7291584014892578
Epoch: 1, Steps: 245 | Train Loss: 0.9091611 Vali Loss: 0.6083840 Best vali loss: 0.6083840
	iters: 100, epoch: 2 | loss: 0.7490951
	speed: 0.0111s/iter; left time: 17.8965s
	iters: 200, epoch: 2 | loss: 0.5692832
	speed: 0.0054s/iter; left time: 8.1609s
Updating learning rate to 0.0001205247767
Validation loss decreased (0.6084 --> 0.5617).  Saving model state dict ...
Epoch: 2 cost time: 1.3733043670654297
Epoch: 2, Steps: 245 | Train Loss: 0.6591892 Vali Loss: 0.5617315 Best vali loss: 0.5617315
	iters: 100, epoch: 3 | loss: 0.5510628
	speed: 0.0114s/iter; left time: 15.5992s
	iters: 200, epoch: 3 | loss: 0.8583636
	speed: 0.0054s/iter; left time: 6.8228s
Updating learning rate to 6.026238835e-05
Validation loss decreased (0.5617 --> 0.5462).  Saving model state dict ...
Epoch: 3 cost time: 1.368988275527954
Epoch: 3, Steps: 245 | Train Loss: 0.7047132 Vali Loss: 0.5462043 Best vali loss: 0.5462043

best validation loss 0.5462043448930975

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016077547059, 'e_layers': 4, 'learning_rate': 0.0002410495534, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8490877
	speed: 0.0127s/iter; left time: 14.3105s
	iters: 200, epoch: 4 | loss: 0.7945566
	speed: 0.0060s/iter; left time: 6.1363s
Updating learning rate to 3.0131194175e-05
Epoch: 4 cost time: 1.8193910121917725
Epoch: 4, Steps: 245 | Train Loss: 0.8218221 Vali Loss: 0.5545745 Best vali loss: 0.5462043
	iters: 100, epoch: 5 | loss: 0.6124991
	speed: 0.0115s/iter; left time: 10.1582s
	iters: 200, epoch: 5 | loss: 0.5268194
	speed: 0.0060s/iter; left time: 4.6613s
Updating learning rate to 1.50655970875e-05
Epoch: 5 cost time: 1.5112354755401611
Epoch: 5, Steps: 245 | Train Loss: 0.5696593 Vali Loss: 0.5614844 Best vali loss: 0.5462043
	iters: 100, epoch: 6 | loss: 0.4664520
	speed: 0.0111s/iter; left time: 7.0554s
	iters: 200, epoch: 6 | loss: 0.7719113
	speed: 0.0056s/iter; left time: 2.9828s
Updating learning rate to 7.53279854375e-06
Epoch: 6 cost time: 1.4224343299865723
Epoch: 6, Steps: 245 | Train Loss: 0.6191816 Vali Loss: 0.5705817 Best vali loss: 0.5462043
	iters: 100, epoch: 7 | loss: 0.6067609
	speed: 0.0113s/iter; left time: 4.4067s
	iters: 200, epoch: 7 | loss: 0.4488007
	speed: 0.0054s/iter; left time: 1.5633s
Updating learning rate to 3.766399271875e-06
Epoch: 7 cost time: 1.3826138973236084
Epoch: 7, Steps: 245 | Train Loss: 0.5277808 Vali Loss: 0.5742204 Best vali loss: 0.5462043
	iters: 100, epoch: 8 | loss: 0.8081514
	speed: 0.0110s/iter; left time: 1.6117s
	iters: 200, epoch: 8 | loss: 0.5768626
	speed: 0.0060s/iter; left time: 0.2740s
Updating learning rate to 1.8831996359375e-06
Epoch: 8 cost time: 1.4960410594940186
Epoch: 8, Steps: 245 | Train Loss: 0.6925070 Vali Loss: 0.5773329 Best vali loss: 0.5462043

best validation loss 0.5462043448930975

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010548440798, 'e_layers': 3, 'learning_rate': 0.000303076751, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002915415790144598
Validation loss decreased (inf --> 0.6106).  Saving model state dict ...
Epoch: 1 cost time: 0.9272375106811523
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6105812 Best vali loss: 0.6105812
Updating learning rate to 0.00025869218842604336
Validation loss decreased (0.6106 --> 0.5843).  Saving model state dict ...
Epoch: 2 cost time: 0.6346423625946045
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5843399 Best vali loss: 0.5843399
Updating learning rate to 0.0002095296011713698
Validation loss decreased (0.5843 --> 0.5675).  Saving model state dict ...
Epoch: 3 cost time: 0.6334428787231445
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5675189 Best vali loss: 0.5675189
Updating learning rate to 0.0001515383755
Validation loss decreased (0.5675 --> 0.5585).  Saving model state dict ...
Epoch: 4 cost time: 0.6374735832214355
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5585142 Best vali loss: 0.5585142
Updating learning rate to 9.354714982863018e-05
Validation loss decreased (0.5585 --> 0.5426).  Saving model state dict ...
Epoch: 5 cost time: 0.6362528800964355
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5425508 Best vali loss: 0.5425508
Updating learning rate to 4.438456257395663e-05
Epoch: 6 cost time: 0.6411833763122559
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5513022 Best vali loss: 0.5425508
Updating learning rate to 1.1535171985540171e-05
Epoch: 7 cost time: 0.6364569664001465
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5528149 Best vali loss: 0.5425508
Updating learning rate to 0.0
Epoch: 8 cost time: 0.636476993560791
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5514842 Best vali loss: 0.5425508

best validation loss 0.5425507896258731

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0075497368763, 'e_layers': 2, 'learning_rate': 0.0002501506051, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7124907
	speed: 0.0097s/iter; left time: 37.2196s
	iters: 200, epoch: 1 | loss: 0.8323764
	speed: 0.0036s/iter; left time: 13.3474s
	iters: 300, epoch: 1 | loss: 0.6993977
	speed: 0.0036s/iter; left time: 13.0331s
	iters: 400, epoch: 1 | loss: 0.8670526
	speed: 0.0036s/iter; left time: 12.7911s
Updating learning rate to 0.0002501506051
Validation loss decreased (inf --> 0.5870).  Saving model state dict ...
Epoch: 1 cost time: 2.0979340076446533
Epoch: 1, Steps: 490 | Train Loss: 0.7778293 Vali Loss: 0.5869726 Best vali loss: 0.5869726
	iters: 100, epoch: 2 | loss: 0.9882109
	speed: 0.0101s/iter; left time: 33.7264s
	iters: 200, epoch: 2 | loss: 0.9521650
	speed: 0.0035s/iter; left time: 11.2125s
	iters: 300, epoch: 2 | loss: 0.5639867
	speed: 0.0036s/iter; left time: 11.2293s
	iters: 400, epoch: 2 | loss: 0.4047346
	speed: 0.0034s/iter; left time: 10.4539s
Updating learning rate to 0.00012507530255
Validation loss decreased (0.5870 --> 0.5533).  Saving model state dict ...
Epoch: 2 cost time: 1.7627537250518799
Epoch: 2, Steps: 490 | Train Loss: 0.7272743 Vali Loss: 0.5533162 Best vali loss: 0.5533162
	iters: 100, epoch: 3 | loss: 0.6633896
	speed: 0.0102s/iter; left time: 28.8645s
	iters: 200, epoch: 3 | loss: 0.8588966
	speed: 0.0036s/iter; left time: 9.9029s
	iters: 300, epoch: 3 | loss: 1.3731741
	speed: 0.0037s/iter; left time: 9.8284s
	iters: 400, epoch: 3 | loss: 0.6087354
	speed: 0.0037s/iter; left time: 9.3759s
Updating learning rate to 6.2537651275e-05
Validation loss decreased (0.5533 --> 0.5486).  Saving model state dict ...
Epoch: 3 cost time: 1.832444190979004
Epoch: 3, Steps: 490 | Train Loss: 0.8760489 Vali Loss: 0.5486193 Best vali loss: 0.5486193
	iters: 100, epoch: 4 | loss: 0.9033192
	speed: 0.0103s/iter; left time: 24.1163s
	iters: 200, epoch: 4 | loss: 1.1597810
	speed: 0.0034s/iter; left time: 7.7407s
	iters: 300, epoch: 4 | loss: 0.7937852
	speed: 0.0036s/iter; left time: 7.6635s
	iters: 400, epoch: 4 | loss: 1.0662537
	speed: 0.0036s/iter; left time: 7.3854s
Updating learning rate to 3.12688256375e-05
Validation loss decreased (0.5486 --> 0.5457).  Saving model state dict ...
Epoch: 4 cost time: 1.765148401260376
Epoch: 4, Steps: 490 | Train Loss: 0.9807848 Vali Loss: 0.5456759 Best vali loss: 0.5456759
	iters: 100, epoch: 5 | loss: 0.9337958
	speed: 0.0099s/iter; left time: 18.3957s
	iters: 200, epoch: 5 | loss: 0.7035600
	speed: 0.0034s/iter; left time: 5.9278s
	iters: 300, epoch: 5 | loss: 0.7773775
	speed: 0.0034s/iter; left time: 5.5672s
	iters: 400, epoch: 5 | loss: 0.4459495
	speed: 0.0034s/iter; left time: 5.2486s
Updating learning rate to 1.563441281875e-05
Validation loss decreased (0.5457 --> 0.5444).  Saving model state dict ...
Epoch: 5 cost time: 1.6973693370819092
Epoch: 5, Steps: 490 | Train Loss: 0.7151707 Vali Loss: 0.5444324 Best vali loss: 0.5444324
	iters: 100, epoch: 6 | loss: 0.5147206
	speed: 0.0100s/iter; left time: 13.6987s
	iters: 200, epoch: 6 | loss: 0.5153129
	speed: 0.0033s/iter; left time: 4.1580s
	iters: 300, epoch: 6 | loss: 0.7897271
	speed: 0.0035s/iter; left time: 4.0811s
	iters: 400, epoch: 6 | loss: 0.6198412
	speed: 0.0034s/iter; left time: 3.6645s
Updating learning rate to 7.817206409375e-06
Validation loss decreased (0.5444 --> 0.5424).  Saving model state dict ...
Epoch: 6 cost time: 1.7243964672088623
Epoch: 6, Steps: 490 | Train Loss: 0.6099004 Vali Loss: 0.5423862 Best vali loss: 0.5423862
	iters: 100, epoch: 7 | loss: 0.6993097
	speed: 0.0101s/iter; left time: 8.8571s
	iters: 200, epoch: 7 | loss: 0.3082969
	speed: 0.0033s/iter; left time: 2.6005s
	iters: 300, epoch: 7 | loss: 0.4318926
	speed: 0.0033s/iter; left time: 2.2417s
	iters: 400, epoch: 7 | loss: 0.3964755
	speed: 0.0033s/iter; left time: 1.8966s
Updating learning rate to 3.9086032046875e-06
Validation loss decreased (0.5424 --> 0.5408).  Saving model state dict ...
Epoch: 7 cost time: 1.6806557178497314
Epoch: 7, Steps: 490 | Train Loss: 0.4589937 Vali Loss: 0.5407676 Best vali loss: 0.5407676
	iters: 100, epoch: 8 | loss: 0.5170015
	speed: 0.0096s/iter; left time: 3.7341s
	iters: 200, epoch: 8 | loss: 0.6143094
	speed: 0.0033s/iter; left time: 0.9640s
	iters: 300, epoch: 8 | loss: 0.6692908
	speed: 0.0034s/iter; left time: 0.6545s
	iters: 400, epoch: 8 | loss: 0.4522878
	speed: 0.0034s/iter; left time: 0.3089s
Updating learning rate to 1.95430160234375e-06
Epoch: 8 cost time: 1.6976919174194336
Epoch: 8, Steps: 490 | Train Loss: 0.5632224 Vali Loss: 0.5408485 Best vali loss: 0.5407676

best validation loss 0.540767551295904

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.001056600175, 'e_layers': 3, 'learning_rate': 0.0003108164957, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00029898674722205615
Validation loss decreased (inf --> 0.6103).  Saving model state dict ...
Epoch: 1 cost time: 0.9278271198272705
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6103194 Best vali loss: 0.6103194
Updating learning rate to 0.00026529847375705466
Validation loss decreased (0.6103 --> 0.5902).  Saving model state dict ...
Epoch: 2 cost time: 0.6297636032104492
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5901851 Best vali loss: 0.5901851
Updating learning rate to 0.00021488040955508259
Validation loss decreased (0.5902 --> 0.5663).  Saving model state dict ...
Epoch: 3 cost time: 0.6312341690063477
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5662890 Best vali loss: 0.5662890

best validation loss 0.5662890145592202

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0118812089747, 'e_layers': 3, 'learning_rate': 0.002612032766, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8239893
	speed: 0.0110s/iter; left time: 20.4929s
	iters: 200, epoch: 1 | loss: 0.8498932
	speed: 0.0048s/iter; left time: 8.5210s
Updating learning rate to 0.002612032766
Validation loss decreased (inf --> 0.6280).  Saving model state dict ...
Epoch: 1 cost time: 1.538511037826538
Epoch: 1, Steps: 245 | Train Loss: 0.8369412 Vali Loss: 0.6279839 Best vali loss: 0.6279839
	iters: 100, epoch: 2 | loss: 0.9122632
	speed: 0.0096s/iter; left time: 15.4701s
	iters: 200, epoch: 2 | loss: 0.5106593
	speed: 0.0049s/iter; left time: 7.4854s
Updating learning rate to 0.001306016383
Epoch: 2 cost time: 1.2402138710021973
Epoch: 2, Steps: 245 | Train Loss: 0.7114612 Vali Loss: 0.6434987 Best vali loss: 0.6279839
	iters: 100, epoch: 3 | loss: 1.0281080
	speed: 0.0100s/iter; left time: 13.6818s
	iters: 200, epoch: 3 | loss: 0.8554208
	speed: 0.0050s/iter; left time: 6.3887s
Updating learning rate to 0.0006530081915
Epoch: 3 cost time: 1.2678470611572266
Epoch: 3, Steps: 245 | Train Loss: 0.9417644 Vali Loss: 0.6363393 Best vali loss: 0.6279839

best validation loss 0.6279839311744922

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.003139902724, 'e_layers': 1, 'learning_rate': 0.0019155585368, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8795410
	speed: 0.0089s/iter; left time: 16.4910s
	iters: 200, epoch: 1 | loss: 0.5417065
	speed: 0.0030s/iter; left time: 5.1997s
Updating learning rate to 0.0018426519311383943
Validation loss decreased (inf --> 0.6209).  Saving model state dict ...
Epoch: 1 cost time: 1.053074836730957
Epoch: 1, Steps: 245 | Train Loss: 0.7106238 Vali Loss: 0.6208944 Best vali loss: 0.6208944
	iters: 100, epoch: 2 | loss: 0.6562160
	speed: 0.0067s/iter; left time: 10.7936s
	iters: 200, epoch: 2 | loss: 0.8624693
	speed: 0.0031s/iter; left time: 4.6361s
Updating learning rate to 0.0016350314839655303
Epoch: 2 cost time: 0.799494743347168
Epoch: 2, Steps: 245 | Train Loss: 0.7593427 Vali Loss: 0.6302035 Best vali loss: 0.6208944
	iters: 100, epoch: 3 | loss: 1.0900457
	speed: 0.0069s/iter; left time: 9.4909s
	iters: 200, epoch: 3 | loss: 0.8120300
	speed: 0.0031s/iter; left time: 3.9183s
Updating learning rate to 0.0013243055262794367
Epoch: 3 cost time: 0.7995448112487793
Epoch: 3, Steps: 245 | Train Loss: 0.9510378 Vali Loss: 0.6303784 Best vali loss: 0.6208944

best validation loss 0.6208943747801121

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.001056600175, 'e_layers': 3, 'learning_rate': 0.0003108164957, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00015540824785
Validation loss decreased (0.5663 --> 0.5527).  Saving model state dict ...
Epoch: 4 cost time: 0.937812328338623
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5526834 Best vali loss: 0.5526834
Updating learning rate to 9.593608614491742e-05
Validation loss decreased (0.5527 --> 0.5417).  Saving model state dict ...
Epoch: 5 cost time: 0.6384212970733643
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5417344 Best vali loss: 0.5417344
Updating learning rate to 4.551802194294531e-05
Epoch: 6 cost time: 0.6383061408996582
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5426329 Best vali loss: 0.5417344
Updating learning rate to 1.1829748477943817e-05
Epoch: 7 cost time: 0.6310207843780518
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5462131 Best vali loss: 0.5417344
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6288478374481201
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5484891 Best vali loss: 0.5417344

best validation loss 0.5417344044999136

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0031826368376, 'e_layers': 1, 'learning_rate': 0.0001455209911, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7124150
	speed: 0.0090s/iter; left time: 16.8416s
	iters: 200, epoch: 1 | loss: 0.6807328
	speed: 0.0029s/iter; left time: 5.1834s
Updating learning rate to 0.0001455209911
Validation loss decreased (inf --> 0.6098).  Saving model state dict ...
Epoch: 1 cost time: 1.0729312896728516
Epoch: 1, Steps: 245 | Train Loss: 0.6965739 Vali Loss: 0.6098276 Best vali loss: 0.6098276
	iters: 100, epoch: 2 | loss: 0.8635820
	speed: 0.0065s/iter; left time: 10.5588s
	iters: 200, epoch: 2 | loss: 0.9690257
	speed: 0.0030s/iter; left time: 4.6021s
Updating learning rate to 7.276049555e-05
Validation loss decreased (0.6098 --> 0.6081).  Saving model state dict ...
Epoch: 2 cost time: 0.7777702808380127
Epoch: 2, Steps: 245 | Train Loss: 0.9163038 Vali Loss: 0.6080649 Best vali loss: 0.6080649
	iters: 100, epoch: 3 | loss: 1.0630969
	speed: 0.0067s/iter; left time: 9.1466s
	iters: 200, epoch: 3 | loss: 1.0831423
	speed: 0.0028s/iter; left time: 3.5891s
Updating learning rate to 3.6380247775e-05
Validation loss decreased (0.6081 --> 0.5966).  Saving model state dict ...
Epoch: 3 cost time: 0.7494840621948242
Epoch: 3, Steps: 245 | Train Loss: 1.0731196 Vali Loss: 0.5965586 Best vali loss: 0.5965586
	iters: 100, epoch: 4 | loss: 0.6516779
	speed: 0.0068s/iter; left time: 7.6822s
	iters: 200, epoch: 4 | loss: 0.6702236
	speed: 0.0031s/iter; left time: 3.1678s
Updating learning rate to 1.81901238875e-05
Epoch: 4 cost time: 0.8020350933074951
Epoch: 4, Steps: 245 | Train Loss: 0.6609508 Vali Loss: 0.6015608 Best vali loss: 0.5965586
	iters: 100, epoch: 5 | loss: 0.9993577
	speed: 0.0064s/iter; left time: 5.6632s
	iters: 200, epoch: 5 | loss: 0.6243318
	speed: 0.0028s/iter; left time: 2.2048s
Updating learning rate to 9.09506194375e-06
Epoch: 5 cost time: 0.7319450378417969
Epoch: 5, Steps: 245 | Train Loss: 0.8118447 Vali Loss: 0.6036823 Best vali loss: 0.5965586
	iters: 100, epoch: 6 | loss: 0.8881466
	speed: 0.0066s/iter; left time: 4.1902s
	iters: 200, epoch: 6 | loss: 0.7884476
	speed: 0.0030s/iter; left time: 1.5933s
Updating learning rate to 4.547530971875e-06
Epoch: 6 cost time: 0.7844898700714111
Epoch: 6, Steps: 245 | Train Loss: 0.8382971 Vali Loss: 0.6032786 Best vali loss: 0.5965586
	iters: 100, epoch: 7 | loss: 1.1198708
	speed: 0.0067s/iter; left time: 2.6366s
	iters: 200, epoch: 7 | loss: 0.9940720
	speed: 0.0029s/iter; left time: 0.8387s
Updating learning rate to 2.2737654859375e-06
Epoch: 7 cost time: 0.7590198516845703
Epoch: 7, Steps: 245 | Train Loss: 1.0569714 Vali Loss: 0.6035013 Best vali loss: 0.5965586
	iters: 100, epoch: 8 | loss: 0.8610362
	speed: 0.0065s/iter; left time: 0.9554s
	iters: 200, epoch: 8 | loss: 0.5513169
	speed: 0.0029s/iter; left time: 0.1344s
Updating learning rate to 1.13688274296875e-06
Epoch: 8 cost time: 0.7565126419067383
Epoch: 8, Steps: 245 | Train Loss: 0.7061766 Vali Loss: 0.6035519 Best vali loss: 0.5965586

best validation loss 0.5965586182752289

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0025533364842, 'e_layers': 2, 'learning_rate': 0.0001089222176, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7947262
	speed: 0.0098s/iter; left time: 18.1669s
	iters: 200, epoch: 1 | loss: 0.9480389
	speed: 0.0036s/iter; left time: 6.2547s
Updating learning rate to 0.0001089222176
Validation loss decreased (inf --> 0.6682).  Saving model state dict ...
Epoch: 1 cost time: 1.23612380027771
Epoch: 1, Steps: 245 | Train Loss: 0.8713826 Vali Loss: 0.6681853 Best vali loss: 0.6681853
	iters: 100, epoch: 2 | loss: 0.9962610
	speed: 0.0079s/iter; left time: 12.7903s
	iters: 200, epoch: 2 | loss: 1.0287732
	speed: 0.0037s/iter; left time: 5.6772s
Updating learning rate to 5.44611088e-05
Validation loss decreased (0.6682 --> 0.6378).  Saving model state dict ...
Epoch: 2 cost time: 0.9751546382904053
Epoch: 2, Steps: 245 | Train Loss: 1.0125171 Vali Loss: 0.6377633 Best vali loss: 0.6377633
	iters: 100, epoch: 3 | loss: 0.5848314
	speed: 0.0081s/iter; left time: 11.1242s
	iters: 200, epoch: 3 | loss: 1.0989192
	speed: 0.0037s/iter; left time: 4.6759s
Updating learning rate to 2.72305544e-05
Validation loss decreased (0.6378 --> 0.6285).  Saving model state dict ...
Epoch: 3 cost time: 0.9735660552978516
Epoch: 3, Steps: 245 | Train Loss: 0.8418753 Vali Loss: 0.6285304 Best vali loss: 0.6285304
	iters: 100, epoch: 4 | loss: 0.8318051
	speed: 0.0080s/iter; left time: 9.0225s
	iters: 200, epoch: 4 | loss: 0.7001223
	speed: 0.0037s/iter; left time: 3.8007s
Updating learning rate to 1.36152772e-05
Validation loss decreased (0.6285 --> 0.6261).  Saving model state dict ...
Epoch: 4 cost time: 0.9629673957824707
Epoch: 4, Steps: 245 | Train Loss: 0.7659637 Vali Loss: 0.6260731 Best vali loss: 0.6260731
	iters: 100, epoch: 5 | loss: 0.7705263
	speed: 0.0082s/iter; left time: 7.1998s
	iters: 200, epoch: 5 | loss: 0.8209962
	speed: 0.0039s/iter; left time: 3.0416s
Updating learning rate to 6.8076386e-06
Validation loss decreased (0.6261 --> 0.6249).  Saving model state dict ...
Epoch: 5 cost time: 0.9955103397369385
Epoch: 5, Steps: 245 | Train Loss: 0.7957613 Vali Loss: 0.6248557 Best vali loss: 0.6248557
	iters: 100, epoch: 6 | loss: 0.9112118
	speed: 0.0077s/iter; left time: 4.9118s
	iters: 200, epoch: 6 | loss: 0.5441855
	speed: 0.0035s/iter; left time: 1.8723s
Updating learning rate to 3.4038193e-06
Validation loss decreased (0.6249 --> 0.6241).  Saving model state dict ...
Epoch: 6 cost time: 0.9179794788360596
Epoch: 6, Steps: 245 | Train Loss: 0.7276986 Vali Loss: 0.6241161 Best vali loss: 0.6241161
	iters: 100, epoch: 7 | loss: 0.9631099
	speed: 0.0076s/iter; left time: 2.9806s
	iters: 200, epoch: 7 | loss: 1.3825318
	speed: 0.0035s/iter; left time: 1.0185s
Updating learning rate to 1.70190965e-06
Validation loss decreased (0.6241 --> 0.6238).  Saving model state dict ...
Epoch: 7 cost time: 0.9054374694824219
Epoch: 7, Steps: 245 | Train Loss: 1.1728208 Vali Loss: 0.6238232 Best vali loss: 0.6238232
	iters: 100, epoch: 8 | loss: 0.9609946
	speed: 0.0079s/iter; left time: 1.1470s
	iters: 200, epoch: 8 | loss: 1.0927767
	speed: 0.0039s/iter; left time: 0.1786s
Updating learning rate to 8.50954825e-07
Validation loss decreased (0.6238 --> 0.6237).  Saving model state dict ...
Epoch: 8 cost time: 1.0003623962402344
Epoch: 8, Steps: 245 | Train Loss: 1.0268856 Vali Loss: 0.6236663 Best vali loss: 0.6236663

best validation loss 0.6236662996388982

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001756695467, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616602
	speed: 0.0119s/iter; left time: 10.4885s
Updating learning rate to 0.00016898352269083283
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.040231466293335
Epoch: 1, Steps: 123 | Train Loss: 0.7616602 Vali Loss: 0.6075402 Best vali loss: 0.6075402
	iters: 100, epoch: 2 | loss: 0.9375784
	speed: 0.0092s/iter; left time: 6.9985s
Updating learning rate to 0.00014994333720976845
Validation loss decreased (0.6075 --> 0.5706).  Saving model state dict ...
Epoch: 2 cost time: 0.7180023193359375
Epoch: 2, Steps: 123 | Train Loss: 0.9375784 Vali Loss: 0.5705547 Best vali loss: 0.5705547
	iters: 100, epoch: 3 | loss: 0.8559350
	speed: 0.0094s/iter; left time: 5.9775s
Updating learning rate to 0.00012144768589658773
Validation loss decreased (0.5706 --> 0.5361).  Saving model state dict ...
Epoch: 3 cost time: 0.7245872020721436
Epoch: 3, Steps: 123 | Train Loss: 0.8559350 Vali Loss: 0.5361493 Best vali loss: 0.5361493

best validation loss 0.5361492973905314

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008561582299, 'e_layers': 3, 'learning_rate': 0.0003507976907, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7462472
	speed: 0.0103s/iter; left time: 79.9540s
	iters: 200, epoch: 1 | loss: 0.9446157
	speed: 0.0043s/iter; left time: 32.7148s
	iters: 300, epoch: 1 | loss: 0.7693130
	speed: 0.0041s/iter; left time: 31.1985s
	iters: 400, epoch: 1 | loss: 1.9559299
	speed: 0.0045s/iter; left time: 33.2581s
	iters: 500, epoch: 1 | loss: 0.3923191
	speed: 0.0045s/iter; left time: 32.8917s
	iters: 600, epoch: 1 | loss: 0.5686982
	speed: 0.0043s/iter; left time: 31.2053s
	iters: 700, epoch: 1 | loss: 0.3080941
	speed: 0.0041s/iter; left time: 29.5621s
	iters: 800, epoch: 1 | loss: 0.4744527
	speed: 0.0042s/iter; left time: 29.7117s
	iters: 900, epoch: 1 | loss: 1.0772620
	speed: 0.0042s/iter; left time: 28.8422s
Updating learning rate to 0.0003507976907
Validation loss decreased (inf --> 0.6405).  Saving model state dict ...
Epoch: 1 cost time: 4.528507471084595
Epoch: 1, Steps: 979 | Train Loss: 0.8041036 Vali Loss: 0.6404856 Best vali loss: 0.6404856
	iters: 100, epoch: 2 | loss: 1.1803753
	speed: 0.0134s/iter; left time: 90.6532s
	iters: 200, epoch: 2 | loss: 0.6130574
	speed: 0.0044s/iter; left time: 29.3635s
	iters: 300, epoch: 2 | loss: 1.7167280
	speed: 0.0044s/iter; left time: 28.6224s
	iters: 400, epoch: 2 | loss: 0.9415773
	speed: 0.0044s/iter; left time: 28.5734s
	iters: 500, epoch: 2 | loss: 0.3888407
	speed: 0.0045s/iter; left time: 28.3042s
	iters: 600, epoch: 2 | loss: 0.7371605
	speed: 0.0042s/iter; left time: 26.2216s
	iters: 700, epoch: 2 | loss: 0.9376130
	speed: 0.0040s/iter; left time: 24.6011s
	iters: 800, epoch: 2 | loss: 0.6131089
	speed: 0.0039s/iter; left time: 23.7165s
	iters: 900, epoch: 2 | loss: 0.3813267
	speed: 0.0041s/iter; left time: 24.6163s
Updating learning rate to 0.00017539884535
Validation loss decreased (0.6405 --> 0.6399).  Saving model state dict ...
Epoch: 2 cost time: 4.158692121505737
Epoch: 2, Steps: 979 | Train Loss: 0.8344209 Vali Loss: 0.6399380 Best vali loss: 0.6399380
	iters: 100, epoch: 3 | loss: 1.0555764
	speed: 0.0139s/iter; left time: 80.3546s
	iters: 200, epoch: 3 | loss: 1.5082028
	speed: 0.0044s/iter; left time: 25.0655s
	iters: 300, epoch: 3 | loss: 0.4724019
	speed: 0.0042s/iter; left time: 23.3796s
	iters: 400, epoch: 3 | loss: 1.3736793
	speed: 0.0042s/iter; left time: 22.7363s
	iters: 500, epoch: 3 | loss: 1.3802840
	speed: 0.0040s/iter; left time: 21.7526s
	iters: 600, epoch: 3 | loss: 0.2577181
	speed: 0.0041s/iter; left time: 21.8219s
	iters: 700, epoch: 3 | loss: 1.0856556
	speed: 0.0041s/iter; left time: 21.0068s
	iters: 800, epoch: 3 | loss: 0.5109446
	speed: 0.0041s/iter; left time: 20.8806s
	iters: 900, epoch: 3 | loss: 0.5678744
	speed: 0.0042s/iter; left time: 20.8536s
Updating learning rate to 8.7699422675e-05
Epoch: 3 cost time: 4.155329942703247
Epoch: 3, Steps: 979 | Train Loss: 0.9124819 Vali Loss: 0.6466585 Best vali loss: 0.6399380

best validation loss 0.6399379575186336

[INFO][smbo.py:320] Finished 1100 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001752726456, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7615901
	speed: 0.0115s/iter; left time: 10.1875s
Updating learning rate to 0.00016860172773947222
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 1.0186409950256348
Epoch: 1, Steps: 123 | Train Loss: 0.7615901 Vali Loss: 0.6075278 Best vali loss: 0.6075278
	iters: 100, epoch: 2 | loss: 0.9371821
	speed: 0.0092s/iter; left time: 7.0173s
Updating learning rate to 0.00014960456093013325
Validation loss decreased (0.6075 --> 0.5702).  Saving model state dict ...
Epoch: 2 cost time: 0.7137618064880371
Epoch: 2, Steps: 123 | Train Loss: 0.9371821 Vali Loss: 0.5701511 Best vali loss: 0.5701511
	iters: 100, epoch: 3 | loss: 0.8567370
	speed: 0.0093s/iter; left time: 5.9284s
Updating learning rate to 0.00012117329160895899
Validation loss decreased (0.5702 --> 0.5475).  Saving model state dict ...
Epoch: 3 cost time: 0.7147655487060547
Epoch: 3, Steps: 123 | Train Loss: 0.8567370 Vali Loss: 0.5474877 Best vali loss: 0.5474877

best validation loss 0.5474876933547977

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001756695467, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6009796
	speed: 0.0120s/iter; left time: 6.2058s
Updating learning rate to 8.783477335e-05
Validation loss decreased (0.5361 --> 0.5331).  Saving model state dict ...
Epoch: 4 cost time: 1.0294747352600098
Epoch: 4, Steps: 123 | Train Loss: 0.6009796 Vali Loss: 0.5331331 Best vali loss: 0.5331331
	iters: 100, epoch: 5 | loss: 0.8481876
	speed: 0.0094s/iter; left time: 3.7033s
Updating learning rate to 5.422186080341229e-05
Validation loss decreased (0.5331 --> 0.5278).  Saving model state dict ...
Epoch: 5 cost time: 0.7141256332397461
Epoch: 5, Steps: 123 | Train Loss: 0.8481876 Vali Loss: 0.5278422 Best vali loss: 0.5278422
	iters: 100, epoch: 6 | loss: 0.8039980
	speed: 0.0094s/iter; left time: 2.5373s
Updating learning rate to 2.5726209490231562e-05
Epoch: 6 cost time: 0.7231459617614746
Epoch: 6, Steps: 123 | Train Loss: 0.8039980 Vali Loss: 0.5298456 Best vali loss: 0.5278422
	iters: 100, epoch: 7 | loss: 0.4803523
	speed: 0.0089s/iter; left time: 1.3154s
Updating learning rate to 6.686024009167173e-06
Epoch: 7 cost time: 0.7220256328582764
Epoch: 7, Steps: 123 | Train Loss: 0.4803523 Vali Loss: 0.5290741 Best vali loss: 0.5278422
	iters: 100, epoch: 8 | loss: 0.5520172
	speed: 0.0091s/iter; left time: 0.2186s
Updating learning rate to 0.0
Validation loss decreased (0.5278 --> 0.5259).  Saving model state dict ...
Epoch: 8 cost time: 0.7188804149627686
Epoch: 8, Steps: 123 | Train Loss: 0.5520172 Vali Loss: 0.5259281 Best vali loss: 0.5259281

best validation loss 0.5259280723314051

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0037480653873, 'e_layers': 2, 'learning_rate': 0.0014365756191, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9631199
	speed: 0.0095s/iter; left time: 73.3872s
	iters: 200, epoch: 1 | loss: 0.7941914
	speed: 0.0034s/iter; left time: 26.0161s
	iters: 300, epoch: 1 | loss: 1.1129813
	speed: 0.0031s/iter; left time: 23.5926s
	iters: 400, epoch: 1 | loss: 1.0283725
	speed: 0.0030s/iter; left time: 22.2693s
	iters: 500, epoch: 1 | loss: 1.1788493
	speed: 0.0031s/iter; left time: 22.5346s
	iters: 600, epoch: 1 | loss: 0.4841009
	speed: 0.0030s/iter; left time: 21.8550s
	iters: 700, epoch: 1 | loss: 1.0020962
	speed: 0.0030s/iter; left time: 21.4261s
	iters: 800, epoch: 1 | loss: 1.1707940
	speed: 0.0032s/iter; left time: 22.3424s
	iters: 900, epoch: 1 | loss: 0.7681564
	speed: 0.0030s/iter; left time: 21.1221s
Updating learning rate to 0.0013818992152456102
Validation loss decreased (inf --> 0.6131).  Saving model state dict ...
Epoch: 1 cost time: 3.4176506996154785
Epoch: 1, Steps: 979 | Train Loss: 0.9447402 Vali Loss: 0.6130604 Best vali loss: 0.6130604
	iters: 100, epoch: 2 | loss: 0.8554423
	speed: 0.0113s/iter; left time: 76.3642s
	iters: 200, epoch: 2 | loss: 0.4390183
	speed: 0.0034s/iter; left time: 22.7613s
	iters: 300, epoch: 2 | loss: 0.7304120
	speed: 0.0033s/iter; left time: 21.6056s
	iters: 400, epoch: 2 | loss: 1.1198367
	speed: 0.0034s/iter; left time: 22.2117s
	iters: 500, epoch: 2 | loss: 0.6478908
	speed: 0.0034s/iter; left time: 21.5020s
	iters: 600, epoch: 2 | loss: 0.9209884
	speed: 0.0034s/iter; left time: 21.3733s
	iters: 700, epoch: 2 | loss: 0.6004837
	speed: 0.0033s/iter; left time: 20.4606s
	iters: 800, epoch: 2 | loss: 0.3402472
	speed: 0.0031s/iter; left time: 18.6440s
	iters: 900, epoch: 2 | loss: 0.2874713
	speed: 0.0030s/iter; left time: 18.0467s
Updating learning rate to 0.0012261939905264365
Validation loss decreased (0.6131 --> 0.6020).  Saving model state dict ...
Epoch: 2 cost time: 3.274155855178833
Epoch: 2, Steps: 979 | Train Loss: 0.6601990 Vali Loss: 0.6019976 Best vali loss: 0.6019976
	iters: 100, epoch: 3 | loss: 0.8952472
	speed: 0.0108s/iter; left time: 62.2977s
	iters: 200, epoch: 3 | loss: 1.0728114
	speed: 0.0032s/iter; left time: 18.0565s
	iters: 300, epoch: 3 | loss: 0.9549471
	speed: 0.0032s/iter; left time: 17.7080s
	iters: 400, epoch: 3 | loss: 0.6809420
	speed: 0.0032s/iter; left time: 17.6400s
	iters: 500, epoch: 3 | loss: 1.0305696
	speed: 0.0031s/iter; left time: 16.4492s
	iters: 600, epoch: 3 | loss: 0.7595483
	speed: 0.0031s/iter; left time: 16.5420s
	iters: 700, epoch: 3 | loss: 0.9378392
	speed: 0.0032s/iter; left time: 16.4281s
	iters: 800, epoch: 3 | loss: 1.3250364
	speed: 0.0032s/iter; left time: 16.1472s
	iters: 900, epoch: 3 | loss: 0.5634504
	speed: 0.0030s/iter; left time: 14.8611s
Updating learning rate to 0.000993164653934596
Epoch: 3 cost time: 3.1200852394104004
Epoch: 3, Steps: 979 | Train Loss: 0.9133768 Vali Loss: 0.6197863 Best vali loss: 0.6019976
	iters: 100, epoch: 4 | loss: 0.4517691
	speed: 0.0111s/iter; left time: 53.0714s
	iters: 200, epoch: 4 | loss: 0.3402447
	speed: 0.0035s/iter; left time: 16.4511s
	iters: 300, epoch: 4 | loss: 0.7211350
	speed: 0.0035s/iter; left time: 16.1603s
	iters: 400, epoch: 4 | loss: 1.0246354
	speed: 0.0035s/iter; left time: 15.7643s
	iters: 500, epoch: 4 | loss: 0.2175549
	speed: 0.0035s/iter; left time: 15.3029s
	iters: 600, epoch: 4 | loss: 0.8480169
	speed: 0.0035s/iter; left time: 14.9733s
	iters: 700, epoch: 4 | loss: 0.7746902
	speed: 0.0035s/iter; left time: 14.6498s
	iters: 800, epoch: 4 | loss: 0.9253868
	speed: 0.0035s/iter; left time: 14.2232s
	iters: 900, epoch: 4 | loss: 0.6702403
	speed: 0.0035s/iter; left time: 13.8397s
Updating learning rate to 0.00071828780955
Epoch: 4 cost time: 3.4604709148406982
Epoch: 4, Steps: 979 | Train Loss: 0.6637415 Vali Loss: 0.6090785 Best vali loss: 0.6019976
	iters: 100, epoch: 5 | loss: 0.8850462
	speed: 0.0111s/iter; left time: 42.5019s
	iters: 200, epoch: 5 | loss: 0.4620221
	speed: 0.0030s/iter; left time: 11.2685s
	iters: 300, epoch: 5 | loss: 0.4646488
	speed: 0.0031s/iter; left time: 11.0393s
	iters: 400, epoch: 5 | loss: 0.6329449
	speed: 0.0031s/iter; left time: 10.9332s
	iters: 500, epoch: 5 | loss: 1.6454542
	speed: 0.0031s/iter; left time: 10.6329s
	iters: 600, epoch: 5 | loss: 0.6523815
	speed: 0.0032s/iter; left time: 10.5951s
	iters: 700, epoch: 5 | loss: 0.8400819
	speed: 0.0031s/iter; left time: 10.0670s
	iters: 800, epoch: 5 | loss: 0.4553871
	speed: 0.0031s/iter; left time: 9.7943s
	iters: 900, epoch: 5 | loss: 0.4730773
	speed: 0.0031s/iter; left time: 9.3289s
Updating learning rate to 0.0004434109651654041
Epoch: 5 cost time: 3.089010238647461
Epoch: 5, Steps: 979 | Train Loss: 0.7234493 Vali Loss: 0.6632141 Best vali loss: 0.6019976
	iters: 100, epoch: 6 | loss: 1.1393375
	speed: 0.0108s/iter; left time: 30.6208s
	iters: 200, epoch: 6 | loss: 0.5284275
	speed: 0.0033s/iter; left time: 9.1702s
	iters: 300, epoch: 6 | loss: 0.4225586
	speed: 0.0034s/iter; left time: 8.8679s
	iters: 400, epoch: 6 | loss: 0.3842466
	speed: 0.0034s/iter; left time: 8.5732s
	iters: 500, epoch: 6 | loss: 0.2799807
	speed: 0.0034s/iter; left time: 8.3578s
	iters: 600, epoch: 6 | loss: 0.8016940
	speed: 0.0031s/iter; left time: 7.2014s
	iters: 700, epoch: 6 | loss: 0.6727090
	speed: 0.0029s/iter; left time: 6.4935s
	iters: 800, epoch: 6 | loss: 1.3767390
	speed: 0.0030s/iter; left time: 6.3810s
	iters: 900, epoch: 6 | loss: 1.1339259
	speed: 0.0029s/iter; left time: 5.9963s
Updating learning rate to 0.00021038162857356369
Epoch: 6 cost time: 3.144296407699585
Epoch: 6, Steps: 979 | Train Loss: 0.7488466 Vali Loss: 0.6489365 Best vali loss: 0.6019976
	iters: 100, epoch: 7 | loss: 1.1836711
	speed: 0.0111s/iter; left time: 20.6081s
	iters: 200, epoch: 7 | loss: 0.8420081
	speed: 0.0037s/iter; left time: 6.5890s
	iters: 300, epoch: 7 | loss: 1.0794803
	speed: 0.0034s/iter; left time: 5.6506s
	iters: 400, epoch: 7 | loss: 0.7340688
	speed: 0.0035s/iter; left time: 5.4155s
	iters: 500, epoch: 7 | loss: 1.6801373
	speed: 0.0034s/iter; left time: 4.9471s
	iters: 600, epoch: 7 | loss: 0.3157700
	speed: 0.0033s/iter; left time: 4.5217s
	iters: 700, epoch: 7 | loss: 0.4289662
	speed: 0.0032s/iter; left time: 3.9976s
	iters: 800, epoch: 7 | loss: 1.2469344
	speed: 0.0033s/iter; left time: 3.8002s
	iters: 900, epoch: 7 | loss: 0.7615090
	speed: 0.0030s/iter; left time: 3.1749s
Updating learning rate to 5.467640385438984e-05
Epoch: 7 cost time: 3.317852020263672
Epoch: 7, Steps: 979 | Train Loss: 0.9191717 Vali Loss: 0.6639833 Best vali loss: 0.6019976
	iters: 100, epoch: 8 | loss: 0.5268582
	speed: 0.0105s/iter; left time: 9.2051s
	iters: 200, epoch: 8 | loss: 0.3850939
	speed: 0.0031s/iter; left time: 2.3855s
	iters: 300, epoch: 8 | loss: 0.4165344
	speed: 0.0030s/iter; left time: 2.0456s
	iters: 400, epoch: 8 | loss: 1.2153454
	speed: 0.0031s/iter; left time: 1.7765s
	iters: 500, epoch: 8 | loss: 0.8101196
	speed: 0.0030s/iter; left time: 1.4244s
	iters: 600, epoch: 8 | loss: 0.3734215
	speed: 0.0030s/iter; left time: 1.1228s
	iters: 700, epoch: 8 | loss: 0.6801866
	speed: 0.0029s/iter; left time: 0.8100s
	iters: 800, epoch: 8 | loss: 0.3277763
	speed: 0.0029s/iter; left time: 0.5290s
	iters: 900, epoch: 8 | loss: 0.9425899
	speed: 0.0029s/iter; left time: 0.2288s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.959195852279663
Epoch: 8, Steps: 979 | Train Loss: 0.6308806 Vali Loss: 0.6697099 Best vali loss: 0.6019976

best validation loss 0.6019975766711961

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0090125383582, 'e_layers': 1, 'learning_rate': 0.0007370951703, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8528890
	speed: 0.0101s/iter; left time: 8.9677s
Updating learning rate to 0.0007370951703
Validation loss decreased (inf --> 0.6255).  Saving model state dict ...
Epoch: 1 cost time: 0.8120942115783691
Epoch: 1, Steps: 123 | Train Loss: 0.8528890 Vali Loss: 0.6255317 Best vali loss: 0.6255317
	iters: 100, epoch: 2 | loss: 0.8636726
	speed: 0.0067s/iter; left time: 5.0688s
Updating learning rate to 0.00036854758515
Validation loss decreased (0.6255 --> 0.6043).  Saving model state dict ...
Epoch: 2 cost time: 0.5076732635498047
Epoch: 2, Steps: 123 | Train Loss: 0.8636726 Vali Loss: 0.6042988 Best vali loss: 0.6042988
	iters: 100, epoch: 3 | loss: 0.9137610
	speed: 0.0068s/iter; left time: 4.3412s
Updating learning rate to 0.000184273792575
Validation loss decreased (0.6043 --> 0.6038).  Saving model state dict ...
Epoch: 3 cost time: 0.5145468711853027
Epoch: 3, Steps: 123 | Train Loss: 0.9137610 Vali Loss: 0.6038186 Best vali loss: 0.6038186
	iters: 100, epoch: 4 | loss: 0.7671507
	speed: 0.0067s/iter; left time: 3.4558s
Updating learning rate to 9.21368962875e-05
Validation loss decreased (0.6038 --> 0.6003).  Saving model state dict ...
Epoch: 4 cost time: 0.5059406757354736
Epoch: 4, Steps: 123 | Train Loss: 0.7671507 Vali Loss: 0.6003288 Best vali loss: 0.6003288
	iters: 100, epoch: 5 | loss: 0.7651337
	speed: 0.0066s/iter; left time: 2.5866s
Updating learning rate to 4.606844814375e-05
Epoch: 5 cost time: 0.49015116691589355
Epoch: 5, Steps: 123 | Train Loss: 0.7651337 Vali Loss: 0.6015723 Best vali loss: 0.6003288
	iters: 100, epoch: 6 | loss: 1.0724719
	speed: 0.0067s/iter; left time: 1.8099s
Updating learning rate to 2.3034224071875e-05
Epoch: 6 cost time: 0.5029466152191162
Epoch: 6, Steps: 123 | Train Loss: 1.0724719 Vali Loss: 0.6008829 Best vali loss: 0.6003288
	iters: 100, epoch: 7 | loss: 0.7414953
	speed: 0.0066s/iter; left time: 0.9699s
Updating learning rate to 1.15171120359375e-05
Epoch: 7 cost time: 0.4980802536010742
Epoch: 7, Steps: 123 | Train Loss: 0.7414953 Vali Loss: 0.6010123 Best vali loss: 0.6003288
	iters: 100, epoch: 8 | loss: 0.8222416
	speed: 0.0067s/iter; left time: 0.1618s
Updating learning rate to 5.75855601796875e-06
Epoch: 8 cost time: 0.506983757019043
Epoch: 8, Steps: 123 | Train Loss: 0.8222416 Vali Loss: 0.6008816 Best vali loss: 0.6003288

best validation loss 0.6003288448491289

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0017530519882, 'e_layers': 4, 'learning_rate': 0.0006408553171, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8037720
	speed: 0.0122s/iter; left time: 46.4867s
	iters: 200, epoch: 1 | loss: 1.6547767
	speed: 0.0057s/iter; left time: 21.3632s
	iters: 300, epoch: 1 | loss: 1.0360188
	speed: 0.0057s/iter; left time: 20.6344s
	iters: 400, epoch: 1 | loss: 0.8151444
	speed: 0.0058s/iter; left time: 20.2881s
Updating learning rate to 0.0006408553171
Validation loss decreased (inf --> 0.6526).  Saving model state dict ...
Epoch: 1 cost time: 3.173214912414551
Epoch: 1, Steps: 490 | Train Loss: 1.0774280 Vali Loss: 0.6526007 Best vali loss: 0.6526007
	iters: 100, epoch: 2 | loss: 1.0926740
	speed: 0.0155s/iter; left time: 51.7028s
	iters: 200, epoch: 2 | loss: 1.1352341
	speed: 0.0058s/iter; left time: 18.8212s
	iters: 300, epoch: 2 | loss: 0.8785321
	speed: 0.0060s/iter; left time: 18.7831s
	iters: 400, epoch: 2 | loss: 0.7243111
	speed: 0.0059s/iter; left time: 17.9245s
Updating learning rate to 0.00032042765855
Validation loss decreased (0.6526 --> 0.6401).  Saving model state dict ...
Epoch: 2 cost time: 2.8956961631774902
Epoch: 2, Steps: 490 | Train Loss: 0.9576878 Vali Loss: 0.6401166 Best vali loss: 0.6401166
	iters: 100, epoch: 3 | loss: 0.7515529
	speed: 0.0158s/iter; left time: 44.9457s
	iters: 200, epoch: 3 | loss: 0.5339903
	speed: 0.0057s/iter; left time: 15.5185s
	iters: 300, epoch: 3 | loss: 0.9769101
	speed: 0.0056s/iter; left time: 14.7373s
	iters: 400, epoch: 3 | loss: 1.0139755
	speed: 0.0057s/iter; left time: 14.3841s
Updating learning rate to 0.000160213829275
Epoch: 3 cost time: 2.808373212814331
Epoch: 3, Steps: 490 | Train Loss: 0.8191072 Vali Loss: 0.6412224 Best vali loss: 0.6401166

best validation loss 0.6401165545000516

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0011660683425, 'e_layers': 1, 'learning_rate': 8.94548871e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4120482
	speed: 0.0091s/iter; left time: 34.7850s
	iters: 200, epoch: 1 | loss: 0.7720497
	speed: 0.0027s/iter; left time: 10.0209s
	iters: 300, epoch: 1 | loss: 0.4352679
	speed: 0.0028s/iter; left time: 10.0374s
	iters: 400, epoch: 1 | loss: 0.9969696
	speed: 0.0028s/iter; left time: 9.9960s
Updating learning rate to 8.94548871e-05
Validation loss decreased (inf --> 0.6676).  Saving model state dict ...
Epoch: 1 cost time: 1.679699182510376
Epoch: 1, Steps: 490 | Train Loss: 0.9040838 Vali Loss: 0.6675735 Best vali loss: 0.6675735
	iters: 100, epoch: 2 | loss: 0.6041439
	speed: 0.0079s/iter; left time: 26.4461s
	iters: 200, epoch: 2 | loss: 0.7025471
	speed: 0.0026s/iter; left time: 8.2638s
	iters: 300, epoch: 2 | loss: 0.7861904
	speed: 0.0026s/iter; left time: 8.0099s
	iters: 400, epoch: 2 | loss: 0.8670337
	speed: 0.0025s/iter; left time: 7.5250s
Updating learning rate to 4.472744355e-05
Validation loss decreased (0.6676 --> 0.6395).  Saving model state dict ...
Epoch: 2 cost time: 1.2841501235961914
Epoch: 2, Steps: 490 | Train Loss: 0.7399788 Vali Loss: 0.6395261 Best vali loss: 0.6395261
	iters: 100, epoch: 3 | loss: 1.4431347
	speed: 0.0080s/iter; left time: 22.6324s
	iters: 200, epoch: 3 | loss: 0.5246827
	speed: 0.0026s/iter; left time: 7.0388s
	iters: 300, epoch: 3 | loss: 0.6272548
	speed: 0.0025s/iter; left time: 6.5286s
	iters: 400, epoch: 3 | loss: 0.6971135
	speed: 0.0025s/iter; left time: 6.3933s
Updating learning rate to 2.2363721775e-05
Validation loss decreased (0.6395 --> 0.6313).  Saving model state dict ...
Epoch: 3 cost time: 1.2859876155853271
Epoch: 3, Steps: 490 | Train Loss: 0.8230464 Vali Loss: 0.6313041 Best vali loss: 0.6313041

best validation loss 0.6313041208009376

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015105359905, 'e_layers': 4, 'learning_rate': 0.0009731232443, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9461523
	speed: 0.0122s/iter; left time: 10.7953s
Updating learning rate to 0.0009360859461598754
Validation loss decreased (inf --> 0.6055).  Saving model state dict ...
Epoch: 1 cost time: 1.0936927795410156
Epoch: 1, Steps: 123 | Train Loss: 0.9461523 Vali Loss: 0.6055279 Best vali loss: 0.6055279
	iters: 100, epoch: 2 | loss: 0.8408088
	speed: 0.0099s/iter; left time: 7.5099s
Updating learning rate to 0.0008306126446373916
Epoch: 2 cost time: 0.817493200302124
Epoch: 2, Steps: 123 | Train Loss: 0.8408088 Vali Loss: 0.6057996 Best vali loss: 0.6055279
	iters: 100, epoch: 3 | loss: 1.0195316
	speed: 0.0098s/iter; left time: 6.2674s
Updating learning rate to 0.000672760693771488
Epoch: 3 cost time: 0.8153784275054932
Epoch: 3, Steps: 123 | Train Loss: 1.0195316 Vali Loss: 0.6081813 Best vali loss: 0.6055279

best validation loss 0.6055278736703211

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015105359905, 'e_layers': 4, 'learning_rate': 0.0009731232443, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8956068
	speed: 0.0125s/iter; left time: 6.4329s
Updating learning rate to 0.00048656162215
Validation loss decreased (0.6055 --> 0.6032).  Saving model state dict ...
Epoch: 4 cost time: 1.1000189781188965
Epoch: 4, Steps: 123 | Train Loss: 0.8956068 Vali Loss: 0.6032448 Best vali loss: 0.6032448
	iters: 100, epoch: 5 | loss: 0.7998456
	speed: 0.0093s/iter; left time: 3.6708s
Updating learning rate to 0.00030036255052851214
Validation loss decreased (0.6032 --> 0.5962).  Saving model state dict ...
Epoch: 5 cost time: 0.7474398612976074
Epoch: 5, Steps: 123 | Train Loss: 0.7998456 Vali Loss: 0.5961522 Best vali loss: 0.5961522
	iters: 100, epoch: 6 | loss: 0.9731413
	speed: 0.0091s/iter; left time: 2.4483s
Updating learning rate to 0.00014251059966260838
Epoch: 6 cost time: 0.7361776828765869
Epoch: 6, Steps: 123 | Train Loss: 0.9731413 Vali Loss: 0.6003993 Best vali loss: 0.5961522
	iters: 100, epoch: 7 | loss: 0.6102313
	speed: 0.0090s/iter; left time: 1.3206s
Updating learning rate to 3.703729814012466e-05
Validation loss decreased (0.5962 --> 0.5779).  Saving model state dict ...
Epoch: 7 cost time: 0.7400236129760742
Epoch: 7, Steps: 123 | Train Loss: 0.6102313 Vali Loss: 0.5779058 Best vali loss: 0.5779058
	iters: 100, epoch: 8 | loss: 0.7223824
	speed: 0.0092s/iter; left time: 0.2203s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7454495429992676
Epoch: 8, Steps: 123 | Train Loss: 0.7223824 Vali Loss: 0.5784170 Best vali loss: 0.5779058

best validation loss 0.5779057611805706

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010500370728, 'e_layers': 3, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8376383
	speed: 0.0143s/iter; left time: 12.6483s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 1.3271830081939697
Epoch: 1, Steps: 123 | Train Loss: 0.8376383 Vali Loss: 0.6035365 Best vali loss: 0.6035365
	iters: 100, epoch: 2 | loss: 0.6296830
	speed: 0.0123s/iter; left time: 9.3672s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6035 --> 0.5502).  Saving model state dict ...
Epoch: 2 cost time: 1.0036330223083496
Epoch: 2, Steps: 123 | Train Loss: 0.6296830 Vali Loss: 0.5501726 Best vali loss: 0.5501726
	iters: 100, epoch: 3 | loss: 1.0907617
	speed: 0.0125s/iter; left time: 7.9841s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5502 --> 0.5368).  Saving model state dict ...
Epoch: 3 cost time: 1.0110132694244385
Epoch: 3, Steps: 123 | Train Loss: 1.0907617 Vali Loss: 0.5367673 Best vali loss: 0.5367673
	iters: 100, epoch: 4 | loss: 0.6918122
	speed: 0.0126s/iter; left time: 6.5149s
Updating learning rate to 0.0001489163497
Epoch: 4 cost time: 1.0143237113952637
Epoch: 4, Steps: 123 | Train Loss: 0.6918122 Vali Loss: 0.5434771 Best vali loss: 0.5367673
	iters: 100, epoch: 5 | loss: 0.7925692
	speed: 0.0121s/iter; left time: 4.7596s
Updating learning rate to 9.192852986152399e-05
Epoch: 5 cost time: 1.0075078010559082
Epoch: 5, Steps: 123 | Train Loss: 0.7925692 Vali Loss: 0.5369756 Best vali loss: 0.5367673
	iters: 100, epoch: 6 | loss: 0.5912896
	speed: 0.0121s/iter; left time: 3.2757s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 1.0125672817230225
Epoch: 6, Steps: 123 | Train Loss: 0.5912896 Vali Loss: 0.5627528 Best vali loss: 0.5367673
	iters: 100, epoch: 7 | loss: 0.5306838
	speed: 0.0122s/iter; left time: 1.7868s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 1.008446455001831
Epoch: 7, Steps: 123 | Train Loss: 0.5306838 Vali Loss: 0.5821099 Best vali loss: 0.5367673
	iters: 100, epoch: 8 | loss: 0.6481431
	speed: 0.0121s/iter; left time: 0.2900s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0032105445861816
Epoch: 8, Steps: 123 | Train Loss: 0.6481431 Vali Loss: 0.5889984 Best vali loss: 0.5367673

best validation loss 0.536767325774766

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0022639661389, 'e_layers': 1, 'learning_rate': 0.0016464846189, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8359966
	speed: 0.0087s/iter; left time: 33.2414s
	iters: 200, epoch: 1 | loss: 1.2529402
	speed: 0.0027s/iter; left time: 9.9072s
	iters: 300, epoch: 1 | loss: 0.7537462
	speed: 0.0027s/iter; left time: 9.8915s
	iters: 400, epoch: 1 | loss: 0.8886052
	speed: 0.0028s/iter; left time: 9.7058s
Updating learning rate to 0.0016464846189
Validation loss decreased (inf --> 0.5972).  Saving model state dict ...
Epoch: 1 cost time: 1.6500775814056396
Epoch: 1, Steps: 490 | Train Loss: 0.9328221 Vali Loss: 0.5972184 Best vali loss: 0.5972184
	iters: 100, epoch: 2 | loss: 0.3630604
	speed: 0.0081s/iter; left time: 26.9246s
	iters: 200, epoch: 2 | loss: 0.8516226
	speed: 0.0026s/iter; left time: 8.3019s
	iters: 300, epoch: 2 | loss: 1.2002670
	speed: 0.0025s/iter; left time: 7.9271s
	iters: 400, epoch: 2 | loss: 0.8640759
	speed: 0.0025s/iter; left time: 7.6152s
Updating learning rate to 0.00082324230945
Epoch: 2 cost time: 1.2945220470428467
Epoch: 2, Steps: 490 | Train Loss: 0.8197564 Vali Loss: 0.6239566 Best vali loss: 0.5972184
	iters: 100, epoch: 3 | loss: 0.8712280
	speed: 0.0076s/iter; left time: 21.6148s
	iters: 200, epoch: 3 | loss: 0.8970953
	speed: 0.0024s/iter; left time: 6.7057s
	iters: 300, epoch: 3 | loss: 0.6249828
	speed: 0.0025s/iter; left time: 6.4954s
	iters: 400, epoch: 3 | loss: 0.3069239
	speed: 0.0026s/iter; left time: 6.6270s
Updating learning rate to 0.000411621154725
Epoch: 3 cost time: 1.2613170146942139
Epoch: 3, Steps: 490 | Train Loss: 0.6750575 Vali Loss: 0.6158725 Best vali loss: 0.5972184
	iters: 100, epoch: 4 | loss: 0.7603664
	speed: 0.0079s/iter; left time: 18.4972s
	iters: 200, epoch: 4 | loss: 1.0711186
	speed: 0.0026s/iter; left time: 5.8267s
	iters: 300, epoch: 4 | loss: 0.4959226
	speed: 0.0025s/iter; left time: 5.3769s
	iters: 400, epoch: 4 | loss: 0.6597620
	speed: 0.0024s/iter; left time: 4.9854s
Updating learning rate to 0.0002058105773625
Epoch: 4 cost time: 1.2793145179748535
Epoch: 4, Steps: 490 | Train Loss: 0.7467924 Vali Loss: 0.6234888 Best vali loss: 0.5972184
	iters: 100, epoch: 5 | loss: 0.9581102
	speed: 0.0079s/iter; left time: 14.6314s
	iters: 200, epoch: 5 | loss: 1.0757196
	speed: 0.0027s/iter; left time: 4.6814s
	iters: 300, epoch: 5 | loss: 0.8890382
	speed: 0.0026s/iter; left time: 4.3822s
	iters: 400, epoch: 5 | loss: 0.7684599
	speed: 0.0027s/iter; left time: 4.1980s
Updating learning rate to 0.00010290528868125
Epoch: 5 cost time: 1.3626859188079834
Epoch: 5, Steps: 490 | Train Loss: 0.9228320 Vali Loss: 0.6261542 Best vali loss: 0.5972184
	iters: 100, epoch: 6 | loss: 0.5931587
	speed: 0.0084s/iter; left time: 11.5423s
	iters: 200, epoch: 6 | loss: 0.9528733
	speed: 0.0025s/iter; left time: 3.2261s
	iters: 300, epoch: 6 | loss: 0.6845515
	speed: 0.0026s/iter; left time: 3.0324s
	iters: 400, epoch: 6 | loss: 1.3011013
	speed: 0.0026s/iter; left time: 2.8153s
Updating learning rate to 5.1452644340625e-05
Epoch: 6 cost time: 1.3185796737670898
Epoch: 6, Steps: 490 | Train Loss: 0.8829212 Vali Loss: 0.6403853 Best vali loss: 0.5972184
	iters: 100, epoch: 7 | loss: 0.6209233
	speed: 0.0078s/iter; left time: 6.9019s
	iters: 200, epoch: 7 | loss: 0.9811746
	speed: 0.0025s/iter; left time: 1.9450s
	iters: 300, epoch: 7 | loss: 1.0528005
	speed: 0.0025s/iter; left time: 1.6990s
	iters: 400, epoch: 7 | loss: 0.5607907
	speed: 0.0026s/iter; left time: 1.4904s
Updating learning rate to 2.57263221703125e-05
Epoch: 7 cost time: 1.2777817249298096
Epoch: 7, Steps: 490 | Train Loss: 0.8039223 Vali Loss: 0.6362853 Best vali loss: 0.5972184
	iters: 100, epoch: 8 | loss: 0.7998830
	speed: 0.0076s/iter; left time: 2.9856s
	iters: 200, epoch: 8 | loss: 0.8485934
	speed: 0.0023s/iter; left time: 0.6752s
	iters: 300, epoch: 8 | loss: 0.9444606
	speed: 0.0024s/iter; left time: 0.4552s
	iters: 400, epoch: 8 | loss: 0.5265683
	speed: 0.0024s/iter; left time: 0.2192s
Updating learning rate to 1.286316108515625e-05
Epoch: 8 cost time: 1.2010042667388916
Epoch: 8, Steps: 490 | Train Loss: 0.7798763 Vali Loss: 0.6396110 Best vali loss: 0.5972184

best validation loss 0.5972183833846004

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0059606504213, 'e_layers': 4, 'learning_rate': 0.0015431209049, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8861076
	speed: 0.0109s/iter; left time: 41.5758s
	iters: 200, epoch: 1 | loss: 0.7000157
	speed: 0.0049s/iter; left time: 18.2686s
	iters: 300, epoch: 1 | loss: 0.9225737
	speed: 0.0049s/iter; left time: 17.8829s
	iters: 400, epoch: 1 | loss: 1.0698645
	speed: 0.0048s/iter; left time: 16.8873s
Updating learning rate to 0.0014843893625637028
Validation loss decreased (inf --> 0.6266).  Saving model state dict ...
Epoch: 1 cost time: 2.7242977619171143
Epoch: 1, Steps: 490 | Train Loss: 0.8946404 Vali Loss: 0.6266285 Best vali loss: 0.6266285
	iters: 100, epoch: 2 | loss: 1.4480895
	speed: 0.0134s/iter; left time: 44.5193s
	iters: 200, epoch: 2 | loss: 1.0949754
	speed: 0.0048s/iter; left time: 15.4778s
	iters: 300, epoch: 2 | loss: 0.8006299
	speed: 0.0048s/iter; left time: 15.0682s
	iters: 400, epoch: 2 | loss: 0.6564304
	speed: 0.0049s/iter; left time: 14.7265s
Updating learning rate to 0.0013171360804727556
Epoch: 2 cost time: 2.4096760749816895
Epoch: 2, Steps: 490 | Train Loss: 1.0000313 Vali Loss: 0.6432551 Best vali loss: 0.6266285
	iters: 100, epoch: 3 | loss: 1.2654226
	speed: 0.0131s/iter; left time: 37.1602s
	iters: 200, epoch: 3 | loss: 1.2005767
	speed: 0.0048s/iter; left time: 13.2401s
	iters: 300, epoch: 3 | loss: 0.4988790
	speed: 0.0049s/iter; left time: 12.9645s
	iters: 400, epoch: 3 | loss: 0.5720738
	speed: 0.0050s/iter; left time: 12.7339s
Updating learning rate to 0.0010668238546707278
Epoch: 3 cost time: 2.462867021560669
Epoch: 3, Steps: 490 | Train Loss: 0.8842380 Vali Loss: 0.6385176 Best vali loss: 0.6266285

best validation loss 0.6266285192905781

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0091207597945, 'e_layers': 2, 'learning_rate': 0.0006973955788, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8309121
	speed: 0.0111s/iter; left time: 9.8647s
Updating learning rate to 0.0006973955788
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 0.9578092098236084
Epoch: 1, Steps: 123 | Train Loss: 0.8309121 Vali Loss: 0.6058048 Best vali loss: 0.6058048
	iters: 100, epoch: 2 | loss: 1.1186419
	speed: 0.0086s/iter; left time: 6.5212s
Updating learning rate to 0.0003486977894
Epoch: 2 cost time: 0.6664488315582275
Epoch: 2, Steps: 123 | Train Loss: 1.1186419 Vali Loss: 0.6167169 Best vali loss: 0.6058048
	iters: 100, epoch: 3 | loss: 0.9683873
	speed: 0.0084s/iter; left time: 5.3829s
Updating learning rate to 0.0001743488947
Epoch: 3 cost time: 0.6648948192596436
Epoch: 3, Steps: 123 | Train Loss: 0.9683873 Vali Loss: 0.6089356 Best vali loss: 0.6058048

best validation loss 0.6058047890718311

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0039635407359, 'e_layers': 4, 'learning_rate': 0.003700378553, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4876518
	speed: 0.0113s/iter; left time: 87.7386s
	iters: 200, epoch: 1 | loss: 0.6098471
	speed: 0.0053s/iter; left time: 40.1354s
	iters: 300, epoch: 1 | loss: 0.5388504
	speed: 0.0052s/iter; left time: 39.4655s
	iters: 400, epoch: 1 | loss: 0.9027038
	speed: 0.0052s/iter; left time: 38.7156s
	iters: 500, epoch: 1 | loss: 0.3023390
	speed: 0.0046s/iter; left time: 33.8938s
	iters: 600, epoch: 1 | loss: 1.1893468
	speed: 0.0045s/iter; left time: 32.4946s
	iters: 700, epoch: 1 | loss: 1.3691480
	speed: 0.0046s/iter; left time: 33.0632s
	iters: 800, epoch: 1 | loss: 2.2197742
	speed: 0.0047s/iter; left time: 33.0305s
	iters: 900, epoch: 1 | loss: 1.5601082
	speed: 0.0050s/iter; left time: 34.9784s
Updating learning rate to 0.0035595412803302155
Validation loss decreased (inf --> 0.6502).  Saving model state dict ...
Epoch: 1 cost time: 5.140898942947388
Epoch: 1, Steps: 979 | Train Loss: 1.0199744 Vali Loss: 0.6501771 Best vali loss: 0.6501771
	iters: 100, epoch: 2 | loss: 0.9162917
	speed: 0.0144s/iter; left time: 96.9853s
	iters: 200, epoch: 2 | loss: 0.7079039
	speed: 0.0046s/iter; left time: 30.7892s
	iters: 300, epoch: 2 | loss: 1.1188281
	speed: 0.0047s/iter; left time: 30.8826s
	iters: 400, epoch: 2 | loss: 0.5331379
	speed: 0.0047s/iter; left time: 30.3076s
	iters: 500, epoch: 2 | loss: 0.6923760
	speed: 0.0049s/iter; left time: 30.8171s
	iters: 600, epoch: 2 | loss: 1.4929849
	speed: 0.0051s/iter; left time: 32.2048s
	iters: 700, epoch: 2 | loss: 1.0539449
	speed: 0.0048s/iter; left time: 29.6422s
	iters: 800, epoch: 2 | loss: 0.7054159
	speed: 0.0047s/iter; left time: 28.2165s
	iters: 900, epoch: 2 | loss: 0.5343627
	speed: 0.0046s/iter; left time: 27.3991s
Updating learning rate to 0.003158470660391782
Epoch: 2 cost time: 4.6772191524505615
Epoch: 2, Steps: 979 | Train Loss: 0.8616940 Vali Loss: 0.6508435 Best vali loss: 0.6501771
	iters: 100, epoch: 3 | loss: 0.4516593
	speed: 0.0144s/iter; left time: 83.1014s
	iters: 200, epoch: 3 | loss: 1.4363940
	speed: 0.0044s/iter; left time: 24.6973s
	iters: 300, epoch: 3 | loss: 2.2231035
	speed: 0.0044s/iter; left time: 24.7946s
	iters: 400, epoch: 3 | loss: 0.3774168
	speed: 0.0047s/iter; left time: 25.7788s
	iters: 500, epoch: 3 | loss: 0.9658271
	speed: 0.0046s/iter; left time: 24.7349s
	iters: 600, epoch: 3 | loss: 1.1018066
	speed: 0.0047s/iter; left time: 24.8516s
	iters: 700, epoch: 3 | loss: 0.9156605
	speed: 0.0047s/iter; left time: 24.3255s
	iters: 800, epoch: 3 | loss: 1.1446350
	speed: 0.0048s/iter; left time: 24.5788s
	iters: 900, epoch: 3 | loss: 1.6815833
	speed: 0.0048s/iter; left time: 23.8530s
Updating learning rate to 0.0025582260593561023
Validation loss decreased (0.6502 --> 0.6418).  Saving model state dict ...
Epoch: 3 cost time: 4.601452112197876
Epoch: 3, Steps: 979 | Train Loss: 1.1442318 Vali Loss: 0.6418278 Best vali loss: 0.6418278

best validation loss 0.6418277924946755

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0091207597945, 'e_layers': 2, 'learning_rate': 0.0006973955788, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6923806
	speed: 0.0117s/iter; left time: 6.0154s
Updating learning rate to 8.717444735e-05
Epoch: 4 cost time: 0.9824607372283936
Epoch: 4, Steps: 123 | Train Loss: 0.6923806 Vali Loss: 0.6488805 Best vali loss: 0.6058048
	iters: 100, epoch: 5 | loss: 0.9184976
	speed: 0.0085s/iter; left time: 3.3409s
Updating learning rate to 4.3587223675e-05
Epoch: 5 cost time: 0.6676023006439209
Epoch: 5, Steps: 123 | Train Loss: 0.9184976 Vali Loss: 0.6566104 Best vali loss: 0.6058048
	iters: 100, epoch: 6 | loss: 0.8899265
	speed: 0.0084s/iter; left time: 2.2783s
Updating learning rate to 2.17936118375e-05
Epoch: 6 cost time: 0.6684446334838867
Epoch: 6, Steps: 123 | Train Loss: 0.8899265 Vali Loss: 0.6521699 Best vali loss: 0.6058048
	iters: 100, epoch: 7 | loss: 0.7244529
	speed: 0.0084s/iter; left time: 1.2345s
Updating learning rate to 1.089680591875e-05
Epoch: 7 cost time: 0.6620795726776123
Epoch: 7, Steps: 123 | Train Loss: 0.7244529 Vali Loss: 0.6541466 Best vali loss: 0.6058048
	iters: 100, epoch: 8 | loss: 0.7073206
	speed: 0.0084s/iter; left time: 0.2021s
Updating learning rate to 5.448402959375e-06
Epoch: 8 cost time: 0.6686673164367676
Epoch: 8, Steps: 123 | Train Loss: 0.7073206 Vali Loss: 0.6617659 Best vali loss: 0.6058048

best validation loss 0.6058047890718311

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009860228859, 'e_layers': 1, 'learning_rate': 0.0004092918646, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3751127
	speed: 0.0087s/iter; left time: 33.2547s
	iters: 200, epoch: 1 | loss: 0.7264982
	speed: 0.0027s/iter; left time: 9.9935s
	iters: 300, epoch: 1 | loss: 0.4045802
	speed: 0.0026s/iter; left time: 9.5208s
	iters: 400, epoch: 1 | loss: 0.9238884
	speed: 0.0026s/iter; left time: 9.0265s
Updating learning rate to 0.00039371412056366043
Validation loss decreased (inf --> 0.6134).  Saving model state dict ...
Epoch: 1 cost time: 1.6270995140075684
Epoch: 1, Steps: 490 | Train Loss: 0.8575199 Vali Loss: 0.6134101 Best vali loss: 0.6134101
	iters: 100, epoch: 2 | loss: 0.5782867
	speed: 0.0079s/iter; left time: 26.4629s
	iters: 200, epoch: 2 | loss: 0.6776998
	speed: 0.0026s/iter; left time: 8.4363s
	iters: 300, epoch: 2 | loss: 0.7621461
	speed: 0.0027s/iter; left time: 8.4411s
	iters: 400, epoch: 2 | loss: 0.8374990
	speed: 0.0027s/iter; left time: 8.0996s
Updating learning rate to 0.00034935245877157307
Validation loss decreased (0.6134 --> 0.5994).  Saving model state dict ...
Epoch: 2 cost time: 1.3445947170257568
Epoch: 2, Steps: 490 | Train Loss: 0.7139079 Vali Loss: 0.5993633 Best vali loss: 0.5993633
	iters: 100, epoch: 3 | loss: 1.3844820
	speed: 0.0079s/iter; left time: 22.5010s
	iters: 200, epoch: 3 | loss: 0.4685955
	speed: 0.0025s/iter; left time: 6.9178s
	iters: 300, epoch: 3 | loss: 0.6131578
	speed: 0.0024s/iter; left time: 6.4440s
	iters: 400, epoch: 3 | loss: 0.6678923
	speed: 0.0024s/iter; left time: 6.0591s
Updating learning rate to 0.0002829605400921178
Validation loss decreased (0.5994 --> 0.5974).  Saving model state dict ...
Epoch: 3 cost time: 1.242795467376709
Epoch: 3, Steps: 490 | Train Loss: 0.7835319 Vali Loss: 0.5973643 Best vali loss: 0.5973643
	iters: 100, epoch: 4 | loss: 0.3481814
	speed: 0.0076s/iter; left time: 17.8724s
	iters: 200, epoch: 4 | loss: 0.8475549
	speed: 0.0024s/iter; left time: 5.4794s
	iters: 300, epoch: 4 | loss: 1.0230782
	speed: 0.0025s/iter; left time: 5.3960s
	iters: 400, epoch: 4 | loss: 0.3837611
	speed: 0.0026s/iter; left time: 5.4265s
Updating learning rate to 0.0002046459323
Epoch: 4 cost time: 1.286043643951416
Epoch: 4, Steps: 490 | Train Loss: 0.6506439 Vali Loss: 0.6031442 Best vali loss: 0.5973643
	iters: 100, epoch: 5 | loss: 0.7452394
	speed: 0.0077s/iter; left time: 14.2732s
	iters: 200, epoch: 5 | loss: 0.7618464
	speed: 0.0024s/iter; left time: 4.2404s
	iters: 300, epoch: 5 | loss: 1.3408571
	speed: 0.0023s/iter; left time: 3.8999s
	iters: 400, epoch: 5 | loss: 0.5784743
	speed: 0.0023s/iter; left time: 3.6385s
Updating learning rate to 0.00012633132450788222
Epoch: 5 cost time: 1.2067742347717285
Epoch: 5, Steps: 490 | Train Loss: 0.8566043 Vali Loss: 0.5997712 Best vali loss: 0.5973643
	iters: 100, epoch: 6 | loss: 0.6284713
	speed: 0.0076s/iter; left time: 10.3889s
	iters: 200, epoch: 6 | loss: 0.5005299
	speed: 0.0023s/iter; left time: 2.9766s
	iters: 300, epoch: 6 | loss: 0.5900069
	speed: 0.0023s/iter; left time: 2.6961s
	iters: 400, epoch: 6 | loss: 1.1212953
	speed: 0.0023s/iter; left time: 2.4758s
Updating learning rate to 5.993940582842689e-05
Epoch: 6 cost time: 1.1921470165252686
Epoch: 6, Steps: 490 | Train Loss: 0.7100759 Vali Loss: 0.6044463 Best vali loss: 0.5973643
	iters: 100, epoch: 7 | loss: 0.6337232
	speed: 0.0079s/iter; left time: 6.9205s
	iters: 200, epoch: 7 | loss: 0.8598099
	speed: 0.0027s/iter; left time: 2.1418s
	iters: 300, epoch: 7 | loss: 0.9282078
	speed: 0.0027s/iter; left time: 1.8708s
	iters: 400, epoch: 7 | loss: 0.7008522
	speed: 0.0027s/iter; left time: 1.5884s
Updating learning rate to 1.5577744036339565e-05
Epoch: 7 cost time: 1.38789701461792
Epoch: 7, Steps: 490 | Train Loss: 0.7806483 Vali Loss: 0.6013525 Best vali loss: 0.5973643
	iters: 100, epoch: 8 | loss: 0.8601113
	speed: 0.0079s/iter; left time: 3.0860s
	iters: 200, epoch: 8 | loss: 0.2735259
	speed: 0.0024s/iter; left time: 0.6904s
	iters: 300, epoch: 8 | loss: 0.7828335
	speed: 0.0023s/iter; left time: 0.4408s
	iters: 400, epoch: 8 | loss: 1.6787056
	speed: 0.0023s/iter; left time: 0.2090s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1931378841400146
Epoch: 8, Steps: 490 | Train Loss: 0.8987940 Vali Loss: 0.6027175 Best vali loss: 0.5973643

best validation loss 0.5973643232542075

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0035626505625, 'e_layers': 3, 'learning_rate': 0.0001684029862, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6234370
	speed: 0.0140s/iter; left time: 12.3969s
Updating learning rate to 0.00016199352918198033
Validation loss decreased (inf --> 0.5941).  Saving model state dict ...
Epoch: 1 cost time: 1.3061087131500244
Epoch: 1, Steps: 123 | Train Loss: 0.6234370 Vali Loss: 0.5940832 Best vali loss: 0.5940832
	iters: 100, epoch: 2 | loss: 0.7383764
	speed: 0.0122s/iter; left time: 9.3049s
Updating learning rate to 0.0001437409398570423
Validation loss decreased (0.5941 --> 0.5545).  Saving model state dict ...
Epoch: 2 cost time: 0.9960818290710449
Epoch: 2, Steps: 123 | Train Loss: 0.7383764 Vali Loss: 0.5545461 Best vali loss: 0.5545461
	iters: 100, epoch: 3 | loss: 0.6373593
	speed: 0.0124s/iter; left time: 7.9058s
Updating learning rate to 0.00011642400948977344
Validation loss decreased (0.5545 --> 0.5470).  Saving model state dict ...
Epoch: 3 cost time: 0.994412899017334
Epoch: 3, Steps: 123 | Train Loss: 0.6373593 Vali Loss: 0.5469874 Best vali loss: 0.5469874
	iters: 100, epoch: 4 | loss: 0.8557894
	speed: 0.0124s/iter; left time: 6.4183s
Updating learning rate to 8.42014931e-05
Epoch: 4 cost time: 0.9908645153045654
Epoch: 4, Steps: 123 | Train Loss: 0.8557894 Vali Loss: 0.5536209 Best vali loss: 0.5469874
	iters: 100, epoch: 5 | loss: 0.6902771
	speed: 0.0120s/iter; left time: 4.7076s
Updating learning rate to 5.197897671022658e-05
Validation loss decreased (0.5470 --> 0.5429).  Saving model state dict ...
Epoch: 5 cost time: 1.0014548301696777
Epoch: 5, Steps: 123 | Train Loss: 0.6902771 Vali Loss: 0.5428691 Best vali loss: 0.5428691
	iters: 100, epoch: 6 | loss: 0.4477530
	speed: 0.0125s/iter; left time: 3.3881s
Updating learning rate to 2.4662046342957716e-05
Validation loss decreased (0.5429 --> 0.5407).  Saving model state dict ...
Epoch: 6 cost time: 0.9975717067718506
Epoch: 6, Steps: 123 | Train Loss: 0.4477530 Vali Loss: 0.5407458 Best vali loss: 0.5407458
	iters: 100, epoch: 7 | loss: 0.8091556
	speed: 0.0126s/iter; left time: 1.8521s
Updating learning rate to 6.409457018019664e-06
Validation loss decreased (0.5407 --> 0.5349).  Saving model state dict ...
Epoch: 7 cost time: 1.003596305847168
Epoch: 7, Steps: 123 | Train Loss: 0.8091556 Vali Loss: 0.5348739 Best vali loss: 0.5348739
	iters: 100, epoch: 8 | loss: 0.7014025
	speed: 0.0126s/iter; left time: 0.3014s
Updating learning rate to 0.0
Validation loss decreased (0.5349 --> 0.5328).  Saving model state dict ...
Epoch: 8 cost time: 1.0011827945709229
Epoch: 8, Steps: 123 | Train Loss: 0.7014025 Vali Loss: 0.5328098 Best vali loss: 0.5328098

best validation loss 0.532809783743797

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0033638206738, 'e_layers': 3, 'learning_rate': 0.0001681057947, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6233559
	speed: 0.0137s/iter; left time: 12.1071s
Updating learning rate to 0.00016170764885993716
Validation loss decreased (inf --> 0.5941).  Saving model state dict ...
Epoch: 1 cost time: 1.282623529434204
Epoch: 1, Steps: 123 | Train Loss: 0.6233559 Vali Loss: 0.5940763 Best vali loss: 0.5940763
	iters: 100, epoch: 2 | loss: 0.7284507
	speed: 0.0121s/iter; left time: 9.2370s
Updating learning rate to 0.00014348727104456177
Validation loss decreased (0.5941 --> 0.5502).  Saving model state dict ...
Epoch: 2 cost time: 0.9862463474273682
Epoch: 2, Steps: 123 | Train Loss: 0.7284507 Vali Loss: 0.5502222 Best vali loss: 0.5502222
	iters: 100, epoch: 3 | loss: 0.6375054
	speed: 0.0123s/iter; left time: 7.8738s
Updating learning rate to 0.00011621854860812856
Epoch: 3 cost time: 0.9902770519256592
Epoch: 3, Steps: 123 | Train Loss: 0.6375054 Vali Loss: 0.5574705 Best vali loss: 0.5502222

best validation loss 0.5502222235806283

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0093718074254, 'e_layers': 3, 'learning_rate': 0.0044848326217, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0625715
	speed: 0.0107s/iter; left time: 19.9958s
	iters: 200, epoch: 1 | loss: 1.2008122
	speed: 0.0044s/iter; left time: 7.7680s
Updating learning rate to 0.0044848326217
Validation loss decreased (inf --> 0.6378).  Saving model state dict ...
Epoch: 1 cost time: 1.4486479759216309
Epoch: 1, Steps: 245 | Train Loss: 1.1316919 Vali Loss: 0.6377730 Best vali loss: 0.6377730
	iters: 100, epoch: 2 | loss: 0.7797908
	speed: 0.0089s/iter; left time: 14.3800s
	iters: 200, epoch: 2 | loss: 0.6898768
	speed: 0.0042s/iter; left time: 6.3935s
Updating learning rate to 0.00224241631085
Epoch: 2 cost time: 1.093184232711792
Epoch: 2, Steps: 245 | Train Loss: 0.7348338 Vali Loss: 0.6519908 Best vali loss: 0.6377730
	iters: 100, epoch: 3 | loss: 1.0036485
	speed: 0.0094s/iter; left time: 12.9024s
	iters: 200, epoch: 3 | loss: 0.7293783
	speed: 0.0049s/iter; left time: 6.2236s
Updating learning rate to 0.001121208155425
Epoch: 3 cost time: 1.2641737461090088
Epoch: 3, Steps: 245 | Train Loss: 0.8665134 Vali Loss: 0.6492361 Best vali loss: 0.6377730

best validation loss 0.6377729685259108

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043805967773, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7617007
	speed: 0.0115s/iter; left time: 10.2040s
Updating learning rate to 0.0001691448091113674
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0182390213012695
Epoch: 1, Steps: 123 | Train Loss: 0.7617007 Vali Loss: 0.6075526 Best vali loss: 0.6075526
	iters: 100, epoch: 2 | loss: 0.9357425
	speed: 0.0093s/iter; left time: 7.0728s
Updating learning rate to 0.0001500864507143071
Validation loss decreased (0.6076 --> 0.5710).  Saving model state dict ...
Epoch: 2 cost time: 0.7235984802246094
Epoch: 2, Steps: 123 | Train Loss: 0.9357425 Vali Loss: 0.5709738 Best vali loss: 0.5709738
	iters: 100, epoch: 3 | loss: 0.8585944
	speed: 0.0093s/iter; left time: 5.9709s
Updating learning rate to 0.00012156360171032244
Validation loss decreased (0.5710 --> 0.5465).  Saving model state dict ...
Epoch: 3 cost time: 0.7171750068664551
Epoch: 3, Steps: 123 | Train Loss: 0.8585944 Vali Loss: 0.5464801 Best vali loss: 0.5464801

best validation loss 0.5464801179871742

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043805967773, 'e_layers': 2, 'learning_rate': 0.0001758372146, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6023034
	speed: 0.0118s/iter; left time: 6.1112s
Updating learning rate to 8.79186073e-05
Validation loss decreased (0.5465 --> 0.5320).  Saving model state dict ...
Epoch: 4 cost time: 1.0165338516235352
Epoch: 4, Steps: 123 | Train Loss: 0.6023034 Vali Loss: 0.5320230 Best vali loss: 0.5320230
	iters: 100, epoch: 5 | loss: 0.8474916
	speed: 0.0093s/iter; left time: 3.6448s
Updating learning rate to 5.427361288967756e-05
Validation loss decreased (0.5320 --> 0.5295).  Saving model state dict ...
Epoch: 5 cost time: 0.7194709777832031
Epoch: 5, Steps: 123 | Train Loss: 0.8474916 Vali Loss: 0.5295124 Best vali loss: 0.5295124
	iters: 100, epoch: 6 | loss: 0.8054600
	speed: 0.0092s/iter; left time: 2.4843s
Updating learning rate to 2.5750763885692906e-05
Validation loss decreased (0.5295 --> 0.5268).  Saving model state dict ...
Epoch: 6 cost time: 0.7141995429992676
Epoch: 6, Steps: 123 | Train Loss: 0.8054600 Vali Loss: 0.5267915 Best vali loss: 0.5267915
	iters: 100, epoch: 7 | loss: 0.4768020
	speed: 0.0092s/iter; left time: 1.3562s
Updating learning rate to 6.692405488632598e-06
Epoch: 7 cost time: 0.7134439945220947
Epoch: 7, Steps: 123 | Train Loss: 0.4768020 Vali Loss: 0.5282489 Best vali loss: 0.5267915
	iters: 100, epoch: 8 | loss: 0.5521569
	speed: 0.0089s/iter; left time: 0.2147s
Updating learning rate to 0.0
Validation loss decreased (0.5268 --> 0.5238).  Saving model state dict ...
Epoch: 8 cost time: 0.7143497467041016
Epoch: 8, Steps: 123 | Train Loss: 0.5521569 Vali Loss: 0.5237869 Best vali loss: 0.5237869

best validation loss 0.5237869336504674

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043922585518, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616863
	speed: 0.0116s/iter; left time: 10.2367s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0087039470672607
Epoch: 1, Steps: 123 | Train Loss: 0.7616863 Vali Loss: 0.6075822 Best vali loss: 0.6075822
	iters: 100, epoch: 2 | loss: 0.9355952
	speed: 0.0091s/iter; left time: 6.9629s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.6076 --> 0.5730).  Saving model state dict ...
Epoch: 2 cost time: 0.7178182601928711
Epoch: 2, Steps: 123 | Train Loss: 0.9355952 Vali Loss: 0.5730225 Best vali loss: 0.5730225
	iters: 100, epoch: 3 | loss: 0.8552591
	speed: 0.0093s/iter; left time: 5.9601s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.5730 --> 0.5430).  Saving model state dict ...
Epoch: 3 cost time: 0.7198476791381836
Epoch: 3, Steps: 123 | Train Loss: 0.8552591 Vali Loss: 0.5429587 Best vali loss: 0.5429587
	iters: 100, epoch: 4 | loss: 0.4949506
	speed: 0.0093s/iter; left time: 4.8026s
Updating learning rate to 8.79643783e-05
Epoch: 4 cost time: 0.719536542892456
Epoch: 4, Steps: 123 | Train Loss: 0.4949506 Vali Loss: 0.5447192 Best vali loss: 0.5429587
	iters: 100, epoch: 5 | loss: 0.5756537
	speed: 0.0088s/iter; left time: 3.4734s
Updating learning rate to 5.430186808629478e-05
Validation loss decreased (0.5430 --> 0.5333).  Saving model state dict ...
Epoch: 5 cost time: 0.7134029865264893
Epoch: 5, Steps: 123 | Train Loss: 0.5756537 Vali Loss: 0.5332893 Best vali loss: 0.5332893
	iters: 100, epoch: 6 | loss: 0.6237317
	speed: 0.0093s/iter; left time: 2.5036s
Updating learning rate to 2.5764169901211216e-05
Validation loss decreased (0.5333 --> 0.5302).  Saving model state dict ...
Epoch: 6 cost time: 0.7154793739318848
Epoch: 6, Steps: 123 | Train Loss: 0.6237317 Vali Loss: 0.5302473 Best vali loss: 0.5302473
	iters: 100, epoch: 7 | loss: 0.5790855
	speed: 0.0093s/iter; left time: 1.3733s
Updating learning rate to 6.695889598550024e-06
Validation loss decreased (0.5302 --> 0.5275).  Saving model state dict ...
Epoch: 7 cost time: 0.7158064842224121
Epoch: 7, Steps: 123 | Train Loss: 0.5790855 Vali Loss: 0.5274879 Best vali loss: 0.5274879
	iters: 100, epoch: 8 | loss: 0.7436166
	speed: 0.0093s/iter; left time: 0.2225s
Updating learning rate to 0.0
Validation loss decreased (0.5275 --> 0.5260).  Saving model state dict ...
Epoch: 8 cost time: 0.7331058979034424
Epoch: 8, Steps: 123 | Train Loss: 0.7436166 Vali Loss: 0.5259618 Best vali loss: 0.5259618

best validation loss 0.5259618038576215

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0058595148456, 'e_layers': 4, 'learning_rate': 6.22487285e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.9879527343001e-05
Validation loss decreased (inf --> 0.6146).  Saving model state dict ...
Epoch: 1 cost time: 1.1319940090179443
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6145985 Best vali loss: 0.6145985
Updating learning rate to 5.313261327129515e-05
Validation loss decreased (0.6146 --> 0.6035).  Saving model state dict ...
Epoch: 2 cost time: 0.8497588634490967
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6035097 Best vali loss: 0.6035097
Updating learning rate to 4.3035142791371294e-05
Validation loss decreased (0.6035 --> 0.5963).  Saving model state dict ...
Epoch: 3 cost time: 0.848700761795044
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5962503 Best vali loss: 0.5962503
Updating learning rate to 3.112436425e-05
Epoch: 4 cost time: 0.850592851638794
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5971466 Best vali loss: 0.5962503
Updating learning rate to 1.9213585708628706e-05
Epoch: 5 cost time: 0.8498249053955078
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6047150 Best vali loss: 0.5962503
Updating learning rate to 9.116115228704849e-06
Epoch: 6 cost time: 0.8440828323364258
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5965896 Best vali loss: 0.5962503
Updating learning rate to 2.369201156998994e-06
Epoch: 7 cost time: 0.8548357486724854
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5973246 Best vali loss: 0.5962503
Updating learning rate to 0.0
Validation loss decreased (0.5963 --> 0.5939).  Saving model state dict ...
Epoch: 8 cost time: 0.856626033782959
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5939423 Best vali loss: 0.5939423

best validation loss 0.5939422819361759

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018457343103, 'e_layers': 3, 'learning_rate': 0.0002978245307, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5194671
	speed: 0.0118s/iter; left time: 22.0300s
	iters: 200, epoch: 1 | loss: 0.6124887
	speed: 0.0056s/iter; left time: 9.8620s
Updating learning rate to 0.0002978245307
Validation loss decreased (inf --> 0.6084).  Saving model state dict ...
Epoch: 1 cost time: 1.7264611721038818
Epoch: 1, Steps: 245 | Train Loss: 0.5659779 Vali Loss: 0.6084322 Best vali loss: 0.6084322
	iters: 100, epoch: 2 | loss: 0.7076335
	speed: 0.0113s/iter; left time: 18.3336s
	iters: 200, epoch: 2 | loss: 0.9610829
	speed: 0.0056s/iter; left time: 8.5168s
Updating learning rate to 0.00014891226535
Epoch: 2 cost time: 1.4236867427825928
Epoch: 2, Steps: 245 | Train Loss: 0.8343582 Vali Loss: 0.6133545 Best vali loss: 0.6084322
	iters: 100, epoch: 3 | loss: 0.7224154
	speed: 0.0112s/iter; left time: 15.3046s
	iters: 200, epoch: 3 | loss: 0.6790139
	speed: 0.0056s/iter; left time: 7.0856s
Updating learning rate to 7.4456132675e-05
Epoch: 3 cost time: 1.4113037586212158
Epoch: 3, Steps: 245 | Train Loss: 0.7007146 Vali Loss: 0.6101802 Best vali loss: 0.6084322

best validation loss 0.6084321953670011

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.000176538229, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7618265
	speed: 0.0117s/iter; left time: 10.3592s
Updating learning rate to 0.00016981914273944522
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0119595527648926
Epoch: 1, Steps: 123 | Train Loss: 0.7618265 Vali Loss: 0.6076093 Best vali loss: 0.6076093
	iters: 100, epoch: 2 | loss: 0.9372328
	speed: 0.0092s/iter; left time: 7.0266s
Updating learning rate to 0.0001506848039322818
Validation loss decreased (0.6076 --> 0.5711).  Saving model state dict ...
Epoch: 2 cost time: 0.7228302955627441
Epoch: 2, Steps: 123 | Train Loss: 0.9372328 Vali Loss: 0.5711339 Best vali loss: 0.5711339
	iters: 100, epoch: 3 | loss: 0.8656839
	speed: 0.0094s/iter; left time: 6.0383s
Updating learning rate to 0.00012204824220868712
Validation loss decreased (0.5711 --> 0.5499).  Saving model state dict ...
Epoch: 3 cost time: 0.7183644771575928
Epoch: 3, Steps: 123 | Train Loss: 0.8656839 Vali Loss: 0.5498836 Best vali loss: 0.5498836

best validation loss 0.5498836269978846

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010177841191, 'e_layers': 2, 'learning_rate': 0.0002335242033, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4226103
	speed: 0.0099s/iter; left time: 76.4478s
	iters: 200, epoch: 1 | loss: 1.3705723
	speed: 0.0036s/iter; left time: 27.3807s
	iters: 300, epoch: 1 | loss: 0.8405707
	speed: 0.0033s/iter; left time: 25.1980s
	iters: 400, epoch: 1 | loss: 1.3900791
	speed: 0.0034s/iter; left time: 24.9534s
	iters: 500, epoch: 1 | loss: 0.9352596
	speed: 0.0033s/iter; left time: 24.4349s
	iters: 600, epoch: 1 | loss: 1.5943356
	speed: 0.0034s/iter; left time: 24.4159s
	iters: 700, epoch: 1 | loss: 0.8083553
	speed: 0.0034s/iter; left time: 23.9616s
	iters: 800, epoch: 1 | loss: 0.7106717
	speed: 0.0035s/iter; left time: 24.5023s
	iters: 900, epoch: 1 | loss: 1.0431577
	speed: 0.0032s/iter; left time: 22.3464s
Updating learning rate to 0.00022463621753743735
Validation loss decreased (inf --> 0.6097).  Saving model state dict ...
Epoch: 1 cost time: 3.650651693344116
Epoch: 1, Steps: 979 | Train Loss: 1.0128458 Vali Loss: 0.6096901 Best vali loss: 0.6096901
	iters: 100, epoch: 2 | loss: 1.0047424
	speed: 0.0109s/iter; left time: 73.3780s
	iters: 200, epoch: 2 | loss: 0.3519200
	speed: 0.0032s/iter; left time: 21.0613s
	iters: 300, epoch: 2 | loss: 0.4349527
	speed: 0.0031s/iter; left time: 20.2327s
	iters: 400, epoch: 2 | loss: 1.4335498
	speed: 0.0031s/iter; left time: 19.8480s
	iters: 500, epoch: 2 | loss: 0.9821480
	speed: 0.0031s/iter; left time: 19.5002s
	iters: 600, epoch: 2 | loss: 1.4867560
	speed: 0.0031s/iter; left time: 19.0944s
	iters: 700, epoch: 2 | loss: 1.0945617
	speed: 0.0030s/iter; left time: 18.7633s
	iters: 800, epoch: 2 | loss: 0.2906142
	speed: 0.0031s/iter; left time: 18.5497s
	iters: 900, epoch: 2 | loss: 0.8726175
	speed: 0.0030s/iter; left time: 18.0122s
Updating learning rate to 0.00019932537551230797
Epoch: 2 cost time: 3.052988052368164
Epoch: 2, Steps: 979 | Train Loss: 0.8835402 Vali Loss: 0.6207758 Best vali loss: 0.6096901
	iters: 100, epoch: 3 | loss: 0.7353137
	speed: 0.0108s/iter; left time: 62.6415s
	iters: 200, epoch: 3 | loss: 0.7066095
	speed: 0.0031s/iter; left time: 17.6468s
	iters: 300, epoch: 3 | loss: 1.4213322
	speed: 0.0032s/iter; left time: 17.9250s
	iters: 400, epoch: 3 | loss: 1.0803916
	speed: 0.0031s/iter; left time: 16.8986s
	iters: 500, epoch: 3 | loss: 1.1202341
	speed: 0.0031s/iter; left time: 16.8739s
	iters: 600, epoch: 3 | loss: 0.4978669
	speed: 0.0032s/iter; left time: 16.9166s
	iters: 700, epoch: 3 | loss: 0.7182636
	speed: 0.0032s/iter; left time: 16.3099s
	iters: 800, epoch: 3 | loss: 1.8047209
	speed: 0.0030s/iter; left time: 15.2171s
	iters: 900, epoch: 3 | loss: 0.3084248
	speed: 0.0031s/iter; left time: 15.6620s
Updating learning rate to 0.0001614450234795835
Epoch: 3 cost time: 3.1061198711395264
Epoch: 3, Steps: 979 | Train Loss: 0.9325730 Vali Loss: 0.6124454 Best vali loss: 0.6096901

best validation loss 0.6096901212203066

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.000176538229, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6012574
	speed: 0.0120s/iter; left time: 6.2026s
Updating learning rate to 8.82691145e-05
Validation loss decreased (0.5499 --> 0.5291).  Saving model state dict ...
Epoch: 4 cost time: 1.0154919624328613
Epoch: 4, Steps: 123 | Train Loss: 0.6012574 Vali Loss: 0.5290926 Best vali loss: 0.5290926
	iters: 100, epoch: 5 | loss: 0.8440462
	speed: 0.0094s/iter; left time: 3.7110s
Updating learning rate to 5.448998679131289e-05
Validation loss decreased (0.5291 --> 0.5251).  Saving model state dict ...
Epoch: 5 cost time: 0.7182695865631104
Epoch: 5, Steps: 123 | Train Loss: 0.8440462 Vali Loss: 0.5250552 Best vali loss: 0.5250552
	iters: 100, epoch: 6 | loss: 0.8035818
	speed: 0.0094s/iter; left time: 2.5367s
Updating learning rate to 2.5853425067718194e-05
Epoch: 6 cost time: 0.725379228591919
Epoch: 6, Steps: 123 | Train Loss: 0.8035818 Vali Loss: 0.5271899 Best vali loss: 0.5250552
	iters: 100, epoch: 7 | loss: 0.4780469
	speed: 0.0090s/iter; left time: 1.3231s
Updating learning rate to 6.719086260554758e-06
Epoch: 7 cost time: 0.7195055484771729
Epoch: 7, Steps: 123 | Train Loss: 0.4780469 Vali Loss: 0.5280698 Best vali loss: 0.5250552
	iters: 100, epoch: 8 | loss: 0.5498956
	speed: 0.0090s/iter; left time: 0.2162s
Updating learning rate to 0.0
Validation loss decreased (0.5251 --> 0.5236).  Saving model state dict ...
Epoch: 8 cost time: 0.7189946174621582
Epoch: 8, Steps: 123 | Train Loss: 0.5498956 Vali Loss: 0.5235800 Best vali loss: 0.5235800

best validation loss 0.5235799617758508

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010659623855, 'e_layers': 2, 'learning_rate': 0.0004543888131, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9829005
	speed: 0.0093s/iter; left time: 35.3976s
	iters: 200, epoch: 1 | loss: 1.0396280
	speed: 0.0032s/iter; left time: 11.8490s
	iters: 300, epoch: 1 | loss: 0.3471226
	speed: 0.0032s/iter; left time: 11.5855s
	iters: 400, epoch: 1 | loss: 0.8722025
	speed: 0.0032s/iter; left time: 11.2691s
Updating learning rate to 0.00043709466866259324
Validation loss decreased (inf --> 0.6093).  Saving model state dict ...
Epoch: 1 cost time: 1.9051010608673096
Epoch: 1, Steps: 490 | Train Loss: 0.8104634 Vali Loss: 0.6092506 Best vali loss: 0.6092506
	iters: 100, epoch: 2 | loss: 0.9785568
	speed: 0.0100s/iter; left time: 33.1712s
	iters: 200, epoch: 2 | loss: 0.7020265
	speed: 0.0033s/iter; left time: 10.6476s
	iters: 300, epoch: 2 | loss: 0.8163020
	speed: 0.0032s/iter; left time: 10.1356s
	iters: 400, epoch: 2 | loss: 1.3746870
	speed: 0.0034s/iter; left time: 10.3233s
Updating learning rate to 0.00038784511206915837
Epoch: 2 cost time: 1.6916353702545166
Epoch: 2, Steps: 490 | Train Loss: 0.9678931 Vali Loss: 0.6154838 Best vali loss: 0.6092506
	iters: 100, epoch: 3 | loss: 1.5642900
	speed: 0.0102s/iter; left time: 29.0929s
	iters: 200, epoch: 3 | loss: 0.6240234
	speed: 0.0038s/iter; left time: 10.3114s
	iters: 300, epoch: 3 | loss: 0.5425860
	speed: 0.0036s/iter; left time: 9.6372s
	iters: 400, epoch: 3 | loss: 0.5855193
	speed: 0.0033s/iter; left time: 8.4759s
Updating learning rate to 0.00031413794186270364
Epoch: 3 cost time: 1.7844347953796387
Epoch: 3, Steps: 490 | Train Loss: 0.8291047 Vali Loss: 0.6261193 Best vali loss: 0.6092506
	iters: 100, epoch: 4 | loss: 0.6216616
	speed: 0.0094s/iter; left time: 22.0879s
	iters: 200, epoch: 4 | loss: 0.4087355
	speed: 0.0032s/iter; left time: 7.3080s
	iters: 300, epoch: 4 | loss: 1.0732746
	speed: 0.0033s/iter; left time: 7.0405s
	iters: 400, epoch: 4 | loss: 1.3523819
	speed: 0.0033s/iter; left time: 6.7144s
Updating learning rate to 0.00022719440655
Epoch: 4 cost time: 1.6377077102661133
Epoch: 4, Steps: 490 | Train Loss: 0.8640134 Vali Loss: 0.6193560 Best vali loss: 0.6092506
	iters: 100, epoch: 5 | loss: 0.5469194
	speed: 0.0094s/iter; left time: 17.4324s
	iters: 200, epoch: 5 | loss: 0.4352291
	speed: 0.0032s/iter; left time: 5.6877s
	iters: 300, epoch: 5 | loss: 1.0953164
	speed: 0.0031s/iter; left time: 5.1996s
	iters: 400, epoch: 5 | loss: 0.3868887
	speed: 0.0033s/iter; left time: 5.1570s
Updating learning rate to 0.00014025087123729639
Epoch: 5 cost time: 1.6249728202819824
Epoch: 5, Steps: 490 | Train Loss: 0.6160884 Vali Loss: 0.6642592 Best vali loss: 0.6092506
	iters: 100, epoch: 6 | loss: 0.5757310
	speed: 0.0098s/iter; left time: 13.4451s
	iters: 200, epoch: 6 | loss: 0.3778957
	speed: 0.0036s/iter; left time: 4.5788s
	iters: 300, epoch: 6 | loss: 0.9146436
	speed: 0.0034s/iter; left time: 3.9442s
	iters: 400, epoch: 6 | loss: 0.6661568
	speed: 0.0034s/iter; left time: 3.6175s
Updating learning rate to 6.654370103084164e-05
Epoch: 6 cost time: 1.7148947715759277
Epoch: 6, Steps: 490 | Train Loss: 0.6336068 Vali Loss: 0.6395863 Best vali loss: 0.6092506
	iters: 100, epoch: 7 | loss: 0.6537463
	speed: 0.0098s/iter; left time: 8.6768s
	iters: 200, epoch: 7 | loss: 0.7568164
	speed: 0.0037s/iter; left time: 2.8892s
	iters: 300, epoch: 7 | loss: 0.3449262
	speed: 0.0037s/iter; left time: 2.5281s
	iters: 400, epoch: 7 | loss: 0.5817950
	speed: 0.0037s/iter; left time: 2.1552s
Updating learning rate to 1.729414443740678e-05
Epoch: 7 cost time: 1.8522634506225586
Epoch: 7, Steps: 490 | Train Loss: 0.5843210 Vali Loss: 0.6486278 Best vali loss: 0.6092506
	iters: 100, epoch: 8 | loss: 0.9562351
	speed: 0.0100s/iter; left time: 3.9130s
	iters: 200, epoch: 8 | loss: 0.7144105
	speed: 0.0033s/iter; left time: 0.9515s
	iters: 300, epoch: 8 | loss: 0.5902818
	speed: 0.0031s/iter; left time: 0.5950s
	iters: 400, epoch: 8 | loss: 0.4856388
	speed: 0.0031s/iter; left time: 0.2830s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.607733964920044
Epoch: 8, Steps: 490 | Train Loss: 0.6866416 Vali Loss: 0.6607909 Best vali loss: 0.6092506

best validation loss 0.6092505572240478

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010075613072, 'e_layers': 3, 'learning_rate': 0.0001035774015, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6029104
	speed: 0.0114s/iter; left time: 21.1682s
	iters: 200, epoch: 1 | loss: 0.5985536
	speed: 0.0052s/iter; left time: 9.0866s
Updating learning rate to 0.0001035774015
Validation loss decreased (inf --> 0.6159).  Saving model state dict ...
Epoch: 1 cost time: 1.6168467998504639
Epoch: 1, Steps: 245 | Train Loss: 0.6007320 Vali Loss: 0.6158685 Best vali loss: 0.6158685
	iters: 100, epoch: 2 | loss: 0.5483467
	speed: 0.0105s/iter; left time: 16.9266s
	iters: 200, epoch: 2 | loss: 1.1831475
	speed: 0.0052s/iter; left time: 7.8170s
Updating learning rate to 5.178870075e-05
Validation loss decreased (0.6159 --> 0.5472).  Saving model state dict ...
Epoch: 2 cost time: 1.3045246601104736
Epoch: 2, Steps: 245 | Train Loss: 0.8657471 Vali Loss: 0.5471938 Best vali loss: 0.5471938
	iters: 100, epoch: 3 | loss: 0.7422834
	speed: 0.0109s/iter; left time: 14.9588s
	iters: 200, epoch: 3 | loss: 0.4710740
	speed: 0.0051s/iter; left time: 6.4437s
Updating learning rate to 2.5894350375e-05
Validation loss decreased (0.5472 --> 0.5391).  Saving model state dict ...
Epoch: 3 cost time: 1.3100521564483643
Epoch: 3, Steps: 245 | Train Loss: 0.6066787 Vali Loss: 0.5390647 Best vali loss: 0.5390647
	iters: 100, epoch: 4 | loss: 0.7057571
	speed: 0.0108s/iter; left time: 12.1346s
	iters: 200, epoch: 4 | loss: 0.6902900
	speed: 0.0050s/iter; left time: 5.1271s
Updating learning rate to 1.29471751875e-05
Validation loss decreased (0.5391 --> 0.5349).  Saving model state dict ...
Epoch: 4 cost time: 1.2735679149627686
Epoch: 4, Steps: 245 | Train Loss: 0.6980235 Vali Loss: 0.5349101 Best vali loss: 0.5349101
	iters: 100, epoch: 5 | loss: 0.8162602
	speed: 0.0104s/iter; left time: 9.1560s
	iters: 200, epoch: 5 | loss: 0.5348414
	speed: 0.0050s/iter; left time: 3.8822s
Updating learning rate to 6.47358759375e-06
Validation loss decreased (0.5349 --> 0.5319).  Saving model state dict ...
Epoch: 5 cost time: 1.263702630996704
Epoch: 5, Steps: 245 | Train Loss: 0.6755508 Vali Loss: 0.5319098 Best vali loss: 0.5319098
	iters: 100, epoch: 6 | loss: 0.6917951
	speed: 0.0104s/iter; left time: 6.6446s
	iters: 200, epoch: 6 | loss: 0.7711128
	speed: 0.0050s/iter; left time: 2.6650s
Updating learning rate to 3.236793796875e-06
Epoch: 6 cost time: 1.2615718841552734
Epoch: 6, Steps: 245 | Train Loss: 0.7314540 Vali Loss: 0.5355947 Best vali loss: 0.5319098
	iters: 100, epoch: 7 | loss: 0.5834602
	speed: 0.0103s/iter; left time: 4.0171s
	iters: 200, epoch: 7 | loss: 0.5210668
	speed: 0.0050s/iter; left time: 1.4586s
Updating learning rate to 1.6183968984375e-06
Epoch: 7 cost time: 1.2834243774414062
Epoch: 7, Steps: 245 | Train Loss: 0.5522635 Vali Loss: 0.5350281 Best vali loss: 0.5319098
	iters: 100, epoch: 8 | loss: 0.7202814
	speed: 0.0101s/iter; left time: 1.4735s
	iters: 200, epoch: 8 | loss: 0.7305151
	speed: 0.0050s/iter; left time: 0.2278s
Updating learning rate to 8.0919844921875e-07
Epoch: 8 cost time: 1.260270357131958
Epoch: 8, Steps: 245 | Train Loss: 0.7253982 Vali Loss: 0.5346656 Best vali loss: 0.5319098

best validation loss 0.5319098012969208

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0038492265201, 'e_layers': 3, 'learning_rate': 0.0004606818307, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6948540
	speed: 0.0133s/iter; left time: 11.7508s
Updating learning rate to 0.0004606818307
Validation loss decreased (inf --> 0.6136).  Saving model state dict ...
Epoch: 1 cost time: 1.2231011390686035
Epoch: 1, Steps: 123 | Train Loss: 0.6948540 Vali Loss: 0.6135702 Best vali loss: 0.6135702
	iters: 100, epoch: 2 | loss: 1.1186379
	speed: 0.0115s/iter; left time: 8.7958s
Updating learning rate to 0.00023034091535
Validation loss decreased (0.6136 --> 0.5701).  Saving model state dict ...
Epoch: 2 cost time: 0.9290680885314941
Epoch: 2, Steps: 123 | Train Loss: 1.1186379 Vali Loss: 0.5700700 Best vali loss: 0.5700700
	iters: 100, epoch: 3 | loss: 0.5974426
	speed: 0.0115s/iter; left time: 7.3248s
Updating learning rate to 0.000115170457675
Validation loss decreased (0.5701 --> 0.5604).  Saving model state dict ...
Epoch: 3 cost time: 0.913738489151001
Epoch: 3, Steps: 123 | Train Loss: 0.5974426 Vali Loss: 0.5604075 Best vali loss: 0.5604075

best validation loss 0.5604075349657032

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008055496374, 'e_layers': 2, 'learning_rate': 7.0069584e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9120584
	speed: 0.0112s/iter; left time: 9.9360s
Updating learning rate to 6.740271925459016e-05
Validation loss decreased (inf --> 0.6182).  Saving model state dict ...
Epoch: 1 cost time: 0.9579887390136719
Epoch: 1, Steps: 123 | Train Loss: 0.9120584 Vali Loss: 0.6181593 Best vali loss: 0.6181593
	iters: 100, epoch: 2 | loss: 0.9394466
	speed: 0.0079s/iter; left time: 5.9825s
Updating learning rate to 5.98081310006602e-05
Validation loss decreased (0.6182 --> 0.6051).  Saving model state dict ...
Epoch: 2 cost time: 0.6038789749145508
Epoch: 2, Steps: 123 | Train Loss: 0.9394466 Vali Loss: 0.6050558 Best vali loss: 0.6050558
	iters: 100, epoch: 3 | loss: 0.5755728
	speed: 0.0078s/iter; left time: 4.9988s
Updating learning rate to 4.8442026454756986e-05
Validation loss decreased (0.6051 --> 0.6024).  Saving model state dict ...
Epoch: 3 cost time: 0.6058738231658936
Epoch: 3, Steps: 123 | Train Loss: 0.5755728 Vali Loss: 0.6023806 Best vali loss: 0.6023806

best validation loss 0.6023806357814007

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0048373076227, 'e_layers': 2, 'learning_rate': 0.0004658074689, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8715326
	speed: 0.0112s/iter; left time: 9.8929s
Updating learning rate to 0.0004480787277537989
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 0.957172155380249
Epoch: 1, Steps: 123 | Train Loss: 0.8715326 Vali Loss: 0.5976109 Best vali loss: 0.5976109
	iters: 100, epoch: 2 | loss: 0.7035766
	speed: 0.0076s/iter; left time: 5.8264s
Updating learning rate to 0.0003975915444432659
Validation loss decreased (0.5976 --> 0.5835).  Saving model state dict ...
Epoch: 2 cost time: 0.5674266815185547
Epoch: 2, Steps: 123 | Train Loss: 0.7035766 Vali Loss: 0.5835108 Best vali loss: 0.5835108
	iters: 100, epoch: 3 | loss: 0.7864030
	speed: 0.0078s/iter; left time: 5.0142s
Updating learning rate to 0.0003220321349599734
Validation loss decreased (0.5835 --> 0.5738).  Saving model state dict ...
Epoch: 3 cost time: 0.627295732498169
Epoch: 3, Steps: 123 | Train Loss: 0.7864030 Vali Loss: 0.5737623 Best vali loss: 0.5737623

best validation loss 0.573762292417317

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0038492265201, 'e_layers': 3, 'learning_rate': 0.0004606818307, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5316596
	speed: 0.0138s/iter; left time: 7.1187s
Updating learning rate to 5.75852288375e-05
Validation loss decreased (0.5604 --> 0.5485).  Saving model state dict ...
Epoch: 4 cost time: 1.2334814071655273
Epoch: 4, Steps: 123 | Train Loss: 0.5316596 Vali Loss: 0.5484777 Best vali loss: 0.5484777
	iters: 100, epoch: 5 | loss: 0.9796325
	speed: 0.0115s/iter; left time: 4.5121s
Updating learning rate to 2.879261441875e-05
Epoch: 5 cost time: 0.9163401126861572
Epoch: 5, Steps: 123 | Train Loss: 0.9796325 Vali Loss: 0.5559790 Best vali loss: 0.5484777
	iters: 100, epoch: 6 | loss: 0.5509776
	speed: 0.0111s/iter; left time: 3.0044s
Updating learning rate to 1.4396307209375e-05
Validation loss decreased (0.5485 --> 0.5482).  Saving model state dict ...
Epoch: 6 cost time: 0.9170739650726318
Epoch: 6, Steps: 123 | Train Loss: 0.5509776 Vali Loss: 0.5482491 Best vali loss: 0.5482491
	iters: 100, epoch: 7 | loss: 0.7317068
	speed: 0.0116s/iter; left time: 1.7072s
Updating learning rate to 7.1981536046875e-06
Epoch: 7 cost time: 0.9192125797271729
Epoch: 7, Steps: 123 | Train Loss: 0.7317068 Vali Loss: 0.5502988 Best vali loss: 0.5482491
	iters: 100, epoch: 8 | loss: 0.4797204
	speed: 0.0112s/iter; left time: 0.2688s
Updating learning rate to 3.59907680234375e-06
Epoch: 8 cost time: 0.915938138961792
Epoch: 8, Steps: 123 | Train Loss: 0.4797204 Vali Loss: 0.5542470 Best vali loss: 0.5482491

best validation loss 0.5482491319762066

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0072204697946, 'e_layers': 4, 'learning_rate': 0.0002537965008, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1154286
	speed: 0.0111s/iter; left time: 85.8965s
	iters: 200, epoch: 1 | loss: 0.3500208
	speed: 0.0052s/iter; left time: 39.8209s
	iters: 300, epoch: 1 | loss: 0.6365527
	speed: 0.0052s/iter; left time: 39.0620s
	iters: 400, epoch: 1 | loss: 0.5199713
	speed: 0.0051s/iter; left time: 38.2518s
	iters: 500, epoch: 1 | loss: 0.9347986
	speed: 0.0050s/iter; left time: 36.9569s
	iters: 600, epoch: 1 | loss: 0.8373986
	speed: 0.0048s/iter; left time: 34.7656s
	iters: 700, epoch: 1 | loss: 0.5320744
	speed: 0.0048s/iter; left time: 34.2533s
	iters: 800, epoch: 1 | loss: 0.8119180
	speed: 0.0048s/iter; left time: 33.6338s
	iters: 900, epoch: 1 | loss: 0.4252991
	speed: 0.0052s/iter; left time: 35.9100s
Updating learning rate to 0.0002537965008
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 5.279507637023926
Epoch: 1, Steps: 979 | Train Loss: 0.6848291 Vali Loss: 0.6144240 Best vali loss: 0.6144240
	iters: 100, epoch: 2 | loss: 0.8137245
	speed: 0.0154s/iter; left time: 104.2050s
	iters: 200, epoch: 2 | loss: 1.3101866
	speed: 0.0046s/iter; left time: 30.5725s
	iters: 300, epoch: 2 | loss: 0.2968976
	speed: 0.0046s/iter; left time: 30.0912s
	iters: 400, epoch: 2 | loss: 0.7604324
	speed: 0.0046s/iter; left time: 29.4517s
	iters: 500, epoch: 2 | loss: 0.6029381
	speed: 0.0047s/iter; left time: 29.5724s
	iters: 600, epoch: 2 | loss: 0.6365224
	speed: 0.0046s/iter; left time: 28.8517s
	iters: 700, epoch: 2 | loss: 1.0436332
	speed: 0.0047s/iter; left time: 29.2259s
	iters: 800, epoch: 2 | loss: 0.2855683
	speed: 0.0047s/iter; left time: 28.6708s
	iters: 900, epoch: 2 | loss: 0.3876904
	speed: 0.0047s/iter; left time: 28.0788s
Updating learning rate to 0.0001268982504
Validation loss decreased (0.6144 --> 0.6077).  Saving model state dict ...
Epoch: 2 cost time: 4.608874320983887
Epoch: 2, Steps: 979 | Train Loss: 0.6819548 Vali Loss: 0.6077316 Best vali loss: 0.6077316
	iters: 100, epoch: 3 | loss: 0.5283149
	speed: 0.0147s/iter; left time: 84.8743s
	iters: 200, epoch: 3 | loss: 0.4716000
	speed: 0.0046s/iter; left time: 26.0191s
	iters: 300, epoch: 3 | loss: 1.3208452
	speed: 0.0046s/iter; left time: 25.3993s
	iters: 400, epoch: 3 | loss: 0.9923596
	speed: 0.0046s/iter; left time: 25.2304s
	iters: 500, epoch: 3 | loss: 0.9625059
	speed: 0.0049s/iter; left time: 26.3633s
	iters: 600, epoch: 3 | loss: 0.7141801
	speed: 0.0047s/iter; left time: 24.6070s
	iters: 700, epoch: 3 | loss: 0.6835710
	speed: 0.0048s/iter; left time: 24.8631s
	iters: 800, epoch: 3 | loss: 0.4876735
	speed: 0.0048s/iter; left time: 24.3569s
	iters: 900, epoch: 3 | loss: 0.8934199
	speed: 0.0048s/iter; left time: 23.8049s
Updating learning rate to 6.34491252e-05
Validation loss decreased (0.6077 --> 0.5588).  Saving model state dict ...
Epoch: 3 cost time: 4.649994850158691
Epoch: 3, Steps: 979 | Train Loss: 0.7838300 Vali Loss: 0.5587595 Best vali loss: 0.5587595
	iters: 100, epoch: 4 | loss: 1.0504457
	speed: 0.0150s/iter; left time: 72.0470s
	iters: 200, epoch: 4 | loss: 0.5011350
	speed: 0.0048s/iter; left time: 22.4410s
	iters: 300, epoch: 4 | loss: 0.2552578
	speed: 0.0048s/iter; left time: 22.1279s
	iters: 400, epoch: 4 | loss: 0.4634977
	speed: 0.0047s/iter; left time: 21.1622s
	iters: 500, epoch: 4 | loss: 0.9673307
	speed: 0.0046s/iter; left time: 20.4103s
	iters: 600, epoch: 4 | loss: 0.2707392
	speed: 0.0046s/iter; left time: 19.9400s
	iters: 700, epoch: 4 | loss: 0.8227276
	speed: 0.0046s/iter; left time: 19.2322s
	iters: 800, epoch: 4 | loss: 0.8190492
	speed: 0.0046s/iter; left time: 18.7993s
	iters: 900, epoch: 4 | loss: 0.8204914
	speed: 0.0046s/iter; left time: 18.2924s
Updating learning rate to 3.17245626e-05
Validation loss decreased (0.5588 --> 0.5573).  Saving model state dict ...
Epoch: 4 cost time: 4.626725673675537
Epoch: 4, Steps: 979 | Train Loss: 0.6634082 Vali Loss: 0.5572856 Best vali loss: 0.5572856
	iters: 100, epoch: 5 | loss: 0.4099442
	speed: 0.0147s/iter; left time: 56.0659s
	iters: 200, epoch: 5 | loss: 1.0008577
	speed: 0.0047s/iter; left time: 17.3917s
	iters: 300, epoch: 5 | loss: 1.1985098
	speed: 0.0048s/iter; left time: 17.5124s
	iters: 400, epoch: 5 | loss: 1.1092098
	speed: 0.0049s/iter; left time: 17.3068s
	iters: 500, epoch: 5 | loss: 0.5137492
	speed: 0.0049s/iter; left time: 16.7246s
	iters: 600, epoch: 5 | loss: 0.6255745
	speed: 0.0052s/iter; left time: 17.2902s
	iters: 700, epoch: 5 | loss: 0.3303022
	speed: 0.0050s/iter; left time: 16.0725s
	iters: 800, epoch: 5 | loss: 0.6905159
	speed: 0.0049s/iter; left time: 15.2722s
	iters: 900, epoch: 5 | loss: 0.4286435
	speed: 0.0049s/iter; left time: 14.6581s
Updating learning rate to 1.58622813e-05
Validation loss decreased (0.5573 --> 0.5523).  Saving model state dict ...
Epoch: 5 cost time: 4.8214640617370605
Epoch: 5, Steps: 979 | Train Loss: 0.7008119 Vali Loss: 0.5522733 Best vali loss: 0.5522733
	iters: 100, epoch: 6 | loss: 0.8076941
	speed: 0.0151s/iter; left time: 42.8956s
	iters: 200, epoch: 6 | loss: 0.5114512
	speed: 0.0046s/iter; left time: 12.4736s
	iters: 300, epoch: 6 | loss: 0.5881128
	speed: 0.0048s/iter; left time: 12.6500s
	iters: 400, epoch: 6 | loss: 1.2989787
	speed: 0.0048s/iter; left time: 12.2676s
	iters: 500, epoch: 6 | loss: 0.3918869
	speed: 0.0049s/iter; left time: 11.8646s
	iters: 600, epoch: 6 | loss: 0.3711265
	speed: 0.0046s/iter; left time: 10.6887s
	iters: 700, epoch: 6 | loss: 0.5109557
	speed: 0.0046s/iter; left time: 10.3255s
	iters: 800, epoch: 6 | loss: 0.6203436
	speed: 0.0049s/iter; left time: 10.4375s
	iters: 900, epoch: 6 | loss: 0.8286893
	speed: 0.0050s/iter; left time: 10.1897s
Updating learning rate to 7.93114065e-06
Validation loss decreased (0.5523 --> 0.5519).  Saving model state dict ...
Epoch: 6 cost time: 4.708285093307495
Epoch: 6, Steps: 979 | Train Loss: 0.6588043 Vali Loss: 0.5518678 Best vali loss: 0.5518678
	iters: 100, epoch: 7 | loss: 0.7406075
	speed: 0.0160s/iter; left time: 29.7155s
	iters: 200, epoch: 7 | loss: 0.3752568
	speed: 0.0048s/iter; left time: 8.4057s
	iters: 300, epoch: 7 | loss: 0.2344132
	speed: 0.0049s/iter; left time: 8.1062s
	iters: 400, epoch: 7 | loss: 0.3376875
	speed: 0.0047s/iter; left time: 7.3231s
	iters: 500, epoch: 7 | loss: 0.2542256
	speed: 0.0047s/iter; left time: 6.8982s
	iters: 600, epoch: 7 | loss: 0.6698382
	speed: 0.0047s/iter; left time: 6.4417s
	iters: 700, epoch: 7 | loss: 0.2987070
	speed: 0.0048s/iter; left time: 5.9981s
	iters: 800, epoch: 7 | loss: 0.8738006
	speed: 0.0047s/iter; left time: 5.4681s
	iters: 900, epoch: 7 | loss: 0.5560461
	speed: 0.0047s/iter; left time: 5.0064s
Updating learning rate to 3.965570325e-06
Validation loss decreased (0.5519 --> 0.5509).  Saving model state dict ...
Epoch: 7 cost time: 4.722952365875244
Epoch: 7, Steps: 979 | Train Loss: 0.4822870 Vali Loss: 0.5509400 Best vali loss: 0.5509400
	iters: 100, epoch: 8 | loss: 0.3684258
	speed: 0.0149s/iter; left time: 13.0958s
	iters: 200, epoch: 8 | loss: 0.6367565
	speed: 0.0045s/iter; left time: 3.5443s
	iters: 300, epoch: 8 | loss: 0.4197942
	speed: 0.0047s/iter; left time: 3.1888s
	iters: 400, epoch: 8 | loss: 1.4951284
	speed: 0.0048s/iter; left time: 2.7997s
	iters: 500, epoch: 8 | loss: 0.9934360
	speed: 0.0048s/iter; left time: 2.3072s
	iters: 600, epoch: 8 | loss: 0.8374595
	speed: 0.0048s/iter; left time: 1.8252s
	iters: 700, epoch: 8 | loss: 0.8624536
	speed: 0.0048s/iter; left time: 1.3409s
	iters: 800, epoch: 8 | loss: 0.8352181
	speed: 0.0047s/iter; left time: 0.8478s
	iters: 900, epoch: 8 | loss: 0.6024686
	speed: 0.0047s/iter; left time: 0.3767s
Updating learning rate to 1.9827851625e-06
Validation loss decreased (0.5509 --> 0.5507).  Saving model state dict ...
Epoch: 8 cost time: 4.656343221664429
Epoch: 8, Steps: 979 | Train Loss: 0.7834601 Vali Loss: 0.5506700 Best vali loss: 0.5506700

best validation loss 0.5506700433787236

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0073925200779, 'e_layers': 1, 'learning_rate': 0.0016054869449, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5971650
	speed: 0.0090s/iter; left time: 16.7156s
	iters: 200, epoch: 1 | loss: 0.8074756
	speed: 0.0030s/iter; left time: 5.2352s
Updating learning rate to 0.001544381736503593
Validation loss decreased (inf --> 0.6520).  Saving model state dict ...
Epoch: 1 cost time: 1.0764532089233398
Epoch: 1, Steps: 245 | Train Loss: 0.7023203 Vali Loss: 0.6520347 Best vali loss: 0.6520347
	iters: 100, epoch: 2 | loss: 1.3369168
	speed: 0.0069s/iter; left time: 11.2109s
	iters: 200, epoch: 2 | loss: 0.7838267
	speed: 0.0030s/iter; left time: 4.5019s
Updating learning rate to 0.0013703688253726314
Validation loss decreased (0.6520 --> 0.5996).  Saving model state dict ...
Epoch: 2 cost time: 0.7818632125854492
Epoch: 2, Steps: 245 | Train Loss: 1.0603718 Vali Loss: 0.5996237 Best vali loss: 0.5996237
	iters: 100, epoch: 3 | loss: 0.9735857
	speed: 0.0071s/iter; left time: 9.6841s
	iters: 200, epoch: 3 | loss: 0.8277208
	speed: 0.0029s/iter; left time: 3.6801s
Updating learning rate to 0.001109940099795837
Epoch: 3 cost time: 0.7548058032989502
Epoch: 3, Steps: 245 | Train Loss: 0.9006533 Vali Loss: 0.6487848 Best vali loss: 0.5996237
	iters: 100, epoch: 4 | loss: 1.0986834
	speed: 0.0067s/iter; left time: 7.5451s
	iters: 200, epoch: 4 | loss: 0.5585686
	speed: 0.0029s/iter; left time: 3.0040s
Updating learning rate to 0.00080274347245
Validation loss decreased (0.5996 --> 0.5728).  Saving model state dict ...
Epoch: 4 cost time: 0.7694964408874512
Epoch: 4, Steps: 245 | Train Loss: 0.8286260 Vali Loss: 0.5728207 Best vali loss: 0.5728207
	iters: 100, epoch: 5 | loss: 0.9264594
	speed: 0.0069s/iter; left time: 6.0984s
	iters: 200, epoch: 5 | loss: 0.8875849
	speed: 0.0028s/iter; left time: 2.1869s
Updating learning rate to 0.0004955468451041631
Epoch: 5 cost time: 0.7480762004852295
Epoch: 5, Steps: 245 | Train Loss: 0.9070221 Vali Loss: 0.6119647 Best vali loss: 0.5728207
	iters: 100, epoch: 6 | loss: 0.7950006
	speed: 0.0068s/iter; left time: 4.3055s
	iters: 200, epoch: 6 | loss: 0.8456851
	speed: 0.0028s/iter; left time: 1.4742s
Updating learning rate to 0.00023511811952736856
Validation loss decreased (0.5728 --> 0.5658).  Saving model state dict ...
Epoch: 6 cost time: 0.7426166534423828
Epoch: 6, Steps: 245 | Train Loss: 0.8203428 Vali Loss: 0.5657804 Best vali loss: 0.5657804
	iters: 100, epoch: 7 | loss: 0.7262809
	speed: 0.0071s/iter; left time: 2.7644s
	iters: 200, epoch: 7 | loss: 0.5923934
	speed: 0.0029s/iter; left time: 0.8474s
Updating learning rate to 6.110520839640702e-05
Epoch: 7 cost time: 0.7700963020324707
Epoch: 7, Steps: 245 | Train Loss: 0.6593372 Vali Loss: 0.5849378 Best vali loss: 0.5657804
	iters: 100, epoch: 8 | loss: 0.7175500
	speed: 0.0067s/iter; left time: 0.9805s
	iters: 200, epoch: 8 | loss: 0.5639508
	speed: 0.0032s/iter; left time: 0.1457s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8052563667297363
Epoch: 8, Steps: 245 | Train Loss: 0.6407504 Vali Loss: 0.5878726 Best vali loss: 0.5657804

best validation loss 0.5657803523821833

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0038504472927, 'e_layers': 3, 'learning_rate': 0.0012364547461, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6658521
	speed: 0.0114s/iter; left time: 10.0875s
Updating learning rate to 0.001189394989449115
Validation loss decreased (inf --> 0.6227).  Saving model state dict ...
Epoch: 1 cost time: 0.9939925670623779
Epoch: 1, Steps: 123 | Train Loss: 0.6658521 Vali Loss: 0.6226503 Best vali loss: 0.6226503
	iters: 100, epoch: 2 | loss: 0.8125258
	speed: 0.0088s/iter; left time: 6.7287s
Updating learning rate to 0.0010553801408488004
Epoch: 2 cost time: 0.7337930202484131
Epoch: 2, Steps: 123 | Train Loss: 0.8125258 Vali Loss: 0.6714093 Best vali loss: 0.6226503
	iters: 100, epoch: 3 | loss: 0.5532007
	speed: 0.0090s/iter; left time: 5.7598s
Updating learning rate to 0.0008548127461508268
Epoch: 3 cost time: 0.7315783500671387
Epoch: 3, Steps: 123 | Train Loss: 0.5532007 Vali Loss: 0.6231881 Best vali loss: 0.6226503

best validation loss 0.6226503077837562

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0029143115521, 'e_layers': 4, 'learning_rate': 0.0007181795561, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4550613
	speed: 0.0113s/iter; left time: 43.0963s
	iters: 200, epoch: 1 | loss: 0.4563147
	speed: 0.0054s/iter; left time: 19.9177s
	iters: 300, epoch: 1 | loss: 0.6443568
	speed: 0.0049s/iter; left time: 17.7769s
	iters: 400, epoch: 1 | loss: 1.1947521
	speed: 0.0048s/iter; left time: 16.8870s
Updating learning rate to 0.0007181795561
Validation loss decreased (inf --> 0.6259).  Saving model state dict ...
Epoch: 1 cost time: 2.8028323650360107
Epoch: 1, Steps: 490 | Train Loss: 0.9376212 Vali Loss: 0.6258726 Best vali loss: 0.6258726
	iters: 100, epoch: 2 | loss: 0.7943699
	speed: 0.0137s/iter; left time: 45.6383s
	iters: 200, epoch: 2 | loss: 0.7514399
	speed: 0.0046s/iter; left time: 14.7260s
	iters: 300, epoch: 2 | loss: 0.7026333
	speed: 0.0049s/iter; left time: 15.3186s
	iters: 400, epoch: 2 | loss: 0.5274666
	speed: 0.0049s/iter; left time: 14.8302s
Updating learning rate to 0.00035908977805
Validation loss decreased (0.6259 --> 0.6153).  Saving model state dict ...
Epoch: 2 cost time: 2.433401346206665
Epoch: 2, Steps: 490 | Train Loss: 0.6939774 Vali Loss: 0.6153482 Best vali loss: 0.6153482
	iters: 100, epoch: 3 | loss: 0.3481305
	speed: 0.0131s/iter; left time: 37.3001s
	iters: 200, epoch: 3 | loss: 0.3530710
	speed: 0.0054s/iter; left time: 14.7317s
	iters: 300, epoch: 3 | loss: 0.8932387
	speed: 0.0054s/iter; left time: 14.1923s
	iters: 400, epoch: 3 | loss: 0.5950475
	speed: 0.0052s/iter; left time: 13.2708s
Updating learning rate to 0.000179544889025
Validation loss decreased (0.6153 --> 0.6088).  Saving model state dict ...
Epoch: 3 cost time: 2.62003493309021
Epoch: 3, Steps: 490 | Train Loss: 0.5473719 Vali Loss: 0.6087803 Best vali loss: 0.6087803

best validation loss 0.6087803000766113

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001048878548, 'e_layers': 2, 'learning_rate': 0.0001953622427, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7630633
	speed: 0.0116s/iter; left time: 10.3021s
Updating learning rate to 0.00018792671007801626
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 1.024413824081421
Epoch: 1, Steps: 123 | Train Loss: 0.7630633 Vali Loss: 0.6093668 Best vali loss: 0.6093668
	iters: 100, epoch: 2 | loss: 0.9258768
	speed: 0.0090s/iter; left time: 6.8832s
Updating learning rate to 0.00016675210465049104
Validation loss decreased (0.6094 --> 0.5461).  Saving model state dict ...
Epoch: 2 cost time: 0.7104651927947998
Epoch: 2, Steps: 123 | Train Loss: 0.9258768 Vali Loss: 0.5460852 Best vali loss: 0.5460852
	iters: 100, epoch: 3 | loss: 0.8535920
	speed: 0.0091s/iter; left time: 5.7854s
Updating learning rate to 0.00013506206814548885
Validation loss decreased (0.5461 --> 0.5442).  Saving model state dict ...
Epoch: 3 cost time: 0.7079241275787354
Epoch: 3, Steps: 123 | Train Loss: 0.8535920 Vali Loss: 0.5441956 Best vali loss: 0.5441956

best validation loss 0.5441955591947157

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001048878548, 'e_layers': 2, 'learning_rate': 0.0001953622427, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5988396
	speed: 0.0121s/iter; left time: 6.2342s
Updating learning rate to 9.768112135e-05
Validation loss decreased (0.5442 --> 0.5346).  Saving model state dict ...
Epoch: 4 cost time: 1.0266234874725342
Epoch: 4, Steps: 123 | Train Loss: 0.5988396 Vali Loss: 0.5345679 Best vali loss: 0.5345679
	iters: 100, epoch: 5 | loss: 0.8469706
	speed: 0.0092s/iter; left time: 3.6069s
Updating learning rate to 6.0300174554511154e-05
Validation loss decreased (0.5346 --> 0.5310).  Saving model state dict ...
Epoch: 5 cost time: 0.717625617980957
Epoch: 5, Steps: 123 | Train Loss: 0.8469706 Vali Loss: 0.5309885 Best vali loss: 0.5309885
	iters: 100, epoch: 6 | loss: 0.7975752
	speed: 0.0095s/iter; left time: 2.5551s
Updating learning rate to 2.861013804950896e-05
Validation loss decreased (0.5310 --> 0.5287).  Saving model state dict ...
Epoch: 6 cost time: 0.719806432723999
Epoch: 6, Steps: 123 | Train Loss: 0.7975752 Vali Loss: 0.5286525 Best vali loss: 0.5286525
	iters: 100, epoch: 7 | loss: 0.4809640
	speed: 0.0091s/iter; left time: 1.3369s
Updating learning rate to 7.4355326219837295e-06
Validation loss decreased (0.5287 --> 0.5284).  Saving model state dict ...
Epoch: 7 cost time: 0.7139949798583984
Epoch: 7, Steps: 123 | Train Loss: 0.4809640 Vali Loss: 0.5284165 Best vali loss: 0.5284165
	iters: 100, epoch: 8 | loss: 0.5440344
	speed: 0.0093s/iter; left time: 0.2237s
Updating learning rate to 0.0
Validation loss decreased (0.5284 --> 0.5258).  Saving model state dict ...
Epoch: 8 cost time: 0.7300009727478027
Epoch: 8, Steps: 123 | Train Loss: 0.5440344 Vali Loss: 0.5257800 Best vali loss: 0.5257800

best validation loss 0.5257799955277132

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0047701062313, 'e_layers': 1, 'learning_rate': 0.001779306901, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6584666
	speed: 0.0100s/iter; left time: 8.8716s
Updating learning rate to 0.001779306901
Validation loss decreased (inf --> 0.6155).  Saving model state dict ...
Epoch: 1 cost time: 0.8180334568023682
Epoch: 1, Steps: 123 | Train Loss: 0.6584666 Vali Loss: 0.6154936 Best vali loss: 0.6154936
	iters: 100, epoch: 2 | loss: 1.0116874
	speed: 0.0067s/iter; left time: 5.0808s
Updating learning rate to 0.0008896534505
Epoch: 2 cost time: 0.4796884059906006
Epoch: 2, Steps: 123 | Train Loss: 1.0116874 Vali Loss: 0.6611034 Best vali loss: 0.6154936
	iters: 100, epoch: 3 | loss: 1.2486088
	speed: 0.0064s/iter; left time: 4.1188s
Updating learning rate to 0.00044482672525
Epoch: 3 cost time: 0.4992527961730957
Epoch: 3, Steps: 123 | Train Loss: 1.2486088 Vali Loss: 0.6308660 Best vali loss: 0.6154936
	iters: 100, epoch: 4 | loss: 0.8215086
	speed: 0.0066s/iter; left time: 3.4225s
Updating learning rate to 0.000222413362625
Epoch: 4 cost time: 0.4924342632293701
Epoch: 4, Steps: 123 | Train Loss: 0.8215086 Vali Loss: 0.6307267 Best vali loss: 0.6154936
	iters: 100, epoch: 5 | loss: 0.8917888
	speed: 0.0065s/iter; left time: 2.5724s
Updating learning rate to 0.0001112066813125
Epoch: 5 cost time: 0.4993901252746582
Epoch: 5, Steps: 123 | Train Loss: 0.8917888 Vali Loss: 0.6395837 Best vali loss: 0.6154936
	iters: 100, epoch: 6 | loss: 0.9397890
	speed: 0.0065s/iter; left time: 1.7547s
Updating learning rate to 5.560334065625e-05
Epoch: 6 cost time: 0.48395752906799316
Epoch: 6, Steps: 123 | Train Loss: 0.9397890 Vali Loss: 0.6451497 Best vali loss: 0.6154936
	iters: 100, epoch: 7 | loss: 0.8295280
	speed: 0.0067s/iter; left time: 0.9816s
Updating learning rate to 2.7801670328125e-05
Epoch: 7 cost time: 0.512061595916748
Epoch: 7, Steps: 123 | Train Loss: 0.8295280 Vali Loss: 0.6487459 Best vali loss: 0.6154936
	iters: 100, epoch: 8 | loss: 0.7995142
	speed: 0.0069s/iter; left time: 0.1651s
Updating learning rate to 1.39008351640625e-05
Epoch: 8 cost time: 0.5327057838439941
Epoch: 8, Steps: 123 | Train Loss: 0.7995142 Vali Loss: 0.6481703 Best vali loss: 0.6154936

best validation loss 0.6154935578955704

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032233279295, 'e_layers': 3, 'learning_rate': 0.0003277115025, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5236282
	speed: 0.0116s/iter; left time: 21.6406s
	iters: 200, epoch: 1 | loss: 0.6477795
	speed: 0.0056s/iter; left time: 9.8966s
Updating learning rate to 0.0003277115025
Validation loss decreased (inf --> 0.6054).  Saving model state dict ...
Epoch: 1 cost time: 1.7117269039154053
Epoch: 1, Steps: 245 | Train Loss: 0.5857038 Vali Loss: 0.6054473 Best vali loss: 0.6054473
	iters: 100, epoch: 2 | loss: 0.7093529
	speed: 0.0114s/iter; left time: 18.4281s
	iters: 200, epoch: 2 | loss: 0.9631163
	speed: 0.0058s/iter; left time: 8.7289s
Updating learning rate to 0.00016385575125
Validation loss decreased (0.6054 --> 0.6031).  Saving model state dict ...
Epoch: 2 cost time: 1.4517316818237305
Epoch: 2, Steps: 245 | Train Loss: 0.8362346 Vali Loss: 0.6030807 Best vali loss: 0.6030807
	iters: 100, epoch: 3 | loss: 0.6627017
	speed: 0.0118s/iter; left time: 16.1407s
	iters: 200, epoch: 3 | loss: 0.6428662
	speed: 0.0056s/iter; left time: 7.1207s
Updating learning rate to 8.1927875625e-05
Validation loss decreased (0.6031 --> 0.5670).  Saving model state dict ...
Epoch: 3 cost time: 1.4156575202941895
Epoch: 3, Steps: 245 | Train Loss: 0.6527839 Vali Loss: 0.5669983 Best vali loss: 0.5669983
	iters: 100, epoch: 4 | loss: 0.7797908
	speed: 0.0116s/iter; left time: 13.0285s
	iters: 200, epoch: 4 | loss: 0.8831477
	speed: 0.0057s/iter; left time: 5.8026s
Updating learning rate to 4.09639378125e-05
Validation loss decreased (0.5670 --> 0.5627).  Saving model state dict ...
Epoch: 4 cost time: 1.4261500835418701
Epoch: 4, Steps: 245 | Train Loss: 0.8314693 Vali Loss: 0.5626842 Best vali loss: 0.5626842
	iters: 100, epoch: 5 | loss: 0.6902447
	speed: 0.0116s/iter; left time: 10.1782s
	iters: 200, epoch: 5 | loss: 0.6877209
	speed: 0.0056s/iter; left time: 4.3798s
Updating learning rate to 2.048196890625e-05
Validation loss decreased (0.5627 --> 0.5567).  Saving model state dict ...
Epoch: 5 cost time: 1.4151241779327393
Epoch: 5, Steps: 245 | Train Loss: 0.6889828 Vali Loss: 0.5567363 Best vali loss: 0.5567363
	iters: 100, epoch: 6 | loss: 0.5793636
	speed: 0.0115s/iter; left time: 7.3176s
	iters: 200, epoch: 6 | loss: 0.4139129
	speed: 0.0056s/iter; left time: 2.9831s
Updating learning rate to 1.0240984453125e-05
Epoch: 6 cost time: 1.410665512084961
Epoch: 6, Steps: 245 | Train Loss: 0.4966383 Vali Loss: 0.5633347 Best vali loss: 0.5567363
	iters: 100, epoch: 7 | loss: 0.7198930
	speed: 0.0113s/iter; left time: 4.4110s
	iters: 200, epoch: 7 | loss: 0.5735466
	speed: 0.0057s/iter; left time: 1.6593s
Updating learning rate to 5.1204922265625e-06
Epoch: 7 cost time: 1.442274808883667
Epoch: 7, Steps: 245 | Train Loss: 0.6467198 Vali Loss: 0.5674491 Best vali loss: 0.5567363
	iters: 100, epoch: 8 | loss: 0.6656803
	speed: 0.0111s/iter; left time: 1.6251s
	iters: 200, epoch: 8 | loss: 0.6852124
	speed: 0.0056s/iter; left time: 0.2591s
Updating learning rate to 2.56024611328125e-06
Epoch: 8 cost time: 1.4201710224151611
Epoch: 8, Steps: 245 | Train Loss: 0.6754464 Vali Loss: 0.5619535 Best vali loss: 0.5567363

best validation loss 0.556736266044818

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010734000886, 'e_layers': 3, 'learning_rate': 0.0003236586837, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6166012
	speed: 0.0112s/iter; left time: 20.8263s
	iters: 200, epoch: 1 | loss: 0.6072973
	speed: 0.0050s/iter; left time: 8.8549s
Updating learning rate to 0.0003113401585449872
Validation loss decreased (inf --> 0.5852).  Saving model state dict ...
Epoch: 1 cost time: 1.5655765533447266
Epoch: 1, Steps: 245 | Train Loss: 0.6119492 Vali Loss: 0.5851620 Best vali loss: 0.5851620
	iters: 100, epoch: 2 | loss: 0.5489068
	speed: 0.0104s/iter; left time: 16.8162s
	iters: 200, epoch: 2 | loss: 1.2961905
	speed: 0.0050s/iter; left time: 7.5986s
Updating learning rate to 0.00027625996686709095
Validation loss decreased (0.5852 --> 0.5654).  Saving model state dict ...
Epoch: 2 cost time: 1.2836031913757324
Epoch: 2, Steps: 245 | Train Loss: 0.9225487 Vali Loss: 0.5653914 Best vali loss: 0.5653914
	iters: 100, epoch: 3 | loss: 0.7547411
	speed: 0.0108s/iter; left time: 14.8068s
	iters: 200, epoch: 3 | loss: 0.4704136
	speed: 0.0051s/iter; left time: 6.4625s
Updating learning rate to 0.00022375874984654148
Validation loss decreased (0.5654 --> 0.5429).  Saving model state dict ...
Epoch: 3 cost time: 1.3131580352783203
Epoch: 3, Steps: 245 | Train Loss: 0.6125774 Vali Loss: 0.5429393 Best vali loss: 0.5429393

best validation loss 0.5429393403483783

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494665051, 'e_layers': 2, 'learning_rate': 0.0002978660316, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744423
	speed: 0.0116s/iter; left time: 10.2558s
Updating learning rate to 0.00028652918081280006
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0113317966461182
Epoch: 1, Steps: 123 | Train Loss: 0.7744423 Vali Loss: 0.6173595 Best vali loss: 0.6173595
	iters: 100, epoch: 2 | loss: 0.9518696
	speed: 0.0092s/iter; left time: 6.9725s
Updating learning rate to 0.00025424456121474323
Validation loss decreased (0.6174 --> 0.5796).  Saving model state dict ...
Epoch: 2 cost time: 0.7218821048736572
Epoch: 2, Steps: 123 | Train Loss: 0.9518696 Vali Loss: 0.5795848 Best vali loss: 0.5795848
	iters: 100, epoch: 3 | loss: 0.8476096
	speed: 0.0094s/iter; left time: 6.0179s
Updating learning rate to 0.00020592721347882816
Validation loss decreased (0.5796 --> 0.5558).  Saving model state dict ...
Epoch: 3 cost time: 0.7336781024932861
Epoch: 3, Steps: 123 | Train Loss: 0.8476096 Vali Loss: 0.5558246 Best vali loss: 0.5558246

best validation loss 0.5558245887860056

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012422121293, 'e_layers': 3, 'learning_rate': 0.0003642643835, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9742591
	speed: 0.0106s/iter; left time: 81.9272s
	iters: 200, epoch: 1 | loss: 0.4579462
	speed: 0.0043s/iter; left time: 33.0641s
	iters: 300, epoch: 1 | loss: 1.0294250
	speed: 0.0044s/iter; left time: 33.4965s
	iters: 400, epoch: 1 | loss: 0.4401270
	speed: 0.0045s/iter; left time: 33.1863s
	iters: 500, epoch: 1 | loss: 0.2904249
	speed: 0.0044s/iter; left time: 32.0042s
	iters: 600, epoch: 1 | loss: 0.7449349
	speed: 0.0043s/iter; left time: 31.1745s
	iters: 700, epoch: 1 | loss: 1.0568345
	speed: 0.0045s/iter; left time: 32.3624s
	iters: 800, epoch: 1 | loss: 0.8184745
	speed: 0.0043s/iter; left time: 29.9484s
	iters: 900, epoch: 1 | loss: 1.2408627
	speed: 0.0041s/iter; left time: 28.2026s
Updating learning rate to 0.000350400395919246
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 4.593847751617432
Epoch: 1, Steps: 979 | Train Loss: 0.7836988 Vali Loss: 0.6035345 Best vali loss: 0.6035345
	iters: 100, epoch: 2 | loss: 0.8028315
	speed: 0.0132s/iter; left time: 89.1079s
	iters: 200, epoch: 2 | loss: 0.7055197
	speed: 0.0040s/iter; left time: 26.5751s
	iters: 300, epoch: 2 | loss: 0.8253463
	speed: 0.0041s/iter; left time: 26.8492s
	iters: 400, epoch: 2 | loss: 0.4750062
	speed: 0.0041s/iter; left time: 26.5240s
	iters: 500, epoch: 2 | loss: 0.3523727
	speed: 0.0041s/iter; left time: 25.9859s
	iters: 600, epoch: 2 | loss: 0.7669894
	speed: 0.0041s/iter; left time: 25.7037s
	iters: 700, epoch: 2 | loss: 1.0127188
	speed: 0.0039s/iter; left time: 24.2778s
	iters: 800, epoch: 2 | loss: 1.4304678
	speed: 0.0039s/iter; left time: 23.3483s
	iters: 900, epoch: 2 | loss: 0.5400126
	speed: 0.0040s/iter; left time: 23.9344s
Updating learning rate to 0.00031091909960879354
Epoch: 2 cost time: 3.987220525741577
Epoch: 2, Steps: 979 | Train Loss: 0.7679183 Vali Loss: 0.6225073 Best vali loss: 0.6035345
	iters: 100, epoch: 3 | loss: 0.6153551
	speed: 0.0134s/iter; left time: 77.6670s
	iters: 200, epoch: 3 | loss: 0.2470636
	speed: 0.0044s/iter; left time: 25.0525s
	iters: 300, epoch: 3 | loss: 1.2362131
	speed: 0.0044s/iter; left time: 24.4710s
	iters: 400, epoch: 3 | loss: 1.3809311
	speed: 0.0043s/iter; left time: 23.4939s
	iters: 500, epoch: 3 | loss: 0.5702180
	speed: 0.0043s/iter; left time: 23.2720s
	iters: 600, epoch: 3 | loss: 0.7742357
	speed: 0.0042s/iter; left time: 22.3741s
	iters: 700, epoch: 3 | loss: 0.9115455
	speed: 0.0044s/iter; left time: 22.6486s
	iters: 800, epoch: 3 | loss: 1.2065099
	speed: 0.0044s/iter; left time: 22.4018s
	iters: 900, epoch: 3 | loss: 0.4262989
	speed: 0.0044s/iter; left time: 21.9556s
Updating learning rate to 0.0002518311640330667
Validation loss decreased (0.6035 --> 0.5780).  Saving model state dict ...
Epoch: 3 cost time: 4.318382501602173
Epoch: 3, Steps: 979 | Train Loss: 0.8187079 Vali Loss: 0.5780120 Best vali loss: 0.5780120

best validation loss 0.5780119948340808

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010734000886, 'e_layers': 3, 'learning_rate': 0.0003236586837, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4574150
	speed: 0.0116s/iter; left time: 13.0833s
	iters: 200, epoch: 4 | loss: 0.4365516
	speed: 0.0050s/iter; left time: 5.1154s
Updating learning rate to 0.00016182934185
Epoch: 4 cost time: 1.5761325359344482
Epoch: 4, Steps: 245 | Train Loss: 0.4469833 Vali Loss: 0.5614162 Best vali loss: 0.5429393
	iters: 100, epoch: 5 | loss: 0.4793266
	speed: 0.0101s/iter; left time: 8.9154s
	iters: 200, epoch: 5 | loss: 0.9859270
	speed: 0.0050s/iter; left time: 3.8690s
Updating learning rate to 9.989993385345854e-05
Epoch: 5 cost time: 1.2663745880126953
Epoch: 5, Steps: 245 | Train Loss: 0.7326268 Vali Loss: 0.5557981 Best vali loss: 0.5429393
	iters: 100, epoch: 6 | loss: 0.5944936
	speed: 0.0100s/iter; left time: 6.3457s
	iters: 200, epoch: 6 | loss: 0.4246021
	speed: 0.0050s/iter; left time: 2.6838s
Updating learning rate to 4.739871683290906e-05
Epoch: 6 cost time: 1.2660441398620605
Epoch: 6, Steps: 245 | Train Loss: 0.5095479 Vali Loss: 0.5762298 Best vali loss: 0.5429393
	iters: 100, epoch: 7 | loss: 0.5782026
	speed: 0.0103s/iter; left time: 4.0151s
	iters: 200, epoch: 7 | loss: 0.5765085
	speed: 0.0051s/iter; left time: 1.4828s
Updating learning rate to 1.2318525155012788e-05
Epoch: 7 cost time: 1.2969725131988525
Epoch: 7, Steps: 245 | Train Loss: 0.5773555 Vali Loss: 0.6054873 Best vali loss: 0.5429393
	iters: 100, epoch: 8 | loss: 0.6530472
	speed: 0.0103s/iter; left time: 1.5061s
	iters: 200, epoch: 8 | loss: 0.4418600
	speed: 0.0050s/iter; left time: 0.2286s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2848656177520752
Epoch: 8, Steps: 245 | Train Loss: 0.5474536 Vali Loss: 0.6119005 Best vali loss: 0.5429393

best validation loss 0.5429393403483783

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018498059643, 'e_layers': 3, 'learning_rate': 9.05153761e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.7275499
	speed: 0.0104s/iter; left time: 80.1610s
	iters: 200, epoch: 1 | loss: 0.8092583
	speed: 0.0045s/iter; left time: 34.0017s
	iters: 300, epoch: 1 | loss: 0.3481793
	speed: 0.0044s/iter; left time: 32.8036s
	iters: 400, epoch: 1 | loss: 0.7691073
	speed: 0.0044s/iter; left time: 32.7698s
	iters: 500, epoch: 1 | loss: 0.3304030
	speed: 0.0045s/iter; left time: 32.9269s
	iters: 600, epoch: 1 | loss: 0.6376879
	speed: 0.0042s/iter; left time: 30.6413s
	iters: 700, epoch: 1 | loss: 0.4907702
	speed: 0.0040s/iter; left time: 28.6984s
	iters: 800, epoch: 1 | loss: 0.3264158
	speed: 0.0041s/iter; left time: 28.9737s
	iters: 900, epoch: 1 | loss: 0.4598537
	speed: 0.0040s/iter; left time: 27.8734s
Updating learning rate to 8.707033972817565e-05
Validation loss decreased (inf --> 0.6067).  Saving model state dict ...
Epoch: 1 cost time: 4.489449501037598
Epoch: 1, Steps: 979 | Train Loss: 0.6554695 Vali Loss: 0.6066722 Best vali loss: 0.6066722
	iters: 100, epoch: 2 | loss: 0.7229049
	speed: 0.0133s/iter; left time: 89.6721s
	iters: 200, epoch: 2 | loss: 0.7253039
	speed: 0.0042s/iter; left time: 28.1761s
	iters: 300, epoch: 2 | loss: 0.5817912
	speed: 0.0044s/iter; left time: 28.5155s
	iters: 400, epoch: 2 | loss: 1.6732509
	speed: 0.0042s/iter; left time: 27.2865s
	iters: 500, epoch: 2 | loss: 1.1743195
	speed: 0.0040s/iter; left time: 25.5880s
	iters: 600, epoch: 2 | loss: 0.5835320
	speed: 0.0041s/iter; left time: 25.5284s
	iters: 700, epoch: 2 | loss: 1.1186457
	speed: 0.0039s/iter; left time: 24.1600s
	iters: 800, epoch: 2 | loss: 0.7089897
	speed: 0.0038s/iter; left time: 23.2455s
	iters: 900, epoch: 2 | loss: 0.4756893
	speed: 0.0040s/iter; left time: 23.9812s
Updating learning rate to 7.725970617098037e-05
Epoch: 2 cost time: 4.0467445850372314
Epoch: 2, Steps: 979 | Train Loss: 0.8627141 Vali Loss: 0.6073376 Best vali loss: 0.6066722
	iters: 100, epoch: 3 | loss: 0.7857813
	speed: 0.0130s/iter; left time: 74.8549s
	iters: 200, epoch: 3 | loss: 0.6797249
	speed: 0.0040s/iter; left time: 22.7983s
	iters: 300, epoch: 3 | loss: 0.3555841
	speed: 0.0041s/iter; left time: 22.5810s
	iters: 400, epoch: 3 | loss: 0.3769948
	speed: 0.0040s/iter; left time: 21.7644s
	iters: 500, epoch: 3 | loss: 0.6897078
	speed: 0.0040s/iter; left time: 21.4962s
	iters: 600, epoch: 3 | loss: 0.6115099
	speed: 0.0039s/iter; left time: 20.7437s
	iters: 700, epoch: 3 | loss: 1.2049960
	speed: 0.0038s/iter; left time: 19.4092s
	iters: 800, epoch: 3 | loss: 0.4380351
	speed: 0.0038s/iter; left time: 19.1857s
	iters: 900, epoch: 3 | loss: 0.7475266
	speed: 0.0039s/iter; left time: 19.5270s
Updating learning rate to 6.257705545388251e-05
Validation loss decreased (0.6067 --> 0.5713).  Saving model state dict ...
Epoch: 3 cost time: 3.890727996826172
Epoch: 3, Steps: 979 | Train Loss: 0.6544289 Vali Loss: 0.5713011 Best vali loss: 0.5713011
	iters: 100, epoch: 4 | loss: 0.8778541
	speed: 0.0134s/iter; left time: 64.0557s
	iters: 200, epoch: 4 | loss: 0.7970485
	speed: 0.0042s/iter; left time: 19.5716s
	iters: 300, epoch: 4 | loss: 0.5255693
	speed: 0.0041s/iter; left time: 18.8823s
	iters: 400, epoch: 4 | loss: 1.0423812
	speed: 0.0040s/iter; left time: 18.0805s
	iters: 500, epoch: 4 | loss: 0.9072270
	speed: 0.0041s/iter; left time: 17.8328s
	iters: 600, epoch: 4 | loss: 0.8653722
	speed: 0.0040s/iter; left time: 17.3068s
	iters: 700, epoch: 4 | loss: 0.4111875
	speed: 0.0041s/iter; left time: 17.2403s
	iters: 800, epoch: 4 | loss: 0.3929343
	speed: 0.0042s/iter; left time: 17.1048s
	iters: 900, epoch: 4 | loss: 0.9881833
	speed: 0.0039s/iter; left time: 15.7642s
Updating learning rate to 4.525768805e-05
Validation loss decreased (0.5713 --> 0.5670).  Saving model state dict ...
Epoch: 4 cost time: 4.054672956466675
Epoch: 4, Steps: 979 | Train Loss: 0.7564175 Vali Loss: 0.5669892 Best vali loss: 0.5669892
	iters: 100, epoch: 5 | loss: 1.6331284
	speed: 0.0136s/iter; left time: 51.9694s
	iters: 200, epoch: 5 | loss: 0.4738831
	speed: 0.0042s/iter; left time: 15.7053s
	iters: 300, epoch: 5 | loss: 0.8025655
	speed: 0.0041s/iter; left time: 14.7217s
	iters: 400, epoch: 5 | loss: 0.8185171
	speed: 0.0041s/iter; left time: 14.3085s
	iters: 500, epoch: 5 | loss: 1.0868109
	speed: 0.0040s/iter; left time: 13.5357s
	iters: 600, epoch: 5 | loss: 1.1060063
	speed: 0.0041s/iter; left time: 13.5418s
	iters: 700, epoch: 5 | loss: 0.5359503
	speed: 0.0041s/iter; left time: 13.2921s
	iters: 800, epoch: 5 | loss: 0.2528266
	speed: 0.0040s/iter; left time: 12.5689s
	iters: 900, epoch: 5 | loss: 0.8196482
	speed: 0.0040s/iter; left time: 11.9955s
Updating learning rate to 2.7938320646117496e-05
Validation loss decreased (0.5670 --> 0.5588).  Saving model state dict ...
Epoch: 5 cost time: 4.061305999755859
Epoch: 5, Steps: 979 | Train Loss: 0.8365929 Vali Loss: 0.5587665 Best vali loss: 0.5587665
	iters: 100, epoch: 6 | loss: 0.3355736
	speed: 0.0134s/iter; left time: 37.9533s
	iters: 200, epoch: 6 | loss: 0.5901638
	speed: 0.0042s/iter; left time: 11.4753s
	iters: 300, epoch: 6 | loss: 0.7063823
	speed: 0.0044s/iter; left time: 11.4951s
	iters: 400, epoch: 6 | loss: 1.0291018
	speed: 0.0043s/iter; left time: 10.9197s
	iters: 500, epoch: 6 | loss: 0.3950160
	speed: 0.0044s/iter; left time: 10.7263s
	iters: 600, epoch: 6 | loss: 0.4155913
	speed: 0.0044s/iter; left time: 10.2781s
	iters: 700, epoch: 6 | loss: 0.4183656
	speed: 0.0043s/iter; left time: 9.5792s
	iters: 800, epoch: 6 | loss: 1.1346102
	speed: 0.0043s/iter; left time: 9.2013s
	iters: 900, epoch: 6 | loss: 0.3789855
	speed: 0.0043s/iter; left time: 8.7532s
Updating learning rate to 1.3255669929019627e-05
Epoch: 6 cost time: 4.268900394439697
Epoch: 6, Steps: 979 | Train Loss: 0.6004211 Vali Loss: 0.5648494 Best vali loss: 0.5587665
	iters: 100, epoch: 7 | loss: 1.2779630
	speed: 0.0136s/iter; left time: 25.3658s
	iters: 200, epoch: 7 | loss: 0.7189704
	speed: 0.0045s/iter; left time: 7.8963s
	iters: 300, epoch: 7 | loss: 0.2781871
	speed: 0.0045s/iter; left time: 7.4439s
	iters: 400, epoch: 7 | loss: 0.2849632
	speed: 0.0042s/iter; left time: 6.5378s
	iters: 500, epoch: 7 | loss: 0.7428865
	speed: 0.0042s/iter; left time: 6.1063s
	iters: 600, epoch: 7 | loss: 0.3218785
	speed: 0.0041s/iter; left time: 5.6113s
	iters: 700, epoch: 7 | loss: 1.3001165
	speed: 0.0039s/iter; left time: 4.8844s
	iters: 800, epoch: 7 | loss: 0.2661354
	speed: 0.0038s/iter; left time: 4.4144s
	iters: 900, epoch: 7 | loss: 1.6419042
	speed: 0.0039s/iter; left time: 4.1321s
Updating learning rate to 3.445036371824352e-06
Epoch: 7 cost time: 4.095011949539185
Epoch: 7, Steps: 979 | Train Loss: 0.7592228 Vali Loss: 0.5624444 Best vali loss: 0.5587665
	iters: 100, epoch: 8 | loss: 0.3475815
	speed: 0.0127s/iter; left time: 11.1646s
	iters: 200, epoch: 8 | loss: 0.3237068
	speed: 0.0040s/iter; left time: 3.1488s
	iters: 300, epoch: 8 | loss: 0.4567136
	speed: 0.0042s/iter; left time: 2.8425s
	iters: 400, epoch: 8 | loss: 0.2538550
	speed: 0.0042s/iter; left time: 2.4193s
	iters: 500, epoch: 8 | loss: 0.9089586
	speed: 0.0042s/iter; left time: 2.0082s
	iters: 600, epoch: 8 | loss: 1.4196515
	speed: 0.0039s/iter; left time: 1.4887s
	iters: 700, epoch: 8 | loss: 0.5801875
	speed: 0.0038s/iter; left time: 1.0656s
	iters: 800, epoch: 8 | loss: 0.8076528
	speed: 0.0040s/iter; left time: 0.7207s
	iters: 900, epoch: 8 | loss: 1.0071501
	speed: 0.0041s/iter; left time: 0.3241s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.9804797172546387
Epoch: 8, Steps: 979 | Train Loss: 0.6783842 Vali Loss: 0.5625743 Best vali loss: 0.5587665

best validation loss 0.5587664677941209

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0032658418962, 'e_layers': 3, 'learning_rate': 0.0001089866828, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6002967
	speed: 0.0113s/iter; left time: 21.0781s
	iters: 200, epoch: 1 | loss: 1.0399550
	speed: 0.0051s/iter; left time: 8.9376s
Updating learning rate to 0.0001089866828
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 1.6004600524902344
Epoch: 1, Steps: 245 | Train Loss: 0.8201259 Vali Loss: 0.6027098 Best vali loss: 0.6027098
	iters: 100, epoch: 2 | loss: 1.0592324
	speed: 0.0098s/iter; left time: 15.8556s
	iters: 200, epoch: 2 | loss: 0.6076703
	speed: 0.0047s/iter; left time: 7.0666s
Updating learning rate to 5.44933414e-05
Validation loss decreased (0.6027 --> 0.5838).  Saving model state dict ...
Epoch: 2 cost time: 1.182319164276123
Epoch: 2, Steps: 245 | Train Loss: 0.8334513 Vali Loss: 0.5838193 Best vali loss: 0.5838193
	iters: 100, epoch: 3 | loss: 1.0912114
	speed: 0.0096s/iter; left time: 13.2203s
	iters: 200, epoch: 3 | loss: 1.0558347
	speed: 0.0048s/iter; left time: 6.0886s
Updating learning rate to 2.72466707e-05
Validation loss decreased (0.5838 --> 0.5529).  Saving model state dict ...
Epoch: 3 cost time: 1.2279307842254639
Epoch: 3, Steps: 245 | Train Loss: 1.0735230 Vali Loss: 0.5529003 Best vali loss: 0.5529003
	iters: 100, epoch: 4 | loss: 1.0709456
	speed: 0.0104s/iter; left time: 11.7418s
	iters: 200, epoch: 4 | loss: 0.7297417
	speed: 0.0050s/iter; left time: 5.1491s
Updating learning rate to 1.362333535e-05
Epoch: 4 cost time: 1.2790765762329102
Epoch: 4, Steps: 245 | Train Loss: 0.9003437 Vali Loss: 0.5536206 Best vali loss: 0.5529003
	iters: 100, epoch: 5 | loss: 0.7092717
	speed: 0.0102s/iter; left time: 9.0280s
	iters: 200, epoch: 5 | loss: 0.7899115
	speed: 0.0052s/iter; left time: 4.0332s
Updating learning rate to 6.811667675e-06
Validation loss decreased (0.5529 --> 0.5511).  Saving model state dict ...
Epoch: 5 cost time: 1.3011353015899658
Epoch: 5, Steps: 245 | Train Loss: 0.7495916 Vali Loss: 0.5511270 Best vali loss: 0.5511270
	iters: 100, epoch: 6 | loss: 0.4459877
	speed: 0.0099s/iter; left time: 6.3080s
	iters: 200, epoch: 6 | loss: 0.7463372
	speed: 0.0045s/iter; left time: 2.4332s
Updating learning rate to 3.4058338375e-06
Validation loss decreased (0.5511 --> 0.5458).  Saving model state dict ...
Epoch: 6 cost time: 1.1661255359649658
Epoch: 6, Steps: 245 | Train Loss: 0.5961625 Vali Loss: 0.5457855 Best vali loss: 0.5457855
	iters: 100, epoch: 7 | loss: 0.6532610
	speed: 0.0099s/iter; left time: 3.8827s
	iters: 200, epoch: 7 | loss: 1.1447778
	speed: 0.0047s/iter; left time: 1.3634s
Updating learning rate to 1.70291691875e-06
Validation loss decreased (0.5458 --> 0.5456).  Saving model state dict ...
Epoch: 7 cost time: 1.2092859745025635
Epoch: 7, Steps: 245 | Train Loss: 0.8990194 Vali Loss: 0.5455786 Best vali loss: 0.5455786
	iters: 100, epoch: 8 | loss: 0.7869295
	speed: 0.0100s/iter; left time: 1.4586s
	iters: 200, epoch: 8 | loss: 0.8240274
	speed: 0.0049s/iter; left time: 0.2241s
Updating learning rate to 8.51458459375e-07
Epoch: 8 cost time: 1.2313361167907715
Epoch: 8, Steps: 245 | Train Loss: 0.8054785 Vali Loss: 0.5459908 Best vali loss: 0.5455786

best validation loss 0.5455786364600372

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0051944038701, 'e_layers': 1, 'learning_rate': 0.0002744975927, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8586252
	speed: 0.0102s/iter; left time: 9.0413s
Updating learning rate to 0.0002744975927
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 0.825932502746582
Epoch: 1, Steps: 123 | Train Loss: 0.8586252 Vali Loss: 0.6157148 Best vali loss: 0.6157148
	iters: 100, epoch: 2 | loss: 0.7100185
	speed: 0.0068s/iter; left time: 5.1551s
Updating learning rate to 0.00013724879635
Epoch: 2 cost time: 0.496978759765625
Epoch: 2, Steps: 123 | Train Loss: 0.7100185 Vali Loss: 0.6184845 Best vali loss: 0.6157148
	iters: 100, epoch: 3 | loss: 0.7390158
	speed: 0.0064s/iter; left time: 4.0855s
Updating learning rate to 6.8624398175e-05
Validation loss decreased (0.6157 --> 0.6092).  Saving model state dict ...
Epoch: 3 cost time: 0.47425055503845215
Epoch: 3, Steps: 123 | Train Loss: 0.7390158 Vali Loss: 0.6092484 Best vali loss: 0.6092484

best validation loss 0.6092483761243277

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0040539091085, 'e_layers': 2, 'learning_rate': 0.000195587277, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00018814317951995778
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 0.8962457180023193
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6026776 Best vali loss: 0.6026776
Updating learning rate to 0.00016694418344025583
Validation loss decreased (0.6027 --> 0.6023).  Saving model state dict ...
Epoch: 2 cost time: 0.6053004264831543
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6022522 Best vali loss: 0.6022522
Updating learning rate to 0.0001352176437446508
Epoch: 3 cost time: 0.6054120063781738
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6070537 Best vali loss: 0.6022522

best validation loss 0.6022521599141165

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0112376031726, 'e_layers': 2, 'learning_rate': 0.0001280485842, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9402030
	speed: 0.0099s/iter; left time: 18.4564s
	iters: 200, epoch: 1 | loss: 0.7533370
	speed: 0.0037s/iter; left time: 6.5951s
Updating learning rate to 0.00012317502515471406
Validation loss decreased (inf --> 0.6662).  Saving model state dict ...
Epoch: 1 cost time: 1.2512917518615723
Epoch: 1, Steps: 245 | Train Loss: 0.8467700 Vali Loss: 0.6661994 Best vali loss: 0.6661994
	iters: 100, epoch: 2 | loss: 0.7879846
	speed: 0.0077s/iter; left time: 12.3768s
	iters: 200, epoch: 2 | loss: 0.8770115
	speed: 0.0037s/iter; left time: 5.5717s
Updating learning rate to 0.0001092963032045783
Validation loss decreased (0.6662 --> 0.6406).  Saving model state dict ...
Epoch: 2 cost time: 0.9360780715942383
Epoch: 2, Steps: 245 | Train Loss: 0.8324980 Vali Loss: 0.6406354 Best vali loss: 0.6406354
	iters: 100, epoch: 3 | loss: 0.9392708
	speed: 0.0079s/iter; left time: 10.8263s
	iters: 200, epoch: 3 | loss: 0.7372127
	speed: 0.0038s/iter; left time: 4.8540s
Updating learning rate to 8.852532795557311e-05
Validation loss decreased (0.6406 --> 0.6259).  Saving model state dict ...
Epoch: 3 cost time: 0.9627082347869873
Epoch: 3, Steps: 245 | Train Loss: 0.8382417 Vali Loss: 0.6258732 Best vali loss: 0.6258732

best validation loss 0.6258731924897264

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0040539091085, 'e_layers': 2, 'learning_rate': 0.000195587277, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 9.77936385e-05
Validation loss decreased (0.6023 --> 0.5809).  Saving model state dict ...
Epoch: 4 cost time: 0.9064836502075195
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5809406 Best vali loss: 0.5809406
Updating learning rate to 6.036963325534922e-05
Validation loss decreased (0.5809 --> 0.5589).  Saving model state dict ...
Epoch: 5 cost time: 0.6128871440887451
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5588608 Best vali loss: 0.5588608
Updating learning rate to 2.8643093559744177e-05
Epoch: 6 cost time: 0.6059930324554443
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5685077 Best vali loss: 0.5588608
Updating learning rate to 7.444097480042228e-06
Epoch: 7 cost time: 0.6142339706420898
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5614980 Best vali loss: 0.5588608
Updating learning rate to 0.0
Epoch: 8 cost time: 0.60711669921875
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5599917 Best vali loss: 0.5588608

best validation loss 0.5588607579290398

[INFO][smbo.py:320] Finished 1150 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0057657024774, 'e_layers': 1, 'learning_rate': 0.0002694879674, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8589474
	speed: 0.0101s/iter; left time: 8.9130s
Updating learning rate to 0.0002694879674
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 0.8196887969970703
Epoch: 1, Steps: 123 | Train Loss: 0.8589474 Vali Loss: 0.6153370 Best vali loss: 0.6153370
	iters: 100, epoch: 2 | loss: 0.7073255
	speed: 0.0069s/iter; left time: 5.2769s
Updating learning rate to 0.0001347439837
Epoch: 2 cost time: 0.5223066806793213
Epoch: 2, Steps: 123 | Train Loss: 0.7073255 Vali Loss: 0.6191501 Best vali loss: 0.6153370
	iters: 100, epoch: 3 | loss: 0.7394765
	speed: 0.0064s/iter; left time: 4.1085s
Updating learning rate to 6.737199185e-05
Validation loss decreased (0.6153 --> 0.6097).  Saving model state dict ...
Epoch: 3 cost time: 0.4711432456970215
Epoch: 3, Steps: 123 | Train Loss: 0.7394765 Vali Loss: 0.6097295 Best vali loss: 0.6097295
	iters: 100, epoch: 4 | loss: 0.8142024
	speed: 0.0070s/iter; left time: 3.5971s
Updating learning rate to 3.3685995925e-05
Validation loss decreased (0.6097 --> 0.6095).  Saving model state dict ...
Epoch: 4 cost time: 0.5097324848175049
Epoch: 4, Steps: 123 | Train Loss: 0.8142024 Vali Loss: 0.6094848 Best vali loss: 0.6094848
	iters: 100, epoch: 5 | loss: 0.9148765
	speed: 0.0064s/iter; left time: 2.5077s
Updating learning rate to 1.68429979625e-05
Epoch: 5 cost time: 0.4653134346008301
Epoch: 5, Steps: 123 | Train Loss: 0.9148765 Vali Loss: 0.6103279 Best vali loss: 0.6094848
	iters: 100, epoch: 6 | loss: 0.7043840
	speed: 0.0067s/iter; left time: 1.8066s
Updating learning rate to 8.42149898125e-06
Epoch: 6 cost time: 0.5071773529052734
Epoch: 6, Steps: 123 | Train Loss: 0.7043840 Vali Loss: 0.6141260 Best vali loss: 0.6094848
	iters: 100, epoch: 7 | loss: 0.6151373
	speed: 0.0066s/iter; left time: 0.9750s
Updating learning rate to 4.210749490625e-06
Epoch: 7 cost time: 0.4953608512878418
Epoch: 7, Steps: 123 | Train Loss: 0.6151373 Vali Loss: 0.6152062 Best vali loss: 0.6094848
	iters: 100, epoch: 8 | loss: 1.1472582
	speed: 0.0065s/iter; left time: 0.1554s
Updating learning rate to 2.1053747453125e-06
Epoch: 8 cost time: 0.4815785884857178
Epoch: 8, Steps: 123 | Train Loss: 1.1472582 Vali Loss: 0.6171509 Best vali loss: 0.6094848

best validation loss 0.6094847594296033

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0074512912115, 'e_layers': 2, 'learning_rate': 0.0002394225396, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8153642
	speed: 0.0096s/iter; left time: 36.7344s
	iters: 200, epoch: 1 | loss: 1.4192142
	speed: 0.0032s/iter; left time: 11.8919s
	iters: 300, epoch: 1 | loss: 0.6801845
	speed: 0.0033s/iter; left time: 11.7824s
	iters: 400, epoch: 1 | loss: 0.6618900
	speed: 0.0033s/iter; left time: 11.7232s
Updating learning rate to 0.0002394225396
Validation loss decreased (inf --> 0.6274).  Saving model state dict ...
Epoch: 1 cost time: 1.961150884628296
Epoch: 1, Steps: 490 | Train Loss: 0.8941632 Vali Loss: 0.6274123 Best vali loss: 0.6274123
	iters: 100, epoch: 2 | loss: 0.5903930
	speed: 0.0096s/iter; left time: 32.0930s
	iters: 200, epoch: 2 | loss: 0.8097487
	speed: 0.0032s/iter; left time: 10.3216s
	iters: 300, epoch: 2 | loss: 0.9953625
	speed: 0.0033s/iter; left time: 10.1796s
	iters: 400, epoch: 2 | loss: 0.6794955
	speed: 0.0034s/iter; left time: 10.2072s
Updating learning rate to 0.0001197112698
Validation loss decreased (0.6274 --> 0.6112).  Saving model state dict ...
Epoch: 2 cost time: 1.651660680770874
Epoch: 2, Steps: 490 | Train Loss: 0.7687499 Vali Loss: 0.6111551 Best vali loss: 0.6111551
	iters: 100, epoch: 3 | loss: 1.2535520
	speed: 0.0095s/iter; left time: 27.0633s
	iters: 200, epoch: 3 | loss: 0.3646404
	speed: 0.0034s/iter; left time: 9.2423s
	iters: 300, epoch: 3 | loss: 0.9750969
	speed: 0.0034s/iter; left time: 8.8534s
	iters: 400, epoch: 3 | loss: 0.5825308
	speed: 0.0034s/iter; left time: 8.6174s
Updating learning rate to 5.98556349e-05
Validation loss decreased (0.6112 --> 0.6019).  Saving model state dict ...
Epoch: 3 cost time: 1.6744000911712646
Epoch: 3, Steps: 490 | Train Loss: 0.7939550 Vali Loss: 0.6019295 Best vali loss: 0.6019295
	iters: 100, epoch: 4 | loss: 1.3577360
	speed: 0.0093s/iter; left time: 21.8400s
	iters: 200, epoch: 4 | loss: 1.0341667
	speed: 0.0032s/iter; left time: 7.2286s
	iters: 300, epoch: 4 | loss: 0.8523260
	speed: 0.0032s/iter; left time: 6.8177s
	iters: 400, epoch: 4 | loss: 0.6001468
	speed: 0.0033s/iter; left time: 6.8329s
Updating learning rate to 2.992781745e-05
Epoch: 4 cost time: 1.6466116905212402
Epoch: 4, Steps: 490 | Train Loss: 0.9610939 Vali Loss: 0.6037960 Best vali loss: 0.6019295
	iters: 100, epoch: 5 | loss: 0.8497798
	speed: 0.0098s/iter; left time: 18.2283s
	iters: 200, epoch: 5 | loss: 0.6293426
	speed: 0.0032s/iter; left time: 5.6909s
	iters: 300, epoch: 5 | loss: 1.0787507
	speed: 0.0033s/iter; left time: 5.5321s
	iters: 400, epoch: 5 | loss: 0.8068452
	speed: 0.0033s/iter; left time: 5.1631s
Updating learning rate to 1.4963908725e-05
Epoch: 5 cost time: 1.6560027599334717
Epoch: 5, Steps: 490 | Train Loss: 0.8411796 Vali Loss: 0.6020729 Best vali loss: 0.6019295
	iters: 100, epoch: 6 | loss: 1.0055902
	speed: 0.0099s/iter; left time: 13.5337s
	iters: 200, epoch: 6 | loss: 0.8538097
	speed: 0.0037s/iter; left time: 4.7112s
	iters: 300, epoch: 6 | loss: 0.7512910
	speed: 0.0037s/iter; left time: 4.3305s
	iters: 400, epoch: 6 | loss: 0.4102450
	speed: 0.0037s/iter; left time: 3.9823s
Updating learning rate to 7.4819543625e-06
Validation loss decreased (0.6019 --> 0.6016).  Saving model state dict ...
Epoch: 6 cost time: 1.868091344833374
Epoch: 6, Steps: 490 | Train Loss: 0.7552340 Vali Loss: 0.6015993 Best vali loss: 0.6015993
	iters: 100, epoch: 7 | loss: 0.6915780
	speed: 0.0099s/iter; left time: 8.6804s
	iters: 200, epoch: 7 | loss: 0.9310427
	speed: 0.0035s/iter; left time: 2.7076s
	iters: 300, epoch: 7 | loss: 0.6711491
	speed: 0.0034s/iter; left time: 2.2816s
	iters: 400, epoch: 7 | loss: 1.1208211
	speed: 0.0034s/iter; left time: 1.9712s
Updating learning rate to 3.74097718125e-06
Validation loss decreased (0.6016 --> 0.6014).  Saving model state dict ...
Epoch: 7 cost time: 1.690103530883789
Epoch: 7, Steps: 490 | Train Loss: 0.8536477 Vali Loss: 0.6014043 Best vali loss: 0.6014043
	iters: 100, epoch: 8 | loss: 0.4354347
	speed: 0.0099s/iter; left time: 3.8599s
	iters: 200, epoch: 8 | loss: 0.5321420
	speed: 0.0037s/iter; left time: 1.0687s
	iters: 300, epoch: 8 | loss: 0.5302708
	speed: 0.0035s/iter; left time: 0.6615s
	iters: 400, epoch: 8 | loss: 1.3763335
	speed: 0.0034s/iter; left time: 0.3091s
Updating learning rate to 1.870488590625e-06
Epoch: 8 cost time: 1.787977695465088
Epoch: 8, Steps: 490 | Train Loss: 0.7185452 Vali Loss: 0.6014077 Best vali loss: 0.6014043

best validation loss 0.6014042778017343

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008057873512, 'e_layers': 1, 'learning_rate': 0.0006995595244, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8571477
	speed: 0.0094s/iter; left time: 8.3183s
Updating learning rate to 0.0006995595244
Validation loss decreased (inf --> 0.6268).  Saving model state dict ...
Epoch: 1 cost time: 0.7627232074737549
Epoch: 1, Steps: 123 | Train Loss: 0.8571477 Vali Loss: 0.6267673 Best vali loss: 0.6267673
	iters: 100, epoch: 2 | loss: 0.8662463
	speed: 0.0064s/iter; left time: 4.9022s
Updating learning rate to 0.0003497797622
Validation loss decreased (0.6268 --> 0.6044).  Saving model state dict ...
Epoch: 2 cost time: 0.48896336555480957
Epoch: 2, Steps: 123 | Train Loss: 0.8662463 Vali Loss: 0.6043950 Best vali loss: 0.6043950
	iters: 100, epoch: 3 | loss: 0.9116197
	speed: 0.0065s/iter; left time: 4.1443s
Updating learning rate to 0.0001748898811
Validation loss decreased (0.6044 --> 0.6020).  Saving model state dict ...
Epoch: 3 cost time: 0.48448872566223145
Epoch: 3, Steps: 123 | Train Loss: 0.9116197 Vali Loss: 0.6020026 Best vali loss: 0.6020026

best validation loss 0.6020025825787341

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0011500000799, 'e_layers': 2, 'learning_rate': 0.0001345734909, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2467779
	speed: 0.0122s/iter; left time: 10.7793s
Updating learning rate to 0.00012945159238055196
Validation loss decreased (inf --> 0.6036).  Saving model state dict ...
Epoch: 1 cost time: 1.0772655010223389
Epoch: 1, Steps: 123 | Train Loss: 1.2467779 Vali Loss: 0.6035861 Best vali loss: 0.6035861
	iters: 100, epoch: 2 | loss: 1.0223581
	speed: 0.0096s/iter; left time: 7.3261s
Updating learning rate to 0.00011486565944166808
Epoch: 2 cost time: 0.7577917575836182
Epoch: 2, Steps: 123 | Train Loss: 1.0223581 Vali Loss: 0.6047453 Best vali loss: 0.6035861
	iters: 100, epoch: 3 | loss: 0.6964028
	speed: 0.0092s/iter; left time: 5.9097s
Updating learning rate to 9.30362681514821e-05
Validation loss decreased (0.6036 --> 0.5676).  Saving model state dict ...
Epoch: 3 cost time: 0.7506003379821777
Epoch: 3, Steps: 123 | Train Loss: 0.6964028 Vali Loss: 0.5676355 Best vali loss: 0.5676355

best validation loss 0.5676355246645828

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.008080721764, 'e_layers': 4, 'learning_rate': 0.0001440700333, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.8391327
	speed: 0.0113s/iter; left time: 43.0014s
	iters: 200, epoch: 1 | loss: 0.6795113
	speed: 0.0053s/iter; left time: 19.6680s
	iters: 300, epoch: 1 | loss: 0.6760716
	speed: 0.0052s/iter; left time: 18.9864s
	iters: 400, epoch: 1 | loss: 0.7614170
	speed: 0.0052s/iter; left time: 18.4553s
Updating learning rate to 0.0001440700333
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 2.9316980838775635
Epoch: 1, Steps: 490 | Train Loss: 0.9890331 Vali Loss: 0.6153101 Best vali loss: 0.6153101
	iters: 100, epoch: 2 | loss: 1.7581062
	speed: 0.0144s/iter; left time: 47.9889s
	iters: 200, epoch: 2 | loss: 0.8167207
	speed: 0.0052s/iter; left time: 16.7217s
	iters: 300, epoch: 2 | loss: 0.4793009
	speed: 0.0053s/iter; left time: 16.7059s
	iters: 400, epoch: 2 | loss: 0.6570736
	speed: 0.0054s/iter; left time: 16.2737s
Updating learning rate to 7.203501665e-05
Validation loss decreased (0.6153 --> 0.6093).  Saving model state dict ...
Epoch: 2 cost time: 2.648902654647827
Epoch: 2, Steps: 490 | Train Loss: 0.9278004 Vali Loss: 0.6093099 Best vali loss: 0.6093099
	iters: 100, epoch: 3 | loss: 0.8483173
	speed: 0.0139s/iter; left time: 39.6309s
	iters: 200, epoch: 3 | loss: 0.4333512
	speed: 0.0052s/iter; left time: 14.2470s
	iters: 300, epoch: 3 | loss: 1.2471421
	speed: 0.0052s/iter; left time: 13.6255s
	iters: 400, epoch: 3 | loss: 0.7027518
	speed: 0.0049s/iter; left time: 12.5775s
Updating learning rate to 3.6017508325e-05
Validation loss decreased (0.6093 --> 0.6031).  Saving model state dict ...
Epoch: 3 cost time: 2.5475902557373047
Epoch: 3, Steps: 490 | Train Loss: 0.8078906 Vali Loss: 0.6031367 Best vali loss: 0.6031367

best validation loss 0.6031367091849026

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0011500000799, 'e_layers': 2, 'learning_rate': 0.0001345734909, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0104455
	speed: 0.0123s/iter; left time: 6.3645s
Updating learning rate to 6.728674545e-05
Validation loss decreased (0.5676 --> 0.5597).  Saving model state dict ...
Epoch: 4 cost time: 1.0759518146514893
Epoch: 4, Steps: 123 | Train Loss: 1.0104455 Vali Loss: 0.5597420 Best vali loss: 0.5597420
	iters: 100, epoch: 5 | loss: 0.8448912
	speed: 0.0100s/iter; left time: 3.9145s
Updating learning rate to 4.153722274851792e-05
Epoch: 5 cost time: 0.7608942985534668
Epoch: 5, Steps: 123 | Train Loss: 0.8448912 Vali Loss: 0.5655314 Best vali loss: 0.5597420
	iters: 100, epoch: 6 | loss: 0.6694458
	speed: 0.0093s/iter; left time: 2.5011s
Updating learning rate to 1.9707831458331933e-05
Epoch: 6 cost time: 0.7556192874908447
Epoch: 6, Steps: 123 | Train Loss: 0.6694458 Vali Loss: 0.5603000 Best vali loss: 0.5597420
	iters: 100, epoch: 7 | loss: 0.8383442
	speed: 0.0095s/iter; left time: 1.4023s
Updating learning rate to 5.12189851944805e-06
Validation loss decreased (0.5597 --> 0.5541).  Saving model state dict ...
Epoch: 7 cost time: 0.7705564498901367
Epoch: 7, Steps: 123 | Train Loss: 0.8383442 Vali Loss: 0.5541002 Best vali loss: 0.5541002
	iters: 100, epoch: 8 | loss: 0.7153977
	speed: 0.0099s/iter; left time: 0.2377s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7658543586730957
Epoch: 8, Steps: 123 | Train Loss: 0.7153977 Vali Loss: 0.5558252 Best vali loss: 0.5541002

best validation loss 0.5541001715521082

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0029244034839, 'e_layers': 3, 'learning_rate': 0.0006887961012, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6589509
	speed: 0.0112s/iter; left time: 9.9419s
Updating learning rate to 0.0006625803605861265
Validation loss decreased (inf --> 0.6259).  Saving model state dict ...
Epoch: 1 cost time: 0.9825270175933838
Epoch: 1, Steps: 123 | Train Loss: 0.6589509 Vali Loss: 0.6258507 Best vali loss: 0.6258507
	iters: 100, epoch: 2 | loss: 0.7888694
	speed: 0.0088s/iter; left time: 6.7188s
Updating learning rate to 0.0005879242476066876
Validation loss decreased (0.6259 --> 0.5873).  Saving model state dict ...
Epoch: 2 cost time: 0.7051613330841064
Epoch: 2, Steps: 123 | Train Loss: 0.7888694 Vali Loss: 0.5872603 Best vali loss: 0.5872603
	iters: 100, epoch: 3 | loss: 0.5049810
	speed: 0.0091s/iter; left time: 5.8141s
Updating learning rate to 0.00047619347870345386
Validation loss decreased (0.5873 --> 0.5660).  Saving model state dict ...
Epoch: 3 cost time: 0.7140669822692871
Epoch: 3, Steps: 123 | Train Loss: 0.5049810 Vali Loss: 0.5659801 Best vali loss: 0.5659801
	iters: 100, epoch: 4 | loss: 0.8609481
	speed: 0.0088s/iter; left time: 4.5655s
Updating learning rate to 0.0003443980506
Epoch: 4 cost time: 0.7194912433624268
Epoch: 4, Steps: 123 | Train Loss: 0.8609481 Vali Loss: 0.5733646 Best vali loss: 0.5659801
	iters: 100, epoch: 5 | loss: 0.9013292
	speed: 0.0090s/iter; left time: 3.5514s
Updating learning rate to 0.00021260262249654614
Validation loss decreased (0.5660 --> 0.5450).  Saving model state dict ...
Epoch: 5 cost time: 0.7412436008453369
Epoch: 5, Steps: 123 | Train Loss: 0.9013292 Vali Loss: 0.5449831 Best vali loss: 0.5449831
	iters: 100, epoch: 6 | loss: 0.4801471
	speed: 0.0089s/iter; left time: 2.3971s
Updating learning rate to 0.00010087185359331229
Epoch: 6 cost time: 0.699040412902832
Epoch: 6, Steps: 123 | Train Loss: 0.4801471 Vali Loss: 0.5671024 Best vali loss: 0.5449831
	iters: 100, epoch: 7 | loss: 0.4751813
	speed: 0.0084s/iter; left time: 1.2390s
Updating learning rate to 2.6215740613873525e-05
Epoch: 7 cost time: 0.676220178604126
Epoch: 7, Steps: 123 | Train Loss: 0.4751813 Vali Loss: 0.5702812 Best vali loss: 0.5449831
	iters: 100, epoch: 8 | loss: 0.6995386
	speed: 0.0087s/iter; left time: 0.2094s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7198600769042969
Epoch: 8, Steps: 123 | Train Loss: 0.6995386 Vali Loss: 0.5798371 Best vali loss: 0.5449831

best validation loss 0.5449830613054649

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0031278583467, 'e_layers': 3, 'learning_rate': 0.0021478589259, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9751632
	speed: 0.0107s/iter; left time: 19.9048s
	iters: 200, epoch: 1 | loss: 0.6429869
	speed: 0.0049s/iter; left time: 8.6136s
Updating learning rate to 0.0021478589259
Validation loss decreased (inf --> 0.6294).  Saving model state dict ...
Epoch: 1 cost time: 1.5192644596099854
Epoch: 1, Steps: 245 | Train Loss: 0.8090750 Vali Loss: 0.6294316 Best vali loss: 0.6294316
	iters: 100, epoch: 2 | loss: 1.0710407
	speed: 0.0095s/iter; left time: 15.3762s
	iters: 200, epoch: 2 | loss: 0.6976953
	speed: 0.0047s/iter; left time: 7.1826s
Updating learning rate to 0.00107392946295
Validation loss decreased (0.6294 --> 0.6177).  Saving model state dict ...
Epoch: 2 cost time: 1.205925464630127
Epoch: 2, Steps: 245 | Train Loss: 0.8843680 Vali Loss: 0.6176558 Best vali loss: 0.6176558
	iters: 100, epoch: 3 | loss: 1.3540410
	speed: 0.0092s/iter; left time: 12.6162s
	iters: 200, epoch: 3 | loss: 0.8272792
	speed: 0.0049s/iter; left time: 6.2500s
Updating learning rate to 0.000536964731475
Epoch: 3 cost time: 1.2298531532287598
Epoch: 3, Steps: 245 | Train Loss: 1.0906601 Vali Loss: 0.6235927 Best vali loss: 0.6176558
	iters: 100, epoch: 4 | loss: 0.9085362
	speed: 0.0095s/iter; left time: 10.6585s
	iters: 200, epoch: 4 | loss: 0.5028698
	speed: 0.0049s/iter; left time: 5.0197s
Updating learning rate to 0.0002684823657375
Validation loss decreased (0.6177 --> 0.6138).  Saving model state dict ...
Epoch: 4 cost time: 1.2275035381317139
Epoch: 4, Steps: 245 | Train Loss: 0.7057030 Vali Loss: 0.6137723 Best vali loss: 0.6137723
	iters: 100, epoch: 5 | loss: 1.3017936
	speed: 0.0093s/iter; left time: 8.2259s
	iters: 200, epoch: 5 | loss: 0.7976884
	speed: 0.0044s/iter; left time: 3.4647s
Updating learning rate to 0.00013424118286875
Epoch: 5 cost time: 1.1611881256103516
Epoch: 5, Steps: 245 | Train Loss: 1.0497410 Vali Loss: 0.6212711 Best vali loss: 0.6137723
	iters: 100, epoch: 6 | loss: 0.9558169
	speed: 0.0094s/iter; left time: 5.9652s
	iters: 200, epoch: 6 | loss: 0.9496105
	speed: 0.0048s/iter; left time: 2.5773s
Updating learning rate to 6.7120591434375e-05
Epoch: 6 cost time: 1.2097296714782715
Epoch: 6, Steps: 245 | Train Loss: 0.9527137 Vali Loss: 0.6141231 Best vali loss: 0.6137723
	iters: 100, epoch: 7 | loss: 0.6804529
	speed: 0.0092s/iter; left time: 3.5873s
	iters: 200, epoch: 7 | loss: 0.5781433
	speed: 0.0044s/iter; left time: 1.2771s
Updating learning rate to 3.35602957171875e-05
Validation loss decreased (0.6138 --> 0.6132).  Saving model state dict ...
Epoch: 7 cost time: 1.1264610290527344
Epoch: 7, Steps: 245 | Train Loss: 0.6292981 Vali Loss: 0.6132394 Best vali loss: 0.6132394
	iters: 100, epoch: 8 | loss: 0.6499460
	speed: 0.0093s/iter; left time: 1.3618s
	iters: 200, epoch: 8 | loss: 0.4735549
	speed: 0.0047s/iter; left time: 0.2162s
Updating learning rate to 1.678014785859375e-05
Epoch: 8 cost time: 1.2030322551727295
Epoch: 8, Steps: 245 | Train Loss: 0.5617505 Vali Loss: 0.6161439 Best vali loss: 0.6132394

best validation loss 0.6132393985752262

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010649025009, 'e_layers': 3, 'learning_rate': 9.0026233e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.659981352889609e-05
Validation loss decreased (inf --> 0.6130).  Saving model state dict ...
Epoch: 1 cost time: 1.0355408191680908
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6129868 Best vali loss: 0.6129868
Updating learning rate to 7.684219641949007e-05
Validation loss decreased (0.6130 --> 0.6005).  Saving model state dict ...
Epoch: 2 cost time: 0.7259628772735596
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6004657 Best vali loss: 0.6004657
Updating learning rate to 6.223889042366966e-05
Epoch: 3 cost time: 0.7304205894470215
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6059314 Best vali loss: 0.6004657

best validation loss 0.6004656926176715

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0062098824687, 'e_layers': 3, 'learning_rate': 0.0004066338051, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8946423
	speed: 0.0112s/iter; left time: 9.9125s
Updating learning rate to 0.0004066338051
Validation loss decreased (inf --> 0.6373).  Saving model state dict ...
Epoch: 1 cost time: 0.9780979156494141
Epoch: 1, Steps: 123 | Train Loss: 0.8946423 Vali Loss: 0.6372816 Best vali loss: 0.6372816
	iters: 100, epoch: 2 | loss: 0.7675564
	speed: 0.0089s/iter; left time: 6.7827s
Updating learning rate to 0.00020331690255
Validation loss decreased (0.6373 --> 0.6174).  Saving model state dict ...
Epoch: 2 cost time: 0.7454097270965576
Epoch: 2, Steps: 123 | Train Loss: 0.7675564 Vali Loss: 0.6173890 Best vali loss: 0.6173890
	iters: 100, epoch: 3 | loss: 0.5766909
	speed: 0.0086s/iter; left time: 5.5019s
Updating learning rate to 0.000101658451275
Validation loss decreased (0.6174 --> 0.6100).  Saving model state dict ...
Epoch: 3 cost time: 0.6791727542877197
Epoch: 3, Steps: 123 | Train Loss: 0.5766909 Vali Loss: 0.6099921 Best vali loss: 0.6099921

best validation loss 0.6099921039606012

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010229890521, 'e_layers': 4, 'learning_rate': 5.95902128e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8487849
	speed: 0.0114s/iter; left time: 88.3697s
	iters: 200, epoch: 1 | loss: 0.7620327
	speed: 0.0053s/iter; left time: 40.2755s
	iters: 300, epoch: 1 | loss: 0.6002069
	speed: 0.0053s/iter; left time: 39.7522s
	iters: 400, epoch: 1 | loss: 0.3876049
	speed: 0.0050s/iter; left time: 37.0404s
	iters: 500, epoch: 1 | loss: 0.5367362
	speed: 0.0050s/iter; left time: 36.7968s
	iters: 600, epoch: 1 | loss: 0.7088418
	speed: 0.0049s/iter; left time: 35.6603s
	iters: 700, epoch: 1 | loss: 1.1262101
	speed: 0.0049s/iter; left time: 35.1979s
	iters: 800, epoch: 1 | loss: 0.4015053
	speed: 0.0050s/iter; left time: 34.8398s
	iters: 900, epoch: 1 | loss: 0.3534612
	speed: 0.0050s/iter; left time: 34.5549s
Updating learning rate to 5.95902128e-05
Validation loss decreased (inf --> 0.6043).  Saving model state dict ...
Epoch: 1 cost time: 5.2965404987335205
Epoch: 1, Steps: 979 | Train Loss: 0.6361538 Vali Loss: 0.6042995 Best vali loss: 0.6042995
	iters: 100, epoch: 2 | loss: 0.4402241
	speed: 0.0156s/iter; left time: 105.4369s
	iters: 200, epoch: 2 | loss: 0.7925590
	speed: 0.0053s/iter; left time: 34.9967s
	iters: 300, epoch: 2 | loss: 0.5091109
	speed: 0.0048s/iter; left time: 31.3288s
	iters: 400, epoch: 2 | loss: 0.8090695
	speed: 0.0046s/iter; left time: 29.8979s
	iters: 500, epoch: 2 | loss: 0.5293883
	speed: 0.0050s/iter; left time: 31.7376s
	iters: 600, epoch: 2 | loss: 0.2906253
	speed: 0.0053s/iter; left time: 32.9960s
	iters: 700, epoch: 2 | loss: 0.9191753
	speed: 0.0052s/iter; left time: 31.8845s
	iters: 800, epoch: 2 | loss: 0.2682115
	speed: 0.0052s/iter; left time: 31.5812s
	iters: 900, epoch: 2 | loss: 0.8485491
	speed: 0.0053s/iter; left time: 31.3276s
Updating learning rate to 2.97951064e-05
Validation loss decreased (0.6043 --> 0.5481).  Saving model state dict ...
Epoch: 2 cost time: 5.043844938278198
Epoch: 2, Steps: 979 | Train Loss: 0.6007681 Vali Loss: 0.5480664 Best vali loss: 0.5480664
	iters: 100, epoch: 3 | loss: 0.4893150
	speed: 0.0160s/iter; left time: 92.3151s
	iters: 200, epoch: 3 | loss: 0.2437853
	speed: 0.0049s/iter; left time: 27.7055s
	iters: 300, epoch: 3 | loss: 0.7413872
	speed: 0.0048s/iter; left time: 26.5977s
	iters: 400, epoch: 3 | loss: 0.4898763
	speed: 0.0048s/iter; left time: 26.3249s
	iters: 500, epoch: 3 | loss: 0.7414510
	speed: 0.0049s/iter; left time: 26.2609s
	iters: 600, epoch: 3 | loss: 0.7669980
	speed: 0.0049s/iter; left time: 25.6579s
	iters: 700, epoch: 3 | loss: 0.9442676
	speed: 0.0048s/iter; left time: 24.9389s
	iters: 800, epoch: 3 | loss: 0.9839660
	speed: 0.0050s/iter; left time: 25.4058s
	iters: 900, epoch: 3 | loss: 0.7802736
	speed: 0.0050s/iter; left time: 24.7266s
Updating learning rate to 1.48975532e-05
Validation loss decreased (0.5481 --> 0.5439).  Saving model state dict ...
Epoch: 3 cost time: 4.840038299560547
Epoch: 3, Steps: 979 | Train Loss: 0.6868133 Vali Loss: 0.5438535 Best vali loss: 0.5438535

best validation loss 0.5438535053495013

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010229890521, 'e_layers': 4, 'learning_rate': 5.95902128e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7282251
	speed: 0.0118s/iter; left time: 56.7003s
	iters: 200, epoch: 4 | loss: 0.6266990
	speed: 0.0053s/iter; left time: 24.8499s
	iters: 300, epoch: 4 | loss: 0.6144590
	speed: 0.0053s/iter; left time: 24.2822s
	iters: 400, epoch: 4 | loss: 0.3813746
	speed: 0.0053s/iter; left time: 23.9185s
	iters: 500, epoch: 4 | loss: 0.4942388
	speed: 0.0052s/iter; left time: 23.0594s
	iters: 600, epoch: 4 | loss: 0.4603017
	speed: 0.0050s/iter; left time: 21.4818s
	iters: 700, epoch: 4 | loss: 1.0671005
	speed: 0.0050s/iter; left time: 21.0301s
	iters: 800, epoch: 4 | loss: 0.2876729
	speed: 0.0048s/iter; left time: 19.7116s
	iters: 900, epoch: 4 | loss: 0.2958559
	speed: 0.0047s/iter; left time: 18.7567s
Updating learning rate to 7.4487766e-06
Validation loss decreased (0.5439 --> 0.5397).  Saving model state dict ...
Epoch: 4 cost time: 5.32682466506958
Epoch: 4, Steps: 979 | Train Loss: 0.5506586 Vali Loss: 0.5397322 Best vali loss: 0.5397322
	iters: 100, epoch: 5 | loss: 0.4223332
	speed: 0.0161s/iter; left time: 61.4425s
	iters: 200, epoch: 5 | loss: 0.6890914
	speed: 0.0050s/iter; left time: 18.4610s
	iters: 300, epoch: 5 | loss: 0.4752326
	speed: 0.0050s/iter; left time: 17.9205s
	iters: 400, epoch: 5 | loss: 0.7706965
	speed: 0.0049s/iter; left time: 17.0940s
	iters: 500, epoch: 5 | loss: 0.5316837
	speed: 0.0048s/iter; left time: 16.4674s
	iters: 600, epoch: 5 | loss: 0.2464552
	speed: 0.0049s/iter; left time: 16.3365s
	iters: 700, epoch: 5 | loss: 0.8363431
	speed: 0.0049s/iter; left time: 15.7786s
	iters: 800, epoch: 5 | loss: 0.2741420
	speed: 0.0049s/iter; left time: 15.3239s
	iters: 900, epoch: 5 | loss: 0.8248643
	speed: 0.0050s/iter; left time: 15.1002s
Updating learning rate to 3.7243883e-06
Validation loss decreased (0.5397 --> 0.5382).  Saving model state dict ...
Epoch: 5 cost time: 4.867364406585693
Epoch: 5, Steps: 979 | Train Loss: 0.5634269 Vali Loss: 0.5382098 Best vali loss: 0.5382098
	iters: 100, epoch: 6 | loss: 0.4100019
	speed: 0.0156s/iter; left time: 44.3742s
	iters: 200, epoch: 6 | loss: 0.2128168
	speed: 0.0052s/iter; left time: 14.2605s
	iters: 300, epoch: 6 | loss: 0.7215461
	speed: 0.0052s/iter; left time: 13.6304s
	iters: 400, epoch: 6 | loss: 0.4842639
	speed: 0.0049s/iter; left time: 12.3359s
	iters: 500, epoch: 6 | loss: 0.6495255
	speed: 0.0048s/iter; left time: 11.8213s
	iters: 600, epoch: 6 | loss: 0.7157639
	speed: 0.0049s/iter; left time: 11.3920s
	iters: 700, epoch: 6 | loss: 0.8891608
	speed: 0.0049s/iter; left time: 10.9024s
	iters: 800, epoch: 6 | loss: 0.9171511
	speed: 0.0049s/iter; left time: 10.5073s
	iters: 900, epoch: 6 | loss: 0.7731698
	speed: 0.0052s/iter; left time: 10.6179s
Updating learning rate to 1.86219415e-06
Validation loss decreased (0.5382 --> 0.5381).  Saving model state dict ...
Epoch: 6 cost time: 4.956855773925781
Epoch: 6, Steps: 979 | Train Loss: 0.6414889 Vali Loss: 0.5380965 Best vali loss: 0.5380965
	iters: 100, epoch: 7 | loss: 0.3081443
	speed: 0.0155s/iter; left time: 28.8211s
	iters: 200, epoch: 7 | loss: 0.5784190
	speed: 0.0050s/iter; left time: 8.7920s
	iters: 300, epoch: 7 | loss: 0.2617051
	speed: 0.0047s/iter; left time: 7.7251s
	iters: 400, epoch: 7 | loss: 1.0049980
	speed: 0.0046s/iter; left time: 7.1195s
	iters: 500, epoch: 7 | loss: 0.5322101
	speed: 0.0047s/iter; left time: 6.8510s
	iters: 600, epoch: 7 | loss: 0.2891685
	speed: 0.0048s/iter; left time: 6.5484s
	iters: 700, epoch: 7 | loss: 0.9170619
	speed: 0.0049s/iter; left time: 6.1381s
	iters: 800, epoch: 7 | loss: 0.7250978
	speed: 0.0048s/iter; left time: 5.5798s
	iters: 900, epoch: 7 | loss: 0.3104478
	speed: 0.0048s/iter; left time: 5.0505s
Updating learning rate to 9.31097075e-07
Validation loss decreased (0.5381 --> 0.5355).  Saving model state dict ...
Epoch: 7 cost time: 4.749927520751953
Epoch: 7, Steps: 979 | Train Loss: 0.5474725 Vali Loss: 0.5354534 Best vali loss: 0.5354534
	iters: 100, epoch: 8 | loss: 0.9034139
	speed: 0.0155s/iter; left time: 13.6831s
	iters: 200, epoch: 8 | loss: 0.7749392
	speed: 0.0049s/iter; left time: 3.8079s
	iters: 300, epoch: 8 | loss: 1.0479981
	speed: 0.0047s/iter; left time: 3.1781s
	iters: 400, epoch: 8 | loss: 0.3969590
	speed: 0.0048s/iter; left time: 2.7728s
	iters: 500, epoch: 8 | loss: 0.6522961
	speed: 0.0048s/iter; left time: 2.2969s
	iters: 600, epoch: 8 | loss: 0.9003550
	speed: 0.0047s/iter; left time: 1.7950s
	iters: 700, epoch: 8 | loss: 0.7562026
	speed: 0.0047s/iter; left time: 1.3234s
	iters: 800, epoch: 8 | loss: 0.3338395
	speed: 0.0049s/iter; left time: 0.8834s
	iters: 900, epoch: 8 | loss: 1.3847705
	speed: 0.0047s/iter; left time: 0.3769s
Updating learning rate to 4.655485375e-07
Epoch: 8 cost time: 4.747055530548096
Epoch: 8, Steps: 979 | Train Loss: 0.7945304 Vali Loss: 0.5355376 Best vali loss: 0.5354534

best validation loss 0.5354534235818692

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027525266442, 'e_layers': 4, 'learning_rate': 0.0001227220684, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5717587
	speed: 0.0115s/iter; left time: 43.9575s
	iters: 200, epoch: 1 | loss: 1.2328575
	speed: 0.0055s/iter; left time: 20.3685s
	iters: 300, epoch: 1 | loss: 0.6371220
	speed: 0.0055s/iter; left time: 20.0702s
	iters: 400, epoch: 1 | loss: 0.8749256
	speed: 0.0056s/iter; left time: 19.7143s
Updating learning rate to 0.0001227220684
Validation loss decreased (inf --> 0.6099).  Saving model state dict ...
Epoch: 1 cost time: 3.0343029499053955
Epoch: 1, Steps: 490 | Train Loss: 0.8291660 Vali Loss: 0.6099442 Best vali loss: 0.6099442
	iters: 100, epoch: 2 | loss: 0.6257933
	speed: 0.0145s/iter; left time: 48.3697s
	iters: 200, epoch: 2 | loss: 0.7120330
	speed: 0.0056s/iter; left time: 18.0080s
	iters: 300, epoch: 2 | loss: 0.5698072
	speed: 0.0055s/iter; left time: 17.1474s
	iters: 400, epoch: 2 | loss: 0.6989973
	speed: 0.0055s/iter; left time: 16.7602s
Updating learning rate to 6.13610342e-05
Validation loss decreased (0.6099 --> 0.5966).  Saving model state dict ...
Epoch: 2 cost time: 2.7457807064056396
Epoch: 2, Steps: 490 | Train Loss: 0.6516577 Vali Loss: 0.5966287 Best vali loss: 0.5966287
	iters: 100, epoch: 3 | loss: 0.8651035
	speed: 0.0144s/iter; left time: 40.7711s
	iters: 200, epoch: 3 | loss: 0.7143207
	speed: 0.0052s/iter; left time: 14.3700s
	iters: 300, epoch: 3 | loss: 1.0579900
	speed: 0.0046s/iter; left time: 12.1573s
	iters: 400, epoch: 3 | loss: 0.5242260
	speed: 0.0047s/iter; left time: 11.9764s
Updating learning rate to 3.06805171e-05
Validation loss decreased (0.5966 --> 0.5962).  Saving model state dict ...
Epoch: 3 cost time: 2.4674956798553467
Epoch: 3, Steps: 490 | Train Loss: 0.7904100 Vali Loss: 0.5962312 Best vali loss: 0.5962312
	iters: 100, epoch: 4 | loss: 0.6627724
	speed: 0.0131s/iter; left time: 30.7560s
	iters: 200, epoch: 4 | loss: 0.9327195
	speed: 0.0048s/iter; left time: 10.8453s
	iters: 300, epoch: 4 | loss: 0.7009502
	speed: 0.0050s/iter; left time: 10.6546s
	iters: 400, epoch: 4 | loss: 0.5151274
	speed: 0.0050s/iter; left time: 10.1842s
Updating learning rate to 1.534025855e-05
Validation loss decreased (0.5962 --> 0.5890).  Saving model state dict ...
Epoch: 4 cost time: 2.436209201812744
Epoch: 4, Steps: 490 | Train Loss: 0.7028924 Vali Loss: 0.5889958 Best vali loss: 0.5889958
	iters: 100, epoch: 5 | loss: 1.1793377
	speed: 0.0131s/iter; left time: 24.3970s
	iters: 200, epoch: 5 | loss: 0.8619336
	speed: 0.0050s/iter; left time: 8.7748s
	iters: 300, epoch: 5 | loss: 0.7541586
	speed: 0.0049s/iter; left time: 8.2208s
	iters: 400, epoch: 5 | loss: 0.4813766
	speed: 0.0049s/iter; left time: 7.7030s
Updating learning rate to 7.670129275e-06
Epoch: 5 cost time: 2.4624204635620117
Epoch: 5, Steps: 490 | Train Loss: 0.8192016 Vali Loss: 0.5898915 Best vali loss: 0.5889958
	iters: 100, epoch: 6 | loss: 0.7806234
	speed: 0.0131s/iter; left time: 17.9991s
	iters: 200, epoch: 6 | loss: 0.5809345
	speed: 0.0050s/iter; left time: 6.3453s
	iters: 300, epoch: 6 | loss: 0.5777423
	speed: 0.0052s/iter; left time: 6.0631s
	iters: 400, epoch: 6 | loss: 0.6079333
	speed: 0.0053s/iter; left time: 5.6777s
Updating learning rate to 3.8350646375e-06
Validation loss decreased (0.5890 --> 0.5801).  Saving model state dict ...
Epoch: 6 cost time: 2.5596394538879395
Epoch: 6, Steps: 490 | Train Loss: 0.6368084 Vali Loss: 0.5800582 Best vali loss: 0.5800582
	iters: 100, epoch: 7 | loss: 1.1321377
	speed: 0.0141s/iter; left time: 12.4072s
	iters: 200, epoch: 7 | loss: 1.0893987
	speed: 0.0052s/iter; left time: 4.0535s
	iters: 300, epoch: 7 | loss: 0.7332367
	speed: 0.0051s/iter; left time: 3.5055s
	iters: 400, epoch: 7 | loss: 1.0930722
	speed: 0.0051s/iter; left time: 2.9513s
Updating learning rate to 1.91753231875e-06
Validation loss decreased (0.5801 --> 0.5784).  Saving model state dict ...
Epoch: 7 cost time: 2.5660688877105713
Epoch: 7, Steps: 490 | Train Loss: 1.0119613 Vali Loss: 0.5783602 Best vali loss: 0.5783602
	iters: 100, epoch: 8 | loss: 0.8210614
	speed: 0.0135s/iter; left time: 5.2702s
	iters: 200, epoch: 8 | loss: 1.2528057
	speed: 0.0052s/iter; left time: 1.5136s
	iters: 300, epoch: 8 | loss: 0.7196202
	speed: 0.0051s/iter; left time: 0.9737s
	iters: 400, epoch: 8 | loss: 0.9138483
	speed: 0.0049s/iter; left time: 0.4480s
Updating learning rate to 9.58766159375e-07
Validation loss decreased (0.5784 --> 0.5780).  Saving model state dict ...
Epoch: 8 cost time: 2.5132033824920654
Epoch: 8, Steps: 490 | Train Loss: 0.9268339 Vali Loss: 0.5780487 Best vali loss: 0.5780487

best validation loss 0.5780487106332951

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0090857864092, 'e_layers': 4, 'learning_rate': 8.68534506e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7964718
	speed: 0.0128s/iter; left time: 23.8055s
	iters: 200, epoch: 1 | loss: 0.7316440
	speed: 0.0066s/iter; left time: 11.6068s
Updating learning rate to 8.68534506e-05
Validation loss decreased (inf --> 0.6018).  Saving model state dict ...
Epoch: 1 cost time: 1.9666671752929688
Epoch: 1, Steps: 245 | Train Loss: 0.7640579 Vali Loss: 0.6017935 Best vali loss: 0.6017935
	iters: 100, epoch: 2 | loss: 1.0551927
	speed: 0.0130s/iter; left time: 20.9787s
	iters: 200, epoch: 2 | loss: 1.0331331
	speed: 0.0066s/iter; left time: 10.0271s
Updating learning rate to 4.34267253e-05
Validation loss decreased (0.6018 --> 0.5586).  Saving model state dict ...
Epoch: 2 cost time: 1.6586508750915527
Epoch: 2, Steps: 245 | Train Loss: 1.0441629 Vali Loss: 0.5585672 Best vali loss: 0.5585672
	iters: 100, epoch: 3 | loss: 0.5537124
	speed: 0.0132s/iter; left time: 18.1408s
	iters: 200, epoch: 3 | loss: 0.7689848
	speed: 0.0066s/iter; left time: 8.3305s
Updating learning rate to 2.171336265e-05
Validation loss decreased (0.5586 --> 0.5571).  Saving model state dict ...
Epoch: 3 cost time: 1.6480748653411865
Epoch: 3, Steps: 245 | Train Loss: 0.6613486 Vali Loss: 0.5571433 Best vali loss: 0.5571433
	iters: 100, epoch: 4 | loss: 0.4619475
	speed: 0.0130s/iter; left time: 14.6800s
	iters: 200, epoch: 4 | loss: 0.6181590
	speed: 0.0065s/iter; left time: 6.7016s
Updating learning rate to 1.0856681325e-05
Validation loss decreased (0.5571 --> 0.5476).  Saving model state dict ...
Epoch: 4 cost time: 1.6374249458312988
Epoch: 4, Steps: 245 | Train Loss: 0.5400532 Vali Loss: 0.5475592 Best vali loss: 0.5475592
	iters: 100, epoch: 5 | loss: 0.5466437
	speed: 0.0132s/iter; left time: 11.5887s
	iters: 200, epoch: 5 | loss: 0.8468736
	speed: 0.0067s/iter; left time: 5.2342s
Updating learning rate to 5.4283406625e-06
Validation loss decreased (0.5476 --> 0.5453).  Saving model state dict ...
Epoch: 5 cost time: 1.6733384132385254
Epoch: 5, Steps: 245 | Train Loss: 0.6967587 Vali Loss: 0.5453049 Best vali loss: 0.5453049
	iters: 100, epoch: 6 | loss: 0.5456553
	speed: 0.0131s/iter; left time: 8.3599s
	iters: 200, epoch: 6 | loss: 0.7940521
	speed: 0.0066s/iter; left time: 3.5375s
Updating learning rate to 2.71417033125e-06
Validation loss decreased (0.5453 --> 0.5445).  Saving model state dict ...
Epoch: 6 cost time: 1.6420209407806396
Epoch: 6, Steps: 245 | Train Loss: 0.6698537 Vali Loss: 0.5444567 Best vali loss: 0.5444567
	iters: 100, epoch: 7 | loss: 1.1117740
	speed: 0.0131s/iter; left time: 5.1348s
	iters: 200, epoch: 7 | loss: 0.8703429
	speed: 0.0066s/iter; left time: 1.9216s
Updating learning rate to 1.357085165625e-06
Epoch: 7 cost time: 1.6547467708587646
Epoch: 7, Steps: 245 | Train Loss: 0.9910584 Vali Loss: 0.5444688 Best vali loss: 0.5444567
	iters: 100, epoch: 8 | loss: 0.6427343
	speed: 0.0126s/iter; left time: 1.8392s
	iters: 200, epoch: 8 | loss: 0.5065127
	speed: 0.0065s/iter; left time: 0.2999s
Updating learning rate to 6.785425828125e-07
Validation loss decreased (0.5445 --> 0.5434).  Saving model state dict ...
Epoch: 8 cost time: 1.6415517330169678
Epoch: 8, Steps: 245 | Train Loss: 0.5746235 Vali Loss: 0.5433626 Best vali loss: 0.5433626

best validation loss 0.5433626379309182

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009680821743, 'e_layers': 4, 'learning_rate': 0.0002830114266, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002830114266
Validation loss decreased (inf --> 0.5899).  Saving model state dict ...
Epoch: 1 cost time: 1.3682641983032227
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5898602 Best vali loss: 0.5898602
Updating learning rate to 0.0001415057133
Validation loss decreased (0.5899 --> 0.5815).  Saving model state dict ...
Epoch: 2 cost time: 1.0748906135559082
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5814689 Best vali loss: 0.5814689
Updating learning rate to 7.075285665e-05
Validation loss decreased (0.5815 --> 0.5491).  Saving model state dict ...
Epoch: 3 cost time: 1.0745553970336914
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5490853 Best vali loss: 0.5490853

best validation loss 0.5490853212211817

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013078610924, 'e_layers': 3, 'learning_rate': 0.0001531260393, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6231138
	speed: 0.0140s/iter; left time: 12.3759s
Updating learning rate to 0.0001531260393
Validation loss decreased (inf --> 0.5945).  Saving model state dict ...
Epoch: 1 cost time: 1.2964496612548828
Epoch: 1, Steps: 123 | Train Loss: 0.6231138 Vali Loss: 0.5945414 Best vali loss: 0.5945414
	iters: 100, epoch: 2 | loss: 0.7118470
	speed: 0.0123s/iter; left time: 9.3406s
Updating learning rate to 7.656301965e-05
Validation loss decreased (0.5945 --> 0.5615).  Saving model state dict ...
Epoch: 2 cost time: 0.9947779178619385
Epoch: 2, Steps: 123 | Train Loss: 0.7118470 Vali Loss: 0.5615289 Best vali loss: 0.5615289
	iters: 100, epoch: 3 | loss: 0.6322451
	speed: 0.0125s/iter; left time: 7.9634s
Updating learning rate to 3.8281509825e-05
Epoch: 3 cost time: 0.9953246116638184
Epoch: 3, Steps: 123 | Train Loss: 0.6322451 Vali Loss: 0.5695539 Best vali loss: 0.5615289

best validation loss 0.5615289460062595

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008668566123, 'e_layers': 4, 'learning_rate': 0.0001027051103, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7787962
	speed: 0.0118s/iter; left time: 21.8743s
	iters: 200, epoch: 1 | loss: 0.9222753
	speed: 0.0055s/iter; left time: 9.6343s
Updating learning rate to 0.0001027051103
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 1.6955153942108154
Epoch: 1, Steps: 245 | Train Loss: 0.8505358 Vali Loss: 0.6012132 Best vali loss: 0.6012132
	iters: 100, epoch: 2 | loss: 1.1548133
	speed: 0.0112s/iter; left time: 18.1106s
	iters: 200, epoch: 2 | loss: 0.9414820
	speed: 0.0058s/iter; left time: 8.8270s
Updating learning rate to 5.135255515e-05
Epoch: 2 cost time: 1.4751145839691162
Epoch: 2, Steps: 245 | Train Loss: 1.0481476 Vali Loss: 0.6035647 Best vali loss: 0.6012132
	iters: 100, epoch: 3 | loss: 0.7093723
	speed: 0.0108s/iter; left time: 14.8374s
	iters: 200, epoch: 3 | loss: 0.7487517
	speed: 0.0051s/iter; left time: 6.4976s
Updating learning rate to 2.5676277575e-05
Validation loss decreased (0.6012 --> 0.5551).  Saving model state dict ...
Epoch: 3 cost time: 1.351938009262085
Epoch: 3, Steps: 245 | Train Loss: 0.7290620 Vali Loss: 0.5551470 Best vali loss: 0.5551470

best validation loss 0.5551469655623871

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009680821743, 'e_layers': 4, 'learning_rate': 0.0002830114266, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.5376428325e-05
Validation loss decreased (0.5491 --> 0.5470).  Saving model state dict ...
Epoch: 4 cost time: 1.387953281402588
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5469619 Best vali loss: 0.5469619
Updating learning rate to 1.76882141625e-05
Validation loss decreased (0.5470 --> 0.5441).  Saving model state dict ...
Epoch: 5 cost time: 1.0854346752166748
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5441097 Best vali loss: 0.5441097
Updating learning rate to 8.84410708125e-06
Validation loss decreased (0.5441 --> 0.5429).  Saving model state dict ...
Epoch: 6 cost time: 1.0853686332702637
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5428933 Best vali loss: 0.5428933
Updating learning rate to 4.422053540625e-06
Validation loss decreased (0.5429 --> 0.5426).  Saving model state dict ...
Epoch: 7 cost time: 1.077709674835205
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5426046 Best vali loss: 0.5426046
Updating learning rate to 2.2110267703125e-06
Epoch: 8 cost time: 1.085923433303833
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5426649 Best vali loss: 0.5426046

best validation loss 0.5426045961398761

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008783241881, 'e_layers': 3, 'learning_rate': 0.0001014797593, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5213634
	speed: 0.0118s/iter; left time: 21.9299s
	iters: 200, epoch: 1 | loss: 0.6076996
	speed: 0.0056s/iter; left time: 9.8729s
Updating learning rate to 0.0001014797593
Validation loss decreased (inf --> 0.5979).  Saving model state dict ...
Epoch: 1 cost time: 1.7203643321990967
Epoch: 1, Steps: 245 | Train Loss: 0.5645315 Vali Loss: 0.5979198 Best vali loss: 0.5979198
	iters: 100, epoch: 2 | loss: 0.6725690
	speed: 0.0114s/iter; left time: 18.4853s
	iters: 200, epoch: 2 | loss: 0.9377446
	speed: 0.0056s/iter; left time: 8.4875s
Updating learning rate to 5.073987965e-05
Validation loss decreased (0.5979 --> 0.5558).  Saving model state dict ...
Epoch: 2 cost time: 1.4224655628204346
Epoch: 2, Steps: 245 | Train Loss: 0.8051568 Vali Loss: 0.5558041 Best vali loss: 0.5558041
	iters: 100, epoch: 3 | loss: 0.6778267
	speed: 0.0117s/iter; left time: 16.0494s
	iters: 200, epoch: 3 | loss: 0.6416870
	speed: 0.0056s/iter; left time: 7.1688s
Updating learning rate to 2.5369939825e-05
Validation loss decreased (0.5558 --> 0.5434).  Saving model state dict ...
Epoch: 3 cost time: 1.427668571472168
Epoch: 3, Steps: 245 | Train Loss: 0.6597569 Vali Loss: 0.5434482 Best vali loss: 0.5434482
	iters: 100, epoch: 4 | loss: 0.7963966
	speed: 0.0116s/iter; left time: 13.0913s
	iters: 200, epoch: 4 | loss: 0.9109594
	speed: 0.0056s/iter; left time: 5.7353s
Updating learning rate to 1.26849699125e-05
Epoch: 4 cost time: 1.4156413078308105
Epoch: 4, Steps: 245 | Train Loss: 0.8536780 Vali Loss: 0.5449967 Best vali loss: 0.5434482
	iters: 100, epoch: 5 | loss: 0.7076728
	speed: 0.0111s/iter; left time: 9.7821s
	iters: 200, epoch: 5 | loss: 0.7405853
	speed: 0.0056s/iter; left time: 4.3829s
Updating learning rate to 6.34248495625e-06
Validation loss decreased (0.5434 --> 0.5415).  Saving model state dict ...
Epoch: 5 cost time: 1.4134550094604492
Epoch: 5, Steps: 245 | Train Loss: 0.7241291 Vali Loss: 0.5414558 Best vali loss: 0.5414558
	iters: 100, epoch: 6 | loss: 0.5935528
	speed: 0.0117s/iter; left time: 7.4592s
	iters: 200, epoch: 6 | loss: 0.4344847
	speed: 0.0056s/iter; left time: 2.9825s
Updating learning rate to 3.171242478125e-06
Validation loss decreased (0.5415 --> 0.5413).  Saving model state dict ...
Epoch: 6 cost time: 1.4087605476379395
Epoch: 6, Steps: 245 | Train Loss: 0.5140187 Vali Loss: 0.5412675 Best vali loss: 0.5412675
	iters: 100, epoch: 7 | loss: 0.7851254
	speed: 0.0116s/iter; left time: 4.5492s
	iters: 200, epoch: 7 | loss: 0.6236122
	speed: 0.0057s/iter; left time: 1.6721s
Updating learning rate to 1.5856212390625e-06
Epoch: 7 cost time: 1.4427165985107422
Epoch: 7, Steps: 245 | Train Loss: 0.7043688 Vali Loss: 0.5426510 Best vali loss: 0.5412675
	iters: 100, epoch: 8 | loss: 0.7157673
	speed: 0.0113s/iter; left time: 1.6483s
	iters: 200, epoch: 8 | loss: 0.7043694
	speed: 0.0057s/iter; left time: 0.2609s
Updating learning rate to 7.9281061953125e-07
Validation loss decreased (0.5413 --> 0.5402).  Saving model state dict ...
Epoch: 8 cost time: 1.439708948135376
Epoch: 8, Steps: 245 | Train Loss: 0.7100684 Vali Loss: 0.5401874 Best vali loss: 0.5401874

best validation loss 0.5401874403885149

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0008321002066, 'e_layers': 4, 'learning_rate': 0.0002018443805, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9503564
	speed: 0.0119s/iter; left time: 22.1077s
	iters: 200, epoch: 1 | loss: 0.6102260
	speed: 0.0057s/iter; left time: 10.0005s
Updating learning rate to 0.00019416213619818516
Validation loss decreased (inf --> 0.5992).  Saving model state dict ...
Epoch: 1 cost time: 1.7390999794006348
Epoch: 1, Steps: 245 | Train Loss: 0.7802912 Vali Loss: 0.5991575 Best vali loss: 0.5991575
	iters: 100, epoch: 2 | loss: 0.9583419
	speed: 0.0108s/iter; left time: 17.4602s
	iters: 200, epoch: 2 | loss: 1.4495946
	speed: 0.0051s/iter; left time: 7.6763s
Updating learning rate to 0.00017228495534797389
Validation loss decreased (0.5992 --> 0.5883).  Saving model state dict ...
Epoch: 2 cost time: 1.316842794418335
Epoch: 2, Steps: 245 | Train Loss: 1.2039683 Vali Loss: 0.5882822 Best vali loss: 0.5882822
	iters: 100, epoch: 3 | loss: 0.5322319
	speed: 0.0107s/iter; left time: 14.6119s
	iters: 200, epoch: 3 | loss: 0.7684554
	speed: 0.0052s/iter; left time: 6.5919s
Updating learning rate to 0.00013954344041667262
Validation loss decreased (0.5883 --> 0.5597).  Saving model state dict ...
Epoch: 3 cost time: 1.3402926921844482
Epoch: 3, Steps: 245 | Train Loss: 0.6503437 Vali Loss: 0.5597389 Best vali loss: 0.5597389
	iters: 100, epoch: 4 | loss: 0.8075645
	speed: 0.0110s/iter; left time: 12.3416s
	iters: 200, epoch: 4 | loss: 0.5177394
	speed: 0.0054s/iter; left time: 5.4975s
Updating learning rate to 0.00010092219025
Validation loss decreased (0.5597 --> 0.5529).  Saving model state dict ...
Epoch: 4 cost time: 1.3821427822113037
Epoch: 4, Steps: 245 | Train Loss: 0.6626520 Vali Loss: 0.5529128 Best vali loss: 0.5529128
	iters: 100, epoch: 5 | loss: 0.8241782
	speed: 0.0105s/iter; left time: 9.2518s
	iters: 200, epoch: 5 | loss: 0.7722244
	speed: 0.0053s/iter; left time: 4.1309s
Updating learning rate to 6.230094008332741e-05
Validation loss decreased (0.5529 --> 0.5433).  Saving model state dict ...
Epoch: 5 cost time: 1.3546881675720215
Epoch: 5, Steps: 245 | Train Loss: 0.7982013 Vali Loss: 0.5433467 Best vali loss: 0.5433467
	iters: 100, epoch: 6 | loss: 0.6823854
	speed: 0.0106s/iter; left time: 6.7464s
	iters: 200, epoch: 6 | loss: 0.7019817
	speed: 0.0053s/iter; left time: 2.8592s
Updating learning rate to 2.955942515202614e-05
Validation loss decreased (0.5433 --> 0.5379).  Saving model state dict ...
Epoch: 6 cost time: 1.3459649085998535
Epoch: 6, Steps: 245 | Train Loss: 0.6921835 Vali Loss: 0.5379456 Best vali loss: 0.5379456
	iters: 100, epoch: 7 | loss: 0.6864212
	speed: 0.0109s/iter; left time: 4.2465s
	iters: 200, epoch: 7 | loss: 0.4022652
	speed: 0.0056s/iter; left time: 1.6181s
Updating learning rate to 7.68224430181486e-06
Epoch: 7 cost time: 1.4300310611724854
Epoch: 7, Steps: 245 | Train Loss: 0.5443432 Vali Loss: 0.5436043 Best vali loss: 0.5379456
	iters: 100, epoch: 8 | loss: 0.6635639
	speed: 0.0111s/iter; left time: 1.6247s
	iters: 200, epoch: 8 | loss: 0.6121406
	speed: 0.0058s/iter; left time: 0.2684s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.476200819015503
Epoch: 8, Steps: 245 | Train Loss: 0.6378523 Vali Loss: 0.5440677 Best vali loss: 0.5379456

best validation loss 0.5379456287178382

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010300591219, 'e_layers': 2, 'learning_rate': 0.0003955951352, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9105688
	speed: 0.0102s/iter; left time: 19.0388s
	iters: 200, epoch: 1 | loss: 0.5577107
	speed: 0.0039s/iter; left time: 6.9196s
Updating learning rate to 0.0003955951352
Validation loss decreased (inf --> 0.6153).  Saving model state dict ...
Epoch: 1 cost time: 1.305861473083496
Epoch: 1, Steps: 245 | Train Loss: 0.7341397 Vali Loss: 0.6152514 Best vali loss: 0.6152514
	iters: 100, epoch: 2 | loss: 0.7973100
	speed: 0.0078s/iter; left time: 12.6147s
	iters: 200, epoch: 2 | loss: 0.8200034
	speed: 0.0036s/iter; left time: 5.5014s
Updating learning rate to 0.0001977975676
Validation loss decreased (0.6153 --> 0.5385).  Saving model state dict ...
Epoch: 2 cost time: 0.9354605674743652
Epoch: 2, Steps: 245 | Train Loss: 0.8086567 Vali Loss: 0.5385260 Best vali loss: 0.5385260
	iters: 100, epoch: 3 | loss: 0.5789547
	speed: 0.0077s/iter; left time: 10.5938s
	iters: 200, epoch: 3 | loss: 0.9999337
	speed: 0.0036s/iter; left time: 4.5554s
Updating learning rate to 9.88987838e-05
Epoch: 3 cost time: 0.931084156036377
Epoch: 3, Steps: 245 | Train Loss: 0.7894442 Vali Loss: 0.5401236 Best vali loss: 0.5385260

best validation loss 0.5385259878905709

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0104471330598, 'e_layers': 2, 'learning_rate': 0.000175924738, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7627761
	speed: 0.0117s/iter; left time: 10.3142s
Updating learning rate to 0.0001692290013503053
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.004441499710083
Epoch: 1, Steps: 123 | Train Loss: 0.7627761 Vali Loss: 0.6076178 Best vali loss: 0.6076178
	iters: 100, epoch: 2 | loss: 0.9403380
	speed: 0.0091s/iter; left time: 6.9184s
Updating learning rate to 0.00015016115660913335
Validation loss decreased (0.6076 --> 0.5738).  Saving model state dict ...
Epoch: 2 cost time: 0.7179503440856934
Epoch: 2, Steps: 123 | Train Loss: 0.9403380 Vali Loss: 0.5737832 Best vali loss: 0.5737832
	iters: 100, epoch: 3 | loss: 0.8578722
	speed: 0.0094s/iter; left time: 6.0072s
Updating learning rate to 0.00012162411028788458
Validation loss decreased (0.5738 --> 0.5522).  Saving model state dict ...
Epoch: 3 cost time: 0.7204010486602783
Epoch: 3, Steps: 123 | Train Loss: 0.8578722 Vali Loss: 0.5521628 Best vali loss: 0.5521628

best validation loss 0.5521627752276715

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010824755105, 'e_layers': 3, 'learning_rate': 0.0001979792268, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001979792268
Validation loss decreased (inf --> 0.6178).  Saving model state dict ...
Epoch: 1 cost time: 1.0343236923217773
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6177908 Best vali loss: 0.6177908
Updating learning rate to 9.89896134e-05
Validation loss decreased (0.6178 --> 0.5709).  Saving model state dict ...
Epoch: 2 cost time: 0.7337918281555176
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5709293 Best vali loss: 0.5709293
Updating learning rate to 4.94948067e-05
Validation loss decreased (0.5709 --> 0.5540).  Saving model state dict ...
Epoch: 3 cost time: 0.7322945594787598
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5539550 Best vali loss: 0.5539550

best validation loss 0.5539549753821487

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010300591219, 'e_layers': 2, 'learning_rate': 0.0003955951352, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6726896
	speed: 0.0104s/iter; left time: 11.7277s
	iters: 200, epoch: 4 | loss: 0.4923922
	speed: 0.0039s/iter; left time: 4.0289s
Updating learning rate to 4.94493919e-05
Epoch: 4 cost time: 1.3144254684448242
Epoch: 4, Steps: 245 | Train Loss: 0.5825409 Vali Loss: 0.5385855 Best vali loss: 0.5385260
	iters: 100, epoch: 5 | loss: 0.6034369
	speed: 0.0081s/iter; left time: 7.1332s
	iters: 200, epoch: 5 | loss: 0.7529239
	speed: 0.0036s/iter; left time: 2.8505s
Updating learning rate to 2.472469595e-05
Validation loss decreased (0.5385 --> 0.5366).  Saving model state dict ...
Epoch: 5 cost time: 0.9691610336303711
Epoch: 5, Steps: 245 | Train Loss: 0.6781804 Vali Loss: 0.5366379 Best vali loss: 0.5366379
	iters: 100, epoch: 6 | loss: 0.5681422
	speed: 0.0083s/iter; left time: 5.2662s
	iters: 200, epoch: 6 | loss: 0.9412802
	speed: 0.0038s/iter; left time: 2.0138s
Updating learning rate to 1.2362347975e-05
Validation loss decreased (0.5366 --> 0.5322).  Saving model state dict ...
Epoch: 6 cost time: 0.9959330558776855
Epoch: 6, Steps: 245 | Train Loss: 0.7547112 Vali Loss: 0.5322060 Best vali loss: 0.5322060
	iters: 100, epoch: 7 | loss: 0.7991834
	speed: 0.0081s/iter; left time: 3.1662s
	iters: 200, epoch: 7 | loss: 0.6302587
	speed: 0.0038s/iter; left time: 1.0971s
Updating learning rate to 6.1811739875e-06
Epoch: 7 cost time: 0.9875109195709229
Epoch: 7, Steps: 245 | Train Loss: 0.7147211 Vali Loss: 0.5338279 Best vali loss: 0.5322060
	iters: 100, epoch: 8 | loss: 0.5601639
	speed: 0.0080s/iter; left time: 1.1667s
	iters: 200, epoch: 8 | loss: 0.7606314
	speed: 0.0037s/iter; left time: 0.1696s
Updating learning rate to 3.09058699375e-06
Epoch: 8 cost time: 0.9652416706085205
Epoch: 8, Steps: 245 | Train Loss: 0.6603976 Vali Loss: 0.5352450 Best vali loss: 0.5322060

best validation loss 0.5322059843618524

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009826730694, 'e_layers': 4, 'learning_rate': 0.0004364525391, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7666361
	speed: 0.0133s/iter; left time: 11.7721s
Updating learning rate to 0.0004364525391
Validation loss decreased (inf --> 0.6097).  Saving model state dict ...
Epoch: 1 cost time: 1.226684808731079
Epoch: 1, Steps: 123 | Train Loss: 0.7666361 Vali Loss: 0.6096932 Best vali loss: 0.6096932
	iters: 100, epoch: 2 | loss: 0.8883314
	speed: 0.0112s/iter; left time: 8.5114s
Updating learning rate to 0.00021822626955
Epoch: 2 cost time: 0.9220209121704102
Epoch: 2, Steps: 123 | Train Loss: 0.8883314 Vali Loss: 0.6938381 Best vali loss: 0.6096932
	iters: 100, epoch: 3 | loss: 0.7736318
	speed: 0.0111s/iter; left time: 7.0978s
Updating learning rate to 0.000109113134775
Validation loss decreased (0.6097 --> 0.5539).  Saving model state dict ...
Epoch: 3 cost time: 0.9337775707244873
Epoch: 3, Steps: 123 | Train Loss: 0.7736318 Vali Loss: 0.5539245 Best vali loss: 0.5539245
	iters: 100, epoch: 4 | loss: 0.8441797
	speed: 0.0116s/iter; left time: 5.9633s
Updating learning rate to 5.45565673875e-05
Validation loss decreased (0.5539 --> 0.5437).  Saving model state dict ...
Epoch: 4 cost time: 0.9265036582946777
Epoch: 4, Steps: 123 | Train Loss: 0.8441797 Vali Loss: 0.5436798 Best vali loss: 0.5436798
	iters: 100, epoch: 5 | loss: 0.8230283
	speed: 0.0115s/iter; left time: 4.5061s
Updating learning rate to 2.727828369375e-05
Epoch: 5 cost time: 0.9179589748382568
Epoch: 5, Steps: 123 | Train Loss: 0.8230283 Vali Loss: 0.5440554 Best vali loss: 0.5436798
	iters: 100, epoch: 6 | loss: 0.6352076
	speed: 0.0110s/iter; left time: 2.9745s
Updating learning rate to 1.3639141846875e-05
Epoch: 6 cost time: 0.9230177402496338
Epoch: 6, Steps: 123 | Train Loss: 0.6352076 Vali Loss: 0.5449597 Best vali loss: 0.5436798
	iters: 100, epoch: 7 | loss: 0.5195978
	speed: 0.0111s/iter; left time: 1.6281s
Updating learning rate to 6.8195709234375e-06
Epoch: 7 cost time: 0.9313952922821045
Epoch: 7, Steps: 123 | Train Loss: 0.5195978 Vali Loss: 0.5475683 Best vali loss: 0.5436798
	iters: 100, epoch: 8 | loss: 0.6093636
	speed: 0.0110s/iter; left time: 0.2636s
Updating learning rate to 3.40978546171875e-06
Epoch: 8 cost time: 0.9151244163513184
Epoch: 8, Steps: 123 | Train Loss: 0.6093636 Vali Loss: 0.5471145 Best vali loss: 0.5436798

best validation loss 0.5436797931700711

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0027542827662, 'e_layers': 3, 'learning_rate': 0.0003420122074, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5873109
	speed: 0.0108s/iter; left time: 20.1418s
	iters: 200, epoch: 1 | loss: 0.7771798
	speed: 0.0048s/iter; left time: 8.4343s
Updating learning rate to 0.0003420122074
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 1.5096499919891357
Epoch: 1, Steps: 245 | Train Loss: 0.6822453 Vali Loss: 0.6073938 Best vali loss: 0.6073938
	iters: 100, epoch: 2 | loss: 0.6873109
	speed: 0.0093s/iter; left time: 15.0831s
	iters: 200, epoch: 2 | loss: 0.8532112
	speed: 0.0046s/iter; left time: 6.9965s
Updating learning rate to 0.0001710061037
Validation loss decreased (0.6074 --> 0.5911).  Saving model state dict ...
Epoch: 2 cost time: 1.1849770545959473
Epoch: 2, Steps: 245 | Train Loss: 0.7702610 Vali Loss: 0.5910832 Best vali loss: 0.5910832
	iters: 100, epoch: 3 | loss: 0.7775318
	speed: 0.0099s/iter; left time: 13.5825s
	iters: 200, epoch: 3 | loss: 0.7219626
	speed: 0.0042s/iter; left time: 5.3832s
Updating learning rate to 8.550305185e-05
Validation loss decreased (0.5911 --> 0.5506).  Saving model state dict ...
Epoch: 3 cost time: 1.1525304317474365
Epoch: 3, Steps: 245 | Train Loss: 0.7497472 Vali Loss: 0.5506415 Best vali loss: 0.5506415
	iters: 100, epoch: 4 | loss: 0.9535059
	speed: 0.0093s/iter; left time: 10.4888s
	iters: 200, epoch: 4 | loss: 0.6750731
	speed: 0.0047s/iter; left time: 4.8559s
Updating learning rate to 4.2751525925e-05
Epoch: 4 cost time: 1.2019319534301758
Epoch: 4, Steps: 245 | Train Loss: 0.8142895 Vali Loss: 0.5511368 Best vali loss: 0.5506415
	iters: 100, epoch: 5 | loss: 0.5468670
	speed: 0.0093s/iter; left time: 8.2322s
	iters: 200, epoch: 5 | loss: 0.6934149
	speed: 0.0049s/iter; left time: 3.7895s
Updating learning rate to 2.13757629625e-05
Validation loss decreased (0.5506 --> 0.5490).  Saving model state dict ...
Epoch: 5 cost time: 1.2054545879364014
Epoch: 5, Steps: 245 | Train Loss: 0.6201409 Vali Loss: 0.5490056 Best vali loss: 0.5490056
	iters: 100, epoch: 6 | loss: 0.6517275
	speed: 0.0095s/iter; left time: 6.0318s
	iters: 200, epoch: 6 | loss: 0.9871296
	speed: 0.0043s/iter; left time: 2.3308s
Updating learning rate to 1.068788148125e-05
Validation loss decreased (0.5490 --> 0.5477).  Saving model state dict ...
Epoch: 6 cost time: 1.1276874542236328
Epoch: 6, Steps: 245 | Train Loss: 0.8194285 Vali Loss: 0.5476523 Best vali loss: 0.5476523
	iters: 100, epoch: 7 | loss: 0.7825665
	speed: 0.0091s/iter; left time: 3.5581s
	iters: 200, epoch: 7 | loss: 0.6878324
	speed: 0.0044s/iter; left time: 1.2865s
Updating learning rate to 5.343940740625e-06
Epoch: 7 cost time: 1.1290068626403809
Epoch: 7, Steps: 245 | Train Loss: 0.7351995 Vali Loss: 0.5486138 Best vali loss: 0.5476523
	iters: 100, epoch: 8 | loss: 0.6351441
	speed: 0.0096s/iter; left time: 1.4003s
	iters: 200, epoch: 8 | loss: 0.5852099
	speed: 0.0047s/iter; left time: 0.2183s
Updating learning rate to 2.6719703703125e-06
Validation loss decreased (0.5477 --> 0.5471).  Saving model state dict ...
Epoch: 8 cost time: 1.2107889652252197
Epoch: 8, Steps: 245 | Train Loss: 0.6101770 Vali Loss: 0.5470803 Best vali loss: 0.5470803

best validation loss 0.5470803415731168

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0099402435497, 'e_layers': 2, 'learning_rate': 0.0001934587879, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8433319
	speed: 0.0111s/iter; left time: 9.7861s
Updating learning rate to 0.00018609570121262608
Validation loss decreased (inf --> 0.5968).  Saving model state dict ...
Epoch: 1 cost time: 0.9472360610961914
Epoch: 1, Steps: 123 | Train Loss: 0.8433319 Vali Loss: 0.5968126 Best vali loss: 0.5968126
	iters: 100, epoch: 2 | loss: 1.0400631
	speed: 0.0082s/iter; left time: 6.2656s
Updating learning rate to 0.00016512740435211
Validation loss decreased (0.5968 --> 0.5651).  Saving model state dict ...
Epoch: 2 cost time: 0.6401815414428711
Epoch: 2, Steps: 123 | Train Loss: 1.0400631 Vali Loss: 0.5651293 Best vali loss: 0.5651293
	iters: 100, epoch: 3 | loss: 0.5742459
	speed: 0.0084s/iter; left time: 5.3558s
Updating learning rate to 0.00013374613043738094
Epoch: 3 cost time: 0.639585018157959
Epoch: 3, Steps: 123 | Train Loss: 0.5742459 Vali Loss: 0.5655673 Best vali loss: 0.5651293

best validation loss 0.5651292726156172

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017225082767, 'e_layers': 2, 'learning_rate': 0.0003406435223, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0742075
	speed: 0.0092s/iter; left time: 71.1698s
	iters: 200, epoch: 1 | loss: 1.0834270
	speed: 0.0035s/iter; left time: 26.3831s
	iters: 300, epoch: 1 | loss: 0.7328504
	speed: 0.0034s/iter; left time: 25.4355s
	iters: 400, epoch: 1 | loss: 0.7278536
	speed: 0.0033s/iter; left time: 24.4303s
	iters: 500, epoch: 1 | loss: 0.5266737
	speed: 0.0033s/iter; left time: 24.4073s
	iters: 600, epoch: 1 | loss: 0.4513893
	speed: 0.0034s/iter; left time: 24.4078s
	iters: 700, epoch: 1 | loss: 0.2522579
	speed: 0.0034s/iter; left time: 24.0290s
	iters: 800, epoch: 1 | loss: 0.5804455
	speed: 0.0035s/iter; left time: 24.3152s
	iters: 900, epoch: 1 | loss: 0.3044780
	speed: 0.0035s/iter; left time: 24.3491s
Updating learning rate to 0.00032767855021776103
Validation loss decreased (inf --> 0.6243).  Saving model state dict ...
Epoch: 1 cost time: 3.6459903717041016
Epoch: 1, Steps: 979 | Train Loss: 0.6370648 Vali Loss: 0.6242803 Best vali loss: 0.6242803
	iters: 100, epoch: 2 | loss: 0.2653785
	speed: 0.0114s/iter; left time: 77.1381s
	iters: 200, epoch: 2 | loss: 0.6134397
	speed: 0.0034s/iter; left time: 22.8501s
	iters: 300, epoch: 2 | loss: 0.6650181
	speed: 0.0034s/iter; left time: 22.3052s
	iters: 400, epoch: 2 | loss: 0.4534477
	speed: 0.0035s/iter; left time: 22.7765s
	iters: 500, epoch: 2 | loss: 1.7574095
	speed: 0.0034s/iter; left time: 21.6878s
	iters: 600, epoch: 2 | loss: 1.2432823
	speed: 0.0034s/iter; left time: 21.4294s
	iters: 700, epoch: 2 | loss: 0.9568157
	speed: 0.0036s/iter; left time: 21.8787s
	iters: 800, epoch: 2 | loss: 0.7004708
	speed: 0.0035s/iter; left time: 21.3688s
	iters: 900, epoch: 2 | loss: 0.4933121
	speed: 0.0035s/iter; left time: 20.6575s
Updating learning rate to 0.0002907574334428004
Epoch: 2 cost time: 3.4459362030029297
Epoch: 2, Steps: 979 | Train Loss: 0.7942860 Vali Loss: 0.6328575 Best vali loss: 0.6242803
	iters: 100, epoch: 3 | loss: 0.8526729
	speed: 0.0111s/iter; left time: 64.2687s
	iters: 200, epoch: 3 | loss: 0.5499719
	speed: 0.0034s/iter; left time: 19.0852s
	iters: 300, epoch: 3 | loss: 1.2202168
	speed: 0.0032s/iter; left time: 18.0768s
	iters: 400, epoch: 3 | loss: 0.7950557
	speed: 0.0033s/iter; left time: 18.1350s
	iters: 500, epoch: 3 | loss: 0.6575975
	speed: 0.0032s/iter; left time: 16.9886s
	iters: 600, epoch: 3 | loss: 0.9418141
	speed: 0.0034s/iter; left time: 18.1846s
	iters: 700, epoch: 3 | loss: 0.3623918
	speed: 0.0032s/iter; left time: 16.6368s
	iters: 800, epoch: 3 | loss: 0.7886143
	speed: 0.0031s/iter; left time: 15.8374s
	iters: 900, epoch: 3 | loss: 1.0665299
	speed: 0.0031s/iter; left time: 15.4214s
Updating learning rate to 0.000235501077313349
Validation loss decreased (0.6243 --> 0.5710).  Saving model state dict ...
Epoch: 3 cost time: 3.2195653915405273
Epoch: 3, Steps: 979 | Train Loss: 0.8038739 Vali Loss: 0.5710151 Best vali loss: 0.5710151

best validation loss 0.5710151286822456

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101276353992, 'e_layers': 4, 'learning_rate': 6.64130779e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8970702
	speed: 0.0126s/iter; left time: 23.5320s
	iters: 200, epoch: 1 | loss: 0.6665678
	speed: 0.0065s/iter; left time: 11.4311s
Updating learning rate to 6.388538063144383e-05
Validation loss decreased (inf --> 0.6009).  Saving model state dict ...
Epoch: 1 cost time: 1.9305260181427002
Epoch: 1, Steps: 245 | Train Loss: 0.7818190 Vali Loss: 0.6008701 Best vali loss: 0.6008701
	iters: 100, epoch: 2 | loss: 0.9294198
	speed: 0.0129s/iter; left time: 20.9242s
	iters: 200, epoch: 2 | loss: 0.6293041
	speed: 0.0065s/iter; left time: 9.8408s
Updating learning rate to 5.668710782128021e-05
Validation loss decreased (0.6009 --> 0.5821).  Saving model state dict ...
Epoch: 2 cost time: 1.6393048763275146
Epoch: 2, Steps: 245 | Train Loss: 0.7793619 Vali Loss: 0.5820666 Best vali loss: 0.5820666
	iters: 100, epoch: 3 | loss: 1.0215918
	speed: 0.0130s/iter; left time: 17.7830s
	iters: 200, epoch: 3 | loss: 0.7117698
	speed: 0.0065s/iter; left time: 8.2942s
Updating learning rate to 4.5914131252351043e-05
Validation loss decreased (0.5821 --> 0.5642).  Saving model state dict ...
Epoch: 3 cost time: 1.636730432510376
Epoch: 3, Steps: 245 | Train Loss: 0.8666808 Vali Loss: 0.5642119 Best vali loss: 0.5642119

best validation loss 0.5642118886189017

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101276353992, 'e_layers': 4, 'learning_rate': 6.64130779e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7812696
	speed: 0.0130s/iter; left time: 14.6317s
	iters: 200, epoch: 4 | loss: 0.5765535
	speed: 0.0064s/iter; left time: 6.6083s
Updating learning rate to 3.320653895e-05
Validation loss decreased (0.5642 --> 0.5374).  Saving model state dict ...
Epoch: 4 cost time: 1.9103827476501465
Epoch: 4, Steps: 245 | Train Loss: 0.6789116 Vali Loss: 0.5374164 Best vali loss: 0.5374164
	iters: 100, epoch: 5 | loss: 0.7246632
	speed: 0.0130s/iter; left time: 11.4854s
	iters: 200, epoch: 5 | loss: 0.5989671
	speed: 0.0064s/iter; left time: 5.0221s
Updating learning rate to 2.0498946647648958e-05
Epoch: 5 cost time: 1.6272084712982178
Epoch: 5, Steps: 245 | Train Loss: 0.6618152 Vali Loss: 0.5419349 Best vali loss: 0.5374164
	iters: 100, epoch: 6 | loss: 0.9583295
	speed: 0.0128s/iter; left time: 8.1128s
	iters: 200, epoch: 6 | loss: 0.6632789
	speed: 0.0066s/iter; left time: 3.5363s
Updating learning rate to 9.725970078719784e-06
Validation loss decreased (0.5374 --> 0.5364).  Saving model state dict ...
Epoch: 6 cost time: 1.6641724109649658
Epoch: 6, Steps: 245 | Train Loss: 0.8108042 Vali Loss: 0.5363644 Best vali loss: 0.5363644
	iters: 100, epoch: 7 | loss: 0.5632784
	speed: 0.0132s/iter; left time: 5.1605s
	iters: 200, epoch: 7 | loss: 0.8182148
	speed: 0.0065s/iter; left time: 1.8808s
Updating learning rate to 2.5276972685561654e-06
Validation loss decreased (0.5364 --> 0.5357).  Saving model state dict ...
Epoch: 7 cost time: 1.6368839740753174
Epoch: 7, Steps: 245 | Train Loss: 0.6907466 Vali Loss: 0.5357460 Best vali loss: 0.5357460
	iters: 100, epoch: 8 | loss: 0.5093586
	speed: 0.0130s/iter; left time: 1.9025s
	iters: 200, epoch: 8 | loss: 1.0322279
	speed: 0.0066s/iter; left time: 0.3041s
Updating learning rate to 0.0
Validation loss decreased (0.5357 --> 0.5351).  Saving model state dict ...
Epoch: 8 cost time: 1.6495189666748047
Epoch: 8, Steps: 245 | Train Loss: 0.7707932 Vali Loss: 0.5350569 Best vali loss: 0.5350569

best validation loss 0.5350568514905115

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.001066494913, 'e_layers': 3, 'learning_rate': 0.0004691832902, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004513260645060417
Validation loss decreased (inf --> 0.5976).  Saving model state dict ...
Epoch: 1 cost time: 0.9092538356781006
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5976194 Best vali loss: 0.5976194
Updating learning rate to 0.0004004729881599179
Validation loss decreased (0.5976 --> 0.5612).  Saving model state dict ...
Epoch: 2 cost time: 0.6253576278686523
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5611664 Best vali loss: 0.5611664
Updating learning rate to 0.00032436598105104104
Validation loss decreased (0.5612 --> 0.5549).  Saving model state dict ...
Epoch: 3 cost time: 0.6225936412811279
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5548743 Best vali loss: 0.5548743
Updating learning rate to 0.0002345916451
Validation loss decreased (0.5549 --> 0.5483).  Saving model state dict ...
Epoch: 4 cost time: 0.6266441345214844
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5483180 Best vali loss: 0.5483180
Updating learning rate to 0.00014481730914895903
Epoch: 5 cost time: 0.6251041889190674
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5582376 Best vali loss: 0.5483180
Updating learning rate to 6.87103020400821e-05
Epoch: 6 cost time: 0.6213035583496094
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5555506 Best vali loss: 0.5483180
Updating learning rate to 1.785722569395831e-05
Epoch: 7 cost time: 0.6155941486358643
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5606516 Best vali loss: 0.5483180
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6249425411224365
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5690684 Best vali loss: 0.5483180

best validation loss 0.5483180321735787

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010661782363, 'e_layers': 3, 'learning_rate': 0.0004678313839, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00045002561207582015
Validation loss decreased (inf --> 0.5975).  Saving model state dict ...
Epoch: 1 cost time: 0.8952555656433105
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5974532 Best vali loss: 0.5974532
Updating learning rate to 0.0003993190639537885
Validation loss decreased (0.5975 --> 0.5723).  Saving model state dict ...
Epoch: 2 cost time: 0.6266412734985352
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5722629 Best vali loss: 0.5722629
Updating learning rate to 0.000323431351829481
Epoch: 3 cost time: 0.6282711029052734
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5823285 Best vali loss: 0.5722629
Updating learning rate to 0.00023391569195
Epoch: 4 cost time: 0.6208069324493408
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5802277 Best vali loss: 0.5722629
Updating learning rate to 0.000144400032070519
Epoch: 5 cost time: 0.6333167552947998
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6067880 Best vali loss: 0.5722629
Updating learning rate to 6.85123199462115e-05
Epoch: 6 cost time: 0.6256091594696045
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5724981 Best vali loss: 0.5722629
Updating learning rate to 1.780577182417984e-05
Epoch: 7 cost time: 0.6243629455566406
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5949083 Best vali loss: 0.5722629
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6257081031799316
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6113279 Best vali loss: 0.5722629

best validation loss 0.5722628922332277

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010467651552, 'e_layers': 2, 'learning_rate': 0.0007632194667, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007341711553991548
Validation loss decreased (inf --> 0.5713).  Saving model state dict ...
Epoch: 1 cost time: 0.8270189762115479
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5712907 Best vali loss: 0.5712907
Updating learning rate to 0.0006514485635685752
Epoch: 2 cost time: 0.5369153022766113
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6007561 Best vali loss: 0.5712907
Updating learning rate to 0.0005276454559323047
Validation loss decreased (0.5713 --> 0.5606).  Saving model state dict ...
Epoch: 3 cost time: 0.5343236923217773
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5606368 Best vali loss: 0.5606368

best validation loss 0.5606368324206086

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008662973523, 'e_layers': 3, 'learning_rate': 0.0003164171619, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4624560
	speed: 0.0109s/iter; left time: 84.5074s
	iters: 200, epoch: 1 | loss: 0.4972198
	speed: 0.0043s/iter; left time: 32.8517s
	iters: 300, epoch: 1 | loss: 1.1792293
	speed: 0.0042s/iter; left time: 32.0032s
	iters: 400, epoch: 1 | loss: 1.2135597
	speed: 0.0044s/iter; left time: 33.0716s
	iters: 500, epoch: 1 | loss: 0.7126066
	speed: 0.0044s/iter; left time: 32.5066s
	iters: 600, epoch: 1 | loss: 0.4746680
	speed: 0.0040s/iter; left time: 28.8312s
	iters: 700, epoch: 1 | loss: 0.9599634
	speed: 0.0042s/iter; left time: 29.6759s
	iters: 800, epoch: 1 | loss: 0.3859839
	speed: 0.0038s/iter; left time: 27.0152s
	iters: 900, epoch: 1 | loss: 1.1978205
	speed: 0.0038s/iter; left time: 26.5092s
Updating learning rate to 0.0003043742507573601
Validation loss decreased (inf --> 0.5938).  Saving model state dict ...
Epoch: 1 cost time: 4.404569625854492
Epoch: 1, Steps: 979 | Train Loss: 0.8981675 Vali Loss: 0.5937781 Best vali loss: 0.5937781
	iters: 100, epoch: 2 | loss: 1.6087629
	speed: 0.0134s/iter; left time: 90.6039s
	iters: 200, epoch: 2 | loss: 1.3553956
	speed: 0.0044s/iter; left time: 29.5680s
	iters: 300, epoch: 2 | loss: 0.3819637
	speed: 0.0045s/iter; left time: 29.2854s
	iters: 400, epoch: 2 | loss: 0.5866281
	speed: 0.0044s/iter; left time: 28.1348s
	iters: 500, epoch: 2 | loss: 0.4606937
	speed: 0.0044s/iter; left time: 27.7413s
	iters: 600, epoch: 2 | loss: 0.7849040
	speed: 0.0044s/iter; left time: 27.7757s
	iters: 700, epoch: 2 | loss: 0.3329171
	speed: 0.0045s/iter; left time: 27.4269s
	iters: 800, epoch: 2 | loss: 0.5376981
	speed: 0.0041s/iter; left time: 24.8275s
	iters: 900, epoch: 2 | loss: 0.7743698
	speed: 0.0038s/iter; left time: 22.6292s
Updating learning rate to 0.00027007894138164585
Epoch: 2 cost time: 4.23218560218811
Epoch: 2, Steps: 979 | Train Loss: 0.7581481 Vali Loss: 0.6167940 Best vali loss: 0.5937781
	iters: 100, epoch: 3 | loss: 1.4375485
	speed: 0.0126s/iter; left time: 72.4955s
	iters: 200, epoch: 3 | loss: 0.6259835
	speed: 0.0038s/iter; left time: 21.8203s
	iters: 300, epoch: 3 | loss: 1.0661308
	speed: 0.0038s/iter; left time: 20.9342s
	iters: 400, epoch: 3 | loss: 1.1283327
	speed: 0.0038s/iter; left time: 21.0163s
	iters: 500, epoch: 3 | loss: 1.1731108
	speed: 0.0039s/iter; left time: 20.8804s
	iters: 600, epoch: 3 | loss: 0.7739849
	speed: 0.0039s/iter; left time: 20.5711s
	iters: 700, epoch: 3 | loss: 0.2987911
	speed: 0.0040s/iter; left time: 20.4779s
	iters: 800, epoch: 3 | loss: 0.9703212
	speed: 0.0040s/iter; left time: 20.2358s
	iters: 900, epoch: 3 | loss: 1.0768355
	speed: 0.0040s/iter; left time: 19.6530s
Updating learning rate to 0.00021875238373755617
Validation loss decreased (0.5938 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 3.851299285888672
Epoch: 3, Steps: 979 | Train Loss: 0.9501155 Vali Loss: 0.5566381 Best vali loss: 0.5566381

best validation loss 0.5566381138543849

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008632213861, 'e_layers': 3, 'learning_rate': 0.000329259176, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4659083
	speed: 0.0102s/iter; left time: 78.7062s
	iters: 200, epoch: 1 | loss: 0.4976442
	speed: 0.0044s/iter; left time: 33.6805s
	iters: 300, epoch: 1 | loss: 1.1783321
	speed: 0.0042s/iter; left time: 31.9980s
	iters: 400, epoch: 1 | loss: 1.2118871
	speed: 0.0043s/iter; left time: 32.0669s
	iters: 500, epoch: 1 | loss: 0.7095158
	speed: 0.0041s/iter; left time: 30.3275s
	iters: 600, epoch: 1 | loss: 0.4765531
	speed: 0.0041s/iter; left time: 29.9786s
	iters: 700, epoch: 1 | loss: 0.9774808
	speed: 0.0040s/iter; left time: 28.7882s
	iters: 800, epoch: 1 | loss: 0.3509189
	speed: 0.0040s/iter; left time: 28.3400s
	iters: 900, epoch: 1 | loss: 1.2098172
	speed: 0.0041s/iter; left time: 28.5683s
Updating learning rate to 0.00031672749479896573
Validation loss decreased (inf --> 0.6003).  Saving model state dict ...
Epoch: 1 cost time: 4.421091079711914
Epoch: 1, Steps: 979 | Train Loss: 0.8975619 Vali Loss: 0.6002988 Best vali loss: 0.6002988
	iters: 100, epoch: 2 | loss: 1.6074405
	speed: 0.0136s/iter; left time: 91.6748s
	iters: 200, epoch: 2 | loss: 1.3868914
	speed: 0.0044s/iter; left time: 29.2974s
	iters: 300, epoch: 2 | loss: 0.3846021
	speed: 0.0043s/iter; left time: 27.9123s
	iters: 400, epoch: 2 | loss: 0.5892883
	speed: 0.0044s/iter; left time: 28.0773s
	iters: 500, epoch: 2 | loss: 0.4684763
	speed: 0.0044s/iter; left time: 27.7722s
	iters: 600, epoch: 2 | loss: 0.7501892
	speed: 0.0044s/iter; left time: 27.4590s
	iters: 700, epoch: 2 | loss: 0.3389958
	speed: 0.0044s/iter; left time: 26.7983s
	iters: 800, epoch: 2 | loss: 0.5173528
	speed: 0.0044s/iter; left time: 26.4534s
	iters: 900, epoch: 2 | loss: 0.8021364
	speed: 0.0044s/iter; left time: 26.0566s
Updating learning rate to 0.00028104028605874747
Validation loss decreased (0.6003 --> 0.5930).  Saving model state dict ...
Epoch: 2 cost time: 4.313343524932861
Epoch: 2, Steps: 979 | Train Loss: 0.7605970 Vali Loss: 0.5930291 Best vali loss: 0.5930291
	iters: 100, epoch: 3 | loss: 1.4278086
	speed: 0.0136s/iter; left time: 78.4459s
	iters: 200, epoch: 3 | loss: 0.6364758
	speed: 0.0044s/iter; left time: 25.0471s
	iters: 300, epoch: 3 | loss: 1.1741822
	speed: 0.0043s/iter; left time: 24.0056s
	iters: 400, epoch: 3 | loss: 1.1181748
	speed: 0.0044s/iter; left time: 24.2471s
	iters: 500, epoch: 3 | loss: 1.1336468
	speed: 0.0044s/iter; left time: 23.7141s
	iters: 600, epoch: 3 | loss: 0.7700722
	speed: 0.0043s/iter; left time: 22.7552s
	iters: 700, epoch: 3 | loss: 0.2981933
	speed: 0.0042s/iter; left time: 21.8113s
	iters: 800, epoch: 3 | loss: 0.9544258
	speed: 0.0042s/iter; left time: 21.2403s
	iters: 900, epoch: 3 | loss: 0.9430546
	speed: 0.0040s/iter; left time: 19.7823s
Updating learning rate to 0.0002276306038046906
Epoch: 3 cost time: 4.220835208892822
Epoch: 3, Steps: 979 | Train Loss: 0.9395593 Vali Loss: 0.6028780 Best vali loss: 0.5930291

best validation loss 0.5930290681545738

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008662973523, 'e_layers': 3, 'learning_rate': 0.0003164171619, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7014350
	speed: 0.0110s/iter; left time: 52.7657s
	iters: 200, epoch: 4 | loss: 0.4619710
	speed: 0.0044s/iter; left time: 20.6836s
	iters: 300, epoch: 4 | loss: 1.1520107
	speed: 0.0044s/iter; left time: 20.1109s
	iters: 400, epoch: 4 | loss: 1.1349496
	speed: 0.0043s/iter; left time: 19.3776s
	iters: 500, epoch: 4 | loss: 0.6038127
	speed: 0.0042s/iter; left time: 18.5857s
	iters: 600, epoch: 4 | loss: 0.4342619
	speed: 0.0041s/iter; left time: 17.6127s
	iters: 700, epoch: 4 | loss: 0.4814579
	speed: 0.0039s/iter; left time: 16.3740s
	iters: 800, epoch: 4 | loss: 0.2945071
	speed: 0.0040s/iter; left time: 16.2122s
	iters: 900, epoch: 4 | loss: 0.9396048
	speed: 0.0040s/iter; left time: 16.0311s
Updating learning rate to 0.00015820858095
Epoch: 4 cost time: 4.415540456771851
Epoch: 4, Steps: 979 | Train Loss: 0.6893345 Vali Loss: 0.5750862 Best vali loss: 0.5566381
	iters: 100, epoch: 5 | loss: 1.0902953
	speed: 0.0129s/iter; left time: 49.3367s
	iters: 200, epoch: 5 | loss: 1.2359064
	speed: 0.0038s/iter; left time: 13.9680s
	iters: 300, epoch: 5 | loss: 0.3492115
	speed: 0.0037s/iter; left time: 13.2852s
	iters: 400, epoch: 5 | loss: 0.5049024
	speed: 0.0038s/iter; left time: 13.5343s
	iters: 500, epoch: 5 | loss: 0.4360378
	speed: 0.0040s/iter; left time: 13.5691s
	iters: 600, epoch: 5 | loss: 0.7011172
	speed: 0.0038s/iter; left time: 12.7550s
	iters: 700, epoch: 5 | loss: 0.2514723
	speed: 0.0039s/iter; left time: 12.4205s
	iters: 800, epoch: 5 | loss: 0.4852855
	speed: 0.0040s/iter; left time: 12.3610s
	iters: 900, epoch: 5 | loss: 0.6538633
	speed: 0.0040s/iter; left time: 12.0045s
Updating learning rate to 9.766477816244386e-05
Validation loss decreased (0.5566 --> 0.5514).  Saving model state dict ...
Epoch: 5 cost time: 3.8445398807525635
Epoch: 5, Steps: 979 | Train Loss: 0.6342324 Vali Loss: 0.5514157 Best vali loss: 0.5514157
	iters: 100, epoch: 6 | loss: 1.3517983
	speed: 0.0128s/iter; left time: 36.1954s
	iters: 200, epoch: 6 | loss: 0.4772351
	speed: 0.0039s/iter; left time: 10.6916s
	iters: 300, epoch: 6 | loss: 0.6805784
	speed: 0.0039s/iter; left time: 10.1863s
	iters: 400, epoch: 6 | loss: 0.7874300
	speed: 0.0037s/iter; left time: 9.4174s
	iters: 500, epoch: 6 | loss: 0.7863935
	speed: 0.0037s/iter; left time: 9.0685s
	iters: 600, epoch: 6 | loss: 0.6521905
	speed: 0.0038s/iter; left time: 8.9654s
	iters: 700, epoch: 6 | loss: 0.2738593
	speed: 0.0038s/iter; left time: 8.6026s
	iters: 800, epoch: 6 | loss: 0.8771686
	speed: 0.0037s/iter; left time: 7.8804s
	iters: 900, epoch: 6 | loss: 0.7882403
	speed: 0.0037s/iter; left time: 7.4804s
Updating learning rate to 4.633822051835417e-05
Epoch: 6 cost time: 3.7517130374908447
Epoch: 6, Steps: 979 | Train Loss: 0.7416549 Vali Loss: 0.5574213 Best vali loss: 0.5514157
	iters: 100, epoch: 7 | loss: 1.1145437
	speed: 0.0132s/iter; left time: 24.5684s
	iters: 200, epoch: 7 | loss: 0.9076821
	speed: 0.0043s/iter; left time: 7.5297s
	iters: 300, epoch: 7 | loss: 1.4577664
	speed: 0.0044s/iter; left time: 7.2975s
	iters: 400, epoch: 7 | loss: 0.9259062
	speed: 0.0043s/iter; left time: 6.6938s
	iters: 500, epoch: 7 | loss: 0.3531801
	speed: 0.0044s/iter; left time: 6.4835s
	iters: 600, epoch: 7 | loss: 1.0686024
	speed: 0.0044s/iter; left time: 6.0274s
	iters: 700, epoch: 7 | loss: 0.5477735
	speed: 0.0044s/iter; left time: 5.5936s
	iters: 800, epoch: 7 | loss: 0.4379447
	speed: 0.0045s/iter; left time: 5.1845s
	iters: 900, epoch: 7 | loss: 0.5672582
	speed: 0.0044s/iter; left time: 4.7090s
Updating learning rate to 1.2042911142639936e-05
Epoch: 7 cost time: 4.35795521736145
Epoch: 7, Steps: 979 | Train Loss: 0.8200731 Vali Loss: 0.5723226 Best vali loss: 0.5514157
	iters: 100, epoch: 8 | loss: 0.9680238
	speed: 0.0133s/iter; left time: 11.7006s
	iters: 200, epoch: 8 | loss: 0.4402829
	speed: 0.0039s/iter; left time: 3.0034s
	iters: 300, epoch: 8 | loss: 0.6965640
	speed: 0.0038s/iter; left time: 2.5970s
	iters: 400, epoch: 8 | loss: 1.0740581
	speed: 0.0040s/iter; left time: 2.3320s
	iters: 500, epoch: 8 | loss: 0.3802744
	speed: 0.0038s/iter; left time: 1.8440s
	iters: 600, epoch: 8 | loss: 0.3821405
	speed: 0.0038s/iter; left time: 1.4588s
	iters: 700, epoch: 8 | loss: 0.2516024
	speed: 0.0039s/iter; left time: 1.0817s
	iters: 800, epoch: 8 | loss: 0.6296663
	speed: 0.0038s/iter; left time: 0.6885s
	iters: 900, epoch: 8 | loss: 1.1196636
	speed: 0.0039s/iter; left time: 0.3139s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.838502883911133
Epoch: 8, Steps: 979 | Train Loss: 0.6602529 Vali Loss: 0.5740287 Best vali loss: 0.5514157

best validation loss 0.5514156874243389

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0042535237934, 'e_layers': 3, 'learning_rate': 0.0004327896021, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7101192
	speed: 0.0126s/iter; left time: 11.1561s
Updating learning rate to 0.0004327896021
Validation loss decreased (inf --> 0.6213).  Saving model state dict ...
Epoch: 1 cost time: 1.0526361465454102
Epoch: 1, Steps: 123 | Train Loss: 0.7101192 Vali Loss: 0.6212716 Best vali loss: 0.6212716
	iters: 100, epoch: 2 | loss: 0.6509218
	speed: 0.0092s/iter; left time: 6.9963s
Updating learning rate to 0.00021639480105
Validation loss decreased (0.6213 --> 0.5747).  Saving model state dict ...
Epoch: 2 cost time: 0.735271692276001
Epoch: 2, Steps: 123 | Train Loss: 0.6509218 Vali Loss: 0.5747104 Best vali loss: 0.5747104
	iters: 100, epoch: 3 | loss: 0.8298854
	speed: 0.0093s/iter; left time: 5.9559s
Updating learning rate to 0.000108197400525
Validation loss decreased (0.5747 --> 0.5441).  Saving model state dict ...
Epoch: 3 cost time: 0.7333457469940186
Epoch: 3, Steps: 123 | Train Loss: 0.8298854 Vali Loss: 0.5441248 Best vali loss: 0.5441248
	iters: 100, epoch: 4 | loss: 0.5220408
	speed: 0.0094s/iter; left time: 4.8547s
Updating learning rate to 5.40987002625e-05
Validation loss decreased (0.5441 --> 0.5297).  Saving model state dict ...
Epoch: 4 cost time: 0.7345318794250488
Epoch: 4, Steps: 123 | Train Loss: 0.5220408 Vali Loss: 0.5297014 Best vali loss: 0.5297014
	iters: 100, epoch: 5 | loss: 0.5956544
	speed: 0.0093s/iter; left time: 3.6470s
Updating learning rate to 2.704935013125e-05
Epoch: 5 cost time: 0.7267551422119141
Epoch: 5, Steps: 123 | Train Loss: 0.5956544 Vali Loss: 0.5343678 Best vali loss: 0.5297014
	iters: 100, epoch: 6 | loss: 0.6962759
	speed: 0.0091s/iter; left time: 2.4477s
Updating learning rate to 1.3524675065625e-05
Epoch: 6 cost time: 0.7374882698059082
Epoch: 6, Steps: 123 | Train Loss: 0.6962759 Vali Loss: 0.5388975 Best vali loss: 0.5297014
	iters: 100, epoch: 7 | loss: 0.6646122
	speed: 0.0092s/iter; left time: 1.3516s
Updating learning rate to 6.7623375328125e-06
Epoch: 7 cost time: 0.7551229000091553
Epoch: 7, Steps: 123 | Train Loss: 0.6646122 Vali Loss: 0.5417113 Best vali loss: 0.5297014
	iters: 100, epoch: 8 | loss: 0.7182877
	speed: 0.0092s/iter; left time: 0.2206s
Updating learning rate to 3.38116876640625e-06
Epoch: 8 cost time: 0.7314627170562744
Epoch: 8, Steps: 123 | Train Loss: 0.7182877 Vali Loss: 0.5465136 Best vali loss: 0.5297014

best validation loss 0.5297013627109236

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616678
	speed: 0.0123s/iter; left time: 10.9004s
Updating learning rate to 0.0001759287566
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0231993198394775
Epoch: 1, Steps: 123 | Train Loss: 0.7616678 Vali Loss: 0.6075860 Best vali loss: 0.6075860
	iters: 100, epoch: 2 | loss: 0.9362356
	speed: 0.0092s/iter; left time: 6.9900s
Updating learning rate to 8.79643783e-05
Validation loss decreased (0.6076 --> 0.5695).  Saving model state dict ...
Epoch: 2 cost time: 0.7147595882415771
Epoch: 2, Steps: 123 | Train Loss: 0.9362356 Vali Loss: 0.5695360 Best vali loss: 0.5695360
	iters: 100, epoch: 3 | loss: 0.8619637
	speed: 0.0093s/iter; left time: 5.9500s
Updating learning rate to 4.398218915e-05
Validation loss decreased (0.5695 --> 0.5536).  Saving model state dict ...
Epoch: 3 cost time: 0.727226972579956
Epoch: 3, Steps: 123 | Train Loss: 0.8619637 Vali Loss: 0.5536193 Best vali loss: 0.5536193
	iters: 100, epoch: 4 | loss: 0.4995842
	speed: 0.0092s/iter; left time: 4.7620s
Updating learning rate to 2.1991094575e-05
Epoch: 4 cost time: 0.7116043567657471
Epoch: 4, Steps: 123 | Train Loss: 0.4995842 Vali Loss: 0.5542226 Best vali loss: 0.5536193
	iters: 100, epoch: 5 | loss: 0.5879459
	speed: 0.0090s/iter; left time: 3.5477s
Updating learning rate to 1.09955472875e-05
Validation loss decreased (0.5536 --> 0.5443).  Saving model state dict ...
Epoch: 5 cost time: 0.7242951393127441
Epoch: 5, Steps: 123 | Train Loss: 0.5879459 Vali Loss: 0.5442734 Best vali loss: 0.5442734
	iters: 100, epoch: 6 | loss: 0.6264117
	speed: 0.0092s/iter; left time: 2.4940s
Updating learning rate to 5.49777364375e-06
Validation loss decreased (0.5443 --> 0.5391).  Saving model state dict ...
Epoch: 6 cost time: 0.714385986328125
Epoch: 6, Steps: 123 | Train Loss: 0.6264117 Vali Loss: 0.5391209 Best vali loss: 0.5391209
	iters: 100, epoch: 7 | loss: 0.6150791
	speed: 0.0092s/iter; left time: 1.3533s
Updating learning rate to 2.748886821875e-06
Epoch: 7 cost time: 0.715233564376831
Epoch: 7, Steps: 123 | Train Loss: 0.6150791 Vali Loss: 0.5395221 Best vali loss: 0.5391209
	iters: 100, epoch: 8 | loss: 0.7698296
	speed: 0.0089s/iter; left time: 0.2133s
Updating learning rate to 1.3744434109375e-06
Validation loss decreased (0.5391 --> 0.5374).  Saving model state dict ...
Epoch: 8 cost time: 0.7138283252716064
Epoch: 8, Steps: 123 | Train Loss: 0.7698296 Vali Loss: 0.5373567 Best vali loss: 0.5373567

best validation loss 0.5373567015084333

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759349934, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7616693
	speed: 0.0117s/iter; left time: 10.3767s
Updating learning rate to 0.0001759349934
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.018139362335205
Epoch: 1, Steps: 123 | Train Loss: 0.7616693 Vali Loss: 0.6075849 Best vali loss: 0.6075849
	iters: 100, epoch: 2 | loss: 0.9362438
	speed: 0.0092s/iter; left time: 7.0013s
Updating learning rate to 8.79674967e-05
Validation loss decreased (0.6076 --> 0.5682).  Saving model state dict ...
Epoch: 2 cost time: 0.7254531383514404
Epoch: 2, Steps: 123 | Train Loss: 0.9362438 Vali Loss: 0.5682216 Best vali loss: 0.5682216
	iters: 100, epoch: 3 | loss: 0.8646437
	speed: 0.0093s/iter; left time: 5.9143s
Updating learning rate to 4.398374835e-05
Validation loss decreased (0.5682 --> 0.5546).  Saving model state dict ...
Epoch: 3 cost time: 0.7173938751220703
Epoch: 3, Steps: 123 | Train Loss: 0.8646437 Vali Loss: 0.5545811 Best vali loss: 0.5545811

best validation loss 0.5545810709833713

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0116900806658, 'e_layers': 1, 'learning_rate': 0.0011890782376, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7384204
	speed: 0.0094s/iter; left time: 17.5259s
	iters: 200, epoch: 1 | loss: 0.5941441
	speed: 0.0031s/iter; left time: 5.4521s
Updating learning rate to 0.0011890782376
Validation loss decreased (inf --> 0.6205).  Saving model state dict ...
Epoch: 1 cost time: 1.0979177951812744
Epoch: 1, Steps: 245 | Train Loss: 0.6662822 Vali Loss: 0.6205298 Best vali loss: 0.6205298
	iters: 100, epoch: 2 | loss: 0.6423251
	speed: 0.0065s/iter; left time: 10.5262s
	iters: 200, epoch: 2 | loss: 0.6605673
	speed: 0.0029s/iter; left time: 4.4550s
Updating learning rate to 0.0005945391188
Epoch: 2 cost time: 0.7580695152282715
Epoch: 2, Steps: 245 | Train Loss: 0.6514462 Vali Loss: 0.6335426 Best vali loss: 0.6205298
	iters: 100, epoch: 3 | loss: 0.8370785
	speed: 0.0066s/iter; left time: 8.9844s
	iters: 200, epoch: 3 | loss: 0.7403956
	speed: 0.0029s/iter; left time: 3.7434s
Updating learning rate to 0.0002972695594
Epoch: 3 cost time: 0.781987190246582
Epoch: 3, Steps: 245 | Train Loss: 0.7887370 Vali Loss: 0.6339012 Best vali loss: 0.6205298

best validation loss 0.6205298105415952

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0065893574372, 'e_layers': 2, 'learning_rate': 0.000645784395, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000645784395
Validation loss decreased (inf --> 0.6106).  Saving model state dict ...
Epoch: 1 cost time: 0.7331173419952393
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6106253 Best vali loss: 0.6106253
Updating learning rate to 0.0003228921975
Validation loss decreased (0.6106 --> 0.6042).  Saving model state dict ...
Epoch: 2 cost time: 0.432436466217041
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6042299 Best vali loss: 0.6042299
Updating learning rate to 0.00016144609875
Epoch: 3 cost time: 0.4595792293548584
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6245577 Best vali loss: 0.6042299

best validation loss 0.6042298945162595

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759349934, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6121824
	speed: 0.0121s/iter; left time: 6.2376s
Updating learning rate to 2.1991874175e-05
Validation loss decreased (0.5546 --> 0.5416).  Saving model state dict ...
Epoch: 4 cost time: 1.0323805809020996
Epoch: 4, Steps: 123 | Train Loss: 0.6121824 Vali Loss: 0.5415749 Best vali loss: 0.5415749
	iters: 100, epoch: 5 | loss: 0.8591325
	speed: 0.0094s/iter; left time: 3.6959s
Updating learning rate to 1.09959370875e-05
Validation loss decreased (0.5416 --> 0.5378).  Saving model state dict ...
Epoch: 5 cost time: 0.7164688110351562
Epoch: 5, Steps: 123 | Train Loss: 0.8591325 Vali Loss: 0.5377820 Best vali loss: 0.5377820
	iters: 100, epoch: 6 | loss: 0.8316888
	speed: 0.0092s/iter; left time: 2.4887s
Updating learning rate to 5.49796854375e-06
Validation loss decreased (0.5378 --> 0.5369).  Saving model state dict ...
Epoch: 6 cost time: 0.7186110019683838
Epoch: 6, Steps: 123 | Train Loss: 0.8316888 Vali Loss: 0.5368694 Best vali loss: 0.5368694
	iters: 100, epoch: 7 | loss: 0.4938795
	speed: 0.0093s/iter; left time: 1.3646s
Updating learning rate to 2.748984271875e-06
Validation loss decreased (0.5369 --> 0.5358).  Saving model state dict ...
Epoch: 7 cost time: 0.7195661067962646
Epoch: 7, Steps: 123 | Train Loss: 0.4938795 Vali Loss: 0.5358228 Best vali loss: 0.5358228
	iters: 100, epoch: 8 | loss: 0.5780335
	speed: 0.0093s/iter; left time: 0.2225s
Updating learning rate to 1.3744921359375e-06
Validation loss decreased (0.5358 --> 0.5355).  Saving model state dict ...
Epoch: 8 cost time: 0.7154994010925293
Epoch: 8, Steps: 123 | Train Loss: 0.5780335 Vali Loss: 0.5354729 Best vali loss: 0.5354729

best validation loss 0.5354729262230188

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0093579163569, 'e_layers': 3, 'learning_rate': 0.0006938987799, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006938987799
Validation loss decreased (inf --> 0.6074).  Saving model state dict ...
Epoch: 1 cost time: 0.75547194480896
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6074418 Best vali loss: 0.6074418
Updating learning rate to 0.00034694938995
Epoch: 2 cost time: 0.46535158157348633
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6136937 Best vali loss: 0.6074418
Updating learning rate to 0.000173474694975
Validation loss decreased (0.6074 --> 0.5984).  Saving model state dict ...
Epoch: 3 cost time: 0.4581127166748047
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5984441 Best vali loss: 0.5984441
Updating learning rate to 8.67373474875e-05
Validation loss decreased (0.5984 --> 0.5760).  Saving model state dict ...
Epoch: 4 cost time: 0.4609036445617676
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5760202 Best vali loss: 0.5760202
Updating learning rate to 4.336867374375e-05
Validation loss decreased (0.5760 --> 0.5612).  Saving model state dict ...
Epoch: 5 cost time: 0.4431471824645996
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5611501 Best vali loss: 0.5611501
Updating learning rate to 2.1684336871875e-05
Validation loss decreased (0.5612 --> 0.5604).  Saving model state dict ...
Epoch: 6 cost time: 0.44623708724975586
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5603899 Best vali loss: 0.5603899
Updating learning rate to 1.08421684359375e-05
Validation loss decreased (0.5604 --> 0.5599).  Saving model state dict ...
Epoch: 7 cost time: 0.48639822006225586
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5598841 Best vali loss: 0.5598841
Updating learning rate to 5.42108421796875e-06
Epoch: 8 cost time: 0.4663100242614746
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5606445 Best vali loss: 0.5598841

best validation loss 0.5598841296583896

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0032935752151, 'e_layers': 4, 'learning_rate': 0.0005258306647, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8644869
	speed: 0.0132s/iter; left time: 11.6766s
Updating learning rate to 0.0005258306647
Validation loss decreased (inf --> 0.6405).  Saving model state dict ...
Epoch: 1 cost time: 1.22413969039917
Epoch: 1, Steps: 123 | Train Loss: 0.8644869 Vali Loss: 0.6405105 Best vali loss: 0.6405105
	iters: 100, epoch: 2 | loss: 0.6843950
	speed: 0.0112s/iter; left time: 8.5499s
Updating learning rate to 0.00026291533235
Validation loss decreased (0.6405 --> 0.5699).  Saving model state dict ...
Epoch: 2 cost time: 0.9166796207427979
Epoch: 2, Steps: 123 | Train Loss: 0.6843950 Vali Loss: 0.5699140 Best vali loss: 0.5699140
	iters: 100, epoch: 3 | loss: 0.6434379
	speed: 0.0115s/iter; left time: 7.3801s
Updating learning rate to 0.000131457666175
Validation loss decreased (0.5699 --> 0.5433).  Saving model state dict ...
Epoch: 3 cost time: 0.9357562065124512
Epoch: 3, Steps: 123 | Train Loss: 0.6434379 Vali Loss: 0.5432634 Best vali loss: 0.5432634
	iters: 100, epoch: 4 | loss: 0.7982807
	speed: 0.0115s/iter; left time: 5.9199s
Updating learning rate to 6.57288330875e-05
Validation loss decreased (0.5433 --> 0.5431).  Saving model state dict ...
Epoch: 4 cost time: 0.9347989559173584
Epoch: 4, Steps: 123 | Train Loss: 0.7982807 Vali Loss: 0.5430816 Best vali loss: 0.5430816
	iters: 100, epoch: 5 | loss: 0.6967630
	speed: 0.0113s/iter; left time: 4.4582s
Updating learning rate to 3.286441654375e-05
Epoch: 5 cost time: 0.9203047752380371
Epoch: 5, Steps: 123 | Train Loss: 0.6967630 Vali Loss: 0.5536524 Best vali loss: 0.5430816
	iters: 100, epoch: 6 | loss: 0.7627000
	speed: 0.0112s/iter; left time: 3.0229s
Updating learning rate to 1.6432208271875e-05
Epoch: 6 cost time: 0.932070255279541
Epoch: 6, Steps: 123 | Train Loss: 0.7627000 Vali Loss: 0.5508070 Best vali loss: 0.5430816
	iters: 100, epoch: 7 | loss: 0.6029347
	speed: 0.0111s/iter; left time: 1.6348s
Updating learning rate to 8.2161041359375e-06
Epoch: 7 cost time: 0.922945499420166
Epoch: 7, Steps: 123 | Train Loss: 0.6029347 Vali Loss: 0.5556508 Best vali loss: 0.5430816
	iters: 100, epoch: 8 | loss: 0.6488339
	speed: 0.0111s/iter; left time: 0.2665s
Updating learning rate to 4.10805206796875e-06
Epoch: 8 cost time: 0.9200665950775146
Epoch: 8, Steps: 123 | Train Loss: 0.6488339 Vali Loss: 0.5570515 Best vali loss: 0.5430816

best validation loss 0.5430816031340812

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0037363447347, 'e_layers': 4, 'learning_rate': 0.0005349470779, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8707658
	speed: 0.0133s/iter; left time: 11.7325s
Updating learning rate to 0.0005349470779
Validation loss decreased (inf --> 0.5622).  Saving model state dict ...
Epoch: 1 cost time: 1.2297396659851074
Epoch: 1, Steps: 123 | Train Loss: 0.8707658 Vali Loss: 0.5622399 Best vali loss: 0.5622399
	iters: 100, epoch: 2 | loss: 0.6947574
	speed: 0.0114s/iter; left time: 8.6985s
Updating learning rate to 0.00026747353895
Epoch: 2 cost time: 0.9262232780456543
Epoch: 2, Steps: 123 | Train Loss: 0.6947574 Vali Loss: 0.5826747 Best vali loss: 0.5622399
	iters: 100, epoch: 3 | loss: 0.6348589
	speed: 0.0111s/iter; left time: 7.1020s
Updating learning rate to 0.000133736769475
Validation loss decreased (0.5622 --> 0.5581).  Saving model state dict ...
Epoch: 3 cost time: 0.9302575588226318
Epoch: 3, Steps: 123 | Train Loss: 0.6348589 Vali Loss: 0.5581280 Best vali loss: 0.5581280

best validation loss 0.5581280230262223

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0013363602043, 'e_layers': 3, 'learning_rate': 0.0005309919465, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7072350
	speed: 0.0117s/iter; left time: 10.3446s
Updating learning rate to 0.0005309919465
Validation loss decreased (inf --> 0.6107).  Saving model state dict ...
Epoch: 1 cost time: 1.039595127105713
Epoch: 1, Steps: 123 | Train Loss: 0.7072350 Vali Loss: 0.6106548 Best vali loss: 0.6106548
	iters: 100, epoch: 2 | loss: 0.6732734
	speed: 0.0093s/iter; left time: 7.0667s
Updating learning rate to 0.00026549597325
Validation loss decreased (0.6107 --> 0.6087).  Saving model state dict ...
Epoch: 2 cost time: 0.7486140727996826
Epoch: 2, Steps: 123 | Train Loss: 0.6732734 Vali Loss: 0.6086872 Best vali loss: 0.6086872
	iters: 100, epoch: 3 | loss: 0.8381908
	speed: 0.0094s/iter; left time: 5.9941s
Updating learning rate to 0.000132747986625
Validation loss decreased (0.6087 --> 0.5587).  Saving model state dict ...
Epoch: 3 cost time: 0.7425158023834229
Epoch: 3, Steps: 123 | Train Loss: 0.8381908 Vali Loss: 0.5586833 Best vali loss: 0.5586833

best validation loss 0.5586832517526151

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0015737940963, 'e_layers': 3, 'learning_rate': 0.0006859472147, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7825159
	speed: 0.0114s/iter; left time: 10.1246s
Updating learning rate to 0.0006598399033722276
Validation loss decreased (inf --> 0.6121).  Saving model state dict ...
Epoch: 1 cost time: 0.9887495040893555
Epoch: 1, Steps: 123 | Train Loss: 0.7825159 Vali Loss: 0.6120700 Best vali loss: 0.6120700
	iters: 100, epoch: 2 | loss: 0.8644531
	speed: 0.0088s/iter; left time: 6.6813s
Updating learning rate to 0.0005854925708751972
Epoch: 2 cost time: 0.713749885559082
Epoch: 2, Steps: 123 | Train Loss: 0.8644531 Vali Loss: 0.6153184 Best vali loss: 0.6120700
	iters: 100, epoch: 3 | loss: 1.0215578
	speed: 0.0088s/iter; left time: 5.6311s
Updating learning rate to 0.0004742239246213346
Validation loss decreased (0.6121 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 0.713465690612793
Epoch: 3, Steps: 123 | Train Loss: 1.0215578 Vali Loss: 0.6012006 Best vali loss: 0.6012006

best validation loss 0.6012005736738485

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0037363447347, 'e_layers': 4, 'learning_rate': 0.0005349470779, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7696466
	speed: 0.0137s/iter; left time: 7.0823s
Updating learning rate to 6.68683847375e-05
Epoch: 4 cost time: 1.2380013465881348
Epoch: 4, Steps: 123 | Train Loss: 0.7696466 Vali Loss: 0.5688124 Best vali loss: 0.5581280
	iters: 100, epoch: 5 | loss: 0.6109225
	speed: 0.0112s/iter; left time: 4.4067s
Updating learning rate to 3.343419236875e-05
Epoch: 5 cost time: 0.9266736507415771
Epoch: 5, Steps: 123 | Train Loss: 0.6109225 Vali Loss: 0.5857061 Best vali loss: 0.5581280
	iters: 100, epoch: 6 | loss: 0.5704967
	speed: 0.0110s/iter; left time: 2.9783s
Updating learning rate to 1.6717096184375e-05
Epoch: 6 cost time: 0.9144144058227539
Epoch: 6, Steps: 123 | Train Loss: 0.5704967 Vali Loss: 0.5916874 Best vali loss: 0.5581280
	iters: 100, epoch: 7 | loss: 0.7376348
	speed: 0.0110s/iter; left time: 1.6169s
Updating learning rate to 8.3585480921875e-06
Epoch: 7 cost time: 0.9260625839233398
Epoch: 7, Steps: 123 | Train Loss: 0.7376348 Vali Loss: 0.5979134 Best vali loss: 0.5581280
	iters: 100, epoch: 8 | loss: 0.6625081
	speed: 0.0111s/iter; left time: 0.2673s
Updating learning rate to 4.17927404609375e-06
Epoch: 8 cost time: 0.9249823093414307
Epoch: 8, Steps: 123 | Train Loss: 0.6625081 Vali Loss: 0.5999325 Best vali loss: 0.5581280

best validation loss 0.5581280230262223

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.001319500629, 'e_layers': 4, 'learning_rate': 0.0005261522793, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8640916
	speed: 0.0133s/iter; left time: 11.7528s
Updating learning rate to 0.0005261522793
Validation loss decreased (inf --> 0.5960).  Saving model state dict ...
Epoch: 1 cost time: 1.2280147075653076
Epoch: 1, Steps: 123 | Train Loss: 0.8640916 Vali Loss: 0.5960431 Best vali loss: 0.5960431
	iters: 100, epoch: 2 | loss: 0.6902829
	speed: 0.0114s/iter; left time: 8.6691s
Updating learning rate to 0.00026307613965
Validation loss decreased (0.5960 --> 0.5655).  Saving model state dict ...
Epoch: 2 cost time: 0.933772087097168
Epoch: 2, Steps: 123 | Train Loss: 0.6902829 Vali Loss: 0.5655415 Best vali loss: 0.5655415
	iters: 100, epoch: 3 | loss: 0.6566909
	speed: 0.0114s/iter; left time: 7.3017s
Updating learning rate to 0.000131538069825
Validation loss decreased (0.5655 --> 0.5519).  Saving model state dict ...
Epoch: 3 cost time: 0.9271302223205566
Epoch: 3, Steps: 123 | Train Loss: 0.6566909 Vali Loss: 0.5519080 Best vali loss: 0.5519080
	iters: 100, epoch: 4 | loss: 0.8064843
	speed: 0.0113s/iter; left time: 5.8425s
Updating learning rate to 6.57690349125e-05
Validation loss decreased (0.5519 --> 0.5443).  Saving model state dict ...
Epoch: 4 cost time: 0.9247677326202393
Epoch: 4, Steps: 123 | Train Loss: 0.8064843 Vali Loss: 0.5443094 Best vali loss: 0.5443094
	iters: 100, epoch: 5 | loss: 0.6872545
	speed: 0.0114s/iter; left time: 4.4803s
Updating learning rate to 3.288451745625e-05
Epoch: 5 cost time: 0.9310669898986816
Epoch: 5, Steps: 123 | Train Loss: 0.6872545 Vali Loss: 0.5627445 Best vali loss: 0.5443094
	iters: 100, epoch: 6 | loss: 0.7498370
	speed: 0.0112s/iter; left time: 3.0227s
Updating learning rate to 1.6442258728125e-05
Epoch: 6 cost time: 0.9226081371307373
Epoch: 6, Steps: 123 | Train Loss: 0.7498370 Vali Loss: 0.5629189 Best vali loss: 0.5443094
	iters: 100, epoch: 7 | loss: 0.5942586
	speed: 0.0111s/iter; left time: 1.6318s
Updating learning rate to 8.2211293640625e-06
Epoch: 7 cost time: 0.9272115230560303
Epoch: 7, Steps: 123 | Train Loss: 0.5942586 Vali Loss: 0.5672009 Best vali loss: 0.5443094
	iters: 100, epoch: 8 | loss: 0.6518476
	speed: 0.0112s/iter; left time: 0.2680s
Updating learning rate to 4.11056468203125e-06
Epoch: 8 cost time: 0.9391772747039795
Epoch: 8, Steps: 123 | Train Loss: 0.6518476 Vali Loss: 0.5722146 Best vali loss: 0.5443094

best validation loss 0.5443093612865958

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0028821037, 'e_layers': 4, 'learning_rate': 0.0003277344924, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3684005
	speed: 0.0119s/iter; left time: 91.7672s
	iters: 200, epoch: 1 | loss: 1.8071793
	speed: 0.0053s/iter; left time: 40.2576s
	iters: 300, epoch: 1 | loss: 1.0108804
	speed: 0.0052s/iter; left time: 39.3407s
	iters: 400, epoch: 1 | loss: 0.3250460
	speed: 0.0051s/iter; left time: 38.0376s
	iters: 500, epoch: 1 | loss: 0.5965032
	speed: 0.0052s/iter; left time: 38.1329s
	iters: 600, epoch: 1 | loss: 0.8519859
	speed: 0.0053s/iter; left time: 38.2494s
	iters: 700, epoch: 1 | loss: 0.5929226
	speed: 0.0051s/iter; left time: 36.7341s
	iters: 800, epoch: 1 | loss: 1.2415452
	speed: 0.0051s/iter; left time: 35.9432s
	iters: 900, epoch: 1 | loss: 0.9177732
	speed: 0.0052s/iter; left time: 35.8001s
Updating learning rate to 0.00031526084101316795
Validation loss decreased (inf --> 0.5990).  Saving model state dict ...
Epoch: 1 cost time: 5.428842544555664
Epoch: 1, Steps: 979 | Train Loss: 0.8569151 Vali Loss: 0.5990336 Best vali loss: 0.5990336
	iters: 100, epoch: 2 | loss: 1.1687529
	speed: 0.0151s/iter; left time: 101.6853s
	iters: 200, epoch: 2 | loss: 2.9258358
	speed: 0.0047s/iter; left time: 30.9729s
	iters: 300, epoch: 2 | loss: 0.7248853
	speed: 0.0047s/iter; left time: 30.4819s
	iters: 400, epoch: 2 | loss: 0.5322558
	speed: 0.0047s/iter; left time: 30.6557s
	iters: 500, epoch: 2 | loss: 0.3137563
	speed: 0.0048s/iter; left time: 30.1953s
	iters: 600, epoch: 2 | loss: 1.1277795
	speed: 0.0047s/iter; left time: 29.4322s
	iters: 700, epoch: 2 | loss: 1.1036820
	speed: 0.0047s/iter; left time: 29.0791s
	iters: 800, epoch: 2 | loss: 0.5573040
	speed: 0.0050s/iter; left time: 30.2688s
	iters: 900, epoch: 2 | loss: 1.4868610
	speed: 0.0050s/iter; left time: 29.6645s
Updating learning rate to 0.0002797388872023855
Epoch: 2 cost time: 4.726092100143433
Epoch: 2, Steps: 979 | Train Loss: 1.1045681 Vali Loss: 0.6153031 Best vali loss: 0.5990336
	iters: 100, epoch: 3 | loss: 0.9089050
	speed: 0.0147s/iter; left time: 84.9146s
	iters: 200, epoch: 3 | loss: 0.5915254
	speed: 0.0045s/iter; left time: 25.5876s
	iters: 300, epoch: 3 | loss: 1.0476242
	speed: 0.0047s/iter; left time: 26.1638s
	iters: 400, epoch: 3 | loss: 0.2989101
	speed: 0.0044s/iter; left time: 24.2351s
	iters: 500, epoch: 3 | loss: 0.8019644
	speed: 0.0044s/iter; left time: 23.4348s
	iters: 600, epoch: 3 | loss: 1.4913402
	speed: 0.0044s/iter; left time: 23.0371s
	iters: 700, epoch: 3 | loss: 1.3242619
	speed: 0.0044s/iter; left time: 22.6621s
	iters: 800, epoch: 3 | loss: 0.6478781
	speed: 0.0044s/iter; left time: 22.2128s
	iters: 900, epoch: 3 | loss: 0.4701401
	speed: 0.0045s/iter; left time: 22.2251s
Updating learning rate to 0.00022657652642803122
Validation loss decreased (0.5990 --> 0.5794).  Saving model state dict ...
Epoch: 3 cost time: 4.443469524383545
Epoch: 3, Steps: 979 | Train Loss: 0.8425055 Vali Loss: 0.5793820 Best vali loss: 0.5793820
	iters: 100, epoch: 4 | loss: 0.5624620
	speed: 0.0145s/iter; left time: 69.3254s
	iters: 200, epoch: 4 | loss: 0.7482809
	speed: 0.0045s/iter; left time: 21.3267s
	iters: 300, epoch: 4 | loss: 0.8774191
	speed: 0.0047s/iter; left time: 21.4363s
	iters: 400, epoch: 4 | loss: 0.3374327
	speed: 0.0047s/iter; left time: 20.9429s
	iters: 500, epoch: 4 | loss: 2.2061682
	speed: 0.0048s/iter; left time: 20.9588s
	iters: 600, epoch: 4 | loss: 0.2578969
	speed: 0.0047s/iter; left time: 20.2639s
	iters: 700, epoch: 4 | loss: 0.4846933
	speed: 0.0047s/iter; left time: 19.7271s
	iters: 800, epoch: 4 | loss: 1.0095602
	speed: 0.0047s/iter; left time: 19.1838s
	iters: 900, epoch: 4 | loss: 0.8005314
	speed: 0.0047s/iter; left time: 18.8134s
Updating learning rate to 0.0001638672462
Validation loss decreased (0.5794 --> 0.5608).  Saving model state dict ...
Epoch: 4 cost time: 4.639109373092651
Epoch: 4, Steps: 979 | Train Loss: 0.8093828 Vali Loss: 0.5607593 Best vali loss: 0.5607593
	iters: 100, epoch: 5 | loss: 0.3017446
	speed: 0.0150s/iter; left time: 57.4437s
	iters: 200, epoch: 5 | loss: 0.7016079
	speed: 0.0044s/iter; left time: 16.4013s
	iters: 300, epoch: 5 | loss: 0.7058332
	speed: 0.0046s/iter; left time: 16.7892s
	iters: 400, epoch: 5 | loss: 1.2021400
	speed: 0.0047s/iter; left time: 16.4420s
	iters: 500, epoch: 5 | loss: 0.3035155
	speed: 0.0046s/iter; left time: 15.6931s
	iters: 600, epoch: 5 | loss: 0.8126331
	speed: 0.0047s/iter; left time: 15.4853s
	iters: 700, epoch: 5 | loss: 1.1762750
	speed: 0.0046s/iter; left time: 14.9158s
	iters: 800, epoch: 5 | loss: 0.7451352
	speed: 0.0045s/iter; left time: 13.9281s
	iters: 900, epoch: 5 | loss: 0.6594367
	speed: 0.0045s/iter; left time: 13.4794s
Updating learning rate to 0.00010115796597196879
Epoch: 5 cost time: 4.525725603103638
Epoch: 5, Steps: 979 | Train Loss: 0.7342579 Vali Loss: 0.5677101 Best vali loss: 0.5607593
	iters: 100, epoch: 6 | loss: 1.2491186
	speed: 0.0144s/iter; left time: 40.9270s
	iters: 200, epoch: 6 | loss: 0.4622761
	speed: 0.0048s/iter; left time: 13.0690s
	iters: 300, epoch: 6 | loss: 0.3533230
	speed: 0.0047s/iter; left time: 12.5136s
	iters: 400, epoch: 6 | loss: 0.4362790
	speed: 0.0048s/iter; left time: 12.1352s
	iters: 500, epoch: 6 | loss: 0.4632649
	speed: 0.0048s/iter; left time: 11.6359s
	iters: 600, epoch: 6 | loss: 0.2408345
	speed: 0.0047s/iter; left time: 11.0219s
	iters: 700, epoch: 6 | loss: 0.5996741
	speed: 0.0047s/iter; left time: 10.5576s
	iters: 800, epoch: 6 | loss: 0.6514661
	speed: 0.0047s/iter; left time: 10.1514s
	iters: 900, epoch: 6 | loss: 1.0803753
	speed: 0.0046s/iter; left time: 9.4341s
Updating learning rate to 4.79956051976145e-05
Epoch: 6 cost time: 4.664286851882935
Epoch: 6, Steps: 979 | Train Loss: 0.6151791 Vali Loss: 0.5638251 Best vali loss: 0.5607593
	iters: 100, epoch: 7 | loss: 0.2480395
	speed: 0.0148s/iter; left time: 27.5069s
	iters: 200, epoch: 7 | loss: 1.0120883
	speed: 0.0046s/iter; left time: 8.0920s
	iters: 300, epoch: 7 | loss: 0.7276329
	speed: 0.0046s/iter; left time: 7.6785s
	iters: 400, epoch: 7 | loss: 1.3050612
	speed: 0.0044s/iter; left time: 6.8699s
	iters: 500, epoch: 7 | loss: 0.5647091
	speed: 0.0045s/iter; left time: 6.6288s
	iters: 600, epoch: 7 | loss: 0.6309945
	speed: 0.0046s/iter; left time: 6.2395s
	iters: 700, epoch: 7 | loss: 0.9827065
	speed: 0.0047s/iter; left time: 5.8852s
	iters: 800, epoch: 7 | loss: 0.4839961
	speed: 0.0048s/iter; left time: 5.5461s
	iters: 900, epoch: 7 | loss: 0.4582221
	speed: 0.0046s/iter; left time: 4.8699s
Updating learning rate to 1.2473651386832071e-05
Epoch: 7 cost time: 4.569453477859497
Epoch: 7, Steps: 979 | Train Loss: 0.7126056 Vali Loss: 0.5611965 Best vali loss: 0.5607593
	iters: 100, epoch: 8 | loss: 0.3249723
	speed: 0.0142s/iter; left time: 12.5289s
	iters: 200, epoch: 8 | loss: 0.5593414
	speed: 0.0044s/iter; left time: 3.4134s
	iters: 300, epoch: 8 | loss: 0.5198161
	speed: 0.0043s/iter; left time: 2.9466s
	iters: 400, epoch: 8 | loss: 0.4299249
	speed: 0.0043s/iter; left time: 2.5219s
	iters: 500, epoch: 8 | loss: 0.2424954
	speed: 0.0044s/iter; left time: 2.1345s
	iters: 600, epoch: 8 | loss: 1.1120510
	speed: 0.0046s/iter; left time: 1.7387s
	iters: 700, epoch: 8 | loss: 0.6044176
	speed: 0.0046s/iter; left time: 1.2965s
	iters: 800, epoch: 8 | loss: 0.8058051
	speed: 0.0047s/iter; left time: 0.8529s
	iters: 900, epoch: 8 | loss: 0.5997849
	speed: 0.0046s/iter; left time: 0.3678s
Updating learning rate to 0.0
Validation loss decreased (0.5608 --> 0.5595).  Saving model state dict ...
Epoch: 8 cost time: 4.454129457473755
Epoch: 8, Steps: 979 | Train Loss: 0.5776232 Vali Loss: 0.5594850 Best vali loss: 0.5594850

best validation loss 0.5594849760529069

[INFO][smbo.py:320] Finished 1200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0041275425976, 'e_layers': 2, 'learning_rate': 0.0036634328627, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0512766
	speed: 0.0111s/iter; left time: 9.7793s
Updating learning rate to 0.0036634328627
Validation loss decreased (inf --> 0.6383).  Saving model state dict ...
Epoch: 1 cost time: 0.9553561210632324
Epoch: 1, Steps: 123 | Train Loss: 1.0512766 Vali Loss: 0.6383375 Best vali loss: 0.6383375
	iters: 100, epoch: 2 | loss: 0.6945736
	speed: 0.0082s/iter; left time: 6.2556s
Updating learning rate to 0.00183171643135
Validation loss decreased (0.6383 --> 0.6269).  Saving model state dict ...
Epoch: 2 cost time: 0.6453821659088135
Epoch: 2, Steps: 123 | Train Loss: 0.6945736 Vali Loss: 0.6268622 Best vali loss: 0.6268622
	iters: 100, epoch: 3 | loss: 0.8652155
	speed: 0.0084s/iter; left time: 5.3594s
Updating learning rate to 0.000915858215675
Epoch: 3 cost time: 0.6371011734008789
Epoch: 3, Steps: 123 | Train Loss: 0.8652155 Vali Loss: 0.6316847 Best vali loss: 0.6268622

best validation loss 0.6268622400252039

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0039407358337, 'e_layers': 4, 'learning_rate': 0.0046045924934, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7693413
	speed: 0.0119s/iter; left time: 10.5124s
Updating learning rate to 0.0046045924934
Validation loss decreased (inf --> 0.6336).  Saving model state dict ...
Epoch: 1 cost time: 1.0539040565490723
Epoch: 1, Steps: 123 | Train Loss: 0.7693413 Vali Loss: 0.6336003 Best vali loss: 0.6336003
	iters: 100, epoch: 2 | loss: 0.9074592
	speed: 0.0093s/iter; left time: 7.0649s
Updating learning rate to 0.0023022962467
Validation loss decreased (0.6336 --> 0.6039).  Saving model state dict ...
Epoch: 2 cost time: 0.758476734161377
Epoch: 2, Steps: 123 | Train Loss: 0.9074592 Vali Loss: 0.6039053 Best vali loss: 0.6039053
	iters: 100, epoch: 3 | loss: 0.8027136
	speed: 0.0096s/iter; left time: 6.1536s
Updating learning rate to 0.00115114812335
Epoch: 3 cost time: 0.802152156829834
Epoch: 3, Steps: 123 | Train Loss: 0.8027136 Vali Loss: 0.6180082 Best vali loss: 0.6039053

best validation loss 0.6039052501369108

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488717986, 'e_layers': 2, 'learning_rate': 0.0002977123555, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744541
	speed: 0.0118s/iter; left time: 10.4646s
Updating learning rate to 0.000286381353661087
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0396358966827393
Epoch: 1, Steps: 123 | Train Loss: 0.7744541 Vali Loss: 0.6172262 Best vali loss: 0.6172262
	iters: 100, epoch: 2 | loss: 0.9487783
	speed: 0.0092s/iter; left time: 6.9840s
Updating learning rate to 0.00025411339045853506
Validation loss decreased (0.6172 --> 0.5678).  Saving model state dict ...
Epoch: 2 cost time: 0.7126963138580322
Epoch: 2, Steps: 123 | Train Loss: 0.9487783 Vali Loss: 0.5678021 Best vali loss: 0.5678021
	iters: 100, epoch: 3 | loss: 0.8511581
	speed: 0.0093s/iter; left time: 5.9186s
Updating learning rate to 0.00020582097078011792
Validation loss decreased (0.5678 --> 0.5412).  Saving model state dict ...
Epoch: 3 cost time: 0.7169144153594971
Epoch: 3, Steps: 123 | Train Loss: 0.8511581 Vali Loss: 0.5412482 Best vali loss: 0.5412482

best validation loss 0.5412482030134629

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488717986, 'e_layers': 2, 'learning_rate': 0.0002977123555, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5830309
	speed: 0.0118s/iter; left time: 6.0654s
Updating learning rate to 0.00014885617775
Validation loss decreased (0.5412 --> 0.5295).  Saving model state dict ...
Epoch: 4 cost time: 1.0093789100646973
Epoch: 4, Steps: 123 | Train Loss: 0.5830309 Vali Loss: 0.5294999 Best vali loss: 0.5294999
	iters: 100, epoch: 5 | loss: 0.8235975
	speed: 0.0092s/iter; left time: 3.6083s
Updating learning rate to 9.18913847198821e-05
Validation loss decreased (0.5295 --> 0.5284).  Saving model state dict ...
Epoch: 5 cost time: 0.7148404121398926
Epoch: 5, Steps: 123 | Train Loss: 0.8235975 Vali Loss: 0.5283542 Best vali loss: 0.5283542
	iters: 100, epoch: 6 | loss: 0.7543256
	speed: 0.0091s/iter; left time: 2.4598s
Updating learning rate to 4.359896504146493e-05
Epoch: 6 cost time: 0.7135121822357178
Epoch: 6, Steps: 123 | Train Loss: 0.7543256 Vali Loss: 0.5357756 Best vali loss: 0.5283542
	iters: 100, epoch: 7 | loss: 0.4249713
	speed: 0.0089s/iter; left time: 1.3082s
Updating learning rate to 1.1331001838912996e-05
Epoch: 7 cost time: 0.7133238315582275
Epoch: 7, Steps: 123 | Train Loss: 0.4249713 Vali Loss: 0.5434551 Best vali loss: 0.5283542
	iters: 100, epoch: 8 | loss: 0.5027499
	speed: 0.0090s/iter; left time: 0.2153s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7217767238616943
Epoch: 8, Steps: 123 | Train Loss: 0.5027499 Vali Loss: 0.5447984 Best vali loss: 0.5283542

best validation loss 0.5283542031604126

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017098415871, 'e_layers': 2, 'learning_rate': 7.63846066e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9248033
	speed: 0.0102s/iter; left time: 39.0576s
	iters: 200, epoch: 1 | loss: 1.5082587
	speed: 0.0034s/iter; left time: 12.6864s
	iters: 300, epoch: 1 | loss: 1.4716576
	speed: 0.0032s/iter; left time: 11.7268s
	iters: 400, epoch: 1 | loss: 1.1997358
	speed: 0.0032s/iter; left time: 11.1042s
Updating learning rate to 7.347739061833327e-05
Validation loss decreased (inf --> 0.5948).  Saving model state dict ...
Epoch: 1 cost time: 1.9587037563323975
Epoch: 1, Steps: 490 | Train Loss: 1.2761139 Vali Loss: 0.5948396 Best vali loss: 0.5948396
	iters: 100, epoch: 2 | loss: 0.5957762
	speed: 0.0095s/iter; left time: 31.6707s
	iters: 200, epoch: 2 | loss: 0.5546729
	speed: 0.0033s/iter; left time: 10.5143s
	iters: 300, epoch: 2 | loss: 0.7622072
	speed: 0.0033s/iter; left time: 10.2794s
	iters: 400, epoch: 2 | loss: 0.7523650
	speed: 0.0034s/iter; left time: 10.2877s
Updating learning rate to 6.519833995256335e-05
Epoch: 2 cost time: 1.677166223526001
Epoch: 2, Steps: 490 | Train Loss: 0.6662553 Vali Loss: 0.6295330 Best vali loss: 0.5948396
	iters: 100, epoch: 3 | loss: 1.1874378
	speed: 0.0098s/iter; left time: 27.8725s
	iters: 200, epoch: 3 | loss: 0.9475778
	speed: 0.0033s/iter; left time: 8.9877s
	iters: 300, epoch: 3 | loss: 0.8008703
	speed: 0.0031s/iter; left time: 8.1992s
	iters: 400, epoch: 3 | loss: 0.6130996
	speed: 0.0031s/iter; left time: 7.8973s
Updating learning rate to 5.280786501677255e-05
Validation loss decreased (0.5948 --> 0.5438).  Saving model state dict ...
Epoch: 3 cost time: 1.6360721588134766
Epoch: 3, Steps: 490 | Train Loss: 0.8872464 Vali Loss: 0.5438216 Best vali loss: 0.5438216
	iters: 100, epoch: 4 | loss: 0.9598100
	speed: 0.0099s/iter; left time: 23.3123s
	iters: 200, epoch: 4 | loss: 0.5551653
	speed: 0.0034s/iter; left time: 7.6141s
	iters: 300, epoch: 4 | loss: 0.5054876
	speed: 0.0035s/iter; left time: 7.5472s
	iters: 400, epoch: 4 | loss: 0.5981243
	speed: 0.0035s/iter; left time: 7.1608s
Updating learning rate to 3.81923033e-05
Epoch: 4 cost time: 1.7101802825927734
Epoch: 4, Steps: 490 | Train Loss: 0.6546468 Vali Loss: 0.5605291 Best vali loss: 0.5438216
	iters: 100, epoch: 5 | loss: 0.7817413
	speed: 0.0094s/iter; left time: 17.5172s
	iters: 200, epoch: 5 | loss: 0.9741818
	speed: 0.0034s/iter; left time: 5.9191s
	iters: 300, epoch: 5 | loss: 0.8760585
	speed: 0.0034s/iter; left time: 5.6273s
	iters: 400, epoch: 5 | loss: 0.9710092
	speed: 0.0033s/iter; left time: 5.1354s
Updating learning rate to 2.3576741583227456e-05
Validation loss decreased (0.5438 --> 0.5342).  Saving model state dict ...
Epoch: 5 cost time: 1.6637506484985352
Epoch: 5, Steps: 490 | Train Loss: 0.9007477 Vali Loss: 0.5341658 Best vali loss: 0.5341658
	iters: 100, epoch: 6 | loss: 0.7743372
	speed: 0.0101s/iter; left time: 13.7877s
	iters: 200, epoch: 6 | loss: 0.9439170
	speed: 0.0036s/iter; left time: 4.5879s
	iters: 300, epoch: 6 | loss: 0.9613737
	speed: 0.0035s/iter; left time: 4.0737s
	iters: 400, epoch: 6 | loss: 1.0062070
	speed: 0.0036s/iter; left time: 3.8903s
Updating learning rate to 1.1186266647436645e-05
Epoch: 6 cost time: 1.7540128231048584
Epoch: 6, Steps: 490 | Train Loss: 0.9214587 Vali Loss: 0.5353414 Best vali loss: 0.5341658
	iters: 100, epoch: 7 | loss: 0.8028111
	speed: 0.0095s/iter; left time: 8.4044s
	iters: 200, epoch: 7 | loss: 0.3792801
	speed: 0.0032s/iter; left time: 2.5012s
	iters: 300, epoch: 7 | loss: 0.3229292
	speed: 0.0032s/iter; left time: 2.1966s
	iters: 400, epoch: 7 | loss: 0.7297146
	speed: 0.0031s/iter; left time: 1.7910s
Updating learning rate to 2.907215981666726e-06
Validation loss decreased (0.5342 --> 0.5332).  Saving model state dict ...
Epoch: 7 cost time: 1.5984876155853271
Epoch: 7, Steps: 490 | Train Loss: 0.5586838 Vali Loss: 0.5332235 Best vali loss: 0.5332235
	iters: 100, epoch: 8 | loss: 0.7796718
	speed: 0.0095s/iter; left time: 3.7312s
	iters: 200, epoch: 8 | loss: 0.4589019
	speed: 0.0034s/iter; left time: 0.9759s
	iters: 300, epoch: 8 | loss: 0.8303416
	speed: 0.0033s/iter; left time: 0.6248s
	iters: 400, epoch: 8 | loss: 0.7142479
	speed: 0.0034s/iter; left time: 0.3068s
Updating learning rate to 0.0
Validation loss decreased (0.5332 --> 0.5314).  Saving model state dict ...
Epoch: 8 cost time: 1.6810810565948486
Epoch: 8, Steps: 490 | Train Loss: 0.6957908 Vali Loss: 0.5313843 Best vali loss: 0.5313843

best validation loss 0.5313843261141956

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 3, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6185443
	speed: 0.0139s/iter; left time: 12.2718s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6158).  Saving model state dict ...
Epoch: 1 cost time: 1.2959010601043701
Epoch: 1, Steps: 123 | Train Loss: 0.6185443 Vali Loss: 0.6158076 Best vali loss: 0.6158076
	iters: 100, epoch: 2 | loss: 0.7415804
	speed: 0.0122s/iter; left time: 9.2953s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6158 --> 0.6043).  Saving model state dict ...
Epoch: 2 cost time: 0.9978840351104736
Epoch: 2, Steps: 123 | Train Loss: 0.7415804 Vali Loss: 0.6042905 Best vali loss: 0.6042905
	iters: 100, epoch: 3 | loss: 0.6375828
	speed: 0.0123s/iter; left time: 7.8751s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.6043 --> 0.5515).  Saving model state dict ...
Epoch: 3 cost time: 0.9910697937011719
Epoch: 3, Steps: 123 | Train Loss: 0.6375828 Vali Loss: 0.5515338 Best vali loss: 0.5515338
	iters: 100, epoch: 4 | loss: 0.8699694
	speed: 0.0124s/iter; left time: 6.4097s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.9937281608581543
Epoch: 4, Steps: 123 | Train Loss: 0.8699694 Vali Loss: 0.5610891 Best vali loss: 0.5515338
	iters: 100, epoch: 5 | loss: 0.6814846
	speed: 0.0120s/iter; left time: 4.6979s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5515 --> 0.5478).  Saving model state dict ...
Epoch: 5 cost time: 0.9941658973693848
Epoch: 5, Steps: 123 | Train Loss: 0.6814846 Vali Loss: 0.5477968 Best vali loss: 0.5477968
	iters: 100, epoch: 6 | loss: 0.4523740
	speed: 0.0125s/iter; left time: 3.3630s
Updating learning rate to 4.3594722292809835e-05
Validation loss decreased (0.5478 --> 0.5424).  Saving model state dict ...
Epoch: 6 cost time: 0.9992156028747559
Epoch: 6, Steps: 123 | Train Loss: 0.4523740 Vali Loss: 0.5424480 Best vali loss: 0.5424480
	iters: 100, epoch: 7 | loss: 0.7893571
	speed: 0.0125s/iter; left time: 1.8331s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.9953303337097168
Epoch: 7, Steps: 123 | Train Loss: 0.7893571 Vali Loss: 0.5520833 Best vali loss: 0.5424480
	iters: 100, epoch: 8 | loss: 0.6808272
	speed: 0.0120s/iter; left time: 0.2874s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0002338886260986
Epoch: 8, Steps: 123 | Train Loss: 0.6808272 Vali Loss: 0.5448859 Best vali loss: 0.5424480

best validation loss 0.5424479507064995

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0024335605032, 'e_layers': 3, 'learning_rate': 0.0001285992019, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6738010
	speed: 0.0109s/iter; left time: 20.2909s
	iters: 200, epoch: 1 | loss: 0.8443947
	speed: 0.0048s/iter; left time: 8.3960s
Updating learning rate to 0.0001285992019
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 1.500718355178833
Epoch: 1, Steps: 245 | Train Loss: 0.7590978 Vali Loss: 0.6033487 Best vali loss: 0.6033487
	iters: 100, epoch: 2 | loss: 0.7391176
	speed: 0.0096s/iter; left time: 15.5808s
	iters: 200, epoch: 2 | loss: 0.8078284
	speed: 0.0050s/iter; left time: 7.5329s
Updating learning rate to 6.429960095e-05
Epoch: 2 cost time: 1.251692533493042
Epoch: 2, Steps: 245 | Train Loss: 0.7734730 Vali Loss: 0.6171394 Best vali loss: 0.6033487
	iters: 100, epoch: 3 | loss: 0.8528486
	speed: 0.0095s/iter; left time: 12.9978s
	iters: 200, epoch: 3 | loss: 0.6941281
	speed: 0.0044s/iter; left time: 5.5504s
Updating learning rate to 3.2149800475e-05
Validation loss decreased (0.6033 --> 0.5753).  Saving model state dict ...
Epoch: 3 cost time: 1.148144006729126
Epoch: 3, Steps: 245 | Train Loss: 0.7734883 Vali Loss: 0.5752835 Best vali loss: 0.5752835

best validation loss 0.5752835183273802

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.004009223735, 'e_layers': 3, 'learning_rate': 0.0004700085707, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7090826
	speed: 0.0118s/iter; left time: 10.4477s
Updating learning rate to 0.000452119934637307
Validation loss decreased (inf --> 0.6175).  Saving model state dict ...
Epoch: 1 cost time: 1.0331928730010986
Epoch: 1, Steps: 123 | Train Loss: 0.7090826 Vali Loss: 0.6174878 Best vali loss: 0.6174878
	iters: 100, epoch: 2 | loss: 0.6606377
	speed: 0.0091s/iter; left time: 6.9606s
Updating learning rate to 0.0004011774091288834
Validation loss decreased (0.6175 --> 0.5822).  Saving model state dict ...
Epoch: 2 cost time: 0.7379171848297119
Epoch: 2, Steps: 123 | Train Loss: 0.6606377 Vali Loss: 0.5821654 Best vali loss: 0.5821654
	iters: 100, epoch: 3 | loss: 0.8364087
	speed: 0.0094s/iter; left time: 6.0152s
Updating learning rate to 0.000324936531888243
Validation loss decreased (0.5822 --> 0.5430).  Saving model state dict ...
Epoch: 3 cost time: 0.7328777313232422
Epoch: 3, Steps: 123 | Train Loss: 0.8364087 Vali Loss: 0.5430399 Best vali loss: 0.5430399

best validation loss 0.5430398576654587

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002976254034, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744414
	speed: 0.0115s/iter; left time: 10.1534s
Updating learning rate to 0.0002862977109783376
Validation loss decreased (inf --> 0.6174).  Saving model state dict ...
Epoch: 1 cost time: 1.0047743320465088
Epoch: 1, Steps: 123 | Train Loss: 0.7744414 Vali Loss: 0.6173969 Best vali loss: 0.6173969
	iters: 100, epoch: 2 | loss: 0.9485466
	speed: 0.0092s/iter; left time: 7.0471s
Updating learning rate to 0.00025403917219876085
Validation loss decreased (0.6174 --> 0.5689).  Saving model state dict ...
Epoch: 2 cost time: 0.7208271026611328
Epoch: 2, Steps: 123 | Train Loss: 0.9485466 Vali Loss: 0.5689168 Best vali loss: 0.5689168
	iters: 100, epoch: 3 | loss: 0.8468189
	speed: 0.0094s/iter; left time: 5.9908s
Updating learning rate to 0.00020576085716607825
Validation loss decreased (0.5689 --> 0.5450).  Saving model state dict ...
Epoch: 3 cost time: 0.7191340923309326
Epoch: 3, Steps: 123 | Train Loss: 0.8468189 Vali Loss: 0.5449763 Best vali loss: 0.5449763

best validation loss 0.5449762597562868

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.004009223735, 'e_layers': 3, 'learning_rate': 0.0004700085707, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5602707
	speed: 0.0120s/iter; left time: 6.1826s
Updating learning rate to 0.00023500428535
Epoch: 4 cost time: 1.0349721908569336
Epoch: 4, Steps: 123 | Train Loss: 0.5602707 Vali Loss: 0.5504833 Best vali loss: 0.5430399
	iters: 100, epoch: 5 | loss: 0.5614455
	speed: 0.0092s/iter; left time: 3.6271s
Updating learning rate to 0.00014507203881175703
Epoch: 5 cost time: 0.7495574951171875
Epoch: 5, Steps: 123 | Train Loss: 0.5614455 Vali Loss: 0.5520887 Best vali loss: 0.5430399
	iters: 100, epoch: 6 | loss: 0.6506101
	speed: 0.0092s/iter; left time: 2.4760s
Updating learning rate to 6.883116157111659e-05
Epoch: 6 cost time: 0.744551420211792
Epoch: 6, Steps: 123 | Train Loss: 0.6506101 Vali Loss: 0.5799227 Best vali loss: 0.5430399
	iters: 100, epoch: 7 | loss: 0.4302978
	speed: 0.0092s/iter; left time: 1.3501s
Updating learning rate to 1.788863606269297e-05
Epoch: 7 cost time: 0.7406063079833984
Epoch: 7, Steps: 123 | Train Loss: 0.4302978 Vali Loss: 0.5857626 Best vali loss: 0.5430399
	iters: 100, epoch: 8 | loss: 0.4940712
	speed: 0.0093s/iter; left time: 0.2229s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7575111389160156
Epoch: 8, Steps: 123 | Train Loss: 0.4940712 Vali Loss: 0.5900651 Best vali loss: 0.5430399

best validation loss 0.5430398576654587

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0034463374296, 'e_layers': 3, 'learning_rate': 0.0004200993252, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004041102466870415
Validation loss decreased (inf --> 0.6022).  Saving model state dict ...
Epoch: 1 cost time: 0.7617168426513672
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6021853 Best vali loss: 0.6021853
Updating learning rate to 0.00035857720341040636
Validation loss decreased (0.6022 --> 0.6009).  Saving model state dict ...
Epoch: 2 cost time: 0.44910144805908203
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6009283 Best vali loss: 0.6009283
Updating learning rate to 0.00029043218845089706
Epoch: 3 cost time: 0.4458580017089844
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6097305 Best vali loss: 0.6009283
Updating learning rate to 0.0002100496626
Epoch: 4 cost time: 0.4593210220336914
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6354450 Best vali loss: 0.6009283
Updating learning rate to 0.00012966713674910298
Epoch: 5 cost time: 0.453723669052124
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6199132 Best vali loss: 0.6009283
Updating learning rate to 6.152212178959368e-05
Validation loss decreased (0.6009 --> 0.5897).  Saving model state dict ...
Epoch: 6 cost time: 0.4560072422027588
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5897130 Best vali loss: 0.5897130
Updating learning rate to 1.598907851295849e-05
Validation loss decreased (0.5897 --> 0.5704).  Saving model state dict ...
Epoch: 7 cost time: 0.44043397903442383
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5704302 Best vali loss: 0.5704302
Updating learning rate to 0.0
Validation loss decreased (0.5704 --> 0.5693).  Saving model state dict ...
Epoch: 8 cost time: 0.4433588981628418
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5693303 Best vali loss: 0.5693303

best validation loss 0.5693302865052654

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488717986, 'e_layers': 2, 'learning_rate': 0.0002976705796, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744600
	speed: 0.0116s/iter; left time: 10.2531s
Updating learning rate to 0.0002863411677616059
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0033717155456543
Epoch: 1, Steps: 123 | Train Loss: 0.7744600 Vali Loss: 0.6172921 Best vali loss: 0.6172921
	iters: 100, epoch: 2 | loss: 0.9491522
	speed: 0.0091s/iter; left time: 6.9643s
Updating learning rate to 0.000254077732497445
Validation loss decreased (0.6173 --> 0.5712).  Saving model state dict ...
Epoch: 2 cost time: 0.717397928237915
Epoch: 2, Steps: 123 | Train Loss: 0.9491522 Vali Loss: 0.5711811 Best vali loss: 0.5711811
	iters: 100, epoch: 3 | loss: 0.8468667
	speed: 0.0095s/iter; left time: 6.0718s
Updating learning rate to 0.00020579208935771683
Validation loss decreased (0.5712 --> 0.5434).  Saving model state dict ...
Epoch: 3 cost time: 0.7287306785583496
Epoch: 3, Steps: 123 | Train Loss: 0.8468667 Vali Loss: 0.5434140 Best vali loss: 0.5434140
	iters: 100, epoch: 4 | loss: 0.4905093
	speed: 0.0094s/iter; left time: 4.8680s
Updating learning rate to 0.0001488352898
Epoch: 4 cost time: 0.7228600978851318
Epoch: 4, Steps: 123 | Train Loss: 0.4905093 Vali Loss: 0.5474139 Best vali loss: 0.5434140
	iters: 100, epoch: 5 | loss: 0.5698492
	speed: 0.0090s/iter; left time: 3.5483s
Updating learning rate to 9.187849024228316e-05
Validation loss decreased (0.5434 --> 0.5281).  Saving model state dict ...
Epoch: 5 cost time: 0.7235488891601562
Epoch: 5, Steps: 123 | Train Loss: 0.5698492 Vali Loss: 0.5280527 Best vali loss: 0.5280527
	iters: 100, epoch: 6 | loss: 0.5833916
	speed: 0.0094s/iter; left time: 2.5280s
Updating learning rate to 4.359284710255502e-05
Epoch: 6 cost time: 0.7292177677154541
Epoch: 6, Steps: 123 | Train Loss: 0.5833916 Vali Loss: 0.5437294 Best vali loss: 0.5280527
	iters: 100, epoch: 7 | loss: 0.5381060
	speed: 0.0091s/iter; left time: 1.3315s
Updating learning rate to 1.1329411838394116e-05
Epoch: 7 cost time: 0.7165453433990479
Epoch: 7, Steps: 123 | Train Loss: 0.5381060 Vali Loss: 0.5452616 Best vali loss: 0.5280527
	iters: 100, epoch: 8 | loss: 0.6929563
	speed: 0.0089s/iter; left time: 0.2145s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7207837104797363
Epoch: 8, Steps: 123 | Train Loss: 0.6929563 Vali Loss: 0.5514724 Best vali loss: 0.5280527

best validation loss 0.5280527263424674

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043814100174, 'e_layers': 2, 'learning_rate': 0.0001358357385, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7559780
	speed: 0.0116s/iter; left time: 10.2617s
Updating learning rate to 0.0001306657985418527
Validation loss decreased (inf --> 0.6041).  Saving model state dict ...
Epoch: 1 cost time: 1.016446590423584
Epoch: 1, Steps: 123 | Train Loss: 0.7559780 Vali Loss: 0.6040806 Best vali loss: 0.6040806
	iters: 100, epoch: 2 | loss: 0.9372235
	speed: 0.0092s/iter; left time: 7.0224s
Updating learning rate to 0.0001159430551604163
Validation loss decreased (0.6041 --> 0.5827).  Saving model state dict ...
Epoch: 2 cost time: 0.7206149101257324
Epoch: 2, Steps: 123 | Train Loss: 0.9372235 Vali Loss: 0.5827165 Best vali loss: 0.5827165
	iters: 100, epoch: 3 | loss: 0.8639410
	speed: 0.0092s/iter; left time: 5.8929s
Updating learning rate to 9.390891257351339e-05
Validation loss decreased (0.5827 --> 0.5626).  Saving model state dict ...
Epoch: 3 cost time: 0.7132854461669922
Epoch: 3, Steps: 123 | Train Loss: 0.8639410 Vali Loss: 0.5625627 Best vali loss: 0.5625627

best validation loss 0.5625626574176045

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010774544212, 'e_layers': 2, 'learning_rate': 0.0005043952288, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6620070
	speed: 0.0099s/iter; left time: 18.3348s
	iters: 200, epoch: 1 | loss: 0.9813322
	speed: 0.0038s/iter; left time: 6.6418s
Updating learning rate to 0.0005043952288
Validation loss decreased (inf --> 0.5991).  Saving model state dict ...
Epoch: 1 cost time: 1.2527995109558105
Epoch: 1, Steps: 245 | Train Loss: 0.8216696 Vali Loss: 0.5990503 Best vali loss: 0.5990503
	iters: 100, epoch: 2 | loss: 0.7158584
	speed: 0.0079s/iter; left time: 12.7194s
	iters: 200, epoch: 2 | loss: 0.7255648
	speed: 0.0037s/iter; left time: 5.6427s
Updating learning rate to 0.0002521976144
Epoch: 2 cost time: 0.9626626968383789
Epoch: 2, Steps: 245 | Train Loss: 0.7207116 Vali Loss: 0.6207986 Best vali loss: 0.5990503
	iters: 100, epoch: 3 | loss: 0.7265448
	speed: 0.0074s/iter; left time: 10.1057s
	iters: 200, epoch: 3 | loss: 0.5579414
	speed: 0.0034s/iter; left time: 4.2870s
Updating learning rate to 0.0001260988072
Epoch: 3 cost time: 0.8714051246643066
Epoch: 3, Steps: 245 | Train Loss: 0.6422431 Vali Loss: 0.6045425 Best vali loss: 0.5990503

best validation loss 0.5990503313418949

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010761807032, 'e_layers': 2, 'learning_rate': 0.0004866467509, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6615998
	speed: 0.0101s/iter; left time: 18.8674s
	iters: 200, epoch: 1 | loss: 0.9776431
	speed: 0.0037s/iter; left time: 6.5896s
Updating learning rate to 0.0004866467509
Validation loss decreased (inf --> 0.5986).  Saving model state dict ...
Epoch: 1 cost time: 1.2737865447998047
Epoch: 1, Steps: 245 | Train Loss: 0.8196215 Vali Loss: 0.5986301 Best vali loss: 0.5986301
	iters: 100, epoch: 2 | loss: 0.7109386
	speed: 0.0076s/iter; left time: 12.3324s
	iters: 200, epoch: 2 | loss: 0.7394599
	speed: 0.0035s/iter; left time: 5.3081s
Updating learning rate to 0.00024332337545
Epoch: 2 cost time: 0.914419412612915
Epoch: 2, Steps: 245 | Train Loss: 0.7251993 Vali Loss: 0.6297448 Best vali loss: 0.5986301
	iters: 100, epoch: 3 | loss: 0.6795598
	speed: 0.0073s/iter; left time: 10.0420s
	iters: 200, epoch: 3 | loss: 0.5666620
	speed: 0.0034s/iter; left time: 4.3049s
Updating learning rate to 0.000121661687725
Validation loss decreased (0.5986 --> 0.5577).  Saving model state dict ...
Epoch: 3 cost time: 0.8727710247039795
Epoch: 3, Steps: 245 | Train Loss: 0.6231109 Vali Loss: 0.5576717 Best vali loss: 0.5576717

best validation loss 0.5576717257499695

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010761807032, 'e_layers': 2, 'learning_rate': 0.0004866467509, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6073618
	speed: 0.0101s/iter; left time: 11.3974s
	iters: 200, epoch: 4 | loss: 0.7709848
	speed: 0.0039s/iter; left time: 3.9814s
Updating learning rate to 6.08308438625e-05
Validation loss decreased (0.5577 --> 0.5476).  Saving model state dict ...
Epoch: 4 cost time: 1.2871010303497314
Epoch: 4, Steps: 245 | Train Loss: 0.6891733 Vali Loss: 0.5476194 Best vali loss: 0.5476194
	iters: 100, epoch: 5 | loss: 0.6310811
	speed: 0.0083s/iter; left time: 7.3011s
	iters: 200, epoch: 5 | loss: 0.6439108
	speed: 0.0039s/iter; left time: 3.0631s
Updating learning rate to 3.041542193125e-05
Validation loss decreased (0.5476 --> 0.5423).  Saving model state dict ...
Epoch: 5 cost time: 1.0107569694519043
Epoch: 5, Steps: 245 | Train Loss: 0.6374960 Vali Loss: 0.5422998 Best vali loss: 0.5422998
	iters: 100, epoch: 6 | loss: 0.6424786
	speed: 0.0081s/iter; left time: 5.1371s
	iters: 200, epoch: 6 | loss: 0.5464123
	speed: 0.0038s/iter; left time: 2.0378s
Updating learning rate to 1.5207710965625e-05
Validation loss decreased (0.5423 --> 0.5399).  Saving model state dict ...
Epoch: 6 cost time: 0.9802875518798828
Epoch: 6, Steps: 245 | Train Loss: 0.5944455 Vali Loss: 0.5399382 Best vali loss: 0.5399382
	iters: 100, epoch: 7 | loss: 0.5843968
	speed: 0.0081s/iter; left time: 3.1491s
	iters: 200, epoch: 7 | loss: 0.9581789
	speed: 0.0038s/iter; left time: 1.1154s
Updating learning rate to 7.6038554828125e-06
Validation loss decreased (0.5399 --> 0.5375).  Saving model state dict ...
Epoch: 7 cost time: 0.9784519672393799
Epoch: 7, Steps: 245 | Train Loss: 0.7712879 Vali Loss: 0.5375380 Best vali loss: 0.5375380
	iters: 100, epoch: 8 | loss: 0.8640050
	speed: 0.0080s/iter; left time: 1.1742s
	iters: 200, epoch: 8 | loss: 0.6761146
	speed: 0.0037s/iter; left time: 0.1704s
Updating learning rate to 3.80192774140625e-06
Validation loss decreased (0.5375 --> 0.5359).  Saving model state dict ...
Epoch: 8 cost time: 0.9494335651397705
Epoch: 8, Steps: 245 | Train Loss: 0.7700598 Vali Loss: 0.5359318 Best vali loss: 0.5359318

best validation loss 0.535931844807289

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010561726098, 'e_layers': 2, 'learning_rate': 0.000534091178, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005137635429245213
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.8478803634643555
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6048215 Best vali loss: 0.6048215
Updating learning rate to 0.0004558753358678557
Validation loss decreased (0.6048 --> 0.5669).  Saving model state dict ...
Epoch: 2 cost time: 0.5680375099182129
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5668658 Best vali loss: 0.5668658
Updating learning rate to 0.0003692395115964771
Validation loss decreased (0.5669 --> 0.5548).  Saving model state dict ...
Epoch: 3 cost time: 0.5695044994354248
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5547667 Best vali loss: 0.5547667
Updating learning rate to 0.000267045589
Epoch: 4 cost time: 0.5697555541992188
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5594385 Best vali loss: 0.5547667
Updating learning rate to 0.00016485166640352295
Validation loss decreased (0.5548 --> 0.5377).  Saving model state dict ...
Epoch: 5 cost time: 0.5618879795074463
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5376892 Best vali loss: 0.5376892
Updating learning rate to 7.821584213214431e-05
Epoch: 6 cost time: 0.5721938610076904
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5429216 Best vali loss: 0.5376892
Updating learning rate to 2.0327635075478785e-05
Epoch: 7 cost time: 0.5670278072357178
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5511680 Best vali loss: 0.5376892
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5720372200012207
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5571553 Best vali loss: 0.5376892

best validation loss 0.5376891550340348

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043740143138, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7617005
	speed: 0.0118s/iter; left time: 10.4173s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0210273265838623
Epoch: 1, Steps: 123 | Train Loss: 0.7617005 Vali Loss: 0.6075785 Best vali loss: 0.6075785
	iters: 100, epoch: 2 | loss: 0.9357197
	speed: 0.0093s/iter; left time: 7.0720s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.6076 --> 0.5688).  Saving model state dict ...
Epoch: 2 cost time: 0.7241175174713135
Epoch: 2, Steps: 123 | Train Loss: 0.9357197 Vali Loss: 0.5687696 Best vali loss: 0.5687696
	iters: 100, epoch: 3 | loss: 0.8565090
	speed: 0.0093s/iter; left time: 5.9734s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.5688 --> 0.5380).  Saving model state dict ...
Epoch: 3 cost time: 0.7248551845550537
Epoch: 3, Steps: 123 | Train Loss: 0.8565090 Vali Loss: 0.5379680 Best vali loss: 0.5379680
	iters: 100, epoch: 4 | loss: 0.4972576
	speed: 0.0093s/iter; left time: 4.8031s
Updating learning rate to 8.79643783e-05
Epoch: 4 cost time: 0.7226543426513672
Epoch: 4, Steps: 123 | Train Loss: 0.4972576 Vali Loss: 0.5400096 Best vali loss: 0.5379680
	iters: 100, epoch: 5 | loss: 0.5725086
	speed: 0.0091s/iter; left time: 3.5716s
Updating learning rate to 5.430186808629478e-05
Validation loss decreased (0.5380 --> 0.5328).  Saving model state dict ...
Epoch: 5 cost time: 0.7319247722625732
Epoch: 5, Steps: 123 | Train Loss: 0.5725086 Vali Loss: 0.5328348 Best vali loss: 0.5328348
	iters: 100, epoch: 6 | loss: 0.6223175
	speed: 0.0093s/iter; left time: 2.5139s
Updating learning rate to 2.5764169901211216e-05
Validation loss decreased (0.5328 --> 0.5301).  Saving model state dict ...
Epoch: 6 cost time: 0.716494083404541
Epoch: 6, Steps: 123 | Train Loss: 0.6223175 Vali Loss: 0.5300561 Best vali loss: 0.5300561
	iters: 100, epoch: 7 | loss: 0.5779909
	speed: 0.0095s/iter; left time: 1.3911s
Updating learning rate to 6.695889598550024e-06
Validation loss decreased (0.5301 --> 0.5258).  Saving model state dict ...
Epoch: 7 cost time: 0.7262742519378662
Epoch: 7, Steps: 123 | Train Loss: 0.5779909 Vali Loss: 0.5258148 Best vali loss: 0.5258148
	iters: 100, epoch: 8 | loss: 0.7418841
	speed: 0.0094s/iter; left time: 0.2247s
Updating learning rate to 0.0
Validation loss decreased (0.5258 --> 0.5228).  Saving model state dict ...
Epoch: 8 cost time: 0.7244198322296143
Epoch: 8, Steps: 123 | Train Loss: 0.7418841 Vali Loss: 0.5228301 Best vali loss: 0.5228301

best validation loss 0.5228300577289029

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0015199245426, 'e_layers': 2, 'learning_rate': 0.0022706875999, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7604747
	speed: 0.0104s/iter; left time: 9.1744s
Updating learning rate to 0.002184264699087394
Validation loss decreased (inf --> 0.6211).  Saving model state dict ...
Epoch: 1 cost time: 0.8642418384552002
Epoch: 1, Steps: 123 | Train Loss: 0.7604747 Vali Loss: 0.6210922 Best vali loss: 0.6210922
	iters: 100, epoch: 2 | loss: 0.7349844
	speed: 0.0078s/iter; left time: 5.9402s
Updating learning rate to 0.0019381530998727478
Validation loss decreased (0.6211 --> 0.5927).  Saving model state dict ...
Epoch: 2 cost time: 0.6077091693878174
Epoch: 2, Steps: 123 | Train Loss: 0.7349844 Vali Loss: 0.5926664 Best vali loss: 0.5926664
	iters: 100, epoch: 3 | loss: 0.9077071
	speed: 0.0073s/iter; left time: 4.6431s
Updating learning rate to 0.0015698210622292898
Epoch: 3 cost time: 0.553718090057373
Epoch: 3, Steps: 123 | Train Loss: 0.9077071 Vali Loss: 0.6176000 Best vali loss: 0.5926664

best validation loss 0.5926664306410261

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 4, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7512401
	speed: 0.0162s/iter; left time: 14.3493s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6093).  Saving model state dict ...
Epoch: 1 cost time: 1.581528663635254
Epoch: 1, Steps: 123 | Train Loss: 0.7512401 Vali Loss: 0.6092786 Best vali loss: 0.6092786
	iters: 100, epoch: 2 | loss: 0.9699922
	speed: 0.0153s/iter; left time: 11.6873s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6093 --> 0.5900).  Saving model state dict ...
Epoch: 2 cost time: 1.2713077068328857
Epoch: 2, Steps: 123 | Train Loss: 0.9699922 Vali Loss: 0.5900473 Best vali loss: 0.5900473
	iters: 100, epoch: 3 | loss: 0.7677801
	speed: 0.0156s/iter; left time: 9.9840s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 1.2734019756317139
Epoch: 3, Steps: 123 | Train Loss: 0.7677801 Vali Loss: 0.6152870 Best vali loss: 0.5900473

best validation loss 0.5900472611092351

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014893961922, 'e_layers': 2, 'learning_rate': 6.48025687e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8967587
	speed: 0.0102s/iter; left time: 18.9547s
	iters: 200, epoch: 1 | loss: 0.6661384
	speed: 0.0040s/iter; left time: 7.0618s
Updating learning rate to 6.233616778804327e-05
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.3417162895202637
Epoch: 1, Steps: 245 | Train Loss: 0.7814485 Vali Loss: 0.6040156 Best vali loss: 0.6040156
	iters: 100, epoch: 2 | loss: 0.7573119
	speed: 0.0089s/iter; left time: 14.3892s
	iters: 200, epoch: 2 | loss: 0.9329991
	speed: 0.0043s/iter; left time: 6.5841s
Updating learning rate to 5.531245223303855e-05
Validation loss decreased (0.6040 --> 0.5998).  Saving model state dict ...
Epoch: 2 cost time: 1.102484941482544
Epoch: 2, Steps: 245 | Train Loss: 0.8451555 Vali Loss: 0.5998147 Best vali loss: 0.5998147
	iters: 100, epoch: 3 | loss: 0.7721846
	speed: 0.0091s/iter; left time: 12.4676s
	iters: 200, epoch: 3 | loss: 0.9189001
	speed: 0.0041s/iter; left time: 5.1864s
Updating learning rate to 4.4800719058095264e-05
Validation loss decreased (0.5998 --> 0.5664).  Saving model state dict ...
Epoch: 3 cost time: 1.0486657619476318
Epoch: 3, Steps: 245 | Train Loss: 0.8455423 Vali Loss: 0.5664372 Best vali loss: 0.5664372

best validation loss 0.5664372221014666

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014893961922, 'e_layers': 2, 'learning_rate': 6.48025687e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8502887
	speed: 0.0106s/iter; left time: 11.9717s
	iters: 200, epoch: 4 | loss: 0.5426363
	speed: 0.0042s/iter; left time: 4.3053s
Updating learning rate to 3.240128435e-05
Validation loss decreased (0.5664 --> 0.5408).  Saving model state dict ...
Epoch: 4 cost time: 1.3814895153045654
Epoch: 4, Steps: 245 | Train Loss: 0.6964625 Vali Loss: 0.5408193 Best vali loss: 0.5408193
	iters: 100, epoch: 5 | loss: 0.6779460
	speed: 0.0091s/iter; left time: 8.0505s
	iters: 200, epoch: 5 | loss: 0.8624044
	speed: 0.0041s/iter; left time: 3.2391s
Updating learning rate to 2.0001849641904735e-05
Epoch: 5 cost time: 1.0522842407226562
Epoch: 5, Steps: 245 | Train Loss: 0.7701752 Vali Loss: 0.5417474 Best vali loss: 0.5408193
	iters: 100, epoch: 6 | loss: 0.7344375
	speed: 0.0089s/iter; left time: 5.6747s
	iters: 200, epoch: 6 | loss: 0.8969197
	speed: 0.0041s/iter; left time: 2.2173s
Updating learning rate to 9.490116466961445e-06
Validation loss decreased (0.5408 --> 0.5408).  Saving model state dict ...
Epoch: 6 cost time: 1.0774614810943604
Epoch: 6, Steps: 245 | Train Loss: 0.8156786 Vali Loss: 0.5408077 Best vali loss: 0.5408077
	iters: 100, epoch: 7 | loss: 0.6322314
	speed: 0.0090s/iter; left time: 3.5380s
	iters: 200, epoch: 7 | loss: 0.5458377
	speed: 0.0040s/iter; left time: 1.1633s
Updating learning rate to 2.4664009119567286e-06
Epoch: 7 cost time: 1.0278074741363525
Epoch: 7, Steps: 245 | Train Loss: 0.5890346 Vali Loss: 0.5451930 Best vali loss: 0.5408077
	iters: 100, epoch: 8 | loss: 0.7603128
	speed: 0.0084s/iter; left time: 1.2279s
	iters: 200, epoch: 8 | loss: 0.5971813
	speed: 0.0040s/iter; left time: 0.1837s
Updating learning rate to 0.0
Validation loss decreased (0.5408 --> 0.5401).  Saving model state dict ...
Epoch: 8 cost time: 1.021986722946167
Epoch: 8, Steps: 245 | Train Loss: 0.6787471 Vali Loss: 0.5401243 Best vali loss: 0.5401243

best validation loss 0.5401243086437117

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0026642590798, 'e_layers': 3, 'learning_rate': 0.0027649409477, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6945995
	speed: 0.0105s/iter; left time: 81.0215s
	iters: 200, epoch: 1 | loss: 1.0157349
	speed: 0.0045s/iter; left time: 34.3044s
	iters: 300, epoch: 1 | loss: 0.6599513
	speed: 0.0044s/iter; left time: 33.3842s
	iters: 400, epoch: 1 | loss: 1.5296301
	speed: 0.0042s/iter; left time: 31.1433s
	iters: 500, epoch: 1 | loss: 0.9031796
	speed: 0.0040s/iter; left time: 29.3878s
	iters: 600, epoch: 1 | loss: 1.4627663
	speed: 0.0038s/iter; left time: 27.8243s
	iters: 700, epoch: 1 | loss: 2.1483595
	speed: 0.0038s/iter; left time: 27.4094s
	iters: 800, epoch: 1 | loss: 0.6430246
	speed: 0.0037s/iter; left time: 26.2239s
	iters: 900, epoch: 1 | loss: 0.9437203
	speed: 0.0037s/iter; left time: 25.7687s
Updating learning rate to 0.0027649409477
Validation loss decreased (inf --> 0.6566).  Saving model state dict ...
Epoch: 1 cost time: 4.302583456039429
Epoch: 1, Steps: 979 | Train Loss: 1.1112185 Vali Loss: 0.6566264 Best vali loss: 0.6566264
	iters: 100, epoch: 2 | loss: 0.3027433
	speed: 0.0131s/iter; left time: 88.3146s
	iters: 200, epoch: 2 | loss: 0.6013348
	speed: 0.0043s/iter; left time: 28.4236s
	iters: 300, epoch: 2 | loss: 0.7107551
	speed: 0.0044s/iter; left time: 28.9164s
	iters: 400, epoch: 2 | loss: 0.5705054
	speed: 0.0044s/iter; left time: 28.0924s
	iters: 500, epoch: 2 | loss: 0.4403690
	speed: 0.0044s/iter; left time: 28.0600s
	iters: 600, epoch: 2 | loss: 1.2190167
	speed: 0.0044s/iter; left time: 27.7339s
	iters: 700, epoch: 2 | loss: 0.8502428
	speed: 0.0043s/iter; left time: 26.6819s
	iters: 800, epoch: 2 | loss: 0.9524426
	speed: 0.0044s/iter; left time: 26.4643s
	iters: 900, epoch: 2 | loss: 0.8406603
	speed: 0.0042s/iter; left time: 25.2916s
Updating learning rate to 0.00138247047385
Validation loss decreased (0.6566 --> 0.6399).  Saving model state dict ...
Epoch: 2 cost time: 4.275222301483154
Epoch: 2, Steps: 979 | Train Loss: 0.7208966 Vali Loss: 0.6399344 Best vali loss: 0.6399344
	iters: 100, epoch: 3 | loss: 0.5672691
	speed: 0.0132s/iter; left time: 76.1320s
	iters: 200, epoch: 3 | loss: 0.7908642
	speed: 0.0041s/iter; left time: 23.4664s
	iters: 300, epoch: 3 | loss: 0.6281437
	speed: 0.0041s/iter; left time: 22.6075s
	iters: 400, epoch: 3 | loss: 1.0058497
	speed: 0.0041s/iter; left time: 22.1877s
	iters: 500, epoch: 3 | loss: 0.8706857
	speed: 0.0040s/iter; left time: 21.4402s
	iters: 600, epoch: 3 | loss: 1.4337397
	speed: 0.0041s/iter; left time: 21.6653s
	iters: 700, epoch: 3 | loss: 1.3821267
	speed: 0.0039s/iter; left time: 20.3287s
	iters: 800, epoch: 3 | loss: 1.1692207
	speed: 0.0038s/iter; left time: 19.2599s
	iters: 900, epoch: 3 | loss: 0.3402337
	speed: 0.0038s/iter; left time: 18.8281s
Updating learning rate to 0.000691235236925
Validation loss decreased (0.6399 --> 0.6343).  Saving model state dict ...
Epoch: 3 cost time: 3.9443788528442383
Epoch: 3, Steps: 979 | Train Loss: 0.9097926 Vali Loss: 0.6342933 Best vali loss: 0.6342933
	iters: 100, epoch: 4 | loss: 0.3878413
	speed: 0.0139s/iter; left time: 66.4517s
	iters: 200, epoch: 4 | loss: 0.6113203
	speed: 0.0042s/iter; left time: 19.7728s
	iters: 300, epoch: 4 | loss: 0.2701707
	speed: 0.0043s/iter; left time: 19.9753s
	iters: 400, epoch: 4 | loss: 0.8388829
	speed: 0.0044s/iter; left time: 19.7583s
	iters: 500, epoch: 4 | loss: 0.9577592
	speed: 0.0042s/iter; left time: 18.6565s
	iters: 600, epoch: 4 | loss: 0.8046520
	speed: 0.0042s/iter; left time: 17.9603s
	iters: 700, epoch: 4 | loss: 1.1936018
	speed: 0.0042s/iter; left time: 17.6717s
	iters: 800, epoch: 4 | loss: 0.9010803
	speed: 0.0041s/iter; left time: 16.7522s
	iters: 900, epoch: 4 | loss: 0.4788709
	speed: 0.0038s/iter; left time: 15.0260s
Updating learning rate to 0.0003456176184625
Epoch: 4 cost time: 4.121661424636841
Epoch: 4, Steps: 979 | Train Loss: 0.7160199 Vali Loss: 0.6473512 Best vali loss: 0.6342933
	iters: 100, epoch: 5 | loss: 1.0065955
	speed: 0.0135s/iter; left time: 51.3647s
	iters: 200, epoch: 5 | loss: 1.2796175
	speed: 0.0044s/iter; left time: 16.3613s
	iters: 300, epoch: 5 | loss: 0.5954923
	speed: 0.0043s/iter; left time: 15.5677s
	iters: 400, epoch: 5 | loss: 0.6046908
	speed: 0.0043s/iter; left time: 15.2411s
	iters: 500, epoch: 5 | loss: 1.2917848
	speed: 0.0039s/iter; left time: 13.4631s
	iters: 600, epoch: 5 | loss: 0.6465690
	speed: 0.0039s/iter; left time: 12.9748s
	iters: 700, epoch: 5 | loss: 0.7454013
	speed: 0.0041s/iter; left time: 13.1671s
	iters: 800, epoch: 5 | loss: 0.6825230
	speed: 0.0042s/iter; left time: 12.9641s
	iters: 900, epoch: 5 | loss: 1.1078326
	speed: 0.0040s/iter; left time: 12.0697s
Updating learning rate to 0.00017280880923125
Epoch: 5 cost time: 4.124016284942627
Epoch: 5, Steps: 979 | Train Loss: 0.8845007 Vali Loss: 0.6408783 Best vali loss: 0.6342933
	iters: 100, epoch: 6 | loss: 0.6708668
	speed: 0.0130s/iter; left time: 36.8538s
	iters: 200, epoch: 6 | loss: 0.6080514
	speed: 0.0040s/iter; left time: 10.8280s
	iters: 300, epoch: 6 | loss: 1.0244499
	speed: 0.0039s/iter; left time: 10.4039s
	iters: 400, epoch: 6 | loss: 1.2361833
	speed: 0.0040s/iter; left time: 10.0631s
	iters: 500, epoch: 6 | loss: 1.0712081
	speed: 0.0039s/iter; left time: 9.6068s
	iters: 600, epoch: 6 | loss: 0.4369409
	speed: 0.0041s/iter; left time: 9.5905s
	iters: 700, epoch: 6 | loss: 0.4028310
	speed: 0.0039s/iter; left time: 8.7440s
	iters: 800, epoch: 6 | loss: 1.3217239
	speed: 0.0038s/iter; left time: 8.1837s
	iters: 900, epoch: 6 | loss: 0.6540126
	speed: 0.0040s/iter; left time: 8.0917s
Updating learning rate to 8.6404404615625e-05
Epoch: 6 cost time: 3.9071848392486572
Epoch: 6, Steps: 979 | Train Loss: 0.8251409 Vali Loss: 0.6417809 Best vali loss: 0.6342933
	iters: 100, epoch: 7 | loss: 0.5616237
	speed: 0.0130s/iter; left time: 24.1326s
	iters: 200, epoch: 7 | loss: 1.0610832
	speed: 0.0041s/iter; left time: 7.2821s
	iters: 300, epoch: 7 | loss: 1.7597179
	speed: 0.0041s/iter; left time: 6.8658s
	iters: 400, epoch: 7 | loss: 0.4347430
	speed: 0.0041s/iter; left time: 6.4046s
	iters: 500, epoch: 7 | loss: 1.7736894
	speed: 0.0040s/iter; left time: 5.9029s
	iters: 600, epoch: 7 | loss: 0.3440829
	speed: 0.0041s/iter; left time: 5.5425s
	iters: 700, epoch: 7 | loss: 0.4866686
	speed: 0.0041s/iter; left time: 5.1976s
	iters: 800, epoch: 7 | loss: 0.5046394
	speed: 0.0040s/iter; left time: 4.6896s
	iters: 900, epoch: 7 | loss: 0.4680735
	speed: 0.0041s/iter; left time: 4.3115s
Updating learning rate to 4.32022023078125e-05
Epoch: 7 cost time: 4.05220365524292
Epoch: 7, Steps: 979 | Train Loss: 0.8215913 Vali Loss: 0.6435534 Best vali loss: 0.6342933
	iters: 100, epoch: 8 | loss: 1.0722659
	speed: 0.0134s/iter; left time: 11.7534s
	iters: 200, epoch: 8 | loss: 1.6525728
	speed: 0.0043s/iter; left time: 3.3642s
	iters: 300, epoch: 8 | loss: 0.7171362
	speed: 0.0044s/iter; left time: 2.9709s
	iters: 400, epoch: 8 | loss: 0.8843805
	speed: 0.0043s/iter; left time: 2.5218s
	iters: 500, epoch: 8 | loss: 0.6837444
	speed: 0.0044s/iter; left time: 2.1157s
	iters: 600, epoch: 8 | loss: 0.9652755
	speed: 0.0044s/iter; left time: 1.6734s
	iters: 700, epoch: 8 | loss: 1.3113127
	speed: 0.0044s/iter; left time: 1.2306s
	iters: 800, epoch: 8 | loss: 0.5288196
	speed: 0.0044s/iter; left time: 0.7912s
	iters: 900, epoch: 8 | loss: 1.3971325
	speed: 0.0044s/iter; left time: 0.3518s
Updating learning rate to 2.160110115390625e-05
Epoch: 8 cost time: 4.3262903690338135
Epoch: 8, Steps: 979 | Train Loss: 1.0236267 Vali Loss: 0.6435669 Best vali loss: 0.6342933

best validation loss 0.6342933439976747

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0038334920541, 'e_layers': 2, 'learning_rate': 0.0004636194637, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00044597399854314477
Validation loss decreased (inf --> 0.6564).  Saving model state dict ...
Epoch: 1 cost time: 0.7091808319091797
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6563807 Best vali loss: 0.6563807
Updating learning rate to 0.0003957239651861702
Validation loss decreased (0.6564 --> 0.6319).  Saving model state dict ...
Epoch: 2 cost time: 0.4282212257385254
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6318757 Best vali loss: 0.6318757
Updating learning rate to 0.0003205194756899891
Validation loss decreased (0.6319 --> 0.6135).  Saving model state dict ...
Epoch: 3 cost time: 0.4456350803375244
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6135028 Best vali loss: 0.6135028
Updating learning rate to 0.00023180973185
Validation loss decreased (0.6135 --> 0.6099).  Saving model state dict ...
Epoch: 4 cost time: 0.44622302055358887
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6099180 Best vali loss: 0.6099180
Updating learning rate to 0.00014309998801001096
Validation loss decreased (0.6099 --> 0.6032).  Saving model state dict ...
Epoch: 5 cost time: 0.4396364688873291
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6031930 Best vali loss: 0.6031930
Updating learning rate to 6.789549851382981e-05
Validation loss decreased (0.6032 --> 0.6028).  Saving model state dict ...
Epoch: 6 cost time: 0.4238600730895996
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6027763 Best vali loss: 0.6027763
Updating learning rate to 1.7645465156855265e-05
Epoch: 7 cost time: 0.4407837390899658
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6059756 Best vali loss: 0.6027763
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4247734546661377
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6050465 Best vali loss: 0.6027763

best validation loss 0.6027763183058439

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010779428029, 'e_layers': 2, 'learning_rate': 0.0001715902271, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0382110
	speed: 0.0100s/iter; left time: 18.6204s
	iters: 200, epoch: 1 | loss: 0.7456897
	speed: 0.0041s/iter; left time: 7.1708s
Updating learning rate to 0.00016505946294832676
Validation loss decreased (inf --> 0.6022).  Saving model state dict ...
Epoch: 1 cost time: 1.3362090587615967
Epoch: 1, Steps: 245 | Train Loss: 0.8919503 Vali Loss: 0.6021618 Best vali loss: 0.6021618
	iters: 100, epoch: 2 | loss: 0.7526377
	speed: 0.0084s/iter; left time: 13.6000s
	iters: 200, epoch: 2 | loss: 1.0365489
	speed: 0.0039s/iter; left time: 5.8434s
Updating learning rate to 0.00014646142013387484
Validation loss decreased (0.6022 --> 0.5793).  Saving model state dict ...
Epoch: 2 cost time: 1.0037553310394287
Epoch: 2, Steps: 245 | Train Loss: 0.8945933 Vali Loss: 0.5792699 Best vali loss: 0.5792699
	iters: 100, epoch: 3 | loss: 0.7959074
	speed: 0.0084s/iter; left time: 11.5817s
	iters: 200, epoch: 3 | loss: 0.5066277
	speed: 0.0040s/iter; left time: 5.1261s
Updating learning rate to 0.00011862748208346663
Epoch: 3 cost time: 1.026932954788208
Epoch: 3, Steps: 245 | Train Loss: 0.6512675 Vali Loss: 0.5838224 Best vali loss: 0.5792699

best validation loss 0.5792699000146972

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021046490144, 'e_layers': 2, 'learning_rate': 9.0100268e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5049618
	speed: 0.0097s/iter; left time: 37.0401s
	iters: 200, epoch: 1 | loss: 1.1659715
	speed: 0.0038s/iter; left time: 14.0282s
	iters: 300, epoch: 1 | loss: 0.8978682
	speed: 0.0036s/iter; left time: 13.0245s
	iters: 400, epoch: 1 | loss: 0.9293476
	speed: 0.0038s/iter; left time: 13.2329s
Updating learning rate to 9.0100268e-05
Validation loss decreased (inf --> 0.6055).  Saving model state dict ...
Epoch: 1 cost time: 2.167381763458252
Epoch: 1, Steps: 490 | Train Loss: 1.1245373 Vali Loss: 0.6055441 Best vali loss: 0.6055441
	iters: 100, epoch: 2 | loss: 0.2844088
	speed: 0.0108s/iter; left time: 35.9027s
	iters: 200, epoch: 2 | loss: 1.0501155
	speed: 0.0038s/iter; left time: 12.3608s
	iters: 300, epoch: 2 | loss: 1.0534993
	speed: 0.0038s/iter; left time: 11.9502s
	iters: 400, epoch: 2 | loss: 0.3586623
	speed: 0.0037s/iter; left time: 11.2214s
Updating learning rate to 4.5050134e-05
Validation loss decreased (0.6055 --> 0.5795).  Saving model state dict ...
Epoch: 2 cost time: 1.8877382278442383
Epoch: 2, Steps: 490 | Train Loss: 0.6866715 Vali Loss: 0.5795343 Best vali loss: 0.5795343
	iters: 100, epoch: 3 | loss: 0.9875322
	speed: 0.0110s/iter; left time: 31.1235s
	iters: 200, epoch: 3 | loss: 0.9133386
	speed: 0.0037s/iter; left time: 10.1032s
	iters: 300, epoch: 3 | loss: 0.3534609
	speed: 0.0037s/iter; left time: 9.7218s
	iters: 400, epoch: 3 | loss: 1.4969331
	speed: 0.0038s/iter; left time: 9.5726s
Updating learning rate to 2.2525067e-05
Validation loss decreased (0.5795 --> 0.5474).  Saving model state dict ...
Epoch: 3 cost time: 1.867114782333374
Epoch: 3, Steps: 490 | Train Loss: 0.9378162 Vali Loss: 0.5474260 Best vali loss: 0.5474260

best validation loss 0.5474259716694359

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.006708929712, 'e_layers': 2, 'learning_rate': 7.94550835e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.643100444981262e-05
Validation loss decreased (inf --> 0.6294).  Saving model state dict ...
Epoch: 1 cost time: 0.7308804988861084
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6293988 Best vali loss: 0.6293988
Updating learning rate to 6.781915592129668e-05
Validation loss decreased (0.6294 --> 0.6083).  Saving model state dict ...
Epoch: 2 cost time: 0.4299437999725342
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6083144 Best vali loss: 0.6083144
Updating learning rate to 5.49306137863174e-05
Validation loss decreased (0.6083 --> 0.6037).  Saving model state dict ...
Epoch: 3 cost time: 0.42662882804870605
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6036586 Best vali loss: 0.6036586

best validation loss 0.6036585857613337

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021046490144, 'e_layers': 2, 'learning_rate': 9.0100268e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3989980
	speed: 0.0101s/iter; left time: 23.6745s
	iters: 200, epoch: 4 | loss: 1.0748038
	speed: 0.0034s/iter; left time: 7.5584s
	iters: 300, epoch: 4 | loss: 0.8735482
	speed: 0.0036s/iter; left time: 7.7993s
	iters: 400, epoch: 4 | loss: 0.6735716
	speed: 0.0040s/iter; left time: 8.2034s
Updating learning rate to 1.12625335e-05
Validation loss decreased (0.5474 --> 0.5371).  Saving model state dict ...
Epoch: 4 cost time: 2.1640119552612305
Epoch: 4, Steps: 490 | Train Loss: 1.0052304 Vali Loss: 0.5370966 Best vali loss: 0.5370966
	iters: 100, epoch: 5 | loss: 0.2677028
	speed: 0.0106s/iter; left time: 19.6388s
	iters: 200, epoch: 5 | loss: 0.9677231
	speed: 0.0033s/iter; left time: 5.7364s
	iters: 300, epoch: 5 | loss: 1.0136325
	speed: 0.0034s/iter; left time: 5.7153s
	iters: 400, epoch: 5 | loss: 0.3262451
	speed: 0.0034s/iter; left time: 5.3531s
Updating learning rate to 5.63126675e-06
Epoch: 5 cost time: 1.6850526332855225
Epoch: 5, Steps: 490 | Train Loss: 0.6438259 Vali Loss: 0.5408370 Best vali loss: 0.5370966
	iters: 100, epoch: 6 | loss: 0.9725890
	speed: 0.0098s/iter; left time: 13.3985s
	iters: 200, epoch: 6 | loss: 0.9031902
	speed: 0.0033s/iter; left time: 4.1942s
	iters: 300, epoch: 6 | loss: 0.3534617
	speed: 0.0033s/iter; left time: 3.8145s
	iters: 400, epoch: 6 | loss: 1.4781955
	speed: 0.0033s/iter; left time: 3.5735s
Updating learning rate to 2.815633375e-06
Epoch: 6 cost time: 1.6608693599700928
Epoch: 6, Steps: 490 | Train Loss: 0.9268591 Vali Loss: 0.5429201 Best vali loss: 0.5370966
	iters: 100, epoch: 7 | loss: 0.5111549
	speed: 0.0101s/iter; left time: 8.9389s
	iters: 200, epoch: 7 | loss: 0.7518139
	speed: 0.0038s/iter; left time: 2.9925s
	iters: 300, epoch: 7 | loss: 0.9102377
	speed: 0.0039s/iter; left time: 2.6281s
	iters: 400, epoch: 7 | loss: 0.5797808
	speed: 0.0038s/iter; left time: 2.1910s
Updating learning rate to 1.4078166875e-06
Epoch: 7 cost time: 1.8782954216003418
Epoch: 7, Steps: 490 | Train Loss: 0.6882468 Vali Loss: 0.5418071 Best vali loss: 0.5370966
	iters: 100, epoch: 8 | loss: 0.5001577
	speed: 0.0097s/iter; left time: 3.7971s
	iters: 200, epoch: 8 | loss: 0.6788265
	speed: 0.0033s/iter; left time: 0.9541s
	iters: 300, epoch: 8 | loss: 0.6470949
	speed: 0.0034s/iter; left time: 0.6454s
	iters: 400, epoch: 8 | loss: 0.7987638
	speed: 0.0032s/iter; left time: 0.2909s
Updating learning rate to 7.0390834375e-07
Epoch: 8 cost time: 1.6566174030303955
Epoch: 8, Steps: 490 | Train Loss: 0.6562107 Vali Loss: 0.5422159 Best vali loss: 0.5370966

best validation loss 0.5370965878108981

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001759366755, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7616690
	speed: 0.0118s/iter; left time: 10.4204s
Updating learning rate to 0.00016924048450626497
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 1.0200707912445068
Epoch: 1, Steps: 123 | Train Loss: 0.7616690 Vali Loss: 0.6075868 Best vali loss: 0.6075868
	iters: 100, epoch: 2 | loss: 0.9350821
	speed: 0.0091s/iter; left time: 6.9346s
Updating learning rate to 0.00015017134590273356
Validation loss decreased (0.6076 --> 0.5722).  Saving model state dict ...
Epoch: 2 cost time: 0.7106523513793945
Epoch: 2, Steps: 123 | Train Loss: 0.9350821 Vali Loss: 0.5722235 Best vali loss: 0.5722235
	iters: 100, epoch: 3 | loss: 0.8557976
	speed: 0.0093s/iter; left time: 5.9526s
Updating learning rate to 0.00012163236317962151
Validation loss decreased (0.5722 --> 0.5470).  Saving model state dict ...
Epoch: 3 cost time: 0.7235164642333984
Epoch: 3, Steps: 123 | Train Loss: 0.8557976 Vali Loss: 0.5470254 Best vali loss: 0.5470254
	iters: 100, epoch: 4 | loss: 0.5034769
	speed: 0.0092s/iter; left time: 4.7648s
Updating learning rate to 8.796833775e-05
Validation loss decreased (0.5470 --> 0.5433).  Saving model state dict ...
Epoch: 4 cost time: 0.7154910564422607
Epoch: 4, Steps: 123 | Train Loss: 0.5034769 Vali Loss: 0.5433170 Best vali loss: 0.5433170
	iters: 100, epoch: 5 | loss: 0.5747248
	speed: 0.0093s/iter; left time: 3.6466s
Updating learning rate to 5.4304312320378504e-05
Validation loss decreased (0.5433 --> 0.5299).  Saving model state dict ...
Epoch: 5 cost time: 0.7152633666992188
Epoch: 5, Steps: 123 | Train Loss: 0.5747248 Vali Loss: 0.5298523 Best vali loss: 0.5298523
	iters: 100, epoch: 6 | loss: 0.6223357
	speed: 0.0093s/iter; left time: 2.5028s
Updating learning rate to 2.5765329597266446e-05
Validation loss decreased (0.5299 --> 0.5297).  Saving model state dict ...
Epoch: 6 cost time: 0.7190637588500977
Epoch: 6, Steps: 123 | Train Loss: 0.6223357 Vali Loss: 0.5296687 Best vali loss: 0.5296687
	iters: 100, epoch: 7 | loss: 0.5761791
	speed: 0.0092s/iter; left time: 1.3573s
Updating learning rate to 6.696190993735022e-06
Validation loss decreased (0.5297 --> 0.5265).  Saving model state dict ...
Epoch: 7 cost time: 0.7198183536529541
Epoch: 7, Steps: 123 | Train Loss: 0.5761791 Vali Loss: 0.5265205 Best vali loss: 0.5265205
	iters: 100, epoch: 8 | loss: 0.7448174
	speed: 0.0093s/iter; left time: 0.2234s
Updating learning rate to 0.0
Validation loss decreased (0.5265 --> 0.5248).  Saving model state dict ...
Epoch: 8 cost time: 0.7236208915710449
Epoch: 8, Steps: 123 | Train Loss: 0.7448174 Vali Loss: 0.5247968 Best vali loss: 0.5247968

best validation loss 0.524796817050053

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0061317062879, 'e_layers': 2, 'learning_rate': 0.0004337140399, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7257752
	speed: 0.0116s/iter; left time: 10.2679s
Updating learning rate to 0.0004172067821631968
Validation loss decreased (inf --> 0.6241).  Saving model state dict ...
Epoch: 1 cost time: 1.0191311836242676
Epoch: 1, Steps: 123 | Train Loss: 0.7257752 Vali Loss: 0.6240507 Best vali loss: 0.6240507
	iters: 100, epoch: 2 | loss: 0.8635138
	speed: 0.0092s/iter; left time: 7.0292s
Updating learning rate to 0.0003701980893045514
Epoch: 2 cost time: 0.726966142654419
Epoch: 2, Steps: 123 | Train Loss: 0.8635138 Vali Loss: 0.6273551 Best vali loss: 0.6240507
	iters: 100, epoch: 3 | loss: 0.9664609
	speed: 0.0089s/iter; left time: 5.6702s
Updating learning rate to 0.00029984460867693075
Validation loss decreased (0.6241 --> 0.5394).  Saving model state dict ...
Epoch: 3 cost time: 0.7134966850280762
Epoch: 3, Steps: 123 | Train Loss: 0.9664609 Vali Loss: 0.5394289 Best vali loss: 0.5394289
	iters: 100, epoch: 4 | loss: 0.5843225
	speed: 0.0094s/iter; left time: 4.8470s
Updating learning rate to 0.00021685701995
Epoch: 4 cost time: 0.7266173362731934
Epoch: 4, Steps: 123 | Train Loss: 0.5843225 Vali Loss: 0.5552737 Best vali loss: 0.5394289
	iters: 100, epoch: 5 | loss: 0.7293656
	speed: 0.0090s/iter; left time: 3.5529s
Updating learning rate to 0.00013386943122306927
Epoch: 5 cost time: 0.7196424007415771
Epoch: 5, Steps: 123 | Train Loss: 0.7293656 Vali Loss: 0.5464981 Best vali loss: 0.5394289
	iters: 100, epoch: 6 | loss: 0.6651360
	speed: 0.0090s/iter; left time: 2.4169s
Updating learning rate to 6.351595059544859e-05
Epoch: 6 cost time: 0.7277803421020508
Epoch: 6, Steps: 123 | Train Loss: 0.6651360 Vali Loss: 0.5530637 Best vali loss: 0.5394289
	iters: 100, epoch: 7 | loss: 0.7507287
	speed: 0.0091s/iter; left time: 1.3322s
Updating learning rate to 1.650725773680322e-05
Epoch: 7 cost time: 0.7236166000366211
Epoch: 7, Steps: 123 | Train Loss: 0.7507287 Vali Loss: 0.5522826 Best vali loss: 0.5394289
	iters: 100, epoch: 8 | loss: 0.8325754
	speed: 0.0090s/iter; left time: 0.2165s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7226011753082275
Epoch: 8, Steps: 123 | Train Loss: 0.8325754 Vali Loss: 0.5541183 Best vali loss: 0.5394289

best validation loss 0.5394289381302159

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.008311728778, 'e_layers': 4, 'learning_rate': 0.0017994385058, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0017309514556606562
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 0.8011183738708496
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6019363 Best vali loss: 0.6019363
Updating learning rate to 0.0015359168377896842
Validation loss decreased (0.6019 --> 0.5876).  Saving model state dict ...
Epoch: 2 cost time: 0.5055782794952393
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5876132 Best vali loss: 0.5876132
Updating learning rate to 0.0012440269047647263
Validation loss decreased (0.5876 --> 0.5703).  Saving model state dict ...
Epoch: 3 cost time: 0.5023958683013916
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5702784 Best vali loss: 0.5702784

best validation loss 0.57027837737519

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013301599443, 'e_layers': 3, 'learning_rate': 9.50865111e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0913845
	speed: 0.0106s/iter; left time: 40.3674s
	iters: 200, epoch: 1 | loss: 0.6289279
	speed: 0.0046s/iter; left time: 17.1249s
	iters: 300, epoch: 1 | loss: 1.7048677
	speed: 0.0047s/iter; left time: 16.8756s
	iters: 400, epoch: 1 | loss: 0.5362002
	speed: 0.0046s/iter; left time: 16.0431s
Updating learning rate to 9.50865111e-05
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 2.590407609939575
Epoch: 1, Steps: 490 | Train Loss: 0.9903451 Vali Loss: 0.6144104 Best vali loss: 0.6144104
	iters: 100, epoch: 2 | loss: 0.8159790
	speed: 0.0130s/iter; left time: 43.2552s
	iters: 200, epoch: 2 | loss: 0.5716126
	speed: 0.0045s/iter; left time: 14.6538s
	iters: 300, epoch: 2 | loss: 1.1218134
	speed: 0.0046s/iter; left time: 14.3166s
	iters: 400, epoch: 2 | loss: 1.3162117
	speed: 0.0046s/iter; left time: 14.0072s
Updating learning rate to 4.754325555e-05
Validation loss decreased (0.6144 --> 0.5795).  Saving model state dict ...
Epoch: 2 cost time: 2.3038485050201416
Epoch: 2, Steps: 490 | Train Loss: 0.9564042 Vali Loss: 0.5794642 Best vali loss: 0.5794642
	iters: 100, epoch: 3 | loss: 0.7449079
	speed: 0.0129s/iter; left time: 36.7816s
	iters: 200, epoch: 3 | loss: 0.4223571
	speed: 0.0047s/iter; left time: 12.8305s
	iters: 300, epoch: 3 | loss: 0.6867230
	speed: 0.0045s/iter; left time: 11.9582s
	iters: 400, epoch: 3 | loss: 0.5645698
	speed: 0.0045s/iter; left time: 11.5419s
Updating learning rate to 2.3771627775e-05
Validation loss decreased (0.5795 --> 0.5544).  Saving model state dict ...
Epoch: 3 cost time: 2.299327850341797
Epoch: 3, Steps: 490 | Train Loss: 0.6046395 Vali Loss: 0.5543827 Best vali loss: 0.5543827

best validation loss 0.5543826827844057

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.003324808973, 'e_layers': 4, 'learning_rate': 0.0020520881008, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8985282
	speed: 0.0116s/iter; left time: 21.5310s
	iters: 200, epoch: 1 | loss: 1.0814476
	speed: 0.0051s/iter; left time: 8.9704s
Updating learning rate to 0.0020520881008
Validation loss decreased (inf --> 0.6583).  Saving model state dict ...
Epoch: 1 cost time: 1.6135437488555908
Epoch: 1, Steps: 245 | Train Loss: 0.9899879 Vali Loss: 0.6583339 Best vali loss: 0.6583339
	iters: 100, epoch: 2 | loss: 0.7755749
	speed: 0.0101s/iter; left time: 16.3026s
	iters: 200, epoch: 2 | loss: 0.7583708
	speed: 0.0052s/iter; left time: 7.9327s
Updating learning rate to 0.0010260440504
Validation loss decreased (0.6583 --> 0.6484).  Saving model state dict ...
Epoch: 2 cost time: 1.325977087020874
Epoch: 2, Steps: 245 | Train Loss: 0.7669728 Vali Loss: 0.6484437 Best vali loss: 0.6484437
	iters: 100, epoch: 3 | loss: 0.8888074
	speed: 0.0103s/iter; left time: 14.0843s
	iters: 200, epoch: 3 | loss: 1.1059041
	speed: 0.0051s/iter; left time: 6.5197s
Updating learning rate to 0.0005130220252
Epoch: 3 cost time: 1.3156356811523438
Epoch: 3, Steps: 245 | Train Loss: 0.9973558 Vali Loss: 0.6490228 Best vali loss: 0.6484437

best validation loss 0.6484436978625236

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013301599443, 'e_layers': 3, 'learning_rate': 9.50865111e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9294017
	speed: 0.0111s/iter; left time: 26.1973s
	iters: 200, epoch: 4 | loss: 0.4028796
	speed: 0.0046s/iter; left time: 10.3118s
	iters: 300, epoch: 4 | loss: 1.5727600
	speed: 0.0046s/iter; left time: 9.9903s
	iters: 400, epoch: 4 | loss: 0.3716315
	speed: 0.0045s/iter; left time: 9.3149s
Updating learning rate to 1.18858138875e-05
Validation loss decreased (0.5544 --> 0.5353).  Saving model state dict ...
Epoch: 4 cost time: 2.5766444206237793
Epoch: 4, Steps: 490 | Train Loss: 0.8191682 Vali Loss: 0.5353030 Best vali loss: 0.5353030
	iters: 100, epoch: 5 | loss: 0.7034603
	speed: 0.0128s/iter; left time: 23.7552s
	iters: 200, epoch: 5 | loss: 0.5066277
	speed: 0.0046s/iter; left time: 8.1858s
	iters: 300, epoch: 5 | loss: 0.9012851
	speed: 0.0045s/iter; left time: 7.5120s
	iters: 400, epoch: 5 | loss: 1.1137947
	speed: 0.0046s/iter; left time: 7.1817s
Updating learning rate to 5.94290694375e-06
Validation loss decreased (0.5353 --> 0.5312).  Saving model state dict ...
Epoch: 5 cost time: 2.280500650405884
Epoch: 5, Steps: 490 | Train Loss: 0.8062919 Vali Loss: 0.5311854 Best vali loss: 0.5311854
	iters: 100, epoch: 6 | loss: 0.6994797
	speed: 0.0129s/iter; left time: 17.6611s
	iters: 200, epoch: 6 | loss: 0.3991629
	speed: 0.0047s/iter; left time: 5.9113s
	iters: 300, epoch: 6 | loss: 0.5980694
	speed: 0.0045s/iter; left time: 5.2193s
	iters: 400, epoch: 6 | loss: 0.5357474
	speed: 0.0045s/iter; left time: 4.8053s
Updating learning rate to 2.971453471875e-06
Validation loss decreased (0.5312 --> 0.5304).  Saving model state dict ...
Epoch: 6 cost time: 2.2692713737487793
Epoch: 6, Steps: 490 | Train Loss: 0.5581148 Vali Loss: 0.5304448 Best vali loss: 0.5304448
	iters: 100, epoch: 7 | loss: 0.7344943
	speed: 0.0129s/iter; left time: 11.3254s
	iters: 200, epoch: 7 | loss: 0.5584069
	speed: 0.0042s/iter; left time: 3.2649s
	iters: 300, epoch: 7 | loss: 0.8335374
	speed: 0.0042s/iter; left time: 2.8829s
	iters: 400, epoch: 7 | loss: 0.7952321
	speed: 0.0040s/iter; left time: 2.3505s
Updating learning rate to 1.4857267359375e-06
Validation loss decreased (0.5304 --> 0.5276).  Saving model state dict ...
Epoch: 7 cost time: 2.106315851211548
Epoch: 7, Steps: 490 | Train Loss: 0.7304177 Vali Loss: 0.5275683 Best vali loss: 0.5275683
	iters: 100, epoch: 8 | loss: 0.8476254
	speed: 0.0119s/iter; left time: 4.6571s
	iters: 200, epoch: 8 | loss: 0.4151350
	speed: 0.0041s/iter; left time: 1.1874s
	iters: 300, epoch: 8 | loss: 1.0297223
	speed: 0.0040s/iter; left time: 0.7662s
	iters: 400, epoch: 8 | loss: 0.5965430
	speed: 0.0040s/iter; left time: 0.3655s
Updating learning rate to 7.4286336796875e-07
Epoch: 8 cost time: 2.0473053455352783
Epoch: 8, Steps: 490 | Train Loss: 0.7222564 Vali Loss: 0.5281494 Best vali loss: 0.5275683

best validation loss 0.5275683465902037

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011747550529, 'e_layers': 3, 'learning_rate': 7.4593571e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1098400
	speed: 0.0108s/iter; left time: 41.3227s
	iters: 200, epoch: 1 | loss: 0.6169363
	speed: 0.0042s/iter; left time: 15.7701s
	iters: 300, epoch: 1 | loss: 1.7056464
	speed: 0.0046s/iter; left time: 16.5926s
	iters: 400, epoch: 1 | loss: 0.5390762
	speed: 0.0046s/iter; left time: 16.0740s
Updating learning rate to 7.4593571e-05
Validation loss decreased (inf --> 0.6143).  Saving model state dict ...
Epoch: 1 cost time: 2.551062822341919
Epoch: 1, Steps: 490 | Train Loss: 0.9928747 Vali Loss: 0.6143406 Best vali loss: 0.6143406
	iters: 100, epoch: 2 | loss: 0.8208547
	speed: 0.0123s/iter; left time: 40.9048s
	iters: 200, epoch: 2 | loss: 0.5683150
	speed: 0.0041s/iter; left time: 13.2141s
	iters: 300, epoch: 2 | loss: 1.0566843
	speed: 0.0042s/iter; left time: 13.0585s
	iters: 400, epoch: 2 | loss: 1.4017720
	speed: 0.0040s/iter; left time: 12.1449s
Updating learning rate to 3.72967855e-05
Validation loss decreased (0.6143 --> 0.5623).  Saving model state dict ...
Epoch: 2 cost time: 2.0414469242095947
Epoch: 2, Steps: 490 | Train Loss: 0.9619065 Vali Loss: 0.5622663 Best vali loss: 0.5622663
	iters: 100, epoch: 3 | loss: 0.7582619
	speed: 0.0116s/iter; left time: 33.0194s
	iters: 200, epoch: 3 | loss: 0.4223781
	speed: 0.0041s/iter; left time: 11.3213s
	iters: 300, epoch: 3 | loss: 0.7198982
	speed: 0.0041s/iter; left time: 10.9041s
	iters: 400, epoch: 3 | loss: 0.5616214
	speed: 0.0040s/iter; left time: 10.2754s
Updating learning rate to 1.864839275e-05
Validation loss decreased (0.5623 --> 0.5373).  Saving model state dict ...
Epoch: 3 cost time: 2.066884756088257
Epoch: 3, Steps: 490 | Train Loss: 0.6155399 Vali Loss: 0.5372706 Best vali loss: 0.5372706
	iters: 100, epoch: 4 | loss: 0.7631164
	speed: 0.0118s/iter; left time: 27.7921s
	iters: 200, epoch: 4 | loss: 0.5834555
	speed: 0.0042s/iter; left time: 9.3632s
	iters: 300, epoch: 4 | loss: 0.8578062
	speed: 0.0040s/iter; left time: 8.7079s
	iters: 400, epoch: 4 | loss: 0.8175586
	speed: 0.0042s/iter; left time: 8.5152s
Updating learning rate to 9.324196375e-06
Epoch: 4 cost time: 2.0690062046051025
Epoch: 4, Steps: 490 | Train Loss: 0.7554842 Vali Loss: 0.5390144 Best vali loss: 0.5372706
	iters: 100, epoch: 5 | loss: 0.8618477
	speed: 0.0115s/iter; left time: 21.4611s
	iters: 200, epoch: 5 | loss: 0.4536112
	speed: 0.0048s/iter; left time: 8.3869s
	iters: 300, epoch: 5 | loss: 1.0620669
	speed: 0.0046s/iter; left time: 7.6858s
	iters: 400, epoch: 5 | loss: 0.6162950
	speed: 0.0042s/iter; left time: 6.6223s
Updating learning rate to 4.6620981875e-06
Epoch: 5 cost time: 2.2097532749176025
Epoch: 5, Steps: 490 | Train Loss: 0.7484552 Vali Loss: 0.5381287 Best vali loss: 0.5372706
	iters: 100, epoch: 6 | loss: 0.6540490
	speed: 0.0112s/iter; left time: 15.3534s
	iters: 200, epoch: 6 | loss: 0.9635770
	speed: 0.0041s/iter; left time: 5.1947s
	iters: 300, epoch: 6 | loss: 0.4841213
	speed: 0.0044s/iter; left time: 5.1600s
	iters: 400, epoch: 6 | loss: 0.9143051
	speed: 0.0041s/iter; left time: 4.4187s
Updating learning rate to 2.33104909375e-06
Epoch: 6 cost time: 2.0564494132995605
Epoch: 6, Steps: 490 | Train Loss: 0.7540131 Vali Loss: 0.5397895 Best vali loss: 0.5372706
	iters: 100, epoch: 7 | loss: 0.5741772
	speed: 0.0114s/iter; left time: 10.0512s
	iters: 200, epoch: 7 | loss: 0.6302776
	speed: 0.0042s/iter; left time: 3.2642s
	iters: 300, epoch: 7 | loss: 0.5846563
	speed: 0.0046s/iter; left time: 3.1255s
	iters: 400, epoch: 7 | loss: 0.4880447
	speed: 0.0047s/iter; left time: 2.7479s
Updating learning rate to 1.165524546875e-06
Epoch: 7 cost time: 2.2373716831207275
Epoch: 7, Steps: 490 | Train Loss: 0.5692890 Vali Loss: 0.5386896 Best vali loss: 0.5372706
	iters: 100, epoch: 8 | loss: 0.4745489
	speed: 0.0126s/iter; left time: 4.9384s
	iters: 200, epoch: 8 | loss: 0.6288053
	speed: 0.0046s/iter; left time: 1.3521s
	iters: 300, epoch: 8 | loss: 0.5447332
	speed: 0.0047s/iter; left time: 0.9045s
	iters: 400, epoch: 8 | loss: 0.8710350
	speed: 0.0046s/iter; left time: 0.4227s
Updating learning rate to 5.827622734375e-07
Epoch: 8 cost time: 2.3565385341644287
Epoch: 8, Steps: 490 | Train Loss: 0.6297806 Vali Loss: 0.5396951 Best vali loss: 0.5372706

best validation loss 0.5372706481782665

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013252309825, 'e_layers': 3, 'learning_rate': 9.75537731e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0899519
	speed: 0.0110s/iter; left time: 41.9464s
	iters: 200, epoch: 1 | loss: 0.6312673
	speed: 0.0042s/iter; left time: 15.6825s
	iters: 300, epoch: 1 | loss: 1.7048157
	speed: 0.0044s/iter; left time: 15.8551s
	iters: 400, epoch: 1 | loss: 0.5360005
	speed: 0.0046s/iter; left time: 16.0863s
Updating learning rate to 9.75537731e-05
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 2.544570207595825
Epoch: 1, Steps: 490 | Train Loss: 0.9905089 Vali Loss: 0.6143875 Best vali loss: 0.6143875
	iters: 100, epoch: 2 | loss: 0.8159570
	speed: 0.0124s/iter; left time: 41.3857s
	iters: 200, epoch: 2 | loss: 0.5717220
	speed: 0.0042s/iter; left time: 13.5027s
	iters: 300, epoch: 2 | loss: 1.1211396
	speed: 0.0041s/iter; left time: 12.7216s
	iters: 400, epoch: 2 | loss: 1.3130404
	speed: 0.0042s/iter; left time: 12.6302s
Updating learning rate to 4.877688655e-05
Validation loss decreased (0.6144 --> 0.5591).  Saving model state dict ...
Epoch: 2 cost time: 2.0933611392974854
Epoch: 2, Steps: 490 | Train Loss: 0.9554648 Vali Loss: 0.5590763 Best vali loss: 0.5590763
	iters: 100, epoch: 3 | loss: 0.7558725
	speed: 0.0119s/iter; left time: 33.9024s
	iters: 200, epoch: 3 | loss: 0.4333081
	speed: 0.0042s/iter; left time: 11.4078s
	iters: 300, epoch: 3 | loss: 0.6699362
	speed: 0.0042s/iter; left time: 11.1299s
	iters: 400, epoch: 3 | loss: 0.5557917
	speed: 0.0042s/iter; left time: 10.7420s
Updating learning rate to 2.4388443275e-05
Validation loss decreased (0.5591 --> 0.5539).  Saving model state dict ...
Epoch: 3 cost time: 2.1001622676849365
Epoch: 3, Steps: 490 | Train Loss: 0.6037271 Vali Loss: 0.5538671 Best vali loss: 0.5538671
	iters: 100, epoch: 4 | loss: 0.7550946
	speed: 0.0125s/iter; left time: 29.3573s
	iters: 200, epoch: 4 | loss: 0.5712034
	speed: 0.0046s/iter; left time: 10.3225s
	iters: 300, epoch: 4 | loss: 0.8414685
	speed: 0.0045s/iter; left time: 9.6802s
	iters: 400, epoch: 4 | loss: 0.8226609
	speed: 0.0045s/iter; left time: 9.3145s
Updating learning rate to 1.21942216375e-05
Validation loss decreased (0.5539 --> 0.5429).  Saving model state dict ...
Epoch: 4 cost time: 2.2788639068603516
Epoch: 4, Steps: 490 | Train Loss: 0.7476068 Vali Loss: 0.5429040 Best vali loss: 0.5429040
	iters: 100, epoch: 5 | loss: 0.8561426
	speed: 0.0124s/iter; left time: 23.1346s
	iters: 200, epoch: 5 | loss: 0.4187896
	speed: 0.0040s/iter; left time: 7.0639s
	iters: 300, epoch: 5 | loss: 1.0592245
	speed: 0.0040s/iter; left time: 6.5656s
	iters: 400, epoch: 5 | loss: 0.6010897
	speed: 0.0040s/iter; left time: 6.1722s
Updating learning rate to 6.09711081875e-06
Validation loss decreased (0.5429 --> 0.5368).  Saving model state dict ...
Epoch: 5 cost time: 2.017895460128784
Epoch: 5, Steps: 490 | Train Loss: 0.7338116 Vali Loss: 0.5367549 Best vali loss: 0.5367549
	iters: 100, epoch: 6 | loss: 0.6284060
	speed: 0.0119s/iter; left time: 16.3491s
	iters: 200, epoch: 6 | loss: 0.9493226
	speed: 0.0041s/iter; left time: 5.1598s
	iters: 300, epoch: 6 | loss: 0.4730045
	speed: 0.0041s/iter; left time: 4.8073s
	iters: 400, epoch: 6 | loss: 0.9009126
	speed: 0.0042s/iter; left time: 4.5149s
Updating learning rate to 3.048555409375e-06
Validation loss decreased (0.5368 --> 0.5336).  Saving model state dict ...
Epoch: 6 cost time: 2.0808489322662354
Epoch: 6, Steps: 490 | Train Loss: 0.7379115 Vali Loss: 0.5336461 Best vali loss: 0.5336461
	iters: 100, epoch: 7 | loss: 0.5621737
	speed: 0.0126s/iter; left time: 11.1291s
	iters: 200, epoch: 7 | loss: 0.5962075
	speed: 0.0045s/iter; left time: 3.5492s
	iters: 300, epoch: 7 | loss: 0.5806703
	speed: 0.0046s/iter; left time: 3.1190s
	iters: 400, epoch: 7 | loss: 0.4742365
	speed: 0.0047s/iter; left time: 2.7312s
Updating learning rate to 1.5242777046875e-06
Validation loss decreased (0.5336 --> 0.5335).  Saving model state dict ...
Epoch: 7 cost time: 2.3125722408294678
Epoch: 7, Steps: 490 | Train Loss: 0.5533220 Vali Loss: 0.5334620 Best vali loss: 0.5334620
	iters: 100, epoch: 8 | loss: 0.4564351
	speed: 0.0130s/iter; left time: 5.0989s
	iters: 200, epoch: 8 | loss: 0.5994022
	speed: 0.0047s/iter; left time: 1.3662s
	iters: 300, epoch: 8 | loss: 0.5513482
	speed: 0.0047s/iter; left time: 0.8994s
	iters: 400, epoch: 8 | loss: 0.8542883
	speed: 0.0047s/iter; left time: 0.4268s
Updating learning rate to 7.6213885234375e-07
Validation loss decreased (0.5335 --> 0.5319).  Saving model state dict ...
Epoch: 8 cost time: 2.33870267868042
Epoch: 8, Steps: 490 | Train Loss: 0.6153685 Vali Loss: 0.5319318 Best vali loss: 0.5319318

best validation loss 0.5319317621745648

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012314280048, 'e_layers': 3, 'learning_rate': 8.58132116e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0982442
	speed: 0.0107s/iter; left time: 40.8653s
	iters: 200, epoch: 1 | loss: 0.6216246
	speed: 0.0047s/iter; left time: 17.3234s
	iters: 300, epoch: 1 | loss: 1.7049409
	speed: 0.0047s/iter; left time: 17.0405s
	iters: 400, epoch: 1 | loss: 0.5373890
	speed: 0.0047s/iter; left time: 16.4969s
Updating learning rate to 8.58132116e-05
Validation loss decreased (inf --> 0.6145).  Saving model state dict ...
Epoch: 1 cost time: 2.6427695751190186
Epoch: 1, Steps: 490 | Train Loss: 0.9905497 Vali Loss: 0.6145124 Best vali loss: 0.6145124
	iters: 100, epoch: 2 | loss: 0.8178320
	speed: 0.0129s/iter; left time: 43.0230s
	iters: 200, epoch: 2 | loss: 0.5700199
	speed: 0.0047s/iter; left time: 15.1003s
	iters: 300, epoch: 2 | loss: 1.0702403
	speed: 0.0046s/iter; left time: 14.4506s
	iters: 400, epoch: 2 | loss: 1.3141974
	speed: 0.0047s/iter; left time: 14.1351s
Updating learning rate to 4.29066058e-05
Epoch: 2 cost time: 2.3163070678710938
Epoch: 2, Steps: 490 | Train Loss: 0.9430724 Vali Loss: 0.6348902 Best vali loss: 0.6145124
	iters: 100, epoch: 3 | loss: 0.7555096
	speed: 0.0120s/iter; left time: 33.9645s
	iters: 200, epoch: 3 | loss: 0.4235418
	speed: 0.0040s/iter; left time: 11.0050s
	iters: 300, epoch: 3 | loss: 0.7235723
	speed: 0.0041s/iter; left time: 10.8884s
	iters: 400, epoch: 3 | loss: 0.5617629
	speed: 0.0042s/iter; left time: 10.5852s
Updating learning rate to 2.14533029e-05
Validation loss decreased (0.6145 --> 0.5514).  Saving model state dict ...
Epoch: 3 cost time: 2.055251359939575
Epoch: 3, Steps: 490 | Train Loss: 0.6160967 Vali Loss: 0.5513546 Best vali loss: 0.5513546

best validation loss 0.5513546115157231

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489435888, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744070
	speed: 0.0117s/iter; left time: 10.3358s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0292632579803467
Epoch: 1, Steps: 123 | Train Loss: 0.7744070 Vali Loss: 0.6172183 Best vali loss: 0.6172183
	iters: 100, epoch: 2 | loss: 0.9473703
	speed: 0.0092s/iter; left time: 7.0376s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6172 --> 0.5817).  Saving model state dict ...
Epoch: 2 cost time: 0.7286162376403809
Epoch: 2, Steps: 123 | Train Loss: 0.9473703 Vali Loss: 0.5817295 Best vali loss: 0.5817295
	iters: 100, epoch: 3 | loss: 0.8583221
	speed: 0.0095s/iter; left time: 6.0743s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5817 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 0.7231853008270264
Epoch: 3, Steps: 123 | Train Loss: 0.8583221 Vali Loss: 0.5453386 Best vali loss: 0.5453386

best validation loss 0.5453386496250854

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002976836503, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7745579
	speed: 0.0117s/iter; left time: 10.3857s
Updating learning rate to 0.0002863537409877087
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0245606899261475
Epoch: 1, Steps: 123 | Train Loss: 0.7745579 Vali Loss: 0.6173170 Best vali loss: 0.6173170
	iters: 100, epoch: 2 | loss: 0.9516896
	speed: 0.0093s/iter; left time: 7.0758s
Updating learning rate to 0.0002540888890377474
Validation loss decreased (0.6173 --> 0.5737).  Saving model state dict ...
Epoch: 2 cost time: 0.7283217906951904
Epoch: 2, Steps: 123 | Train Loss: 0.9516896 Vali Loss: 0.5736781 Best vali loss: 0.5736781
	iters: 100, epoch: 3 | loss: 0.8533263
	speed: 0.0093s/iter; left time: 5.9639s
Updating learning rate to 0.00020580112567788656
Validation loss decreased (0.5737 --> 0.5511).  Saving model state dict ...
Epoch: 3 cost time: 0.7247757911682129
Epoch: 3, Steps: 123 | Train Loss: 0.8533263 Vali Loss: 0.5511161 Best vali loss: 0.5511161

best validation loss 0.55111606531483

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010489435888, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5877609
	speed: 0.0121s/iter; left time: 6.2411s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5453 --> 0.5338).  Saving model state dict ...
Epoch: 4 cost time: 1.0304210186004639
Epoch: 4, Steps: 123 | Train Loss: 0.5877609 Vali Loss: 0.5337838 Best vali loss: 0.5337838
	iters: 100, epoch: 5 | loss: 0.8203827
	speed: 0.0094s/iter; left time: 3.6983s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5338 --> 0.5324).  Saving model state dict ...
Epoch: 5 cost time: 0.7204182147979736
Epoch: 5, Steps: 123 | Train Loss: 0.8203827 Vali Loss: 0.5323948 Best vali loss: 0.5323948
	iters: 100, epoch: 6 | loss: 0.7646750
	speed: 0.0093s/iter; left time: 2.5040s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7230257987976074
Epoch: 6, Steps: 123 | Train Loss: 0.7646750 Vali Loss: 0.5400761 Best vali loss: 0.5323948
	iters: 100, epoch: 7 | loss: 0.4300157
	speed: 0.0090s/iter; left time: 1.3167s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7161712646484375
Epoch: 7, Steps: 123 | Train Loss: 0.4300157 Vali Loss: 0.5531083 Best vali loss: 0.5323948
	iters: 100, epoch: 8 | loss: 0.5025676
	speed: 0.0089s/iter; left time: 0.2133s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7136726379394531
Epoch: 8, Steps: 123 | Train Loss: 0.5025676 Vali Loss: 0.5493272 Best vali loss: 0.5323948

best validation loss 0.5323948069393276

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0116715756996, 'e_layers': 2, 'learning_rate': 0.0002084782108, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9325758
	speed: 0.0101s/iter; left time: 18.8028s
	iters: 200, epoch: 1 | loss: 0.8686315
	speed: 0.0039s/iter; left time: 6.8766s
Updating learning rate to 0.00020054348136634673
Validation loss decreased (inf --> 0.5913).  Saving model state dict ...
Epoch: 1 cost time: 1.3042309284210205
Epoch: 1, Steps: 245 | Train Loss: 0.9006037 Vali Loss: 0.5913010 Best vali loss: 0.5913010
	iters: 100, epoch: 2 | loss: 1.0077720
	speed: 0.0083s/iter; left time: 13.3581s
	iters: 200, epoch: 2 | loss: 0.6373666
	speed: 0.0039s/iter; left time: 5.9004s
Updating learning rate to 0.00017794728369315926
Validation loss decreased (0.5913 --> 0.5814).  Saving model state dict ...
Epoch: 2 cost time: 1.005408525466919
Epoch: 2, Steps: 245 | Train Loss: 0.8225693 Vali Loss: 0.5814491 Best vali loss: 0.5814491
	iters: 100, epoch: 3 | loss: 1.2167306
	speed: 0.0083s/iter; left time: 11.3309s
	iters: 200, epoch: 3 | loss: 1.1469604
	speed: 0.0038s/iter; left time: 4.8054s
Updating learning rate to 0.00014412968404113838
Validation loss decreased (0.5814 --> 0.5680).  Saving model state dict ...
Epoch: 3 cost time: 0.9925985336303711
Epoch: 3, Steps: 245 | Train Loss: 1.1818455 Vali Loss: 0.5680300 Best vali loss: 0.5680300
	iters: 100, epoch: 4 | loss: 0.8661511
	speed: 0.0081s/iter; left time: 9.1223s
	iters: 200, epoch: 4 | loss: 0.7095672
	speed: 0.0037s/iter; left time: 3.8069s
Updating learning rate to 0.0001042391054
Epoch: 4 cost time: 0.9881381988525391
Epoch: 4, Steps: 245 | Train Loss: 0.7878592 Vali Loss: 0.5684430 Best vali loss: 0.5680300
	iters: 100, epoch: 5 | loss: 0.4532908
	speed: 0.0081s/iter; left time: 7.1282s
	iters: 200, epoch: 5 | loss: 0.8218185
	speed: 0.0040s/iter; left time: 3.1585s
Updating learning rate to 6.434852675886164e-05
Validation loss decreased (0.5680 --> 0.5661).  Saving model state dict ...
Epoch: 5 cost time: 1.0274159908294678
Epoch: 5, Steps: 245 | Train Loss: 0.6375547 Vali Loss: 0.5660610 Best vali loss: 0.5660610
	iters: 100, epoch: 6 | loss: 0.8467076
	speed: 0.0082s/iter; left time: 5.2128s
	iters: 200, epoch: 6 | loss: 0.7139485
	speed: 0.0040s/iter; left time: 2.1273s
Updating learning rate to 3.053092710684074e-05
Validation loss decreased (0.5661 --> 0.5645).  Saving model state dict ...
Epoch: 6 cost time: 1.0113766193389893
Epoch: 6, Steps: 245 | Train Loss: 0.7803281 Vali Loss: 0.5645177 Best vali loss: 0.5645177
	iters: 100, epoch: 7 | loss: 0.6856849
	speed: 0.0082s/iter; left time: 3.2102s
	iters: 200, epoch: 7 | loss: 0.8056819
	speed: 0.0038s/iter; left time: 1.1021s
Updating learning rate to 7.934729433653255e-06
Validation loss decreased (0.5645 --> 0.5599).  Saving model state dict ...
Epoch: 7 cost time: 0.9904305934906006
Epoch: 7, Steps: 245 | Train Loss: 0.7456834 Vali Loss: 0.5598725 Best vali loss: 0.5598725
	iters: 100, epoch: 8 | loss: 0.6281711
	speed: 0.0079s/iter; left time: 1.1588s
	iters: 200, epoch: 8 | loss: 0.8251391
	speed: 0.0038s/iter; left time: 0.1745s
Updating learning rate to 0.0
Validation loss decreased (0.5599 --> 0.5545).  Saving model state dict ...
Epoch: 8 cost time: 0.9702451229095459
Epoch: 8, Steps: 245 | Train Loss: 0.7266551 Vali Loss: 0.5544858 Best vali loss: 0.5544858

best validation loss 0.5544858137692968

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010318685824, 'e_layers': 3, 'learning_rate': 0.0004641095044, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004464453881795585
Validation loss decreased (inf --> 0.5990).  Saving model state dict ...
Epoch: 1 cost time: 0.8866634368896484
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5989887 Best vali loss: 0.5989887
Updating learning rate to 0.0003961422410871839
Validation loss decreased (0.5990 --> 0.5724).  Saving model state dict ...
Epoch: 2 cost time: 0.6109650135040283
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5723562 Best vali loss: 0.5723562
Updating learning rate to 0.0003208582612685264
Validation loss decreased (0.5724 --> 0.5673).  Saving model state dict ...
Epoch: 3 cost time: 0.6147387027740479
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5673220 Best vali loss: 0.5673220
Updating learning rate to 0.0002320547522
Validation loss decreased (0.5673 --> 0.5537).  Saving model state dict ...
Epoch: 4 cost time: 0.6219282150268555
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5536756 Best vali loss: 0.5536756
Updating learning rate to 0.00014325124313147364
Validation loss decreased (0.5537 --> 0.5412).  Saving model state dict ...
Epoch: 5 cost time: 0.6080169677734375
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5412093 Best vali loss: 0.5412093
Updating learning rate to 6.796726331281611e-05
Epoch: 6 cost time: 0.6081030368804932
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5415596 Best vali loss: 0.5412093
Updating learning rate to 1.7664116220441513e-05
Validation loss decreased (0.5412 --> 0.5375).  Saving model state dict ...
Epoch: 7 cost time: 0.6042687892913818
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5375006 Best vali loss: 0.5375006
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6116244792938232
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5379493 Best vali loss: 0.5375006

best validation loss 0.5375006365202357

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008420315027, 'e_layers': 3, 'learning_rate': 0.0004643767838, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00044670249486311944
Validation loss decreased (inf --> 0.5988).  Saving model state dict ...
Epoch: 1 cost time: 0.8993065357208252
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5987797 Best vali loss: 0.5987797
Updating learning rate to 0.00039637037832528966
Validation loss decreased (0.5988 --> 0.5769).  Saving model state dict ...
Epoch: 2 cost time: 0.6167209148406982
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5769149 Best vali loss: 0.5769149
Updating learning rate to 0.00032104304266762266
Epoch: 3 cost time: 0.6095802783966064
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5856215 Best vali loss: 0.5769149

best validation loss 0.5769149443718197

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494792795, 'e_layers': 3, 'learning_rate': 0.0003013839481, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6165806
	speed: 0.0138s/iter; left time: 12.2132s
Updating learning rate to 0.00028991320458851696
Validation loss decreased (inf --> 0.5851).  Saving model state dict ...
Epoch: 1 cost time: 1.2995719909667969
Epoch: 1, Steps: 123 | Train Loss: 0.6165806 Vali Loss: 0.5851438 Best vali loss: 0.5851438
	iters: 100, epoch: 2 | loss: 0.7210217
	speed: 0.0122s/iter; left time: 9.3172s
Updating learning rate to 0.00025724729077114224
Validation loss decreased (0.5851 --> 0.5586).  Saving model state dict ...
Epoch: 2 cost time: 0.993114709854126
Epoch: 2, Steps: 123 | Train Loss: 0.7210217 Vali Loss: 0.5586022 Best vali loss: 0.5586022
	iters: 100, epoch: 3 | loss: 0.6350257
	speed: 0.0125s/iter; left time: 7.9557s
Updating learning rate to 0.00020835929590932504
Validation loss decreased (0.5586 --> 0.5517).  Saving model state dict ...
Epoch: 3 cost time: 0.9939625263214111
Epoch: 3, Steps: 123 | Train Loss: 0.6350257 Vali Loss: 0.5516831 Best vali loss: 0.5516831

best validation loss 0.5516830665377873

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010433156664, 'e_layers': 2, 'learning_rate': 0.0003021584673, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7747838
	speed: 0.0115s/iter; left time: 10.1475s
Updating learning rate to 0.0003021584673
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0140342712402344
Epoch: 1, Steps: 123 | Train Loss: 0.7747838 Vali Loss: 0.6172103 Best vali loss: 0.6172103
	iters: 100, epoch: 2 | loss: 0.9472887
	speed: 0.0092s/iter; left time: 7.0081s
Updating learning rate to 0.00015107923365
Validation loss decreased (0.6172 --> 0.5745).  Saving model state dict ...
Epoch: 2 cost time: 0.720686674118042
Epoch: 2, Steps: 123 | Train Loss: 0.9472887 Vali Loss: 0.5744628 Best vali loss: 0.5744628
	iters: 100, epoch: 3 | loss: 0.8577017
	speed: 0.0093s/iter; left time: 5.9395s
Updating learning rate to 7.5539616825e-05
Validation loss decreased (0.5745 --> 0.5485).  Saving model state dict ...
Epoch: 3 cost time: 0.7224977016448975
Epoch: 3, Steps: 123 | Train Loss: 0.8577017 Vali Loss: 0.5484946 Best vali loss: 0.5484946

best validation loss 0.5484946041623512

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010433156664, 'e_layers': 2, 'learning_rate': 0.0003021584673, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5939708
	speed: 0.0119s/iter; left time: 6.1621s
Updating learning rate to 3.77698084125e-05
Validation loss decreased (0.5485 --> 0.5362).  Saving model state dict ...
Epoch: 4 cost time: 1.016573429107666
Epoch: 4, Steps: 123 | Train Loss: 0.5939708 Vali Loss: 0.5361833 Best vali loss: 0.5361833
	iters: 100, epoch: 5 | loss: 0.8517944
	speed: 0.0092s/iter; left time: 3.6346s
Updating learning rate to 1.888490420625e-05
Validation loss decreased (0.5362 --> 0.5279).  Saving model state dict ...
Epoch: 5 cost time: 0.7213523387908936
Epoch: 5, Steps: 123 | Train Loss: 0.8517944 Vali Loss: 0.5278683 Best vali loss: 0.5278683
	iters: 100, epoch: 6 | loss: 0.8022774
	speed: 0.0093s/iter; left time: 2.5197s
Updating learning rate to 9.442452103125e-06
Validation loss decreased (0.5279 --> 0.5269).  Saving model state dict ...
Epoch: 6 cost time: 0.7279255390167236
Epoch: 6, Steps: 123 | Train Loss: 0.8022774 Vali Loss: 0.5268771 Best vali loss: 0.5268771
	iters: 100, epoch: 7 | loss: 0.4778791
	speed: 0.0093s/iter; left time: 1.3668s
Updating learning rate to 4.7212260515625e-06
Epoch: 7 cost time: 0.7272698879241943
Epoch: 7, Steps: 123 | Train Loss: 0.4778791 Vali Loss: 0.5274218 Best vali loss: 0.5268771
	iters: 100, epoch: 8 | loss: 0.5539413
	speed: 0.0090s/iter; left time: 0.2150s
Updating learning rate to 2.36061302578125e-06
Validation loss decreased (0.5269 --> 0.5264).  Saving model state dict ...
Epoch: 8 cost time: 0.7128853797912598
Epoch: 8, Steps: 123 | Train Loss: 0.5539413 Vali Loss: 0.5263966 Best vali loss: 0.5263966

best validation loss 0.5263966313118958

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0079062626694, 'e_layers': 2, 'learning_rate': 0.0007644231376, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5831863
	speed: 0.0098s/iter; left time: 37.4269s
	iters: 200, epoch: 1 | loss: 0.6839161
	speed: 0.0036s/iter; left time: 13.3020s
	iters: 300, epoch: 1 | loss: 0.8287281
	speed: 0.0033s/iter; left time: 11.8279s
	iters: 400, epoch: 1 | loss: 0.4676734
	speed: 0.0032s/iter; left time: 11.3376s
Updating learning rate to 0.0007644231376
Validation loss decreased (inf --> 0.6140).  Saving model state dict ...
Epoch: 1 cost time: 1.9955658912658691
Epoch: 1, Steps: 490 | Train Loss: 0.6408760 Vali Loss: 0.6139507 Best vali loss: 0.6139507
	iters: 100, epoch: 2 | loss: 1.1511348
	speed: 0.0101s/iter; left time: 33.5008s
	iters: 200, epoch: 2 | loss: 0.8777142
	speed: 0.0037s/iter; left time: 12.1137s
	iters: 300, epoch: 2 | loss: 0.6878896
	speed: 0.0035s/iter; left time: 11.0386s
	iters: 400, epoch: 2 | loss: 0.5041305
	speed: 0.0035s/iter; left time: 10.7052s
Updating learning rate to 0.0003822115688
Epoch: 2 cost time: 1.8243262767791748
Epoch: 2, Steps: 490 | Train Loss: 0.8052173 Vali Loss: 0.6186876 Best vali loss: 0.6139507
	iters: 100, epoch: 3 | loss: 0.4007797
	speed: 0.0096s/iter; left time: 27.3019s
	iters: 200, epoch: 3 | loss: 0.7215764
	speed: 0.0031s/iter; left time: 8.5275s
	iters: 300, epoch: 3 | loss: 1.0102831
	speed: 0.0032s/iter; left time: 8.3262s
	iters: 400, epoch: 3 | loss: 1.0442431
	speed: 0.0032s/iter; left time: 8.0075s
Updating learning rate to 0.0001911057844
Epoch: 3 cost time: 1.594625473022461
Epoch: 3, Steps: 490 | Train Loss: 0.7942206 Vali Loss: 0.6351517 Best vali loss: 0.6139507
	iters: 100, epoch: 4 | loss: 0.7703897
	speed: 0.0094s/iter; left time: 22.0404s
	iters: 200, epoch: 4 | loss: 0.4609264
	speed: 0.0033s/iter; left time: 7.3500s
	iters: 300, epoch: 4 | loss: 0.6729368
	speed: 0.0032s/iter; left time: 6.8860s
	iters: 400, epoch: 4 | loss: 0.5881455
	speed: 0.0033s/iter; left time: 6.7308s
Updating learning rate to 9.55528922e-05
Epoch: 4 cost time: 1.644540548324585
Epoch: 4, Steps: 490 | Train Loss: 0.6230996 Vali Loss: 0.6304950 Best vali loss: 0.6139507
	iters: 100, epoch: 5 | loss: 1.0382857
	speed: 0.0092s/iter; left time: 17.1102s
	iters: 200, epoch: 5 | loss: 0.7377014
	speed: 0.0033s/iter; left time: 5.7804s
	iters: 300, epoch: 5 | loss: 1.0347273
	speed: 0.0034s/iter; left time: 5.6543s
	iters: 400, epoch: 5 | loss: 0.6208656
	speed: 0.0034s/iter; left time: 5.2587s
Updating learning rate to 4.77764461e-05
Epoch: 5 cost time: 1.6586182117462158
Epoch: 5, Steps: 490 | Train Loss: 0.8578950 Vali Loss: 0.6370206 Best vali loss: 0.6139507
	iters: 100, epoch: 6 | loss: 0.6782923
	speed: 0.0094s/iter; left time: 12.8588s
	iters: 200, epoch: 6 | loss: 0.6436716
	speed: 0.0032s/iter; left time: 4.0802s
	iters: 300, epoch: 6 | loss: 1.4816551
	speed: 0.0032s/iter; left time: 3.7567s
	iters: 400, epoch: 6 | loss: 0.4530643
	speed: 0.0032s/iter; left time: 3.4585s
Updating learning rate to 2.388822305e-05
Epoch: 6 cost time: 1.643355131149292
Epoch: 6, Steps: 490 | Train Loss: 0.8141708 Vali Loss: 0.6467227 Best vali loss: 0.6139507
	iters: 100, epoch: 7 | loss: 1.0126081
	speed: 0.0097s/iter; left time: 8.5690s
	iters: 200, epoch: 7 | loss: 0.7060673
	speed: 0.0035s/iter; left time: 2.7429s
	iters: 300, epoch: 7 | loss: 1.2977080
	speed: 0.0033s/iter; left time: 2.2580s
	iters: 400, epoch: 7 | loss: 0.9279605
	speed: 0.0036s/iter; left time: 2.0665s
Updating learning rate to 1.1944111525e-05
Epoch: 7 cost time: 1.7839479446411133
Epoch: 7, Steps: 490 | Train Loss: 0.9860860 Vali Loss: 0.6423524 Best vali loss: 0.6139507
	iters: 100, epoch: 8 | loss: 0.6356943
	speed: 0.0102s/iter; left time: 3.9878s
	iters: 200, epoch: 8 | loss: 0.3195369
	speed: 0.0038s/iter; left time: 1.1099s
	iters: 300, epoch: 8 | loss: 0.8028625
	speed: 0.0038s/iter; left time: 0.7274s
	iters: 400, epoch: 8 | loss: 0.4600226
	speed: 0.0038s/iter; left time: 0.3458s
Updating learning rate to 5.9720557625e-06
Epoch: 8 cost time: 1.8912289142608643
Epoch: 8, Steps: 490 | Train Loss: 0.5545290 Vali Loss: 0.6437412 Best vali loss: 0.6139507

best validation loss 0.6139506949202322

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0055117401072, 'e_layers': 2, 'learning_rate': 0.0007993467116, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7285455
	speed: 0.0101s/iter; left time: 18.8306s
	iters: 200, epoch: 1 | loss: 0.6595824
	speed: 0.0039s/iter; left time: 6.8318s
Updating learning rate to 0.0007993467116
Validation loss decreased (inf --> 0.5990).  Saving model state dict ...
Epoch: 1 cost time: 1.2921411991119385
Epoch: 1, Steps: 245 | Train Loss: 0.6940640 Vali Loss: 0.5989991 Best vali loss: 0.5989991
	iters: 100, epoch: 2 | loss: 0.3741698
	speed: 0.0079s/iter; left time: 12.7956s
	iters: 200, epoch: 2 | loss: 0.8868568
	speed: 0.0039s/iter; left time: 5.8855s
Updating learning rate to 0.0003996733558
Epoch: 2 cost time: 0.9958286285400391
Epoch: 2, Steps: 245 | Train Loss: 0.6305133 Vali Loss: 0.6063267 Best vali loss: 0.5989991
	iters: 100, epoch: 3 | loss: 0.7859290
	speed: 0.0081s/iter; left time: 11.0815s
	iters: 200, epoch: 3 | loss: 0.6163658
	speed: 0.0038s/iter; left time: 4.8018s
Updating learning rate to 0.0001998366779
Epoch: 3 cost time: 0.9929139614105225
Epoch: 3, Steps: 245 | Train Loss: 0.7011474 Vali Loss: 0.6251917 Best vali loss: 0.5989991
	iters: 100, epoch: 4 | loss: 0.7157151
	speed: 0.0076s/iter; left time: 8.5641s
	iters: 200, epoch: 4 | loss: 0.7504669
	speed: 0.0036s/iter; left time: 3.6628s
Updating learning rate to 9.991833895e-05
Epoch: 4 cost time: 0.9225060939788818
Epoch: 4, Steps: 245 | Train Loss: 0.7330910 Vali Loss: 0.6212276 Best vali loss: 0.5989991
	iters: 100, epoch: 5 | loss: 0.8573901
	speed: 0.0079s/iter; left time: 6.9920s
	iters: 200, epoch: 5 | loss: 0.8926040
	speed: 0.0039s/iter; left time: 3.0846s
Updating learning rate to 4.9959169475e-05
Epoch: 5 cost time: 0.9991874694824219
Epoch: 5, Steps: 245 | Train Loss: 0.8749970 Vali Loss: 0.6282679 Best vali loss: 0.5989991
	iters: 100, epoch: 6 | loss: 1.0283870
	speed: 0.0081s/iter; left time: 5.1535s
	iters: 200, epoch: 6 | loss: 0.8771366
	speed: 0.0039s/iter; left time: 2.0681s
Updating learning rate to 2.49795847375e-05
Epoch: 6 cost time: 1.0157063007354736
Epoch: 6, Steps: 245 | Train Loss: 0.9527618 Vali Loss: 0.6219566 Best vali loss: 0.5989991
	iters: 100, epoch: 7 | loss: 0.8465754
	speed: 0.0082s/iter; left time: 3.2071s
	iters: 200, epoch: 7 | loss: 0.6204251
	speed: 0.0037s/iter; left time: 1.0900s
Updating learning rate to 1.248979236875e-05
Epoch: 7 cost time: 0.9656665325164795
Epoch: 7, Steps: 245 | Train Loss: 0.7335003 Vali Loss: 0.6275810 Best vali loss: 0.5989991
	iters: 100, epoch: 8 | loss: 0.7489393
	speed: 0.0080s/iter; left time: 1.1723s
	iters: 200, epoch: 8 | loss: 1.0452105
	speed: 0.0038s/iter; left time: 0.1748s
Updating learning rate to 6.244896184375e-06
Epoch: 8 cost time: 1.0052158832550049
Epoch: 8, Steps: 245 | Train Loss: 0.8970749 Vali Loss: 0.6269033 Best vali loss: 0.5989991

best validation loss 0.5989990666860345

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0015534780108, 'e_layers': 2, 'learning_rate': 0.0029440678446, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0670075
	speed: 0.0110s/iter; left time: 9.7250s
Updating learning rate to 0.0028320159342752798
Validation loss decreased (inf --> 0.6270).  Saving model state dict ...
Epoch: 1 cost time: 0.9367971420288086
Epoch: 1, Steps: 123 | Train Loss: 1.0670075 Vali Loss: 0.6270366 Best vali loss: 0.6270366
	iters: 100, epoch: 2 | loss: 0.7111351
	speed: 0.0076s/iter; left time: 5.8179s
Updating learning rate to 0.0025129190908949614
Epoch: 2 cost time: 0.5817439556121826
Epoch: 2, Steps: 123 | Train Loss: 0.7111351 Vali Loss: 0.6377978 Best vali loss: 0.6270366
	iters: 100, epoch: 3 | loss: 0.8266095
	speed: 0.0071s/iter; left time: 4.5621s
Updating learning rate to 0.00203535691624361
Epoch: 3 cost time: 0.562183141708374
Epoch: 3, Steps: 123 | Train Loss: 0.8266095 Vali Loss: 0.6350930 Best vali loss: 0.6270366

best validation loss 0.6270365961609699

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014586339449, 'e_layers': 3, 'learning_rate': 0.0010492937372, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6991715
	speed: 0.0105s/iter; left time: 40.2537s
	iters: 200, epoch: 1 | loss: 0.7788455
	speed: 0.0041s/iter; left time: 15.1063s
	iters: 300, epoch: 1 | loss: 0.7127680
	speed: 0.0040s/iter; left time: 14.5007s
	iters: 400, epoch: 1 | loss: 1.2251348
	speed: 0.0042s/iter; left time: 14.8480s
Updating learning rate to 0.0010093573722956784
Validation loss decreased (inf --> 0.6823).  Saving model state dict ...
Epoch: 1 cost time: 2.380659818649292
Epoch: 1, Steps: 490 | Train Loss: 0.8539799 Vali Loss: 0.6822723 Best vali loss: 0.6822723
	iters: 100, epoch: 2 | loss: 1.4116539
	speed: 0.0122s/iter; left time: 40.7076s
	iters: 200, epoch: 2 | loss: 1.0008239
	speed: 0.0041s/iter; left time: 13.2463s
	iters: 300, epoch: 2 | loss: 1.3065131
	speed: 0.0041s/iter; left time: 12.8752s
	iters: 400, epoch: 2 | loss: 0.5079942
	speed: 0.0042s/iter; left time: 12.7276s
Updating learning rate to 0.0008956282271153476
Validation loss decreased (0.6823 --> 0.6439).  Saving model state dict ...
Epoch: 2 cost time: 2.0887579917907715
Epoch: 2, Steps: 490 | Train Loss: 1.0567463 Vali Loss: 0.6439183 Best vali loss: 0.6439183
	iters: 100, epoch: 3 | loss: 1.0445487
	speed: 0.0124s/iter; left time: 35.1955s
	iters: 200, epoch: 3 | loss: 1.3168188
	speed: 0.0047s/iter; left time: 13.0064s
	iters: 300, epoch: 3 | loss: 0.9054971
	speed: 0.0047s/iter; left time: 12.4354s
	iters: 400, epoch: 3 | loss: 0.8232344
	speed: 0.0046s/iter; left time: 11.6609s
Updating learning rate to 0.0007254205330554442
Epoch: 3 cost time: 2.3146896362304688
Epoch: 3, Steps: 490 | Train Loss: 1.0225248 Vali Loss: 0.6478369 Best vali loss: 0.6439183

best validation loss 0.6439183483185563

[INFO][smbo.py:320] Finished 1250 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013681179476, 'e_layers': 3, 'learning_rate': 9.56714667e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9376611
	speed: 0.0104s/iter; left time: 39.8530s
	iters: 200, epoch: 1 | loss: 0.5270362
	speed: 0.0044s/iter; left time: 16.4229s
	iters: 300, epoch: 1 | loss: 0.6564872
	speed: 0.0045s/iter; left time: 16.3130s
	iters: 400, epoch: 1 | loss: 0.6041212
	speed: 0.0044s/iter; left time: 15.6091s
Updating learning rate to 9.56714667e-05
Validation loss decreased (inf --> 0.6270).  Saving model state dict ...
Epoch: 1 cost time: 2.4828832149505615
Epoch: 1, Steps: 490 | Train Loss: 0.6813264 Vali Loss: 0.6270453 Best vali loss: 0.6270453
	iters: 100, epoch: 2 | loss: 1.4341362
	speed: 0.0115s/iter; left time: 38.4478s
	iters: 200, epoch: 2 | loss: 0.7586191
	speed: 0.0042s/iter; left time: 13.4140s
	iters: 300, epoch: 2 | loss: 0.7009944
	speed: 0.0043s/iter; left time: 13.5486s
	iters: 400, epoch: 2 | loss: 0.8448148
	speed: 0.0042s/iter; left time: 12.7975s
Updating learning rate to 4.783573335e-05
Validation loss decreased (0.6270 --> 0.5653).  Saving model state dict ...
Epoch: 2 cost time: 2.0833723545074463
Epoch: 2, Steps: 490 | Train Loss: 0.9346411 Vali Loss: 0.5653348 Best vali loss: 0.5653348
	iters: 100, epoch: 3 | loss: 0.4298434
	speed: 0.0120s/iter; left time: 34.0602s
	iters: 200, epoch: 3 | loss: 0.7305298
	speed: 0.0043s/iter; left time: 11.7976s
	iters: 300, epoch: 3 | loss: 0.8429769
	speed: 0.0043s/iter; left time: 11.4050s
	iters: 400, epoch: 3 | loss: 0.4240779
	speed: 0.0043s/iter; left time: 10.8598s
Updating learning rate to 2.3917866675e-05
Validation loss decreased (0.5653 --> 0.5616).  Saving model state dict ...
Epoch: 3 cost time: 2.135223150253296
Epoch: 3, Steps: 490 | Train Loss: 0.6068570 Vali Loss: 0.5616241 Best vali loss: 0.5616241

best validation loss 0.561624088506906

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013681179476, 'e_layers': 3, 'learning_rate': 9.56714667e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9093959
	speed: 0.0109s/iter; left time: 25.6303s
	iters: 200, epoch: 4 | loss: 0.4147177
	speed: 0.0045s/iter; left time: 10.1973s
	iters: 300, epoch: 4 | loss: 0.5344737
	speed: 0.0045s/iter; left time: 9.6435s
	iters: 400, epoch: 4 | loss: 0.5551108
	speed: 0.0043s/iter; left time: 8.8960s
Updating learning rate to 1.19589333375e-05
Validation loss decreased (0.5616 --> 0.5508).  Saving model state dict ...
Epoch: 4 cost time: 2.525670051574707
Epoch: 4, Steps: 490 | Train Loss: 0.6034245 Vali Loss: 0.5508062 Best vali loss: 0.5508062
	iters: 100, epoch: 5 | loss: 1.3858336
	speed: 0.0126s/iter; left time: 23.5330s
	iters: 200, epoch: 5 | loss: 0.7090912
	speed: 0.0039s/iter; left time: 6.8994s
	iters: 300, epoch: 5 | loss: 0.6521724
	speed: 0.0040s/iter; left time: 6.6066s
	iters: 400, epoch: 5 | loss: 0.8136494
	speed: 0.0039s/iter; left time: 6.0909s
Updating learning rate to 5.97946666875e-06
Validation loss decreased (0.5508 --> 0.5427).  Saving model state dict ...
Epoch: 5 cost time: 2.031506299972534
Epoch: 5, Steps: 490 | Train Loss: 0.8901867 Vali Loss: 0.5427396 Best vali loss: 0.5427396
	iters: 100, epoch: 6 | loss: 0.4207712
	speed: 0.0113s/iter; left time: 15.5491s
	iters: 200, epoch: 6 | loss: 0.7056763
	speed: 0.0039s/iter; left time: 4.9115s
	iters: 300, epoch: 6 | loss: 0.8044929
	speed: 0.0038s/iter; left time: 4.4926s
	iters: 400, epoch: 6 | loss: 0.4092681
	speed: 0.0041s/iter; left time: 4.3965s
Updating learning rate to 2.989733334375e-06
Validation loss decreased (0.5427 --> 0.5421).  Saving model state dict ...
Epoch: 6 cost time: 2.011998414993286
Epoch: 6, Steps: 490 | Train Loss: 0.5850521 Vali Loss: 0.5420544 Best vali loss: 0.5420544
	iters: 100, epoch: 7 | loss: 0.5741845
	speed: 0.0125s/iter; left time: 10.9997s
	iters: 200, epoch: 7 | loss: 0.6689059
	speed: 0.0044s/iter; left time: 3.4634s
	iters: 300, epoch: 7 | loss: 0.7655210
	speed: 0.0043s/iter; left time: 2.9065s
	iters: 400, epoch: 7 | loss: 0.3427887
	speed: 0.0046s/iter; left time: 2.6592s
Updating learning rate to 1.4948666671875e-06
Validation loss decreased (0.5421 --> 0.5400).  Saving model state dict ...
Epoch: 7 cost time: 2.2470946311950684
Epoch: 7, Steps: 490 | Train Loss: 0.5878500 Vali Loss: 0.5399716 Best vali loss: 0.5399716
	iters: 100, epoch: 8 | loss: 1.0381171
	speed: 0.0127s/iter; left time: 4.9742s
	iters: 200, epoch: 8 | loss: 0.7097553
	speed: 0.0045s/iter; left time: 1.3079s
	iters: 300, epoch: 8 | loss: 0.7710887
	speed: 0.0045s/iter; left time: 0.8617s
	iters: 400, epoch: 8 | loss: 0.6178492
	speed: 0.0042s/iter; left time: 0.3779s
Updating learning rate to 7.4743333359375e-07
Validation loss decreased (0.5400 --> 0.5393).  Saving model state dict ...
Epoch: 8 cost time: 2.192760467529297
Epoch: 8, Steps: 490 | Train Loss: 0.7842026 Vali Loss: 0.5393292 Best vali loss: 0.5393292

best validation loss 0.5393292448245944

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009695245916, 'e_layers': 1, 'learning_rate': 0.0001441982631, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6841415
	speed: 0.0099s/iter; left time: 8.7757s
Updating learning rate to 0.0001441982631
Validation loss decreased (inf --> 0.6625).  Saving model state dict ...
Epoch: 1 cost time: 0.8075103759765625
Epoch: 1, Steps: 123 | Train Loss: 0.6841415 Vali Loss: 0.6624559 Best vali loss: 0.6624559
	iters: 100, epoch: 2 | loss: 0.7065508
	speed: 0.0068s/iter; left time: 5.1488s
Updating learning rate to 7.209913155e-05
Validation loss decreased (0.6625 --> 0.6330).  Saving model state dict ...
Epoch: 2 cost time: 0.5059690475463867
Epoch: 2, Steps: 123 | Train Loss: 0.7065508 Vali Loss: 0.6330067 Best vali loss: 0.6330067
	iters: 100, epoch: 3 | loss: 0.7521196
	speed: 0.0063s/iter; left time: 4.0096s
Updating learning rate to 3.6049565775e-05
Validation loss decreased (0.6330 --> 0.6223).  Saving model state dict ...
Epoch: 3 cost time: 0.4731268882751465
Epoch: 3, Steps: 123 | Train Loss: 0.7521196 Vali Loss: 0.6222646 Best vali loss: 0.6222646
	iters: 100, epoch: 4 | loss: 0.9128404
	speed: 0.0063s/iter; left time: 3.2554s
Updating learning rate to 1.80247828875e-05
Validation loss decreased (0.6223 --> 0.6184).  Saving model state dict ...
Epoch: 4 cost time: 0.4666900634765625
Epoch: 4, Steps: 123 | Train Loss: 0.9128404 Vali Loss: 0.6184145 Best vali loss: 0.6184145
	iters: 100, epoch: 5 | loss: 0.9018237
	speed: 0.0063s/iter; left time: 2.4611s
Updating learning rate to 9.01239144375e-06
Validation loss decreased (0.6184 --> 0.6169).  Saving model state dict ...
Epoch: 5 cost time: 0.47397422790527344
Epoch: 5, Steps: 123 | Train Loss: 0.9018237 Vali Loss: 0.6168861 Best vali loss: 0.6168861
	iters: 100, epoch: 6 | loss: 0.9373435
	speed: 0.0065s/iter; left time: 1.7586s
Updating learning rate to 4.506195721875e-06
Validation loss decreased (0.6169 --> 0.6161).  Saving model state dict ...
Epoch: 6 cost time: 0.4641571044921875
Epoch: 6, Steps: 123 | Train Loss: 0.9373435 Vali Loss: 0.6161176 Best vali loss: 0.6161176
	iters: 100, epoch: 7 | loss: 0.8238104
	speed: 0.0062s/iter; left time: 0.9083s
Updating learning rate to 2.2530978609375e-06
Validation loss decreased (0.6161 --> 0.6158).  Saving model state dict ...
Epoch: 7 cost time: 0.4594290256500244
Epoch: 7, Steps: 123 | Train Loss: 0.8238104 Vali Loss: 0.6158207 Best vali loss: 0.6158207
	iters: 100, epoch: 8 | loss: 0.7055428
	speed: 0.0066s/iter; left time: 0.1594s
Updating learning rate to 1.12654893046875e-06
Validation loss decreased (0.6158 --> 0.6156).  Saving model state dict ...
Epoch: 8 cost time: 0.5081291198730469
Epoch: 8, Steps: 123 | Train Loss: 0.7055428 Vali Loss: 0.6156230 Best vali loss: 0.6156230

best validation loss 0.6156230097234056

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0035474904866, 'e_layers': 3, 'learning_rate': 9.54182405e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0922747
	speed: 0.0108s/iter; left time: 41.1455s
	iters: 200, epoch: 1 | loss: 0.6304240
	speed: 0.0046s/iter; left time: 16.9458s
	iters: 300, epoch: 1 | loss: 1.7047468
	speed: 0.0044s/iter; left time: 15.7974s
	iters: 400, epoch: 1 | loss: 0.5360591
	speed: 0.0042s/iter; left time: 14.6527s
Updating learning rate to 9.178659996309477e-05
Validation loss decreased (inf --> 0.6144).  Saving model state dict ...
Epoch: 1 cost time: 2.483797311782837
Epoch: 1, Steps: 490 | Train Loss: 0.9908762 Vali Loss: 0.6144226 Best vali loss: 0.6144226
	iters: 100, epoch: 2 | loss: 0.8187383
	speed: 0.0123s/iter; left time: 41.0927s
	iters: 200, epoch: 2 | loss: 0.5720822
	speed: 0.0047s/iter; left time: 15.2109s
	iters: 300, epoch: 2 | loss: 1.1172732
	speed: 0.0047s/iter; left time: 14.6141s
	iters: 400, epoch: 2 | loss: 1.3110973
	speed: 0.0046s/iter; left time: 14.0288s
Updating learning rate to 8.144456270321943e-05
Validation loss decreased (0.6144 --> 0.5642).  Saving model state dict ...
Epoch: 2 cost time: 2.3026881217956543
Epoch: 2, Steps: 490 | Train Loss: 0.9547977 Vali Loss: 0.5641969 Best vali loss: 0.5641969
	iters: 100, epoch: 3 | loss: 0.7497812
	speed: 0.0129s/iter; left time: 36.5467s
	iters: 200, epoch: 3 | loss: 0.4147388
	speed: 0.0046s/iter; left time: 12.6371s
	iters: 300, epoch: 3 | loss: 0.6743643
	speed: 0.0047s/iter; left time: 12.4380s
	iters: 400, epoch: 3 | loss: 0.5492147
	speed: 0.0047s/iter; left time: 11.9603s
Updating learning rate to 6.596661014238881e-05
Validation loss decreased (0.5642 --> 0.5520).  Saving model state dict ...
Epoch: 3 cost time: 2.344717502593994
Epoch: 3, Steps: 490 | Train Loss: 0.5970247 Vali Loss: 0.5519836 Best vali loss: 0.5519836
	iters: 100, epoch: 4 | loss: 0.7545522
	speed: 0.0126s/iter; left time: 29.6023s
	iters: 200, epoch: 4 | loss: 0.5751171
	speed: 0.0046s/iter; left time: 10.3322s
	iters: 300, epoch: 4 | loss: 0.8419743
	speed: 0.0045s/iter; left time: 9.6874s
	iters: 400, epoch: 4 | loss: 0.8160294
	speed: 0.0046s/iter; left time: 9.3462s
Updating learning rate to 4.770912025e-05
Validation loss decreased (0.5520 --> 0.5500).  Saving model state dict ...
Epoch: 4 cost time: 2.248431444168091
Epoch: 4, Steps: 490 | Train Loss: 0.7469182 Vali Loss: 0.5500056 Best vali loss: 0.5500056
	iters: 100, epoch: 5 | loss: 0.8388255
	speed: 0.0127s/iter; left time: 23.6880s
	iters: 200, epoch: 5 | loss: 0.3844471
	speed: 0.0046s/iter; left time: 8.1685s
	iters: 300, epoch: 5 | loss: 0.9921829
	speed: 0.0046s/iter; left time: 7.6519s
	iters: 400, epoch: 5 | loss: 0.5828288
	speed: 0.0045s/iter; left time: 7.0216s
Updating learning rate to 2.945163035761119e-05
Validation loss decreased (0.5500 --> 0.5293).  Saving model state dict ...
Epoch: 5 cost time: 2.2516257762908936
Epoch: 5, Steps: 490 | Train Loss: 0.6995710 Vali Loss: 0.5293236 Best vali loss: 0.5293236
	iters: 100, epoch: 6 | loss: 0.5832549
	speed: 0.0121s/iter; left time: 16.6190s
	iters: 200, epoch: 6 | loss: 0.9433288
	speed: 0.0042s/iter; left time: 5.3507s
	iters: 300, epoch: 6 | loss: 0.4620047
	speed: 0.0042s/iter; left time: 4.9139s
	iters: 400, epoch: 6 | loss: 0.8880925
	speed: 0.0042s/iter; left time: 4.5193s
Updating learning rate to 1.397367779678057e-05
Epoch: 6 cost time: 2.0847480297088623
Epoch: 6, Steps: 490 | Train Loss: 0.7191702 Vali Loss: 0.5416445 Best vali loss: 0.5293236
	iters: 100, epoch: 7 | loss: 0.4962749
	speed: 0.0119s/iter; left time: 10.4924s
	iters: 200, epoch: 7 | loss: 0.5542102
	speed: 0.0048s/iter; left time: 3.7175s
	iters: 300, epoch: 7 | loss: 0.5703944
	speed: 0.0047s/iter; left time: 3.1810s
	iters: 400, epoch: 7 | loss: 0.4504225
	speed: 0.0047s/iter; left time: 2.7082s
Updating learning rate to 3.6316405369052366e-06
Epoch: 7 cost time: 2.3455448150634766
Epoch: 7, Steps: 490 | Train Loss: 0.5178255 Vali Loss: 0.5506867 Best vali loss: 0.5293236
	iters: 100, epoch: 8 | loss: 0.3891489
	speed: 0.0121s/iter; left time: 4.7275s
	iters: 200, epoch: 8 | loss: 0.5730452
	speed: 0.0042s/iter; left time: 1.2078s
	iters: 300, epoch: 8 | loss: 0.4784492
	speed: 0.0042s/iter; left time: 0.7970s
	iters: 400, epoch: 8 | loss: 0.8093780
	speed: 0.0042s/iter; left time: 0.3794s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0913610458374023
Epoch: 8, Steps: 490 | Train Loss: 0.5625053 Vali Loss: 0.5471840 Best vali loss: 0.5293236

best validation loss 0.5293235673997094

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043913101384, 'e_layers': 2, 'learning_rate': 0.0001758342357, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7965785
	speed: 0.0113s/iter; left time: 9.9690s
Updating learning rate to 0.0001691419435889977
Validation loss decreased (inf --> 0.5942).  Saving model state dict ...
Epoch: 1 cost time: 0.96917724609375
Epoch: 1, Steps: 123 | Train Loss: 0.7965785 Vali Loss: 0.5941665 Best vali loss: 0.5941665
	iters: 100, epoch: 2 | loss: 0.9402836
	speed: 0.0087s/iter; left time: 6.5918s
Updating learning rate to 0.00015008390806411185
Validation loss decreased (0.5942 --> 0.5896).  Saving model state dict ...
Epoch: 2 cost time: 0.6685912609100342
Epoch: 2, Steps: 123 | Train Loss: 0.9402836 Vali Loss: 0.5895868 Best vali loss: 0.5895868
	iters: 100, epoch: 3 | loss: 0.7473019
	speed: 0.0087s/iter; left time: 5.5854s
Updating learning rate to 0.0001215615422724841
Validation loss decreased (0.5896 --> 0.5581).  Saving model state dict ...
Epoch: 3 cost time: 0.6677799224853516
Epoch: 3, Steps: 123 | Train Loss: 0.7473019 Vali Loss: 0.5580566 Best vali loss: 0.5580566

best validation loss 0.5580565981266952

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0106083393424, 'e_layers': 3, 'learning_rate': 9.55686487e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7020621
	speed: 0.0106s/iter; left time: 40.6370s
	iters: 200, epoch: 1 | loss: 0.8132063
	speed: 0.0045s/iter; left time: 16.8703s
	iters: 300, epoch: 1 | loss: 0.3971199
	speed: 0.0045s/iter; left time: 16.3304s
	iters: 400, epoch: 1 | loss: 0.9718148
	speed: 0.0046s/iter; left time: 16.3009s
Updating learning rate to 9.19312835918457e-05
Validation loss decreased (inf --> 0.6079).  Saving model state dict ...
Epoch: 1 cost time: 2.578186511993408
Epoch: 1, Steps: 490 | Train Loss: 0.7210507 Vali Loss: 0.6078609 Best vali loss: 0.6078609
	iters: 100, epoch: 2 | loss: 1.0667273
	speed: 0.0129s/iter; left time: 42.8565s
	iters: 200, epoch: 2 | loss: 0.7386369
	speed: 0.0045s/iter; left time: 14.6797s
	iters: 300, epoch: 2 | loss: 0.8815027
	speed: 0.0045s/iter; left time: 14.1665s
	iters: 400, epoch: 2 | loss: 0.7573471
	speed: 0.0045s/iter; left time: 13.6660s
Updating learning rate to 8.157294413230246e-05
Validation loss decreased (0.6079 --> 0.5482).  Saving model state dict ...
Epoch: 2 cost time: 2.2655396461486816
Epoch: 2, Steps: 490 | Train Loss: 0.8610535 Vali Loss: 0.5482251 Best vali loss: 0.5482251
	iters: 100, epoch: 3 | loss: 1.2231910
	speed: 0.0126s/iter; left time: 35.7486s
	iters: 200, epoch: 3 | loss: 0.5638855
	speed: 0.0045s/iter; left time: 12.3170s
	iters: 300, epoch: 3 | loss: 0.7953830
	speed: 0.0046s/iter; left time: 12.0206s
	iters: 400, epoch: 3 | loss: 0.5810673
	speed: 0.0046s/iter; left time: 11.7341s
Updating learning rate to 6.607059360550474e-05
Epoch: 3 cost time: 2.2688066959381104
Epoch: 3, Steps: 490 | Train Loss: 0.7908817 Vali Loss: 0.5646918 Best vali loss: 0.5482251

best validation loss 0.5482251330251663

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0047340727532, 'e_layers': 3, 'learning_rate': 0.0014684351836, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5089863
	speed: 0.0104s/iter; left time: 80.7476s
	iters: 200, epoch: 1 | loss: 0.2509047
	speed: 0.0044s/iter; left time: 33.3225s
	iters: 300, epoch: 1 | loss: 0.6304983
	speed: 0.0043s/iter; left time: 32.3733s
	iters: 400, epoch: 1 | loss: 0.4231790
	speed: 0.0043s/iter; left time: 32.2782s
	iters: 500, epoch: 1 | loss: 0.4856046
	speed: 0.0044s/iter; left time: 32.1938s
	iters: 600, epoch: 1 | loss: 1.6497009
	speed: 0.0044s/iter; left time: 31.8855s
	iters: 700, epoch: 1 | loss: 0.2747951
	speed: 0.0044s/iter; left time: 31.3817s
	iters: 800, epoch: 1 | loss: 1.1469676
	speed: 0.0044s/iter; left time: 30.9701s
	iters: 900, epoch: 1 | loss: 1.2086833
	speed: 0.0044s/iter; left time: 30.4927s
Updating learning rate to 0.0014684351836
Validation loss decreased (inf --> 0.6131).  Saving model state dict ...
Epoch: 1 cost time: 4.618657112121582
Epoch: 1, Steps: 979 | Train Loss: 0.7310355 Vali Loss: 0.6131371 Best vali loss: 0.6131371
	iters: 100, epoch: 2 | loss: 0.6956124
	speed: 0.0128s/iter; left time: 86.4344s
	iters: 200, epoch: 2 | loss: 0.4574523
	speed: 0.0038s/iter; left time: 25.5625s
	iters: 300, epoch: 2 | loss: 0.5922627
	speed: 0.0037s/iter; left time: 24.1800s
	iters: 400, epoch: 2 | loss: 0.6283715
	speed: 0.0037s/iter; left time: 23.9731s
	iters: 500, epoch: 2 | loss: 0.7275723
	speed: 0.0038s/iter; left time: 23.9583s
	iters: 600, epoch: 2 | loss: 0.4990767
	speed: 0.0037s/iter; left time: 23.2842s
	iters: 700, epoch: 2 | loss: 1.4597856
	speed: 0.0038s/iter; left time: 23.2766s
	iters: 800, epoch: 2 | loss: 0.8050234
	speed: 0.0036s/iter; left time: 21.6232s
	iters: 900, epoch: 2 | loss: 0.6368653
	speed: 0.0037s/iter; left time: 21.7327s
Updating learning rate to 0.0007342175918
Epoch: 2 cost time: 3.6836204528808594
Epoch: 2, Steps: 979 | Train Loss: 0.7224469 Vali Loss: 0.6209394 Best vali loss: 0.6131371
	iters: 100, epoch: 3 | loss: 0.8797075
	speed: 0.0121s/iter; left time: 69.5917s
	iters: 200, epoch: 3 | loss: 1.1938241
	speed: 0.0037s/iter; left time: 20.7819s
	iters: 300, epoch: 3 | loss: 0.8832185
	speed: 0.0037s/iter; left time: 20.3825s
	iters: 400, epoch: 3 | loss: 0.3221374
	speed: 0.0037s/iter; left time: 20.1464s
	iters: 500, epoch: 3 | loss: 0.8684299
	speed: 0.0038s/iter; left time: 20.5625s
	iters: 600, epoch: 3 | loss: 0.5730543
	speed: 0.0038s/iter; left time: 20.1322s
	iters: 700, epoch: 3 | loss: 0.7491582
	speed: 0.0038s/iter; left time: 19.6154s
	iters: 800, epoch: 3 | loss: 0.6813318
	speed: 0.0037s/iter; left time: 18.5682s
	iters: 900, epoch: 3 | loss: 0.5690193
	speed: 0.0036s/iter; left time: 17.6990s
Updating learning rate to 0.0003671087959
Epoch: 3 cost time: 3.654299020767212
Epoch: 3, Steps: 979 | Train Loss: 0.7466534 Vali Loss: 0.6358498 Best vali loss: 0.6131371

best validation loss 0.6131370846718233

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0106083393424, 'e_layers': 3, 'learning_rate': 9.55686487e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6496952
	speed: 0.0111s/iter; left time: 26.0239s
	iters: 200, epoch: 4 | loss: 0.5773883
	speed: 0.0045s/iter; left time: 10.0794s
	iters: 300, epoch: 4 | loss: 0.3914119
	speed: 0.0045s/iter; left time: 9.7447s
	iters: 400, epoch: 4 | loss: 0.6469430
	speed: 0.0045s/iter; left time: 9.2519s
Updating learning rate to 4.778432435e-05
Epoch: 4 cost time: 2.576756000518799
Epoch: 4, Steps: 490 | Train Loss: 0.5663596 Vali Loss: 0.5494735 Best vali loss: 0.5482251
	iters: 100, epoch: 5 | loss: 0.8929149
	speed: 0.0121s/iter; left time: 22.4494s
	iters: 200, epoch: 5 | loss: 0.6481736
	speed: 0.0042s/iter; left time: 7.4458s
	iters: 300, epoch: 5 | loss: 0.7335643
	speed: 0.0042s/iter; left time: 6.9231s
	iters: 400, epoch: 5 | loss: 0.7254630
	speed: 0.0042s/iter; left time: 6.5423s
Updating learning rate to 2.9498055094495265e-05
Validation loss decreased (0.5482 --> 0.5421).  Saving model state dict ...
Epoch: 5 cost time: 2.111663341522217
Epoch: 5, Steps: 490 | Train Loss: 0.7500289 Vali Loss: 0.5420679 Best vali loss: 0.5420679
	iters: 100, epoch: 6 | loss: 1.1003220
	speed: 0.0124s/iter; left time: 17.0102s
	iters: 200, epoch: 6 | loss: 0.4467528
	speed: 0.0046s/iter; left time: 5.8964s
	iters: 300, epoch: 6 | loss: 0.7356036
	speed: 0.0046s/iter; left time: 5.4305s
	iters: 400, epoch: 6 | loss: 0.5406347
	speed: 0.0046s/iter; left time: 4.9471s
Updating learning rate to 1.3995704567697537e-05
Validation loss decreased (0.5421 --> 0.5417).  Saving model state dict ...
Epoch: 6 cost time: 2.2926549911499023
Epoch: 6, Steps: 490 | Train Loss: 0.7058283 Vali Loss: 0.5417042 Best vali loss: 0.5417042
	iters: 100, epoch: 7 | loss: 0.6653374
	speed: 0.0126s/iter; left time: 11.1305s
	iters: 200, epoch: 7 | loss: 0.9346451
	speed: 0.0045s/iter; left time: 3.4785s
	iters: 300, epoch: 7 | loss: 1.1072834
	speed: 0.0046s/iter; left time: 3.1052s
	iters: 400, epoch: 7 | loss: 0.3993485
	speed: 0.0045s/iter; left time: 2.6317s
Updating learning rate to 3.637365108154304e-06
Epoch: 7 cost time: 2.253769874572754
Epoch: 7, Steps: 490 | Train Loss: 0.7766536 Vali Loss: 0.5421965 Best vali loss: 0.5417042
	iters: 100, epoch: 8 | loss: 0.4416099
	speed: 0.0120s/iter; left time: 4.6774s
	iters: 200, epoch: 8 | loss: 1.0156246
	speed: 0.0042s/iter; left time: 1.2097s
	iters: 300, epoch: 8 | loss: 0.4667706
	speed: 0.0045s/iter; left time: 0.8596s
	iters: 400, epoch: 8 | loss: 0.4936068
	speed: 0.0046s/iter; left time: 0.4162s
Updating learning rate to 0.0
Validation loss decreased (0.5417 --> 0.5401).  Saving model state dict ...
Epoch: 8 cost time: 2.2057719230651855
Epoch: 8, Steps: 490 | Train Loss: 0.6044030 Vali Loss: 0.5401452 Best vali loss: 0.5401452

best validation loss 0.5401452093254576

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0030961180748, 'e_layers': 3, 'learning_rate': 0.0033590169407, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003231171970785704
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 0.7592003345489502
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6217230 Best vali loss: 0.6217230
Updating learning rate to 0.0028671002987947303
Validation loss decreased (0.6217 --> 0.6183).  Saving model state dict ...
Epoch: 2 cost time: 0.4667177200317383
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6182707 Best vali loss: 0.6182707
Updating learning rate to 0.0023222285364697796
Epoch: 3 cost time: 0.44863295555114746
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6260766 Best vali loss: 0.6182707
Updating learning rate to 0.00167950847035
Epoch: 4 cost time: 0.4660367965698242
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6246148 Best vali loss: 0.6182707
Updating learning rate to 0.0010367884042302206
Epoch: 5 cost time: 0.4400303363800049
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6362992 Best vali loss: 0.6182707
Updating learning rate to 0.0004919166419052695
Epoch: 6 cost time: 0.46189427375793457
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6518350 Best vali loss: 0.6182707
Updating learning rate to 0.00012784496991429572
Epoch: 7 cost time: 0.45293617248535156
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6561849 Best vali loss: 0.6182707
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45662379264831543
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6460079 Best vali loss: 0.6182707

best validation loss 0.618270741188653

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0100174833295, 'e_layers': 1, 'learning_rate': 0.0012282570044, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2599282
	speed: 0.0085s/iter; left time: 65.6044s
	iters: 200, epoch: 1 | loss: 0.8275558
	speed: 0.0025s/iter; left time: 19.0244s
	iters: 300, epoch: 1 | loss: 1.1720091
	speed: 0.0024s/iter; left time: 18.3481s
	iters: 400, epoch: 1 | loss: 0.3001401
	speed: 0.0025s/iter; left time: 18.7734s
	iters: 500, epoch: 1 | loss: 0.5689301
	speed: 0.0025s/iter; left time: 18.5060s
	iters: 600, epoch: 1 | loss: 1.1431131
	speed: 0.0025s/iter; left time: 17.9672s
	iters: 700, epoch: 1 | loss: 0.7683004
	speed: 0.0024s/iter; left time: 17.4256s
	iters: 800, epoch: 1 | loss: 0.6802517
	speed: 0.0025s/iter; left time: 17.2382s
	iters: 900, epoch: 1 | loss: 0.4369682
	speed: 0.0025s/iter; left time: 17.4682s
Updating learning rate to 0.0011815092557143929
Validation loss decreased (inf --> 0.6138).  Saving model state dict ...
Epoch: 1 cost time: 2.7587969303131104
Epoch: 1, Steps: 979 | Train Loss: 0.6841330 Vali Loss: 0.6137637 Best vali loss: 0.6137637
	iters: 100, epoch: 2 | loss: 0.9763198
	speed: 0.0088s/iter; left time: 59.5871s
	iters: 200, epoch: 2 | loss: 0.9705555
	speed: 0.0024s/iter; left time: 15.7182s
	iters: 300, epoch: 2 | loss: 0.8590991
	speed: 0.0024s/iter; left time: 15.4573s
	iters: 400, epoch: 2 | loss: 1.4086798
	speed: 0.0024s/iter; left time: 15.2547s
	iters: 500, epoch: 2 | loss: 0.2295978
	speed: 0.0023s/iter; left time: 14.7846s
	iters: 600, epoch: 2 | loss: 0.3251477
	speed: 0.0023s/iter; left time: 14.6135s
	iters: 700, epoch: 2 | loss: 0.3758654
	speed: 0.0024s/iter; left time: 14.4660s
	iters: 800, epoch: 2 | loss: 1.8440263
	speed: 0.0023s/iter; left time: 13.6277s
	iters: 900, epoch: 2 | loss: 0.4672229
	speed: 0.0022s/iter; left time: 13.2686s
Updating learning rate to 0.0010483829306255576
Validation loss decreased (0.6138 --> 0.6068).  Saving model state dict ...
Epoch: 2 cost time: 2.327556610107422
Epoch: 2, Steps: 979 | Train Loss: 0.8285016 Vali Loss: 0.6068353 Best vali loss: 0.6068353
	iters: 100, epoch: 3 | loss: 0.5435594
	speed: 0.0086s/iter; left time: 49.8980s
	iters: 200, epoch: 3 | loss: 0.6163104
	speed: 0.0023s/iter; left time: 12.9338s
	iters: 300, epoch: 3 | loss: 0.6235259
	speed: 0.0023s/iter; left time: 12.9854s
	iters: 400, epoch: 3 | loss: 1.5364543
	speed: 0.0024s/iter; left time: 12.9065s
	iters: 500, epoch: 3 | loss: 0.4755185
	speed: 0.0024s/iter; left time: 12.9726s
	iters: 600, epoch: 3 | loss: 0.2933517
	speed: 0.0023s/iter; left time: 12.3086s
	iters: 700, epoch: 3 | loss: 0.5367067
	speed: 0.0023s/iter; left time: 12.1566s
	iters: 800, epoch: 3 | loss: 0.3844019
	speed: 0.0024s/iter; left time: 12.0019s
	iters: 900, epoch: 3 | loss: 0.7068129
	speed: 0.0025s/iter; left time: 12.2103s
Updating learning rate to 0.0008491453053351277
Epoch: 3 cost time: 2.352208137512207
Epoch: 3, Steps: 979 | Train Loss: 0.6351824 Vali Loss: 0.6321698 Best vali loss: 0.6068353
	iters: 100, epoch: 4 | loss: 0.5165726
	speed: 0.0085s/iter; left time: 40.8337s
	iters: 200, epoch: 4 | loss: 0.3309224
	speed: 0.0023s/iter; left time: 10.6272s
	iters: 300, epoch: 4 | loss: 0.4654333
	speed: 0.0023s/iter; left time: 10.7327s
	iters: 400, epoch: 4 | loss: 1.1673206
	speed: 0.0023s/iter; left time: 10.4041s
	iters: 500, epoch: 4 | loss: 0.4563030
	speed: 0.0024s/iter; left time: 10.4410s
	iters: 600, epoch: 4 | loss: 0.5020054
	speed: 0.0023s/iter; left time: 9.9340s
	iters: 700, epoch: 4 | loss: 0.8864981
	speed: 0.0024s/iter; left time: 10.1385s
	iters: 800, epoch: 4 | loss: 0.9755119
	speed: 0.0024s/iter; left time: 9.6838s
	iters: 900, epoch: 4 | loss: 1.6743711
	speed: 0.0023s/iter; left time: 9.2465s
Updating learning rate to 0.0006141285022
Epoch: 4 cost time: 2.3200769424438477
Epoch: 4, Steps: 979 | Train Loss: 0.7749932 Vali Loss: 0.6317421 Best vali loss: 0.6068353
	iters: 100, epoch: 5 | loss: 0.5220221
	speed: 0.0085s/iter; left time: 32.4849s
	iters: 200, epoch: 5 | loss: 0.8503765
	speed: 0.0024s/iter; left time: 8.8295s
	iters: 300, epoch: 5 | loss: 0.4569972
	speed: 0.0024s/iter; left time: 8.7535s
	iters: 400, epoch: 5 | loss: 1.6190085
	speed: 0.0023s/iter; left time: 8.2119s
	iters: 500, epoch: 5 | loss: 0.5761620
	speed: 0.0023s/iter; left time: 7.9941s
	iters: 600, epoch: 5 | loss: 0.8294715
	speed: 0.0024s/iter; left time: 7.8246s
	iters: 700, epoch: 5 | loss: 0.6008984
	speed: 0.0023s/iter; left time: 7.4626s
	iters: 800, epoch: 5 | loss: 0.3853472
	speed: 0.0023s/iter; left time: 7.2501s
	iters: 900, epoch: 5 | loss: 0.8599914
	speed: 0.0025s/iter; left time: 7.3990s
Updating learning rate to 0.00037911169906487246
Epoch: 5 cost time: 2.35212779045105
Epoch: 5, Steps: 979 | Train Loss: 0.7444750 Vali Loss: 0.6839466 Best vali loss: 0.6068353
	iters: 100, epoch: 6 | loss: 0.3953323
	speed: 0.0085s/iter; left time: 24.2405s
	iters: 200, epoch: 6 | loss: 0.2571558
	speed: 0.0023s/iter; left time: 6.1835s
	iters: 300, epoch: 6 | loss: 0.4457755
	speed: 0.0023s/iter; left time: 6.1005s
	iters: 400, epoch: 6 | loss: 0.7152522
	speed: 0.0024s/iter; left time: 6.1230s
	iters: 500, epoch: 6 | loss: 1.1935819
	speed: 0.0024s/iter; left time: 5.8558s
	iters: 600, epoch: 6 | loss: 0.5063516
	speed: 0.0023s/iter; left time: 5.3913s
	iters: 700, epoch: 6 | loss: 0.4833072
	speed: 0.0024s/iter; left time: 5.2800s
	iters: 800, epoch: 6 | loss: 1.1399969
	speed: 0.0025s/iter; left time: 5.3741s
	iters: 900, epoch: 6 | loss: 0.6700414
	speed: 0.0024s/iter; left time: 4.8721s
Updating learning rate to 0.00017987407377444248
Epoch: 6 cost time: 2.368187427520752
Epoch: 6, Steps: 979 | Train Loss: 0.6451994 Vali Loss: 0.6937489 Best vali loss: 0.6068353
	iters: 100, epoch: 7 | loss: 0.6982668
	speed: 0.0092s/iter; left time: 17.0264s
	iters: 200, epoch: 7 | loss: 0.8726952
	speed: 0.0025s/iter; left time: 4.4545s
	iters: 300, epoch: 7 | loss: 0.5597222
	speed: 0.0025s/iter; left time: 4.1846s
	iters: 400, epoch: 7 | loss: 0.3884343
	speed: 0.0025s/iter; left time: 3.9056s
	iters: 500, epoch: 7 | loss: 0.6773560
	speed: 0.0025s/iter; left time: 3.6819s
	iters: 600, epoch: 7 | loss: 0.2566722
	speed: 0.0025s/iter; left time: 3.4086s
	iters: 700, epoch: 7 | loss: 0.8840526
	speed: 0.0024s/iter; left time: 3.0363s
	iters: 800, epoch: 7 | loss: 0.2696849
	speed: 0.0023s/iter; left time: 2.6209s
	iters: 900, epoch: 7 | loss: 0.4447975
	speed: 0.0022s/iter; left time: 2.3531s
Updating learning rate to 4.6747748685607276e-05
Epoch: 7 cost time: 2.422717809677124
Epoch: 7, Steps: 979 | Train Loss: 0.5612980 Vali Loss: 0.7091871 Best vali loss: 0.6068353
	iters: 100, epoch: 8 | loss: 1.1128451
	speed: 0.0086s/iter; left time: 7.5434s
	iters: 200, epoch: 8 | loss: 0.5873110
	speed: 0.0023s/iter; left time: 1.7902s
	iters: 300, epoch: 8 | loss: 0.9853966
	speed: 0.0022s/iter; left time: 1.5054s
	iters: 400, epoch: 8 | loss: 1.2519512
	speed: 0.0022s/iter; left time: 1.3045s
	iters: 500, epoch: 8 | loss: 0.7337666
	speed: 0.0023s/iter; left time: 1.0901s
	iters: 600, epoch: 8 | loss: 1.2356445
	speed: 0.0023s/iter; left time: 0.8586s
	iters: 700, epoch: 8 | loss: 1.2037202
	speed: 0.0022s/iter; left time: 0.6194s
	iters: 800, epoch: 8 | loss: 0.2496739
	speed: 0.0022s/iter; left time: 0.3900s
	iters: 900, epoch: 8 | loss: 0.5663385
	speed: 0.0022s/iter; left time: 0.1775s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.236783027648926
Epoch: 8, Steps: 979 | Train Loss: 0.8807386 Vali Loss: 0.7118079 Best vali loss: 0.6068353

best validation loss 0.6068352611941465

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.001110862026, 'e_layers': 2, 'learning_rate': 0.003684572401, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3440949
	speed: 0.0095s/iter; left time: 73.4350s
	iters: 200, epoch: 1 | loss: 0.6537989
	speed: 0.0031s/iter; left time: 24.0282s
	iters: 300, epoch: 1 | loss: 0.5974187
	speed: 0.0032s/iter; left time: 24.2401s
	iters: 400, epoch: 1 | loss: 1.1464193
	speed: 0.0032s/iter; left time: 23.6926s
	iters: 500, epoch: 1 | loss: 0.9218587
	speed: 0.0031s/iter; left time: 22.7132s
	iters: 600, epoch: 1 | loss: 0.4047332
	speed: 0.0033s/iter; left time: 23.7433s
	iters: 700, epoch: 1 | loss: 1.0375162
	speed: 0.0033s/iter; left time: 23.2824s
	iters: 800, epoch: 1 | loss: 0.6132664
	speed: 0.0034s/iter; left time: 23.6758s
	iters: 900, epoch: 1 | loss: 1.0295951
	speed: 0.0034s/iter; left time: 23.5240s
Updating learning rate to 0.0035443367141699345
Validation loss decreased (inf --> 0.6498).  Saving model state dict ...
Epoch: 1 cost time: 3.5278775691986084
Epoch: 1, Steps: 979 | Train Loss: 0.7498557 Vali Loss: 0.6498432 Best vali loss: 0.6498432
	iters: 100, epoch: 2 | loss: 1.6114018
	speed: 0.0110s/iter; left time: 74.2078s
	iters: 200, epoch: 2 | loss: 0.9698595
	speed: 0.0031s/iter; left time: 20.7205s
	iters: 300, epoch: 2 | loss: 0.2433847
	speed: 0.0033s/iter; left time: 21.5528s
	iters: 400, epoch: 2 | loss: 0.6544194
	speed: 0.0032s/iter; left time: 20.8319s
	iters: 500, epoch: 2 | loss: 0.7405175
	speed: 0.0034s/iter; left time: 21.3463s
	iters: 600, epoch: 2 | loss: 0.6375197
	speed: 0.0033s/iter; left time: 20.8170s
	iters: 700, epoch: 2 | loss: 0.6554760
	speed: 0.0033s/iter; left time: 20.1003s
	iters: 800, epoch: 2 | loss: 0.9311627
	speed: 0.0032s/iter; left time: 19.3087s
	iters: 900, epoch: 2 | loss: 0.5656163
	speed: 0.0032s/iter; left time: 18.7794s
Updating learning rate to 0.003144979265759949
Validation loss decreased (0.6498 --> 0.6498).  Saving model state dict ...
Epoch: 2 cost time: 3.215428113937378
Epoch: 2, Steps: 979 | Train Loss: 0.7788175 Vali Loss: 0.6497832 Best vali loss: 0.6497832
	iters: 100, epoch: 3 | loss: 1.1843781
	speed: 0.0111s/iter; left time: 63.8849s
	iters: 200, epoch: 3 | loss: 0.3773537
	speed: 0.0033s/iter; left time: 18.5631s
	iters: 300, epoch: 3 | loss: 0.6700791
	speed: 0.0032s/iter; left time: 17.9869s
	iters: 400, epoch: 3 | loss: 1.2515677
	speed: 0.0033s/iter; left time: 18.0011s
	iters: 500, epoch: 3 | loss: 0.5915400
	speed: 0.0032s/iter; left time: 17.2450s
	iters: 600, epoch: 3 | loss: 0.3356386
	speed: 0.0033s/iter; left time: 17.3004s
	iters: 700, epoch: 3 | loss: 0.3047917
	speed: 0.0034s/iter; left time: 17.5190s
	iters: 800, epoch: 3 | loss: 0.3563285
	speed: 0.0033s/iter; left time: 16.9796s
	iters: 900, epoch: 3 | loss: 0.4811917
	speed: 0.0032s/iter; left time: 15.8414s
Updating learning rate to 0.00254729860710618
Validation loss decreased (0.6498 --> 0.6402).  Saving model state dict ...
Epoch: 3 cost time: 3.233736753463745
Epoch: 3, Steps: 979 | Train Loss: 0.6169855 Vali Loss: 0.6402180 Best vali loss: 0.6402180

best validation loss 0.6402180183339262

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.003798964227, 'e_layers': 4, 'learning_rate': 9.50459403e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1244265
	speed: 0.0116s/iter; left time: 44.1781s
	iters: 200, epoch: 1 | loss: 0.6272268
	speed: 0.0055s/iter; left time: 20.4151s
	iters: 300, epoch: 1 | loss: 0.9053540
	speed: 0.0055s/iter; left time: 19.9228s
	iters: 400, epoch: 1 | loss: 0.7406083
	speed: 0.0056s/iter; left time: 19.5441s
Updating learning rate to 9.142846959572983e-05
Validation loss decreased (inf --> 0.6125).  Saving model state dict ...
Epoch: 1 cost time: 3.044111490249634
Epoch: 1, Steps: 490 | Train Loss: 0.8494039 Vali Loss: 0.6124986 Best vali loss: 0.6124986
	iters: 100, epoch: 2 | loss: 1.2363856
	speed: 0.0150s/iter; left time: 49.8124s
	iters: 200, epoch: 2 | loss: 0.9122810
	speed: 0.0055s/iter; left time: 17.6454s
	iters: 300, epoch: 2 | loss: 1.1101360
	speed: 0.0055s/iter; left time: 17.2719s
	iters: 400, epoch: 2 | loss: 0.5974661
	speed: 0.0055s/iter; left time: 16.7153s
Updating learning rate to 8.112678460519087e-05
Epoch: 2 cost time: 2.7430970668792725
Epoch: 2, Steps: 490 | Train Loss: 0.9640672 Vali Loss: 0.6532605 Best vali loss: 0.6124986
	iters: 100, epoch: 3 | loss: 0.7366768
	speed: 0.0146s/iter; left time: 41.4739s
	iters: 200, epoch: 3 | loss: 0.4435823
	speed: 0.0055s/iter; left time: 14.9714s
	iters: 300, epoch: 3 | loss: 0.5580212
	speed: 0.0055s/iter; left time: 14.6503s
	iters: 400, epoch: 3 | loss: 0.4819674
	speed: 0.0056s/iter; left time: 14.2660s
Updating learning rate to 6.570922348318571e-05
Validation loss decreased (0.6125 --> 0.5469).  Saving model state dict ...
Epoch: 3 cost time: 2.759355306625366
Epoch: 3, Steps: 490 | Train Loss: 0.5550619 Vali Loss: 0.5469244 Best vali loss: 0.5469244

best validation loss 0.5469244050447282

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0036967267052, 'e_layers': 4, 'learning_rate': 9.5310083e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1243117
	speed: 0.0116s/iter; left time: 44.4520s
	iters: 200, epoch: 1 | loss: 0.6271617
	speed: 0.0055s/iter; left time: 20.6409s
	iters: 300, epoch: 1 | loss: 0.9052987
	speed: 0.0056s/iter; left time: 20.1431s
	iters: 400, epoch: 1 | loss: 0.7397885
	speed: 0.0056s/iter; left time: 19.5452s
Updating learning rate to 9.168255896282597e-05
Validation loss decreased (inf --> 0.6129).  Saving model state dict ...
Epoch: 1 cost time: 3.066362142562866
Epoch: 1, Steps: 490 | Train Loss: 0.8491402 Vali Loss: 0.6128979 Best vali loss: 0.6128979
	iters: 100, epoch: 2 | loss: 1.2398485
	speed: 0.0143s/iter; left time: 47.7627s
	iters: 200, epoch: 2 | loss: 0.9447116
	speed: 0.0050s/iter; left time: 16.1046s
	iters: 300, epoch: 2 | loss: 1.1410427
	speed: 0.0050s/iter; left time: 15.7314s
	iters: 400, epoch: 2 | loss: 0.6176899
	speed: 0.0049s/iter; left time: 14.8419s
Updating learning rate to 8.135224450237634e-05
Validation loss decreased (0.6129 --> 0.5940).  Saving model state dict ...
Epoch: 2 cost time: 2.466038465499878
Epoch: 2, Steps: 490 | Train Loss: 0.9858232 Vali Loss: 0.5940363 Best vali loss: 0.5940363
	iters: 100, epoch: 3 | loss: 0.7373107
	speed: 0.0146s/iter; left time: 41.6178s
	iters: 200, epoch: 3 | loss: 0.4323007
	speed: 0.0056s/iter; left time: 15.3125s
	iters: 300, epoch: 3 | loss: 0.5336991
	speed: 0.0055s/iter; left time: 14.4781s
	iters: 400, epoch: 3 | loss: 0.4895740
	speed: 0.0055s/iter; left time: 13.9864s
Updating learning rate to 6.58918363507208e-05
Validation loss decreased (0.5940 --> 0.5459).  Saving model state dict ...
Epoch: 3 cost time: 2.7192962169647217
Epoch: 3, Steps: 490 | Train Loss: 0.5482211 Vali Loss: 0.5458623 Best vali loss: 0.5458623

best validation loss 0.5458622713543541

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0036967267052, 'e_layers': 4, 'learning_rate': 9.5310083e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9180837
	speed: 0.0120s/iter; left time: 28.2895s
	iters: 200, epoch: 4 | loss: 0.6040651
	speed: 0.0055s/iter; left time: 12.4807s
	iters: 300, epoch: 4 | loss: 0.8636339
	speed: 0.0055s/iter; left time: 11.9254s
	iters: 400, epoch: 4 | loss: 0.7618327
	speed: 0.0055s/iter; left time: 11.3146s
Updating learning rate to 4.76550415e-05
Epoch: 4 cost time: 3.0565338134765625
Epoch: 4, Steps: 490 | Train Loss: 0.7869039 Vali Loss: 0.5462745 Best vali loss: 0.5458623
	iters: 100, epoch: 5 | loss: 1.0819532
	speed: 0.0145s/iter; left time: 27.0606s
	iters: 200, epoch: 5 | loss: 0.7996067
	speed: 0.0056s/iter; left time: 9.7979s
	iters: 300, epoch: 5 | loss: 1.0025222
	speed: 0.0056s/iter; left time: 9.2221s
	iters: 400, epoch: 5 | loss: 0.4870719
	speed: 0.0056s/iter; left time: 8.6757s
Updating learning rate to 2.9418246649279206e-05
Validation loss decreased (0.5459 --> 0.5367).  Saving model state dict ...
Epoch: 5 cost time: 2.736966609954834
Epoch: 5, Steps: 490 | Train Loss: 0.8427885 Vali Loss: 0.5367358 Best vali loss: 0.5367358
	iters: 100, epoch: 6 | loss: 0.6919748
	speed: 0.0143s/iter; left time: 19.5669s
	iters: 200, epoch: 6 | loss: 0.3314513
	speed: 0.0050s/iter; left time: 6.3980s
	iters: 300, epoch: 6 | loss: 0.5038140
	speed: 0.0049s/iter; left time: 5.7956s
	iters: 400, epoch: 6 | loss: 0.3992306
	speed: 0.0048s/iter; left time: 5.1647s
Updating learning rate to 1.3957838497623662e-05
Epoch: 6 cost time: 2.448193073272705
Epoch: 6, Steps: 490 | Train Loss: 0.4816177 Vali Loss: 0.5503515 Best vali loss: 0.5367358
	iters: 100, epoch: 7 | loss: 0.6168572
	speed: 0.0133s/iter; left time: 11.6935s
	iters: 200, epoch: 7 | loss: 0.3796565
	speed: 0.0049s/iter; left time: 3.8103s
	iters: 300, epoch: 7 | loss: 0.5980923
	speed: 0.0049s/iter; left time: 3.3677s
	iters: 400, epoch: 7 | loss: 0.5557328
	speed: 0.0050s/iter; left time: 2.9139s
Updating learning rate to 3.6275240371740312e-06
Epoch: 7 cost time: 2.488600492477417
Epoch: 7, Steps: 490 | Train Loss: 0.5375847 Vali Loss: 0.5614220 Best vali loss: 0.5367358
	iters: 100, epoch: 8 | loss: 0.2276308
	speed: 0.0140s/iter; left time: 5.4702s
	iters: 200, epoch: 8 | loss: 0.3956132
	speed: 0.0054s/iter; left time: 1.5645s
	iters: 300, epoch: 8 | loss: 0.4239716
	speed: 0.0055s/iter; left time: 1.0532s
	iters: 400, epoch: 8 | loss: 0.5762651
	speed: 0.0055s/iter; left time: 0.5044s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.733795642852783
Epoch: 8, Steps: 490 | Train Loss: 0.4058702 Vali Loss: 0.5664759 Best vali loss: 0.5367358

best validation loss 0.5367358358631196

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0035910730746, 'e_layers': 4, 'learning_rate': 9.62509905e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1238983
	speed: 0.0114s/iter; left time: 43.5454s
	iters: 200, epoch: 1 | loss: 0.6271393
	speed: 0.0055s/iter; left time: 20.3638s
	iters: 300, epoch: 1 | loss: 0.9052879
	speed: 0.0054s/iter; left time: 19.6912s
	iters: 400, epoch: 1 | loss: 0.7386219
	speed: 0.0055s/iter; left time: 19.3264s
Updating learning rate to 9.258765530344414e-05
Validation loss decreased (inf --> 0.6138).  Saving model state dict ...
Epoch: 1 cost time: 3.0166001319885254
Epoch: 1, Steps: 490 | Train Loss: 0.8487368 Vali Loss: 0.6137937 Best vali loss: 0.6137937
	iters: 100, epoch: 2 | loss: 1.2503747
	speed: 0.0148s/iter; left time: 49.2351s
	iters: 200, epoch: 2 | loss: 0.9739506
	speed: 0.0054s/iter; left time: 17.4301s
	iters: 300, epoch: 2 | loss: 1.1407733
	speed: 0.0055s/iter; left time: 17.1869s
	iters: 400, epoch: 2 | loss: 0.5937723
	speed: 0.0055s/iter; left time: 16.5982s
Updating learning rate to 8.215535928923598e-05
Epoch: 2 cost time: 2.717561960220337
Epoch: 2, Steps: 490 | Train Loss: 0.9897177 Vali Loss: 0.6212935 Best vali loss: 0.6137937
	iters: 100, epoch: 3 | loss: 0.7345316
	speed: 0.0145s/iter; left time: 41.1406s
	iters: 200, epoch: 3 | loss: 0.4255019
	speed: 0.0055s/iter; left time: 15.1791s
	iters: 300, epoch: 3 | loss: 0.5446140
	speed: 0.0056s/iter; left time: 14.6787s
	iters: 400, epoch: 3 | loss: 0.4839449
	speed: 0.0055s/iter; left time: 14.0632s
Updating learning rate to 6.654232495653983e-05
Validation loss decreased (0.6138 --> 0.5521).  Saving model state dict ...
Epoch: 3 cost time: 2.757049322128296
Epoch: 3, Steps: 490 | Train Loss: 0.5471481 Vali Loss: 0.5521471 Best vali loss: 0.5521471
	iters: 100, epoch: 4 | loss: 0.6760936
	speed: 0.0151s/iter; left time: 35.4245s
	iters: 200, epoch: 4 | loss: 0.3960001
	speed: 0.0055s/iter; left time: 12.3040s
	iters: 300, epoch: 4 | loss: 0.6348718
	speed: 0.0055s/iter; left time: 11.8747s
	iters: 400, epoch: 4 | loss: 0.6556356
	speed: 0.0054s/iter; left time: 11.0460s
Updating learning rate to 4.812549525e-05
Validation loss decreased (0.5521 --> 0.5388).  Saving model state dict ...
Epoch: 4 cost time: 2.714556932449341
Epoch: 4, Steps: 490 | Train Loss: 0.5906503 Vali Loss: 0.5388038 Best vali loss: 0.5388038
	iters: 100, epoch: 5 | loss: 0.2474571
	speed: 0.0148s/iter; left time: 27.5443s
	iters: 200, epoch: 5 | loss: 0.4698521
	speed: 0.0055s/iter; left time: 9.6630s
	iters: 300, epoch: 5 | loss: 0.4660912
	speed: 0.0055s/iter; left time: 9.0853s
	iters: 400, epoch: 5 | loss: 0.6076263
	speed: 0.0055s/iter; left time: 8.5506s
Updating learning rate to 2.9708665543460178e-05
Epoch: 5 cost time: 2.7287983894348145
Epoch: 5, Steps: 490 | Train Loss: 0.4477567 Vali Loss: 0.5452813 Best vali loss: 0.5388038
	iters: 100, epoch: 6 | loss: 0.8322644
	speed: 0.0148s/iter; left time: 20.3173s
	iters: 200, epoch: 6 | loss: 0.7137691
	speed: 0.0055s/iter; left time: 6.9496s
	iters: 300, epoch: 6 | loss: 0.5153174
	speed: 0.0054s/iter; left time: 6.3786s
	iters: 400, epoch: 6 | loss: 0.4056668
	speed: 0.0055s/iter; left time: 5.8931s
Updating learning rate to 1.409563121076402e-05
Epoch: 6 cost time: 2.7240488529205322
Epoch: 6, Steps: 490 | Train Loss: 0.6167544 Vali Loss: 0.5569540 Best vali loss: 0.5388038
	iters: 100, epoch: 7 | loss: 0.4278821
	speed: 0.0145s/iter; left time: 12.7477s
	iters: 200, epoch: 7 | loss: 0.3282823
	speed: 0.0055s/iter; left time: 4.2984s
	iters: 300, epoch: 7 | loss: 1.1922480
	speed: 0.0056s/iter; left time: 3.7849s
	iters: 400, epoch: 7 | loss: 0.6076294
	speed: 0.0055s/iter; left time: 3.1774s
Updating learning rate to 3.663335196555849e-06
Epoch: 7 cost time: 2.753122329711914
Epoch: 7, Steps: 490 | Train Loss: 0.6390105 Vali Loss: 0.5656489 Best vali loss: 0.5388038
	iters: 100, epoch: 8 | loss: 0.8438376
	speed: 0.0146s/iter; left time: 5.6912s
	iters: 200, epoch: 8 | loss: 0.3705734
	speed: 0.0055s/iter; left time: 1.5998s
	iters: 300, epoch: 8 | loss: 0.7509271
	speed: 0.0054s/iter; left time: 1.0321s
	iters: 400, epoch: 8 | loss: 0.3954970
	speed: 0.0055s/iter; left time: 0.4970s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.729886531829834
Epoch: 8, Steps: 490 | Train Loss: 0.5902088 Vali Loss: 0.5648985 Best vali loss: 0.5388038

best validation loss 0.5388038307635225

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001965706148, 'e_layers': 4, 'learning_rate': 9.56742915e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1237153
	speed: 0.0113s/iter; left time: 43.0684s
	iters: 200, epoch: 1 | loss: 0.6271380
	speed: 0.0053s/iter; left time: 19.6598s
	iters: 300, epoch: 1 | loss: 0.9052254
	speed: 0.0053s/iter; left time: 19.0564s
	iters: 400, epoch: 1 | loss: 0.7393982
	speed: 0.0055s/iter; left time: 19.4692s
Updating learning rate to 9.20329056021843e-05
Validation loss decreased (inf --> 0.6132).  Saving model state dict ...
Epoch: 1 cost time: 2.9582667350769043
Epoch: 1, Steps: 490 | Train Loss: 0.8488692 Vali Loss: 0.6132116 Best vali loss: 0.6132116
	iters: 100, epoch: 2 | loss: 1.2397053
	speed: 0.0149s/iter; left time: 49.5028s
	iters: 200, epoch: 2 | loss: 0.9616238
	speed: 0.0055s/iter; left time: 17.8020s
	iters: 300, epoch: 2 | loss: 1.1413761
	speed: 0.0054s/iter; left time: 17.0335s
	iters: 400, epoch: 2 | loss: 0.5995962
	speed: 0.0054s/iter; left time: 16.3277s
Updating learning rate to 8.166311590243424e-05
Validation loss decreased (0.6132 --> 0.5861).  Saving model state dict ...
Epoch: 2 cost time: 2.7235376834869385
Epoch: 2, Steps: 490 | Train Loss: 0.9855754 Vali Loss: 0.5860957 Best vali loss: 0.5860957
	iters: 100, epoch: 3 | loss: 0.7367446
	speed: 0.0147s/iter; left time: 41.6940s
	iters: 200, epoch: 3 | loss: 0.4367765
	speed: 0.0052s/iter; left time: 14.1678s
	iters: 300, epoch: 3 | loss: 0.5396759
	speed: 0.0052s/iter; left time: 13.6069s
	iters: 400, epoch: 3 | loss: 0.4632957
	speed: 0.0050s/iter; left time: 12.7377s
Updating learning rate to 6.614362888015907e-05
Validation loss decreased (0.5861 --> 0.5512).  Saving model state dict ...
Epoch: 3 cost time: 2.5470633506774902
Epoch: 3, Steps: 490 | Train Loss: 0.5441232 Vali Loss: 0.5511512 Best vali loss: 0.5511512
	iters: 100, epoch: 4 | loss: 0.6805869
	speed: 0.0140s/iter; left time: 32.9764s
	iters: 200, epoch: 4 | loss: 0.4007372
	speed: 0.0050s/iter; left time: 11.3409s
	iters: 300, epoch: 4 | loss: 0.6257654
	speed: 0.0051s/iter; left time: 10.8962s
	iters: 400, epoch: 4 | loss: 0.6080799
	speed: 0.0050s/iter; left time: 10.2036s
Updating learning rate to 4.783714575e-05
Validation loss decreased (0.5512 --> 0.5425).  Saving model state dict ...
Epoch: 4 cost time: 2.5204904079437256
Epoch: 4, Steps: 490 | Train Loss: 0.5787924 Vali Loss: 0.5425068 Best vali loss: 0.5425068
	iters: 100, epoch: 5 | loss: 0.2503828
	speed: 0.0144s/iter; left time: 26.7393s
	iters: 200, epoch: 5 | loss: 0.4428143
	speed: 0.0051s/iter; left time: 8.9844s
	iters: 300, epoch: 5 | loss: 0.4662130
	speed: 0.0051s/iter; left time: 8.4546s
	iters: 400, epoch: 5 | loss: 0.6026106
	speed: 0.0051s/iter; left time: 7.8854s
Updating learning rate to 2.9530662619840938e-05
Epoch: 5 cost time: 2.5540072917938232
Epoch: 5, Steps: 490 | Train Loss: 0.4405052 Vali Loss: 0.5536722 Best vali loss: 0.5425068
	iters: 100, epoch: 6 | loss: 0.8207062
	speed: 0.0138s/iter; left time: 18.9163s
	iters: 200, epoch: 6 | loss: 0.6968662
	speed: 0.0054s/iter; left time: 6.8086s
	iters: 300, epoch: 6 | loss: 0.5152941
	speed: 0.0052s/iter; left time: 6.1079s
	iters: 400, epoch: 6 | loss: 0.4120334
	speed: 0.0049s/iter; left time: 5.2490s
Updating learning rate to 1.4011175597565772e-05
Epoch: 6 cost time: 2.5539615154266357
Epoch: 6, Steps: 490 | Train Loss: 0.6112250 Vali Loss: 0.5482247 Best vali loss: 0.5425068
	iters: 100, epoch: 7 | loss: 0.4222942
	speed: 0.0138s/iter; left time: 12.1337s
	iters: 200, epoch: 7 | loss: 0.3236658
	speed: 0.0051s/iter; left time: 3.9491s
	iters: 300, epoch: 7 | loss: 1.1717669
	speed: 0.0051s/iter; left time: 3.4914s
	iters: 400, epoch: 7 | loss: 0.6025690
	speed: 0.0051s/iter; left time: 2.9727s
Updating learning rate to 3.641385897815713e-06
Epoch: 7 cost time: 2.5339431762695312
Epoch: 7, Steps: 490 | Train Loss: 0.6300740 Vali Loss: 0.5693452 Best vali loss: 0.5425068
	iters: 100, epoch: 8 | loss: 0.8379449
	speed: 0.0140s/iter; left time: 5.4756s
	iters: 200, epoch: 8 | loss: 0.3605384
	speed: 0.0055s/iter; left time: 1.5930s
	iters: 300, epoch: 8 | loss: 0.7362627
	speed: 0.0055s/iter; left time: 1.0461s
	iters: 400, epoch: 8 | loss: 0.3816074
	speed: 0.0054s/iter; left time: 0.4906s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6995625495910645
Epoch: 8, Steps: 490 | Train Loss: 0.5790883 Vali Loss: 0.5699688 Best vali loss: 0.5425068

best validation loss 0.5425068295799103

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494750749, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744684
	speed: 0.0116s/iter; left time: 10.2911s
Updating learning rate to 0.00028649790180219664
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0073819160461426
Epoch: 1, Steps: 123 | Train Loss: 0.7744684 Vali Loss: 0.6172481 Best vali loss: 0.6172481
	iters: 100, epoch: 2 | loss: 0.9521384
	speed: 0.0091s/iter; left time: 6.9317s
Updating learning rate to 0.0002542168065605627
Validation loss decreased (0.6172 --> 0.5663).  Saving model state dict ...
Epoch: 2 cost time: 0.7138776779174805
Epoch: 2, Steps: 123 | Train Loss: 0.9521384 Vali Loss: 0.5663413 Best vali loss: 0.5663413
	iters: 100, epoch: 3 | loss: 0.8422508
	speed: 0.0093s/iter; left time: 5.9155s
Updating learning rate to 0.00020590473339677975
Validation loss decreased (0.5663 --> 0.5380).  Saving model state dict ...
Epoch: 3 cost time: 0.7140724658966064
Epoch: 3, Steps: 123 | Train Loss: 0.8422508 Vali Loss: 0.5379613 Best vali loss: 0.5379613

best validation loss 0.5379612545953862

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010508262198, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4808379
	speed: 0.0098s/iter; left time: 37.4405s
	iters: 200, epoch: 1 | loss: 1.1573732
	speed: 0.0034s/iter; left time: 12.7611s
	iters: 300, epoch: 1 | loss: 0.9459676
	speed: 0.0034s/iter; left time: 12.4415s
	iters: 400, epoch: 1 | loss: 1.0283098
	speed: 0.0035s/iter; left time: 12.3680s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6036).  Saving model state dict ...
Epoch: 1 cost time: 2.061225652694702
Epoch: 1, Steps: 490 | Train Loss: 1.1531221 Vali Loss: 0.6036337 Best vali loss: 0.6036337
	iters: 100, epoch: 2 | loss: 0.3120091
	speed: 0.0104s/iter; left time: 34.6618s
	iters: 200, epoch: 2 | loss: 1.1092801
	speed: 0.0035s/iter; left time: 11.3409s
	iters: 300, epoch: 2 | loss: 1.4686846
	speed: 0.0035s/iter; left time: 10.8241s
	iters: 400, epoch: 2 | loss: 0.4153510
	speed: 0.0035s/iter; left time: 10.5766s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6036 --> 0.5519).  Saving model state dict ...
Epoch: 2 cost time: 1.7577011585235596
Epoch: 2, Steps: 490 | Train Loss: 0.8263312 Vali Loss: 0.5519257 Best vali loss: 0.5519257
	iters: 100, epoch: 3 | loss: 0.9927442
	speed: 0.0106s/iter; left time: 30.0573s
	iters: 200, epoch: 3 | loss: 0.9167193
	speed: 0.0034s/iter; left time: 9.4324s
	iters: 300, epoch: 3 | loss: 0.3528240
	speed: 0.0034s/iter; left time: 8.9659s
	iters: 400, epoch: 3 | loss: 1.5036416
	speed: 0.0035s/iter; left time: 8.9080s
Updating learning rate to 0.000205904169538476
Epoch: 3 cost time: 1.7570486068725586
Epoch: 3, Steps: 490 | Train Loss: 0.9414823 Vali Loss: 0.5612438 Best vali loss: 0.5519257

best validation loss 0.5519256672060417

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010502278033, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4808731
	speed: 0.0098s/iter; left time: 37.5633s
	iters: 200, epoch: 1 | loss: 1.1569874
	speed: 0.0037s/iter; left time: 13.6683s
	iters: 300, epoch: 1 | loss: 0.9487550
	speed: 0.0036s/iter; left time: 12.8792s
	iters: 400, epoch: 1 | loss: 0.8638564
	speed: 0.0036s/iter; left time: 12.5272s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 2.109938383102417
Epoch: 1, Steps: 490 | Train Loss: 1.1126180 Vali Loss: 0.6080988 Best vali loss: 0.6080988
	iters: 100, epoch: 2 | loss: 0.2965516
	speed: 0.0107s/iter; left time: 35.5189s
	iters: 200, epoch: 2 | loss: 1.0408945
	speed: 0.0038s/iter; left time: 12.1911s
	iters: 300, epoch: 2 | loss: 1.3544445
	speed: 0.0036s/iter; left time: 11.2466s
	iters: 400, epoch: 2 | loss: 0.4001318
	speed: 0.0038s/iter; left time: 11.4581s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6081 --> 0.5764).  Saving model state dict ...
Epoch: 2 cost time: 1.8606669902801514
Epoch: 2, Steps: 490 | Train Loss: 0.7730056 Vali Loss: 0.5763930 Best vali loss: 0.5763930
	iters: 100, epoch: 3 | loss: 1.0330166
	speed: 0.0108s/iter; left time: 30.6413s
	iters: 200, epoch: 3 | loss: 0.9148775
	speed: 0.0037s/iter; left time: 10.1882s
	iters: 300, epoch: 3 | loss: 0.3688995
	speed: 0.0038s/iter; left time: 10.0603s
	iters: 400, epoch: 3 | loss: 1.5010562
	speed: 0.0037s/iter; left time: 9.4919s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5764 --> 0.5619).  Saving model state dict ...
Epoch: 3 cost time: 1.8827152252197266
Epoch: 3, Steps: 490 | Train Loss: 0.9544624 Vali Loss: 0.5619098 Best vali loss: 0.5619098

best validation loss 0.5619097701905227

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494750749, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5800053
	speed: 0.0122s/iter; left time: 6.2815s
Updating learning rate to 0.0001489167575
Validation loss decreased (0.5380 --> 0.5268).  Saving model state dict ...
Epoch: 4 cost time: 1.031548023223877
Epoch: 4, Steps: 123 | Train Loss: 0.5800053 Vali Loss: 0.5268328 Best vali loss: 0.5268328
	iters: 100, epoch: 5 | loss: 0.8152536
	speed: 0.0094s/iter; left time: 3.6931s
Updating learning rate to 9.192878160322029e-05
Validation loss decreased (0.5268 --> 0.5204).  Saving model state dict ...
Epoch: 5 cost time: 0.7230796813964844
Epoch: 5, Steps: 123 | Train Loss: 0.8152536 Vali Loss: 0.5203712 Best vali loss: 0.5203712
	iters: 100, epoch: 6 | loss: 0.7597842
	speed: 0.0093s/iter; left time: 2.5169s
Updating learning rate to 4.361670843943735e-05
Epoch: 6 cost time: 0.7211241722106934
Epoch: 6, Steps: 123 | Train Loss: 0.7597842 Vali Loss: 0.5276957 Best vali loss: 0.5203712
	iters: 100, epoch: 7 | loss: 0.4339425
	speed: 0.0090s/iter; left time: 1.3206s
Updating learning rate to 1.1335613197803346e-05
Epoch: 7 cost time: 0.717228889465332
Epoch: 7, Steps: 123 | Train Loss: 0.4339425 Vali Loss: 0.5386950 Best vali loss: 0.5203712
	iters: 100, epoch: 8 | loss: 0.5072024
	speed: 0.0090s/iter; left time: 0.2165s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7241361141204834
Epoch: 8, Steps: 123 | Train Loss: 0.5072024 Vali Loss: 0.5356798 Best vali loss: 0.5203712

best validation loss 0.5203712052186845

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0042574368467, 'e_layers': 2, 'learning_rate': 0.0005818917366, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9011471
	speed: 0.0119s/iter; left time: 10.5629s
Updating learning rate to 0.0005818917366
Validation loss decreased (inf --> 0.6105).  Saving model state dict ...
Epoch: 1 cost time: 1.0232548713684082
Epoch: 1, Steps: 123 | Train Loss: 0.9011471 Vali Loss: 0.6105111 Best vali loss: 0.6105111
	iters: 100, epoch: 2 | loss: 0.8447835
	speed: 0.0094s/iter; left time: 7.1543s
Updating learning rate to 0.0002909458683
Validation loss decreased (0.6105 --> 0.6068).  Saving model state dict ...
Epoch: 2 cost time: 0.7342345714569092
Epoch: 2, Steps: 123 | Train Loss: 0.8447835 Vali Loss: 0.6068381 Best vali loss: 0.6068381
	iters: 100, epoch: 3 | loss: 0.6457767
	speed: 0.0095s/iter; left time: 6.0389s
Updating learning rate to 0.00014547293415
Validation loss decreased (0.6068 --> 0.5840).  Saving model state dict ...
Epoch: 3 cost time: 0.7303416728973389
Epoch: 3, Steps: 123 | Train Loss: 0.6457767 Vali Loss: 0.5840092 Best vali loss: 0.5840092
	iters: 100, epoch: 4 | loss: 0.8825928
	speed: 0.0093s/iter; left time: 4.8192s
Updating learning rate to 7.2736467075e-05
Validation loss decreased (0.5840 --> 0.5691).  Saving model state dict ...
Epoch: 4 cost time: 0.7360296249389648
Epoch: 4, Steps: 123 | Train Loss: 0.8825928 Vali Loss: 0.5691130 Best vali loss: 0.5691130
	iters: 100, epoch: 5 | loss: 0.7978983
	speed: 0.0095s/iter; left time: 3.7328s
Updating learning rate to 3.63682335375e-05
Epoch: 5 cost time: 0.7388238906860352
Epoch: 5, Steps: 123 | Train Loss: 0.7978983 Vali Loss: 0.5749692 Best vali loss: 0.5691130
	iters: 100, epoch: 6 | loss: 0.6987443
	speed: 0.0091s/iter; left time: 2.4621s
Updating learning rate to 1.818411676875e-05
Epoch: 6 cost time: 0.728175163269043
Epoch: 6, Steps: 123 | Train Loss: 0.6987443 Vali Loss: 0.5767586 Best vali loss: 0.5691130
	iters: 100, epoch: 7 | loss: 0.7192425
	speed: 0.0090s/iter; left time: 1.3274s
Updating learning rate to 9.092058384375e-06
Epoch: 7 cost time: 0.7242636680603027
Epoch: 7, Steps: 123 | Train Loss: 0.7192425 Vali Loss: 0.5799319 Best vali loss: 0.5691130
	iters: 100, epoch: 8 | loss: 0.8265203
	speed: 0.0089s/iter; left time: 0.2147s
Updating learning rate to 4.5460291921875e-06
Epoch: 8 cost time: 0.7249653339385986
Epoch: 8, Steps: 123 | Train Loss: 0.8265203 Vali Loss: 0.5819512 Best vali loss: 0.5691130

best validation loss 0.5691130410350621

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.001030066994, 'e_layers': 2, 'learning_rate': 0.000466470794, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3216256
	speed: 0.0098s/iter; left time: 75.4110s
	iters: 200, epoch: 1 | loss: 0.6283427
	speed: 0.0036s/iter; left time: 27.2676s
	iters: 300, epoch: 1 | loss: 0.6801232
	speed: 0.0036s/iter; left time: 27.3681s
	iters: 400, epoch: 1 | loss: 1.0973754
	speed: 0.0035s/iter; left time: 25.8492s
	iters: 500, epoch: 1 | loss: 0.8965177
	speed: 0.0036s/iter; left time: 26.4153s
	iters: 600, epoch: 1 | loss: 0.3883614
	speed: 0.0036s/iter; left time: 26.0810s
	iters: 700, epoch: 1 | loss: 1.0487558
	speed: 0.0031s/iter; left time: 21.8057s
	iters: 800, epoch: 1 | loss: 0.6279904
	speed: 0.0030s/iter; left time: 21.2538s
	iters: 900, epoch: 1 | loss: 1.0133320
	speed: 0.0032s/iter; left time: 22.5173s
Updating learning rate to 0.00044871680654544436
Validation loss decreased (inf --> 0.6217).  Saving model state dict ...
Epoch: 1 cost time: 3.6583032608032227
Epoch: 1, Steps: 979 | Train Loss: 0.7447138 Vali Loss: 0.6216767 Best vali loss: 0.6216767
	iters: 100, epoch: 2 | loss: 2.3959203
	speed: 0.0105s/iter; left time: 70.7985s
	iters: 200, epoch: 2 | loss: 0.9685704
	speed: 0.0030s/iter; left time: 19.8290s
	iters: 300, epoch: 2 | loss: 0.2228703
	speed: 0.0030s/iter; left time: 19.3732s
	iters: 400, epoch: 2 | loss: 0.6336247
	speed: 0.0030s/iter; left time: 19.6520s
	iters: 500, epoch: 2 | loss: 0.6814378
	speed: 0.0031s/iter; left time: 19.6150s
	iters: 600, epoch: 2 | loss: 0.6125385
	speed: 0.0030s/iter; left time: 18.9536s
	iters: 700, epoch: 2 | loss: 0.5805884
	speed: 0.0030s/iter; left time: 18.1626s
	iters: 800, epoch: 2 | loss: 0.8833839
	speed: 0.0030s/iter; left time: 17.9228s
	iters: 900, epoch: 2 | loss: 0.5452790
	speed: 0.0029s/iter; left time: 17.2981s
Updating learning rate to 0.0003981577278314365
Epoch: 2 cost time: 2.9607129096984863
Epoch: 2, Steps: 979 | Train Loss: 0.8360237 Vali Loss: 0.6255112 Best vali loss: 0.6216767
	iters: 100, epoch: 3 | loss: 1.2625415
	speed: 0.0103s/iter; left time: 59.2410s
	iters: 200, epoch: 3 | loss: 0.3730612
	speed: 0.0029s/iter; left time: 16.5105s
	iters: 300, epoch: 3 | loss: 0.6476474
	speed: 0.0030s/iter; left time: 16.9239s
	iters: 400, epoch: 3 | loss: 1.2146291
	speed: 0.0029s/iter; left time: 15.9687s
	iters: 500, epoch: 3 | loss: 0.5709327
	speed: 0.0029s/iter; left time: 15.6514s
	iters: 600, epoch: 3 | loss: 0.3077279
	speed: 0.0029s/iter; left time: 15.3710s
	iters: 700, epoch: 3 | loss: 0.2777603
	speed: 0.0029s/iter; left time: 15.0849s
	iters: 800, epoch: 3 | loss: 0.3207842
	speed: 0.0029s/iter; left time: 14.7854s
	iters: 900, epoch: 3 | loss: 0.4856969
	speed: 0.0029s/iter; left time: 14.5938s
Updating learning rate to 0.0003224907192729944
Validation loss decreased (0.6217 --> 0.6052).  Saving model state dict ...
Epoch: 3 cost time: 2.930234670639038
Epoch: 3, Steps: 979 | Train Loss: 0.6067535 Vali Loss: 0.6052204 Best vali loss: 0.6052204
	iters: 100, epoch: 4 | loss: 0.4487382
	speed: 0.0105s/iter; left time: 50.5264s
	iters: 200, epoch: 4 | loss: 0.4931944
	speed: 0.0030s/iter; left time: 13.9418s
	iters: 300, epoch: 4 | loss: 0.6190539
	speed: 0.0029s/iter; left time: 13.4302s
	iters: 400, epoch: 4 | loss: 0.9675291
	speed: 0.0029s/iter; left time: 13.1444s
	iters: 500, epoch: 4 | loss: 0.2989885
	speed: 0.0029s/iter; left time: 12.8642s
	iters: 600, epoch: 4 | loss: 2.1812534
	speed: 0.0030s/iter; left time: 13.0255s
	iters: 700, epoch: 4 | loss: 0.3948983
	speed: 0.0030s/iter; left time: 12.5235s
	iters: 800, epoch: 4 | loss: 0.3683156
	speed: 0.0030s/iter; left time: 12.3081s
	iters: 900, epoch: 4 | loss: 1.0113394
	speed: 0.0031s/iter; left time: 12.4705s
Updating learning rate to 0.000233235397
Epoch: 4 cost time: 2.966721773147583
Epoch: 4, Steps: 979 | Train Loss: 0.7537012 Vali Loss: 0.6320170 Best vali loss: 0.6052204
	iters: 100, epoch: 5 | loss: 0.9954587
	speed: 0.0105s/iter; left time: 40.1249s
	iters: 200, epoch: 5 | loss: 1.2873476
	speed: 0.0030s/iter; left time: 11.2404s
	iters: 300, epoch: 5 | loss: 1.9837544
	speed: 0.0030s/iter; left time: 10.9572s
	iters: 400, epoch: 5 | loss: 0.3781900
	speed: 0.0029s/iter; left time: 10.3264s
	iters: 500, epoch: 5 | loss: 0.7732608
	speed: 0.0030s/iter; left time: 10.2236s
	iters: 600, epoch: 5 | loss: 0.6874151
	speed: 0.0029s/iter; left time: 9.6373s
	iters: 700, epoch: 5 | loss: 0.9891641
	speed: 0.0029s/iter; left time: 9.3391s
	iters: 800, epoch: 5 | loss: 0.9285360
	speed: 0.0029s/iter; left time: 9.0779s
	iters: 900, epoch: 5 | loss: 1.4538375
	speed: 0.0030s/iter; left time: 9.1196s
Updating learning rate to 0.00014398007472700566
Epoch: 5 cost time: 2.946194648742676
Epoch: 5, Steps: 979 | Train Loss: 1.0529960 Vali Loss: 0.6109505 Best vali loss: 0.6052204
	iters: 100, epoch: 6 | loss: 0.5826824
	speed: 0.0105s/iter; left time: 29.7458s
	iters: 200, epoch: 6 | loss: 0.6454514
	speed: 0.0030s/iter; left time: 8.2750s
	iters: 300, epoch: 6 | loss: 0.3876729
	speed: 0.0032s/iter; left time: 8.4156s
	iters: 400, epoch: 6 | loss: 0.4907099
	speed: 0.0031s/iter; left time: 7.7693s
	iters: 500, epoch: 6 | loss: 0.2700116
	speed: 0.0030s/iter; left time: 7.3858s
	iters: 600, epoch: 6 | loss: 0.9440360
	speed: 0.0031s/iter; left time: 7.2230s
	iters: 700, epoch: 6 | loss: 0.6912197
	speed: 0.0031s/iter; left time: 6.8961s
	iters: 800, epoch: 6 | loss: 0.3948621
	speed: 0.0032s/iter; left time: 6.8067s
	iters: 900, epoch: 6 | loss: 0.6049540
	speed: 0.0031s/iter; left time: 6.3427s
Updating learning rate to 6.831306616856348e-05
Epoch: 6 cost time: 3.0754239559173584
Epoch: 6, Steps: 979 | Train Loss: 0.5568444 Vali Loss: 0.6260313 Best vali loss: 0.6052204
	iters: 100, epoch: 7 | loss: 0.5534644
	speed: 0.0104s/iter; left time: 19.2864s
	iters: 200, epoch: 7 | loss: 0.2965298
	speed: 0.0030s/iter; left time: 5.3499s
	iters: 300, epoch: 7 | loss: 0.6634091
	speed: 0.0030s/iter; left time: 5.0510s
	iters: 400, epoch: 7 | loss: 0.4804573
	speed: 0.0029s/iter; left time: 4.5494s
	iters: 500, epoch: 7 | loss: 0.3746087
	speed: 0.0029s/iter; left time: 4.2668s
	iters: 600, epoch: 7 | loss: 0.2666477
	speed: 0.0029s/iter; left time: 4.0007s
	iters: 700, epoch: 7 | loss: 0.6319716
	speed: 0.0029s/iter; left time: 3.6761s
	iters: 800, epoch: 7 | loss: 0.9213263
	speed: 0.0029s/iter; left time: 3.3883s
	iters: 900, epoch: 7 | loss: 0.7136093
	speed: 0.0029s/iter; left time: 3.0986s
Updating learning rate to 1.775398745455563e-05
Epoch: 7 cost time: 2.9377095699310303
Epoch: 7, Steps: 979 | Train Loss: 0.5446693 Vali Loss: 0.6313691 Best vali loss: 0.6052204
	iters: 100, epoch: 8 | loss: 0.4219064
	speed: 0.0102s/iter; left time: 9.0147s
	iters: 200, epoch: 8 | loss: 0.3306734
	speed: 0.0031s/iter; left time: 2.3988s
	iters: 300, epoch: 8 | loss: 0.4642606
	speed: 0.0031s/iter; left time: 2.0796s
	iters: 400, epoch: 8 | loss: 1.5816684
	speed: 0.0031s/iter; left time: 1.8136s
	iters: 500, epoch: 8 | loss: 0.5739442
	speed: 0.0030s/iter; left time: 1.4545s
	iters: 600, epoch: 8 | loss: 0.5856645
	speed: 0.0030s/iter; left time: 1.1323s
	iters: 700, epoch: 8 | loss: 1.1525613
	speed: 0.0029s/iter; left time: 0.8254s
	iters: 800, epoch: 8 | loss: 0.9343463
	speed: 0.0031s/iter; left time: 0.5563s
	iters: 900, epoch: 8 | loss: 0.3316908
	speed: 0.0031s/iter; left time: 0.2510s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0246047973632812
Epoch: 8, Steps: 979 | Train Loss: 0.7085240 Vali Loss: 0.6421405 Best vali loss: 0.6052204

best validation loss 0.6052203630819082

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0067867105679, 'e_layers': 1, 'learning_rate': 0.0014701227676, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.9616021
	speed: 0.0085s/iter; left time: 65.5101s
	iters: 200, epoch: 1 | loss: 1.4125732
	speed: 0.0025s/iter; left time: 19.3191s
	iters: 300, epoch: 1 | loss: 1.5612776
	speed: 0.0025s/iter; left time: 19.1036s
	iters: 400, epoch: 1 | loss: 0.6799242
	speed: 0.0025s/iter; left time: 18.7824s
	iters: 500, epoch: 1 | loss: 1.0649319
	speed: 0.0025s/iter; left time: 18.5805s
	iters: 600, epoch: 1 | loss: 1.9915904
	speed: 0.0026s/iter; left time: 18.8614s
	iters: 700, epoch: 1 | loss: 0.5324274
	speed: 0.0026s/iter; left time: 18.2474s
	iters: 800, epoch: 1 | loss: 0.7231299
	speed: 0.0026s/iter; left time: 17.9608s
	iters: 900, epoch: 1 | loss: 0.8359933
	speed: 0.0025s/iter; left time: 17.6218s
Updating learning rate to 0.0014701227676
Validation loss decreased (inf --> 0.6069).  Saving model state dict ...
Epoch: 1 cost time: 2.825618267059326
Epoch: 1, Steps: 979 | Train Loss: 1.1959389 Vali Loss: 0.6068664 Best vali loss: 0.6068664
	iters: 100, epoch: 2 | loss: 0.7904608
	speed: 0.0091s/iter; left time: 61.5137s
	iters: 200, epoch: 2 | loss: 0.4807421
	speed: 0.0024s/iter; left time: 15.8582s
	iters: 300, epoch: 2 | loss: 0.2761424
	speed: 0.0024s/iter; left time: 15.6062s
	iters: 400, epoch: 2 | loss: 1.0921301
	speed: 0.0024s/iter; left time: 15.3124s
	iters: 500, epoch: 2 | loss: 0.4630302
	speed: 0.0023s/iter; left time: 14.8109s
	iters: 600, epoch: 2 | loss: 0.9942480
	speed: 0.0023s/iter; left time: 14.5407s
	iters: 700, epoch: 2 | loss: 1.2632890
	speed: 0.0023s/iter; left time: 14.3200s
	iters: 800, epoch: 2 | loss: 0.6853808
	speed: 0.0024s/iter; left time: 14.3579s
	iters: 900, epoch: 2 | loss: 0.9234854
	speed: 0.0023s/iter; left time: 13.6198s
Updating learning rate to 0.0007350613838
Epoch: 2 cost time: 2.34816575050354
Epoch: 2, Steps: 979 | Train Loss: 0.7743232 Vali Loss: 0.6231018 Best vali loss: 0.6068664
	iters: 100, epoch: 3 | loss: 0.9744660
	speed: 0.0086s/iter; left time: 49.6865s
	iters: 200, epoch: 3 | loss: 0.3772466
	speed: 0.0024s/iter; left time: 13.7987s
	iters: 300, epoch: 3 | loss: 0.3884035
	speed: 0.0024s/iter; left time: 13.1547s
	iters: 400, epoch: 3 | loss: 0.7024431
	speed: 0.0024s/iter; left time: 13.1383s
	iters: 500, epoch: 3 | loss: 1.2467325
	speed: 0.0024s/iter; left time: 12.8048s
	iters: 600, epoch: 3 | loss: 1.3142120
	speed: 0.0024s/iter; left time: 12.5358s
	iters: 700, epoch: 3 | loss: 0.4621999
	speed: 0.0024s/iter; left time: 12.2051s
	iters: 800, epoch: 3 | loss: 0.3846855
	speed: 0.0024s/iter; left time: 12.0629s
	iters: 900, epoch: 3 | loss: 0.4298194
	speed: 0.0023s/iter; left time: 11.5785s
Updating learning rate to 0.0003675306919
Epoch: 3 cost time: 2.379720687866211
Epoch: 3, Steps: 979 | Train Loss: 0.6978010 Vali Loss: 0.6170453 Best vali loss: 0.6068664

best validation loss 0.6068664400845641

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0053339894129, 'e_layers': 3, 'learning_rate': 0.0006768054062, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006768054062
Validation loss decreased (inf --> 0.6363).  Saving model state dict ...
Epoch: 1 cost time: 0.7369515895843506
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6363017 Best vali loss: 0.6363017
Updating learning rate to 0.0003384027031
Validation loss decreased (0.6363 --> 0.6101).  Saving model state dict ...
Epoch: 2 cost time: 0.4740488529205322
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6100632 Best vali loss: 0.6100632
Updating learning rate to 0.00016920135155
Validation loss decreased (0.6101 --> 0.6098).  Saving model state dict ...
Epoch: 3 cost time: 0.44666266441345215
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6098044 Best vali loss: 0.6098044

best validation loss 0.6098044060932603

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011820043182, 'e_layers': 2, 'learning_rate': 0.0001204876386, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2018136
	speed: 0.0094s/iter; left time: 72.5532s
	iters: 200, epoch: 1 | loss: 0.6523944
	speed: 0.0033s/iter; left time: 25.1429s
	iters: 300, epoch: 1 | loss: 1.8933722
	speed: 0.0034s/iter; left time: 25.8989s
	iters: 400, epoch: 1 | loss: 0.2964300
	speed: 0.0035s/iter; left time: 26.1719s
	iters: 500, epoch: 1 | loss: 1.2303572
	speed: 0.0035s/iter; left time: 25.4873s
	iters: 600, epoch: 1 | loss: 0.8571433
	speed: 0.0035s/iter; left time: 25.6485s
	iters: 700, epoch: 1 | loss: 1.5532494
	speed: 0.0035s/iter; left time: 24.8555s
	iters: 800, epoch: 1 | loss: 0.6780295
	speed: 0.0035s/iter; left time: 24.5408s
	iters: 900, epoch: 1 | loss: 0.4362759
	speed: 0.0034s/iter; left time: 23.5047s
Updating learning rate to 0.0001204876386
Validation loss decreased (inf --> 0.5954).  Saving model state dict ...
Epoch: 1 cost time: 3.6878859996795654
Epoch: 1, Steps: 979 | Train Loss: 0.9776739 Vali Loss: 0.5954206 Best vali loss: 0.5954206
	iters: 100, epoch: 2 | loss: 0.7155442
	speed: 0.0113s/iter; left time: 76.6365s
	iters: 200, epoch: 2 | loss: 1.6716557
	speed: 0.0035s/iter; left time: 23.2723s
	iters: 300, epoch: 2 | loss: 1.2185130
	speed: 0.0035s/iter; left time: 22.9264s
	iters: 400, epoch: 2 | loss: 0.3892861
	speed: 0.0034s/iter; left time: 22.1999s
	iters: 500, epoch: 2 | loss: 1.4771471
	speed: 0.0034s/iter; left time: 21.7059s
	iters: 600, epoch: 2 | loss: 0.7144514
	speed: 0.0034s/iter; left time: 21.1409s
	iters: 700, epoch: 2 | loss: 0.3186867
	speed: 0.0035s/iter; left time: 21.2831s
	iters: 800, epoch: 2 | loss: 0.6924489
	speed: 0.0033s/iter; left time: 20.1657s
	iters: 900, epoch: 2 | loss: 0.7768945
	speed: 0.0035s/iter; left time: 20.9023s
Updating learning rate to 6.02438193e-05
Validation loss decreased (0.5954 --> 0.5655).  Saving model state dict ...
Epoch: 2 cost time: 3.4212050437927246
Epoch: 2, Steps: 979 | Train Loss: 0.8860697 Vali Loss: 0.5654522 Best vali loss: 0.5654522
	iters: 100, epoch: 3 | loss: 0.6586214
	speed: 0.0114s/iter; left time: 65.8899s
	iters: 200, epoch: 3 | loss: 0.9727560
	speed: 0.0032s/iter; left time: 18.0383s
	iters: 300, epoch: 3 | loss: 1.2963824
	speed: 0.0031s/iter; left time: 17.1383s
	iters: 400, epoch: 3 | loss: 0.3646870
	speed: 0.0031s/iter; left time: 16.8325s
	iters: 500, epoch: 3 | loss: 0.9073968
	speed: 0.0031s/iter; left time: 16.6287s
	iters: 600, epoch: 3 | loss: 0.6309147
	speed: 0.0031s/iter; left time: 16.2654s
	iters: 700, epoch: 3 | loss: 0.6515103
	speed: 0.0031s/iter; left time: 16.0635s
	iters: 800, epoch: 3 | loss: 1.1022546
	speed: 0.0033s/iter; left time: 16.6304s
	iters: 900, epoch: 3 | loss: 0.2563378
	speed: 0.0031s/iter; left time: 15.4548s
Updating learning rate to 3.012190965e-05
Validation loss decreased (0.5655 --> 0.5558).  Saving model state dict ...
Epoch: 3 cost time: 3.106066942214966
Epoch: 3, Steps: 979 | Train Loss: 0.7600957 Vali Loss: 0.5557673 Best vali loss: 0.5557673

best validation loss 0.5557673359733662

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011820043182, 'e_layers': 2, 'learning_rate': 0.0001204876386, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1149852
	speed: 0.0099s/iter; left time: 47.6975s
	iters: 200, epoch: 4 | loss: 0.6515031
	speed: 0.0036s/iter; left time: 16.7413s
	iters: 300, epoch: 4 | loss: 0.9457982
	speed: 0.0033s/iter; left time: 15.2691s
	iters: 400, epoch: 4 | loss: 0.2696510
	speed: 0.0033s/iter; left time: 14.8876s
	iters: 500, epoch: 4 | loss: 1.1250784
	speed: 0.0033s/iter; left time: 14.5449s
	iters: 600, epoch: 4 | loss: 0.8190211
	speed: 0.0033s/iter; left time: 14.1815s
	iters: 700, epoch: 4 | loss: 0.6183491
	speed: 0.0035s/iter; left time: 14.5581s
	iters: 800, epoch: 4 | loss: 0.4217266
	speed: 0.0035s/iter; left time: 14.2201s
	iters: 900, epoch: 4 | loss: 0.3821526
	speed: 0.0035s/iter; left time: 14.0118s
Updating learning rate to 1.5060954825e-05
Validation loss decreased (0.5558 --> 0.5516).  Saving model state dict ...
Epoch: 4 cost time: 3.6994941234588623
Epoch: 4, Steps: 979 | Train Loss: 0.7053628 Vali Loss: 0.5515719 Best vali loss: 0.5515719
	iters: 100, epoch: 5 | loss: 0.5627688
	speed: 0.0117s/iter; left time: 44.5261s
	iters: 200, epoch: 5 | loss: 1.1645900
	speed: 0.0032s/iter; left time: 11.9154s
	iters: 300, epoch: 5 | loss: 1.0791069
	speed: 0.0032s/iter; left time: 11.6196s
	iters: 400, epoch: 5 | loss: 0.3824761
	speed: 0.0032s/iter; left time: 11.3182s
	iters: 500, epoch: 5 | loss: 1.4331841
	speed: 0.0031s/iter; left time: 10.7443s
	iters: 600, epoch: 5 | loss: 0.6999149
	speed: 0.0031s/iter; left time: 10.2592s
	iters: 700, epoch: 5 | loss: 0.2627097
	speed: 0.0029s/iter; left time: 9.4867s
	iters: 800, epoch: 5 | loss: 0.6014054
	speed: 0.0030s/iter; left time: 9.3227s
	iters: 900, epoch: 5 | loss: 0.7426584
	speed: 0.0030s/iter; left time: 9.1024s
Updating learning rate to 7.5304774125e-06
Validation loss decreased (0.5516 --> 0.5462).  Saving model state dict ...
Epoch: 5 cost time: 3.0854380130767822
Epoch: 5, Steps: 979 | Train Loss: 0.7698683 Vali Loss: 0.5462343 Best vali loss: 0.5462343
	iters: 100, epoch: 6 | loss: 0.6580492
	speed: 0.0107s/iter; left time: 30.2806s
	iters: 200, epoch: 6 | loss: 0.9616178
	speed: 0.0031s/iter; left time: 8.4547s
	iters: 300, epoch: 6 | loss: 1.0776727
	speed: 0.0031s/iter; left time: 8.0818s
	iters: 400, epoch: 6 | loss: 0.3543140
	speed: 0.0031s/iter; left time: 7.8027s
	iters: 500, epoch: 6 | loss: 0.8917185
	speed: 0.0032s/iter; left time: 7.6847s
	iters: 600, epoch: 6 | loss: 0.5881115
	speed: 0.0032s/iter; left time: 7.5437s
	iters: 700, epoch: 6 | loss: 0.6337962
	speed: 0.0032s/iter; left time: 7.0575s
	iters: 800, epoch: 6 | loss: 1.0031546
	speed: 0.0031s/iter; left time: 6.6788s
	iters: 900, epoch: 6 | loss: 0.2336812
	speed: 0.0034s/iter; left time: 6.8464s
Updating learning rate to 3.76523870625e-06
Validation loss decreased (0.5462 --> 0.5443).  Saving model state dict ...
Epoch: 6 cost time: 3.109464406967163
Epoch: 6, Steps: 979 | Train Loss: 0.7113462 Vali Loss: 0.5442653 Best vali loss: 0.5442653
	iters: 100, epoch: 7 | loss: 0.3548770
	speed: 0.0105s/iter; left time: 19.5984s
	iters: 200, epoch: 7 | loss: 0.6800863
	speed: 0.0031s/iter; left time: 5.4600s
	iters: 300, epoch: 7 | loss: 0.2196134
	speed: 0.0031s/iter; left time: 5.1203s
	iters: 400, epoch: 7 | loss: 1.0573604
	speed: 0.0029s/iter; left time: 4.4791s
	iters: 500, epoch: 7 | loss: 0.3684895
	speed: 0.0031s/iter; left time: 4.5663s
	iters: 600, epoch: 7 | loss: 0.5181273
	speed: 0.0031s/iter; left time: 4.2419s
	iters: 700, epoch: 7 | loss: 0.8309472
	speed: 0.0029s/iter; left time: 3.6902s
	iters: 800, epoch: 7 | loss: 1.2554728
	speed: 0.0029s/iter; left time: 3.3556s
	iters: 900, epoch: 7 | loss: 0.5570858
	speed: 0.0029s/iter; left time: 3.0694s
Updating learning rate to 1.882619353125e-06
Epoch: 7 cost time: 2.9683420658111572
Epoch: 7, Steps: 979 | Train Loss: 0.6491177 Vali Loss: 0.5462440 Best vali loss: 0.5442653
	iters: 100, epoch: 8 | loss: 0.8263893
	speed: 0.0102s/iter; left time: 9.0196s
	iters: 200, epoch: 8 | loss: 0.2434678
	speed: 0.0029s/iter; left time: 2.2490s
	iters: 300, epoch: 8 | loss: 0.3137081
	speed: 0.0029s/iter; left time: 1.9587s
	iters: 400, epoch: 8 | loss: 0.2681532
	speed: 0.0029s/iter; left time: 1.7088s
	iters: 500, epoch: 8 | loss: 0.6178012
	speed: 0.0029s/iter; left time: 1.3973s
	iters: 600, epoch: 8 | loss: 0.6576667
	speed: 0.0031s/iter; left time: 1.1700s
	iters: 700, epoch: 8 | loss: 1.7104558
	speed: 0.0031s/iter; left time: 0.8734s
	iters: 800, epoch: 8 | loss: 0.6561675
	speed: 0.0032s/iter; left time: 0.5700s
	iters: 900, epoch: 8 | loss: 0.5010686
	speed: 0.0031s/iter; left time: 0.2473s
Updating learning rate to 9.413096765625e-07
Epoch: 8 cost time: 2.993291139602661
Epoch: 8, Steps: 979 | Train Loss: 0.6438754 Vali Loss: 0.5456138 Best vali loss: 0.5442653

best validation loss 0.5442652579867581

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0025420170316, 'e_layers': 4, 'learning_rate': 0.0002320516809, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002320516809
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 0.8150851726531982
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6019055 Best vali loss: 0.6019055
Updating learning rate to 0.00011602584045
Epoch: 2 cost time: 0.5496265888214111
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6105203 Best vali loss: 0.6019055
Updating learning rate to 5.8012920225e-05
Epoch: 3 cost time: 0.5531570911407471
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6173861 Best vali loss: 0.6019055
Updating learning rate to 2.90064601125e-05
Validation loss decreased (0.6019 --> 0.5907).  Saving model state dict ...
Epoch: 4 cost time: 0.5325071811676025
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5907425 Best vali loss: 0.5907425
Updating learning rate to 1.450323005625e-05
Validation loss decreased (0.5907 --> 0.5886).  Saving model state dict ...
Epoch: 5 cost time: 0.5224514007568359
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5886383 Best vali loss: 0.5886383
Updating learning rate to 7.251615028125e-06
Epoch: 6 cost time: 0.5323607921600342
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5887575 Best vali loss: 0.5886383
Updating learning rate to 3.6258075140625e-06
Validation loss decreased (0.5886 --> 0.5841).  Saving model state dict ...
Epoch: 7 cost time: 0.516930103302002
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5841116 Best vali loss: 0.5841116
Updating learning rate to 1.81290375703125e-06
Epoch: 8 cost time: 0.5151345729827881
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5856468 Best vali loss: 0.5841116

best validation loss 0.584111595942653

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0087672748336, 'e_layers': 3, 'learning_rate': 0.0004177249968, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9453613
	speed: 0.0105s/iter; left time: 81.3210s
	iters: 200, epoch: 1 | loss: 1.1663756
	speed: 0.0039s/iter; left time: 29.8222s
	iters: 300, epoch: 1 | loss: 0.9462301
	speed: 0.0042s/iter; left time: 31.3851s
	iters: 400, epoch: 1 | loss: 0.3328192
	speed: 0.0041s/iter; left time: 30.4472s
	iters: 500, epoch: 1 | loss: 0.7116411
	speed: 0.0037s/iter; left time: 27.2992s
	iters: 600, epoch: 1 | loss: 1.4933982
	speed: 0.0037s/iter; left time: 26.9894s
	iters: 700, epoch: 1 | loss: 1.0669835
	speed: 0.0037s/iter; left time: 26.5752s
	iters: 800, epoch: 1 | loss: 1.3946687
	speed: 0.0038s/iter; left time: 26.9477s
	iters: 900, epoch: 1 | loss: 0.9045129
	speed: 0.0038s/iter; left time: 26.3786s
Updating learning rate to 0.0004177249968
Validation loss decreased (inf --> 0.6259).  Saving model state dict ...
Epoch: 1 cost time: 4.165907859802246
Epoch: 1, Steps: 979 | Train Loss: 0.9957767 Vali Loss: 0.6258808 Best vali loss: 0.6258808
	iters: 100, epoch: 2 | loss: 0.3335196
	speed: 0.0124s/iter; left time: 84.0696s
	iters: 200, epoch: 2 | loss: 0.5054735
	speed: 0.0040s/iter; left time: 26.5240s
	iters: 300, epoch: 2 | loss: 1.5507283
	speed: 0.0039s/iter; left time: 25.8194s
	iters: 400, epoch: 2 | loss: 2.5965173
	speed: 0.0040s/iter; left time: 25.5293s
	iters: 500, epoch: 2 | loss: 0.4891440
	speed: 0.0038s/iter; left time: 24.4438s
	iters: 600, epoch: 2 | loss: 0.4117671
	speed: 0.0038s/iter; left time: 23.5141s
	iters: 700, epoch: 2 | loss: 0.3032652
	speed: 0.0039s/iter; left time: 24.0935s
	iters: 800, epoch: 2 | loss: 0.5664943
	speed: 0.0037s/iter; left time: 22.4458s
	iters: 900, epoch: 2 | loss: 0.6933437
	speed: 0.0038s/iter; left time: 22.6020s
Updating learning rate to 0.0002088624984
Epoch: 2 cost time: 3.8245692253112793
Epoch: 2, Steps: 979 | Train Loss: 0.8278059 Vali Loss: 0.6354509 Best vali loss: 0.6258808
	iters: 100, epoch: 3 | loss: 1.1639808
	speed: 0.0122s/iter; left time: 70.6718s
	iters: 200, epoch: 3 | loss: 1.3212326
	speed: 0.0038s/iter; left time: 21.5350s
	iters: 300, epoch: 3 | loss: 1.5578538
	speed: 0.0039s/iter; left time: 21.6262s
	iters: 400, epoch: 3 | loss: 1.3574961
	speed: 0.0038s/iter; left time: 20.8055s
	iters: 500, epoch: 3 | loss: 0.3201857
	speed: 0.0037s/iter; left time: 20.0853s
	iters: 600, epoch: 3 | loss: 0.6124503
	speed: 0.0038s/iter; left time: 20.2350s
	iters: 700, epoch: 3 | loss: 0.3631126
	speed: 0.0040s/iter; left time: 20.4949s
	iters: 800, epoch: 3 | loss: 0.2854653
	speed: 0.0038s/iter; left time: 19.4958s
	iters: 900, epoch: 3 | loss: 0.5881944
	speed: 0.0038s/iter; left time: 19.1129s
Updating learning rate to 0.0001044312492
Epoch: 3 cost time: 3.8096275329589844
Epoch: 3, Steps: 979 | Train Loss: 0.8411080 Vali Loss: 0.6473746 Best vali loss: 0.6258808
	iters: 100, epoch: 4 | loss: 0.7793481
	speed: 0.0129s/iter; left time: 61.8421s
	iters: 200, epoch: 4 | loss: 0.5397109
	speed: 0.0038s/iter; left time: 17.7679s
	iters: 300, epoch: 4 | loss: 0.6327459
	speed: 0.0038s/iter; left time: 17.2432s
	iters: 400, epoch: 4 | loss: 0.3878088
	speed: 0.0038s/iter; left time: 16.9035s
	iters: 500, epoch: 4 | loss: 1.0859776
	speed: 0.0038s/iter; left time: 16.7071s
	iters: 600, epoch: 4 | loss: 0.3519134
	speed: 0.0037s/iter; left time: 16.1077s
	iters: 700, epoch: 4 | loss: 0.6001620
	speed: 0.0038s/iter; left time: 15.9625s
	iters: 800, epoch: 4 | loss: 0.8479564
	speed: 0.0038s/iter; left time: 15.5532s
	iters: 900, epoch: 4 | loss: 1.2832723
	speed: 0.0039s/iter; left time: 15.5164s
Updating learning rate to 5.22156246e-05
Validation loss decreased (0.6259 --> 0.6094).  Saving model state dict ...
Epoch: 4 cost time: 3.763242244720459
Epoch: 4, Steps: 979 | Train Loss: 0.7232106 Vali Loss: 0.6093996 Best vali loss: 0.6093996
	iters: 100, epoch: 5 | loss: 1.3751725
	speed: 0.0126s/iter; left time: 48.2126s
	iters: 200, epoch: 5 | loss: 0.6822977
	speed: 0.0040s/iter; left time: 14.7930s
	iters: 300, epoch: 5 | loss: 1.2977945
	speed: 0.0040s/iter; left time: 14.4331s
	iters: 400, epoch: 5 | loss: 1.5215774
	speed: 0.0039s/iter; left time: 13.6822s
	iters: 500, epoch: 5 | loss: 0.4061262
	speed: 0.0038s/iter; left time: 13.0440s
	iters: 600, epoch: 5 | loss: 0.4259720
	speed: 0.0040s/iter; left time: 13.1432s
	iters: 700, epoch: 5 | loss: 0.9180293
	speed: 0.0042s/iter; left time: 13.6322s
	iters: 800, epoch: 5 | loss: 1.4863610
	speed: 0.0045s/iter; left time: 13.9902s
	iters: 900, epoch: 5 | loss: 0.5441898
	speed: 0.0044s/iter; left time: 13.2984s
Updating learning rate to 2.61078123e-05
Validation loss decreased (0.6094 --> 0.6088).  Saving model state dict ...
Epoch: 5 cost time: 4.048623561859131
Epoch: 5, Steps: 979 | Train Loss: 0.9619467 Vali Loss: 0.6087847 Best vali loss: 0.6087847
	iters: 100, epoch: 6 | loss: 0.8450392
	speed: 0.0135s/iter; left time: 38.3398s
	iters: 200, epoch: 6 | loss: 1.1649308
	speed: 0.0040s/iter; left time: 10.9592s
	iters: 300, epoch: 6 | loss: 0.5496355
	speed: 0.0039s/iter; left time: 10.2067s
	iters: 400, epoch: 6 | loss: 1.3396485
	speed: 0.0039s/iter; left time: 9.9276s
	iters: 500, epoch: 6 | loss: 1.0771488
	speed: 0.0038s/iter; left time: 9.3522s
	iters: 600, epoch: 6 | loss: 0.4988668
	speed: 0.0038s/iter; left time: 8.9767s
	iters: 700, epoch: 6 | loss: 0.8188950
	speed: 0.0038s/iter; left time: 8.4814s
	iters: 800, epoch: 6 | loss: 0.8527099
	speed: 0.0037s/iter; left time: 7.8473s
	iters: 900, epoch: 6 | loss: 1.1836240
	speed: 0.0037s/iter; left time: 7.4682s
Updating learning rate to 1.305390615e-05
Epoch: 6 cost time: 3.800142288208008
Epoch: 6, Steps: 979 | Train Loss: 0.9256110 Vali Loss: 0.6293407 Best vali loss: 0.6087847
	iters: 100, epoch: 7 | loss: 0.8518704
	speed: 0.0123s/iter; left time: 22.9358s
	iters: 200, epoch: 7 | loss: 1.3931469
	speed: 0.0039s/iter; left time: 6.8402s
	iters: 300, epoch: 7 | loss: 0.4454852
	speed: 0.0039s/iter; left time: 6.5374s
	iters: 400, epoch: 7 | loss: 0.5207483
	speed: 0.0040s/iter; left time: 6.2264s
	iters: 500, epoch: 7 | loss: 0.7165140
	speed: 0.0040s/iter; left time: 5.7974s
	iters: 600, epoch: 7 | loss: 0.9490646
	speed: 0.0040s/iter; left time: 5.4139s
	iters: 700, epoch: 7 | loss: 0.5425189
	speed: 0.0039s/iter; left time: 4.9374s
	iters: 800, epoch: 7 | loss: 0.5039950
	speed: 0.0038s/iter; left time: 4.4493s
	iters: 900, epoch: 7 | loss: 0.7268382
	speed: 0.0039s/iter; left time: 4.1578s
Updating learning rate to 6.526953075e-06
Epoch: 7 cost time: 3.8958091735839844
Epoch: 7, Steps: 979 | Train Loss: 0.7389091 Vali Loss: 0.6196891 Best vali loss: 0.6087847
	iters: 100, epoch: 8 | loss: 1.2301608
	speed: 0.0133s/iter; left time: 11.6704s
	iters: 200, epoch: 8 | loss: 0.6629609
	speed: 0.0045s/iter; left time: 3.5257s
	iters: 300, epoch: 8 | loss: 0.7719038
	speed: 0.0045s/iter; left time: 3.0731s
	iters: 400, epoch: 8 | loss: 0.5238800
	speed: 0.0045s/iter; left time: 2.6067s
	iters: 500, epoch: 8 | loss: 0.7533312
	speed: 0.0045s/iter; left time: 2.1535s
	iters: 600, epoch: 8 | loss: 1.3714898
	speed: 0.0043s/iter; left time: 1.6394s
	iters: 700, epoch: 8 | loss: 0.7499384
	speed: 0.0044s/iter; left time: 1.2324s
	iters: 800, epoch: 8 | loss: 0.8606997
	speed: 0.0044s/iter; left time: 0.7926s
	iters: 900, epoch: 8 | loss: 0.5289608
	speed: 0.0042s/iter; left time: 0.3328s
Updating learning rate to 3.2634765375e-06
Epoch: 8 cost time: 4.347723722457886
Epoch: 8, Steps: 979 | Train Loss: 0.8281473 Vali Loss: 0.6216256 Best vali loss: 0.6087847

best validation loss 0.6087847390091017

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015014532881, 'e_layers': 1, 'learning_rate': 0.0030333406352, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1514053
	speed: 0.0087s/iter; left time: 67.2907s
	iters: 200, epoch: 1 | loss: 1.0103793
	speed: 0.0026s/iter; left time: 19.6903s
	iters: 300, epoch: 1 | loss: 0.6800632
	speed: 0.0025s/iter; left time: 18.6314s
	iters: 400, epoch: 1 | loss: 0.8357604
	speed: 0.0024s/iter; left time: 18.0090s
	iters: 500, epoch: 1 | loss: 1.2983663
	speed: 0.0025s/iter; left time: 18.1632s
	iters: 600, epoch: 1 | loss: 0.3684584
	speed: 0.0024s/iter; left time: 17.3120s
	iters: 700, epoch: 1 | loss: 0.8609957
	speed: 0.0024s/iter; left time: 16.9141s
	iters: 800, epoch: 1 | loss: 0.9470170
	speed: 0.0024s/iter; left time: 16.6701s
	iters: 900, epoch: 1 | loss: 1.1292578
	speed: 0.0024s/iter; left time: 16.3340s
Updating learning rate to 0.0030333406352
Validation loss decreased (inf --> 0.6240).  Saving model state dict ...
Epoch: 1 cost time: 2.7361700534820557
Epoch: 1, Steps: 979 | Train Loss: 0.9201893 Vali Loss: 0.6239576 Best vali loss: 0.6239576
	iters: 100, epoch: 2 | loss: 1.0790895
	speed: 0.0091s/iter; left time: 61.4195s
	iters: 200, epoch: 2 | loss: 0.8030059
	speed: 0.0025s/iter; left time: 16.4780s
	iters: 300, epoch: 2 | loss: 0.4352864
	speed: 0.0025s/iter; left time: 16.3211s
	iters: 400, epoch: 2 | loss: 0.7879159
	speed: 0.0026s/iter; left time: 16.4837s
	iters: 500, epoch: 2 | loss: 0.3477067
	speed: 0.0024s/iter; left time: 15.3401s
	iters: 600, epoch: 2 | loss: 0.7541075
	speed: 0.0024s/iter; left time: 14.8714s
	iters: 700, epoch: 2 | loss: 1.4513085
	speed: 0.0024s/iter; left time: 14.5217s
	iters: 800, epoch: 2 | loss: 1.1275012
	speed: 0.0024s/iter; left time: 14.7630s
	iters: 900, epoch: 2 | loss: 0.4445942
	speed: 0.0025s/iter; left time: 15.0650s
Updating learning rate to 0.0015166703176
Validation loss decreased (0.6240 --> 0.6054).  Saving model state dict ...
Epoch: 2 cost time: 2.4498212337493896
Epoch: 2, Steps: 979 | Train Loss: 0.8033907 Vali Loss: 0.6054336 Best vali loss: 0.6054336
	iters: 100, epoch: 3 | loss: 0.3586332
	speed: 0.0091s/iter; left time: 52.3194s
	iters: 200, epoch: 3 | loss: 1.0623038
	speed: 0.0025s/iter; left time: 14.3000s
	iters: 300, epoch: 3 | loss: 0.6780255
	speed: 0.0024s/iter; left time: 13.4710s
	iters: 400, epoch: 3 | loss: 0.7161109
	speed: 0.0024s/iter; left time: 12.9420s
	iters: 500, epoch: 3 | loss: 1.6494106
	speed: 0.0025s/iter; left time: 13.1784s
	iters: 600, epoch: 3 | loss: 1.0306193
	speed: 0.0025s/iter; left time: 13.2950s
	iters: 700, epoch: 3 | loss: 0.5717428
	speed: 0.0025s/iter; left time: 13.0648s
	iters: 800, epoch: 3 | loss: 2.0026383
	speed: 0.0025s/iter; left time: 12.7620s
	iters: 900, epoch: 3 | loss: 0.9945362
	speed: 0.0024s/iter; left time: 12.1661s
Updating learning rate to 0.0007583351588
Validation loss decreased (0.6054 --> 0.5921).  Saving model state dict ...
Epoch: 3 cost time: 2.457669496536255
Epoch: 3, Steps: 979 | Train Loss: 1.0071134 Vali Loss: 0.5921190 Best vali loss: 0.5921190

best validation loss 0.5921190481034764

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0035659850235, 'e_layers': 4, 'learning_rate': 0.0004715115488, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004535657090395084
Validation loss decreased (inf --> 0.6111).  Saving model state dict ...
Epoch: 1 cost time: 1.2678437232971191
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6111122 Best vali loss: 0.6111122
Updating learning rate to 0.00040246028118212586
Validation loss decreased (0.6111 --> 0.6094).  Saving model state dict ...
Epoch: 2 cost time: 0.9975290298461914
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6093826 Best vali loss: 0.6093826
Updating learning rate to 0.0003259756033472818
Validation loss decreased (0.6094 --> 0.6038).  Saving model state dict ...
Epoch: 3 cost time: 0.9899871349334717
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6037668 Best vali loss: 0.6037668

best validation loss 0.6037668126537423

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0037610861302, 'e_layers': 4, 'learning_rate': 0.0009414154384, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7832881
	speed: 0.0112s/iter; left time: 42.9619s
	iters: 200, epoch: 1 | loss: 0.7992501
	speed: 0.0048s/iter; left time: 18.0036s
	iters: 300, epoch: 1 | loss: 0.8989803
	speed: 0.0048s/iter; left time: 17.5171s
	iters: 400, epoch: 1 | loss: 1.0473429
	speed: 0.0049s/iter; left time: 17.4208s
Updating learning rate to 0.0009055849467639501
Validation loss decreased (inf --> 0.6075).  Saving model state dict ...
Epoch: 1 cost time: 2.7824313640594482
Epoch: 1, Steps: 490 | Train Loss: 0.8822153 Vali Loss: 0.6075290 Best vali loss: 0.6075290
	iters: 100, epoch: 2 | loss: 1.5063626
	speed: 0.0138s/iter; left time: 46.0497s
	iters: 200, epoch: 2 | loss: 1.0693412
	speed: 0.0050s/iter; left time: 16.0943s
	iters: 300, epoch: 2 | loss: 0.7831603
	speed: 0.0049s/iter; left time: 15.2990s
	iters: 400, epoch: 2 | loss: 0.6583206
	speed: 0.0050s/iter; left time: 15.2179s
Updating learning rate to 0.0008035483394031733
Epoch: 2 cost time: 2.490330219268799
Epoch: 2, Steps: 490 | Train Loss: 1.0042962 Vali Loss: 0.6225737 Best vali loss: 0.6075290
	iters: 100, epoch: 3 | loss: 1.2380711
	speed: 0.0141s/iter; left time: 40.1129s
	iters: 200, epoch: 3 | loss: 1.1674980
	speed: 0.0053s/iter; left time: 14.6253s
	iters: 300, epoch: 3 | loss: 0.4891028
	speed: 0.0053s/iter; left time: 14.0591s
	iters: 400, epoch: 3 | loss: 0.5673162
	speed: 0.0051s/iter; left time: 12.9382s
Updating learning rate to 0.0006508397648241989
Epoch: 3 cost time: 2.612638473510742
Epoch: 3, Steps: 490 | Train Loss: 0.8654970 Vali Loss: 0.6108524 Best vali loss: 0.6075290

best validation loss 0.607529048426512

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015014532881, 'e_layers': 1, 'learning_rate': 0.0030333406352, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0211730
	speed: 0.0086s/iter; left time: 41.2270s
	iters: 200, epoch: 4 | loss: 0.9713508
	speed: 0.0025s/iter; left time: 11.6127s
	iters: 300, epoch: 4 | loss: 0.5792533
	speed: 0.0025s/iter; left time: 11.3100s
	iters: 400, epoch: 4 | loss: 0.7476274
	speed: 0.0025s/iter; left time: 11.0727s
	iters: 500, epoch: 4 | loss: 1.1595136
	speed: 0.0025s/iter; left time: 11.0986s
	iters: 600, epoch: 4 | loss: 0.3290691
	speed: 0.0025s/iter; left time: 10.7628s
	iters: 700, epoch: 4 | loss: 0.7124428
	speed: 0.0025s/iter; left time: 10.3361s
	iters: 800, epoch: 4 | loss: 0.8744797
	speed: 0.0024s/iter; left time: 9.8909s
	iters: 900, epoch: 4 | loss: 1.0047745
	speed: 0.0025s/iter; left time: 10.1600s
Updating learning rate to 0.0003791675794
Epoch: 4 cost time: 2.764148235321045
Epoch: 4, Steps: 979 | Train Loss: 0.8221871 Vali Loss: 0.6330992 Best vali loss: 0.5921190
	iters: 100, epoch: 5 | loss: 0.9532806
	speed: 0.0090s/iter; left time: 34.3177s
	iters: 200, epoch: 5 | loss: 0.7670168
	speed: 0.0024s/iter; left time: 8.8079s
	iters: 300, epoch: 5 | loss: 0.2990654
	speed: 0.0023s/iter; left time: 8.1705s
	iters: 400, epoch: 5 | loss: 0.5101081
	speed: 0.0023s/iter; left time: 7.9310s
	iters: 500, epoch: 5 | loss: 0.3201424
	speed: 0.0023s/iter; left time: 7.8762s
	iters: 600, epoch: 5 | loss: 0.4544315
	speed: 0.0023s/iter; left time: 7.5587s
	iters: 700, epoch: 5 | loss: 1.2832795
	speed: 0.0023s/iter; left time: 7.3809s
	iters: 800, epoch: 5 | loss: 0.9073655
	speed: 0.0022s/iter; left time: 6.9275s
	iters: 900, epoch: 5 | loss: 0.3976383
	speed: 0.0022s/iter; left time: 6.6446s
Updating learning rate to 0.0001895837897
Epoch: 5 cost time: 2.288114547729492
Epoch: 5, Steps: 979 | Train Loss: 0.6547031 Vali Loss: 0.6150934 Best vali loss: 0.5921190
	iters: 100, epoch: 6 | loss: 0.3575314
	speed: 0.0089s/iter; left time: 25.3297s
	iters: 200, epoch: 6 | loss: 0.9755949
	speed: 0.0023s/iter; left time: 6.3669s
	iters: 300, epoch: 6 | loss: 0.6286747
	speed: 0.0023s/iter; left time: 6.1318s
	iters: 400, epoch: 6 | loss: 0.6613476
	speed: 0.0023s/iter; left time: 5.8575s
	iters: 500, epoch: 6 | loss: 1.6016672
	speed: 0.0023s/iter; left time: 5.6957s
	iters: 600, epoch: 6 | loss: 0.9955954
	speed: 0.0023s/iter; left time: 5.3458s
	iters: 700, epoch: 6 | loss: 0.5609636
	speed: 0.0022s/iter; left time: 4.9500s
	iters: 800, epoch: 6 | loss: 1.8380824
	speed: 0.0022s/iter; left time: 4.6933s
	iters: 900, epoch: 6 | loss: 0.9851865
	speed: 0.0022s/iter; left time: 4.5697s
Updating learning rate to 9.479189485e-05
Epoch: 6 cost time: 2.2935538291931152
Epoch: 6, Steps: 979 | Train Loss: 0.9560715 Vali Loss: 0.5928381 Best vali loss: 0.5921190
	iters: 100, epoch: 7 | loss: 0.9847800
	speed: 0.0090s/iter; left time: 16.7085s
	iters: 200, epoch: 7 | loss: 0.8340598
	speed: 0.0022s/iter; left time: 3.9473s
	iters: 300, epoch: 7 | loss: 0.4056416
	speed: 0.0022s/iter; left time: 3.7131s
	iters: 400, epoch: 7 | loss: 1.3108188
	speed: 0.0022s/iter; left time: 3.4971s
	iters: 500, epoch: 7 | loss: 1.2954178
	speed: 0.0022s/iter; left time: 3.2158s
	iters: 600, epoch: 7 | loss: 0.8185985
	speed: 0.0022s/iter; left time: 2.9521s
	iters: 700, epoch: 7 | loss: 0.2513129
	speed: 0.0022s/iter; left time: 2.7378s
	iters: 800, epoch: 7 | loss: 0.8004202
	speed: 0.0022s/iter; left time: 2.5211s
	iters: 900, epoch: 7 | loss: 0.3801812
	speed: 0.0021s/iter; left time: 2.2768s
Updating learning rate to 4.7395947425e-05
Epoch: 7 cost time: 2.2022225856781006
Epoch: 7, Steps: 979 | Train Loss: 0.7868034 Vali Loss: 0.6010065 Best vali loss: 0.5921190
	iters: 100, epoch: 8 | loss: 0.8403071
	speed: 0.0083s/iter; left time: 7.2750s
	iters: 200, epoch: 8 | loss: 0.9392009
	speed: 0.0023s/iter; left time: 1.7865s
	iters: 300, epoch: 8 | loss: 0.5034143
	speed: 0.0023s/iter; left time: 1.5540s
	iters: 400, epoch: 8 | loss: 0.2094586
	speed: 0.0023s/iter; left time: 1.3185s
	iters: 500, epoch: 8 | loss: 0.3913799
	speed: 0.0023s/iter; left time: 1.0980s
	iters: 600, epoch: 8 | loss: 0.4439681
	speed: 0.0023s/iter; left time: 0.8721s
	iters: 700, epoch: 8 | loss: 0.5318002
	speed: 0.0022s/iter; left time: 0.6260s
	iters: 800, epoch: 8 | loss: 0.4671916
	speed: 0.0023s/iter; left time: 0.4099s
	iters: 900, epoch: 8 | loss: 1.1955845
	speed: 0.0024s/iter; left time: 0.1905s
Updating learning rate to 2.36979737125e-05
Epoch: 8 cost time: 2.32788348197937
Epoch: 8, Steps: 979 | Train Loss: 0.6135894 Vali Loss: 0.6060564 Best vali loss: 0.5921190

best validation loss 0.5921190481034764

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0001774463268, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7614529
	speed: 0.0118s/iter; left time: 10.4128s
Updating learning rate to 0.00017069267812491452
Validation loss decreased (inf --> 0.6078).  Saving model state dict ...
Epoch: 1 cost time: 1.0258288383483887
Epoch: 1, Steps: 123 | Train Loss: 0.7614529 Vali Loss: 0.6078171 Best vali loss: 0.6078171
	iters: 100, epoch: 2 | loss: 0.9336182
	speed: 0.0093s/iter; left time: 7.0729s
Updating learning rate to 0.0001514599138884621
Validation loss decreased (0.6078 --> 0.5613).  Saving model state dict ...
Epoch: 2 cost time: 0.7177753448486328
Epoch: 2, Steps: 123 | Train Loss: 0.9336182 Vali Loss: 0.5613025 Best vali loss: 0.5613025
	iters: 100, epoch: 3 | loss: 0.8633270
	speed: 0.0094s/iter; left time: 6.0092s
Updating learning rate to 0.00012267604810020072
Validation loss decreased (0.5613 --> 0.5506).  Saving model state dict ...
Epoch: 3 cost time: 0.7255861759185791
Epoch: 3, Steps: 123 | Train Loss: 0.8633270 Vali Loss: 0.5505668 Best vali loss: 0.5505668
	iters: 100, epoch: 4 | loss: 0.5048204
	speed: 0.0094s/iter; left time: 4.8353s
Updating learning rate to 8.87231634e-05
Epoch: 4 cost time: 0.7173161506652832
Epoch: 4, Steps: 123 | Train Loss: 0.5048204 Vali Loss: 0.5633482 Best vali loss: 0.5505668
	iters: 100, epoch: 5 | loss: 0.5765237
	speed: 0.0090s/iter; left time: 3.5189s
Updating learning rate to 5.4770278699799295e-05
Validation loss decreased (0.5506 --> 0.5307).  Saving model state dict ...
Epoch: 5 cost time: 0.7138547897338867
Epoch: 5, Steps: 123 | Train Loss: 0.5765237 Vali Loss: 0.5307311 Best vali loss: 0.5307311
	iters: 100, epoch: 6 | loss: 0.6208249
	speed: 0.0093s/iter; left time: 2.5001s
Updating learning rate to 2.5986412911537903e-05
Epoch: 6 cost time: 0.721733808517456
Epoch: 6, Steps: 123 | Train Loss: 0.6208249 Vali Loss: 0.5333455 Best vali loss: 0.5307311
	iters: 100, epoch: 7 | loss: 0.5741316
	speed: 0.0089s/iter; left time: 1.3151s
Updating learning rate to 6.753648675085495e-06
Validation loss decreased (0.5307 --> 0.5278).  Saving model state dict ...
Epoch: 7 cost time: 0.7135553359985352
Epoch: 7, Steps: 123 | Train Loss: 0.5741316 Vali Loss: 0.5278322 Best vali loss: 0.5278322
	iters: 100, epoch: 8 | loss: 0.7407355
	speed: 0.0093s/iter; left time: 0.2242s
Updating learning rate to 0.0
Validation loss decreased (0.5278 --> 0.5255).  Saving model state dict ...
Epoch: 8 cost time: 0.7169919013977051
Epoch: 8, Steps: 123 | Train Loss: 0.7407355 Vali Loss: 0.5255109 Best vali loss: 0.5255109

best validation loss 0.5255108518023449

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029395320649, 'e_layers': 3, 'learning_rate': 0.0001621195329, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0779940
	speed: 0.0108s/iter; left time: 41.1484s
	iters: 200, epoch: 1 | loss: 0.6713845
	speed: 0.0046s/iter; left time: 17.1136s
	iters: 300, epoch: 1 | loss: 1.7006092
	speed: 0.0047s/iter; left time: 16.9220s
	iters: 400, epoch: 1 | loss: 0.5336236
	speed: 0.0047s/iter; left time: 16.4468s
Updating learning rate to 0.0001621195329
Validation loss decreased (inf --> 0.6165).  Saving model state dict ...
Epoch: 1 cost time: 2.6248061656951904
Epoch: 1, Steps: 490 | Train Loss: 0.9959028 Vali Loss: 0.6165007 Best vali loss: 0.6165007
	iters: 100, epoch: 2 | loss: 0.7825617
	speed: 0.0126s/iter; left time: 41.8382s
	iters: 200, epoch: 2 | loss: 0.5583339
	speed: 0.0042s/iter; left time: 13.5774s
	iters: 300, epoch: 2 | loss: 1.0903174
	speed: 0.0042s/iter; left time: 13.0118s
	iters: 400, epoch: 2 | loss: 1.2957850
	speed: 0.0040s/iter; left time: 12.0724s
Updating learning rate to 8.105976645e-05
Epoch: 2 cost time: 2.0887508392333984
Epoch: 2, Steps: 490 | Train Loss: 0.9317495 Vali Loss: 0.6229366 Best vali loss: 0.6165007
	iters: 100, epoch: 3 | loss: 0.7485484
	speed: 0.0113s/iter; left time: 32.1215s
	iters: 200, epoch: 3 | loss: 0.4188143
	speed: 0.0040s/iter; left time: 10.8273s
	iters: 300, epoch: 3 | loss: 0.6744079
	speed: 0.0039s/iter; left time: 10.3753s
	iters: 400, epoch: 3 | loss: 0.5483533
	speed: 0.0039s/iter; left time: 9.9584s
Updating learning rate to 4.0529883225e-05
Validation loss decreased (0.6165 --> 0.5525).  Saving model state dict ...
Epoch: 3 cost time: 1.983949899673462
Epoch: 3, Steps: 490 | Train Loss: 0.5975310 Vali Loss: 0.5525466 Best vali loss: 0.5525466
	iters: 100, epoch: 4 | loss: 0.7297992
	speed: 0.0119s/iter; left time: 27.9121s
	iters: 200, epoch: 4 | loss: 0.5719501
	speed: 0.0041s/iter; left time: 9.1370s
	iters: 300, epoch: 4 | loss: 0.8418865
	speed: 0.0041s/iter; left time: 8.8477s
	iters: 400, epoch: 4 | loss: 0.8052065
	speed: 0.0041s/iter; left time: 8.4919s
Updating learning rate to 2.02649416125e-05
Validation loss decreased (0.5525 --> 0.5405).  Saving model state dict ...
Epoch: 4 cost time: 2.069819211959839
Epoch: 4, Steps: 490 | Train Loss: 0.7372106 Vali Loss: 0.5404766 Best vali loss: 0.5404766
	iters: 100, epoch: 5 | loss: 0.8495510
	speed: 0.0127s/iter; left time: 23.5723s
	iters: 200, epoch: 5 | loss: 0.3917267
	speed: 0.0046s/iter; left time: 8.0866s
	iters: 300, epoch: 5 | loss: 1.0166985
	speed: 0.0045s/iter; left time: 7.5174s
	iters: 400, epoch: 5 | loss: 0.5894201
	speed: 0.0046s/iter; left time: 7.1876s
Updating learning rate to 1.013247080625e-05
Validation loss decreased (0.5405 --> 0.5328).  Saving model state dict ...
Epoch: 5 cost time: 2.3031082153320312
Epoch: 5, Steps: 490 | Train Loss: 0.7118491 Vali Loss: 0.5327993 Best vali loss: 0.5327993
	iters: 100, epoch: 6 | loss: 0.6064512
	speed: 0.0127s/iter; left time: 17.4004s
	iters: 200, epoch: 6 | loss: 0.9371536
	speed: 0.0043s/iter; left time: 5.4284s
	iters: 300, epoch: 6 | loss: 0.4633178
	speed: 0.0042s/iter; left time: 4.9608s
	iters: 400, epoch: 6 | loss: 0.8846021
	speed: 0.0044s/iter; left time: 4.7350s
Updating learning rate to 5.066235403125e-06
Epoch: 6 cost time: 2.172905206680298
Epoch: 6, Steps: 490 | Train Loss: 0.7228812 Vali Loss: 0.5336324 Best vali loss: 0.5327993
	iters: 100, epoch: 7 | loss: 0.5376467
	speed: 0.0124s/iter; left time: 10.9474s
	iters: 200, epoch: 7 | loss: 0.5724247
	speed: 0.0047s/iter; left time: 3.6715s
	iters: 300, epoch: 7 | loss: 0.5804488
	speed: 0.0043s/iter; left time: 2.9499s
	iters: 400, epoch: 7 | loss: 0.4469035
	speed: 0.0045s/iter; left time: 2.6158s
Updating learning rate to 2.5331177015625e-06
Epoch: 7 cost time: 2.284644365310669
Epoch: 7, Steps: 490 | Train Loss: 0.5343559 Vali Loss: 0.5351943 Best vali loss: 0.5327993
	iters: 100, epoch: 8 | loss: 0.4075592
	speed: 0.0120s/iter; left time: 4.7103s
	iters: 200, epoch: 8 | loss: 0.5908782
	speed: 0.0043s/iter; left time: 1.2507s
	iters: 300, epoch: 8 | loss: 0.5123017
	speed: 0.0043s/iter; left time: 0.8235s
	iters: 400, epoch: 8 | loss: 0.8280386
	speed: 0.0043s/iter; left time: 0.3915s
Updating learning rate to 1.26655885078125e-06
Epoch: 8 cost time: 2.1845638751983643
Epoch: 8, Steps: 490 | Train Loss: 0.5846944 Vali Loss: 0.5344248 Best vali loss: 0.5327993

best validation loss 0.5327992648203469

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.002741094615, 'e_layers': 3, 'learning_rate': 0.000159830426, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0777912
	speed: 0.0100s/iter; left time: 38.2639s
	iters: 200, epoch: 1 | loss: 0.6706530
	speed: 0.0047s/iter; left time: 17.4119s
	iters: 300, epoch: 1 | loss: 1.7009529
	speed: 0.0046s/iter; left time: 16.8359s
	iters: 400, epoch: 1 | loss: 0.5320433
	speed: 0.0045s/iter; left time: 15.8783s
Updating learning rate to 0.000159830426
Validation loss decreased (inf --> 0.6162).  Saving model state dict ...
Epoch: 1 cost time: 2.5844197273254395
Epoch: 1, Steps: 490 | Train Loss: 0.9953601 Vali Loss: 0.6162422 Best vali loss: 0.6162422
	iters: 100, epoch: 2 | loss: 0.7850139
	speed: 0.0125s/iter; left time: 41.7065s
	iters: 200, epoch: 2 | loss: 0.5548152
	speed: 0.0045s/iter; left time: 14.4247s
	iters: 300, epoch: 2 | loss: 1.0860215
	speed: 0.0047s/iter; left time: 14.6583s
	iters: 400, epoch: 2 | loss: 1.4037127
	speed: 0.0047s/iter; left time: 14.0971s
Updating learning rate to 7.9915213e-05
Validation loss decreased (0.6162 --> 0.5824).  Saving model state dict ...
Epoch: 2 cost time: 2.291914701461792
Epoch: 2, Steps: 490 | Train Loss: 0.9573908 Vali Loss: 0.5823552 Best vali loss: 0.5823552
	iters: 100, epoch: 3 | loss: 0.7416072
	speed: 0.0127s/iter; left time: 36.0485s
	iters: 200, epoch: 3 | loss: 0.4075323
	speed: 0.0046s/iter; left time: 12.5762s
	iters: 300, epoch: 3 | loss: 0.6829120
	speed: 0.0046s/iter; left time: 12.2357s
	iters: 400, epoch: 3 | loss: 0.5423578
	speed: 0.0045s/iter; left time: 11.4554s
Updating learning rate to 3.99576065e-05
Validation loss decreased (0.5824 --> 0.5489).  Saving model state dict ...
Epoch: 3 cost time: 2.2907330989837646
Epoch: 3, Steps: 490 | Train Loss: 0.5936023 Vali Loss: 0.5489067 Best vali loss: 0.5489067

best validation loss 0.5489066773848862

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0019910652374, 'e_layers': 4, 'learning_rate': 0.0034879229792, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8485096
	speed: 0.0109s/iter; left time: 41.5245s
	iters: 200, epoch: 1 | loss: 0.7975644
	speed: 0.0054s/iter; left time: 20.1139s
	iters: 300, epoch: 1 | loss: 1.2063849
	speed: 0.0054s/iter; left time: 19.5941s
	iters: 400, epoch: 1 | loss: 1.3257747
	speed: 0.0055s/iter; left time: 19.2764s
Updating learning rate to 0.0034879229792
Validation loss decreased (inf --> 0.6408).  Saving model state dict ...
Epoch: 1 cost time: 3.0108187198638916
Epoch: 1, Steps: 490 | Train Loss: 1.0445584 Vali Loss: 0.6407842 Best vali loss: 0.6407842
	iters: 100, epoch: 2 | loss: 1.0853399
	speed: 0.0146s/iter; left time: 48.5905s
	iters: 200, epoch: 2 | loss: 0.5572967
	speed: 0.0055s/iter; left time: 17.7108s
	iters: 300, epoch: 2 | loss: 1.3528496
	speed: 0.0051s/iter; left time: 16.0848s
	iters: 400, epoch: 2 | loss: 0.5290872
	speed: 0.0050s/iter; left time: 15.2203s
Updating learning rate to 0.0017439614896
Epoch: 2 cost time: 2.6123366355895996
Epoch: 2, Steps: 490 | Train Loss: 0.8811434 Vali Loss: 0.6575132 Best vali loss: 0.6407842
	iters: 100, epoch: 3 | loss: 1.1186149
	speed: 0.0137s/iter; left time: 39.0634s
	iters: 200, epoch: 3 | loss: 0.4856133
	speed: 0.0053s/iter; left time: 14.5925s
	iters: 300, epoch: 3 | loss: 1.2240083
	speed: 0.0050s/iter; left time: 13.2485s
	iters: 400, epoch: 3 | loss: 0.9951133
	speed: 0.0046s/iter; left time: 11.7761s
Updating learning rate to 0.0008719807448
Validation loss decreased (0.6408 --> 0.6350).  Saving model state dict ...
Epoch: 3 cost time: 2.5019845962524414
Epoch: 3, Steps: 490 | Train Loss: 0.9558375 Vali Loss: 0.6350089 Best vali loss: 0.6350089

best validation loss 0.6350088903248613

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0013817457035, 'e_layers': 3, 'learning_rate': 0.000111161127, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3826586
	speed: 0.0105s/iter; left time: 81.4294s
	iters: 200, epoch: 1 | loss: 1.4529115
	speed: 0.0042s/iter; left time: 32.1989s
	iters: 300, epoch: 1 | loss: 1.1328952
	speed: 0.0041s/iter; left time: 31.1759s
	iters: 400, epoch: 1 | loss: 0.5049046
	speed: 0.0042s/iter; left time: 30.8677s
	iters: 500, epoch: 1 | loss: 0.3923978
	speed: 0.0042s/iter; left time: 30.7205s
	iters: 600, epoch: 1 | loss: 1.8586078
	speed: 0.0042s/iter; left time: 30.7066s
	iters: 700, epoch: 1 | loss: 1.1259371
	speed: 0.0041s/iter; left time: 29.1726s
	iters: 800, epoch: 1 | loss: 0.5016402
	speed: 0.0039s/iter; left time: 27.3840s
	iters: 900, epoch: 1 | loss: 1.4923365
	speed: 0.0041s/iter; left time: 28.5291s
Updating learning rate to 0.00010693030852309388
Validation loss decreased (inf --> 0.6315).  Saving model state dict ...
Epoch: 1 cost time: 4.417120695114136
Epoch: 1, Steps: 979 | Train Loss: 0.9826988 Vali Loss: 0.6314611 Best vali loss: 0.6314611
	iters: 100, epoch: 2 | loss: 0.3331698
	speed: 0.0136s/iter; left time: 91.5755s
	iters: 200, epoch: 2 | loss: 0.3167157
	speed: 0.0039s/iter; left time: 26.1376s
	iters: 300, epoch: 2 | loss: 0.6538625
	speed: 0.0039s/iter; left time: 25.3297s
	iters: 400, epoch: 2 | loss: 1.8975334
	speed: 0.0039s/iter; left time: 25.3765s
	iters: 500, epoch: 2 | loss: 1.0768007
	speed: 0.0037s/iter; left time: 23.6097s
	iters: 600, epoch: 2 | loss: 0.4383903
	speed: 0.0038s/iter; left time: 23.6707s
	iters: 700, epoch: 2 | loss: 0.8194476
	speed: 0.0037s/iter; left time: 22.9989s
	iters: 800, epoch: 2 | loss: 0.3349233
	speed: 0.0037s/iter; left time: 22.5479s
	iters: 900, epoch: 2 | loss: 0.6161544
	speed: 0.0038s/iter; left time: 22.6579s
Updating learning rate to 9.488195685301951e-05
Validation loss decreased (0.6315 --> 0.6128).  Saving model state dict ...
Epoch: 2 cost time: 3.824983596801758
Epoch: 2, Steps: 979 | Train Loss: 0.7207775 Vali Loss: 0.6128328 Best vali loss: 0.6128328
	iters: 100, epoch: 3 | loss: 1.4215795
	speed: 0.0133s/iter; left time: 76.5302s
	iters: 200, epoch: 3 | loss: 1.2877021
	speed: 0.0043s/iter; left time: 24.3125s
	iters: 300, epoch: 3 | loss: 1.1754717
	speed: 0.0044s/iter; left time: 24.4983s
	iters: 400, epoch: 3 | loss: 0.6179017
	speed: 0.0044s/iter; left time: 23.8387s
	iters: 500, epoch: 3 | loss: 1.3232001
	speed: 0.0044s/iter; left time: 23.5700s
	iters: 600, epoch: 3 | loss: 0.3506617
	speed: 0.0044s/iter; left time: 23.0442s
	iters: 700, epoch: 3 | loss: 0.3179730
	speed: 0.0043s/iter; left time: 22.0229s
	iters: 800, epoch: 3 | loss: 1.2253331
	speed: 0.0044s/iter; left time: 22.3168s
	iters: 900, epoch: 3 | loss: 0.7038139
	speed: 0.0042s/iter; left time: 21.0091s
Updating learning rate to 7.685032431296583e-05
Validation loss decreased (0.6128 --> 0.6041).  Saving model state dict ...
Epoch: 3 cost time: 4.271095275878906
Epoch: 3, Steps: 979 | Train Loss: 0.9359596 Vali Loss: 0.6040830 Best vali loss: 0.6040830

best validation loss 0.6040829565998361

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.002741094615, 'e_layers': 3, 'learning_rate': 0.000159830426, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9141766
	speed: 0.0113s/iter; left time: 26.6039s
	iters: 200, epoch: 4 | loss: 0.3930625
	speed: 0.0047s/iter; left time: 10.6467s
	iters: 300, epoch: 4 | loss: 1.5439090
	speed: 0.0045s/iter; left time: 9.6094s
	iters: 400, epoch: 4 | loss: 0.3546992
	speed: 0.0044s/iter; left time: 8.9798s
Updating learning rate to 1.997880325e-05
Validation loss decreased (0.5489 --> 0.5313).  Saving model state dict ...
Epoch: 4 cost time: 2.570700168609619
Epoch: 4, Steps: 490 | Train Loss: 0.8014618 Vali Loss: 0.5312883 Best vali loss: 0.5312883
	iters: 100, epoch: 5 | loss: 0.6883014
	speed: 0.0124s/iter; left time: 23.1394s
	iters: 200, epoch: 5 | loss: 0.4861628
	speed: 0.0044s/iter; left time: 7.7597s
	iters: 300, epoch: 5 | loss: 0.8720115
	speed: 0.0044s/iter; left time: 7.3431s
	iters: 400, epoch: 5 | loss: 1.0889705
	speed: 0.0044s/iter; left time: 6.8782s
Updating learning rate to 9.989401625e-06
Validation loss decreased (0.5313 --> 0.5281).  Saving model state dict ...
Epoch: 5 cost time: 2.212812662124634
Epoch: 5, Steps: 490 | Train Loss: 0.7838616 Vali Loss: 0.5280702 Best vali loss: 0.5280702
	iters: 100, epoch: 6 | loss: 0.6575205
	speed: 0.0127s/iter; left time: 17.4072s
	iters: 200, epoch: 6 | loss: 0.3645003
	speed: 0.0046s/iter; left time: 5.8583s
	iters: 300, epoch: 6 | loss: 0.5907726
	speed: 0.0046s/iter; left time: 5.4121s
	iters: 400, epoch: 6 | loss: 0.5150846
	speed: 0.0045s/iter; left time: 4.8189s
Updating learning rate to 4.9947008125e-06
Epoch: 6 cost time: 2.293764352798462
Epoch: 6, Steps: 490 | Train Loss: 0.5319695 Vali Loss: 0.5308779 Best vali loss: 0.5280702
	iters: 100, epoch: 7 | loss: 0.6999400
	speed: 0.0124s/iter; left time: 10.9575s
	iters: 200, epoch: 7 | loss: 0.5515044
	speed: 0.0046s/iter; left time: 3.5886s
	iters: 300, epoch: 7 | loss: 0.8022919
	speed: 0.0046s/iter; left time: 3.1484s
	iters: 400, epoch: 7 | loss: 0.7638334
	speed: 0.0044s/iter; left time: 2.5787s
Updating learning rate to 2.49735040625e-06
Epoch: 7 cost time: 2.2743537425994873
Epoch: 7, Steps: 490 | Train Loss: 0.7043924 Vali Loss: 0.5295847 Best vali loss: 0.5280702
	iters: 100, epoch: 8 | loss: 0.8067721
	speed: 0.0121s/iter; left time: 4.7257s
	iters: 200, epoch: 8 | loss: 0.3626280
	speed: 0.0042s/iter; left time: 1.2266s
	iters: 300, epoch: 8 | loss: 0.9840885
	speed: 0.0042s/iter; left time: 0.8033s
	iters: 400, epoch: 8 | loss: 0.5863518
	speed: 0.0043s/iter; left time: 0.3934s
Updating learning rate to 1.248675203125e-06
Epoch: 8 cost time: 2.134882688522339
Epoch: 8, Steps: 490 | Train Loss: 0.6849601 Vali Loss: 0.5320068 Best vali loss: 0.5280702

best validation loss 0.5280702282010489

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0033442239314, 'e_layers': 3, 'learning_rate': 9.50287011e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6097634
	speed: 0.0106s/iter; left time: 19.6746s
	iters: 200, epoch: 1 | loss: 0.5992996
	speed: 0.0050s/iter; left time: 8.8355s
Updating learning rate to 9.50287011e-05
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 1.5969438552856445
Epoch: 1, Steps: 245 | Train Loss: 0.6045315 Vali Loss: 0.6156023 Best vali loss: 0.6156023
	iters: 100, epoch: 2 | loss: 0.5475187
	speed: 0.0123s/iter; left time: 19.8342s
	iters: 200, epoch: 2 | loss: 1.2037239
	speed: 0.0050s/iter; left time: 7.5429s
Updating learning rate to 4.751435055e-05
Validation loss decreased (0.6156 --> 0.5486).  Saving model state dict ...
Epoch: 2 cost time: 1.2841317653656006
Epoch: 2, Steps: 245 | Train Loss: 0.8756213 Vali Loss: 0.5485708 Best vali loss: 0.5485708
	iters: 100, epoch: 3 | loss: 0.7547417
	speed: 0.0104s/iter; left time: 14.3060s
	iters: 200, epoch: 3 | loss: 0.4749106
	speed: 0.0049s/iter; left time: 6.2324s
Updating learning rate to 2.3757175275e-05
Validation loss decreased (0.5486 --> 0.5329).  Saving model state dict ...
Epoch: 3 cost time: 1.2540125846862793
Epoch: 3, Steps: 245 | Train Loss: 0.6148262 Vali Loss: 0.5328777 Best vali loss: 0.5328777
	iters: 100, epoch: 4 | loss: 0.6985133
	speed: 0.0103s/iter; left time: 11.6154s
	iters: 200, epoch: 4 | loss: 0.6971790
	speed: 0.0049s/iter; left time: 5.0527s
Updating learning rate to 1.18785876375e-05
Epoch: 4 cost time: 1.2508337497711182
Epoch: 4, Steps: 245 | Train Loss: 0.6978461 Vali Loss: 0.5336537 Best vali loss: 0.5328777
	iters: 100, epoch: 5 | loss: 0.8159187
	speed: 0.0100s/iter; left time: 8.8166s
	iters: 200, epoch: 5 | loss: 0.5399793
	speed: 0.0050s/iter; left time: 3.9195s
Updating learning rate to 5.93929381875e-06
Epoch: 5 cost time: 1.271308183670044
Epoch: 5, Steps: 245 | Train Loss: 0.6779490 Vali Loss: 0.5346699 Best vali loss: 0.5328777
	iters: 100, epoch: 6 | loss: 0.6916760
	speed: 0.0100s/iter; left time: 6.3378s
	iters: 200, epoch: 6 | loss: 0.7714980
	speed: 0.0049s/iter; left time: 2.6284s
Updating learning rate to 2.969646909375e-06
Epoch: 6 cost time: 1.249314308166504
Epoch: 6, Steps: 245 | Train Loss: 0.7315870 Vali Loss: 0.5394835 Best vali loss: 0.5328777
	iters: 100, epoch: 7 | loss: 0.5851803
	speed: 0.0103s/iter; left time: 4.0387s
	iters: 200, epoch: 7 | loss: 0.5146284
	speed: 0.0052s/iter; left time: 1.5024s
Updating learning rate to 1.4848234546875e-06
Epoch: 7 cost time: 1.3099663257598877
Epoch: 7, Steps: 245 | Train Loss: 0.5499044 Vali Loss: 0.5401085 Best vali loss: 0.5328777
	iters: 100, epoch: 8 | loss: 0.7244518
	speed: 0.0103s/iter; left time: 1.5062s
	iters: 200, epoch: 8 | loss: 0.7330830
	speed: 0.0053s/iter; left time: 0.2428s
Updating learning rate to 7.4241172734375e-07
Epoch: 8 cost time: 1.3280951976776123
Epoch: 8, Steps: 245 | Train Loss: 0.7287674 Vali Loss: 0.5397721 Best vali loss: 0.5328777

best validation loss 0.5328776636288046

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010099808305, 'e_layers': 3, 'learning_rate': 0.0018533425545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2797415
	speed: 0.0098s/iter; left time: 75.5577s
	iters: 200, epoch: 1 | loss: 0.6788053
	speed: 0.0043s/iter; left time: 32.8067s
	iters: 300, epoch: 1 | loss: 0.6179256
	speed: 0.0043s/iter; left time: 32.2107s
	iters: 400, epoch: 1 | loss: 0.2891316
	speed: 0.0044s/iter; left time: 32.8214s
	iters: 500, epoch: 1 | loss: 0.3512672
	speed: 0.0044s/iter; left time: 32.5464s
	iters: 600, epoch: 1 | loss: 0.7534931
	speed: 0.0043s/iter; left time: 31.0769s
	iters: 700, epoch: 1 | loss: 1.2992694
	speed: 0.0040s/iter; left time: 28.5025s
	iters: 800, epoch: 1 | loss: 0.6237645
	speed: 0.0039s/iter; left time: 27.5004s
	iters: 900, epoch: 1 | loss: 0.6360011
	speed: 0.0039s/iter; left time: 26.8475s
Updating learning rate to 0.0018533425545
Validation loss decreased (inf --> 0.6355).  Saving model state dict ...
Epoch: 1 cost time: 4.442270278930664
Epoch: 1, Steps: 979 | Train Loss: 0.7254888 Vali Loss: 0.6355241 Best vali loss: 0.6355241
	iters: 100, epoch: 2 | loss: 0.8362700
	speed: 0.0130s/iter; left time: 87.8376s
	iters: 200, epoch: 2 | loss: 0.4742779
	speed: 0.0039s/iter; left time: 25.9723s
	iters: 300, epoch: 2 | loss: 0.3480453
	speed: 0.0040s/iter; left time: 26.2841s
	iters: 400, epoch: 2 | loss: 1.3670032
	speed: 0.0040s/iter; left time: 25.6233s
	iters: 500, epoch: 2 | loss: 1.0654033
	speed: 0.0039s/iter; left time: 24.5812s
	iters: 600, epoch: 2 | loss: 1.6055162
	speed: 0.0040s/iter; left time: 24.9886s
	iters: 700, epoch: 2 | loss: 0.3671195
	speed: 0.0043s/iter; left time: 26.7243s
	iters: 800, epoch: 2 | loss: 0.9599677
	speed: 0.0046s/iter; left time: 27.7681s
	iters: 900, epoch: 2 | loss: 0.5734375
	speed: 0.0046s/iter; left time: 27.5339s
Updating learning rate to 0.00092667127725
Epoch: 2 cost time: 4.1280272006988525
Epoch: 2, Steps: 979 | Train Loss: 0.8441156 Vali Loss: 0.6570316 Best vali loss: 0.6355241
	iters: 100, epoch: 3 | loss: 0.3190539
	speed: 0.0136s/iter; left time: 78.4853s
	iters: 200, epoch: 3 | loss: 0.7596209
	speed: 0.0040s/iter; left time: 22.8874s
	iters: 300, epoch: 3 | loss: 1.2279418
	speed: 0.0040s/iter; left time: 22.4371s
	iters: 400, epoch: 3 | loss: 1.1376054
	speed: 0.0040s/iter; left time: 21.8818s
	iters: 500, epoch: 3 | loss: 1.0632856
	speed: 0.0040s/iter; left time: 21.7049s
	iters: 600, epoch: 3 | loss: 0.8292616
	speed: 0.0039s/iter; left time: 20.7947s
	iters: 700, epoch: 3 | loss: 1.6371441
	speed: 0.0039s/iter; left time: 20.3419s
	iters: 800, epoch: 3 | loss: 1.1270915
	speed: 0.0038s/iter; left time: 19.4010s
	iters: 900, epoch: 3 | loss: 1.4950161
	speed: 0.0037s/iter; left time: 18.3735s
Updating learning rate to 0.000463335638625
Epoch: 3 cost time: 3.8884243965148926
Epoch: 3, Steps: 979 | Train Loss: 1.0662245 Vali Loss: 0.6483514 Best vali loss: 0.6355241
	iters: 100, epoch: 4 | loss: 1.2120045
	speed: 0.0124s/iter; left time: 59.3093s
	iters: 200, epoch: 4 | loss: 1.4551322
	speed: 0.0037s/iter; left time: 17.4365s
	iters: 300, epoch: 4 | loss: 1.3853482
	speed: 0.0037s/iter; left time: 17.1096s
	iters: 400, epoch: 4 | loss: 2.4098041
	speed: 0.0043s/iter; left time: 19.1351s
	iters: 500, epoch: 4 | loss: 1.1972321
	speed: 0.0045s/iter; left time: 19.8974s
	iters: 600, epoch: 4 | loss: 0.2711252
	speed: 0.0042s/iter; left time: 18.1983s
	iters: 700, epoch: 4 | loss: 1.0384251
	speed: 0.0039s/iter; left time: 16.5205s
	iters: 800, epoch: 4 | loss: 0.4186271
	speed: 0.0039s/iter; left time: 16.1612s
	iters: 900, epoch: 4 | loss: 1.4542103
	speed: 0.0040s/iter; left time: 15.9845s
Updating learning rate to 0.0002316678193125
Epoch: 4 cost time: 3.959338903427124
Epoch: 4, Steps: 979 | Train Loss: 1.2046565 Vali Loss: 0.6454235 Best vali loss: 0.6355241
	iters: 100, epoch: 5 | loss: 1.5723296
	speed: 0.0127s/iter; left time: 48.5890s
	iters: 200, epoch: 5 | loss: 1.4436255
	speed: 0.0044s/iter; left time: 16.2564s
	iters: 300, epoch: 5 | loss: 0.9480731
	speed: 0.0045s/iter; left time: 16.3240s
	iters: 400, epoch: 5 | loss: 0.8865762
	speed: 0.0044s/iter; left time: 15.3606s
	iters: 500, epoch: 5 | loss: 0.5237290
	speed: 0.0045s/iter; left time: 15.5330s
	iters: 600, epoch: 5 | loss: 0.8499929
	speed: 0.0045s/iter; left time: 14.9469s
	iters: 700, epoch: 5 | loss: 1.3575382
	speed: 0.0044s/iter; left time: 14.1465s
	iters: 800, epoch: 5 | loss: 1.0771712
	speed: 0.0046s/iter; left time: 14.3144s
	iters: 900, epoch: 5 | loss: 0.5241711
	speed: 0.0045s/iter; left time: 13.6771s
Updating learning rate to 0.00011583390965625
Epoch: 5 cost time: 4.377635478973389
Epoch: 5, Steps: 979 | Train Loss: 1.0203563 Vali Loss: 0.6463523 Best vali loss: 0.6355241
	iters: 100, epoch: 6 | loss: 0.8569396
	speed: 0.0140s/iter; left time: 39.6371s
	iters: 200, epoch: 6 | loss: 1.2115066
	speed: 0.0044s/iter; left time: 11.9663s
	iters: 300, epoch: 6 | loss: 1.0455287
	speed: 0.0045s/iter; left time: 11.9133s
	iters: 400, epoch: 6 | loss: 0.8776596
	speed: 0.0045s/iter; left time: 11.2946s
	iters: 500, epoch: 6 | loss: 0.3475752
	speed: 0.0045s/iter; left time: 10.8988s
	iters: 600, epoch: 6 | loss: 0.5854641
	speed: 0.0045s/iter; left time: 10.4446s
	iters: 700, epoch: 6 | loss: 0.7211280
	speed: 0.0043s/iter; left time: 9.6610s
	iters: 800, epoch: 6 | loss: 1.2794532
	speed: 0.0043s/iter; left time: 9.1966s
	iters: 900, epoch: 6 | loss: 1.1071090
	speed: 0.0043s/iter; left time: 8.8021s
Updating learning rate to 5.7916954828125e-05
Epoch: 6 cost time: 4.3615968227386475
Epoch: 6, Steps: 979 | Train Loss: 0.8924849 Vali Loss: 0.6445853 Best vali loss: 0.6355241
	iters: 100, epoch: 7 | loss: 0.7961511
	speed: 0.0135s/iter; left time: 25.1732s
	iters: 200, epoch: 7 | loss: 0.8802557
	speed: 0.0043s/iter; left time: 7.5085s
	iters: 300, epoch: 7 | loss: 1.1192071
	speed: 0.0045s/iter; left time: 7.4149s
	iters: 400, epoch: 7 | loss: 1.0489677
	speed: 0.0042s/iter; left time: 6.5856s
	iters: 500, epoch: 7 | loss: 0.9614617
	speed: 0.0043s/iter; left time: 6.3062s
	iters: 600, epoch: 7 | loss: 0.6836623
	speed: 0.0039s/iter; left time: 5.3664s
	iters: 700, epoch: 7 | loss: 0.9854863
	speed: 0.0040s/iter; left time: 5.0805s
	iters: 800, epoch: 7 | loss: 1.2254418
	speed: 0.0040s/iter; left time: 4.6921s
	iters: 900, epoch: 7 | loss: 1.8976964
	speed: 0.0039s/iter; left time: 4.1662s
Updating learning rate to 2.89584774140625e-05
Epoch: 7 cost time: 4.11787748336792
Epoch: 7, Steps: 979 | Train Loss: 1.0664811 Vali Loss: 0.6438455 Best vali loss: 0.6355241
	iters: 100, epoch: 8 | loss: 0.8620486
	speed: 0.0131s/iter; left time: 11.5695s
	iters: 200, epoch: 8 | loss: 0.9565612
	speed: 0.0044s/iter; left time: 3.3961s
	iters: 300, epoch: 8 | loss: 0.3534788
	speed: 0.0044s/iter; left time: 2.9869s
	iters: 400, epoch: 8 | loss: 0.8050978
	speed: 0.0040s/iter; left time: 2.3092s
	iters: 500, epoch: 8 | loss: 0.7352372
	speed: 0.0040s/iter; left time: 1.9300s
	iters: 600, epoch: 8 | loss: 1.0620049
	speed: 0.0041s/iter; left time: 1.5401s
	iters: 700, epoch: 8 | loss: 1.3476835
	speed: 0.0039s/iter; left time: 1.0921s
	iters: 800, epoch: 8 | loss: 1.3063402
	speed: 0.0040s/iter; left time: 0.7125s
	iters: 900, epoch: 8 | loss: 1.1605870
	speed: 0.0040s/iter; left time: 0.3204s
Updating learning rate to 1.447923870703125e-05
Epoch: 8 cost time: 4.054000377655029
Epoch: 8, Steps: 979 | Train Loss: 0.9543377 Vali Loss: 0.6437108 Best vali loss: 0.6355241

best validation loss 0.6355240808378376

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.00227105089, 'e_layers': 3, 'learning_rate': 9.39708747e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6101955
	speed: 0.0116s/iter; left time: 21.5394s
	iters: 200, epoch: 1 | loss: 0.5996858
	speed: 0.0052s/iter; left time: 9.1496s
Updating learning rate to 9.39708747e-05
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 1.6254279613494873
Epoch: 1, Steps: 245 | Train Loss: 0.6049407 Vali Loss: 0.6156099 Best vali loss: 0.6156099
	iters: 100, epoch: 2 | loss: 0.5474523
	speed: 0.0101s/iter; left time: 16.3278s
	iters: 200, epoch: 2 | loss: 1.2095362
	speed: 0.0049s/iter; left time: 7.4412s
Updating learning rate to 4.698543735e-05
Validation loss decreased (0.6156 --> 0.5485).  Saving model state dict ...
Epoch: 2 cost time: 1.2414319515228271
Epoch: 2, Steps: 245 | Train Loss: 0.8784943 Vali Loss: 0.5484825 Best vali loss: 0.5484825
	iters: 100, epoch: 3 | loss: 0.7524564
	speed: 0.0108s/iter; left time: 14.7669s
	iters: 200, epoch: 3 | loss: 0.4758580
	speed: 0.0053s/iter; left time: 6.6761s
Updating learning rate to 2.3492718675e-05
Validation loss decreased (0.5485 --> 0.5342).  Saving model state dict ...
Epoch: 3 cost time: 1.3316421508789062
Epoch: 3, Steps: 245 | Train Loss: 0.6141572 Vali Loss: 0.5341583 Best vali loss: 0.5341583

best validation loss 0.5341582561410836

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019527604428, 'e_layers': 3, 'learning_rate': 9.14893079e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6116619
	speed: 0.0116s/iter; left time: 21.6495s
	iters: 200, epoch: 1 | loss: 0.6000659
	speed: 0.0053s/iter; left time: 9.2729s
Updating learning rate to 9.14893079e-05
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 1.635723352432251
Epoch: 1, Steps: 245 | Train Loss: 0.6058639 Vali Loss: 0.6157023 Best vali loss: 0.6157023
	iters: 100, epoch: 2 | loss: 0.5473567
	speed: 0.0105s/iter; left time: 17.0303s
	iters: 200, epoch: 2 | loss: 1.2228066
	speed: 0.0049s/iter; left time: 7.4347s
Updating learning rate to 4.574465395e-05
Validation loss decreased (0.6157 --> 0.5524).  Saving model state dict ...
Epoch: 2 cost time: 1.2686855792999268
Epoch: 2, Steps: 245 | Train Loss: 0.8850816 Vali Loss: 0.5524081 Best vali loss: 0.5524081
	iters: 100, epoch: 3 | loss: 0.7539802
	speed: 0.0104s/iter; left time: 14.2707s
	iters: 200, epoch: 3 | loss: 0.4772519
	speed: 0.0049s/iter; left time: 6.2239s
Updating learning rate to 2.2872326975e-05
Validation loss decreased (0.5524 --> 0.5347).  Saving model state dict ...
Epoch: 3 cost time: 1.2441794872283936
Epoch: 3, Steps: 245 | Train Loss: 0.6156160 Vali Loss: 0.5346507 Best vali loss: 0.5346507

best validation loss 0.5346506750043042

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0027550088453, 'e_layers': 1, 'learning_rate': 6.29639752e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8628305
	speed: 0.0090s/iter; left time: 7.9587s
Updating learning rate to 6.056755158641413e-05
Validation loss decreased (inf --> 0.7014).  Saving model state dict ...
Epoch: 1 cost time: 0.786754846572876
Epoch: 1, Steps: 123 | Train Loss: 0.8628305 Vali Loss: 0.7013603 Best vali loss: 0.7013603
	iters: 100, epoch: 2 | loss: 1.0963191
	speed: 0.0066s/iter; left time: 5.0014s
Updating learning rate to 5.3743114517190805e-05
Validation loss decreased (0.7014 --> 0.6863).  Saving model state dict ...
Epoch: 2 cost time: 0.49797582626342773
Epoch: 2, Steps: 123 | Train Loss: 1.0963191 Vali Loss: 0.6863173 Best vali loss: 0.6863173
	iters: 100, epoch: 3 | loss: 0.7988189
	speed: 0.0067s/iter; left time: 4.2510s
Updating learning rate to 4.35296226724432e-05
Validation loss decreased (0.6863 --> 0.6745).  Saving model state dict ...
Epoch: 3 cost time: 0.4835186004638672
Epoch: 3, Steps: 123 | Train Loss: 0.7988189 Vali Loss: 0.6744857 Best vali loss: 0.6744857

best validation loss 0.6744856747804224

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.00227105089, 'e_layers': 3, 'learning_rate': 9.39708747e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4686278
	speed: 0.0116s/iter; left time: 13.1034s
	iters: 200, epoch: 4 | loss: 0.4413673
	speed: 0.0050s/iter; left time: 5.1148s
Updating learning rate to 1.17463593375e-05
Epoch: 4 cost time: 1.585674524307251
Epoch: 4, Steps: 245 | Train Loss: 0.4549975 Vali Loss: 0.5372104 Best vali loss: 0.5341583
	iters: 100, epoch: 5 | loss: 0.5084041
	speed: 0.0102s/iter; left time: 8.9625s
	iters: 200, epoch: 5 | loss: 1.0606943
	speed: 0.0052s/iter; left time: 4.0471s
Updating learning rate to 5.87317966875e-06
Validation loss decreased (0.5342 --> 0.5339).  Saving model state dict ...
Epoch: 5 cost time: 1.3068101406097412
Epoch: 5, Steps: 245 | Train Loss: 0.7845492 Vali Loss: 0.5338583 Best vali loss: 0.5338583
	iters: 100, epoch: 6 | loss: 0.7086101
	speed: 0.0107s/iter; left time: 6.7978s
	iters: 200, epoch: 6 | loss: 0.4547114
	speed: 0.0050s/iter; left time: 2.6602s
Updating learning rate to 2.936589834375e-06
Epoch: 6 cost time: 1.2619514465332031
Epoch: 6, Steps: 245 | Train Loss: 0.5816607 Vali Loss: 0.5352818 Best vali loss: 0.5338583
	iters: 100, epoch: 7 | loss: 0.6689590
	speed: 0.0100s/iter; left time: 3.9104s
	iters: 200, epoch: 7 | loss: 0.6869683
	speed: 0.0049s/iter; left time: 1.4347s
Updating learning rate to 1.4682949171875e-06
Epoch: 7 cost time: 1.2566418647766113
Epoch: 7, Steps: 245 | Train Loss: 0.6779636 Vali Loss: 0.5338605 Best vali loss: 0.5338583
	iters: 100, epoch: 8 | loss: 0.8077607
	speed: 0.0103s/iter; left time: 1.5081s
	iters: 200, epoch: 8 | loss: 0.5382832
	speed: 0.0051s/iter; left time: 0.2337s
Updating learning rate to 7.3414745859375e-07
Epoch: 8 cost time: 1.2964954376220703
Epoch: 8, Steps: 245 | Train Loss: 0.6730219 Vali Loss: 0.5347233 Best vali loss: 0.5338583

best validation loss 0.5338583221484091

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025888473334, 'e_layers': 3, 'learning_rate': 5.42961662e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6258146
	speed: 0.0139s/iter; left time: 12.2820s
Updating learning rate to 5.222964142300556e-05
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 1.296541690826416
Epoch: 1, Steps: 123 | Train Loss: 0.6258146 Vali Loss: 0.6048663 Best vali loss: 0.6048663
	iters: 100, epoch: 2 | loss: 0.7428264
	speed: 0.0123s/iter; left time: 9.3584s
Updating learning rate to 4.634467675622591e-05
Validation loss decreased (0.6049 --> 0.6026).  Saving model state dict ...
Epoch: 2 cost time: 0.9921965599060059
Epoch: 2, Steps: 123 | Train Loss: 0.7428264 Vali Loss: 0.6025853 Best vali loss: 0.6025853
	iters: 100, epoch: 3 | loss: 0.6605642
	speed: 0.0124s/iter; left time: 7.9454s
Updating learning rate to 3.7537204722840686e-05
Validation loss decreased (0.6026 --> 0.5606).  Saving model state dict ...
Epoch: 3 cost time: 0.9964597225189209
Epoch: 3, Steps: 123 | Train Loss: 0.6605642 Vali Loss: 0.5605507 Best vali loss: 0.5605507
	iters: 100, epoch: 4 | loss: 0.8927136
	speed: 0.0125s/iter; left time: 6.4501s
Updating learning rate to 2.71480831e-05
Validation loss decreased (0.5606 --> 0.5539).  Saving model state dict ...
Epoch: 4 cost time: 0.9971356391906738
Epoch: 4, Steps: 123 | Train Loss: 0.8927136 Vali Loss: 0.5538896 Best vali loss: 0.5538896
	iters: 100, epoch: 5 | loss: 0.7311803
	speed: 0.0125s/iter; left time: 4.9018s
Updating learning rate to 1.6758961477159314e-05
Validation loss decreased (0.5539 --> 0.5451).  Saving model state dict ...
Epoch: 5 cost time: 0.9999270439147949
Epoch: 5, Steps: 123 | Train Loss: 0.7311803 Vali Loss: 0.5450691 Best vali loss: 0.5450691
	iters: 100, epoch: 6 | loss: 0.4913751
	speed: 0.0124s/iter; left time: 3.3498s
Updating learning rate to 7.951489443774093e-06
Epoch: 6 cost time: 0.9979953765869141
Epoch: 6, Steps: 123 | Train Loss: 0.4913751 Vali Loss: 0.5536300 Best vali loss: 0.5450691
	iters: 100, epoch: 7 | loss: 0.8557953
	speed: 0.0120s/iter; left time: 1.7641s
Updating learning rate to 2.066524776994436e-06
Validation loss decreased (0.5451 --> 0.5425).  Saving model state dict ...
Epoch: 7 cost time: 0.9931013584136963
Epoch: 7, Steps: 123 | Train Loss: 0.8557953 Vali Loss: 0.5425435 Best vali loss: 0.5425435
	iters: 100, epoch: 8 | loss: 0.7450333
	speed: 0.0124s/iter; left time: 0.2973s
Updating learning rate to 0.0
Validation loss decreased (0.5425 --> 0.5372).  Saving model state dict ...
Epoch: 8 cost time: 0.9887566566467285
Epoch: 8, Steps: 123 | Train Loss: 0.7450333 Vali Loss: 0.5372228 Best vali loss: 0.5372228

best validation loss 0.5372228438188941

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0104729337236, 'e_layers': 4, 'learning_rate': 6.02083225e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0458753
	speed: 0.0123s/iter; left time: 10.8998s
Updating learning rate to 5.79167796722944e-05
Validation loss decreased (inf --> 0.6513).  Saving model state dict ...
Epoch: 1 cost time: 1.1125528812408447
Epoch: 1, Steps: 123 | Train Loss: 1.0458753 Vali Loss: 0.6513033 Best vali loss: 0.6513033
	iters: 100, epoch: 2 | loss: 0.9569184
	speed: 0.0099s/iter; left time: 7.5417s
Updating learning rate to 5.139101781180829e-05
Validation loss decreased (0.6513 --> 0.6264).  Saving model state dict ...
Epoch: 2 cost time: 0.816303014755249
Epoch: 2, Steps: 123 | Train Loss: 0.9569184 Vali Loss: 0.6264164 Best vali loss: 0.6264164
	iters: 100, epoch: 3 | loss: 1.3132783
	speed: 0.0091s/iter; left time: 5.8108s
Updating learning rate to 4.162452500562213e-05
Validation loss decreased (0.6264 --> 0.6156).  Saving model state dict ...
Epoch: 3 cost time: 0.721505880355835
Epoch: 3, Steps: 123 | Train Loss: 1.3132783 Vali Loss: 0.6155657 Best vali loss: 0.6155657
	iters: 100, epoch: 4 | loss: 0.7944613
	speed: 0.0099s/iter; left time: 5.0890s
Updating learning rate to 3.010416125e-05
Validation loss decreased (0.6156 --> 0.6095).  Saving model state dict ...
Epoch: 4 cost time: 0.8299546241760254
Epoch: 4, Steps: 123 | Train Loss: 0.7944613 Vali Loss: 0.6095231 Best vali loss: 0.6095231
	iters: 100, epoch: 5 | loss: 0.7795180
	speed: 0.0100s/iter; left time: 3.9420s
Updating learning rate to 1.858379749437787e-05
Validation loss decreased (0.6095 --> 0.6049).  Saving model state dict ...
Epoch: 5 cost time: 0.8320159912109375
Epoch: 5, Steps: 123 | Train Loss: 0.7795180 Vali Loss: 0.6049282 Best vali loss: 0.6049282
	iters: 100, epoch: 6 | loss: 0.7650534
	speed: 0.0094s/iter; left time: 2.5460s
Updating learning rate to 8.817304688191708e-06
Validation loss decreased (0.6049 --> 0.6039).  Saving model state dict ...
Epoch: 6 cost time: 0.7622122764587402
Epoch: 6, Steps: 123 | Train Loss: 0.7650534 Vali Loss: 0.6038702 Best vali loss: 0.6038702
	iters: 100, epoch: 7 | loss: 0.7852544
	speed: 0.0096s/iter; left time: 1.4094s
Updating learning rate to 2.291542827705607e-06
Epoch: 7 cost time: 0.8079812526702881
Epoch: 7, Steps: 123 | Train Loss: 0.7852544 Vali Loss: 0.6039225 Best vali loss: 0.6038702
	iters: 100, epoch: 8 | loss: 0.8761717
	speed: 0.0099s/iter; left time: 0.2377s
Updating learning rate to 0.0
Validation loss decreased (0.6039 --> 0.6038).  Saving model state dict ...
Epoch: 8 cost time: 0.8280372619628906
Epoch: 8, Steps: 123 | Train Loss: 0.8761717 Vali Loss: 0.6038473 Best vali loss: 0.6038473

best validation loss 0.6038473091540321

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0031257734473, 'e_layers': 3, 'learning_rate': 0.0001983033407, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001983033407
Validation loss decreased (inf --> 0.6177).  Saving model state dict ...
Epoch: 1 cost time: 1.020819902420044
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6176873 Best vali loss: 0.6176873
Updating learning rate to 9.915167035e-05
Validation loss decreased (0.6177 --> 0.5677).  Saving model state dict ...
Epoch: 2 cost time: 0.7291476726531982
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5676849 Best vali loss: 0.5676849
Updating learning rate to 4.9575835175e-05
Validation loss decreased (0.5677 --> 0.5560).  Saving model state dict ...
Epoch: 3 cost time: 0.7329766750335693
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5559823 Best vali loss: 0.5559823

best validation loss 0.5559823355813757

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0014977362237, 'e_layers': 2, 'learning_rate': 0.000792495878, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6255378
	speed: 0.0101s/iter; left time: 18.7872s
	iters: 200, epoch: 1 | loss: 0.9162776
	speed: 0.0040s/iter; left time: 6.9887s
Updating learning rate to 0.000792495878
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 1.3071658611297607
Epoch: 1, Steps: 245 | Train Loss: 0.7709077 Vali Loss: 0.6112458 Best vali loss: 0.6112458
	iters: 100, epoch: 2 | loss: 1.2562097
	speed: 0.0077s/iter; left time: 12.3901s
	iters: 200, epoch: 2 | loss: 0.8073539
	speed: 0.0034s/iter; left time: 5.1818s
Updating learning rate to 0.000396247939
Epoch: 2 cost time: 0.8995563983917236
Epoch: 2, Steps: 245 | Train Loss: 1.0317818 Vali Loss: 0.6149035 Best vali loss: 0.6112458
	iters: 100, epoch: 3 | loss: 0.7390957
	speed: 0.0075s/iter; left time: 10.2543s
	iters: 200, epoch: 3 | loss: 0.8056084
	speed: 0.0036s/iter; left time: 4.5330s
Updating learning rate to 0.0001981239695
Epoch: 3 cost time: 0.9141345024108887
Epoch: 3, Steps: 245 | Train Loss: 0.7723521 Vali Loss: 0.6184536 Best vali loss: 0.6112458

best validation loss 0.6112458022420796

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038877069305, 'e_layers': 3, 'learning_rate': 8.80228446e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6072536
	speed: 0.0110s/iter; left time: 20.5011s
	iters: 200, epoch: 1 | loss: 0.8387707
	speed: 0.0048s/iter; left time: 8.3777s
Updating learning rate to 8.467267455968082e-05
Validation loss decreased (inf --> 0.6060).  Saving model state dict ...
Epoch: 1 cost time: 1.5112009048461914
Epoch: 1, Steps: 245 | Train Loss: 0.7230121 Vali Loss: 0.6059962 Best vali loss: 0.6059962
	iters: 100, epoch: 2 | loss: 0.7494939
	speed: 0.0096s/iter; left time: 15.4576s
	iters: 200, epoch: 2 | loss: 1.2322342
	speed: 0.0048s/iter; left time: 7.2516s
Updating learning rate to 7.513219745799483e-05
Epoch: 2 cost time: 1.215991735458374
Epoch: 2, Steps: 245 | Train Loss: 0.9908641 Vali Loss: 0.6068394 Best vali loss: 0.6059962
	iters: 100, epoch: 3 | loss: 0.7737212
	speed: 0.0094s/iter; left time: 12.8583s
	iters: 200, epoch: 3 | loss: 0.8997483
	speed: 0.0045s/iter; left time: 5.6663s
Updating learning rate to 6.0853864449033455e-05
Validation loss decreased (0.6060 --> 0.5863).  Saving model state dict ...
Epoch: 3 cost time: 1.1584439277648926
Epoch: 3, Steps: 245 | Train Loss: 0.8367348 Vali Loss: 0.5862760 Best vali loss: 0.5862760

best validation loss 0.5862759948880073

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0031257734473, 'e_layers': 3, 'learning_rate': 0.0001983033407, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.47879175875e-05
Validation loss decreased (0.5560 --> 0.5432).  Saving model state dict ...
Epoch: 4 cost time: 1.0262701511383057
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5431525 Best vali loss: 0.5431525
Updating learning rate to 1.239395879375e-05
Epoch: 5 cost time: 0.7456717491149902
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5455892 Best vali loss: 0.5431525
Updating learning rate to 6.196979396875e-06
Validation loss decreased (0.5432 --> 0.5392).  Saving model state dict ...
Epoch: 6 cost time: 0.7308382987976074
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5391973 Best vali loss: 0.5391973
Updating learning rate to 3.0984896984375e-06
Epoch: 7 cost time: 0.7289388179779053
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5406639 Best vali loss: 0.5391973
Updating learning rate to 1.54924484921875e-06
Epoch: 8 cost time: 0.7374866008758545
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5393828 Best vali loss: 0.5391973

best validation loss 0.5391972907187486

[INFO][smbo.py:320] Finished 1300 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0066604289859, 'e_layers': 2, 'learning_rate': 0.0001827241422, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8438775
	speed: 0.0112s/iter; left time: 9.9157s
Updating learning rate to 0.0001827241422
Validation loss decreased (inf --> 0.5961).  Saving model state dict ...
Epoch: 1 cost time: 0.9421977996826172
Epoch: 1, Steps: 123 | Train Loss: 0.8438775 Vali Loss: 0.5960803 Best vali loss: 0.5960803
	iters: 100, epoch: 2 | loss: 1.0425822
	speed: 0.0082s/iter; left time: 6.2405s
Updating learning rate to 9.13620711e-05
Validation loss decreased (0.5961 --> 0.5621).  Saving model state dict ...
Epoch: 2 cost time: 0.6451601982116699
Epoch: 2, Steps: 123 | Train Loss: 1.0425822 Vali Loss: 0.5621363 Best vali loss: 0.5621363
	iters: 100, epoch: 3 | loss: 0.5762776
	speed: 0.0083s/iter; left time: 5.2895s
Updating learning rate to 4.568103555e-05
Epoch: 3 cost time: 0.6161019802093506
Epoch: 3, Steps: 123 | Train Loss: 0.5762776 Vali Loss: 0.5666449 Best vali loss: 0.5621363
	iters: 100, epoch: 4 | loss: 1.0277214
	speed: 0.0078s/iter; left time: 4.0323s
Updating learning rate to 2.2840517775e-05
Validation loss decreased (0.5621 --> 0.5549).  Saving model state dict ...
Epoch: 4 cost time: 0.6223936080932617
Epoch: 4, Steps: 123 | Train Loss: 1.0277214 Vali Loss: 0.5549242 Best vali loss: 0.5549242
	iters: 100, epoch: 5 | loss: 0.8309679
	speed: 0.0083s/iter; left time: 3.2481s
Updating learning rate to 1.14202588875e-05
Validation loss decreased (0.5549 --> 0.5496).  Saving model state dict ...
Epoch: 5 cost time: 0.6223907470703125
Epoch: 5, Steps: 123 | Train Loss: 0.8309679 Vali Loss: 0.5496284 Best vali loss: 0.5496284
	iters: 100, epoch: 6 | loss: 0.8674396
	speed: 0.0083s/iter; left time: 2.2306s
Updating learning rate to 5.71012944375e-06
Validation loss decreased (0.5496 --> 0.5450).  Saving model state dict ...
Epoch: 6 cost time: 0.6283619403839111
Epoch: 6, Steps: 123 | Train Loss: 0.8674396 Vali Loss: 0.5449941 Best vali loss: 0.5449941
	iters: 100, epoch: 7 | loss: 0.9667091
	speed: 0.0082s/iter; left time: 1.2015s
Updating learning rate to 2.855064721875e-06
Epoch: 7 cost time: 0.626917839050293
Epoch: 7, Steps: 123 | Train Loss: 0.9667091 Vali Loss: 0.5450127 Best vali loss: 0.5449941
	iters: 100, epoch: 8 | loss: 0.7206681
	speed: 0.0081s/iter; left time: 0.1947s
Updating learning rate to 1.4275323609375e-06
Epoch: 8 cost time: 0.6444966793060303
Epoch: 8, Steps: 123 | Train Loss: 0.7206681 Vali Loss: 0.5465354 Best vali loss: 0.5449941

best validation loss 0.5449941305168686

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0058237033817, 'e_layers': 2, 'learning_rate': 0.000157977387, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8458272
	speed: 0.0113s/iter; left time: 9.9695s
Updating learning rate to 0.000157977387
Validation loss decreased (inf --> 0.5956).  Saving model state dict ...
Epoch: 1 cost time: 0.9513945579528809
Epoch: 1, Steps: 123 | Train Loss: 0.8458272 Vali Loss: 0.5955861 Best vali loss: 0.5955861
	iters: 100, epoch: 2 | loss: 1.0517178
	speed: 0.0082s/iter; left time: 6.2593s
Updating learning rate to 7.89886935e-05
Validation loss decreased (0.5956 --> 0.5719).  Saving model state dict ...
Epoch: 2 cost time: 0.6297943592071533
Epoch: 2, Steps: 123 | Train Loss: 1.0517178 Vali Loss: 0.5718769 Best vali loss: 0.5718769
	iters: 100, epoch: 3 | loss: 0.5887459
	speed: 0.0082s/iter; left time: 5.2087s
Updating learning rate to 3.949434675e-05
Epoch: 3 cost time: 0.619307279586792
Epoch: 3, Steps: 123 | Train Loss: 0.5887459 Vali Loss: 0.5801326 Best vali loss: 0.5718769
	iters: 100, epoch: 4 | loss: 1.0359880
	speed: 0.0080s/iter; left time: 4.1216s
Updating learning rate to 1.9747173375e-05
Validation loss decreased (0.5719 --> 0.5655).  Saving model state dict ...
Epoch: 4 cost time: 0.635800838470459
Epoch: 4, Steps: 123 | Train Loss: 1.0359880 Vali Loss: 0.5655054 Best vali loss: 0.5655054
	iters: 100, epoch: 5 | loss: 0.8327935
	speed: 0.0082s/iter; left time: 3.2397s
Updating learning rate to 9.8735866875e-06
Epoch: 5 cost time: 0.6397335529327393
Epoch: 5, Steps: 123 | Train Loss: 0.8327935 Vali Loss: 0.5680904 Best vali loss: 0.5655054
	iters: 100, epoch: 6 | loss: 0.8732620
	speed: 0.0081s/iter; left time: 2.1923s
Updating learning rate to 4.93679334375e-06
Validation loss decreased (0.5655 --> 0.5565).  Saving model state dict ...
Epoch: 6 cost time: 0.6479718685150146
Epoch: 6, Steps: 123 | Train Loss: 0.8732620 Vali Loss: 0.5565355 Best vali loss: 0.5565355
	iters: 100, epoch: 7 | loss: 0.9718575
	speed: 0.0082s/iter; left time: 1.1981s
Updating learning rate to 2.468396671875e-06
Epoch: 7 cost time: 0.6182610988616943
Epoch: 7, Steps: 123 | Train Loss: 0.9718575 Vali Loss: 0.5597447 Best vali loss: 0.5565355
	iters: 100, epoch: 8 | loss: 0.7210783
	speed: 0.0080s/iter; left time: 0.1930s
Updating learning rate to 1.2341983359375e-06
Epoch: 8 cost time: 0.629589319229126
Epoch: 8, Steps: 123 | Train Loss: 0.7210783 Vali Loss: 0.5609029 Best vali loss: 0.5565355

best validation loss 0.5565354692362239

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0117986537328, 'e_layers': 2, 'learning_rate': 0.0001810586212, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8443069
	speed: 0.0109s/iter; left time: 9.6864s
Updating learning rate to 0.0001810586212
Validation loss decreased (inf --> 0.5962).  Saving model state dict ...
Epoch: 1 cost time: 0.9506895542144775
Epoch: 1, Steps: 123 | Train Loss: 0.8443069 Vali Loss: 0.5961656 Best vali loss: 0.5961656
	iters: 100, epoch: 2 | loss: 1.0365133
	speed: 0.0081s/iter; left time: 6.1894s
Updating learning rate to 9.05293106e-05
Validation loss decreased (0.5962 --> 0.5826).  Saving model state dict ...
Epoch: 2 cost time: 0.6227931976318359
Epoch: 2, Steps: 123 | Train Loss: 1.0365133 Vali Loss: 0.5825748 Best vali loss: 0.5825748
	iters: 100, epoch: 3 | loss: 0.5833682
	speed: 0.0082s/iter; left time: 5.2192s
Updating learning rate to 4.52646553e-05
Validation loss decreased (0.5826 --> 0.5787).  Saving model state dict ...
Epoch: 3 cost time: 0.6421358585357666
Epoch: 3, Steps: 123 | Train Loss: 0.5833682 Vali Loss: 0.5786554 Best vali loss: 0.5786554

best validation loss 0.5786553963584405

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010811287498, 'e_layers': 3, 'learning_rate': 0.0007558367438, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5869218
	speed: 0.0107s/iter; left time: 19.9031s
	iters: 200, epoch: 1 | loss: 0.7797304
	speed: 0.0048s/iter; left time: 8.5373s
Updating learning rate to 0.0007270694206583985
Validation loss decreased (inf --> 0.6120).  Saving model state dict ...
Epoch: 1 cost time: 1.5105938911437988
Epoch: 1, Steps: 245 | Train Loss: 0.6833261 Vali Loss: 0.6120249 Best vali loss: 0.6120249
	iters: 100, epoch: 2 | loss: 0.6806911
	speed: 0.0111s/iter; left time: 18.0043s
	iters: 200, epoch: 2 | loss: 0.7456739
	speed: 0.0048s/iter; left time: 7.2111s
Updating learning rate to 0.0006451470154054695
Validation loss decreased (0.6120 --> 0.6077).  Saving model state dict ...
Epoch: 2 cost time: 1.2198076248168945
Epoch: 2, Steps: 245 | Train Loss: 0.7131825 Vali Loss: 0.6077190 Best vali loss: 0.6077190
	iters: 100, epoch: 3 | loss: 0.7392511
	speed: 0.0091s/iter; left time: 12.4802s
	iters: 200, epoch: 3 | loss: 0.7238243
	speed: 0.0043s/iter; left time: 5.5145s
Updating learning rate to 0.0005225414716125185
Epoch: 3 cost time: 1.1118278503417969
Epoch: 3, Steps: 245 | Train Loss: 0.7315377 Vali Loss: 0.6144638 Best vali loss: 0.6077190

best validation loss 0.6077189579543997

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039015133964, 'e_layers': 1, 'learning_rate': 0.0029996674031, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7464478
	speed: 0.0092s/iter; left time: 17.0901s
	iters: 200, epoch: 1 | loss: 1.3486656
	speed: 0.0030s/iter; left time: 5.3014s
Updating learning rate to 0.0028854993605826867
Validation loss decreased (inf --> 0.6329).  Saving model state dict ...
Epoch: 1 cost time: 1.0917632579803467
Epoch: 1, Steps: 245 | Train Loss: 1.0475567 Vali Loss: 0.6329161 Best vali loss: 0.6329161
	iters: 100, epoch: 2 | loss: 0.8717148
	speed: 0.0068s/iter; left time: 11.0655s
	iters: 200, epoch: 2 | loss: 0.3969004
	speed: 0.0030s/iter; left time: 4.5045s
Updating learning rate to 0.0025603762825681256
Validation loss decreased (0.6329 --> 0.6279).  Saving model state dict ...
Epoch: 2 cost time: 0.7808222770690918
Epoch: 2, Steps: 245 | Train Loss: 0.6343076 Vali Loss: 0.6278818 Best vali loss: 0.6278818
	iters: 100, epoch: 3 | loss: 1.0586587
	speed: 0.0069s/iter; left time: 9.4244s
	iters: 200, epoch: 3 | loss: 0.9186122
	speed: 0.0028s/iter; left time: 3.4963s
Updating learning rate to 0.002073795210435992
Validation loss decreased (0.6279 --> 0.6208).  Saving model state dict ...
Epoch: 3 cost time: 0.7486770153045654
Epoch: 3, Steps: 245 | Train Loss: 0.9886355 Vali Loss: 0.6207590 Best vali loss: 0.6207590

best validation loss 0.6207589948414542

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0117986537328, 'e_layers': 2, 'learning_rate': 0.0001810586212, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6912526
	speed: 0.0112s/iter; left time: 5.7941s
Updating learning rate to 2.263232765e-05
Validation loss decreased (0.5787 --> 0.5487).  Saving model state dict ...
Epoch: 4 cost time: 0.9502747058868408
Epoch: 4, Steps: 123 | Train Loss: 0.6912526 Vali Loss: 0.5486584 Best vali loss: 0.5486584
	iters: 100, epoch: 5 | loss: 0.9617208
	speed: 0.0080s/iter; left time: 3.1324s
Updating learning rate to 1.1316163825e-05
Epoch: 5 cost time: 0.6104960441589355
Epoch: 5, Steps: 123 | Train Loss: 0.9617208 Vali Loss: 0.5562407 Best vali loss: 0.5486584
	iters: 100, epoch: 6 | loss: 0.5599213
	speed: 0.0080s/iter; left time: 2.1524s
Updating learning rate to 5.6580819125e-06
Epoch: 6 cost time: 0.6260578632354736
Epoch: 6, Steps: 123 | Train Loss: 0.5599213 Vali Loss: 0.5495067 Best vali loss: 0.5486584
	iters: 100, epoch: 7 | loss: 1.0230128
	speed: 0.0079s/iter; left time: 1.1560s
Updating learning rate to 2.82904095625e-06
Epoch: 7 cost time: 0.6145694255828857
Epoch: 7, Steps: 123 | Train Loss: 1.0230128 Vali Loss: 0.5510729 Best vali loss: 0.5486584
	iters: 100, epoch: 8 | loss: 0.8268566
	speed: 0.0079s/iter; left time: 0.1888s
Updating learning rate to 1.414520478125e-06
Epoch: 8 cost time: 0.6103324890136719
Epoch: 8, Steps: 123 | Train Loss: 0.8268566 Vali Loss: 0.5519313 Best vali loss: 0.5486584

best validation loss 0.5486584244531263

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488615496, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744619
	speed: 0.0114s/iter; left time: 10.1255s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0122153759002686
Epoch: 1, Steps: 123 | Train Loss: 0.7744619 Vali Loss: 0.6173000 Best vali loss: 0.6173000
	iters: 100, epoch: 2 | loss: 0.9486355
	speed: 0.0091s/iter; left time: 6.9628s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6173 --> 0.5708).  Saving model state dict ...
Epoch: 2 cost time: 0.7236459255218506
Epoch: 2, Steps: 123 | Train Loss: 0.9486355 Vali Loss: 0.5708126 Best vali loss: 0.5708126
	iters: 100, epoch: 3 | loss: 0.8464749
	speed: 0.0095s/iter; left time: 6.0453s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5708 --> 0.5479).  Saving model state dict ...
Epoch: 3 cost time: 0.7281737327575684
Epoch: 3, Steps: 123 | Train Loss: 0.8464749 Vali Loss: 0.5478885 Best vali loss: 0.5478885
	iters: 100, epoch: 4 | loss: 0.4891837
	speed: 0.0094s/iter; left time: 4.8558s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5479 --> 0.5381).  Saving model state dict ...
Epoch: 4 cost time: 0.7294604778289795
Epoch: 4, Steps: 123 | Train Loss: 0.4891837 Vali Loss: 0.5380577 Best vali loss: 0.5380577
	iters: 100, epoch: 5 | loss: 0.5555906
	speed: 0.0094s/iter; left time: 3.6772s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5381 --> 0.5215).  Saving model state dict ...
Epoch: 5 cost time: 0.7214527130126953
Epoch: 5, Steps: 123 | Train Loss: 0.5555906 Vali Loss: 0.5215249 Best vali loss: 0.5215249
	iters: 100, epoch: 6 | loss: 0.5862713
	speed: 0.0093s/iter; left time: 2.5117s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.7320520877838135
Epoch: 6, Steps: 123 | Train Loss: 0.5862713 Vali Loss: 0.5384878 Best vali loss: 0.5215249
	iters: 100, epoch: 7 | loss: 0.5412305
	speed: 0.0090s/iter; left time: 1.3259s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.7185378074645996
Epoch: 7, Steps: 123 | Train Loss: 0.5412305 Vali Loss: 0.5423332 Best vali loss: 0.5215249
	iters: 100, epoch: 8 | loss: 0.6952995
	speed: 0.0089s/iter; left time: 0.2141s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.723078727722168
Epoch: 8, Steps: 123 | Train Loss: 0.6952995 Vali Loss: 0.5490463 Best vali loss: 0.5215249

best validation loss 0.5215249111232025

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0081316356379, 'e_layers': 2, 'learning_rate': 0.0035946379892, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0786313
	speed: 0.0097s/iter; left time: 37.0512s
	iters: 200, epoch: 1 | loss: 1.1050653
	speed: 0.0035s/iter; left time: 12.9214s
	iters: 300, epoch: 1 | loss: 0.8725402
	speed: 0.0035s/iter; left time: 12.5064s
	iters: 400, epoch: 1 | loss: 1.0166917
	speed: 0.0035s/iter; left time: 12.4293s
Updating learning rate to 0.003457825227104704
Validation loss decreased (inf --> 0.6203).  Saving model state dict ...
Epoch: 1 cost time: 2.0604043006896973
Epoch: 1, Steps: 490 | Train Loss: 1.0182321 Vali Loss: 0.6202683 Best vali loss: 0.6202683
	iters: 100, epoch: 2 | loss: 0.9976138
	speed: 0.0100s/iter; left time: 33.2328s
	iters: 200, epoch: 2 | loss: 1.2912600
	speed: 0.0032s/iter; left time: 10.2129s
	iters: 300, epoch: 2 | loss: 1.0146425
	speed: 0.0032s/iter; left time: 9.9675s
	iters: 400, epoch: 2 | loss: 0.4645684
	speed: 0.0031s/iter; left time: 9.3085s
Updating learning rate to 0.0030682154436370477
Epoch: 2 cost time: 1.630079984664917
Epoch: 2, Steps: 490 | Train Loss: 0.9420212 Vali Loss: 0.6382937 Best vali loss: 0.6202683
	iters: 100, epoch: 3 | loss: 0.7572429
	speed: 0.0094s/iter; left time: 26.7536s
	iters: 200, epoch: 3 | loss: 0.8290472
	speed: 0.0033s/iter; left time: 8.9405s
	iters: 300, epoch: 3 | loss: 0.4723324
	speed: 0.0032s/iter; left time: 8.4245s
	iters: 400, epoch: 3 | loss: 1.3013296
	speed: 0.0031s/iter; left time: 7.9803s
Updating learning rate to 0.0024851231965085006
Epoch: 3 cost time: 1.6172866821289062
Epoch: 3, Steps: 490 | Train Loss: 0.8399880 Vali Loss: 0.6354317 Best vali loss: 0.6202683
	iters: 100, epoch: 4 | loss: 1.1406811
	speed: 0.0093s/iter; left time: 21.7841s
	iters: 200, epoch: 4 | loss: 0.9314652
	speed: 0.0033s/iter; left time: 7.3191s
	iters: 300, epoch: 4 | loss: 0.9412078
	speed: 0.0031s/iter; left time: 6.6165s
	iters: 400, epoch: 4 | loss: 0.5414171
	speed: 0.0031s/iter; left time: 6.4312s
Updating learning rate to 0.0017973189946
Epoch: 4 cost time: 1.5992743968963623
Epoch: 4, Steps: 490 | Train Loss: 0.8886928 Vali Loss: 0.6332928 Best vali loss: 0.6202683
	iters: 100, epoch: 5 | loss: 1.2163121
	speed: 0.0094s/iter; left time: 17.5014s
	iters: 200, epoch: 5 | loss: 0.3948392
	speed: 0.0032s/iter; left time: 5.6379s
	iters: 300, epoch: 5 | loss: 0.6545131
	speed: 0.0032s/iter; left time: 5.2994s
	iters: 400, epoch: 5 | loss: 0.6511251
	speed: 0.0033s/iter; left time: 5.1126s
Updating learning rate to 0.0011095147926915
Epoch: 5 cost time: 1.6326699256896973
Epoch: 5, Steps: 490 | Train Loss: 0.7291974 Vali Loss: 0.6225924 Best vali loss: 0.6202683
	iters: 100, epoch: 6 | loss: 1.1901803
	speed: 0.0093s/iter; left time: 12.7149s
	iters: 200, epoch: 6 | loss: 0.7539799
	speed: 0.0033s/iter; left time: 4.2554s
	iters: 300, epoch: 6 | loss: 0.7289174
	speed: 0.0033s/iter; left time: 3.9122s
	iters: 400, epoch: 6 | loss: 0.9874105
	speed: 0.0034s/iter; left time: 3.5879s
Updating learning rate to 0.0005264225455629524
Validation loss decreased (0.6203 --> 0.6192).  Saving model state dict ...
Epoch: 6 cost time: 1.6574318408966064
Epoch: 6, Steps: 490 | Train Loss: 0.9151220 Vali Loss: 0.6192257 Best vali loss: 0.6192257
	iters: 100, epoch: 7 | loss: 1.2148529
	speed: 0.0097s/iter; left time: 8.5760s
	iters: 200, epoch: 7 | loss: 0.4735467
	speed: 0.0036s/iter; left time: 2.8331s
	iters: 300, epoch: 7 | loss: 0.6627776
	speed: 0.0036s/iter; left time: 2.4484s
	iters: 400, epoch: 7 | loss: 1.1227978
	speed: 0.0036s/iter; left time: 2.1067s
Updating learning rate to 0.00013681276209529612
Epoch: 7 cost time: 1.8336424827575684
Epoch: 7, Steps: 490 | Train Loss: 0.8684938 Vali Loss: 0.6199287 Best vali loss: 0.6192257
	iters: 100, epoch: 8 | loss: 1.0461158
	speed: 0.0099s/iter; left time: 3.8891s
	iters: 200, epoch: 8 | loss: 1.2359229
	speed: 0.0033s/iter; left time: 0.9514s
	iters: 300, epoch: 8 | loss: 0.7981688
	speed: 0.0032s/iter; left time: 0.6058s
	iters: 400, epoch: 8 | loss: 0.7925745
	speed: 0.0032s/iter; left time: 0.2907s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6232764720916748
Epoch: 8, Steps: 490 | Train Loss: 0.9681955 Vali Loss: 0.6223636 Best vali loss: 0.6192257

best validation loss 0.619225671932908

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0062135716636, 'e_layers': 3, 'learning_rate': 0.0028842582947, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.6566274
	speed: 0.0106s/iter; left time: 40.3266s
	iters: 200, epoch: 1 | loss: 0.6451326
	speed: 0.0045s/iter; left time: 16.6727s
	iters: 300, epoch: 1 | loss: 0.7802980
	speed: 0.0046s/iter; left time: 16.8325s
	iters: 400, epoch: 1 | loss: 0.4234580
	speed: 0.0046s/iter; left time: 16.3236s
Updating learning rate to 0.0028842582947
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 2.5804591178894043
Epoch: 1, Steps: 490 | Train Loss: 0.8763790 Vali Loss: 0.6207569 Best vali loss: 0.6207569
	iters: 100, epoch: 2 | loss: 0.8213723
	speed: 0.0121s/iter; left time: 40.2034s
	iters: 200, epoch: 2 | loss: 1.1762757
	speed: 0.0041s/iter; left time: 13.1923s
	iters: 300, epoch: 2 | loss: 0.6041021
	speed: 0.0043s/iter; left time: 13.3444s
	iters: 400, epoch: 2 | loss: 0.8808527
	speed: 0.0040s/iter; left time: 12.2166s
Updating learning rate to 0.00144212914735
Epoch: 2 cost time: 2.0793275833129883
Epoch: 2, Steps: 490 | Train Loss: 0.8706507 Vali Loss: 0.6511697 Best vali loss: 0.6207569
	iters: 100, epoch: 3 | loss: 0.9352196
	speed: 0.0114s/iter; left time: 32.3929s
	iters: 200, epoch: 3 | loss: 0.3916647
	speed: 0.0040s/iter; left time: 11.0934s
	iters: 300, epoch: 3 | loss: 0.9184050
	speed: 0.0041s/iter; left time: 10.7115s
	iters: 400, epoch: 3 | loss: 1.2915374
	speed: 0.0041s/iter; left time: 10.5050s
Updating learning rate to 0.000721064573675
Epoch: 3 cost time: 2.0316362380981445
Epoch: 3, Steps: 490 | Train Loss: 0.8842067 Vali Loss: 0.6363592 Best vali loss: 0.6207569

best validation loss 0.6207569485693163

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012788173726, 'e_layers': 3, 'learning_rate': 9.48198253e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6885115
	speed: 0.0131s/iter; left time: 11.6307s
Updating learning rate to 9.48198253e-05
Validation loss decreased (inf --> 0.6148).  Saving model state dict ...
Epoch: 1 cost time: 1.2162978649139404
Epoch: 1, Steps: 123 | Train Loss: 0.6885115 Vali Loss: 0.6147911 Best vali loss: 0.6147911
	iters: 100, epoch: 2 | loss: 1.1707581
	speed: 0.0113s/iter; left time: 8.6406s
Updating learning rate to 4.740991265e-05
Validation loss decreased (0.6148 --> 0.5953).  Saving model state dict ...
Epoch: 2 cost time: 0.9199738502502441
Epoch: 2, Steps: 123 | Train Loss: 1.1707581 Vali Loss: 0.5952662 Best vali loss: 0.5952662
	iters: 100, epoch: 3 | loss: 0.6175181
	speed: 0.0115s/iter; left time: 7.3731s
Updating learning rate to 2.3704956325e-05
Validation loss decreased (0.5953 --> 0.5481).  Saving model state dict ...
Epoch: 3 cost time: 0.907630205154419
Epoch: 3, Steps: 123 | Train Loss: 0.6175181 Vali Loss: 0.5481496 Best vali loss: 0.5481496

best validation loss 0.5481495962601909

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020361225159, 'e_layers': 1, 'learning_rate': 0.003278668711, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8730126
	speed: 0.0099s/iter; left time: 8.7496s
Updating learning rate to 0.0031538818134890317
Validation loss decreased (inf --> 0.6722).  Saving model state dict ...
Epoch: 1 cost time: 0.811072826385498
Epoch: 1, Steps: 123 | Train Loss: 0.8730126 Vali Loss: 0.6722095 Best vali loss: 0.6722095
	iters: 100, epoch: 2 | loss: 1.5203747
	speed: 0.0066s/iter; left time: 5.0127s
Updating learning rate to 0.002798518794906128
Validation loss decreased (0.6722 --> 0.6058).  Saving model state dict ...
Epoch: 2 cost time: 0.5019733905792236
Epoch: 2, Steps: 123 | Train Loss: 1.5203747 Vali Loss: 0.6057651 Best vali loss: 0.6057651
	iters: 100, epoch: 3 | loss: 1.0894394
	speed: 0.0069s/iter; left time: 4.3776s
Updating learning rate to 0.0022666804534567523
Epoch: 3 cost time: 0.5063543319702148
Epoch: 3, Steps: 123 | Train Loss: 1.0894394 Vali Loss: 0.6514806 Best vali loss: 0.6057651

best validation loss 0.6057651141957517

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012788173726, 'e_layers': 3, 'learning_rate': 9.48198253e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5889962
	speed: 0.0145s/iter; left time: 7.4944s
Updating learning rate to 1.18524781625e-05
Validation loss decreased (0.5481 --> 0.5450).  Saving model state dict ...
Epoch: 4 cost time: 1.2357244491577148
Epoch: 4, Steps: 123 | Train Loss: 0.5889962 Vali Loss: 0.5449950 Best vali loss: 0.5449950
	iters: 100, epoch: 5 | loss: 1.0669068
	speed: 0.0116s/iter; left time: 4.5604s
Updating learning rate to 5.92623908125e-06
Epoch: 5 cost time: 0.9161274433135986
Epoch: 5, Steps: 123 | Train Loss: 1.0669068 Vali Loss: 0.5452751 Best vali loss: 0.5449950
	iters: 100, epoch: 6 | loss: 0.5893663
	speed: 0.0112s/iter; left time: 3.0221s
Updating learning rate to 2.963119540625e-06
Validation loss decreased (0.5450 --> 0.5412).  Saving model state dict ...
Epoch: 6 cost time: 0.9221410751342773
Epoch: 6, Steps: 123 | Train Loss: 0.5893663 Vali Loss: 0.5411546 Best vali loss: 0.5411546
	iters: 100, epoch: 7 | loss: 0.8073730
	speed: 0.0114s/iter; left time: 1.6793s
Updating learning rate to 1.4815597703125e-06
Epoch: 7 cost time: 0.915290355682373
Epoch: 7, Steps: 123 | Train Loss: 0.8073730 Vali Loss: 0.5424623 Best vali loss: 0.5411546
	iters: 100, epoch: 8 | loss: 0.5190789
	speed: 0.0111s/iter; left time: 0.2667s
Updating learning rate to 7.4077988515625e-07
Epoch: 8 cost time: 0.9143202304840088
Epoch: 8, Steps: 123 | Train Loss: 0.5190789 Vali Loss: 0.5432513 Best vali loss: 0.5411546

best validation loss 0.5411545826929799

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044968734613, 'e_layers': 3, 'learning_rate': 0.0005263926113, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8354629
	speed: 0.0133s/iter; left time: 11.7970s
Updating learning rate to 0.0005263926113
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 1.2286889553070068
Epoch: 1, Steps: 123 | Train Loss: 0.8354629 Vali Loss: 0.6167426 Best vali loss: 0.6167426
	iters: 100, epoch: 2 | loss: 1.0527648
	speed: 0.0114s/iter; left time: 8.6863s
Updating learning rate to 0.00026319630565
Epoch: 2 cost time: 0.9156358242034912
Epoch: 2, Steps: 123 | Train Loss: 1.0527648 Vali Loss: 0.6168917 Best vali loss: 0.6167426
	iters: 100, epoch: 3 | loss: 0.6911877
	speed: 0.0111s/iter; left time: 7.0613s
Updating learning rate to 0.000131598152825
Validation loss decreased (0.6167 --> 0.6038).  Saving model state dict ...
Epoch: 3 cost time: 0.9122438430786133
Epoch: 3, Steps: 123 | Train Loss: 0.6911877 Vali Loss: 0.6037515 Best vali loss: 0.6037515
	iters: 100, epoch: 4 | loss: 0.7817781
	speed: 0.0116s/iter; left time: 5.9884s
Updating learning rate to 6.57990764125e-05
Validation loss decreased (0.6038 --> 0.5714).  Saving model state dict ...
Epoch: 4 cost time: 0.9288737773895264
Epoch: 4, Steps: 123 | Train Loss: 0.7817781 Vali Loss: 0.5714197 Best vali loss: 0.5714197
	iters: 100, epoch: 5 | loss: 0.6971766
	speed: 0.0115s/iter; left time: 4.5087s
Updating learning rate to 3.289953820625e-05
Validation loss decreased (0.5714 --> 0.5621).  Saving model state dict ...
Epoch: 5 cost time: 0.9187541007995605
Epoch: 5, Steps: 123 | Train Loss: 0.6971766 Vali Loss: 0.5620647 Best vali loss: 0.5620647
	iters: 100, epoch: 6 | loss: 0.7522048
	speed: 0.0115s/iter; left time: 3.0974s
Updating learning rate to 1.6449769103125e-05
Epoch: 6 cost time: 0.920635461807251
Epoch: 6, Steps: 123 | Train Loss: 0.7522048 Vali Loss: 0.5637190 Best vali loss: 0.5620647
	iters: 100, epoch: 7 | loss: 0.7931234
	speed: 0.0113s/iter; left time: 1.6597s
Updating learning rate to 8.2248845515625e-06
Epoch: 7 cost time: 0.9303843975067139
Epoch: 7, Steps: 123 | Train Loss: 0.7931234 Vali Loss: 0.5629448 Best vali loss: 0.5620647
	iters: 100, epoch: 8 | loss: 0.8922830
	speed: 0.0113s/iter; left time: 0.2722s
Updating learning rate to 4.11244227578125e-06
Validation loss decreased (0.5621 --> 0.5603).  Saving model state dict ...
Epoch: 8 cost time: 0.9256038665771484
Epoch: 8, Steps: 123 | Train Loss: 0.8922830 Vali Loss: 0.5603459 Best vali loss: 0.5603459

best validation loss 0.5603458706232642

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017469584343, 'e_layers': 2, 'learning_rate': 0.0007581011479, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000729247641009061
Validation loss decreased (inf --> 0.6101).  Saving model state dict ...
Epoch: 1 cost time: 0.7038788795471191
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6100590 Best vali loss: 0.6100590
Updating learning rate to 0.0006470798052026979
Validation loss decreased (0.6101 --> 0.6048).  Saving model state dict ...
Epoch: 2 cost time: 0.41854166984558105
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6048487 Best vali loss: 0.6048487
Updating learning rate to 0.0005241069486291433
Epoch: 3 cost time: 0.43054938316345215
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6135605 Best vali loss: 0.6048487
Updating learning rate to 0.00037905057395
Validation loss decreased (0.6048 --> 0.5814).  Saving model state dict ...
Epoch: 4 cost time: 0.4489576816558838
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5813578 Best vali loss: 0.5813578
Updating learning rate to 0.00023399419927085674
Validation loss decreased (0.5814 --> 0.5768).  Saving model state dict ...
Epoch: 5 cost time: 0.4334444999694824
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5768375 Best vali loss: 0.5768375
Updating learning rate to 0.00011102134269730213
Validation loss decreased (0.5768 --> 0.5696).  Saving model state dict ...
Epoch: 6 cost time: 0.43015217781066895
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5695926 Best vali loss: 0.5695926
Updating learning rate to 2.8853506890939077e-05
Epoch: 7 cost time: 0.4223473072052002
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5703526 Best vali loss: 0.5695926
Updating learning rate to 0.0
Epoch: 8 cost time: 0.42597389221191406
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5703966 Best vali loss: 0.5695926

best validation loss 0.569592571986709

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020572228996, 'e_layers': 4, 'learning_rate': 0.0014478768412, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7875398
	speed: 0.0115s/iter; left time: 44.1102s
	iters: 200, epoch: 1 | loss: 1.1744740
	speed: 0.0052s/iter; left time: 19.2577s
	iters: 300, epoch: 1 | loss: 0.9315757
	speed: 0.0047s/iter; left time: 16.9819s
	iters: 400, epoch: 1 | loss: 1.2507358
	speed: 0.0050s/iter; left time: 17.6108s
Updating learning rate to 0.0014478768412
Validation loss decreased (inf --> 0.6360).  Saving model state dict ...
Epoch: 1 cost time: 2.8019843101501465
Epoch: 1, Steps: 490 | Train Loss: 1.0360813 Vali Loss: 0.6359676 Best vali loss: 0.6359676
	iters: 100, epoch: 2 | loss: 1.2293831
	speed: 0.0137s/iter; left time: 45.5094s
	iters: 200, epoch: 2 | loss: 0.4879838
	speed: 0.0053s/iter; left time: 17.1098s
	iters: 300, epoch: 2 | loss: 0.5126917
	speed: 0.0053s/iter; left time: 16.7111s
	iters: 400, epoch: 2 | loss: 1.4458488
	speed: 0.0052s/iter; left time: 15.6186s
Updating learning rate to 0.0007239384206
Epoch: 2 cost time: 2.6197774410247803
Epoch: 2, Steps: 490 | Train Loss: 0.9189769 Vali Loss: 0.6472680 Best vali loss: 0.6359676
	iters: 100, epoch: 3 | loss: 0.7776611
	speed: 0.0136s/iter; left time: 38.5150s
	iters: 200, epoch: 3 | loss: 1.1359137
	speed: 0.0052s/iter; left time: 14.1577s
	iters: 300, epoch: 3 | loss: 0.7957286
	speed: 0.0052s/iter; left time: 13.6070s
	iters: 400, epoch: 3 | loss: 0.9370406
	speed: 0.0051s/iter; left time: 12.9862s
Updating learning rate to 0.0003619692103
Epoch: 3 cost time: 2.561241388320923
Epoch: 3, Steps: 490 | Train Loss: 0.9115860 Vali Loss: 0.6506371 Best vali loss: 0.6359676

best validation loss 0.6359676365110952

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015970669363, 'e_layers': 3, 'learning_rate': 0.0001540833701, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0769358
	speed: 0.0110s/iter; left time: 41.8673s
	iters: 200, epoch: 1 | loss: 0.6697382
	speed: 0.0045s/iter; left time: 16.8430s
	iters: 300, epoch: 1 | loss: 1.7022786
	speed: 0.0043s/iter; left time: 15.5664s
	iters: 400, epoch: 1 | loss: 0.5278322
	speed: 0.0041s/iter; left time: 14.6091s
Updating learning rate to 0.0001540833701
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 2.4853289127349854
Epoch: 1, Steps: 490 | Train Loss: 0.9941962 Vali Loss: 0.6156681 Best vali loss: 0.6156681
	iters: 100, epoch: 2 | loss: 0.7897946
	speed: 0.0121s/iter; left time: 40.3378s
	iters: 200, epoch: 2 | loss: 0.5619260
	speed: 0.0044s/iter; left time: 14.0749s
	iters: 300, epoch: 2 | loss: 1.0726708
	speed: 0.0044s/iter; left time: 13.9292s
	iters: 400, epoch: 2 | loss: 1.3473499
	speed: 0.0047s/iter; left time: 14.1277s
Updating learning rate to 7.704168505e-05
Epoch: 2 cost time: 2.2412285804748535
Epoch: 2, Steps: 490 | Train Loss: 0.9429353 Vali Loss: 0.6790299 Best vali loss: 0.6156681
	iters: 100, epoch: 3 | loss: 0.7417617
	speed: 0.0122s/iter; left time: 34.6908s
	iters: 200, epoch: 3 | loss: 0.4199908
	speed: 0.0045s/iter; left time: 12.2229s
	iters: 300, epoch: 3 | loss: 0.6773926
	speed: 0.0044s/iter; left time: 11.7217s
	iters: 400, epoch: 3 | loss: 0.5415255
	speed: 0.0045s/iter; left time: 11.3718s
Updating learning rate to 3.8520842525e-05
Validation loss decreased (0.6157 --> 0.5486).  Saving model state dict ...
Epoch: 3 cost time: 2.2496087551116943
Epoch: 3, Steps: 490 | Train Loss: 0.5951677 Vali Loss: 0.5485691 Best vali loss: 0.5485691

best validation loss 0.5485691248625861

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016428105911, 'e_layers': 3, 'learning_rate': 0.0001592644919, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0769507
	speed: 0.0110s/iter; left time: 42.0323s
	iters: 200, epoch: 1 | loss: 0.6718041
	speed: 0.0047s/iter; left time: 17.4958s
	iters: 300, epoch: 1 | loss: 1.7013010
	speed: 0.0047s/iter; left time: 17.1654s
	iters: 400, epoch: 1 | loss: 0.5335923
	speed: 0.0046s/iter; left time: 16.2834s
Updating learning rate to 0.0001592644919
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 2.6483888626098633
Epoch: 1, Steps: 490 | Train Loss: 0.9959120 Vali Loss: 0.6157159 Best vali loss: 0.6157159
	iters: 100, epoch: 2 | loss: 0.7846759
	speed: 0.0128s/iter; left time: 42.5859s
	iters: 200, epoch: 2 | loss: 0.5576042
	speed: 0.0041s/iter; left time: 13.3870s
	iters: 300, epoch: 2 | loss: 1.0759171
	speed: 0.0042s/iter; left time: 13.1645s
	iters: 400, epoch: 2 | loss: 1.3969537
	speed: 0.0042s/iter; left time: 12.8718s
Updating learning rate to 7.963224595e-05
Validation loss decreased (0.6157 --> 0.5974).  Saving model state dict ...
Epoch: 2 cost time: 2.157341957092285
Epoch: 2, Steps: 490 | Train Loss: 0.9537877 Vali Loss: 0.5973743 Best vali loss: 0.5973743
	iters: 100, epoch: 3 | loss: 0.7394974
	speed: 0.0119s/iter; left time: 33.8860s
	iters: 200, epoch: 3 | loss: 0.4011923
	speed: 0.0041s/iter; left time: 11.2588s
	iters: 300, epoch: 3 | loss: 0.6900114
	speed: 0.0046s/iter; left time: 12.0334s
	iters: 400, epoch: 3 | loss: 0.5363640
	speed: 0.0045s/iter; left time: 11.4691s
Updating learning rate to 3.9816122975e-05
Validation loss decreased (0.5974 --> 0.5384).  Saving model state dict ...
Epoch: 3 cost time: 2.1859328746795654
Epoch: 3, Steps: 490 | Train Loss: 0.5917663 Vali Loss: 0.5384245 Best vali loss: 0.5384245

best validation loss 0.5384244543984222

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016428105911, 'e_layers': 3, 'learning_rate': 0.0001592644919, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9213443
	speed: 0.0114s/iter; left time: 26.8076s
	iters: 200, epoch: 4 | loss: 0.3772009
	speed: 0.0048s/iter; left time: 10.7221s
	iters: 300, epoch: 4 | loss: 1.5413539
	speed: 0.0045s/iter; left time: 9.5764s
	iters: 400, epoch: 4 | loss: 0.3546404
	speed: 0.0041s/iter; left time: 8.3187s
Updating learning rate to 1.99080614875e-05
Validation loss decreased (0.5384 --> 0.5324).  Saving model state dict ...
Epoch: 4 cost time: 2.5166454315185547
Epoch: 4, Steps: 490 | Train Loss: 0.7986349 Vali Loss: 0.5323960 Best vali loss: 0.5323960
	iters: 100, epoch: 5 | loss: 0.7043824
	speed: 0.0123s/iter; left time: 22.8138s
	iters: 200, epoch: 5 | loss: 0.4864658
	speed: 0.0043s/iter; left time: 7.6026s
	iters: 300, epoch: 5 | loss: 0.8598808
	speed: 0.0043s/iter; left time: 7.0673s
	iters: 400, epoch: 5 | loss: 1.0826309
	speed: 0.0043s/iter; left time: 6.6471s
Updating learning rate to 9.95403074375e-06
Validation loss decreased (0.5324 --> 0.5291).  Saving model state dict ...
Epoch: 5 cost time: 2.162663459777832
Epoch: 5, Steps: 490 | Train Loss: 0.7833400 Vali Loss: 0.5290835 Best vali loss: 0.5290835
	iters: 100, epoch: 6 | loss: 0.6682630
	speed: 0.0122s/iter; left time: 16.7944s
	iters: 200, epoch: 6 | loss: 0.3583423
	speed: 0.0041s/iter; left time: 5.1784s
	iters: 300, epoch: 6 | loss: 0.5905539
	speed: 0.0042s/iter; left time: 4.9412s
	iters: 400, epoch: 6 | loss: 0.5167194
	speed: 0.0042s/iter; left time: 4.4823s
Updating learning rate to 4.977015371875e-06
Epoch: 6 cost time: 2.124628782272339
Epoch: 6, Steps: 490 | Train Loss: 0.5334696 Vali Loss: 0.5322320 Best vali loss: 0.5290835
	iters: 100, epoch: 7 | loss: 0.7040867
	speed: 0.0123s/iter; left time: 10.8551s
	iters: 200, epoch: 7 | loss: 0.5367235
	speed: 0.0044s/iter; left time: 3.4340s
	iters: 300, epoch: 7 | loss: 0.8097091
	speed: 0.0044s/iter; left time: 3.0000s
	iters: 400, epoch: 7 | loss: 0.7755755
	speed: 0.0046s/iter; left time: 2.6626s
Updating learning rate to 2.4885076859375e-06
Epoch: 7 cost time: 2.257077693939209
Epoch: 7, Steps: 490 | Train Loss: 0.7065237 Vali Loss: 0.5299916 Best vali loss: 0.5290835
	iters: 100, epoch: 8 | loss: 0.8184108
	speed: 0.0123s/iter; left time: 4.8016s
	iters: 200, epoch: 8 | loss: 0.3658081
	speed: 0.0046s/iter; left time: 1.3467s
	iters: 300, epoch: 8 | loss: 0.9944828
	speed: 0.0046s/iter; left time: 0.8870s
	iters: 400, epoch: 8 | loss: 0.5833057
	speed: 0.0046s/iter; left time: 0.4218s
Updating learning rate to 1.24425384296875e-06
Epoch: 8 cost time: 2.306241750717163
Epoch: 8, Steps: 490 | Train Loss: 0.6905018 Vali Loss: 0.5313501 Best vali loss: 0.5290835

best validation loss 0.5290834648376921

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001631036989, 'e_layers': 3, 'learning_rate': 0.0001577379211, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0770035
	speed: 0.0109s/iter; left time: 41.8059s
	iters: 200, epoch: 1 | loss: 0.6699723
	speed: 0.0045s/iter; left time: 16.6771s
	iters: 300, epoch: 1 | loss: 1.7013729
	speed: 0.0045s/iter; left time: 16.2964s
	iters: 400, epoch: 1 | loss: 0.5330431
	speed: 0.0043s/iter; left time: 15.1674s
Updating learning rate to 0.0001577379211
Validation loss decreased (inf --> 0.6157).  Saving model state dict ...
Epoch: 1 cost time: 2.5503275394439697
Epoch: 1, Steps: 490 | Train Loss: 0.9953479 Vali Loss: 0.6157348 Best vali loss: 0.6157348
	iters: 100, epoch: 2 | loss: 0.7862515
	speed: 0.0122s/iter; left time: 40.6736s
	iters: 200, epoch: 2 | loss: 0.5663180
	speed: 0.0044s/iter; left time: 14.1250s
	iters: 300, epoch: 2 | loss: 1.0715948
	speed: 0.0044s/iter; left time: 13.7109s
	iters: 400, epoch: 2 | loss: 1.3058357
	speed: 0.0044s/iter; left time: 13.2986s
Updating learning rate to 7.886896055e-05
Validation loss decreased (0.6157 --> 0.5744).  Saving model state dict ...
Epoch: 2 cost time: 2.1859254837036133
Epoch: 2, Steps: 490 | Train Loss: 0.9325000 Vali Loss: 0.5744152 Best vali loss: 0.5744152
	iters: 100, epoch: 3 | loss: 0.7331535
	speed: 0.0129s/iter; left time: 36.7133s
	iters: 200, epoch: 3 | loss: 0.4088787
	speed: 0.0046s/iter; left time: 12.6201s
	iters: 300, epoch: 3 | loss: 0.6666518
	speed: 0.0046s/iter; left time: 12.1387s
	iters: 400, epoch: 3 | loss: 0.5342962
	speed: 0.0046s/iter; left time: 11.7603s
Updating learning rate to 3.9434480275e-05
Validation loss decreased (0.5744 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 2.294471502304077
Epoch: 3, Steps: 490 | Train Loss: 0.5857451 Vali Loss: 0.5464277 Best vali loss: 0.5464277
	iters: 100, epoch: 4 | loss: 0.7380383
	speed: 0.0125s/iter; left time: 29.3556s
	iters: 200, epoch: 4 | loss: 0.5665891
	speed: 0.0044s/iter; left time: 9.9556s
	iters: 300, epoch: 4 | loss: 0.8219824
	speed: 0.0045s/iter; left time: 9.7774s
	iters: 400, epoch: 4 | loss: 0.7948817
	speed: 0.0044s/iter; left time: 9.1128s
Updating learning rate to 1.97172401375e-05
Validation loss decreased (0.5464 --> 0.5379).  Saving model state dict ...
Epoch: 4 cost time: 2.2266368865966797
Epoch: 4, Steps: 490 | Train Loss: 0.7303729 Vali Loss: 0.5378598 Best vali loss: 0.5378598
	iters: 100, epoch: 5 | loss: 0.8428709
	speed: 0.0125s/iter; left time: 23.2758s
	iters: 200, epoch: 5 | loss: 0.3853064
	speed: 0.0045s/iter; left time: 8.0081s
	iters: 300, epoch: 5 | loss: 1.0014336
	speed: 0.0045s/iter; left time: 7.4617s
	iters: 400, epoch: 5 | loss: 0.5870745
	speed: 0.0045s/iter; left time: 7.0929s
Updating learning rate to 9.85862006875e-06
Validation loss decreased (0.5379 --> 0.5289).  Saving model state dict ...
Epoch: 5 cost time: 2.2573344707489014
Epoch: 5, Steps: 490 | Train Loss: 0.7041713 Vali Loss: 0.5289244 Best vali loss: 0.5289244
	iters: 100, epoch: 6 | loss: 0.5852754
	speed: 0.0124s/iter; left time: 16.9596s
	iters: 200, epoch: 6 | loss: 0.9270755
	speed: 0.0045s/iter; left time: 5.7373s
	iters: 300, epoch: 6 | loss: 0.4592189
	speed: 0.0046s/iter; left time: 5.4333s
	iters: 400, epoch: 6 | loss: 0.8842334
	speed: 0.0047s/iter; left time: 5.0481s
Updating learning rate to 4.929310034375e-06
Epoch: 6 cost time: 2.3003604412078857
Epoch: 6, Steps: 490 | Train Loss: 0.7139508 Vali Loss: 0.5309102 Best vali loss: 0.5289244
	iters: 100, epoch: 7 | loss: 0.5084688
	speed: 0.0124s/iter; left time: 10.9388s
	iters: 200, epoch: 7 | loss: 0.5592715
	speed: 0.0042s/iter; left time: 3.2557s
	iters: 300, epoch: 7 | loss: 0.5740820
	speed: 0.0044s/iter; left time: 3.0236s
	iters: 400, epoch: 7 | loss: 0.4436532
	speed: 0.0046s/iter; left time: 2.6453s
Updating learning rate to 2.4646550171875e-06
Epoch: 7 cost time: 2.222815990447998
Epoch: 7, Steps: 490 | Train Loss: 0.5213689 Vali Loss: 0.5329002 Best vali loss: 0.5289244
	iters: 100, epoch: 8 | loss: 0.3859338
	speed: 0.0123s/iter; left time: 4.8061s
	iters: 200, epoch: 8 | loss: 0.5829675
	speed: 0.0046s/iter; left time: 1.3360s
	iters: 300, epoch: 8 | loss: 0.4942673
	speed: 0.0045s/iter; left time: 0.8668s
	iters: 400, epoch: 8 | loss: 0.8305625
	speed: 0.0045s/iter; left time: 0.4099s
Updating learning rate to 1.23232750859375e-06
Epoch: 8 cost time: 2.270514965057373
Epoch: 8, Steps: 490 | Train Loss: 0.5734328 Vali Loss: 0.5331615 Best vali loss: 0.5289244

best validation loss 0.5289244152078029

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016996210419, 'e_layers': 3, 'learning_rate': 0.0001618307724, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5324903
	speed: 0.0107s/iter; left time: 40.9374s
	iters: 200, epoch: 1 | loss: 0.7396234
	speed: 0.0046s/iter; left time: 17.0465s
	iters: 300, epoch: 1 | loss: 0.8308532
	speed: 0.0046s/iter; left time: 16.6788s
	iters: 400, epoch: 1 | loss: 0.6631025
	speed: 0.0046s/iter; left time: 16.3053s
Updating learning rate to 0.00015567145537542624
Validation loss decreased (inf --> 0.6066).  Saving model state dict ...
Epoch: 1 cost time: 2.6077189445495605
Epoch: 1, Steps: 490 | Train Loss: 0.6915173 Vali Loss: 0.6065789 Best vali loss: 0.6065789
	iters: 100, epoch: 2 | loss: 0.8384033
	speed: 0.0131s/iter; left time: 43.5951s
	iters: 200, epoch: 2 | loss: 0.3411048
	speed: 0.0048s/iter; left time: 15.4431s
	iters: 300, epoch: 2 | loss: 0.4969440
	speed: 0.0048s/iter; left time: 15.0312s
	iters: 400, epoch: 2 | loss: 0.9935739
	speed: 0.0048s/iter; left time: 14.4394s
Updating learning rate to 0.0001381312044843484
Validation loss decreased (0.6066 --> 0.5799).  Saving model state dict ...
Epoch: 2 cost time: 2.382249593734741
Epoch: 2, Steps: 490 | Train Loss: 0.6675065 Vali Loss: 0.5798652 Best vali loss: 0.5798652
	iters: 100, epoch: 3 | loss: 0.3339383
	speed: 0.0136s/iter; left time: 38.7103s
	iters: 200, epoch: 3 | loss: 0.7915351
	speed: 0.0046s/iter; left time: 12.5430s
	iters: 300, epoch: 3 | loss: 0.5881726
	speed: 0.0043s/iter; left time: 11.2675s
	iters: 400, epoch: 3 | loss: 0.7166210
	speed: 0.0043s/iter; left time: 11.0182s
Updating learning rate to 0.00011188036392216284
Validation loss decreased (0.5799 --> 0.5429).  Saving model state dict ...
Epoch: 3 cost time: 2.2418181896209717
Epoch: 3, Steps: 490 | Train Loss: 0.6075668 Vali Loss: 0.5428918 Best vali loss: 0.5428918
	iters: 100, epoch: 4 | loss: 0.7523187
	speed: 0.0126s/iter; left time: 29.7190s
	iters: 200, epoch: 4 | loss: 0.6566553
	speed: 0.0042s/iter; left time: 9.5182s
	iters: 300, epoch: 4 | loss: 0.5681874
	speed: 0.0043s/iter; left time: 9.2325s
	iters: 400, epoch: 4 | loss: 0.8118512
	speed: 0.0044s/iter; left time: 8.9891s
Updating learning rate to 8.09153862e-05
Epoch: 4 cost time: 2.154991865158081
Epoch: 4, Steps: 490 | Train Loss: 0.6972532 Vali Loss: 0.5598524 Best vali loss: 0.5428918
	iters: 100, epoch: 5 | loss: 0.4667534
	speed: 0.0122s/iter; left time: 22.6771s
	iters: 200, epoch: 5 | loss: 0.6904537
	speed: 0.0044s/iter; left time: 7.6912s
	iters: 300, epoch: 5 | loss: 0.9365951
	speed: 0.0043s/iter; left time: 7.0753s
	iters: 400, epoch: 5 | loss: 0.5777215
	speed: 0.0042s/iter; left time: 6.6210s
Updating learning rate to 4.995040847783719e-05
Epoch: 5 cost time: 2.151867151260376
Epoch: 5, Steps: 490 | Train Loss: 0.6678809 Vali Loss: 0.5469347 Best vali loss: 0.5428918
	iters: 100, epoch: 6 | loss: 0.9773194
	speed: 0.0121s/iter; left time: 16.5973s
	iters: 200, epoch: 6 | loss: 0.5984928
	speed: 0.0043s/iter; left time: 5.4730s
	iters: 300, epoch: 6 | loss: 0.4977893
	speed: 0.0043s/iter; left time: 5.0585s
	iters: 400, epoch: 6 | loss: 0.5329183
	speed: 0.0043s/iter; left time: 4.5521s
Updating learning rate to 2.369956791565162e-05
Epoch: 6 cost time: 2.1517128944396973
Epoch: 6, Steps: 490 | Train Loss: 0.6516299 Vali Loss: 0.5875887 Best vali loss: 0.5428918
	iters: 100, epoch: 7 | loss: 0.5767463
	speed: 0.0126s/iter; left time: 11.0922s
	iters: 200, epoch: 7 | loss: 0.7113887
	speed: 0.0048s/iter; left time: 3.7384s
	iters: 300, epoch: 7 | loss: 0.3891178
	speed: 0.0046s/iter; left time: 3.1354s
	iters: 400, epoch: 7 | loss: 0.5437367
	speed: 0.0046s/iter; left time: 2.6609s
Updating learning rate to 6.159317024573778e-06
Epoch: 7 cost time: 2.327331304550171
Epoch: 7, Steps: 490 | Train Loss: 0.5552474 Vali Loss: 0.6044087 Best vali loss: 0.5428918
	iters: 100, epoch: 8 | loss: 0.5458577
	speed: 0.0124s/iter; left time: 4.8601s
	iters: 200, epoch: 8 | loss: 0.4934238
	speed: 0.0044s/iter; left time: 1.2744s
	iters: 300, epoch: 8 | loss: 0.5424455
	speed: 0.0046s/iter; left time: 0.8721s
	iters: 400, epoch: 8 | loss: 0.3088946
	speed: 0.0047s/iter; left time: 0.4287s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2831132411956787
Epoch: 8, Steps: 490 | Train Loss: 0.4726554 Vali Loss: 0.6017087 Best vali loss: 0.5428918

best validation loss 0.5428918151254734

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019678135564, 'e_layers': 3, 'learning_rate': 0.0004719702523, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00045400695417707905
Validation loss decreased (inf --> 0.6227).  Saving model state dict ...
Epoch: 1 cost time: 1.0365269184112549
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6226605 Best vali loss: 0.6226605
Updating learning rate to 0.0004028518091098279
Validation loss decreased (0.6227 --> 0.5779).  Saving model state dict ...
Epoch: 2 cost time: 0.7394073009490967
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5779303 Best vali loss: 0.5779303
Updating learning rate to 0.0003262927242121907
Validation loss decreased (0.5779 --> 0.5687).  Saving model state dict ...
Epoch: 3 cost time: 0.7366085052490234
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5686702 Best vali loss: 0.5686702

best validation loss 0.5686701696981494

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.002064914555, 'e_layers': 3, 'learning_rate': 9.9194482e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5165778
	speed: 0.0107s/iter; left time: 82.3667s
	iters: 200, epoch: 1 | loss: 0.7237925
	speed: 0.0042s/iter; left time: 32.2930s
	iters: 300, epoch: 1 | loss: 1.2482623
	speed: 0.0043s/iter; left time: 32.0537s
	iters: 400, epoch: 1 | loss: 0.4660547
	speed: 0.0044s/iter; left time: 32.4659s
	iters: 500, epoch: 1 | loss: 0.6843244
	speed: 0.0041s/iter; left time: 29.8141s
	iters: 600, epoch: 1 | loss: 1.6396375
	speed: 0.0038s/iter; left time: 27.1249s
	iters: 700, epoch: 1 | loss: 0.9054307
	speed: 0.0038s/iter; left time: 26.9684s
	iters: 800, epoch: 1 | loss: 0.5250742
	speed: 0.0038s/iter; left time: 26.4277s
	iters: 900, epoch: 1 | loss: 0.4011458
	speed: 0.0038s/iter; left time: 26.2170s
Updating learning rate to 9.9194482e-05
Validation loss decreased (inf --> 0.6053).  Saving model state dict ...
Epoch: 1 cost time: 4.275117635726929
Epoch: 1, Steps: 979 | Train Loss: 0.7900333 Vali Loss: 0.6053407 Best vali loss: 0.6053407
	iters: 100, epoch: 2 | loss: 1.3757071
	speed: 0.0128s/iter; left time: 86.1373s
	iters: 200, epoch: 2 | loss: 1.0201387
	speed: 0.0038s/iter; left time: 25.3195s
	iters: 300, epoch: 2 | loss: 0.9598083
	speed: 0.0037s/iter; left time: 24.4399s
	iters: 400, epoch: 2 | loss: 0.3693718
	speed: 0.0039s/iter; left time: 25.0081s
	iters: 500, epoch: 2 | loss: 0.4688157
	speed: 0.0039s/iter; left time: 25.0966s
	iters: 600, epoch: 2 | loss: 1.0389652
	speed: 0.0038s/iter; left time: 23.7412s
	iters: 700, epoch: 2 | loss: 0.8546726
	speed: 0.0039s/iter; left time: 23.8040s
	iters: 800, epoch: 2 | loss: 1.0817407
	speed: 0.0040s/iter; left time: 24.3729s
	iters: 900, epoch: 2 | loss: 0.4414646
	speed: 0.0039s/iter; left time: 23.0073s
Updating learning rate to 4.9597241e-05
Validation loss decreased (0.6053 --> 0.5721).  Saving model state dict ...
Epoch: 2 cost time: 3.843007802963257
Epoch: 2, Steps: 979 | Train Loss: 0.8456316 Vali Loss: 0.5720893 Best vali loss: 0.5720893
	iters: 100, epoch: 3 | loss: 0.5887957
	speed: 0.0131s/iter; left time: 75.4738s
	iters: 200, epoch: 3 | loss: 0.9007998
	speed: 0.0038s/iter; left time: 21.6822s
	iters: 300, epoch: 3 | loss: 0.2683795
	speed: 0.0039s/iter; left time: 21.6038s
	iters: 400, epoch: 3 | loss: 0.5311069
	speed: 0.0037s/iter; left time: 20.3146s
	iters: 500, epoch: 3 | loss: 0.4598065
	speed: 0.0038s/iter; left time: 20.1640s
	iters: 600, epoch: 3 | loss: 0.3842711
	speed: 0.0040s/iter; left time: 20.9288s
	iters: 700, epoch: 3 | loss: 0.3030255
	speed: 0.0041s/iter; left time: 21.0936s
	iters: 800, epoch: 3 | loss: 0.4456590
	speed: 0.0039s/iter; left time: 19.9560s
	iters: 900, epoch: 3 | loss: 0.3018582
	speed: 0.0040s/iter; left time: 19.7434s
Updating learning rate to 2.47986205e-05
Validation loss decreased (0.5721 --> 0.5497).  Saving model state dict ...
Epoch: 3 cost time: 3.855860948562622
Epoch: 3, Steps: 979 | Train Loss: 0.4648558 Vali Loss: 0.5497013 Best vali loss: 0.5497013

best validation loss 0.5497012859359487

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021018900789, 'e_layers': 3, 'learning_rate': 0.0005312105608, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005109925626884812
Validation loss decreased (inf --> 0.6246).  Saving model state dict ...
Epoch: 1 cost time: 1.0182645320892334
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6245974 Best vali loss: 0.6245974
Updating learning rate to 0.0004534165752897944
Validation loss decreased (0.6246 --> 0.6032).  Saving model state dict ...
Epoch: 2 cost time: 0.7266435623168945
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6031843 Best vali loss: 0.6031843
Updating learning rate to 0.00036724802075776414
Validation loss decreased (0.6032 --> 0.5786).  Saving model state dict ...
Epoch: 3 cost time: 0.7367606163024902
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5786086 Best vali loss: 0.5786086

best validation loss 0.5786086126975801

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.002064914555, 'e_layers': 3, 'learning_rate': 9.9194482e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4383353
	speed: 0.0107s/iter; left time: 51.3097s
	iters: 200, epoch: 4 | loss: 0.6508464
	speed: 0.0042s/iter; left time: 19.5726s
	iters: 300, epoch: 4 | loss: 0.9923350
	speed: 0.0042s/iter; left time: 19.3356s
	iters: 400, epoch: 4 | loss: 0.3576528
	speed: 0.0042s/iter; left time: 18.6659s
	iters: 500, epoch: 4 | loss: 0.5509267
	speed: 0.0042s/iter; left time: 18.4179s
	iters: 600, epoch: 4 | loss: 1.5742931
	speed: 0.0041s/iter; left time: 17.6595s
	iters: 700, epoch: 4 | loss: 0.8814943
	speed: 0.0038s/iter; left time: 16.0996s
	iters: 800, epoch: 4 | loss: 0.3551684
	speed: 0.0039s/iter; left time: 15.8481s
	iters: 900, epoch: 4 | loss: 0.3601988
	speed: 0.0039s/iter; left time: 15.7604s
Updating learning rate to 1.239931025e-05
Validation loss decreased (0.5497 --> 0.5389).  Saving model state dict ...
Epoch: 4 cost time: 4.319894075393677
Epoch: 4, Steps: 979 | Train Loss: 0.6845834 Vali Loss: 0.5388931 Best vali loss: 0.5388931
	iters: 100, epoch: 5 | loss: 1.2535290
	speed: 0.0134s/iter; left time: 51.0141s
	iters: 200, epoch: 5 | loss: 0.9160856
	speed: 0.0041s/iter; left time: 15.4202s
	iters: 300, epoch: 5 | loss: 0.8979378
	speed: 0.0040s/iter; left time: 14.6186s
	iters: 400, epoch: 5 | loss: 0.2621706
	speed: 0.0041s/iter; left time: 14.3657s
	iters: 500, epoch: 5 | loss: 0.3362556
	speed: 0.0042s/iter; left time: 14.3882s
	iters: 600, epoch: 5 | loss: 0.8395364
	speed: 0.0041s/iter; left time: 13.4353s
	iters: 700, epoch: 5 | loss: 0.7802008
	speed: 0.0040s/iter; left time: 13.0202s
	iters: 800, epoch: 5 | loss: 0.8327526
	speed: 0.0041s/iter; left time: 12.6908s
	iters: 900, epoch: 5 | loss: 0.3944225
	speed: 0.0040s/iter; left time: 12.1287s
Updating learning rate to 6.199655125e-06
Epoch: 5 cost time: 4.041381597518921
Epoch: 5, Steps: 979 | Train Loss: 0.7236545 Vali Loss: 0.5589036 Best vali loss: 0.5388931
	iters: 100, epoch: 6 | loss: 0.5693779
	speed: 0.0136s/iter; left time: 38.5228s
	iters: 200, epoch: 6 | loss: 0.8110170
	speed: 0.0040s/iter; left time: 11.0768s
	iters: 300, epoch: 6 | loss: 0.2565108
	speed: 0.0039s/iter; left time: 10.3916s
	iters: 400, epoch: 6 | loss: 0.4767951
	speed: 0.0038s/iter; left time: 9.6323s
	iters: 500, epoch: 6 | loss: 0.4071288
	speed: 0.0038s/iter; left time: 9.2844s
	iters: 600, epoch: 6 | loss: 0.3238860
	speed: 0.0038s/iter; left time: 8.9955s
	iters: 700, epoch: 6 | loss: 0.2843912
	speed: 0.0039s/iter; left time: 8.7312s
	iters: 800, epoch: 6 | loss: 0.4395474
	speed: 0.0039s/iter; left time: 8.2689s
	iters: 900, epoch: 6 | loss: 0.2735919
	speed: 0.0040s/iter; left time: 8.2232s
Updating learning rate to 3.0998275625e-06
Epoch: 6 cost time: 3.902287721633911
Epoch: 6, Steps: 979 | Train Loss: 0.4269162 Vali Loss: 0.5659734 Best vali loss: 0.5388931
	iters: 100, epoch: 7 | loss: 0.2126970
	speed: 0.0132s/iter; left time: 24.4584s
	iters: 200, epoch: 7 | loss: 0.4158427
	speed: 0.0039s/iter; left time: 6.8972s
	iters: 300, epoch: 7 | loss: 1.4711211
	speed: 0.0038s/iter; left time: 6.3333s
	iters: 400, epoch: 7 | loss: 0.2824228
	speed: 0.0038s/iter; left time: 5.9234s
	iters: 500, epoch: 7 | loss: 0.7726763
	speed: 0.0038s/iter; left time: 5.5331s
	iters: 600, epoch: 7 | loss: 0.8505183
	speed: 0.0039s/iter; left time: 5.2331s
	iters: 700, epoch: 7 | loss: 0.8439856
	speed: 0.0039s/iter; left time: 4.9206s
	iters: 800, epoch: 7 | loss: 0.4850821
	speed: 0.0040s/iter; left time: 4.6054s
	iters: 900, epoch: 7 | loss: 0.2290630
	speed: 0.0039s/iter; left time: 4.0967s
Updating learning rate to 1.54991378125e-06
Epoch: 7 cost time: 3.8468964099884033
Epoch: 7, Steps: 979 | Train Loss: 0.6181565 Vali Loss: 0.5664407 Best vali loss: 0.5388931
	iters: 100, epoch: 8 | loss: 0.2265556
	speed: 0.0129s/iter; left time: 11.3265s
	iters: 200, epoch: 8 | loss: 0.7317432
	speed: 0.0040s/iter; left time: 3.1547s
	iters: 300, epoch: 8 | loss: 0.4781943
	speed: 0.0040s/iter; left time: 2.7207s
	iters: 400, epoch: 8 | loss: 0.4562440
	speed: 0.0040s/iter; left time: 2.3188s
	iters: 500, epoch: 8 | loss: 0.5180526
	speed: 0.0041s/iter; left time: 1.9484s
	iters: 600, epoch: 8 | loss: 1.0091450
	speed: 0.0038s/iter; left time: 1.4516s
	iters: 700, epoch: 8 | loss: 0.5202144
	speed: 0.0038s/iter; left time: 1.0724s
	iters: 800, epoch: 8 | loss: 0.7663848
	speed: 0.0038s/iter; left time: 0.6918s
	iters: 900, epoch: 8 | loss: 0.8481101
	speed: 0.0038s/iter; left time: 0.3037s
Updating learning rate to 7.74956890625e-07
Epoch: 8 cost time: 3.899405002593994
Epoch: 8, Steps: 979 | Train Loss: 0.6171827 Vali Loss: 0.5661716 Best vali loss: 0.5388931

best validation loss 0.5388931401663497

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0096747061317, 'e_layers': 2, 'learning_rate': 0.0002987068947, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0522178
	speed: 0.0102s/iter; left time: 19.0402s
	iters: 200, epoch: 1 | loss: 0.7139426
	speed: 0.0039s/iter; left time: 6.9257s
Updating learning rate to 0.00028733804046666706
Validation loss decreased (inf --> 0.5743).  Saving model state dict ...
Epoch: 1 cost time: 1.327803134918213
Epoch: 1, Steps: 245 | Train Loss: 0.8830802 Vali Loss: 0.5742748 Best vali loss: 0.5742748
	iters: 100, epoch: 2 | loss: 0.7218024
	speed: 0.0085s/iter; left time: 13.7197s
	iters: 200, epoch: 2 | loss: 1.0048370
	speed: 0.0041s/iter; left time: 6.1485s
Updating learning rate to 0.000254962282764773
Validation loss decreased (0.5743 --> 0.5673).  Saving model state dict ...
Epoch: 2 cost time: 1.0438737869262695
Epoch: 2, Steps: 245 | Train Loss: 0.8633197 Vali Loss: 0.5673115 Best vali loss: 0.5673115
	iters: 100, epoch: 3 | loss: 0.7997642
	speed: 0.0086s/iter; left time: 11.7985s
	iters: 200, epoch: 3 | loss: 0.4950444
	speed: 0.0038s/iter; left time: 4.8747s
Updating learning rate to 0.00020650853721745674
Epoch: 3 cost time: 1.0170013904571533
Epoch: 3, Steps: 245 | Train Loss: 0.6474043 Vali Loss: 0.5720820 Best vali loss: 0.5673115
	iters: 100, epoch: 4 | loss: 0.6268598
	speed: 0.0083s/iter; left time: 9.3913s
	iters: 200, epoch: 4 | loss: 0.8701382
	speed: 0.0038s/iter; left time: 3.8723s
Updating learning rate to 0.00014935344735
Validation loss decreased (0.5673 --> 0.5482).  Saving model state dict ...
Epoch: 4 cost time: 0.9917352199554443
Epoch: 4, Steps: 245 | Train Loss: 0.7484990 Vali Loss: 0.5481724 Best vali loss: 0.5481724
	iters: 100, epoch: 5 | loss: 0.5657208
	speed: 0.0084s/iter; left time: 7.4124s
	iters: 200, epoch: 5 | loss: 0.5931565
	speed: 0.0039s/iter; left time: 3.0213s
Updating learning rate to 9.219835748254328e-05
Epoch: 5 cost time: 1.001573085784912
Epoch: 5, Steps: 245 | Train Loss: 0.5794387 Vali Loss: 0.5583569 Best vali loss: 0.5481724
	iters: 100, epoch: 6 | loss: 0.2900278
	speed: 0.0084s/iter; left time: 5.3179s
	iters: 200, epoch: 6 | loss: 0.8276238
	speed: 0.0039s/iter; left time: 2.0933s
Updating learning rate to 4.374461193522701e-05
Epoch: 6 cost time: 1.0203545093536377
Epoch: 6, Steps: 245 | Train Loss: 0.5588258 Vali Loss: 0.5710576 Best vali loss: 0.5481724
	iters: 100, epoch: 7 | loss: 0.5516751
	speed: 0.0085s/iter; left time: 3.3191s
	iters: 200, epoch: 7 | loss: 0.7855713
	speed: 0.0041s/iter; left time: 1.2033s
Updating learning rate to 1.1368854233332923e-05
Epoch: 7 cost time: 1.0537371635437012
Epoch: 7, Steps: 245 | Train Loss: 0.6686232 Vali Loss: 0.5739505 Best vali loss: 0.5481724
	iters: 100, epoch: 8 | loss: 0.6624559
	speed: 0.0083s/iter; left time: 1.2182s
	iters: 200, epoch: 8 | loss: 0.3713012
	speed: 0.0039s/iter; left time: 0.1810s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0164215564727783
Epoch: 8, Steps: 245 | Train Loss: 0.5168785 Vali Loss: 0.5784432 Best vali loss: 0.5481724

best validation loss 0.5481723947609977

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0033416047493, 'e_layers': 2, 'learning_rate': 0.0027903593782, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8965373
	speed: 0.0108s/iter; left time: 9.5299s
Updating learning rate to 0.0026841576480349503
Validation loss decreased (inf --> 0.6206).  Saving model state dict ...
Epoch: 1 cost time: 0.9075555801391602
Epoch: 1, Steps: 123 | Train Loss: 0.8965373 Vali Loss: 0.6205540 Best vali loss: 0.6205540
	iters: 100, epoch: 2 | loss: 0.6058998
	speed: 0.0076s/iter; left time: 5.7784s
Updating learning rate to 0.002381720708236349
Validation loss decreased (0.6206 --> 0.6178).  Saving model state dict ...
Epoch: 2 cost time: 0.586580753326416
Epoch: 2, Steps: 123 | Train Loss: 0.6058998 Vali Loss: 0.6177617 Best vali loss: 0.6177617
	iters: 100, epoch: 3 | loss: 1.0433422
	speed: 0.0077s/iter; left time: 4.9304s
Updating learning rate to 0.0019290918412908468
Epoch: 3 cost time: 0.600773811340332
Epoch: 3, Steps: 123 | Train Loss: 1.0433422 Vali Loss: 0.6272789 Best vali loss: 0.6177617
	iters: 100, epoch: 4 | loss: 0.5849854
	speed: 0.0078s/iter; left time: 4.0205s
Updating learning rate to 0.0013951796891
Epoch: 4 cost time: 0.6002435684204102
Epoch: 4, Steps: 123 | Train Loss: 0.5849854 Vali Loss: 0.6267007 Best vali loss: 0.6177617
	iters: 100, epoch: 5 | loss: 0.8095094
	speed: 0.0076s/iter; left time: 3.0044s
Updating learning rate to 0.0008612675369091533
Epoch: 5 cost time: 0.6043622493743896
Epoch: 5, Steps: 123 | Train Loss: 0.8095094 Vali Loss: 0.6652249 Best vali loss: 0.6177617
	iters: 100, epoch: 6 | loss: 0.7110126
	speed: 0.0078s/iter; left time: 2.0955s
Updating learning rate to 0.000408638669963651
Epoch: 6 cost time: 0.5992703437805176
Epoch: 6, Steps: 123 | Train Loss: 0.7110126 Vali Loss: 0.6322285 Best vali loss: 0.6177617
	iters: 100, epoch: 7 | loss: 0.9835271
	speed: 0.0075s/iter; left time: 1.1082s
Updating learning rate to 0.00010620173016504963
Epoch: 7 cost time: 0.6066732406616211
Epoch: 7, Steps: 123 | Train Loss: 0.9835271 Vali Loss: 0.6636245 Best vali loss: 0.6177617
	iters: 100, epoch: 8 | loss: 1.0776222
	speed: 0.0079s/iter; left time: 0.1896s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6150004863739014
Epoch: 8, Steps: 123 | Train Loss: 1.0776222 Vali Loss: 0.6512245 Best vali loss: 0.6177617

best validation loss 0.6177617467867451

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009825951108, 'e_layers': 4, 'learning_rate': 0.0001462695526, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9106625
	speed: 0.0111s/iter; left time: 85.8133s
	iters: 200, epoch: 1 | loss: 0.6152038
	speed: 0.0051s/iter; left time: 39.1279s
	iters: 300, epoch: 1 | loss: 1.2805012
	speed: 0.0051s/iter; left time: 38.4520s
	iters: 400, epoch: 1 | loss: 1.2690589
	speed: 0.0051s/iter; left time: 37.6936s
	iters: 500, epoch: 1 | loss: 0.7965087
	speed: 0.0050s/iter; left time: 36.8293s
	iters: 600, epoch: 1 | loss: 0.6516050
	speed: 0.0050s/iter; left time: 36.1425s
	iters: 700, epoch: 1 | loss: 0.4176871
	speed: 0.0050s/iter; left time: 35.6760s
	iters: 800, epoch: 1 | loss: 0.8912734
	speed: 0.0050s/iter; left time: 35.2571s
	iters: 900, epoch: 1 | loss: 0.5469905
	speed: 0.0051s/iter; left time: 35.3849s
Updating learning rate to 0.0001462695526
Validation loss decreased (inf --> 0.5831).  Saving model state dict ...
Epoch: 1 cost time: 5.298973083496094
Epoch: 1, Steps: 979 | Train Loss: 0.8199435 Vali Loss: 0.5830662 Best vali loss: 0.5830662
	iters: 100, epoch: 2 | loss: 1.1601696
	speed: 0.0152s/iter; left time: 102.7783s
	iters: 200, epoch: 2 | loss: 0.2641557
	speed: 0.0050s/iter; left time: 33.1073s
	iters: 300, epoch: 2 | loss: 0.8227047
	speed: 0.0050s/iter; left time: 32.7743s
	iters: 400, epoch: 2 | loss: 1.7585725
	speed: 0.0050s/iter; left time: 32.1039s
	iters: 500, epoch: 2 | loss: 0.6436465
	speed: 0.0049s/iter; left time: 31.3375s
	iters: 600, epoch: 2 | loss: 0.3999147
	speed: 0.0049s/iter; left time: 30.3845s
	iters: 700, epoch: 2 | loss: 1.4424039
	speed: 0.0052s/iter; left time: 32.2843s
	iters: 800, epoch: 2 | loss: 0.7353662
	speed: 0.0051s/iter; left time: 30.9260s
	iters: 900, epoch: 2 | loss: 0.7542266
	speed: 0.0051s/iter; left time: 30.4790s
Updating learning rate to 7.31347763e-05
Validation loss decreased (0.5831 --> 0.5611).  Saving model state dict ...
Epoch: 2 cost time: 4.965264558792114
Epoch: 2, Steps: 979 | Train Loss: 0.8867956 Vali Loss: 0.5611282 Best vali loss: 0.5611282
	iters: 100, epoch: 3 | loss: 1.2884272
	speed: 0.0157s/iter; left time: 90.9500s
	iters: 200, epoch: 3 | loss: 0.9641210
	speed: 0.0049s/iter; left time: 27.6410s
	iters: 300, epoch: 3 | loss: 1.0877370
	speed: 0.0048s/iter; left time: 26.9565s
	iters: 400, epoch: 3 | loss: 0.4308003
	speed: 0.0049s/iter; left time: 26.8774s
	iters: 500, epoch: 3 | loss: 1.0509063
	speed: 0.0049s/iter; left time: 26.2694s
	iters: 600, epoch: 3 | loss: 1.1493026
	speed: 0.0048s/iter; left time: 25.2410s
	iters: 700, epoch: 3 | loss: 0.6282862
	speed: 0.0048s/iter; left time: 25.0343s
	iters: 800, epoch: 3 | loss: 0.5903079
	speed: 0.0048s/iter; left time: 24.5758s
	iters: 900, epoch: 3 | loss: 0.3724942
	speed: 0.0048s/iter; left time: 23.8939s
Updating learning rate to 3.656738815e-05
Validation loss decreased (0.5611 --> 0.5566).  Saving model state dict ...
Epoch: 3 cost time: 4.791840314865112
Epoch: 3, Steps: 979 | Train Loss: 0.8402647 Vali Loss: 0.5566151 Best vali loss: 0.5566151

best validation loss 0.5566150822100514

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0014604207965, 'e_layers': 3, 'learning_rate': 0.0024314467987, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8885931
	speed: 0.0100s/iter; left time: 77.7117s
	iters: 200, epoch: 1 | loss: 0.3824818
	speed: 0.0044s/iter; left time: 33.2537s
	iters: 300, epoch: 1 | loss: 0.9219210
	speed: 0.0042s/iter; left time: 31.7999s
	iters: 400, epoch: 1 | loss: 0.7829551
	speed: 0.0043s/iter; left time: 31.8248s
	iters: 500, epoch: 1 | loss: 0.4343713
	speed: 0.0042s/iter; left time: 30.9173s
	iters: 600, epoch: 1 | loss: 1.2291811
	speed: 0.0039s/iter; left time: 28.0235s
	iters: 700, epoch: 1 | loss: 0.8129365
	speed: 0.0038s/iter; left time: 26.8431s
	iters: 800, epoch: 1 | loss: 0.9862655
	speed: 0.0038s/iter; left time: 26.4159s
	iters: 900, epoch: 1 | loss: 0.9525402
	speed: 0.0038s/iter; left time: 26.1406s
Updating learning rate to 0.0023389053652045104
Validation loss decreased (inf --> 0.6108).  Saving model state dict ...
Epoch: 1 cost time: 4.2567808628082275
Epoch: 1, Steps: 979 | Train Loss: 0.8212495 Vali Loss: 0.6107896 Best vali loss: 0.6107896
	iters: 100, epoch: 2 | loss: 1.2323776
	speed: 0.0126s/iter; left time: 85.2365s
	iters: 200, epoch: 2 | loss: 1.4760556
	speed: 0.0037s/iter; left time: 24.8246s
	iters: 300, epoch: 2 | loss: 0.5661795
	speed: 0.0038s/iter; left time: 24.6678s
	iters: 400, epoch: 2 | loss: 0.4462797
	speed: 0.0036s/iter; left time: 23.4821s
	iters: 500, epoch: 2 | loss: 1.3990923
	speed: 0.0037s/iter; left time: 23.2058s
	iters: 600, epoch: 2 | loss: 0.9827849
	speed: 0.0037s/iter; left time: 23.2755s
	iters: 700, epoch: 2 | loss: 0.6645340
	speed: 0.0039s/iter; left time: 24.2050s
	iters: 800, epoch: 2 | loss: 1.1375428
	speed: 0.0037s/iter; left time: 22.3249s
	iters: 900, epoch: 2 | loss: 1.3854102
	speed: 0.0036s/iter; left time: 21.3137s
Updating learning rate to 0.002075369659077546
Epoch: 2 cost time: 3.676835536956787
Epoch: 2, Steps: 979 | Train Loss: 1.0322507 Vali Loss: 0.6344442 Best vali loss: 0.6107896
	iters: 100, epoch: 3 | loss: 0.3376558
	speed: 0.0122s/iter; left time: 70.5378s
	iters: 200, epoch: 3 | loss: 1.5865090
	speed: 0.0037s/iter; left time: 20.9677s
	iters: 300, epoch: 3 | loss: 0.6976123
	speed: 0.0038s/iter; left time: 21.1856s
	iters: 400, epoch: 3 | loss: 0.3776607
	speed: 0.0036s/iter; left time: 19.8783s
	iters: 500, epoch: 3 | loss: 0.3991010
	speed: 0.0036s/iter; left time: 19.4304s
	iters: 600, epoch: 3 | loss: 0.2623169
	speed: 0.0037s/iter; left time: 19.7585s
	iters: 700, epoch: 3 | loss: 0.8118938
	speed: 0.0037s/iter; left time: 19.2022s
	iters: 800, epoch: 3 | loss: 1.7749369
	speed: 0.0036s/iter; left time: 18.2013s
	iters: 900, epoch: 3 | loss: 0.6818223
	speed: 0.0037s/iter; left time: 18.2604s
Updating learning rate to 0.001680960602619813
Epoch: 3 cost time: 3.6673591136932373
Epoch: 3, Steps: 979 | Train Loss: 0.7699454 Vali Loss: 0.6251462 Best vali loss: 0.6107896

best validation loss 0.6107895957243106

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0056479993332, 'e_layers': 4, 'learning_rate': 0.0001235032803, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00011880271658358719
Validation loss decreased (inf --> 0.6440).  Saving model state dict ...
Epoch: 1 cost time: 0.839695930480957
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6440023 Best vali loss: 0.6440023
Updating learning rate to 0.00010541664364945647
Validation loss decreased (0.6440 --> 0.6199).  Saving model state dict ...
Epoch: 2 cost time: 0.5281362533569336
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6198533 Best vali loss: 0.6198533
Updating learning rate to 8.538296975677589e-05
Validation loss decreased (0.6199 --> 0.6109).  Saving model state dict ...
Epoch: 3 cost time: 0.48519086837768555
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6109497 Best vali loss: 0.6109497

best validation loss 0.61094965652314

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009825951108, 'e_layers': 4, 'learning_rate': 0.0001462695526, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8797491
	speed: 0.0114s/iter; left time: 54.9105s
	iters: 200, epoch: 4 | loss: 0.5978950
	speed: 0.0053s/iter; left time: 24.8042s
	iters: 300, epoch: 4 | loss: 1.0550389
	speed: 0.0048s/iter; left time: 22.0530s
	iters: 400, epoch: 4 | loss: 0.7123396
	speed: 0.0045s/iter; left time: 20.0647s
	iters: 500, epoch: 4 | loss: 0.5707094
	speed: 0.0044s/iter; left time: 19.5406s
	iters: 600, epoch: 4 | loss: 0.6458783
	speed: 0.0045s/iter; left time: 19.4532s
	iters: 700, epoch: 4 | loss: 0.3589337
	speed: 0.0047s/iter; left time: 19.6154s
	iters: 800, epoch: 4 | loss: 0.8751655
	speed: 0.0047s/iter; left time: 19.3738s
	iters: 900, epoch: 4 | loss: 0.5542294
	speed: 0.0048s/iter; left time: 19.2603s
Updating learning rate to 1.8283694075e-05
Validation loss decreased (0.5566 --> 0.5423).  Saving model state dict ...
Epoch: 4 cost time: 5.018649339675903
Epoch: 4, Steps: 979 | Train Loss: 0.6944377 Vali Loss: 0.5422568 Best vali loss: 0.5422568
	iters: 100, epoch: 5 | loss: 0.8438097
	speed: 0.0155s/iter; left time: 59.1365s
	iters: 200, epoch: 5 | loss: 0.2316715
	speed: 0.0048s/iter; left time: 17.8760s
	iters: 300, epoch: 5 | loss: 0.7650241
	speed: 0.0047s/iter; left time: 17.0611s
	iters: 400, epoch: 5 | loss: 1.0865579
	speed: 0.0049s/iter; left time: 17.1043s
	iters: 500, epoch: 5 | loss: 0.5761136
	speed: 0.0050s/iter; left time: 17.1063s
	iters: 600, epoch: 5 | loss: 0.2760622
	speed: 0.0051s/iter; left time: 16.9278s
	iters: 700, epoch: 5 | loss: 1.4310896
	speed: 0.0052s/iter; left time: 16.7083s
	iters: 800, epoch: 5 | loss: 0.6476965
	speed: 0.0053s/iter; left time: 16.4017s
	iters: 900, epoch: 5 | loss: 0.6371906
	speed: 0.0052s/iter; left time: 15.6279s
Updating learning rate to 9.1418470375e-06
Epoch: 5 cost time: 4.961594820022583
Epoch: 5, Steps: 979 | Train Loss: 0.7216906 Vali Loss: 0.5464447 Best vali loss: 0.5422568
	iters: 100, epoch: 6 | loss: 1.2024409
	speed: 0.0159s/iter; left time: 45.2289s
	iters: 200, epoch: 6 | loss: 0.8168730
	speed: 0.0052s/iter; left time: 14.3700s
	iters: 300, epoch: 6 | loss: 0.9592894
	speed: 0.0053s/iter; left time: 13.9017s
	iters: 400, epoch: 6 | loss: 0.3951095
	speed: 0.0049s/iter; left time: 12.3550s
	iters: 500, epoch: 6 | loss: 0.8358174
	speed: 0.0050s/iter; left time: 12.1253s
	iters: 600, epoch: 6 | loss: 1.0613180
	speed: 0.0050s/iter; left time: 11.5738s
	iters: 700, epoch: 6 | loss: 0.5114251
	speed: 0.0047s/iter; left time: 10.6138s
	iters: 800, epoch: 6 | loss: 0.5794950
	speed: 0.0045s/iter; left time: 9.5224s
	iters: 900, epoch: 6 | loss: 0.3329476
	speed: 0.0044s/iter; left time: 9.0646s
Updating learning rate to 4.57092351875e-06
Epoch: 6 cost time: 4.835220098495483
Epoch: 6, Steps: 979 | Train Loss: 0.7438573 Vali Loss: 0.5449736 Best vali loss: 0.5422568
	iters: 100, epoch: 7 | loss: 1.1318073
	speed: 0.0152s/iter; left time: 28.2473s
	iters: 200, epoch: 7 | loss: 0.3067535
	speed: 0.0047s/iter; left time: 8.3017s
	iters: 300, epoch: 7 | loss: 0.4847397
	speed: 0.0047s/iter; left time: 7.8403s
	iters: 400, epoch: 7 | loss: 0.6001478
	speed: 0.0048s/iter; left time: 7.4196s
	iters: 500, epoch: 7 | loss: 0.2745761
	speed: 0.0048s/iter; left time: 6.9434s
	iters: 600, epoch: 7 | loss: 1.4084156
	speed: 0.0047s/iter; left time: 6.3812s
	iters: 700, epoch: 7 | loss: 0.7982641
	speed: 0.0048s/iter; left time: 5.9923s
	iters: 800, epoch: 7 | loss: 0.7599456
	speed: 0.0045s/iter; left time: 5.1887s
	iters: 900, epoch: 7 | loss: 0.9073294
	speed: 0.0045s/iter; left time: 4.8058s
Updating learning rate to 2.285461759375e-06
Epoch: 7 cost time: 4.692665100097656
Epoch: 7, Steps: 979 | Train Loss: 0.7413310 Vali Loss: 0.5461050 Best vali loss: 0.5422568
	iters: 100, epoch: 8 | loss: 1.0254021
	speed: 0.0147s/iter; left time: 12.9306s
	iters: 200, epoch: 8 | loss: 0.8024160
	speed: 0.0047s/iter; left time: 3.7035s
	iters: 300, epoch: 8 | loss: 0.5472538
	speed: 0.0048s/iter; left time: 3.2356s
	iters: 400, epoch: 8 | loss: 0.2287914
	speed: 0.0048s/iter; left time: 2.7832s
	iters: 500, epoch: 8 | loss: 0.4155438
	speed: 0.0046s/iter; left time: 2.2193s
	iters: 600, epoch: 8 | loss: 0.4758707
	speed: 0.0045s/iter; left time: 1.6914s
	iters: 700, epoch: 8 | loss: 0.4558420
	speed: 0.0046s/iter; left time: 1.2860s
	iters: 800, epoch: 8 | loss: 0.7648866
	speed: 0.0046s/iter; left time: 0.8340s
	iters: 900, epoch: 8 | loss: 0.3761682
	speed: 0.0046s/iter; left time: 0.3709s
Updating learning rate to 1.1427308796875e-06
Epoch: 8 cost time: 4.610081195831299
Epoch: 8, Steps: 979 | Train Loss: 0.5657972 Vali Loss: 0.5458783 Best vali loss: 0.5422568

best validation loss 0.5422567846128533

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0056471507627, 'e_layers': 1, 'learning_rate': 0.0003989799998, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9355519
	speed: 0.0086s/iter; left time: 66.6564s
	iters: 200, epoch: 1 | loss: 1.0052158
	speed: 0.0025s/iter; left time: 19.4228s
	iters: 300, epoch: 1 | loss: 0.4045890
	speed: 0.0025s/iter; left time: 18.7507s
	iters: 400, epoch: 1 | loss: 0.3855075
	speed: 0.0024s/iter; left time: 17.6465s
	iters: 500, epoch: 1 | loss: 0.8438976
	speed: 0.0025s/iter; left time: 18.0765s
	iters: 600, epoch: 1 | loss: 1.1799604
	speed: 0.0024s/iter; left time: 17.1141s
	iters: 700, epoch: 1 | loss: 0.7079607
	speed: 0.0024s/iter; left time: 17.2407s
	iters: 800, epoch: 1 | loss: 2.1035173
	speed: 0.0024s/iter; left time: 16.6552s
	iters: 900, epoch: 1 | loss: 0.9900852
	speed: 0.0025s/iter; left time: 17.5591s
Updating learning rate to 0.0003989799998
Validation loss decreased (inf --> 0.6000).  Saving model state dict ...
Epoch: 1 cost time: 2.752760648727417
Epoch: 1, Steps: 979 | Train Loss: 0.9506984 Vali Loss: 0.5999950 Best vali loss: 0.5999950
	iters: 100, epoch: 2 | loss: 0.4015839
	speed: 0.0091s/iter; left time: 61.6438s
	iters: 200, epoch: 2 | loss: 0.9272683
	speed: 0.0025s/iter; left time: 16.6055s
	iters: 300, epoch: 2 | loss: 1.2886661
	speed: 0.0026s/iter; left time: 16.7767s
	iters: 400, epoch: 2 | loss: 0.6958293
	speed: 0.0026s/iter; left time: 16.5377s
	iters: 500, epoch: 2 | loss: 1.1769944
	speed: 0.0026s/iter; left time: 16.2353s
	iters: 600, epoch: 2 | loss: 1.0761784
	speed: 0.0025s/iter; left time: 15.6028s
	iters: 700, epoch: 2 | loss: 1.2605090
	speed: 0.0025s/iter; left time: 15.3655s
	iters: 800, epoch: 2 | loss: 1.0233697
	speed: 0.0026s/iter; left time: 15.4436s
	iters: 900, epoch: 2 | loss: 1.7556670
	speed: 0.0024s/iter; left time: 14.4018s
Updating learning rate to 0.0001994899999
Epoch: 2 cost time: 2.495903491973877
Epoch: 2, Steps: 979 | Train Loss: 1.0673407 Vali Loss: 0.6017639 Best vali loss: 0.5999950
	iters: 100, epoch: 3 | loss: 0.6949858
	speed: 0.0089s/iter; left time: 51.5214s
	iters: 200, epoch: 3 | loss: 0.8669458
	speed: 0.0025s/iter; left time: 14.2616s
	iters: 300, epoch: 3 | loss: 0.7958362
	speed: 0.0025s/iter; left time: 14.1179s
	iters: 400, epoch: 3 | loss: 0.5391176
	speed: 0.0025s/iter; left time: 13.5991s
	iters: 500, epoch: 3 | loss: 1.0455257
	speed: 0.0025s/iter; left time: 13.5041s
	iters: 600, epoch: 3 | loss: 1.0936345
	speed: 0.0025s/iter; left time: 13.2569s
	iters: 700, epoch: 3 | loss: 0.4202280
	speed: 0.0025s/iter; left time: 12.9425s
	iters: 800, epoch: 3 | loss: 0.8265821
	speed: 0.0024s/iter; left time: 12.1676s
	iters: 900, epoch: 3 | loss: 0.9291391
	speed: 0.0024s/iter; left time: 11.7444s
Updating learning rate to 9.974499995e-05
Epoch: 3 cost time: 2.4709458351135254
Epoch: 3, Steps: 979 | Train Loss: 0.8013327 Vali Loss: 0.6257753 Best vali loss: 0.5999950
	iters: 100, epoch: 4 | loss: 0.7905196
	speed: 0.0089s/iter; left time: 42.8100s
	iters: 200, epoch: 4 | loss: 0.4673358
	speed: 0.0024s/iter; left time: 11.0741s
	iters: 300, epoch: 4 | loss: 0.4169386
	speed: 0.0024s/iter; left time: 10.9486s
	iters: 400, epoch: 4 | loss: 0.5010964
	speed: 0.0024s/iter; left time: 10.5930s
	iters: 500, epoch: 4 | loss: 0.5665504
	speed: 0.0024s/iter; left time: 10.5597s
	iters: 600, epoch: 4 | loss: 0.6202155
	speed: 0.0023s/iter; left time: 9.9399s
	iters: 700, epoch: 4 | loss: 0.5328068
	speed: 0.0023s/iter; left time: 9.7673s
	iters: 800, epoch: 4 | loss: 0.4908632
	speed: 0.0023s/iter; left time: 9.4880s
	iters: 900, epoch: 4 | loss: 0.5010812
	speed: 0.0024s/iter; left time: 9.4336s
Updating learning rate to 4.9872499975e-05
Epoch: 4 cost time: 2.3496110439300537
Epoch: 4, Steps: 979 | Train Loss: 0.5430453 Vali Loss: 0.6215101 Best vali loss: 0.5999950
	iters: 100, epoch: 5 | loss: 0.9894568
	speed: 0.0091s/iter; left time: 34.8955s
	iters: 200, epoch: 5 | loss: 1.1561548
	speed: 0.0025s/iter; left time: 9.4270s
	iters: 300, epoch: 5 | loss: 0.8362013
	speed: 0.0024s/iter; left time: 8.5641s
	iters: 400, epoch: 5 | loss: 0.6947351
	speed: 0.0024s/iter; left time: 8.3138s
	iters: 500, epoch: 5 | loss: 0.7896234
	speed: 0.0024s/iter; left time: 8.1466s
	iters: 600, epoch: 5 | loss: 0.4352917
	speed: 0.0024s/iter; left time: 7.9965s
	iters: 700, epoch: 5 | loss: 0.4977514
	speed: 0.0023s/iter; left time: 7.3222s
	iters: 800, epoch: 5 | loss: 1.5954144
	speed: 0.0023s/iter; left time: 7.2543s
	iters: 900, epoch: 5 | loss: 0.9551246
	speed: 0.0023s/iter; left time: 6.9227s
Updating learning rate to 2.49362499875e-05
Epoch: 5 cost time: 2.3874852657318115
Epoch: 5, Steps: 979 | Train Loss: 0.8833059 Vali Loss: 0.6262859 Best vali loss: 0.5999950
	iters: 100, epoch: 6 | loss: 0.9189552
	speed: 0.0090s/iter; left time: 25.4906s
	iters: 200, epoch: 6 | loss: 1.0135584
	speed: 0.0023s/iter; left time: 6.3830s
	iters: 300, epoch: 6 | loss: 0.4262670
	speed: 0.0023s/iter; left time: 6.1741s
	iters: 400, epoch: 6 | loss: 1.1572901
	speed: 0.0024s/iter; left time: 6.0966s
	iters: 500, epoch: 6 | loss: 0.3386089
	speed: 0.0024s/iter; left time: 5.8730s
	iters: 600, epoch: 6 | loss: 1.0234787
	speed: 0.0024s/iter; left time: 5.5149s
	iters: 700, epoch: 6 | loss: 0.3593898
	speed: 0.0024s/iter; left time: 5.2864s
	iters: 800, epoch: 6 | loss: 1.8772861
	speed: 0.0023s/iter; left time: 4.9840s
	iters: 900, epoch: 6 | loss: 0.7745911
	speed: 0.0024s/iter; left time: 4.8863s
Updating learning rate to 1.246812499375e-05
Epoch: 6 cost time: 2.372844934463501
Epoch: 6, Steps: 979 | Train Loss: 0.8766028 Vali Loss: 0.6386601 Best vali loss: 0.5999950
	iters: 100, epoch: 7 | loss: 0.9345147
	speed: 0.0089s/iter; left time: 16.5409s
	iters: 200, epoch: 7 | loss: 1.3466935
	speed: 0.0024s/iter; left time: 4.1376s
	iters: 300, epoch: 7 | loss: 0.8924013
	speed: 0.0023s/iter; left time: 3.8616s
	iters: 400, epoch: 7 | loss: 0.5877789
	speed: 0.0024s/iter; left time: 3.7460s
	iters: 500, epoch: 7 | loss: 0.6555446
	speed: 0.0023s/iter; left time: 3.4153s
	iters: 600, epoch: 7 | loss: 0.3727431
	speed: 0.0024s/iter; left time: 3.2520s
	iters: 700, epoch: 7 | loss: 0.7558697
	speed: 0.0024s/iter; left time: 2.9625s
	iters: 800, epoch: 7 | loss: 0.7972812
	speed: 0.0024s/iter; left time: 2.7705s
	iters: 900, epoch: 7 | loss: 0.6075839
	speed: 0.0024s/iter; left time: 2.5182s
Updating learning rate to 6.234062496875e-06
Epoch: 7 cost time: 2.367669105529785
Epoch: 7, Steps: 979 | Train Loss: 0.7722679 Vali Loss: 0.6373717 Best vali loss: 0.5999950
	iters: 100, epoch: 8 | loss: 0.9244109
	speed: 0.0086s/iter; left time: 7.6050s
	iters: 200, epoch: 8 | loss: 1.6061869
	speed: 0.0025s/iter; left time: 1.9261s
	iters: 300, epoch: 8 | loss: 0.5264731
	speed: 0.0024s/iter; left time: 1.6272s
	iters: 400, epoch: 8 | loss: 0.7399184
	speed: 0.0024s/iter; left time: 1.3943s
	iters: 500, epoch: 8 | loss: 0.7767308
	speed: 0.0025s/iter; left time: 1.1760s
	iters: 600, epoch: 8 | loss: 0.3860528
	speed: 0.0025s/iter; left time: 0.9376s
	iters: 700, epoch: 8 | loss: 0.5948157
	speed: 0.0024s/iter; left time: 0.6792s
	iters: 800, epoch: 8 | loss: 0.3728751
	speed: 0.0025s/iter; left time: 0.4458s
	iters: 900, epoch: 8 | loss: 1.2021487
	speed: 0.0025s/iter; left time: 0.1966s
Updating learning rate to 3.1170312484375e-06
Epoch: 8 cost time: 2.4114232063293457
Epoch: 8, Steps: 979 | Train Loss: 0.7921792 Vali Loss: 0.6377037 Best vali loss: 0.5999950

best validation loss 0.5999949502895299

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016651849306, 'e_layers': 2, 'learning_rate': 0.0002980569014, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9346246
	speed: 0.0098s/iter; left time: 37.3871s
	iters: 200, epoch: 1 | loss: 1.4945124
	speed: 0.0037s/iter; left time: 13.9475s
	iters: 300, epoch: 1 | loss: 1.4792529
	speed: 0.0037s/iter; left time: 13.4660s
	iters: 400, epoch: 1 | loss: 1.2704381
	speed: 0.0038s/iter; left time: 13.2809s
Updating learning rate to 0.00028671278606359735
Validation loss decreased (inf --> 0.5925).  Saving model state dict ...
Epoch: 1 cost time: 2.1807563304901123
Epoch: 1, Steps: 490 | Train Loss: 1.2947070 Vali Loss: 0.5925433 Best vali loss: 0.5925433
	iters: 100, epoch: 2 | loss: 0.6207748
	speed: 0.0105s/iter; left time: 34.9691s
	iters: 200, epoch: 2 | loss: 0.5583609
	speed: 0.0035s/iter; left time: 11.2003s
	iters: 300, epoch: 2 | loss: 0.7691167
	speed: 0.0034s/iter; left time: 10.6040s
	iters: 400, epoch: 2 | loss: 0.8143570
	speed: 0.0035s/iter; left time: 10.6985s
Updating learning rate to 0.0002544074787796951
Epoch: 2 cost time: 1.7631406784057617
Epoch: 2, Steps: 490 | Train Loss: 0.6906524 Vali Loss: 0.6001106 Best vali loss: 0.5925433
	iters: 100, epoch: 3 | loss: 1.3000404
	speed: 0.0099s/iter; left time: 28.0599s
	iters: 200, epoch: 3 | loss: 0.9412194
	speed: 0.0034s/iter; left time: 9.3857s
	iters: 300, epoch: 3 | loss: 0.6745101
	speed: 0.0033s/iter; left time: 8.6271s
	iters: 400, epoch: 3 | loss: 0.6901233
	speed: 0.0033s/iter; left time: 8.3180s
Updating learning rate to 0.00020605916973392757
Epoch: 3 cost time: 1.6714694499969482
Epoch: 3, Steps: 490 | Train Loss: 0.9014733 Vali Loss: 0.6266049 Best vali loss: 0.5925433
	iters: 100, epoch: 4 | loss: 0.9794562
	speed: 0.0100s/iter; left time: 23.5755s
	iters: 200, epoch: 4 | loss: 0.5665832
	speed: 0.0037s/iter; left time: 8.2571s
	iters: 300, epoch: 4 | loss: 0.6331974
	speed: 0.0036s/iter; left time: 7.8166s
	iters: 400, epoch: 4 | loss: 0.6013368
	speed: 0.0033s/iter; left time: 6.7461s
Updating learning rate to 0.0001490284507
Validation loss decreased (0.5925 --> 0.5630).  Saving model state dict ...
Epoch: 4 cost time: 1.773346185684204
Epoch: 4, Steps: 490 | Train Loss: 0.6951434 Vali Loss: 0.5629851 Best vali loss: 0.5629851
	iters: 100, epoch: 5 | loss: 0.7724813
	speed: 0.0099s/iter; left time: 18.4774s
	iters: 200, epoch: 5 | loss: 0.8936089
	speed: 0.0032s/iter; left time: 5.7125s
	iters: 300, epoch: 5 | loss: 0.9112724
	speed: 0.0035s/iter; left time: 5.7375s
	iters: 400, epoch: 5 | loss: 0.9369835
	speed: 0.0037s/iter; left time: 5.7381s
Updating learning rate to 9.199773166607244e-05
Validation loss decreased (0.5630 --> 0.5598).  Saving model state dict ...
Epoch: 5 cost time: 1.740941047668457
Epoch: 5, Steps: 490 | Train Loss: 0.8785865 Vali Loss: 0.5598490 Best vali loss: 0.5598490
	iters: 100, epoch: 6 | loss: 0.6516742
	speed: 0.0106s/iter; left time: 14.5143s
	iters: 200, epoch: 6 | loss: 0.8330237
	speed: 0.0037s/iter; left time: 4.6769s
	iters: 300, epoch: 6 | loss: 0.8124657
	speed: 0.0038s/iter; left time: 4.4524s
	iters: 400, epoch: 6 | loss: 0.9442666
	speed: 0.0036s/iter; left time: 3.8751s
Updating learning rate to 4.3649422620304924e-05
Epoch: 6 cost time: 1.841461420059204
Epoch: 6, Steps: 490 | Train Loss: 0.8103576 Vali Loss: 0.5810740 Best vali loss: 0.5598490
	iters: 100, epoch: 7 | loss: 0.7002398
	speed: 0.0104s/iter; left time: 9.1711s
	iters: 200, epoch: 7 | loss: 0.3274021
	speed: 0.0035s/iter; left time: 2.7475s
	iters: 300, epoch: 7 | loss: 0.2435715
	speed: 0.0035s/iter; left time: 2.3639s
	iters: 400, epoch: 7 | loss: 0.6438417
	speed: 0.0035s/iter; left time: 2.0246s
Updating learning rate to 1.1344115336402657e-05
Epoch: 7 cost time: 1.7617895603179932
Epoch: 7, Steps: 490 | Train Loss: 0.4787638 Vali Loss: 0.5853542 Best vali loss: 0.5598490
	iters: 100, epoch: 8 | loss: 0.6312445
	speed: 0.0100s/iter; left time: 3.9021s
	iters: 200, epoch: 8 | loss: 0.3959616
	speed: 0.0034s/iter; left time: 0.9927s
	iters: 300, epoch: 8 | loss: 0.7225630
	speed: 0.0033s/iter; left time: 0.6370s
	iters: 400, epoch: 8 | loss: 0.6204502
	speed: 0.0034s/iter; left time: 0.3134s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7095768451690674
Epoch: 8, Steps: 490 | Train Loss: 0.5925548 Vali Loss: 0.5835877 Best vali loss: 0.5598490

best validation loss 0.5598490067457281

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0026874191286, 'e_layers': 2, 'learning_rate': 0.0002983261057, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9339069
	speed: 0.0100s/iter; left time: 38.1338s
	iters: 200, epoch: 1 | loss: 1.4923689
	speed: 0.0038s/iter; left time: 14.1248s
	iters: 300, epoch: 1 | loss: 1.4694568
	speed: 0.0038s/iter; left time: 13.5875s
	iters: 400, epoch: 1 | loss: 1.2271117
	speed: 0.0037s/iter; left time: 13.1229s
Updating learning rate to 0.00028697174438501436
Validation loss decreased (inf --> 0.5973).  Saving model state dict ...
Epoch: 1 cost time: 2.1914429664611816
Epoch: 1, Steps: 490 | Train Loss: 1.2807111 Vali Loss: 0.5972962 Best vali loss: 0.5972962
	iters: 100, epoch: 2 | loss: 0.6248489
	speed: 0.0106s/iter; left time: 35.2193s
	iters: 200, epoch: 2 | loss: 0.5615702
	speed: 0.0038s/iter; left time: 12.1213s
	iters: 300, epoch: 2 | loss: 0.7762118
	speed: 0.0037s/iter; left time: 11.6212s
	iters: 400, epoch: 2 | loss: 0.7967155
	speed: 0.0037s/iter; left time: 11.3563s
Updating learning rate to 0.0002546372590227224
Validation loss decreased (0.5973 --> 0.5685).  Saving model state dict ...
Epoch: 2 cost time: 1.8657019138336182
Epoch: 2, Steps: 490 | Train Loss: 0.6898366 Vali Loss: 0.5685428 Best vali loss: 0.5685428
	iters: 100, epoch: 3 | loss: 1.2412124
	speed: 0.0103s/iter; left time: 29.2261s
	iters: 200, epoch: 3 | loss: 0.9386637
	speed: 0.0032s/iter; left time: 8.8284s
	iters: 300, epoch: 3 | loss: 0.9852946
	speed: 0.0032s/iter; left time: 8.5752s
	iters: 400, epoch: 3 | loss: 0.7079229
	speed: 0.0033s/iter; left time: 8.3778s
Updating learning rate to 0.00020624528189669327
Validation loss decreased (0.5685 --> 0.5498).  Saving model state dict ...
Epoch: 3 cost time: 1.6386959552764893
Epoch: 3, Steps: 490 | Train Loss: 0.9682734 Vali Loss: 0.5497677 Best vali loss: 0.5497677

best validation loss 0.5497677350888259

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0008525430419, 'e_layers': 4, 'learning_rate': 0.0006846950384, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2042667
	speed: 0.0114s/iter; left time: 43.4416s
	iters: 200, epoch: 1 | loss: 0.3860348
	speed: 0.0053s/iter; left time: 19.8335s
	iters: 300, epoch: 1 | loss: 0.5707768
	speed: 0.0054s/iter; left time: 19.4837s
	iters: 400, epoch: 1 | loss: 1.0445989
	speed: 0.0054s/iter; left time: 18.9423s
Updating learning rate to 0.0006846950384
Validation loss decreased (inf --> 0.5988).  Saving model state dict ...
Epoch: 1 cost time: 2.9608116149902344
Epoch: 1, Steps: 490 | Train Loss: 0.8014193 Vali Loss: 0.5988348 Best vali loss: 0.5988348
	iters: 100, epoch: 2 | loss: 1.9610599
	speed: 0.0141s/iter; left time: 46.9755s
	iters: 200, epoch: 2 | loss: 0.8824525
	speed: 0.0056s/iter; left time: 18.0058s
	iters: 300, epoch: 2 | loss: 0.8278562
	speed: 0.0055s/iter; left time: 17.1953s
	iters: 400, epoch: 2 | loss: 0.5533046
	speed: 0.0052s/iter; left time: 15.7377s
Updating learning rate to 0.0003423475192
Validation loss decreased (0.5988 --> 0.5952).  Saving model state dict ...
Epoch: 2 cost time: 2.6718547344207764
Epoch: 2, Steps: 490 | Train Loss: 1.0561683 Vali Loss: 0.5951541 Best vali loss: 0.5951541
	iters: 100, epoch: 3 | loss: 0.7543690
	speed: 0.0136s/iter; left time: 38.5340s
	iters: 200, epoch: 3 | loss: 0.6430105
	speed: 0.0050s/iter; left time: 13.6975s
	iters: 300, epoch: 3 | loss: 0.7903820
	speed: 0.0051s/iter; left time: 13.3973s
	iters: 400, epoch: 3 | loss: 0.5241274
	speed: 0.0049s/iter; left time: 12.3266s
Updating learning rate to 0.0001711737596
Validation loss decreased (0.5952 --> 0.5644).  Saving model state dict ...
Epoch: 3 cost time: 2.4864494800567627
Epoch: 3, Steps: 490 | Train Loss: 0.6779722 Vali Loss: 0.5644145 Best vali loss: 0.5644145

best validation loss 0.5644145380397022

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0114320121694, 'e_layers': 2, 'learning_rate': 0.0038309291073, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6767761
	speed: 0.0098s/iter; left time: 75.4114s
	iters: 200, epoch: 1 | loss: 1.2117857
	speed: 0.0032s/iter; left time: 24.2850s
	iters: 300, epoch: 1 | loss: 0.4410320
	speed: 0.0031s/iter; left time: 23.4408s
	iters: 400, epoch: 1 | loss: 0.7689134
	speed: 0.0034s/iter; left time: 25.2299s
	iters: 500, epoch: 1 | loss: 1.0607547
	speed: 0.0034s/iter; left time: 25.2776s
	iters: 600, epoch: 1 | loss: 0.8698047
	speed: 0.0034s/iter; left time: 24.5574s
	iters: 700, epoch: 1 | loss: 0.7562109
	speed: 0.0033s/iter; left time: 23.6047s
	iters: 800, epoch: 1 | loss: 0.3733390
	speed: 0.0033s/iter; left time: 23.4763s
	iters: 900, epoch: 1 | loss: 0.8025981
	speed: 0.0033s/iter; left time: 23.0950s
Updating learning rate to 0.0038309291073
Validation loss decreased (inf --> 0.6323).  Saving model state dict ...
Epoch: 1 cost time: 3.6101152896881104
Epoch: 1, Steps: 979 | Train Loss: 0.7734683 Vali Loss: 0.6323311 Best vali loss: 0.6323311
	iters: 100, epoch: 2 | loss: 0.7536098
	speed: 0.0113s/iter; left time: 76.0021s
	iters: 200, epoch: 2 | loss: 0.3156042
	speed: 0.0036s/iter; left time: 24.1124s
	iters: 300, epoch: 2 | loss: 1.4829901
	speed: 0.0036s/iter; left time: 23.4367s
	iters: 400, epoch: 2 | loss: 0.7875100
	speed: 0.0035s/iter; left time: 22.6750s
	iters: 500, epoch: 2 | loss: 0.4342520
	speed: 0.0035s/iter; left time: 22.1571s
	iters: 600, epoch: 2 | loss: 1.0906112
	speed: 0.0034s/iter; left time: 21.2749s
	iters: 700, epoch: 2 | loss: 0.7535420
	speed: 0.0033s/iter; left time: 20.5175s
	iters: 800, epoch: 2 | loss: 0.9746035
	speed: 0.0033s/iter; left time: 19.9629s
	iters: 900, epoch: 2 | loss: 1.1262921
	speed: 0.0032s/iter; left time: 18.9757s
Updating learning rate to 0.00191546455365
Epoch: 2 cost time: 3.368844985961914
Epoch: 2, Steps: 979 | Train Loss: 0.8576683 Vali Loss: 0.6411163 Best vali loss: 0.6323311
	iters: 100, epoch: 3 | loss: 0.7970543
	speed: 0.0106s/iter; left time: 61.4652s
	iters: 200, epoch: 3 | loss: 0.9037011
	speed: 0.0033s/iter; left time: 18.9437s
	iters: 300, epoch: 3 | loss: 0.9001828
	speed: 0.0033s/iter; left time: 18.6000s
	iters: 400, epoch: 3 | loss: 0.9233978
	speed: 0.0034s/iter; left time: 18.7897s
	iters: 500, epoch: 3 | loss: 1.0542219
	speed: 0.0032s/iter; left time: 17.4353s
	iters: 600, epoch: 3 | loss: 0.5738676
	speed: 0.0033s/iter; left time: 17.3823s
	iters: 700, epoch: 3 | loss: 1.9333159
	speed: 0.0034s/iter; left time: 17.3983s
	iters: 800, epoch: 3 | loss: 1.1477058
	speed: 0.0033s/iter; left time: 16.5789s
	iters: 900, epoch: 3 | loss: 0.2735901
	speed: 0.0034s/iter; left time: 16.8879s
Updating learning rate to 0.000957732276825
Epoch: 3 cost time: 3.3002359867095947
Epoch: 3, Steps: 979 | Train Loss: 0.9452264 Vali Loss: 0.6447338 Best vali loss: 0.6323311

best validation loss 0.6323310513288982

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0026874191286, 'e_layers': 2, 'learning_rate': 0.0002983261057, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8206177
	speed: 0.0102s/iter; left time: 24.0549s
	iters: 200, epoch: 4 | loss: 1.4136221
	speed: 0.0038s/iter; left time: 8.4559s
	iters: 300, epoch: 4 | loss: 1.3338889
	speed: 0.0038s/iter; left time: 8.0716s
	iters: 400, epoch: 4 | loss: 0.9819070
	speed: 0.0037s/iter; left time: 7.6747s
Updating learning rate to 0.00014916305285
Epoch: 4 cost time: 2.1918437480926514
Epoch: 4, Steps: 490 | Train Loss: 1.1375089 Vali Loss: 0.5551974 Best vali loss: 0.5497677
	iters: 100, epoch: 5 | loss: 0.4794579
	speed: 0.0106s/iter; left time: 19.7450s
	iters: 200, epoch: 5 | loss: 0.4781429
	speed: 0.0038s/iter; left time: 6.6305s
	iters: 300, epoch: 5 | loss: 0.7196068
	speed: 0.0038s/iter; left time: 6.2579s
	iters: 400, epoch: 5 | loss: 0.6859481
	speed: 0.0038s/iter; left time: 5.8668s
Updating learning rate to 9.208082380330671e-05
Epoch: 5 cost time: 1.8858654499053955
Epoch: 5, Steps: 490 | Train Loss: 0.5907889 Vali Loss: 0.5748246 Best vali loss: 0.5497677
	iters: 100, epoch: 6 | loss: 1.0650054
	speed: 0.0103s/iter; left time: 14.1897s
	iters: 200, epoch: 6 | loss: 0.7972980
	speed: 0.0036s/iter; left time: 4.5278s
	iters: 300, epoch: 6 | loss: 0.5825313
	speed: 0.0035s/iter; left time: 4.1487s
	iters: 400, epoch: 6 | loss: 0.5094794
	speed: 0.0035s/iter; left time: 3.7931s
Updating learning rate to 4.368884667727763e-05
Epoch: 6 cost time: 1.7811732292175293
Epoch: 6, Steps: 490 | Train Loss: 0.7385785 Vali Loss: 0.6142149 Best vali loss: 0.5497677
	iters: 100, epoch: 7 | loss: 0.8535680
	speed: 0.0099s/iter; left time: 8.7234s
	iters: 200, epoch: 7 | loss: 0.4682021
	speed: 0.0036s/iter; left time: 2.8390s
	iters: 300, epoch: 7 | loss: 0.4258811
	speed: 0.0034s/iter; left time: 2.3374s
	iters: 400, epoch: 7 | loss: 0.5169646
	speed: 0.0035s/iter; left time: 2.0376s
Updating learning rate to 1.1354361314985643e-05
Epoch: 7 cost time: 1.7684051990509033
Epoch: 7, Steps: 490 | Train Loss: 0.5661540 Vali Loss: 0.6231984 Best vali loss: 0.5497677
	iters: 100, epoch: 8 | loss: 0.6530646
	speed: 0.0102s/iter; left time: 3.9940s
	iters: 200, epoch: 8 | loss: 0.8073631
	speed: 0.0035s/iter; left time: 1.0175s
	iters: 300, epoch: 8 | loss: 0.6937447
	speed: 0.0033s/iter; left time: 0.6214s
	iters: 400, epoch: 8 | loss: 0.7001360
	speed: 0.0034s/iter; left time: 0.3120s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7373054027557373
Epoch: 8, Steps: 490 | Train Loss: 0.7135771 Vali Loss: 0.6297451 Best vali loss: 0.5497677

best validation loss 0.5497677350888259

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0018511960891, 'e_layers': 1, 'learning_rate': 0.0002509203201, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9498644
	speed: 0.0086s/iter; left time: 66.4378s
	iters: 200, epoch: 1 | loss: 1.1032323
	speed: 0.0026s/iter; left time: 19.4739s
	iters: 300, epoch: 1 | loss: 0.4113469
	speed: 0.0026s/iter; left time: 19.3663s
	iters: 400, epoch: 1 | loss: 0.3942075
	speed: 0.0025s/iter; left time: 18.4627s
	iters: 500, epoch: 1 | loss: 0.9128924
	speed: 0.0025s/iter; left time: 18.0548s
	iters: 600, epoch: 1 | loss: 1.1876066
	speed: 0.0025s/iter; left time: 17.9460s
	iters: 700, epoch: 1 | loss: 0.7103434
	speed: 0.0025s/iter; left time: 17.8367s
	iters: 800, epoch: 1 | loss: 2.1021142
	speed: 0.0025s/iter; left time: 17.5781s
	iters: 900, epoch: 1 | loss: 0.9928404
	speed: 0.0025s/iter; left time: 17.1184s
Updating learning rate to 0.00024137023406578523
Validation loss decreased (inf --> 0.6054).  Saving model state dict ...
Epoch: 1 cost time: 2.787707805633545
Epoch: 1, Steps: 979 | Train Loss: 0.9738276 Vali Loss: 0.6054292 Best vali loss: 0.6054292
	iters: 100, epoch: 2 | loss: 0.3965830
	speed: 0.0091s/iter; left time: 61.3230s
	iters: 200, epoch: 2 | loss: 0.9348503
	speed: 0.0024s/iter; left time: 16.2192s
	iters: 300, epoch: 2 | loss: 1.2582692
	speed: 0.0024s/iter; left time: 15.8977s
	iters: 400, epoch: 2 | loss: 0.6897858
	speed: 0.0024s/iter; left time: 15.5691s
	iters: 500, epoch: 2 | loss: 1.1713712
	speed: 0.0024s/iter; left time: 15.1157s
	iters: 600, epoch: 2 | loss: 1.0828232
	speed: 0.0024s/iter; left time: 14.8863s
	iters: 700, epoch: 2 | loss: 1.2822303
	speed: 0.0024s/iter; left time: 14.6455s
	iters: 800, epoch: 2 | loss: 1.0583872
	speed: 0.0024s/iter; left time: 14.4322s
	iters: 900, epoch: 2 | loss: 1.7630293
	speed: 0.0025s/iter; left time: 14.8445s
Updating learning rate to 0.0002141738899901046
Validation loss decreased (0.6054 --> 0.5993).  Saving model state dict ...
Epoch: 2 cost time: 2.4294686317443848
Epoch: 2, Steps: 979 | Train Loss: 1.0708144 Vali Loss: 0.5993019 Best vali loss: 0.5993019
	iters: 100, epoch: 3 | loss: 0.6981727
	speed: 0.0089s/iter; left time: 51.5461s
	iters: 200, epoch: 3 | loss: 0.8636723
	speed: 0.0024s/iter; left time: 13.5106s
	iters: 300, epoch: 3 | loss: 0.7964879
	speed: 0.0023s/iter; left time: 12.9688s
	iters: 400, epoch: 3 | loss: 0.5385002
	speed: 0.0023s/iter; left time: 12.5737s
	iters: 500, epoch: 3 | loss: 1.0519588
	speed: 0.0023s/iter; left time: 12.2658s
	iters: 600, epoch: 3 | loss: 1.0645814
	speed: 0.0023s/iter; left time: 12.0026s
	iters: 700, epoch: 3 | loss: 0.4169603
	speed: 0.0023s/iter; left time: 11.6656s
	iters: 800, epoch: 3 | loss: 1.0043255
	speed: 0.0023s/iter; left time: 11.7996s
	iters: 900, epoch: 3 | loss: 0.9553269
	speed: 0.0024s/iter; left time: 12.0778s
Updating learning rate to 0.00017347168472300753
Epoch: 3 cost time: 2.3351094722747803
Epoch: 3, Steps: 979 | Train Loss: 0.8211096 Vali Loss: 0.6138649 Best vali loss: 0.5993019
	iters: 100, epoch: 4 | loss: 0.8625813
	speed: 0.0087s/iter; left time: 41.7871s
	iters: 200, epoch: 4 | loss: 0.4650625
	speed: 0.0024s/iter; left time: 11.0852s
	iters: 300, epoch: 4 | loss: 0.4248945
	speed: 0.0023s/iter; left time: 10.7711s
	iters: 400, epoch: 4 | loss: 0.4947359
	speed: 0.0023s/iter; left time: 10.4819s
	iters: 500, epoch: 4 | loss: 0.5625961
	speed: 0.0023s/iter; left time: 10.0587s
	iters: 600, epoch: 4 | loss: 0.6862050
	speed: 0.0023s/iter; left time: 9.9086s
	iters: 700, epoch: 4 | loss: 0.5346121
	speed: 0.0023s/iter; left time: 9.7165s
	iters: 800, epoch: 4 | loss: 0.5386288
	speed: 0.0023s/iter; left time: 9.2691s
	iters: 900, epoch: 4 | loss: 0.5069758
	speed: 0.0022s/iter; left time: 8.8442s
Updating learning rate to 0.00012546016005
Epoch: 4 cost time: 2.2933871746063232
Epoch: 4, Steps: 979 | Train Loss: 0.5640324 Vali Loss: 0.6112397 Best vali loss: 0.5993019
	iters: 100, epoch: 5 | loss: 0.9872647
	speed: 0.0091s/iter; left time: 34.6391s
	iters: 200, epoch: 5 | loss: 1.1794158
	speed: 0.0024s/iter; left time: 8.7443s
	iters: 300, epoch: 5 | loss: 0.8386760
	speed: 0.0024s/iter; left time: 8.7138s
	iters: 400, epoch: 5 | loss: 0.7071020
	speed: 0.0024s/iter; left time: 8.4300s
	iters: 500, epoch: 5 | loss: 0.7872037
	speed: 0.0023s/iter; left time: 7.8854s
	iters: 600, epoch: 5 | loss: 0.4336564
	speed: 0.0024s/iter; left time: 7.8147s
	iters: 700, epoch: 5 | loss: 0.4908744
	speed: 0.0024s/iter; left time: 7.6013s
	iters: 800, epoch: 5 | loss: 1.7003740
	speed: 0.0024s/iter; left time: 7.5700s
	iters: 900, epoch: 5 | loss: 0.8332719
	speed: 0.0025s/iter; left time: 7.6933s
Updating learning rate to 7.74486353769925e-05
Epoch: 5 cost time: 2.404844045639038
Epoch: 5, Steps: 979 | Train Loss: 0.8842043 Vali Loss: 0.6015090 Best vali loss: 0.5993019
	iters: 100, epoch: 6 | loss: 0.9243259
	speed: 0.0088s/iter; left time: 24.9267s
	iters: 200, epoch: 6 | loss: 1.0204464
	speed: 0.0023s/iter; left time: 6.3169s
	iters: 300, epoch: 6 | loss: 0.4135425
	speed: 0.0024s/iter; left time: 6.2140s
	iters: 400, epoch: 6 | loss: 1.1495789
	speed: 0.0024s/iter; left time: 5.9722s
	iters: 500, epoch: 6 | loss: 0.3401323
	speed: 0.0023s/iter; left time: 5.6279s
	iters: 600, epoch: 6 | loss: 1.0012065
	speed: 0.0024s/iter; left time: 5.5679s
	iters: 700, epoch: 6 | loss: 0.3557575
	speed: 0.0024s/iter; left time: 5.2664s
	iters: 800, epoch: 6 | loss: 1.8638252
	speed: 0.0024s/iter; left time: 5.0345s
	iters: 900, epoch: 6 | loss: 0.8154046
	speed: 0.0025s/iter; left time: 5.1648s
Updating learning rate to 3.674643010989543e-05
Epoch: 6 cost time: 2.3584861755371094
Epoch: 6, Steps: 979 | Train Loss: 0.8760244 Vali Loss: 0.6281599 Best vali loss: 0.5993019
	iters: 100, epoch: 7 | loss: 0.9418581
	speed: 0.0091s/iter; left time: 16.9601s
	iters: 200, epoch: 7 | loss: 1.3947248
	speed: 0.0024s/iter; left time: 4.2278s
	iters: 300, epoch: 7 | loss: 0.8931116
	speed: 0.0024s/iter; left time: 3.9411s
	iters: 400, epoch: 7 | loss: 0.5644237
	speed: 0.0024s/iter; left time: 3.7284s
	iters: 500, epoch: 7 | loss: 0.6429107
	speed: 0.0024s/iter; left time: 3.5041s
	iters: 600, epoch: 7 | loss: 0.3846085
	speed: 0.0024s/iter; left time: 3.2249s
	iters: 700, epoch: 7 | loss: 0.7747213
	speed: 0.0023s/iter; left time: 2.9384s
	iters: 800, epoch: 7 | loss: 0.8012922
	speed: 0.0023s/iter; left time: 2.6764s
	iters: 900, epoch: 7 | loss: 0.6119978
	speed: 0.0023s/iter; left time: 2.4546s
Updating learning rate to 9.550086034214788e-06
Epoch: 7 cost time: 2.3688571453094482
Epoch: 7, Steps: 979 | Train Loss: 0.7788499 Vali Loss: 0.6264323 Best vali loss: 0.5993019
	iters: 100, epoch: 8 | loss: 0.9228706
	speed: 0.0091s/iter; left time: 7.9648s
	iters: 200, epoch: 8 | loss: 1.5887026
	speed: 0.0024s/iter; left time: 1.9104s
	iters: 300, epoch: 8 | loss: 0.5289003
	speed: 0.0025s/iter; left time: 1.6744s
	iters: 400, epoch: 8 | loss: 0.7293786
	speed: 0.0025s/iter; left time: 1.4438s
	iters: 500, epoch: 8 | loss: 0.7421679
	speed: 0.0025s/iter; left time: 1.1890s
	iters: 600, epoch: 8 | loss: 0.3914306
	speed: 0.0025s/iter; left time: 0.9329s
	iters: 700, epoch: 8 | loss: 0.6029303
	speed: 0.0025s/iter; left time: 0.6893s
	iters: 800, epoch: 8 | loss: 0.3700566
	speed: 0.0026s/iter; left time: 0.4639s
	iters: 900, epoch: 8 | loss: 1.1778876
	speed: 0.0024s/iter; left time: 0.1954s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.482846975326538
Epoch: 8, Steps: 979 | Train Loss: 0.7838139 Vali Loss: 0.6301618 Best vali loss: 0.5993019

best validation loss 0.5993018878217871

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488615496, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4809130
	speed: 0.0098s/iter; left time: 37.3217s
	iters: 200, epoch: 1 | loss: 1.1573547
	speed: 0.0033s/iter; left time: 12.3930s
	iters: 300, epoch: 1 | loss: 0.9500439
	speed: 0.0032s/iter; left time: 11.6905s
	iters: 400, epoch: 1 | loss: 0.9378547
	speed: 0.0033s/iter; left time: 11.4565s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.5991).  Saving model state dict ...
Epoch: 1 cost time: 1.9720420837402344
Epoch: 1, Steps: 490 | Train Loss: 1.1315416 Vali Loss: 0.5990655 Best vali loss: 0.5990655
	iters: 100, epoch: 2 | loss: 0.2769994
	speed: 0.0102s/iter; left time: 34.0350s
	iters: 200, epoch: 2 | loss: 1.0677186
	speed: 0.0035s/iter; left time: 11.2541s
	iters: 300, epoch: 2 | loss: 1.2373979
	speed: 0.0034s/iter; left time: 10.6227s
	iters: 400, epoch: 2 | loss: 0.3893996
	speed: 0.0034s/iter; left time: 10.3521s
Updating learning rate to 0.0002540886619071902
Epoch: 2 cost time: 1.725142240524292
Epoch: 2, Steps: 490 | Train Loss: 0.7428789 Vali Loss: 0.6010890 Best vali loss: 0.5990655
	iters: 100, epoch: 3 | loss: 1.0338283
	speed: 0.0098s/iter; left time: 27.8642s
	iters: 200, epoch: 3 | loss: 0.9078755
	speed: 0.0033s/iter; left time: 9.0696s
	iters: 300, epoch: 3 | loss: 0.3842447
	speed: 0.0033s/iter; left time: 8.7865s
	iters: 400, epoch: 3 | loss: 1.5353608
	speed: 0.0034s/iter; left time: 8.5727s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5991 --> 0.5455).  Saving model state dict ...
Epoch: 3 cost time: 1.6868436336517334
Epoch: 3, Steps: 490 | Train Loss: 0.9653273 Vali Loss: 0.5454562 Best vali loss: 0.5454562
	iters: 100, epoch: 4 | loss: 0.5248836
	speed: 0.0103s/iter; left time: 24.2918s
	iters: 200, epoch: 4 | loss: 0.7488045
	speed: 0.0035s/iter; left time: 7.7877s
	iters: 300, epoch: 4 | loss: 1.0437089
	speed: 0.0034s/iter; left time: 7.2963s
	iters: 400, epoch: 4 | loss: 0.5634089
	speed: 0.0034s/iter; left time: 7.0206s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 1.727022409439087
Epoch: 4, Steps: 490 | Train Loss: 0.7202015 Vali Loss: 0.5607272 Best vali loss: 0.5454562
	iters: 100, epoch: 5 | loss: 0.5002443
	speed: 0.0100s/iter; left time: 18.5690s
	iters: 200, epoch: 5 | loss: 0.6799326
	speed: 0.0035s/iter; left time: 6.0826s
	iters: 300, epoch: 5 | loss: 0.6523354
	speed: 0.0033s/iter; left time: 5.5553s
	iters: 400, epoch: 5 | loss: 0.7996933
	speed: 0.0033s/iter; left time: 5.2206s
Updating learning rate to 9.188244248814415e-05
Epoch: 5 cost time: 1.7071638107299805
Epoch: 5, Steps: 490 | Train Loss: 0.6580514 Vali Loss: 0.5663205 Best vali loss: 0.5454562
	iters: 100, epoch: 6 | loss: 0.6582716
	speed: 0.0101s/iter; left time: 13.7872s
	iters: 200, epoch: 6 | loss: 0.3472800
	speed: 0.0036s/iter; left time: 4.6209s
	iters: 300, epoch: 6 | loss: 1.4651340
	speed: 0.0038s/iter; left time: 4.4537s
	iters: 400, epoch: 6 | loss: 0.5209366
	speed: 0.0037s/iter; left time: 4.0063s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 1.87619948387146
Epoch: 6, Steps: 490 | Train Loss: 0.7479056 Vali Loss: 0.5750211 Best vali loss: 0.5454562
	iters: 100, epoch: 7 | loss: 0.9327392
	speed: 0.0107s/iter; left time: 9.4501s
	iters: 200, epoch: 7 | loss: 0.7280186
	speed: 0.0037s/iter; left time: 2.8977s
	iters: 300, epoch: 7 | loss: 0.7235293
	speed: 0.0037s/iter; left time: 2.4884s
	iters: 400, epoch: 7 | loss: 0.6097781
	speed: 0.0036s/iter; left time: 2.0627s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 1.8545243740081787
Epoch: 7, Steps: 490 | Train Loss: 0.7485163 Vali Loss: 0.5960139 Best vali loss: 0.5454562
	iters: 100, epoch: 8 | loss: 0.5002716
	speed: 0.0104s/iter; left time: 4.0579s
	iters: 200, epoch: 8 | loss: 0.5921963
	speed: 0.0035s/iter; left time: 1.0062s
	iters: 300, epoch: 8 | loss: 0.7744317
	speed: 0.0032s/iter; left time: 0.6116s
	iters: 400, epoch: 8 | loss: 0.6385350
	speed: 0.0032s/iter; left time: 0.2883s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6798298358917236
Epoch: 8, Steps: 490 | Train Loss: 0.6263586 Vali Loss: 0.5919467 Best vali loss: 0.5454562

best validation loss 0.5454561704565452

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002981267771, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7746105
	speed: 0.0118s/iter; left time: 10.4631s
Updating learning rate to 0.0002867800022781223
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0204520225524902
Epoch: 1, Steps: 123 | Train Loss: 0.7746105 Vali Loss: 0.6173303 Best vali loss: 0.6173303
	iters: 100, epoch: 2 | loss: 0.9479271
	speed: 0.0093s/iter; left time: 7.0495s
Updating learning rate to 0.00025446712142035015
Epoch: 2 cost time: 0.7222387790679932
Epoch: 2, Steps: 123 | Train Loss: 0.9479271 Vali Loss: 0.6224613 Best vali loss: 0.6173303
	iters: 100, epoch: 3 | loss: 0.8470792
	speed: 0.0091s/iter; left time: 5.7911s
Updating learning rate to 0.000206107477720285
Validation loss decreased (0.6173 --> 0.5510).  Saving model state dict ...
Epoch: 3 cost time: 0.7268145084381104
Epoch: 3, Steps: 123 | Train Loss: 0.8470792 Vali Loss: 0.5510213 Best vali loss: 0.5510213

best validation loss 0.5510212612449985

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0056254770099, 'e_layers': 2, 'learning_rate': 0.0002971452748, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4810648
	speed: 0.0103s/iter; left time: 39.1878s
	iters: 200, epoch: 1 | loss: 1.1584986
	speed: 0.0036s/iter; left time: 13.5622s
	iters: 300, epoch: 1 | loss: 0.9363447
	speed: 0.0038s/iter; left time: 13.6051s
	iters: 400, epoch: 1 | loss: 0.9800029
	speed: 0.0037s/iter; left time: 13.0506s
Updating learning rate to 0.0002858358561850809
Validation loss decreased (inf --> 0.5891).  Saving model state dict ...
Epoch: 1 cost time: 2.1834301948547363
Epoch: 1, Steps: 490 | Train Loss: 1.1389778 Vali Loss: 0.5891302 Best vali loss: 0.5891302
	iters: 100, epoch: 2 | loss: 0.2946554
	speed: 0.0108s/iter; left time: 35.9736s
	iters: 200, epoch: 2 | loss: 1.0553998
	speed: 0.0037s/iter; left time: 11.9432s
	iters: 300, epoch: 2 | loss: 1.5271595
	speed: 0.0038s/iter; left time: 11.9439s
	iters: 400, epoch: 2 | loss: 0.4039058
	speed: 0.0036s/iter; left time: 10.8519s
Updating learning rate to 0.00025362935680431006
Epoch: 2 cost time: 1.8676111698150635
Epoch: 2, Steps: 490 | Train Loss: 0.8202801 Vali Loss: 0.6244091 Best vali loss: 0.5891302
	iters: 100, epoch: 3 | loss: 1.0071578
	speed: 0.0106s/iter; left time: 29.9817s
	iters: 200, epoch: 3 | loss: 0.9189857
	speed: 0.0034s/iter; left time: 9.4334s
	iters: 300, epoch: 3 | loss: 0.3797929
	speed: 0.0033s/iter; left time: 8.8291s
	iters: 400, epoch: 3 | loss: 1.5304327
	speed: 0.0033s/iter; left time: 8.4322s
Updating learning rate to 0.00020542892423576592
Validation loss decreased (0.5891 --> 0.5811).  Saving model state dict ...
Epoch: 3 cost time: 1.6877992153167725
Epoch: 3, Steps: 490 | Train Loss: 0.9590923 Vali Loss: 0.5811332 Best vali loss: 0.5811332

best validation loss 0.5811331725779754

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0040228292599, 'e_layers': 3, 'learning_rate': 0.0001832885027, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6945215
	speed: 0.0113s/iter; left time: 43.0207s
	iters: 200, epoch: 1 | loss: 0.8841650
	speed: 0.0047s/iter; left time: 17.5121s
	iters: 300, epoch: 1 | loss: 0.4039767
	speed: 0.0045s/iter; left time: 16.2601s
	iters: 400, epoch: 1 | loss: 0.9670655
	speed: 0.0046s/iter; left time: 16.1110s
Updating learning rate to 0.0001832885027
Validation loss decreased (inf --> 0.6312).  Saving model state dict ...
Epoch: 1 cost time: 2.6370458602905273
Epoch: 1, Steps: 490 | Train Loss: 0.7374322 Vali Loss: 0.6311630 Best vali loss: 0.6311630
	iters: 100, epoch: 2 | loss: 1.0376980
	speed: 0.0126s/iter; left time: 42.1111s
	iters: 200, epoch: 2 | loss: 0.7167636
	speed: 0.0046s/iter; left time: 14.8897s
	iters: 300, epoch: 2 | loss: 0.9606497
	speed: 0.0045s/iter; left time: 14.2035s
	iters: 400, epoch: 2 | loss: 0.7433890
	speed: 0.0046s/iter; left time: 13.8147s
Updating learning rate to 9.164425135e-05
Validation loss decreased (0.6312 --> 0.5846).  Saving model state dict ...
Epoch: 2 cost time: 2.2566802501678467
Epoch: 2, Steps: 490 | Train Loss: 0.8646251 Vali Loss: 0.5845870 Best vali loss: 0.5845870
	iters: 100, epoch: 3 | loss: 1.3535879
	speed: 0.0125s/iter; left time: 35.6321s
	iters: 200, epoch: 3 | loss: 0.5191275
	speed: 0.0042s/iter; left time: 11.4813s
	iters: 300, epoch: 3 | loss: 0.7823130
	speed: 0.0041s/iter; left time: 10.7505s
	iters: 400, epoch: 3 | loss: 0.5685658
	speed: 0.0041s/iter; left time: 10.3085s
Updating learning rate to 4.5822125675e-05
Validation loss decreased (0.5846 --> 0.5634).  Saving model state dict ...
Epoch: 3 cost time: 2.1207435131073
Epoch: 3, Steps: 490 | Train Loss: 0.8058985 Vali Loss: 0.5634061 Best vali loss: 0.5634061

best validation loss 0.5634060743670395

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002981267771, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5824064
	speed: 0.0122s/iter; left time: 6.2927s
Updating learning rate to 0.00014906338855
Validation loss decreased (0.5510 --> 0.5354).  Saving model state dict ...
Epoch: 4 cost time: 1.0273945331573486
Epoch: 4, Steps: 123 | Train Loss: 0.5824064 Vali Loss: 0.5354072 Best vali loss: 0.5354072
	iters: 100, epoch: 5 | loss: 0.8302211
	speed: 0.0094s/iter; left time: 3.6848s
Updating learning rate to 9.201929937971498e-05
Validation loss decreased (0.5354 --> 0.5307).  Saving model state dict ...
Epoch: 5 cost time: 0.7180378437042236
Epoch: 5, Steps: 123 | Train Loss: 0.8302211 Vali Loss: 0.5307047 Best vali loss: 0.5307047
	iters: 100, epoch: 6 | loss: 0.7573206
	speed: 0.0093s/iter; left time: 2.5229s
Updating learning rate to 4.365965567964984e-05
Epoch: 6 cost time: 0.7230749130249023
Epoch: 6, Steps: 123 | Train Loss: 0.7573206 Vali Loss: 0.5331633 Best vali loss: 0.5307047
	iters: 100, epoch: 7 | loss: 0.4432655
	speed: 0.0091s/iter; left time: 1.3443s
Updating learning rate to 1.1346774821877707e-05
Epoch: 7 cost time: 0.7234175205230713
Epoch: 7, Steps: 123 | Train Loss: 0.4432655 Vali Loss: 0.5337831 Best vali loss: 0.5307047
	iters: 100, epoch: 8 | loss: 0.5047206
	speed: 0.0090s/iter; left time: 0.2154s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7177844047546387
Epoch: 8, Steps: 123 | Train Loss: 0.5047206 Vali Loss: 0.5372862 Best vali loss: 0.5307047

best validation loss 0.5307047138165567

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0076669604645, 'e_layers': 3, 'learning_rate': 0.0003825362091, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8351792
	speed: 0.0132s/iter; left time: 11.7097s
Updating learning rate to 0.0003825362091
Validation loss decreased (inf --> 0.6290).  Saving model state dict ...
Epoch: 1 cost time: 1.2284245491027832
Epoch: 1, Steps: 123 | Train Loss: 0.8351792 Vali Loss: 0.6290139 Best vali loss: 0.6290139
	iters: 100, epoch: 2 | loss: 1.0241756
	speed: 0.0116s/iter; left time: 8.8091s
Updating learning rate to 0.00019126810455
Validation loss decreased (0.6290 --> 0.5800).  Saving model state dict ...
Epoch: 2 cost time: 0.9268395900726318
Epoch: 2, Steps: 123 | Train Loss: 1.0241756 Vali Loss: 0.5799744 Best vali loss: 0.5799744
	iters: 100, epoch: 3 | loss: 0.6253661
	speed: 0.0117s/iter; left time: 7.4572s
Updating learning rate to 9.5634052275e-05
Validation loss decreased (0.5800 --> 0.5477).  Saving model state dict ...
Epoch: 3 cost time: 0.9350981712341309
Epoch: 3, Steps: 123 | Train Loss: 0.6253661 Vali Loss: 0.5477220 Best vali loss: 0.5477220
	iters: 100, epoch: 4 | loss: 0.7696179
	speed: 0.0117s/iter; left time: 6.0131s
Updating learning rate to 4.78170261375e-05
Validation loss decreased (0.5477 --> 0.5453).  Saving model state dict ...
Epoch: 4 cost time: 0.9270315170288086
Epoch: 4, Steps: 123 | Train Loss: 0.7696179 Vali Loss: 0.5453473 Best vali loss: 0.5453473
	iters: 100, epoch: 5 | loss: 0.6534620
	speed: 0.0116s/iter; left time: 4.5478s
Updating learning rate to 2.390851306875e-05
Epoch: 5 cost time: 0.9319803714752197
Epoch: 5, Steps: 123 | Train Loss: 0.6534620 Vali Loss: 0.5518321 Best vali loss: 0.5453473
	iters: 100, epoch: 6 | loss: 0.7065015
	speed: 0.0113s/iter; left time: 3.0577s
Updating learning rate to 1.1954256534375e-05
Epoch: 6 cost time: 0.9328896999359131
Epoch: 6, Steps: 123 | Train Loss: 0.7065015 Vali Loss: 0.5483872 Best vali loss: 0.5453473
	iters: 100, epoch: 7 | loss: 0.7596354
	speed: 0.0112s/iter; left time: 1.6525s
Updating learning rate to 5.9771282671875e-06
Epoch: 7 cost time: 0.9288301467895508
Epoch: 7, Steps: 123 | Train Loss: 0.7596354 Vali Loss: 0.5534750 Best vali loss: 0.5453473
	iters: 100, epoch: 8 | loss: 0.8607331
	speed: 0.0112s/iter; left time: 0.2700s
Updating learning rate to 2.98856413359375e-06
Epoch: 8 cost time: 0.932762622833252
Epoch: 8, Steps: 123 | Train Loss: 0.8607331 Vali Loss: 0.5514583 Best vali loss: 0.5453473

best validation loss 0.5453472772939841

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0038575978357, 'e_layers': 2, 'learning_rate': 0.0001721202962, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6111024
	speed: 0.0095s/iter; left time: 73.5202s
	iters: 200, epoch: 1 | loss: 0.9382166
	speed: 0.0031s/iter; left time: 23.2961s
	iters: 300, epoch: 1 | loss: 1.5606707
	speed: 0.0030s/iter; left time: 22.7714s
	iters: 400, epoch: 1 | loss: 2.0033271
	speed: 0.0030s/iter; left time: 22.4095s
	iters: 500, epoch: 1 | loss: 1.0031890
	speed: 0.0031s/iter; left time: 22.6962s
	iters: 600, epoch: 1 | loss: 0.9199883
	speed: 0.0030s/iter; left time: 21.8812s
	iters: 700, epoch: 1 | loss: 0.7687603
	speed: 0.0030s/iter; left time: 21.0582s
	iters: 800, epoch: 1 | loss: 0.6656674
	speed: 0.0031s/iter; left time: 22.1039s
	iters: 900, epoch: 1 | loss: 1.1346833
	speed: 0.0030s/iter; left time: 20.7201s
Updating learning rate to 0.0001655693574944801
Validation loss decreased (inf --> 0.6235).  Saving model state dict ...
Epoch: 1 cost time: 3.334482192993164
Epoch: 1, Steps: 979 | Train Loss: 1.0672895 Vali Loss: 0.6235040 Best vali loss: 0.6235040
	iters: 100, epoch: 2 | loss: 1.0333658
	speed: 0.0102s/iter; left time: 69.1583s
	iters: 200, epoch: 2 | loss: 0.8466954
	speed: 0.0031s/iter; left time: 20.3268s
	iters: 300, epoch: 2 | loss: 0.3234490
	speed: 0.0030s/iter; left time: 19.8754s
	iters: 400, epoch: 2 | loss: 0.6842299
	speed: 0.0031s/iter; left time: 19.9833s
	iters: 500, epoch: 2 | loss: 0.6603416
	speed: 0.0031s/iter; left time: 19.4249s
	iters: 600, epoch: 2 | loss: 1.2660371
	speed: 0.0030s/iter; left time: 18.9944s
	iters: 700, epoch: 2 | loss: 0.9188766
	speed: 0.0030s/iter; left time: 18.7520s
	iters: 800, epoch: 2 | loss: 0.5800580
	speed: 0.0030s/iter; left time: 18.4417s
	iters: 900, epoch: 2 | loss: 0.5362615
	speed: 0.0030s/iter; left time: 17.9432s
Updating learning rate to 0.00014691386241142857
Validation loss decreased (0.6235 --> 0.6097).  Saving model state dict ...
Epoch: 2 cost time: 3.0236623287200928
Epoch: 2, Steps: 979 | Train Loss: 0.7610350 Vali Loss: 0.6096902 Best vali loss: 0.6096902
	iters: 100, epoch: 3 | loss: 0.6155690
	speed: 0.0104s/iter; left time: 60.0697s
	iters: 200, epoch: 3 | loss: 1.6510103
	speed: 0.0030s/iter; left time: 16.8839s
	iters: 300, epoch: 3 | loss: 1.2397782
	speed: 0.0030s/iter; left time: 16.5487s
	iters: 400, epoch: 3 | loss: 0.4476597
	speed: 0.0030s/iter; left time: 16.5688s
	iters: 500, epoch: 3 | loss: 1.3622109
	speed: 0.0031s/iter; left time: 16.4146s
	iters: 600, epoch: 3 | loss: 1.3893595
	speed: 0.0031s/iter; left time: 16.1660s
	iters: 700, epoch: 3 | loss: 1.9589299
	speed: 0.0030s/iter; left time: 15.7228s
	iters: 800, epoch: 3 | loss: 0.8937756
	speed: 0.0031s/iter; left time: 15.5586s
	iters: 900, epoch: 3 | loss: 0.7012321
	speed: 0.0030s/iter; left time: 15.0670s
Updating learning rate to 0.00011899394096475596
Validation loss decreased (0.6097 --> 0.6021).  Saving model state dict ...
Epoch: 3 cost time: 3.012946605682373
Epoch: 3, Steps: 979 | Train Loss: 1.1399472 Vali Loss: 0.6020654 Best vali loss: 0.6020654
	iters: 100, epoch: 4 | loss: 0.5119773
	speed: 0.0114s/iter; left time: 54.8426s
	iters: 200, epoch: 4 | loss: 0.8901389
	speed: 0.0030s/iter; left time: 14.0584s
	iters: 300, epoch: 4 | loss: 0.5194693
	speed: 0.0029s/iter; left time: 13.1670s
	iters: 400, epoch: 4 | loss: 0.5933185
	speed: 0.0029s/iter; left time: 13.1435s
	iters: 500, epoch: 4 | loss: 0.9553940
	speed: 0.0030s/iter; left time: 13.3678s
	iters: 600, epoch: 4 | loss: 0.7648802
	speed: 0.0030s/iter; left time: 13.0682s
	iters: 700, epoch: 4 | loss: 0.5912181
	speed: 0.0030s/iter; left time: 12.7525s
	iters: 800, epoch: 4 | loss: 0.4371911
	speed: 0.0029s/iter; left time: 12.0297s
	iters: 900, epoch: 4 | loss: 0.4235029
	speed: 0.0031s/iter; left time: 12.3358s
Updating learning rate to 8.60601481e-05
Epoch: 4 cost time: 3.031442403793335
Epoch: 4, Steps: 979 | Train Loss: 0.6318989 Vali Loss: 0.6080450 Best vali loss: 0.6020654
	iters: 100, epoch: 5 | loss: 1.0665874
	speed: 0.0108s/iter; left time: 41.3046s
	iters: 200, epoch: 5 | loss: 0.6831649
	speed: 0.0033s/iter; left time: 12.3664s
	iters: 300, epoch: 5 | loss: 0.6663749
	speed: 0.0030s/iter; left time: 11.0005s
	iters: 400, epoch: 5 | loss: 0.5818183
	speed: 0.0032s/iter; left time: 11.2415s
	iters: 500, epoch: 5 | loss: 0.5529771
	speed: 0.0032s/iter; left time: 10.8703s
	iters: 600, epoch: 5 | loss: 0.6482221
	speed: 0.0031s/iter; left time: 10.1383s
	iters: 700, epoch: 5 | loss: 0.5234030
	speed: 0.0030s/iter; left time: 9.6698s
	iters: 800, epoch: 5 | loss: 0.6095179
	speed: 0.0032s/iter; left time: 10.1033s
	iters: 900, epoch: 5 | loss: 0.7159169
	speed: 0.0033s/iter; left time: 9.9290s
Updating learning rate to 5.3126355235244045e-05
Epoch: 5 cost time: 3.1475608348846436
Epoch: 5, Steps: 979 | Train Loss: 0.6719981 Vali Loss: 0.6021308 Best vali loss: 0.6020654
	iters: 100, epoch: 6 | loss: 0.6629949
	speed: 0.0106s/iter; left time: 30.0474s
	iters: 200, epoch: 6 | loss: 0.5745518
	speed: 0.0031s/iter; left time: 8.5343s
	iters: 300, epoch: 6 | loss: 1.1458526
	speed: 0.0031s/iter; left time: 8.2091s
	iters: 400, epoch: 6 | loss: 1.2784638
	speed: 0.0031s/iter; left time: 7.8467s
	iters: 500, epoch: 6 | loss: 0.2783341
	speed: 0.0031s/iter; left time: 7.6466s
	iters: 600, epoch: 6 | loss: 0.7334394
	speed: 0.0032s/iter; left time: 7.3950s
	iters: 700, epoch: 6 | loss: 0.3321059
	speed: 0.0031s/iter; left time: 7.0482s
	iters: 800, epoch: 6 | loss: 0.5389333
	speed: 0.0032s/iter; left time: 6.7471s
	iters: 900, epoch: 6 | loss: 0.5068080
	speed: 0.0030s/iter; left time: 6.1171s
Updating learning rate to 2.520643378857143e-05
Validation loss decreased (0.6021 --> 0.5999).  Saving model state dict ...
Epoch: 6 cost time: 3.0805885791778564
Epoch: 6, Steps: 979 | Train Loss: 0.6723871 Vali Loss: 0.5998684 Best vali loss: 0.5998684
	iters: 100, epoch: 7 | loss: 0.9349252
	speed: 0.0111s/iter; left time: 20.7001s
	iters: 200, epoch: 7 | loss: 0.7857413
	speed: 0.0031s/iter; left time: 5.4917s
	iters: 300, epoch: 7 | loss: 1.0342002
	speed: 0.0032s/iter; left time: 5.3318s
	iters: 400, epoch: 7 | loss: 0.7603674
	speed: 0.0032s/iter; left time: 4.9247s
	iters: 500, epoch: 7 | loss: 0.5138937
	speed: 0.0031s/iter; left time: 4.5646s
	iters: 600, epoch: 7 | loss: 0.4557611
	speed: 0.0032s/iter; left time: 4.3194s
	iters: 700, epoch: 7 | loss: 0.2940803
	speed: 0.0032s/iter; left time: 3.9780s
	iters: 800, epoch: 7 | loss: 1.2680304
	speed: 0.0032s/iter; left time: 3.6613s
	iters: 900, epoch: 7 | loss: 1.5260993
	speed: 0.0031s/iter; left time: 3.3018s
Updating learning rate to 6.550938705519898e-06
Epoch: 7 cost time: 3.1403145790100098
Epoch: 7, Steps: 979 | Train Loss: 0.8414554 Vali Loss: 0.6016340 Best vali loss: 0.5998684
	iters: 100, epoch: 8 | loss: 0.8714041
	speed: 0.0109s/iter; left time: 9.5517s
	iters: 200, epoch: 8 | loss: 0.2804438
	speed: 0.0031s/iter; left time: 2.4038s
	iters: 300, epoch: 8 | loss: 0.7730237
	speed: 0.0032s/iter; left time: 2.1640s
	iters: 400, epoch: 8 | loss: 0.7502502
	speed: 0.0031s/iter; left time: 1.7883s
	iters: 500, epoch: 8 | loss: 1.5450619
	speed: 0.0031s/iter; left time: 1.5005s
	iters: 600, epoch: 8 | loss: 0.7580721
	speed: 0.0032s/iter; left time: 1.1973s
	iters: 700, epoch: 8 | loss: 0.8760944
	speed: 0.0031s/iter; left time: 0.8583s
	iters: 800, epoch: 8 | loss: 1.4762051
	speed: 0.0032s/iter; left time: 0.5749s
	iters: 900, epoch: 8 | loss: 1.0083210
	speed: 0.0033s/iter; left time: 0.2653s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.129607915878296
Epoch: 8, Steps: 979 | Train Loss: 0.9265418 Vali Loss: 0.6024960 Best vali loss: 0.5998684

best validation loss 0.5998683679109368

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977985857, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744507
	speed: 0.0119s/iter; left time: 10.5223s
Updating learning rate to 0.00028646430191951917
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0382201671600342
Epoch: 1, Steps: 123 | Train Loss: 0.7744507 Vali Loss: 0.6173030 Best vali loss: 0.6173030
	iters: 100, epoch: 2 | loss: 0.9634249
	speed: 0.0093s/iter; left time: 7.0728s
Updating learning rate to 0.0002541869925381166
Validation loss decreased (0.6173 --> 0.5571).  Saving model state dict ...
Epoch: 2 cost time: 0.7170295715332031
Epoch: 2, Steps: 123 | Train Loss: 0.9634249 Vali Loss: 0.5570841 Best vali loss: 0.5570841
	iters: 100, epoch: 3 | loss: 0.8512326
	speed: 0.0093s/iter; left time: 5.9643s
Updating learning rate to 0.0002058805853145727
Validation loss decreased (0.5571 --> 0.5443).  Saving model state dict ...
Epoch: 3 cost time: 0.720299243927002
Epoch: 3, Steps: 123 | Train Loss: 0.8512326 Vali Loss: 0.5443017 Best vali loss: 0.5443017

best validation loss 0.5443017187906272

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0016226674269, 'e_layers': 3, 'learning_rate': 0.0001379281466, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2267483
	speed: 0.0112s/iter; left time: 20.7730s
	iters: 200, epoch: 1 | loss: 0.8877265
	speed: 0.0050s/iter; left time: 8.7976s
Updating learning rate to 0.0001379281466
Validation loss decreased (inf --> 0.6112).  Saving model state dict ...
Epoch: 1 cost time: 1.563366413116455
Epoch: 1, Steps: 245 | Train Loss: 1.0572374 Vali Loss: 0.6112446 Best vali loss: 0.6112446
	iters: 100, epoch: 2 | loss: 0.7935985
	speed: 0.0094s/iter; left time: 15.1573s
	iters: 200, epoch: 2 | loss: 0.6586565
	speed: 0.0049s/iter; left time: 7.3784s
Updating learning rate to 6.89640733e-05
Validation loss decreased (0.6112 --> 0.6030).  Saving model state dict ...
Epoch: 2 cost time: 1.2091147899627686
Epoch: 2, Steps: 245 | Train Loss: 0.7261275 Vali Loss: 0.6030217 Best vali loss: 0.6030217
	iters: 100, epoch: 3 | loss: 1.0349503
	speed: 0.0095s/iter; left time: 13.0143s
	iters: 200, epoch: 3 | loss: 0.7317834
	speed: 0.0047s/iter; left time: 6.0063s
Updating learning rate to 3.448203665e-05
Validation loss decreased (0.6030 --> 0.5965).  Saving model state dict ...
Epoch: 3 cost time: 1.2128512859344482
Epoch: 3, Steps: 245 | Train Loss: 0.8833668 Vali Loss: 0.5965485 Best vali loss: 0.5965485

best validation loss 0.596548537615547

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0052765757526, 'e_layers': 4, 'learning_rate': 0.0003017534613, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0324330
	speed: 0.0114s/iter; left time: 88.4766s
	iters: 200, epoch: 1 | loss: 0.7721995
	speed: 0.0052s/iter; left time: 39.8891s
	iters: 300, epoch: 1 | loss: 0.2284166
	speed: 0.0052s/iter; left time: 38.8502s
	iters: 400, epoch: 1 | loss: 0.7682171
	speed: 0.0053s/iter; left time: 39.1532s
	iters: 500, epoch: 1 | loss: 0.8409382
	speed: 0.0053s/iter; left time: 38.6994s
	iters: 600, epoch: 1 | loss: 0.9447480
	speed: 0.0052s/iter; left time: 37.6406s
	iters: 700, epoch: 1 | loss: 0.9234627
	speed: 0.0052s/iter; left time: 36.9322s
	iters: 800, epoch: 1 | loss: 0.8022470
	speed: 0.0051s/iter; left time: 36.1643s
	iters: 900, epoch: 1 | loss: 1.5281754
	speed: 0.0046s/iter; left time: 32.2274s
Updating learning rate to 0.00029026865402975336
Validation loss decreased (inf --> 0.6124).  Saving model state dict ...
Epoch: 1 cost time: 5.3586883544921875
Epoch: 1, Steps: 979 | Train Loss: 0.8712042 Vali Loss: 0.6123776 Best vali loss: 0.6123776
	iters: 100, epoch: 2 | loss: 1.3821671
	speed: 0.0148s/iter; left time: 99.7761s
	iters: 200, epoch: 2 | loss: 0.5455946
	speed: 0.0047s/iter; left time: 31.1720s
	iters: 300, epoch: 2 | loss: 1.2338898
	speed: 0.0047s/iter; left time: 30.5914s
	iters: 400, epoch: 2 | loss: 1.0780541
	speed: 0.0046s/iter; left time: 29.6414s
	iters: 500, epoch: 2 | loss: 0.4464501
	speed: 0.0045s/iter; left time: 28.5544s
	iters: 600, epoch: 2 | loss: 1.9893265
	speed: 0.0046s/iter; left time: 28.9904s
	iters: 700, epoch: 2 | loss: 1.6478938
	speed: 0.0048s/iter; left time: 29.2807s
	iters: 800, epoch: 2 | loss: 1.0914661
	speed: 0.0047s/iter; left time: 28.3522s
	iters: 900, epoch: 2 | loss: 0.6050684
	speed: 0.0046s/iter; left time: 27.5848s
Updating learning rate to 0.00025756269001587123
Validation loss decreased (0.6124 --> 0.6088).  Saving model state dict ...
Epoch: 2 cost time: 4.586125135421753
Epoch: 2, Steps: 979 | Train Loss: 1.1133234 Vali Loss: 0.6088211 Best vali loss: 0.6088211
	iters: 100, epoch: 3 | loss: 0.8447166
	speed: 0.0147s/iter; left time: 85.0400s
	iters: 200, epoch: 3 | loss: 0.4907103
	speed: 0.0047s/iter; left time: 26.7390s
	iters: 300, epoch: 3 | loss: 0.7292412
	speed: 0.0048s/iter; left time: 26.9401s
	iters: 400, epoch: 3 | loss: 0.7532063
	speed: 0.0048s/iter; left time: 26.3287s
	iters: 500, epoch: 3 | loss: 0.5388740
	speed: 0.0048s/iter; left time: 25.7512s
	iters: 600, epoch: 3 | loss: 0.4090405
	speed: 0.0047s/iter; left time: 25.0189s
	iters: 700, epoch: 3 | loss: 1.0762190
	speed: 0.0047s/iter; left time: 24.5572s
	iters: 800, epoch: 3 | loss: 0.5351579
	speed: 0.0048s/iter; left time: 24.1754s
	iters: 900, epoch: 3 | loss: 0.8248946
	speed: 0.0048s/iter; left time: 23.6397s
Updating learning rate to 0.00020861475579916517
Validation loss decreased (0.6088 --> 0.5670).  Saving model state dict ...
Epoch: 3 cost time: 4.6975319385528564
Epoch: 3, Steps: 979 | Train Loss: 0.6891178 Vali Loss: 0.5670469 Best vali loss: 0.5670469

best validation loss 0.5670468615525743

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494772707, 'e_layers': 2, 'learning_rate': 0.0002977985857, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5890185
	speed: 0.0124s/iter; left time: 6.3752s
Updating learning rate to 0.00014889929285
Validation loss decreased (0.5443 --> 0.5310).  Saving model state dict ...
Epoch: 4 cost time: 1.0494964122772217
Epoch: 4, Steps: 123 | Train Loss: 0.5890185 Vali Loss: 0.5310126 Best vali loss: 0.5310126
	iters: 100, epoch: 5 | loss: 0.8176788
	speed: 0.0094s/iter; left time: 3.7074s
Updating learning rate to 9.191800038542734e-05
Validation loss decreased (0.5310 --> 0.5267).  Saving model state dict ...
Epoch: 5 cost time: 0.7172176837921143
Epoch: 5, Steps: 123 | Train Loss: 0.8176788 Vali Loss: 0.5267089 Best vali loss: 0.5267089
	iters: 100, epoch: 6 | loss: 0.7596073
	speed: 0.0094s/iter; left time: 2.5314s
Updating learning rate to 4.36115931618834e-05
Epoch: 6 cost time: 0.7154693603515625
Epoch: 6, Steps: 123 | Train Loss: 0.7596073 Vali Loss: 0.5360036 Best vali loss: 0.5267089
	iters: 100, epoch: 7 | loss: 0.4349295
	speed: 0.0089s/iter; left time: 1.3114s
Updating learning rate to 1.133428378048082e-05
Epoch: 7 cost time: 0.7126936912536621
Epoch: 7, Steps: 123 | Train Loss: 0.4349295 Vali Loss: 0.5461777 Best vali loss: 0.5267089
	iters: 100, epoch: 8 | loss: 0.5083202
	speed: 0.0089s/iter; left time: 0.2129s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7113420963287354
Epoch: 8, Steps: 123 | Train Loss: 0.5083202 Vali Loss: 0.5428000 Best vali loss: 0.5267089

best validation loss 0.5267088655684072

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010589653993, 'e_layers': 2, 'learning_rate': 0.0005709022537, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000549173580478998
Validation loss decreased (inf --> 0.6104).  Saving model state dict ...
Epoch: 1 cost time: 0.833251953125
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6104430 Best vali loss: 0.6104430
Updating learning rate to 0.00048729555434297636
Validation loss decreased (0.6104 --> 0.5688).  Saving model state dict ...
Epoch: 2 cost time: 0.5346152782440186
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5688431 Best vali loss: 0.5688431
Updating learning rate to 0.00039468854384544066
Validation loss decreased (0.5688 --> 0.5652).  Saving model state dict ...
Epoch: 3 cost time: 0.5314772129058838
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5652235 Best vali loss: 0.5652235
Updating learning rate to 0.00028545112685
Validation loss decreased (0.5652 --> 0.5490).  Saving model state dict ...
Epoch: 4 cost time: 0.5370347499847412
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5490298 Best vali loss: 0.5490298
Updating learning rate to 0.00017621370985455937
Epoch: 5 cost time: 0.5267751216888428
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5568393 Best vali loss: 0.5490298
Updating learning rate to 8.360669935702365e-05
Epoch: 6 cost time: 0.5288589000701904
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5574074 Best vali loss: 0.5490298
Updating learning rate to 2.172867322100199e-05
Epoch: 7 cost time: 0.5335018634796143
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5545992 Best vali loss: 0.5490298
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5293543338775635
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5528379 Best vali loss: 0.5490298

best validation loss 0.5490297565356497

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.010618394854, 'e_layers': 4, 'learning_rate': 0.0005713013608, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005495574974694829
Validation loss decreased (inf --> 0.6136).  Saving model state dict ...
Epoch: 1 cost time: 1.2151026725769043
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6136122 Best vali loss: 0.6136122
Updating learning rate to 0.0004876362135613912
Epoch: 2 cost time: 0.9242300987243652
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6349785 Best vali loss: 0.6136122
Updating learning rate to 0.0003949644632328953
Epoch: 3 cost time: 0.9288918972015381
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6165739 Best vali loss: 0.6136122
Updating learning rate to 0.0002856506804
Validation loss decreased (0.6136 --> 0.5558).  Saving model state dict ...
Epoch: 4 cost time: 0.9274759292602539
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5558350 Best vali loss: 0.5558350
Updating learning rate to 0.00017633689756710473
Validation loss decreased (0.5558 --> 0.5501).  Saving model state dict ...
Epoch: 5 cost time: 0.9319496154785156
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5500581 Best vali loss: 0.5500581
Updating learning rate to 8.366514723860879e-05
Epoch: 6 cost time: 0.9227738380432129
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5611283 Best vali loss: 0.5500581
Updating learning rate to 2.1743863330517022e-05
Epoch: 7 cost time: 0.926335334777832
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5668511 Best vali loss: 0.5500581
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9287359714508057
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5721247 Best vali loss: 0.5500581

best validation loss 0.5500580929926511

[INFO][smbo.py:320] Finished 1350 trials.
{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022221036858, 'e_layers': 1, 'learning_rate': 0.0016748457341, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9743556
	speed: 0.0094s/iter; left time: 17.5446s
	iters: 200, epoch: 1 | loss: 0.4970275
	speed: 0.0031s/iter; left time: 5.4453s
Updating learning rate to 0.0016111007139744155
Validation loss decreased (inf --> 0.6156).  Saving model state dict ...
Epoch: 1 cost time: 1.1186025142669678
Epoch: 1, Steps: 245 | Train Loss: 0.7356915 Vali Loss: 0.6155624 Best vali loss: 0.6155624
	iters: 100, epoch: 2 | loss: 1.1225958
	speed: 0.0067s/iter; left time: 10.8230s
	iters: 200, epoch: 2 | loss: 0.9652584
	speed: 0.0028s/iter; left time: 4.3137s
Updating learning rate to 0.0014295702550617356
Validation loss decreased (0.6156 --> 0.6040).  Saving model state dict ...
Epoch: 2 cost time: 0.74825119972229
Epoch: 2, Steps: 245 | Train Loss: 1.0439271 Vali Loss: 0.6040400 Best vali loss: 0.6040400
	iters: 100, epoch: 3 | loss: 1.0718501
	speed: 0.0066s/iter; left time: 9.0016s
	iters: 200, epoch: 3 | loss: 0.9220239
	speed: 0.0027s/iter; left time: 3.4457s
Updating learning rate to 0.0011578907241537083
Validation loss decreased (0.6040 --> 0.6035).  Saving model state dict ...
Epoch: 3 cost time: 0.718677282333374
Epoch: 3, Steps: 245 | Train Loss: 0.9969370 Vali Loss: 0.6034982 Best vali loss: 0.6034982

best validation loss 0.6034982238363084

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0039949241699, 'e_layers': 4, 'learning_rate': 0.0005875031027, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7502424
	speed: 0.0116s/iter; left time: 44.4795s
	iters: 200, epoch: 1 | loss: 1.2934703
	speed: 0.0055s/iter; left time: 20.6169s
	iters: 300, epoch: 1 | loss: 0.8085111
	speed: 0.0054s/iter; left time: 19.4830s
	iters: 400, epoch: 1 | loss: 0.4274602
	speed: 0.0053s/iter; left time: 18.5701s
Updating learning rate to 0.0005875031027
Validation loss decreased (inf --> 0.6481).  Saving model state dict ...
Epoch: 1 cost time: 2.9684689044952393
Epoch: 1, Steps: 490 | Train Loss: 0.8199210 Vali Loss: 0.6481334 Best vali loss: 0.6481334
	iters: 100, epoch: 2 | loss: 1.1223993
	speed: 0.0138s/iter; left time: 46.0122s
	iters: 200, epoch: 2 | loss: 0.5967695
	speed: 0.0048s/iter; left time: 15.5046s
	iters: 300, epoch: 2 | loss: 0.4834151
	speed: 0.0048s/iter; left time: 15.1344s
	iters: 400, epoch: 2 | loss: 0.8299307
	speed: 0.0048s/iter; left time: 14.6146s
Updating learning rate to 0.00029375155135
Validation loss decreased (0.6481 --> 0.6408).  Saving model state dict ...
Epoch: 2 cost time: 2.411376476287842
Epoch: 2, Steps: 490 | Train Loss: 0.7581287 Vali Loss: 0.6408259 Best vali loss: 0.6408259
	iters: 100, epoch: 3 | loss: 0.8646754
	speed: 0.0134s/iter; left time: 38.1670s
	iters: 200, epoch: 3 | loss: 0.8469915
	speed: 0.0048s/iter; left time: 13.2211s
	iters: 300, epoch: 3 | loss: 1.1629961
	speed: 0.0048s/iter; left time: 12.7286s
	iters: 400, epoch: 3 | loss: 0.6493306
	speed: 0.0052s/iter; left time: 13.1017s
Updating learning rate to 0.000146875775675
Epoch: 3 cost time: 2.489384651184082
Epoch: 3, Steps: 490 | Train Loss: 0.8809984 Vali Loss: 0.6533662 Best vali loss: 0.6408259

best validation loss 0.64082590213036

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0065876416613, 'e_layers': 4, 'learning_rate': 5.47736766e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9631612
	speed: 0.0113s/iter; left time: 43.1277s
	iters: 200, epoch: 1 | loss: 1.0523777
	speed: 0.0049s/iter; left time: 18.1544s
	iters: 300, epoch: 1 | loss: 0.6742432
	speed: 0.0048s/iter; left time: 17.5514s
	iters: 400, epoch: 1 | loss: 1.1959432
	speed: 0.0048s/iter; left time: 17.0563s
Updating learning rate to 5.47736766e-05
Validation loss decreased (inf --> 0.6247).  Saving model state dict ...
Epoch: 1 cost time: 2.742461919784546
Epoch: 1, Steps: 490 | Train Loss: 0.9714313 Vali Loss: 0.6247348 Best vali loss: 0.6247348
	iters: 100, epoch: 2 | loss: 0.5712270
	speed: 0.0130s/iter; left time: 43.4142s
	iters: 200, epoch: 2 | loss: 0.6331013
	speed: 0.0054s/iter; left time: 17.3938s
	iters: 300, epoch: 2 | loss: 1.0489323
	speed: 0.0053s/iter; left time: 16.7348s
	iters: 400, epoch: 2 | loss: 1.1618574
	speed: 0.0051s/iter; left time: 15.4512s
Updating learning rate to 2.73868383e-05
Validation loss decreased (0.6247 --> 0.6053).  Saving model state dict ...
Epoch: 2 cost time: 2.588195562362671
Epoch: 2, Steps: 490 | Train Loss: 0.8537795 Vali Loss: 0.6052979 Best vali loss: 0.6052979
	iters: 100, epoch: 3 | loss: 0.4434696
	speed: 0.0134s/iter; left time: 38.2086s
	iters: 200, epoch: 3 | loss: 0.7677288
	speed: 0.0049s/iter; left time: 13.4461s
	iters: 300, epoch: 3 | loss: 0.9632360
	speed: 0.0050s/iter; left time: 13.1050s
	iters: 400, epoch: 3 | loss: 1.0607086
	speed: 0.0050s/iter; left time: 12.5933s
Updating learning rate to 1.369341915e-05
Validation loss decreased (0.6053 --> 0.6039).  Saving model state dict ...
Epoch: 3 cost time: 2.4320576190948486
Epoch: 3, Steps: 490 | Train Loss: 0.8087858 Vali Loss: 0.6038577 Best vali loss: 0.6038577

best validation loss 0.6038576848856667

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022221036858, 'e_layers': 1, 'learning_rate': 0.0016748457341, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8247318
	speed: 0.0095s/iter; left time: 10.6771s
	iters: 200, epoch: 4 | loss: 0.4853556
	speed: 0.0030s/iter; left time: 3.0858s
Updating learning rate to 0.00083742286705
Epoch: 4 cost time: 1.0880234241485596
Epoch: 4, Steps: 245 | Train Loss: 0.6550437 Vali Loss: 0.6071328 Best vali loss: 0.6034982
	iters: 100, epoch: 5 | loss: 1.0580579
	speed: 0.0066s/iter; left time: 5.7779s
	iters: 200, epoch: 5 | loss: 0.8925716
	speed: 0.0028s/iter; left time: 2.2214s
Updating learning rate to 0.0005169550099462919
Epoch: 5 cost time: 0.7476968765258789
Epoch: 5, Steps: 245 | Train Loss: 0.9753147 Vali Loss: 0.6391973 Best vali loss: 0.6034982
	iters: 100, epoch: 6 | loss: 0.6315693
	speed: 0.0064s/iter; left time: 4.0447s
	iters: 200, epoch: 6 | loss: 0.8079097
	speed: 0.0029s/iter; left time: 1.5802s
Updating learning rate to 0.00024527547903826444
Validation loss decreased (0.6035 --> 0.6030).  Saving model state dict ...
Epoch: 6 cost time: 0.7570693492889404
Epoch: 6, Steps: 245 | Train Loss: 0.7197395 Vali Loss: 0.6029613 Best vali loss: 0.6029613
	iters: 100, epoch: 7 | loss: 0.4923472
	speed: 0.0068s/iter; left time: 2.6500s
	iters: 200, epoch: 7 | loss: 0.5758876
	speed: 0.0030s/iter; left time: 0.8618s
Updating learning rate to 6.374502012558458e-05
Epoch: 7 cost time: 0.7766637802124023
Epoch: 7, Steps: 245 | Train Loss: 0.5341174 Vali Loss: 0.6242656 Best vali loss: 0.6029613
	iters: 100, epoch: 8 | loss: 0.5975757
	speed: 0.0069s/iter; left time: 1.0025s
	iters: 200, epoch: 8 | loss: 0.6787347
	speed: 0.0031s/iter; left time: 0.1414s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8138382434844971
Epoch: 8, Steps: 245 | Train Loss: 0.6381552 Vali Loss: 0.6233668 Best vali loss: 0.6029613

best validation loss 0.6029612976662928

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.002941371442, 'e_layers': 2, 'learning_rate': 0.0002727727257, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3768284
	speed: 0.0099s/iter; left time: 37.9338s
	iters: 200, epoch: 1 | loss: 0.9315290
	speed: 0.0037s/iter; left time: 13.6770s
	iters: 300, epoch: 1 | loss: 0.6260537
	speed: 0.0034s/iter; left time: 12.3597s
	iters: 400, epoch: 1 | loss: 0.5506575
	speed: 0.0037s/iter; left time: 13.0051s
Updating learning rate to 0.0002727727257
Validation loss decreased (inf --> 0.6012).  Saving model state dict ...
Epoch: 1 cost time: 2.1367130279541016
Epoch: 1, Steps: 490 | Train Loss: 0.8712672 Vali Loss: 0.6011941 Best vali loss: 0.6011941
	iters: 100, epoch: 2 | loss: 0.9635502
	speed: 0.0102s/iter; left time: 33.9753s
	iters: 200, epoch: 2 | loss: 0.4103582
	speed: 0.0034s/iter; left time: 10.9624s
	iters: 300, epoch: 2 | loss: 0.8132477
	speed: 0.0034s/iter; left time: 10.6083s
	iters: 400, epoch: 2 | loss: 0.5175862
	speed: 0.0034s/iter; left time: 10.1606s
Updating learning rate to 0.00013638636285
Epoch: 2 cost time: 1.6992576122283936
Epoch: 2, Steps: 490 | Train Loss: 0.6761856 Vali Loss: 0.6023666 Best vali loss: 0.6011941
	iters: 100, epoch: 3 | loss: 0.2698036
	speed: 0.0098s/iter; left time: 27.9184s
	iters: 200, epoch: 3 | loss: 0.8912443
	speed: 0.0035s/iter; left time: 9.5001s
	iters: 300, epoch: 3 | loss: 0.7058119
	speed: 0.0035s/iter; left time: 9.2737s
	iters: 400, epoch: 3 | loss: 0.6948423
	speed: 0.0036s/iter; left time: 9.0965s
Updating learning rate to 6.8193181425e-05
Epoch: 3 cost time: 1.7651145458221436
Epoch: 3, Steps: 490 | Train Loss: 0.6404255 Vali Loss: 0.6147809 Best vali loss: 0.6011941
	iters: 100, epoch: 4 | loss: 0.6323053
	speed: 0.0100s/iter; left time: 23.5723s
	iters: 200, epoch: 4 | loss: 0.6444623
	speed: 0.0033s/iter; left time: 7.4199s
	iters: 300, epoch: 4 | loss: 1.1732891
	speed: 0.0033s/iter; left time: 7.0568s
	iters: 400, epoch: 4 | loss: 1.3483115
	speed: 0.0034s/iter; left time: 7.0558s
Updating learning rate to 3.40965907125e-05
Epoch: 4 cost time: 1.6982488632202148
Epoch: 4, Steps: 490 | Train Loss: 0.9495921 Vali Loss: 0.6119205 Best vali loss: 0.6011941
	iters: 100, epoch: 5 | loss: 0.4794329
	speed: 0.0102s/iter; left time: 18.8933s
	iters: 200, epoch: 5 | loss: 1.0486982
	speed: 0.0036s/iter; left time: 6.3649s
	iters: 300, epoch: 5 | loss: 0.9048451
	speed: 0.0037s/iter; left time: 6.1383s
	iters: 400, epoch: 5 | loss: 0.4250637
	speed: 0.0035s/iter; left time: 5.4525s
Updating learning rate to 1.704829535625e-05
Epoch: 5 cost time: 1.8089759349822998
Epoch: 5, Steps: 490 | Train Loss: 0.7145100 Vali Loss: 0.6239069 Best vali loss: 0.6011941
	iters: 100, epoch: 6 | loss: 1.0849395
	speed: 0.0101s/iter; left time: 13.8237s
	iters: 200, epoch: 6 | loss: 0.8677140
	speed: 0.0037s/iter; left time: 4.7435s
	iters: 300, epoch: 6 | loss: 0.8946955
	speed: 0.0038s/iter; left time: 4.4110s
	iters: 400, epoch: 6 | loss: 0.9358639
	speed: 0.0037s/iter; left time: 4.0111s
Updating learning rate to 8.524147678125e-06
Epoch: 6 cost time: 1.8655807971954346
Epoch: 6, Steps: 490 | Train Loss: 0.9458032 Vali Loss: 0.6209860 Best vali loss: 0.6011941
	iters: 100, epoch: 7 | loss: 1.0267869
	speed: 0.0103s/iter; left time: 9.1140s
	iters: 200, epoch: 7 | loss: 0.4187803
	speed: 0.0035s/iter; left time: 2.7502s
	iters: 300, epoch: 7 | loss: 0.8427265
	speed: 0.0037s/iter; left time: 2.5041s
	iters: 400, epoch: 7 | loss: 0.7721829
	speed: 0.0036s/iter; left time: 2.1101s
Updating learning rate to 4.2620738390625e-06
Epoch: 7 cost time: 1.808729887008667
Epoch: 7, Steps: 490 | Train Loss: 0.7651192 Vali Loss: 0.6215909 Best vali loss: 0.6011941
	iters: 100, epoch: 8 | loss: 0.6359962
	speed: 0.0104s/iter; left time: 4.0546s
	iters: 200, epoch: 8 | loss: 0.8783346
	speed: 0.0037s/iter; left time: 1.0662s
	iters: 300, epoch: 8 | loss: 0.7293791
	speed: 0.0037s/iter; left time: 0.7078s
	iters: 400, epoch: 8 | loss: 0.8985801
	speed: 0.0037s/iter; left time: 0.3385s
Updating learning rate to 2.13103691953125e-06
Epoch: 8 cost time: 1.856431484222412
Epoch: 8, Steps: 490 | Train Loss: 0.7855725 Vali Loss: 0.6219746 Best vali loss: 0.6011941

best validation loss 0.6011941244292182

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494750749, 'e_layers': 2, 'learning_rate': 0.0002978899369, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744659
	speed: 0.0121s/iter; left time: 10.6854s
Updating learning rate to 0.00028655217627149434
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0396232604980469
Epoch: 1, Steps: 123 | Train Loss: 0.7744659 Vali Loss: 0.6172936 Best vali loss: 0.6172936
	iters: 100, epoch: 2 | loss: 0.9514315
	speed: 0.0092s/iter; left time: 7.0124s
Updating learning rate to 0.00025426496566461135
Validation loss decreased (0.6173 --> 0.5665).  Saving model state dict ...
Epoch: 2 cost time: 0.7216017246246338
Epoch: 2, Steps: 123 | Train Loss: 0.9514315 Vali Loss: 0.5664865 Best vali loss: 0.5664865
	iters: 100, epoch: 3 | loss: 0.8492886
	speed: 0.0094s/iter; left time: 6.0114s
Updating learning rate to 0.000205943740209956
Validation loss decreased (0.5665 --> 0.5491).  Saving model state dict ...
Epoch: 3 cost time: 0.7165682315826416
Epoch: 3, Steps: 123 | Train Loss: 0.8492886 Vali Loss: 0.5491444 Best vali loss: 0.5491444
	iters: 100, epoch: 4 | loss: 0.4921040
	speed: 0.0093s/iter; left time: 4.7956s
Updating learning rate to 0.00014894496845
Validation loss decreased (0.5491 --> 0.5443).  Saving model state dict ...
Epoch: 4 cost time: 0.7266874313354492
Epoch: 4, Steps: 123 | Train Loss: 0.4921040 Vali Loss: 0.5443292 Best vali loss: 0.5443292
	iters: 100, epoch: 5 | loss: 0.5634490
	speed: 0.0093s/iter; left time: 3.6702s
Updating learning rate to 9.1946196690044e-05
Validation loss decreased (0.5443 --> 0.5293).  Saving model state dict ...
Epoch: 5 cost time: 0.7282199859619141
Epoch: 5, Steps: 123 | Train Loss: 0.5634490 Vali Loss: 0.5293434 Best vali loss: 0.5293434
	iters: 100, epoch: 6 | loss: 0.5861723
	speed: 0.0093s/iter; left time: 2.5104s
Updating learning rate to 4.362497123538863e-05
Epoch: 6 cost time: 0.7225091457366943
Epoch: 6, Steps: 123 | Train Loss: 0.5861723 Vali Loss: 0.5449569 Best vali loss: 0.5293434
	iters: 100, epoch: 7 | loss: 0.5423336
	speed: 0.0091s/iter; left time: 1.3305s
Updating learning rate to 1.1337760628505647e-05
Epoch: 7 cost time: 0.7256088256835938
Epoch: 7, Steps: 123 | Train Loss: 0.5423336 Vali Loss: 0.5432896 Best vali loss: 0.5293434
	iters: 100, epoch: 8 | loss: 0.6999576
	speed: 0.0091s/iter; left time: 0.2184s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7177345752716064
Epoch: 8, Steps: 123 | Train Loss: 0.6999576 Vali Loss: 0.5508079 Best vali loss: 0.5293434

best validation loss 0.5293434439076146

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0015781309222, 'e_layers': 4, 'learning_rate': 0.0008932440733, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8159354
	speed: 0.0126s/iter; left time: 11.1272s
Updating learning rate to 0.0008592469950794408
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 1.1335599422454834
Epoch: 1, Steps: 123 | Train Loss: 0.8159354 Vali Loss: 0.6085991 Best vali loss: 0.6085991
	iters: 100, epoch: 2 | loss: 0.7956271
	speed: 0.0101s/iter; left time: 7.7183s
Updating learning rate to 0.0007624315073925617
Epoch: 2 cost time: 0.8381383419036865
Epoch: 2, Steps: 123 | Train Loss: 0.7956271 Vali Loss: 0.6107579 Best vali loss: 0.6085991
	iters: 100, epoch: 3 | loss: 0.6690723
	speed: 0.0097s/iter; left time: 6.2151s
Updating learning rate to 0.000617536890605109
Validation loss decreased (0.6086 --> 0.5581).  Saving model state dict ...
Epoch: 3 cost time: 0.7987382411956787
Epoch: 3, Steps: 123 | Train Loss: 0.6690723 Vali Loss: 0.5580512 Best vali loss: 0.5580512

best validation loss 0.5580512367151005

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012007657939, 'e_layers': 3, 'learning_rate': 0.0002446680453, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1967978
	speed: 0.0107s/iter; left time: 40.8779s
	iters: 200, epoch: 1 | loss: 0.9733343
	speed: 0.0045s/iter; left time: 16.5835s
	iters: 300, epoch: 1 | loss: 0.9781255
	speed: 0.0044s/iter; left time: 15.8270s
	iters: 400, epoch: 1 | loss: 1.0466428
	speed: 0.0041s/iter; left time: 14.4764s
Updating learning rate to 0.0002446680453
Validation loss decreased (inf --> 0.6102).  Saving model state dict ...
Epoch: 1 cost time: 2.4491043090820312
Epoch: 1, Steps: 490 | Train Loss: 1.0487251 Vali Loss: 0.6102481 Best vali loss: 0.6102481
	iters: 100, epoch: 2 | loss: 0.8404623
	speed: 0.0117s/iter; left time: 38.8265s
	iters: 200, epoch: 2 | loss: 0.5262688
	speed: 0.0044s/iter; left time: 14.0756s
	iters: 300, epoch: 2 | loss: 1.1144298
	speed: 0.0042s/iter; left time: 13.3038s
	iters: 400, epoch: 2 | loss: 1.2304966
	speed: 0.0044s/iter; left time: 13.2134s
Updating learning rate to 0.00012233402265
Validation loss decreased (0.6102 --> 0.6061).  Saving model state dict ...
Epoch: 2 cost time: 2.177783727645874
Epoch: 2, Steps: 490 | Train Loss: 0.9279144 Vali Loss: 0.6061328 Best vali loss: 0.6061328
	iters: 100, epoch: 3 | loss: 0.7365802
	speed: 0.0117s/iter; left time: 33.1270s
	iters: 200, epoch: 3 | loss: 0.7289395
	speed: 0.0041s/iter; left time: 11.3685s
	iters: 300, epoch: 3 | loss: 0.5629967
	speed: 0.0041s/iter; left time: 10.7936s
	iters: 400, epoch: 3 | loss: 0.6133802
	speed: 0.0042s/iter; left time: 10.6974s
Updating learning rate to 6.1167011325e-05
Epoch: 3 cost time: 2.076284646987915
Epoch: 3, Steps: 490 | Train Loss: 0.6604742 Vali Loss: 0.6102870 Best vali loss: 0.6061328

best validation loss 0.6061327508868359

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0015188512592, 'e_layers': 3, 'learning_rate': 6.84778558e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.84778558e-05
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 1.0605452060699463
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6057999 Best vali loss: 0.6057999
Updating learning rate to 3.42389279e-05
Validation loss decreased (0.6058 --> 0.6038).  Saving model state dict ...
Epoch: 2 cost time: 0.7554683685302734
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6038098 Best vali loss: 0.6038098
Updating learning rate to 1.711946395e-05
Validation loss decreased (0.6038 --> 0.6012).  Saving model state dict ...
Epoch: 3 cost time: 0.7640707492828369
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6012162 Best vali loss: 0.6012162

best validation loss 0.6012162392142745

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0015781309222, 'e_layers': 4, 'learning_rate': 0.0008932440733, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7104360
	speed: 0.0124s/iter; left time: 6.3949s
Updating learning rate to 0.00044662203665
Epoch: 4 cost time: 1.0819568634033203
Epoch: 4, Steps: 123 | Train Loss: 0.7104360 Vali Loss: 0.5663488 Best vali loss: 0.5580512
	iters: 100, epoch: 5 | loss: 0.7599167
	speed: 0.0096s/iter; left time: 3.7887s
Updating learning rate to 0.0002757071826948911
Validation loss decreased (0.5581 --> 0.5439).  Saving model state dict ...
Epoch: 5 cost time: 0.7781119346618652
Epoch: 5, Steps: 123 | Train Loss: 0.7599167 Vali Loss: 0.5438968 Best vali loss: 0.5438968
	iters: 100, epoch: 6 | loss: 0.6298724
	speed: 0.0095s/iter; left time: 2.5735s
Updating learning rate to 0.00013081256590743827
Epoch: 6 cost time: 0.7800564765930176
Epoch: 6, Steps: 123 | Train Loss: 0.6298724 Vali Loss: 0.5507321 Best vali loss: 0.5438968
	iters: 100, epoch: 7 | loss: 0.8476154
	speed: 0.0096s/iter; left time: 1.4165s
Updating learning rate to 3.399707822055923e-05
Epoch: 7 cost time: 0.7880678176879883
Epoch: 7, Steps: 123 | Train Loss: 0.8476154 Vali Loss: 0.5485513 Best vali loss: 0.5438968
	iters: 100, epoch: 8 | loss: 0.5604900
	speed: 0.0094s/iter; left time: 0.2261s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7689697742462158
Epoch: 8, Steps: 123 | Train Loss: 0.5604900 Vali Loss: 0.5493200 Best vali loss: 0.5438968

best validation loss 0.543896807655037

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.003967151165, 'e_layers': 3, 'learning_rate': 0.0001503685319, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9329373
	speed: 0.0108s/iter; left time: 41.4182s
	iters: 200, epoch: 1 | loss: 0.5422224
	speed: 0.0045s/iter; left time: 16.6375s
	iters: 300, epoch: 1 | loss: 0.6745111
	speed: 0.0045s/iter; left time: 16.2058s
	iters: 400, epoch: 1 | loss: 0.6124660
	speed: 0.0043s/iter; left time: 15.2014s
Updating learning rate to 0.0001503685319
Validation loss decreased (inf --> 0.5685).  Saving model state dict ...
Epoch: 1 cost time: 2.5212759971618652
Epoch: 1, Steps: 490 | Train Loss: 0.6905342 Vali Loss: 0.5685458 Best vali loss: 0.5685458
	iters: 100, epoch: 2 | loss: 1.4486144
	speed: 0.0124s/iter; left time: 41.1993s
	iters: 200, epoch: 2 | loss: 0.7610662
	speed: 0.0045s/iter; left time: 14.5050s
	iters: 300, epoch: 2 | loss: 0.6843134
	speed: 0.0044s/iter; left time: 13.7761s
	iters: 400, epoch: 2 | loss: 0.8390433
	speed: 0.0044s/iter; left time: 13.3154s
Updating learning rate to 7.518426595e-05
Validation loss decreased (0.5685 --> 0.5627).  Saving model state dict ...
Epoch: 2 cost time: 2.2218985557556152
Epoch: 2, Steps: 490 | Train Loss: 0.9332593 Vali Loss: 0.5627118 Best vali loss: 0.5627118
	iters: 100, epoch: 3 | loss: 0.4271003
	speed: 0.0121s/iter; left time: 34.4699s
	iters: 200, epoch: 3 | loss: 0.7470972
	speed: 0.0042s/iter; left time: 11.6144s
	iters: 300, epoch: 3 | loss: 0.8201097
	speed: 0.0041s/iter; left time: 10.8640s
	iters: 400, epoch: 3 | loss: 0.4572417
	speed: 0.0041s/iter; left time: 10.3064s
Updating learning rate to 3.7592132975e-05
Validation loss decreased (0.5627 --> 0.5506).  Saving model state dict ...
Epoch: 3 cost time: 2.091167449951172
Epoch: 3, Steps: 490 | Train Loss: 0.6128872 Vali Loss: 0.5505982 Best vali loss: 0.5505982
	iters: 100, epoch: 4 | loss: 0.5771952
	speed: 0.0119s/iter; left time: 27.8605s
	iters: 200, epoch: 4 | loss: 0.6662252
	speed: 0.0042s/iter; left time: 9.4105s
	iters: 300, epoch: 4 | loss: 0.7396307
	speed: 0.0042s/iter; left time: 8.9535s
	iters: 400, epoch: 4 | loss: 0.3406761
	speed: 0.0040s/iter; left time: 8.1170s
Updating learning rate to 1.87960664875e-05
Validation loss decreased (0.5506 --> 0.5464).  Saving model state dict ...
Epoch: 4 cost time: 2.063100814819336
Epoch: 4, Steps: 490 | Train Loss: 0.5809318 Vali Loss: 0.5464174 Best vali loss: 0.5464174
	iters: 100, epoch: 5 | loss: 1.0210119
	speed: 0.0118s/iter; left time: 22.0325s
	iters: 200, epoch: 5 | loss: 0.6961720
	speed: 0.0040s/iter; left time: 7.0272s
	iters: 300, epoch: 5 | loss: 0.7723856
	speed: 0.0040s/iter; left time: 6.7117s
	iters: 400, epoch: 5 | loss: 0.6114291
	speed: 0.0041s/iter; left time: 6.3386s
Updating learning rate to 9.39803324375e-06
Validation loss decreased (0.5464 --> 0.5393).  Saving model state dict ...
Epoch: 5 cost time: 2.046217203140259
Epoch: 5, Steps: 490 | Train Loss: 0.7752497 Vali Loss: 0.5393096 Best vali loss: 0.5393096
	iters: 100, epoch: 6 | loss: 0.4886191
	speed: 0.0119s/iter; left time: 16.3058s
	iters: 200, epoch: 6 | loss: 0.8138223
	speed: 0.0042s/iter; left time: 5.3381s
	iters: 300, epoch: 6 | loss: 0.6808310
	speed: 0.0042s/iter; left time: 4.9014s
	iters: 400, epoch: 6 | loss: 0.7505174
	speed: 0.0040s/iter; left time: 4.2869s
Updating learning rate to 4.699016621875e-06
Validation loss decreased (0.5393 --> 0.5370).  Saving model state dict ...
Epoch: 6 cost time: 2.094348907470703
Epoch: 6, Steps: 490 | Train Loss: 0.6834475 Vali Loss: 0.5370303 Best vali loss: 0.5370303
	iters: 100, epoch: 7 | loss: 0.6726915
	speed: 0.0122s/iter; left time: 10.7814s
	iters: 200, epoch: 7 | loss: 0.7381015
	speed: 0.0044s/iter; left time: 3.4029s
	iters: 300, epoch: 7 | loss: 0.6150289
	speed: 0.0044s/iter; left time: 2.9987s
	iters: 400, epoch: 7 | loss: 0.9911537
	speed: 0.0045s/iter; left time: 2.6219s
Updating learning rate to 2.3495083109375e-06
Validation loss decreased (0.5370 --> 0.5352).  Saving model state dict ...
Epoch: 7 cost time: 2.2397050857543945
Epoch: 7, Steps: 490 | Train Loss: 0.7542439 Vali Loss: 0.5352062 Best vali loss: 0.5352062
	iters: 100, epoch: 8 | loss: 0.5846052
	speed: 0.0123s/iter; left time: 4.8015s
	iters: 200, epoch: 8 | loss: 0.5928382
	speed: 0.0044s/iter; left time: 1.2700s
	iters: 300, epoch: 8 | loss: 1.3418612
	speed: 0.0043s/iter; left time: 0.8299s
	iters: 400, epoch: 8 | loss: 1.3306630
	speed: 0.0043s/iter; left time: 0.3954s
Updating learning rate to 1.17475415546875e-06
Validation loss decreased (0.5352 --> 0.5348).  Saving model state dict ...
Epoch: 8 cost time: 2.1983461380004883
Epoch: 8, Steps: 490 | Train Loss: 0.9624919 Vali Loss: 0.5347840 Best vali loss: 0.5347840

best validation loss 0.5347840327843645

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0009147207395, 'e_layers': 2, 'learning_rate': 0.0007637680713, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8963342
	speed: 0.0103s/iter; left time: 19.2185s
	iters: 200, epoch: 1 | loss: 0.5655364
	speed: 0.0040s/iter; left time: 7.0778s
Updating learning rate to 0.0007637680713
Validation loss decreased (inf --> 0.6441).  Saving model state dict ...
Epoch: 1 cost time: 1.3243718147277832
Epoch: 1, Steps: 245 | Train Loss: 0.7309353 Vali Loss: 0.6440937 Best vali loss: 0.6440937
	iters: 100, epoch: 2 | loss: 0.7003888
	speed: 0.0080s/iter; left time: 12.9859s
	iters: 200, epoch: 2 | loss: 0.8445755
	speed: 0.0036s/iter; left time: 5.4828s
Updating learning rate to 0.00038188403565
Epoch: 2 cost time: 0.9429562091827393
Epoch: 2, Steps: 245 | Train Loss: 0.7724822 Vali Loss: 0.6489177 Best vali loss: 0.6440937
	iters: 100, epoch: 3 | loss: 0.5935668
	speed: 0.0079s/iter; left time: 10.8758s
	iters: 200, epoch: 3 | loss: 1.0530063
	speed: 0.0039s/iter; left time: 5.0020s
Updating learning rate to 0.000190942017825
Validation loss decreased (0.6441 --> 0.5695).  Saving model state dict ...
Epoch: 3 cost time: 1.012300729751587
Epoch: 3, Steps: 245 | Train Loss: 0.8232866 Vali Loss: 0.5695034 Best vali loss: 0.5695034
	iters: 100, epoch: 4 | loss: 0.9037040
	speed: 0.0083s/iter; left time: 9.3889s
	iters: 200, epoch: 4 | loss: 0.6653718
	speed: 0.0038s/iter; left time: 3.9245s
Updating learning rate to 9.54710089125e-05
Validation loss decreased (0.5695 --> 0.5672).  Saving model state dict ...
Epoch: 4 cost time: 1.006263256072998
Epoch: 4, Steps: 245 | Train Loss: 0.7845379 Vali Loss: 0.5671636 Best vali loss: 0.5671636
	iters: 100, epoch: 5 | loss: 0.5858631
	speed: 0.0085s/iter; left time: 7.4754s
	iters: 200, epoch: 5 | loss: 0.7752191
	speed: 0.0039s/iter; left time: 3.0219s
Updating learning rate to 4.773550445625e-05
Validation loss decreased (0.5672 --> 0.5523).  Saving model state dict ...
Epoch: 5 cost time: 1.0144908428192139
Epoch: 5, Steps: 245 | Train Loss: 0.6805411 Vali Loss: 0.5523309 Best vali loss: 0.5523309
	iters: 100, epoch: 6 | loss: 1.0448694
	speed: 0.0084s/iter; left time: 5.3599s
	iters: 200, epoch: 6 | loss: 0.8685895
	speed: 0.0039s/iter; left time: 2.0661s
Updating learning rate to 2.3867752228125e-05
Epoch: 6 cost time: 1.0182688236236572
Epoch: 6, Steps: 245 | Train Loss: 0.9567294 Vali Loss: 0.5569104 Best vali loss: 0.5523309
	iters: 100, epoch: 7 | loss: 0.7907472
	speed: 0.0082s/iter; left time: 3.2041s
	iters: 200, epoch: 7 | loss: 0.6904204
	speed: 0.0040s/iter; left time: 1.1570s
Updating learning rate to 1.19338761140625e-05
Epoch: 7 cost time: 1.0173017978668213
Epoch: 7, Steps: 245 | Train Loss: 0.7405838 Vali Loss: 0.5545032 Best vali loss: 0.5523309
	iters: 100, epoch: 8 | loss: 0.8721480
	speed: 0.0083s/iter; left time: 1.2102s
	iters: 200, epoch: 8 | loss: 0.6023877
	speed: 0.0040s/iter; left time: 0.1830s
Updating learning rate to 5.96693805703125e-06
Epoch: 8 cost time: 1.0264179706573486
Epoch: 8, Steps: 245 | Train Loss: 0.7372679 Vali Loss: 0.5527472 Best vali loss: 0.5523309

best validation loss 0.5523308984442256

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0035191746813, 'e_layers': 3, 'learning_rate': 0.0001112183611, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00010698536427986974
Validation loss decreased (inf --> 0.6034).  Saving model state dict ...
Epoch: 1 cost time: 0.9542081356048584
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6033542 Best vali loss: 0.6033542
Updating learning rate to 9.493080921313206e-05
Epoch: 2 cost time: 0.6287448406219482
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6042261 Best vali loss: 0.6033542
Updating learning rate to 7.688989263388399e-05
Epoch: 3 cost time: 0.6251177787780762
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6034146 Best vali loss: 0.6033542

best validation loss 0.6033541624439033

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043780025192, 'e_layers': 3, 'learning_rate': 0.0004443255246, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6688854
	speed: 0.0141s/iter; left time: 12.4500s
Updating learning rate to 0.00042741439127514015
Validation loss decreased (inf --> 0.6178).  Saving model state dict ...
Epoch: 1 cost time: 1.3058748245239258
Epoch: 1, Steps: 123 | Train Loss: 0.6688854 Vali Loss: 0.6178342 Best vali loss: 0.6178342
	iters: 100, epoch: 2 | loss: 0.9258128
	speed: 0.0123s/iter; left time: 9.3990s
Updating learning rate to 0.0003792555580494651
Validation loss decreased (0.6178 --> 0.5600).  Saving model state dict ...
Epoch: 2 cost time: 1.000875473022461
Epoch: 2, Steps: 123 | Train Loss: 0.9258128 Vali Loss: 0.5599647 Best vali loss: 0.5599647
	iters: 100, epoch: 3 | loss: 0.8819467
	speed: 0.0127s/iter; left time: 8.0838s
Updating learning rate to 0.0003071807707206736
Epoch: 3 cost time: 1.0062413215637207
Epoch: 3, Steps: 123 | Train Loss: 0.8819467 Vali Loss: 0.6035946 Best vali loss: 0.5599647

best validation loss 0.5599647167654624

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0012345922023, 'e_layers': 2, 'learning_rate': 9.51398255e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0286866
	speed: 0.0099s/iter; left time: 37.9336s
	iters: 200, epoch: 1 | loss: 0.8542366
	speed: 0.0037s/iter; left time: 13.7764s
	iters: 300, epoch: 1 | loss: 1.4456104
	speed: 0.0037s/iter; left time: 13.4564s
	iters: 400, epoch: 1 | loss: 0.6662888
	speed: 0.0037s/iter; left time: 13.0588s
Updating learning rate to 9.15187815030727e-05
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 2.1751646995544434
Epoch: 1, Steps: 490 | Train Loss: 0.9987056 Vali Loss: 0.6085670 Best vali loss: 0.6085670
	iters: 100, epoch: 2 | loss: 0.6754494
	speed: 0.0105s/iter; left time: 35.0472s
	iters: 200, epoch: 2 | loss: 0.8775480
	speed: 0.0036s/iter; left time: 11.7493s
	iters: 300, epoch: 2 | loss: 0.5170911
	speed: 0.0037s/iter; left time: 11.4590s
	iters: 400, epoch: 2 | loss: 0.9983731
	speed: 0.0037s/iter; left time: 11.0846s
Updating learning rate to 8.120692063597741e-05
Validation loss decreased (0.6086 --> 0.5721).  Saving model state dict ...
Epoch: 2 cost time: 1.7902331352233887
Epoch: 2, Steps: 490 | Train Loss: 0.7671154 Vali Loss: 0.5721173 Best vali loss: 0.5721173
	iters: 100, epoch: 3 | loss: 0.4001020
	speed: 0.0106s/iter; left time: 30.0300s
	iters: 200, epoch: 3 | loss: 0.6045763
	speed: 0.0034s/iter; left time: 9.3406s
	iters: 300, epoch: 3 | loss: 0.8512866
	speed: 0.0034s/iter; left time: 9.0703s
	iters: 400, epoch: 3 | loss: 0.8560185
	speed: 0.0034s/iter; left time: 8.7546s
Updating learning rate to 6.577413023847785e-05
Epoch: 3 cost time: 1.7477915287017822
Epoch: 3, Steps: 490 | Train Loss: 0.6779959 Vali Loss: 0.5726711 Best vali loss: 0.5721173

best validation loss 0.572117281588952

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043780025192, 'e_layers': 3, 'learning_rate': 0.0004443255246, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5913522
	speed: 0.0147s/iter; left time: 7.5873s
Updating learning rate to 0.0002221627623
Epoch: 4 cost time: 1.3221702575683594
Epoch: 4, Steps: 123 | Train Loss: 0.5913522 Vali Loss: 0.5782140 Best vali loss: 0.5599647
	iters: 100, epoch: 5 | loss: 0.8807903
	speed: 0.0120s/iter; left time: 4.7148s
Updating learning rate to 0.00013714475387932646
Epoch: 5 cost time: 0.9965095520019531
Epoch: 5, Steps: 123 | Train Loss: 0.8807903 Vali Loss: 0.5892744 Best vali loss: 0.5599647
	iters: 100, epoch: 6 | loss: 0.8125007
	speed: 0.0120s/iter; left time: 3.2503s
Updating learning rate to 6.506996655053494e-05
Epoch: 6 cost time: 0.9959542751312256
Epoch: 6, Steps: 123 | Train Loss: 0.8125007 Vali Loss: 0.5713323 Best vali loss: 0.5599647
	iters: 100, epoch: 7 | loss: 0.5691686
	speed: 0.0121s/iter; left time: 1.7765s
Updating learning rate to 1.691113332485988e-05
Epoch: 7 cost time: 1.013981580734253
Epoch: 7, Steps: 123 | Train Loss: 0.5691686 Vali Loss: 0.5783929 Best vali loss: 0.5599647
	iters: 100, epoch: 8 | loss: 0.7519117
	speed: 0.0122s/iter; left time: 0.2926s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.002258539199829
Epoch: 8, Steps: 123 | Train Loss: 0.7519117 Vali Loss: 0.5844208 Best vali loss: 0.5599647

best validation loss 0.5599647167654624

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0012203044924, 'e_layers': 2, 'learning_rate': 9.53633739e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0286986
	speed: 0.0096s/iter; left time: 36.7058s
	iters: 200, epoch: 1 | loss: 0.8541018
	speed: 0.0037s/iter; left time: 13.9311s
	iters: 300, epoch: 1 | loss: 1.4456275
	speed: 0.0037s/iter; left time: 13.3326s
	iters: 400, epoch: 1 | loss: 0.6663253
	speed: 0.0038s/iter; left time: 13.2210s
Updating learning rate to 9.173382159871553e-05
Validation loss decreased (inf --> 0.6086).  Saving model state dict ...
Epoch: 1 cost time: 2.148940086364746
Epoch: 1, Steps: 490 | Train Loss: 0.9986883 Vali Loss: 0.6085710 Best vali loss: 0.6085710
	iters: 100, epoch: 2 | loss: 0.6764953
	speed: 0.0106s/iter; left time: 35.4320s
	iters: 200, epoch: 2 | loss: 0.8793010
	speed: 0.0037s/iter; left time: 12.0909s
	iters: 300, epoch: 2 | loss: 0.5204098
	speed: 0.0038s/iter; left time: 11.7967s
	iters: 400, epoch: 2 | loss: 0.9930771
	speed: 0.0037s/iter; left time: 11.1433s
Updating learning rate to 8.13977311307591e-05
Validation loss decreased (0.6086 --> 0.5642).  Saving model state dict ...
Epoch: 2 cost time: 1.873277187347412
Epoch: 2, Steps: 490 | Train Loss: 0.7673208 Vali Loss: 0.5641531 Best vali loss: 0.5641531
	iters: 100, epoch: 3 | loss: 0.3968795
	speed: 0.0106s/iter; left time: 30.0250s
	iters: 200, epoch: 3 | loss: 0.5991829
	speed: 0.0035s/iter; left time: 9.4772s
	iters: 300, epoch: 3 | loss: 0.8494213
	speed: 0.0036s/iter; left time: 9.4347s
	iters: 400, epoch: 3 | loss: 0.8530378
	speed: 0.0034s/iter; left time: 8.6237s
Updating learning rate to 6.592867857298372e-05
Epoch: 3 cost time: 1.751509428024292
Epoch: 3, Steps: 490 | Train Loss: 0.6746304 Vali Loss: 0.5728246 Best vali loss: 0.5641531
	iters: 100, epoch: 4 | loss: 0.6164365
	speed: 0.0099s/iter; left time: 23.3477s
	iters: 200, epoch: 4 | loss: 0.3756140
	speed: 0.0036s/iter; left time: 8.0208s
	iters: 300, epoch: 4 | loss: 0.4134800
	speed: 0.0036s/iter; left time: 7.7099s
	iters: 400, epoch: 4 | loss: 1.0628315
	speed: 0.0035s/iter; left time: 7.2568s
Updating learning rate to 4.768168695e-05
Validation loss decreased (0.5642 --> 0.5574).  Saving model state dict ...
Epoch: 4 cost time: 1.759131669998169
Epoch: 4, Steps: 490 | Train Loss: 0.6170905 Vali Loss: 0.5574263 Best vali loss: 0.5574263
	iters: 100, epoch: 5 | loss: 0.4542674
	speed: 0.0103s/iter; left time: 19.1544s
	iters: 200, epoch: 5 | loss: 0.9201651
	speed: 0.0036s/iter; left time: 6.3149s
	iters: 300, epoch: 5 | loss: 0.8399238
	speed: 0.0038s/iter; left time: 6.2691s
	iters: 400, epoch: 5 | loss: 0.9278233
	speed: 0.0037s/iter; left time: 5.8096s
Updating learning rate to 2.9434695327016294e-05
Validation loss decreased (0.5574 --> 0.5474).  Saving model state dict ...
Epoch: 5 cost time: 1.8568487167358398
Epoch: 5, Steps: 490 | Train Loss: 0.7855449 Vali Loss: 0.5473663 Best vali loss: 0.5473663
	iters: 100, epoch: 6 | loss: 0.9355833
	speed: 0.0105s/iter; left time: 14.3348s
	iters: 200, epoch: 6 | loss: 1.0574155
	speed: 0.0036s/iter; left time: 4.6221s
	iters: 300, epoch: 6 | loss: 0.4827909
	speed: 0.0034s/iter; left time: 3.9366s
	iters: 400, epoch: 6 | loss: 0.4719903
	speed: 0.0033s/iter; left time: 3.5695s
Updating learning rate to 1.3965642769240895e-05
Validation loss decreased (0.5474 --> 0.5446).  Saving model state dict ...
Epoch: 6 cost time: 1.7223548889160156
Epoch: 6, Steps: 490 | Train Loss: 0.7369450 Vali Loss: 0.5446452 Best vali loss: 0.5446452
	iters: 100, epoch: 7 | loss: 0.7400851
	speed: 0.0102s/iter; left time: 8.9984s
	iters: 200, epoch: 7 | loss: 0.8053511
	speed: 0.0036s/iter; left time: 2.7839s
	iters: 300, epoch: 7 | loss: 0.7537903
	speed: 0.0034s/iter; left time: 2.3264s
	iters: 400, epoch: 7 | loss: 0.9173086
	speed: 0.0034s/iter; left time: 1.9563s
Updating learning rate to 3.6295523012844786e-06
Validation loss decreased (0.5446 --> 0.5442).  Saving model state dict ...
Epoch: 7 cost time: 1.7399911880493164
Epoch: 7, Steps: 490 | Train Loss: 0.8041338 Vali Loss: 0.5442451 Best vali loss: 0.5442451
	iters: 100, epoch: 8 | loss: 0.5547088
	speed: 0.0105s/iter; left time: 4.0976s
	iters: 200, epoch: 8 | loss: 0.5221833
	speed: 0.0035s/iter; left time: 1.0098s
	iters: 300, epoch: 8 | loss: 0.6113873
	speed: 0.0034s/iter; left time: 0.6450s
	iters: 400, epoch: 8 | loss: 0.4211900
	speed: 0.0034s/iter; left time: 0.3079s
Updating learning rate to 0.0
Validation loss decreased (0.5442 --> 0.5439).  Saving model state dict ...
Epoch: 8 cost time: 1.766235113143921
Epoch: 8, Steps: 490 | Train Loss: 0.5273673 Vali Loss: 0.5438740 Best vali loss: 0.5438740

best validation loss 0.5438740326264896

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020305156617, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7746738
	speed: 0.0115s/iter; left time: 10.2164s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0121257305145264
Epoch: 1, Steps: 123 | Train Loss: 0.7746738 Vali Loss: 0.6172995 Best vali loss: 0.6172995
	iters: 100, epoch: 2 | loss: 0.9561977
	speed: 0.0091s/iter; left time: 6.9377s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6173 --> 0.5723).  Saving model state dict ...
Epoch: 2 cost time: 0.7159574031829834
Epoch: 2, Steps: 123 | Train Loss: 0.9561977 Vali Loss: 0.5723269 Best vali loss: 0.5723269
	iters: 100, epoch: 3 | loss: 0.8469293
	speed: 0.0094s/iter; left time: 5.9870s
Updating learning rate to 7.442084605e-05
Validation loss decreased (0.5723 --> 0.5512).  Saving model state dict ...
Epoch: 3 cost time: 0.7233011722564697
Epoch: 3, Steps: 123 | Train Loss: 0.8469293 Vali Loss: 0.5512258 Best vali loss: 0.5512258
	iters: 100, epoch: 4 | loss: 0.4916171
	speed: 0.0092s/iter; left time: 4.7560s
Updating learning rate to 3.7210423025e-05
Validation loss decreased (0.5512 --> 0.5412).  Saving model state dict ...
Epoch: 4 cost time: 0.7208716869354248
Epoch: 4, Steps: 123 | Train Loss: 0.4916171 Vali Loss: 0.5411690 Best vali loss: 0.5411690
	iters: 100, epoch: 5 | loss: 0.5771204
	speed: 0.0093s/iter; left time: 3.6653s
Updating learning rate to 1.86052115125e-05
Validation loss decreased (0.5412 --> 0.5378).  Saving model state dict ...
Epoch: 5 cost time: 0.7243514060974121
Epoch: 5, Steps: 123 | Train Loss: 0.5771204 Vali Loss: 0.5378339 Best vali loss: 0.5378339
	iters: 100, epoch: 6 | loss: 0.6188744
	speed: 0.0092s/iter; left time: 2.4740s
Updating learning rate to 9.30260575625e-06
Validation loss decreased (0.5378 --> 0.5321).  Saving model state dict ...
Epoch: 6 cost time: 0.7132694721221924
Epoch: 6, Steps: 123 | Train Loss: 0.6188744 Vali Loss: 0.5320898 Best vali loss: 0.5320898
	iters: 100, epoch: 7 | loss: 0.5884655
	speed: 0.0092s/iter; left time: 1.3512s
Updating learning rate to 4.651302878125e-06
Validation loss decreased (0.5321 --> 0.5316).  Saving model state dict ...
Epoch: 7 cost time: 0.7160811424255371
Epoch: 7, Steps: 123 | Train Loss: 0.5884655 Vali Loss: 0.5316019 Best vali loss: 0.5316019
	iters: 100, epoch: 8 | loss: 0.7496122
	speed: 0.0094s/iter; left time: 0.2263s
Updating learning rate to 2.3256514390625e-06
Validation loss decreased (0.5316 --> 0.5303).  Saving model state dict ...
Epoch: 8 cost time: 0.7274391651153564
Epoch: 8, Steps: 123 | Train Loss: 0.7496122 Vali Loss: 0.5302664 Best vali loss: 0.5302664

best validation loss 0.530266385920232

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.00282182249, 'e_layers': 3, 'learning_rate': 0.000158936199, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6987062
	speed: 0.0107s/iter; left time: 40.7142s
	iters: 200, epoch: 1 | loss: 0.8490610
	speed: 0.0042s/iter; left time: 15.7482s
	iters: 300, epoch: 1 | loss: 0.4014117
	speed: 0.0042s/iter; left time: 15.2103s
	iters: 400, epoch: 1 | loss: 0.9587205
	speed: 0.0042s/iter; left time: 14.6338s
Updating learning rate to 0.0001528870501156204
Validation loss decreased (inf --> 0.5833).  Saving model state dict ...
Epoch: 1 cost time: 2.4081873893737793
Epoch: 1, Steps: 490 | Train Loss: 0.7269748 Vali Loss: 0.5833477 Best vali loss: 0.5833477
	iters: 100, epoch: 2 | loss: 0.9457126
	speed: 0.0118s/iter; left time: 39.2155s
	iters: 200, epoch: 2 | loss: 0.7461758
	speed: 0.0040s/iter; left time: 12.8027s
	iters: 300, epoch: 2 | loss: 0.9545923
	speed: 0.0040s/iter; left time: 12.6747s
	iters: 400, epoch: 2 | loss: 0.7391561
	speed: 0.0041s/iter; left time: 12.3391s
Updating learning rate to 0.00013566053154445728
Validation loss decreased (0.5833 --> 0.5770).  Saving model state dict ...
Epoch: 2 cost time: 2.051318883895874
Epoch: 2, Steps: 490 | Train Loss: 0.8464092 Vali Loss: 0.5770142 Best vali loss: 0.5770142
	iters: 100, epoch: 3 | loss: 1.3702008
	speed: 0.0125s/iter; left time: 35.4879s
	iters: 200, epoch: 3 | loss: 0.5409573
	speed: 0.0047s/iter; left time: 12.9122s
	iters: 300, epoch: 3 | loss: 0.8043158
	speed: 0.0046s/iter; left time: 12.2072s
	iters: 400, epoch: 3 | loss: 0.5873871
	speed: 0.0046s/iter; left time: 11.6411s
Updating learning rate to 0.00010987922458019049
Epoch: 3 cost time: 2.3212966918945312
Epoch: 3, Steps: 490 | Train Loss: 0.8257152 Vali Loss: 0.5772054 Best vali loss: 0.5770142

best validation loss 0.577014157668356

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0008872298646, 'e_layers': 1, 'learning_rate': 5.36819824e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1629379
	speed: 0.0086s/iter; left time: 66.7617s
	iters: 200, epoch: 1 | loss: 0.8850513
	speed: 0.0025s/iter; left time: 19.4362s
	iters: 300, epoch: 1 | loss: 1.3469429
	speed: 0.0025s/iter; left time: 18.8200s
	iters: 400, epoch: 1 | loss: 1.0023277
	speed: 0.0025s/iter; left time: 18.3521s
	iters: 500, epoch: 1 | loss: 0.6266900
	speed: 0.0025s/iter; left time: 18.5027s
	iters: 600, epoch: 1 | loss: 0.9719192
	speed: 0.0025s/iter; left time: 17.9537s
	iters: 700, epoch: 1 | loss: 0.6560823
	speed: 0.0025s/iter; left time: 18.1667s
	iters: 800, epoch: 1 | loss: 1.8473228
	speed: 0.0025s/iter; left time: 17.2528s
	iters: 900, epoch: 1 | loss: 1.0987175
	speed: 0.0024s/iter; left time: 16.6376s
Updating learning rate to 5.36819824e-05
Validation loss decreased (inf --> 0.6289).  Saving model state dict ...
Epoch: 1 cost time: 2.759737730026245
Epoch: 1, Steps: 979 | Train Loss: 1.0664435 Vali Loss: 0.6289019 Best vali loss: 0.6289019
	iters: 100, epoch: 2 | loss: 0.9846463
	speed: 0.0087s/iter; left time: 58.8338s
	iters: 200, epoch: 2 | loss: 0.3672878
	speed: 0.0023s/iter; left time: 15.4828s
	iters: 300, epoch: 2 | loss: 0.5162731
	speed: 0.0023s/iter; left time: 15.1000s
	iters: 400, epoch: 2 | loss: 0.2963499
	speed: 0.0023s/iter; left time: 14.7421s
	iters: 500, epoch: 2 | loss: 0.4650486
	speed: 0.0023s/iter; left time: 14.4818s
	iters: 600, epoch: 2 | loss: 2.1237822
	speed: 0.0023s/iter; left time: 14.5875s
	iters: 700, epoch: 2 | loss: 0.9499915
	speed: 0.0024s/iter; left time: 14.8371s
	iters: 800, epoch: 2 | loss: 0.9667966
	speed: 0.0025s/iter; left time: 14.9689s
	iters: 900, epoch: 2 | loss: 1.2338909
	speed: 0.0024s/iter; left time: 14.5393s
Updating learning rate to 2.68409912e-05
Validation loss decreased (0.6289 --> 0.6064).  Saving model state dict ...
Epoch: 2 cost time: 2.3546056747436523
Epoch: 2, Steps: 979 | Train Loss: 0.8782296 Vali Loss: 0.6064430 Best vali loss: 0.6064430
	iters: 100, epoch: 3 | loss: 0.2895707
	speed: 0.0091s/iter; left time: 52.7189s
	iters: 200, epoch: 3 | loss: 0.3170285
	speed: 0.0024s/iter; left time: 13.5422s
	iters: 300, epoch: 3 | loss: 0.6334159
	speed: 0.0024s/iter; left time: 13.2825s
	iters: 400, epoch: 3 | loss: 1.3486034
	speed: 0.0024s/iter; left time: 13.0697s
	iters: 500, epoch: 3 | loss: 0.6419850
	speed: 0.0024s/iter; left time: 12.8610s
	iters: 600, epoch: 3 | loss: 1.0694094
	speed: 0.0024s/iter; left time: 12.5666s
	iters: 700, epoch: 3 | loss: 1.1861111
	speed: 0.0023s/iter; left time: 11.7719s
	iters: 800, epoch: 3 | loss: 0.8401977
	speed: 0.0023s/iter; left time: 11.7993s
	iters: 900, epoch: 3 | loss: 0.8065372
	speed: 0.0023s/iter; left time: 11.5111s
Updating learning rate to 1.34204956e-05
Epoch: 3 cost time: 2.3454251289367676
Epoch: 3, Steps: 979 | Train Loss: 0.7925399 Vali Loss: 0.6065586 Best vali loss: 0.6064430

best validation loss 0.6064430322982491

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0026755611596, 'e_layers': 3, 'learning_rate': 9.39624398e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7017811
	speed: 0.0106s/iter; left time: 40.5468s
	iters: 200, epoch: 1 | loss: 0.8120340
	speed: 0.0043s/iter; left time: 16.0347s
	iters: 300, epoch: 1 | loss: 0.3971062
	speed: 0.0046s/iter; left time: 16.4888s
	iters: 400, epoch: 1 | loss: 0.9711341
	speed: 0.0047s/iter; left time: 16.5366s
Updating learning rate to 9.038620737802197e-05
Validation loss decreased (inf --> 0.6071).  Saving model state dict ...
Epoch: 1 cost time: 2.579935312271118
Epoch: 1, Steps: 490 | Train Loss: 0.7205138 Vali Loss: 0.6071120 Best vali loss: 0.6071120
	iters: 100, epoch: 2 | loss: 1.0116893
	speed: 0.0127s/iter; left time: 42.3672s
	iters: 200, epoch: 2 | loss: 0.7319149
	speed: 0.0045s/iter; left time: 14.6388s
	iters: 300, epoch: 2 | loss: 0.8833306
	speed: 0.0045s/iter; left time: 14.2165s
	iters: 400, epoch: 2 | loss: 0.7375307
	speed: 0.0044s/iter; left time: 13.2009s
Updating learning rate to 8.020195907970637e-05
Validation loss decreased (0.6071 --> 0.5596).  Saving model state dict ...
Epoch: 2 cost time: 2.2100718021392822
Epoch: 2, Steps: 490 | Train Loss: 0.8411164 Vali Loss: 0.5596096 Best vali loss: 0.5596096
	iters: 100, epoch: 3 | loss: 1.2887588
	speed: 0.0122s/iter; left time: 34.5257s
	iters: 200, epoch: 3 | loss: 0.5727006
	speed: 0.0041s/iter; left time: 11.1416s
	iters: 300, epoch: 3 | loss: 0.7921912
	speed: 0.0040s/iter; left time: 10.5272s
	iters: 400, epoch: 3 | loss: 0.5832383
	speed: 0.0040s/iter; left time: 10.1459s
Updating learning rate to 6.496015438803106e-05
Epoch: 3 cost time: 2.030137300491333
Epoch: 3, Steps: 490 | Train Loss: 0.8092222 Vali Loss: 0.5825733 Best vali loss: 0.5596096

best validation loss 0.5596096215149916

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0026755611596, 'e_layers': 3, 'learning_rate': 9.39624398e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6216368
	speed: 0.0109s/iter; left time: 25.5216s
	iters: 200, epoch: 4 | loss: 0.5612863
	speed: 0.0042s/iter; left time: 9.4069s
	iters: 300, epoch: 4 | loss: 0.3945633
	speed: 0.0042s/iter; left time: 8.9791s
	iters: 400, epoch: 4 | loss: 0.6627290
	speed: 0.0041s/iter; left time: 8.5094s
Updating learning rate to 4.69812199e-05
Epoch: 4 cost time: 2.398041009902954
Epoch: 4, Steps: 490 | Train Loss: 0.5600538 Vali Loss: 0.5781166 Best vali loss: 0.5596096
	iters: 100, epoch: 5 | loss: 0.8941082
	speed: 0.0118s/iter; left time: 22.0003s
	iters: 200, epoch: 5 | loss: 0.6267151
	speed: 0.0044s/iter; left time: 7.7534s
	iters: 300, epoch: 5 | loss: 0.7441302
	speed: 0.0042s/iter; left time: 7.0052s
	iters: 400, epoch: 5 | loss: 0.7171254
	speed: 0.0043s/iter; left time: 6.6507s
Updating learning rate to 2.9002285411968942e-05
Validation loss decreased (0.5596 --> 0.5563).  Saving model state dict ...
Epoch: 5 cost time: 2.1792960166931152
Epoch: 5, Steps: 490 | Train Loss: 0.7455197 Vali Loss: 0.5563491 Best vali loss: 0.5563491
	iters: 100, epoch: 6 | loss: 1.0998492
	speed: 0.0124s/iter; left time: 16.9632s
	iters: 200, epoch: 6 | loss: 0.4559738
	speed: 0.0043s/iter; left time: 5.4033s
	iters: 300, epoch: 6 | loss: 0.7587139
	speed: 0.0045s/iter; left time: 5.2248s
	iters: 400, epoch: 6 | loss: 0.5452476
	speed: 0.0045s/iter; left time: 4.8699s
Updating learning rate to 1.376048072029363e-05
Epoch: 6 cost time: 2.199655771255493
Epoch: 6, Steps: 490 | Train Loss: 0.7149461 Vali Loss: 0.5606979 Best vali loss: 0.5563491
	iters: 100, epoch: 7 | loss: 0.6667989
	speed: 0.0123s/iter; left time: 10.8187s
	iters: 200, epoch: 7 | loss: 0.9405181
	speed: 0.0046s/iter; left time: 3.5659s
	iters: 300, epoch: 7 | loss: 1.0991995
	speed: 0.0045s/iter; left time: 3.0700s
	iters: 400, epoch: 7 | loss: 0.3935746
	speed: 0.0045s/iter; left time: 2.6426s
Updating learning rate to 3.5762324219780384e-06
Epoch: 7 cost time: 2.2626142501831055
Epoch: 7, Steps: 490 | Train Loss: 0.7750228 Vali Loss: 0.5609217 Best vali loss: 0.5563491
	iters: 100, epoch: 8 | loss: 0.4328802
	speed: 0.0123s/iter; left time: 4.8158s
	iters: 200, epoch: 8 | loss: 1.0459955
	speed: 0.0045s/iter; left time: 1.3188s
	iters: 300, epoch: 8 | loss: 0.4585454
	speed: 0.0045s/iter; left time: 0.8677s
	iters: 400, epoch: 8 | loss: 0.5017779
	speed: 0.0046s/iter; left time: 0.4182s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2926578521728516
Epoch: 8, Steps: 490 | Train Loss: 0.6097998 Vali Loss: 0.5582591 Best vali loss: 0.5563491

best validation loss 0.5563491468405293

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0099671748029, 'e_layers': 3, 'learning_rate': 0.0004363161189, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0407306
	speed: 0.0110s/iter; left time: 9.7118s
Updating learning rate to 0.0004197098254282355
Validation loss decreased (inf --> 0.6049).  Saving model state dict ...
Epoch: 1 cost time: 0.9531049728393555
Epoch: 1, Steps: 123 | Train Loss: 1.0407306 Vali Loss: 0.6049081 Best vali loss: 0.6049081
	iters: 100, epoch: 2 | loss: 0.7758380
	speed: 0.0083s/iter; left time: 6.3510s
Updating learning rate to 0.00037241910265759296
Epoch: 2 cost time: 0.6558551788330078
Epoch: 2, Steps: 123 | Train Loss: 0.7758380 Vali Loss: 0.6133298 Best vali loss: 0.6049081
	iters: 100, epoch: 3 | loss: 0.7995982
	speed: 0.0085s/iter; left time: 5.4331s
Updating learning rate to 0.0003016435344384333
Validation loss decreased (0.6049 --> 0.5924).  Saving model state dict ...
Epoch: 3 cost time: 0.7070159912109375
Epoch: 3, Steps: 123 | Train Loss: 0.7995982 Vali Loss: 0.5923827 Best vali loss: 0.5923827
	iters: 100, epoch: 4 | loss: 0.8130723
	speed: 0.0090s/iter; left time: 4.6635s
Updating learning rate to 0.00021815805945
Validation loss decreased (0.5924 --> 0.5598).  Saving model state dict ...
Epoch: 4 cost time: 0.7301027774810791
Epoch: 4, Steps: 123 | Train Loss: 0.8130723 Vali Loss: 0.5597741 Best vali loss: 0.5597741
	iters: 100, epoch: 5 | loss: 0.6708880
	speed: 0.0091s/iter; left time: 3.5672s
Updating learning rate to 0.0001346725844615667
Epoch: 5 cost time: 0.7249264717102051
Epoch: 5, Steps: 123 | Train Loss: 0.6708880 Vali Loss: 0.5701885 Best vali loss: 0.5597741
	iters: 100, epoch: 6 | loss: 0.5966698
	speed: 0.0087s/iter; left time: 2.3407s
Updating learning rate to 6.389701624240704e-05
Validation loss decreased (0.5598 --> 0.5524).  Saving model state dict ...
Epoch: 6 cost time: 0.7128844261169434
Epoch: 6, Steps: 123 | Train Loss: 0.5966698 Vali Loss: 0.5523615 Best vali loss: 0.5523615
	iters: 100, epoch: 7 | loss: 0.7842793
	speed: 0.0089s/iter; left time: 1.3024s
Updating learning rate to 1.66062934717645e-05
Epoch: 7 cost time: 0.6964912414550781
Epoch: 7, Steps: 123 | Train Loss: 0.7842793 Vali Loss: 0.5639966 Best vali loss: 0.5523615
	iters: 100, epoch: 8 | loss: 0.6452436
	speed: 0.0084s/iter; left time: 0.2017s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6805508136749268
Epoch: 8, Steps: 123 | Train Loss: 0.6452436 Vali Loss: 0.5644395 Best vali loss: 0.5523615

best validation loss 0.5523614630496154

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013789685476, 'e_layers': 2, 'learning_rate': 0.0023195317067, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0545186
	speed: 0.0102s/iter; left time: 18.9766s
	iters: 200, epoch: 1 | loss: 1.2715383
	speed: 0.0041s/iter; left time: 7.1672s
Updating learning rate to 0.0023195317067
Validation loss decreased (inf --> 0.6400).  Saving model state dict ...
Epoch: 1 cost time: 1.3467068672180176
Epoch: 1, Steps: 245 | Train Loss: 1.1630284 Vali Loss: 0.6400426 Best vali loss: 0.6400426
	iters: 100, epoch: 2 | loss: 0.5786923
	speed: 0.0080s/iter; left time: 12.9280s
	iters: 200, epoch: 2 | loss: 0.9447811
	speed: 0.0036s/iter; left time: 5.5208s
Updating learning rate to 0.00115976585335
Validation loss decreased (0.6400 --> 0.6204).  Saving model state dict ...
Epoch: 2 cost time: 0.9368605613708496
Epoch: 2, Steps: 245 | Train Loss: 0.7617367 Vali Loss: 0.6203991 Best vali loss: 0.6203991
	iters: 100, epoch: 3 | loss: 0.8759149
	speed: 0.0082s/iter; left time: 11.2015s
	iters: 200, epoch: 3 | loss: 1.0553111
	speed: 0.0036s/iter; left time: 4.6086s
Updating learning rate to 0.000579882926675
Validation loss decreased (0.6204 --> 0.6189).  Saving model state dict ...
Epoch: 3 cost time: 0.954005241394043
Epoch: 3, Steps: 245 | Train Loss: 0.9656130 Vali Loss: 0.6188919 Best vali loss: 0.6188919
	iters: 100, epoch: 4 | loss: 0.9615285
	speed: 0.0081s/iter; left time: 9.0994s
	iters: 200, epoch: 4 | loss: 0.6774127
	speed: 0.0038s/iter; left time: 3.9339s
Updating learning rate to 0.0002899414633375
Validation loss decreased (0.6189 --> 0.6157).  Saving model state dict ...
Epoch: 4 cost time: 0.9876186847686768
Epoch: 4, Steps: 245 | Train Loss: 0.8194706 Vali Loss: 0.6156981 Best vali loss: 0.6156981
	iters: 100, epoch: 5 | loss: 0.7440356
	speed: 0.0086s/iter; left time: 7.5891s
	iters: 200, epoch: 5 | loss: 0.4571581
	speed: 0.0043s/iter; left time: 3.3269s
Updating learning rate to 0.00014497073166875
Epoch: 5 cost time: 1.0761682987213135
Epoch: 5, Steps: 245 | Train Loss: 0.6005968 Vali Loss: 0.6349107 Best vali loss: 0.6156981
	iters: 100, epoch: 6 | loss: 0.7348821
	speed: 0.0083s/iter; left time: 5.2868s
	iters: 200, epoch: 6 | loss: 0.6443501
	speed: 0.0040s/iter; left time: 2.1212s
Updating learning rate to 7.2485365834375e-05
Epoch: 6 cost time: 1.024362325668335
Epoch: 6, Steps: 245 | Train Loss: 0.6896161 Vali Loss: 0.6263014 Best vali loss: 0.6156981
	iters: 100, epoch: 7 | loss: 0.8365447
	speed: 0.0084s/iter; left time: 3.3032s
	iters: 200, epoch: 7 | loss: 0.5462270
	speed: 0.0039s/iter; left time: 1.1325s
Updating learning rate to 3.62426829171875e-05
Epoch: 7 cost time: 1.007535696029663
Epoch: 7, Steps: 245 | Train Loss: 0.6913859 Vali Loss: 0.6288592 Best vali loss: 0.6156981
	iters: 100, epoch: 8 | loss: 0.9286219
	speed: 0.0082s/iter; left time: 1.1906s
	iters: 200, epoch: 8 | loss: 0.7055083
	speed: 0.0038s/iter; left time: 0.1731s
Updating learning rate to 1.812134145859375e-05
Epoch: 8 cost time: 0.9831855297088623
Epoch: 8, Steps: 245 | Train Loss: 0.8170651 Vali Loss: 0.6302646 Best vali loss: 0.6156981

best validation loss 0.6156980574324086

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020604122475, 'e_layers': 4, 'learning_rate': 0.0027254995725, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7507818
	speed: 0.0120s/iter; left time: 10.6105s
Updating learning rate to 0.0027254995725
Validation loss decreased (inf --> 0.6699).  Saving model state dict ...
Epoch: 1 cost time: 1.075674057006836
Epoch: 1, Steps: 123 | Train Loss: 0.7507818 Vali Loss: 0.6699109 Best vali loss: 0.6699109
	iters: 100, epoch: 2 | loss: 0.7281204
	speed: 0.0101s/iter; left time: 7.6800s
Updating learning rate to 0.00136274978625
Validation loss decreased (0.6699 --> 0.6476).  Saving model state dict ...
Epoch: 2 cost time: 0.8381431102752686
Epoch: 2, Steps: 123 | Train Loss: 0.7281204 Vali Loss: 0.6476071 Best vali loss: 0.6476071
	iters: 100, epoch: 3 | loss: 0.8719234
	speed: 0.0102s/iter; left time: 6.5283s
Updating learning rate to 0.000681374893125
Epoch: 3 cost time: 0.8475959300994873
Epoch: 3, Steps: 123 | Train Loss: 0.8719234 Vali Loss: 0.6486746 Best vali loss: 0.6476071

best validation loss 0.6476070823795207

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009167036343, 'e_layers': 3, 'learning_rate': 0.000160104319, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0770558
	speed: 0.0108s/iter; left time: 41.4467s
	iters: 200, epoch: 1 | loss: 0.6703640
	speed: 0.0047s/iter; left time: 17.3689s
	iters: 300, epoch: 1 | loss: 1.7010942
	speed: 0.0046s/iter; left time: 16.4929s
	iters: 400, epoch: 1 | loss: 0.5332344
	speed: 0.0046s/iter; left time: 16.3688s
Updating learning rate to 0.000160104319
Validation loss decreased (inf --> 0.6167).  Saving model state dict ...
Epoch: 1 cost time: 2.6292245388031006
Epoch: 1, Steps: 490 | Train Loss: 0.9954371 Vali Loss: 0.6166640 Best vali loss: 0.6166640
	iters: 100, epoch: 2 | loss: 0.7819819
	speed: 0.0123s/iter; left time: 40.9905s
	iters: 200, epoch: 2 | loss: 0.5600173
	speed: 0.0041s/iter; left time: 13.4055s
	iters: 300, epoch: 2 | loss: 1.0708321
	speed: 0.0041s/iter; left time: 12.8152s
	iters: 400, epoch: 2 | loss: 1.3693800
	speed: 0.0041s/iter; left time: 12.4140s
Updating learning rate to 8.00521595e-05
Validation loss decreased (0.6167 --> 0.5769).  Saving model state dict ...
Epoch: 2 cost time: 2.0755326747894287
Epoch: 2, Steps: 490 | Train Loss: 0.9455528 Vali Loss: 0.5769372 Best vali loss: 0.5769372
	iters: 100, epoch: 3 | loss: 0.7337028
	speed: 0.0119s/iter; left time: 33.8636s
	iters: 200, epoch: 3 | loss: 0.4100932
	speed: 0.0042s/iter; left time: 11.4475s
	iters: 300, epoch: 3 | loss: 0.6545584
	speed: 0.0041s/iter; left time: 10.9196s
	iters: 400, epoch: 3 | loss: 0.5314462
	speed: 0.0047s/iter; left time: 11.8787s
Updating learning rate to 4.002607975e-05
Validation loss decreased (0.5769 --> 0.5498).  Saving model state dict ...
Epoch: 3 cost time: 2.153273582458496
Epoch: 3, Steps: 490 | Train Loss: 0.5824502 Vali Loss: 0.5497591 Best vali loss: 0.5497591

best validation loss 0.5497590800999823

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008867018293, 'e_layers': 3, 'learning_rate': 0.0001512361072, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0770719
	speed: 0.0106s/iter; left time: 40.6126s
	iters: 200, epoch: 1 | loss: 0.6696703
	speed: 0.0046s/iter; left time: 16.9461s
	iters: 300, epoch: 1 | loss: 1.7036529
	speed: 0.0046s/iter; left time: 16.5509s
	iters: 400, epoch: 1 | loss: 0.5252352
	speed: 0.0045s/iter; left time: 15.7686s
Updating learning rate to 0.0001512361072
Validation loss decreased (inf --> 0.6152).  Saving model state dict ...
Epoch: 1 cost time: 2.566476583480835
Epoch: 1, Steps: 490 | Train Loss: 0.9939076 Vali Loss: 0.6152371 Best vali loss: 0.6152371
	iters: 100, epoch: 2 | loss: 0.7927361
	speed: 0.0126s/iter; left time: 42.0595s
	iters: 200, epoch: 2 | loss: 0.5630120
	speed: 0.0045s/iter; left time: 14.5251s
	iters: 300, epoch: 2 | loss: 1.0496588
	speed: 0.0044s/iter; left time: 13.8822s
	iters: 400, epoch: 2 | loss: 1.3324652
	speed: 0.0044s/iter; left time: 13.1901s
Updating learning rate to 7.56180536e-05
Validation loss decreased (0.6152 --> 0.5655).  Saving model state dict ...
Epoch: 2 cost time: 2.237109661102295
Epoch: 2, Steps: 490 | Train Loss: 0.9344680 Vali Loss: 0.5655103 Best vali loss: 0.5655103
	iters: 100, epoch: 3 | loss: 0.7333671
	speed: 0.0126s/iter; left time: 35.7950s
	iters: 200, epoch: 3 | loss: 0.4142982
	speed: 0.0043s/iter; left time: 11.8554s
	iters: 300, epoch: 3 | loss: 0.6684680
	speed: 0.0042s/iter; left time: 11.2008s
	iters: 400, epoch: 3 | loss: 0.5365238
	speed: 0.0042s/iter; left time: 10.7975s
Updating learning rate to 3.78090268e-05
Validation loss decreased (0.5655 --> 0.5548).  Saving model state dict ...
Epoch: 3 cost time: 2.1476619243621826
Epoch: 3, Steps: 490 | Train Loss: 0.5881643 Vali Loss: 0.5548371 Best vali loss: 0.5548371

best validation loss 0.5548370801591587

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009167036343, 'e_layers': 3, 'learning_rate': 0.000160104319, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9029505
	speed: 0.0111s/iter; left time: 26.1531s
	iters: 200, epoch: 4 | loss: 0.3770287
	speed: 0.0046s/iter; left time: 10.3321s
	iters: 300, epoch: 4 | loss: 1.5190212
	speed: 0.0045s/iter; left time: 9.7645s
	iters: 400, epoch: 4 | loss: 0.3604611
	speed: 0.0046s/iter; left time: 9.3895s
Updating learning rate to 2.0013039875e-05
Validation loss decreased (0.5498 --> 0.5366).  Saving model state dict ...
Epoch: 4 cost time: 2.6055426597595215
Epoch: 4, Steps: 490 | Train Loss: 0.7898654 Vali Loss: 0.5366145 Best vali loss: 0.5366145
	iters: 100, epoch: 5 | loss: 0.6914625
	speed: 0.0126s/iter; left time: 23.5297s
	iters: 200, epoch: 5 | loss: 0.4758132
	speed: 0.0041s/iter; left time: 7.2224s
	iters: 300, epoch: 5 | loss: 0.8390883
	speed: 0.0042s/iter; left time: 7.0447s
	iters: 400, epoch: 5 | loss: 1.0665168
	speed: 0.0042s/iter; left time: 6.5372s
Updating learning rate to 1.00065199375e-05
Validation loss decreased (0.5366 --> 0.5363).  Saving model state dict ...
Epoch: 5 cost time: 2.081303596496582
Epoch: 5, Steps: 490 | Train Loss: 0.7682202 Vali Loss: 0.5362799 Best vali loss: 0.5362799
	iters: 100, epoch: 6 | loss: 0.6596019
	speed: 0.0116s/iter; left time: 15.8557s
	iters: 200, epoch: 6 | loss: 0.3519481
	speed: 0.0040s/iter; left time: 5.1234s
	iters: 300, epoch: 6 | loss: 0.5589812
	speed: 0.0041s/iter; left time: 4.8278s
	iters: 400, epoch: 6 | loss: 0.5033560
	speed: 0.0042s/iter; left time: 4.4698s
Updating learning rate to 5.00325996875e-06
Validation loss decreased (0.5363 --> 0.5340).  Saving model state dict ...
Epoch: 6 cost time: 2.1026852130889893
Epoch: 6, Steps: 490 | Train Loss: 0.5184718 Vali Loss: 0.5340092 Best vali loss: 0.5340092
	iters: 100, epoch: 7 | loss: 0.6921851
	speed: 0.0123s/iter; left time: 10.8673s
	iters: 200, epoch: 7 | loss: 0.5337145
	speed: 0.0040s/iter; left time: 3.1595s
	iters: 300, epoch: 7 | loss: 0.8112241
	speed: 0.0040s/iter; left time: 2.7364s
	iters: 400, epoch: 7 | loss: 0.7645732
	speed: 0.0041s/iter; left time: 2.3918s
Updating learning rate to 2.501629984375e-06
Epoch: 7 cost time: 2.0519912242889404
Epoch: 7, Steps: 490 | Train Loss: 0.7004242 Vali Loss: 0.5354798 Best vali loss: 0.5340092
	iters: 100, epoch: 8 | loss: 0.8181096
	speed: 0.0119s/iter; left time: 4.6455s
	iters: 200, epoch: 8 | loss: 0.3496603
	speed: 0.0042s/iter; left time: 1.2343s
	iters: 300, epoch: 8 | loss: 0.9634792
	speed: 0.0042s/iter; left time: 0.7959s
	iters: 400, epoch: 8 | loss: 0.5740694
	speed: 0.0041s/iter; left time: 0.3748s
Updating learning rate to 1.2508149921875e-06
Epoch: 8 cost time: 2.1312432289123535
Epoch: 8, Steps: 490 | Train Loss: 0.6763296 Vali Loss: 0.5362587 Best vali loss: 0.5340092

best validation loss 0.5340091952401584

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009902274822, 'e_layers': 3, 'learning_rate': 0.0001469301691, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0771823
	speed: 0.0103s/iter; left time: 39.2747s
	iters: 200, epoch: 1 | loss: 0.6697831
	speed: 0.0041s/iter; left time: 15.3545s
	iters: 300, epoch: 1 | loss: 1.7047348
	speed: 0.0041s/iter; left time: 14.8560s
	iters: 400, epoch: 1 | loss: 0.5255845
	speed: 0.0041s/iter; left time: 14.5653s
Updating learning rate to 0.0001469301691
Validation loss decreased (inf --> 0.6155).  Saving model state dict ...
Epoch: 1 cost time: 2.3947951793670654
Epoch: 1, Steps: 490 | Train Loss: 0.9943212 Vali Loss: 0.6154511 Best vali loss: 0.6154511
	iters: 100, epoch: 2 | loss: 0.7951688
	speed: 0.0122s/iter; left time: 40.6593s
	iters: 200, epoch: 2 | loss: 0.5676553
	speed: 0.0045s/iter; left time: 14.4654s
	iters: 300, epoch: 2 | loss: 1.0952429
	speed: 0.0046s/iter; left time: 14.4567s
	iters: 400, epoch: 2 | loss: 1.3145119
	speed: 0.0047s/iter; left time: 14.1297s
Updating learning rate to 7.346508455e-05
Validation loss decreased (0.6155 --> 0.5789).  Saving model state dict ...
Epoch: 2 cost time: 2.2922654151916504
Epoch: 2, Steps: 490 | Train Loss: 0.9431447 Vali Loss: 0.5788988 Best vali loss: 0.5788988
	iters: 100, epoch: 3 | loss: 0.7290609
	speed: 0.0129s/iter; left time: 36.6550s
	iters: 200, epoch: 3 | loss: 0.4162061
	speed: 0.0047s/iter; left time: 12.8200s
	iters: 300, epoch: 3 | loss: 0.6579064
	speed: 0.0047s/iter; left time: 12.3016s
	iters: 400, epoch: 3 | loss: 0.5428062
	speed: 0.0045s/iter; left time: 11.4158s
Updating learning rate to 3.6732542275e-05
Validation loss decreased (0.5789 --> 0.5482).  Saving model state dict ...
Epoch: 3 cost time: 2.3034822940826416
Epoch: 3, Steps: 490 | Train Loss: 0.5864949 Vali Loss: 0.5481837 Best vali loss: 0.5481837
	iters: 100, epoch: 4 | loss: 0.7302038
	speed: 0.0130s/iter; left time: 30.5004s
	iters: 200, epoch: 4 | loss: 0.5725683
	speed: 0.0048s/iter; left time: 10.7337s
	iters: 300, epoch: 4 | loss: 0.8250569
	speed: 0.0048s/iter; left time: 10.2362s
	iters: 400, epoch: 4 | loss: 0.8006026
	speed: 0.0042s/iter; left time: 8.6356s
Updating learning rate to 1.83662711375e-05
Validation loss decreased (0.5482 --> 0.5437).  Saving model state dict ...
Epoch: 4 cost time: 2.268974781036377
Epoch: 4, Steps: 490 | Train Loss: 0.7321079 Vali Loss: 0.5437430 Best vali loss: 0.5437430
	iters: 100, epoch: 5 | loss: 0.8496410
	speed: 0.0122s/iter; left time: 22.7788s
	iters: 200, epoch: 5 | loss: 0.3826254
	speed: 0.0042s/iter; left time: 7.3980s
	iters: 300, epoch: 5 | loss: 1.0034953
	speed: 0.0042s/iter; left time: 6.9319s
	iters: 400, epoch: 5 | loss: 0.5813383
	speed: 0.0041s/iter; left time: 6.3618s
Updating learning rate to 9.18313556875e-06
Validation loss decreased (0.5437 --> 0.5362).  Saving model state dict ...
Epoch: 5 cost time: 2.078930377960205
Epoch: 5, Steps: 490 | Train Loss: 0.7042750 Vali Loss: 0.5361801 Best vali loss: 0.5361801
	iters: 100, epoch: 6 | loss: 0.5827999
	speed: 0.0119s/iter; left time: 16.2925s
	iters: 200, epoch: 6 | loss: 0.9351410
	speed: 0.0042s/iter; left time: 5.3099s
	iters: 300, epoch: 6 | loss: 0.4608759
	speed: 0.0041s/iter; left time: 4.7576s
	iters: 400, epoch: 6 | loss: 0.8842514
	speed: 0.0041s/iter; left time: 4.3894s
Updating learning rate to 4.591567784375e-06
Epoch: 6 cost time: 2.0521390438079834
Epoch: 6, Steps: 490 | Train Loss: 0.7157670 Vali Loss: 0.5392076 Best vali loss: 0.5361801
	iters: 100, epoch: 7 | loss: 0.5206753
	speed: 0.0112s/iter; left time: 9.8985s
	iters: 200, epoch: 7 | loss: 0.5726330
	speed: 0.0040s/iter; left time: 3.0966s
	iters: 300, epoch: 7 | loss: 0.5789496
	speed: 0.0040s/iter; left time: 2.7180s
	iters: 400, epoch: 7 | loss: 0.4437498
	speed: 0.0041s/iter; left time: 2.3732s
Updating learning rate to 2.2957838921875e-06
Epoch: 7 cost time: 2.010234832763672
Epoch: 7, Steps: 490 | Train Loss: 0.5290019 Vali Loss: 0.5394001 Best vali loss: 0.5361801
	iters: 100, epoch: 8 | loss: 0.3907084
	speed: 0.0120s/iter; left time: 4.6973s
	iters: 200, epoch: 8 | loss: 0.5752323
	speed: 0.0047s/iter; left time: 1.3659s
	iters: 300, epoch: 8 | loss: 0.5029181
	speed: 0.0046s/iter; left time: 0.8793s
	iters: 400, epoch: 8 | loss: 0.8409134
	speed: 0.0045s/iter; left time: 0.4106s
Updating learning rate to 1.14789194609375e-06
Epoch: 8 cost time: 2.3006584644317627
Epoch: 8, Steps: 490 | Train Loss: 0.5774430 Vali Loss: 0.5395776 Best vali loss: 0.5361801

best validation loss 0.5361801448835372

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010349490817, 'e_layers': 3, 'learning_rate': 0.0004676258806, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0204885
	speed: 0.0103s/iter; left time: 79.8626s
	iters: 200, epoch: 1 | loss: 0.9443918
	speed: 0.0043s/iter; left time: 33.0413s
	iters: 300, epoch: 1 | loss: 1.9060644
	speed: 0.0042s/iter; left time: 31.8259s
	iters: 400, epoch: 1 | loss: 0.2835446
	speed: 0.0043s/iter; left time: 32.1038s
	iters: 500, epoch: 1 | loss: 1.2552496
	speed: 0.0044s/iter; left time: 31.9309s
	iters: 600, epoch: 1 | loss: 1.2438508
	speed: 0.0042s/iter; left time: 30.3701s
	iters: 700, epoch: 1 | loss: 0.3718350
	speed: 0.0040s/iter; left time: 28.5058s
	iters: 800, epoch: 1 | loss: 0.9496017
	speed: 0.0041s/iter; left time: 29.1513s
	iters: 900, epoch: 1 | loss: 0.7881880
	speed: 0.0039s/iter; left time: 26.8260s
Updating learning rate to 0.0004498279302794534
Validation loss decreased (inf --> 0.6115).  Saving model state dict ...
Epoch: 1 cost time: 4.425509929656982
Epoch: 1, Steps: 979 | Train Loss: 0.9736905 Vali Loss: 0.6115262 Best vali loss: 0.6115262
	iters: 100, epoch: 2 | loss: 0.7683935
	speed: 0.0132s/iter; left time: 89.0579s
	iters: 200, epoch: 2 | loss: 1.5788573
	speed: 0.0041s/iter; left time: 27.1151s
	iters: 300, epoch: 2 | loss: 0.6376023
	speed: 0.0040s/iter; left time: 26.4541s
	iters: 400, epoch: 2 | loss: 1.0006677
	speed: 0.0041s/iter; left time: 26.3412s
	iters: 500, epoch: 2 | loss: 0.3927946
	speed: 0.0040s/iter; left time: 25.4737s
	iters: 600, epoch: 2 | loss: 1.1523917
	speed: 0.0041s/iter; left time: 25.4183s
	iters: 700, epoch: 2 | loss: 0.6210538
	speed: 0.0040s/iter; left time: 24.7404s
	iters: 800, epoch: 2 | loss: 0.9114998
	speed: 0.0040s/iter; left time: 24.2182s
	iters: 900, epoch: 2 | loss: 1.4618645
	speed: 0.0041s/iter; left time: 24.2210s
Updating learning rate to 0.00039914365591529535
Epoch: 2 cost time: 4.010883569717407
Epoch: 2, Steps: 979 | Train Loss: 0.9472361 Vali Loss: 0.6137413 Best vali loss: 0.6115262
	iters: 100, epoch: 3 | loss: 1.5973749
	speed: 0.0134s/iter; left time: 77.3768s
	iters: 200, epoch: 3 | loss: 0.2799436
	speed: 0.0043s/iter; left time: 24.3558s
	iters: 300, epoch: 3 | loss: 1.8865417
	speed: 0.0042s/iter; left time: 23.5558s
	iters: 400, epoch: 3 | loss: 0.5248560
	speed: 0.0042s/iter; left time: 23.1317s
	iters: 500, epoch: 3 | loss: 0.8566126
	speed: 0.0043s/iter; left time: 22.8462s
	iters: 600, epoch: 3 | loss: 1.2837667
	speed: 0.0040s/iter; left time: 21.1863s
	iters: 700, epoch: 3 | loss: 0.6797206
	speed: 0.0039s/iter; left time: 20.0538s
	iters: 800, epoch: 3 | loss: 0.7471718
	speed: 0.0040s/iter; left time: 20.5279s
	iters: 900, epoch: 3 | loss: 0.9010510
	speed: 0.0038s/iter; left time: 19.0784s
Updating learning rate to 0.0003232892788253778
Epoch: 3 cost time: 4.05807089805603
Epoch: 3, Steps: 979 | Train Loss: 0.9730043 Vali Loss: 0.6276133 Best vali loss: 0.6115262
	iters: 100, epoch: 4 | loss: 0.6940061
	speed: 0.0132s/iter; left time: 63.3781s
	iters: 200, epoch: 4 | loss: 1.3501177
	speed: 0.0042s/iter; left time: 19.9569s
	iters: 300, epoch: 4 | loss: 1.5688367
	speed: 0.0042s/iter; left time: 19.4004s
	iters: 400, epoch: 4 | loss: 1.0015931
	speed: 0.0041s/iter; left time: 18.6035s
	iters: 500, epoch: 4 | loss: 0.5405606
	speed: 0.0040s/iter; left time: 17.7143s
	iters: 600, epoch: 4 | loss: 0.2730623
	speed: 0.0043s/iter; left time: 18.4049s
	iters: 700, epoch: 4 | loss: 0.6628509
	speed: 0.0042s/iter; left time: 17.8214s
	iters: 800, epoch: 4 | loss: 1.4803061
	speed: 0.0042s/iter; left time: 17.1904s
	iters: 900, epoch: 4 | loss: 1.1693462
	speed: 0.0042s/iter; left time: 16.8855s
Updating learning rate to 0.0002338129403
Validation loss decreased (0.6115 --> 0.6077).  Saving model state dict ...
Epoch: 4 cost time: 4.1866841316223145
Epoch: 4, Steps: 979 | Train Loss: 0.9711867 Vali Loss: 0.6076856 Best vali loss: 0.6076856
	iters: 100, epoch: 5 | loss: 0.5931760
	speed: 0.0134s/iter; left time: 51.1718s
	iters: 200, epoch: 5 | loss: 0.6979551
	speed: 0.0043s/iter; left time: 15.9036s
	iters: 300, epoch: 5 | loss: 1.1351252
	speed: 0.0044s/iter; left time: 15.9267s
	iters: 400, epoch: 5 | loss: 0.7672749
	speed: 0.0043s/iter; left time: 15.0075s
	iters: 500, epoch: 5 | loss: 1.4979484
	speed: 0.0042s/iter; left time: 14.4411s
	iters: 600, epoch: 5 | loss: 0.5869827
	speed: 0.0041s/iter; left time: 13.5810s
	iters: 700, epoch: 5 | loss: 0.6207753
	speed: 0.0039s/iter; left time: 12.5641s
	iters: 800, epoch: 5 | loss: 1.0395253
	speed: 0.0040s/iter; left time: 12.4478s
	iters: 900, epoch: 5 | loss: 0.4469242
	speed: 0.0043s/iter; left time: 12.8282s
Updating learning rate to 0.0001443366017746222
Validation loss decreased (0.6077 --> 0.6048).  Saving model state dict ...
Epoch: 5 cost time: 4.155975818634033
Epoch: 5, Steps: 979 | Train Loss: 0.8206319 Vali Loss: 0.6047518 Best vali loss: 0.6047518
	iters: 100, epoch: 6 | loss: 0.6046073
	speed: 0.0134s/iter; left time: 37.9311s
	iters: 200, epoch: 6 | loss: 0.9590309
	speed: 0.0043s/iter; left time: 11.6594s
	iters: 300, epoch: 6 | loss: 0.5943844
	speed: 0.0044s/iter; left time: 11.6390s
	iters: 400, epoch: 6 | loss: 0.6739978
	speed: 0.0043s/iter; left time: 10.8955s
	iters: 500, epoch: 6 | loss: 0.4964154
	speed: 0.0039s/iter; left time: 9.5437s
	iters: 600, epoch: 6 | loss: 0.3536396
	speed: 0.0039s/iter; left time: 9.0277s
	iters: 700, epoch: 6 | loss: 1.5790135
	speed: 0.0039s/iter; left time: 8.7341s
	iters: 800, epoch: 6 | loss: 1.2697781
	speed: 0.0038s/iter; left time: 8.1316s
	iters: 900, epoch: 6 | loss: 0.5777859
	speed: 0.0039s/iter; left time: 7.8876s
Updating learning rate to 6.848222468470461e-05
Epoch: 6 cost time: 3.972374677658081
Epoch: 6, Steps: 979 | Train Loss: 0.7898503 Vali Loss: 0.6321282 Best vali loss: 0.6047518
	iters: 100, epoch: 7 | loss: 0.4830855
	speed: 0.0127s/iter; left time: 23.5467s
	iters: 200, epoch: 7 | loss: 0.7684172
	speed: 0.0038s/iter; left time: 6.7665s
	iters: 300, epoch: 7 | loss: 0.3413758
	speed: 0.0039s/iter; left time: 6.4429s
	iters: 400, epoch: 7 | loss: 0.7329377
	speed: 0.0038s/iter; left time: 5.9649s
	iters: 500, epoch: 7 | loss: 0.7461216
	speed: 0.0039s/iter; left time: 5.7260s
	iters: 600, epoch: 7 | loss: 1.2876542
	speed: 0.0040s/iter; left time: 5.3969s
	iters: 700, epoch: 7 | loss: 0.5526475
	speed: 0.0039s/iter; left time: 4.9192s
	iters: 800, epoch: 7 | loss: 0.4001061
	speed: 0.0037s/iter; left time: 4.2649s
	iters: 900, epoch: 7 | loss: 0.9398823
	speed: 0.0037s/iter; left time: 3.8925s
Updating learning rate to 1.7797950320546603e-05
Epoch: 7 cost time: 3.8040361404418945
Epoch: 7, Steps: 979 | Train Loss: 0.6946920 Vali Loss: 0.6288348 Best vali loss: 0.6047518
	iters: 100, epoch: 8 | loss: 1.1103110
	speed: 0.0124s/iter; left time: 10.9383s
	iters: 200, epoch: 8 | loss: 0.2930152
	speed: 0.0037s/iter; left time: 2.9169s
	iters: 300, epoch: 8 | loss: 1.2200668
	speed: 0.0039s/iter; left time: 2.6497s
	iters: 400, epoch: 8 | loss: 0.2509020
	speed: 0.0039s/iter; left time: 2.2703s
	iters: 500, epoch: 8 | loss: 0.9926004
	speed: 0.0038s/iter; left time: 1.8385s
	iters: 600, epoch: 8 | loss: 0.4973124
	speed: 0.0038s/iter; left time: 1.4605s
	iters: 700, epoch: 8 | loss: 0.3212470
	speed: 0.0039s/iter; left time: 1.1019s
	iters: 800, epoch: 8 | loss: 0.9282516
	speed: 0.0040s/iter; left time: 0.7126s
	iters: 900, epoch: 8 | loss: 0.5117316
	speed: 0.0040s/iter; left time: 0.3240s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.862802505493164
Epoch: 8, Steps: 979 | Train Loss: 0.6806042 Vali Loss: 0.6401664 Best vali loss: 0.6047518

best validation loss 0.6047517576740605

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.001032677716, 'e_layers': 3, 'learning_rate': 0.0004175435981, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0171205
	speed: 0.0102s/iter; left time: 78.6768s
	iters: 200, epoch: 1 | loss: 0.9455238
	speed: 0.0041s/iter; left time: 31.0006s
	iters: 300, epoch: 1 | loss: 1.8101431
	speed: 0.0040s/iter; left time: 30.2001s
	iters: 400, epoch: 1 | loss: 0.2935397
	speed: 0.0042s/iter; left time: 31.0383s
	iters: 500, epoch: 1 | loss: 1.2359501
	speed: 0.0041s/iter; left time: 30.2693s
	iters: 600, epoch: 1 | loss: 1.2614363
	speed: 0.0041s/iter; left time: 29.2967s
	iters: 700, epoch: 1 | loss: 0.3681006
	speed: 0.0042s/iter; left time: 30.2408s
	iters: 800, epoch: 1 | loss: 0.9497479
	speed: 0.0042s/iter; left time: 29.5884s
	iters: 900, epoch: 1 | loss: 0.8496559
	speed: 0.0044s/iter; left time: 30.2723s
Updating learning rate to 0.0004016517911578543
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 4.417128562927246
Epoch: 1, Steps: 979 | Train Loss: 0.9701353 Vali Loss: 0.6116811 Best vali loss: 0.6116811
	iters: 100, epoch: 2 | loss: 0.7843409
	speed: 0.0132s/iter; left time: 89.3846s
	iters: 200, epoch: 2 | loss: 0.8956406
	speed: 0.0040s/iter; left time: 26.7976s
	iters: 300, epoch: 2 | loss: 0.6414528
	speed: 0.0045s/iter; left time: 29.2457s
	iters: 400, epoch: 2 | loss: 1.0001260
	speed: 0.0041s/iter; left time: 26.6887s
	iters: 500, epoch: 2 | loss: 0.3812558
	speed: 0.0040s/iter; left time: 25.6025s
	iters: 600, epoch: 2 | loss: 1.1670482
	speed: 0.0040s/iter; left time: 25.2317s
	iters: 700, epoch: 2 | loss: 0.7085527
	speed: 0.0039s/iter; left time: 24.0496s
	iters: 800, epoch: 2 | loss: 0.9197188
	speed: 0.0040s/iter; left time: 24.1713s
	iters: 900, epoch: 2 | loss: 1.4449581
	speed: 0.0040s/iter; left time: 23.8130s
Updating learning rate to 0.0003563957538787702
Epoch: 2 cost time: 4.039973020553589
Epoch: 2, Steps: 979 | Train Loss: 0.8825660 Vali Loss: 0.6299421 Best vali loss: 0.6116811
	iters: 100, epoch: 3 | loss: 1.5667630
	speed: 0.0131s/iter; left time: 75.5969s
	iters: 200, epoch: 3 | loss: 0.2971303
	speed: 0.0041s/iter; left time: 23.0202s
	iters: 300, epoch: 3 | loss: 2.0545201
	speed: 0.0041s/iter; left time: 22.9316s
	iters: 400, epoch: 3 | loss: 0.5772049
	speed: 0.0040s/iter; left time: 21.9889s
	iters: 500, epoch: 3 | loss: 0.8328276
	speed: 0.0040s/iter; left time: 21.2633s
	iters: 600, epoch: 3 | loss: 1.2593160
	speed: 0.0042s/iter; left time: 21.9660s
	iters: 700, epoch: 3 | loss: 0.7255875
	speed: 0.0041s/iter; left time: 21.0644s
	iters: 800, epoch: 3 | loss: 0.7444004
	speed: 0.0041s/iter; left time: 20.6819s
	iters: 900, epoch: 3 | loss: 1.0995653
	speed: 0.0041s/iter; left time: 20.3472s
Updating learning rate to 0.0002886653076914888
Epoch: 3 cost time: 4.02550196647644
Epoch: 3, Steps: 979 | Train Loss: 1.0174795 Vali Loss: 0.6287383 Best vali loss: 0.6116811

best validation loss 0.6116811074988813

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0009317537278, 'e_layers': 3, 'learning_rate': 0.0035993763562, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0923222
	speed: 0.0103s/iter; left time: 39.5257s
	iters: 200, epoch: 1 | loss: 1.1726384
	speed: 0.0043s/iter; left time: 15.8677s
	iters: 300, epoch: 1 | loss: 0.8636208
	speed: 0.0043s/iter; left time: 15.4445s
	iters: 400, epoch: 1 | loss: 0.8139536
	speed: 0.0043s/iter; left time: 15.3126s
Updating learning rate to 0.0034623832507491175
Validation loss decreased (inf --> 0.6493).  Saving model state dict ...
Epoch: 1 cost time: 2.4569990634918213
Epoch: 1, Steps: 490 | Train Loss: 0.9856338 Vali Loss: 0.6492611 Best vali loss: 0.6492611
	iters: 100, epoch: 2 | loss: 1.4182823
	speed: 0.0123s/iter; left time: 40.8902s
	iters: 200, epoch: 2 | loss: 0.7477286
	speed: 0.0044s/iter; left time: 14.1771s
	iters: 300, epoch: 2 | loss: 0.8566385
	speed: 0.0045s/iter; left time: 14.0805s
	iters: 400, epoch: 2 | loss: 0.7839245
	speed: 0.0044s/iter; left time: 13.3332s
Updating learning rate to 0.003072259892855773
Validation loss decreased (0.6493 --> 0.6390).  Saving model state dict ...
Epoch: 2 cost time: 2.240000009536743
Epoch: 2, Steps: 490 | Train Loss: 0.9516435 Vali Loss: 0.6390250 Best vali loss: 0.6390250
	iters: 100, epoch: 3 | loss: 0.9708318
	speed: 0.0119s/iter; left time: 33.7742s
	iters: 200, epoch: 3 | loss: 0.7338747
	speed: 0.0042s/iter; left time: 11.5646s
	iters: 300, epoch: 3 | loss: 0.9805771
	speed: 0.0040s/iter; left time: 10.5762s
	iters: 400, epoch: 3 | loss: 0.6042972
	speed: 0.0040s/iter; left time: 10.0409s
Updating learning rate to 0.002488399027282183
Epoch: 3 cost time: 2.046891927719116
Epoch: 3, Steps: 490 | Train Loss: 0.8223952 Vali Loss: 0.6442871 Best vali loss: 0.6390250

best validation loss 0.6390249640204629

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0041800835022, 'e_layers': 2, 'learning_rate': 0.0025569931201, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1067740
	speed: 0.0094s/iter; left time: 72.8707s
	iters: 200, epoch: 1 | loss: 0.3229422
	speed: 0.0033s/iter; left time: 25.5115s
	iters: 300, epoch: 1 | loss: 0.4330194
	speed: 0.0033s/iter; left time: 25.1619s
	iters: 400, epoch: 1 | loss: 0.5947843
	speed: 0.0035s/iter; left time: 25.7446s
	iters: 500, epoch: 1 | loss: 0.9173573
	speed: 0.0035s/iter; left time: 25.8795s
	iters: 600, epoch: 1 | loss: 0.6443799
	speed: 0.0035s/iter; left time: 25.4549s
	iters: 700, epoch: 1 | loss: 0.4020151
	speed: 0.0035s/iter; left time: 24.9294s
	iters: 800, epoch: 1 | loss: 0.8486990
	speed: 0.0034s/iter; left time: 23.9948s
	iters: 900, epoch: 1 | loss: 0.8600658
	speed: 0.0034s/iter; left time: 23.7291s
Updating learning rate to 0.0025569931201
Validation loss decreased (inf --> 0.6676).  Saving model state dict ...
Epoch: 1 cost time: 3.7107417583465576
Epoch: 1, Steps: 979 | Train Loss: 0.6811152 Vali Loss: 0.6675614 Best vali loss: 0.6675614
	iters: 100, epoch: 2 | loss: 1.1992160
	speed: 0.0111s/iter; left time: 75.2420s
	iters: 200, epoch: 2 | loss: 1.4963199
	speed: 0.0032s/iter; left time: 21.2646s
	iters: 300, epoch: 2 | loss: 1.1124284
	speed: 0.0033s/iter; left time: 21.3748s
	iters: 400, epoch: 2 | loss: 0.7023453
	speed: 0.0034s/iter; left time: 21.7891s
	iters: 500, epoch: 2 | loss: 1.5037342
	speed: 0.0032s/iter; left time: 20.1649s
	iters: 600, epoch: 2 | loss: 0.6056890
	speed: 0.0032s/iter; left time: 20.1829s
	iters: 700, epoch: 2 | loss: 0.6072689
	speed: 0.0031s/iter; left time: 19.3678s
	iters: 800, epoch: 2 | loss: 0.5677446
	speed: 0.0032s/iter; left time: 19.5772s
	iters: 900, epoch: 2 | loss: 0.8582808
	speed: 0.0032s/iter; left time: 19.2383s
Updating learning rate to 0.00127849656005
Validation loss decreased (0.6676 --> 0.6433).  Saving model state dict ...
Epoch: 2 cost time: 3.1995437145233154
Epoch: 2, Steps: 979 | Train Loss: 0.9614475 Vali Loss: 0.6433039 Best vali loss: 0.6433039
	iters: 100, epoch: 3 | loss: 0.9507353
	speed: 0.0109s/iter; left time: 62.8568s
	iters: 200, epoch: 3 | loss: 0.5024779
	speed: 0.0031s/iter; left time: 17.4224s
	iters: 300, epoch: 3 | loss: 0.8902606
	speed: 0.0030s/iter; left time: 16.9466s
	iters: 400, epoch: 3 | loss: 0.7785009
	speed: 0.0031s/iter; left time: 16.7213s
	iters: 500, epoch: 3 | loss: 0.8679191
	speed: 0.0032s/iter; left time: 17.4506s
	iters: 600, epoch: 3 | loss: 1.7389439
	speed: 0.0032s/iter; left time: 17.0360s
	iters: 700, epoch: 3 | loss: 0.4012919
	speed: 0.0032s/iter; left time: 16.7639s
	iters: 800, epoch: 3 | loss: 0.4274960
	speed: 0.0032s/iter; left time: 16.1730s
	iters: 900, epoch: 3 | loss: 0.6244476
	speed: 0.0031s/iter; left time: 15.5668s
Updating learning rate to 0.000639248280025
Epoch: 3 cost time: 3.1203203201293945
Epoch: 3, Steps: 979 | Train Loss: 0.7980082 Vali Loss: 0.6548076 Best vali loss: 0.6433039

best validation loss 0.6433039066252031

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.001032677716, 'e_layers': 3, 'learning_rate': 0.0004175435981, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0707200
	speed: 0.0107s/iter; left time: 51.3099s
	iters: 200, epoch: 4 | loss: 0.9514908
	speed: 0.0045s/iter; left time: 21.0341s
	iters: 300, epoch: 4 | loss: 1.7648712
	speed: 0.0045s/iter; left time: 20.8074s
	iters: 400, epoch: 4 | loss: 0.3138874
	speed: 0.0045s/iter; left time: 20.3863s
	iters: 500, epoch: 4 | loss: 1.3036520
	speed: 0.0043s/iter; left time: 19.0393s
	iters: 600, epoch: 4 | loss: 1.0531263
	speed: 0.0043s/iter; left time: 18.6806s
	iters: 700, epoch: 4 | loss: 0.3697017
	speed: 0.0042s/iter; left time: 17.7813s
	iters: 800, epoch: 4 | loss: 0.9232765
	speed: 0.0043s/iter; left time: 17.7615s
	iters: 900, epoch: 4 | loss: 0.7930380
	speed: 0.0044s/iter; left time: 17.7195s
Updating learning rate to 0.00020877179905
Epoch: 4 cost time: 4.666970491409302
Epoch: 4, Steps: 979 | Train Loss: 0.9493071 Vali Loss: 0.6149212 Best vali loss: 0.6116811
	iters: 100, epoch: 5 | loss: 0.7613997
	speed: 0.0134s/iter; left time: 51.1356s
	iters: 200, epoch: 5 | loss: 1.0485775
	speed: 0.0044s/iter; left time: 16.2777s
	iters: 300, epoch: 5 | loss: 0.6296856
	speed: 0.0045s/iter; left time: 16.2249s
	iters: 400, epoch: 5 | loss: 0.9909077
	speed: 0.0044s/iter; left time: 15.6326s
	iters: 500, epoch: 5 | loss: 0.3767509
	speed: 0.0045s/iter; left time: 15.2672s
	iters: 600, epoch: 5 | loss: 1.1231060
	speed: 0.0044s/iter; left time: 14.7218s
	iters: 700, epoch: 5 | loss: 0.5081469
	speed: 0.0044s/iter; left time: 14.0579s
	iters: 800, epoch: 5 | loss: 0.7918305
	speed: 0.0043s/iter; left time: 13.4338s
	iters: 900, epoch: 5 | loss: 1.5454632
	speed: 0.0044s/iter; left time: 13.3350s
Updating learning rate to 0.00012887829040851123
Validation loss decreased (0.6117 --> 0.6083).  Saving model state dict ...
Epoch: 5 cost time: 4.320737600326538
Epoch: 5, Steps: 979 | Train Loss: 0.8639853 Vali Loss: 0.6083490 Best vali loss: 0.6083490
	iters: 100, epoch: 6 | loss: 1.4098532
	speed: 0.0136s/iter; left time: 38.4702s
	iters: 200, epoch: 6 | loss: 0.2493383
	speed: 0.0039s/iter; left time: 10.7854s
	iters: 300, epoch: 6 | loss: 1.8203657
	speed: 0.0040s/iter; left time: 10.5513s
	iters: 400, epoch: 6 | loss: 0.3359413
	speed: 0.0040s/iter; left time: 10.0782s
	iters: 500, epoch: 6 | loss: 0.7870426
	speed: 0.0039s/iter; left time: 9.5011s
	iters: 600, epoch: 6 | loss: 1.2273670
	speed: 0.0039s/iter; left time: 9.1546s
	iters: 700, epoch: 6 | loss: 0.6291744
	speed: 0.0038s/iter; left time: 8.5008s
	iters: 800, epoch: 6 | loss: 0.5422997
	speed: 0.0040s/iter; left time: 8.4722s
	iters: 900, epoch: 6 | loss: 0.7124286
	speed: 0.0039s/iter; left time: 7.8928s
Updating learning rate to 6.114784422122979e-05
Epoch: 6 cost time: 3.863081455230713
Epoch: 6, Steps: 979 | Train Loss: 0.8570901 Vali Loss: 0.6343595 Best vali loss: 0.6083490
	iters: 100, epoch: 7 | loss: 0.6996700
	speed: 0.0123s/iter; left time: 22.9190s
	iters: 200, epoch: 7 | loss: 1.2177657
	speed: 0.0039s/iter; left time: 6.7810s
	iters: 300, epoch: 7 | loss: 1.6481180
	speed: 0.0036s/iter; left time: 6.0355s
	iters: 400, epoch: 7 | loss: 0.9735917
	speed: 0.0039s/iter; left time: 6.0301s
	iters: 500, epoch: 7 | loss: 0.4815360
	speed: 0.0044s/iter; left time: 6.4901s
	iters: 600, epoch: 7 | loss: 0.2597043
	speed: 0.0042s/iter; left time: 5.6929s
	iters: 700, epoch: 7 | loss: 0.6825228
	speed: 0.0038s/iter; left time: 4.8329s
	iters: 800, epoch: 7 | loss: 1.3258299
	speed: 0.0039s/iter; left time: 4.4646s
	iters: 900, epoch: 7 | loss: 1.1380842
	speed: 0.0036s/iter; left time: 3.8455s
Updating learning rate to 1.5891806942145703e-05
Epoch: 7 cost time: 3.851815938949585
Epoch: 7, Steps: 979 | Train Loss: 0.9363136 Vali Loss: 0.6439529 Best vali loss: 0.6083490
	iters: 100, epoch: 8 | loss: 0.5199222
	speed: 0.0127s/iter; left time: 11.1831s
	iters: 200, epoch: 8 | loss: 0.6315830
	speed: 0.0039s/iter; left time: 3.0389s
	iters: 300, epoch: 8 | loss: 1.1097293
	speed: 0.0038s/iter; left time: 2.5948s
	iters: 400, epoch: 8 | loss: 0.6834913
	speed: 0.0038s/iter; left time: 2.1759s
	iters: 500, epoch: 8 | loss: 1.2423183
	speed: 0.0040s/iter; left time: 1.9239s
	iters: 600, epoch: 8 | loss: 0.5103025
	speed: 0.0038s/iter; left time: 1.4421s
	iters: 700, epoch: 8 | loss: 0.5814111
	speed: 0.0037s/iter; left time: 1.0383s
	iters: 800, epoch: 8 | loss: 0.9391639
	speed: 0.0037s/iter; left time: 0.6728s
	iters: 900, epoch: 8 | loss: 0.4331273
	speed: 0.0037s/iter; left time: 0.2972s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.7861249446868896
Epoch: 8, Steps: 979 | Train Loss: 0.7390054 Vali Loss: 0.6462708 Best vali loss: 0.6083490

best validation loss 0.6083489864416445

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0009185361321, 'e_layers': 3, 'learning_rate': 0.0015861628271, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7031233
	speed: 0.0109s/iter; left time: 41.7201s
	iters: 200, epoch: 1 | loss: 0.7452633
	speed: 0.0047s/iter; left time: 17.6349s
	iters: 300, epoch: 1 | loss: 1.0419263
	speed: 0.0047s/iter; left time: 17.0691s
	iters: 400, epoch: 1 | loss: 0.7403907
	speed: 0.0046s/iter; left time: 16.3243s
Updating learning rate to 0.0015257930991439644
Validation loss decreased (inf --> 0.6384).  Saving model state dict ...
Epoch: 1 cost time: 2.6374964714050293
Epoch: 1, Steps: 490 | Train Loss: 0.8076759 Vali Loss: 0.6383661 Best vali loss: 0.6383661
	iters: 100, epoch: 2 | loss: 1.3287772
	speed: 0.0120s/iter; left time: 39.8846s
	iters: 200, epoch: 2 | loss: 1.0159122
	speed: 0.0041s/iter; left time: 13.0862s
	iters: 300, epoch: 2 | loss: 0.8374475
	speed: 0.0041s/iter; left time: 12.7144s
	iters: 400, epoch: 2 | loss: 1.0252110
	speed: 0.0038s/iter; left time: 11.6648s
Updating learning rate to 0.0013538746591042175
Validation loss decreased (0.6384 --> 0.6382).  Saving model state dict ...
Epoch: 2 cost time: 1.985926866531372
Epoch: 2, Steps: 490 | Train Loss: 1.0518370 Vali Loss: 0.6382385 Best vali loss: 0.6382385
	iters: 100, epoch: 3 | loss: 0.6065454
	speed: 0.0108s/iter; left time: 30.7767s
	iters: 200, epoch: 3 | loss: 0.5377283
	speed: 0.0039s/iter; left time: 10.5706s
	iters: 300, epoch: 3 | loss: 0.8696563
	speed: 0.0039s/iter; left time: 10.1994s
	iters: 400, epoch: 3 | loss: 0.6631837
	speed: 0.0039s/iter; left time: 9.9292s
Updating learning rate to 0.0010965805310322713
Epoch: 3 cost time: 1.9448540210723877
Epoch: 3, Steps: 490 | Train Loss: 0.6692784 Vali Loss: 0.6509605 Best vali loss: 0.6382385
	iters: 100, epoch: 4 | loss: 1.0756694
	speed: 0.0110s/iter; left time: 25.7628s
	iters: 200, epoch: 4 | loss: 1.0457239
	speed: 0.0040s/iter; left time: 8.9943s
	iters: 300, epoch: 4 | loss: 0.4967112
	speed: 0.0039s/iter; left time: 8.4489s
	iters: 400, epoch: 4 | loss: 1.4132986
	speed: 0.0039s/iter; left time: 8.0131s
Updating learning rate to 0.00079308141355
Epoch: 4 cost time: 1.987593412399292
Epoch: 4, Steps: 490 | Train Loss: 1.0078508 Vali Loss: 0.6406166 Best vali loss: 0.6382385
	iters: 100, epoch: 5 | loss: 0.9575670
	speed: 0.0111s/iter; left time: 20.6636s
	iters: 200, epoch: 5 | loss: 0.7933131
	speed: 0.0040s/iter; left time: 7.0210s
	iters: 300, epoch: 5 | loss: 0.8281510
	speed: 0.0040s/iter; left time: 6.6308s
	iters: 400, epoch: 5 | loss: 0.6733204
	speed: 0.0040s/iter; left time: 6.2586s
Updating learning rate to 0.0004895822960677288
Validation loss decreased (0.6382 --> 0.6370).  Saving model state dict ...
Epoch: 5 cost time: 2.0093116760253906
Epoch: 5, Steps: 490 | Train Loss: 0.8130879 Vali Loss: 0.6370238 Best vali loss: 0.6370238
	iters: 100, epoch: 6 | loss: 1.3711882
	speed: 0.0116s/iter; left time: 15.8526s
	iters: 200, epoch: 6 | loss: 0.7534953
	speed: 0.0040s/iter; left time: 5.1327s
	iters: 300, epoch: 6 | loss: 0.4532828
	speed: 0.0040s/iter; left time: 4.6837s
	iters: 400, epoch: 6 | loss: 0.9349689
	speed: 0.0041s/iter; left time: 4.3697s
Updating learning rate to 0.0002322881679957824
Epoch: 6 cost time: 2.0225770473480225
Epoch: 6, Steps: 490 | Train Loss: 0.8782338 Vali Loss: 0.6436011 Best vali loss: 0.6370238
	iters: 100, epoch: 7 | loss: 1.0145929
	speed: 0.0108s/iter; left time: 9.5017s
	iters: 200, epoch: 7 | loss: 0.7081831
	speed: 0.0040s/iter; left time: 3.1017s
	iters: 300, epoch: 7 | loss: 1.2267148
	speed: 0.0040s/iter; left time: 2.7278s
	iters: 400, epoch: 7 | loss: 0.7119985
	speed: 0.0039s/iter; left time: 2.2445s
Updating learning rate to 6.036972795603553e-05
Epoch: 7 cost time: 1.9667868614196777
Epoch: 7, Steps: 490 | Train Loss: 0.9153723 Vali Loss: 0.6423591 Best vali loss: 0.6370238
	iters: 100, epoch: 8 | loss: 0.3627153
	speed: 0.0109s/iter; left time: 4.2551s
	iters: 200, epoch: 8 | loss: 0.3919511
	speed: 0.0045s/iter; left time: 1.3118s
	iters: 300, epoch: 8 | loss: 0.5308548
	speed: 0.0045s/iter; left time: 0.8645s
	iters: 400, epoch: 8 | loss: 1.1203234
	speed: 0.0045s/iter; left time: 0.4105s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.201462984085083
Epoch: 8, Steps: 490 | Train Loss: 0.6014611 Vali Loss: 0.6429416 Best vali loss: 0.6370238

best validation loss 0.6370237937739247

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0015706929828, 'e_layers': 1, 'learning_rate': 0.0023839268522, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9494895
	speed: 0.0093s/iter; left time: 17.2557s
	iters: 200, epoch: 1 | loss: 1.0827581
	speed: 0.0030s/iter; left time: 5.3562s
Updating learning rate to 0.0022931940389758197
Validation loss decreased (inf --> 0.6149).  Saving model state dict ...
Epoch: 1 cost time: 1.0733349323272705
Epoch: 1, Steps: 245 | Train Loss: 1.0161238 Vali Loss: 0.6149272 Best vali loss: 0.6149272
	iters: 100, epoch: 2 | loss: 0.9501516
	speed: 0.0066s/iter; left time: 10.6727s
	iters: 200, epoch: 2 | loss: 0.7927185
	speed: 0.0029s/iter; left time: 4.4124s
Updating learning rate to 0.0020348088476216603
Epoch: 2 cost time: 0.7781453132629395
Epoch: 2, Steps: 245 | Train Loss: 0.8714350 Vali Loss: 0.6158399 Best vali loss: 0.6149272
	iters: 100, epoch: 3 | loss: 0.5780330
	speed: 0.0065s/iter; left time: 8.8959s
	iters: 200, epoch: 3 | loss: 0.7076672
	speed: 0.0028s/iter; left time: 3.5028s
Updating learning rate to 0.0016481080812536001
Epoch: 3 cost time: 0.7233140468597412
Epoch: 3, Steps: 245 | Train Loss: 0.6428501 Vali Loss: 0.6448748 Best vali loss: 0.6149272
	iters: 100, epoch: 4 | loss: 0.7436637
	speed: 0.0062s/iter; left time: 6.9793s
	iters: 200, epoch: 4 | loss: 0.8380195
	speed: 0.0027s/iter; left time: 2.7321s
Updating learning rate to 0.0011919634261
Epoch: 4 cost time: 0.6972517967224121
Epoch: 4, Steps: 245 | Train Loss: 0.7908416 Vali Loss: 0.6831457 Best vali loss: 0.6149272
	iters: 100, epoch: 5 | loss: 0.5237442
	speed: 0.0061s/iter; left time: 5.4042s
	iters: 200, epoch: 5 | loss: 0.9292554
	speed: 0.0026s/iter; left time: 2.0400s
Updating learning rate to 0.0007358187709464
Epoch: 5 cost time: 0.690415620803833
Epoch: 5, Steps: 245 | Train Loss: 0.7264998 Vali Loss: 0.6783088 Best vali loss: 0.6149272
	iters: 100, epoch: 6 | loss: 0.7348990
	speed: 0.0059s/iter; left time: 3.7654s
	iters: 200, epoch: 6 | loss: 0.9185886
	speed: 0.0026s/iter; left time: 1.3958s
Updating learning rate to 0.00034911800457833986
Epoch: 6 cost time: 0.6814265251159668
Epoch: 6, Steps: 245 | Train Loss: 0.8267438 Vali Loss: 0.6808451 Best vali loss: 0.6149272
	iters: 100, epoch: 7 | loss: 0.4660046
	speed: 0.0063s/iter; left time: 2.4798s
	iters: 200, epoch: 7 | loss: 0.8294302
	speed: 0.0031s/iter; left time: 0.8911s
Updating learning rate to 9.073281322418032e-05
Epoch: 7 cost time: 0.7977964878082275
Epoch: 7, Steps: 245 | Train Loss: 0.6477174 Vali Loss: 0.6825971 Best vali loss: 0.6149272
	iters: 100, epoch: 8 | loss: 0.8422065
	speed: 0.0064s/iter; left time: 0.9365s
	iters: 200, epoch: 8 | loss: 0.8239731
	speed: 0.0031s/iter; left time: 0.1436s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7793958187103271
Epoch: 8, Steps: 245 | Train Loss: 0.8330898 Vali Loss: 0.6840362 Best vali loss: 0.6149272

best validation loss 0.6149272241563722

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029529546034, 'e_layers': 4, 'learning_rate': 5.41211792e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9324009
	speed: 0.0113s/iter; left time: 87.6954s
	iters: 200, epoch: 1 | loss: 0.6335198
	speed: 0.0052s/iter; left time: 39.5816s
	iters: 300, epoch: 1 | loss: 1.3267554
	speed: 0.0052s/iter; left time: 39.2433s
	iters: 400, epoch: 1 | loss: 1.1987965
	speed: 0.0053s/iter; left time: 39.1048s
	iters: 500, epoch: 1 | loss: 0.8255947
	speed: 0.0053s/iter; left time: 38.9530s
	iters: 600, epoch: 1 | loss: 0.6519279
	speed: 0.0053s/iter; left time: 38.3649s
	iters: 700, epoch: 1 | loss: 0.4260638
	speed: 0.0052s/iter; left time: 37.3314s
	iters: 800, epoch: 1 | loss: 0.8762801
	speed: 0.0053s/iter; left time: 37.0205s
	iters: 900, epoch: 1 | loss: 0.5568932
	speed: 0.0052s/iter; left time: 36.3934s
Updating learning rate to 5.41211792e-05
Validation loss decreased (inf --> 0.6035).  Saving model state dict ...
Epoch: 1 cost time: 5.4741668701171875
Epoch: 1, Steps: 979 | Train Loss: 0.8253592 Vali Loss: 0.6035294 Best vali loss: 0.6035294
	iters: 100, epoch: 2 | loss: 1.0092481
	speed: 0.0154s/iter; left time: 103.7297s
	iters: 200, epoch: 2 | loss: 0.2871330
	speed: 0.0047s/iter; left time: 31.1453s
	iters: 300, epoch: 2 | loss: 0.7951839
	speed: 0.0048s/iter; left time: 31.1680s
	iters: 400, epoch: 2 | loss: 2.1026535
	speed: 0.0045s/iter; left time: 29.2472s
	iters: 500, epoch: 2 | loss: 0.7131553
	speed: 0.0045s/iter; left time: 28.3457s
	iters: 600, epoch: 2 | loss: 0.5592152
	speed: 0.0047s/iter; left time: 29.6237s
	iters: 700, epoch: 2 | loss: 1.4570110
	speed: 0.0049s/iter; left time: 29.8508s
	iters: 800, epoch: 2 | loss: 0.7381186
	speed: 0.0048s/iter; left time: 29.1948s
	iters: 900, epoch: 2 | loss: 0.7734326
	speed: 0.0049s/iter; left time: 28.8881s
Updating learning rate to 2.70605896e-05
Validation loss decreased (0.6035 --> 0.5865).  Saving model state dict ...
Epoch: 2 cost time: 4.6744420528411865
Epoch: 2, Steps: 979 | Train Loss: 0.9372390 Vali Loss: 0.5864654 Best vali loss: 0.5864654
	iters: 100, epoch: 3 | loss: 1.2734026
	speed: 0.0157s/iter; left time: 90.6470s
	iters: 200, epoch: 3 | loss: 0.9063240
	speed: 0.0053s/iter; left time: 29.8749s
	iters: 300, epoch: 3 | loss: 1.1244818
	speed: 0.0053s/iter; left time: 29.6817s
	iters: 400, epoch: 3 | loss: 0.4791721
	speed: 0.0053s/iter; left time: 28.7514s
	iters: 500, epoch: 3 | loss: 1.1410739
	speed: 0.0052s/iter; left time: 28.1372s
	iters: 600, epoch: 3 | loss: 1.3479359
	speed: 0.0050s/iter; left time: 26.3807s
	iters: 700, epoch: 3 | loss: 0.5957093
	speed: 0.0047s/iter; left time: 24.3867s
	iters: 800, epoch: 3 | loss: 0.6903923
	speed: 0.0046s/iter; left time: 23.4044s
	iters: 900, epoch: 3 | loss: 0.3575583
	speed: 0.0048s/iter; left time: 23.7062s
Updating learning rate to 1.35302948e-05
Validation loss decreased (0.5865 --> 0.5671).  Saving model state dict ...
Epoch: 3 cost time: 4.950989484786987
Epoch: 3, Steps: 979 | Train Loss: 0.8795611 Vali Loss: 0.5671022 Best vali loss: 0.5671022

best validation loss 0.5671022409561992

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0035339657795, 'e_layers': 1, 'learning_rate': 0.0001572884527, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5590959
	speed: 0.0086s/iter; left time: 32.8068s
	iters: 200, epoch: 1 | loss: 0.6760195
	speed: 0.0025s/iter; left time: 9.1544s
	iters: 300, epoch: 1 | loss: 1.9013427
	speed: 0.0024s/iter; left time: 8.8482s
	iters: 400, epoch: 1 | loss: 0.4318925
	speed: 0.0025s/iter; left time: 8.6631s
Updating learning rate to 0.00015130201742494983
Validation loss decreased (inf --> 0.6094).  Saving model state dict ...
Epoch: 1 cost time: 1.5544219017028809
Epoch: 1, Steps: 490 | Train Loss: 0.8920877 Vali Loss: 0.6094237 Best vali loss: 0.6094237
	iters: 100, epoch: 2 | loss: 1.6058685
	speed: 0.0077s/iter; left time: 25.7613s
	iters: 200, epoch: 2 | loss: 0.9694172
	speed: 0.0025s/iter; left time: 8.0053s
	iters: 300, epoch: 2 | loss: 1.0397800
	speed: 0.0025s/iter; left time: 7.8398s
	iters: 400, epoch: 2 | loss: 1.3487371
	speed: 0.0025s/iter; left time: 7.4990s
Updating learning rate to 0.00013425409210325476
Validation loss decreased (0.6094 --> 0.5984).  Saving model state dict ...
Epoch: 2 cost time: 1.2604749202728271
Epoch: 2, Steps: 490 | Train Loss: 1.2409507 Vali Loss: 0.5983572 Best vali loss: 0.5983572
	iters: 100, epoch: 3 | loss: 1.0531502
	speed: 0.0080s/iter; left time: 22.6205s
	iters: 200, epoch: 3 | loss: 0.8305710
	speed: 0.0024s/iter; left time: 6.7102s
	iters: 300, epoch: 3 | loss: 0.4973119
	speed: 0.0025s/iter; left time: 6.6388s
	iters: 400, epoch: 3 | loss: 0.6791772
	speed: 0.0025s/iter; left time: 6.3803s
Updating learning rate to 0.00010874006882531504
Epoch: 3 cost time: 1.2728352546691895
Epoch: 3, Steps: 490 | Train Loss: 0.7650526 Vali Loss: 0.6131250 Best vali loss: 0.5983572

best validation loss 0.5983571838803007

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0688585
	speed: 0.0107s/iter; left time: 9.4288s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6490).  Saving model state dict ...
Epoch: 1 cost time: 0.8994128704071045
Epoch: 1, Steps: 123 | Train Loss: 1.0688585 Vali Loss: 0.6490213 Best vali loss: 0.6490213
	iters: 100, epoch: 2 | loss: 0.8244714
	speed: 0.0072s/iter; left time: 5.4820s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6490 --> 0.6226).  Saving model state dict ...
Epoch: 2 cost time: 0.5523011684417725
Epoch: 2, Steps: 123 | Train Loss: 0.8244714 Vali Loss: 0.6226044 Best vali loss: 0.6226044
	iters: 100, epoch: 3 | loss: 0.9387842
	speed: 0.0072s/iter; left time: 4.5743s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.6226 --> 0.6155).  Saving model state dict ...
Epoch: 3 cost time: 0.5571889877319336
Epoch: 3, Steps: 123 | Train Loss: 0.9387842 Vali Loss: 0.6155369 Best vali loss: 0.6155369

best validation loss 0.6155369387131938

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029529546034, 'e_layers': 4, 'learning_rate': 5.41211792e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8880978
	speed: 0.0115s/iter; left time: 55.1358s
	iters: 200, epoch: 4 | loss: 0.6092381
	speed: 0.0052s/iter; left time: 24.5290s
	iters: 300, epoch: 4 | loss: 1.2586232
	speed: 0.0052s/iter; left time: 24.0399s
	iters: 400, epoch: 4 | loss: 0.8936508
	speed: 0.0052s/iter; left time: 23.5591s
	iters: 500, epoch: 4 | loss: 0.6930184
	speed: 0.0052s/iter; left time: 23.0262s
	iters: 600, epoch: 4 | loss: 0.6838419
	speed: 0.0052s/iter; left time: 22.4114s
	iters: 700, epoch: 4 | loss: 0.3819516
	speed: 0.0051s/iter; left time: 21.4863s
	iters: 800, epoch: 4 | loss: 0.9283142
	speed: 0.0052s/iter; left time: 21.1785s
	iters: 900, epoch: 4 | loss: 0.5632360
	speed: 0.0053s/iter; left time: 21.0281s
Updating learning rate to 6.7651474e-06
Validation loss decreased (0.5671 --> 0.5657).  Saving model state dict ...
Epoch: 4 cost time: 5.435267925262451
Epoch: 4, Steps: 979 | Train Loss: 0.7666636 Vali Loss: 0.5656722 Best vali loss: 0.5656722
	iters: 100, epoch: 5 | loss: 0.9191216
	speed: 0.0158s/iter; left time: 60.2493s
	iters: 200, epoch: 5 | loss: 0.2583920
	speed: 0.0053s/iter; left time: 19.5807s
	iters: 300, epoch: 5 | loss: 0.7903395
	speed: 0.0051s/iter; left time: 18.4194s
	iters: 400, epoch: 5 | loss: 1.2525777
	speed: 0.0050s/iter; left time: 17.6745s
	iters: 500, epoch: 5 | loss: 0.6021347
	speed: 0.0051s/iter; left time: 17.5035s
	iters: 600, epoch: 5 | loss: 0.3154806
	speed: 0.0052s/iter; left time: 17.1460s
	iters: 700, epoch: 5 | loss: 1.4454770
	speed: 0.0051s/iter; left time: 16.3967s
	iters: 800, epoch: 5 | loss: 0.7072837
	speed: 0.0050s/iter; left time: 15.6098s
	iters: 900, epoch: 5 | loss: 0.6612671
	speed: 0.0051s/iter; left time: 15.2946s
Updating learning rate to 3.3825737e-06
Validation loss decreased (0.5657 --> 0.5627).  Saving model state dict ...
Epoch: 5 cost time: 5.069104433059692
Epoch: 5, Steps: 979 | Train Loss: 0.7724526 Vali Loss: 0.5627206 Best vali loss: 0.5627206
	iters: 100, epoch: 6 | loss: 1.2513717
	speed: 0.0155s/iter; left time: 43.9159s
	iters: 200, epoch: 6 | loss: 0.8912857
	speed: 0.0052s/iter; left time: 14.2026s
	iters: 300, epoch: 6 | loss: 1.1253821
	speed: 0.0051s/iter; left time: 13.4848s
	iters: 400, epoch: 6 | loss: 0.4272916
	speed: 0.0052s/iter; left time: 13.1918s
	iters: 500, epoch: 6 | loss: 0.9243830
	speed: 0.0051s/iter; left time: 12.3975s
	iters: 600, epoch: 6 | loss: 1.2176417
	speed: 0.0051s/iter; left time: 12.0268s
	iters: 700, epoch: 6 | loss: 0.5917863
	speed: 0.0051s/iter; left time: 11.3624s
	iters: 800, epoch: 6 | loss: 0.6451056
	speed: 0.0052s/iter; left time: 11.0202s
	iters: 900, epoch: 6 | loss: 0.3602832
	speed: 0.0050s/iter; left time: 10.2491s
Updating learning rate to 1.69128685e-06
Validation loss decreased (0.5627 --> 0.5575).  Saving model state dict ...
Epoch: 6 cost time: 5.053079128265381
Epoch: 6, Steps: 979 | Train Loss: 0.8260590 Vali Loss: 0.5575118 Best vali loss: 0.5575118
	iters: 100, epoch: 7 | loss: 1.1857018
	speed: 0.0161s/iter; left time: 29.9838s
	iters: 200, epoch: 7 | loss: 0.3600178
	speed: 0.0053s/iter; left time: 9.2827s
	iters: 300, epoch: 7 | loss: 0.5214732
	speed: 0.0051s/iter; left time: 8.4913s
	iters: 400, epoch: 7 | loss: 0.6258736
	speed: 0.0048s/iter; left time: 7.4383s
	iters: 500, epoch: 7 | loss: 0.3281108
	speed: 0.0047s/iter; left time: 6.8923s
	iters: 600, epoch: 7 | loss: 1.4435338
	speed: 0.0048s/iter; left time: 6.5353s
	iters: 700, epoch: 7 | loss: 0.8555111
	speed: 0.0048s/iter; left time: 6.0098s
	iters: 800, epoch: 7 | loss: 0.7964197
	speed: 0.0045s/iter; left time: 5.2031s
	iters: 900, epoch: 7 | loss: 0.9614241
	speed: 0.0046s/iter; left time: 4.8329s
Updating learning rate to 8.45643425e-07
Validation loss decreased (0.5575 --> 0.5546).  Saving model state dict ...
Epoch: 7 cost time: 4.805172681808472
Epoch: 7, Steps: 979 | Train Loss: 0.7864518 Vali Loss: 0.5546207 Best vali loss: 0.5546207
	iters: 100, epoch: 8 | loss: 1.0655578
	speed: 0.0159s/iter; left time: 14.0012s
	iters: 200, epoch: 8 | loss: 0.8331057
	speed: 0.0051s/iter; left time: 4.0104s
	iters: 300, epoch: 8 | loss: 0.7010707
	speed: 0.0051s/iter; left time: 3.4385s
	iters: 400, epoch: 8 | loss: 0.2636626
	speed: 0.0050s/iter; left time: 2.8714s
	iters: 500, epoch: 8 | loss: 0.4830728
	speed: 0.0049s/iter; left time: 2.3542s
	iters: 600, epoch: 8 | loss: 0.5340934
	speed: 0.0048s/iter; left time: 1.8308s
	iters: 700, epoch: 8 | loss: 0.4804862
	speed: 0.0047s/iter; left time: 1.3046s
	iters: 800, epoch: 8 | loss: 1.0177430
	speed: 0.0046s/iter; left time: 0.8217s
	iters: 900, epoch: 8 | loss: 0.4555845
	speed: 0.0048s/iter; left time: 0.3841s
Updating learning rate to 4.228217125e-07
Validation loss decreased (0.5546 --> 0.5537).  Saving model state dict ...
Epoch: 8 cost time: 4.83783745765686
Epoch: 8, Steps: 979 | Train Loss: 0.6482641 Vali Loss: 0.5537371 Best vali loss: 0.5537371

best validation loss 0.553737131355538

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010899006808, 'e_layers': 2, 'learning_rate': 0.0004699832427, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00045209557062690734
Validation loss decreased (inf --> 0.5980).  Saving model state dict ...
Epoch: 1 cost time: 0.739107608795166
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5979620 Best vali loss: 0.5979620
Updating learning rate to 0.0004011557903286065
Validation loss decreased (0.5980 --> 0.5908).  Saving model state dict ...
Epoch: 2 cost time: 0.4580225944519043
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5907576 Best vali loss: 0.5907576
Updating learning rate to 0.0003249190215852555
Validation loss decreased (0.5908 --> 0.5647).  Saving model state dict ...
Epoch: 3 cost time: 0.45188260078430176
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5646865 Best vali loss: 0.5646865
Updating learning rate to 0.00023499162135
Validation loss decreased (0.5647 --> 0.5432).  Saving model state dict ...
Epoch: 4 cost time: 0.461101770401001
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5432153 Best vali loss: 0.5432153
Updating learning rate to 0.0001450642211147445
Validation loss decreased (0.5432 --> 0.5416).  Saving model state dict ...
Epoch: 5 cost time: 0.46245408058166504
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5415593 Best vali loss: 0.5415593
Updating learning rate to 6.882745237139354e-05
Validation loss decreased (0.5416 --> 0.5265).  Saving model state dict ...
Epoch: 6 cost time: 0.460864782333374
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5265378 Best vali loss: 0.5265378
Updating learning rate to 1.7887672073092694e-05
Epoch: 7 cost time: 0.4634263515472412
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5340843 Best vali loss: 0.5265378
Updating learning rate to 0.0
Epoch: 8 cost time: 0.456740140914917
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5328232 Best vali loss: 0.5265378

best validation loss 0.5265377620092866

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0021900649656, 'e_layers': 2, 'learning_rate': 0.0046583722616, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8369853
	speed: 0.0098s/iter; left time: 18.3206s
	iters: 200, epoch: 1 | loss: 0.7226333
	speed: 0.0039s/iter; left time: 6.9494s
Updating learning rate to 0.004481073524455277
Validation loss decreased (inf --> 0.6263).  Saving model state dict ...
Epoch: 1 cost time: 1.2900168895721436
Epoch: 1, Steps: 245 | Train Loss: 0.7798093 Vali Loss: 0.6262956 Best vali loss: 0.6262956
	iters: 100, epoch: 2 | loss: 0.9479655
	speed: 0.0079s/iter; left time: 12.8305s
	iters: 200, epoch: 2 | loss: 0.8698789
	speed: 0.0036s/iter; left time: 5.4185s
Updating learning rate to 0.003976169438534337
Validation loss decreased (0.6263 --> 0.6132).  Saving model state dict ...
Epoch: 2 cost time: 0.9511418342590332
Epoch: 2, Steps: 245 | Train Loss: 0.9089222 Vali Loss: 0.6132338 Best vali loss: 0.6132338
	iters: 100, epoch: 3 | loss: 0.7890215
	speed: 0.0078s/iter; left time: 10.6801s
	iters: 200, epoch: 3 | loss: 1.2058146
	speed: 0.0037s/iter; left time: 4.7367s
Updating learning rate to 0.0032205270739517075
Epoch: 3 cost time: 0.9455640316009521
Epoch: 3, Steps: 245 | Train Loss: 0.9974180 Vali Loss: 0.6199741 Best vali loss: 0.6132338
	iters: 100, epoch: 4 | loss: 0.8144988
	speed: 0.0078s/iter; left time: 8.8242s
	iters: 200, epoch: 4 | loss: 0.7386528
	speed: 0.0038s/iter; left time: 3.9315s
Updating learning rate to 0.0023291861308
Epoch: 4 cost time: 0.9748227596282959
Epoch: 4, Steps: 245 | Train Loss: 0.7765758 Vali Loss: 0.6241906 Best vali loss: 0.6132338
	iters: 100, epoch: 5 | loss: 0.8946028
	speed: 0.0080s/iter; left time: 7.0387s
	iters: 200, epoch: 5 | loss: 0.6732836
	speed: 0.0037s/iter; left time: 2.8690s
Updating learning rate to 0.0014378451876482933
Validation loss decreased (0.6132 --> 0.6081).  Saving model state dict ...
Epoch: 5 cost time: 0.9793438911437988
Epoch: 5, Steps: 245 | Train Loss: 0.7839432 Vali Loss: 0.6081474 Best vali loss: 0.6081474
	iters: 100, epoch: 6 | loss: 0.5786462
	speed: 0.0084s/iter; left time: 5.3489s
	iters: 200, epoch: 6 | loss: 0.4865375
	speed: 0.0038s/iter; left time: 2.0393s
Updating learning rate to 0.0006822028230656634
Epoch: 6 cost time: 1.000849962234497
Epoch: 6, Steps: 245 | Train Loss: 0.5325919 Vali Loss: 0.6117829 Best vali loss: 0.6081474
	iters: 100, epoch: 7 | loss: 0.7859933
	speed: 0.0082s/iter; left time: 3.1938s
	iters: 200, epoch: 7 | loss: 0.9321347
	speed: 0.0041s/iter; left time: 1.1900s
Updating learning rate to 0.00017729873714472324
Epoch: 7 cost time: 1.0424561500549316
Epoch: 7, Steps: 245 | Train Loss: 0.8590640 Vali Loss: 0.6091100 Best vali loss: 0.6081474
	iters: 100, epoch: 8 | loss: 1.0904505
	speed: 0.0081s/iter; left time: 1.1836s
	iters: 200, epoch: 8 | loss: 0.7389368
	speed: 0.0039s/iter; left time: 0.1778s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9938859939575195
Epoch: 8, Steps: 245 | Train Loss: 0.9146937 Vali Loss: 0.6112271 Best vali loss: 0.6081474

best validation loss 0.6081474422581049

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022392067024, 'e_layers': 3, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3415521
	speed: 0.0105s/iter; left time: 40.1557s
	iters: 200, epoch: 1 | loss: 0.6401104
	speed: 0.0045s/iter; left time: 16.8080s
	iters: 300, epoch: 1 | loss: 1.7143424
	speed: 0.0046s/iter; left time: 16.6730s
	iters: 400, epoch: 1 | loss: 0.5195024
	speed: 0.0046s/iter; left time: 16.2237s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6280).  Saving model state dict ...
Epoch: 1 cost time: 2.600188732147217
Epoch: 1, Steps: 490 | Train Loss: 1.0538768 Vali Loss: 0.6279926 Best vali loss: 0.6279926
	iters: 100, epoch: 2 | loss: 0.7788016
	speed: 0.0126s/iter; left time: 42.0438s
	iters: 200, epoch: 2 | loss: 0.5636722
	speed: 0.0041s/iter; left time: 13.2604s
	iters: 300, epoch: 2 | loss: 1.1697552
	speed: 0.0040s/iter; left time: 12.5720s
	iters: 400, epoch: 2 | loss: 1.6088812
	speed: 0.0045s/iter; left time: 13.7903s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6280 --> 0.6097).  Saving model state dict ...
Epoch: 2 cost time: 2.1545305252075195
Epoch: 2, Steps: 490 | Train Loss: 1.0302776 Vali Loss: 0.6096612 Best vali loss: 0.6096612
	iters: 100, epoch: 3 | loss: 0.8061993
	speed: 0.0131s/iter; left time: 37.1947s
	iters: 200, epoch: 3 | loss: 0.4359107
	speed: 0.0044s/iter; left time: 12.0527s
	iters: 300, epoch: 3 | loss: 0.8041737
	speed: 0.0045s/iter; left time: 11.9276s
	iters: 400, epoch: 3 | loss: 0.5576466
	speed: 0.0044s/iter; left time: 11.2384s
Updating learning rate to 7.442084605e-05
Epoch: 3 cost time: 2.2375845909118652
Epoch: 3, Steps: 490 | Train Loss: 0.6509826 Vali Loss: 0.6103395 Best vali loss: 0.6096612

best validation loss 0.6096611762284019

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020977995783, 'e_layers': 3, 'learning_rate': 0.0002976833842, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3425177
	speed: 0.0105s/iter; left time: 40.0659s
	iters: 200, epoch: 1 | loss: 0.6386959
	speed: 0.0044s/iter; left time: 16.3893s
	iters: 300, epoch: 1 | loss: 1.7146345
	speed: 0.0044s/iter; left time: 15.9058s
	iters: 400, epoch: 1 | loss: 0.5266971
	speed: 0.0044s/iter; left time: 15.3935s
Updating learning rate to 0.0002976833842
Validation loss decreased (inf --> 0.6252).  Saving model state dict ...
Epoch: 1 cost time: 2.5145862102508545
Epoch: 1, Steps: 490 | Train Loss: 1.0556363 Vali Loss: 0.6252213 Best vali loss: 0.6252213
	iters: 100, epoch: 2 | loss: 0.7593583
	speed: 0.0125s/iter; left time: 41.6194s
	iters: 200, epoch: 2 | loss: 0.5873779
	speed: 0.0046s/iter; left time: 14.8108s
	iters: 300, epoch: 2 | loss: 1.1911759
	speed: 0.0045s/iter; left time: 14.2111s
	iters: 400, epoch: 2 | loss: 1.5423402
	speed: 0.0046s/iter; left time: 13.9605s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.6252 --> 0.6082).  Saving model state dict ...
Epoch: 2 cost time: 2.283421039581299
Epoch: 2, Steps: 490 | Train Loss: 1.0200631 Vali Loss: 0.6081538 Best vali loss: 0.6081538
	iters: 100, epoch: 3 | loss: 0.7741994
	speed: 0.0129s/iter; left time: 36.5966s
	iters: 200, epoch: 3 | loss: 0.4131750
	speed: 0.0046s/iter; left time: 12.5643s
	iters: 300, epoch: 3 | loss: 0.7696600
	speed: 0.0045s/iter; left time: 12.0036s
	iters: 400, epoch: 3 | loss: 0.5390943
	speed: 0.0046s/iter; left time: 11.7822s
Updating learning rate to 7.442084605e-05
Epoch: 3 cost time: 2.295768976211548
Epoch: 3, Steps: 490 | Train Loss: 0.6240322 Vali Loss: 0.6152691 Best vali loss: 0.6081538

best validation loss 0.6081537709970929

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010654601751, 'e_layers': 3, 'learning_rate': 0.0002955454672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3314025
	speed: 0.0106s/iter; left time: 40.5560s
	iters: 200, epoch: 1 | loss: 0.6345549
	speed: 0.0044s/iter; left time: 16.4753s
	iters: 300, epoch: 1 | loss: 1.7144024
	speed: 0.0046s/iter; left time: 16.7338s
	iters: 400, epoch: 1 | loss: 0.5385424
	speed: 0.0047s/iter; left time: 16.6156s
Updating learning rate to 0.0002842969376362829
Validation loss decreased (inf --> 0.6262).  Saving model state dict ...
Epoch: 1 cost time: 2.6048924922943115
Epoch: 1, Steps: 490 | Train Loss: 1.0547256 Vali Loss: 0.6262005 Best vali loss: 0.6262005
	iters: 100, epoch: 2 | loss: 0.7872003
	speed: 0.0124s/iter; left time: 41.4196s
	iters: 200, epoch: 2 | loss: 0.5949348
	speed: 0.0043s/iter; left time: 13.8499s
	iters: 300, epoch: 2 | loss: 1.1316824
	speed: 0.0046s/iter; left time: 14.2492s
	iters: 400, epoch: 2 | loss: 1.4953879
	speed: 0.0045s/iter; left time: 13.5208s
Updating learning rate to 0.0002522638356030332
Validation loss decreased (0.6262 --> 0.6119).  Saving model state dict ...
Epoch: 2 cost time: 2.203411817550659
Epoch: 2, Steps: 490 | Train Loss: 1.0023014 Vali Loss: 0.6119395 Best vali loss: 0.6119395
	iters: 100, epoch: 3 | loss: 0.7955897
	speed: 0.0129s/iter; left time: 36.5907s
	iters: 200, epoch: 3 | loss: 0.4116570
	speed: 0.0047s/iter; left time: 12.7509s
	iters: 300, epoch: 3 | loss: 0.7815364
	speed: 0.0047s/iter; left time: 12.3109s
	iters: 400, epoch: 3 | loss: 0.5318589
	speed: 0.0047s/iter; left time: 11.8404s
Updating learning rate to 0.00020432291050402005
Validation loss decreased (0.6119 --> 0.5927).  Saving model state dict ...
Epoch: 3 cost time: 2.321307897567749
Epoch: 3, Steps: 490 | Train Loss: 0.6301605 Vali Loss: 0.5926705 Best vali loss: 0.5926705

best validation loss 0.5926705367970059

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010654601751, 'e_layers': 3, 'learning_rate': 0.0002955454672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9594779
	speed: 0.0112s/iter; left time: 26.2585s
	iters: 200, epoch: 4 | loss: 0.5067935
	speed: 0.0047s/iter; left time: 10.5255s
	iters: 300, epoch: 4 | loss: 1.6596249
	speed: 0.0046s/iter; left time: 9.8312s
	iters: 400, epoch: 4 | loss: 0.4287575
	speed: 0.0046s/iter; left time: 9.5178s
Updating learning rate to 0.0001477727336
Epoch: 4 cost time: 2.635648012161255
Epoch: 4, Steps: 490 | Train Loss: 0.8886635 Vali Loss: 0.5998211 Best vali loss: 0.5926705
	iters: 100, epoch: 5 | loss: 0.7169459
	speed: 0.0123s/iter; left time: 22.9277s
	iters: 200, epoch: 5 | loss: 0.5086589
	speed: 0.0042s/iter; left time: 7.4495s
	iters: 300, epoch: 5 | loss: 1.0044388
	speed: 0.0041s/iter; left time: 6.8357s
	iters: 400, epoch: 5 | loss: 1.1216397
	speed: 0.0040s/iter; left time: 6.1913s
Updating learning rate to 9.122255669597998e-05
Validation loss decreased (0.5927 --> 0.5761).  Saving model state dict ...
Epoch: 5 cost time: 2.065201759338379
Epoch: 5, Steps: 490 | Train Loss: 0.8379208 Vali Loss: 0.5760864 Best vali loss: 0.5760864
	iters: 100, epoch: 6 | loss: 0.6567088
	speed: 0.0121s/iter; left time: 16.5351s
	iters: 200, epoch: 6 | loss: 0.3488833
	speed: 0.0047s/iter; left time: 5.9379s
	iters: 300, epoch: 6 | loss: 0.5819197
	speed: 0.0048s/iter; left time: 5.6394s
	iters: 400, epoch: 6 | loss: 0.5325709
	speed: 0.0048s/iter; left time: 5.1501s
Updating learning rate to 4.328163159696683e-05
Epoch: 6 cost time: 2.3663241863250732
Epoch: 6, Steps: 490 | Train Loss: 0.5300207 Vali Loss: 0.6004629 Best vali loss: 0.5760864
	iters: 100, epoch: 7 | loss: 0.6686320
	speed: 0.0125s/iter; left time: 11.0456s
	iters: 200, epoch: 7 | loss: 0.5143566
	speed: 0.0046s/iter; left time: 3.6177s
	iters: 300, epoch: 7 | loss: 0.7549637
	speed: 0.0047s/iter; left time: 3.1775s
	iters: 400, epoch: 7 | loss: 0.7101296
	speed: 0.0047s/iter; left time: 2.7251s
Updating learning rate to 1.1248529563717086e-05
Epoch: 7 cost time: 2.3172481060028076
Epoch: 7, Steps: 490 | Train Loss: 0.6620205 Vali Loss: 0.6123696 Best vali loss: 0.5760864
	iters: 100, epoch: 8 | loss: 0.7779489
	speed: 0.0123s/iter; left time: 4.8183s
	iters: 200, epoch: 8 | loss: 0.2988566
	speed: 0.0041s/iter; left time: 1.2022s
	iters: 300, epoch: 8 | loss: 0.8929725
	speed: 0.0043s/iter; left time: 0.8205s
	iters: 400, epoch: 8 | loss: 0.5398163
	speed: 0.0042s/iter; left time: 0.3819s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1203465461730957
Epoch: 8, Steps: 490 | Train Loss: 0.6273986 Vali Loss: 0.6231300 Best vali loss: 0.5760864

best validation loss 0.5760864174956252

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0035734202019, 'e_layers': 3, 'learning_rate': 0.0004785814935, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9363121
	speed: 0.0138s/iter; left time: 12.2169s
Updating learning rate to 0.0004785814935
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 1.2922985553741455
Epoch: 1, Steps: 123 | Train Loss: 0.9363121 Vali Loss: 0.6183648 Best vali loss: 0.6183648
	iters: 100, epoch: 2 | loss: 0.9120280
	speed: 0.0124s/iter; left time: 9.4717s
Updating learning rate to 0.00023929074675
Epoch: 2 cost time: 1.0076217651367188
Epoch: 2, Steps: 123 | Train Loss: 0.9120280 Vali Loss: 0.6241918 Best vali loss: 0.6183648
	iters: 100, epoch: 3 | loss: 0.7591302
	speed: 0.0121s/iter; left time: 7.7139s
Updating learning rate to 0.000119645373375
Validation loss decreased (0.6184 --> 0.6101).  Saving model state dict ...
Epoch: 3 cost time: 1.0007057189941406
Epoch: 3, Steps: 123 | Train Loss: 0.7591302 Vali Loss: 0.6100819 Best vali loss: 0.6100819
	iters: 100, epoch: 4 | loss: 0.9141776
	speed: 0.0139s/iter; left time: 7.1541s
Updating learning rate to 5.98226866875e-05
Epoch: 4 cost time: 1.00748872756958
Epoch: 4, Steps: 123 | Train Loss: 0.9141776 Vali Loss: 0.6498093 Best vali loss: 0.6100819
	iters: 100, epoch: 5 | loss: 0.8484998
	speed: 0.0121s/iter; left time: 4.7463s
Updating learning rate to 2.991134334375e-05
Epoch: 5 cost time: 0.9955272674560547
Epoch: 5, Steps: 123 | Train Loss: 0.8484998 Vali Loss: 0.6298312 Best vali loss: 0.6100819
	iters: 100, epoch: 6 | loss: 0.9239313
	speed: 0.0121s/iter; left time: 3.2581s
Updating learning rate to 1.4955671671875e-05
Epoch: 6 cost time: 0.9942429065704346
Epoch: 6, Steps: 123 | Train Loss: 0.9239313 Vali Loss: 0.6352282 Best vali loss: 0.6100819
	iters: 100, epoch: 7 | loss: 0.6620107
	speed: 0.0121s/iter; left time: 1.7810s
Updating learning rate to 7.4778358359375e-06
Epoch: 7 cost time: 1.0037097930908203
Epoch: 7, Steps: 123 | Train Loss: 0.6620107 Vali Loss: 0.6302464 Best vali loss: 0.6100819
	iters: 100, epoch: 8 | loss: 0.9294296
	speed: 0.0120s/iter; left time: 0.2885s
Updating learning rate to 3.73891791796875e-06
Epoch: 8 cost time: 0.9942374229431152
Epoch: 8, Steps: 123 | Train Loss: 0.9294296 Vali Loss: 0.6260994 Best vali loss: 0.6100819

best validation loss 0.6100819286015893

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043030712173, 'e_layers': 3, 'learning_rate': 0.0004334800015, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7097583
	speed: 0.0121s/iter; left time: 10.7068s
Updating learning rate to 0.0004334800015
Validation loss decreased (inf --> 0.6203).  Saving model state dict ...
Epoch: 1 cost time: 1.0935957431793213
Epoch: 1, Steps: 123 | Train Loss: 0.7097583 Vali Loss: 0.6203074 Best vali loss: 0.6203074
	iters: 100, epoch: 2 | loss: 0.6554598
	speed: 0.0094s/iter; left time: 7.1468s
Updating learning rate to 0.00021674000075
Validation loss decreased (0.6203 --> 0.5556).  Saving model state dict ...
Epoch: 2 cost time: 0.7429792881011963
Epoch: 2, Steps: 123 | Train Loss: 0.6554598 Vali Loss: 0.5556316 Best vali loss: 0.5556316
	iters: 100, epoch: 3 | loss: 0.8540952
	speed: 0.0094s/iter; left time: 6.0323s
Updating learning rate to 0.000108370000375
Validation loss decreased (0.5556 --> 0.5513).  Saving model state dict ...
Epoch: 3 cost time: 0.7457435131072998
Epoch: 3, Steps: 123 | Train Loss: 0.8540952 Vali Loss: 0.5513169 Best vali loss: 0.5513169
	iters: 100, epoch: 4 | loss: 0.5147073
	speed: 0.0095s/iter; left time: 4.8829s
Updating learning rate to 5.41850001875e-05
Validation loss decreased (0.5513 --> 0.5464).  Saving model state dict ...
Epoch: 4 cost time: 0.7501258850097656
Epoch: 4, Steps: 123 | Train Loss: 0.5147073 Vali Loss: 0.5464470 Best vali loss: 0.5464470
	iters: 100, epoch: 5 | loss: 0.5915484
	speed: 0.0093s/iter; left time: 3.6401s
Updating learning rate to 2.709250009375e-05
Epoch: 5 cost time: 0.7400851249694824
Epoch: 5, Steps: 123 | Train Loss: 0.5915484 Vali Loss: 0.5507932 Best vali loss: 0.5464470
	iters: 100, epoch: 6 | loss: 0.6864592
	speed: 0.0092s/iter; left time: 2.4860s
Updating learning rate to 1.3546250046875e-05
Epoch: 6 cost time: 0.7449455261230469
Epoch: 6, Steps: 123 | Train Loss: 0.6864592 Vali Loss: 0.5552881 Best vali loss: 0.5464470
	iters: 100, epoch: 7 | loss: 0.6559282
	speed: 0.0094s/iter; left time: 1.3849s
Updating learning rate to 6.7731250234375e-06
Epoch: 7 cost time: 0.7586214542388916
Epoch: 7, Steps: 123 | Train Loss: 0.6559282 Vali Loss: 0.5586215 Best vali loss: 0.5464470
	iters: 100, epoch: 8 | loss: 0.7178600
	speed: 0.0092s/iter; left time: 0.2210s
Updating learning rate to 3.38656251171875e-06
Epoch: 8 cost time: 0.7536189556121826
Epoch: 8, Steps: 123 | Train Loss: 0.7178600 Vali Loss: 0.5596464 Best vali loss: 0.5464470

best validation loss 0.5464470460424816

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041907272211, 'e_layers': 3, 'learning_rate': 0.0004345926842, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7108558
	speed: 0.0118s/iter; left time: 10.4080s
Updating learning rate to 0.0004345926842
Validation loss decreased (inf --> 0.6208).  Saving model state dict ...
Epoch: 1 cost time: 1.037163496017456
Epoch: 1, Steps: 123 | Train Loss: 0.7108558 Vali Loss: 0.6207827 Best vali loss: 0.6207827
	iters: 100, epoch: 2 | loss: 0.6595918
	speed: 0.0093s/iter; left time: 7.1136s
Updating learning rate to 0.0002172963421
Validation loss decreased (0.6208 --> 0.5773).  Saving model state dict ...
Epoch: 2 cost time: 0.7362213134765625
Epoch: 2, Steps: 123 | Train Loss: 0.6595918 Vali Loss: 0.5772894 Best vali loss: 0.5772894
	iters: 100, epoch: 3 | loss: 0.8387758
	speed: 0.0092s/iter; left time: 5.8581s
Updating learning rate to 0.00010864817105
Validation loss decreased (0.5773 --> 0.5430).  Saving model state dict ...
Epoch: 3 cost time: 0.7321460247039795
Epoch: 3, Steps: 123 | Train Loss: 0.8387758 Vali Loss: 0.5429951 Best vali loss: 0.5429951

best validation loss 0.5429951258827723

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012193242137, 'e_layers': 1, 'learning_rate': 0.0004016592771, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5997045
	speed: 0.0097s/iter; left time: 8.6194s
Updating learning rate to 0.0003863720311279847
Validation loss decreased (inf --> 0.6137).  Saving model state dict ...
Epoch: 1 cost time: 0.7879946231842041
Epoch: 1, Steps: 123 | Train Loss: 0.5997045 Vali Loss: 0.6136612 Best vali loss: 0.6136612
	iters: 100, epoch: 2 | loss: 1.0191101
	speed: 0.0067s/iter; left time: 5.0961s
Updating learning rate to 0.0003428376378319483
Epoch: 2 cost time: 0.4980449676513672
Epoch: 2, Steps: 123 | Train Loss: 1.0191101 Vali Loss: 0.6155787 Best vali loss: 0.6136612
	iters: 100, epoch: 3 | loss: 0.6080812
	speed: 0.0066s/iter; left time: 4.2091s
Updating learning rate to 0.00027768381395095436
Validation loss decreased (0.6137 --> 0.6072).  Saving model state dict ...
Epoch: 3 cost time: 0.49381113052368164
Epoch: 3, Steps: 123 | Train Loss: 0.6080812 Vali Loss: 0.6071768 Best vali loss: 0.6071768

best validation loss 0.6071767785492896

[INFO][smbo.py:320] Finished 1400 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0033978970282, 'e_layers': 1, 'learning_rate': 0.0005876537846, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8098669
	speed: 0.0101s/iter; left time: 8.9132s
Updating learning rate to 0.0005652875441973682
Validation loss decreased (inf --> 0.6017).  Saving model state dict ...
Epoch: 1 cost time: 0.8115391731262207
Epoch: 1, Steps: 123 | Train Loss: 0.8098669 Vali Loss: 0.6017044 Best vali loss: 0.6017044
	iters: 100, epoch: 2 | loss: 0.8970662
	speed: 0.0067s/iter; left time: 5.1316s
Updating learning rate to 0.0005015938803402994
Epoch: 2 cost time: 0.4994685649871826
Epoch: 2, Steps: 123 | Train Loss: 0.8970662 Vali Loss: 0.6085450 Best vali loss: 0.6017044
	iters: 100, epoch: 3 | loss: 0.7966292
	speed: 0.0067s/iter; left time: 4.2901s
Updating learning rate to 0.0004062695759665316
Epoch: 3 cost time: 0.515718936920166
Epoch: 3, Steps: 123 | Train Loss: 0.7966292 Vali Loss: 0.6120723 Best vali loss: 0.6017044

best validation loss 0.6017044243135148

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041907272211, 'e_layers': 3, 'learning_rate': 0.0004345926842, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5685892
	speed: 0.0123s/iter; left time: 6.3545s
Updating learning rate to 5.4324085525e-05
Validation loss decreased (0.5430 --> 0.5362).  Saving model state dict ...
Epoch: 4 cost time: 1.046872615814209
Epoch: 4, Steps: 123 | Train Loss: 0.5685892 Vali Loss: 0.5362025 Best vali loss: 0.5362025
	iters: 100, epoch: 5 | loss: 0.6002408
	speed: 0.0093s/iter; left time: 3.6455s
Updating learning rate to 2.71620427625e-05
Validation loss decreased (0.5362 --> 0.5355).  Saving model state dict ...
Epoch: 5 cost time: 0.7348692417144775
Epoch: 5, Steps: 123 | Train Loss: 0.6002408 Vali Loss: 0.5355336 Best vali loss: 0.5355336
	iters: 100, epoch: 6 | loss: 0.7555933
	speed: 0.0094s/iter; left time: 2.5418s
Updating learning rate to 1.358102138125e-05
Validation loss decreased (0.5355 --> 0.5345).  Saving model state dict ...
Epoch: 6 cost time: 0.7395908832550049
Epoch: 6, Steps: 123 | Train Loss: 0.7555933 Vali Loss: 0.5345361 Best vali loss: 0.5345361
	iters: 100, epoch: 7 | loss: 0.4925949
	speed: 0.0094s/iter; left time: 1.3865s
Updating learning rate to 6.790510690625e-06
Epoch: 7 cost time: 0.7560346126556396
Epoch: 7, Steps: 123 | Train Loss: 0.4925949 Vali Loss: 0.5459420 Best vali loss: 0.5345361
	iters: 100, epoch: 8 | loss: 0.5777956
	speed: 0.0092s/iter; left time: 0.2209s
Updating learning rate to 3.3952553453125e-06
Epoch: 8 cost time: 0.7524027824401855
Epoch: 8, Steps: 123 | Train Loss: 0.5777956 Vali Loss: 0.5440409 Best vali loss: 0.5345361

best validation loss 0.5345361334810871

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016615573103, 'e_layers': 3, 'learning_rate': 6.21730293e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5975648
	speed: 0.0107s/iter; left time: 41.0157s
	iters: 200, epoch: 1 | loss: 1.1787806
	speed: 0.0044s/iter; left time: 16.5368s
	iters: 300, epoch: 1 | loss: 0.8360941
	speed: 0.0045s/iter; left time: 16.4521s
	iters: 400, epoch: 1 | loss: 0.8045415
	speed: 0.0044s/iter; left time: 15.6019s
Updating learning rate to 6.21730293e-05
Validation loss decreased (inf --> 0.6003).  Saving model state dict ...
Epoch: 1 cost time: 2.559717893600464
Epoch: 1, Steps: 490 | Train Loss: 0.8542452 Vali Loss: 0.6003451 Best vali loss: 0.6003451
	iters: 100, epoch: 2 | loss: 0.6806502
	speed: 0.0128s/iter; left time: 42.6218s
	iters: 200, epoch: 2 | loss: 0.5074022
	speed: 0.0046s/iter; left time: 14.8590s
	iters: 300, epoch: 2 | loss: 0.4512263
	speed: 0.0046s/iter; left time: 14.4895s
	iters: 400, epoch: 2 | loss: 0.7558795
	speed: 0.0045s/iter; left time: 13.6180s
Updating learning rate to 3.108651465e-05
Validation loss decreased (0.6003 --> 0.5753).  Saving model state dict ...
Epoch: 2 cost time: 2.2947728633880615
Epoch: 2, Steps: 490 | Train Loss: 0.5987895 Vali Loss: 0.5753399 Best vali loss: 0.5753399
	iters: 100, epoch: 3 | loss: 0.5275388
	speed: 0.0128s/iter; left time: 36.4035s
	iters: 200, epoch: 3 | loss: 0.8055782
	speed: 0.0042s/iter; left time: 11.6225s
	iters: 300, epoch: 3 | loss: 0.9953408
	speed: 0.0044s/iter; left time: 11.5523s
	iters: 400, epoch: 3 | loss: 0.8649538
	speed: 0.0045s/iter; left time: 11.5215s
Updating learning rate to 1.5543257325e-05
Validation loss decreased (0.5753 --> 0.5753).  Saving model state dict ...
Epoch: 3 cost time: 2.2042884826660156
Epoch: 3, Steps: 490 | Train Loss: 0.7983529 Vali Loss: 0.5753376 Best vali loss: 0.5753376
	iters: 100, epoch: 4 | loss: 0.5297304
	speed: 0.0128s/iter; left time: 30.1164s
	iters: 200, epoch: 4 | loss: 0.4351755
	speed: 0.0042s/iter; left time: 9.5320s
	iters: 300, epoch: 4 | loss: 0.7911205
	speed: 0.0042s/iter; left time: 8.9270s
	iters: 400, epoch: 4 | loss: 0.8422187
	speed: 0.0042s/iter; left time: 8.5460s
Updating learning rate to 7.7716286625e-06
Epoch: 4 cost time: 2.132340431213379
Epoch: 4, Steps: 490 | Train Loss: 0.6495613 Vali Loss: 0.5767631 Best vali loss: 0.5753376
	iters: 100, epoch: 5 | loss: 0.8630916
	speed: 0.0115s/iter; left time: 21.4167s
	iters: 200, epoch: 5 | loss: 0.5527114
	speed: 0.0043s/iter; left time: 7.5462s
	iters: 300, epoch: 5 | loss: 0.6557542
	speed: 0.0042s/iter; left time: 6.9150s
	iters: 400, epoch: 5 | loss: 0.5831105
	speed: 0.0041s/iter; left time: 6.3463s
Updating learning rate to 3.88581433125e-06
Validation loss decreased (0.5753 --> 0.5746).  Saving model state dict ...
Epoch: 5 cost time: 2.083085060119629
Epoch: 5, Steps: 490 | Train Loss: 0.6636669 Vali Loss: 0.5745976 Best vali loss: 0.5745976
	iters: 100, epoch: 6 | loss: 0.5003757
	speed: 0.0121s/iter; left time: 16.5293s
	iters: 200, epoch: 6 | loss: 0.9339747
	speed: 0.0041s/iter; left time: 5.1487s
	iters: 300, epoch: 6 | loss: 0.3900567
	speed: 0.0041s/iter; left time: 4.8132s
	iters: 400, epoch: 6 | loss: 0.5347685
	speed: 0.0042s/iter; left time: 4.4570s
Updating learning rate to 1.942907165625e-06
Validation loss decreased (0.5746 --> 0.5682).  Saving model state dict ...
Epoch: 6 cost time: 2.067551374435425
Epoch: 6, Steps: 490 | Train Loss: 0.5897939 Vali Loss: 0.5682388 Best vali loss: 0.5682388
	iters: 100, epoch: 7 | loss: 0.3753116
	speed: 0.0125s/iter; left time: 11.0472s
	iters: 200, epoch: 7 | loss: 0.7849480
	speed: 0.0048s/iter; left time: 3.7472s
	iters: 300, epoch: 7 | loss: 0.9998942
	speed: 0.0041s/iter; left time: 2.8181s
	iters: 400, epoch: 7 | loss: 0.7502032
	speed: 0.0042s/iter; left time: 2.4459s
Updating learning rate to 9.714535828125e-07
Validation loss decreased (0.5682 --> 0.5662).  Saving model state dict ...
Epoch: 7 cost time: 2.200171709060669
Epoch: 7, Steps: 490 | Train Loss: 0.7275892 Vali Loss: 0.5662403 Best vali loss: 0.5662403
	iters: 100, epoch: 8 | loss: 0.7315310
	speed: 0.0119s/iter; left time: 4.6416s
	iters: 200, epoch: 8 | loss: 0.4509268
	speed: 0.0041s/iter; left time: 1.1854s
	iters: 300, epoch: 8 | loss: 0.4640954
	speed: 0.0040s/iter; left time: 0.7668s
	iters: 400, epoch: 8 | loss: 0.5585013
	speed: 0.0041s/iter; left time: 0.3766s
Updating learning rate to 4.8572679140625e-07
Epoch: 8 cost time: 2.0394725799560547
Epoch: 8, Steps: 490 | Train Loss: 0.5512636 Vali Loss: 0.5665678 Best vali loss: 0.5662403

best validation loss 0.5662402666343246

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022301405671, 'e_layers': 4, 'learning_rate': 0.00098080355, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8141002
	speed: 0.0154s/iter; left time: 13.5948s
Updating learning rate to 0.00098080355
Validation loss decreased (inf --> 0.6627).  Saving model state dict ...
Epoch: 1 cost time: 1.4645113945007324
Epoch: 1, Steps: 123 | Train Loss: 0.8141002 Vali Loss: 0.6627222 Best vali loss: 0.6627222
	iters: 100, epoch: 2 | loss: 0.9962099
	speed: 0.0141s/iter; left time: 10.7106s
Updating learning rate to 0.000490401775
Validation loss decreased (0.6627 --> 0.6355).  Saving model state dict ...
Epoch: 2 cost time: 1.1571099758148193
Epoch: 2, Steps: 123 | Train Loss: 0.9962099 Vali Loss: 0.6355451 Best vali loss: 0.6355451
	iters: 100, epoch: 3 | loss: 0.6875467
	speed: 0.0145s/iter; left time: 9.2875s
Updating learning rate to 0.0002452008875
Validation loss decreased (0.6355 --> 0.6331).  Saving model state dict ...
Epoch: 3 cost time: 1.1754117012023926
Epoch: 3, Steps: 123 | Train Loss: 0.6875467 Vali Loss: 0.6331398 Best vali loss: 0.6331398
	iters: 100, epoch: 4 | loss: 0.9090120
	speed: 0.0145s/iter; left time: 7.4567s
Updating learning rate to 0.00012260044375
Validation loss decreased (0.6331 --> 0.6251).  Saving model state dict ...
Epoch: 4 cost time: 1.1650211811065674
Epoch: 4, Steps: 123 | Train Loss: 0.9090120 Vali Loss: 0.6250923 Best vali loss: 0.6250923
	iters: 100, epoch: 5 | loss: 0.8525214
	speed: 0.0145s/iter; left time: 5.6805s
Updating learning rate to 6.1300221875e-05
Epoch: 5 cost time: 1.1651978492736816
Epoch: 5, Steps: 123 | Train Loss: 0.8525214 Vali Loss: 0.6372612 Best vali loss: 0.6250923
	iters: 100, epoch: 6 | loss: 0.7678393
	speed: 0.0139s/iter; left time: 3.7437s
Updating learning rate to 3.06501109375e-05
Epoch: 6 cost time: 1.1596629619598389
Epoch: 6, Steps: 123 | Train Loss: 0.7678393 Vali Loss: 0.6364715 Best vali loss: 0.6250923
	iters: 100, epoch: 7 | loss: 1.1413698
	speed: 0.0139s/iter; left time: 2.0462s
Updating learning rate to 1.532505546875e-05
Epoch: 7 cost time: 1.165405511856079
Epoch: 7, Steps: 123 | Train Loss: 1.1413698 Vali Loss: 0.6384537 Best vali loss: 0.6250923
	iters: 100, epoch: 8 | loss: 1.0532064
	speed: 0.0140s/iter; left time: 0.3369s
Updating learning rate to 7.662527734375e-06
Epoch: 8 cost time: 1.167776107788086
Epoch: 8, Steps: 123 | Train Loss: 1.0532064 Vali Loss: 0.6384727 Best vali loss: 0.6250923

best validation loss 0.6250923278981588

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001866448902, 'e_layers': 3, 'learning_rate': 0.0001641060182, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9137806
	speed: 0.0126s/iter; left time: 11.1794s
Updating learning rate to 0.00015786010478845237
Validation loss decreased (inf --> 0.6004).  Saving model state dict ...
Epoch: 1 cost time: 1.117846965789795
Epoch: 1, Steps: 123 | Train Loss: 0.9137806 Vali Loss: 0.6004230 Best vali loss: 0.6004230
	iters: 100, epoch: 2 | loss: 0.8258566
	speed: 0.0101s/iter; left time: 7.7177s
Updating learning rate to 0.0001400732482513715
Epoch: 2 cost time: 0.7907319068908691
Epoch: 2, Steps: 123 | Train Loss: 0.8258566 Vali Loss: 0.6017935 Best vali loss: 0.6004230
	iters: 100, epoch: 3 | loss: 0.8437657
	speed: 0.0094s/iter; left time: 6.0178s
Updating learning rate to 0.00011345333625827196
Validation loss decreased (0.6004 --> 0.5708).  Saving model state dict ...
Epoch: 3 cost time: 0.7415728569030762
Epoch: 3, Steps: 123 | Train Loss: 0.8437657 Vali Loss: 0.5707549 Best vali loss: 0.5707549

best validation loss 0.5707549014228298

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0076836854334, 'e_layers': 1, 'learning_rate': 0.0033940107155, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0352371
	speed: 0.0090s/iter; left time: 34.4452s
	iters: 200, epoch: 1 | loss: 0.6771100
	speed: 0.0027s/iter; left time: 10.1553s
	iters: 300, epoch: 1 | loss: 0.7425170
	speed: 0.0028s/iter; left time: 10.0241s
	iters: 400, epoch: 1 | loss: 1.7429680
	speed: 0.0028s/iter; left time: 9.8553s
Updating learning rate to 0.003264833874337219
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 1.6871373653411865
Epoch: 1, Steps: 490 | Train Loss: 1.0494580 Vali Loss: 0.5982312 Best vali loss: 0.5982312
	iters: 100, epoch: 2 | loss: 1.2184308
	speed: 0.0080s/iter; left time: 26.7623s
	iters: 200, epoch: 2 | loss: 1.0994418
	speed: 0.0024s/iter; left time: 7.7122s
	iters: 300, epoch: 2 | loss: 0.9820846
	speed: 0.0024s/iter; left time: 7.5267s
	iters: 400, epoch: 2 | loss: 0.7529683
	speed: 0.0024s/iter; left time: 7.2869s
Updating learning rate to 0.002896969353924928
Epoch: 2 cost time: 1.2337217330932617
Epoch: 2, Steps: 490 | Train Loss: 1.0132314 Vali Loss: 0.6036155 Best vali loss: 0.5982312
	iters: 100, epoch: 3 | loss: 0.4880078
	speed: 0.0076s/iter; left time: 21.4803s
	iters: 200, epoch: 3 | loss: 1.2020787
	speed: 0.0025s/iter; left time: 6.7386s
	iters: 300, epoch: 3 | loss: 1.0046966
	speed: 0.0025s/iter; left time: 6.4934s
	iters: 400, epoch: 3 | loss: 1.1013949
	speed: 0.0025s/iter; left time: 6.3784s
Updating learning rate to 0.0023464211927957173
Validation loss decreased (0.5982 --> 0.5961).  Saving model state dict ...
Epoch: 3 cost time: 1.2583918571472168
Epoch: 3, Steps: 490 | Train Loss: 0.9490445 Vali Loss: 0.5960982 Best vali loss: 0.5960982

best validation loss 0.5960982431696831

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010431069875, 'e_layers': 1, 'learning_rate': 0.0002546995153, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8044415
	speed: 0.0096s/iter; left time: 8.4845s
Updating learning rate to 0.00024500559221310767
Validation loss decreased (inf --> 0.6033).  Saving model state dict ...
Epoch: 1 cost time: 0.7528076171875
Epoch: 1, Steps: 123 | Train Loss: 0.8044415 Vali Loss: 0.6032846 Best vali loss: 0.6032846
	iters: 100, epoch: 2 | loss: 0.7778056
	speed: 0.0063s/iter; left time: 4.8049s
Updating learning rate to 0.00021739963486677838
Epoch: 2 cost time: 0.4631764888763428
Epoch: 2, Steps: 123 | Train Loss: 0.7778056 Vali Loss: 0.6098939 Best vali loss: 0.6032846
	iters: 100, epoch: 3 | loss: 0.9610016
	speed: 0.0061s/iter; left time: 3.8963s
Updating learning rate to 0.00017608440001836434
Validation loss decreased (0.6033 --> 0.6032).  Saving model state dict ...
Epoch: 3 cost time: 0.4592554569244385
Epoch: 3, Steps: 123 | Train Loss: 0.9610016 Vali Loss: 0.6031998 Best vali loss: 0.6031998

best validation loss 0.6031998439223498

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001866448902, 'e_layers': 3, 'learning_rate': 0.0001641060182, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8363973
	speed: 0.0126s/iter; left time: 6.4771s
Updating learning rate to 8.20530091e-05
Validation loss decreased (0.5708 --> 0.5535).  Saving model state dict ...
Epoch: 4 cost time: 1.0733275413513184
Epoch: 4, Steps: 123 | Train Loss: 0.8363973 Vali Loss: 0.5535119 Best vali loss: 0.5535119
	iters: 100, epoch: 5 | loss: 0.7402248
	speed: 0.0101s/iter; left time: 3.9828s
Updating learning rate to 5.065268194172806e-05
Epoch: 5 cost time: 0.7863812446594238
Epoch: 5, Steps: 123 | Train Loss: 0.7402248 Vali Loss: 0.5561504 Best vali loss: 0.5535119
	iters: 100, epoch: 6 | loss: 0.7690650
	speed: 0.0096s/iter; left time: 2.6054s
Updating learning rate to 2.4032769948628515e-05
Validation loss decreased (0.5535 --> 0.5497).  Saving model state dict ...
Epoch: 6 cost time: 0.7843763828277588
Epoch: 6, Steps: 123 | Train Loss: 0.7690650 Vali Loss: 0.5496965 Best vali loss: 0.5496965
	iters: 100, epoch: 7 | loss: 0.6532149
	speed: 0.0100s/iter; left time: 1.4743s
Updating learning rate to 6.2459134115476435e-06
Validation loss decreased (0.5497 --> 0.5467).  Saving model state dict ...
Epoch: 7 cost time: 0.7828857898712158
Epoch: 7, Steps: 123 | Train Loss: 0.6532149 Vali Loss: 0.5466565 Best vali loss: 0.5466565
	iters: 100, epoch: 8 | loss: 0.8561036
	speed: 0.0098s/iter; left time: 0.2357s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7659561634063721
Epoch: 8, Steps: 123 | Train Loss: 0.8561036 Vali Loss: 0.5467289 Best vali loss: 0.5466565

best validation loss 0.5466564906134422

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008083700479, 'e_layers': 3, 'learning_rate': 0.0002548435119, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6306785
	speed: 0.0115s/iter; left time: 10.1856s
Updating learning rate to 0.0002548435119
Validation loss decreased (inf --> 0.5947).  Saving model state dict ...
Epoch: 1 cost time: 0.9969995021820068
Epoch: 1, Steps: 123 | Train Loss: 0.6306785 Vali Loss: 0.5946856 Best vali loss: 0.5946856
	iters: 100, epoch: 2 | loss: 0.8377858
	speed: 0.0087s/iter; left time: 6.6227s
Updating learning rate to 0.00012742175595
Validation loss decreased (0.5947 --> 0.5715).  Saving model state dict ...
Epoch: 2 cost time: 0.7148354053497314
Epoch: 2, Steps: 123 | Train Loss: 0.8377858 Vali Loss: 0.5714772 Best vali loss: 0.5714772
	iters: 100, epoch: 3 | loss: 0.6122167
	speed: 0.0087s/iter; left time: 5.5509s
Updating learning rate to 6.3710877975e-05
Validation loss decreased (0.5715 --> 0.5600).  Saving model state dict ...
Epoch: 3 cost time: 0.699211597442627
Epoch: 3, Steps: 123 | Train Loss: 0.6122167 Vali Loss: 0.5600230 Best vali loss: 0.5600230
	iters: 100, epoch: 4 | loss: 1.0041941
	speed: 0.0086s/iter; left time: 4.4336s
Updating learning rate to 3.18554389875e-05
Validation loss decreased (0.5600 --> 0.5516).  Saving model state dict ...
Epoch: 4 cost time: 0.6781480312347412
Epoch: 4, Steps: 123 | Train Loss: 1.0041941 Vali Loss: 0.5515543 Best vali loss: 0.5515543
	iters: 100, epoch: 5 | loss: 0.8988702
	speed: 0.0086s/iter; left time: 3.3687s
Updating learning rate to 1.592771949375e-05
Validation loss decreased (0.5516 --> 0.5490).  Saving model state dict ...
Epoch: 5 cost time: 0.6903071403503418
Epoch: 5, Steps: 123 | Train Loss: 0.8988702 Vali Loss: 0.5490217 Best vali loss: 0.5490217
	iters: 100, epoch: 6 | loss: 0.7158447
	speed: 0.0085s/iter; left time: 2.2861s
Updating learning rate to 7.963859746875e-06
Epoch: 6 cost time: 0.6720964908599854
Epoch: 6, Steps: 123 | Train Loss: 0.7158447 Vali Loss: 0.5504260 Best vali loss: 0.5490217
	iters: 100, epoch: 7 | loss: 0.9426192
	speed: 0.0082s/iter; left time: 1.2080s
Updating learning rate to 3.9819298734375e-06
Epoch: 7 cost time: 0.6663637161254883
Epoch: 7, Steps: 123 | Train Loss: 0.9426192 Vali Loss: 0.5505765 Best vali loss: 0.5490217
	iters: 100, epoch: 8 | loss: 0.7750450
	speed: 0.0089s/iter; left time: 0.2125s
Updating learning rate to 1.99096493671875e-06
Epoch: 8 cost time: 0.7372136116027832
Epoch: 8, Steps: 123 | Train Loss: 0.7750450 Vali Loss: 0.5500018 Best vali loss: 0.5490217

best validation loss 0.5490216594887574

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008751444478, 'e_layers': 3, 'learning_rate': 0.0002572834901, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6305473
	speed: 0.0118s/iter; left time: 10.4127s
Updating learning rate to 0.0002474912203282301
Validation loss decreased (inf --> 0.5947).  Saving model state dict ...
Epoch: 1 cost time: 1.020777940750122
Epoch: 1, Steps: 123 | Train Loss: 0.6305473 Vali Loss: 0.5946603 Best vali loss: 0.5946603
	iters: 100, epoch: 2 | loss: 0.8388957
	speed: 0.0091s/iter; left time: 6.9137s
Updating learning rate to 0.00021960519531852597
Validation loss decreased (0.5947 --> 0.5700).  Saving model state dict ...
Epoch: 2 cost time: 0.7236895561218262
Epoch: 2, Steps: 123 | Train Loss: 0.8388957 Vali Loss: 0.5700339 Best vali loss: 0.5700339
	iters: 100, epoch: 3 | loss: 0.6081991
	speed: 0.0091s/iter; left time: 5.8453s
Updating learning rate to 0.0001778708095911688
Validation loss decreased (0.5700 --> 0.5672).  Saving model state dict ...
Epoch: 3 cost time: 0.7414693832397461
Epoch: 3, Steps: 123 | Train Loss: 0.6081991 Vali Loss: 0.5672340 Best vali loss: 0.5672340
	iters: 100, epoch: 4 | loss: 1.0052050
	speed: 0.0086s/iter; left time: 4.4238s
Updating learning rate to 0.00012864174505
Validation loss decreased (0.5672 --> 0.5538).  Saving model state dict ...
Epoch: 4 cost time: 0.6620535850524902
Epoch: 4, Steps: 123 | Train Loss: 1.0052050 Vali Loss: 0.5538339 Best vali loss: 0.5538339
	iters: 100, epoch: 5 | loss: 0.8921966
	speed: 0.0083s/iter; left time: 3.2635s
Updating learning rate to 7.94126805088312e-05
Validation loss decreased (0.5538 --> 0.5493).  Saving model state dict ...
Epoch: 5 cost time: 0.6617684364318848
Epoch: 5, Steps: 123 | Train Loss: 0.8921966 Vali Loss: 0.5492807 Best vali loss: 0.5492807
	iters: 100, epoch: 6 | loss: 0.7036250
	speed: 0.0085s/iter; left time: 2.3038s
Updating learning rate to 3.7678294781474025e-05
Validation loss decreased (0.5493 --> 0.5449).  Saving model state dict ...
Epoch: 6 cost time: 0.6929764747619629
Epoch: 6, Steps: 123 | Train Loss: 0.7036250 Vali Loss: 0.5449024 Best vali loss: 0.5449024
	iters: 100, epoch: 7 | loss: 0.9297428
	speed: 0.0087s/iter; left time: 1.2833s
Updating learning rate to 9.792269771769865e-06
Epoch: 7 cost time: 0.6948387622833252
Epoch: 7, Steps: 123 | Train Loss: 0.9297428 Vali Loss: 0.5469688 Best vali loss: 0.5449024
	iters: 100, epoch: 8 | loss: 0.7512718
	speed: 0.0086s/iter; left time: 0.2062s
Updating learning rate to 0.0
Validation loss decreased (0.5449 --> 0.5423).  Saving model state dict ...
Epoch: 8 cost time: 0.6984767913818359
Epoch: 8, Steps: 123 | Train Loss: 0.7512718 Vali Loss: 0.5423202 Best vali loss: 0.5423202

best validation loss 0.5423202416594521

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494713762, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7744652
	speed: 0.0115s/iter; left time: 10.1619s
Updating learning rate to 0.0002864971172441233
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.0139875411987305
Epoch: 1, Steps: 123 | Train Loss: 0.7744652 Vali Loss: 0.6172923 Best vali loss: 0.6172923
	iters: 100, epoch: 2 | loss: 0.9520369
	speed: 0.0092s/iter; left time: 7.0114s
Updating learning rate to 0.0002542161104024173
Validation loss decreased (0.6173 --> 0.5712).  Saving model state dict ...
Epoch: 2 cost time: 0.7174563407897949
Epoch: 2, Steps: 123 | Train Loss: 0.9520369 Vali Loss: 0.5711821 Best vali loss: 0.5711821
	iters: 100, epoch: 3 | loss: 0.8509780
	speed: 0.0094s/iter; left time: 5.9980s
Updating learning rate to 0.000205904169538476
Validation loss decreased (0.5712 --> 0.5492).  Saving model state dict ...
Epoch: 3 cost time: 0.7289619445800781
Epoch: 3, Steps: 123 | Train Loss: 0.8509780 Vali Loss: 0.5491628 Best vali loss: 0.5491628

best validation loss 0.5491628322210758

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0034139856579, 'e_layers': 3, 'learning_rate': 0.0007623700295, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9063205
	speed: 0.0102s/iter; left time: 78.5268s
	iters: 200, epoch: 1 | loss: 1.6120288
	speed: 0.0038s/iter; left time: 28.7548s
	iters: 300, epoch: 1 | loss: 0.5672415
	speed: 0.0038s/iter; left time: 28.3350s
	iters: 400, epoch: 1 | loss: 1.4135965
	speed: 0.0039s/iter; left time: 29.0420s
	iters: 500, epoch: 1 | loss: 1.3000690
	speed: 0.0039s/iter; left time: 28.5393s
	iters: 600, epoch: 1 | loss: 1.3249594
	speed: 0.0038s/iter; left time: 27.7624s
	iters: 700, epoch: 1 | loss: 0.7040880
	speed: 0.0037s/iter; left time: 26.5951s
	iters: 800, epoch: 1 | loss: 0.7294788
	speed: 0.0039s/iter; left time: 27.3497s
	iters: 900, epoch: 1 | loss: 0.2782393
	speed: 0.0038s/iter; left time: 26.0229s
Updating learning rate to 0.000733354047977538
Validation loss decreased (inf --> 0.6272).  Saving model state dict ...
Epoch: 1 cost time: 4.101952075958252
Epoch: 1, Steps: 979 | Train Loss: 0.9817802 Vali Loss: 0.6271851 Best vali loss: 0.6271851
	iters: 100, epoch: 2 | loss: 1.1584736
	speed: 0.0123s/iter; left time: 82.9531s
	iters: 200, epoch: 2 | loss: 1.1487756
	speed: 0.0038s/iter; left time: 25.0938s
	iters: 300, epoch: 2 | loss: 0.4290242
	speed: 0.0038s/iter; left time: 24.5987s
	iters: 400, epoch: 2 | loss: 0.3979589
	speed: 0.0037s/iter; left time: 24.1430s
	iters: 500, epoch: 2 | loss: 1.5045398
	speed: 0.0039s/iter; left time: 24.6106s
	iters: 600, epoch: 2 | loss: 1.1237659
	speed: 0.0038s/iter; left time: 23.7066s
	iters: 700, epoch: 2 | loss: 1.1183966
	speed: 0.0040s/iter; left time: 24.5469s
	iters: 800, epoch: 2 | loss: 1.1294140
	speed: 0.0037s/iter; left time: 22.6924s
	iters: 900, epoch: 2 | loss: 0.9680208
	speed: 0.0038s/iter; left time: 22.3749s
Updating learning rate to 0.0006507235235664191
Validation loss decreased (0.6272 --> 0.6051).  Saving model state dict ...
Epoch: 2 cost time: 3.751873254776001
Epoch: 2, Steps: 979 | Train Loss: 0.9975966 Vali Loss: 0.6050695 Best vali loss: 0.6050695
	iters: 100, epoch: 3 | loss: 1.0243020
	speed: 0.0131s/iter; left time: 75.7003s
	iters: 200, epoch: 3 | loss: 0.6432298
	speed: 0.0043s/iter; left time: 24.2326s
	iters: 300, epoch: 3 | loss: 0.6287603
	speed: 0.0043s/iter; left time: 23.9239s
	iters: 400, epoch: 3 | loss: 0.8027385
	speed: 0.0044s/iter; left time: 23.8353s
	iters: 500, epoch: 3 | loss: 0.7637568
	speed: 0.0044s/iter; left time: 23.7297s
	iters: 600, epoch: 3 | loss: 0.2847035
	speed: 0.0044s/iter; left time: 23.2500s
	iters: 700, epoch: 3 | loss: 0.6455939
	speed: 0.0044s/iter; left time: 22.7571s
	iters: 800, epoch: 3 | loss: 0.3511337
	speed: 0.0044s/iter; left time: 22.1581s
	iters: 900, epoch: 3 | loss: 0.3608899
	speed: 0.0043s/iter; left time: 21.5758s
Updating learning rate to 0.0005270582045606674
Epoch: 3 cost time: 4.297383069992065
Epoch: 3, Steps: 979 | Train Loss: 0.6116787 Vali Loss: 0.6221578 Best vali loss: 0.6050695

best validation loss 0.6050695499188918

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016969650026, 'e_layers': 3, 'learning_rate': 0.000235418835, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5963361
	speed: 0.0106s/iter; left time: 40.6702s
	iters: 200, epoch: 1 | loss: 1.2269022
	speed: 0.0046s/iter; left time: 17.2331s
	iters: 300, epoch: 1 | loss: 0.8153911
	speed: 0.0046s/iter; left time: 16.7440s
	iters: 400, epoch: 1 | loss: 0.8362001
	speed: 0.0046s/iter; left time: 16.3560s
Updating learning rate to 0.0002264587391120759
Validation loss decreased (inf --> 0.6021).  Saving model state dict ...
Epoch: 1 cost time: 2.6038081645965576
Epoch: 1, Steps: 490 | Train Loss: 0.8687074 Vali Loss: 0.6020949 Best vali loss: 0.6020949
	iters: 100, epoch: 2 | loss: 0.7496657
	speed: 0.0128s/iter; left time: 42.5535s
	iters: 200, epoch: 2 | loss: 0.5147517
	speed: 0.0046s/iter; left time: 14.9086s
	iters: 300, epoch: 2 | loss: 0.4581302
	speed: 0.0046s/iter; left time: 14.3239s
	iters: 400, epoch: 2 | loss: 0.8397799
	speed: 0.0045s/iter; left time: 13.7642s
Updating learning rate to 0.00020094254482376847
Validation loss decreased (0.6021 --> 0.5974).  Saving model state dict ...
Epoch: 2 cost time: 2.3018949031829834
Epoch: 2, Steps: 490 | Train Loss: 0.6405819 Vali Loss: 0.5973793 Best vali loss: 0.5973793
	iters: 100, epoch: 3 | loss: 0.5295904
	speed: 0.0129s/iter; left time: 36.7527s
	iters: 200, epoch: 3 | loss: 0.8384122
	speed: 0.0044s/iter; left time: 12.0419s
	iters: 300, epoch: 3 | loss: 0.9777365
	speed: 0.0043s/iter; left time: 11.4011s
	iters: 400, epoch: 3 | loss: 0.8792959
	speed: 0.0043s/iter; left time: 10.9735s
Updating learning rate to 0.00016275486141059537
Epoch: 3 cost time: 2.2002344131469727
Epoch: 3, Steps: 490 | Train Loss: 0.8062588 Vali Loss: 0.6331156 Best vali loss: 0.5973793

best validation loss 0.597379336232722

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494713762, 'e_layers': 2, 'learning_rate': 0.0002978326994, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5866887
	speed: 0.0120s/iter; left time: 6.1805s
Updating learning rate to 0.0001489163497
Validation loss decreased (0.5492 --> 0.5361).  Saving model state dict ...
Epoch: 4 cost time: 1.0173609256744385
Epoch: 4, Steps: 123 | Train Loss: 0.5866887 Vali Loss: 0.5361437 Best vali loss: 0.5361437
	iters: 100, epoch: 5 | loss: 0.8192176
	speed: 0.0093s/iter; left time: 3.6490s
Updating learning rate to 9.192852986152399e-05
Validation loss decreased (0.5361 --> 0.5243).  Saving model state dict ...
Epoch: 5 cost time: 0.7128517627716064
Epoch: 5, Steps: 123 | Train Loss: 0.8192176 Vali Loss: 0.5243311 Best vali loss: 0.5243311
	iters: 100, epoch: 6 | loss: 0.7614688
	speed: 0.0092s/iter; left time: 2.4830s
Updating learning rate to 4.361658899758271e-05
Epoch: 6 cost time: 0.7160787582397461
Epoch: 6, Steps: 123 | Train Loss: 0.7614688 Vali Loss: 0.5404086 Best vali loss: 0.5243311
	iters: 100, epoch: 7 | loss: 0.4342849
	speed: 0.0089s/iter; left time: 1.3114s
Updating learning rate to 1.1335582155876705e-05
Epoch: 7 cost time: 0.7160646915435791
Epoch: 7, Steps: 123 | Train Loss: 0.4342849 Vali Loss: 0.5497061 Best vali loss: 0.5243311
	iters: 100, epoch: 8 | loss: 0.5060830
	speed: 0.0090s/iter; left time: 0.2149s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7111890316009521
Epoch: 8, Steps: 123 | Train Loss: 0.5060830 Vali Loss: 0.5522728 Best vali loss: 0.5243311

best validation loss 0.5243311359175153

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0112978482476, 'e_layers': 2, 'learning_rate': 0.0001889248502, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6875436
	speed: 0.0107s/iter; left time: 9.5003s
Updating learning rate to 0.0001889248502
Validation loss decreased (inf --> 0.6051).  Saving model state dict ...
Epoch: 1 cost time: 0.9075851440429688
Epoch: 1, Steps: 123 | Train Loss: 0.6875436 Vali Loss: 0.6051365 Best vali loss: 0.6051365
	iters: 100, epoch: 2 | loss: 0.7091964
	speed: 0.0075s/iter; left time: 5.7204s
Updating learning rate to 9.44624251e-05
Validation loss decreased (0.6051 --> 0.5884).  Saving model state dict ...
Epoch: 2 cost time: 0.574725866317749
Epoch: 2, Steps: 123 | Train Loss: 0.7091964 Vali Loss: 0.5883787 Best vali loss: 0.5883787
	iters: 100, epoch: 3 | loss: 0.8944255
	speed: 0.0078s/iter; left time: 4.9916s
Updating learning rate to 4.723121255e-05
Validation loss decreased (0.5884 --> 0.5674).  Saving model state dict ...
Epoch: 3 cost time: 0.6236340999603271
Epoch: 3, Steps: 123 | Train Loss: 0.8944255 Vali Loss: 0.5673589 Best vali loss: 0.5673589
	iters: 100, epoch: 4 | loss: 0.6724951
	speed: 0.0078s/iter; left time: 4.0084s
Updating learning rate to 2.3615606275e-05
Epoch: 4 cost time: 0.6028261184692383
Epoch: 4, Steps: 123 | Train Loss: 0.6724951 Vali Loss: 0.5776623 Best vali loss: 0.5673589
	iters: 100, epoch: 5 | loss: 0.7319789
	speed: 0.0078s/iter; left time: 3.0831s
Updating learning rate to 1.18078031375e-05
Epoch: 5 cost time: 0.6189675331115723
Epoch: 5, Steps: 123 | Train Loss: 0.7319789 Vali Loss: 0.5719061 Best vali loss: 0.5673589
	iters: 100, epoch: 6 | loss: 1.0585145
	speed: 0.0079s/iter; left time: 2.1250s
Updating learning rate to 5.90390156875e-06
Validation loss decreased (0.5674 --> 0.5637).  Saving model state dict ...
Epoch: 6 cost time: 0.6260867118835449
Epoch: 6, Steps: 123 | Train Loss: 1.0585145 Vali Loss: 0.5637046 Best vali loss: 0.5637046
	iters: 100, epoch: 7 | loss: 0.7554341
	speed: 0.0079s/iter; left time: 1.1682s
Updating learning rate to 2.951950784375e-06
Epoch: 7 cost time: 0.6236741542816162
Epoch: 7, Steps: 123 | Train Loss: 0.7554341 Vali Loss: 0.5652573 Best vali loss: 0.5637046
	iters: 100, epoch: 8 | loss: 0.8040126
	speed: 0.0079s/iter; left time: 0.1885s
Updating learning rate to 1.4759753921875e-06
Epoch: 8 cost time: 0.6270387172698975
Epoch: 8, Steps: 123 | Train Loss: 0.8040126 Vali Loss: 0.5639938 Best vali loss: 0.5637046

best validation loss 0.5637046290679643

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010801721176, 'e_layers': 2, 'learning_rate': 0.00061046994, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005872353113896967
Validation loss decreased (inf --> 0.6062).  Saving model state dict ...
Epoch: 1 cost time: 0.7457292079925537
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6062155 Best vali loss: 0.6062155
Updating learning rate to 0.0005210686871422724
Validation loss decreased (0.6062 --> 0.5518).  Saving model state dict ...
Epoch: 2 cost time: 0.45351505279541016
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5517755 Best vali loss: 0.5517755
Updating learning rate to 0.00042204333599745527
Epoch: 3 cost time: 0.45605039596557617
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5703724 Best vali loss: 0.5517755
Updating learning rate to 0.00030523497
Epoch: 4 cost time: 0.4611518383026123
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5542157 Best vali loss: 0.5517755
Updating learning rate to 0.0001884266040025448
Epoch: 5 cost time: 0.45627927780151367
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5610607 Best vali loss: 0.5517755
Updating learning rate to 8.940125285772763e-05
Epoch: 6 cost time: 0.45548439025878906
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5540591 Best vali loss: 0.5517755
Updating learning rate to 2.323462861030337e-05
Epoch: 7 cost time: 0.4532470703125
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5590723 Best vali loss: 0.5517755
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45242977142333984
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5618825 Best vali loss: 0.5517755

best validation loss 0.5517754801607199

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010940230827, 'e_layers': 2, 'learning_rate': 0.0001780014734, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0683390
	speed: 0.0096s/iter; left time: 36.5845s
	iters: 200, epoch: 1 | loss: 0.6475511
	speed: 0.0036s/iter; left time: 13.4541s
	iters: 300, epoch: 1 | loss: 1.3680656
	speed: 0.0036s/iter; left time: 13.1183s
	iters: 400, epoch: 1 | loss: 0.8796699
	speed: 0.0036s/iter; left time: 12.8109s
Updating learning rate to 0.0001780014734
Validation loss decreased (inf --> 0.5993).  Saving model state dict ...
Epoch: 1 cost time: 2.1310057640075684
Epoch: 1, Steps: 490 | Train Loss: 0.9909064 Vali Loss: 0.5992638 Best vali loss: 0.5992638
	iters: 100, epoch: 2 | loss: 1.5033801
	speed: 0.0105s/iter; left time: 35.0090s
	iters: 200, epoch: 2 | loss: 1.2658964
	speed: 0.0036s/iter; left time: 11.7673s
	iters: 300, epoch: 2 | loss: 0.9106014
	speed: 0.0037s/iter; left time: 11.6287s
	iters: 400, epoch: 2 | loss: 0.9271271
	speed: 0.0038s/iter; left time: 11.4567s
Updating learning rate to 8.90007367e-05
Validation loss decreased (0.5993 --> 0.5545).  Saving model state dict ...
Epoch: 2 cost time: 1.8604984283447266
Epoch: 2, Steps: 490 | Train Loss: 1.1517513 Vali Loss: 0.5545492 Best vali loss: 0.5545492
	iters: 100, epoch: 3 | loss: 0.5537650
	speed: 0.0103s/iter; left time: 29.1933s
	iters: 200, epoch: 3 | loss: 0.6064495
	speed: 0.0034s/iter; left time: 9.2907s
	iters: 300, epoch: 3 | loss: 0.7696700
	speed: 0.0034s/iter; left time: 8.9491s
	iters: 400, epoch: 3 | loss: 0.4662869
	speed: 0.0034s/iter; left time: 8.5829s
Updating learning rate to 4.450036835e-05
Validation loss decreased (0.5545 --> 0.5452).  Saving model state dict ...
Epoch: 3 cost time: 1.7182531356811523
Epoch: 3, Steps: 490 | Train Loss: 0.5990428 Vali Loss: 0.5452041 Best vali loss: 0.5452041

best validation loss 0.545204131636891

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020006808323, 'e_layers': 3, 'learning_rate': 0.0001935168236, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8237113
	speed: 0.0116s/iter; left time: 10.2759s
Updating learning rate to 0.00018615152806031855
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 1.0032427310943604
Epoch: 1, Steps: 123 | Train Loss: 0.8237113 Vali Loss: 0.6047640 Best vali loss: 0.6047640
	iters: 100, epoch: 2 | loss: 0.7879271
	speed: 0.0087s/iter; left time: 6.6613s
Updating learning rate to 0.00016517694092062045
Validation loss decreased (0.6048 --> 0.5939).  Saving model state dict ...
Epoch: 2 cost time: 0.7182068824768066
Epoch: 2, Steps: 123 | Train Loss: 0.7879271 Vali Loss: 0.5939415 Best vali loss: 0.5939415
	iters: 100, epoch: 3 | loss: 0.7211275
	speed: 0.0089s/iter; left time: 5.6846s
Updating learning rate to 0.0001337862529378188
Validation loss decreased (0.5939 --> 0.5876).  Saving model state dict ...
Epoch: 3 cost time: 0.6972270011901855
Epoch: 3, Steps: 123 | Train Loss: 0.7211275 Vali Loss: 0.5875947 Best vali loss: 0.5875947

best validation loss 0.5875947066116862

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009982297191, 'e_layers': 2, 'learning_rate': 0.0002170973505, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6270787
	speed: 0.0099s/iter; left time: 18.4114s
	iters: 200, epoch: 1 | loss: 1.0790395
	speed: 0.0039s/iter; left time: 6.8248s
Updating learning rate to 0.0002170973505
Validation loss decreased (inf --> 0.5841).  Saving model state dict ...
Epoch: 1 cost time: 1.2842745780944824
Epoch: 1, Steps: 245 | Train Loss: 0.8530591 Vali Loss: 0.5841134 Best vali loss: 0.5841134
	iters: 100, epoch: 2 | loss: 1.0859029
	speed: 0.0080s/iter; left time: 12.8948s
	iters: 200, epoch: 2 | loss: 1.0413679
	speed: 0.0038s/iter; left time: 5.7203s
Updating learning rate to 0.00010854867525
Validation loss decreased (0.5841 --> 0.5640).  Saving model state dict ...
Epoch: 2 cost time: 0.9708876609802246
Epoch: 2, Steps: 245 | Train Loss: 1.0636354 Vali Loss: 0.5640159 Best vali loss: 0.5640159
	iters: 100, epoch: 3 | loss: 0.6332424
	speed: 0.0081s/iter; left time: 11.1412s
	iters: 200, epoch: 3 | loss: 0.8038200
	speed: 0.0036s/iter; left time: 4.6359s
Updating learning rate to 5.4274337625e-05
Validation loss decreased (0.5640 --> 0.5491).  Saving model state dict ...
Epoch: 3 cost time: 0.9582810401916504
Epoch: 3, Steps: 245 | Train Loss: 0.7185312 Vali Loss: 0.5490636 Best vali loss: 0.5490636

best validation loss 0.54906362871614

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010940230827, 'e_layers': 2, 'learning_rate': 0.0001780014734, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8513030
	speed: 0.0097s/iter; left time: 22.8088s
	iters: 200, epoch: 4 | loss: 0.5778543
	speed: 0.0033s/iter; left time: 7.3665s
	iters: 300, epoch: 4 | loss: 1.1292531
	speed: 0.0033s/iter; left time: 7.0044s
	iters: 400, epoch: 4 | loss: 0.5489677
	speed: 0.0032s/iter; left time: 6.5686s
Updating learning rate to 2.2250184175e-05
Validation loss decreased (0.5452 --> 0.5435).  Saving model state dict ...
Epoch: 4 cost time: 1.956954002380371
Epoch: 4, Steps: 490 | Train Loss: 0.7768446 Vali Loss: 0.5434745 Best vali loss: 0.5434745
	iters: 100, epoch: 5 | loss: 1.1382327
	speed: 0.0095s/iter; left time: 17.7053s
	iters: 200, epoch: 5 | loss: 1.0908760
	speed: 0.0031s/iter; left time: 5.5392s
	iters: 300, epoch: 5 | loss: 0.8005338
	speed: 0.0032s/iter; left time: 5.2585s
	iters: 400, epoch: 5 | loss: 0.8567313
	speed: 0.0033s/iter; left time: 5.2120s
Updating learning rate to 1.11250920875e-05
Validation loss decreased (0.5435 --> 0.5344).  Saving model state dict ...
Epoch: 5 cost time: 1.6290063858032227
Epoch: 5, Steps: 490 | Train Loss: 0.9715934 Vali Loss: 0.5343730 Best vali loss: 0.5343730
	iters: 100, epoch: 6 | loss: 0.5076041
	speed: 0.0097s/iter; left time: 13.2884s
	iters: 200, epoch: 6 | loss: 0.5635538
	speed: 0.0031s/iter; left time: 3.9982s
	iters: 300, epoch: 6 | loss: 0.6693652
	speed: 0.0031s/iter; left time: 3.6308s
	iters: 400, epoch: 6 | loss: 0.4116667
	speed: 0.0032s/iter; left time: 3.4640s
Updating learning rate to 5.56254604375e-06
Validation loss decreased (0.5344 --> 0.5322).  Saving model state dict ...
Epoch: 6 cost time: 1.6151976585388184
Epoch: 6, Steps: 490 | Train Loss: 0.5380475 Vali Loss: 0.5322120 Best vali loss: 0.5322120
	iters: 100, epoch: 7 | loss: 0.6093100
	speed: 0.0095s/iter; left time: 8.3901s
	iters: 200, epoch: 7 | loss: 0.7630461
	speed: 0.0032s/iter; left time: 2.4936s
	iters: 300, epoch: 7 | loss: 0.4605027
	speed: 0.0032s/iter; left time: 2.1945s
	iters: 400, epoch: 7 | loss: 0.9905356
	speed: 0.0032s/iter; left time: 1.8817s
Updating learning rate to 2.781273021875e-06
Epoch: 7 cost time: 1.6207280158996582
Epoch: 7, Steps: 490 | Train Loss: 0.7058486 Vali Loss: 0.5340858 Best vali loss: 0.5322120
	iters: 100, epoch: 8 | loss: 1.6310873
	speed: 0.0094s/iter; left time: 3.6788s
	iters: 200, epoch: 8 | loss: 0.4327095
	speed: 0.0034s/iter; left time: 0.9763s
	iters: 300, epoch: 8 | loss: 0.2854538
	speed: 0.0033s/iter; left time: 0.6218s
	iters: 400, epoch: 8 | loss: 0.7939034
	speed: 0.0031s/iter; left time: 0.2842s
Updating learning rate to 1.3906365109375e-06
Epoch: 8 cost time: 1.6285083293914795
Epoch: 8, Steps: 490 | Train Loss: 0.7857885 Vali Loss: 0.5345786 Best vali loss: 0.5322120

best validation loss 0.5322119802760614

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050090717442, 'e_layers': 1, 'learning_rate': 0.0013267086011, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0583696
	speed: 0.0087s/iter; left time: 67.1031s
	iters: 200, epoch: 1 | loss: 0.9990035
	speed: 0.0025s/iter; left time: 18.9789s
	iters: 300, epoch: 1 | loss: 0.6375421
	speed: 0.0025s/iter; left time: 18.6935s
	iters: 400, epoch: 1 | loss: 0.8418691
	speed: 0.0025s/iter; left time: 18.3047s
	iters: 500, epoch: 1 | loss: 1.2864680
	speed: 0.0025s/iter; left time: 18.2275s
	iters: 600, epoch: 1 | loss: 0.3599790
	speed: 0.0025s/iter; left time: 17.8634s
	iters: 700, epoch: 1 | loss: 0.8206029
	speed: 0.0025s/iter; left time: 17.8276s
	iters: 800, epoch: 1 | loss: 0.9403501
	speed: 0.0025s/iter; left time: 17.3816s
	iters: 900, epoch: 1 | loss: 1.1241003
	speed: 0.0024s/iter; left time: 16.7645s
Updating learning rate to 0.0012762137616314857
Validation loss decreased (inf --> 0.6385).  Saving model state dict ...
Epoch: 1 cost time: 2.749068260192871
Epoch: 1, Steps: 979 | Train Loss: 0.8964761 Vali Loss: 0.6385464 Best vali loss: 0.6385464
	iters: 100, epoch: 2 | loss: 1.0653769
	speed: 0.0090s/iter; left time: 60.6019s
	iters: 200, epoch: 2 | loss: 0.8041451
	speed: 0.0025s/iter; left time: 16.7426s
	iters: 300, epoch: 2 | loss: 0.4636933
	speed: 0.0023s/iter; left time: 15.0253s
	iters: 400, epoch: 2 | loss: 0.8387936
	speed: 0.0023s/iter; left time: 14.7754s
	iters: 500, epoch: 2 | loss: 0.3579196
	speed: 0.0023s/iter; left time: 14.6805s
	iters: 600, epoch: 2 | loss: 0.7197738
	speed: 0.0023s/iter; left time: 14.5651s
	iters: 700, epoch: 2 | loss: 1.3303553
	speed: 0.0023s/iter; left time: 14.0871s
	iters: 800, epoch: 2 | loss: 1.0921160
	speed: 0.0024s/iter; left time: 14.6079s
	iters: 900, epoch: 2 | loss: 0.4188834
	speed: 0.0024s/iter; left time: 14.1242s
Updating learning rate to 0.0011324166247981642
Validation loss decreased (0.6385 --> 0.6227).  Saving model state dict ...
Epoch: 2 cost time: 2.347240447998047
Epoch: 2, Steps: 979 | Train Loss: 0.7878952 Vali Loss: 0.6226809 Best vali loss: 0.6226809
	iters: 100, epoch: 3 | loss: 0.3459695
	speed: 0.0091s/iter; left time: 52.6807s
	iters: 200, epoch: 3 | loss: 1.0741974
	speed: 0.0024s/iter; left time: 13.8673s
	iters: 300, epoch: 3 | loss: 0.7136794
	speed: 0.0022s/iter; left time: 12.3636s
	iters: 400, epoch: 3 | loss: 0.7109626
	speed: 0.0022s/iter; left time: 12.2838s
	iters: 500, epoch: 3 | loss: 1.6207838
	speed: 0.0022s/iter; left time: 11.9721s
	iters: 600, epoch: 3 | loss: 1.0434471
	speed: 0.0022s/iter; left time: 11.6175s
	iters: 700, epoch: 3 | loss: 0.5909823
	speed: 0.0022s/iter; left time: 11.2672s
	iters: 800, epoch: 3 | loss: 1.9436113
	speed: 0.0022s/iter; left time: 11.0933s
	iters: 900, epoch: 3 | loss: 1.0259671
	speed: 0.0022s/iter; left time: 10.8127s
Updating learning rate to 0.0009172090011586175
Epoch: 3 cost time: 2.253573417663574
Epoch: 3, Steps: 979 | Train Loss: 1.0077334 Vali Loss: 0.6551841 Best vali loss: 0.6226809
	iters: 100, epoch: 4 | loss: 1.0245194
	speed: 0.0086s/iter; left time: 41.2850s
	iters: 200, epoch: 4 | loss: 0.8775166
	speed: 0.0024s/iter; left time: 11.4627s
	iters: 300, epoch: 4 | loss: 0.4406080
	speed: 0.0024s/iter; left time: 11.2553s
	iters: 400, epoch: 4 | loss: 1.3939215
	speed: 0.0023s/iter; left time: 10.2692s
	iters: 500, epoch: 4 | loss: 1.2990184
	speed: 0.0023s/iter; left time: 10.2275s
	iters: 600, epoch: 4 | loss: 0.8078698
	speed: 0.0022s/iter; left time: 9.5276s
	iters: 700, epoch: 4 | loss: 0.3303136
	speed: 0.0023s/iter; left time: 9.5479s
	iters: 800, epoch: 4 | loss: 0.7527704
	speed: 0.0023s/iter; left time: 9.2532s
	iters: 900, epoch: 4 | loss: 0.4099768
	speed: 0.0023s/iter; left time: 9.0106s
Updating learning rate to 0.00066335430055
Epoch: 4 cost time: 2.30599308013916
Epoch: 4, Steps: 979 | Train Loss: 0.8151683 Vali Loss: 0.6598225 Best vali loss: 0.6226809
	iters: 100, epoch: 5 | loss: 0.8164099
	speed: 0.0088s/iter; left time: 33.5924s
	iters: 200, epoch: 5 | loss: 0.9529925
	speed: 0.0024s/iter; left time: 9.0034s
	iters: 300, epoch: 5 | loss: 0.4928242
	speed: 0.0023s/iter; left time: 8.2127s
	iters: 400, epoch: 5 | loss: 0.2264812
	speed: 0.0023s/iter; left time: 7.9831s
	iters: 500, epoch: 5 | loss: 0.4599821
	speed: 0.0023s/iter; left time: 7.7150s
	iters: 600, epoch: 5 | loss: 0.4334564
	speed: 0.0022s/iter; left time: 7.3923s
	iters: 700, epoch: 5 | loss: 0.5223925
	speed: 0.0023s/iter; left time: 7.3806s
	iters: 800, epoch: 5 | loss: 0.4716629
	speed: 0.0022s/iter; left time: 6.8661s
	iters: 900, epoch: 5 | loss: 1.2080504
	speed: 0.0023s/iter; left time: 7.0424s
Updating learning rate to 0.0004094995999413827
Epoch: 5 cost time: 2.2943010330200195
Epoch: 5, Steps: 979 | Train Loss: 0.6204725 Vali Loss: 0.6908801 Best vali loss: 0.6226809
	iters: 100, epoch: 6 | loss: 0.3934046
	speed: 0.0086s/iter; left time: 24.3922s
	iters: 200, epoch: 6 | loss: 0.8053355
	speed: 0.0024s/iter; left time: 6.4769s
	iters: 300, epoch: 6 | loss: 0.7884231
	speed: 0.0023s/iter; left time: 6.0106s
	iters: 400, epoch: 6 | loss: 1.2704691
	speed: 0.0023s/iter; left time: 5.9066s
	iters: 500, epoch: 6 | loss: 1.1684508
	speed: 0.0023s/iter; left time: 5.5559s
	iters: 600, epoch: 6 | loss: 0.4081191
	speed: 0.0023s/iter; left time: 5.4179s
	iters: 700, epoch: 6 | loss: 0.6006257
	speed: 0.0023s/iter; left time: 5.0743s
	iters: 800, epoch: 6 | loss: 0.9158323
	speed: 0.0022s/iter; left time: 4.7330s
	iters: 900, epoch: 6 | loss: 0.7073618
	speed: 0.0023s/iter; left time: 4.5951s
Updating learning rate to 0.00019429197630183593
Epoch: 6 cost time: 2.2759313583374023
Epoch: 6, Steps: 979 | Train Loss: 0.7842247 Vali Loss: 0.6928208 Best vali loss: 0.6226809
	iters: 100, epoch: 7 | loss: 0.4607031
	speed: 0.0085s/iter; left time: 15.8512s
	iters: 200, epoch: 7 | loss: 1.3499787
	speed: 0.0023s/iter; left time: 3.9859s
	iters: 300, epoch: 7 | loss: 0.6077303
	speed: 0.0023s/iter; left time: 3.7944s
	iters: 400, epoch: 7 | loss: 1.5756507
	speed: 0.0023s/iter; left time: 3.5875s
	iters: 500, epoch: 7 | loss: 0.6090185
	speed: 0.0023s/iter; left time: 3.3273s
	iters: 600, epoch: 7 | loss: 1.3693849
	speed: 0.0023s/iter; left time: 3.0797s
	iters: 700, epoch: 7 | loss: 0.8105670
	speed: 0.0023s/iter; left time: 2.8554s
	iters: 800, epoch: 7 | loss: 0.2717724
	speed: 0.0023s/iter; left time: 2.6485s
	iters: 900, epoch: 7 | loss: 0.7217165
	speed: 0.0023s/iter; left time: 2.3904s
Updating learning rate to 5.0494839468514404e-05
Epoch: 7 cost time: 2.288910150527954
Epoch: 7, Steps: 979 | Train Loss: 0.8640580 Vali Loss: 0.6731843 Best vali loss: 0.6226809
	iters: 100, epoch: 8 | loss: 0.7845699
	speed: 0.0088s/iter; left time: 7.7199s
	iters: 200, epoch: 8 | loss: 0.6803383
	speed: 0.0023s/iter; left time: 1.7971s
	iters: 300, epoch: 8 | loss: 0.4370153
	speed: 0.0024s/iter; left time: 1.6141s
	iters: 400, epoch: 8 | loss: 0.6297294
	speed: 0.0023s/iter; left time: 1.3530s
	iters: 500, epoch: 8 | loss: 0.4988176
	speed: 0.0024s/iter; left time: 1.1419s
	iters: 600, epoch: 8 | loss: 0.3268334
	speed: 0.0024s/iter; left time: 0.8948s
	iters: 700, epoch: 8 | loss: 1.2147988
	speed: 0.0024s/iter; left time: 0.6632s
	iters: 800, epoch: 8 | loss: 0.4601289
	speed: 0.0024s/iter; left time: 0.4402s
	iters: 900, epoch: 8 | loss: 0.2877603
	speed: 0.0024s/iter; left time: 0.1882s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3677117824554443
Epoch: 8, Steps: 979 | Train Loss: 0.5911102 Vali Loss: 0.6862515 Best vali loss: 0.6226809

best validation loss 0.6226809133207947

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0020799536693, 'e_layers': 2, 'learning_rate': 0.0032440009794, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8675008
	speed: 0.0100s/iter; left time: 38.2098s
	iters: 200, epoch: 1 | loss: 0.5448434
	speed: 0.0035s/iter; left time: 13.0156s
	iters: 300, epoch: 1 | loss: 1.0839370
	speed: 0.0034s/iter; left time: 12.3443s
	iters: 400, epoch: 1 | loss: 0.9013337
	speed: 0.0033s/iter; left time: 11.5335s
Updating learning rate to 0.0032440009794
Validation loss decreased (inf --> 0.6023).  Saving model state dict ...
Epoch: 1 cost time: 2.0401992797851562
Epoch: 1, Steps: 490 | Train Loss: 0.8494038 Vali Loss: 0.6023192 Best vali loss: 0.6023192
	iters: 100, epoch: 2 | loss: 0.7859116
	speed: 0.0100s/iter; left time: 33.1564s
	iters: 200, epoch: 2 | loss: 0.6471086
	speed: 0.0034s/iter; left time: 10.9531s
	iters: 300, epoch: 2 | loss: 1.1412666
	speed: 0.0035s/iter; left time: 11.0486s
	iters: 400, epoch: 2 | loss: 0.4649912
	speed: 0.0036s/iter; left time: 10.7985s
Updating learning rate to 0.0016220004897
Epoch: 2 cost time: 1.7574801445007324
Epoch: 2, Steps: 490 | Train Loss: 0.7598195 Vali Loss: 0.6186216 Best vali loss: 0.6023192
	iters: 100, epoch: 3 | loss: 0.7036459
	speed: 0.0097s/iter; left time: 27.5055s
	iters: 200, epoch: 3 | loss: 0.7081782
	speed: 0.0033s/iter; left time: 9.1372s
	iters: 300, epoch: 3 | loss: 0.7267928
	speed: 0.0034s/iter; left time: 9.0642s
	iters: 400, epoch: 3 | loss: 1.1354585
	speed: 0.0033s/iter; left time: 8.3944s
Updating learning rate to 0.00081100024485
Epoch: 3 cost time: 1.6789603233337402
Epoch: 3, Steps: 490 | Train Loss: 0.8185188 Vali Loss: 0.6419864 Best vali loss: 0.6023192
	iters: 100, epoch: 4 | loss: 1.1500804
	speed: 0.0097s/iter; left time: 22.8035s
	iters: 200, epoch: 4 | loss: 0.7254804
	speed: 0.0034s/iter; left time: 7.6017s
	iters: 300, epoch: 4 | loss: 1.0579301
	speed: 0.0035s/iter; left time: 7.5301s
	iters: 400, epoch: 4 | loss: 0.7421553
	speed: 0.0035s/iter; left time: 7.1620s
Updating learning rate to 0.000405500122425
Epoch: 4 cost time: 1.7306032180786133
Epoch: 4, Steps: 490 | Train Loss: 0.9189116 Vali Loss: 0.6322149 Best vali loss: 0.6023192
	iters: 100, epoch: 5 | loss: 0.7624233
	speed: 0.0098s/iter; left time: 18.2610s
	iters: 200, epoch: 5 | loss: 0.8136699
	speed: 0.0033s/iter; left time: 5.7812s
	iters: 300, epoch: 5 | loss: 0.8400697
	speed: 0.0035s/iter; left time: 5.7899s
	iters: 400, epoch: 5 | loss: 0.5377023
	speed: 0.0033s/iter; left time: 5.2074s
Updating learning rate to 0.0002027500612125
Epoch: 5 cost time: 1.7041869163513184
Epoch: 5, Steps: 490 | Train Loss: 0.7384663 Vali Loss: 0.6389018 Best vali loss: 0.6023192
	iters: 100, epoch: 6 | loss: 0.6933004
	speed: 0.0096s/iter; left time: 13.2103s
	iters: 200, epoch: 6 | loss: 0.4861730
	speed: 0.0031s/iter; left time: 3.9742s
	iters: 300, epoch: 6 | loss: 0.5573081
	speed: 0.0031s/iter; left time: 3.5913s
	iters: 400, epoch: 6 | loss: 1.0645894
	speed: 0.0032s/iter; left time: 3.3754s
Updating learning rate to 0.00010137503060625
Epoch: 6 cost time: 1.5721852779388428
Epoch: 6, Steps: 490 | Train Loss: 0.7003427 Vali Loss: 0.6474121 Best vali loss: 0.6023192
	iters: 100, epoch: 7 | loss: 0.8335461
	speed: 0.0093s/iter; left time: 8.1718s
	iters: 200, epoch: 7 | loss: 0.5209867
	speed: 0.0032s/iter; left time: 2.5288s
	iters: 300, epoch: 7 | loss: 0.9608614
	speed: 0.0031s/iter; left time: 2.0809s
	iters: 400, epoch: 7 | loss: 0.5333461
	speed: 0.0031s/iter; left time: 1.7767s
Updating learning rate to 5.0687515303125e-05
Epoch: 7 cost time: 1.6027507781982422
Epoch: 7, Steps: 490 | Train Loss: 0.7121851 Vali Loss: 0.6466839 Best vali loss: 0.6023192
	iters: 100, epoch: 8 | loss: 0.8246243
	speed: 0.0093s/iter; left time: 3.6333s
	iters: 200, epoch: 8 | loss: 0.5921945
	speed: 0.0033s/iter; left time: 0.9643s
	iters: 300, epoch: 8 | loss: 1.0721494
	speed: 0.0035s/iter; left time: 0.6711s
	iters: 400, epoch: 8 | loss: 0.4817593
	speed: 0.0036s/iter; left time: 0.3248s
Updating learning rate to 2.53437576515625e-05
Epoch: 8 cost time: 1.7336702346801758
Epoch: 8, Steps: 490 | Train Loss: 0.7426819 Vali Loss: 0.6459334 Best vali loss: 0.6023192

best validation loss 0.6023191561416474

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0070135061629, 'e_layers': 4, 'learning_rate': 0.0003564386322, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0705159
	speed: 0.0127s/iter; left time: 11.1998s
Updating learning rate to 0.0003564386322
Validation loss decreased (inf --> 0.6354).  Saving model state dict ...
Epoch: 1 cost time: 1.123122215270996
Epoch: 1, Steps: 123 | Train Loss: 1.0705159 Vali Loss: 0.6354217 Best vali loss: 0.6354217
	iters: 100, epoch: 2 | loss: 0.6336195
	speed: 0.0096s/iter; left time: 7.2858s
Updating learning rate to 0.0001782193161
Validation loss decreased (0.6354 --> 0.6194).  Saving model state dict ...
Epoch: 2 cost time: 0.7845361232757568
Epoch: 2, Steps: 123 | Train Loss: 0.6336195 Vali Loss: 0.6194228 Best vali loss: 0.6194228
	iters: 100, epoch: 3 | loss: 0.9916640
	speed: 0.0095s/iter; left time: 6.0770s
Updating learning rate to 8.910965805e-05
Validation loss decreased (0.6194 --> 0.6100).  Saving model state dict ...
Epoch: 3 cost time: 0.7799155712127686
Epoch: 3, Steps: 123 | Train Loss: 0.9916640 Vali Loss: 0.6100445 Best vali loss: 0.6100445

best validation loss 0.6100444779358546

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0048347833727, 'e_layers': 3, 'learning_rate': 0.0003931175955, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0003374
	speed: 0.0113s/iter; left time: 9.9846s
Updating learning rate to 0.0003931175955
Validation loss decreased (inf --> 0.6211).  Saving model state dict ...
Epoch: 1 cost time: 0.9582779407501221
Epoch: 1, Steps: 123 | Train Loss: 1.0003374 Vali Loss: 0.6210544 Best vali loss: 0.6210544
	iters: 100, epoch: 2 | loss: 1.0342398
	speed: 0.0086s/iter; left time: 6.5589s
Updating learning rate to 0.00019655879775
Validation loss decreased (0.6211 --> 0.6095).  Saving model state dict ...
Epoch: 2 cost time: 0.6703135967254639
Epoch: 2, Steps: 123 | Train Loss: 1.0342398 Vali Loss: 0.6095167 Best vali loss: 0.6095167
	iters: 100, epoch: 3 | loss: 0.8399822
	speed: 0.0088s/iter; left time: 5.6481s
Updating learning rate to 9.8279398875e-05
Epoch: 3 cost time: 0.7289667129516602
Epoch: 3, Steps: 123 | Train Loss: 0.8399822 Vali Loss: 0.6113709 Best vali loss: 0.6095167

best validation loss 0.609516736590603

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043855161003, 'e_layers': 1, 'learning_rate': 0.0004419160196, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6331313
	speed: 0.0100s/iter; left time: 8.8356s
Updating learning rate to 0.0004419160196
Validation loss decreased (inf --> 0.6134).  Saving model state dict ...
Epoch: 1 cost time: 0.7927393913269043
Epoch: 1, Steps: 123 | Train Loss: 0.6331313 Vali Loss: 0.6134290 Best vali loss: 0.6134290
	iters: 100, epoch: 2 | loss: 0.8105875
	speed: 0.0065s/iter; left time: 4.9524s
Updating learning rate to 0.0002209580098
Validation loss decreased (0.6134 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 0.4837982654571533
Epoch: 2, Steps: 123 | Train Loss: 0.8105875 Vali Loss: 0.6006777 Best vali loss: 0.6006777
	iters: 100, epoch: 3 | loss: 0.6056832
	speed: 0.0066s/iter; left time: 4.2431s
Updating learning rate to 0.0001104790049
Epoch: 3 cost time: 0.5025181770324707
Epoch: 3, Steps: 123 | Train Loss: 0.6056832 Vali Loss: 0.6260123 Best vali loss: 0.6006777

best validation loss 0.6006777008503248

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043855161003, 'e_layers': 1, 'learning_rate': 0.0004419160196, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5989489
	speed: 0.0103s/iter; left time: 5.3040s
Updating learning rate to 5.523950245e-05
Epoch: 4 cost time: 0.8095853328704834
Epoch: 4, Steps: 123 | Train Loss: 0.5989489 Vali Loss: 0.6255242 Best vali loss: 0.6006777
	iters: 100, epoch: 5 | loss: 0.7858064
	speed: 0.0065s/iter; left time: 2.5728s
Updating learning rate to 2.7619751225e-05
Epoch: 5 cost time: 0.4997286796569824
Epoch: 5, Steps: 123 | Train Loss: 0.7858064 Vali Loss: 0.6230867 Best vali loss: 0.6006777
	iters: 100, epoch: 6 | loss: 0.5682538
	speed: 0.0069s/iter; left time: 1.8563s
Updating learning rate to 1.38098756125e-05
Epoch: 6 cost time: 0.5328140258789062
Epoch: 6, Steps: 123 | Train Loss: 0.5682538 Vali Loss: 0.6333826 Best vali loss: 0.6006777
	iters: 100, epoch: 7 | loss: 0.6343450
	speed: 0.0066s/iter; left time: 0.9682s
Updating learning rate to 6.90493780625e-06
Epoch: 7 cost time: 0.49849677085876465
Epoch: 7, Steps: 123 | Train Loss: 0.6343450 Vali Loss: 0.6354821 Best vali loss: 0.6006777
	iters: 100, epoch: 8 | loss: 0.7781420
	speed: 0.0064s/iter; left time: 0.1530s
Updating learning rate to 3.452468903125e-06
Epoch: 8 cost time: 0.4720773696899414
Epoch: 8, Steps: 123 | Train Loss: 0.7781420 Vali Loss: 0.6334895 Best vali loss: 0.6006777

best validation loss 0.6006777008503248

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043850504464, 'e_layers': 1, 'learning_rate': 0.0004455230344, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6332855
	speed: 0.0097s/iter; left time: 8.5470s
Updating learning rate to 0.0004455230344
Validation loss decreased (inf --> 0.6133).  Saving model state dict ...
Epoch: 1 cost time: 0.7717361450195312
Epoch: 1, Steps: 123 | Train Loss: 0.6332855 Vali Loss: 0.6133452 Best vali loss: 0.6133452
	iters: 100, epoch: 2 | loss: 0.8116770
	speed: 0.0068s/iter; left time: 5.1744s
Updating learning rate to 0.0002227615172
Validation loss decreased (0.6133 --> 0.6010).  Saving model state dict ...
Epoch: 2 cost time: 0.5162265300750732
Epoch: 2, Steps: 123 | Train Loss: 0.8116770 Vali Loss: 0.6010177 Best vali loss: 0.6010177
	iters: 100, epoch: 3 | loss: 0.6055675
	speed: 0.0066s/iter; left time: 4.1999s
Updating learning rate to 0.0001113807586
Epoch: 3 cost time: 0.4912247657775879
Epoch: 3, Steps: 123 | Train Loss: 0.6055675 Vali Loss: 0.6266124 Best vali loss: 0.6010177
	iters: 100, epoch: 4 | loss: 0.6748325
	speed: 0.0069s/iter; left time: 3.5839s
Updating learning rate to 5.56903793e-05
Epoch: 4 cost time: 0.5237510204315186
Epoch: 4, Steps: 123 | Train Loss: 0.6748325 Vali Loss: 0.6172894 Best vali loss: 0.6010177
	iters: 100, epoch: 5 | loss: 0.7880067
	speed: 0.0066s/iter; left time: 2.5875s
Updating learning rate to 2.784518965e-05
Epoch: 5 cost time: 0.5015406608581543
Epoch: 5, Steps: 123 | Train Loss: 0.7880067 Vali Loss: 0.6383925 Best vali loss: 0.6010177
	iters: 100, epoch: 6 | loss: 0.6215678
	speed: 0.0063s/iter; left time: 1.7024s
Updating learning rate to 1.3922594825e-05
Epoch: 6 cost time: 0.48161911964416504
Epoch: 6, Steps: 123 | Train Loss: 0.6215678 Vali Loss: 0.6325494 Best vali loss: 0.6010177
	iters: 100, epoch: 7 | loss: 0.5764419
	speed: 0.0064s/iter; left time: 0.9385s
Updating learning rate to 6.9612974125e-06
Epoch: 7 cost time: 0.4853358268737793
Epoch: 7, Steps: 123 | Train Loss: 0.5764419 Vali Loss: 0.6393725 Best vali loss: 0.6010177
	iters: 100, epoch: 8 | loss: 0.8420784
	speed: 0.0067s/iter; left time: 0.1601s
Updating learning rate to 3.48064870625e-06
Epoch: 8 cost time: 0.5086972713470459
Epoch: 8, Steps: 123 | Train Loss: 0.8420784 Vali Loss: 0.6391932 Best vali loss: 0.6010177

best validation loss 0.6010176626028478

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028883345736, 'e_layers': 4, 'learning_rate': 0.0002156476499, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8118154
	speed: 0.0152s/iter; left time: 13.4351s
Updating learning rate to 0.0002156476499
Validation loss decreased (inf --> 0.6122).  Saving model state dict ...
Epoch: 1 cost time: 1.458803415298462
Epoch: 1, Steps: 123 | Train Loss: 0.8118154 Vali Loss: 0.6122167 Best vali loss: 0.6122167
	iters: 100, epoch: 2 | loss: 0.9798821
	speed: 0.0141s/iter; left time: 10.7490s
Updating learning rate to 0.00010782382495
Validation loss decreased (0.6122 --> 0.5935).  Saving model state dict ...
Epoch: 2 cost time: 1.1580255031585693
Epoch: 2, Steps: 123 | Train Loss: 0.9798821 Vali Loss: 0.5935419 Best vali loss: 0.5935419
	iters: 100, epoch: 3 | loss: 0.5829260
	speed: 0.0143s/iter; left time: 9.1438s
Updating learning rate to 5.3911912475e-05
Validation loss decreased (0.5935 --> 0.5453).  Saving model state dict ...
Epoch: 3 cost time: 1.1572096347808838
Epoch: 3, Steps: 123 | Train Loss: 0.5829260 Vali Loss: 0.5453087 Best vali loss: 0.5453087
	iters: 100, epoch: 4 | loss: 0.8208795
	speed: 0.0144s/iter; left time: 7.4453s
Updating learning rate to 2.69559562375e-05
Epoch: 4 cost time: 1.1666126251220703
Epoch: 4, Steps: 123 | Train Loss: 0.8208795 Vali Loss: 0.5484622 Best vali loss: 0.5453087
	iters: 100, epoch: 5 | loss: 0.7180961
	speed: 0.0138s/iter; left time: 5.4253s
Updating learning rate to 1.347797811875e-05
Validation loss decreased (0.5453 --> 0.5442).  Saving model state dict ...
Epoch: 5 cost time: 1.1627130508422852
Epoch: 5, Steps: 123 | Train Loss: 0.7180961 Vali Loss: 0.5441892 Best vali loss: 0.5441892
	iters: 100, epoch: 6 | loss: 0.6180485
	speed: 0.0143s/iter; left time: 3.8665s
Updating learning rate to 6.738989059375e-06
Validation loss decreased (0.5442 --> 0.5419).  Saving model state dict ...
Epoch: 6 cost time: 1.1556503772735596
Epoch: 6, Steps: 123 | Train Loss: 0.6180485 Vali Loss: 0.5419164 Best vali loss: 0.5419164
	iters: 100, epoch: 7 | loss: 0.8899058
	speed: 0.0143s/iter; left time: 2.1062s
Updating learning rate to 3.3694945296875e-06
Validation loss decreased (0.5419 --> 0.5395).  Saving model state dict ...
Epoch: 7 cost time: 1.1616668701171875
Epoch: 7, Steps: 123 | Train Loss: 0.8899058 Vali Loss: 0.5395375 Best vali loss: 0.5395375
	iters: 100, epoch: 8 | loss: 0.7510802
	speed: 0.0144s/iter; left time: 0.3455s
Updating learning rate to 1.68474726484375e-06
Validation loss decreased (0.5395 --> 0.5395).  Saving model state dict ...
Epoch: 8 cost time: 1.1599676609039307
Epoch: 8, Steps: 123 | Train Loss: 0.7510802 Vali Loss: 0.5394580 Best vali loss: 0.5394580

best validation loss 0.5394580079719238

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0017146790138, 'e_layers': 2, 'learning_rate': 0.0015830890976, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3010674
	speed: 0.0094s/iter; left time: 73.0028s
	iters: 200, epoch: 1 | loss: 0.9995117
	speed: 0.0033s/iter; left time: 25.4457s
	iters: 300, epoch: 1 | loss: 0.8654359
	speed: 0.0034s/iter; left time: 25.5174s
	iters: 400, epoch: 1 | loss: 0.5230394
	speed: 0.0034s/iter; left time: 25.1716s
	iters: 500, epoch: 1 | loss: 0.7796702
	speed: 0.0035s/iter; left time: 25.3906s
	iters: 600, epoch: 1 | loss: 0.5577020
	speed: 0.0035s/iter; left time: 25.5484s
	iters: 700, epoch: 1 | loss: 0.8615670
	speed: 0.0035s/iter; left time: 25.0102s
	iters: 800, epoch: 1 | loss: 0.9636018
	speed: 0.0035s/iter; left time: 24.3328s
	iters: 900, epoch: 1 | loss: 1.3045310
	speed: 0.0033s/iter; left time: 22.9608s
Updating learning rate to 0.0015830890976
Validation loss decreased (inf --> 0.6379).  Saving model state dict ...
Epoch: 1 cost time: 3.6789872646331787
Epoch: 1, Steps: 979 | Train Loss: 0.9062363 Vali Loss: 0.6379432 Best vali loss: 0.6379432
	iters: 100, epoch: 2 | loss: 0.3977849
	speed: 0.0113s/iter; left time: 76.6381s
	iters: 200, epoch: 2 | loss: 1.2433391
	speed: 0.0030s/iter; left time: 20.2699s
	iters: 300, epoch: 2 | loss: 1.4718602
	speed: 0.0030s/iter; left time: 19.7366s
	iters: 400, epoch: 2 | loss: 1.2026672
	speed: 0.0030s/iter; left time: 19.6038s
	iters: 500, epoch: 2 | loss: 1.1089547
	speed: 0.0031s/iter; left time: 19.5245s
	iters: 600, epoch: 2 | loss: 0.2743527
	speed: 0.0031s/iter; left time: 19.2463s
	iters: 700, epoch: 2 | loss: 0.3854803
	speed: 0.0031s/iter; left time: 18.8028s
	iters: 800, epoch: 2 | loss: 1.1437200
	speed: 0.0031s/iter; left time: 19.0105s
	iters: 900, epoch: 2 | loss: 0.5940139
	speed: 0.0030s/iter; left time: 17.9316s
Updating learning rate to 0.0007915445488
Epoch: 2 cost time: 3.047948122024536
Epoch: 2, Steps: 979 | Train Loss: 0.8691303 Vali Loss: 0.6477927 Best vali loss: 0.6379432
	iters: 100, epoch: 3 | loss: 0.6687580
	speed: 0.0105s/iter; left time: 60.9069s
	iters: 200, epoch: 3 | loss: 0.8577263
	speed: 0.0031s/iter; left time: 17.8370s
	iters: 300, epoch: 3 | loss: 1.1447309
	speed: 0.0032s/iter; left time: 17.6576s
	iters: 400, epoch: 3 | loss: 0.9392381
	speed: 0.0030s/iter; left time: 16.4857s
	iters: 500, epoch: 3 | loss: 0.7940277
	speed: 0.0030s/iter; left time: 16.0552s
	iters: 600, epoch: 3 | loss: 0.6722679
	speed: 0.0031s/iter; left time: 16.2807s
	iters: 700, epoch: 3 | loss: 1.2923520
	speed: 0.0029s/iter; left time: 15.0311s
	iters: 800, epoch: 3 | loss: 0.4563513
	speed: 0.0029s/iter; left time: 14.8459s
	iters: 900, epoch: 3 | loss: 0.5091619
	speed: 0.0030s/iter; left time: 14.9007s
Updating learning rate to 0.0003957722744
Epoch: 3 cost time: 3.0282609462738037
Epoch: 3, Steps: 979 | Train Loss: 0.8149571 Vali Loss: 0.6549025 Best vali loss: 0.6379432

best validation loss 0.6379432397713986

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0053177973672, 'e_layers': 2, 'learning_rate': 8.02816041e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.02816041e-05
Validation loss decreased (inf --> 0.6680).  Saving model state dict ...
Epoch: 1 cost time: 0.7030515670776367
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6679745 Best vali loss: 0.6679745
Updating learning rate to 4.014080205e-05
Validation loss decreased (0.6680 --> 0.6375).  Saving model state dict ...
Epoch: 2 cost time: 0.4616730213165283
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6374971 Best vali loss: 0.6374971
Updating learning rate to 2.0070401025e-05
Validation loss decreased (0.6375 --> 0.6267).  Saving model state dict ...
Epoch: 3 cost time: 0.4260237216949463
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6267297 Best vali loss: 0.6267297

best validation loss 0.6267296553816524

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0114711109081, 'e_layers': 4, 'learning_rate': 0.0001504124176, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0884850
	speed: 0.0115s/iter; left time: 43.7619s
	iters: 200, epoch: 1 | loss: 0.7209869
	speed: 0.0053s/iter; left time: 19.6963s
	iters: 300, epoch: 1 | loss: 1.0268912
	speed: 0.0054s/iter; left time: 19.4022s
	iters: 400, epoch: 1 | loss: 0.6890706
	speed: 0.0054s/iter; left time: 19.1015s
Updating learning rate to 0.00014468768582809023
Validation loss decreased (inf --> 0.6109).  Saving model state dict ...
Epoch: 1 cost time: 2.983444929122925
Epoch: 1, Steps: 490 | Train Loss: 0.8813584 Vali Loss: 0.6108807 Best vali loss: 0.6108807
	iters: 100, epoch: 2 | loss: 0.9296914
	speed: 0.0145s/iter; left time: 48.1916s
	iters: 200, epoch: 2 | loss: 0.9196622
	speed: 0.0049s/iter; left time: 15.7756s
	iters: 300, epoch: 2 | loss: 1.1337935
	speed: 0.0048s/iter; left time: 15.0894s
	iters: 400, epoch: 2 | loss: 0.9520599
	speed: 0.0048s/iter; left time: 14.6350s
Updating learning rate to 0.00012838502902981142
Validation loss decreased (0.6109 --> 0.6077).  Saving model state dict ...
Epoch: 2 cost time: 2.489064931869507
Epoch: 2, Steps: 490 | Train Loss: 0.9838018 Vali Loss: 0.6077469 Best vali loss: 0.6077469
	iters: 100, epoch: 3 | loss: 0.8883621
	speed: 0.0141s/iter; left time: 40.0211s
	iters: 200, epoch: 3 | loss: 0.6346399
	speed: 0.0054s/iter; left time: 14.8993s
	iters: 300, epoch: 3 | loss: 0.6926453
	speed: 0.0054s/iter; left time: 14.2424s
	iters: 400, epoch: 3 | loss: 0.3692188
	speed: 0.0052s/iter; left time: 13.1551s
Updating learning rate to 0.00010398637891874964
Validation loss decreased (0.6077 --> 0.5849).  Saving model state dict ...
Epoch: 3 cost time: 2.6644399166107178
Epoch: 3, Steps: 490 | Train Loss: 0.6462165 Vali Loss: 0.5849349 Best vali loss: 0.5849349

best validation loss 0.5849348970278166

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0114711109081, 'e_layers': 4, 'learning_rate': 0.0001504124176, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0593286
	speed: 0.0115s/iter; left time: 27.0638s
	iters: 200, epoch: 4 | loss: 0.4311260
	speed: 0.0055s/iter; left time: 12.3662s
	iters: 300, epoch: 4 | loss: 0.9303976
	speed: 0.0054s/iter; left time: 11.6150s
	iters: 400, epoch: 4 | loss: 0.4220647
	speed: 0.0052s/iter; left time: 10.7256s
Updating learning rate to 7.52062088e-05
Validation loss decreased (0.5849 --> 0.5847).  Saving model state dict ...
Epoch: 4 cost time: 2.97678542137146
Epoch: 4, Steps: 490 | Train Loss: 0.7107292 Vali Loss: 0.5847149 Best vali loss: 0.5847149
	iters: 100, epoch: 5 | loss: 0.8460124
	speed: 0.0139s/iter; left time: 25.9495s
	iters: 200, epoch: 5 | loss: 0.8882088
	speed: 0.0051s/iter; left time: 8.8957s
	iters: 300, epoch: 5 | loss: 0.8176023
	speed: 0.0051s/iter; left time: 8.4265s
	iters: 400, epoch: 5 | loss: 0.9468274
	speed: 0.0050s/iter; left time: 7.8789s
Updating learning rate to 4.642603868125039e-05
Validation loss decreased (0.5847 --> 0.5804).  Saving model state dict ...
Epoch: 5 cost time: 2.5001370906829834
Epoch: 5, Steps: 490 | Train Loss: 0.8746627 Vali Loss: 0.5803825 Best vali loss: 0.5803825
	iters: 100, epoch: 6 | loss: 0.8384263
	speed: 0.0137s/iter; left time: 18.7865s
	iters: 200, epoch: 6 | loss: 0.6093984
	speed: 0.0050s/iter; left time: 6.4161s
	iters: 300, epoch: 6 | loss: 0.6641548
	speed: 0.0051s/iter; left time: 5.9969s
	iters: 400, epoch: 6 | loss: 0.3432348
	speed: 0.0052s/iter; left time: 5.5428s
Updating learning rate to 2.2027388570188603e-05
Validation loss decreased (0.5804 --> 0.5789).  Saving model state dict ...
Epoch: 6 cost time: 2.563652515411377
Epoch: 6, Steps: 490 | Train Loss: 0.6138036 Vali Loss: 0.5788692 Best vali loss: 0.5788692
	iters: 100, epoch: 7 | loss: 0.5695925
	speed: 0.0140s/iter; left time: 12.3422s
	iters: 200, epoch: 7 | loss: 0.8813288
	speed: 0.0052s/iter; left time: 4.0727s
	iters: 300, epoch: 7 | loss: 0.9304888
	speed: 0.0052s/iter; left time: 3.5375s
	iters: 400, epoch: 7 | loss: 0.8843833
	speed: 0.0052s/iter; left time: 3.0294s
Updating learning rate to 5.724731771909782e-06
Validation loss decreased (0.5789 --> 0.5737).  Saving model state dict ...
Epoch: 7 cost time: 2.586575508117676
Epoch: 7, Steps: 490 | Train Loss: 0.8164483 Vali Loss: 0.5736779 Best vali loss: 0.5736779
	iters: 100, epoch: 8 | loss: 0.5628991
	speed: 0.0139s/iter; left time: 5.4538s
	iters: 200, epoch: 8 | loss: 0.3687375
	speed: 0.0049s/iter; left time: 1.4192s
	iters: 300, epoch: 8 | loss: 0.4397326
	speed: 0.0049s/iter; left time: 0.9274s
	iters: 400, epoch: 8 | loss: 0.3539022
	speed: 0.0049s/iter; left time: 0.4468s
Updating learning rate to 0.0
Validation loss decreased (0.5737 --> 0.5720).  Saving model state dict ...
Epoch: 8 cost time: 2.480576992034912
Epoch: 8, Steps: 490 | Train Loss: 0.4313178 Vali Loss: 0.5719557 Best vali loss: 0.5719557

best validation loss 0.5719556986513319

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010526845331, 'e_layers': 2, 'learning_rate': 0.0001759287566, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7961706
	speed: 0.0114s/iter; left time: 10.1264s
Updating learning rate to 0.00016923286700144997
Validation loss decreased (inf --> 0.5942).  Saving model state dict ...
Epoch: 1 cost time: 0.9805169105529785
Epoch: 1, Steps: 123 | Train Loss: 0.7961706 Vali Loss: 0.5941733 Best vali loss: 0.5941733
	iters: 100, epoch: 2 | loss: 0.9359873
	speed: 0.0085s/iter; left time: 6.5144s
Updating learning rate to 0.00015016458669878878
Validation loss decreased (0.5942 --> 0.5743).  Saving model state dict ...
Epoch: 2 cost time: 0.6632027626037598
Epoch: 2, Steps: 123 | Train Loss: 0.9359873 Vali Loss: 0.5742720 Best vali loss: 0.5742720
	iters: 100, epoch: 3 | loss: 0.7344832
	speed: 0.0087s/iter; left time: 5.5678s
Updating learning rate to 0.00012162688851370521
Validation loss decreased (0.5743 --> 0.5523).  Saving model state dict ...
Epoch: 3 cost time: 0.6764721870422363
Epoch: 3, Steps: 123 | Train Loss: 0.7344832 Vali Loss: 0.5523264 Best vali loss: 0.5523264
	iters: 100, epoch: 4 | loss: 0.6395759
	speed: 0.0087s/iter; left time: 4.4638s
Updating learning rate to 8.79643783e-05
Validation loss decreased (0.5523 --> 0.5497).  Saving model state dict ...
Epoch: 4 cost time: 0.6602156162261963
Epoch: 4, Steps: 123 | Train Loss: 0.6395759 Vali Loss: 0.5497081 Best vali loss: 0.5497081
	iters: 100, epoch: 5 | loss: 0.7096373
	speed: 0.0087s/iter; left time: 3.4002s
Updating learning rate to 5.430186808629478e-05
Validation loss decreased (0.5497 --> 0.5359).  Saving model state dict ...
Epoch: 5 cost time: 0.668248176574707
Epoch: 5, Steps: 123 | Train Loss: 0.7096373 Vali Loss: 0.5359098 Best vali loss: 0.5359098
	iters: 100, epoch: 6 | loss: 0.8788576
	speed: 0.0086s/iter; left time: 2.3350s
Updating learning rate to 2.5764169901211216e-05
Epoch: 6 cost time: 0.6639442443847656
Epoch: 6, Steps: 123 | Train Loss: 0.8788576 Vali Loss: 0.5363804 Best vali loss: 0.5359098
	iters: 100, epoch: 7 | loss: 0.5913405
	speed: 0.0085s/iter; left time: 1.2501s
Updating learning rate to 6.695889598550024e-06
Validation loss decreased (0.5359 --> 0.5297).  Saving model state dict ...
Epoch: 7 cost time: 0.6671144962310791
Epoch: 7, Steps: 123 | Train Loss: 0.5913405 Vali Loss: 0.5297055 Best vali loss: 0.5297055
	iters: 100, epoch: 8 | loss: 0.6537780
	speed: 0.0087s/iter; left time: 0.2088s
Updating learning rate to 0.0
Validation loss decreased (0.5297 --> 0.5285).  Saving model state dict ...
Epoch: 8 cost time: 0.6648087501525879
Epoch: 8, Steps: 123 | Train Loss: 0.6537780 Vali Loss: 0.5284548 Best vali loss: 0.5284548

best validation loss 0.5284547720833654

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0015728198865, 'e_layers': 2, 'learning_rate': 0.0004972668537, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9162199
	speed: 0.0103s/iter; left time: 19.2361s
	iters: 200, epoch: 1 | loss: 0.5612895
	speed: 0.0039s/iter; left time: 6.8643s
Updating learning rate to 0.0004972668537
Validation loss decreased (inf --> 0.5855).  Saving model state dict ...
Epoch: 1 cost time: 1.324329137802124
Epoch: 1, Steps: 245 | Train Loss: 0.7387547 Vali Loss: 0.5855383 Best vali loss: 0.5855383
	iters: 100, epoch: 2 | loss: 0.6878653
	speed: 0.0081s/iter; left time: 13.1470s
	iters: 200, epoch: 2 | loss: 0.8286745
	speed: 0.0038s/iter; left time: 5.7144s
Updating learning rate to 0.00024863342685
Validation loss decreased (0.5855 --> 0.5667).  Saving model state dict ...
Epoch: 2 cost time: 0.9845230579376221
Epoch: 2, Steps: 245 | Train Loss: 0.7582699 Vali Loss: 0.5666754 Best vali loss: 0.5666754
	iters: 100, epoch: 3 | loss: 0.5773506
	speed: 0.0082s/iter; left time: 11.2856s
	iters: 200, epoch: 3 | loss: 0.9985017
	speed: 0.0034s/iter; left time: 4.3786s
Updating learning rate to 0.000124316713425
Validation loss decreased (0.5667 --> 0.5514).  Saving model state dict ...
Epoch: 3 cost time: 0.9104268550872803
Epoch: 3, Steps: 245 | Train Loss: 0.7879262 Vali Loss: 0.5514341 Best vali loss: 0.5514341
	iters: 100, epoch: 4 | loss: 0.8613653
	speed: 0.0076s/iter; left time: 8.5357s
	iters: 200, epoch: 4 | loss: 0.6373016
	speed: 0.0037s/iter; left time: 3.8269s
Updating learning rate to 6.21583567125e-05
Validation loss decreased (0.5514 --> 0.5473).  Saving model state dict ...
Epoch: 4 cost time: 0.9432883262634277
Epoch: 4, Steps: 245 | Train Loss: 0.7493334 Vali Loss: 0.5472842 Best vali loss: 0.5472842
	iters: 100, epoch: 5 | loss: 0.5763562
	speed: 0.0084s/iter; left time: 7.3970s
	iters: 200, epoch: 5 | loss: 0.7781544
	speed: 0.0040s/iter; left time: 3.0951s
Updating learning rate to 3.107917835625e-05
Epoch: 5 cost time: 1.0368549823760986
Epoch: 5, Steps: 245 | Train Loss: 0.6772553 Vali Loss: 0.5515191 Best vali loss: 0.5472842
	iters: 100, epoch: 6 | loss: 1.0284483
	speed: 0.0077s/iter; left time: 4.9132s
	iters: 200, epoch: 6 | loss: 0.8616434
	speed: 0.0036s/iter; left time: 1.9479s
Updating learning rate to 1.5539589178125e-05
Validation loss decreased (0.5473 --> 0.5470).  Saving model state dict ...
Epoch: 6 cost time: 0.9226329326629639
Epoch: 6, Steps: 245 | Train Loss: 0.9450459 Vali Loss: 0.5469855 Best vali loss: 0.5469855
	iters: 100, epoch: 7 | loss: 0.7709978
	speed: 0.0076s/iter; left time: 2.9709s
	iters: 200, epoch: 7 | loss: 0.6844585
	speed: 0.0036s/iter; left time: 1.0476s
Updating learning rate to 7.7697945890625e-06
Validation loss decreased (0.5470 --> 0.5437).  Saving model state dict ...
Epoch: 7 cost time: 0.928776741027832
Epoch: 7, Steps: 245 | Train Loss: 0.7277281 Vali Loss: 0.5437210 Best vali loss: 0.5437210
	iters: 100, epoch: 8 | loss: 0.8660176
	speed: 0.0078s/iter; left time: 1.1388s
	iters: 200, epoch: 8 | loss: 0.6043816
	speed: 0.0036s/iter; left time: 0.1672s
Updating learning rate to 3.88489729453125e-06
Validation loss decreased (0.5437 --> 0.5437).  Saving model state dict ...
Epoch: 8 cost time: 0.9315063953399658
Epoch: 8, Steps: 245 | Train Loss: 0.7351996 Vali Loss: 0.5436862 Best vali loss: 0.5436862

best validation loss 0.5436861656264871

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0017420826936, 'e_layers': 2, 'learning_rate': 0.0004952364162, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9157866
	speed: 0.0099s/iter; left time: 18.3653s
	iters: 200, epoch: 1 | loss: 0.5627456
	speed: 0.0036s/iter; left time: 6.3458s
Updating learning rate to 0.0004952364162
Validation loss decreased (inf --> 0.6158).  Saving model state dict ...
Epoch: 1 cost time: 1.230487585067749
Epoch: 1, Steps: 245 | Train Loss: 0.7392661 Vali Loss: 0.6158016 Best vali loss: 0.6158016
	iters: 100, epoch: 2 | loss: 0.6883574
	speed: 0.0075s/iter; left time: 12.1337s
	iters: 200, epoch: 2 | loss: 0.8281679
	speed: 0.0036s/iter; left time: 5.4032s
Updating learning rate to 0.0002476182081
Validation loss decreased (0.6158 --> 0.5456).  Saving model state dict ...
Epoch: 2 cost time: 0.9143757820129395
Epoch: 2, Steps: 245 | Train Loss: 0.7582626 Vali Loss: 0.5455501 Best vali loss: 0.5455501
	iters: 100, epoch: 3 | loss: 0.5845546
	speed: 0.0082s/iter; left time: 11.3054s
	iters: 200, epoch: 3 | loss: 0.9631809
	speed: 0.0041s/iter; left time: 5.2304s
Updating learning rate to 0.00012380910405
Epoch: 3 cost time: 1.049607753753662
Epoch: 3, Steps: 245 | Train Loss: 0.7738677 Vali Loss: 0.5564948 Best vali loss: 0.5455501

best validation loss 0.5455500540607564

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0050697720421, 'e_layers': 2, 'learning_rate': 0.0005036443132, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9177073
	speed: 0.0101s/iter; left time: 18.7461s
	iters: 200, epoch: 1 | loss: 0.5611848
	speed: 0.0039s/iter; left time: 6.9126s
Updating learning rate to 0.0005036443132
Validation loss decreased (inf --> 0.5992).  Saving model state dict ...
Epoch: 1 cost time: 1.3011634349822998
Epoch: 1, Steps: 245 | Train Loss: 0.7394460 Vali Loss: 0.5992400 Best vali loss: 0.5992400
	iters: 100, epoch: 2 | loss: 0.8265188
	speed: 0.0079s/iter; left time: 12.8065s
	iters: 200, epoch: 2 | loss: 0.8386300
	speed: 0.0038s/iter; left time: 5.7640s
Updating learning rate to 0.0002518221566
Validation loss decreased (0.5992 --> 0.5642).  Saving model state dict ...
Epoch: 2 cost time: 0.9642577171325684
Epoch: 2, Steps: 245 | Train Loss: 0.8325744 Vali Loss: 0.5642105 Best vali loss: 0.5642105
	iters: 100, epoch: 3 | loss: 0.5864754
	speed: 0.0081s/iter; left time: 11.1517s
	iters: 200, epoch: 3 | loss: 1.0396774
	speed: 0.0037s/iter; left time: 4.6841s
Updating learning rate to 0.0001259110783
Validation loss decreased (0.5642 --> 0.5385).  Saving model state dict ...
Epoch: 3 cost time: 0.9682588577270508
Epoch: 3, Steps: 245 | Train Loss: 0.8130764 Vali Loss: 0.5384721 Best vali loss: 0.5384721

best validation loss 0.5384721319082985

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025275330624, 'e_layers': 4, 'learning_rate': 0.0021864708311, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2891330
	speed: 0.0111s/iter; left time: 42.3396s
	iters: 200, epoch: 1 | loss: 0.7441279
	speed: 0.0050s/iter; left time: 18.5407s
	iters: 300, epoch: 1 | loss: 0.4942274
	speed: 0.0051s/iter; left time: 18.3828s
	iters: 400, epoch: 1 | loss: 0.4891670
	speed: 0.0050s/iter; left time: 17.5188s
Updating learning rate to 0.002103253240193116
Validation loss decreased (inf --> 0.6166).  Saving model state dict ...
Epoch: 1 cost time: 2.789909839630127
Epoch: 1, Steps: 490 | Train Loss: 0.5041638 Vali Loss: 0.6165733 Best vali loss: 0.6165733
	iters: 100, epoch: 2 | loss: 0.7058856
	speed: 0.0134s/iter; left time: 44.4954s
	iters: 200, epoch: 2 | loss: 1.0635451
	speed: 0.0048s/iter; left time: 15.5743s
	iters: 300, epoch: 2 | loss: 1.1182688
	speed: 0.0049s/iter; left time: 15.4541s
	iters: 400, epoch: 2 | loss: 0.9723215
	speed: 0.0048s/iter; left time: 14.6020s
Updating learning rate to 0.001866269591318698
Epoch: 2 cost time: 2.454437494277954
Epoch: 2, Steps: 490 | Train Loss: 0.9650053 Vali Loss: 0.6228616 Best vali loss: 0.6165733
	iters: 100, epoch: 3 | loss: 0.6801030
	speed: 0.0134s/iter; left time: 38.0134s
	iters: 200, epoch: 3 | loss: 0.9085308
	speed: 0.0049s/iter; left time: 13.5219s
	iters: 300, epoch: 3 | loss: 0.7282240
	speed: 0.0045s/iter; left time: 11.8122s
	iters: 400, epoch: 3 | loss: 0.4389315
	speed: 0.0046s/iter; left time: 11.6520s
Updating learning rate to 0.0015115984967557492
Validation loss decreased (0.6166 --> 0.6080).  Saving model state dict ...
Epoch: 3 cost time: 2.37741756439209
Epoch: 3, Steps: 490 | Train Loss: 0.6889473 Vali Loss: 0.6080027 Best vali loss: 0.6080027

best validation loss 0.6080026685060698

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0050697720421, 'e_layers': 2, 'learning_rate': 0.0005036443132, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7025861
	speed: 0.0104s/iter; left time: 11.7240s
	iters: 200, epoch: 4 | loss: 0.5063546
	speed: 0.0040s/iter; left time: 4.0606s
Updating learning rate to 6.295553915e-05
Epoch: 4 cost time: 1.3252594470977783
Epoch: 4, Steps: 245 | Train Loss: 0.6044703 Vali Loss: 0.5476351 Best vali loss: 0.5384721
	iters: 100, epoch: 5 | loss: 0.6116126
	speed: 0.0079s/iter; left time: 6.9867s
	iters: 200, epoch: 5 | loss: 0.7571183
	speed: 0.0036s/iter; left time: 2.8004s
Updating learning rate to 3.1477769575e-05
Epoch: 5 cost time: 0.9364380836486816
Epoch: 5, Steps: 245 | Train Loss: 0.6843655 Vali Loss: 0.5441381 Best vali loss: 0.5384721
	iters: 100, epoch: 6 | loss: 0.5646108
	speed: 0.0082s/iter; left time: 5.2331s
	iters: 200, epoch: 6 | loss: 0.9566331
	speed: 0.0040s/iter; left time: 2.1596s
Updating learning rate to 1.57388847875e-05
Epoch: 6 cost time: 1.0247464179992676
Epoch: 6, Steps: 245 | Train Loss: 0.7606219 Vali Loss: 0.5406675 Best vali loss: 0.5384721
	iters: 100, epoch: 7 | loss: 0.7931911
	speed: 0.0080s/iter; left time: 3.1208s
	iters: 200, epoch: 7 | loss: 0.6325613
	speed: 0.0037s/iter; left time: 1.0650s
Updating learning rate to 7.86944239375e-06
Epoch: 7 cost time: 0.9769728183746338
Epoch: 7, Steps: 245 | Train Loss: 0.7128762 Vali Loss: 0.5400121 Best vali loss: 0.5384721
	iters: 100, epoch: 8 | loss: 0.5770989
	speed: 0.0081s/iter; left time: 1.1836s
	iters: 200, epoch: 8 | loss: 0.7534875
	speed: 0.0037s/iter; left time: 0.1721s
Updating learning rate to 3.934721196875e-06
Epoch: 8 cost time: 0.9793601036071777
Epoch: 8, Steps: 245 | Train Loss: 0.6652932 Vali Loss: 0.5405647 Best vali loss: 0.5384721

best validation loss 0.5384721319082985

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0041706419361, 'e_layers': 2, 'learning_rate': 0.0004800207547, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9164813
	speed: 0.0103s/iter; left time: 19.1955s
	iters: 200, epoch: 1 | loss: 0.5617771
	speed: 0.0039s/iter; left time: 6.9046s
Updating learning rate to 0.0004800207547
Validation loss decreased (inf --> 0.5921).  Saving model state dict ...
Epoch: 1 cost time: 1.3080408573150635
Epoch: 1, Steps: 245 | Train Loss: 0.7391292 Vali Loss: 0.5920949 Best vali loss: 0.5920949
	iters: 100, epoch: 2 | loss: 0.7701362
	speed: 0.0081s/iter; left time: 13.0145s
	iters: 200, epoch: 2 | loss: 0.8180601
	speed: 0.0038s/iter; left time: 5.7264s
Updating learning rate to 0.00024001037735
Validation loss decreased (0.5921 --> 0.5561).  Saving model state dict ...
Epoch: 2 cost time: 0.9900708198547363
Epoch: 2, Steps: 245 | Train Loss: 0.7940981 Vali Loss: 0.5561122 Best vali loss: 0.5561122
	iters: 100, epoch: 3 | loss: 0.5803035
	speed: 0.0084s/iter; left time: 11.5015s
	iters: 200, epoch: 3 | loss: 0.9998717
	speed: 0.0040s/iter; left time: 5.0517s
Updating learning rate to 0.000120005188675
Validation loss decreased (0.5561 --> 0.5414).  Saving model state dict ...
Epoch: 3 cost time: 1.0255517959594727
Epoch: 3, Steps: 245 | Train Loss: 0.7900876 Vali Loss: 0.5413957 Best vali loss: 0.5413957
	iters: 100, epoch: 4 | loss: 0.8421130
	speed: 0.0083s/iter; left time: 9.3512s
	iters: 200, epoch: 4 | loss: 0.6314096
	speed: 0.0039s/iter; left time: 3.9889s
Updating learning rate to 6.00025943375e-05
Validation loss decreased (0.5414 --> 0.5404).  Saving model state dict ...
Epoch: 4 cost time: 1.0153696537017822
Epoch: 4, Steps: 245 | Train Loss: 0.7367613 Vali Loss: 0.5403567 Best vali loss: 0.5403567
	iters: 100, epoch: 5 | loss: 0.5728689
	speed: 0.0082s/iter; left time: 7.2341s
	iters: 200, epoch: 5 | loss: 0.7658160
	speed: 0.0040s/iter; left time: 3.0860s
Updating learning rate to 3.000129716875e-05
Validation loss decreased (0.5404 --> 0.5401).  Saving model state dict ...
Epoch: 5 cost time: 1.0105187892913818
Epoch: 5, Steps: 245 | Train Loss: 0.6693425 Vali Loss: 0.5401473 Best vali loss: 0.5401473
	iters: 100, epoch: 6 | loss: 1.0256610
	speed: 0.0081s/iter; left time: 5.1732s
	iters: 200, epoch: 6 | loss: 0.8540663
	speed: 0.0039s/iter; left time: 2.0874s
Updating learning rate to 1.5000648584375e-05
Validation loss decreased (0.5401 --> 0.5353).  Saving model state dict ...
Epoch: 6 cost time: 1.003596544265747
Epoch: 6, Steps: 245 | Train Loss: 0.9398637 Vali Loss: 0.5353344 Best vali loss: 0.5353344
	iters: 100, epoch: 7 | loss: 0.7744156
	speed: 0.0083s/iter; left time: 3.2288s
	iters: 200, epoch: 7 | loss: 0.6888316
	speed: 0.0039s/iter; left time: 1.1210s
Updating learning rate to 7.5003242921875e-06
Epoch: 7 cost time: 0.9997470378875732
Epoch: 7, Steps: 245 | Train Loss: 0.7316236 Vali Loss: 0.5361551 Best vali loss: 0.5353344
	iters: 100, epoch: 8 | loss: 0.8594941
	speed: 0.0080s/iter; left time: 1.1660s
	iters: 200, epoch: 8 | loss: 0.5922129
	speed: 0.0038s/iter; left time: 0.1734s
Updating learning rate to 3.75016214609375e-06
Validation loss decreased (0.5353 --> 0.5341).  Saving model state dict ...
Epoch: 8 cost time: 0.9818863868713379
Epoch: 8, Steps: 245 | Train Loss: 0.7258535 Vali Loss: 0.5341248 Best vali loss: 0.5341248

best validation loss 0.5341247619163764

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0092896544297, 'e_layers': 2, 'learning_rate': 5.96213313e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8210405
	speed: 0.0102s/iter; left time: 18.9019s
	iters: 200, epoch: 1 | loss: 0.7017009
	speed: 0.0038s/iter; left time: 6.7579s
Updating learning rate to 5.96213313e-05
Validation loss decreased (inf --> 0.6679).  Saving model state dict ...
Epoch: 1 cost time: 1.2932004928588867
Epoch: 1, Steps: 245 | Train Loss: 0.7613707 Vali Loss: 0.6679411 Best vali loss: 0.6679411
	iters: 100, epoch: 2 | loss: 0.4381815
	speed: 0.0081s/iter; left time: 13.1679s
	iters: 200, epoch: 2 | loss: 0.9357730
	speed: 0.0037s/iter; left time: 5.5624s
Updating learning rate to 2.981066565e-05
Validation loss decreased (0.6679 --> 0.6380).  Saving model state dict ...
Epoch: 2 cost time: 0.9627108573913574
Epoch: 2, Steps: 245 | Train Loss: 0.6869773 Vali Loss: 0.6380213 Best vali loss: 0.6380213
	iters: 100, epoch: 3 | loss: 0.8579077
	speed: 0.0077s/iter; left time: 10.5625s
	iters: 200, epoch: 3 | loss: 0.7783953
	speed: 0.0036s/iter; left time: 4.5724s
Updating learning rate to 1.4905332825e-05
Validation loss decreased (0.6380 --> 0.6270).  Saving model state dict ...
Epoch: 3 cost time: 0.9369945526123047
Epoch: 3, Steps: 245 | Train Loss: 0.8181515 Vali Loss: 0.6270261 Best vali loss: 0.6270261
	iters: 100, epoch: 4 | loss: 0.7463103
	speed: 0.0078s/iter; left time: 8.7272s
	iters: 200, epoch: 4 | loss: 0.8911219
	speed: 0.0037s/iter; left time: 3.7568s
Updating learning rate to 7.4526664125e-06
Validation loss decreased (0.6270 --> 0.6242).  Saving model state dict ...
Epoch: 4 cost time: 0.9417710304260254
Epoch: 4, Steps: 245 | Train Loss: 0.8187161 Vali Loss: 0.6242054 Best vali loss: 0.6242054
	iters: 100, epoch: 5 | loss: 0.8728295
	speed: 0.0080s/iter; left time: 7.0356s
	iters: 200, epoch: 5 | loss: 0.9853491
	speed: 0.0037s/iter; left time: 2.8635s
Updating learning rate to 3.72633320625e-06
Validation loss decreased (0.6242 --> 0.6226).  Saving model state dict ...
Epoch: 5 cost time: 0.9646034240722656
Epoch: 5, Steps: 245 | Train Loss: 0.9290893 Vali Loss: 0.6226343 Best vali loss: 0.6226343
	iters: 100, epoch: 6 | loss: 1.1184930
	speed: 0.0080s/iter; left time: 5.0730s
	iters: 200, epoch: 6 | loss: 0.9822462
	speed: 0.0036s/iter; left time: 1.9154s
Updating learning rate to 1.863166603125e-06
Validation loss decreased (0.6226 --> 0.6220).  Saving model state dict ...
Epoch: 6 cost time: 0.9349579811096191
Epoch: 6, Steps: 245 | Train Loss: 1.0503696 Vali Loss: 0.6219638 Best vali loss: 0.6219638
	iters: 100, epoch: 7 | loss: 0.9147581
	speed: 0.0079s/iter; left time: 3.0771s
	iters: 200, epoch: 7 | loss: 0.7477823
	speed: 0.0038s/iter; left time: 1.1036s
Updating learning rate to 9.315833015625e-07
Validation loss decreased (0.6220 --> 0.6216).  Saving model state dict ...
Epoch: 7 cost time: 0.9758806228637695
Epoch: 7, Steps: 245 | Train Loss: 0.8312702 Vali Loss: 0.6215700 Best vali loss: 0.6215700
	iters: 100, epoch: 8 | loss: 0.8035181
	speed: 0.0078s/iter; left time: 1.1342s
	iters: 200, epoch: 8 | loss: 1.2309537
	speed: 0.0037s/iter; left time: 0.1701s
Updating learning rate to 4.6579165078125e-07
Validation loss decreased (0.6216 --> 0.6214).  Saving model state dict ...
Epoch: 8 cost time: 0.9407021999359131
Epoch: 8, Steps: 245 | Train Loss: 1.0172359 Vali Loss: 0.6213760 Best vali loss: 0.6213760

best validation loss 0.6213760073678133

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488615496, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8157415
	speed: 0.0114s/iter; left time: 10.0717s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.5943).  Saving model state dict ...
Epoch: 1 cost time: 0.9789097309112549
Epoch: 1, Steps: 123 | Train Loss: 0.8157415 Vali Loss: 0.5942895 Best vali loss: 0.5942895
	iters: 100, epoch: 2 | loss: 0.9018309
	speed: 0.0085s/iter; left time: 6.5064s
Updating learning rate to 0.0002540886619071902
Epoch: 2 cost time: 0.6617076396942139
Epoch: 2, Steps: 123 | Train Loss: 0.9018309 Vali Loss: 0.6073383 Best vali loss: 0.5942895
	iters: 100, epoch: 3 | loss: 0.7247926
	speed: 0.0084s/iter; left time: 5.3950s
Updating learning rate to 0.0002058009417118559
Validation loss decreased (0.5943 --> 0.5512).  Saving model state dict ...
Epoch: 3 cost time: 0.6669216156005859
Epoch: 3, Steps: 123 | Train Loss: 0.7247926 Vali Loss: 0.5512306 Best vali loss: 0.5512306

best validation loss 0.5512305765116673

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010881979685, 'e_layers': 2, 'learning_rate': 0.0004709526878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000453028118419799
Validation loss decreased (inf --> 0.5982).  Saving model state dict ...
Epoch: 1 cost time: 0.7487564086914062
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5981980 Best vali loss: 0.5981980
Updating learning rate to 0.00040198326348070553
Validation loss decreased (0.5982 --> 0.5789).  Saving model state dict ...
Epoch: 2 cost time: 0.45468974113464355
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5789464 Best vali loss: 0.5789464
Updating learning rate to 0.0003255892394244343
Validation loss decreased (0.5789 --> 0.5584).  Saving model state dict ...
Epoch: 3 cost time: 0.45264220237731934
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5583619 Best vali loss: 0.5583619

best validation loss 0.5583619275395377

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013839916226, 'e_layers': 2, 'learning_rate': 0.0004666619439, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6336938
	speed: 0.0102s/iter; left time: 18.9442s
	iters: 200, epoch: 1 | loss: 1.0532168
	speed: 0.0040s/iter; left time: 7.0699s
Updating learning rate to 0.00044890068123557014
Validation loss decreased (inf --> 0.5944).  Saving model state dict ...
Epoch: 1 cost time: 1.318765640258789
Epoch: 1, Steps: 245 | Train Loss: 0.8434553 Vali Loss: 0.5943960 Best vali loss: 0.5943960
	iters: 100, epoch: 2 | loss: 1.0887263
	speed: 0.0086s/iter; left time: 13.8558s
	iters: 200, epoch: 2 | loss: 1.0494423
	speed: 0.0038s/iter; left time: 5.7065s
Updating learning rate to 0.0003983208844766931
Validation loss decreased (0.5944 --> 0.5779).  Saving model state dict ...
Epoch: 2 cost time: 1.0006353855133057
Epoch: 2, Steps: 245 | Train Loss: 1.0690843 Vali Loss: 0.5778504 Best vali loss: 0.5778504
	iters: 100, epoch: 3 | loss: 0.6418880
	speed: 0.0080s/iter; left time: 10.9738s
	iters: 200, epoch: 3 | loss: 0.9082322
	speed: 0.0037s/iter; left time: 4.6643s
Updating learning rate to 0.0003226228691729085
Validation loss decreased (0.5779 --> 0.5606).  Saving model state dict ...
Epoch: 3 cost time: 0.951892614364624
Epoch: 3, Steps: 245 | Train Loss: 0.7750601 Vali Loss: 0.5606244 Best vali loss: 0.5606244

best validation loss 0.5606243572181047

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488615496, 'e_layers': 2, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7207989
	speed: 0.0115s/iter; left time: 5.9227s
Updating learning rate to 0.0001488416921
Validation loss decreased (0.5512 --> 0.5485).  Saving model state dict ...
Epoch: 4 cost time: 0.9664807319641113
Epoch: 4, Steps: 123 | Train Loss: 0.7207989 Vali Loss: 0.5484519 Best vali loss: 0.5484519
	iters: 100, epoch: 5 | loss: 0.8036122
	speed: 0.0088s/iter; left time: 3.4546s
Updating learning rate to 9.188244248814415e-05
Validation loss decreased (0.5485 --> 0.5373).  Saving model state dict ...
Epoch: 5 cost time: 0.6657075881958008
Epoch: 5, Steps: 123 | Train Loss: 0.8036122 Vali Loss: 0.5372950 Best vali loss: 0.5372950
	iters: 100, epoch: 6 | loss: 0.6404927
	speed: 0.0087s/iter; left time: 2.3432s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.6677336692810059
Epoch: 6, Steps: 123 | Train Loss: 0.6404927 Vali Loss: 0.5420032 Best vali loss: 0.5372950
	iters: 100, epoch: 7 | loss: 0.5695997
	speed: 0.0085s/iter; left time: 1.2456s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.6745061874389648
Epoch: 7, Steps: 123 | Train Loss: 0.5695997 Vali Loss: 0.5418440 Best vali loss: 0.5372950
	iters: 100, epoch: 8 | loss: 0.6491871
	speed: 0.0085s/iter; left time: 0.2029s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6634407043457031
Epoch: 8, Steps: 123 | Train Loss: 0.6491871 Vali Loss: 0.5442225 Best vali loss: 0.5372950

best validation loss 0.537295034352633

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019183024031, 'e_layers': 3, 'learning_rate': 0.0001618683766, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5031424
	speed: 0.0105s/iter; left time: 81.4756s
	iters: 200, epoch: 1 | loss: 0.7261199
	speed: 0.0043s/iter; left time: 33.0808s
	iters: 300, epoch: 1 | loss: 1.3019216
	speed: 0.0044s/iter; left time: 33.3083s
	iters: 400, epoch: 1 | loss: 0.4893260
	speed: 0.0044s/iter; left time: 32.9046s
	iters: 500, epoch: 1 | loss: 0.7151989
	speed: 0.0044s/iter; left time: 32.3198s
	iters: 600, epoch: 1 | loss: 1.6311877
	speed: 0.0044s/iter; left time: 31.9319s
	iters: 700, epoch: 1 | loss: 0.9067438
	speed: 0.0043s/iter; left time: 30.6080s
	iters: 800, epoch: 1 | loss: 0.5918472
	speed: 0.0040s/iter; left time: 28.3063s
	iters: 900, epoch: 1 | loss: 0.3902558
	speed: 0.0042s/iter; left time: 28.9654s
Updating learning rate to 0.0001618683766
Validation loss decreased (inf --> 0.6184).  Saving model state dict ...
Epoch: 1 cost time: 4.547635793685913
Epoch: 1, Steps: 979 | Train Loss: 0.8061937 Vali Loss: 0.6184060 Best vali loss: 0.6184060
	iters: 100, epoch: 2 | loss: 1.3699436
	speed: 0.0132s/iter; left time: 89.0651s
	iters: 200, epoch: 2 | loss: 1.0382758
	speed: 0.0044s/iter; left time: 29.2578s
	iters: 300, epoch: 2 | loss: 0.9863718
	speed: 0.0044s/iter; left time: 28.5543s
	iters: 400, epoch: 2 | loss: 0.3726290
	speed: 0.0044s/iter; left time: 28.2586s
	iters: 500, epoch: 2 | loss: 0.4443227
	speed: 0.0044s/iter; left time: 27.6852s
	iters: 600, epoch: 2 | loss: 1.0546113
	speed: 0.0045s/iter; left time: 28.3171s
	iters: 700, epoch: 2 | loss: 0.8621580
	speed: 0.0043s/iter; left time: 26.5952s
	iters: 800, epoch: 2 | loss: 1.0029962
	speed: 0.0045s/iter; left time: 27.2914s
	iters: 900, epoch: 2 | loss: 0.4512799
	speed: 0.0045s/iter; left time: 26.6422s
Updating learning rate to 8.09341883e-05
Epoch: 2 cost time: 4.34851598739624
Epoch: 2, Steps: 979 | Train Loss: 0.8425098 Vali Loss: 0.6241150 Best vali loss: 0.6184060
	iters: 100, epoch: 3 | loss: 0.6037914
	speed: 0.0135s/iter; left time: 78.0877s
	iters: 200, epoch: 3 | loss: 0.9302831
	speed: 0.0039s/iter; left time: 22.3545s
	iters: 300, epoch: 3 | loss: 0.2618797
	speed: 0.0040s/iter; left time: 22.1908s
	iters: 400, epoch: 3 | loss: 0.5411981
	speed: 0.0041s/iter; left time: 22.3926s
	iters: 500, epoch: 3 | loss: 0.4733582
	speed: 0.0040s/iter; left time: 21.5433s
	iters: 600, epoch: 3 | loss: 0.3762939
	speed: 0.0039s/iter; left time: 20.5157s
	iters: 700, epoch: 3 | loss: 0.2983366
	speed: 0.0038s/iter; left time: 19.7966s
	iters: 800, epoch: 3 | loss: 0.4369341
	speed: 0.0039s/iter; left time: 19.8387s
	iters: 900, epoch: 3 | loss: 0.3144789
	speed: 0.0039s/iter; left time: 19.3785s
Updating learning rate to 4.046709415e-05
Validation loss decreased (0.6184 --> 0.5464).  Saving model state dict ...
Epoch: 3 cost time: 3.909087896347046
Epoch: 3, Steps: 979 | Train Loss: 0.4707282 Vali Loss: 0.5463577 Best vali loss: 0.5463577
	iters: 100, epoch: 4 | loss: 0.2146248
	speed: 0.0130s/iter; left time: 62.4842s
	iters: 200, epoch: 4 | loss: 0.4332194
	speed: 0.0038s/iter; left time: 17.8514s
	iters: 300, epoch: 4 | loss: 1.4993639
	speed: 0.0038s/iter; left time: 17.6421s
	iters: 400, epoch: 4 | loss: 0.3052683
	speed: 0.0039s/iter; left time: 17.7273s
	iters: 500, epoch: 4 | loss: 0.7881527
	speed: 0.0039s/iter; left time: 17.1690s
	iters: 600, epoch: 4 | loss: 0.8806350
	speed: 0.0040s/iter; left time: 16.9964s
	iters: 700, epoch: 4 | loss: 0.8234351
	speed: 0.0040s/iter; left time: 16.7196s
	iters: 800, epoch: 4 | loss: 0.4864241
	speed: 0.0039s/iter; left time: 15.7730s
	iters: 900, epoch: 4 | loss: 0.2408448
	speed: 0.0038s/iter; left time: 15.1169s
Updating learning rate to 2.0233547075e-05
Epoch: 4 cost time: 3.840331554412842
Epoch: 4, Steps: 979 | Train Loss: 0.6302187 Vali Loss: 0.5541625 Best vali loss: 0.5463577
	iters: 100, epoch: 5 | loss: 0.2216621
	speed: 0.0125s/iter; left time: 47.7687s
	iters: 200, epoch: 5 | loss: 0.7186200
	speed: 0.0040s/iter; left time: 14.7862s
	iters: 300, epoch: 5 | loss: 0.4973624
	speed: 0.0037s/iter; left time: 13.4622s
	iters: 400, epoch: 5 | loss: 0.4774463
	speed: 0.0036s/iter; left time: 12.8271s
	iters: 500, epoch: 5 | loss: 0.5241895
	speed: 0.0037s/iter; left time: 12.4779s
	iters: 600, epoch: 5 | loss: 0.9727079
	speed: 0.0037s/iter; left time: 12.2041s
	iters: 700, epoch: 5 | loss: 0.5173803
	speed: 0.0037s/iter; left time: 11.9321s
	iters: 800, epoch: 5 | loss: 0.7368088
	speed: 0.0038s/iter; left time: 11.9026s
	iters: 900, epoch: 5 | loss: 0.8452362
	speed: 0.0038s/iter; left time: 11.4283s
Updating learning rate to 1.01167735375e-05
Validation loss decreased (0.5464 --> 0.5378).  Saving model state dict ...
Epoch: 5 cost time: 3.7576959133148193
Epoch: 5, Steps: 979 | Train Loss: 0.6123793 Vali Loss: 0.5377726 Best vali loss: 0.5377726
	iters: 100, epoch: 6 | loss: 0.5243767
	speed: 0.0131s/iter; left time: 37.2274s
	iters: 200, epoch: 6 | loss: 0.6129158
	speed: 0.0040s/iter; left time: 10.8498s
	iters: 300, epoch: 6 | loss: 0.6619647
	speed: 0.0040s/iter; left time: 10.5466s
	iters: 400, epoch: 6 | loss: 1.0460197
	speed: 0.0040s/iter; left time: 10.1136s
	iters: 500, epoch: 6 | loss: 0.9725578
	speed: 0.0038s/iter; left time: 9.3324s
	iters: 600, epoch: 6 | loss: 0.6430240
	speed: 0.0038s/iter; left time: 8.9155s
	iters: 700, epoch: 6 | loss: 0.5189622
	speed: 0.0038s/iter; left time: 8.5373s
	iters: 800, epoch: 6 | loss: 1.4692376
	speed: 0.0038s/iter; left time: 8.0331s
	iters: 900, epoch: 6 | loss: 0.4413082
	speed: 0.0039s/iter; left time: 7.9600s
Updating learning rate to 5.05838676875e-06
Epoch: 6 cost time: 3.8451037406921387
Epoch: 6, Steps: 979 | Train Loss: 0.7655963 Vali Loss: 0.5511321 Best vali loss: 0.5377726
	iters: 100, epoch: 7 | loss: 0.3349297
	speed: 0.0128s/iter; left time: 23.7560s
	iters: 200, epoch: 7 | loss: 0.5752912
	speed: 0.0043s/iter; left time: 7.5172s
	iters: 300, epoch: 7 | loss: 0.8125090
	speed: 0.0041s/iter; left time: 6.7715s
	iters: 400, epoch: 7 | loss: 0.4693913
	speed: 0.0040s/iter; left time: 6.2153s
	iters: 500, epoch: 7 | loss: 0.7227705
	speed: 0.0043s/iter; left time: 6.2166s
	iters: 600, epoch: 7 | loss: 0.6722321
	speed: 0.0041s/iter; left time: 5.5801s
	iters: 700, epoch: 7 | loss: 0.6388077
	speed: 0.0042s/iter; left time: 5.2568s
	iters: 800, epoch: 7 | loss: 0.6617715
	speed: 0.0044s/iter; left time: 5.0844s
	iters: 900, epoch: 7 | loss: 0.4611923
	speed: 0.0045s/iter; left time: 4.7622s
Updating learning rate to 2.529193384375e-06
Epoch: 7 cost time: 4.200828790664673
Epoch: 7, Steps: 979 | Train Loss: 0.5943217 Vali Loss: 0.5560129 Best vali loss: 0.5377726
	iters: 100, epoch: 8 | loss: 1.2007372
	speed: 0.0130s/iter; left time: 11.4579s
	iters: 200, epoch: 8 | loss: 0.3874892
	speed: 0.0037s/iter; left time: 2.8849s
	iters: 300, epoch: 8 | loss: 0.7190392
	speed: 0.0039s/iter; left time: 2.6468s
	iters: 400, epoch: 8 | loss: 0.7016172
	speed: 0.0039s/iter; left time: 2.2716s
	iters: 500, epoch: 8 | loss: 0.3855593
	speed: 0.0039s/iter; left time: 1.8873s
	iters: 600, epoch: 8 | loss: 0.4337234
	speed: 0.0039s/iter; left time: 1.4885s
	iters: 700, epoch: 8 | loss: 0.3159624
	speed: 0.0039s/iter; left time: 1.0848s
	iters: 800, epoch: 8 | loss: 0.7401074
	speed: 0.0037s/iter; left time: 0.6684s
	iters: 900, epoch: 8 | loss: 0.5380229
	speed: 0.0040s/iter; left time: 0.3220s
Updating learning rate to 1.2645966921875e-06
Epoch: 8 cost time: 3.834760904312134
Epoch: 8, Steps: 979 | Train Loss: 0.6024731 Vali Loss: 0.5590187 Best vali loss: 0.5377726

best validation loss 0.5377725875457643

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010185584322, 'e_layers': 2, 'learning_rate': 0.0002382391359, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0083188
	speed: 0.0100s/iter; left time: 38.1152s
	iters: 200, epoch: 1 | loss: 0.3613173
	speed: 0.0034s/iter; left time: 12.8146s
	iters: 300, epoch: 1 | loss: 0.7950718
	speed: 0.0034s/iter; left time: 12.4855s
	iters: 400, epoch: 1 | loss: 0.8590198
	speed: 0.0037s/iter; left time: 12.8569s
Updating learning rate to 0.00022917169870059246
Validation loss decreased (inf --> 0.5972).  Saving model state dict ...
Epoch: 1 cost time: 2.081653594970703
Epoch: 1, Steps: 490 | Train Loss: 0.7559319 Vali Loss: 0.5971654 Best vali loss: 0.5971654
	iters: 100, epoch: 2 | loss: 1.3794564
	speed: 0.0103s/iter; left time: 34.4048s
	iters: 200, epoch: 2 | loss: 0.4103118
	speed: 0.0037s/iter; left time: 11.9824s
	iters: 300, epoch: 2 | loss: 0.5952975
	speed: 0.0035s/iter; left time: 11.0694s
	iters: 400, epoch: 2 | loss: 0.5024206
	speed: 0.0036s/iter; left time: 11.0613s
Updating learning rate to 0.0002033498222194567
Validation loss decreased (0.5972 --> 0.5624).  Saving model state dict ...
Epoch: 2 cost time: 1.841855525970459
Epoch: 2, Steps: 490 | Train Loss: 0.7218716 Vali Loss: 0.5624238 Best vali loss: 0.5624238
	iters: 100, epoch: 3 | loss: 0.7606121
	speed: 0.0100s/iter; left time: 28.4089s
	iters: 200, epoch: 3 | loss: 0.3023940
	speed: 0.0033s/iter; left time: 8.9766s
	iters: 300, epoch: 3 | loss: 0.9578045
	speed: 0.0032s/iter; left time: 8.4940s
	iters: 400, epoch: 3 | loss: 0.9311263
	speed: 0.0032s/iter; left time: 8.0651s
Updating learning rate to 0.00016470465307495254
Validation loss decreased (0.5624 --> 0.5447).  Saving model state dict ...
Epoch: 3 cost time: 1.6154639720916748
Epoch: 3, Steps: 490 | Train Loss: 0.7379842 Vali Loss: 0.5447323 Best vali loss: 0.5447323
	iters: 100, epoch: 4 | loss: 0.6044071
	speed: 0.0095s/iter; left time: 22.2551s
	iters: 200, epoch: 4 | loss: 0.6787784
	speed: 0.0032s/iter; left time: 7.2570s
	iters: 300, epoch: 4 | loss: 0.6155885
	speed: 0.0032s/iter; left time: 6.9529s
	iters: 400, epoch: 4 | loss: 0.7088360
	speed: 0.0033s/iter; left time: 6.6770s
Updating learning rate to 0.00011911956795
Epoch: 4 cost time: 1.6337745189666748
Epoch: 4, Steps: 490 | Train Loss: 0.6519025 Vali Loss: 0.5613036 Best vali loss: 0.5447323
	iters: 100, epoch: 5 | loss: 0.6452446
	speed: 0.0093s/iter; left time: 17.3074s
	iters: 200, epoch: 5 | loss: 0.5067267
	speed: 0.0032s/iter; left time: 5.6136s
	iters: 300, epoch: 5 | loss: 1.0211339
	speed: 0.0032s/iter; left time: 5.3833s
	iters: 400, epoch: 5 | loss: 0.6227036
	speed: 0.0033s/iter; left time: 5.1258s
Updating learning rate to 7.353448282504747e-05
Epoch: 5 cost time: 1.6225168704986572
Epoch: 5, Steps: 490 | Train Loss: 0.6989522 Vali Loss: 0.5707299 Best vali loss: 0.5447323
	iters: 100, epoch: 6 | loss: 0.6317739
	speed: 0.0097s/iter; left time: 13.2976s
	iters: 200, epoch: 6 | loss: 0.4796036
	speed: 0.0037s/iter; left time: 4.6880s
	iters: 300, epoch: 6 | loss: 0.5775814
	speed: 0.0035s/iter; left time: 4.0887s
	iters: 400, epoch: 6 | loss: 0.8115100
	speed: 0.0038s/iter; left time: 4.0168s
Updating learning rate to 3.4889313680543275e-05
Epoch: 6 cost time: 1.8396601676940918
Epoch: 6, Steps: 490 | Train Loss: 0.6251172 Vali Loss: 0.5945839 Best vali loss: 0.5447323
	iters: 100, epoch: 7 | loss: 0.6600682
	speed: 0.0106s/iter; left time: 9.3437s
	iters: 200, epoch: 7 | loss: 0.7229541
	speed: 0.0038s/iter; left time: 2.9727s
	iters: 300, epoch: 7 | loss: 0.4211889
	speed: 0.0037s/iter; left time: 2.5166s
	iters: 400, epoch: 7 | loss: 0.5965295
	speed: 0.0036s/iter; left time: 2.0745s
Updating learning rate to 9.067437199407545e-06
Epoch: 7 cost time: 1.8405094146728516
Epoch: 7, Steps: 490 | Train Loss: 0.6001852 Vali Loss: 0.5980613 Best vali loss: 0.5447323
	iters: 100, epoch: 8 | loss: 0.2775848
	speed: 0.0093s/iter; left time: 3.6432s
	iters: 200, epoch: 8 | loss: 0.4215941
	speed: 0.0032s/iter; left time: 0.9173s
	iters: 300, epoch: 8 | loss: 0.3766506
	speed: 0.0032s/iter; left time: 0.6050s
	iters: 400, epoch: 8 | loss: 0.7766777
	speed: 0.0032s/iter; left time: 0.2924s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5904462337493896
Epoch: 8, Steps: 490 | Train Loss: 0.4631268 Vali Loss: 0.6008964 Best vali loss: 0.5447323

best validation loss 0.544732348144413

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0023287080746, 'e_layers': 3, 'learning_rate': 0.0001604218839, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8177637
	speed: 0.0108s/iter; left time: 41.1778s
	iters: 200, epoch: 1 | loss: 0.7991132
	speed: 0.0047s/iter; left time: 17.3932s
	iters: 300, epoch: 1 | loss: 0.8796441
	speed: 0.0045s/iter; left time: 16.4001s
	iters: 400, epoch: 1 | loss: 0.7838542
	speed: 0.0046s/iter; left time: 16.2590s
Updating learning rate to 0.0001604218839
Validation loss decreased (inf --> 0.6133).  Saving model state dict ...
Epoch: 1 cost time: 2.6015167236328125
Epoch: 1, Steps: 490 | Train Loss: 0.8200938 Vali Loss: 0.6132548 Best vali loss: 0.6132548
	iters: 100, epoch: 2 | loss: 0.7046822
	speed: 0.0128s/iter; left time: 42.7667s
	iters: 200, epoch: 2 | loss: 0.5673075
	speed: 0.0044s/iter; left time: 14.3606s
	iters: 300, epoch: 2 | loss: 1.4694251
	speed: 0.0044s/iter; left time: 13.6326s
	iters: 400, epoch: 2 | loss: 0.7896617
	speed: 0.0043s/iter; left time: 13.0592s
Updating learning rate to 8.021094195e-05
Validation loss decreased (0.6133 --> 0.5915).  Saving model state dict ...
Epoch: 2 cost time: 2.209773302078247
Epoch: 2, Steps: 490 | Train Loss: 0.8827691 Vali Loss: 0.5915199 Best vali loss: 0.5915199
	iters: 100, epoch: 3 | loss: 0.9799465
	speed: 0.0131s/iter; left time: 37.1424s
	iters: 200, epoch: 3 | loss: 1.2591786
	speed: 0.0046s/iter; left time: 12.5144s
	iters: 300, epoch: 3 | loss: 0.8670844
	speed: 0.0046s/iter; left time: 12.1347s
	iters: 400, epoch: 3 | loss: 0.6686740
	speed: 0.0045s/iter; left time: 11.5477s
Updating learning rate to 4.0105470975e-05
Validation loss decreased (0.5915 --> 0.5580).  Saving model state dict ...
Epoch: 3 cost time: 2.3016653060913086
Epoch: 3, Steps: 490 | Train Loss: 0.9437209 Vali Loss: 0.5580334 Best vali loss: 0.5580334

best validation loss 0.5580334370884285

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0055802508378, 'e_layers': 2, 'learning_rate': 0.0001575314195, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9031553
	speed: 0.0100s/iter; left time: 38.3022s
	iters: 200, epoch: 1 | loss: 1.4849538
	speed: 0.0033s/iter; left time: 12.4581s
	iters: 300, epoch: 1 | loss: 1.4507750
	speed: 0.0033s/iter; left time: 12.0659s
	iters: 400, epoch: 1 | loss: 1.2088286
	speed: 0.0033s/iter; left time: 11.7092s
Updating learning rate to 0.0001575314195
Validation loss decreased (inf --> 0.5690).  Saving model state dict ...
Epoch: 1 cost time: 2.029242515563965
Epoch: 1, Steps: 490 | Train Loss: 1.2619282 Vali Loss: 0.5689838 Best vali loss: 0.5689838
	iters: 100, epoch: 2 | loss: 0.5540065
	speed: 0.0103s/iter; left time: 34.4077s
	iters: 200, epoch: 2 | loss: 0.5335206
	speed: 0.0034s/iter; left time: 11.0435s
	iters: 300, epoch: 2 | loss: 0.7688863
	speed: 0.0034s/iter; left time: 10.6998s
	iters: 400, epoch: 2 | loss: 0.7676486
	speed: 0.0036s/iter; left time: 10.8937s
Updating learning rate to 7.876570975e-05
Epoch: 2 cost time: 1.7535927295684814
Epoch: 2, Steps: 490 | Train Loss: 0.6560155 Vali Loss: 0.5969726 Best vali loss: 0.5689838
	iters: 100, epoch: 3 | loss: 1.1835315
	speed: 0.0101s/iter; left time: 28.7942s
	iters: 200, epoch: 3 | loss: 0.9096808
	speed: 0.0034s/iter; left time: 9.3803s
	iters: 300, epoch: 3 | loss: 0.6964288
	speed: 0.0032s/iter; left time: 8.4408s
	iters: 400, epoch: 3 | loss: 0.6250629
	speed: 0.0032s/iter; left time: 8.0922s
Updating learning rate to 3.9382854875e-05
Validation loss decreased (0.5690 --> 0.5581).  Saving model state dict ...
Epoch: 3 cost time: 1.6933350563049316
Epoch: 3, Steps: 490 | Train Loss: 0.8536760 Vali Loss: 0.5580849 Best vali loss: 0.5580849

best validation loss 0.5580849457757995

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0038971963597, 'e_layers': 1, 'learning_rate': 0.0001582170362, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7068211
	speed: 0.0098s/iter; left time: 8.6797s
Updating learning rate to 0.0001582170362
Validation loss decreased (inf --> 0.6183).  Saving model state dict ...
Epoch: 1 cost time: 0.7884223461151123
Epoch: 1, Steps: 123 | Train Loss: 0.7068211 Vali Loss: 0.6182950 Best vali loss: 0.6182950
	iters: 100, epoch: 2 | loss: 0.8779405
	speed: 0.0064s/iter; left time: 4.8762s
Updating learning rate to 7.91085181e-05
Validation loss decreased (0.6183 --> 0.6086).  Saving model state dict ...
Epoch: 2 cost time: 0.46729373931884766
Epoch: 2, Steps: 123 | Train Loss: 0.8779405 Vali Loss: 0.6085837 Best vali loss: 0.6085837
	iters: 100, epoch: 3 | loss: 0.6655079
	speed: 0.0065s/iter; left time: 4.1255s
Updating learning rate to 3.955425905e-05
Epoch: 3 cost time: 0.4978013038635254
Epoch: 3, Steps: 123 | Train Loss: 0.6655079 Vali Loss: 0.6086327 Best vali loss: 0.6085837

best validation loss 0.6085837173936324

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0023287080746, 'e_layers': 3, 'learning_rate': 0.0001604218839, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7113680
	speed: 0.0114s/iter; left time: 26.8596s
	iters: 200, epoch: 4 | loss: 0.4860422
	speed: 0.0047s/iter; left time: 10.5987s
	iters: 300, epoch: 4 | loss: 0.7515832
	speed: 0.0046s/iter; left time: 9.9927s
	iters: 400, epoch: 4 | loss: 0.7410744
	speed: 0.0046s/iter; left time: 9.4295s
Updating learning rate to 2.00527354875e-05
Validation loss decreased (0.5580 --> 0.5439).  Saving model state dict ...
Epoch: 4 cost time: 2.6459860801696777
Epoch: 4, Steps: 490 | Train Loss: 0.6725170 Vali Loss: 0.5438790 Best vali loss: 0.5438790
	iters: 100, epoch: 5 | loss: 0.6851816
	speed: 0.0131s/iter; left time: 24.4384s
	iters: 200, epoch: 5 | loss: 0.4414075
	speed: 0.0045s/iter; left time: 8.0072s
	iters: 300, epoch: 5 | loss: 1.3121920
	speed: 0.0046s/iter; left time: 7.5905s
	iters: 400, epoch: 5 | loss: 0.6885998
	speed: 0.0047s/iter; left time: 7.3034s
Updating learning rate to 1.002636774375e-05
Epoch: 5 cost time: 2.3058793544769287
Epoch: 5, Steps: 490 | Train Loss: 0.7818452 Vali Loss: 0.5577387 Best vali loss: 0.5438790
	iters: 100, epoch: 6 | loss: 0.9506261
	speed: 0.0124s/iter; left time: 16.9953s
	iters: 200, epoch: 6 | loss: 1.0700547
	speed: 0.0045s/iter; left time: 5.7800s
	iters: 300, epoch: 6 | loss: 0.8300279
	speed: 0.0045s/iter; left time: 5.2646s
	iters: 400, epoch: 6 | loss: 0.6231984
	speed: 0.0045s/iter; left time: 4.8371s
Updating learning rate to 5.013183871875e-06
Epoch: 6 cost time: 2.264420747756958
Epoch: 6, Steps: 490 | Train Loss: 0.8684767 Vali Loss: 0.5518939 Best vali loss: 0.5438790
	iters: 100, epoch: 7 | loss: 0.3802074
	speed: 0.0126s/iter; left time: 11.0757s
	iters: 200, epoch: 7 | loss: 0.7783515
	speed: 0.0044s/iter; left time: 3.4514s
	iters: 300, epoch: 7 | loss: 1.4746869
	speed: 0.0044s/iter; left time: 2.9948s
	iters: 400, epoch: 7 | loss: 0.8336048
	speed: 0.0045s/iter; left time: 2.5986s
Updating learning rate to 2.5065919359375e-06
Epoch: 7 cost time: 2.237859010696411
Epoch: 7, Steps: 490 | Train Loss: 0.8667126 Vali Loss: 0.5567081 Best vali loss: 0.5438790
	iters: 100, epoch: 8 | loss: 0.6784782
	speed: 0.0123s/iter; left time: 4.8093s
	iters: 200, epoch: 8 | loss: 0.6442823
	speed: 0.0045s/iter; left time: 1.3002s
	iters: 300, epoch: 8 | loss: 0.5209800
	speed: 0.0044s/iter; left time: 0.8447s
	iters: 400, epoch: 8 | loss: 0.8850431
	speed: 0.0045s/iter; left time: 0.4052s
Updating learning rate to 1.25329596796875e-06
Epoch: 8 cost time: 2.242750644683838
Epoch: 8, Steps: 490 | Train Loss: 0.6821959 Vali Loss: 0.5580122 Best vali loss: 0.5438790

best validation loss 0.5438790303697635

[INFO][smbo.py:320] Finished 1450 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0039133973321, 'e_layers': 4, 'learning_rate': 0.0013962049763, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7482252
	speed: 0.0125s/iter; left time: 11.0366s
Updating learning rate to 0.001343065088546988
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 1.1176481246948242
Epoch: 1, Steps: 123 | Train Loss: 0.7482252 Vali Loss: 0.6026576 Best vali loss: 0.6026576
	iters: 100, epoch: 2 | loss: 1.1205691
	speed: 0.0100s/iter; left time: 7.6466s
Updating learning rate to 0.0011917354914840663
Epoch: 2 cost time: 0.8339259624481201
Epoch: 2, Steps: 123 | Train Loss: 1.1205691 Vali Loss: 0.6055976 Best vali loss: 0.6026576
	iters: 100, epoch: 3 | loss: 0.8638701
	speed: 0.0097s/iter; left time: 6.2140s
Updating learning rate to 0.0009652547444578514
Epoch: 3 cost time: 0.7958681583404541
Epoch: 3, Steps: 123 | Train Loss: 0.8638701 Vali Loss: 0.6169872 Best vali loss: 0.6026576
	iters: 100, epoch: 4 | loss: 0.7679623
	speed: 0.0095s/iter; left time: 4.9272s
Updating learning rate to 0.00069810248815
Epoch: 4 cost time: 0.786613941192627
Epoch: 4, Steps: 123 | Train Loss: 0.7679623 Vali Loss: 0.6111959 Best vali loss: 0.6026576
	iters: 100, epoch: 5 | loss: 0.6376974
	speed: 0.0095s/iter; left time: 3.7315s
Updating learning rate to 0.0004309502318421486
Epoch: 5 cost time: 0.7844457626342773
Epoch: 5, Steps: 123 | Train Loss: 0.6376974 Vali Loss: 0.6405393 Best vali loss: 0.6026576
	iters: 100, epoch: 6 | loss: 0.7472621
	speed: 0.0099s/iter; left time: 2.6701s
Updating learning rate to 0.00020446948481593358
Epoch: 6 cost time: 0.8146724700927734
Epoch: 6, Steps: 123 | Train Loss: 0.7472621 Vali Loss: 0.6314388 Best vali loss: 0.6026576
	iters: 100, epoch: 7 | loss: 0.5869685
	speed: 0.0101s/iter; left time: 1.4891s
Updating learning rate to 5.3139887753011904e-05
Epoch: 7 cost time: 0.8555374145507812
Epoch: 7, Steps: 123 | Train Loss: 0.5869685 Vali Loss: 0.6317528 Best vali loss: 0.6026576
	iters: 100, epoch: 8 | loss: 0.8750576
	speed: 0.0101s/iter; left time: 0.2413s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.821671724319458
Epoch: 8, Steps: 123 | Train Loss: 0.8750576 Vali Loss: 0.6331097 Best vali loss: 0.6026576

best validation loss 0.6026576009407908

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001085337408, 'e_layers': 2, 'learning_rate': 0.0005516260036, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0189025
	speed: 0.0109s/iter; left time: 9.6555s
Updating learning rate to 0.0005306309889635188
Validation loss decreased (inf --> 0.5590).  Saving model state dict ...
Epoch: 1 cost time: 0.925370454788208
Epoch: 1, Steps: 123 | Train Loss: 1.0189025 Vali Loss: 0.5590120 Best vali loss: 0.5590120
	iters: 100, epoch: 2 | loss: 0.8252459
	speed: 0.0078s/iter; left time: 5.9745s
Updating learning rate to 0.00047084224571219746
Epoch: 2 cost time: 0.6067569255828857
Epoch: 2, Steps: 123 | Train Loss: 0.8252459 Vali Loss: 0.5625563 Best vali loss: 0.5590120
	iters: 100, epoch: 3 | loss: 0.7676091
	speed: 0.0078s/iter; left time: 4.9924s
Updating learning rate to 0.0003813620680197427
Validation loss decreased (0.5590 --> 0.5519).  Saving model state dict ...
Epoch: 3 cost time: 0.606776237487793
Epoch: 3, Steps: 123 | Train Loss: 0.7676091 Vali Loss: 0.5519028 Best vali loss: 0.5519028
	iters: 100, epoch: 4 | loss: 0.7242959
	speed: 0.0080s/iter; left time: 4.1121s
Updating learning rate to 0.0002758130018
Validation loss decreased (0.5519 --> 0.5410).  Saving model state dict ...
Epoch: 4 cost time: 0.6013405323028564
Epoch: 4, Steps: 123 | Train Loss: 0.7242959 Vali Loss: 0.5409900 Best vali loss: 0.5409900
	iters: 100, epoch: 5 | loss: 0.5978320
	speed: 0.0080s/iter; left time: 3.1571s
Updating learning rate to 0.00017026393558025734
Epoch: 5 cost time: 0.6276507377624512
Epoch: 5, Steps: 123 | Train Loss: 0.5978320 Vali Loss: 0.5646907 Best vali loss: 0.5409900
	iters: 100, epoch: 6 | loss: 0.4717591
	speed: 0.0077s/iter; left time: 2.0718s
Updating learning rate to 8.078375788780258e-05
Epoch: 6 cost time: 0.6096787452697754
Epoch: 6, Steps: 123 | Train Loss: 0.4717591 Vali Loss: 0.5872816 Best vali loss: 0.5409900
	iters: 100, epoch: 7 | loss: 0.7661620
	speed: 0.0079s/iter; left time: 1.1570s
Updating learning rate to 2.0995014636481312e-05
Epoch: 7 cost time: 0.6180567741394043
Epoch: 7, Steps: 123 | Train Loss: 0.7661620 Vali Loss: 0.5883035 Best vali loss: 0.5409900
	iters: 100, epoch: 8 | loss: 0.7419735
	speed: 0.0078s/iter; left time: 0.1876s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6254935264587402
Epoch: 8, Steps: 123 | Train Loss: 0.7419735 Vali Loss: 0.5938564 Best vali loss: 0.5409900

best validation loss 0.5409900192473013

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010900304349, 'e_layers': 2, 'learning_rate': 0.0004805616223, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0412377
	speed: 0.0110s/iter; left time: 9.7309s
Updating learning rate to 0.0004622713346266948
Validation loss decreased (inf --> 0.6435).  Saving model state dict ...
Epoch: 1 cost time: 0.9323265552520752
Epoch: 1, Steps: 123 | Train Loss: 1.0412377 Vali Loss: 0.6435256 Best vali loss: 0.6435256
	iters: 100, epoch: 2 | loss: 0.8063054
	speed: 0.0077s/iter; left time: 5.8650s
Updating learning rate to 0.0004101850021031692
Validation loss decreased (0.6435 --> 0.5847).  Saving model state dict ...
Epoch: 2 cost time: 0.5982897281646729
Epoch: 2, Steps: 123 | Train Loss: 0.8063054 Vali Loss: 0.5847279 Best vali loss: 0.5847279
	iters: 100, epoch: 3 | loss: 0.7841375
	speed: 0.0078s/iter; left time: 5.0048s
Updating learning rate to 0.00033223229669234996
Validation loss decreased (0.5847 --> 0.5478).  Saving model state dict ...
Epoch: 3 cost time: 0.6111836433410645
Epoch: 3, Steps: 123 | Train Loss: 0.7841375 Vali Loss: 0.5478323 Best vali loss: 0.5478323

best validation loss 0.5478322923817827

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0028628299924, 'e_layers': 2, 'learning_rate': 0.0004677651924, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 2.2102702
	speed: 0.0094s/iter; left time: 72.8748s
	iters: 200, epoch: 1 | loss: 0.7306207
	speed: 0.0031s/iter; left time: 23.7255s
	iters: 300, epoch: 1 | loss: 1.1883553
	speed: 0.0031s/iter; left time: 23.5197s
	iters: 400, epoch: 1 | loss: 0.4658201
	speed: 0.0032s/iter; left time: 23.9797s
	iters: 500, epoch: 1 | loss: 0.4880922
	speed: 0.0032s/iter; left time: 23.3353s
	iters: 600, epoch: 1 | loss: 0.4179945
	speed: 0.0031s/iter; left time: 22.6425s
	iters: 700, epoch: 1 | loss: 0.3893275
	speed: 0.0032s/iter; left time: 23.1722s
	iters: 800, epoch: 1 | loss: 0.7952011
	speed: 0.0034s/iter; left time: 24.2451s
	iters: 900, epoch: 1 | loss: 1.1893468
	speed: 0.0035s/iter; left time: 24.5599s
Updating learning rate to 0.00044996193983978203
Validation loss decreased (inf --> 0.5961).  Saving model state dict ...
Epoch: 1 cost time: 3.556306838989258
Epoch: 1, Steps: 979 | Train Loss: 0.8750032 Vali Loss: 0.5961346 Best vali loss: 0.5961346
	iters: 100, epoch: 2 | loss: 0.4240444
	speed: 0.0115s/iter; left time: 77.7061s
	iters: 200, epoch: 2 | loss: 0.7697538
	speed: 0.0034s/iter; left time: 22.8399s
	iters: 300, epoch: 2 | loss: 0.4605571
	speed: 0.0035s/iter; left time: 22.8303s
	iters: 400, epoch: 2 | loss: 0.2558820
	speed: 0.0033s/iter; left time: 21.4963s
	iters: 500, epoch: 2 | loss: 0.7619844
	speed: 0.0034s/iter; left time: 21.6233s
	iters: 600, epoch: 2 | loss: 0.3132805
	speed: 0.0035s/iter; left time: 22.1093s
	iters: 700, epoch: 2 | loss: 1.3140401
	speed: 0.0036s/iter; left time: 21.8665s
	iters: 800, epoch: 2 | loss: 0.5591353
	speed: 0.0034s/iter; left time: 20.6820s
	iters: 900, epoch: 2 | loss: 1.1558112
	speed: 0.0035s/iter; left time: 20.8505s
Updating learning rate to 0.00039926256597453503
Epoch: 2 cost time: 3.439159393310547
Epoch: 2, Steps: 979 | Train Loss: 0.6682765 Vali Loss: 0.6293014 Best vali loss: 0.5961346
	iters: 100, epoch: 3 | loss: 0.2975409
	speed: 0.0111s/iter; left time: 64.0313s
	iters: 200, epoch: 3 | loss: 1.2068702
	speed: 0.0030s/iter; left time: 17.2799s
	iters: 300, epoch: 3 | loss: 1.0290766
	speed: 0.0029s/iter; left time: 16.3888s
	iters: 400, epoch: 3 | loss: 0.9702277
	speed: 0.0030s/iter; left time: 16.1973s
	iters: 500, epoch: 3 | loss: 1.2103155
	speed: 0.0029s/iter; left time: 15.5184s
	iters: 600, epoch: 3 | loss: 0.6782811
	speed: 0.0029s/iter; left time: 15.4559s
	iters: 700, epoch: 3 | loss: 0.6431410
	speed: 0.0029s/iter; left time: 15.0198s
	iters: 800, epoch: 3 | loss: 0.8859910
	speed: 0.0029s/iter; left time: 14.8572s
	iters: 900, epoch: 3 | loss: 0.9053414
	speed: 0.0031s/iter; left time: 15.3288s
Updating learning rate to 0.0003233855908842743
Epoch: 3 cost time: 2.9826290607452393
Epoch: 3, Steps: 979 | Train Loss: 0.8696428 Vali Loss: 0.6273489 Best vali loss: 0.5961346

best validation loss 0.5961346040026891

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020898343305, 'e_layers': 3, 'learning_rate': 0.0001697199715, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8266369
	speed: 0.0117s/iter; left time: 10.3141s
Updating learning rate to 0.00016326038971362444
Validation loss decreased (inf --> 0.6063).  Saving model state dict ...
Epoch: 1 cost time: 1.012192964553833
Epoch: 1, Steps: 123 | Train Loss: 0.8266369 Vali Loss: 0.6063130 Best vali loss: 0.6063130
	iters: 100, epoch: 2 | loss: 0.7895748
	speed: 0.0088s/iter; left time: 6.7332s
Updating learning rate to 0.0001448650571252188
Validation loss decreased (0.6063 --> 0.5946).  Saving model state dict ...
Epoch: 2 cost time: 0.7235047817230225
Epoch: 2, Steps: 123 | Train Loss: 0.7895748 Vali Loss: 0.5946015 Best vali loss: 0.5946015
	iters: 100, epoch: 3 | loss: 0.7276805
	speed: 0.0086s/iter; left time: 5.5227s
Updating learning rate to 0.00011733449636726261
Validation loss decreased (0.5946 --> 0.5722).  Saving model state dict ...
Epoch: 3 cost time: 0.6716749668121338
Epoch: 3, Steps: 123 | Train Loss: 0.7276805 Vali Loss: 0.5721583 Best vali loss: 0.5721583

best validation loss 0.5721582538659018

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010900304349, 'e_layers': 2, 'learning_rate': 0.0004805616223, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8299162
	speed: 0.0111s/iter; left time: 5.7075s
Updating learning rate to 0.00024028081115
Epoch: 4 cost time: 0.919313907623291
Epoch: 4, Steps: 123 | Train Loss: 0.8299162 Vali Loss: 0.5563734 Best vali loss: 0.5478323
	iters: 100, epoch: 5 | loss: 0.7035351
	speed: 0.0077s/iter; left time: 3.0244s
Updating learning rate to 0.00014832932560765008
Validation loss decreased (0.5478 --> 0.5444).  Saving model state dict ...
Epoch: 5 cost time: 0.6074013710021973
Epoch: 5, Steps: 123 | Train Loss: 0.7035351 Vali Loss: 0.5444329 Best vali loss: 0.5444329
	iters: 100, epoch: 6 | loss: 0.6558942
	speed: 0.0078s/iter; left time: 2.1118s
Updating learning rate to 7.037662019683081e-05
Epoch: 6 cost time: 0.6137135028839111
Epoch: 6, Steps: 123 | Train Loss: 0.6558942 Vali Loss: 0.5641716 Best vali loss: 0.5444329
	iters: 100, epoch: 7 | loss: 0.6707350
	speed: 0.0076s/iter; left time: 1.1152s
Updating learning rate to 1.8290287673305227e-05
Epoch: 7 cost time: 0.6008205413818359
Epoch: 7, Steps: 123 | Train Loss: 0.6707350 Vali Loss: 0.5575156 Best vali loss: 0.5444329
	iters: 100, epoch: 8 | loss: 0.5721377
	speed: 0.0078s/iter; left time: 0.1876s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6272335052490234
Epoch: 8, Steps: 123 | Train Loss: 0.5721377 Vali Loss: 0.5672742 Best vali loss: 0.5444329

best validation loss 0.5444329107100078

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017371045643, 'e_layers': 3, 'learning_rate': 5.44949675e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6345806
	speed: 0.0114s/iter; left time: 21.2601s
	iters: 200, epoch: 1 | loss: 0.6127186
	speed: 0.0052s/iter; left time: 9.1663s
Updating learning rate to 5.242087629905888e-05
Validation loss decreased (inf --> 0.6146).  Saving model state dict ...
Epoch: 1 cost time: 1.6261110305786133
Epoch: 1, Steps: 245 | Train Loss: 0.6236496 Vali Loss: 0.6145901 Best vali loss: 0.6145901
	iters: 100, epoch: 2 | loss: 0.5434885
	speed: 0.0105s/iter; left time: 16.9540s
	iters: 200, epoch: 2 | loss: 1.2661611
	speed: 0.0049s/iter; left time: 7.4562s
Updating learning rate to 4.651436427989526e-05
Validation loss decreased (0.6146 --> 0.6005).  Saving model state dict ...
Epoch: 2 cost time: 1.255126714706421
Epoch: 2, Steps: 245 | Train Loss: 0.9048248 Vali Loss: 0.6004916 Best vali loss: 0.6004916
	iters: 100, epoch: 3 | loss: 0.8229139
	speed: 0.0106s/iter; left time: 14.4778s
	iters: 200, epoch: 3 | loss: 0.4725738
	speed: 0.0049s/iter; left time: 6.2150s
Updating learning rate to 3.767464435476201e-05
Validation loss decreased (0.6005 --> 0.5604).  Saving model state dict ...
Epoch: 3 cost time: 1.2618021965026855
Epoch: 3, Steps: 245 | Train Loss: 0.6477439 Vali Loss: 0.5604157 Best vali loss: 0.5604157
	iters: 100, epoch: 4 | loss: 0.7679750
	speed: 0.0106s/iter; left time: 11.9582s
	iters: 200, epoch: 4 | loss: 0.7162527
	speed: 0.0050s/iter; left time: 5.0987s
Updating learning rate to 2.724748375e-05
Validation loss decreased (0.5604 --> 0.5405).  Saving model state dict ...
Epoch: 4 cost time: 1.283677577972412
Epoch: 4, Steps: 245 | Train Loss: 0.7421139 Vali Loss: 0.5404979 Best vali loss: 0.5404979
	iters: 100, epoch: 5 | loss: 0.8562275
	speed: 0.0108s/iter; left time: 9.4739s
	iters: 200, epoch: 5 | loss: 0.5398444
	speed: 0.0050s/iter; left time: 3.8787s
Updating learning rate to 1.6820323145237994e-05
Epoch: 5 cost time: 1.2863609790802002
Epoch: 5, Steps: 245 | Train Loss: 0.6980359 Vali Loss: 0.5451077 Best vali loss: 0.5404979
	iters: 100, epoch: 6 | loss: 0.7040442
	speed: 0.0100s/iter; left time: 6.3704s
	iters: 200, epoch: 6 | loss: 0.7774624
	speed: 0.0050s/iter; left time: 2.6718s
Updating learning rate to 7.980603220104743e-06
Validation loss decreased (0.5405 --> 0.5378).  Saving model state dict ...
Epoch: 6 cost time: 1.2656102180480957
Epoch: 6, Steps: 245 | Train Loss: 0.7407533 Vali Loss: 0.5378273 Best vali loss: 0.5378273
	iters: 100, epoch: 7 | loss: 0.5867948
	speed: 0.0105s/iter; left time: 4.0967s
	iters: 200, epoch: 7 | loss: 0.5218054
	speed: 0.0050s/iter; left time: 1.4628s
Updating learning rate to 2.074091200941118e-06
Validation loss decreased (0.5378 --> 0.5375).  Saving model state dict ...
Epoch: 7 cost time: 1.276590347290039
Epoch: 7, Steps: 245 | Train Loss: 0.5543001 Vali Loss: 0.5375338 Best vali loss: 0.5375338
	iters: 100, epoch: 8 | loss: 0.7201075
	speed: 0.0105s/iter; left time: 1.5381s
	iters: 200, epoch: 8 | loss: 0.7302887
	speed: 0.0050s/iter; left time: 0.2288s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2826457023620605
Epoch: 8, Steps: 245 | Train Loss: 0.7251981 Vali Loss: 0.5393157 Best vali loss: 0.5375338

best validation loss 0.5375337718207215

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016260085726, 'e_layers': 2, 'learning_rate': 5.35290334e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.35290334e-05
Validation loss decreased (inf --> 0.6134).  Saving model state dict ...
Epoch: 1 cost time: 0.8668932914733887
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6133518 Best vali loss: 0.6133518
Updating learning rate to 2.67645167e-05
Validation loss decreased (0.6134 --> 0.6019).  Saving model state dict ...
Epoch: 2 cost time: 0.5687015056610107
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6018859 Best vali loss: 0.6018859
Updating learning rate to 1.338225835e-05
Validation loss decreased (0.6019 --> 0.6016).  Saving model state dict ...
Epoch: 3 cost time: 0.564286470413208
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6016163 Best vali loss: 0.6016163
Updating learning rate to 6.691129175e-06
Epoch: 4 cost time: 0.5643911361694336
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6022066 Best vali loss: 0.6016163
Updating learning rate to 3.3455645875e-06
Validation loss decreased (0.6016 --> 0.6012).  Saving model state dict ...
Epoch: 5 cost time: 0.5690314769744873
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6011787 Best vali loss: 0.6011787
Updating learning rate to 1.67278229375e-06
Validation loss decreased (0.6012 --> 0.6010).  Saving model state dict ...
Epoch: 6 cost time: 0.5648760795593262
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6009895 Best vali loss: 0.6009895
Updating learning rate to 8.36391146875e-07
Validation loss decreased (0.6010 --> 0.6006).  Saving model state dict ...
Epoch: 7 cost time: 0.566338300704956
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6006097 Best vali loss: 0.6006097
Updating learning rate to 4.181955734375e-07
Epoch: 8 cost time: 0.5743820667266846
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6006967 Best vali loss: 0.6006097

best validation loss 0.6006097209944542

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0046725506202, 'e_layers': 2, 'learning_rate': 0.0002279170249, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002279170249
Validation loss decreased (inf --> 0.5930).  Saving model state dict ...
Epoch: 1 cost time: 0.8430640697479248
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.5929960 Best vali loss: 0.5929960
Updating learning rate to 0.00011395851245
Validation loss decreased (0.5930 --> 0.5748).  Saving model state dict ...
Epoch: 2 cost time: 0.5378384590148926
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5747657 Best vali loss: 0.5747657
Updating learning rate to 5.6979256225e-05
Epoch: 3 cost time: 0.5406415462493896
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5753062 Best vali loss: 0.5747657

best validation loss 0.5747657211386237

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.002791703104, 'e_layers': 4, 'learning_rate': 0.0031017944766, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7759594
	speed: 0.0111s/iter; left time: 42.5947s
	iters: 200, epoch: 1 | loss: 1.2827346
	speed: 0.0052s/iter; left time: 19.3111s
	iters: 300, epoch: 1 | loss: 0.5287754
	speed: 0.0052s/iter; left time: 18.9945s
	iters: 400, epoch: 1 | loss: 1.2300144
	speed: 0.0052s/iter; left time: 18.3405s
Updating learning rate to 0.00298373945379365
Validation loss decreased (inf --> 0.6273).  Saving model state dict ...
Epoch: 1 cost time: 2.8902602195739746
Epoch: 1, Steps: 490 | Train Loss: 0.9543710 Vali Loss: 0.6272927 Best vali loss: 0.6272927
	iters: 100, epoch: 2 | loss: 0.5467348
	speed: 0.0141s/iter; left time: 46.9234s
	iters: 200, epoch: 2 | loss: 1.0568888
	speed: 0.0049s/iter; left time: 15.9269s
	iters: 300, epoch: 2 | loss: 1.2132324
	speed: 0.0048s/iter; left time: 15.1267s
	iters: 400, epoch: 2 | loss: 0.5313472
	speed: 0.0050s/iter; left time: 15.1029s
Updating learning rate to 0.002647547192425419
Validation loss decreased (0.6273 --> 0.5998).  Saving model state dict ...
Epoch: 2 cost time: 2.494664192199707
Epoch: 2, Steps: 490 | Train Loss: 0.8370508 Vali Loss: 0.5998334 Best vali loss: 0.5998334
	iters: 100, epoch: 3 | loss: 0.8480234
	speed: 0.0131s/iter; left time: 37.1039s
	iters: 200, epoch: 3 | loss: 0.8047299
	speed: 0.0050s/iter; left time: 13.5985s
	iters: 300, epoch: 3 | loss: 0.8587790
	speed: 0.0049s/iter; left time: 13.0354s
	iters: 400, epoch: 3 | loss: 0.9991680
	speed: 0.0050s/iter; left time: 12.7309s
Updating learning rate to 0.0021443999166981826
Epoch: 3 cost time: 2.497647762298584
Epoch: 3, Steps: 490 | Train Loss: 0.8776751 Vali Loss: 0.6040531 Best vali loss: 0.5998334

best validation loss 0.5998334384858195

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0029499395283, 'e_layers': 2, 'learning_rate': 0.0004718886555, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8968622
	speed: 0.0118s/iter; left time: 10.4068s
Updating learning rate to 0.0004718886555
Validation loss decreased (inf --> 0.6081).  Saving model state dict ...
Epoch: 1 cost time: 1.0349571704864502
Epoch: 1, Steps: 123 | Train Loss: 0.8968622 Vali Loss: 0.6081221 Best vali loss: 0.6081221
	iters: 100, epoch: 2 | loss: 0.7537646
	speed: 0.0093s/iter; left time: 7.0533s
Updating learning rate to 0.00023594432775
Validation loss decreased (0.6081 --> 0.5739).  Saving model state dict ...
Epoch: 2 cost time: 0.7271087169647217
Epoch: 2, Steps: 123 | Train Loss: 0.7537646 Vali Loss: 0.5739337 Best vali loss: 0.5739337
	iters: 100, epoch: 3 | loss: 0.6211768
	speed: 0.0094s/iter; left time: 5.9837s
Updating learning rate to 0.000117972163875
Validation loss decreased (0.5739 --> 0.5510).  Saving model state dict ...
Epoch: 3 cost time: 0.731243371963501
Epoch: 3, Steps: 123 | Train Loss: 0.6211768 Vali Loss: 0.5510464 Best vali loss: 0.5510464

best validation loss 0.5510463892503339

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0029499395283, 'e_layers': 2, 'learning_rate': 0.0004718886555, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7470002
	speed: 0.0120s/iter; left time: 6.1859s
Updating learning rate to 5.89860819375e-05
Validation loss decreased (0.5510 --> 0.5500).  Saving model state dict ...
Epoch: 4 cost time: 1.0359277725219727
Epoch: 4, Steps: 123 | Train Loss: 0.7470002 Vali Loss: 0.5499695 Best vali loss: 0.5499695
	iters: 100, epoch: 5 | loss: 0.5915071
	speed: 0.0094s/iter; left time: 3.6886s
Updating learning rate to 2.949304096875e-05
Validation loss decreased (0.5500 --> 0.5474).  Saving model state dict ...
Epoch: 5 cost time: 0.7388625144958496
Epoch: 5, Steps: 123 | Train Loss: 0.5915071 Vali Loss: 0.5473636 Best vali loss: 0.5473636
	iters: 100, epoch: 6 | loss: 0.5826637
	speed: 0.0094s/iter; left time: 2.5469s
Updating learning rate to 1.4746520484375e-05
Epoch: 6 cost time: 0.7300252914428711
Epoch: 6, Steps: 123 | Train Loss: 0.5826637 Vali Loss: 0.5525679 Best vali loss: 0.5473636
	iters: 100, epoch: 7 | loss: 0.8477944
	speed: 0.0091s/iter; left time: 1.3390s
Updating learning rate to 7.3732602421875e-06
Validation loss decreased (0.5474 --> 0.5458).  Saving model state dict ...
Epoch: 7 cost time: 0.7324991226196289
Epoch: 7, Steps: 123 | Train Loss: 0.8477944 Vali Loss: 0.5457674 Best vali loss: 0.5457674
	iters: 100, epoch: 8 | loss: 0.7649942
	speed: 0.0094s/iter; left time: 0.2265s
Updating learning rate to 3.68663012109375e-06
Validation loss decreased (0.5458 --> 0.5446).  Saving model state dict ...
Epoch: 8 cost time: 0.7315051555633545
Epoch: 8, Steps: 123 | Train Loss: 0.7649942 Vali Loss: 0.5445502 Best vali loss: 0.5445502

best validation loss 0.5445502089273593

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0048846706022, 'e_layers': 1, 'learning_rate': 0.0004557482649, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9503244
	speed: 0.0101s/iter; left time: 8.9611s
Updating learning rate to 0.000438402379409321
Validation loss decreased (inf --> 0.6048).  Saving model state dict ...
Epoch: 1 cost time: 0.8081934452056885
Epoch: 1, Steps: 123 | Train Loss: 0.9503244 Vali Loss: 0.6047649 Best vali loss: 0.6047649
	iters: 100, epoch: 2 | loss: 0.9891650
	speed: 0.0069s/iter; left time: 5.2212s
Updating learning rate to 0.0003890054767623965
Epoch: 2 cost time: 0.5117995738983154
Epoch: 2, Steps: 123 | Train Loss: 0.9891650 Vali Loss: 0.6093634 Best vali loss: 0.6047649
	iters: 100, epoch: 3 | loss: 0.6009371
	speed: 0.0066s/iter; left time: 4.2151s
Updating learning rate to 0.0003150777876031831
Validation loss decreased (0.6048 --> 0.6010).  Saving model state dict ...
Epoch: 3 cost time: 0.50187087059021
Epoch: 3, Steps: 123 | Train Loss: 0.6009371 Vali Loss: 0.6010160 Best vali loss: 0.6010160
	iters: 100, epoch: 4 | loss: 0.6584613
	speed: 0.0068s/iter; left time: 3.4961s
Updating learning rate to 0.00022787413245
Epoch: 4 cost time: 0.484591007232666
Epoch: 4, Steps: 123 | Train Loss: 0.6584613 Vali Loss: 0.6265110 Best vali loss: 0.6010160
	iters: 100, epoch: 5 | loss: 0.7324029
	speed: 0.0065s/iter; left time: 2.5394s
Updating learning rate to 0.00014067047729681692
Epoch: 5 cost time: 0.49492883682250977
Epoch: 5, Steps: 123 | Train Loss: 0.7324029 Vali Loss: 0.6436955 Best vali loss: 0.6010160
	iters: 100, epoch: 6 | loss: 0.7581888
	speed: 0.0067s/iter; left time: 1.8128s
Updating learning rate to 6.674278813760351e-05
Epoch: 6 cost time: 0.49723172187805176
Epoch: 6, Steps: 123 | Train Loss: 0.7581888 Vali Loss: 0.6404023 Best vali loss: 0.6010160
	iters: 100, epoch: 7 | loss: 0.5878969
	speed: 0.0066s/iter; left time: 0.9661s
Updating learning rate to 1.7345885490678965e-05
Epoch: 7 cost time: 0.5087804794311523
Epoch: 7, Steps: 123 | Train Loss: 0.5878969 Vali Loss: 0.6423250 Best vali loss: 0.6010160
	iters: 100, epoch: 8 | loss: 0.5155281
	speed: 0.0067s/iter; left time: 0.1615s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.502316951751709
Epoch: 8, Steps: 123 | Train Loss: 0.5155281 Vali Loss: 0.6414241 Best vali loss: 0.6010160

best validation loss 0.6010159978928361

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0087638459994, 'e_layers': 3, 'learning_rate': 0.0028419691014, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7152790
	speed: 0.0105s/iter; left time: 81.3010s
	iters: 200, epoch: 1 | loss: 0.9262007
	speed: 0.0043s/iter; left time: 32.5988s
	iters: 300, epoch: 1 | loss: 0.5624151
	speed: 0.0042s/iter; left time: 31.8933s
	iters: 400, epoch: 1 | loss: 0.7842407
	speed: 0.0043s/iter; left time: 31.7824s
	iters: 500, epoch: 1 | loss: 0.3428751
	speed: 0.0045s/iter; left time: 32.9265s
	iters: 600, epoch: 1 | loss: 0.5428765
	speed: 0.0045s/iter; left time: 32.6651s
	iters: 700, epoch: 1 | loss: 0.6573610
	speed: 0.0045s/iter; left time: 31.8315s
	iters: 800, epoch: 1 | loss: 1.6301090
	speed: 0.0044s/iter; left time: 31.1773s
	iters: 900, epoch: 1 | loss: 1.6444386
	speed: 0.0045s/iter; left time: 31.2994s
Updating learning rate to 0.0028419691014
Validation loss decreased (inf --> 0.6730).  Saving model state dict ...
Epoch: 1 cost time: 4.616171836853027
Epoch: 1, Steps: 979 | Train Loss: 0.8673106 Vali Loss: 0.6730189 Best vali loss: 0.6730189
	iters: 100, epoch: 2 | loss: 1.4099518
	speed: 0.0134s/iter; left time: 90.1726s
	iters: 200, epoch: 2 | loss: 2.1019213
	speed: 0.0041s/iter; left time: 27.5862s
	iters: 300, epoch: 2 | loss: 2.1367359
	speed: 0.0041s/iter; left time: 26.9549s
	iters: 400, epoch: 2 | loss: 0.9080774
	speed: 0.0040s/iter; left time: 25.6892s
	iters: 500, epoch: 2 | loss: 0.8680776
	speed: 0.0039s/iter; left time: 24.9236s
	iters: 600, epoch: 2 | loss: 1.5026155
	speed: 0.0040s/iter; left time: 24.9197s
	iters: 700, epoch: 2 | loss: 1.3665615
	speed: 0.0041s/iter; left time: 25.1996s
	iters: 800, epoch: 2 | loss: 0.3930846
	speed: 0.0043s/iter; left time: 26.3181s
	iters: 900, epoch: 2 | loss: 1.3613966
	speed: 0.0043s/iter; left time: 25.4696s
Updating learning rate to 0.0014209845507
Validation loss decreased (0.6730 --> 0.6385).  Saving model state dict ...
Epoch: 2 cost time: 4.058071136474609
Epoch: 2, Steps: 979 | Train Loss: 1.3387136 Vali Loss: 0.6385492 Best vali loss: 0.6385492
	iters: 100, epoch: 3 | loss: 0.7429568
	speed: 0.0141s/iter; left time: 81.3762s
	iters: 200, epoch: 3 | loss: 1.5210100
	speed: 0.0045s/iter; left time: 25.2857s
	iters: 300, epoch: 3 | loss: 0.9983288
	speed: 0.0043s/iter; left time: 24.1004s
	iters: 400, epoch: 3 | loss: 1.7692610
	speed: 0.0043s/iter; left time: 23.6388s
	iters: 500, epoch: 3 | loss: 0.7173241
	speed: 0.0044s/iter; left time: 23.7818s
	iters: 600, epoch: 3 | loss: 0.7726339
	speed: 0.0042s/iter; left time: 22.1660s
	iters: 700, epoch: 3 | loss: 0.3147859
	speed: 0.0042s/iter; left time: 21.5402s
	iters: 800, epoch: 3 | loss: 0.7319394
	speed: 0.0041s/iter; left time: 20.8848s
	iters: 900, epoch: 3 | loss: 0.2976276
	speed: 0.0042s/iter; left time: 20.6944s
Updating learning rate to 0.00071049227535
Epoch: 3 cost time: 4.246239900588989
Epoch: 3, Steps: 979 | Train Loss: 0.8739853 Vali Loss: 0.6460558 Best vali loss: 0.6385492
	iters: 100, epoch: 4 | loss: 0.6424121
	speed: 0.0133s/iter; left time: 63.6038s
	iters: 200, epoch: 4 | loss: 0.9878765
	speed: 0.0038s/iter; left time: 18.0680s
	iters: 300, epoch: 4 | loss: 1.1553676
	speed: 0.0040s/iter; left time: 18.3223s
	iters: 400, epoch: 4 | loss: 1.7747161
	speed: 0.0040s/iter; left time: 18.0458s
	iters: 500, epoch: 4 | loss: 0.2918434
	speed: 0.0040s/iter; left time: 17.5712s
	iters: 600, epoch: 4 | loss: 0.4808031
	speed: 0.0041s/iter; left time: 17.7376s
	iters: 700, epoch: 4 | loss: 1.3482219
	speed: 0.0040s/iter; left time: 16.7879s
	iters: 800, epoch: 4 | loss: 1.3274887
	speed: 0.0040s/iter; left time: 16.3860s
	iters: 900, epoch: 4 | loss: 0.8261297
	speed: 0.0039s/iter; left time: 15.7761s
Updating learning rate to 0.000355246137675
Epoch: 4 cost time: 3.9525017738342285
Epoch: 4, Steps: 979 | Train Loss: 0.9816510 Vali Loss: 0.6452348 Best vali loss: 0.6385492
	iters: 100, epoch: 5 | loss: 0.9044752
	speed: 0.0131s/iter; left time: 50.0785s
	iters: 200, epoch: 5 | loss: 0.7598736
	speed: 0.0041s/iter; left time: 15.1818s
	iters: 300, epoch: 5 | loss: 0.4117726
	speed: 0.0039s/iter; left time: 14.1076s
	iters: 400, epoch: 5 | loss: 0.7370386
	speed: 0.0039s/iter; left time: 13.5965s
	iters: 500, epoch: 5 | loss: 1.7919323
	speed: 0.0040s/iter; left time: 13.8243s
	iters: 600, epoch: 5 | loss: 1.2273004
	speed: 0.0041s/iter; left time: 13.6001s
	iters: 700, epoch: 5 | loss: 0.5425641
	speed: 0.0040s/iter; left time: 12.9026s
	iters: 800, epoch: 5 | loss: 0.7133352
	speed: 0.0041s/iter; left time: 12.6440s
	iters: 900, epoch: 5 | loss: 0.4657682
	speed: 0.0040s/iter; left time: 12.1164s
Updating learning rate to 0.0001776230688375
Epoch: 5 cost time: 3.987187385559082
Epoch: 5, Steps: 979 | Train Loss: 0.8393400 Vali Loss: 0.6438755 Best vali loss: 0.6385492
	iters: 100, epoch: 6 | loss: 0.9348164
	speed: 0.0134s/iter; left time: 38.0937s
	iters: 200, epoch: 6 | loss: 0.6476361
	speed: 0.0041s/iter; left time: 11.1674s
	iters: 300, epoch: 6 | loss: 1.0263176
	speed: 0.0040s/iter; left time: 10.6390s
	iters: 400, epoch: 6 | loss: 0.6280238
	speed: 0.0043s/iter; left time: 10.9268s
	iters: 500, epoch: 6 | loss: 1.1721596
	speed: 0.0043s/iter; left time: 10.4280s
	iters: 600, epoch: 6 | loss: 0.9246233
	speed: 0.0040s/iter; left time: 9.4462s
	iters: 700, epoch: 6 | loss: 0.9577829
	speed: 0.0039s/iter; left time: 8.7431s
	iters: 800, epoch: 6 | loss: 1.2862449
	speed: 0.0040s/iter; left time: 8.4613s
	iters: 900, epoch: 6 | loss: 0.6052021
	speed: 0.0042s/iter; left time: 8.5091s
Updating learning rate to 8.881153441875e-05
Epoch: 6 cost time: 4.060559034347534
Epoch: 6, Steps: 979 | Train Loss: 0.9092007 Vali Loss: 0.6394495 Best vali loss: 0.6385492
	iters: 100, epoch: 7 | loss: 1.1056972
	speed: 0.0135s/iter; left time: 25.0198s
	iters: 200, epoch: 7 | loss: 1.2793174
	speed: 0.0042s/iter; left time: 7.3967s
	iters: 300, epoch: 7 | loss: 0.7088817
	speed: 0.0042s/iter; left time: 6.9869s
	iters: 400, epoch: 7 | loss: 0.5312377
	speed: 0.0043s/iter; left time: 6.6807s
	iters: 500, epoch: 7 | loss: 0.8395677
	speed: 0.0041s/iter; left time: 5.9407s
	iters: 600, epoch: 7 | loss: 0.3351869
	speed: 0.0041s/iter; left time: 5.5177s
	iters: 700, epoch: 7 | loss: 1.0892947
	speed: 0.0042s/iter; left time: 5.2294s
	iters: 800, epoch: 7 | loss: 1.0310498
	speed: 0.0041s/iter; left time: 4.6951s
	iters: 900, epoch: 7 | loss: 2.0927870
	speed: 0.0042s/iter; left time: 4.4079s
Updating learning rate to 4.4405767209375e-05
Epoch: 7 cost time: 4.107018232345581
Epoch: 7, Steps: 979 | Train Loss: 1.0014467 Vali Loss: 0.6430484 Best vali loss: 0.6385492
	iters: 100, epoch: 8 | loss: 1.4470669
	speed: 0.0132s/iter; left time: 11.6286s
	iters: 200, epoch: 8 | loss: 0.5119269
	speed: 0.0043s/iter; left time: 3.3619s
	iters: 300, epoch: 8 | loss: 1.1135339
	speed: 0.0043s/iter; left time: 2.8957s
	iters: 400, epoch: 8 | loss: 1.0463803
	speed: 0.0043s/iter; left time: 2.4909s
	iters: 500, epoch: 8 | loss: 1.6809013
	speed: 0.0044s/iter; left time: 2.1037s
	iters: 600, epoch: 8 | loss: 1.8027873
	speed: 0.0043s/iter; left time: 1.6172s
	iters: 700, epoch: 8 | loss: 1.4462184
	speed: 0.0044s/iter; left time: 1.2330s
	iters: 800, epoch: 8 | loss: 0.7640934
	speed: 0.0043s/iter; left time: 0.7761s
	iters: 900, epoch: 8 | loss: 0.8891181
	speed: 0.0044s/iter; left time: 0.3557s
Updating learning rate to 2.22028836046875e-05
Epoch: 8 cost time: 4.284778833389282
Epoch: 8, Steps: 979 | Train Loss: 1.1891140 Vali Loss: 0.6434113 Best vali loss: 0.6385492

best validation loss 0.6385492446079457

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0013168615201, 'e_layers': 3, 'learning_rate': 0.0042758527854, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9161795
	speed: 0.0121s/iter; left time: 10.7280s
Updating learning rate to 0.004113112828931218
Validation loss decreased (inf --> 0.6541).  Saving model state dict ...
Epoch: 1 cost time: 1.0611672401428223
Epoch: 1, Steps: 123 | Train Loss: 0.9161795 Vali Loss: 0.6541272 Best vali loss: 0.6541272
	iters: 100, epoch: 2 | loss: 0.6849462
	speed: 0.0095s/iter; left time: 7.2664s
Updating learning rate to 0.003649668642655864
Validation loss decreased (0.6541 --> 0.6439).  Saving model state dict ...
Epoch: 2 cost time: 0.7729051113128662
Epoch: 2, Steps: 123 | Train Loss: 0.6849462 Vali Loss: 0.6438687 Best vali loss: 0.6438687
	iters: 100, epoch: 3 | loss: 1.1752126
	speed: 0.0096s/iter; left time: 6.1482s
Updating learning rate to 0.0029560754028023512
Validation loss decreased (0.6439 --> 0.6347).  Saving model state dict ...
Epoch: 3 cost time: 0.7451374530792236
Epoch: 3, Steps: 123 | Train Loss: 1.1752126 Vali Loss: 0.6347192 Best vali loss: 0.6347192

best validation loss 0.6347191790804053

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0027209560174, 'e_layers': 3, 'learning_rate': 0.0002769068271, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2442820
	speed: 0.0109s/iter; left time: 41.6119s
	iters: 200, epoch: 1 | loss: 0.6310584
	speed: 0.0045s/iter; left time: 16.6634s
	iters: 300, epoch: 1 | loss: 1.7145075
	speed: 0.0045s/iter; left time: 16.3781s
	iters: 400, epoch: 1 | loss: 0.5167097
	speed: 0.0046s/iter; left time: 16.1350s
Updating learning rate to 0.0002769068271
Validation loss decreased (inf --> 0.6169).  Saving model state dict ...
Epoch: 1 cost time: 2.5904922485351562
Epoch: 1, Steps: 490 | Train Loss: 1.0266394 Vali Loss: 0.6168546 Best vali loss: 0.6168546
	iters: 100, epoch: 2 | loss: 0.7826844
	speed: 0.0122s/iter; left time: 40.5324s
	iters: 200, epoch: 2 | loss: 0.5651805
	speed: 0.0040s/iter; left time: 12.9717s
	iters: 300, epoch: 2 | loss: 1.0889862
	speed: 0.0040s/iter; left time: 12.4213s
	iters: 400, epoch: 2 | loss: 1.5194844
	speed: 0.0043s/iter; left time: 13.0738s
Updating learning rate to 0.00013845341355
Validation loss decreased (0.6169 --> 0.6049).  Saving model state dict ...
Epoch: 2 cost time: 2.0855636596679688
Epoch: 2, Steps: 490 | Train Loss: 0.9890839 Vali Loss: 0.6048814 Best vali loss: 0.6048814
	iters: 100, epoch: 3 | loss: 0.7637369
	speed: 0.0128s/iter; left time: 36.4040s
	iters: 200, epoch: 3 | loss: 0.4215153
	speed: 0.0045s/iter; left time: 12.4396s
	iters: 300, epoch: 3 | loss: 0.6683847
	speed: 0.0046s/iter; left time: 12.0467s
	iters: 400, epoch: 3 | loss: 0.5255809
	speed: 0.0045s/iter; left time: 11.5510s
Updating learning rate to 6.9226706775e-05
Validation loss decreased (0.6049 --> 0.5986).  Saving model state dict ...
Epoch: 3 cost time: 2.277803421020508
Epoch: 3, Steps: 490 | Train Loss: 0.5948044 Vali Loss: 0.5986242 Best vali loss: 0.5986242

best validation loss 0.5986241657719574

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488717986, 'e_layers': 2, 'learning_rate': 0.0002971560091, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7743335
	speed: 0.0117s/iter; left time: 10.3841s
Updating learning rate to 0.00028584618193511387
Validation loss decreased (inf --> 0.6173).  Saving model state dict ...
Epoch: 1 cost time: 1.014578104019165
Epoch: 1, Steps: 123 | Train Loss: 0.7743335 Vali Loss: 0.6172986 Best vali loss: 0.6172986
	iters: 100, epoch: 2 | loss: 0.9469510
	speed: 0.0092s/iter; left time: 6.9846s
Updating learning rate to 0.00025363851910247074
Validation loss decreased (0.6173 --> 0.5783).  Saving model state dict ...
Epoch: 2 cost time: 0.7200682163238525
Epoch: 2, Steps: 123 | Train Loss: 0.9469510 Vali Loss: 0.5783429 Best vali loss: 0.5783429
	iters: 100, epoch: 3 | loss: 0.8475371
	speed: 0.0093s/iter; left time: 5.9216s
Updating learning rate to 0.00020543634530514996
Validation loss decreased (0.5783 --> 0.5560).  Saving model state dict ...
Epoch: 3 cost time: 0.7178685665130615
Epoch: 3, Steps: 123 | Train Loss: 0.8475371 Vali Loss: 0.5559900 Best vali loss: 0.5559900

best validation loss 0.5559899757604586

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488717986, 'e_layers': 2, 'learning_rate': 0.0002971560091, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5882829
	speed: 0.0120s/iter; left time: 6.1967s
Updating learning rate to 0.00014857800455
Validation loss decreased (0.5560 --> 0.5305).  Saving model state dict ...
Epoch: 4 cost time: 1.0123534202575684
Epoch: 4, Steps: 123 | Train Loss: 0.5882829 Vali Loss: 0.5305233 Best vali loss: 0.5305233
	iters: 100, epoch: 5 | loss: 0.8227034
	speed: 0.0094s/iter; left time: 3.6882s
Updating learning rate to 9.17196637948501e-05
Validation loss decreased (0.5305 --> 0.5299).  Saving model state dict ...
Epoch: 5 cost time: 0.721653938293457
Epoch: 5, Steps: 123 | Train Loss: 0.8227034 Vali Loss: 0.5299107 Best vali loss: 0.5299107
	iters: 100, epoch: 6 | loss: 0.7560461
	speed: 0.0093s/iter; left time: 2.5213s
Updating learning rate to 4.35174899975293e-05
Epoch: 6 cost time: 0.7191569805145264
Epoch: 6, Steps: 123 | Train Loss: 0.7560461 Vali Loss: 0.5415565 Best vali loss: 0.5299107
	iters: 100, epoch: 7 | loss: 0.4253629
	speed: 0.0090s/iter; left time: 1.3212s
Updating learning rate to 1.1309827164886166e-05
Epoch: 7 cost time: 0.722477912902832
Epoch: 7, Steps: 123 | Train Loss: 0.4253629 Vali Loss: 0.5490737 Best vali loss: 0.5299107
	iters: 100, epoch: 8 | loss: 0.5028193
	speed: 0.0089s/iter; left time: 0.2139s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7180938720703125
Epoch: 8, Steps: 123 | Train Loss: 0.5028193 Vali Loss: 0.5494899 Best vali loss: 0.5299107

best validation loss 0.5299107071869024

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0040217629745, 'e_layers': 3, 'learning_rate': 0.0001136902273, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1135534
	speed: 0.0111s/iter; left time: 20.5920s
	iters: 200, epoch: 1 | loss: 1.3569763
	speed: 0.0050s/iter; left time: 8.7341s
Updating learning rate to 0.00010936315067451298
Validation loss decreased (inf --> 0.6578).  Saving model state dict ...
Epoch: 1 cost time: 1.5552356243133545
Epoch: 1, Steps: 245 | Train Loss: 1.2352648 Vali Loss: 0.6578343 Best vali loss: 0.6578343
	iters: 100, epoch: 2 | loss: 0.8190473
	speed: 0.0094s/iter; left time: 15.1507s
	iters: 200, epoch: 2 | loss: 0.8933811
	speed: 0.0047s/iter; left time: 7.1394s
Updating learning rate to 9.704067898923497e-05
Validation loss decreased (0.6578 --> 0.6350).  Saving model state dict ...
Epoch: 2 cost time: 1.1832313537597656
Epoch: 2, Steps: 245 | Train Loss: 0.8562142 Vali Loss: 0.6350006 Best vali loss: 0.6350006
	iters: 100, epoch: 3 | loss: 0.7266468
	speed: 0.0092s/iter; left time: 12.6200s
	iters: 200, epoch: 3 | loss: 0.5337321
	speed: 0.0047s/iter; left time: 5.9533s
Updating learning rate to 7.859879685476563e-05
Validation loss decreased (0.6350 --> 0.6230).  Saving model state dict ...
Epoch: 3 cost time: 1.176321268081665
Epoch: 3, Steps: 245 | Train Loss: 0.6301894 Vali Loss: 0.6230308 Best vali loss: 0.6230308
	iters: 100, epoch: 4 | loss: 0.9994867
	speed: 0.0089s/iter; left time: 10.0342s
	iters: 200, epoch: 4 | loss: 0.7542463
	speed: 0.0044s/iter; left time: 4.4994s
Updating learning rate to 5.684511365e-05
Validation loss decreased (0.6230 --> 0.6182).  Saving model state dict ...
Epoch: 4 cost time: 1.107968807220459
Epoch: 4, Steps: 245 | Train Loss: 0.8768665 Vali Loss: 0.6181730 Best vali loss: 0.6181730
	iters: 100, epoch: 5 | loss: 0.9449621
	speed: 0.0090s/iter; left time: 7.8927s
	iters: 200, epoch: 5 | loss: 1.1136473
	speed: 0.0043s/iter; left time: 3.3776s
Updating learning rate to 3.509143044523439e-05
Validation loss decreased (0.6182 --> 0.6173).  Saving model state dict ...
Epoch: 5 cost time: 1.1060516834259033
Epoch: 5, Steps: 245 | Train Loss: 1.0293047 Vali Loss: 0.6173405 Best vali loss: 0.6173405
	iters: 100, epoch: 6 | loss: 0.8441729
	speed: 0.0091s/iter; left time: 5.8150s
	iters: 200, epoch: 6 | loss: 0.9356313
	speed: 0.0047s/iter; left time: 2.5166s
Updating learning rate to 1.664954831076503e-05
Validation loss decreased (0.6173 --> 0.6115).  Saving model state dict ...
Epoch: 6 cost time: 1.1977777481079102
Epoch: 6, Steps: 245 | Train Loss: 0.8899021 Vali Loss: 0.6114879 Best vali loss: 0.6114879
	iters: 100, epoch: 7 | loss: 1.0657700
	speed: 0.0092s/iter; left time: 3.5792s
	iters: 200, epoch: 7 | loss: 1.0795349
	speed: 0.0049s/iter; left time: 1.4302s
Updating learning rate to 4.327076625487035e-06
Validation loss decreased (0.6115 --> 0.6115).  Saving model state dict ...
Epoch: 7 cost time: 1.2124378681182861
Epoch: 7, Steps: 245 | Train Loss: 1.0726525 Vali Loss: 0.6114617 Best vali loss: 0.6114617
	iters: 100, epoch: 8 | loss: 1.0509439
	speed: 0.0097s/iter; left time: 1.4106s
	iters: 200, epoch: 8 | loss: 0.6334321
	speed: 0.0048s/iter; left time: 0.2188s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1937429904937744
Epoch: 8, Steps: 245 | Train Loss: 0.8421880 Vali Loss: 0.6119693 Best vali loss: 0.6114617

best validation loss 0.6114617336105275

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0036575021959, 'e_layers': 4, 'learning_rate': 0.0004692897956, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1603546
	speed: 0.0114s/iter; left time: 43.4522s
	iters: 200, epoch: 1 | loss: 0.4627840
	speed: 0.0052s/iter; left time: 19.4699s
	iters: 300, epoch: 1 | loss: 0.5734513
	speed: 0.0053s/iter; left time: 19.1111s
	iters: 400, epoch: 1 | loss: 0.8496772
	speed: 0.0052s/iter; left time: 18.3189s
Updating learning rate to 0.0004514285162856227
Validation loss decreased (inf --> 0.6367).  Saving model state dict ...
Epoch: 1 cost time: 2.896864414215088
Epoch: 1, Steps: 490 | Train Loss: 0.7615668 Vali Loss: 0.6367485 Best vali loss: 0.6367485
	iters: 100, epoch: 2 | loss: 0.8362245
	speed: 0.0134s/iter; left time: 44.5991s
	iters: 200, epoch: 2 | loss: 0.7505857
	speed: 0.0046s/iter; left time: 14.7726s
	iters: 300, epoch: 2 | loss: 0.3818011
	speed: 0.0049s/iter; left time: 15.3418s
	iters: 400, epoch: 2 | loss: 0.3349721
	speed: 0.0049s/iter; left time: 14.8670s
Updating learning rate to 0.0004005638962052044
Epoch: 2 cost time: 2.372572422027588
Epoch: 2, Steps: 490 | Train Loss: 0.5758959 Vali Loss: 0.6477791 Best vali loss: 0.6367485
	iters: 100, epoch: 3 | loss: 0.7308232
	speed: 0.0130s/iter; left time: 36.9951s
	iters: 200, epoch: 3 | loss: 0.8910480
	speed: 0.0048s/iter; left time: 13.0266s
	iters: 300, epoch: 3 | loss: 1.2835113
	speed: 0.0049s/iter; left time: 13.0680s
	iters: 400, epoch: 3 | loss: 1.2831514
	speed: 0.0050s/iter; left time: 12.6968s
Updating learning rate to 0.00032443961267705974
Epoch: 3 cost time: 2.458253860473633
Epoch: 3, Steps: 490 | Train Loss: 1.0471335 Vali Loss: 0.6579121 Best vali loss: 0.6367485
	iters: 100, epoch: 4 | loss: 0.6259269
	speed: 0.0134s/iter; left time: 31.5598s
	iters: 200, epoch: 4 | loss: 1.2638726
	speed: 0.0052s/iter; left time: 11.6352s
	iters: 300, epoch: 4 | loss: 0.7133144
	speed: 0.0050s/iter; left time: 10.7246s
	iters: 400, epoch: 4 | loss: 1.1015254
	speed: 0.0049s/iter; left time: 10.1232s
Updating learning rate to 0.0002346448978
Epoch: 4 cost time: 2.490556478500366
Epoch: 4, Steps: 490 | Train Loss: 0.9261598 Vali Loss: 0.6408526 Best vali loss: 0.6367485
	iters: 100, epoch: 5 | loss: 0.7081992
	speed: 0.0133s/iter; left time: 24.8207s
	iters: 200, epoch: 5 | loss: 0.5434695
	speed: 0.0050s/iter; left time: 8.7651s
	iters: 300, epoch: 5 | loss: 1.0332415
	speed: 0.0050s/iter; left time: 8.2646s
	iters: 400, epoch: 5 | loss: 0.3490322
	speed: 0.0050s/iter; left time: 7.8239s
Updating learning rate to 0.0001448501829229403
Epoch: 5 cost time: 2.505540609359741
Epoch: 5, Steps: 490 | Train Loss: 0.6584856 Vali Loss: 0.6528982 Best vali loss: 0.6367485
	iters: 100, epoch: 6 | loss: 1.1664686
	speed: 0.0140s/iter; left time: 19.1401s
	iters: 200, epoch: 6 | loss: 0.8478541
	speed: 0.0053s/iter; left time: 6.7633s
	iters: 300, epoch: 6 | loss: 1.0866785
	speed: 0.0050s/iter; left time: 5.8863s
	iters: 400, epoch: 6 | loss: 0.8353193
	speed: 0.0050s/iter; left time: 5.4071s
Updating learning rate to 6.872589939479561e-05
Epoch: 6 cost time: 2.6037981510162354
Epoch: 6, Steps: 490 | Train Loss: 0.9840801 Vali Loss: 0.6466889 Best vali loss: 0.6367485
	iters: 100, epoch: 7 | loss: 1.1808276
	speed: 0.0138s/iter; left time: 12.1238s
	iters: 200, epoch: 7 | loss: 1.4013996
	speed: 0.0050s/iter; left time: 3.9073s
	iters: 300, epoch: 7 | loss: 0.5440142
	speed: 0.0050s/iter; left time: 3.4177s
	iters: 400, epoch: 7 | loss: 1.3841530
	speed: 0.0050s/iter; left time: 2.9051s
Updating learning rate to 1.7861279314377346e-05
Epoch: 7 cost time: 2.531654119491577
Epoch: 7, Steps: 490 | Train Loss: 1.1275986 Vali Loss: 0.6460844 Best vali loss: 0.6367485
	iters: 100, epoch: 8 | loss: 0.9355645
	speed: 0.0138s/iter; left time: 5.4118s
	iters: 200, epoch: 8 | loss: 1.0473678
	speed: 0.0053s/iter; left time: 1.5288s
	iters: 300, epoch: 8 | loss: 1.1795571
	speed: 0.0056s/iter; left time: 1.0670s
	iters: 400, epoch: 8 | loss: 0.6113578
	speed: 0.0056s/iter; left time: 0.5091s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.732438087463379
Epoch: 8, Steps: 490 | Train Loss: 0.9434618 Vali Loss: 0.6436903 Best vali loss: 0.6367485

best validation loss 0.6367484510689629

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010634996259, 'e_layers': 1, 'learning_rate': 0.000469449472, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004515821153645152
Validation loss decreased (inf --> 0.6009).  Saving model state dict ...
Epoch: 1 cost time: 0.6677849292755127
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6009371 Best vali loss: 0.6009371
Updating learning rate to 0.0004007001885378221
Epoch: 2 cost time: 0.431809663772583
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6202221 Best vali loss: 0.6009371
Updating learning rate to 0.00032455000363346956
Epoch: 3 cost time: 0.42095446586608887
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6134596 Best vali loss: 0.6009371

best validation loss 0.6009371436232497

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002950987616, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7741448
	speed: 0.0116s/iter; left time: 10.2868s
Updating learning rate to 0.00028386723375583385
Validation loss decreased (inf --> 0.6172).  Saving model state dict ...
Epoch: 1 cost time: 1.0156903266906738
Epoch: 1, Steps: 123 | Train Loss: 0.7741448 Vali Loss: 0.6171996 Best vali loss: 0.6171996
	iters: 100, epoch: 2 | loss: 0.9511067
	speed: 0.0093s/iter; left time: 7.0529s
Updating learning rate to 0.00025188254852355615
Validation loss decreased (0.6172 --> 0.5660).  Saving model state dict ...
Epoch: 2 cost time: 0.7201950550079346
Epoch: 2, Steps: 123 | Train Loss: 0.9511067 Vali Loss: 0.5659615 Best vali loss: 0.5659615
	iters: 100, epoch: 3 | loss: 0.8528759
	speed: 0.0093s/iter; left time: 5.9493s
Updating learning rate to 0.00020401408428788768
Validation loss decreased (0.5660 --> 0.5625).  Saving model state dict ...
Epoch: 3 cost time: 0.7153983116149902
Epoch: 3, Steps: 123 | Train Loss: 0.8528759 Vali Loss: 0.5625016 Best vali loss: 0.5625016

best validation loss 0.5625016127455736

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0035633589585, 'e_layers': 3, 'learning_rate': 0.0004678209792, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5178509
	speed: 0.0119s/iter; left time: 22.1389s
	iters: 200, epoch: 1 | loss: 0.6040118
	speed: 0.0056s/iter; left time: 9.8797s
Updating learning rate to 0.0004500156033811342
Validation loss decreased (inf --> 0.6083).  Saving model state dict ...
Epoch: 1 cost time: 1.7284026145935059
Epoch: 1, Steps: 245 | Train Loss: 0.5609314 Vali Loss: 0.6083381 Best vali loss: 0.6083381
	iters: 100, epoch: 2 | loss: 0.7193554
	speed: 0.0115s/iter; left time: 18.5935s
	iters: 200, epoch: 2 | loss: 0.9856829
	speed: 0.0057s/iter; left time: 8.6464s
Updating learning rate to 0.00039931018298682534
Epoch: 2 cost time: 1.4297661781311035
Epoch: 2, Steps: 245 | Train Loss: 0.8525192 Vali Loss: 0.6300412 Best vali loss: 0.6083381
	iters: 100, epoch: 3 | loss: 0.7810902
	speed: 0.0112s/iter; left time: 15.3809s
	iters: 200, epoch: 3 | loss: 0.7253560
	speed: 0.0057s/iter; left time: 7.2288s
Updating learning rate to 0.00032342415862632665
Epoch: 3 cost time: 1.437272310256958
Epoch: 3, Steps: 245 | Train Loss: 0.7532231 Vali Loss: 0.6109541 Best vali loss: 0.6083381

best validation loss 0.6083381459261741

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010488724824, 'e_layers': 2, 'learning_rate': 0.0002950987616, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5884134
	speed: 0.0120s/iter; left time: 6.1693s
Updating learning rate to 0.0001475493808
Validation loss decreased (0.5625 --> 0.5375).  Saving model state dict ...
Epoch: 4 cost time: 1.0092341899871826
Epoch: 4, Steps: 123 | Train Loss: 0.5884134 Vali Loss: 0.5375189 Best vali loss: 0.5375189
	iters: 100, epoch: 5 | loss: 0.8265796
	speed: 0.0094s/iter; left time: 3.7014s
Updating learning rate to 9.108467731211233e-05
Validation loss decreased (0.5375 --> 0.5306).  Saving model state dict ...
Epoch: 5 cost time: 0.7212369441986084
Epoch: 5, Steps: 123 | Train Loss: 0.8265796 Vali Loss: 0.5306255 Best vali loss: 0.5306255
	iters: 100, epoch: 6 | loss: 0.7616926
	speed: 0.0092s/iter; left time: 2.4794s
Updating learning rate to 4.321621307644383e-05
Epoch: 6 cost time: 0.7105131149291992
Epoch: 6, Steps: 123 | Train Loss: 0.7616926 Vali Loss: 0.5347808 Best vali loss: 0.5306255
	iters: 100, epoch: 7 | loss: 0.4298344
	speed: 0.0089s/iter; left time: 1.3066s
Updating learning rate to 1.1231527844166172e-05
Epoch: 7 cost time: 0.7150602340698242
Epoch: 7, Steps: 123 | Train Loss: 0.4298344 Vali Loss: 0.5395383 Best vali loss: 0.5306255
	iters: 100, epoch: 8 | loss: 0.5088400
	speed: 0.0091s/iter; left time: 0.2183s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.727973222732544
Epoch: 8, Steps: 123 | Train Loss: 0.5088400 Vali Loss: 0.5423260 Best vali loss: 0.5306255

best validation loss 0.5306255065804552

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010551920418, 'e_layers': 2, 'learning_rate': 0.0001830788228, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8470655
	speed: 0.0093s/iter; left time: 71.6309s
	iters: 200, epoch: 1 | loss: 0.8704776
	speed: 0.0033s/iter; left time: 25.3717s
	iters: 300, epoch: 1 | loss: 0.5342785
	speed: 0.0033s/iter; left time: 25.0509s
	iters: 400, epoch: 1 | loss: 1.3903712
	speed: 0.0034s/iter; left time: 25.3925s
	iters: 500, epoch: 1 | loss: 1.1532993
	speed: 0.0033s/iter; left time: 24.4144s
	iters: 600, epoch: 1 | loss: 0.6215404
	speed: 0.0034s/iter; left time: 24.8818s
	iters: 700, epoch: 1 | loss: 0.9768733
	speed: 0.0033s/iter; left time: 23.2000s
	iters: 800, epoch: 1 | loss: 1.5226414
	speed: 0.0032s/iter; left time: 22.2200s
	iters: 900, epoch: 1 | loss: 0.8826218
	speed: 0.0031s/iter; left time: 21.4604s
Updating learning rate to 0.00017611080001059035
Validation loss decreased (inf --> 0.5558).  Saving model state dict ...
Epoch: 1 cost time: 3.545400619506836
Epoch: 1, Steps: 979 | Train Loss: 0.9776855 Vali Loss: 0.5558241 Best vali loss: 0.5558241
	iters: 100, epoch: 2 | loss: 1.5241764
	speed: 0.0107s/iter; left time: 71.9798s
	iters: 200, epoch: 2 | loss: 0.8241650
	speed: 0.0030s/iter; left time: 20.2939s
	iters: 300, epoch: 2 | loss: 0.5826238
	speed: 0.0031s/iter; left time: 20.5260s
	iters: 400, epoch: 2 | loss: 1.0589778
	speed: 0.0031s/iter; left time: 20.1777s
	iters: 500, epoch: 2 | loss: 0.9642031
	speed: 0.0031s/iter; left time: 19.8487s
	iters: 600, epoch: 2 | loss: 0.6588452
	speed: 0.0032s/iter; left time: 19.7228s
	iters: 700, epoch: 2 | loss: 0.7907078
	speed: 0.0031s/iter; left time: 18.8604s
	iters: 800, epoch: 2 | loss: 0.7259043
	speed: 0.0031s/iter; left time: 18.9725s
	iters: 900, epoch: 2 | loss: 0.6161994
	speed: 0.0031s/iter; left time: 18.3518s
Updating learning rate to 0.00015626754994676513
Epoch: 2 cost time: 3.0776445865631104
Epoch: 2, Steps: 979 | Train Loss: 0.8606448 Vali Loss: 0.5907136 Best vali loss: 0.5558241
	iters: 100, epoch: 3 | loss: 0.4800735
	speed: 0.0107s/iter; left time: 61.5544s
	iters: 200, epoch: 3 | loss: 0.9152915
	speed: 0.0031s/iter; left time: 17.3277s
	iters: 300, epoch: 3 | loss: 0.6030893
	speed: 0.0031s/iter; left time: 17.1536s
	iters: 400, epoch: 3 | loss: 0.9384750
	speed: 0.0030s/iter; left time: 16.1973s
	iters: 500, epoch: 3 | loss: 0.6936730
	speed: 0.0029s/iter; left time: 15.8107s
	iters: 600, epoch: 3 | loss: 0.2765027
	speed: 0.0033s/iter; left time: 17.2364s
	iters: 700, epoch: 3 | loss: 0.3193242
	speed: 0.0031s/iter; left time: 15.9728s
	iters: 800, epoch: 3 | loss: 1.2242883
	speed: 0.0033s/iter; left time: 16.6987s
	iters: 900, epoch: 3 | loss: 0.5501813
	speed: 0.0030s/iter; left time: 14.7633s
Updating learning rate to 0.00012657002755123202
Validation loss decreased (0.5558 --> 0.5492).  Saving model state dict ...
Epoch: 3 cost time: 3.0571165084838867
Epoch: 3, Steps: 979 | Train Loss: 0.6667665 Vali Loss: 0.5491946 Best vali loss: 0.5491946
	iters: 100, epoch: 4 | loss: 1.5885459
	speed: 0.0114s/iter; left time: 54.6959s
	iters: 200, epoch: 4 | loss: 0.6566049
	speed: 0.0032s/iter; left time: 15.0562s
	iters: 300, epoch: 4 | loss: 0.3037586
	speed: 0.0031s/iter; left time: 14.2474s
	iters: 400, epoch: 4 | loss: 0.9000310
	speed: 0.0030s/iter; left time: 13.2816s
	iters: 500, epoch: 4 | loss: 0.7055749
	speed: 0.0031s/iter; left time: 13.6768s
	iters: 600, epoch: 4 | loss: 0.2401056
	speed: 0.0030s/iter; left time: 12.6902s
	iters: 700, epoch: 4 | loss: 0.5332188
	speed: 0.0033s/iter; left time: 13.6652s
	iters: 800, epoch: 4 | loss: 0.7413229
	speed: 0.0030s/iter; left time: 12.2690s
	iters: 900, epoch: 4 | loss: 0.3663343
	speed: 0.0030s/iter; left time: 12.0846s
Updating learning rate to 9.15394114e-05
Validation loss decreased (0.5492 --> 0.5404).  Saving model state dict ...
Epoch: 4 cost time: 3.0665807723999023
Epoch: 4, Steps: 979 | Train Loss: 0.6706108 Vali Loss: 0.5403587 Best vali loss: 0.5403587
	iters: 100, epoch: 5 | loss: 0.2670242
	speed: 0.0113s/iter; left time: 42.9470s
	iters: 200, epoch: 5 | loss: 1.0743070
	speed: 0.0030s/iter; left time: 11.1332s
	iters: 300, epoch: 5 | loss: 0.8739469
	speed: 0.0029s/iter; left time: 10.6256s
	iters: 400, epoch: 5 | loss: 0.3628569
	speed: 0.0030s/iter; left time: 10.4435s
	iters: 500, epoch: 5 | loss: 0.8498126
	speed: 0.0031s/iter; left time: 10.4800s
	iters: 600, epoch: 5 | loss: 0.4064536
	speed: 0.0030s/iter; left time: 10.0064s
	iters: 700, epoch: 5 | loss: 0.2576457
	speed: 0.0030s/iter; left time: 9.6713s
	iters: 800, epoch: 5 | loss: 0.2299507
	speed: 0.0030s/iter; left time: 9.4584s
	iters: 900, epoch: 5 | loss: 0.5349028
	speed: 0.0030s/iter; left time: 9.1412s
Updating learning rate to 5.6508795248767976e-05
Epoch: 5 cost time: 3.0172085762023926
Epoch: 5, Steps: 979 | Train Loss: 0.5396556 Vali Loss: 0.5510777 Best vali loss: 0.5403587
	iters: 100, epoch: 6 | loss: 0.3829017
	speed: 0.0107s/iter; left time: 30.3669s
	iters: 200, epoch: 6 | loss: 0.6245300
	speed: 0.0033s/iter; left time: 9.1411s
	iters: 300, epoch: 6 | loss: 1.2670053
	speed: 0.0032s/iter; left time: 8.4060s
	iters: 400, epoch: 6 | loss: 0.5861834
	speed: 0.0031s/iter; left time: 7.9202s
	iters: 500, epoch: 6 | loss: 0.2285775
	speed: 0.0030s/iter; left time: 7.4282s
	iters: 600, epoch: 6 | loss: 0.6585721
	speed: 0.0030s/iter; left time: 7.0749s
	iters: 700, epoch: 6 | loss: 0.6238270
	speed: 0.0030s/iter; left time: 6.7809s
	iters: 800, epoch: 6 | loss: 0.3486003
	speed: 0.0031s/iter; left time: 6.6577s
	iters: 900, epoch: 6 | loss: 0.2446850
	speed: 0.0031s/iter; left time: 6.3643s
Updating learning rate to 2.681127285323485e-05
Epoch: 6 cost time: 3.111240863800049
Epoch: 6, Steps: 979 | Train Loss: 0.5516536 Vali Loss: 0.5745650 Best vali loss: 0.5403587
	iters: 100, epoch: 7 | loss: 0.5185072
	speed: 0.0108s/iter; left time: 20.1101s
	iters: 200, epoch: 7 | loss: 0.7908675
	speed: 0.0032s/iter; left time: 5.6797s
	iters: 300, epoch: 7 | loss: 0.2973191
	speed: 0.0033s/iter; left time: 5.4154s
	iters: 400, epoch: 7 | loss: 0.4072426
	speed: 0.0032s/iter; left time: 4.9524s
	iters: 500, epoch: 7 | loss: 0.2139892
	speed: 0.0031s/iter; left time: 4.5037s
	iters: 600, epoch: 7 | loss: 0.2342059
	speed: 0.0031s/iter; left time: 4.2268s
	iters: 700, epoch: 7 | loss: 0.4687339
	speed: 0.0032s/iter; left time: 3.9748s
	iters: 800, epoch: 7 | loss: 0.2351581
	speed: 0.0033s/iter; left time: 3.8411s
	iters: 900, epoch: 7 | loss: 1.0185571
	speed: 0.0036s/iter; left time: 3.8346s
Updating learning rate to 6.968022789409648e-06
Epoch: 7 cost time: 3.2248668670654297
Epoch: 7, Steps: 979 | Train Loss: 0.4649534 Vali Loss: 0.5754285 Best vali loss: 0.5403587
	iters: 100, epoch: 8 | loss: 0.6523200
	speed: 0.0113s/iter; left time: 9.9070s
	iters: 200, epoch: 8 | loss: 0.3920082
	speed: 0.0032s/iter; left time: 2.5306s
	iters: 300, epoch: 8 | loss: 0.2070886
	speed: 0.0032s/iter; left time: 2.1950s
	iters: 400, epoch: 8 | loss: 0.4169129
	speed: 0.0033s/iter; left time: 1.9031s
	iters: 500, epoch: 8 | loss: 0.6267642
	speed: 0.0032s/iter; left time: 1.5352s
	iters: 600, epoch: 8 | loss: 0.6878625
	speed: 0.0033s/iter; left time: 1.2490s
	iters: 700, epoch: 8 | loss: 0.7889201
	speed: 0.0033s/iter; left time: 0.9277s
	iters: 800, epoch: 8 | loss: 0.2985725
	speed: 0.0032s/iter; left time: 0.5739s
	iters: 900, epoch: 8 | loss: 1.4051621
	speed: 0.0032s/iter; left time: 0.2589s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.223588705062866
Epoch: 8, Steps: 979 | Train Loss: 0.6084012 Vali Loss: 0.5774985 Best vali loss: 0.5403587

best validation loss 0.5403586621777651

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008349132347, 'e_layers': 2, 'learning_rate': 8.06886738e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5078565
	speed: 0.0099s/iter; left time: 38.0149s
	iters: 200, epoch: 1 | loss: 1.1680942
	speed: 0.0038s/iter; left time: 14.0481s
	iters: 300, epoch: 1 | loss: 0.8982939
	speed: 0.0037s/iter; left time: 13.3082s
	iters: 400, epoch: 1 | loss: 0.9303937
	speed: 0.0036s/iter; left time: 12.6332s
Updating learning rate to 7.761764401464986e-05
Validation loss decreased (inf --> 0.6065).  Saving model state dict ...
Epoch: 1 cost time: 2.153149366378784
Epoch: 1, Steps: 490 | Train Loss: 1.1261595 Vali Loss: 0.6064854 Best vali loss: 0.6064854
	iters: 100, epoch: 2 | loss: 0.2906307
	speed: 0.0109s/iter; left time: 36.2020s
	iters: 200, epoch: 2 | loss: 1.0492891
	speed: 0.0035s/iter; left time: 11.1705s
	iters: 300, epoch: 2 | loss: 1.0622168
	speed: 0.0035s/iter; left time: 10.9073s
	iters: 400, epoch: 2 | loss: 0.3427409
	speed: 0.0036s/iter; left time: 10.9031s
Updating learning rate to 6.887209110446466e-05
Validation loss decreased (0.6065 --> 0.5588).  Saving model state dict ...
Epoch: 2 cost time: 1.7923643589019775
Epoch: 2, Steps: 490 | Train Loss: 0.6862194 Vali Loss: 0.5587956 Best vali loss: 0.5587956
	iters: 100, epoch: 3 | loss: 1.0049199
	speed: 0.0109s/iter; left time: 31.0079s
	iters: 200, epoch: 3 | loss: 0.9221805
	speed: 0.0034s/iter; left time: 9.4498s
	iters: 300, epoch: 3 | loss: 0.3583671
	speed: 0.0035s/iter; left time: 9.1637s
	iters: 400, epoch: 3 | loss: 1.5086212
	speed: 0.0034s/iter; left time: 8.6827s
Updating learning rate to 5.578344622138555e-05
Validation loss decreased (0.5588 --> 0.5498).  Saving model state dict ...
Epoch: 3 cost time: 1.7428090572357178
Epoch: 3, Steps: 490 | Train Loss: 0.9485222 Vali Loss: 0.5497724 Best vali loss: 0.5497724
	iters: 100, epoch: 4 | loss: 0.5189990
	speed: 0.0104s/iter; left time: 24.4454s
	iters: 200, epoch: 4 | loss: 0.7623916
	speed: 0.0034s/iter; left time: 7.7600s
	iters: 300, epoch: 4 | loss: 0.9437911
	speed: 0.0035s/iter; left time: 7.6226s
	iters: 400, epoch: 4 | loss: 0.5773010
	speed: 0.0035s/iter; left time: 7.1305s
Updating learning rate to 4.03443369e-05
Validation loss decreased (0.5498 --> 0.5455).  Saving model state dict ...
Epoch: 4 cost time: 1.7419376373291016
Epoch: 4, Steps: 490 | Train Loss: 0.7006207 Vali Loss: 0.5454639 Best vali loss: 0.5454639
	iters: 100, epoch: 5 | loss: 0.5090637
	speed: 0.0105s/iter; left time: 19.4992s
	iters: 200, epoch: 5 | loss: 0.6872622
	speed: 0.0037s/iter; left time: 6.5258s
	iters: 300, epoch: 5 | loss: 0.6432835
	speed: 0.0037s/iter; left time: 6.1808s
	iters: 400, epoch: 5 | loss: 0.8158900
	speed: 0.0037s/iter; left time: 5.8033s
Updating learning rate to 2.4905227578614458e-05
Validation loss decreased (0.5455 --> 0.5402).  Saving model state dict ...
Epoch: 5 cost time: 1.8460044860839844
Epoch: 5, Steps: 490 | Train Loss: 0.6638748 Vali Loss: 0.5401743 Best vali loss: 0.5401743
	iters: 100, epoch: 6 | loss: 0.6769395
	speed: 0.0108s/iter; left time: 14.7419s
	iters: 200, epoch: 6 | loss: 0.3560524
	speed: 0.0036s/iter; left time: 4.5461s
	iters: 300, epoch: 6 | loss: 1.5954804
	speed: 0.0035s/iter; left time: 4.0406s
	iters: 400, epoch: 6 | loss: 0.6096815
	speed: 0.0034s/iter; left time: 3.6474s
Updating learning rate to 1.1816582695535349e-05
Validation loss decreased (0.5402 --> 0.5348).  Saving model state dict ...
Epoch: 6 cost time: 1.764075756072998
Epoch: 6, Steps: 490 | Train Loss: 0.8095384 Vali Loss: 0.5348332 Best vali loss: 0.5348332
	iters: 100, epoch: 7 | loss: 0.9609298
	speed: 0.0107s/iter; left time: 9.4614s
	iters: 200, epoch: 7 | loss: 0.7985117
	speed: 0.0036s/iter; left time: 2.7872s
	iters: 300, epoch: 7 | loss: 0.7571377
	speed: 0.0035s/iter; left time: 2.3836s
	iters: 400, epoch: 7 | loss: 0.6586521
	speed: 0.0034s/iter; left time: 2.0025s
Updating learning rate to 3.071029785350145e-06
Validation loss decreased (0.5348 --> 0.5327).  Saving model state dict ...
Epoch: 7 cost time: 1.774899959564209
Epoch: 7, Steps: 490 | Train Loss: 0.7938078 Vali Loss: 0.5326928 Best vali loss: 0.5326928
	iters: 100, epoch: 8 | loss: 0.5437739
	speed: 0.0107s/iter; left time: 4.2008s
	iters: 200, epoch: 8 | loss: 0.6542127
	speed: 0.0037s/iter; left time: 1.0792s
	iters: 300, epoch: 8 | loss: 0.8261006
	speed: 0.0037s/iter; left time: 0.7056s
	iters: 400, epoch: 8 | loss: 0.7542303
	speed: 0.0037s/iter; left time: 0.3368s
Updating learning rate to 0.0
Validation loss decreased (0.5327 --> 0.5314).  Saving model state dict ...
Epoch: 8 cost time: 1.8360307216644287
Epoch: 8, Steps: 490 | Train Loss: 0.6945794 Vali Loss: 0.5313739 Best vali loss: 0.5313739

best validation loss 0.5313739454867608

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.004082556632, 'e_layers': 3, 'learning_rate': 0.0003933680372, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5505086
	speed: 0.0109s/iter; left time: 20.3656s
	iters: 200, epoch: 1 | loss: 0.7021500
	speed: 0.0049s/iter; left time: 8.6037s
Updating learning rate to 0.0003933680372
Validation loss decreased (inf --> 0.5759).  Saving model state dict ...
Epoch: 1 cost time: 1.5350098609924316
Epoch: 1, Steps: 245 | Train Loss: 0.6263293 Vali Loss: 0.5759254 Best vali loss: 0.5759254
	iters: 100, epoch: 2 | loss: 1.0069562
	speed: 0.0098s/iter; left time: 15.8071s
	iters: 200, epoch: 2 | loss: 0.6349422
	speed: 0.0049s/iter; left time: 7.4835s
Updating learning rate to 0.0001966840186
Validation loss decreased (0.5759 --> 0.5476).  Saving model state dict ...
Epoch: 2 cost time: 1.2694501876831055
Epoch: 2, Steps: 245 | Train Loss: 0.8209492 Vali Loss: 0.5475964 Best vali loss: 0.5475964
	iters: 100, epoch: 3 | loss: 0.5290956
	speed: 0.0098s/iter; left time: 13.4429s
	iters: 200, epoch: 3 | loss: 0.7138627
	speed: 0.0048s/iter; left time: 6.1112s
Updating learning rate to 9.83420093e-05
Validation loss decreased (0.5476 --> 0.5473).  Saving model state dict ...
Epoch: 3 cost time: 1.2331128120422363
Epoch: 3, Steps: 245 | Train Loss: 0.6214792 Vali Loss: 0.5472958 Best vali loss: 0.5472958

best validation loss 0.5472957592273079

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0077610628429, 'e_layers': 1, 'learning_rate': 0.0002573457511, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002573457511
Validation loss decreased (inf --> 0.6104).  Saving model state dict ...
Epoch: 1 cost time: 0.6867573261260986
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6104424 Best vali loss: 0.6104424
Updating learning rate to 0.00012867287555
Validation loss decreased (0.6104 --> 0.6087).  Saving model state dict ...
Epoch: 2 cost time: 0.4153099060058594
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6087261 Best vali loss: 0.6087261
Updating learning rate to 6.4336437775e-05
Validation loss decreased (0.6087 --> 0.6072).  Saving model state dict ...
Epoch: 3 cost time: 0.45200610160827637
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6072349 Best vali loss: 0.6072349

best validation loss 0.6072349390846775

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011444662604, 'e_layers': 1, 'learning_rate': 0.0002564110071, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3766839
	speed: 0.0086s/iter; left time: 66.7639s
	iters: 200, epoch: 1 | loss: 0.9688320
	speed: 0.0026s/iter; left time: 19.9669s
	iters: 300, epoch: 1 | loss: 0.8977842
	speed: 0.0026s/iter; left time: 19.7664s
	iters: 400, epoch: 1 | loss: 0.4093278
	speed: 0.0026s/iter; left time: 19.5853s
	iters: 500, epoch: 1 | loss: 0.4290842
	speed: 0.0026s/iter; left time: 19.2583s
	iters: 600, epoch: 1 | loss: 0.3742688
	speed: 0.0026s/iter; left time: 19.0088s
	iters: 700, epoch: 1 | loss: 0.5773336
	speed: 0.0026s/iter; left time: 18.7043s
	iters: 800, epoch: 1 | loss: 0.6865110
	speed: 0.0026s/iter; left time: 18.1201s
	iters: 900, epoch: 1 | loss: 1.1489768
	speed: 0.0024s/iter; left time: 16.4413s
Updating learning rate to 0.0002466519442351481
Validation loss decreased (inf --> 0.6019).  Saving model state dict ...
Epoch: 1 cost time: 2.8529443740844727
Epoch: 1, Steps: 979 | Train Loss: 0.6520891 Vali Loss: 0.6019079 Best vali loss: 0.6019079
	iters: 100, epoch: 2 | loss: 0.9262069
	speed: 0.0086s/iter; left time: 58.1894s
	iters: 200, epoch: 2 | loss: 0.4478310
	speed: 0.0022s/iter; left time: 14.6304s
	iters: 300, epoch: 2 | loss: 0.6568255
	speed: 0.0022s/iter; left time: 14.3429s
	iters: 400, epoch: 2 | loss: 0.5417275
	speed: 0.0022s/iter; left time: 14.4354s
	iters: 500, epoch: 2 | loss: 0.6678172
	speed: 0.0023s/iter; left time: 14.6274s
	iters: 600, epoch: 2 | loss: 0.9223053
	speed: 0.0023s/iter; left time: 14.1318s
	iters: 700, epoch: 2 | loss: 0.5278932
	speed: 0.0023s/iter; left time: 14.1250s
	iters: 800, epoch: 2 | loss: 0.9216197
	speed: 0.0024s/iter; left time: 14.2451s
	iters: 900, epoch: 2 | loss: 0.2824723
	speed: 0.0022s/iter; left time: 13.3542s
Updating learning rate to 0.00021886048449564098
Epoch: 2 cost time: 2.25510311126709
Epoch: 2, Steps: 979 | Train Loss: 0.6549665 Vali Loss: 0.6358990 Best vali loss: 0.6019079
	iters: 100, epoch: 3 | loss: 1.1379592
	speed: 0.0091s/iter; left time: 52.2906s
	iters: 200, epoch: 3 | loss: 0.3838689
	speed: 0.0026s/iter; left time: 14.8430s
	iters: 300, epoch: 3 | loss: 0.9422410
	speed: 0.0026s/iter; left time: 14.2728s
	iters: 400, epoch: 3 | loss: 0.7616924
	speed: 0.0025s/iter; left time: 13.5409s
	iters: 500, epoch: 3 | loss: 0.6497114
	speed: 0.0025s/iter; left time: 13.3385s
	iters: 600, epoch: 3 | loss: 1.0773981
	speed: 0.0025s/iter; left time: 13.2366s
	iters: 700, epoch: 3 | loss: 0.4992120
	speed: 0.0024s/iter; left time: 12.3524s
	iters: 800, epoch: 3 | loss: 0.9761055
	speed: 0.0024s/iter; left time: 12.1479s
	iters: 900, epoch: 3 | loss: 0.9112448
	speed: 0.0024s/iter; left time: 11.9701s
Updating learning rate to 0.00017726762569660872
Epoch: 3 cost time: 2.488321304321289
Epoch: 3, Steps: 979 | Train Loss: 0.8154926 Vali Loss: 0.6109995 Best vali loss: 0.6019079

best validation loss 0.6019079055238906

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.004082556632, 'e_layers': 3, 'learning_rate': 0.0003933680372, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5354223
	speed: 0.0110s/iter; left time: 12.4111s
	iters: 200, epoch: 4 | loss: 0.5648612
	speed: 0.0049s/iter; left time: 5.0381s
Updating learning rate to 4.917100465e-05
Epoch: 4 cost time: 1.5320336818695068
Epoch: 4, Steps: 245 | Train Loss: 0.5501417 Vali Loss: 0.5502177 Best vali loss: 0.5472958
	iters: 100, epoch: 5 | loss: 0.9506213
	speed: 0.0096s/iter; left time: 8.4232s
	iters: 200, epoch: 5 | loss: 0.5694308
	speed: 0.0049s/iter; left time: 3.8538s
Updating learning rate to 2.4585502325e-05
Epoch: 5 cost time: 1.2554998397827148
Epoch: 5, Steps: 245 | Train Loss: 0.7600261 Vali Loss: 0.5519849 Best vali loss: 0.5472958
	iters: 100, epoch: 6 | loss: 0.4951164
	speed: 0.0097s/iter; left time: 6.1939s
	iters: 200, epoch: 6 | loss: 0.6505954
	speed: 0.0045s/iter; left time: 2.4063s
Updating learning rate to 1.22927511625e-05
Epoch: 6 cost time: 1.1883697509765625
Epoch: 6, Steps: 245 | Train Loss: 0.5728559 Vali Loss: 0.5504813 Best vali loss: 0.5472958
	iters: 100, epoch: 7 | loss: 0.9118876
	speed: 0.0093s/iter; left time: 3.6379s
	iters: 200, epoch: 7 | loss: 0.8476973
	speed: 0.0049s/iter; left time: 1.4138s
Updating learning rate to 6.14637558125e-06
Epoch: 7 cost time: 1.2201318740844727
Epoch: 7, Steps: 245 | Train Loss: 0.8797925 Vali Loss: 0.5519103 Best vali loss: 0.5472958
	iters: 100, epoch: 8 | loss: 0.5836705
	speed: 0.0096s/iter; left time: 1.3983s
	iters: 200, epoch: 8 | loss: 0.5891005
	speed: 0.0048s/iter; left time: 0.2187s
Updating learning rate to 3.073187790625e-06
Epoch: 8 cost time: 1.2173044681549072
Epoch: 8, Steps: 245 | Train Loss: 0.5863855 Vali Loss: 0.5519846 Best vali loss: 0.5472958

best validation loss 0.5472957592273079

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.002950938541, 'e_layers': 2, 'learning_rate': 0.0001489773302, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0056977
	speed: 0.0107s/iter; left time: 9.4268s
Updating learning rate to 0.0001433072181899778
Validation loss decreased (inf --> 0.6058).  Saving model state dict ...
Epoch: 1 cost time: 0.8759779930114746
Epoch: 1, Steps: 123 | Train Loss: 1.0056977 Vali Loss: 0.6058016 Best vali loss: 0.6058016
	iters: 100, epoch: 2 | loss: 0.9755647
	speed: 0.0073s/iter; left time: 5.5867s
Updating learning rate to 0.00012716010531374372
Validation loss decreased (0.6058 --> 0.5955).  Saving model state dict ...
Epoch: 2 cost time: 0.5616145133972168
Epoch: 2, Steps: 123 | Train Loss: 0.9755647 Vali Loss: 0.5954539 Best vali loss: 0.5954539
	iters: 100, epoch: 3 | loss: 0.8846574
	speed: 0.0074s/iter; left time: 4.7442s
Updating learning rate to 0.00010299424313276168
Epoch: 3 cost time: 0.5852181911468506
Epoch: 3, Steps: 123 | Train Loss: 0.8846574 Vali Loss: 0.5974728 Best vali loss: 0.5954539
	iters: 100, epoch: 4 | loss: 0.7911245
	speed: 0.0071s/iter; left time: 3.6510s
Updating learning rate to 7.44886651e-05
Epoch: 4 cost time: 0.5539038181304932
Epoch: 4, Steps: 123 | Train Loss: 0.7911245 Vali Loss: 0.6139287 Best vali loss: 0.5954539
	iters: 100, epoch: 5 | loss: 0.8415318
	speed: 0.0072s/iter; left time: 2.8471s
Updating learning rate to 4.598308706723833e-05
Validation loss decreased (0.5955 --> 0.5924).  Saving model state dict ...
Epoch: 5 cost time: 0.5702304840087891
Epoch: 5, Steps: 123 | Train Loss: 0.8415318 Vali Loss: 0.5923901 Best vali loss: 0.5923901
	iters: 100, epoch: 6 | loss: 0.9395198
	speed: 0.0075s/iter; left time: 2.0197s
Updating learning rate to 2.1817224886256286e-05
Validation loss decreased (0.5924 --> 0.5764).  Saving model state dict ...
Epoch: 6 cost time: 0.5843660831451416
Epoch: 6, Steps: 123 | Train Loss: 0.9395198 Vali Loss: 0.5763627 Best vali loss: 0.5763627
	iters: 100, epoch: 7 | loss: 0.6641952
	speed: 0.0073s/iter; left time: 1.0800s
Updating learning rate to 5.6701120100222e-06
Epoch: 7 cost time: 0.5753071308135986
Epoch: 7, Steps: 123 | Train Loss: 0.6641952 Vali Loss: 0.5775473 Best vali loss: 0.5763627
	iters: 100, epoch: 8 | loss: 0.6822085
	speed: 0.0076s/iter; left time: 0.1826s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6022155284881592
Epoch: 8, Steps: 123 | Train Loss: 0.6822085 Vali Loss: 0.5767154 Best vali loss: 0.5763627

best validation loss 0.5763627370713431

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0093672507587, 'e_layers': 1, 'learning_rate': 0.0001806719352, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001806719352
Validation loss decreased (inf --> 0.6133).  Saving model state dict ...
Epoch: 1 cost time: 0.6919817924499512
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6132836 Best vali loss: 0.6132836
Updating learning rate to 9.03359676e-05
Validation loss decreased (0.6133 --> 0.6034).  Saving model state dict ...
Epoch: 2 cost time: 0.4516725540161133
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6034397 Best vali loss: 0.6034397
Updating learning rate to 4.51679838e-05
Validation loss decreased (0.6034 --> 0.5991).  Saving model state dict ...
Epoch: 3 cost time: 0.4405081272125244
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5990898 Best vali loss: 0.5990898
Updating learning rate to 2.25839919e-05
Epoch: 4 cost time: 0.4492764472961426
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6037503 Best vali loss: 0.5990898
Updating learning rate to 1.129199595e-05
Epoch: 5 cost time: 0.4540822505950928
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6028796 Best vali loss: 0.5990898
Updating learning rate to 5.645997975e-06
Epoch: 6 cost time: 0.4525156021118164
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6066154 Best vali loss: 0.5990898
Updating learning rate to 2.8229989875e-06
Epoch: 7 cost time: 0.4327888488769531
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6062359 Best vali loss: 0.5990898
Updating learning rate to 1.41149949375e-06
Epoch: 8 cost time: 0.4082458019256592
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6062209 Best vali loss: 0.5990898

best validation loss 0.5990898364785091

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010997728446, 'e_layers': 1, 'learning_rate': 0.0004703327515, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00045243177704028356
Validation loss decreased (inf --> 0.6010).  Saving model state dict ...
Epoch: 1 cost time: 0.6913630962371826
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6009599 Best vali loss: 0.6009599
Updating learning rate to 0.00040145411474988866
Epoch: 2 cost time: 0.4378044605255127
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6208520 Best vali loss: 0.6009599
Updating learning rate to 0.0003251606515988684
Epoch: 3 cost time: 0.44156694412231445
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6150173 Best vali loss: 0.6009599

best validation loss 0.600959942661905

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0034920265099, 'e_layers': 3, 'learning_rate': 9.51533052e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9376591
	speed: 0.0107s/iter; left time: 41.0168s
	iters: 200, epoch: 1 | loss: 0.5271105
	speed: 0.0046s/iter; left time: 17.0713s
	iters: 300, epoch: 1 | loss: 0.6551245
	speed: 0.0045s/iter; left time: 16.3000s
	iters: 400, epoch: 1 | loss: 0.6045800
	speed: 0.0042s/iter; left time: 14.7062s
Updating learning rate to 9.15317481625399e-05
Validation loss decreased (inf --> 0.6255).  Saving model state dict ...
Epoch: 1 cost time: 2.481023073196411
Epoch: 1, Steps: 490 | Train Loss: 0.6811185 Vali Loss: 0.6255367 Best vali loss: 0.6255367
	iters: 100, epoch: 2 | loss: 1.4554788
	speed: 0.0120s/iter; left time: 40.0358s
	iters: 200, epoch: 2 | loss: 0.8296998
	speed: 0.0046s/iter; left time: 14.9521s
	iters: 300, epoch: 2 | loss: 0.7463472
	speed: 0.0045s/iter; left time: 13.9966s
	iters: 400, epoch: 2 | loss: 0.8342487
	speed: 0.0045s/iter; left time: 13.5454s
Updating learning rate to 8.121842627961658e-05
Validation loss decreased (0.6255 --> 0.5931).  Saving model state dict ...
Epoch: 2 cost time: 2.2820699214935303
Epoch: 2, Steps: 490 | Train Loss: 0.9664436 Vali Loss: 0.5930804 Best vali loss: 0.5930804
	iters: 100, epoch: 3 | loss: 0.4305078
	speed: 0.0123s/iter; left time: 34.8752s
	iters: 200, epoch: 3 | loss: 0.7675576
	speed: 0.0045s/iter; left time: 12.2397s
	iters: 300, epoch: 3 | loss: 0.8398839
	speed: 0.0044s/iter; left time: 11.7157s
	iters: 400, epoch: 3 | loss: 0.4425661
	speed: 0.0045s/iter; left time: 11.5386s
Updating learning rate to 6.578344931740948e-05
Validation loss decreased (0.5931 --> 0.5637).  Saving model state dict ...
Epoch: 3 cost time: 2.2144198417663574
Epoch: 3, Steps: 490 | Train Loss: 0.6201289 Vali Loss: 0.5636537 Best vali loss: 0.5636537

best validation loss 0.5636537179854224

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0034990532996, 'e_layers': 2, 'learning_rate': 9.51778117e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0508726
	speed: 0.0097s/iter; left time: 37.0667s
	iters: 200, epoch: 1 | loss: 0.6546940
	speed: 0.0033s/iter; left time: 12.1871s
	iters: 300, epoch: 1 | loss: 1.3529346
	speed: 0.0034s/iter; left time: 12.1757s
	iters: 400, epoch: 1 | loss: 0.9163873
	speed: 0.0034s/iter; left time: 12.0054s
Updating learning rate to 9.155532193942163e-05
Validation loss decreased (inf --> 0.5975).  Saving model state dict ...
Epoch: 1 cost time: 1.994530200958252
Epoch: 1, Steps: 490 | Train Loss: 0.9937221 Vali Loss: 0.5975337 Best vali loss: 0.5975337
	iters: 100, epoch: 2 | loss: 1.4493803
	speed: 0.0103s/iter; left time: 34.2657s
	iters: 200, epoch: 2 | loss: 1.2318360
	speed: 0.0037s/iter; left time: 11.8794s
	iters: 300, epoch: 2 | loss: 0.9342021
	speed: 0.0037s/iter; left time: 11.5147s
	iters: 400, epoch: 2 | loss: 0.8865950
	speed: 0.0036s/iter; left time: 11.0248s
Updating learning rate to 8.123934388578316e-05
Validation loss decreased (0.5975 --> 0.5654).  Saving model state dict ...
Epoch: 2 cost time: 1.8322882652282715
Epoch: 2, Steps: 490 | Train Loss: 1.1255033 Vali Loss: 0.5654024 Best vali loss: 0.5654024
	iters: 100, epoch: 3 | loss: 0.5811170
	speed: 0.0103s/iter; left time: 29.3764s
	iters: 200, epoch: 3 | loss: 0.6110249
	speed: 0.0036s/iter; left time: 9.9501s
	iters: 300, epoch: 3 | loss: 0.7779253
	speed: 0.0036s/iter; left time: 9.5901s
	iters: 400, epoch: 3 | loss: 0.4789287
	speed: 0.0037s/iter; left time: 9.2872s
Updating learning rate to 6.58003916831771e-05
Validation loss decreased (0.5654 --> 0.5444).  Saving model state dict ...
Epoch: 3 cost time: 1.832632303237915
Epoch: 3, Steps: 490 | Train Loss: 0.6122490 Vali Loss: 0.5443882 Best vali loss: 0.5443882

best validation loss 0.5443882145080672

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0034990532996, 'e_layers': 2, 'learning_rate': 9.51778117e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8694111
	speed: 0.0101s/iter; left time: 23.8027s
	iters: 200, epoch: 4 | loss: 0.6023013
	speed: 0.0037s/iter; left time: 8.3696s
	iters: 300, epoch: 4 | loss: 1.1877789
	speed: 0.0038s/iter; left time: 8.1439s
	iters: 400, epoch: 4 | loss: 0.6294379
	speed: 0.0038s/iter; left time: 7.8133s
Updating learning rate to 4.758890585e-05
Epoch: 4 cost time: 2.183518171310425
Epoch: 4, Steps: 490 | Train Loss: 0.8222323 Vali Loss: 0.5481667 Best vali loss: 0.5443882
	iters: 100, epoch: 5 | loss: 1.2329555
	speed: 0.0104s/iter; left time: 19.4091s
	iters: 200, epoch: 5 | loss: 1.1182604
	speed: 0.0035s/iter; left time: 6.1861s
	iters: 300, epoch: 5 | loss: 0.8293853
	speed: 0.0035s/iter; left time: 5.8855s
	iters: 400, epoch: 5 | loss: 0.8693255
	speed: 0.0038s/iter; left time: 5.9236s
Updating learning rate to 2.93774200168229e-05
Epoch: 5 cost time: 1.8118038177490234
Epoch: 5, Steps: 490 | Train Loss: 1.0124817 Vali Loss: 0.5478554 Best vali loss: 0.5443882
	iters: 100, epoch: 6 | loss: 0.5441665
	speed: 0.0104s/iter; left time: 14.2019s
	iters: 200, epoch: 6 | loss: 0.5829787
	speed: 0.0038s/iter; left time: 4.8568s
	iters: 300, epoch: 6 | loss: 0.7093357
	speed: 0.0035s/iter; left time: 4.1410s
	iters: 400, epoch: 6 | loss: 0.4588844
	speed: 0.0036s/iter; left time: 3.8960s
Updating learning rate to 1.3938467814216841e-05
Validation loss decreased (0.5444 --> 0.5368).  Saving model state dict ...
Epoch: 6 cost time: 1.8580336570739746
Epoch: 6, Steps: 490 | Train Loss: 0.5738413 Vali Loss: 0.5368312 Best vali loss: 0.5368312
	iters: 100, epoch: 7 | loss: 0.6224936
	speed: 0.0107s/iter; left time: 9.4665s
	iters: 200, epoch: 7 | loss: 0.7814583
	speed: 0.0037s/iter; left time: 2.8912s
	iters: 300, epoch: 7 | loss: 0.4660965
	speed: 0.0038s/iter; left time: 2.5968s
	iters: 400, epoch: 7 | loss: 1.0216480
	speed: 0.0036s/iter; left time: 2.0762s
Updating learning rate to 3.622489760578361e-06
Validation loss decreased (0.5368 --> 0.5327).  Saving model state dict ...
Epoch: 7 cost time: 1.84600830078125
Epoch: 7, Steps: 490 | Train Loss: 0.7229241 Vali Loss: 0.5327476 Best vali loss: 0.5327476
	iters: 100, epoch: 8 | loss: 1.6522725
	speed: 0.0102s/iter; left time: 3.9807s
	iters: 200, epoch: 8 | loss: 0.4385976
	speed: 0.0033s/iter; left time: 0.9512s
	iters: 300, epoch: 8 | loss: 0.2812327
	speed: 0.0034s/iter; left time: 0.6425s
	iters: 400, epoch: 8 | loss: 0.8515036
	speed: 0.0034s/iter; left time: 0.3083s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6721699237823486
Epoch: 8, Steps: 490 | Train Loss: 0.8059016 Vali Loss: 0.5347346 Best vali loss: 0.5327476

best validation loss 0.53274757058904

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0034893304402, 'e_layers': 3, 'learning_rate': 9.33000374e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9378724
	speed: 0.0106s/iter; left time: 40.6461s
	iters: 200, epoch: 1 | loss: 0.5269423
	speed: 0.0044s/iter; left time: 16.2560s
	iters: 300, epoch: 1 | loss: 0.6544382
	speed: 0.0045s/iter; left time: 16.1775s
	iters: 400, epoch: 1 | loss: 0.6053766
	speed: 0.0044s/iter; left time: 15.5748s
Updating learning rate to 8.974901616819879e-05
Validation loss decreased (inf --> 0.6270).  Saving model state dict ...
Epoch: 1 cost time: 2.5312538146972656
Epoch: 1, Steps: 490 | Train Loss: 0.6811574 Vali Loss: 0.6270266 Best vali loss: 0.6270266
	iters: 100, epoch: 2 | loss: 1.4586407
	speed: 0.0124s/iter; left time: 41.4154s
	iters: 200, epoch: 2 | loss: 0.8032497
	speed: 0.0042s/iter; left time: 13.4417s
	iters: 300, epoch: 2 | loss: 0.7041048
	speed: 0.0041s/iter; left time: 12.8447s
	iters: 400, epoch: 2 | loss: 0.8424727
	speed: 0.0041s/iter; left time: 12.4978s
Updating learning rate to 7.963656326524924e-05
Validation loss decreased (0.6270 --> 0.5983).  Saving model state dict ...
Epoch: 2 cost time: 2.104025363922119
Epoch: 2, Steps: 490 | Train Loss: 0.9521170 Vali Loss: 0.5982900 Best vali loss: 0.5982900
	iters: 100, epoch: 3 | loss: 0.4321830
	speed: 0.0117s/iter; left time: 33.2933s
	iters: 200, epoch: 3 | loss: 0.7651429
	speed: 0.0042s/iter; left time: 11.4254s
	iters: 300, epoch: 3 | loss: 0.8874051
	speed: 0.0042s/iter; left time: 11.1425s
	iters: 400, epoch: 3 | loss: 0.4708676
	speed: 0.0042s/iter; left time: 10.6300s
Updating learning rate to 6.450220797601163e-05
Epoch: 3 cost time: 2.0881400108337402
Epoch: 3, Steps: 490 | Train Loss: 0.6388996 Vali Loss: 0.6037157 Best vali loss: 0.5982900
	iters: 100, epoch: 4 | loss: 0.5768326
	speed: 0.0117s/iter; left time: 27.5476s
	iters: 200, epoch: 4 | loss: 0.6985447
	speed: 0.0043s/iter; left time: 9.7273s
	iters: 300, epoch: 4 | loss: 0.7735472
	speed: 0.0042s/iter; left time: 9.0523s
	iters: 400, epoch: 4 | loss: 0.3479027
	speed: 0.0041s/iter; left time: 8.4752s
Updating learning rate to 4.66500187e-05
Validation loss decreased (0.5983 --> 0.5682).  Saving model state dict ...
Epoch: 4 cost time: 2.1232824325561523
Epoch: 4, Steps: 490 | Train Loss: 0.5992068 Vali Loss: 0.5682495 Best vali loss: 0.5682495
	iters: 100, epoch: 5 | loss: 1.0276768
	speed: 0.0122s/iter; left time: 22.7193s
	iters: 200, epoch: 5 | loss: 0.7102374
	speed: 0.0046s/iter; left time: 8.0128s
	iters: 300, epoch: 5 | loss: 0.7922801
	speed: 0.0045s/iter; left time: 7.4347s
	iters: 400, epoch: 5 | loss: 0.6479144
	speed: 0.0043s/iter; left time: 6.6686s
Updating learning rate to 2.879782942398838e-05
Validation loss decreased (0.5682 --> 0.5489).  Saving model state dict ...
Epoch: 5 cost time: 2.2246527671813965
Epoch: 5, Steps: 490 | Train Loss: 0.7945272 Vali Loss: 0.5489356 Best vali loss: 0.5489356
	iters: 100, epoch: 6 | loss: 0.4910485
	speed: 0.0120s/iter; left time: 16.4238s
	iters: 200, epoch: 6 | loss: 0.8230078
	speed: 0.0039s/iter; left time: 4.9184s
	iters: 300, epoch: 6 | loss: 0.6987759
	speed: 0.0039s/iter; left time: 4.5207s
	iters: 400, epoch: 6 | loss: 0.7570707
	speed: 0.0038s/iter; left time: 4.0682s
Updating learning rate to 1.3663474134750753e-05
Validation loss decreased (0.5489 --> 0.5391).  Saving model state dict ...
Epoch: 6 cost time: 1.9493186473846436
Epoch: 6, Steps: 490 | Train Loss: 0.6924757 Vali Loss: 0.5391224 Best vali loss: 0.5391224
	iters: 100, epoch: 7 | loss: 0.6824923
	speed: 0.0116s/iter; left time: 10.2003s
	iters: 200, epoch: 7 | loss: 0.7352993
	speed: 0.0042s/iter; left time: 3.2644s
	iters: 300, epoch: 7 | loss: 0.6063004
	speed: 0.0041s/iter; left time: 2.8136s
	iters: 400, epoch: 7 | loss: 0.9824851
	speed: 0.0039s/iter; left time: 2.2595s
Updating learning rate to 3.5510212318012157e-06
Validation loss decreased (0.5391 --> 0.5360).  Saving model state dict ...
Epoch: 7 cost time: 2.047896385192871
Epoch: 7, Steps: 490 | Train Loss: 0.7516443 Vali Loss: 0.5359913 Best vali loss: 0.5359913
	iters: 100, epoch: 8 | loss: 0.5909071
	speed: 0.0113s/iter; left time: 4.4163s
	iters: 200, epoch: 8 | loss: 0.6006497
	speed: 0.0039s/iter; left time: 1.1353s
	iters: 300, epoch: 8 | loss: 1.3461910
	speed: 0.0039s/iter; left time: 0.7429s
	iters: 400, epoch: 8 | loss: 1.3311679
	speed: 0.0041s/iter; left time: 0.3726s
Updating learning rate to 0.0
Validation loss decreased (0.5360 --> 0.5353).  Saving model state dict ...
Epoch: 8 cost time: 2.002232074737549
Epoch: 8, Steps: 490 | Train Loss: 0.9672289 Vali Loss: 0.5353398 Best vali loss: 0.5353398

best validation loss 0.535339751173533

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0020394830792, 'e_layers': 1, 'learning_rate': 0.0002012762098, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002012762098
Validation loss decreased (inf --> 0.6154).  Saving model state dict ...
Epoch: 1 cost time: 0.698441743850708
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6154033 Best vali loss: 0.6154033
Updating learning rate to 0.0001006381049
Validation loss decreased (0.6154 --> 0.6094).  Saving model state dict ...
Epoch: 2 cost time: 0.42413330078125
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6093737 Best vali loss: 0.6093737
Updating learning rate to 5.031905245e-05
Validation loss decreased (0.6094 --> 0.6070).  Saving model state dict ...
Epoch: 3 cost time: 0.44162583351135254
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6070253 Best vali loss: 0.6070253
Updating learning rate to 2.5159526225e-05
Validation loss decreased (0.6070 --> 0.6028).  Saving model state dict ...
Epoch: 4 cost time: 0.4309391975402832
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.6027866 Best vali loss: 0.6027866
Updating learning rate to 1.25797631125e-05
Epoch: 5 cost time: 0.42696428298950195
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.6049385 Best vali loss: 0.6027866
Updating learning rate to 6.28988155625e-06
Epoch: 6 cost time: 0.4273416996002197
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.6041241 Best vali loss: 0.6027866
Updating learning rate to 3.144940778125e-06
Epoch: 7 cost time: 0.4377110004425049
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.6042860 Best vali loss: 0.6027866
Updating learning rate to 1.5724703890625e-06
Epoch: 8 cost time: 0.4075806140899658
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.6043396 Best vali loss: 0.6027866

best validation loss 0.6027865619198253

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012543374991, 'e_layers': 2, 'learning_rate': 0.0001578492913, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9029874
	speed: 0.0097s/iter; left time: 37.2535s
	iters: 200, epoch: 1 | loss: 1.4842129
	speed: 0.0033s/iter; left time: 12.3963s
	iters: 300, epoch: 1 | loss: 1.4497942
	speed: 0.0035s/iter; left time: 12.7989s
	iters: 400, epoch: 1 | loss: 1.1963181
	speed: 0.0035s/iter; left time: 12.2699s
Updating learning rate to 0.0001578492913
Validation loss decreased (inf --> 0.5602).  Saving model state dict ...
Epoch: 1 cost time: 2.062473773956299
Epoch: 1, Steps: 490 | Train Loss: 1.2583281 Vali Loss: 0.5602363 Best vali loss: 0.5602363
	iters: 100, epoch: 2 | loss: 0.5608967
	speed: 0.0100s/iter; left time: 33.4356s
	iters: 200, epoch: 2 | loss: 0.5363108
	speed: 0.0035s/iter; left time: 11.1920s
	iters: 300, epoch: 2 | loss: 0.7649794
	speed: 0.0034s/iter; left time: 10.7183s
	iters: 400, epoch: 2 | loss: 0.7599112
	speed: 0.0034s/iter; left time: 10.3359s
Updating learning rate to 7.892464565e-05
Epoch: 2 cost time: 1.7041854858398438
Epoch: 2, Steps: 490 | Train Loss: 0.6555245 Vali Loss: 0.5756053 Best vali loss: 0.5602363
	iters: 100, epoch: 3 | loss: 1.1514210
	speed: 0.0098s/iter; left time: 27.7049s
	iters: 200, epoch: 3 | loss: 0.9124807
	speed: 0.0034s/iter; left time: 9.1862s
	iters: 300, epoch: 3 | loss: 0.7253996
	speed: 0.0033s/iter; left time: 8.5997s
	iters: 400, epoch: 3 | loss: 0.5740465
	speed: 0.0035s/iter; left time: 8.7856s
Updating learning rate to 3.9462322825e-05
Validation loss decreased (0.5602 --> 0.5558).  Saving model state dict ...
Epoch: 3 cost time: 1.694406270980835
Epoch: 3, Steps: 490 | Train Loss: 0.8408369 Vali Loss: 0.5558131 Best vali loss: 0.5558131

best validation loss 0.5558131011560635

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043444254303, 'e_layers': 4, 'learning_rate': 0.0003484602102, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003484602102
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.082611083984375
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6040042 Best vali loss: 0.6040042
Updating learning rate to 0.0001742301051
Validation loss decreased (0.6040 --> 0.5774).  Saving model state dict ...
Epoch: 2 cost time: 0.7845067977905273
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5774167 Best vali loss: 0.5774167
Updating learning rate to 8.711505255e-05
Validation loss decreased (0.5774 --> 0.5504).  Saving model state dict ...
Epoch: 3 cost time: 0.7804923057556152
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5503736 Best vali loss: 0.5503736

best validation loss 0.5503736256394658

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022212930453, 'e_layers': 2, 'learning_rate': 0.0001819964333, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001819964333
Validation loss decreased (inf --> 0.6100).  Saving model state dict ...
Epoch: 1 cost time: 0.7017104625701904
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6099788 Best vali loss: 0.6099788
Updating learning rate to 9.099821665e-05
Validation loss decreased (0.6100 --> 0.6033).  Saving model state dict ...
Epoch: 2 cost time: 0.44555115699768066
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.6033165 Best vali loss: 0.6033165
Updating learning rate to 4.5499108325e-05
Epoch: 3 cost time: 0.44645047187805176
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.6106885 Best vali loss: 0.6033165

best validation loss 0.6033164711806135

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043444254303, 'e_layers': 4, 'learning_rate': 0.0003484602102, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 4.3557526275e-05
Epoch: 4 cost time: 1.0955114364624023
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5534497 Best vali loss: 0.5503736
Updating learning rate to 2.17787631375e-05
Validation loss decreased (0.5504 --> 0.5432).  Saving model state dict ...
Epoch: 5 cost time: 0.7806510925292969
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5431576 Best vali loss: 0.5431576
Updating learning rate to 1.088938156875e-05
Epoch: 6 cost time: 0.7827973365783691
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5434229 Best vali loss: 0.5431576
Updating learning rate to 5.444690784375e-06
Epoch: 7 cost time: 0.7786972522735596
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5434939 Best vali loss: 0.5431576
Updating learning rate to 2.7223453921875e-06
Validation loss decreased (0.5432 --> 0.5429).  Saving model state dict ...
Epoch: 8 cost time: 0.777538537979126
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5429257 Best vali loss: 0.5429257

best validation loss 0.542925670846421

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0029530912013, 'e_layers': 3, 'learning_rate': 0.0003816855071, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1028285
	speed: 0.0111s/iter; left time: 20.6210s
	iters: 200, epoch: 1 | loss: 0.7375082
	speed: 0.0048s/iter; left time: 8.4200s
Updating learning rate to 0.00036715846748294073
Validation loss decreased (inf --> 0.6141).  Saving model state dict ...
Epoch: 1 cost time: 1.5284290313720703
Epoch: 1, Steps: 245 | Train Loss: 0.9201683 Vali Loss: 0.6141286 Best vali loss: 0.6141286
	iters: 100, epoch: 2 | loss: 0.5264774
	speed: 0.0094s/iter; left time: 15.1771s
	iters: 200, epoch: 2 | loss: 0.6507167
	speed: 0.0045s/iter; left time: 6.7547s
Updating learning rate to 0.00032578895872551806
Validation loss decreased (0.6141 --> 0.6008).  Saving model state dict ...
Epoch: 2 cost time: 1.1450235843658447
Epoch: 2, Steps: 245 | Train Loss: 0.5885971 Vali Loss: 0.6007863 Best vali loss: 0.6007863
	iters: 100, epoch: 3 | loss: 0.7379583
	speed: 0.0092s/iter; left time: 12.6384s
	iters: 200, epoch: 3 | loss: 0.8809371
	speed: 0.0043s/iter; left time: 5.4480s
Updating learning rate to 0.00026387511352051894
Validation loss decreased (0.6008 --> 0.5523).  Saving model state dict ...
Epoch: 3 cost time: 1.0969817638397217
Epoch: 3, Steps: 245 | Train Loss: 0.8094477 Vali Loss: 0.5523366 Best vali loss: 0.5523366
	iters: 100, epoch: 4 | loss: 0.5200551
	speed: 0.0089s/iter; left time: 9.9805s
	iters: 200, epoch: 4 | loss: 0.6193957
	speed: 0.0044s/iter; left time: 4.4640s
Updating learning rate to 0.00019084275355
Epoch: 4 cost time: 1.1001055240631104
Epoch: 4, Steps: 245 | Train Loss: 0.5697254 Vali Loss: 0.5561628 Best vali loss: 0.5523366
	iters: 100, epoch: 5 | loss: 0.4703037
	speed: 0.0095s/iter; left time: 8.3503s
	iters: 200, epoch: 5 | loss: 0.7131621
	speed: 0.0048s/iter; left time: 3.7691s
Updating learning rate to 0.00011781039357948108
Epoch: 5 cost time: 1.2455735206604004
Epoch: 5, Steps: 245 | Train Loss: 0.5917329 Vali Loss: 0.5629297 Best vali loss: 0.5523366
	iters: 100, epoch: 6 | loss: 0.6220523
	speed: 0.0098s/iter; left time: 6.2032s
	iters: 200, epoch: 6 | loss: 0.6526985
	speed: 0.0048s/iter; left time: 2.5992s
Updating learning rate to 5.589654837448195e-05
Epoch: 6 cost time: 1.2347619533538818
Epoch: 6, Steps: 245 | Train Loss: 0.6373754 Vali Loss: 0.5815198 Best vali loss: 0.5523366
	iters: 100, epoch: 7 | loss: 0.7216105
	speed: 0.0091s/iter; left time: 3.5420s
	iters: 200, epoch: 7 | loss: 0.5781910
	speed: 0.0044s/iter; left time: 1.2881s
Updating learning rate to 1.4527039617059292e-05
Epoch: 7 cost time: 1.1364827156066895
Epoch: 7, Steps: 245 | Train Loss: 0.6499008 Vali Loss: 0.5994240 Best vali loss: 0.5523366
	iters: 100, epoch: 8 | loss: 0.4716635
	speed: 0.0088s/iter; left time: 1.2907s
	iters: 200, epoch: 8 | loss: 0.5484081
	speed: 0.0047s/iter; left time: 0.2166s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.181091070175171
Epoch: 8, Steps: 245 | Train Loss: 0.5100358 Vali Loss: 0.5984151 Best vali loss: 0.5523366

best validation loss 0.552336600755222

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0097758582006, 'e_layers': 4, 'learning_rate': 0.0004697346294, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004518564196072173
Validation loss decreased (inf --> 0.6117).  Saving model state dict ...
Epoch: 1 cost time: 1.0659825801849365
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6117138 Best vali loss: 0.6117138
Updating learning rate to 0.0004009435856034449
Validation loss decreased (0.6117 --> 0.5954).  Saving model state dict ...
Epoch: 2 cost time: 0.764167070388794
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5954301 Best vali loss: 0.5954301
Updating learning rate to 0.00032474714483976774
Validation loss decreased (0.5954 --> 0.5644).  Saving model state dict ...
Epoch: 3 cost time: 0.7739572525024414
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5643743 Best vali loss: 0.5643743
Updating learning rate to 0.0002348673147
Validation loss decreased (0.5644 --> 0.5343).  Saving model state dict ...
Epoch: 4 cost time: 0.7658617496490479
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5342825 Best vali loss: 0.5342825
Updating learning rate to 0.0001449874845602323
Epoch: 5 cost time: 0.770240306854248
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5479920 Best vali loss: 0.5342825
Updating learning rate to 6.879104379655513e-05
Epoch: 6 cost time: 0.768449068069458
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5499743 Best vali loss: 0.5342825
Updating learning rate to 1.7878209792782736e-05
Epoch: 7 cost time: 0.7738714218139648
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5574583 Best vali loss: 0.5342825
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7743051052093506
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5600438 Best vali loss: 0.5342825

best validation loss 0.5342825103390829

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0024542898872, 'e_layers': 3, 'learning_rate': 0.0001668118756, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001668118756
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.0739881992340088
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6040106 Best vali loss: 0.6040106
Updating learning rate to 8.34059378e-05
Validation loss decreased (0.6040 --> 0.5972).  Saving model state dict ...
Epoch: 2 cost time: 0.7935216426849365
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5971553 Best vali loss: 0.5971553
Updating learning rate to 4.17029689e-05
Validation loss decreased (0.5972 --> 0.5537).  Saving model state dict ...
Epoch: 3 cost time: 0.7958917617797852
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5536777 Best vali loss: 0.5536777

best validation loss 0.5536777243356029

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002555727046, 'e_layers': 3, 'learning_rate': 0.0001642147914, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001642147914
Validation loss decreased (inf --> 0.6040).  Saving model state dict ...
Epoch: 1 cost time: 1.081960916519165
Epoch: 1, Steps: 62 | Train Loss: nan Vali Loss: 0.6040419 Best vali loss: 0.6040419
Updating learning rate to 8.21073957e-05
Validation loss decreased (0.6040 --> 0.5979).  Saving model state dict ...
Epoch: 2 cost time: 0.7890326976776123
Epoch: 2, Steps: 62 | Train Loss: nan Vali Loss: 0.5978810 Best vali loss: 0.5978810
Updating learning rate to 4.105369785e-05
Validation loss decreased (0.5979 --> 0.5532).  Saving model state dict ...
Epoch: 3 cost time: 0.7937347888946533
Epoch: 3, Steps: 62 | Train Loss: nan Vali Loss: 0.5531873 Best vali loss: 0.5531873

best validation loss 0.5531873341954896

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010755758812, 'e_layers': 3, 'learning_rate': 0.0001591230672, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8096980
	speed: 0.0119s/iter; left time: 10.5015s
Updating learning rate to 0.00015306680606824903
Validation loss decreased (inf --> 0.6027).  Saving model state dict ...
Epoch: 1 cost time: 1.0460200309753418
Epoch: 1, Steps: 123 | Train Loss: 0.8096980 Vali Loss: 0.6026937 Best vali loss: 0.6026937
	iters: 100, epoch: 2 | loss: 0.9454335
	speed: 0.0092s/iter; left time: 7.0227s
Updating learning rate to 0.00013582003353016132
Validation loss decreased (0.6027 --> 0.5651).  Saving model state dict ...
Epoch: 2 cost time: 0.727440357208252
Epoch: 2, Steps: 123 | Train Loss: 0.9454335 Vali Loss: 0.5650757 Best vali loss: 0.5650757
	iters: 100, epoch: 3 | loss: 0.7871523
	speed: 0.0094s/iter; left time: 5.9818s
Updating learning rate to 0.00011000841436227841
Epoch: 3 cost time: 0.7372760772705078
Epoch: 3, Steps: 123 | Train Loss: 0.7871523 Vali Loss: 0.5753642 Best vali loss: 0.5650757

best validation loss 0.5650757221037014

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002555727046, 'e_layers': 3, 'learning_rate': 0.0001642147914, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.0526848925e-05
Validation loss decreased (0.5532 --> 0.5434).  Saving model state dict ...
Epoch: 4 cost time: 1.0823540687561035
Epoch: 4, Steps: 62 | Train Loss: nan Vali Loss: 0.5433886 Best vali loss: 0.5433886
Updating learning rate to 1.02634244625e-05
Epoch: 5 cost time: 0.7969839572906494
Epoch: 5, Steps: 62 | Train Loss: nan Vali Loss: 0.5513142 Best vali loss: 0.5433886
Updating learning rate to 5.13171223125e-06
Epoch: 6 cost time: 0.7875187397003174
Epoch: 6, Steps: 62 | Train Loss: nan Vali Loss: 0.5465218 Best vali loss: 0.5433886
Updating learning rate to 2.565856115625e-06
Epoch: 7 cost time: 0.783491849899292
Epoch: 7, Steps: 62 | Train Loss: nan Vali Loss: 0.5460019 Best vali loss: 0.5433886
Updating learning rate to 1.2829280578125e-06
Epoch: 8 cost time: 0.784940242767334
Epoch: 8, Steps: 62 | Train Loss: nan Vali Loss: 0.5480774 Best vali loss: 0.5433886

best validation loss 0.543388577949554

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009387606596, 'e_layers': 1, 'learning_rate': 0.0002976833842, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6193621
	speed: 0.0094s/iter; left time: 8.2902s
Updating learning rate to 0.0002863534850155369
Validation loss decreased (inf --> 0.6080).  Saving model state dict ...
Epoch: 1 cost time: 0.810654878616333
Epoch: 1, Steps: 123 | Train Loss: 0.6193621 Vali Loss: 0.6080025 Best vali loss: 0.6080025
	iters: 100, epoch: 2 | loss: 0.8478597
	speed: 0.0067s/iter; left time: 5.0911s
Updating learning rate to 0.0002540886619071902
Validation loss decreased (0.6080 --> 0.5995).  Saving model state dict ...
Epoch: 2 cost time: 0.5055062770843506
Epoch: 2, Steps: 123 | Train Loss: 0.8478597 Vali Loss: 0.5995299 Best vali loss: 0.5995299
	iters: 100, epoch: 3 | loss: 0.9317282
	speed: 0.0066s/iter; left time: 4.1996s
Updating learning rate to 0.0002058009417118559
Epoch: 3 cost time: 0.49405884742736816
Epoch: 3, Steps: 123 | Train Loss: 0.9317282 Vali Loss: 0.6068195 Best vali loss: 0.5995299
	iters: 100, epoch: 4 | loss: 0.7963936
	speed: 0.0066s/iter; left time: 3.3971s
Updating learning rate to 0.0001488416921
Epoch: 4 cost time: 0.4869363307952881
Epoch: 4, Steps: 123 | Train Loss: 0.7963936 Vali Loss: 0.6344304 Best vali loss: 0.5995299
	iters: 100, epoch: 5 | loss: 0.6277876
	speed: 0.0064s/iter; left time: 2.5217s
Updating learning rate to 9.188244248814415e-05
Epoch: 5 cost time: 0.486844539642334
Epoch: 5, Steps: 123 | Train Loss: 0.6277876 Vali Loss: 0.6255095 Best vali loss: 0.5995299
	iters: 100, epoch: 6 | loss: 0.6379685
	speed: 0.0065s/iter; left time: 1.7681s
Updating learning rate to 4.3594722292809835e-05
Epoch: 6 cost time: 0.5010614395141602
Epoch: 6, Steps: 123 | Train Loss: 0.6379685 Vali Loss: 0.6179290 Best vali loss: 0.5995299
	iters: 100, epoch: 7 | loss: 0.6648135
	speed: 0.0065s/iter; left time: 0.9532s
Updating learning rate to 1.132989918446312e-05
Epoch: 7 cost time: 0.49120116233825684
Epoch: 7, Steps: 123 | Train Loss: 0.6648135 Vali Loss: 0.6271290 Best vali loss: 0.5995299
	iters: 100, epoch: 8 | loss: 0.7150223
	speed: 0.0066s/iter; left time: 0.1589s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5112712383270264
Epoch: 8, Steps: 123 | Train Loss: 0.7150223 Vali Loss: 0.6250404 Best vali loss: 0.5995299

best validation loss 0.599529942170937

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010393211954, 'e_layers': 1, 'learning_rate': 0.0003179448167, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6178615
	speed: 0.0101s/iter; left time: 8.9614s
Updating learning rate to 0.00030584376265859137
Validation loss decreased (inf --> 0.6076).  Saving model state dict ...
Epoch: 1 cost time: 0.8189797401428223
Epoch: 1, Steps: 123 | Train Loss: 0.6178615 Vali Loss: 0.6075753 Best vali loss: 0.6075753
	iters: 100, epoch: 2 | loss: 0.8469161
	speed: 0.0068s/iter; left time: 5.1475s
Updating learning rate to 0.0002713828763158419
Validation loss decreased (0.6076 --> 0.6007).  Saving model state dict ...
Epoch: 2 cost time: 0.4959111213684082
Epoch: 2, Steps: 123 | Train Loss: 0.8469161 Vali Loss: 0.6007186 Best vali loss: 0.6007186
	iters: 100, epoch: 3 | loss: 0.9281263
	speed: 0.0065s/iter; left time: 4.1612s
Updating learning rate to 0.0002198085152287227
Epoch: 3 cost time: 0.4881260395050049
Epoch: 3, Steps: 123 | Train Loss: 0.9281263 Vali Loss: 0.6063714 Best vali loss: 0.6007186
	iters: 100, epoch: 4 | loss: 0.7962314
	speed: 0.0066s/iter; left time: 3.3930s
Updating learning rate to 0.00015897240835
Epoch: 4 cost time: 0.48734235763549805
Epoch: 4, Steps: 123 | Train Loss: 0.7962314 Vali Loss: 0.6385700 Best vali loss: 0.6007186
	iters: 100, epoch: 5 | loss: 0.6267857
	speed: 0.0065s/iter; left time: 2.5647s
Updating learning rate to 9.813630147127736e-05
Epoch: 5 cost time: 0.49080610275268555
Epoch: 5, Steps: 123 | Train Loss: 0.6267857 Vali Loss: 0.6260616 Best vali loss: 0.6007186
	iters: 100, epoch: 6 | loss: 0.6344662
	speed: 0.0065s/iter; left time: 1.7434s
Updating learning rate to 4.656194038415808e-05
Epoch: 6 cost time: 0.49875617027282715
Epoch: 6, Steps: 123 | Train Loss: 0.6344662 Vali Loss: 0.6165953 Best vali loss: 0.6007186
	iters: 100, epoch: 7 | loss: 0.6608489
	speed: 0.0066s/iter; left time: 0.9771s
Updating learning rate to 1.2101054041408624e-05
Epoch: 7 cost time: 0.4996623992919922
Epoch: 7, Steps: 123 | Train Loss: 0.6608489 Vali Loss: 0.6286341 Best vali loss: 0.6007186
	iters: 100, epoch: 8 | loss: 0.7119732
	speed: 0.0065s/iter; left time: 0.1557s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4771411418914795
Epoch: 8, Steps: 123 | Train Loss: 0.7119732 Vali Loss: 0.6246816 Best vali loss: 0.6007186

best validation loss 0.6007185607583144

[INFO][smbo.py:320] Finished 1500 trials.
[INFO][smbo.py:328] Configuration budget is exhausted:
[INFO][smbo.py:329] --- Remaining wallclock time: 1909.725984096527
[INFO][smbo.py:330] --- Remaining cpu time: inf
[INFO][smbo.py:331] --- Remaining trials: 0
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.003098386677, 'e_layers': 1, 'learning_rate': 0.0005, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 7825
val 2161
starting training loop
budget 8
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.6932025
	speed: 0.0098s/iter; left time: 75.4306s
	iters: 200, epoch: 1 | loss: 1.1826427
	speed: 0.0025s/iter; left time: 19.4022s
	iters: 300, epoch: 1 | loss: 0.6562573
	speed: 0.0025s/iter; left time: 19.0516s
	iters: 400, epoch: 1 | loss: 0.6125045
	speed: 0.0024s/iter; left time: 17.6941s
	iters: 500, epoch: 1 | loss: 0.2237864
	speed: 0.0025s/iter; left time: 18.2188s
	iters: 600, epoch: 1 | loss: 0.3614544
	speed: 0.0026s/iter; left time: 18.9143s
	iters: 700, epoch: 1 | loss: 1.0201732
	speed: 0.0024s/iter; left time: 16.9008s
	iters: 800, epoch: 1 | loss: 0.7468050
	speed: 0.0024s/iter; left time: 16.6303s
	iters: 900, epoch: 1 | loss: 0.4166328
	speed: 0.0024s/iter; left time: 16.3205s
Updating learning rate to 0.0004809698831278217
Validation loss decreased (inf --> 0.6046).  Saving model state dict ...
Epoch: 1 cost time: 2.9329705238342285
Epoch: 1, Steps: 979 | Train Loss: 0.7681621 Vali Loss: 0.6046193 Best vali loss: 0.6046193
	iters: 100, epoch: 2 | loss: 0.4754962
	speed: 0.0090s/iter; left time: 60.6642s
	iters: 200, epoch: 2 | loss: 0.5397698
	speed: 0.0023s/iter; left time: 15.3833s
	iters: 300, epoch: 2 | loss: 0.8707422
	speed: 0.0023s/iter; left time: 15.2642s
	iters: 400, epoch: 2 | loss: 0.2844884
	speed: 0.0023s/iter; left time: 14.6767s
	iters: 500, epoch: 2 | loss: 0.4917646
	speed: 0.0023s/iter; left time: 14.8012s
	iters: 600, epoch: 2 | loss: 0.5666843
	speed: 0.0024s/iter; left time: 14.7130s
	iters: 700, epoch: 2 | loss: 0.6423477
	speed: 0.0024s/iter; left time: 14.8242s
	iters: 800, epoch: 2 | loss: 0.4583572
	speed: 0.0024s/iter; left time: 14.6814s
	iters: 900, epoch: 2 | loss: 0.3208607
	speed: 0.0023s/iter; left time: 13.8729s
Updating learning rate to 0.00042677669529663686
Validation loss decreased (0.6046 --> 0.5966).  Saving model state dict ...
Epoch: 2 cost time: 2.3519182205200195
Epoch: 2, Steps: 979 | Train Loss: 0.5167235 Vali Loss: 0.5966380 Best vali loss: 0.5966380
	iters: 100, epoch: 3 | loss: 1.1110678
	speed: 0.0089s/iter; left time: 51.5579s
	iters: 200, epoch: 3 | loss: 1.1850760
	speed: 0.0025s/iter; left time: 14.3185s
	iters: 300, epoch: 3 | loss: 0.7500632
	speed: 0.0026s/iter; left time: 14.2408s
	iters: 400, epoch: 3 | loss: 0.2602142
	speed: 0.0026s/iter; left time: 13.9774s
	iters: 500, epoch: 3 | loss: 0.8566214
	speed: 0.0025s/iter; left time: 13.6117s
	iters: 600, epoch: 3 | loss: 0.8807521
	speed: 0.0025s/iter; left time: 13.0513s
	iters: 700, epoch: 3 | loss: 0.4199367
	speed: 0.0024s/iter; left time: 12.3463s
	iters: 800, epoch: 3 | loss: 1.0137552
	speed: 0.0025s/iter; left time: 12.4933s
	iters: 900, epoch: 3 | loss: 1.5133862
	speed: 0.0024s/iter; left time: 12.0105s
Updating learning rate to 0.0003456708580912725
Validation loss decreased (0.5966 --> 0.5942).  Saving model state dict ...
Epoch: 3 cost time: 2.4832983016967773
Epoch: 3, Steps: 979 | Train Loss: 0.8878748 Vali Loss: 0.5942415 Best vali loss: 0.5942415
	iters: 100, epoch: 4 | loss: 0.7928634
	speed: 0.0087s/iter; left time: 41.7563s
	iters: 200, epoch: 4 | loss: 0.2695327
	speed: 0.0024s/iter; left time: 11.2256s
	iters: 300, epoch: 4 | loss: 0.9707843
	speed: 0.0023s/iter; left time: 10.7356s
	iters: 400, epoch: 4 | loss: 0.5814623
	speed: 0.0024s/iter; left time: 10.6110s
	iters: 500, epoch: 4 | loss: 0.2918782
	speed: 0.0023s/iter; left time: 10.3081s
	iters: 600, epoch: 4 | loss: 0.9052215
	speed: 0.0023s/iter; left time: 10.0187s
	iters: 700, epoch: 4 | loss: 0.4730926
	speed: 0.0024s/iter; left time: 9.9356s
	iters: 800, epoch: 4 | loss: 0.4084242
	speed: 0.0023s/iter; left time: 9.5846s
	iters: 900, epoch: 4 | loss: 0.9386229
	speed: 0.0023s/iter; left time: 9.3457s
Updating learning rate to 0.00025
Epoch: 4 cost time: 2.3584086894989014
Epoch: 4, Steps: 979 | Train Loss: 0.6257647 Vali Loss: 0.6070068 Best vali loss: 0.5942415
	iters: 100, epoch: 5 | loss: 1.4928423
	speed: 0.0089s/iter; left time: 33.9147s
	iters: 200, epoch: 5 | loss: 0.6816980
	speed: 0.0024s/iter; left time: 8.9718s
	iters: 300, epoch: 5 | loss: 1.1066626
	speed: 0.0023s/iter; left time: 8.4344s
	iters: 400, epoch: 5 | loss: 1.0221993
	speed: 0.0023s/iter; left time: 8.2108s
	iters: 500, epoch: 5 | loss: 0.5639660
	speed: 0.0023s/iter; left time: 7.8515s
	iters: 600, epoch: 5 | loss: 1.3649781
	speed: 0.0023s/iter; left time: 7.6580s
	iters: 700, epoch: 5 | loss: 0.6201059
	speed: 0.0023s/iter; left time: 7.4405s
	iters: 800, epoch: 5 | loss: 0.6139653
	speed: 0.0023s/iter; left time: 7.2582s
	iters: 900, epoch: 5 | loss: 0.7006000
	speed: 0.0023s/iter; left time: 7.0039s
Updating learning rate to 0.00015432914190872756
Epoch: 5 cost time: 2.3514044284820557
Epoch: 5, Steps: 979 | Train Loss: 0.9074464 Vali Loss: 0.6060077 Best vali loss: 0.5942415
	iters: 100, epoch: 6 | loss: 0.2866562
	speed: 0.0089s/iter; left time: 25.3875s
	iters: 200, epoch: 6 | loss: 0.5380631
	speed: 0.0025s/iter; left time: 6.9388s
	iters: 300, epoch: 6 | loss: 0.3134550
	speed: 0.0025s/iter; left time: 6.7100s
	iters: 400, epoch: 6 | loss: 0.2912357
	speed: 0.0026s/iter; left time: 6.5865s
	iters: 500, epoch: 6 | loss: 0.6589854
	speed: 0.0026s/iter; left time: 6.2545s
	iters: 600, epoch: 6 | loss: 0.3364688
	speed: 0.0025s/iter; left time: 5.9354s
	iters: 700, epoch: 6 | loss: 0.3281430
	speed: 0.0025s/iter; left time: 5.7046s
	iters: 800, epoch: 6 | loss: 1.5262594
	speed: 0.0025s/iter; left time: 5.4145s
	iters: 900, epoch: 6 | loss: 0.5836078
	speed: 0.0025s/iter; left time: 5.1347s
Updating learning rate to 7.322330470336314e-05
Epoch: 6 cost time: 2.526918649673462
Epoch: 6, Steps: 979 | Train Loss: 0.5403194 Vali Loss: 0.6117581 Best vali loss: 0.5942415
	iters: 100, epoch: 7 | loss: 0.9585966
	speed: 0.0088s/iter; left time: 16.3563s
	iters: 200, epoch: 7 | loss: 0.7775886
	speed: 0.0025s/iter; left time: 4.4027s
	iters: 300, epoch: 7 | loss: 0.3088143
	speed: 0.0025s/iter; left time: 4.0841s
	iters: 400, epoch: 7 | loss: 0.5747431
	speed: 0.0025s/iter; left time: 3.8946s
	iters: 500, epoch: 7 | loss: 0.5646695
	speed: 0.0025s/iter; left time: 3.6383s
	iters: 600, epoch: 7 | loss: 1.2244619
	speed: 0.0024s/iter; left time: 3.2755s
	iters: 700, epoch: 7 | loss: 0.6447598
	speed: 0.0024s/iter; left time: 3.0673s
	iters: 800, epoch: 7 | loss: 0.7640409
	speed: 0.0023s/iter; left time: 2.7042s
	iters: 900, epoch: 7 | loss: 1.1650797
	speed: 0.0024s/iter; left time: 2.5007s
Updating learning rate to 1.9030116872178316e-05
Epoch: 7 cost time: 2.439635992050171
Epoch: 7, Steps: 979 | Train Loss: 0.7758616 Vali Loss: 0.6103524 Best vali loss: 0.5942415
	iters: 100, epoch: 8 | loss: 1.3900323
	speed: 0.0091s/iter; left time: 8.0436s
	iters: 200, epoch: 8 | loss: 1.0549514
	speed: 0.0026s/iter; left time: 1.9964s
	iters: 300, epoch: 8 | loss: 0.6484250
	speed: 0.0025s/iter; left time: 1.7295s
	iters: 400, epoch: 8 | loss: 0.2673837
	speed: 0.0024s/iter; left time: 1.3687s
	iters: 500, epoch: 8 | loss: 0.8932598
	speed: 0.0023s/iter; left time: 1.0958s
	iters: 600, epoch: 8 | loss: 0.8052257
	speed: 0.0023s/iter; left time: 0.8697s
	iters: 700, epoch: 8 | loss: 0.9005907
	speed: 0.0024s/iter; left time: 0.6598s
	iters: 800, epoch: 8 | loss: 2.2312887
	speed: 0.0023s/iter; left time: 0.4204s
	iters: 900, epoch: 8 | loss: 1.5645596
	speed: 0.0023s/iter; left time: 0.1857s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.386044979095459
Epoch: 8, Steps: 979 | Train Loss: 1.0839685 Vali Loss: 0.6115294 Best vali loss: 0.5942415

best validation loss 0.5942415152226042

Default cost: 0.5942415152226042
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010494665051, 'e_layers': 2, 'learning_rate': 0.000297833515, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 7825
val 2161
loading checkpoint...
starting training loop
budget 8
start_epoch 8
train_epoch 8

best validation loss 0.5203712052186845

Configuration(values={
  'alpha_d_ff': 4,
  'batch_size': 64,
  'd_core': 32,
  'd_model': 512,
  'dropout': 0.0010494665051,
  'e_layers': 2,
  'learning_rate': 0.000297833515,
  'lradj': 'cosine',
})
Incumbent cost: 0.5203712052186845


Time taken (1 parallel trials): 12517 seconds


