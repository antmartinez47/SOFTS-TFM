horizon=336
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7329904
	speed: 0.0089s/iter; left time: 17.3345s
	iters: 200, epoch: 1 | loss: 0.7682719
	speed: 0.0026s/iter; left time: 4.8204s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.3736).  Saving model state dict ...
Epoch: 1 cost time: 1.0363216400146484
Epoch: 1, Steps: 257 | Train Loss: 0.7506312 Vali Loss: 0.3736337 Best vali loss: 0.3736337
	iters: 100, epoch: 2 | loss: 0.3377167
	speed: 0.0066s/iter; left time: 11.1948s
	iters: 200, epoch: 2 | loss: 0.7159407
	speed: 0.0025s/iter; left time: 3.9526s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.3736 --> 0.3680).  Saving model state dict ...
Epoch: 2 cost time: 0.7051482200622559
Epoch: 2, Steps: 257 | Train Loss: 0.5268287 Vali Loss: 0.3680045 Best vali loss: 0.3680045
	iters: 100, epoch: 3 | loss: 0.4112294
	speed: 0.0066s/iter; left time: 9.4921s
	iters: 200, epoch: 3 | loss: 0.6468997
	speed: 0.0026s/iter; left time: 3.4529s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.3680 --> 0.3659).  Saving model state dict ...
Epoch: 3 cost time: 0.717278003692627
Epoch: 3, Steps: 257 | Train Loss: 0.5290645 Vali Loss: 0.3659210 Best vali loss: 0.3659210

best validation loss 0.36592095474363073

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7297551
	speed: 0.0111s/iter; left time: 44.5897s
	iters: 200, epoch: 1 | loss: 0.5610297
	speed: 0.0050s/iter; left time: 19.6824s
	iters: 300, epoch: 1 | loss: 0.5825672
	speed: 0.0050s/iter; left time: 19.2530s
	iters: 400, epoch: 1 | loss: 0.7511373
	speed: 0.0049s/iter; left time: 18.3063s
	iters: 500, epoch: 1 | loss: 1.0213355
	speed: 0.0050s/iter; left time: 18.1247s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.3787).  Saving model state dict ...
Epoch: 1 cost time: 2.947692632675171
Epoch: 1, Steps: 514 | Train Loss: 0.7291649 Vali Loss: 0.3787228 Best vali loss: 0.3787228
	iters: 100, epoch: 2 | loss: 0.7593931
	speed: 0.0103s/iter; left time: 35.9705s
	iters: 200, epoch: 2 | loss: 0.2756207
	speed: 0.0050s/iter; left time: 17.1167s
	iters: 300, epoch: 2 | loss: 0.6291634
	speed: 0.0051s/iter; left time: 16.8522s
	iters: 400, epoch: 2 | loss: 0.3453585
	speed: 0.0052s/iter; left time: 16.6386s
	iters: 500, epoch: 2 | loss: 0.8053963
	speed: 0.0052s/iter; left time: 15.9912s
Updating learning rate to 0.0007560191392
Validation loss decreased (0.3787 --> 0.3742).  Saving model state dict ...
Epoch: 2 cost time: 2.6868021488189697
Epoch: 2, Steps: 514 | Train Loss: 0.5629864 Vali Loss: 0.3741856 Best vali loss: 0.3741856
	iters: 100, epoch: 3 | loss: 0.3738729
	speed: 0.0100s/iter; left time: 29.9779s
	iters: 200, epoch: 3 | loss: 0.5337664
	speed: 0.0051s/iter; left time: 14.5932s
	iters: 300, epoch: 3 | loss: 0.6730341
	speed: 0.0052s/iter; left time: 14.3491s
	iters: 400, epoch: 3 | loss: 0.3920505
	speed: 0.0052s/iter; left time: 13.8383s
	iters: 500, epoch: 3 | loss: 0.8274453
	speed: 0.0052s/iter; left time: 13.3220s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 2.6865851879119873
Epoch: 3, Steps: 514 | Train Loss: 0.5600338 Vali Loss: 0.3863496 Best vali loss: 0.3741856

best validation loss 0.3741855902030098

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4428795
	speed: 0.0095s/iter; left time: 8.8531s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.3855).  Saving model state dict ...
Epoch: 1 cost time: 0.7865533828735352
Epoch: 1, Steps: 129 | Train Loss: 0.4428795 Vali Loss: 0.3855214 Best vali loss: 0.3855214
	iters: 100, epoch: 2 | loss: 0.5430962
	speed: 0.0061s/iter; left time: 4.9240s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.3855 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 0.4492526054382324
Epoch: 2, Steps: 129 | Train Loss: 0.5430962 Vali Loss: 0.3697077 Best vali loss: 0.3697077
	iters: 100, epoch: 3 | loss: 0.6421036
	speed: 0.0059s/iter; left time: 3.9769s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.3697 --> 0.3654).  Saving model state dict ...
Epoch: 3 cost time: 0.445096492767334
Epoch: 3, Steps: 129 | Train Loss: 0.6421036 Vali Loss: 0.3654109 Best vali loss: 0.3654109

best validation loss 0.36541094550449393

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4085593
	speed: 0.0095s/iter; left time: 5.1665s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 0.7762844562530518
Epoch: 4, Steps: 129 | Train Loss: 0.4085593 Vali Loss: 0.3657450 Best vali loss: 0.3654109
	iters: 100, epoch: 5 | loss: 0.5441386
	speed: 0.0060s/iter; left time: 2.5038s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 0.4470982551574707
Epoch: 5, Steps: 129 | Train Loss: 0.5441386 Vali Loss: 0.3659625 Best vali loss: 0.3654109
	iters: 100, epoch: 6 | loss: 0.6178907
	speed: 0.0062s/iter; left time: 1.7797s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 0.4586179256439209
Epoch: 6, Steps: 129 | Train Loss: 0.6178907 Vali Loss: 0.3654779 Best vali loss: 0.3654109
	iters: 100, epoch: 7 | loss: 0.7216938
	speed: 0.0059s/iter; left time: 0.9369s
Updating learning rate to 9.883238895192597e-06
Epoch: 7 cost time: 0.44094204902648926
Epoch: 7, Steps: 129 | Train Loss: 0.7216938 Vali Loss: 0.3660986 Best vali loss: 0.3654109
	iters: 100, epoch: 8 | loss: 0.6749479
	speed: 0.0058s/iter; left time: 0.1748s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.448195219039917
Epoch: 8, Steps: 129 | Train Loss: 0.6749479 Vali Loss: 0.3661496 Best vali loss: 0.3654109

best validation loss 0.36541094550449393

[INFO][abstract_intensifier.py:516] Added config e98a6b as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6508887
	speed: 0.0101s/iter; left time: 19.8130s
	iters: 200, epoch: 1 | loss: 1.1240764
	speed: 0.0038s/iter; left time: 7.1455s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 1.3545141220092773
Epoch: 1, Steps: 257 | Train Loss: 0.8874826 Vali Loss: 0.3742377 Best vali loss: 0.3742377
	iters: 100, epoch: 2 | loss: 0.3588629
	speed: 0.0087s/iter; left time: 14.8367s
	iters: 200, epoch: 2 | loss: 0.4956456
	speed: 0.0038s/iter; left time: 6.0966s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.3742 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 1.0386569499969482
Epoch: 2, Steps: 257 | Train Loss: 0.4272543 Vali Loss: 0.3666792 Best vali loss: 0.3666792
	iters: 100, epoch: 3 | loss: 0.3917209
	speed: 0.0085s/iter; left time: 12.2921s
	iters: 200, epoch: 3 | loss: 0.5767121
	speed: 0.0037s/iter; left time: 4.9261s
Updating learning rate to 8.5374841225e-05
Epoch: 3 cost time: 1.0028882026672363
Epoch: 3, Steps: 257 | Train Loss: 0.4842165 Vali Loss: 0.3682919 Best vali loss: 0.3666792
	iters: 100, epoch: 4 | loss: 0.4799712
	speed: 0.0082s/iter; left time: 9.7077s
	iters: 200, epoch: 4 | loss: 0.3701420
	speed: 0.0037s/iter; left time: 3.9722s
Updating learning rate to 4.26874206125e-05
Validation loss decreased (0.3667 --> 0.3557).  Saving model state dict ...
Epoch: 4 cost time: 0.9706785678863525
Epoch: 4, Steps: 257 | Train Loss: 0.4250566 Vali Loss: 0.3556553 Best vali loss: 0.3556553
	iters: 100, epoch: 5 | loss: 0.5408211
	speed: 0.0082s/iter; left time: 7.6593s
	iters: 200, epoch: 5 | loss: 0.4317681
	speed: 0.0035s/iter; left time: 2.9292s
Updating learning rate to 2.134371030625e-05
Validation loss decreased (0.3557 --> 0.3555).  Saving model state dict ...
Epoch: 5 cost time: 0.96543288230896
Epoch: 5, Steps: 257 | Train Loss: 0.4862946 Vali Loss: 0.3555428 Best vali loss: 0.3555428
	iters: 100, epoch: 6 | loss: 0.4635032
	speed: 0.0079s/iter; left time: 5.3167s
	iters: 200, epoch: 6 | loss: 0.3887253
	speed: 0.0033s/iter; left time: 1.8835s
Updating learning rate to 1.0671855153125e-05
Validation loss decreased (0.3555 --> 0.3518).  Saving model state dict ...
Epoch: 6 cost time: 0.9035751819610596
Epoch: 6, Steps: 257 | Train Loss: 0.4261142 Vali Loss: 0.3517651 Best vali loss: 0.3517651
	iters: 100, epoch: 7 | loss: 0.7299186
	speed: 0.0084s/iter; left time: 3.4758s
	iters: 200, epoch: 7 | loss: 0.3386114
	speed: 0.0034s/iter; left time: 1.0770s
Updating learning rate to 5.3359275765625e-06
Validation loss decreased (0.3518 --> 0.3502).  Saving model state dict ...
Epoch: 7 cost time: 0.9643361568450928
Epoch: 7, Steps: 257 | Train Loss: 0.5342650 Vali Loss: 0.3501581 Best vali loss: 0.3501581
	iters: 100, epoch: 8 | loss: 0.2687673
	speed: 0.0083s/iter; left time: 1.3093s
	iters: 200, epoch: 8 | loss: 0.7228745
	speed: 0.0037s/iter; left time: 0.2129s
Updating learning rate to 2.66796378828125e-06
Epoch: 8 cost time: 0.9971828460693359
Epoch: 8, Steps: 257 | Train Loss: 0.4958209 Vali Loss: 0.3520986 Best vali loss: 0.3501581

best validation loss 0.35015813249267624

[INFO][abstract_intensifier.py:595] Added config c221ed and rejected config e98a6b as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4811887
	speed: 0.0094s/iter; left time: 8.7259s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.7680261135101318
Epoch: 1, Steps: 129 | Train Loss: 0.4811887 Vali Loss: 0.3707602 Best vali loss: 0.3707602
	iters: 100, epoch: 2 | loss: 0.4821740
	speed: 0.0058s/iter; left time: 4.6240s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.3708 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.4421389102935791
Epoch: 2, Steps: 129 | Train Loss: 0.4821740 Vali Loss: 0.3669783 Best vali loss: 0.3669783
	iters: 100, epoch: 3 | loss: 0.3958572
	speed: 0.0057s/iter; left time: 3.8655s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 0.41790270805358887
Epoch: 3, Steps: 129 | Train Loss: 0.3958572 Vali Loss: 0.3780354 Best vali loss: 0.3669783
	iters: 100, epoch: 4 | loss: 0.4649741
	speed: 0.0057s/iter; left time: 3.1132s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 0.4366912841796875
Epoch: 4, Steps: 129 | Train Loss: 0.4649741 Vali Loss: 0.4099041 Best vali loss: 0.3669783
	iters: 100, epoch: 5 | loss: 0.5597113
	speed: 0.0056s/iter; left time: 2.3391s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 0.43565964698791504
Epoch: 5, Steps: 129 | Train Loss: 0.5597113 Vali Loss: 0.4115472 Best vali loss: 0.3669783
	iters: 100, epoch: 6 | loss: 0.4103152
	speed: 0.0057s/iter; left time: 1.6297s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.43338775634765625
Epoch: 6, Steps: 129 | Train Loss: 0.4103152 Vali Loss: 0.4168390 Best vali loss: 0.3669783
	iters: 100, epoch: 7 | loss: 0.4627432
	speed: 0.0057s/iter; left time: 0.9138s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.4477231502532959
Epoch: 7, Steps: 129 | Train Loss: 0.4627432 Vali Loss: 0.4163238 Best vali loss: 0.3669783
	iters: 100, epoch: 8 | loss: 0.3081226
	speed: 0.0058s/iter; left time: 0.1753s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45197629928588867
Epoch: 8, Steps: 129 | Train Loss: 0.3081226 Vali Loss: 0.4184598 Best vali loss: 0.3669783

best validation loss 0.3669783223120309

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8222441
	speed: 0.0092s/iter; left time: 8.5946s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 0.7672214508056641
Epoch: 1, Steps: 129 | Train Loss: 0.8222441 Vali Loss: 0.3723780 Best vali loss: 0.3723780
	iters: 100, epoch: 2 | loss: 0.4913020
	speed: 0.0056s/iter; left time: 4.5181s
Updating learning rate to 0.0004018465698
Epoch: 2 cost time: 0.4051375389099121
Epoch: 2, Steps: 129 | Train Loss: 0.4913020 Vali Loss: 0.4029873 Best vali loss: 0.3723780
	iters: 100, epoch: 3 | loss: 0.4982567
	speed: 0.0057s/iter; left time: 3.8432s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 0.4449803829193115
Epoch: 3, Steps: 129 | Train Loss: 0.4982567 Vali Loss: 0.3799598 Best vali loss: 0.3723780

best validation loss 0.37237800175876656

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3621423
	speed: 0.0098s/iter; left time: 19.1225s
	iters: 200, epoch: 1 | loss: 0.4732802
	speed: 0.0037s/iter; left time: 6.9135s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 1.311931848526001
Epoch: 1, Steps: 257 | Train Loss: 0.4177113 Vali Loss: 0.3652747 Best vali loss: 0.3652747
	iters: 100, epoch: 2 | loss: 0.6691783
	speed: 0.0081s/iter; left time: 13.8496s
	iters: 200, epoch: 2 | loss: 0.4645570
	speed: 0.0035s/iter; left time: 5.5654s
Updating learning rate to 0.0003076635321
Validation loss decreased (0.3653 --> 0.3592).  Saving model state dict ...
Epoch: 2 cost time: 0.9499473571777344
Epoch: 2, Steps: 257 | Train Loss: 0.5668676 Vali Loss: 0.3592382 Best vali loss: 0.3592382
	iters: 100, epoch: 3 | loss: 0.6140156
	speed: 0.0079s/iter; left time: 11.4645s
	iters: 200, epoch: 3 | loss: 0.4731193
	speed: 0.0036s/iter; left time: 4.8106s
Updating learning rate to 0.00015383176605
Validation loss decreased (0.3592 --> 0.3586).  Saving model state dict ...
Epoch: 3 cost time: 0.9557631015777588
Epoch: 3, Steps: 257 | Train Loss: 0.5435674 Vali Loss: 0.3585598 Best vali loss: 0.3585598

best validation loss 0.35855982014964277

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5744545
	speed: 0.0088s/iter; left time: 17.2937s
	iters: 200, epoch: 1 | loss: 0.3058044
	speed: 0.0026s/iter; left time: 4.8299s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.3899).  Saving model state dict ...
Epoch: 1 cost time: 1.0329880714416504
Epoch: 1, Steps: 257 | Train Loss: 0.4401295 Vali Loss: 0.3898755 Best vali loss: 0.3898755
	iters: 100, epoch: 2 | loss: 0.6151443
	speed: 0.0059s/iter; left time: 10.1023s
	iters: 200, epoch: 2 | loss: 0.7813535
	speed: 0.0025s/iter; left time: 4.0157s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.3899 --> 0.3756).  Saving model state dict ...
Epoch: 2 cost time: 0.6761319637298584
Epoch: 2, Steps: 257 | Train Loss: 0.6982489 Vali Loss: 0.3756268 Best vali loss: 0.3756268
	iters: 100, epoch: 3 | loss: 0.7081679
	speed: 0.0061s/iter; left time: 8.7970s
	iters: 200, epoch: 3 | loss: 0.3506011
	speed: 0.0025s/iter; left time: 3.2971s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.3756 --> 0.3710).  Saving model state dict ...
Epoch: 3 cost time: 0.6732332706451416
Epoch: 3, Steps: 257 | Train Loss: 0.5293845 Vali Loss: 0.3710213 Best vali loss: 0.3710213

best validation loss 0.3710212847221577

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3410850
	speed: 0.0098s/iter; left time: 11.6548s
	iters: 200, epoch: 4 | loss: 0.4066859
	speed: 0.0037s/iter; left time: 4.0317s
Updating learning rate to 7.6915883025e-05
Validation loss decreased (0.3586 --> 0.3523).  Saving model state dict ...
Epoch: 4 cost time: 1.3028781414031982
Epoch: 4, Steps: 257 | Train Loss: 0.3738855 Vali Loss: 0.3523219 Best vali loss: 0.3523219
	iters: 100, epoch: 5 | loss: 0.6588585
	speed: 0.0081s/iter; left time: 7.4839s
	iters: 200, epoch: 5 | loss: 0.3857485
	speed: 0.0037s/iter; left time: 3.0918s
Updating learning rate to 3.84579415125e-05
Epoch: 5 cost time: 0.9987046718597412
Epoch: 5, Steps: 257 | Train Loss: 0.5223035 Vali Loss: 0.3563571 Best vali loss: 0.3523219
	iters: 100, epoch: 6 | loss: 0.5662025
	speed: 0.0081s/iter; left time: 5.4691s
	iters: 200, epoch: 6 | loss: 0.4254990
	speed: 0.0037s/iter; left time: 2.1285s
Updating learning rate to 1.922897075625e-05
Epoch: 6 cost time: 0.9914727210998535
Epoch: 6, Steps: 257 | Train Loss: 0.4958507 Vali Loss: 0.3546544 Best vali loss: 0.3523219
	iters: 100, epoch: 7 | loss: 0.4071760
	speed: 0.0078s/iter; left time: 3.2523s
	iters: 200, epoch: 7 | loss: 0.4238749
	speed: 0.0035s/iter; left time: 1.0887s
Updating learning rate to 9.614485378125e-06
Epoch: 7 cost time: 0.9368143081665039
Epoch: 7, Steps: 257 | Train Loss: 0.4155255 Vali Loss: 0.3524902 Best vali loss: 0.3523219
	iters: 100, epoch: 8 | loss: 0.5555384
	speed: 0.0079s/iter; left time: 1.2418s
	iters: 200, epoch: 8 | loss: 0.7248691
	speed: 0.0036s/iter; left time: 0.2084s
Updating learning rate to 4.8072426890625e-06
Epoch: 8 cost time: 0.9741222858428955
Epoch: 8, Steps: 257 | Train Loss: 0.6402037 Vali Loss: 0.3527067 Best vali loss: 0.3523219

best validation loss 0.352321904511255

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8400228
	speed: 0.0110s/iter; left time: 21.4626s
	iters: 200, epoch: 1 | loss: 1.0493270
	speed: 0.0048s/iter; left time: 8.8463s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 1.5810050964355469
Epoch: 1, Steps: 257 | Train Loss: 0.9446749 Vali Loss: 0.3650297 Best vali loss: 0.3650297
	iters: 100, epoch: 2 | loss: 0.5123873
	speed: 0.0103s/iter; left time: 17.5407s
	iters: 200, epoch: 2 | loss: 0.6484324
	speed: 0.0048s/iter; left time: 7.6332s
Updating learning rate to 0.000101433541
Validation loss decreased (0.3650 --> 0.3569).  Saving model state dict ...
Epoch: 2 cost time: 1.2686717510223389
Epoch: 2, Steps: 257 | Train Loss: 0.5804099 Vali Loss: 0.3569013 Best vali loss: 0.3569013
	iters: 100, epoch: 3 | loss: 0.4810107
	speed: 0.0103s/iter; left time: 14.8958s
	iters: 200, epoch: 3 | loss: 0.4055078
	speed: 0.0046s/iter; left time: 6.1561s
Updating learning rate to 5.07167705e-05
Epoch: 3 cost time: 1.2198069095611572
Epoch: 3, Steps: 257 | Train Loss: 0.4432592 Vali Loss: 0.3642914 Best vali loss: 0.3569013
	iters: 100, epoch: 4 | loss: 0.4286056
	speed: 0.0099s/iter; left time: 11.7983s
	iters: 200, epoch: 4 | loss: 0.4613878
	speed: 0.0045s/iter; left time: 4.8922s
Updating learning rate to 2.535838525e-05
Validation loss decreased (0.3569 --> 0.3504).  Saving model state dict ...
Epoch: 4 cost time: 1.212958574295044
Epoch: 4, Steps: 257 | Train Loss: 0.4449967 Vali Loss: 0.3503562 Best vali loss: 0.3503562
	iters: 100, epoch: 5 | loss: 0.4737908
	speed: 0.0106s/iter; left time: 9.8680s
	iters: 200, epoch: 5 | loss: 0.4328419
	speed: 0.0048s/iter; left time: 4.0143s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 1.2833502292633057
Epoch: 5, Steps: 257 | Train Loss: 0.4533164 Vali Loss: 0.3525552 Best vali loss: 0.3503562
	iters: 100, epoch: 6 | loss: 1.1946253
	speed: 0.0102s/iter; left time: 6.8731s
	iters: 200, epoch: 6 | loss: 0.4559056
	speed: 0.0048s/iter; left time: 2.7529s
Updating learning rate to 6.3395963125e-06
Epoch: 6 cost time: 1.274061679840088
Epoch: 6, Steps: 257 | Train Loss: 0.8252654 Vali Loss: 0.3541094 Best vali loss: 0.3503562
	iters: 100, epoch: 7 | loss: 0.4699158
	speed: 0.0102s/iter; left time: 4.2271s
	iters: 200, epoch: 7 | loss: 0.3833235
	speed: 0.0048s/iter; left time: 1.5154s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 1.2675092220306396
Epoch: 7, Steps: 257 | Train Loss: 0.4266197 Vali Loss: 0.3528134 Best vali loss: 0.3503562
	iters: 100, epoch: 8 | loss: 0.4218867
	speed: 0.0102s/iter; left time: 1.6070s
	iters: 200, epoch: 8 | loss: 0.6736193
	speed: 0.0044s/iter; left time: 0.2550s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 1.2168200016021729
Epoch: 8, Steps: 257 | Train Loss: 0.5477530 Vali Loss: 0.3534901 Best vali loss: 0.3503562

best validation loss 0.3503561951790905

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5081428
	speed: 0.0096s/iter; left time: 18.7905s
	iters: 200, epoch: 1 | loss: 0.3998393
	speed: 0.0038s/iter; left time: 6.9888s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.2943542003631592
Epoch: 1, Steps: 257 | Train Loss: 0.4539910 Vali Loss: 0.3672092 Best vali loss: 0.3672092
	iters: 100, epoch: 2 | loss: 0.6790385
	speed: 0.0079s/iter; left time: 13.4465s
	iters: 200, epoch: 2 | loss: 0.6706109
	speed: 0.0035s/iter; left time: 5.5646s
Updating learning rate to 0.00017060212275
Validation loss decreased (0.3672 --> 0.3612).  Saving model state dict ...
Epoch: 2 cost time: 0.9500076770782471
Epoch: 2, Steps: 257 | Train Loss: 0.6748247 Vali Loss: 0.3611768 Best vali loss: 0.3611768
	iters: 100, epoch: 3 | loss: 0.3483652
	speed: 0.0078s/iter; left time: 11.2825s
	iters: 200, epoch: 3 | loss: 0.5327592
	speed: 0.0034s/iter; left time: 4.5090s
Updating learning rate to 8.5301061375e-05
Validation loss decreased (0.3612 --> 0.3558).  Saving model state dict ...
Epoch: 3 cost time: 0.9122395515441895
Epoch: 3, Steps: 257 | Train Loss: 0.4405622 Vali Loss: 0.3557939 Best vali loss: 0.3557939
	iters: 100, epoch: 4 | loss: 0.5919650
	speed: 0.0078s/iter; left time: 9.2907s
	iters: 200, epoch: 4 | loss: 0.4641920
	speed: 0.0036s/iter; left time: 3.9480s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 0.9690601825714111
Epoch: 4, Steps: 257 | Train Loss: 0.5280785 Vali Loss: 0.3621095 Best vali loss: 0.3557939
	iters: 100, epoch: 5 | loss: 0.4793341
	speed: 0.0083s/iter; left time: 7.6684s
	iters: 200, epoch: 5 | loss: 0.5223783
	speed: 0.0038s/iter; left time: 3.1671s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 1.0089857578277588
Epoch: 5, Steps: 257 | Train Loss: 0.5008562 Vali Loss: 0.3584234 Best vali loss: 0.3557939
	iters: 100, epoch: 6 | loss: 0.6650295
	speed: 0.0077s/iter; left time: 5.1449s
	iters: 200, epoch: 6 | loss: 0.7584730
	speed: 0.0034s/iter; left time: 1.9422s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 0.9034874439239502
Epoch: 6, Steps: 257 | Train Loss: 0.7117513 Vali Loss: 0.3619317 Best vali loss: 0.3557939
	iters: 100, epoch: 7 | loss: 0.6147783
	speed: 0.0080s/iter; left time: 3.3151s
	iters: 200, epoch: 7 | loss: 0.7661059
	speed: 0.0036s/iter; left time: 1.1414s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 0.9792277812957764
Epoch: 7, Steps: 257 | Train Loss: 0.6904421 Vali Loss: 0.3613852 Best vali loss: 0.3557939
	iters: 100, epoch: 8 | loss: 0.4486260
	speed: 0.0080s/iter; left time: 1.2606s
	iters: 200, epoch: 8 | loss: 0.6979831
	speed: 0.0037s/iter; left time: 0.2123s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 0.980820894241333
Epoch: 8, Steps: 257 | Train Loss: 0.5733046 Vali Loss: 0.3609034 Best vali loss: 0.3557939

best validation loss 0.35579389689713425

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7204728
	speed: 0.0105s/iter; left time: 9.7684s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 0.9195332527160645
Epoch: 1, Steps: 129 | Train Loss: 0.7204728 Vali Loss: 0.3676048 Best vali loss: 0.3676048
	iters: 100, epoch: 2 | loss: 0.5730880
	speed: 0.0071s/iter; left time: 5.7304s
Updating learning rate to 0.00025591859596019184
Epoch: 2 cost time: 0.5526735782623291
Epoch: 2, Steps: 129 | Train Loss: 0.5730880 Vali Loss: 0.3707542 Best vali loss: 0.3676048
	iters: 100, epoch: 3 | loss: 0.6437247
	speed: 0.0067s/iter; left time: 4.5322s
Updating learning rate to 0.00020728310997765554
Validation loss decreased (0.3676 --> 0.3505).  Saving model state dict ...
Epoch: 3 cost time: 0.5046954154968262
Epoch: 3, Steps: 129 | Train Loss: 0.6437247 Vali Loss: 0.3505434 Best vali loss: 0.3505434

best validation loss 0.35054340832125697

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6693649
	speed: 0.0094s/iter; left time: 8.7991s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.3937).  Saving model state dict ...
Epoch: 1 cost time: 0.7742369174957275
Epoch: 1, Steps: 129 | Train Loss: 0.6693649 Vali Loss: 0.3937234 Best vali loss: 0.3937234
	iters: 100, epoch: 2 | loss: 0.6208957
	speed: 0.0061s/iter; left time: 4.8778s
Updating learning rate to 0.00177094465065
Epoch: 2 cost time: 0.4468076229095459
Epoch: 2, Steps: 129 | Train Loss: 0.6208957 Vali Loss: 0.4013781 Best vali loss: 0.3937234
	iters: 100, epoch: 3 | loss: 0.5652633
	speed: 0.0059s/iter; left time: 4.0041s
Updating learning rate to 0.000885472325325
Validation loss decreased (0.3937 --> 0.3763).  Saving model state dict ...
Epoch: 3 cost time: 0.4534010887145996
Epoch: 3, Steps: 129 | Train Loss: 0.5652633 Vali Loss: 0.3762811 Best vali loss: 0.3762811

best validation loss 0.37628112170691574

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9311829
	speed: 0.0108s/iter; left time: 87.4199s
	iters: 200, epoch: 1 | loss: 0.2779590
	speed: 0.0048s/iter; left time: 38.7612s
	iters: 300, epoch: 1 | loss: 1.3028864
	speed: 0.0045s/iter; left time: 35.8275s
	iters: 400, epoch: 1 | loss: 0.5229861
	speed: 0.0046s/iter; left time: 35.7393s
	iters: 500, epoch: 1 | loss: 1.3628356
	speed: 0.0045s/iter; left time: 34.9852s
	iters: 600, epoch: 1 | loss: 1.3462019
	speed: 0.0046s/iter; left time: 34.7732s
	iters: 700, epoch: 1 | loss: 0.4815045
	speed: 0.0046s/iter; left time: 34.7486s
	iters: 800, epoch: 1 | loss: 0.4565451
	speed: 0.0046s/iter; left time: 33.8581s
	iters: 900, epoch: 1 | loss: 0.3802772
	speed: 0.0046s/iter; left time: 33.6530s
	iters: 1000, epoch: 1 | loss: 0.4956639
	speed: 0.0048s/iter; left time: 34.5379s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.4010).  Saving model state dict ...
Epoch: 1 cost time: 5.117215633392334
Epoch: 1, Steps: 1027 | Train Loss: 0.7558043 Vali Loss: 0.4010265 Best vali loss: 0.4010265
	iters: 100, epoch: 2 | loss: 0.7750127
	speed: 0.0130s/iter; left time: 92.0525s
	iters: 200, epoch: 2 | loss: 0.3970651
	speed: 0.0051s/iter; left time: 35.5856s
	iters: 300, epoch: 2 | loss: 0.4110726
	speed: 0.0051s/iter; left time: 35.1319s
	iters: 400, epoch: 2 | loss: 0.3171439
	speed: 0.0051s/iter; left time: 34.6880s
	iters: 500, epoch: 2 | loss: 0.3061584
	speed: 0.0051s/iter; left time: 34.1045s
	iters: 600, epoch: 2 | loss: 0.7813728
	speed: 0.0051s/iter; left time: 33.4324s
	iters: 700, epoch: 2 | loss: 0.3389444
	speed: 0.0050s/iter; left time: 32.7702s
	iters: 800, epoch: 2 | loss: 1.4457757
	speed: 0.0051s/iter; left time: 32.4678s
	iters: 900, epoch: 2 | loss: 0.8791264
	speed: 0.0051s/iter; left time: 32.0150s
	iters: 1000, epoch: 2 | loss: 0.3666762
	speed: 0.0051s/iter; left time: 31.5670s
Updating learning rate to 0.002058451742387382
Validation loss decreased (0.4010 --> 0.4001).  Saving model state dict ...
Epoch: 2 cost time: 5.265220880508423
Epoch: 2, Steps: 1027 | Train Loss: 0.6018348 Vali Loss: 0.4001437 Best vali loss: 0.4001437
	iters: 100, epoch: 3 | loss: 0.3937176
	speed: 0.0128s/iter; left time: 77.8455s
	iters: 200, epoch: 3 | loss: 0.4744630
	speed: 0.0051s/iter; left time: 30.3468s
	iters: 300, epoch: 3 | loss: 0.5489564
	speed: 0.0051s/iter; left time: 29.9100s
	iters: 400, epoch: 3 | loss: 0.2300292
	speed: 0.0051s/iter; left time: 29.3846s
	iters: 500, epoch: 3 | loss: 0.3886760
	speed: 0.0050s/iter; left time: 28.4786s
	iters: 600, epoch: 3 | loss: 0.4484844
	speed: 0.0052s/iter; left time: 28.8616s
	iters: 700, epoch: 3 | loss: 0.6374352
	speed: 0.0051s/iter; left time: 28.0515s
	iters: 800, epoch: 3 | loss: 1.1809425
	speed: 0.0050s/iter; left time: 27.0660s
	iters: 900, epoch: 3 | loss: 1.7864114
	speed: 0.0051s/iter; left time: 26.8136s
	iters: 1000, epoch: 3 | loss: 0.7864166
	speed: 0.0051s/iter; left time: 26.3284s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 5.262512683868408
Epoch: 3, Steps: 1027 | Train Loss: 0.6875532 Vali Loss: 0.4041231 Best vali loss: 0.4001437

best validation loss 0.40014365494017046

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5440795
	speed: 0.0104s/iter; left time: 5.6526s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 0.8823881149291992
Epoch: 4, Steps: 129 | Train Loss: 0.5440795 Vali Loss: 0.3530991 Best vali loss: 0.3505434
	iters: 100, epoch: 5 | loss: 0.4464834
	speed: 0.0069s/iter; left time: 2.8608s
Updating learning rate to 9.254417532234449e-05
Epoch: 5 cost time: 0.5435781478881836
Epoch: 5, Steps: 129 | Train Loss: 0.4464834 Vali Loss: 0.3695390 Best vali loss: 0.3505434
	iters: 100, epoch: 6 | loss: 0.5631809
	speed: 0.0067s/iter; left time: 1.9339s
Updating learning rate to 4.3908689339808184e-05
Validation loss decreased (0.3505 --> 0.3498).  Saving model state dict ...
Epoch: 6 cost time: 0.5394558906555176
Epoch: 6, Steps: 129 | Train Loss: 0.5631809 Vali Loss: 0.3498120 Best vali loss: 0.3498120
	iters: 100, epoch: 7 | loss: 0.6484976
	speed: 0.0071s/iter; left time: 1.1360s
Updating learning rate to 1.1411496561453903e-05
Epoch: 7 cost time: 0.5277397632598877
Epoch: 7, Steps: 129 | Train Loss: 0.6484976 Vali Loss: 0.3544245 Best vali loss: 0.3498120
	iters: 100, epoch: 8 | loss: 0.3793679
	speed: 0.0067s/iter; left time: 0.2005s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5281071662902832
Epoch: 8, Steps: 129 | Train Loss: 0.3793679 Vali Loss: 0.3520291 Best vali loss: 0.3498120

best validation loss 0.34981202142411927

[INFO][abstract_intensifier.py:595] Added config 134b22 and rejected config c221ed as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5185911
	speed: 0.0095s/iter; left time: 38.0939s
	iters: 200, epoch: 1 | loss: 0.5836433
	speed: 0.0036s/iter; left time: 13.9853s
	iters: 300, epoch: 1 | loss: 0.6612632
	speed: 0.0036s/iter; left time: 13.6661s
	iters: 400, epoch: 1 | loss: 0.8641966
	speed: 0.0033s/iter; left time: 12.0976s
	iters: 500, epoch: 1 | loss: 0.8824865
	speed: 0.0031s/iter; left time: 11.0303s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 2.091261148452759
Epoch: 1, Steps: 514 | Train Loss: 0.7020361 Vali Loss: 0.3654461 Best vali loss: 0.3654461
	iters: 100, epoch: 2 | loss: 0.7792537
	speed: 0.0069s/iter; left time: 24.2586s
	iters: 200, epoch: 2 | loss: 1.1851294
	speed: 0.0030s/iter; left time: 10.2034s
	iters: 300, epoch: 2 | loss: 0.8616255
	speed: 0.0031s/iter; left time: 10.1981s
	iters: 400, epoch: 2 | loss: 0.3796185
	speed: 0.0031s/iter; left time: 9.8116s
	iters: 500, epoch: 2 | loss: 1.0950547
	speed: 0.0031s/iter; left time: 9.5280s
Updating learning rate to 0.0001296388417
Epoch: 2 cost time: 1.6292457580566406
Epoch: 2, Steps: 514 | Train Loss: 0.8601364 Vali Loss: 0.3680745 Best vali loss: 0.3654461
	iters: 100, epoch: 3 | loss: 0.3339100
	speed: 0.0076s/iter; left time: 22.6696s
	iters: 200, epoch: 3 | loss: 0.4149166
	speed: 0.0037s/iter; left time: 10.5709s
	iters: 300, epoch: 3 | loss: 0.7139169
	speed: 0.0036s/iter; left time: 9.9446s
	iters: 400, epoch: 3 | loss: 0.6720394
	speed: 0.0035s/iter; left time: 9.5176s
	iters: 500, epoch: 3 | loss: 0.2639640
	speed: 0.0037s/iter; left time: 9.5542s
Updating learning rate to 6.481942085e-05
Epoch: 3 cost time: 1.9071118831634521
Epoch: 3, Steps: 514 | Train Loss: 0.4797494 Vali Loss: 0.3672984 Best vali loss: 0.3654461
	iters: 100, epoch: 4 | loss: 1.0400360
	speed: 0.0075s/iter; left time: 18.5022s
	iters: 200, epoch: 4 | loss: 0.4566929
	speed: 0.0035s/iter; left time: 8.1950s
	iters: 300, epoch: 4 | loss: 1.3838750
	speed: 0.0033s/iter; left time: 7.5306s
	iters: 400, epoch: 4 | loss: 0.6596816
	speed: 0.0036s/iter; left time: 7.7220s
	iters: 500, epoch: 4 | loss: 0.4245991
	speed: 0.0035s/iter; left time: 7.3002s
Updating learning rate to 3.2409710425e-05
Epoch: 4 cost time: 1.8371663093566895
Epoch: 4, Steps: 514 | Train Loss: 0.7929769 Vali Loss: 0.3710691 Best vali loss: 0.3654461
	iters: 100, epoch: 5 | loss: 0.3984342
	speed: 0.0071s/iter; left time: 13.8019s
	iters: 200, epoch: 5 | loss: 0.4044555
	speed: 0.0032s/iter; left time: 5.9033s
	iters: 300, epoch: 5 | loss: 1.3013753
	speed: 0.0031s/iter; left time: 5.4696s
	iters: 400, epoch: 5 | loss: 0.4955320
	speed: 0.0031s/iter; left time: 5.1472s
	iters: 500, epoch: 5 | loss: 0.8083200
	speed: 0.0031s/iter; left time: 4.7504s
Updating learning rate to 1.62048552125e-05
Epoch: 5 cost time: 1.6388754844665527
Epoch: 5, Steps: 514 | Train Loss: 0.6816234 Vali Loss: 0.3700048 Best vali loss: 0.3654461
	iters: 100, epoch: 6 | loss: 0.2846982
	speed: 0.0070s/iter; left time: 10.0521s
	iters: 200, epoch: 6 | loss: 0.4883316
	speed: 0.0032s/iter; left time: 4.2484s
	iters: 300, epoch: 6 | loss: 0.3892869
	speed: 0.0032s/iter; left time: 4.0366s
	iters: 400, epoch: 6 | loss: 0.4586124
	speed: 0.0031s/iter; left time: 3.5245s
	iters: 500, epoch: 6 | loss: 1.3600582
	speed: 0.0031s/iter; left time: 3.1978s
Updating learning rate to 8.10242760625e-06
Epoch: 6 cost time: 1.663503646850586
Epoch: 6, Steps: 514 | Train Loss: 0.5961974 Vali Loss: 0.3703691 Best vali loss: 0.3654461
	iters: 100, epoch: 7 | loss: 0.5890645
	speed: 0.0072s/iter; left time: 6.6515s
	iters: 200, epoch: 7 | loss: 0.8059928
	speed: 0.0035s/iter; left time: 2.9157s
	iters: 300, epoch: 7 | loss: 0.3532727
	speed: 0.0034s/iter; left time: 2.4888s
	iters: 400, epoch: 7 | loss: 0.4748656
	speed: 0.0034s/iter; left time: 2.1328s
	iters: 500, epoch: 7 | loss: 0.7079091
	speed: 0.0032s/iter; left time: 1.6681s
Updating learning rate to 4.051213803125e-06
Epoch: 7 cost time: 1.7823941707611084
Epoch: 7, Steps: 514 | Train Loss: 0.5862209 Vali Loss: 0.3706284 Best vali loss: 0.3654461
	iters: 100, epoch: 8 | loss: 0.6614643
	speed: 0.0072s/iter; left time: 2.9695s
	iters: 200, epoch: 8 | loss: 0.7227976
	speed: 0.0034s/iter; left time: 1.0712s
	iters: 300, epoch: 8 | loss: 0.4062247
	speed: 0.0034s/iter; left time: 0.7280s
	iters: 400, epoch: 8 | loss: 0.5641488
	speed: 0.0034s/iter; left time: 0.3914s
	iters: 500, epoch: 8 | loss: 0.7511723
	speed: 0.0034s/iter; left time: 0.0517s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 1.7978694438934326
Epoch: 8, Steps: 514 | Train Loss: 0.6211616 Vali Loss: 0.3709589 Best vali loss: 0.3654461

best validation loss 0.36544607693882025

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6240085
	speed: 0.0102s/iter; left time: 9.4783s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.4357).  Saving model state dict ...
Epoch: 1 cost time: 0.8858397006988525
Epoch: 1, Steps: 129 | Train Loss: 0.6240085 Vali Loss: 0.4357295 Best vali loss: 0.4357295
	iters: 100, epoch: 2 | loss: 0.6947989
	speed: 0.0069s/iter; left time: 5.5389s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.4357 --> 0.4204).  Saving model state dict ...
Epoch: 2 cost time: 0.5433790683746338
Epoch: 2, Steps: 129 | Train Loss: 0.6947989 Vali Loss: 0.4204398 Best vali loss: 0.4204398
	iters: 100, epoch: 3 | loss: 0.5958984
	speed: 0.0067s/iter; left time: 4.5132s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.4204 --> 0.4141).  Saving model state dict ...
Epoch: 3 cost time: 0.5270535945892334
Epoch: 3, Steps: 129 | Train Loss: 0.5958984 Vali Loss: 0.4140592 Best vali loss: 0.4140592
	iters: 100, epoch: 4 | loss: 0.7797271
	speed: 0.0070s/iter; left time: 3.8001s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.4141 --> 0.4112).  Saving model state dict ...
Epoch: 4 cost time: 0.551823616027832
Epoch: 4, Steps: 129 | Train Loss: 0.7797271 Vali Loss: 0.4112404 Best vali loss: 0.4112404
	iters: 100, epoch: 5 | loss: 0.5401006
	speed: 0.0068s/iter; left time: 2.8336s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.4112 --> 0.4099).  Saving model state dict ...
Epoch: 5 cost time: 0.5436203479766846
Epoch: 5, Steps: 129 | Train Loss: 0.5401006 Vali Loss: 0.4098757 Best vali loss: 0.4098757
	iters: 100, epoch: 6 | loss: 0.6520095
	speed: 0.0067s/iter; left time: 1.9377s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.4099 --> 0.4092).  Saving model state dict ...
Epoch: 6 cost time: 0.5352263450622559
Epoch: 6, Steps: 129 | Train Loss: 0.6520095 Vali Loss: 0.4091990 Best vali loss: 0.4091990
	iters: 100, epoch: 7 | loss: 1.2859218
	speed: 0.0069s/iter; left time: 1.1030s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.4092 --> 0.4089).  Saving model state dict ...
Epoch: 7 cost time: 0.5585410594940186
Epoch: 7, Steps: 129 | Train Loss: 1.2859218 Vali Loss: 0.4088659 Best vali loss: 0.4088659
	iters: 100, epoch: 8 | loss: 0.6633461
	speed: 0.0069s/iter; left time: 0.2062s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.4089 --> 0.4087).  Saving model state dict ...
Epoch: 8 cost time: 0.5341887474060059
Epoch: 8, Steps: 129 | Train Loss: 0.6633461 Vali Loss: 0.4086981 Best vali loss: 0.4086981

best validation loss 0.4086980986923038

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.3643).  Saving model state dict ...
Epoch: 1 cost time: 0.6440861225128174
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3642987 Best vali loss: 0.3642987
Updating learning rate to 0.001942790473283107
Epoch: 2 cost time: 0.35593366622924805
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3759728 Best vali loss: 0.3642987
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 0.3421764373779297
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3790910 Best vali loss: 0.3642987

best validation loss 0.3642986882880535

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.4178).  Saving model state dict ...
Epoch: 1 cost time: 0.7076575756072998
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4177734 Best vali loss: 0.4177734
Updating learning rate to 0.0001189273387
Validation loss decreased (0.4178 --> 0.3972).  Saving model state dict ...
Epoch: 2 cost time: 0.42292332649230957
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3972343 Best vali loss: 0.3972343
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.3972 --> 0.3910).  Saving model state dict ...
Epoch: 3 cost time: 0.4156506061553955
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3909636 Best vali loss: 0.3909636

best validation loss 0.39096359648030027

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 0.6555542945861816
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3716312 Best vali loss: 0.3716312
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.3716 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 0.3372948169708252
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3648564 Best vali loss: 0.3648564
Updating learning rate to 0.00043994959105690174
Epoch: 3 cost time: 0.3217625617980957
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3681276 Best vali loss: 0.3648564

best validation loss 0.3648563986911287

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0011380603104
Epoch: 4 cost time: 0.636786937713623
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3847143 Best vali loss: 0.3642987
Updating learning rate to 0.0007025434845776485
Epoch: 5 cost time: 0.3383941650390625
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3920055 Best vali loss: 0.3642987
Updating learning rate to 0.0003333301475168929
Epoch: 6 cost time: 0.34272003173828125
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4014111 Best vali loss: 0.3642987
Updating learning rate to 8.662968285799812e-05
Epoch: 7 cost time: 0.3567948341369629
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3975965 Best vali loss: 0.3642987
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3533637523651123
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3964540 Best vali loss: 0.3642987

best validation loss 0.3642986882880535

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0695324
	speed: 0.0100s/iter; left time: 81.0280s
	iters: 200, epoch: 1 | loss: 0.3702009
	speed: 0.0042s/iter; left time: 33.5612s
	iters: 300, epoch: 1 | loss: 0.4318048
	speed: 0.0042s/iter; left time: 33.2872s
	iters: 400, epoch: 1 | loss: 0.2339409
	speed: 0.0042s/iter; left time: 33.1224s
	iters: 500, epoch: 1 | loss: 0.8787757
	speed: 0.0042s/iter; left time: 32.5825s
	iters: 600, epoch: 1 | loss: 0.4530901
	speed: 0.0042s/iter; left time: 31.8180s
	iters: 700, epoch: 1 | loss: 0.6034732
	speed: 0.0042s/iter; left time: 31.7045s
	iters: 800, epoch: 1 | loss: 0.4244298
	speed: 0.0042s/iter; left time: 31.4477s
	iters: 900, epoch: 1 | loss: 0.2235518
	speed: 0.0043s/iter; left time: 31.2903s
	iters: 1000, epoch: 1 | loss: 0.6522905
	speed: 0.0042s/iter; left time: 30.3723s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 4.66480827331543
Epoch: 1, Steps: 1027 | Train Loss: 0.5341090 Vali Loss: 0.3693082 Best vali loss: 0.3693082
	iters: 100, epoch: 2 | loss: 0.2166609
	speed: 0.0113s/iter; left time: 80.1131s
	iters: 200, epoch: 2 | loss: 1.5661639
	speed: 0.0041s/iter; left time: 28.9931s
	iters: 300, epoch: 2 | loss: 0.2043442
	speed: 0.0042s/iter; left time: 28.7583s
	iters: 400, epoch: 2 | loss: 0.3039296
	speed: 0.0042s/iter; left time: 28.3170s
	iters: 500, epoch: 2 | loss: 0.6007865
	speed: 0.0042s/iter; left time: 27.8265s
	iters: 600, epoch: 2 | loss: 0.2674896
	speed: 0.0042s/iter; left time: 27.4682s
	iters: 700, epoch: 2 | loss: 1.3648551
	speed: 0.0041s/iter; left time: 26.7676s
	iters: 800, epoch: 2 | loss: 0.2751463
	speed: 0.0042s/iter; left time: 26.6685s
	iters: 900, epoch: 2 | loss: 0.5349398
	speed: 0.0041s/iter; left time: 25.6059s
	iters: 1000, epoch: 2 | loss: 1.0389615
	speed: 0.0040s/iter; left time: 24.6246s
Updating learning rate to 0.0006127786597521479
Validation loss decreased (0.3693 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 4.277547359466553
Epoch: 2, Steps: 1027 | Train Loss: 0.6373278 Vali Loss: 0.3689726 Best vali loss: 0.3689726
	iters: 100, epoch: 3 | loss: 0.4472597
	speed: 0.0104s/iter; left time: 62.9014s
	iters: 200, epoch: 3 | loss: 0.5314680
	speed: 0.0037s/iter; left time: 22.0556s
	iters: 300, epoch: 3 | loss: 0.3023969
	speed: 0.0037s/iter; left time: 21.4453s
	iters: 400, epoch: 3 | loss: 0.3263136
	speed: 0.0036s/iter; left time: 21.0320s
	iters: 500, epoch: 3 | loss: 0.5472047
	speed: 0.0035s/iter; left time: 19.7415s
	iters: 600, epoch: 3 | loss: 0.3677925
	speed: 0.0035s/iter; left time: 19.5075s
	iters: 700, epoch: 3 | loss: 0.2823272
	speed: 0.0035s/iter; left time: 19.0927s
	iters: 800, epoch: 3 | loss: 0.2998399
	speed: 0.0035s/iter; left time: 18.8581s
	iters: 900, epoch: 3 | loss: 0.5543708
	speed: 0.0035s/iter; left time: 18.3567s
	iters: 1000, epoch: 3 | loss: 0.2357439
	speed: 0.0035s/iter; left time: 18.1602s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 3.708651065826416
Epoch: 3, Steps: 1027 | Train Loss: 0.3894717 Vali Loss: 0.3732626 Best vali loss: 0.3689726
	iters: 100, epoch: 4 | loss: 1.0732813
	speed: 0.0107s/iter; left time: 53.8324s
	iters: 200, epoch: 4 | loss: 0.3512879
	speed: 0.0040s/iter; left time: 19.6584s
	iters: 300, epoch: 4 | loss: 0.5315157
	speed: 0.0040s/iter; left time: 19.1951s
	iters: 400, epoch: 4 | loss: 0.2305881
	speed: 0.0040s/iter; left time: 18.8067s
	iters: 500, epoch: 4 | loss: 0.8422014
	speed: 0.0040s/iter; left time: 18.4527s
	iters: 600, epoch: 4 | loss: 0.3880744
	speed: 0.0039s/iter; left time: 17.8698s
	iters: 700, epoch: 4 | loss: 0.4964029
	speed: 0.0040s/iter; left time: 17.6973s
	iters: 800, epoch: 4 | loss: 0.5870662
	speed: 0.0040s/iter; left time: 17.3069s
	iters: 900, epoch: 4 | loss: 0.3652101
	speed: 0.0040s/iter; left time: 16.9052s
	iters: 1000, epoch: 4 | loss: 0.4743859
	speed: 0.0040s/iter; left time: 16.4517s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 4.119503736495972
Epoch: 4, Steps: 1027 | Train Loss: 0.5340014 Vali Loss: 0.3767083 Best vali loss: 0.3689726
	iters: 100, epoch: 5 | loss: 0.7289863
	speed: 0.0102s/iter; left time: 40.9238s
	iters: 200, epoch: 5 | loss: 0.2524658
	speed: 0.0035s/iter; left time: 13.7276s
	iters: 300, epoch: 5 | loss: 0.3741769
	speed: 0.0035s/iter; left time: 13.3019s
	iters: 400, epoch: 5 | loss: 0.3167796
	speed: 0.0035s/iter; left time: 12.9260s
	iters: 500, epoch: 5 | loss: 0.3300864
	speed: 0.0035s/iter; left time: 12.6467s
	iters: 600, epoch: 5 | loss: 0.3348369
	speed: 0.0035s/iter; left time: 12.3213s
	iters: 700, epoch: 5 | loss: 0.4698519
	speed: 0.0035s/iter; left time: 11.9299s
	iters: 800, epoch: 5 | loss: 0.8543795
	speed: 0.0035s/iter; left time: 11.4597s
	iters: 900, epoch: 5 | loss: 0.3158609
	speed: 0.0035s/iter; left time: 11.2068s
	iters: 1000, epoch: 5 | loss: 1.1108865
	speed: 0.0035s/iter; left time: 10.7665s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 3.623032331466675
Epoch: 5, Steps: 1027 | Train Loss: 0.5088311 Vali Loss: 0.3775275 Best vali loss: 0.3689726
	iters: 100, epoch: 6 | loss: 0.5348079
	speed: 0.0099s/iter; left time: 29.6354s
	iters: 200, epoch: 6 | loss: 0.9640706
	speed: 0.0035s/iter; left time: 10.0535s
	iters: 300, epoch: 6 | loss: 0.2166191
	speed: 0.0035s/iter; left time: 9.6185s
	iters: 400, epoch: 6 | loss: 0.7964060
	speed: 0.0035s/iter; left time: 9.3055s
	iters: 500, epoch: 6 | loss: 1.1886005
	speed: 0.0035s/iter; left time: 8.9760s
	iters: 600, epoch: 6 | loss: 0.5894332
	speed: 0.0035s/iter; left time: 8.6301s
	iters: 700, epoch: 6 | loss: 0.3652717
	speed: 0.0035s/iter; left time: 8.2450s
	iters: 800, epoch: 6 | loss: 0.9648194
	speed: 0.0035s/iter; left time: 7.9677s
	iters: 900, epoch: 6 | loss: 0.2759047
	speed: 0.0035s/iter; left time: 7.6015s
	iters: 1000, epoch: 6 | loss: 0.5624241
	speed: 0.0035s/iter; left time: 7.2034s
Updating learning rate to 0.00010513619654785212
Epoch: 6 cost time: 3.6053454875946045
Epoch: 6, Steps: 1027 | Train Loss: 0.6458357 Vali Loss: 0.3825936 Best vali loss: 0.3689726
	iters: 100, epoch: 7 | loss: 0.5091822
	speed: 0.0111s/iter; left time: 21.7813s
	iters: 200, epoch: 7 | loss: 1.4047532
	speed: 0.0042s/iter; left time: 7.7931s
	iters: 300, epoch: 7 | loss: 0.4093646
	speed: 0.0041s/iter; left time: 7.1628s
	iters: 400, epoch: 7 | loss: 0.4008441
	speed: 0.0041s/iter; left time: 6.7070s
	iters: 500, epoch: 7 | loss: 1.5831329
	speed: 0.0041s/iter; left time: 6.3031s
	iters: 600, epoch: 7 | loss: 0.4139748
	speed: 0.0040s/iter; left time: 5.8212s
	iters: 700, epoch: 7 | loss: 0.2811396
	speed: 0.0040s/iter; left time: 5.4200s
	iters: 800, epoch: 7 | loss: 0.7303380
	speed: 0.0040s/iter; left time: 5.0325s
	iters: 900, epoch: 7 | loss: 0.7306108
	speed: 0.0040s/iter; left time: 4.6193s
	iters: 1000, epoch: 7 | loss: 0.5910571
	speed: 0.0040s/iter; left time: 4.2243s
Updating learning rate to 2.7324007239324203e-05
Epoch: 7 cost time: 4.207002639770508
Epoch: 7, Steps: 1027 | Train Loss: 0.7054397 Vali Loss: 0.3902874 Best vali loss: 0.3689726
	iters: 100, epoch: 8 | loss: 0.2613695
	speed: 0.0106s/iter; left time: 9.8575s
	iters: 200, epoch: 8 | loss: 0.4861359
	speed: 0.0040s/iter; left time: 3.3117s
	iters: 300, epoch: 8 | loss: 0.7847692
	speed: 0.0040s/iter; left time: 2.9436s
	iters: 400, epoch: 8 | loss: 0.2462672
	speed: 0.0040s/iter; left time: 2.5159s
	iters: 500, epoch: 8 | loss: 0.2617988
	speed: 0.0040s/iter; left time: 2.1263s
	iters: 600, epoch: 8 | loss: 1.2873549
	speed: 0.0041s/iter; left time: 1.7441s
	iters: 700, epoch: 8 | loss: 0.6441470
	speed: 0.0040s/iter; left time: 1.2966s
	iters: 800, epoch: 8 | loss: 0.6448189
	speed: 0.0039s/iter; left time: 0.8893s
	iters: 900, epoch: 8 | loss: 0.4655391
	speed: 0.0039s/iter; left time: 0.4983s
	iters: 1000, epoch: 8 | loss: 0.6616184
	speed: 0.0038s/iter; left time: 0.1068s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.115086078643799
Epoch: 8, Steps: 1027 | Train Loss: 0.5743819 Vali Loss: 0.3871197 Best vali loss: 0.3689726

best validation loss 0.36897260962979966

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8328959
	speed: 0.0081s/iter; left time: 65.9494s
	iters: 200, epoch: 1 | loss: 0.2923300
	speed: 0.0023s/iter; left time: 18.1191s
	iters: 300, epoch: 1 | loss: 1.1499056
	speed: 0.0023s/iter; left time: 17.8595s
	iters: 400, epoch: 1 | loss: 0.4717554
	speed: 0.0022s/iter; left time: 17.5547s
	iters: 500, epoch: 1 | loss: 0.4388565
	speed: 0.0022s/iter; left time: 17.3604s
	iters: 600, epoch: 1 | loss: 0.3002563
	speed: 0.0023s/iter; left time: 17.1765s
	iters: 700, epoch: 1 | loss: 0.8430382
	speed: 0.0022s/iter; left time: 16.8865s
	iters: 800, epoch: 1 | loss: 0.3489062
	speed: 0.0023s/iter; left time: 16.7347s
	iters: 900, epoch: 1 | loss: 1.0456532
	speed: 0.0023s/iter; left time: 16.5096s
	iters: 1000, epoch: 1 | loss: 0.4128056
	speed: 0.0023s/iter; left time: 16.3153s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 2.6555871963500977
Epoch: 1, Steps: 1027 | Train Loss: 0.6136403 Vali Loss: 0.3657311 Best vali loss: 0.3657311
	iters: 100, epoch: 2 | loss: 0.5288954
	speed: 0.0075s/iter; left time: 53.1782s
	iters: 200, epoch: 2 | loss: 0.4483832
	speed: 0.0026s/iter; left time: 18.1404s
	iters: 300, epoch: 2 | loss: 0.2921532
	speed: 0.0026s/iter; left time: 17.5773s
	iters: 400, epoch: 2 | loss: 0.3300559
	speed: 0.0025s/iter; left time: 17.2684s
	iters: 500, epoch: 2 | loss: 0.2483599
	speed: 0.0024s/iter; left time: 16.2115s
	iters: 600, epoch: 2 | loss: 0.4105301
	speed: 0.0024s/iter; left time: 16.0639s
	iters: 700, epoch: 2 | loss: 0.4785316
	speed: 0.0025s/iter; left time: 16.2602s
	iters: 800, epoch: 2 | loss: 0.4443923
	speed: 0.0025s/iter; left time: 15.9367s
	iters: 900, epoch: 2 | loss: 1.0762138
	speed: 0.0025s/iter; left time: 15.7725s
	iters: 1000, epoch: 2 | loss: 1.1118360
	speed: 0.0025s/iter; left time: 15.2735s
Updating learning rate to 0.0004712667668926594
Epoch: 2 cost time: 2.601672649383545
Epoch: 2, Steps: 1027 | Train Loss: 0.5369351 Vali Loss: 0.3756105 Best vali loss: 0.3657311
	iters: 100, epoch: 3 | loss: 0.6498420
	speed: 0.0075s/iter; left time: 45.6721s
	iters: 200, epoch: 3 | loss: 0.5739467
	speed: 0.0025s/iter; left time: 14.7122s
	iters: 300, epoch: 3 | loss: 0.2376169
	speed: 0.0025s/iter; left time: 14.3777s
	iters: 400, epoch: 3 | loss: 0.8122805
	speed: 0.0024s/iter; left time: 14.0290s
	iters: 500, epoch: 3 | loss: 0.7849454
	speed: 0.0025s/iter; left time: 14.0025s
	iters: 600, epoch: 3 | loss: 0.6715453
	speed: 0.0024s/iter; left time: 13.4987s
	iters: 700, epoch: 3 | loss: 0.4498715
	speed: 0.0023s/iter; left time: 12.6731s
	iters: 800, epoch: 3 | loss: 0.6067699
	speed: 0.0022s/iter; left time: 11.9200s
	iters: 900, epoch: 3 | loss: 0.5250772
	speed: 0.0022s/iter; left time: 11.8248s
	iters: 1000, epoch: 3 | loss: 0.6177434
	speed: 0.0023s/iter; left time: 11.6853s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 2.4697020053863525
Epoch: 3, Steps: 1027 | Train Loss: 0.5929639 Vali Loss: 0.3717102 Best vali loss: 0.3657311
	iters: 100, epoch: 4 | loss: 0.4670298
	speed: 0.0076s/iter; left time: 38.3604s
	iters: 200, epoch: 4 | loss: 0.9885210
	speed: 0.0024s/iter; left time: 11.7373s
	iters: 300, epoch: 4 | loss: 0.3469754
	speed: 0.0024s/iter; left time: 11.4724s
	iters: 400, epoch: 4 | loss: 0.4534771
	speed: 0.0024s/iter; left time: 11.3177s
	iters: 500, epoch: 4 | loss: 0.6216821
	speed: 0.0024s/iter; left time: 11.0281s
	iters: 600, epoch: 4 | loss: 0.4847644
	speed: 0.0024s/iter; left time: 10.8003s
	iters: 700, epoch: 4 | loss: 0.2111301
	speed: 0.0024s/iter; left time: 10.6020s
	iters: 800, epoch: 4 | loss: 0.6295589
	speed: 0.0024s/iter; left time: 10.2153s
	iters: 900, epoch: 4 | loss: 0.9373939
	speed: 0.0023s/iter; left time: 9.9047s
	iters: 1000, epoch: 4 | loss: 0.5558059
	speed: 0.0024s/iter; left time: 9.8680s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 2.4807119369506836
Epoch: 4, Steps: 1027 | Train Loss: 0.5696339 Vali Loss: 0.3775047 Best vali loss: 0.3657311
	iters: 100, epoch: 5 | loss: 0.2609310
	speed: 0.0071s/iter; left time: 28.6238s
	iters: 200, epoch: 5 | loss: 0.5279371
	speed: 0.0022s/iter; left time: 8.7111s
	iters: 300, epoch: 5 | loss: 0.8550663
	speed: 0.0023s/iter; left time: 8.6092s
	iters: 400, epoch: 5 | loss: 0.8122178
	speed: 0.0023s/iter; left time: 8.3893s
	iters: 500, epoch: 5 | loss: 0.3317558
	speed: 0.0022s/iter; left time: 8.0791s
	iters: 600, epoch: 5 | loss: 0.8297693
	speed: 0.0023s/iter; left time: 7.9813s
	iters: 700, epoch: 5 | loss: 1.0743775
	speed: 0.0023s/iter; left time: 7.7365s
	iters: 800, epoch: 5 | loss: 0.4208552
	speed: 0.0023s/iter; left time: 7.4786s
	iters: 900, epoch: 5 | loss: 0.4014939
	speed: 0.0023s/iter; left time: 7.2747s
	iters: 1000, epoch: 5 | loss: 0.2580173
	speed: 0.0023s/iter; left time: 7.0390s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 2.3423640727996826
Epoch: 5, Steps: 1027 | Train Loss: 0.5772421 Vali Loss: 0.4035815 Best vali loss: 0.3657311
	iters: 100, epoch: 6 | loss: 0.5352368
	speed: 0.0075s/iter; left time: 22.2270s
	iters: 200, epoch: 6 | loss: 0.2916093
	speed: 0.0023s/iter; left time: 6.5899s
	iters: 300, epoch: 6 | loss: 0.2885601
	speed: 0.0022s/iter; left time: 6.0058s
	iters: 400, epoch: 6 | loss: 0.2231092
	speed: 0.0021s/iter; left time: 5.7441s
	iters: 500, epoch: 6 | loss: 0.3063154
	speed: 0.0021s/iter; left time: 5.4957s
	iters: 600, epoch: 6 | loss: 0.2840458
	speed: 0.0021s/iter; left time: 5.2928s
	iters: 700, epoch: 6 | loss: 0.2825433
	speed: 0.0024s/iter; left time: 5.6041s
	iters: 800, epoch: 6 | loss: 0.3283652
	speed: 0.0024s/iter; left time: 5.4453s
	iters: 900, epoch: 6 | loss: 1.3364178
	speed: 0.0024s/iter; left time: 5.1884s
	iters: 1000, epoch: 6 | loss: 0.4646626
	speed: 0.0024s/iter; left time: 4.9957s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 2.3745055198669434
Epoch: 6, Steps: 1027 | Train Loss: 0.4340866 Vali Loss: 0.3905456 Best vali loss: 0.3657311
	iters: 100, epoch: 7 | loss: 0.3335433
	speed: 0.0075s/iter; left time: 14.7000s
	iters: 200, epoch: 7 | loss: 0.7879366
	speed: 0.0024s/iter; left time: 4.4161s
	iters: 300, epoch: 7 | loss: 0.3225951
	speed: 0.0025s/iter; left time: 4.4727s
	iters: 400, epoch: 7 | loss: 0.3822911
	speed: 0.0024s/iter; left time: 4.0132s
	iters: 500, epoch: 7 | loss: 0.2989456
	speed: 0.0024s/iter; left time: 3.7261s
	iters: 600, epoch: 7 | loss: 0.7053707
	speed: 0.0024s/iter; left time: 3.5246s
	iters: 700, epoch: 7 | loss: 0.4883374
	speed: 0.0024s/iter; left time: 3.2982s
	iters: 800, epoch: 7 | loss: 0.2507022
	speed: 0.0024s/iter; left time: 3.0568s
	iters: 900, epoch: 7 | loss: 0.5041479
	speed: 0.0025s/iter; left time: 2.8793s
	iters: 1000, epoch: 7 | loss: 0.4634567
	speed: 0.0024s/iter; left time: 2.4890s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 2.529391050338745
Epoch: 7, Steps: 1027 | Train Loss: 0.4537327 Vali Loss: 0.3948270 Best vali loss: 0.3657311
	iters: 100, epoch: 8 | loss: 0.5611909
	speed: 0.0075s/iter; left time: 7.0020s
	iters: 200, epoch: 8 | loss: 0.3336100
	speed: 0.0024s/iter; left time: 1.9464s
	iters: 300, epoch: 8 | loss: 0.4690803
	speed: 0.0022s/iter; left time: 1.6290s
	iters: 400, epoch: 8 | loss: 0.4051577
	speed: 0.0022s/iter; left time: 1.3903s
	iters: 500, epoch: 8 | loss: 0.3494704
	speed: 0.0023s/iter; left time: 1.1881s
	iters: 600, epoch: 8 | loss: 0.5320961
	speed: 0.0023s/iter; left time: 0.9860s
	iters: 700, epoch: 8 | loss: 0.5908926
	speed: 0.0023s/iter; left time: 0.7430s
	iters: 800, epoch: 8 | loss: 0.4447952
	speed: 0.0023s/iter; left time: 0.5205s
	iters: 900, epoch: 8 | loss: 1.0895183
	speed: 0.0023s/iter; left time: 0.2941s
	iters: 1000, epoch: 8 | loss: 0.6704878
	speed: 0.0023s/iter; left time: 0.0644s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.384805917739868
Epoch: 8, Steps: 1027 | Train Loss: 0.5446299 Vali Loss: 0.3962654 Best vali loss: 0.3657311

best validation loss 0.3657311064789478

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6154588
	speed: 0.0084s/iter; left time: 33.5343s
	iters: 200, epoch: 1 | loss: 0.5905061
	speed: 0.0025s/iter; left time: 9.7790s
	iters: 300, epoch: 1 | loss: 0.6879975
	speed: 0.0026s/iter; left time: 10.0142s
	iters: 400, epoch: 1 | loss: 0.3094802
	speed: 0.0025s/iter; left time: 9.4278s
	iters: 500, epoch: 1 | loss: 1.2997310
	speed: 0.0026s/iter; left time: 9.4547s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.6584713459014893
Epoch: 1, Steps: 514 | Train Loss: 0.7006347 Vali Loss: 0.3670354 Best vali loss: 0.3670354
	iters: 100, epoch: 2 | loss: 0.8336574
	speed: 0.0059s/iter; left time: 20.5910s
	iters: 200, epoch: 2 | loss: 0.5714182
	speed: 0.0025s/iter; left time: 8.5580s
	iters: 300, epoch: 2 | loss: 0.8598661
	speed: 0.0024s/iter; left time: 7.9946s
	iters: 400, epoch: 2 | loss: 0.5004464
	speed: 0.0024s/iter; left time: 7.6946s
	iters: 500, epoch: 2 | loss: 0.8209534
	speed: 0.0024s/iter; left time: 7.4509s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 1.295891523361206
Epoch: 2, Steps: 514 | Train Loss: 0.7172683 Vali Loss: 0.3679929 Best vali loss: 0.3670354
	iters: 100, epoch: 3 | loss: 0.6290358
	speed: 0.0058s/iter; left time: 17.2865s
	iters: 200, epoch: 3 | loss: 0.4918550
	speed: 0.0026s/iter; left time: 7.3645s
	iters: 300, epoch: 3 | loss: 0.6470996
	speed: 0.0025s/iter; left time: 6.9866s
	iters: 400, epoch: 3 | loss: 0.4455800
	speed: 0.0025s/iter; left time: 6.7237s
	iters: 500, epoch: 3 | loss: 0.6886312
	speed: 0.0025s/iter; left time: 6.4537s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 1.3214397430419922
Epoch: 3, Steps: 514 | Train Loss: 0.5804403 Vali Loss: 0.3709171 Best vali loss: 0.3670354

best validation loss 0.36703544513767034

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0269858
	speed: 0.0113s/iter; left time: 45.5471s
	iters: 200, epoch: 1 | loss: 1.0217055
	speed: 0.0052s/iter; left time: 20.3775s
	iters: 300, epoch: 1 | loss: 0.3760841
	speed: 0.0052s/iter; left time: 19.9380s
	iters: 400, epoch: 1 | loss: 0.8891506
	speed: 0.0051s/iter; left time: 18.7595s
	iters: 500, epoch: 1 | loss: 0.5847085
	speed: 0.0046s/iter; left time: 16.7887s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.4074).  Saving model state dict ...
Epoch: 1 cost time: 2.9631521701812744
Epoch: 1, Steps: 514 | Train Loss: 0.7797269 Vali Loss: 0.4073735 Best vali loss: 0.4073735
	iters: 100, epoch: 2 | loss: 0.7491373
	speed: 0.0093s/iter; left time: 32.3709s
	iters: 200, epoch: 2 | loss: 0.6652583
	speed: 0.0046s/iter; left time: 15.7306s
	iters: 300, epoch: 2 | loss: 1.0454158
	speed: 0.0046s/iter; left time: 15.2466s
	iters: 400, epoch: 2 | loss: 0.8986291
	speed: 0.0046s/iter; left time: 14.7146s
	iters: 500, epoch: 2 | loss: 0.7091314
	speed: 0.0046s/iter; left time: 14.3210s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.4074 --> 0.4003).  Saving model state dict ...
Epoch: 2 cost time: 2.4080557823181152
Epoch: 2, Steps: 514 | Train Loss: 0.8135144 Vali Loss: 0.4003331 Best vali loss: 0.4003331
	iters: 100, epoch: 3 | loss: 0.4227477
	speed: 0.0100s/iter; left time: 29.7509s
	iters: 200, epoch: 3 | loss: 0.8633167
	speed: 0.0052s/iter; left time: 14.9450s
	iters: 300, epoch: 3 | loss: 0.8450808
	speed: 0.0053s/iter; left time: 14.6718s
	iters: 400, epoch: 3 | loss: 0.7901267
	speed: 0.0053s/iter; left time: 14.1720s
	iters: 500, epoch: 3 | loss: 0.4493828
	speed: 0.0052s/iter; left time: 13.4143s
Updating learning rate to 0.0008955266062
Epoch: 3 cost time: 2.723501205444336
Epoch: 3, Steps: 514 | Train Loss: 0.6741309 Vali Loss: 0.4060725 Best vali loss: 0.4003331

best validation loss 0.40033308062080314

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7001905
	speed: 0.0125s/iter; left time: 11.6291s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.1727733612060547
Epoch: 1, Steps: 129 | Train Loss: 0.7001905 Vali Loss: 0.3708612 Best vali loss: 0.3708612
	iters: 100, epoch: 2 | loss: 0.7640333
	speed: 0.0102s/iter; left time: 8.1647s
Updating learning rate to 0.00034351639665
Epoch: 2 cost time: 0.8414778709411621
Epoch: 2, Steps: 129 | Train Loss: 0.7640333 Vali Loss: 0.3744502 Best vali loss: 0.3708612
	iters: 100, epoch: 3 | loss: 0.5899498
	speed: 0.0101s/iter; left time: 6.8181s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.3709 --> 0.3474).  Saving model state dict ...
Epoch: 3 cost time: 0.8479526042938232
Epoch: 3, Steps: 129 | Train Loss: 0.5899498 Vali Loss: 0.3473836 Best vali loss: 0.3473836

best validation loss 0.34738359658563533

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5446128
	speed: 0.0127s/iter; left time: 6.9487s
Updating learning rate to 8.58790991625e-05
Epoch: 4 cost time: 1.1654598712921143
Epoch: 4, Steps: 129 | Train Loss: 0.5446128 Vali Loss: 0.3526837 Best vali loss: 0.3473836
	iters: 100, epoch: 5 | loss: 0.5718719
	speed: 0.0100s/iter; left time: 4.1785s
Updating learning rate to 4.293954958125e-05
Epoch: 5 cost time: 0.8267600536346436
Epoch: 5, Steps: 129 | Train Loss: 0.5718719 Vali Loss: 0.3496326 Best vali loss: 0.3473836
	iters: 100, epoch: 6 | loss: 0.5290766
	speed: 0.0101s/iter; left time: 2.8949s
Updating learning rate to 2.1469774790625e-05
Epoch: 6 cost time: 0.8382492065429688
Epoch: 6, Steps: 129 | Train Loss: 0.5290766 Vali Loss: 0.3557021 Best vali loss: 0.3473836
	iters: 100, epoch: 7 | loss: 0.4031639
	speed: 0.0100s/iter; left time: 1.5852s
Updating learning rate to 1.07348873953125e-05
Epoch: 7 cost time: 0.8395082950592041
Epoch: 7, Steps: 129 | Train Loss: 0.4031639 Vali Loss: 0.3520294 Best vali loss: 0.3473836
	iters: 100, epoch: 8 | loss: 0.4556415
	speed: 0.0101s/iter; left time: 0.3019s
Updating learning rate to 5.36744369765625e-06
Epoch: 8 cost time: 0.8358337879180908
Epoch: 8, Steps: 129 | Train Loss: 0.4556415 Vali Loss: 0.3517465 Best vali loss: 0.3473836

best validation loss 0.34738359658563533

[INFO][abstract_intensifier.py:595] Added config 27f795 and rejected config 134b22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0903082
	speed: 0.0094s/iter; left time: 8.7858s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 0.7671704292297363
Epoch: 1, Steps: 129 | Train Loss: 1.0903082 Vali Loss: 0.3727955 Best vali loss: 0.3727955
	iters: 100, epoch: 2 | loss: 0.8111334
	speed: 0.0057s/iter; left time: 4.5455s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.3728 --> 0.3677).  Saving model state dict ...
Epoch: 2 cost time: 0.4114534854888916
Epoch: 2, Steps: 129 | Train Loss: 0.8111334 Vali Loss: 0.3677240 Best vali loss: 0.3677240
	iters: 100, epoch: 3 | loss: 0.5697823
	speed: 0.0055s/iter; left time: 3.6804s
Updating learning rate to 0.00028411015875079426
Epoch: 3 cost time: 0.4126737117767334
Epoch: 3, Steps: 129 | Train Loss: 0.5697823 Vali Loss: 0.3686492 Best vali loss: 0.3677240
	iters: 100, epoch: 4 | loss: 0.5645335
	speed: 0.0053s/iter; left time: 2.9047s
Updating learning rate to 0.00020547737255
Epoch: 4 cost time: 0.4056236743927002
Epoch: 4, Steps: 129 | Train Loss: 0.5645335 Vali Loss: 0.3681233 Best vali loss: 0.3677240
	iters: 100, epoch: 5 | loss: 0.5654038
	speed: 0.0054s/iter; left time: 2.2673s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.41263246536254883
Epoch: 5, Steps: 129 | Train Loss: 0.5654038 Vali Loss: 0.3721658 Best vali loss: 0.3677240
	iters: 100, epoch: 6 | loss: 0.4788710
	speed: 0.0054s/iter; left time: 1.5499s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 0.4011673927307129
Epoch: 6, Steps: 129 | Train Loss: 0.4788710 Vali Loss: 0.3719538 Best vali loss: 0.3677240
	iters: 100, epoch: 7 | loss: 0.6616531
	speed: 0.0054s/iter; left time: 0.8586s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.4153568744659424
Epoch: 7, Steps: 129 | Train Loss: 0.6616531 Vali Loss: 0.3706870 Best vali loss: 0.3677240
	iters: 100, epoch: 8 | loss: 0.7006028
	speed: 0.0058s/iter; left time: 0.1741s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4577596187591553
Epoch: 8, Steps: 129 | Train Loss: 0.7006028 Vali Loss: 0.3709640 Best vali loss: 0.3677240

best validation loss 0.3677239633145173

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8048356
	speed: 0.0088s/iter; left time: 17.1790s
	iters: 200, epoch: 1 | loss: 0.3058145
	speed: 0.0028s/iter; left time: 5.1318s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.0592930316925049
Epoch: 1, Steps: 257 | Train Loss: 0.5553251 Vali Loss: 0.3707276 Best vali loss: 0.3707276
	iters: 100, epoch: 2 | loss: 1.0754639
	speed: 0.0065s/iter; left time: 10.9763s
	iters: 200, epoch: 2 | loss: 0.5917755
	speed: 0.0027s/iter; left time: 4.2492s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 0.7334785461425781
Epoch: 2, Steps: 257 | Train Loss: 0.8336197 Vali Loss: 0.3779387 Best vali loss: 0.3707276
	iters: 100, epoch: 3 | loss: 0.5227979
	speed: 0.0063s/iter; left time: 9.0773s
	iters: 200, epoch: 3 | loss: 0.6507905
	speed: 0.0025s/iter; left time: 3.4039s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 0.6980302333831787
Epoch: 3, Steps: 257 | Train Loss: 0.5867942 Vali Loss: 0.3865941 Best vali loss: 0.3707276
	iters: 100, epoch: 4 | loss: 0.4964006
	speed: 0.0064s/iter; left time: 7.5442s
	iters: 200, epoch: 4 | loss: 0.7476702
	speed: 0.0025s/iter; left time: 2.7280s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 0.6964113712310791
Epoch: 4, Steps: 257 | Train Loss: 0.6220354 Vali Loss: 0.3793761 Best vali loss: 0.3707276
	iters: 100, epoch: 5 | loss: 0.4374080
	speed: 0.0064s/iter; left time: 5.9007s
	iters: 200, epoch: 5 | loss: 0.4725110
	speed: 0.0027s/iter; left time: 2.2625s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 0.7442922592163086
Epoch: 5, Steps: 257 | Train Loss: 0.4549595 Vali Loss: 0.4065468 Best vali loss: 0.3707276
	iters: 100, epoch: 6 | loss: 0.5569024
	speed: 0.0065s/iter; left time: 4.3399s
	iters: 200, epoch: 6 | loss: 0.6585943
	speed: 0.0025s/iter; left time: 1.4410s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 0.7012801170349121
Epoch: 6, Steps: 257 | Train Loss: 0.6077483 Vali Loss: 0.4124319 Best vali loss: 0.3707276
	iters: 100, epoch: 7 | loss: 0.3527884
	speed: 0.0065s/iter; left time: 2.6849s
	iters: 200, epoch: 7 | loss: 0.3109872
	speed: 0.0028s/iter; left time: 0.8786s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 0.7740898132324219
Epoch: 7, Steps: 257 | Train Loss: 0.3318878 Vali Loss: 0.4278264 Best vali loss: 0.3707276
	iters: 100, epoch: 8 | loss: 0.5009128
	speed: 0.0065s/iter; left time: 1.0206s
	iters: 200, epoch: 8 | loss: 0.3551091
	speed: 0.0026s/iter; left time: 0.1506s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7101099491119385
Epoch: 8, Steps: 257 | Train Loss: 0.4280110 Vali Loss: 0.4334693 Best vali loss: 0.3707276

best validation loss 0.3707276291603658

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1014266
	speed: 0.0092s/iter; left time: 8.5841s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.3857).  Saving model state dict ...
Epoch: 1 cost time: 0.757288932800293
Epoch: 1, Steps: 129 | Train Loss: 1.1014266 Vali Loss: 0.3857180 Best vali loss: 0.3857180
	iters: 100, epoch: 2 | loss: 0.8355551
	speed: 0.0057s/iter; left time: 4.5997s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.3857 --> 0.3696).  Saving model state dict ...
Epoch: 2 cost time: 0.4378335475921631
Epoch: 2, Steps: 129 | Train Loss: 0.8355551 Vali Loss: 0.3696439 Best vali loss: 0.3696439
	iters: 100, epoch: 3 | loss: 0.5765018
	speed: 0.0057s/iter; left time: 3.8697s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.3696 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 0.42807817459106445
Epoch: 3, Steps: 129 | Train Loss: 0.5765018 Vali Loss: 0.3665179 Best vali loss: 0.3665179

best validation loss 0.36651790639740545

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5721465
	speed: 0.0094s/iter; left time: 18.3523s
	iters: 200, epoch: 1 | loss: 0.8475873
	speed: 0.0034s/iter; left time: 6.3039s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.3662).  Saving model state dict ...
Epoch: 1 cost time: 1.2171051502227783
Epoch: 1, Steps: 257 | Train Loss: 0.7098669 Vali Loss: 0.3662402 Best vali loss: 0.3662402
	iters: 100, epoch: 2 | loss: 0.6108014
	speed: 0.0078s/iter; left time: 13.2827s
	iters: 200, epoch: 2 | loss: 0.5678718
	speed: 0.0035s/iter; left time: 5.5581s
Updating learning rate to 0.000190206759
Epoch: 2 cost time: 0.9537723064422607
Epoch: 2, Steps: 257 | Train Loss: 0.5893366 Vali Loss: 0.3721809 Best vali loss: 0.3662402
	iters: 100, epoch: 3 | loss: 0.5189766
	speed: 0.0083s/iter; left time: 11.9333s
	iters: 200, epoch: 3 | loss: 0.8263980
	speed: 0.0037s/iter; left time: 4.9668s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.3662 --> 0.3579).  Saving model state dict ...
Epoch: 3 cost time: 0.9948570728302002
Epoch: 3, Steps: 257 | Train Loss: 0.6726873 Vali Loss: 0.3579270 Best vali loss: 0.3579270

best validation loss 0.3579269782967558

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3391763
	speed: 0.0088s/iter; left time: 35.5035s
	iters: 200, epoch: 1 | loss: 0.5249398
	speed: 0.0025s/iter; left time: 9.8664s
	iters: 300, epoch: 1 | loss: 0.8626460
	speed: 0.0025s/iter; left time: 9.5143s
	iters: 400, epoch: 1 | loss: 0.6535936
	speed: 0.0025s/iter; left time: 9.2071s
	iters: 500, epoch: 1 | loss: 0.8277605
	speed: 0.0024s/iter; left time: 8.8252s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.3771).  Saving model state dict ...
Epoch: 1 cost time: 1.6527972221374512
Epoch: 1, Steps: 514 | Train Loss: 0.6416233 Vali Loss: 0.3771301 Best vali loss: 0.3771301
	iters: 100, epoch: 2 | loss: 0.8047791
	speed: 0.0064s/iter; left time: 22.2899s
	iters: 200, epoch: 2 | loss: 0.9127592
	speed: 0.0024s/iter; left time: 8.1254s
	iters: 300, epoch: 2 | loss: 0.2983837
	speed: 0.0023s/iter; left time: 7.5804s
	iters: 400, epoch: 2 | loss: 0.8122023
	speed: 0.0024s/iter; left time: 7.6164s
	iters: 500, epoch: 2 | loss: 0.4156281
	speed: 0.0024s/iter; left time: 7.4068s
Updating learning rate to 0.0009951463076058517
Validation loss decreased (0.3771 --> 0.3719).  Saving model state dict ...
Epoch: 2 cost time: 1.2815866470336914
Epoch: 2, Steps: 514 | Train Loss: 0.6487505 Vali Loss: 0.3719337 Best vali loss: 0.3719337
	iters: 100, epoch: 3 | loss: 0.8139830
	speed: 0.0062s/iter; left time: 18.6219s
	iters: 200, epoch: 3 | loss: 0.3613237
	speed: 0.0024s/iter; left time: 6.8476s
	iters: 300, epoch: 3 | loss: 0.9219502
	speed: 0.0023s/iter; left time: 6.4974s
	iters: 400, epoch: 3 | loss: 1.2137156
	speed: 0.0024s/iter; left time: 6.3989s
	iters: 500, epoch: 3 | loss: 0.3991993
	speed: 0.0024s/iter; left time: 6.2511s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 1.2844295501708984
Epoch: 3, Steps: 514 | Train Loss: 0.7420344 Vali Loss: 0.3744656 Best vali loss: 0.3719337

best validation loss 0.3719337226951052

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4947038
	speed: 0.0098s/iter; left time: 11.6317s
	iters: 200, epoch: 4 | loss: 0.5910503
	speed: 0.0036s/iter; left time: 3.9175s
Updating learning rate to 4.755168975e-05
Epoch: 4 cost time: 1.2795374393463135
Epoch: 4, Steps: 257 | Train Loss: 0.5428771 Vali Loss: 0.3648814 Best vali loss: 0.3579270
	iters: 100, epoch: 5 | loss: 0.4815619
	speed: 0.0085s/iter; left time: 7.9192s
	iters: 200, epoch: 5 | loss: 0.4724560
	speed: 0.0037s/iter; left time: 3.0996s
Updating learning rate to 2.3775844875e-05
Validation loss decreased (0.3579 --> 0.3572).  Saving model state dict ...
Epoch: 5 cost time: 1.0226526260375977
Epoch: 5, Steps: 257 | Train Loss: 0.4770090 Vali Loss: 0.3571838 Best vali loss: 0.3571838
	iters: 100, epoch: 6 | loss: 0.4823992
	speed: 0.0086s/iter; left time: 5.7790s
	iters: 200, epoch: 6 | loss: 0.7776743
	speed: 0.0037s/iter; left time: 2.1200s
Updating learning rate to 1.18879224375e-05
Validation loss decreased (0.3572 --> 0.3545).  Saving model state dict ...
Epoch: 6 cost time: 1.0151698589324951
Epoch: 6, Steps: 257 | Train Loss: 0.6300368 Vali Loss: 0.3545294 Best vali loss: 0.3545294
	iters: 100, epoch: 7 | loss: 0.8758568
	speed: 0.0085s/iter; left time: 3.5205s
	iters: 200, epoch: 7 | loss: 0.4168533
	speed: 0.0036s/iter; left time: 1.1193s
Updating learning rate to 5.94396121875e-06
Validation loss decreased (0.3545 --> 0.3516).  Saving model state dict ...
Epoch: 7 cost time: 0.9888167381286621
Epoch: 7, Steps: 257 | Train Loss: 0.6463550 Vali Loss: 0.3515561 Best vali loss: 0.3515561
	iters: 100, epoch: 8 | loss: 0.5582772
	speed: 0.0086s/iter; left time: 1.3639s
	iters: 200, epoch: 8 | loss: 0.4742947
	speed: 0.0035s/iter; left time: 0.2051s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 0.9964220523834229
Epoch: 8, Steps: 257 | Train Loss: 0.5162860 Vali Loss: 0.3526770 Best vali loss: 0.3515561

best validation loss 0.35155607644607606

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4020972
	speed: 0.0105s/iter; left time: 42.3143s
	iters: 200, epoch: 1 | loss: 0.8224426
	speed: 0.0042s/iter; left time: 16.5298s
	iters: 300, epoch: 1 | loss: 0.6807836
	speed: 0.0042s/iter; left time: 16.1679s
	iters: 400, epoch: 1 | loss: 1.2989491
	speed: 0.0044s/iter; left time: 16.2850s
	iters: 500, epoch: 1 | loss: 0.9454163
	speed: 0.0044s/iter; left time: 16.0249s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 2.5850107669830322
Epoch: 1, Steps: 514 | Train Loss: 0.8299378 Vali Loss: 0.3635323 Best vali loss: 0.3635323
	iters: 100, epoch: 2 | loss: 0.8671502
	speed: 0.0088s/iter; left time: 30.9483s
	iters: 200, epoch: 2 | loss: 0.5362384
	speed: 0.0039s/iter; left time: 13.3231s
	iters: 300, epoch: 2 | loss: 0.6953648
	speed: 0.0043s/iter; left time: 14.2113s
	iters: 400, epoch: 2 | loss: 0.4825126
	speed: 0.0041s/iter; left time: 13.1625s
	iters: 500, epoch: 2 | loss: 0.3990557
	speed: 0.0041s/iter; left time: 12.6015s
Updating learning rate to 6.451837985e-05
Validation loss decreased (0.3635 --> 0.3588).  Saving model state dict ...
Epoch: 2 cost time: 2.1676065921783447
Epoch: 2, Steps: 514 | Train Loss: 0.5960643 Vali Loss: 0.3588351 Best vali loss: 0.3588351
	iters: 100, epoch: 3 | loss: 0.9208062
	speed: 0.0090s/iter; left time: 26.9221s
	iters: 200, epoch: 3 | loss: 0.4191078
	speed: 0.0040s/iter; left time: 11.5916s
	iters: 300, epoch: 3 | loss: 0.3303316
	speed: 0.0041s/iter; left time: 11.3127s
	iters: 400, epoch: 3 | loss: 0.4866275
	speed: 0.0041s/iter; left time: 10.9301s
	iters: 500, epoch: 3 | loss: 0.3549708
	speed: 0.0039s/iter; left time: 9.9939s
Updating learning rate to 3.2259189925e-05
Epoch: 3 cost time: 2.1248340606689453
Epoch: 3, Steps: 514 | Train Loss: 0.5023688 Vali Loss: 0.3861804 Best vali loss: 0.3588351
	iters: 100, epoch: 4 | loss: 0.6318268
	speed: 0.0086s/iter; left time: 21.3258s
	iters: 200, epoch: 4 | loss: 0.2868009
	speed: 0.0040s/iter; left time: 9.5312s
	iters: 300, epoch: 4 | loss: 0.3995462
	speed: 0.0040s/iter; left time: 9.1317s
	iters: 400, epoch: 4 | loss: 0.6661788
	speed: 0.0039s/iter; left time: 8.5286s
	iters: 500, epoch: 4 | loss: 0.9382849
	speed: 0.0040s/iter; left time: 8.2400s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 2.112933397293091
Epoch: 4, Steps: 514 | Train Loss: 0.5845275 Vali Loss: 0.4126718 Best vali loss: 0.3588351
	iters: 100, epoch: 5 | loss: 0.3034296
	speed: 0.0087s/iter; left time: 17.1087s
	iters: 200, epoch: 5 | loss: 0.6970248
	speed: 0.0039s/iter; left time: 7.2767s
	iters: 300, epoch: 5 | loss: 0.6729536
	speed: 0.0043s/iter; left time: 7.5479s
	iters: 400, epoch: 5 | loss: 0.6585373
	speed: 0.0044s/iter; left time: 7.3180s
	iters: 500, epoch: 5 | loss: 0.5755568
	speed: 0.0044s/iter; left time: 6.8029s
Updating learning rate to 8.06479748125e-06
Epoch: 5 cost time: 2.2291083335876465
Epoch: 5, Steps: 514 | Train Loss: 0.5815004 Vali Loss: 0.3930691 Best vali loss: 0.3588351
	iters: 100, epoch: 6 | loss: 0.5496382
	speed: 0.0088s/iter; left time: 12.6612s
	iters: 200, epoch: 6 | loss: 0.5556911
	speed: 0.0043s/iter; left time: 5.7501s
	iters: 300, epoch: 6 | loss: 0.5766678
	speed: 0.0043s/iter; left time: 5.3841s
	iters: 400, epoch: 6 | loss: 0.6857531
	speed: 0.0041s/iter; left time: 4.7289s
	iters: 500, epoch: 6 | loss: 0.5692911
	speed: 0.0043s/iter; left time: 4.4885s
Updating learning rate to 4.032398740625e-06
Epoch: 6 cost time: 2.2508723735809326
Epoch: 6, Steps: 514 | Train Loss: 0.5874082 Vali Loss: 0.3944278 Best vali loss: 0.3588351
	iters: 100, epoch: 7 | loss: 0.8005559
	speed: 0.0089s/iter; left time: 8.2262s
	iters: 200, epoch: 7 | loss: 0.8140129
	speed: 0.0043s/iter; left time: 3.6011s
	iters: 300, epoch: 7 | loss: 0.5003066
	speed: 0.0044s/iter; left time: 3.2072s
	iters: 400, epoch: 7 | loss: 0.5439562
	speed: 0.0044s/iter; left time: 2.7667s
	iters: 500, epoch: 7 | loss: 0.9110319
	speed: 0.0044s/iter; left time: 2.3112s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 2.2875256538391113
Epoch: 7, Steps: 514 | Train Loss: 0.7139727 Vali Loss: 0.3921277 Best vali loss: 0.3588351
	iters: 100, epoch: 8 | loss: 0.8180929
	speed: 0.0089s/iter; left time: 3.7018s
	iters: 200, epoch: 8 | loss: 0.6356629
	speed: 0.0043s/iter; left time: 1.3389s
	iters: 300, epoch: 8 | loss: 0.8075020
	speed: 0.0042s/iter; left time: 0.9120s
	iters: 400, epoch: 8 | loss: 0.8547614
	speed: 0.0043s/iter; left time: 0.4940s
	iters: 500, epoch: 8 | loss: 0.3778655
	speed: 0.0043s/iter; left time: 0.0647s
Updating learning rate to 1.00809968515625e-06
Epoch: 8 cost time: 2.2709083557128906
Epoch: 8, Steps: 514 | Train Loss: 0.6987770 Vali Loss: 0.3980159 Best vali loss: 0.3588351

best validation loss 0.3588350958580587

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6683470
	speed: 0.0113s/iter; left time: 45.3010s
	iters: 200, epoch: 1 | loss: 0.5765629
	speed: 0.0050s/iter; left time: 19.5880s
	iters: 300, epoch: 1 | loss: 0.8140194
	speed: 0.0050s/iter; left time: 19.0721s
	iters: 400, epoch: 1 | loss: 0.3172883
	speed: 0.0050s/iter; left time: 18.5653s
	iters: 500, epoch: 1 | loss: 0.7254451
	speed: 0.0050s/iter; left time: 18.0560s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.3754).  Saving model state dict ...
Epoch: 1 cost time: 2.939244031906128
Epoch: 1, Steps: 514 | Train Loss: 0.6203325 Vali Loss: 0.3754015 Best vali loss: 0.3754015
	iters: 100, epoch: 2 | loss: 0.4105356
	speed: 0.0098s/iter; left time: 34.4578s
	iters: 200, epoch: 2 | loss: 0.5124308
	speed: 0.0047s/iter; left time: 16.0983s
	iters: 300, epoch: 2 | loss: 0.3392429
	speed: 0.0048s/iter; left time: 15.6800s
	iters: 400, epoch: 2 | loss: 0.7273754
	speed: 0.0048s/iter; left time: 15.3036s
	iters: 500, epoch: 2 | loss: 0.5466436
	speed: 0.0048s/iter; left time: 15.0129s
Updating learning rate to 0.0007295719019739402
Validation loss decreased (0.3754 --> 0.3738).  Saving model state dict ...
Epoch: 2 cost time: 2.5209200382232666
Epoch: 2, Steps: 514 | Train Loss: 0.5072456 Vali Loss: 0.3737509 Best vali loss: 0.3737509
	iters: 100, epoch: 3 | loss: 0.3444180
	speed: 0.0101s/iter; left time: 30.0089s
	iters: 200, epoch: 3 | loss: 0.8763024
	speed: 0.0050s/iter; left time: 14.3167s
	iters: 300, epoch: 3 | loss: 0.9612650
	speed: 0.0048s/iter; left time: 13.3458s
	iters: 400, epoch: 3 | loss: 0.2767401
	speed: 0.0047s/iter; left time: 12.6757s
	iters: 500, epoch: 3 | loss: 0.4709290
	speed: 0.0044s/iter; left time: 11.2640s
Updating learning rate to 0.0005909220165344886
Validation loss decreased (0.3738 --> 0.3686).  Saving model state dict ...
Epoch: 3 cost time: 2.4993247985839844
Epoch: 3, Steps: 514 | Train Loss: 0.5859309 Vali Loss: 0.3686087 Best vali loss: 0.3686087
	iters: 100, epoch: 4 | loss: 0.5359324
	speed: 0.0098s/iter; left time: 24.2387s
	iters: 200, epoch: 4 | loss: 0.7878701
	speed: 0.0045s/iter; left time: 10.6169s
	iters: 300, epoch: 4 | loss: 0.7087385
	speed: 0.0044s/iter; left time: 10.0209s
	iters: 400, epoch: 4 | loss: 0.5239007
	speed: 0.0046s/iter; left time: 9.9728s
	iters: 500, epoch: 4 | loss: 0.2799714
	speed: 0.0051s/iter; left time: 10.4595s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 2.446685791015625
Epoch: 4, Steps: 514 | Train Loss: 0.5672826 Vali Loss: 0.3823121 Best vali loss: 0.3686087
	iters: 100, epoch: 5 | loss: 0.4583329
	speed: 0.0107s/iter; left time: 20.9854s
	iters: 200, epoch: 5 | loss: 0.7270628
	speed: 0.0052s/iter; left time: 9.5986s
	iters: 300, epoch: 5 | loss: 0.7937025
	speed: 0.0052s/iter; left time: 9.1272s
	iters: 400, epoch: 5 | loss: 0.3412262
	speed: 0.0052s/iter; left time: 8.5501s
	iters: 500, epoch: 5 | loss: 0.3619136
	speed: 0.0050s/iter; left time: 7.7989s
Updating learning rate to 0.00026382463436551147
Validation loss decreased (0.3686 --> 0.3630).  Saving model state dict ...
Epoch: 5 cost time: 2.7068681716918945
Epoch: 5, Steps: 514 | Train Loss: 0.5364476 Vali Loss: 0.3629977 Best vali loss: 0.3629977
	iters: 100, epoch: 6 | loss: 0.9131652
	speed: 0.0102s/iter; left time: 14.7800s
	iters: 200, epoch: 6 | loss: 0.4383124
	speed: 0.0051s/iter; left time: 6.7834s
	iters: 300, epoch: 6 | loss: 0.3445272
	speed: 0.0050s/iter; left time: 6.2762s
	iters: 400, epoch: 6 | loss: 0.4173721
	speed: 0.0050s/iter; left time: 5.7143s
	iters: 500, epoch: 6 | loss: 0.3517850
	speed: 0.0049s/iter; left time: 5.1289s
Updating learning rate to 0.0001251747489260597
Validation loss decreased (0.3630 --> 0.3498).  Saving model state dict ...
Epoch: 6 cost time: 2.643052339553833
Epoch: 6, Steps: 514 | Train Loss: 0.4930324 Vali Loss: 0.3497616 Best vali loss: 0.3497616
	iters: 100, epoch: 7 | loss: 0.5442371
	speed: 0.0101s/iter; left time: 9.3914s
	iters: 200, epoch: 7 | loss: 0.5165402
	speed: 0.0050s/iter; left time: 4.1796s
	iters: 300, epoch: 7 | loss: 0.6865139
	speed: 0.0051s/iter; left time: 3.7282s
	iters: 400, epoch: 7 | loss: 0.2989073
	speed: 0.0051s/iter; left time: 3.2014s
	iters: 500, epoch: 7 | loss: 0.5873840
	speed: 0.0051s/iter; left time: 2.7008s
Updating learning rate to 3.253185732546e-05
Epoch: 7 cost time: 2.673952102661133
Epoch: 7, Steps: 514 | Train Loss: 0.5267165 Vali Loss: 0.3623157 Best vali loss: 0.3497616
	iters: 100, epoch: 8 | loss: 0.5958434
	speed: 0.0104s/iter; left time: 4.3219s
	iters: 200, epoch: 8 | loss: 0.7180004
	speed: 0.0047s/iter; left time: 1.4766s
	iters: 300, epoch: 8 | loss: 0.4016265
	speed: 0.0047s/iter; left time: 1.0063s
	iters: 400, epoch: 8 | loss: 0.5296750
	speed: 0.0046s/iter; left time: 0.5347s
	iters: 500, epoch: 8 | loss: 0.4928609
	speed: 0.0046s/iter; left time: 0.0689s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.4844067096710205
Epoch: 8, Steps: 514 | Train Loss: 0.5476012 Vali Loss: 0.3605960 Best vali loss: 0.3497616

best validation loss 0.3497615979673352

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.4421).  Saving model state dict ...
Epoch: 1 cost time: 0.6824853420257568
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4421287 Best vali loss: 0.4421287
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.4421 --> 0.4319).  Saving model state dict ...
Epoch: 2 cost time: 0.3521406650543213
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4319402 Best vali loss: 0.4319402
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.4319 --> 0.4274).  Saving model state dict ...
Epoch: 3 cost time: 0.3471822738647461
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4274159 Best vali loss: 0.4274159

best validation loss 0.4274159038347908

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1215370
	speed: 0.0102s/iter; left time: 83.0616s
	iters: 200, epoch: 1 | loss: 0.8219888
	speed: 0.0042s/iter; left time: 33.3144s
	iters: 300, epoch: 1 | loss: 0.2811044
	speed: 0.0043s/iter; left time: 33.6981s
	iters: 400, epoch: 1 | loss: 0.4407582
	speed: 0.0042s/iter; left time: 33.1806s
	iters: 500, epoch: 1 | loss: 1.1499997
	speed: 0.0042s/iter; left time: 32.3986s
	iters: 600, epoch: 1 | loss: 0.9691275
	speed: 0.0037s/iter; left time: 28.1578s
	iters: 700, epoch: 1 | loss: 0.5211487
	speed: 0.0037s/iter; left time: 27.7710s
	iters: 800, epoch: 1 | loss: 1.2501782
	speed: 0.0038s/iter; left time: 28.4606s
	iters: 900, epoch: 1 | loss: 0.8150690
	speed: 0.0040s/iter; left time: 29.1928s
	iters: 1000, epoch: 1 | loss: 0.7198373
	speed: 0.0040s/iter; left time: 28.7304s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.3799).  Saving model state dict ...
Epoch: 1 cost time: 4.488743543624878
Epoch: 1, Steps: 1027 | Train Loss: 0.8090749 Vali Loss: 0.3798678 Best vali loss: 0.3798678
	iters: 100, epoch: 2 | loss: 0.3888877
	speed: 0.0110s/iter; left time: 77.9840s
	iters: 200, epoch: 2 | loss: 0.8681428
	speed: 0.0040s/iter; left time: 27.7015s
	iters: 300, epoch: 2 | loss: 0.7137871
	speed: 0.0039s/iter; left time: 27.1816s
	iters: 400, epoch: 2 | loss: 0.4630168
	speed: 0.0038s/iter; left time: 26.0085s
	iters: 500, epoch: 2 | loss: 0.3131222
	speed: 0.0038s/iter; left time: 25.5511s
	iters: 600, epoch: 2 | loss: 1.1199921
	speed: 0.0038s/iter; left time: 25.2223s
	iters: 700, epoch: 2 | loss: 0.3050678
	speed: 0.0037s/iter; left time: 24.1423s
	iters: 800, epoch: 2 | loss: 1.0015489
	speed: 0.0037s/iter; left time: 23.6533s
	iters: 900, epoch: 2 | loss: 0.4096736
	speed: 0.0036s/iter; left time: 22.6528s
	iters: 1000, epoch: 2 | loss: 0.7267816
	speed: 0.0037s/iter; left time: 22.6369s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.3799 --> 0.3777).  Saving model state dict ...
Epoch: 2 cost time: 3.9575796127319336
Epoch: 2, Steps: 1027 | Train Loss: 0.6310021 Vali Loss: 0.3777250 Best vali loss: 0.3777250
	iters: 100, epoch: 3 | loss: 0.9452047
	speed: 0.0109s/iter; left time: 65.8090s
	iters: 200, epoch: 3 | loss: 0.4911304
	speed: 0.0040s/iter; left time: 23.6214s
	iters: 300, epoch: 3 | loss: 0.2894136
	speed: 0.0040s/iter; left time: 23.4439s
	iters: 400, epoch: 3 | loss: 1.3782791
	speed: 0.0040s/iter; left time: 23.0020s
	iters: 500, epoch: 3 | loss: 0.7001132
	speed: 0.0041s/iter; left time: 22.9606s
	iters: 600, epoch: 3 | loss: 0.9133359
	speed: 0.0042s/iter; left time: 23.1849s
	iters: 700, epoch: 3 | loss: 0.3691839
	speed: 0.0042s/iter; left time: 22.8487s
	iters: 800, epoch: 3 | loss: 0.9200391
	speed: 0.0042s/iter; left time: 22.6409s
	iters: 900, epoch: 3 | loss: 0.2268003
	speed: 0.0042s/iter; left time: 22.2541s
	iters: 1000, epoch: 3 | loss: 0.3151665
	speed: 0.0042s/iter; left time: 21.5861s
Updating learning rate to 0.000253302663075
Epoch: 3 cost time: 4.24630069732666
Epoch: 3, Steps: 1027 | Train Loss: 0.6548667 Vali Loss: 0.3847600 Best vali loss: 0.3777250

best validation loss 0.3777250359123957

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2274286
	speed: 0.0104s/iter; left time: 84.2901s
	iters: 200, epoch: 1 | loss: 0.4058528
	speed: 0.0043s/iter; left time: 34.3437s
	iters: 300, epoch: 1 | loss: 0.7300159
	speed: 0.0043s/iter; left time: 33.9905s
	iters: 400, epoch: 1 | loss: 0.4209786
	speed: 0.0042s/iter; left time: 33.1443s
	iters: 500, epoch: 1 | loss: 1.9921814
	speed: 0.0042s/iter; left time: 32.4444s
	iters: 600, epoch: 1 | loss: 0.4596820
	speed: 0.0042s/iter; left time: 32.3327s
	iters: 700, epoch: 1 | loss: 1.2167147
	speed: 0.0042s/iter; left time: 31.8401s
	iters: 800, epoch: 1 | loss: 0.3512498
	speed: 0.0040s/iter; left time: 29.4303s
	iters: 900, epoch: 1 | loss: 0.3508885
	speed: 0.0038s/iter; left time: 27.6698s
	iters: 1000, epoch: 1 | loss: 0.9989384
	speed: 0.0037s/iter; left time: 26.9832s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.4027).  Saving model state dict ...
Epoch: 1 cost time: 4.581629753112793
Epoch: 1, Steps: 1027 | Train Loss: 0.7153931 Vali Loss: 0.4027492 Best vali loss: 0.4027492
	iters: 100, epoch: 2 | loss: 1.3682357
	speed: 0.0109s/iter; left time: 77.5638s
	iters: 200, epoch: 2 | loss: 0.3458068
	speed: 0.0040s/iter; left time: 27.9575s
	iters: 300, epoch: 2 | loss: 0.3927359
	speed: 0.0040s/iter; left time: 27.4171s
	iters: 400, epoch: 2 | loss: 1.1767906
	speed: 0.0040s/iter; left time: 26.9632s
	iters: 500, epoch: 2 | loss: 0.6200514
	speed: 0.0040s/iter; left time: 26.8123s
	iters: 600, epoch: 2 | loss: 0.6006798
	speed: 0.0042s/iter; left time: 27.5375s
	iters: 700, epoch: 2 | loss: 0.3173327
	speed: 0.0041s/iter; left time: 26.6519s
	iters: 800, epoch: 2 | loss: 0.4546239
	speed: 0.0042s/iter; left time: 26.9787s
	iters: 900, epoch: 2 | loss: 0.3486897
	speed: 0.0042s/iter; left time: 26.5475s
	iters: 1000, epoch: 2 | loss: 0.2957996
	speed: 0.0042s/iter; left time: 26.2075s
Updating learning rate to 0.004191537451168922
Validation loss decreased (0.4027 --> 0.4025).  Saving model state dict ...
Epoch: 2 cost time: 4.245245456695557
Epoch: 2, Steps: 1027 | Train Loss: 0.5920746 Vali Loss: 0.4025338 Best vali loss: 0.4025338
	iters: 100, epoch: 3 | loss: 0.4388532
	speed: 0.0113s/iter; left time: 68.3914s
	iters: 200, epoch: 3 | loss: 0.3387753
	speed: 0.0042s/iter; left time: 25.2104s
	iters: 300, epoch: 3 | loss: 0.3490874
	speed: 0.0042s/iter; left time: 24.8124s
	iters: 400, epoch: 3 | loss: 0.2385584
	speed: 0.0042s/iter; left time: 24.1274s
	iters: 500, epoch: 3 | loss: 1.0480398
	speed: 0.0042s/iter; left time: 23.5650s
	iters: 600, epoch: 3 | loss: 0.9934604
	speed: 0.0042s/iter; left time: 23.3560s
	iters: 700, epoch: 3 | loss: 0.6555737
	speed: 0.0042s/iter; left time: 23.0663s
	iters: 800, epoch: 3 | loss: 0.2565967
	speed: 0.0043s/iter; left time: 22.8055s
	iters: 900, epoch: 3 | loss: 0.2746864
	speed: 0.0042s/iter; left time: 22.3482s
	iters: 1000, epoch: 3 | loss: 0.3834322
	speed: 0.0042s/iter; left time: 21.9170s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 4.37085485458374
Epoch: 3, Steps: 1027 | Train Loss: 0.4977063 Vali Loss: 0.4109130 Best vali loss: 0.4025338

best validation loss 0.40253383731561

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1573521
	speed: 0.0102s/iter; left time: 51.2588s
	iters: 200, epoch: 4 | loss: 0.9173970
	speed: 0.0040s/iter; left time: 19.7429s
	iters: 300, epoch: 4 | loss: 0.2544577
	speed: 0.0040s/iter; left time: 19.1901s
	iters: 400, epoch: 4 | loss: 0.4610306
	speed: 0.0040s/iter; left time: 18.8769s
	iters: 500, epoch: 4 | loss: 1.1237392
	speed: 0.0040s/iter; left time: 18.3750s
	iters: 600, epoch: 4 | loss: 0.8400069
	speed: 0.0038s/iter; left time: 17.4405s
	iters: 700, epoch: 4 | loss: 0.4446903
	speed: 0.0037s/iter; left time: 16.2757s
	iters: 800, epoch: 4 | loss: 1.1263587
	speed: 0.0037s/iter; left time: 15.9707s
	iters: 900, epoch: 4 | loss: 0.8262135
	speed: 0.0038s/iter; left time: 16.0184s
	iters: 1000, epoch: 4 | loss: 0.7176210
	speed: 0.0039s/iter; left time: 16.3062s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 4.337490081787109
Epoch: 4, Steps: 1027 | Train Loss: 0.7868867 Vali Loss: 0.3789853 Best vali loss: 0.3777250
	iters: 100, epoch: 5 | loss: 0.4043080
	speed: 0.0105s/iter; left time: 42.0221s
	iters: 200, epoch: 5 | loss: 0.4790920
	speed: 0.0036s/iter; left time: 14.2210s
	iters: 300, epoch: 5 | loss: 0.7214556
	speed: 0.0037s/iter; left time: 13.9778s
	iters: 400, epoch: 5 | loss: 0.4492558
	speed: 0.0037s/iter; left time: 13.5760s
	iters: 500, epoch: 5 | loss: 0.2965310
	speed: 0.0037s/iter; left time: 13.1878s
	iters: 600, epoch: 5 | loss: 0.9286833
	speed: 0.0037s/iter; left time: 12.9327s
	iters: 700, epoch: 5 | loss: 0.2795764
	speed: 0.0037s/iter; left time: 12.4560s
	iters: 800, epoch: 5 | loss: 1.1728885
	speed: 0.0036s/iter; left time: 12.0615s
	iters: 900, epoch: 5 | loss: 0.3374439
	speed: 0.0038s/iter; left time: 12.1160s
	iters: 1000, epoch: 5 | loss: 0.5205379
	speed: 0.0040s/iter; left time: 12.5315s
Updating learning rate to 6.332566576875e-05
Epoch: 5 cost time: 3.8510677814483643
Epoch: 5, Steps: 1027 | Train Loss: 0.5589772 Vali Loss: 0.3889491 Best vali loss: 0.3777250
	iters: 100, epoch: 6 | loss: 0.7000216
	speed: 0.0107s/iter; left time: 31.8438s
	iters: 200, epoch: 6 | loss: 0.3893673
	speed: 0.0036s/iter; left time: 10.4717s
	iters: 300, epoch: 6 | loss: 0.2975823
	speed: 0.0036s/iter; left time: 10.0821s
	iters: 400, epoch: 6 | loss: 1.3874317
	speed: 0.0036s/iter; left time: 9.6949s
	iters: 500, epoch: 6 | loss: 0.5558952
	speed: 0.0036s/iter; left time: 9.3865s
	iters: 600, epoch: 6 | loss: 0.9047072
	speed: 0.0036s/iter; left time: 8.9442s
	iters: 700, epoch: 6 | loss: 0.3536367
	speed: 0.0036s/iter; left time: 8.6297s
	iters: 800, epoch: 6 | loss: 0.6792639
	speed: 0.0038s/iter; left time: 8.5910s
	iters: 900, epoch: 6 | loss: 0.2179120
	speed: 0.0038s/iter; left time: 8.2718s
	iters: 1000, epoch: 6 | loss: 0.3875211
	speed: 0.0037s/iter; left time: 7.7736s
Updating learning rate to 3.1662832884375e-05
Epoch: 6 cost time: 3.8050880432128906
Epoch: 6, Steps: 1027 | Train Loss: 0.5873339 Vali Loss: 0.3932522 Best vali loss: 0.3777250
	iters: 100, epoch: 7 | loss: 0.5999855
	speed: 0.0104s/iter; left time: 20.3992s
	iters: 200, epoch: 7 | loss: 0.3189002
	speed: 0.0037s/iter; left time: 6.8651s
	iters: 300, epoch: 7 | loss: 0.7873074
	speed: 0.0036s/iter; left time: 6.3667s
	iters: 400, epoch: 7 | loss: 0.5145412
	speed: 0.0036s/iter; left time: 6.0140s
	iters: 500, epoch: 7 | loss: 0.3234127
	speed: 0.0037s/iter; left time: 5.6905s
	iters: 600, epoch: 7 | loss: 0.9709867
	speed: 0.0036s/iter; left time: 5.2862s
	iters: 700, epoch: 7 | loss: 0.3204892
	speed: 0.0036s/iter; left time: 4.9147s
	iters: 800, epoch: 7 | loss: 0.4887215
	speed: 0.0037s/iter; left time: 4.6103s
	iters: 900, epoch: 7 | loss: 1.4579079
	speed: 0.0037s/iter; left time: 4.2164s
	iters: 1000, epoch: 7 | loss: 0.2923945
	speed: 0.0036s/iter; left time: 3.8336s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 3.787558078765869
Epoch: 7, Steps: 1027 | Train Loss: 0.6074647 Vali Loss: 0.3875585 Best vali loss: 0.3777250
	iters: 100, epoch: 8 | loss: 0.7566523
	speed: 0.0103s/iter; left time: 9.5800s
	iters: 200, epoch: 8 | loss: 0.2623717
	speed: 0.0036s/iter; left time: 3.0090s
	iters: 300, epoch: 8 | loss: 0.2323633
	speed: 0.0036s/iter; left time: 2.6378s
	iters: 400, epoch: 8 | loss: 0.7489661
	speed: 0.0036s/iter; left time: 2.2834s
	iters: 500, epoch: 8 | loss: 0.8219804
	speed: 0.0036s/iter; left time: 1.9127s
	iters: 600, epoch: 8 | loss: 0.3330905
	speed: 0.0036s/iter; left time: 1.5479s
	iters: 700, epoch: 8 | loss: 0.5200115
	speed: 0.0036s/iter; left time: 1.1843s
	iters: 800, epoch: 8 | loss: 0.5100619
	speed: 0.0036s/iter; left time: 0.8216s
	iters: 900, epoch: 8 | loss: 0.3652529
	speed: 0.0036s/iter; left time: 0.4610s
	iters: 1000, epoch: 8 | loss: 0.3811100
	speed: 0.0036s/iter; left time: 0.1016s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 3.758023500442505
Epoch: 8, Steps: 1027 | Train Loss: 0.4931861 Vali Loss: 0.3943288 Best vali loss: 0.3777250

best validation loss 0.3777250359123957

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5660186
	speed: 0.0089s/iter; left time: 72.6366s
	iters: 200, epoch: 1 | loss: 1.0668497
	speed: 0.0030s/iter; left time: 24.1163s
	iters: 300, epoch: 1 | loss: 1.4243560
	speed: 0.0030s/iter; left time: 24.1274s
	iters: 400, epoch: 1 | loss: 0.8503844
	speed: 0.0031s/iter; left time: 24.2622s
	iters: 500, epoch: 1 | loss: 0.4406939
	speed: 0.0031s/iter; left time: 23.5664s
	iters: 600, epoch: 1 | loss: 1.5121052
	speed: 0.0030s/iter; left time: 22.6410s
	iters: 700, epoch: 1 | loss: 0.3853917
	speed: 0.0029s/iter; left time: 21.9302s
	iters: 800, epoch: 1 | loss: 0.3640203
	speed: 0.0030s/iter; left time: 21.9554s
	iters: 900, epoch: 1 | loss: 0.3772241
	speed: 0.0030s/iter; left time: 21.6603s
	iters: 1000, epoch: 1 | loss: 0.8854623
	speed: 0.0029s/iter; left time: 21.2238s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.3983).  Saving model state dict ...
Epoch: 1 cost time: 3.420330286026001
Epoch: 1, Steps: 1027 | Train Loss: 0.7872506 Vali Loss: 0.3982938 Best vali loss: 0.3982938
	iters: 100, epoch: 2 | loss: 1.0130988
	speed: 0.0090s/iter; left time: 63.5699s
	iters: 200, epoch: 2 | loss: 0.2347746
	speed: 0.0030s/iter; left time: 21.0069s
	iters: 300, epoch: 2 | loss: 0.2918226
	speed: 0.0030s/iter; left time: 20.8552s
	iters: 400, epoch: 2 | loss: 0.5558192
	speed: 0.0029s/iter; left time: 19.8647s
	iters: 500, epoch: 2 | loss: 0.3801931
	speed: 0.0030s/iter; left time: 20.3401s
	iters: 600, epoch: 2 | loss: 0.6105305
	speed: 0.0030s/iter; left time: 19.9897s
	iters: 700, epoch: 2 | loss: 1.0799340
	speed: 0.0030s/iter; left time: 19.6552s
	iters: 800, epoch: 2 | loss: 0.4999266
	speed: 0.0030s/iter; left time: 19.4247s
	iters: 900, epoch: 2 | loss: 0.4945201
	speed: 0.0029s/iter; left time: 18.4637s
	iters: 1000, epoch: 2 | loss: 0.2677607
	speed: 0.0029s/iter; left time: 18.1362s
Updating learning rate to 0.0014756908020130246
Validation loss decreased (0.3983 --> 0.3918).  Saving model state dict ...
Epoch: 2 cost time: 3.1107590198516846
Epoch: 2, Steps: 1027 | Train Loss: 0.5428380 Vali Loss: 0.3917718 Best vali loss: 0.3917718
	iters: 100, epoch: 3 | loss: 0.3143054
	speed: 0.0090s/iter; left time: 54.3221s
	iters: 200, epoch: 3 | loss: 0.4435530
	speed: 0.0029s/iter; left time: 17.4064s
	iters: 300, epoch: 3 | loss: 0.4385176
	speed: 0.0029s/iter; left time: 17.1663s
	iters: 400, epoch: 3 | loss: 0.2896243
	speed: 0.0030s/iter; left time: 17.3907s
	iters: 500, epoch: 3 | loss: 0.3869241
	speed: 0.0029s/iter; left time: 16.4779s
	iters: 600, epoch: 3 | loss: 1.8095284
	speed: 0.0030s/iter; left time: 16.7428s
	iters: 700, epoch: 3 | loss: 0.9748651
	speed: 0.0034s/iter; left time: 18.5249s
	iters: 800, epoch: 3 | loss: 0.3728382
	speed: 0.0034s/iter; left time: 18.2370s
	iters: 900, epoch: 3 | loss: 0.7627854
	speed: 0.0034s/iter; left time: 17.8854s
	iters: 1000, epoch: 3 | loss: 0.3170831
	speed: 0.0034s/iter; left time: 17.4577s
Updating learning rate to 0.0011952463933268102
Validation loss decreased (0.3918 --> 0.3873).  Saving model state dict ...
Epoch: 3 cost time: 3.2610321044921875
Epoch: 3, Steps: 1027 | Train Loss: 0.6110024 Vali Loss: 0.3872557 Best vali loss: 0.3872557
	iters: 100, epoch: 4 | loss: 0.5507083
	speed: 0.0092s/iter; left time: 46.3425s
	iters: 200, epoch: 4 | loss: 1.0068489
	speed: 0.0030s/iter; left time: 15.0124s
	iters: 300, epoch: 4 | loss: 0.5667474
	speed: 0.0032s/iter; left time: 15.5208s
	iters: 400, epoch: 4 | loss: 0.5166364
	speed: 0.0033s/iter; left time: 15.7254s
	iters: 500, epoch: 4 | loss: 1.2692360
	speed: 0.0033s/iter; left time: 15.1701s
	iters: 600, epoch: 4 | loss: 1.3091524
	speed: 0.0030s/iter; left time: 13.7508s
	iters: 700, epoch: 4 | loss: 0.3301604
	speed: 0.0031s/iter; left time: 13.6347s
	iters: 800, epoch: 4 | loss: 0.3989539
	speed: 0.0031s/iter; left time: 13.5337s
	iters: 900, epoch: 4 | loss: 0.3697464
	speed: 0.0031s/iter; left time: 13.1229s
	iters: 1000, epoch: 4 | loss: 0.6367542
	speed: 0.0030s/iter; left time: 12.2668s
Updating learning rate to 0.00086443965795
Epoch: 4 cost time: 3.23276686668396
Epoch: 4, Steps: 1027 | Train Loss: 0.6954944 Vali Loss: 0.3967069 Best vali loss: 0.3872557
	iters: 100, epoch: 5 | loss: 0.9317259
	speed: 0.0092s/iter; left time: 36.7987s
	iters: 200, epoch: 5 | loss: 0.3501565
	speed: 0.0034s/iter; left time: 13.1767s
	iters: 300, epoch: 5 | loss: 0.3194661
	speed: 0.0033s/iter; left time: 12.4360s
	iters: 400, epoch: 5 | loss: 0.3299940
	speed: 0.0031s/iter; left time: 11.5787s
	iters: 500, epoch: 5 | loss: 0.7268742
	speed: 0.0031s/iter; left time: 11.2849s
	iters: 600, epoch: 5 | loss: 1.0710410
	speed: 0.0031s/iter; left time: 10.9220s
	iters: 700, epoch: 5 | loss: 0.3421563
	speed: 0.0031s/iter; left time: 10.6358s
	iters: 800, epoch: 5 | loss: 1.1506383
	speed: 0.0031s/iter; left time: 10.4045s
	iters: 900, epoch: 5 | loss: 1.4247835
	speed: 0.0031s/iter; left time: 10.0935s
	iters: 1000, epoch: 5 | loss: 0.5481425
	speed: 0.0031s/iter; left time: 9.7464s
Updating learning rate to 0.0005336329225731899
Epoch: 5 cost time: 3.3104817867279053
Epoch: 5, Steps: 1027 | Train Loss: 0.7194978 Vali Loss: 0.4216674 Best vali loss: 0.3872557
	iters: 100, epoch: 6 | loss: 1.4322609
	speed: 0.0095s/iter; left time: 28.4168s
	iters: 200, epoch: 6 | loss: 0.4057138
	speed: 0.0033s/iter; left time: 9.6147s
	iters: 300, epoch: 6 | loss: 0.3624520
	speed: 0.0033s/iter; left time: 9.2701s
	iters: 400, epoch: 6 | loss: 0.3280335
	speed: 0.0033s/iter; left time: 8.9409s
	iters: 500, epoch: 6 | loss: 0.9068056
	speed: 0.0033s/iter; left time: 8.6096s
	iters: 600, epoch: 6 | loss: 0.7187274
	speed: 0.0033s/iter; left time: 8.3041s
	iters: 700, epoch: 6 | loss: 0.4031977
	speed: 0.0033s/iter; left time: 7.9066s
	iters: 800, epoch: 6 | loss: 0.3686598
	speed: 0.0032s/iter; left time: 7.3429s
	iters: 900, epoch: 6 | loss: 0.4112573
	speed: 0.0031s/iter; left time: 6.7376s
	iters: 1000, epoch: 6 | loss: 0.8994344
	speed: 0.0031s/iter; left time: 6.4610s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 3.3931145668029785
Epoch: 6, Steps: 1027 | Train Loss: 0.6236542 Vali Loss: 0.4229479 Best vali loss: 0.3872557
	iters: 100, epoch: 7 | loss: 0.2834443
	speed: 0.0096s/iter; left time: 18.6765s
	iters: 200, epoch: 7 | loss: 0.4359683
	speed: 0.0033s/iter; left time: 6.1923s
	iters: 300, epoch: 7 | loss: 0.2893606
	speed: 0.0033s/iter; left time: 5.8476s
	iters: 400, epoch: 7 | loss: 0.4111342
	speed: 0.0033s/iter; left time: 5.5253s
	iters: 500, epoch: 7 | loss: 0.3170447
	speed: 0.0033s/iter; left time: 5.1715s
	iters: 600, epoch: 7 | loss: 0.4847041
	speed: 0.0033s/iter; left time: 4.8536s
	iters: 700, epoch: 7 | loss: 0.8258638
	speed: 0.0034s/iter; left time: 4.5783s
	iters: 800, epoch: 7 | loss: 0.4062357
	speed: 0.0034s/iter; left time: 4.2268s
	iters: 900, epoch: 7 | loss: 0.9005312
	speed: 0.0033s/iter; left time: 3.8362s
	iters: 1000, epoch: 7 | loss: 1.0980884
	speed: 0.0033s/iter; left time: 3.4905s
Updating learning rate to 6.580155087893739e-05
Epoch: 7 cost time: 3.468308925628662
Epoch: 7, Steps: 1027 | Train Loss: 0.5452375 Vali Loss: 0.4264939 Best vali loss: 0.3872557
	iters: 100, epoch: 8 | loss: 0.5793447
	speed: 0.0097s/iter; left time: 9.0268s
	iters: 200, epoch: 8 | loss: 0.4877469
	speed: 0.0033s/iter; left time: 2.7588s
	iters: 300, epoch: 8 | loss: 0.3785876
	speed: 0.0033s/iter; left time: 2.4274s
	iters: 400, epoch: 8 | loss: 0.3398309
	speed: 0.0033s/iter; left time: 2.0907s
	iters: 500, epoch: 8 | loss: 0.8813339
	speed: 0.0033s/iter; left time: 1.7456s
	iters: 600, epoch: 8 | loss: 0.3034908
	speed: 0.0033s/iter; left time: 1.4269s
	iters: 700, epoch: 8 | loss: 1.2631838
	speed: 0.0033s/iter; left time: 1.0946s
	iters: 800, epoch: 8 | loss: 0.5941213
	speed: 0.0033s/iter; left time: 0.7589s
	iters: 900, epoch: 8 | loss: 0.6413493
	speed: 0.0033s/iter; left time: 0.4262s
	iters: 1000, epoch: 8 | loss: 0.9808997
	speed: 0.0033s/iter; left time: 0.0934s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.455832004547119
Epoch: 8, Steps: 1027 | Train Loss: 0.6449889 Vali Loss: 0.4359291 Best vali loss: 0.3872557

best validation loss 0.3872556563679034

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4139293
	speed: 0.0096s/iter; left time: 38.5401s
	iters: 200, epoch: 1 | loss: 0.3687405
	speed: 0.0033s/iter; left time: 13.0055s
	iters: 300, epoch: 1 | loss: 0.6796389
	speed: 0.0033s/iter; left time: 12.7363s
	iters: 400, epoch: 1 | loss: 0.4907307
	speed: 0.0033s/iter; left time: 12.2117s
	iters: 500, epoch: 1 | loss: 0.3506686
	speed: 0.0032s/iter; left time: 11.5984s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.3787).  Saving model state dict ...
Epoch: 1 cost time: 2.0720443725585938
Epoch: 1, Steps: 514 | Train Loss: 0.4607416 Vali Loss: 0.3786745 Best vali loss: 0.3786745
	iters: 100, epoch: 2 | loss: 1.0024104
	speed: 0.0070s/iter; left time: 24.3812s
	iters: 200, epoch: 2 | loss: 0.3053653
	speed: 0.0032s/iter; left time: 10.7706s
	iters: 300, epoch: 2 | loss: 0.6115103
	speed: 0.0032s/iter; left time: 10.5454s
	iters: 400, epoch: 2 | loss: 0.3831139
	speed: 0.0033s/iter; left time: 10.5203s
	iters: 500, epoch: 2 | loss: 0.5001059
	speed: 0.0033s/iter; left time: 10.2058s
Updating learning rate to 0.00035114641265
Validation loss decreased (0.3787 --> 0.3740).  Saving model state dict ...
Epoch: 2 cost time: 1.691422939300537
Epoch: 2, Steps: 514 | Train Loss: 0.5605012 Vali Loss: 0.3739696 Best vali loss: 0.3739696
	iters: 100, epoch: 3 | loss: 0.2593785
	speed: 0.0072s/iter; left time: 21.5312s
	iters: 200, epoch: 3 | loss: 0.4073188
	speed: 0.0033s/iter; left time: 9.4868s
	iters: 300, epoch: 3 | loss: 0.4723442
	speed: 0.0034s/iter; left time: 9.3483s
	iters: 400, epoch: 3 | loss: 0.4622893
	speed: 0.0033s/iter; left time: 8.8487s
	iters: 500, epoch: 3 | loss: 1.0992799
	speed: 0.0033s/iter; left time: 8.4806s
Updating learning rate to 0.000175573206325
Validation loss decreased (0.3740 --> 0.3681).  Saving model state dict ...
Epoch: 3 cost time: 1.7306036949157715
Epoch: 3, Steps: 514 | Train Loss: 0.5401221 Vali Loss: 0.3680787 Best vali loss: 0.3680787
	iters: 100, epoch: 4 | loss: 0.8490139
	speed: 0.0070s/iter; left time: 17.2897s
	iters: 200, epoch: 4 | loss: 0.3197115
	speed: 0.0032s/iter; left time: 7.6904s
	iters: 300, epoch: 4 | loss: 0.3361359
	speed: 0.0032s/iter; left time: 7.1940s
	iters: 400, epoch: 4 | loss: 1.1638789
	speed: 0.0032s/iter; left time: 6.9898s
	iters: 500, epoch: 4 | loss: 0.3861947
	speed: 0.0033s/iter; left time: 6.7856s
Updating learning rate to 8.77866031625e-05
Validation loss decreased (0.3681 --> 0.3615).  Saving model state dict ...
Epoch: 4 cost time: 1.679753303527832
Epoch: 4, Steps: 514 | Train Loss: 0.6109870 Vali Loss: 0.3615336 Best vali loss: 0.3615336
	iters: 100, epoch: 5 | loss: 0.8795218
	speed: 0.0072s/iter; left time: 14.1214s
	iters: 200, epoch: 5 | loss: 0.3305196
	speed: 0.0035s/iter; left time: 6.4083s
	iters: 300, epoch: 5 | loss: 0.2899691
	speed: 0.0033s/iter; left time: 5.7842s
	iters: 400, epoch: 5 | loss: 0.4091400
	speed: 0.0033s/iter; left time: 5.5097s
	iters: 500, epoch: 5 | loss: 0.4504574
	speed: 0.0033s/iter; left time: 5.0760s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 1.7520475387573242
Epoch: 5, Steps: 514 | Train Loss: 0.4719216 Vali Loss: 0.3641378 Best vali loss: 0.3615336
	iters: 100, epoch: 6 | loss: 0.3892232
	speed: 0.0072s/iter; left time: 10.3961s
	iters: 200, epoch: 6 | loss: 0.3840828
	speed: 0.0033s/iter; left time: 4.3799s
	iters: 300, epoch: 6 | loss: 0.2934981
	speed: 0.0033s/iter; left time: 4.1449s
	iters: 400, epoch: 6 | loss: 0.6207532
	speed: 0.0032s/iter; left time: 3.6360s
	iters: 500, epoch: 6 | loss: 0.2954863
	speed: 0.0031s/iter; left time: 3.2218s
Updating learning rate to 2.1946650790625e-05
Validation loss decreased (0.3615 --> 0.3600).  Saving model state dict ...
Epoch: 6 cost time: 1.7012629508972168
Epoch: 6, Steps: 514 | Train Loss: 0.3966087 Vali Loss: 0.3599793 Best vali loss: 0.3599793
	iters: 100, epoch: 7 | loss: 0.3302278
	speed: 0.0070s/iter; left time: 6.5258s
	iters: 200, epoch: 7 | loss: 0.3223679
	speed: 0.0031s/iter; left time: 2.5932s
	iters: 300, epoch: 7 | loss: 0.3531207
	speed: 0.0031s/iter; left time: 2.2690s
	iters: 400, epoch: 7 | loss: 0.8247973
	speed: 0.0031s/iter; left time: 1.9740s
	iters: 500, epoch: 7 | loss: 0.6126553
	speed: 0.0031s/iter; left time: 1.6317s
Updating learning rate to 1.09733253953125e-05
Validation loss decreased (0.3600 --> 0.3585).  Saving model state dict ...
Epoch: 7 cost time: 1.6427075862884521
Epoch: 7, Steps: 514 | Train Loss: 0.4886338 Vali Loss: 0.3584842 Best vali loss: 0.3584842
	iters: 100, epoch: 8 | loss: 0.7056438
	speed: 0.0071s/iter; left time: 2.9370s
	iters: 200, epoch: 8 | loss: 0.6056703
	speed: 0.0033s/iter; left time: 1.0243s
	iters: 300, epoch: 8 | loss: 0.6424304
	speed: 0.0032s/iter; left time: 0.6822s
	iters: 400, epoch: 8 | loss: 0.2417943
	speed: 0.0032s/iter; left time: 0.3718s
	iters: 500, epoch: 8 | loss: 0.4321860
	speed: 0.0032s/iter; left time: 0.0478s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 1.699599266052246
Epoch: 8, Steps: 514 | Train Loss: 0.5255450 Vali Loss: 0.3592398 Best vali loss: 0.3584842

best validation loss 0.3584841625922321

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8000959
	speed: 0.0096s/iter; left time: 38.5965s
	iters: 200, epoch: 1 | loss: 0.3300870
	speed: 0.0036s/iter; left time: 13.9225s
	iters: 300, epoch: 1 | loss: 0.5283860
	speed: 0.0034s/iter; left time: 13.0136s
	iters: 400, epoch: 1 | loss: 0.9829745
	speed: 0.0034s/iter; left time: 12.5328s
	iters: 500, epoch: 1 | loss: 0.8997478
	speed: 0.0036s/iter; left time: 12.8549s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.3897).  Saving model state dict ...
Epoch: 1 cost time: 2.1418073177337646
Epoch: 1, Steps: 514 | Train Loss: 0.7082582 Vali Loss: 0.3897384 Best vali loss: 0.3897384
	iters: 100, epoch: 2 | loss: 1.3238033
	speed: 0.0071s/iter; left time: 24.9192s
	iters: 200, epoch: 2 | loss: 0.6534771
	speed: 0.0035s/iter; left time: 11.7739s
	iters: 300, epoch: 2 | loss: 0.6707288
	speed: 0.0034s/iter; left time: 11.2446s
	iters: 400, epoch: 2 | loss: 0.6302174
	speed: 0.0033s/iter; left time: 10.4852s
	iters: 500, epoch: 2 | loss: 0.7218796
	speed: 0.0032s/iter; left time: 9.7991s
Updating learning rate to 0.0001951505909
Validation loss decreased (0.3897 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 1.7528612613677979
Epoch: 2, Steps: 514 | Train Loss: 0.8000212 Vali Loss: 0.3690788 Best vali loss: 0.3690788
	iters: 100, epoch: 3 | loss: 0.4485910
	speed: 0.0075s/iter; left time: 22.3544s
	iters: 200, epoch: 3 | loss: 0.3929313
	speed: 0.0033s/iter; left time: 9.5583s
	iters: 300, epoch: 3 | loss: 0.5185086
	speed: 0.0033s/iter; left time: 9.2292s
	iters: 400, epoch: 3 | loss: 0.4920582
	speed: 0.0033s/iter; left time: 8.9311s
	iters: 500, epoch: 3 | loss: 0.9920555
	speed: 0.0033s/iter; left time: 8.6398s
Updating learning rate to 9.757529545e-05
Validation loss decreased (0.3691 --> 0.3614).  Saving model state dict ...
Epoch: 3 cost time: 1.7471425533294678
Epoch: 3, Steps: 514 | Train Loss: 0.5688289 Vali Loss: 0.3613608 Best vali loss: 0.3613608

best validation loss 0.3613608049503244

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7199348
	speed: 0.0110s/iter; left time: 10.2165s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.4366).  Saving model state dict ...
Epoch: 1 cost time: 0.9869556427001953
Epoch: 1, Steps: 129 | Train Loss: 0.7199348 Vali Loss: 0.4365684 Best vali loss: 0.4365684
	iters: 100, epoch: 2 | loss: 0.9601367
	speed: 0.0083s/iter; left time: 6.6522s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.4366 --> 0.4223).  Saving model state dict ...
Epoch: 2 cost time: 0.6715483665466309
Epoch: 2, Steps: 129 | Train Loss: 0.9601367 Vali Loss: 0.4222782 Best vali loss: 0.4222782
	iters: 100, epoch: 3 | loss: 0.7662494
	speed: 0.0083s/iter; left time: 5.6083s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.4223 --> 0.4117).  Saving model state dict ...
Epoch: 3 cost time: 0.6908712387084961
Epoch: 3, Steps: 129 | Train Loss: 0.7662494 Vali Loss: 0.4116634 Best vali loss: 0.4116634

best validation loss 0.41166335409891397

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3351688
	speed: 0.0096s/iter; left time: 38.3871s
	iters: 200, epoch: 1 | loss: 0.3885376
	speed: 0.0035s/iter; left time: 13.6099s
	iters: 300, epoch: 1 | loss: 0.3356673
	speed: 0.0036s/iter; left time: 13.6652s
	iters: 400, epoch: 1 | loss: 0.6646755
	speed: 0.0036s/iter; left time: 13.5237s
	iters: 500, epoch: 1 | loss: 0.4719063
	speed: 0.0035s/iter; left time: 12.6446s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.4126).  Saving model state dict ...
Epoch: 1 cost time: 2.1682376861572266
Epoch: 1, Steps: 514 | Train Loss: 0.4391911 Vali Loss: 0.4126202 Best vali loss: 0.4126202
	iters: 100, epoch: 2 | loss: 0.4477439
	speed: 0.0077s/iter; left time: 27.0792s
	iters: 200, epoch: 2 | loss: 0.3598885
	speed: 0.0036s/iter; left time: 12.3212s
	iters: 300, epoch: 2 | loss: 0.6873467
	speed: 0.0034s/iter; left time: 11.3075s
	iters: 400, epoch: 2 | loss: 0.5809535
	speed: 0.0034s/iter; left time: 11.0362s
	iters: 500, epoch: 2 | loss: 0.3457148
	speed: 0.0036s/iter; left time: 11.0124s
Updating learning rate to 0.00017030763336576413
Validation loss decreased (0.4126 --> 0.3724).  Saving model state dict ...
Epoch: 2 cost time: 1.8601665496826172
Epoch: 2, Steps: 514 | Train Loss: 0.4843295 Vali Loss: 0.3723628 Best vali loss: 0.3723628
	iters: 100, epoch: 3 | loss: 0.3460182
	speed: 0.0074s/iter; left time: 22.2381s
	iters: 200, epoch: 3 | loss: 0.3963697
	speed: 0.0032s/iter; left time: 9.2172s
	iters: 300, epoch: 3 | loss: 0.5380616
	speed: 0.0032s/iter; left time: 8.7805s
	iters: 400, epoch: 3 | loss: 0.6256911
	speed: 0.0030s/iter; left time: 8.0690s
	iters: 500, epoch: 3 | loss: 0.3567729
	speed: 0.0030s/iter; left time: 7.8040s
Updating learning rate to 0.00013794189423609193
Validation loss decreased (0.3724 --> 0.3602).  Saving model state dict ...
Epoch: 3 cost time: 1.6502411365509033
Epoch: 3, Steps: 514 | Train Loss: 0.4525827 Vali Loss: 0.3601794 Best vali loss: 0.3601794

best validation loss 0.3601793530179382

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3214990
	speed: 0.0099s/iter; left time: 24.3599s
	iters: 200, epoch: 4 | loss: 0.3565430
	speed: 0.0034s/iter; left time: 8.0375s
	iters: 300, epoch: 4 | loss: 0.3010639
	speed: 0.0035s/iter; left time: 7.8739s
	iters: 400, epoch: 4 | loss: 0.4890069
	speed: 0.0035s/iter; left time: 7.6780s
	iters: 500, epoch: 4 | loss: 0.4658611
	speed: 0.0034s/iter; left time: 6.9458s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 2.1268222332000732
Epoch: 4, Steps: 514 | Train Loss: 0.3867948 Vali Loss: 0.3853492 Best vali loss: 0.3601794
	iters: 100, epoch: 5 | loss: 0.2808773
	speed: 0.0070s/iter; left time: 13.6475s
	iters: 200, epoch: 5 | loss: 0.2482198
	speed: 0.0031s/iter; left time: 5.7926s
	iters: 300, epoch: 5 | loss: 0.6002316
	speed: 0.0032s/iter; left time: 5.5968s
	iters: 400, epoch: 5 | loss: 0.4800650
	speed: 0.0031s/iter; left time: 5.1288s
	iters: 500, epoch: 5 | loss: 0.3196126
	speed: 0.0030s/iter; left time: 4.6290s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 1.634993314743042
Epoch: 5, Steps: 514 | Train Loss: 0.3858013 Vali Loss: 0.4089372 Best vali loss: 0.3601794
	iters: 100, epoch: 6 | loss: 0.2535149
	speed: 0.0068s/iter; left time: 9.8095s
	iters: 200, epoch: 6 | loss: 0.2901801
	speed: 0.0032s/iter; left time: 4.2871s
	iters: 300, epoch: 6 | loss: 0.4615254
	speed: 0.0033s/iter; left time: 4.0587s
	iters: 400, epoch: 6 | loss: 0.4796412
	speed: 0.0032s/iter; left time: 3.6112s
	iters: 500, epoch: 6 | loss: 0.2942592
	speed: 0.0032s/iter; left time: 3.3133s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 1.6783263683319092
Epoch: 6, Steps: 514 | Train Loss: 0.3558241 Vali Loss: 0.4076377 Best vali loss: 0.3601794
	iters: 100, epoch: 7 | loss: 0.4612423
	speed: 0.0069s/iter; left time: 6.4546s
	iters: 200, epoch: 7 | loss: 0.7011342
	speed: 0.0032s/iter; left time: 2.6808s
	iters: 300, epoch: 7 | loss: 0.4509079
	speed: 0.0031s/iter; left time: 2.2462s
	iters: 400, epoch: 7 | loss: 0.4340279
	speed: 0.0030s/iter; left time: 1.8981s
	iters: 500, epoch: 7 | loss: 0.2327118
	speed: 0.0033s/iter; left time: 1.7282s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 1.6734633445739746
Epoch: 7, Steps: 514 | Train Loss: 0.4560048 Vali Loss: 0.4267931 Best vali loss: 0.3601794
	iters: 100, epoch: 8 | loss: 0.1699777
	speed: 0.0078s/iter; left time: 3.2185s
	iters: 200, epoch: 8 | loss: 0.2543542
	speed: 0.0036s/iter; left time: 1.1352s
	iters: 300, epoch: 8 | loss: 0.4568730
	speed: 0.0035s/iter; left time: 0.7580s
	iters: 400, epoch: 8 | loss: 0.2133229
	speed: 0.0036s/iter; left time: 0.4159s
	iters: 500, epoch: 8 | loss: 0.4429946
	speed: 0.0036s/iter; left time: 0.0539s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8944122791290283
Epoch: 8, Steps: 514 | Train Loss: 0.3075045 Vali Loss: 0.4235575 Best vali loss: 0.3601794

best validation loss 0.3601793530179382

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6002050
	speed: 0.0086s/iter; left time: 34.6088s
	iters: 200, epoch: 1 | loss: 0.5861329
	speed: 0.0024s/iter; left time: 9.3748s
	iters: 300, epoch: 1 | loss: 0.7243412
	speed: 0.0023s/iter; left time: 8.8195s
	iters: 400, epoch: 1 | loss: 0.3034856
	speed: 0.0023s/iter; left time: 8.5856s
	iters: 500, epoch: 1 | loss: 1.1851391
	speed: 0.0023s/iter; left time: 8.4579s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 1.5796058177947998
Epoch: 1, Steps: 514 | Train Loss: 0.6798607 Vali Loss: 0.3674941 Best vali loss: 0.3674941
	iters: 100, epoch: 2 | loss: 0.8241427
	speed: 0.0057s/iter; left time: 19.9863s
	iters: 200, epoch: 2 | loss: 0.5459788
	speed: 0.0023s/iter; left time: 7.8818s
	iters: 300, epoch: 2 | loss: 0.8472459
	speed: 0.0023s/iter; left time: 7.6208s
	iters: 400, epoch: 2 | loss: 0.5069124
	speed: 0.0023s/iter; left time: 7.1981s
	iters: 500, epoch: 2 | loss: 0.8212841
	speed: 0.0023s/iter; left time: 7.1354s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 1.2225794792175293
Epoch: 2, Steps: 514 | Train Loss: 0.7091128 Vali Loss: 0.3709357 Best vali loss: 0.3674941
	iters: 100, epoch: 3 | loss: 0.4921837
	speed: 0.0056s/iter; left time: 16.7725s
	iters: 200, epoch: 3 | loss: 0.4915968
	speed: 0.0023s/iter; left time: 6.6752s
	iters: 300, epoch: 3 | loss: 0.5979614
	speed: 0.0022s/iter; left time: 6.2290s
	iters: 400, epoch: 3 | loss: 0.4180506
	speed: 0.0023s/iter; left time: 6.2315s
	iters: 500, epoch: 3 | loss: 0.7054688
	speed: 0.0023s/iter; left time: 6.0695s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 1.2265267372131348
Epoch: 3, Steps: 514 | Train Loss: 0.5410522 Vali Loss: 0.3724256 Best vali loss: 0.3674941
	iters: 100, epoch: 4 | loss: 0.5571039
	speed: 0.0056s/iter; left time: 13.7606s
	iters: 200, epoch: 4 | loss: 0.3360915
	speed: 0.0024s/iter; left time: 5.5934s
	iters: 300, epoch: 4 | loss: 0.4777632
	speed: 0.0024s/iter; left time: 5.4679s
	iters: 400, epoch: 4 | loss: 0.3094230
	speed: 0.0025s/iter; left time: 5.3268s
	iters: 500, epoch: 4 | loss: 0.7526888
	speed: 0.0024s/iter; left time: 4.9416s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 1.2676072120666504
Epoch: 4, Steps: 514 | Train Loss: 0.4866141 Vali Loss: 0.3863943 Best vali loss: 0.3674941
	iters: 100, epoch: 5 | loss: 0.6169878
	speed: 0.0056s/iter; left time: 10.9612s
	iters: 200, epoch: 5 | loss: 0.8916249
	speed: 0.0024s/iter; left time: 4.3988s
	iters: 300, epoch: 5 | loss: 0.2936302
	speed: 0.0024s/iter; left time: 4.1579s
	iters: 400, epoch: 5 | loss: 0.3028219
	speed: 0.0023s/iter; left time: 3.7769s
	iters: 500, epoch: 5 | loss: 0.4424862
	speed: 0.0023s/iter; left time: 3.5230s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 1.2332496643066406
Epoch: 5, Steps: 514 | Train Loss: 0.5095102 Vali Loss: 0.3864951 Best vali loss: 0.3674941
	iters: 100, epoch: 6 | loss: 0.4149596
	speed: 0.0057s/iter; left time: 8.1550s
	iters: 200, epoch: 6 | loss: 0.3915160
	speed: 0.0024s/iter; left time: 3.2183s
	iters: 300, epoch: 6 | loss: 0.7324364
	speed: 0.0024s/iter; left time: 2.9794s
	iters: 400, epoch: 6 | loss: 0.2985416
	speed: 0.0024s/iter; left time: 2.6940s
	iters: 500, epoch: 6 | loss: 0.4529157
	speed: 0.0023s/iter; left time: 2.4335s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 1.2533550262451172
Epoch: 6, Steps: 514 | Train Loss: 0.4580739 Vali Loss: 0.3905740 Best vali loss: 0.3674941
	iters: 100, epoch: 7 | loss: 0.7932532
	speed: 0.0057s/iter; left time: 5.2882s
	iters: 200, epoch: 7 | loss: 0.2894899
	speed: 0.0023s/iter; left time: 1.9303s
	iters: 300, epoch: 7 | loss: 0.3155163
	speed: 0.0023s/iter; left time: 1.7057s
	iters: 400, epoch: 7 | loss: 0.2788796
	speed: 0.0024s/iter; left time: 1.5258s
	iters: 500, epoch: 7 | loss: 0.3392065
	speed: 0.0024s/iter; left time: 1.2822s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 1.2576909065246582
Epoch: 7, Steps: 514 | Train Loss: 0.4032691 Vali Loss: 0.3879750 Best vali loss: 0.3674941
	iters: 100, epoch: 8 | loss: 0.2257896
	speed: 0.0057s/iter; left time: 2.3618s
	iters: 200, epoch: 8 | loss: 0.6712865
	speed: 0.0026s/iter; left time: 0.8280s
	iters: 300, epoch: 8 | loss: 0.5162792
	speed: 0.0026s/iter; left time: 0.5541s
	iters: 400, epoch: 8 | loss: 0.2947750
	speed: 0.0025s/iter; left time: 0.2931s
	iters: 500, epoch: 8 | loss: 0.3695031
	speed: 0.0026s/iter; left time: 0.0393s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3671541213989258
Epoch: 8, Steps: 514 | Train Loss: 0.4155267 Vali Loss: 0.3899852 Best vali loss: 0.3674941

best validation loss 0.3674940906069836

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5714291
	speed: 0.0096s/iter; left time: 18.8791s
	iters: 200, epoch: 1 | loss: 0.3907830
	speed: 0.0037s/iter; left time: 6.9008s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.2944176197052002
Epoch: 1, Steps: 257 | Train Loss: 0.4811061 Vali Loss: 0.3689573 Best vali loss: 0.3689573
	iters: 100, epoch: 2 | loss: 0.5793417
	speed: 0.0083s/iter; left time: 14.0471s
	iters: 200, epoch: 2 | loss: 0.6889728
	speed: 0.0038s/iter; left time: 6.0349s
Updating learning rate to 0.0001389884753
Validation loss decreased (0.3690 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 0.9916489124298096
Epoch: 2, Steps: 257 | Train Loss: 0.6341573 Vali Loss: 0.3635834 Best vali loss: 0.3635834
	iters: 100, epoch: 3 | loss: 0.8472914
	speed: 0.0078s/iter; left time: 11.1879s
	iters: 200, epoch: 3 | loss: 0.7912035
	speed: 0.0035s/iter; left time: 4.7072s
Updating learning rate to 6.949423765e-05
Epoch: 3 cost time: 0.9309766292572021
Epoch: 3, Steps: 257 | Train Loss: 0.8192474 Vali Loss: 0.3697233 Best vali loss: 0.3635834
	iters: 100, epoch: 4 | loss: 0.7005532
	speed: 0.0076s/iter; left time: 8.9819s
	iters: 200, epoch: 4 | loss: 0.5229058
	speed: 0.0034s/iter; left time: 3.6747s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 0.9163682460784912
Epoch: 4, Steps: 257 | Train Loss: 0.6117295 Vali Loss: 0.3683425 Best vali loss: 0.3635834
	iters: 100, epoch: 5 | loss: 0.7356853
	speed: 0.0077s/iter; left time: 7.1373s
	iters: 200, epoch: 5 | loss: 0.4919362
	speed: 0.0035s/iter; left time: 2.9063s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 0.9336886405944824
Epoch: 5, Steps: 257 | Train Loss: 0.6138108 Vali Loss: 0.3685145 Best vali loss: 0.3635834
	iters: 100, epoch: 6 | loss: 0.6743032
	speed: 0.0076s/iter; left time: 5.0817s
	iters: 200, epoch: 6 | loss: 0.6993050
	speed: 0.0032s/iter; left time: 1.8588s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 0.8752126693725586
Epoch: 6, Steps: 257 | Train Loss: 0.6868041 Vali Loss: 0.3696650 Best vali loss: 0.3635834
	iters: 100, epoch: 7 | loss: 0.7406004
	speed: 0.0073s/iter; left time: 3.0485s
	iters: 200, epoch: 7 | loss: 0.5738471
	speed: 0.0032s/iter; left time: 1.0176s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 0.876875638961792
Epoch: 7, Steps: 257 | Train Loss: 0.6572237 Vali Loss: 0.3687695 Best vali loss: 0.3635834
	iters: 100, epoch: 8 | loss: 0.5575924
	speed: 0.0073s/iter; left time: 1.1607s
	iters: 200, epoch: 8 | loss: 0.5660117
	speed: 0.0032s/iter; left time: 0.1850s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 0.863976001739502
Epoch: 8, Steps: 257 | Train Loss: 0.5618020 Vali Loss: 0.3689092 Best vali loss: 0.3635834

best validation loss 0.3635834244590377

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0527618
	speed: 0.0113s/iter; left time: 45.4446s
	iters: 200, epoch: 1 | loss: 1.0210898
	speed: 0.0052s/iter; left time: 20.3914s
	iters: 300, epoch: 1 | loss: 0.3762058
	speed: 0.0049s/iter; left time: 18.6678s
	iters: 400, epoch: 1 | loss: 0.9033100
	speed: 0.0048s/iter; left time: 17.7546s
	iters: 500, epoch: 1 | loss: 0.5836982
	speed: 0.0048s/iter; left time: 17.2650s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.4071).  Saving model state dict ...
Epoch: 1 cost time: 2.9113011360168457
Epoch: 1, Steps: 514 | Train Loss: 0.7874131 Vali Loss: 0.4070633 Best vali loss: 0.4070633
	iters: 100, epoch: 2 | loss: 0.7503169
	speed: 0.0101s/iter; left time: 35.3566s
	iters: 200, epoch: 2 | loss: 0.6650775
	speed: 0.0051s/iter; left time: 17.3678s
	iters: 300, epoch: 2 | loss: 1.0634236
	speed: 0.0052s/iter; left time: 17.3154s
	iters: 400, epoch: 2 | loss: 0.8969666
	speed: 0.0051s/iter; left time: 16.4731s
	iters: 500, epoch: 2 | loss: 0.7090632
	speed: 0.0052s/iter; left time: 16.2330s
Updating learning rate to 0.0024210654541
Validation loss decreased (0.4071 --> 0.3988).  Saving model state dict ...
Epoch: 2 cost time: 2.714515209197998
Epoch: 2, Steps: 514 | Train Loss: 0.8169696 Vali Loss: 0.3987540 Best vali loss: 0.3987540
	iters: 100, epoch: 3 | loss: 0.4228985
	speed: 0.0097s/iter; left time: 29.0432s
	iters: 200, epoch: 3 | loss: 0.8634226
	speed: 0.0048s/iter; left time: 13.9859s
	iters: 300, epoch: 3 | loss: 0.8451235
	speed: 0.0052s/iter; left time: 14.4788s
	iters: 400, epoch: 3 | loss: 0.7899066
	speed: 0.0052s/iter; left time: 13.9931s
	iters: 500, epoch: 3 | loss: 0.4493688
	speed: 0.0053s/iter; left time: 13.6605s
Updating learning rate to 0.00121053272705
Epoch: 3 cost time: 2.6352131366729736
Epoch: 3, Steps: 514 | Train Loss: 0.6741440 Vali Loss: 0.4061886 Best vali loss: 0.3987540

best validation loss 0.39875401452857057

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.4167).  Saving model state dict ...
Epoch: 1 cost time: 0.627504825592041
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4166608 Best vali loss: 0.4166608
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.4167 --> 0.3953).  Saving model state dict ...
Epoch: 2 cost time: 0.33292412757873535
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3952654 Best vali loss: 0.3952654
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.3953 --> 0.3882).  Saving model state dict ...
Epoch: 3 cost time: 0.3153800964355469
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3882189 Best vali loss: 0.3882189

best validation loss 0.3882188908594765

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5883850
	speed: 0.0117s/iter; left time: 10.8725s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.3946).  Saving model state dict ...
Epoch: 1 cost time: 1.0701572895050049
Epoch: 1, Steps: 129 | Train Loss: 0.5883850 Vali Loss: 0.3945815 Best vali loss: 0.3945815
	iters: 100, epoch: 2 | loss: 0.7442865
	speed: 0.0091s/iter; left time: 7.2828s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.3946 --> 0.3824).  Saving model state dict ...
Epoch: 2 cost time: 0.7462253570556641
Epoch: 2, Steps: 129 | Train Loss: 0.7442865 Vali Loss: 0.3824158 Best vali loss: 0.3824158
	iters: 100, epoch: 3 | loss: 0.4717863
	speed: 0.0096s/iter; left time: 6.4946s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.3824 --> 0.3774).  Saving model state dict ...
Epoch: 3 cost time: 0.8087644577026367
Epoch: 3, Steps: 129 | Train Loss: 0.4717863 Vali Loss: 0.3774189 Best vali loss: 0.3774189

best validation loss 0.37741891523943905

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5339301
	speed: 0.0118s/iter; left time: 6.4205s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.3774 --> 0.3743).  Saving model state dict ...
Epoch: 4 cost time: 1.0670232772827148
Epoch: 4, Steps: 129 | Train Loss: 0.5339301 Vali Loss: 0.3743483 Best vali loss: 0.3743483
	iters: 100, epoch: 5 | loss: 0.7266656
	speed: 0.0095s/iter; left time: 3.9647s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.3743 --> 0.3743).  Saving model state dict ...
Epoch: 5 cost time: 0.8011698722839355
Epoch: 5, Steps: 129 | Train Loss: 0.7266656 Vali Loss: 0.3742969 Best vali loss: 0.3742969
	iters: 100, epoch: 6 | loss: 0.4650819
	speed: 0.0096s/iter; left time: 2.7621s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.3743 --> 0.3738).  Saving model state dict ...
Epoch: 6 cost time: 0.7922773361206055
Epoch: 6, Steps: 129 | Train Loss: 0.4650819 Vali Loss: 0.3737640 Best vali loss: 0.3737640
	iters: 100, epoch: 7 | loss: 0.5872651
	speed: 0.0092s/iter; left time: 1.4610s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.3738 --> 0.3736).  Saving model state dict ...
Epoch: 7 cost time: 0.767380952835083
Epoch: 7, Steps: 129 | Train Loss: 0.5872651 Vali Loss: 0.3735884 Best vali loss: 0.3735884
	iters: 100, epoch: 8 | loss: 0.5789853
	speed: 0.0089s/iter; left time: 0.2681s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.3736 --> 0.3735).  Saving model state dict ...
Epoch: 8 cost time: 0.7159228324890137
Epoch: 8, Steps: 129 | Train Loss: 0.5789853 Vali Loss: 0.3734661 Best vali loss: 0.3734661

best validation loss 0.3734660619251386

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8288559
	speed: 0.0103s/iter; left time: 20.1348s
	iters: 200, epoch: 1 | loss: 0.4414019
	speed: 0.0042s/iter; left time: 7.7402s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.3667).  Saving model state dict ...
Epoch: 1 cost time: 1.4181222915649414
Epoch: 1, Steps: 257 | Train Loss: 0.6351289 Vali Loss: 0.3667449 Best vali loss: 0.3667449
	iters: 100, epoch: 2 | loss: 0.7183819
	speed: 0.0095s/iter; left time: 16.2265s
	iters: 200, epoch: 2 | loss: 0.5706888
	speed: 0.0047s/iter; left time: 7.4765s
Updating learning rate to 6.69828834e-05
Epoch: 2 cost time: 1.2442889213562012
Epoch: 2, Steps: 257 | Train Loss: 0.6445354 Vali Loss: 0.3678447 Best vali loss: 0.3667449
	iters: 100, epoch: 3 | loss: 0.6979241
	speed: 0.0096s/iter; left time: 13.8147s
	iters: 200, epoch: 3 | loss: 0.7754724
	speed: 0.0046s/iter; left time: 6.1367s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 1.2160918712615967
Epoch: 3, Steps: 257 | Train Loss: 0.7366983 Vali Loss: 0.3826639 Best vali loss: 0.3667449
	iters: 100, epoch: 4 | loss: 0.4912842
	speed: 0.0099s/iter; left time: 11.7681s
	iters: 200, epoch: 4 | loss: 0.4697499
	speed: 0.0045s/iter; left time: 4.9358s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 1.221846342086792
Epoch: 4, Steps: 257 | Train Loss: 0.4805171 Vali Loss: 0.3932650 Best vali loss: 0.3667449
	iters: 100, epoch: 5 | loss: 0.7858243
	speed: 0.0092s/iter; left time: 8.5870s
	iters: 200, epoch: 5 | loss: 0.7148141
	speed: 0.0041s/iter; left time: 3.3816s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 1.1092219352722168
Epoch: 5, Steps: 257 | Train Loss: 0.7503192 Vali Loss: 0.3946941 Best vali loss: 0.3667449
	iters: 100, epoch: 6 | loss: 0.4973920
	speed: 0.0094s/iter; left time: 6.2833s
	iters: 200, epoch: 6 | loss: 0.7888156
	speed: 0.0045s/iter; left time: 2.5858s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 1.205049753189087
Epoch: 6, Steps: 257 | Train Loss: 0.6431038 Vali Loss: 0.3953246 Best vali loss: 0.3667449
	iters: 100, epoch: 7 | loss: 0.7146986
	speed: 0.0094s/iter; left time: 3.8977s
	iters: 200, epoch: 7 | loss: 0.4778363
	speed: 0.0044s/iter; left time: 1.3811s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 1.1757535934448242
Epoch: 7, Steps: 257 | Train Loss: 0.5962674 Vali Loss: 0.3959771 Best vali loss: 0.3667449
	iters: 100, epoch: 8 | loss: 0.4717759
	speed: 0.0092s/iter; left time: 1.4473s
	iters: 200, epoch: 8 | loss: 0.7273515
	speed: 0.0040s/iter; left time: 0.2325s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 1.0923919677734375
Epoch: 8, Steps: 257 | Train Loss: 0.5995637 Vali Loss: 0.3953506 Best vali loss: 0.3667449

best validation loss 0.3667448693970566

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6531793
	speed: 0.0087s/iter; left time: 17.1042s
	iters: 200, epoch: 1 | loss: 0.4421897
	speed: 0.0027s/iter; left time: 5.0916s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.4052).  Saving model state dict ...
Epoch: 1 cost time: 1.0450963973999023
Epoch: 1, Steps: 257 | Train Loss: 0.5476845 Vali Loss: 0.4051535 Best vali loss: 0.4051535
	iters: 100, epoch: 2 | loss: 0.7135018
	speed: 0.0065s/iter; left time: 10.9831s
	iters: 200, epoch: 2 | loss: 0.3800555
	speed: 0.0026s/iter; left time: 4.0974s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.4052 --> 0.3860).  Saving model state dict ...
Epoch: 2 cost time: 0.7136328220367432
Epoch: 2, Steps: 257 | Train Loss: 0.5467786 Vali Loss: 0.3859728 Best vali loss: 0.3859728
	iters: 100, epoch: 3 | loss: 0.5427138
	speed: 0.0064s/iter; left time: 9.1864s
	iters: 200, epoch: 3 | loss: 0.8464319
	speed: 0.0025s/iter; left time: 3.3760s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.3860 --> 0.3797).  Saving model state dict ...
Epoch: 3 cost time: 0.6984386444091797
Epoch: 3, Steps: 257 | Train Loss: 0.6945729 Vali Loss: 0.3796633 Best vali loss: 0.3796633
	iters: 100, epoch: 4 | loss: 0.7496415
	speed: 0.0065s/iter; left time: 7.6809s
	iters: 200, epoch: 4 | loss: 0.8867301
	speed: 0.0027s/iter; left time: 2.9527s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.3797 --> 0.3773).  Saving model state dict ...
Epoch: 4 cost time: 0.7424318790435791
Epoch: 4, Steps: 257 | Train Loss: 0.8181858 Vali Loss: 0.3772760 Best vali loss: 0.3772760
	iters: 100, epoch: 5 | loss: 0.6032255
	speed: 0.0062s/iter; left time: 5.8057s
	iters: 200, epoch: 5 | loss: 0.2907971
	speed: 0.0026s/iter; left time: 2.1458s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.3773 --> 0.3761).  Saving model state dict ...
Epoch: 5 cost time: 0.7150654792785645
Epoch: 5, Steps: 257 | Train Loss: 0.4470113 Vali Loss: 0.3761427 Best vali loss: 0.3761427
	iters: 100, epoch: 6 | loss: 0.6163468
	speed: 0.0062s/iter; left time: 4.1590s
	iters: 200, epoch: 6 | loss: 0.6610746
	speed: 0.0025s/iter; left time: 1.4425s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.3761 --> 0.3756).  Saving model state dict ...
Epoch: 6 cost time: 0.6922788619995117
Epoch: 6, Steps: 257 | Train Loss: 0.6387107 Vali Loss: 0.3755753 Best vali loss: 0.3755753
	iters: 100, epoch: 7 | loss: 0.7646822
	speed: 0.0063s/iter; left time: 2.5966s
	iters: 200, epoch: 7 | loss: 0.6844440
	speed: 0.0026s/iter; left time: 0.8308s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.3756 --> 0.3753).  Saving model state dict ...
Epoch: 7 cost time: 0.7053050994873047
Epoch: 7, Steps: 257 | Train Loss: 0.7245631 Vali Loss: 0.3753241 Best vali loss: 0.3753241
	iters: 100, epoch: 8 | loss: 0.5360254
	speed: 0.0063s/iter; left time: 0.9943s
	iters: 200, epoch: 8 | loss: 0.7995795
	speed: 0.0026s/iter; left time: 0.1520s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.3753 --> 0.3752).  Saving model state dict ...
Epoch: 8 cost time: 0.7168574333190918
Epoch: 8, Steps: 257 | Train Loss: 0.6678025 Vali Loss: 0.3751972 Best vali loss: 0.3751972

best validation loss 0.37519721567982073

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4626904
	speed: 0.0114s/iter; left time: 45.6911s
	iters: 200, epoch: 1 | loss: 0.7180849
	speed: 0.0052s/iter; left time: 20.4644s
	iters: 300, epoch: 1 | loss: 1.3460205
	speed: 0.0053s/iter; left time: 20.1842s
	iters: 400, epoch: 1 | loss: 0.7441911
	speed: 0.0049s/iter; left time: 18.0475s
	iters: 500, epoch: 1 | loss: 0.8212720
	speed: 0.0047s/iter; left time: 17.0200s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.4062).  Saving model state dict ...
Epoch: 1 cost time: 2.9581801891326904
Epoch: 1, Steps: 514 | Train Loss: 0.8184518 Vali Loss: 0.4062369 Best vali loss: 0.4062369
	iters: 100, epoch: 2 | loss: 0.7847904
	speed: 0.0098s/iter; left time: 34.1765s
	iters: 200, epoch: 2 | loss: 0.7298195
	speed: 0.0049s/iter; left time: 16.7870s
	iters: 300, epoch: 2 | loss: 0.6933530
	speed: 0.0049s/iter; left time: 16.1461s
	iters: 400, epoch: 2 | loss: 0.9340209
	speed: 0.0048s/iter; left time: 15.4251s
	iters: 500, epoch: 2 | loss: 0.4624413
	speed: 0.0049s/iter; left time: 15.2710s
Updating learning rate to 0.0022202606486
Validation loss decreased (0.4062 --> 0.4023).  Saving model state dict ...
Epoch: 2 cost time: 2.5565004348754883
Epoch: 2, Steps: 514 | Train Loss: 0.7208850 Vali Loss: 0.4023358 Best vali loss: 0.4023358
	iters: 100, epoch: 3 | loss: 0.6789380
	speed: 0.0101s/iter; left time: 30.1788s
	iters: 200, epoch: 3 | loss: 0.8495986
	speed: 0.0050s/iter; left time: 14.3004s
	iters: 300, epoch: 3 | loss: 1.1336247
	speed: 0.0049s/iter; left time: 13.6457s
	iters: 400, epoch: 3 | loss: 1.0975356
	speed: 0.0050s/iter; left time: 13.3200s
	iters: 500, epoch: 3 | loss: 0.9211435
	speed: 0.0053s/iter; left time: 13.6378s
Updating learning rate to 0.0011101303243
Epoch: 3 cost time: 2.61138653755188
Epoch: 3, Steps: 514 | Train Loss: 0.9361681 Vali Loss: 0.4072989 Best vali loss: 0.4023358

best validation loss 0.4023357911873426

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6698834
	speed: 0.0097s/iter; left time: 9.0707s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 0.782684326171875
Epoch: 1, Steps: 129 | Train Loss: 0.6698834 Vali Loss: 0.3702381 Best vali loss: 0.3702381
	iters: 100, epoch: 2 | loss: 0.5911899
	speed: 0.0063s/iter; left time: 5.0850s
Updating learning rate to 0.0005602820643
Validation loss decreased (0.3702 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 0.4851851463317871
Epoch: 2, Steps: 129 | Train Loss: 0.5911899 Vali Loss: 0.3660107 Best vali loss: 0.3660107
	iters: 100, epoch: 3 | loss: 0.7159843
	speed: 0.0065s/iter; left time: 4.3645s
Updating learning rate to 0.00028014103215
Epoch: 3 cost time: 0.48589181900024414
Epoch: 3, Steps: 129 | Train Loss: 0.7159843 Vali Loss: 0.3693690 Best vali loss: 0.3660107

best validation loss 0.3660106759877008

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2741672
	speed: 0.0088s/iter; left time: 35.1832s
	iters: 200, epoch: 1 | loss: 0.8053100
	speed: 0.0025s/iter; left time: 9.7461s
	iters: 300, epoch: 1 | loss: 0.6333768
	speed: 0.0025s/iter; left time: 9.3720s
	iters: 400, epoch: 1 | loss: 0.3709037
	speed: 0.0024s/iter; left time: 8.9825s
	iters: 500, epoch: 1 | loss: 0.6785799
	speed: 0.0025s/iter; left time: 9.1872s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.6322553157806396
Epoch: 1, Steps: 514 | Train Loss: 0.5524675 Vali Loss: 0.3672255 Best vali loss: 0.3672255
	iters: 100, epoch: 2 | loss: 0.5034736
	speed: 0.0062s/iter; left time: 21.8031s
	iters: 200, epoch: 2 | loss: 1.3427680
	speed: 0.0024s/iter; left time: 8.3100s
	iters: 300, epoch: 2 | loss: 0.8667800
	speed: 0.0026s/iter; left time: 8.6928s
	iters: 400, epoch: 2 | loss: 0.6941574
	speed: 0.0025s/iter; left time: 8.1123s
	iters: 500, epoch: 2 | loss: 0.8391024
	speed: 0.0025s/iter; left time: 7.6166s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.3672 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 1.3368489742279053
Epoch: 2, Steps: 514 | Train Loss: 0.8492563 Vali Loss: 0.3636495 Best vali loss: 0.3636495
	iters: 100, epoch: 3 | loss: 1.2680072
	speed: 0.0059s/iter; left time: 17.7041s
	iters: 200, epoch: 3 | loss: 0.2880032
	speed: 0.0026s/iter; left time: 7.4472s
	iters: 300, epoch: 3 | loss: 1.2855639
	speed: 0.0024s/iter; left time: 6.6076s
	iters: 400, epoch: 3 | loss: 0.8445731
	speed: 0.0025s/iter; left time: 6.5894s
	iters: 500, epoch: 3 | loss: 0.5654079
	speed: 0.0024s/iter; left time: 6.2845s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 1.2950105667114258
Epoch: 3, Steps: 514 | Train Loss: 0.8503111 Vali Loss: 0.3648582 Best vali loss: 0.3636495

best validation loss 0.36364952515525295

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2452787
	speed: 0.0088s/iter; left time: 21.7900s
	iters: 200, epoch: 4 | loss: 0.7693775
	speed: 0.0025s/iter; left time: 5.9845s
	iters: 300, epoch: 4 | loss: 0.4934832
	speed: 0.0025s/iter; left time: 5.7021s
	iters: 400, epoch: 4 | loss: 0.3568641
	speed: 0.0025s/iter; left time: 5.4231s
	iters: 500, epoch: 4 | loss: 0.5894867
	speed: 0.0025s/iter; left time: 5.1668s
Updating learning rate to 0.000156545040475
Epoch: 4 cost time: 1.653562307357788
Epoch: 4, Steps: 514 | Train Loss: 0.4908980 Vali Loss: 0.3682601 Best vali loss: 0.3636495
	iters: 100, epoch: 5 | loss: 0.5026993
	speed: 0.0062s/iter; left time: 12.0958s
	iters: 200, epoch: 5 | loss: 1.2529953
	speed: 0.0025s/iter; left time: 4.7192s
	iters: 300, epoch: 5 | loss: 0.8237701
	speed: 0.0025s/iter; left time: 4.3428s
	iters: 400, epoch: 5 | loss: 0.6945348
	speed: 0.0025s/iter; left time: 4.0926s
	iters: 500, epoch: 5 | loss: 0.6349218
	speed: 0.0025s/iter; left time: 3.8487s
Updating learning rate to 7.82725202375e-05
Epoch: 5 cost time: 1.3237929344177246
Epoch: 5, Steps: 514 | Train Loss: 0.7817842 Vali Loss: 0.3695536 Best vali loss: 0.3636495
	iters: 100, epoch: 6 | loss: 1.1246341
	speed: 0.0062s/iter; left time: 8.9817s
	iters: 200, epoch: 6 | loss: 0.2891332
	speed: 0.0025s/iter; left time: 3.3342s
	iters: 300, epoch: 6 | loss: 1.1740123
	speed: 0.0025s/iter; left time: 3.1607s
	iters: 400, epoch: 6 | loss: 0.8057103
	speed: 0.0026s/iter; left time: 2.9284s
	iters: 500, epoch: 6 | loss: 0.5726145
	speed: 0.0026s/iter; left time: 2.6648s
Updating learning rate to 3.913626011875e-05
Epoch: 6 cost time: 1.346388339996338
Epoch: 6, Steps: 514 | Train Loss: 0.7932209 Vali Loss: 0.3711204 Best vali loss: 0.3636495
	iters: 100, epoch: 7 | loss: 0.2969731
	speed: 0.0061s/iter; left time: 5.6836s
	iters: 200, epoch: 7 | loss: 0.2939810
	speed: 0.0025s/iter; left time: 2.0715s
	iters: 300, epoch: 7 | loss: 0.4353660
	speed: 0.0025s/iter; left time: 1.8226s
	iters: 400, epoch: 7 | loss: 0.5772840
	speed: 0.0025s/iter; left time: 1.5720s
	iters: 500, epoch: 7 | loss: 0.3148163
	speed: 0.0025s/iter; left time: 1.3305s
Updating learning rate to 1.9568130059375e-05
Epoch: 7 cost time: 1.3336973190307617
Epoch: 7, Steps: 514 | Train Loss: 0.3836841 Vali Loss: 0.3726864 Best vali loss: 0.3636495
	iters: 100, epoch: 8 | loss: 0.6436383
	speed: 0.0061s/iter; left time: 2.5367s
	iters: 200, epoch: 8 | loss: 1.0809067
	speed: 0.0025s/iter; left time: 0.7976s
	iters: 300, epoch: 8 | loss: 0.5487865
	speed: 0.0025s/iter; left time: 0.5394s
	iters: 400, epoch: 8 | loss: 0.7467718
	speed: 0.0025s/iter; left time: 0.2869s
	iters: 500, epoch: 8 | loss: 0.7328490
	speed: 0.0025s/iter; left time: 0.0380s
Updating learning rate to 9.7840650296875e-06
Epoch: 8 cost time: 1.3392045497894287
Epoch: 8, Steps: 514 | Train Loss: 0.7505905 Vali Loss: 0.3728229 Best vali loss: 0.3636495

best validation loss 0.36364952515525295

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5301326
	speed: 0.0094s/iter; left time: 75.9990s
	iters: 200, epoch: 1 | loss: 0.4180470
	speed: 0.0033s/iter; left time: 26.7840s
	iters: 300, epoch: 1 | loss: 0.7165777
	speed: 0.0034s/iter; left time: 26.5491s
	iters: 400, epoch: 1 | loss: 0.2871627
	speed: 0.0033s/iter; left time: 25.9516s
	iters: 500, epoch: 1 | loss: 0.9146149
	speed: 0.0034s/iter; left time: 25.9502s
	iters: 600, epoch: 1 | loss: 0.6754029
	speed: 0.0033s/iter; left time: 25.4094s
	iters: 700, epoch: 1 | loss: 0.1718548
	speed: 0.0034s/iter; left time: 25.2613s
	iters: 800, epoch: 1 | loss: 0.7571210
	speed: 0.0032s/iter; left time: 23.9494s
	iters: 900, epoch: 1 | loss: 0.3375502
	speed: 0.0033s/iter; left time: 24.1744s
	iters: 1000, epoch: 1 | loss: 1.3005253
	speed: 0.0033s/iter; left time: 23.9468s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.3765).  Saving model state dict ...
Epoch: 1 cost time: 3.755746841430664
Epoch: 1, Steps: 1027 | Train Loss: 0.6108989 Vali Loss: 0.3764653 Best vali loss: 0.3764653
	iters: 100, epoch: 2 | loss: 0.3466097
	speed: 0.0096s/iter; left time: 68.0026s
	iters: 200, epoch: 2 | loss: 0.2458636
	speed: 0.0032s/iter; left time: 22.3840s
	iters: 300, epoch: 2 | loss: 1.7885171
	speed: 0.0032s/iter; left time: 22.0691s
	iters: 400, epoch: 2 | loss: 1.0302646
	speed: 0.0032s/iter; left time: 21.6235s
	iters: 500, epoch: 2 | loss: 1.1654333
	speed: 0.0032s/iter; left time: 21.5453s
	iters: 600, epoch: 2 | loss: 0.7348933
	speed: 0.0032s/iter; left time: 20.9974s
	iters: 700, epoch: 2 | loss: 0.4921664
	speed: 0.0032s/iter; left time: 20.6916s
	iters: 800, epoch: 2 | loss: 0.7793359
	speed: 0.0032s/iter; left time: 20.1431s
	iters: 900, epoch: 2 | loss: 0.2373249
	speed: 0.0030s/iter; left time: 18.9526s
	iters: 1000, epoch: 2 | loss: 0.3272634
	speed: 0.0031s/iter; left time: 19.0118s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.3765 --> 0.3760).  Saving model state dict ...
Epoch: 2 cost time: 3.285503625869751
Epoch: 2, Steps: 1027 | Train Loss: 0.7147672 Vali Loss: 0.3760287 Best vali loss: 0.3760287
	iters: 100, epoch: 3 | loss: 0.4825899
	speed: 0.0101s/iter; left time: 61.0905s
	iters: 200, epoch: 3 | loss: 0.2931256
	speed: 0.0035s/iter; left time: 20.8313s
	iters: 300, epoch: 3 | loss: 0.2414007
	speed: 0.0034s/iter; left time: 19.7813s
	iters: 400, epoch: 3 | loss: 0.4242122
	speed: 0.0035s/iter; left time: 20.1657s
	iters: 500, epoch: 3 | loss: 1.0419812
	speed: 0.0036s/iter; left time: 20.3492s
	iters: 600, epoch: 3 | loss: 0.9210929
	speed: 0.0035s/iter; left time: 19.2626s
	iters: 700, epoch: 3 | loss: 0.2581460
	speed: 0.0034s/iter; left time: 18.7225s
	iters: 800, epoch: 3 | loss: 0.4138616
	speed: 0.0034s/iter; left time: 18.1957s
	iters: 900, epoch: 3 | loss: 0.7937434
	speed: 0.0035s/iter; left time: 18.1671s
	iters: 1000, epoch: 3 | loss: 0.5087081
	speed: 0.0035s/iter; left time: 17.8744s
Updating learning rate to 0.0001037776569
Epoch: 3 cost time: 3.612523317337036
Epoch: 3, Steps: 1027 | Train Loss: 0.5378862 Vali Loss: 0.3855379 Best vali loss: 0.3760287
	iters: 100, epoch: 4 | loss: 0.2839282
	speed: 0.0102s/iter; left time: 51.5689s
	iters: 200, epoch: 4 | loss: 0.3667979
	speed: 0.0034s/iter; left time: 16.7965s
	iters: 300, epoch: 4 | loss: 0.2551000
	speed: 0.0035s/iter; left time: 16.8710s
	iters: 400, epoch: 4 | loss: 0.2847001
	speed: 0.0035s/iter; left time: 16.4176s
	iters: 500, epoch: 4 | loss: 0.2712222
	speed: 0.0033s/iter; left time: 15.4416s
	iters: 600, epoch: 4 | loss: 0.3426622
	speed: 0.0033s/iter; left time: 15.1340s
	iters: 700, epoch: 4 | loss: 0.5791367
	speed: 0.0034s/iter; left time: 15.2613s
	iters: 800, epoch: 4 | loss: 0.5064995
	speed: 0.0036s/iter; left time: 15.5473s
	iters: 900, epoch: 4 | loss: 0.3936474
	speed: 0.0036s/iter; left time: 15.2749s
	iters: 1000, epoch: 4 | loss: 0.7860591
	speed: 0.0034s/iter; left time: 14.2519s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 3.5985333919525146
Epoch: 4, Steps: 1027 | Train Loss: 0.4069753 Vali Loss: 0.3837079 Best vali loss: 0.3760287
	iters: 100, epoch: 5 | loss: 0.4595915
	speed: 0.0107s/iter; left time: 43.0338s
	iters: 200, epoch: 5 | loss: 0.4803152
	speed: 0.0035s/iter; left time: 13.5289s
	iters: 300, epoch: 5 | loss: 0.9132821
	speed: 0.0034s/iter; left time: 13.0900s
	iters: 400, epoch: 5 | loss: 0.7498216
	speed: 0.0034s/iter; left time: 12.6573s
	iters: 500, epoch: 5 | loss: 0.9021416
	speed: 0.0033s/iter; left time: 12.0628s
	iters: 600, epoch: 5 | loss: 0.7919124
	speed: 0.0033s/iter; left time: 11.7078s
	iters: 700, epoch: 5 | loss: 0.4241062
	speed: 0.0033s/iter; left time: 11.3904s
	iters: 800, epoch: 5 | loss: 0.2594057
	speed: 0.0034s/iter; left time: 11.1175s
	iters: 900, epoch: 5 | loss: 0.6153988
	speed: 0.0033s/iter; left time: 10.6543s
	iters: 1000, epoch: 5 | loss: 0.8038557
	speed: 0.0032s/iter; left time: 9.9126s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 3.513576030731201
Epoch: 5, Steps: 1027 | Train Loss: 0.6399831 Vali Loss: 0.3950260 Best vali loss: 0.3760287
	iters: 100, epoch: 6 | loss: 0.8212482
	speed: 0.0097s/iter; left time: 28.8993s
	iters: 200, epoch: 6 | loss: 0.6060145
	speed: 0.0032s/iter; left time: 9.1697s
	iters: 300, epoch: 6 | loss: 0.3479878
	speed: 0.0032s/iter; left time: 8.8628s
	iters: 400, epoch: 6 | loss: 0.2152884
	speed: 0.0033s/iter; left time: 8.8499s
	iters: 500, epoch: 6 | loss: 0.6313205
	speed: 0.0033s/iter; left time: 8.5763s
	iters: 600, epoch: 6 | loss: 0.2703547
	speed: 0.0031s/iter; left time: 7.7909s
	iters: 700, epoch: 6 | loss: 0.5011699
	speed: 0.0032s/iter; left time: 7.5172s
	iters: 800, epoch: 6 | loss: 0.3059978
	speed: 0.0032s/iter; left time: 7.3631s
	iters: 900, epoch: 6 | loss: 0.3498401
	speed: 0.0034s/iter; left time: 7.3810s
	iters: 1000, epoch: 6 | loss: 0.3981204
	speed: 0.0031s/iter; left time: 6.5542s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 3.34330677986145
Epoch: 6, Steps: 1027 | Train Loss: 0.4447342 Vali Loss: 0.4030277 Best vali loss: 0.3760287
	iters: 100, epoch: 7 | loss: 0.7132727
	speed: 0.0093s/iter; left time: 18.1437s
	iters: 200, epoch: 7 | loss: 0.3380977
	speed: 0.0031s/iter; left time: 5.6659s
	iters: 300, epoch: 7 | loss: 0.4400323
	speed: 0.0029s/iter; left time: 5.1660s
	iters: 400, epoch: 7 | loss: 0.2594769
	speed: 0.0030s/iter; left time: 4.9282s
	iters: 500, epoch: 7 | loss: 0.7094954
	speed: 0.0030s/iter; left time: 4.6020s
	iters: 600, epoch: 7 | loss: 0.3897699
	speed: 0.0030s/iter; left time: 4.3336s
	iters: 700, epoch: 7 | loss: 1.6187750
	speed: 0.0030s/iter; left time: 4.1104s
	iters: 800, epoch: 7 | loss: 0.7244637
	speed: 0.0032s/iter; left time: 3.9781s
	iters: 900, epoch: 7 | loss: 0.2086326
	speed: 0.0034s/iter; left time: 3.8720s
	iters: 1000, epoch: 7 | loss: 0.2978450
	speed: 0.0033s/iter; left time: 3.5158s
Updating learning rate to 6.48610355625e-06
Epoch: 7 cost time: 3.217923879623413
Epoch: 7, Steps: 1027 | Train Loss: 0.5699861 Vali Loss: 0.4002005 Best vali loss: 0.3760287
	iters: 100, epoch: 8 | loss: 0.1822302
	speed: 0.0097s/iter; left time: 8.9817s
	iters: 200, epoch: 8 | loss: 0.2665128
	speed: 0.0033s/iter; left time: 2.7356s
	iters: 300, epoch: 8 | loss: 0.2899705
	speed: 0.0033s/iter; left time: 2.3882s
	iters: 400, epoch: 8 | loss: 0.1998803
	speed: 0.0033s/iter; left time: 2.0684s
	iters: 500, epoch: 8 | loss: 0.2429233
	speed: 0.0033s/iter; left time: 1.7318s
	iters: 600, epoch: 8 | loss: 1.0040686
	speed: 0.0033s/iter; left time: 1.3997s
	iters: 700, epoch: 8 | loss: 0.4080644
	speed: 0.0033s/iter; left time: 1.0833s
	iters: 800, epoch: 8 | loss: 0.5790008
	speed: 0.0033s/iter; left time: 0.7573s
	iters: 900, epoch: 8 | loss: 0.3374822
	speed: 0.0033s/iter; left time: 0.4284s
	iters: 1000, epoch: 8 | loss: 0.3774130
	speed: 0.0033s/iter; left time: 0.0931s
Updating learning rate to 3.243051778125e-06
Epoch: 8 cost time: 3.431609630584717
Epoch: 8, Steps: 1027 | Train Loss: 0.3887546 Vali Loss: 0.4030947 Best vali loss: 0.3760287

best validation loss 0.37602866691315806

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.9014179
	speed: 0.0091s/iter; left time: 74.1259s
	iters: 200, epoch: 1 | loss: 0.4689494
	speed: 0.0031s/iter; left time: 24.8004s
	iters: 300, epoch: 1 | loss: 0.2975619
	speed: 0.0031s/iter; left time: 24.2052s
	iters: 400, epoch: 1 | loss: 1.3002354
	speed: 0.0030s/iter; left time: 23.8026s
	iters: 500, epoch: 1 | loss: 0.2597705
	speed: 0.0031s/iter; left time: 23.5702s
	iters: 600, epoch: 1 | loss: 0.3287959
	speed: 0.0031s/iter; left time: 23.3132s
	iters: 700, epoch: 1 | loss: 0.4474066
	speed: 0.0031s/iter; left time: 23.3209s
	iters: 800, epoch: 1 | loss: 0.5934463
	speed: 0.0032s/iter; left time: 23.5138s
	iters: 900, epoch: 1 | loss: 1.9942493
	speed: 0.0031s/iter; left time: 22.8189s
	iters: 1000, epoch: 1 | loss: 0.7791952
	speed: 0.0031s/iter; left time: 22.4175s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.4014).  Saving model state dict ...
Epoch: 1 cost time: 3.51843523979187
Epoch: 1, Steps: 1027 | Train Loss: 0.8371028 Vali Loss: 0.4014011 Best vali loss: 0.4014011
	iters: 100, epoch: 2 | loss: 0.3238855
	speed: 0.0093s/iter; left time: 65.8409s
	iters: 200, epoch: 2 | loss: 0.3024031
	speed: 0.0030s/iter; left time: 21.2354s
	iters: 300, epoch: 2 | loss: 0.3176836
	speed: 0.0031s/iter; left time: 21.1277s
	iters: 400, epoch: 2 | loss: 0.5701150
	speed: 0.0031s/iter; left time: 20.8871s
	iters: 500, epoch: 2 | loss: 1.1507250
	speed: 0.0031s/iter; left time: 20.4738s
	iters: 600, epoch: 2 | loss: 1.0105882
	speed: 0.0031s/iter; left time: 20.2247s
	iters: 700, epoch: 2 | loss: 0.1780438
	speed: 0.0031s/iter; left time: 20.1176s
	iters: 800, epoch: 2 | loss: 0.3518046
	speed: 0.0031s/iter; left time: 19.5574s
	iters: 900, epoch: 2 | loss: 1.0883269
	speed: 0.0031s/iter; left time: 19.7412s
	iters: 1000, epoch: 2 | loss: 1.2791345
	speed: 0.0031s/iter; left time: 18.9405s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.4014 --> 0.3817).  Saving model state dict ...
Epoch: 2 cost time: 3.2049803733825684
Epoch: 2, Steps: 1027 | Train Loss: 0.6572710 Vali Loss: 0.3816619 Best vali loss: 0.3816619
	iters: 100, epoch: 3 | loss: 0.7573805
	speed: 0.0092s/iter; left time: 55.6495s
	iters: 200, epoch: 3 | loss: 0.9434662
	speed: 0.0030s/iter; left time: 17.6738s
	iters: 300, epoch: 3 | loss: 0.4908536
	speed: 0.0030s/iter; left time: 17.5718s
	iters: 400, epoch: 3 | loss: 0.3615046
	speed: 0.0032s/iter; left time: 18.3234s
	iters: 500, epoch: 3 | loss: 0.5968053
	speed: 0.0032s/iter; left time: 18.1101s
	iters: 600, epoch: 3 | loss: 0.7896298
	speed: 0.0029s/iter; left time: 16.1311s
	iters: 700, epoch: 3 | loss: 0.3891562
	speed: 0.0029s/iter; left time: 15.6136s
	iters: 800, epoch: 3 | loss: 1.0311347
	speed: 0.0030s/iter; left time: 15.9204s
	iters: 900, epoch: 3 | loss: 0.2332916
	speed: 0.0028s/iter; left time: 14.9540s
	iters: 1000, epoch: 3 | loss: 0.3569332
	speed: 0.0028s/iter; left time: 14.6048s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.3817 --> 0.3764).  Saving model state dict ...
Epoch: 3 cost time: 3.0860955715179443
Epoch: 3, Steps: 1027 | Train Loss: 0.5950156 Vali Loss: 0.3764116 Best vali loss: 0.3764116
	iters: 100, epoch: 4 | loss: 1.2880220
	speed: 0.0090s/iter; left time: 45.2035s
	iters: 200, epoch: 4 | loss: 0.4299869
	speed: 0.0029s/iter; left time: 14.1848s
	iters: 300, epoch: 4 | loss: 0.3963694
	speed: 0.0029s/iter; left time: 13.9922s
	iters: 400, epoch: 4 | loss: 0.5317436
	speed: 0.0029s/iter; left time: 13.7941s
	iters: 500, epoch: 4 | loss: 0.4568851
	speed: 0.0030s/iter; left time: 14.0142s
	iters: 600, epoch: 4 | loss: 0.3405222
	speed: 0.0031s/iter; left time: 14.1841s
	iters: 700, epoch: 4 | loss: 2.0393794
	speed: 0.0030s/iter; left time: 13.2729s
	iters: 800, epoch: 4 | loss: 0.2594257
	speed: 0.0031s/iter; left time: 13.6565s
	iters: 900, epoch: 4 | loss: 0.7720125
	speed: 0.0030s/iter; left time: 12.7530s
	iters: 1000, epoch: 4 | loss: 0.4996543
	speed: 0.0031s/iter; left time: 12.6933s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.3764 --> 0.3745).  Saving model state dict ...
Epoch: 4 cost time: 3.135627508163452
Epoch: 4, Steps: 1027 | Train Loss: 0.7014001 Vali Loss: 0.3744531 Best vali loss: 0.3744531
	iters: 100, epoch: 5 | loss: 0.3271376
	speed: 0.0089s/iter; left time: 35.8091s
	iters: 200, epoch: 5 | loss: 0.6258717
	speed: 0.0033s/iter; left time: 12.7340s
	iters: 300, epoch: 5 | loss: 1.0759034
	speed: 0.0033s/iter; left time: 12.4183s
	iters: 400, epoch: 5 | loss: 0.4114005
	speed: 0.0032s/iter; left time: 11.9243s
	iters: 500, epoch: 5 | loss: 1.0933108
	speed: 0.0032s/iter; left time: 11.7107s
	iters: 600, epoch: 5 | loss: 0.4943643
	speed: 0.0033s/iter; left time: 11.4567s
	iters: 700, epoch: 5 | loss: 0.5815957
	speed: 0.0033s/iter; left time: 11.1051s
	iters: 800, epoch: 5 | loss: 0.2634765
	speed: 0.0032s/iter; left time: 10.6620s
	iters: 900, epoch: 5 | loss: 0.9513896
	speed: 0.0032s/iter; left time: 10.3049s
	iters: 1000, epoch: 5 | loss: 0.9183129
	speed: 0.0032s/iter; left time: 9.9135s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.3745 --> 0.3735).  Saving model state dict ...
Epoch: 5 cost time: 3.3584165573120117
Epoch: 5, Steps: 1027 | Train Loss: 0.6742763 Vali Loss: 0.3735059 Best vali loss: 0.3735059
	iters: 100, epoch: 6 | loss: 0.2872109
	speed: 0.0091s/iter; left time: 27.2447s
	iters: 200, epoch: 6 | loss: 0.2538311
	speed: 0.0032s/iter; left time: 9.2295s
	iters: 300, epoch: 6 | loss: 0.3664609
	speed: 0.0032s/iter; left time: 8.9112s
	iters: 400, epoch: 6 | loss: 0.9046010
	speed: 0.0032s/iter; left time: 8.6710s
	iters: 500, epoch: 6 | loss: 0.3750379
	speed: 0.0032s/iter; left time: 8.1410s
	iters: 600, epoch: 6 | loss: 0.7217267
	speed: 0.0032s/iter; left time: 8.0463s
	iters: 700, epoch: 6 | loss: 0.3392204
	speed: 0.0033s/iter; left time: 7.8696s
	iters: 800, epoch: 6 | loss: 0.3781672
	speed: 0.0033s/iter; left time: 7.5013s
	iters: 900, epoch: 6 | loss: 0.9575027
	speed: 0.0033s/iter; left time: 7.2839s
	iters: 1000, epoch: 6 | loss: 0.3017126
	speed: 0.0033s/iter; left time: 6.9181s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.3735 --> 0.3731).  Saving model state dict ...
Epoch: 6 cost time: 3.374190092086792
Epoch: 6, Steps: 1027 | Train Loss: 0.4885471 Vali Loss: 0.3730758 Best vali loss: 0.3730758
	iters: 100, epoch: 7 | loss: 0.9070683
	speed: 0.0095s/iter; left time: 18.5477s
	iters: 200, epoch: 7 | loss: 1.0415761
	speed: 0.0032s/iter; left time: 6.0176s
	iters: 300, epoch: 7 | loss: 1.2115818
	speed: 0.0033s/iter; left time: 5.8446s
	iters: 400, epoch: 7 | loss: 0.6653162
	speed: 0.0033s/iter; left time: 5.5233s
	iters: 500, epoch: 7 | loss: 0.2522137
	speed: 0.0033s/iter; left time: 5.1667s
	iters: 600, epoch: 7 | loss: 0.3919451
	speed: 0.0033s/iter; left time: 4.8168s
	iters: 700, epoch: 7 | loss: 0.7954778
	speed: 0.0034s/iter; left time: 4.5707s
	iters: 800, epoch: 7 | loss: 0.2404069
	speed: 0.0033s/iter; left time: 4.1256s
	iters: 900, epoch: 7 | loss: 0.4435699
	speed: 0.0033s/iter; left time: 3.7755s
	iters: 1000, epoch: 7 | loss: 1.1506063
	speed: 0.0032s/iter; left time: 3.4081s
Updating learning rate to 1.0771095203125e-06
Validation loss decreased (0.3731 --> 0.3729).  Saving model state dict ...
Epoch: 7 cost time: 3.419144868850708
Epoch: 7, Steps: 1027 | Train Loss: 0.7099762 Vali Loss: 0.3728614 Best vali loss: 0.3728614
	iters: 100, epoch: 8 | loss: 1.2340311
	speed: 0.0092s/iter; left time: 8.5275s
	iters: 200, epoch: 8 | loss: 0.3943516
	speed: 0.0033s/iter; left time: 2.6922s
	iters: 300, epoch: 8 | loss: 0.9493433
	speed: 0.0033s/iter; left time: 2.4023s
	iters: 400, epoch: 8 | loss: 0.6920303
	speed: 0.0033s/iter; left time: 2.0449s
	iters: 500, epoch: 8 | loss: 0.8837016
	speed: 0.0032s/iter; left time: 1.7077s
	iters: 600, epoch: 8 | loss: 0.4074333
	speed: 0.0033s/iter; left time: 1.4012s
	iters: 700, epoch: 8 | loss: 1.1081464
	speed: 0.0032s/iter; left time: 1.0623s
	iters: 800, epoch: 8 | loss: 0.3305808
	speed: 0.0032s/iter; left time: 0.7378s
	iters: 900, epoch: 8 | loss: 1.3081526
	speed: 0.0031s/iter; left time: 0.4020s
	iters: 1000, epoch: 8 | loss: 0.3173450
	speed: 0.0031s/iter; left time: 0.0869s
Updating learning rate to 5.3855476015625e-07
Validation loss decreased (0.3729 --> 0.3728).  Saving model state dict ...
Epoch: 8 cost time: 3.361912250518799
Epoch: 8, Steps: 1027 | Train Loss: 0.7625116 Vali Loss: 0.3727571 Best vali loss: 0.3727571

best validation loss 0.3727570605769841

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6938074
	speed: 0.0114s/iter; left time: 10.6632s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.3972).  Saving model state dict ...
Epoch: 1 cost time: 1.0395565032958984
Epoch: 1, Steps: 129 | Train Loss: 0.6938074 Vali Loss: 0.3971701 Best vali loss: 0.3971701
	iters: 100, epoch: 2 | loss: 0.8684182
	speed: 0.0091s/iter; left time: 7.3366s
Updating learning rate to 0.0019699025932
Epoch: 2 cost time: 0.7518830299377441
Epoch: 2, Steps: 129 | Train Loss: 0.8684182 Vali Loss: 0.4041235 Best vali loss: 0.3971701
	iters: 100, epoch: 3 | loss: 0.5651046
	speed: 0.0092s/iter; left time: 6.1999s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 0.7501037120819092
Epoch: 3, Steps: 129 | Train Loss: 0.5651046 Vali Loss: 0.4021665 Best vali loss: 0.3971701

best validation loss 0.3971700550296686

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3494675
	speed: 0.0105s/iter; left time: 42.0001s
	iters: 200, epoch: 1 | loss: 0.5890211
	speed: 0.0041s/iter; left time: 16.0196s
	iters: 300, epoch: 1 | loss: 0.3003992
	speed: 0.0043s/iter; left time: 16.2507s
	iters: 400, epoch: 1 | loss: 0.4491776
	speed: 0.0041s/iter; left time: 15.3590s
	iters: 500, epoch: 1 | loss: 0.7530859
	speed: 0.0045s/iter; left time: 16.1451s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 2.5389251708984375
Epoch: 1, Steps: 514 | Train Loss: 0.4882303 Vali Loss: 0.3740091 Best vali loss: 0.3740091
	iters: 100, epoch: 2 | loss: 0.3281638
	speed: 0.0095s/iter; left time: 33.2682s
	iters: 200, epoch: 2 | loss: 0.6362269
	speed: 0.0044s/iter; left time: 15.0457s
	iters: 300, epoch: 2 | loss: 0.4619468
	speed: 0.0043s/iter; left time: 14.1838s
	iters: 400, epoch: 2 | loss: 0.4293118
	speed: 0.0042s/iter; left time: 13.3279s
	iters: 500, epoch: 2 | loss: 0.2498732
	speed: 0.0039s/iter; left time: 12.2354s
Updating learning rate to 0.000552421030539641
Validation loss decreased (0.3740 --> 0.3731).  Saving model state dict ...
Epoch: 2 cost time: 2.2638630867004395
Epoch: 2, Steps: 514 | Train Loss: 0.4211045 Vali Loss: 0.3731184 Best vali loss: 0.3731184
	iters: 100, epoch: 3 | loss: 0.4014956
	speed: 0.0091s/iter; left time: 27.0294s
	iters: 200, epoch: 3 | loss: 0.2628505
	speed: 0.0044s/iter; left time: 12.7921s
	iters: 300, epoch: 3 | loss: 0.5082021
	speed: 0.0045s/iter; left time: 12.4576s
	iters: 400, epoch: 3 | loss: 0.3664423
	speed: 0.0044s/iter; left time: 11.8053s
	iters: 500, epoch: 3 | loss: 0.5797946
	speed: 0.0044s/iter; left time: 11.4719s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.3731 --> 0.3585).  Saving model state dict ...
Epoch: 3 cost time: 2.3332722187042236
Epoch: 3, Steps: 514 | Train Loss: 0.4237570 Vali Loss: 0.3584511 Best vali loss: 0.3584511

best validation loss 0.3584511080811675

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4901839
	speed: 0.0084s/iter; left time: 33.6890s
	iters: 200, epoch: 1 | loss: 0.8486854
	speed: 0.0024s/iter; left time: 9.3602s
	iters: 300, epoch: 1 | loss: 0.3823224
	speed: 0.0026s/iter; left time: 9.8249s
	iters: 400, epoch: 1 | loss: 1.3246905
	speed: 0.0027s/iter; left time: 10.0442s
	iters: 500, epoch: 1 | loss: 0.6420366
	speed: 0.0027s/iter; left time: 9.8895s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 1.658916711807251
Epoch: 1, Steps: 514 | Train Loss: 0.7375838 Vali Loss: 0.3736785 Best vali loss: 0.3736785
	iters: 100, epoch: 2 | loss: 0.6495699
	speed: 0.0062s/iter; left time: 21.7047s
	iters: 200, epoch: 2 | loss: 0.4079169
	speed: 0.0024s/iter; left time: 8.0473s
	iters: 300, epoch: 2 | loss: 1.2743857
	speed: 0.0023s/iter; left time: 7.7507s
	iters: 400, epoch: 2 | loss: 0.8147041
	speed: 0.0023s/iter; left time: 7.4563s
	iters: 500, epoch: 2 | loss: 0.7145113
	speed: 0.0023s/iter; left time: 7.2313s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.3737 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 1.2570042610168457
Epoch: 2, Steps: 514 | Train Loss: 0.7722176 Vali Loss: 0.3667511 Best vali loss: 0.3667511
	iters: 100, epoch: 3 | loss: 1.3977678
	speed: 0.0060s/iter; left time: 17.8349s
	iters: 200, epoch: 3 | loss: 0.3803981
	speed: 0.0024s/iter; left time: 6.9188s
	iters: 300, epoch: 3 | loss: 0.3145308
	speed: 0.0025s/iter; left time: 6.8896s
	iters: 400, epoch: 3 | loss: 0.6522948
	speed: 0.0023s/iter; left time: 6.2754s
	iters: 500, epoch: 3 | loss: 0.5425127
	speed: 0.0025s/iter; left time: 6.3388s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 1.2843449115753174
Epoch: 3, Steps: 514 | Train Loss: 0.6575008 Vali Loss: 0.3682644 Best vali loss: 0.3667511

best validation loss 0.36675108191072353

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3337228
	speed: 0.0106s/iter; left time: 26.2069s
	iters: 200, epoch: 4 | loss: 0.5757033
	speed: 0.0042s/iter; left time: 9.9532s
	iters: 300, epoch: 4 | loss: 0.2973703
	speed: 0.0041s/iter; left time: 9.3167s
	iters: 400, epoch: 4 | loss: 0.3838448
	speed: 0.0045s/iter; left time: 9.8210s
	iters: 500, epoch: 4 | loss: 0.4908914
	speed: 0.0043s/iter; left time: 8.9712s
Updating learning rate to 0.00032360074755
Validation loss decreased (0.3585 --> 0.3525).  Saving model state dict ...
Epoch: 4 cost time: 2.5636889934539795
Epoch: 4, Steps: 514 | Train Loss: 0.4163065 Vali Loss: 0.3524542 Best vali loss: 0.3524542
	iters: 100, epoch: 5 | loss: 0.2583498
	speed: 0.0096s/iter; left time: 18.7908s
	iters: 200, epoch: 5 | loss: 0.5295441
	speed: 0.0049s/iter; left time: 9.0724s
	iters: 300, epoch: 5 | loss: 0.4499626
	speed: 0.0050s/iter; left time: 8.7261s
	iters: 400, epoch: 5 | loss: 0.4002977
	speed: 0.0044s/iter; left time: 7.2853s
	iters: 500, epoch: 5 | loss: 0.2355738
	speed: 0.0044s/iter; left time: 6.8119s
Updating learning rate to 0.0001997641027616571
Validation loss decreased (0.3525 --> 0.3518).  Saving model state dict ...
Epoch: 5 cost time: 2.479701042175293
Epoch: 5, Steps: 514 | Train Loss: 0.3747456 Vali Loss: 0.3517639 Best vali loss: 0.3517639
	iters: 100, epoch: 6 | loss: 0.3747544
	speed: 0.0089s/iter; left time: 12.7933s
	iters: 200, epoch: 6 | loss: 0.2470379
	speed: 0.0044s/iter; left time: 5.9611s
	iters: 300, epoch: 6 | loss: 0.4524020
	speed: 0.0041s/iter; left time: 5.1175s
	iters: 400, epoch: 6 | loss: 0.3306900
	speed: 0.0041s/iter; left time: 4.6411s
	iters: 500, epoch: 6 | loss: 0.5551918
	speed: 0.0042s/iter; left time: 4.3805s
Updating learning rate to 9.478046456035896e-05
Validation loss decreased (0.3518 --> 0.3516).  Saving model state dict ...
Epoch: 6 cost time: 2.216226100921631
Epoch: 6, Steps: 514 | Train Loss: 0.3920152 Vali Loss: 0.3516341 Best vali loss: 0.3516341
	iters: 100, epoch: 7 | loss: 0.2850619
	speed: 0.0088s/iter; left time: 8.1914s
	iters: 200, epoch: 7 | loss: 0.2790491
	speed: 0.0045s/iter; left time: 3.6974s
	iters: 300, epoch: 7 | loss: 0.7391962
	speed: 0.0046s/iter; left time: 3.3206s
	iters: 400, epoch: 7 | loss: 0.7314611
	speed: 0.0043s/iter; left time: 2.6927s
	iters: 500, epoch: 7 | loss: 0.4296024
	speed: 0.0041s/iter; left time: 2.1796s
Updating learning rate to 2.463264018320308e-05
Epoch: 7 cost time: 2.2898685932159424
Epoch: 7, Steps: 514 | Train Loss: 0.4928742 Vali Loss: 0.3617338 Best vali loss: 0.3516341
	iters: 100, epoch: 8 | loss: 0.3328745
	speed: 0.0094s/iter; left time: 3.9048s
	iters: 200, epoch: 8 | loss: 0.4522033
	speed: 0.0046s/iter; left time: 1.4469s
	iters: 300, epoch: 8 | loss: 0.3278976
	speed: 0.0043s/iter; left time: 0.9155s
	iters: 400, epoch: 8 | loss: 0.6866552
	speed: 0.0043s/iter; left time: 0.4928s
	iters: 500, epoch: 8 | loss: 0.4850006
	speed: 0.0044s/iter; left time: 0.0660s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.365102529525757
Epoch: 8, Steps: 514 | Train Loss: 0.4569263 Vali Loss: 0.3604385 Best vali loss: 0.3516341

best validation loss 0.3516340756755915

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4864928
	speed: 0.0098s/iter; left time: 79.6235s
	iters: 200, epoch: 1 | loss: 0.5110324
	speed: 0.0040s/iter; left time: 32.0058s
	iters: 300, epoch: 1 | loss: 0.8384854
	speed: 0.0043s/iter; left time: 34.3433s
	iters: 400, epoch: 1 | loss: 1.0017203
	speed: 0.0042s/iter; left time: 33.1369s
	iters: 500, epoch: 1 | loss: 0.4773507
	speed: 0.0038s/iter; left time: 29.7073s
	iters: 600, epoch: 1 | loss: 0.3088198
	speed: 0.0040s/iter; left time: 30.1808s
	iters: 700, epoch: 1 | loss: 0.4916834
	speed: 0.0040s/iter; left time: 29.7432s
	iters: 800, epoch: 1 | loss: 0.4059479
	speed: 0.0039s/iter; left time: 29.2970s
	iters: 900, epoch: 1 | loss: 0.5533454
	speed: 0.0039s/iter; left time: 28.8728s
	iters: 1000, epoch: 1 | loss: 1.0382162
	speed: 0.0039s/iter; left time: 28.1028s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.3874).  Saving model state dict ...
Epoch: 1 cost time: 4.454105615615845
Epoch: 1, Steps: 1027 | Train Loss: 0.6113094 Vali Loss: 0.3873548 Best vali loss: 0.3873548
	iters: 100, epoch: 2 | loss: 0.3319648
	speed: 0.0106s/iter; left time: 74.8125s
	iters: 200, epoch: 2 | loss: 1.3051965
	speed: 0.0037s/iter; left time: 25.9297s
	iters: 300, epoch: 2 | loss: 0.3221341
	speed: 0.0037s/iter; left time: 25.3819s
	iters: 400, epoch: 2 | loss: 0.5920969
	speed: 0.0037s/iter; left time: 24.9489s
	iters: 500, epoch: 2 | loss: 0.3167730
	speed: 0.0037s/iter; left time: 24.9051s
	iters: 600, epoch: 2 | loss: 0.3314548
	speed: 0.0037s/iter; left time: 24.5633s
	iters: 700, epoch: 2 | loss: 1.3954936
	speed: 0.0038s/iter; left time: 24.4874s
	iters: 800, epoch: 2 | loss: 0.6261157
	speed: 0.0040s/iter; left time: 25.2501s
	iters: 900, epoch: 2 | loss: 0.5435544
	speed: 0.0040s/iter; left time: 24.9709s
	iters: 1000, epoch: 2 | loss: 0.9575210
	speed: 0.0040s/iter; left time: 24.5677s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.3874 --> 0.3720).  Saving model state dict ...
Epoch: 2 cost time: 3.93765926361084
Epoch: 2, Steps: 1027 | Train Loss: 0.6722305 Vali Loss: 0.3719901 Best vali loss: 0.3719901
	iters: 100, epoch: 3 | loss: 0.6855526
	speed: 0.0107s/iter; left time: 64.8031s
	iters: 200, epoch: 3 | loss: 0.2468599
	speed: 0.0035s/iter; left time: 20.9349s
	iters: 300, epoch: 3 | loss: 0.7266596
	speed: 0.0036s/iter; left time: 20.8962s
	iters: 400, epoch: 3 | loss: 1.4541538
	speed: 0.0036s/iter; left time: 20.7889s
	iters: 500, epoch: 3 | loss: 0.8933533
	speed: 0.0036s/iter; left time: 20.2793s
	iters: 600, epoch: 3 | loss: 0.3017144
	speed: 0.0035s/iter; left time: 19.5501s
	iters: 700, epoch: 3 | loss: 0.9115239
	speed: 0.0038s/iter; left time: 20.8980s
	iters: 800, epoch: 3 | loss: 1.0647771
	speed: 0.0040s/iter; left time: 21.2398s
	iters: 900, epoch: 3 | loss: 0.4963420
	speed: 0.0040s/iter; left time: 21.1078s
	iters: 1000, epoch: 3 | loss: 0.5205220
	speed: 0.0040s/iter; left time: 20.4376s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.3720 --> 0.3675).  Saving model state dict ...
Epoch: 3 cost time: 3.863889455795288
Epoch: 3, Steps: 1027 | Train Loss: 0.7301459 Vali Loss: 0.3675432 Best vali loss: 0.3675432
	iters: 100, epoch: 4 | loss: 1.7197150
	speed: 0.0106s/iter; left time: 53.3799s
	iters: 200, epoch: 4 | loss: 0.1612456
	speed: 0.0040s/iter; left time: 19.5414s
	iters: 300, epoch: 4 | loss: 1.0968767
	speed: 0.0040s/iter; left time: 19.2051s
	iters: 400, epoch: 4 | loss: 0.3886673
	speed: 0.0040s/iter; left time: 18.9431s
	iters: 500, epoch: 4 | loss: 0.2295941
	speed: 0.0042s/iter; left time: 19.3196s
	iters: 600, epoch: 4 | loss: 0.7353494
	speed: 0.0043s/iter; left time: 19.3503s
	iters: 700, epoch: 4 | loss: 0.4834465
	speed: 0.0043s/iter; left time: 19.0286s
	iters: 800, epoch: 4 | loss: 0.7384023
	speed: 0.0043s/iter; left time: 18.5094s
	iters: 900, epoch: 4 | loss: 1.0598139
	speed: 0.0043s/iter; left time: 18.1878s
	iters: 1000, epoch: 4 | loss: 1.0763438
	speed: 0.0043s/iter; left time: 17.7430s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.3675 --> 0.3652).  Saving model state dict ...
Epoch: 4 cost time: 4.288392543792725
Epoch: 4, Steps: 1027 | Train Loss: 0.7689454 Vali Loss: 0.3652388 Best vali loss: 0.3652388
	iters: 100, epoch: 5 | loss: 0.3913019
	speed: 0.0108s/iter; left time: 43.2628s
	iters: 200, epoch: 5 | loss: 1.3388389
	speed: 0.0035s/iter; left time: 13.8497s
	iters: 300, epoch: 5 | loss: 1.1622181
	speed: 0.0035s/iter; left time: 13.4849s
	iters: 400, epoch: 5 | loss: 1.2308866
	speed: 0.0035s/iter; left time: 13.0524s
	iters: 500, epoch: 5 | loss: 0.7188590
	speed: 0.0035s/iter; left time: 12.7425s
	iters: 600, epoch: 5 | loss: 0.2500713
	speed: 0.0035s/iter; left time: 12.4184s
	iters: 700, epoch: 5 | loss: 0.3314284
	speed: 0.0035s/iter; left time: 12.0889s
	iters: 800, epoch: 5 | loss: 0.2855617
	speed: 0.0036s/iter; left time: 11.7799s
	iters: 900, epoch: 5 | loss: 0.3313290
	speed: 0.0035s/iter; left time: 11.2827s
	iters: 1000, epoch: 5 | loss: 0.8996791
	speed: 0.0035s/iter; left time: 10.9179s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.3652 --> 0.3650).  Saving model state dict ...
Epoch: 5 cost time: 3.675960063934326
Epoch: 5, Steps: 1027 | Train Loss: 0.6940174 Vali Loss: 0.3650157 Best vali loss: 0.3650157
	iters: 100, epoch: 6 | loss: 0.2886966
	speed: 0.0109s/iter; left time: 32.4400s
	iters: 200, epoch: 6 | loss: 0.9448199
	speed: 0.0043s/iter; left time: 12.2977s
	iters: 300, epoch: 6 | loss: 0.8981221
	speed: 0.0043s/iter; left time: 11.8265s
	iters: 400, epoch: 6 | loss: 0.5599395
	speed: 0.0042s/iter; left time: 11.3966s
	iters: 500, epoch: 6 | loss: 0.3286976
	speed: 0.0042s/iter; left time: 10.8937s
	iters: 600, epoch: 6 | loss: 0.2950847
	speed: 0.0039s/iter; left time: 9.6700s
	iters: 700, epoch: 6 | loss: 1.1583588
	speed: 0.0038s/iter; left time: 9.0555s
	iters: 800, epoch: 6 | loss: 0.3865790
	speed: 0.0038s/iter; left time: 8.6964s
	iters: 900, epoch: 6 | loss: 1.8030494
	speed: 0.0037s/iter; left time: 8.0705s
	iters: 1000, epoch: 6 | loss: 0.5925674
	speed: 0.0039s/iter; left time: 8.1060s
Updating learning rate to 7.442412677412731e-06
Validation loss decreased (0.3650 --> 0.3647).  Saving model state dict ...
Epoch: 6 cost time: 4.160764932632446
Epoch: 6, Steps: 1027 | Train Loss: 0.7255915 Vali Loss: 0.3647312 Best vali loss: 0.3647312
	iters: 100, epoch: 7 | loss: 0.3763354
	speed: 0.0111s/iter; left time: 21.7206s
	iters: 200, epoch: 7 | loss: 0.5160292
	speed: 0.0043s/iter; left time: 7.9170s
	iters: 300, epoch: 7 | loss: 0.2853169
	speed: 0.0042s/iter; left time: 7.4161s
	iters: 400, epoch: 7 | loss: 0.5860698
	speed: 0.0042s/iter; left time: 6.9164s
	iters: 500, epoch: 7 | loss: 0.2940273
	speed: 0.0042s/iter; left time: 6.5280s
	iters: 600, epoch: 7 | loss: 0.4180941
	speed: 0.0042s/iter; left time: 6.0474s
	iters: 700, epoch: 7 | loss: 0.8209571
	speed: 0.0042s/iter; left time: 5.6949s
	iters: 800, epoch: 7 | loss: 0.5912930
	speed: 0.0042s/iter; left time: 5.2911s
	iters: 900, epoch: 7 | loss: 1.1840734
	speed: 0.0042s/iter; left time: 4.8612s
	iters: 1000, epoch: 7 | loss: 0.8366886
	speed: 0.0042s/iter; left time: 4.4393s
Updating learning rate to 1.934220036037799e-06
Epoch: 7 cost time: 4.35697340965271
Epoch: 7, Steps: 1027 | Train Loss: 0.5908885 Vali Loss: 0.3648744 Best vali loss: 0.3647312
	iters: 100, epoch: 8 | loss: 0.2736634
	speed: 0.0111s/iter; left time: 10.2881s
	iters: 200, epoch: 8 | loss: 0.9010471
	speed: 0.0042s/iter; left time: 3.4892s
	iters: 300, epoch: 8 | loss: 1.3730015
	speed: 0.0042s/iter; left time: 3.0216s
	iters: 400, epoch: 8 | loss: 0.3734953
	speed: 0.0042s/iter; left time: 2.6213s
	iters: 500, epoch: 8 | loss: 0.3110443
	speed: 0.0042s/iter; left time: 2.2192s
	iters: 600, epoch: 8 | loss: 0.7087407
	speed: 0.0042s/iter; left time: 1.7798s
	iters: 700, epoch: 8 | loss: 0.2443468
	speed: 0.0042s/iter; left time: 1.3850s
	iters: 800, epoch: 8 | loss: 0.3049688
	speed: 0.0042s/iter; left time: 0.9588s
	iters: 900, epoch: 8 | loss: 0.6126775
	speed: 0.0042s/iter; left time: 0.5408s
	iters: 1000, epoch: 8 | loss: 0.1887550
	speed: 0.0042s/iter; left time: 0.1176s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.3455657958984375
Epoch: 8, Steps: 1027 | Train Loss: 0.5291740 Vali Loss: 0.3648621 Best vali loss: 0.3647312

best validation loss 0.3647312296865497

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5084732
	speed: 0.0100s/iter; left time: 81.5556s
	iters: 200, epoch: 1 | loss: 0.5977940
	speed: 0.0040s/iter; left time: 32.0539s
	iters: 300, epoch: 1 | loss: 0.4407032
	speed: 0.0040s/iter; left time: 31.6788s
	iters: 400, epoch: 1 | loss: 1.6452827
	speed: 0.0040s/iter; left time: 31.2716s
	iters: 500, epoch: 1 | loss: 0.6603471
	speed: 0.0040s/iter; left time: 30.8705s
	iters: 600, epoch: 1 | loss: 0.2930004
	speed: 0.0040s/iter; left time: 30.3852s
	iters: 700, epoch: 1 | loss: 0.3790729
	speed: 0.0040s/iter; left time: 29.9983s
	iters: 800, epoch: 1 | loss: 0.6996874
	speed: 0.0041s/iter; left time: 30.4516s
	iters: 900, epoch: 1 | loss: 1.0609696
	speed: 0.0042s/iter; left time: 31.0748s
	iters: 1000, epoch: 1 | loss: 0.9290839
	speed: 0.0043s/iter; left time: 31.0233s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 4.52745795249939
Epoch: 1, Steps: 1027 | Train Loss: 0.7214414 Vali Loss: 0.3734798 Best vali loss: 0.3734798
	iters: 100, epoch: 2 | loss: 0.3140990
	speed: 0.0114s/iter; left time: 80.4809s
	iters: 200, epoch: 2 | loss: 0.3501896
	speed: 0.0043s/iter; left time: 30.0836s
	iters: 300, epoch: 2 | loss: 0.5064210
	speed: 0.0043s/iter; left time: 29.3237s
	iters: 400, epoch: 2 | loss: 0.6230472
	speed: 0.0043s/iter; left time: 28.9369s
	iters: 500, epoch: 2 | loss: 0.2650760
	speed: 0.0043s/iter; left time: 28.6625s
	iters: 600, epoch: 2 | loss: 0.5869551
	speed: 0.0043s/iter; left time: 28.0571s
	iters: 700, epoch: 2 | loss: 0.3650500
	speed: 0.0042s/iter; left time: 27.5330s
	iters: 800, epoch: 2 | loss: 0.2984263
	speed: 0.0043s/iter; left time: 27.3357s
	iters: 900, epoch: 2 | loss: 0.6000435
	speed: 0.0042s/iter; left time: 26.6201s
	iters: 1000, epoch: 2 | loss: 0.3816297
	speed: 0.0043s/iter; left time: 26.3468s
Updating learning rate to 0.0003908218029551133
Validation loss decreased (0.3735 --> 0.3547).  Saving model state dict ...
Epoch: 2 cost time: 4.425885438919067
Epoch: 2, Steps: 1027 | Train Loss: 0.4290937 Vali Loss: 0.3547250 Best vali loss: 0.3547250
	iters: 100, epoch: 3 | loss: 0.8113613
	speed: 0.0114s/iter; left time: 68.8277s
	iters: 200, epoch: 3 | loss: 0.4549312
	speed: 0.0043s/iter; left time: 25.6501s
	iters: 300, epoch: 3 | loss: 0.2810344
	speed: 0.0043s/iter; left time: 24.9975s
	iters: 400, epoch: 3 | loss: 0.2039403
	speed: 0.0042s/iter; left time: 24.4339s
	iters: 500, epoch: 3 | loss: 0.8853517
	speed: 0.0043s/iter; left time: 24.1576s
	iters: 600, epoch: 3 | loss: 0.3264499
	speed: 0.0042s/iter; left time: 23.6302s
	iters: 700, epoch: 3 | loss: 0.2775726
	speed: 0.0043s/iter; left time: 23.2772s
	iters: 800, epoch: 3 | loss: 0.2356927
	speed: 0.0042s/iter; left time: 22.7545s
	iters: 900, epoch: 3 | loss: 0.3282610
	speed: 0.0042s/iter; left time: 22.3232s
	iters: 1000, epoch: 3 | loss: 1.1522800
	speed: 0.0043s/iter; left time: 22.0303s
Updating learning rate to 0.00031654893408453833
Epoch: 3 cost time: 4.419764995574951
Epoch: 3, Steps: 1027 | Train Loss: 0.4956875 Vali Loss: 0.3630831 Best vali loss: 0.3547250
	iters: 100, epoch: 4 | loss: 0.6257323
	speed: 0.0112s/iter; left time: 56.5432s
	iters: 200, epoch: 4 | loss: 0.2842549
	speed: 0.0043s/iter; left time: 21.1207s
	iters: 300, epoch: 4 | loss: 0.8646072
	speed: 0.0043s/iter; left time: 21.0030s
	iters: 400, epoch: 4 | loss: 1.1107099
	speed: 0.0043s/iter; left time: 20.3773s
	iters: 500, epoch: 4 | loss: 1.3271215
	speed: 0.0043s/iter; left time: 20.0168s
	iters: 600, epoch: 4 | loss: 0.2821053
	speed: 0.0041s/iter; left time: 18.7560s
	iters: 700, epoch: 4 | loss: 0.3777564
	speed: 0.0040s/iter; left time: 17.7343s
	iters: 800, epoch: 4 | loss: 0.3098423
	speed: 0.0040s/iter; left time: 17.3504s
	iters: 900, epoch: 4 | loss: 0.5769285
	speed: 0.0040s/iter; left time: 16.9425s
	iters: 1000, epoch: 4 | loss: 0.3538031
	speed: 0.0040s/iter; left time: 16.5449s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 4.3082053661346436
Epoch: 4, Steps: 1027 | Train Loss: 0.6112861 Vali Loss: 0.3653909 Best vali loss: 0.3547250
	iters: 100, epoch: 5 | loss: 1.0176141
	speed: 0.0111s/iter; left time: 44.4307s
	iters: 200, epoch: 5 | loss: 0.2915157
	speed: 0.0043s/iter; left time: 16.7073s
	iters: 300, epoch: 5 | loss: 1.1958677
	speed: 0.0042s/iter; left time: 16.1042s
	iters: 400, epoch: 5 | loss: 0.4094027
	speed: 0.0043s/iter; left time: 15.9517s
	iters: 500, epoch: 5 | loss: 0.5463190
	speed: 0.0043s/iter; left time: 15.5087s
	iters: 600, epoch: 5 | loss: 1.0241349
	speed: 0.0043s/iter; left time: 15.1004s
	iters: 700, epoch: 5 | loss: 0.1957704
	speed: 0.0042s/iter; left time: 14.4709s
	iters: 800, epoch: 5 | loss: 0.2401173
	speed: 0.0043s/iter; left time: 14.0913s
	iters: 900, epoch: 5 | loss: 0.6722314
	speed: 0.0042s/iter; left time: 13.5406s
	iters: 1000, epoch: 5 | loss: 0.2813223
	speed: 0.0042s/iter; left time: 13.0199s
Updating learning rate to 0.0001413272893154617
Epoch: 5 cost time: 4.413648366928101
Epoch: 5, Steps: 1027 | Train Loss: 0.5874296 Vali Loss: 0.3589688 Best vali loss: 0.3547250
	iters: 100, epoch: 6 | loss: 0.3941896
	speed: 0.0113s/iter; left time: 33.6065s
	iters: 200, epoch: 6 | loss: 0.2114008
	speed: 0.0042s/iter; left time: 12.1679s
	iters: 300, epoch: 6 | loss: 0.6397390
	speed: 0.0043s/iter; left time: 11.9120s
	iters: 400, epoch: 6 | loss: 0.2843671
	speed: 0.0043s/iter; left time: 11.5332s
	iters: 500, epoch: 6 | loss: 0.2915043
	speed: 0.0043s/iter; left time: 11.0610s
	iters: 600, epoch: 6 | loss: 0.2100565
	speed: 0.0042s/iter; left time: 10.5374s
	iters: 700, epoch: 6 | loss: 0.3630030
	speed: 0.0043s/iter; left time: 10.1620s
	iters: 800, epoch: 6 | loss: 1.5990503
	speed: 0.0042s/iter; left time: 9.6767s
	iters: 900, epoch: 6 | loss: 0.2375269
	speed: 0.0043s/iter; left time: 9.3566s
	iters: 1000, epoch: 6 | loss: 0.3988623
	speed: 0.0042s/iter; left time: 8.8345s
Updating learning rate to 6.705442044488674e-05
Epoch: 6 cost time: 4.411267518997192
Epoch: 6, Steps: 1027 | Train Loss: 0.4629700 Vali Loss: 0.3584606 Best vali loss: 0.3547250
	iters: 100, epoch: 7 | loss: 0.6051655
	speed: 0.0112s/iter; left time: 21.8401s
	iters: 200, epoch: 7 | loss: 1.1590562
	speed: 0.0042s/iter; left time: 7.8450s
	iters: 300, epoch: 7 | loss: 0.2957845
	speed: 0.0042s/iter; left time: 7.3601s
	iters: 400, epoch: 7 | loss: 0.3435505
	speed: 0.0042s/iter; left time: 6.9699s
	iters: 500, epoch: 7 | loss: 0.9442549
	speed: 0.0042s/iter; left time: 6.4771s
	iters: 600, epoch: 7 | loss: 1.0997381
	speed: 0.0041s/iter; left time: 6.0122s
	iters: 700, epoch: 7 | loss: 0.2581176
	speed: 0.0042s/iter; left time: 5.6417s
	iters: 800, epoch: 7 | loss: 0.7375216
	speed: 0.0042s/iter; left time: 5.2746s
	iters: 900, epoch: 7 | loss: 0.3818696
	speed: 0.0042s/iter; left time: 4.8419s
	iters: 1000, epoch: 7 | loss: 0.3646097
	speed: 0.0043s/iter; left time: 4.4898s
Updating learning rate to 1.7426876088587254e-05
Epoch: 7 cost time: 4.34818172454834
Epoch: 7, Steps: 1027 | Train Loss: 0.6189668 Vali Loss: 0.3681624 Best vali loss: 0.3547250
	iters: 100, epoch: 8 | loss: 0.8902143
	speed: 0.0113s/iter; left time: 10.4523s
	iters: 200, epoch: 8 | loss: 0.3448215
	speed: 0.0043s/iter; left time: 3.5358s
	iters: 300, epoch: 8 | loss: 0.7368765
	speed: 0.0042s/iter; left time: 3.0695s
	iters: 400, epoch: 8 | loss: 0.4102874
	speed: 0.0042s/iter; left time: 2.6230s
	iters: 500, epoch: 8 | loss: 0.1779420
	speed: 0.0042s/iter; left time: 2.2182s
	iters: 600, epoch: 8 | loss: 0.4040249
	speed: 0.0039s/iter; left time: 1.6597s
	iters: 700, epoch: 8 | loss: 0.6396928
	speed: 0.0036s/iter; left time: 1.1907s
	iters: 800, epoch: 8 | loss: 0.4629233
	speed: 0.0036s/iter; left time: 0.8296s
	iters: 900, epoch: 8 | loss: 0.6798061
	speed: 0.0036s/iter; left time: 0.4645s
	iters: 1000, epoch: 8 | loss: 0.1817221
	speed: 0.0036s/iter; left time: 0.1018s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.090824365615845
Epoch: 8, Steps: 1027 | Train Loss: 0.4928311 Vali Loss: 0.3664575 Best vali loss: 0.3547250

best validation loss 0.35472496568219836

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.4035).  Saving model state dict ...
Epoch: 1 cost time: 0.7859511375427246
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4034988 Best vali loss: 0.4034988
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.4035 --> 0.3865).  Saving model state dict ...
Epoch: 2 cost time: 0.4335930347442627
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3865422 Best vali loss: 0.3865422
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.3865 --> 0.3782).  Saving model state dict ...
Epoch: 3 cost time: 0.4335062503814697
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3782250 Best vali loss: 0.3782250

best validation loss 0.3782250005393225

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4755637
	speed: 0.0150s/iter; left time: 13.9551s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.3634).  Saving model state dict ...
Epoch: 1 cost time: 1.4899837970733643
Epoch: 1, Steps: 129 | Train Loss: 0.4755637 Vali Loss: 0.3634423 Best vali loss: 0.3634423
	iters: 100, epoch: 2 | loss: 0.5511795
	speed: 0.0142s/iter; left time: 11.4344s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.3634 --> 0.3583).  Saving model state dict ...
Epoch: 2 cost time: 1.1653165817260742
Epoch: 2, Steps: 129 | Train Loss: 0.5511795 Vali Loss: 0.3583002 Best vali loss: 0.3583002
	iters: 100, epoch: 3 | loss: 0.8230171
	speed: 0.0144s/iter; left time: 9.7294s
Updating learning rate to 0.00016268287006193248
Epoch: 3 cost time: 1.1715457439422607
Epoch: 3, Steps: 129 | Train Loss: 0.8230171 Vali Loss: 0.3606501 Best vali loss: 0.3583002

best validation loss 0.3583002460963131

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9802859
	speed: 0.0115s/iter; left time: 22.4595s
	iters: 200, epoch: 1 | loss: 0.3405740
	speed: 0.0055s/iter; left time: 10.1348s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 1.738384485244751
Epoch: 1, Steps: 257 | Train Loss: 0.6604300 Vali Loss: 0.3657182 Best vali loss: 0.3657182
	iters: 100, epoch: 2 | loss: 0.6103957
	speed: 0.0106s/iter; left time: 18.0294s
	iters: 200, epoch: 2 | loss: 0.6435148
	speed: 0.0049s/iter; left time: 7.8233s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.3657 --> 0.3609).  Saving model state dict ...
Epoch: 2 cost time: 1.3028855323791504
Epoch: 2, Steps: 257 | Train Loss: 0.6269552 Vali Loss: 0.3609287 Best vali loss: 0.3609287
	iters: 100, epoch: 3 | loss: 0.3906236
	speed: 0.0109s/iter; left time: 15.7294s
	iters: 200, epoch: 3 | loss: 0.3959781
	speed: 0.0054s/iter; left time: 7.2413s
Updating learning rate to 5.637801725e-05
Epoch: 3 cost time: 1.4309449195861816
Epoch: 3, Steps: 257 | Train Loss: 0.3933009 Vali Loss: 0.3646485 Best vali loss: 0.3609287

best validation loss 0.36092869967280766

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4004002
	speed: 0.0158s/iter; left time: 8.6202s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 1.5162732601165771
Epoch: 4, Steps: 129 | Train Loss: 0.4004002 Vali Loss: 0.3614109 Best vali loss: 0.3583002
	iters: 100, epoch: 5 | loss: 0.4553118
	speed: 0.0140s/iter; left time: 5.8501s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 1.1815440654754639
Epoch: 5, Steps: 129 | Train Loss: 0.4553118 Vali Loss: 0.3875703 Best vali loss: 0.3583002
	iters: 100, epoch: 6 | loss: 0.6781163
	speed: 0.0139s/iter; left time: 3.9985s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 1.1702759265899658
Epoch: 6, Steps: 129 | Train Loss: 0.6781163 Vali Loss: 0.3824079 Best vali loss: 0.3583002
	iters: 100, epoch: 7 | loss: 0.3946624
	speed: 0.0141s/iter; left time: 2.2494s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 1.1863844394683838
Epoch: 7, Steps: 129 | Train Loss: 0.3946624 Vali Loss: 0.3918644 Best vali loss: 0.3583002
	iters: 100, epoch: 8 | loss: 0.3475603
	speed: 0.0142s/iter; left time: 0.4254s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1843042373657227
Epoch: 8, Steps: 129 | Train Loss: 0.3475603 Vali Loss: 0.3997287 Best vali loss: 0.3583002

best validation loss 0.3583002460963131

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.3991).  Saving model state dict ...
Epoch: 1 cost time: 0.5967352390289307
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3991384 Best vali loss: 0.3991384
Updating learning rate to 0.0024817206738164837
Validation loss decreased (0.3991 --> 0.3722).  Saving model state dict ...
Epoch: 2 cost time: 0.30107641220092773
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3722097 Best vali loss: 0.3722097
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 0.3322460651397705
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3997472 Best vali loss: 0.3722097
Updating learning rate to 0.0014537583127
Epoch: 4 cost time: 0.2969393730163574
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4043143 Best vali loss: 0.3722097
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 0.33225417137145996
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4064837 Best vali loss: 0.3722097
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 0.30980467796325684
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4373362 Best vali loss: 0.3722097
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 0.31722140312194824
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4499236 Best vali loss: 0.3722097
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3345763683319092
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4559842 Best vali loss: 0.3722097

best validation loss 0.37220965573501963

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4014488
	speed: 0.0100s/iter; left time: 9.2908s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.3756).  Saving model state dict ...
Epoch: 1 cost time: 0.8569419384002686
Epoch: 1, Steps: 129 | Train Loss: 0.4014488 Vali Loss: 0.3755540 Best vali loss: 0.3755540
	iters: 100, epoch: 2 | loss: 0.6850314
	speed: 0.0069s/iter; left time: 5.5798s
Updating learning rate to 0.00110292920845
Epoch: 2 cost time: 0.5487744808197021
Epoch: 2, Steps: 129 | Train Loss: 0.6850314 Vali Loss: 0.3861649 Best vali loss: 0.3755540
	iters: 100, epoch: 3 | loss: 0.4067782
	speed: 0.0067s/iter; left time: 4.5069s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.3756 --> 0.3754).  Saving model state dict ...
Epoch: 3 cost time: 0.526691198348999
Epoch: 3, Steps: 129 | Train Loss: 0.4067782 Vali Loss: 0.3753956 Best vali loss: 0.3753956
	iters: 100, epoch: 4 | loss: 0.7756189
	speed: 0.0068s/iter; left time: 3.7209s
Updating learning rate to 0.0002757323021125
Epoch: 4 cost time: 0.535444974899292
Epoch: 4, Steps: 129 | Train Loss: 0.7756189 Vali Loss: 0.3778760 Best vali loss: 0.3753956
	iters: 100, epoch: 5 | loss: 1.0322999
	speed: 0.0068s/iter; left time: 2.8368s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 0.5310437679290771
Epoch: 5, Steps: 129 | Train Loss: 1.0322999 Vali Loss: 0.3870025 Best vali loss: 0.3753956
	iters: 100, epoch: 6 | loss: 0.5652820
	speed: 0.0065s/iter; left time: 1.8765s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 0.5136110782623291
Epoch: 6, Steps: 129 | Train Loss: 0.5652820 Vali Loss: 0.3843897 Best vali loss: 0.3753956
	iters: 100, epoch: 7 | loss: 0.5281349
	speed: 0.0069s/iter; left time: 1.0925s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 0.5405538082122803
Epoch: 7, Steps: 129 | Train Loss: 0.5281349 Vali Loss: 0.3803472 Best vali loss: 0.3753956
	iters: 100, epoch: 8 | loss: 0.6546460
	speed: 0.0066s/iter; left time: 0.1973s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 0.5307519435882568
Epoch: 8, Steps: 129 | Train Loss: 0.6546460 Vali Loss: 0.3797578 Best vali loss: 0.3753956

best validation loss 0.3753956499408879

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4668409
	speed: 0.0085s/iter; left time: 16.6505s
	iters: 200, epoch: 1 | loss: 0.4139578
	speed: 0.0024s/iter; left time: 4.5344s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 0.9726929664611816
Epoch: 1, Steps: 257 | Train Loss: 0.4403993 Vali Loss: 0.3756772 Best vali loss: 0.3756772
	iters: 100, epoch: 2 | loss: 0.5595556
	speed: 0.0062s/iter; left time: 10.5854s
	iters: 200, epoch: 2 | loss: 0.3667197
	speed: 0.0024s/iter; left time: 3.8435s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.3757 --> 0.3725).  Saving model state dict ...
Epoch: 2 cost time: 0.6739122867584229
Epoch: 2, Steps: 257 | Train Loss: 0.4631377 Vali Loss: 0.3725283 Best vali loss: 0.3725283
	iters: 100, epoch: 3 | loss: 0.7608157
	speed: 0.0065s/iter; left time: 9.3348s
	iters: 200, epoch: 3 | loss: 0.3133416
	speed: 0.0029s/iter; left time: 3.8583s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 0.7682080268859863
Epoch: 3, Steps: 257 | Train Loss: 0.5370786 Vali Loss: 0.3997259 Best vali loss: 0.3725283

best validation loss 0.37252830039775675

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.4117).  Saving model state dict ...
Epoch: 1 cost time: 0.7288832664489746
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4116518 Best vali loss: 0.4116518
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.4117 --> 0.3914).  Saving model state dict ...
Epoch: 2 cost time: 0.4284791946411133
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3913949 Best vali loss: 0.3913949
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.3914 --> 0.3811).  Saving model state dict ...
Epoch: 3 cost time: 0.4312872886657715
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3811421 Best vali loss: 0.3811421

best validation loss 0.38114207552083584

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9974793
	speed: 0.0105s/iter; left time: 20.5239s
	iters: 200, epoch: 1 | loss: 0.7189469
	speed: 0.0046s/iter; left time: 8.5630s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.4038).  Saving model state dict ...
Epoch: 1 cost time: 1.520935297012329
Epoch: 1, Steps: 257 | Train Loss: 0.8582131 Vali Loss: 0.4038398 Best vali loss: 0.4038398
	iters: 100, epoch: 2 | loss: 1.1598021
	speed: 0.0095s/iter; left time: 16.1550s
	iters: 200, epoch: 2 | loss: 0.6204589
	speed: 0.0042s/iter; left time: 6.7963s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 1.1365768909454346
Epoch: 2, Steps: 257 | Train Loss: 0.8901305 Vali Loss: 0.4058852 Best vali loss: 0.4038398
	iters: 100, epoch: 3 | loss: 0.7219403
	speed: 0.0090s/iter; left time: 13.0297s
	iters: 200, epoch: 3 | loss: 1.3407354
	speed: 0.0043s/iter; left time: 5.8152s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 1.12558913230896
Epoch: 3, Steps: 257 | Train Loss: 1.0313379 Vali Loss: 0.4039350 Best vali loss: 0.4038398

best validation loss 0.40383983211105134

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4044140
	speed: 0.0089s/iter; left time: 10.5678s
	iters: 200, epoch: 4 | loss: 0.3952633
	speed: 0.0028s/iter; left time: 3.0199s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 1.0600402355194092
Epoch: 4, Steps: 257 | Train Loss: 0.3998387 Vali Loss: 0.4270142 Best vali loss: 0.3725283
	iters: 100, epoch: 5 | loss: 0.4770718
	speed: 0.0063s/iter; left time: 5.8198s
	iters: 200, epoch: 5 | loss: 0.3164984
	speed: 0.0024s/iter; left time: 1.9770s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 0.6714324951171875
Epoch: 5, Steps: 257 | Train Loss: 0.3967851 Vali Loss: 0.4293520 Best vali loss: 0.3725283
	iters: 100, epoch: 6 | loss: 0.6226487
	speed: 0.0064s/iter; left time: 4.2795s
	iters: 200, epoch: 6 | loss: 0.2907502
	speed: 0.0026s/iter; left time: 1.5088s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 0.7346200942993164
Epoch: 6, Steps: 257 | Train Loss: 0.4566994 Vali Loss: 0.4741374 Best vali loss: 0.3725283
	iters: 100, epoch: 7 | loss: 0.3485282
	speed: 0.0065s/iter; left time: 2.6776s
	iters: 200, epoch: 7 | loss: 0.4312728
	speed: 0.0027s/iter; left time: 0.8367s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 0.7201704978942871
Epoch: 7, Steps: 257 | Train Loss: 0.3899005 Vali Loss: 0.5041963 Best vali loss: 0.3725283
	iters: 100, epoch: 8 | loss: 0.3334388
	speed: 0.0063s/iter; left time: 0.9901s
	iters: 200, epoch: 8 | loss: 0.7044818
	speed: 0.0025s/iter; left time: 0.1475s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7010929584503174
Epoch: 8, Steps: 257 | Train Loss: 0.5189603 Vali Loss: 0.4972072 Best vali loss: 0.3725283

best validation loss 0.37252830039775675

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4150002
	speed: 0.0096s/iter; left time: 18.7072s
	iters: 200, epoch: 1 | loss: 0.7142684
	speed: 0.0037s/iter; left time: 6.9323s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.2917895317077637
Epoch: 1, Steps: 257 | Train Loss: 0.5646343 Vali Loss: 0.3675596 Best vali loss: 0.3675596
	iters: 100, epoch: 2 | loss: 0.6194140
	speed: 0.0083s/iter; left time: 14.1236s
	iters: 200, epoch: 2 | loss: 0.3462737
	speed: 0.0038s/iter; left time: 6.0852s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 1.0167028903961182
Epoch: 2, Steps: 257 | Train Loss: 0.4828439 Vali Loss: 0.3679635 Best vali loss: 0.3675596
	iters: 100, epoch: 3 | loss: 0.8719909
	speed: 0.0081s/iter; left time: 11.6244s
	iters: 200, epoch: 3 | loss: 0.6785589
	speed: 0.0037s/iter; left time: 4.9355s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 0.9696650505065918
Epoch: 3, Steps: 257 | Train Loss: 0.7752749 Vali Loss: 0.3717465 Best vali loss: 0.3675596
	iters: 100, epoch: 4 | loss: 0.6724608
	speed: 0.0080s/iter; left time: 9.5104s
	iters: 200, epoch: 4 | loss: 0.4200811
	speed: 0.0036s/iter; left time: 3.9142s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 0.9945781230926514
Epoch: 4, Steps: 257 | Train Loss: 0.5462710 Vali Loss: 0.3719016 Best vali loss: 0.3675596
	iters: 100, epoch: 5 | loss: 0.3077812
	speed: 0.0084s/iter; left time: 7.7793s
	iters: 200, epoch: 5 | loss: 0.4059567
	speed: 0.0038s/iter; left time: 3.1523s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 1.0239112377166748
Epoch: 5, Steps: 257 | Train Loss: 0.3568690 Vali Loss: 0.3724689 Best vali loss: 0.3675596
	iters: 100, epoch: 6 | loss: 0.6943374
	speed: 0.0080s/iter; left time: 5.3858s
	iters: 200, epoch: 6 | loss: 0.5345892
	speed: 0.0033s/iter; left time: 1.8608s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 0.8967738151550293
Epoch: 6, Steps: 257 | Train Loss: 0.6144633 Vali Loss: 0.3730540 Best vali loss: 0.3675596
	iters: 100, epoch: 7 | loss: 0.4498364
	speed: 0.0075s/iter; left time: 3.1125s
	iters: 200, epoch: 7 | loss: 0.7660058
	speed: 0.0034s/iter; left time: 1.0842s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 0.9025321006774902
Epoch: 7, Steps: 257 | Train Loss: 0.6079211 Vali Loss: 0.3728912 Best vali loss: 0.3675596
	iters: 100, epoch: 8 | loss: 0.5355822
	speed: 0.0080s/iter; left time: 1.2668s
	iters: 200, epoch: 8 | loss: 0.3152448
	speed: 0.0038s/iter; left time: 0.2217s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 1.0170934200286865
Epoch: 8, Steps: 257 | Train Loss: 0.4254135 Vali Loss: 0.3731623 Best vali loss: 0.3675596

best validation loss 0.3675595670411535

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1168650
	speed: 0.0084s/iter; left time: 68.0260s
	iters: 200, epoch: 1 | loss: 1.2202717
	speed: 0.0023s/iter; left time: 18.4922s
	iters: 300, epoch: 1 | loss: 0.4734292
	speed: 0.0023s/iter; left time: 18.2362s
	iters: 400, epoch: 1 | loss: 0.3025644
	speed: 0.0023s/iter; left time: 18.2573s
	iters: 500, epoch: 1 | loss: 1.0001115
	speed: 0.0023s/iter; left time: 18.0570s
	iters: 600, epoch: 1 | loss: 0.5992243
	speed: 0.0024s/iter; left time: 18.0185s
	iters: 700, epoch: 1 | loss: 0.7311769
	speed: 0.0024s/iter; left time: 17.8758s
	iters: 800, epoch: 1 | loss: 0.3387877
	speed: 0.0024s/iter; left time: 17.5114s
	iters: 900, epoch: 1 | loss: 0.3546385
	speed: 0.0023s/iter; left time: 17.0585s
	iters: 1000, epoch: 1 | loss: 0.3296684
	speed: 0.0024s/iter; left time: 17.0154s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.3861).  Saving model state dict ...
Epoch: 1 cost time: 2.758404493331909
Epoch: 1, Steps: 1027 | Train Loss: 0.6466738 Vali Loss: 0.3861318 Best vali loss: 0.3861318
	iters: 100, epoch: 2 | loss: 0.8616487
	speed: 0.0076s/iter; left time: 53.5727s
	iters: 200, epoch: 2 | loss: 0.5124664
	speed: 0.0024s/iter; left time: 16.7080s
	iters: 300, epoch: 2 | loss: 1.4238179
	speed: 0.0024s/iter; left time: 16.4402s
	iters: 400, epoch: 2 | loss: 1.6283615
	speed: 0.0024s/iter; left time: 16.0305s
	iters: 500, epoch: 2 | loss: 1.0156096
	speed: 0.0024s/iter; left time: 15.9120s
	iters: 600, epoch: 2 | loss: 0.8589724
	speed: 0.0023s/iter; left time: 15.4843s
	iters: 700, epoch: 2 | loss: 0.3550822
	speed: 0.0024s/iter; left time: 15.3861s
	iters: 800, epoch: 2 | loss: 0.8534977
	speed: 0.0024s/iter; left time: 15.0553s
	iters: 900, epoch: 2 | loss: 0.3887066
	speed: 0.0024s/iter; left time: 14.8355s
	iters: 1000, epoch: 2 | loss: 1.1161768
	speed: 0.0024s/iter; left time: 14.6468s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.3861 --> 0.3773).  Saving model state dict ...
Epoch: 2 cost time: 2.476151943206787
Epoch: 2, Steps: 1027 | Train Loss: 0.9014340 Vali Loss: 0.3773374 Best vali loss: 0.3773374
	iters: 100, epoch: 3 | loss: 1.6376127
	speed: 0.0077s/iter; left time: 46.9271s
	iters: 200, epoch: 3 | loss: 0.3733073
	speed: 0.0024s/iter; left time: 14.1906s
	iters: 300, epoch: 3 | loss: 0.9311464
	speed: 0.0024s/iter; left time: 13.9803s
	iters: 400, epoch: 3 | loss: 0.7434315
	speed: 0.0024s/iter; left time: 13.6557s
	iters: 500, epoch: 3 | loss: 0.5646837
	speed: 0.0024s/iter; left time: 13.3857s
	iters: 600, epoch: 3 | loss: 1.0828888
	speed: 0.0024s/iter; left time: 13.1352s
	iters: 700, epoch: 3 | loss: 1.0611367
	speed: 0.0023s/iter; left time: 12.8101s
	iters: 800, epoch: 3 | loss: 0.2874110
	speed: 0.0023s/iter; left time: 12.2116s
	iters: 900, epoch: 3 | loss: 0.2949578
	speed: 0.0023s/iter; left time: 12.0460s
	iters: 1000, epoch: 3 | loss: 0.3378969
	speed: 0.0023s/iter; left time: 12.0491s
Updating learning rate to 0.0004533601436
Epoch: 3 cost time: 2.4476845264434814
Epoch: 3, Steps: 1027 | Train Loss: 0.7314473 Vali Loss: 0.4245063 Best vali loss: 0.3773374
	iters: 100, epoch: 4 | loss: 0.4082234
	speed: 0.0075s/iter; left time: 37.7607s
	iters: 200, epoch: 4 | loss: 0.5248363
	speed: 0.0022s/iter; left time: 11.0299s
	iters: 300, epoch: 4 | loss: 0.8194860
	speed: 0.0023s/iter; left time: 11.0278s
	iters: 400, epoch: 4 | loss: 0.4119243
	speed: 0.0023s/iter; left time: 10.8477s
	iters: 500, epoch: 4 | loss: 0.7516367
	speed: 0.0023s/iter; left time: 10.6803s
	iters: 600, epoch: 4 | loss: 0.6672041
	speed: 0.0023s/iter; left time: 10.3194s
	iters: 700, epoch: 4 | loss: 0.7170619
	speed: 0.0023s/iter; left time: 10.1772s
	iters: 800, epoch: 4 | loss: 0.4606681
	speed: 0.0023s/iter; left time: 9.8570s
	iters: 900, epoch: 4 | loss: 0.4059613
	speed: 0.0023s/iter; left time: 9.6318s
	iters: 1000, epoch: 4 | loss: 0.3525778
	speed: 0.0023s/iter; left time: 9.4332s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 2.38692307472229
Epoch: 4, Steps: 1027 | Train Loss: 0.5519580 Vali Loss: 0.4493434 Best vali loss: 0.3773374
	iters: 100, epoch: 5 | loss: 0.9209146
	speed: 0.0075s/iter; left time: 30.0957s
	iters: 200, epoch: 5 | loss: 0.3694780
	speed: 0.0023s/iter; left time: 9.0677s
	iters: 300, epoch: 5 | loss: 0.7593989
	speed: 0.0023s/iter; left time: 8.7566s
	iters: 400, epoch: 5 | loss: 0.4339349
	speed: 0.0022s/iter; left time: 8.2526s
	iters: 500, epoch: 5 | loss: 0.3265172
	speed: 0.0023s/iter; left time: 8.2730s
	iters: 600, epoch: 5 | loss: 0.2694307
	speed: 0.0023s/iter; left time: 8.1754s
	iters: 700, epoch: 5 | loss: 0.4486053
	speed: 0.0023s/iter; left time: 7.9789s
	iters: 800, epoch: 5 | loss: 0.2781005
	speed: 0.0022s/iter; left time: 7.3123s
	iters: 900, epoch: 5 | loss: 0.7399935
	speed: 0.0022s/iter; left time: 7.0041s
	iters: 1000, epoch: 5 | loss: 0.4040595
	speed: 0.0022s/iter; left time: 6.8097s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 2.371530532836914
Epoch: 5, Steps: 1027 | Train Loss: 0.4950433 Vali Loss: 0.4783850 Best vali loss: 0.3773374
	iters: 100, epoch: 6 | loss: 0.5532408
	speed: 0.0073s/iter; left time: 21.8313s
	iters: 200, epoch: 6 | loss: 0.5277807
	speed: 0.0024s/iter; left time: 6.9179s
	iters: 300, epoch: 6 | loss: 0.4315680
	speed: 0.0024s/iter; left time: 6.6928s
	iters: 400, epoch: 6 | loss: 0.3528920
	speed: 0.0024s/iter; left time: 6.4148s
	iters: 500, epoch: 6 | loss: 0.2443363
	speed: 0.0024s/iter; left time: 6.2320s
	iters: 600, epoch: 6 | loss: 0.3775695
	speed: 0.0024s/iter; left time: 6.0572s
	iters: 700, epoch: 6 | loss: 0.2279795
	speed: 0.0025s/iter; left time: 5.8852s
	iters: 800, epoch: 6 | loss: 0.3268621
	speed: 0.0025s/iter; left time: 5.6354s
	iters: 900, epoch: 6 | loss: 0.5086482
	speed: 0.0024s/iter; left time: 5.3147s
	iters: 1000, epoch: 6 | loss: 0.2354859
	speed: 0.0024s/iter; left time: 5.0022s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 2.5118367671966553
Epoch: 6, Steps: 1027 | Train Loss: 0.3786363 Vali Loss: 0.4711050 Best vali loss: 0.3773374
	iters: 100, epoch: 7 | loss: 0.9482330
	speed: 0.0074s/iter; left time: 14.4187s
	iters: 200, epoch: 7 | loss: 0.6265193
	speed: 0.0023s/iter; left time: 4.3428s
	iters: 300, epoch: 7 | loss: 0.5529046
	speed: 0.0024s/iter; left time: 4.1244s
	iters: 400, epoch: 7 | loss: 1.5817020
	speed: 0.0024s/iter; left time: 3.8954s
	iters: 500, epoch: 7 | loss: 0.5535480
	speed: 0.0023s/iter; left time: 3.6426s
	iters: 600, epoch: 7 | loss: 0.9262925
	speed: 0.0024s/iter; left time: 3.4423s
	iters: 700, epoch: 7 | loss: 0.4610137
	speed: 0.0024s/iter; left time: 3.2497s
	iters: 800, epoch: 7 | loss: 0.6158921
	speed: 0.0024s/iter; left time: 2.9673s
	iters: 900, epoch: 7 | loss: 0.4325725
	speed: 0.0024s/iter; left time: 2.7545s
	iters: 1000, epoch: 7 | loss: 0.3335583
	speed: 0.0024s/iter; left time: 2.5656s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 2.478529691696167
Epoch: 7, Steps: 1027 | Train Loss: 0.7032236 Vali Loss: 0.4937548 Best vali loss: 0.3773374
	iters: 100, epoch: 8 | loss: 0.2195445
	speed: 0.0072s/iter; left time: 6.7174s
	iters: 200, epoch: 8 | loss: 0.2237142
	speed: 0.0021s/iter; left time: 1.7347s
	iters: 300, epoch: 8 | loss: 0.3057536
	speed: 0.0021s/iter; left time: 1.5215s
	iters: 400, epoch: 8 | loss: 0.2239290
	speed: 0.0021s/iter; left time: 1.3105s
	iters: 500, epoch: 8 | loss: 0.3092897
	speed: 0.0021s/iter; left time: 1.0986s
	iters: 600, epoch: 8 | loss: 0.4613464
	speed: 0.0021s/iter; left time: 0.8920s
	iters: 700, epoch: 8 | loss: 0.3871662
	speed: 0.0021s/iter; left time: 0.6831s
	iters: 800, epoch: 8 | loss: 0.8116203
	speed: 0.0021s/iter; left time: 0.4755s
	iters: 900, epoch: 8 | loss: 0.5843429
	speed: 0.0021s/iter; left time: 0.2662s
	iters: 1000, epoch: 8 | loss: 0.2182512
	speed: 0.0021s/iter; left time: 0.0584s
Updating learning rate to 1.41675044875e-05
Epoch: 8 cost time: 2.1819708347320557
Epoch: 8, Steps: 1027 | Train Loss: 0.3744958 Vali Loss: 0.4907903 Best vali loss: 0.3773374

best validation loss 0.3773374320364654

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.4009).  Saving model state dict ...
Epoch: 1 cost time: 0.6245558261871338
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4009402 Best vali loss: 0.4009402
Updating learning rate to 0.0002257411363
Validation loss decreased (0.4009 --> 0.3819).  Saving model state dict ...
Epoch: 2 cost time: 0.31926608085632324
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3819314 Best vali loss: 0.3819314
Updating learning rate to 0.00011287056815
Validation loss decreased (0.3819 --> 0.3766).  Saving model state dict ...
Epoch: 3 cost time: 0.3105621337890625
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3765574 Best vali loss: 0.3765574

best validation loss 0.37655736467927287

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6100000
	speed: 0.0093s/iter; left time: 8.6782s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 0.7679681777954102
Epoch: 1, Steps: 129 | Train Loss: 0.6100000 Vali Loss: 0.3711772 Best vali loss: 0.3711772
	iters: 100, epoch: 2 | loss: 0.5815114
	speed: 0.0059s/iter; left time: 4.7460s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.3712 --> 0.3625).  Saving model state dict ...
Epoch: 2 cost time: 0.43773579597473145
Epoch: 2, Steps: 129 | Train Loss: 0.5815114 Vali Loss: 0.3624891 Best vali loss: 0.3624891
	iters: 100, epoch: 3 | loss: 0.5620725
	speed: 0.0060s/iter; left time: 4.0259s
Updating learning rate to 1.70765195e-05
Epoch: 3 cost time: 0.45366573333740234
Epoch: 3, Steps: 129 | Train Loss: 0.5620725 Vali Loss: 0.3629084 Best vali loss: 0.3624891

best validation loss 0.36248914029134516

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3460743
	speed: 0.0088s/iter; left time: 17.1830s
	iters: 200, epoch: 1 | loss: 0.6688406
	speed: 0.0025s/iter; left time: 4.5606s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 1.0011167526245117
Epoch: 1, Steps: 257 | Train Loss: 0.5074575 Vali Loss: 0.3693678 Best vali loss: 0.3693678
	iters: 100, epoch: 2 | loss: 0.7029994
	speed: 0.0064s/iter; left time: 10.8526s
	iters: 200, epoch: 2 | loss: 0.3912174
	speed: 0.0028s/iter; left time: 4.4933s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 0.7364985942840576
Epoch: 2, Steps: 257 | Train Loss: 0.5471084 Vali Loss: 0.3760393 Best vali loss: 0.3693678
	iters: 100, epoch: 3 | loss: 0.5244998
	speed: 0.0061s/iter; left time: 8.8150s
	iters: 200, epoch: 3 | loss: 0.6672828
	speed: 0.0024s/iter; left time: 3.2619s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 0.6608085632324219
Epoch: 3, Steps: 257 | Train Loss: 0.5958913 Vali Loss: 0.3896087 Best vali loss: 0.3693678

best validation loss 0.3693677751043691

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5871800
	speed: 0.0097s/iter; left time: 5.3167s
Updating learning rate to 8.53825975e-06
Epoch: 4 cost time: 0.7866630554199219
Epoch: 4, Steps: 129 | Train Loss: 0.5871800 Vali Loss: 0.3644141 Best vali loss: 0.3624891
	iters: 100, epoch: 5 | loss: 0.5627345
	speed: 0.0060s/iter; left time: 2.4998s
Updating learning rate to 4.269129875e-06
Epoch: 5 cost time: 0.4607248306274414
Epoch: 5, Steps: 129 | Train Loss: 0.5627345 Vali Loss: 0.3637217 Best vali loss: 0.3624891
	iters: 100, epoch: 6 | loss: 0.5622964
	speed: 0.0059s/iter; left time: 1.7007s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 0.4372060298919678
Epoch: 6, Steps: 129 | Train Loss: 0.5622964 Vali Loss: 0.3636630 Best vali loss: 0.3624891
	iters: 100, epoch: 7 | loss: 0.6946155
	speed: 0.0058s/iter; left time: 0.9199s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 0.4370384216308594
Epoch: 7, Steps: 129 | Train Loss: 0.6946155 Vali Loss: 0.3635809 Best vali loss: 0.3624891
	iters: 100, epoch: 8 | loss: 0.4669677
	speed: 0.0061s/iter; left time: 0.1834s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 0.47901248931884766
Epoch: 8, Steps: 129 | Train Loss: 0.4669677 Vali Loss: 0.3636558 Best vali loss: 0.3624891

best validation loss 0.36248914029134516

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4327762
	speed: 0.0098s/iter; left time: 19.1631s
	iters: 200, epoch: 1 | loss: 0.4811751
	speed: 0.0037s/iter; left time: 6.9255s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 1.2965679168701172
Epoch: 1, Steps: 257 | Train Loss: 0.4569757 Vali Loss: 0.3692022 Best vali loss: 0.3692022
	iters: 100, epoch: 2 | loss: 0.5950590
	speed: 0.0081s/iter; left time: 13.7554s
	iters: 200, epoch: 2 | loss: 0.5680009
	speed: 0.0038s/iter; left time: 6.0346s
Updating learning rate to 0.0011100975329
Epoch: 2 cost time: 1.005251169204712
Epoch: 2, Steps: 257 | Train Loss: 0.5815299 Vali Loss: 0.3731185 Best vali loss: 0.3692022
	iters: 100, epoch: 3 | loss: 0.5074316
	speed: 0.0079s/iter; left time: 11.3612s
	iters: 200, epoch: 3 | loss: 0.9410152
	speed: 0.0035s/iter; left time: 4.6377s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 0.9337203502655029
Epoch: 3, Steps: 257 | Train Loss: 0.7242234 Vali Loss: 0.3713742 Best vali loss: 0.3692022
	iters: 100, epoch: 4 | loss: 0.8260192
	speed: 0.0077s/iter; left time: 9.1200s
	iters: 200, epoch: 4 | loss: 0.3180073
	speed: 0.0033s/iter; left time: 3.5959s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 0.9039485454559326
Epoch: 4, Steps: 257 | Train Loss: 0.5720132 Vali Loss: 0.3807708 Best vali loss: 0.3692022
	iters: 100, epoch: 5 | loss: 0.6267120
	speed: 0.0079s/iter; left time: 7.3825s
	iters: 200, epoch: 5 | loss: 0.4431087
	speed: 0.0037s/iter; left time: 3.0788s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 0.9818956851959229
Epoch: 5, Steps: 257 | Train Loss: 0.5349103 Vali Loss: 0.3947482 Best vali loss: 0.3692022
	iters: 100, epoch: 6 | loss: 0.5949050
	speed: 0.0078s/iter; left time: 5.2586s
	iters: 200, epoch: 6 | loss: 0.5589488
	speed: 0.0033s/iter; left time: 1.9005s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 0.9129576683044434
Epoch: 6, Steps: 257 | Train Loss: 0.5769269 Vali Loss: 0.3966404 Best vali loss: 0.3692022
	iters: 100, epoch: 7 | loss: 0.5190042
	speed: 0.0077s/iter; left time: 3.1801s
	iters: 200, epoch: 7 | loss: 0.4819832
	speed: 0.0035s/iter; left time: 1.1033s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 0.9378719329833984
Epoch: 7, Steps: 257 | Train Loss: 0.5004937 Vali Loss: 0.3940359 Best vali loss: 0.3692022
	iters: 100, epoch: 8 | loss: 0.6046292
	speed: 0.0077s/iter; left time: 1.2185s
	iters: 200, epoch: 8 | loss: 0.5602509
	speed: 0.0037s/iter; left time: 0.2124s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 0.9706146717071533
Epoch: 8, Steps: 257 | Train Loss: 0.5824400 Vali Loss: 0.3914802 Best vali loss: 0.3692022

best validation loss 0.36920217487573154

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.4071).  Saving model state dict ...
Epoch: 1 cost time: 0.6360187530517578
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4070515 Best vali loss: 0.4070515
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.4071 --> 0.3870).  Saving model state dict ...
Epoch: 2 cost time: 0.3396420478820801
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3869875 Best vali loss: 0.3869875
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.3870 --> 0.3781).  Saving model state dict ...
Epoch: 3 cost time: 0.35653233528137207
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3780936 Best vali loss: 0.3780936
Updating learning rate to 0.00017563123165
Validation loss decreased (0.3781 --> 0.3736).  Saving model state dict ...
Epoch: 4 cost time: 0.35617971420288086
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3736452 Best vali loss: 0.3736452
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.3736 --> 0.3707).  Saving model state dict ...
Epoch: 5 cost time: 0.3435549736022949
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3707442 Best vali loss: 0.3707442
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.3707 --> 0.3698).  Saving model state dict ...
Epoch: 6 cost time: 0.33023738861083984
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3698130 Best vali loss: 0.3698130
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.3698 --> 0.3693).  Saving model state dict ...
Epoch: 7 cost time: 0.35552191734313965
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3693498 Best vali loss: 0.3693498
Updating learning rate to 0.0
Validation loss decreased (0.3693 --> 0.3693).  Saving model state dict ...
Epoch: 8 cost time: 0.3365449905395508
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3692698 Best vali loss: 0.3692698

best validation loss 0.36926977367438596

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3744736
	speed: 0.0095s/iter; left time: 38.3144s
	iters: 200, epoch: 1 | loss: 0.3364629
	speed: 0.0035s/iter; left time: 13.8619s
	iters: 300, epoch: 1 | loss: 0.8870738
	speed: 0.0032s/iter; left time: 12.2318s
	iters: 400, epoch: 1 | loss: 0.9043940
	speed: 0.0031s/iter; left time: 11.4887s
	iters: 500, epoch: 1 | loss: 0.6916306
	speed: 0.0030s/iter; left time: 10.9626s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 2.02142071723938
Epoch: 1, Steps: 514 | Train Loss: 0.6388070 Vali Loss: 0.3634941 Best vali loss: 0.3634941
	iters: 100, epoch: 2 | loss: 1.0997485
	speed: 0.0070s/iter; left time: 24.5294s
	iters: 200, epoch: 2 | loss: 0.8563116
	speed: 0.0031s/iter; left time: 10.5681s
	iters: 300, epoch: 2 | loss: 1.2965876
	speed: 0.0030s/iter; left time: 9.8904s
	iters: 400, epoch: 2 | loss: 0.3816759
	speed: 0.0031s/iter; left time: 9.8245s
	iters: 500, epoch: 2 | loss: 0.6290401
	speed: 0.0030s/iter; left time: 9.3210s
Updating learning rate to 4.67349404e-05
Epoch: 2 cost time: 1.620893955230713
Epoch: 2, Steps: 514 | Train Loss: 0.8526727 Vali Loss: 0.3636792 Best vali loss: 0.3634941
	iters: 100, epoch: 3 | loss: 1.0513308
	speed: 0.0074s/iter; left time: 22.0112s
	iters: 200, epoch: 3 | loss: 0.7176890
	speed: 0.0037s/iter; left time: 10.5933s
	iters: 300, epoch: 3 | loss: 0.4844642
	speed: 0.0036s/iter; left time: 10.0613s
	iters: 400, epoch: 3 | loss: 0.6530150
	speed: 0.0032s/iter; left time: 8.6715s
	iters: 500, epoch: 3 | loss: 0.2390027
	speed: 0.0029s/iter; left time: 7.6210s
Updating learning rate to 2.33674702e-05
Epoch: 3 cost time: 1.7936010360717773
Epoch: 3, Steps: 514 | Train Loss: 0.6291003 Vali Loss: 0.3697024 Best vali loss: 0.3634941

best validation loss 0.36349414711148426

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3714998
	speed: 0.0107s/iter; left time: 43.0593s
	iters: 200, epoch: 1 | loss: 0.6149608
	speed: 0.0046s/iter; left time: 18.1109s
	iters: 300, epoch: 1 | loss: 0.8161721
	speed: 0.0047s/iter; left time: 17.9610s
	iters: 400, epoch: 1 | loss: 0.9836345
	speed: 0.0051s/iter; left time: 18.9896s
	iters: 500, epoch: 1 | loss: 0.9158736
	speed: 0.0051s/iter; left time: 18.3775s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 2.8510468006134033
Epoch: 1, Steps: 514 | Train Loss: 0.9404281 Vali Loss: 0.3699458 Best vali loss: 0.3699458
	iters: 100, epoch: 2 | loss: 0.5224845
	speed: 0.0098s/iter; left time: 34.3924s
	iters: 200, epoch: 2 | loss: 0.6256947
	speed: 0.0046s/iter; left time: 15.7763s
	iters: 300, epoch: 2 | loss: 0.6947412
	speed: 0.0046s/iter; left time: 15.1239s
	iters: 400, epoch: 2 | loss: 0.4028594
	speed: 0.0046s/iter; left time: 14.5723s
	iters: 500, epoch: 2 | loss: 0.3579559
	speed: 0.0044s/iter; left time: 13.5919s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 2.4036271572113037
Epoch: 2, Steps: 514 | Train Loss: 0.5207472 Vali Loss: 0.3794729 Best vali loss: 0.3699458
	iters: 100, epoch: 3 | loss: 0.3727205
	speed: 0.0099s/iter; left time: 29.4640s
	iters: 200, epoch: 3 | loss: 0.2929347
	speed: 0.0052s/iter; left time: 14.9277s
	iters: 300, epoch: 3 | loss: 0.3652551
	speed: 0.0051s/iter; left time: 14.1562s
	iters: 400, epoch: 3 | loss: 0.3760220
	speed: 0.0048s/iter; left time: 12.7551s
	iters: 500, epoch: 3 | loss: 0.4136873
	speed: 0.0047s/iter; left time: 12.2089s
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 2.6049625873565674
Epoch: 3, Steps: 514 | Train Loss: 0.3641239 Vali Loss: 0.3731183 Best vali loss: 0.3699458

best validation loss 0.3699458176588497

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.3987).  Saving model state dict ...
Epoch: 1 cost time: 0.6776843070983887
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3987017 Best vali loss: 0.3987017
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.3987 --> 0.3795).  Saving model state dict ...
Epoch: 2 cost time: 0.341503381729126
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3795412 Best vali loss: 0.3795412
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.3795 --> 0.3739).  Saving model state dict ...
Epoch: 3 cost time: 0.36665916442871094
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3739405 Best vali loss: 0.3739405

best validation loss 0.37394047228432825

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3296438
	speed: 0.0095s/iter; left time: 23.4714s
	iters: 200, epoch: 4 | loss: 0.3365443
	speed: 0.0031s/iter; left time: 7.4640s
	iters: 300, epoch: 4 | loss: 0.8672776
	speed: 0.0030s/iter; left time: 6.8277s
	iters: 400, epoch: 4 | loss: 0.8629112
	speed: 0.0030s/iter; left time: 6.5831s
	iters: 500, epoch: 4 | loss: 0.6274156
	speed: 0.0030s/iter; left time: 6.3022s
Updating learning rate to 1.16837351e-05
Epoch: 4 cost time: 1.9450244903564453
Epoch: 4, Steps: 514 | Train Loss: 0.6047585 Vali Loss: 0.3733115 Best vali loss: 0.3634941
	iters: 100, epoch: 5 | loss: 1.0654815
	speed: 0.0075s/iter; left time: 14.6000s
	iters: 200, epoch: 5 | loss: 0.7633016
	speed: 0.0035s/iter; left time: 6.4700s
	iters: 300, epoch: 5 | loss: 1.0570933
	speed: 0.0034s/iter; left time: 5.9863s
	iters: 400, epoch: 5 | loss: 0.3869909
	speed: 0.0035s/iter; left time: 5.7749s
	iters: 500, epoch: 5 | loss: 0.6187473
	speed: 0.0035s/iter; left time: 5.4909s
Updating learning rate to 5.84186755e-06
Epoch: 5 cost time: 1.8528647422790527
Epoch: 5, Steps: 514 | Train Loss: 0.7783229 Vali Loss: 0.3748033 Best vali loss: 0.3634941
	iters: 100, epoch: 6 | loss: 1.0015366
	speed: 0.0077s/iter; left time: 11.0575s
	iters: 200, epoch: 6 | loss: 0.6577790
	speed: 0.0033s/iter; left time: 4.4700s
	iters: 300, epoch: 6 | loss: 0.4480232
	speed: 0.0035s/iter; left time: 4.3188s
	iters: 400, epoch: 6 | loss: 0.6411836
	speed: 0.0035s/iter; left time: 4.0524s
	iters: 500, epoch: 6 | loss: 0.2320634
	speed: 0.0034s/iter; left time: 3.4985s
Updating learning rate to 2.920933775e-06
Epoch: 6 cost time: 1.8225679397583008
Epoch: 6, Steps: 514 | Train Loss: 0.5961171 Vali Loss: 0.3781941 Best vali loss: 0.3634941
	iters: 100, epoch: 7 | loss: 0.5885872
	speed: 0.0068s/iter; left time: 6.3444s
	iters: 200, epoch: 7 | loss: 0.3017436
	speed: 0.0030s/iter; left time: 2.5067s
	iters: 300, epoch: 7 | loss: 0.3425338
	speed: 0.0030s/iter; left time: 2.1703s
	iters: 400, epoch: 7 | loss: 0.3366288
	speed: 0.0031s/iter; left time: 1.9631s
	iters: 500, epoch: 7 | loss: 0.8267104
	speed: 0.0030s/iter; left time: 1.5948s
Updating learning rate to 1.4604668875e-06
Epoch: 7 cost time: 1.6041769981384277
Epoch: 7, Steps: 514 | Train Loss: 0.4792407 Vali Loss: 0.3792122 Best vali loss: 0.3634941
	iters: 100, epoch: 8 | loss: 0.5366172
	speed: 0.0075s/iter; left time: 3.0934s
	iters: 200, epoch: 8 | loss: 0.5820164
	speed: 0.0036s/iter; left time: 1.1305s
	iters: 300, epoch: 8 | loss: 0.2507078
	speed: 0.0036s/iter; left time: 0.7764s
	iters: 400, epoch: 8 | loss: 0.7171664
	speed: 0.0036s/iter; left time: 0.4162s
	iters: 500, epoch: 8 | loss: 0.6247669
	speed: 0.0035s/iter; left time: 0.0520s
Updating learning rate to 7.3023344375e-07
Epoch: 8 cost time: 1.8826308250427246
Epoch: 8, Steps: 514 | Train Loss: 0.5422550 Vali Loss: 0.3800122 Best vali loss: 0.3634941

best validation loss 0.36349414711148426

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.4415).  Saving model state dict ...
Epoch: 1 cost time: 0.7160465717315674
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4415352 Best vali loss: 0.4415352
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.4415 --> 0.4317).  Saving model state dict ...
Epoch: 2 cost time: 0.38468408584594727
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4317495 Best vali loss: 0.4317495
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.4317 --> 0.4275).  Saving model state dict ...
Epoch: 3 cost time: 0.40538930892944336
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4274859 Best vali loss: 0.4274859
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.4275 --> 0.4255).  Saving model state dict ...
Epoch: 4 cost time: 0.41400933265686035
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4255213 Best vali loss: 0.4255213
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.4255 --> 0.4246).  Saving model state dict ...
Epoch: 5 cost time: 0.395845890045166
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4245510 Best vali loss: 0.4245510
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.4246 --> 0.4241).  Saving model state dict ...
Epoch: 6 cost time: 0.41193389892578125
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4240567 Best vali loss: 0.4240567
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.4241 --> 0.4238).  Saving model state dict ...
Epoch: 7 cost time: 0.4045548439025879
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4238150 Best vali loss: 0.4238150
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.4238 --> 0.4237).  Saving model state dict ...
Epoch: 8 cost time: 0.3951284885406494
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4236954 Best vali loss: 0.4236954

best validation loss 0.42369542420495937

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5593491
	speed: 0.0109s/iter; left time: 21.2673s
	iters: 200, epoch: 1 | loss: 0.4878121
	speed: 0.0047s/iter; left time: 8.7045s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.3636).  Saving model state dict ...
Epoch: 1 cost time: 1.5602765083312988
Epoch: 1, Steps: 257 | Train Loss: 0.5235806 Vali Loss: 0.3635561 Best vali loss: 0.3635561
	iters: 100, epoch: 2 | loss: 0.4047480
	speed: 0.0099s/iter; left time: 16.8834s
	iters: 200, epoch: 2 | loss: 0.8665576
	speed: 0.0047s/iter; left time: 7.5077s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 1.2436447143554688
Epoch: 2, Steps: 257 | Train Loss: 0.6356528 Vali Loss: 0.3882389 Best vali loss: 0.3635561
	iters: 100, epoch: 3 | loss: 0.5369083
	speed: 0.0094s/iter; left time: 13.6213s
	iters: 200, epoch: 3 | loss: 0.4593700
	speed: 0.0042s/iter; left time: 5.6267s
Updating learning rate to 0.00030491694074585157
Epoch: 3 cost time: 1.1393449306488037
Epoch: 3, Steps: 257 | Train Loss: 0.4981392 Vali Loss: 0.3664640 Best vali loss: 0.3635561
	iters: 100, epoch: 4 | loss: 0.4350224
	speed: 0.0097s/iter; left time: 11.5161s
	iters: 200, epoch: 4 | loss: 0.3297109
	speed: 0.0041s/iter; left time: 4.4160s
Updating learning rate to 0.0002205254895
Epoch: 4 cost time: 1.136836051940918
Epoch: 4, Steps: 257 | Train Loss: 0.3823667 Vali Loss: 0.3672575 Best vali loss: 0.3635561
	iters: 100, epoch: 5 | loss: 0.4564091
	speed: 0.0093s/iter; left time: 8.6788s
	iters: 200, epoch: 5 | loss: 0.5286130
	speed: 0.0046s/iter; left time: 3.8451s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.2215349674224854
Epoch: 5, Steps: 257 | Train Loss: 0.4925111 Vali Loss: 0.3666495 Best vali loss: 0.3635561
	iters: 100, epoch: 6 | loss: 0.5049165
	speed: 0.0097s/iter; left time: 6.4934s
	iters: 200, epoch: 6 | loss: 0.3910816
	speed: 0.0044s/iter; left time: 2.5181s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.1913769245147705
Epoch: 6, Steps: 257 | Train Loss: 0.4479991 Vali Loss: 0.3652903 Best vali loss: 0.3635561
	iters: 100, epoch: 7 | loss: 0.5151481
	speed: 0.0095s/iter; left time: 3.9571s
	iters: 200, epoch: 7 | loss: 0.4454476
	speed: 0.0044s/iter; left time: 1.4015s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.1926722526550293
Epoch: 7, Steps: 257 | Train Loss: 0.4802978 Vali Loss: 0.3684410 Best vali loss: 0.3635561
	iters: 100, epoch: 8 | loss: 0.2318268
	speed: 0.0098s/iter; left time: 1.5467s
	iters: 200, epoch: 8 | loss: 0.5330324
	speed: 0.0047s/iter; left time: 0.2706s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.248983383178711
Epoch: 8, Steps: 257 | Train Loss: 0.3824296 Vali Loss: 0.3708107 Best vali loss: 0.3635561

best validation loss 0.36355611126877235

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1282456
	speed: 0.0117s/iter; left time: 22.9541s
	iters: 200, epoch: 1 | loss: 1.2040408
	speed: 0.0057s/iter; left time: 10.5206s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.3984).  Saving model state dict ...
Epoch: 1 cost time: 1.8186123371124268
Epoch: 1, Steps: 257 | Train Loss: 1.1661432 Vali Loss: 0.3984227 Best vali loss: 0.3984227
	iters: 100, epoch: 2 | loss: 0.9739198
	speed: 0.0124s/iter; left time: 21.1185s
	iters: 200, epoch: 2 | loss: 0.7393582
	speed: 0.0057s/iter; left time: 9.0927s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.3984 --> 0.3965).  Saving model state dict ...
Epoch: 2 cost time: 1.5097906589508057
Epoch: 2, Steps: 257 | Train Loss: 0.8566390 Vali Loss: 0.3964504 Best vali loss: 0.3964504
	iters: 100, epoch: 3 | loss: 0.9693198
	speed: 0.0126s/iter; left time: 18.1224s
	iters: 200, epoch: 3 | loss: 1.0793047
	speed: 0.0057s/iter; left time: 7.5991s
Updating learning rate to 0.0006965792210563318
Epoch: 3 cost time: 1.5028502941131592
Epoch: 3, Steps: 257 | Train Loss: 1.0243122 Vali Loss: 0.4030834 Best vali loss: 0.3964504

best validation loss 0.3964503962539268

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8340769
	speed: 0.0110s/iter; left time: 10.2405s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.3900).  Saving model state dict ...
Epoch: 1 cost time: 0.9717011451721191
Epoch: 1, Steps: 129 | Train Loss: 0.8340769 Vali Loss: 0.3900115 Best vali loss: 0.3900115
	iters: 100, epoch: 2 | loss: 0.7425974
	speed: 0.0082s/iter; left time: 6.5828s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.3900 --> 0.3746).  Saving model state dict ...
Epoch: 2 cost time: 0.6684587001800537
Epoch: 2, Steps: 129 | Train Loss: 0.7425974 Vali Loss: 0.3746162 Best vali loss: 0.3746162
	iters: 100, epoch: 3 | loss: 0.7386699
	speed: 0.0081s/iter; left time: 5.4650s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.3746 --> 0.3707).  Saving model state dict ...
Epoch: 3 cost time: 0.6437554359436035
Epoch: 3, Steps: 129 | Train Loss: 0.7386699 Vali Loss: 0.3707063 Best vali loss: 0.3707063

best validation loss 0.3707062794675059

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6225795
	speed: 0.0090s/iter; left time: 8.3669s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 0.7335555553436279
Epoch: 1, Steps: 129 | Train Loss: 0.6225795 Vali Loss: 0.3663992 Best vali loss: 0.3663992
	iters: 100, epoch: 2 | loss: 0.9467952
	speed: 0.0058s/iter; left time: 4.6375s
Updating learning rate to 0.001511336270922462
Epoch: 2 cost time: 0.42640161514282227
Epoch: 2, Steps: 129 | Train Loss: 0.9467952 Vali Loss: 0.3708995 Best vali loss: 0.3663992
	iters: 100, epoch: 3 | loss: 0.4564782
	speed: 0.0056s/iter; left time: 3.7694s
Updating learning rate to 0.0012241176975961933
Epoch: 3 cost time: 0.41817688941955566
Epoch: 3, Steps: 129 | Train Loss: 0.4564782 Vali Loss: 0.3734127 Best vali loss: 0.3663992

best validation loss 0.3663991639328378

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6250167
	speed: 0.0092s/iter; left time: 5.0125s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 0.7307806015014648
Epoch: 4, Steps: 129 | Train Loss: 0.6250167 Vali Loss: 0.3784525 Best vali loss: 0.3663992
	iters: 100, epoch: 5 | loss: 0.8586056
	speed: 0.0056s/iter; left time: 2.3178s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 0.4229736328125
Epoch: 5, Steps: 129 | Train Loss: 0.8586056 Vali Loss: 0.3805634 Best vali loss: 0.3663992
	iters: 100, epoch: 6 | loss: 0.4458920
	speed: 0.0055s/iter; left time: 1.5856s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 0.41101765632629395
Epoch: 6, Steps: 129 | Train Loss: 0.4458920 Vali Loss: 0.3796711 Best vali loss: 0.3663992
	iters: 100, epoch: 7 | loss: 0.6140592
	speed: 0.0057s/iter; left time: 0.9097s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 0.4166147708892822
Epoch: 7, Steps: 129 | Train Loss: 0.6140592 Vali Loss: 0.3830563 Best vali loss: 0.3663992
	iters: 100, epoch: 8 | loss: 0.6226791
	speed: 0.0056s/iter; left time: 0.1688s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4317474365234375
Epoch: 8, Steps: 129 | Train Loss: 0.6226791 Vali Loss: 0.3822576 Best vali loss: 0.3663992

best validation loss 0.3663991639328378

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4828491
	speed: 0.0110s/iter; left time: 89.0646s
	iters: 200, epoch: 1 | loss: 0.8938119
	speed: 0.0050s/iter; left time: 40.2902s
	iters: 300, epoch: 1 | loss: 0.5186536
	speed: 0.0050s/iter; left time: 39.7052s
	iters: 400, epoch: 1 | loss: 0.4501030
	speed: 0.0050s/iter; left time: 38.7705s
	iters: 500, epoch: 1 | loss: 1.0844506
	speed: 0.0048s/iter; left time: 37.3904s
	iters: 600, epoch: 1 | loss: 0.5756102
	speed: 0.0050s/iter; left time: 38.0940s
	iters: 700, epoch: 1 | loss: 1.6774460
	speed: 0.0050s/iter; left time: 37.6768s
	iters: 800, epoch: 1 | loss: 1.1043514
	speed: 0.0050s/iter; left time: 37.3916s
	iters: 900, epoch: 1 | loss: 0.8346955
	speed: 0.0050s/iter; left time: 36.6567s
	iters: 1000, epoch: 1 | loss: 1.1425103
	speed: 0.0050s/iter; left time: 36.0695s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.3864).  Saving model state dict ...
Epoch: 1 cost time: 5.457832098007202
Epoch: 1, Steps: 1027 | Train Loss: 0.8764482 Vali Loss: 0.3863761 Best vali loss: 0.3863761
	iters: 100, epoch: 2 | loss: 1.1064260
	speed: 0.0129s/iter; left time: 91.5442s
	iters: 200, epoch: 2 | loss: 1.0100328
	speed: 0.0050s/iter; left time: 35.0888s
	iters: 300, epoch: 2 | loss: 0.8034941
	speed: 0.0050s/iter; left time: 34.5942s
	iters: 400, epoch: 2 | loss: 0.3368133
	speed: 0.0050s/iter; left time: 33.9911s
	iters: 500, epoch: 2 | loss: 0.4145169
	speed: 0.0050s/iter; left time: 33.6752s
	iters: 600, epoch: 2 | loss: 0.8688010
	speed: 0.0050s/iter; left time: 33.0584s
	iters: 700, epoch: 2 | loss: 0.8840261
	speed: 0.0050s/iter; left time: 32.7300s
	iters: 800, epoch: 2 | loss: 0.3851993
	speed: 0.0050s/iter; left time: 32.0208s
	iters: 900, epoch: 2 | loss: 0.4052722
	speed: 0.0050s/iter; left time: 31.6974s
	iters: 1000, epoch: 2 | loss: 1.0799608
	speed: 0.0050s/iter; left time: 31.0154s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.3864 --> 0.3713).  Saving model state dict ...
Epoch: 2 cost time: 5.197659254074097
Epoch: 2, Steps: 1027 | Train Loss: 0.7294543 Vali Loss: 0.3712722 Best vali loss: 0.3712722
	iters: 100, epoch: 3 | loss: 0.3704675
	speed: 0.0127s/iter; left time: 76.9280s
	iters: 200, epoch: 3 | loss: 0.3295871
	speed: 0.0050s/iter; left time: 29.8794s
	iters: 300, epoch: 3 | loss: 0.8506183
	speed: 0.0050s/iter; left time: 29.3004s
	iters: 400, epoch: 3 | loss: 0.2838045
	speed: 0.0050s/iter; left time: 28.8758s
	iters: 500, epoch: 3 | loss: 1.2732731
	speed: 0.0050s/iter; left time: 28.3350s
	iters: 600, epoch: 3 | loss: 0.6681860
	speed: 0.0050s/iter; left time: 27.8354s
	iters: 700, epoch: 3 | loss: 0.4858724
	speed: 0.0050s/iter; left time: 27.3373s
	iters: 800, epoch: 3 | loss: 0.2185889
	speed: 0.0050s/iter; left time: 26.8531s
	iters: 900, epoch: 3 | loss: 1.7050868
	speed: 0.0050s/iter; left time: 26.3898s
	iters: 1000, epoch: 3 | loss: 1.2808511
	speed: 0.0049s/iter; left time: 25.5163s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.3713 --> 0.3672).  Saving model state dict ...
Epoch: 3 cost time: 5.175989151000977
Epoch: 3, Steps: 1027 | Train Loss: 0.7466336 Vali Loss: 0.3671569 Best vali loss: 0.3671569
	iters: 100, epoch: 4 | loss: 0.8811607
	speed: 0.0130s/iter; left time: 65.2900s
	iters: 200, epoch: 4 | loss: 0.2596255
	speed: 0.0050s/iter; left time: 24.4942s
	iters: 300, epoch: 4 | loss: 0.2427701
	speed: 0.0048s/iter; left time: 22.9718s
	iters: 400, epoch: 4 | loss: 0.3884118
	speed: 0.0048s/iter; left time: 22.5189s
	iters: 500, epoch: 4 | loss: 1.8483503
	speed: 0.0048s/iter; left time: 22.1653s
	iters: 600, epoch: 4 | loss: 0.4473726
	speed: 0.0047s/iter; left time: 21.3875s
	iters: 700, epoch: 4 | loss: 1.0749229
	speed: 0.0048s/iter; left time: 21.2145s
	iters: 800, epoch: 4 | loss: 0.3633347
	speed: 0.0047s/iter; left time: 20.4604s
	iters: 900, epoch: 4 | loss: 0.3701347
	speed: 0.0045s/iter; left time: 18.9373s
	iters: 1000, epoch: 4 | loss: 0.2704269
	speed: 0.0045s/iter; left time: 18.5909s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.3672 --> 0.3656).  Saving model state dict ...
Epoch: 4 cost time: 4.907222509384155
Epoch: 4, Steps: 1027 | Train Loss: 0.6146510 Vali Loss: 0.3655695 Best vali loss: 0.3655695
	iters: 100, epoch: 5 | loss: 0.5061538
	speed: 0.0124s/iter; left time: 49.7218s
	iters: 200, epoch: 5 | loss: 0.3633237
	speed: 0.0046s/iter; left time: 18.0473s
	iters: 300, epoch: 5 | loss: 1.5285412
	speed: 0.0047s/iter; left time: 17.8600s
	iters: 400, epoch: 5 | loss: 0.3885072
	speed: 0.0047s/iter; left time: 17.3939s
	iters: 500, epoch: 5 | loss: 0.3224014
	speed: 0.0045s/iter; left time: 16.2038s
	iters: 600, epoch: 5 | loss: 0.3253991
	speed: 0.0045s/iter; left time: 15.7558s
	iters: 700, epoch: 5 | loss: 0.2767173
	speed: 0.0045s/iter; left time: 15.4744s
	iters: 800, epoch: 5 | loss: 1.1959660
	speed: 0.0045s/iter; left time: 14.8052s
	iters: 900, epoch: 5 | loss: 0.4563395
	speed: 0.0045s/iter; left time: 14.4511s
	iters: 1000, epoch: 5 | loss: 1.5256168
	speed: 0.0044s/iter; left time: 13.8340s
Updating learning rate to 2.8686326433764354e-05
Validation loss decreased (0.3656 --> 0.3647).  Saving model state dict ...
Epoch: 5 cost time: 4.720979928970337
Epoch: 5, Steps: 1027 | Train Loss: 0.6888966 Vali Loss: 0.3646945 Best vali loss: 0.3646945
	iters: 100, epoch: 6 | loss: 1.0671182
	speed: 0.0125s/iter; left time: 37.1950s
	iters: 200, epoch: 6 | loss: 0.5836148
	speed: 0.0048s/iter; left time: 13.7891s
	iters: 300, epoch: 6 | loss: 0.1496255
	speed: 0.0048s/iter; left time: 13.4009s
	iters: 400, epoch: 6 | loss: 1.2937176
	speed: 0.0048s/iter; left time: 12.8808s
	iters: 500, epoch: 6 | loss: 0.2790983
	speed: 0.0049s/iter; left time: 12.5623s
	iters: 600, epoch: 6 | loss: 0.3941697
	speed: 0.0049s/iter; left time: 12.0845s
	iters: 700, epoch: 6 | loss: 1.6247189
	speed: 0.0048s/iter; left time: 11.4140s
	iters: 800, epoch: 6 | loss: 0.9723973
	speed: 0.0049s/iter; left time: 11.0767s
	iters: 900, epoch: 6 | loss: 0.4711756
	speed: 0.0048s/iter; left time: 10.5519s
	iters: 1000, epoch: 6 | loss: 0.4554365
	speed: 0.0048s/iter; left time: 10.0553s
Updating learning rate to 1.3610570209234607e-05
Validation loss decreased (0.3647 --> 0.3647).  Saving model state dict ...
Epoch: 6 cost time: 4.999430418014526
Epoch: 6, Steps: 1027 | Train Loss: 0.7291072 Vali Loss: 0.3646532 Best vali loss: 0.3646532
	iters: 100, epoch: 7 | loss: 0.6457511
	speed: 0.0126s/iter; left time: 24.7104s
	iters: 200, epoch: 7 | loss: 0.3901793
	speed: 0.0050s/iter; left time: 9.2781s
	iters: 300, epoch: 7 | loss: 0.3457962
	speed: 0.0050s/iter; left time: 8.7575s
	iters: 400, epoch: 7 | loss: 1.1233833
	speed: 0.0049s/iter; left time: 8.1435s
	iters: 500, epoch: 7 | loss: 0.2289376
	speed: 0.0049s/iter; left time: 7.6791s
	iters: 600, epoch: 7 | loss: 0.3362229
	speed: 0.0050s/iter; left time: 7.2471s
	iters: 700, epoch: 7 | loss: 0.2013416
	speed: 0.0050s/iter; left time: 6.7907s
	iters: 800, epoch: 7 | loss: 0.5779591
	speed: 0.0050s/iter; left time: 6.2734s
	iters: 900, epoch: 7 | loss: 0.9789472
	speed: 0.0050s/iter; left time: 5.7416s
	iters: 1000, epoch: 7 | loss: 0.5168291
	speed: 0.0048s/iter; left time: 5.1127s
Updating learning rate to 3.5372719495249264e-06
Epoch: 7 cost time: 5.132070064544678
Epoch: 7, Steps: 1027 | Train Loss: 0.5345347 Vali Loss: 0.3650226 Best vali loss: 0.3646532
	iters: 100, epoch: 8 | loss: 0.4683261
	speed: 0.0122s/iter; left time: 11.3561s
	iters: 200, epoch: 8 | loss: 1.0549248
	speed: 0.0044s/iter; left time: 3.6798s
	iters: 300, epoch: 8 | loss: 0.3481911
	speed: 0.0044s/iter; left time: 3.2150s
	iters: 400, epoch: 8 | loss: 0.6176281
	speed: 0.0045s/iter; left time: 2.7970s
	iters: 500, epoch: 8 | loss: 0.6897715
	speed: 0.0044s/iter; left time: 2.3454s
	iters: 600, epoch: 8 | loss: 0.4340421
	speed: 0.0044s/iter; left time: 1.8939s
	iters: 700, epoch: 8 | loss: 0.5165336
	speed: 0.0044s/iter; left time: 1.4557s
	iters: 800, epoch: 8 | loss: 1.5968174
	speed: 0.0044s/iter; left time: 1.0092s
	iters: 900, epoch: 8 | loss: 1.7982966
	speed: 0.0044s/iter; left time: 0.5686s
	iters: 1000, epoch: 8 | loss: 0.3465717
	speed: 0.0044s/iter; left time: 0.1243s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.5989203453063965
Epoch: 8, Steps: 1027 | Train Loss: 0.7871103 Vali Loss: 0.3650124 Best vali loss: 0.3646532

best validation loss 0.3646532474777319

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8089677
	speed: 0.0137s/iter; left time: 26.7735s
	iters: 200, epoch: 1 | loss: 0.7192074
	speed: 0.0076s/iter; left time: 14.0632s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 2.3158721923828125
Epoch: 1, Steps: 257 | Train Loss: 0.7640876 Vali Loss: 0.3713627 Best vali loss: 0.3713627
	iters: 100, epoch: 2 | loss: 0.5889417
	speed: 0.0158s/iter; left time: 26.8502s
	iters: 200, epoch: 2 | loss: 0.3032589
	speed: 0.0076s/iter; left time: 12.1471s
Updating learning rate to 5.35870624e-05
Epoch: 2 cost time: 1.9853427410125732
Epoch: 2, Steps: 257 | Train Loss: 0.4461003 Vali Loss: 0.3805041 Best vali loss: 0.3713627
	iters: 100, epoch: 3 | loss: 0.3896523
	speed: 0.0153s/iter; left time: 22.1217s
	iters: 200, epoch: 3 | loss: 0.3625952
	speed: 0.0076s/iter; left time: 10.1755s
Updating learning rate to 2.67935312e-05
Validation loss decreased (0.3714 --> 0.3577).  Saving model state dict ...
Epoch: 3 cost time: 1.9821691513061523
Epoch: 3, Steps: 257 | Train Loss: 0.3761238 Vali Loss: 0.3577126 Best vali loss: 0.3577126
	iters: 100, epoch: 4 | loss: 0.5012105
	speed: 0.0165s/iter; left time: 19.5369s
	iters: 200, epoch: 4 | loss: 0.3366272
	speed: 0.0075s/iter; left time: 8.1827s
Updating learning rate to 1.33967656e-05
Validation loss decreased (0.3577 --> 0.3514).  Saving model state dict ...
Epoch: 4 cost time: 2.0070481300354004
Epoch: 4, Steps: 257 | Train Loss: 0.4189189 Vali Loss: 0.3514088 Best vali loss: 0.3514088
	iters: 100, epoch: 5 | loss: 0.5434762
	speed: 0.0162s/iter; left time: 15.0658s
	iters: 200, epoch: 5 | loss: 0.4726962
	speed: 0.0075s/iter; left time: 6.2221s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 1.9963748455047607
Epoch: 5, Steps: 257 | Train Loss: 0.5080862 Vali Loss: 0.3522208 Best vali loss: 0.3514088
	iters: 100, epoch: 6 | loss: 0.4404662
	speed: 0.0155s/iter; left time: 10.3875s
	iters: 200, epoch: 6 | loss: 0.4325276
	speed: 0.0076s/iter; left time: 4.3399s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 1.9964594841003418
Epoch: 6, Steps: 257 | Train Loss: 0.4364969 Vali Loss: 0.3525000 Best vali loss: 0.3514088
	iters: 100, epoch: 7 | loss: 0.5102656
	speed: 0.0155s/iter; left time: 6.4147s
	iters: 200, epoch: 7 | loss: 0.9031568
	speed: 0.0075s/iter; left time: 2.3705s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 1.9834554195404053
Epoch: 7, Steps: 257 | Train Loss: 0.7067112 Vali Loss: 0.3528084 Best vali loss: 0.3514088
	iters: 100, epoch: 8 | loss: 0.4825470
	speed: 0.0155s/iter; left time: 2.4544s
	iters: 200, epoch: 8 | loss: 0.2936374
	speed: 0.0076s/iter; left time: 0.4426s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 2.010183572769165
Epoch: 8, Steps: 257 | Train Loss: 0.3880922 Vali Loss: 0.3520820 Best vali loss: 0.3514088

best validation loss 0.35140876439793406

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6289396
	speed: 0.0094s/iter; left time: 37.6151s
	iters: 200, epoch: 1 | loss: 0.7205679
	speed: 0.0033s/iter; left time: 12.8669s
	iters: 300, epoch: 1 | loss: 0.3349874
	speed: 0.0032s/iter; left time: 12.0469s
	iters: 400, epoch: 1 | loss: 0.3261111
	speed: 0.0030s/iter; left time: 11.2065s
	iters: 500, epoch: 1 | loss: 0.6149021
	speed: 0.0031s/iter; left time: 11.1282s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.987393856048584
Epoch: 1, Steps: 514 | Train Loss: 0.5251016 Vali Loss: 0.3675573 Best vali loss: 0.3675573
	iters: 100, epoch: 2 | loss: 0.8457320
	speed: 0.0072s/iter; left time: 25.1885s
	iters: 200, epoch: 2 | loss: 0.3567826
	speed: 0.0032s/iter; left time: 10.7375s
	iters: 300, epoch: 2 | loss: 0.6037887
	speed: 0.0032s/iter; left time: 10.4669s
	iters: 400, epoch: 2 | loss: 0.6899884
	speed: 0.0029s/iter; left time: 9.3492s
	iters: 500, epoch: 2 | loss: 0.8107616
	speed: 0.0029s/iter; left time: 9.0809s
Updating learning rate to 0.00014998138555
Validation loss decreased (0.3676 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 1.6182324886322021
Epoch: 2, Steps: 514 | Train Loss: 0.6614106 Vali Loss: 0.3667954 Best vali loss: 0.3667954
	iters: 100, epoch: 3 | loss: 0.6616642
	speed: 0.0073s/iter; left time: 21.6857s
	iters: 200, epoch: 3 | loss: 0.7344151
	speed: 0.0030s/iter; left time: 8.6844s
	iters: 300, epoch: 3 | loss: 0.5603880
	speed: 0.0032s/iter; left time: 8.9972s
	iters: 400, epoch: 3 | loss: 0.4779296
	speed: 0.0031s/iter; left time: 8.4518s
	iters: 500, epoch: 3 | loss: 0.6607732
	speed: 0.0031s/iter; left time: 7.9910s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 1.6562774181365967
Epoch: 3, Steps: 514 | Train Loss: 0.6190340 Vali Loss: 0.3720565 Best vali loss: 0.3667954

best validation loss 0.3667953635948346

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9478106
	speed: 0.0100s/iter; left time: 19.5429s
	iters: 200, epoch: 1 | loss: 0.7372931
	speed: 0.0035s/iter; left time: 6.5759s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 1.308696985244751
Epoch: 1, Steps: 257 | Train Loss: 0.8425519 Vali Loss: 0.3686311 Best vali loss: 0.3686311
	iters: 100, epoch: 2 | loss: 0.7111989
	speed: 0.0086s/iter; left time: 14.5807s
	iters: 200, epoch: 2 | loss: 0.6366681
	speed: 0.0038s/iter; left time: 6.0473s
Updating learning rate to 0.0005873811600929365
Epoch: 2 cost time: 1.0096266269683838
Epoch: 2, Steps: 257 | Train Loss: 0.6739335 Vali Loss: 0.3702041 Best vali loss: 0.3686311
	iters: 100, epoch: 3 | loss: 0.7454016
	speed: 0.0082s/iter; left time: 11.8985s
	iters: 200, epoch: 3 | loss: 0.7285029
	speed: 0.0034s/iter; left time: 4.5267s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 0.9395627975463867
Epoch: 3, Steps: 257 | Train Loss: 0.7369522 Vali Loss: 0.3729749 Best vali loss: 0.3686311

best validation loss 0.3686311482797671

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 1.1311652660369873
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3674673 Best vali loss: 0.3674673
Updating learning rate to 0.0003362272142
Validation loss decreased (0.3675 --> 0.3662).  Saving model state dict ...
Epoch: 2 cost time: 0.7955412864685059
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3662016 Best vali loss: 0.3662016
Updating learning rate to 0.0001681136071
Validation loss decreased (0.3662 --> 0.3588).  Saving model state dict ...
Epoch: 3 cost time: 0.7922763824462891
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3588230 Best vali loss: 0.3588230

best validation loss 0.35882295490716437

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.405680355e-05
Validation loss decreased (0.3588 --> 0.3564).  Saving model state dict ...
Epoch: 4 cost time: 1.1096851825714111
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3563777 Best vali loss: 0.3563777
Updating learning rate to 4.2028401775e-05
Validation loss decreased (0.3564 --> 0.3502).  Saving model state dict ...
Epoch: 5 cost time: 0.7900295257568359
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3502312 Best vali loss: 0.3502312
Updating learning rate to 2.10142008875e-05
Validation loss decreased (0.3502 --> 0.3436).  Saving model state dict ...
Epoch: 6 cost time: 0.7974045276641846
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3435992 Best vali loss: 0.3435992
Updating learning rate to 1.050710044375e-05
Validation loss decreased (0.3436 --> 0.3420).  Saving model state dict ...
Epoch: 7 cost time: 0.7923474311828613
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3420000 Best vali loss: 0.3420000
Updating learning rate to 5.253550221875e-06
Epoch: 8 cost time: 0.798356294631958
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3425172 Best vali loss: 0.3420000

best validation loss 0.34199999968991535

[INFO][abstract_intensifier.py:595] Added config 508807 and rejected config 27f795 as incumbent because it is not better than the incumbents on 1 instances:
[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9533066
	speed: 0.0102s/iter; left time: 82.3933s
	iters: 200, epoch: 1 | loss: 0.3490335
	speed: 0.0040s/iter; left time: 31.9868s
	iters: 300, epoch: 1 | loss: 0.4093514
	speed: 0.0040s/iter; left time: 31.5179s
	iters: 400, epoch: 1 | loss: 0.4004975
	speed: 0.0040s/iter; left time: 31.2785s
	iters: 500, epoch: 1 | loss: 0.7025905
	speed: 0.0040s/iter; left time: 30.9452s
	iters: 600, epoch: 1 | loss: 0.5110208
	speed: 0.0037s/iter; left time: 27.8214s
	iters: 700, epoch: 1 | loss: 0.2275507
	speed: 0.0038s/iter; left time: 28.7603s
	iters: 800, epoch: 1 | loss: 0.3672069
	speed: 0.0039s/iter; left time: 29.2705s
	iters: 900, epoch: 1 | loss: 1.0426775
	speed: 0.0040s/iter; left time: 29.2724s
	iters: 1000, epoch: 1 | loss: 0.4722669
	speed: 0.0040s/iter; left time: 28.5858s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 4.419790506362915
Epoch: 1, Steps: 1027 | Train Loss: 0.5435502 Vali Loss: 0.3709617 Best vali loss: 0.3709617
	iters: 100, epoch: 2 | loss: 1.2018995
	speed: 0.0115s/iter; left time: 81.3591s
	iters: 200, epoch: 2 | loss: 0.2060604
	speed: 0.0040s/iter; left time: 28.2421s
	iters: 300, epoch: 2 | loss: 1.1248729
	speed: 0.0040s/iter; left time: 27.3554s
	iters: 400, epoch: 2 | loss: 0.5416353
	speed: 0.0039s/iter; left time: 26.5901s
	iters: 500, epoch: 2 | loss: 0.7307010
	speed: 0.0040s/iter; left time: 26.9615s
	iters: 600, epoch: 2 | loss: 0.2937225
	speed: 0.0039s/iter; left time: 25.7115s
	iters: 700, epoch: 2 | loss: 0.9318615
	speed: 0.0037s/iter; left time: 24.1607s
	iters: 800, epoch: 2 | loss: 0.4671137
	speed: 0.0037s/iter; left time: 23.7584s
	iters: 900, epoch: 2 | loss: 0.8661247
	speed: 0.0037s/iter; left time: 23.5715s
	iters: 1000, epoch: 2 | loss: 0.5038300
	speed: 0.0039s/iter; left time: 23.8580s
Updating learning rate to 5.854811365e-05
Validation loss decreased (0.3710 --> 0.3695).  Saving model state dict ...
Epoch: 2 cost time: 4.050741910934448
Epoch: 2, Steps: 1027 | Train Loss: 0.6867822 Vali Loss: 0.3694648 Best vali loss: 0.3694648
	iters: 100, epoch: 3 | loss: 0.7940463
	speed: 0.0109s/iter; left time: 66.3135s
	iters: 200, epoch: 3 | loss: 2.2169280
	speed: 0.0035s/iter; left time: 21.0896s
	iters: 300, epoch: 3 | loss: 1.2893187
	speed: 0.0035s/iter; left time: 20.6401s
	iters: 400, epoch: 3 | loss: 0.4143751
	speed: 0.0035s/iter; left time: 20.3109s
	iters: 500, epoch: 3 | loss: 0.9961408
	speed: 0.0035s/iter; left time: 19.9062s
	iters: 600, epoch: 3 | loss: 0.4387808
	speed: 0.0035s/iter; left time: 19.5953s
	iters: 700, epoch: 3 | loss: 1.0496210
	speed: 0.0035s/iter; left time: 19.3865s
	iters: 800, epoch: 3 | loss: 0.2340948
	speed: 0.0035s/iter; left time: 18.7509s
	iters: 900, epoch: 3 | loss: 0.4016962
	speed: 0.0035s/iter; left time: 18.4536s
	iters: 1000, epoch: 3 | loss: 0.2903975
	speed: 0.0036s/iter; left time: 18.6484s
Updating learning rate to 2.9274056825e-05
Validation loss decreased (0.3695 --> 0.3683).  Saving model state dict ...
Epoch: 3 cost time: 3.7143023014068604
Epoch: 3, Steps: 1027 | Train Loss: 0.8125399 Vali Loss: 0.3683419 Best vali loss: 0.3683419
	iters: 100, epoch: 4 | loss: 0.5964856
	speed: 0.0114s/iter; left time: 57.4396s
	iters: 200, epoch: 4 | loss: 1.3215406
	speed: 0.0040s/iter; left time: 19.8110s
	iters: 300, epoch: 4 | loss: 0.3896323
	speed: 0.0039s/iter; left time: 18.9324s
	iters: 400, epoch: 4 | loss: 0.8353835
	speed: 0.0040s/iter; left time: 18.9283s
	iters: 500, epoch: 4 | loss: 0.3089079
	speed: 0.0040s/iter; left time: 18.5431s
	iters: 600, epoch: 4 | loss: 1.1276971
	speed: 0.0040s/iter; left time: 18.1419s
	iters: 700, epoch: 4 | loss: 0.3933674
	speed: 0.0040s/iter; left time: 17.7450s
	iters: 800, epoch: 4 | loss: 0.5535288
	speed: 0.0040s/iter; left time: 17.3445s
	iters: 900, epoch: 4 | loss: 0.8961644
	speed: 0.0040s/iter; left time: 16.7727s
	iters: 1000, epoch: 4 | loss: 0.4499300
	speed: 0.0040s/iter; left time: 16.4545s
Updating learning rate to 1.46370284125e-05
Epoch: 4 cost time: 4.157747507095337
Epoch: 4, Steps: 1027 | Train Loss: 0.6872638 Vali Loss: 0.3692773 Best vali loss: 0.3683419
	iters: 100, epoch: 5 | loss: 0.2374354
	speed: 0.0114s/iter; left time: 45.5840s
	iters: 200, epoch: 5 | loss: 1.2613447
	speed: 0.0042s/iter; left time: 16.5611s
	iters: 300, epoch: 5 | loss: 0.3067903
	speed: 0.0042s/iter; left time: 15.9207s
	iters: 400, epoch: 5 | loss: 0.5110688
	speed: 0.0044s/iter; left time: 16.3917s
	iters: 500, epoch: 5 | loss: 0.6610277
	speed: 0.0043s/iter; left time: 15.6386s
	iters: 600, epoch: 5 | loss: 0.4879997
	speed: 0.0043s/iter; left time: 15.1145s
	iters: 700, epoch: 5 | loss: 0.2698348
	speed: 0.0042s/iter; left time: 14.2377s
	iters: 800, epoch: 5 | loss: 0.5744744
	speed: 0.0044s/iter; left time: 14.4931s
	iters: 900, epoch: 5 | loss: 0.9458831
	speed: 0.0043s/iter; left time: 13.9503s
	iters: 1000, epoch: 5 | loss: 0.5918203
	speed: 0.0043s/iter; left time: 13.2815s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 4.4475555419921875
Epoch: 5, Steps: 1027 | Train Loss: 0.5847679 Vali Loss: 0.3696128 Best vali loss: 0.3683419
	iters: 100, epoch: 6 | loss: 0.5925527
	speed: 0.0114s/iter; left time: 34.0246s
	iters: 200, epoch: 6 | loss: 0.6823747
	speed: 0.0039s/iter; left time: 11.3592s
	iters: 300, epoch: 6 | loss: 0.7262231
	speed: 0.0040s/iter; left time: 11.1522s
	iters: 400, epoch: 6 | loss: 0.3939514
	speed: 0.0040s/iter; left time: 10.7297s
	iters: 500, epoch: 6 | loss: 0.4467021
	speed: 0.0040s/iter; left time: 10.3271s
	iters: 600, epoch: 6 | loss: 0.5265162
	speed: 0.0039s/iter; left time: 9.7810s
	iters: 700, epoch: 6 | loss: 1.2382574
	speed: 0.0040s/iter; left time: 9.5030s
	iters: 800, epoch: 6 | loss: 0.6659690
	speed: 0.0040s/iter; left time: 9.0650s
	iters: 900, epoch: 6 | loss: 0.3179937
	speed: 0.0040s/iter; left time: 8.6380s
	iters: 1000, epoch: 6 | loss: 1.2463776
	speed: 0.0040s/iter; left time: 8.3123s
Updating learning rate to 3.659257103125e-06
Epoch: 6 cost time: 4.141578912734985
Epoch: 6, Steps: 1027 | Train Loss: 0.6836918 Vali Loss: 0.3693978 Best vali loss: 0.3683419
	iters: 100, epoch: 7 | loss: 0.5123788
	speed: 0.0113s/iter; left time: 22.0088s
	iters: 200, epoch: 7 | loss: 1.1136051
	speed: 0.0039s/iter; left time: 7.3092s
	iters: 300, epoch: 7 | loss: 0.6499878
	speed: 0.0039s/iter; left time: 6.8583s
	iters: 400, epoch: 7 | loss: 0.6433576
	speed: 0.0039s/iter; left time: 6.5231s
	iters: 500, epoch: 7 | loss: 1.0739437
	speed: 0.0039s/iter; left time: 6.0686s
	iters: 600, epoch: 7 | loss: 0.7681280
	speed: 0.0040s/iter; left time: 5.7684s
	iters: 700, epoch: 7 | loss: 0.2981442
	speed: 0.0039s/iter; left time: 5.3173s
	iters: 800, epoch: 7 | loss: 0.6845956
	speed: 0.0039s/iter; left time: 4.8904s
	iters: 900, epoch: 7 | loss: 0.3813614
	speed: 0.0039s/iter; left time: 4.5329s
	iters: 1000, epoch: 7 | loss: 0.3870303
	speed: 0.0039s/iter; left time: 4.1276s
Updating learning rate to 1.8296285515625e-06
Epoch: 7 cost time: 4.086512088775635
Epoch: 7, Steps: 1027 | Train Loss: 0.6512533 Vali Loss: 0.3696719 Best vali loss: 0.3683419
	iters: 100, epoch: 8 | loss: 0.7172000
	speed: 0.0112s/iter; left time: 10.3530s
	iters: 200, epoch: 8 | loss: 1.2934775
	speed: 0.0040s/iter; left time: 3.3046s
	iters: 300, epoch: 8 | loss: 0.7899531
	speed: 0.0040s/iter; left time: 2.8976s
	iters: 400, epoch: 8 | loss: 0.8028952
	speed: 0.0040s/iter; left time: 2.5121s
	iters: 500, epoch: 8 | loss: 0.9885253
	speed: 0.0040s/iter; left time: 2.1123s
	iters: 600, epoch: 8 | loss: 0.2245831
	speed: 0.0039s/iter; left time: 1.6893s
	iters: 700, epoch: 8 | loss: 0.8107164
	speed: 0.0039s/iter; left time: 1.2782s
	iters: 800, epoch: 8 | loss: 0.5828140
	speed: 0.0039s/iter; left time: 0.9003s
	iters: 900, epoch: 8 | loss: 1.5702665
	speed: 0.0040s/iter; left time: 0.5076s
	iters: 1000, epoch: 8 | loss: 1.6589888
	speed: 0.0040s/iter; left time: 0.1121s
Updating learning rate to 9.1481427578125e-07
Epoch: 8 cost time: 4.140629291534424
Epoch: 8, Steps: 1027 | Train Loss: 0.9439420 Vali Loss: 0.3696792 Best vali loss: 0.3683419

best validation loss 0.3683419099256894

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4625934
	speed: 0.0136s/iter; left time: 26.5407s
	iters: 200, epoch: 1 | loss: 0.5493234
	speed: 0.0071s/iter; left time: 13.2589s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 2.227902889251709
Epoch: 1, Steps: 257 | Train Loss: 0.5059584 Vali Loss: 0.3672982 Best vali loss: 0.3672982
	iters: 100, epoch: 2 | loss: 0.5997803
	speed: 0.0151s/iter; left time: 25.7355s
	iters: 200, epoch: 2 | loss: 0.6827573
	speed: 0.0072s/iter; left time: 11.5482s
Updating learning rate to 4.073901425e-05
Epoch: 2 cost time: 1.89955735206604
Epoch: 2, Steps: 257 | Train Loss: 0.6412688 Vali Loss: 0.3975929 Best vali loss: 0.3672982
	iters: 100, epoch: 3 | loss: 0.5861010
	speed: 0.0147s/iter; left time: 21.1560s
	iters: 200, epoch: 3 | loss: 0.6312942
	speed: 0.0071s/iter; left time: 9.5488s
Updating learning rate to 2.0369507125e-05
Epoch: 3 cost time: 1.862252950668335
Epoch: 3, Steps: 257 | Train Loss: 0.6086976 Vali Loss: 0.3755197 Best vali loss: 0.3672982
	iters: 100, epoch: 4 | loss: 0.3598687
	speed: 0.0147s/iter; left time: 17.3883s
	iters: 200, epoch: 4 | loss: 0.5892345
	speed: 0.0071s/iter; left time: 7.6987s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 1.8639638423919678
Epoch: 4, Steps: 257 | Train Loss: 0.4745516 Vali Loss: 0.3817162 Best vali loss: 0.3672982
	iters: 100, epoch: 5 | loss: 0.4775228
	speed: 0.0146s/iter; left time: 13.5487s
	iters: 200, epoch: 5 | loss: 0.4406305
	speed: 0.0071s/iter; left time: 5.8661s
Updating learning rate to 5.09237678125e-06
Epoch: 5 cost time: 1.862257957458496
Epoch: 5, Steps: 257 | Train Loss: 0.4590766 Vali Loss: 0.3911834 Best vali loss: 0.3672982
	iters: 100, epoch: 6 | loss: 0.5631643
	speed: 0.0146s/iter; left time: 9.7911s
	iters: 200, epoch: 6 | loss: 0.3196456
	speed: 0.0071s/iter; left time: 4.0511s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 1.8642685413360596
Epoch: 6, Steps: 257 | Train Loss: 0.4414049 Vali Loss: 0.3873466 Best vali loss: 0.3672982
	iters: 100, epoch: 7 | loss: 0.2849335
	speed: 0.0145s/iter; left time: 6.0155s
	iters: 200, epoch: 7 | loss: 0.4175725
	speed: 0.0071s/iter; left time: 2.2220s
Updating learning rate to 1.2730941953125e-06
Epoch: 7 cost time: 1.859323501586914
Epoch: 7, Steps: 257 | Train Loss: 0.3512530 Vali Loss: 0.3865141 Best vali loss: 0.3672982
	iters: 100, epoch: 8 | loss: 0.3254045
	speed: 0.0146s/iter; left time: 2.3108s
	iters: 200, epoch: 8 | loss: 0.6737150
	speed: 0.0071s/iter; left time: 0.4110s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 1.8686254024505615
Epoch: 8, Steps: 257 | Train Loss: 0.4995598 Vali Loss: 0.3847957 Best vali loss: 0.3672982

best validation loss 0.36729818363555056

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4137295
	speed: 0.0114s/iter; left time: 92.2614s
	iters: 200, epoch: 1 | loss: 0.7921283
	speed: 0.0051s/iter; left time: 40.5006s
	iters: 300, epoch: 1 | loss: 0.4966547
	speed: 0.0048s/iter; left time: 38.0456s
	iters: 400, epoch: 1 | loss: 0.4411487
	speed: 0.0048s/iter; left time: 37.3498s
	iters: 500, epoch: 1 | loss: 1.0970889
	speed: 0.0048s/iter; left time: 37.3224s
	iters: 600, epoch: 1 | loss: 0.5580640
	speed: 0.0048s/iter; left time: 36.3668s
	iters: 700, epoch: 1 | loss: 1.6732651
	speed: 0.0048s/iter; left time: 36.1074s
	iters: 800, epoch: 1 | loss: 1.0615726
	speed: 0.0048s/iter; left time: 35.5301s
	iters: 900, epoch: 1 | loss: 0.8243638
	speed: 0.0048s/iter; left time: 34.8082s
	iters: 1000, epoch: 1 | loss: 1.1913971
	speed: 0.0048s/iter; left time: 34.7705s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.3876).  Saving model state dict ...
Epoch: 1 cost time: 5.35356593132019
Epoch: 1, Steps: 1027 | Train Loss: 0.8549413 Vali Loss: 0.3876030 Best vali loss: 0.3876030
	iters: 100, epoch: 2 | loss: 1.1327875
	speed: 0.0124s/iter; left time: 87.7636s
	iters: 200, epoch: 2 | loss: 0.9920700
	speed: 0.0048s/iter; left time: 33.2034s
	iters: 300, epoch: 2 | loss: 0.7965595
	speed: 0.0047s/iter; left time: 32.4954s
	iters: 400, epoch: 2 | loss: 0.3260955
	speed: 0.0047s/iter; left time: 31.9830s
	iters: 500, epoch: 2 | loss: 0.4094163
	speed: 0.0047s/iter; left time: 31.4446s
	iters: 600, epoch: 2 | loss: 0.9795572
	speed: 0.0047s/iter; left time: 31.0799s
	iters: 700, epoch: 2 | loss: 0.8767156
	speed: 0.0047s/iter; left time: 30.6336s
	iters: 800, epoch: 2 | loss: 0.3827100
	speed: 0.0047s/iter; left time: 29.8323s
	iters: 900, epoch: 2 | loss: 0.3968764
	speed: 0.0046s/iter; left time: 29.2188s
	iters: 1000, epoch: 2 | loss: 1.0710800
	speed: 0.0047s/iter; left time: 28.8453s
Updating learning rate to 0.0028552868313678737
Epoch: 2 cost time: 4.866750478744507
Epoch: 2, Steps: 1027 | Train Loss: 0.7363868 Vali Loss: 0.4011818 Best vali loss: 0.3876030
	iters: 100, epoch: 3 | loss: 0.3677061
	speed: 0.0130s/iter; left time: 79.0525s
	iters: 200, epoch: 3 | loss: 0.3568228
	speed: 0.0050s/iter; left time: 29.8526s
	iters: 300, epoch: 3 | loss: 0.8300208
	speed: 0.0050s/iter; left time: 29.4095s
	iters: 400, epoch: 3 | loss: 0.2863455
	speed: 0.0050s/iter; left time: 29.0399s
	iters: 500, epoch: 3 | loss: 1.3210938
	speed: 0.0050s/iter; left time: 28.4802s
	iters: 600, epoch: 3 | loss: 0.6850128
	speed: 0.0050s/iter; left time: 27.9374s
	iters: 700, epoch: 3 | loss: 0.5076115
	speed: 0.0050s/iter; left time: 27.4578s
	iters: 800, epoch: 3 | loss: 0.2181718
	speed: 0.0050s/iter; left time: 26.8346s
	iters: 900, epoch: 3 | loss: 1.7751085
	speed: 0.0051s/iter; left time: 26.7266s
	iters: 1000, epoch: 3 | loss: 1.2966903
	speed: 0.0051s/iter; left time: 26.1877s
Updating learning rate to 0.0023126601334443136
Validation loss decreased (0.3876 --> 0.3763).  Saving model state dict ...
Epoch: 3 cost time: 5.2040534019470215
Epoch: 3, Steps: 1027 | Train Loss: 0.7644584 Vali Loss: 0.3763292 Best vali loss: 0.3763292

best validation loss 0.3763292099790161

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8646170
	speed: 0.0089s/iter; left time: 17.5070s
	iters: 200, epoch: 1 | loss: 0.8712357
	speed: 0.0027s/iter; left time: 4.9265s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.057992696762085
Epoch: 1, Steps: 257 | Train Loss: 0.8679264 Vali Loss: 0.3690726 Best vali loss: 0.3690726
	iters: 100, epoch: 2 | loss: 0.4688489
	speed: 0.0064s/iter; left time: 10.9123s
	iters: 200, epoch: 2 | loss: 0.8148702
	speed: 0.0029s/iter; left time: 4.6050s
Updating learning rate to 0.0014281993853242025
Epoch: 2 cost time: 0.7717952728271484
Epoch: 2, Steps: 257 | Train Loss: 0.6418595 Vali Loss: 0.3844460 Best vali loss: 0.3690726
	iters: 100, epoch: 3 | loss: 0.5895157
	speed: 0.0065s/iter; left time: 9.4249s
	iters: 200, epoch: 3 | loss: 0.8811371
	speed: 0.0025s/iter; left time: 3.4075s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 0.6874420642852783
Epoch: 3, Steps: 257 | Train Loss: 0.7353264 Vali Loss: 0.3777638 Best vali loss: 0.3690726

best validation loss 0.36907261937915226

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2493540
	speed: 0.0088s/iter; left time: 71.3177s
	iters: 200, epoch: 1 | loss: 1.2329007
	speed: 0.0025s/iter; left time: 19.8342s
	iters: 300, epoch: 1 | loss: 0.4188052
	speed: 0.0024s/iter; left time: 19.1985s
	iters: 400, epoch: 1 | loss: 0.8669213
	speed: 0.0024s/iter; left time: 18.7741s
	iters: 500, epoch: 1 | loss: 0.3156043
	speed: 0.0025s/iter; left time: 19.3358s
	iters: 600, epoch: 1 | loss: 0.3809758
	speed: 0.0024s/iter; left time: 18.2386s
	iters: 700, epoch: 1 | loss: 0.5941271
	speed: 0.0023s/iter; left time: 17.0559s
	iters: 800, epoch: 1 | loss: 1.5011317
	speed: 0.0023s/iter; left time: 16.7912s
	iters: 900, epoch: 1 | loss: 0.4150397
	speed: 0.0022s/iter; left time: 16.3800s
	iters: 1000, epoch: 1 | loss: 0.2964819
	speed: 0.0022s/iter; left time: 16.2148s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.3639).  Saving model state dict ...
Epoch: 1 cost time: 2.795724391937256
Epoch: 1, Steps: 1027 | Train Loss: 0.7271342 Vali Loss: 0.3639056 Best vali loss: 0.3639056
	iters: 100, epoch: 2 | loss: 0.4163058
	speed: 0.0076s/iter; left time: 53.8846s
	iters: 200, epoch: 2 | loss: 1.0537742
	speed: 0.0022s/iter; left time: 15.5705s
	iters: 300, epoch: 2 | loss: 0.2531564
	speed: 0.0022s/iter; left time: 15.3903s
	iters: 400, epoch: 2 | loss: 0.2813052
	speed: 0.0022s/iter; left time: 15.2030s
	iters: 500, epoch: 2 | loss: 0.4183045
	speed: 0.0022s/iter; left time: 14.8200s
	iters: 600, epoch: 2 | loss: 0.4720384
	speed: 0.0023s/iter; left time: 15.2704s
	iters: 700, epoch: 2 | loss: 0.2617521
	speed: 0.0022s/iter; left time: 14.3891s
	iters: 800, epoch: 2 | loss: 0.2714826
	speed: 0.0023s/iter; left time: 14.4506s
	iters: 900, epoch: 2 | loss: 0.2953103
	speed: 0.0024s/iter; left time: 15.2204s
	iters: 1000, epoch: 2 | loss: 0.2459270
	speed: 0.0024s/iter; left time: 15.0139s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 2.3856639862060547
Epoch: 2, Steps: 1027 | Train Loss: 0.3969357 Vali Loss: 0.3645739 Best vali loss: 0.3639056
	iters: 100, epoch: 3 | loss: 0.6336522
	speed: 0.0073s/iter; left time: 44.0989s
	iters: 200, epoch: 3 | loss: 0.3568536
	speed: 0.0021s/iter; left time: 12.5167s
	iters: 300, epoch: 3 | loss: 0.2741523
	speed: 0.0020s/iter; left time: 11.9884s
	iters: 400, epoch: 3 | loss: 1.0508689
	speed: 0.0020s/iter; left time: 11.7899s
	iters: 500, epoch: 3 | loss: 0.4567376
	speed: 0.0020s/iter; left time: 11.4962s
	iters: 600, epoch: 3 | loss: 0.4522794
	speed: 0.0021s/iter; left time: 11.6700s
	iters: 700, epoch: 3 | loss: 1.4583783
	speed: 0.0021s/iter; left time: 11.6668s
	iters: 800, epoch: 3 | loss: 0.5012896
	speed: 0.0025s/iter; left time: 13.3739s
	iters: 900, epoch: 3 | loss: 0.9575522
	speed: 0.0025s/iter; left time: 13.2122s
	iters: 1000, epoch: 3 | loss: 0.3169878
	speed: 0.0025s/iter; left time: 12.8195s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 2.317180633544922
Epoch: 3, Steps: 1027 | Train Loss: 0.6458752 Vali Loss: 0.3735436 Best vali loss: 0.3639056

best validation loss 0.3639055895547736

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9649649
	speed: 0.0086s/iter; left time: 43.4863s
	iters: 200, epoch: 4 | loss: 0.8623313
	speed: 0.0024s/iter; left time: 11.7946s
	iters: 300, epoch: 4 | loss: 0.2948775
	speed: 0.0024s/iter; left time: 11.5614s
	iters: 400, epoch: 4 | loss: 0.7204695
	speed: 0.0024s/iter; left time: 11.2752s
	iters: 500, epoch: 4 | loss: 0.2868160
	speed: 0.0024s/iter; left time: 11.1381s
	iters: 600, epoch: 4 | loss: 0.3097471
	speed: 0.0024s/iter; left time: 10.7162s
	iters: 700, epoch: 4 | loss: 0.5056774
	speed: 0.0024s/iter; left time: 10.5256s
	iters: 800, epoch: 4 | loss: 0.8913954
	speed: 0.0024s/iter; left time: 10.5855s
	iters: 900, epoch: 4 | loss: 0.2624161
	speed: 0.0025s/iter; left time: 10.4251s
	iters: 1000, epoch: 4 | loss: 0.2591983
	speed: 0.0024s/iter; left time: 9.9417s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 2.8171496391296387
Epoch: 4, Steps: 1027 | Train Loss: 0.5357894 Vali Loss: 0.3839003 Best vali loss: 0.3639056
	iters: 100, epoch: 5 | loss: 0.4050738
	speed: 0.0077s/iter; left time: 30.8291s
	iters: 200, epoch: 5 | loss: 0.7296615
	speed: 0.0023s/iter; left time: 8.8274s
	iters: 300, epoch: 5 | loss: 0.2521057
	speed: 0.0023s/iter; left time: 8.9073s
	iters: 400, epoch: 5 | loss: 0.2619033
	speed: 0.0024s/iter; left time: 8.7470s
	iters: 500, epoch: 5 | loss: 0.3288157
	speed: 0.0024s/iter; left time: 8.5865s
	iters: 600, epoch: 5 | loss: 0.4418341
	speed: 0.0024s/iter; left time: 8.3740s
	iters: 700, epoch: 5 | loss: 0.2497215
	speed: 0.0024s/iter; left time: 8.1106s
	iters: 800, epoch: 5 | loss: 0.2553479
	speed: 0.0024s/iter; left time: 7.9190s
	iters: 900, epoch: 5 | loss: 0.2471697
	speed: 0.0024s/iter; left time: 7.5830s
	iters: 1000, epoch: 5 | loss: 0.2255675
	speed: 0.0024s/iter; left time: 7.4285s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 2.459364891052246
Epoch: 5, Steps: 1027 | Train Loss: 0.3397201 Vali Loss: 0.3875898 Best vali loss: 0.3639056
	iters: 100, epoch: 6 | loss: 0.5486127
	speed: 0.0074s/iter; left time: 22.0829s
	iters: 200, epoch: 6 | loss: 0.2962304
	speed: 0.0021s/iter; left time: 6.0254s
	iters: 300, epoch: 6 | loss: 0.2486868
	speed: 0.0021s/iter; left time: 5.7720s
	iters: 400, epoch: 6 | loss: 0.9251914
	speed: 0.0021s/iter; left time: 5.5863s
	iters: 500, epoch: 6 | loss: 0.3697937
	speed: 0.0021s/iter; left time: 5.3848s
	iters: 600, epoch: 6 | loss: 0.4047696
	speed: 0.0021s/iter; left time: 5.1740s
	iters: 700, epoch: 6 | loss: 1.3197854
	speed: 0.0021s/iter; left time: 4.9530s
	iters: 800, epoch: 6 | loss: 0.4114416
	speed: 0.0021s/iter; left time: 4.7620s
	iters: 900, epoch: 6 | loss: 0.8074986
	speed: 0.0021s/iter; left time: 4.5432s
	iters: 1000, epoch: 6 | loss: 0.2970352
	speed: 0.0021s/iter; left time: 4.3534s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 2.187711715698242
Epoch: 6, Steps: 1027 | Train Loss: 0.5629045 Vali Loss: 0.3868083 Best vali loss: 0.3639056
	iters: 100, epoch: 7 | loss: 0.4626084
	speed: 0.0073s/iter; left time: 14.2291s
	iters: 200, epoch: 7 | loss: 0.5554924
	speed: 0.0022s/iter; left time: 4.0796s
	iters: 300, epoch: 7 | loss: 0.2750563
	speed: 0.0022s/iter; left time: 3.9229s
	iters: 400, epoch: 7 | loss: 0.3028250
	speed: 0.0022s/iter; left time: 3.6190s
	iters: 500, epoch: 7 | loss: 0.3763298
	speed: 0.0022s/iter; left time: 3.3910s
	iters: 600, epoch: 7 | loss: 0.3475327
	speed: 0.0022s/iter; left time: 3.1972s
	iters: 700, epoch: 7 | loss: 0.2107269
	speed: 0.0022s/iter; left time: 2.9559s
	iters: 800, epoch: 7 | loss: 0.4396582
	speed: 0.0022s/iter; left time: 2.7353s
	iters: 900, epoch: 7 | loss: 0.7459586
	speed: 0.0022s/iter; left time: 2.5243s
	iters: 1000, epoch: 7 | loss: 0.5737377
	speed: 0.0022s/iter; left time: 2.3061s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 2.3028721809387207
Epoch: 7, Steps: 1027 | Train Loss: 0.4289926 Vali Loss: 0.3866791 Best vali loss: 0.3639056
	iters: 100, epoch: 8 | loss: 0.2517202
	speed: 0.0075s/iter; left time: 6.9687s
	iters: 200, epoch: 8 | loss: 0.4812072
	speed: 0.0023s/iter; left time: 1.9256s
	iters: 300, epoch: 8 | loss: 0.3471120
	speed: 0.0024s/iter; left time: 1.7441s
	iters: 400, epoch: 8 | loss: 1.0529354
	speed: 0.0024s/iter; left time: 1.5236s
	iters: 500, epoch: 8 | loss: 0.2798854
	speed: 0.0024s/iter; left time: 1.2824s
	iters: 600, epoch: 8 | loss: 0.2885472
	speed: 0.0025s/iter; left time: 1.0575s
	iters: 700, epoch: 8 | loss: 0.5880108
	speed: 0.0024s/iter; left time: 0.7721s
	iters: 800, epoch: 8 | loss: 0.6809649
	speed: 0.0024s/iter; left time: 0.5541s
	iters: 900, epoch: 8 | loss: 0.8791522
	speed: 0.0025s/iter; left time: 0.3150s
	iters: 1000, epoch: 8 | loss: 0.2161835
	speed: 0.0024s/iter; left time: 0.0668s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 2.4971299171447754
Epoch: 8, Steps: 1027 | Train Loss: 0.5065719 Vali Loss: 0.3888107 Best vali loss: 0.3639056

best validation loss 0.3639055895547736

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6998032
	speed: 0.0113s/iter; left time: 10.5594s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.3990).  Saving model state dict ...
Epoch: 1 cost time: 1.0142297744750977
Epoch: 1, Steps: 129 | Train Loss: 0.6998032 Vali Loss: 0.3990243 Best vali loss: 0.3990243
	iters: 100, epoch: 2 | loss: 0.6958148
	speed: 0.0089s/iter; left time: 7.1349s
Updating learning rate to 0.0026738530511141692
Epoch: 2 cost time: 0.6863718032836914
Epoch: 2, Steps: 129 | Train Loss: 0.6958148 Vali Loss: 0.4038393 Best vali loss: 0.3990243
	iters: 100, epoch: 3 | loss: 0.8908224
	speed: 0.0084s/iter; left time: 5.7001s
Updating learning rate to 0.002165706536403478
Epoch: 3 cost time: 0.6744983196258545
Epoch: 3, Steps: 129 | Train Loss: 0.8908224 Vali Loss: 0.4086203 Best vali loss: 0.3990243
	iters: 100, epoch: 4 | loss: 0.8052298
	speed: 0.0086s/iter; left time: 4.6941s
Updating learning rate to 0.00156630685355
Epoch: 4 cost time: 0.6866977214813232
Epoch: 4, Steps: 129 | Train Loss: 0.8052298 Vali Loss: 0.4141974 Best vali loss: 0.3990243
	iters: 100, epoch: 5 | loss: 0.4181803
	speed: 0.0087s/iter; left time: 3.6173s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 0.6894867420196533
Epoch: 5, Steps: 129 | Train Loss: 0.4181803 Vali Loss: 0.4041618 Best vali loss: 0.3990243
	iters: 100, epoch: 6 | loss: 0.6124107
	speed: 0.0086s/iter; left time: 2.4653s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 0.6843252182006836
Epoch: 6, Steps: 129 | Train Loss: 0.6124107 Vali Loss: 0.4084533 Best vali loss: 0.3990243
	iters: 100, epoch: 7 | loss: 0.5140570
	speed: 0.0086s/iter; left time: 1.3657s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 0.6841697692871094
Epoch: 7, Steps: 129 | Train Loss: 0.5140570 Vali Loss: 0.3993886 Best vali loss: 0.3990243
	iters: 100, epoch: 8 | loss: 0.6705227
	speed: 0.0088s/iter; left time: 0.2632s
Updating learning rate to 0.0
Validation loss decreased (0.3990 --> 0.3931).  Saving model state dict ...
Epoch: 8 cost time: 0.694861888885498
Epoch: 8, Steps: 129 | Train Loss: 0.6705227 Vali Loss: 0.3931205 Best vali loss: 0.3931205

best validation loss 0.39312050456148234

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4157002
	speed: 0.0097s/iter; left time: 9.0142s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.3979).  Saving model state dict ...
Epoch: 1 cost time: 0.8129847049713135
Epoch: 1, Steps: 129 | Train Loss: 0.4157002 Vali Loss: 0.3978504 Best vali loss: 0.3978504
	iters: 100, epoch: 2 | loss: 0.5635052
	speed: 0.0060s/iter; left time: 4.7994s
Updating learning rate to 0.002295210804720494
Validation loss decreased (0.3979 --> 0.3793).  Saving model state dict ...
Epoch: 2 cost time: 0.44550657272338867
Epoch: 2, Steps: 129 | Train Loss: 0.5635052 Vali Loss: 0.3793088 Best vali loss: 0.3793088
	iters: 100, epoch: 3 | loss: 0.5687490
	speed: 0.0058s/iter; left time: 3.9142s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 0.4330015182495117
Epoch: 3, Steps: 129 | Train Loss: 0.5687490 Vali Loss: 0.3855253 Best vali loss: 0.3793088
	iters: 100, epoch: 4 | loss: 0.6231016
	speed: 0.0057s/iter; left time: 3.1221s
Updating learning rate to 0.0013445033609
Epoch: 4 cost time: 0.43485593795776367
Epoch: 4, Steps: 129 | Train Loss: 0.6231016 Vali Loss: 0.3930238 Best vali loss: 0.3793088
	iters: 100, epoch: 5 | loss: 0.5705624
	speed: 0.0055s/iter; left time: 2.3029s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 0.4177234172821045
Epoch: 5, Steps: 129 | Train Loss: 0.5705624 Vali Loss: 0.3968115 Best vali loss: 0.3793088
	iters: 100, epoch: 6 | loss: 0.7121060
	speed: 0.0056s/iter; left time: 1.6107s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 0.42151379585266113
Epoch: 6, Steps: 129 | Train Loss: 0.7121060 Vali Loss: 0.4025388 Best vali loss: 0.3793088
	iters: 100, epoch: 7 | loss: 0.3427685
	speed: 0.0055s/iter; left time: 0.8797s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 0.416942834854126
Epoch: 7, Steps: 129 | Train Loss: 0.3427685 Vali Loss: 0.4129519 Best vali loss: 0.3793088
	iters: 100, epoch: 8 | loss: 0.3467759
	speed: 0.0058s/iter; left time: 0.1747s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.44509220123291016
Epoch: 8, Steps: 129 | Train Loss: 0.3467759 Vali Loss: 0.4197455 Best vali loss: 0.3793088

best validation loss 0.37930878596362055

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9270530
	speed: 0.0110s/iter; left time: 44.2933s
	iters: 200, epoch: 1 | loss: 0.3514820
	speed: 0.0051s/iter; left time: 19.9413s
	iters: 300, epoch: 1 | loss: 1.0351568
	speed: 0.0050s/iter; left time: 18.9248s
	iters: 400, epoch: 1 | loss: 0.8241409
	speed: 0.0051s/iter; left time: 18.8335s
	iters: 500, epoch: 1 | loss: 0.8015661
	speed: 0.0050s/iter; left time: 17.9396s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.3945).  Saving model state dict ...
Epoch: 1 cost time: 2.9335882663726807
Epoch: 1, Steps: 514 | Train Loss: 0.7878798 Vali Loss: 0.3944591 Best vali loss: 0.3944591
	iters: 100, epoch: 2 | loss: 0.3071762
	speed: 0.0098s/iter; left time: 34.1645s
	iters: 200, epoch: 2 | loss: 0.9339597
	speed: 0.0052s/iter; left time: 17.5210s
	iters: 300, epoch: 2 | loss: 0.3875001
	speed: 0.0052s/iter; left time: 17.1879s
	iters: 400, epoch: 2 | loss: 0.5645691
	speed: 0.0052s/iter; left time: 16.7533s
	iters: 500, epoch: 2 | loss: 0.4499845
	speed: 0.0052s/iter; left time: 16.2084s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.3945 --> 0.3802).  Saving model state dict ...
Epoch: 2 cost time: 2.7040793895721436
Epoch: 2, Steps: 514 | Train Loss: 0.5286379 Vali Loss: 0.3802449 Best vali loss: 0.3802449
	iters: 100, epoch: 3 | loss: 0.6381794
	speed: 0.0101s/iter; left time: 30.2416s
	iters: 200, epoch: 3 | loss: 1.1500769
	speed: 0.0052s/iter; left time: 15.1389s
	iters: 300, epoch: 3 | loss: 0.7667684
	speed: 0.0052s/iter; left time: 14.5182s
	iters: 400, epoch: 3 | loss: 0.5199935
	speed: 0.0052s/iter; left time: 13.8860s
	iters: 500, epoch: 3 | loss: 0.8586222
	speed: 0.0052s/iter; left time: 13.3876s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.3802 --> 0.3728).  Saving model state dict ...
Epoch: 3 cost time: 2.721543550491333
Epoch: 3, Steps: 514 | Train Loss: 0.7867281 Vali Loss: 0.3727964 Best vali loss: 0.3727964

best validation loss 0.3727964490944838

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3573494
	speed: 0.0093s/iter; left time: 75.3643s
	iters: 200, epoch: 1 | loss: 0.8311587
	speed: 0.0035s/iter; left time: 28.0472s
	iters: 300, epoch: 1 | loss: 0.5557891
	speed: 0.0035s/iter; left time: 27.5707s
	iters: 400, epoch: 1 | loss: 0.7332094
	speed: 0.0035s/iter; left time: 27.1834s
	iters: 500, epoch: 1 | loss: 1.0650693
	speed: 0.0035s/iter; left time: 26.7845s
	iters: 600, epoch: 1 | loss: 2.4576116
	speed: 0.0033s/iter; left time: 25.0035s
	iters: 700, epoch: 1 | loss: 1.1910815
	speed: 0.0032s/iter; left time: 23.9474s
	iters: 800, epoch: 1 | loss: 1.4092376
	speed: 0.0028s/iter; left time: 21.1006s
	iters: 900, epoch: 1 | loss: 0.4268173
	speed: 0.0028s/iter; left time: 20.2203s
	iters: 1000, epoch: 1 | loss: 0.3940021
	speed: 0.0027s/iter; left time: 19.7731s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 3.6340227127075195
Epoch: 1, Steps: 1027 | Train Loss: 1.0421326 Vali Loss: 0.3738672 Best vali loss: 0.3738672
	iters: 100, epoch: 2 | loss: 0.3576568
	speed: 0.0094s/iter; left time: 66.7351s
	iters: 200, epoch: 2 | loss: 0.2134239
	speed: 0.0033s/iter; left time: 22.8299s
	iters: 300, epoch: 2 | loss: 0.2943817
	speed: 0.0033s/iter; left time: 22.5337s
	iters: 400, epoch: 2 | loss: 1.0409313
	speed: 0.0033s/iter; left time: 22.3937s
	iters: 500, epoch: 2 | loss: 0.4108764
	speed: 0.0033s/iter; left time: 22.0642s
	iters: 600, epoch: 2 | loss: 1.3751334
	speed: 0.0033s/iter; left time: 21.8898s
	iters: 700, epoch: 2 | loss: 0.5214502
	speed: 0.0033s/iter; left time: 21.5197s
	iters: 800, epoch: 2 | loss: 1.0855238
	speed: 0.0033s/iter; left time: 20.9178s
	iters: 900, epoch: 2 | loss: 0.2972209
	speed: 0.0033s/iter; left time: 20.8197s
	iters: 1000, epoch: 2 | loss: 0.3509991
	speed: 0.0033s/iter; left time: 20.5317s
Updating learning rate to 0.00029247785775
Epoch: 2 cost time: 3.4241623878479004
Epoch: 2, Steps: 1027 | Train Loss: 0.5947598 Vali Loss: 0.3761529 Best vali loss: 0.3738672
	iters: 100, epoch: 3 | loss: 0.2648031
	speed: 0.0090s/iter; left time: 54.5744s
	iters: 200, epoch: 3 | loss: 1.2783674
	speed: 0.0028s/iter; left time: 16.6716s
	iters: 300, epoch: 3 | loss: 0.5543953
	speed: 0.0028s/iter; left time: 16.5969s
	iters: 400, epoch: 3 | loss: 0.1866427
	speed: 0.0030s/iter; left time: 17.1969s
	iters: 500, epoch: 3 | loss: 0.4939725
	speed: 0.0030s/iter; left time: 17.0494s
	iters: 600, epoch: 3 | loss: 0.3658468
	speed: 0.0030s/iter; left time: 16.6890s
	iters: 700, epoch: 3 | loss: 0.4481257
	speed: 0.0030s/iter; left time: 16.4423s
	iters: 800, epoch: 3 | loss: 0.2154943
	speed: 0.0030s/iter; left time: 16.1440s
	iters: 900, epoch: 3 | loss: 0.6909571
	speed: 0.0030s/iter; left time: 15.7320s
	iters: 1000, epoch: 3 | loss: 0.4276251
	speed: 0.0030s/iter; left time: 15.5425s
Updating learning rate to 0.000146238928875
Validation loss decreased (0.3739 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 3.062269687652588
Epoch: 3, Steps: 1027 | Train Loss: 0.4926230 Vali Loss: 0.3638763 Best vali loss: 0.3638763

best validation loss 0.36387628850861947

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0272197
	speed: 0.0111s/iter; left time: 90.0871s
	iters: 200, epoch: 1 | loss: 0.3147579
	speed: 0.0052s/iter; left time: 41.4664s
	iters: 300, epoch: 1 | loss: 0.3357626
	speed: 0.0052s/iter; left time: 41.2740s
	iters: 400, epoch: 1 | loss: 0.3467509
	speed: 0.0052s/iter; left time: 40.5736s
	iters: 500, epoch: 1 | loss: 0.2389168
	speed: 0.0052s/iter; left time: 39.9717s
	iters: 600, epoch: 1 | loss: 0.5099252
	speed: 0.0052s/iter; left time: 39.5817s
	iters: 700, epoch: 1 | loss: 1.6116883
	speed: 0.0052s/iter; left time: 38.7262s
	iters: 800, epoch: 1 | loss: 0.6421367
	speed: 0.0051s/iter; left time: 37.7149s
	iters: 900, epoch: 1 | loss: 0.3195398
	speed: 0.0051s/iter; left time: 37.5784s
	iters: 1000, epoch: 1 | loss: 1.1204170
	speed: 0.0052s/iter; left time: 37.1834s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 5.650108337402344
Epoch: 1, Steps: 1027 | Train Loss: 0.6467115 Vali Loss: 0.3731667 Best vali loss: 0.3731667
	iters: 100, epoch: 2 | loss: 0.3458022
	speed: 0.0132s/iter; left time: 93.7126s
	iters: 200, epoch: 2 | loss: 0.4414844
	speed: 0.0052s/iter; left time: 36.0118s
	iters: 300, epoch: 2 | loss: 0.4887199
	speed: 0.0051s/iter; left time: 35.2490s
	iters: 400, epoch: 2 | loss: 0.9360582
	speed: 0.0051s/iter; left time: 34.3831s
	iters: 500, epoch: 2 | loss: 1.2145381
	speed: 0.0048s/iter; left time: 31.9678s
	iters: 600, epoch: 2 | loss: 0.4464755
	speed: 0.0047s/iter; left time: 30.7223s
	iters: 700, epoch: 2 | loss: 0.8927961
	speed: 0.0046s/iter; left time: 29.5834s
	iters: 800, epoch: 2 | loss: 0.5166640
	speed: 0.0046s/iter; left time: 29.5662s
	iters: 900, epoch: 2 | loss: 0.8605813
	speed: 0.0046s/iter; left time: 28.9967s
	iters: 1000, epoch: 2 | loss: 0.6203205
	speed: 0.0046s/iter; left time: 28.3874s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.3732 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 5.00677227973938
Epoch: 2, Steps: 1027 | Train Loss: 0.6763440 Vali Loss: 0.3665866 Best vali loss: 0.3665866
	iters: 100, epoch: 3 | loss: 0.4868367
	speed: 0.0125s/iter; left time: 75.8798s
	iters: 200, epoch: 3 | loss: 0.3599724
	speed: 0.0045s/iter; left time: 26.7731s
	iters: 300, epoch: 3 | loss: 0.5849835
	speed: 0.0044s/iter; left time: 25.8064s
	iters: 400, epoch: 3 | loss: 0.8401437
	speed: 0.0044s/iter; left time: 25.5297s
	iters: 500, epoch: 3 | loss: 0.4526930
	speed: 0.0044s/iter; left time: 25.1553s
	iters: 600, epoch: 3 | loss: 0.8571578
	speed: 0.0046s/iter; left time: 25.3190s
	iters: 700, epoch: 3 | loss: 0.1808959
	speed: 0.0045s/iter; left time: 24.4554s
	iters: 800, epoch: 3 | loss: 0.3238263
	speed: 0.0044s/iter; left time: 23.7134s
	iters: 900, epoch: 3 | loss: 0.2675368
	speed: 0.0044s/iter; left time: 23.3250s
	iters: 1000, epoch: 3 | loss: 1.4990146
	speed: 0.0044s/iter; left time: 22.9477s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 4.623887777328491
Epoch: 3, Steps: 1027 | Train Loss: 0.5853061 Vali Loss: 0.3871040 Best vali loss: 0.3665866

best validation loss 0.36658664369161564

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3158902
	speed: 0.0092s/iter; left time: 46.5010s
	iters: 200, epoch: 4 | loss: 0.3855391
	speed: 0.0033s/iter; left time: 16.2171s
	iters: 300, epoch: 4 | loss: 0.4906997
	speed: 0.0032s/iter; left time: 15.5922s
	iters: 400, epoch: 4 | loss: 0.7290534
	speed: 0.0032s/iter; left time: 15.2752s
	iters: 500, epoch: 4 | loss: 0.8128611
	speed: 0.0033s/iter; left time: 15.1304s
	iters: 600, epoch: 4 | loss: 2.1616986
	speed: 0.0033s/iter; left time: 14.7733s
	iters: 700, epoch: 4 | loss: 0.8308098
	speed: 0.0032s/iter; left time: 14.3967s
	iters: 800, epoch: 4 | loss: 1.3311965
	speed: 0.0032s/iter; left time: 14.0296s
	iters: 900, epoch: 4 | loss: 0.4089527
	speed: 0.0032s/iter; left time: 13.5959s
	iters: 1000, epoch: 4 | loss: 0.3899667
	speed: 0.0033s/iter; left time: 13.4664s
Updating learning rate to 7.31194644375e-05
Epoch: 4 cost time: 3.6800103187561035
Epoch: 4, Steps: 1027 | Train Loss: 0.8856668 Vali Loss: 0.3812047 Best vali loss: 0.3638763
	iters: 100, epoch: 5 | loss: 0.3394617
	speed: 0.0092s/iter; left time: 36.7922s
	iters: 200, epoch: 5 | loss: 0.2057274
	speed: 0.0032s/iter; left time: 12.5644s
	iters: 300, epoch: 5 | loss: 0.2811260
	speed: 0.0032s/iter; left time: 12.1399s
	iters: 400, epoch: 5 | loss: 0.4803117
	speed: 0.0032s/iter; left time: 11.9718s
	iters: 500, epoch: 5 | loss: 0.4142005
	speed: 0.0032s/iter; left time: 11.4483s
	iters: 600, epoch: 5 | loss: 1.1361260
	speed: 0.0032s/iter; left time: 11.3583s
	iters: 700, epoch: 5 | loss: 0.5341079
	speed: 0.0032s/iter; left time: 10.9798s
	iters: 800, epoch: 5 | loss: 1.0898525
	speed: 0.0032s/iter; left time: 10.7100s
	iters: 900, epoch: 5 | loss: 0.2748956
	speed: 0.0032s/iter; left time: 10.3856s
	iters: 1000, epoch: 5 | loss: 0.3255911
	speed: 0.0032s/iter; left time: 9.8805s
Updating learning rate to 3.655973221875e-05
Epoch: 5 cost time: 3.3280417919158936
Epoch: 5, Steps: 1027 | Train Loss: 0.5081400 Vali Loss: 0.3736019 Best vali loss: 0.3638763
	iters: 100, epoch: 6 | loss: 0.2341770
	speed: 0.0093s/iter; left time: 27.7270s
	iters: 200, epoch: 6 | loss: 1.2839401
	speed: 0.0033s/iter; left time: 9.5798s
	iters: 300, epoch: 6 | loss: 0.4918967
	speed: 0.0033s/iter; left time: 9.0615s
	iters: 400, epoch: 6 | loss: 0.1794205
	speed: 0.0032s/iter; left time: 8.5894s
	iters: 500, epoch: 6 | loss: 0.4882034
	speed: 0.0033s/iter; left time: 8.4446s
	iters: 600, epoch: 6 | loss: 0.3450747
	speed: 0.0033s/iter; left time: 8.2663s
	iters: 700, epoch: 6 | loss: 0.4253161
	speed: 0.0033s/iter; left time: 7.9578s
	iters: 800, epoch: 6 | loss: 0.2320046
	speed: 0.0032s/iter; left time: 7.3852s
	iters: 900, epoch: 6 | loss: 0.6596808
	speed: 0.0033s/iter; left time: 7.0920s
	iters: 1000, epoch: 6 | loss: 0.4009566
	speed: 0.0032s/iter; left time: 6.6670s
Updating learning rate to 1.8279866109375e-05
Epoch: 6 cost time: 3.3918840885162354
Epoch: 6, Steps: 1027 | Train Loss: 0.4740671 Vali Loss: 0.3707159 Best vali loss: 0.3638763
	iters: 100, epoch: 7 | loss: 1.0031853
	speed: 0.0092s/iter; left time: 18.0457s
	iters: 200, epoch: 7 | loss: 0.5398881
	speed: 0.0032s/iter; left time: 5.9918s
	iters: 300, epoch: 7 | loss: 0.8475816
	speed: 0.0032s/iter; left time: 5.6296s
	iters: 400, epoch: 7 | loss: 0.2313596
	speed: 0.0032s/iter; left time: 5.3461s
	iters: 500, epoch: 7 | loss: 0.2786344
	speed: 0.0032s/iter; left time: 5.0246s
	iters: 600, epoch: 7 | loss: 0.9336041
	speed: 0.0032s/iter; left time: 4.6810s
	iters: 700, epoch: 7 | loss: 0.5574248
	speed: 0.0032s/iter; left time: 4.3555s
	iters: 800, epoch: 7 | loss: 0.6412405
	speed: 0.0032s/iter; left time: 4.0225s
	iters: 900, epoch: 7 | loss: 0.5440761
	speed: 0.0032s/iter; left time: 3.7061s
	iters: 1000, epoch: 7 | loss: 0.6593850
	speed: 0.0032s/iter; left time: 3.4026s
Updating learning rate to 9.1399330546875e-06
Epoch: 7 cost time: 3.3484573364257812
Epoch: 7, Steps: 1027 | Train Loss: 0.6236380 Vali Loss: 0.3664258 Best vali loss: 0.3638763
	iters: 100, epoch: 8 | loss: 0.2683859
	speed: 0.0093s/iter; left time: 8.6461s
	iters: 200, epoch: 8 | loss: 0.5925066
	speed: 0.0030s/iter; left time: 2.4920s
	iters: 300, epoch: 8 | loss: 1.5451311
	speed: 0.0030s/iter; left time: 2.2050s
	iters: 400, epoch: 8 | loss: 0.3187271
	speed: 0.0030s/iter; left time: 1.8912s
	iters: 500, epoch: 8 | loss: 0.9234380
	speed: 0.0030s/iter; left time: 1.5928s
	iters: 600, epoch: 8 | loss: 0.8674508
	speed: 0.0030s/iter; left time: 1.2851s
	iters: 700, epoch: 8 | loss: 0.1990025
	speed: 0.0030s/iter; left time: 0.9875s
	iters: 800, epoch: 8 | loss: 0.3216831
	speed: 0.0030s/iter; left time: 0.6877s
	iters: 900, epoch: 8 | loss: 0.5070227
	speed: 0.0029s/iter; left time: 0.3701s
	iters: 1000, epoch: 8 | loss: 0.2841680
	speed: 0.0029s/iter; left time: 0.0799s
Updating learning rate to 4.56996652734375e-06
Epoch: 8 cost time: 3.1088881492614746
Epoch: 8, Steps: 1027 | Train Loss: 0.5827516 Vali Loss: 0.3704463 Best vali loss: 0.3638763

best validation loss 0.36387628850861947

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5492886
	speed: 0.0104s/iter; left time: 9.6633s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.3979).  Saving model state dict ...
Epoch: 1 cost time: 0.8877596855163574
Epoch: 1, Steps: 129 | Train Loss: 0.5492886 Vali Loss: 0.3978618 Best vali loss: 0.3978618
	iters: 100, epoch: 2 | loss: 0.4075652
	speed: 0.0070s/iter; left time: 5.6411s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.3979 --> 0.3795).  Saving model state dict ...
Epoch: 2 cost time: 0.5482726097106934
Epoch: 2, Steps: 129 | Train Loss: 0.4075652 Vali Loss: 0.3795432 Best vali loss: 0.3795432
	iters: 100, epoch: 3 | loss: 0.8411161
	speed: 0.0071s/iter; left time: 4.7886s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.3795 --> 0.3706).  Saving model state dict ...
Epoch: 3 cost time: 0.5821094512939453
Epoch: 3, Steps: 129 | Train Loss: 0.8411161 Vali Loss: 0.3706339 Best vali loss: 0.3706339
	iters: 100, epoch: 4 | loss: 0.8016710
	speed: 0.0072s/iter; left time: 3.9460s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.3706 --> 0.3677).  Saving model state dict ...
Epoch: 4 cost time: 0.5659897327423096
Epoch: 4, Steps: 129 | Train Loss: 0.8016710 Vali Loss: 0.3676752 Best vali loss: 0.3676752
	iters: 100, epoch: 5 | loss: 0.7003051
	speed: 0.0071s/iter; left time: 2.9770s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.3677 --> 0.3667).  Saving model state dict ...
Epoch: 5 cost time: 0.572871208190918
Epoch: 5, Steps: 129 | Train Loss: 0.7003051 Vali Loss: 0.3667453 Best vali loss: 0.3667453
	iters: 100, epoch: 6 | loss: 0.4767735
	speed: 0.0070s/iter; left time: 2.0290s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.3667 --> 0.3664).  Saving model state dict ...
Epoch: 6 cost time: 0.5661220550537109
Epoch: 6, Steps: 129 | Train Loss: 0.4767735 Vali Loss: 0.3663694 Best vali loss: 0.3663694
	iters: 100, epoch: 7 | loss: 0.7881622
	speed: 0.0072s/iter; left time: 1.1488s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.3664 --> 0.3662).  Saving model state dict ...
Epoch: 7 cost time: 0.5737307071685791
Epoch: 7, Steps: 129 | Train Loss: 0.7881622 Vali Loss: 0.3662281 Best vali loss: 0.3662281
	iters: 100, epoch: 8 | loss: 0.9171174
	speed: 0.0069s/iter; left time: 0.2081s
Updating learning rate to 0.0
Validation loss decreased (0.3662 --> 0.3662).  Saving model state dict ...
Epoch: 8 cost time: 0.5357849597930908
Epoch: 8, Steps: 129 | Train Loss: 0.9171174 Vali Loss: 0.3661887 Best vali loss: 0.3661887

best validation loss 0.36618869146570004

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7229443
	speed: 0.0089s/iter; left time: 17.4782s
	iters: 200, epoch: 1 | loss: 0.5599849
	speed: 0.0028s/iter; left time: 5.1284s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 1.0595204830169678
Epoch: 1, Steps: 257 | Train Loss: 0.6414646 Vali Loss: 0.3724059 Best vali loss: 0.3724059
	iters: 100, epoch: 2 | loss: 0.5390595
	speed: 0.0065s/iter; left time: 11.0827s
	iters: 200, epoch: 2 | loss: 0.6826478
	speed: 0.0027s/iter; left time: 4.2715s
Updating learning rate to 0.000492952456
Validation loss decreased (0.3724 --> 0.3723).  Saving model state dict ...
Epoch: 2 cost time: 0.7450301647186279
Epoch: 2, Steps: 257 | Train Loss: 0.6108536 Vali Loss: 0.3722896 Best vali loss: 0.3722896
	iters: 100, epoch: 3 | loss: 0.6170662
	speed: 0.0065s/iter; left time: 9.4365s
	iters: 200, epoch: 3 | loss: 0.7229164
	speed: 0.0026s/iter; left time: 3.5420s
Updating learning rate to 0.000246476228
Validation loss decreased (0.3723 --> 0.3721).  Saving model state dict ...
Epoch: 3 cost time: 0.7371854782104492
Epoch: 3, Steps: 257 | Train Loss: 0.6699913 Vali Loss: 0.3721057 Best vali loss: 0.3721057
	iters: 100, epoch: 4 | loss: 0.7558573
	speed: 0.0065s/iter; left time: 7.7648s
	iters: 200, epoch: 4 | loss: 0.3826970
	speed: 0.0027s/iter; left time: 2.8979s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 0.7366647720336914
Epoch: 4, Steps: 257 | Train Loss: 0.5692772 Vali Loss: 0.3848835 Best vali loss: 0.3721057
	iters: 100, epoch: 5 | loss: 0.4872421
	speed: 0.0064s/iter; left time: 5.9110s
	iters: 200, epoch: 5 | loss: 0.7024300
	speed: 0.0025s/iter; left time: 2.0805s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 0.7092671394348145
Epoch: 5, Steps: 257 | Train Loss: 0.5948361 Vali Loss: 0.3816552 Best vali loss: 0.3721057
	iters: 100, epoch: 6 | loss: 0.5244347
	speed: 0.0063s/iter; left time: 4.2542s
	iters: 200, epoch: 6 | loss: 0.6067691
	speed: 0.0025s/iter; left time: 1.4136s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 0.6852686405181885
Epoch: 6, Steps: 257 | Train Loss: 0.5656019 Vali Loss: 0.3861059 Best vali loss: 0.3721057
	iters: 100, epoch: 7 | loss: 0.5065822
	speed: 0.0062s/iter; left time: 2.5631s
	iters: 200, epoch: 7 | loss: 0.5588553
	speed: 0.0025s/iter; left time: 0.7887s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 0.6926581859588623
Epoch: 7, Steps: 257 | Train Loss: 0.5327187 Vali Loss: 0.3864582 Best vali loss: 0.3721057
	iters: 100, epoch: 8 | loss: 0.6232259
	speed: 0.0061s/iter; left time: 0.9692s
	iters: 200, epoch: 8 | loss: 0.3934419
	speed: 0.0025s/iter; left time: 0.1472s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 0.6905620098114014
Epoch: 8, Steps: 257 | Train Loss: 0.5083339 Vali Loss: 0.3847204 Best vali loss: 0.3721057

best validation loss 0.3721057145323875

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9058250
	speed: 0.0095s/iter; left time: 38.0794s
	iters: 200, epoch: 1 | loss: 0.5825970
	speed: 0.0031s/iter; left time: 12.2244s
	iters: 300, epoch: 1 | loss: 0.3517128
	speed: 0.0031s/iter; left time: 11.6629s
	iters: 400, epoch: 1 | loss: 0.9746272
	speed: 0.0030s/iter; left time: 11.3228s
	iters: 500, epoch: 1 | loss: 0.7435511
	speed: 0.0031s/iter; left time: 11.2791s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.3965).  Saving model state dict ...
Epoch: 1 cost time: 1.9696993827819824
Epoch: 1, Steps: 514 | Train Loss: 0.7116626 Vali Loss: 0.3964628 Best vali loss: 0.3964628
	iters: 100, epoch: 2 | loss: 1.5221380
	speed: 0.0068s/iter; left time: 23.9491s
	iters: 200, epoch: 2 | loss: 0.7011173
	speed: 0.0030s/iter; left time: 10.1539s
	iters: 300, epoch: 2 | loss: 1.2600822
	speed: 0.0030s/iter; left time: 9.7429s
	iters: 400, epoch: 2 | loss: 0.4262019
	speed: 0.0030s/iter; left time: 9.6206s
	iters: 500, epoch: 2 | loss: 1.2715117
	speed: 0.0029s/iter; left time: 9.0076s
Updating learning rate to 0.0006752130564
Epoch: 2 cost time: 1.5669801235198975
Epoch: 2, Steps: 514 | Train Loss: 1.0362102 Vali Loss: 0.3970334 Best vali loss: 0.3964628
	iters: 100, epoch: 3 | loss: 1.1971170
	speed: 0.0068s/iter; left time: 20.4269s
	iters: 200, epoch: 3 | loss: 0.3889988
	speed: 0.0030s/iter; left time: 8.7660s
	iters: 300, epoch: 3 | loss: 0.4195988
	speed: 0.0031s/iter; left time: 8.4961s
	iters: 400, epoch: 3 | loss: 0.8052938
	speed: 0.0031s/iter; left time: 8.2670s
	iters: 500, epoch: 3 | loss: 0.5084183
	speed: 0.0031s/iter; left time: 8.0921s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.3965 --> 0.3882).  Saving model state dict ...
Epoch: 3 cost time: 1.6345841884613037
Epoch: 3, Steps: 514 | Train Loss: 0.6638853 Vali Loss: 0.3881987 Best vali loss: 0.3881987

best validation loss 0.38819873472328037

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6554342
	speed: 0.0096s/iter; left time: 38.3358s
	iters: 200, epoch: 1 | loss: 0.4259620
	speed: 0.0032s/iter; left time: 12.4342s
	iters: 300, epoch: 1 | loss: 0.4809055
	speed: 0.0030s/iter; left time: 11.4737s
	iters: 400, epoch: 1 | loss: 0.4680179
	speed: 0.0030s/iter; left time: 11.1430s
	iters: 500, epoch: 1 | loss: 0.4209717
	speed: 0.0030s/iter; left time: 10.8523s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.3786).  Saving model state dict ...
Epoch: 1 cost time: 1.9655284881591797
Epoch: 1, Steps: 514 | Train Loss: 0.4902583 Vali Loss: 0.3786446 Best vali loss: 0.3786446
	iters: 100, epoch: 2 | loss: 0.5475249
	speed: 0.0072s/iter; left time: 25.2164s
	iters: 200, epoch: 2 | loss: 0.6287910
	speed: 0.0036s/iter; left time: 12.3525s
	iters: 300, epoch: 2 | loss: 0.8096092
	speed: 0.0036s/iter; left time: 11.7588s
	iters: 400, epoch: 2 | loss: 0.4148048
	speed: 0.0037s/iter; left time: 11.7423s
	iters: 500, epoch: 2 | loss: 0.8365898
	speed: 0.0035s/iter; left time: 10.9552s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.3786 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 1.8819530010223389
Epoch: 2, Steps: 514 | Train Loss: 0.6474639 Vali Loss: 0.3659804 Best vali loss: 0.3659804
	iters: 100, epoch: 3 | loss: 0.2846589
	speed: 0.0074s/iter; left time: 22.1817s
	iters: 200, epoch: 3 | loss: 0.4803413
	speed: 0.0035s/iter; left time: 10.0619s
	iters: 300, epoch: 3 | loss: 0.6778918
	speed: 0.0032s/iter; left time: 8.9893s
	iters: 400, epoch: 3 | loss: 0.7491513
	speed: 0.0032s/iter; left time: 8.5187s
	iters: 500, epoch: 3 | loss: 0.3325255
	speed: 0.0032s/iter; left time: 8.2152s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.3660 --> 0.3648).  Saving model state dict ...
Epoch: 3 cost time: 1.7402474880218506
Epoch: 3, Steps: 514 | Train Loss: 0.5049138 Vali Loss: 0.3648337 Best vali loss: 0.3648337

best validation loss 0.36483365457161004

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5722567
	speed: 0.0099s/iter; left time: 9.2128s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.3815).  Saving model state dict ...
Epoch: 1 cost time: 0.839754581451416
Epoch: 1, Steps: 129 | Train Loss: 0.5722567 Vali Loss: 0.3815068 Best vali loss: 0.3815068
	iters: 100, epoch: 2 | loss: 0.7069657
	speed: 0.0069s/iter; left time: 5.5388s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.3815 --> 0.3692).  Saving model state dict ...
Epoch: 2 cost time: 0.550910234451294
Epoch: 2, Steps: 129 | Train Loss: 0.7069657 Vali Loss: 0.3691599 Best vali loss: 0.3691599
	iters: 100, epoch: 3 | loss: 0.6633227
	speed: 0.0067s/iter; left time: 4.5359s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.3692 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 0.5245449542999268
Epoch: 3, Steps: 129 | Train Loss: 0.6633227 Vali Loss: 0.3672702 Best vali loss: 0.3672702

best validation loss 0.36727016590433176

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5373492
	speed: 0.0097s/iter; left time: 23.8890s
	iters: 200, epoch: 4 | loss: 0.4076048
	speed: 0.0036s/iter; left time: 8.5968s
	iters: 300, epoch: 4 | loss: 0.4669672
	speed: 0.0037s/iter; left time: 8.3476s
	iters: 400, epoch: 4 | loss: 0.4453584
	speed: 0.0037s/iter; left time: 8.0618s
	iters: 500, epoch: 4 | loss: 0.3800186
	speed: 0.0037s/iter; left time: 7.6276s
Updating learning rate to 7.5456317e-06
Epoch: 4 cost time: 2.2414252758026123
Epoch: 4, Steps: 514 | Train Loss: 0.4474596 Vali Loss: 0.3661925 Best vali loss: 0.3648337
	iters: 100, epoch: 5 | loss: 0.5198422
	speed: 0.0070s/iter; left time: 13.7866s
	iters: 200, epoch: 5 | loss: 0.6178500
	speed: 0.0031s/iter; left time: 5.7595s
	iters: 300, epoch: 5 | loss: 0.8069489
	speed: 0.0030s/iter; left time: 5.3424s
	iters: 400, epoch: 5 | loss: 0.3888326
	speed: 0.0033s/iter; left time: 5.4159s
	iters: 500, epoch: 5 | loss: 0.8213228
	speed: 0.0030s/iter; left time: 4.6234s
Updating learning rate to 3.77281585e-06
Epoch: 5 cost time: 1.633702278137207
Epoch: 5, Steps: 514 | Train Loss: 0.6309593 Vali Loss: 0.3657876 Best vali loss: 0.3648337
	iters: 100, epoch: 6 | loss: 0.2844281
	speed: 0.0072s/iter; left time: 10.3437s
	iters: 200, epoch: 6 | loss: 0.4842790
	speed: 0.0033s/iter; left time: 4.4046s
	iters: 300, epoch: 6 | loss: 0.5172222
	speed: 0.0033s/iter; left time: 4.0675s
	iters: 400, epoch: 6 | loss: 0.6924894
	speed: 0.0033s/iter; left time: 3.7280s
	iters: 500, epoch: 6 | loss: 0.3234015
	speed: 0.0033s/iter; left time: 3.3913s
Updating learning rate to 1.886407925e-06
Epoch: 6 cost time: 1.7296016216278076
Epoch: 6, Steps: 514 | Train Loss: 0.4603640 Vali Loss: 0.3658740 Best vali loss: 0.3648337
	iters: 100, epoch: 7 | loss: 0.4670276
	speed: 0.0072s/iter; left time: 6.7016s
	iters: 200, epoch: 7 | loss: 0.5984439
	speed: 0.0031s/iter; left time: 2.5965s
	iters: 300, epoch: 7 | loss: 0.5195277
	speed: 0.0031s/iter; left time: 2.2371s
	iters: 400, epoch: 7 | loss: 0.3153593
	speed: 0.0032s/iter; left time: 2.0070s
	iters: 500, epoch: 7 | loss: 0.8421947
	speed: 0.0031s/iter; left time: 1.6426s
Updating learning rate to 9.432039625e-07
Epoch: 7 cost time: 1.6578054428100586
Epoch: 7, Steps: 514 | Train Loss: 0.5485106 Vali Loss: 0.3660432 Best vali loss: 0.3648337
	iters: 100, epoch: 8 | loss: 0.2681557
	speed: 0.0075s/iter; left time: 3.1005s
	iters: 200, epoch: 8 | loss: 0.9511312
	speed: 0.0035s/iter; left time: 1.1160s
	iters: 300, epoch: 8 | loss: 0.7318817
	speed: 0.0036s/iter; left time: 0.7731s
	iters: 400, epoch: 8 | loss: 1.0145751
	speed: 0.0036s/iter; left time: 0.4154s
	iters: 500, epoch: 8 | loss: 0.3241571
	speed: 0.0036s/iter; left time: 0.0534s
Updating learning rate to 4.7160198125e-07
Epoch: 8 cost time: 1.8744120597839355
Epoch: 8, Steps: 514 | Train Loss: 0.6579801 Vali Loss: 0.3660628 Best vali loss: 0.3648337

best validation loss 0.36483365457161004

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5456275
	speed: 0.0086s/iter; left time: 69.6588s
	iters: 200, epoch: 1 | loss: 0.6190503
	speed: 0.0023s/iter; left time: 18.3861s
	iters: 300, epoch: 1 | loss: 0.5061507
	speed: 0.0021s/iter; left time: 16.7118s
	iters: 400, epoch: 1 | loss: 0.9878227
	speed: 0.0021s/iter; left time: 16.7248s
	iters: 500, epoch: 1 | loss: 0.9827813
	speed: 0.0021s/iter; left time: 16.4755s
	iters: 600, epoch: 1 | loss: 0.7390379
	speed: 0.0021s/iter; left time: 15.9947s
	iters: 700, epoch: 1 | loss: 0.2405946
	speed: 0.0021s/iter; left time: 15.7618s
	iters: 800, epoch: 1 | loss: 0.5947953
	speed: 0.0021s/iter; left time: 15.5039s
	iters: 900, epoch: 1 | loss: 1.2388681
	speed: 0.0021s/iter; left time: 15.3801s
	iters: 1000, epoch: 1 | loss: 0.4130243
	speed: 0.0021s/iter; left time: 15.0822s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.3877).  Saving model state dict ...
Epoch: 1 cost time: 2.5699684619903564
Epoch: 1, Steps: 1027 | Train Loss: 0.7867753 Vali Loss: 0.3877285 Best vali loss: 0.3877285
	iters: 100, epoch: 2 | loss: 0.3711010
	speed: 0.0076s/iter; left time: 53.6825s
	iters: 200, epoch: 2 | loss: 0.7947287
	speed: 0.0023s/iter; left time: 15.8743s
	iters: 300, epoch: 2 | loss: 0.4366826
	speed: 0.0023s/iter; left time: 15.6866s
	iters: 400, epoch: 2 | loss: 1.9064665
	speed: 0.0023s/iter; left time: 15.6035s
	iters: 500, epoch: 2 | loss: 0.3835745
	speed: 0.0023s/iter; left time: 15.1061s
	iters: 600, epoch: 2 | loss: 0.4402967
	speed: 0.0023s/iter; left time: 15.0471s
	iters: 700, epoch: 2 | loss: 0.3286687
	speed: 0.0023s/iter; left time: 14.9169s
	iters: 800, epoch: 2 | loss: 1.2596844
	speed: 0.0023s/iter; left time: 14.6948s
	iters: 900, epoch: 2 | loss: 0.4655429
	speed: 0.0022s/iter; left time: 13.7379s
	iters: 1000, epoch: 2 | loss: 0.3706965
	speed: 0.0022s/iter; left time: 13.5346s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.3877 --> 0.3834).  Saving model state dict ...
Epoch: 2 cost time: 2.363332986831665
Epoch: 2, Steps: 1027 | Train Loss: 0.6757443 Vali Loss: 0.3834325 Best vali loss: 0.3834325
	iters: 100, epoch: 3 | loss: 0.3234821
	speed: 0.0076s/iter; left time: 46.2318s
	iters: 200, epoch: 3 | loss: 0.2323254
	speed: 0.0025s/iter; left time: 15.0892s
	iters: 300, epoch: 3 | loss: 0.4710245
	speed: 0.0024s/iter; left time: 14.3070s
	iters: 400, epoch: 3 | loss: 0.3105786
	speed: 0.0024s/iter; left time: 13.7263s
	iters: 500, epoch: 3 | loss: 0.3830408
	speed: 0.0024s/iter; left time: 13.4334s
	iters: 600, epoch: 3 | loss: 0.8732061
	speed: 0.0023s/iter; left time: 12.9958s
	iters: 700, epoch: 3 | loss: 1.1694869
	speed: 0.0024s/iter; left time: 13.2880s
	iters: 800, epoch: 3 | loss: 0.2861177
	speed: 0.0025s/iter; left time: 13.6440s
	iters: 900, epoch: 3 | loss: 0.2924987
	speed: 0.0024s/iter; left time: 12.4835s
	iters: 1000, epoch: 3 | loss: 0.2755240
	speed: 0.0024s/iter; left time: 12.1974s
Updating learning rate to 0.001330348698804596
Validation loss decreased (0.3834 --> 0.3833).  Saving model state dict ...
Epoch: 3 cost time: 2.520955801010132
Epoch: 3, Steps: 1027 | Train Loss: 0.4617285 Vali Loss: 0.3833289 Best vali loss: 0.3833289
	iters: 100, epoch: 4 | loss: 0.9149258
	speed: 0.0072s/iter; left time: 36.2235s
	iters: 200, epoch: 4 | loss: 0.5831378
	speed: 0.0022s/iter; left time: 10.9057s
	iters: 300, epoch: 4 | loss: 0.2073615
	speed: 0.0021s/iter; left time: 10.2673s
	iters: 400, epoch: 4 | loss: 0.9491324
	speed: 0.0022s/iter; left time: 10.2952s
	iters: 500, epoch: 4 | loss: 0.2585436
	speed: 0.0022s/iter; left time: 10.1679s
	iters: 600, epoch: 4 | loss: 0.2226198
	speed: 0.0023s/iter; left time: 10.4165s
	iters: 700, epoch: 4 | loss: 0.4344659
	speed: 0.0023s/iter; left time: 10.2603s
	iters: 800, epoch: 4 | loss: 0.4255677
	speed: 0.0022s/iter; left time: 9.6917s
	iters: 900, epoch: 4 | loss: 0.2527089
	speed: 0.0023s/iter; left time: 9.7748s
	iters: 1000, epoch: 4 | loss: 0.2719491
	speed: 0.0024s/iter; left time: 9.8288s
Updating learning rate to 0.0009621498802
Epoch: 4 cost time: 2.341395616531372
Epoch: 4, Steps: 1027 | Train Loss: 0.4520413 Vali Loss: 0.4099957 Best vali loss: 0.3833289
	iters: 100, epoch: 5 | loss: 0.3637474
	speed: 0.0072s/iter; left time: 28.8694s
	iters: 200, epoch: 5 | loss: 0.5144229
	speed: 0.0021s/iter; left time: 8.0626s
	iters: 300, epoch: 5 | loss: 0.3974502
	speed: 0.0020s/iter; left time: 7.8020s
	iters: 400, epoch: 5 | loss: 0.6070660
	speed: 0.0021s/iter; left time: 7.8015s
	iters: 500, epoch: 5 | loss: 0.2021046
	speed: 0.0021s/iter; left time: 7.6844s
	iters: 600, epoch: 5 | loss: 0.8219473
	speed: 0.0021s/iter; left time: 7.1967s
	iters: 700, epoch: 5 | loss: 0.3423841
	speed: 0.0020s/iter; left time: 6.9747s
	iters: 800, epoch: 5 | loss: 0.5195988
	speed: 0.0021s/iter; left time: 6.7969s
	iters: 900, epoch: 5 | loss: 0.5090091
	speed: 0.0021s/iter; left time: 6.6252s
	iters: 1000, epoch: 5 | loss: 0.3382826
	speed: 0.0020s/iter; left time: 6.3283s
Updating learning rate to 0.0005939510615954041
Epoch: 5 cost time: 2.162017822265625
Epoch: 5, Steps: 1027 | Train Loss: 0.4616013 Vali Loss: 0.4136426 Best vali loss: 0.3833289
	iters: 100, epoch: 6 | loss: 0.8167319
	speed: 0.0073s/iter; left time: 21.8560s
	iters: 200, epoch: 6 | loss: 0.7495748
	speed: 0.0022s/iter; left time: 6.4583s
	iters: 300, epoch: 6 | loss: 0.3328142
	speed: 0.0022s/iter; left time: 6.0522s
	iters: 400, epoch: 6 | loss: 1.1520697
	speed: 0.0022s/iter; left time: 5.7959s
	iters: 500, epoch: 6 | loss: 0.5905229
	speed: 0.0022s/iter; left time: 5.6142s
	iters: 600, epoch: 6 | loss: 1.2871004
	speed: 0.0022s/iter; left time: 5.4381s
	iters: 700, epoch: 6 | loss: 0.5518116
	speed: 0.0022s/iter; left time: 5.3151s
	iters: 800, epoch: 6 | loss: 0.3261878
	speed: 0.0023s/iter; left time: 5.1395s
	iters: 900, epoch: 6 | loss: 0.4094920
	speed: 0.0022s/iter; left time: 4.8276s
	iters: 1000, epoch: 6 | loss: 0.4712568
	speed: 0.0022s/iter; left time: 4.5577s
Updating learning rate to 0.0002818071753927558
Epoch: 6 cost time: 2.3168985843658447
Epoch: 6, Steps: 1027 | Train Loss: 0.6687562 Vali Loss: 0.4174035 Best vali loss: 0.3833289
	iters: 100, epoch: 7 | loss: 0.4169116
	speed: 0.0075s/iter; left time: 14.6310s
	iters: 200, epoch: 7 | loss: 0.5473497
	speed: 0.0024s/iter; left time: 4.4164s
	iters: 300, epoch: 7 | loss: 0.5197971
	speed: 0.0024s/iter; left time: 4.1827s
	iters: 400, epoch: 7 | loss: 0.2860208
	speed: 0.0024s/iter; left time: 3.9178s
	iters: 500, epoch: 7 | loss: 0.3822596
	speed: 0.0024s/iter; left time: 3.6909s
	iters: 600, epoch: 7 | loss: 0.5365480
	speed: 0.0024s/iter; left time: 3.4557s
	iters: 700, epoch: 7 | loss: 0.3494988
	speed: 0.0024s/iter; left time: 3.2017s
	iters: 800, epoch: 7 | loss: 0.4686075
	speed: 0.0024s/iter; left time: 3.0042s
	iters: 900, epoch: 7 | loss: 0.2598523
	speed: 0.0024s/iter; left time: 2.7383s
	iters: 1000, epoch: 7 | loss: 0.7425747
	speed: 0.0024s/iter; left time: 2.5228s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 2.4794564247131348
Epoch: 7, Steps: 1027 | Train Loss: 0.4509420 Vali Loss: 0.4426412 Best vali loss: 0.3833289
	iters: 100, epoch: 8 | loss: 0.4066456
	speed: 0.0078s/iter; left time: 7.2227s
	iters: 200, epoch: 8 | loss: 0.2332269
	speed: 0.0022s/iter; left time: 1.8348s
	iters: 300, epoch: 8 | loss: 0.8686049
	speed: 0.0022s/iter; left time: 1.5980s
	iters: 400, epoch: 8 | loss: 0.2315539
	speed: 0.0023s/iter; left time: 1.4340s
	iters: 500, epoch: 8 | loss: 0.2719018
	speed: 0.0022s/iter; left time: 1.1591s
	iters: 600, epoch: 8 | loss: 0.7555285
	speed: 0.0022s/iter; left time: 0.9382s
	iters: 700, epoch: 8 | loss: 0.3857712
	speed: 0.0022s/iter; left time: 0.7246s
	iters: 800, epoch: 8 | loss: 0.1787736
	speed: 0.0022s/iter; left time: 0.4988s
	iters: 900, epoch: 8 | loss: 0.2124514
	speed: 0.0022s/iter; left time: 0.2818s
	iters: 1000, epoch: 8 | loss: 0.5860591
	speed: 0.0022s/iter; left time: 0.0612s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3175759315490723
Epoch: 8, Steps: 1027 | Train Loss: 0.4130517 Vali Loss: 0.4321225 Best vali loss: 0.3833289

best validation loss 0.383328910239319

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9403405
	speed: 0.0112s/iter; left time: 90.8007s
	iters: 200, epoch: 1 | loss: 0.2510541
	speed: 0.0050s/iter; left time: 40.2068s
	iters: 300, epoch: 1 | loss: 1.1405820
	speed: 0.0050s/iter; left time: 39.8209s
	iters: 400, epoch: 1 | loss: 0.5271375
	speed: 0.0050s/iter; left time: 39.2504s
	iters: 500, epoch: 1 | loss: 1.0323671
	speed: 0.0050s/iter; left time: 38.7891s
	iters: 600, epoch: 1 | loss: 0.5051214
	speed: 0.0050s/iter; left time: 38.0927s
	iters: 700, epoch: 1 | loss: 0.2531639
	speed: 0.0050s/iter; left time: 37.7478s
	iters: 800, epoch: 1 | loss: 0.3246399
	speed: 0.0052s/iter; left time: 38.7883s
	iters: 900, epoch: 1 | loss: 0.5028002
	speed: 0.0052s/iter; left time: 38.2269s
	iters: 1000, epoch: 1 | loss: 0.4163092
	speed: 0.0052s/iter; left time: 37.7539s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 5.585224866867065
Epoch: 1, Steps: 1027 | Train Loss: 0.5893516 Vali Loss: 0.3750968 Best vali loss: 0.3750968
	iters: 100, epoch: 2 | loss: 1.2308702
	speed: 0.0135s/iter; left time: 95.6776s
	iters: 200, epoch: 2 | loss: 0.1991393
	speed: 0.0052s/iter; left time: 36.2397s
	iters: 300, epoch: 2 | loss: 0.3721096
	speed: 0.0055s/iter; left time: 37.6777s
	iters: 400, epoch: 2 | loss: 0.4327334
	speed: 0.0052s/iter; left time: 35.4163s
	iters: 500, epoch: 2 | loss: 1.6556702
	speed: 0.0052s/iter; left time: 34.8622s
	iters: 600, epoch: 2 | loss: 0.5259319
	speed: 0.0052s/iter; left time: 34.2644s
	iters: 700, epoch: 2 | loss: 1.5853817
	speed: 0.0052s/iter; left time: 33.6275s
	iters: 800, epoch: 2 | loss: 1.2180145
	speed: 0.0050s/iter; left time: 31.9314s
	iters: 900, epoch: 2 | loss: 0.3460438
	speed: 0.0050s/iter; left time: 31.2483s
	iters: 1000, epoch: 2 | loss: 0.3789380
	speed: 0.0050s/iter; left time: 31.2008s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.3751 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 5.353287935256958
Epoch: 2, Steps: 1027 | Train Loss: 0.7944833 Vali Loss: 0.3629720 Best vali loss: 0.3629720
	iters: 100, epoch: 3 | loss: 0.6692747
	speed: 0.0142s/iter; left time: 85.8393s
	iters: 200, epoch: 3 | loss: 0.1880261
	speed: 0.0051s/iter; left time: 30.6124s
	iters: 300, epoch: 3 | loss: 0.3557955
	speed: 0.0051s/iter; left time: 30.1629s
	iters: 400, epoch: 3 | loss: 0.4077211
	speed: 0.0051s/iter; left time: 29.5997s
	iters: 500, epoch: 3 | loss: 0.7510648
	speed: 0.0052s/iter; left time: 29.5864s
	iters: 600, epoch: 3 | loss: 0.2345226
	speed: 0.0052s/iter; left time: 29.0627s
	iters: 700, epoch: 3 | loss: 0.2686978
	speed: 0.0052s/iter; left time: 28.4783s
	iters: 800, epoch: 3 | loss: 0.6618939
	speed: 0.0052s/iter; left time: 27.8750s
	iters: 900, epoch: 3 | loss: 0.5399659
	speed: 0.0052s/iter; left time: 27.4343s
	iters: 1000, epoch: 3 | loss: 0.7655026
	speed: 0.0052s/iter; left time: 26.6314s
Updating learning rate to 0.00010582472311828629
Epoch: 3 cost time: 5.365089178085327
Epoch: 3, Steps: 1027 | Train Loss: 0.4842465 Vali Loss: 0.3724119 Best vali loss: 0.3629720
	iters: 100, epoch: 4 | loss: 0.4979826
	speed: 0.0132s/iter; left time: 66.5811s
	iters: 200, epoch: 4 | loss: 0.8615547
	speed: 0.0052s/iter; left time: 25.7649s
	iters: 300, epoch: 4 | loss: 0.4324863
	speed: 0.0052s/iter; left time: 25.2187s
	iters: 400, epoch: 4 | loss: 0.3112058
	speed: 0.0052s/iter; left time: 24.6788s
	iters: 500, epoch: 4 | loss: 0.3016425
	speed: 0.0052s/iter; left time: 24.0895s
	iters: 600, epoch: 4 | loss: 0.3998317
	speed: 0.0052s/iter; left time: 23.7196s
	iters: 700, epoch: 4 | loss: 0.3661677
	speed: 0.0052s/iter; left time: 23.0774s
	iters: 800, epoch: 4 | loss: 0.5416673
	speed: 0.0050s/iter; left time: 21.5721s
	iters: 900, epoch: 4 | loss: 0.6507453
	speed: 0.0049s/iter; left time: 20.8901s
	iters: 1000, epoch: 4 | loss: 0.5168082
	speed: 0.0049s/iter; left time: 20.3022s
Updating learning rate to 7.653575695e-05
Validation loss decreased (0.3630 --> 0.3502).  Saving model state dict ...
Epoch: 4 cost time: 5.303133010864258
Epoch: 4, Steps: 1027 | Train Loss: 0.4880092 Vali Loss: 0.3502043 Best vali loss: 0.3502043
	iters: 100, epoch: 5 | loss: 0.5205630
	speed: 0.0137s/iter; left time: 54.8758s
	iters: 200, epoch: 5 | loss: 0.8556483
	speed: 0.0052s/iter; left time: 20.3512s
	iters: 300, epoch: 5 | loss: 0.7376470
	speed: 0.0052s/iter; left time: 19.6213s
	iters: 400, epoch: 5 | loss: 0.2830225
	speed: 0.0052s/iter; left time: 19.1397s
	iters: 500, epoch: 5 | loss: 0.3321400
	speed: 0.0052s/iter; left time: 18.7991s
	iters: 600, epoch: 5 | loss: 0.7047378
	speed: 0.0051s/iter; left time: 18.0550s
	iters: 700, epoch: 5 | loss: 0.1537153
	speed: 0.0051s/iter; left time: 17.5119s
	iters: 800, epoch: 5 | loss: 0.5928000
	speed: 0.0052s/iter; left time: 17.1399s
	iters: 900, epoch: 5 | loss: 0.5083004
	speed: 0.0052s/iter; left time: 16.6288s
	iters: 1000, epoch: 5 | loss: 0.3989427
	speed: 0.0051s/iter; left time: 15.9564s
Updating learning rate to 4.724679078171373e-05
Validation loss decreased (0.3502 --> 0.3493).  Saving model state dict ...
Epoch: 5 cost time: 5.349073648452759
Epoch: 5, Steps: 1027 | Train Loss: 0.5087517 Vali Loss: 0.3493048 Best vali loss: 0.3493048
	iters: 100, epoch: 6 | loss: 0.2700615
	speed: 0.0137s/iter; left time: 40.9499s
	iters: 200, epoch: 6 | loss: 0.7648038
	speed: 0.0050s/iter; left time: 14.3544s
	iters: 300, epoch: 6 | loss: 0.3505729
	speed: 0.0049s/iter; left time: 13.6963s
	iters: 400, epoch: 6 | loss: 0.2197276
	speed: 0.0049s/iter; left time: 13.1594s
	iters: 500, epoch: 6 | loss: 0.6386150
	speed: 0.0049s/iter; left time: 12.6091s
	iters: 600, epoch: 6 | loss: 0.2915619
	speed: 0.0049s/iter; left time: 12.0665s
	iters: 700, epoch: 6 | loss: 0.2078749
	speed: 0.0049s/iter; left time: 11.6110s
	iters: 800, epoch: 6 | loss: 0.7017027
	speed: 0.0048s/iter; left time: 10.9358s
	iters: 900, epoch: 6 | loss: 0.3204460
	speed: 0.0050s/iter; left time: 10.8587s
	iters: 1000, epoch: 6 | loss: 0.2819585
	speed: 0.0050s/iter; left time: 10.3185s
Updating learning rate to 2.2416804207409573e-05
Epoch: 6 cost time: 5.1102893352508545
Epoch: 6, Steps: 1027 | Train Loss: 0.4047325 Vali Loss: 0.3568463 Best vali loss: 0.3493048
	iters: 100, epoch: 7 | loss: 0.2157376
	speed: 0.0132s/iter; left time: 25.7459s
	iters: 200, epoch: 7 | loss: 0.6339700
	speed: 0.0052s/iter; left time: 9.6635s
	iters: 300, epoch: 7 | loss: 0.2021069
	speed: 0.0050s/iter; left time: 8.7722s
	iters: 400, epoch: 7 | loss: 0.2169672
	speed: 0.0050s/iter; left time: 8.2414s
	iters: 500, epoch: 7 | loss: 0.7149269
	speed: 0.0049s/iter; left time: 7.5747s
	iters: 600, epoch: 7 | loss: 0.6294411
	speed: 0.0048s/iter; left time: 7.0226s
	iters: 700, epoch: 7 | loss: 0.5375805
	speed: 0.0049s/iter; left time: 6.5805s
	iters: 800, epoch: 7 | loss: 0.4871583
	speed: 0.0048s/iter; left time: 5.9760s
	iters: 900, epoch: 7 | loss: 0.4951003
	speed: 0.0048s/iter; left time: 5.5400s
	iters: 1000, epoch: 7 | loss: 0.2253846
	speed: 0.0048s/iter; left time: 5.0622s
Updating learning rate to 5.825937598636536e-06
Epoch: 7 cost time: 5.104126214981079
Epoch: 7, Steps: 1027 | Train Loss: 0.4358373 Vali Loss: 0.3628314 Best vali loss: 0.3493048
	iters: 100, epoch: 8 | loss: 0.2964923
	speed: 0.0129s/iter; left time: 11.9328s
	iters: 200, epoch: 8 | loss: 0.3072005
	speed: 0.0049s/iter; left time: 4.0865s
	iters: 300, epoch: 8 | loss: 0.2370028
	speed: 0.0049s/iter; left time: 3.5965s
	iters: 400, epoch: 8 | loss: 0.4081254
	speed: 0.0049s/iter; left time: 3.1048s
	iters: 500, epoch: 8 | loss: 0.4322736
	speed: 0.0049s/iter; left time: 2.5992s
	iters: 600, epoch: 8 | loss: 0.6299765
	speed: 0.0049s/iter; left time: 2.1179s
	iters: 700, epoch: 8 | loss: 0.5325505
	speed: 0.0049s/iter; left time: 1.6158s
	iters: 800, epoch: 8 | loss: 0.2984193
	speed: 0.0049s/iter; left time: 1.1156s
	iters: 900, epoch: 8 | loss: 0.4189483
	speed: 0.0049s/iter; left time: 0.6259s
	iters: 1000, epoch: 8 | loss: 0.5981941
	speed: 0.0049s/iter; left time: 0.1373s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.10002326965332
Epoch: 8, Steps: 1027 | Train Loss: 0.4159183 Vali Loss: 0.3664815 Best vali loss: 0.3493048

best validation loss 0.3493047537175986

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6407150
	speed: 0.0087s/iter; left time: 17.1149s
	iters: 200, epoch: 1 | loss: 0.5658867
	speed: 0.0027s/iter; left time: 4.9675s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.3946).  Saving model state dict ...
Epoch: 1 cost time: 1.0382919311523438
Epoch: 1, Steps: 257 | Train Loss: 0.6033009 Vali Loss: 0.3946495 Best vali loss: 0.3946495
	iters: 100, epoch: 2 | loss: 0.7124529
	speed: 0.0064s/iter; left time: 10.8304s
	iters: 200, epoch: 2 | loss: 0.5278376
	speed: 0.0027s/iter; left time: 4.3548s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.3946 --> 0.3759).  Saving model state dict ...
Epoch: 2 cost time: 0.7347061634063721
Epoch: 2, Steps: 257 | Train Loss: 0.6201453 Vali Loss: 0.3759253 Best vali loss: 0.3759253
	iters: 100, epoch: 3 | loss: 0.5824889
	speed: 0.0064s/iter; left time: 9.1761s
	iters: 200, epoch: 3 | loss: 0.4245911
	speed: 0.0026s/iter; left time: 3.5215s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.3759 --> 0.3694).  Saving model state dict ...
Epoch: 3 cost time: 0.7191259860992432
Epoch: 3, Steps: 257 | Train Loss: 0.5035400 Vali Loss: 0.3693934 Best vali loss: 0.3693934

best validation loss 0.3693933522186017

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.4055).  Saving model state dict ...
Epoch: 1 cost time: 0.6056451797485352
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4055049 Best vali loss: 0.4055049
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.4055 --> 0.3833).  Saving model state dict ...
Epoch: 2 cost time: 0.30666112899780273
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3832668 Best vali loss: 0.3832668
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.3833 --> 0.3773).  Saving model state dict ...
Epoch: 3 cost time: 0.30128979682922363
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3773157 Best vali loss: 0.3773157

best validation loss 0.37731567096616525

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6632571
	speed: 0.0119s/iter; left time: 11.1044s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.4030).  Saving model state dict ...
Epoch: 1 cost time: 1.0993537902832031
Epoch: 1, Steps: 129 | Train Loss: 0.6632571 Vali Loss: 0.4030121 Best vali loss: 0.4030121
	iters: 100, epoch: 2 | loss: 0.7144607
	speed: 0.0094s/iter; left time: 7.5754s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.4030 --> 0.3847).  Saving model state dict ...
Epoch: 2 cost time: 0.7826299667358398
Epoch: 2, Steps: 129 | Train Loss: 0.7144607 Vali Loss: 0.3847397 Best vali loss: 0.3847397
	iters: 100, epoch: 3 | loss: 0.4452259
	speed: 0.0091s/iter; left time: 6.1394s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.3847 --> 0.3768).  Saving model state dict ...
Epoch: 3 cost time: 0.7273995876312256
Epoch: 3, Steps: 129 | Train Loss: 0.4452259 Vali Loss: 0.3767999 Best vali loss: 0.3767999

best validation loss 0.37679985194871374

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5858805
	speed: 0.0087s/iter; left time: 10.2640s
	iters: 200, epoch: 4 | loss: 0.5457097
	speed: 0.0027s/iter; left time: 2.9536s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.3694 --> 0.3671).  Saving model state dict ...
Epoch: 4 cost time: 1.0355823040008545
Epoch: 4, Steps: 257 | Train Loss: 0.5657951 Vali Loss: 0.3671313 Best vali loss: 0.3671313
	iters: 100, epoch: 5 | loss: 0.6191275
	speed: 0.0065s/iter; left time: 6.0153s
	iters: 200, epoch: 5 | loss: 0.5115420
	speed: 0.0026s/iter; left time: 2.1851s
Updating learning rate to 1.7856066821212585e-05
Validation loss decreased (0.3671 --> 0.3669).  Saving model state dict ...
Epoch: 5 cost time: 0.7264010906219482
Epoch: 5, Steps: 257 | Train Loss: 0.5653347 Vali Loss: 0.3669049 Best vali loss: 0.3669049
	iters: 100, epoch: 6 | loss: 0.5667988
	speed: 0.0064s/iter; left time: 4.3073s
	iters: 200, epoch: 6 | loss: 0.4197134
	speed: 0.0029s/iter; left time: 1.6525s
Updating learning rate to 8.472024178210777e-06
Epoch: 6 cost time: 0.7747468948364258
Epoch: 6, Steps: 257 | Train Loss: 0.4932561 Vali Loss: 0.3673626 Best vali loss: 0.3669049
	iters: 100, epoch: 7 | loss: 0.3741870
	speed: 0.0064s/iter; left time: 2.6680s
	iters: 200, epoch: 7 | loss: 0.5506664
	speed: 0.0026s/iter; left time: 0.8169s
Updating learning rate to 2.2018073468332077e-06
Epoch: 7 cost time: 0.7067523002624512
Epoch: 7, Steps: 257 | Train Loss: 0.4624267 Vali Loss: 0.3670023 Best vali loss: 0.3669049
	iters: 100, epoch: 8 | loss: 0.7232514
	speed: 0.0063s/iter; left time: 0.9955s
	iters: 200, epoch: 8 | loss: 0.7772499
	speed: 0.0026s/iter; left time: 0.1517s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7144474983215332
Epoch: 8, Steps: 257 | Train Loss: 0.7502507 Vali Loss: 0.3671284 Best vali loss: 0.3669049

best validation loss 0.36690489860555275

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6232892
	speed: 0.0118s/iter; left time: 10.9926s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.0915381908416748
Epoch: 1, Steps: 129 | Train Loss: 0.6232892 Vali Loss: 0.3689749 Best vali loss: 0.3689749
	iters: 100, epoch: 2 | loss: 0.5530116
	speed: 0.0096s/iter; left time: 7.6839s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.3690 --> 0.3617).  Saving model state dict ...
Epoch: 2 cost time: 0.7987570762634277
Epoch: 2, Steps: 129 | Train Loss: 0.5530116 Vali Loss: 0.3616684 Best vali loss: 0.3616684
	iters: 100, epoch: 3 | loss: 0.5405148
	speed: 0.0094s/iter; left time: 6.3218s
Updating learning rate to 0.000956145404075
Validation loss decreased (0.3617 --> 0.3598).  Saving model state dict ...
Epoch: 3 cost time: 0.7883365154266357
Epoch: 3, Steps: 129 | Train Loss: 0.5405148 Vali Loss: 0.3597826 Best vali loss: 0.3597826
	iters: 100, epoch: 4 | loss: 0.5520310
	speed: 0.0094s/iter; left time: 5.1166s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 0.7804057598114014
Epoch: 4, Steps: 129 | Train Loss: 0.5520310 Vali Loss: 0.3640849 Best vali loss: 0.3597826
	iters: 100, epoch: 5 | loss: 0.5307195
	speed: 0.0097s/iter; left time: 4.0295s
Updating learning rate to 0.00023903635101875
Validation loss decreased (0.3598 --> 0.3547).  Saving model state dict ...
Epoch: 5 cost time: 0.818286657333374
Epoch: 5, Steps: 129 | Train Loss: 0.5307195 Vali Loss: 0.3547114 Best vali loss: 0.3547114
	iters: 100, epoch: 6 | loss: 0.7080239
	speed: 0.0096s/iter; left time: 2.7750s
Updating learning rate to 0.000119518175509375
Validation loss decreased (0.3547 --> 0.3516).  Saving model state dict ...
Epoch: 6 cost time: 0.8004069328308105
Epoch: 6, Steps: 129 | Train Loss: 0.7080239 Vali Loss: 0.3515770 Best vali loss: 0.3515770
	iters: 100, epoch: 7 | loss: 0.5149541
	speed: 0.0094s/iter; left time: 1.4930s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 0.7851598262786865
Epoch: 7, Steps: 129 | Train Loss: 0.5149541 Vali Loss: 0.3525637 Best vali loss: 0.3515770
	iters: 100, epoch: 8 | loss: 0.6749389
	speed: 0.0094s/iter; left time: 0.2818s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 0.791304349899292
Epoch: 8, Steps: 129 | Train Loss: 0.6749389 Vali Loss: 0.3519729 Best vali loss: 0.3515770

best validation loss 0.3515769537867638

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3948409
	speed: 0.0103s/iter; left time: 41.4474s
	iters: 200, epoch: 1 | loss: 0.6086903
	speed: 0.0045s/iter; left time: 17.5806s
	iters: 300, epoch: 1 | loss: 0.3102967
	speed: 0.0045s/iter; left time: 17.0189s
	iters: 400, epoch: 1 | loss: 0.4925835
	speed: 0.0044s/iter; left time: 16.1998s
	iters: 500, epoch: 1 | loss: 1.0897759
	speed: 0.0044s/iter; left time: 15.7889s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.4025).  Saving model state dict ...
Epoch: 1 cost time: 2.6168551445007324
Epoch: 1, Steps: 514 | Train Loss: 0.5792375 Vali Loss: 0.4025325 Best vali loss: 0.4025325
	iters: 100, epoch: 2 | loss: 0.3702000
	speed: 0.0088s/iter; left time: 30.6344s
	iters: 200, epoch: 2 | loss: 0.7820382
	speed: 0.0045s/iter; left time: 15.2884s
	iters: 300, epoch: 2 | loss: 0.4963949
	speed: 0.0043s/iter; left time: 14.1213s
	iters: 400, epoch: 2 | loss: 0.4684015
	speed: 0.0043s/iter; left time: 13.6208s
	iters: 500, epoch: 2 | loss: 0.2870269
	speed: 0.0044s/iter; left time: 13.6987s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 2.296147108078003
Epoch: 2, Steps: 514 | Train Loss: 0.4808123 Vali Loss: 0.4032140 Best vali loss: 0.4025325
	iters: 100, epoch: 3 | loss: 0.4375996
	speed: 0.0088s/iter; left time: 26.3609s
	iters: 200, epoch: 3 | loss: 0.2858085
	speed: 0.0042s/iter; left time: 12.0452s
	iters: 300, epoch: 3 | loss: 0.6221715
	speed: 0.0041s/iter; left time: 11.4230s
	iters: 400, epoch: 3 | loss: 0.4222585
	speed: 0.0041s/iter; left time: 10.9560s
	iters: 500, epoch: 3 | loss: 0.5739474
	speed: 0.0041s/iter; left time: 10.5250s
Updating learning rate to 0.000821473589325
Epoch: 3 cost time: 2.179823637008667
Epoch: 3, Steps: 514 | Train Loss: 0.4683571 Vali Loss: 0.4045339 Best vali loss: 0.4025325
	iters: 100, epoch: 4 | loss: 0.4783032
	speed: 0.0086s/iter; left time: 21.2673s
	iters: 200, epoch: 4 | loss: 0.3231261
	speed: 0.0043s/iter; left time: 10.2320s
	iters: 300, epoch: 4 | loss: 1.0472965
	speed: 0.0043s/iter; left time: 9.7991s
	iters: 400, epoch: 4 | loss: 1.2076391
	speed: 0.0042s/iter; left time: 9.1088s
	iters: 500, epoch: 4 | loss: 0.5410867
	speed: 0.0042s/iter; left time: 8.7686s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 2.2406482696533203
Epoch: 4, Steps: 514 | Train Loss: 0.7194903 Vali Loss: 0.4031392 Best vali loss: 0.4025325
	iters: 100, epoch: 5 | loss: 0.6566859
	speed: 0.0089s/iter; left time: 17.3490s
	iters: 200, epoch: 5 | loss: 0.5818000
	speed: 0.0039s/iter; left time: 7.3128s
	iters: 300, epoch: 5 | loss: 0.3792386
	speed: 0.0038s/iter; left time: 6.7429s
	iters: 400, epoch: 5 | loss: 0.9959031
	speed: 0.0039s/iter; left time: 6.4209s
	iters: 500, epoch: 5 | loss: 0.8748599
	speed: 0.0039s/iter; left time: 6.1094s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 2.0851383209228516
Epoch: 5, Steps: 514 | Train Loss: 0.6976975 Vali Loss: 0.4034160 Best vali loss: 0.4025325
	iters: 100, epoch: 6 | loss: 0.8467012
	speed: 0.0085s/iter; left time: 12.2769s
	iters: 200, epoch: 6 | loss: 0.5070007
	speed: 0.0041s/iter; left time: 5.5266s
	iters: 300, epoch: 6 | loss: 0.6070278
	speed: 0.0041s/iter; left time: 5.0672s
	iters: 400, epoch: 6 | loss: 1.2579873
	speed: 0.0039s/iter; left time: 4.4116s
	iters: 500, epoch: 6 | loss: 0.6267576
	speed: 0.0042s/iter; left time: 4.3299s
Updating learning rate to 0.000102684198665625
Epoch: 6 cost time: 2.143829584121704
Epoch: 6, Steps: 514 | Train Loss: 0.7690949 Vali Loss: 0.4032901 Best vali loss: 0.4025325
	iters: 100, epoch: 7 | loss: 0.9922711
	speed: 0.0084s/iter; left time: 7.8277s
	iters: 200, epoch: 7 | loss: 0.4848145
	speed: 0.0040s/iter; left time: 3.3289s
	iters: 300, epoch: 7 | loss: 0.5864168
	speed: 0.0041s/iter; left time: 2.9774s
	iters: 400, epoch: 7 | loss: 0.5446364
	speed: 0.0040s/iter; left time: 2.5172s
	iters: 500, epoch: 7 | loss: 0.4299610
	speed: 0.0040s/iter; left time: 2.1122s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 2.1349804401397705
Epoch: 7, Steps: 514 | Train Loss: 0.6076200 Vali Loss: 0.4033916 Best vali loss: 0.4025325
	iters: 100, epoch: 8 | loss: 0.8364760
	speed: 0.0088s/iter; left time: 3.6319s
	iters: 200, epoch: 8 | loss: 0.6045584
	speed: 0.0045s/iter; left time: 1.4034s
	iters: 300, epoch: 8 | loss: 0.5574353
	speed: 0.0044s/iter; left time: 0.9544s
	iters: 400, epoch: 8 | loss: 0.4003631
	speed: 0.0044s/iter; left time: 0.5069s
	iters: 500, epoch: 8 | loss: 1.5859327
	speed: 0.0043s/iter; left time: 0.0645s
Updating learning rate to 2.567104966640625e-05
Epoch: 8 cost time: 2.313832998275757
Epoch: 8, Steps: 514 | Train Loss: 0.7969531 Vali Loss: 0.4034070 Best vali loss: 0.4025325

best validation loss 0.4025324833884923

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 0.6964688301086426
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3743653 Best vali loss: 0.3743653
Updating learning rate to 0.0025938006666821026
Epoch: 2 cost time: 0.4046971797943115
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3801330 Best vali loss: 0.3743653
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.401442289352417
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3776173 Best vali loss: 0.3743653

best validation loss 0.3743652702080477

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.4006).  Saving model state dict ...
Epoch: 1 cost time: 0.7192518711090088
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4006320 Best vali loss: 0.4006320
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.4006 --> 0.3840).  Saving model state dict ...
Epoch: 2 cost time: 0.40818309783935547
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3840010 Best vali loss: 0.3840010
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.3840 --> 0.3757).  Saving model state dict ...
Epoch: 3 cost time: 0.4167485237121582
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3756729 Best vali loss: 0.3756729

best validation loss 0.3756728503230981

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4314144
	speed: 0.0102s/iter; left time: 82.8197s
	iters: 200, epoch: 1 | loss: 0.8453467
	speed: 0.0042s/iter; left time: 33.4554s
	iters: 300, epoch: 1 | loss: 0.3140104
	speed: 0.0042s/iter; left time: 33.0363s
	iters: 400, epoch: 1 | loss: 0.6051841
	speed: 0.0042s/iter; left time: 32.6654s
	iters: 500, epoch: 1 | loss: 0.2322680
	speed: 0.0041s/iter; left time: 31.5627s
	iters: 600, epoch: 1 | loss: 0.4613162
	speed: 0.0044s/iter; left time: 33.1547s
	iters: 700, epoch: 1 | loss: 0.9729568
	speed: 0.0043s/iter; left time: 32.5912s
	iters: 800, epoch: 1 | loss: 0.6082321
	speed: 0.0043s/iter; left time: 31.5934s
	iters: 900, epoch: 1 | loss: 0.4860791
	speed: 0.0044s/iter; left time: 31.8541s
	iters: 1000, epoch: 1 | loss: 1.1052068
	speed: 0.0042s/iter; left time: 30.5009s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.3925).  Saving model state dict ...
Epoch: 1 cost time: 4.6939849853515625
Epoch: 1, Steps: 1027 | Train Loss: 0.6062015 Vali Loss: 0.3925474 Best vali loss: 0.3925474
	iters: 100, epoch: 2 | loss: 0.3512512
	speed: 0.0112s/iter; left time: 79.6857s
	iters: 200, epoch: 2 | loss: 0.5355294
	speed: 0.0042s/iter; left time: 29.1436s
	iters: 300, epoch: 2 | loss: 0.3497189
	speed: 0.0042s/iter; left time: 28.6949s
	iters: 400, epoch: 2 | loss: 1.7582874
	speed: 0.0042s/iter; left time: 28.3198s
	iters: 500, epoch: 2 | loss: 0.3290341
	speed: 0.0040s/iter; left time: 27.0283s
	iters: 600, epoch: 2 | loss: 0.9382144
	speed: 0.0039s/iter; left time: 25.9700s
	iters: 700, epoch: 2 | loss: 0.2540752
	speed: 0.0039s/iter; left time: 25.4285s
	iters: 800, epoch: 2 | loss: 0.4190030
	speed: 0.0039s/iter; left time: 24.8122s
	iters: 900, epoch: 2 | loss: 0.9658327
	speed: 0.0040s/iter; left time: 24.8883s
	iters: 1000, epoch: 2 | loss: 0.3707677
	speed: 0.0039s/iter; left time: 24.2825s
Updating learning rate to 0.0013641652329598032
Validation loss decreased (0.3925 --> 0.3823).  Saving model state dict ...
Epoch: 2 cost time: 4.1771745681762695
Epoch: 2, Steps: 1027 | Train Loss: 0.6271714 Vali Loss: 0.3822931 Best vali loss: 0.3822931
	iters: 100, epoch: 3 | loss: 0.6000127
	speed: 0.0108s/iter; left time: 65.7095s
	iters: 200, epoch: 3 | loss: 1.1278565
	speed: 0.0035s/iter; left time: 21.1157s
	iters: 300, epoch: 3 | loss: 1.6500460
	speed: 0.0036s/iter; left time: 20.8824s
	iters: 400, epoch: 3 | loss: 0.2204579
	speed: 0.0036s/iter; left time: 20.5179s
	iters: 500, epoch: 3 | loss: 0.2957029
	speed: 0.0038s/iter; left time: 21.3162s
	iters: 600, epoch: 3 | loss: 0.4495265
	speed: 0.0037s/iter; left time: 20.8486s
	iters: 700, epoch: 3 | loss: 0.3174297
	speed: 0.0036s/iter; left time: 19.7325s
	iters: 800, epoch: 3 | loss: 0.9532962
	speed: 0.0036s/iter; left time: 19.4042s
	iters: 900, epoch: 3 | loss: 0.6522385
	speed: 0.0036s/iter; left time: 18.9589s
	iters: 1000, epoch: 3 | loss: 0.3789782
	speed: 0.0036s/iter; left time: 18.5154s
Updating learning rate to 0.0011049154554414859
Epoch: 3 cost time: 3.7561588287353516
Epoch: 3, Steps: 1027 | Train Loss: 0.6645545 Vali Loss: 0.3948113 Best vali loss: 0.3822931

best validation loss 0.3822931236157483

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 0.7206909656524658
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3863669 Best vali loss: 0.3743653
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 0.41072916984558105
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4017748 Best vali loss: 0.3743653
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 0.3957986831665039
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4079076 Best vali loss: 0.3743653
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 0.4032135009765625
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3911937 Best vali loss: 0.3743653
Updating learning rate to 0.0
Epoch: 8 cost time: 0.40382838249206543
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3964958 Best vali loss: 0.3743653

best validation loss 0.3743652702080477

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5083258
	speed: 0.0081s/iter; left time: 65.9521s
	iters: 200, epoch: 1 | loss: 0.2757610
	speed: 0.0022s/iter; left time: 17.8250s
	iters: 300, epoch: 1 | loss: 0.4409836
	speed: 0.0022s/iter; left time: 17.7187s
	iters: 400, epoch: 1 | loss: 0.4330593
	speed: 0.0022s/iter; left time: 17.3620s
	iters: 500, epoch: 1 | loss: 0.2164832
	speed: 0.0023s/iter; left time: 17.4995s
	iters: 600, epoch: 1 | loss: 1.1361765
	speed: 0.0024s/iter; left time: 17.9860s
	iters: 700, epoch: 1 | loss: 0.3719678
	speed: 0.0023s/iter; left time: 17.6456s
	iters: 800, epoch: 1 | loss: 0.2670626
	speed: 0.0023s/iter; left time: 17.3308s
	iters: 900, epoch: 1 | loss: 1.3168617
	speed: 0.0023s/iter; left time: 16.9911s
	iters: 1000, epoch: 1 | loss: 1.0532454
	speed: 0.0022s/iter; left time: 15.8774s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 2.6769394874572754
Epoch: 1, Steps: 1027 | Train Loss: 0.6019927 Vali Loss: 0.3695375 Best vali loss: 0.3695375
	iters: 100, epoch: 2 | loss: 0.6334462
	speed: 0.0074s/iter; left time: 52.4096s
	iters: 200, epoch: 2 | loss: 1.1173418
	speed: 0.0024s/iter; left time: 16.5308s
	iters: 300, epoch: 2 | loss: 0.4343577
	speed: 0.0022s/iter; left time: 15.0728s
	iters: 400, epoch: 2 | loss: 0.4128014
	speed: 0.0022s/iter; left time: 14.7366s
	iters: 500, epoch: 2 | loss: 0.3307909
	speed: 0.0022s/iter; left time: 14.4598s
	iters: 600, epoch: 2 | loss: 1.2152656
	speed: 0.0022s/iter; left time: 14.2493s
	iters: 700, epoch: 2 | loss: 0.5294794
	speed: 0.0022s/iter; left time: 14.0693s
	iters: 800, epoch: 2 | loss: 0.5542258
	speed: 0.0022s/iter; left time: 13.9250s
	iters: 900, epoch: 2 | loss: 1.1700006
	speed: 0.0022s/iter; left time: 13.6489s
	iters: 1000, epoch: 2 | loss: 0.9580405
	speed: 0.0022s/iter; left time: 13.6477s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 2.310955762863159
Epoch: 2, Steps: 1027 | Train Loss: 0.7355750 Vali Loss: 0.3773101 Best vali loss: 0.3695375
	iters: 100, epoch: 3 | loss: 0.6517554
	speed: 0.0072s/iter; left time: 43.5802s
	iters: 200, epoch: 3 | loss: 0.5050877
	speed: 0.0021s/iter; left time: 12.5072s
	iters: 300, epoch: 3 | loss: 0.2007530
	speed: 0.0021s/iter; left time: 12.2593s
	iters: 400, epoch: 3 | loss: 0.5196767
	speed: 0.0021s/iter; left time: 12.0527s
	iters: 500, epoch: 3 | loss: 1.1675161
	speed: 0.0021s/iter; left time: 11.7948s
	iters: 600, epoch: 3 | loss: 0.7121263
	speed: 0.0021s/iter; left time: 11.9425s
	iters: 700, epoch: 3 | loss: 1.3061339
	speed: 0.0021s/iter; left time: 11.4981s
	iters: 800, epoch: 3 | loss: 0.2885508
	speed: 0.0021s/iter; left time: 11.2479s
	iters: 900, epoch: 3 | loss: 0.7959418
	speed: 0.0021s/iter; left time: 11.1075s
	iters: 1000, epoch: 3 | loss: 0.9332997
	speed: 0.0021s/iter; left time: 10.8343s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 2.1995460987091064
Epoch: 3, Steps: 1027 | Train Loss: 0.7080841 Vali Loss: 0.3773677 Best vali loss: 0.3695375
	iters: 100, epoch: 4 | loss: 0.2884359
	speed: 0.0075s/iter; left time: 37.5588s
	iters: 200, epoch: 4 | loss: 0.7404339
	speed: 0.0024s/iter; left time: 11.6189s
	iters: 300, epoch: 4 | loss: 0.5188512
	speed: 0.0023s/iter; left time: 11.3117s
	iters: 400, epoch: 4 | loss: 0.4763316
	speed: 0.0024s/iter; left time: 11.1653s
	iters: 500, epoch: 4 | loss: 0.3192078
	speed: 0.0024s/iter; left time: 11.2245s
	iters: 600, epoch: 4 | loss: 0.3255916
	speed: 0.0023s/iter; left time: 10.6120s
	iters: 700, epoch: 4 | loss: 0.2882687
	speed: 0.0024s/iter; left time: 10.6791s
	iters: 800, epoch: 4 | loss: 0.2976515
	speed: 0.0024s/iter; left time: 10.4147s
	iters: 900, epoch: 4 | loss: 1.0654649
	speed: 0.0024s/iter; left time: 10.3260s
	iters: 1000, epoch: 4 | loss: 0.6041585
	speed: 0.0023s/iter; left time: 9.6983s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 2.4727909564971924
Epoch: 4, Steps: 1027 | Train Loss: 0.4924396 Vali Loss: 0.3797058 Best vali loss: 0.3695375
	iters: 100, epoch: 5 | loss: 0.6043802
	speed: 0.0072s/iter; left time: 28.8767s
	iters: 200, epoch: 5 | loss: 0.3635394
	speed: 0.0023s/iter; left time: 9.0332s
	iters: 300, epoch: 5 | loss: 0.4992768
	speed: 0.0023s/iter; left time: 8.6812s
	iters: 400, epoch: 5 | loss: 1.1729193
	speed: 0.0023s/iter; left time: 8.6223s
	iters: 500, epoch: 5 | loss: 0.3655034
	speed: 0.0025s/iter; left time: 8.8512s
	iters: 600, epoch: 5 | loss: 0.2222359
	speed: 0.0024s/iter; left time: 8.4118s
	iters: 700, epoch: 5 | loss: 0.6567111
	speed: 0.0023s/iter; left time: 7.9781s
	iters: 800, epoch: 5 | loss: 0.2924511
	speed: 0.0024s/iter; left time: 7.8517s
	iters: 900, epoch: 5 | loss: 0.4770514
	speed: 0.0024s/iter; left time: 7.5605s
	iters: 1000, epoch: 5 | loss: 0.4641474
	speed: 0.0023s/iter; left time: 7.1598s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 2.44203519821167
Epoch: 5, Steps: 1027 | Train Loss: 0.5118216 Vali Loss: 0.3837584 Best vali loss: 0.3695375
	iters: 100, epoch: 6 | loss: 0.2515256
	speed: 0.0075s/iter; left time: 22.4825s
	iters: 200, epoch: 6 | loss: 0.4072807
	speed: 0.0022s/iter; left time: 6.2926s
	iters: 300, epoch: 6 | loss: 0.3212737
	speed: 0.0022s/iter; left time: 6.0266s
	iters: 400, epoch: 6 | loss: 0.6220251
	speed: 0.0022s/iter; left time: 5.8570s
	iters: 500, epoch: 6 | loss: 0.2964546
	speed: 0.0022s/iter; left time: 5.6068s
	iters: 600, epoch: 6 | loss: 0.7752023
	speed: 0.0022s/iter; left time: 5.4025s
	iters: 700, epoch: 6 | loss: 0.2080818
	speed: 0.0022s/iter; left time: 5.1677s
	iters: 800, epoch: 6 | loss: 0.3541681
	speed: 0.0022s/iter; left time: 4.9564s
	iters: 900, epoch: 6 | loss: 0.3028274
	speed: 0.0022s/iter; left time: 4.7685s
	iters: 1000, epoch: 6 | loss: 0.4636997
	speed: 0.0022s/iter; left time: 4.5210s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 2.2899136543273926
Epoch: 6, Steps: 1027 | Train Loss: 0.4002539 Vali Loss: 0.3838844 Best vali loss: 0.3695375
	iters: 100, epoch: 7 | loss: 0.7989547
	speed: 0.0075s/iter; left time: 14.6271s
	iters: 200, epoch: 7 | loss: 0.4551536
	speed: 0.0024s/iter; left time: 4.3722s
	iters: 300, epoch: 7 | loss: 0.3418345
	speed: 0.0024s/iter; left time: 4.1685s
	iters: 400, epoch: 7 | loss: 0.3479948
	speed: 0.0024s/iter; left time: 3.8998s
	iters: 500, epoch: 7 | loss: 0.9082726
	speed: 0.0023s/iter; left time: 3.6209s
	iters: 600, epoch: 7 | loss: 0.4098041
	speed: 0.0024s/iter; left time: 3.4269s
	iters: 700, epoch: 7 | loss: 0.2492343
	speed: 0.0024s/iter; left time: 3.2045s
	iters: 800, epoch: 7 | loss: 0.3252937
	speed: 0.0023s/iter; left time: 2.9175s
	iters: 900, epoch: 7 | loss: 0.2929614
	speed: 0.0023s/iter; left time: 2.6371s
	iters: 1000, epoch: 7 | loss: 0.4113535
	speed: 0.0023s/iter; left time: 2.4185s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 2.44455623626709
Epoch: 7, Steps: 1027 | Train Loss: 0.4540857 Vali Loss: 0.3836117 Best vali loss: 0.3695375
	iters: 100, epoch: 8 | loss: 0.8275717
	speed: 0.0076s/iter; left time: 7.0978s
	iters: 200, epoch: 8 | loss: 0.2557327
	speed: 0.0023s/iter; left time: 1.9378s
	iters: 300, epoch: 8 | loss: 0.2486395
	speed: 0.0024s/iter; left time: 1.7197s
	iters: 400, epoch: 8 | loss: 0.6019968
	speed: 0.0024s/iter; left time: 1.4813s
	iters: 500, epoch: 8 | loss: 0.2984832
	speed: 0.0024s/iter; left time: 1.2420s
	iters: 600, epoch: 8 | loss: 0.8218654
	speed: 0.0023s/iter; left time: 1.0054s
	iters: 700, epoch: 8 | loss: 0.9029074
	speed: 0.0023s/iter; left time: 0.7676s
	iters: 800, epoch: 8 | loss: 0.1774314
	speed: 0.0023s/iter; left time: 0.5357s
	iters: 900, epoch: 8 | loss: 0.3295360
	speed: 0.0023s/iter; left time: 0.3005s
	iters: 1000, epoch: 8 | loss: 0.2655491
	speed: 0.0024s/iter; left time: 0.0658s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 2.45906400680542
Epoch: 8, Steps: 1027 | Train Loss: 0.4729713 Vali Loss: 0.3833123 Best vali loss: 0.3695375

best validation loss 0.3695374690069431

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4490148
	speed: 0.0104s/iter; left time: 20.3542s
	iters: 200, epoch: 1 | loss: 1.0620397
	speed: 0.0040s/iter; left time: 7.4672s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 1.4005985260009766
Epoch: 1, Steps: 257 | Train Loss: 0.7555273 Vali Loss: 0.3800147 Best vali loss: 0.3800147
	iters: 100, epoch: 2 | loss: 0.4468892
	speed: 0.0089s/iter; left time: 15.1427s
	iters: 200, epoch: 2 | loss: 0.8696648
	speed: 0.0040s/iter; left time: 6.4294s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.3800 --> 0.3681).  Saving model state dict ...
Epoch: 2 cost time: 1.1049816608428955
Epoch: 2, Steps: 257 | Train Loss: 0.6582770 Vali Loss: 0.3681182 Best vali loss: 0.3681182
	iters: 100, epoch: 3 | loss: 0.4390881
	speed: 0.0091s/iter; left time: 13.1065s
	iters: 200, epoch: 3 | loss: 0.4167971
	speed: 0.0041s/iter; left time: 5.4502s
Updating learning rate to 3.8746933325e-05
Validation loss decreased (0.3681 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 1.1036567687988281
Epoch: 3, Steps: 257 | Train Loss: 0.4279426 Vali Loss: 0.3676654 Best vali loss: 0.3676654
	iters: 100, epoch: 4 | loss: 0.5939962
	speed: 0.0098s/iter; left time: 11.5998s
	iters: 200, epoch: 4 | loss: 0.3093784
	speed: 0.0045s/iter; left time: 4.9005s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.3677 --> 0.3662).  Saving model state dict ...
Epoch: 4 cost time: 1.214311122894287
Epoch: 4, Steps: 257 | Train Loss: 0.4516873 Vali Loss: 0.3662076 Best vali loss: 0.3662076
	iters: 100, epoch: 5 | loss: 0.6398381
	speed: 0.0094s/iter; left time: 8.7049s
	iters: 200, epoch: 5 | loss: 0.8597845
	speed: 0.0042s/iter; left time: 3.4435s
Updating learning rate to 9.68673333125e-06
Epoch: 5 cost time: 1.1212215423583984
Epoch: 5, Steps: 257 | Train Loss: 0.7498113 Vali Loss: 0.3663137 Best vali loss: 0.3662076
	iters: 100, epoch: 6 | loss: 0.8185682
	speed: 0.0091s/iter; left time: 6.0956s
	iters: 200, epoch: 6 | loss: 0.5408171
	speed: 0.0040s/iter; left time: 2.3011s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 1.0982375144958496
Epoch: 6, Steps: 257 | Train Loss: 0.6796927 Vali Loss: 0.3662365 Best vali loss: 0.3662076
	iters: 100, epoch: 7 | loss: 0.9928078
	speed: 0.0089s/iter; left time: 3.7097s
	iters: 200, epoch: 7 | loss: 0.5398086
	speed: 0.0039s/iter; left time: 1.2358s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 1.0586049556732178
Epoch: 7, Steps: 257 | Train Loss: 0.7663082 Vali Loss: 0.3662552 Best vali loss: 0.3662076
	iters: 100, epoch: 8 | loss: 0.8042796
	speed: 0.0087s/iter; left time: 1.3777s
	iters: 200, epoch: 8 | loss: 0.7032928
	speed: 0.0040s/iter; left time: 0.2334s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 1.0719034671783447
Epoch: 8, Steps: 257 | Train Loss: 0.7537862 Vali Loss: 0.3662714 Best vali loss: 0.3662076

best validation loss 0.36620758488510824

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5791466
	speed: 0.0104s/iter; left time: 9.6781s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 0.8946082592010498
Epoch: 1, Steps: 129 | Train Loss: 0.5791466 Vali Loss: 0.3671319 Best vali loss: 0.3671319
	iters: 100, epoch: 2 | loss: 0.5474000
	speed: 0.0072s/iter; left time: 5.7727s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 0.5737268924713135
Epoch: 2, Steps: 129 | Train Loss: 0.5474000 Vali Loss: 0.3759831 Best vali loss: 0.3671319
	iters: 100, epoch: 3 | loss: 0.6999136
	speed: 0.0072s/iter; left time: 4.8808s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 0.5738835334777832
Epoch: 3, Steps: 129 | Train Loss: 0.6999136 Vali Loss: 0.3708487 Best vali loss: 0.3671319

best validation loss 0.36713191796613814

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 0.7836129665374756
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706527 Best vali loss: 0.3706527
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.3707 --> 0.3699).  Saving model state dict ...
Epoch: 2 cost time: 0.4540140628814697
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3698579 Best vali loss: 0.3698579
Updating learning rate to 0.0013279966230694852
Validation loss decreased (0.3699 --> 0.3691).  Saving model state dict ...
Epoch: 3 cost time: 0.4750683307647705
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3690692 Best vali loss: 0.3690692

best validation loss 0.36906918382129406

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6541408
	speed: 0.0087s/iter; left time: 16.9941s
	iters: 200, epoch: 1 | loss: 0.5457284
	speed: 0.0026s/iter; left time: 4.7827s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 1.0165860652923584
Epoch: 1, Steps: 257 | Train Loss: 0.5999346 Vali Loss: 0.3670771 Best vali loss: 0.3670771
	iters: 100, epoch: 2 | loss: 0.6234131
	speed: 0.0064s/iter; left time: 10.9002s
	iters: 200, epoch: 2 | loss: 0.3429789
	speed: 0.0028s/iter; left time: 4.4639s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.3671 --> 0.3622).  Saving model state dict ...
Epoch: 2 cost time: 0.7655367851257324
Epoch: 2, Steps: 257 | Train Loss: 0.4831960 Vali Loss: 0.3622359 Best vali loss: 0.3622359
	iters: 100, epoch: 3 | loss: 0.5501881
	speed: 0.0066s/iter; left time: 9.5074s
	iters: 200, epoch: 3 | loss: 0.6006998
	speed: 0.0029s/iter; left time: 3.9530s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 0.7806241512298584
Epoch: 3, Steps: 257 | Train Loss: 0.5754440 Vali Loss: 0.3703543 Best vali loss: 0.3622359

best validation loss 0.3622358912803335

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5974420
	speed: 0.0087s/iter; left time: 10.3760s
	iters: 200, epoch: 4 | loss: 0.4793311
	speed: 0.0027s/iter; left time: 2.8786s
Updating learning rate to 0.00034399402465
Epoch: 4 cost time: 1.025270700454712
Epoch: 4, Steps: 257 | Train Loss: 0.5383866 Vali Loss: 0.3796809 Best vali loss: 0.3622359
	iters: 100, epoch: 5 | loss: 0.5702112
	speed: 0.0064s/iter; left time: 5.9802s
	iters: 200, epoch: 5 | loss: 0.2906631
	speed: 0.0026s/iter; left time: 2.1860s
Updating learning rate to 0.00021235321058385673
Epoch: 5 cost time: 0.718442440032959
Epoch: 5, Steps: 257 | Train Loss: 0.4304371 Vali Loss: 0.3853641 Best vali loss: 0.3622359
	iters: 100, epoch: 6 | loss: 0.5132976
	speed: 0.0064s/iter; left time: 4.2930s
	iters: 200, epoch: 6 | loss: 0.5855001
	speed: 0.0026s/iter; left time: 1.4774s
Updating learning rate to 0.00010075351713233263
Epoch: 6 cost time: 0.721066951751709
Epoch: 6, Steps: 257 | Train Loss: 0.5493988 Vali Loss: 0.3926730 Best vali loss: 0.3622359
	iters: 100, epoch: 7 | loss: 0.4640875
	speed: 0.0063s/iter; left time: 2.6221s
	iters: 200, epoch: 7 | loss: 0.4142731
	speed: 0.0025s/iter; left time: 0.8008s
Updating learning rate to 2.6184985969681952e-05
Epoch: 7 cost time: 0.6969330310821533
Epoch: 7, Steps: 257 | Train Loss: 0.4391803 Vali Loss: 0.3916447 Best vali loss: 0.3622359
	iters: 100, epoch: 8 | loss: 0.4865875
	speed: 0.0064s/iter; left time: 1.0066s
	iters: 200, epoch: 8 | loss: 0.6358122
	speed: 0.0025s/iter; left time: 0.1465s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6995184421539307
Epoch: 8, Steps: 257 | Train Loss: 0.5611998 Vali Loss: 0.3943273 Best vali loss: 0.3622359

best validation loss 0.3622358912803335

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.4189).  Saving model state dict ...
Epoch: 1 cost time: 0.594501256942749
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4189088 Best vali loss: 0.4189088
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.4189 --> 0.3987).  Saving model state dict ...
Epoch: 2 cost time: 0.3087632656097412
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3987379 Best vali loss: 0.3987379
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.3987 --> 0.3871).  Saving model state dict ...
Epoch: 3 cost time: 0.3060624599456787
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3870725 Best vali loss: 0.3870725
Updating learning rate to 0.00012607677965
Validation loss decreased (0.3871 --> 0.3815).  Saving model state dict ...
Epoch: 4 cost time: 0.3009481430053711
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3815082 Best vali loss: 0.3815082
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.3815 --> 0.3779).  Saving model state dict ...
Epoch: 5 cost time: 0.2937197685241699
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3779277 Best vali loss: 0.3779277
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.3779 --> 0.3765).  Saving model state dict ...
Epoch: 6 cost time: 0.310518741607666
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3765083 Best vali loss: 0.3765083
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.3765 --> 0.3757).  Saving model state dict ...
Epoch: 7 cost time: 0.30017995834350586
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3757327 Best vali loss: 0.3757327
Updating learning rate to 0.0
Validation loss decreased (0.3757 --> 0.3755).  Saving model state dict ...
Epoch: 8 cost time: 0.3012115955352783
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3755454 Best vali loss: 0.3755454

best validation loss 0.3755454052525091

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4583203
	speed: 0.0113s/iter; left time: 10.5183s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.0231499671936035
Epoch: 1, Steps: 129 | Train Loss: 0.4583203 Vali Loss: 0.3670406 Best vali loss: 0.3670406
	iters: 100, epoch: 2 | loss: 0.8212556
	speed: 0.0079s/iter; left time: 6.3860s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 0.6247632503509521
Epoch: 2, Steps: 129 | Train Loss: 0.8212556 Vali Loss: 0.3717321 Best vali loss: 0.3670406
	iters: 100, epoch: 3 | loss: 0.5898932
	speed: 0.0080s/iter; left time: 5.4319s
Updating learning rate to 0.000162871860575
Validation loss decreased (0.3670 --> 0.3660).  Saving model state dict ...
Epoch: 3 cost time: 0.6669042110443115
Epoch: 3, Steps: 129 | Train Loss: 0.5898932 Vali Loss: 0.3659651 Best vali loss: 0.3659651
	iters: 100, epoch: 4 | loss: 0.3881087
	speed: 0.0083s/iter; left time: 4.5538s
Updating learning rate to 8.14359302875e-05
Validation loss decreased (0.3660 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 0.6844396591186523
Epoch: 4, Steps: 129 | Train Loss: 0.3881087 Vali Loss: 0.3513389 Best vali loss: 0.3513389
	iters: 100, epoch: 5 | loss: 0.5279941
	speed: 0.0086s/iter; left time: 3.5888s
Updating learning rate to 4.071796514375e-05
Epoch: 5 cost time: 0.6943278312683105
Epoch: 5, Steps: 129 | Train Loss: 0.5279941 Vali Loss: 0.3529952 Best vali loss: 0.3513389
	iters: 100, epoch: 6 | loss: 0.5032858
	speed: 0.0082s/iter; left time: 2.3492s
Updating learning rate to 2.0358982571875e-05
Epoch: 6 cost time: 0.6700639724731445
Epoch: 6, Steps: 129 | Train Loss: 0.5032858 Vali Loss: 0.3523760 Best vali loss: 0.3513389
	iters: 100, epoch: 7 | loss: 0.5262806
	speed: 0.0082s/iter; left time: 1.3092s
Updating learning rate to 1.01794912859375e-05
Validation loss decreased (0.3513 --> 0.3509).  Saving model state dict ...
Epoch: 7 cost time: 0.6640677452087402
Epoch: 7, Steps: 129 | Train Loss: 0.5262806 Vali Loss: 0.3508634 Best vali loss: 0.3508634
	iters: 100, epoch: 8 | loss: 0.4628353
	speed: 0.0080s/iter; left time: 0.2397s
Updating learning rate to 5.08974564296875e-06
Epoch: 8 cost time: 0.6368529796600342
Epoch: 8, Steps: 129 | Train Loss: 0.4628353 Vali Loss: 0.3520599 Best vali loss: 0.3508634

best validation loss 0.35086339196896504

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6655768
	speed: 0.0090s/iter; left time: 8.3880s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 0.7343077659606934
Epoch: 1, Steps: 129 | Train Loss: 0.6655768 Vali Loss: 0.3748678 Best vali loss: 0.3748678
	iters: 100, epoch: 2 | loss: 0.5196534
	speed: 0.0055s/iter; left time: 4.4254s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.3749 --> 0.3672).  Saving model state dict ...
Epoch: 2 cost time: 0.4133930206298828
Epoch: 2, Steps: 129 | Train Loss: 0.5196534 Vali Loss: 0.3671632 Best vali loss: 0.3671632
	iters: 100, epoch: 3 | loss: 0.7882104
	speed: 0.0054s/iter; left time: 3.6735s
Updating learning rate to 0.00046564185792360155
Validation loss decreased (0.3672 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 0.4017457962036133
Epoch: 3, Steps: 129 | Train Loss: 0.7882104 Vali Loss: 0.3662150 Best vali loss: 0.3662150

best validation loss 0.36621502846303766

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6976160
	speed: 0.0096s/iter; left time: 78.0445s
	iters: 200, epoch: 1 | loss: 1.0550243
	speed: 0.0034s/iter; left time: 27.0581s
	iters: 300, epoch: 1 | loss: 0.5510468
	speed: 0.0033s/iter; left time: 26.4634s
	iters: 400, epoch: 1 | loss: 0.3599459
	speed: 0.0034s/iter; left time: 26.2686s
	iters: 500, epoch: 1 | loss: 0.9463756
	speed: 0.0033s/iter; left time: 25.6775s
	iters: 600, epoch: 1 | loss: 1.1386013
	speed: 0.0034s/iter; left time: 25.9152s
	iters: 700, epoch: 1 | loss: 0.4039845
	speed: 0.0034s/iter; left time: 25.3133s
	iters: 800, epoch: 1 | loss: 1.1670455
	speed: 0.0034s/iter; left time: 25.1754s
	iters: 900, epoch: 1 | loss: 1.2023957
	speed: 0.0034s/iter; left time: 24.7751s
	iters: 1000, epoch: 1 | loss: 0.3571854
	speed: 0.0035s/iter; left time: 24.9383s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.4019).  Saving model state dict ...
Epoch: 1 cost time: 3.8307881355285645
Epoch: 1, Steps: 1027 | Train Loss: 0.7879221 Vali Loss: 0.4018834 Best vali loss: 0.4018834
	iters: 100, epoch: 2 | loss: 0.4178559
	speed: 0.0092s/iter; left time: 65.0289s
	iters: 200, epoch: 2 | loss: 0.4745667
	speed: 0.0028s/iter; left time: 19.7488s
	iters: 300, epoch: 2 | loss: 0.4564523
	speed: 0.0028s/iter; left time: 19.4811s
	iters: 400, epoch: 2 | loss: 0.3134440
	speed: 0.0030s/iter; left time: 20.1888s
	iters: 500, epoch: 2 | loss: 0.3630237
	speed: 0.0030s/iter; left time: 19.8454s
	iters: 600, epoch: 2 | loss: 0.5045131
	speed: 0.0029s/iter; left time: 19.2601s
	iters: 700, epoch: 2 | loss: 0.3324800
	speed: 0.0029s/iter; left time: 18.9533s
	iters: 800, epoch: 2 | loss: 0.7422003
	speed: 0.0029s/iter; left time: 18.5676s
	iters: 900, epoch: 2 | loss: 1.1009337
	speed: 0.0029s/iter; left time: 18.1044s
	iters: 1000, epoch: 2 | loss: 0.5785457
	speed: 0.0030s/iter; left time: 18.5271s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 3.0238590240478516
Epoch: 2, Steps: 1027 | Train Loss: 0.5284015 Vali Loss: 0.4064712 Best vali loss: 0.4018834
	iters: 100, epoch: 3 | loss: 0.5860876
	speed: 0.0093s/iter; left time: 56.1378s
	iters: 200, epoch: 3 | loss: 0.5021978
	speed: 0.0034s/iter; left time: 20.4394s
	iters: 300, epoch: 3 | loss: 0.9885700
	speed: 0.0035s/iter; left time: 20.5196s
	iters: 400, epoch: 3 | loss: 0.3629518
	speed: 0.0035s/iter; left time: 20.2970s
	iters: 500, epoch: 3 | loss: 0.5798774
	speed: 0.0035s/iter; left time: 19.8993s
	iters: 600, epoch: 3 | loss: 0.4346118
	speed: 0.0035s/iter; left time: 19.4940s
	iters: 700, epoch: 3 | loss: 0.6886279
	speed: 0.0035s/iter; left time: 19.1270s
	iters: 800, epoch: 3 | loss: 0.3947352
	speed: 0.0035s/iter; left time: 18.8535s
	iters: 900, epoch: 3 | loss: 0.3107733
	speed: 0.0035s/iter; left time: 18.5197s
	iters: 1000, epoch: 3 | loss: 0.8327140
	speed: 0.0035s/iter; left time: 18.1249s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 3.6246485710144043
Epoch: 3, Steps: 1027 | Train Loss: 0.5681147 Vali Loss: 0.4029476 Best vali loss: 0.4018834

best validation loss 0.401883370053089

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 0.8422811031341553
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3649267 Best vali loss: 0.3649267
Updating learning rate to 7.955686575e-05
Epoch: 2 cost time: 0.5261027812957764
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3652224 Best vali loss: 0.3649267
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.3649 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 0.5268561840057373
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3639210 Best vali loss: 0.3639210

best validation loss 0.3639209767455905

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Validation loss decreased (0.3639 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 0.8389873504638672
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3553425 Best vali loss: 0.3553425
Updating learning rate to 9.94460821875e-06
Epoch: 5 cost time: 0.5334217548370361
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3580550 Best vali loss: 0.3553425
Updating learning rate to 4.972304109375e-06
Epoch: 6 cost time: 0.5299279689788818
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3580759 Best vali loss: 0.3553425
Updating learning rate to 2.4861520546875e-06
Validation loss decreased (0.3553 --> 0.3551).  Saving model state dict ...
Epoch: 7 cost time: 0.5222482681274414
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3550677 Best vali loss: 0.3550677
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 0.5289676189422607
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3560495 Best vali loss: 0.3550677

best validation loss 0.35506766638727694

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 0.9113235473632812
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3655173 Best vali loss: 0.3655173
Updating learning rate to 0.0001110827988
Validation loss decreased (0.3655 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 0.5975832939147949
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3640849 Best vali loss: 0.3640849
Updating learning rate to 5.55413994e-05
Epoch: 3 cost time: 0.6074233055114746
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3661154 Best vali loss: 0.3640849
Updating learning rate to 2.77706997e-05
Epoch: 4 cost time: 0.6020512580871582
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3666624 Best vali loss: 0.3640849
Updating learning rate to 1.388534985e-05
Epoch: 5 cost time: 0.5980560779571533
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3658941 Best vali loss: 0.3640849
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 0.6017606258392334
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3651171 Best vali loss: 0.3640849
Updating learning rate to 3.4713374625e-06
Epoch: 7 cost time: 0.5986988544464111
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3641247 Best vali loss: 0.3640849
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 0.5994040966033936
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3641074 Best vali loss: 0.3640849

best validation loss 0.36408491425055184

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.3790).  Saving model state dict ...
Epoch: 1 cost time: 0.7921347618103027
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3789868 Best vali loss: 0.3789868
Updating learning rate to 0.00054448552275
Validation loss decreased (0.3790 --> 0.3715).  Saving model state dict ...
Epoch: 2 cost time: 0.47722387313842773
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3714922 Best vali loss: 0.3714922
Updating learning rate to 0.000272242761375
Validation loss decreased (0.3715 --> 0.3555).  Saving model state dict ...
Epoch: 3 cost time: 0.47928690910339355
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3554642 Best vali loss: 0.3554642
Updating learning rate to 0.0001361213806875
Validation loss decreased (0.3555 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 0.4807908535003662
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3553264 Best vali loss: 0.3553264
Updating learning rate to 6.806069034375e-05
Validation loss decreased (0.3553 --> 0.3527).  Saving model state dict ...
Epoch: 5 cost time: 0.4835960865020752
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3527480 Best vali loss: 0.3527480
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.48250913619995117
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3527796 Best vali loss: 0.3527480
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 0.4844841957092285
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3537726 Best vali loss: 0.3527480
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.48689699172973633
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3541751 Best vali loss: 0.3527480

best validation loss 0.3527479871082868

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.3931).  Saving model state dict ...
Epoch: 1 cost time: 0.6093008518218994
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3931123 Best vali loss: 0.3931123
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.3931 --> 0.3749).  Saving model state dict ...
Epoch: 2 cost time: 0.3163437843322754
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3748517 Best vali loss: 0.3748517
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.3749 --> 0.3698).  Saving model state dict ...
Epoch: 3 cost time: 0.31342506408691406
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3697512 Best vali loss: 0.3697512

best validation loss 0.3697511877198585

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3869054
	speed: 0.0092s/iter; left time: 74.4735s
	iters: 200, epoch: 1 | loss: 0.9458450
	speed: 0.0031s/iter; left time: 24.9308s
	iters: 300, epoch: 1 | loss: 0.3140505
	speed: 0.0034s/iter; left time: 26.5481s
	iters: 400, epoch: 1 | loss: 0.2554969
	speed: 0.0033s/iter; left time: 26.0921s
	iters: 500, epoch: 1 | loss: 0.2994528
	speed: 0.0033s/iter; left time: 25.7686s
	iters: 600, epoch: 1 | loss: 0.5178058
	speed: 0.0034s/iter; left time: 25.6011s
	iters: 700, epoch: 1 | loss: 0.4943897
	speed: 0.0033s/iter; left time: 24.7369s
	iters: 800, epoch: 1 | loss: 0.7619517
	speed: 0.0033s/iter; left time: 24.3669s
	iters: 900, epoch: 1 | loss: 0.9705107
	speed: 0.0033s/iter; left time: 24.2627s
	iters: 1000, epoch: 1 | loss: 0.4185720
	speed: 0.0033s/iter; left time: 23.9693s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.4306).  Saving model state dict ...
Epoch: 1 cost time: 3.718573570251465
Epoch: 1, Steps: 1027 | Train Loss: 0.5364980 Vali Loss: 0.4306279 Best vali loss: 0.4306279
	iters: 100, epoch: 2 | loss: 0.3674138
	speed: 0.0097s/iter; left time: 68.4824s
	iters: 200, epoch: 2 | loss: 0.2662011
	speed: 0.0033s/iter; left time: 23.1762s
	iters: 300, epoch: 2 | loss: 0.4678674
	speed: 0.0033s/iter; left time: 22.9460s
	iters: 400, epoch: 2 | loss: 0.3768730
	speed: 0.0034s/iter; left time: 22.7831s
	iters: 500, epoch: 2 | loss: 0.3108070
	speed: 0.0033s/iter; left time: 22.3088s
	iters: 600, epoch: 2 | loss: 0.6355934
	speed: 0.0033s/iter; left time: 21.8253s
	iters: 700, epoch: 2 | loss: 0.7124351
	speed: 0.0033s/iter; left time: 21.5305s
	iters: 800, epoch: 2 | loss: 0.3434785
	speed: 0.0033s/iter; left time: 21.2706s
	iters: 900, epoch: 2 | loss: 0.3717250
	speed: 0.0033s/iter; left time: 20.7379s
	iters: 1000, epoch: 2 | loss: 2.0668273
	speed: 0.0033s/iter; left time: 20.4602s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.4306 --> 0.3906).  Saving model state dict ...
Epoch: 2 cost time: 3.4570631980895996
Epoch: 2, Steps: 1027 | Train Loss: 0.5919222 Vali Loss: 0.3906097 Best vali loss: 0.3906097
	iters: 100, epoch: 3 | loss: 0.7619036
	speed: 0.0094s/iter; left time: 57.1944s
	iters: 200, epoch: 3 | loss: 0.3500323
	speed: 0.0029s/iter; left time: 17.5874s
	iters: 300, epoch: 3 | loss: 0.3334154
	speed: 0.0029s/iter; left time: 17.2535s
	iters: 400, epoch: 3 | loss: 0.3756845
	speed: 0.0030s/iter; left time: 17.2891s
	iters: 500, epoch: 3 | loss: 0.7969464
	speed: 0.0030s/iter; left time: 16.9906s
	iters: 600, epoch: 3 | loss: 0.2648839
	speed: 0.0030s/iter; left time: 16.9312s
	iters: 700, epoch: 3 | loss: 0.3629952
	speed: 0.0031s/iter; left time: 17.1619s
	iters: 800, epoch: 3 | loss: 0.6559971
	speed: 0.0032s/iter; left time: 17.0513s
	iters: 900, epoch: 3 | loss: 0.4795507
	speed: 0.0031s/iter; left time: 16.4811s
	iters: 1000, epoch: 3 | loss: 0.3044723
	speed: 0.0031s/iter; left time: 16.1119s
Updating learning rate to 0.0011058191498174795
Epoch: 3 cost time: 3.1747610569000244
Epoch: 3, Steps: 1027 | Train Loss: 0.4685881 Vali Loss: 0.4035253 Best vali loss: 0.3906097

best validation loss 0.390609705237368

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7380644
	speed: 0.0104s/iter; left time: 20.3568s
	iters: 200, epoch: 1 | loss: 0.6089097
	speed: 0.0042s/iter; left time: 7.8732s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.4081).  Saving model state dict ...
Epoch: 1 cost time: 1.4575834274291992
Epoch: 1, Steps: 257 | Train Loss: 0.6734870 Vali Loss: 0.4080538 Best vali loss: 0.4080538
	iters: 100, epoch: 2 | loss: 0.6918085
	speed: 0.0093s/iter; left time: 15.7774s
	iters: 200, epoch: 2 | loss: 0.4758331
	speed: 0.0040s/iter; left time: 6.4070s
Updating learning rate to 0.003014973004077762
Validation loss decreased (0.4081 --> 0.4040).  Saving model state dict ...
Epoch: 2 cost time: 1.0819854736328125
Epoch: 2, Steps: 257 | Train Loss: 0.5838208 Vali Loss: 0.4039510 Best vali loss: 0.4039510
	iters: 100, epoch: 3 | loss: 0.5858744
	speed: 0.0091s/iter; left time: 13.0949s
	iters: 200, epoch: 3 | loss: 0.3338461
	speed: 0.0040s/iter; left time: 5.4226s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 1.1080820560455322
Epoch: 3, Steps: 257 | Train Loss: 0.4598603 Vali Loss: 0.4058728 Best vali loss: 0.4039510

best validation loss 0.40395098581529554

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.3698 --> 0.3665).  Saving model state dict ...
Epoch: 4 cost time: 0.6167960166931152
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3665075 Best vali loss: 0.3665075
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.3665 --> 0.3658).  Saving model state dict ...
Epoch: 5 cost time: 0.3030054569244385
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3657822 Best vali loss: 0.3657822
Updating learning rate to 8.769766730464429e-05
Epoch: 6 cost time: 0.301192045211792
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3663791 Best vali loss: 0.3657822
Updating learning rate to 2.2791881150211728e-05
Epoch: 7 cost time: 0.31601691246032715
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3662051 Best vali loss: 0.3657822
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3133237361907959
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3662149 Best vali loss: 0.3657822

best validation loss 0.365782199322826

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.3644).  Saving model state dict ...
Epoch: 1 cost time: 0.6692841053009033
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3644476 Best vali loss: 0.3644476
Updating learning rate to 0.00010898825745
Validation loss decreased (0.3644 --> 0.3628).  Saving model state dict ...
Epoch: 2 cost time: 0.3528580665588379
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3627943 Best vali loss: 0.3627943
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.3628 --> 0.3598).  Saving model state dict ...
Epoch: 3 cost time: 0.35185694694519043
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3598011 Best vali loss: 0.3598011
Updating learning rate to 2.72470643625e-05
Validation loss decreased (0.3598 --> 0.3583).  Saving model state dict ...
Epoch: 4 cost time: 0.36710119247436523
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3583119 Best vali loss: 0.3583119
Updating learning rate to 1.362353218125e-05
Validation loss decreased (0.3583 --> 0.3572).  Saving model state dict ...
Epoch: 5 cost time: 0.35930299758911133
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3572405 Best vali loss: 0.3572405
Updating learning rate to 6.811766090625e-06
Validation loss decreased (0.3572 --> 0.3570).  Saving model state dict ...
Epoch: 6 cost time: 0.365323543548584
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3570227 Best vali loss: 0.3570227
Updating learning rate to 3.4058830453125e-06
Epoch: 7 cost time: 0.3562307357788086
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3573792 Best vali loss: 0.3570227
Updating learning rate to 1.70294152265625e-06
Epoch: 8 cost time: 0.35323381423950195
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3576448 Best vali loss: 0.3570227

best validation loss 0.35702273256652245

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.3854).  Saving model state dict ...
Epoch: 1 cost time: 0.6249163150787354
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3854049 Best vali loss: 0.3854049
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.34502220153808594
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3895020 Best vali loss: 0.3854049
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.32747316360473633
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3966376 Best vali loss: 0.3854049
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.3260684013366699
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3946328 Best vali loss: 0.3854049
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.32047390937805176
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4237649 Best vali loss: 0.3854049
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.3239126205444336
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4169856 Best vali loss: 0.3854049
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.32676196098327637
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4168717 Best vali loss: 0.3854049
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.32630348205566406
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4217993 Best vali loss: 0.3854049

best validation loss 0.385404905858349

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5182887
	speed: 0.0092s/iter; left time: 74.4577s
	iters: 200, epoch: 1 | loss: 0.4832006
	speed: 0.0033s/iter; left time: 26.3248s
	iters: 300, epoch: 1 | loss: 1.9324880
	speed: 0.0032s/iter; left time: 25.6944s
	iters: 400, epoch: 1 | loss: 0.9297885
	speed: 0.0033s/iter; left time: 25.4582s
	iters: 500, epoch: 1 | loss: 0.6096742
	speed: 0.0033s/iter; left time: 25.2234s
	iters: 600, epoch: 1 | loss: 1.0021547
	speed: 0.0033s/iter; left time: 24.9157s
	iters: 700, epoch: 1 | loss: 1.2625501
	speed: 0.0033s/iter; left time: 24.4337s
	iters: 800, epoch: 1 | loss: 0.3424565
	speed: 0.0032s/iter; left time: 23.8786s
	iters: 900, epoch: 1 | loss: 0.3595717
	speed: 0.0033s/iter; left time: 24.1758s
	iters: 1000, epoch: 1 | loss: 0.6983381
	speed: 0.0032s/iter; left time: 23.4451s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.3801).  Saving model state dict ...
Epoch: 1 cost time: 3.692472457885742
Epoch: 1, Steps: 1027 | Train Loss: 0.8138511 Vali Loss: 0.3801334 Best vali loss: 0.3801334
	iters: 100, epoch: 2 | loss: 0.7054406
	speed: 0.0091s/iter; left time: 64.7061s
	iters: 200, epoch: 2 | loss: 0.4955556
	speed: 0.0031s/iter; left time: 21.6652s
	iters: 300, epoch: 2 | loss: 0.4459289
	speed: 0.0029s/iter; left time: 19.7562s
	iters: 400, epoch: 2 | loss: 0.2975319
	speed: 0.0030s/iter; left time: 20.6126s
	iters: 500, epoch: 2 | loss: 0.9166895
	speed: 0.0031s/iter; left time: 20.7508s
	iters: 600, epoch: 2 | loss: 0.6505505
	speed: 0.0031s/iter; left time: 20.5117s
	iters: 700, epoch: 2 | loss: 0.4490395
	speed: 0.0032s/iter; left time: 20.5404s
	iters: 800, epoch: 2 | loss: 1.8315139
	speed: 0.0033s/iter; left time: 21.0457s
	iters: 900, epoch: 2 | loss: 0.2275970
	speed: 0.0033s/iter; left time: 20.9286s
	iters: 1000, epoch: 2 | loss: 1.3816978
	speed: 0.0033s/iter; left time: 20.6307s
Updating learning rate to 0.0006333048484408287
Validation loss decreased (0.3801 --> 0.3732).  Saving model state dict ...
Epoch: 2 cost time: 3.282618284225464
Epoch: 2, Steps: 1027 | Train Loss: 0.7401545 Vali Loss: 0.3731908 Best vali loss: 0.3731908
	iters: 100, epoch: 3 | loss: 0.3867692
	speed: 0.0095s/iter; left time: 57.6053s
	iters: 200, epoch: 3 | loss: 0.8106879
	speed: 0.0031s/iter; left time: 18.3517s
	iters: 300, epoch: 3 | loss: 0.4800237
	speed: 0.0031s/iter; left time: 18.2081s
	iters: 400, epoch: 3 | loss: 0.2245788
	speed: 0.0031s/iter; left time: 18.0397s
	iters: 500, epoch: 3 | loss: 0.3161154
	speed: 0.0031s/iter; left time: 17.5897s
	iters: 600, epoch: 3 | loss: 0.3000037
	speed: 0.0031s/iter; left time: 17.2759s
	iters: 700, epoch: 3 | loss: 0.4596563
	speed: 0.0031s/iter; left time: 16.9137s
	iters: 800, epoch: 3 | loss: 0.2131157
	speed: 0.0031s/iter; left time: 16.6281s
	iters: 900, epoch: 3 | loss: 0.7245154
	speed: 0.0031s/iter; left time: 16.3773s
	iters: 1000, epoch: 3 | loss: 0.1770283
	speed: 0.0031s/iter; left time: 15.9867s
Updating learning rate to 0.0005129498231897238
Validation loss decreased (0.3732 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 3.2366676330566406
Epoch: 3, Steps: 1027 | Train Loss: 0.4092495 Vali Loss: 0.3683955 Best vali loss: 0.3683955

best validation loss 0.3683954725506732

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4911140
	speed: 0.0115s/iter; left time: 10.6967s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 1.031202793121338
Epoch: 1, Steps: 129 | Train Loss: 0.4911140 Vali Loss: 0.3649584 Best vali loss: 0.3649584
	iters: 100, epoch: 2 | loss: 0.5385129
	speed: 0.0091s/iter; left time: 7.3125s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.3650 --> 0.3633).  Saving model state dict ...
Epoch: 2 cost time: 0.713355541229248
Epoch: 2, Steps: 129 | Train Loss: 0.5385129 Vali Loss: 0.3632501 Best vali loss: 0.3632501
	iters: 100, epoch: 3 | loss: 0.4845971
	speed: 0.0093s/iter; left time: 6.2704s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.3633 --> 0.3620).  Saving model state dict ...
Epoch: 3 cost time: 0.7138652801513672
Epoch: 3, Steps: 129 | Train Loss: 0.4845971 Vali Loss: 0.3619887 Best vali loss: 0.3619887

best validation loss 0.3619886654884736

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.4039).  Saving model state dict ...
Epoch: 1 cost time: 1.3740918636322021
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4039208 Best vali loss: 0.4039208
Updating learning rate to 0.004084227711283759
Validation loss decreased (0.4039 --> 0.4005).  Saving model state dict ...
Epoch: 2 cost time: 1.044767141342163
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4005010 Best vali loss: 0.4005010
Updating learning rate to 0.0033080496502235694
Epoch: 3 cost time: 1.0469248294830322
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4105375 Best vali loss: 0.4005010

best validation loss 0.400500961183799

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4949661
	speed: 0.0116s/iter; left time: 6.3556s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.3620 --> 0.3582).  Saving model state dict ...
Epoch: 4 cost time: 1.0248498916625977
Epoch: 4, Steps: 129 | Train Loss: 0.4949661 Vali Loss: 0.3581794 Best vali loss: 0.3581794
	iters: 100, epoch: 5 | loss: 0.4839759
	speed: 0.0092s/iter; left time: 3.8475s
Updating learning rate to 4.50666261875e-06
Validation loss decreased (0.3582 --> 0.3573).  Saving model state dict ...
Epoch: 5 cost time: 0.7111895084381104
Epoch: 5, Steps: 129 | Train Loss: 0.4839759 Vali Loss: 0.3572542 Best vali loss: 0.3572542
	iters: 100, epoch: 6 | loss: 0.4225862
	speed: 0.0091s/iter; left time: 2.6196s
Updating learning rate to 2.253331309375e-06
Epoch: 6 cost time: 0.7105708122253418
Epoch: 6, Steps: 129 | Train Loss: 0.4225862 Vali Loss: 0.3583484 Best vali loss: 0.3572542
	iters: 100, epoch: 7 | loss: 0.6365445
	speed: 0.0089s/iter; left time: 1.4075s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 0.7092368602752686
Epoch: 7, Steps: 129 | Train Loss: 0.6365445 Vali Loss: 0.3577091 Best vali loss: 0.3572542
	iters: 100, epoch: 8 | loss: 0.4908998
	speed: 0.0089s/iter; left time: 0.2664s
Updating learning rate to 5.6333282734375e-07
Epoch: 8 cost time: 0.7173113822937012
Epoch: 8, Steps: 129 | Train Loss: 0.4908998 Vali Loss: 0.3578209 Best vali loss: 0.3572542

best validation loss 0.357254245321034

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5162606
	speed: 0.0109s/iter; left time: 43.8660s
	iters: 200, epoch: 1 | loss: 0.9106518
	speed: 0.0049s/iter; left time: 19.1821s
	iters: 300, epoch: 1 | loss: 0.3335861
	speed: 0.0051s/iter; left time: 19.5681s
	iters: 400, epoch: 1 | loss: 0.4645998
	speed: 0.0051s/iter; left time: 18.8441s
	iters: 500, epoch: 1 | loss: 0.4304554
	speed: 0.0049s/iter; left time: 17.5778s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 2.9139955043792725
Epoch: 1, Steps: 514 | Train Loss: 0.5311108 Vali Loss: 0.3714151 Best vali loss: 0.3714151
	iters: 100, epoch: 2 | loss: 0.2750500
	speed: 0.0096s/iter; left time: 33.7449s
	iters: 200, epoch: 2 | loss: 0.6321321
	speed: 0.0046s/iter; left time: 15.5820s
	iters: 300, epoch: 2 | loss: 0.7296705
	speed: 0.0049s/iter; left time: 16.0473s
	iters: 400, epoch: 2 | loss: 0.3694435
	speed: 0.0053s/iter; left time: 16.9329s
	iters: 500, epoch: 2 | loss: 0.6742085
	speed: 0.0050s/iter; left time: 15.4936s
Updating learning rate to 0.000558034214
Epoch: 2 cost time: 2.5555689334869385
Epoch: 2, Steps: 514 | Train Loss: 0.5361009 Vali Loss: 0.3762930 Best vali loss: 0.3714151
	iters: 100, epoch: 3 | loss: 0.9440874
	speed: 0.0096s/iter; left time: 28.6130s
	iters: 200, epoch: 3 | loss: 0.3862525
	speed: 0.0046s/iter; left time: 13.1688s
	iters: 300, epoch: 3 | loss: 0.2016176
	speed: 0.0047s/iter; left time: 13.0823s
	iters: 400, epoch: 3 | loss: 0.4379228
	speed: 0.0046s/iter; left time: 12.2357s
	iters: 500, epoch: 3 | loss: 0.2339546
	speed: 0.0046s/iter; left time: 11.8611s
Updating learning rate to 0.000279017107
Validation loss decreased (0.3714 --> 0.3680).  Saving model state dict ...
Epoch: 3 cost time: 2.4166245460510254
Epoch: 3, Steps: 514 | Train Loss: 0.4407670 Vali Loss: 0.3679755 Best vali loss: 0.3679755
	iters: 100, epoch: 4 | loss: 0.5882308
	speed: 0.0096s/iter; left time: 23.8024s
	iters: 200, epoch: 4 | loss: 0.8848254
	speed: 0.0052s/iter; left time: 12.3596s
	iters: 300, epoch: 4 | loss: 0.5879719
	speed: 0.0052s/iter; left time: 11.7718s
	iters: 400, epoch: 4 | loss: 0.4987080
	speed: 0.0049s/iter; left time: 10.6988s
	iters: 500, epoch: 4 | loss: 0.5720690
	speed: 0.0046s/iter; left time: 9.5616s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 2.602947950363159
Epoch: 4, Steps: 514 | Train Loss: 0.6263610 Vali Loss: 0.3681091 Best vali loss: 0.3679755
	iters: 100, epoch: 5 | loss: 0.4305796
	speed: 0.0101s/iter; left time: 19.7098s
	iters: 200, epoch: 5 | loss: 0.4182141
	speed: 0.0052s/iter; left time: 9.6762s
	iters: 300, epoch: 5 | loss: 0.3899547
	speed: 0.0052s/iter; left time: 9.1439s
	iters: 400, epoch: 5 | loss: 0.5688843
	speed: 0.0052s/iter; left time: 8.6707s
	iters: 500, epoch: 5 | loss: 0.4241270
	speed: 0.0052s/iter; left time: 8.1495s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 2.7231242656707764
Epoch: 5, Steps: 514 | Train Loss: 0.4463519 Vali Loss: 0.3745547 Best vali loss: 0.3679755
	iters: 100, epoch: 6 | loss: 0.2642373
	speed: 0.0099s/iter; left time: 14.2257s
	iters: 200, epoch: 6 | loss: 0.3005520
	speed: 0.0048s/iter; left time: 6.4857s
	iters: 300, epoch: 6 | loss: 0.7075330
	speed: 0.0047s/iter; left time: 5.7909s
	iters: 400, epoch: 6 | loss: 0.6916489
	speed: 0.0046s/iter; left time: 5.2994s
	iters: 500, epoch: 6 | loss: 0.6640239
	speed: 0.0047s/iter; left time: 4.9217s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 2.4748475551605225
Epoch: 6, Steps: 514 | Train Loss: 0.5255990 Vali Loss: 0.3745678 Best vali loss: 0.3679755
	iters: 100, epoch: 7 | loss: 0.4223524
	speed: 0.0101s/iter; left time: 9.3429s
	iters: 200, epoch: 7 | loss: 0.3659474
	speed: 0.0052s/iter; left time: 4.3503s
	iters: 300, epoch: 7 | loss: 0.3779050
	speed: 0.0051s/iter; left time: 3.7019s
	iters: 400, epoch: 7 | loss: 0.6985163
	speed: 0.0052s/iter; left time: 3.2842s
	iters: 500, epoch: 7 | loss: 0.5648893
	speed: 0.0049s/iter; left time: 2.6020s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 2.6806228160858154
Epoch: 7, Steps: 514 | Train Loss: 0.4859221 Vali Loss: 0.3735666 Best vali loss: 0.3679755
	iters: 100, epoch: 8 | loss: 0.5066549
	speed: 0.0092s/iter; left time: 3.8212s
	iters: 200, epoch: 8 | loss: 0.3014106
	speed: 0.0045s/iter; left time: 1.4018s
	iters: 300, epoch: 8 | loss: 0.3133123
	speed: 0.0045s/iter; left time: 0.9749s
	iters: 400, epoch: 8 | loss: 0.3231548
	speed: 0.0046s/iter; left time: 0.5287s
	iters: 500, epoch: 8 | loss: 0.3669629
	speed: 0.0044s/iter; left time: 0.0665s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 2.3475468158721924
Epoch: 8, Steps: 514 | Train Loss: 0.3622991 Vali Loss: 0.3722474 Best vali loss: 0.3679755

best validation loss 0.3679755088622537

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7264485
	speed: 0.0089s/iter; left time: 35.6284s
	iters: 200, epoch: 1 | loss: 0.5817962
	speed: 0.0025s/iter; left time: 9.6245s
	iters: 300, epoch: 1 | loss: 0.6122410
	speed: 0.0023s/iter; left time: 8.8512s
	iters: 400, epoch: 1 | loss: 0.4693560
	speed: 0.0023s/iter; left time: 8.6353s
	iters: 500, epoch: 1 | loss: 0.2658790
	speed: 0.0023s/iter; left time: 8.2831s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.595088005065918
Epoch: 1, Steps: 514 | Train Loss: 0.5311441 Vali Loss: 0.3712894 Best vali loss: 0.3712894
	iters: 100, epoch: 2 | loss: 0.6635020
	speed: 0.0056s/iter; left time: 19.7300s
	iters: 200, epoch: 2 | loss: 0.5312233
	speed: 0.0024s/iter; left time: 7.9920s
	iters: 300, epoch: 2 | loss: 0.6070260
	speed: 0.0025s/iter; left time: 8.0933s
	iters: 400, epoch: 2 | loss: 0.5376730
	speed: 0.0025s/iter; left time: 8.0210s
	iters: 500, epoch: 2 | loss: 0.3840249
	speed: 0.0025s/iter; left time: 7.8373s
Updating learning rate to 0.0008313570410112075
Validation loss decreased (0.3713 --> 0.3675).  Saving model state dict ...
Epoch: 2 cost time: 1.2881217002868652
Epoch: 2, Steps: 514 | Train Loss: 0.5446898 Vali Loss: 0.3675221 Best vali loss: 0.3675221
	iters: 100, epoch: 3 | loss: 0.4095818
	speed: 0.0057s/iter; left time: 17.1617s
	iters: 200, epoch: 3 | loss: 1.1955427
	speed: 0.0023s/iter; left time: 6.7013s
	iters: 300, epoch: 3 | loss: 0.2605458
	speed: 0.0023s/iter; left time: 6.4369s
	iters: 400, epoch: 3 | loss: 0.7061902
	speed: 0.0023s/iter; left time: 6.2044s
	iters: 500, epoch: 3 | loss: 0.8318144
	speed: 0.0023s/iter; left time: 5.9873s
Updating learning rate to 0.0006733636229757597
Epoch: 3 cost time: 1.234297275543213
Epoch: 3, Steps: 514 | Train Loss: 0.6807350 Vali Loss: 0.3757124 Best vali loss: 0.3675221
	iters: 100, epoch: 4 | loss: 0.3040645
	speed: 0.0056s/iter; left time: 13.8657s
	iters: 200, epoch: 4 | loss: 0.3318518
	speed: 0.0023s/iter; left time: 5.4312s
	iters: 300, epoch: 4 | loss: 0.4679455
	speed: 0.0023s/iter; left time: 5.2202s
	iters: 400, epoch: 4 | loss: 0.7964633
	speed: 0.0023s/iter; left time: 5.0118s
	iters: 500, epoch: 4 | loss: 0.4195495
	speed: 0.0023s/iter; left time: 4.7506s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 1.226205587387085
Epoch: 4, Steps: 514 | Train Loss: 0.4639749 Vali Loss: 0.3765462 Best vali loss: 0.3675221
	iters: 100, epoch: 5 | loss: 0.7636153
	speed: 0.0056s/iter; left time: 11.0019s
	iters: 200, epoch: 5 | loss: 0.5139491
	speed: 0.0023s/iter; left time: 4.3330s
	iters: 300, epoch: 5 | loss: 0.5855272
	speed: 0.0023s/iter; left time: 4.0656s
	iters: 400, epoch: 5 | loss: 0.2561725
	speed: 0.0023s/iter; left time: 3.8411s
	iters: 500, epoch: 5 | loss: 0.3536020
	speed: 0.0023s/iter; left time: 3.6465s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 1.2396972179412842
Epoch: 5, Steps: 514 | Train Loss: 0.4945732 Vali Loss: 0.3837063 Best vali loss: 0.3675221
	iters: 100, epoch: 6 | loss: 0.3847327
	speed: 0.0058s/iter; left time: 8.3668s
	iters: 200, epoch: 6 | loss: 0.7645038
	speed: 0.0022s/iter; left time: 3.0043s
	iters: 300, epoch: 6 | loss: 1.1006554
	speed: 0.0022s/iter; left time: 2.7907s
	iters: 400, epoch: 6 | loss: 0.5615081
	speed: 0.0023s/iter; left time: 2.5792s
	iters: 500, epoch: 6 | loss: 0.4021571
	speed: 0.0024s/iter; left time: 2.4656s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 1.2160911560058594
Epoch: 6, Steps: 514 | Train Loss: 0.6427114 Vali Loss: 0.3910479 Best vali loss: 0.3675221
	iters: 100, epoch: 7 | loss: 0.7737949
	speed: 0.0056s/iter; left time: 5.2107s
	iters: 200, epoch: 7 | loss: 0.6346073
	speed: 0.0023s/iter; left time: 1.9213s
	iters: 300, epoch: 7 | loss: 0.4516656
	speed: 0.0023s/iter; left time: 1.6790s
	iters: 400, epoch: 7 | loss: 0.5922095
	speed: 0.0022s/iter; left time: 1.3969s
	iters: 500, epoch: 7 | loss: 0.5241509
	speed: 0.0023s/iter; left time: 1.2045s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 1.2185883522033691
Epoch: 7, Steps: 514 | Train Loss: 0.5952856 Vali Loss: 0.3876171 Best vali loss: 0.3675221
	iters: 100, epoch: 8 | loss: 0.5168617
	speed: 0.0057s/iter; left time: 2.3571s
	iters: 200, epoch: 8 | loss: 0.2637350
	speed: 0.0022s/iter; left time: 0.7049s
	iters: 300, epoch: 8 | loss: 0.2766948
	speed: 0.0023s/iter; left time: 0.4919s
	iters: 400, epoch: 8 | loss: 0.5177840
	speed: 0.0023s/iter; left time: 0.2619s
	iters: 500, epoch: 8 | loss: 0.6190382
	speed: 0.0022s/iter; left time: 0.0334s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.215998649597168
Epoch: 8, Steps: 514 | Train Loss: 0.4388227 Vali Loss: 0.3932716 Best vali loss: 0.3675221

best validation loss 0.3675220853219098

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4897688
	speed: 0.0100s/iter; left time: 9.3748s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.3794).  Saving model state dict ...
Epoch: 1 cost time: 0.8731927871704102
Epoch: 1, Steps: 129 | Train Loss: 0.4897688 Vali Loss: 0.3794045 Best vali loss: 0.3794045
	iters: 100, epoch: 2 | loss: 0.5054114
	speed: 0.0072s/iter; left time: 5.7694s
Updating learning rate to 0.00056621315495
Epoch: 2 cost time: 0.5786406993865967
Epoch: 2, Steps: 129 | Train Loss: 0.5054114 Vali Loss: 0.3815801 Best vali loss: 0.3794045
	iters: 100, epoch: 3 | loss: 0.5400622
	speed: 0.0071s/iter; left time: 4.8000s
Updating learning rate to 0.000283106577475
Validation loss decreased (0.3794 --> 0.3788).  Saving model state dict ...
Epoch: 3 cost time: 0.5705077648162842
Epoch: 3, Steps: 129 | Train Loss: 0.5400622 Vali Loss: 0.3788299 Best vali loss: 0.3788299

best validation loss 0.37882988256180916

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6045071
	speed: 0.0098s/iter; left time: 39.3041s
	iters: 200, epoch: 1 | loss: 0.7215872
	speed: 0.0036s/iter; left time: 13.9378s
	iters: 300, epoch: 1 | loss: 0.3322586
	speed: 0.0033s/iter; left time: 12.7621s
	iters: 400, epoch: 1 | loss: 0.3307200
	speed: 0.0034s/iter; left time: 12.7242s
	iters: 500, epoch: 1 | loss: 0.5872009
	speed: 0.0033s/iter; left time: 12.0705s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 2.1292614936828613
Epoch: 1, Steps: 514 | Train Loss: 0.5152548 Vali Loss: 0.3663409 Best vali loss: 0.3663409
	iters: 100, epoch: 2 | loss: 0.8462127
	speed: 0.0076s/iter; left time: 26.4617s
	iters: 200, epoch: 2 | loss: 0.3520537
	speed: 0.0037s/iter; left time: 12.4473s
	iters: 300, epoch: 2 | loss: 0.5915288
	speed: 0.0034s/iter; left time: 11.3337s
	iters: 400, epoch: 2 | loss: 0.6674681
	speed: 0.0032s/iter; left time: 10.1577s
	iters: 500, epoch: 2 | loss: 0.7603979
	speed: 0.0031s/iter; left time: 9.6587s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 1.790769338607788
Epoch: 2, Steps: 514 | Train Loss: 0.6435322 Vali Loss: 0.3720243 Best vali loss: 0.3663409
	iters: 100, epoch: 3 | loss: 0.6711624
	speed: 0.0073s/iter; left time: 21.8291s
	iters: 200, epoch: 3 | loss: 0.7201315
	speed: 0.0035s/iter; left time: 10.0555s
	iters: 300, epoch: 3 | loss: 0.5361441
	speed: 0.0034s/iter; left time: 9.4344s
	iters: 400, epoch: 3 | loss: 0.5614430
	speed: 0.0034s/iter; left time: 9.2062s
	iters: 500, epoch: 3 | loss: 0.6173577
	speed: 0.0034s/iter; left time: 8.9069s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 1.817798137664795
Epoch: 3, Steps: 514 | Train Loss: 0.6212478 Vali Loss: 0.3700131 Best vali loss: 0.3663409

best validation loss 0.36634090596659946

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6290445
	speed: 0.0105s/iter; left time: 41.9871s
	iters: 200, epoch: 1 | loss: 0.4627065
	speed: 0.0043s/iter; left time: 16.7391s
	iters: 300, epoch: 1 | loss: 0.5434590
	speed: 0.0042s/iter; left time: 15.9160s
	iters: 400, epoch: 1 | loss: 0.2702823
	speed: 0.0045s/iter; left time: 16.5818s
	iters: 500, epoch: 1 | loss: 0.7420751
	speed: 0.0044s/iter; left time: 15.7682s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 2.5726206302642822
Epoch: 1, Steps: 514 | Train Loss: 0.5295135 Vali Loss: 0.3653895 Best vali loss: 0.3653895
	iters: 100, epoch: 2 | loss: 1.1138710
	speed: 0.0087s/iter; left time: 30.5691s
	iters: 200, epoch: 2 | loss: 1.3753645
	speed: 0.0044s/iter; left time: 14.9261s
	iters: 300, epoch: 2 | loss: 0.6434941
	speed: 0.0044s/iter; left time: 14.4714s
	iters: 400, epoch: 2 | loss: 0.5505755
	speed: 0.0044s/iter; left time: 14.0454s
	iters: 500, epoch: 2 | loss: 0.7368609
	speed: 0.0044s/iter; left time: 13.7371s
Updating learning rate to 0.00021781340639583926
Validation loss decreased (0.3654 --> 0.3618).  Saving model state dict ...
Epoch: 2 cost time: 2.3041939735412598
Epoch: 2, Steps: 514 | Train Loss: 0.8840332 Vali Loss: 0.3618149 Best vali loss: 0.3618149
	iters: 100, epoch: 3 | loss: 0.5220394
	speed: 0.0090s/iter; left time: 26.7525s
	iters: 200, epoch: 3 | loss: 0.8905177
	speed: 0.0043s/iter; left time: 12.3565s
	iters: 300, epoch: 3 | loss: 0.6840211
	speed: 0.0043s/iter; left time: 11.8447s
	iters: 400, epoch: 3 | loss: 0.5840440
	speed: 0.0044s/iter; left time: 11.8588s
	iters: 500, epoch: 3 | loss: 0.8741661
	speed: 0.0044s/iter; left time: 11.3665s
Updating learning rate to 0.000176419537248397
Epoch: 3 cost time: 2.280310869216919
Epoch: 3, Steps: 514 | Train Loss: 0.7109577 Vali Loss: 0.3715556 Best vali loss: 0.3618149

best validation loss 0.3618149110282568

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4355603
	speed: 0.0104s/iter; left time: 25.7592s
	iters: 200, epoch: 4 | loss: 0.3941386
	speed: 0.0042s/iter; left time: 9.9072s
	iters: 300, epoch: 4 | loss: 0.4916884
	speed: 0.0041s/iter; left time: 9.2745s
	iters: 400, epoch: 4 | loss: 0.2242625
	speed: 0.0042s/iter; left time: 9.0802s
	iters: 500, epoch: 4 | loss: 0.6185744
	speed: 0.0039s/iter; left time: 8.0886s
Updating learning rate to 0.0001275921394
Validation loss decreased (0.3618 --> 0.3542).  Saving model state dict ...
Epoch: 4 cost time: 2.465542793273926
Epoch: 4, Steps: 514 | Train Loss: 0.4328448 Vali Loss: 0.3542482 Best vali loss: 0.3542482
	iters: 100, epoch: 5 | loss: 0.9654954
	speed: 0.0086s/iter; left time: 16.9173s
	iters: 200, epoch: 5 | loss: 1.1808156
	speed: 0.0043s/iter; left time: 8.0143s
	iters: 300, epoch: 5 | loss: 0.5571505
	speed: 0.0042s/iter; left time: 7.3583s
	iters: 400, epoch: 5 | loss: 0.5386456
	speed: 0.0044s/iter; left time: 7.3331s
	iters: 500, epoch: 5 | loss: 0.6917315
	speed: 0.0044s/iter; left time: 6.8933s
Updating learning rate to 7.8764741551603e-05
Validation loss decreased (0.3542 --> 0.3528).  Saving model state dict ...
Epoch: 5 cost time: 2.2550389766693115
Epoch: 5, Steps: 514 | Train Loss: 0.7867677 Vali Loss: 0.3527893 Best vali loss: 0.3527893
	iters: 100, epoch: 6 | loss: 0.5189775
	speed: 0.0089s/iter; left time: 12.8043s
	iters: 200, epoch: 6 | loss: 0.8683018
	speed: 0.0045s/iter; left time: 6.1102s
	iters: 300, epoch: 6 | loss: 0.6347080
	speed: 0.0045s/iter; left time: 5.5418s
	iters: 400, epoch: 6 | loss: 0.4784639
	speed: 0.0044s/iter; left time: 5.0749s
	iters: 500, epoch: 6 | loss: 0.8037620
	speed: 0.0045s/iter; left time: 4.6424s
Updating learning rate to 3.7370872404160736e-05
Validation loss decreased (0.3528 --> 0.3513).  Saving model state dict ...
Epoch: 6 cost time: 2.3419318199157715
Epoch: 6, Steps: 514 | Train Loss: 0.6608426 Vali Loss: 0.3513283 Best vali loss: 0.3513283
	iters: 100, epoch: 7 | loss: 0.3428092
	speed: 0.0087s/iter; left time: 8.0550s
	iters: 200, epoch: 7 | loss: 0.2889346
	speed: 0.0039s/iter; left time: 3.2103s
	iters: 300, epoch: 7 | loss: 0.4555261
	speed: 0.0039s/iter; left time: 2.8592s
	iters: 400, epoch: 7 | loss: 0.7637494
	speed: 0.0040s/iter; left time: 2.5252s
	iters: 500, epoch: 7 | loss: 0.6243542
	speed: 0.0040s/iter; left time: 2.1150s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 2.087416172027588
Epoch: 7, Steps: 514 | Train Loss: 0.4950747 Vali Loss: 0.3551729 Best vali loss: 0.3513283
	iters: 100, epoch: 8 | loss: 0.3811911
	speed: 0.0087s/iter; left time: 3.5949s
	iters: 200, epoch: 8 | loss: 1.1197647
	speed: 0.0044s/iter; left time: 1.3906s
	iters: 300, epoch: 8 | loss: 0.6104128
	speed: 0.0044s/iter; left time: 0.9513s
	iters: 400, epoch: 8 | loss: 0.4154963
	speed: 0.0044s/iter; left time: 0.5032s
	iters: 500, epoch: 8 | loss: 0.8550966
	speed: 0.0043s/iter; left time: 0.0640s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.290170907974243
Epoch: 8, Steps: 514 | Train Loss: 0.6763923 Vali Loss: 0.3567875 Best vali loss: 0.3513283

best validation loss 0.3513282514157136

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4061545
	speed: 0.0096s/iter; left time: 18.8499s
	iters: 200, epoch: 1 | loss: 0.6655009
	speed: 0.0035s/iter; left time: 6.5793s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 1.2588372230529785
Epoch: 1, Steps: 257 | Train Loss: 0.5358277 Vali Loss: 0.3750692 Best vali loss: 0.3750692
	iters: 100, epoch: 2 | loss: 0.6891594
	speed: 0.0081s/iter; left time: 13.7546s
	iters: 200, epoch: 2 | loss: 0.4462879
	speed: 0.0038s/iter; left time: 6.0661s
Updating learning rate to 0.0001961474641
Epoch: 2 cost time: 1.0165150165557861
Epoch: 2, Steps: 257 | Train Loss: 0.5677236 Vali Loss: 0.3832553 Best vali loss: 0.3750692
	iters: 100, epoch: 3 | loss: 0.3689282
	speed: 0.0081s/iter; left time: 11.7368s
	iters: 200, epoch: 3 | loss: 0.5283883
	speed: 0.0037s/iter; left time: 4.9651s
Updating learning rate to 9.807373205e-05
Validation loss decreased (0.3751 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 0.9904778003692627
Epoch: 3, Steps: 257 | Train Loss: 0.4486583 Vali Loss: 0.3542391 Best vali loss: 0.3542391
	iters: 100, epoch: 4 | loss: 0.3724072
	speed: 0.0082s/iter; left time: 9.7601s
	iters: 200, epoch: 4 | loss: 0.4883350
	speed: 0.0036s/iter; left time: 3.9632s
Updating learning rate to 4.9036866025e-05
Epoch: 4 cost time: 0.9768896102905273
Epoch: 4, Steps: 257 | Train Loss: 0.4303711 Vali Loss: 0.3552005 Best vali loss: 0.3542391
	iters: 100, epoch: 5 | loss: 0.5625635
	speed: 0.0081s/iter; left time: 7.5388s
	iters: 200, epoch: 5 | loss: 0.4572582
	speed: 0.0038s/iter; left time: 3.1287s
Updating learning rate to 2.45184330125e-05
Validation loss decreased (0.3542 --> 0.3523).  Saving model state dict ...
Epoch: 5 cost time: 1.0044054985046387
Epoch: 5, Steps: 257 | Train Loss: 0.5099109 Vali Loss: 0.3523233 Best vali loss: 0.3523233
	iters: 100, epoch: 6 | loss: 0.5147655
	speed: 0.0084s/iter; left time: 5.6158s
	iters: 200, epoch: 6 | loss: 0.4832487
	speed: 0.0035s/iter; left time: 2.0127s
Updating learning rate to 1.225921650625e-05
Epoch: 6 cost time: 0.9751553535461426
Epoch: 6, Steps: 257 | Train Loss: 0.4990071 Vali Loss: 0.3562203 Best vali loss: 0.3523233
	iters: 100, epoch: 7 | loss: 0.4465281
	speed: 0.0081s/iter; left time: 3.3661s
	iters: 200, epoch: 7 | loss: 0.7998587
	speed: 0.0036s/iter; left time: 1.1310s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 0.9922182559967041
Epoch: 7, Steps: 257 | Train Loss: 0.6231934 Vali Loss: 0.3557301 Best vali loss: 0.3523233
	iters: 100, epoch: 8 | loss: 0.3325821
	speed: 0.0081s/iter; left time: 1.2804s
	iters: 200, epoch: 8 | loss: 0.4037747
	speed: 0.0034s/iter; left time: 0.1946s
Updating learning rate to 3.0648041265625e-06
Epoch: 8 cost time: 0.9412732124328613
Epoch: 8, Steps: 257 | Train Loss: 0.3681784 Vali Loss: 0.3558358 Best vali loss: 0.3523233

best validation loss 0.3523232515293863

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.4060).  Saving model state dict ...
Epoch: 1 cost time: 0.8169312477111816
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4059841 Best vali loss: 0.4059841
Updating learning rate to 0.0020052808113
Validation loss decreased (0.4060 --> 0.4005).  Saving model state dict ...
Epoch: 2 cost time: 0.5022468566894531
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4005022 Best vali loss: 0.4005022
Updating learning rate to 0.00100264040565
Epoch: 3 cost time: 0.49275994300842285
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4027312 Best vali loss: 0.4005022
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 0.4977235794067383
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4028360 Best vali loss: 0.4005022
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 0.49664735794067383
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4039080 Best vali loss: 0.4005022
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 0.49951839447021484
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4031253 Best vali loss: 0.4005022
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 0.511439323425293
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4033953 Best vali loss: 0.4005022
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 0.49529600143432617
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4035166 Best vali loss: 0.4005022

best validation loss 0.40050216554892787

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9372423
	speed: 0.0105s/iter; left time: 20.5223s
	iters: 200, epoch: 1 | loss: 0.8724548
	speed: 0.0045s/iter; left time: 8.2987s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 1.5059962272644043
Epoch: 1, Steps: 257 | Train Loss: 0.9048485 Vali Loss: 0.3697746 Best vali loss: 0.3697746
	iters: 100, epoch: 2 | loss: 0.5194305
	speed: 0.0092s/iter; left time: 15.7000s
	iters: 200, epoch: 2 | loss: 0.6207587
	speed: 0.0041s/iter; left time: 6.5174s
Updating learning rate to 0.00131427676225
Epoch: 2 cost time: 1.1104540824890137
Epoch: 2, Steps: 257 | Train Loss: 0.5700946 Vali Loss: 0.3758419 Best vali loss: 0.3697746
	iters: 100, epoch: 3 | loss: 0.7137550
	speed: 0.0096s/iter; left time: 13.8418s
	iters: 200, epoch: 3 | loss: 0.5471482
	speed: 0.0045s/iter; left time: 6.0717s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 1.2030577659606934
Epoch: 3, Steps: 257 | Train Loss: 0.6304516 Vali Loss: 0.3739329 Best vali loss: 0.3697746

best validation loss 0.3697745669684382

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6674221
	speed: 0.0104s/iter; left time: 41.8023s
	iters: 200, epoch: 1 | loss: 0.8705749
	speed: 0.0041s/iter; left time: 16.0004s
	iters: 300, epoch: 1 | loss: 0.8857972
	speed: 0.0042s/iter; left time: 16.0154s
	iters: 400, epoch: 1 | loss: 1.6527612
	speed: 0.0044s/iter; left time: 16.1987s
	iters: 500, epoch: 1 | loss: 0.8921695
	speed: 0.0045s/iter; left time: 16.1983s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.4048).  Saving model state dict ...
Epoch: 1 cost time: 2.5729336738586426
Epoch: 1, Steps: 514 | Train Loss: 0.9937450 Vali Loss: 0.4048470 Best vali loss: 0.4048470
	iters: 100, epoch: 2 | loss: 0.3920550
	speed: 0.0088s/iter; left time: 30.7113s
	iters: 200, epoch: 2 | loss: 0.4586638
	speed: 0.0041s/iter; left time: 13.8222s
	iters: 300, epoch: 2 | loss: 0.8925111
	speed: 0.0041s/iter; left time: 13.3846s
	iters: 400, epoch: 2 | loss: 0.6461990
	speed: 0.0038s/iter; left time: 12.0581s
	iters: 500, epoch: 2 | loss: 1.0000166
	speed: 0.0038s/iter; left time: 11.8377s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 2.0872933864593506
Epoch: 2, Steps: 514 | Train Loss: 0.6778891 Vali Loss: 0.4100646 Best vali loss: 0.4048470
	iters: 100, epoch: 3 | loss: 0.7369172
	speed: 0.0081s/iter; left time: 24.2335s
	iters: 200, epoch: 3 | loss: 0.6689036
	speed: 0.0040s/iter; left time: 11.4974s
	iters: 300, epoch: 3 | loss: 0.4584983
	speed: 0.0040s/iter; left time: 11.0396s
	iters: 400, epoch: 3 | loss: 1.3267231
	speed: 0.0040s/iter; left time: 10.8311s
	iters: 500, epoch: 3 | loss: 0.7663416
	speed: 0.0040s/iter; left time: 10.2425s
Updating learning rate to 0.001124521370275
Validation loss decreased (0.4048 --> 0.4024).  Saving model state dict ...
Epoch: 3 cost time: 2.0742790699005127
Epoch: 3, Steps: 514 | Train Loss: 0.7914768 Vali Loss: 0.4024163 Best vali loss: 0.4024163

best validation loss 0.4024162691562255

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9412204
	speed: 0.0096s/iter; left time: 38.5433s
	iters: 200, epoch: 1 | loss: 0.5259694
	speed: 0.0034s/iter; left time: 13.3427s
	iters: 300, epoch: 1 | loss: 1.0959988
	speed: 0.0035s/iter; left time: 13.4849s
	iters: 400, epoch: 1 | loss: 0.3342501
	speed: 0.0033s/iter; left time: 12.3337s
	iters: 500, epoch: 1 | loss: 0.3490931
	speed: 0.0033s/iter; left time: 12.0707s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 2.1062440872192383
Epoch: 1, Steps: 514 | Train Loss: 0.6493064 Vali Loss: 0.3646882 Best vali loss: 0.3646882
	iters: 100, epoch: 2 | loss: 0.6526382
	speed: 0.0073s/iter; left time: 25.7124s
	iters: 200, epoch: 2 | loss: 0.8032614
	speed: 0.0032s/iter; left time: 11.0275s
	iters: 300, epoch: 2 | loss: 0.8385335
	speed: 0.0035s/iter; left time: 11.4320s
	iters: 400, epoch: 2 | loss: 0.4495495
	speed: 0.0034s/iter; left time: 10.8189s
	iters: 500, epoch: 2 | loss: 0.7860979
	speed: 0.0032s/iter; left time: 9.9226s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.3647 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 1.752528429031372
Epoch: 2, Steps: 514 | Train Loss: 0.7060161 Vali Loss: 0.3636781 Best vali loss: 0.3636781
	iters: 100, epoch: 3 | loss: 0.6063797
	speed: 0.0074s/iter; left time: 22.2349s
	iters: 200, epoch: 3 | loss: 0.7019929
	speed: 0.0033s/iter; left time: 9.5843s
	iters: 300, epoch: 3 | loss: 0.4528660
	speed: 0.0034s/iter; left time: 9.5523s
	iters: 400, epoch: 3 | loss: 0.6122040
	speed: 0.0035s/iter; left time: 9.4474s
	iters: 500, epoch: 3 | loss: 0.5271367
	speed: 0.0034s/iter; left time: 8.7726s
Updating learning rate to 0.0001187482146823405
Epoch: 3 cost time: 1.8038485050201416
Epoch: 3, Steps: 514 | Train Loss: 0.5801158 Vali Loss: 0.3706234 Best vali loss: 0.3636781

best validation loss 0.36367806627146154

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8586191
	speed: 0.0098s/iter; left time: 24.2224s
	iters: 200, epoch: 4 | loss: 0.5084291
	speed: 0.0032s/iter; left time: 7.6505s
	iters: 300, epoch: 4 | loss: 0.9527509
	speed: 0.0030s/iter; left time: 6.8737s
	iters: 400, epoch: 4 | loss: 0.3521748
	speed: 0.0034s/iter; left time: 7.3383s
	iters: 500, epoch: 4 | loss: 0.3020155
	speed: 0.0036s/iter; left time: 7.3696s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 2.0802276134490967
Epoch: 4, Steps: 514 | Train Loss: 0.5947979 Vali Loss: 0.3898266 Best vali loss: 0.3636781
	iters: 100, epoch: 5 | loss: 0.5087826
	speed: 0.0077s/iter; left time: 15.0407s
	iters: 200, epoch: 5 | loss: 0.7006969
	speed: 0.0035s/iter; left time: 6.4340s
	iters: 300, epoch: 5 | loss: 0.7972876
	speed: 0.0035s/iter; left time: 6.0754s
	iters: 400, epoch: 5 | loss: 0.3984623
	speed: 0.0034s/iter; left time: 5.6947s
	iters: 500, epoch: 5 | loss: 0.7498201
	speed: 0.0034s/iter; left time: 5.2885s
Updating learning rate to 5.30166476176595e-05
Validation loss decreased (0.3637 --> 0.3619).  Saving model state dict ...
Epoch: 5 cost time: 1.8247156143188477
Epoch: 5, Steps: 514 | Train Loss: 0.6310099 Vali Loss: 0.3619348 Best vali loss: 0.3619348
	iters: 100, epoch: 6 | loss: 0.5408407
	speed: 0.0069s/iter; left time: 10.0214s
	iters: 200, epoch: 6 | loss: 0.6748208
	speed: 0.0032s/iter; left time: 4.2309s
	iters: 300, epoch: 6 | loss: 0.4164401
	speed: 0.0031s/iter; left time: 3.8290s
	iters: 400, epoch: 6 | loss: 0.5624138
	speed: 0.0032s/iter; left time: 3.6043s
	iters: 500, epoch: 6 | loss: 0.4757954
	speed: 0.0031s/iter; left time: 3.2139s
Updating learning rate to 2.515438169904822e-05
Epoch: 6 cost time: 1.640268087387085
Epoch: 6, Steps: 514 | Train Loss: 0.5340621 Vali Loss: 0.3716852 Best vali loss: 0.3619348
	iters: 100, epoch: 7 | loss: 0.4750805
	speed: 0.0068s/iter; left time: 6.2955s
	iters: 200, epoch: 7 | loss: 0.7409793
	speed: 0.0031s/iter; left time: 2.5739s
	iters: 300, epoch: 7 | loss: 0.5202449
	speed: 0.0030s/iter; left time: 2.1552s
	iters: 400, epoch: 7 | loss: 0.4209650
	speed: 0.0031s/iter; left time: 1.9201s
	iters: 500, epoch: 7 | loss: 0.2626486
	speed: 0.0032s/iter; left time: 1.6735s
Updating learning rate to 6.53741080820523e-06
Epoch: 7 cost time: 1.6221981048583984
Epoch: 7, Steps: 514 | Train Loss: 0.4839837 Vali Loss: 0.3636485 Best vali loss: 0.3619348
	iters: 100, epoch: 8 | loss: 0.6326108
	speed: 0.0072s/iter; left time: 2.9995s
	iters: 200, epoch: 8 | loss: 0.2520554
	speed: 0.0035s/iter; left time: 1.0902s
	iters: 300, epoch: 8 | loss: 0.6412250
	speed: 0.0035s/iter; left time: 0.7541s
	iters: 400, epoch: 8 | loss: 0.6581948
	speed: 0.0036s/iter; left time: 0.4121s
	iters: 500, epoch: 8 | loss: 0.5436413
	speed: 0.0035s/iter; left time: 0.0526s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8515772819519043
Epoch: 8, Steps: 514 | Train Loss: 0.5455455 Vali Loss: 0.3720247 Best vali loss: 0.3619348

best validation loss 0.36193478050658184

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4766688
	speed: 0.0092s/iter; left time: 8.6156s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.3789).  Saving model state dict ...
Epoch: 1 cost time: 0.7613942623138428
Epoch: 1, Steps: 129 | Train Loss: 0.4766688 Vali Loss: 0.3788625 Best vali loss: 0.3788625
	iters: 100, epoch: 2 | loss: 0.5241757
	speed: 0.0058s/iter; left time: 4.6770s
Updating learning rate to 0.0009572352247034093
Validation loss decreased (0.3789 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 0.434373140335083
Epoch: 2, Steps: 129 | Train Loss: 0.5241757 Vali Loss: 0.3696788 Best vali loss: 0.3696788
	iters: 100, epoch: 3 | loss: 0.3926466
	speed: 0.0058s/iter; left time: 3.9044s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 0.441631555557251
Epoch: 3, Steps: 129 | Train Loss: 0.3926466 Vali Loss: 0.3766039 Best vali loss: 0.3696788
	iters: 100, epoch: 4 | loss: 0.4862073
	speed: 0.0057s/iter; left time: 3.1106s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 0.433074951171875
Epoch: 4, Steps: 129 | Train Loss: 0.4862073 Vali Loss: 0.3945481 Best vali loss: 0.3696788
	iters: 100, epoch: 5 | loss: 0.5779063
	speed: 0.0061s/iter; left time: 2.5254s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 0.4481620788574219
Epoch: 5, Steps: 129 | Train Loss: 0.5779063 Vali Loss: 0.4153809 Best vali loss: 0.3696788
	iters: 100, epoch: 6 | loss: 0.4145634
	speed: 0.0061s/iter; left time: 1.7665s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 0.4550354480743408
Epoch: 6, Steps: 129 | Train Loss: 0.4145634 Vali Loss: 0.4212235 Best vali loss: 0.3696788
	iters: 100, epoch: 7 | loss: 0.4697191
	speed: 0.0056s/iter; left time: 0.8981s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 0.4294614791870117
Epoch: 7, Steps: 129 | Train Loss: 0.4697191 Vali Loss: 0.4318129 Best vali loss: 0.3696788
	iters: 100, epoch: 8 | loss: 0.3167532
	speed: 0.0055s/iter; left time: 0.1646s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.40743088722229004
Epoch: 8, Steps: 129 | Train Loss: 0.3167532 Vali Loss: 0.4350173 Best vali loss: 0.3696788

best validation loss 0.3696788286881737

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3851383
	speed: 0.0084s/iter; left time: 68.5240s
	iters: 200, epoch: 1 | loss: 0.4372224
	speed: 0.0024s/iter; left time: 19.2553s
	iters: 300, epoch: 1 | loss: 0.3919816
	speed: 0.0025s/iter; left time: 19.6605s
	iters: 400, epoch: 1 | loss: 0.9619996
	speed: 0.0025s/iter; left time: 19.6555s
	iters: 500, epoch: 1 | loss: 1.4042176
	speed: 0.0025s/iter; left time: 19.1076s
	iters: 600, epoch: 1 | loss: 1.3850940
	speed: 0.0025s/iter; left time: 18.9285s
	iters: 700, epoch: 1 | loss: 0.4161898
	speed: 0.0025s/iter; left time: 18.7204s
	iters: 800, epoch: 1 | loss: 1.2674373
	speed: 0.0025s/iter; left time: 18.6501s
	iters: 900, epoch: 1 | loss: 0.2988313
	speed: 0.0025s/iter; left time: 18.1815s
	iters: 1000, epoch: 1 | loss: 0.7703924
	speed: 0.0025s/iter; left time: 18.0791s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.4008).  Saving model state dict ...
Epoch: 1 cost time: 2.9043354988098145
Epoch: 1, Steps: 1027 | Train Loss: 0.7718504 Vali Loss: 0.4008052 Best vali loss: 0.4008052
	iters: 100, epoch: 2 | loss: 0.9474180
	speed: 0.0075s/iter; left time: 52.8636s
	iters: 200, epoch: 2 | loss: 0.4390309
	speed: 0.0021s/iter; left time: 14.5469s
	iters: 300, epoch: 2 | loss: 0.3256809
	speed: 0.0020s/iter; left time: 13.9841s
	iters: 400, epoch: 2 | loss: 1.2682927
	speed: 0.0021s/iter; left time: 14.1228s
	iters: 500, epoch: 2 | loss: 0.9581484
	speed: 0.0022s/iter; left time: 14.7092s
	iters: 600, epoch: 2 | loss: 0.4074047
	speed: 0.0024s/iter; left time: 15.9084s
	iters: 700, epoch: 2 | loss: 1.1823018
	speed: 0.0022s/iter; left time: 14.3891s
	iters: 800, epoch: 2 | loss: 0.5959078
	speed: 0.0023s/iter; left time: 14.8348s
	iters: 900, epoch: 2 | loss: 0.3769045
	speed: 0.0023s/iter; left time: 14.4498s
	iters: 1000, epoch: 2 | loss: 1.0291132
	speed: 0.0023s/iter; left time: 14.2442s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.4008 --> 0.3811).  Saving model state dict ...
Epoch: 2 cost time: 2.300675868988037
Epoch: 2, Steps: 1027 | Train Loss: 0.7530203 Vali Loss: 0.3810761 Best vali loss: 0.3810761
	iters: 100, epoch: 3 | loss: 0.7719125
	speed: 0.0072s/iter; left time: 43.5930s
	iters: 200, epoch: 3 | loss: 0.8885090
	speed: 0.0021s/iter; left time: 12.2898s
	iters: 300, epoch: 3 | loss: 0.2661911
	speed: 0.0020s/iter; left time: 12.0064s
	iters: 400, epoch: 3 | loss: 0.5771682
	speed: 0.0020s/iter; left time: 11.7903s
	iters: 500, epoch: 3 | loss: 1.0762690
	speed: 0.0020s/iter; left time: 11.4832s
	iters: 600, epoch: 3 | loss: 0.2974519
	speed: 0.0021s/iter; left time: 11.5731s
	iters: 700, epoch: 3 | loss: 0.3741409
	speed: 0.0020s/iter; left time: 11.1493s
	iters: 800, epoch: 3 | loss: 0.3105795
	speed: 0.0020s/iter; left time: 10.9324s
	iters: 900, epoch: 3 | loss: 0.3749556
	speed: 0.0020s/iter; left time: 10.7156s
	iters: 1000, epoch: 3 | loss: 0.2353594
	speed: 0.0021s/iter; left time: 10.5894s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.3811 --> 0.3730).  Saving model state dict ...
Epoch: 3 cost time: 2.1453909873962402
Epoch: 3, Steps: 1027 | Train Loss: 0.5172537 Vali Loss: 0.3730061 Best vali loss: 0.3730061
	iters: 100, epoch: 4 | loss: 0.2711996
	speed: 0.0073s/iter; left time: 36.7283s
	iters: 200, epoch: 4 | loss: 0.6397258
	speed: 0.0021s/iter; left time: 10.4199s
	iters: 300, epoch: 4 | loss: 0.2792170
	speed: 0.0021s/iter; left time: 10.1293s
	iters: 400, epoch: 4 | loss: 0.3979722
	speed: 0.0021s/iter; left time: 9.8791s
	iters: 500, epoch: 4 | loss: 0.3991226
	speed: 0.0021s/iter; left time: 9.6497s
	iters: 600, epoch: 4 | loss: 1.2335206
	speed: 0.0021s/iter; left time: 9.4551s
	iters: 700, epoch: 4 | loss: 0.3522445
	speed: 0.0021s/iter; left time: 9.2487s
	iters: 800, epoch: 4 | loss: 1.1193271
	speed: 0.0022s/iter; left time: 9.5347s
	iters: 900, epoch: 4 | loss: 0.3139697
	speed: 0.0022s/iter; left time: 9.4111s
	iters: 1000, epoch: 4 | loss: 0.5208384
	speed: 0.0022s/iter; left time: 9.1470s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.3730 --> 0.3694).  Saving model state dict ...
Epoch: 4 cost time: 2.2269883155822754
Epoch: 4, Steps: 1027 | Train Loss: 0.5527138 Vali Loss: 0.3694471 Best vali loss: 0.3694471
	iters: 100, epoch: 5 | loss: 0.2842900
	speed: 0.0073s/iter; left time: 29.3647s
	iters: 200, epoch: 5 | loss: 0.3567016
	speed: 0.0023s/iter; left time: 9.0608s
	iters: 300, epoch: 5 | loss: 0.3051204
	speed: 0.0023s/iter; left time: 8.8295s
	iters: 400, epoch: 5 | loss: 0.2895144
	speed: 0.0023s/iter; left time: 8.6924s
	iters: 500, epoch: 5 | loss: 1.4370568
	speed: 0.0022s/iter; left time: 8.0829s
	iters: 600, epoch: 5 | loss: 0.4356041
	speed: 0.0023s/iter; left time: 8.0440s
	iters: 700, epoch: 5 | loss: 1.1172286
	speed: 0.0023s/iter; left time: 7.9219s
	iters: 800, epoch: 5 | loss: 0.6605566
	speed: 0.0022s/iter; left time: 7.3255s
	iters: 900, epoch: 5 | loss: 0.2516979
	speed: 0.0022s/iter; left time: 7.0792s
	iters: 1000, epoch: 5 | loss: 0.2871844
	speed: 0.0023s/iter; left time: 7.1204s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.3694 --> 0.3676).  Saving model state dict ...
Epoch: 5 cost time: 2.3794703483581543
Epoch: 5, Steps: 1027 | Train Loss: 0.5424955 Vali Loss: 0.3676440 Best vali loss: 0.3676440
	iters: 100, epoch: 6 | loss: 0.6296995
	speed: 0.0074s/iter; left time: 21.9404s
	iters: 200, epoch: 6 | loss: 0.8582761
	speed: 0.0021s/iter; left time: 6.1257s
	iters: 300, epoch: 6 | loss: 0.3369042
	speed: 0.0022s/iter; left time: 6.0781s
	iters: 400, epoch: 6 | loss: 0.5651190
	speed: 0.0021s/iter; left time: 5.5437s
	iters: 500, epoch: 6 | loss: 1.1208268
	speed: 0.0021s/iter; left time: 5.4742s
	iters: 600, epoch: 6 | loss: 0.2375556
	speed: 0.0022s/iter; left time: 5.4351s
	iters: 700, epoch: 6 | loss: 0.7236885
	speed: 0.0022s/iter; left time: 5.1278s
	iters: 800, epoch: 6 | loss: 0.7473274
	speed: 0.0022s/iter; left time: 4.9127s
	iters: 900, epoch: 6 | loss: 0.3266156
	speed: 0.0022s/iter; left time: 4.7463s
	iters: 1000, epoch: 6 | loss: 0.6892348
	speed: 0.0022s/iter; left time: 4.5339s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.3676 --> 0.3666).  Saving model state dict ...
Epoch: 6 cost time: 2.2514421939849854
Epoch: 6, Steps: 1027 | Train Loss: 0.6235248 Vali Loss: 0.3665727 Best vali loss: 0.3665727
	iters: 100, epoch: 7 | loss: 0.2531448
	speed: 0.0074s/iter; left time: 14.4992s
	iters: 200, epoch: 7 | loss: 0.4004718
	speed: 0.0023s/iter; left time: 4.3225s
	iters: 300, epoch: 7 | loss: 0.7367126
	speed: 0.0023s/iter; left time: 4.0095s
	iters: 400, epoch: 7 | loss: 1.4608140
	speed: 0.0023s/iter; left time: 3.8616s
	iters: 500, epoch: 7 | loss: 0.3262066
	speed: 0.0023s/iter; left time: 3.5734s
	iters: 600, epoch: 7 | loss: 0.2077287
	speed: 0.0022s/iter; left time: 3.2431s
	iters: 700, epoch: 7 | loss: 0.5963192
	speed: 0.0022s/iter; left time: 2.9552s
	iters: 800, epoch: 7 | loss: 1.0071108
	speed: 0.0022s/iter; left time: 2.7878s
	iters: 900, epoch: 7 | loss: 0.5035478
	speed: 0.0022s/iter; left time: 2.5724s
	iters: 1000, epoch: 7 | loss: 0.3022708
	speed: 0.0022s/iter; left time: 2.3114s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.3666 --> 0.3662).  Saving model state dict ...
Epoch: 7 cost time: 2.362761974334717
Epoch: 7, Steps: 1027 | Train Loss: 0.5794327 Vali Loss: 0.3662266 Best vali loss: 0.3662266
	iters: 100, epoch: 8 | loss: 0.1848631
	speed: 0.0072s/iter; left time: 6.7206s
	iters: 200, epoch: 8 | loss: 0.9922634
	speed: 0.0022s/iter; left time: 1.8053s
	iters: 300, epoch: 8 | loss: 0.6031254
	speed: 0.0023s/iter; left time: 1.6666s
	iters: 400, epoch: 8 | loss: 1.2188276
	speed: 0.0023s/iter; left time: 1.4519s
	iters: 500, epoch: 8 | loss: 0.3625377
	speed: 0.0023s/iter; left time: 1.1947s
	iters: 600, epoch: 8 | loss: 0.6606113
	speed: 0.0022s/iter; left time: 0.9608s
	iters: 700, epoch: 8 | loss: 1.3987712
	speed: 0.0022s/iter; left time: 0.7337s
	iters: 800, epoch: 8 | loss: 0.2531967
	speed: 0.0022s/iter; left time: 0.4906s
	iters: 900, epoch: 8 | loss: 0.9962042
	speed: 0.0023s/iter; left time: 0.2927s
	iters: 1000, epoch: 8 | loss: 0.9777130
	speed: 0.0024s/iter; left time: 0.0679s
Updating learning rate to 0.0
Validation loss decreased (0.3662 --> 0.3661).  Saving model state dict ...
Epoch: 8 cost time: 2.3523097038269043
Epoch: 8, Steps: 1027 | Train Loss: 0.7648114 Vali Loss: 0.3661409 Best vali loss: 0.3661409

best validation loss 0.36614093309769696

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6023932
	speed: 0.0086s/iter; left time: 34.6923s
	iters: 200, epoch: 1 | loss: 0.5866478
	speed: 0.0025s/iter; left time: 9.6129s
	iters: 300, epoch: 1 | loss: 0.7136470
	speed: 0.0024s/iter; left time: 9.0756s
	iters: 400, epoch: 1 | loss: 0.3033785
	speed: 0.0024s/iter; left time: 8.7868s
	iters: 500, epoch: 1 | loss: 1.1966771
	speed: 0.0023s/iter; left time: 8.4493s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.5965650081634521
Epoch: 1, Steps: 514 | Train Loss: 0.6805487 Vali Loss: 0.3675637 Best vali loss: 0.3675637
	iters: 100, epoch: 2 | loss: 0.8271260
	speed: 0.0061s/iter; left time: 21.3881s
	iters: 200, epoch: 2 | loss: 0.5541379
	speed: 0.0025s/iter; left time: 8.5078s
	iters: 300, epoch: 2 | loss: 0.8538015
	speed: 0.0026s/iter; left time: 8.4159s
	iters: 400, epoch: 2 | loss: 0.5072539
	speed: 0.0026s/iter; left time: 8.1731s
	iters: 500, epoch: 2 | loss: 0.8122703
	speed: 0.0025s/iter; left time: 7.7877s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 1.3491322994232178
Epoch: 2, Steps: 514 | Train Loss: 0.7109179 Vali Loss: 0.3700374 Best vali loss: 0.3675637
	iters: 100, epoch: 3 | loss: 0.5022768
	speed: 0.0058s/iter; left time: 17.2582s
	iters: 200, epoch: 3 | loss: 0.4910638
	speed: 0.0025s/iter; left time: 7.2832s
	iters: 300, epoch: 3 | loss: 0.5987799
	speed: 0.0024s/iter; left time: 6.6879s
	iters: 400, epoch: 3 | loss: 0.4177969
	speed: 0.0024s/iter; left time: 6.3849s
	iters: 500, epoch: 3 | loss: 0.7256477
	speed: 0.0024s/iter; left time: 6.2251s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.2980358600616455
Epoch: 3, Steps: 514 | Train Loss: 0.5471130 Vali Loss: 0.3729913 Best vali loss: 0.3675637

best validation loss 0.36756371848124186

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 0.6577825546264648
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3649137 Best vali loss: 0.3649137
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 0.3131263256072998
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3752327 Best vali loss: 0.3649137
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 0.3412635326385498
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3816986 Best vali loss: 0.3649137

best validation loss 0.364913678368323

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6546248
	speed: 0.0094s/iter; left time: 8.8154s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 0.775714635848999
Epoch: 1, Steps: 129 | Train Loss: 0.6546248 Vali Loss: 0.3665314 Best vali loss: 0.3665314
	iters: 100, epoch: 2 | loss: 0.5720847
	speed: 0.0057s/iter; left time: 4.6032s
Updating learning rate to 0.00093122262415
Epoch: 2 cost time: 0.42798399925231934
Epoch: 2, Steps: 129 | Train Loss: 0.5720847 Vali Loss: 0.3714985 Best vali loss: 0.3665314
	iters: 100, epoch: 3 | loss: 0.4080926
	speed: 0.0056s/iter; left time: 3.7793s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.41135382652282715
Epoch: 3, Steps: 129 | Train Loss: 0.4080926 Vali Loss: 0.3732642 Best vali loss: 0.3665314

best validation loss 0.3665314036877076

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00105339799475
Epoch: 4 cost time: 0.6359710693359375
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3831765 Best vali loss: 0.3649137
Updating learning rate to 0.0006502800344725672
Epoch: 5 cost time: 0.3116931915283203
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3910601 Best vali loss: 0.3649137
Updating learning rate to 0.0003085331293739639
Epoch: 6 cost time: 0.3031196594238281
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3909598 Best vali loss: 0.3649137
Updating learning rate to 8.018514781204311e-05
Epoch: 7 cost time: 0.31250858306884766
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3982868 Best vali loss: 0.3649137
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3220231533050537
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3938658 Best vali loss: 0.3649137

best validation loss 0.364913678368323

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7017512
	speed: 0.0118s/iter; left time: 11.0338s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.4265).  Saving model state dict ...
Epoch: 1 cost time: 1.09688401222229
Epoch: 1, Steps: 129 | Train Loss: 0.7017512 Vali Loss: 0.4265017 Best vali loss: 0.4265017
	iters: 100, epoch: 2 | loss: 0.5182679
	speed: 0.0093s/iter; left time: 7.4475s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.4265 --> 0.4098).  Saving model state dict ...
Epoch: 2 cost time: 0.7650563716888428
Epoch: 2, Steps: 129 | Train Loss: 0.5182679 Vali Loss: 0.4098197 Best vali loss: 0.4098197
	iters: 100, epoch: 3 | loss: 0.5368702
	speed: 0.0090s/iter; left time: 6.0416s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.4098 --> 0.4034).  Saving model state dict ...
Epoch: 3 cost time: 0.7156431674957275
Epoch: 3, Steps: 129 | Train Loss: 0.5368702 Vali Loss: 0.4034356 Best vali loss: 0.4034356
	iters: 100, epoch: 4 | loss: 0.5571414
	speed: 0.0085s/iter; left time: 4.6598s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.4034 --> 0.4009).  Saving model state dict ...
Epoch: 4 cost time: 0.7039611339569092
Epoch: 4, Steps: 129 | Train Loss: 0.5571414 Vali Loss: 0.4009112 Best vali loss: 0.4009112
	iters: 100, epoch: 5 | loss: 0.6826801
	speed: 0.0093s/iter; left time: 3.8814s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.4009 --> 0.3997).  Saving model state dict ...
Epoch: 5 cost time: 0.7978224754333496
Epoch: 5, Steps: 129 | Train Loss: 0.6826801 Vali Loss: 0.3996567 Best vali loss: 0.3996567
	iters: 100, epoch: 6 | loss: 0.6704291
	speed: 0.0095s/iter; left time: 2.7239s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.3997 --> 0.3990).  Saving model state dict ...
Epoch: 6 cost time: 0.7851617336273193
Epoch: 6, Steps: 129 | Train Loss: 0.6704291 Vali Loss: 0.3990286 Best vali loss: 0.3990286
	iters: 100, epoch: 7 | loss: 0.6733106
	speed: 0.0087s/iter; left time: 1.3894s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.3990 --> 0.3987).  Saving model state dict ...
Epoch: 7 cost time: 0.7063028812408447
Epoch: 7, Steps: 129 | Train Loss: 0.6733106 Vali Loss: 0.3987397 Best vali loss: 0.3987397
	iters: 100, epoch: 8 | loss: 0.6578602
	speed: 0.0087s/iter; left time: 0.2596s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.3987 --> 0.3986).  Saving model state dict ...
Epoch: 8 cost time: 0.6990489959716797
Epoch: 8, Steps: 129 | Train Loss: 0.6578602 Vali Loss: 0.3985848 Best vali loss: 0.3985848

best validation loss 0.39858477391990554

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0660560
	speed: 0.0107s/iter; left time: 86.7635s
	iters: 200, epoch: 1 | loss: 0.3913689
	speed: 0.0049s/iter; left time: 39.4354s
	iters: 300, epoch: 1 | loss: 0.2897889
	speed: 0.0050s/iter; left time: 39.8819s
	iters: 400, epoch: 1 | loss: 0.4974125
	speed: 0.0050s/iter; left time: 38.8934s
	iters: 500, epoch: 1 | loss: 0.1738655
	speed: 0.0050s/iter; left time: 38.3711s
	iters: 600, epoch: 1 | loss: 1.1403787
	speed: 0.0050s/iter; left time: 38.2028s
	iters: 700, epoch: 1 | loss: 0.5487093
	speed: 0.0049s/iter; left time: 36.7270s
	iters: 800, epoch: 1 | loss: 1.0967160
	speed: 0.0048s/iter; left time: 35.2609s
	iters: 900, epoch: 1 | loss: 0.4350128
	speed: 0.0048s/iter; left time: 35.0820s
	iters: 1000, epoch: 1 | loss: 1.4691064
	speed: 0.0047s/iter; left time: 34.0637s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 5.361597061157227
Epoch: 1, Steps: 1027 | Train Loss: 0.7108415 Vali Loss: 0.3732273 Best vali loss: 0.3732273
	iters: 100, epoch: 2 | loss: 1.4807224
	speed: 0.0126s/iter; left time: 89.0152s
	iters: 200, epoch: 2 | loss: 0.8274930
	speed: 0.0049s/iter; left time: 34.4218s
	iters: 300, epoch: 2 | loss: 0.2858120
	speed: 0.0049s/iter; left time: 33.7420s
	iters: 400, epoch: 2 | loss: 0.4144226
	speed: 0.0049s/iter; left time: 33.5258s
	iters: 500, epoch: 2 | loss: 0.4984467
	speed: 0.0049s/iter; left time: 32.8796s
	iters: 600, epoch: 2 | loss: 0.5263249
	speed: 0.0049s/iter; left time: 32.1165s
	iters: 700, epoch: 2 | loss: 0.9599699
	speed: 0.0049s/iter; left time: 31.6469s
	iters: 800, epoch: 2 | loss: 0.3233084
	speed: 0.0049s/iter; left time: 31.6124s
	iters: 900, epoch: 2 | loss: 0.2756190
	speed: 0.0048s/iter; left time: 30.4699s
	iters: 1000, epoch: 2 | loss: 0.6417802
	speed: 0.0048s/iter; left time: 29.5866s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.3732 --> 0.3728).  Saving model state dict ...
Epoch: 2 cost time: 5.066358327865601
Epoch: 2, Steps: 1027 | Train Loss: 0.6233899 Vali Loss: 0.3727574 Best vali loss: 0.3727574
	iters: 100, epoch: 3 | loss: 0.4268719
	speed: 0.0125s/iter; left time: 75.7509s
	iters: 200, epoch: 3 | loss: 0.4328243
	speed: 0.0050s/iter; left time: 29.8329s
	iters: 300, epoch: 3 | loss: 0.2345259
	speed: 0.0050s/iter; left time: 29.3423s
	iters: 400, epoch: 3 | loss: 0.9852920
	speed: 0.0050s/iter; left time: 28.7685s
	iters: 500, epoch: 3 | loss: 0.7888399
	speed: 0.0050s/iter; left time: 28.2609s
	iters: 600, epoch: 3 | loss: 2.4146416
	speed: 0.0050s/iter; left time: 27.7242s
	iters: 700, epoch: 3 | loss: 1.0180265
	speed: 0.0050s/iter; left time: 27.4002s
	iters: 800, epoch: 3 | loss: 0.3801467
	speed: 0.0050s/iter; left time: 26.8627s
	iters: 900, epoch: 3 | loss: 1.0910833
	speed: 0.0050s/iter; left time: 26.3200s
	iters: 1000, epoch: 3 | loss: 0.3557540
	speed: 0.0050s/iter; left time: 25.7990s
Updating learning rate to 0.002771304313062916
Epoch: 3 cost time: 5.173500061035156
Epoch: 3, Steps: 1027 | Train Loss: 0.8128006 Vali Loss: 0.3757968 Best vali loss: 0.3727574
	iters: 100, epoch: 4 | loss: 0.2361536
	speed: 0.0124s/iter; left time: 62.6466s
	iters: 200, epoch: 4 | loss: 0.2787037
	speed: 0.0045s/iter; left time: 22.0640s
	iters: 300, epoch: 4 | loss: 0.3477141
	speed: 0.0044s/iter; left time: 21.3027s
	iters: 400, epoch: 4 | loss: 1.2385191
	speed: 0.0044s/iter; left time: 21.0036s
	iters: 500, epoch: 4 | loss: 0.2107938
	speed: 0.0044s/iter; left time: 20.3512s
	iters: 600, epoch: 4 | loss: 1.6974264
	speed: 0.0047s/iter; left time: 21.4137s
	iters: 700, epoch: 4 | loss: 0.3631603
	speed: 0.0048s/iter; left time: 21.2170s
	iters: 800, epoch: 4 | loss: 0.4656226
	speed: 0.0048s/iter; left time: 20.8599s
	iters: 900, epoch: 4 | loss: 0.4583619
	speed: 0.0048s/iter; left time: 20.1697s
	iters: 1000, epoch: 4 | loss: 1.0717828
	speed: 0.0047s/iter; left time: 19.4596s
Updating learning rate to 0.00200429414875
Validation loss decreased (0.3728 --> 0.3651).  Saving model state dict ...
Epoch: 4 cost time: 4.790390968322754
Epoch: 4, Steps: 1027 | Train Loss: 0.6368238 Vali Loss: 0.3651397 Best vali loss: 0.3651397
	iters: 100, epoch: 5 | loss: 0.3937625
	speed: 0.0123s/iter; left time: 49.4787s
	iters: 200, epoch: 5 | loss: 0.6255246
	speed: 0.0048s/iter; left time: 18.6376s
	iters: 300, epoch: 5 | loss: 0.3531752
	speed: 0.0048s/iter; left time: 18.2821s
	iters: 400, epoch: 5 | loss: 1.4178050
	speed: 0.0048s/iter; left time: 17.8287s
	iters: 500, epoch: 5 | loss: 0.4189760
	speed: 0.0048s/iter; left time: 17.1481s
	iters: 600, epoch: 5 | loss: 1.7434208
	speed: 0.0049s/iter; left time: 17.0550s
	iters: 700, epoch: 5 | loss: 0.8794751
	speed: 0.0050s/iter; left time: 17.0835s
	iters: 800, epoch: 5 | loss: 0.4067223
	speed: 0.0050s/iter; left time: 16.5518s
	iters: 900, epoch: 5 | loss: 0.3044012
	speed: 0.0050s/iter; left time: 16.0374s
	iters: 1000, epoch: 5 | loss: 0.4892117
	speed: 0.0050s/iter; left time: 15.5459s
Updating learning rate to 0.0012372839844370842
Epoch: 5 cost time: 5.048884153366089
Epoch: 5, Steps: 1027 | Train Loss: 0.7032474 Vali Loss: 0.3735102 Best vali loss: 0.3651397
	iters: 100, epoch: 6 | loss: 0.9024114
	speed: 0.0126s/iter; left time: 37.6986s
	iters: 200, epoch: 6 | loss: 0.9786715
	speed: 0.0050s/iter; left time: 14.3857s
	iters: 300, epoch: 6 | loss: 0.9275361
	speed: 0.0047s/iter; left time: 13.1603s
	iters: 400, epoch: 6 | loss: 0.3054570
	speed: 0.0046s/iter; left time: 12.3383s
	iters: 500, epoch: 6 | loss: 0.2430204
	speed: 0.0046s/iter; left time: 11.7861s
	iters: 600, epoch: 6 | loss: 0.4621363
	speed: 0.0048s/iter; left time: 11.8142s
	iters: 700, epoch: 6 | loss: 0.8753741
	speed: 0.0047s/iter; left time: 11.2799s
	iters: 800, epoch: 6 | loss: 0.4250987
	speed: 0.0047s/iter; left time: 10.7272s
	iters: 900, epoch: 6 | loss: 0.3640079
	speed: 0.0047s/iter; left time: 10.3188s
	iters: 1000, epoch: 6 | loss: 0.9357717
	speed: 0.0047s/iter; left time: 9.8690s
Updating learning rate to 0.0005870441646763563
Epoch: 6 cost time: 4.921954154968262
Epoch: 6, Steps: 1027 | Train Loss: 0.6419485 Vali Loss: 0.3706177 Best vali loss: 0.3651397
	iters: 100, epoch: 7 | loss: 1.3532087
	speed: 0.0126s/iter; left time: 24.5593s
	iters: 200, epoch: 7 | loss: 1.4802939
	speed: 0.0050s/iter; left time: 9.2934s
	iters: 300, epoch: 7 | loss: 0.5131729
	speed: 0.0050s/iter; left time: 8.7554s
	iters: 400, epoch: 7 | loss: 0.4294224
	speed: 0.0050s/iter; left time: 8.2543s
	iters: 500, epoch: 7 | loss: 0.9840326
	speed: 0.0047s/iter; left time: 7.3824s
	iters: 600, epoch: 7 | loss: 0.7760671
	speed: 0.0048s/iter; left time: 6.9448s
	iters: 700, epoch: 7 | loss: 0.4398198
	speed: 0.0047s/iter; left time: 6.4018s
	iters: 800, epoch: 7 | loss: 0.3452562
	speed: 0.0048s/iter; left time: 5.9984s
	iters: 900, epoch: 7 | loss: 0.2662485
	speed: 0.0048s/iter; left time: 5.5993s
	iters: 1000, epoch: 7 | loss: 1.3413919
	speed: 0.0050s/iter; left time: 5.2461s
Updating learning rate to 0.0001525678075877426
Epoch: 7 cost time: 5.056868553161621
Epoch: 7, Steps: 1027 | Train Loss: 0.7928914 Vali Loss: 0.3720315 Best vali loss: 0.3651397
	iters: 100, epoch: 8 | loss: 0.8775836
	speed: 0.0122s/iter; left time: 11.3197s
	iters: 200, epoch: 8 | loss: 1.1436177
	speed: 0.0043s/iter; left time: 3.5856s
	iters: 300, epoch: 8 | loss: 0.7578764
	speed: 0.0045s/iter; left time: 3.2493s
	iters: 400, epoch: 8 | loss: 0.2127290
	speed: 0.0044s/iter; left time: 2.7746s
	iters: 500, epoch: 8 | loss: 0.2855594
	speed: 0.0043s/iter; left time: 2.2796s
	iters: 600, epoch: 8 | loss: 0.3530550
	speed: 0.0045s/iter; left time: 1.9338s
	iters: 700, epoch: 8 | loss: 1.1772684
	speed: 0.0046s/iter; left time: 1.5190s
	iters: 800, epoch: 8 | loss: 0.2347990
	speed: 0.0048s/iter; left time: 1.0895s
	iters: 900, epoch: 8 | loss: 0.3155826
	speed: 0.0045s/iter; left time: 0.5736s
	iters: 1000, epoch: 8 | loss: 0.5780798
	speed: 0.0046s/iter; left time: 0.1275s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.651671648025513
Epoch: 8, Steps: 1027 | Train Loss: 0.5936151 Vali Loss: 0.3703027 Best vali loss: 0.3651397

best validation loss 0.365139678911048

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.4382).  Saving model state dict ...
Epoch: 1 cost time: 0.7866766452789307
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4381819 Best vali loss: 0.4381819
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.4382 --> 0.4272).  Saving model state dict ...
Epoch: 2 cost time: 0.4414050579071045
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4272486 Best vali loss: 0.4272486
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.4272 --> 0.4224).  Saving model state dict ...
Epoch: 3 cost time: 0.43677639961242676
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4224125 Best vali loss: 0.4224125

best validation loss 0.42241252226304915

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5525812
	speed: 0.0134s/iter; left time: 12.5368s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.4000).  Saving model state dict ...
Epoch: 1 cost time: 1.3065180778503418
Epoch: 1, Steps: 129 | Train Loss: 0.5525812 Vali Loss: 0.3999725 Best vali loss: 0.3999725
	iters: 100, epoch: 2 | loss: 0.5169592
	speed: 0.0122s/iter; left time: 9.7894s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 0.9907474517822266
Epoch: 2, Steps: 129 | Train Loss: 0.5169592 Vali Loss: 0.4001531 Best vali loss: 0.3999725
	iters: 100, epoch: 3 | loss: 0.4812831
	speed: 0.0120s/iter; left time: 8.0685s
Updating learning rate to 0.0019497966725057021
Epoch: 3 cost time: 0.9925739765167236
Epoch: 3, Steps: 129 | Train Loss: 0.4812831 Vali Loss: 0.4037083 Best vali loss: 0.3999725

best validation loss 0.39997246309909934

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5300471
	speed: 0.0112s/iter; left time: 21.9850s
	iters: 200, epoch: 1 | loss: 1.1420807
	speed: 0.0052s/iter; left time: 9.6376s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.6736619472503662
Epoch: 1, Steps: 257 | Train Loss: 0.8360639 Vali Loss: 0.3690695 Best vali loss: 0.3690695
	iters: 100, epoch: 2 | loss: 0.6744125
	speed: 0.0109s/iter; left time: 18.5700s
	iters: 200, epoch: 2 | loss: 0.8814356
	speed: 0.0054s/iter; left time: 8.5659s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.3691 --> 0.3677).  Saving model state dict ...
Epoch: 2 cost time: 1.38840651512146
Epoch: 2, Steps: 257 | Train Loss: 0.7779241 Vali Loss: 0.3676885 Best vali loss: 0.3676885
	iters: 100, epoch: 3 | loss: 0.7050846
	speed: 0.0106s/iter; left time: 15.3554s
	iters: 200, epoch: 3 | loss: 0.3062209
	speed: 0.0049s/iter; left time: 6.5719s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 1.3323383331298828
Epoch: 3, Steps: 257 | Train Loss: 0.5056527 Vali Loss: 0.3683654 Best vali loss: 0.3676885

best validation loss 0.3676884991832238

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4557335
	speed: 0.0113s/iter; left time: 13.4122s
	iters: 200, epoch: 4 | loss: 1.0463786
	speed: 0.0052s/iter; left time: 5.6388s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 1.6716406345367432
Epoch: 4, Steps: 257 | Train Loss: 0.7510560 Vali Loss: 0.3729042 Best vali loss: 0.3676885
	iters: 100, epoch: 5 | loss: 0.5543391
	speed: 0.0107s/iter; left time: 9.9284s
	iters: 200, epoch: 5 | loss: 0.7516919
	speed: 0.0053s/iter; left time: 4.3996s
Updating learning rate to 0.00010198984921612144
Epoch: 5 cost time: 1.3912241458892822
Epoch: 5, Steps: 257 | Train Loss: 0.6530155 Vali Loss: 0.3866791 Best vali loss: 0.3676885
	iters: 100, epoch: 6 | loss: 0.6436303
	speed: 0.0110s/iter; left time: 7.4210s
	iters: 200, epoch: 6 | loss: 0.2776652
	speed: 0.0053s/iter; left time: 3.0304s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 1.405630350112915
Epoch: 6, Steps: 257 | Train Loss: 0.4606477 Vali Loss: 0.3922041 Best vali loss: 0.3676885
	iters: 100, epoch: 7 | loss: 0.4566967
	speed: 0.0108s/iter; left time: 4.4745s
	iters: 200, epoch: 7 | loss: 0.6262738
	speed: 0.0049s/iter; left time: 1.5476s
Updating learning rate to 1.2576229779768348e-05
Epoch: 7 cost time: 1.3219807147979736
Epoch: 7, Steps: 257 | Train Loss: 0.5414852 Vali Loss: 0.3929209 Best vali loss: 0.3676885
	iters: 100, epoch: 8 | loss: 0.6222814
	speed: 0.0107s/iter; left time: 1.6845s
	iters: 200, epoch: 8 | loss: 0.6945255
	speed: 0.0052s/iter; left time: 0.3011s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3860046863555908
Epoch: 8, Steps: 257 | Train Loss: 0.6584035 Vali Loss: 0.3893732 Best vali loss: 0.3676885

best validation loss 0.3676884991832238

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7328022
	speed: 0.0097s/iter; left time: 18.8876s
	iters: 200, epoch: 1 | loss: 0.6781894
	speed: 0.0033s/iter; left time: 6.1730s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.3864).  Saving model state dict ...
Epoch: 1 cost time: 1.2307324409484863
Epoch: 1, Steps: 257 | Train Loss: 0.7054958 Vali Loss: 0.3863961 Best vali loss: 0.3863961
	iters: 100, epoch: 2 | loss: 0.7193683
	speed: 0.0081s/iter; left time: 13.8146s
	iters: 200, epoch: 2 | loss: 0.8383250
	speed: 0.0033s/iter; left time: 5.2183s
Updating learning rate to 0.00132457724675
Validation loss decreased (0.3864 --> 0.3837).  Saving model state dict ...
Epoch: 2 cost time: 0.931718111038208
Epoch: 2, Steps: 257 | Train Loss: 0.7788466 Vali Loss: 0.3837390 Best vali loss: 0.3837390
	iters: 100, epoch: 3 | loss: 0.4078695
	speed: 0.0081s/iter; left time: 11.7422s
	iters: 200, epoch: 3 | loss: 0.4615102
	speed: 0.0037s/iter; left time: 5.0038s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 1.003624439239502
Epoch: 3, Steps: 257 | Train Loss: 0.4346899 Vali Loss: 0.3851650 Best vali loss: 0.3837390
	iters: 100, epoch: 4 | loss: 0.3635841
	speed: 0.0080s/iter; left time: 9.5147s
	iters: 200, epoch: 4 | loss: 0.7098786
	speed: 0.0037s/iter; left time: 4.0259s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 0.9875500202178955
Epoch: 4, Steps: 257 | Train Loss: 0.5367314 Vali Loss: 0.3938060 Best vali loss: 0.3837390
	iters: 100, epoch: 5 | loss: 0.3855132
	speed: 0.0083s/iter; left time: 7.7037s
	iters: 200, epoch: 5 | loss: 0.2616648
	speed: 0.0034s/iter; left time: 2.7943s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 0.9464230537414551
Epoch: 5, Steps: 257 | Train Loss: 0.3235890 Vali Loss: 0.3999572 Best vali loss: 0.3837390
	iters: 100, epoch: 6 | loss: 0.4254870
	speed: 0.0081s/iter; left time: 5.4542s
	iters: 200, epoch: 6 | loss: 0.5166591
	speed: 0.0037s/iter; left time: 2.1283s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 1.007272720336914
Epoch: 6, Steps: 257 | Train Loss: 0.4710730 Vali Loss: 0.3916579 Best vali loss: 0.3837390
	iters: 100, epoch: 7 | loss: 0.5576835
	speed: 0.0081s/iter; left time: 3.3677s
	iters: 200, epoch: 7 | loss: 0.9417138
	speed: 0.0037s/iter; left time: 1.1540s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 0.9702174663543701
Epoch: 7, Steps: 257 | Train Loss: 0.7496986 Vali Loss: 0.4014423 Best vali loss: 0.3837390
	iters: 100, epoch: 8 | loss: 0.4331661
	speed: 0.0080s/iter; left time: 1.2575s
	iters: 200, epoch: 8 | loss: 0.6082231
	speed: 0.0037s/iter; left time: 0.2147s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 0.9843008518218994
Epoch: 8, Steps: 257 | Train Loss: 0.5206946 Vali Loss: 0.3972629 Best vali loss: 0.3837390

best validation loss 0.3837390309115524

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5234166
	speed: 0.0097s/iter; left time: 19.0630s
	iters: 200, epoch: 1 | loss: 0.5821560
	speed: 0.0035s/iter; left time: 6.5337s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.3985).  Saving model state dict ...
Epoch: 1 cost time: 1.277071237564087
Epoch: 1, Steps: 257 | Train Loss: 0.5527863 Vali Loss: 0.3985000 Best vali loss: 0.3985000
	iters: 100, epoch: 2 | loss: 0.6789176
	speed: 0.0081s/iter; left time: 13.6879s
	iters: 200, epoch: 2 | loss: 0.6931348
	speed: 0.0034s/iter; left time: 5.4002s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.3985 --> 0.3784).  Saving model state dict ...
Epoch: 2 cost time: 0.9279839992523193
Epoch: 2, Steps: 257 | Train Loss: 0.6860262 Vali Loss: 0.3784268 Best vali loss: 0.3784268
	iters: 100, epoch: 3 | loss: 0.5699136
	speed: 0.0076s/iter; left time: 10.8953s
	iters: 200, epoch: 3 | loss: 1.1771783
	speed: 0.0033s/iter; left time: 4.4815s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.3784 --> 0.3704).  Saving model state dict ...
Epoch: 3 cost time: 0.9092090129852295
Epoch: 3, Steps: 257 | Train Loss: 0.8735459 Vali Loss: 0.3703665 Best vali loss: 0.3703665
	iters: 100, epoch: 4 | loss: 0.8465848
	speed: 0.0080s/iter; left time: 9.5050s
	iters: 200, epoch: 4 | loss: 0.3325431
	speed: 0.0036s/iter; left time: 3.9558s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.3704 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 0.9872908592224121
Epoch: 4, Steps: 257 | Train Loss: 0.5895639 Vali Loss: 0.3677603 Best vali loss: 0.3677603
	iters: 100, epoch: 5 | loss: 0.7951797
	speed: 0.0083s/iter; left time: 7.6648s
	iters: 200, epoch: 5 | loss: 0.5031798
	speed: 0.0037s/iter; left time: 3.0447s
Updating learning rate to 2.986130394788764e-05
Validation loss decreased (0.3678 --> 0.3665).  Saving model state dict ...
Epoch: 5 cost time: 1.0016276836395264
Epoch: 5, Steps: 257 | Train Loss: 0.6491798 Vali Loss: 0.3664910 Best vali loss: 0.3664910
	iters: 100, epoch: 6 | loss: 0.6448761
	speed: 0.0081s/iter; left time: 5.4489s
	iters: 200, epoch: 6 | loss: 0.8369879
	speed: 0.0036s/iter; left time: 2.0439s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.3665 --> 0.3662).  Saving model state dict ...
Epoch: 6 cost time: 0.9403688907623291
Epoch: 6, Steps: 257 | Train Loss: 0.7409320 Vali Loss: 0.3661825 Best vali loss: 0.3661825
	iters: 100, epoch: 7 | loss: 0.6351355
	speed: 0.0078s/iter; left time: 3.2309s
	iters: 200, epoch: 7 | loss: 0.6567860
	speed: 0.0035s/iter; left time: 1.0908s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.3662 --> 0.3660).  Saving model state dict ...
Epoch: 7 cost time: 0.9264857769012451
Epoch: 7, Steps: 257 | Train Loss: 0.6459608 Vali Loss: 0.3660374 Best vali loss: 0.3660374
	iters: 100, epoch: 8 | loss: 0.7207243
	speed: 0.0078s/iter; left time: 1.2321s
	iters: 200, epoch: 8 | loss: 0.5650294
	speed: 0.0033s/iter; left time: 0.1897s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8967897891998291
Epoch: 8, Steps: 257 | Train Loss: 0.6428769 Vali Loss: 0.3660429 Best vali loss: 0.3660374

best validation loss 0.36603736923110974

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7349434
	speed: 0.0101s/iter; left time: 19.8059s
	iters: 200, epoch: 1 | loss: 0.5414647
	speed: 0.0038s/iter; left time: 7.0782s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.3641).  Saving model state dict ...
Epoch: 1 cost time: 1.3302669525146484
Epoch: 1, Steps: 257 | Train Loss: 0.6382041 Vali Loss: 0.3640932 Best vali loss: 0.3640932
	iters: 100, epoch: 2 | loss: 0.8206618
	speed: 0.0081s/iter; left time: 13.8474s
	iters: 200, epoch: 2 | loss: 0.7026503
	speed: 0.0035s/iter; left time: 5.5794s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 0.932701587677002
Epoch: 2, Steps: 257 | Train Loss: 0.7616560 Vali Loss: 0.3675566 Best vali loss: 0.3640932
	iters: 100, epoch: 3 | loss: 0.6763277
	speed: 0.0076s/iter; left time: 10.9145s
	iters: 200, epoch: 3 | loss: 0.5287841
	speed: 0.0033s/iter; left time: 4.4142s
Updating learning rate to 0.00020740251485476345
Epoch: 3 cost time: 0.8978409767150879
Epoch: 3, Steps: 257 | Train Loss: 0.6025559 Vali Loss: 0.3737374 Best vali loss: 0.3640932

best validation loss 0.36409320873455353

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006799088951, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006799088951
Validation loss decreased (inf --> 0.3755).  Saving model state dict ...
Epoch: 1 cost time: 0.792259931564331
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3754639 Best vali loss: 0.3754639
Updating learning rate to 0.00033995444755
Validation loss decreased (0.3755 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 0.45152831077575684
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3665771 Best vali loss: 0.3665771
Updating learning rate to 0.000169977223775
Epoch: 3 cost time: 0.442852258682251
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3684409 Best vali loss: 0.3665771

best validation loss 0.3665770738087375

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092179225503, 'e_layers': 4, 'learning_rate': 0.0006752840957, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006752840957
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 0.7991147041320801
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669129 Best vali loss: 0.3669129
Updating learning rate to 0.00033764204785
Validation loss decreased (0.3669 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 0.4729728698730469
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3662851 Best vali loss: 0.3662851
Updating learning rate to 0.000168821023925
Validation loss decreased (0.3663 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 0.47855615615844727
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3638892 Best vali loss: 0.3638892

best validation loss 0.36388917555977646

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092179225503, 'e_layers': 4, 'learning_rate': 0.0006752840957, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.44105119625e-05
Validation loss decreased (0.3639 --> 0.3574).  Saving model state dict ...
Epoch: 4 cost time: 0.7883965969085693
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3573679 Best vali loss: 0.3573679
Updating learning rate to 4.220525598125e-05
Epoch: 5 cost time: 0.4775846004486084
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3605340 Best vali loss: 0.3573679
Updating learning rate to 2.1102627990625e-05
Epoch: 6 cost time: 0.42185282707214355
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3635728 Best vali loss: 0.3573679
Updating learning rate to 1.05513139953125e-05
Epoch: 7 cost time: 0.42336297035217285
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3649532 Best vali loss: 0.3573679
Updating learning rate to 5.27565699765625e-06
Epoch: 8 cost time: 0.44300031661987305
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3637523 Best vali loss: 0.3573679

best validation loss 0.35736789490244475

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092034936176, 'e_layers': 4, 'learning_rate': 0.0006568419046, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006568419046
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 0.7761063575744629
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3748363 Best vali loss: 0.3748363
Updating learning rate to 0.0003284209523
Validation loss decreased (0.3748 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 0.4666111469268799
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3666171 Best vali loss: 0.3666171
Updating learning rate to 0.00016421047615
Epoch: 3 cost time: 0.47331666946411133
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3707857 Best vali loss: 0.3666171
Updating learning rate to 8.2105238075e-05
Validation loss decreased (0.3666 --> 0.3613).  Saving model state dict ...
Epoch: 4 cost time: 0.4776639938354492
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3613355 Best vali loss: 0.3613355
Updating learning rate to 4.10526190375e-05
Validation loss decreased (0.3613 --> 0.3602).  Saving model state dict ...
Epoch: 5 cost time: 0.47257447242736816
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3602220 Best vali loss: 0.3602220
Updating learning rate to 2.052630951875e-05
Epoch: 6 cost time: 0.4619181156158447
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3607765 Best vali loss: 0.3602220
Updating learning rate to 1.0263154759375e-05
Validation loss decreased (0.3602 --> 0.3599).  Saving model state dict ...
Epoch: 7 cost time: 0.4362969398498535
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3598884 Best vali loss: 0.3598884
Updating learning rate to 5.1315773796875e-06
Validation loss decreased (0.3599 --> 0.3592).  Saving model state dict ...
Epoch: 8 cost time: 0.4473116397857666
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3592418 Best vali loss: 0.3592418

best validation loss 0.35924175542089465

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092095592996, 'e_layers': 4, 'learning_rate': 0.0006673410658, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006673410658
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 0.7763073444366455
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3751282 Best vali loss: 0.3751282
Updating learning rate to 0.0003336705329
Validation loss decreased (0.3751 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 0.44987940788269043
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3666745 Best vali loss: 0.3666745
Updating learning rate to 0.00016683526645
Epoch: 3 cost time: 0.46058106422424316
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3705376 Best vali loss: 0.3666745
Updating learning rate to 8.3417633225e-05
Validation loss decreased (0.3667 --> 0.3610).  Saving model state dict ...
Epoch: 4 cost time: 0.462932825088501
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3610191 Best vali loss: 0.3610191
Updating learning rate to 4.17088166125e-05
Validation loss decreased (0.3610 --> 0.3599).  Saving model state dict ...
Epoch: 5 cost time: 0.474210262298584
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3598518 Best vali loss: 0.3598518
Updating learning rate to 2.085440830625e-05
Epoch: 6 cost time: 0.43952202796936035
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3606441 Best vali loss: 0.3598518
Updating learning rate to 1.0427204153125e-05
Validation loss decreased (0.3599 --> 0.3596).  Saving model state dict ...
Epoch: 7 cost time: 0.4775831699371338
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3595983 Best vali loss: 0.3595983
Updating learning rate to 5.2136020765625e-06
Validation loss decreased (0.3596 --> 0.3590).  Saving model state dict ...
Epoch: 8 cost time: 0.47031259536743164
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3589579 Best vali loss: 0.3589579

best validation loss 0.3589578799156871

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092128266903, 'e_layers': 4, 'learning_rate': 0.0006733001889, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006733001889
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 0.7860651016235352
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3653372 Best vali loss: 0.3653372
Updating learning rate to 0.00033665009445
Validation loss decreased (0.3653 --> 0.3644).  Saving model state dict ...
Epoch: 2 cost time: 0.4766879081726074
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3644133 Best vali loss: 0.3644133
Updating learning rate to 0.000168325047225
Epoch: 3 cost time: 0.45954465866088867
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3786812 Best vali loss: 0.3644133

best validation loss 0.3644133315924811

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.00914488854, 'e_layers': 4, 'learning_rate': 0.0006610948579, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006610948579
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 0.8010084629058838
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3653289 Best vali loss: 0.3653289
Updating learning rate to 0.00033054742895
Validation loss decreased (0.3653 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 0.438586950302124
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3647079 Best vali loss: 0.3647079
Updating learning rate to 0.000165273714475
Epoch: 3 cost time: 0.4444425106048584
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3806891 Best vali loss: 0.3647079

best validation loss 0.3647078587053333

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0090401167403, 'e_layers': 4, 'learning_rate': 0.0006557196353, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006557196353
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 0.7791028022766113
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3748349 Best vali loss: 0.3748349
Updating learning rate to 0.00032785981765
Validation loss decreased (0.3748 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 0.4668562412261963
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3666959 Best vali loss: 0.3666959
Updating learning rate to 0.000163929908825
Epoch: 3 cost time: 0.4926466941833496
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3704782 Best vali loss: 0.3666959

best validation loss 0.36669592603250667

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0092128266903, 'e_layers': 4, 'learning_rate': 0.0006733001889, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.41625236125e-05
Epoch: 4 cost time: 0.7784848213195801
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3783190 Best vali loss: 0.3644133
Updating learning rate to 4.208126180625e-05
Epoch: 5 cost time: 0.4782733917236328
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3723035 Best vali loss: 0.3644133
Updating learning rate to 2.1040630903125e-05
Epoch: 6 cost time: 0.48133182525634766
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3779570 Best vali loss: 0.3644133
Updating learning rate to 1.05203154515625e-05
Epoch: 7 cost time: 0.477771520614624
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3767227 Best vali loss: 0.3644133
Updating learning rate to 5.26015772578125e-06
Epoch: 8 cost time: 0.4822244644165039
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3735865 Best vali loss: 0.3644133

best validation loss 0.3644133315924811

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.009069233474, 'e_layers': 4, 'learning_rate': 0.0006661609356, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006661609356
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 0.7855949401855469
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3668351 Best vali loss: 0.3668351
Updating learning rate to 0.0003330804678
Validation loss decreased (0.3668 --> 0.3661).  Saving model state dict ...
Epoch: 2 cost time: 0.4328627586364746
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3660741 Best vali loss: 0.3660741
Updating learning rate to 0.0001665402339
Validation loss decreased (0.3661 --> 0.3636).  Saving model state dict ...
Epoch: 3 cost time: 0.44475221633911133
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3636051 Best vali loss: 0.3636051
Updating learning rate to 8.327011695e-05
Epoch: 4 cost time: 0.47315549850463867
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3655591 Best vali loss: 0.3636051
Updating learning rate to 4.1635058475e-05
Validation loss decreased (0.3636 --> 0.3624).  Saving model state dict ...
Epoch: 5 cost time: 0.47346997261047363
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3624328 Best vali loss: 0.3624328
Updating learning rate to 2.08175292375e-05
Epoch: 6 cost time: 0.43565797805786133
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3681978 Best vali loss: 0.3624328
Updating learning rate to 1.040876461875e-05
Epoch: 7 cost time: 0.4266197681427002
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3725512 Best vali loss: 0.3624328
Updating learning rate to 5.204382309375e-06
Epoch: 8 cost time: 0.43109631538391113
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3734493 Best vali loss: 0.3624328

best validation loss 0.362432786418319

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0109997051995, 'e_layers': 4, 'learning_rate': 0.0007097437431, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007097437431
Validation loss decreased (inf --> 0.3864).  Saving model state dict ...
Epoch: 1 cost time: 1.313544511795044
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3864293 Best vali loss: 0.3864293
Updating learning rate to 0.00035487187155
Epoch: 2 cost time: 1.0179460048675537
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3904133 Best vali loss: 0.3864293
Updating learning rate to 0.000177435935775
Validation loss decreased (0.3864 --> 0.3824).  Saving model state dict ...
Epoch: 3 cost time: 1.01267671585083
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3823688 Best vali loss: 0.3823688
Updating learning rate to 8.87179678875e-05
Validation loss decreased (0.3824 --> 0.3801).  Saving model state dict ...
Epoch: 4 cost time: 1.014831304550171
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3801097 Best vali loss: 0.3801097
Updating learning rate to 4.435898394375e-05
Validation loss decreased (0.3801 --> 0.3724).  Saving model state dict ...
Epoch: 5 cost time: 1.0105817317962646
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3723800 Best vali loss: 0.3723800
Updating learning rate to 2.2179491971875e-05
Validation loss decreased (0.3724 --> 0.3565).  Saving model state dict ...
Epoch: 6 cost time: 1.0173089504241943
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3564930 Best vali loss: 0.3564930
Updating learning rate to 1.10897459859375e-05
Epoch: 7 cost time: 1.0209381580352783
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3583836 Best vali loss: 0.3564930
Updating learning rate to 5.54487299296875e-06
Validation loss decreased (0.3565 --> 0.3559).  Saving model state dict ...
Epoch: 8 cost time: 1.0154516696929932
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3559306 Best vali loss: 0.3559306

best validation loss 0.3559305522905586

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0108114394128, 'e_layers': 4, 'learning_rate': 0.0007007261898, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007007261898
Validation loss decreased (inf --> 0.3833).  Saving model state dict ...
Epoch: 1 cost time: 1.3298754692077637
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3832690 Best vali loss: 0.3832690
Updating learning rate to 0.0003503630949
Epoch: 2 cost time: 1.0265681743621826
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4009660 Best vali loss: 0.3832690
Updating learning rate to 0.00017518154745
Validation loss decreased (0.3833 --> 0.3829).  Saving model state dict ...
Epoch: 3 cost time: 1.020132064819336
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3828580 Best vali loss: 0.3828580

best validation loss 0.38285802799498403

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0110559651402, 'e_layers': 4, 'learning_rate': 0.0007014032084, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007014032084
Validation loss decreased (inf --> 0.3846).  Saving model state dict ...
Epoch: 1 cost time: 1.3132572174072266
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3845922 Best vali loss: 0.3845922
Updating learning rate to 0.0003507016042
Epoch: 2 cost time: 1.0112080574035645
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3976638 Best vali loss: 0.3845922
Updating learning rate to 0.0001753508021
Validation loss decreased (0.3846 --> 0.3786).  Saving model state dict ...
Epoch: 3 cost time: 1.0060851573944092
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3785689 Best vali loss: 0.3785689

best validation loss 0.3785688593954375

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0108650550953, 'e_layers': 4, 'learning_rate': 0.0006693635441, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006693635441
Validation loss decreased (inf --> 0.3803).  Saving model state dict ...
Epoch: 1 cost time: 1.3453803062438965
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3803355 Best vali loss: 0.3803355
Updating learning rate to 0.00033468177205
Epoch: 2 cost time: 1.0350878238677979
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4114392 Best vali loss: 0.3803355
Updating learning rate to 0.000167340886025
Epoch: 3 cost time: 1.0267186164855957
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3908335 Best vali loss: 0.3803355

best validation loss 0.3803354571985121

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0110559651402, 'e_layers': 4, 'learning_rate': 0.0007014032084, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.767540105e-05
Validation loss decreased (0.3786 --> 0.3729).  Saving model state dict ...
Epoch: 4 cost time: 1.3317656517028809
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3729260 Best vali loss: 0.3729260
Updating learning rate to 4.3837700525e-05
Epoch: 5 cost time: 1.0186774730682373
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3762171 Best vali loss: 0.3729260
Updating learning rate to 2.19188502625e-05
Epoch: 6 cost time: 1.0145361423492432
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3745233 Best vali loss: 0.3729260
Updating learning rate to 1.095942513125e-05
Epoch: 7 cost time: 1.0217647552490234
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3760072 Best vali loss: 0.3729260
Updating learning rate to 5.479712565625e-06
Epoch: 8 cost time: 1.0136542320251465
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3770854 Best vali loss: 0.3729260

best validation loss 0.37292602288231164

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0107786373321, 'e_layers': 4, 'learning_rate': 0.0007051049927, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007051049927
Validation loss decreased (inf --> 0.3863).  Saving model state dict ...
Epoch: 1 cost time: 1.3254342079162598
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3863157 Best vali loss: 0.3863157
Updating learning rate to 0.00035255249635
Epoch: 2 cost time: 1.0270805358886719
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3902980 Best vali loss: 0.3863157
Updating learning rate to 0.000176276248175
Validation loss decreased (0.3863 --> 0.3828).  Saving model state dict ...
Epoch: 3 cost time: 1.026850700378418
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3828411 Best vali loss: 0.3828411
Updating learning rate to 8.81381240875e-05
Validation loss decreased (0.3828 --> 0.3782).  Saving model state dict ...
Epoch: 4 cost time: 1.0336298942565918
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3782269 Best vali loss: 0.3782269
Updating learning rate to 4.406906204375e-05
Epoch: 5 cost time: 1.0316064357757568
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3791080 Best vali loss: 0.3782269
Updating learning rate to 2.2034531021875e-05
Epoch: 6 cost time: 1.0321545600891113
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3801047 Best vali loss: 0.3782269
Updating learning rate to 1.10172655109375e-05
Epoch: 7 cost time: 1.0315184593200684
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3803385 Best vali loss: 0.3782269
Updating learning rate to 5.50863275546875e-06
Epoch: 8 cost time: 1.0296454429626465
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3796500 Best vali loss: 0.3782269

best validation loss 0.37822685963044234

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4509804
	speed: 0.0117s/iter; left time: 22.8144s
	iters: 200, epoch: 1 | loss: 0.8178029
	speed: 0.0055s/iter; left time: 10.2048s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 1.7606849670410156
Epoch: 1, Steps: 257 | Train Loss: 0.6343917 Vali Loss: 0.3747568 Best vali loss: 0.3747568
	iters: 100, epoch: 2 | loss: 0.4803226
	speed: 0.0106s/iter; left time: 18.0605s
	iters: 200, epoch: 2 | loss: 0.5963035
	speed: 0.0050s/iter; left time: 8.0212s
Updating learning rate to 0.0004603128331928716
Validation loss decreased (0.3748 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 1.2978053092956543
Epoch: 2, Steps: 257 | Train Loss: 0.5383131 Vali Loss: 0.3682616 Best vali loss: 0.3682616
	iters: 100, epoch: 3 | loss: 0.5335751
	speed: 0.0102s/iter; left time: 14.7375s
	iters: 200, epoch: 3 | loss: 0.6315259
	speed: 0.0050s/iter; left time: 6.6841s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 1.3069548606872559
Epoch: 3, Steps: 257 | Train Loss: 0.5825505 Vali Loss: 0.3686457 Best vali loss: 0.3682616
	iters: 100, epoch: 4 | loss: 0.5239743
	speed: 0.0111s/iter; left time: 13.1306s
	iters: 200, epoch: 4 | loss: 0.9038643
	speed: 0.0054s/iter; left time: 5.9125s
Updating learning rate to 0.00026964501475
Epoch: 4 cost time: 1.4604473114013672
Epoch: 4, Steps: 257 | Train Loss: 0.7139193 Vali Loss: 0.3743120 Best vali loss: 0.3682616
	iters: 100, epoch: 5 | loss: 0.5578666
	speed: 0.0108s/iter; left time: 10.0532s
	iters: 200, epoch: 5 | loss: 0.5135294
	speed: 0.0047s/iter; left time: 3.9277s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 1.276197910308838
Epoch: 5, Steps: 257 | Train Loss: 0.5356980 Vali Loss: 0.3801966 Best vali loss: 0.3682616
	iters: 100, epoch: 6 | loss: 0.3642216
	speed: 0.0109s/iter; left time: 7.2990s
	iters: 200, epoch: 6 | loss: 0.3879181
	speed: 0.0053s/iter; left time: 3.0522s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 1.4201934337615967
Epoch: 6, Steps: 257 | Train Loss: 0.3760699 Vali Loss: 0.3880189 Best vali loss: 0.3682616
	iters: 100, epoch: 7 | loss: 0.3444994
	speed: 0.0105s/iter; left time: 4.3430s
	iters: 200, epoch: 7 | loss: 0.3333690
	speed: 0.0049s/iter; left time: 1.5405s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 1.3046507835388184
Epoch: 7, Steps: 257 | Train Loss: 0.3389342 Vali Loss: 0.3826846 Best vali loss: 0.3682616
	iters: 100, epoch: 8 | loss: 0.4460739
	speed: 0.0101s/iter; left time: 1.5926s
	iters: 200, epoch: 8 | loss: 0.4876153
	speed: 0.0048s/iter; left time: 0.2787s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2582273483276367
Epoch: 8, Steps: 257 | Train Loss: 0.4668446 Vali Loss: 0.3852887 Best vali loss: 0.3682616

best validation loss 0.368261592701985

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0110708314989, 'e_layers': 4, 'learning_rate': 0.0006832173289, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006832173289
Validation loss decreased (inf --> 0.3853).  Saving model state dict ...
Epoch: 1 cost time: 1.3391194343566895
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3853213 Best vali loss: 0.3853213
Updating learning rate to 0.00034160866445
Epoch: 2 cost time: 1.025075912475586
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3871441 Best vali loss: 0.3853213
Updating learning rate to 0.000170804332225
Validation loss decreased (0.3853 --> 0.3836).  Saving model state dict ...
Epoch: 3 cost time: 1.0195751190185547
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3835894 Best vali loss: 0.3835894

best validation loss 0.3835893951253947

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0106126080595, 'e_layers': 4, 'learning_rate': 0.0006769477032, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006769477032
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 1.327209234237671
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3818204 Best vali loss: 0.3818204
Updating learning rate to 0.0003384738516
Epoch: 2 cost time: 1.0288829803466797
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3842441 Best vali loss: 0.3818204
Updating learning rate to 0.0001692369258
Validation loss decreased (0.3818 --> 0.3698).  Saving model state dict ...
Epoch: 3 cost time: 1.0221967697143555
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3697668 Best vali loss: 0.3697668

best validation loss 0.3697668366207355

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6179181
	speed: 0.0101s/iter; left time: 9.4558s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.3843).  Saving model state dict ...
Epoch: 1 cost time: 0.8740301132202148
Epoch: 1, Steps: 129 | Train Loss: 0.6179181 Vali Loss: 0.3842927 Best vali loss: 0.3842927
	iters: 100, epoch: 2 | loss: 0.6295852
	speed: 0.0075s/iter; left time: 6.0004s
Updating learning rate to 0.0013289867186133768
Validation loss decreased (0.3843 --> 0.3751).  Saving model state dict ...
Epoch: 2 cost time: 0.5895452499389648
Epoch: 2, Steps: 129 | Train Loss: 0.6295852 Vali Loss: 0.3750864 Best vali loss: 0.3750864
	iters: 100, epoch: 3 | loss: 0.5164949
	speed: 0.0072s/iter; left time: 4.8455s
Updating learning rate to 0.0010764223643835189
Epoch: 3 cost time: 0.5400733947753906
Epoch: 3, Steps: 129 | Train Loss: 0.5164949 Vali Loss: 0.3776638 Best vali loss: 0.3750864

best validation loss 0.3750864107271543

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0106126080595, 'e_layers': 4, 'learning_rate': 0.0006769477032, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.46184629e-05
Validation loss decreased (0.3698 --> 0.3654).  Saving model state dict ...
Epoch: 4 cost time: 1.3484125137329102
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3654174 Best vali loss: 0.3654174
Updating learning rate to 4.230923145e-05
Validation loss decreased (0.3654 --> 0.3612).  Saving model state dict ...
Epoch: 5 cost time: 1.0358881950378418
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3611970 Best vali loss: 0.3611970
Updating learning rate to 2.1154615725e-05
Epoch: 6 cost time: 1.033118486404419
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3628378 Best vali loss: 0.3611970
Updating learning rate to 1.05773078625e-05
Epoch: 7 cost time: 1.0279722213745117
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3620138 Best vali loss: 0.3611970
Updating learning rate to 5.28865393125e-06
Validation loss decreased (0.3612 --> 0.3598).  Saving model state dict ...
Epoch: 8 cost time: 1.0313818454742432
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3597747 Best vali loss: 0.3597747

best validation loss 0.359774715246995

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 0.7603628635406494
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3654836 Best vali loss: 0.3654836
Updating learning rate to 0.0009137180420535848
Epoch: 2 cost time: 0.4760770797729492
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3727874 Best vali loss: 0.3654836
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 0.4725782871246338
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3689738 Best vali loss: 0.3654836
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 0.4572408199310303
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3664886 Best vali loss: 0.3654836
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.46433019638061523
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3707646 Best vali loss: 0.3654836
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 0.4698178768157959
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3828157 Best vali loss: 0.3654836
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 0.4656407833099365
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3705473 Best vali loss: 0.3654836
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4454793930053711
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3778483 Best vali loss: 0.3654836

best validation loss 0.36548357334258746

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.000846652862, 'e_layers': 4, 'learning_rate': 0.0007565924269, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007277963422829759
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.8305034637451172
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708526 Best vali loss: 0.3708526
Updating learning rate to 0.0006457920312776886
Validation loss decreased (0.3709 --> 0.3656).  Saving model state dict ...
Epoch: 2 cost time: 0.5254745483398438
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3655701 Best vali loss: 0.3655701
Updating learning rate to 0.0005230639068637626
Epoch: 3 cost time: 0.5218479633331299
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3883751 Best vali loss: 0.3655701
Updating learning rate to 0.00037829621345
Validation loss decreased (0.3656 --> 0.3637).  Saving model state dict ...
Epoch: 4 cost time: 0.5136420726776123
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3636586 Best vali loss: 0.3636586
Updating learning rate to 0.00023352852003623737
Epoch: 5 cost time: 0.5257296562194824
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3650424 Best vali loss: 0.3636586
Updating learning rate to 0.0001108003956223114
Validation loss decreased (0.3637 --> 0.3566).  Saving model state dict ...
Epoch: 6 cost time: 0.5144851207733154
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3566356 Best vali loss: 0.3566356
Updating learning rate to 2.8796084617024057e-05
Validation loss decreased (0.3566 --> 0.3559).  Saving model state dict ...
Epoch: 7 cost time: 0.5002436637878418
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3559030 Best vali loss: 0.3559030
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5099084377288818
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3586105 Best vali loss: 0.3559030

best validation loss 0.35590300608009157

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009206480409, 'e_layers': 4, 'learning_rate': 0.0007536042954, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007249219397663248
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 0.8243923187255859
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712594 Best vali loss: 0.3712594
Updating learning rate to 0.0006432415015043251
Validation loss decreased (0.3713 --> 0.3661).  Saving model state dict ...
Epoch: 2 cost time: 0.5249900817871094
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3661094 Best vali loss: 0.3661094
Updating learning rate to 0.0005209980869043735
Epoch: 3 cost time: 0.5024721622467041
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3877108 Best vali loss: 0.3661094

best validation loss 0.36610943568478865

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009427154662, 'e_layers': 2, 'learning_rate': 0.0007515176007, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6206777
	speed: 0.0104s/iter; left time: 9.7096s
Updating learning rate to 0.0007515176007
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 0.8723652362823486
Epoch: 1, Steps: 129 | Train Loss: 0.6206777 Vali Loss: 0.3690130 Best vali loss: 0.3690130
	iters: 100, epoch: 2 | loss: 0.6800449
	speed: 0.0069s/iter; left time: 5.5299s
Updating learning rate to 0.00037575880035
Epoch: 2 cost time: 0.5324647426605225
Epoch: 2, Steps: 129 | Train Loss: 0.6800449 Vali Loss: 0.3757333 Best vali loss: 0.3690130
	iters: 100, epoch: 3 | loss: 0.5842926
	speed: 0.0066s/iter; left time: 4.4676s
Updating learning rate to 0.000187879400175
Epoch: 3 cost time: 0.5219216346740723
Epoch: 3, Steps: 129 | Train Loss: 0.5842926 Vali Loss: 0.3713760 Best vali loss: 0.3690130

best validation loss 0.3690129974736212

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009827598006, 'e_layers': 4, 'learning_rate': 0.0007475113221, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007475113221
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.807978630065918
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708937 Best vali loss: 0.3708937
Updating learning rate to 0.00037375566105
Validation loss decreased (0.3709 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 0.508350133895874
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3666261 Best vali loss: 0.3666261
Updating learning rate to 0.000186877830525
Epoch: 3 cost time: 0.5194010734558105
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3718395 Best vali loss: 0.3666261

best validation loss 0.3666260901977599

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009206480409, 'e_layers': 4, 'learning_rate': 0.0007536042954, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0003768021477
Validation loss decreased (0.3661 --> 0.3537).  Saving model state dict ...
Epoch: 4 cost time: 0.806079626083374
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3537113 Best vali loss: 0.3537113
Updating learning rate to 0.0002326062084956265
Validation loss decreased (0.3537 --> 0.3497).  Saving model state dict ...
Epoch: 5 cost time: 0.5098464488983154
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3497216 Best vali loss: 0.3497216
Updating learning rate to 0.00011036279389567496
Epoch: 6 cost time: 0.5194106101989746
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3504583 Best vali loss: 0.3497216
Updating learning rate to 2.8682355633675182e-05
Epoch: 7 cost time: 0.513615608215332
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3522993 Best vali loss: 0.3497216
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5082066059112549
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3518290 Best vali loss: 0.3497216

best validation loss 0.34972164464605815

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0008010763089, 'e_layers': 4, 'learning_rate': 0.0006864190636, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006602937935928017
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.1414024829864502
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3688130 Best vali loss: 0.3688130
Updating learning rate to 0.00058589531910364
Validation loss decreased (0.3688 --> 0.3678).  Saving model state dict ...
Epoch: 2 cost time: 0.8223493099212646
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3678275 Best vali loss: 0.3678275
Updating learning rate to 0.0004745501334496395
Validation loss decreased (0.3678 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 0.8297929763793945
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3677047 Best vali loss: 0.3677047
Updating learning rate to 0.0003432095318
Validation loss decreased (0.3677 --> 0.3615).  Saving model state dict ...
Epoch: 4 cost time: 0.822758674621582
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3615491 Best vali loss: 0.3615491
Updating learning rate to 0.00021186893015036058
Validation loss decreased (0.3615 --> 0.3560).  Saving model state dict ...
Epoch: 5 cost time: 0.8221533298492432
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3559996 Best vali loss: 0.3559996
Updating learning rate to 0.00010052374449636
Epoch: 6 cost time: 0.8167390823364258
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3654399 Best vali loss: 0.3559996
Updating learning rate to 2.61252700071984e-05
Epoch: 7 cost time: 0.8206639289855957
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3564440 Best vali loss: 0.3559996
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8283023834228516
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3604711 Best vali loss: 0.3559996

best validation loss 0.3559996083700821

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009955926504, 'e_layers': 4, 'learning_rate': 0.0006797688954, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006538967323489329
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 0.8195798397064209
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712154 Best vali loss: 0.3712154
Updating learning rate to 0.0005802190454885144
Validation loss decreased (0.3712 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.517329216003418
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3650378 Best vali loss: 0.3650378
Updating learning rate to 0.0004699525947533489
Epoch: 3 cost time: 0.5097301006317139
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3906477 Best vali loss: 0.3650378
Updating learning rate to 0.0003398844477
Validation loss decreased (0.3650 --> 0.3538).  Saving model state dict ...
Epoch: 4 cost time: 0.5133850574493408
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3538284 Best vali loss: 0.3538284
Updating learning rate to 0.00020981630064665117
Epoch: 5 cost time: 0.5094137191772461
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3613177 Best vali loss: 0.3538284
Updating learning rate to 9.954984991148557e-05
Validation loss decreased (0.3538 --> 0.3517).  Saving model state dict ...
Epoch: 6 cost time: 0.5139429569244385
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3516706 Best vali loss: 0.3516706
Updating learning rate to 2.5872163051067113e-05
Validation loss decreased (0.3517 --> 0.3481).  Saving model state dict ...
Epoch: 7 cost time: 0.5171701908111572
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3481443 Best vali loss: 0.3481443
Updating learning rate to 0.0
Epoch: 8 cost time: 0.52634596824646
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3517998 Best vali loss: 0.3481443

best validation loss 0.348144299084639

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0093597626134, 'e_layers': 4, 'learning_rate': 0.0008361423596, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008361423596
Validation loss decreased (inf --> 0.3736).  Saving model state dict ...
Epoch: 1 cost time: 1.1034722328186035
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3736387 Best vali loss: 0.3736387
Updating learning rate to 0.0004180711798
Epoch: 2 cost time: 0.7875766754150391
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3815304 Best vali loss: 0.3736387
Updating learning rate to 0.0002090355899
Validation loss decreased (0.3736 --> 0.3718).  Saving model state dict ...
Epoch: 3 cost time: 0.786017656326294
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3717663 Best vali loss: 0.3717663

best validation loss 0.3717662883413798

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0093706692616, 'e_layers': 4, 'learning_rate': 0.0007918923287, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0265898
	speed: 0.0114s/iter; left time: 45.6777s
	iters: 200, epoch: 1 | loss: 0.6808882
	speed: 0.0053s/iter; left time: 20.8545s
	iters: 300, epoch: 1 | loss: 0.7984793
	speed: 0.0051s/iter; left time: 19.5117s
	iters: 400, epoch: 1 | loss: 0.7444893
	speed: 0.0053s/iter; left time: 19.5797s
	iters: 500, epoch: 1 | loss: 0.4967248
	speed: 0.0052s/iter; left time: 18.6776s
Updating learning rate to 0.0007918923287
Validation loss decreased (inf --> 0.4119).  Saving model state dict ...
Epoch: 1 cost time: 3.0306649208068848
Epoch: 1, Steps: 514 | Train Loss: 0.7494342 Vali Loss: 0.4119481 Best vali loss: 0.4119481
	iters: 100, epoch: 2 | loss: 0.5962463
	speed: 0.0106s/iter; left time: 37.0570s
	iters: 200, epoch: 2 | loss: 0.4464726
	speed: 0.0052s/iter; left time: 17.7659s
	iters: 300, epoch: 2 | loss: 0.3391424
	speed: 0.0051s/iter; left time: 16.7771s
	iters: 400, epoch: 2 | loss: 0.9146178
	speed: 0.0050s/iter; left time: 16.0655s
	iters: 500, epoch: 2 | loss: 1.1782507
	speed: 0.0052s/iter; left time: 16.1661s
Updating learning rate to 0.00039594616435
Validation loss decreased (0.4119 --> 0.4029).  Saving model state dict ...
Epoch: 2 cost time: 2.694485664367676
Epoch: 2, Steps: 514 | Train Loss: 0.6949460 Vali Loss: 0.4028621 Best vali loss: 0.4028621
	iters: 100, epoch: 3 | loss: 0.8412060
	speed: 0.0107s/iter; left time: 31.9325s
	iters: 200, epoch: 3 | loss: 0.8115320
	speed: 0.0049s/iter; left time: 14.2102s
	iters: 300, epoch: 3 | loss: 0.3730477
	speed: 0.0049s/iter; left time: 13.6444s
	iters: 400, epoch: 3 | loss: 0.7897505
	speed: 0.0050s/iter; left time: 13.3310s
	iters: 500, epoch: 3 | loss: 0.9394288
	speed: 0.0049s/iter; left time: 12.7744s
Updating learning rate to 0.000197973082175
Validation loss decreased (0.4029 --> 0.4005).  Saving model state dict ...
Epoch: 3 cost time: 2.5860648155212402
Epoch: 3, Steps: 514 | Train Loss: 0.7509930 Vali Loss: 0.4004535 Best vali loss: 0.4004535

best validation loss 0.40045349246626516

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002350781573, 'e_layers': 4, 'learning_rate': 0.0007047731548, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007047731548
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.104243516921997
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713488 Best vali loss: 0.3713488
Updating learning rate to 0.0003523865774
Validation loss decreased (0.3713 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 0.7824149131774902
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3690985 Best vali loss: 0.3690985
Updating learning rate to 0.0001761932887
Validation loss decreased (0.3691 --> 0.3622).  Saving model state dict ...
Epoch: 3 cost time: 0.7826781272888184
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3622216 Best vali loss: 0.3622216

best validation loss 0.36222160145903853

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002350781573, 'e_layers': 4, 'learning_rate': 0.0007047731548, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.809664435e-05
Validation loss decreased (0.3622 --> 0.3558).  Saving model state dict ...
Epoch: 4 cost time: 1.1038594245910645
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3557794 Best vali loss: 0.3557794
Updating learning rate to 4.4048322175e-05
Validation loss decreased (0.3558 --> 0.3527).  Saving model state dict ...
Epoch: 5 cost time: 0.7813887596130371
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3526924 Best vali loss: 0.3526924
Updating learning rate to 2.20241610875e-05
Validation loss decreased (0.3527 --> 0.3521).  Saving model state dict ...
Epoch: 6 cost time: 0.7850580215454102
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3521094 Best vali loss: 0.3521094
Updating learning rate to 1.101208054375e-05
Validation loss decreased (0.3521 --> 0.3506).  Saving model state dict ...
Epoch: 7 cost time: 0.786435604095459
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3506039 Best vali loss: 0.3506039
Updating learning rate to 5.506040271875e-06
Epoch: 8 cost time: 0.7800226211547852
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3510677 Best vali loss: 0.3506039

best validation loss 0.3506038529465381

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019331455343, 'e_layers': 4, 'learning_rate': 0.0007012788476, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007012788476
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.11002516746521
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708880 Best vali loss: 0.3708880
Updating learning rate to 0.0003506394238
Validation loss decreased (0.3709 --> 0.3572).  Saving model state dict ...
Epoch: 2 cost time: 0.7884523868560791
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3572376 Best vali loss: 0.3572376
Updating learning rate to 0.0001753197119
Validation loss decreased (0.3572 --> 0.3534).  Saving model state dict ...
Epoch: 3 cost time: 0.7849633693695068
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3534213 Best vali loss: 0.3534213
Updating learning rate to 8.765985595e-05
Validation loss decreased (0.3534 --> 0.3432).  Saving model state dict ...
Epoch: 4 cost time: 0.7839279174804688
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3432297 Best vali loss: 0.3432297
Updating learning rate to 4.3829927975e-05
Validation loss decreased (0.3432 --> 0.3431).  Saving model state dict ...
Epoch: 5 cost time: 0.7870423793792725
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3431282 Best vali loss: 0.3431282
Updating learning rate to 2.19149639875e-05
Validation loss decreased (0.3431 --> 0.3408).  Saving model state dict ...
Epoch: 6 cost time: 0.7806484699249268
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3407868 Best vali loss: 0.3407868
Updating learning rate to 1.095748199375e-05
Validation loss decreased (0.3408 --> 0.3402).  Saving model state dict ...
Epoch: 7 cost time: 0.7794229984283447
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3402370 Best vali loss: 0.3402370
Updating learning rate to 5.478740996875e-06
Validation loss decreased (0.3402 --> 0.3401).  Saving model state dict ...
Epoch: 8 cost time: 0.7857718467712402
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3401199 Best vali loss: 0.3401199

best validation loss 0.34011992068562386

[INFO][abstract_intensifier.py:595] Added config 3982a0 and rejected config 508807 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022121251808, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.1144521236419678
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710461 Best vali loss: 0.3710461
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.7836568355560303
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3784693 Best vali loss: 0.3710461
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3710 --> 0.3537).  Saving model state dict ...
Epoch: 3 cost time: 0.7807326316833496
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3536608 Best vali loss: 0.3536608
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3537 --> 0.3422).  Saving model state dict ...
Epoch: 4 cost time: 0.7866497039794922
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3421969 Best vali loss: 0.3421969
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7776780128479004
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3431200 Best vali loss: 0.3421969
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3422 --> 0.3417).  Saving model state dict ...
Epoch: 6 cost time: 0.790278434753418
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3416801 Best vali loss: 0.3416801
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3417 --> 0.3407).  Saving model state dict ...
Epoch: 7 cost time: 0.7854468822479248
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3407146 Best vali loss: 0.3407146
Updating learning rate to 5.52363443828125e-06
Validation loss decreased (0.3407 --> 0.3401).  Saving model state dict ...
Epoch: 8 cost time: 0.7870416641235352
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3401378 Best vali loss: 0.3401378

best validation loss 0.34013777115256005

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023731897627, 'e_layers': 4, 'learning_rate': 0.0007061473825, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007061473825
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.0985233783721924
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714660 Best vali loss: 0.3714660
Updating learning rate to 0.00035307369125
Validation loss decreased (0.3715 --> 0.3700).  Saving model state dict ...
Epoch: 2 cost time: 0.7804911136627197
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3700327 Best vali loss: 0.3700327
Updating learning rate to 0.000176536845625
Validation loss decreased (0.3700 --> 0.3585).  Saving model state dict ...
Epoch: 3 cost time: 0.7809841632843018
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3585444 Best vali loss: 0.3585444

best validation loss 0.3585443838991679

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 2.4648263
	speed: 0.0101s/iter; left time: 81.8784s
	iters: 200, epoch: 1 | loss: 0.2655614
	speed: 0.0041s/iter; left time: 32.9683s
	iters: 300, epoch: 1 | loss: 0.2735536
	speed: 0.0041s/iter; left time: 32.8375s
	iters: 400, epoch: 1 | loss: 0.2313503
	speed: 0.0041s/iter; left time: 32.1170s
	iters: 500, epoch: 1 | loss: 0.5476995
	speed: 0.0041s/iter; left time: 31.8575s
	iters: 600, epoch: 1 | loss: 0.6698667
	speed: 0.0041s/iter; left time: 31.3086s
	iters: 700, epoch: 1 | loss: 1.6055570
	speed: 0.0041s/iter; left time: 30.5752s
	iters: 800, epoch: 1 | loss: 0.3446052
	speed: 0.0041s/iter; left time: 30.3529s
	iters: 900, epoch: 1 | loss: 0.3624881
	speed: 0.0040s/iter; left time: 29.6096s
	iters: 1000, epoch: 1 | loss: 0.8927222
	speed: 0.0040s/iter; left time: 28.5414s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 4.527399301528931
Epoch: 1, Steps: 1027 | Train Loss: 0.7658230 Vali Loss: 0.3683376 Best vali loss: 0.3683376
	iters: 100, epoch: 2 | loss: 0.9052638
	speed: 0.0106s/iter; left time: 75.3361s
	iters: 200, epoch: 2 | loss: 1.3970069
	speed: 0.0038s/iter; left time: 26.5715s
	iters: 300, epoch: 2 | loss: 0.4819513
	speed: 0.0037s/iter; left time: 25.6998s
	iters: 400, epoch: 2 | loss: 0.5943895
	speed: 0.0037s/iter; left time: 25.0041s
	iters: 500, epoch: 2 | loss: 0.7530330
	speed: 0.0036s/iter; left time: 23.9235s
	iters: 600, epoch: 2 | loss: 0.5526275
	speed: 0.0038s/iter; left time: 24.7275s
	iters: 700, epoch: 2 | loss: 1.7132534
	speed: 0.0037s/iter; left time: 24.2965s
	iters: 800, epoch: 2 | loss: 0.2953705
	speed: 0.0037s/iter; left time: 23.5785s
	iters: 900, epoch: 2 | loss: 0.4864575
	speed: 0.0038s/iter; left time: 23.7662s
	iters: 1000, epoch: 2 | loss: 0.4719875
	speed: 0.0039s/iter; left time: 24.2477s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.3683 --> 0.3644).  Saving model state dict ...
Epoch: 2 cost time: 3.8868861198425293
Epoch: 2, Steps: 1027 | Train Loss: 0.7651341 Vali Loss: 0.3643841 Best vali loss: 0.3643841
	iters: 100, epoch: 3 | loss: 0.6965716
	speed: 0.0108s/iter; left time: 65.2375s
	iters: 200, epoch: 3 | loss: 1.0189538
	speed: 0.0039s/iter; left time: 23.3071s
	iters: 300, epoch: 3 | loss: 0.4356684
	speed: 0.0039s/iter; left time: 23.0509s
	iters: 400, epoch: 3 | loss: 0.4615722
	speed: 0.0040s/iter; left time: 22.7647s
	iters: 500, epoch: 3 | loss: 0.9165179
	speed: 0.0039s/iter; left time: 22.0740s
	iters: 600, epoch: 3 | loss: 0.3492435
	speed: 0.0039s/iter; left time: 21.6804s
	iters: 700, epoch: 3 | loss: 0.6812825
	speed: 0.0040s/iter; left time: 21.9607s
	iters: 800, epoch: 3 | loss: 0.3018096
	speed: 0.0041s/iter; left time: 21.7367s
	iters: 900, epoch: 3 | loss: 0.2492532
	speed: 0.0040s/iter; left time: 21.0673s
	iters: 1000, epoch: 3 | loss: 0.6420166
	speed: 0.0041s/iter; left time: 21.0509s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 4.098796606063843
Epoch: 3, Steps: 1027 | Train Loss: 0.5752889 Vali Loss: 0.3701638 Best vali loss: 0.3643841

best validation loss 0.36438405129670626

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021485248787, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007062511586
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.102508783340454
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713688 Best vali loss: 0.3713688
Updating learning rate to 0.0003531255793
Validation loss decreased (0.3714 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 0.7828998565673828
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3623094 Best vali loss: 0.3623094
Updating learning rate to 0.00017656278965
Validation loss decreased (0.3623 --> 0.3536).  Saving model state dict ...
Epoch: 3 cost time: 0.7853491306304932
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3535708 Best vali loss: 0.3535708

best validation loss 0.3535707877637829

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021485248787, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8281394825e-05
Validation loss decreased (0.3536 --> 0.3525).  Saving model state dict ...
Epoch: 4 cost time: 1.0939106941223145
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3524578 Best vali loss: 0.3524578
Updating learning rate to 4.41406974125e-05
Validation loss decreased (0.3525 --> 0.3475).  Saving model state dict ...
Epoch: 5 cost time: 0.7816779613494873
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3474535 Best vali loss: 0.3474535
Updating learning rate to 2.207034870625e-05
Validation loss decreased (0.3475 --> 0.3422).  Saving model state dict ...
Epoch: 6 cost time: 0.7871525287628174
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3422108 Best vali loss: 0.3422108
Updating learning rate to 1.1035174353125e-05
Validation loss decreased (0.3422 --> 0.3410).  Saving model state dict ...
Epoch: 7 cost time: 0.7763149738311768
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3410107 Best vali loss: 0.3410107
Updating learning rate to 5.5175871765625e-06
Epoch: 8 cost time: 0.7794063091278076
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3414592 Best vali loss: 0.3410107

best validation loss 0.34101065352764015

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020092686128, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5717143
	speed: 0.0118s/iter; left time: 23.0222s
	iters: 200, epoch: 1 | loss: 0.6697145
	speed: 0.0057s/iter; left time: 10.5353s
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3977).  Saving model state dict ...
Epoch: 1 cost time: 1.807997465133667
Epoch: 1, Steps: 257 | Train Loss: 0.6207144 Vali Loss: 0.3977290 Best vali loss: 0.3977290
	iters: 100, epoch: 2 | loss: 0.9724742
	speed: 0.0120s/iter; left time: 20.3214s
	iters: 200, epoch: 2 | loss: 0.5973741
	speed: 0.0054s/iter; left time: 8.6392s
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 1.4486656188964844
Epoch: 2, Steps: 257 | Train Loss: 0.7849241 Vali Loss: 0.4076576 Best vali loss: 0.3977290
	iters: 100, epoch: 3 | loss: 0.5817814
	speed: 0.0114s/iter; left time: 16.5075s
	iters: 200, epoch: 3 | loss: 0.8542975
	speed: 0.0052s/iter; left time: 7.0341s
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 1.4018912315368652
Epoch: 3, Steps: 257 | Train Loss: 0.7180395 Vali Loss: 0.4078639 Best vali loss: 0.3977290
	iters: 100, epoch: 4 | loss: 0.8902355
	speed: 0.0116s/iter; left time: 13.7889s
	iters: 200, epoch: 4 | loss: 0.4615018
	speed: 0.0057s/iter; left time: 6.1476s
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 1.512648582458496
Epoch: 4, Steps: 257 | Train Loss: 0.6758687 Vali Loss: 0.4079577 Best vali loss: 0.3977290
	iters: 100, epoch: 5 | loss: 0.7955211
	speed: 0.0120s/iter; left time: 11.1569s
	iters: 200, epoch: 5 | loss: 0.6904029
	speed: 0.0057s/iter; left time: 4.7505s
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 1.510725736618042
Epoch: 5, Steps: 257 | Train Loss: 0.7429620 Vali Loss: 0.4054427 Best vali loss: 0.3977290
	iters: 100, epoch: 6 | loss: 0.6803546
	speed: 0.0118s/iter; left time: 7.9349s
	iters: 200, epoch: 6 | loss: 0.6160512
	speed: 0.0054s/iter; left time: 3.1028s
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 1.4521257877349854
Epoch: 6, Steps: 257 | Train Loss: 0.6482029 Vali Loss: 0.4027161 Best vali loss: 0.3977290
	iters: 100, epoch: 7 | loss: 0.9436855
	speed: 0.0117s/iter; left time: 4.8350s
	iters: 200, epoch: 7 | loss: 0.7863206
	speed: 0.0054s/iter; left time: 1.6935s
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 1.4263100624084473
Epoch: 7, Steps: 257 | Train Loss: 0.8650030 Vali Loss: 0.4037364 Best vali loss: 0.3977290
	iters: 100, epoch: 8 | loss: 0.5760908
	speed: 0.0119s/iter; left time: 1.8808s
	iters: 200, epoch: 8 | loss: 0.4341536
	speed: 0.0057s/iter; left time: 0.3304s
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 1.5154006481170654
Epoch: 8, Steps: 257 | Train Loss: 0.5051222 Vali Loss: 0.4037900 Best vali loss: 0.3977290

best validation loss 0.39772902606512567

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019922800676, 'e_layers': 4, 'learning_rate': 0.0007102367953, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3591886
	speed: 0.0112s/iter; left time: 21.9061s
	iters: 200, epoch: 1 | loss: 0.5866564
	speed: 0.0051s/iter; left time: 9.5108s
Updating learning rate to 0.0007102367953
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.6631975173950195
Epoch: 1, Steps: 257 | Train Loss: 0.4729225 Vali Loss: 0.3695879 Best vali loss: 0.3695879
	iters: 100, epoch: 2 | loss: 0.7901434
	speed: 0.0110s/iter; left time: 18.6678s
	iters: 200, epoch: 2 | loss: 0.6076757
	speed: 0.0053s/iter; left time: 8.5356s
Updating learning rate to 0.00035511839765
Epoch: 2 cost time: 1.422656774520874
Epoch: 2, Steps: 257 | Train Loss: 0.6989096 Vali Loss: 0.3833208 Best vali loss: 0.3695879
	iters: 100, epoch: 3 | loss: 0.7464182
	speed: 0.0108s/iter; left time: 15.5661s
	iters: 200, epoch: 3 | loss: 0.6320998
	speed: 0.0049s/iter; left time: 6.6284s
Updating learning rate to 0.000177559198825
Epoch: 3 cost time: 1.3294436931610107
Epoch: 3, Steps: 257 | Train Loss: 0.6892590 Vali Loss: 0.3703310 Best vali loss: 0.3695879
	iters: 100, epoch: 4 | loss: 0.5810138
	speed: 0.0108s/iter; left time: 12.7610s
	iters: 200, epoch: 4 | loss: 0.5469012
	speed: 0.0049s/iter; left time: 5.2850s
Updating learning rate to 8.87795994125e-05
Epoch: 4 cost time: 1.3405919075012207
Epoch: 4, Steps: 257 | Train Loss: 0.5639575 Vali Loss: 0.3770157 Best vali loss: 0.3695879
	iters: 100, epoch: 5 | loss: 0.3162922
	speed: 0.0109s/iter; left time: 10.0887s
	iters: 200, epoch: 5 | loss: 0.3537962
	speed: 0.0053s/iter; left time: 4.4279s
Updating learning rate to 4.438979970625e-05
Epoch: 5 cost time: 1.4126160144805908
Epoch: 5, Steps: 257 | Train Loss: 0.3350442 Vali Loss: 0.3805114 Best vali loss: 0.3695879
	iters: 100, epoch: 6 | loss: 0.4944412
	speed: 0.0112s/iter; left time: 7.5450s
	iters: 200, epoch: 6 | loss: 0.5812477
	speed: 0.0056s/iter; left time: 3.1754s
Updating learning rate to 2.2194899853125e-05
Epoch: 6 cost time: 1.4719631671905518
Epoch: 6, Steps: 257 | Train Loss: 0.5378445 Vali Loss: 0.3871177 Best vali loss: 0.3695879
	iters: 100, epoch: 7 | loss: 0.4528198
	speed: 0.0113s/iter; left time: 4.6703s
	iters: 200, epoch: 7 | loss: 0.3419380
	speed: 0.0050s/iter; left time: 1.5866s
Updating learning rate to 1.10974499265625e-05
Epoch: 7 cost time: 1.3459880352020264
Epoch: 7, Steps: 257 | Train Loss: 0.3973789 Vali Loss: 0.3808125 Best vali loss: 0.3695879
	iters: 100, epoch: 8 | loss: 0.7470245
	speed: 0.0108s/iter; left time: 1.7087s
	iters: 200, epoch: 8 | loss: 0.4134412
	speed: 0.0052s/iter; left time: 0.3023s
Updating learning rate to 5.54872496328125e-06
Epoch: 8 cost time: 1.3890576362609863
Epoch: 8, Steps: 257 | Train Loss: 0.5802328 Vali Loss: 0.3855679 Best vali loss: 0.3695879

best validation loss 0.3695878881836687

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020051007071, 'e_layers': 4, 'learning_rate': 0.0007121246372, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3593887
	speed: 0.0116s/iter; left time: 22.7032s
	iters: 200, epoch: 1 | loss: 0.5834073
	speed: 0.0048s/iter; left time: 8.9977s
Updating learning rate to 0.0007121246372
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 1.6832811832427979
Epoch: 1, Steps: 257 | Train Loss: 0.4713980 Vali Loss: 0.3844862 Best vali loss: 0.3844862
	iters: 100, epoch: 2 | loss: 0.8174208
	speed: 0.0107s/iter; left time: 18.2242s
	iters: 200, epoch: 2 | loss: 0.6161733
	speed: 0.0053s/iter; left time: 8.5184s
Updating learning rate to 0.0003560623186
Validation loss decreased (0.3845 --> 0.3819).  Saving model state dict ...
Epoch: 2 cost time: 1.3879320621490479
Epoch: 2, Steps: 257 | Train Loss: 0.7167971 Vali Loss: 0.3818527 Best vali loss: 0.3818527
	iters: 100, epoch: 3 | loss: 0.7312766
	speed: 0.0113s/iter; left time: 16.3259s
	iters: 200, epoch: 3 | loss: 0.6931892
	speed: 0.0054s/iter; left time: 7.2371s
Updating learning rate to 0.0001780311593
Validation loss decreased (0.3819 --> 0.3678).  Saving model state dict ...
Epoch: 3 cost time: 1.4242613315582275
Epoch: 3, Steps: 257 | Train Loss: 0.7122329 Vali Loss: 0.3677845 Best vali loss: 0.3677845

best validation loss 0.3677844651555734

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019650557918, 'e_layers': 4, 'learning_rate': 0.0007102746486, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6203163
	speed: 0.0120s/iter; left time: 11.2262s
Updating learning rate to 0.0007102746486
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 1.1043667793273926
Epoch: 1, Steps: 129 | Train Loss: 0.6203163 Vali Loss: 0.3701847 Best vali loss: 0.3701847
	iters: 100, epoch: 2 | loss: 0.4823391
	speed: 0.0095s/iter; left time: 7.6100s
Updating learning rate to 0.0003551373243
Validation loss decreased (0.3702 --> 0.3592).  Saving model state dict ...
Epoch: 2 cost time: 0.7869431972503662
Epoch: 2, Steps: 129 | Train Loss: 0.4823391 Vali Loss: 0.3591902 Best vali loss: 0.3591902
	iters: 100, epoch: 3 | loss: 0.5568131
	speed: 0.0096s/iter; left time: 6.4656s
Updating learning rate to 0.00017756866215
Validation loss decreased (0.3592 --> 0.3476).  Saving model state dict ...
Epoch: 3 cost time: 0.7622687816619873
Epoch: 3, Steps: 129 | Train Loss: 0.5568131 Vali Loss: 0.3476045 Best vali loss: 0.3476045

best validation loss 0.34760445327093653

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019816689417, 'e_layers': 4, 'learning_rate': 0.0006852420883, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.6960889
	speed: 0.0115s/iter; left time: 93.5570s
	iters: 200, epoch: 1 | loss: 0.4024216
	speed: 0.0052s/iter; left time: 41.9807s
	iters: 300, epoch: 1 | loss: 0.4427511
	speed: 0.0052s/iter; left time: 41.5082s
	iters: 400, epoch: 1 | loss: 1.2207536
	speed: 0.0052s/iter; left time: 40.8977s
	iters: 500, epoch: 1 | loss: 0.5788551
	speed: 0.0051s/iter; left time: 39.6699s
	iters: 600, epoch: 1 | loss: 1.7224089
	speed: 0.0051s/iter; left time: 39.1754s
	iters: 700, epoch: 1 | loss: 1.0469990
	speed: 0.0051s/iter; left time: 38.3269s
	iters: 800, epoch: 1 | loss: 0.3214580
	speed: 0.0051s/iter; left time: 38.0110s
	iters: 900, epoch: 1 | loss: 0.2365571
	speed: 0.0051s/iter; left time: 37.0866s
	iters: 1000, epoch: 1 | loss: 0.4391268
	speed: 0.0052s/iter; left time: 37.3154s
Updating learning rate to 0.0006852420883
Validation loss decreased (inf --> 0.3969).  Saving model state dict ...
Epoch: 1 cost time: 5.6841676235198975
Epoch: 1, Steps: 1027 | Train Loss: 0.8107420 Vali Loss: 0.3969357 Best vali loss: 0.3969357
	iters: 100, epoch: 2 | loss: 0.4267798
	speed: 0.0140s/iter; left time: 99.3530s
	iters: 200, epoch: 2 | loss: 1.1185426
	speed: 0.0051s/iter; left time: 35.6565s
	iters: 300, epoch: 2 | loss: 0.5030612
	speed: 0.0052s/iter; left time: 35.6714s
	iters: 400, epoch: 2 | loss: 0.2485169
	speed: 0.0051s/iter; left time: 34.9122s
	iters: 500, epoch: 2 | loss: 1.6248908
	speed: 0.0052s/iter; left time: 34.7828s
	iters: 600, epoch: 2 | loss: 0.6720706
	speed: 0.0052s/iter; left time: 34.4805s
	iters: 700, epoch: 2 | loss: 0.3228609
	speed: 0.0052s/iter; left time: 33.7964s
	iters: 800, epoch: 2 | loss: 0.7170867
	speed: 0.0052s/iter; left time: 33.0622s
	iters: 900, epoch: 2 | loss: 0.9848390
	speed: 0.0051s/iter; left time: 32.3624s
	iters: 1000, epoch: 2 | loss: 0.9522526
	speed: 0.0052s/iter; left time: 32.1419s
Updating learning rate to 0.00034262104415
Epoch: 2 cost time: 5.372878789901733
Epoch: 2, Steps: 1027 | Train Loss: 0.7570901 Vali Loss: 0.4084775 Best vali loss: 0.3969357
	iters: 100, epoch: 3 | loss: 0.3080940
	speed: 0.0134s/iter; left time: 81.3834s
	iters: 200, epoch: 3 | loss: 0.3406861
	speed: 0.0052s/iter; left time: 31.0471s
	iters: 300, epoch: 3 | loss: 0.3780436
	speed: 0.0051s/iter; left time: 30.1898s
	iters: 400, epoch: 3 | loss: 0.3954417
	speed: 0.0052s/iter; left time: 29.9914s
	iters: 500, epoch: 3 | loss: 0.5265179
	speed: 0.0052s/iter; left time: 29.3331s
	iters: 600, epoch: 3 | loss: 0.3165914
	speed: 0.0052s/iter; left time: 28.8091s
	iters: 700, epoch: 3 | loss: 0.2880490
	speed: 0.0052s/iter; left time: 28.3394s
	iters: 800, epoch: 3 | loss: 1.0109298
	speed: 0.0052s/iter; left time: 27.7952s
	iters: 900, epoch: 3 | loss: 0.3058763
	speed: 0.0052s/iter; left time: 27.2724s
	iters: 1000, epoch: 3 | loss: 0.4106241
	speed: 0.0052s/iter; left time: 26.8532s
Updating learning rate to 0.000171310522075
Epoch: 3 cost time: 5.38289999961853
Epoch: 3, Steps: 1027 | Train Loss: 0.4280854 Vali Loss: 0.4087009 Best vali loss: 0.3969357

best validation loss 0.3969356500563781

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019650557918, 'e_layers': 4, 'learning_rate': 0.0007102746486, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5070702
	speed: 0.0133s/iter; left time: 7.2434s
Updating learning rate to 8.8784331075e-05
Validation loss decreased (0.3476 --> 0.3470).  Saving model state dict ...
Epoch: 4 cost time: 1.1529841423034668
Epoch: 4, Steps: 129 | Train Loss: 0.5070702 Vali Loss: 0.3470445 Best vali loss: 0.3470445
	iters: 100, epoch: 5 | loss: 0.3794034
	speed: 0.0102s/iter; left time: 4.2440s
Updating learning rate to 4.43921655375e-05
Epoch: 5 cost time: 0.8288066387176514
Epoch: 5, Steps: 129 | Train Loss: 0.3794034 Vali Loss: 0.3522804 Best vali loss: 0.3470445
	iters: 100, epoch: 6 | loss: 0.4852608
	speed: 0.0095s/iter; left time: 2.7281s
Updating learning rate to 2.219608276875e-05
Epoch: 6 cost time: 0.7432966232299805
Epoch: 6, Steps: 129 | Train Loss: 0.4852608 Vali Loss: 0.3494063 Best vali loss: 0.3470445
	iters: 100, epoch: 7 | loss: 0.4923867
	speed: 0.0098s/iter; left time: 1.5593s
Updating learning rate to 1.1098041384375e-05
Epoch: 7 cost time: 0.8217601776123047
Epoch: 7, Steps: 129 | Train Loss: 0.4923867 Vali Loss: 0.3483523 Best vali loss: 0.3470445
	iters: 100, epoch: 8 | loss: 0.4094923
	speed: 0.0102s/iter; left time: 0.3070s
Updating learning rate to 5.5490206921875e-06
Epoch: 8 cost time: 0.8273298740386963
Epoch: 8, Steps: 129 | Train Loss: 0.4094923 Vali Loss: 0.3497780 Best vali loss: 0.3470445

best validation loss 0.34704449542144894

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019647876547, 'e_layers': 4, 'learning_rate': 0.0007176769257, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3582276
	speed: 0.0116s/iter; left time: 22.7376s
	iters: 200, epoch: 1 | loss: 0.5710938
	speed: 0.0051s/iter; left time: 9.4030s
Updating learning rate to 0.0007176769257
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.7182815074920654
Epoch: 1, Steps: 257 | Train Loss: 0.4646607 Vali Loss: 0.3733871 Best vali loss: 0.3733871
	iters: 100, epoch: 2 | loss: 0.8043215
	speed: 0.0117s/iter; left time: 19.9676s
	iters: 200, epoch: 2 | loss: 0.5383301
	speed: 0.0054s/iter; left time: 8.7044s
Updating learning rate to 0.00035883846285
Epoch: 2 cost time: 1.4686732292175293
Epoch: 2, Steps: 257 | Train Loss: 0.6713258 Vali Loss: 0.3794235 Best vali loss: 0.3733871
	iters: 100, epoch: 3 | loss: 0.7476972
	speed: 0.0111s/iter; left time: 16.0736s
	iters: 200, epoch: 3 | loss: 0.7080200
	speed: 0.0049s/iter; left time: 6.5552s
Updating learning rate to 0.000179419231425
Validation loss decreased (0.3734 --> 0.3616).  Saving model state dict ...
Epoch: 3 cost time: 1.3183927536010742
Epoch: 3, Steps: 257 | Train Loss: 0.7278586 Vali Loss: 0.3615707 Best vali loss: 0.3615707
	iters: 100, epoch: 4 | loss: 0.5924472
	speed: 0.0108s/iter; left time: 12.7746s
	iters: 200, epoch: 4 | loss: 0.5178992
	speed: 0.0048s/iter; left time: 5.1964s
Updating learning rate to 8.97096157125e-05
Validation loss decreased (0.3616 --> 0.3576).  Saving model state dict ...
Epoch: 4 cost time: 1.2956476211547852
Epoch: 4, Steps: 257 | Train Loss: 0.5551732 Vali Loss: 0.3576432 Best vali loss: 0.3576432
	iters: 100, epoch: 5 | loss: 0.3135947
	speed: 0.0112s/iter; left time: 10.4466s
	iters: 200, epoch: 5 | loss: 0.3439202
	speed: 0.0054s/iter; left time: 4.4370s
Updating learning rate to 4.485480785625e-05
Epoch: 5 cost time: 1.4269874095916748
Epoch: 5, Steps: 257 | Train Loss: 0.3287575 Vali Loss: 0.3630687 Best vali loss: 0.3576432
	iters: 100, epoch: 6 | loss: 0.4929754
	speed: 0.0106s/iter; left time: 7.1268s
	iters: 200, epoch: 6 | loss: 0.5726043
	speed: 0.0048s/iter; left time: 2.7716s
Updating learning rate to 2.2427403928125e-05
Epoch: 6 cost time: 1.2917554378509521
Epoch: 6, Steps: 257 | Train Loss: 0.5327898 Vali Loss: 0.3755527 Best vali loss: 0.3576432
	iters: 100, epoch: 7 | loss: 0.3939686
	speed: 0.0108s/iter; left time: 4.4688s
	iters: 200, epoch: 7 | loss: 0.3357076
	speed: 0.0050s/iter; left time: 1.5713s
Updating learning rate to 1.12137019640625e-05
Epoch: 7 cost time: 1.348740816116333
Epoch: 7, Steps: 257 | Train Loss: 0.3648381 Vali Loss: 0.3668372 Best vali loss: 0.3576432
	iters: 100, epoch: 8 | loss: 0.7099716
	speed: 0.0118s/iter; left time: 1.8671s
	iters: 200, epoch: 8 | loss: 0.3911241
	speed: 0.0054s/iter; left time: 0.3146s
Updating learning rate to 5.60685098203125e-06
Epoch: 8 cost time: 1.4911284446716309
Epoch: 8, Steps: 257 | Train Loss: 0.5505479 Vali Loss: 0.3660994 Best vali loss: 0.3576432

best validation loss 0.35764316636593263

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020391627837, 'e_layers': 3, 'learning_rate': 0.0007105277291, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6347255
	speed: 0.0105s/iter; left time: 85.1397s
	iters: 200, epoch: 1 | loss: 0.6917657
	speed: 0.0041s/iter; left time: 32.6906s
	iters: 300, epoch: 1 | loss: 1.0673424
	speed: 0.0042s/iter; left time: 32.9536s
	iters: 400, epoch: 1 | loss: 1.0773382
	speed: 0.0041s/iter; left time: 31.9471s
	iters: 500, epoch: 1 | loss: 0.4837958
	speed: 0.0041s/iter; left time: 31.7574s
	iters: 600, epoch: 1 | loss: 1.1278708
	speed: 0.0042s/iter; left time: 31.6113s
	iters: 700, epoch: 1 | loss: 0.6160235
	speed: 0.0041s/iter; left time: 30.5837s
	iters: 800, epoch: 1 | loss: 1.2271423
	speed: 0.0041s/iter; left time: 30.2847s
	iters: 900, epoch: 1 | loss: 0.8925709
	speed: 0.0042s/iter; left time: 30.8874s
	iters: 1000, epoch: 1 | loss: 0.6994169
	speed: 0.0042s/iter; left time: 30.6071s
Updating learning rate to 0.0007105277291
Validation loss decreased (inf --> 0.3801).  Saving model state dict ...
Epoch: 1 cost time: 4.636420011520386
Epoch: 1, Steps: 1027 | Train Loss: 0.8517992 Vali Loss: 0.3801436 Best vali loss: 0.3801436
	iters: 100, epoch: 2 | loss: 0.1812795
	speed: 0.0120s/iter; left time: 85.3571s
	iters: 200, epoch: 2 | loss: 0.9825626
	speed: 0.0042s/iter; left time: 29.1332s
	iters: 300, epoch: 2 | loss: 1.2323010
	speed: 0.0042s/iter; left time: 28.9525s
	iters: 400, epoch: 2 | loss: 0.5874789
	speed: 0.0042s/iter; left time: 28.3021s
	iters: 500, epoch: 2 | loss: 0.4288887
	speed: 0.0042s/iter; left time: 27.8849s
	iters: 600, epoch: 2 | loss: 1.7795713
	speed: 0.0042s/iter; left time: 27.9548s
	iters: 700, epoch: 2 | loss: 1.0762058
	speed: 0.0037s/iter; left time: 23.8694s
	iters: 800, epoch: 2 | loss: 1.2945895
	speed: 0.0040s/iter; left time: 25.5306s
	iters: 900, epoch: 2 | loss: 1.5125028
	speed: 0.0040s/iter; left time: 25.2268s
	iters: 1000, epoch: 2 | loss: 1.1560943
	speed: 0.0040s/iter; left time: 24.7591s
Updating learning rate to 0.00035526386455
Epoch: 2 cost time: 4.269063234329224
Epoch: 2, Steps: 1027 | Train Loss: 1.0231474 Vali Loss: 0.3856210 Best vali loss: 0.3801436
	iters: 100, epoch: 3 | loss: 0.2946462
	speed: 0.0111s/iter; left time: 67.2549s
	iters: 200, epoch: 3 | loss: 0.3458345
	speed: 0.0039s/iter; left time: 23.5194s
	iters: 300, epoch: 3 | loss: 0.7731137
	speed: 0.0036s/iter; left time: 21.3965s
	iters: 400, epoch: 3 | loss: 0.3500072
	speed: 0.0036s/iter; left time: 20.9049s
	iters: 500, epoch: 3 | loss: 0.5278465
	speed: 0.0036s/iter; left time: 20.5266s
	iters: 600, epoch: 3 | loss: 0.4140879
	speed: 0.0036s/iter; left time: 20.2851s
	iters: 700, epoch: 3 | loss: 1.0756618
	speed: 0.0036s/iter; left time: 19.9163s
	iters: 800, epoch: 3 | loss: 0.6824272
	speed: 0.0036s/iter; left time: 19.4207s
	iters: 900, epoch: 3 | loss: 0.5047514
	speed: 0.0036s/iter; left time: 19.1297s
	iters: 1000, epoch: 3 | loss: 1.2842144
	speed: 0.0036s/iter; left time: 18.6860s
Updating learning rate to 0.000177631932275
Epoch: 3 cost time: 3.8480286598205566
Epoch: 3, Steps: 1027 | Train Loss: 0.6252591 Vali Loss: 0.3927337 Best vali loss: 0.3801436
	iters: 100, epoch: 4 | loss: 0.9714826
	speed: 0.0115s/iter; left time: 57.9343s
	iters: 200, epoch: 4 | loss: 0.2379843
	speed: 0.0041s/iter; left time: 20.4740s
	iters: 300, epoch: 4 | loss: 0.4165887
	speed: 0.0042s/iter; left time: 20.3181s
	iters: 400, epoch: 4 | loss: 0.7479109
	speed: 0.0042s/iter; left time: 19.8390s
	iters: 500, epoch: 4 | loss: 0.2882469
	speed: 0.0043s/iter; left time: 19.9011s
	iters: 600, epoch: 4 | loss: 0.4158484
	speed: 0.0041s/iter; left time: 18.8232s
	iters: 700, epoch: 4 | loss: 0.2899901
	speed: 0.0042s/iter; left time: 18.4142s
	iters: 800, epoch: 4 | loss: 0.6360238
	speed: 0.0043s/iter; left time: 18.4488s
	iters: 900, epoch: 4 | loss: 0.4277665
	speed: 0.0042s/iter; left time: 17.7617s
	iters: 1000, epoch: 4 | loss: 0.3939404
	speed: 0.0042s/iter; left time: 17.2505s
Updating learning rate to 8.88159661375e-05
Epoch: 4 cost time: 4.355954885482788
Epoch: 4, Steps: 1027 | Train Loss: 0.4825783 Vali Loss: 0.3857363 Best vali loss: 0.3801436
	iters: 100, epoch: 5 | loss: 0.4156729
	speed: 0.0119s/iter; left time: 47.5779s
	iters: 200, epoch: 5 | loss: 0.2429591
	speed: 0.0042s/iter; left time: 16.3306s
	iters: 300, epoch: 5 | loss: 0.2673000
	speed: 0.0042s/iter; left time: 15.9602s
	iters: 400, epoch: 5 | loss: 0.7660711
	speed: 0.0042s/iter; left time: 15.4615s
	iters: 500, epoch: 5 | loss: 0.8289820
	speed: 0.0042s/iter; left time: 15.1091s
	iters: 600, epoch: 5 | loss: 0.2256302
	speed: 0.0042s/iter; left time: 14.6348s
	iters: 700, epoch: 5 | loss: 1.0345398
	speed: 0.0042s/iter; left time: 14.1951s
	iters: 800, epoch: 5 | loss: 0.8045131
	speed: 0.0042s/iter; left time: 13.8283s
	iters: 900, epoch: 5 | loss: 0.9034315
	speed: 0.0042s/iter; left time: 13.3451s
	iters: 1000, epoch: 5 | loss: 0.6839656
	speed: 0.0042s/iter; left time: 13.0358s
Updating learning rate to 4.440798306875e-05
Epoch: 5 cost time: 4.354220628738403
Epoch: 5, Steps: 1027 | Train Loss: 0.6173065 Vali Loss: 0.3844633 Best vali loss: 0.3801436
	iters: 100, epoch: 6 | loss: 1.0935529
	speed: 0.0118s/iter; left time: 35.0492s
	iters: 200, epoch: 6 | loss: 0.3164325
	speed: 0.0042s/iter; left time: 12.0097s
	iters: 300, epoch: 6 | loss: 0.4504561
	speed: 0.0042s/iter; left time: 11.7051s
	iters: 400, epoch: 6 | loss: 0.3377692
	speed: 0.0042s/iter; left time: 11.3043s
	iters: 500, epoch: 6 | loss: 0.2936013
	speed: 0.0042s/iter; left time: 10.8573s
	iters: 600, epoch: 6 | loss: 0.3428506
	speed: 0.0042s/iter; left time: 10.4260s
	iters: 700, epoch: 6 | loss: 0.2563949
	speed: 0.0042s/iter; left time: 10.0013s
	iters: 800, epoch: 6 | loss: 0.2385663
	speed: 0.0042s/iter; left time: 9.5186s
	iters: 900, epoch: 6 | loss: 0.7596272
	speed: 0.0042s/iter; left time: 9.1041s
	iters: 1000, epoch: 6 | loss: 0.5458833
	speed: 0.0042s/iter; left time: 8.7071s
Updating learning rate to 2.2203991534375e-05
Epoch: 6 cost time: 4.366009473800659
Epoch: 6, Steps: 1027 | Train Loss: 0.4635134 Vali Loss: 0.3848598 Best vali loss: 0.3801436
	iters: 100, epoch: 7 | loss: 0.3844841
	speed: 0.0116s/iter; left time: 22.6778s
	iters: 200, epoch: 7 | loss: 0.7070832
	speed: 0.0042s/iter; left time: 7.7679s
	iters: 300, epoch: 7 | loss: 1.0628734
	speed: 0.0042s/iter; left time: 7.3136s
	iters: 400, epoch: 7 | loss: 0.6371149
	speed: 0.0042s/iter; left time: 6.8785s
	iters: 500, epoch: 7 | loss: 1.7451525
	speed: 0.0042s/iter; left time: 6.4969s
	iters: 600, epoch: 7 | loss: 0.4315486
	speed: 0.0041s/iter; left time: 6.0083s
	iters: 700, epoch: 7 | loss: 0.3591221
	speed: 0.0042s/iter; left time: 5.7032s
	iters: 800, epoch: 7 | loss: 0.8078454
	speed: 0.0043s/iter; left time: 5.3439s
	iters: 900, epoch: 7 | loss: 0.4527254
	speed: 0.0043s/iter; left time: 4.9142s
	iters: 1000, epoch: 7 | loss: 0.6426088
	speed: 0.0042s/iter; left time: 4.4555s
Updating learning rate to 1.11019957671875e-05
Epoch: 7 cost time: 4.36731743812561
Epoch: 7, Steps: 1027 | Train Loss: 0.7230558 Vali Loss: 0.3858506 Best vali loss: 0.3801436
	iters: 100, epoch: 8 | loss: 0.9695991
	speed: 0.0114s/iter; left time: 10.5630s
	iters: 200, epoch: 8 | loss: 0.2724618
	speed: 0.0039s/iter; left time: 3.2633s
	iters: 300, epoch: 8 | loss: 0.2076537
	speed: 0.0037s/iter; left time: 2.6886s
	iters: 400, epoch: 8 | loss: 0.4298506
	speed: 0.0036s/iter; left time: 2.2712s
	iters: 500, epoch: 8 | loss: 0.9559227
	speed: 0.0036s/iter; left time: 1.9166s
	iters: 600, epoch: 8 | loss: 0.3346352
	speed: 0.0036s/iter; left time: 1.5586s
	iters: 700, epoch: 8 | loss: 0.3070830
	speed: 0.0038s/iter; left time: 1.2306s
	iters: 800, epoch: 8 | loss: 0.3840351
	speed: 0.0037s/iter; left time: 0.8547s
	iters: 900, epoch: 8 | loss: 0.2165940
	speed: 0.0037s/iter; left time: 0.4791s
	iters: 1000, epoch: 8 | loss: 0.7851157
	speed: 0.0037s/iter; left time: 0.1046s
Updating learning rate to 5.55099788359375e-06
Epoch: 8 cost time: 3.903057336807251
Epoch: 8, Steps: 1027 | Train Loss: 0.4862951 Vali Loss: 0.3866103 Best vali loss: 0.3801436

best validation loss 0.3801436061357937

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019937158538, 'e_layers': 3, 'learning_rate': 0.000707800046, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1359298
	speed: 0.0108s/iter; left time: 87.3200s
	iters: 200, epoch: 1 | loss: 0.5088959
	speed: 0.0043s/iter; left time: 34.4000s
	iters: 300, epoch: 1 | loss: 1.9187437
	speed: 0.0043s/iter; left time: 33.6717s
	iters: 400, epoch: 1 | loss: 0.8851941
	speed: 0.0043s/iter; left time: 33.5437s
	iters: 500, epoch: 1 | loss: 0.4997554
	speed: 0.0042s/iter; left time: 32.7184s
	iters: 600, epoch: 1 | loss: 0.2543738
	speed: 0.0043s/iter; left time: 32.6007s
	iters: 700, epoch: 1 | loss: 0.4490656
	speed: 0.0043s/iter; left time: 32.6211s
	iters: 800, epoch: 1 | loss: 0.5721117
	speed: 0.0042s/iter; left time: 31.4603s
	iters: 900, epoch: 1 | loss: 0.4373864
	speed: 0.0042s/iter; left time: 30.9948s
	iters: 1000, epoch: 1 | loss: 0.2814303
	speed: 0.0042s/iter; left time: 30.3831s
Updating learning rate to 0.000707800046
Validation loss decreased (inf --> 0.3777).  Saving model state dict ...
Epoch: 1 cost time: 4.759223461151123
Epoch: 1, Steps: 1027 | Train Loss: 0.6942887 Vali Loss: 0.3776923 Best vali loss: 0.3776923
	iters: 100, epoch: 2 | loss: 1.1301550
	speed: 0.0118s/iter; left time: 83.8614s
	iters: 200, epoch: 2 | loss: 0.8387552
	speed: 0.0042s/iter; left time: 29.6125s
	iters: 300, epoch: 2 | loss: 0.5551831
	speed: 0.0043s/iter; left time: 29.3152s
	iters: 400, epoch: 2 | loss: 0.2740218
	speed: 0.0042s/iter; left time: 28.4153s
	iters: 500, epoch: 2 | loss: 0.4873531
	speed: 0.0042s/iter; left time: 28.3766s
	iters: 600, epoch: 2 | loss: 1.1134828
	speed: 0.0042s/iter; left time: 27.6928s
	iters: 700, epoch: 2 | loss: 0.2956833
	speed: 0.0043s/iter; left time: 27.7654s
	iters: 800, epoch: 2 | loss: 0.8882084
	speed: 0.0042s/iter; left time: 27.0787s
	iters: 900, epoch: 2 | loss: 0.4570040
	speed: 0.0042s/iter; left time: 26.6073s
	iters: 1000, epoch: 2 | loss: 0.2315807
	speed: 0.0042s/iter; left time: 25.8006s
Updating learning rate to 0.000353900023
Epoch: 2 cost time: 4.404168128967285
Epoch: 2, Steps: 1027 | Train Loss: 0.6271427 Vali Loss: 0.4010350 Best vali loss: 0.3776923
	iters: 100, epoch: 3 | loss: 0.6591316
	speed: 0.0114s/iter; left time: 68.8184s
	iters: 200, epoch: 3 | loss: 1.0371374
	speed: 0.0037s/iter; left time: 22.0120s
	iters: 300, epoch: 3 | loss: 0.9228874
	speed: 0.0037s/iter; left time: 21.9837s
	iters: 400, epoch: 3 | loss: 0.8761216
	speed: 0.0038s/iter; left time: 21.6808s
	iters: 500, epoch: 3 | loss: 0.7893887
	speed: 0.0037s/iter; left time: 21.2309s
	iters: 600, epoch: 3 | loss: 0.2632559
	speed: 0.0038s/iter; left time: 21.2219s
	iters: 700, epoch: 3 | loss: 0.3980855
	speed: 0.0040s/iter; left time: 21.6740s
	iters: 800, epoch: 3 | loss: 0.3806601
	speed: 0.0038s/iter; left time: 20.2070s
	iters: 900, epoch: 3 | loss: 0.8214208
	speed: 0.0036s/iter; left time: 19.0389s
	iters: 1000, epoch: 3 | loss: 0.9710232
	speed: 0.0038s/iter; left time: 19.4598s
Updating learning rate to 0.0001769500115
Epoch: 3 cost time: 3.939758777618408
Epoch: 3, Steps: 1027 | Train Loss: 0.7119112 Vali Loss: 0.3985693 Best vali loss: 0.3776923

best validation loss 0.37769230556160155

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018922441349, 'e_layers': 4, 'learning_rate': 0.0014134588835, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014134588835
Validation loss decreased (inf --> 0.3868).  Saving model state dict ...
Epoch: 1 cost time: 1.1248536109924316
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3867735 Best vali loss: 0.3867735
Updating learning rate to 0.00070672944175
Epoch: 2 cost time: 0.7842988967895508
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3976658 Best vali loss: 0.3867735
Updating learning rate to 0.000353364720875
Epoch: 3 cost time: 0.772496223449707
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3969022 Best vali loss: 0.3867735

best validation loss 0.3867734950160231

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.7177150249481201
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3707770 Best vali loss: 0.3707770
Updating learning rate to 0.0020113971511072134
Validation loss decreased (0.3708 --> 0.3693).  Saving model state dict ...
Epoch: 2 cost time: 0.3939976692199707
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3693330 Best vali loss: 0.3693330
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.38727760314941406
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3729523 Best vali loss: 0.3693330

best validation loss 0.36933298154289457

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0011782491718
Validation loss decreased (0.3693 --> 0.3687).  Saving model state dict ...
Epoch: 4 cost time: 0.7307024002075195
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3686593 Best vali loss: 0.3686593
Updating learning rate to 0.0007273527345542516
Epoch: 5 cost time: 0.42301273345947266
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3740457 Best vali loss: 0.3686593
Updating learning rate to 0.00034510119249278663
Epoch: 6 cost time: 0.38172340393066406
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3713692 Best vali loss: 0.3686593
Updating learning rate to 8.968887777560523e-05
Epoch: 7 cost time: 0.3900179862976074
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3770375 Best vali loss: 0.3686593
Updating learning rate to 0.0
Epoch: 8 cost time: 0.41543078422546387
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3759971 Best vali loss: 0.3686593

best validation loss 0.3686593185239316

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019333267018, 'e_layers': 4, 'learning_rate': 0.0013781135024, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0013781135024
Validation loss decreased (inf --> 0.3980).  Saving model state dict ...
Epoch: 1 cost time: 1.1125373840332031
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3979877 Best vali loss: 0.3979877
Updating learning rate to 0.0006890567512
Epoch: 2 cost time: 0.7794854640960693
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4039389 Best vali loss: 0.3979877
Updating learning rate to 0.0003445283756
Validation loss decreased (0.3980 --> 0.3925).  Saving model state dict ...
Epoch: 3 cost time: 0.7785418033599854
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3924964 Best vali loss: 0.3924964
Updating learning rate to 0.0001722641878
Validation loss decreased (0.3925 --> 0.3890).  Saving model state dict ...
Epoch: 4 cost time: 0.7828547954559326
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3890224 Best vali loss: 0.3890224
Updating learning rate to 8.61320939e-05
Epoch: 5 cost time: 0.7811098098754883
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3926422 Best vali loss: 0.3890224
Updating learning rate to 4.306604695e-05
Epoch: 6 cost time: 0.7768044471740723
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3898284 Best vali loss: 0.3890224
Updating learning rate to 2.1533023475e-05
Epoch: 7 cost time: 0.78080153465271
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3901486 Best vali loss: 0.3890224
Updating learning rate to 1.07665117375e-05
Epoch: 8 cost time: 0.7742390632629395
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3902478 Best vali loss: 0.3890224

best validation loss 0.38902238588670385

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019360086317, 'e_layers': 4, 'learning_rate': 0.0013845228697, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0013845228697
Validation loss decreased (inf --> 0.3970).  Saving model state dict ...
Epoch: 1 cost time: 1.1087405681610107
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3969551 Best vali loss: 0.3969551
Updating learning rate to 0.00069226143485
Epoch: 2 cost time: 0.7773942947387695
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4113123 Best vali loss: 0.3969551
Updating learning rate to 0.000346130717425
Epoch: 3 cost time: 0.7773659229278564
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4073162 Best vali loss: 0.3969551
Updating learning rate to 0.0001730653587125
Epoch: 4 cost time: 0.7793533802032471
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4073412 Best vali loss: 0.3969551
Updating learning rate to 8.653267935625e-05
Epoch: 5 cost time: 0.7771244049072266
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4067151 Best vali loss: 0.3969551
Updating learning rate to 4.3266339678125e-05
Epoch: 6 cost time: 0.7848825454711914
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4023009 Best vali loss: 0.3969551
Updating learning rate to 2.16331698390625e-05
Epoch: 7 cost time: 0.7754123210906982
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4038995 Best vali loss: 0.3969551
Updating learning rate to 1.081658491953125e-05
Epoch: 8 cost time: 0.7751200199127197
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4037051 Best vali loss: 0.3969551

best validation loss 0.39695508614738706

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018328428213, 'e_layers': 4, 'learning_rate': 0.0013171962155, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0013171962155
Validation loss decreased (inf --> 0.3945).  Saving model state dict ...
Epoch: 1 cost time: 1.0937108993530273
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3945465 Best vali loss: 0.3945465
Updating learning rate to 0.00065859810775
Epoch: 2 cost time: 0.7808620929718018
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4130316 Best vali loss: 0.3945465
Updating learning rate to 0.000329299053875
Epoch: 3 cost time: 0.7770228385925293
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4078322 Best vali loss: 0.3945465

best validation loss 0.39454650118917756

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018919667405, 'e_layers': 4, 'learning_rate': 0.0013551114665, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0013551114665
Validation loss decreased (inf --> 0.3921).  Saving model state dict ...
Epoch: 1 cost time: 1.1011669635772705
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3920755 Best vali loss: 0.3920755
Updating learning rate to 0.00067755573325
Epoch: 2 cost time: 0.782996416091919
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4041855 Best vali loss: 0.3920755
Updating learning rate to 0.000338777866625
Epoch: 3 cost time: 0.7721407413482666
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3957538 Best vali loss: 0.3920755

best validation loss 0.3920754510667797

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022395568834, 'e_layers': 3, 'learning_rate': 0.0008109399971, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008109399971
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 0.9311351776123047
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3738589 Best vali loss: 0.3738589
Updating learning rate to 0.00040546999855
Validation loss decreased (0.3739 --> 0.3706).  Saving model state dict ...
Epoch: 2 cost time: 0.6139795780181885
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3705882 Best vali loss: 0.3705882
Updating learning rate to 0.000202734999275
Epoch: 3 cost time: 0.6122820377349854
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3740440 Best vali loss: 0.3705882

best validation loss 0.3705881982280604

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022395568834, 'e_layers': 3, 'learning_rate': 0.0008109399971, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001013674996375
Validation loss decreased (0.3706 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 0.93902587890625
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3677654 Best vali loss: 0.3677654
Updating learning rate to 5.068374981875e-05
Validation loss decreased (0.3678 --> 0.3608).  Saving model state dict ...
Epoch: 5 cost time: 0.618880033493042
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3608385 Best vali loss: 0.3608385
Updating learning rate to 2.5341874909375e-05
Epoch: 6 cost time: 0.6154801845550537
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3649505 Best vali loss: 0.3608385
Updating learning rate to 1.26709374546875e-05
Epoch: 7 cost time: 0.6154296398162842
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3636277 Best vali loss: 0.3608385
Updating learning rate to 6.33546872734375e-06
Epoch: 8 cost time: 0.6196558475494385
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3629156 Best vali loss: 0.3608385

best validation loss 0.36083852656932147

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022333278348, 'e_layers': 3, 'learning_rate': 0.0007082554582, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007082554582
Validation loss decreased (inf --> 0.3736).  Saving model state dict ...
Epoch: 1 cost time: 0.9416923522949219
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3736162 Best vali loss: 0.3736162
Updating learning rate to 0.0003541277291
Epoch: 2 cost time: 0.6178863048553467
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3758734 Best vali loss: 0.3736162
Updating learning rate to 0.00017706386455
Validation loss decreased (0.3736 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 0.6100611686706543
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3643698 Best vali loss: 0.3643698
Updating learning rate to 8.8531932275e-05
Epoch: 4 cost time: 0.6207630634307861
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3724206 Best vali loss: 0.3643698
Updating learning rate to 4.42659661375e-05
Validation loss decreased (0.3644 --> 0.3569).  Saving model state dict ...
Epoch: 5 cost time: 0.6169998645782471
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3569426 Best vali loss: 0.3569426
Updating learning rate to 2.213298306875e-05
Epoch: 6 cost time: 0.6232779026031494
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3622382 Best vali loss: 0.3569426
Updating learning rate to 1.1066491534375e-05
Epoch: 7 cost time: 0.6109893321990967
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3576898 Best vali loss: 0.3569426
Updating learning rate to 5.5332457671875e-06
Epoch: 8 cost time: 0.6170809268951416
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3598738 Best vali loss: 0.3569426

best validation loss 0.3569425847300846

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020235326073, 'e_layers': 4, 'learning_rate': 0.0005935815618, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005935815618
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 1.1002421379089355
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3693193 Best vali loss: 0.3693193
Updating learning rate to 0.0002967907809
Validation loss decreased (0.3693 --> 0.3479).  Saving model state dict ...
Epoch: 2 cost time: 0.7861738204956055
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3479162 Best vali loss: 0.3479162
Updating learning rate to 0.00014839539045
Epoch: 3 cost time: 0.7834358215332031
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3523255 Best vali loss: 0.3479162
Updating learning rate to 7.4197695225e-05
Epoch: 4 cost time: 0.7847702503204346
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3486395 Best vali loss: 0.3479162
Updating learning rate to 3.70988476125e-05
Validation loss decreased (0.3479 --> 0.3457).  Saving model state dict ...
Epoch: 5 cost time: 0.779491662979126
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3456608 Best vali loss: 0.3456608
Updating learning rate to 1.854942380625e-05
Validation loss decreased (0.3457 --> 0.3446).  Saving model state dict ...
Epoch: 6 cost time: 0.7814040184020996
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3445833 Best vali loss: 0.3445833
Updating learning rate to 9.274711903125e-06
Validation loss decreased (0.3446 --> 0.3445).  Saving model state dict ...
Epoch: 7 cost time: 0.7854881286621094
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3445467 Best vali loss: 0.3445467
Updating learning rate to 4.6373559515625e-06
Epoch: 8 cost time: 0.7849721908569336
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3452298 Best vali loss: 0.3445467

best validation loss 0.3445466621919793

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020028080891, 'e_layers': 4, 'learning_rate': 0.0005300934131, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005300934131
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 1.0954926013946533
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3685209 Best vali loss: 0.3685209
Updating learning rate to 0.00026504670655
Validation loss decreased (0.3685 --> 0.3562).  Saving model state dict ...
Epoch: 2 cost time: 0.7836873531341553
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3561909 Best vali loss: 0.3561909
Updating learning rate to 0.000132523353275
Validation loss decreased (0.3562 --> 0.3532).  Saving model state dict ...
Epoch: 3 cost time: 0.7845315933227539
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3531841 Best vali loss: 0.3531841

best validation loss 0.35318413684785016

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7102124
	speed: 0.0117s/iter; left time: 10.9525s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.4303).  Saving model state dict ...
Epoch: 1 cost time: 1.0790767669677734
Epoch: 1, Steps: 129 | Train Loss: 0.7102124 Vali Loss: 0.4302872 Best vali loss: 0.4302872
	iters: 100, epoch: 2 | loss: 0.5248924
	speed: 0.0094s/iter; left time: 7.5842s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.4303 --> 0.4162).  Saving model state dict ...
Epoch: 2 cost time: 0.7842495441436768
Epoch: 2, Steps: 129 | Train Loss: 0.5248924 Vali Loss: 0.4161879 Best vali loss: 0.4161879
	iters: 100, epoch: 3 | loss: 0.5404279
	speed: 0.0092s/iter; left time: 6.2058s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.4162 --> 0.4064).  Saving model state dict ...
Epoch: 3 cost time: 0.7408523559570312
Epoch: 3, Steps: 129 | Train Loss: 0.5404279 Vali Loss: 0.4064469 Best vali loss: 0.4064469

best validation loss 0.406446876132418

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002027383213, 'e_layers': 4, 'learning_rate': 0.0005118368526, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005118368526
Validation loss decreased (inf --> 0.3684).  Saving model state dict ...
Epoch: 1 cost time: 1.1107821464538574
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3683716 Best vali loss: 0.3683716
Updating learning rate to 0.0002559184263
Validation loss decreased (0.3684 --> 0.3481).  Saving model state dict ...
Epoch: 2 cost time: 0.7859976291656494
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3481065 Best vali loss: 0.3481065
Updating learning rate to 0.00012795921315
Epoch: 3 cost time: 0.7889819145202637
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3672776 Best vali loss: 0.3481065

best validation loss 0.34810645897636716

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002027383213, 'e_layers': 4, 'learning_rate': 0.0005118368526, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.3979606575e-05
Epoch: 4 cost time: 1.095691442489624
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3527506 Best vali loss: 0.3481065
Updating learning rate to 3.19898032875e-05
Epoch: 5 cost time: 0.7794196605682373
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3525135 Best vali loss: 0.3481065
Updating learning rate to 1.599490164375e-05
Epoch: 6 cost time: 0.778247594833374
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3496878 Best vali loss: 0.3481065
Updating learning rate to 7.997450821875e-06
Epoch: 7 cost time: 0.7762703895568848
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3523904 Best vali loss: 0.3481065
Updating learning rate to 3.9987254109375e-06
Epoch: 8 cost time: 0.7933619022369385
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3533116 Best vali loss: 0.3481065

best validation loss 0.34810645897636716

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020112482024, 'e_layers': 4, 'learning_rate': 0.0006410969237, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006410969237
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.1034438610076904
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669275 Best vali loss: 0.3669275
Updating learning rate to 0.00032054846185
Validation loss decreased (0.3669 --> 0.3568).  Saving model state dict ...
Epoch: 2 cost time: 0.785205602645874
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3567829 Best vali loss: 0.3567829
Updating learning rate to 0.000160274230925
Validation loss decreased (0.3568 --> 0.3559).  Saving model state dict ...
Epoch: 3 cost time: 0.7872490882873535
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3559372 Best vali loss: 0.3559372
Updating learning rate to 8.01371154625e-05
Validation loss decreased (0.3559 --> 0.3535).  Saving model state dict ...
Epoch: 4 cost time: 0.7852287292480469
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3535348 Best vali loss: 0.3535348
Updating learning rate to 4.006855773125e-05
Epoch: 5 cost time: 0.7912759780883789
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3547748 Best vali loss: 0.3535348
Updating learning rate to 2.0034278865625e-05
Epoch: 6 cost time: 0.7861752510070801
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3553649 Best vali loss: 0.3535348
Updating learning rate to 1.00171394328125e-05
Epoch: 7 cost time: 0.7813677787780762
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3552302 Best vali loss: 0.3535348
Updating learning rate to 5.00856971640625e-06
Epoch: 8 cost time: 0.7870304584503174
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3566083 Best vali loss: 0.3535348

best validation loss 0.35353475149816055

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019409161903, 'e_layers': 4, 'learning_rate': 0.0004569072823, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5475333
	speed: 0.0135s/iter; left time: 12.6268s
Updating learning rate to 0.0004569072823
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.2911536693572998
Epoch: 1, Steps: 129 | Train Loss: 0.5475333 Vali Loss: 0.3655233 Best vali loss: 0.3655233
	iters: 100, epoch: 2 | loss: 0.5372885
	speed: 0.0118s/iter; left time: 9.4701s
Updating learning rate to 0.00022845364115
Validation loss decreased (0.3655 --> 0.3604).  Saving model state dict ...
Epoch: 2 cost time: 0.9344387054443359
Epoch: 2, Steps: 129 | Train Loss: 0.5372885 Vali Loss: 0.3603981 Best vali loss: 0.3603981
	iters: 100, epoch: 3 | loss: 0.5261239
	speed: 0.0117s/iter; left time: 7.8977s
Updating learning rate to 0.000114226820575
Validation loss decreased (0.3604 --> 0.3519).  Saving model state dict ...
Epoch: 3 cost time: 0.9317278861999512
Epoch: 3, Steps: 129 | Train Loss: 0.5261239 Vali Loss: 0.3519357 Best vali loss: 0.3519357
	iters: 100, epoch: 4 | loss: 0.3399178
	speed: 0.0118s/iter; left time: 6.4166s
Updating learning rate to 5.71134102875e-05
Epoch: 4 cost time: 0.9404234886169434
Epoch: 4, Steps: 129 | Train Loss: 0.3399178 Vali Loss: 0.3555820 Best vali loss: 0.3519357
	iters: 100, epoch: 5 | loss: 0.4737195
	speed: 0.0115s/iter; left time: 4.7975s
Updating learning rate to 2.855670514375e-05
Validation loss decreased (0.3519 --> 0.3502).  Saving model state dict ...
Epoch: 5 cost time: 0.9458408355712891
Epoch: 5, Steps: 129 | Train Loss: 0.4737195 Vali Loss: 0.3501904 Best vali loss: 0.3501904
	iters: 100, epoch: 6 | loss: 0.4303555
	speed: 0.0117s/iter; left time: 3.3653s
Updating learning rate to 1.4278352571875e-05
Epoch: 6 cost time: 0.9297585487365723
Epoch: 6, Steps: 129 | Train Loss: 0.4303555 Vali Loss: 0.3522455 Best vali loss: 0.3501904
	iters: 100, epoch: 7 | loss: 0.5114282
	speed: 0.0114s/iter; left time: 1.8047s
Updating learning rate to 7.1391762859375e-06
Epoch: 7 cost time: 0.9327118396759033
Epoch: 7, Steps: 129 | Train Loss: 0.5114282 Vali Loss: 0.3502687 Best vali loss: 0.3501904
	iters: 100, epoch: 8 | loss: 0.3957826
	speed: 0.0113s/iter; left time: 0.3389s
Updating learning rate to 3.56958814296875e-06
Epoch: 8 cost time: 0.9286141395568848
Epoch: 8, Steps: 129 | Train Loss: 0.3957826 Vali Loss: 0.3519242 Best vali loss: 0.3501904

best validation loss 0.35019036301929496

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019358520455, 'e_layers': 4, 'learning_rate': 0.000428692869, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5461732
	speed: 0.0135s/iter; left time: 12.5939s
Updating learning rate to 0.000428692869
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.2726242542266846
Epoch: 1, Steps: 129 | Train Loss: 0.5461732 Vali Loss: 0.3672369 Best vali loss: 0.3672369
	iters: 100, epoch: 2 | loss: 0.5004523
	speed: 0.0118s/iter; left time: 9.5190s
Updating learning rate to 0.0002143464345
Validation loss decreased (0.3672 --> 0.3556).  Saving model state dict ...
Epoch: 2 cost time: 0.9397976398468018
Epoch: 2, Steps: 129 | Train Loss: 0.5004523 Vali Loss: 0.3556194 Best vali loss: 0.3556194
	iters: 100, epoch: 3 | loss: 0.5398053
	speed: 0.0117s/iter; left time: 7.8925s
Updating learning rate to 0.00010717321725
Validation loss decreased (0.3556 --> 0.3483).  Saving model state dict ...
Epoch: 3 cost time: 0.929877519607544
Epoch: 3, Steps: 129 | Train Loss: 0.5398053 Vali Loss: 0.3482943 Best vali loss: 0.3482943

best validation loss 0.3482942951451585

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019082602877, 'e_layers': 4, 'learning_rate': 0.0003950755931, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5448452
	speed: 0.0135s/iter; left time: 12.5941s
Updating learning rate to 0.0003950755931
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.286207914352417
Epoch: 1, Steps: 129 | Train Loss: 0.5448452 Vali Loss: 0.3670051 Best vali loss: 0.3670051
	iters: 100, epoch: 2 | loss: 0.5562515
	speed: 0.0117s/iter; left time: 9.4204s
Updating learning rate to 0.00019753779655
Epoch: 2 cost time: 0.9432182312011719
Epoch: 2, Steps: 129 | Train Loss: 0.5562515 Vali Loss: 0.3769839 Best vali loss: 0.3670051
	iters: 100, epoch: 3 | loss: 0.5195611
	speed: 0.0113s/iter; left time: 7.6104s
Updating learning rate to 9.8768898275e-05
Validation loss decreased (0.3670 --> 0.3628).  Saving model state dict ...
Epoch: 3 cost time: 0.9245607852935791
Epoch: 3, Steps: 129 | Train Loss: 0.5195611 Vali Loss: 0.3628038 Best vali loss: 0.3628038

best validation loss 0.3628038116311746

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020138347096, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7484357
	speed: 0.0139s/iter; left time: 13.0133s
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3907).  Saving model state dict ...
Epoch: 1 cost time: 1.334815263748169
Epoch: 1, Steps: 129 | Train Loss: 0.7484357 Vali Loss: 0.3907291 Best vali loss: 0.3907291
	iters: 100, epoch: 2 | loss: 1.0426004
	speed: 0.0123s/iter; left time: 9.9261s
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3907 --> 0.3868).  Saving model state dict ...
Epoch: 2 cost time: 1.0004310607910156
Epoch: 2, Steps: 129 | Train Loss: 1.0426004 Vali Loss: 0.3867650 Best vali loss: 0.3867650
	iters: 100, epoch: 3 | loss: 0.6709234
	speed: 0.0125s/iter; left time: 8.4607s
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.9948663711547852
Epoch: 3, Steps: 129 | Train Loss: 0.6709234 Vali Loss: 0.3923870 Best vali loss: 0.3867650

best validation loss 0.38676500688133164

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019358520455, 'e_layers': 4, 'learning_rate': 0.000428692869, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4166892
	speed: 0.0139s/iter; left time: 7.5655s
Updating learning rate to 5.3586608625e-05
Validation loss decreased (0.3483 --> 0.3457).  Saving model state dict ...
Epoch: 4 cost time: 1.2748022079467773
Epoch: 4, Steps: 129 | Train Loss: 0.4166892 Vali Loss: 0.3457311 Best vali loss: 0.3457311
	iters: 100, epoch: 5 | loss: 0.4175089
	speed: 0.0117s/iter; left time: 4.8884s
Updating learning rate to 2.67933043125e-05
Epoch: 5 cost time: 0.9336252212524414
Epoch: 5, Steps: 129 | Train Loss: 0.4175089 Vali Loss: 0.3467460 Best vali loss: 0.3457311
	iters: 100, epoch: 6 | loss: 0.4422174
	speed: 0.0113s/iter; left time: 3.2644s
Updating learning rate to 1.339665215625e-05
Validation loss decreased (0.3457 --> 0.3442).  Saving model state dict ...
Epoch: 6 cost time: 0.9348328113555908
Epoch: 6, Steps: 129 | Train Loss: 0.4422174 Vali Loss: 0.3442063 Best vali loss: 0.3442063
	iters: 100, epoch: 7 | loss: 0.3215617
	speed: 0.0118s/iter; left time: 1.8795s
Updating learning rate to 6.698326078125e-06
Epoch: 7 cost time: 0.9375414848327637
Epoch: 7, Steps: 129 | Train Loss: 0.3215617 Vali Loss: 0.3495587 Best vali loss: 0.3442063
	iters: 100, epoch: 8 | loss: 0.4378628
	speed: 0.0114s/iter; left time: 0.3418s
Updating learning rate to 3.3491630390625e-06
Epoch: 8 cost time: 0.936892032623291
Epoch: 8, Steps: 129 | Train Loss: 0.4378628 Vali Loss: 0.3493763 Best vali loss: 0.3442063

best validation loss 0.34420630784306405

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020189688188, 'e_layers': 4, 'learning_rate': 0.0007061473825, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5448001
	speed: 0.0134s/iter; left time: 12.5338s
Updating learning rate to 0.0006792712480640843
Validation loss decreased (inf --> 0.3904).  Saving model state dict ...
Epoch: 1 cost time: 1.2837908267974854
Epoch: 1, Steps: 129 | Train Loss: 0.5448001 Vali Loss: 0.3903757 Best vali loss: 0.3903757
	iters: 100, epoch: 2 | loss: 0.5432376
	speed: 0.0116s/iter; left time: 9.3461s
Updating learning rate to 0.0006027344925914404
Validation loss decreased (0.3904 --> 0.3883).  Saving model state dict ...
Epoch: 2 cost time: 0.9330563545227051
Epoch: 2, Steps: 129 | Train Loss: 0.5432376 Vali Loss: 0.3883126 Best vali loss: 0.3883126
	iters: 100, epoch: 3 | loss: 0.7421026
	speed: 0.0120s/iter; left time: 8.0820s
Updating learning rate to 0.00048818914329536194
Validation loss decreased (0.3883 --> 0.3873).  Saving model state dict ...
Epoch: 3 cost time: 0.9527101516723633
Epoch: 3, Steps: 129 | Train Loss: 0.7421026 Vali Loss: 0.3872653 Best vali loss: 0.3872653
	iters: 100, epoch: 4 | loss: 0.4190820
	speed: 0.0118s/iter; left time: 6.4611s
Updating learning rate to 0.00035307369125
Validation loss decreased (0.3873 --> 0.3848).  Saving model state dict ...
Epoch: 4 cost time: 0.9464647769927979
Epoch: 4, Steps: 129 | Train Loss: 0.4190820 Vali Loss: 0.3848398 Best vali loss: 0.3848398
	iters: 100, epoch: 5 | loss: 0.7193543
	speed: 0.0117s/iter; left time: 4.8653s
Updating learning rate to 0.00021795823920463803
Validation loss decreased (0.3848 --> 0.3783).  Saving model state dict ...
Epoch: 5 cost time: 0.9310553073883057
Epoch: 5, Steps: 129 | Train Loss: 0.7193543 Vali Loss: 0.3782903 Best vali loss: 0.3782903
	iters: 100, epoch: 6 | loss: 0.5879559
	speed: 0.0116s/iter; left time: 3.3484s
Updating learning rate to 0.00010341288990855962
Epoch: 6 cost time: 0.9398746490478516
Epoch: 6, Steps: 129 | Train Loss: 0.5879559 Vali Loss: 0.3793303 Best vali loss: 0.3782903
	iters: 100, epoch: 7 | loss: 0.6411791
	speed: 0.0114s/iter; left time: 1.8156s
Updating learning rate to 2.6876134435915608e-05
Validation loss decreased (0.3783 --> 0.3742).  Saving model state dict ...
Epoch: 7 cost time: 0.9323005676269531
Epoch: 7, Steps: 129 | Train Loss: 0.6411791 Vali Loss: 0.3742307 Best vali loss: 0.3742307
	iters: 100, epoch: 8 | loss: 0.5000231
	speed: 0.0118s/iter; left time: 0.3538s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9348182678222656
Epoch: 8, Steps: 129 | Train Loss: 0.5000231 Vali Loss: 0.3768391 Best vali loss: 0.3742307

best validation loss 0.3742307133782355

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021528771528, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7140965
	speed: 0.0138s/iter; left time: 12.8595s
Updating learning rate to 0.0006793710744214613
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 1.3349509239196777
Epoch: 1, Steps: 129 | Train Loss: 0.7140965 Vali Loss: 0.3775896 Best vali loss: 0.3775896
	iters: 100, epoch: 2 | loss: 1.0306648
	speed: 0.0125s/iter; left time: 10.0175s
Updating learning rate to 0.0006028230710334579
Epoch: 2 cost time: 1.0131642818450928
Epoch: 2, Steps: 129 | Train Loss: 1.0306648 Vali Loss: 0.3964347 Best vali loss: 0.3775896
	iters: 100, epoch: 3 | loss: 0.6376686
	speed: 0.0121s/iter; left time: 8.1997s
Updating learning rate to 0.0004882608880424347
Epoch: 3 cost time: 1.0015239715576172
Epoch: 3, Steps: 129 | Train Loss: 0.6376686 Vali Loss: 0.3813300 Best vali loss: 0.3775896
	iters: 100, epoch: 4 | loss: 0.6210727
	speed: 0.0121s/iter; left time: 6.5903s
Updating learning rate to 0.0003531255793
Epoch: 4 cost time: 0.9989275932312012
Epoch: 4, Steps: 129 | Train Loss: 0.6210727 Vali Loss: 0.3803124 Best vali loss: 0.3775896
	iters: 100, epoch: 5 | loss: 0.7527581
	speed: 0.0122s/iter; left time: 5.0761s
Updating learning rate to 0.0002179902705575653
Epoch: 5 cost time: 0.9994564056396484
Epoch: 5, Steps: 129 | Train Loss: 0.7527581 Vali Loss: 0.3794935 Best vali loss: 0.3775896
	iters: 100, epoch: 6 | loss: 0.5825468
	speed: 0.0121s/iter; left time: 3.4954s
Updating learning rate to 0.00010342808756654208
Epoch: 6 cost time: 0.9967529773712158
Epoch: 6, Steps: 129 | Train Loss: 0.5825468 Vali Loss: 0.3850201 Best vali loss: 0.3775896
	iters: 100, epoch: 7 | loss: 0.7033058
	speed: 0.0121s/iter; left time: 1.9237s
Updating learning rate to 2.6880084178538685e-05
Epoch: 7 cost time: 1.0015161037445068
Epoch: 7, Steps: 129 | Train Loss: 0.7033058 Vali Loss: 0.3794696 Best vali loss: 0.3775896
	iters: 100, epoch: 8 | loss: 0.5752884
	speed: 0.0121s/iter; left time: 0.3635s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.001969575881958
Epoch: 8, Steps: 129 | Train Loss: 0.5752884 Vali Loss: 0.3801819 Best vali loss: 0.3775896

best validation loss 0.37758955254067605

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0018970383791, 'e_layers': 4, 'learning_rate': 0.0006995979188, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7354047
	speed: 0.0136s/iter; left time: 12.6813s
Updating learning rate to 0.0006729710584834066
Validation loss decreased (inf --> 0.3829).  Saving model state dict ...
Epoch: 1 cost time: 1.2884454727172852
Epoch: 1, Steps: 129 | Train Loss: 0.7354047 Vali Loss: 0.3829366 Best vali loss: 0.3829366
	iters: 100, epoch: 2 | loss: 0.5192435
	speed: 0.0117s/iter; left time: 9.4233s
Updating learning rate to 0.0005971441756437378
Validation loss decreased (0.3829 --> 0.3784).  Saving model state dict ...
Epoch: 2 cost time: 0.9487967491149902
Epoch: 2, Steps: 129 | Train Loss: 0.5192435 Vali Loss: 0.3783939 Best vali loss: 0.3783939
	iters: 100, epoch: 3 | loss: 0.4937609
	speed: 0.0120s/iter; left time: 8.1083s
Updating learning rate to 0.0004836612258209287
Epoch: 3 cost time: 0.9718961715698242
Epoch: 3, Steps: 129 | Train Loss: 0.4937609 Vali Loss: 0.3832213 Best vali loss: 0.3783939

best validation loss 0.378393915863543

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0018958878804, 'e_layers': 4, 'learning_rate': 0.0006997653353, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006997653353
Validation loss decreased (inf --> 0.3893).  Saving model state dict ...
Epoch: 1 cost time: 1.3598840236663818
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3892646 Best vali loss: 0.3892646
Updating learning rate to 0.00034988266765
Epoch: 2 cost time: 1.0400078296661377
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3966238 Best vali loss: 0.3892646
Updating learning rate to 0.000174941333825
Validation loss decreased (0.3893 --> 0.3761).  Saving model state dict ...
Epoch: 3 cost time: 1.0395708084106445
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3761298 Best vali loss: 0.3761298

best validation loss 0.3761298469101282

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009821493822, 'e_layers': 4, 'learning_rate': 0.0007026032582, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7390341
	speed: 0.0138s/iter; left time: 12.9038s
Updating learning rate to 0.0006758620139633614
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 1.3096897602081299
Epoch: 1, Steps: 129 | Train Loss: 0.7390341 Vali Loss: 0.3775750 Best vali loss: 0.3775750
	iters: 100, epoch: 2 | loss: 0.4942117
	speed: 0.0118s/iter; left time: 9.4572s
Updating learning rate to 0.0005997093932784914
Validation loss decreased (0.3776 --> 0.3751).  Saving model state dict ...
Epoch: 2 cost time: 0.94673752784729
Epoch: 2, Steps: 129 | Train Loss: 0.4942117 Vali Loss: 0.3750589 Best vali loss: 0.3750589
	iters: 100, epoch: 3 | loss: 0.5281951
	speed: 0.0120s/iter; left time: 8.1001s
Updating learning rate to 0.00048573894231943574
Epoch: 3 cost time: 0.9568665027618408
Epoch: 3, Steps: 129 | Train Loss: 0.5281951 Vali Loss: 0.4009986 Best vali loss: 0.3750589

best validation loss 0.3750588639897307

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009821493822, 'e_layers': 4, 'learning_rate': 0.0007026032582, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7810330
	speed: 0.0142s/iter; left time: 7.7288s
Updating learning rate to 0.0003513016291
Epoch: 4 cost time: 1.3049778938293457
Epoch: 4, Steps: 129 | Train Loss: 0.7810330 Vali Loss: 0.3936360 Best vali loss: 0.3750589
	iters: 100, epoch: 5 | loss: 0.5999889
	speed: 0.0116s/iter; left time: 4.8232s
Updating learning rate to 0.00021686431588056432
Epoch: 5 cost time: 0.9423480033874512
Epoch: 5, Steps: 129 | Train Loss: 0.5999889 Vali Loss: 0.3958833 Best vali loss: 0.3750589
	iters: 100, epoch: 6 | loss: 0.5376640
	speed: 0.0115s/iter; left time: 3.2988s
Updating learning rate to 0.00010289386492150865
Epoch: 6 cost time: 0.948498010635376
Epoch: 6, Steps: 129 | Train Loss: 0.5376640 Vali Loss: 0.3995288 Best vali loss: 0.3750589
	iters: 100, epoch: 7 | loss: 0.6355034
	speed: 0.0115s/iter; left time: 1.8247s
Updating learning rate to 2.6741244236638553e-05
Epoch: 7 cost time: 0.945563793182373
Epoch: 7, Steps: 129 | Train Loss: 0.6355034 Vali Loss: 0.3958971 Best vali loss: 0.3750589
	iters: 100, epoch: 8 | loss: 0.8882971
	speed: 0.0114s/iter; left time: 0.3427s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9451088905334473
Epoch: 8, Steps: 129 | Train Loss: 0.8882971 Vali Loss: 0.3957915 Best vali loss: 0.3750589

best validation loss 0.3750588639897307

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0008094126441, 'e_layers': 4, 'learning_rate': 0.0007014781909, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7096458
	speed: 0.0138s/iter; left time: 12.8464s
Updating learning rate to 0.0007014781909
Validation loss decreased (inf --> 0.3770).  Saving model state dict ...
Epoch: 1 cost time: 1.3298389911651611
Epoch: 1, Steps: 129 | Train Loss: 0.7096458 Vali Loss: 0.3769670 Best vali loss: 0.3769670
	iters: 100, epoch: 2 | loss: 1.0287920
	speed: 0.0124s/iter; left time: 9.9540s
Updating learning rate to 0.00035073909545
Epoch: 2 cost time: 0.9969673156738281
Epoch: 2, Steps: 129 | Train Loss: 1.0287920 Vali Loss: 0.3797453 Best vali loss: 0.3769670
	iters: 100, epoch: 3 | loss: 0.6217294
	speed: 0.0121s/iter; left time: 8.1710s
Updating learning rate to 0.000175369547725
Epoch: 3 cost time: 0.9964642524719238
Epoch: 3, Steps: 129 | Train Loss: 0.6217294 Vali Loss: 0.3855269 Best vali loss: 0.3769670
	iters: 100, epoch: 4 | loss: 0.5872683
	speed: 0.0121s/iter; left time: 6.5906s
Updating learning rate to 8.76847738625e-05
Epoch: 4 cost time: 0.9985699653625488
Epoch: 4, Steps: 129 | Train Loss: 0.5872683 Vali Loss: 0.3853694 Best vali loss: 0.3769670
	iters: 100, epoch: 5 | loss: 0.6958472
	speed: 0.0121s/iter; left time: 5.0500s
Updating learning rate to 4.384238693125e-05
Epoch: 5 cost time: 1.0024290084838867
Epoch: 5, Steps: 129 | Train Loss: 0.6958472 Vali Loss: 0.3888438 Best vali loss: 0.3769670
	iters: 100, epoch: 6 | loss: 0.5343434
	speed: 0.0121s/iter; left time: 3.4840s
Updating learning rate to 2.1921193465625e-05
Epoch: 6 cost time: 1.0057282447814941
Epoch: 6, Steps: 129 | Train Loss: 0.5343434 Vali Loss: 0.3962510 Best vali loss: 0.3769670
	iters: 100, epoch: 7 | loss: 0.7043036
	speed: 0.0120s/iter; left time: 1.9148s
Updating learning rate to 1.09605967328125e-05
Epoch: 7 cost time: 0.996835470199585
Epoch: 7, Steps: 129 | Train Loss: 0.7043036 Vali Loss: 0.3965756 Best vali loss: 0.3769670
	iters: 100, epoch: 8 | loss: 0.5513232
	speed: 0.0121s/iter; left time: 0.3632s
Updating learning rate to 5.48029836640625e-06
Epoch: 8 cost time: 1.0006506443023682
Epoch: 8, Steps: 129 | Train Loss: 0.5513232 Vali Loss: 0.3962215 Best vali loss: 0.3769670

best validation loss 0.3769669713229234

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009535606509, 'e_layers': 4, 'learning_rate': 0.000699878023, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5799167
	speed: 0.0134s/iter; left time: 12.4967s
Updating learning rate to 0.000699878023
Validation loss decreased (inf --> 0.3834).  Saving model state dict ...
Epoch: 1 cost time: 1.2789371013641357
Epoch: 1, Steps: 129 | Train Loss: 0.5799167 Vali Loss: 0.3833865 Best vali loss: 0.3833865
	iters: 100, epoch: 2 | loss: 0.5635874
	speed: 0.0117s/iter; left time: 9.3889s
Updating learning rate to 0.0003499390115
Epoch: 2 cost time: 0.9462442398071289
Epoch: 2, Steps: 129 | Train Loss: 0.5635874 Vali Loss: 0.3842149 Best vali loss: 0.3833865
	iters: 100, epoch: 3 | loss: 0.6502867
	speed: 0.0115s/iter; left time: 7.7421s
Updating learning rate to 0.00017496950575
Validation loss decreased (0.3834 --> 0.3759).  Saving model state dict ...
Epoch: 3 cost time: 0.9416956901550293
Epoch: 3, Steps: 129 | Train Loss: 0.6502867 Vali Loss: 0.3758540 Best vali loss: 0.3758540
	iters: 100, epoch: 4 | loss: 0.3746654
	speed: 0.0118s/iter; left time: 6.4570s
Updating learning rate to 8.7484752875e-05
Epoch: 4 cost time: 0.9379384517669678
Epoch: 4, Steps: 129 | Train Loss: 0.3746654 Vali Loss: 0.3806537 Best vali loss: 0.3758540
	iters: 100, epoch: 5 | loss: 0.5970742
	speed: 0.0114s/iter; left time: 4.7534s
Updating learning rate to 4.37423764375e-05
Epoch: 5 cost time: 0.9345767498016357
Epoch: 5, Steps: 129 | Train Loss: 0.5970742 Vali Loss: 0.3860625 Best vali loss: 0.3758540
	iters: 100, epoch: 6 | loss: 0.5078753
	speed: 0.0114s/iter; left time: 3.2969s
Updating learning rate to 2.187118821875e-05
Epoch: 6 cost time: 0.9395034313201904
Epoch: 6, Steps: 129 | Train Loss: 0.5078753 Vali Loss: 0.3852546 Best vali loss: 0.3758540
	iters: 100, epoch: 7 | loss: 0.6178333
	speed: 0.0114s/iter; left time: 1.8201s
Updating learning rate to 1.0935594109375e-05
Epoch: 7 cost time: 0.9427075386047363
Epoch: 7, Steps: 129 | Train Loss: 0.6178333 Vali Loss: 0.3892310 Best vali loss: 0.3758540
	iters: 100, epoch: 8 | loss: 0.4708673
	speed: 0.0115s/iter; left time: 0.3447s
Updating learning rate to 5.4677970546875e-06
Epoch: 8 cost time: 0.9567685127258301
Epoch: 8, Steps: 129 | Train Loss: 0.4708673 Vali Loss: 0.3947036 Best vali loss: 0.3758540

best validation loss 0.37585402063161777

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001875472275, 'e_layers': 4, 'learning_rate': 0.0007012788476, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007012788476
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.0937728881835938
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706189 Best vali loss: 0.3706189
Updating learning rate to 0.0003506394238
Validation loss decreased (0.3706 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.7801516056060791
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3667520 Best vali loss: 0.3667520
Updating learning rate to 0.0001753197119
Validation loss decreased (0.3668 --> 0.3527).  Saving model state dict ...
Epoch: 3 cost time: 0.7802650928497314
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3526551 Best vali loss: 0.3526551

best validation loss 0.3526550936558392

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0046875553557, 'e_layers': 4, 'learning_rate': 0.0008574476385, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6945369
	speed: 0.0114s/iter; left time: 45.8624s
	iters: 200, epoch: 1 | loss: 0.3747112
	speed: 0.0053s/iter; left time: 20.6633s
	iters: 300, epoch: 1 | loss: 0.3142379
	speed: 0.0053s/iter; left time: 20.0949s
	iters: 400, epoch: 1 | loss: 1.6241606
	speed: 0.0053s/iter; left time: 19.8047s
	iters: 500, epoch: 1 | loss: 0.3449760
	speed: 0.0053s/iter; left time: 19.1046s
Updating learning rate to 0.0008248129809551434
Validation loss decreased (inf --> 0.3974).  Saving model state dict ...
Epoch: 1 cost time: 3.0635268688201904
Epoch: 1, Steps: 514 | Train Loss: 0.6705245 Vali Loss: 0.3973654 Best vali loss: 0.3973654
	iters: 100, epoch: 2 | loss: 0.4965983
	speed: 0.0099s/iter; left time: 34.5198s
	iters: 200, epoch: 2 | loss: 0.7625862
	speed: 0.0048s/iter; left time: 16.4305s
	iters: 300, epoch: 2 | loss: 0.6143805
	speed: 0.0050s/iter; left time: 16.3793s
	iters: 400, epoch: 2 | loss: 0.6817781
	speed: 0.0049s/iter; left time: 15.7287s
	iters: 500, epoch: 2 | loss: 0.3940170
	speed: 0.0048s/iter; left time: 14.8251s
Updating learning rate to 0.0007318773390978706
Epoch: 2 cost time: 2.553478240966797
Epoch: 2, Steps: 514 | Train Loss: 0.5898720 Vali Loss: 0.4021177 Best vali loss: 0.3973654
	iters: 100, epoch: 3 | loss: 0.9223666
	speed: 0.0095s/iter; left time: 28.4312s
	iters: 200, epoch: 3 | loss: 0.3502018
	speed: 0.0049s/iter; left time: 14.1021s
	iters: 300, epoch: 3 | loss: 0.8085968
	speed: 0.0048s/iter; left time: 13.4241s
	iters: 400, epoch: 3 | loss: 1.0084503
	speed: 0.0049s/iter; left time: 13.2768s
	iters: 500, epoch: 3 | loss: 0.7023865
	speed: 0.0050s/iter; left time: 12.8213s
Updating learning rate to 0.0005927893219372603
Epoch: 3 cost time: 2.5613536834716797
Epoch: 3, Steps: 514 | Train Loss: 0.7584004 Vali Loss: 0.4079025 Best vali loss: 0.3973654

best validation loss 0.3973654410928078

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022153666668, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 0.7920694351196289
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3702566 Best vali loss: 0.3702566
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3703 --> 0.3600).  Saving model state dict ...
Epoch: 2 cost time: 0.5046827793121338
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3599671 Best vali loss: 0.3599671
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3600 --> 0.3456).  Saving model state dict ...
Epoch: 3 cost time: 0.49360013008117676
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3455502 Best vali loss: 0.3455502

best validation loss 0.3455502303855124

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022153666668, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.7986176013946533
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3691641 Best vali loss: 0.3455502
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.5048470497131348
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3522907 Best vali loss: 0.3455502
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.4961416721343994
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3593158 Best vali loss: 0.3455502
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.4946422576904297
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3560761 Best vali loss: 0.3455502
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.498610258102417
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3573037 Best vali loss: 0.3455502

best validation loss 0.3455502303855124

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018970741846, 'e_layers': 4, 'learning_rate': 0.0006940081712, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006940081712
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 0.800255537033081
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701739 Best vali loss: 0.3701739
Updating learning rate to 0.0003470040856
Validation loss decreased (0.3702 --> 0.3628).  Saving model state dict ...
Epoch: 2 cost time: 0.49941015243530273
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3627542 Best vali loss: 0.3627542
Updating learning rate to 0.0001735020428
Validation loss decreased (0.3628 --> 0.3462).  Saving model state dict ...
Epoch: 3 cost time: 0.4983506202697754
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3461679 Best vali loss: 0.3461679
Updating learning rate to 8.67510214e-05
Epoch: 4 cost time: 0.4994347095489502
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3487305 Best vali loss: 0.3461679
Updating learning rate to 4.33755107e-05
Epoch: 5 cost time: 0.5022344589233398
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3548238 Best vali loss: 0.3461679
Updating learning rate to 2.168775535e-05
Epoch: 6 cost time: 0.49812817573547363
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3545968 Best vali loss: 0.3461679
Updating learning rate to 1.0843877675e-05
Epoch: 7 cost time: 0.49010372161865234
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3544421 Best vali loss: 0.3461679
Updating learning rate to 5.4219388375e-06
Epoch: 8 cost time: 0.4809575080871582
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3541276 Best vali loss: 0.3461679

best validation loss 0.34616792703190113

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023127490055, 'e_layers': 1, 'learning_rate': 0.0017907228824, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017907228824
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 0.6134836673736572
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3681508 Best vali loss: 0.3681508
Updating learning rate to 0.0008953614412
Epoch: 2 cost time: 0.31426286697387695
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3804318 Best vali loss: 0.3681508
Updating learning rate to 0.0004476807206
Epoch: 3 cost time: 0.3200955390930176
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3799053 Best vali loss: 0.3681508
Updating learning rate to 0.0002238403603
Epoch: 4 cost time: 0.30945682525634766
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4055079 Best vali loss: 0.3681508
Updating learning rate to 0.00011192018015
Epoch: 5 cost time: 0.31145381927490234
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4106643 Best vali loss: 0.3681508
Updating learning rate to 5.5960090075e-05
Epoch: 6 cost time: 0.3126335144042969
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4037768 Best vali loss: 0.3681508
Updating learning rate to 2.79800450375e-05
Epoch: 7 cost time: 0.32190752029418945
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4060499 Best vali loss: 0.3681508
Updating learning rate to 1.399002251875e-05
Epoch: 8 cost time: 0.30500030517578125
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4085922 Best vali loss: 0.3681508

best validation loss 0.3681507827725064

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018682804367, 'e_layers': 4, 'learning_rate': 0.0006987535017, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006987535017
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.1049554347991943
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703689 Best vali loss: 0.3703689
Updating learning rate to 0.00034937675085
Validation loss decreased (0.3704 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 0.7842988967895508
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3623012 Best vali loss: 0.3623012
Updating learning rate to 0.000174688375425
Validation loss decreased (0.3623 --> 0.3515).  Saving model state dict ...
Epoch: 3 cost time: 0.7828443050384521
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3514695 Best vali loss: 0.3514695

best validation loss 0.35146954181386353

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7451047
	speed: 0.0111s/iter; left time: 21.6511s
	iters: 200, epoch: 1 | loss: 0.5367600
	speed: 0.0046s/iter; left time: 8.4858s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.3972).  Saving model state dict ...
Epoch: 1 cost time: 1.5596117973327637
Epoch: 1, Steps: 257 | Train Loss: 0.6409324 Vali Loss: 0.3972260 Best vali loss: 0.3972260
	iters: 100, epoch: 2 | loss: 0.9943453
	speed: 0.0098s/iter; left time: 16.7237s
	iters: 200, epoch: 2 | loss: 0.6705810
	speed: 0.0041s/iter; left time: 6.4924s
Updating learning rate to 0.00164194791575
Epoch: 2 cost time: 1.1347548961639404
Epoch: 2, Steps: 257 | Train Loss: 0.8324632 Vali Loss: 0.4015176 Best vali loss: 0.3972260
	iters: 100, epoch: 3 | loss: 0.6091980
	speed: 0.0088s/iter; left time: 12.7045s
	iters: 200, epoch: 3 | loss: 0.6449847
	speed: 0.0046s/iter; left time: 6.2366s
Updating learning rate to 0.000820973957875
Epoch: 3 cost time: 1.1792361736297607
Epoch: 3, Steps: 257 | Train Loss: 0.6270913 Vali Loss: 0.4037795 Best vali loss: 0.3972260

best validation loss 0.3972259919512248

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018426507898, 'e_layers': 4, 'learning_rate': 0.0006829492962, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006829492962
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 0.8002851009368896
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3698658 Best vali loss: 0.3698658
Updating learning rate to 0.0003414746481
Validation loss decreased (0.3699 --> 0.3573).  Saving model state dict ...
Epoch: 2 cost time: 0.5022563934326172
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3572659 Best vali loss: 0.3572659
Updating learning rate to 0.00017073732405
Validation loss decreased (0.3573 --> 0.3483).  Saving model state dict ...
Epoch: 3 cost time: 0.4977297782897949
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3483134 Best vali loss: 0.3483134

best validation loss 0.3483134499818731

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018426507898, 'e_layers': 4, 'learning_rate': 0.0006829492962, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.5368662025e-05
Epoch: 4 cost time: 0.7950315475463867
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3820393 Best vali loss: 0.3483134
Updating learning rate to 4.26843310125e-05
Epoch: 5 cost time: 0.4942033290863037
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3592159 Best vali loss: 0.3483134
Updating learning rate to 2.134216550625e-05
Epoch: 6 cost time: 0.4959132671356201
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3564808 Best vali loss: 0.3483134
Updating learning rate to 1.0671082753125e-05
Epoch: 7 cost time: 0.47899413108825684
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3544507 Best vali loss: 0.3483134
Updating learning rate to 5.3355413765625e-06
Epoch: 8 cost time: 0.4963243007659912
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3555957 Best vali loss: 0.3483134

best validation loss 0.3483134499818731

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021288197735, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 1.1385586261749268
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3724877 Best vali loss: 0.3724877
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.8274810314178467
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3788929 Best vali loss: 0.3724877
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3725 --> 0.3711).  Saving model state dict ...
Epoch: 3 cost time: 0.8178565502166748
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3711057 Best vali loss: 0.3711057
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3711 --> 0.3488).  Saving model state dict ...
Epoch: 4 cost time: 0.8250539302825928
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3488374 Best vali loss: 0.3488374
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3488 --> 0.3483).  Saving model state dict ...
Epoch: 5 cost time: 0.8208363056182861
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3482778 Best vali loss: 0.3482778
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.8308110237121582
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3513126 Best vali loss: 0.3482778
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.8235795497894287
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3507985 Best vali loss: 0.3482778
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.8256649971008301
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3515378 Best vali loss: 0.3482778

best validation loss 0.348277812856588

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021356072888, 'e_layers': 4, 'learning_rate': 0.0007072769277, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007072769277
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 1.1382124423980713
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3700677 Best vali loss: 0.3700677
Updating learning rate to 0.00035363846385
Epoch: 2 cost time: 0.8194839954376221
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3785624 Best vali loss: 0.3700677
Updating learning rate to 0.000176819231925
Validation loss decreased (0.3701 --> 0.3671).  Saving model state dict ...
Epoch: 3 cost time: 0.8172147274017334
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3671403 Best vali loss: 0.3671403
Updating learning rate to 8.84096159625e-05
Validation loss decreased (0.3671 --> 0.3525).  Saving model state dict ...
Epoch: 4 cost time: 0.8274598121643066
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3524902 Best vali loss: 0.3524902
Updating learning rate to 4.420480798125e-05
Validation loss decreased (0.3525 --> 0.3484).  Saving model state dict ...
Epoch: 5 cost time: 0.8210194110870361
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3483703 Best vali loss: 0.3483703
Updating learning rate to 2.2102403990625e-05
Epoch: 6 cost time: 0.820418119430542
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3504389 Best vali loss: 0.3483703
Updating learning rate to 1.10512019953125e-05
Epoch: 7 cost time: 0.8200726509094238
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3518135 Best vali loss: 0.3483703
Updating learning rate to 5.52560099765625e-06
Epoch: 8 cost time: 0.8174419403076172
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3511058 Best vali loss: 0.3483703

best validation loss 0.3483702599885187

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005459653869797237
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 0.6731524467468262
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3658603 Best vali loss: 0.3658603
Updating learning rate to 0.0004844488434208944
Epoch: 2 cost time: 0.3659355640411377
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3724518 Best vali loss: 0.3658603
Updating learning rate to 0.00039238282983148796
Epoch: 3 cost time: 0.34502482414245605
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3974006 Best vali loss: 0.3658603

best validation loss 0.3658603139851089

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021246718441, 'e_layers': 4, 'learning_rate': 0.000707147843, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000707147843
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.1400372982025146
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695941 Best vali loss: 0.3695941
Updating learning rate to 0.0003535739215
Epoch: 2 cost time: 0.824904203414917
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3887470 Best vali loss: 0.3695941
Updating learning rate to 0.00017678696075
Epoch: 3 cost time: 0.8226993083953857
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3801359 Best vali loss: 0.3695941

best validation loss 0.36959408068469557

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0021466159664, 'e_layers': 4, 'learning_rate': 0.0007061473825, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007061473825
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.135871171951294
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695649 Best vali loss: 0.3695649
Updating learning rate to 0.00035307369125
Epoch: 2 cost time: 0.8190853595733643
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3799427 Best vali loss: 0.3695649
Updating learning rate to 0.000176536845625
Epoch: 3 cost time: 0.8136138916015625
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3751276 Best vali loss: 0.3695649

best validation loss 0.3695649488969964

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002837835622
Validation loss decreased (0.3659 --> 0.3544).  Saving model state dict ...
Epoch: 4 cost time: 0.6512949466705322
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3544132 Best vali loss: 0.3544132
Updating learning rate to 0.00017518429456851207
Validation loss decreased (0.3544 --> 0.3541).  Saving model state dict ...
Epoch: 5 cost time: 0.36548471450805664
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3541284 Best vali loss: 0.3541284
Updating learning rate to 8.311828097910562e-05
Epoch: 6 cost time: 0.36927032470703125
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3583291 Best vali loss: 0.3541284
Updating learning rate to 2.1601737420276337e-05
Epoch: 7 cost time: 0.3690526485443115
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3560620 Best vali loss: 0.3541284
Updating learning rate to 0.0
Epoch: 8 cost time: 0.36855053901672363
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3569647 Best vali loss: 0.3541284

best validation loss 0.3541283998250493

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5544616
	speed: 0.0096s/iter; left time: 18.7186s
	iters: 200, epoch: 1 | loss: 0.5009557
	speed: 0.0028s/iter; left time: 5.2299s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.0867092609405518
Epoch: 1, Steps: 257 | Train Loss: 0.5277086 Vali Loss: 0.3672177 Best vali loss: 0.3672177
	iters: 100, epoch: 2 | loss: 0.3676723
	speed: 0.0068s/iter; left time: 11.4939s
	iters: 200, epoch: 2 | loss: 0.6470698
	speed: 0.0026s/iter; left time: 4.1703s
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 0.720362663269043
Epoch: 2, Steps: 257 | Train Loss: 0.5073711 Vali Loss: 0.3760928 Best vali loss: 0.3672177
	iters: 100, epoch: 3 | loss: 0.3755044
	speed: 0.0066s/iter; left time: 9.4663s
	iters: 200, epoch: 3 | loss: 0.3296528
	speed: 0.0025s/iter; left time: 3.3416s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.6982862949371338
Epoch: 3, Steps: 257 | Train Loss: 0.3525786 Vali Loss: 0.3811423 Best vali loss: 0.3672177
	iters: 100, epoch: 4 | loss: 0.7964024
	speed: 0.0066s/iter; left time: 7.8338s
	iters: 200, epoch: 4 | loss: 0.3865919
	speed: 0.0026s/iter; left time: 2.8575s
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.7264566421508789
Epoch: 4, Steps: 257 | Train Loss: 0.5914972 Vali Loss: 0.3954916 Best vali loss: 0.3672177
	iters: 100, epoch: 5 | loss: 0.8200721
	speed: 0.0064s/iter; left time: 5.9637s
	iters: 200, epoch: 5 | loss: 0.4661587
	speed: 0.0025s/iter; left time: 2.1111s
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.6891956329345703
Epoch: 5, Steps: 257 | Train Loss: 0.6431154 Vali Loss: 0.3993431 Best vali loss: 0.3672177
	iters: 100, epoch: 6 | loss: 0.4263314
	speed: 0.0063s/iter; left time: 4.2228s
	iters: 200, epoch: 6 | loss: 0.4948944
	speed: 0.0025s/iter; left time: 1.4394s
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.7005436420440674
Epoch: 6, Steps: 257 | Train Loss: 0.4606129 Vali Loss: 0.3947825 Best vali loss: 0.3672177
	iters: 100, epoch: 7 | loss: 0.6674499
	speed: 0.0068s/iter; left time: 2.8156s
	iters: 200, epoch: 7 | loss: 0.3283529
	speed: 0.0028s/iter; left time: 0.8815s
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.7783894538879395
Epoch: 7, Steps: 257 | Train Loss: 0.4979014 Vali Loss: 0.3958985 Best vali loss: 0.3672177
	iters: 100, epoch: 8 | loss: 0.6234959
	speed: 0.0069s/iter; left time: 1.0959s
	iters: 200, epoch: 8 | loss: 0.7384665
	speed: 0.0028s/iter; left time: 0.1604s
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.7675511837005615
Epoch: 8, Steps: 257 | Train Loss: 0.6809812 Vali Loss: 0.3956872 Best vali loss: 0.3672177

best validation loss 0.3672177486429046

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4875861
	speed: 0.0125s/iter; left time: 11.6373s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.1788172721862793
Epoch: 1, Steps: 129 | Train Loss: 0.4875861 Vali Loss: 0.3670311 Best vali loss: 0.3670311
	iters: 100, epoch: 2 | loss: 0.5387921
	speed: 0.0102s/iter; left time: 8.2200s
Updating learning rate to 6.252043389458952e-05
Validation loss decreased (0.3670 --> 0.3640).  Saving model state dict ...
Epoch: 2 cost time: 0.8379378318786621
Epoch: 2, Steps: 129 | Train Loss: 0.5387921 Vali Loss: 0.3639807 Best vali loss: 0.3639807
	iters: 100, epoch: 3 | loss: 0.6547741
	speed: 0.0103s/iter; left time: 6.9806s
Updating learning rate to 5.063887571827247e-05
Epoch: 3 cost time: 0.8244624137878418
Epoch: 3, Steps: 129 | Train Loss: 0.6547741 Vali Loss: 0.3663580 Best vali loss: 0.3639807
	iters: 100, epoch: 4 | loss: 0.3765706
	speed: 0.0100s/iter; left time: 5.4688s
Updating learning rate to 3.662362225e-05
Validation loss decreased (0.3640 --> 0.3610).  Saving model state dict ...
Epoch: 4 cost time: 0.8326687812805176
Epoch: 4, Steps: 129 | Train Loss: 0.3765706 Vali Loss: 0.3610437 Best vali loss: 0.3610437
	iters: 100, epoch: 5 | loss: 0.6848922
	speed: 0.0102s/iter; left time: 4.2540s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.3610 --> 0.3596).  Saving model state dict ...
Epoch: 5 cost time: 0.8268511295318604
Epoch: 5, Steps: 129 | Train Loss: 0.6848922 Vali Loss: 0.3595581 Best vali loss: 0.3595581
	iters: 100, epoch: 6 | loss: 0.6535334
	speed: 0.0101s/iter; left time: 2.8979s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.3596 --> 0.3559).  Saving model state dict ...
Epoch: 6 cost time: 0.8234469890594482
Epoch: 6, Steps: 129 | Train Loss: 0.6535334 Vali Loss: 0.3558541 Best vali loss: 0.3558541
	iters: 100, epoch: 7 | loss: 0.4536205
	speed: 0.0102s/iter; left time: 1.6260s
Updating learning rate to 2.7878072468000404e-06
Epoch: 7 cost time: 0.8309323787689209
Epoch: 7, Steps: 129 | Train Loss: 0.4536205 Vali Loss: 0.3578997 Best vali loss: 0.3558541
	iters: 100, epoch: 8 | loss: 0.5048026
	speed: 0.0098s/iter; left time: 0.2925s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8050782680511475
Epoch: 8, Steps: 129 | Train Loss: 0.5048026 Vali Loss: 0.3564688 Best vali loss: 0.3558541

best validation loss 0.3558540641793099

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021224870025, 'e_layers': 4, 'learning_rate': 0.0007127878265, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007127878265
Validation loss decreased (inf --> 0.3815).  Saving model state dict ...
Epoch: 1 cost time: 1.3204028606414795
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3815038 Best vali loss: 0.3815038
Updating learning rate to 0.00035639391325
Epoch: 2 cost time: 1.0161948204040527
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3907332 Best vali loss: 0.3815038
Updating learning rate to 0.000178196956625
Validation loss decreased (0.3815 --> 0.3813).  Saving model state dict ...
Epoch: 3 cost time: 1.0181548595428467
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3812571 Best vali loss: 0.3812571

best validation loss 0.38125713056571825

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002147045428, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007062511586
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.1002585887908936
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712651 Best vali loss: 0.3712651
Updating learning rate to 0.0003531255793
Validation loss decreased (0.3713 --> 0.3570).  Saving model state dict ...
Epoch: 2 cost time: 0.7846710681915283
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3570249 Best vali loss: 0.3570249
Updating learning rate to 0.00017656278965
Validation loss decreased (0.3570 --> 0.3545).  Saving model state dict ...
Epoch: 3 cost time: 0.7843492031097412
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3544567 Best vali loss: 0.3544567

best validation loss 0.35445672162389474

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021900694525, 'e_layers': 4, 'learning_rate': 0.0006923541987, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006923541987
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 1.0987350940704346
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3702731 Best vali loss: 0.3702731
Updating learning rate to 0.00034617709935
Epoch: 2 cost time: 0.7776491641998291
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3785587 Best vali loss: 0.3702731
Updating learning rate to 0.000173088549675
Validation loss decreased (0.3703 --> 0.3663).  Saving model state dict ...
Epoch: 3 cost time: 0.7803013324737549
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3662878 Best vali loss: 0.3662878

best validation loss 0.3662878023734964

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002147045428, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8281394825e-05
Validation loss decreased (0.3545 --> 0.3520).  Saving model state dict ...
Epoch: 4 cost time: 1.0981769561767578
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3519650 Best vali loss: 0.3519650
Updating learning rate to 4.41406974125e-05
Validation loss decreased (0.3520 --> 0.3472).  Saving model state dict ...
Epoch: 5 cost time: 0.7808001041412354
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3471873 Best vali loss: 0.3471873
Updating learning rate to 2.207034870625e-05
Validation loss decreased (0.3472 --> 0.3408).  Saving model state dict ...
Epoch: 6 cost time: 0.7847743034362793
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3408193 Best vali loss: 0.3408193
Updating learning rate to 1.1035174353125e-05
Epoch: 7 cost time: 0.7883167266845703
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3409228 Best vali loss: 0.3408193
Updating learning rate to 5.5175871765625e-06
Epoch: 8 cost time: 0.7820472717285156
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3423201 Best vali loss: 0.3408193

best validation loss 0.340819338450029

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021600298829, 'e_layers': 4, 'learning_rate': 0.0006936464753, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006936464753
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.0959949493408203
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704052 Best vali loss: 0.3704052
Updating learning rate to 0.00034682323765
Validation loss decreased (0.3704 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.782961368560791
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619591 Best vali loss: 0.3619591
Updating learning rate to 0.000173411618825
Validation loss decreased (0.3620 --> 0.3567).  Saving model state dict ...
Epoch: 3 cost time: 0.7856523990631104
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3566664 Best vali loss: 0.3566664
Updating learning rate to 8.67058094125e-05
Validation loss decreased (0.3567 --> 0.3449).  Saving model state dict ...
Epoch: 4 cost time: 0.7854628562927246
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3449018 Best vali loss: 0.3449018
Updating learning rate to 4.335290470625e-05
Validation loss decreased (0.3449 --> 0.3448).  Saving model state dict ...
Epoch: 5 cost time: 0.7839145660400391
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3447777 Best vali loss: 0.3447777
Updating learning rate to 2.1676452353125e-05
Validation loss decreased (0.3448 --> 0.3432).  Saving model state dict ...
Epoch: 6 cost time: 0.7880795001983643
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3431781 Best vali loss: 0.3431781
Updating learning rate to 1.08382261765625e-05
Epoch: 7 cost time: 0.7828633785247803
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3434396 Best vali loss: 0.3431781
Updating learning rate to 5.41911308828125e-06
Validation loss decreased (0.3432 --> 0.3422).  Saving model state dict ...
Epoch: 8 cost time: 0.7809183597564697
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3421912 Best vali loss: 0.3421912

best validation loss 0.34219122603974783

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.1199924945831299
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3671754 Best vali loss: 0.3671754
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3672 --> 0.3639).  Saving model state dict ...
Epoch: 2 cost time: 0.7944128513336182
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3638785 Best vali loss: 0.3638785
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3639 --> 0.3498).  Saving model state dict ...
Epoch: 3 cost time: 0.7902970314025879
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3497826 Best vali loss: 0.3497826
Updating learning rate to 8.8440874725e-05
Validation loss decreased (0.3498 --> 0.3431).  Saving model state dict ...
Epoch: 4 cost time: 0.7879126071929932
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3431148 Best vali loss: 0.3431148
Updating learning rate to 4.42204373625e-05
Validation loss decreased (0.3431 --> 0.3399).  Saving model state dict ...
Epoch: 5 cost time: 0.7969009876251221
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3398738 Best vali loss: 0.3398738
Updating learning rate to 2.211021868125e-05
Epoch: 6 cost time: 0.7972853183746338
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3403891 Best vali loss: 0.3398738
Updating learning rate to 1.1055109340625e-05
Epoch: 7 cost time: 0.8005423545837402
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3407275 Best vali loss: 0.3398738
Updating learning rate to 5.5275546703125e-06
Epoch: 8 cost time: 0.8007628917694092
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3410091 Best vali loss: 0.3398738

best validation loss 0.33987378903128546

[INFO][abstract_intensifier.py:595] Added config 2c41a1 and rejected config 3982a0 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.1227922439575195
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672285 Best vali loss: 0.3672285
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3672 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 0.7956736087799072
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3666451 Best vali loss: 0.3666451
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3666 --> 0.3593).  Saving model state dict ...
Epoch: 3 cost time: 0.796576976776123
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3592936 Best vali loss: 0.3592936

best validation loss 0.359293583111585

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022113636099, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.1095693111419678
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3670131 Best vali loss: 0.3670131
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3670 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 0.7964274883270264
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3635548 Best vali loss: 0.3635548
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3636 --> 0.3569).  Saving model state dict ...
Epoch: 3 cost time: 0.7996640205383301
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3568614 Best vali loss: 0.3568614

best validation loss 0.35686142987961383

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021820938238, 'e_layers': 4, 'learning_rate': 0.0007022396544, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007022396544
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.1029763221740723
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705712 Best vali loss: 0.3705712
Updating learning rate to 0.0003511198272
Epoch: 2 cost time: 0.7823035717010498
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3774933 Best vali loss: 0.3705712
Updating learning rate to 0.0001755599136
Validation loss decreased (0.3706 --> 0.3571).  Saving model state dict ...
Epoch: 3 cost time: 0.7910294532775879
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3571107 Best vali loss: 0.3571107

best validation loss 0.35711071911635706

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022113636099, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3569 --> 0.3446).  Saving model state dict ...
Epoch: 4 cost time: 1.114649772644043
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3446498 Best vali loss: 0.3446498
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3446 --> 0.3438).  Saving model state dict ...
Epoch: 5 cost time: 0.8002855777740479
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3437806 Best vali loss: 0.3437806
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3438 --> 0.3429).  Saving model state dict ...
Epoch: 6 cost time: 0.8035800457000732
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3428556 Best vali loss: 0.3428556
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.8035106658935547
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3449453 Best vali loss: 0.3428556
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.796419620513916
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3450052 Best vali loss: 0.3428556

best validation loss 0.3428555961676337

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6248721
	speed: 0.0119s/iter; left time: 11.1195s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.4114).  Saving model state dict ...
Epoch: 1 cost time: 1.0936050415039062
Epoch: 1, Steps: 129 | Train Loss: 0.6248721 Vali Loss: 0.4114492 Best vali loss: 0.4114492
	iters: 100, epoch: 2 | loss: 0.7707484
	speed: 0.0107s/iter; left time: 8.6173s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.4114 --> 0.3933).  Saving model state dict ...
Epoch: 2 cost time: 0.7461638450622559
Epoch: 2, Steps: 129 | Train Loss: 0.7707484 Vali Loss: 0.3933034 Best vali loss: 0.3933034
	iters: 100, epoch: 3 | loss: 0.4905261
	speed: 0.0094s/iter; left time: 6.3140s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.3933 --> 0.3861).  Saving model state dict ...
Epoch: 3 cost time: 0.787567138671875
Epoch: 3, Steps: 129 | Train Loss: 0.4905261 Vali Loss: 0.3860705 Best vali loss: 0.3860705
	iters: 100, epoch: 4 | loss: 0.6133317
	speed: 0.0091s/iter; left time: 4.9703s
Updating learning rate to 7.5835271e-05
Validation loss decreased (0.3861 --> 0.3824).  Saving model state dict ...
Epoch: 4 cost time: 0.7476828098297119
Epoch: 4, Steps: 129 | Train Loss: 0.6133317 Vali Loss: 0.3823914 Best vali loss: 0.3823914
	iters: 100, epoch: 5 | loss: 0.5903099
	speed: 0.0093s/iter; left time: 3.8740s
Updating learning rate to 4.681436919938325e-05
Validation loss decreased (0.3824 --> 0.3789).  Saving model state dict ...
Epoch: 5 cost time: 0.7688486576080322
Epoch: 5, Steps: 129 | Train Loss: 0.5903099 Vali Loss: 0.3789114 Best vali loss: 0.3789114
	iters: 100, epoch: 6 | loss: 0.5988478
	speed: 0.0093s/iter; left time: 2.6839s
Updating learning rate to 2.221163662278047e-05
Validation loss decreased (0.3789 --> 0.3773).  Saving model state dict ...
Epoch: 6 cost time: 0.7826356887817383
Epoch: 6, Steps: 129 | Train Loss: 0.5988478 Vali Loss: 0.3773116 Best vali loss: 0.3773116
	iters: 100, epoch: 7 | loss: 0.7764522
	speed: 0.0096s/iter; left time: 1.5197s
Updating learning rate to 5.772616280653259e-06
Validation loss decreased (0.3773 --> 0.3772).  Saving model state dict ...
Epoch: 7 cost time: 0.7829015254974365
Epoch: 7, Steps: 129 | Train Loss: 0.7764522 Vali Loss: 0.3772444 Best vali loss: 0.3772444
	iters: 100, epoch: 8 | loss: 0.5245847
	speed: 0.0092s/iter; left time: 0.2760s
Updating learning rate to 0.0
Validation loss decreased (0.3772 --> 0.3772).  Saving model state dict ...
Epoch: 8 cost time: 0.7527589797973633
Epoch: 8, Steps: 129 | Train Loss: 0.5245847 Vali Loss: 0.3771712 Best vali loss: 0.3771712

best validation loss 0.3771712264401037

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022148478063, 'e_layers': 4, 'learning_rate': 0.0007099814236, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007099814236
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.1226580142974854
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713002 Best vali loss: 0.3713002
Updating learning rate to 0.0003549907118
Epoch: 2 cost time: 0.7841620445251465
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3715788 Best vali loss: 0.3713002
Updating learning rate to 0.0001774953559
Validation loss decreased (0.3713 --> 0.3590).  Saving model state dict ...
Epoch: 3 cost time: 0.7750232219696045
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3589733 Best vali loss: 0.3589733
Updating learning rate to 8.874767795e-05
Validation loss decreased (0.3590 --> 0.3505).  Saving model state dict ...
Epoch: 4 cost time: 0.7823185920715332
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3505157 Best vali loss: 0.3505157
Updating learning rate to 4.4373838975e-05
Validation loss decreased (0.3505 --> 0.3503).  Saving model state dict ...
Epoch: 5 cost time: 0.785804271697998
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3502944 Best vali loss: 0.3502944
Updating learning rate to 2.21869194875e-05
Validation loss decreased (0.3503 --> 0.3479).  Saving model state dict ...
Epoch: 6 cost time: 0.7803654670715332
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3479457 Best vali loss: 0.3479457
Updating learning rate to 1.109345974375e-05
Validation loss decreased (0.3479 --> 0.3470).  Saving model state dict ...
Epoch: 7 cost time: 0.7796351909637451
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3470460 Best vali loss: 0.3470460
Updating learning rate to 5.546729871875e-06
Epoch: 8 cost time: 0.7850213050842285
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3471499 Best vali loss: 0.3470460

best validation loss 0.34704600235333843

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019818485425, 'e_layers': 4, 'learning_rate': 0.0006981129582, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006981129582
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.8047373294830322
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709277 Best vali loss: 0.3709277
Updating learning rate to 0.0003490564791
Epoch: 2 cost time: 0.4479050636291504
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3725683 Best vali loss: 0.3709277
Updating learning rate to 0.00017452823955
Validation loss decreased (0.3709 --> 0.3674).  Saving model state dict ...
Epoch: 3 cost time: 0.44692349433898926
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3674426 Best vali loss: 0.3674426

best validation loss 0.3674426113926826

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019377642425, 'e_layers': 4, 'learning_rate': 0.0006987535017, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006987535017
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.814215898513794
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709170 Best vali loss: 0.3709170
Updating learning rate to 0.00034937675085
Epoch: 2 cost time: 0.4502420425415039
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3725963 Best vali loss: 0.3709170
Updating learning rate to 0.000174688375425
Validation loss decreased (0.3709 --> 0.3675).  Saving model state dict ...
Epoch: 3 cost time: 0.4445955753326416
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3674571 Best vali loss: 0.3674571

best validation loss 0.36745707705353475

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.001957774134, 'e_layers': 4, 'learning_rate': 0.0007003872792, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007003872792
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.8027231693267822
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708925 Best vali loss: 0.3708925
Updating learning rate to 0.0003501936396
Epoch: 2 cost time: 0.485609769821167
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3726112 Best vali loss: 0.3708925
Updating learning rate to 0.0001750968198
Validation loss decreased (0.3709 --> 0.3674).  Saving model state dict ...
Epoch: 3 cost time: 0.4891207218170166
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3674145 Best vali loss: 0.3674145

best validation loss 0.36741448173588526

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.001957774134, 'e_layers': 4, 'learning_rate': 0.0007003872792, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.75484099e-05
Epoch: 4 cost time: 0.7700545787811279
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3703057 Best vali loss: 0.3674145
Updating learning rate to 4.377420495e-05
Epoch: 5 cost time: 0.4583890438079834
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3725963 Best vali loss: 0.3674145
Updating learning rate to 2.1887102475e-05
Epoch: 6 cost time: 0.4442582130432129
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3721166 Best vali loss: 0.3674145
Updating learning rate to 1.09435512375e-05
Epoch: 7 cost time: 0.4834902286529541
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3723729 Best vali loss: 0.3674145
Updating learning rate to 5.47177561875e-06
Epoch: 8 cost time: 0.4663395881652832
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3727114 Best vali loss: 0.3674145

best validation loss 0.36741448173588526

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0020059726405, 'e_layers': 4, 'learning_rate': 0.0007012788476, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007012788476
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.788140058517456
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708803 Best vali loss: 0.3708803
Updating learning rate to 0.0003506394238
Epoch: 2 cost time: 0.45534729957580566
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3725599 Best vali loss: 0.3708803
Updating learning rate to 0.0001753197119
Validation loss decreased (0.3709 --> 0.3674).  Saving model state dict ...
Epoch: 3 cost time: 0.45398592948913574
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3674050 Best vali loss: 0.3674050
Updating learning rate to 8.765985595e-05
Epoch: 4 cost time: 0.47808218002319336
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3705573 Best vali loss: 0.3674050
Updating learning rate to 4.3829927975e-05
Epoch: 5 cost time: 0.45223450660705566
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3727262 Best vali loss: 0.3674050
Updating learning rate to 2.19149639875e-05
Epoch: 6 cost time: 0.45725035667419434
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3721734 Best vali loss: 0.3674050
Updating learning rate to 1.095748199375e-05
Epoch: 7 cost time: 0.468386173248291
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3726536 Best vali loss: 0.3674050
Updating learning rate to 5.478740996875e-06
Epoch: 8 cost time: 0.47309136390686035
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3726410 Best vali loss: 0.3674050

best validation loss 0.36740502979760087

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5810200
	speed: 0.0114s/iter; left time: 45.5771s
	iters: 200, epoch: 1 | loss: 0.3955505
	speed: 0.0052s/iter; left time: 20.5051s
	iters: 300, epoch: 1 | loss: 0.5375656
	speed: 0.0053s/iter; left time: 20.2832s
	iters: 400, epoch: 1 | loss: 0.6689172
	speed: 0.0053s/iter; left time: 19.8580s
	iters: 500, epoch: 1 | loss: 0.6420273
	speed: 0.0053s/iter; left time: 19.1223s
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.4011).  Saving model state dict ...
Epoch: 1 cost time: 3.0819616317749023
Epoch: 1, Steps: 514 | Train Loss: 0.5650161 Vali Loss: 0.4010683 Best vali loss: 0.4010683
	iters: 100, epoch: 2 | loss: 0.3985245
	speed: 0.0105s/iter; left time: 36.6215s
	iters: 200, epoch: 2 | loss: 0.6034917
	speed: 0.0053s/iter; left time: 17.9446s
	iters: 300, epoch: 2 | loss: 1.0919145
	speed: 0.0053s/iter; left time: 17.3822s
	iters: 400, epoch: 2 | loss: 0.3252397
	speed: 0.0050s/iter; left time: 16.0623s
	iters: 500, epoch: 2 | loss: 0.3564830
	speed: 0.0048s/iter; left time: 15.0187s
Updating learning rate to 0.0003537634989
Validation loss decreased (0.4011 --> 0.4010).  Saving model state dict ...
Epoch: 2 cost time: 2.6838159561157227
Epoch: 2, Steps: 514 | Train Loss: 0.5551307 Vali Loss: 0.4009771 Best vali loss: 0.4009771
	iters: 100, epoch: 3 | loss: 0.8049909
	speed: 0.0106s/iter; left time: 31.7104s
	iters: 200, epoch: 3 | loss: 0.7573476
	speed: 0.0052s/iter; left time: 15.1165s
	iters: 300, epoch: 3 | loss: 1.0709623
	speed: 0.0052s/iter; left time: 14.3735s
	iters: 400, epoch: 3 | loss: 0.4364155
	speed: 0.0049s/iter; left time: 13.1863s
	iters: 500, epoch: 3 | loss: 0.3653964
	speed: 0.0049s/iter; left time: 12.7133s
Updating learning rate to 0.00017688174945
Epoch: 3 cost time: 2.6639602184295654
Epoch: 3, Steps: 514 | Train Loss: 0.6870226 Vali Loss: 0.4022873 Best vali loss: 0.4009771
	iters: 100, epoch: 4 | loss: 0.9005347
	speed: 0.0098s/iter; left time: 24.2381s
	iters: 200, epoch: 4 | loss: 0.9355817
	speed: 0.0049s/iter; left time: 11.5538s
	iters: 300, epoch: 4 | loss: 0.4305929
	speed: 0.0048s/iter; left time: 10.9895s
	iters: 400, epoch: 4 | loss: 0.3624233
	speed: 0.0048s/iter; left time: 10.5244s
	iters: 500, epoch: 4 | loss: 1.2812568
	speed: 0.0050s/iter; left time: 10.3353s
Updating learning rate to 8.8440874725e-05
Validation loss decreased (0.4010 --> 0.4007).  Saving model state dict ...
Epoch: 4 cost time: 2.5504021644592285
Epoch: 4, Steps: 514 | Train Loss: 0.7820779 Vali Loss: 0.4006878 Best vali loss: 0.4006878
	iters: 100, epoch: 5 | loss: 0.9104397
	speed: 0.0104s/iter; left time: 20.2682s
	iters: 200, epoch: 5 | loss: 0.8655000
	speed: 0.0050s/iter; left time: 9.2754s
	iters: 300, epoch: 5 | loss: 0.4737337
	speed: 0.0048s/iter; left time: 8.4224s
	iters: 400, epoch: 5 | loss: 0.5962209
	speed: 0.0049s/iter; left time: 8.1741s
	iters: 500, epoch: 5 | loss: 0.4921687
	speed: 0.0049s/iter; left time: 7.6752s
Updating learning rate to 4.42204373625e-05
Epoch: 5 cost time: 2.5968456268310547
Epoch: 5, Steps: 514 | Train Loss: 0.6676126 Vali Loss: 0.4013568 Best vali loss: 0.4006878
	iters: 100, epoch: 6 | loss: 0.9753219
	speed: 0.0099s/iter; left time: 14.2902s
	iters: 200, epoch: 6 | loss: 0.9534564
	speed: 0.0049s/iter; left time: 6.6400s
	iters: 300, epoch: 6 | loss: 0.5543671
	speed: 0.0049s/iter; left time: 6.0969s
	iters: 400, epoch: 6 | loss: 0.5362445
	speed: 0.0049s/iter; left time: 5.5823s
	iters: 500, epoch: 6 | loss: 0.6995856
	speed: 0.0049s/iter; left time: 5.1031s
Updating learning rate to 2.211021868125e-05
Validation loss decreased (0.4007 --> 0.3995).  Saving model state dict ...
Epoch: 6 cost time: 2.566991090774536
Epoch: 6, Steps: 514 | Train Loss: 0.7437951 Vali Loss: 0.3994794 Best vali loss: 0.3994794
	iters: 100, epoch: 7 | loss: 0.5503121
	speed: 0.0106s/iter; left time: 9.8608s
	iters: 200, epoch: 7 | loss: 0.9730169
	speed: 0.0052s/iter; left time: 4.2896s
	iters: 300, epoch: 7 | loss: 1.0358987
	speed: 0.0051s/iter; left time: 3.6875s
	iters: 400, epoch: 7 | loss: 0.5713886
	speed: 0.0051s/iter; left time: 3.2187s
	iters: 500, epoch: 7 | loss: 0.4547144
	speed: 0.0051s/iter; left time: 2.6964s
Updating learning rate to 1.1055109340625e-05
Validation loss decreased (0.3995 --> 0.3986).  Saving model state dict ...
Epoch: 7 cost time: 2.6857895851135254
Epoch: 7, Steps: 514 | Train Loss: 0.7170661 Vali Loss: 0.3985525 Best vali loss: 0.3985525
	iters: 100, epoch: 8 | loss: 1.0778353
	speed: 0.0108s/iter; left time: 4.4925s
	iters: 200, epoch: 8 | loss: 0.4404387
	speed: 0.0053s/iter; left time: 1.6604s
	iters: 300, epoch: 8 | loss: 0.7147221
	speed: 0.0053s/iter; left time: 1.1489s
	iters: 400, epoch: 8 | loss: 0.7170646
	speed: 0.0052s/iter; left time: 0.6019s
	iters: 500, epoch: 8 | loss: 0.4599731
	speed: 0.0052s/iter; left time: 0.0776s
Updating learning rate to 5.5275546703125e-06
Validation loss decreased (0.3986 --> 0.3981).  Saving model state dict ...
Epoch: 8 cost time: 2.7486019134521484
Epoch: 8, Steps: 514 | Train Loss: 0.6820068 Vali Loss: 0.3981307 Best vali loss: 0.3981307

best validation loss 0.39813065886321847

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022138611302, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5807186
	speed: 0.0112s/iter; left time: 44.9234s
	iters: 200, epoch: 1 | loss: 0.3989402
	speed: 0.0054s/iter; left time: 21.0791s
	iters: 300, epoch: 1 | loss: 0.5289483
	speed: 0.0054s/iter; left time: 20.4944s
	iters: 400, epoch: 1 | loss: 0.6693538
	speed: 0.0053s/iter; left time: 19.8377s
	iters: 500, epoch: 1 | loss: 0.6381270
	speed: 0.0053s/iter; left time: 19.1903s
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.4021).  Saving model state dict ...
Epoch: 1 cost time: 3.0905051231384277
Epoch: 1, Steps: 514 | Train Loss: 0.5632176 Vali Loss: 0.4020839 Best vali loss: 0.4020839
	iters: 100, epoch: 2 | loss: 0.3990595
	speed: 0.0103s/iter; left time: 36.1419s
	iters: 200, epoch: 2 | loss: 0.6030464
	speed: 0.0052s/iter; left time: 17.8098s
	iters: 300, epoch: 2 | loss: 1.0913655
	speed: 0.0053s/iter; left time: 17.3999s
	iters: 400, epoch: 2 | loss: 0.3255897
	speed: 0.0053s/iter; left time: 17.0788s
	iters: 500, epoch: 2 | loss: 0.3563081
	speed: 0.0051s/iter; left time: 15.9492s
Updating learning rate to 0.00035351260405
Validation loss decreased (0.4021 --> 0.4011).  Saving model state dict ...
Epoch: 2 cost time: 2.735238552093506
Epoch: 2, Steps: 514 | Train Loss: 0.5550738 Vali Loss: 0.4010859 Best vali loss: 0.4010859
	iters: 100, epoch: 3 | loss: 0.8007520
	speed: 0.0105s/iter; left time: 31.4184s
	iters: 200, epoch: 3 | loss: 0.7574215
	speed: 0.0053s/iter; left time: 15.1900s
	iters: 300, epoch: 3 | loss: 1.0699242
	speed: 0.0050s/iter; left time: 13.8858s
	iters: 400, epoch: 3 | loss: 0.4367671
	speed: 0.0052s/iter; left time: 13.8721s
	iters: 500, epoch: 3 | loss: 0.3665559
	speed: 0.0051s/iter; left time: 13.1562s
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 2.6802802085876465
Epoch: 3, Steps: 514 | Train Loss: 0.6862841 Vali Loss: 0.4041999 Best vali loss: 0.4010859

best validation loss 0.4010859242064077

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019309397163, 'e_layers': 4, 'learning_rate': 0.0007016303053, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007016303053
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.7802150249481201
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708756 Best vali loss: 0.3708756
Updating learning rate to 0.00035081515265
Epoch: 2 cost time: 0.4507558345794678
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3725738 Best vali loss: 0.3708756
Updating learning rate to 0.000175407576325
Validation loss decreased (0.3709 --> 0.3674).  Saving model state dict ...
Epoch: 3 cost time: 0.44856786727905273
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3673952 Best vali loss: 0.3673952

best validation loss 0.3673952118118526

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7148471
	speed: 0.0103s/iter; left time: 20.2478s
	iters: 200, epoch: 1 | loss: 0.7124249
	speed: 0.0045s/iter; left time: 8.4182s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.4848811626434326
Epoch: 1, Steps: 257 | Train Loss: 0.7136360 Vali Loss: 0.3734035 Best vali loss: 0.3734035
	iters: 100, epoch: 2 | loss: 0.5078289
	speed: 0.0095s/iter; left time: 16.1339s
	iters: 200, epoch: 2 | loss: 0.3638742
	speed: 0.0046s/iter; left time: 7.4005s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.3734 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 1.2173702716827393
Epoch: 2, Steps: 257 | Train Loss: 0.4358515 Vali Loss: 0.3635688 Best vali loss: 0.3635688
	iters: 100, epoch: 3 | loss: 0.5455037
	speed: 0.0095s/iter; left time: 13.6866s
	iters: 200, epoch: 3 | loss: 0.6350930
	speed: 0.0040s/iter; left time: 5.3811s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 1.1001696586608887
Epoch: 3, Steps: 257 | Train Loss: 0.5902984 Vali Loss: 0.3655377 Best vali loss: 0.3635688

best validation loss 0.3635688483715057

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6187267
	speed: 0.0108s/iter; left time: 12.7677s
	iters: 200, epoch: 4 | loss: 0.6448041
	speed: 0.0047s/iter; left time: 5.1058s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 1.5406265258789062
Epoch: 4, Steps: 257 | Train Loss: 0.6317654 Vali Loss: 0.3641419 Best vali loss: 0.3635688
	iters: 100, epoch: 5 | loss: 0.5009366
	speed: 0.0096s/iter; left time: 8.9504s
	iters: 200, epoch: 5 | loss: 0.3617215
	speed: 0.0045s/iter; left time: 3.6912s
Updating learning rate to 3.3224917040731837e-05
Validation loss decreased (0.3636 --> 0.3595).  Saving model state dict ...
Epoch: 5 cost time: 1.1834242343902588
Epoch: 5, Steps: 257 | Train Loss: 0.4313290 Vali Loss: 0.3595196 Best vali loss: 0.3595196
	iters: 100, epoch: 6 | loss: 0.5316986
	speed: 0.0093s/iter; left time: 6.2261s
	iters: 200, epoch: 6 | loss: 0.6110383
	speed: 0.0043s/iter; left time: 2.4659s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 1.177551031112671
Epoch: 6, Steps: 257 | Train Loss: 0.5713685 Vali Loss: 0.3613649 Best vali loss: 0.3595196
	iters: 100, epoch: 7 | loss: 0.7603070
	speed: 0.0094s/iter; left time: 3.9106s
	iters: 200, epoch: 7 | loss: 0.5802144
	speed: 0.0044s/iter; left time: 1.3867s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 1.1728904247283936
Epoch: 7, Steps: 257 | Train Loss: 0.6702607 Vali Loss: 0.3602670 Best vali loss: 0.3595196
	iters: 100, epoch: 8 | loss: 0.4012331
	speed: 0.0092s/iter; left time: 1.4584s
	iters: 200, epoch: 8 | loss: 0.6620668
	speed: 0.0043s/iter; left time: 0.2466s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1290724277496338
Epoch: 8, Steps: 257 | Train Loss: 0.5316500 Vali Loss: 0.3609883 Best vali loss: 0.3595196

best validation loss 0.35951955162705984

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022132142527, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007062511586
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.1113245487213135
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711886 Best vali loss: 0.3711886
Updating learning rate to 0.0003531255793
Validation loss decreased (0.3712 --> 0.3635).  Saving model state dict ...
Epoch: 2 cost time: 0.7811770439147949
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3634834 Best vali loss: 0.3634834
Updating learning rate to 0.00017656278965
Validation loss decreased (0.3635 --> 0.3591).  Saving model state dict ...
Epoch: 3 cost time: 0.7744898796081543
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3590869 Best vali loss: 0.3590869
Updating learning rate to 8.8281394825e-05
Validation loss decreased (0.3591 --> 0.3516).  Saving model state dict ...
Epoch: 4 cost time: 0.7792832851409912
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3515576 Best vali loss: 0.3515576
Updating learning rate to 4.41406974125e-05
Validation loss decreased (0.3516 --> 0.3491).  Saving model state dict ...
Epoch: 5 cost time: 0.7776095867156982
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3490832 Best vali loss: 0.3490832
Updating learning rate to 2.207034870625e-05
Validation loss decreased (0.3491 --> 0.3474).  Saving model state dict ...
Epoch: 6 cost time: 0.7819461822509766
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3473604 Best vali loss: 0.3473604
Updating learning rate to 1.1035174353125e-05
Epoch: 7 cost time: 0.776580810546875
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3496653 Best vali loss: 0.3473604
Updating learning rate to 5.5175871765625e-06
Validation loss decreased (0.3474 --> 0.3467).  Saving model state dict ...
Epoch: 8 cost time: 0.7758660316467285
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3466807 Best vali loss: 0.3466807

best validation loss 0.34668074287693723

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022137879088, 'e_layers': 4, 'learning_rate': 0.000706568897, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000706568897
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.0951848030090332
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713391 Best vali loss: 0.3713391
Updating learning rate to 0.0003532844485
Validation loss decreased (0.3713 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 0.7746214866638184
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3665718 Best vali loss: 0.3665718
Updating learning rate to 0.00017664222425
Validation loss decreased (0.3666 --> 0.3506).  Saving model state dict ...
Epoch: 3 cost time: 0.778327226638794
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3506272 Best vali loss: 0.3506272
Updating learning rate to 8.8321112125e-05
Validation loss decreased (0.3506 --> 0.3423).  Saving model state dict ...
Epoch: 4 cost time: 0.7848803997039795
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3422838 Best vali loss: 0.3422838
Updating learning rate to 4.41605560625e-05
Epoch: 5 cost time: 0.7821831703186035
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3484950 Best vali loss: 0.3422838
Updating learning rate to 2.208027803125e-05
Epoch: 6 cost time: 0.7762966156005859
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3460492 Best vali loss: 0.3422838
Updating learning rate to 1.1040139015625e-05
Epoch: 7 cost time: 0.7803716659545898
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3460504 Best vali loss: 0.3422838
Updating learning rate to 5.5200695078125e-06
Epoch: 8 cost time: 0.7887675762176514
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3463020 Best vali loss: 0.3422838

best validation loss 0.3422837757994009

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0022131613027, 'e_layers': 1, 'learning_rate': 0.0002585021946, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002585021946
Validation loss decreased (inf --> 0.3636).  Saving model state dict ...
Epoch: 1 cost time: 0.6188676357269287
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3636071 Best vali loss: 0.3636071
Updating learning rate to 0.0001292510973
Epoch: 2 cost time: 0.31021642684936523
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3671231 Best vali loss: 0.3636071
Updating learning rate to 6.462554865e-05
Epoch: 3 cost time: 0.3309593200683594
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3708640 Best vali loss: 0.3636071

best validation loss 0.3636071250340325

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022123602337, 'e_layers': 1, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 0.6163370609283447
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3685589 Best vali loss: 0.3685589
Updating learning rate to 0.0003537634989
Epoch: 2 cost time: 0.3228127956390381
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3712517 Best vali loss: 0.3685589
Updating learning rate to 0.00017688174945
Epoch: 3 cost time: 0.3368558883666992
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3885817 Best vali loss: 0.3685589

best validation loss 0.368558931268737

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.1041574478149414
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712412 Best vali loss: 0.3712412
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3712 --> 0.3613).  Saving model state dict ...
Epoch: 2 cost time: 0.7757148742675781
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3612827 Best vali loss: 0.3612827
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3613 --> 0.3519).  Saving model state dict ...
Epoch: 3 cost time: 0.7812166213989258
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3518631 Best vali loss: 0.3518631

best validation loss 0.3518631190705627

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3519 --> 0.3415).  Saving model state dict ...
Epoch: 4 cost time: 1.0958383083343506
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3415454 Best vali loss: 0.3415454
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3415 --> 0.3415).  Saving model state dict ...
Epoch: 5 cost time: 0.7831077575683594
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3414953 Best vali loss: 0.3414953
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3415 --> 0.3341).  Saving model state dict ...
Epoch: 6 cost time: 0.7790148258209229
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3340937 Best vali loss: 0.3340937
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7802720069885254
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3346686 Best vali loss: 0.3340937
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7711377143859863
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3366726 Best vali loss: 0.3340937

best validation loss 0.3340936536990355

[INFO][abstract_intensifier.py:595] Added config e3885b and rejected config 2c41a1 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 0.801194429397583
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669169 Best vali loss: 0.3669169
Updating learning rate to 0.0005975820137081337
Validation loss decreased (0.3669 --> 0.3614).  Saving model state dict ...
Epoch: 2 cost time: 0.5052967071533203
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3614463 Best vali loss: 0.3614463
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.4951286315917969
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3665489 Best vali loss: 0.3614463
Updating learning rate to 0.000350055439
Epoch: 4 cost time: 0.5023810863494873
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3747068 Best vali loss: 0.3614463
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.3614 --> 0.3525).  Saving model state dict ...
Epoch: 5 cost time: 0.48752284049987793
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3524894 Best vali loss: 0.3524894
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.48795628547668457
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3557784 Best vali loss: 0.3524894
Updating learning rate to 2.6646383663646746e-05
Epoch: 7 cost time: 0.4885752201080322
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3586022 Best vali loss: 0.3524894
Updating learning rate to 0.0
Epoch: 8 cost time: 0.491713285446167
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3538655 Best vali loss: 0.3524894

best validation loss 0.35248937508446293

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4483611
	speed: 0.0111s/iter; left time: 89.9141s
	iters: 200, epoch: 1 | loss: 0.3075066
	speed: 0.0050s/iter; left time: 40.1676s
	iters: 300, epoch: 1 | loss: 0.2333665
	speed: 0.0050s/iter; left time: 39.5017s
	iters: 400, epoch: 1 | loss: 1.1574903
	speed: 0.0050s/iter; left time: 39.1652s
	iters: 500, epoch: 1 | loss: 0.2455897
	speed: 0.0050s/iter; left time: 38.9629s
	iters: 600, epoch: 1 | loss: 0.6157740
	speed: 0.0050s/iter; left time: 38.0627s
	iters: 700, epoch: 1 | loss: 1.1975372
	speed: 0.0050s/iter; left time: 37.4351s
	iters: 800, epoch: 1 | loss: 0.5250953
	speed: 0.0050s/iter; left time: 37.1784s
	iters: 900, epoch: 1 | loss: 0.8515900
	speed: 0.0050s/iter; left time: 36.6573s
	iters: 1000, epoch: 1 | loss: 0.9864082
	speed: 0.0050s/iter; left time: 36.1745s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 5.480733871459961
Epoch: 1, Steps: 1027 | Train Loss: 0.6568719 Vali Loss: 0.3708296 Best vali loss: 0.3708296
	iters: 100, epoch: 2 | loss: 0.7100091
	speed: 0.0128s/iter; left time: 91.0700s
	iters: 200, epoch: 2 | loss: 0.4996687
	speed: 0.0050s/iter; left time: 35.0376s
	iters: 300, epoch: 2 | loss: 0.9346297
	speed: 0.0050s/iter; left time: 34.4019s
	iters: 400, epoch: 2 | loss: 1.0053335
	speed: 0.0050s/iter; left time: 33.7324s
	iters: 500, epoch: 2 | loss: 0.4633304
	speed: 0.0050s/iter; left time: 33.4669s
	iters: 600, epoch: 2 | loss: 0.3447898
	speed: 0.0050s/iter; left time: 32.9942s
	iters: 700, epoch: 2 | loss: 0.2551934
	speed: 0.0050s/iter; left time: 32.4007s
	iters: 800, epoch: 2 | loss: 0.3418238
	speed: 0.0050s/iter; left time: 31.9351s
	iters: 900, epoch: 2 | loss: 0.2879581
	speed: 0.0050s/iter; left time: 31.4606s
	iters: 1000, epoch: 2 | loss: 1.2794007
	speed: 0.0050s/iter; left time: 30.9321s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.3708 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 5.175151109695435
Epoch: 2, Steps: 1027 | Train Loss: 0.6122137 Vali Loss: 0.3691413 Best vali loss: 0.3691413
	iters: 100, epoch: 3 | loss: 0.7053914
	speed: 0.0130s/iter; left time: 78.8951s
	iters: 200, epoch: 3 | loss: 0.6453400
	speed: 0.0049s/iter; left time: 29.4565s
	iters: 300, epoch: 3 | loss: 0.2569985
	speed: 0.0050s/iter; left time: 29.2632s
	iters: 400, epoch: 3 | loss: 0.1963135
	speed: 0.0050s/iter; left time: 28.7605s
	iters: 500, epoch: 3 | loss: 1.1672274
	speed: 0.0050s/iter; left time: 28.2674s
	iters: 600, epoch: 3 | loss: 0.3859089
	speed: 0.0050s/iter; left time: 27.7558s
	iters: 700, epoch: 3 | loss: 0.1898936
	speed: 0.0049s/iter; left time: 26.6361s
	iters: 800, epoch: 3 | loss: 0.2490687
	speed: 0.0048s/iter; left time: 25.9515s
	iters: 900, epoch: 3 | loss: 0.2782202
	speed: 0.0048s/iter; left time: 25.4119s
	iters: 1000, epoch: 3 | loss: 1.8799696
	speed: 0.0048s/iter; left time: 24.5301s
Updating learning rate to 0.0004164486617318853
Epoch: 3 cost time: 5.090809345245361
Epoch: 3, Steps: 1027 | Train Loss: 0.5954332 Vali Loss: 0.3709889 Best vali loss: 0.3691413
	iters: 100, epoch: 4 | loss: 0.2653679
	speed: 0.0127s/iter; left time: 64.1362s
	iters: 200, epoch: 4 | loss: 0.8833382
	speed: 0.0050s/iter; left time: 24.5381s
	iters: 300, epoch: 4 | loss: 0.2823725
	speed: 0.0050s/iter; left time: 24.1417s
	iters: 400, epoch: 4 | loss: 0.2022163
	speed: 0.0050s/iter; left time: 23.7084s
	iters: 500, epoch: 4 | loss: 0.9222676
	speed: 0.0050s/iter; left time: 23.3242s
	iters: 600, epoch: 4 | loss: 0.8633955
	speed: 0.0050s/iter; left time: 22.5984s
	iters: 700, epoch: 4 | loss: 0.9117544
	speed: 0.0050s/iter; left time: 22.2550s
	iters: 800, epoch: 4 | loss: 0.5115418
	speed: 0.0050s/iter; left time: 21.6209s
	iters: 900, epoch: 4 | loss: 1.3023152
	speed: 0.0050s/iter; left time: 21.1540s
	iters: 1000, epoch: 4 | loss: 0.3551753
	speed: 0.0050s/iter; left time: 20.6124s
Updating learning rate to 0.0003011887262
Epoch: 4 cost time: 5.1685967445373535
Epoch: 4, Steps: 1027 | Train Loss: 0.6499745 Vali Loss: 0.3891839 Best vali loss: 0.3691413
	iters: 100, epoch: 5 | loss: 0.7249858
	speed: 0.0127s/iter; left time: 51.1046s
	iters: 200, epoch: 5 | loss: 0.5188052
	speed: 0.0050s/iter; left time: 19.5475s
	iters: 300, epoch: 5 | loss: 0.2776428
	speed: 0.0050s/iter; left time: 19.0202s
	iters: 400, epoch: 5 | loss: 1.2504812
	speed: 0.0050s/iter; left time: 18.5123s
	iters: 500, epoch: 5 | loss: 0.6644547
	speed: 0.0050s/iter; left time: 17.9595s
	iters: 600, epoch: 5 | loss: 0.2507931
	speed: 0.0050s/iter; left time: 17.3795s
	iters: 700, epoch: 5 | loss: 0.5147463
	speed: 0.0050s/iter; left time: 16.9948s
	iters: 800, epoch: 5 | loss: 0.9440413
	speed: 0.0050s/iter; left time: 16.5894s
	iters: 900, epoch: 5 | loss: 0.3235897
	speed: 0.0050s/iter; left time: 16.0457s
	iters: 1000, epoch: 5 | loss: 0.8639753
	speed: 0.0050s/iter; left time: 15.5453s
Updating learning rate to 0.00018592879066811477
Epoch: 5 cost time: 5.1617536544799805
Epoch: 5, Steps: 1027 | Train Loss: 0.6333516 Vali Loss: 0.3858773 Best vali loss: 0.3691413
	iters: 100, epoch: 6 | loss: 0.2005224
	speed: 0.0126s/iter; left time: 37.6887s
	iters: 200, epoch: 6 | loss: 0.6882281
	speed: 0.0047s/iter; left time: 13.4047s
	iters: 300, epoch: 6 | loss: 0.4451286
	speed: 0.0046s/iter; left time: 12.8201s
	iters: 400, epoch: 6 | loss: 0.5103654
	speed: 0.0047s/iter; left time: 12.4778s
	iters: 500, epoch: 6 | loss: 1.5034230
	speed: 0.0046s/iter; left time: 11.9774s
	iters: 600, epoch: 6 | loss: 0.3196806
	speed: 0.0046s/iter; left time: 11.4555s
	iters: 700, epoch: 6 | loss: 0.3919880
	speed: 0.0047s/iter; left time: 11.1019s
	iters: 800, epoch: 6 | loss: 1.1318458
	speed: 0.0047s/iter; left time: 10.6545s
	iters: 900, epoch: 6 | loss: 0.4211783
	speed: 0.0046s/iter; left time: 10.1366s
	iters: 1000, epoch: 6 | loss: 0.2799041
	speed: 0.0046s/iter; left time: 9.5174s
Updating learning rate to 8.821613548704165e-05
Epoch: 6 cost time: 4.830571413040161
Epoch: 6, Steps: 1027 | Train Loss: 0.5892264 Vali Loss: 0.3911281 Best vali loss: 0.3691413
	iters: 100, epoch: 7 | loss: 0.3312850
	speed: 0.0124s/iter; left time: 24.2366s
	iters: 200, epoch: 7 | loss: 0.5066473
	speed: 0.0048s/iter; left time: 8.8842s
	iters: 300, epoch: 7 | loss: 0.3833858
	speed: 0.0046s/iter; left time: 8.0779s
	iters: 400, epoch: 7 | loss: 0.4778909
	speed: 0.0045s/iter; left time: 7.5224s
	iters: 500, epoch: 7 | loss: 0.4448868
	speed: 0.0045s/iter; left time: 7.0656s
	iters: 600, epoch: 7 | loss: 0.5498406
	speed: 0.0046s/iter; left time: 6.6675s
	iters: 700, epoch: 7 | loss: 0.6549270
	speed: 0.0046s/iter; left time: 6.2631s
	iters: 800, epoch: 7 | loss: 0.2670985
	speed: 0.0048s/iter; left time: 6.0169s
	iters: 900, epoch: 7 | loss: 0.5558574
	speed: 0.0050s/iter; left time: 5.7894s
	iters: 1000, epoch: 7 | loss: 0.9534639
	speed: 0.0050s/iter; left time: 5.2825s
Updating learning rate to 2.292662664067406e-05
Epoch: 7 cost time: 4.897447347640991
Epoch: 7, Steps: 1027 | Train Loss: 0.5125283 Vali Loss: 0.3856653 Best vali loss: 0.3691413
	iters: 100, epoch: 8 | loss: 0.2257746
	speed: 0.0127s/iter; left time: 11.7884s
	iters: 200, epoch: 8 | loss: 0.8248360
	speed: 0.0050s/iter; left time: 4.1393s
	iters: 300, epoch: 8 | loss: 1.1172978
	speed: 0.0050s/iter; left time: 3.6405s
	iters: 400, epoch: 8 | loss: 1.1714165
	speed: 0.0050s/iter; left time: 3.1378s
	iters: 500, epoch: 8 | loss: 0.1893579
	speed: 0.0050s/iter; left time: 2.6463s
	iters: 600, epoch: 8 | loss: 1.4415486
	speed: 0.0050s/iter; left time: 2.1380s
	iters: 700, epoch: 8 | loss: 0.3070007
	speed: 0.0050s/iter; left time: 1.6461s
	iters: 800, epoch: 8 | loss: 0.1675941
	speed: 0.0050s/iter; left time: 1.1462s
	iters: 900, epoch: 8 | loss: 0.5367726
	speed: 0.0050s/iter; left time: 0.6364s
	iters: 1000, epoch: 8 | loss: 0.4315056
	speed: 0.0050s/iter; left time: 0.1403s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.177837610244751
Epoch: 8, Steps: 1027 | Train Loss: 0.6413104 Vali Loss: 0.3909029 Best vali loss: 0.3691413

best validation loss 0.3691413199386334

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 1, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 0.6191301345825195
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3743929 Best vali loss: 0.3743929
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3744 --> 0.3708).  Saving model state dict ...
Epoch: 2 cost time: 0.3307380676269531
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3707712 Best vali loss: 0.3707712
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.3269028663635254
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3741262 Best vali loss: 0.3707712

best validation loss 0.3707712154374376

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 3, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 0.9125673770904541
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732685 Best vali loss: 0.3732685
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.6053826808929443
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3824949 Best vali loss: 0.3732685
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3733 --> 0.3525).  Saving model state dict ...
Epoch: 3 cost time: 0.6038851737976074
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3524504 Best vali loss: 0.3524504

best validation loss 0.35245041561501433

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022144539395, 'e_layers': 1, 'learning_rate': 5.13081815e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.13081815e-05
Validation loss decreased (inf --> 0.4038).  Saving model state dict ...
Epoch: 1 cost time: 0.6191158294677734
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4038392 Best vali loss: 0.4038392
Updating learning rate to 2.565409075e-05
Validation loss decreased (0.4038 --> 0.3845).  Saving model state dict ...
Epoch: 2 cost time: 0.31826043128967285
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3844751 Best vali loss: 0.3844751
Updating learning rate to 1.2827045375e-05
Validation loss decreased (0.3845 --> 0.3791).  Saving model state dict ...
Epoch: 3 cost time: 0.3114030361175537
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3790932 Best vali loss: 0.3790932

best validation loss 0.3790932375110671

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 3, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.9138131141662598
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3603792 Best vali loss: 0.3524504
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.6100683212280273
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3532851 Best vali loss: 0.3524504
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.6031773090362549
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3594742 Best vali loss: 0.3524504
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.6084001064300537
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3588080 Best vali loss: 0.3524504
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.6088893413543701
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3555527 Best vali loss: 0.3524504

best validation loss 0.35245041561501433

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022146193207, 'e_layers': 2, 'learning_rate': 6.14317369e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.14317369e-05
Validation loss decreased (inf --> 0.3919).  Saving model state dict ...
Epoch: 1 cost time: 0.6419792175292969
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3919038 Best vali loss: 0.3919038
Updating learning rate to 3.071586845e-05
Validation loss decreased (0.3919 --> 0.3735).  Saving model state dict ...
Epoch: 2 cost time: 0.3597142696380615
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3735023 Best vali loss: 0.3735023
Updating learning rate to 1.5357934225e-05
Validation loss decreased (0.3735 --> 0.3694).  Saving model state dict ...
Epoch: 3 cost time: 0.34885621070861816
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3693568 Best vali loss: 0.3693568
Updating learning rate to 7.6789671125e-06
Validation loss decreased (0.3694 --> 0.3680).  Saving model state dict ...
Epoch: 4 cost time: 0.36072206497192383
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3680323 Best vali loss: 0.3680323
Updating learning rate to 3.83948355625e-06
Validation loss decreased (0.3680 --> 0.3672).  Saving model state dict ...
Epoch: 5 cost time: 0.34928178787231445
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3671739 Best vali loss: 0.3671739
Updating learning rate to 1.919741778125e-06
Validation loss decreased (0.3672 --> 0.3669).  Saving model state dict ...
Epoch: 6 cost time: 0.3648533821105957
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3669347 Best vali loss: 0.3669347
Updating learning rate to 9.598708890625e-07
Validation loss decreased (0.3669 --> 0.3669).  Saving model state dict ...
Epoch: 7 cost time: 0.35204291343688965
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3668633 Best vali loss: 0.3668633
Updating learning rate to 4.7993544453125e-07
Validation loss decreased (0.3669 --> 0.3668).  Saving model state dict ...
Epoch: 8 cost time: 0.368227481842041
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3667950 Best vali loss: 0.3667950

best validation loss 0.3667950368232015

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0022140788454, 'e_layers': 4, 'learning_rate': 0.0007233202253, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007233202253
Validation loss decreased (inf --> 0.3792).  Saving model state dict ...
Epoch: 1 cost time: 1.167679786682129
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3791815 Best vali loss: 0.3791815
Updating learning rate to 0.00036166011265
Validation loss decreased (0.3792 --> 0.3751).  Saving model state dict ...
Epoch: 2 cost time: 0.8644335269927979
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3751144 Best vali loss: 0.3751144
Updating learning rate to 0.000180830056325
Epoch: 3 cost time: 0.8650078773498535
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3894046 Best vali loss: 0.3751144
Updating learning rate to 9.04150281625e-05
Epoch: 4 cost time: 0.8607900142669678
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3800918 Best vali loss: 0.3751144
Updating learning rate to 4.520751408125e-05
Validation loss decreased (0.3751 --> 0.3669).  Saving model state dict ...
Epoch: 5 cost time: 0.8697836399078369
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3669053 Best vali loss: 0.3669053
Updating learning rate to 2.2603757040625e-05
Validation loss decreased (0.3669 --> 0.3633).  Saving model state dict ...
Epoch: 6 cost time: 0.86403489112854
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3633390 Best vali loss: 0.3633390
Updating learning rate to 1.13018785203125e-05
Validation loss decreased (0.3633 --> 0.3584).  Saving model state dict ...
Epoch: 7 cost time: 0.8660411834716797
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3583502 Best vali loss: 0.3583502
Updating learning rate to 5.65093926015625e-06
Epoch: 8 cost time: 0.8619015216827393
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3608028 Best vali loss: 0.3583502

best validation loss 0.3583501769423719

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0022118381714, 'e_layers': 3, 'learning_rate': 5.88209133e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.88209133e-05
Validation loss decreased (inf --> 0.4107).  Saving model state dict ...
Epoch: 1 cost time: 0.7407925128936768
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4106542 Best vali loss: 0.4106542
Updating learning rate to 2.941045665e-05
Validation loss decreased (0.4107 --> 0.3906).  Saving model state dict ...
Epoch: 2 cost time: 0.4184911251068115
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3905763 Best vali loss: 0.3905763
Updating learning rate to 1.4705228325e-05
Validation loss decreased (0.3906 --> 0.3842).  Saving model state dict ...
Epoch: 3 cost time: 0.4237091541290283
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3842314 Best vali loss: 0.3842314

best validation loss 0.3842313893651681

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021460507381, 'e_layers': 3, 'learning_rate': 6.1602085e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.1602085e-05
Validation loss decreased (inf --> 0.4094).  Saving model state dict ...
Epoch: 1 cost time: 0.7726328372955322
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4094297 Best vali loss: 0.4094297
Updating learning rate to 3.08010425e-05
Validation loss decreased (0.4094 --> 0.3892).  Saving model state dict ...
Epoch: 2 cost time: 0.38043832778930664
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3892071 Best vali loss: 0.3892071
Updating learning rate to 1.540052125e-05
Validation loss decreased (0.3892 --> 0.3829).  Saving model state dict ...
Epoch: 3 cost time: 0.38311767578125
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3829482 Best vali loss: 0.3829482

best validation loss 0.3829482247880962

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019391145658, 'e_layers': 4, 'learning_rate': 0.0007393557925, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007393557925
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 1.0918564796447754
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3674691 Best vali loss: 0.3674691
Updating learning rate to 0.00036967789625
Epoch: 2 cost time: 0.7840325832366943
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3678427 Best vali loss: 0.3674691
Updating learning rate to 0.000184838948125
Epoch: 3 cost time: 0.7805948257446289
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3706410 Best vali loss: 0.3674691

best validation loss 0.36746912570505574

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019391145658, 'e_layers': 4, 'learning_rate': 0.0007393557925, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 9.24194740625e-05
Validation loss decreased (0.3675 --> 0.3592).  Saving model state dict ...
Epoch: 4 cost time: 1.0957739353179932
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3591654 Best vali loss: 0.3591654
Updating learning rate to 4.620973703125e-05
Validation loss decreased (0.3592 --> 0.3505).  Saving model state dict ...
Epoch: 5 cost time: 0.7780330181121826
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3505413 Best vali loss: 0.3505413
Updating learning rate to 2.3104868515625e-05
Validation loss decreased (0.3505 --> 0.3458).  Saving model state dict ...
Epoch: 6 cost time: 0.7822458744049072
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3457582 Best vali loss: 0.3457582
Updating learning rate to 1.15524342578125e-05
Validation loss decreased (0.3458 --> 0.3433).  Saving model state dict ...
Epoch: 7 cost time: 0.784782886505127
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3432512 Best vali loss: 0.3432512
Updating learning rate to 5.77621712890625e-06
Epoch: 8 cost time: 0.7878155708312988
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3446579 Best vali loss: 0.3432512

best validation loss 0.34325115701772846

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 0.7619860172271729
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3665982 Best vali loss: 0.3665982
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.4835677146911621
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3721837 Best vali loss: 0.3665982
Updating learning rate to 0.0008072813968307993
Epoch: 3 cost time: 0.4714782238006592
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3693865 Best vali loss: 0.3665982
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 0.47295570373535156
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3751417 Best vali loss: 0.3665982
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.4365119934082031
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3811111 Best vali loss: 0.3665982
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.47132420539855957
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3858057 Best vali loss: 0.3665982
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.45453500747680664
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3730465 Best vali loss: 0.3665982
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4530360698699951
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3759427 Best vali loss: 0.3665982

best validation loss 0.3665981802818583

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007073711667
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.1089129447937012
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3671676 Best vali loss: 0.3671676
Updating learning rate to 0.00035368558335
Epoch: 2 cost time: 0.7876400947570801
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3732969 Best vali loss: 0.3671676
Updating learning rate to 0.000176842791675
Validation loss decreased (0.3672 --> 0.3626).  Saving model state dict ...
Epoch: 3 cost time: 0.7868545055389404
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3626362 Best vali loss: 0.3626362
Updating learning rate to 8.84213958375e-05
Validation loss decreased (0.3626 --> 0.3466).  Saving model state dict ...
Epoch: 4 cost time: 0.7956278324127197
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3465610 Best vali loss: 0.3465610
Updating learning rate to 4.421069791875e-05
Validation loss decreased (0.3466 --> 0.3427).  Saving model state dict ...
Epoch: 5 cost time: 0.7897233963012695
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3426512 Best vali loss: 0.3426512
Updating learning rate to 2.2105348959375e-05
Epoch: 6 cost time: 0.7951171398162842
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3451703 Best vali loss: 0.3426512
Updating learning rate to 1.10526744796875e-05
Epoch: 7 cost time: 0.788140058517456
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3463052 Best vali loss: 0.3426512
Updating learning rate to 5.52633723984375e-06
Epoch: 8 cost time: 0.7885358333587646
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3456430 Best vali loss: 0.3426512

best validation loss 0.3426512241363525

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007058992616, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007058992616
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 1.1124324798583984
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3668086 Best vali loss: 0.3668086
Updating learning rate to 0.0003529496308
Epoch: 2 cost time: 0.7859838008880615
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3839344 Best vali loss: 0.3668086
Updating learning rate to 0.0001764748154
Validation loss decreased (0.3668 --> 0.3474).  Saving model state dict ...
Epoch: 3 cost time: 0.790764331817627
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3474452 Best vali loss: 0.3474452

best validation loss 0.3474452205397525

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.099679946899414
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672016 Best vali loss: 0.3672016
Updating learning rate to 0.0003537634989
Epoch: 2 cost time: 0.7874948978424072
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3755671 Best vali loss: 0.3672016
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3672 --> 0.3653).  Saving model state dict ...
Epoch: 3 cost time: 0.7909467220306396
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3652696 Best vali loss: 0.3652696

best validation loss 0.36526956504360863

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022176520224, 'e_layers': 4, 'learning_rate': 0.000706559378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000706559378
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 1.108105182647705
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3673844 Best vali loss: 0.3673844
Updating learning rate to 0.000353279689
Epoch: 2 cost time: 0.7960610389709473
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3724284 Best vali loss: 0.3673844
Updating learning rate to 0.0001766398445
Validation loss decreased (0.3674 --> 0.3468).  Saving model state dict ...
Epoch: 3 cost time: 0.790022611618042
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3467719 Best vali loss: 0.3467719

best validation loss 0.346771921132543

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022176520224, 'e_layers': 4, 'learning_rate': 0.000706559378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.831992225e-05
Validation loss decreased (0.3468 --> 0.3416).  Saving model state dict ...
Epoch: 4 cost time: 1.1155540943145752
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3416049 Best vali loss: 0.3416049
Updating learning rate to 4.4159961125e-05
Epoch: 5 cost time: 0.7945816516876221
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3437243 Best vali loss: 0.3416049
Updating learning rate to 2.20799805625e-05
Epoch: 6 cost time: 0.7898786067962646
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3433419 Best vali loss: 0.3416049
Updating learning rate to 1.103999028125e-05
Epoch: 7 cost time: 0.7880396842956543
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3456998 Best vali loss: 0.3416049
Updating learning rate to 5.519995140625e-06
Epoch: 8 cost time: 0.7940816879272461
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3468995 Best vali loss: 0.3416049

best validation loss 0.3416049069060792

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022156987518, 'e_layers': 4, 'learning_rate': 0.0007062511586, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007062511586
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.1008949279785156
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669362 Best vali loss: 0.3669362
Updating learning rate to 0.0003531255793
Epoch: 2 cost time: 0.7897143363952637
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703546 Best vali loss: 0.3669362
Updating learning rate to 0.00017656278965
Validation loss decreased (0.3669 --> 0.3637).  Saving model state dict ...
Epoch: 3 cost time: 0.7846784591674805
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3637108 Best vali loss: 0.3637108
Updating learning rate to 8.8281394825e-05
Validation loss decreased (0.3637 --> 0.3475).  Saving model state dict ...
Epoch: 4 cost time: 0.7984492778778076
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3475363 Best vali loss: 0.3475363
Updating learning rate to 4.41406974125e-05
Validation loss decreased (0.3475 --> 0.3451).  Saving model state dict ...
Epoch: 5 cost time: 0.8031721115112305
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3451050 Best vali loss: 0.3451050
Updating learning rate to 2.207034870625e-05
Validation loss decreased (0.3451 --> 0.3441).  Saving model state dict ...
Epoch: 6 cost time: 0.7955951690673828
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3440706 Best vali loss: 0.3440706
Updating learning rate to 1.1035174353125e-05
Epoch: 7 cost time: 0.7978520393371582
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3443349 Best vali loss: 0.3440706
Updating learning rate to 5.5175871765625e-06
Validation loss decreased (0.3441 --> 0.3438).  Saving model state dict ...
Epoch: 8 cost time: 0.7964634895324707
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3438192 Best vali loss: 0.3438192

best validation loss 0.3438192093536287

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5687875
	speed: 0.0120s/iter; left time: 11.2262s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 1.1035094261169434
Epoch: 1, Steps: 129 | Train Loss: 0.5687875 Vali Loss: 0.3696939 Best vali loss: 0.3696939
	iters: 100, epoch: 2 | loss: 0.4671884
	speed: 0.0094s/iter; left time: 7.5722s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.3697 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 0.7883377075195312
Epoch: 2, Steps: 129 | Train Loss: 0.4671884 Vali Loss: 0.3629822 Best vali loss: 0.3629822
	iters: 100, epoch: 3 | loss: 0.7143908
	speed: 0.0091s/iter; left time: 6.1142s
Updating learning rate to 0.000178512795825
Validation loss decreased (0.3630 --> 0.3574).  Saving model state dict ...
Epoch: 3 cost time: 0.7464380264282227
Epoch: 3, Steps: 129 | Train Loss: 0.7143908 Vali Loss: 0.3574249 Best vali loss: 0.3574249
	iters: 100, epoch: 4 | loss: 0.8320780
	speed: 0.0092s/iter; left time: 5.0001s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 0.7475061416625977
Epoch: 4, Steps: 129 | Train Loss: 0.8320780 Vali Loss: 0.3584329 Best vali loss: 0.3574249
	iters: 100, epoch: 5 | loss: 0.6181701
	speed: 0.0092s/iter; left time: 3.8518s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 0.7608308792114258
Epoch: 5, Steps: 129 | Train Loss: 0.6181701 Vali Loss: 0.3584130 Best vali loss: 0.3574249
	iters: 100, epoch: 6 | loss: 0.7162017
	speed: 0.0090s/iter; left time: 2.5790s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 0.7322866916656494
Epoch: 6, Steps: 129 | Train Loss: 0.7162017 Vali Loss: 0.3586764 Best vali loss: 0.3574249
	iters: 100, epoch: 7 | loss: 0.3819922
	speed: 0.0090s/iter; left time: 1.4290s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 0.7459430694580078
Epoch: 7, Steps: 129 | Train Loss: 0.3819922 Vali Loss: 0.3582038 Best vali loss: 0.3574249
	iters: 100, epoch: 8 | loss: 0.3108411
	speed: 0.0097s/iter; left time: 0.2896s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 0.8025577068328857
Epoch: 8, Steps: 129 | Train Loss: 0.3108411 Vali Loss: 0.3590117 Best vali loss: 0.3574249

best validation loss 0.3574249305636101

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022137879088, 'e_layers': 4, 'learning_rate': 0.0009204439157, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008854116051198872
Validation loss decreased (inf --> 0.3780).  Saving model state dict ...
Epoch: 1 cost time: 1.0964710712432861
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3780121 Best vali loss: 0.3780121
Updating learning rate to 0.0007856480250966845
Epoch: 2 cost time: 0.7852647304534912
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3925179 Best vali loss: 0.3780121
Updating learning rate to 0.0006363412763298197
Epoch: 3 cost time: 0.778921365737915
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3867532 Best vali loss: 0.3780121

best validation loss 0.3780121028306208

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022238205412, 'e_layers': 4, 'learning_rate': 0.0007068777599, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007068777599
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 1.0602059364318848
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3727147 Best vali loss: 0.3727147
Updating learning rate to 0.00035343887995
Epoch: 2 cost time: 0.7725472450256348
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3812312 Best vali loss: 0.3727147
Updating learning rate to 0.000176719439975
Epoch: 3 cost time: 0.7658543586730957
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3824679 Best vali loss: 0.3727147

best validation loss 0.3727147078350157

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 1.0981214046478271
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3716526 Best vali loss: 0.3716526
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3717 --> 0.3613).  Saving model state dict ...
Epoch: 2 cost time: 0.7774274349212646
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3613246 Best vali loss: 0.3613246
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7780022621154785
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3820485 Best vali loss: 0.3613246

best validation loss 0.3613246272261344

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3613 --> 0.3549).  Saving model state dict ...
Epoch: 4 cost time: 1.1001665592193604
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3549108 Best vali loss: 0.3549108
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3549 --> 0.3378).  Saving model state dict ...
Epoch: 5 cost time: 0.7810006141662598
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3378484 Best vali loss: 0.3378484
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7751679420471191
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3397856 Best vali loss: 0.3378484
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.775648832321167
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3462682 Best vali loss: 0.3378484
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7828259468078613
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3495035 Best vali loss: 0.3378484

best validation loss 0.33784843184390567

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022244275997, 'e_layers': 4, 'learning_rate': 0.0009005024089, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0009005024089
Validation loss decreased (inf --> 0.3771).  Saving model state dict ...
Epoch: 1 cost time: 1.0965051651000977
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3771178 Best vali loss: 0.3771178
Updating learning rate to 0.00045025120445
Epoch: 2 cost time: 0.7774567604064941
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3966408 Best vali loss: 0.3771178
Updating learning rate to 0.000225125602225
Epoch: 3 cost time: 0.7772691249847412
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3913671 Best vali loss: 0.3771178
Updating learning rate to 0.0001125628011125
Epoch: 4 cost time: 0.7772073745727539
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3855881 Best vali loss: 0.3771178
Updating learning rate to 5.628140055625e-05
Validation loss decreased (0.3771 --> 0.3753).  Saving model state dict ...
Epoch: 5 cost time: 0.7775366306304932
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3752680 Best vali loss: 0.3752680
Updating learning rate to 2.8140700278125e-05
Validation loss decreased (0.3753 --> 0.3743).  Saving model state dict ...
Epoch: 6 cost time: 0.7780566215515137
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3743211 Best vali loss: 0.3743211
Updating learning rate to 1.40703501390625e-05
Epoch: 7 cost time: 0.7833528518676758
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3798462 Best vali loss: 0.3743211
Updating learning rate to 7.03517506953125e-06
Epoch: 8 cost time: 0.7794091701507568
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3786313 Best vali loss: 0.3743211

best validation loss 0.3743210806944984

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022173530586, 'e_layers': 4, 'learning_rate': 0.0009007407937, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0009007407937
Validation loss decreased (inf --> 0.3738).  Saving model state dict ...
Epoch: 1 cost time: 1.0842044353485107
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3737995 Best vali loss: 0.3737995
Updating learning rate to 0.00045037039685
Epoch: 2 cost time: 0.7790443897247314
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3846218 Best vali loss: 0.3737995
Updating learning rate to 0.000225185198425
Validation loss decreased (0.3738 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 0.7817919254302979
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3683987 Best vali loss: 0.3683987
Updating learning rate to 0.0001125925992125
Validation loss decreased (0.3684 --> 0.3537).  Saving model state dict ...
Epoch: 4 cost time: 0.78523850440979
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3537383 Best vali loss: 0.3537383
Updating learning rate to 5.629629960625e-05
Validation loss decreased (0.3537 --> 0.3472).  Saving model state dict ...
Epoch: 5 cost time: 0.7853422164916992
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3471501 Best vali loss: 0.3471501
Updating learning rate to 2.8148149803125e-05
Validation loss decreased (0.3472 --> 0.3450).  Saving model state dict ...
Epoch: 6 cost time: 0.7830777168273926
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3450094 Best vali loss: 0.3450094
Updating learning rate to 1.40740749015625e-05
Epoch: 7 cost time: 0.7878963947296143
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3469057 Best vali loss: 0.3450094
Updating learning rate to 7.03703745078125e-06
Epoch: 8 cost time: 0.7809958457946777
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3466076 Best vali loss: 0.3450094

best validation loss 0.3450093852513431

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002878810947, 'e_layers': 4, 'learning_rate': 0.0007067594335, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006798600042599609
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.1051230430603027
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712669 Best vali loss: 0.3712669
Updating learning rate to 0.0006032569107977063
Epoch: 2 cost time: 0.7838718891143799
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3739784 Best vali loss: 0.3712669
Updating learning rate to 0.0004886122796840932
Validation loss decreased (0.3713 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 0.7764332294464111
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3661845 Best vali loss: 0.3661845

best validation loss 0.36618454321662663

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0026615856381, 'e_layers': 4, 'learning_rate': 0.00089505158, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00089505158
Validation loss decreased (inf --> 0.3754).  Saving model state dict ...
Epoch: 1 cost time: 1.0973734855651855
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3753818 Best vali loss: 0.3753818
Updating learning rate to 0.00044752579
Epoch: 2 cost time: 0.7794516086578369
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3880956 Best vali loss: 0.3753818
Updating learning rate to 0.000223762895
Epoch: 3 cost time: 0.7801022529602051
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3890507 Best vali loss: 0.3753818

best validation loss 0.3753817790149471

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002229738229, 'e_layers': 4, 'learning_rate': 0.0009387004382, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000902973280106178
Validation loss decreased (inf --> 0.3745).  Saving model state dict ...
Epoch: 1 cost time: 1.084972620010376
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3745218 Best vali loss: 0.3745218
Updating learning rate to 0.0008012309417770019
Epoch: 2 cost time: 0.7782783508300781
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3844397 Best vali loss: 0.3745218
Updating learning rate to 0.0006489627719264949
Epoch: 3 cost time: 0.7813880443572998
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3975132 Best vali loss: 0.3745218

best validation loss 0.374521785611488

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002878810947, 'e_layers': 4, 'learning_rate': 0.0007067594335, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035337971675
Validation loss decreased (0.3662 --> 0.3649).  Saving model state dict ...
Epoch: 4 cost time: 1.0903916358947754
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3648646 Best vali loss: 0.3648646
Updating learning rate to 0.00021814715381590679
Validation loss decreased (0.3649 --> 0.3553).  Saving model state dict ...
Epoch: 5 cost time: 0.7784583568572998
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3552739 Best vali loss: 0.3552739
Updating learning rate to 0.00010350252270229362
Validation loss decreased (0.3553 --> 0.3430).  Saving model state dict ...
Epoch: 6 cost time: 0.783665657043457
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3430230 Best vali loss: 0.3430230
Updating learning rate to 2.6899429240039076e-05
Epoch: 7 cost time: 0.7839114665985107
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3461969 Best vali loss: 0.3430230
Updating learning rate to 0.0
Epoch: 8 cost time: 0.786088228225708
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3470313 Best vali loss: 0.3430230

best validation loss 0.34302295143103084

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022137879088, 'e_layers': 4, 'learning_rate': 0.000706568897, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000706568897
Validation loss decreased (inf --> 0.3630).  Saving model state dict ...
Epoch: 1 cost time: 1.0868730545043945
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3629834 Best vali loss: 0.3629834
Updating learning rate to 0.0003532844485
Epoch: 2 cost time: 0.7879304885864258
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3776948 Best vali loss: 0.3629834
Updating learning rate to 0.00017664222425
Validation loss decreased (0.3630 --> 0.3596).  Saving model state dict ...
Epoch: 3 cost time: 0.7863645553588867
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3595657 Best vali loss: 0.3595657
Updating learning rate to 8.8321112125e-05
Validation loss decreased (0.3596 --> 0.3499).  Saving model state dict ...
Epoch: 4 cost time: 0.7871859073638916
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3499138 Best vali loss: 0.3499138
Updating learning rate to 4.41605560625e-05
Epoch: 5 cost time: 0.7920033931732178
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3584883 Best vali loss: 0.3499138
Updating learning rate to 2.208027803125e-05
Epoch: 6 cost time: 0.7923791408538818
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3524381 Best vali loss: 0.3499138
Updating learning rate to 1.1040139015625e-05
Epoch: 7 cost time: 0.7883105278015137
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3598418 Best vali loss: 0.3499138
Updating learning rate to 5.5200695078125e-06
Epoch: 8 cost time: 0.7931821346282959
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3581367 Best vali loss: 0.3499138

best validation loss 0.3499137762253317

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004191723262, 'e_layers': 3, 'learning_rate': 0.0043478566088, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0043478566088
Validation loss decreased (inf --> 0.3679).  Saving model state dict ...
Epoch: 1 cost time: 0.7337799072265625
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3678811 Best vali loss: 0.3678811
Updating learning rate to 0.0021739283044
Epoch: 2 cost time: 0.4029829502105713
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3689722 Best vali loss: 0.3678811
Updating learning rate to 0.0010869641522
Epoch: 3 cost time: 0.4180269241333008
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3718190 Best vali loss: 0.3678811
Updating learning rate to 0.0005434820761
Epoch: 4 cost time: 0.3968188762664795
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3707471 Best vali loss: 0.3678811
Updating learning rate to 0.00027174103805
Epoch: 5 cost time: 0.38747167587280273
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3739027 Best vali loss: 0.3678811
Updating learning rate to 0.000135870519025
Epoch: 6 cost time: 0.3765697479248047
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3768369 Best vali loss: 0.3678811
Updating learning rate to 6.79352595125e-05
Epoch: 7 cost time: 0.3874654769897461
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3787946 Best vali loss: 0.3678811
Updating learning rate to 3.396762975625e-05
Epoch: 8 cost time: 0.37609004974365234
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3786694 Best vali loss: 0.3678811

best validation loss 0.3678811217455124

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006804484547513797
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0923271179199219
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711523 Best vali loss: 0.3711523
Updating learning rate to 0.0006037790577447048
Validation loss decreased (0.3712 --> 0.3609).  Saving model state dict ...
Epoch: 2 cost time: 0.7883419990539551
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3608509 Best vali loss: 0.3608509
Updating learning rate to 0.0004890351963644271
Epoch: 3 cost time: 0.7824366092681885
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3666805 Best vali loss: 0.3608509

best validation loss 0.3608508515100348

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022284883714, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.1014246940612793
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713514 Best vali loss: 0.3713514
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.7833404541015625
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3795524 Best vali loss: 0.3713514
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3714 --> 0.3553).  Saving model state dict ...
Epoch: 3 cost time: 0.776864767074585
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3552610 Best vali loss: 0.3552610

best validation loss 0.35526099380669285

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3698026
	speed: 0.0105s/iter; left time: 42.2884s
	iters: 200, epoch: 1 | loss: 0.6591713
	speed: 0.0042s/iter; left time: 16.4640s
	iters: 300, epoch: 1 | loss: 1.0961819
	speed: 0.0042s/iter; left time: 16.1687s
	iters: 400, epoch: 1 | loss: 0.2758059
	speed: 0.0044s/iter; left time: 16.3427s
	iters: 500, epoch: 1 | loss: 0.3369479
	speed: 0.0044s/iter; left time: 15.9550s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 2.5577163696289062
Epoch: 1, Steps: 514 | Train Loss: 0.5475819 Vali Loss: 0.3675072 Best vali loss: 0.3675072
	iters: 100, epoch: 2 | loss: 0.2646711
	speed: 0.0082s/iter; left time: 28.8224s
	iters: 200, epoch: 2 | loss: 0.7228286
	speed: 0.0038s/iter; left time: 12.9289s
	iters: 300, epoch: 2 | loss: 0.2696287
	speed: 0.0039s/iter; left time: 12.9029s
	iters: 400, epoch: 2 | loss: 0.3556326
	speed: 0.0039s/iter; left time: 12.3312s
	iters: 500, epoch: 2 | loss: 0.4124698
	speed: 0.0039s/iter; left time: 12.0731s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 2.0435569286346436
Epoch: 2, Steps: 514 | Train Loss: 0.4050461 Vali Loss: 0.3741252 Best vali loss: 0.3675072
	iters: 100, epoch: 3 | loss: 0.6216495
	speed: 0.0080s/iter; left time: 24.0019s
	iters: 200, epoch: 3 | loss: 0.3904777
	speed: 0.0038s/iter; left time: 11.0909s
	iters: 300, epoch: 3 | loss: 0.4733387
	speed: 0.0039s/iter; left time: 10.9582s
	iters: 400, epoch: 3 | loss: 0.5898510
	speed: 0.0040s/iter; left time: 10.6204s
	iters: 500, epoch: 3 | loss: 0.6582649
	speed: 0.0040s/iter; left time: 10.2682s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 2.0534861087799072
Epoch: 3, Steps: 514 | Train Loss: 0.5467164 Vali Loss: 0.3685130 Best vali loss: 0.3675072

best validation loss 0.3675072320903448

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022284883714, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3553 --> 0.3466).  Saving model state dict ...
Epoch: 4 cost time: 1.121640682220459
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3466399 Best vali loss: 0.3466399
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3466 --> 0.3424).  Saving model state dict ...
Epoch: 5 cost time: 0.7793941497802734
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3423962 Best vali loss: 0.3423962
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3424 --> 0.3410).  Saving model state dict ...
Epoch: 6 cost time: 0.7798926830291748
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3410338 Best vali loss: 0.3410338
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3410 --> 0.3404).  Saving model state dict ...
Epoch: 7 cost time: 0.7910284996032715
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3404417 Best vali loss: 0.3404417
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7788362503051758
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3418268 Best vali loss: 0.3404417

best validation loss 0.34044167415800636

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022272508254, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.0989305973052979
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714114 Best vali loss: 0.3714114
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3714 --> 0.3592).  Saving model state dict ...
Epoch: 2 cost time: 0.784083366394043
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3592369 Best vali loss: 0.3592369
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3592 --> 0.3533).  Saving model state dict ...
Epoch: 3 cost time: 0.7796776294708252
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3532658 Best vali loss: 0.3532658
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3533 --> 0.3485).  Saving model state dict ...
Epoch: 4 cost time: 0.7881076335906982
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3485358 Best vali loss: 0.3485358
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7856690883636475
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3516074 Best vali loss: 0.3485358
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3485 --> 0.3476).  Saving model state dict ...
Epoch: 6 cost time: 0.7878575325012207
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3475879 Best vali loss: 0.3475879
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7794716358184814
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3481171 Best vali loss: 0.3475879
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7801449298858643
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3482342 Best vali loss: 0.3475879

best validation loss 0.3475879154879827

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 0.8117451667785645
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3702770 Best vali loss: 0.3702770
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3703 --> 0.3572).  Saving model state dict ...
Epoch: 2 cost time: 0.49341392517089844
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3571952 Best vali loss: 0.3571952
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3572 --> 0.3454).  Saving model state dict ...
Epoch: 3 cost time: 0.4839632511138916
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3453890 Best vali loss: 0.3453890
Updating learning rate to 8.8440874725e-05
Epoch: 4 cost time: 0.48278141021728516
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3503237 Best vali loss: 0.3453890
Updating learning rate to 4.42204373625e-05
Epoch: 5 cost time: 0.48419928550720215
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3542922 Best vali loss: 0.3453890
Updating learning rate to 2.211021868125e-05
Epoch: 6 cost time: 0.4975411891937256
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3588395 Best vali loss: 0.3453890
Updating learning rate to 1.1055109340625e-05
Epoch: 7 cost time: 0.502610445022583
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3568088 Best vali loss: 0.3453890
Updating learning rate to 5.5275546703125e-06
Epoch: 8 cost time: 0.4958839416503906
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3547906 Best vali loss: 0.3453890

best validation loss 0.3453890141429039

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022439716798, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3820).  Saving model state dict ...
Epoch: 1 cost time: 1.3247814178466797
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3820254 Best vali loss: 0.3820254
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3820 --> 0.3809).  Saving model state dict ...
Epoch: 2 cost time: 1.0111207962036133
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3808765 Best vali loss: 0.3808765
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 1.0164411067962646
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3865575 Best vali loss: 0.3808765

best validation loss 0.3808765268747371

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0063666416514, 'e_layers': 4, 'learning_rate': 0.0007070665178, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070665178
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 1.1032140254974365
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3670889 Best vali loss: 0.3670889
Updating learning rate to 0.0003535332589
Epoch: 2 cost time: 0.7911510467529297
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3776431 Best vali loss: 0.3670889
Updating learning rate to 0.00017676662945
Validation loss decreased (0.3671 --> 0.3476).  Saving model state dict ...
Epoch: 3 cost time: 0.7953424453735352
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3475740 Best vali loss: 0.3475740

best validation loss 0.34757397389130884

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.006258308639, 'e_layers': 2, 'learning_rate': 0.0015600129814, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0015600129814
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 0.6430747509002686
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3690461 Best vali loss: 0.3690461
Updating learning rate to 0.0007800064907
Validation loss decreased (0.3690 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 0.3330860137939453
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3647131 Best vali loss: 0.3647131
Updating learning rate to 0.00039000324535
Epoch: 3 cost time: 0.33592915534973145
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3675580 Best vali loss: 0.3647131

best validation loss 0.36471314173784614

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0063666416514, 'e_layers': 4, 'learning_rate': 0.0007070665178, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8383314725e-05
Epoch: 4 cost time: 1.1262404918670654
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3517986 Best vali loss: 0.3475740
Updating learning rate to 4.41916573625e-05
Validation loss decreased (0.3476 --> 0.3459).  Saving model state dict ...
Epoch: 5 cost time: 0.7915942668914795
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3458845 Best vali loss: 0.3458845
Updating learning rate to 2.209582868125e-05
Epoch: 6 cost time: 0.7889337539672852
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3469908 Best vali loss: 0.3458845
Updating learning rate to 1.1047914340625e-05
Validation loss decreased (0.3459 --> 0.3454).  Saving model state dict ...
Epoch: 7 cost time: 0.7872440814971924
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3453624 Best vali loss: 0.3453624
Updating learning rate to 5.5239571703125e-06
Epoch: 8 cost time: 0.7919933795928955
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3473205 Best vali loss: 0.3453624

best validation loss 0.34536237324384905

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022121251808, 'e_layers': 1, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3743).  Saving model state dict ...
Epoch: 1 cost time: 0.6379868984222412
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3742791 Best vali loss: 0.3742791
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3743 --> 0.3710).  Saving model state dict ...
Epoch: 2 cost time: 0.3316781520843506
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3709910 Best vali loss: 0.3709910
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.30451011657714844
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3761025 Best vali loss: 0.3709910
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.294574499130249
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3855791 Best vali loss: 0.3709910
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.29775023460388184
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3864374 Best vali loss: 0.3709910
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.3079261779785156
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3841573 Best vali loss: 0.3709910
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.30849671363830566
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3860289 Best vali loss: 0.3709910
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.3362269401550293
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3874521 Best vali loss: 0.3709910

best validation loss 0.37099100952064124

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008428514766, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3700).  Saving model state dict ...
Epoch: 1 cost time: 1.0954618453979492
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3700377 Best vali loss: 0.3700377
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3700 --> 0.3571).  Saving model state dict ...
Epoch: 2 cost time: 0.7744648456573486
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3571191 Best vali loss: 0.3571191
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.7783305644989014
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3588399 Best vali loss: 0.3571191
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3571 --> 0.3507).  Saving model state dict ...
Epoch: 4 cost time: 0.7762203216552734
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3507344 Best vali loss: 0.3507344
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7806980609893799
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3548627 Best vali loss: 0.3507344
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.7770249843597412
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3545056 Best vali loss: 0.3507344
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7773778438568115
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3530869 Best vali loss: 0.3507344
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7788944244384766
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3526481 Best vali loss: 0.3507344

best validation loss 0.35073437832427634

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008484390813, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 1.0887258052825928
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3697716 Best vali loss: 0.3697716
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7786149978637695
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3803616 Best vali loss: 0.3697716
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7809460163116455
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3805876 Best vali loss: 0.3697716

best validation loss 0.3697715627889502

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0008236849278, 'e_layers': 4, 'learning_rate': 0.0005271398534, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4135766
	speed: 0.0114s/iter; left time: 45.7749s
	iters: 200, epoch: 1 | loss: 0.6638604
	speed: 0.0050s/iter; left time: 19.5616s
	iters: 300, epoch: 1 | loss: 0.8988768
	speed: 0.0051s/iter; left time: 19.2575s
	iters: 400, epoch: 1 | loss: 1.4827881
	speed: 0.0051s/iter; left time: 18.9593s
	iters: 500, epoch: 1 | loss: 0.9850633
	speed: 0.0052s/iter; left time: 18.6488s
Updating learning rate to 0.0005271398534
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 2.9743359088897705
Epoch: 1, Steps: 514 | Train Loss: 0.8888330 Vali Loss: 0.3686929 Best vali loss: 0.3686929
	iters: 100, epoch: 2 | loss: 0.3806455
	speed: 0.0100s/iter; left time: 35.0277s
	iters: 200, epoch: 2 | loss: 0.7513254
	speed: 0.0051s/iter; left time: 17.3043s
	iters: 300, epoch: 2 | loss: 0.4418856
	speed: 0.0052s/iter; left time: 17.2766s
	iters: 400, epoch: 2 | loss: 0.7872790
	speed: 0.0051s/iter; left time: 16.2525s
	iters: 500, epoch: 2 | loss: 0.5366529
	speed: 0.0052s/iter; left time: 16.1263s
Updating learning rate to 0.0002635699267
Epoch: 2 cost time: 2.6967337131500244
Epoch: 2, Steps: 514 | Train Loss: 0.5795576 Vali Loss: 0.3735409 Best vali loss: 0.3686929
	iters: 100, epoch: 3 | loss: 0.5451192
	speed: 0.0098s/iter; left time: 29.3332s
	iters: 200, epoch: 3 | loss: 0.6332964
	speed: 0.0052s/iter; left time: 15.0448s
	iters: 300, epoch: 3 | loss: 0.8765395
	speed: 0.0050s/iter; left time: 13.9882s
	iters: 400, epoch: 3 | loss: 0.3257760
	speed: 0.0052s/iter; left time: 13.8545s
	iters: 500, epoch: 3 | loss: 0.4375948
	speed: 0.0052s/iter; left time: 13.4400s
Updating learning rate to 0.00013178496335
Epoch: 3 cost time: 2.6816961765289307
Epoch: 3, Steps: 514 | Train Loss: 0.5636652 Vali Loss: 0.3806159 Best vali loss: 0.3686929

best validation loss 0.3686929204901918

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025308676289, 'e_layers': 4, 'learning_rate': 0.0007079975341, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006810509824617259
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 1.1069490909576416
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3716853 Best vali loss: 0.3716853
Updating learning rate to 0.000604313695762732
Validation loss decreased (0.3717 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 0.7773363590240479
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3672720 Best vali loss: 0.3672720
Updating learning rate to 0.0004894682302777039
Epoch: 3 cost time: 0.7765958309173584
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3701320 Best vali loss: 0.3672720

best validation loss 0.36727200873005833

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025308676289, 'e_layers': 4, 'learning_rate': 0.0007079975341, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035399876705
Validation loss decreased (0.3673 --> 0.3618).  Saving model state dict ...
Epoch: 4 cost time: 1.0889158248901367
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3617701 Best vali loss: 0.3617701
Updating learning rate to 0.00021852930382229617
Validation loss decreased (0.3618 --> 0.3477).  Saving model state dict ...
Epoch: 5 cost time: 0.7820217609405518
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3477461 Best vali loss: 0.3477461
Updating learning rate to 0.00010368383833726807
Epoch: 6 cost time: 0.7766084671020508
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3484442 Best vali loss: 0.3477461
Updating learning rate to 2.6946551638274105e-05
Epoch: 7 cost time: 0.7738449573516846
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3518831 Best vali loss: 0.3477461
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7779006958007812
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3563292 Best vali loss: 0.3477461

best validation loss 0.347746084645127

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0070613735475, 'e_layers': 4, 'learning_rate': 0.0007092389571, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006822451566121703
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 1.1136555671691895
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3666199 Best vali loss: 0.3666199
Updating learning rate to 0.0006053733165735424
Validation loss decreased (0.3666 --> 0.3613).  Saving model state dict ...
Epoch: 2 cost time: 0.7940692901611328
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3612732 Best vali loss: 0.3612732
Updating learning rate to 0.0004903264777850324
Epoch: 3 cost time: 0.7994077205657959
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3621990 Best vali loss: 0.3612732
Updating learning rate to 0.00035461947855
Validation loss decreased (0.3613 --> 0.3432).  Saving model state dict ...
Epoch: 4 cost time: 0.7895581722259521
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3431626 Best vali loss: 0.3431626
Updating learning rate to 0.0002189124793149677
Epoch: 5 cost time: 0.7903642654418945
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3473809 Best vali loss: 0.3431626
Updating learning rate to 0.0001038656405264576
Epoch: 6 cost time: 0.7907428741455078
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3507296 Best vali loss: 0.3431626
Updating learning rate to 2.6993800487829726e-05
Epoch: 7 cost time: 0.7893738746643066
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3531105 Best vali loss: 0.3431626
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7953164577484131
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3575996 Best vali loss: 0.3431626

best validation loss 0.34316260302933355

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0018258606945, 'e_layers': 4, 'learning_rate': 0.0003552315203, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1458490
	speed: 0.0109s/iter; left time: 43.6136s
	iters: 200, epoch: 1 | loss: 0.9557101
	speed: 0.0048s/iter; left time: 18.7684s
	iters: 300, epoch: 1 | loss: 0.5423521
	speed: 0.0048s/iter; left time: 18.3782s
	iters: 400, epoch: 1 | loss: 0.2848859
	speed: 0.0049s/iter; left time: 18.1132s
	iters: 500, epoch: 1 | loss: 0.3956967
	speed: 0.0048s/iter; left time: 17.4393s
Updating learning rate to 0.0003417113256040188
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 2.8286917209625244
Epoch: 1, Steps: 514 | Train Loss: 0.6648988 Vali Loss: 0.3723858 Best vali loss: 0.3723858
	iters: 100, epoch: 2 | loss: 1.0435170
	speed: 0.0096s/iter; left time: 33.7305s
	iters: 200, epoch: 2 | loss: 0.7333919
	speed: 0.0052s/iter; left time: 17.7000s
	iters: 300, epoch: 2 | loss: 1.0498252
	speed: 0.0053s/iter; left time: 17.5012s
	iters: 400, epoch: 2 | loss: 0.8198741
	speed: 0.0053s/iter; left time: 16.9104s
	iters: 500, epoch: 2 | loss: 0.6857321
	speed: 0.0052s/iter; left time: 16.0341s
Updating learning rate to 0.0003032090685976683
Validation loss decreased (0.3724 --> 0.3687).  Saving model state dict ...
Epoch: 2 cost time: 2.699127197265625
Epoch: 2, Steps: 514 | Train Loss: 0.8664681 Vali Loss: 0.3686973 Best vali loss: 0.3686973
	iters: 100, epoch: 3 | loss: 0.3919362
	speed: 0.0097s/iter; left time: 28.9232s
	iters: 200, epoch: 3 | loss: 0.7622188
	speed: 0.0049s/iter; left time: 14.2048s
	iters: 300, epoch: 3 | loss: 0.5935546
	speed: 0.0049s/iter; left time: 13.7117s
	iters: 400, epoch: 3 | loss: 0.5201168
	speed: 0.0052s/iter; left time: 13.9410s
	iters: 500, epoch: 3 | loss: 0.5425743
	speed: 0.0051s/iter; left time: 13.2795s
Updating learning rate to 0.0002455863688863365
Validation loss decreased (0.3687 --> 0.3668).  Saving model state dict ...
Epoch: 3 cost time: 2.612078905105591
Epoch: 3, Steps: 514 | Train Loss: 0.5620801 Vali Loss: 0.3668377 Best vali loss: 0.3668377
	iters: 100, epoch: 4 | loss: 0.2630896
	speed: 0.0093s/iter; left time: 23.0920s
	iters: 200, epoch: 4 | loss: 0.8272591
	speed: 0.0049s/iter; left time: 11.6870s
	iters: 300, epoch: 4 | loss: 1.2211789
	speed: 0.0050s/iter; left time: 11.2517s
	iters: 400, epoch: 4 | loss: 0.8906391
	speed: 0.0050s/iter; left time: 10.7640s
	iters: 500, epoch: 4 | loss: 0.2938585
	speed: 0.0050s/iter; left time: 10.3147s
Updating learning rate to 0.00017761576015
Validation loss decreased (0.3668 --> 0.3648).  Saving model state dict ...
Epoch: 4 cost time: 2.585659980773926
Epoch: 4, Steps: 514 | Train Loss: 0.6992050 Vali Loss: 0.3648191 Best vali loss: 0.3648191
	iters: 100, epoch: 5 | loss: 0.4501452
	speed: 0.0102s/iter; left time: 19.9664s
	iters: 200, epoch: 5 | loss: 0.5720102
	speed: 0.0053s/iter; left time: 9.8167s
	iters: 300, epoch: 5 | loss: 0.5565621
	speed: 0.0053s/iter; left time: 9.2781s
	iters: 400, epoch: 5 | loss: 0.4946405
	speed: 0.0052s/iter; left time: 8.6776s
	iters: 500, epoch: 5 | loss: 0.6295947
	speed: 0.0052s/iter; left time: 8.0507s
Updating learning rate to 0.00010964515141366347
Epoch: 5 cost time: 2.7202835083007812
Epoch: 5, Steps: 514 | Train Loss: 0.5405905 Vali Loss: 0.3673861 Best vali loss: 0.3648191
	iters: 100, epoch: 6 | loss: 0.5737284
	speed: 0.0101s/iter; left time: 14.5318s
	iters: 200, epoch: 6 | loss: 0.2646630
	speed: 0.0052s/iter; left time: 6.9581s
	iters: 300, epoch: 6 | loss: 0.9496819
	speed: 0.0051s/iter; left time: 6.3766s
	iters: 400, epoch: 6 | loss: 0.8542287
	speed: 0.0050s/iter; left time: 5.7155s
	iters: 500, epoch: 6 | loss: 0.6228684
	speed: 0.0052s/iter; left time: 5.3952s
Updating learning rate to 5.202245170233165e-05
Validation loss decreased (0.3648 --> 0.3644).  Saving model state dict ...
Epoch: 6 cost time: 2.6902599334716797
Epoch: 6, Steps: 514 | Train Loss: 0.6530341 Vali Loss: 0.3644090 Best vali loss: 0.3644090
	iters: 100, epoch: 7 | loss: 0.2589709
	speed: 0.0097s/iter; left time: 9.0107s
	iters: 200, epoch: 7 | loss: 0.9513884
	speed: 0.0044s/iter; left time: 3.6633s
	iters: 300, epoch: 7 | loss: 0.7414487
	speed: 0.0047s/iter; left time: 3.3920s
	iters: 400, epoch: 7 | loss: 0.6218320
	speed: 0.0044s/iter; left time: 2.7602s
	iters: 500, epoch: 7 | loss: 0.4869412
	speed: 0.0050s/iter; left time: 2.6187s
Updating learning rate to 1.3520194695981167e-05
Validation loss decreased (0.3644 --> 0.3576).  Saving model state dict ...
Epoch: 7 cost time: 2.4169564247131348
Epoch: 7, Steps: 514 | Train Loss: 0.6121162 Vali Loss: 0.3575871 Best vali loss: 0.3575871
	iters: 100, epoch: 8 | loss: 0.2895528
	speed: 0.0096s/iter; left time: 3.9852s
	iters: 200, epoch: 8 | loss: 0.9965687
	speed: 0.0048s/iter; left time: 1.5131s
	iters: 300, epoch: 8 | loss: 0.3081858
	speed: 0.0046s/iter; left time: 0.9889s
	iters: 400, epoch: 8 | loss: 0.7787020
	speed: 0.0044s/iter; left time: 0.5025s
	iters: 500, epoch: 8 | loss: 0.4943633
	speed: 0.0046s/iter; left time: 0.0691s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.425328493118286
Epoch: 8, Steps: 514 | Train Loss: 0.5734746 Vali Loss: 0.3635359 Best vali loss: 0.3575871

best validation loss 0.3575871223082477

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007068706538, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006799669914893458
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.083876371383667
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712773 Best vali loss: 0.3712773
Updating learning rate to 0.0006033518432618742
Validation loss decreased (0.3713 --> 0.3582).  Saving model state dict ...
Epoch: 2 cost time: 0.7770469188690186
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3581628 Best vali loss: 0.3581628
Updating learning rate to 0.0004886891709171696
Epoch: 3 cost time: 0.7794089317321777
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3611312 Best vali loss: 0.3581628

best validation loss 0.3581628286182763

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0877528190612793
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712412 Best vali loss: 0.3712412
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3712 --> 0.3565).  Saving model state dict ...
Epoch: 2 cost time: 0.777376651763916
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3565055 Best vali loss: 0.3565055
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7757391929626465
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3773072 Best vali loss: 0.3565055

best validation loss 0.356505520545195

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022163306741, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.1034374237060547
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711962 Best vali loss: 0.3711962
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3712 --> 0.3625).  Saving model state dict ...
Epoch: 2 cost time: 0.7816107273101807
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3625269 Best vali loss: 0.3625269
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.778846263885498
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3775078 Best vali loss: 0.3625269

best validation loss 0.3625269418849458

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3565 --> 0.3558).  Saving model state dict ...
Epoch: 4 cost time: 1.2359049320220947
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3557574 Best vali loss: 0.3557574
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3558 --> 0.3498).  Saving model state dict ...
Epoch: 5 cost time: 0.7755253314971924
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3497822 Best vali loss: 0.3497822
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7838163375854492
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3527853 Best vali loss: 0.3497822
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7764949798583984
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3622489 Best vali loss: 0.3497822
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7797017097473145
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3614015 Best vali loss: 0.3497822

best validation loss 0.3497821607852029

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4590163
	speed: 0.0110s/iter; left time: 44.3161s
	iters: 200, epoch: 1 | loss: 0.6352499
	speed: 0.0051s/iter; left time: 19.9170s
	iters: 300, epoch: 1 | loss: 1.2226250
	speed: 0.0051s/iter; left time: 19.5195s
	iters: 400, epoch: 1 | loss: 0.5931667
	speed: 0.0052s/iter; left time: 19.1344s
	iters: 500, epoch: 1 | loss: 0.7782110
	speed: 0.0051s/iter; left time: 18.4926s
Updating learning rate to 7.464840260592189e-05
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 2.9771735668182373
Epoch: 1, Steps: 514 | Train Loss: 0.7376538 Vali Loss: 0.3636692 Best vali loss: 0.3636692
	iters: 100, epoch: 2 | loss: 0.6926468
	speed: 0.0098s/iter; left time: 34.2111s
	iters: 200, epoch: 2 | loss: 0.5272378
	speed: 0.0047s/iter; left time: 16.0227s
	iters: 300, epoch: 2 | loss: 0.6738645
	speed: 0.0049s/iter; left time: 16.0696s
	iters: 400, epoch: 2 | loss: 0.7756371
	speed: 0.0048s/iter; left time: 15.4225s
	iters: 500, epoch: 2 | loss: 0.3388881
	speed: 0.0049s/iter; left time: 15.1119s
Updating learning rate to 6.623740839270309e-05
Epoch: 2 cost time: 2.509133815765381
Epoch: 2, Steps: 514 | Train Loss: 0.6016549 Vali Loss: 0.3676720 Best vali loss: 0.3636692
	iters: 100, epoch: 3 | loss: 0.4258934
	speed: 0.0099s/iter; left time: 29.5033s
	iters: 200, epoch: 3 | loss: 0.6973028
	speed: 0.0050s/iter; left time: 14.4737s
	iters: 300, epoch: 3 | loss: 0.7909817
	speed: 0.0049s/iter; left time: 13.7197s
	iters: 400, epoch: 3 | loss: 0.9011502
	speed: 0.0050s/iter; left time: 13.3165s
	iters: 500, epoch: 3 | loss: 0.6727300
	speed: 0.0050s/iter; left time: 12.9235s
Updating learning rate to 5.3649465983453756e-05
Epoch: 3 cost time: 2.5928409099578857
Epoch: 3, Steps: 514 | Train Loss: 0.6976116 Vali Loss: 0.3946669 Best vali loss: 0.3636692
	iters: 100, epoch: 4 | loss: 0.2899632
	speed: 0.0098s/iter; left time: 24.2418s
	iters: 200, epoch: 4 | loss: 0.5253064
	speed: 0.0046s/iter; left time: 11.0024s
	iters: 300, epoch: 4 | loss: 0.6713558
	speed: 0.0049s/iter; left time: 11.0420s
	iters: 400, epoch: 4 | loss: 0.3096279
	speed: 0.0048s/iter; left time: 10.3375s
	iters: 500, epoch: 4 | loss: 0.4858392
	speed: 0.0047s/iter; left time: 9.7623s
Updating learning rate to 3.88009755e-05
Epoch: 4 cost time: 2.4846317768096924
Epoch: 4, Steps: 514 | Train Loss: 0.4564185 Vali Loss: 0.3795987 Best vali loss: 0.3636692
	iters: 100, epoch: 5 | loss: 0.6425813
	speed: 0.0097s/iter; left time: 19.0249s
	iters: 200, epoch: 5 | loss: 0.6547173
	speed: 0.0050s/iter; left time: 9.2169s
	iters: 300, epoch: 5 | loss: 0.2956188
	speed: 0.0049s/iter; left time: 8.5877s
	iters: 400, epoch: 5 | loss: 0.3984730
	speed: 0.0047s/iter; left time: 7.8332s
	iters: 500, epoch: 5 | loss: 0.3253891
	speed: 0.0049s/iter; left time: 7.6865s
Updating learning rate to 2.3952485016546247e-05
Validation loss decreased (0.3637 --> 0.3577).  Saving model state dict ...
Epoch: 5 cost time: 2.5717406272888184
Epoch: 5, Steps: 514 | Train Loss: 0.4633559 Vali Loss: 0.3577203 Best vali loss: 0.3577203
	iters: 100, epoch: 6 | loss: 0.3043591
	speed: 0.0103s/iter; left time: 14.8394s
	iters: 200, epoch: 6 | loss: 0.2512249
	speed: 0.0049s/iter; left time: 6.6215s
	iters: 300, epoch: 6 | loss: 0.5301314
	speed: 0.0049s/iter; left time: 6.1214s
	iters: 400, epoch: 6 | loss: 0.7952878
	speed: 0.0050s/iter; left time: 5.6725s
	iters: 500, epoch: 6 | loss: 0.5421981
	speed: 0.0049s/iter; left time: 5.0991s
Updating learning rate to 1.1364542607296912e-05
Validation loss decreased (0.3577 --> 0.3541).  Saving model state dict ...
Epoch: 6 cost time: 2.58630633354187
Epoch: 6, Steps: 514 | Train Loss: 0.4846403 Vali Loss: 0.3541350 Best vali loss: 0.3541350
	iters: 100, epoch: 7 | loss: 0.3167081
	speed: 0.0104s/iter; left time: 9.6641s
	iters: 200, epoch: 7 | loss: 0.3271365
	speed: 0.0052s/iter; left time: 4.3042s
	iters: 300, epoch: 7 | loss: 0.8387613
	speed: 0.0051s/iter; left time: 3.7469s
	iters: 400, epoch: 7 | loss: 0.5565484
	speed: 0.0052s/iter; left time: 3.2927s
	iters: 500, epoch: 7 | loss: 0.2463373
	speed: 0.0052s/iter; left time: 2.7529s
Updating learning rate to 2.9535483940781098e-06
Epoch: 7 cost time: 2.718374252319336
Epoch: 7, Steps: 514 | Train Loss: 0.4570983 Vali Loss: 0.3784864 Best vali loss: 0.3541350
	iters: 100, epoch: 8 | loss: 0.3321261
	speed: 0.0103s/iter; left time: 4.2637s
	iters: 200, epoch: 8 | loss: 0.2857791
	speed: 0.0052s/iter; left time: 1.6488s
	iters: 300, epoch: 8 | loss: 0.7185922
	speed: 0.0052s/iter; left time: 1.1238s
	iters: 400, epoch: 8 | loss: 0.6695646
	speed: 0.0053s/iter; left time: 0.6068s
	iters: 500, epoch: 8 | loss: 0.2784559
	speed: 0.0052s/iter; left time: 0.0781s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.734156370162964
Epoch: 8, Steps: 514 | Train Loss: 0.4569036 Vali Loss: 0.3697627 Best vali loss: 0.3541350

best validation loss 0.3541350233414318

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022121251808, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.0989480018615723
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710461 Best vali loss: 0.3710461
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3710 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 0.7830953598022461
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3641941 Best vali loss: 0.3641941
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7813568115234375
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3734174 Best vali loss: 0.3641941
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3642 --> 0.3480).  Saving model state dict ...
Epoch: 4 cost time: 0.7845637798309326
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3480370 Best vali loss: 0.3480370
Updating learning rate to 0.0002182291873478251
Epoch: 5 cost time: 0.7798781394958496
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3574619 Best vali loss: 0.3480370
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7766530513763428
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3712695 Best vali loss: 0.3480370
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7835187911987305
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3664084 Best vali loss: 0.3480370
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7810554504394531
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3751223 Best vali loss: 0.3480370

best validation loss 0.34803701148520283

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022031285254, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.0918591022491455
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711288 Best vali loss: 0.3711288
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3711 --> 0.3601).  Saving model state dict ...
Epoch: 2 cost time: 0.7846698760986328
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3601097 Best vali loss: 0.3601097
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7824580669403076
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3832862 Best vali loss: 0.3601097

best validation loss 0.3601097010676191

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002152927228, 'e_layers': 4, 'learning_rate': 0.0007067594335, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006798600042599609
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0901482105255127
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712444 Best vali loss: 0.3712444
Updating learning rate to 0.0006032569107977063
Validation loss decreased (0.3712 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 0.7775869369506836
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3636937 Best vali loss: 0.3636937
Updating learning rate to 0.0004886122796840932
Epoch: 3 cost time: 0.7825624942779541
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3840840 Best vali loss: 0.3636937

best validation loss 0.36369370712746807

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002022860033, 'e_layers': 4, 'learning_rate': 0.000706568897, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006796767196236877
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.0975592136383057
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711216 Best vali loss: 0.3711216
Updating learning rate to 0.0006030942777220995
Validation loss decreased (0.3711 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 0.7855148315429688
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3689880 Best vali loss: 0.3689880
Updating learning rate to 0.0004884805538531878
Epoch: 3 cost time: 0.7788655757904053
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3739658 Best vali loss: 0.3689880

best validation loss 0.36898804404178165

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022031285254, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 1.0958034992218018
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3694802 Best vali loss: 0.3601097
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3601 --> 0.3562).  Saving model state dict ...
Epoch: 5 cost time: 0.7848103046417236
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3562008 Best vali loss: 0.3562008
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3562 --> 0.3536).  Saving model state dict ...
Epoch: 6 cost time: 0.7822484970092773
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3535787 Best vali loss: 0.3535787
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7830731868743896
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3608715 Best vali loss: 0.3535787
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7875921726226807
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3627197 Best vali loss: 0.3535787

best validation loss 0.35357874601435335

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007069999492, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007069999492
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.093409538269043
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711599 Best vali loss: 0.3711599
Updating learning rate to 0.0003534999746
Validation loss decreased (0.3712 --> 0.3635).  Saving model state dict ...
Epoch: 2 cost time: 0.7860617637634277
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3634696 Best vali loss: 0.3634696
Updating learning rate to 0.0001767499873
Epoch: 3 cost time: 0.7873919010162354
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3673293 Best vali loss: 0.3634696
Updating learning rate to 8.837499365e-05
Validation loss decreased (0.3635 --> 0.3521).  Saving model state dict ...
Epoch: 4 cost time: 0.7761027812957764
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3520516 Best vali loss: 0.3520516
Updating learning rate to 4.4187496825e-05
Validation loss decreased (0.3521 --> 0.3451).  Saving model state dict ...
Epoch: 5 cost time: 0.782780647277832
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3451197 Best vali loss: 0.3451197
Updating learning rate to 2.20937484125e-05
Epoch: 6 cost time: 0.7808535099029541
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3469876 Best vali loss: 0.3451197
Updating learning rate to 1.104687420625e-05
Epoch: 7 cost time: 0.7777349948883057
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3459022 Best vali loss: 0.3451197
Updating learning rate to 5.523437103125e-06
Epoch: 8 cost time: 0.7787036895751953
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3463621 Best vali loss: 0.3451197

best validation loss 0.34511971405775

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008043881686, 'e_layers': 4, 'learning_rate': 0.0004018320868, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4915133
	speed: 0.0117s/iter; left time: 22.9324s
	iters: 200, epoch: 1 | loss: 0.5988674
	speed: 0.0054s/iter; left time: 9.9939s
Updating learning rate to 0.0004018320868
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 1.7248384952545166
Epoch: 1, Steps: 257 | Train Loss: 0.5451903 Vali Loss: 0.3666184 Best vali loss: 0.3666184
	iters: 100, epoch: 2 | loss: 0.4769716
	speed: 0.0111s/iter; left time: 18.9046s
	iters: 200, epoch: 2 | loss: 0.6085161
	speed: 0.0054s/iter; left time: 8.6936s
Updating learning rate to 0.0002009160434
Validation loss decreased (0.3666 --> 0.3626).  Saving model state dict ...
Epoch: 2 cost time: 1.4254193305969238
Epoch: 2, Steps: 257 | Train Loss: 0.5427438 Vali Loss: 0.3626223 Best vali loss: 0.3626223
	iters: 100, epoch: 3 | loss: 0.5343512
	speed: 0.0108s/iter; left time: 15.5566s
	iters: 200, epoch: 3 | loss: 0.3356345
	speed: 0.0053s/iter; left time: 7.0744s
Updating learning rate to 0.0001004580217
Epoch: 3 cost time: 1.4041721820831299
Epoch: 3, Steps: 257 | Train Loss: 0.4349928 Vali Loss: 0.3729140 Best vali loss: 0.3626223
	iters: 100, epoch: 4 | loss: 0.3066804
	speed: 0.0112s/iter; left time: 13.3078s
	iters: 200, epoch: 4 | loss: 0.6193703
	speed: 0.0053s/iter; left time: 5.7891s
Updating learning rate to 5.022901085e-05
Validation loss decreased (0.3626 --> 0.3588).  Saving model state dict ...
Epoch: 4 cost time: 1.4219696521759033
Epoch: 4, Steps: 257 | Train Loss: 0.4630254 Vali Loss: 0.3588010 Best vali loss: 0.3588010
	iters: 100, epoch: 5 | loss: 0.9137575
	speed: 0.0116s/iter; left time: 10.7411s
	iters: 200, epoch: 5 | loss: 0.5278556
	speed: 0.0053s/iter; left time: 4.3978s
Updating learning rate to 2.5114505425e-05
Epoch: 5 cost time: 1.4235711097717285
Epoch: 5, Steps: 257 | Train Loss: 0.7208065 Vali Loss: 0.3633557 Best vali loss: 0.3588010
	iters: 100, epoch: 6 | loss: 0.4334106
	speed: 0.0108s/iter; left time: 7.2325s
	iters: 200, epoch: 6 | loss: 0.4712182
	speed: 0.0051s/iter; left time: 2.9300s
Updating learning rate to 1.25572527125e-05
Epoch: 6 cost time: 1.3625376224517822
Epoch: 6, Steps: 257 | Train Loss: 0.4523144 Vali Loss: 0.3637123 Best vali loss: 0.3588010
	iters: 100, epoch: 7 | loss: 0.4773640
	speed: 0.0107s/iter; left time: 4.4401s
	iters: 200, epoch: 7 | loss: 0.5027764
	speed: 0.0051s/iter; left time: 1.6135s
Updating learning rate to 6.27862635625e-06
Epoch: 7 cost time: 1.35050630569458
Epoch: 7, Steps: 257 | Train Loss: 0.4900702 Vali Loss: 0.3621384 Best vali loss: 0.3588010
	iters: 100, epoch: 8 | loss: 0.6881943
	speed: 0.0105s/iter; left time: 1.6553s
	iters: 200, epoch: 8 | loss: 0.5748820
	speed: 0.0050s/iter; left time: 0.2908s
Updating learning rate to 3.139313178125e-06
Epoch: 8 cost time: 1.330709457397461
Epoch: 8, Steps: 257 | Train Loss: 0.6315382 Vali Loss: 0.3634673 Best vali loss: 0.3588010

best validation loss 0.3588010085940595

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.002213934128, 'e_layers': 4, 'learning_rate': 0.000706568897, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000706568897
Validation loss decreased (inf --> 0.3851).  Saving model state dict ...
Epoch: 1 cost time: 0.7641613483428955
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3851102 Best vali loss: 0.3851102
Updating learning rate to 0.0003532844485
Validation loss decreased (0.3851 --> 0.3692).  Saving model state dict ...
Epoch: 2 cost time: 0.442476749420166
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3691628 Best vali loss: 0.3691628
Updating learning rate to 0.00017664222425
Validation loss decreased (0.3692 --> 0.3669).  Saving model state dict ...
Epoch: 3 cost time: 0.4875953197479248
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3669458 Best vali loss: 0.3669458

best validation loss 0.36694582643349655

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0022908018972, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3851).  Saving model state dict ...
Epoch: 1 cost time: 0.7730071544647217
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3851032 Best vali loss: 0.3851032
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3851 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 0.416245698928833
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3694195 Best vali loss: 0.3694195
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3694 --> 0.3666).  Saving model state dict ...
Epoch: 3 cost time: 0.43145108222961426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3665831 Best vali loss: 0.3665831

best validation loss 0.3665831027307304

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0021538547784, 'e_layers': 4, 'learning_rate': 0.000706559378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000706559378
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.107372522354126
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3670239 Best vali loss: 0.3670239
Updating learning rate to 0.000353279689
Epoch: 2 cost time: 0.7915291786193848
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3701115 Best vali loss: 0.3670239
Updating learning rate to 0.0001766398445
Validation loss decreased (0.3670 --> 0.3602).  Saving model state dict ...
Epoch: 3 cost time: 0.7932279109954834
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3602384 Best vali loss: 0.3602384

best validation loss 0.3602383524120908

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0021538547784, 'e_layers': 4, 'learning_rate': 0.000706559378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.831992225e-05
Validation loss decreased (0.3602 --> 0.3476).  Saving model state dict ...
Epoch: 4 cost time: 1.1181442737579346
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3476169 Best vali loss: 0.3476169
Updating learning rate to 4.4159961125e-05
Epoch: 5 cost time: 0.7914314270019531
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3515516 Best vali loss: 0.3476169
Updating learning rate to 2.20799805625e-05
Epoch: 6 cost time: 0.7922394275665283
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3489610 Best vali loss: 0.3476169
Updating learning rate to 1.103999028125e-05
Epoch: 7 cost time: 0.7907226085662842
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3491756 Best vali loss: 0.3476169
Updating learning rate to 5.519995140625e-06
Epoch: 8 cost time: 0.7945990562438965
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3504282 Best vali loss: 0.3476169

best validation loss 0.3476168686842403

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.004127692326, 'e_layers': 4, 'learning_rate': 5.21822957e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.0196225328340864e-05
Validation loss decreased (inf --> 0.4409).  Saving model state dict ...
Epoch: 1 cost time: 0.772005558013916
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4408910 Best vali loss: 0.4408910
Updating learning rate to 4.454037542367581e-05
Validation loss decreased (0.4409 --> 0.4314).  Saving model state dict ...
Epoch: 2 cost time: 0.4446380138397217
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4314213 Best vali loss: 0.4314213
Updating learning rate to 3.607579786358303e-05
Validation loss decreased (0.4314 --> 0.4244).  Saving model state dict ...
Epoch: 3 cost time: 0.46157050132751465
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4244485 Best vali loss: 0.4244485
Updating learning rate to 2.609114785e-05
Validation loss decreased (0.4244 --> 0.4195).  Saving model state dict ...
Epoch: 4 cost time: 0.47026610374450684
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4195052 Best vali loss: 0.4195052
Updating learning rate to 1.610649783641697e-05
Validation loss decreased (0.4195 --> 0.4161).  Saving model state dict ...
Epoch: 5 cost time: 0.4610574245452881
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4160670 Best vali loss: 0.4160670
Updating learning rate to 7.64192027632419e-06
Validation loss decreased (0.4161 --> 0.4142).  Saving model state dict ...
Epoch: 6 cost time: 0.44931960105895996
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4141637 Best vali loss: 0.4141637
Updating learning rate to 1.9860703716591358e-06
Validation loss decreased (0.4142 --> 0.4133).  Saving model state dict ...
Epoch: 7 cost time: 0.4320495128631592
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4133129 Best vali loss: 0.4133129
Updating learning rate to 0.0
Validation loss decreased (0.4133 --> 0.4131).  Saving model state dict ...
Epoch: 8 cost time: 0.46360135078430176
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4130952 Best vali loss: 0.4130952

best validation loss 0.4130951991015661

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0047193037573, 'e_layers': 4, 'learning_rate': 5.50642812e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.296852178656302e-05
Validation loss decreased (inf --> 0.4403).  Saving model state dict ...
Epoch: 1 cost time: 0.7755398750305176
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4402937 Best vali loss: 0.4402937
Updating learning rate to 4.700030391884146e-05
Validation loss decreased (0.4403 --> 0.4305).  Saving model state dict ...
Epoch: 2 cost time: 0.4676990509033203
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4304699 Best vali loss: 0.4304699
Updating learning rate to 3.806823466516624e-05
Validation loss decreased (0.4305 --> 0.4233).  Saving model state dict ...
Epoch: 3 cost time: 0.46572113037109375
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4232865 Best vali loss: 0.4232865
Updating learning rate to 2.75321406e-05
Validation loss decreased (0.4233 --> 0.4182).  Saving model state dict ...
Epoch: 4 cost time: 0.42858052253723145
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4182190 Best vali loss: 0.4182190
Updating learning rate to 1.6996046534833757e-05
Validation loss decreased (0.4182 --> 0.4147).  Saving model state dict ...
Epoch: 5 cost time: 0.454453706741333
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4146989 Best vali loss: 0.4146989
Updating learning rate to 8.06397728115854e-06
Validation loss decreased (0.4147 --> 0.4128).  Saving model state dict ...
Epoch: 6 cost time: 0.45856428146362305
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4127599 Best vali loss: 0.4127599
Updating learning rate to 2.0957594134369826e-06
Validation loss decreased (0.4128 --> 0.4119).  Saving model state dict ...
Epoch: 7 cost time: 0.4269261360168457
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4118959 Best vali loss: 0.4118959
Updating learning rate to 0.0
Validation loss decreased (0.4119 --> 0.4117).  Saving model state dict ...
Epoch: 8 cost time: 0.4091670513153076
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4116751 Best vali loss: 0.4116751

best validation loss 0.41167507261798986

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023017933173, 'e_layers': 4, 'learning_rate': 5.33353363e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.130538093358813e-05
Validation loss decreased (inf --> 0.3644).  Saving model state dict ...
Epoch: 1 cost time: 1.2571814060211182
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3643620 Best vali loss: 0.3643620
Updating learning rate to 4.552455713729751e-05
Validation loss decreased (0.3644 --> 0.3609).  Saving model state dict ...
Epoch: 2 cost time: 0.9501216411590576
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3609241 Best vali loss: 0.3609241
Updating learning rate to 3.6872942930815184e-05
Validation loss decreased (0.3609 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 0.9513731002807617
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3609099 Best vali loss: 0.3609099

best validation loss 0.3609099366458788

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002271471894, 'e_layers': 4, 'learning_rate': 0.000707086744, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000707086744
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0821480751037598
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712171 Best vali loss: 0.3712171
Updating learning rate to 0.000353543372
Validation loss decreased (0.3712 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.774665117263794
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619720 Best vali loss: 0.3619720
Updating learning rate to 0.000176771686
Epoch: 3 cost time: 0.7797017097473145
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3636766 Best vali loss: 0.3619720

best validation loss 0.36197200725495465

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015206249299, 'e_layers': 4, 'learning_rate': 0.0036651766384, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1820824
	speed: 0.0112s/iter; left time: 44.7744s
	iters: 200, epoch: 1 | loss: 1.0606523
	speed: 0.0052s/iter; left time: 20.1612s
	iters: 300, epoch: 1 | loss: 0.5572662
	speed: 0.0052s/iter; left time: 19.7462s
	iters: 400, epoch: 1 | loss: 0.3158244
	speed: 0.0052s/iter; left time: 19.2053s
	iters: 500, epoch: 1 | loss: 0.4937848
	speed: 0.0052s/iter; left time: 18.7277s
Updating learning rate to 0.0035256791588281406
Validation loss decreased (inf --> 0.4068).  Saving model state dict ...
Epoch: 1 cost time: 2.98893141746521
Epoch: 1, Steps: 514 | Train Loss: 0.7219220 Vali Loss: 0.4068035 Best vali loss: 0.4068035
	iters: 100, epoch: 2 | loss: 1.0418811
	speed: 0.0101s/iter; left time: 35.2814s
	iters: 200, epoch: 2 | loss: 0.7468331
	speed: 0.0051s/iter; left time: 17.4013s
	iters: 300, epoch: 2 | loss: 1.0222915
	speed: 0.0050s/iter; left time: 16.5880s
	iters: 400, epoch: 2 | loss: 0.8700814
	speed: 0.0050s/iter; left time: 16.1190s
	iters: 500, epoch: 2 | loss: 0.7064840
	speed: 0.0050s/iter; left time: 15.6045s
Updating learning rate to 0.0031284239468295774
Validation loss decreased (0.4068 --> 0.4021).  Saving model state dict ...
Epoch: 2 cost time: 2.6536200046539307
Epoch: 2, Steps: 514 | Train Loss: 0.8775142 Vali Loss: 0.4021473 Best vali loss: 0.4021473
	iters: 100, epoch: 3 | loss: 0.3960749
	speed: 0.0100s/iter; left time: 29.8317s
	iters: 200, epoch: 3 | loss: 0.8128017
	speed: 0.0050s/iter; left time: 14.4827s
	iters: 300, epoch: 3 | loss: 0.7569467
	speed: 0.0051s/iter; left time: 14.1453s
	iters: 400, epoch: 3 | loss: 0.4391072
	speed: 0.0051s/iter; left time: 13.7052s
	iters: 500, epoch: 3 | loss: 0.6350181
	speed: 0.0052s/iter; left time: 13.4845s
Updating learning rate to 0.0025338895073036267
Epoch: 3 cost time: 2.659433364868164
Epoch: 3, Steps: 514 | Train Loss: 0.6079897 Vali Loss: 0.4062336 Best vali loss: 0.4021473

best validation loss 0.40214733337372366

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023017933173, 'e_layers': 4, 'learning_rate': 5.33353363e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.666766815e-05
Epoch: 4 cost time: 1.2721846103668213
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3618337 Best vali loss: 0.3609099
Updating learning rate to 1.6462393369184817e-05
Validation loss decreased (0.3609 --> 0.3591).  Saving model state dict ...
Epoch: 5 cost time: 0.9535708427429199
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3590769 Best vali loss: 0.3590769
Updating learning rate to 7.810779162702489e-06
Validation loss decreased (0.3591 --> 0.3575).  Saving model state dict ...
Epoch: 6 cost time: 0.9488003253936768
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3575171 Best vali loss: 0.3575171
Updating learning rate to 2.029955366411869e-06
Epoch: 7 cost time: 0.9529922008514404
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3577949 Best vali loss: 0.3575171
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9533991813659668
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3576903 Best vali loss: 0.3575171

best validation loss 0.35751707569086716

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022726313726, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.08730149269104
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712805 Best vali loss: 0.3712805
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3713 --> 0.3622).  Saving model state dict ...
Epoch: 2 cost time: 0.7758398056030273
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3621723 Best vali loss: 0.3621723
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3622 --> 0.3572).  Saving model state dict ...
Epoch: 3 cost time: 0.7784101963043213
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3571619 Best vali loss: 0.3571619
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3572 --> 0.3511).  Saving model state dict ...
Epoch: 4 cost time: 0.7768659591674805
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3510890 Best vali loss: 0.3510890
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3511 --> 0.3475).  Saving model state dict ...
Epoch: 5 cost time: 0.7799112796783447
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3475474 Best vali loss: 0.3475474
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.782691240310669
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3495480 Best vali loss: 0.3475474
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7807025909423828
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3481330 Best vali loss: 0.3475474
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7759814262390137
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3478050 Best vali loss: 0.3475474

best validation loss 0.3475473941660583

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022727954486, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.0999934673309326
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713019 Best vali loss: 0.3713019
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3713 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 0.7833607196807861
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3646646 Best vali loss: 0.3646646
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3647 --> 0.3591).  Saving model state dict ...
Epoch: 3 cost time: 0.7847208976745605
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3590530 Best vali loss: 0.3590530
Updating learning rate to 8.8440874725e-05
Validation loss decreased (0.3591 --> 0.3501).  Saving model state dict ...
Epoch: 4 cost time: 0.7881596088409424
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3500762 Best vali loss: 0.3500762
Updating learning rate to 4.42204373625e-05
Validation loss decreased (0.3501 --> 0.3465).  Saving model state dict ...
Epoch: 5 cost time: 0.788546085357666
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3465195 Best vali loss: 0.3465195
Updating learning rate to 2.211021868125e-05
Validation loss decreased (0.3465 --> 0.3456).  Saving model state dict ...
Epoch: 6 cost time: 0.7831289768218994
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3456251 Best vali loss: 0.3456251
Updating learning rate to 1.1055109340625e-05
Validation loss decreased (0.3456 --> 0.3438).  Saving model state dict ...
Epoch: 7 cost time: 0.7834503650665283
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3438204 Best vali loss: 0.3438204
Updating learning rate to 5.5275546703125e-06
Validation loss decreased (0.3438 --> 0.3438).  Saving model state dict ...
Epoch: 8 cost time: 0.785747766494751
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3437672 Best vali loss: 0.3437672

best validation loss 0.3437671818878421

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022647254635, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 1.0887596607208252
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3716516 Best vali loss: 0.3716516
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3717 --> 0.3716).  Saving model state dict ...
Epoch: 2 cost time: 0.7801070213317871
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3716414 Best vali loss: 0.3716414
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.7745497226715088
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3767164 Best vali loss: 0.3716414

best validation loss 0.3716413945018191

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0037214799094, 'e_layers': 4, 'learning_rate': 0.000105263012, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6820256
	speed: 0.0119s/iter; left time: 11.0600s
Updating learning rate to 0.00010125667715864499
Validation loss decreased (inf --> 0.4203).  Saving model state dict ...
Epoch: 1 cost time: 1.090277910232544
Epoch: 1, Steps: 129 | Train Loss: 0.6820256 Vali Loss: 0.4202522 Best vali loss: 0.4202522
	iters: 100, epoch: 2 | loss: 0.7422060
	speed: 0.0088s/iter; left time: 7.0927s
Updating learning rate to 8.984760079666046e-05
Validation loss decreased (0.4203 --> 0.4010).  Saving model state dict ...
Epoch: 2 cost time: 0.7010602951049805
Epoch: 2, Steps: 129 | Train Loss: 0.7422060 Vali Loss: 0.4009623 Best vali loss: 0.4009623
	iters: 100, epoch: 3 | loss: 0.4586818
	speed: 0.0088s/iter; left time: 5.9347s
Updating learning rate to 7.277271136662382e-05
Validation loss decreased (0.4010 --> 0.3909).  Saving model state dict ...
Epoch: 3 cost time: 0.7106342315673828
Epoch: 3, Steps: 129 | Train Loss: 0.4586818 Vali Loss: 0.3908636 Best vali loss: 0.3908636

best validation loss 0.39086357339894606

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0083132513184, 'e_layers': 1, 'learning_rate': 0.0005105414965, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5798628
	speed: 0.0094s/iter; left time: 8.7595s
Updating learning rate to 0.0005105414965
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.7608036994934082
Epoch: 1, Steps: 129 | Train Loss: 0.5798628 Vali Loss: 0.3663370 Best vali loss: 0.3663370
	iters: 100, epoch: 2 | loss: 0.5699232
	speed: 0.0060s/iter; left time: 4.8391s
Updating learning rate to 0.00025527074825
Epoch: 2 cost time: 0.4539675712585449
Epoch: 2, Steps: 129 | Train Loss: 0.5699232 Vali Loss: 0.3684798 Best vali loss: 0.3663370
	iters: 100, epoch: 3 | loss: 0.5368717
	speed: 0.0057s/iter; left time: 3.8487s
Updating learning rate to 0.000127635374125
Epoch: 3 cost time: 0.4308788776397705
Epoch: 3, Steps: 129 | Train Loss: 0.5368717 Vali Loss: 0.3682539 Best vali loss: 0.3663370

best validation loss 0.36633700933344004

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0083132513184, 'e_layers': 1, 'learning_rate': 0.0005105414965, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5591114
	speed: 0.0094s/iter; left time: 5.1299s
Updating learning rate to 6.38176870625e-05
Epoch: 4 cost time: 0.7618906497955322
Epoch: 4, Steps: 129 | Train Loss: 0.5591114 Vali Loss: 0.3729308 Best vali loss: 0.3663370
	iters: 100, epoch: 5 | loss: 0.5549829
	speed: 0.0059s/iter; left time: 2.4684s
Updating learning rate to 3.190884353125e-05
Epoch: 5 cost time: 0.45142054557800293
Epoch: 5, Steps: 129 | Train Loss: 0.5549829 Vali Loss: 0.3737338 Best vali loss: 0.3663370
	iters: 100, epoch: 6 | loss: 0.4943673
	speed: 0.0057s/iter; left time: 1.6519s
Updating learning rate to 1.5954421765625e-05
Epoch: 6 cost time: 0.4301307201385498
Epoch: 6, Steps: 129 | Train Loss: 0.4943673 Vali Loss: 0.3748618 Best vali loss: 0.3663370
	iters: 100, epoch: 7 | loss: 0.6811815
	speed: 0.0058s/iter; left time: 0.9259s
Updating learning rate to 7.9772108828125e-06
Epoch: 7 cost time: 0.4534173011779785
Epoch: 7, Steps: 129 | Train Loss: 0.6811815 Vali Loss: 0.3748917 Best vali loss: 0.3663370
	iters: 100, epoch: 8 | loss: 0.4773250
	speed: 0.0056s/iter; left time: 0.1677s
Updating learning rate to 3.98860544140625e-06
Epoch: 8 cost time: 0.4133303165435791
Epoch: 8, Steps: 129 | Train Loss: 0.4773250 Vali Loss: 0.3745643 Best vali loss: 0.3663370

best validation loss 0.36633700933344004

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0027225049879, 'e_layers': 2, 'learning_rate': 5.63360614e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4199440
	speed: 0.0096s/iter; left time: 38.4705s
	iters: 200, epoch: 1 | loss: 0.7996201
	speed: 0.0034s/iter; left time: 13.4890s
	iters: 300, epoch: 1 | loss: 1.7189858
	speed: 0.0035s/iter; left time: 13.3285s
	iters: 400, epoch: 1 | loss: 0.6220859
	speed: 0.0034s/iter; left time: 12.5578s
	iters: 500, epoch: 1 | loss: 0.4361418
	speed: 0.0033s/iter; left time: 11.8325s
Updating learning rate to 5.419189773487957e-05
Validation loss decreased (inf --> 0.4188).  Saving model state dict ...
Epoch: 1 cost time: 2.0968451499938965
Epoch: 1, Steps: 514 | Train Loss: 0.7993555 Vali Loss: 0.4187545 Best vali loss: 0.4187545
	iters: 100, epoch: 2 | loss: 0.4257086
	speed: 0.0069s/iter; left time: 24.0480s
	iters: 200, epoch: 2 | loss: 1.1087258
	speed: 0.0030s/iter; left time: 10.0383s
	iters: 300, epoch: 2 | loss: 0.9262848
	speed: 0.0029s/iter; left time: 9.6419s
	iters: 400, epoch: 2 | loss: 0.7856945
	speed: 0.0029s/iter; left time: 9.1283s
	iters: 500, epoch: 2 | loss: 0.5263686
	speed: 0.0029s/iter; left time: 9.1399s
Updating learning rate to 4.8085836220640846e-05
Validation loss decreased (0.4188 --> 0.3999).  Saving model state dict ...
Epoch: 2 cost time: 1.5586998462677002
Epoch: 2, Steps: 514 | Train Loss: 0.7545565 Vali Loss: 0.3998822 Best vali loss: 0.3998822
	iters: 100, epoch: 3 | loss: 0.4770153
	speed: 0.0066s/iter; left time: 19.5745s
	iters: 200, epoch: 3 | loss: 0.8910325
	speed: 0.0032s/iter; left time: 9.2290s
	iters: 300, epoch: 3 | loss: 0.7371724
	speed: 0.0031s/iter; left time: 8.6220s
	iters: 400, epoch: 3 | loss: 0.4217887
	speed: 0.0031s/iter; left time: 8.2352s
	iters: 500, epoch: 3 | loss: 0.9671235
	speed: 0.0030s/iter; left time: 7.7521s
Updating learning rate to 3.894746937124122e-05
Validation loss decreased (0.3999 --> 0.3906).  Saving model state dict ...
Epoch: 3 cost time: 1.6199314594268799
Epoch: 3, Steps: 514 | Train Loss: 0.6988265 Vali Loss: 0.3905634 Best vali loss: 0.3905634
	iters: 100, epoch: 4 | loss: 0.8573541
	speed: 0.0068s/iter; left time: 16.8684s
	iters: 200, epoch: 4 | loss: 0.7221721
	speed: 0.0030s/iter; left time: 7.1460s
	iters: 300, epoch: 4 | loss: 0.4038984
	speed: 0.0030s/iter; left time: 6.7594s
	iters: 400, epoch: 4 | loss: 1.1427014
	speed: 0.0031s/iter; left time: 6.6927s
	iters: 500, epoch: 4 | loss: 0.5007349
	speed: 0.0031s/iter; left time: 6.3745s
Updating learning rate to 2.81680307e-05
Validation loss decreased (0.3906 --> 0.3853).  Saving model state dict ...
Epoch: 4 cost time: 1.6004142761230469
Epoch: 4, Steps: 514 | Train Loss: 0.7253722 Vali Loss: 0.3853387 Best vali loss: 0.3853387
	iters: 100, epoch: 5 | loss: 0.3962132
	speed: 0.0068s/iter; left time: 13.3201s
	iters: 200, epoch: 5 | loss: 0.4336593
	speed: 0.0030s/iter; left time: 5.6625s
	iters: 300, epoch: 5 | loss: 0.7104157
	speed: 0.0031s/iter; left time: 5.4290s
	iters: 400, epoch: 5 | loss: 0.3538807
	speed: 0.0031s/iter; left time: 5.1460s
	iters: 500, epoch: 5 | loss: 0.6292843
	speed: 0.0031s/iter; left time: 4.8124s
Updating learning rate to 1.7388592028758777e-05
Validation loss decreased (0.3853 --> 0.3826).  Saving model state dict ...
Epoch: 5 cost time: 1.6288073062896729
Epoch: 5, Steps: 514 | Train Loss: 0.5046906 Vali Loss: 0.3825889 Best vali loss: 0.3825889
	iters: 100, epoch: 6 | loss: 0.6084529
	speed: 0.0073s/iter; left time: 10.5913s
	iters: 200, epoch: 6 | loss: 1.2195513
	speed: 0.0033s/iter; left time: 4.4682s
	iters: 300, epoch: 6 | loss: 0.5710415
	speed: 0.0034s/iter; left time: 4.2192s
	iters: 400, epoch: 6 | loss: 0.6822851
	speed: 0.0034s/iter; left time: 3.9292s
	iters: 500, epoch: 6 | loss: 0.9395711
	speed: 0.0034s/iter; left time: 3.5260s
Updating learning rate to 8.250225179359148e-06
Validation loss decreased (0.3826 --> 0.3810).  Saving model state dict ...
Epoch: 6 cost time: 1.7962639331817627
Epoch: 6, Steps: 514 | Train Loss: 0.8041804 Vali Loss: 0.3809571 Best vali loss: 0.3809571
	iters: 100, epoch: 7 | loss: 0.7470096
	speed: 0.0069s/iter; left time: 6.4093s
	iters: 200, epoch: 7 | loss: 0.3833701
	speed: 0.0029s/iter; left time: 2.3844s
	iters: 300, epoch: 7 | loss: 1.1507039
	speed: 0.0029s/iter; left time: 2.0958s
	iters: 400, epoch: 7 | loss: 0.4665038
	speed: 0.0029s/iter; left time: 1.8200s
	iters: 500, epoch: 7 | loss: 0.4549862
	speed: 0.0030s/iter; left time: 1.5633s
Updating learning rate to 2.144163665120427e-06
Validation loss decreased (0.3810 --> 0.3802).  Saving model state dict ...
Epoch: 7 cost time: 1.539276361465454
Epoch: 7, Steps: 514 | Train Loss: 0.6405147 Vali Loss: 0.3801942 Best vali loss: 0.3801942
	iters: 100, epoch: 8 | loss: 0.6832054
	speed: 0.0070s/iter; left time: 2.9067s
	iters: 200, epoch: 8 | loss: 0.5708730
	speed: 0.0030s/iter; left time: 0.9452s
	iters: 300, epoch: 8 | loss: 0.6014063
	speed: 0.0030s/iter; left time: 0.6461s
	iters: 400, epoch: 8 | loss: 0.8155741
	speed: 0.0031s/iter; left time: 0.3528s
	iters: 500, epoch: 8 | loss: 0.6569101
	speed: 0.0030s/iter; left time: 0.0446s
Updating learning rate to 0.0
Validation loss decreased (0.3802 --> 0.3800).  Saving model state dict ...
Epoch: 8 cost time: 1.592163324356079
Epoch: 8, Steps: 514 | Train Loss: 0.6655938 Vali Loss: 0.3799879 Best vali loss: 0.3799879

best validation loss 0.3799878548662414

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 0.7722487449645996
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3719526 Best vali loss: 0.3719526
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3720 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.45363950729370117
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3669916 Best vali loss: 0.3669916
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3670 --> 0.3658).  Saving model state dict ...
Epoch: 3 cost time: 0.43100905418395996
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3658047 Best vali loss: 0.3658047
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.4717850685119629
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3685541 Best vali loss: 0.3658047
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.4579598903656006
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3683615 Best vali loss: 0.3658047
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.4725775718688965
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3692143 Best vali loss: 0.3658047
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.4769313335418701
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3692942 Best vali loss: 0.3658047
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.47911596298217773
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3694712 Best vali loss: 0.3658047

best validation loss 0.36580466706532627

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0022141549086, 'e_layers': 4, 'learning_rate': 0.000707427595, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000707427595
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 0.7813720703125
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3677074 Best vali loss: 0.3677074
Updating learning rate to 0.0003537137975
Validation loss decreased (0.3677 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.45409631729125977
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3648477 Best vali loss: 0.3648477
Updating learning rate to 0.00017685689875
Epoch: 3 cost time: 0.4827287197113037
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3664607 Best vali loss: 0.3648477

best validation loss 0.3648477308408216

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070937849963, 'e_layers': 1, 'learning_rate': 7.51775533e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6137315
	speed: 0.0093s/iter; left time: 8.6777s
Updating learning rate to 7.231627804907318e-05
Validation loss decreased (inf --> 0.4221).  Saving model state dict ...
Epoch: 1 cost time: 0.7524585723876953
Epoch: 1, Steps: 129 | Train Loss: 0.6137315 Vali Loss: 0.4220519 Best vali loss: 0.4220519
	iters: 100, epoch: 2 | loss: 0.9904364
	speed: 0.0056s/iter; left time: 4.4896s
Updating learning rate to 6.416805551572156e-05
Validation loss decreased (0.4221 --> 0.4023).  Saving model state dict ...
Epoch: 2 cost time: 0.4174036979675293
Epoch: 2, Steps: 129 | Train Loss: 0.9904364 Vali Loss: 0.4023480 Best vali loss: 0.4023480
	iters: 100, epoch: 3 | loss: 0.5946363
	speed: 0.0057s/iter; left time: 3.8713s
Updating learning rate to 5.1973378716826744e-05
Validation loss decreased (0.4023 --> 0.3905).  Saving model state dict ...
Epoch: 3 cost time: 0.4432075023651123
Epoch: 3, Steps: 129 | Train Loss: 0.5946363 Vali Loss: 0.3904992 Best vali loss: 0.3904992

best validation loss 0.39049916187766026

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007078889889, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007078889889
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 0.7756228446960449
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3677092 Best vali loss: 0.3677092
Updating learning rate to 0.00035394449445
Validation loss decreased (0.3677 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 0.479445219039917
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3649325 Best vali loss: 0.3649325
Updating learning rate to 0.000176972247225
Epoch: 3 cost time: 0.47757840156555176
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3660579 Best vali loss: 0.3649325

best validation loss 0.3649325266568272

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0022141549086, 'e_layers': 4, 'learning_rate': 0.000707427595, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8428449375e-05
Validation loss decreased (0.3648 --> 0.3612).  Saving model state dict ...
Epoch: 4 cost time: 0.773629903793335
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3611953 Best vali loss: 0.3611953
Updating learning rate to 4.42142246875e-05
Epoch: 5 cost time: 0.471041202545166
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3635370 Best vali loss: 0.3611953
Updating learning rate to 2.210711234375e-05
Epoch: 6 cost time: 0.4610767364501953
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3627084 Best vali loss: 0.3611953
Updating learning rate to 1.1053556171875e-05
Epoch: 7 cost time: 0.467648983001709
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3628683 Best vali loss: 0.3611953
Updating learning rate to 5.5267780859375e-06
Epoch: 8 cost time: 0.4593496322631836
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3637449 Best vali loss: 0.3611953

best validation loss 0.3611952755446518

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007269159433, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007269159433
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 0.8003323078155518
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3678065 Best vali loss: 0.3678065
Updating learning rate to 0.00036345797165
Validation loss decreased (0.3678 --> 0.3658).  Saving model state dict ...
Epoch: 2 cost time: 0.48276782035827637
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3657886 Best vali loss: 0.3657886
Updating learning rate to 0.000181728985825
Epoch: 3 cost time: 0.477846622467041
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3664740 Best vali loss: 0.3657886
Updating learning rate to 9.08644929125e-05
Epoch: 4 cost time: 0.44614720344543457
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3671741 Best vali loss: 0.3657886
Updating learning rate to 4.543224645625e-05
Validation loss decreased (0.3658 --> 0.3657).  Saving model state dict ...
Epoch: 5 cost time: 0.47219085693359375
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3657481 Best vali loss: 0.3657481
Updating learning rate to 2.2716123228125e-05
Validation loss decreased (0.3657 --> 0.3632).  Saving model state dict ...
Epoch: 6 cost time: 0.44541406631469727
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3631530 Best vali loss: 0.3631530
Updating learning rate to 1.13580616140625e-05
Epoch: 7 cost time: 0.44526219367980957
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3650563 Best vali loss: 0.3631530
Updating learning rate to 5.67903080703125e-06
Epoch: 8 cost time: 0.43904805183410645
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3655225 Best vali loss: 0.3631530

best validation loss 0.3631530220007381

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0022121251808, 'e_layers': 4, 'learning_rate': 0.0007089753461, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007089753461
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 0.783092737197876
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3677216 Best vali loss: 0.3677216
Updating learning rate to 0.00035448767305
Validation loss decreased (0.3677 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.4681727886199951
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3650192 Best vali loss: 0.3650192
Updating learning rate to 0.000177243836525
Epoch: 3 cost time: 0.46860313415527344
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3666371 Best vali loss: 0.3650192
Updating learning rate to 8.86219182625e-05
Epoch: 4 cost time: 0.4714171886444092
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3664043 Best vali loss: 0.3650192
Updating learning rate to 4.431095913125e-05
Epoch: 5 cost time: 0.47191762924194336
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3660567 Best vali loss: 0.3650192
Updating learning rate to 2.2155479565625e-05
Validation loss decreased (0.3650 --> 0.3615).  Saving model state dict ...
Epoch: 6 cost time: 0.47008776664733887
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3615245 Best vali loss: 0.3615245
Updating learning rate to 1.10777397828125e-05
Epoch: 7 cost time: 0.4827907085418701
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3626693 Best vali loss: 0.3615245
Updating learning rate to 5.53886989140625e-06
Epoch: 8 cost time: 0.4750864505767822
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3643446 Best vali loss: 0.3615245

best validation loss 0.36152450599230107

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0022284883714, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 0.7838404178619385
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3719508 Best vali loss: 0.3719508
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3720 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.4708716869354248
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3669791 Best vali loss: 0.3669791
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3670 --> 0.3658).  Saving model state dict ...
Epoch: 3 cost time: 0.46563172340393066
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3657661 Best vali loss: 0.3657661

best validation loss 0.365766075282762

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0078803887102, 'e_layers': 2, 'learning_rate': 0.0029971854148, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2990708
	speed: 0.0093s/iter; left time: 37.4846s
	iters: 200, epoch: 1 | loss: 0.3029381
	speed: 0.0031s/iter; left time: 12.1215s
	iters: 300, epoch: 1 | loss: 0.7605924
	speed: 0.0031s/iter; left time: 11.8398s
	iters: 400, epoch: 1 | loss: 0.9730212
	speed: 0.0033s/iter; left time: 12.1167s
	iters: 500, epoch: 1 | loss: 0.3888381
	speed: 0.0032s/iter; left time: 11.7116s
Updating learning rate to 0.0029971854148
Validation loss decreased (inf --> 0.3656).  Saving model state dict ...
Epoch: 1 cost time: 1.9901537895202637
Epoch: 1, Steps: 514 | Train Loss: 0.5448921 Vali Loss: 0.3656255 Best vali loss: 0.3656255
	iters: 100, epoch: 2 | loss: 1.7876453
	speed: 0.0073s/iter; left time: 25.4279s
	iters: 200, epoch: 2 | loss: 0.6924492
	speed: 0.0034s/iter; left time: 11.5094s
	iters: 300, epoch: 2 | loss: 0.9160342
	speed: 0.0033s/iter; left time: 10.9825s
	iters: 400, epoch: 2 | loss: 0.6367983
	speed: 0.0033s/iter; left time: 10.6957s
	iters: 500, epoch: 2 | loss: 0.5527865
	speed: 0.0034s/iter; left time: 10.5136s
Updating learning rate to 0.0014985927074
Epoch: 2 cost time: 1.7659502029418945
Epoch: 2, Steps: 514 | Train Loss: 0.9171427 Vali Loss: 0.3664813 Best vali loss: 0.3656255
	iters: 100, epoch: 3 | loss: 0.3278328
	speed: 0.0072s/iter; left time: 21.5453s
	iters: 200, epoch: 3 | loss: 0.4258492
	speed: 0.0034s/iter; left time: 9.8749s
	iters: 300, epoch: 3 | loss: 0.4433430
	speed: 0.0033s/iter; left time: 9.1785s
	iters: 400, epoch: 3 | loss: 1.0521954
	speed: 0.0033s/iter; left time: 8.8664s
	iters: 500, epoch: 3 | loss: 0.7215902
	speed: 0.0032s/iter; left time: 8.2270s
Updating learning rate to 0.0007492963537
Epoch: 3 cost time: 1.7461488246917725
Epoch: 3, Steps: 514 | Train Loss: 0.5941621 Vali Loss: 0.3788351 Best vali loss: 0.3656255

best validation loss 0.3656254973357693

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022145178441, 'e_layers': 4, 'learning_rate': 0.0007079088911, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007079088911
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.1099317073822021
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711738 Best vali loss: 0.3711738
Updating learning rate to 0.00035395444555
Validation loss decreased (0.3712 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 0.7780234813690186
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3641340 Best vali loss: 0.3641340
Updating learning rate to 0.000176977222775
Validation loss decreased (0.3641 --> 0.3485).  Saving model state dict ...
Epoch: 3 cost time: 0.7754263877868652
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3485392 Best vali loss: 0.3485392

best validation loss 0.3485391839665374

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022145178441, 'e_layers': 4, 'learning_rate': 0.0007079088911, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.84886113875e-05
Epoch: 4 cost time: 1.100728988647461
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3498445 Best vali loss: 0.3485392
Updating learning rate to 4.424430569375e-05
Validation loss decreased (0.3485 --> 0.3452).  Saving model state dict ...
Epoch: 5 cost time: 0.7844865322113037
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3451660 Best vali loss: 0.3451660
Updating learning rate to 2.2122152846875e-05
Validation loss decreased (0.3452 --> 0.3424).  Saving model state dict ...
Epoch: 6 cost time: 0.7794969081878662
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3424239 Best vali loss: 0.3424239
Updating learning rate to 1.10610764234375e-05
Epoch: 7 cost time: 0.787259578704834
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3438551 Best vali loss: 0.3424239
Updating learning rate to 5.53053821171875e-06
Epoch: 8 cost time: 0.7802703380584717
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3451874 Best vali loss: 0.3424239

best validation loss 0.3424239240718497

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022144278717, 'e_layers': 4, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007077576329
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.09712815284729
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712699 Best vali loss: 0.3712699
Updating learning rate to 0.00035387881645
Validation loss decreased (0.3713 --> 0.3555).  Saving model state dict ...
Epoch: 2 cost time: 0.7779066562652588
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3554693 Best vali loss: 0.3554693
Updating learning rate to 0.000176939408225
Epoch: 3 cost time: 0.7808132171630859
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3562330 Best vali loss: 0.3554693
Updating learning rate to 8.84697041125e-05
Validation loss decreased (0.3555 --> 0.3461).  Saving model state dict ...
Epoch: 4 cost time: 0.7750771045684814
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3460755 Best vali loss: 0.3460755
Updating learning rate to 4.423485205625e-05
Validation loss decreased (0.3461 --> 0.3402).  Saving model state dict ...
Epoch: 5 cost time: 0.7779245376586914
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3401834 Best vali loss: 0.3401834
Updating learning rate to 2.2117426028125e-05
Epoch: 6 cost time: 0.776496171951294
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3424149 Best vali loss: 0.3401834
Updating learning rate to 1.10587130140625e-05
Validation loss decreased (0.3402 --> 0.3396).  Saving model state dict ...
Epoch: 7 cost time: 0.7748379707336426
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3396380 Best vali loss: 0.3396380
Updating learning rate to 5.52935650703125e-06
Epoch: 8 cost time: 0.7792112827301025
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3403416 Best vali loss: 0.3396380

best validation loss 0.3396380324494862

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007187587251, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007187587251
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.1043477058410645
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687772 Best vali loss: 0.3687772
Updating learning rate to 0.00035937936255
Validation loss decreased (0.3688 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 0.7826685905456543
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3662931 Best vali loss: 0.3662931
Updating learning rate to 0.000179689681275
Validation loss decreased (0.3663 --> 0.3584).  Saving model state dict ...
Epoch: 3 cost time: 0.7863173484802246
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3583844 Best vali loss: 0.3583844
Updating learning rate to 8.98448406375e-05
Validation loss decreased (0.3584 --> 0.3516).  Saving model state dict ...
Epoch: 4 cost time: 0.7835018634796143
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3516288 Best vali loss: 0.3516288
Updating learning rate to 4.492242031875e-05
Validation loss decreased (0.3516 --> 0.3513).  Saving model state dict ...
Epoch: 5 cost time: 0.7834439277648926
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3513474 Best vali loss: 0.3513474
Updating learning rate to 2.2461210159375e-05
Epoch: 6 cost time: 0.7859888076782227
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3559014 Best vali loss: 0.3513474
Updating learning rate to 1.12306050796875e-05
Epoch: 7 cost time: 0.7781186103820801
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3550098 Best vali loss: 0.3513474
Updating learning rate to 5.61530253984375e-06
Epoch: 8 cost time: 0.7797117233276367
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3552144 Best vali loss: 0.3513474

best validation loss 0.3513474224241403

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022137879088, 'e_layers': 4, 'learning_rate': 0.0006998206578, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006998206578
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.0874428749084473
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708867 Best vali loss: 0.3708867
Updating learning rate to 0.0003499103289
Validation loss decreased (0.3709 --> 0.3527).  Saving model state dict ...
Epoch: 2 cost time: 0.7743203639984131
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3527184 Best vali loss: 0.3527184
Updating learning rate to 0.00017495516445
Epoch: 3 cost time: 0.7819316387176514
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3581738 Best vali loss: 0.3527184

best validation loss 0.35271844343961106

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022878047458, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3834).  Saving model state dict ...
Epoch: 1 cost time: 1.2389774322509766
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3833835 Best vali loss: 0.3833835
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.9496157169342041
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3877508 Best vali loss: 0.3833835
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3834 --> 0.3697).  Saving model state dict ...
Epoch: 3 cost time: 0.952843189239502
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3696855 Best vali loss: 0.3696855

best validation loss 0.36968550308514203

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022133151506, 'e_layers': 4, 'learning_rate': 0.0007098843963, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007098843963
Validation loss decreased (inf --> 0.3823).  Saving model state dict ...
Epoch: 1 cost time: 1.2438769340515137
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3823439 Best vali loss: 0.3823439
Updating learning rate to 0.00035494219815
Validation loss decreased (0.3823 --> 0.3752).  Saving model state dict ...
Epoch: 2 cost time: 0.9473705291748047
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3751663 Best vali loss: 0.3751663
Updating learning rate to 0.000177471099075
Validation loss decreased (0.3752 --> 0.3690).  Saving model state dict ...
Epoch: 3 cost time: 0.9512465000152588
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3689681 Best vali loss: 0.3689681

best validation loss 0.36896809799732067

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022137879088, 'e_layers': 4, 'learning_rate': 0.0006998206578, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.7477582225e-05
Epoch: 4 cost time: 1.0996911525726318
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3531891 Best vali loss: 0.3527184
Updating learning rate to 4.37387911125e-05
Validation loss decreased (0.3527 --> 0.3525).  Saving model state dict ...
Epoch: 5 cost time: 0.7814264297485352
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3524542 Best vali loss: 0.3524542
Updating learning rate to 2.186939555625e-05
Validation loss decreased (0.3525 --> 0.3465).  Saving model state dict ...
Epoch: 6 cost time: 0.7840671539306641
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3464567 Best vali loss: 0.3464567
Updating learning rate to 1.0934697778125e-05
Validation loss decreased (0.3465 --> 0.3437).  Saving model state dict ...
Epoch: 7 cost time: 0.7761452198028564
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3436690 Best vali loss: 0.3436690
Updating learning rate to 5.4673488890625e-06
Epoch: 8 cost time: 0.7778141498565674
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3469440 Best vali loss: 0.3436690

best validation loss 0.3436690102157518

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0101053328956, 'e_layers': 3, 'learning_rate': 0.000152294015, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3977982
	speed: 0.0103s/iter; left time: 41.4014s
	iters: 200, epoch: 1 | loss: 0.4277648
	speed: 0.0044s/iter; left time: 17.1722s
	iters: 300, epoch: 1 | loss: 0.4498133
	speed: 0.0044s/iter; left time: 16.6025s
	iters: 400, epoch: 1 | loss: 0.5095706
	speed: 0.0042s/iter; left time: 15.4718s
	iters: 500, epoch: 1 | loss: 0.6761995
	speed: 0.0044s/iter; left time: 15.7557s
Updating learning rate to 0.000152294015
Validation loss decreased (inf --> 0.3731).  Saving model state dict ...
Epoch: 1 cost time: 2.571085214614868
Epoch: 1, Steps: 514 | Train Loss: 0.4922293 Vali Loss: 0.3730721 Best vali loss: 0.3730721
	iters: 100, epoch: 2 | loss: 0.3444430
	speed: 0.0086s/iter; left time: 30.2516s
	iters: 200, epoch: 2 | loss: 0.5063857
	speed: 0.0044s/iter; left time: 14.8388s
	iters: 300, epoch: 2 | loss: 0.7403876
	speed: 0.0044s/iter; left time: 14.4102s
	iters: 400, epoch: 2 | loss: 0.6683590
	speed: 0.0044s/iter; left time: 13.9277s
	iters: 500, epoch: 2 | loss: 0.5193679
	speed: 0.0043s/iter; left time: 13.2968s
Updating learning rate to 7.61470075e-05
Validation loss decreased (0.3731 --> 0.3693).  Saving model state dict ...
Epoch: 2 cost time: 2.27042555809021
Epoch: 2, Steps: 514 | Train Loss: 0.5557886 Vali Loss: 0.3692529 Best vali loss: 0.3692529
	iters: 100, epoch: 3 | loss: 1.2788925
	speed: 0.0083s/iter; left time: 24.7437s
	iters: 200, epoch: 3 | loss: 0.6957943
	speed: 0.0042s/iter; left time: 12.0227s
	iters: 300, epoch: 3 | loss: 0.4743639
	speed: 0.0044s/iter; left time: 12.2481s
	iters: 400, epoch: 3 | loss: 0.3964346
	speed: 0.0044s/iter; left time: 11.9033s
	iters: 500, epoch: 3 | loss: 0.2480993
	speed: 0.0043s/iter; left time: 11.2440s
Updating learning rate to 3.807350375e-05
Validation loss decreased (0.3693 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 2.2404873371124268
Epoch: 3, Steps: 514 | Train Loss: 0.6187169 Vali Loss: 0.3677384 Best vali loss: 0.3677384
	iters: 100, epoch: 4 | loss: 1.2498789
	speed: 0.0088s/iter; left time: 21.6616s
	iters: 200, epoch: 4 | loss: 0.5021523
	speed: 0.0044s/iter; left time: 10.4821s
	iters: 300, epoch: 4 | loss: 0.6989918
	speed: 0.0043s/iter; left time: 9.7775s
	iters: 400, epoch: 4 | loss: 0.5702953
	speed: 0.0042s/iter; left time: 9.1376s
	iters: 500, epoch: 4 | loss: 0.4772226
	speed: 0.0041s/iter; left time: 8.4550s
Updating learning rate to 1.9036751875e-05
Epoch: 4 cost time: 2.2423737049102783
Epoch: 4, Steps: 514 | Train Loss: 0.6997082 Vali Loss: 0.3679579 Best vali loss: 0.3677384
	iters: 100, epoch: 5 | loss: 0.8514127
	speed: 0.0086s/iter; left time: 16.8765s
	iters: 200, epoch: 5 | loss: 0.4680273
	speed: 0.0043s/iter; left time: 8.0353s
	iters: 300, epoch: 5 | loss: 0.4952334
	speed: 0.0044s/iter; left time: 7.8150s
	iters: 400, epoch: 5 | loss: 0.5810586
	speed: 0.0044s/iter; left time: 7.2630s
	iters: 500, epoch: 5 | loss: 0.5949509
	speed: 0.0044s/iter; left time: 6.8561s
Updating learning rate to 9.5183759375e-06
Epoch: 5 cost time: 2.274360418319702
Epoch: 5, Steps: 514 | Train Loss: 0.5981366 Vali Loss: 0.3687147 Best vali loss: 0.3677384
	iters: 100, epoch: 6 | loss: 1.1266867
	speed: 0.0085s/iter; left time: 12.2455s
	iters: 200, epoch: 6 | loss: 0.4069405
	speed: 0.0044s/iter; left time: 5.8826s
	iters: 300, epoch: 6 | loss: 0.4148733
	speed: 0.0044s/iter; left time: 5.5138s
	iters: 400, epoch: 6 | loss: 0.7182645
	speed: 0.0044s/iter; left time: 5.0022s
	iters: 500, epoch: 6 | loss: 0.7664563
	speed: 0.0043s/iter; left time: 4.4396s
Updating learning rate to 4.75918796875e-06
Epoch: 6 cost time: 2.281273126602173
Epoch: 6, Steps: 514 | Train Loss: 0.6866443 Vali Loss: 0.3693013 Best vali loss: 0.3677384
	iters: 100, epoch: 7 | loss: 0.7848956
	speed: 0.0087s/iter; left time: 8.0489s
	iters: 200, epoch: 7 | loss: 0.5135008
	speed: 0.0042s/iter; left time: 3.5208s
	iters: 300, epoch: 7 | loss: 0.5556189
	speed: 0.0043s/iter; left time: 3.1415s
	iters: 400, epoch: 7 | loss: 0.6354203
	speed: 0.0044s/iter; left time: 2.7755s
	iters: 500, epoch: 7 | loss: 0.3373588
	speed: 0.0043s/iter; left time: 2.2632s
Updating learning rate to 2.379593984375e-06
Epoch: 7 cost time: 2.2600302696228027
Epoch: 7, Steps: 514 | Train Loss: 0.5653589 Vali Loss: 0.3693193 Best vali loss: 0.3677384
	iters: 100, epoch: 8 | loss: 0.9400656
	speed: 0.0085s/iter; left time: 3.5357s
	iters: 200, epoch: 8 | loss: 0.6370283
	speed: 0.0042s/iter; left time: 1.3269s
	iters: 300, epoch: 8 | loss: 0.3291518
	speed: 0.0041s/iter; left time: 0.8811s
	iters: 400, epoch: 8 | loss: 0.5503228
	speed: 0.0042s/iter; left time: 0.4880s
	iters: 500, epoch: 8 | loss: 1.4974142
	speed: 0.0040s/iter; left time: 0.0598s
Updating learning rate to 1.1897969921875e-06
Epoch: 8 cost time: 2.1657917499542236
Epoch: 8, Steps: 514 | Train Loss: 0.7907965 Vali Loss: 0.3692080 Best vali loss: 0.3677384

best validation loss 0.3677383508101428

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002258675339, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 1.0643656253814697
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3727484 Best vali loss: 0.3727484
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3727 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.7632105350494385
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3669974 Best vali loss: 0.3669974
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3670 --> 0.3645).  Saving model state dict ...
Epoch: 3 cost time: 0.7685773372650146
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3644966 Best vali loss: 0.3644966
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3645 --> 0.3602).  Saving model state dict ...
Epoch: 4 cost time: 0.7692608833312988
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3602043 Best vali loss: 0.3602043
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3602 --> 0.3584).  Saving model state dict ...
Epoch: 5 cost time: 0.7671327590942383
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3584482 Best vali loss: 0.3584482
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.7750544548034668
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3735324 Best vali loss: 0.3584482
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7744243144989014
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3692028 Best vali loss: 0.3584482
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.767803430557251
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3677858 Best vali loss: 0.3584482

best validation loss 0.3584482007621548

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0020063969917, 'e_layers': 3, 'learning_rate': 0.0012225670436, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4140836
	speed: 0.0100s/iter; left time: 80.9229s
	iters: 200, epoch: 1 | loss: 0.9015976
	speed: 0.0042s/iter; left time: 33.3700s
	iters: 300, epoch: 1 | loss: 1.5045593
	speed: 0.0043s/iter; left time: 33.8818s
	iters: 400, epoch: 1 | loss: 0.5171202
	speed: 0.0042s/iter; left time: 32.8647s
	iters: 500, epoch: 1 | loss: 0.5841122
	speed: 0.0043s/iter; left time: 32.8237s
	iters: 600, epoch: 1 | loss: 0.2857528
	speed: 0.0043s/iter; left time: 32.7386s
	iters: 700, epoch: 1 | loss: 0.3250908
	speed: 0.0043s/iter; left time: 32.5056s
	iters: 800, epoch: 1 | loss: 1.0410455
	speed: 0.0042s/iter; left time: 31.3201s
	iters: 900, epoch: 1 | loss: 0.5491614
	speed: 0.0043s/iter; left time: 31.2820s
	iters: 1000, epoch: 1 | loss: 1.0938346
	speed: 0.0042s/iter; left time: 30.6072s
Updating learning rate to 0.0012225670436
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 4.681082010269165
Epoch: 1, Steps: 1027 | Train Loss: 0.8216358 Vali Loss: 0.3726557 Best vali loss: 0.3726557
	iters: 100, epoch: 2 | loss: 0.2389188
	speed: 0.0108s/iter; left time: 76.8380s
	iters: 200, epoch: 2 | loss: 0.8867497
	speed: 0.0037s/iter; left time: 25.7482s
	iters: 300, epoch: 2 | loss: 0.3018619
	speed: 0.0037s/iter; left time: 25.3751s
	iters: 400, epoch: 2 | loss: 0.6147218
	speed: 0.0036s/iter; left time: 24.5375s
	iters: 500, epoch: 2 | loss: 0.3738872
	speed: 0.0037s/iter; left time: 24.5129s
	iters: 600, epoch: 2 | loss: 0.3065860
	speed: 0.0037s/iter; left time: 24.4166s
	iters: 700, epoch: 2 | loss: 0.9029400
	speed: 0.0037s/iter; left time: 24.2192s
	iters: 800, epoch: 2 | loss: 0.4529134
	speed: 0.0038s/iter; left time: 24.4376s
	iters: 900, epoch: 2 | loss: 0.9821144
	speed: 0.0038s/iter; left time: 24.0866s
	iters: 1000, epoch: 2 | loss: 0.7367094
	speed: 0.0038s/iter; left time: 23.4596s
Updating learning rate to 0.0006112835218
Epoch: 2 cost time: 3.8729188442230225
Epoch: 2, Steps: 1027 | Train Loss: 0.5797402 Vali Loss: 0.3814759 Best vali loss: 0.3726557
	iters: 100, epoch: 3 | loss: 0.1997137
	speed: 0.0110s/iter; left time: 66.8122s
	iters: 200, epoch: 3 | loss: 0.4364327
	speed: 0.0040s/iter; left time: 24.0896s
	iters: 300, epoch: 3 | loss: 1.4863187
	speed: 0.0041s/iter; left time: 23.8053s
	iters: 400, epoch: 3 | loss: 0.7399477
	speed: 0.0041s/iter; left time: 23.5532s
	iters: 500, epoch: 3 | loss: 1.1690980
	speed: 0.0041s/iter; left time: 23.2256s
	iters: 600, epoch: 3 | loss: 0.3607247
	speed: 0.0042s/iter; left time: 23.1537s
	iters: 700, epoch: 3 | loss: 0.5450267
	speed: 0.0041s/iter; left time: 22.3202s
	iters: 800, epoch: 3 | loss: 0.3672773
	speed: 0.0042s/iter; left time: 22.3237s
	iters: 900, epoch: 3 | loss: 0.4377997
	speed: 0.0041s/iter; left time: 21.7917s
	iters: 1000, epoch: 3 | loss: 0.3713019
	speed: 0.0042s/iter; left time: 21.4778s
Updating learning rate to 0.0003056417609
Epoch: 3 cost time: 4.262382745742798
Epoch: 3, Steps: 1027 | Train Loss: 0.6113641 Vali Loss: 0.3733321 Best vali loss: 0.3726557

best validation loss 0.37265571616955967

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012228413212, 'e_layers': 3, 'learning_rate': 0.0003253069217, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031292566422144085
Validation loss decreased (inf --> 0.3639).  Saving model state dict ...
Epoch: 1 cost time: 0.7758545875549316
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3638947 Best vali loss: 0.3638947
Updating learning rate to 0.00027766682600049563
Validation loss decreased (0.3639 --> 0.3624).  Saving model state dict ...
Epoch: 2 cost time: 0.46439146995544434
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3623682 Best vali loss: 0.3623682
Updating learning rate to 0.00022489824553413877
Epoch: 3 cost time: 0.4618713855743408
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3825613 Best vali loss: 0.3623682

best validation loss 0.36236816106001846

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007073711667
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0832078456878662
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711523 Best vali loss: 0.3711523
Updating learning rate to 0.00035368558335
Validation loss decreased (0.3712 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.7831950187683105
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3668150 Best vali loss: 0.3668150
Updating learning rate to 0.000176842791675
Epoch: 3 cost time: 0.7833406925201416
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3678004 Best vali loss: 0.3668150

best validation loss 0.36681498876957624

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012228413212, 'e_layers': 3, 'learning_rate': 0.0003253069217, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00016265346085
Epoch: 4 cost time: 0.7867848873138428
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3830732 Best vali loss: 0.3623682
Updating learning rate to 0.00010040867616586125
Validation loss decreased (0.3624 --> 0.3481).  Saving model state dict ...
Epoch: 5 cost time: 0.47004127502441406
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3480968 Best vali loss: 0.3480968
Updating learning rate to 4.764009569950438e-05
Epoch: 6 cost time: 0.46177029609680176
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3553098 Best vali loss: 0.3480968
Updating learning rate to 1.238125747855912e-05
Epoch: 7 cost time: 0.46135854721069336
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3637613 Best vali loss: 0.3480968
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4764387607574463
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3613598 Best vali loss: 0.3480968

best validation loss 0.34809680720443575

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0017159356462, 'e_layers': 2, 'learning_rate': 0.0019301088022, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1167608
	speed: 0.0096s/iter; left time: 38.6707s
	iters: 200, epoch: 1 | loss: 0.5649182
	speed: 0.0035s/iter; left time: 13.7580s
	iters: 300, epoch: 1 | loss: 0.4937940
	speed: 0.0035s/iter; left time: 13.2712s
	iters: 400, epoch: 1 | loss: 0.5555273
	speed: 0.0033s/iter; left time: 12.3091s
	iters: 500, epoch: 1 | loss: 1.0390275
	speed: 0.0034s/iter; left time: 12.1454s
Updating learning rate to 0.0019301088022
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.1155285835266113
Epoch: 1, Steps: 514 | Train Loss: 0.7540056 Vali Loss: 0.3747762 Best vali loss: 0.3747762
	iters: 100, epoch: 2 | loss: 0.6739267
	speed: 0.0071s/iter; left time: 24.7580s
	iters: 200, epoch: 2 | loss: 0.7967570
	speed: 0.0031s/iter; left time: 10.4240s
	iters: 300, epoch: 2 | loss: 1.2153708
	speed: 0.0031s/iter; left time: 10.2900s
	iters: 400, epoch: 2 | loss: 0.7880202
	speed: 0.0030s/iter; left time: 9.5922s
	iters: 500, epoch: 2 | loss: 0.4559176
	speed: 0.0032s/iter; left time: 9.7796s
Updating learning rate to 0.0009650544011
Validation loss decreased (0.3748 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 1.6365101337432861
Epoch: 2, Steps: 514 | Train Loss: 0.7859985 Vali Loss: 0.3703032 Best vali loss: 0.3703032
	iters: 100, epoch: 3 | loss: 0.6408033
	speed: 0.0071s/iter; left time: 21.1109s
	iters: 200, epoch: 3 | loss: 0.7421787
	speed: 0.0031s/iter; left time: 8.9091s
	iters: 300, epoch: 3 | loss: 0.6309081
	speed: 0.0031s/iter; left time: 8.6115s
	iters: 400, epoch: 3 | loss: 0.8972008
	speed: 0.0032s/iter; left time: 8.7004s
	iters: 500, epoch: 3 | loss: 0.5152397
	speed: 0.0032s/iter; left time: 8.1548s
Updating learning rate to 0.00048252720055
Epoch: 3 cost time: 1.6630914211273193
Epoch: 3, Steps: 514 | Train Loss: 0.6852661 Vali Loss: 0.3803928 Best vali loss: 0.3703032
	iters: 100, epoch: 4 | loss: 0.4301391
	speed: 0.0069s/iter; left time: 17.0490s
	iters: 200, epoch: 4 | loss: 0.3995260
	speed: 0.0032s/iter; left time: 7.5603s
	iters: 300, epoch: 4 | loss: 0.6357833
	speed: 0.0031s/iter; left time: 7.1296s
	iters: 400, epoch: 4 | loss: 0.2369874
	speed: 0.0031s/iter; left time: 6.7257s
	iters: 500, epoch: 4 | loss: 0.6472464
	speed: 0.0032s/iter; left time: 6.5710s
Updating learning rate to 0.000241263600275
Epoch: 4 cost time: 1.6540398597717285
Epoch: 4, Steps: 514 | Train Loss: 0.4699364 Vali Loss: 0.3853630 Best vali loss: 0.3703032
	iters: 100, epoch: 5 | loss: 0.6901037
	speed: 0.0070s/iter; left time: 13.7385s
	iters: 200, epoch: 5 | loss: 0.3099872
	speed: 0.0031s/iter; left time: 5.8206s
	iters: 300, epoch: 5 | loss: 0.5367942
	speed: 0.0031s/iter; left time: 5.3736s
	iters: 400, epoch: 5 | loss: 1.1238326
	speed: 0.0032s/iter; left time: 5.3123s
	iters: 500, epoch: 5 | loss: 0.9292693
	speed: 0.0031s/iter; left time: 4.8310s
Updating learning rate to 0.0001206318001375
Epoch: 5 cost time: 1.6666686534881592
Epoch: 5, Steps: 514 | Train Loss: 0.7179974 Vali Loss: 0.3831799 Best vali loss: 0.3703032
	iters: 100, epoch: 6 | loss: 0.4861821
	speed: 0.0073s/iter; left time: 10.4653s
	iters: 200, epoch: 6 | loss: 0.3621907
	speed: 0.0031s/iter; left time: 4.1610s
	iters: 300, epoch: 6 | loss: 0.3810791
	speed: 0.0032s/iter; left time: 3.9213s
	iters: 400, epoch: 6 | loss: 0.7657757
	speed: 0.0031s/iter; left time: 3.5508s
	iters: 500, epoch: 6 | loss: 0.6158268
	speed: 0.0032s/iter; left time: 3.3399s
Updating learning rate to 6.031590006875e-05
Epoch: 6 cost time: 1.6766645908355713
Epoch: 6, Steps: 514 | Train Loss: 0.5222109 Vali Loss: 0.3858591 Best vali loss: 0.3703032
	iters: 100, epoch: 7 | loss: 0.3377923
	speed: 0.0069s/iter; left time: 6.4450s
	iters: 200, epoch: 7 | loss: 0.8557885
	speed: 0.0031s/iter; left time: 2.5944s
	iters: 300, epoch: 7 | loss: 0.3989252
	speed: 0.0034s/iter; left time: 2.4664s
	iters: 400, epoch: 7 | loss: 0.3229482
	speed: 0.0033s/iter; left time: 2.0948s
	iters: 500, epoch: 7 | loss: 0.3318434
	speed: 0.0034s/iter; left time: 1.7755s
Updating learning rate to 3.0157950034375e-05
Epoch: 7 cost time: 1.7146286964416504
Epoch: 7, Steps: 514 | Train Loss: 0.4494595 Vali Loss: 0.3877950 Best vali loss: 0.3703032
	iters: 100, epoch: 8 | loss: 0.8679758
	speed: 0.0070s/iter; left time: 2.9210s
	iters: 200, epoch: 8 | loss: 0.6072095
	speed: 0.0032s/iter; left time: 0.9924s
	iters: 300, epoch: 8 | loss: 0.4815269
	speed: 0.0032s/iter; left time: 0.6820s
	iters: 400, epoch: 8 | loss: 0.5192240
	speed: 0.0032s/iter; left time: 0.3656s
	iters: 500, epoch: 8 | loss: 0.3595343
	speed: 0.0032s/iter; left time: 0.0478s
Updating learning rate to 1.50789750171875e-05
Epoch: 8 cost time: 1.6820168495178223
Epoch: 8, Steps: 514 | Train Loss: 0.5670941 Vali Loss: 0.3867232 Best vali loss: 0.3703032

best validation loss 0.3703032448507245

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 1.1182188987731934
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3667658 Best vali loss: 0.3667658
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7930700778961182
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3759395 Best vali loss: 0.3667658
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3668 --> 0.3628).  Saving model state dict ...
Epoch: 3 cost time: 0.786036491394043
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3628048 Best vali loss: 0.3628048
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3628 --> 0.3573).  Saving model state dict ...
Epoch: 4 cost time: 0.7939944267272949
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3572835 Best vali loss: 0.3572835
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3573 --> 0.3521).  Saving model state dict ...
Epoch: 5 cost time: 0.7925033569335938
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3520825 Best vali loss: 0.3520825
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3521 --> 0.3433).  Saving model state dict ...
Epoch: 6 cost time: 0.7903785705566406
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3433310 Best vali loss: 0.3433310
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7887792587280273
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3489305 Best vali loss: 0.3433310
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7972662448883057
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3528326 Best vali loss: 0.3433310

best validation loss 0.34333097418305447

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 1.100255012512207
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3666268 Best vali loss: 0.3666268
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7875771522521973
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3685024 Best vali loss: 0.3666268
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3666 --> 0.3554).  Saving model state dict ...
Epoch: 3 cost time: 0.7876186370849609
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3554113 Best vali loss: 0.3554113

best validation loss 0.35541133367710825

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023000474692, 'e_layers': 4, 'learning_rate': 0.0007073414481, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006804198672482423
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 1.1004478931427002
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3668127 Best vali loss: 0.3668127
Updating learning rate to 0.0006037536913329112
Epoch: 2 cost time: 0.7959249019622803
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3690329 Best vali loss: 0.3668127
Updating learning rate to 0.0004890146506565005
Validation loss decreased (0.3668 --> 0.3619).  Saving model state dict ...
Epoch: 3 cost time: 0.7944808006286621
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3619072 Best vali loss: 0.3619072

best validation loss 0.3619072436817971

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.0792663097381592
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713217 Best vali loss: 0.3713217
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3713 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 0.7790877819061279
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3696737 Best vali loss: 0.3696737
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3697 --> 0.3572).  Saving model state dict ...
Epoch: 3 cost time: 0.780834436416626
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3572247 Best vali loss: 0.3572247

best validation loss 0.35722473220413

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3554 --> 0.3389).  Saving model state dict ...
Epoch: 4 cost time: 1.120706558227539
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3389441 Best vali loss: 0.3389441
Updating learning rate to 0.0002182291873478251
Epoch: 5 cost time: 0.7919509410858154
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3546337 Best vali loss: 0.3389441
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7857837677001953
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3524511 Best vali loss: 0.3389441
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7867581844329834
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3653106 Best vali loss: 0.3389441
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7947478294372559
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3704812 Best vali loss: 0.3389441

best validation loss 0.33894410570150274

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0047300548875, 'e_layers': 4, 'learning_rate': 0.0027939434064, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5236249
	speed: 0.0111s/iter; left time: 89.7064s
	iters: 200, epoch: 1 | loss: 0.1672619
	speed: 0.0050s/iter; left time: 40.1620s
	iters: 300, epoch: 1 | loss: 0.8979183
	speed: 0.0051s/iter; left time: 40.4775s
	iters: 400, epoch: 1 | loss: 0.9855635
	speed: 0.0051s/iter; left time: 39.6055s
	iters: 500, epoch: 1 | loss: 0.9422952
	speed: 0.0051s/iter; left time: 39.5340s
	iters: 600, epoch: 1 | loss: 0.9821625
	speed: 0.0050s/iter; left time: 38.3655s
	iters: 700, epoch: 1 | loss: 1.1332530
	speed: 0.0051s/iter; left time: 38.3562s
	iters: 800, epoch: 1 | loss: 0.2528154
	speed: 0.0051s/iter; left time: 37.6735s
	iters: 900, epoch: 1 | loss: 0.5076899
	speed: 0.0052s/iter; left time: 37.7553s
	iters: 1000, epoch: 1 | loss: 0.5906389
	speed: 0.0051s/iter; left time: 36.8248s
Updating learning rate to 0.002687605267283912
Validation loss decreased (inf --> 0.4034).  Saving model state dict ...
Epoch: 1 cost time: 5.557786703109741
Epoch: 1, Steps: 1027 | Train Loss: 0.6983223 Vali Loss: 0.4033924 Best vali loss: 0.4033924
	iters: 100, epoch: 2 | loss: 0.3899862
	speed: 0.0132s/iter; left time: 93.7116s
	iters: 200, epoch: 2 | loss: 0.6831286
	speed: 0.0051s/iter; left time: 35.5074s
	iters: 300, epoch: 2 | loss: 0.5773711
	speed: 0.0051s/iter; left time: 35.0743s
	iters: 400, epoch: 2 | loss: 0.4374392
	speed: 0.0051s/iter; left time: 34.5099s
	iters: 500, epoch: 2 | loss: 0.4215213
	speed: 0.0051s/iter; left time: 33.8899s
	iters: 600, epoch: 2 | loss: 0.3744819
	speed: 0.0048s/iter; left time: 31.4313s
	iters: 700, epoch: 2 | loss: 0.2838471
	speed: 0.0048s/iter; left time: 31.0369s
	iters: 800, epoch: 2 | loss: 0.5756902
	speed: 0.0048s/iter; left time: 30.7006s
	iters: 900, epoch: 2 | loss: 0.4846886
	speed: 0.0048s/iter; left time: 30.0607s
	iters: 1000, epoch: 2 | loss: 0.5643802
	speed: 0.0048s/iter; left time: 29.4585s
Updating learning rate to 0.0023847798676584413
Validation loss decreased (0.4034 --> 0.3998).  Saving model state dict ...
Epoch: 2 cost time: 5.097016334533691
Epoch: 2, Steps: 1027 | Train Loss: 0.4792534 Vali Loss: 0.3997731 Best vali loss: 0.3997731
	iters: 100, epoch: 3 | loss: 0.2744865
	speed: 0.0130s/iter; left time: 78.5306s
	iters: 200, epoch: 3 | loss: 0.5663774
	speed: 0.0051s/iter; left time: 30.2211s
	iters: 300, epoch: 3 | loss: 0.6712936
	speed: 0.0051s/iter; left time: 29.7775s
	iters: 400, epoch: 3 | loss: 0.2595335
	speed: 0.0051s/iter; left time: 29.3808s
	iters: 500, epoch: 3 | loss: 0.7913718
	speed: 0.0052s/iter; left time: 29.2172s
	iters: 600, epoch: 3 | loss: 0.6014504
	speed: 0.0051s/iter; left time: 28.5680s
	iters: 700, epoch: 3 | loss: 1.1624900
	speed: 0.0051s/iter; left time: 27.9469s
	iters: 800, epoch: 3 | loss: 0.9166494
	speed: 0.0051s/iter; left time: 27.5826s
	iters: 900, epoch: 3 | loss: 0.3312508
	speed: 0.0048s/iter; left time: 25.4166s
	iters: 1000, epoch: 3 | loss: 0.4355572
	speed: 0.0048s/iter; left time: 24.8923s
Updating learning rate to 0.0019315696294974817
Epoch: 3 cost time: 5.22251296043396
Epoch: 3, Steps: 1027 | Train Loss: 0.6010461 Vali Loss: 0.4034198 Best vali loss: 0.3997731
	iters: 100, epoch: 4 | loss: 0.3771088
	speed: 0.0123s/iter; left time: 62.1375s
	iters: 200, epoch: 4 | loss: 0.3420477
	speed: 0.0047s/iter; left time: 22.9877s
	iters: 300, epoch: 4 | loss: 0.4819001
	speed: 0.0046s/iter; left time: 22.2663s
	iters: 400, epoch: 4 | loss: 1.1839960
	speed: 0.0048s/iter; left time: 22.7084s
	iters: 500, epoch: 4 | loss: 0.7790974
	speed: 0.0046s/iter; left time: 21.4948s
	iters: 600, epoch: 4 | loss: 0.9841992
	speed: 0.0046s/iter; left time: 20.9953s
	iters: 700, epoch: 4 | loss: 0.2843418
	speed: 0.0047s/iter; left time: 20.7867s
	iters: 800, epoch: 4 | loss: 1.7850493
	speed: 0.0047s/iter; left time: 20.1704s
	iters: 900, epoch: 4 | loss: 0.8560594
	speed: 0.0047s/iter; left time: 20.0752s
	iters: 1000, epoch: 4 | loss: 1.3755230
	speed: 0.0048s/iter; left time: 19.9638s
Updating learning rate to 0.0013969717032
Epoch: 4 cost time: 4.851023197174072
Epoch: 4, Steps: 1027 | Train Loss: 0.8449323 Vali Loss: 0.4027653 Best vali loss: 0.3997731
	iters: 100, epoch: 5 | loss: 0.3413798
	speed: 0.0128s/iter; left time: 51.4124s
	iters: 200, epoch: 5 | loss: 0.9090890
	speed: 0.0044s/iter; left time: 17.0445s
	iters: 300, epoch: 5 | loss: 0.2114669
	speed: 0.0044s/iter; left time: 16.7483s
	iters: 400, epoch: 5 | loss: 0.5921270
	speed: 0.0044s/iter; left time: 16.2292s
	iters: 500, epoch: 5 | loss: 0.5561824
	speed: 0.0043s/iter; left time: 15.6635s
	iters: 600, epoch: 5 | loss: 0.2224624
	speed: 0.0044s/iter; left time: 15.3131s
	iters: 700, epoch: 5 | loss: 0.6276985
	speed: 0.0045s/iter; left time: 15.4315s
	iters: 800, epoch: 5 | loss: 0.5943063
	speed: 0.0044s/iter; left time: 14.5226s
	iters: 900, epoch: 5 | loss: 0.4284580
	speed: 0.0044s/iter; left time: 14.1105s
	iters: 1000, epoch: 5 | loss: 0.3564238
	speed: 0.0047s/iter; left time: 14.5939s
Updating learning rate to 0.0008623737769025186
Epoch: 5 cost time: 4.614425420761108
Epoch: 5, Steps: 1027 | Train Loss: 0.4839594 Vali Loss: 0.4034034 Best vali loss: 0.3997731
	iters: 100, epoch: 6 | loss: 1.6618863
	speed: 0.0119s/iter; left time: 35.6102s
	iters: 200, epoch: 6 | loss: 1.6295354
	speed: 0.0044s/iter; left time: 12.5614s
	iters: 300, epoch: 6 | loss: 2.1296802
	speed: 0.0043s/iter; left time: 12.0142s
	iters: 400, epoch: 6 | loss: 0.6469203
	speed: 0.0044s/iter; left time: 11.6849s
	iters: 500, epoch: 6 | loss: 1.1340200
	speed: 0.0043s/iter; left time: 11.1687s
	iters: 600, epoch: 6 | loss: 0.9668669
	speed: 0.0043s/iter; left time: 10.7857s
	iters: 700, epoch: 6 | loss: 1.2214048
	speed: 0.0043s/iter; left time: 10.3006s
	iters: 800, epoch: 6 | loss: 1.0957376
	speed: 0.0043s/iter; left time: 9.9183s
	iters: 900, epoch: 6 | loss: 1.0151962
	speed: 0.0043s/iter; left time: 9.4561s
	iters: 1000, epoch: 6 | loss: 0.4519800
	speed: 0.0043s/iter; left time: 9.0553s
Updating learning rate to 0.0004091635387415591
Epoch: 6 cost time: 4.497920513153076
Epoch: 6, Steps: 1027 | Train Loss: 1.1953228 Vali Loss: 0.4033425 Best vali loss: 0.3997731
	iters: 100, epoch: 7 | loss: 0.6451004
	speed: 0.0124s/iter; left time: 24.1764s
	iters: 200, epoch: 7 | loss: 1.4450766
	speed: 0.0047s/iter; left time: 8.7517s
	iters: 300, epoch: 7 | loss: 0.3601671
	speed: 0.0047s/iter; left time: 8.2333s
	iters: 400, epoch: 7 | loss: 1.0768628
	speed: 0.0047s/iter; left time: 7.8063s
	iters: 500, epoch: 7 | loss: 0.3003098
	speed: 0.0048s/iter; left time: 7.4081s
	iters: 600, epoch: 7 | loss: 0.5569741
	speed: 0.0048s/iter; left time: 6.9177s
	iters: 700, epoch: 7 | loss: 0.2737982
	speed: 0.0047s/iter; left time: 6.4188s
	iters: 800, epoch: 7 | loss: 0.5366354
	speed: 0.0048s/iter; left time: 5.9870s
	iters: 900, epoch: 7 | loss: 0.8269981
	speed: 0.0047s/iter; left time: 5.4847s
	iters: 1000, epoch: 7 | loss: 0.7350079
	speed: 0.0047s/iter; left time: 4.9433s
Updating learning rate to 0.00010633813911608799
Epoch: 7 cost time: 4.888820171356201
Epoch: 7, Steps: 1027 | Train Loss: 0.6756930 Vali Loss: 0.4033421 Best vali loss: 0.3997731
	iters: 100, epoch: 8 | loss: 0.4077526
	speed: 0.0121s/iter; left time: 11.2206s
	iters: 200, epoch: 8 | loss: 0.3556917
	speed: 0.0045s/iter; left time: 3.6910s
	iters: 300, epoch: 8 | loss: 1.1839958
	speed: 0.0045s/iter; left time: 3.2459s
	iters: 400, epoch: 8 | loss: 0.3950829
	speed: 0.0045s/iter; left time: 2.7952s
	iters: 500, epoch: 8 | loss: 1.2593799
	speed: 0.0044s/iter; left time: 2.3331s
	iters: 600, epoch: 8 | loss: 2.5618920
	speed: 0.0044s/iter; left time: 1.8946s
	iters: 700, epoch: 8 | loss: 0.4076119
	speed: 0.0045s/iter; left time: 1.4680s
	iters: 800, epoch: 8 | loss: 0.5462782
	speed: 0.0044s/iter; left time: 1.0055s
	iters: 900, epoch: 8 | loss: 1.1289538
	speed: 0.0044s/iter; left time: 0.5661s
	iters: 1000, epoch: 8 | loss: 0.3283150
	speed: 0.0044s/iter; left time: 0.1243s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.601969480514526
Epoch: 8, Steps: 1027 | Train Loss: 0.8574954 Vali Loss: 0.4034133 Best vali loss: 0.3997731

best validation loss 0.39977305565461196

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012955190993, 'e_layers': 2, 'learning_rate': 0.0002059893081, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0198311
	speed: 0.0095s/iter; left time: 18.6385s
	iters: 200, epoch: 1 | loss: 0.3404165
	speed: 0.0033s/iter; left time: 6.1457s
Updating learning rate to 0.0002059893081
Validation loss decreased (inf --> 0.3754).  Saving model state dict ...
Epoch: 1 cost time: 1.2150070667266846
Epoch: 1, Steps: 257 | Train Loss: 0.6801238 Vali Loss: 0.3754103 Best vali loss: 0.3754103
	iters: 100, epoch: 2 | loss: 0.3925672
	speed: 0.0080s/iter; left time: 13.6383s
	iters: 200, epoch: 2 | loss: 0.9181176
	speed: 0.0037s/iter; left time: 5.8727s
Updating learning rate to 0.00010299465405
Validation loss decreased (0.3754 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.9862232208251953
Epoch: 2, Steps: 257 | Train Loss: 0.6553424 Vali Loss: 0.3667863 Best vali loss: 0.3667863
	iters: 100, epoch: 3 | loss: 0.5384921
	speed: 0.0079s/iter; left time: 11.4553s
	iters: 200, epoch: 3 | loss: 0.9444877
	speed: 0.0035s/iter; left time: 4.6436s
Updating learning rate to 5.1497327025e-05
Validation loss decreased (0.3668 --> 0.3657).  Saving model state dict ...
Epoch: 3 cost time: 0.9517910480499268
Epoch: 3, Steps: 257 | Train Loss: 0.7414899 Vali Loss: 0.3656550 Best vali loss: 0.3656550
	iters: 100, epoch: 4 | loss: 0.9058120
	speed: 0.0081s/iter; left time: 9.5594s
	iters: 200, epoch: 4 | loss: 0.4716313
	speed: 0.0035s/iter; left time: 3.7825s
Updating learning rate to 2.57486635125e-05
Epoch: 4 cost time: 0.9671716690063477
Epoch: 4, Steps: 257 | Train Loss: 0.6887216 Vali Loss: 0.3665979 Best vali loss: 0.3656550
	iters: 100, epoch: 5 | loss: 0.7898537
	speed: 0.0076s/iter; left time: 7.0980s
	iters: 200, epoch: 5 | loss: 0.5388594
	speed: 0.0033s/iter; left time: 2.7381s
Updating learning rate to 1.287433175625e-05
Epoch: 5 cost time: 0.8830749988555908
Epoch: 5, Steps: 257 | Train Loss: 0.6643566 Vali Loss: 0.3672739 Best vali loss: 0.3656550
	iters: 100, epoch: 6 | loss: 0.6029726
	speed: 0.0074s/iter; left time: 4.9771s
	iters: 200, epoch: 6 | loss: 0.7880107
	speed: 0.0031s/iter; left time: 1.7633s
Updating learning rate to 6.437165878125e-06
Epoch: 6 cost time: 0.8439080715179443
Epoch: 6, Steps: 257 | Train Loss: 0.6954916 Vali Loss: 0.3673620 Best vali loss: 0.3656550
	iters: 100, epoch: 7 | loss: 0.5589636
	speed: 0.0075s/iter; left time: 3.1300s
	iters: 200, epoch: 7 | loss: 0.8480561
	speed: 0.0032s/iter; left time: 1.0127s
Updating learning rate to 3.2185829390625e-06
Epoch: 7 cost time: 0.9031968116760254
Epoch: 7, Steps: 257 | Train Loss: 0.7035098 Vali Loss: 0.3675815 Best vali loss: 0.3656550
	iters: 100, epoch: 8 | loss: 0.5783906
	speed: 0.0076s/iter; left time: 1.1989s
	iters: 200, epoch: 8 | loss: 0.8338262
	speed: 0.0033s/iter; left time: 0.1907s
Updating learning rate to 1.60929146953125e-06
Epoch: 8 cost time: 0.8965225219726562
Epoch: 8, Steps: 257 | Train Loss: 0.7061084 Vali Loss: 0.3676823 Best vali loss: 0.3656550

best validation loss 0.36565501134849954

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007073711667
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 0.7940816879272461
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3702754 Best vali loss: 0.3702754
Updating learning rate to 0.00035368558335
Validation loss decreased (0.3703 --> 0.3634).  Saving model state dict ...
Epoch: 2 cost time: 0.4871861934661865
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3633683 Best vali loss: 0.3633683
Updating learning rate to 0.000176842791675
Validation loss decreased (0.3634 --> 0.3462).  Saving model state dict ...
Epoch: 3 cost time: 0.48293066024780273
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3461682 Best vali loss: 0.3461682

best validation loss 0.3461681621950595

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022977664356, 'e_layers': 4, 'learning_rate': 0.0007068997804, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006799950095241416
Validation loss decreased (inf --> 0.3719).  Saving model state dict ...
Epoch: 1 cost time: 1.0974113941192627
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3718817 Best vali loss: 0.3718817
Updating learning rate to 0.0006033767043700606
Validation loss decreased (0.3719 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.7754664421081543
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3668364 Best vali loss: 0.3668364
Updating learning rate to 0.0004887093073508001
Epoch: 3 cost time: 0.7716100215911865
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3828724 Best vali loss: 0.3668364

best validation loss 0.36683641660424254

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007143769493, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007143769493
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 0.7759742736816406
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703040 Best vali loss: 0.3703040
Updating learning rate to 0.00035718847465
Validation loss decreased (0.3703 --> 0.3536).  Saving model state dict ...
Epoch: 2 cost time: 0.49366331100463867
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3536016 Best vali loss: 0.3536016
Updating learning rate to 0.000178594237325
Validation loss decreased (0.3536 --> 0.3474).  Saving model state dict ...
Epoch: 3 cost time: 0.49024081230163574
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3473799 Best vali loss: 0.3473799

best validation loss 0.34737993011540186

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.84213958375e-05
Epoch: 4 cost time: 0.7706453800201416
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3696517 Best vali loss: 0.3461682
Updating learning rate to 4.421069791875e-05
Epoch: 5 cost time: 0.48846888542175293
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3570727 Best vali loss: 0.3461682
Updating learning rate to 2.2105348959375e-05
Epoch: 6 cost time: 0.4949312210083008
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3617353 Best vali loss: 0.3461682
Updating learning rate to 1.10526744796875e-05
Epoch: 7 cost time: 0.49709391593933105
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3550744 Best vali loss: 0.3461682
Updating learning rate to 5.52633723984375e-06
Epoch: 8 cost time: 0.4916834831237793
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3572765 Best vali loss: 0.3461682

best validation loss 0.3461681621950595

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0023000474692, 'e_layers': 4, 'learning_rate': 0.0007073414481, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006804198672482423
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 0.9893691539764404
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3664414 Best vali loss: 0.3664414
Updating learning rate to 0.0006037536913329112
Validation loss decreased (0.3664 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 0.6790928840637207
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3637257 Best vali loss: 0.3637257
Updating learning rate to 0.0004890146506565005
Epoch: 3 cost time: 0.681255578994751
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3975088 Best vali loss: 0.3637257
Updating learning rate to 0.00035367072405
Validation loss decreased (0.3637 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 0.6803991794586182
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3553043 Best vali loss: 0.3553043
Updating learning rate to 0.00021832679744349952
Validation loss decreased (0.3553 --> 0.3491).  Saving model state dict ...
Epoch: 5 cost time: 0.687736988067627
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3491189 Best vali loss: 0.3491189
Updating learning rate to 0.00010358775676708885
Epoch: 6 cost time: 0.6857929229736328
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3559744 Best vali loss: 0.3491189
Updating learning rate to 2.6921580851757706e-05
Epoch: 7 cost time: 0.687690258026123
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3644097 Best vali loss: 0.3491189
Updating learning rate to 0.0
Epoch: 8 cost time: 0.677891731262207
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3629266 Best vali loss: 0.3491189

best validation loss 0.34911888141060626

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 0.8362760543823242
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3682619 Best vali loss: 0.3682619
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3683 --> 0.3603).  Saving model state dict ...
Epoch: 2 cost time: 0.5321097373962402
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3602513 Best vali loss: 0.3602513
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.5265777111053467
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3609384 Best vali loss: 0.3602513
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 0.5318000316619873
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3663811 Best vali loss: 0.3602513
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3603 --> 0.3514).  Saving model state dict ...
Epoch: 5 cost time: 0.52484130859375
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3514093 Best vali loss: 0.3514093
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.5258467197418213
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3573252 Best vali loss: 0.3514093
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.5262463092803955
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3647154 Best vali loss: 0.3514093
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5389609336853027
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3643007 Best vali loss: 0.3514093

best validation loss 0.3514092572779927

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0011524969916, 'e_layers': 2, 'learning_rate': 0.0004323278574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7816828
	speed: 0.0103s/iter; left time: 9.6069s
Updating learning rate to 0.0004158733580931591
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 0.8680310249328613
Epoch: 1, Steps: 129 | Train Loss: 0.7816828 Vali Loss: 0.3695060 Best vali loss: 0.3695060
	iters: 100, epoch: 2 | loss: 0.6967307
	speed: 0.0069s/iter; left time: 5.5736s
Updating learning rate to 0.0003690149085316953
Epoch: 2 cost time: 0.5504040718078613
Epoch: 2, Steps: 129 | Train Loss: 0.6967307 Vali Loss: 0.3708856 Best vali loss: 0.3695060
	iters: 100, epoch: 3 | loss: 0.5715292
	speed: 0.0069s/iter; left time: 4.6771s
Updating learning rate to 0.00029888628288843853
Epoch: 3 cost time: 0.5578353404998779
Epoch: 3, Steps: 129 | Train Loss: 0.5715292 Vali Loss: 0.3703917 Best vali loss: 0.3695060

best validation loss 0.3695060015076036

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0018070556985, 'e_layers': 2, 'learning_rate': 0.0003857584807, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7041007
	speed: 0.0100s/iter; left time: 39.9532s
	iters: 200, epoch: 1 | loss: 1.3943354
	speed: 0.0036s/iter; left time: 13.9075s
	iters: 300, epoch: 1 | loss: 0.9143664
	speed: 0.0035s/iter; left time: 13.3586s
	iters: 400, epoch: 1 | loss: 0.4557342
	speed: 0.0033s/iter; left time: 12.1582s
	iters: 500, epoch: 1 | loss: 0.3927739
	speed: 0.0033s/iter; left time: 11.8230s
Updating learning rate to 0.0003857584807
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 2.119873285293579
Epoch: 1, Steps: 514 | Train Loss: 0.7722621 Vali Loss: 0.3669028 Best vali loss: 0.3669028
	iters: 100, epoch: 2 | loss: 0.5130231
	speed: 0.0072s/iter; left time: 25.1964s
	iters: 200, epoch: 2 | loss: 0.3209214
	speed: 0.0032s/iter; left time: 10.8318s
	iters: 300, epoch: 2 | loss: 0.3616767
	speed: 0.0031s/iter; left time: 10.2804s
	iters: 400, epoch: 2 | loss: 0.7488618
	speed: 0.0031s/iter; left time: 9.7697s
	iters: 500, epoch: 2 | loss: 0.4313212
	speed: 0.0034s/iter; left time: 10.4163s
Updating learning rate to 0.00019287924035
Validation loss decreased (0.3669 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 1.692530870437622
Epoch: 2, Steps: 514 | Train Loss: 0.4751608 Vali Loss: 0.3666616 Best vali loss: 0.3666616
	iters: 100, epoch: 3 | loss: 0.6406872
	speed: 0.0071s/iter; left time: 21.2246s
	iters: 200, epoch: 3 | loss: 0.2458169
	speed: 0.0034s/iter; left time: 9.7330s
	iters: 300, epoch: 3 | loss: 0.3254446
	speed: 0.0034s/iter; left time: 9.4687s
	iters: 400, epoch: 3 | loss: 0.4659649
	speed: 0.0033s/iter; left time: 8.8105s
	iters: 500, epoch: 3 | loss: 1.5411761
	speed: 0.0034s/iter; left time: 8.6756s
Updating learning rate to 9.6439620175e-05
Epoch: 3 cost time: 1.7633907794952393
Epoch: 3, Steps: 514 | Train Loss: 0.6438179 Vali Loss: 0.3726311 Best vali loss: 0.3666616

best validation loss 0.3666616154208867

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022144720903, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0945250988006592
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712340 Best vali loss: 0.3712340
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3712 --> 0.3602).  Saving model state dict ...
Epoch: 2 cost time: 0.7741012573242188
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3602441 Best vali loss: 0.3602441
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.776078462600708
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3613001 Best vali loss: 0.3602441

best validation loss 0.3602440901378752

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022144720903, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3602 --> 0.3430).  Saving model state dict ...
Epoch: 4 cost time: 1.1031999588012695
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3430002 Best vali loss: 0.3430002
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7750868797302246
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3448070 Best vali loss: 0.3430002
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3430 --> 0.3400).  Saving model state dict ...
Epoch: 6 cost time: 0.7731969356536865
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3400105 Best vali loss: 0.3400105
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3400 --> 0.3395).  Saving model state dict ...
Epoch: 7 cost time: 0.7816355228424072
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3394829 Best vali loss: 0.3394829
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7744066715240479
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3415178 Best vali loss: 0.3394829

best validation loss 0.33948293896227316

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022279010921, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.0822579860687256
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714064 Best vali loss: 0.3714064
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3714 --> 0.3689).  Saving model state dict ...
Epoch: 2 cost time: 0.7838261127471924
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3688752 Best vali loss: 0.3688752
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3689 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 0.7820637226104736
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3644319 Best vali loss: 0.3644319
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3644 --> 0.3423).  Saving model state dict ...
Epoch: 4 cost time: 0.7822556495666504
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3422775 Best vali loss: 0.3422775
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7918405532836914
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3449835 Best vali loss: 0.3422775
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.7800450325012207
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3494727 Best vali loss: 0.3422775
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7796027660369873
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3482977 Best vali loss: 0.3422775
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7787678241729736
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3468202 Best vali loss: 0.3422775

best validation loss 0.3422774743588828

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0057395918236, 'e_layers': 4, 'learning_rate': 0.0002385038041, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4217232
	speed: 0.0111s/iter; left time: 44.3566s
	iters: 200, epoch: 1 | loss: 0.5833310
	speed: 0.0048s/iter; left time: 18.7981s
	iters: 300, epoch: 1 | loss: 0.3716584
	speed: 0.0048s/iter; left time: 18.4081s
	iters: 400, epoch: 1 | loss: 0.2765408
	speed: 0.0048s/iter; left time: 17.8987s
	iters: 500, epoch: 1 | loss: 0.6234235
	speed: 0.0048s/iter; left time: 17.3920s
Updating learning rate to 0.00022942629356703577
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 2.823092460632324
Epoch: 1, Steps: 514 | Train Loss: 0.6553354 Vali Loss: 0.3672620 Best vali loss: 0.3672620
	iters: 100, epoch: 2 | loss: 0.2937505
	speed: 0.0094s/iter; left time: 32.9630s
	iters: 200, epoch: 2 | loss: 0.7226703
	speed: 0.0049s/iter; left time: 16.7818s
	iters: 300, epoch: 2 | loss: 0.4990500
	speed: 0.0050s/iter; left time: 16.4035s
	iters: 400, epoch: 2 | loss: 0.6899940
	speed: 0.0050s/iter; left time: 15.8967s
	iters: 500, epoch: 2 | loss: 0.4738376
	speed: 0.0050s/iter; left time: 15.4008s
Updating learning rate to 0.00020357573065894895
Validation loss decreased (0.3673 --> 0.3665).  Saving model state dict ...
Epoch: 2 cost time: 2.55905818939209
Epoch: 2, Steps: 514 | Train Loss: 0.5358605 Vali Loss: 0.3664879 Best vali loss: 0.3664879
	iters: 100, epoch: 3 | loss: 0.7918505
	speed: 0.0099s/iter; left time: 29.6044s
	iters: 200, epoch: 3 | loss: 1.0391387
	speed: 0.0049s/iter; left time: 14.1607s
	iters: 300, epoch: 3 | loss: 0.4513942
	speed: 0.0050s/iter; left time: 13.9772s
	iters: 400, epoch: 3 | loss: 0.6028126
	speed: 0.0050s/iter; left time: 13.4230s
	iters: 500, epoch: 3 | loss: 0.7555342
	speed: 0.0050s/iter; left time: 12.9423s
Updating learning rate to 0.0001648876292425595
Epoch: 3 cost time: 2.608891010284424
Epoch: 3, Steps: 514 | Train Loss: 0.7281460 Vali Loss: 0.3669667 Best vali loss: 0.3664879
	iters: 100, epoch: 4 | loss: 0.8137698
	speed: 0.0099s/iter; left time: 24.3681s
	iters: 200, epoch: 4 | loss: 0.8708093
	speed: 0.0052s/iter; left time: 12.2839s
	iters: 300, epoch: 4 | loss: 0.3335217
	speed: 0.0052s/iter; left time: 11.7547s
	iters: 400, epoch: 4 | loss: 0.6774023
	speed: 0.0051s/iter; left time: 11.1480s
	iters: 500, epoch: 4 | loss: 0.3444439
	speed: 0.0051s/iter; left time: 10.6405s
Updating learning rate to 0.00011925190205
Epoch: 4 cost time: 2.6966006755828857
Epoch: 4, Steps: 514 | Train Loss: 0.6079894 Vali Loss: 0.3710326 Best vali loss: 0.3664879
	iters: 100, epoch: 5 | loss: 0.9427492
	speed: 0.0096s/iter; left time: 18.8786s
	iters: 200, epoch: 5 | loss: 0.2540155
	speed: 0.0049s/iter; left time: 9.1000s
	iters: 300, epoch: 5 | loss: 0.5794467
	speed: 0.0049s/iter; left time: 8.5887s
	iters: 400, epoch: 5 | loss: 0.5223500
	speed: 0.0046s/iter; left time: 7.6900s
	iters: 500, epoch: 5 | loss: 0.5206124
	speed: 0.0049s/iter; left time: 7.6175s
Updating learning rate to 7.361617485744052e-05
Epoch: 5 cost time: 2.5262019634246826
Epoch: 5, Steps: 514 | Train Loss: 0.5638348 Vali Loss: 0.3702295 Best vali loss: 0.3664879
	iters: 100, epoch: 6 | loss: 0.4952775
	speed: 0.0099s/iter; left time: 14.2948s
	iters: 200, epoch: 6 | loss: 0.2216946
	speed: 0.0048s/iter; left time: 6.5107s
	iters: 300, epoch: 6 | loss: 0.6045420
	speed: 0.0048s/iter; left time: 5.9552s
	iters: 400, epoch: 6 | loss: 0.7273914
	speed: 0.0049s/iter; left time: 5.5749s
	iters: 500, epoch: 6 | loss: 0.5838758
	speed: 0.0049s/iter; left time: 5.0789s
Updating learning rate to 3.492807344105106e-05
Validation loss decreased (0.3665 --> 0.3614).  Saving model state dict ...
Epoch: 6 cost time: 2.533829927444458
Epoch: 6, Steps: 514 | Train Loss: 0.5265563 Vali Loss: 0.3613582 Best vali loss: 0.3613582
	iters: 100, epoch: 7 | loss: 0.2733591
	speed: 0.0097s/iter; left time: 9.0181s
	iters: 200, epoch: 7 | loss: 0.7619418
	speed: 0.0049s/iter; left time: 4.0836s
	iters: 300, epoch: 7 | loss: 0.3926098
	speed: 0.0049s/iter; left time: 3.5605s
	iters: 400, epoch: 7 | loss: 0.8463023
	speed: 0.0048s/iter; left time: 3.0282s
	iters: 500, epoch: 7 | loss: 0.2753250
	speed: 0.0047s/iter; left time: 2.4625s
Updating learning rate to 9.077510532964243e-06
Epoch: 7 cost time: 2.5314791202545166
Epoch: 7, Steps: 514 | Train Loss: 0.5099076 Vali Loss: 0.3656800 Best vali loss: 0.3613582
	iters: 100, epoch: 8 | loss: 0.6621304
	speed: 0.0095s/iter; left time: 3.9537s
	iters: 200, epoch: 8 | loss: 0.7600187
	speed: 0.0046s/iter; left time: 1.4428s
	iters: 300, epoch: 8 | loss: 0.7181243
	speed: 0.0047s/iter; left time: 1.0029s
	iters: 400, epoch: 8 | loss: 0.5974737
	speed: 0.0045s/iter; left time: 0.5205s
	iters: 500, epoch: 8 | loss: 0.3897778
	speed: 0.0047s/iter; left time: 0.0711s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.4304819107055664
Epoch: 8, Steps: 514 | Train Loss: 0.6255050 Vali Loss: 0.3651441 Best vali loss: 0.3613582

best validation loss 0.36135821197262447

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002292295804, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3719).  Saving model state dict ...
Epoch: 1 cost time: 1.095130443572998
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3719482 Best vali loss: 0.3719482
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7811896800994873
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3740453 Best vali loss: 0.3719482
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3719 --> 0.3692).  Saving model state dict ...
Epoch: 3 cost time: 0.7773106098175049
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3692405 Best vali loss: 0.3692405

best validation loss 0.3692404694079416

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.1013455390930176
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711466 Best vali loss: 0.3711466
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3711 --> 0.3529).  Saving model state dict ...
Epoch: 2 cost time: 0.7757642269134521
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3528582 Best vali loss: 0.3528582
Updating learning rate to 0.00017688174945
Epoch: 3 cost time: 0.7760367393493652
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3567701 Best vali loss: 0.3528582

best validation loss 0.35285824431885904

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010213654936, 'e_layers': 4, 'learning_rate': 0.001097814065, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001097814065
Validation loss decreased (inf --> 0.3768).  Saving model state dict ...
Epoch: 1 cost time: 0.789353609085083
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3768372 Best vali loss: 0.3768372
Updating learning rate to 0.0005489070325
Validation loss decreased (0.3768 --> 0.3568).  Saving model state dict ...
Epoch: 2 cost time: 0.4963195323944092
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3567701 Best vali loss: 0.3567701
Updating learning rate to 0.00027445351625
Validation loss decreased (0.3568 --> 0.3489).  Saving model state dict ...
Epoch: 3 cost time: 0.48937535285949707
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3488504 Best vali loss: 0.3488504

best validation loss 0.34885037192427104

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010213654936, 'e_layers': 4, 'learning_rate': 0.001097814065, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.000137226758125
Epoch: 4 cost time: 0.7916042804718018
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3533190 Best vali loss: 0.3488504
Updating learning rate to 6.86133790625e-05
Epoch: 5 cost time: 0.480205774307251
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3536664 Best vali loss: 0.3488504
Updating learning rate to 3.430668953125e-05
Epoch: 6 cost time: 0.48824524879455566
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3545133 Best vali loss: 0.3488504
Updating learning rate to 1.7153344765625e-05
Epoch: 7 cost time: 0.49239277839660645
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3540821 Best vali loss: 0.3488504
Updating learning rate to 8.5766723828125e-06
Epoch: 8 cost time: 0.49444103240966797
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3558505 Best vali loss: 0.3488504

best validation loss 0.34885037192427104

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0035146682118, 'e_layers': 3, 'learning_rate': 0.0026695727286, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0999339
	speed: 0.0105s/iter; left time: 42.1032s
	iters: 200, epoch: 1 | loss: 0.9815083
	speed: 0.0044s/iter; left time: 17.3913s
	iters: 300, epoch: 1 | loss: 0.3695434
	speed: 0.0045s/iter; left time: 17.0365s
	iters: 400, epoch: 1 | loss: 1.2940621
	speed: 0.0045s/iter; left time: 16.7265s
	iters: 500, epoch: 1 | loss: 0.3774368
	speed: 0.0044s/iter; left time: 16.0710s
Updating learning rate to 0.0026695727286
Validation loss decreased (inf --> 0.4057).  Saving model state dict ...
Epoch: 1 cost time: 2.640900135040283
Epoch: 1, Steps: 514 | Train Loss: 0.8244969 Vali Loss: 0.4056552 Best vali loss: 0.4056552
	iters: 100, epoch: 2 | loss: 1.2183564
	speed: 0.0094s/iter; left time: 33.0632s
	iters: 200, epoch: 2 | loss: 1.0920184
	speed: 0.0042s/iter; left time: 14.3289s
	iters: 300, epoch: 2 | loss: 0.5848426
	speed: 0.0042s/iter; left time: 13.8604s
	iters: 400, epoch: 2 | loss: 0.4446267
	speed: 0.0042s/iter; left time: 13.4810s
	iters: 500, epoch: 2 | loss: 0.6260269
	speed: 0.0042s/iter; left time: 12.9169s
Updating learning rate to 0.0013347863643
Validation loss decreased (0.4057 --> 0.4016).  Saving model state dict ...
Epoch: 2 cost time: 2.217874765396118
Epoch: 2, Steps: 514 | Train Loss: 0.7931742 Vali Loss: 0.4016179 Best vali loss: 0.4016179
	iters: 100, epoch: 3 | loss: 0.7498005
	speed: 0.0093s/iter; left time: 27.7557s
	iters: 200, epoch: 3 | loss: 1.1379963
	speed: 0.0043s/iter; left time: 12.4626s
	iters: 300, epoch: 3 | loss: 1.0412854
	speed: 0.0046s/iter; left time: 12.8995s
	iters: 400, epoch: 3 | loss: 1.0003161
	speed: 0.0046s/iter; left time: 12.3721s
	iters: 500, epoch: 3 | loss: 0.8486525
	speed: 0.0045s/iter; left time: 11.5461s
Updating learning rate to 0.00066739318215
Epoch: 3 cost time: 2.328026056289673
Epoch: 3, Steps: 514 | Train Loss: 0.9556102 Vali Loss: 0.4024041 Best vali loss: 0.4016179
	iters: 100, epoch: 4 | loss: 1.0835985
	speed: 0.0090s/iter; left time: 22.1648s
	iters: 200, epoch: 4 | loss: 0.8747268
	speed: 0.0044s/iter; left time: 10.3635s
	iters: 300, epoch: 4 | loss: 1.0918623
	speed: 0.0045s/iter; left time: 10.1739s
	iters: 400, epoch: 4 | loss: 0.8454688
	speed: 0.0045s/iter; left time: 9.7639s
	iters: 500, epoch: 4 | loss: 0.2888383
	speed: 0.0045s/iter; left time: 9.3923s
Updating learning rate to 0.000333696591075
Epoch: 4 cost time: 2.325639009475708
Epoch: 4, Steps: 514 | Train Loss: 0.8368989 Vali Loss: 0.4029574 Best vali loss: 0.4016179
	iters: 100, epoch: 5 | loss: 0.9939706
	speed: 0.0094s/iter; left time: 18.3742s
	iters: 200, epoch: 5 | loss: 0.4983928
	speed: 0.0044s/iter; left time: 8.1639s
	iters: 300, epoch: 5 | loss: 0.3590588
	speed: 0.0044s/iter; left time: 7.7525s
	iters: 400, epoch: 5 | loss: 0.6598850
	speed: 0.0042s/iter; left time: 6.9775s
	iters: 500, epoch: 5 | loss: 0.6185526
	speed: 0.0042s/iter; left time: 6.5472s
Updating learning rate to 0.0001668482955375
Epoch: 5 cost time: 2.28999924659729
Epoch: 5, Steps: 514 | Train Loss: 0.6259719 Vali Loss: 0.4026156 Best vali loss: 0.4016179
	iters: 100, epoch: 6 | loss: 1.4145942
	speed: 0.0092s/iter; left time: 13.3110s
	iters: 200, epoch: 6 | loss: 0.3485324
	speed: 0.0046s/iter; left time: 6.1223s
	iters: 300, epoch: 6 | loss: 0.4165359
	speed: 0.0045s/iter; left time: 5.6492s
	iters: 400, epoch: 6 | loss: 0.4670798
	speed: 0.0046s/iter; left time: 5.2386s
	iters: 500, epoch: 6 | loss: 0.6707194
	speed: 0.0045s/iter; left time: 4.7035s
Updating learning rate to 8.342414776875e-05
Epoch: 6 cost time: 2.380922794342041
Epoch: 6, Steps: 514 | Train Loss: 0.6634923 Vali Loss: 0.4030796 Best vali loss: 0.4016179
	iters: 100, epoch: 7 | loss: 0.7996494
	speed: 0.0089s/iter; left time: 8.2297s
	iters: 200, epoch: 7 | loss: 0.5709240
	speed: 0.0045s/iter; left time: 3.7541s
	iters: 300, epoch: 7 | loss: 0.3175205
	speed: 0.0044s/iter; left time: 3.1727s
	iters: 400, epoch: 7 | loss: 0.3870775
	speed: 0.0042s/iter; left time: 2.6555s
	iters: 500, epoch: 7 | loss: 0.6707168
	speed: 0.0043s/iter; left time: 2.2590s
Updating learning rate to 4.1712073884375e-05
Epoch: 7 cost time: 2.262099266052246
Epoch: 7, Steps: 514 | Train Loss: 0.5491776 Vali Loss: 0.4031237 Best vali loss: 0.4016179
	iters: 100, epoch: 8 | loss: 0.3249823
	speed: 0.0090s/iter; left time: 3.7284s
	iters: 200, epoch: 8 | loss: 0.5587553
	speed: 0.0042s/iter; left time: 1.3211s
	iters: 300, epoch: 8 | loss: 1.0392495
	speed: 0.0042s/iter; left time: 0.8961s
	iters: 400, epoch: 8 | loss: 0.4036004
	speed: 0.0043s/iter; left time: 0.4947s
	iters: 500, epoch: 8 | loss: 1.0938431
	speed: 0.0043s/iter; left time: 0.0638s
Updating learning rate to 2.08560369421875e-05
Epoch: 8 cost time: 2.2271316051483154
Epoch: 8, Steps: 514 | Train Loss: 0.6840861 Vali Loss: 0.4031780 Best vali loss: 0.4016179

best validation loss 0.4016178712629382

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0046004430366, 'e_layers': 1, 'learning_rate': 0.0001996029814, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3684202
	speed: 0.0084s/iter; left time: 68.5205s
	iters: 200, epoch: 1 | loss: 0.4186054
	speed: 0.0024s/iter; left time: 18.8830s
	iters: 300, epoch: 1 | loss: 0.3842148
	speed: 0.0023s/iter; left time: 18.3589s
	iters: 400, epoch: 1 | loss: 0.9487317
	speed: 0.0023s/iter; left time: 18.0917s
	iters: 500, epoch: 1 | loss: 1.3273348
	speed: 0.0024s/iter; left time: 18.2530s
	iters: 600, epoch: 1 | loss: 1.2377303
	speed: 0.0024s/iter; left time: 17.9151s
	iters: 700, epoch: 1 | loss: 0.3898715
	speed: 0.0024s/iter; left time: 17.7725s
	iters: 800, epoch: 1 | loss: 1.3180865
	speed: 0.0024s/iter; left time: 17.6803s
	iters: 900, epoch: 1 | loss: 0.2653576
	speed: 0.0024s/iter; left time: 17.4645s
	iters: 1000, epoch: 1 | loss: 0.7855446
	speed: 0.0024s/iter; left time: 17.0978s
Updating learning rate to 0.0001996029814
Validation loss decreased (inf --> 0.3771).  Saving model state dict ...
Epoch: 1 cost time: 2.7633488178253174
Epoch: 1, Steps: 1027 | Train Loss: 0.7443897 Vali Loss: 0.3771402 Best vali loss: 0.3771402
	iters: 100, epoch: 2 | loss: 0.9304481
	speed: 0.0072s/iter; left time: 50.7461s
	iters: 200, epoch: 2 | loss: 0.4020203
	speed: 0.0022s/iter; left time: 15.4817s
	iters: 300, epoch: 2 | loss: 0.2986533
	speed: 0.0021s/iter; left time: 14.6584s
	iters: 400, epoch: 2 | loss: 1.3599136
	speed: 0.0021s/iter; left time: 14.4712s
	iters: 500, epoch: 2 | loss: 0.9477435
	speed: 0.0021s/iter; left time: 14.0090s
	iters: 600, epoch: 2 | loss: 0.3724832
	speed: 0.0022s/iter; left time: 14.2514s
	iters: 700, epoch: 2 | loss: 1.0112566
	speed: 0.0022s/iter; left time: 14.2706s
	iters: 800, epoch: 2 | loss: 0.5848124
	speed: 0.0022s/iter; left time: 14.0832s
	iters: 900, epoch: 2 | loss: 0.3475907
	speed: 0.0022s/iter; left time: 14.0674s
	iters: 1000, epoch: 2 | loss: 1.0214791
	speed: 0.0023s/iter; left time: 13.9885s
Updating learning rate to 9.98014907e-05
Validation loss decreased (0.3771 --> 0.3654).  Saving model state dict ...
Epoch: 2 cost time: 2.2777185440063477
Epoch: 2, Steps: 1027 | Train Loss: 0.7276401 Vali Loss: 0.3653539 Best vali loss: 0.3653539
	iters: 100, epoch: 3 | loss: 0.6301601
	speed: 0.0074s/iter; left time: 45.1672s
	iters: 200, epoch: 3 | loss: 0.6556727
	speed: 0.0021s/iter; left time: 12.6379s
	iters: 300, epoch: 3 | loss: 0.2654119
	speed: 0.0022s/iter; left time: 12.7311s
	iters: 400, epoch: 3 | loss: 0.5766285
	speed: 0.0022s/iter; left time: 12.4078s
	iters: 500, epoch: 3 | loss: 1.0300344
	speed: 0.0022s/iter; left time: 12.2238s
	iters: 600, epoch: 3 | loss: 0.3024300
	speed: 0.0022s/iter; left time: 12.4935s
	iters: 700, epoch: 3 | loss: 0.3711439
	speed: 0.0021s/iter; left time: 11.6181s
	iters: 800, epoch: 3 | loss: 0.3004157
	speed: 0.0022s/iter; left time: 11.5750s
	iters: 900, epoch: 3 | loss: 0.3705068
	speed: 0.0023s/iter; left time: 12.0035s
	iters: 1000, epoch: 3 | loss: 0.2387509
	speed: 0.0023s/iter; left time: 11.8136s
Updating learning rate to 4.990074535e-05
Validation loss decreased (0.3654 --> 0.3645).  Saving model state dict ...
Epoch: 3 cost time: 2.2836496829986572
Epoch: 3, Steps: 1027 | Train Loss: 0.4741155 Vali Loss: 0.3644789 Best vali loss: 0.3644789
	iters: 100, epoch: 4 | loss: 0.2708697
	speed: 0.0073s/iter; left time: 36.8196s
	iters: 200, epoch: 4 | loss: 0.6371958
	speed: 0.0023s/iter; left time: 11.4763s
	iters: 300, epoch: 4 | loss: 0.2539113
	speed: 0.0023s/iter; left time: 11.1539s
	iters: 400, epoch: 4 | loss: 0.3535544
	speed: 0.0023s/iter; left time: 11.0278s
	iters: 500, epoch: 4 | loss: 0.4010464
	speed: 0.0023s/iter; left time: 10.7364s
	iters: 600, epoch: 4 | loss: 1.0656319
	speed: 0.0023s/iter; left time: 10.4987s
	iters: 700, epoch: 4 | loss: 0.3299284
	speed: 0.0023s/iter; left time: 10.2260s
	iters: 800, epoch: 4 | loss: 1.0965796
	speed: 0.0023s/iter; left time: 9.9202s
	iters: 900, epoch: 4 | loss: 0.3053849
	speed: 0.0023s/iter; left time: 9.7757s
	iters: 1000, epoch: 4 | loss: 0.5083174
	speed: 0.0023s/iter; left time: 9.6365s
Updating learning rate to 2.4950372675e-05
Epoch: 4 cost time: 2.4169540405273438
Epoch: 4, Steps: 1027 | Train Loss: 0.5222420 Vali Loss: 0.3658416 Best vali loss: 0.3644789
	iters: 100, epoch: 5 | loss: 0.2843714
	speed: 0.0072s/iter; left time: 29.0085s
	iters: 200, epoch: 5 | loss: 0.3598421
	speed: 0.0023s/iter; left time: 9.1605s
	iters: 300, epoch: 5 | loss: 0.2908258
	speed: 0.0023s/iter; left time: 8.8165s
	iters: 400, epoch: 5 | loss: 0.2864441
	speed: 0.0025s/iter; left time: 9.1073s
	iters: 500, epoch: 5 | loss: 1.4639131
	speed: 0.0022s/iter; left time: 8.1018s
	iters: 600, epoch: 5 | loss: 0.4188362
	speed: 0.0022s/iter; left time: 7.8370s
	iters: 700, epoch: 5 | loss: 1.1267316
	speed: 0.0023s/iter; left time: 7.7367s
	iters: 800, epoch: 5 | loss: 0.6895453
	speed: 0.0023s/iter; left time: 7.5125s
	iters: 900, epoch: 5 | loss: 0.2476553
	speed: 0.0023s/iter; left time: 7.2664s
	iters: 1000, epoch: 5 | loss: 0.2884307
	speed: 0.0023s/iter; left time: 7.0041s
Updating learning rate to 1.24751863375e-05
Epoch: 5 cost time: 2.4043657779693604
Epoch: 5, Steps: 1027 | Train Loss: 0.5456596 Vali Loss: 0.3656207 Best vali loss: 0.3644789
	iters: 100, epoch: 6 | loss: 0.6300443
	speed: 0.0075s/iter; left time: 22.3857s
	iters: 200, epoch: 6 | loss: 0.7946599
	speed: 0.0022s/iter; left time: 6.4277s
	iters: 300, epoch: 6 | loss: 0.3343135
	speed: 0.0022s/iter; left time: 6.1855s
	iters: 400, epoch: 6 | loss: 0.5159913
	speed: 0.0022s/iter; left time: 5.9808s
	iters: 500, epoch: 6 | loss: 0.9448105
	speed: 0.0022s/iter; left time: 5.7116s
	iters: 600, epoch: 6 | loss: 0.2362520
	speed: 0.0022s/iter; left time: 5.5198s
	iters: 700, epoch: 6 | loss: 0.6912871
	speed: 0.0023s/iter; left time: 5.3772s
	iters: 800, epoch: 6 | loss: 0.7373316
	speed: 0.0023s/iter; left time: 5.1621s
	iters: 900, epoch: 6 | loss: 0.3275671
	speed: 0.0023s/iter; left time: 4.9333s
	iters: 1000, epoch: 6 | loss: 0.6705961
	speed: 0.0023s/iter; left time: 4.7117s
Updating learning rate to 6.23759316875e-06
Epoch: 6 cost time: 2.3406622409820557
Epoch: 6, Steps: 1027 | Train Loss: 0.5882853 Vali Loss: 0.3656565 Best vali loss: 0.3644789
	iters: 100, epoch: 7 | loss: 0.2520247
	speed: 0.0076s/iter; left time: 14.7820s
	iters: 200, epoch: 7 | loss: 0.4016210
	speed: 0.0026s/iter; left time: 4.7573s
	iters: 300, epoch: 7 | loss: 0.7294018
	speed: 0.0024s/iter; left time: 4.1280s
	iters: 400, epoch: 7 | loss: 1.2049928
	speed: 0.0023s/iter; left time: 3.8598s
	iters: 500, epoch: 7 | loss: 0.3210570
	speed: 0.0023s/iter; left time: 3.6188s
	iters: 600, epoch: 7 | loss: 0.2147112
	speed: 0.0023s/iter; left time: 3.3394s
	iters: 700, epoch: 7 | loss: 0.5728032
	speed: 0.0023s/iter; left time: 3.1368s
	iters: 800, epoch: 7 | loss: 0.9970170
	speed: 0.0023s/iter; left time: 2.9133s
	iters: 900, epoch: 7 | loss: 0.5161481
	speed: 0.0023s/iter; left time: 2.6871s
	iters: 1000, epoch: 7 | loss: 0.2978779
	speed: 0.0023s/iter; left time: 2.4447s
Updating learning rate to 3.118796584375e-06
Epoch: 7 cost time: 2.4699225425720215
Epoch: 7, Steps: 1027 | Train Loss: 0.5507655 Vali Loss: 0.3656948 Best vali loss: 0.3644789
	iters: 100, epoch: 8 | loss: 0.1922537
	speed: 0.0075s/iter; left time: 6.9245s
	iters: 200, epoch: 8 | loss: 0.9896053
	speed: 0.0022s/iter; left time: 1.7959s
	iters: 300, epoch: 8 | loss: 0.6179522
	speed: 0.0021s/iter; left time: 1.5615s
	iters: 400, epoch: 8 | loss: 1.2178612
	speed: 0.0021s/iter; left time: 1.3131s
	iters: 500, epoch: 8 | loss: 0.3591958
	speed: 0.0021s/iter; left time: 1.0966s
	iters: 600, epoch: 8 | loss: 0.6439684
	speed: 0.0021s/iter; left time: 0.8846s
	iters: 700, epoch: 8 | loss: 1.4024491
	speed: 0.0021s/iter; left time: 0.6778s
	iters: 800, epoch: 8 | loss: 0.2405904
	speed: 0.0021s/iter; left time: 0.4725s
	iters: 900, epoch: 8 | loss: 1.0125837
	speed: 0.0021s/iter; left time: 0.2669s
	iters: 1000, epoch: 8 | loss: 1.0620568
	speed: 0.0021s/iter; left time: 0.0575s
Updating learning rate to 1.5593982921875e-06
Epoch: 8 cost time: 2.2012722492218018
Epoch: 8, Steps: 1027 | Train Loss: 0.7738517 Vali Loss: 0.3657349 Best vali loss: 0.3644789

best validation loss 0.3644788572209757

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.1095459461212158
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712352 Best vali loss: 0.3712352
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3712 --> 0.3540).  Saving model state dict ...
Epoch: 2 cost time: 0.780846118927002
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3540360 Best vali loss: 0.3540360
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3540 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 0.7771682739257812
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3538678 Best vali loss: 0.3538678

best validation loss 0.35386779323542283

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0025635842937, 'e_layers': 1, 'learning_rate': 0.0002078245407, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00019991469010314445
Validation loss decreased (inf --> 0.4239).  Saving model state dict ...
Epoch: 1 cost time: 0.6442828178405762
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4238663 Best vali loss: 0.4238663
Updating learning rate to 0.00017738934136297483
Validation loss decreased (0.4239 --> 0.4057).  Saving model state dict ...
Epoch: 2 cost time: 0.31465625762939453
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4057167 Best vali loss: 0.4057167
Updating learning rate to 0.00014367777463238717
Validation loss decreased (0.4057 --> 0.3945).  Saving model state dict ...
Epoch: 3 cost time: 0.32906579971313477
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3944841 Best vali loss: 0.3944841

best validation loss 0.3944840624430793

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022113636099, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.1034231185913086
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710879 Best vali loss: 0.3710879
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3711 --> 0.3638).  Saving model state dict ...
Epoch: 2 cost time: 0.7730667591094971
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3637597 Best vali loss: 0.3637597
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3638 --> 0.3564).  Saving model state dict ...
Epoch: 3 cost time: 0.7716608047485352
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3563587 Best vali loss: 0.3563587

best validation loss 0.35635870992551855

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3539 --> 0.3518).  Saving model state dict ...
Epoch: 4 cost time: 1.091066598892212
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3518115 Best vali loss: 0.3518115
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3518 --> 0.3467).  Saving model state dict ...
Epoch: 5 cost time: 0.7791829109191895
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3467391 Best vali loss: 0.3467391
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3467 --> 0.3426).  Saving model state dict ...
Epoch: 6 cost time: 0.7731657028198242
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3426470 Best vali loss: 0.3426470
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3426 --> 0.3398).  Saving model state dict ...
Epoch: 7 cost time: 0.7860894203186035
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3397702 Best vali loss: 0.3397702
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7790825366973877
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3421336 Best vali loss: 0.3397702

best validation loss 0.33977016813628563

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0008291117774, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0008291117774
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 1.095339298248291
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3728913 Best vali loss: 0.3728913
Updating learning rate to 0.0004145558887
Validation loss decreased (0.3729 --> 0.3724).  Saving model state dict ...
Epoch: 2 cost time: 0.7826442718505859
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3723856 Best vali loss: 0.3723856
Updating learning rate to 0.00020727794435
Validation loss decreased (0.3724 --> 0.3610).  Saving model state dict ...
Epoch: 3 cost time: 0.7763819694519043
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3610343 Best vali loss: 0.3610343
Updating learning rate to 0.000103638972175
Validation loss decreased (0.3610 --> 0.3500).  Saving model state dict ...
Epoch: 4 cost time: 0.7769637107849121
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3500022 Best vali loss: 0.3500022
Updating learning rate to 5.18194860875e-05
Epoch: 5 cost time: 0.7769017219543457
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3512223 Best vali loss: 0.3500022
Updating learning rate to 2.590974304375e-05
Epoch: 6 cost time: 0.7806358337402344
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3503440 Best vali loss: 0.3500022
Updating learning rate to 1.2954871521875e-05
Validation loss decreased (0.3500 --> 0.3499).  Saving model state dict ...
Epoch: 7 cost time: 0.7823812961578369
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3499152 Best vali loss: 0.3499152
Updating learning rate to 6.4774357609375e-06
Epoch: 8 cost time: 0.783043384552002
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3505939 Best vali loss: 0.3499152

best validation loss 0.34991521201808234

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023210934212, 'e_layers': 4, 'learning_rate': 0.0007056221918, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006787660462448867
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 0.788093090057373
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703136 Best vali loss: 0.3703136
Updating learning rate to 0.0006022862142887473
Validation loss decreased (0.3703 --> 0.3543).  Saving model state dict ...
Epoch: 2 cost time: 0.4829521179199219
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3542606 Best vali loss: 0.3542606
Updating learning rate to 0.00048782605705550086
Epoch: 3 cost time: 0.502554178237915
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3574216 Best vali loss: 0.3542606
Updating learning rate to 0.0003528110959
Epoch: 4 cost time: 0.48961472511291504
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3655123 Best vali loss: 0.3542606
Updating learning rate to 0.00021779613474449917
Validation loss decreased (0.3543 --> 0.3510).  Saving model state dict ...
Epoch: 5 cost time: 0.49694275856018066
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3509711 Best vali loss: 0.3509711
Updating learning rate to 0.00010333597751125269
Epoch: 6 cost time: 0.48003387451171875
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3571955 Best vali loss: 0.3509711
Updating learning rate to 2.6856145555113245e-05
Epoch: 7 cost time: 0.47765064239501953
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3563226 Best vali loss: 0.3509711
Updating learning rate to 0.0
Epoch: 8 cost time: 0.48157262802124023
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3532827 Best vali loss: 0.3509711

best validation loss 0.35097108455210163

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023310925027, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.0883560180664062
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713002 Best vali loss: 0.3713002
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3713 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 0.7799272537231445
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3637325 Best vali loss: 0.3637325
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.784480094909668
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3776454 Best vali loss: 0.3637325

best validation loss 0.36373250126136075

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0035137137013, 'e_layers': 2, 'learning_rate': 0.0011549859831, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5498936
	speed: 0.0095s/iter; left time: 77.0149s
	iters: 200, epoch: 1 | loss: 0.6424063
	speed: 0.0033s/iter; left time: 26.7565s
	iters: 300, epoch: 1 | loss: 0.3172240
	speed: 0.0033s/iter; left time: 26.4263s
	iters: 400, epoch: 1 | loss: 0.3469454
	speed: 0.0033s/iter; left time: 26.0913s
	iters: 500, epoch: 1 | loss: 0.1736471
	speed: 0.0033s/iter; left time: 25.7171s
	iters: 600, epoch: 1 | loss: 0.5098984
	speed: 0.0033s/iter; left time: 25.2557s
	iters: 700, epoch: 1 | loss: 0.3563833
	speed: 0.0033s/iter; left time: 25.1229s
	iters: 800, epoch: 1 | loss: 0.4961731
	speed: 0.0033s/iter; left time: 24.7540s
	iters: 900, epoch: 1 | loss: 0.3883271
	speed: 0.0033s/iter; left time: 24.1891s
	iters: 1000, epoch: 1 | loss: 0.2874413
	speed: 0.0033s/iter; left time: 24.0330s
Updating learning rate to 0.0011549859831
Validation loss decreased (inf --> 0.4000).  Saving model state dict ...
Epoch: 1 cost time: 3.761801242828369
Epoch: 1, Steps: 1027 | Train Loss: 0.4068340 Vali Loss: 0.4000285 Best vali loss: 0.4000285
	iters: 100, epoch: 2 | loss: 0.8828205
	speed: 0.0092s/iter; left time: 65.5485s
	iters: 200, epoch: 2 | loss: 0.2734286
	speed: 0.0029s/iter; left time: 20.2487s
	iters: 300, epoch: 2 | loss: 1.1246647
	speed: 0.0029s/iter; left time: 19.8885s
	iters: 400, epoch: 2 | loss: 0.5701004
	speed: 0.0029s/iter; left time: 19.6514s
	iters: 500, epoch: 2 | loss: 1.0765017
	speed: 0.0029s/iter; left time: 19.4361s
	iters: 600, epoch: 2 | loss: 0.4620540
	speed: 0.0029s/iter; left time: 19.2325s
	iters: 700, epoch: 2 | loss: 2.0034740
	speed: 0.0029s/iter; left time: 18.8900s
	iters: 800, epoch: 2 | loss: 0.4517375
	speed: 0.0029s/iter; left time: 18.6960s
	iters: 900, epoch: 2 | loss: 0.4440813
	speed: 0.0029s/iter; left time: 18.2249s
	iters: 1000, epoch: 2 | loss: 0.2258797
	speed: 0.0029s/iter; left time: 17.8522s
Updating learning rate to 0.00057749299155
Epoch: 2 cost time: 3.021740198135376
Epoch: 2, Steps: 1027 | Train Loss: 0.7514742 Vali Loss: 0.4040408 Best vali loss: 0.4000285
	iters: 100, epoch: 3 | loss: 0.3766770
	speed: 0.0091s/iter; left time: 55.3121s
	iters: 200, epoch: 3 | loss: 0.4666594
	speed: 0.0031s/iter; left time: 18.5004s
	iters: 300, epoch: 3 | loss: 1.2315427
	speed: 0.0031s/iter; left time: 18.2670s
	iters: 400, epoch: 3 | loss: 0.2353328
	speed: 0.0031s/iter; left time: 17.7790s
	iters: 500, epoch: 3 | loss: 0.3601424
	speed: 0.0031s/iter; left time: 17.6083s
	iters: 600, epoch: 3 | loss: 1.1729034
	speed: 0.0031s/iter; left time: 17.3089s
	iters: 700, epoch: 3 | loss: 0.2870272
	speed: 0.0031s/iter; left time: 16.8841s
	iters: 800, epoch: 3 | loss: 1.1232967
	speed: 0.0031s/iter; left time: 16.7787s
	iters: 900, epoch: 3 | loss: 0.4979661
	speed: 0.0031s/iter; left time: 16.1338s
	iters: 1000, epoch: 3 | loss: 1.0963944
	speed: 0.0030s/iter; left time: 15.5119s
Updating learning rate to 0.000288746495775
Epoch: 3 cost time: 3.2163147926330566
Epoch: 3, Steps: 1027 | Train Loss: 0.6847942 Vali Loss: 0.4024265 Best vali loss: 0.4000285

best validation loss 0.4000285189371915

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.0934276580810547
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714010 Best vali loss: 0.3714010
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3714 --> 0.3571).  Saving model state dict ...
Epoch: 2 cost time: 0.7829985618591309
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3571140 Best vali loss: 0.3571140
Updating learning rate to 0.000176872471975
Validation loss decreased (0.3571 --> 0.3554).  Saving model state dict ...
Epoch: 3 cost time: 0.7821536064147949
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3553514 Best vali loss: 0.3553514

best validation loss 0.3553513748472472

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.84362359875e-05
Validation loss decreased (0.3554 --> 0.3485).  Saving model state dict ...
Epoch: 4 cost time: 1.0943224430084229
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3485169 Best vali loss: 0.3485169
Updating learning rate to 4.421811799375e-05
Validation loss decreased (0.3485 --> 0.3467).  Saving model state dict ...
Epoch: 5 cost time: 0.7817947864532471
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3467323 Best vali loss: 0.3467323
Updating learning rate to 2.2109058996875e-05
Validation loss decreased (0.3467 --> 0.3398).  Saving model state dict ...
Epoch: 6 cost time: 0.7897293567657471
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3397690 Best vali loss: 0.3397690
Updating learning rate to 1.10545294984375e-05
Validation loss decreased (0.3398 --> 0.3381).  Saving model state dict ...
Epoch: 7 cost time: 0.7816686630249023
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3381271 Best vali loss: 0.3381271
Updating learning rate to 5.52726474921875e-06
Epoch: 8 cost time: 0.7826616764068604
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3401893 Best vali loss: 0.3381271

best validation loss 0.3381271234312788

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0046221302767, 'e_layers': 3, 'learning_rate': 0.0006170490106, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8701887
	speed: 0.0114s/iter; left time: 10.6805s
Updating learning rate to 0.0006170490106
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 1.0104014873504639
Epoch: 1, Steps: 129 | Train Loss: 0.8701887 Vali Loss: 0.3844688 Best vali loss: 0.3844688
	iters: 100, epoch: 2 | loss: 0.5683076
	speed: 0.0077s/iter; left time: 6.1920s
Updating learning rate to 0.0003085245053
Validation loss decreased (0.3845 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 0.6121268272399902
Epoch: 2, Steps: 129 | Train Loss: 0.5683076 Vali Loss: 0.3740948 Best vali loss: 0.3740948
	iters: 100, epoch: 3 | loss: 0.5953230
	speed: 0.0078s/iter; left time: 5.2712s
Updating learning rate to 0.00015426225265
Validation loss decreased (0.3741 --> 0.3718).  Saving model state dict ...
Epoch: 3 cost time: 0.6299827098846436
Epoch: 3, Steps: 129 | Train Loss: 0.5953230 Vali Loss: 0.3717551 Best vali loss: 0.3717551
	iters: 100, epoch: 4 | loss: 0.6065997
	speed: 0.0083s/iter; left time: 4.5387s
Updating learning rate to 7.7131126325e-05
Validation loss decreased (0.3718 --> 0.3709).  Saving model state dict ...
Epoch: 4 cost time: 0.6950139999389648
Epoch: 4, Steps: 129 | Train Loss: 0.6065997 Vali Loss: 0.3709457 Best vali loss: 0.3709457
	iters: 100, epoch: 5 | loss: 0.5100291
	speed: 0.0083s/iter; left time: 3.4527s
Updating learning rate to 3.85655631625e-05
Validation loss decreased (0.3709 --> 0.3708).  Saving model state dict ...
Epoch: 5 cost time: 0.6689643859863281
Epoch: 5, Steps: 129 | Train Loss: 0.5100291 Vali Loss: 0.3707751 Best vali loss: 0.3707751
	iters: 100, epoch: 6 | loss: 0.7077028
	speed: 0.0077s/iter; left time: 2.2045s
Updating learning rate to 1.928278158125e-05
Epoch: 6 cost time: 0.5981457233428955
Epoch: 6, Steps: 129 | Train Loss: 0.7077028 Vali Loss: 0.3710730 Best vali loss: 0.3707751
	iters: 100, epoch: 7 | loss: 0.8441987
	speed: 0.0076s/iter; left time: 1.2112s
Updating learning rate to 9.641390790625e-06
Epoch: 7 cost time: 0.621319055557251
Epoch: 7, Steps: 129 | Train Loss: 0.8441987 Vali Loss: 0.3711846 Best vali loss: 0.3707751
	iters: 100, epoch: 8 | loss: 0.4752740
	speed: 0.0082s/iter; left time: 0.2461s
Updating learning rate to 4.8206953953125e-06
Epoch: 8 cost time: 0.6892030239105225
Epoch: 8, Steps: 129 | Train Loss: 0.4752740 Vali Loss: 0.3711837 Best vali loss: 0.3707751

best validation loss 0.3707750810269991

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0022144278717, 'e_layers': 4, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007077576329
Validation loss decreased (inf --> 0.3680).  Saving model state dict ...
Epoch: 1 cost time: 1.1364068984985352
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3679787 Best vali loss: 0.3679787
Updating learning rate to 0.00035387881645
Epoch: 2 cost time: 0.8175663948059082
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3881234 Best vali loss: 0.3679787
Updating learning rate to 0.000176939408225
Validation loss decreased (0.3680 --> 0.3654).  Saving model state dict ...
Epoch: 3 cost time: 0.8145449161529541
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3654381 Best vali loss: 0.3654381
Updating learning rate to 8.84697041125e-05
Validation loss decreased (0.3654 --> 0.3470).  Saving model state dict ...
Epoch: 4 cost time: 0.8153529167175293
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3470391 Best vali loss: 0.3470391
Updating learning rate to 4.423485205625e-05
Validation loss decreased (0.3470 --> 0.3444).  Saving model state dict ...
Epoch: 5 cost time: 0.8235528469085693
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3444334 Best vali loss: 0.3444334
Updating learning rate to 2.2117426028125e-05
Epoch: 6 cost time: 0.8184206485748291
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3487025 Best vali loss: 0.3444334
Updating learning rate to 1.10587130140625e-05
Epoch: 7 cost time: 0.8181273937225342
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3470311 Best vali loss: 0.3444334
Updating learning rate to 5.52935650703125e-06
Epoch: 8 cost time: 0.8182334899902344
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3489461 Best vali loss: 0.3444334

best validation loss 0.34443335680689935

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3741).  Saving model state dict ...
Epoch: 1 cost time: 1.1355807781219482
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3740711 Best vali loss: 0.3740711
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.8246326446533203
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3813955 Best vali loss: 0.3740711
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3741 --> 0.3538).  Saving model state dict ...
Epoch: 3 cost time: 0.8247456550598145
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3538259 Best vali loss: 0.3538259

best validation loss 0.3538259397789631

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022710608854, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.1032450199127197
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714133 Best vali loss: 0.3714133
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3714 --> 0.3612).  Saving model state dict ...
Epoch: 2 cost time: 0.7820534706115723
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3612103 Best vali loss: 0.3612103
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7778100967407227
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3711266 Best vali loss: 0.3612103

best validation loss 0.3612102691808712

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0022144720903, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.13358736038208
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703674 Best vali loss: 0.3703674
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.8218729496002197
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3717314 Best vali loss: 0.3703674
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.8135769367218018
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3709312 Best vali loss: 0.3703674

best validation loss 0.3703673912054897

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 1.1386260986328125
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3591740 Best vali loss: 0.3538259
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3538 --> 0.3497).  Saving model state dict ...
Epoch: 5 cost time: 0.8238184452056885
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3497182 Best vali loss: 0.3497182
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.8247237205505371
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3526530 Best vali loss: 0.3497182
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.8202958106994629
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3500571 Best vali loss: 0.3497182
Updating learning rate to 5.52363443828125e-06
Validation loss decreased (0.3497 --> 0.3489).  Saving model state dict ...
Epoch: 8 cost time: 0.816624641418457
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3489210 Best vali loss: 0.3489210

best validation loss 0.3489209517865846

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 1.107682228088379
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705155 Best vali loss: 0.3705155
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3705 --> 0.3686).  Saving model state dict ...
Epoch: 2 cost time: 0.7900445461273193
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3685632 Best vali loss: 0.3685632
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3686 --> 0.3554).  Saving model state dict ...
Epoch: 3 cost time: 0.7914903163909912
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3554163 Best vali loss: 0.3554163
Updating learning rate to 8.8440874725e-05
Epoch: 4 cost time: 0.7878155708312988
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3588707 Best vali loss: 0.3554163
Updating learning rate to 4.42204373625e-05
Validation loss decreased (0.3554 --> 0.3471).  Saving model state dict ...
Epoch: 5 cost time: 0.7995779514312744
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3471083 Best vali loss: 0.3471083
Updating learning rate to 2.211021868125e-05
Epoch: 6 cost time: 0.7935922145843506
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3497014 Best vali loss: 0.3471083
Updating learning rate to 1.1055109340625e-05
Validation loss decreased (0.3471 --> 0.3471).  Saving model state dict ...
Epoch: 7 cost time: 0.7929201126098633
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3470933 Best vali loss: 0.3470933
Updating learning rate to 5.5275546703125e-06
Epoch: 8 cost time: 0.7956244945526123
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3481096 Best vali loss: 0.3470933

best validation loss 0.3470932642696883

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023015592611, 'e_layers': 4, 'learning_rate': 0.0007130615431, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006859222540955024
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 1.0893259048461914
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3699483 Best vali loss: 0.3699483
Updating learning rate to 0.0006086360978146768
Epoch: 2 cost time: 0.7829849720001221
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3863592 Best vali loss: 0.3699483
Updating learning rate to 0.0004929691909505277
Epoch: 3 cost time: 0.7874319553375244
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3849265 Best vali loss: 0.3699483
Updating learning rate to 0.00035653077155
Validation loss decreased (0.3699 --> 0.3502).  Saving model state dict ...
Epoch: 4 cost time: 0.7843897342681885
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3502009 Best vali loss: 0.3502009
Updating learning rate to 0.00022009235214947234
Epoch: 5 cost time: 0.7856600284576416
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3516478 Best vali loss: 0.3502009
Updating learning rate to 0.00010442544528532321
Epoch: 6 cost time: 0.7825384140014648
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3563284 Best vali loss: 0.3502009
Updating learning rate to 2.7139289004497633e-05
Epoch: 7 cost time: 0.780632734298706
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3530489 Best vali loss: 0.3502009
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7844817638397217
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3539936 Best vali loss: 0.3502009

best validation loss 0.3502009136737681

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0029885136105, 'e_layers': 4, 'learning_rate': 0.0008304219757, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5872184
	speed: 0.0120s/iter; left time: 11.1768s
Updating learning rate to 0.0008304219757
Validation loss decreased (inf --> 0.3638).  Saving model state dict ...
Epoch: 1 cost time: 1.1136553287506104
Epoch: 1, Steps: 129 | Train Loss: 0.5872184 Vali Loss: 0.3637597 Best vali loss: 0.3637597
	iters: 100, epoch: 2 | loss: 0.6289884
	speed: 0.0099s/iter; left time: 7.9198s
Updating learning rate to 0.00041521098785
Epoch: 2 cost time: 0.8202254772186279
Epoch: 2, Steps: 129 | Train Loss: 0.6289884 Vali Loss: 0.3692212 Best vali loss: 0.3637597
	iters: 100, epoch: 3 | loss: 0.7987767
	speed: 0.0095s/iter; left time: 6.4164s
Updating learning rate to 0.000207605493925
Epoch: 3 cost time: 0.7824735641479492
Epoch: 3, Steps: 129 | Train Loss: 0.7987767 Vali Loss: 0.3712697 Best vali loss: 0.3637597

best validation loss 0.3637597160161361

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3804).  Saving model state dict ...
Epoch: 1 cost time: 1.2534072399139404
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3804351 Best vali loss: 0.3804351
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.9523229598999023
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3841837 Best vali loss: 0.3804351
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3804 --> 0.3744).  Saving model state dict ...
Epoch: 3 cost time: 0.9553422927856445
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3744492 Best vali loss: 0.3744492

best validation loss 0.37444922002453235

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022022940501, 'e_layers': 4, 'learning_rate': 0.0007071546516, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007071546516
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.1066515445709229
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710110 Best vali loss: 0.3710110
Updating learning rate to 0.0003535773258
Validation loss decreased (0.3710 --> 0.3568).  Saving model state dict ...
Epoch: 2 cost time: 0.7911179065704346
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3567837 Best vali loss: 0.3567837
Updating learning rate to 0.0001767886629
Epoch: 3 cost time: 0.783801794052124
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3600954 Best vali loss: 0.3567837

best validation loss 0.3567837009144204

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022022940501, 'e_layers': 4, 'learning_rate': 0.0007071546516, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.839433145e-05
Validation loss decreased (0.3568 --> 0.3514).  Saving model state dict ...
Epoch: 4 cost time: 1.1122472286224365
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3513748 Best vali loss: 0.3513748
Updating learning rate to 4.4197165725e-05
Validation loss decreased (0.3514 --> 0.3494).  Saving model state dict ...
Epoch: 5 cost time: 0.787299633026123
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3494369 Best vali loss: 0.3494369
Updating learning rate to 2.20985828625e-05
Validation loss decreased (0.3494 --> 0.3460).  Saving model state dict ...
Epoch: 6 cost time: 0.7920529842376709
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3460243 Best vali loss: 0.3460243
Updating learning rate to 1.104929143125e-05
Validation loss decreased (0.3460 --> 0.3450).  Saving model state dict ...
Epoch: 7 cost time: 0.7834267616271973
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3450328 Best vali loss: 0.3450328
Updating learning rate to 5.524645715625e-06
Epoch: 8 cost time: 0.7939178943634033
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3470431 Best vali loss: 0.3450328

best validation loss 0.3450327589376034

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0076678113, 'e_layers': 2, 'learning_rate': 0.0006084653115, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4335554
	speed: 0.0096s/iter; left time: 38.5772s
	iters: 200, epoch: 1 | loss: 0.5735659
	speed: 0.0035s/iter; left time: 13.6223s
	iters: 300, epoch: 1 | loss: 0.4969209
	speed: 0.0034s/iter; left time: 12.9616s
	iters: 400, epoch: 1 | loss: 0.3819368
	speed: 0.0034s/iter; left time: 12.5418s
	iters: 500, epoch: 1 | loss: 0.4100498
	speed: 0.0034s/iter; left time: 12.1082s
Updating learning rate to 0.0006084653115
Validation loss decreased (inf --> 0.3797).  Saving model state dict ...
Epoch: 1 cost time: 2.112320899963379
Epoch: 1, Steps: 514 | Train Loss: 0.4592058 Vali Loss: 0.3796681 Best vali loss: 0.3796681
	iters: 100, epoch: 2 | loss: 0.6887490
	speed: 0.0074s/iter; left time: 26.0484s
	iters: 200, epoch: 2 | loss: 0.3829410
	speed: 0.0034s/iter; left time: 11.6731s
	iters: 300, epoch: 2 | loss: 1.4420950
	speed: 0.0034s/iter; left time: 11.3464s
	iters: 400, epoch: 2 | loss: 0.6073926
	speed: 0.0034s/iter; left time: 11.0148s
	iters: 500, epoch: 2 | loss: 0.6050954
	speed: 0.0035s/iter; left time: 10.8871s
Updating learning rate to 0.00030423265575
Epoch: 2 cost time: 1.82399320602417
Epoch: 2, Steps: 514 | Train Loss: 0.7452546 Vali Loss: 0.3844581 Best vali loss: 0.3796681
	iters: 100, epoch: 3 | loss: 0.8709810
	speed: 0.0071s/iter; left time: 21.2989s
	iters: 200, epoch: 3 | loss: 0.2569963
	speed: 0.0033s/iter; left time: 9.5824s
	iters: 300, epoch: 3 | loss: 0.4182906
	speed: 0.0031s/iter; left time: 8.5922s
	iters: 400, epoch: 3 | loss: 0.4902429
	speed: 0.0032s/iter; left time: 8.5695s
	iters: 500, epoch: 3 | loss: 0.5353031
	speed: 0.0032s/iter; left time: 8.2797s
Updating learning rate to 0.000152116327875
Epoch: 3 cost time: 1.70335054397583
Epoch: 3, Steps: 514 | Train Loss: 0.5143628 Vali Loss: 0.3933508 Best vali loss: 0.3796681
	iters: 100, epoch: 4 | loss: 0.3186581
	speed: 0.0073s/iter; left time: 17.9523s
	iters: 200, epoch: 4 | loss: 0.8792782
	speed: 0.0033s/iter; left time: 7.8508s
	iters: 300, epoch: 4 | loss: 0.8308819
	speed: 0.0035s/iter; left time: 8.0064s
	iters: 400, epoch: 4 | loss: 0.4427601
	speed: 0.0033s/iter; left time: 7.2023s
	iters: 500, epoch: 4 | loss: 0.8195593
	speed: 0.0035s/iter; left time: 7.3131s
Updating learning rate to 7.60581639375e-05
Validation loss decreased (0.3797 --> 0.3770).  Saving model state dict ...
Epoch: 4 cost time: 1.8042397499084473
Epoch: 4, Steps: 514 | Train Loss: 0.6582275 Vali Loss: 0.3769984 Best vali loss: 0.3769984
	iters: 100, epoch: 5 | loss: 0.4858756
	speed: 0.0081s/iter; left time: 15.7683s
	iters: 200, epoch: 5 | loss: 0.5948930
	speed: 0.0036s/iter; left time: 6.7057s
	iters: 300, epoch: 5 | loss: 0.3611152
	speed: 0.0036s/iter; left time: 6.3018s
	iters: 400, epoch: 5 | loss: 0.5136703
	speed: 0.0036s/iter; left time: 5.9236s
	iters: 500, epoch: 5 | loss: 0.5429009
	speed: 0.0036s/iter; left time: 5.5741s
Updating learning rate to 3.802908196875e-05
Epoch: 5 cost time: 1.892806053161621
Epoch: 5, Steps: 514 | Train Loss: 0.4996910 Vali Loss: 0.3861967 Best vali loss: 0.3769984
	iters: 100, epoch: 6 | loss: 0.9134176
	speed: 0.0073s/iter; left time: 10.4797s
	iters: 200, epoch: 6 | loss: 1.1057068
	speed: 0.0033s/iter; left time: 4.4568s
	iters: 300, epoch: 6 | loss: 1.4158623
	speed: 0.0033s/iter; left time: 4.1266s
	iters: 400, epoch: 6 | loss: 1.0799056
	speed: 0.0033s/iter; left time: 3.7248s
	iters: 500, epoch: 6 | loss: 0.4476239
	speed: 0.0032s/iter; left time: 3.3367s
Updating learning rate to 1.9014540984375e-05
Epoch: 6 cost time: 1.7278616428375244
Epoch: 6, Steps: 514 | Train Loss: 0.9925032 Vali Loss: 0.3846028 Best vali loss: 0.3769984
	iters: 100, epoch: 7 | loss: 0.6767700
	speed: 0.0073s/iter; left time: 6.7479s
	iters: 200, epoch: 7 | loss: 0.8394355
	speed: 0.0034s/iter; left time: 2.8146s
	iters: 300, epoch: 7 | loss: 0.4132878
	speed: 0.0033s/iter; left time: 2.3785s
	iters: 400, epoch: 7 | loss: 0.5499951
	speed: 0.0032s/iter; left time: 2.0084s
	iters: 500, epoch: 7 | loss: 0.3909171
	speed: 0.0032s/iter; left time: 1.7097s
Updating learning rate to 9.5072704921875e-06
Epoch: 7 cost time: 1.736645221710205
Epoch: 7, Steps: 514 | Train Loss: 0.5740811 Vali Loss: 0.3868966 Best vali loss: 0.3769984
	iters: 100, epoch: 8 | loss: 0.3407193
	speed: 0.0072s/iter; left time: 2.9690s
	iters: 200, epoch: 8 | loss: 0.3306972
	speed: 0.0032s/iter; left time: 1.0191s
	iters: 300, epoch: 8 | loss: 0.6208411
	speed: 0.0032s/iter; left time: 0.6840s
	iters: 400, epoch: 8 | loss: 0.4564874
	speed: 0.0033s/iter; left time: 0.3750s
	iters: 500, epoch: 8 | loss: 1.0105352
	speed: 0.0032s/iter; left time: 0.0487s
Updating learning rate to 4.75363524609375e-06
Epoch: 8 cost time: 1.7017922401428223
Epoch: 8, Steps: 514 | Train Loss: 0.5518560 Vali Loss: 0.3871779 Best vali loss: 0.3769984

best validation loss 0.37699838086289367

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019608353637, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.0982134342193604
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705868 Best vali loss: 0.3705868
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3706 --> 0.3539).  Saving model state dict ...
Epoch: 2 cost time: 0.7839338779449463
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3538951 Best vali loss: 0.3538951
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.791006326675415
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3607871 Best vali loss: 0.3538951
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3539 --> 0.3454).  Saving model state dict ...
Epoch: 4 cost time: 0.7851588726043701
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3453530 Best vali loss: 0.3453530
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3454 --> 0.3405).  Saving model state dict ...
Epoch: 5 cost time: 0.7916505336761475
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3405391 Best vali loss: 0.3405391
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.7847352027893066
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3437821 Best vali loss: 0.3405391
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7801961898803711
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3461976 Best vali loss: 0.3405391
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7803122997283936
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3473259 Best vali loss: 0.3405391

best validation loss 0.340539146945144

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002212028038, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3806).  Saving model state dict ...
Epoch: 1 cost time: 1.2510442733764648
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3805885 Best vali loss: 0.3805885
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.9463520050048828
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3817326 Best vali loss: 0.3805885
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3806 --> 0.3768).  Saving model state dict ...
Epoch: 3 cost time: 0.9581823348999023
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3768312 Best vali loss: 0.3768312

best validation loss 0.37683117788994946

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009879765322, 'e_layers': 1, 'learning_rate': 0.0007270929278, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7655008
	speed: 0.0088s/iter; left time: 17.2065s
	iters: 200, epoch: 1 | loss: 0.6758482
	speed: 0.0026s/iter; left time: 4.7490s
Updating learning rate to 0.0007270929278
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 1.0055313110351562
Epoch: 1, Steps: 257 | Train Loss: 0.7206745 Vali Loss: 0.3693850 Best vali loss: 0.3693850
	iters: 100, epoch: 2 | loss: 0.4519387
	speed: 0.0065s/iter; left time: 11.0285s
	iters: 200, epoch: 2 | loss: 0.4957432
	speed: 0.0028s/iter; left time: 4.4991s
Updating learning rate to 0.0003635464639
Epoch: 2 cost time: 0.7772912979125977
Epoch: 2, Steps: 257 | Train Loss: 0.4738410 Vali Loss: 0.3856146 Best vali loss: 0.3693850
	iters: 100, epoch: 3 | loss: 0.6686189
	speed: 0.0066s/iter; left time: 9.5351s
	iters: 200, epoch: 3 | loss: 0.5087233
	speed: 0.0027s/iter; left time: 3.6391s
Updating learning rate to 0.00018177323195
Epoch: 3 cost time: 0.7456858158111572
Epoch: 3, Steps: 257 | Train Loss: 0.5886711 Vali Loss: 0.3736236 Best vali loss: 0.3693850

best validation loss 0.36938497220369126

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0023267904951, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3832).  Saving model state dict ...
Epoch: 1 cost time: 1.186614751815796
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3832273 Best vali loss: 0.3832273
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3832 --> 0.3758).  Saving model state dict ...
Epoch: 2 cost time: 0.869342565536499
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3757716 Best vali loss: 0.3757716
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.863640308380127
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3860674 Best vali loss: 0.3757716

best validation loss 0.37577161345125887

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009879765322, 'e_layers': 1, 'learning_rate': 0.0007270929278, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6048928
	speed: 0.0088s/iter; left time: 10.4056s
	iters: 200, epoch: 4 | loss: 0.6000248
	speed: 0.0025s/iter; left time: 2.6972s
Updating learning rate to 9.0886615975e-05
Epoch: 4 cost time: 1.000701904296875
Epoch: 4, Steps: 257 | Train Loss: 0.6024588 Vali Loss: 0.3918216 Best vali loss: 0.3693850
	iters: 100, epoch: 5 | loss: 0.4261169
	speed: 0.0064s/iter; left time: 5.9714s
	iters: 200, epoch: 5 | loss: 0.4254228
	speed: 0.0028s/iter; left time: 2.3189s
Updating learning rate to 4.54433079875e-05
Epoch: 5 cost time: 0.7645025253295898
Epoch: 5, Steps: 257 | Train Loss: 0.4257699 Vali Loss: 0.3941819 Best vali loss: 0.3693850
	iters: 100, epoch: 6 | loss: 0.5412988
	speed: 0.0065s/iter; left time: 4.3478s
	iters: 200, epoch: 6 | loss: 0.4245371
	speed: 0.0027s/iter; left time: 1.5561s
Updating learning rate to 2.272165399375e-05
Epoch: 6 cost time: 0.7440652847290039
Epoch: 6, Steps: 257 | Train Loss: 0.4829180 Vali Loss: 0.3905644 Best vali loss: 0.3693850
	iters: 100, epoch: 7 | loss: 0.4977269
	speed: 0.0066s/iter; left time: 2.7353s
	iters: 200, epoch: 7 | loss: 0.4182219
	speed: 0.0027s/iter; left time: 0.8568s
Updating learning rate to 1.1360826996875e-05
Epoch: 7 cost time: 0.7573995590209961
Epoch: 7, Steps: 257 | Train Loss: 0.4579744 Vali Loss: 0.3918053 Best vali loss: 0.3693850
	iters: 100, epoch: 8 | loss: 0.5782987
	speed: 0.0066s/iter; left time: 1.0446s
	iters: 200, epoch: 8 | loss: 0.3950678
	speed: 0.0028s/iter; left time: 0.1604s
Updating learning rate to 5.6804134984375e-06
Epoch: 8 cost time: 0.7647602558135986
Epoch: 8, Steps: 257 | Train Loss: 0.4866833 Vali Loss: 0.3924536 Best vali loss: 0.3693850

best validation loss 0.36938497220369126

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0022143910733, 'e_layers': 4, 'learning_rate': 9.66228802e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7602580
	speed: 0.0141s/iter; left time: 13.1239s
Updating learning rate to 9.66228802e-05
Validation loss decreased (inf --> 0.3623).  Saving model state dict ...
Epoch: 1 cost time: 1.2932686805725098
Epoch: 1, Steps: 129 | Train Loss: 0.7602580 Vali Loss: 0.3623056 Best vali loss: 0.3623056
	iters: 100, epoch: 2 | loss: 0.4212358
	speed: 0.0118s/iter; left time: 9.4575s
Updating learning rate to 4.83114401e-05
Validation loss decreased (0.3623 --> 0.3581).  Saving model state dict ...
Epoch: 2 cost time: 0.9434349536895752
Epoch: 2, Steps: 129 | Train Loss: 0.4212358 Vali Loss: 0.3581116 Best vali loss: 0.3581116
	iters: 100, epoch: 3 | loss: 0.4372157
	speed: 0.0119s/iter; left time: 8.0447s
Updating learning rate to 2.415572005e-05
Epoch: 3 cost time: 0.9462594985961914
Epoch: 3, Steps: 129 | Train Loss: 0.4372157 Vali Loss: 0.3617802 Best vali loss: 0.3581116
	iters: 100, epoch: 4 | loss: 0.5418071
	speed: 0.0115s/iter; left time: 6.2672s
Updating learning rate to 1.2077860025e-05
Epoch: 4 cost time: 0.9430575370788574
Epoch: 4, Steps: 129 | Train Loss: 0.5418071 Vali Loss: 0.3602317 Best vali loss: 0.3581116
	iters: 100, epoch: 5 | loss: 0.6139768
	speed: 0.0116s/iter; left time: 4.8165s
Updating learning rate to 6.0389300125e-06
Epoch: 5 cost time: 0.9520742893218994
Epoch: 5, Steps: 129 | Train Loss: 0.6139768 Vali Loss: 0.3608987 Best vali loss: 0.3581116
	iters: 100, epoch: 6 | loss: 0.5452362
	speed: 0.0115s/iter; left time: 3.3048s
Updating learning rate to 3.01946500625e-06
Epoch: 6 cost time: 0.9419198036193848
Epoch: 6, Steps: 129 | Train Loss: 0.5452362 Vali Loss: 0.3658576 Best vali loss: 0.3581116
	iters: 100, epoch: 7 | loss: 0.5580362
	speed: 0.0114s/iter; left time: 1.8139s
Updating learning rate to 1.509732503125e-06
Epoch: 7 cost time: 0.9371242523193359
Epoch: 7, Steps: 129 | Train Loss: 0.5580362 Vali Loss: 0.3622660 Best vali loss: 0.3581116
	iters: 100, epoch: 8 | loss: 0.6063471
	speed: 0.0117s/iter; left time: 0.3506s
Updating learning rate to 7.548662515625e-07
Epoch: 8 cost time: 0.9701595306396484
Epoch: 8, Steps: 129 | Train Loss: 0.6063471 Vali Loss: 0.3625083 Best vali loss: 0.3581116

best validation loss 0.358111643814619

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073012038, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007073012038
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.0878934860229492
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713641 Best vali loss: 0.3713641
Updating learning rate to 0.0003536506019
Validation loss decreased (0.3714 --> 0.3671).  Saving model state dict ...
Epoch: 2 cost time: 0.7836196422576904
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3670742 Best vali loss: 0.3670742
Updating learning rate to 0.00017682530095
Validation loss decreased (0.3671 --> 0.3577).  Saving model state dict ...
Epoch: 3 cost time: 0.7840301990509033
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3577055 Best vali loss: 0.3577055
Updating learning rate to 8.8412650475e-05
Validation loss decreased (0.3577 --> 0.3437).  Saving model state dict ...
Epoch: 4 cost time: 0.7866883277893066
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3436506 Best vali loss: 0.3436506
Updating learning rate to 4.42063252375e-05
Validation loss decreased (0.3437 --> 0.3429).  Saving model state dict ...
Epoch: 5 cost time: 0.7891595363616943
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3428734 Best vali loss: 0.3428734
Updating learning rate to 2.210316261875e-05
Epoch: 6 cost time: 0.782325267791748
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3447515 Best vali loss: 0.3428734
Updating learning rate to 1.1051581309375e-05
Validation loss decreased (0.3429 --> 0.3416).  Saving model state dict ...
Epoch: 7 cost time: 0.7848777770996094
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3416165 Best vali loss: 0.3416165
Updating learning rate to 5.5257906546875e-06
Epoch: 8 cost time: 0.7892606258392334
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3430363 Best vali loss: 0.3416165

best validation loss 0.34161647250235433

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022147168852, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.1039886474609375
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712511 Best vali loss: 0.3712511
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.7887051105499268
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3809405 Best vali loss: 0.3712511
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3713 --> 0.3602).  Saving model state dict ...
Epoch: 3 cost time: 0.7798995971679688
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3602442 Best vali loss: 0.3602442

best validation loss 0.3602441907631625

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.6546606
	speed: 0.0121s/iter; left time: 98.0556s
	iters: 200, epoch: 1 | loss: 0.4047876
	speed: 0.0052s/iter; left time: 41.7211s
	iters: 300, epoch: 1 | loss: 0.4566442
	speed: 0.0052s/iter; left time: 40.8487s
	iters: 400, epoch: 1 | loss: 1.2023758
	speed: 0.0051s/iter; left time: 39.8322s
	iters: 500, epoch: 1 | loss: 0.5514091
	speed: 0.0049s/iter; left time: 38.1345s
	iters: 600, epoch: 1 | loss: 1.7098463
	speed: 0.0050s/iter; left time: 37.9422s
	iters: 700, epoch: 1 | loss: 1.0550718
	speed: 0.0050s/iter; left time: 37.5184s
	iters: 800, epoch: 1 | loss: 0.3364339
	speed: 0.0046s/iter; left time: 33.9730s
	iters: 900, epoch: 1 | loss: 0.2380063
	speed: 0.0045s/iter; left time: 32.6787s
	iters: 1000, epoch: 1 | loss: 0.4452229
	speed: 0.0045s/iter; left time: 32.3421s
Updating learning rate to 0.0007073711667
Validation loss decreased (inf --> 0.3968).  Saving model state dict ...
Epoch: 1 cost time: 5.392347812652588
Epoch: 1, Steps: 1027 | Train Loss: 0.8054458 Vali Loss: 0.3967647 Best vali loss: 0.3967647
	iters: 100, epoch: 2 | loss: 0.4327311
	speed: 0.0123s/iter; left time: 87.2357s
	iters: 200, epoch: 2 | loss: 1.1985925
	speed: 0.0045s/iter; left time: 31.4350s
	iters: 300, epoch: 2 | loss: 0.4961307
	speed: 0.0050s/iter; left time: 34.1630s
	iters: 400, epoch: 2 | loss: 0.2467502
	speed: 0.0049s/iter; left time: 33.3395s
	iters: 500, epoch: 2 | loss: 1.6073846
	speed: 0.0050s/iter; left time: 33.1913s
	iters: 600, epoch: 2 | loss: 0.6717205
	speed: 0.0046s/iter; left time: 30.4983s
	iters: 700, epoch: 2 | loss: 0.3240406
	speed: 0.0045s/iter; left time: 29.4981s
	iters: 800, epoch: 2 | loss: 0.7184425
	speed: 0.0049s/iter; left time: 31.3534s
	iters: 900, epoch: 2 | loss: 0.9815304
	speed: 0.0049s/iter; left time: 31.0153s
	iters: 1000, epoch: 2 | loss: 0.9534059
	speed: 0.0049s/iter; left time: 30.6369s
Updating learning rate to 0.00035368558335
Epoch: 2 cost time: 4.945846319198608
Epoch: 2, Steps: 1027 | Train Loss: 0.7630729 Vali Loss: 0.4089549 Best vali loss: 0.3967647
	iters: 100, epoch: 3 | loss: 0.3087053
	speed: 0.0125s/iter; left time: 75.7897s
	iters: 200, epoch: 3 | loss: 0.3410099
	speed: 0.0049s/iter; left time: 29.0951s
	iters: 300, epoch: 3 | loss: 0.3783168
	speed: 0.0044s/iter; left time: 25.6844s
	iters: 400, epoch: 3 | loss: 0.3947148
	speed: 0.0044s/iter; left time: 25.1447s
	iters: 500, epoch: 3 | loss: 0.5269000
	speed: 0.0044s/iter; left time: 25.0709s
	iters: 600, epoch: 3 | loss: 0.3164267
	speed: 0.0044s/iter; left time: 24.5757s
	iters: 700, epoch: 3 | loss: 0.2889720
	speed: 0.0047s/iter; left time: 25.7177s
	iters: 800, epoch: 3 | loss: 1.0065660
	speed: 0.0049s/iter; left time: 26.2198s
	iters: 900, epoch: 3 | loss: 0.3060555
	speed: 0.0048s/iter; left time: 25.2332s
	iters: 1000, epoch: 3 | loss: 0.4126364
	speed: 0.0044s/iter; left time: 22.5308s
Updating learning rate to 0.000176842791675
Epoch: 3 cost time: 4.758346080780029
Epoch: 3, Steps: 1027 | Train Loss: 0.4280303 Vali Loss: 0.4084912 Best vali loss: 0.3967647

best validation loss 0.3967646875526675

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022877721879, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.6999362
	speed: 0.0120s/iter; left time: 97.1190s
	iters: 200, epoch: 1 | loss: 0.4044168
	speed: 0.0052s/iter; left time: 41.8382s
	iters: 300, epoch: 1 | loss: 0.4338573
	speed: 0.0053s/iter; left time: 41.6470s
	iters: 400, epoch: 1 | loss: 1.2259624
	speed: 0.0052s/iter; left time: 41.0174s
	iters: 500, epoch: 1 | loss: 0.5723476
	speed: 0.0052s/iter; left time: 40.4776s
	iters: 600, epoch: 1 | loss: 1.7394799
	speed: 0.0053s/iter; left time: 40.2084s
	iters: 700, epoch: 1 | loss: 1.0485544
	speed: 0.0052s/iter; left time: 39.4500s
	iters: 800, epoch: 1 | loss: 0.3293887
	speed: 0.0052s/iter; left time: 38.5959s
	iters: 900, epoch: 1 | loss: 0.2364035
	speed: 0.0053s/iter; left time: 38.4179s
	iters: 1000, epoch: 1 | loss: 0.4393728
	speed: 0.0053s/iter; left time: 37.9370s
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3985).  Saving model state dict ...
Epoch: 1 cost time: 5.740334749221802
Epoch: 1, Steps: 1027 | Train Loss: 0.8129720 Vali Loss: 0.3984651 Best vali loss: 0.3984651
	iters: 100, epoch: 2 | loss: 0.4338309
	speed: 0.0136s/iter; left time: 96.6525s
	iters: 200, epoch: 2 | loss: 1.1079093
	speed: 0.0053s/iter; left time: 36.7091s
	iters: 300, epoch: 2 | loss: 0.4974665
	speed: 0.0052s/iter; left time: 36.1654s
	iters: 400, epoch: 2 | loss: 0.2480222
	speed: 0.0052s/iter; left time: 35.6311s
	iters: 500, epoch: 2 | loss: 1.6132429
	speed: 0.0052s/iter; left time: 34.6901s
	iters: 600, epoch: 2 | loss: 0.6713403
	speed: 0.0052s/iter; left time: 34.0146s
	iters: 700, epoch: 2 | loss: 0.3234934
	speed: 0.0052s/iter; left time: 33.7717s
	iters: 800, epoch: 2 | loss: 0.7174604
	speed: 0.0052s/iter; left time: 33.2324s
	iters: 900, epoch: 2 | loss: 0.9837892
	speed: 0.0052s/iter; left time: 32.8256s
	iters: 1000, epoch: 2 | loss: 0.9523714
	speed: 0.0052s/iter; left time: 32.1699s
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 5.397109746932983
Epoch: 2, Steps: 1027 | Train Loss: 0.7548926 Vali Loss: 0.4095608 Best vali loss: 0.3984651
	iters: 100, epoch: 3 | loss: 0.3087921
	speed: 0.0131s/iter; left time: 79.6856s
	iters: 200, epoch: 3 | loss: 0.3409262
	speed: 0.0051s/iter; left time: 30.5461s
	iters: 300, epoch: 3 | loss: 0.3790911
	speed: 0.0051s/iter; left time: 30.0047s
	iters: 400, epoch: 3 | loss: 0.3952874
	speed: 0.0051s/iter; left time: 29.5656s
	iters: 500, epoch: 3 | loss: 0.5266688
	speed: 0.0051s/iter; left time: 29.1576s
	iters: 600, epoch: 3 | loss: 0.3182458
	speed: 0.0049s/iter; left time: 27.4720s
	iters: 700, epoch: 3 | loss: 0.2880469
	speed: 0.0048s/iter; left time: 26.4346s
	iters: 800, epoch: 3 | loss: 1.0019411
	speed: 0.0049s/iter; left time: 26.1234s
	iters: 900, epoch: 3 | loss: 0.3063528
	speed: 0.0048s/iter; left time: 25.4041s
	iters: 1000, epoch: 3 | loss: 0.4079431
	speed: 0.0048s/iter; left time: 24.8930s
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 5.164185523986816
Epoch: 3, Steps: 1027 | Train Loss: 0.4273295 Vali Loss: 0.4106576 Best vali loss: 0.3984651

best validation loss 0.3984651079229381

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022147168852, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3602 --> 0.3577).  Saving model state dict ...
Epoch: 4 cost time: 1.1061973571777344
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3577058 Best vali loss: 0.3577058
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3577 --> 0.3560).  Saving model state dict ...
Epoch: 5 cost time: 0.7842152118682861
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3560195 Best vali loss: 0.3560195
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3560 --> 0.3474).  Saving model state dict ...
Epoch: 6 cost time: 0.7880935668945312
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3474081 Best vali loss: 0.3474081
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3474 --> 0.3472).  Saving model state dict ...
Epoch: 7 cost time: 0.7863707542419434
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3471694 Best vali loss: 0.3471694
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7865951061248779
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3481404 Best vali loss: 0.3471694

best validation loss 0.34716943870124745

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022717434438, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.6536007
	speed: 0.0121s/iter; left time: 98.3014s
	iters: 200, epoch: 1 | loss: 0.4004601
	speed: 0.0053s/iter; left time: 42.3644s
	iters: 300, epoch: 1 | loss: 0.4444774
	speed: 0.0053s/iter; left time: 42.1129s
	iters: 400, epoch: 1 | loss: 1.2235937
	speed: 0.0052s/iter; left time: 40.2683s
	iters: 500, epoch: 1 | loss: 0.5740952
	speed: 0.0048s/iter; left time: 36.8350s
	iters: 600, epoch: 1 | loss: 1.7198167
	speed: 0.0049s/iter; left time: 37.5564s
	iters: 700, epoch: 1 | loss: 1.0502734
	speed: 0.0050s/iter; left time: 37.2109s
	iters: 800, epoch: 1 | loss: 0.3301233
	speed: 0.0049s/iter; left time: 36.6550s
	iters: 900, epoch: 1 | loss: 0.2357665
	speed: 0.0050s/iter; left time: 36.5019s
	iters: 1000, epoch: 1 | loss: 0.4392486
	speed: 0.0050s/iter; left time: 35.7432s
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3988).  Saving model state dict ...
Epoch: 1 cost time: 5.5591230392456055
Epoch: 1, Steps: 1027 | Train Loss: 0.8071456 Vali Loss: 0.3988031 Best vali loss: 0.3988031
	iters: 100, epoch: 2 | loss: 0.4332462
	speed: 0.0132s/iter; left time: 93.6781s
	iters: 200, epoch: 2 | loss: 1.2353164
	speed: 0.0051s/iter; left time: 35.9719s
	iters: 300, epoch: 2 | loss: 0.4936888
	speed: 0.0052s/iter; left time: 35.5227s
	iters: 400, epoch: 2 | loss: 0.2473542
	speed: 0.0051s/iter; left time: 34.8465s
	iters: 500, epoch: 2 | loss: 1.6140379
	speed: 0.0052s/iter; left time: 34.4807s
	iters: 600, epoch: 2 | loss: 0.6715924
	speed: 0.0052s/iter; left time: 34.0953s
	iters: 700, epoch: 2 | loss: 0.3238538
	speed: 0.0052s/iter; left time: 33.6818s
	iters: 800, epoch: 2 | loss: 0.7164114
	speed: 0.0052s/iter; left time: 33.3435s
	iters: 900, epoch: 2 | loss: 0.9825689
	speed: 0.0053s/iter; left time: 33.3430s
	iters: 1000, epoch: 2 | loss: 0.9527380
	speed: 0.0052s/iter; left time: 31.9431s
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 5.357464790344238
Epoch: 2, Steps: 1027 | Train Loss: 0.7670808 Vali Loss: 0.4086037 Best vali loss: 0.3988031
	iters: 100, epoch: 3 | loss: 0.3094786
	speed: 0.0128s/iter; left time: 77.5659s
	iters: 200, epoch: 3 | loss: 0.3409437
	speed: 0.0049s/iter; left time: 29.1134s
	iters: 300, epoch: 3 | loss: 0.3793573
	speed: 0.0049s/iter; left time: 28.4607s
	iters: 400, epoch: 3 | loss: 0.3948164
	speed: 0.0049s/iter; left time: 28.5018s
	iters: 500, epoch: 3 | loss: 0.5269099
	speed: 0.0047s/iter; left time: 26.4029s
	iters: 600, epoch: 3 | loss: 0.3182245
	speed: 0.0048s/iter; left time: 26.6485s
	iters: 700, epoch: 3 | loss: 0.2886131
	speed: 0.0049s/iter; left time: 26.6137s
	iters: 800, epoch: 3 | loss: 0.9991909
	speed: 0.0047s/iter; left time: 25.3512s
	iters: 900, epoch: 3 | loss: 0.3060154
	speed: 0.0046s/iter; left time: 24.4671s
	iters: 1000, epoch: 3 | loss: 0.4098916
	speed: 0.0048s/iter; left time: 24.9651s
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 4.988670825958252
Epoch: 3, Steps: 1027 | Train Loss: 0.4273442 Vali Loss: 0.4109510 Best vali loss: 0.3988031
	iters: 100, epoch: 4 | loss: 0.4473853
	speed: 0.0126s/iter; left time: 63.3260s
	iters: 200, epoch: 4 | loss: 0.3506749
	speed: 0.0046s/iter; left time: 22.4910s
	iters: 300, epoch: 4 | loss: 0.9002041
	speed: 0.0046s/iter; left time: 22.1992s
	iters: 400, epoch: 4 | loss: 0.5343414
	speed: 0.0046s/iter; left time: 21.6586s
	iters: 500, epoch: 4 | loss: 0.7656490
	speed: 0.0046s/iter; left time: 21.1675s
	iters: 600, epoch: 4 | loss: 1.9954489
	speed: 0.0045s/iter; left time: 20.6219s
	iters: 700, epoch: 4 | loss: 0.3083853
	speed: 0.0046s/iter; left time: 20.5154s
	iters: 800, epoch: 4 | loss: 0.3308400
	speed: 0.0046s/iter; left time: 20.1205s
	iters: 900, epoch: 4 | loss: 0.9896151
	speed: 0.0045s/iter; left time: 19.2695s
	iters: 1000, epoch: 4 | loss: 0.4450822
	speed: 0.0045s/iter; left time: 18.7351s
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 4.74436092376709
Epoch: 4, Steps: 1027 | Train Loss: 0.7067626 Vali Loss: 0.4032919 Best vali loss: 0.3988031
	iters: 100, epoch: 5 | loss: 0.2704918
	speed: 0.0130s/iter; left time: 52.2483s
	iters: 200, epoch: 5 | loss: 0.7561963
	speed: 0.0052s/iter; left time: 20.4292s
	iters: 300, epoch: 5 | loss: 0.3728655
	speed: 0.0051s/iter; left time: 19.3882s
	iters: 400, epoch: 5 | loss: 0.5354225
	speed: 0.0052s/iter; left time: 19.1059s
	iters: 500, epoch: 5 | loss: 0.7691202
	speed: 0.0052s/iter; left time: 18.6261s
	iters: 600, epoch: 5 | loss: 0.2464566
	speed: 0.0051s/iter; left time: 18.0408s
	iters: 700, epoch: 5 | loss: 0.3828600
	speed: 0.0052s/iter; left time: 17.7261s
	iters: 800, epoch: 5 | loss: 0.5484908
	speed: 0.0047s/iter; left time: 15.7158s
	iters: 900, epoch: 5 | loss: 0.6529222
	speed: 0.0048s/iter; left time: 15.3557s
	iters: 1000, epoch: 5 | loss: 0.2820666
	speed: 0.0048s/iter; left time: 14.9061s
Updating learning rate to 0.0002182291873478251
Epoch: 5 cost time: 5.203984260559082
Epoch: 5, Steps: 1027 | Train Loss: 0.4816892 Vali Loss: 0.4039577 Best vali loss: 0.3988031
	iters: 100, epoch: 6 | loss: 0.4754777
	speed: 0.0126s/iter; left time: 37.6828s
	iters: 200, epoch: 6 | loss: 0.9744785
	speed: 0.0046s/iter; left time: 13.2527s
	iters: 300, epoch: 6 | loss: 0.6364309
	speed: 0.0047s/iter; left time: 12.9728s
	iters: 400, epoch: 6 | loss: 1.3350116
	speed: 0.0048s/iter; left time: 12.7948s
	iters: 500, epoch: 6 | loss: 1.3896614
	speed: 0.0047s/iter; left time: 12.2378s
	iters: 600, epoch: 6 | loss: 0.9163584
	speed: 0.0048s/iter; left time: 11.9650s
	iters: 700, epoch: 6 | loss: 0.2041787
	speed: 0.0047s/iter; left time: 11.2829s
	iters: 800, epoch: 6 | loss: 0.5154253
	speed: 0.0045s/iter; left time: 10.3163s
	iters: 900, epoch: 6 | loss: 1.1332229
	speed: 0.0045s/iter; left time: 9.8688s
	iters: 1000, epoch: 6 | loss: 0.3246178
	speed: 0.0045s/iter; left time: 9.4457s
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 4.828255653381348
Epoch: 6, Steps: 1027 | Train Loss: 0.7904863 Vali Loss: 0.4048509 Best vali loss: 0.3988031
	iters: 100, epoch: 7 | loss: 0.3239459
	speed: 0.0133s/iter; left time: 25.9170s
	iters: 200, epoch: 7 | loss: 1.1109018
	speed: 0.0052s/iter; left time: 9.6923s
	iters: 300, epoch: 7 | loss: 0.9268489
	speed: 0.0052s/iter; left time: 9.1644s
	iters: 400, epoch: 7 | loss: 1.2173284
	speed: 0.0052s/iter; left time: 8.6532s
	iters: 500, epoch: 7 | loss: 0.3102142
	speed: 0.0050s/iter; left time: 7.7399s
	iters: 600, epoch: 7 | loss: 0.4859880
	speed: 0.0048s/iter; left time: 7.0438s
	iters: 700, epoch: 7 | loss: 0.3337744
	speed: 0.0048s/iter; left time: 6.5395s
	iters: 800, epoch: 7 | loss: 0.3655229
	speed: 0.0048s/iter; left time: 6.0755s
	iters: 900, epoch: 7 | loss: 0.3118168
	speed: 0.0048s/iter; left time: 5.5892s
	iters: 1000, epoch: 7 | loss: 0.7838696
	speed: 0.0048s/iter; left time: 5.0952s
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 5.1812872886657715
Epoch: 7, Steps: 1027 | Train Loss: 0.6170211 Vali Loss: 0.4044033 Best vali loss: 0.3988031
	iters: 100, epoch: 8 | loss: 0.4485045
	speed: 0.0126s/iter; left time: 11.6968s
	iters: 200, epoch: 8 | loss: 0.4380809
	speed: 0.0045s/iter; left time: 3.7475s
	iters: 300, epoch: 8 | loss: 1.1726341
	speed: 0.0045s/iter; left time: 3.2912s
	iters: 400, epoch: 8 | loss: 0.3318006
	speed: 0.0045s/iter; left time: 2.8549s
	iters: 500, epoch: 8 | loss: 0.5711583
	speed: 0.0045s/iter; left time: 2.4022s
	iters: 600, epoch: 8 | loss: 0.7698787
	speed: 0.0045s/iter; left time: 1.9446s
	iters: 700, epoch: 8 | loss: 1.1781325
	speed: 0.0045s/iter; left time: 1.4738s
	iters: 800, epoch: 8 | loss: 0.3838684
	speed: 0.0045s/iter; left time: 1.0269s
	iters: 900, epoch: 8 | loss: 1.1668433
	speed: 0.0047s/iter; left time: 0.6025s
	iters: 1000, epoch: 8 | loss: 0.5358638
	speed: 0.0046s/iter; left time: 0.1287s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.7268476486206055
Epoch: 8, Steps: 1027 | Train Loss: 0.6996765 Vali Loss: 0.4042134 Best vali loss: 0.3988031

best validation loss 0.3988030847725559

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032490857294, 'e_layers': 1, 'learning_rate': 0.0001782456997, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4709644
	speed: 0.0093s/iter; left time: 18.2500s
	iters: 200, epoch: 1 | loss: 0.5993383
	speed: 0.0028s/iter; left time: 5.1706s
Updating learning rate to 0.0001782456997
Validation loss decreased (inf --> 0.3992).  Saving model state dict ...
Epoch: 1 cost time: 1.0553574562072754
Epoch: 1, Steps: 257 | Train Loss: 0.5351514 Vali Loss: 0.3992275 Best vali loss: 0.3992275
	iters: 100, epoch: 2 | loss: 0.5822724
	speed: 0.0067s/iter; left time: 11.3767s
	iters: 200, epoch: 2 | loss: 0.8975220
	speed: 0.0028s/iter; left time: 4.4311s
Updating learning rate to 8.912284985e-05
Validation loss decreased (0.3992 --> 0.3811).  Saving model state dict ...
Epoch: 2 cost time: 0.7493832111358643
Epoch: 2, Steps: 257 | Train Loss: 0.7398972 Vali Loss: 0.3811478 Best vali loss: 0.3811478
	iters: 100, epoch: 3 | loss: 0.6292346
	speed: 0.0065s/iter; left time: 9.3856s
	iters: 200, epoch: 3 | loss: 0.8441271
	speed: 0.0028s/iter; left time: 3.7294s
Updating learning rate to 4.4561424925e-05
Validation loss decreased (0.3811 --> 0.3754).  Saving model state dict ...
Epoch: 3 cost time: 0.7480814456939697
Epoch: 3, Steps: 257 | Train Loss: 0.7366808 Vali Loss: 0.3753874 Best vali loss: 0.3753874
	iters: 100, epoch: 4 | loss: 0.5930615
	speed: 0.0064s/iter; left time: 7.5494s
	iters: 200, epoch: 4 | loss: 0.4748928
	speed: 0.0026s/iter; left time: 2.8417s
Updating learning rate to 2.22807124625e-05
Validation loss decreased (0.3754 --> 0.3734).  Saving model state dict ...
Epoch: 4 cost time: 0.7246088981628418
Epoch: 4, Steps: 257 | Train Loss: 0.5339772 Vali Loss: 0.3733657 Best vali loss: 0.3733657
	iters: 100, epoch: 5 | loss: 0.4234832
	speed: 0.0064s/iter; left time: 5.9216s
	iters: 200, epoch: 5 | loss: 0.9155213
	speed: 0.0026s/iter; left time: 2.1511s
Updating learning rate to 1.114035623125e-05
Validation loss decreased (0.3734 --> 0.3725).  Saving model state dict ...
Epoch: 5 cost time: 0.7251839637756348
Epoch: 5, Steps: 257 | Train Loss: 0.6695023 Vali Loss: 0.3725046 Best vali loss: 0.3725046
	iters: 100, epoch: 6 | loss: 0.7094216
	speed: 0.0065s/iter; left time: 4.3975s
	iters: 200, epoch: 6 | loss: 0.6839647
	speed: 0.0026s/iter; left time: 1.4709s
Updating learning rate to 5.570178115625e-06
Validation loss decreased (0.3725 --> 0.3721).  Saving model state dict ...
Epoch: 6 cost time: 0.7166039943695068
Epoch: 6, Steps: 257 | Train Loss: 0.6966931 Vali Loss: 0.3721107 Best vali loss: 0.3721107
	iters: 100, epoch: 7 | loss: 0.4161364
	speed: 0.0065s/iter; left time: 2.6968s
	iters: 200, epoch: 7 | loss: 0.6503816
	speed: 0.0026s/iter; left time: 0.8233s
Updating learning rate to 2.7850890578125e-06
Validation loss decreased (0.3721 --> 0.3720).  Saving model state dict ...
Epoch: 7 cost time: 0.7195367813110352
Epoch: 7, Steps: 257 | Train Loss: 0.5332590 Vali Loss: 0.3719868 Best vali loss: 0.3719868
	iters: 100, epoch: 8 | loss: 0.5056928
	speed: 0.0064s/iter; left time: 1.0069s
	iters: 200, epoch: 8 | loss: 0.4853652
	speed: 0.0025s/iter; left time: 0.1469s
Updating learning rate to 1.39254452890625e-06
Validation loss decreased (0.3720 --> 0.3719).  Saving model state dict ...
Epoch: 8 cost time: 0.7103476524353027
Epoch: 8, Steps: 257 | Train Loss: 0.4955290 Vali Loss: 0.3719000 Best vali loss: 0.3719000

best validation loss 0.37190002370442765

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.7027051
	speed: 0.0113s/iter; left time: 91.5607s
	iters: 200, epoch: 1 | loss: 0.4024973
	speed: 0.0052s/iter; left time: 41.7072s
	iters: 300, epoch: 1 | loss: 0.4442171
	speed: 0.0052s/iter; left time: 41.0581s
	iters: 400, epoch: 1 | loss: 1.2246771
	speed: 0.0052s/iter; left time: 40.8149s
	iters: 500, epoch: 1 | loss: 0.5734210
	speed: 0.0052s/iter; left time: 40.2465s
	iters: 600, epoch: 1 | loss: 1.7215952
	speed: 0.0052s/iter; left time: 39.4905s
	iters: 700, epoch: 1 | loss: 1.0444673
	speed: 0.0052s/iter; left time: 38.7376s
	iters: 800, epoch: 1 | loss: 0.3267403
	speed: 0.0052s/iter; left time: 38.9205s
	iters: 900, epoch: 1 | loss: 0.2302015
	speed: 0.0052s/iter; left time: 38.2860s
	iters: 1000, epoch: 1 | loss: 0.4386906
	speed: 0.0052s/iter; left time: 37.4463s
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3975).  Saving model state dict ...
Epoch: 1 cost time: 5.695165157318115
Epoch: 1, Steps: 1027 | Train Loss: 0.8109213 Vali Loss: 0.3975132 Best vali loss: 0.3975132
	iters: 100, epoch: 2 | loss: 0.4256161
	speed: 0.0127s/iter; left time: 89.9586s
	iters: 200, epoch: 2 | loss: 1.1278843
	speed: 0.0045s/iter; left time: 31.6378s
	iters: 300, epoch: 2 | loss: 0.4990545
	speed: 0.0045s/iter; left time: 31.0758s
	iters: 400, epoch: 2 | loss: 0.2449966
	speed: 0.0045s/iter; left time: 30.6393s
	iters: 500, epoch: 2 | loss: 1.6312345
	speed: 0.0046s/iter; left time: 30.8180s
	iters: 600, epoch: 2 | loss: 0.6682405
	speed: 0.0048s/iter; left time: 31.4903s
	iters: 700, epoch: 2 | loss: 0.3210055
	speed: 0.0049s/iter; left time: 31.4798s
	iters: 800, epoch: 2 | loss: 0.7148021
	speed: 0.0050s/iter; left time: 31.9524s
	iters: 900, epoch: 2 | loss: 0.9846770
	speed: 0.0050s/iter; left time: 31.4484s
	iters: 1000, epoch: 2 | loss: 0.9453355
	speed: 0.0050s/iter; left time: 30.9529s
Updating learning rate to 0.00035374494395
Epoch: 2 cost time: 4.907444477081299
Epoch: 2, Steps: 1027 | Train Loss: 0.7562847 Vali Loss: 0.4057484 Best vali loss: 0.3975132
	iters: 100, epoch: 3 | loss: 0.3127519
	speed: 0.0130s/iter; left time: 78.9166s
	iters: 200, epoch: 3 | loss: 0.3374939
	speed: 0.0051s/iter; left time: 30.5497s
	iters: 300, epoch: 3 | loss: 0.3762702
	speed: 0.0051s/iter; left time: 30.1117s
	iters: 400, epoch: 3 | loss: 0.4082454
	speed: 0.0051s/iter; left time: 29.5479s
	iters: 500, epoch: 3 | loss: 0.5200369
	speed: 0.0050s/iter; left time: 28.4293s
	iters: 600, epoch: 3 | loss: 0.3114976
	speed: 0.0050s/iter; left time: 27.8794s
	iters: 700, epoch: 3 | loss: 0.2803793
	speed: 0.0053s/iter; left time: 28.7626s
	iters: 800, epoch: 3 | loss: 1.0006359
	speed: 0.0051s/iter; left time: 27.2145s
	iters: 900, epoch: 3 | loss: 0.2985258
	speed: 0.0052s/iter; left time: 27.4473s
	iters: 1000, epoch: 3 | loss: 0.4100538
	speed: 0.0051s/iter; left time: 26.3992s
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 5.303415060043335
Epoch: 3, Steps: 1027 | Train Loss: 0.4255891 Vali Loss: 0.4044183 Best vali loss: 0.3975132

best validation loss 0.39751317250470986

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008874451865, 'e_layers': 1, 'learning_rate': 0.0005562094216, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0834191
	speed: 0.0091s/iter; left time: 8.4653s
Updating learning rate to 0.0005562094216
Validation loss decreased (inf --> 0.3684).  Saving model state dict ...
Epoch: 1 cost time: 0.7304427623748779
Epoch: 1, Steps: 129 | Train Loss: 1.0834191 Vali Loss: 0.3684446 Best vali loss: 0.3684446
	iters: 100, epoch: 2 | loss: 0.7991384
	speed: 0.0058s/iter; left time: 4.6263s
Updating learning rate to 0.0002781047108
Epoch: 2 cost time: 0.4315338134765625
Epoch: 2, Steps: 129 | Train Loss: 0.7991384 Vali Loss: 0.3702413 Best vali loss: 0.3684446
	iters: 100, epoch: 3 | loss: 0.5664746
	speed: 0.0057s/iter; left time: 3.8405s
Updating learning rate to 0.0001390523554
Validation loss decreased (0.3684 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 0.43404531478881836
Epoch: 3, Steps: 129 | Train Loss: 0.5664746 Vali Loss: 0.3683588 Best vali loss: 0.3683588

best validation loss 0.36835884669674873

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5692018
	speed: 0.0134s/iter; left time: 12.4883s
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3791).  Saving model state dict ...
Epoch: 1 cost time: 1.2783117294311523
Epoch: 1, Steps: 129 | Train Loss: 0.5692018 Vali Loss: 0.3791108 Best vali loss: 0.3791108
	iters: 100, epoch: 2 | loss: 0.5400726
	speed: 0.0116s/iter; left time: 9.3590s
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3791 --> 0.3787).  Saving model state dict ...
Epoch: 2 cost time: 0.9370467662811279
Epoch: 2, Steps: 129 | Train Loss: 0.5400726 Vali Loss: 0.3787443 Best vali loss: 0.3787443
	iters: 100, epoch: 3 | loss: 0.6103837
	speed: 0.0118s/iter; left time: 7.9875s
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 0.9287281036376953
Epoch: 3, Steps: 129 | Train Loss: 0.6103837 Vali Loss: 0.3862729 Best vali loss: 0.3787443

best validation loss 0.37874425523173366

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008874451865, 'e_layers': 1, 'learning_rate': 0.0005562094216, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0152646
	speed: 0.0096s/iter; left time: 5.2268s
Updating learning rate to 6.95261777e-05
Epoch: 4 cost time: 0.7794764041900635
Epoch: 4, Steps: 129 | Train Loss: 1.0152646 Vali Loss: 0.3687399 Best vali loss: 0.3683588
	iters: 100, epoch: 5 | loss: 0.7617499
	speed: 0.0059s/iter; left time: 2.4509s
Updating learning rate to 3.476308885e-05
Epoch: 5 cost time: 0.42542362213134766
Epoch: 5, Steps: 129 | Train Loss: 0.7617499 Vali Loss: 0.3698524 Best vali loss: 0.3683588
	iters: 100, epoch: 6 | loss: 0.5584027
	speed: 0.0056s/iter; left time: 1.6223s
Updating learning rate to 1.7381544425e-05
Epoch: 6 cost time: 0.42787909507751465
Epoch: 6, Steps: 129 | Train Loss: 0.5584027 Vali Loss: 0.3692090 Best vali loss: 0.3683588
	iters: 100, epoch: 7 | loss: 0.5569280
	speed: 0.0058s/iter; left time: 0.9286s
Updating learning rate to 8.6907722125e-06
Epoch: 7 cost time: 0.4430668354034424
Epoch: 7, Steps: 129 | Train Loss: 0.5569280 Vali Loss: 0.3692077 Best vali loss: 0.3683588
	iters: 100, epoch: 8 | loss: 0.5699904
	speed: 0.0059s/iter; left time: 0.1772s
Updating learning rate to 4.34538610625e-06
Epoch: 8 cost time: 0.4499857425689697
Epoch: 8, Steps: 129 | Train Loss: 0.5699904 Vali Loss: 0.3692602 Best vali loss: 0.3683588

best validation loss 0.36835884669674873

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0027964089929, 'e_layers': 2, 'learning_rate': 5.57436157e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7372105
	speed: 0.0109s/iter; left time: 10.1686s
Updating learning rate to 5.362200065670241e-05
Validation loss decreased (inf --> 0.3661).  Saving model state dict ...
Epoch: 1 cost time: 0.9485378265380859
Epoch: 1, Steps: 129 | Train Loss: 0.7372105 Vali Loss: 0.3660962 Best vali loss: 0.3660962
	iters: 100, epoch: 2 | loss: 0.8380181
	speed: 0.0077s/iter; left time: 6.1536s
Updating learning rate to 4.7580152184663446e-05
Validation loss decreased (0.3661 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 0.5853393077850342
Epoch: 2, Steps: 129 | Train Loss: 0.8380181 Vali Loss: 0.3640711 Best vali loss: 0.3640711
	iters: 100, epoch: 3 | loss: 0.6978075
	speed: 0.0076s/iter; left time: 5.1316s
Updating learning rate to 3.853788694425826e-05
Validation loss decreased (0.3641 --> 0.3605).  Saving model state dict ...
Epoch: 3 cost time: 0.5710201263427734
Epoch: 3, Steps: 129 | Train Loss: 0.6978075 Vali Loss: 0.3605240 Best vali loss: 0.3605240
	iters: 100, epoch: 4 | loss: 0.3912067
	speed: 0.0077s/iter; left time: 4.2034s
Updating learning rate to 2.787180785e-05
Validation loss decreased (0.3605 --> 0.3586).  Saving model state dict ...
Epoch: 4 cost time: 0.5759782791137695
Epoch: 4, Steps: 129 | Train Loss: 0.3912067 Vali Loss: 0.3586399 Best vali loss: 0.3586399
	iters: 100, epoch: 5 | loss: 0.7591084
	speed: 0.0077s/iter; left time: 3.2225s
Updating learning rate to 1.720572875574175e-05
Epoch: 5 cost time: 0.5794322490692139
Epoch: 5, Steps: 129 | Train Loss: 0.7591084 Vali Loss: 0.3604408 Best vali loss: 0.3586399
	iters: 100, epoch: 6 | loss: 0.6485838
	speed: 0.0073s/iter; left time: 2.0905s
Updating learning rate to 8.163463515336554e-06
Epoch: 6 cost time: 0.5701091289520264
Epoch: 6, Steps: 129 | Train Loss: 0.6485838 Vali Loss: 0.3643889 Best vali loss: 0.3586399
	iters: 100, epoch: 7 | loss: 0.3487463
	speed: 0.0073s/iter; left time: 1.1641s
Updating learning rate to 2.1216150432975883e-06
Epoch: 7 cost time: 0.5802221298217773
Epoch: 7, Steps: 129 | Train Loss: 0.3487463 Vali Loss: 0.3621121 Best vali loss: 0.3586399
	iters: 100, epoch: 8 | loss: 0.5283946
	speed: 0.0074s/iter; left time: 0.2216s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5725913047790527
Epoch: 8, Steps: 129 | Train Loss: 0.5283946 Vali Loss: 0.3646250 Best vali loss: 0.3586399

best validation loss 0.3586399253084524

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022867644791, 'e_layers': 4, 'learning_rate': 0.0006222378892, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005985553696924529
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 1.1143934726715088
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3659273 Best vali loss: 0.3659273
Updating learning rate to 0.0005311132600822618
Validation loss decreased (0.3659 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 0.799659252166748
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3637038 Best vali loss: 0.3637038
Updating learning rate to 0.0004301790101933322
Validation loss decreased (0.3637 --> 0.3569).  Saving model state dict ...
Epoch: 3 cost time: 0.7921748161315918
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3568985 Best vali loss: 0.3568985
Updating learning rate to 0.0003111189446
Validation loss decreased (0.3569 --> 0.3450).  Saving model state dict ...
Epoch: 4 cost time: 0.8042726516723633
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3449786 Best vali loss: 0.3449786
Updating learning rate to 0.0001920588790066678
Validation loss decreased (0.3450 --> 0.3428).  Saving model state dict ...
Epoch: 5 cost time: 0.7941920757293701
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3427747 Best vali loss: 0.3427747
Updating learning rate to 9.112462911773821e-05
Epoch: 6 cost time: 0.7940988540649414
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3486414 Best vali loss: 0.3427747
Updating learning rate to 2.368251950754708e-05
Epoch: 7 cost time: 0.7942142486572266
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3542144 Best vali loss: 0.3427747
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7915031909942627
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3570108 Best vali loss: 0.3427747

best validation loss 0.342774666444726

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0079754924603, 'e_layers': 3, 'learning_rate': 0.0004582200065, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6776558
	speed: 0.0101s/iter; left time: 40.4873s
	iters: 200, epoch: 1 | loss: 0.3874790
	speed: 0.0039s/iter; left time: 15.4314s
	iters: 300, epoch: 1 | loss: 0.3700711
	speed: 0.0040s/iter; left time: 15.3518s
	iters: 400, epoch: 1 | loss: 1.0088584
	speed: 0.0040s/iter; left time: 14.7108s
	iters: 500, epoch: 1 | loss: 0.4575810
	speed: 0.0039s/iter; left time: 14.1786s
Updating learning rate to 0.00044078004594626935
Validation loss decreased (inf --> 0.3793).  Saving model state dict ...
Epoch: 1 cost time: 2.3951191902160645
Epoch: 1, Steps: 514 | Train Loss: 0.5803291 Vali Loss: 0.3792569 Best vali loss: 0.3792569
	iters: 100, epoch: 2 | loss: 1.4230220
	speed: 0.0084s/iter; left time: 29.4366s
	iters: 200, epoch: 2 | loss: 0.3498797
	speed: 0.0040s/iter; left time: 13.6142s
	iters: 300, epoch: 2 | loss: 0.9095019
	speed: 0.0038s/iter; left time: 12.5661s
	iters: 400, epoch: 2 | loss: 0.9778889
	speed: 0.0038s/iter; left time: 12.3127s
	iters: 500, epoch: 2 | loss: 0.4114129
	speed: 0.0038s/iter; left time: 11.7720s
Updating learning rate to 0.00039111524018574693
Epoch: 2 cost time: 2.030120849609375
Epoch: 2, Steps: 514 | Train Loss: 0.8143411 Vali Loss: 0.3919964 Best vali loss: 0.3792569
	iters: 100, epoch: 3 | loss: 0.6902472
	speed: 0.0086s/iter; left time: 25.7052s
	iters: 200, epoch: 3 | loss: 0.5218884
	speed: 0.0044s/iter; left time: 12.7593s
	iters: 300, epoch: 3 | loss: 0.5903539
	speed: 0.0044s/iter; left time: 12.2182s
	iters: 400, epoch: 3 | loss: 0.4992271
	speed: 0.0039s/iter; left time: 10.4842s
	iters: 500, epoch: 3 | loss: 0.6407055
	speed: 0.0039s/iter; left time: 10.1808s
Updating learning rate to 0.0003167866056828869
Epoch: 3 cost time: 2.2048258781433105
Epoch: 3, Steps: 514 | Train Loss: 0.5884844 Vali Loss: 0.3805502 Best vali loss: 0.3792569

best validation loss 0.3792569245711291

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0014263863128, 'e_layers': 3, 'learning_rate': 7.01012827e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.743321149465878e-05
Validation loss decreased (inf --> 0.4225).  Saving model state dict ...
Epoch: 1 cost time: 0.7098758220672607
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4225485 Best vali loss: 0.4225485
Updating learning rate to 5.9835187533522605e-05
Validation loss decreased (0.4225 --> 0.4060).  Saving model state dict ...
Epoch: 2 cost time: 0.3995997905731201
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4060196 Best vali loss: 0.4060196
Updating learning rate to 4.8463941088415746e-05
Validation loss decreased (0.4060 --> 0.3951).  Saving model state dict ...
Epoch: 3 cost time: 0.41665196418762207
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3951282 Best vali loss: 0.3951282

best validation loss 0.3951282142187617

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6180528
	speed: 0.0122s/iter; left time: 11.3375s
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.1247444152832031
Epoch: 1, Steps: 129 | Train Loss: 0.6180528 Vali Loss: 0.3695670 Best vali loss: 0.3695670
	iters: 100, epoch: 2 | loss: 0.4903499
	speed: 0.0100s/iter; left time: 8.0206s
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3696 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 0.8119382858276367
Epoch: 2, Steps: 129 | Train Loss: 0.4903499 Vali Loss: 0.3683364 Best vali loss: 0.3683364
	iters: 100, epoch: 3 | loss: 0.5853871
	speed: 0.0092s/iter; left time: 6.2023s
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3683 --> 0.3511).  Saving model state dict ...
Epoch: 3 cost time: 0.7215137481689453
Epoch: 3, Steps: 129 | Train Loss: 0.5853871 Vali Loss: 0.3511300 Best vali loss: 0.3511300

best validation loss 0.3511300229838883

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022126270841, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5239006
	speed: 0.0122s/iter; left time: 6.6655s
Updating learning rate to 8.8440874725e-05
Epoch: 4 cost time: 1.1130845546722412
Epoch: 4, Steps: 129 | Train Loss: 0.5239006 Vali Loss: 0.3584465 Best vali loss: 0.3511300
	iters: 100, epoch: 5 | loss: 0.3796684
	speed: 0.0094s/iter; left time: 3.9129s
Updating learning rate to 4.42204373625e-05
Validation loss decreased (0.3511 --> 0.3511).  Saving model state dict ...
Epoch: 5 cost time: 0.7847630977630615
Epoch: 5, Steps: 129 | Train Loss: 0.3796684 Vali Loss: 0.3510612 Best vali loss: 0.3510612
	iters: 100, epoch: 6 | loss: 0.4966128
	speed: 0.0094s/iter; left time: 2.7028s
Updating learning rate to 2.211021868125e-05
Validation loss decreased (0.3511 --> 0.3499).  Saving model state dict ...
Epoch: 6 cost time: 0.7642819881439209
Epoch: 6, Steps: 129 | Train Loss: 0.4966128 Vali Loss: 0.3499381 Best vali loss: 0.3499381
	iters: 100, epoch: 7 | loss: 0.5035232
	speed: 0.0097s/iter; left time: 1.5486s
Updating learning rate to 1.1055109340625e-05
Epoch: 7 cost time: 0.8035457134246826
Epoch: 7, Steps: 129 | Train Loss: 0.5035232 Vali Loss: 0.3540207 Best vali loss: 0.3499381
	iters: 100, epoch: 8 | loss: 0.4145271
	speed: 0.0094s/iter; left time: 0.2830s
Updating learning rate to 5.5275546703125e-06
Epoch: 8 cost time: 0.7777869701385498
Epoch: 8, Steps: 129 | Train Loss: 0.4145271 Vali Loss: 0.3533672 Best vali loss: 0.3499381

best validation loss 0.3499380699075275

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0016481796937, 'e_layers': 3, 'learning_rate': 0.000902939747, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6358457
	speed: 0.0114s/iter; left time: 10.6148s
Updating learning rate to 0.0008685736491721098
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.0212111473083496
Epoch: 1, Steps: 129 | Train Loss: 0.6358457 Vali Loss: 0.3655038 Best vali loss: 0.3655038
	iters: 100, epoch: 2 | loss: 0.6601816
	speed: 0.0085s/iter; left time: 6.8099s
Updating learning rate to 0.0007707072825532828
Validation loss decreased (0.3655 --> 0.3615).  Saving model state dict ...
Epoch: 2 cost time: 0.6905527114868164
Epoch: 2, Steps: 129 | Train Loss: 0.6601816 Vali Loss: 0.3614701 Best vali loss: 0.3614701
	iters: 100, epoch: 3 | loss: 0.4357869
	speed: 0.0080s/iter; left time: 5.3883s
Updating learning rate to 0.0006242399143004129
Epoch: 3 cost time: 0.6172819137573242
Epoch: 3, Steps: 129 | Train Loss: 0.4357869 Vali Loss: 0.3658593 Best vali loss: 0.3614701
	iters: 100, epoch: 4 | loss: 0.6993645
	speed: 0.0084s/iter; left time: 4.5913s
Updating learning rate to 0.0004514698735
Validation loss decreased (0.3615 --> 0.3573).  Saving model state dict ...
Epoch: 4 cost time: 0.7080659866333008
Epoch: 4, Steps: 129 | Train Loss: 0.6993645 Vali Loss: 0.3572796 Best vali loss: 0.3572796
	iters: 100, epoch: 5 | loss: 0.7540510
	speed: 0.0083s/iter; left time: 3.4729s
Updating learning rate to 0.00027869983269958716
Validation loss decreased (0.3573 --> 0.3567).  Saving model state dict ...
Epoch: 5 cost time: 0.6591200828552246
Epoch: 5, Steps: 129 | Train Loss: 0.7540510 Vali Loss: 0.3566607 Best vali loss: 0.3566607
	iters: 100, epoch: 6 | loss: 0.4455946
	speed: 0.0085s/iter; left time: 2.4594s
Updating learning rate to 0.00013223246444671723
Validation loss decreased (0.3567 --> 0.3548).  Saving model state dict ...
Epoch: 6 cost time: 0.7122905254364014
Epoch: 6, Steps: 129 | Train Loss: 0.4455946 Vali Loss: 0.3548007 Best vali loss: 0.3548007
	iters: 100, epoch: 7 | loss: 0.4912326
	speed: 0.0082s/iter; left time: 1.3027s
Updating learning rate to 3.436609782789024e-05
Epoch: 7 cost time: 0.6440093517303467
Epoch: 7, Steps: 129 | Train Loss: 0.4912326 Vali Loss: 0.3592603 Best vali loss: 0.3548007
	iters: 100, epoch: 8 | loss: 0.4868111
	speed: 0.0084s/iter; left time: 0.2514s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6985883712768555
Epoch: 8, Steps: 129 | Train Loss: 0.4868111 Vali Loss: 0.3577661 Best vali loss: 0.3548007

best validation loss 0.35480067048419434

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023287301666, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.0728321075439453
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3733817 Best vali loss: 0.3733817
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3734 --> 0.3731).  Saving model state dict ...
Epoch: 2 cost time: 0.7707245349884033
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3730687 Best vali loss: 0.3730687
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7702600955963135
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3759132 Best vali loss: 0.3730687
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3731 --> 0.3700).  Saving model state dict ...
Epoch: 4 cost time: 0.7669131755828857
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3699890 Best vali loss: 0.3699890
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3700 --> 0.3536).  Saving model state dict ...
Epoch: 5 cost time: 0.76796555519104
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3535880 Best vali loss: 0.3535880
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7751009464263916
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3572981 Best vali loss: 0.3535880
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7641448974609375
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3778029 Best vali loss: 0.3535880
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7701497077941895
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3708033 Best vali loss: 0.3535880

best validation loss 0.3535879794178871

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0103486406024, 'e_layers': 4, 'learning_rate': 5.37206525e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37206525e-05
Validation loss decreased (inf --> 0.3865).  Saving model state dict ...
Epoch: 1 cost time: 0.7970266342163086
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3865427 Best vali loss: 0.3865427
Updating learning rate to 2.686032625e-05
Validation loss decreased (0.3865 --> 0.3704).  Saving model state dict ...
Epoch: 2 cost time: 0.49901461601257324
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3704066 Best vali loss: 0.3704066
Updating learning rate to 1.3430163125e-05
Validation loss decreased (0.3704 --> 0.3672).  Saving model state dict ...
Epoch: 3 cost time: 0.5053067207336426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3671692 Best vali loss: 0.3671692

best validation loss 0.3671692128031568

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0091263122001, 'e_layers': 4, 'learning_rate': 5.07026504e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.07026504e-05
Validation loss decreased (inf --> 0.3881).  Saving model state dict ...
Epoch: 1 cost time: 0.7902615070343018
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3881005 Best vali loss: 0.3881005
Updating learning rate to 2.53513252e-05
Validation loss decreased (0.3881 --> 0.3715).  Saving model state dict ...
Epoch: 2 cost time: 0.48955798149108887
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3714940 Best vali loss: 0.3714940
Updating learning rate to 1.26756626e-05
Validation loss decreased (0.3715 --> 0.3679).  Saving model state dict ...
Epoch: 3 cost time: 0.49754810333251953
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3679441 Best vali loss: 0.3679441

best validation loss 0.3679440555848869

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023373699643, 'e_layers': 4, 'learning_rate': 5.00431132e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.81384606143127e-05
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 1.1166234016418457
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3682580 Best vali loss: 0.3682580
Updating learning rate to 4.2714468947703014e-05
Validation loss decreased (0.3683 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 0.7960474491119385
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3636181 Best vali loss: 0.3636181
Updating learning rate to 3.459689176280537e-05
Epoch: 3 cost time: 0.8016324043273926
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3652445 Best vali loss: 0.3636181

best validation loss 0.36361808690200387

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023373699643, 'e_layers': 4, 'learning_rate': 5.00431132e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.50215566e-05
Validation loss decreased (0.3636 --> 0.3617).  Saving model state dict ...
Epoch: 4 cost time: 1.1425988674163818
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3616509 Best vali loss: 0.3616509
Updating learning rate to 1.5446221437194635e-05
Epoch: 5 cost time: 0.806506872177124
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3633961 Best vali loss: 0.3616509
Updating learning rate to 7.328644252296988e-06
Validation loss decreased (0.3617 --> 0.3609).  Saving model state dict ...
Epoch: 6 cost time: 0.7957291603088379
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3608848 Best vali loss: 0.3608848
Updating learning rate to 1.9046525856872988e-06
Validation loss decreased (0.3609 --> 0.3587).  Saving model state dict ...
Epoch: 7 cost time: 0.8154380321502686
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3587445 Best vali loss: 0.3587445
Updating learning rate to 0.0
Validation loss decreased (0.3587 --> 0.3586).  Saving model state dict ...
Epoch: 8 cost time: 0.809058427810669
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3586235 Best vali loss: 0.3586235

best validation loss 0.35862348074997336

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023230936084, 'e_layers': 4, 'learning_rate': 0.0007073711667, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006804484547513797
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 1.0820817947387695
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732892 Best vali loss: 0.3732892
Updating learning rate to 0.0006037790577447048
Epoch: 2 cost time: 0.7844774723052979
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3748728 Best vali loss: 0.3732892
Updating learning rate to 0.0004890351963644271
Epoch: 3 cost time: 0.7815492153167725
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3853289 Best vali loss: 0.3732892
Updating learning rate to 0.00035368558335
Epoch: 4 cost time: 0.7858681678771973
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4007155 Best vali loss: 0.3732892
Updating learning rate to 0.00021833597033557296
Epoch: 5 cost time: 0.7865920066833496
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3758642 Best vali loss: 0.3732892
Updating learning rate to 0.00010359210895529515
Epoch: 6 cost time: 0.7883803844451904
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3850575 Best vali loss: 0.3732892
Updating learning rate to 2.6922711948620257e-05
Epoch: 7 cost time: 0.7854897975921631
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3946606 Best vali loss: 0.3732892
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7823605537414551
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3862361 Best vali loss: 0.3732892

best validation loss 0.3732892286332511

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0030678929815, 'e_layers': 4, 'learning_rate': 8.83366953e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.83366953e-05
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 0.7991805076599121
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3776231 Best vali loss: 0.3776231
Updating learning rate to 4.416834765e-05
Validation loss decreased (0.3776 --> 0.3664).  Saving model state dict ...
Epoch: 2 cost time: 0.48311376571655273
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3663702 Best vali loss: 0.3663702
Updating learning rate to 2.2084173825e-05
Validation loss decreased (0.3664 --> 0.3646).  Saving model state dict ...
Epoch: 3 cost time: 0.47869062423706055
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3646003 Best vali loss: 0.3646003
Updating learning rate to 1.10420869125e-05
Validation loss decreased (0.3646 --> 0.3633).  Saving model state dict ...
Epoch: 4 cost time: 0.44402647018432617
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3632735 Best vali loss: 0.3632735
Updating learning rate to 5.52104345625e-06
Epoch: 5 cost time: 0.43536877632141113
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3634104 Best vali loss: 0.3632735
Updating learning rate to 2.760521728125e-06
Validation loss decreased (0.3633 --> 0.3633).  Saving model state dict ...
Epoch: 6 cost time: 0.47576427459716797
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3632646 Best vali loss: 0.3632646
Updating learning rate to 1.3802608640625e-06
Validation loss decreased (0.3633 --> 0.3632).  Saving model state dict ...
Epoch: 7 cost time: 0.4762709140777588
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3632390 Best vali loss: 0.3632390
Updating learning rate to 6.9013043203125e-07
Epoch: 8 cost time: 0.4442615509033203
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3632440 Best vali loss: 0.3632390

best validation loss 0.3632390490566583

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073012038, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007073012038
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 1.078688621520996
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3728948 Best vali loss: 0.3728948
Updating learning rate to 0.0003536506019
Epoch: 2 cost time: 0.7706847190856934
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3755748 Best vali loss: 0.3728948
Updating learning rate to 0.00017682530095
Validation loss decreased (0.3729 --> 0.3647).  Saving model state dict ...
Epoch: 3 cost time: 0.7740912437438965
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3647428 Best vali loss: 0.3647428

best validation loss 0.36474281038891354

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 2, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007075269978
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.772796630859375
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704796 Best vali loss: 0.3704796
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3705 --> 0.3502).  Saving model state dict ...
Epoch: 2 cost time: 0.4494607448577881
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3501944 Best vali loss: 0.3501944
Updating learning rate to 0.00017688174945
Validation loss decreased (0.3502 --> 0.3501).  Saving model state dict ...
Epoch: 3 cost time: 0.4478147029876709
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3501317 Best vali loss: 0.3501317

best validation loss 0.35013166546587393

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.003719886358, 'e_layers': 1, 'learning_rate': 0.0002150369961, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8050244
	speed: 0.0095s/iter; left time: 8.8518s
Updating learning rate to 0.0002068526377647497
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 0.764979362487793
Epoch: 1, Steps: 129 | Train Loss: 0.8050244 Vali Loss: 0.3717158 Best vali loss: 0.3717158
	iters: 100, epoch: 2 | loss: 0.7214156
	speed: 0.0060s/iter; left time: 4.8049s
Updating learning rate to 0.0001835455571241476
Validation loss decreased (0.3717 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 0.4521791934967041
Epoch: 2, Steps: 129 | Train Loss: 0.7214156 Vali Loss: 0.3659322 Best vali loss: 0.3659322
	iters: 100, epoch: 3 | loss: 0.5660179
	speed: 0.0058s/iter; left time: 3.8817s
Updating learning rate to 0.00014866404592651323
Epoch: 3 cost time: 0.41565537452697754
Epoch: 3, Steps: 129 | Train Loss: 0.5660179 Vali Loss: 0.3670241 Best vali loss: 0.3659322

best validation loss 0.36593215084965897

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 2, 'learning_rate': 0.0007075269978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8440874725e-05
Epoch: 4 cost time: 0.7827529907226562
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3651395 Best vali loss: 0.3501317
Updating learning rate to 4.42204373625e-05
Epoch: 5 cost time: 0.44861865043640137
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3507780 Best vali loss: 0.3501317
Updating learning rate to 2.211021868125e-05
Validation loss decreased (0.3501 --> 0.3486).  Saving model state dict ...
Epoch: 6 cost time: 0.4538252353668213
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3486234 Best vali loss: 0.3486234
Updating learning rate to 1.1055109340625e-05
Validation loss decreased (0.3486 --> 0.3471).  Saving model state dict ...
Epoch: 7 cost time: 0.45220351219177246
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3470651 Best vali loss: 0.3470651
Updating learning rate to 5.5275546703125e-06
Validation loss decreased (0.3471 --> 0.3468).  Saving model state dict ...
Epoch: 8 cost time: 0.4515564441680908
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3468422 Best vali loss: 0.3468422

best validation loss 0.3468422395541298

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0016834075844, 'e_layers': 3, 'learning_rate': 0.0003029659497, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3831590
	speed: 0.0106s/iter; left time: 20.8201s
	iters: 200, epoch: 1 | loss: 0.4597377
	speed: 0.0045s/iter; left time: 8.3052s
Updating learning rate to 0.000291434994837837
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.4994819164276123
Epoch: 1, Steps: 257 | Train Loss: 0.4214484 Vali Loss: 0.3689838 Best vali loss: 0.3689838
	iters: 100, epoch: 2 | loss: 0.8710371
	speed: 0.0098s/iter; left time: 16.6900s
	iters: 200, epoch: 2 | loss: 0.3537869
	speed: 0.0045s/iter; left time: 7.2686s
Updating learning rate to 0.0002585976136007462
Validation loss decreased (0.3690 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 1.1930294036865234
Epoch: 2, Steps: 257 | Train Loss: 0.6124120 Vali Loss: 0.3662703 Best vali loss: 0.3662703
	iters: 100, epoch: 3 | loss: 0.5656899
	speed: 0.0094s/iter; left time: 13.5375s
	iters: 200, epoch: 3 | loss: 0.6017236
	speed: 0.0047s/iter; left time: 6.3248s
Updating learning rate to 0.00020945299961047258
Epoch: 3 cost time: 1.2224206924438477
Epoch: 3, Steps: 257 | Train Loss: 0.5837067 Vali Loss: 0.3736110 Best vali loss: 0.3662703
	iters: 100, epoch: 4 | loss: 0.5301238
	speed: 0.0093s/iter; left time: 11.0625s
	iters: 200, epoch: 4 | loss: 0.3887854
	speed: 0.0042s/iter; left time: 4.6110s
Updating learning rate to 0.00015148297485
Validation loss decreased (0.3663 --> 0.3640).  Saving model state dict ...
Epoch: 4 cost time: 1.1234087944030762
Epoch: 4, Steps: 257 | Train Loss: 0.4594546 Vali Loss: 0.3640203 Best vali loss: 0.3640203
	iters: 100, epoch: 5 | loss: 0.3351997
	speed: 0.0096s/iter; left time: 8.9510s
	iters: 200, epoch: 5 | loss: 0.4117647
	speed: 0.0047s/iter; left time: 3.9271s
Updating learning rate to 9.351295008952743e-05
Epoch: 5 cost time: 1.2566149234771729
Epoch: 5, Steps: 257 | Train Loss: 0.3734822 Vali Loss: 0.3790777 Best vali loss: 0.3640203
	iters: 100, epoch: 6 | loss: 0.4510890
	speed: 0.0100s/iter; left time: 6.7178s
	iters: 200, epoch: 6 | loss: 0.4189947
	speed: 0.0045s/iter; left time: 2.5824s
Updating learning rate to 4.4368336099253774e-05
Epoch: 6 cost time: 1.2023077011108398
Epoch: 6, Steps: 257 | Train Loss: 0.4350419 Vali Loss: 0.3710656 Best vali loss: 0.3640203
	iters: 100, epoch: 7 | loss: 0.6281921
	speed: 0.0096s/iter; left time: 3.9830s
	iters: 200, epoch: 7 | loss: 0.5586934
	speed: 0.0045s/iter; left time: 1.4154s
Updating learning rate to 1.1530954862162993e-05
Epoch: 7 cost time: 1.2191741466522217
Epoch: 7, Steps: 257 | Train Loss: 0.5934428 Vali Loss: 0.3801069 Best vali loss: 0.3640203
	iters: 100, epoch: 8 | loss: 0.5065883
	speed: 0.0097s/iter; left time: 1.5379s
	iters: 200, epoch: 8 | loss: 0.9439324
	speed: 0.0044s/iter; left time: 0.2581s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2068188190460205
Epoch: 8, Steps: 257 | Train Loss: 0.7252603 Vali Loss: 0.3839902 Best vali loss: 0.3640203

best validation loss 0.364020259897929

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022142521798, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.1236519813537598
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3670066 Best vali loss: 0.3670066
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3670 --> 0.3655).  Saving model state dict ...
Epoch: 2 cost time: 0.8018553256988525
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3655405 Best vali loss: 0.3655405
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3655 --> 0.3559).  Saving model state dict ...
Epoch: 3 cost time: 0.7981114387512207
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3558663 Best vali loss: 0.3558663
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3559 --> 0.3506).  Saving model state dict ...
Epoch: 4 cost time: 0.7977001667022705
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3505993 Best vali loss: 0.3505993
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3506 --> 0.3435).  Saving model state dict ...
Epoch: 5 cost time: 0.796562671661377
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3435445 Best vali loss: 0.3435445
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.7942171096801758
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3455033 Best vali loss: 0.3435445
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7923135757446289
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3441227 Best vali loss: 0.3435445
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.792008638381958
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3446255 Best vali loss: 0.3435445

best validation loss 0.3435444598347827

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020756278453, 'e_layers': 1, 'learning_rate': 0.0025301114005, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0025301114005
Validation loss decreased (inf --> 0.3820).  Saving model state dict ...
Epoch: 1 cost time: 0.6303563117980957
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3820310 Best vali loss: 0.3820310
Updating learning rate to 0.00126505570025
Epoch: 2 cost time: 0.3135368824005127
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4226371 Best vali loss: 0.3820310
Updating learning rate to 0.000632527850125
Validation loss decreased (0.3820 --> 0.3795).  Saving model state dict ...
Epoch: 3 cost time: 0.33420300483703613
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3795053 Best vali loss: 0.3795053

best validation loss 0.379505320721853

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0012530229642, 'e_layers': 1, 'learning_rate': 0.0026233768084, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4359480
	speed: 0.0087s/iter; left time: 70.8710s
	iters: 200, epoch: 1 | loss: 0.3319449
	speed: 0.0024s/iter; left time: 19.1029s
	iters: 300, epoch: 1 | loss: 0.2929443
	speed: 0.0024s/iter; left time: 18.8399s
	iters: 400, epoch: 1 | loss: 0.3678708
	speed: 0.0024s/iter; left time: 18.6125s
	iters: 500, epoch: 1 | loss: 0.4079532
	speed: 0.0024s/iter; left time: 18.5110s
	iters: 600, epoch: 1 | loss: 0.7190592
	speed: 0.0024s/iter; left time: 18.4216s
	iters: 700, epoch: 1 | loss: 0.5208480
	speed: 0.0024s/iter; left time: 18.3222s
	iters: 800, epoch: 1 | loss: 0.4310250
	speed: 0.0024s/iter; left time: 18.0185s
	iters: 900, epoch: 1 | loss: 0.4120361
	speed: 0.0024s/iter; left time: 17.7901s
	iters: 1000, epoch: 1 | loss: 0.5538735
	speed: 0.0025s/iter; left time: 17.7290s
Updating learning rate to 0.0026233768084
Validation loss decreased (inf --> 0.3950).  Saving model state dict ...
Epoch: 1 cost time: 2.8328311443328857
Epoch: 1, Steps: 1027 | Train Loss: 0.4473503 Vali Loss: 0.3950188 Best vali loss: 0.3950188
	iters: 100, epoch: 2 | loss: 0.6398897
	speed: 0.0078s/iter; left time: 55.0513s
	iters: 200, epoch: 2 | loss: 0.3063130
	speed: 0.0023s/iter; left time: 16.4091s
	iters: 300, epoch: 2 | loss: 0.3916941
	speed: 0.0024s/iter; left time: 16.2091s
	iters: 400, epoch: 2 | loss: 0.3871346
	speed: 0.0024s/iter; left time: 16.6306s
	iters: 500, epoch: 2 | loss: 0.4763744
	speed: 0.0025s/iter; left time: 16.6272s
	iters: 600, epoch: 2 | loss: 0.4623823
	speed: 0.0023s/iter; left time: 15.2460s
	iters: 700, epoch: 2 | loss: 0.4508463
	speed: 0.0023s/iter; left time: 15.2134s
	iters: 800, epoch: 2 | loss: 0.5442166
	speed: 0.0023s/iter; left time: 14.9220s
	iters: 900, epoch: 2 | loss: 0.2829047
	speed: 0.0023s/iter; left time: 14.7437s
	iters: 1000, epoch: 2 | loss: 0.2975543
	speed: 0.0023s/iter; left time: 14.4277s
Updating learning rate to 0.0013116884042
Validation loss decreased (0.3950 --> 0.3856).  Saving model state dict ...
Epoch: 2 cost time: 2.4680511951446533
Epoch: 2, Steps: 1027 | Train Loss: 0.4239310 Vali Loss: 0.3856478 Best vali loss: 0.3856478
	iters: 100, epoch: 3 | loss: 0.6050914
	speed: 0.0077s/iter; left time: 46.7027s
	iters: 200, epoch: 3 | loss: 2.4353905
	speed: 0.0022s/iter; left time: 12.9466s
	iters: 300, epoch: 3 | loss: 0.5928898
	speed: 0.0022s/iter; left time: 12.9080s
	iters: 400, epoch: 3 | loss: 0.2644716
	speed: 0.0023s/iter; left time: 13.0586s
	iters: 500, epoch: 3 | loss: 0.5069829
	speed: 0.0023s/iter; left time: 12.8463s
	iters: 600, epoch: 3 | loss: 0.5874402
	speed: 0.0022s/iter; left time: 12.3259s
	iters: 700, epoch: 3 | loss: 1.2474947
	speed: 0.0022s/iter; left time: 11.8972s
	iters: 800, epoch: 3 | loss: 0.2569132
	speed: 0.0022s/iter; left time: 11.7886s
	iters: 900, epoch: 3 | loss: 0.2301537
	speed: 0.0024s/iter; left time: 12.5676s
	iters: 1000, epoch: 3 | loss: 0.4338667
	speed: 0.0025s/iter; left time: 12.7555s
Updating learning rate to 0.0006558442021
Epoch: 3 cost time: 2.361811399459839
Epoch: 3, Steps: 1027 | Train Loss: 0.7160695 Vali Loss: 0.4062313 Best vali loss: 0.3856478

best validation loss 0.3856478418079013

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022142732725, 'e_layers': 1, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 0.6434509754180908
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3742193 Best vali loss: 0.3742193
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3742 --> 0.3726).  Saving model state dict ...
Epoch: 2 cost time: 0.336193323135376
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3725543 Best vali loss: 0.3725543
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 0.31972432136535645
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3744594 Best vali loss: 0.3725543

best validation loss 0.3725543265258399

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022142732725, 'e_layers': 1, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.84362359875e-05
Epoch: 4 cost time: 0.6443698406219482
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3914895 Best vali loss: 0.3725543
Updating learning rate to 4.421811799375e-05
Epoch: 5 cost time: 0.32326197624206543
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3853912 Best vali loss: 0.3725543
Updating learning rate to 2.2109058996875e-05
Epoch: 6 cost time: 0.3016335964202881
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3874636 Best vali loss: 0.3725543
Updating learning rate to 1.10545294984375e-05
Epoch: 7 cost time: 0.31740736961364746
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3886755 Best vali loss: 0.3725543
Updating learning rate to 5.52726474921875e-06
Epoch: 8 cost time: 0.31308960914611816
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3900651 Best vali loss: 0.3725543

best validation loss 0.3725543265258399

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 3, 'learning_rate': 0.0007073012038, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007073012038
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 0.9350442886352539
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732961 Best vali loss: 0.3732961
Updating learning rate to 0.0003536506019
Validation loss decreased (0.3733 --> 0.3634).  Saving model state dict ...
Epoch: 2 cost time: 0.6136627197265625
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3634383 Best vali loss: 0.3634383
Updating learning rate to 0.00017682530095
Validation loss decreased (0.3634 --> 0.3589).  Saving model state dict ...
Epoch: 3 cost time: 0.6132686138153076
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3589425 Best vali loss: 0.3589425
Updating learning rate to 8.8412650475e-05
Epoch: 4 cost time: 0.6083674430847168
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3629958 Best vali loss: 0.3589425
Updating learning rate to 4.42063252375e-05
Validation loss decreased (0.3589 --> 0.3513).  Saving model state dict ...
Epoch: 5 cost time: 0.6073706150054932
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3513203 Best vali loss: 0.3513203
Updating learning rate to 2.210316261875e-05
Validation loss decreased (0.3513 --> 0.3489).  Saving model state dict ...
Epoch: 6 cost time: 0.6128387451171875
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3488776 Best vali loss: 0.3488776
Updating learning rate to 1.1051581309375e-05
Epoch: 7 cost time: 0.6146867275238037
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3488876 Best vali loss: 0.3488776
Updating learning rate to 5.5257906546875e-06
Validation loss decreased (0.3489 --> 0.3488).  Saving model state dict ...
Epoch: 8 cost time: 0.608320951461792
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3487782 Best vali loss: 0.3487782

best validation loss 0.34877817805249

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022144720903, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 0.7741997241973877
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706508 Best vali loss: 0.3706508
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3707 --> 0.3529).  Saving model state dict ...
Epoch: 2 cost time: 0.4450838565826416
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3528623 Best vali loss: 0.3528623
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.44747185707092285
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3749436 Best vali loss: 0.3528623
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3529 --> 0.3486).  Saving model state dict ...
Epoch: 4 cost time: 0.4417304992675781
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3486038 Best vali loss: 0.3486038
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3486 --> 0.3452).  Saving model state dict ...
Epoch: 5 cost time: 0.44793200492858887
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3451998 Best vali loss: 0.3451998
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3452 --> 0.3439).  Saving model state dict ...
Epoch: 6 cost time: 0.4502236843109131
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3438702 Best vali loss: 0.3438702
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3439 --> 0.3412).  Saving model state dict ...
Epoch: 7 cost time: 0.44734907150268555
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3411726 Best vali loss: 0.3411726
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.4464085102081299
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3429764 Best vali loss: 0.3411726

best validation loss 0.34117262841207807

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006720215633, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006720215633
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 0.7771117687225342
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3700799 Best vali loss: 0.3700799
Updating learning rate to 0.00033601078165
Validation loss decreased (0.3701 --> 0.3536).  Saving model state dict ...
Epoch: 2 cost time: 0.4820089340209961
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3535944 Best vali loss: 0.3535944
Updating learning rate to 0.000168005390825
Validation loss decreased (0.3536 --> 0.3493).  Saving model state dict ...
Epoch: 3 cost time: 0.49610280990600586
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3493448 Best vali loss: 0.3493448

best validation loss 0.34934479423262516

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022937706348, 'e_layers': 4, 'learning_rate': 0.0006997653845, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006731321503997204
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.1246421337127686
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706499 Best vali loss: 0.3706499
Updating learning rate to 0.0005972871165597809
Epoch: 2 cost time: 0.808330774307251
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3795623 Best vali loss: 0.3706499
Updating learning rate to 0.0004837770018453684
Epoch: 3 cost time: 0.8240885734558105
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3952016 Best vali loss: 0.3706499

best validation loss 0.37064989726763575

[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002299855692, 'e_layers': 4, 'learning_rate': 0.0006950813258, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006686263680687147
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 1.1021645069122314
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701807 Best vali loss: 0.3701807
Updating learning rate to 0.000593289022374658
Validation loss decreased (0.3702 --> 0.3589).  Saving model state dict ...
Epoch: 2 cost time: 0.8294081687927246
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3588785 Best vali loss: 0.3588785
Updating learning rate to 0.0004805387166650106
Epoch: 3 cost time: 0.7861721515655518
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3801610 Best vali loss: 0.3588785

best validation loss 0.35887849994867393

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006720215633, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.40026954125e-05
Epoch: 4 cost time: 0.7915036678314209
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3568786 Best vali loss: 0.3493448
Updating learning rate to 4.200134770625e-05
Epoch: 5 cost time: 0.5000796318054199
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3571341 Best vali loss: 0.3493448
Updating learning rate to 2.1000673853125e-05
Epoch: 6 cost time: 0.48532867431640625
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3616305 Best vali loss: 0.3493448
Updating learning rate to 1.05003369265625e-05
Epoch: 7 cost time: 0.487454891204834
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3632822 Best vali loss: 0.3493448
Updating learning rate to 5.25016846328125e-06
Epoch: 8 cost time: 0.5048692226409912
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3648991 Best vali loss: 0.3493448

best validation loss 0.34934479423262516

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023003784706, 'e_layers': 4, 'learning_rate': 0.0007068997804, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006799950095241416
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.087982416152954
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715757 Best vali loss: 0.3715757
Updating learning rate to 0.0006033767043700606
Validation loss decreased (0.3716 --> 0.3655).  Saving model state dict ...
Epoch: 2 cost time: 0.7828865051269531
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3654930 Best vali loss: 0.3654930
Updating learning rate to 0.0004887093073508001
Validation loss decreased (0.3655 --> 0.3618).  Saving model state dict ...
Epoch: 3 cost time: 0.7855281829833984
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3617957 Best vali loss: 0.3617957
Updating learning rate to 0.0003534498902
Validation loss decreased (0.3618 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 0.7840704917907715
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3552817 Best vali loss: 0.3552817
Updating learning rate to 0.0002181904730491999
Validation loss decreased (0.3553 --> 0.3488).  Saving model state dict ...
Epoch: 5 cost time: 0.7849335670471191
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3487930 Best vali loss: 0.3487930
Updating learning rate to 0.00010352307602993937
Epoch: 6 cost time: 0.7864944934844971
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3506948 Best vali loss: 0.3487930
Updating learning rate to 2.6904770875858375e-05
Epoch: 7 cost time: 0.7768495082855225
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3506591 Best vali loss: 0.3487930
Updating learning rate to 0.0
Epoch: 8 cost time: 0.778388261795044
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3530799 Best vali loss: 0.3487930

best validation loss 0.3487930251947789

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0015897168323, 'e_layers': 3, 'learning_rate': 5.50967316e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.299973711675392e-05
Validation loss decreased (inf --> 0.3881).  Saving model state dict ...
Epoch: 1 cost time: 0.8145833015441895
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3881005 Best vali loss: 0.3881005
Updating learning rate to 4.702800206778757e-05
Validation loss decreased (0.3881 --> 0.3707).  Saving model state dict ...
Epoch: 2 cost time: 0.5004549026489258
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3707130 Best vali loss: 0.3707130
Updating learning rate to 3.809066898039305e-05
Validation loss decreased (0.3707 --> 0.3650).  Saving model state dict ...
Epoch: 3 cost time: 0.5020864009857178
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3650454 Best vali loss: 0.3650454
Updating learning rate to 2.75483658e-05
Validation loss decreased (0.3650 --> 0.3644).  Saving model state dict ...
Epoch: 4 cost time: 0.4981403350830078
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3644437 Best vali loss: 0.3644437
Updating learning rate to 1.7006062619606948e-05
Validation loss decreased (0.3644 --> 0.3641).  Saving model state dict ...
Epoch: 5 cost time: 0.5047705173492432
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3640852 Best vali loss: 0.3640852
Updating learning rate to 8.068729532212433e-06
Validation loss decreased (0.3641 --> 0.3631).  Saving model state dict ...
Epoch: 6 cost time: 0.503448486328125
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3631412 Best vali loss: 0.3631412
Updating learning rate to 2.0969944832460804e-06
Epoch: 7 cost time: 0.4972250461578369
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3631969 Best vali loss: 0.3631412
Updating learning rate to 0.0
Epoch: 8 cost time: 0.49455738067626953
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3633318 Best vali loss: 0.3631412

best validation loss 0.36314122507052243

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0011703029418, 'e_layers': 3, 'learning_rate': 5.15283341e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.9567153659696697e-05
Validation loss decreased (inf --> 0.3975).  Saving model state dict ...
Epoch: 1 cost time: 0.7425289154052734
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3975332 Best vali loss: 0.3975332
Updating learning rate to 4.3982184282678005e-05
Validation loss decreased (0.3975 --> 0.3781).  Saving model state dict ...
Epoch: 2 cost time: 0.39705467224121094
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3781217 Best vali loss: 0.3781217
Updating learning rate to 3.562368692872155e-05
Validation loss decreased (0.3781 --> 0.3703).  Saving model state dict ...
Epoch: 3 cost time: 0.4089350700378418
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3702813 Best vali loss: 0.3702813

best validation loss 0.37028128942712585

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014922670526, 'e_layers': 3, 'learning_rate': 5.28986651e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.088532954152956e-05
Validation loss decreased (inf --> 0.3881).  Saving model state dict ...
Epoch: 1 cost time: 0.874492883682251
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3880636 Best vali loss: 0.3880636
Updating learning rate to 4.5151834953963074e-05
Validation loss decreased (0.3881 --> 0.3710).  Saving model state dict ...
Epoch: 2 cost time: 0.5610373020172119
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3709811 Best vali loss: 0.3709811
Updating learning rate to 3.6571053913999695e-05
Validation loss decreased (0.3710 --> 0.3652).  Saving model state dict ...
Epoch: 3 cost time: 0.5562829971313477
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3652106 Best vali loss: 0.3652106

best validation loss 0.3652105765164718

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019699733901, 'e_layers': 4, 'learning_rate': 0.0043335913483, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7798883
	speed: 0.0120s/iter; left time: 11.1553s
Updating learning rate to 0.0043335913483
Validation loss decreased (inf --> 0.4136).  Saving model state dict ...
Epoch: 1 cost time: 1.1152551174163818
Epoch: 1, Steps: 129 | Train Loss: 0.7798883 Vali Loss: 0.4136087 Best vali loss: 0.4136087
	iters: 100, epoch: 2 | loss: 0.6724715
	speed: 0.0098s/iter; left time: 7.8501s
Updating learning rate to 0.00216679567415
Epoch: 2 cost time: 0.8143613338470459
Epoch: 2, Steps: 129 | Train Loss: 0.6724715 Vali Loss: 0.4142053 Best vali loss: 0.4136087
	iters: 100, epoch: 3 | loss: 0.6696467
	speed: 0.0089s/iter; left time: 6.0279s
Updating learning rate to 0.001083397837075
Validation loss decreased (0.4136 --> 0.4030).  Saving model state dict ...
Epoch: 3 cost time: 0.7138674259185791
Epoch: 3, Steps: 129 | Train Loss: 0.6696467 Vali Loss: 0.4030025 Best vali loss: 0.4030025

best validation loss 0.4030025017519128

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014922670526, 'e_layers': 3, 'learning_rate': 5.28986651e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.644933255e-05
Validation loss decreased (0.3652 --> 0.3650).  Saving model state dict ...
Epoch: 4 cost time: 0.8642392158508301
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3650028 Best vali loss: 0.3650028
Updating learning rate to 1.632761118600031e-05
Validation loss decreased (0.3650 --> 0.3636).  Saving model state dict ...
Epoch: 5 cost time: 0.5585978031158447
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3636141 Best vali loss: 0.3636141
Updating learning rate to 7.746830146036922e-06
Validation loss decreased (0.3636 --> 0.3629).  Saving model state dict ...
Epoch: 6 cost time: 0.5580503940582275
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3629250 Best vali loss: 0.3629250
Updating learning rate to 2.0133355584704403e-06
Epoch: 7 cost time: 0.5628767013549805
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3636040 Best vali loss: 0.3629250
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5550901889801025
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3635067 Best vali loss: 0.3629250

best validation loss 0.36292503731424075

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0026086121199, 'e_layers': 1, 'learning_rate': 0.0011143072571, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5654635
	speed: 0.0086s/iter; left time: 70.0521s
	iters: 200, epoch: 1 | loss: 0.5880598
	speed: 0.0024s/iter; left time: 19.4973s
	iters: 300, epoch: 1 | loss: 0.4879386
	speed: 0.0024s/iter; left time: 18.9738s
	iters: 400, epoch: 1 | loss: 0.9193121
	speed: 0.0024s/iter; left time: 18.7993s
	iters: 500, epoch: 1 | loss: 0.9865723
	speed: 0.0024s/iter; left time: 18.3535s
	iters: 600, epoch: 1 | loss: 0.4662974
	speed: 0.0024s/iter; left time: 18.2649s
	iters: 700, epoch: 1 | loss: 0.2368581
	speed: 0.0024s/iter; left time: 18.1656s
	iters: 800, epoch: 1 | loss: 0.6204592
	speed: 0.0024s/iter; left time: 17.8957s
	iters: 900, epoch: 1 | loss: 1.1551441
	speed: 0.0024s/iter; left time: 17.8866s
	iters: 1000, epoch: 1 | loss: 0.3968241
	speed: 0.0024s/iter; left time: 17.1698s
Updating learning rate to 0.0011143072571
Validation loss decreased (inf --> 0.3784).  Saving model state dict ...
Epoch: 1 cost time: 2.8193140029907227
Epoch: 1, Steps: 1027 | Train Loss: 0.7422929 Vali Loss: 0.3784162 Best vali loss: 0.3784162
	iters: 100, epoch: 2 | loss: 0.3389511
	speed: 0.0074s/iter; left time: 52.2520s
	iters: 200, epoch: 2 | loss: 0.7995818
	speed: 0.0020s/iter; left time: 14.2549s
	iters: 300, epoch: 2 | loss: 0.3922717
	speed: 0.0020s/iter; left time: 13.9091s
	iters: 400, epoch: 2 | loss: 1.7851347
	speed: 0.0020s/iter; left time: 13.8882s
	iters: 500, epoch: 2 | loss: 0.3988529
	speed: 0.0020s/iter; left time: 13.6405s
	iters: 600, epoch: 2 | loss: 0.4389639
	speed: 0.0022s/iter; left time: 14.3435s
	iters: 700, epoch: 2 | loss: 0.3130911
	speed: 0.0022s/iter; left time: 14.1191s
	iters: 800, epoch: 2 | loss: 1.2494379
	speed: 0.0021s/iter; left time: 13.6773s
	iters: 900, epoch: 2 | loss: 0.4387943
	speed: 0.0023s/iter; left time: 14.2945s
	iters: 1000, epoch: 2 | loss: 0.3483706
	speed: 0.0023s/iter; left time: 14.2650s
Updating learning rate to 0.00055715362855
Epoch: 2 cost time: 2.223679542541504
Epoch: 2, Steps: 1027 | Train Loss: 0.6503450 Vali Loss: 0.3788781 Best vali loss: 0.3784162
	iters: 100, epoch: 3 | loss: 0.3222615
	speed: 0.0070s/iter; left time: 42.7239s
	iters: 200, epoch: 3 | loss: 0.2087706
	speed: 0.0020s/iter; left time: 12.1019s
	iters: 300, epoch: 3 | loss: 0.4174863
	speed: 0.0020s/iter; left time: 11.9044s
	iters: 400, epoch: 3 | loss: 0.3005775
	speed: 0.0020s/iter; left time: 11.6981s
	iters: 500, epoch: 3 | loss: 0.3747022
	speed: 0.0020s/iter; left time: 11.4418s
	iters: 600, epoch: 3 | loss: 0.8852755
	speed: 0.0020s/iter; left time: 11.2902s
	iters: 700, epoch: 3 | loss: 1.0791960
	speed: 0.0020s/iter; left time: 11.1975s
	iters: 800, epoch: 3 | loss: 0.2669165
	speed: 0.0020s/iter; left time: 10.9189s
	iters: 900, epoch: 3 | loss: 0.2542581
	speed: 0.0021s/iter; left time: 10.8184s
	iters: 1000, epoch: 3 | loss: 0.2653687
	speed: 0.0020s/iter; left time: 10.5627s
Updating learning rate to 0.000278576814275
Epoch: 3 cost time: 2.134014129638672
Epoch: 3, Steps: 1027 | Train Loss: 0.4374813 Vali Loss: 0.3868263 Best vali loss: 0.3784162
	iters: 100, epoch: 4 | loss: 0.9022430
	speed: 0.0072s/iter; left time: 36.1112s
	iters: 200, epoch: 4 | loss: 0.5176631
	speed: 0.0021s/iter; left time: 10.6025s
	iters: 300, epoch: 4 | loss: 0.2230793
	speed: 0.0022s/iter; left time: 10.4523s
	iters: 400, epoch: 4 | loss: 0.9196513
	speed: 0.0022s/iter; left time: 10.1915s
	iters: 500, epoch: 4 | loss: 0.2549765
	speed: 0.0021s/iter; left time: 9.9649s
	iters: 600, epoch: 4 | loss: 0.2266406
	speed: 0.0023s/iter; left time: 10.3944s
	iters: 700, epoch: 4 | loss: 0.4175501
	speed: 0.0025s/iter; left time: 10.8902s
	iters: 800, epoch: 4 | loss: 0.4348594
	speed: 0.0025s/iter; left time: 10.6834s
	iters: 900, epoch: 4 | loss: 0.2740748
	speed: 0.0025s/iter; left time: 10.5669s
	iters: 1000, epoch: 4 | loss: 0.2637077
	speed: 0.0024s/iter; left time: 10.0535s
Updating learning rate to 0.0001392884071375
Epoch: 4 cost time: 2.3968021869659424
Epoch: 4, Steps: 1027 | Train Loss: 0.4434446 Vali Loss: 0.3956395 Best vali loss: 0.3784162
	iters: 100, epoch: 5 | loss: 0.3538332
	speed: 0.0075s/iter; left time: 30.1607s
	iters: 200, epoch: 5 | loss: 0.4663630
	speed: 0.0023s/iter; left time: 8.8074s
	iters: 300, epoch: 5 | loss: 0.3821838
	speed: 0.0023s/iter; left time: 8.7579s
	iters: 400, epoch: 5 | loss: 0.6498980
	speed: 0.0024s/iter; left time: 9.0124s
	iters: 500, epoch: 5 | loss: 0.2046661
	speed: 0.0024s/iter; left time: 8.7505s
	iters: 600, epoch: 5 | loss: 0.7717109
	speed: 0.0024s/iter; left time: 8.4541s
	iters: 700, epoch: 5 | loss: 0.3418173
	speed: 0.0024s/iter; left time: 8.2195s
	iters: 800, epoch: 5 | loss: 0.4643148
	speed: 0.0024s/iter; left time: 8.0188s
	iters: 900, epoch: 5 | loss: 0.5213035
	speed: 0.0024s/iter; left time: 7.8496s
	iters: 1000, epoch: 5 | loss: 0.3300414
	speed: 0.0023s/iter; left time: 7.0896s
Updating learning rate to 6.964420356875e-05
Epoch: 5 cost time: 2.476398229598999
Epoch: 5, Steps: 1027 | Train Loss: 0.4486132 Vali Loss: 0.3958940 Best vali loss: 0.3784162
	iters: 100, epoch: 6 | loss: 0.8816656
	speed: 0.0075s/iter; left time: 22.4964s
	iters: 200, epoch: 6 | loss: 0.7027810
	speed: 0.0023s/iter; left time: 6.5444s
	iters: 300, epoch: 6 | loss: 0.3569287
	speed: 0.0023s/iter; left time: 6.5377s
	iters: 400, epoch: 6 | loss: 1.1494626
	speed: 0.0023s/iter; left time: 6.2250s
	iters: 500, epoch: 6 | loss: 0.5628426
	speed: 0.0023s/iter; left time: 6.0129s
	iters: 600, epoch: 6 | loss: 1.3426937
	speed: 0.0023s/iter; left time: 5.7950s
	iters: 700, epoch: 6 | loss: 0.5566015
	speed: 0.0023s/iter; left time: 5.5365s
	iters: 800, epoch: 6 | loss: 0.3309708
	speed: 0.0023s/iter; left time: 5.2541s
	iters: 900, epoch: 6 | loss: 0.4197542
	speed: 0.0023s/iter; left time: 4.9992s
	iters: 1000, epoch: 6 | loss: 0.4740081
	speed: 0.0023s/iter; left time: 4.7948s
Updating learning rate to 3.4822101784375e-05
Epoch: 6 cost time: 2.4173526763916016
Epoch: 6, Steps: 1027 | Train Loss: 0.6777709 Vali Loss: 0.3980994 Best vali loss: 0.3784162
	iters: 100, epoch: 7 | loss: 0.4148370
	speed: 0.0074s/iter; left time: 14.3738s
	iters: 200, epoch: 7 | loss: 0.5643141
	speed: 0.0021s/iter; left time: 3.8068s
	iters: 300, epoch: 7 | loss: 0.5035598
	speed: 0.0020s/iter; left time: 3.5290s
	iters: 400, epoch: 7 | loss: 0.3339980
	speed: 0.0020s/iter; left time: 3.3248s
	iters: 500, epoch: 7 | loss: 0.4251890
	speed: 0.0020s/iter; left time: 3.1106s
	iters: 600, epoch: 7 | loss: 0.5390350
	speed: 0.0020s/iter; left time: 2.9089s
	iters: 700, epoch: 7 | loss: 0.3394062
	speed: 0.0020s/iter; left time: 2.7120s
	iters: 800, epoch: 7 | loss: 0.5171663
	speed: 0.0020s/iter; left time: 2.5084s
	iters: 900, epoch: 7 | loss: 0.3078658
	speed: 0.0020s/iter; left time: 2.3228s
	iters: 1000, epoch: 7 | loss: 0.8102515
	speed: 0.0020s/iter; left time: 2.1509s
Updating learning rate to 1.74110508921875e-05
Epoch: 7 cost time: 2.1251442432403564
Epoch: 7, Steps: 1027 | Train Loss: 0.4755623 Vali Loss: 0.3987353 Best vali loss: 0.3784162
	iters: 100, epoch: 8 | loss: 0.4083156
	speed: 0.0073s/iter; left time: 6.8105s
	iters: 200, epoch: 8 | loss: 0.2630295
	speed: 0.0024s/iter; left time: 1.9919s
	iters: 300, epoch: 8 | loss: 0.9764014
	speed: 0.0024s/iter; left time: 1.7753s
	iters: 400, epoch: 8 | loss: 0.3116991
	speed: 0.0024s/iter; left time: 1.5330s
	iters: 500, epoch: 8 | loss: 0.2798691
	speed: 0.0025s/iter; left time: 1.2993s
	iters: 600, epoch: 8 | loss: 0.8830938
	speed: 0.0024s/iter; left time: 1.0213s
	iters: 700, epoch: 8 | loss: 0.3999966
	speed: 0.0024s/iter; left time: 0.7906s
	iters: 800, epoch: 8 | loss: 0.2058737
	speed: 0.0024s/iter; left time: 0.5543s
	iters: 900, epoch: 8 | loss: 0.2346444
	speed: 0.0023s/iter; left time: 0.2881s
	iters: 1000, epoch: 8 | loss: 0.5830995
	speed: 0.0021s/iter; left time: 0.0586s
Updating learning rate to 8.70552544609375e-06
Epoch: 8 cost time: 2.4486401081085205
Epoch: 8, Steps: 1027 | Train Loss: 0.4546023 Vali Loss: 0.3995576 Best vali loss: 0.3784162

best validation loss 0.37841624145072195

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022142521798, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.0969130992889404
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711277 Best vali loss: 0.3711277
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.7814943790435791
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3878964 Best vali loss: 0.3711277
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3711 --> 0.3605).  Saving model state dict ...
Epoch: 3 cost time: 0.7810072898864746
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3605097 Best vali loss: 0.3605097
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3605 --> 0.3497).  Saving model state dict ...
Epoch: 4 cost time: 0.7793493270874023
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3496586 Best vali loss: 0.3496586
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7806975841522217
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3513017 Best vali loss: 0.3496586
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3497 --> 0.3471).  Saving model state dict ...
Epoch: 6 cost time: 0.7821931838989258
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3471271 Best vali loss: 0.3471271
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7836706638336182
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3483421 Best vali loss: 0.3471271
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.782325267791748
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3483437 Best vali loss: 0.3471271

best validation loss 0.3471270823525539

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0082451621793, 'e_layers': 2, 'learning_rate': 0.000580209245, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0620532
	speed: 0.0097s/iter; left time: 38.8373s
	iters: 200, epoch: 1 | loss: 0.3377787
	speed: 0.0034s/iter; left time: 13.1686s
	iters: 300, epoch: 1 | loss: 0.3365055
	speed: 0.0031s/iter; left time: 11.7822s
	iters: 400, epoch: 1 | loss: 0.9346774
	speed: 0.0032s/iter; left time: 12.0588s
	iters: 500, epoch: 1 | loss: 0.4087121
	speed: 0.0033s/iter; left time: 11.9255s
Updating learning rate to 0.0005581263455146634
Validation loss decreased (inf --> 0.3846).  Saving model state dict ...
Epoch: 1 cost time: 2.0429418087005615
Epoch: 1, Steps: 514 | Train Loss: 0.6159454 Vali Loss: 0.3845760 Best vali loss: 0.3845760
	iters: 100, epoch: 2 | loss: 0.5269861
	speed: 0.0076s/iter; left time: 26.5111s
	iters: 200, epoch: 2 | loss: 0.6055862
	speed: 0.0035s/iter; left time: 11.8714s
	iters: 300, epoch: 2 | loss: 0.3936679
	speed: 0.0034s/iter; left time: 11.1520s
	iters: 400, epoch: 2 | loss: 0.4122313
	speed: 0.0032s/iter; left time: 10.3328s
	iters: 500, epoch: 2 | loss: 0.5535886
	speed: 0.0033s/iter; left time: 10.3813s
Updating learning rate to 0.0004952395683233135
Validation loss decreased (0.3846 --> 0.3706).  Saving model state dict ...
Epoch: 2 cost time: 1.7819130420684814
Epoch: 2, Steps: 514 | Train Loss: 0.4984120 Vali Loss: 0.3706439 Best vali loss: 0.3706439
	iters: 100, epoch: 3 | loss: 1.0696448
	speed: 0.0074s/iter; left time: 21.9456s
	iters: 200, epoch: 3 | loss: 0.3185090
	speed: 0.0033s/iter; left time: 9.4557s
	iters: 300, epoch: 3 | loss: 0.8384135
	speed: 0.0032s/iter; left time: 8.9052s
	iters: 400, epoch: 3 | loss: 1.0484450
	speed: 0.0031s/iter; left time: 8.3461s
	iters: 500, epoch: 3 | loss: 0.4287246
	speed: 0.0033s/iter; left time: 8.5283s
Updating learning rate to 0.0004011228551832787
Validation loss decreased (0.3706 --> 0.3534).  Saving model state dict ...
Epoch: 3 cost time: 1.6928975582122803
Epoch: 3, Steps: 514 | Train Loss: 0.7407474 Vali Loss: 0.3534364 Best vali loss: 0.3534364

best validation loss 0.35343639982648356

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0080808819861, 'e_layers': 2, 'learning_rate': 0.000475826968, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6522179
	speed: 0.0105s/iter; left time: 20.5959s
	iters: 200, epoch: 1 | loss: 1.1595742
	speed: 0.0042s/iter; left time: 7.7714s
Updating learning rate to 0.00045771688237605145
Validation loss decreased (inf --> 0.3753).  Saving model state dict ...
Epoch: 1 cost time: 1.44431471824646
Epoch: 1, Steps: 257 | Train Loss: 0.9058960 Vali Loss: 0.3752953 Best vali loss: 0.3752953
	iters: 100, epoch: 2 | loss: 0.3779095
	speed: 0.0095s/iter; left time: 16.1591s
	iters: 200, epoch: 2 | loss: 0.6804613
	speed: 0.0041s/iter; left time: 6.5512s
Updating learning rate to 0.0004061437218721171
Epoch: 2 cost time: 1.094146728515625
Epoch: 2, Steps: 257 | Train Loss: 0.5291854 Vali Loss: 0.3760395 Best vali loss: 0.3752953
	iters: 100, epoch: 3 | loss: 0.7186288
	speed: 0.0092s/iter; left time: 13.2322s
	iters: 200, epoch: 3 | loss: 0.5727838
	speed: 0.0040s/iter; left time: 5.3949s
Updating learning rate to 0.00032895903266305686
Epoch: 3 cost time: 1.0821998119354248
Epoch: 3, Steps: 257 | Train Loss: 0.6457063 Vali Loss: 0.3839214 Best vali loss: 0.3752953

best validation loss 0.37529525480476483

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.7614057064056396
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3707599 Best vali loss: 0.3707599
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3708 --> 0.3512).  Saving model state dict ...
Epoch: 2 cost time: 0.45380210876464844
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3511976 Best vali loss: 0.3511976
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.44617748260498047
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3593789 Best vali loss: 0.3511976

best validation loss 0.3511975872844516

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 0.7661306858062744
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4016478 Best vali loss: 0.3511976
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3512 --> 0.3463).  Saving model state dict ...
Epoch: 5 cost time: 0.44693827629089355
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3462966 Best vali loss: 0.3462966
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.44724106788635254
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3504298 Best vali loss: 0.3462966
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.4436054229736328
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3571664 Best vali loss: 0.3462966
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4395451545715332
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3522272 Best vali loss: 0.3462966

best validation loss 0.34629663061533555

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023018764281, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.7608730792999268
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709241 Best vali loss: 0.3709241
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3709 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 0.4398517608642578
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3683021 Best vali loss: 0.3683021
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3683 --> 0.3561).  Saving model state dict ...
Epoch: 3 cost time: 0.44992756843566895
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3561275 Best vali loss: 0.3561275
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3561 --> 0.3477).  Saving model state dict ...
Epoch: 4 cost time: 0.4478328227996826
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3476972 Best vali loss: 0.3476972
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3477 --> 0.3464).  Saving model state dict ...
Epoch: 5 cost time: 0.45047593116760254
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3464256 Best vali loss: 0.3464256
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.44760751724243164
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3522737 Best vali loss: 0.3464256
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.4430696964263916
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3504214 Best vali loss: 0.3464256
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4430556297302246
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3531321 Best vali loss: 0.3464256

best validation loss 0.34642560972680275

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0070553221679, 'e_layers': 4, 'learning_rate': 0.0002919328526, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7289364
	speed: 0.0117s/iter; left time: 22.9388s
	iters: 200, epoch: 1 | loss: 0.6740377
	speed: 0.0054s/iter; left time: 10.0882s
Updating learning rate to 0.0002808218199923872
Validation loss decreased (inf --> 0.3844).  Saving model state dict ...
Epoch: 1 cost time: 1.7389929294586182
Epoch: 1, Steps: 257 | Train Loss: 0.7014871 Vali Loss: 0.3844092 Best vali loss: 0.3844092
	iters: 100, epoch: 2 | loss: 0.6251329
	speed: 0.0109s/iter; left time: 18.4522s
	iters: 200, epoch: 2 | loss: 0.8407595
	speed: 0.0050s/iter; left time: 7.9725s
Updating learning rate to 0.0002491802761622964
Validation loss decreased (0.3844 --> 0.3748).  Saving model state dict ...
Epoch: 2 cost time: 1.3290820121765137
Epoch: 2, Steps: 257 | Train Loss: 0.7329462 Vali Loss: 0.3747862 Best vali loss: 0.3747862
	iters: 100, epoch: 3 | loss: 0.6121104
	speed: 0.0105s/iter; left time: 15.0979s
	iters: 200, epoch: 3 | loss: 0.4968313
	speed: 0.0050s/iter; left time: 6.6872s
Updating learning rate to 0.00020182535932654992
Validation loss decreased (0.3748 --> 0.3729).  Saving model state dict ...
Epoch: 3 cost time: 1.3166375160217285
Epoch: 3, Steps: 257 | Train Loss: 0.5544708 Vali Loss: 0.3728664 Best vali loss: 0.3728664
	iters: 100, epoch: 4 | loss: 0.6229382
	speed: 0.0111s/iter; left time: 13.1782s
	iters: 200, epoch: 4 | loss: 0.6122385
	speed: 0.0057s/iter; left time: 6.1531s
Updating learning rate to 0.0001459664263
Validation loss decreased (0.3729 --> 0.3704).  Saving model state dict ...
Epoch: 4 cost time: 1.4833745956420898
Epoch: 4, Steps: 257 | Train Loss: 0.6175883 Vali Loss: 0.3704446 Best vali loss: 0.3704446
	iters: 100, epoch: 5 | loss: 0.5911699
	speed: 0.0109s/iter; left time: 10.1035s
	iters: 200, epoch: 5 | loss: 0.6329742
	speed: 0.0052s/iter; left time: 4.3199s
Updating learning rate to 9.010749327345009e-05
Validation loss decreased (0.3704 --> 0.3683).  Saving model state dict ...
Epoch: 5 cost time: 1.375408411026001
Epoch: 5, Steps: 257 | Train Loss: 0.6120721 Vali Loss: 0.3683262 Best vali loss: 0.3683262
	iters: 100, epoch: 6 | loss: 0.4559319
	speed: 0.0114s/iter; left time: 7.6713s
	iters: 200, epoch: 6 | loss: 0.4538057
	speed: 0.0056s/iter; left time: 3.1770s
Updating learning rate to 4.2752576437703593e-05
Epoch: 6 cost time: 1.4673218727111816
Epoch: 6, Steps: 257 | Train Loss: 0.4548688 Vali Loss: 0.3691221 Best vali loss: 0.3683262
	iters: 100, epoch: 7 | loss: 0.9588776
	speed: 0.0113s/iter; left time: 4.6952s
	iters: 200, epoch: 7 | loss: 0.8019664
	speed: 0.0055s/iter; left time: 1.7276s
Updating learning rate to 1.111103260761281e-05
Epoch: 7 cost time: 1.441850185394287
Epoch: 7, Steps: 257 | Train Loss: 0.8804220 Vali Loss: 0.3691186 Best vali loss: 0.3683262
	iters: 100, epoch: 8 | loss: 0.8425961
	speed: 0.0112s/iter; left time: 1.7743s
	iters: 200, epoch: 8 | loss: 0.4811263
	speed: 0.0054s/iter; left time: 0.3120s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4343812465667725
Epoch: 8, Steps: 257 | Train Loss: 0.6618612 Vali Loss: 0.3691927 Best vali loss: 0.3683262

best validation loss 0.368326235789447

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.003668117005, 'e_layers': 4, 'learning_rate': 0.0006931712513, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006667889914506539
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.1038517951965332
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709926 Best vali loss: 0.3709926
Updating learning rate to 0.0005916586718088973
Epoch: 2 cost time: 0.7930984497070312
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3749775 Best vali loss: 0.3709926
Updating learning rate to 0.0004792182024821441
Validation loss decreased (0.3710 --> 0.3600).  Saving model state dict ...
Epoch: 3 cost time: 0.788360595703125
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3599997 Best vali loss: 0.3599997

best validation loss 0.35999968546078576

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 2, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.7608354091644287
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704911 Best vali loss: 0.3704911
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3705 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 0.4462437629699707
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3660421 Best vali loss: 0.3660421
Updating learning rate to 0.000176872471975
Validation loss decreased (0.3660 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 0.4459879398345947
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3541916 Best vali loss: 0.3541916

best validation loss 0.35419162787014

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023110863501, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.0970242023468018
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714674 Best vali loss: 0.3714674
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3715 --> 0.3597).  Saving model state dict ...
Epoch: 2 cost time: 0.7837584018707275
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3597097 Best vali loss: 0.3597097
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7800042629241943
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3686389 Best vali loss: 0.3597097

best validation loss 0.35970968497525496

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 2, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.84362359875e-05
Validation loss decreased (0.3542 --> 0.3514).  Saving model state dict ...
Epoch: 4 cost time: 0.7678561210632324
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3514214 Best vali loss: 0.3514214
Updating learning rate to 4.421811799375e-05
Validation loss decreased (0.3514 --> 0.3459).  Saving model state dict ...
Epoch: 5 cost time: 0.4425814151763916
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3458981 Best vali loss: 0.3458981
Updating learning rate to 2.2109058996875e-05
Validation loss decreased (0.3459 --> 0.3458).  Saving model state dict ...
Epoch: 6 cost time: 0.44994688034057617
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3457773 Best vali loss: 0.3457773
Updating learning rate to 1.10545294984375e-05
Validation loss decreased (0.3458 --> 0.3446).  Saving model state dict ...
Epoch: 7 cost time: 0.4509463310241699
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3445989 Best vali loss: 0.3445989
Updating learning rate to 5.52726474921875e-06
Epoch: 8 cost time: 0.4521045684814453
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3459124 Best vali loss: 0.3445989

best validation loss 0.34459888199691924

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025000723114, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.0966532230377197
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715720 Best vali loss: 0.3715720
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3716 --> 0.3574).  Saving model state dict ...
Epoch: 2 cost time: 0.7845602035522461
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3574254 Best vali loss: 0.3574254
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7849421501159668
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3796372 Best vali loss: 0.3574254
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3574 --> 0.3504).  Saving model state dict ...
Epoch: 4 cost time: 0.7790176868438721
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3503689 Best vali loss: 0.3503689
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3504 --> 0.3474).  Saving model state dict ...
Epoch: 5 cost time: 0.7806923389434814
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3473732 Best vali loss: 0.3473732
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3474 --> 0.3456).  Saving model state dict ...
Epoch: 6 cost time: 0.7843897342681885
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3455596 Best vali loss: 0.3455596
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7906203269958496
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3537132 Best vali loss: 0.3455596
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7842473983764648
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3535807 Best vali loss: 0.3455596

best validation loss 0.34555960459184554

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022144278717, 'e_layers': 2, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007077576329
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 0.7581403255462646
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705984 Best vali loss: 0.3705984
Updating learning rate to 0.00035387881645
Validation loss decreased (0.3706 --> 0.3544).  Saving model state dict ...
Epoch: 2 cost time: 0.4497215747833252
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3543942 Best vali loss: 0.3543942
Updating learning rate to 0.000176939408225
Epoch: 3 cost time: 0.447650671005249
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3655767 Best vali loss: 0.3543942
Updating learning rate to 8.84697041125e-05
Epoch: 4 cost time: 0.4505620002746582
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3544961 Best vali loss: 0.3543942
Updating learning rate to 4.423485205625e-05
Validation loss decreased (0.3544 --> 0.3467).  Saving model state dict ...
Epoch: 5 cost time: 0.4527161121368408
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3466668 Best vali loss: 0.3466668
Updating learning rate to 2.2117426028125e-05
Epoch: 6 cost time: 0.4502866268157959
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3482614 Best vali loss: 0.3466668
Updating learning rate to 1.10587130140625e-05
Validation loss decreased (0.3467 --> 0.3459).  Saving model state dict ...
Epoch: 7 cost time: 0.44675469398498535
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3458566 Best vali loss: 0.3458566
Updating learning rate to 5.52935650703125e-06
Validation loss decreased (0.3459 --> 0.3456).  Saving model state dict ...
Epoch: 8 cost time: 0.45359158515930176
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3455802 Best vali loss: 0.3455802

best validation loss 0.345580163393133

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019148627934, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.7535445690155029
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3707742 Best vali loss: 0.3707742
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.4460415840148926
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3753585 Best vali loss: 0.3707742
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.44240760803222656
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3829583 Best vali loss: 0.3707742

best validation loss 0.37077424176081225

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019222011724, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.7641761302947998
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708942 Best vali loss: 0.3708942
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3709 --> 0.3661).  Saving model state dict ...
Epoch: 2 cost time: 0.4436051845550537
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3660871 Best vali loss: 0.3660871
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3661 --> 0.3555).  Saving model state dict ...
Epoch: 3 cost time: 0.456026554107666
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3555118 Best vali loss: 0.3555118

best validation loss 0.35551177065358414

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019269962592, 'e_layers': 2, 'learning_rate': 0.0007012788476, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007012788476
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.7635085582733154
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704753 Best vali loss: 0.3704753
Updating learning rate to 0.0003506394238
Validation loss decreased (0.3705 --> 0.3599).  Saving model state dict ...
Epoch: 2 cost time: 0.45313024520874023
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3598504 Best vali loss: 0.3598504
Updating learning rate to 0.0001753197119
Validation loss decreased (0.3599 --> 0.3459).  Saving model state dict ...
Epoch: 3 cost time: 0.45363616943359375
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3458964 Best vali loss: 0.3458964

best validation loss 0.34589638581210363

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019269962592, 'e_layers': 2, 'learning_rate': 0.0007012788476, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.765985595e-05
Epoch: 4 cost time: 0.7614247798919678
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3476276 Best vali loss: 0.3458964
Updating learning rate to 4.3829927975e-05
Epoch: 5 cost time: 0.4474363327026367
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3459882 Best vali loss: 0.3458964
Updating learning rate to 2.19149639875e-05
Validation loss decreased (0.3459 --> 0.3457).  Saving model state dict ...
Epoch: 6 cost time: 0.4497864246368408
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3456725 Best vali loss: 0.3456725
Updating learning rate to 1.095748199375e-05
Epoch: 7 cost time: 0.4438974857330322
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3465464 Best vali loss: 0.3456725
Updating learning rate to 5.478740996875e-06
Validation loss decreased (0.3457 --> 0.3451).  Saving model state dict ...
Epoch: 8 cost time: 0.4400172233581543
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3451281 Best vali loss: 0.3451281

best validation loss 0.34512813629944805

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019328454769, 'e_layers': 2, 'learning_rate': 0.000706219158, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000706219158
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.765974760055542
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704577 Best vali loss: 0.3704577
Updating learning rate to 0.000353109579
Epoch: 2 cost time: 0.44588422775268555
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3758126 Best vali loss: 0.3704577
Updating learning rate to 0.0001765547895
Validation loss decreased (0.3705 --> 0.3603).  Saving model state dict ...
Epoch: 3 cost time: 0.44370365142822266
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3602868 Best vali loss: 0.3602868
Updating learning rate to 8.827739475e-05
Epoch: 4 cost time: 0.44924116134643555
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3619161 Best vali loss: 0.3602868
Updating learning rate to 4.4138697375e-05
Validation loss decreased (0.3603 --> 0.3506).  Saving model state dict ...
Epoch: 5 cost time: 0.4469454288482666
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3506220 Best vali loss: 0.3506220
Updating learning rate to 2.20693486875e-05
Epoch: 6 cost time: 0.44659924507141113
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3644314 Best vali loss: 0.3506220
Updating learning rate to 1.103467434375e-05
Epoch: 7 cost time: 0.44767332077026367
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3532478 Best vali loss: 0.3506220
Updating learning rate to 5.517337171875e-06
Epoch: 8 cost time: 0.44553184509277344
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3581892 Best vali loss: 0.3506220

best validation loss 0.35062204271496394

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.0883326530456543
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712862 Best vali loss: 0.3712862
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3713 --> 0.3598).  Saving model state dict ...
Epoch: 2 cost time: 0.7841198444366455
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3597777 Best vali loss: 0.3597777
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3598 --> 0.3505).  Saving model state dict ...
Epoch: 3 cost time: 0.7810626029968262
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3504960 Best vali loss: 0.3504960
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3505 --> 0.3411).  Saving model state dict ...
Epoch: 4 cost time: 0.7787158489227295
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3411103 Best vali loss: 0.3411103
Updating learning rate to 4.419018625625e-05
Epoch: 5 cost time: 0.7806286811828613
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3445818 Best vali loss: 0.3411103
Updating learning rate to 2.2095093128125e-05
Epoch: 6 cost time: 0.7790353298187256
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3436000 Best vali loss: 0.3411103
Updating learning rate to 1.10475465640625e-05
Epoch: 7 cost time: 0.7863965034484863
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3440981 Best vali loss: 0.3411103
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.7794289588928223
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3436870 Best vali loss: 0.3411103

best validation loss 0.341110347659274

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 1.10886549949646
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3671121 Best vali loss: 0.3671121
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3671 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.7972407341003418
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3649684 Best vali loss: 0.3649684
Updating learning rate to 0.000176872471975
Validation loss decreased (0.3650 --> 0.3631).  Saving model state dict ...
Epoch: 3 cost time: 0.7949671745300293
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3631140 Best vali loss: 0.3631140

best validation loss 0.36311398348780183

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000680598354883289
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.1189169883728027
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672016 Best vali loss: 0.3672016
Updating learning rate to 0.0006039120679084697
Epoch: 2 cost time: 0.7918801307678223
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703500 Best vali loss: 0.3672016
Updating learning rate to 0.0004891429289045357
Validation loss decreased (0.3672 --> 0.3536).  Saving model state dict ...
Epoch: 3 cost time: 0.7878389358520508
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3535737 Best vali loss: 0.3535737

best validation loss 0.35357373382581475

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.0978336334228516
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715964 Best vali loss: 0.3715964
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7802708148956299
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3758289 Best vali loss: 0.3715964
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3716 --> 0.3676).  Saving model state dict ...
Epoch: 3 cost time: 0.789313793182373
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3675734 Best vali loss: 0.3675734

best validation loss 0.3675733501644172

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3536 --> 0.3470).  Saving model state dict ...
Epoch: 4 cost time: 1.1111202239990234
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3470131 Best vali loss: 0.3470131
Updating learning rate to 0.00021838406889546433
Validation loss decreased (0.3470 --> 0.3459).  Saving model state dict ...
Epoch: 5 cost time: 0.7949326038360596
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3459471 Best vali loss: 0.3459471
Updating learning rate to 0.00010361492989153027
Epoch: 6 cost time: 0.8006360530853271
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3488372 Best vali loss: 0.3459471
Updating learning rate to 2.6928642916710897e-05
Epoch: 7 cost time: 0.7974207401275635
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3557010 Best vali loss: 0.3459471
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7944357395172119
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3563987 Best vali loss: 0.3459471

best validation loss 0.3459471287216794

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0018873104242, 'e_layers': 4, 'learning_rate': 0.0006856068826, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6304817
	speed: 0.0114s/iter; left time: 45.8603s
	iters: 200, epoch: 1 | loss: 0.6350962
	speed: 0.0051s/iter; left time: 20.1455s
	iters: 300, epoch: 1 | loss: 0.7774267
	speed: 0.0052s/iter; left time: 19.9162s
	iters: 400, epoch: 1 | loss: 0.4429322
	speed: 0.0051s/iter; left time: 18.9964s
	iters: 500, epoch: 1 | loss: 0.4045762
	speed: 0.0051s/iter; left time: 18.3343s
Updating learning rate to 0.0006856068826
Validation loss decreased (inf --> 0.3807).  Saving model state dict ...
Epoch: 1 cost time: 2.999326467514038
Epoch: 1, Steps: 514 | Train Loss: 0.5781026 Vali Loss: 0.3806807 Best vali loss: 0.3806807
	iters: 100, epoch: 2 | loss: 0.3760490
	speed: 0.0100s/iter; left time: 35.0893s
	iters: 200, epoch: 2 | loss: 0.3007899
	speed: 0.0049s/iter; left time: 16.6742s
	iters: 300, epoch: 2 | loss: 0.6612213
	speed: 0.0049s/iter; left time: 16.0084s
	iters: 400, epoch: 2 | loss: 1.1982110
	speed: 0.0048s/iter; left time: 15.4839s
	iters: 500, epoch: 2 | loss: 0.4899884
	speed: 0.0050s/iter; left time: 15.3478s
Updating learning rate to 0.0003428034413
Epoch: 2 cost time: 2.5686564445495605
Epoch: 2, Steps: 514 | Train Loss: 0.6052519 Vali Loss: 0.3996999 Best vali loss: 0.3806807
	iters: 100, epoch: 3 | loss: 0.4194810
	speed: 0.0099s/iter; left time: 29.5363s
	iters: 200, epoch: 3 | loss: 0.6964784
	speed: 0.0051s/iter; left time: 14.8308s
	iters: 300, epoch: 3 | loss: 0.7385083
	speed: 0.0052s/iter; left time: 14.4010s
	iters: 400, epoch: 3 | loss: 1.0574983
	speed: 0.0052s/iter; left time: 14.0903s
	iters: 500, epoch: 3 | loss: 0.5369921
	speed: 0.0051s/iter; left time: 13.1866s
Updating learning rate to 0.00017140172065
Epoch: 3 cost time: 2.6769967079162598
Epoch: 3, Steps: 514 | Train Loss: 0.6897916 Vali Loss: 0.4055893 Best vali loss: 0.3806807
	iters: 100, epoch: 4 | loss: 0.6917597
	speed: 0.0093s/iter; left time: 23.0525s
	iters: 200, epoch: 4 | loss: 0.3044914
	speed: 0.0047s/iter; left time: 11.1795s
	iters: 300, epoch: 4 | loss: 0.9624243
	speed: 0.0048s/iter; left time: 10.8222s
	iters: 400, epoch: 4 | loss: 0.8858553
	speed: 0.0047s/iter; left time: 10.2604s
	iters: 500, epoch: 4 | loss: 0.9349247
	speed: 0.0052s/iter; left time: 10.8277s
Updating learning rate to 8.5700860325e-05
Epoch: 4 cost time: 2.5261130332946777
Epoch: 4, Steps: 514 | Train Loss: 0.7558911 Vali Loss: 0.4028768 Best vali loss: 0.3806807
	iters: 100, epoch: 5 | loss: 0.2541072
	speed: 0.0096s/iter; left time: 18.7256s
	iters: 200, epoch: 5 | loss: 0.5624044
	speed: 0.0049s/iter; left time: 9.1194s
	iters: 300, epoch: 5 | loss: 0.9138740
	speed: 0.0049s/iter; left time: 8.5833s
	iters: 400, epoch: 5 | loss: 0.4155499
	speed: 0.0048s/iter; left time: 7.9783s
	iters: 500, epoch: 5 | loss: 1.2615013
	speed: 0.0049s/iter; left time: 7.5589s
Updating learning rate to 4.28504301625e-05
Epoch: 5 cost time: 2.54288911819458
Epoch: 5, Steps: 514 | Train Loss: 0.6814874 Vali Loss: 0.4044759 Best vali loss: 0.3806807
	iters: 100, epoch: 6 | loss: 0.4402572
	speed: 0.0096s/iter; left time: 13.8891s
	iters: 200, epoch: 6 | loss: 0.5413545
	speed: 0.0047s/iter; left time: 6.3234s
	iters: 300, epoch: 6 | loss: 1.0611408
	speed: 0.0048s/iter; left time: 5.9668s
	iters: 400, epoch: 6 | loss: 0.6791651
	speed: 0.0047s/iter; left time: 5.3456s
	iters: 500, epoch: 6 | loss: 1.1392857
	speed: 0.0047s/iter; left time: 4.8516s
Updating learning rate to 2.142521508125e-05
Epoch: 6 cost time: 2.4735288619995117
Epoch: 6, Steps: 514 | Train Loss: 0.7722407 Vali Loss: 0.3948602 Best vali loss: 0.3806807
	iters: 100, epoch: 7 | loss: 0.9724947
	speed: 0.0096s/iter; left time: 8.9022s
	iters: 200, epoch: 7 | loss: 0.3533832
	speed: 0.0049s/iter; left time: 4.0505s
	iters: 300, epoch: 7 | loss: 0.5119961
	speed: 0.0050s/iter; left time: 3.6105s
	iters: 400, epoch: 7 | loss: 0.4056545
	speed: 0.0049s/iter; left time: 3.1112s
	iters: 500, epoch: 7 | loss: 0.3667180
	speed: 0.0049s/iter; left time: 2.5690s
Updating learning rate to 1.0712607540625e-05
Epoch: 7 cost time: 2.55505108833313
Epoch: 7, Steps: 514 | Train Loss: 0.5220493 Vali Loss: 0.3943703 Best vali loss: 0.3806807
	iters: 100, epoch: 8 | loss: 0.5129888
	speed: 0.0096s/iter; left time: 3.9782s
	iters: 200, epoch: 8 | loss: 0.4588471
	speed: 0.0048s/iter; left time: 1.5274s
	iters: 300, epoch: 8 | loss: 0.5312286
	speed: 0.0053s/iter; left time: 1.1341s
	iters: 400, epoch: 8 | loss: 1.0236276
	speed: 0.0053s/iter; left time: 0.6055s
	iters: 500, epoch: 8 | loss: 0.4161395
	speed: 0.0052s/iter; left time: 0.0775s
Updating learning rate to 5.3563037703125e-06
Epoch: 8 cost time: 2.6528303623199463
Epoch: 8, Steps: 514 | Train Loss: 0.5885663 Vali Loss: 0.3922542 Best vali loss: 0.3806807

best validation loss 0.3806807119684744

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011511127302, 'e_layers': 4, 'learning_rate': 0.0004195236697, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2407497
	speed: 0.0122s/iter; left time: 48.7730s
	iters: 200, epoch: 1 | loss: 0.5799291
	speed: 0.0056s/iter; left time: 21.8554s
	iters: 300, epoch: 1 | loss: 1.0687696
	speed: 0.0056s/iter; left time: 21.3720s
	iters: 400, epoch: 1 | loss: 0.6968138
	speed: 0.0056s/iter; left time: 20.9174s
	iters: 500, epoch: 1 | loss: 0.4492815
	speed: 0.0055s/iter; left time: 19.7647s
Updating learning rate to 0.0004035565007699277
Validation loss decreased (inf --> 0.4011).  Saving model state dict ...
Epoch: 1 cost time: 3.243025064468384
Epoch: 1, Steps: 514 | Train Loss: 0.8071088 Vali Loss: 0.4010694 Best vali loss: 0.4010694
	iters: 100, epoch: 2 | loss: 0.6743283
	speed: 0.0116s/iter; left time: 40.6783s
	iters: 200, epoch: 2 | loss: 0.6562389
	speed: 0.0055s/iter; left time: 18.8470s
	iters: 300, epoch: 2 | loss: 1.1873301
	speed: 0.0056s/iter; left time: 18.4982s
	iters: 400, epoch: 2 | loss: 0.3973185
	speed: 0.0056s/iter; left time: 17.7967s
	iters: 500, epoch: 2 | loss: 0.9395335
	speed: 0.0055s/iter; left time: 17.0238s
Updating learning rate to 0.00035808585070656765
Validation loss decreased (0.4011 --> 0.4000).  Saving model state dict ...
Epoch: 2 cost time: 2.90043044090271
Epoch: 2, Steps: 514 | Train Loss: 0.7709498 Vali Loss: 0.3999752 Best vali loss: 0.3999752
	iters: 100, epoch: 3 | loss: 0.4480170
	speed: 0.0115s/iter; left time: 34.1982s
	iters: 200, epoch: 3 | loss: 0.7437227
	speed: 0.0055s/iter; left time: 15.7978s
	iters: 300, epoch: 3 | loss: 0.7801905
	speed: 0.0056s/iter; left time: 15.5498s
	iters: 400, epoch: 3 | loss: 0.4483203
	speed: 0.0057s/iter; left time: 15.2341s
	iters: 500, epoch: 3 | loss: 0.5486650
	speed: 0.0057s/iter; left time: 14.6134s
Updating learning rate to 0.00029003421378959713
Epoch: 3 cost time: 2.906484603881836
Epoch: 3, Steps: 514 | Train Loss: 0.5937831 Vali Loss: 0.4060266 Best vali loss: 0.3999752
	iters: 100, epoch: 4 | loss: 0.6809387
	speed: 0.0112s/iter; left time: 27.7623s
	iters: 200, epoch: 4 | loss: 0.8868847
	speed: 0.0055s/iter; left time: 12.9487s
	iters: 300, epoch: 4 | loss: 0.8267355
	speed: 0.0055s/iter; left time: 12.5383s
	iters: 400, epoch: 4 | loss: 0.4864277
	speed: 0.0057s/iter; left time: 12.3321s
	iters: 500, epoch: 4 | loss: 0.4562873
	speed: 0.0057s/iter; left time: 11.8343s
Updating learning rate to 0.00020976183485
Validation loss decreased (0.4000 --> 0.3993).  Saving model state dict ...
Epoch: 4 cost time: 2.921097993850708
Epoch: 4, Steps: 514 | Train Loss: 0.6674548 Vali Loss: 0.3992950 Best vali loss: 0.3992950
	iters: 100, epoch: 5 | loss: 1.4878879
	speed: 0.0115s/iter; left time: 22.4788s
	iters: 200, epoch: 5 | loss: 0.7457365
	speed: 0.0055s/iter; left time: 10.1497s
	iters: 300, epoch: 5 | loss: 0.3076117
	speed: 0.0054s/iter; left time: 9.4952s
	iters: 400, epoch: 5 | loss: 0.6637250
	speed: 0.0054s/iter; left time: 8.9732s
	iters: 500, epoch: 5 | loss: 0.5153857
	speed: 0.0054s/iter; left time: 8.4803s
Updating learning rate to 0.0001294894559104029
Epoch: 5 cost time: 2.8347339630126953
Epoch: 5, Steps: 514 | Train Loss: 0.7440694 Vali Loss: 0.4053561 Best vali loss: 0.3992950
	iters: 100, epoch: 6 | loss: 1.1209533
	speed: 0.0109s/iter; left time: 15.7120s
	iters: 200, epoch: 6 | loss: 0.5812472
	speed: 0.0055s/iter; left time: 7.3868s
	iters: 300, epoch: 6 | loss: 1.2483474
	speed: 0.0056s/iter; left time: 6.9423s
	iters: 400, epoch: 6 | loss: 0.5189881
	speed: 0.0056s/iter; left time: 6.4483s
	iters: 500, epoch: 6 | loss: 0.4360223
	speed: 0.0055s/iter; left time: 5.7148s
Updating learning rate to 6.143781899343235e-05
Epoch: 6 cost time: 2.8885960578918457
Epoch: 6, Steps: 514 | Train Loss: 0.7811117 Vali Loss: 0.4030984 Best vali loss: 0.3992950
	iters: 100, epoch: 7 | loss: 1.0833828
	speed: 0.0110s/iter; left time: 10.2620s
	iters: 200, epoch: 7 | loss: 0.6444677
	speed: 0.0055s/iter; left time: 4.5301s
	iters: 300, epoch: 7 | loss: 0.5078902
	speed: 0.0056s/iter; left time: 4.0592s
	iters: 400, epoch: 7 | loss: 1.0135878
	speed: 0.0056s/iter; left time: 3.4990s
	iters: 500, epoch: 7 | loss: 0.4676323
	speed: 0.0055s/iter; left time: 2.9000s
Updating learning rate to 1.5967168930072264e-05
Epoch: 7 cost time: 2.892446994781494
Epoch: 7, Steps: 514 | Train Loss: 0.7433922 Vali Loss: 0.4027270 Best vali loss: 0.3992950
	iters: 100, epoch: 8 | loss: 0.3403934
	speed: 0.0111s/iter; left time: 4.6064s
	iters: 200, epoch: 8 | loss: 0.2366252
	speed: 0.0054s/iter; left time: 1.7024s
	iters: 300, epoch: 8 | loss: 0.8754851
	speed: 0.0054s/iter; left time: 1.1667s
	iters: 400, epoch: 8 | loss: 1.2097270
	speed: 0.0055s/iter; left time: 0.6329s
	iters: 500, epoch: 8 | loss: 0.3666536
	speed: 0.0057s/iter; left time: 0.0857s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.8787217140197754
Epoch: 8, Steps: 514 | Train Loss: 0.6057769 Vali Loss: 0.4033500 Best vali loss: 0.3992950

best validation loss 0.3992949513648957

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011858610791, 'e_layers': 4, 'learning_rate': 0.0004102952348, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2258062
	speed: 0.0120s/iter; left time: 48.3293s
	iters: 200, epoch: 1 | loss: 0.5559110
	speed: 0.0056s/iter; left time: 21.7313s
	iters: 300, epoch: 1 | loss: 1.1283685
	speed: 0.0058s/iter; left time: 22.1212s
	iters: 400, epoch: 1 | loss: 0.6249079
	speed: 0.0057s/iter; left time: 21.0236s
	iters: 500, epoch: 1 | loss: 0.4516740
	speed: 0.0057s/iter; left time: 20.6701s
Updating learning rate to 0.0003946793022593163
Validation loss decreased (inf --> 0.4004).  Saving model state dict ...
Epoch: 1 cost time: 3.2870078086853027
Epoch: 1, Steps: 514 | Train Loss: 0.7973335 Vali Loss: 0.4004419 Best vali loss: 0.4004419
	iters: 100, epoch: 2 | loss: 0.6711735
	speed: 0.0116s/iter; left time: 40.4858s
	iters: 200, epoch: 2 | loss: 0.6523768
	speed: 0.0056s/iter; left time: 18.9180s
	iters: 300, epoch: 2 | loss: 1.2300184
	speed: 0.0057s/iter; left time: 18.8396s
	iters: 400, epoch: 2 | loss: 0.3965581
	speed: 0.0058s/iter; left time: 18.7026s
	iters: 500, epoch: 2 | loss: 0.9711585
	speed: 0.0059s/iter; left time: 18.2305s
Updating learning rate to 0.00035020888880780336
Epoch: 2 cost time: 2.9846420288085938
Epoch: 2, Steps: 514 | Train Loss: 0.7842571 Vali Loss: 0.4068442 Best vali loss: 0.4004419
	iters: 100, epoch: 3 | loss: 0.4401446
	speed: 0.0113s/iter; left time: 33.6376s
	iters: 200, epoch: 3 | loss: 0.8018230
	speed: 0.0057s/iter; left time: 16.5454s
	iters: 300, epoch: 3 | loss: 0.7901418
	speed: 0.0057s/iter; left time: 15.9229s
	iters: 400, epoch: 3 | loss: 0.4337081
	speed: 0.0056s/iter; left time: 15.0791s
	iters: 500, epoch: 3 | loss: 0.5643785
	speed: 0.0057s/iter; left time: 14.8276s
Updating learning rate to 0.0002836542117681522
Epoch: 3 cost time: 2.9758379459381104
Epoch: 3, Steps: 514 | Train Loss: 0.6060392 Vali Loss: 0.4060583 Best vali loss: 0.4004419

best validation loss 0.40044191549943803

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011581989907, 'e_layers': 4, 'learning_rate': 0.0004095930392, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2213016
	speed: 0.0119s/iter; left time: 47.7660s
	iters: 200, epoch: 1 | loss: 0.6157480
	speed: 0.0057s/iter; left time: 22.1897s
	iters: 300, epoch: 1 | loss: 1.0971438
	speed: 0.0057s/iter; left time: 21.7240s
	iters: 400, epoch: 1 | loss: 0.6279215
	speed: 0.0056s/iter; left time: 20.9091s
	iters: 500, epoch: 1 | loss: 0.5088003
	speed: 0.0057s/iter; left time: 20.4506s
Updating learning rate to 0.0003940038323879866
Validation loss decreased (inf --> 0.4034).  Saving model state dict ...
Epoch: 1 cost time: 3.273425340652466
Epoch: 1, Steps: 514 | Train Loss: 0.8141830 Vali Loss: 0.4034435 Best vali loss: 0.4034435
	iters: 100, epoch: 2 | loss: 0.6730974
	speed: 0.0114s/iter; left time: 40.0199s
	iters: 200, epoch: 2 | loss: 0.6552899
	speed: 0.0057s/iter; left time: 19.3794s
	iters: 300, epoch: 2 | loss: 1.1866446
	speed: 0.0056s/iter; left time: 18.3983s
	iters: 400, epoch: 2 | loss: 0.3977307
	speed: 0.0056s/iter; left time: 17.7567s
	iters: 500, epoch: 2 | loss: 0.9387044
	speed: 0.0056s/iter; left time: 17.2405s
Updating learning rate to 0.00034960952737256366
Validation loss decreased (0.4034 --> 0.4000).  Saving model state dict ...
Epoch: 2 cost time: 2.9117043018341064
Epoch: 2, Steps: 514 | Train Loss: 0.7702934 Vali Loss: 0.4000153 Best vali loss: 0.4000153
	iters: 100, epoch: 3 | loss: 0.4484523
	speed: 0.0119s/iter; left time: 35.3816s
	iters: 200, epoch: 3 | loss: 0.7417770
	speed: 0.0057s/iter; left time: 16.4502s
	iters: 300, epoch: 3 | loss: 0.7801342
	speed: 0.0057s/iter; left time: 15.8644s
	iters: 400, epoch: 3 | loss: 0.4483790
	speed: 0.0057s/iter; left time: 15.3513s
	iters: 500, epoch: 3 | loss: 0.5483546
	speed: 0.0057s/iter; left time: 14.7172s
Updating learning rate to 0.0002831687546569524
Epoch: 3 cost time: 2.976656913757324
Epoch: 3, Steps: 514 | Train Loss: 0.5934194 Vali Loss: 0.4059212 Best vali loss: 0.4000153

best validation loss 0.40001526960338263

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015687383341, 'e_layers': 2, 'learning_rate': 0.0044123346948, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2224216
	speed: 0.0096s/iter; left time: 77.6117s
	iters: 200, epoch: 1 | loss: 0.8771124
	speed: 0.0034s/iter; left time: 27.1857s
	iters: 300, epoch: 1 | loss: 1.1777149
	speed: 0.0034s/iter; left time: 26.6573s
	iters: 400, epoch: 1 | loss: 0.4319427
	speed: 0.0033s/iter; left time: 26.1126s
	iters: 500, epoch: 1 | loss: 0.9851416
	speed: 0.0034s/iter; left time: 25.9415s
	iters: 600, epoch: 1 | loss: 1.0700608
	speed: 0.0034s/iter; left time: 25.6399s
	iters: 700, epoch: 1 | loss: 0.5207909
	speed: 0.0033s/iter; left time: 24.4463s
	iters: 800, epoch: 1 | loss: 0.9573858
	speed: 0.0030s/iter; left time: 22.5557s
	iters: 900, epoch: 1 | loss: 1.0805004
	speed: 0.0030s/iter; left time: 22.2380s
	iters: 1000, epoch: 1 | loss: 1.0241932
	speed: 0.0030s/iter; left time: 21.9308s
Updating learning rate to 0.0042444002049575776
Validation loss decreased (inf --> 0.3839).  Saving model state dict ...
Epoch: 1 cost time: 3.70007061958313
Epoch: 1, Steps: 1027 | Train Loss: 0.9347264 Vali Loss: 0.3838828 Best vali loss: 0.3838828
	iters: 100, epoch: 2 | loss: 0.7170927
	speed: 0.0093s/iter; left time: 65.8712s
	iters: 200, epoch: 2 | loss: 0.4532911
	speed: 0.0030s/iter; left time: 21.1118s
	iters: 300, epoch: 2 | loss: 0.6413676
	speed: 0.0030s/iter; left time: 20.7359s
	iters: 400, epoch: 2 | loss: 0.4989835
	speed: 0.0030s/iter; left time: 20.4304s
	iters: 500, epoch: 2 | loss: 1.1081921
	speed: 0.0030s/iter; left time: 20.0706s
	iters: 600, epoch: 2 | loss: 0.6456833
	speed: 0.0030s/iter; left time: 19.8477s
	iters: 700, epoch: 2 | loss: 0.3689604
	speed: 0.0030s/iter; left time: 19.5332s
	iters: 800, epoch: 2 | loss: 0.7170888
	speed: 0.0030s/iter; left time: 19.2011s
	iters: 900, epoch: 2 | loss: 1.2762011
	speed: 0.0029s/iter; left time: 18.0008s
	iters: 1000, epoch: 2 | loss: 0.1687956
	speed: 0.0028s/iter; left time: 17.6216s
Updating learning rate to 0.0037661632391788775
Epoch: 2 cost time: 3.1017963886260986
Epoch: 2, Steps: 1027 | Train Loss: 0.6595656 Vali Loss: 0.4024727 Best vali loss: 0.3838828
	iters: 100, epoch: 3 | loss: 0.6212057
	speed: 0.0090s/iter; left time: 54.3035s
	iters: 200, epoch: 3 | loss: 0.8896430
	speed: 0.0029s/iter; left time: 17.2678s
	iters: 300, epoch: 3 | loss: 1.1693264
	speed: 0.0029s/iter; left time: 16.8277s
	iters: 400, epoch: 3 | loss: 0.4504240
	speed: 0.0028s/iter; left time: 16.3670s
	iters: 500, epoch: 3 | loss: 0.7501072
	speed: 0.0029s/iter; left time: 16.4585s
	iters: 600, epoch: 3 | loss: 0.2506682
	speed: 0.0029s/iter; left time: 16.3572s
	iters: 700, epoch: 3 | loss: 0.4171898
	speed: 0.0029s/iter; left time: 15.9995s
	iters: 800, epoch: 3 | loss: 0.5557688
	speed: 0.0029s/iter; left time: 15.7337s
	iters: 900, epoch: 3 | loss: 0.4827030
	speed: 0.0030s/iter; left time: 15.9821s
	iters: 1000, epoch: 3 | loss: 0.3419383
	speed: 0.0031s/iter; left time: 16.1388s
Updating learning rate to 0.0030504310402748175
Validation loss decreased (0.3839 --> 0.3828).  Saving model state dict ...
Epoch: 3 cost time: 3.061898708343506
Epoch: 3, Steps: 1027 | Train Loss: 0.5928975 Vali Loss: 0.3827948 Best vali loss: 0.3827948

best validation loss 0.3827947520026992

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015687383341, 'e_layers': 2, 'learning_rate': 0.0044123346948, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2149496
	speed: 0.0094s/iter; left time: 47.2763s
	iters: 200, epoch: 4 | loss: 0.7893075
	speed: 0.0033s/iter; left time: 16.1669s
	iters: 300, epoch: 4 | loss: 1.1631230
	speed: 0.0033s/iter; left time: 15.9088s
	iters: 400, epoch: 4 | loss: 0.3954936
	speed: 0.0033s/iter; left time: 15.4153s
	iters: 500, epoch: 4 | loss: 0.7002781
	speed: 0.0033s/iter; left time: 15.2348s
	iters: 600, epoch: 4 | loss: 0.8337351
	speed: 0.0033s/iter; left time: 14.8909s
	iters: 700, epoch: 4 | loss: 0.5105338
	speed: 0.0033s/iter; left time: 14.6003s
	iters: 800, epoch: 4 | loss: 0.9575685
	speed: 0.0032s/iter; left time: 13.8825s
	iters: 900, epoch: 4 | loss: 1.0458338
	speed: 0.0032s/iter; left time: 13.4633s
	iters: 1000, epoch: 4 | loss: 0.9226263
	speed: 0.0032s/iter; left time: 13.1282s
Updating learning rate to 0.0022061673474
Validation loss decreased (0.3828 --> 0.3801).  Saving model state dict ...
Epoch: 4 cost time: 3.6831562519073486
Epoch: 4, Steps: 1027 | Train Loss: 0.8533449 Vali Loss: 0.3801294 Best vali loss: 0.3801294
	iters: 100, epoch: 5 | loss: 0.9589903
	speed: 0.0092s/iter; left time: 36.8100s
	iters: 200, epoch: 5 | loss: 0.4311969
	speed: 0.0031s/iter; left time: 12.2072s
	iters: 300, epoch: 5 | loss: 0.6317401
	speed: 0.0031s/iter; left time: 11.6958s
	iters: 400, epoch: 5 | loss: 0.5761731
	speed: 0.0031s/iter; left time: 11.4254s
	iters: 500, epoch: 5 | loss: 1.0349582
	speed: 0.0031s/iter; left time: 11.0421s
	iters: 600, epoch: 5 | loss: 0.5247219
	speed: 0.0030s/iter; left time: 10.6165s
	iters: 700, epoch: 5 | loss: 0.3669012
	speed: 0.0030s/iter; left time: 10.3412s
	iters: 800, epoch: 5 | loss: 0.7211263
	speed: 0.0030s/iter; left time: 9.9594s
	iters: 900, epoch: 5 | loss: 0.8706893
	speed: 0.0030s/iter; left time: 9.7721s
	iters: 1000, epoch: 5 | loss: 0.1551246
	speed: 0.0031s/iter; left time: 9.5966s
Updating learning rate to 0.0013619036545251828
Epoch: 5 cost time: 3.1987075805664062
Epoch: 5, Steps: 1027 | Train Loss: 0.6271622 Vali Loss: 0.3814381 Best vali loss: 0.3801294
	iters: 100, epoch: 6 | loss: 0.5048006
	speed: 0.0092s/iter; left time: 27.4717s
	iters: 200, epoch: 6 | loss: 0.6631703
	speed: 0.0033s/iter; left time: 9.5510s
	iters: 300, epoch: 6 | loss: 0.6856560
	speed: 0.0033s/iter; left time: 9.0704s
	iters: 400, epoch: 6 | loss: 0.4537251
	speed: 0.0033s/iter; left time: 8.7387s
	iters: 500, epoch: 6 | loss: 0.7401463
	speed: 0.0033s/iter; left time: 8.4544s
	iters: 600, epoch: 6 | loss: 0.2697078
	speed: 0.0033s/iter; left time: 8.1923s
	iters: 700, epoch: 6 | loss: 0.4007698
	speed: 0.0032s/iter; left time: 7.6278s
	iters: 800, epoch: 6 | loss: 0.4944088
	speed: 0.0032s/iter; left time: 7.2466s
	iters: 900, epoch: 6 | loss: 0.4226724
	speed: 0.0032s/iter; left time: 6.9880s
	iters: 1000, epoch: 6 | loss: 0.3315525
	speed: 0.0032s/iter; left time: 6.6927s
Updating learning rate to 0.0006461714556211224
Epoch: 6 cost time: 3.3748953342437744
Epoch: 6, Steps: 1027 | Train Loss: 0.4966610 Vali Loss: 0.3887590 Best vali loss: 0.3801294
	iters: 100, epoch: 7 | loss: 0.5749388
	speed: 0.0093s/iter; left time: 18.1522s
	iters: 200, epoch: 7 | loss: 1.0548315
	speed: 0.0031s/iter; left time: 5.6986s
	iters: 300, epoch: 7 | loss: 0.2414864
	speed: 0.0031s/iter; left time: 5.3684s
	iters: 400, epoch: 7 | loss: 1.3169004
	speed: 0.0030s/iter; left time: 4.9967s
	iters: 500, epoch: 7 | loss: 0.4108678
	speed: 0.0030s/iter; left time: 4.6946s
	iters: 600, epoch: 7 | loss: 0.2767279
	speed: 0.0030s/iter; left time: 4.3672s
	iters: 700, epoch: 7 | loss: 0.7099243
	speed: 0.0030s/iter; left time: 4.1005s
	iters: 800, epoch: 7 | loss: 1.0393509
	speed: 0.0031s/iter; left time: 3.8493s
	iters: 900, epoch: 7 | loss: 0.4272220
	speed: 0.0032s/iter; left time: 3.7514s
	iters: 1000, epoch: 7 | loss: 0.3793671
	speed: 0.0032s/iter; left time: 3.3749s
Updating learning rate to 0.00016793448984242247
Epoch: 7 cost time: 3.2090163230895996
Epoch: 7, Steps: 1027 | Train Loss: 0.6431617 Vali Loss: 0.4003221 Best vali loss: 0.3801294
	iters: 100, epoch: 8 | loss: 0.3070576
	speed: 0.0093s/iter; left time: 8.5900s
	iters: 200, epoch: 8 | loss: 0.3380494
	speed: 0.0030s/iter; left time: 2.5203s
	iters: 300, epoch: 8 | loss: 0.4755841
	speed: 0.0030s/iter; left time: 2.1914s
	iters: 400, epoch: 8 | loss: 0.2257554
	speed: 0.0030s/iter; left time: 1.9093s
	iters: 500, epoch: 8 | loss: 0.5848337
	speed: 0.0030s/iter; left time: 1.5935s
	iters: 600, epoch: 8 | loss: 0.9721863
	speed: 0.0031s/iter; left time: 1.3064s
	iters: 700, epoch: 8 | loss: 0.3391710
	speed: 0.0030s/iter; left time: 0.9969s
	iters: 800, epoch: 8 | loss: 1.0405557
	speed: 0.0030s/iter; left time: 0.6874s
	iters: 900, epoch: 8 | loss: 0.7067838
	speed: 0.0031s/iter; left time: 0.3913s
	iters: 1000, epoch: 8 | loss: 0.4881996
	speed: 0.0031s/iter; left time: 0.0855s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1654269695281982
Epoch: 8, Steps: 1027 | Train Loss: 0.5478177 Vali Loss: 0.4079327 Best vali loss: 0.3801294

best validation loss 0.38012943745596234

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.000961398994, 'e_layers': 2, 'learning_rate': 0.0002838045352, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8966765
	speed: 0.0091s/iter; left time: 36.6014s
	iters: 200, epoch: 1 | loss: 0.3954734
	speed: 0.0031s/iter; left time: 12.1089s
	iters: 300, epoch: 1 | loss: 0.8161585
	speed: 0.0030s/iter; left time: 11.4820s
	iters: 400, epoch: 1 | loss: 0.2786960
	speed: 0.0030s/iter; left time: 11.3235s
	iters: 500, epoch: 1 | loss: 0.2918729
	speed: 0.0030s/iter; left time: 10.8241s
Updating learning rate to 0.0002838045352
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 1.9118142127990723
Epoch: 1, Steps: 514 | Train Loss: 0.5357755 Vali Loss: 0.3775711 Best vali loss: 0.3775711
	iters: 100, epoch: 2 | loss: 0.2703920
	speed: 0.0071s/iter; left time: 25.0174s
	iters: 200, epoch: 2 | loss: 0.5840672
	speed: 0.0034s/iter; left time: 11.6043s
	iters: 300, epoch: 2 | loss: 1.7157650
	speed: 0.0033s/iter; left time: 10.8295s
	iters: 400, epoch: 2 | loss: 0.6122189
	speed: 0.0033s/iter; left time: 10.4413s
	iters: 500, epoch: 2 | loss: 0.8454493
	speed: 0.0034s/iter; left time: 10.4739s
Updating learning rate to 0.0001419022676
Validation loss decreased (0.3776 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 1.7592811584472656
Epoch: 2, Steps: 514 | Train Loss: 0.8055785 Vali Loss: 0.3697313 Best vali loss: 0.3697313
	iters: 100, epoch: 3 | loss: 0.8995479
	speed: 0.0071s/iter; left time: 21.2915s
	iters: 200, epoch: 3 | loss: 0.3630034
	speed: 0.0031s/iter; left time: 9.0575s
	iters: 300, epoch: 3 | loss: 0.6723013
	speed: 0.0031s/iter; left time: 8.5586s
	iters: 400, epoch: 3 | loss: 1.0383692
	speed: 0.0031s/iter; left time: 8.4576s
	iters: 500, epoch: 3 | loss: 0.7590611
	speed: 0.0031s/iter; left time: 7.9295s
Updating learning rate to 7.09511338e-05
Validation loss decreased (0.3697 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 1.6411645412445068
Epoch: 3, Steps: 514 | Train Loss: 0.7464566 Vali Loss: 0.3665431 Best vali loss: 0.3665431
	iters: 100, epoch: 4 | loss: 0.5125169
	speed: 0.0070s/iter; left time: 17.3919s
	iters: 200, epoch: 4 | loss: 0.3371745
	speed: 0.0030s/iter; left time: 7.2255s
	iters: 300, epoch: 4 | loss: 0.4501015
	speed: 0.0031s/iter; left time: 7.0060s
	iters: 400, epoch: 4 | loss: 0.9330943
	speed: 0.0031s/iter; left time: 6.6247s
	iters: 500, epoch: 4 | loss: 0.9125757
	speed: 0.0031s/iter; left time: 6.4856s
Updating learning rate to 3.54755669e-05
Epoch: 4 cost time: 1.6215791702270508
Epoch: 4, Steps: 514 | Train Loss: 0.6290926 Vali Loss: 0.3672131 Best vali loss: 0.3665431
	iters: 100, epoch: 5 | loss: 0.4453076
	speed: 0.0071s/iter; left time: 13.9282s
	iters: 200, epoch: 5 | loss: 0.9381224
	speed: 0.0033s/iter; left time: 6.1419s
	iters: 300, epoch: 5 | loss: 0.4190366
	speed: 0.0035s/iter; left time: 6.2269s
	iters: 400, epoch: 5 | loss: 0.8223119
	speed: 0.0033s/iter; left time: 5.4383s
	iters: 500, epoch: 5 | loss: 0.3739581
	speed: 0.0033s/iter; left time: 5.1023s
Updating learning rate to 1.773778345e-05
Epoch: 5 cost time: 1.7750303745269775
Epoch: 5, Steps: 514 | Train Loss: 0.5997473 Vali Loss: 0.3675500 Best vali loss: 0.3665431
	iters: 100, epoch: 6 | loss: 0.8704553
	speed: 0.0071s/iter; left time: 10.1741s
	iters: 200, epoch: 6 | loss: 0.4420096
	speed: 0.0030s/iter; left time: 4.0430s
	iters: 300, epoch: 6 | loss: 0.7626171
	speed: 0.0031s/iter; left time: 3.8330s
	iters: 400, epoch: 6 | loss: 0.4863912
	speed: 0.0033s/iter; left time: 3.7559s
	iters: 500, epoch: 6 | loss: 0.2972594
	speed: 0.0030s/iter; left time: 3.1663s
Updating learning rate to 8.868891725e-06
Epoch: 6 cost time: 1.6353538036346436
Epoch: 6, Steps: 514 | Train Loss: 0.5717465 Vali Loss: 0.3678169 Best vali loss: 0.3665431
	iters: 100, epoch: 7 | loss: 0.6143810
	speed: 0.0068s/iter; left time: 6.3429s
	iters: 200, epoch: 7 | loss: 0.2880800
	speed: 0.0030s/iter; left time: 2.4968s
	iters: 300, epoch: 7 | loss: 0.6946396
	speed: 0.0031s/iter; left time: 2.2455s
	iters: 400, epoch: 7 | loss: 0.2989458
	speed: 0.0030s/iter; left time: 1.8834s
	iters: 500, epoch: 7 | loss: 0.7757173
	speed: 0.0031s/iter; left time: 1.6449s
Updating learning rate to 4.4344458625e-06
Epoch: 7 cost time: 1.617976427078247
Epoch: 7, Steps: 514 | Train Loss: 0.5343527 Vali Loss: 0.3678505 Best vali loss: 0.3665431
	iters: 100, epoch: 8 | loss: 0.6575679
	speed: 0.0070s/iter; left time: 2.9228s
	iters: 200, epoch: 8 | loss: 0.6737796
	speed: 0.0031s/iter; left time: 0.9837s
	iters: 300, epoch: 8 | loss: 1.1341482
	speed: 0.0031s/iter; left time: 0.6673s
	iters: 400, epoch: 8 | loss: 0.8970502
	speed: 0.0030s/iter; left time: 0.3412s
	iters: 500, epoch: 8 | loss: 0.6292602
	speed: 0.0030s/iter; left time: 0.0453s
Updating learning rate to 2.21722293125e-06
Epoch: 8 cost time: 1.625720739364624
Epoch: 8, Steps: 514 | Train Loss: 0.7983612 Vali Loss: 0.3679992 Best vali loss: 0.3665431

best validation loss 0.36654305838648604

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0065963307809, 'e_layers': 2, 'learning_rate': 0.0013347371292, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5671995
	speed: 0.0106s/iter; left time: 9.8936s
Updating learning rate to 0.0013347371292
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 0.9193921089172363
Epoch: 1, Steps: 129 | Train Loss: 0.5671995 Vali Loss: 0.3700567 Best vali loss: 0.3700567
	iters: 100, epoch: 2 | loss: 0.7764047
	speed: 0.0069s/iter; left time: 5.5651s
Updating learning rate to 0.0006673685646
Validation loss decreased (0.3701 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 0.5219902992248535
Epoch: 2, Steps: 129 | Train Loss: 0.7764047 Vali Loss: 0.3694200 Best vali loss: 0.3694200
	iters: 100, epoch: 3 | loss: 0.5962849
	speed: 0.0069s/iter; left time: 4.6652s
Updating learning rate to 0.0003336842823
Epoch: 3 cost time: 0.5396034717559814
Epoch: 3, Steps: 129 | Train Loss: 0.5962849 Vali Loss: 0.3743538 Best vali loss: 0.3694200
	iters: 100, epoch: 4 | loss: 0.7215830
	speed: 0.0067s/iter; left time: 3.6441s
Updating learning rate to 0.00016684214115
Epoch: 4 cost time: 0.5117864608764648
Epoch: 4, Steps: 129 | Train Loss: 0.7215830 Vali Loss: 0.3784182 Best vali loss: 0.3694200
	iters: 100, epoch: 5 | loss: 0.6600905
	speed: 0.0065s/iter; left time: 2.7192s
Updating learning rate to 8.3421070575e-05
Epoch: 5 cost time: 0.5114548206329346
Epoch: 5, Steps: 129 | Train Loss: 0.6600905 Vali Loss: 0.3824812 Best vali loss: 0.3694200
	iters: 100, epoch: 6 | loss: 0.4555004
	speed: 0.0067s/iter; left time: 1.9275s
Updating learning rate to 4.17105352875e-05
Epoch: 6 cost time: 0.5340967178344727
Epoch: 6, Steps: 129 | Train Loss: 0.4555004 Vali Loss: 0.3790269 Best vali loss: 0.3694200
	iters: 100, epoch: 7 | loss: 0.6092138
	speed: 0.0073s/iter; left time: 1.1576s
Updating learning rate to 2.085526764375e-05
Epoch: 7 cost time: 0.6016461849212646
Epoch: 7, Steps: 129 | Train Loss: 0.6092138 Vali Loss: 0.3815843 Best vali loss: 0.3694200
	iters: 100, epoch: 8 | loss: 0.6199411
	speed: 0.0075s/iter; left time: 0.2258s
Updating learning rate to 1.0427633821875e-05
Epoch: 8 cost time: 0.57037353515625
Epoch: 8, Steps: 129 | Train Loss: 0.6199411 Vali Loss: 0.3823301 Best vali loss: 0.3694200

best validation loss 0.3694200149102389

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003215246069, 'e_layers': 1, 'learning_rate': 6.74803521e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7687578
	speed: 0.0095s/iter; left time: 8.8254s
Updating learning rate to 6.74803521e-05
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 0.7563385963439941
Epoch: 1, Steps: 129 | Train Loss: 0.7687578 Vali Loss: 0.3710343 Best vali loss: 0.3710343
	iters: 100, epoch: 2 | loss: 0.5720776
	speed: 0.0061s/iter; left time: 4.8763s
Updating learning rate to 3.374017605e-05
Validation loss decreased (0.3710 --> 0.3652).  Saving model state dict ...
Epoch: 2 cost time: 0.465529203414917
Epoch: 2, Steps: 129 | Train Loss: 0.5720776 Vali Loss: 0.3652484 Best vali loss: 0.3652484
	iters: 100, epoch: 3 | loss: 0.5545793
	speed: 0.0060s/iter; left time: 4.0518s
Updating learning rate to 1.6870088025e-05
Epoch: 3 cost time: 0.4409503936767578
Epoch: 3, Steps: 129 | Train Loss: 0.5545793 Vali Loss: 0.3654037 Best vali loss: 0.3652484

best validation loss 0.3652484223041647

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0005326907184, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005326907184
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.0840368270874023
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3686568 Best vali loss: 0.3686568
Updating learning rate to 0.0002663453592
Validation loss decreased (0.3687 --> 0.3546).  Saving model state dict ...
Epoch: 2 cost time: 0.7766134738922119
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3545866 Best vali loss: 0.3545866
Updating learning rate to 0.0001331726796
Validation loss decreased (0.3546 --> 0.3545).  Saving model state dict ...
Epoch: 3 cost time: 0.7859594821929932
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3545403 Best vali loss: 0.3545403

best validation loss 0.35454031062735086

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002311730644, 'e_layers': 4, 'learning_rate': 0.0001838743134, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00017687601405241293
Validation loss decreased (inf --> 0.3632).  Saving model state dict ...
Epoch: 1 cost time: 1.109501600265503
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3632437 Best vali loss: 0.3632437
Updating learning rate to 0.00015694654364558022
Validation loss decreased (0.3632 --> 0.3559).  Saving model state dict ...
Epoch: 2 cost time: 0.794011116027832
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3559106 Best vali loss: 0.3559106
Updating learning rate to 0.00012711998338784313
Epoch: 3 cost time: 0.7899665832519531
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3607346 Best vali loss: 0.3559106

best validation loss 0.35591057715809415

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0005326907184, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.65863398e-05
Validation loss decreased (0.3545 --> 0.3493).  Saving model state dict ...
Epoch: 4 cost time: 1.095048189163208
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3493442 Best vali loss: 0.3493442
Updating learning rate to 3.32931699e-05
Validation loss decreased (0.3493 --> 0.3490).  Saving model state dict ...
Epoch: 5 cost time: 0.7845816612243652
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3490175 Best vali loss: 0.3490175
Updating learning rate to 1.664658495e-05
Epoch: 6 cost time: 0.7863295078277588
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3500740 Best vali loss: 0.3490175
Updating learning rate to 8.323292475e-06
Validation loss decreased (0.3490 --> 0.3456).  Saving model state dict ...
Epoch: 7 cost time: 0.7825326919555664
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3456310 Best vali loss: 0.3456310
Updating learning rate to 4.1616462375e-06
Validation loss decreased (0.3456 --> 0.3456).  Saving model state dict ...
Epoch: 8 cost time: 0.7845606803894043
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3456099 Best vali loss: 0.3456099

best validation loss 0.34560987917753944

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0001808281417, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00017394578035934035
Validation loss decreased (inf --> 0.3629).  Saving model state dict ...
Epoch: 1 cost time: 1.1113972663879395
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3629024 Best vali loss: 0.3629024
Updating learning rate to 0.00015434647346271595
Validation loss decreased (0.3629 --> 0.3555).  Saving model state dict ...
Epoch: 2 cost time: 0.7981855869293213
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3555414 Best vali loss: 0.3555414
Updating learning rate to 0.00012501403781697842
Epoch: 3 cost time: 0.7950379848480225
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3656608 Best vali loss: 0.3555414
Updating learning rate to 9.041407085e-05
Epoch: 4 cost time: 0.7958183288574219
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3664106 Best vali loss: 0.3555414
Updating learning rate to 5.5814103883021595e-05
Epoch: 5 cost time: 0.79012131690979
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3701973 Best vali loss: 0.3555414
Updating learning rate to 2.648166823728405e-05
Epoch: 6 cost time: 0.7972838878631592
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3729843 Best vali loss: 0.3555414
Updating learning rate to 6.8823613406596425e-06
Epoch: 7 cost time: 0.7950339317321777
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3603771 Best vali loss: 0.3555414
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8050105571746826
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3666121 Best vali loss: 0.3555414

best validation loss 0.35554139895148734

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023145853853, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.101893424987793
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715011 Best vali loss: 0.3715011
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3715 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 0.7833840847015381
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3623001 Best vali loss: 0.3623001
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7826247215270996
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3700546 Best vali loss: 0.3623001
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3623 --> 0.3531).  Saving model state dict ...
Epoch: 4 cost time: 0.788841962814331
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3530954 Best vali loss: 0.3530954
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3531 --> 0.3518).  Saving model state dict ...
Epoch: 5 cost time: 0.7897069454193115
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3518357 Best vali loss: 0.3518357
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3518 --> 0.3493).  Saving model state dict ...
Epoch: 6 cost time: 0.7937943935394287
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3493428 Best vali loss: 0.3493428
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7882025241851807
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3582489 Best vali loss: 0.3493428
Updating learning rate to 0.0
Epoch: 8 cost time: 0.790212869644165
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3582660 Best vali loss: 0.3493428

best validation loss 0.3493427674639202

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022137533557, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.1052830219268799
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711196 Best vali loss: 0.3711196
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.791499137878418
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3972407 Best vali loss: 0.3711196
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3711 --> 0.3608).  Saving model state dict ...
Epoch: 3 cost time: 0.7897074222564697
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3608332 Best vali loss: 0.3608332

best validation loss 0.36083315583952286

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.1088106632232666
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708986 Best vali loss: 0.3708986
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3709 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 0.7896034717559814
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3683148 Best vali loss: 0.3683148
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 0.7915785312652588
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3745520 Best vali loss: 0.3683148

best validation loss 0.36831481729603

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0006912793059, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006649690539348095
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.1188983917236328
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711318 Best vali loss: 0.3711318
Updating learning rate to 0.0005900437953979099
Validation loss decreased (0.3711 --> 0.3601).  Saving model state dict ...
Epoch: 2 cost time: 0.7989468574523926
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3600998 Best vali loss: 0.3600998
Updating learning rate to 0.0004779102217023845
Epoch: 3 cost time: 0.7950496673583984
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3723980 Best vali loss: 0.3600998

best validation loss 0.36009976616776995

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0006912793059, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00034563965295
Validation loss decreased (0.3601 --> 0.3477).  Saving model state dict ...
Epoch: 4 cost time: 1.1118719577789307
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3477097 Best vali loss: 0.3477097
Updating learning rate to 0.0002133690841976156
Epoch: 5 cost time: 0.7986283302307129
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3559827 Best vali loss: 0.3477097
Updating learning rate to 0.00010123551050209015
Epoch: 6 cost time: 0.8030521869659424
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3488860 Best vali loss: 0.3477097
Updating learning rate to 2.631025196519061e-05
Epoch: 7 cost time: 0.7932536602020264
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3552531 Best vali loss: 0.3477097
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8037724494934082
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3595867 Best vali loss: 0.3477097

best validation loss 0.34770974146827965

[INFO][smbo.py:320] Finished 550 trials.
{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022159833809, 'e_layers': 2, 'learning_rate': 0.0012799955396, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00123127861017109
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 0.7745990753173828
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715920 Best vali loss: 0.3715920
Updating learning rate to 0.0010925445327698469
Epoch: 2 cost time: 0.4510645866394043
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3808249 Best vali loss: 0.3715920
Updating learning rate to 0.0008849143130530666
Epoch: 3 cost time: 0.45084357261657715
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3892703 Best vali loss: 0.3715920
Updating learning rate to 0.0006399977698
Epoch: 4 cost time: 0.45731139183044434
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3969039 Best vali loss: 0.3715920
Updating learning rate to 0.00039508122654693343
Epoch: 5 cost time: 0.45487165451049805
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4013493 Best vali loss: 0.3715920
Updating learning rate to 0.00018745100683015303
Epoch: 6 cost time: 0.45218873023986816
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4212539 Best vali loss: 0.3715920
Updating learning rate to 4.871692942890989e-05
Epoch: 7 cost time: 0.46210527420043945
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4021948 Best vali loss: 0.3715920
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45270538330078125
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4130828 Best vali loss: 0.3715920

best validation loss 0.37159204201988716

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022159348224, 'e_layers': 2, 'learning_rate': 0.0012656636669, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0012174922118960464
Validation loss decreased (inf --> 0.3795).  Saving model state dict ...
Epoch: 1 cost time: 0.7615230083465576
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3794715 Best vali loss: 0.3794715
Updating learning rate to 0.001080311514233211
Epoch: 2 cost time: 0.4541008472442627
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3852554 Best vali loss: 0.3794715
Updating learning rate to 0.0008750060915845389
Epoch: 3 cost time: 0.44814610481262207
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3806726 Best vali loss: 0.3794715
Updating learning rate to 0.00063283183345
Epoch: 4 cost time: 0.44851088523864746
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3966070 Best vali loss: 0.3794715
Updating learning rate to 0.0003906575753154612
Epoch: 5 cost time: 0.45029759407043457
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3959115 Best vali loss: 0.3794715
Updating learning rate to 0.00018535215266678921
Epoch: 6 cost time: 0.4460141658782959
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4065464 Best vali loss: 0.3794715
Updating learning rate to 4.817145500395353e-05
Epoch: 7 cost time: 0.4503440856933594
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4017148 Best vali loss: 0.3794715
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45083045959472656
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4087972 Best vali loss: 0.3794715

best validation loss 0.37947149946553765

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0021723909937, 'e_layers': 2, 'learning_rate': 0.0013148927718, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.001264847645556527
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 0.7722938060760498
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3721016 Best vali loss: 0.3721016
Updating learning rate to 0.0011223311836364778
Epoch: 2 cost time: 0.4573225975036621
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3788822 Best vali loss: 0.3721016
Updating learning rate to 0.0009090402254522354
Epoch: 3 cost time: 0.45429444313049316
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3896977 Best vali loss: 0.3721016

best validation loss 0.3721015773376922

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022067961284, 'e_layers': 2, 'learning_rate': 0.0013027543285, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0012531711942458175
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 0.772979736328125
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3744093 Best vali loss: 0.3744093
Updating learning rate to 0.0011119703742012385
Epoch: 2 cost time: 0.4529557228088379
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3834461 Best vali loss: 0.3744093
Updating learning rate to 0.0009006484132294289
Validation loss decreased (0.3744 --> 0.3723).  Saving model state dict ...
Epoch: 3 cost time: 0.46187448501586914
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3723271 Best vali loss: 0.3723271

best validation loss 0.37232706725948683

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019614571595, 'e_layers': 4, 'learning_rate': 0.0012861533421, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0012861533421
Validation loss decreased (inf --> 0.3929).  Saving model state dict ...
Epoch: 1 cost time: 1.1069281101226807
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3929052 Best vali loss: 0.3929052
Updating learning rate to 0.00064307667105
Epoch: 2 cost time: 0.7798717021942139
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3961604 Best vali loss: 0.3929052
Updating learning rate to 0.000321538335525
Epoch: 3 cost time: 0.7775485515594482
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4091973 Best vali loss: 0.3929052

best validation loss 0.3929051713062878

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0021723909937, 'e_layers': 2, 'learning_rate': 0.0013148927718, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0006574463859
Epoch: 4 cost time: 0.773284912109375
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3923480 Best vali loss: 0.3721016
Updating learning rate to 0.00040585254634776467
Epoch: 5 cost time: 0.45034146308898926
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4016300 Best vali loss: 0.3721016
Updating learning rate to 0.00019256158816352226
Epoch: 6 cost time: 0.45662498474121094
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3933873 Best vali loss: 0.3721016
Updating learning rate to 5.0045126243472984e-05
Epoch: 7 cost time: 0.4519495964050293
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4112360 Best vali loss: 0.3721016
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45491814613342285
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4077628 Best vali loss: 0.3721016

best validation loss 0.3721015773376922

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0022137533557, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3815).  Saving model state dict ...
Epoch: 1 cost time: 1.1863842010498047
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3814618 Best vali loss: 0.3814618
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3815 --> 0.3788).  Saving model state dict ...
Epoch: 2 cost time: 0.8671963214874268
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3788202 Best vali loss: 0.3788202
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3788 --> 0.3749).  Saving model state dict ...
Epoch: 3 cost time: 0.8644678592681885
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3748711 Best vali loss: 0.3748711
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.869685173034668
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3752705 Best vali loss: 0.3748711
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.8649537563323975
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3798124 Best vali loss: 0.3748711
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.8681235313415527
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3815043 Best vali loss: 0.3748711
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.8667418956756592
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3772137 Best vali loss: 0.3748711
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.868415355682373
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3771659 Best vali loss: 0.3748711

best validation loss 0.3748710772026264

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.1201398372650146
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3670274 Best vali loss: 0.3670274
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3670 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.8014171123504639
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3650195 Best vali loss: 0.3650195
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3650 --> 0.3528).  Saving model state dict ...
Epoch: 3 cost time: 0.796555757522583
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3528020 Best vali loss: 0.3528020
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3528 --> 0.3460).  Saving model state dict ...
Epoch: 4 cost time: 0.7917499542236328
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3459896 Best vali loss: 0.3459896
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3460 --> 0.3444).  Saving model state dict ...
Epoch: 5 cost time: 0.7922914028167725
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3444101 Best vali loss: 0.3444101
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.8026986122131348
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3458352 Best vali loss: 0.3444101
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.800757646560669
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3456383 Best vali loss: 0.3444101
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7891898155212402
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3453017 Best vali loss: 0.3444101

best validation loss 0.3444101324015844

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3798).  Saving model state dict ...
Epoch: 1 cost time: 1.1855132579803467
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3797663 Best vali loss: 0.3797663
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3798 --> 0.3764).  Saving model state dict ...
Epoch: 2 cost time: 0.8728375434875488
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3763950 Best vali loss: 0.3763950
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 0.8728611469268799
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3827410 Best vali loss: 0.3763950

best validation loss 0.3763949788740904

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4805905
	speed: 0.0160s/iter; left time: 14.9314s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.3718).  Saving model state dict ...
Epoch: 1 cost time: 1.6203570365905762
Epoch: 1, Steps: 129 | Train Loss: 0.4805905 Vali Loss: 0.3717961 Best vali loss: 0.3717961
	iters: 100, epoch: 2 | loss: 0.5576029
	speed: 0.0157s/iter; left time: 12.6000s
Updating learning rate to 0.0001652515671
Validation loss decreased (0.3718 --> 0.3551).  Saving model state dict ...
Epoch: 2 cost time: 1.297576665878296
Epoch: 2, Steps: 129 | Train Loss: 0.5576029 Vali Loss: 0.3551259 Best vali loss: 0.3551259
	iters: 100, epoch: 3 | loss: 0.6214067
	speed: 0.0160s/iter; left time: 10.7712s
Updating learning rate to 8.262578355e-05
Validation loss decreased (0.3551 --> 0.3418).  Saving model state dict ...
Epoch: 3 cost time: 1.2957496643066406
Epoch: 3, Steps: 129 | Train Loss: 0.6214067 Vali Loss: 0.3418295 Best vali loss: 0.3418295

best validation loss 0.34182950410486906

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011318733269, 'e_layers': 4, 'learning_rate': 0.0003054614285, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4648314
	speed: 0.0159s/iter; left time: 14.7974s
Updating learning rate to 0.0003054614285
Validation loss decreased (inf --> 0.3614).  Saving model state dict ...
Epoch: 1 cost time: 1.6027653217315674
Epoch: 1, Steps: 129 | Train Loss: 0.4648314 Vali Loss: 0.3614157 Best vali loss: 0.3614157
	iters: 100, epoch: 2 | loss: 0.6186254
	speed: 0.0156s/iter; left time: 12.5777s
Updating learning rate to 0.00015273071425
Epoch: 2 cost time: 1.3027219772338867
Epoch: 2, Steps: 129 | Train Loss: 0.6186254 Vali Loss: 0.3835586 Best vali loss: 0.3614157
	iters: 100, epoch: 3 | loss: 0.6823980
	speed: 0.0154s/iter; left time: 10.4273s
Updating learning rate to 7.6365357125e-05
Epoch: 3 cost time: 1.299844741821289
Epoch: 3, Steps: 129 | Train Loss: 0.6823980 Vali Loss: 0.3667556 Best vali loss: 0.3614157

best validation loss 0.36141570899013453

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3630851
	speed: 0.0166s/iter; left time: 9.0881s
Updating learning rate to 4.1312891775e-05
Validation loss decreased (0.3418 --> 0.3384).  Saving model state dict ...
Epoch: 4 cost time: 1.6273374557495117
Epoch: 4, Steps: 129 | Train Loss: 0.3630851 Vali Loss: 0.3384446 Best vali loss: 0.3384446
	iters: 100, epoch: 5 | loss: 0.4474421
	speed: 0.0160s/iter; left time: 6.6590s
Updating learning rate to 2.06564458875e-05
Epoch: 5 cost time: 1.292999505996704
Epoch: 5, Steps: 129 | Train Loss: 0.4474421 Vali Loss: 0.3409518 Best vali loss: 0.3384446
	iters: 100, epoch: 6 | loss: 0.5482826
	speed: 0.0153s/iter; left time: 4.3941s
Updating learning rate to 1.032822294375e-05
Epoch: 6 cost time: 1.29642915725708
Epoch: 6, Steps: 129 | Train Loss: 0.5482826 Vali Loss: 0.3427480 Best vali loss: 0.3384446
	iters: 100, epoch: 7 | loss: 0.6019171
	speed: 0.0152s/iter; left time: 2.4231s
Updating learning rate to 5.164111471875e-06
Epoch: 7 cost time: 1.2908799648284912
Epoch: 7, Steps: 129 | Train Loss: 0.6019171 Vali Loss: 0.3436414 Best vali loss: 0.3384446
	iters: 100, epoch: 8 | loss: 0.4427246
	speed: 0.0152s/iter; left time: 0.4570s
Updating learning rate to 2.5820557359375e-06
Epoch: 8 cost time: 1.2918381690979004
Epoch: 8, Steps: 129 | Train Loss: 0.4427246 Vali Loss: 0.3420348 Best vali loss: 0.3384446

best validation loss 0.338444640067331

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011110559393, 'e_layers': 4, 'learning_rate': 0.00042829146, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4888312
	speed: 0.0159s/iter; left time: 14.8583s
Updating learning rate to 0.00042829146
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.611170768737793
Epoch: 1, Steps: 129 | Train Loss: 0.4888312 Vali Loss: 0.3696294 Best vali loss: 0.3696294
	iters: 100, epoch: 2 | loss: 0.5893588
	speed: 0.0157s/iter; left time: 12.6209s
Updating learning rate to 0.00021414573
Epoch: 2 cost time: 1.300961971282959
Epoch: 2, Steps: 129 | Train Loss: 0.5893588 Vali Loss: 0.3778900 Best vali loss: 0.3696294
	iters: 100, epoch: 3 | loss: 0.6956260
	speed: 0.0152s/iter; left time: 10.2555s
Updating learning rate to 0.000107072865
Epoch: 3 cost time: 1.294788122177124
Epoch: 3, Steps: 129 | Train Loss: 0.6956260 Vali Loss: 0.3742852 Best vali loss: 0.3696294
	iters: 100, epoch: 4 | loss: 0.6859649
	speed: 0.0154s/iter; left time: 8.3960s
Updating learning rate to 5.35364325e-05
Validation loss decreased (0.3696 --> 0.3483).  Saving model state dict ...
Epoch: 4 cost time: 1.3001611232757568
Epoch: 4, Steps: 129 | Train Loss: 0.6859649 Vali Loss: 0.3483468 Best vali loss: 0.3483468
	iters: 100, epoch: 5 | loss: 0.4721854
	speed: 0.0159s/iter; left time: 6.6459s
Updating learning rate to 2.676821625e-05
Epoch: 5 cost time: 1.306476354598999
Epoch: 5, Steps: 129 | Train Loss: 0.4721854 Vali Loss: 0.3495113 Best vali loss: 0.3483468
	iters: 100, epoch: 6 | loss: 0.3633539
	speed: 0.0154s/iter; left time: 4.4239s
Updating learning rate to 1.3384108125e-05
Epoch: 6 cost time: 1.3043527603149414
Epoch: 6, Steps: 129 | Train Loss: 0.3633539 Vali Loss: 0.3513637 Best vali loss: 0.3483468
	iters: 100, epoch: 7 | loss: 0.3867202
	speed: 0.0154s/iter; left time: 2.4494s
Updating learning rate to 6.6920540625e-06
Epoch: 7 cost time: 1.3144965171813965
Epoch: 7, Steps: 129 | Train Loss: 0.3867202 Vali Loss: 0.3498071 Best vali loss: 0.3483468
	iters: 100, epoch: 8 | loss: 0.4812503
	speed: 0.0154s/iter; left time: 0.4632s
Updating learning rate to 3.34602703125e-06
Validation loss decreased (0.3483 --> 0.3454).  Saving model state dict ...
Epoch: 8 cost time: 1.3056707382202148
Epoch: 8, Steps: 129 | Train Loss: 0.4812503 Vali Loss: 0.3454372 Best vali loss: 0.3454372

best validation loss 0.3454372251431928

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010640508297, 'e_layers': 4, 'learning_rate': 0.0003670208999, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4753080
	speed: 0.0159s/iter; left time: 14.8545s
Updating learning rate to 0.0003670208999
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 1.6093261241912842
Epoch: 1, Steps: 129 | Train Loss: 0.4753080 Vali Loss: 0.3693769 Best vali loss: 0.3693769
	iters: 100, epoch: 2 | loss: 0.6421521
	speed: 0.0157s/iter; left time: 12.6524s
Updating learning rate to 0.00018351044995
Epoch: 2 cost time: 1.3025002479553223
Epoch: 2, Steps: 129 | Train Loss: 0.6421521 Vali Loss: 0.3787207 Best vali loss: 0.3693769
	iters: 100, epoch: 3 | loss: 0.7624736
	speed: 0.0153s/iter; left time: 10.3394s
Updating learning rate to 9.1755224975e-05
Epoch: 3 cost time: 1.3006086349487305
Epoch: 3, Steps: 129 | Train Loss: 0.7624736 Vali Loss: 0.3729503 Best vali loss: 0.3693769
	iters: 100, epoch: 4 | loss: 0.6953943
	speed: 0.0154s/iter; left time: 8.4215s
Updating learning rate to 4.58776124875e-05
Epoch: 4 cost time: 1.3115653991699219
Epoch: 4, Steps: 129 | Train Loss: 0.6953943 Vali Loss: 0.3810063 Best vali loss: 0.3693769
	iters: 100, epoch: 5 | loss: 0.4861832
	speed: 0.0154s/iter; left time: 6.4422s
Updating learning rate to 2.293880624375e-05
Validation loss decreased (0.3694 --> 0.3642).  Saving model state dict ...
Epoch: 5 cost time: 1.3140158653259277
Epoch: 5, Steps: 129 | Train Loss: 0.4861832 Vali Loss: 0.3642248 Best vali loss: 0.3642248
	iters: 100, epoch: 6 | loss: 0.3766480
	speed: 0.0161s/iter; left time: 4.6426s
Updating learning rate to 1.1469403121875e-05
Validation loss decreased (0.3642 --> 0.3611).  Saving model state dict ...
Epoch: 6 cost time: 1.3139889240264893
Epoch: 6, Steps: 129 | Train Loss: 0.3766480 Vali Loss: 0.3610644 Best vali loss: 0.3610644
	iters: 100, epoch: 7 | loss: 0.4061276
	speed: 0.0160s/iter; left time: 2.5503s
Updating learning rate to 5.7347015609375e-06
Validation loss decreased (0.3611 --> 0.3595).  Saving model state dict ...
Epoch: 7 cost time: 1.3095347881317139
Epoch: 7, Steps: 129 | Train Loss: 0.4061276 Vali Loss: 0.3594921 Best vali loss: 0.3594921
	iters: 100, epoch: 8 | loss: 0.5069067
	speed: 0.0162s/iter; left time: 0.4857s
Updating learning rate to 2.86735078046875e-06
Validation loss decreased (0.3595 --> 0.3566).  Saving model state dict ...
Epoch: 8 cost time: 1.3145408630371094
Epoch: 8, Steps: 129 | Train Loss: 0.5069067 Vali Loss: 0.3565786 Best vali loss: 0.3565786

best validation loss 0.3565785638944105

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0093227210899, 'e_layers': 4, 'learning_rate': 0.0003900761827, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8420925
	speed: 0.0113s/iter; left time: 45.1681s
	iters: 200, epoch: 1 | loss: 0.6218739
	speed: 0.0052s/iter; left time: 20.3230s
	iters: 300, epoch: 1 | loss: 0.4072119
	speed: 0.0052s/iter; left time: 19.6900s
	iters: 400, epoch: 1 | loss: 0.5008250
	speed: 0.0051s/iter; left time: 19.0853s
	iters: 500, epoch: 1 | loss: 0.5674825
	speed: 0.0051s/iter; left time: 18.3374s
Updating learning rate to 0.0003900761827
Validation loss decreased (inf --> 0.3764).  Saving model state dict ...
Epoch: 1 cost time: 3.0045104026794434
Epoch: 1, Steps: 514 | Train Loss: 0.5878972 Vali Loss: 0.3764068 Best vali loss: 0.3764068
	iters: 100, epoch: 2 | loss: 0.3838574
	speed: 0.0099s/iter; left time: 34.7104s
	iters: 200, epoch: 2 | loss: 1.2004088
	speed: 0.0050s/iter; left time: 17.0330s
	iters: 300, epoch: 2 | loss: 0.6424665
	speed: 0.0051s/iter; left time: 16.7246s
	iters: 400, epoch: 2 | loss: 0.6148261
	speed: 0.0050s/iter; left time: 16.1534s
	iters: 500, epoch: 2 | loss: 0.9134445
	speed: 0.0053s/iter; left time: 16.4101s
Updating learning rate to 0.00019503809135
Epoch: 2 cost time: 2.6761014461517334
Epoch: 2, Steps: 514 | Train Loss: 0.7510007 Vali Loss: 0.3766630 Best vali loss: 0.3764068
	iters: 100, epoch: 3 | loss: 0.2759407
	speed: 0.0100s/iter; left time: 29.9799s
	iters: 200, epoch: 3 | loss: 1.0401336
	speed: 0.0051s/iter; left time: 14.6759s
	iters: 300, epoch: 3 | loss: 0.4876850
	speed: 0.0050s/iter; left time: 13.9637s
	iters: 400, epoch: 3 | loss: 0.8270628
	speed: 0.0050s/iter; left time: 13.5545s
	iters: 500, epoch: 3 | loss: 0.3877487
	speed: 0.0050s/iter; left time: 12.9399s
Updating learning rate to 9.7519045675e-05
Validation loss decreased (0.3764 --> 0.3470).  Saving model state dict ...
Epoch: 3 cost time: 2.6504690647125244
Epoch: 3, Steps: 514 | Train Loss: 0.6037142 Vali Loss: 0.3469531 Best vali loss: 0.3469531

best validation loss 0.3469531292589802

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0011156336553, 'e_layers': 2, 'learning_rate': 8.99020908e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5159885
	speed: 0.0092s/iter; left time: 74.8012s
	iters: 200, epoch: 1 | loss: 0.8959600
	speed: 0.0031s/iter; left time: 24.6389s
	iters: 300, epoch: 1 | loss: 0.6303961
	speed: 0.0031s/iter; left time: 24.2007s
	iters: 400, epoch: 1 | loss: 0.6940432
	speed: 0.0031s/iter; left time: 24.1323s
	iters: 500, epoch: 1 | loss: 0.3713079
	speed: 0.0031s/iter; left time: 23.7010s
	iters: 600, epoch: 1 | loss: 1.1854756
	speed: 0.0030s/iter; left time: 23.1205s
	iters: 700, epoch: 1 | loss: 0.8197402
	speed: 0.0030s/iter; left time: 22.8049s
	iters: 800, epoch: 1 | loss: 0.2943071
	speed: 0.0031s/iter; left time: 22.7725s
	iters: 900, epoch: 1 | loss: 0.4341408
	speed: 0.0032s/iter; left time: 23.5341s
	iters: 1000, epoch: 1 | loss: 0.5059561
	speed: 0.0032s/iter; left time: 23.4236s
Updating learning rate to 8.99020908e-05
Validation loss decreased (inf --> 0.3946).  Saving model state dict ...
Epoch: 1 cost time: 3.5363337993621826
Epoch: 1, Steps: 1027 | Train Loss: 0.6347316 Vali Loss: 0.3946128 Best vali loss: 0.3946128
	iters: 100, epoch: 2 | loss: 1.0671735
	speed: 0.0097s/iter; left time: 68.4928s
	iters: 200, epoch: 2 | loss: 0.2506887
	speed: 0.0035s/iter; left time: 24.1872s
	iters: 300, epoch: 2 | loss: 0.3517230
	speed: 0.0035s/iter; left time: 23.8191s
	iters: 400, epoch: 2 | loss: 0.2584378
	speed: 0.0035s/iter; left time: 23.5595s
	iters: 500, epoch: 2 | loss: 1.4301862
	speed: 0.0033s/iter; left time: 22.0672s
	iters: 600, epoch: 2 | loss: 1.1903210
	speed: 0.0032s/iter; left time: 21.3942s
	iters: 700, epoch: 2 | loss: 1.0141524
	speed: 0.0034s/iter; left time: 22.1937s
	iters: 800, epoch: 2 | loss: 0.3526097
	speed: 0.0034s/iter; left time: 21.6343s
	iters: 900, epoch: 2 | loss: 0.6210155
	speed: 0.0032s/iter; left time: 20.4336s
	iters: 1000, epoch: 2 | loss: 0.4050335
	speed: 0.0035s/iter; left time: 21.4226s
Updating learning rate to 4.49510454e-05
Validation loss decreased (0.3946 --> 0.3767).  Saving model state dict ...
Epoch: 2 cost time: 3.5194053649902344
Epoch: 2, Steps: 1027 | Train Loss: 0.6941341 Vali Loss: 0.3767426 Best vali loss: 0.3767426
	iters: 100, epoch: 3 | loss: 0.4276798
	speed: 0.0093s/iter; left time: 56.4551s
	iters: 200, epoch: 3 | loss: 0.5493841
	speed: 0.0031s/iter; left time: 18.2082s
	iters: 300, epoch: 3 | loss: 0.7652293
	speed: 0.0031s/iter; left time: 17.9200s
	iters: 400, epoch: 3 | loss: 0.3478655
	speed: 0.0031s/iter; left time: 17.7861s
	iters: 500, epoch: 3 | loss: 1.6897626
	speed: 0.0030s/iter; left time: 17.2245s
	iters: 600, epoch: 3 | loss: 0.8672779
	speed: 0.0030s/iter; left time: 16.8544s
	iters: 700, epoch: 3 | loss: 0.3754817
	speed: 0.0030s/iter; left time: 16.6223s
	iters: 800, epoch: 3 | loss: 0.6209975
	speed: 0.0031s/iter; left time: 16.5572s
	iters: 900, epoch: 3 | loss: 0.2755917
	speed: 0.0032s/iter; left time: 16.5827s
	iters: 1000, epoch: 3 | loss: 0.2918085
	speed: 0.0029s/iter; left time: 15.2077s
Updating learning rate to 2.24755227e-05
Validation loss decreased (0.3767 --> 0.3722).  Saving model state dict ...
Epoch: 3 cost time: 3.1815624237060547
Epoch: 3, Steps: 1027 | Train Loss: 0.6211079 Vali Loss: 0.3722434 Best vali loss: 0.3722434

best validation loss 0.37224337643630845

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010506966069, 'e_layers': 1, 'learning_rate': 0.0003343756695, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7572920
	speed: 0.0096s/iter; left time: 8.9432s
Updating learning rate to 0.0003216492533604043
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 0.7925746440887451
Epoch: 1, Steps: 129 | Train Loss: 0.7572920 Vali Loss: 0.3659434 Best vali loss: 0.3659434
	iters: 100, epoch: 2 | loss: 0.7055362
	speed: 0.0057s/iter; left time: 4.6227s
Updating learning rate to 0.0002854074864336209
Validation loss decreased (0.3659 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.42112112045288086
Epoch: 2, Steps: 129 | Train Loss: 0.7055362 Vali Loss: 0.3648152 Best vali loss: 0.3648152
	iters: 100, epoch: 3 | loss: 0.8176468
	speed: 0.0057s/iter; left time: 3.8463s
Updating learning rate to 0.00023116784920181746
Epoch: 3 cost time: 0.44004321098327637
Epoch: 3, Steps: 129 | Train Loss: 0.8176468 Vali Loss: 0.3677319 Best vali loss: 0.3648152

best validation loss 0.3648152162728937

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0093227210899, 'e_layers': 4, 'learning_rate': 0.0003900761827, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6526520
	speed: 0.0114s/iter; left time: 28.2553s
	iters: 200, epoch: 4 | loss: 0.5582408
	speed: 0.0052s/iter; left time: 12.2758s
	iters: 300, epoch: 4 | loss: 0.2989587
	speed: 0.0053s/iter; left time: 11.9439s
	iters: 400, epoch: 4 | loss: 0.3370872
	speed: 0.0052s/iter; left time: 11.3174s
	iters: 500, epoch: 4 | loss: 0.4182523
	speed: 0.0052s/iter; left time: 10.8575s
Updating learning rate to 4.87595228375e-05
Validation loss decreased (0.3470 --> 0.3454).  Saving model state dict ...
Epoch: 4 cost time: 3.028287649154663
Epoch: 4, Steps: 514 | Train Loss: 0.4530382 Vali Loss: 0.3453607 Best vali loss: 0.3453607
	iters: 100, epoch: 5 | loss: 0.3209029
	speed: 0.0103s/iter; left time: 20.2099s
	iters: 200, epoch: 5 | loss: 0.7266500
	speed: 0.0051s/iter; left time: 9.5053s
	iters: 300, epoch: 5 | loss: 0.4413193
	speed: 0.0051s/iter; left time: 9.0409s
	iters: 400, epoch: 5 | loss: 0.4053101
	speed: 0.0051s/iter; left time: 8.5114s
	iters: 500, epoch: 5 | loss: 0.4336841
	speed: 0.0053s/iter; left time: 8.1908s
Updating learning rate to 2.437976141875e-05
Epoch: 5 cost time: 2.7068021297454834
Epoch: 5, Steps: 514 | Train Loss: 0.4655733 Vali Loss: 0.3491323 Best vali loss: 0.3453607
	iters: 100, epoch: 6 | loss: 0.2449112
	speed: 0.0098s/iter; left time: 14.2024s
	iters: 200, epoch: 6 | loss: 0.7002187
	speed: 0.0048s/iter; left time: 6.3860s
	iters: 300, epoch: 6 | loss: 0.4653878
	speed: 0.0048s/iter; left time: 6.0153s
	iters: 400, epoch: 6 | loss: 0.6925383
	speed: 0.0049s/iter; left time: 5.5836s
	iters: 500, epoch: 6 | loss: 0.3344455
	speed: 0.0049s/iter; left time: 5.0974s
Updating learning rate to 1.2189880709375e-05
Epoch: 6 cost time: 2.5531413555145264
Epoch: 6, Steps: 514 | Train Loss: 0.4875003 Vali Loss: 0.3520780 Best vali loss: 0.3453607
	iters: 100, epoch: 7 | loss: 0.4788086
	speed: 0.0098s/iter; left time: 9.1471s
	iters: 200, epoch: 7 | loss: 0.7935571
	speed: 0.0048s/iter; left time: 3.9627s
	iters: 300, epoch: 7 | loss: 0.8274714
	speed: 0.0048s/iter; left time: 3.4982s
	iters: 400, epoch: 7 | loss: 0.3991558
	speed: 0.0049s/iter; left time: 3.0863s
	iters: 500, epoch: 7 | loss: 0.4324810
	speed: 0.0046s/iter; left time: 2.4344s
Updating learning rate to 6.0949403546875e-06
Epoch: 7 cost time: 2.507150411605835
Epoch: 7, Steps: 514 | Train Loss: 0.5862948 Vali Loss: 0.3496967 Best vali loss: 0.3453607
	iters: 100, epoch: 8 | loss: 0.5585251
	speed: 0.0101s/iter; left time: 4.1736s
	iters: 200, epoch: 8 | loss: 0.3440697
	speed: 0.0052s/iter; left time: 1.6483s
	iters: 300, epoch: 8 | loss: 0.5215403
	speed: 0.0052s/iter; left time: 1.1260s
	iters: 400, epoch: 8 | loss: 0.4699048
	speed: 0.0053s/iter; left time: 0.6090s
	iters: 500, epoch: 8 | loss: 0.3887842
	speed: 0.0052s/iter; left time: 0.0787s
Updating learning rate to 3.04747017734375e-06
Epoch: 8 cost time: 2.7460360527038574
Epoch: 8, Steps: 514 | Train Loss: 0.4565648 Vali Loss: 0.3503204 Best vali loss: 0.3453607

best validation loss 0.3453606887978514

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010393951495, 'e_layers': 1, 'learning_rate': 0.0003415985002, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7564046
	speed: 0.0097s/iter; left time: 9.0539s
Updating learning rate to 0.0003285971814356663
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 0.7916688919067383
Epoch: 1, Steps: 129 | Train Loss: 0.7564046 Vali Loss: 0.3658819 Best vali loss: 0.3658819
	iters: 100, epoch: 2 | loss: 0.7052593
	speed: 0.0061s/iter; left time: 4.8662s
Updating learning rate to 0.0002915725580672871
Validation loss decreased (0.3659 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.45644378662109375
Epoch: 2, Steps: 129 | Train Loss: 0.7052593 Vali Loss: 0.3650344 Best vali loss: 0.3650344
	iters: 100, epoch: 3 | loss: 0.8193521
	speed: 0.0059s/iter; left time: 3.9510s
Updating learning rate to 0.0002361612933736514
Epoch: 3 cost time: 0.4493718147277832
Epoch: 3, Steps: 129 | Train Loss: 0.8193521 Vali Loss: 0.3677418 Best vali loss: 0.3650344
	iters: 100, epoch: 4 | loss: 0.6067744
	speed: 0.0057s/iter; left time: 3.1339s
Updating learning rate to 0.0001707992501
Epoch: 4 cost time: 0.4201231002807617
Epoch: 4, Steps: 129 | Train Loss: 0.6067744 Vali Loss: 0.3724717 Best vali loss: 0.3650344
	iters: 100, epoch: 5 | loss: 0.6042911
	speed: 0.0059s/iter; left time: 2.4622s
Updating learning rate to 0.00010543720682634861
Epoch: 5 cost time: 0.46700620651245117
Epoch: 5, Steps: 129 | Train Loss: 0.6042911 Vali Loss: 0.3735287 Best vali loss: 0.3650344
	iters: 100, epoch: 6 | loss: 0.6313974
	speed: 0.0059s/iter; left time: 1.6991s
Updating learning rate to 5.0025942132712905e-05
Epoch: 6 cost time: 0.4384348392486572
Epoch: 6, Steps: 129 | Train Loss: 0.6313974 Vali Loss: 0.3828003 Best vali loss: 0.3650344
	iters: 100, epoch: 7 | loss: 0.7580851
	speed: 0.0057s/iter; left time: 0.9047s
Updating learning rate to 1.3001318764333656e-05
Epoch: 7 cost time: 0.4206993579864502
Epoch: 7, Steps: 129 | Train Loss: 0.7580851 Vali Loss: 0.3800969 Best vali loss: 0.3650344
	iters: 100, epoch: 8 | loss: 0.6592325
	speed: 0.0056s/iter; left time: 0.1690s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4186546802520752
Epoch: 8, Steps: 129 | Train Loss: 0.6592325 Vali Loss: 0.3794807 Best vali loss: 0.3650344

best validation loss 0.36503440231845985

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010517383018, 'e_layers': 4, 'learning_rate': 6.27407443e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7754553
	speed: 0.0126s/iter; left time: 11.7098s
Updating learning rate to 6.27407443e-05
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 1.1809544563293457
Epoch: 1, Steps: 129 | Train Loss: 0.7754553 Vali Loss: 0.3701451 Best vali loss: 0.3701451
	iters: 100, epoch: 2 | loss: 0.6797878
	speed: 0.0102s/iter; left time: 8.1743s
Updating learning rate to 3.137037215e-05
Validation loss decreased (0.3701 --> 0.3634).  Saving model state dict ...
Epoch: 2 cost time: 0.8438901901245117
Epoch: 2, Steps: 129 | Train Loss: 0.6797878 Vali Loss: 0.3633645 Best vali loss: 0.3633645
	iters: 100, epoch: 3 | loss: 0.7850491
	speed: 0.0105s/iter; left time: 7.0820s
Updating learning rate to 1.5685186075e-05
Validation loss decreased (0.3634 --> 0.3624).  Saving model state dict ...
Epoch: 3 cost time: 0.85410475730896
Epoch: 3, Steps: 129 | Train Loss: 0.7850491 Vali Loss: 0.3623557 Best vali loss: 0.3623557
	iters: 100, epoch: 4 | loss: 0.3536736
	speed: 0.0105s/iter; left time: 5.7540s
Updating learning rate to 7.8425930375e-06
Epoch: 4 cost time: 0.8649985790252686
Epoch: 4, Steps: 129 | Train Loss: 0.3536736 Vali Loss: 0.3644743 Best vali loss: 0.3623557
	iters: 100, epoch: 5 | loss: 0.8660211
	speed: 0.0104s/iter; left time: 4.3399s
Updating learning rate to 3.92129651875e-06
Epoch: 5 cost time: 0.8713474273681641
Epoch: 5, Steps: 129 | Train Loss: 0.8660211 Vali Loss: 0.3638428 Best vali loss: 0.3623557
	iters: 100, epoch: 6 | loss: 0.4461512
	speed: 0.0103s/iter; left time: 2.9679s
Updating learning rate to 1.960648259375e-06
Epoch: 6 cost time: 0.8569426536560059
Epoch: 6, Steps: 129 | Train Loss: 0.4461512 Vali Loss: 0.3634546 Best vali loss: 0.3623557
	iters: 100, epoch: 7 | loss: 0.4808246
	speed: 0.0102s/iter; left time: 1.6203s
Updating learning rate to 9.803241296875e-07
Epoch: 7 cost time: 0.8472404479980469
Epoch: 7, Steps: 129 | Train Loss: 0.4808246 Vali Loss: 0.3636426 Best vali loss: 0.3623557
	iters: 100, epoch: 8 | loss: 0.6862134
	speed: 0.0101s/iter; left time: 0.3032s
Updating learning rate to 4.9016206484375e-07
Epoch: 8 cost time: 0.8444151878356934
Epoch: 8, Steps: 129 | Train Loss: 0.6862134 Vali Loss: 0.3636651 Best vali loss: 0.3623557

best validation loss 0.36235573650109043

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009553982022, 'e_layers': 3, 'learning_rate': 0.0003417615917, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6500852
	speed: 0.0137s/iter; left time: 12.7394s
Updating learning rate to 0.0003417615917
Validation loss decreased (inf --> 0.3652).  Saving model state dict ...
Epoch: 1 cost time: 1.313450813293457
Epoch: 1, Steps: 129 | Train Loss: 0.6500852 Vali Loss: 0.3652124 Best vali loss: 0.3652124
	iters: 100, epoch: 2 | loss: 0.4887944
	speed: 0.0123s/iter; left time: 9.9141s
Updating learning rate to 0.00017088079585
Epoch: 2 cost time: 1.0056378841400146
Epoch: 2, Steps: 129 | Train Loss: 0.4887944 Vali Loss: 0.3690863 Best vali loss: 0.3652124
	iters: 100, epoch: 3 | loss: 0.4379060
	speed: 0.0120s/iter; left time: 8.1017s
Updating learning rate to 8.5440397925e-05
Validation loss decreased (0.3652 --> 0.3499).  Saving model state dict ...
Epoch: 3 cost time: 1.0036258697509766
Epoch: 3, Steps: 129 | Train Loss: 0.4379060 Vali Loss: 0.3499455 Best vali loss: 0.3499455

best validation loss 0.34994551001925367

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008840804406, 'e_layers': 3, 'learning_rate': 0.0003382852371, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6499751
	speed: 0.0135s/iter; left time: 12.6266s
Updating learning rate to 0.0003254100219037089
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.3082685470581055
Epoch: 1, Steps: 129 | Train Loss: 0.6499751 Vali Loss: 0.3654762 Best vali loss: 0.3654762
	iters: 100, epoch: 2 | loss: 0.4959324
	speed: 0.0123s/iter; left time: 9.9010s
Updating learning rate to 0.0002887445111143545
Epoch: 2 cost time: 1.002047061920166
Epoch: 2, Steps: 129 | Train Loss: 0.4959324 Vali Loss: 0.3689465 Best vali loss: 0.3654762
	iters: 100, epoch: 3 | loss: 0.4328035
	speed: 0.0120s/iter; left time: 8.1275s
Updating learning rate to 0.00023387069637593314
Epoch: 3 cost time: 1.0016438961029053
Epoch: 3, Steps: 129 | Train Loss: 0.4328035 Vali Loss: 0.3700965 Best vali loss: 0.3654762

best validation loss 0.36547621109162426

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009497331212, 'e_layers': 3, 'learning_rate': 0.0003378807452, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6497182
	speed: 0.0137s/iter; left time: 12.7591s
Updating learning rate to 0.0003250209250599706
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 1.3320050239562988
Epoch: 1, Steps: 129 | Train Loss: 0.6497182 Vali Loss: 0.3657479 Best vali loss: 0.3657479
	iters: 100, epoch: 2 | loss: 0.5043464
	speed: 0.0125s/iter; left time: 10.0484s
Updating learning rate to 0.000288399255681642
Epoch: 2 cost time: 1.006272792816162
Epoch: 2, Steps: 129 | Train Loss: 0.5043464 Vali Loss: 0.3754179 Best vali loss: 0.3657479
	iters: 100, epoch: 3 | loss: 0.4341752
	speed: 0.0121s/iter; left time: 8.1343s
Updating learning rate to 0.00023359105425160517
Validation loss decreased (0.3657 --> 0.3643).  Saving model state dict ...
Epoch: 3 cost time: 1.0028221607208252
Epoch: 3, Steps: 129 | Train Loss: 0.4341752 Vali Loss: 0.3642510 Best vali loss: 0.3642510

best validation loss 0.3642509650036488

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009553982022, 'e_layers': 3, 'learning_rate': 0.0003417615917, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4734642
	speed: 0.0141s/iter; left time: 7.6987s
Updating learning rate to 4.27201989625e-05
Epoch: 4 cost time: 1.3276355266571045
Epoch: 4, Steps: 129 | Train Loss: 0.4734642 Vali Loss: 0.3507315 Best vali loss: 0.3499455
	iters: 100, epoch: 5 | loss: 0.3976584
	speed: 0.0120s/iter; left time: 5.0006s
Updating learning rate to 2.136009948125e-05
Validation loss decreased (0.3499 --> 0.3455).  Saving model state dict ...
Epoch: 5 cost time: 1.003948450088501
Epoch: 5, Steps: 129 | Train Loss: 0.3976584 Vali Loss: 0.3455414 Best vali loss: 0.3455414
	iters: 100, epoch: 6 | loss: 0.4144322
	speed: 0.0126s/iter; left time: 3.6413s
Updating learning rate to 1.0680049740625e-05
Epoch: 6 cost time: 1.01008939743042
Epoch: 6, Steps: 129 | Train Loss: 0.4144322 Vali Loss: 0.3484618 Best vali loss: 0.3455414
	iters: 100, epoch: 7 | loss: 0.4251304
	speed: 0.0120s/iter; left time: 1.9127s
Updating learning rate to 5.3400248703125e-06
Epoch: 7 cost time: 1.0059049129486084
Epoch: 7, Steps: 129 | Train Loss: 0.4251304 Vali Loss: 0.3462511 Best vali loss: 0.3455414
	iters: 100, epoch: 8 | loss: 0.4546978
	speed: 0.0121s/iter; left time: 0.3639s
Updating learning rate to 2.67001243515625e-06
Validation loss decreased (0.3455 --> 0.3455).  Saving model state dict ...
Epoch: 8 cost time: 1.0033926963806152
Epoch: 8, Steps: 129 | Train Loss: 0.4546978 Vali Loss: 0.3455219 Best vali loss: 0.3455219

best validation loss 0.3455218870068346

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010390353434, 'e_layers': 4, 'learning_rate': 0.0006744454684, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7275023
	speed: 0.0126s/iter; left time: 11.7911s
Updating learning rate to 0.0006487759162248738
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.1789042949676514
Epoch: 1, Steps: 129 | Train Loss: 0.7275023 Vali Loss: 0.3714235 Best vali loss: 0.3714235
	iters: 100, epoch: 2 | loss: 0.6667849
	speed: 0.0102s/iter; left time: 8.2280s
Updating learning rate to 0.0005756752163230887
Validation loss decreased (0.3714 --> 0.3705).  Saving model state dict ...
Epoch: 2 cost time: 0.8463411331176758
Epoch: 2, Steps: 129 | Train Loss: 0.6667849 Vali Loss: 0.3704716 Best vali loss: 0.3704716
	iters: 100, epoch: 3 | loss: 0.7315924
	speed: 0.0103s/iter; left time: 6.9614s
Updating learning rate to 0.00046627228759519635
Epoch: 3 cost time: 0.8456728458404541
Epoch: 3, Steps: 129 | Train Loss: 0.7315924 Vali Loss: 0.3811325 Best vali loss: 0.3704716
	iters: 100, epoch: 4 | loss: 0.3039632
	speed: 0.0101s/iter; left time: 5.5280s
Updating learning rate to 0.0003372227342
Epoch: 4 cost time: 0.8484580516815186
Epoch: 4, Steps: 129 | Train Loss: 0.3039632 Vali Loss: 0.3729268 Best vali loss: 0.3704716
	iters: 100, epoch: 5 | loss: 0.7636387
	speed: 0.0101s/iter; left time: 4.2091s
Updating learning rate to 0.00020817318080480367
Validation loss decreased (0.3705 --> 0.3479).  Saving model state dict ...
Epoch: 5 cost time: 0.8444981575012207
Epoch: 5, Steps: 129 | Train Loss: 0.7636387 Vali Loss: 0.3479172 Best vali loss: 0.3479172
	iters: 100, epoch: 6 | loss: 0.3556507
	speed: 0.0103s/iter; left time: 2.9647s
Updating learning rate to 9.877025207691134e-05
Epoch: 6 cost time: 0.837440013885498
Epoch: 6, Steps: 129 | Train Loss: 0.3556507 Vali Loss: 0.3484238 Best vali loss: 0.3479172
	iters: 100, epoch: 7 | loss: 0.3683482
	speed: 0.0103s/iter; left time: 1.6373s
Updating learning rate to 2.5669552175126092e-05
Epoch: 7 cost time: 0.8615376949310303
Epoch: 7, Steps: 129 | Train Loss: 0.3683482 Vali Loss: 0.3517622 Best vali loss: 0.3479172
	iters: 100, epoch: 8 | loss: 0.4764834
	speed: 0.0103s/iter; left time: 0.3082s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.857374906539917
Epoch: 8, Steps: 129 | Train Loss: 0.4764834 Vali Loss: 0.3531310 Best vali loss: 0.3479172

best validation loss 0.3479171999311166

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0021291790287, 'e_layers': 3, 'learning_rate': 0.0013387707735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3836771
	speed: 0.0102s/iter; left time: 83.1226s
	iters: 200, epoch: 1 | loss: 0.4179632
	speed: 0.0041s/iter; left time: 32.4726s
	iters: 300, epoch: 1 | loss: 0.7996780
	speed: 0.0041s/iter; left time: 32.1478s
	iters: 400, epoch: 1 | loss: 0.6462294
	speed: 0.0042s/iter; left time: 32.6147s
	iters: 500, epoch: 1 | loss: 0.4142459
	speed: 0.0041s/iter; left time: 31.8484s
	iters: 600, epoch: 1 | loss: 0.2903623
	speed: 0.0042s/iter; left time: 31.6567s
	iters: 700, epoch: 1 | loss: 0.4671213
	speed: 0.0042s/iter; left time: 31.2940s
	iters: 800, epoch: 1 | loss: 0.3384207
	speed: 0.0042s/iter; left time: 30.9937s
	iters: 900, epoch: 1 | loss: 0.5326164
	speed: 0.0042s/iter; left time: 30.4601s
	iters: 1000, epoch: 1 | loss: 1.0750871
	speed: 0.0041s/iter; left time: 29.7296s
Updating learning rate to 0.0012878168449304767
Validation loss decreased (inf --> 0.3905).  Saving model state dict ...
Epoch: 1 cost time: 4.5894365310668945
Epoch: 1, Steps: 1027 | Train Loss: 0.5365402 Vali Loss: 0.3904568 Best vali loss: 0.3904568
	iters: 100, epoch: 2 | loss: 0.3325699
	speed: 0.0112s/iter; left time: 79.7164s
	iters: 200, epoch: 2 | loss: 1.3236191
	speed: 0.0041s/iter; left time: 28.5073s
	iters: 300, epoch: 2 | loss: 0.3101892
	speed: 0.0041s/iter; left time: 27.9868s
	iters: 400, epoch: 2 | loss: 0.5570256
	speed: 0.0041s/iter; left time: 27.9483s
	iters: 500, epoch: 2 | loss: 0.3059841
	speed: 0.0041s/iter; left time: 27.3012s
	iters: 600, epoch: 2 | loss: 0.3249778
	speed: 0.0041s/iter; left time: 27.0045s
	iters: 700, epoch: 2 | loss: 1.3447157
	speed: 0.0042s/iter; left time: 26.9979s
	iters: 800, epoch: 2 | loss: 0.6022990
	speed: 0.0041s/iter; left time: 26.3105s
	iters: 900, epoch: 2 | loss: 0.5589091
	speed: 0.0042s/iter; left time: 26.1481s
	iters: 1000, epoch: 2 | loss: 0.9441253
	speed: 0.0042s/iter; left time: 25.9273s
Updating learning rate to 0.0011427123329481046
Validation loss decreased (0.3905 --> 0.3802).  Saving model state dict ...
Epoch: 2 cost time: 4.2707414627075195
Epoch: 2, Steps: 1027 | Train Loss: 0.6604415 Vali Loss: 0.3802050 Best vali loss: 0.3802050
	iters: 100, epoch: 3 | loss: 0.6825900
	speed: 0.0106s/iter; left time: 64.3537s
	iters: 200, epoch: 3 | loss: 0.2314118
	speed: 0.0036s/iter; left time: 21.6695s
	iters: 300, epoch: 3 | loss: 0.7394619
	speed: 0.0037s/iter; left time: 21.7629s
	iters: 400, epoch: 3 | loss: 1.6194210
	speed: 0.0036s/iter; left time: 20.7206s
	iters: 500, epoch: 3 | loss: 0.8926330
	speed: 0.0035s/iter; left time: 19.7700s
	iters: 600, epoch: 3 | loss: 0.3049015
	speed: 0.0035s/iter; left time: 19.5750s
	iters: 700, epoch: 3 | loss: 0.8601962
	speed: 0.0036s/iter; left time: 19.7720s
	iters: 800, epoch: 3 | loss: 1.0745780
	speed: 0.0036s/iter; left time: 19.0584s
	iters: 900, epoch: 3 | loss: 0.4796332
	speed: 0.0035s/iter; left time: 18.4969s
	iters: 1000, epoch: 3 | loss: 0.5126593
	speed: 0.0036s/iter; left time: 18.5160s
Updating learning rate to 0.0009255480841265231
Validation loss decreased (0.3802 --> 0.3786).  Saving model state dict ...
Epoch: 3 cost time: 3.7190146446228027
Epoch: 3, Steps: 1027 | Train Loss: 0.7397486 Vali Loss: 0.3786095 Best vali loss: 0.3786095
	iters: 100, epoch: 4 | loss: 1.5746090
	speed: 0.0104s/iter; left time: 52.5718s
	iters: 200, epoch: 4 | loss: 0.1598803
	speed: 0.0035s/iter; left time: 17.2156s
	iters: 300, epoch: 4 | loss: 1.1461468
	speed: 0.0035s/iter; left time: 16.9381s
	iters: 400, epoch: 4 | loss: 0.3834594
	speed: 0.0035s/iter; left time: 16.7696s
	iters: 500, epoch: 4 | loss: 0.2345716
	speed: 0.0035s/iter; left time: 16.2859s
	iters: 600, epoch: 4 | loss: 0.6933327
	speed: 0.0037s/iter; left time: 16.6304s
	iters: 700, epoch: 4 | loss: 0.4278818
	speed: 0.0038s/iter; left time: 16.8022s
	iters: 800, epoch: 4 | loss: 0.7147444
	speed: 0.0038s/iter; left time: 16.5352s
	iters: 900, epoch: 4 | loss: 0.9170353
	speed: 0.0038s/iter; left time: 16.1402s
	iters: 1000, epoch: 4 | loss: 0.9454598
	speed: 0.0037s/iter; left time: 15.3730s
Updating learning rate to 0.00066938538675
Validation loss decreased (0.3786 --> 0.3718).  Saving model state dict ...
Epoch: 4 cost time: 3.7965281009674072
Epoch: 4, Steps: 1027 | Train Loss: 0.7197121 Vali Loss: 0.3717600 Best vali loss: 0.3717600
	iters: 100, epoch: 5 | loss: 0.3682670
	speed: 0.0106s/iter; left time: 42.4173s
	iters: 200, epoch: 5 | loss: 0.8366030
	speed: 0.0036s/iter; left time: 14.1462s
	iters: 300, epoch: 5 | loss: 0.9227372
	speed: 0.0040s/iter; left time: 15.1161s
	iters: 400, epoch: 5 | loss: 1.1954585
	speed: 0.0040s/iter; left time: 14.7916s
	iters: 500, epoch: 5 | loss: 0.5356193
	speed: 0.0040s/iter; left time: 14.4389s
	iters: 600, epoch: 5 | loss: 0.2726184
	speed: 0.0040s/iter; left time: 13.9770s
	iters: 700, epoch: 5 | loss: 0.3228881
	speed: 0.0040s/iter; left time: 13.6257s
	iters: 800, epoch: 5 | loss: 0.2431761
	speed: 0.0040s/iter; left time: 13.2093s
	iters: 900, epoch: 5 | loss: 0.3415560
	speed: 0.0042s/iter; left time: 13.5019s
	iters: 1000, epoch: 5 | loss: 0.8943543
	speed: 0.0043s/iter; left time: 13.2666s
Updating learning rate to 0.0004132226893734769
Epoch: 5 cost time: 4.147262811660767
Epoch: 5, Steps: 1027 | Train Loss: 0.5933278 Vali Loss: 0.3865971 Best vali loss: 0.3717600
	iters: 100, epoch: 6 | loss: 0.2880888
	speed: 0.0114s/iter; left time: 34.1210s
	iters: 200, epoch: 6 | loss: 0.9357023
	speed: 0.0042s/iter; left time: 12.0030s
	iters: 300, epoch: 6 | loss: 0.8227763
	speed: 0.0042s/iter; left time: 11.5925s
	iters: 400, epoch: 6 | loss: 0.6042324
	speed: 0.0042s/iter; left time: 11.1821s
	iters: 500, epoch: 6 | loss: 0.3166649
	speed: 0.0042s/iter; left time: 10.7452s
	iters: 600, epoch: 6 | loss: 0.2732379
	speed: 0.0042s/iter; left time: 10.3448s
	iters: 700, epoch: 6 | loss: 0.8542284
	speed: 0.0042s/iter; left time: 9.9321s
	iters: 800, epoch: 6 | loss: 0.3257160
	speed: 0.0042s/iter; left time: 9.5104s
	iters: 900, epoch: 6 | loss: 1.1279886
	speed: 0.0042s/iter; left time: 9.1252s
	iters: 1000, epoch: 6 | loss: 0.5689733
	speed: 0.0042s/iter; left time: 8.7338s
Updating learning rate to 0.0001960584405518953
Epoch: 6 cost time: 4.326387643814087
Epoch: 6, Steps: 1027 | Train Loss: 0.6117609 Vali Loss: 0.3939477 Best vali loss: 0.3717600
	iters: 100, epoch: 7 | loss: 0.3450547
	speed: 0.0112s/iter; left time: 21.9876s
	iters: 200, epoch: 7 | loss: 0.4913689
	speed: 0.0042s/iter; left time: 7.8042s
	iters: 300, epoch: 7 | loss: 0.3221321
	speed: 0.0042s/iter; left time: 7.3368s
	iters: 400, epoch: 7 | loss: 0.5291612
	speed: 0.0042s/iter; left time: 6.8837s
	iters: 500, epoch: 7 | loss: 0.2998575
	speed: 0.0042s/iter; left time: 6.4960s
	iters: 600, epoch: 7 | loss: 0.2951613
	speed: 0.0042s/iter; left time: 6.1024s
	iters: 700, epoch: 7 | loss: 0.4330583
	speed: 0.0042s/iter; left time: 5.7207s
	iters: 800, epoch: 7 | loss: 0.4492806
	speed: 0.0042s/iter; left time: 5.3106s
	iters: 900, epoch: 7 | loss: 1.0665028
	speed: 0.0042s/iter; left time: 4.8794s
	iters: 1000, epoch: 7 | loss: 0.8421001
	speed: 0.0043s/iter; left time: 4.4851s
Updating learning rate to 5.0953928569523124e-05
Epoch: 7 cost time: 4.362792253494263
Epoch: 7, Steps: 1027 | Train Loss: 0.5073678 Vali Loss: 0.3977533 Best vali loss: 0.3717600
	iters: 100, epoch: 8 | loss: 0.2559154
	speed: 0.0112s/iter; left time: 10.4247s
	iters: 200, epoch: 8 | loss: 0.9029275
	speed: 0.0042s/iter; left time: 3.4500s
	iters: 300, epoch: 8 | loss: 0.9737551
	speed: 0.0042s/iter; left time: 3.0342s
	iters: 400, epoch: 8 | loss: 0.3499149
	speed: 0.0042s/iter; left time: 2.6191s
	iters: 500, epoch: 8 | loss: 0.2730352
	speed: 0.0042s/iter; left time: 2.1991s
	iters: 600, epoch: 8 | loss: 0.6490484
	speed: 0.0041s/iter; left time: 1.7682s
	iters: 700, epoch: 8 | loss: 0.2556024
	speed: 0.0042s/iter; left time: 1.3668s
	iters: 800, epoch: 8 | loss: 0.2443116
	speed: 0.0042s/iter; left time: 0.9470s
	iters: 900, epoch: 8 | loss: 0.4763366
	speed: 0.0042s/iter; left time: 0.5346s
	iters: 1000, epoch: 8 | loss: 0.1785570
	speed: 0.0042s/iter; left time: 0.1176s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.330136299133301
Epoch: 8, Steps: 1027 | Train Loss: 0.4559404 Vali Loss: 0.4050362 Best vali loss: 0.3717600

best validation loss 0.3717599938332683

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0116402429796, 'e_layers': 2, 'learning_rate': 0.0040837868501, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5702540
	speed: 0.0101s/iter; left time: 19.6999s
	iters: 200, epoch: 1 | loss: 0.6586747
	speed: 0.0037s/iter; left time: 6.8936s
Updating learning rate to 0.0040837868501
Validation loss decreased (inf --> 0.3971).  Saving model state dict ...
Epoch: 1 cost time: 1.3017406463623047
Epoch: 1, Steps: 257 | Train Loss: 0.6144643 Vali Loss: 0.3971322 Best vali loss: 0.3971322
	iters: 100, epoch: 2 | loss: 0.4399651
	speed: 0.0081s/iter; left time: 13.7273s
	iters: 200, epoch: 2 | loss: 0.6492404
	speed: 0.0034s/iter; left time: 5.4614s
Updating learning rate to 0.00204189342505
Epoch: 2 cost time: 0.9342899322509766
Epoch: 2, Steps: 257 | Train Loss: 0.5446028 Vali Loss: 0.4021643 Best vali loss: 0.3971322
	iters: 100, epoch: 3 | loss: 0.7804759
	speed: 0.0080s/iter; left time: 11.5450s
	iters: 200, epoch: 3 | loss: 0.7228159
	speed: 0.0037s/iter; left time: 5.0139s
Updating learning rate to 0.001020946712525
Epoch: 3 cost time: 0.9913597106933594
Epoch: 3, Steps: 257 | Train Loss: 0.7516459 Vali Loss: 0.4039852 Best vali loss: 0.3971322

best validation loss 0.3971321506326934

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0083165735636, 'e_layers': 4, 'learning_rate': 0.0034006305243, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9248593
	speed: 0.0114s/iter; left time: 92.5116s
	iters: 200, epoch: 1 | loss: 0.2770071
	speed: 0.0051s/iter; left time: 40.9503s
	iters: 300, epoch: 1 | loss: 1.2925160
	speed: 0.0052s/iter; left time: 41.0421s
	iters: 400, epoch: 1 | loss: 0.5233625
	speed: 0.0049s/iter; left time: 38.1327s
	iters: 500, epoch: 1 | loss: 1.3611358
	speed: 0.0047s/iter; left time: 36.5564s
	iters: 600, epoch: 1 | loss: 1.3457508
	speed: 0.0047s/iter; left time: 35.9766s
	iters: 700, epoch: 1 | loss: 0.4770893
	speed: 0.0046s/iter; left time: 34.2209s
	iters: 800, epoch: 1 | loss: 0.4604504
	speed: 0.0045s/iter; left time: 33.4976s
	iters: 900, epoch: 1 | loss: 0.3796329
	speed: 0.0045s/iter; left time: 32.8381s
	iters: 1000, epoch: 1 | loss: 0.4943702
	speed: 0.0045s/iter; left time: 32.8305s
Updating learning rate to 0.003271201731666948
Validation loss decreased (inf --> 0.4020).  Saving model state dict ...
Epoch: 1 cost time: 5.2677435874938965
Epoch: 1, Steps: 1027 | Train Loss: 0.7536174 Vali Loss: 0.4020357 Best vali loss: 0.4020357
	iters: 100, epoch: 2 | loss: 0.7799511
	speed: 0.0133s/iter; left time: 94.0432s
	iters: 200, epoch: 2 | loss: 0.3974013
	speed: 0.0051s/iter; left time: 35.8364s
	iters: 300, epoch: 2 | loss: 0.4108182
	speed: 0.0051s/iter; left time: 35.1998s
	iters: 400, epoch: 2 | loss: 0.3168716
	speed: 0.0051s/iter; left time: 34.7414s
	iters: 500, epoch: 2 | loss: 0.3063343
	speed: 0.0052s/iter; left time: 34.4774s
	iters: 600, epoch: 2 | loss: 0.7802869
	speed: 0.0051s/iter; left time: 33.7790s
	iters: 700, epoch: 2 | loss: 0.3390919
	speed: 0.0051s/iter; left time: 32.9448s
	iters: 800, epoch: 2 | loss: 1.4421172
	speed: 0.0051s/iter; left time: 32.7935s
	iters: 900, epoch: 2 | loss: 0.8794524
	speed: 0.0051s/iter; left time: 32.2565s
	iters: 1000, epoch: 2 | loss: 0.3668091
	speed: 0.0051s/iter; left time: 31.2757s
Updating learning rate to 0.0029026197141712473
Validation loss decreased (0.4020 --> 0.4000).  Saving model state dict ...
Epoch: 2 cost time: 5.298398494720459
Epoch: 2, Steps: 1027 | Train Loss: 0.6019134 Vali Loss: 0.4000168 Best vali loss: 0.4000168
	iters: 100, epoch: 3 | loss: 0.3937415
	speed: 0.0126s/iter; left time: 76.3920s
	iters: 200, epoch: 3 | loss: 0.4723684
	speed: 0.0045s/iter; left time: 27.0034s
	iters: 300, epoch: 3 | loss: 0.5488225
	speed: 0.0046s/iter; left time: 27.1009s
	iters: 400, epoch: 3 | loss: 0.2300336
	speed: 0.0047s/iter; left time: 27.0340s
	iters: 500, epoch: 3 | loss: 0.3901025
	speed: 0.0046s/iter; left time: 25.8692s
	iters: 600, epoch: 3 | loss: 0.4483491
	speed: 0.0047s/iter; left time: 25.8951s
	iters: 700, epoch: 3 | loss: 0.6360201
	speed: 0.0045s/iter; left time: 24.7474s
	iters: 800, epoch: 3 | loss: 1.1799076
	speed: 0.0046s/iter; left time: 24.6205s
	iters: 900, epoch: 3 | loss: 1.7852608
	speed: 0.0045s/iter; left time: 23.8923s
	iters: 1000, epoch: 3 | loss: 0.7868309
	speed: 0.0045s/iter; left time: 23.1818s
Updating learning rate to 0.0023509977427723094
Epoch: 3 cost time: 4.742108583450317
Epoch: 3, Steps: 1027 | Train Loss: 0.6871437 Vali Loss: 0.4041084 Best vali loss: 0.4000168

best validation loss 0.400016806296609

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022121251808, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.755195140838623
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704568 Best vali loss: 0.3704568
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3705 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 0.45050573348999023
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3640662 Best vali loss: 0.3640662
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3641 --> 0.3634).  Saving model state dict ...
Epoch: 3 cost time: 0.4480769634246826
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3634383 Best vali loss: 0.3634383

best validation loss 0.3634382778745737

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022121251808, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3634 --> 0.3462).  Saving model state dict ...
Epoch: 4 cost time: 0.7566227912902832
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3461936 Best vali loss: 0.3461936
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.44498562812805176
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3553555 Best vali loss: 0.3461936
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.4353671073913574
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3531444 Best vali loss: 0.3461936
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.4395158290863037
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3552224 Best vali loss: 0.3461936
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.44420361518859863
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3547946 Best vali loss: 0.3461936

best validation loss 0.3461936447732809

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020851248882, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.7570655345916748
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705371 Best vali loss: 0.3705371
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3705 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 0.45053768157958984
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3637498 Best vali loss: 0.3637498
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3637 --> 0.3519).  Saving model state dict ...
Epoch: 3 cost time: 0.44598889350891113
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3519375 Best vali loss: 0.3519375
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3519 --> 0.3438).  Saving model state dict ...
Epoch: 4 cost time: 0.44444704055786133
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3438118 Best vali loss: 0.3438118
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3438 --> 0.3396).  Saving model state dict ...
Epoch: 5 cost time: 0.44413232803344727
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3395752 Best vali loss: 0.3395752
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3396 --> 0.3392).  Saving model state dict ...
Epoch: 6 cost time: 0.44829702377319336
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3391700 Best vali loss: 0.3391700
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3392 --> 0.3386).  Saving model state dict ...
Epoch: 7 cost time: 0.44896817207336426
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3385600 Best vali loss: 0.3385600
Updating learning rate to 5.52363443828125e-06
Validation loss decreased (0.3386 --> 0.3385).  Saving model state dict ...
Epoch: 8 cost time: 0.4482736587524414
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3385103 Best vali loss: 0.3385103

best validation loss 0.3385102951690584

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010395343121, 'e_layers': 4, 'learning_rate': 0.0003594323482, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9772279
	speed: 0.0117s/iter; left time: 47.0977s
	iters: 200, epoch: 1 | loss: 0.5597742
	speed: 0.0054s/iter; left time: 21.0876s
	iters: 300, epoch: 1 | loss: 0.6996907
	speed: 0.0054s/iter; left time: 20.5114s
	iters: 400, epoch: 1 | loss: 0.4530610
	speed: 0.0054s/iter; left time: 20.1929s
	iters: 500, epoch: 1 | loss: 0.5163194
	speed: 0.0054s/iter; left time: 19.4454s
Updating learning rate to 0.0003594323482
Validation loss decreased (inf --> 0.4031).  Saving model state dict ...
Epoch: 1 cost time: 3.1324515342712402
Epoch: 1, Steps: 514 | Train Loss: 0.6412146 Vali Loss: 0.4031443 Best vali loss: 0.4031443
	iters: 100, epoch: 2 | loss: 0.7210255
	speed: 0.0110s/iter; left time: 38.5271s
	iters: 200, epoch: 2 | loss: 1.0021111
	speed: 0.0053s/iter; left time: 18.1433s
	iters: 300, epoch: 2 | loss: 0.4611088
	speed: 0.0053s/iter; left time: 17.5543s
	iters: 400, epoch: 2 | loss: 1.0778488
	speed: 0.0054s/iter; left time: 17.1831s
	iters: 500, epoch: 2 | loss: 0.3640575
	speed: 0.0055s/iter; left time: 16.9389s
Updating learning rate to 0.0001797161741
Epoch: 2 cost time: 2.8148281574249268
Epoch: 2, Steps: 514 | Train Loss: 0.7252303 Vali Loss: 0.4039670 Best vali loss: 0.4031443
	iters: 100, epoch: 3 | loss: 0.7689699
	speed: 0.0104s/iter; left time: 31.0461s
	iters: 200, epoch: 3 | loss: 0.3430370
	speed: 0.0054s/iter; left time: 15.4478s
	iters: 300, epoch: 3 | loss: 1.4920582
	speed: 0.0055s/iter; left time: 15.2311s
	iters: 400, epoch: 3 | loss: 0.9811766
	speed: 0.0055s/iter; left time: 14.6347s
	iters: 500, epoch: 3 | loss: 0.3654003
	speed: 0.0054s/iter; left time: 13.8612s
Updating learning rate to 8.985808705e-05
Validation loss decreased (0.4031 --> 0.4009).  Saving model state dict ...
Epoch: 3 cost time: 2.819087505340576
Epoch: 3, Steps: 514 | Train Loss: 0.7901284 Vali Loss: 0.4008982 Best vali loss: 0.4008982
	iters: 100, epoch: 4 | loss: 0.6632274
	speed: 0.0110s/iter; left time: 27.2439s
	iters: 200, epoch: 4 | loss: 0.4737738
	speed: 0.0054s/iter; left time: 12.7322s
	iters: 300, epoch: 4 | loss: 0.5741426
	speed: 0.0055s/iter; left time: 12.3793s
	iters: 400, epoch: 4 | loss: 0.8609161
	speed: 0.0054s/iter; left time: 11.6649s
	iters: 500, epoch: 4 | loss: 0.2693815
	speed: 0.0054s/iter; left time: 11.1723s
Updating learning rate to 4.4929043525e-05
Epoch: 4 cost time: 2.817805290222168
Epoch: 4, Steps: 514 | Train Loss: 0.5682883 Vali Loss: 0.4054398 Best vali loss: 0.4008982
	iters: 100, epoch: 5 | loss: 1.1414853
	speed: 0.0104s/iter; left time: 20.3086s
	iters: 200, epoch: 5 | loss: 0.7774484
	speed: 0.0050s/iter; left time: 9.3517s
	iters: 300, epoch: 5 | loss: 0.6043488
	speed: 0.0051s/iter; left time: 8.9824s
	iters: 400, epoch: 5 | loss: 0.8960739
	speed: 0.0051s/iter; left time: 8.4058s
	iters: 500, epoch: 5 | loss: 1.0213933
	speed: 0.0051s/iter; left time: 7.9692s
Updating learning rate to 2.24645217625e-05
Epoch: 5 cost time: 2.6603260040283203
Epoch: 5, Steps: 514 | Train Loss: 0.8881500 Vali Loss: 0.4016489 Best vali loss: 0.4008982
	iters: 100, epoch: 6 | loss: 0.5607053
	speed: 0.0104s/iter; left time: 15.0435s
	iters: 200, epoch: 6 | loss: 0.7563316
	speed: 0.0051s/iter; left time: 6.8343s
	iters: 300, epoch: 6 | loss: 0.5211378
	speed: 0.0051s/iter; left time: 6.3366s
	iters: 400, epoch: 6 | loss: 0.6947424
	speed: 0.0050s/iter; left time: 5.7142s
	iters: 500, epoch: 6 | loss: 0.4156598
	speed: 0.0050s/iter; left time: 5.2198s
Updating learning rate to 1.123226088125e-05
Epoch: 6 cost time: 2.666353940963745
Epoch: 6, Steps: 514 | Train Loss: 0.5897154 Vali Loss: 0.4037203 Best vali loss: 0.4008982
	iters: 100, epoch: 7 | loss: 0.5285476
	speed: 0.0102s/iter; left time: 9.4575s
	iters: 200, epoch: 7 | loss: 0.6683360
	speed: 0.0051s/iter; left time: 4.2292s
	iters: 300, epoch: 7 | loss: 0.7560315
	speed: 0.0051s/iter; left time: 3.7355s
	iters: 400, epoch: 7 | loss: 1.2534269
	speed: 0.0051s/iter; left time: 3.2077s
	iters: 500, epoch: 7 | loss: 0.7018341
	speed: 0.0054s/iter; left time: 2.8524s
Updating learning rate to 5.616130440625e-06
Epoch: 7 cost time: 2.6967830657958984
Epoch: 7, Steps: 514 | Train Loss: 0.7816352 Vali Loss: 0.4035331 Best vali loss: 0.4008982
	iters: 100, epoch: 8 | loss: 0.5401474
	speed: 0.0105s/iter; left time: 4.3379s
	iters: 200, epoch: 8 | loss: 1.5572362
	speed: 0.0052s/iter; left time: 1.6451s
	iters: 300, epoch: 8 | loss: 1.0067884
	speed: 0.0052s/iter; left time: 1.1190s
	iters: 400, epoch: 8 | loss: 0.3304099
	speed: 0.0052s/iter; left time: 0.5981s
	iters: 500, epoch: 8 | loss: 0.2979365
	speed: 0.0052s/iter; left time: 0.0774s
Updating learning rate to 2.8080652203125e-06
Epoch: 8 cost time: 2.718707323074341
Epoch: 8, Steps: 514 | Train Loss: 0.7465037 Vali Loss: 0.4035249 Best vali loss: 0.4008982

best validation loss 0.40089817290690183

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0009803177165, 'e_layers': 4, 'learning_rate': 0.0003522304873, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9282567
	speed: 0.0114s/iter; left time: 45.6527s
	iters: 200, epoch: 1 | loss: 0.4537048
	speed: 0.0053s/iter; left time: 20.8891s
	iters: 300, epoch: 1 | loss: 0.6945066
	speed: 0.0054s/iter; left time: 20.4589s
	iters: 400, epoch: 1 | loss: 0.4433830
	speed: 0.0053s/iter; left time: 19.5322s
	iters: 500, epoch: 1 | loss: 0.5315052
	speed: 0.0054s/iter; left time: 19.3469s
Updating learning rate to 0.0003522304873
Validation loss decreased (inf --> 0.3836).  Saving model state dict ...
Epoch: 1 cost time: 3.0942041873931885
Epoch: 1, Steps: 514 | Train Loss: 0.6102713 Vali Loss: 0.3836331 Best vali loss: 0.3836331
	iters: 100, epoch: 2 | loss: 0.6947197
	speed: 0.0107s/iter; left time: 37.4719s
	iters: 200, epoch: 2 | loss: 1.0206218
	speed: 0.0053s/iter; left time: 18.0789s
	iters: 300, epoch: 2 | loss: 0.4124162
	speed: 0.0054s/iter; left time: 17.6605s
	iters: 400, epoch: 2 | loss: 0.9268739
	speed: 0.0053s/iter; left time: 16.9841s
	iters: 500, epoch: 2 | loss: 0.3587570
	speed: 0.0054s/iter; left time: 16.6232s
Updating learning rate to 0.00017611524365
Epoch: 2 cost time: 2.7724056243896484
Epoch: 2, Steps: 514 | Train Loss: 0.6826777 Vali Loss: 0.3941647 Best vali loss: 0.3836331
	iters: 100, epoch: 3 | loss: 0.7562763
	speed: 0.0103s/iter; left time: 30.8672s
	iters: 200, epoch: 3 | loss: 0.3078558
	speed: 0.0051s/iter; left time: 14.6924s
	iters: 300, epoch: 3 | loss: 1.4280245
	speed: 0.0051s/iter; left time: 14.0771s
	iters: 400, epoch: 3 | loss: 1.0540044
	speed: 0.0051s/iter; left time: 13.7145s
	iters: 500, epoch: 3 | loss: 0.3178777
	speed: 0.0051s/iter; left time: 13.1276s
Updating learning rate to 8.8057621825e-05
Validation loss decreased (0.3836 --> 0.3733).  Saving model state dict ...
Epoch: 3 cost time: 2.6538357734680176
Epoch: 3, Steps: 514 | Train Loss: 0.7728078 Vali Loss: 0.3733499 Best vali loss: 0.3733499

best validation loss 0.373349886839891

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010020861133, 'e_layers': 4, 'learning_rate': 0.0003430286337, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9853006
	speed: 0.0116s/iter; left time: 46.4201s
	iters: 200, epoch: 1 | loss: 0.5955350
	speed: 0.0053s/iter; left time: 20.6153s
	iters: 300, epoch: 1 | loss: 0.6517504
	speed: 0.0053s/iter; left time: 20.0986s
	iters: 400, epoch: 1 | loss: 0.4578924
	speed: 0.0053s/iter; left time: 19.8636s
	iters: 500, epoch: 1 | loss: 0.5059628
	speed: 0.0051s/iter; left time: 18.4570s
Updating learning rate to 0.0003430286337
Validation loss decreased (inf --> 0.3967).  Saving model state dict ...
Epoch: 1 cost time: 3.0618221759796143
Epoch: 1, Steps: 514 | Train Loss: 0.6392883 Vali Loss: 0.3966731 Best vali loss: 0.3966731
	iters: 100, epoch: 2 | loss: 0.7171487
	speed: 0.0109s/iter; left time: 38.2248s
	iters: 200, epoch: 2 | loss: 1.0313714
	speed: 0.0054s/iter; left time: 18.3697s
	iters: 300, epoch: 2 | loss: 0.4602048
	speed: 0.0054s/iter; left time: 17.8776s
	iters: 400, epoch: 2 | loss: 1.0789738
	speed: 0.0054s/iter; left time: 17.3637s
	iters: 500, epoch: 2 | loss: 0.3640461
	speed: 0.0051s/iter; left time: 15.8919s
Updating learning rate to 0.00017151431685
Validation loss decreased (0.3967 --> 0.3963).  Saving model state dict ...
Epoch: 2 cost time: 2.793396472930908
Epoch: 2, Steps: 514 | Train Loss: 0.7303490 Vali Loss: 0.3963382 Best vali loss: 0.3963382
	iters: 100, epoch: 3 | loss: 0.7785551
	speed: 0.0109s/iter; left time: 32.4135s
	iters: 200, epoch: 3 | loss: 0.3267040
	speed: 0.0050s/iter; left time: 14.5552s
	iters: 300, epoch: 3 | loss: 1.4550132
	speed: 0.0051s/iter; left time: 14.1184s
	iters: 400, epoch: 3 | loss: 1.0307786
	speed: 0.0050s/iter; left time: 13.5312s
	iters: 500, epoch: 3 | loss: 0.3510004
	speed: 0.0051s/iter; left time: 13.2769s
Updating learning rate to 8.5757158425e-05
Validation loss decreased (0.3963 --> 0.3932).  Saving model state dict ...
Epoch: 3 cost time: 2.663875102996826
Epoch: 3, Steps: 514 | Train Loss: 0.7884103 Vali Loss: 0.3932365 Best vali loss: 0.3932365

best validation loss 0.39323647467232875

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022338020823, 'e_layers': 2, 'learning_rate': 0.0044672732498, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6781822
	speed: 0.0098s/iter; left time: 19.1723s
	iters: 200, epoch: 1 | loss: 0.5840186
	speed: 0.0035s/iter; left time: 6.4615s
Updating learning rate to 0.0044672732498
Validation loss decreased (inf --> 0.4000).  Saving model state dict ...
Epoch: 1 cost time: 1.2528715133666992
Epoch: 1, Steps: 257 | Train Loss: 0.6311004 Vali Loss: 0.4000240 Best vali loss: 0.4000240
	iters: 100, epoch: 2 | loss: 0.7659119
	speed: 0.0082s/iter; left time: 13.9441s
	iters: 200, epoch: 2 | loss: 0.3881065
	speed: 0.0037s/iter; left time: 5.8485s
Updating learning rate to 0.0022336366249
Epoch: 2 cost time: 0.9849097728729248
Epoch: 2, Steps: 257 | Train Loss: 0.5770092 Vali Loss: 0.4023884 Best vali loss: 0.4000240
	iters: 100, epoch: 3 | loss: 0.4241723
	speed: 0.0080s/iter; left time: 11.5733s
	iters: 200, epoch: 3 | loss: 1.1981263
	speed: 0.0036s/iter; left time: 4.8338s
Updating learning rate to 0.00111681831245
Epoch: 3 cost time: 0.9584765434265137
Epoch: 3, Steps: 257 | Train Loss: 0.8111493 Vali Loss: 0.4027473 Best vali loss: 0.4000240

best validation loss 0.40002402443080143

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0009803177165, 'e_layers': 4, 'learning_rate': 0.0003522304873, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8282976
	speed: 0.0121s/iter; left time: 29.9094s
	iters: 200, epoch: 4 | loss: 0.4830998
	speed: 0.0052s/iter; left time: 12.3258s
	iters: 300, epoch: 4 | loss: 0.6500602
	speed: 0.0053s/iter; left time: 11.9311s
	iters: 400, epoch: 4 | loss: 0.4515081
	speed: 0.0054s/iter; left time: 11.7007s
	iters: 500, epoch: 4 | loss: 0.5040051
	speed: 0.0053s/iter; left time: 11.0278s
Updating learning rate to 4.40288109125e-05
Epoch: 4 cost time: 3.0821049213409424
Epoch: 4, Steps: 514 | Train Loss: 0.5833942 Vali Loss: 0.3788420 Best vali loss: 0.3733499
	iters: 100, epoch: 5 | loss: 0.6916884
	speed: 0.0104s/iter; left time: 20.2662s
	iters: 200, epoch: 5 | loss: 1.0378162
	speed: 0.0050s/iter; left time: 9.3734s
	iters: 300, epoch: 5 | loss: 0.4031750
	speed: 0.0051s/iter; left time: 8.9918s
	iters: 400, epoch: 5 | loss: 0.8264787
	speed: 0.0052s/iter; left time: 8.6104s
	iters: 500, epoch: 5 | loss: 0.3313723
	speed: 0.0053s/iter; left time: 8.3101s
Updating learning rate to 2.201440545625e-05
Epoch: 5 cost time: 2.704514741897583
Epoch: 5, Steps: 514 | Train Loss: 0.6581061 Vali Loss: 0.3800090 Best vali loss: 0.3733499
	iters: 100, epoch: 6 | loss: 0.7301499
	speed: 0.0105s/iter; left time: 15.2098s
	iters: 200, epoch: 6 | loss: 0.3116652
	speed: 0.0054s/iter; left time: 7.2043s
	iters: 300, epoch: 6 | loss: 1.2803581
	speed: 0.0054s/iter; left time: 6.6746s
	iters: 400, epoch: 6 | loss: 0.8942370
	speed: 0.0053s/iter; left time: 6.1137s
	iters: 500, epoch: 6 | loss: 0.3048905
	speed: 0.0054s/iter; left time: 5.6262s
Updating learning rate to 1.1007202728125e-05
Epoch: 6 cost time: 2.8052942752838135
Epoch: 6, Steps: 514 | Train Loss: 0.7042601 Vali Loss: 0.3872396 Best vali loss: 0.3733499
	iters: 100, epoch: 7 | loss: 0.5056807
	speed: 0.0105s/iter; left time: 9.7209s
	iters: 200, epoch: 7 | loss: 0.4096411
	speed: 0.0051s/iter; left time: 4.2386s
	iters: 300, epoch: 7 | loss: 0.4377197
	speed: 0.0054s/iter; left time: 3.9146s
	iters: 400, epoch: 7 | loss: 0.7947282
	speed: 0.0053s/iter; left time: 3.3424s
	iters: 500, epoch: 7 | loss: 0.2370743
	speed: 0.0053s/iter; left time: 2.8015s
Updating learning rate to 5.5036013640625e-06
Epoch: 7 cost time: 2.7544078826904297
Epoch: 7, Steps: 514 | Train Loss: 0.4769688 Vali Loss: 0.3924524 Best vali loss: 0.3733499
	iters: 100, epoch: 8 | loss: 0.4073623
	speed: 0.0103s/iter; left time: 4.2543s
	iters: 200, epoch: 8 | loss: 0.6697729
	speed: 0.0051s/iter; left time: 1.6040s
	iters: 300, epoch: 8 | loss: 0.5763415
	speed: 0.0051s/iter; left time: 1.1010s
	iters: 400, epoch: 8 | loss: 0.7419472
	speed: 0.0051s/iter; left time: 0.5825s
	iters: 500, epoch: 8 | loss: 0.9154985
	speed: 0.0051s/iter; left time: 0.0763s
Updating learning rate to 2.75180068203125e-06
Epoch: 8 cost time: 2.6598727703094482
Epoch: 8, Steps: 514 | Train Loss: 0.6621845 Vali Loss: 0.3961481 Best vali loss: 0.3733499

best validation loss 0.373349886839891

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.1064605712890625
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710793 Best vali loss: 0.3710793
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3711 --> 0.3645).  Saving model state dict ...
Epoch: 2 cost time: 0.788196325302124
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3645479 Best vali loss: 0.3645479
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3645 --> 0.3593).  Saving model state dict ...
Epoch: 3 cost time: 0.7850663661956787
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3593242 Best vali loss: 0.3593242
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3593 --> 0.3454).  Saving model state dict ...
Epoch: 4 cost time: 0.7806179523468018
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3453571 Best vali loss: 0.3453571
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3454 --> 0.3439).  Saving model state dict ...
Epoch: 5 cost time: 0.785667896270752
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3438749 Best vali loss: 0.3438749
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3439 --> 0.3427).  Saving model state dict ...
Epoch: 6 cost time: 0.789553165435791
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3426923 Best vali loss: 0.3426923
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3427 --> 0.3418).  Saving model state dict ...
Epoch: 7 cost time: 0.7855629920959473
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3417623 Best vali loss: 0.3417623
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7856791019439697
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3418376 Best vali loss: 0.3417623

best validation loss 0.34176230593374063

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006236399714, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006236399714
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 1.1034257411956787
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3635092 Best vali loss: 0.3635092
Updating learning rate to 0.0003118199857
Epoch: 2 cost time: 0.7908306121826172
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703317 Best vali loss: 0.3635092
Updating learning rate to 0.00015590999285
Epoch: 3 cost time: 0.7951884269714355
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3730611 Best vali loss: 0.3635092
Updating learning rate to 7.7954996425e-05
Epoch: 4 cost time: 0.7879271507263184
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3747628 Best vali loss: 0.3635092
Updating learning rate to 3.89774982125e-05
Epoch: 5 cost time: 0.7942931652069092
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3733184 Best vali loss: 0.3635092
Updating learning rate to 1.948874910625e-05
Epoch: 6 cost time: 0.7951910495758057
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3687731 Best vali loss: 0.3635092
Updating learning rate to 9.744374553125e-06
Epoch: 7 cost time: 0.7905721664428711
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3691956 Best vali loss: 0.3635092
Updating learning rate to 4.8721872765625e-06
Epoch: 8 cost time: 0.7948846817016602
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3706282 Best vali loss: 0.3635092

best validation loss 0.36350922744962694

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008062803304, 'e_layers': 4, 'learning_rate': 0.0003183700807, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4740486
	speed: 0.0158s/iter; left time: 14.7411s
Updating learning rate to 0.0003183700807
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.6070942878723145
Epoch: 1, Steps: 129 | Train Loss: 0.4740486 Vali Loss: 0.3675711 Best vali loss: 0.3675711
	iters: 100, epoch: 2 | loss: 0.5651803
	speed: 0.0156s/iter; left time: 12.5492s
Updating learning rate to 0.00015918504035
Epoch: 2 cost time: 1.2969770431518555
Epoch: 2, Steps: 129 | Train Loss: 0.5651803 Vali Loss: 0.3781611 Best vali loss: 0.3675711
	iters: 100, epoch: 3 | loss: 0.6503670
	speed: 0.0153s/iter; left time: 10.3261s
Updating learning rate to 7.9592520175e-05
Validation loss decreased (0.3676 --> 0.3414).  Saving model state dict ...
Epoch: 3 cost time: 1.2967743873596191
Epoch: 3, Steps: 129 | Train Loss: 0.6503670 Vali Loss: 0.3413792 Best vali loss: 0.3413792

best validation loss 0.34137916632860255

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009515335692, 'e_layers': 4, 'learning_rate': 0.000326477302, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4748276
	speed: 0.0160s/iter; left time: 14.9260s
Updating learning rate to 0.0003140514995736531
Validation loss decreased (inf --> 0.3812).  Saving model state dict ...
Epoch: 1 cost time: 1.6285688877105713
Epoch: 1, Steps: 129 | Train Loss: 0.4748276 Vali Loss: 0.3811977 Best vali loss: 0.3811977
	iters: 100, epoch: 2 | loss: 0.6264775
	speed: 0.0157s/iter; left time: 12.6102s
Updating learning rate to 0.0002786658080738442
Validation loss decreased (0.3812 --> 0.3764).  Saving model state dict ...
Epoch: 2 cost time: 1.298344373703003
Epoch: 2, Steps: 129 | Train Loss: 0.6264775 Vali Loss: 0.3764095 Best vali loss: 0.3764095
	iters: 100, epoch: 3 | loss: 0.6869195
	speed: 0.0158s/iter; left time: 10.6939s
Updating learning rate to 0.00022570737825932703
Validation loss decreased (0.3764 --> 0.3733).  Saving model state dict ...
Epoch: 3 cost time: 1.2970802783966064
Epoch: 3, Steps: 129 | Train Loss: 0.6869195 Vali Loss: 0.3733038 Best vali loss: 0.3733038

best validation loss 0.3733037927764338

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009490281877, 'e_layers': 4, 'learning_rate': 0.0003179976345, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4766847
	speed: 0.0158s/iter; left time: 14.7297s
Updating learning rate to 0.0003058945702007775
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 1.6048226356506348
Epoch: 1, Steps: 129 | Train Loss: 0.4766847 Vali Loss: 0.3657641 Best vali loss: 0.3657641
	iters: 100, epoch: 2 | loss: 0.6072803
	speed: 0.0156s/iter; left time: 12.5665s
Updating learning rate to 0.0002714279591281156
Epoch: 2 cost time: 1.300133466720581
Epoch: 2, Steps: 129 | Train Loss: 0.6072803 Vali Loss: 0.3728030 Best vali loss: 0.3657641
	iters: 100, epoch: 3 | loss: 0.6793981
	speed: 0.0153s/iter; left time: 10.3425s
Updating learning rate to 0.00021984503037721965
Validation loss decreased (0.3658 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 1.2985703945159912
Epoch: 3, Steps: 129 | Train Loss: 0.6793981 Vali Loss: 0.3608685 Best vali loss: 0.3608685

best validation loss 0.36086853771874855

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008062803304, 'e_layers': 4, 'learning_rate': 0.0003183700807, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3749745
	speed: 0.0168s/iter; left time: 9.1639s
Updating learning rate to 3.97962600875e-05
Epoch: 4 cost time: 1.6327576637268066
Epoch: 4, Steps: 129 | Train Loss: 0.3749745 Vali Loss: 0.3434526 Best vali loss: 0.3413792
	iters: 100, epoch: 5 | loss: 0.4493263
	speed: 0.0153s/iter; left time: 6.3890s
Updating learning rate to 1.989813004375e-05
Epoch: 5 cost time: 1.2902007102966309
Epoch: 5, Steps: 129 | Train Loss: 0.4493263 Vali Loss: 0.3426064 Best vali loss: 0.3413792
	iters: 100, epoch: 6 | loss: 0.5428472
	speed: 0.0153s/iter; left time: 4.4047s
Updating learning rate to 9.949065021875e-06
Epoch: 6 cost time: 1.3025696277618408
Epoch: 6, Steps: 129 | Train Loss: 0.5428472 Vali Loss: 0.3445551 Best vali loss: 0.3413792
	iters: 100, epoch: 7 | loss: 0.6020086
	speed: 0.0155s/iter; left time: 2.4667s
Updating learning rate to 4.9745325109375e-06
Epoch: 7 cost time: 1.300424337387085
Epoch: 7, Steps: 129 | Train Loss: 0.6020086 Vali Loss: 0.3455275 Best vali loss: 0.3413792
	iters: 100, epoch: 8 | loss: 0.4506457
	speed: 0.0153s/iter; left time: 0.4586s
Updating learning rate to 2.48726625546875e-06
Epoch: 8 cost time: 1.2977123260498047
Epoch: 8, Steps: 129 | Train Loss: 0.4506457 Vali Loss: 0.3457829 Best vali loss: 0.3413792

best validation loss 0.34137916632860255

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010281613387, 'e_layers': 4, 'learning_rate': 0.0003289817877, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4778272
	speed: 0.0117s/iter; left time: 47.0142s
	iters: 200, epoch: 1 | loss: 0.6730760
	speed: 0.0056s/iter; left time: 21.8183s
	iters: 300, epoch: 1 | loss: 0.3721368
	speed: 0.0055s/iter; left time: 21.0933s
	iters: 400, epoch: 1 | loss: 0.8288531
	speed: 0.0055s/iter; left time: 20.4954s
	iters: 500, epoch: 1 | loss: 0.4804112
	speed: 0.0055s/iter; left time: 19.9304s
Updating learning rate to 0.0003289817877
Validation loss decreased (inf --> 0.3807).  Saving model state dict ...
Epoch: 1 cost time: 3.208780527114868
Epoch: 1, Steps: 514 | Train Loss: 0.5664608 Vali Loss: 0.3806958 Best vali loss: 0.3806958
	iters: 100, epoch: 2 | loss: 0.6786986
	speed: 0.0115s/iter; left time: 40.1535s
	iters: 200, epoch: 2 | loss: 0.5004848
	speed: 0.0056s/iter; left time: 18.9005s
	iters: 300, epoch: 2 | loss: 1.0207970
	speed: 0.0055s/iter; left time: 18.2792s
	iters: 400, epoch: 2 | loss: 1.0439976
	speed: 0.0056s/iter; left time: 17.7778s
	iters: 500, epoch: 2 | loss: 1.1293542
	speed: 0.0054s/iter; left time: 16.8354s
Updating learning rate to 0.00016449089385
Epoch: 2 cost time: 2.8939175605773926
Epoch: 2, Steps: 514 | Train Loss: 0.8746665 Vali Loss: 0.4061341 Best vali loss: 0.3806958
	iters: 100, epoch: 3 | loss: 0.8536803
	speed: 0.0106s/iter; left time: 31.6699s
	iters: 200, epoch: 3 | loss: 0.8113535
	speed: 0.0053s/iter; left time: 15.1931s
	iters: 300, epoch: 3 | loss: 0.8312423
	speed: 0.0053s/iter; left time: 14.7405s
	iters: 400, epoch: 3 | loss: 0.5014394
	speed: 0.0054s/iter; left time: 14.4640s
	iters: 500, epoch: 3 | loss: 0.8630906
	speed: 0.0053s/iter; left time: 13.7842s
Updating learning rate to 8.2245446925e-05
Epoch: 3 cost time: 2.7764194011688232
Epoch: 3, Steps: 514 | Train Loss: 0.7721612 Vali Loss: 0.3815436 Best vali loss: 0.3806958
	iters: 100, epoch: 4 | loss: 0.7389542
	speed: 0.0110s/iter; left time: 27.2324s
	iters: 200, epoch: 4 | loss: 0.3305676
	speed: 0.0055s/iter; left time: 13.1278s
	iters: 300, epoch: 4 | loss: 0.7465608
	speed: 0.0054s/iter; left time: 12.2275s
	iters: 400, epoch: 4 | loss: 0.4713975
	speed: 0.0053s/iter; left time: 11.5524s
	iters: 500, epoch: 4 | loss: 0.6075236
	speed: 0.0053s/iter; left time: 11.0572s
Updating learning rate to 4.11227234625e-05
Validation loss decreased (0.3807 --> 0.3776).  Saving model state dict ...
Epoch: 4 cost time: 2.820545196533203
Epoch: 4, Steps: 514 | Train Loss: 0.5790007 Vali Loss: 0.3775941 Best vali loss: 0.3775941
	iters: 100, epoch: 5 | loss: 0.2542921
	speed: 0.0114s/iter; left time: 22.3515s
	iters: 200, epoch: 5 | loss: 0.7340304
	speed: 0.0053s/iter; left time: 9.8616s
	iters: 300, epoch: 5 | loss: 0.4357851
	speed: 0.0053s/iter; left time: 9.3435s
	iters: 400, epoch: 5 | loss: 0.4993175
	speed: 0.0054s/iter; left time: 8.9131s
	iters: 500, epoch: 5 | loss: 0.6303017
	speed: 0.0055s/iter; left time: 8.5509s
Updating learning rate to 2.056136173125e-05
Epoch: 5 cost time: 2.80545973777771
Epoch: 5, Steps: 514 | Train Loss: 0.5107454 Vali Loss: 0.3854754 Best vali loss: 0.3775941
	iters: 100, epoch: 6 | loss: 0.5696308
	speed: 0.0109s/iter; left time: 15.6913s
	iters: 200, epoch: 6 | loss: 0.5578595
	speed: 0.0055s/iter; left time: 7.3442s
	iters: 300, epoch: 6 | loss: 0.5386401
	speed: 0.0054s/iter; left time: 6.7624s
	iters: 400, epoch: 6 | loss: 0.3572890
	speed: 0.0054s/iter; left time: 6.2196s
	iters: 500, epoch: 6 | loss: 0.7426273
	speed: 0.0055s/iter; left time: 5.7178s
Updating learning rate to 1.0280680865625e-05
Epoch: 6 cost time: 2.842816114425659
Epoch: 6, Steps: 514 | Train Loss: 0.5532093 Vali Loss: 0.3815633 Best vali loss: 0.3775941
	iters: 100, epoch: 7 | loss: 0.8076952
	speed: 0.0109s/iter; left time: 10.1287s
	iters: 200, epoch: 7 | loss: 0.5014079
	speed: 0.0054s/iter; left time: 4.5144s
	iters: 300, epoch: 7 | loss: 0.3807828
	speed: 0.0054s/iter; left time: 3.9594s
	iters: 400, epoch: 7 | loss: 0.4816261
	speed: 0.0054s/iter; left time: 3.3839s
	iters: 500, epoch: 7 | loss: 0.5262261
	speed: 0.0053s/iter; left time: 2.8174s
Updating learning rate to 5.1403404328125e-06
Epoch: 7 cost time: 2.8220934867858887
Epoch: 7, Steps: 514 | Train Loss: 0.5395476 Vali Loss: 0.3871090 Best vali loss: 0.3775941
	iters: 100, epoch: 8 | loss: 0.3985865
	speed: 0.0107s/iter; left time: 4.4537s
	iters: 200, epoch: 8 | loss: 0.3152249
	speed: 0.0054s/iter; left time: 1.7009s
	iters: 300, epoch: 8 | loss: 0.5711191
	speed: 0.0054s/iter; left time: 1.1591s
	iters: 400, epoch: 8 | loss: 0.7227001
	speed: 0.0054s/iter; left time: 0.6217s
	iters: 500, epoch: 8 | loss: 1.0691220
	speed: 0.0054s/iter; left time: 0.0815s
Updating learning rate to 2.57017021640625e-06
Epoch: 8 cost time: 2.8136088848114014
Epoch: 8, Steps: 514 | Train Loss: 0.6153505 Vali Loss: 0.3935817 Best vali loss: 0.3775941

best validation loss 0.3775941000706086

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001025142516, 'e_layers': 3, 'learning_rate': 0.0003243366542, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2890375
	speed: 0.0107s/iter; left time: 42.7528s
	iters: 200, epoch: 1 | loss: 0.7808271
	speed: 0.0046s/iter; left time: 17.9985s
	iters: 300, epoch: 1 | loss: 0.7670057
	speed: 0.0044s/iter; left time: 16.9063s
	iters: 400, epoch: 1 | loss: 0.6855001
	speed: 0.0044s/iter; left time: 16.5031s
	iters: 500, epoch: 1 | loss: 0.6089999
	speed: 0.0046s/iter; left time: 16.5018s
Updating learning rate to 0.0003243366542
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 2.6765284538269043
Epoch: 1, Steps: 514 | Train Loss: 0.6262741 Vali Loss: 0.3715405 Best vali loss: 0.3715405
	iters: 100, epoch: 2 | loss: 0.6701894
	speed: 0.0097s/iter; left time: 33.7861s
	iters: 200, epoch: 2 | loss: 0.4388679
	speed: 0.0045s/iter; left time: 15.1933s
	iters: 300, epoch: 2 | loss: 0.3615499
	speed: 0.0046s/iter; left time: 15.0343s
	iters: 400, epoch: 2 | loss: 0.3831588
	speed: 0.0045s/iter; left time: 14.3168s
	iters: 500, epoch: 2 | loss: 0.6078468
	speed: 0.0044s/iter; left time: 13.5575s
Updating learning rate to 0.0001621683271
Epoch: 2 cost time: 2.3463516235351562
Epoch: 2, Steps: 514 | Train Loss: 0.4923226 Vali Loss: 0.3956991 Best vali loss: 0.3715405
	iters: 100, epoch: 3 | loss: 0.3053838
	speed: 0.0094s/iter; left time: 27.9192s
	iters: 200, epoch: 3 | loss: 0.2283805
	speed: 0.0043s/iter; left time: 12.5422s
	iters: 300, epoch: 3 | loss: 0.8134057
	speed: 0.0043s/iter; left time: 11.9357s
	iters: 400, epoch: 3 | loss: 0.2753213
	speed: 0.0043s/iter; left time: 11.5447s
	iters: 500, epoch: 3 | loss: 0.4929683
	speed: 0.0043s/iter; left time: 11.1326s
Updating learning rate to 8.108416355e-05
Epoch: 3 cost time: 2.276135206222534
Epoch: 3, Steps: 514 | Train Loss: 0.4230919 Vali Loss: 0.3728492 Best vali loss: 0.3715405
	iters: 100, epoch: 4 | loss: 1.2194496
	speed: 0.0092s/iter; left time: 22.8084s
	iters: 200, epoch: 4 | loss: 0.5367694
	speed: 0.0042s/iter; left time: 10.0743s
	iters: 300, epoch: 4 | loss: 0.6009324
	speed: 0.0042s/iter; left time: 9.5424s
	iters: 400, epoch: 4 | loss: 0.3866732
	speed: 0.0042s/iter; left time: 9.0486s
	iters: 500, epoch: 4 | loss: 1.0968578
	speed: 0.0043s/iter; left time: 8.8604s
Updating learning rate to 4.0542081775e-05
Validation loss decreased (0.3715 --> 0.3458).  Saving model state dict ...
Epoch: 4 cost time: 2.2306249141693115
Epoch: 4, Steps: 514 | Train Loss: 0.7681365 Vali Loss: 0.3457999 Best vali loss: 0.3457999
	iters: 100, epoch: 5 | loss: 1.1973146
	speed: 0.0094s/iter; left time: 18.3104s
	iters: 200, epoch: 5 | loss: 0.2893724
	speed: 0.0042s/iter; left time: 7.7317s
	iters: 300, epoch: 5 | loss: 0.3446563
	speed: 0.0042s/iter; left time: 7.3152s
	iters: 400, epoch: 5 | loss: 0.4930857
	speed: 0.0042s/iter; left time: 6.9043s
	iters: 500, epoch: 5 | loss: 0.3848740
	speed: 0.0042s/iter; left time: 6.5388s
Updating learning rate to 2.02710408875e-05
Epoch: 5 cost time: 2.193772315979004
Epoch: 5, Steps: 514 | Train Loss: 0.5418606 Vali Loss: 0.3460040 Best vali loss: 0.3457999
	iters: 100, epoch: 6 | loss: 0.7335262
	speed: 0.0093s/iter; left time: 13.4114s
	iters: 200, epoch: 6 | loss: 0.4566457
	speed: 0.0046s/iter; left time: 6.1579s
	iters: 300, epoch: 6 | loss: 0.4423237
	speed: 0.0044s/iter; left time: 5.5164s
	iters: 400, epoch: 6 | loss: 0.5745292
	speed: 0.0045s/iter; left time: 5.1319s
	iters: 500, epoch: 6 | loss: 0.3194882
	speed: 0.0045s/iter; left time: 4.7305s
Updating learning rate to 1.013552044375e-05
Epoch: 6 cost time: 2.371969699859619
Epoch: 6, Steps: 514 | Train Loss: 0.5053026 Vali Loss: 0.3461246 Best vali loss: 0.3457999
	iters: 100, epoch: 7 | loss: 0.7912994
	speed: 0.0092s/iter; left time: 8.5636s
	iters: 200, epoch: 7 | loss: 0.2573963
	speed: 0.0042s/iter; left time: 3.4812s
	iters: 300, epoch: 7 | loss: 0.3123800
	speed: 0.0043s/iter; left time: 3.1496s
	iters: 400, epoch: 7 | loss: 0.3565634
	speed: 0.0043s/iter; left time: 2.7050s
	iters: 500, epoch: 7 | loss: 0.5264314
	speed: 0.0042s/iter; left time: 2.2093s
Updating learning rate to 5.067760221875e-06
Epoch: 7 cost time: 2.252638816833496
Epoch: 7, Steps: 514 | Train Loss: 0.4488141 Vali Loss: 0.3530406 Best vali loss: 0.3457999
	iters: 100, epoch: 8 | loss: 0.3159172
	speed: 0.0090s/iter; left time: 3.7160s
	iters: 200, epoch: 8 | loss: 0.8220726
	speed: 0.0042s/iter; left time: 1.3133s
	iters: 300, epoch: 8 | loss: 0.3379379
	speed: 0.0042s/iter; left time: 0.8926s
	iters: 400, epoch: 8 | loss: 0.5741112
	speed: 0.0042s/iter; left time: 0.4773s
	iters: 500, epoch: 8 | loss: 0.5431450
	speed: 0.0043s/iter; left time: 0.0639s
Updating learning rate to 2.5338801109375e-06
Epoch: 8 cost time: 2.196699619293213
Epoch: 8, Steps: 514 | Train Loss: 0.5186368 Vali Loss: 0.3483290 Best vali loss: 0.3457999

best validation loss 0.3457999116076936

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5561292
	speed: 0.0137s/iter; left time: 12.7595s
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3926).  Saving model state dict ...
Epoch: 1 cost time: 1.2864129543304443
Epoch: 1, Steps: 129 | Train Loss: 0.5561292 Vali Loss: 0.3925644 Best vali loss: 0.3925644
	iters: 100, epoch: 2 | loss: 0.5586841
	speed: 0.0117s/iter; left time: 9.4126s
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3926 --> 0.3781).  Saving model state dict ...
Epoch: 2 cost time: 0.9442880153656006
Epoch: 2, Steps: 129 | Train Loss: 0.5586841 Vali Loss: 0.3781350 Best vali loss: 0.3781350
	iters: 100, epoch: 3 | loss: 0.6375831
	speed: 0.0117s/iter; left time: 7.9084s
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3781 --> 0.3730).  Saving model state dict ...
Epoch: 3 cost time: 0.9240636825561523
Epoch: 3, Steps: 129 | Train Loss: 0.6375831 Vali Loss: 0.3730417 Best vali loss: 0.3730417

best validation loss 0.3730416685752644

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0010527217651, 'e_layers': 2, 'learning_rate': 0.0001748674569, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001682119606161048
Validation loss decreased (inf --> 0.4195).  Saving model state dict ...
Epoch: 1 cost time: 0.6781191825866699
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4195305 Best vali loss: 0.4195305
Updating learning rate to 0.00014925871074141815
Validation loss decreased (0.4195 --> 0.4017).  Saving model state dict ...
Epoch: 2 cost time: 0.35956573486328125
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4017334 Best vali loss: 0.4017334
Updating learning rate to 0.00012089316775772321
Validation loss decreased (0.4017 --> 0.3924).  Saving model state dict ...
Epoch: 3 cost time: 0.35991716384887695
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3924312 Best vali loss: 0.3924312

best validation loss 0.39243124065324225

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008002231261, 'e_layers': 4, 'learning_rate': 0.0003329841045, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7706013
	speed: 0.0165s/iter; left time: 15.3722s
Updating learning rate to 0.0003329841045
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.6596012115478516
Epoch: 1, Steps: 129 | Train Loss: 0.7706013 Vali Loss: 0.3703971 Best vali loss: 0.3703971
	iters: 100, epoch: 2 | loss: 0.5440205
	speed: 0.0162s/iter; left time: 12.9904s
Updating learning rate to 0.00016649205225
Validation loss decreased (0.3704 --> 0.3543).  Saving model state dict ...
Epoch: 2 cost time: 1.3387935161590576
Epoch: 2, Steps: 129 | Train Loss: 0.5440205 Vali Loss: 0.3543195 Best vali loss: 0.3543195
	iters: 100, epoch: 3 | loss: 0.3326598
	speed: 0.0163s/iter; left time: 11.0079s
Updating learning rate to 8.3246026125e-05
Epoch: 3 cost time: 1.3348827362060547
Epoch: 3, Steps: 129 | Train Loss: 0.3326598 Vali Loss: 0.3644592 Best vali loss: 0.3543195

best validation loss 0.3543194902669236

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008002231261, 'e_layers': 4, 'learning_rate': 0.0003329841045, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6188146
	speed: 0.0169s/iter; left time: 9.2242s
Updating learning rate to 4.16230130625e-05
Validation loss decreased (0.3543 --> 0.3507).  Saving model state dict ...
Epoch: 4 cost time: 1.6512296199798584
Epoch: 4, Steps: 129 | Train Loss: 0.6188146 Vali Loss: 0.3506795 Best vali loss: 0.3506795
	iters: 100, epoch: 5 | loss: 0.4764405
	speed: 0.0163s/iter; left time: 6.7874s
Updating learning rate to 2.081150653125e-05
Validation loss decreased (0.3507 --> 0.3438).  Saving model state dict ...
Epoch: 5 cost time: 1.3272106647491455
Epoch: 5, Steps: 129 | Train Loss: 0.4764405 Vali Loss: 0.3437583 Best vali loss: 0.3437583
	iters: 100, epoch: 6 | loss: 0.2983626
	speed: 0.0163s/iter; left time: 4.6942s
Updating learning rate to 1.0405753265625e-05
Epoch: 6 cost time: 1.3359394073486328
Epoch: 6, Steps: 129 | Train Loss: 0.2983626 Vali Loss: 0.3446216 Best vali loss: 0.3437583
	iters: 100, epoch: 7 | loss: 0.4525315
	speed: 0.0156s/iter; left time: 2.4814s
Updating learning rate to 5.2028766328125e-06
Epoch: 7 cost time: 1.3276309967041016
Epoch: 7, Steps: 129 | Train Loss: 0.4525315 Vali Loss: 0.3476936 Best vali loss: 0.3437583
	iters: 100, epoch: 8 | loss: 0.4001478
	speed: 0.0157s/iter; left time: 0.4720s
Updating learning rate to 2.60143831640625e-06
Epoch: 8 cost time: 1.3329598903656006
Epoch: 8, Steps: 129 | Train Loss: 0.4001478 Vali Loss: 0.3463529 Best vali loss: 0.3437583

best validation loss 0.34375829358232046

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008040889975, 'e_layers': 4, 'learning_rate': 0.0003391781465, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7741458
	speed: 0.0162s/iter; left time: 15.0861s
Updating learning rate to 0.0003391781465
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.6382293701171875
Epoch: 1, Steps: 129 | Train Loss: 0.7741458 Vali Loss: 0.3671616 Best vali loss: 0.3671616
	iters: 100, epoch: 2 | loss: 0.5420231
	speed: 0.0160s/iter; left time: 12.8592s
Updating learning rate to 0.00016958907325
Epoch: 2 cost time: 1.327392816543579
Epoch: 2, Steps: 129 | Train Loss: 0.5420231 Vali Loss: 0.3692512 Best vali loss: 0.3671616
	iters: 100, epoch: 3 | loss: 0.3433008
	speed: 0.0156s/iter; left time: 10.5084s
Updating learning rate to 8.4794536625e-05
Validation loss decreased (0.3672 --> 0.3517).  Saving model state dict ...
Epoch: 3 cost time: 1.3258111476898193
Epoch: 3, Steps: 129 | Train Loss: 0.3433008 Vali Loss: 0.3517086 Best vali loss: 0.3517086
	iters: 100, epoch: 4 | loss: 0.4724155
	speed: 0.0163s/iter; left time: 8.8956s
Updating learning rate to 4.23972683125e-05
Validation loss decreased (0.3517 --> 0.3490).  Saving model state dict ...
Epoch: 4 cost time: 1.3261394500732422
Epoch: 4, Steps: 129 | Train Loss: 0.4724155 Vali Loss: 0.3490475 Best vali loss: 0.3490475
	iters: 100, epoch: 5 | loss: 0.4147446
	speed: 0.0164s/iter; left time: 6.8251s
Updating learning rate to 2.119863415625e-05
Epoch: 5 cost time: 1.338169813156128
Epoch: 5, Steps: 129 | Train Loss: 0.4147446 Vali Loss: 0.3500531 Best vali loss: 0.3490475
	iters: 100, epoch: 6 | loss: 0.5466972
	speed: 0.0157s/iter; left time: 4.5206s
Updating learning rate to 1.0599317078125e-05
Validation loss decreased (0.3490 --> 0.3486).  Saving model state dict ...
Epoch: 6 cost time: 1.3339035511016846
Epoch: 6, Steps: 129 | Train Loss: 0.5466972 Vali Loss: 0.3486135 Best vali loss: 0.3486135
	iters: 100, epoch: 7 | loss: 0.3855793
	speed: 0.0164s/iter; left time: 2.6012s
Updating learning rate to 5.2996585390625e-06
Validation loss decreased (0.3486 --> 0.3480).  Saving model state dict ...
Epoch: 7 cost time: 1.3354129791259766
Epoch: 7, Steps: 129 | Train Loss: 0.3855793 Vali Loss: 0.3479802 Best vali loss: 0.3479802
	iters: 100, epoch: 8 | loss: 0.4210172
	speed: 0.0164s/iter; left time: 0.4915s
Updating learning rate to 2.64982926953125e-06
Epoch: 8 cost time: 1.3358218669891357
Epoch: 8, Steps: 129 | Train Loss: 0.4210172 Vali Loss: 0.3479923 Best vali loss: 0.3479802

best validation loss 0.3479802315033723

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009833221061, 'e_layers': 4, 'learning_rate': 0.0003403365818, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8427897
	speed: 0.0162s/iter; left time: 15.1375s
Updating learning rate to 0.0003403365818
Validation loss decreased (inf --> 0.3661).  Saving model state dict ...
Epoch: 1 cost time: 1.736435890197754
Epoch: 1, Steps: 129 | Train Loss: 0.8427897 Vali Loss: 0.3661214 Best vali loss: 0.3661214
	iters: 100, epoch: 2 | loss: 0.4797217
	speed: 0.0189s/iter; left time: 15.1791s
Updating learning rate to 0.0001701682909
Validation loss decreased (0.3661 --> 0.3632).  Saving model state dict ...
Epoch: 2 cost time: 1.4324555397033691
Epoch: 2, Steps: 129 | Train Loss: 0.4797217 Vali Loss: 0.3631654 Best vali loss: 0.3631654
	iters: 100, epoch: 3 | loss: 0.4094411
	speed: 0.0174s/iter; left time: 11.7375s
Updating learning rate to 8.508414545e-05
Validation loss decreased (0.3632 --> 0.3483).  Saving model state dict ...
Epoch: 3 cost time: 1.4199893474578857
Epoch: 3, Steps: 129 | Train Loss: 0.4094411 Vali Loss: 0.3482787 Best vali loss: 0.3482787
	iters: 100, epoch: 4 | loss: 0.4077219
	speed: 0.0175s/iter; left time: 9.5342s
Updating learning rate to 4.2542072725e-05
Epoch: 4 cost time: 1.424591064453125
Epoch: 4, Steps: 129 | Train Loss: 0.4077219 Vali Loss: 0.3498418 Best vali loss: 0.3482787
	iters: 100, epoch: 5 | loss: 0.5471962
	speed: 0.0167s/iter; left time: 6.9435s
Updating learning rate to 2.12710363625e-05
Validation loss decreased (0.3483 --> 0.3461).  Saving model state dict ...
Epoch: 5 cost time: 1.418764591217041
Epoch: 5, Steps: 129 | Train Loss: 0.5471962 Vali Loss: 0.3460844 Best vali loss: 0.3460844
	iters: 100, epoch: 6 | loss: 0.5194206
	speed: 0.0175s/iter; left time: 5.0339s
Updating learning rate to 1.063551818125e-05
Epoch: 6 cost time: 1.4247934818267822
Epoch: 6, Steps: 129 | Train Loss: 0.5194206 Vali Loss: 0.3505543 Best vali loss: 0.3460844
	iters: 100, epoch: 7 | loss: 0.5984393
	speed: 0.0167s/iter; left time: 2.6497s
Updating learning rate to 5.317759090625e-06
Epoch: 7 cost time: 1.4270060062408447
Epoch: 7, Steps: 129 | Train Loss: 0.5984393 Vali Loss: 0.3495835 Best vali loss: 0.3460844
	iters: 100, epoch: 8 | loss: 0.3172370
	speed: 0.0168s/iter; left time: 0.5040s
Updating learning rate to 2.6588795453125e-06
Epoch: 8 cost time: 1.4270696640014648
Epoch: 8, Steps: 129 | Train Loss: 0.3172370 Vali Loss: 0.3509298 Best vali loss: 0.3460844

best validation loss 0.34608438554821874

[INFO][smbo.py:320] Finished 600 trials.
{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0054326288036, 'e_layers': 3, 'learning_rate': 0.0009391619793, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7213684
	speed: 0.0108s/iter; left time: 87.7389s
	iters: 200, epoch: 1 | loss: 2.3133287
	speed: 0.0037s/iter; left time: 29.4918s
	iters: 300, epoch: 1 | loss: 0.5570170
	speed: 0.0036s/iter; left time: 28.5292s
	iters: 400, epoch: 1 | loss: 0.4016969
	speed: 0.0036s/iter; left time: 27.7547s
	iters: 500, epoch: 1 | loss: 0.3748228
	speed: 0.0036s/iter; left time: 27.4732s
	iters: 600, epoch: 1 | loss: 1.4308071
	speed: 0.0036s/iter; left time: 27.2295s
	iters: 700, epoch: 1 | loss: 0.9989311
	speed: 0.0036s/iter; left time: 27.4065s
	iters: 800, epoch: 1 | loss: 1.2015246
	speed: 0.0036s/iter; left time: 26.7672s
	iters: 900, epoch: 1 | loss: 0.3175930
	speed: 0.0037s/iter; left time: 26.9591s
	iters: 1000, epoch: 1 | loss: 0.3780956
	speed: 0.0036s/iter; left time: 26.0815s
Updating learning rate to 0.0009034172548440295
Validation loss decreased (inf --> 0.3891).  Saving model state dict ...
Epoch: 1 cost time: 4.251422882080078
Epoch: 1, Steps: 1027 | Train Loss: 0.8695185 Vali Loss: 0.3890591 Best vali loss: 0.3890591
	iters: 100, epoch: 2 | loss: 0.4431280
	speed: 0.0112s/iter; left time: 79.2685s
	iters: 200, epoch: 2 | loss: 0.7738427
	speed: 0.0042s/iter; left time: 29.6570s
	iters: 300, epoch: 2 | loss: 0.4262927
	speed: 0.0042s/iter; left time: 29.1855s
	iters: 400, epoch: 2 | loss: 0.3659831
	speed: 0.0042s/iter; left time: 28.5269s
	iters: 500, epoch: 2 | loss: 0.3133435
	speed: 0.0042s/iter; left time: 28.1132s
	iters: 600, epoch: 2 | loss: 0.4386901
	speed: 0.0042s/iter; left time: 27.6416s
	iters: 700, epoch: 2 | loss: 0.3373084
	speed: 0.0042s/iter; left time: 27.3852s
	iters: 800, epoch: 2 | loss: 0.6878078
	speed: 0.0042s/iter; left time: 26.6539s
	iters: 900, epoch: 2 | loss: 0.2308351
	speed: 0.0042s/iter; left time: 26.2167s
	iters: 1000, epoch: 2 | loss: 0.5186649
	speed: 0.0042s/iter; left time: 25.8154s
Updating learning rate to 0.000801624891747805
Validation loss decreased (0.3891 --> 0.3822).  Saving model state dict ...
Epoch: 2 cost time: 4.348838567733765
Epoch: 2, Steps: 1027 | Train Loss: 0.4535896 Vali Loss: 0.3822272 Best vali loss: 0.3822272
	iters: 100, epoch: 3 | loss: 0.5297331
	speed: 0.0113s/iter; left time: 68.4593s
	iters: 200, epoch: 3 | loss: 0.3436466
	speed: 0.0042s/iter; left time: 24.7953s
	iters: 300, epoch: 3 | loss: 0.5490439
	speed: 0.0042s/iter; left time: 24.6435s
	iters: 400, epoch: 3 | loss: 0.4553715
	speed: 0.0042s/iter; left time: 24.4041s
	iters: 500, epoch: 3 | loss: 0.8560440
	speed: 0.0041s/iter; left time: 23.3734s
	iters: 600, epoch: 3 | loss: 1.2204584
	speed: 0.0040s/iter; left time: 22.1343s
	iters: 700, epoch: 3 | loss: 0.3036951
	speed: 0.0040s/iter; left time: 21.8520s
	iters: 800, epoch: 3 | loss: 0.3436057
	speed: 0.0040s/iter; left time: 21.4554s
	iters: 900, epoch: 3 | loss: 0.4449907
	speed: 0.0040s/iter; left time: 21.0034s
	iters: 1000, epoch: 3 | loss: 0.6302435
	speed: 0.0040s/iter; left time: 20.6626s
Updating learning rate to 0.0006492818545426577
Epoch: 3 cost time: 4.236172676086426
Epoch: 3, Steps: 1027 | Train Loss: 0.5676832 Vali Loss: 0.3824924 Best vali loss: 0.3822272

best validation loss 0.382227187376828

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009820033912, 'e_layers': 4, 'learning_rate': 0.0003378068707, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8418776
	speed: 0.0169s/iter; left time: 15.7966s
Updating learning rate to 0.0003378068707
Validation loss decreased (inf --> 0.3661).  Saving model state dict ...
Epoch: 1 cost time: 1.7357659339904785
Epoch: 1, Steps: 129 | Train Loss: 0.8418776 Vali Loss: 0.3660609 Best vali loss: 0.3660609
	iters: 100, epoch: 2 | loss: 0.4613773
	speed: 0.0170s/iter; left time: 13.6336s
Updating learning rate to 0.00016890343535
Epoch: 2 cost time: 1.413949966430664
Epoch: 2, Steps: 129 | Train Loss: 0.4613773 Vali Loss: 0.3969603 Best vali loss: 0.3660609
	iters: 100, epoch: 3 | loss: 0.4033760
	speed: 0.0165s/iter; left time: 11.1519s
Updating learning rate to 8.4451717675e-05
Validation loss decreased (0.3661 --> 0.3587).  Saving model state dict ...
Epoch: 3 cost time: 1.408872365951538
Epoch: 3, Steps: 129 | Train Loss: 0.4033760 Vali Loss: 0.3587358 Best vali loss: 0.3587358

best validation loss 0.35873577881655666

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0040947152409, 'e_layers': 4, 'learning_rate': 0.0002754558982, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3423811
	speed: 0.0117s/iter; left time: 46.8045s
	iters: 200, epoch: 1 | loss: 1.2849742
	speed: 0.0053s/iter; left time: 20.6754s
	iters: 300, epoch: 1 | loss: 0.4758849
	speed: 0.0053s/iter; left time: 20.1269s
	iters: 400, epoch: 1 | loss: 0.4843316
	speed: 0.0051s/iter; left time: 18.9597s
	iters: 500, epoch: 1 | loss: 1.1946918
	speed: 0.0052s/iter; left time: 18.8879s
Updating learning rate to 0.00026497198232824633
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 3.056302785873413
Epoch: 1, Steps: 514 | Train Loss: 0.7564527 Vali Loss: 0.3645685 Best vali loss: 0.3645685
	iters: 100, epoch: 2 | loss: 0.3378859
	speed: 0.0103s/iter; left time: 36.0583s
	iters: 200, epoch: 2 | loss: 0.3664559
	speed: 0.0050s/iter; left time: 16.8922s
	iters: 300, epoch: 2 | loss: 0.4712616
	speed: 0.0050s/iter; left time: 16.3853s
	iters: 400, epoch: 2 | loss: 0.3051939
	speed: 0.0050s/iter; left time: 15.8733s
	iters: 500, epoch: 2 | loss: 1.1098324
	speed: 0.0051s/iter; left time: 15.7597s
Updating learning rate to 0.00023511631586752566
Validation loss decreased (0.3646 --> 0.3594).  Saving model state dict ...
Epoch: 2 cost time: 2.642357110977173
Epoch: 2, Steps: 514 | Train Loss: 0.5181259 Vali Loss: 0.3593655 Best vali loss: 0.3593655
	iters: 100, epoch: 3 | loss: 0.7069116
	speed: 0.0100s/iter; left time: 29.9838s
	iters: 200, epoch: 3 | loss: 0.4808537
	speed: 0.0050s/iter; left time: 14.4339s
	iters: 300, epoch: 3 | loss: 0.9307042
	speed: 0.0048s/iter; left time: 13.4979s
	iters: 400, epoch: 3 | loss: 0.4448168
	speed: 0.0049s/iter; left time: 13.0689s
	iters: 500, epoch: 3 | loss: 0.6864927
	speed: 0.0050s/iter; left time: 12.9035s
Updating learning rate to 0.0001904341533941924
Validation loss decreased (0.3594 --> 0.3556).  Saving model state dict ...
Epoch: 3 cost time: 2.58309268951416
Epoch: 3, Steps: 514 | Train Loss: 0.6499558 Vali Loss: 0.3555739 Best vali loss: 0.3555739

best validation loss 0.35557385241587175

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0040947152409, 'e_layers': 4, 'learning_rate': 0.0002754558982, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3413267
	speed: 0.0115s/iter; left time: 28.3458s
	iters: 200, epoch: 4 | loss: 0.8871251
	speed: 0.0047s/iter; left time: 11.2305s
	iters: 300, epoch: 4 | loss: 0.3936154
	speed: 0.0048s/iter; left time: 10.8917s
	iters: 400, epoch: 4 | loss: 0.3893445
	speed: 0.0049s/iter; left time: 10.5682s
	iters: 500, epoch: 4 | loss: 0.9373326
	speed: 0.0050s/iter; left time: 10.4161s
Updating learning rate to 0.0001377279491
Epoch: 4 cost time: 2.865483522415161
Epoch: 4, Steps: 514 | Train Loss: 0.5897489 Vali Loss: 0.3560985 Best vali loss: 0.3555739
	iters: 100, epoch: 5 | loss: 0.2037432
	speed: 0.0098s/iter; left time: 19.1325s
	iters: 200, epoch: 5 | loss: 0.3078582
	speed: 0.0050s/iter; left time: 9.2956s
	iters: 300, epoch: 5 | loss: 0.4205795
	speed: 0.0052s/iter; left time: 9.0587s
	iters: 400, epoch: 5 | loss: 0.2235283
	speed: 0.0052s/iter; left time: 8.5653s
	iters: 500, epoch: 5 | loss: 0.8921822
	speed: 0.0052s/iter; left time: 8.0795s
Updating learning rate to 8.502174480580764e-05
Epoch: 5 cost time: 2.6699612140655518
Epoch: 5, Steps: 514 | Train Loss: 0.4095783 Vali Loss: 0.3555764 Best vali loss: 0.3555739
	iters: 100, epoch: 6 | loss: 0.5317671
	speed: 0.0099s/iter; left time: 14.3081s
	iters: 200, epoch: 6 | loss: 0.4048918
	speed: 0.0048s/iter; left time: 6.3799s
	iters: 300, epoch: 6 | loss: 0.6926403
	speed: 0.0049s/iter; left time: 6.1188s
	iters: 400, epoch: 6 | loss: 0.3552580
	speed: 0.0051s/iter; left time: 5.8102s
	iters: 500, epoch: 6 | loss: 0.3859213
	speed: 0.0051s/iter; left time: 5.2782s
Updating learning rate to 4.033958233247436e-05
Epoch: 6 cost time: 2.5916662216186523
Epoch: 6, Steps: 514 | Train Loss: 0.4740957 Vali Loss: 0.3621006 Best vali loss: 0.3555739
	iters: 100, epoch: 7 | loss: 0.5852411
	speed: 0.0096s/iter; left time: 8.9405s
	iters: 200, epoch: 7 | loss: 0.6691723
	speed: 0.0048s/iter; left time: 3.9992s
	iters: 300, epoch: 7 | loss: 0.4818078
	speed: 0.0049s/iter; left time: 3.5613s
	iters: 400, epoch: 7 | loss: 0.3078009
	speed: 0.0050s/iter; left time: 3.1257s
	iters: 500, epoch: 7 | loss: 0.4625325
	speed: 0.0050s/iter; left time: 2.6226s
Updating learning rate to 1.0483915871753706e-05
Epoch: 7 cost time: 2.5622432231903076
Epoch: 7, Steps: 514 | Train Loss: 0.5013109 Vali Loss: 0.3706613 Best vali loss: 0.3555739
	iters: 100, epoch: 8 | loss: 0.6202031
	speed: 0.0095s/iter; left time: 3.9387s
	iters: 200, epoch: 8 | loss: 0.3283140
	speed: 0.0048s/iter; left time: 1.5183s
	iters: 300, epoch: 8 | loss: 0.3975020
	speed: 0.0049s/iter; left time: 1.0611s
	iters: 400, epoch: 8 | loss: 0.8234085
	speed: 0.0049s/iter; left time: 0.5670s
	iters: 500, epoch: 8 | loss: 0.7457889
	speed: 0.0049s/iter; left time: 0.0740s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.537726402282715
Epoch: 8, Steps: 514 | Train Loss: 0.5830433 Vali Loss: 0.3670495 Best vali loss: 0.3555739

best validation loss 0.35557385241587175

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022144720903, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5589007
	speed: 0.0136s/iter; left time: 12.7228s
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3909).  Saving model state dict ...
Epoch: 1 cost time: 1.2914671897888184
Epoch: 1, Steps: 129 | Train Loss: 0.5589007 Vali Loss: 0.3909048 Best vali loss: 0.3909048
	iters: 100, epoch: 2 | loss: 0.5404051
	speed: 0.0117s/iter; left time: 9.3882s
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3909 --> 0.3823).  Saving model state dict ...
Epoch: 2 cost time: 0.9347608089447021
Epoch: 2, Steps: 129 | Train Loss: 0.5404051 Vali Loss: 0.3822603 Best vali loss: 0.3822603
	iters: 100, epoch: 3 | loss: 0.7110504
	speed: 0.0118s/iter; left time: 7.9940s
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3823 --> 0.3752).  Saving model state dict ...
Epoch: 3 cost time: 0.9326329231262207
Epoch: 3, Steps: 129 | Train Loss: 0.7110504 Vali Loss: 0.3751893 Best vali loss: 0.3751893
	iters: 100, epoch: 4 | loss: 0.3469626
	speed: 0.0117s/iter; left time: 6.3922s
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3752 --> 0.3676).  Saving model state dict ...
Epoch: 4 cost time: 0.9399111270904541
Epoch: 4, Steps: 129 | Train Loss: 0.3469626 Vali Loss: 0.3676236 Best vali loss: 0.3676236
	iters: 100, epoch: 5 | loss: 0.5364674
	speed: 0.0117s/iter; left time: 4.8762s
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3676 --> 0.3627).  Saving model state dict ...
Epoch: 5 cost time: 0.9286956787109375
Epoch: 5, Steps: 129 | Train Loss: 0.5364674 Vali Loss: 0.3627407 Best vali loss: 0.3627407
	iters: 100, epoch: 6 | loss: 0.4802538
	speed: 0.0118s/iter; left time: 3.3883s
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3627 --> 0.3599).  Saving model state dict ...
Epoch: 6 cost time: 0.9406731128692627
Epoch: 6, Steps: 129 | Train Loss: 0.4802538 Vali Loss: 0.3598811 Best vali loss: 0.3598811
	iters: 100, epoch: 7 | loss: 0.5677775
	speed: 0.0118s/iter; left time: 1.8741s
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3599 --> 0.3589).  Saving model state dict ...
Epoch: 7 cost time: 0.9431533813476562
Epoch: 7, Steps: 129 | Train Loss: 0.5677775 Vali Loss: 0.3589490 Best vali loss: 0.3589490
	iters: 100, epoch: 8 | loss: 0.4178596
	speed: 0.0117s/iter; left time: 0.3522s
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.942436695098877
Epoch: 8, Steps: 129 | Train Loss: 0.4178596 Vali Loss: 0.3595004 Best vali loss: 0.3589490

best validation loss 0.35894895892714707

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0007074403934, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006805150466669964
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.1059699058532715
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714573 Best vali loss: 0.3714573
Updating learning rate to 0.0006038381464292095
Validation loss decreased (0.3715 --> 0.3605).  Saving model state dict ...
Epoch: 2 cost time: 0.7860283851623535
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3604666 Best vali loss: 0.3604666
Updating learning rate to 0.0004890830556700108
Epoch: 3 cost time: 0.7921905517578125
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3721277 Best vali loss: 0.3604666
Updating learning rate to 0.0003537201967
Validation loss decreased (0.3605 --> 0.3604).  Saving model state dict ...
Epoch: 4 cost time: 0.7842516899108887
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3603516 Best vali loss: 0.3603516
Updating learning rate to 0.00021835733772998932
Validation loss decreased (0.3604 --> 0.3577).  Saving model state dict ...
Epoch: 5 cost time: 0.7840840816497803
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3576975 Best vali loss: 0.3576975
Updating learning rate to 0.00010360224697079057
Epoch: 6 cost time: 0.786766767501831
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3627968 Best vali loss: 0.3576975
Updating learning rate to 2.692534673300361e-05
Epoch: 7 cost time: 0.7871801853179932
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3606169 Best vali loss: 0.3576975
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7805473804473877
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3636029 Best vali loss: 0.3576975

best validation loss 0.3576974996649212

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013541182315, 'e_layers': 4, 'learning_rate': 0.000294370569, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5486806
	speed: 0.0114s/iter; left time: 45.8216s
	iters: 200, epoch: 1 | loss: 0.9413745
	speed: 0.0053s/iter; left time: 20.7790s
	iters: 300, epoch: 1 | loss: 0.3373466
	speed: 0.0048s/iter; left time: 18.1525s
	iters: 400, epoch: 1 | loss: 0.4828559
	speed: 0.0049s/iter; left time: 18.2689s
	iters: 500, epoch: 1 | loss: 0.4543806
	speed: 0.0052s/iter; left time: 18.6181s
Updating learning rate to 0.00028316675633640074
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 2.956739664077759
Epoch: 1, Steps: 514 | Train Loss: 0.5529276 Vali Loss: 0.3742124 Best vali loss: 0.3742124
	iters: 100, epoch: 2 | loss: 0.2845148
	speed: 0.0099s/iter; left time: 34.5562s
	iters: 200, epoch: 2 | loss: 0.6321593
	speed: 0.0047s/iter; left time: 16.0612s
	iters: 300, epoch: 2 | loss: 0.7438662
	speed: 0.0047s/iter; left time: 15.3684s
	iters: 400, epoch: 2 | loss: 0.3710927
	speed: 0.0047s/iter; left time: 14.8845s
	iters: 500, epoch: 2 | loss: 0.8834688
	speed: 0.0047s/iter; left time: 14.6329s
Updating learning rate to 0.00025126099726082124
Validation loss decreased (0.3742 --> 0.3682).  Saving model state dict ...
Epoch: 2 cost time: 2.466130256652832
Epoch: 2, Steps: 514 | Train Loss: 0.5830204 Vali Loss: 0.3682142 Best vali loss: 0.3682142
	iters: 100, epoch: 3 | loss: 0.9507338
	speed: 0.0095s/iter; left time: 28.3965s
	iters: 200, epoch: 3 | loss: 0.3979883
	speed: 0.0045s/iter; left time: 12.9262s
	iters: 300, epoch: 3 | loss: 0.2061108
	speed: 0.0045s/iter; left time: 12.4702s
	iters: 400, epoch: 3 | loss: 0.4524701
	speed: 0.0046s/iter; left time: 12.3034s
	iters: 500, epoch: 3 | loss: 0.2535191
	speed: 0.0048s/iter; left time: 12.3859s
Updating learning rate to 0.00020351065436609227
Epoch: 3 cost time: 2.4203531742095947
Epoch: 3, Steps: 514 | Train Loss: 0.4521644 Vali Loss: 0.3684971 Best vali loss: 0.3682142

best validation loss 0.36821422103814383

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008607356861, 'e_layers': 4, 'learning_rate': 0.0003304922934, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4812178
	speed: 0.0160s/iter; left time: 14.9367s
Updating learning rate to 0.0003304922934
Validation loss decreased (inf --> 0.3799).  Saving model state dict ...
Epoch: 1 cost time: 1.6083910465240479
Epoch: 1, Steps: 129 | Train Loss: 0.4812178 Vali Loss: 0.3798822 Best vali loss: 0.3798822
	iters: 100, epoch: 2 | loss: 0.6164308
	speed: 0.0157s/iter; left time: 12.6517s
Updating learning rate to 0.0001652461467
Validation loss decreased (0.3799 --> 0.3682).  Saving model state dict ...
Epoch: 2 cost time: 1.2969372272491455
Epoch: 2, Steps: 129 | Train Loss: 0.6164308 Vali Loss: 0.3682049 Best vali loss: 0.3682049
	iters: 100, epoch: 3 | loss: 0.6816824
	speed: 0.0160s/iter; left time: 10.7938s
Updating learning rate to 8.262307335e-05
Epoch: 3 cost time: 1.2858655452728271
Epoch: 3, Steps: 129 | Train Loss: 0.6816824 Vali Loss: 0.3685862 Best vali loss: 0.3682049

best validation loss 0.3682049254537331

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009761532013, 'e_layers': 2, 'learning_rate': 0.0003134257908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4155084
	speed: 0.0115s/iter; left time: 10.7466s
Updating learning rate to 0.0003134257908
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 1.0372228622436523
Epoch: 1, Steps: 129 | Train Loss: 0.4155084 Vali Loss: 0.3649678 Best vali loss: 0.3649678
	iters: 100, epoch: 2 | loss: 0.4875995
	speed: 0.0092s/iter; left time: 7.3743s
Updating learning rate to 0.0001567128954
Epoch: 2 cost time: 0.7159128189086914
Epoch: 2, Steps: 129 | Train Loss: 0.4875995 Vali Loss: 0.3845383 Best vali loss: 0.3649678
	iters: 100, epoch: 3 | loss: 0.9175744
	speed: 0.0088s/iter; left time: 5.9513s
Updating learning rate to 7.83564477e-05
Validation loss decreased (0.3650 --> 0.3499).  Saving model state dict ...
Epoch: 3 cost time: 0.7106380462646484
Epoch: 3, Steps: 129 | Train Loss: 0.9175744 Vali Loss: 0.3499398 Best vali loss: 0.3499398

best validation loss 0.3499397675274397

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009761532013, 'e_layers': 2, 'learning_rate': 0.0003134257908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3495657
	speed: 0.0119s/iter; left time: 6.5035s
Updating learning rate to 3.917822385e-05
Validation loss decreased (0.3499 --> 0.3447).  Saving model state dict ...
Epoch: 4 cost time: 1.0326979160308838
Epoch: 4, Steps: 129 | Train Loss: 0.3495657 Vali Loss: 0.3446517 Best vali loss: 0.3446517
	iters: 100, epoch: 5 | loss: 0.4169372
	speed: 0.0091s/iter; left time: 3.7807s
Updating learning rate to 1.9589111925e-05
Epoch: 5 cost time: 0.7113168239593506
Epoch: 5, Steps: 129 | Train Loss: 0.4169372 Vali Loss: 0.3450320 Best vali loss: 0.3446517
	iters: 100, epoch: 6 | loss: 0.8168001
	speed: 0.0088s/iter; left time: 2.5435s
Updating learning rate to 9.7945559625e-06
Epoch: 6 cost time: 0.7094306945800781
Epoch: 6, Steps: 129 | Train Loss: 0.8168001 Vali Loss: 0.3465013 Best vali loss: 0.3446517
	iters: 100, epoch: 7 | loss: 0.5278673
	speed: 0.0087s/iter; left time: 1.3883s
Updating learning rate to 4.89727798125e-06
Validation loss decreased (0.3447 --> 0.3445).  Saving model state dict ...
Epoch: 7 cost time: 0.705237627029419
Epoch: 7, Steps: 129 | Train Loss: 0.5278673 Vali Loss: 0.3444759 Best vali loss: 0.3444759
	iters: 100, epoch: 8 | loss: 0.6083383
	speed: 0.0091s/iter; left time: 0.2732s
Updating learning rate to 2.448638990625e-06
Validation loss decreased (0.3445 --> 0.3421).  Saving model state dict ...
Epoch: 8 cost time: 0.7117431163787842
Epoch: 8, Steps: 129 | Train Loss: 0.6083383 Vali Loss: 0.3420815 Best vali loss: 0.3420815

best validation loss 0.34208153945289566

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0009457574584, 'e_layers': 4, 'learning_rate': 0.0002556742678, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4664634
	speed: 0.0160s/iter; left time: 14.9298s
Updating learning rate to 0.0002556742678
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.610276699066162
Epoch: 1, Steps: 129 | Train Loss: 0.4664634 Vali Loss: 0.3686881 Best vali loss: 0.3686881
	iters: 100, epoch: 2 | loss: 0.5407811
	speed: 0.0156s/iter; left time: 12.5717s
Updating learning rate to 0.0001278371339
Validation loss decreased (0.3687 --> 0.3497).  Saving model state dict ...
Epoch: 2 cost time: 1.2962861061096191
Epoch: 2, Steps: 129 | Train Loss: 0.5407811 Vali Loss: 0.3496742 Best vali loss: 0.3496742
	iters: 100, epoch: 3 | loss: 0.6188747
	speed: 0.0159s/iter; left time: 10.7403s
Updating learning rate to 6.391856695e-05
Epoch: 3 cost time: 1.3008267879486084
Epoch: 3, Steps: 129 | Train Loss: 0.6188747 Vali Loss: 0.3704978 Best vali loss: 0.3496742
	iters: 100, epoch: 4 | loss: 0.6456047
	speed: 0.0152s/iter; left time: 8.3075s
Updating learning rate to 3.1959283475e-05
Validation loss decreased (0.3497 --> 0.3494).  Saving model state dict ...
Epoch: 4 cost time: 1.29034423828125
Epoch: 4, Steps: 129 | Train Loss: 0.6456047 Vali Loss: 0.3494256 Best vali loss: 0.3494256
	iters: 100, epoch: 5 | loss: 0.4607942
	speed: 0.0159s/iter; left time: 6.6269s
Updating learning rate to 1.59796417375e-05
Epoch: 5 cost time: 1.297433614730835
Epoch: 5, Steps: 129 | Train Loss: 0.4607942 Vali Loss: 0.3545717 Best vali loss: 0.3494256
	iters: 100, epoch: 6 | loss: 0.3466663
	speed: 0.0153s/iter; left time: 4.4096s
Updating learning rate to 7.98982086875e-06
Validation loss decreased (0.3494 --> 0.3485).  Saving model state dict ...
Epoch: 6 cost time: 1.2905058860778809
Epoch: 6, Steps: 129 | Train Loss: 0.3466663 Vali Loss: 0.3485111 Best vali loss: 0.3485111
	iters: 100, epoch: 7 | loss: 0.3704856
	speed: 0.0159s/iter; left time: 2.5302s
Updating learning rate to 3.994910434375e-06
Epoch: 7 cost time: 1.3035492897033691
Epoch: 7, Steps: 129 | Train Loss: 0.3704856 Vali Loss: 0.3548657 Best vali loss: 0.3485111
	iters: 100, epoch: 8 | loss: 0.4852711
	speed: 0.0153s/iter; left time: 0.4591s
Updating learning rate to 1.9974552171875e-06
Epoch: 8 cost time: 1.2877376079559326
Epoch: 8, Steps: 129 | Train Loss: 0.4852711 Vali Loss: 0.3521650 Best vali loss: 0.3485111

best validation loss 0.3485110929415128

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0076290206313, 'e_layers': 4, 'learning_rate': 0.0005867459548, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3560752
	speed: 0.0115s/iter; left time: 22.4780s
	iters: 200, epoch: 1 | loss: 0.6051552
	speed: 0.0049s/iter; left time: 9.0511s
Updating learning rate to 0.0005867459548
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 1.659752607345581
Epoch: 1, Steps: 257 | Train Loss: 0.4806152 Vali Loss: 0.3653471 Best vali loss: 0.3653471
	iters: 100, epoch: 2 | loss: 0.7719017
	speed: 0.0106s/iter; left time: 18.0905s
	iters: 200, epoch: 2 | loss: 0.5460576
	speed: 0.0050s/iter; left time: 7.9554s
Updating learning rate to 0.0002933729774
Epoch: 2 cost time: 1.3169057369232178
Epoch: 2, Steps: 257 | Train Loss: 0.6589796 Vali Loss: 0.3714400 Best vali loss: 0.3653471
	iters: 100, epoch: 3 | loss: 0.7638656
	speed: 0.0104s/iter; left time: 15.0674s
	iters: 200, epoch: 3 | loss: 0.6736427
	speed: 0.0049s/iter; left time: 6.5311s
Updating learning rate to 0.0001466864887
Validation loss decreased (0.3653 --> 0.3522).  Saving model state dict ...
Epoch: 3 cost time: 1.3083949089050293
Epoch: 3, Steps: 257 | Train Loss: 0.7187542 Vali Loss: 0.3521989 Best vali loss: 0.3521989
	iters: 100, epoch: 4 | loss: 0.5356098
	speed: 0.0107s/iter; left time: 12.6769s
	iters: 200, epoch: 4 | loss: 0.5249138
	speed: 0.0050s/iter; left time: 5.3780s
Updating learning rate to 7.334324435e-05
Validation loss decreased (0.3522 --> 0.3456).  Saving model state dict ...
Epoch: 4 cost time: 1.3283579349517822
Epoch: 4, Steps: 257 | Train Loss: 0.5302618 Vali Loss: 0.3455532 Best vali loss: 0.3455532
	iters: 100, epoch: 5 | loss: 0.3037662
	speed: 0.0109s/iter; left time: 10.1620s
	iters: 200, epoch: 5 | loss: 0.3412006
	speed: 0.0049s/iter; left time: 4.0851s
Updating learning rate to 3.6671622175e-05
Validation loss decreased (0.3456 --> 0.3435).  Saving model state dict ...
Epoch: 5 cost time: 1.322754144668579
Epoch: 5, Steps: 257 | Train Loss: 0.3224834 Vali Loss: 0.3434634 Best vali loss: 0.3434634
	iters: 100, epoch: 6 | loss: 0.5075617
	speed: 0.0107s/iter; left time: 7.2080s
	iters: 200, epoch: 6 | loss: 0.5784078
	speed: 0.0049s/iter; left time: 2.7827s
Updating learning rate to 1.83358110875e-05
Epoch: 6 cost time: 1.3146800994873047
Epoch: 6, Steps: 257 | Train Loss: 0.5429848 Vali Loss: 0.3469526 Best vali loss: 0.3434634
	iters: 100, epoch: 7 | loss: 0.4325551
	speed: 0.0103s/iter; left time: 4.2695s
	iters: 200, epoch: 7 | loss: 0.3464352
	speed: 0.0048s/iter; left time: 1.5225s
Updating learning rate to 9.16790554375e-06
Epoch: 7 cost time: 1.2940027713775635
Epoch: 7, Steps: 257 | Train Loss: 0.3894951 Vali Loss: 0.3472948 Best vali loss: 0.3434634
	iters: 100, epoch: 8 | loss: 0.7663155
	speed: 0.0101s/iter; left time: 1.6023s
	iters: 200, epoch: 8 | loss: 0.4035993
	speed: 0.0046s/iter; left time: 0.2672s
Updating learning rate to 4.583952771875e-06
Epoch: 8 cost time: 1.2429487705230713
Epoch: 8, Steps: 257 | Train Loss: 0.5849574 Vali Loss: 0.3488585 Best vali loss: 0.3434634

best validation loss 0.3434634251655436

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0089921568658, 'e_layers': 1, 'learning_rate': 0.0002399714829, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6316791
	speed: 0.0096s/iter; left time: 8.9886s
Updating learning rate to 0.0002399714829
Validation loss decreased (inf --> 0.3642).  Saving model state dict ...
Epoch: 1 cost time: 0.7892334461212158
Epoch: 1, Steps: 129 | Train Loss: 0.6316791 Vali Loss: 0.3641981 Best vali loss: 0.3641981
	iters: 100, epoch: 2 | loss: 0.4816177
	speed: 0.0058s/iter; left time: 4.6944s
Updating learning rate to 0.00011998574145
Epoch: 2 cost time: 0.4416379928588867
Epoch: 2, Steps: 129 | Train Loss: 0.4816177 Vali Loss: 0.3655276 Best vali loss: 0.3641981
	iters: 100, epoch: 3 | loss: 0.6658219
	speed: 0.0059s/iter; left time: 3.9529s
Updating learning rate to 5.9992870725e-05
Epoch: 3 cost time: 0.44478344917297363
Epoch: 3, Steps: 129 | Train Loss: 0.6658219 Vali Loss: 0.3642703 Best vali loss: 0.3641981

best validation loss 0.3641981418217095

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022138611007, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.108217716217041
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710536 Best vali loss: 0.3710536
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3711 --> 0.3595).  Saving model state dict ...
Epoch: 2 cost time: 0.7825708389282227
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3595213 Best vali loss: 0.3595213
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3595 --> 0.3569).  Saving model state dict ...
Epoch: 3 cost time: 0.7804617881774902
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3568832 Best vali loss: 0.3568832

best validation loss 0.3568832111382063

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0045540781927, 'e_layers': 1, 'learning_rate': 0.0040853461618, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5744690
	speed: 0.0087s/iter; left time: 34.8749s
	iters: 200, epoch: 1 | loss: 0.7174392
	speed: 0.0025s/iter; left time: 9.8635s
	iters: 300, epoch: 1 | loss: 0.3292140
	speed: 0.0026s/iter; left time: 9.7674s
	iters: 400, epoch: 1 | loss: 0.6074952
	speed: 0.0026s/iter; left time: 9.4961s
	iters: 500, epoch: 1 | loss: 0.9754763
	speed: 0.0025s/iter; left time: 9.1743s
Updating learning rate to 0.003929856931955282
Validation loss decreased (inf --> 0.3958).  Saving model state dict ...
Epoch: 1 cost time: 1.669849157333374
Epoch: 1, Steps: 514 | Train Loss: 0.6408187 Vali Loss: 0.3958472 Best vali loss: 0.3958472
	iters: 100, epoch: 2 | loss: 0.3210032
	speed: 0.0062s/iter; left time: 21.7601s
	iters: 200, epoch: 2 | loss: 1.1877916
	speed: 0.0025s/iter; left time: 8.6199s
	iters: 300, epoch: 2 | loss: 0.7097374
	speed: 0.0026s/iter; left time: 8.5555s
	iters: 400, epoch: 2 | loss: 0.6226772
	speed: 0.0027s/iter; left time: 8.5764s
	iters: 500, epoch: 2 | loss: 0.5138367
	speed: 0.0027s/iter; left time: 8.3880s
Updating learning rate to 0.003487061068151607
Epoch: 2 cost time: 1.3951327800750732
Epoch: 2, Steps: 514 | Train Loss: 0.6710092 Vali Loss: 0.4042808 Best vali loss: 0.3958472
	iters: 100, epoch: 3 | loss: 0.7137799
	speed: 0.0059s/iter; left time: 17.5272s
	iters: 200, epoch: 3 | loss: 0.6043581
	speed: 0.0025s/iter; left time: 7.2406s
	iters: 300, epoch: 3 | loss: 1.0661181
	speed: 0.0026s/iter; left time: 7.1648s
	iters: 400, epoch: 3 | loss: 0.9415965
	speed: 0.0025s/iter; left time: 6.6064s
	iters: 500, epoch: 3 | loss: 0.5817488
	speed: 0.0024s/iter; left time: 6.2599s
Updating learning rate to 0.0028243702266985845
Epoch: 3 cost time: 1.314554214477539
Epoch: 3, Steps: 514 | Train Loss: 0.7815203 Vali Loss: 0.4011756 Best vali loss: 0.3958472

best validation loss 0.39584715502201223

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022138611007, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3569 --> 0.3496).  Saving model state dict ...
Epoch: 4 cost time: 1.1082499027252197
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3496050 Best vali loss: 0.3496050
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7770864963531494
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3504875 Best vali loss: 0.3496050
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3496 --> 0.3427).  Saving model state dict ...
Epoch: 6 cost time: 0.7806215286254883
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3427472 Best vali loss: 0.3427472
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3427 --> 0.3409).  Saving model state dict ...
Epoch: 7 cost time: 0.7888038158416748
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3409103 Best vali loss: 0.3409103
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7760844230651855
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3434660 Best vali loss: 0.3409103

best validation loss 0.3409103340507725

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0119635466446, 'e_layers': 4, 'learning_rate': 0.0002640298194, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4102625
	speed: 0.0110s/iter; left time: 44.2799s
	iters: 200, epoch: 1 | loss: 0.3376779
	speed: 0.0048s/iter; left time: 18.8670s
	iters: 300, epoch: 1 | loss: 0.3545113
	speed: 0.0047s/iter; left time: 18.0802s
	iters: 400, epoch: 1 | loss: 0.3262272
	speed: 0.0048s/iter; left time: 17.8093s
	iters: 500, epoch: 1 | loss: 0.9356173
	speed: 0.0049s/iter; left time: 17.5849s
Updating learning rate to 0.0002539807827581557
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 2.8353397846221924
Epoch: 1, Steps: 514 | Train Loss: 0.4728592 Vali Loss: 0.3702397 Best vali loss: 0.3702397
	iters: 100, epoch: 2 | loss: 1.1156595
	speed: 0.0102s/iter; left time: 35.5760s
	iters: 200, epoch: 2 | loss: 0.9009177
	speed: 0.0052s/iter; left time: 17.7004s
	iters: 300, epoch: 2 | loss: 0.5974884
	speed: 0.0047s/iter; left time: 15.4210s
	iters: 400, epoch: 2 | loss: 0.4144357
	speed: 0.0047s/iter; left time: 15.1195s
	iters: 500, epoch: 2 | loss: 0.4391253
	speed: 0.0047s/iter; left time: 14.6034s
Updating learning rate to 0.00022536354756659972
Validation loss decreased (0.3702 --> 0.3638).  Saving model state dict ...
Epoch: 2 cost time: 2.559028148651123
Epoch: 2, Steps: 514 | Train Loss: 0.6935253 Vali Loss: 0.3637876 Best vali loss: 0.3637876
	iters: 100, epoch: 3 | loss: 0.4130577
	speed: 0.0103s/iter; left time: 30.6349s
	iters: 200, epoch: 3 | loss: 0.4346226
	speed: 0.0052s/iter; left time: 15.1186s
	iters: 300, epoch: 3 | loss: 0.7303861
	speed: 0.0052s/iter; left time: 14.5333s
	iters: 400, epoch: 3 | loss: 0.3790608
	speed: 0.0052s/iter; left time: 13.8896s
	iters: 500, epoch: 3 | loss: 0.9431636
	speed: 0.0051s/iter; left time: 13.1225s
Updating learning rate to 0.00018253482846736338
Validation loss decreased (0.3638 --> 0.3557).  Saving model state dict ...
Epoch: 3 cost time: 2.7181754112243652
Epoch: 3, Steps: 514 | Train Loss: 0.5800582 Vali Loss: 0.3556692 Best vali loss: 0.3556692
	iters: 100, epoch: 4 | loss: 0.6475585
	speed: 0.0099s/iter; left time: 24.5550s
	iters: 200, epoch: 4 | loss: 0.8541985
	speed: 0.0044s/iter; left time: 10.5027s
	iters: 300, epoch: 4 | loss: 0.3666719
	speed: 0.0045s/iter; left time: 10.2708s
	iters: 400, epoch: 4 | loss: 0.2606227
	speed: 0.0045s/iter; left time: 9.7034s
	iters: 500, epoch: 4 | loss: 0.3259257
	speed: 0.0047s/iter; left time: 9.7744s
Updating learning rate to 0.0001320149097
Validation loss decreased (0.3557 --> 0.3471).  Saving model state dict ...
Epoch: 4 cost time: 2.373769998550415
Epoch: 4, Steps: 514 | Train Loss: 0.4909954 Vali Loss: 0.3470895 Best vali loss: 0.3470895
	iters: 100, epoch: 5 | loss: 0.5057506
	speed: 0.0102s/iter; left time: 20.0237s
	iters: 200, epoch: 5 | loss: 0.6553015
	speed: 0.0052s/iter; left time: 9.6029s
	iters: 300, epoch: 5 | loss: 0.3784385
	speed: 0.0051s/iter; left time: 8.9125s
	iters: 400, epoch: 5 | loss: 0.6415092
	speed: 0.0051s/iter; left time: 8.4956s
	iters: 500, epoch: 5 | loss: 0.5608221
	speed: 0.0047s/iter; left time: 7.3548s
Updating learning rate to 8.149499093263662e-05
Epoch: 5 cost time: 2.6506357192993164
Epoch: 5, Steps: 514 | Train Loss: 0.5483644 Vali Loss: 0.3652254 Best vali loss: 0.3470895
	iters: 100, epoch: 6 | loss: 0.3845342
	speed: 0.0097s/iter; left time: 13.9951s
	iters: 200, epoch: 6 | loss: 0.6801241
	speed: 0.0048s/iter; left time: 6.4046s
	iters: 300, epoch: 6 | loss: 0.3806952
	speed: 0.0045s/iter; left time: 5.5575s
	iters: 400, epoch: 6 | loss: 0.5555683
	speed: 0.0046s/iter; left time: 5.2626s
	iters: 500, epoch: 6 | loss: 0.2622608
	speed: 0.0045s/iter; left time: 4.6516s
Updating learning rate to 3.866627183340028e-05
Epoch: 6 cost time: 2.407290458679199
Epoch: 6, Steps: 514 | Train Loss: 0.4526365 Vali Loss: 0.3599586 Best vali loss: 0.3470895
	iters: 100, epoch: 7 | loss: 0.1876452
	speed: 0.0094s/iter; left time: 8.6910s
	iters: 200, epoch: 7 | loss: 0.2926583
	speed: 0.0045s/iter; left time: 3.7442s
	iters: 300, epoch: 7 | loss: 0.6552801
	speed: 0.0048s/iter; left time: 3.4963s
	iters: 400, epoch: 7 | loss: 0.5257638
	speed: 0.0048s/iter; left time: 3.0018s
	iters: 500, epoch: 7 | loss: 0.5001663
	speed: 0.0048s/iter; left time: 2.5288s
Updating learning rate to 1.0049036641844266e-05
Epoch: 7 cost time: 2.470113754272461
Epoch: 7, Steps: 514 | Train Loss: 0.4323027 Vali Loss: 0.3762915 Best vali loss: 0.3470895
	iters: 100, epoch: 8 | loss: 0.1914754
	speed: 0.0099s/iter; left time: 4.1030s
	iters: 200, epoch: 8 | loss: 0.4998852
	speed: 0.0048s/iter; left time: 1.5155s
	iters: 300, epoch: 8 | loss: 0.5493754
	speed: 0.0048s/iter; left time: 1.0262s
	iters: 400, epoch: 8 | loss: 0.3680686
	speed: 0.0048s/iter; left time: 0.5468s
	iters: 500, epoch: 8 | loss: 0.1759485
	speed: 0.0046s/iter; left time: 0.0694s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.505519151687622
Epoch: 8, Steps: 514 | Train Loss: 0.3569506 Vali Loss: 0.3718794 Best vali loss: 0.3470895

best validation loss 0.3470894866555285

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022815028335, 'e_layers': 3, 'learning_rate': 0.0003220391117, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6445181
	speed: 0.0138s/iter; left time: 12.8328s
Updating learning rate to 0.000309782227833873
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 1.326296091079712
Epoch: 1, Steps: 129 | Train Loss: 0.6445181 Vali Loss: 0.3659221 Best vali loss: 0.3659221
	iters: 100, epoch: 2 | loss: 0.4726027
	speed: 0.0122s/iter; left time: 9.8454s
Updating learning rate to 0.000274877575695181
Validation loss decreased (0.3659 --> 0.3567).  Saving model state dict ...
Epoch: 2 cost time: 1.000429391860962
Epoch: 2, Steps: 129 | Train Loss: 0.4726027 Vali Loss: 0.3567307 Best vali loss: 0.3567307
	iters: 100, epoch: 3 | loss: 0.4449329
	speed: 0.0125s/iter; left time: 8.4462s
Updating learning rate to 0.00022263907216058028
Epoch: 3 cost time: 1.0024282932281494
Epoch: 3, Steps: 129 | Train Loss: 0.4449329 Vali Loss: 0.3700304 Best vali loss: 0.3567307
	iters: 100, epoch: 4 | loss: 0.4420450
	speed: 0.0120s/iter; left time: 6.5776s
Updating learning rate to 0.00016101955585
Validation loss decreased (0.3567 --> 0.3480).  Saving model state dict ...
Epoch: 4 cost time: 1.0051336288452148
Epoch: 4, Steps: 129 | Train Loss: 0.4420450 Vali Loss: 0.3480264 Best vali loss: 0.3480264
	iters: 100, epoch: 5 | loss: 0.4422169
	speed: 0.0127s/iter; left time: 5.2763s
Updating learning rate to 9.940003953941973e-05
Epoch: 5 cost time: 1.0197255611419678
Epoch: 5, Steps: 129 | Train Loss: 0.4422169 Vali Loss: 0.3660442 Best vali loss: 0.3480264
	iters: 100, epoch: 6 | loss: 0.4593717
	speed: 0.0121s/iter; left time: 3.4847s
Updating learning rate to 4.716153600481899e-05
Epoch: 6 cost time: 1.0037128925323486
Epoch: 6, Steps: 129 | Train Loss: 0.4593717 Vali Loss: 0.3500279 Best vali loss: 0.3480264
	iters: 100, epoch: 7 | loss: 0.4441543
	speed: 0.0123s/iter; left time: 1.9490s
Updating learning rate to 1.2256883866126974e-05
Epoch: 7 cost time: 1.0114543437957764
Epoch: 7, Steps: 129 | Train Loss: 0.4441543 Vali Loss: 0.3671138 Best vali loss: 0.3480264
	iters: 100, epoch: 8 | loss: 0.7065732
	speed: 0.0122s/iter; left time: 0.3647s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.007349967956543
Epoch: 8, Steps: 129 | Train Loss: 0.7065732 Vali Loss: 0.3630780 Best vali loss: 0.3480264

best validation loss 0.348026419880348

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020064904598, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.0916521549224854
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708609 Best vali loss: 0.3708609
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3709 --> 0.3653).  Saving model state dict ...
Epoch: 2 cost time: 0.78757643699646
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3652963 Best vali loss: 0.3652963
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3653 --> 0.3645).  Saving model state dict ...
Epoch: 3 cost time: 0.7808003425598145
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3645301 Best vali loss: 0.3645301

best validation loss 0.36453009722040774

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.008874019736, 'e_layers': 4, 'learning_rate': 0.0003274802624, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5521244
	speed: 0.0132s/iter; left time: 12.3513s
Updating learning rate to 0.0003150162870663928
Validation loss decreased (inf --> 0.3624).  Saving model state dict ...
Epoch: 1 cost time: 1.274068832397461
Epoch: 1, Steps: 129 | Train Loss: 0.5521244 Vali Loss: 0.3624438 Best vali loss: 0.3624438
	iters: 100, epoch: 2 | loss: 0.5130437
	speed: 0.0116s/iter; left time: 9.2966s
Updating learning rate to 0.000279521888323895
Epoch: 2 cost time: 0.9365980625152588
Epoch: 2, Steps: 129 | Train Loss: 0.5130437 Vali Loss: 0.3857474 Best vali loss: 0.3624438
	iters: 100, epoch: 3 | loss: 0.5708053
	speed: 0.0114s/iter; left time: 7.6726s
Updating learning rate to 0.00022640076662352614
Epoch: 3 cost time: 0.9338855743408203
Epoch: 3, Steps: 129 | Train Loss: 0.5708053 Vali Loss: 0.3845164 Best vali loss: 0.3624438

best validation loss 0.3624437908760925

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021052147031, 'e_layers': 2, 'learning_rate': 0.0007066252738, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007066252738
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 0.7648277282714844
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703701 Best vali loss: 0.3703701
Updating learning rate to 0.0003533126369
Validation loss decreased (0.3704 --> 0.3518).  Saving model state dict ...
Epoch: 2 cost time: 0.44748640060424805
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3517723 Best vali loss: 0.3517723
Updating learning rate to 0.00017665631845
Epoch: 3 cost time: 0.4432950019836426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3525094 Best vali loss: 0.3517723

best validation loss 0.35177230482485533

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021052147031, 'e_layers': 2, 'learning_rate': 0.0007066252738, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8328159225e-05
Validation loss decreased (0.3518 --> 0.3506).  Saving model state dict ...
Epoch: 4 cost time: 0.7763750553131104
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3506007 Best vali loss: 0.3506007
Updating learning rate to 4.41640796125e-05
Validation loss decreased (0.3506 --> 0.3427).  Saving model state dict ...
Epoch: 5 cost time: 0.4465663433074951
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3426772 Best vali loss: 0.3426772
Updating learning rate to 2.208203980625e-05
Epoch: 6 cost time: 0.4448966979980469
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3429252 Best vali loss: 0.3426772
Updating learning rate to 1.1041019903125e-05
Epoch: 7 cost time: 0.4438760280609131
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3434934 Best vali loss: 0.3426772
Updating learning rate to 5.5205099515625e-06
Epoch: 8 cost time: 0.44658613204956055
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3434915 Best vali loss: 0.3426772

best validation loss 0.3426771602368308

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006640218562, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5748107
	speed: 0.0118s/iter; left time: 23.1011s
	iters: 200, epoch: 1 | loss: 0.6835718
	speed: 0.0055s/iter; left time: 10.1980s
Updating learning rate to 0.0006640218562
Validation loss decreased (inf --> 0.3957).  Saving model state dict ...
Epoch: 1 cost time: 1.7664334774017334
Epoch: 1, Steps: 257 | Train Loss: 0.6291912 Vali Loss: 0.3957479 Best vali loss: 0.3957479
	iters: 100, epoch: 2 | loss: 1.0165604
	speed: 0.0115s/iter; left time: 19.6142s
	iters: 200, epoch: 2 | loss: 0.5993071
	speed: 0.0052s/iter; left time: 8.3446s
Updating learning rate to 0.0003320109281
Epoch: 2 cost time: 1.3904516696929932
Epoch: 2, Steps: 257 | Train Loss: 0.8079338 Vali Loss: 0.4050097 Best vali loss: 0.3957479
	iters: 100, epoch: 3 | loss: 0.5815721
	speed: 0.0112s/iter; left time: 16.1421s
	iters: 200, epoch: 3 | loss: 0.8499347
	speed: 0.0052s/iter; left time: 7.0140s
Updating learning rate to 0.00016600546405
Epoch: 3 cost time: 1.4113621711730957
Epoch: 3, Steps: 257 | Train Loss: 0.7157534 Vali Loss: 0.4078051 Best vali loss: 0.3957479
	iters: 100, epoch: 4 | loss: 0.8898709
	speed: 0.0119s/iter; left time: 14.0780s
	iters: 200, epoch: 4 | loss: 0.4616061
	speed: 0.0056s/iter; left time: 6.1006s
Updating learning rate to 8.3002732025e-05
Epoch: 4 cost time: 1.496342658996582
Epoch: 4, Steps: 257 | Train Loss: 0.6757385 Vali Loss: 0.4084321 Best vali loss: 0.3957479
	iters: 100, epoch: 5 | loss: 0.7952884
	speed: 0.0118s/iter; left time: 11.0064s
	iters: 200, epoch: 5 | loss: 0.6908022
	speed: 0.0057s/iter; left time: 4.7095s
Updating learning rate to 4.15013660125e-05
Epoch: 5 cost time: 1.4940872192382812
Epoch: 5, Steps: 257 | Train Loss: 0.7430453 Vali Loss: 0.4054567 Best vali loss: 0.3957479
	iters: 100, epoch: 6 | loss: 0.6804752
	speed: 0.0114s/iter; left time: 7.6461s
	iters: 200, epoch: 6 | loss: 0.6160611
	speed: 0.0052s/iter; left time: 2.9620s
Updating learning rate to 2.075068300625e-05
Epoch: 6 cost time: 1.413069725036621
Epoch: 6, Steps: 257 | Train Loss: 0.6482682 Vali Loss: 0.4026581 Best vali loss: 0.3957479
	iters: 100, epoch: 7 | loss: 0.9438008
	speed: 0.0119s/iter; left time: 4.9397s
	iters: 200, epoch: 7 | loss: 0.7865179
	speed: 0.0056s/iter; left time: 1.7724s
Updating learning rate to 1.0375341503125e-05
Epoch: 7 cost time: 1.492283582687378
Epoch: 7, Steps: 257 | Train Loss: 0.8651593 Vali Loss: 0.4037872 Best vali loss: 0.3957479
	iters: 100, epoch: 8 | loss: 0.5760491
	speed: 0.0118s/iter; left time: 1.8666s
	iters: 200, epoch: 8 | loss: 0.4341377
	speed: 0.0056s/iter; left time: 0.3232s
Updating learning rate to 5.1876707515625e-06
Epoch: 8 cost time: 1.4905271530151367
Epoch: 8, Steps: 257 | Train Loss: 0.5050934 Vali Loss: 0.4038195 Best vali loss: 0.3957479

best validation loss 0.3957479319427243

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0038817000301, 'e_layers': 2, 'learning_rate': 0.0005289400998, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5487052
	speed: 0.0098s/iter; left time: 19.1804s
	iters: 200, epoch: 1 | loss: 0.9137617
	speed: 0.0036s/iter; left time: 6.6374s
Updating learning rate to 0.0005088085159648487
Validation loss decreased (inf --> 0.3718).  Saving model state dict ...
Epoch: 1 cost time: 1.288011074066162
Epoch: 1, Steps: 257 | Train Loss: 0.7312334 Vali Loss: 0.3718300 Best vali loss: 0.3718300
	iters: 100, epoch: 2 | loss: 0.8802980
	speed: 0.0078s/iter; left time: 13.3286s
	iters: 200, epoch: 2 | loss: 0.7007032
	speed: 0.0033s/iter; left time: 5.3083s
Updating learning rate to 0.00045147861560503456
Validation loss decreased (0.3718 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 0.8970935344696045
Epoch: 2, Steps: 257 | Train Loss: 0.7905006 Vali Loss: 0.3659484 Best vali loss: 0.3659484
	iters: 100, epoch: 3 | loss: 0.3552455
	speed: 0.0074s/iter; left time: 10.6812s
	iters: 200, epoch: 3 | loss: 0.4929999
	speed: 0.0032s/iter; left time: 4.3505s
Updating learning rate to 0.00036567835635349855
Epoch: 3 cost time: 0.8707976341247559
Epoch: 3, Steps: 257 | Train Loss: 0.4241227 Vali Loss: 0.3673791 Best vali loss: 0.3659484
	iters: 100, epoch: 4 | loss: 0.8627639
	speed: 0.0074s/iter; left time: 8.7381s
	iters: 200, epoch: 4 | loss: 0.7725780
	speed: 0.0031s/iter; left time: 3.4184s
Updating learning rate to 0.0002644700499
Epoch: 4 cost time: 0.8802437782287598
Epoch: 4, Steps: 257 | Train Loss: 0.8176709 Vali Loss: 0.3703542 Best vali loss: 0.3659484
	iters: 100, epoch: 5 | loss: 0.3558899
	speed: 0.0075s/iter; left time: 7.0127s
	iters: 200, epoch: 5 | loss: 0.6215001
	speed: 0.0032s/iter; left time: 2.6351s
Updating learning rate to 0.00016326174344650143
Epoch: 5 cost time: 0.8735783100128174
Epoch: 5, Steps: 257 | Train Loss: 0.4886950 Vali Loss: 0.3742310 Best vali loss: 0.3659484
	iters: 100, epoch: 6 | loss: 0.6134403
	speed: 0.0073s/iter; left time: 4.9122s
	iters: 200, epoch: 6 | loss: 0.8176603
	speed: 0.0032s/iter; left time: 1.8485s
Updating learning rate to 7.746148419496541e-05
Epoch: 6 cost time: 0.8742184638977051
Epoch: 6, Steps: 257 | Train Loss: 0.7155503 Vali Loss: 0.3726673 Best vali loss: 0.3659484
	iters: 100, epoch: 7 | loss: 0.5279531
	speed: 0.0075s/iter; left time: 3.0944s
	iters: 200, epoch: 7 | loss: 0.3419630
	speed: 0.0032s/iter; left time: 0.9979s
Updating learning rate to 2.0131583835151324e-05
Epoch: 7 cost time: 0.8760449886322021
Epoch: 7, Steps: 257 | Train Loss: 0.4349580 Vali Loss: 0.3739903 Best vali loss: 0.3659484
	iters: 100, epoch: 8 | loss: 0.6519409
	speed: 0.0075s/iter; left time: 1.1813s
	iters: 200, epoch: 8 | loss: 0.5736864
	speed: 0.0034s/iter; left time: 0.1976s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9068450927734375
Epoch: 8, Steps: 257 | Train Loss: 0.6128137 Vali Loss: 0.3735931 Best vali loss: 0.3659484

best validation loss 0.3659483989821436

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0052300417596, 'e_layers': 2, 'learning_rate': 0.0034863293547, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3584178
	speed: 0.0101s/iter; left time: 40.3368s
	iters: 200, epoch: 1 | loss: 0.4142183
	speed: 0.0035s/iter; left time: 13.7774s
	iters: 300, epoch: 1 | loss: 0.3472635
	speed: 0.0033s/iter; left time: 12.5102s
	iters: 400, epoch: 1 | loss: 0.7653055
	speed: 0.0031s/iter; left time: 11.4582s
	iters: 500, epoch: 1 | loss: 0.4990088
	speed: 0.0031s/iter; left time: 11.1868s
Updating learning rate to 0.003353638844550306
Validation loss decreased (inf --> 0.4094).  Saving model state dict ...
Epoch: 1 cost time: 2.073748826980591
Epoch: 1, Steps: 514 | Train Loss: 0.4768428 Vali Loss: 0.4094432 Best vali loss: 0.4094432
	iters: 100, epoch: 2 | loss: 0.7471927
	speed: 0.0077s/iter; left time: 26.8811s
	iters: 200, epoch: 2 | loss: 0.4635804
	speed: 0.0035s/iter; left time: 11.9669s
	iters: 300, epoch: 2 | loss: 1.1333996
	speed: 0.0036s/iter; left time: 11.7812s
	iters: 400, epoch: 2 | loss: 0.6270909
	speed: 0.0036s/iter; left time: 11.4896s
	iters: 500, epoch: 2 | loss: 0.4030560
	speed: 0.0036s/iter; left time: 11.1608s
Updating learning rate to 0.0029757682414290453
Validation loss decreased (0.4094 --> 0.4049).  Saving model state dict ...
Epoch: 2 cost time: 1.880685567855835
Epoch: 2, Steps: 514 | Train Loss: 0.6748639 Vali Loss: 0.4049167 Best vali loss: 0.4049167
	iters: 100, epoch: 3 | loss: 0.4350756
	speed: 0.0075s/iter; left time: 22.3903s
	iters: 200, epoch: 3 | loss: 0.4641542
	speed: 0.0035s/iter; left time: 10.0533s
	iters: 300, epoch: 3 | loss: 0.6124365
	speed: 0.0034s/iter; left time: 9.4583s
	iters: 400, epoch: 3 | loss: 0.8012025
	speed: 0.0031s/iter; left time: 8.2585s
	iters: 500, epoch: 3 | loss: 0.4314266
	speed: 0.0031s/iter; left time: 7.9531s
Updating learning rate to 0.0024102449192558825
Validation loss decreased (0.4049 --> 0.3997).  Saving model state dict ...
Epoch: 3 cost time: 1.72389817237854
Epoch: 3, Steps: 514 | Train Loss: 0.5488591 Vali Loss: 0.3996845 Best vali loss: 0.3996845

best validation loss 0.39968445343212433

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007069106185, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007069106185
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.0963265895843506
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712394 Best vali loss: 0.3712394
Updating learning rate to 0.00035345530925
Validation loss decreased (0.3712 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 0.7789778709411621
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3667102 Best vali loss: 0.3667102
Updating learning rate to 0.000176727654625
Validation loss decreased (0.3667 --> 0.3580).  Saving model state dict ...
Epoch: 3 cost time: 0.7817139625549316
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3579700 Best vali loss: 0.3579700

best validation loss 0.3579700427931278

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010417519516, 'e_layers': 4, 'learning_rate': 0.0003315687454, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4972360
	speed: 0.0134s/iter; left time: 26.1986s
	iters: 200, epoch: 1 | loss: 0.5550321
	speed: 0.0072s/iter; left time: 13.2822s
Updating learning rate to 0.0003189491614477529
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 2.1848793029785156
Epoch: 1, Steps: 257 | Train Loss: 0.5261341 Vali Loss: 0.3725454 Best vali loss: 0.3725454
	iters: 100, epoch: 2 | loss: 0.9782335
	speed: 0.0151s/iter; left time: 25.6885s
	iters: 200, epoch: 2 | loss: 0.6486167
	speed: 0.0072s/iter; left time: 11.5712s
Updating learning rate to 0.00028301162685092794
Validation loss decreased (0.3725 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 1.8894000053405762
Epoch: 2, Steps: 257 | Train Loss: 0.8134251 Vali Loss: 0.3648511 Best vali loss: 0.3648511
	iters: 100, epoch: 3 | loss: 0.5172619
	speed: 0.0153s/iter; left time: 22.1038s
	iters: 200, epoch: 3 | loss: 0.5834438
	speed: 0.0072s/iter; left time: 9.6122s
Updating learning rate to 0.00022922730547732928
Epoch: 3 cost time: 1.879286289215088
Epoch: 3, Steps: 257 | Train Loss: 0.5503529 Vali Loss: 0.3819359 Best vali loss: 0.3648511

best validation loss 0.364851140402155

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007069106185, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83638273125e-05
Epoch: 4 cost time: 1.1034409999847412
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3604162 Best vali loss: 0.3579700
Updating learning rate to 4.418191365625e-05
Validation loss decreased (0.3580 --> 0.3486).  Saving model state dict ...
Epoch: 5 cost time: 0.7796587944030762
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3485605 Best vali loss: 0.3485605
Updating learning rate to 2.2090956828125e-05
Validation loss decreased (0.3486 --> 0.3454).  Saving model state dict ...
Epoch: 6 cost time: 0.7821805477142334
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3453525 Best vali loss: 0.3453525
Updating learning rate to 1.10454784140625e-05
Validation loss decreased (0.3454 --> 0.3443).  Saving model state dict ...
Epoch: 7 cost time: 0.7847130298614502
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3443079 Best vali loss: 0.3443079
Updating learning rate to 5.52273920703125e-06
Epoch: 8 cost time: 0.7831976413726807
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3455577 Best vali loss: 0.3443079

best validation loss 0.34430794998095876

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023062471281, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.1037027835845947
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714935 Best vali loss: 0.3714935
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3715 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 0.7875299453735352
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3623294 Best vali loss: 0.3623294
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7884917259216309
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3705059 Best vali loss: 0.3623294
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3623 --> 0.3547).  Saving model state dict ...
Epoch: 4 cost time: 0.7797412872314453
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3546876 Best vali loss: 0.3546876
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3547 --> 0.3524).  Saving model state dict ...
Epoch: 5 cost time: 0.7843918800354004
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3524447 Best vali loss: 0.3524447
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3524 --> 0.3490).  Saving model state dict ...
Epoch: 6 cost time: 0.7843868732452393
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3490417 Best vali loss: 0.3490417
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7871522903442383
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3542151 Best vali loss: 0.3490417
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7868750095367432
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3545753 Best vali loss: 0.3490417

best validation loss 0.34904168571376615

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020766986826, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 0.8588988780975342
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701209 Best vali loss: 0.3701209
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.5619926452636719
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3783719 Best vali loss: 0.3701209
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3701 --> 0.3505).  Saving model state dict ...
Epoch: 3 cost time: 0.5656356811523438
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3505384 Best vali loss: 0.3505384
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.5646481513977051
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3559201 Best vali loss: 0.3505384
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.5607132911682129
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3520474 Best vali loss: 0.3505384
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.5569889545440674
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3512369 Best vali loss: 0.3505384
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.5623724460601807
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3509731 Best vali loss: 0.3505384
Updating learning rate to 5.52363443828125e-06
Validation loss decreased (0.3505 --> 0.3500).  Saving model state dict ...
Epoch: 8 cost time: 0.5582635402679443
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3499933 Best vali loss: 0.3499933

best validation loss 0.3499933366808301

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012155044237, 'e_layers': 4, 'learning_rate': 0.0005255435639, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4856437
	speed: 0.0132s/iter; left time: 25.7486s
	iters: 200, epoch: 1 | loss: 0.5583282
	speed: 0.0072s/iter; left time: 13.2847s
Updating learning rate to 0.0005255435639
Validation loss decreased (inf --> 0.3934).  Saving model state dict ...
Epoch: 1 cost time: 2.1711225509643555
Epoch: 1, Steps: 257 | Train Loss: 0.5219860 Vali Loss: 0.3933721 Best vali loss: 0.3933721
	iters: 100, epoch: 2 | loss: 0.6973796
	speed: 0.0149s/iter; left time: 25.3568s
	iters: 200, epoch: 2 | loss: 0.7091792
	speed: 0.0071s/iter; left time: 11.3993s
Updating learning rate to 0.00026277178195
Epoch: 2 cost time: 1.8701114654541016
Epoch: 2, Steps: 257 | Train Loss: 0.7032794 Vali Loss: 0.4066962 Best vali loss: 0.3933721
	iters: 100, epoch: 3 | loss: 0.7635006
	speed: 0.0145s/iter; left time: 20.9507s
	iters: 200, epoch: 3 | loss: 0.8562427
	speed: 0.0071s/iter; left time: 9.5257s
Updating learning rate to 0.000131385890975
Epoch: 3 cost time: 1.8599095344543457
Epoch: 3, Steps: 257 | Train Loss: 0.8098716 Vali Loss: 0.3987007 Best vali loss: 0.3933721

best validation loss 0.39337208095374415

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0032711494032, 'e_layers': 1, 'learning_rate': 0.0004665875287, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9542213
	speed: 0.0089s/iter; left time: 17.4960s
	iters: 200, epoch: 1 | loss: 0.3797066
	speed: 0.0028s/iter; left time: 5.1330s
Updating learning rate to 0.0004488290982954763
Validation loss decreased (inf --> 0.3615).  Saving model state dict ...
Epoch: 1 cost time: 1.0559043884277344
Epoch: 1, Steps: 257 | Train Loss: 0.6669639 Vali Loss: 0.3615496 Best vali loss: 0.3615496
	iters: 100, epoch: 2 | loss: 0.4393841
	speed: 0.0066s/iter; left time: 11.1602s
	iters: 200, epoch: 2 | loss: 0.8225219
	speed: 0.0025s/iter; left time: 4.0125s
Updating learning rate to 0.0003982573671304214
Epoch: 2 cost time: 0.6997554302215576
Epoch: 2, Steps: 257 | Train Loss: 0.6309530 Vali Loss: 0.3695590 Best vali loss: 0.3615496
	iters: 100, epoch: 3 | loss: 0.6796541
	speed: 0.0064s/iter; left time: 9.1775s
	iters: 200, epoch: 3 | loss: 0.5619479
	speed: 0.0027s/iter; left time: 3.5592s
Updating learning rate to 0.0003225714228408304
Epoch: 3 cost time: 0.7219574451446533
Epoch: 3, Steps: 257 | Train Loss: 0.6208010 Vali Loss: 0.3801463 Best vali loss: 0.3615496

best validation loss 0.3615495804016623

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0008956989168, 'e_layers': 4, 'learning_rate': 0.0002176807075, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5565172
	speed: 0.0121s/iter; left time: 11.2507s
Updating learning rate to 0.0002176807075
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 1.1208622455596924
Epoch: 1, Steps: 129 | Train Loss: 0.5565172 Vali Loss: 0.3636597 Best vali loss: 0.3636597
	iters: 100, epoch: 2 | loss: 0.5085152
	speed: 0.0097s/iter; left time: 7.7773s
Updating learning rate to 0.00010884035375
Epoch: 2 cost time: 0.8080699443817139
Epoch: 2, Steps: 129 | Train Loss: 0.5085152 Vali Loss: 0.3719453 Best vali loss: 0.3636597
	iters: 100, epoch: 3 | loss: 0.4818617
	speed: 0.0095s/iter; left time: 6.4071s
Updating learning rate to 5.4420176875e-05
Validation loss decreased (0.3637 --> 0.3611).  Saving model state dict ...
Epoch: 3 cost time: 0.7683236598968506
Epoch: 3, Steps: 129 | Train Loss: 0.4818617 Vali Loss: 0.3611071 Best vali loss: 0.3611071

best validation loss 0.3611070642302687

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0008956989168, 'e_layers': 4, 'learning_rate': 0.0002176807075, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4980494
	speed: 0.0121s/iter; left time: 6.6228s
Updating learning rate to 2.72100884375e-05
Epoch: 4 cost time: 1.099611759185791
Epoch: 4, Steps: 129 | Train Loss: 0.4980494 Vali Loss: 0.3623026 Best vali loss: 0.3611071
	iters: 100, epoch: 5 | loss: 0.4280624
	speed: 0.0097s/iter; left time: 4.0450s
Updating learning rate to 1.360504421875e-05
Epoch: 5 cost time: 0.812291145324707
Epoch: 5, Steps: 129 | Train Loss: 0.4280624 Vali Loss: 0.3681981 Best vali loss: 0.3611071
	iters: 100, epoch: 6 | loss: 0.4248235
	speed: 0.0098s/iter; left time: 2.8127s
Updating learning rate to 6.802522109375e-06
Epoch: 6 cost time: 0.810676097869873
Epoch: 6, Steps: 129 | Train Loss: 0.4248235 Vali Loss: 0.3633273 Best vali loss: 0.3611071
	iters: 100, epoch: 7 | loss: 0.5509959
	speed: 0.0093s/iter; left time: 1.4709s
Updating learning rate to 3.4012610546875e-06
Epoch: 7 cost time: 0.7476086616516113
Epoch: 7, Steps: 129 | Train Loss: 0.5509959 Vali Loss: 0.3633581 Best vali loss: 0.3611071
	iters: 100, epoch: 8 | loss: 0.4633525
	speed: 0.0087s/iter; left time: 0.2621s
Updating learning rate to 1.70063052734375e-06
Epoch: 8 cost time: 0.7282462120056152
Epoch: 8, Steps: 129 | Train Loss: 0.4633525 Vali Loss: 0.3626604 Best vali loss: 0.3611071

best validation loss 0.3611070642302687

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0020355691423, 'e_layers': 2, 'learning_rate': 0.0017579343515, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3577662
	speed: 0.0095s/iter; left time: 38.1678s
	iters: 200, epoch: 1 | loss: 0.3157811
	speed: 0.0034s/iter; left time: 13.1721s
	iters: 300, epoch: 1 | loss: 0.3676299
	speed: 0.0035s/iter; left time: 13.3397s
	iters: 400, epoch: 1 | loss: 0.4748343
	speed: 0.0035s/iter; left time: 12.9497s
	iters: 500, epoch: 1 | loss: 0.9293920
	speed: 0.0033s/iter; left time: 11.9033s
Updating learning rate to 0.0016910269591746759
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 2.1018788814544678
Epoch: 1, Steps: 514 | Train Loss: 0.4890807 Vali Loss: 0.3703859 Best vali loss: 0.3703859
	iters: 100, epoch: 2 | loss: 0.3259739
	speed: 0.0074s/iter; left time: 25.8294s
	iters: 200, epoch: 2 | loss: 0.5483872
	speed: 0.0035s/iter; left time: 11.9286s
	iters: 300, epoch: 2 | loss: 0.6707854
	speed: 0.0034s/iter; left time: 11.0818s
	iters: 400, epoch: 2 | loss: 0.5796616
	speed: 0.0033s/iter; left time: 10.5312s
	iters: 500, epoch: 2 | loss: 0.7577148
	speed: 0.0033s/iter; left time: 10.3613s
Updating learning rate to 0.0015004908261632129
Epoch: 2 cost time: 1.7894036769866943
Epoch: 2, Steps: 514 | Train Loss: 0.5765046 Vali Loss: 0.3711320 Best vali loss: 0.3703859
	iters: 100, epoch: 3 | loss: 0.4243437
	speed: 0.0071s/iter; left time: 21.2491s
	iters: 200, epoch: 3 | loss: 0.4359986
	speed: 0.0032s/iter; left time: 9.3510s
	iters: 300, epoch: 3 | loss: 0.6301102
	speed: 0.0032s/iter; left time: 8.8567s
	iters: 400, epoch: 3 | loss: 0.8591238
	speed: 0.0032s/iter; left time: 8.5994s
	iters: 500, epoch: 3 | loss: 0.4320098
	speed: 0.0033s/iter; left time: 8.4101s
Updating learning rate to 0.001215333351502259
Validation loss decreased (0.3704 --> 0.3676).  Saving model state dict ...
Epoch: 3 cost time: 1.7001688480377197
Epoch: 3, Steps: 514 | Train Loss: 0.5563172 Vali Loss: 0.3675636 Best vali loss: 0.3675636
	iters: 100, epoch: 4 | loss: 1.2055315
	speed: 0.0072s/iter; left time: 17.7013s
	iters: 200, epoch: 4 | loss: 1.0211363
	speed: 0.0032s/iter; left time: 7.5085s
	iters: 300, epoch: 4 | loss: 0.5465413
	speed: 0.0032s/iter; left time: 7.2538s
	iters: 400, epoch: 4 | loss: 0.3589677
	speed: 0.0032s/iter; left time: 7.0412s
	iters: 500, epoch: 4 | loss: 0.2884971
	speed: 0.0033s/iter; left time: 6.8228s
Updating learning rate to 0.00087896717575
Epoch: 4 cost time: 1.6948137283325195
Epoch: 4, Steps: 514 | Train Loss: 0.6841348 Vali Loss: 0.3849513 Best vali loss: 0.3675636
	iters: 100, epoch: 5 | loss: 0.3264436
	speed: 0.0075s/iter; left time: 14.6318s
	iters: 200, epoch: 5 | loss: 0.5328178
	speed: 0.0035s/iter; left time: 6.4861s
	iters: 300, epoch: 5 | loss: 0.6610482
	speed: 0.0035s/iter; left time: 6.1032s
	iters: 400, epoch: 5 | loss: 0.3475400
	speed: 0.0035s/iter; left time: 5.7375s
	iters: 500, epoch: 5 | loss: 0.3357135
	speed: 0.0034s/iter; left time: 5.3555s
Updating learning rate to 0.0005426009999977409
Epoch: 5 cost time: 1.8325414657592773
Epoch: 5, Steps: 514 | Train Loss: 0.4407126 Vali Loss: 0.3894709 Best vali loss: 0.3675636
	iters: 100, epoch: 6 | loss: 0.6621404
	speed: 0.0074s/iter; left time: 10.6408s
	iters: 200, epoch: 6 | loss: 0.8644534
	speed: 0.0035s/iter; left time: 4.6810s
	iters: 300, epoch: 6 | loss: 0.5473475
	speed: 0.0036s/iter; left time: 4.4267s
	iters: 400, epoch: 6 | loss: 0.5042624
	speed: 0.0035s/iter; left time: 3.9608s
	iters: 500, epoch: 6 | loss: 0.5061939
	speed: 0.0033s/iter; left time: 3.4178s
Updating learning rate to 0.00025744352533678714
Epoch: 6 cost time: 1.8174490928649902
Epoch: 6, Steps: 514 | Train Loss: 0.6168795 Vali Loss: 0.3950930 Best vali loss: 0.3675636
	iters: 100, epoch: 7 | loss: 0.3648601
	speed: 0.0074s/iter; left time: 6.8288s
	iters: 200, epoch: 7 | loss: 0.6190569
	speed: 0.0035s/iter; left time: 2.8948s
	iters: 300, epoch: 7 | loss: 0.4913028
	speed: 0.0033s/iter; left time: 2.4200s
	iters: 400, epoch: 7 | loss: 0.4197325
	speed: 0.0032s/iter; left time: 2.0286s
	iters: 500, epoch: 7 | loss: 0.7858045
	speed: 0.0032s/iter; left time: 1.6900s
Updating learning rate to 6.690739232532399e-05
Epoch: 7 cost time: 1.7680504322052002
Epoch: 7, Steps: 514 | Train Loss: 0.5361513 Vali Loss: 0.3962979 Best vali loss: 0.3675636
	iters: 100, epoch: 8 | loss: 0.2862756
	speed: 0.0071s/iter; left time: 2.9451s
	iters: 200, epoch: 8 | loss: 0.6047318
	speed: 0.0033s/iter; left time: 1.0242s
	iters: 300, epoch: 8 | loss: 0.5102196
	speed: 0.0031s/iter; left time: 0.6707s
	iters: 400, epoch: 8 | loss: 0.6516084
	speed: 0.0033s/iter; left time: 0.3769s
	iters: 500, epoch: 8 | loss: 0.2534715
	speed: 0.0031s/iter; left time: 0.0465s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6864328384399414
Epoch: 8, Steps: 514 | Train Loss: 0.4612614 Vali Loss: 0.4001313 Best vali loss: 0.3675636

best validation loss 0.36756359487479234

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3824).  Saving model state dict ...
Epoch: 1 cost time: 1.3263144493103027
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3823539 Best vali loss: 0.3823539
Updating learning rate to 0.00035374494395
Epoch: 2 cost time: 1.018876552581787
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3824332 Best vali loss: 0.3823539
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 1.0111770629882812
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3831449 Best vali loss: 0.3823539
Updating learning rate to 8.84362359875e-05
Epoch: 4 cost time: 1.0153703689575195
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3943618 Best vali loss: 0.3823539
Updating learning rate to 4.421811799375e-05
Validation loss decreased (0.3824 --> 0.3516).  Saving model state dict ...
Epoch: 5 cost time: 1.0122203826904297
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3516262 Best vali loss: 0.3516262
Updating learning rate to 2.2109058996875e-05
Validation loss decreased (0.3516 --> 0.3476).  Saving model state dict ...
Epoch: 6 cost time: 1.014808177947998
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3475546 Best vali loss: 0.3475546
Updating learning rate to 1.10545294984375e-05
Validation loss decreased (0.3476 --> 0.3441).  Saving model state dict ...
Epoch: 7 cost time: 1.0281684398651123
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3440813 Best vali loss: 0.3440813
Updating learning rate to 5.52726474921875e-06
Epoch: 8 cost time: 1.0593500137329102
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3445121 Best vali loss: 0.3440813

best validation loss 0.34408132820326126

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0020646239673, 'e_layers': 2, 'learning_rate': 0.0003244825464, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003244825464
Validation loss decreased (inf --> 0.3625).  Saving model state dict ...
Epoch: 1 cost time: 0.6789357662200928
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3625214 Best vali loss: 0.3625214
Updating learning rate to 0.0001622412732
Epoch: 2 cost time: 0.38011646270751953
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3671014 Best vali loss: 0.3625214
Updating learning rate to 8.11206366e-05
Validation loss decreased (0.3625 --> 0.3623).  Saving model state dict ...
Epoch: 3 cost time: 0.35494494438171387
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3623219 Best vali loss: 0.3623219

best validation loss 0.362321922996892

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022397656137, 'e_layers': 4, 'learning_rate': 0.0003295129378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003295129378
Validation loss decreased (inf --> 0.3613).  Saving model state dict ...
Epoch: 1 cost time: 1.1527659893035889
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3613146 Best vali loss: 0.3613146
Updating learning rate to 0.0001647564689
Epoch: 2 cost time: 0.8196406364440918
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3680600 Best vali loss: 0.3613146
Updating learning rate to 8.237823445e-05
Validation loss decreased (0.3613 --> 0.3567).  Saving model state dict ...
Epoch: 3 cost time: 0.8095903396606445
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3567240 Best vali loss: 0.3567240

best validation loss 0.3567240247440713

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019346273851, 'e_layers': 4, 'learning_rate': 0.000329713307, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5507844
	speed: 0.0138s/iter; left time: 12.8608s
Updating learning rate to 0.000329713307
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 1.3251793384552002
Epoch: 1, Steps: 129 | Train Loss: 0.5507844 Vali Loss: 0.3649579 Best vali loss: 0.3649579
	iters: 100, epoch: 2 | loss: 0.5391223
	speed: 0.0122s/iter; left time: 9.8077s
Updating learning rate to 0.0001648566535
Epoch: 2 cost time: 0.9753735065460205
Epoch: 2, Steps: 129 | Train Loss: 0.5391223 Vali Loss: 0.3841027 Best vali loss: 0.3649579
	iters: 100, epoch: 3 | loss: 0.5046523
	speed: 0.0115s/iter; left time: 7.7940s
Updating learning rate to 8.242832675e-05
Epoch: 3 cost time: 0.9499185085296631
Epoch: 3, Steps: 129 | Train Loss: 0.5046523 Vali Loss: 0.3830978 Best vali loss: 0.3649579

best validation loss 0.36495788606772955

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022397656137, 'e_layers': 4, 'learning_rate': 0.0003295129378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 4.1189117225e-05
Validation loss decreased (0.3567 --> 0.3545).  Saving model state dict ...
Epoch: 4 cost time: 1.1357781887054443
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3544755 Best vali loss: 0.3544755
Updating learning rate to 2.05945586125e-05
Epoch: 5 cost time: 0.8077831268310547
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3560726 Best vali loss: 0.3544755
Updating learning rate to 1.029727930625e-05
Epoch: 6 cost time: 0.8082761764526367
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3608320 Best vali loss: 0.3544755
Updating learning rate to 5.148639653125e-06
Epoch: 7 cost time: 0.8190522193908691
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3557640 Best vali loss: 0.3544755
Updating learning rate to 2.5743198265625e-06
Epoch: 8 cost time: 0.802558183670044
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3621207 Best vali loss: 0.3544755

best validation loss 0.35447547636004

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013409761737, 'e_layers': 4, 'learning_rate': 0.0003277226363, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4863813
	speed: 0.0159s/iter; left time: 14.8148s
Updating learning rate to 0.0003277226363
Validation loss decreased (inf --> 0.3532).  Saving model state dict ...
Epoch: 1 cost time: 1.603337049484253
Epoch: 1, Steps: 129 | Train Loss: 0.4863813 Vali Loss: 0.3532447 Best vali loss: 0.3532447
	iters: 100, epoch: 2 | loss: 0.5680345
	speed: 0.0156s/iter; left time: 12.5511s
Updating learning rate to 0.00016386131815
Epoch: 2 cost time: 1.3034920692443848
Epoch: 2, Steps: 129 | Train Loss: 0.5680345 Vali Loss: 0.3545618 Best vali loss: 0.3532447
	iters: 100, epoch: 3 | loss: 0.6434495
	speed: 0.0153s/iter; left time: 10.3433s
Updating learning rate to 8.1930659075e-05
Epoch: 3 cost time: 1.2985920906066895
Epoch: 3, Steps: 129 | Train Loss: 0.6434495 Vali Loss: 0.3554641 Best vali loss: 0.3532447
	iters: 100, epoch: 4 | loss: 0.6671385
	speed: 0.0154s/iter; left time: 8.3930s
Updating learning rate to 4.09653295375e-05
Epoch: 4 cost time: 1.3102765083312988
Epoch: 4, Steps: 129 | Train Loss: 0.6671385 Vali Loss: 0.3555476 Best vali loss: 0.3532447
	iters: 100, epoch: 5 | loss: 0.4619858
	speed: 0.0153s/iter; left time: 6.3751s
Updating learning rate to 2.048266476875e-05
Epoch: 5 cost time: 1.2912845611572266
Epoch: 5, Steps: 129 | Train Loss: 0.4619858 Vali Loss: 0.3540666 Best vali loss: 0.3532447
	iters: 100, epoch: 6 | loss: 0.3606038
	speed: 0.0154s/iter; left time: 4.4418s
Updating learning rate to 1.0241332384375e-05
Epoch: 6 cost time: 1.3126130104064941
Epoch: 6, Steps: 129 | Train Loss: 0.3606038 Vali Loss: 0.3560933 Best vali loss: 0.3532447
	iters: 100, epoch: 7 | loss: 0.3846889
	speed: 0.0153s/iter; left time: 2.4343s
Updating learning rate to 5.1206661921875e-06
Validation loss decreased (0.3532 --> 0.3512).  Saving model state dict ...
Epoch: 7 cost time: 1.2969160079956055
Epoch: 7, Steps: 129 | Train Loss: 0.3846889 Vali Loss: 0.3511520 Best vali loss: 0.3511520
	iters: 100, epoch: 8 | loss: 0.4979176
	speed: 0.0160s/iter; left time: 0.4810s
Updating learning rate to 2.56033309609375e-06
Epoch: 8 cost time: 1.3045952320098877
Epoch: 8, Steps: 129 | Train Loss: 0.4979176 Vali Loss: 0.3528112 Best vali loss: 0.3511520

best validation loss 0.3511520439140455

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020984013993, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.1056299209594727
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711765 Best vali loss: 0.3711765
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3712 --> 0.3570).  Saving model state dict ...
Epoch: 2 cost time: 0.793936014175415
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3569575 Best vali loss: 0.3569575
Updating learning rate to 0.000176872471975
Epoch: 3 cost time: 0.7828583717346191
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3586323 Best vali loss: 0.3569575
Updating learning rate to 8.84362359875e-05
Validation loss decreased (0.3570 --> 0.3485).  Saving model state dict ...
Epoch: 4 cost time: 0.790621280670166
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3485406 Best vali loss: 0.3485406
Updating learning rate to 4.421811799375e-05
Validation loss decreased (0.3485 --> 0.3475).  Saving model state dict ...
Epoch: 5 cost time: 0.7956101894378662
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3474502 Best vali loss: 0.3474502
Updating learning rate to 2.2109058996875e-05
Validation loss decreased (0.3475 --> 0.3460).  Saving model state dict ...
Epoch: 6 cost time: 0.7942585945129395
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3460234 Best vali loss: 0.3460234
Updating learning rate to 1.10545294984375e-05
Validation loss decreased (0.3460 --> 0.3448).  Saving model state dict ...
Epoch: 7 cost time: 0.7999289035797119
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3447673 Best vali loss: 0.3447673
Updating learning rate to 5.52726474921875e-06
Validation loss decreased (0.3448 --> 0.3444).  Saving model state dict ...
Epoch: 8 cost time: 0.7939388751983643
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3444168 Best vali loss: 0.3444168

best validation loss 0.3444167938002903

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.002348591284, 'e_layers': 1, 'learning_rate': 0.000544419828, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6676967
	speed: 0.0094s/iter; left time: 8.7313s
Updating learning rate to 0.0005236990820912576
Validation loss decreased (inf --> 0.3799).  Saving model state dict ...
Epoch: 1 cost time: 0.7404468059539795
Epoch: 1, Steps: 129 | Train Loss: 0.6676967 Vali Loss: 0.3799267 Best vali loss: 0.3799267
	iters: 100, epoch: 2 | loss: 0.5174758
	speed: 0.0060s/iter; left time: 4.8530s
Updating learning rate to 0.00046469139009560695
Validation loss decreased (0.3799 --> 0.3688).  Saving model state dict ...
Epoch: 2 cost time: 0.46083927154541016
Epoch: 2, Steps: 129 | Train Loss: 0.5174758 Vali Loss: 0.3688473 Best vali loss: 0.3688473
	iters: 100, epoch: 3 | loss: 0.7888403
	speed: 0.0058s/iter; left time: 3.9309s
Updating learning rate to 0.00037638013821332593
Validation loss decreased (0.3688 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 0.4325094223022461
Epoch: 3, Steps: 129 | Train Loss: 0.7888403 Vali Loss: 0.3664691 Best vali loss: 0.3664691

best validation loss 0.3664691085548438

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010575086134, 'e_layers': 3, 'learning_rate': 0.0003302627272, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7051497
	speed: 0.0123s/iter; left time: 11.4901s
Updating learning rate to 0.0003302627272
Validation loss decreased (inf --> 0.3607).  Saving model state dict ...
Epoch: 1 cost time: 1.1152293682098389
Epoch: 1, Steps: 129 | Train Loss: 0.7051497 Vali Loss: 0.3606849 Best vali loss: 0.3606849
	iters: 100, epoch: 2 | loss: 0.6492050
	speed: 0.0099s/iter; left time: 7.9842s
Updating learning rate to 0.0001651313636
Epoch: 2 cost time: 0.7967877388000488
Epoch: 2, Steps: 129 | Train Loss: 0.6492050 Vali Loss: 0.3803615 Best vali loss: 0.3606849
	iters: 100, epoch: 3 | loss: 0.5132433
	speed: 0.0094s/iter; left time: 6.3787s
Updating learning rate to 8.25656818e-05
Epoch: 3 cost time: 0.7559199333190918
Epoch: 3, Steps: 129 | Train Loss: 0.5132433 Vali Loss: 0.3620845 Best vali loss: 0.3606849

best validation loss 0.3606849329293594

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010567968248, 'e_layers': 3, 'learning_rate': 0.0003312566044, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7056448
	speed: 0.0121s/iter; left time: 11.3229s
Updating learning rate to 0.0003312566044
Validation loss decreased (inf --> 0.3608).  Saving model state dict ...
Epoch: 1 cost time: 1.0956695079803467
Epoch: 1, Steps: 129 | Train Loss: 0.7056448 Vali Loss: 0.3607832 Best vali loss: 0.3607832
	iters: 100, epoch: 2 | loss: 0.6484086
	speed: 0.0103s/iter; left time: 8.2510s
Updating learning rate to 0.0001656283022
Epoch: 2 cost time: 0.8290317058563232
Epoch: 2, Steps: 129 | Train Loss: 0.6484086 Vali Loss: 0.3830340 Best vali loss: 0.3607832
	iters: 100, epoch: 3 | loss: 0.5030506
	speed: 0.0100s/iter; left time: 6.7638s
Updating learning rate to 8.28141511e-05
Validation loss decreased (0.3608 --> 0.3585).  Saving model state dict ...
Epoch: 3 cost time: 0.8016917705535889
Epoch: 3, Steps: 129 | Train Loss: 0.5030506 Vali Loss: 0.3585184 Best vali loss: 0.3585184

best validation loss 0.35851840688343833

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010567968248, 'e_layers': 3, 'learning_rate': 0.0003312566044, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4573941
	speed: 0.0127s/iter; left time: 6.9585s
Updating learning rate to 4.140707555e-05
Validation loss decreased (0.3585 --> 0.3523).  Saving model state dict ...
Epoch: 4 cost time: 1.1146562099456787
Epoch: 4, Steps: 129 | Train Loss: 0.4573941 Vali Loss: 0.3522618 Best vali loss: 0.3522618
	iters: 100, epoch: 5 | loss: 0.5471594
	speed: 0.0099s/iter; left time: 4.1346s
Updating learning rate to 2.0703537775e-05
Epoch: 5 cost time: 0.7901363372802734
Epoch: 5, Steps: 129 | Train Loss: 0.5471594 Vali Loss: 0.3574291 Best vali loss: 0.3522618
	iters: 100, epoch: 6 | loss: 0.4361752
	speed: 0.0097s/iter; left time: 2.7919s
Updating learning rate to 1.03517688875e-05
Epoch: 6 cost time: 0.7766063213348389
Epoch: 6, Steps: 129 | Train Loss: 0.4361752 Vali Loss: 0.3582058 Best vali loss: 0.3522618
	iters: 100, epoch: 7 | loss: 0.3214040
	speed: 0.0097s/iter; left time: 1.5455s
Updating learning rate to 5.17588444375e-06
Epoch: 7 cost time: 0.7671916484832764
Epoch: 7, Steps: 129 | Train Loss: 0.3214040 Vali Loss: 0.3599461 Best vali loss: 0.3522618
	iters: 100, epoch: 8 | loss: 0.6128704
	speed: 0.0098s/iter; left time: 0.2928s
Updating learning rate to 2.587942221875e-06
Epoch: 8 cost time: 0.7860252857208252
Epoch: 8, Steps: 129 | Train Loss: 0.6128704 Vali Loss: 0.3597783 Best vali loss: 0.3522618

best validation loss 0.35226176662154657

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0018288404354, 'e_layers': 1, 'learning_rate': 0.0010093668138, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9249309
	speed: 0.0089s/iter; left time: 71.9407s
	iters: 200, epoch: 1 | loss: 1.3645760
	speed: 0.0023s/iter; left time: 18.5071s
	iters: 300, epoch: 1 | loss: 1.2667444
	speed: 0.0023s/iter; left time: 17.9638s
	iters: 400, epoch: 1 | loss: 0.5212553
	speed: 0.0023s/iter; left time: 17.9003s
	iters: 500, epoch: 1 | loss: 0.9985887
	speed: 0.0023s/iter; left time: 17.4444s
	iters: 600, epoch: 1 | loss: 0.2839331
	speed: 0.0022s/iter; left time: 17.0777s
	iters: 700, epoch: 1 | loss: 0.9783485
	speed: 0.0023s/iter; left time: 17.6600s
	iters: 800, epoch: 1 | loss: 0.9176167
	speed: 0.0023s/iter; left time: 16.9987s
	iters: 900, epoch: 1 | loss: 0.3363203
	speed: 0.0024s/iter; left time: 17.4278s
	iters: 1000, epoch: 1 | loss: 0.4150332
	speed: 0.0024s/iter; left time: 17.3251s
Updating learning rate to 0.0010093668138
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 2.7427725791931152
Epoch: 1, Steps: 1027 | Train Loss: 0.8007347 Vali Loss: 0.3701329 Best vali loss: 0.3701329
	iters: 100, epoch: 2 | loss: 0.2222534
	speed: 0.0081s/iter; left time: 57.2634s
	iters: 200, epoch: 2 | loss: 0.4800921
	speed: 0.0024s/iter; left time: 16.4561s
	iters: 300, epoch: 2 | loss: 0.7669116
	speed: 0.0026s/iter; left time: 17.8732s
	iters: 400, epoch: 2 | loss: 1.0575159
	speed: 0.0026s/iter; left time: 17.6563s
	iters: 500, epoch: 2 | loss: 0.7925229
	speed: 0.0024s/iter; left time: 16.0217s
	iters: 600, epoch: 2 | loss: 0.5284407
	speed: 0.0024s/iter; left time: 15.9073s
	iters: 700, epoch: 2 | loss: 0.5118660
	speed: 0.0023s/iter; left time: 14.9657s
	iters: 800, epoch: 2 | loss: 0.2984414
	speed: 0.0023s/iter; left time: 14.7747s
	iters: 900, epoch: 2 | loss: 0.4864592
	speed: 0.0024s/iter; left time: 14.9069s
	iters: 1000, epoch: 2 | loss: 0.5118846
	speed: 0.0024s/iter; left time: 14.9034s
Updating learning rate to 0.0005046834069
Epoch: 2 cost time: 2.53542423248291
Epoch: 2, Steps: 1027 | Train Loss: 0.5656388 Vali Loss: 0.3715484 Best vali loss: 0.3701329
	iters: 100, epoch: 3 | loss: 0.7609701
	speed: 0.0075s/iter; left time: 45.7010s
	iters: 200, epoch: 3 | loss: 1.1604514
	speed: 0.0021s/iter; left time: 12.4456s
	iters: 300, epoch: 3 | loss: 0.2500672
	speed: 0.0021s/iter; left time: 12.3907s
	iters: 400, epoch: 3 | loss: 0.2724855
	speed: 0.0021s/iter; left time: 12.0478s
	iters: 500, epoch: 3 | loss: 0.4323712
	speed: 0.0021s/iter; left time: 11.8717s
	iters: 600, epoch: 3 | loss: 0.2249713
	speed: 0.0021s/iter; left time: 11.6375s
	iters: 700, epoch: 3 | loss: 0.3405247
	speed: 0.0021s/iter; left time: 11.3540s
	iters: 800, epoch: 3 | loss: 0.9719883
	speed: 0.0021s/iter; left time: 11.1936s
	iters: 900, epoch: 3 | loss: 0.3369353
	speed: 0.0021s/iter; left time: 10.9437s
	iters: 1000, epoch: 3 | loss: 0.3325732
	speed: 0.0021s/iter; left time: 10.7749s
Updating learning rate to 0.00025234170345
Epoch: 3 cost time: 2.1909914016723633
Epoch: 3, Steps: 1027 | Train Loss: 0.5083338 Vali Loss: 0.3753656 Best vali loss: 0.3701329
	iters: 100, epoch: 4 | loss: 0.3112635
	speed: 0.0075s/iter; left time: 37.5849s
	iters: 200, epoch: 4 | loss: 0.4148111
	speed: 0.0023s/iter; left time: 11.4843s
	iters: 300, epoch: 4 | loss: 1.1132503
	speed: 0.0022s/iter; left time: 10.4673s
	iters: 400, epoch: 4 | loss: 0.3389022
	speed: 0.0022s/iter; left time: 10.2853s
	iters: 500, epoch: 4 | loss: 0.2458415
	speed: 0.0021s/iter; left time: 9.6908s
	iters: 600, epoch: 4 | loss: 0.5656719
	speed: 0.0021s/iter; left time: 9.5800s
	iters: 700, epoch: 4 | loss: 1.2190132
	speed: 0.0021s/iter; left time: 9.3511s
	iters: 800, epoch: 4 | loss: 0.2300004
	speed: 0.0021s/iter; left time: 9.2704s
	iters: 900, epoch: 4 | loss: 0.9284916
	speed: 0.0022s/iter; left time: 9.2148s
	iters: 1000, epoch: 4 | loss: 0.7651412
	speed: 0.0022s/iter; left time: 9.0186s
Updating learning rate to 0.000126170851725
Epoch: 4 cost time: 2.2852861881256104
Epoch: 4, Steps: 1027 | Train Loss: 0.6132387 Vali Loss: 0.3878544 Best vali loss: 0.3701329
	iters: 100, epoch: 5 | loss: 0.4131172
	speed: 0.0076s/iter; left time: 30.5228s
	iters: 200, epoch: 5 | loss: 0.2080249
	speed: 0.0023s/iter; left time: 8.9037s
	iters: 300, epoch: 5 | loss: 0.7730794
	speed: 0.0021s/iter; left time: 8.1834s
	iters: 400, epoch: 5 | loss: 0.4940719
	speed: 0.0021s/iter; left time: 7.9455s
	iters: 500, epoch: 5 | loss: 0.8886800
	speed: 0.0023s/iter; left time: 8.2614s
	iters: 600, epoch: 5 | loss: 0.4459152
	speed: 0.0023s/iter; left time: 8.2234s
	iters: 700, epoch: 5 | loss: 0.4283725
	speed: 0.0022s/iter; left time: 7.6160s
	iters: 800, epoch: 5 | loss: 0.4079777
	speed: 0.0022s/iter; left time: 7.2642s
	iters: 900, epoch: 5 | loss: 0.4866500
	speed: 0.0022s/iter; left time: 7.1525s
	iters: 1000, epoch: 5 | loss: 0.5073949
	speed: 0.0022s/iter; left time: 6.9268s
Updating learning rate to 6.30854258625e-05
Epoch: 5 cost time: 2.3431384563446045
Epoch: 5, Steps: 1027 | Train Loss: 0.5053284 Vali Loss: 0.3805454 Best vali loss: 0.3701329
	iters: 100, epoch: 6 | loss: 0.6036611
	speed: 0.0073s/iter; left time: 21.7508s
	iters: 200, epoch: 6 | loss: 1.0138189
	speed: 0.0022s/iter; left time: 6.2569s
	iters: 300, epoch: 6 | loss: 0.4765627
	speed: 0.0021s/iter; left time: 5.9808s
	iters: 400, epoch: 6 | loss: 0.2457506
	speed: 0.0021s/iter; left time: 5.6359s
	iters: 500, epoch: 6 | loss: 0.5709094
	speed: 0.0021s/iter; left time: 5.4153s
	iters: 600, epoch: 6 | loss: 1.3731934
	speed: 0.0021s/iter; left time: 5.2038s
	iters: 700, epoch: 6 | loss: 0.5602641
	speed: 0.0021s/iter; left time: 4.9707s
	iters: 800, epoch: 6 | loss: 0.7796267
	speed: 0.0021s/iter; left time: 4.7465s
	iters: 900, epoch: 6 | loss: 0.3108234
	speed: 0.0021s/iter; left time: 4.5520s
	iters: 1000, epoch: 6 | loss: 1.0045077
	speed: 0.0021s/iter; left time: 4.3441s
Updating learning rate to 3.154271293125e-05
Epoch: 6 cost time: 2.200161933898926
Epoch: 6, Steps: 1027 | Train Loss: 0.6939118 Vali Loss: 0.3821879 Best vali loss: 0.3701329
	iters: 100, epoch: 7 | loss: 0.6619297
	speed: 0.0072s/iter; left time: 14.1504s
	iters: 200, epoch: 7 | loss: 0.4517006
	speed: 0.0022s/iter; left time: 4.0063s
	iters: 300, epoch: 7 | loss: 0.2735157
	speed: 0.0021s/iter; left time: 3.7374s
	iters: 400, epoch: 7 | loss: 0.8908268
	speed: 0.0021s/iter; left time: 3.4532s
	iters: 500, epoch: 7 | loss: 0.4595556
	speed: 0.0021s/iter; left time: 3.2242s
	iters: 600, epoch: 7 | loss: 0.6150778
	speed: 0.0021s/iter; left time: 3.0117s
	iters: 700, epoch: 7 | loss: 0.7055842
	speed: 0.0021s/iter; left time: 2.8224s
	iters: 800, epoch: 7 | loss: 0.3894519
	speed: 0.0021s/iter; left time: 2.6137s
	iters: 900, epoch: 7 | loss: 1.6244572
	speed: 0.0021s/iter; left time: 2.4085s
	iters: 1000, epoch: 7 | loss: 0.4134322
	speed: 0.0021s/iter; left time: 2.2088s
Updating learning rate to 1.5771356465625e-05
Epoch: 7 cost time: 2.1917543411254883
Epoch: 7, Steps: 1027 | Train Loss: 0.6485532 Vali Loss: 0.3843004 Best vali loss: 0.3701329
	iters: 100, epoch: 8 | loss: 0.2852171
	speed: 0.0075s/iter; left time: 6.9191s
	iters: 200, epoch: 8 | loss: 1.0824157
	speed: 0.0024s/iter; left time: 1.9689s
	iters: 300, epoch: 8 | loss: 0.6920496
	speed: 0.0024s/iter; left time: 1.7348s
	iters: 400, epoch: 8 | loss: 0.8397284
	speed: 0.0024s/iter; left time: 1.4982s
	iters: 500, epoch: 8 | loss: 0.8758277
	speed: 0.0024s/iter; left time: 1.2634s
	iters: 600, epoch: 8 | loss: 0.6384526
	speed: 0.0024s/iter; left time: 1.0107s
	iters: 700, epoch: 8 | loss: 0.8072325
	speed: 0.0023s/iter; left time: 0.7482s
	iters: 800, epoch: 8 | loss: 0.5264957
	speed: 0.0022s/iter; left time: 0.5112s
	iters: 900, epoch: 8 | loss: 0.8489503
	speed: 0.0022s/iter; left time: 0.2827s
	iters: 1000, epoch: 8 | loss: 1.5346580
	speed: 0.0022s/iter; left time: 0.0616s
Updating learning rate to 7.8856782328125e-06
Epoch: 8 cost time: 2.4195101261138916
Epoch: 8, Steps: 1027 | Train Loss: 0.8131028 Vali Loss: 0.3825593 Best vali loss: 0.3701329

best validation loss 0.3701328846701002

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010566660319, 'e_layers': 2, 'learning_rate': 0.0003313040997, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5102556
	speed: 0.0110s/iter; left time: 10.2216s
Updating learning rate to 0.0003313040997
Validation loss decreased (inf --> 0.4051).  Saving model state dict ...
Epoch: 1 cost time: 0.9470329284667969
Epoch: 1, Steps: 129 | Train Loss: 0.5102556 Vali Loss: 0.4051443 Best vali loss: 0.4051443
	iters: 100, epoch: 2 | loss: 0.6593187
	speed: 0.0076s/iter; left time: 6.0975s
Updating learning rate to 0.00016565204985
Validation loss decreased (0.4051 --> 0.3628).  Saving model state dict ...
Epoch: 2 cost time: 0.5760879516601562
Epoch: 2, Steps: 129 | Train Loss: 0.6593187 Vali Loss: 0.3628232 Best vali loss: 0.3628232
	iters: 100, epoch: 3 | loss: 0.5503651
	speed: 0.0078s/iter; left time: 5.2935s
Updating learning rate to 8.2826024925e-05
Validation loss decreased (0.3628 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 0.604672908782959
Epoch: 3, Steps: 129 | Train Loss: 0.5503651 Vali Loss: 0.3538752 Best vali loss: 0.3538752
	iters: 100, epoch: 4 | loss: 0.3890306
	speed: 0.0079s/iter; left time: 4.3060s
Updating learning rate to 4.14130124625e-05
Validation loss decreased (0.3539 --> 0.3536).  Saving model state dict ...
Epoch: 4 cost time: 0.6056520938873291
Epoch: 4, Steps: 129 | Train Loss: 0.3890306 Vali Loss: 0.3535855 Best vali loss: 0.3535855
	iters: 100, epoch: 5 | loss: 0.5034994
	speed: 0.0074s/iter; left time: 3.0957s
Updating learning rate to 2.070650623125e-05
Validation loss decreased (0.3536 --> 0.3479).  Saving model state dict ...
Epoch: 5 cost time: 0.5567970275878906
Epoch: 5, Steps: 129 | Train Loss: 0.5034994 Vali Loss: 0.3479243 Best vali loss: 0.3479243
	iters: 100, epoch: 6 | loss: 0.4719653
	speed: 0.0072s/iter; left time: 2.0797s
Updating learning rate to 1.0353253115625e-05
Epoch: 6 cost time: 0.5424759387969971
Epoch: 6, Steps: 129 | Train Loss: 0.4719653 Vali Loss: 0.3499297 Best vali loss: 0.3479243
	iters: 100, epoch: 7 | loss: 0.3901478
	speed: 0.0076s/iter; left time: 1.2121s
Updating learning rate to 5.1766265578125e-06
Validation loss decreased (0.3479 --> 0.3458).  Saving model state dict ...
Epoch: 7 cost time: 0.6076133251190186
Epoch: 7, Steps: 129 | Train Loss: 0.3901478 Vali Loss: 0.3458373 Best vali loss: 0.3458373
	iters: 100, epoch: 8 | loss: 0.4521807
	speed: 0.0076s/iter; left time: 0.2279s
Updating learning rate to 2.58831327890625e-06
Epoch: 8 cost time: 0.5756399631500244
Epoch: 8, Steps: 129 | Train Loss: 0.4521807 Vali Loss: 0.3474345 Best vali loss: 0.3458373

best validation loss 0.34583730776089816

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 2, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5105518
	speed: 0.0109s/iter; left time: 10.1423s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.4099).  Saving model state dict ...
Epoch: 1 cost time: 0.9330356121063232
Epoch: 1, Steps: 129 | Train Loss: 0.5105518 Vali Loss: 0.4099233 Best vali loss: 0.4099233
	iters: 100, epoch: 2 | loss: 0.6593549
	speed: 0.0079s/iter; left time: 6.3282s
Updating learning rate to 0.0001652515671
Validation loss decreased (0.4099 --> 0.3497).  Saving model state dict ...
Epoch: 2 cost time: 0.601198673248291
Epoch: 2, Steps: 129 | Train Loss: 0.6593549 Vali Loss: 0.3496978 Best vali loss: 0.3496978
	iters: 100, epoch: 3 | loss: 0.5501855
	speed: 0.0079s/iter; left time: 5.3321s
Updating learning rate to 8.262578355e-05
Epoch: 3 cost time: 0.6053099632263184
Epoch: 3, Steps: 129 | Train Loss: 0.5501855 Vali Loss: 0.3516451 Best vali loss: 0.3496978

best validation loss 0.34969777807973923

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020259965012, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.7492837905883789
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705114 Best vali loss: 0.3705114
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.4484128952026367
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3739893 Best vali loss: 0.3705114
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.4486117362976074
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3749588 Best vali loss: 0.3705114

best validation loss 0.3705114450108092

[INFO][smbo.py:320] Finished 650 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020541728226, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3822).  Saving model state dict ...
Epoch: 1 cost time: 1.3248701095581055
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3821865 Best vali loss: 0.3821865
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3822 --> 0.3815).  Saving model state dict ...
Epoch: 2 cost time: 1.0131568908691406
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3814782 Best vali loss: 0.3814782
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3815 --> 0.3746).  Saving model state dict ...
Epoch: 3 cost time: 1.0175724029541016
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3745821 Best vali loss: 0.3745821

best validation loss 0.3745820609666041

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 2, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4706558
	speed: 0.0110s/iter; left time: 6.0122s
Updating learning rate to 4.1312891775e-05
Epoch: 4 cost time: 0.9332015514373779
Epoch: 4, Steps: 129 | Train Loss: 0.4706558 Vali Loss: 0.3552145 Best vali loss: 0.3496978
	iters: 100, epoch: 5 | loss: 0.6180836
	speed: 0.0074s/iter; left time: 3.0924s
Updating learning rate to 2.06564458875e-05
Epoch: 5 cost time: 0.5714712142944336
Epoch: 5, Steps: 129 | Train Loss: 0.6180836 Vali Loss: 0.3508685 Best vali loss: 0.3496978
	iters: 100, epoch: 6 | loss: 0.5165912
	speed: 0.0076s/iter; left time: 2.1851s
Updating learning rate to 1.032822294375e-05
Validation loss decreased (0.3497 --> 0.3486).  Saving model state dict ...
Epoch: 6 cost time: 0.6031887531280518
Epoch: 6, Steps: 129 | Train Loss: 0.5165912 Vali Loss: 0.3486238 Best vali loss: 0.3486238
	iters: 100, epoch: 7 | loss: 0.3788577
	speed: 0.0078s/iter; left time: 1.2419s
Updating learning rate to 5.164111471875e-06
Validation loss decreased (0.3486 --> 0.3484).  Saving model state dict ...
Epoch: 7 cost time: 0.5889067649841309
Epoch: 7, Steps: 129 | Train Loss: 0.3788577 Vali Loss: 0.3484160 Best vali loss: 0.3484160
	iters: 100, epoch: 8 | loss: 0.4970466
	speed: 0.0080s/iter; left time: 0.2387s
Updating learning rate to 2.5820557359375e-06
Epoch: 8 cost time: 0.6116983890533447
Epoch: 8, Steps: 129 | Train Loss: 0.4970466 Vali Loss: 0.3489129 Best vali loss: 0.3484160

best validation loss 0.3484160041879343

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0032179734888, 'e_layers': 4, 'learning_rate': 0.000139589496, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2461898
	speed: 0.0114s/iter; left time: 92.4507s
	iters: 200, epoch: 1 | loss: 0.4623185
	speed: 0.0050s/iter; left time: 40.2653s
	iters: 300, epoch: 1 | loss: 0.5172194
	speed: 0.0052s/iter; left time: 40.9405s
	iters: 400, epoch: 1 | loss: 0.3315934
	speed: 0.0050s/iter; left time: 38.8961s
	iters: 500, epoch: 1 | loss: 0.1896904
	speed: 0.0051s/iter; left time: 39.3697s
	iters: 600, epoch: 1 | loss: 0.3789733
	speed: 0.0052s/iter; left time: 39.8031s
	iters: 700, epoch: 1 | loss: 0.6953701
	speed: 0.0051s/iter; left time: 38.6068s
	iters: 800, epoch: 1 | loss: 0.4240590
	speed: 0.0052s/iter; left time: 38.6275s
	iters: 900, epoch: 1 | loss: 0.5663808
	speed: 0.0052s/iter; left time: 37.8122s
	iters: 1000, epoch: 1 | loss: 1.5289676
	speed: 0.0052s/iter; left time: 37.4736s
Updating learning rate to 0.00013427668715398306
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 5.6405510902404785
Epoch: 1, Steps: 1027 | Train Loss: 0.6340762 Vali Loss: 0.3666093 Best vali loss: 0.3666093
	iters: 100, epoch: 2 | loss: 0.2671414
	speed: 0.0128s/iter; left time: 90.5597s
	iters: 200, epoch: 2 | loss: 0.8314100
	speed: 0.0045s/iter; left time: 31.5207s
	iters: 300, epoch: 2 | loss: 1.0283808
	speed: 0.0045s/iter; left time: 30.6804s
	iters: 400, epoch: 2 | loss: 0.3475083
	speed: 0.0045s/iter; left time: 30.4047s
	iters: 500, epoch: 2 | loss: 0.3055748
	speed: 0.0045s/iter; left time: 30.1640s
	iters: 600, epoch: 2 | loss: 0.3098735
	speed: 0.0046s/iter; left time: 30.3159s
	iters: 700, epoch: 2 | loss: 0.6935015
	speed: 0.0046s/iter; left time: 29.6013s
	iters: 800, epoch: 2 | loss: 0.2737873
	speed: 0.0046s/iter; left time: 29.6840s
	iters: 900, epoch: 2 | loss: 1.1915053
	speed: 0.0047s/iter; left time: 29.4064s
	iters: 1000, epoch: 2 | loss: 0.3775126
	speed: 0.0045s/iter; left time: 27.9376s
Updating learning rate to 0.00011914708760200622
Epoch: 2 cost time: 4.707906723022461
Epoch: 2, Steps: 1027 | Train Loss: 0.5626195 Vali Loss: 0.3710140 Best vali loss: 0.3666093
	iters: 100, epoch: 3 | loss: 0.4275844
	speed: 0.0124s/iter; left time: 74.9060s
	iters: 200, epoch: 3 | loss: 0.1812175
	speed: 0.0048s/iter; left time: 28.5241s
	iters: 300, epoch: 3 | loss: 0.7716576
	speed: 0.0048s/iter; left time: 28.2734s
	iters: 400, epoch: 3 | loss: 0.4801485
	speed: 0.0048s/iter; left time: 27.5580s
	iters: 500, epoch: 3 | loss: 0.4418572
	speed: 0.0049s/iter; left time: 27.4808s
	iters: 600, epoch: 3 | loss: 0.3841547
	speed: 0.0049s/iter; left time: 27.1664s
	iters: 700, epoch: 3 | loss: 0.2992160
	speed: 0.0049s/iter; left time: 26.8451s
	iters: 800, epoch: 3 | loss: 0.4130894
	speed: 0.0050s/iter; left time: 26.5847s
	iters: 900, epoch: 3 | loss: 0.3307473
	speed: 0.0049s/iter; left time: 25.9726s
	iters: 1000, epoch: 3 | loss: 0.8994412
	speed: 0.0049s/iter; left time: 25.2568s
Updating learning rate to 9.650404172569649e-05
Epoch: 3 cost time: 5.018582105636597
Epoch: 3, Steps: 1027 | Train Loss: 0.4629114 Vali Loss: 0.3855359 Best vali loss: 0.3666093
	iters: 100, epoch: 4 | loss: 0.3595083
	speed: 0.0126s/iter; left time: 63.7014s
	iters: 200, epoch: 4 | loss: 0.4416311
	speed: 0.0048s/iter; left time: 23.8241s
	iters: 300, epoch: 4 | loss: 1.0705135
	speed: 0.0050s/iter; left time: 24.0530s
	iters: 400, epoch: 4 | loss: 0.3968780
	speed: 0.0049s/iter; left time: 23.2369s
	iters: 500, epoch: 4 | loss: 0.3982520
	speed: 0.0049s/iter; left time: 22.8185s
	iters: 600, epoch: 4 | loss: 0.4327799
	speed: 0.0047s/iter; left time: 21.4547s
	iters: 700, epoch: 4 | loss: 0.2336496
	speed: 0.0046s/iter; left time: 20.2873s
	iters: 800, epoch: 4 | loss: 0.3371165
	speed: 0.0050s/iter; left time: 21.6796s
	iters: 900, epoch: 4 | loss: 0.3360688
	speed: 0.0050s/iter; left time: 21.2654s
	iters: 1000, epoch: 4 | loss: 0.2492911
	speed: 0.0050s/iter; left time: 20.8855s
Updating learning rate to 6.9794748e-05
Validation loss decreased (0.3666 --> 0.3485).  Saving model state dict ...
Epoch: 4 cost time: 5.062642574310303
Epoch: 4, Steps: 1027 | Train Loss: 0.4255689 Vali Loss: 0.3484703 Best vali loss: 0.3484703
	iters: 100, epoch: 5 | loss: 0.3107685
	speed: 0.0135s/iter; left time: 54.2122s
	iters: 200, epoch: 5 | loss: 0.3518333
	speed: 0.0051s/iter; left time: 19.8206s
	iters: 300, epoch: 5 | loss: 0.3033277
	speed: 0.0049s/iter; left time: 18.7622s
	iters: 400, epoch: 5 | loss: 0.3654175
	speed: 0.0049s/iter; left time: 18.0745s
	iters: 500, epoch: 5 | loss: 0.4342731
	speed: 0.0050s/iter; left time: 17.9043s
	iters: 600, epoch: 5 | loss: 0.6773869
	speed: 0.0050s/iter; left time: 17.5306s
	iters: 700, epoch: 5 | loss: 0.2669875
	speed: 0.0049s/iter; left time: 16.7011s
	iters: 800, epoch: 5 | loss: 0.2245528
	speed: 0.0049s/iter; left time: 16.2545s
	iters: 900, epoch: 5 | loss: 0.5556831
	speed: 0.0047s/iter; left time: 14.9753s
	iters: 1000, epoch: 5 | loss: 0.2783636
	speed: 0.0044s/iter; left time: 13.7822s
Updating learning rate to 4.3085454274303516e-05
Epoch: 5 cost time: 5.066820859909058
Epoch: 5, Steps: 1027 | Train Loss: 0.3768594 Vali Loss: 0.3678084 Best vali loss: 0.3484703
	iters: 100, epoch: 6 | loss: 0.4649595
	speed: 0.0127s/iter; left time: 37.7491s
	iters: 200, epoch: 6 | loss: 0.3751844
	speed: 0.0046s/iter; left time: 13.1228s
	iters: 300, epoch: 6 | loss: 0.1773066
	speed: 0.0045s/iter; left time: 12.4895s
	iters: 400, epoch: 6 | loss: 0.3085085
	speed: 0.0045s/iter; left time: 12.0978s
	iters: 500, epoch: 6 | loss: 0.3676959
	speed: 0.0044s/iter; left time: 11.4255s
	iters: 600, epoch: 6 | loss: 1.2646989
	speed: 0.0045s/iter; left time: 11.2468s
	iters: 700, epoch: 6 | loss: 0.3285976
	speed: 0.0047s/iter; left time: 11.1437s
	iters: 800, epoch: 6 | loss: 0.2604495
	speed: 0.0048s/iter; left time: 10.9693s
	iters: 900, epoch: 6 | loss: 0.4245141
	speed: 0.0048s/iter; left time: 10.5545s
	iters: 1000, epoch: 6 | loss: 0.2497777
	speed: 0.0050s/iter; left time: 10.5124s
Updating learning rate to 2.0442408397993776e-05
Epoch: 6 cost time: 4.851961851119995
Epoch: 6, Steps: 1027 | Train Loss: 0.4221693 Vali Loss: 0.3548789 Best vali loss: 0.3484703
	iters: 100, epoch: 7 | loss: 0.2456778
	speed: 0.0131s/iter; left time: 25.5554s
	iters: 200, epoch: 7 | loss: 0.4832147
	speed: 0.0049s/iter; left time: 9.0279s
	iters: 300, epoch: 7 | loss: 0.4472558
	speed: 0.0048s/iter; left time: 8.4871s
	iters: 400, epoch: 7 | loss: 0.5429970
	speed: 0.0049s/iter; left time: 8.1175s
	iters: 500, epoch: 7 | loss: 0.8474382
	speed: 0.0049s/iter; left time: 7.5843s
	iters: 600, epoch: 7 | loss: 0.1922794
	speed: 0.0049s/iter; left time: 7.1053s
	iters: 700, epoch: 7 | loss: 0.6304871
	speed: 0.0048s/iter; left time: 6.5230s
	iters: 800, epoch: 7 | loss: 0.2629071
	speed: 0.0049s/iter; left time: 6.1387s
	iters: 900, epoch: 7 | loss: 0.3945703
	speed: 0.0050s/iter; left time: 5.7495s
	iters: 1000, epoch: 7 | loss: 0.2314143
	speed: 0.0050s/iter; left time: 5.2954s
Updating learning rate to 5.312808846016934e-06
Epoch: 7 cost time: 5.07326602935791
Epoch: 7, Steps: 1027 | Train Loss: 0.4278242 Vali Loss: 0.3548713 Best vali loss: 0.3484703
	iters: 100, epoch: 8 | loss: 0.6276908
	speed: 0.0124s/iter; left time: 11.5197s
	iters: 200, epoch: 8 | loss: 0.5166733
	speed: 0.0044s/iter; left time: 3.6759s
	iters: 300, epoch: 8 | loss: 0.3569951
	speed: 0.0044s/iter; left time: 3.2269s
	iters: 400, epoch: 8 | loss: 0.3965234
	speed: 0.0045s/iter; left time: 2.7997s
	iters: 500, epoch: 8 | loss: 0.1903002
	speed: 0.0045s/iter; left time: 2.3652s
	iters: 600, epoch: 8 | loss: 0.2763474
	speed: 0.0046s/iter; left time: 1.9530s
	iters: 700, epoch: 8 | loss: 0.4367515
	speed: 0.0046s/iter; left time: 1.5250s
	iters: 800, epoch: 8 | loss: 0.5556757
	speed: 0.0046s/iter; left time: 1.0512s
	iters: 900, epoch: 8 | loss: 0.6941586
	speed: 0.0045s/iter; left time: 0.5824s
	iters: 1000, epoch: 8 | loss: 0.3977393
	speed: 0.0045s/iter; left time: 0.1270s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.682039260864258
Epoch: 8, Steps: 1027 | Train Loss: 0.4448855 Vali Loss: 0.3559872 Best vali loss: 0.3484703

best validation loss 0.3484703141837317

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020201110446, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 0.765418291091919
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706573 Best vali loss: 0.3706573
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3707 --> 0.3652).  Saving model state dict ...
Epoch: 2 cost time: 0.4532201290130615
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3652048 Best vali loss: 0.3652048
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3652 --> 0.3517).  Saving model state dict ...
Epoch: 3 cost time: 0.44830775260925293
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3516537 Best vali loss: 0.3516537
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.4458277225494385
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3773492 Best vali loss: 0.3516537
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3517 --> 0.3499).  Saving model state dict ...
Epoch: 5 cost time: 0.45412325859069824
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3499003 Best vali loss: 0.3499003
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.45432591438293457
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3510811 Best vali loss: 0.3499003
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3499 --> 0.3465).  Saving model state dict ...
Epoch: 7 cost time: 0.44526124000549316
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3465230 Best vali loss: 0.3465230
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.4493429660797119
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3489415 Best vali loss: 0.3465230

best validation loss 0.34652301163242466

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020186010578, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 0.7674274444580078
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3673711 Best vali loss: 0.3673711
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.4568641185760498
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3704227 Best vali loss: 0.3673711
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.4504854679107666
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3775189 Best vali loss: 0.3673711

best validation loss 0.36737105723448493

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0091938561006, 'e_layers': 2, 'learning_rate': 0.0006379560918, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6671164
	speed: 0.0099s/iter; left time: 19.4255s
	iters: 200, epoch: 1 | loss: 0.5355999
	speed: 0.0037s/iter; left time: 6.9461s
Updating learning rate to 0.0006379560918
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 1.3134689331054688
Epoch: 1, Steps: 257 | Train Loss: 0.6013581 Vali Loss: 0.3635194 Best vali loss: 0.3635194
	iters: 100, epoch: 2 | loss: 0.7351971
	speed: 0.0082s/iter; left time: 13.9790s
	iters: 200, epoch: 2 | loss: 0.3620934
	speed: 0.0036s/iter; left time: 5.8144s
Updating learning rate to 0.0003189780459
Epoch: 2 cost time: 0.9886445999145508
Epoch: 2, Steps: 257 | Train Loss: 0.5486453 Vali Loss: 0.3751211 Best vali loss: 0.3635194
	iters: 100, epoch: 3 | loss: 0.3189426
	speed: 0.0077s/iter; left time: 11.0808s
	iters: 200, epoch: 3 | loss: 1.0587471
	speed: 0.0032s/iter; left time: 4.2506s
Updating learning rate to 0.00015948902295
Epoch: 3 cost time: 0.8580234050750732
Epoch: 3, Steps: 257 | Train Loss: 0.6888448 Vali Loss: 0.3668234 Best vali loss: 0.3635194

best validation loss 0.36351943020736305

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0047782788908, 'e_layers': 4, 'learning_rate': 0.0004525051427, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5588964
	speed: 0.0115s/iter; left time: 93.6981s
	iters: 200, epoch: 1 | loss: 0.4128945
	speed: 0.0052s/iter; left time: 41.8238s
	iters: 300, epoch: 1 | loss: 0.4277882
	speed: 0.0052s/iter; left time: 41.0381s
	iters: 400, epoch: 1 | loss: 1.1876899
	speed: 0.0052s/iter; left time: 40.9456s
	iters: 500, epoch: 1 | loss: 0.4912245
	speed: 0.0052s/iter; left time: 40.2714s
	iters: 600, epoch: 1 | loss: 1.7076684
	speed: 0.0052s/iter; left time: 39.8392s
	iters: 700, epoch: 1 | loss: 1.0526392
	speed: 0.0052s/iter; left time: 39.0997s
	iters: 800, epoch: 1 | loss: 0.3290880
	speed: 0.0052s/iter; left time: 38.6583s
	iters: 900, epoch: 1 | loss: 0.2369550
	speed: 0.0053s/iter; left time: 38.4794s
	iters: 1000, epoch: 1 | loss: 0.4390107
	speed: 0.0052s/iter; left time: 37.5344s
Updating learning rate to 0.0004525051427
Validation loss decreased (inf --> 0.3983).  Saving model state dict ...
Epoch: 1 cost time: 5.7290198802948
Epoch: 1, Steps: 1027 | Train Loss: 0.7843855 Vali Loss: 0.3982574 Best vali loss: 0.3982574
	iters: 100, epoch: 2 | loss: 0.4334537
	speed: 0.0138s/iter; left time: 98.0461s
	iters: 200, epoch: 2 | loss: 1.1160963
	speed: 0.0052s/iter; left time: 36.4936s
	iters: 300, epoch: 2 | loss: 0.4948356
	speed: 0.0051s/iter; left time: 35.0719s
	iters: 400, epoch: 2 | loss: 0.2485551
	speed: 0.0052s/iter; left time: 35.5057s
	iters: 500, epoch: 2 | loss: 1.6136794
	speed: 0.0052s/iter; left time: 34.6700s
	iters: 600, epoch: 2 | loss: 0.6712312
	speed: 0.0052s/iter; left time: 33.9995s
	iters: 700, epoch: 2 | loss: 0.3237329
	speed: 0.0051s/iter; left time: 33.1411s
	iters: 800, epoch: 2 | loss: 0.7158847
	speed: 0.0052s/iter; left time: 33.0452s
	iters: 900, epoch: 2 | loss: 0.9824720
	speed: 0.0051s/iter; left time: 32.3581s
	iters: 1000, epoch: 2 | loss: 0.9538769
	speed: 0.0055s/iter; left time: 33.9426s
Updating learning rate to 0.00022625257135
Epoch: 2 cost time: 5.392557621002197
Epoch: 2, Steps: 1027 | Train Loss: 0.7553818 Vali Loss: 0.4067021 Best vali loss: 0.3982574
	iters: 100, epoch: 3 | loss: 0.3080399
	speed: 0.0134s/iter; left time: 81.1992s
	iters: 200, epoch: 3 | loss: 0.3408340
	speed: 0.0053s/iter; left time: 31.3964s
	iters: 300, epoch: 3 | loss: 0.3779928
	speed: 0.0054s/iter; left time: 31.4765s
	iters: 400, epoch: 3 | loss: 0.3949904
	speed: 0.0055s/iter; left time: 31.4969s
	iters: 500, epoch: 3 | loss: 0.5269483
	speed: 0.0054s/iter; left time: 30.5495s
	iters: 600, epoch: 3 | loss: 0.3163857
	speed: 0.0053s/iter; left time: 29.3649s
	iters: 700, epoch: 3 | loss: 0.2891310
	speed: 0.0053s/iter; left time: 28.8156s
	iters: 800, epoch: 3 | loss: 1.0111941
	speed: 0.0053s/iter; left time: 28.4769s
	iters: 900, epoch: 3 | loss: 0.3057846
	speed: 0.0052s/iter; left time: 27.5154s
	iters: 1000, epoch: 3 | loss: 0.4125302
	speed: 0.0051s/iter; left time: 26.4268s
Updating learning rate to 0.000113126285675
Epoch: 3 cost time: 5.481293439865112
Epoch: 3, Steps: 1027 | Train Loss: 0.4283831 Vali Loss: 0.4076259 Best vali loss: 0.3982574

best validation loss 0.3982573570577475

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0091938561006, 'e_layers': 2, 'learning_rate': 0.0006379560918, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5896294
	speed: 0.0099s/iter; left time: 11.6867s
	iters: 200, epoch: 4 | loss: 0.4515999
	speed: 0.0037s/iter; left time: 3.9674s
Updating learning rate to 7.9744511475e-05
Epoch: 4 cost time: 1.2895748615264893
Epoch: 4, Steps: 257 | Train Loss: 0.5206147 Vali Loss: 0.3777407 Best vali loss: 0.3635194
	iters: 100, epoch: 5 | loss: 0.6474759
	speed: 0.0083s/iter; left time: 7.6996s
	iters: 200, epoch: 5 | loss: 0.3451623
	speed: 0.0035s/iter; left time: 2.9323s
Updating learning rate to 3.98722557375e-05
Epoch: 5 cost time: 0.9635932445526123
Epoch: 5, Steps: 257 | Train Loss: 0.4963191 Vali Loss: 0.3695771 Best vali loss: 0.3635194
	iters: 100, epoch: 6 | loss: 0.2949617
	speed: 0.0080s/iter; left time: 5.3606s
	iters: 200, epoch: 6 | loss: 0.8764559
	speed: 0.0035s/iter; left time: 1.9781s
Updating learning rate to 1.993612786875e-05
Epoch: 6 cost time: 0.9423222541809082
Epoch: 6, Steps: 257 | Train Loss: 0.5857088 Vali Loss: 0.3709442 Best vali loss: 0.3635194
	iters: 100, epoch: 7 | loss: 0.5086570
	speed: 0.0081s/iter; left time: 3.3759s
	iters: 200, epoch: 7 | loss: 0.3156845
	speed: 0.0036s/iter; left time: 1.1243s
Updating learning rate to 9.968063934375e-06
Epoch: 7 cost time: 0.9959359169006348
Epoch: 7, Steps: 257 | Train Loss: 0.4121708 Vali Loss: 0.3720759 Best vali loss: 0.3635194
	iters: 100, epoch: 8 | loss: 0.4808868
	speed: 0.0083s/iter; left time: 1.3053s
	iters: 200, epoch: 8 | loss: 0.4768693
	speed: 0.0036s/iter; left time: 0.2097s
Updating learning rate to 4.9840319671875e-06
Epoch: 8 cost time: 0.9881973266601562
Epoch: 8, Steps: 257 | Train Loss: 0.4788781 Vali Loss: 0.3706164 Best vali loss: 0.3635194

best validation loss 0.36351943020736305

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0052025126987, 'e_layers': 4, 'learning_rate': 0.0004568596375, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5570577
	speed: 0.0117s/iter; left time: 94.9792s
	iters: 200, epoch: 1 | loss: 0.4152487
	speed: 0.0053s/iter; left time: 42.7275s
	iters: 300, epoch: 1 | loss: 0.4291085
	speed: 0.0054s/iter; left time: 42.9985s
	iters: 400, epoch: 1 | loss: 1.2219180
	speed: 0.0054s/iter; left time: 42.1197s
	iters: 500, epoch: 1 | loss: 0.5758334
	speed: 0.0054s/iter; left time: 41.3617s
	iters: 600, epoch: 1 | loss: 1.7245188
	speed: 0.0054s/iter; left time: 40.9624s
	iters: 700, epoch: 1 | loss: 1.0533578
	speed: 0.0054s/iter; left time: 40.7778s
	iters: 800, epoch: 1 | loss: 0.3292423
	speed: 0.0053s/iter; left time: 39.4111s
	iters: 900, epoch: 1 | loss: 0.2365214
	speed: 0.0053s/iter; left time: 38.9021s
	iters: 1000, epoch: 1 | loss: 0.4388792
	speed: 0.0053s/iter; left time: 38.4992s
Updating learning rate to 0.0004568596375
Validation loss decreased (inf --> 0.3987).  Saving model state dict ...
Epoch: 1 cost time: 5.878281593322754
Epoch: 1, Steps: 1027 | Train Loss: 0.7981686 Vali Loss: 0.3986800 Best vali loss: 0.3986800
	iters: 100, epoch: 2 | loss: 0.4335093
	speed: 0.0139s/iter; left time: 98.8717s
	iters: 200, epoch: 2 | loss: 1.1069516
	speed: 0.0053s/iter; left time: 37.0374s
	iters: 300, epoch: 2 | loss: 0.4999011
	speed: 0.0050s/iter; left time: 34.5898s
	iters: 400, epoch: 2 | loss: 0.2369181
	speed: 0.0049s/iter; left time: 33.0423s
	iters: 500, epoch: 2 | loss: 1.6079545
	speed: 0.0048s/iter; left time: 32.4383s
	iters: 600, epoch: 2 | loss: 0.6677039
	speed: 0.0049s/iter; left time: 32.0686s
	iters: 700, epoch: 2 | loss: 0.3208562
	speed: 0.0048s/iter; left time: 31.4577s
	iters: 800, epoch: 2 | loss: 0.6972287
	speed: 0.0050s/iter; left time: 31.9597s
	iters: 900, epoch: 2 | loss: 0.9747044
	speed: 0.0050s/iter; left time: 31.7176s
	iters: 1000, epoch: 2 | loss: 0.9473978
	speed: 0.0052s/iter; left time: 32.0817s
Updating learning rate to 0.00022842981875
Epoch: 2 cost time: 5.211354732513428
Epoch: 2, Steps: 1027 | Train Loss: 0.7493126 Vali Loss: 0.4004758 Best vali loss: 0.3986800
	iters: 100, epoch: 3 | loss: 0.3023453
	speed: 0.0131s/iter; left time: 79.6572s
	iters: 200, epoch: 3 | loss: 0.3329294
	speed: 0.0052s/iter; left time: 30.8405s
	iters: 300, epoch: 3 | loss: 0.3687958
	speed: 0.0052s/iter; left time: 30.4825s
	iters: 400, epoch: 3 | loss: 0.3922409
	speed: 0.0052s/iter; left time: 29.9765s
	iters: 500, epoch: 3 | loss: 0.5250655
	speed: 0.0047s/iter; left time: 26.4185s
	iters: 600, epoch: 3 | loss: 0.3072469
	speed: 0.0045s/iter; left time: 24.9371s
	iters: 700, epoch: 3 | loss: 0.2873660
	speed: 0.0045s/iter; left time: 24.7235s
	iters: 800, epoch: 3 | loss: 1.0073067
	speed: 0.0046s/iter; left time: 24.6957s
	iters: 900, epoch: 3 | loss: 0.3032180
	speed: 0.0045s/iter; left time: 23.6779s
	iters: 1000, epoch: 3 | loss: 0.4378870
	speed: 0.0048s/iter; left time: 24.5866s
Updating learning rate to 0.000114214909375
Epoch: 3 cost time: 5.003560304641724
Epoch: 3, Steps: 1027 | Train Loss: 0.4264401 Vali Loss: 0.4037307 Best vali loss: 0.3986800
	iters: 100, epoch: 4 | loss: 0.4425594
	speed: 0.0125s/iter; left time: 62.8940s
	iters: 200, epoch: 4 | loss: 0.3398069
	speed: 0.0049s/iter; left time: 24.4217s
	iters: 300, epoch: 4 | loss: 0.8715833
	speed: 0.0049s/iter; left time: 23.7740s
	iters: 400, epoch: 4 | loss: 0.5168256
	speed: 0.0050s/iter; left time: 23.5844s
	iters: 500, epoch: 4 | loss: 0.7309487
	speed: 0.0049s/iter; left time: 22.9114s
	iters: 600, epoch: 4 | loss: 1.9426553
	speed: 0.0050s/iter; left time: 22.6479s
	iters: 700, epoch: 4 | loss: 0.2946905
	speed: 0.0050s/iter; left time: 22.0809s
	iters: 800, epoch: 4 | loss: 0.3225911
	speed: 0.0050s/iter; left time: 21.6609s
	iters: 900, epoch: 4 | loss: 0.9973232
	speed: 0.0050s/iter; left time: 21.2135s
	iters: 1000, epoch: 4 | loss: 0.4230095
	speed: 0.0050s/iter; left time: 20.5032s
Updating learning rate to 5.71074546875e-05
Epoch: 4 cost time: 5.12322473526001
Epoch: 4, Steps: 1027 | Train Loss: 0.6881993 Vali Loss: 0.4021803 Best vali loss: 0.3986800
	iters: 100, epoch: 5 | loss: 0.2633911
	speed: 0.0128s/iter; left time: 51.3905s
	iters: 200, epoch: 5 | loss: 0.7335345
	speed: 0.0045s/iter; left time: 17.7449s
	iters: 300, epoch: 5 | loss: 0.3654281
	speed: 0.0045s/iter; left time: 17.0848s
	iters: 400, epoch: 5 | loss: 0.5189704
	speed: 0.0045s/iter; left time: 16.7510s
	iters: 500, epoch: 5 | loss: 0.7389439
	speed: 0.0047s/iter; left time: 16.9379s
	iters: 600, epoch: 5 | loss: 0.2303921
	speed: 0.0047s/iter; left time: 16.3953s
	iters: 700, epoch: 5 | loss: 0.3700844
	speed: 0.0046s/iter; left time: 15.6943s
	iters: 800, epoch: 5 | loss: 0.5410076
	speed: 0.0047s/iter; left time: 15.5101s
	iters: 900, epoch: 5 | loss: 0.6621607
	speed: 0.0045s/iter; left time: 14.4989s
	iters: 1000, epoch: 5 | loss: 0.2637165
	speed: 0.0048s/iter; left time: 15.0229s
Updating learning rate to 2.855372734375e-05
Epoch: 5 cost time: 4.800004243850708
Epoch: 5, Steps: 1027 | Train Loss: 0.4687629 Vali Loss: 0.4012731 Best vali loss: 0.3986800
	iters: 100, epoch: 6 | loss: 0.4518187
	speed: 0.0133s/iter; left time: 39.7499s
	iters: 200, epoch: 6 | loss: 0.9589137
	speed: 0.0049s/iter; left time: 14.0010s
	iters: 300, epoch: 6 | loss: 0.6413982
	speed: 0.0049s/iter; left time: 13.5324s
	iters: 400, epoch: 6 | loss: 1.3402660
	speed: 0.0048s/iter; left time: 12.8197s
	iters: 500, epoch: 6 | loss: 1.3885288
	speed: 0.0049s/iter; left time: 12.5889s
	iters: 600, epoch: 6 | loss: 0.8670104
	speed: 0.0050s/iter; left time: 12.3775s
	iters: 700, epoch: 6 | loss: 0.1908907
	speed: 0.0049s/iter; left time: 11.7210s
	iters: 800, epoch: 6 | loss: 0.5140188
	speed: 0.0047s/iter; left time: 10.6558s
	iters: 900, epoch: 6 | loss: 1.1515251
	speed: 0.0045s/iter; left time: 9.7442s
	iters: 1000, epoch: 6 | loss: 0.3160139
	speed: 0.0045s/iter; left time: 9.3401s
Updating learning rate to 1.4276863671875e-05
Epoch: 6 cost time: 4.93817138671875
Epoch: 6, Steps: 1027 | Train Loss: 0.7820384 Vali Loss: 0.4027802 Best vali loss: 0.3986800
	iters: 100, epoch: 7 | loss: 0.3241889
	speed: 0.0126s/iter; left time: 24.6361s
	iters: 200, epoch: 7 | loss: 1.1023703
	speed: 0.0046s/iter; left time: 8.4759s
	iters: 300, epoch: 7 | loss: 0.9063345
	speed: 0.0046s/iter; left time: 8.0400s
	iters: 400, epoch: 7 | loss: 1.2168549
	speed: 0.0046s/iter; left time: 7.6448s
	iters: 500, epoch: 7 | loss: 0.3091370
	speed: 0.0048s/iter; left time: 7.4664s
	iters: 600, epoch: 7 | loss: 0.4917747
	speed: 0.0046s/iter; left time: 6.6204s
	iters: 700, epoch: 7 | loss: 0.3367293
	speed: 0.0046s/iter; left time: 6.2797s
	iters: 800, epoch: 7 | loss: 0.3673189
	speed: 0.0045s/iter; left time: 5.5922s
	iters: 900, epoch: 7 | loss: 0.3069969
	speed: 0.0051s/iter; left time: 5.9122s
	iters: 1000, epoch: 7 | loss: 0.7753953
	speed: 0.0052s/iter; left time: 5.4808s
Updating learning rate to 7.1384318359375e-06
Epoch: 7 cost time: 4.905396938323975
Epoch: 7, Steps: 1027 | Train Loss: 0.6137101 Vali Loss: 0.4028556 Best vali loss: 0.3986800
	iters: 100, epoch: 8 | loss: 0.4058092
	speed: 0.0130s/iter; left time: 12.0932s
	iters: 200, epoch: 8 | loss: 0.4288720
	speed: 0.0052s/iter; left time: 4.3446s
	iters: 300, epoch: 8 | loss: 1.1811687
	speed: 0.0054s/iter; left time: 3.9379s
	iters: 400, epoch: 8 | loss: 0.3426382
	speed: 0.0053s/iter; left time: 3.3193s
	iters: 500, epoch: 8 | loss: 0.4876459
	speed: 0.0052s/iter; left time: 2.7549s
	iters: 600, epoch: 8 | loss: 0.7657436
	speed: 0.0052s/iter; left time: 2.2160s
	iters: 700, epoch: 8 | loss: 1.1765584
	speed: 0.0052s/iter; left time: 1.7085s
	iters: 800, epoch: 8 | loss: 0.3621779
	speed: 0.0051s/iter; left time: 1.1622s
	iters: 900, epoch: 8 | loss: 1.1192170
	speed: 0.0051s/iter; left time: 0.6515s
	iters: 1000, epoch: 8 | loss: 0.5337090
	speed: 0.0050s/iter; left time: 0.1394s
Updating learning rate to 3.56921591796875e-06
Epoch: 8 cost time: 5.366315603256226
Epoch: 8, Steps: 1027 | Train Loss: 0.6803540 Vali Loss: 0.3992053 Best vali loss: 0.3986800

best validation loss 0.3986800354801133

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0053094375629, 'e_layers': 4, 'learning_rate': 0.0004545434559, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5559889
	speed: 0.0114s/iter; left time: 92.4122s
	iters: 200, epoch: 1 | loss: 0.4234398
	speed: 0.0053s/iter; left time: 42.5084s
	iters: 300, epoch: 1 | loss: 0.4483002
	speed: 0.0053s/iter; left time: 41.7422s
	iters: 400, epoch: 1 | loss: 1.2101166
	speed: 0.0052s/iter; left time: 40.3053s
	iters: 500, epoch: 1 | loss: 0.5370817
	speed: 0.0052s/iter; left time: 39.8064s
	iters: 600, epoch: 1 | loss: 1.7408818
	speed: 0.0051s/iter; left time: 38.9946s
	iters: 700, epoch: 1 | loss: 1.0411237
	speed: 0.0051s/iter; left time: 38.4172s
	iters: 800, epoch: 1 | loss: 0.3555096
	speed: 0.0052s/iter; left time: 38.6440s
	iters: 900, epoch: 1 | loss: 0.2296700
	speed: 0.0052s/iter; left time: 37.8957s
	iters: 1000, epoch: 1 | loss: 0.4393946
	speed: 0.0052s/iter; left time: 37.6813s
Updating learning rate to 0.0004545434559
Validation loss decreased (inf --> 0.3964).  Saving model state dict ...
Epoch: 1 cost time: 5.692939758300781
Epoch: 1, Steps: 1027 | Train Loss: 0.7981507 Vali Loss: 0.3964298 Best vali loss: 0.3964298
	iters: 100, epoch: 2 | loss: 0.4334096
	speed: 0.0134s/iter; left time: 95.1088s
	iters: 200, epoch: 2 | loss: 1.1384288
	speed: 0.0052s/iter; left time: 36.3068s
	iters: 300, epoch: 2 | loss: 0.4935219
	speed: 0.0052s/iter; left time: 36.0007s
	iters: 400, epoch: 2 | loss: 0.2480818
	speed: 0.0051s/iter; left time: 34.8246s
	iters: 500, epoch: 2 | loss: 1.6131136
	speed: 0.0053s/iter; left time: 35.3668s
	iters: 600, epoch: 2 | loss: 0.6711314
	speed: 0.0047s/iter; left time: 31.2429s
	iters: 700, epoch: 2 | loss: 0.3289598
	speed: 0.0047s/iter; left time: 30.3152s
	iters: 800, epoch: 2 | loss: 0.7050373
	speed: 0.0047s/iter; left time: 29.8916s
	iters: 900, epoch: 2 | loss: 0.9779865
	speed: 0.0047s/iter; left time: 29.7418s
	iters: 1000, epoch: 2 | loss: 0.9491359
	speed: 0.0046s/iter; left time: 28.4563s
Updating learning rate to 0.00022727172795
Epoch: 2 cost time: 5.11165452003479
Epoch: 2, Steps: 1027 | Train Loss: 0.7558807 Vali Loss: 0.4105082 Best vali loss: 0.3964298
	iters: 100, epoch: 3 | loss: 0.3051115
	speed: 0.0133s/iter; left time: 80.7574s
	iters: 200, epoch: 3 | loss: 0.3349952
	speed: 0.0049s/iter; left time: 29.2960s
	iters: 300, epoch: 3 | loss: 0.3705351
	speed: 0.0049s/iter; left time: 29.0214s
	iters: 400, epoch: 3 | loss: 0.3854719
	speed: 0.0050s/iter; left time: 28.6702s
	iters: 500, epoch: 3 | loss: 0.5454383
	speed: 0.0049s/iter; left time: 27.6972s
	iters: 600, epoch: 3 | loss: 0.3100512
	speed: 0.0050s/iter; left time: 27.8049s
	iters: 700, epoch: 3 | loss: 0.2835457
	speed: 0.0050s/iter; left time: 27.3545s
	iters: 800, epoch: 3 | loss: 0.8718774
	speed: 0.0051s/iter; left time: 27.2412s
	iters: 900, epoch: 3 | loss: 0.3029643
	speed: 0.0050s/iter; left time: 26.1321s
	iters: 1000, epoch: 3 | loss: 0.4072798
	speed: 0.0049s/iter; left time: 25.2974s
Updating learning rate to 0.000113635863975
Epoch: 3 cost time: 5.139428377151489
Epoch: 3, Steps: 1027 | Train Loss: 0.4117270 Vali Loss: 0.4049792 Best vali loss: 0.3964298
	iters: 100, epoch: 4 | loss: 0.4340081
	speed: 0.0134s/iter; left time: 67.3250s
	iters: 200, epoch: 4 | loss: 0.3871015
	speed: 0.0052s/iter; left time: 25.6017s
	iters: 300, epoch: 4 | loss: 0.8815145
	speed: 0.0053s/iter; left time: 25.4845s
	iters: 400, epoch: 4 | loss: 0.5353242
	speed: 0.0053s/iter; left time: 25.1916s
	iters: 500, epoch: 4 | loss: 0.7683650
	speed: 0.0053s/iter; left time: 24.6448s
	iters: 600, epoch: 4 | loss: 1.9680140
	speed: 0.0053s/iter; left time: 24.0381s
	iters: 700, epoch: 4 | loss: 0.3042942
	speed: 0.0052s/iter; left time: 23.2462s
	iters: 800, epoch: 4 | loss: 0.3296656
	speed: 0.0053s/iter; left time: 22.8967s
	iters: 900, epoch: 4 | loss: 0.9324513
	speed: 0.0052s/iter; left time: 22.1729s
	iters: 1000, epoch: 4 | loss: 0.4253909
	speed: 0.0052s/iter; left time: 21.4469s
Updating learning rate to 5.68179319875e-05
Epoch: 4 cost time: 5.448426008224487
Epoch: 4, Steps: 1027 | Train Loss: 0.6966129 Vali Loss: 0.4073459 Best vali loss: 0.3964298
	iters: 100, epoch: 5 | loss: 0.2727528
	speed: 0.0138s/iter; left time: 55.1407s
	iters: 200, epoch: 5 | loss: 0.7110227
	speed: 0.0056s/iter; left time: 21.6992s
	iters: 300, epoch: 5 | loss: 0.3681808
	speed: 0.0054s/iter; left time: 20.6983s
	iters: 400, epoch: 5 | loss: 0.5415371
	speed: 0.0053s/iter; left time: 19.7314s
	iters: 500, epoch: 5 | loss: 0.7685918
	speed: 0.0054s/iter; left time: 19.5678s
	iters: 600, epoch: 5 | loss: 0.2344738
	speed: 0.0054s/iter; left time: 18.9086s
	iters: 700, epoch: 5 | loss: 0.3781017
	speed: 0.0055s/iter; left time: 18.6956s
	iters: 800, epoch: 5 | loss: 0.5563985
	speed: 0.0055s/iter; left time: 18.3638s
	iters: 900, epoch: 5 | loss: 0.6584222
	speed: 0.0055s/iter; left time: 17.5045s
	iters: 1000, epoch: 5 | loss: 0.2812456
	speed: 0.0054s/iter; left time: 16.6579s
Updating learning rate to 2.840896599375e-05
Epoch: 5 cost time: 5.630006551742554
Epoch: 5, Steps: 1027 | Train Loss: 0.4770727 Vali Loss: 0.4020131 Best vali loss: 0.3964298
	iters: 100, epoch: 6 | loss: 0.4726482
	speed: 0.0132s/iter; left time: 39.2393s
	iters: 200, epoch: 6 | loss: 0.9673219
	speed: 0.0049s/iter; left time: 14.2032s
	iters: 300, epoch: 6 | loss: 0.6306698
	speed: 0.0050s/iter; left time: 13.8741s
	iters: 400, epoch: 6 | loss: 1.2591008
	speed: 0.0049s/iter; left time: 13.1721s
	iters: 500, epoch: 6 | loss: 1.3859491
	speed: 0.0049s/iter; left time: 12.6008s
	iters: 600, epoch: 6 | loss: 0.8924557
	speed: 0.0048s/iter; left time: 11.8228s
	iters: 700, epoch: 6 | loss: 0.1997871
	speed: 0.0046s/iter; left time: 10.9854s
	iters: 800, epoch: 6 | loss: 0.5317167
	speed: 0.0044s/iter; left time: 10.1040s
	iters: 900, epoch: 6 | loss: 1.1176953
	speed: 0.0051s/iter; left time: 11.0435s
	iters: 1000, epoch: 6 | loss: 0.3299026
	speed: 0.0048s/iter; left time: 10.0823s
Updating learning rate to 1.4204482996875e-05
Epoch: 6 cost time: 4.99523663520813
Epoch: 6, Steps: 1027 | Train Loss: 0.7787247 Vali Loss: 0.4037178 Best vali loss: 0.3964298
	iters: 100, epoch: 7 | loss: 0.3210336
	speed: 0.0134s/iter; left time: 26.1035s
	iters: 200, epoch: 7 | loss: 1.1103262
	speed: 0.0054s/iter; left time: 9.9606s
	iters: 300, epoch: 7 | loss: 0.8996066
	speed: 0.0053s/iter; left time: 9.2608s
	iters: 400, epoch: 7 | loss: 1.2063013
	speed: 0.0053s/iter; left time: 8.7938s
	iters: 500, epoch: 7 | loss: 0.3094222
	speed: 0.0053s/iter; left time: 8.3026s
	iters: 600, epoch: 7 | loss: 0.4876822
	speed: 0.0053s/iter; left time: 7.6554s
	iters: 700, epoch: 7 | loss: 0.3206505
	speed: 0.0053s/iter; left time: 7.1581s
	iters: 800, epoch: 7 | loss: 0.3697859
	speed: 0.0053s/iter; left time: 6.6600s
	iters: 900, epoch: 7 | loss: 0.3003894
	speed: 0.0053s/iter; left time: 6.1131s
	iters: 1000, epoch: 7 | loss: 0.7685100
	speed: 0.0054s/iter; left time: 5.6838s
Updating learning rate to 7.1022414984375e-06
Epoch: 7 cost time: 5.491554498672485
Epoch: 7, Steps: 1027 | Train Loss: 0.6093708 Vali Loss: 0.4028986 Best vali loss: 0.3964298
	iters: 100, epoch: 8 | loss: 0.4482705
	speed: 0.0130s/iter; left time: 12.0383s
	iters: 200, epoch: 8 | loss: 0.4398735
	speed: 0.0047s/iter; left time: 3.8883s
	iters: 300, epoch: 8 | loss: 1.2050046
	speed: 0.0047s/iter; left time: 3.4422s
	iters: 400, epoch: 8 | loss: 0.3181059
	speed: 0.0047s/iter; left time: 2.9281s
	iters: 500, epoch: 8 | loss: 0.5928493
	speed: 0.0049s/iter; left time: 2.6049s
	iters: 600, epoch: 8 | loss: 0.7658058
	speed: 0.0049s/iter; left time: 2.0813s
	iters: 700, epoch: 8 | loss: 1.1678207
	speed: 0.0049s/iter; left time: 1.6187s
	iters: 800, epoch: 8 | loss: 0.3719066
	speed: 0.0049s/iter; left time: 1.1202s
	iters: 900, epoch: 8 | loss: 1.1453390
	speed: 0.0050s/iter; left time: 0.6344s
	iters: 1000, epoch: 8 | loss: 0.5380782
	speed: 0.0048s/iter; left time: 0.1350s
Updating learning rate to 3.55112074921875e-06
Epoch: 8 cost time: 4.996213436126709
Epoch: 8, Steps: 1027 | Train Loss: 0.6993054 Vali Loss: 0.4032000 Best vali loss: 0.3964298

best validation loss 0.39642983829576983

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0078569850277, 'e_layers': 4, 'learning_rate': 0.0005988281801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.6173643
	speed: 0.0116s/iter; left time: 94.4428s
	iters: 200, epoch: 1 | loss: 0.3964003
	speed: 0.0053s/iter; left time: 42.3333s
	iters: 300, epoch: 1 | loss: 0.4439422
	speed: 0.0052s/iter; left time: 41.4180s
	iters: 400, epoch: 1 | loss: 1.2262031
	speed: 0.0053s/iter; left time: 41.0708s
	iters: 500, epoch: 1 | loss: 0.5728822
	speed: 0.0053s/iter; left time: 40.6686s
	iters: 600, epoch: 1 | loss: 1.7284703
	speed: 0.0053s/iter; left time: 40.5150s
	iters: 700, epoch: 1 | loss: 1.0478737
	speed: 0.0054s/iter; left time: 40.5260s
	iters: 800, epoch: 1 | loss: 0.3368980
	speed: 0.0054s/iter; left time: 39.7618s
	iters: 900, epoch: 1 | loss: 0.2368518
	speed: 0.0052s/iter; left time: 38.2701s
	iters: 1000, epoch: 1 | loss: 0.4447441
	speed: 0.0052s/iter; left time: 37.7301s
Updating learning rate to 0.0005988281801
Validation loss decreased (inf --> 0.3979).  Saving model state dict ...
Epoch: 1 cost time: 5.78913688659668
Epoch: 1, Steps: 1027 | Train Loss: 0.8051630 Vali Loss: 0.3979113 Best vali loss: 0.3979113
	iters: 100, epoch: 2 | loss: 0.4342627
	speed: 0.0138s/iter; left time: 98.1285s
	iters: 200, epoch: 2 | loss: 1.1341285
	speed: 0.0053s/iter; left time: 36.8226s
	iters: 300, epoch: 2 | loss: 0.4939923
	speed: 0.0053s/iter; left time: 36.7340s
	iters: 400, epoch: 2 | loss: 0.2473535
	speed: 0.0056s/iter; left time: 37.8310s
	iters: 500, epoch: 2 | loss: 1.6152129
	speed: 0.0054s/iter; left time: 36.3694s
	iters: 600, epoch: 2 | loss: 0.6712257
	speed: 0.0055s/iter; left time: 36.2701s
	iters: 700, epoch: 2 | loss: 0.3237130
	speed: 0.0056s/iter; left time: 36.0761s
	iters: 800, epoch: 2 | loss: 0.7167324
	speed: 0.0055s/iter; left time: 35.0908s
	iters: 900, epoch: 2 | loss: 0.9832959
	speed: 0.0054s/iter; left time: 34.1774s
	iters: 1000, epoch: 2 | loss: 0.9531491
	speed: 0.0049s/iter; left time: 30.4643s
Updating learning rate to 0.00029941409005
Epoch: 2 cost time: 5.558062553405762
Epoch: 2, Steps: 1027 | Train Loss: 0.7573066 Vali Loss: 0.4080933 Best vali loss: 0.3979113
	iters: 100, epoch: 3 | loss: 0.3085163
	speed: 0.0126s/iter; left time: 76.5493s
	iters: 200, epoch: 3 | loss: 0.3407398
	speed: 0.0047s/iter; left time: 28.1816s
	iters: 300, epoch: 3 | loss: 0.3782655
	speed: 0.0047s/iter; left time: 27.7899s
	iters: 400, epoch: 3 | loss: 0.3952902
	speed: 0.0047s/iter; left time: 26.9602s
	iters: 500, epoch: 3 | loss: 0.5269331
	speed: 0.0048s/iter; left time: 26.9726s
	iters: 600, epoch: 3 | loss: 0.3169428
	speed: 0.0048s/iter; left time: 26.7840s
	iters: 700, epoch: 3 | loss: 0.2883962
	speed: 0.0048s/iter; left time: 26.2792s
	iters: 800, epoch: 3 | loss: 1.0102723
	speed: 0.0046s/iter; left time: 24.8209s
	iters: 900, epoch: 3 | loss: 0.3057452
	speed: 0.0047s/iter; left time: 24.7253s
	iters: 1000, epoch: 3 | loss: 0.4124374
	speed: 0.0047s/iter; left time: 24.2056s
Updating learning rate to 0.000149707045025
Epoch: 3 cost time: 4.897268533706665
Epoch: 3, Steps: 1027 | Train Loss: 0.4283539 Vali Loss: 0.4075078 Best vali loss: 0.3979113

best validation loss 0.3979113035094293

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073012038, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007073012038
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.1182868480682373
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672366 Best vali loss: 0.3672366
Updating learning rate to 0.0003536506019
Epoch: 2 cost time: 0.8117289543151855
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3711166 Best vali loss: 0.3672366
Updating learning rate to 0.00017682530095
Validation loss decreased (0.3672 --> 0.3559).  Saving model state dict ...
Epoch: 3 cost time: 0.8048021793365479
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3559136 Best vali loss: 0.3559136

best validation loss 0.3559135863026842

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0109644517125, 'e_layers': 4, 'learning_rate': 0.000705768936, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000705768936
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.1412956714630127
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687414 Best vali loss: 0.3687414
Updating learning rate to 0.000352884468
Epoch: 2 cost time: 0.8105905055999756
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3706407 Best vali loss: 0.3687414
Updating learning rate to 0.000176442234
Validation loss decreased (0.3687 --> 0.3591).  Saving model state dict ...
Epoch: 3 cost time: 0.8006608486175537
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3591166 Best vali loss: 0.3591166

best validation loss 0.3591165973418822

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007073012038, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8412650475e-05
Validation loss decreased (0.3559 --> 0.3416).  Saving model state dict ...
Epoch: 4 cost time: 1.126596450805664
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3416011 Best vali loss: 0.3416011
Updating learning rate to 4.42063252375e-05
Epoch: 5 cost time: 0.7997877597808838
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3445335 Best vali loss: 0.3416011
Updating learning rate to 2.210316261875e-05
Epoch: 6 cost time: 0.7944552898406982
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3460408 Best vali loss: 0.3416011
Updating learning rate to 1.1051581309375e-05
Epoch: 7 cost time: 0.8291294574737549
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3468617 Best vali loss: 0.3416011
Updating learning rate to 5.5257906546875e-06
Epoch: 8 cost time: 0.803002119064331
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3491460 Best vali loss: 0.3416011

best validation loss 0.3416011361452826

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011305397273, 'e_layers': 2, 'learning_rate': 0.0003127358907, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3862360
	speed: 0.0110s/iter; left time: 10.2644s
Updating learning rate to 0.0003127358907
Validation loss decreased (inf --> 0.3614).  Saving model state dict ...
Epoch: 1 cost time: 0.9350988864898682
Epoch: 1, Steps: 129 | Train Loss: 0.3862360 Vali Loss: 0.3613674 Best vali loss: 0.3613674
	iters: 100, epoch: 2 | loss: 0.6376286
	speed: 0.0073s/iter; left time: 5.8608s
Updating learning rate to 0.00015636794535
Epoch: 2 cost time: 0.5823118686676025
Epoch: 2, Steps: 129 | Train Loss: 0.6376286 Vali Loss: 0.4023489 Best vali loss: 0.3613674
	iters: 100, epoch: 3 | loss: 0.3683589
	speed: 0.0071s/iter; left time: 4.7695s
Updating learning rate to 7.8183972675e-05
Epoch: 3 cost time: 0.5388128757476807
Epoch: 3, Steps: 129 | Train Loss: 0.3683589 Vali Loss: 0.4057372 Best vali loss: 0.3613674
	iters: 100, epoch: 4 | loss: 0.7056112
	speed: 0.0070s/iter; left time: 3.8408s
Updating learning rate to 3.90919863375e-05
Epoch: 4 cost time: 0.5568370819091797
Epoch: 4, Steps: 129 | Train Loss: 0.7056112 Vali Loss: 0.4101490 Best vali loss: 0.3613674
	iters: 100, epoch: 5 | loss: 0.9374157
	speed: 0.0072s/iter; left time: 3.0088s
Updating learning rate to 1.954599316875e-05
Epoch: 5 cost time: 0.5830252170562744
Epoch: 5, Steps: 129 | Train Loss: 0.9374157 Vali Loss: 0.4215958 Best vali loss: 0.3613674
	iters: 100, epoch: 6 | loss: 0.5508404
	speed: 0.0070s/iter; left time: 2.0131s
Updating learning rate to 9.772996584375e-06
Epoch: 6 cost time: 0.5393140316009521
Epoch: 6, Steps: 129 | Train Loss: 0.5508404 Vali Loss: 0.4334888 Best vali loss: 0.3613674
	iters: 100, epoch: 7 | loss: 0.5170683
	speed: 0.0072s/iter; left time: 1.1474s
Updating learning rate to 4.8864982921875e-06
Epoch: 7 cost time: 0.5749359130859375
Epoch: 7, Steps: 129 | Train Loss: 0.5170683 Vali Loss: 0.4265537 Best vali loss: 0.3613674
	iters: 100, epoch: 8 | loss: 0.6441807
	speed: 0.0071s/iter; left time: 0.2145s
Updating learning rate to 2.44324914609375e-06
Epoch: 8 cost time: 0.5535671710968018
Epoch: 8, Steps: 129 | Train Loss: 0.6441807 Vali Loss: 0.4285321 Best vali loss: 0.3613674

best validation loss 0.3613673759818311

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0040544934604, 'e_layers': 4, 'learning_rate': 0.0005988190772, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5908962
	speed: 0.0137s/iter; left time: 12.7821s
Updating learning rate to 0.0005988190772
Validation loss decreased (inf --> 0.3902).  Saving model state dict ...
Epoch: 1 cost time: 1.2965576648712158
Epoch: 1, Steps: 129 | Train Loss: 0.5908962 Vali Loss: 0.3901927 Best vali loss: 0.3901927
	iters: 100, epoch: 2 | loss: 0.5465209
	speed: 0.0117s/iter; left time: 9.3829s
Updating learning rate to 0.0002994095386
Validation loss decreased (0.3902 --> 0.3777).  Saving model state dict ...
Epoch: 2 cost time: 0.9357821941375732
Epoch: 2, Steps: 129 | Train Loss: 0.5465209 Vali Loss: 0.3776683 Best vali loss: 0.3776683
	iters: 100, epoch: 3 | loss: 0.6565281
	speed: 0.0121s/iter; left time: 8.1736s
Updating learning rate to 0.0001497047693
Validation loss decreased (0.3777 --> 0.3724).  Saving model state dict ...
Epoch: 3 cost time: 0.9659512042999268
Epoch: 3, Steps: 129 | Train Loss: 0.6565281 Vali Loss: 0.3723832 Best vali loss: 0.3723832
	iters: 100, epoch: 4 | loss: 0.3607698
	speed: 0.0122s/iter; left time: 6.6697s
Updating learning rate to 7.485238465e-05
Validation loss decreased (0.3724 --> 0.3713).  Saving model state dict ...
Epoch: 4 cost time: 0.9647717475891113
Epoch: 4, Steps: 129 | Train Loss: 0.3607698 Vali Loss: 0.3713188 Best vali loss: 0.3713188
	iters: 100, epoch: 5 | loss: 0.5787164
	speed: 0.0117s/iter; left time: 4.8720s
Updating learning rate to 3.7426192325e-05
Epoch: 5 cost time: 0.9306509494781494
Epoch: 5, Steps: 129 | Train Loss: 0.5787164 Vali Loss: 0.3737151 Best vali loss: 0.3713188
	iters: 100, epoch: 6 | loss: 0.4920420
	speed: 0.0114s/iter; left time: 3.2888s
Updating learning rate to 1.87130961625e-05
Epoch: 6 cost time: 0.9341471195220947
Epoch: 6, Steps: 129 | Train Loss: 0.4920420 Vali Loss: 0.3827173 Best vali loss: 0.3713188
	iters: 100, epoch: 7 | loss: 0.6000072
	speed: 0.0120s/iter; left time: 1.9157s
Updating learning rate to 9.35654808125e-06
Epoch: 7 cost time: 1.0234289169311523
Epoch: 7, Steps: 129 | Train Loss: 0.6000072 Vali Loss: 0.3813345 Best vali loss: 0.3713188
	iters: 100, epoch: 8 | loss: 0.4521755
	speed: 0.0118s/iter; left time: 0.3536s
Updating learning rate to 4.678274040625e-06
Epoch: 8 cost time: 0.9713099002838135
Epoch: 8, Steps: 129 | Train Loss: 0.4521755 Vali Loss: 0.3845393 Best vali loss: 0.3713188

best validation loss 0.3713188051591922

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0038823612654, 'e_layers': 4, 'learning_rate': 0.0005447598703, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5655881
	speed: 0.0137s/iter; left time: 12.7776s
Updating learning rate to 0.0005447598703
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 1.3027639389038086
Epoch: 1, Steps: 129 | Train Loss: 0.5655881 Vali Loss: 0.3728044 Best vali loss: 0.3728044
	iters: 100, epoch: 2 | loss: 0.5677499
	speed: 0.0119s/iter; left time: 9.5370s
Updating learning rate to 0.00027237993515
Epoch: 2 cost time: 0.9559555053710938
Epoch: 2, Steps: 129 | Train Loss: 0.5677499 Vali Loss: 0.4015341 Best vali loss: 0.3728044
	iters: 100, epoch: 3 | loss: 0.6143505
	speed: 0.0117s/iter; left time: 7.9299s
Updating learning rate to 0.000136189967575
Validation loss decreased (0.3728 --> 0.3719).  Saving model state dict ...
Epoch: 3 cost time: 0.9644629955291748
Epoch: 3, Steps: 129 | Train Loss: 0.6143505 Vali Loss: 0.3719439 Best vali loss: 0.3719439

best validation loss 0.37194390572124475

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002234062437, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3822).  Saving model state dict ...
Epoch: 1 cost time: 1.3590924739837646
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3822083 Best vali loss: 0.3822083
Updating learning rate to 0.00035374494395
Epoch: 2 cost time: 1.052994966506958
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3914386 Best vali loss: 0.3822083
Updating learning rate to 0.000176872471975
Validation loss decreased (0.3822 --> 0.3795).  Saving model state dict ...
Epoch: 3 cost time: 1.0917763710021973
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3794521 Best vali loss: 0.3794521

best validation loss 0.3794520697097179

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010746111889, 'e_layers': 2, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6953094
	speed: 0.0119s/iter; left time: 11.0911s
Updating learning rate to 0.0007077576329
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.055222511291504
Epoch: 1, Steps: 129 | Train Loss: 0.6953094 Vali Loss: 0.3690206 Best vali loss: 0.3690206
	iters: 100, epoch: 2 | loss: 0.4287445
	speed: 0.0095s/iter; left time: 7.6052s
Updating learning rate to 0.00035387881645
Epoch: 2 cost time: 0.7580263614654541
Epoch: 2, Steps: 129 | Train Loss: 0.4287445 Vali Loss: 0.3796033 Best vali loss: 0.3690206
	iters: 100, epoch: 3 | loss: 0.4787676
	speed: 0.0093s/iter; left time: 6.2968s
Updating learning rate to 0.000176939408225
Epoch: 3 cost time: 0.7498641014099121
Epoch: 3, Steps: 129 | Train Loss: 0.4787676 Vali Loss: 0.3927712 Best vali loss: 0.3690206

best validation loss 0.3690205516655928

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010746111889, 'e_layers': 2, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6144990
	speed: 0.0124s/iter; left time: 6.7755s
Updating learning rate to 8.84697041125e-05
Epoch: 4 cost time: 1.0741562843322754
Epoch: 4, Steps: 129 | Train Loss: 0.6144990 Vali Loss: 0.3985599 Best vali loss: 0.3690206
	iters: 100, epoch: 5 | loss: 0.3427520
	speed: 0.0093s/iter; left time: 3.8892s
Updating learning rate to 4.423485205625e-05
Epoch: 5 cost time: 0.7545216083526611
Epoch: 5, Steps: 129 | Train Loss: 0.3427520 Vali Loss: 0.3936991 Best vali loss: 0.3690206
	iters: 100, epoch: 6 | loss: 0.3915178
	speed: 0.0091s/iter; left time: 2.6224s
Updating learning rate to 2.2117426028125e-05
Epoch: 6 cost time: 0.7410416603088379
Epoch: 6, Steps: 129 | Train Loss: 0.3915178 Vali Loss: 0.3918213 Best vali loss: 0.3690206
	iters: 100, epoch: 7 | loss: 0.3847817
	speed: 0.0093s/iter; left time: 1.4720s
Updating learning rate to 1.10587130140625e-05
Epoch: 7 cost time: 0.7395725250244141
Epoch: 7, Steps: 129 | Train Loss: 0.3847817 Vali Loss: 0.3925758 Best vali loss: 0.3690206
	iters: 100, epoch: 8 | loss: 0.5081447
	speed: 0.0092s/iter; left time: 0.2757s
Updating learning rate to 5.52935650703125e-06
Epoch: 8 cost time: 0.750497579574585
Epoch: 8, Steps: 129 | Train Loss: 0.5081447 Vali Loss: 0.3895371 Best vali loss: 0.3690206

best validation loss 0.3690205516655928

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0011223466452, 'e_layers': 4, 'learning_rate': 0.0003450908811, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7063454
	speed: 0.0131s/iter; left time: 12.2375s
Updating learning rate to 0.00033195664150228804
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.215256690979004
Epoch: 1, Steps: 129 | Train Loss: 0.7063454 Vali Loss: 0.3686610 Best vali loss: 0.3686610
	iters: 100, epoch: 2 | loss: 0.6985491
	speed: 0.0105s/iter; left time: 8.4443s
Updating learning rate to 0.0002945534916257253
Validation loss decreased (0.3687 --> 0.3575).  Saving model state dict ...
Epoch: 2 cost time: 0.8457136154174805
Epoch: 2, Steps: 129 | Train Loss: 0.6985491 Vali Loss: 0.3574779 Best vali loss: 0.3574779
	iters: 100, epoch: 3 | loss: 0.5830123
	speed: 0.0107s/iter; left time: 7.2378s
Updating learning rate to 0.00023857572197862056
Validation loss decreased (0.3575 --> 0.3568).  Saving model state dict ...
Epoch: 3 cost time: 0.8733232021331787
Epoch: 3, Steps: 129 | Train Loss: 0.5830123 Vali Loss: 0.3568429 Best vali loss: 0.3568429
	iters: 100, epoch: 4 | loss: 0.4257813
	speed: 0.0107s/iter; left time: 5.8259s
Updating learning rate to 0.00017254544055
Epoch: 4 cost time: 0.873138427734375
Epoch: 4, Steps: 129 | Train Loss: 0.4257813 Vali Loss: 0.3696955 Best vali loss: 0.3568429
	iters: 100, epoch: 5 | loss: 0.4636132
	speed: 0.0105s/iter; left time: 4.3886s
Updating learning rate to 0.00010651515912137948
Validation loss decreased (0.3568 --> 0.3556).  Saving model state dict ...
Epoch: 5 cost time: 0.8870117664337158
Epoch: 5, Steps: 129 | Train Loss: 0.4636132 Vali Loss: 0.3556146 Best vali loss: 0.3556146
	iters: 100, epoch: 6 | loss: 0.3875753
	speed: 0.0108s/iter; left time: 3.1194s
Updating learning rate to 5.053738947427472e-05
Epoch: 6 cost time: 0.8962535858154297
Epoch: 6, Steps: 129 | Train Loss: 0.3875753 Vali Loss: 0.3575938 Best vali loss: 0.3556146
	iters: 100, epoch: 7 | loss: 0.4633644
	speed: 0.0105s/iter; left time: 1.6690s
Updating learning rate to 1.3134239597711983e-05
Epoch: 7 cost time: 0.8563048839569092
Epoch: 7, Steps: 129 | Train Loss: 0.4633644 Vali Loss: 0.3561059 Best vali loss: 0.3556146
	iters: 100, epoch: 8 | loss: 0.5753183
	speed: 0.0104s/iter; left time: 0.3123s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.866239070892334
Epoch: 8, Steps: 129 | Train Loss: 0.5753183 Vali Loss: 0.3594637 Best vali loss: 0.3556146

best validation loss 0.355614607975853

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0108137245732, 'e_layers': 4, 'learning_rate': 5.20317237e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6604651
	speed: 0.0131s/iter; left time: 25.7076s
	iters: 200, epoch: 1 | loss: 0.4387290
	speed: 0.0068s/iter; left time: 12.6368s
Updating learning rate to 5.20317237e-05
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 2.1190059185028076
Epoch: 1, Steps: 257 | Train Loss: 0.5495971 Vali Loss: 0.3669473 Best vali loss: 0.3669473
	iters: 100, epoch: 2 | loss: 0.9936331
	speed: 0.0145s/iter; left time: 24.6082s
	iters: 200, epoch: 2 | loss: 0.8307501
	speed: 0.0068s/iter; left time: 10.9251s
Updating learning rate to 2.601586185e-05
Validation loss decreased (0.3669 --> 0.3638).  Saving model state dict ...
Epoch: 2 cost time: 1.7802438735961914
Epoch: 2, Steps: 257 | Train Loss: 0.9121916 Vali Loss: 0.3638083 Best vali loss: 0.3638083
	iters: 100, epoch: 3 | loss: 0.5416754
	speed: 0.0143s/iter; left time: 20.6207s
	iters: 200, epoch: 3 | loss: 0.7439701
	speed: 0.0066s/iter; left time: 8.8385s
Updating learning rate to 1.3007930925e-05
Validation loss decreased (0.3638 --> 0.3619).  Saving model state dict ...
Epoch: 3 cost time: 1.7436308860778809
Epoch: 3, Steps: 257 | Train Loss: 0.6428227 Vali Loss: 0.3618910 Best vali loss: 0.3618910
	iters: 100, epoch: 4 | loss: 0.7168308
	speed: 0.0144s/iter; left time: 17.0886s
	iters: 200, epoch: 4 | loss: 0.5297247
	speed: 0.0068s/iter; left time: 7.3753s
Updating learning rate to 6.5039654625e-06
Epoch: 4 cost time: 1.7819709777832031
Epoch: 4, Steps: 257 | Train Loss: 0.6232778 Vali Loss: 0.3649075 Best vali loss: 0.3618910
	iters: 100, epoch: 5 | loss: 0.7445934
	speed: 0.0137s/iter; left time: 12.7585s
	iters: 200, epoch: 5 | loss: 0.6949379
	speed: 0.0067s/iter; left time: 5.5304s
Updating learning rate to 3.25198273125e-06
Epoch: 5 cost time: 1.7643840312957764
Epoch: 5, Steps: 257 | Train Loss: 0.7197657 Vali Loss: 0.3644654 Best vali loss: 0.3618910
	iters: 100, epoch: 6 | loss: 0.4125390
	speed: 0.0140s/iter; left time: 9.4085s
	iters: 200, epoch: 6 | loss: 0.5204557
	speed: 0.0068s/iter; left time: 3.8798s
Updating learning rate to 1.625991365625e-06
Epoch: 6 cost time: 1.7825067043304443
Epoch: 6, Steps: 257 | Train Loss: 0.4664974 Vali Loss: 0.3649328 Best vali loss: 0.3618910
	iters: 100, epoch: 7 | loss: 0.6529377
	speed: 0.0140s/iter; left time: 5.8190s
	iters: 200, epoch: 7 | loss: 0.7137064
	speed: 0.0067s/iter; left time: 2.1170s
Updating learning rate to 8.129956828125e-07
Epoch: 7 cost time: 1.7776484489440918
Epoch: 7, Steps: 257 | Train Loss: 0.6833220 Vali Loss: 0.3639777 Best vali loss: 0.3618910
	iters: 100, epoch: 8 | loss: 0.6996163
	speed: 0.0138s/iter; left time: 2.1833s
	iters: 200, epoch: 8 | loss: 0.3775285
	speed: 0.0067s/iter; left time: 0.3870s
Updating learning rate to 4.0649784140625e-07
Epoch: 8 cost time: 1.760080099105835
Epoch: 8, Steps: 257 | Train Loss: 0.5385724 Vali Loss: 0.3651189 Best vali loss: 0.3618910

best validation loss 0.36189101093644477

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009194696317, 'e_layers': 2, 'learning_rate': 0.0006596813767, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006596813767
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.6647908687591553
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704627 Best vali loss: 0.3704627
Updating learning rate to 0.00032984068835
Validation loss decreased (0.3705 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 0.3544306755065918
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3648596 Best vali loss: 0.3648596
Updating learning rate to 0.000164920344175
Epoch: 3 cost time: 0.36239194869995117
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3679834 Best vali loss: 0.3648596

best validation loss 0.364859623302411

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010578778786, 'e_layers': 4, 'learning_rate': 0.0003311138133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4842753
	speed: 0.0135s/iter; left time: 26.4902s
	iters: 200, epoch: 1 | loss: 0.5648101
	speed: 0.0071s/iter; left time: 13.2057s
Updating learning rate to 0.00031851154416981674
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 2.2147436141967773
Epoch: 1, Steps: 257 | Train Loss: 0.5245427 Vali Loss: 0.3775371 Best vali loss: 0.3775371
	iters: 100, epoch: 2 | loss: 0.5423726
	speed: 0.0158s/iter; left time: 26.9137s
	iters: 200, epoch: 2 | loss: 0.7130641
	speed: 0.0075s/iter; left time: 11.9216s
Updating learning rate to 0.0002826233180144832
Validation loss decreased (0.3775 --> 0.3684).  Saving model state dict ...
Epoch: 2 cost time: 1.9893717765808105
Epoch: 2, Steps: 257 | Train Loss: 0.6277184 Vali Loss: 0.3684202 Best vali loss: 0.3684202
	iters: 100, epoch: 3 | loss: 0.6548614
	speed: 0.0157s/iter; left time: 22.6580s
	iters: 200, epoch: 3 | loss: 0.7468486
	speed: 0.0076s/iter; left time: 10.1606s
Updating learning rate to 0.00022891279193856877
Epoch: 3 cost time: 1.9405932426452637
Epoch: 3, Steps: 257 | Train Loss: 0.7008550 Vali Loss: 0.3754838 Best vali loss: 0.3684202

best validation loss 0.3684202317404606

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0042575308824, 'e_layers': 1, 'learning_rate': 0.0013749509719, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0743917
	speed: 0.0089s/iter; left time: 35.5270s
	iters: 200, epoch: 1 | loss: 0.3179463
	speed: 0.0025s/iter; left time: 9.9707s
	iters: 300, epoch: 1 | loss: 0.5937384
	speed: 0.0025s/iter; left time: 9.6109s
	iters: 400, epoch: 1 | loss: 1.4452838
	speed: 0.0026s/iter; left time: 9.6956s
	iters: 500, epoch: 1 | loss: 0.3418840
	speed: 0.0025s/iter; left time: 9.1746s
Updating learning rate to 0.0013226200165224555
Validation loss decreased (inf --> 0.3770).  Saving model state dict ...
Epoch: 1 cost time: 1.681190013885498
Epoch: 1, Steps: 514 | Train Loss: 0.7546488 Vali Loss: 0.3769930 Best vali loss: 0.3769930
	iters: 100, epoch: 2 | loss: 0.6924937
	speed: 0.0059s/iter; left time: 20.5904s
	iters: 200, epoch: 2 | loss: 0.3678058
	speed: 0.0025s/iter; left time: 8.5575s
	iters: 300, epoch: 2 | loss: 0.8725224
	speed: 0.0023s/iter; left time: 7.7184s
	iters: 400, epoch: 2 | loss: 0.6931862
	speed: 0.0023s/iter; left time: 7.4751s
	iters: 500, epoch: 2 | loss: 0.6647910
	speed: 0.0023s/iter; left time: 7.2025s
Updating learning rate to 0.001173594063964762
Validation loss decreased (0.3770 --> 0.3742).  Saving model state dict ...
Epoch: 2 cost time: 1.276672601699829
Epoch: 2, Steps: 514 | Train Loss: 0.6581598 Vali Loss: 0.3742313 Best vali loss: 0.3742313
	iters: 100, epoch: 3 | loss: 0.4923540
	speed: 0.0061s/iter; left time: 18.1514s
	iters: 200, epoch: 3 | loss: 0.9108832
	speed: 0.0026s/iter; left time: 7.5234s
	iters: 300, epoch: 3 | loss: 0.8718872
	speed: 0.0026s/iter; left time: 7.2293s
	iters: 400, epoch: 3 | loss: 0.9634717
	speed: 0.0026s/iter; left time: 7.0401s
	iters: 500, epoch: 3 | loss: 0.6056837
	speed: 0.0026s/iter; left time: 6.6281s
Updating learning rate to 0.000950560964580204
Epoch: 3 cost time: 1.381523609161377
Epoch: 3, Steps: 514 | Train Loss: 0.7688560 Vali Loss: 0.4009826 Best vali loss: 0.3742313

best validation loss 0.3742313038272333

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009194696317, 'e_layers': 2, 'learning_rate': 0.0006596813767, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.24601720875e-05
Epoch: 4 cost time: 0.6657564640045166
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3681990 Best vali loss: 0.3648596
Updating learning rate to 4.123008604375e-05
Epoch: 5 cost time: 0.3675706386566162
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3691059 Best vali loss: 0.3648596
Updating learning rate to 2.0615043021875e-05
Epoch: 6 cost time: 0.36779069900512695
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3693586 Best vali loss: 0.3648596
Updating learning rate to 1.03075215109375e-05
Epoch: 7 cost time: 0.3599705696105957
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3697436 Best vali loss: 0.3648596
Updating learning rate to 5.15376075546875e-06
Epoch: 8 cost time: 0.3627283573150635
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3697277 Best vali loss: 0.3648596

best validation loss 0.364859623302411

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022140228266, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.112612247467041
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713732 Best vali loss: 0.3713732
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3714 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.7920329570770264
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619752 Best vali loss: 0.3619752
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3620 --> 0.3588).  Saving model state dict ...
Epoch: 3 cost time: 0.7992181777954102
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3587999 Best vali loss: 0.3587999
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3588 --> 0.3461).  Saving model state dict ...
Epoch: 4 cost time: 0.7917063236236572
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3461186 Best vali loss: 0.3461186
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3461 --> 0.3461).  Saving model state dict ...
Epoch: 5 cost time: 0.7893936634063721
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3460950 Best vali loss: 0.3460950
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3461 --> 0.3436).  Saving model state dict ...
Epoch: 6 cost time: 0.7958245277404785
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3436041 Best vali loss: 0.3436041
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3436 --> 0.3434).  Saving model state dict ...
Epoch: 7 cost time: 0.8199083805084229
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3434151 Best vali loss: 0.3434151
Updating learning rate to 5.52363443828125e-06
Validation loss decreased (0.3434 --> 0.3427).  Saving model state dict ...
Epoch: 8 cost time: 0.8470125198364258
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3427058 Best vali loss: 0.3427058

best validation loss 0.3427057533812195

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0020021591, 'e_layers': 3, 'learning_rate': 0.0001466797763, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00014109710972845204
Validation loss decreased (inf --> 0.3902).  Saving model state dict ...
Epoch: 1 cost time: 0.7620644569396973
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3902073 Best vali loss: 0.3902073
Updating learning rate to 0.0001251990203923279
Validation loss decreased (0.3902 --> 0.3719).  Saving model state dict ...
Epoch: 2 cost time: 0.46750760078430176
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3718703 Best vali loss: 0.3718703
Updating learning rate to 0.00010140584827651377
Validation loss decreased (0.3719 --> 0.3671).  Saving model state dict ...
Epoch: 3 cost time: 0.39687252044677734
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3671188 Best vali loss: 0.3671188
Updating learning rate to 7.333988815e-05
Validation loss decreased (0.3671 --> 0.3664).  Saving model state dict ...
Epoch: 4 cost time: 0.4028961658477783
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3664499 Best vali loss: 0.3664499
Updating learning rate to 4.527392802348623e-05
Validation loss decreased (0.3664 --> 0.3654).  Saving model state dict ...
Epoch: 5 cost time: 0.43082475662231445
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3654317 Best vali loss: 0.3654317
Updating learning rate to 2.1480755907672083e-05
Epoch: 6 cost time: 0.4585862159729004
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3656632 Best vali loss: 0.3654317
Updating learning rate to 5.582666571547941e-06
Epoch: 7 cost time: 0.43190908432006836
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3655017 Best vali loss: 0.3654317
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4332726001739502
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3655821 Best vali loss: 0.3654317

best validation loss 0.36543171751241554

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010527180463, 'e_layers': 2, 'learning_rate': 0.0003301879385, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5579315
	speed: 0.0114s/iter; left time: 10.6554s
Updating learning rate to 0.0003176209083811228
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 1.0104587078094482
Epoch: 1, Steps: 129 | Train Loss: 0.5579315 Vali Loss: 0.3654033 Best vali loss: 0.3654033
	iters: 100, epoch: 2 | loss: 0.5628921
	speed: 0.0088s/iter; left time: 7.0698s
Updating learning rate to 0.0002818330344396784
Epoch: 2 cost time: 0.6929335594177246
Epoch: 2, Steps: 129 | Train Loss: 0.5628921 Vali Loss: 0.3716891 Best vali loss: 0.3654033
	iters: 100, epoch: 3 | loss: 0.5634958
	speed: 0.0087s/iter; left time: 5.8461s
Updating learning rate to 0.0002282726960653666
Validation loss decreased (0.3654 --> 0.3565).  Saving model state dict ...
Epoch: 3 cost time: 0.6927280426025391
Epoch: 3, Steps: 129 | Train Loss: 0.5634958 Vali Loss: 0.3565442 Best vali loss: 0.3565442

best validation loss 0.35654422577565686

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0069144700314, 'e_layers': 3, 'learning_rate': 0.0030459706311, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7352377
	speed: 0.0118s/iter; left time: 11.0421s
Updating learning rate to 0.002930040276901888
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 1.068453073501587
Epoch: 1, Steps: 129 | Train Loss: 0.7352377 Vali Loss: 0.3708163 Best vali loss: 0.3708163
	iters: 100, epoch: 2 | loss: 0.7012815
	speed: 0.0082s/iter; left time: 6.5863s
Updating learning rate to 0.0025998985598229387
Epoch: 2 cost time: 0.6441287994384766
Epoch: 2, Steps: 129 | Train Loss: 0.7012815 Vali Loss: 0.3770956 Best vali loss: 0.3708163
	iters: 100, epoch: 3 | loss: 0.5017766
	speed: 0.0078s/iter; left time: 5.2842s
Updating learning rate to 0.0021058065635463034
Epoch: 3 cost time: 0.627155065536499
Epoch: 3, Steps: 129 | Train Loss: 0.5017766 Vali Loss: 0.4049598 Best vali loss: 0.3708163

best validation loss 0.37081631864686376

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007071164235, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007071164235
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.125680923461914
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712115 Best vali loss: 0.3712115
Updating learning rate to 0.00035355821175
Epoch: 2 cost time: 0.8186748027801514
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3720679 Best vali loss: 0.3712115
Updating learning rate to 0.000176779105875
Validation loss decreased (0.3712 --> 0.3532).  Saving model state dict ...
Epoch: 3 cost time: 0.8176653385162354
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3531924 Best vali loss: 0.3531924

best validation loss 0.3531924269990977

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007071164235, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83895529375e-05
Validation loss decreased (0.3532 --> 0.3502).  Saving model state dict ...
Epoch: 4 cost time: 1.1356582641601562
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3502382 Best vali loss: 0.3502382
Updating learning rate to 4.419477646875e-05
Validation loss decreased (0.3502 --> 0.3443).  Saving model state dict ...
Epoch: 5 cost time: 0.8317527770996094
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3442611 Best vali loss: 0.3442611
Updating learning rate to 2.2097388234375e-05
Validation loss decreased (0.3443 --> 0.3419).  Saving model state dict ...
Epoch: 6 cost time: 0.8399455547332764
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3418641 Best vali loss: 0.3418641
Updating learning rate to 1.10486941171875e-05
Validation loss decreased (0.3419 --> 0.3403).  Saving model state dict ...
Epoch: 7 cost time: 0.813957691192627
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3402552 Best vali loss: 0.3402552
Updating learning rate to 5.52434705859375e-06
Epoch: 8 cost time: 0.8256692886352539
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3414150 Best vali loss: 0.3402552

best validation loss 0.34025515288641506

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008365105999, 'e_layers': 3, 'learning_rate': 0.0003240105917, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6692629
	speed: 0.0127s/iter; left time: 11.8071s
Updating learning rate to 0.0003116786728442507
Validation loss decreased (inf --> 0.3521).  Saving model state dict ...
Epoch: 1 cost time: 1.092930793762207
Epoch: 1, Steps: 129 | Train Loss: 0.6692629 Vali Loss: 0.3520661 Best vali loss: 0.3520661
	iters: 100, epoch: 2 | loss: 0.5266845
	speed: 0.0096s/iter; left time: 7.7280s
Updating learning rate to 0.00027656033913366784
Epoch: 2 cost time: 0.7743182182312012
Epoch: 2, Steps: 129 | Train Loss: 0.5266845 Vali Loss: 0.4192525 Best vali loss: 0.3520661
	iters: 100, epoch: 3 | loss: 0.5084521
	speed: 0.0092s/iter; left time: 6.1881s
Updating learning rate to 0.00022400203852719982
Epoch: 3 cost time: 0.7459309101104736
Epoch: 3, Steps: 129 | Train Loss: 0.5084521 Vali Loss: 0.4120372 Best vali loss: 0.3520661
	iters: 100, epoch: 4 | loss: 0.4675798
	speed: 0.0090s/iter; left time: 4.9337s
Updating learning rate to 0.00016200529585
Epoch: 4 cost time: 0.7285072803497314
Epoch: 4, Steps: 129 | Train Loss: 0.4675798 Vali Loss: 0.4009120 Best vali loss: 0.3520661
	iters: 100, epoch: 5 | loss: 0.5210268
	speed: 0.0091s/iter; left time: 3.7814s
Updating learning rate to 0.00010000855317280016
Epoch: 5 cost time: 0.7517967224121094
Epoch: 5, Steps: 129 | Train Loss: 0.5210268 Vali Loss: 0.3999409 Best vali loss: 0.3520661
	iters: 100, epoch: 6 | loss: 0.5220852
	speed: 0.0092s/iter; left time: 2.6545s
Updating learning rate to 4.745025256633216e-05
Epoch: 6 cost time: 0.7463748455047607
Epoch: 6, Steps: 129 | Train Loss: 0.5220852 Vali Loss: 0.4141903 Best vali loss: 0.3520661
	iters: 100, epoch: 7 | loss: 0.3631656
	speed: 0.0090s/iter; left time: 1.4252s
Updating learning rate to 1.2331918855749298e-05
Epoch: 7 cost time: 0.7359731197357178
Epoch: 7, Steps: 129 | Train Loss: 0.3631656 Vali Loss: 0.4201445 Best vali loss: 0.3520661
	iters: 100, epoch: 8 | loss: 0.3087123
	speed: 0.0089s/iter; left time: 0.2682s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7347917556762695
Epoch: 8, Steps: 129 | Train Loss: 0.3087123 Vali Loss: 0.4202910 Best vali loss: 0.3520661

best validation loss 0.35206605392729606

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019592322605, 'e_layers': 4, 'learning_rate': 0.0009652761014, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0009652761014
Validation loss decreased (inf --> 0.3778).  Saving model state dict ...
Epoch: 1 cost time: 1.1347472667694092
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3777887 Best vali loss: 0.3777887
Updating learning rate to 0.0004826380507
Epoch: 2 cost time: 0.8012712001800537
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3907634 Best vali loss: 0.3777887
Updating learning rate to 0.00024131902535
Epoch: 3 cost time: 0.7894995212554932
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3908780 Best vali loss: 0.3777887
Updating learning rate to 0.000120659512675
Epoch: 4 cost time: 0.7955465316772461
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3857847 Best vali loss: 0.3777887
Updating learning rate to 6.03297563375e-05
Epoch: 5 cost time: 0.7745018005371094
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3817324 Best vali loss: 0.3777887
Updating learning rate to 3.016487816875e-05
Validation loss decreased (0.3778 --> 0.3765).  Saving model state dict ...
Epoch: 6 cost time: 0.7801415920257568
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3765399 Best vali loss: 0.3765399
Updating learning rate to 1.5082439084375e-05
Validation loss decreased (0.3765 --> 0.3761).  Saving model state dict ...
Epoch: 7 cost time: 0.8061718940734863
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3761181 Best vali loss: 0.3761181
Updating learning rate to 7.5412195421875e-06
Validation loss decreased (0.3761 --> 0.3758).  Saving model state dict ...
Epoch: 8 cost time: 0.7810277938842773
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3758241 Best vali loss: 0.3758241

best validation loss 0.3758240525169785

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022869534234, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.6768124103546143
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3662528 Best vali loss: 0.3662528
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.3730456829071045
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3674741 Best vali loss: 0.3662528
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.3606250286102295
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3799834 Best vali loss: 0.3662528

best validation loss 0.3662528497531044

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021573254318, 'e_layers': 4, 'learning_rate': 0.0010492535041, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010492535041
Validation loss decreased (inf --> 0.3870).  Saving model state dict ...
Epoch: 1 cost time: 1.1115872859954834
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3870099 Best vali loss: 0.3870099
Updating learning rate to 0.00052462675205
Epoch: 2 cost time: 0.7953541278839111
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3909938 Best vali loss: 0.3870099
Updating learning rate to 0.000262313376025
Epoch: 3 cost time: 0.790276288986206
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4014623 Best vali loss: 0.3870099

best validation loss 0.3870098614154021

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0049541853265, 'e_layers': 4, 'learning_rate': 0.0004169256219, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4867746
	speed: 0.0118s/iter; left time: 95.6873s
	iters: 200, epoch: 1 | loss: 1.1066415
	speed: 0.0050s/iter; left time: 40.2183s
	iters: 300, epoch: 1 | loss: 1.1517457
	speed: 0.0051s/iter; left time: 40.6189s
	iters: 400, epoch: 1 | loss: 0.3578086
	speed: 0.0050s/iter; left time: 39.1591s
	iters: 500, epoch: 1 | loss: 0.4776458
	speed: 0.0050s/iter; left time: 38.4424s
	iters: 600, epoch: 1 | loss: 0.4170489
	speed: 0.0052s/iter; left time: 39.6105s
	iters: 700, epoch: 1 | loss: 0.7799556
	speed: 0.0052s/iter; left time: 39.2266s
	iters: 800, epoch: 1 | loss: 0.2698129
	speed: 0.0052s/iter; left time: 38.7757s
	iters: 900, epoch: 1 | loss: 0.8840107
	speed: 0.0053s/iter; left time: 38.9452s
	iters: 1000, epoch: 1 | loss: 0.8536623
	speed: 0.0052s/iter; left time: 37.6245s
Updating learning rate to 0.00040105733527647473
Validation loss decreased (inf --> 0.3947).  Saving model state dict ...
Epoch: 1 cost time: 5.625173091888428
Epoch: 1, Steps: 1027 | Train Loss: 0.6785106 Vali Loss: 0.3947436 Best vali loss: 0.3947436
	iters: 100, epoch: 2 | loss: 0.7065133
	speed: 0.0131s/iter; left time: 92.7254s
	iters: 200, epoch: 2 | loss: 0.5412556
	speed: 0.0050s/iter; left time: 35.0986s
	iters: 300, epoch: 2 | loss: 0.2968967
	speed: 0.0052s/iter; left time: 35.9997s
	iters: 400, epoch: 2 | loss: 1.5641139
	speed: 0.0052s/iter; left time: 35.3823s
	iters: 500, epoch: 2 | loss: 0.5934654
	speed: 0.0049s/iter; left time: 32.9780s
	iters: 600, epoch: 2 | loss: 1.0772258
	speed: 0.0050s/iter; left time: 32.7030s
	iters: 700, epoch: 2 | loss: 0.8854192
	speed: 0.0050s/iter; left time: 32.3530s
	iters: 800, epoch: 2 | loss: 0.6317560
	speed: 0.0050s/iter; left time: 31.7234s
	iters: 900, epoch: 2 | loss: 0.4312276
	speed: 0.0048s/iter; left time: 30.3732s
	iters: 1000, epoch: 2 | loss: 0.5259151
	speed: 0.0049s/iter; left time: 30.1564s
Updating learning rate to 0.00035586827819795427
Validation loss decreased (0.3947 --> 0.3862).  Saving model state dict ...
Epoch: 2 cost time: 5.169045925140381
Epoch: 2, Steps: 1027 | Train Loss: 0.7253789 Vali Loss: 0.3862291 Best vali loss: 0.3862291
	iters: 100, epoch: 3 | loss: 0.4843231
	speed: 0.0136s/iter; left time: 82.1640s
	iters: 200, epoch: 3 | loss: 0.2763053
	speed: 0.0049s/iter; left time: 29.2914s
	iters: 300, epoch: 3 | loss: 0.7436624
	speed: 0.0049s/iter; left time: 28.7167s
	iters: 400, epoch: 3 | loss: 0.3200492
	speed: 0.0050s/iter; left time: 28.7676s
	iters: 500, epoch: 3 | loss: 0.9406427
	speed: 0.0049s/iter; left time: 28.0205s
	iters: 600, epoch: 3 | loss: 0.9565635
	speed: 0.0050s/iter; left time: 27.7093s
	iters: 700, epoch: 3 | loss: 1.1973379
	speed: 0.0050s/iter; left time: 27.3126s
	iters: 800, epoch: 3 | loss: 0.8979259
	speed: 0.0050s/iter; left time: 26.7988s
	iters: 900, epoch: 3 | loss: 0.2958495
	speed: 0.0052s/iter; left time: 27.3183s
	iters: 1000, epoch: 3 | loss: 0.4343941
	speed: 0.0051s/iter; left time: 26.4558s
Updating learning rate to 0.0002882380749648208
Validation loss decreased (0.3862 --> 0.3820).  Saving model state dict ...
Epoch: 3 cost time: 5.192766427993774
Epoch: 3, Steps: 1027 | Train Loss: 0.6547053 Vali Loss: 0.3819912 Best vali loss: 0.3819912

best validation loss 0.3819911595821849

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022869534234, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 0.6694614887237549
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3818814 Best vali loss: 0.3662528
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3663 --> 0.3578).  Saving model state dict ...
Epoch: 5 cost time: 0.3572521209716797
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3577842 Best vali loss: 0.3577842
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.3703179359436035
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3722505 Best vali loss: 0.3577842
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.36255669593811035
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3598418 Best vali loss: 0.3577842
Updating learning rate to 0.0
Epoch: 8 cost time: 0.36017918586730957
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3648712 Best vali loss: 0.3577842

best validation loss 0.35778420004254474

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0107550665455, 'e_layers': 1, 'learning_rate': 0.0001787980014, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001719929076736922
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 0.6318302154541016
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701012 Best vali loss: 0.3701012
Updating learning rate to 0.00015261364032627089
Validation loss decreased (0.3701 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 0.32949137687683105
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3672896 Best vali loss: 0.3672896
Updating learning rate to 0.00012361051713788508
Epoch: 3 cost time: 0.3022487163543701
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3678413 Best vali loss: 0.3672896
Updating learning rate to 8.93990007e-05
Validation loss decreased (0.3673 --> 0.3668).  Saving model state dict ...
Epoch: 4 cost time: 0.31719112396240234
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3667932 Best vali loss: 0.3667932
Updating learning rate to 5.518748426211494e-05
Epoch: 5 cost time: 0.32070279121398926
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3684222 Best vali loss: 0.3667932
Updating learning rate to 2.6184361073729095e-05
Epoch: 6 cost time: 0.3063161373138428
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3701053 Best vali loss: 0.3667932
Updating learning rate to 6.805093726307804e-06
Epoch: 7 cost time: 0.3455178737640381
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3697164 Best vali loss: 0.3667932
Updating learning rate to 0.0
Epoch: 8 cost time: 0.2971153259277344
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3704074 Best vali loss: 0.3667932

best validation loss 0.36679317822390783

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008079263658, 'e_layers': 2, 'learning_rate': 0.0005693028919, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4200112
	speed: 0.0122s/iter; left time: 11.3536s
Updating learning rate to 0.0005476350907629478
Validation loss decreased (inf --> 0.3753).  Saving model state dict ...
Epoch: 1 cost time: 1.0374102592468262
Epoch: 1, Steps: 129 | Train Loss: 0.4200112 Vali Loss: 0.3752587 Best vali loss: 0.3752587
	iters: 100, epoch: 2 | loss: 0.4720838
	speed: 0.0091s/iter; left time: 7.2916s
Updating learning rate to 0.00048593041365580094
Validation loss decreased (0.3753 --> 0.3692).  Saving model state dict ...
Epoch: 2 cost time: 0.712960958480835
Epoch: 2, Steps: 129 | Train Loss: 0.4720838 Vali Loss: 0.3692168 Best vali loss: 0.3692168
	iters: 100, epoch: 3 | loss: 0.9901927
	speed: 0.0092s/iter; left time: 6.2422s
Updating learning rate to 0.00039358283831383183
Validation loss decreased (0.3692 --> 0.3683).  Saving model state dict ...
Epoch: 3 cost time: 0.7189123630523682
Epoch: 3, Steps: 129 | Train Loss: 0.9901927 Vali Loss: 0.3682976 Best vali loss: 0.3682976
	iters: 100, epoch: 4 | loss: 0.5627874
	speed: 0.0094s/iter; left time: 5.1322s
Updating learning rate to 0.00028465144595
Validation loss decreased (0.3683 --> 0.3502).  Saving model state dict ...
Epoch: 4 cost time: 0.7145452499389648
Epoch: 4, Steps: 129 | Train Loss: 0.5627874 Vali Loss: 0.3502164 Best vali loss: 0.3502164
	iters: 100, epoch: 5 | loss: 0.6091504
	speed: 0.0093s/iter; left time: 3.8813s
Updating learning rate to 0.00017572005358616817
Epoch: 5 cost time: 0.7296702861785889
Epoch: 5, Steps: 129 | Train Loss: 0.6091504 Vali Loss: 0.3568991 Best vali loss: 0.3502164
	iters: 100, epoch: 6 | loss: 0.4924685
	speed: 0.0091s/iter; left time: 2.6317s
Updating learning rate to 8.3372478244199e-05
Epoch: 6 cost time: 0.7398021221160889
Epoch: 6, Steps: 129 | Train Loss: 0.4924685 Vali Loss: 0.3615879 Best vali loss: 0.3502164
	iters: 100, epoch: 7 | loss: 0.6316735
	speed: 0.0091s/iter; left time: 1.4519s
Updating learning rate to 2.1667801137052193e-05
Epoch: 7 cost time: 0.7262203693389893
Epoch: 7, Steps: 129 | Train Loss: 0.6316735 Vali Loss: 0.3578687 Best vali loss: 0.3502164
	iters: 100, epoch: 8 | loss: 0.2901793
	speed: 0.0091s/iter; left time: 0.2726s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7244327068328857
Epoch: 8, Steps: 129 | Train Loss: 0.2901793 Vali Loss: 0.3561748 Best vali loss: 0.3502164

best validation loss 0.35021640226274203

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0013316178475, 'e_layers': 1, 'learning_rate': 0.0040496610152, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5284695
	speed: 0.0083s/iter; left time: 67.0965s
	iters: 200, epoch: 1 | loss: 0.3157431
	speed: 0.0022s/iter; left time: 17.7570s
	iters: 300, epoch: 1 | loss: 1.2361300
	speed: 0.0023s/iter; left time: 18.3193s
	iters: 400, epoch: 1 | loss: 0.5288569
	speed: 0.0024s/iter; left time: 18.7470s
	iters: 500, epoch: 1 | loss: 0.3772573
	speed: 0.0023s/iter; left time: 18.0273s
	iters: 600, epoch: 1 | loss: 1.1954714
	speed: 0.0023s/iter; left time: 17.5447s
	iters: 700, epoch: 1 | loss: 0.4717869
	speed: 0.0023s/iter; left time: 17.2718s
	iters: 800, epoch: 1 | loss: 0.2748700
	speed: 0.0023s/iter; left time: 17.3849s
	iters: 900, epoch: 1 | loss: 0.2881311
	speed: 0.0023s/iter; left time: 16.9335s
	iters: 1000, epoch: 1 | loss: 0.6267778
	speed: 0.0023s/iter; left time: 16.9368s
Updating learning rate to 0.0040496610152
Validation loss decreased (inf --> 0.3840).  Saving model state dict ...
Epoch: 1 cost time: 2.7214014530181885
Epoch: 1, Steps: 1027 | Train Loss: 0.5843494 Vali Loss: 0.3839649 Best vali loss: 0.3839649
	iters: 100, epoch: 2 | loss: 0.4399627
	speed: 0.0077s/iter; left time: 54.2483s
	iters: 200, epoch: 2 | loss: 0.3569486
	speed: 0.0023s/iter; left time: 15.9504s
	iters: 300, epoch: 2 | loss: 0.3021836
	speed: 0.0023s/iter; left time: 15.8597s
	iters: 400, epoch: 2 | loss: 0.1862385
	speed: 0.0022s/iter; left time: 15.0982s
	iters: 500, epoch: 2 | loss: 0.9653417
	speed: 0.0022s/iter; left time: 15.0381s
	iters: 600, epoch: 2 | loss: 0.3892553
	speed: 0.0023s/iter; left time: 14.9104s
	iters: 700, epoch: 2 | loss: 0.8785483
	speed: 0.0023s/iter; left time: 14.6228s
	iters: 800, epoch: 2 | loss: 0.1709398
	speed: 0.0021s/iter; left time: 13.2878s
	iters: 900, epoch: 2 | loss: 0.2100443
	speed: 0.0022s/iter; left time: 13.5355s
	iters: 1000, epoch: 2 | loss: 0.3615767
	speed: 0.0021s/iter; left time: 13.2178s
Updating learning rate to 0.0020248305076
Validation loss decreased (0.3840 --> 0.3653).  Saving model state dict ...
Epoch: 2 cost time: 2.3195548057556152
Epoch: 2, Steps: 1027 | Train Loss: 0.4261040 Vali Loss: 0.3652577 Best vali loss: 0.3652577
	iters: 100, epoch: 3 | loss: 0.3018164
	speed: 0.0075s/iter; left time: 45.3449s
	iters: 200, epoch: 3 | loss: 0.3930407
	speed: 0.0022s/iter; left time: 13.3510s
	iters: 300, epoch: 3 | loss: 0.2790460
	speed: 0.0023s/iter; left time: 13.4974s
	iters: 400, epoch: 3 | loss: 0.9733860
	speed: 0.0024s/iter; left time: 13.5454s
	iters: 500, epoch: 3 | loss: 0.2843202
	speed: 0.0023s/iter; left time: 13.1004s
	iters: 600, epoch: 3 | loss: 0.6442063
	speed: 0.0023s/iter; left time: 12.7090s
	iters: 700, epoch: 3 | loss: 0.2157507
	speed: 0.0023s/iter; left time: 12.4790s
	iters: 800, epoch: 3 | loss: 1.0816998
	speed: 0.0023s/iter; left time: 12.5846s
	iters: 900, epoch: 3 | loss: 1.2673794
	speed: 0.0023s/iter; left time: 12.0592s
	iters: 1000, epoch: 3 | loss: 0.2443219
	speed: 0.0024s/iter; left time: 12.2596s
Updating learning rate to 0.0010124152538
Epoch: 3 cost time: 2.4121720790863037
Epoch: 3, Steps: 1027 | Train Loss: 0.5684968 Vali Loss: 0.3667687 Best vali loss: 0.3652577

best validation loss 0.36525768172764356

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3906).  Saving model state dict ...
Epoch: 1 cost time: 1.3868763446807861
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3906185 Best vali loss: 0.3906185
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 1.0608799457550049
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4002328 Best vali loss: 0.3906185
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3906 --> 0.3852).  Saving model state dict ...
Epoch: 3 cost time: 1.067978858947754
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3852424 Best vali loss: 0.3852424

best validation loss 0.3852424006096741

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0090530663373, 'e_layers': 2, 'learning_rate': 0.0048978171135, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4991051
	speed: 0.0100s/iter; left time: 19.4958s
	iters: 200, epoch: 1 | loss: 0.6707454
	speed: 0.0033s/iter; left time: 6.1540s
Updating learning rate to 0.0048978171135
Validation loss decreased (inf --> 0.3796).  Saving model state dict ...
Epoch: 1 cost time: 1.2294907569885254
Epoch: 1, Steps: 257 | Train Loss: 0.5849253 Vali Loss: 0.3796137 Best vali loss: 0.3796137
	iters: 100, epoch: 2 | loss: 0.5823216
	speed: 0.0076s/iter; left time: 12.8993s
	iters: 200, epoch: 2 | loss: 0.6131216
	speed: 0.0031s/iter; left time: 5.0327s
Updating learning rate to 0.00244890855675
Epoch: 2 cost time: 0.8765320777893066
Epoch: 2, Steps: 257 | Train Loss: 0.5977216 Vali Loss: 0.3799286 Best vali loss: 0.3796137
	iters: 100, epoch: 3 | loss: 0.7765222
	speed: 0.0078s/iter; left time: 11.1853s
	iters: 200, epoch: 3 | loss: 0.9367576
	speed: 0.0033s/iter; left time: 4.4631s
Updating learning rate to 0.001224454278375
Validation loss decreased (0.3796 --> 0.3663).  Saving model state dict ...
Epoch: 3 cost time: 0.9071290493011475
Epoch: 3, Steps: 257 | Train Loss: 0.8566399 Vali Loss: 0.3662934 Best vali loss: 0.3662934

best validation loss 0.36629338492813185

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0013316178475, 'e_layers': 1, 'learning_rate': 0.0040496610152, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4585813
	speed: 0.0087s/iter; left time: 43.8625s
	iters: 200, epoch: 4 | loss: 0.2741861
	speed: 0.0025s/iter; left time: 12.1046s
	iters: 300, epoch: 4 | loss: 1.2017303
	speed: 0.0024s/iter; left time: 11.6193s
	iters: 400, epoch: 4 | loss: 0.5309373
	speed: 0.0024s/iter; left time: 11.3624s
	iters: 500, epoch: 4 | loss: 0.3733376
	speed: 0.0024s/iter; left time: 11.2280s
	iters: 600, epoch: 4 | loss: 1.0251849
	speed: 0.0024s/iter; left time: 10.6769s
	iters: 700, epoch: 4 | loss: 0.4192843
	speed: 0.0024s/iter; left time: 10.5905s
	iters: 800, epoch: 4 | loss: 0.2457499
	speed: 0.0024s/iter; left time: 10.5674s
	iters: 900, epoch: 4 | loss: 0.2426212
	speed: 0.0024s/iter; left time: 10.0774s
	iters: 1000, epoch: 4 | loss: 0.5999126
	speed: 0.0024s/iter; left time: 9.8115s
Updating learning rate to 0.0005062076269
Validation loss decreased (0.3653 --> 0.3652).  Saving model state dict ...
Epoch: 4 cost time: 2.8239710330963135
Epoch: 4, Steps: 1027 | Train Loss: 0.5371525 Vali Loss: 0.3651966 Best vali loss: 0.3651966
	iters: 100, epoch: 5 | loss: 0.4320026
	speed: 0.0077s/iter; left time: 30.7002s
	iters: 200, epoch: 5 | loss: 0.3460742
	speed: 0.0023s/iter; left time: 9.1598s
	iters: 300, epoch: 5 | loss: 0.2890250
	speed: 0.0023s/iter; left time: 8.9471s
	iters: 400, epoch: 5 | loss: 0.1876163
	speed: 0.0024s/iter; left time: 8.8713s
	iters: 500, epoch: 5 | loss: 1.0182409
	speed: 0.0024s/iter; left time: 8.5506s
	iters: 600, epoch: 5 | loss: 0.4006479
	speed: 0.0024s/iter; left time: 8.4165s
	iters: 700, epoch: 5 | loss: 0.9513185
	speed: 0.0024s/iter; left time: 8.1126s
	iters: 800, epoch: 5 | loss: 0.1741127
	speed: 0.0024s/iter; left time: 7.9124s
	iters: 900, epoch: 5 | loss: 0.2173809
	speed: 0.0024s/iter; left time: 7.6564s
	iters: 1000, epoch: 5 | loss: 0.3732007
	speed: 0.0024s/iter; left time: 7.4051s
Updating learning rate to 0.00025310381345
Validation loss decreased (0.3652 --> 0.3635).  Saving model state dict ...
Epoch: 5 cost time: 2.4839510917663574
Epoch: 5, Steps: 1027 | Train Loss: 0.4389620 Vali Loss: 0.3635147 Best vali loss: 0.3635147
	iters: 100, epoch: 6 | loss: 0.2837282
	speed: 0.0076s/iter; left time: 22.6358s
	iters: 200, epoch: 6 | loss: 0.3910203
	speed: 0.0024s/iter; left time: 6.7890s
	iters: 300, epoch: 6 | loss: 0.2730487
	speed: 0.0023s/iter; left time: 6.5311s
	iters: 400, epoch: 6 | loss: 0.9868588
	speed: 0.0023s/iter; left time: 6.2245s
	iters: 500, epoch: 6 | loss: 0.2800253
	speed: 0.0023s/iter; left time: 5.9624s
	iters: 600, epoch: 6 | loss: 0.6157202
	speed: 0.0023s/iter; left time: 5.7826s
	iters: 700, epoch: 6 | loss: 0.2229830
	speed: 0.0023s/iter; left time: 5.5004s
	iters: 800, epoch: 6 | loss: 1.0718182
	speed: 0.0023s/iter; left time: 5.3288s
	iters: 900, epoch: 6 | loss: 0.9991326
	speed: 0.0023s/iter; left time: 5.0538s
	iters: 1000, epoch: 6 | loss: 0.2535402
	speed: 0.0024s/iter; left time: 4.8977s
Updating learning rate to 0.000126551906725
Epoch: 6 cost time: 2.4369709491729736
Epoch: 6, Steps: 1027 | Train Loss: 0.5377876 Vali Loss: 0.3649430 Best vali loss: 0.3635147
	iters: 100, epoch: 7 | loss: 0.2740698
	speed: 0.0077s/iter; left time: 15.1246s
	iters: 200, epoch: 7 | loss: 0.3986120
	speed: 0.0022s/iter; left time: 4.1343s
	iters: 300, epoch: 7 | loss: 1.0283736
	speed: 0.0022s/iter; left time: 3.9280s
	iters: 400, epoch: 7 | loss: 0.2878920
	speed: 0.0022s/iter; left time: 3.6502s
	iters: 500, epoch: 7 | loss: 0.4788864
	speed: 0.0022s/iter; left time: 3.3541s
	iters: 600, epoch: 7 | loss: 0.1830960
	speed: 0.0022s/iter; left time: 3.1529s
	iters: 700, epoch: 7 | loss: 0.1817261
	speed: 0.0022s/iter; left time: 2.9586s
	iters: 800, epoch: 7 | loss: 0.3204477
	speed: 0.0022s/iter; left time: 2.7359s
	iters: 900, epoch: 7 | loss: 0.4782920
	speed: 0.0022s/iter; left time: 2.5338s
	iters: 1000, epoch: 7 | loss: 0.3183546
	speed: 0.0022s/iter; left time: 2.3023s
Updating learning rate to 6.32759533625e-05
Epoch: 7 cost time: 2.3228378295898438
Epoch: 7, Steps: 1027 | Train Loss: 0.3949750 Vali Loss: 0.3651694 Best vali loss: 0.3635147
	iters: 100, epoch: 8 | loss: 0.9178928
	speed: 0.0076s/iter; left time: 7.0959s
	iters: 200, epoch: 8 | loss: 0.6323211
	speed: 0.0024s/iter; left time: 1.9622s
	iters: 300, epoch: 8 | loss: 0.3862253
	speed: 0.0024s/iter; left time: 1.7237s
	iters: 400, epoch: 8 | loss: 0.2513699
	speed: 0.0024s/iter; left time: 1.4813s
	iters: 500, epoch: 8 | loss: 0.4553583
	speed: 0.0023s/iter; left time: 1.2068s
	iters: 600, epoch: 8 | loss: 1.2777423
	speed: 0.0022s/iter; left time: 0.9501s
	iters: 700, epoch: 8 | loss: 0.4407436
	speed: 0.0021s/iter; left time: 0.7007s
	iters: 800, epoch: 8 | loss: 0.4494859
	speed: 0.0021s/iter; left time: 0.4864s
	iters: 900, epoch: 8 | loss: 0.8330134
	speed: 0.0021s/iter; left time: 0.2733s
	iters: 1000, epoch: 8 | loss: 0.4955883
	speed: 0.0021s/iter; left time: 0.0601s
Updating learning rate to 3.163797668125e-05
Epoch: 8 cost time: 2.3575680255889893
Epoch: 8, Steps: 1027 | Train Loss: 0.6139741 Vali Loss: 0.3650597 Best vali loss: 0.3635147

best validation loss 0.36351466540737565

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.001975211627, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.1214566230773926
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706876 Best vali loss: 0.3706876
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3707 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 0.7907195091247559
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3630149 Best vali loss: 0.3630149
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3630 --> 0.3503).  Saving model state dict ...
Epoch: 3 cost time: 0.7799999713897705
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3503189 Best vali loss: 0.3503189
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3503 --> 0.3442).  Saving model state dict ...
Epoch: 4 cost time: 0.7933080196380615
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3441877 Best vali loss: 0.3441877
Updating learning rate to 4.419018625625e-05
Validation loss decreased (0.3442 --> 0.3411).  Saving model state dict ...
Epoch: 5 cost time: 0.7910974025726318
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3410832 Best vali loss: 0.3410832
Updating learning rate to 2.2095093128125e-05
Epoch: 6 cost time: 0.7930731773376465
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3412969 Best vali loss: 0.3410832
Updating learning rate to 1.10475465640625e-05
Epoch: 7 cost time: 0.8268430233001709
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3421070 Best vali loss: 0.3410832
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.7929494380950928
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3416959 Best vali loss: 0.3410832

best validation loss 0.3410832340333223

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.003198292192, 'e_layers': 3, 'learning_rate': 7.77291134e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7195780
	speed: 0.0114s/iter; left time: 10.6637s
Updating learning rate to 7.47707251752544e-05
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.0157699584960938
Epoch: 1, Steps: 129 | Train Loss: 0.7195780 Vali Loss: 0.3715724 Best vali loss: 0.3715724
	iters: 100, epoch: 2 | loss: 0.5151376
	speed: 0.0087s/iter; left time: 6.9726s
Updating learning rate to 6.634594829037907e-05
Validation loss decreased (0.3716 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.7060971260070801
Epoch: 2, Steps: 129 | Train Loss: 0.5151376 Vali Loss: 0.3647940 Best vali loss: 0.3647940
	iters: 100, epoch: 3 | loss: 0.8038698
	speed: 0.0088s/iter; left time: 5.9213s
Updating learning rate to 5.373737865530365e-05
Validation loss decreased (0.3648 --> 0.3630).  Saving model state dict ...
Epoch: 3 cost time: 0.7047357559204102
Epoch: 3, Steps: 129 | Train Loss: 0.8038698 Vali Loss: 0.3630185 Best vali loss: 0.3630185
	iters: 100, epoch: 4 | loss: 0.6531273
	speed: 0.0085s/iter; left time: 4.6675s
Updating learning rate to 3.88645567e-05
Validation loss decreased (0.3630 --> 0.3610).  Saving model state dict ...
Epoch: 4 cost time: 0.6745908260345459
Epoch: 4, Steps: 129 | Train Loss: 0.6531273 Vali Loss: 0.3609973 Best vali loss: 0.3609973
	iters: 100, epoch: 5 | loss: 0.8263118
	speed: 0.0084s/iter; left time: 3.4996s
Updating learning rate to 2.3991734744696357e-05
Epoch: 5 cost time: 0.6900150775909424
Epoch: 5, Steps: 129 | Train Loss: 0.8263118 Vali Loss: 0.3629453 Best vali loss: 0.3609973
	iters: 100, epoch: 6 | loss: 0.8234763
	speed: 0.0083s/iter; left time: 2.3997s
Updating learning rate to 1.1383165109620933e-05
Validation loss decreased (0.3610 --> 0.3601).  Saving model state dict ...
Epoch: 6 cost time: 0.6494128704071045
Epoch: 6, Steps: 129 | Train Loss: 0.8234763 Vali Loss: 0.3601256 Best vali loss: 0.3601256
	iters: 100, epoch: 7 | loss: 0.6801482
	speed: 0.0084s/iter; left time: 1.3338s
Updating learning rate to 2.9583882247456033e-06
Epoch: 7 cost time: 0.6857583522796631
Epoch: 7, Steps: 129 | Train Loss: 0.6801482 Vali Loss: 0.3615905 Best vali loss: 0.3601256
	iters: 100, epoch: 8 | loss: 0.4491178
	speed: 0.0082s/iter; left time: 0.2473s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6621687412261963
Epoch: 8, Steps: 129 | Train Loss: 0.4491178 Vali Loss: 0.3625618 Best vali loss: 0.3601256

best validation loss 0.36012562974731205

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019507679028, 'e_layers': 4, 'learning_rate': 0.000701027873, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000701027873
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 1.1269304752349854
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3707566 Best vali loss: 0.3707566
Updating learning rate to 0.0003505139365
Epoch: 2 cost time: 0.804124116897583
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3776250 Best vali loss: 0.3707566
Updating learning rate to 0.00017525696825
Validation loss decreased (0.3708 --> 0.3626).  Saving model state dict ...
Epoch: 3 cost time: 0.7995126247406006
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3626130 Best vali loss: 0.3626130

best validation loss 0.3626129884733901

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022929653575, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006805626573947573
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.1453230381011963
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669072 Best vali loss: 0.3669072
Updating learning rate to 0.0006038803926275002
Epoch: 2 cost time: 0.8120408058166504
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3776870 Best vali loss: 0.3669072
Updating learning rate to 0.0004891172732825823
Validation loss decreased (0.3669 --> 0.3593).  Saving model state dict ...
Epoch: 3 cost time: 0.8041374683380127
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3592705 Best vali loss: 0.3592705

best validation loss 0.35927046565503645

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.008781972105, 'e_layers': 4, 'learning_rate': 0.0004042235466, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2869370
	speed: 0.0112s/iter; left time: 90.8997s
	iters: 200, epoch: 1 | loss: 0.6574335
	speed: 0.0048s/iter; left time: 38.3351s
	iters: 300, epoch: 1 | loss: 1.3853123
	speed: 0.0048s/iter; left time: 37.7439s
	iters: 400, epoch: 1 | loss: 0.4754990
	speed: 0.0049s/iter; left time: 38.1775s
	iters: 500, epoch: 1 | loss: 0.7909980
	speed: 0.0049s/iter; left time: 38.0841s
	iters: 600, epoch: 1 | loss: 1.2392970
	speed: 0.0048s/iter; left time: 36.3379s
	iters: 700, epoch: 1 | loss: 0.3375986
	speed: 0.0047s/iter; left time: 35.3437s
	iters: 800, epoch: 1 | loss: 0.7365019
	speed: 0.0046s/iter; left time: 33.7487s
	iters: 900, epoch: 1 | loss: 0.3205375
	speed: 0.0046s/iter; left time: 33.4255s
	iters: 1000, epoch: 1 | loss: 0.7680796
	speed: 0.0045s/iter; left time: 32.5991s
Updating learning rate to 0.0004042235466
Validation loss decreased (inf --> 0.3755).  Saving model state dict ...
Epoch: 1 cost time: 5.217266321182251
Epoch: 1, Steps: 1027 | Train Loss: 0.7998194 Vali Loss: 0.3755135 Best vali loss: 0.3755135
	iters: 100, epoch: 2 | loss: 0.3207517
	speed: 0.0130s/iter; left time: 91.8588s
	iters: 200, epoch: 2 | loss: 1.4211826
	speed: 0.0046s/iter; left time: 32.4651s
	iters: 300, epoch: 2 | loss: 0.5362122
	speed: 0.0047s/iter; left time: 32.2216s
	iters: 400, epoch: 2 | loss: 0.9728221
	speed: 0.0049s/iter; left time: 33.1864s
	iters: 500, epoch: 2 | loss: 0.3911271
	speed: 0.0048s/iter; left time: 32.2730s
	iters: 600, epoch: 2 | loss: 0.5544457
	speed: 0.0048s/iter; left time: 31.5842s
	iters: 700, epoch: 2 | loss: 1.0518857
	speed: 0.0047s/iter; left time: 30.5318s
	iters: 800, epoch: 2 | loss: 0.5557039
	speed: 0.0048s/iter; left time: 30.8826s
	iters: 900, epoch: 2 | loss: 0.6217037
	speed: 0.0049s/iter; left time: 30.5133s
	iters: 1000, epoch: 2 | loss: 0.3163379
	speed: 0.0048s/iter; left time: 29.7808s
Updating learning rate to 0.0002021117733
Validation loss decreased (0.3755 --> 0.3688).  Saving model state dict ...
Epoch: 2 cost time: 4.947514295578003
Epoch: 2, Steps: 1027 | Train Loss: 0.6742173 Vali Loss: 0.3688381 Best vali loss: 0.3688381
	iters: 100, epoch: 3 | loss: 1.4706643
	speed: 0.0135s/iter; left time: 81.5760s
	iters: 200, epoch: 3 | loss: 0.5103211
	speed: 0.0051s/iter; left time: 30.2252s
	iters: 300, epoch: 3 | loss: 0.4611536
	speed: 0.0050s/iter; left time: 29.5766s
	iters: 400, epoch: 3 | loss: 0.8169388
	speed: 0.0050s/iter; left time: 28.6851s
	iters: 500, epoch: 3 | loss: 0.5159470
	speed: 0.0050s/iter; left time: 28.5969s
	iters: 600, epoch: 3 | loss: 0.2078169
	speed: 0.0050s/iter; left time: 27.9919s
	iters: 700, epoch: 3 | loss: 1.0264342
	speed: 0.0050s/iter; left time: 27.4162s
	iters: 800, epoch: 3 | loss: 0.2849622
	speed: 0.0050s/iter; left time: 26.7974s
	iters: 900, epoch: 3 | loss: 0.6941180
	speed: 0.0049s/iter; left time: 25.9002s
	iters: 1000, epoch: 3 | loss: 1.0378096
	speed: 0.0046s/iter; left time: 23.6995s
Updating learning rate to 0.00010105588665
Validation loss decreased (0.3688 --> 0.3584).  Saving model state dict ...
Epoch: 3 cost time: 5.136874675750732
Epoch: 3, Steps: 1027 | Train Loss: 0.7026166 Vali Loss: 0.3584413 Best vali loss: 0.3584413

best validation loss 0.3584413090951316

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.008781972105, 'e_layers': 4, 'learning_rate': 0.0004042235466, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9838257
	speed: 0.0114s/iter; left time: 57.3162s
	iters: 200, epoch: 4 | loss: 0.6775080
	speed: 0.0051s/iter; left time: 24.9957s
	iters: 300, epoch: 4 | loss: 1.2783487
	speed: 0.0052s/iter; left time: 25.0040s
	iters: 400, epoch: 4 | loss: 0.4212113
	speed: 0.0053s/iter; left time: 25.1869s
	iters: 500, epoch: 4 | loss: 0.8542365
	speed: 0.0052s/iter; left time: 24.0155s
	iters: 600, epoch: 4 | loss: 1.1470965
	speed: 0.0052s/iter; left time: 23.3841s
	iters: 700, epoch: 4 | loss: 0.3430981
	speed: 0.0047s/iter; left time: 20.8389s
	iters: 800, epoch: 4 | loss: 0.5069746
	speed: 0.0047s/iter; left time: 20.4826s
	iters: 900, epoch: 4 | loss: 0.2953960
	speed: 0.0047s/iter; left time: 20.0274s
	iters: 1000, epoch: 4 | loss: 0.6511119
	speed: 0.0048s/iter; left time: 19.7093s
Updating learning rate to 5.0527943325e-05
Validation loss decreased (0.3584 --> 0.3472).  Saving model state dict ...
Epoch: 4 cost time: 5.46687126159668
Epoch: 4, Steps: 1027 | Train Loss: 0.7158807 Vali Loss: 0.3471931 Best vali loss: 0.3471931
	iters: 100, epoch: 5 | loss: 0.3208008
	speed: 0.0134s/iter; left time: 53.8879s
	iters: 200, epoch: 5 | loss: 1.2562996
	speed: 0.0048s/iter; left time: 18.9582s
	iters: 300, epoch: 5 | loss: 0.3985456
	speed: 0.0045s/iter; left time: 17.2754s
	iters: 400, epoch: 5 | loss: 0.7696501
	speed: 0.0045s/iter; left time: 16.5385s
	iters: 500, epoch: 5 | loss: 0.3735996
	speed: 0.0045s/iter; left time: 16.3719s
	iters: 600, epoch: 5 | loss: 0.4550649
	speed: 0.0045s/iter; left time: 15.8745s
	iters: 700, epoch: 5 | loss: 0.8759647
	speed: 0.0047s/iter; left time: 15.9697s
	iters: 800, epoch: 5 | loss: 0.5245106
	speed: 0.0045s/iter; left time: 14.9463s
	iters: 900, epoch: 5 | loss: 0.5505531
	speed: 0.0046s/iter; left time: 14.6898s
	iters: 1000, epoch: 5 | loss: 0.2772680
	speed: 0.0047s/iter; left time: 14.6898s
Updating learning rate to 2.52639716625e-05
Epoch: 5 cost time: 4.800158739089966
Epoch: 5, Steps: 1027 | Train Loss: 0.5802257 Vali Loss: 0.3551629 Best vali loss: 0.3471931
	iters: 100, epoch: 6 | loss: 1.2152719
	speed: 0.0128s/iter; left time: 38.2283s
	iters: 200, epoch: 6 | loss: 0.5069325
	speed: 0.0049s/iter; left time: 13.9829s
	iters: 300, epoch: 6 | loss: 0.4118822
	speed: 0.0048s/iter; left time: 13.3237s
	iters: 400, epoch: 6 | loss: 0.7828023
	speed: 0.0047s/iter; left time: 12.4713s
	iters: 500, epoch: 6 | loss: 0.4995652
	speed: 0.0047s/iter; left time: 12.1562s
	iters: 600, epoch: 6 | loss: 0.1832804
	speed: 0.0047s/iter; left time: 11.6130s
	iters: 700, epoch: 6 | loss: 0.8647214
	speed: 0.0047s/iter; left time: 11.1478s
	iters: 800, epoch: 6 | loss: 0.2686118
	speed: 0.0047s/iter; left time: 10.7127s
	iters: 900, epoch: 6 | loss: 0.5350783
	speed: 0.0048s/iter; left time: 10.5225s
	iters: 1000, epoch: 6 | loss: 0.6902643
	speed: 0.0048s/iter; left time: 9.9383s
Updating learning rate to 1.263198583125e-05
Epoch: 6 cost time: 4.928374290466309
Epoch: 6, Steps: 1027 | Train Loss: 0.5958410 Vali Loss: 0.3491447 Best vali loss: 0.3471931
	iters: 100, epoch: 7 | loss: 0.4177452
	speed: 0.0128s/iter; left time: 25.0942s
	iters: 200, epoch: 7 | loss: 0.2652691
	speed: 0.0046s/iter; left time: 8.5317s
	iters: 300, epoch: 7 | loss: 0.9157004
	speed: 0.0048s/iter; left time: 8.4330s
	iters: 400, epoch: 7 | loss: 0.9863250
	speed: 0.0047s/iter; left time: 7.7329s
	iters: 500, epoch: 7 | loss: 0.3666650
	speed: 0.0047s/iter; left time: 7.3758s
	iters: 600, epoch: 7 | loss: 0.3417863
	speed: 0.0047s/iter; left time: 6.8161s
	iters: 700, epoch: 7 | loss: 0.3038683
	speed: 0.0047s/iter; left time: 6.4249s
	iters: 800, epoch: 7 | loss: 0.4529890
	speed: 0.0047s/iter; left time: 5.8816s
	iters: 900, epoch: 7 | loss: 0.3097312
	speed: 0.0048s/iter; left time: 5.5853s
	iters: 1000, epoch: 7 | loss: 0.4045780
	speed: 0.0047s/iter; left time: 4.9407s
Updating learning rate to 6.315992915625e-06
Epoch: 7 cost time: 4.886843204498291
Epoch: 7, Steps: 1027 | Train Loss: 0.4764657 Vali Loss: 0.3531908 Best vali loss: 0.3471931
	iters: 100, epoch: 8 | loss: 0.3253120
	speed: 0.0125s/iter; left time: 11.6312s
	iters: 200, epoch: 8 | loss: 0.3825234
	speed: 0.0047s/iter; left time: 3.9162s
	iters: 300, epoch: 8 | loss: 0.3830177
	speed: 0.0046s/iter; left time: 3.3775s
	iters: 400, epoch: 8 | loss: 0.1896767
	speed: 0.0049s/iter; left time: 3.0712s
	iters: 500, epoch: 8 | loss: 0.3186091
	speed: 0.0048s/iter; left time: 2.5459s
	iters: 600, epoch: 8 | loss: 0.4985341
	speed: 0.0046s/iter; left time: 1.9862s
	iters: 700, epoch: 8 | loss: 0.2759075
	speed: 0.0045s/iter; left time: 1.4841s
	iters: 800, epoch: 8 | loss: 0.7184388
	speed: 0.0045s/iter; left time: 1.0300s
	iters: 900, epoch: 8 | loss: 0.1982047
	speed: 0.0046s/iter; left time: 0.5825s
	iters: 1000, epoch: 8 | loss: 0.8662940
	speed: 0.0045s/iter; left time: 0.1259s
Updating learning rate to 3.1579964578125e-06
Epoch: 8 cost time: 4.815594911575317
Epoch: 8, Steps: 1027 | Train Loss: 0.4156518 Vali Loss: 0.3500496 Best vali loss: 0.3471931

best validation loss 0.3471930752685824

[INFO][smbo.py:320] Finished 700 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022055377829, 'e_layers': 1, 'learning_rate': 0.0004474210815, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004474210815
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 0.6198608875274658
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3646173 Best vali loss: 0.3646173
Updating learning rate to 0.00022371054075
Epoch: 2 cost time: 0.3214740753173828
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3649752 Best vali loss: 0.3646173
Updating learning rate to 0.000111855270375
Epoch: 3 cost time: 0.3367955684661865
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3646721 Best vali loss: 0.3646173
Updating learning rate to 5.59276351875e-05
Epoch: 4 cost time: 0.3214840888977051
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3665029 Best vali loss: 0.3646173
Updating learning rate to 2.796381759375e-05
Epoch: 5 cost time: 0.3614959716796875
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3674256 Best vali loss: 0.3646173
Updating learning rate to 1.3981908796875e-05
Epoch: 6 cost time: 0.3166193962097168
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3691469 Best vali loss: 0.3646173
Updating learning rate to 6.9909543984375e-06
Epoch: 7 cost time: 0.31926655769348145
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3685665 Best vali loss: 0.3646173
Updating learning rate to 3.49547719921875e-06
Epoch: 8 cost time: 0.32811617851257324
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3685503 Best vali loss: 0.3646173

best validation loss 0.36461733827890724

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0052920454663, 'e_layers': 1, 'learning_rate': 9.68876853e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.320011735053233e-05
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 0.6503403186798096
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3716127 Best vali loss: 0.3716127
Updating learning rate to 8.269881229454909e-05
Validation loss decreased (0.3716 --> 0.3631).  Saving model state dict ...
Epoch: 2 cost time: 0.33303284645080566
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3630991 Best vali loss: 0.3630991
Updating learning rate to 6.698249863225632e-05
Epoch: 3 cost time: 0.33509302139282227
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3640439 Best vali loss: 0.3630991
Updating learning rate to 4.844384265e-05
Epoch: 4 cost time: 0.3261425495147705
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3639949 Best vali loss: 0.3630991
Updating learning rate to 2.9905186667743677e-05
Epoch: 5 cost time: 0.36012935638427734
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3647629 Best vali loss: 0.3630991
Updating learning rate to 1.4188873005450915e-05
Epoch: 6 cost time: 0.33430981636047363
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3647624 Best vali loss: 0.3630991
Updating learning rate to 3.6875679494676657e-06
Epoch: 7 cost time: 0.3354759216308594
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3644645 Best vali loss: 0.3630991
Updating learning rate to 0.0
Epoch: 8 cost time: 0.33087658882141113
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3647961 Best vali loss: 0.3630991

best validation loss 0.3630990794693323

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018043854689, 'e_layers': 1, 'learning_rate': 0.0047772952105, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0047772952105
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 0.602515459060669
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3685984 Best vali loss: 0.3685984
Updating learning rate to 0.00238864760525
Epoch: 2 cost time: 0.3208954334259033
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3819406 Best vali loss: 0.3685984
Updating learning rate to 0.001194323802625
Epoch: 3 cost time: 0.3482933044433594
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3944927 Best vali loss: 0.3685984

best validation loss 0.3685984344519894

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0022137533557, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.1606721878051758
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704078 Best vali loss: 0.3704078
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3704 --> 0.3609).  Saving model state dict ...
Epoch: 2 cost time: 0.8014137744903564
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3608904 Best vali loss: 0.3608904
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3609 --> 0.3594).  Saving model state dict ...
Epoch: 3 cost time: 0.8062748908996582
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3594411 Best vali loss: 0.3594411

best validation loss 0.3594411085537234

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0022138611007, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.104501485824585
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703951 Best vali loss: 0.3703951
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.8175399303436279
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3756786 Best vali loss: 0.3703951
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3704 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 0.8006818294525146
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3542312 Best vali loss: 0.3542312

best validation loss 0.3542312234464469

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.0022138611007, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3542 --> 0.3519).  Saving model state dict ...
Epoch: 4 cost time: 1.112701177597046
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3518595 Best vali loss: 0.3518595
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.797612190246582
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3534166 Best vali loss: 0.3518595
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.8013753890991211
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3538234 Best vali loss: 0.3518595
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3519 --> 0.3485).  Saving model state dict ...
Epoch: 7 cost time: 0.808558464050293
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3485080 Best vali loss: 0.3485080
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.8132975101470947
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3506293 Best vali loss: 0.3485080

best validation loss 0.3485079693887932

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007071164235, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007071164235
Validation loss decreased (inf --> 0.3793).  Saving model state dict ...
Epoch: 1 cost time: 1.2909328937530518
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3793453 Best vali loss: 0.3793453
Updating learning rate to 0.00035355821175
Validation loss decreased (0.3793 --> 0.3748).  Saving model state dict ...
Epoch: 2 cost time: 0.9673058986663818
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3748482 Best vali loss: 0.3748482
Updating learning rate to 0.000176779105875
Epoch: 3 cost time: 0.9655671119689941
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3791507 Best vali loss: 0.3748482
Updating learning rate to 8.83895529375e-05
Validation loss decreased (0.3748 --> 0.3745).  Saving model state dict ...
Epoch: 4 cost time: 0.9628245830535889
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3744584 Best vali loss: 0.3744584
Updating learning rate to 4.419477646875e-05
Validation loss decreased (0.3745 --> 0.3721).  Saving model state dict ...
Epoch: 5 cost time: 0.9674162864685059
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3721462 Best vali loss: 0.3721462
Updating learning rate to 2.2097388234375e-05
Validation loss decreased (0.3721 --> 0.3636).  Saving model state dict ...
Epoch: 6 cost time: 0.9675405025482178
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3635641 Best vali loss: 0.3635641
Updating learning rate to 1.10486941171875e-05
Validation loss decreased (0.3636 --> 0.3626).  Saving model state dict ...
Epoch: 7 cost time: 0.9653749465942383
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3626241 Best vali loss: 0.3626241
Updating learning rate to 5.52434705859375e-06
Validation loss decreased (0.3626 --> 0.3618).  Saving model state dict ...
Epoch: 8 cost time: 0.9552221298217773
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3618114 Best vali loss: 0.3618114

best validation loss 0.3618114124698114

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0110790170657, 'e_layers': 4, 'learning_rate': 0.0004621244417, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4640533
	speed: 0.0121s/iter; left time: 23.7510s
	iters: 200, epoch: 1 | loss: 0.7207417
	speed: 0.0054s/iter; left time: 9.9989s
Updating learning rate to 0.0004621244417
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 1.7241315841674805
Epoch: 1, Steps: 257 | Train Loss: 0.5923975 Vali Loss: 0.3695111 Best vali loss: 0.3695111
	iters: 100, epoch: 2 | loss: 0.2535598
	speed: 0.0110s/iter; left time: 18.7240s
	iters: 200, epoch: 2 | loss: 0.5088522
	speed: 0.0050s/iter; left time: 8.0686s
Updating learning rate to 0.00023106222085
Validation loss decreased (0.3695 --> 0.3674).  Saving model state dict ...
Epoch: 2 cost time: 1.3598573207855225
Epoch: 2, Steps: 257 | Train Loss: 0.3812060 Vali Loss: 0.3673761 Best vali loss: 0.3673761
	iters: 100, epoch: 3 | loss: 0.9224142
	speed: 0.0110s/iter; left time: 15.8899s
	iters: 200, epoch: 3 | loss: 0.5205243
	speed: 0.0049s/iter; left time: 6.6353s
Updating learning rate to 0.000115531110425
Validation loss decreased (0.3674 --> 0.3663).  Saving model state dict ...
Epoch: 3 cost time: 1.3321809768676758
Epoch: 3, Steps: 257 | Train Loss: 0.7214693 Vali Loss: 0.3663398 Best vali loss: 0.3663398
	iters: 100, epoch: 4 | loss: 0.4759011
	speed: 0.0112s/iter; left time: 13.2795s
	iters: 200, epoch: 4 | loss: 0.6577722
	speed: 0.0055s/iter; left time: 5.9226s
Updating learning rate to 5.77655552125e-05
Validation loss decreased (0.3663 --> 0.3456).  Saving model state dict ...
Epoch: 4 cost time: 1.4474070072174072
Epoch: 4, Steps: 257 | Train Loss: 0.5668367 Vali Loss: 0.3455727 Best vali loss: 0.3455727
	iters: 100, epoch: 5 | loss: 0.8712157
	speed: 0.0113s/iter; left time: 10.5061s
	iters: 200, epoch: 5 | loss: 0.5749618
	speed: 0.0048s/iter; left time: 4.0149s
Updating learning rate to 2.888277760625e-05
Epoch: 5 cost time: 1.3259193897247314
Epoch: 5, Steps: 257 | Train Loss: 0.7230888 Vali Loss: 0.3591245 Best vali loss: 0.3455727
	iters: 100, epoch: 6 | loss: 0.5134256
	speed: 0.0109s/iter; left time: 7.3323s
	iters: 200, epoch: 6 | loss: 0.6400980
	speed: 0.0055s/iter; left time: 3.1637s
Updating learning rate to 1.4441388803125e-05
Epoch: 6 cost time: 1.4680111408233643
Epoch: 6, Steps: 257 | Train Loss: 0.5767618 Vali Loss: 0.3514138 Best vali loss: 0.3455727
	iters: 100, epoch: 7 | loss: 0.5008849
	speed: 0.0116s/iter; left time: 4.7940s
	iters: 200, epoch: 7 | loss: 0.6105908
	speed: 0.0054s/iter; left time: 1.7099s
Updating learning rate to 7.2206944015625e-06
Epoch: 7 cost time: 1.4392244815826416
Epoch: 7, Steps: 257 | Train Loss: 0.5557379 Vali Loss: 0.3549506 Best vali loss: 0.3455727
	iters: 100, epoch: 8 | loss: 0.4692009
	speed: 0.0111s/iter; left time: 1.7602s
	iters: 200, epoch: 8 | loss: 0.5607790
	speed: 0.0051s/iter; left time: 0.2946s
Updating learning rate to 3.61034720078125e-06
Epoch: 8 cost time: 1.3832175731658936
Epoch: 8, Steps: 257 | Train Loss: 0.5149899 Vali Loss: 0.3494172 Best vali loss: 0.3455727

best validation loss 0.34557270055201295

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0101334717822, 'e_layers': 4, 'learning_rate': 0.0004697644461, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4650118
	speed: 0.0118s/iter; left time: 23.0666s
	iters: 200, epoch: 1 | loss: 0.7209402
	speed: 0.0055s/iter; left time: 10.1605s
Updating learning rate to 0.0004697644461
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 1.7711725234985352
Epoch: 1, Steps: 257 | Train Loss: 0.5929760 Vali Loss: 0.3685841 Best vali loss: 0.3685841
	iters: 100, epoch: 2 | loss: 0.2527246
	speed: 0.0111s/iter; left time: 18.8439s
	iters: 200, epoch: 2 | loss: 0.5090899
	speed: 0.0050s/iter; left time: 7.9379s
Updating learning rate to 0.00023488222305
Validation loss decreased (0.3686 --> 0.3622).  Saving model state dict ...
Epoch: 2 cost time: 1.349468469619751
Epoch: 2, Steps: 257 | Train Loss: 0.3809073 Vali Loss: 0.3622433 Best vali loss: 0.3622433
	iters: 100, epoch: 3 | loss: 0.8183179
	speed: 0.0114s/iter; left time: 16.4591s
	iters: 200, epoch: 3 | loss: 0.5639751
	speed: 0.0056s/iter; left time: 7.4652s
Updating learning rate to 0.000117441111525
Validation loss decreased (0.3622 --> 0.3545).  Saving model state dict ...
Epoch: 3 cost time: 1.4877195358276367
Epoch: 3, Steps: 257 | Train Loss: 0.6911465 Vali Loss: 0.3545145 Best vali loss: 0.3545145

best validation loss 0.3545144678801591

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020851248882, 'e_layers': 2, 'learning_rate': 0.0006958686209, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006958686209
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 0.8956561088562012
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3693372 Best vali loss: 0.3693372
Updating learning rate to 0.00034793431045
Validation loss decreased (0.3693 --> 0.3664).  Saving model state dict ...
Epoch: 2 cost time: 0.5882697105407715
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3664164 Best vali loss: 0.3664164
Updating learning rate to 0.000173967155225
Epoch: 3 cost time: 0.5804662704467773
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3718233 Best vali loss: 0.3664164

best validation loss 0.36641641596445634

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022281207615, 'e_layers': 4, 'learning_rate': 0.0007002823032, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007002823032
Validation loss decreased (inf --> 0.3942).  Saving model state dict ...
Epoch: 1 cost time: 1.3770349025726318
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3941658 Best vali loss: 0.3941658
Updating learning rate to 0.0003501411516
Validation loss decreased (0.3942 --> 0.3773).  Saving model state dict ...
Epoch: 2 cost time: 1.0549135208129883
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3773473 Best vali loss: 0.3773473
Updating learning rate to 0.0001750705758
Validation loss decreased (0.3773 --> 0.3728).  Saving model state dict ...
Epoch: 3 cost time: 1.0606799125671387
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3727731 Best vali loss: 0.3727731

best validation loss 0.3727730703260201

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0101334717822, 'e_layers': 4, 'learning_rate': 0.0004697644461, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4023798
	speed: 0.0119s/iter; left time: 14.0827s
	iters: 200, epoch: 4 | loss: 0.5945979
	speed: 0.0054s/iter; left time: 5.8818s
Updating learning rate to 5.87205557625e-05
Validation loss decreased (0.3545 --> 0.3504).  Saving model state dict ...
Epoch: 4 cost time: 1.7515263557434082
Epoch: 4, Steps: 257 | Train Loss: 0.4984889 Vali Loss: 0.3504472 Best vali loss: 0.3504472
	iters: 100, epoch: 5 | loss: 0.1980195
	speed: 0.0116s/iter; left time: 10.8146s
	iters: 200, epoch: 5 | loss: 0.4460918
	speed: 0.0056s/iter; left time: 4.6056s
Updating learning rate to 2.936027788125e-05
Validation loss decreased (0.3504 --> 0.3481).  Saving model state dict ...
Epoch: 5 cost time: 1.4808297157287598
Epoch: 5, Steps: 257 | Train Loss: 0.3220557 Vali Loss: 0.3481163 Best vali loss: 0.3481163
	iters: 100, epoch: 6 | loss: 0.7525972
	speed: 0.0112s/iter; left time: 7.5047s
	iters: 200, epoch: 6 | loss: 0.3709360
	speed: 0.0050s/iter; left time: 2.8794s
Updating learning rate to 1.4680138940625e-05
Validation loss decreased (0.3481 --> 0.3422).  Saving model state dict ...
Epoch: 6 cost time: 1.3438961505889893
Epoch: 6, Steps: 257 | Train Loss: 0.5617666 Vali Loss: 0.3421652 Best vali loss: 0.3421652
	iters: 100, epoch: 7 | loss: 0.4536010
	speed: 0.0107s/iter; left time: 4.4565s
	iters: 200, epoch: 7 | loss: 0.6031170
	speed: 0.0049s/iter; left time: 1.5450s
Updating learning rate to 7.3400694703125e-06
Epoch: 7 cost time: 1.3135344982147217
Epoch: 7, Steps: 257 | Train Loss: 0.5283590 Vali Loss: 0.3436215 Best vali loss: 0.3421652
	iters: 100, epoch: 8 | loss: 0.7898664
	speed: 0.0114s/iter; left time: 1.7989s
	iters: 200, epoch: 8 | loss: 0.5302786
	speed: 0.0051s/iter; left time: 0.2956s
Updating learning rate to 3.67003473515625e-06
Epoch: 8 cost time: 1.4087278842926025
Epoch: 8, Steps: 257 | Train Loss: 0.6600725 Vali Loss: 0.3425846 Best vali loss: 0.3421652

best validation loss 0.3421652094320136

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022309169544, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.3927).  Saving model state dict ...
Epoch: 1 cost time: 1.3982927799224854
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3927480 Best vali loss: 0.3927480
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3927 --> 0.3846).  Saving model state dict ...
Epoch: 2 cost time: 1.079329013824463
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3846223 Best vali loss: 0.3846223
Updating learning rate to 0.000176872471975
Validation loss decreased (0.3846 --> 0.3740).  Saving model state dict ...
Epoch: 3 cost time: 1.079028606414795
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3739505 Best vali loss: 0.3739505
Updating learning rate to 8.84362359875e-05
Epoch: 4 cost time: 1.0753214359283447
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3740096 Best vali loss: 0.3739505
Updating learning rate to 4.421811799375e-05
Epoch: 5 cost time: 1.0841870307922363
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3755534 Best vali loss: 0.3739505
Updating learning rate to 2.2109058996875e-05
Epoch: 6 cost time: 1.0846927165985107
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3765182 Best vali loss: 0.3739505
Updating learning rate to 1.10545294984375e-05
Epoch: 7 cost time: 1.0794458389282227
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3763969 Best vali loss: 0.3739505
Updating learning rate to 5.52726474921875e-06
Epoch: 8 cost time: 1.0565197467803955
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3782718 Best vali loss: 0.3739505

best validation loss 0.3739504627019811

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010928587467, 'e_layers': 2, 'learning_rate': 0.0003380946653, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9589401
	speed: 0.0098s/iter; left time: 79.8154s
	iters: 200, epoch: 1 | loss: 0.8631219
	speed: 0.0033s/iter; left time: 26.8103s
	iters: 300, epoch: 1 | loss: 1.1237504
	speed: 0.0034s/iter; left time: 26.8008s
	iters: 400, epoch: 1 | loss: 0.3639219
	speed: 0.0034s/iter; left time: 26.4646s
	iters: 500, epoch: 1 | loss: 0.8571787
	speed: 0.0034s/iter; left time: 26.1907s
	iters: 600, epoch: 1 | loss: 0.5940553
	speed: 0.0033s/iter; left time: 25.4175s
	iters: 700, epoch: 1 | loss: 2.2005920
	speed: 0.0035s/iter; left time: 26.0305s
	iters: 800, epoch: 1 | loss: 0.4468180
	speed: 0.0035s/iter; left time: 25.7524s
	iters: 900, epoch: 1 | loss: 1.6164660
	speed: 0.0035s/iter; left time: 25.4164s
	iters: 1000, epoch: 1 | loss: 1.2972933
	speed: 0.0035s/iter; left time: 25.3704s
Updating learning rate to 0.00032522670331096195
Validation loss decreased (inf --> 0.3802).  Saving model state dict ...
Epoch: 1 cost time: 3.875779628753662
Epoch: 1, Steps: 1027 | Train Loss: 1.0322138 Vali Loss: 0.3802365 Best vali loss: 0.3802365
	iters: 100, epoch: 2 | loss: 0.4613430
	speed: 0.0103s/iter; left time: 73.0324s
	iters: 200, epoch: 2 | loss: 0.4929210
	speed: 0.0034s/iter; left time: 23.6635s
	iters: 300, epoch: 2 | loss: 0.6198103
	speed: 0.0034s/iter; left time: 23.2704s
	iters: 400, epoch: 2 | loss: 0.5005494
	speed: 0.0034s/iter; left time: 22.9951s
	iters: 500, epoch: 2 | loss: 0.4211103
	speed: 0.0032s/iter; left time: 21.3355s
	iters: 600, epoch: 2 | loss: 0.7074482
	speed: 0.0034s/iter; left time: 22.2446s
	iters: 700, epoch: 2 | loss: 0.3055791
	speed: 0.0034s/iter; left time: 21.8342s
	iters: 800, epoch: 2 | loss: 0.3359104
	speed: 0.0034s/iter; left time: 21.8957s
	iters: 900, epoch: 2 | loss: 0.4667228
	speed: 0.0034s/iter; left time: 21.6088s
	iters: 1000, epoch: 2 | loss: 0.5111885
	speed: 0.0035s/iter; left time: 21.7108s
Updating learning rate to 0.00028858184790831305
Validation loss decreased (0.3802 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 3.523085832595825
Epoch: 2, Steps: 1027 | Train Loss: 0.4822583 Vali Loss: 0.3741244 Best vali loss: 0.3741244
	iters: 100, epoch: 3 | loss: 0.6861508
	speed: 0.0099s/iter; left time: 60.0572s
	iters: 200, epoch: 3 | loss: 0.1867733
	speed: 0.0031s/iter; left time: 18.2630s
	iters: 300, epoch: 3 | loss: 0.3475582
	speed: 0.0031s/iter; left time: 17.9986s
	iters: 400, epoch: 3 | loss: 0.3200347
	speed: 0.0031s/iter; left time: 17.7309s
	iters: 500, epoch: 3 | loss: 1.1888157
	speed: 0.0031s/iter; left time: 17.8135s
	iters: 600, epoch: 3 | loss: 0.6112286
	speed: 0.0031s/iter; left time: 17.3597s
	iters: 700, epoch: 3 | loss: 0.4318023
	speed: 0.0030s/iter; left time: 16.3666s
	iters: 800, epoch: 3 | loss: 1.6188186
	speed: 0.0033s/iter; left time: 17.6333s
	iters: 900, epoch: 3 | loss: 0.7136940
	speed: 0.0033s/iter; left time: 17.5623s
	iters: 1000, epoch: 3 | loss: 0.5936386
	speed: 0.0033s/iter; left time: 17.1903s
Updating learning rate to 0.0002337389461406651
Epoch: 3 cost time: 3.2751576900482178
Epoch: 3, Steps: 1027 | Train Loss: 0.6698515 Vali Loss: 0.3972935 Best vali loss: 0.3741244
	iters: 100, epoch: 4 | loss: 0.2428729
	speed: 0.0096s/iter; left time: 48.1061s
	iters: 200, epoch: 4 | loss: 0.3937591
	speed: 0.0037s/iter; left time: 18.1149s
	iters: 300, epoch: 4 | loss: 1.0343648
	speed: 0.0036s/iter; left time: 17.5391s
	iters: 400, epoch: 4 | loss: 0.3210321
	speed: 0.0035s/iter; left time: 16.7604s
	iters: 500, epoch: 4 | loss: 0.2778413
	speed: 0.0036s/iter; left time: 16.5816s
	iters: 600, epoch: 4 | loss: 0.5335103
	speed: 0.0035s/iter; left time: 15.7105s
	iters: 700, epoch: 4 | loss: 0.4789355
	speed: 0.0035s/iter; left time: 15.5259s
	iters: 800, epoch: 4 | loss: 1.4717821
	speed: 0.0036s/iter; left time: 15.6565s
	iters: 900, epoch: 4 | loss: 0.4166994
	speed: 0.0036s/iter; left time: 15.2049s
	iters: 1000, epoch: 4 | loss: 0.9579632
	speed: 0.0035s/iter; left time: 14.4320s
Updating learning rate to 0.00016904733265
Epoch: 4 cost time: 3.6800506114959717
Epoch: 4, Steps: 1027 | Train Loss: 0.6128761 Vali Loss: 0.3775577 Best vali loss: 0.3741244
	iters: 100, epoch: 5 | loss: 0.5859468
	speed: 0.0098s/iter; left time: 39.3717s
	iters: 200, epoch: 5 | loss: 0.2267721
	speed: 0.0036s/iter; left time: 14.1523s
	iters: 300, epoch: 5 | loss: 1.0651637
	speed: 0.0036s/iter; left time: 13.5297s
	iters: 400, epoch: 5 | loss: 0.6775502
	speed: 0.0036s/iter; left time: 13.1999s
	iters: 500, epoch: 5 | loss: 0.3622838
	speed: 0.0034s/iter; left time: 12.3616s
	iters: 600, epoch: 5 | loss: 0.3985539
	speed: 0.0035s/iter; left time: 12.1686s
	iters: 700, epoch: 5 | loss: 0.3212616
	speed: 0.0036s/iter; left time: 12.2642s
	iters: 800, epoch: 5 | loss: 0.4314158
	speed: 0.0034s/iter; left time: 11.3858s
	iters: 900, epoch: 5 | loss: 0.6261097
	speed: 0.0035s/iter; left time: 11.1891s
	iters: 1000, epoch: 5 | loss: 1.1664640
	speed: 0.0035s/iter; left time: 10.7326s
Updating learning rate to 0.00010435571915933489
Epoch: 5 cost time: 3.654193162918091
Epoch: 5, Steps: 1027 | Train Loss: 0.5861522 Vali Loss: 0.3815161 Best vali loss: 0.3741244
	iters: 100, epoch: 6 | loss: 1.4690886
	speed: 0.0091s/iter; left time: 27.1857s
	iters: 200, epoch: 6 | loss: 0.2442285
	speed: 0.0030s/iter; left time: 8.7691s
	iters: 300, epoch: 6 | loss: 0.4190701
	speed: 0.0031s/iter; left time: 8.7083s
	iters: 400, epoch: 6 | loss: 0.4229343
	speed: 0.0030s/iter; left time: 8.1422s
	iters: 500, epoch: 6 | loss: 1.3001927
	speed: 0.0030s/iter; left time: 7.8238s
	iters: 600, epoch: 6 | loss: 0.9991301
	speed: 0.0030s/iter; left time: 7.5059s
	iters: 700, epoch: 6 | loss: 0.2158954
	speed: 0.0029s/iter; left time: 6.9062s
	iters: 800, epoch: 6 | loss: 0.9876954
	speed: 0.0030s/iter; left time: 6.9203s
	iters: 900, epoch: 6 | loss: 0.7050284
	speed: 0.0031s/iter; left time: 6.7446s
	iters: 1000, epoch: 6 | loss: 0.4385262
	speed: 0.0031s/iter; left time: 6.4075s
Updating learning rate to 4.9512817391686945e-05
Epoch: 6 cost time: 3.1486637592315674
Epoch: 6, Steps: 1027 | Train Loss: 0.7201790 Vali Loss: 0.4104450 Best vali loss: 0.3741244
	iters: 100, epoch: 7 | loss: 0.3065232
	speed: 0.0094s/iter; left time: 18.4722s
	iters: 200, epoch: 7 | loss: 1.1203853
	speed: 0.0030s/iter; left time: 5.6068s
	iters: 300, epoch: 7 | loss: 0.5261907
	speed: 0.0030s/iter; left time: 5.2112s
	iters: 400, epoch: 7 | loss: 0.3390718
	speed: 0.0028s/iter; left time: 4.6794s
	iters: 500, epoch: 7 | loss: 0.4193202
	speed: 0.0028s/iter; left time: 4.4182s
	iters: 600, epoch: 7 | loss: 0.3320222
	speed: 0.0028s/iter; left time: 4.1459s
	iters: 700, epoch: 7 | loss: 1.0826433
	speed: 0.0028s/iter; left time: 3.8266s
	iters: 800, epoch: 7 | loss: 1.4608337
	speed: 0.0029s/iter; left time: 3.6211s
	iters: 900, epoch: 7 | loss: 0.7954002
	speed: 0.0029s/iter; left time: 3.3013s
	iters: 1000, epoch: 7 | loss: 1.0925015
	speed: 0.0029s/iter; left time: 3.0349s
Updating learning rate to 1.286796198903802e-05
Epoch: 7 cost time: 3.0213887691497803
Epoch: 7, Steps: 1027 | Train Loss: 0.7474892 Vali Loss: 0.3971319 Best vali loss: 0.3741244
	iters: 100, epoch: 8 | loss: 0.4624502
	speed: 0.0092s/iter; left time: 8.5593s
	iters: 200, epoch: 8 | loss: 0.3863731
	speed: 0.0031s/iter; left time: 2.5875s
	iters: 300, epoch: 8 | loss: 0.3684794
	speed: 0.0030s/iter; left time: 2.2154s
	iters: 400, epoch: 8 | loss: 0.8891917
	speed: 0.0029s/iter; left time: 1.7925s
	iters: 500, epoch: 8 | loss: 0.3869412
	speed: 0.0029s/iter; left time: 1.5051s
	iters: 600, epoch: 8 | loss: 0.5181380
	speed: 0.0028s/iter; left time: 1.2155s
	iters: 700, epoch: 8 | loss: 0.8736838
	speed: 0.0029s/iter; left time: 0.9361s
	iters: 800, epoch: 8 | loss: 0.4533826
	speed: 0.0031s/iter; left time: 0.7044s
	iters: 900, epoch: 8 | loss: 0.3375779
	speed: 0.0031s/iter; left time: 0.3993s
	iters: 1000, epoch: 8 | loss: 0.2888659
	speed: 0.0031s/iter; left time: 0.0874s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1257238388061523
Epoch: 8, Steps: 1027 | Train Loss: 0.4965084 Vali Loss: 0.4038360 Best vali loss: 0.3741244

best validation loss 0.3741244418447753

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.001068107936, 'e_layers': 4, 'learning_rate': 0.0003895954255, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8131325
	speed: 0.0112s/iter; left time: 21.8873s
	iters: 200, epoch: 1 | loss: 0.7384709
	speed: 0.0051s/iter; left time: 9.4452s
Updating learning rate to 0.0003895954255
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 1.6620798110961914
Epoch: 1, Steps: 257 | Train Loss: 0.7758017 Vali Loss: 0.3739161 Best vali loss: 0.3739161
	iters: 100, epoch: 2 | loss: 0.5872180
	speed: 0.0111s/iter; left time: 18.8386s
	iters: 200, epoch: 2 | loss: 0.8002817
	speed: 0.0051s/iter; left time: 8.2196s
Updating learning rate to 0.00019479771275
Validation loss decreased (0.3739 --> 0.3606).  Saving model state dict ...
Epoch: 2 cost time: 1.3681988716125488
Epoch: 2, Steps: 257 | Train Loss: 0.6937499 Vali Loss: 0.3605593 Best vali loss: 0.3605593
	iters: 100, epoch: 3 | loss: 0.4346843
	speed: 0.0112s/iter; left time: 16.1888s
	iters: 200, epoch: 3 | loss: 0.8347284
	speed: 0.0057s/iter; left time: 7.6401s
Updating learning rate to 9.7398856375e-05
Epoch: 3 cost time: 1.459625005722046
Epoch: 3, Steps: 257 | Train Loss: 0.6347063 Vali Loss: 0.3623698 Best vali loss: 0.3605593

best validation loss 0.36055925228506736

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010837842563, 'e_layers': 4, 'learning_rate': 0.0003066913166, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9347438
	speed: 0.0114s/iter; left time: 92.4544s
	iters: 200, epoch: 1 | loss: 0.2683575
	speed: 0.0051s/iter; left time: 40.7786s
	iters: 300, epoch: 1 | loss: 0.2847695
	speed: 0.0051s/iter; left time: 40.2455s
	iters: 400, epoch: 1 | loss: 0.3788772
	speed: 0.0051s/iter; left time: 39.9161s
	iters: 500, epoch: 1 | loss: 0.3840712
	speed: 0.0051s/iter; left time: 39.7415s
	iters: 600, epoch: 1 | loss: 0.3453045
	speed: 0.0052s/iter; left time: 39.4996s
	iters: 700, epoch: 1 | loss: 0.4521323
	speed: 0.0051s/iter; left time: 38.4413s
	iters: 800, epoch: 1 | loss: 0.3833936
	speed: 0.0052s/iter; left time: 38.5311s
	iters: 900, epoch: 1 | loss: 0.5276121
	speed: 0.0052s/iter; left time: 38.0131s
	iters: 1000, epoch: 1 | loss: 1.6247172
	speed: 0.0052s/iter; left time: 37.3141s
Updating learning rate to 0.0002950185734028395
Validation loss decreased (inf --> 0.3901).  Saving model state dict ...
Epoch: 1 cost time: 5.626652956008911
Epoch: 1, Steps: 1027 | Train Loss: 0.5583979 Vali Loss: 0.3901464 Best vali loss: 0.3901464
	iters: 100, epoch: 2 | loss: 0.9319699
	speed: 0.0128s/iter; left time: 90.7861s
	iters: 200, epoch: 2 | loss: 1.8322965
	speed: 0.0048s/iter; left time: 33.5903s
	iters: 300, epoch: 2 | loss: 0.2050852
	speed: 0.0049s/iter; left time: 33.4208s
	iters: 400, epoch: 2 | loss: 0.4069963
	speed: 0.0049s/iter; left time: 33.1938s
	iters: 500, epoch: 2 | loss: 0.3358178
	speed: 0.0047s/iter; left time: 31.6709s
	iters: 600, epoch: 2 | loss: 0.7773508
	speed: 0.0048s/iter; left time: 31.4249s
	iters: 700, epoch: 2 | loss: 0.6791248
	speed: 0.0050s/iter; left time: 32.6620s
	iters: 800, epoch: 2 | loss: 0.4308623
	speed: 0.0051s/iter; left time: 32.3962s
	iters: 900, epoch: 2 | loss: 1.3519851
	speed: 0.0050s/iter; left time: 31.2161s
	iters: 1000, epoch: 2 | loss: 0.3454112
	speed: 0.0048s/iter; left time: 29.9301s
Updating learning rate to 0.0002617774131494452
Validation loss decreased (0.3901 --> 0.3785).  Saving model state dict ...
Epoch: 2 cost time: 5.030099153518677
Epoch: 2, Steps: 1027 | Train Loss: 0.7296900 Vali Loss: 0.3785462 Best vali loss: 0.3785462
	iters: 100, epoch: 3 | loss: 0.5990781
	speed: 0.0134s/iter; left time: 81.5445s
	iters: 200, epoch: 3 | loss: 0.3910074
	speed: 0.0051s/iter; left time: 30.5526s
	iters: 300, epoch: 3 | loss: 0.2778340
	speed: 0.0052s/iter; left time: 30.4731s
	iters: 400, epoch: 3 | loss: 0.1461634
	speed: 0.0052s/iter; left time: 30.0390s
	iters: 500, epoch: 3 | loss: 0.3897101
	speed: 0.0053s/iter; left time: 30.0945s
	iters: 600, epoch: 3 | loss: 1.1668688
	speed: 0.0052s/iter; left time: 29.0541s
	iters: 700, epoch: 3 | loss: 0.3036817
	speed: 0.0052s/iter; left time: 28.4901s
	iters: 800, epoch: 3 | loss: 0.4623559
	speed: 0.0052s/iter; left time: 27.9381s
	iters: 900, epoch: 3 | loss: 0.8056228
	speed: 0.0051s/iter; left time: 27.0425s
	iters: 1000, epoch: 3 | loss: 1.1253718
	speed: 0.0051s/iter; left time: 26.0913s
Updating learning rate to 0.00021202850115652823
Validation loss decreased (0.3785 --> 0.3654).  Saving model state dict ...
Epoch: 3 cost time: 5.363783836364746
Epoch: 3, Steps: 1027 | Train Loss: 0.5667694 Vali Loss: 0.3654081 Best vali loss: 0.3654081

best validation loss 0.36540805895342576

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020827602735, 'e_layers': 2, 'learning_rate': 0.0008833209732, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008833209732
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 0.8017864227294922
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687614 Best vali loss: 0.3687614
Updating learning rate to 0.0004416604866
Epoch: 2 cost time: 0.4508795738220215
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3771751 Best vali loss: 0.3687614
Updating learning rate to 0.0002208302433
Epoch: 3 cost time: 0.46697354316711426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3771421 Best vali loss: 0.3687614

best validation loss 0.3687613836674419

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.001068107936, 'e_layers': 4, 'learning_rate': 0.0003895954255, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5780515
	speed: 0.0123s/iter; left time: 14.5587s
	iters: 200, epoch: 4 | loss: 0.5799323
	speed: 0.0056s/iter; left time: 6.1289s
Updating learning rate to 4.86994281875e-05
Validation loss decreased (0.3606 --> 0.3489).  Saving model state dict ...
Epoch: 4 cost time: 1.8120932579040527
Epoch: 4, Steps: 257 | Train Loss: 0.5789919 Vali Loss: 0.3489092 Best vali loss: 0.3489092
	iters: 100, epoch: 5 | loss: 0.4990527
	speed: 0.0111s/iter; left time: 10.3435s
	iters: 200, epoch: 5 | loss: 0.4927772
	speed: 0.0050s/iter; left time: 4.1083s
Updating learning rate to 2.434971409375e-05
Validation loss decreased (0.3489 --> 0.3467).  Saving model state dict ...
Epoch: 5 cost time: 1.3322532176971436
Epoch: 5, Steps: 257 | Train Loss: 0.4959150 Vali Loss: 0.3467344 Best vali loss: 0.3467344
	iters: 100, epoch: 6 | loss: 0.4075695
	speed: 0.0108s/iter; left time: 7.2695s
	iters: 200, epoch: 6 | loss: 0.7256372
	speed: 0.0049s/iter; left time: 2.8136s
Updating learning rate to 1.2174857046875e-05
Epoch: 6 cost time: 1.3330433368682861
Epoch: 6, Steps: 257 | Train Loss: 0.5666033 Vali Loss: 0.3532416 Best vali loss: 0.3467344
	iters: 100, epoch: 7 | loss: 0.3830424
	speed: 0.0107s/iter; left time: 4.4402s
	iters: 200, epoch: 7 | loss: 0.3464509
	speed: 0.0052s/iter; left time: 1.6342s
Updating learning rate to 6.0874285234375e-06
Epoch: 7 cost time: 1.3928782939910889
Epoch: 7, Steps: 257 | Train Loss: 0.3647466 Vali Loss: 0.3528269 Best vali loss: 0.3467344
	iters: 100, epoch: 8 | loss: 0.4327524
	speed: 0.0117s/iter; left time: 1.8452s
	iters: 200, epoch: 8 | loss: 0.4096824
	speed: 0.0057s/iter; left time: 0.3282s
Updating learning rate to 3.04371426171875e-06
Epoch: 8 cost time: 1.4991414546966553
Epoch: 8, Steps: 257 | Train Loss: 0.4212174 Vali Loss: 0.3515779 Best vali loss: 0.3467344

best validation loss 0.34673443476437116

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020858655551, 'e_layers': 2, 'learning_rate': 0.0008564892804, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0008564892804
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 0.762037992477417
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3677886 Best vali loss: 0.3677886
Updating learning rate to 0.0004282446402
Epoch: 2 cost time: 0.4621405601501465
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3739051 Best vali loss: 0.3677886
Updating learning rate to 0.0002141223201
Epoch: 3 cost time: 0.45479726791381836
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3704849 Best vali loss: 0.3677886
Updating learning rate to 0.00010706116005
Epoch: 4 cost time: 0.4565389156341553
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3845388 Best vali loss: 0.3677886
Updating learning rate to 5.3530580025e-05
Epoch: 5 cost time: 0.4563729763031006
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3889629 Best vali loss: 0.3677886
Updating learning rate to 2.67652900125e-05
Epoch: 6 cost time: 0.45830559730529785
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3884230 Best vali loss: 0.3677886
Updating learning rate to 1.338264500625e-05
Epoch: 7 cost time: 0.4550638198852539
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3915094 Best vali loss: 0.3677886
Updating learning rate to 6.691322503125e-06
Epoch: 8 cost time: 0.46009254455566406
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3893496 Best vali loss: 0.3677886

best validation loss 0.36778861853369094

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0037374826385, 'e_layers': 1, 'learning_rate': 0.0007537788029, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9748913
	speed: 0.0085s/iter; left time: 69.0285s
	iters: 200, epoch: 1 | loss: 0.3749494
	speed: 0.0024s/iter; left time: 19.0173s
	iters: 300, epoch: 1 | loss: 0.2140126
	speed: 0.0024s/iter; left time: 18.7327s
	iters: 400, epoch: 1 | loss: 0.7520760
	speed: 0.0024s/iter; left time: 18.5307s
	iters: 500, epoch: 1 | loss: 0.2289026
	speed: 0.0024s/iter; left time: 18.2028s
	iters: 600, epoch: 1 | loss: 0.4017768
	speed: 0.0024s/iter; left time: 18.3382s
	iters: 700, epoch: 1 | loss: 0.2392513
	speed: 0.0024s/iter; left time: 17.9446s
	iters: 800, epoch: 1 | loss: 0.9149851
	speed: 0.0024s/iter; left time: 17.6050s
	iters: 900, epoch: 1 | loss: 0.9954983
	speed: 0.0024s/iter; left time: 17.6547s
	iters: 1000, epoch: 1 | loss: 0.6310181
	speed: 0.0024s/iter; left time: 17.0337s
Updating learning rate to 0.0007537788029
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 2.795536518096924
Epoch: 1, Steps: 1027 | Train Loss: 0.5727361 Vali Loss: 0.3668223 Best vali loss: 0.3668223
	iters: 100, epoch: 2 | loss: 0.1618148
	speed: 0.0073s/iter; left time: 52.0809s
	iters: 200, epoch: 2 | loss: 0.5497952
	speed: 0.0022s/iter; left time: 15.1433s
	iters: 300, epoch: 2 | loss: 0.3657258
	speed: 0.0022s/iter; left time: 14.9653s
	iters: 400, epoch: 2 | loss: 0.4478619
	speed: 0.0022s/iter; left time: 14.8065s
	iters: 500, epoch: 2 | loss: 1.0232695
	speed: 0.0021s/iter; left time: 13.9454s
	iters: 600, epoch: 2 | loss: 1.3545928
	speed: 0.0021s/iter; left time: 13.7172s
	iters: 700, epoch: 2 | loss: 0.7586666
	speed: 0.0021s/iter; left time: 13.5496s
	iters: 800, epoch: 2 | loss: 0.5945212
	speed: 0.0021s/iter; left time: 13.3680s
	iters: 900, epoch: 2 | loss: 1.4334490
	speed: 0.0021s/iter; left time: 13.1867s
	iters: 1000, epoch: 2 | loss: 0.8290334
	speed: 0.0021s/iter; left time: 12.7128s
Updating learning rate to 0.00037688940145
Epoch: 2 cost time: 2.210801601409912
Epoch: 2, Steps: 1027 | Train Loss: 0.7518730 Vali Loss: 0.3799730 Best vali loss: 0.3668223
	iters: 100, epoch: 3 | loss: 0.3984054
	speed: 0.0073s/iter; left time: 44.3356s
	iters: 200, epoch: 3 | loss: 0.2818573
	speed: 0.0021s/iter; left time: 12.2909s
	iters: 300, epoch: 3 | loss: 1.2269920
	speed: 0.0020s/iter; left time: 12.0166s
	iters: 400, epoch: 3 | loss: 0.3808586
	speed: 0.0021s/iter; left time: 11.8976s
	iters: 500, epoch: 3 | loss: 0.2112313
	speed: 0.0021s/iter; left time: 11.8401s
	iters: 600, epoch: 3 | loss: 0.6501446
	speed: 0.0020s/iter; left time: 11.3615s
	iters: 700, epoch: 3 | loss: 0.9576773
	speed: 0.0021s/iter; left time: 11.3985s
	iters: 800, epoch: 3 | loss: 0.4165544
	speed: 0.0021s/iter; left time: 11.3714s
	iters: 900, epoch: 3 | loss: 1.1295332
	speed: 0.0022s/iter; left time: 11.6182s
	iters: 1000, epoch: 3 | loss: 0.2645843
	speed: 0.0021s/iter; left time: 10.9010s
Updating learning rate to 0.000188444700725
Epoch: 3 cost time: 2.1970462799072266
Epoch: 3, Steps: 1027 | Train Loss: 0.5917838 Vali Loss: 0.3729237 Best vali loss: 0.3668223
	iters: 100, epoch: 4 | loss: 0.3713820
	speed: 0.0077s/iter; left time: 38.9267s
	iters: 200, epoch: 4 | loss: 0.9215763
	speed: 0.0021s/iter; left time: 10.4244s
	iters: 300, epoch: 4 | loss: 0.3052545
	speed: 0.0021s/iter; left time: 10.1081s
	iters: 400, epoch: 4 | loss: 0.3676965
	speed: 0.0021s/iter; left time: 10.0237s
	iters: 500, epoch: 4 | loss: 0.2318907
	speed: 0.0021s/iter; left time: 9.7073s
	iters: 600, epoch: 4 | loss: 0.2914446
	speed: 0.0021s/iter; left time: 9.4855s
	iters: 700, epoch: 4 | loss: 0.1593431
	speed: 0.0021s/iter; left time: 9.3309s
	iters: 800, epoch: 4 | loss: 0.3346337
	speed: 0.0021s/iter; left time: 9.1188s
	iters: 900, epoch: 4 | loss: 0.5707507
	speed: 0.0021s/iter; left time: 8.9333s
	iters: 1000, epoch: 4 | loss: 0.1783545
	speed: 0.0021s/iter; left time: 8.6779s
Updating learning rate to 9.42223503625e-05
Epoch: 4 cost time: 2.202502727508545
Epoch: 4, Steps: 1027 | Train Loss: 0.3732326 Vali Loss: 0.3817565 Best vali loss: 0.3668223
	iters: 100, epoch: 5 | loss: 0.5219656
	speed: 0.0073s/iter; left time: 29.1884s
	iters: 200, epoch: 5 | loss: 1.0206020
	speed: 0.0021s/iter; left time: 8.3280s
	iters: 300, epoch: 5 | loss: 0.2823880
	speed: 0.0021s/iter; left time: 7.9774s
	iters: 400, epoch: 5 | loss: 0.4772762
	speed: 0.0021s/iter; left time: 7.9379s
	iters: 500, epoch: 5 | loss: 0.7598757
	speed: 0.0021s/iter; left time: 7.6409s
	iters: 600, epoch: 5 | loss: 0.4372143
	speed: 0.0021s/iter; left time: 7.4731s
	iters: 700, epoch: 5 | loss: 0.5320901
	speed: 0.0021s/iter; left time: 7.2032s
	iters: 800, epoch: 5 | loss: 2.1161153
	speed: 0.0021s/iter; left time: 6.9454s
	iters: 900, epoch: 5 | loss: 0.3592226
	speed: 0.0021s/iter; left time: 6.6929s
	iters: 1000, epoch: 5 | loss: 0.4171047
	speed: 0.0021s/iter; left time: 6.4752s
Updating learning rate to 4.711117518125e-05
Epoch: 5 cost time: 2.2101123332977295
Epoch: 5, Steps: 1027 | Train Loss: 0.6923855 Vali Loss: 0.3811057 Best vali loss: 0.3668223
	iters: 100, epoch: 6 | loss: 0.7508979
	speed: 0.0073s/iter; left time: 21.7653s
	iters: 200, epoch: 6 | loss: 0.6378452
	speed: 0.0021s/iter; left time: 6.0279s
	iters: 300, epoch: 6 | loss: 1.0759829
	speed: 0.0021s/iter; left time: 5.9677s
	iters: 400, epoch: 6 | loss: 0.3104455
	speed: 0.0021s/iter; left time: 5.6732s
	iters: 500, epoch: 6 | loss: 0.3229172
	speed: 0.0021s/iter; left time: 5.4552s
	iters: 600, epoch: 6 | loss: 2.0775409
	speed: 0.0021s/iter; left time: 5.1884s
	iters: 700, epoch: 6 | loss: 0.2784966
	speed: 0.0021s/iter; left time: 5.0634s
	iters: 800, epoch: 6 | loss: 0.6661274
	speed: 0.0021s/iter; left time: 4.7881s
	iters: 900, epoch: 6 | loss: 0.2564951
	speed: 0.0021s/iter; left time: 4.6103s
	iters: 1000, epoch: 6 | loss: 0.4102096
	speed: 0.0021s/iter; left time: 4.4520s
Updating learning rate to 2.3555587590625e-05
Epoch: 6 cost time: 2.2250618934631348
Epoch: 6, Steps: 1027 | Train Loss: 0.6786958 Vali Loss: 0.3801425 Best vali loss: 0.3668223
	iters: 100, epoch: 7 | loss: 0.3798178
	speed: 0.0076s/iter; left time: 14.9502s
	iters: 200, epoch: 7 | loss: 0.5633035
	speed: 0.0023s/iter; left time: 4.3261s
	iters: 300, epoch: 7 | loss: 0.5126585
	speed: 0.0024s/iter; left time: 4.1256s
	iters: 400, epoch: 7 | loss: 0.8637049
	speed: 0.0024s/iter; left time: 3.9219s
	iters: 500, epoch: 7 | loss: 0.9401817
	speed: 0.0022s/iter; left time: 3.4871s
	iters: 600, epoch: 7 | loss: 0.4303958
	speed: 0.0024s/iter; left time: 3.4396s
	iters: 700, epoch: 7 | loss: 0.3094719
	speed: 0.0023s/iter; left time: 3.1788s
	iters: 800, epoch: 7 | loss: 0.5926735
	speed: 0.0024s/iter; left time: 3.0207s
	iters: 900, epoch: 7 | loss: 0.3661322
	speed: 0.0024s/iter; left time: 2.7330s
	iters: 1000, epoch: 7 | loss: 0.8658853
	speed: 0.0023s/iter; left time: 2.4234s
Updating learning rate to 1.17777937953125e-05
Epoch: 7 cost time: 2.4505112171173096
Epoch: 7, Steps: 1027 | Train Loss: 0.5824225 Vali Loss: 0.3821112 Best vali loss: 0.3668223
	iters: 100, epoch: 8 | loss: 0.3678748
	speed: 0.0078s/iter; left time: 7.2100s
	iters: 200, epoch: 8 | loss: 0.3244775
	speed: 0.0023s/iter; left time: 1.9156s
	iters: 300, epoch: 8 | loss: 0.2836432
	speed: 0.0023s/iter; left time: 1.6459s
	iters: 400, epoch: 8 | loss: 0.1958514
	speed: 0.0023s/iter; left time: 1.4382s
	iters: 500, epoch: 8 | loss: 0.3320106
	speed: 0.0023s/iter; left time: 1.2182s
	iters: 600, epoch: 8 | loss: 0.4994983
	speed: 0.0024s/iter; left time: 1.0244s
	iters: 700, epoch: 8 | loss: 0.9373551
	speed: 0.0024s/iter; left time: 0.7772s
	iters: 800, epoch: 8 | loss: 0.2725021
	speed: 0.0024s/iter; left time: 0.5449s
	iters: 900, epoch: 8 | loss: 0.7926452
	speed: 0.0024s/iter; left time: 0.3072s
	iters: 1000, epoch: 8 | loss: 0.5574881
	speed: 0.0025s/iter; left time: 0.0687s
Updating learning rate to 5.88889689765625e-06
Epoch: 8 cost time: 2.4825215339660645
Epoch: 8, Steps: 1027 | Train Loss: 0.4563346 Vali Loss: 0.3818585 Best vali loss: 0.3668223

best validation loss 0.36682225372093363

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0074388401249, 'e_layers': 4, 'learning_rate': 0.0003895070185, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3311499
	speed: 0.0128s/iter; left time: 24.9584s
	iters: 200, epoch: 1 | loss: 0.8091619
	speed: 0.0064s/iter; left time: 11.9476s
Updating learning rate to 0.0003895070185
Validation loss decreased (inf --> 0.3836).  Saving model state dict ...
Epoch: 1 cost time: 2.0258750915527344
Epoch: 1, Steps: 257 | Train Loss: 0.5701559 Vali Loss: 0.3836069 Best vali loss: 0.3836069
	iters: 100, epoch: 2 | loss: 0.8380206
	speed: 0.0137s/iter; left time: 23.2550s
	iters: 200, epoch: 2 | loss: 0.9024093
	speed: 0.0065s/iter; left time: 10.3277s
Updating learning rate to 0.00019475350925
Validation loss decreased (0.3836 --> 0.3807).  Saving model state dict ...
Epoch: 2 cost time: 1.7069592475891113
Epoch: 2, Steps: 257 | Train Loss: 0.8702149 Vali Loss: 0.3807280 Best vali loss: 0.3807280
	iters: 100, epoch: 3 | loss: 0.5320231
	speed: 0.0139s/iter; left time: 20.0812s
	iters: 200, epoch: 3 | loss: 0.9007053
	speed: 0.0065s/iter; left time: 8.7413s
Updating learning rate to 9.7376754625e-05
Validation loss decreased (0.3807 --> 0.3733).  Saving model state dict ...
Epoch: 3 cost time: 1.7166733741760254
Epoch: 3, Steps: 257 | Train Loss: 0.7163642 Vali Loss: 0.3733336 Best vali loss: 0.3733336

best validation loss 0.37333357775609477

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0057972489727, 'e_layers': 4, 'learning_rate': 0.000388014157, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3297758
	speed: 0.0130s/iter; left time: 25.3856s
	iters: 200, epoch: 1 | loss: 0.8051081
	speed: 0.0066s/iter; left time: 12.2207s
Updating learning rate to 0.000388014157
Validation loss decreased (inf --> 0.3793).  Saving model state dict ...
Epoch: 1 cost time: 2.062113046646118
Epoch: 1, Steps: 257 | Train Loss: 0.5674419 Vali Loss: 0.3792828 Best vali loss: 0.3792828
	iters: 100, epoch: 2 | loss: 0.8604721
	speed: 0.0139s/iter; left time: 23.6822s
	iters: 200, epoch: 2 | loss: 0.9403033
	speed: 0.0065s/iter; left time: 10.4580s
Updating learning rate to 0.0001940070785
Validation loss decreased (0.3793 --> 0.3672).  Saving model state dict ...
Epoch: 2 cost time: 1.7328081130981445
Epoch: 2, Steps: 257 | Train Loss: 0.9003877 Vali Loss: 0.3671789 Best vali loss: 0.3671789
	iters: 100, epoch: 3 | loss: 0.3521922
	speed: 0.0140s/iter; left time: 20.2377s
	iters: 200, epoch: 3 | loss: 0.7656671
	speed: 0.0063s/iter; left time: 8.4713s
Updating learning rate to 9.700353925e-05
Validation loss decreased (0.3672 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 1.6779098510742188
Epoch: 3, Steps: 257 | Train Loss: 0.5589296 Vali Loss: 0.3638579 Best vali loss: 0.3638579

best validation loss 0.3638578607548899

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0087966741034, 'e_layers': 4, 'learning_rate': 0.0003880668801, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3286700
	speed: 0.0128s/iter; left time: 25.0091s
	iters: 200, epoch: 1 | loss: 0.8094456
	speed: 0.0064s/iter; left time: 11.9535s
Updating learning rate to 0.0003880668801
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 2.014882802963257
Epoch: 1, Steps: 257 | Train Loss: 0.5690578 Vali Loss: 0.3748589 Best vali loss: 0.3748589
	iters: 100, epoch: 2 | loss: 0.8496522
	speed: 0.0138s/iter; left time: 23.5069s
	iters: 200, epoch: 2 | loss: 0.9132078
	speed: 0.0065s/iter; left time: 10.3811s
Updating learning rate to 0.00019403344005
Epoch: 2 cost time: 1.7099759578704834
Epoch: 2, Steps: 257 | Train Loss: 0.8814300 Vali Loss: 0.3801228 Best vali loss: 0.3748589
	iters: 100, epoch: 3 | loss: 0.4028838
	speed: 0.0139s/iter; left time: 20.0051s
	iters: 200, epoch: 3 | loss: 0.9892699
	speed: 0.0066s/iter; left time: 8.9142s
Updating learning rate to 9.7016720025e-05
Validation loss decreased (0.3749 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 1.7564020156860352
Epoch: 3, Steps: 257 | Train Loss: 0.6960768 Vali Loss: 0.3644221 Best vali loss: 0.3644221

best validation loss 0.3644220619164188

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0057972489727, 'e_layers': 4, 'learning_rate': 0.000388014157, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2947704
	speed: 0.0136s/iter; left time: 16.1841s
	iters: 200, epoch: 4 | loss: 0.6933073
	speed: 0.0067s/iter; left time: 7.2924s
Updating learning rate to 4.8501769625e-05
Validation loss decreased (0.3639 --> 0.3505).  Saving model state dict ...
Epoch: 4 cost time: 2.0940628051757812
Epoch: 4, Steps: 257 | Train Loss: 0.4940388 Vali Loss: 0.3504695 Best vali loss: 0.3504695
	iters: 100, epoch: 5 | loss: 0.6307470
	speed: 0.0143s/iter; left time: 13.2498s
	iters: 200, epoch: 5 | loss: 0.6728866
	speed: 0.0066s/iter; left time: 5.4324s
Updating learning rate to 2.42508848125e-05
Epoch: 5 cost time: 1.735588550567627
Epoch: 5, Steps: 257 | Train Loss: 0.6518168 Vali Loss: 0.3508023 Best vali loss: 0.3504695
	iters: 100, epoch: 6 | loss: 0.3099754
	speed: 0.0131s/iter; left time: 8.8192s
	iters: 200, epoch: 6 | loss: 0.6207622
	speed: 0.0062s/iter; left time: 3.5337s
Updating learning rate to 1.212544240625e-05
Validation loss decreased (0.3505 --> 0.3441).  Saving model state dict ...
Epoch: 6 cost time: 1.632997751235962
Epoch: 6, Steps: 257 | Train Loss: 0.4653688 Vali Loss: 0.3440719 Best vali loss: 0.3440719
	iters: 100, epoch: 7 | loss: 0.4389360
	speed: 0.0135s/iter; left time: 5.6101s
	iters: 200, epoch: 7 | loss: 0.4315335
	speed: 0.0065s/iter; left time: 2.0498s
Updating learning rate to 6.062721203125e-06
Epoch: 7 cost time: 1.7131614685058594
Epoch: 7, Steps: 257 | Train Loss: 0.4352348 Vali Loss: 0.3484633 Best vali loss: 0.3440719
	iters: 100, epoch: 8 | loss: 0.4843197
	speed: 0.0136s/iter; left time: 2.1439s
	iters: 200, epoch: 8 | loss: 0.4755099
	speed: 0.0065s/iter; left time: 0.3749s
Updating learning rate to 3.0313606015625e-06
Epoch: 8 cost time: 1.6854934692382812
Epoch: 8, Steps: 257 | Train Loss: 0.4799148 Vali Loss: 0.3502952 Best vali loss: 0.3440719

best validation loss 0.3440718563343078

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023602630564, 'e_layers': 4, 'learning_rate': 0.0003916590914, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3334562
	speed: 0.0126s/iter; left time: 24.6393s
	iters: 200, epoch: 1 | loss: 0.8062909
	speed: 0.0063s/iter; left time: 11.6641s
Updating learning rate to 0.0003916590914
Validation loss decreased (inf --> 0.3807).  Saving model state dict ...
Epoch: 1 cost time: 1.9626879692077637
Epoch: 1, Steps: 257 | Train Loss: 0.5698735 Vali Loss: 0.3806874 Best vali loss: 0.3806874
	iters: 100, epoch: 2 | loss: 0.8421693
	speed: 0.0132s/iter; left time: 22.4890s
	iters: 200, epoch: 2 | loss: 0.8957852
	speed: 0.0063s/iter; left time: 10.1450s
Updating learning rate to 0.0001958295457
Epoch: 2 cost time: 1.6699655055999756
Epoch: 2, Steps: 257 | Train Loss: 0.8689772 Vali Loss: 0.3814766 Best vali loss: 0.3806874
	iters: 100, epoch: 3 | loss: 0.5427235
	speed: 0.0133s/iter; left time: 19.1461s
	iters: 200, epoch: 3 | loss: 0.8755793
	speed: 0.0062s/iter; left time: 8.3245s
Updating learning rate to 9.791477285e-05
Validation loss decreased (0.3807 --> 0.3611).  Saving model state dict ...
Epoch: 3 cost time: 1.6591160297393799
Epoch: 3, Steps: 257 | Train Loss: 0.7091514 Vali Loss: 0.3611136 Best vali loss: 0.3611136
	iters: 100, epoch: 4 | loss: 0.5540298
	speed: 0.0141s/iter; left time: 16.7182s
	iters: 200, epoch: 4 | loss: 0.5384884
	speed: 0.0063s/iter; left time: 6.8657s
Updating learning rate to 4.8957386425e-05
Validation loss decreased (0.3611 --> 0.3497).  Saving model state dict ...
Epoch: 4 cost time: 1.6902315616607666
Epoch: 4, Steps: 257 | Train Loss: 0.5462591 Vali Loss: 0.3496729 Best vali loss: 0.3496729
	iters: 100, epoch: 5 | loss: 0.5485185
	speed: 0.0138s/iter; left time: 12.7837s
	iters: 200, epoch: 5 | loss: 0.5603443
	speed: 0.0064s/iter; left time: 5.3042s
Updating learning rate to 2.44786932125e-05
Validation loss decreased (0.3497 --> 0.3433).  Saving model state dict ...
Epoch: 5 cost time: 1.698575735092163
Epoch: 5, Steps: 257 | Train Loss: 0.5544314 Vali Loss: 0.3432591 Best vali loss: 0.3432591
	iters: 100, epoch: 6 | loss: 0.5326229
	speed: 0.0139s/iter; left time: 9.3197s
	iters: 200, epoch: 6 | loss: 0.3462700
	speed: 0.0063s/iter; left time: 3.6317s
Updating learning rate to 1.223934660625e-05
Epoch: 6 cost time: 1.692918062210083
Epoch: 6, Steps: 257 | Train Loss: 0.4394464 Vali Loss: 0.3489811 Best vali loss: 0.3432591
	iters: 100, epoch: 7 | loss: 0.3911692
	speed: 0.0135s/iter; left time: 5.5830s
	iters: 200, epoch: 7 | loss: 0.3081595
	speed: 0.0064s/iter; left time: 2.0100s
Updating learning rate to 6.119673303125e-06
Epoch: 7 cost time: 1.6841833591461182
Epoch: 7, Steps: 257 | Train Loss: 0.3496643 Vali Loss: 0.3458461 Best vali loss: 0.3432591
	iters: 100, epoch: 8 | loss: 0.4642209
	speed: 0.0134s/iter; left time: 2.1174s
	iters: 200, epoch: 8 | loss: 0.5847387
	speed: 0.0065s/iter; left time: 0.3748s
Updating learning rate to 3.0598366515625e-06
Epoch: 8 cost time: 1.7022051811218262
Epoch: 8, Steps: 257 | Train Loss: 0.5244798 Vali Loss: 0.3460877 Best vali loss: 0.3432591

best validation loss 0.34325906499664066

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0032567526475, 'e_layers': 4, 'learning_rate': 0.000576829478, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4886987
	speed: 0.0114s/iter; left time: 22.3519s
	iters: 200, epoch: 1 | loss: 0.5821236
	speed: 0.0050s/iter; left time: 9.3131s
Updating learning rate to 0.000576829478
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 1.6559762954711914
Epoch: 1, Steps: 257 | Train Loss: 0.5354112 Vali Loss: 0.3681966 Best vali loss: 0.3681966
	iters: 100, epoch: 2 | loss: 0.4904382
	speed: 0.0110s/iter; left time: 18.7381s
	iters: 200, epoch: 2 | loss: 0.5870178
	speed: 0.0054s/iter; left time: 8.7015s
Updating learning rate to 0.000288414739
Epoch: 2 cost time: 1.4398233890533447
Epoch: 2, Steps: 257 | Train Loss: 0.5387280 Vali Loss: 0.3814734 Best vali loss: 0.3681966
	iters: 100, epoch: 3 | loss: 0.5257735
	speed: 0.0112s/iter; left time: 16.1295s
	iters: 200, epoch: 3 | loss: 0.3289312
	speed: 0.0054s/iter; left time: 7.2170s
Updating learning rate to 0.0001442073695
Epoch: 3 cost time: 1.4237823486328125
Epoch: 3, Steps: 257 | Train Loss: 0.4273523 Vali Loss: 0.3851540 Best vali loss: 0.3681966
	iters: 100, epoch: 4 | loss: 0.3063396
	speed: 0.0112s/iter; left time: 13.3367s
	iters: 200, epoch: 4 | loss: 0.6067699
	speed: 0.0052s/iter; left time: 5.6048s
Updating learning rate to 7.210368475e-05
Validation loss decreased (0.3682 --> 0.3621).  Saving model state dict ...
Epoch: 4 cost time: 1.3910508155822754
Epoch: 4, Steps: 257 | Train Loss: 0.4565547 Vali Loss: 0.3621460 Best vali loss: 0.3621460
	iters: 100, epoch: 5 | loss: 0.8609451
	speed: 0.0107s/iter; left time: 9.9530s
	iters: 200, epoch: 5 | loss: 0.5158493
	speed: 0.0051s/iter; left time: 4.2551s
Updating learning rate to 3.6051842375e-05
Validation loss decreased (0.3621 --> 0.3604).  Saving model state dict ...
Epoch: 5 cost time: 1.3647029399871826
Epoch: 5, Steps: 257 | Train Loss: 0.6883972 Vali Loss: 0.3604167 Best vali loss: 0.3604167
	iters: 100, epoch: 6 | loss: 0.3945506
	speed: 0.0110s/iter; left time: 7.4245s
	iters: 200, epoch: 6 | loss: 0.4650714
	speed: 0.0052s/iter; left time: 2.9939s
Updating learning rate to 1.80259211875e-05
Validation loss decreased (0.3604 --> 0.3597).  Saving model state dict ...
Epoch: 6 cost time: 1.3886163234710693
Epoch: 6, Steps: 257 | Train Loss: 0.4298110 Vali Loss: 0.3597302 Best vali loss: 0.3597302
	iters: 100, epoch: 7 | loss: 0.4716156
	speed: 0.0109s/iter; left time: 4.5161s
	iters: 200, epoch: 7 | loss: 0.4840213
	speed: 0.0052s/iter; left time: 1.6380s
Updating learning rate to 9.01296059375e-06
Validation loss decreased (0.3597 --> 0.3567).  Saving model state dict ...
Epoch: 7 cost time: 1.3746120929718018
Epoch: 7, Steps: 257 | Train Loss: 0.4778185 Vali Loss: 0.3566586 Best vali loss: 0.3566586
	iters: 100, epoch: 8 | loss: 0.6740333
	speed: 0.0111s/iter; left time: 1.7509s
	iters: 200, epoch: 8 | loss: 0.5483364
	speed: 0.0054s/iter; left time: 0.3106s
Updating learning rate to 4.506480296875e-06
Validation loss decreased (0.3567 --> 0.3566).  Saving model state dict ...
Epoch: 8 cost time: 1.4352688789367676
Epoch: 8, Steps: 257 | Train Loss: 0.6111849 Vali Loss: 0.3566173 Best vali loss: 0.3566173

best validation loss 0.3566173150052256

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0013821064925, 'e_layers': 4, 'learning_rate': 0.0003934218831, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3266178
	speed: 0.0128s/iter; left time: 25.0376s
	iters: 200, epoch: 1 | loss: 0.8014593
	speed: 0.0066s/iter; left time: 12.2058s
Updating learning rate to 0.0003934218831
Validation loss decreased (inf --> 0.3812).  Saving model state dict ...
Epoch: 1 cost time: 2.0202949047088623
Epoch: 1, Steps: 257 | Train Loss: 0.5640386 Vali Loss: 0.3811503 Best vali loss: 0.3811503
	iters: 100, epoch: 2 | loss: 0.8740407
	speed: 0.0133s/iter; left time: 22.6527s
	iters: 200, epoch: 2 | loss: 0.9386320
	speed: 0.0064s/iter; left time: 10.1674s
Updating learning rate to 0.00019671094155
Epoch: 2 cost time: 1.6574680805206299
Epoch: 2, Steps: 257 | Train Loss: 0.9063363 Vali Loss: 0.3850790 Best vali loss: 0.3811503
	iters: 100, epoch: 3 | loss: 0.6070437
	speed: 0.0131s/iter; left time: 18.8852s
	iters: 200, epoch: 3 | loss: 0.9977693
	speed: 0.0063s/iter; left time: 8.4405s
Updating learning rate to 9.8355470775e-05
Validation loss decreased (0.3812 --> 0.3793).  Saving model state dict ...
Epoch: 3 cost time: 1.6641743183135986
Epoch: 3, Steps: 257 | Train Loss: 0.8024065 Vali Loss: 0.3792896 Best vali loss: 0.3792896

best validation loss 0.3792896473454586

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025408384939, 'e_layers': 4, 'learning_rate': 0.0003914241971, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3310104
	speed: 0.0128s/iter; left time: 25.0379s
	iters: 200, epoch: 1 | loss: 0.8091751
	speed: 0.0063s/iter; left time: 11.7764s
Updating learning rate to 0.0003914241971
Validation loss decreased (inf --> 0.3766).  Saving model state dict ...
Epoch: 1 cost time: 2.005106210708618
Epoch: 1, Steps: 257 | Train Loss: 0.5700928 Vali Loss: 0.3765938 Best vali loss: 0.3765938
	iters: 100, epoch: 2 | loss: 0.8215783
	speed: 0.0137s/iter; left time: 23.2276s
	iters: 200, epoch: 2 | loss: 0.9772412
	speed: 0.0067s/iter; left time: 10.6849s
Updating learning rate to 0.00019571209855
Epoch: 2 cost time: 1.757340669631958
Epoch: 2, Steps: 257 | Train Loss: 0.8994097 Vali Loss: 0.3891275 Best vali loss: 0.3765938
	iters: 100, epoch: 3 | loss: 0.6208994
	speed: 0.0139s/iter; left time: 19.9916s
	iters: 200, epoch: 3 | loss: 0.8680992
	speed: 0.0068s/iter; left time: 9.1150s
Updating learning rate to 9.7856049275e-05
Validation loss decreased (0.3766 --> 0.3696).  Saving model state dict ...
Epoch: 3 cost time: 1.7621057033538818
Epoch: 3, Steps: 257 | Train Loss: 0.7444993 Vali Loss: 0.3695587 Best vali loss: 0.3695587

best validation loss 0.36955867483480037

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0086689940738, 'e_layers': 1, 'learning_rate': 0.0002932756838, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6471920
	speed: 0.0094s/iter; left time: 8.8014s
Updating learning rate to 0.0002932756838
Validation loss decreased (inf --> 0.3830).  Saving model state dict ...
Epoch: 1 cost time: 0.7524492740631104
Epoch: 1, Steps: 129 | Train Loss: 0.6471920 Vali Loss: 0.3830338 Best vali loss: 0.3830338
	iters: 100, epoch: 2 | loss: 0.7819903
	speed: 0.0057s/iter; left time: 4.6186s
Updating learning rate to 0.0001466378419
Validation loss decreased (0.3830 --> 0.3669).  Saving model state dict ...
Epoch: 2 cost time: 0.4309816360473633
Epoch: 2, Steps: 129 | Train Loss: 0.7819903 Vali Loss: 0.3669208 Best vali loss: 0.3669208
	iters: 100, epoch: 3 | loss: 0.7824125
	speed: 0.0056s/iter; left time: 3.7492s
Updating learning rate to 7.331892095e-05
Validation loss decreased (0.3669 --> 0.3648).  Saving model state dict ...
Epoch: 3 cost time: 0.42553067207336426
Epoch: 3, Steps: 129 | Train Loss: 0.7824125 Vali Loss: 0.3648025 Best vali loss: 0.3648025

best validation loss 0.3648025014896992

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0086689940738, 'e_layers': 1, 'learning_rate': 0.0002932756838, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5833739
	speed: 0.0099s/iter; left time: 5.4089s
Updating learning rate to 3.6659460475e-05
Epoch: 4 cost time: 0.7825720310211182
Epoch: 4, Steps: 129 | Train Loss: 0.5833739 Vali Loss: 0.3655259 Best vali loss: 0.3648025
	iters: 100, epoch: 5 | loss: 0.7530687
	speed: 0.0061s/iter; left time: 2.5522s
Updating learning rate to 1.83297302375e-05
Validation loss decreased (0.3648 --> 0.3648).  Saving model state dict ...
Epoch: 5 cost time: 0.4625105857849121
Epoch: 5, Steps: 129 | Train Loss: 0.7530687 Vali Loss: 0.3647890 Best vali loss: 0.3647890
	iters: 100, epoch: 6 | loss: 0.7768530
	speed: 0.0063s/iter; left time: 1.8233s
Updating learning rate to 9.16486511875e-06
Validation loss decreased (0.3648 --> 0.3646).  Saving model state dict ...
Epoch: 6 cost time: 0.47664308547973633
Epoch: 6, Steps: 129 | Train Loss: 0.7768530 Vali Loss: 0.3645789 Best vali loss: 0.3645789
	iters: 100, epoch: 7 | loss: 0.6895707
	speed: 0.0058s/iter; left time: 0.9250s
Updating learning rate to 4.582432559375e-06
Validation loss decreased (0.3646 --> 0.3645).  Saving model state dict ...
Epoch: 7 cost time: 0.4344627857208252
Epoch: 7, Steps: 129 | Train Loss: 0.6895707 Vali Loss: 0.3645291 Best vali loss: 0.3645291
	iters: 100, epoch: 8 | loss: 0.6727117
	speed: 0.0059s/iter; left time: 0.1769s
Updating learning rate to 2.2912162796875e-06
Validation loss decreased (0.3645 --> 0.3645).  Saving model state dict ...
Epoch: 8 cost time: 0.449171781539917
Epoch: 8, Steps: 129 | Train Loss: 0.6727117 Vali Loss: 0.3645271 Best vali loss: 0.3645271

best validation loss 0.3645271324221418

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0039297343123, 'e_layers': 1, 'learning_rate': 0.0007594837245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3397477
	speed: 0.0085s/iter; left time: 68.7234s
	iters: 200, epoch: 1 | loss: 1.1153810
	speed: 0.0022s/iter; left time: 17.3866s
	iters: 300, epoch: 1 | loss: 1.1613022
	speed: 0.0022s/iter; left time: 17.1173s
	iters: 400, epoch: 1 | loss: 0.2363147
	speed: 0.0022s/iter; left time: 17.0882s
	iters: 500, epoch: 1 | loss: 0.4819553
	speed: 0.0021s/iter; left time: 16.0448s
	iters: 600, epoch: 1 | loss: 0.1816155
	speed: 0.0021s/iter; left time: 15.9135s
	iters: 700, epoch: 1 | loss: 0.2457913
	speed: 0.0021s/iter; left time: 15.6426s
	iters: 800, epoch: 1 | loss: 0.8877233
	speed: 0.0021s/iter; left time: 15.5131s
	iters: 900, epoch: 1 | loss: 0.2143293
	speed: 0.0021s/iter; left time: 15.5701s
	iters: 1000, epoch: 1 | loss: 0.3537146
	speed: 0.0024s/iter; left time: 17.1066s
Updating learning rate to 0.0007305775964204954
Validation loss decreased (inf --> 0.3784).  Saving model state dict ...
Epoch: 1 cost time: 2.5649330615997314
Epoch: 1, Steps: 1027 | Train Loss: 0.5217875 Vali Loss: 0.3783743 Best vali loss: 0.3783743
	iters: 100, epoch: 2 | loss: 0.5103981
	speed: 0.0077s/iter; left time: 54.3468s
	iters: 200, epoch: 2 | loss: 0.6369401
	speed: 0.0024s/iter; left time: 16.8694s
	iters: 300, epoch: 2 | loss: 0.3127809
	speed: 0.0024s/iter; left time: 16.3672s
	iters: 400, epoch: 2 | loss: 0.1909946
	speed: 0.0022s/iter; left time: 15.1231s
	iters: 500, epoch: 2 | loss: 0.8808822
	speed: 0.0023s/iter; left time: 15.3220s
	iters: 600, epoch: 2 | loss: 0.3409854
	speed: 0.0023s/iter; left time: 14.9707s
	iters: 700, epoch: 2 | loss: 1.3777661
	speed: 0.0022s/iter; left time: 14.1967s
	iters: 800, epoch: 2 | loss: 0.9509262
	speed: 0.0022s/iter; left time: 14.0017s
	iters: 900, epoch: 2 | loss: 0.4823678
	speed: 0.0022s/iter; left time: 14.0968s
	iters: 1000, epoch: 2 | loss: 0.5840251
	speed: 0.0022s/iter; left time: 13.8486s
Updating learning rate to 0.0006482599081473828
Epoch: 2 cost time: 2.3904268741607666
Epoch: 2, Steps: 1027 | Train Loss: 0.6268067 Vali Loss: 0.3793634 Best vali loss: 0.3783743
	iters: 100, epoch: 3 | loss: 1.0748720
	speed: 0.0077s/iter; left time: 46.6634s
	iters: 200, epoch: 3 | loss: 0.3156530
	speed: 0.0022s/iter; left time: 13.0574s
	iters: 300, epoch: 3 | loss: 0.5468508
	speed: 0.0021s/iter; left time: 12.5757s
	iters: 400, epoch: 3 | loss: 1.0341170
	speed: 0.0022s/iter; left time: 12.6508s
	iters: 500, epoch: 3 | loss: 2.2310369
	speed: 0.0024s/iter; left time: 13.7087s
	iters: 600, epoch: 3 | loss: 0.9308738
	speed: 0.0024s/iter; left time: 13.4647s
	iters: 700, epoch: 3 | loss: 0.2549239
	speed: 0.0024s/iter; left time: 13.1962s
	iters: 800, epoch: 3 | loss: 0.5841866
	speed: 0.0023s/iter; left time: 12.3819s
	iters: 900, epoch: 3 | loss: 0.2085881
	speed: 0.0025s/iter; left time: 13.0997s
	iters: 1000, epoch: 3 | loss: 0.5512547
	speed: 0.0024s/iter; left time: 12.5172s
Updating learning rate to 0.0005250627815085411
Validation loss decreased (0.3784 --> 0.3719).  Saving model state dict ...
Epoch: 3 cost time: 2.420628309249878
Epoch: 3, Steps: 1027 | Train Loss: 0.7732357 Vali Loss: 0.3718827 Best vali loss: 0.3718827
	iters: 100, epoch: 4 | loss: 0.2697090
	speed: 0.0076s/iter; left time: 38.5027s
	iters: 200, epoch: 4 | loss: 0.8975608
	speed: 0.0024s/iter; left time: 11.6923s
	iters: 300, epoch: 4 | loss: 0.3888226
	speed: 0.0023s/iter; left time: 11.3573s
	iters: 400, epoch: 4 | loss: 1.3299690
	speed: 0.0024s/iter; left time: 11.1774s
	iters: 500, epoch: 4 | loss: 0.2397618
	speed: 0.0023s/iter; left time: 10.8097s
	iters: 600, epoch: 4 | loss: 0.8616660
	speed: 0.0023s/iter; left time: 10.2473s
	iters: 700, epoch: 4 | loss: 0.4748878
	speed: 0.0022s/iter; left time: 9.9618s
	iters: 800, epoch: 4 | loss: 0.7214907
	speed: 0.0022s/iter; left time: 9.6645s
	iters: 900, epoch: 4 | loss: 0.5526809
	speed: 0.0022s/iter; left time: 9.4611s
	iters: 1000, epoch: 4 | loss: 0.4683098
	speed: 0.0023s/iter; left time: 9.3270s
Updating learning rate to 0.00037974186225
Epoch: 4 cost time: 2.410414934158325
Epoch: 4, Steps: 1027 | Train Loss: 0.6204858 Vali Loss: 0.4094457 Best vali loss: 0.3718827
	iters: 100, epoch: 5 | loss: 0.8972183
	speed: 0.0077s/iter; left time: 30.7338s
	iters: 200, epoch: 5 | loss: 0.4593519
	speed: 0.0022s/iter; left time: 8.4517s
	iters: 300, epoch: 5 | loss: 0.4186383
	speed: 0.0022s/iter; left time: 8.2903s
	iters: 400, epoch: 5 | loss: 0.3570984
	speed: 0.0022s/iter; left time: 8.1792s
	iters: 500, epoch: 5 | loss: 0.9860719
	speed: 0.0022s/iter; left time: 7.7957s
	iters: 600, epoch: 5 | loss: 0.3297130
	speed: 0.0021s/iter; left time: 7.4888s
	iters: 700, epoch: 5 | loss: 0.3485473
	speed: 0.0021s/iter; left time: 7.2080s
	iters: 800, epoch: 5 | loss: 0.4883944
	speed: 0.0021s/iter; left time: 6.8874s
	iters: 900, epoch: 5 | loss: 0.3649732
	speed: 0.0021s/iter; left time: 6.6868s
	iters: 1000, epoch: 5 | loss: 0.3498201
	speed: 0.0021s/iter; left time: 6.4815s
Updating learning rate to 0.0002344209429914589
Epoch: 5 cost time: 2.240020513534546
Epoch: 5, Steps: 1027 | Train Loss: 0.4999827 Vali Loss: 0.4206454 Best vali loss: 0.3718827
	iters: 100, epoch: 6 | loss: 0.7970686
	speed: 0.0073s/iter; left time: 21.8752s
	iters: 200, epoch: 6 | loss: 1.1721102
	speed: 0.0022s/iter; left time: 6.2382s
	iters: 300, epoch: 6 | loss: 0.6438223
	speed: 0.0022s/iter; left time: 6.1266s
	iters: 400, epoch: 6 | loss: 0.4999987
	speed: 0.0022s/iter; left time: 5.8661s
	iters: 500, epoch: 6 | loss: 0.2324348
	speed: 0.0021s/iter; left time: 5.4991s
	iters: 600, epoch: 6 | loss: 0.4956667
	speed: 0.0022s/iter; left time: 5.4250s
	iters: 700, epoch: 6 | loss: 0.4479069
	speed: 0.0021s/iter; left time: 5.1186s
	iters: 800, epoch: 6 | loss: 0.2475092
	speed: 0.0022s/iter; left time: 4.9409s
	iters: 900, epoch: 6 | loss: 0.3408698
	speed: 0.0022s/iter; left time: 4.8006s
	iters: 1000, epoch: 6 | loss: 0.3921491
	speed: 0.0021s/iter; left time: 4.4650s
Updating learning rate to 0.0001112238163526172
Epoch: 6 cost time: 2.2837798595428467
Epoch: 6, Steps: 1027 | Train Loss: 0.5269536 Vali Loss: 0.4141157 Best vali loss: 0.3718827
	iters: 100, epoch: 7 | loss: 0.3680962
	speed: 0.0075s/iter; left time: 14.7544s
	iters: 200, epoch: 7 | loss: 0.4326130
	speed: 0.0023s/iter; left time: 4.2408s
	iters: 300, epoch: 7 | loss: 0.2986862
	speed: 0.0023s/iter; left time: 4.0790s
	iters: 400, epoch: 7 | loss: 0.2141231
	speed: 0.0023s/iter; left time: 3.7986s
	iters: 500, epoch: 7 | loss: 0.3992963
	speed: 0.0024s/iter; left time: 3.7295s
	iters: 600, epoch: 7 | loss: 0.2548582
	speed: 0.0024s/iter; left time: 3.4343s
	iters: 700, epoch: 7 | loss: 1.1965793
	speed: 0.0023s/iter; left time: 3.1807s
	iters: 800, epoch: 7 | loss: 0.8747161
	speed: 0.0024s/iter; left time: 2.9542s
	iters: 900, epoch: 7 | loss: 0.3496989
	speed: 0.0022s/iter; left time: 2.5584s
	iters: 1000, epoch: 7 | loss: 0.4356258
	speed: 0.0022s/iter; left time: 2.2929s
Updating learning rate to 2.8906128079504553e-05
Epoch: 7 cost time: 2.4140818119049072
Epoch: 7, Steps: 1027 | Train Loss: 0.4824293 Vali Loss: 0.4267910 Best vali loss: 0.3718827
	iters: 100, epoch: 8 | loss: 0.4661050
	speed: 0.0076s/iter; left time: 7.0789s
	iters: 200, epoch: 8 | loss: 0.4535875
	speed: 0.0024s/iter; left time: 2.0048s
	iters: 300, epoch: 8 | loss: 0.3233579
	speed: 0.0025s/iter; left time: 1.7840s
	iters: 400, epoch: 8 | loss: 0.4305519
	speed: 0.0025s/iter; left time: 1.5568s
	iters: 500, epoch: 8 | loss: 0.2887624
	speed: 0.0025s/iter; left time: 1.3112s
	iters: 600, epoch: 8 | loss: 0.4564057
	speed: 0.0025s/iter; left time: 1.0632s
	iters: 700, epoch: 8 | loss: 0.4700886
	speed: 0.0025s/iter; left time: 0.8283s
	iters: 800, epoch: 8 | loss: 0.4203864
	speed: 0.0025s/iter; left time: 0.5789s
	iters: 900, epoch: 8 | loss: 0.4277650
	speed: 0.0026s/iter; left time: 0.3286s
	iters: 1000, epoch: 8 | loss: 0.5150782
	speed: 0.0024s/iter; left time: 0.0669s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5841362476348877
Epoch: 8, Steps: 1027 | Train Loss: 0.4252089 Vali Loss: 0.4335704 Best vali loss: 0.3718827

best validation loss 0.37188272804080386

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0095764325624, 'e_layers': 4, 'learning_rate': 0.0004643186145, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5689467
	speed: 0.0122s/iter; left time: 23.8781s
	iters: 200, epoch: 1 | loss: 0.6487736
	speed: 0.0058s/iter; left time: 10.7947s
Updating learning rate to 0.0004643186145
Validation loss decreased (inf --> 0.3841).  Saving model state dict ...
Epoch: 1 cost time: 1.8509678840637207
Epoch: 1, Steps: 257 | Train Loss: 0.6088601 Vali Loss: 0.3841028 Best vali loss: 0.3841028
	iters: 100, epoch: 2 | loss: 0.8445226
	speed: 0.0119s/iter; left time: 20.1967s
	iters: 200, epoch: 2 | loss: 0.5923358
	speed: 0.0056s/iter; left time: 8.9453s
Updating learning rate to 0.00023215930725
Epoch: 2 cost time: 1.4709224700927734
Epoch: 2, Steps: 257 | Train Loss: 0.7184292 Vali Loss: 0.4059079 Best vali loss: 0.3841028
	iters: 100, epoch: 3 | loss: 0.5753382
	speed: 0.0120s/iter; left time: 17.3575s
	iters: 200, epoch: 3 | loss: 0.8541188
	speed: 0.0059s/iter; left time: 7.9647s
Updating learning rate to 0.000116079653625
Epoch: 3 cost time: 1.5282926559448242
Epoch: 3, Steps: 257 | Train Loss: 0.7147285 Vali Loss: 0.4012937 Best vali loss: 0.3841028
	iters: 100, epoch: 4 | loss: 0.8470666
	speed: 0.0115s/iter; left time: 13.6092s
	iters: 200, epoch: 4 | loss: 0.4562274
	speed: 0.0054s/iter; left time: 5.8105s
Updating learning rate to 5.80398268125e-05
Epoch: 4 cost time: 1.4217760562896729
Epoch: 4, Steps: 257 | Train Loss: 0.6516470 Vali Loss: 0.4025432 Best vali loss: 0.3841028
	iters: 100, epoch: 5 | loss: 0.7806486
	speed: 0.0116s/iter; left time: 10.7385s
	iters: 200, epoch: 5 | loss: 0.6849025
	speed: 0.0056s/iter; left time: 4.6186s
Updating learning rate to 2.901991340625e-05
Epoch: 5 cost time: 1.4381966590881348
Epoch: 5, Steps: 257 | Train Loss: 0.7327755 Vali Loss: 0.3976814 Best vali loss: 0.3841028
	iters: 100, epoch: 6 | loss: 0.6959864
	speed: 0.0113s/iter; left time: 7.6085s
	iters: 200, epoch: 6 | loss: 0.5960183
	speed: 0.0054s/iter; left time: 3.0604s
Updating learning rate to 1.4509956703125e-05
Epoch: 6 cost time: 1.4240045547485352
Epoch: 6, Steps: 257 | Train Loss: 0.6460024 Vali Loss: 0.3965501 Best vali loss: 0.3841028
	iters: 100, epoch: 7 | loss: 0.9309305
	speed: 0.0116s/iter; left time: 4.8344s
	iters: 200, epoch: 7 | loss: 0.7753007
	speed: 0.0056s/iter; left time: 1.7623s
Updating learning rate to 7.2549783515625e-06
Epoch: 7 cost time: 1.454545497894287
Epoch: 7, Steps: 257 | Train Loss: 0.8531156 Vali Loss: 0.3971336 Best vali loss: 0.3841028
	iters: 100, epoch: 8 | loss: 0.5712811
	speed: 0.0116s/iter; left time: 1.8272s
	iters: 200, epoch: 8 | loss: 0.4211146
	speed: 0.0055s/iter; left time: 0.3209s
Updating learning rate to 3.62748917578125e-06
Epoch: 8 cost time: 1.451077938079834
Epoch: 8, Steps: 257 | Train Loss: 0.4961978 Vali Loss: 0.3972254 Best vali loss: 0.3841028

best validation loss 0.3841027566105537

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0091865367912, 'e_layers': 4, 'learning_rate': 0.0004653459459, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5694298
	speed: 0.0123s/iter; left time: 24.0123s
	iters: 200, epoch: 1 | loss: 0.6318823
	speed: 0.0057s/iter; left time: 10.6569s
Updating learning rate to 0.0004653459459
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 1.8819043636322021
Epoch: 1, Steps: 257 | Train Loss: 0.6006561 Vali Loss: 0.3774987 Best vali loss: 0.3774987
	iters: 100, epoch: 2 | loss: 0.7099619
	speed: 0.0123s/iter; left time: 20.8444s
	iters: 200, epoch: 2 | loss: 0.5750391
	speed: 0.0053s/iter; left time: 8.4456s
Updating learning rate to 0.00023267297295
Epoch: 2 cost time: 1.4178094863891602
Epoch: 2, Steps: 257 | Train Loss: 0.6425005 Vali Loss: 0.3917321 Best vali loss: 0.3774987
	iters: 100, epoch: 3 | loss: 0.5390894
	speed: 0.0114s/iter; left time: 16.5118s
	iters: 200, epoch: 3 | loss: 0.6814112
	speed: 0.0058s/iter; left time: 7.8103s
Updating learning rate to 0.000116336486475
Epoch: 3 cost time: 1.4902071952819824
Epoch: 3, Steps: 257 | Train Loss: 0.6102503 Vali Loss: 0.3778021 Best vali loss: 0.3774987

best validation loss 0.37749865656400244

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0038067122216, 'e_layers': 4, 'learning_rate': 0.0005944209047, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3609554
	speed: 0.0125s/iter; left time: 24.4325s
	iters: 200, epoch: 1 | loss: 0.8420266
	speed: 0.0062s/iter; left time: 11.5882s
Updating learning rate to 0.0005944209047
Validation loss decreased (inf --> 0.4114).  Saving model state dict ...
Epoch: 1 cost time: 1.9656763076782227
Epoch: 1, Steps: 257 | Train Loss: 0.6014910 Vali Loss: 0.4114039 Best vali loss: 0.4114039
	iters: 100, epoch: 2 | loss: 0.9112962
	speed: 0.0135s/iter; left time: 22.9493s
	iters: 200, epoch: 2 | loss: 0.9152282
	speed: 0.0062s/iter; left time: 9.8857s
Updating learning rate to 0.00029721045235
Validation loss decreased (0.4114 --> 0.3954).  Saving model state dict ...
Epoch: 2 cost time: 1.653585433959961
Epoch: 2, Steps: 257 | Train Loss: 0.9132622 Vali Loss: 0.3954233 Best vali loss: 0.3954233
	iters: 100, epoch: 3 | loss: 0.4952678
	speed: 0.0137s/iter; left time: 19.7596s
	iters: 200, epoch: 3 | loss: 1.1665732
	speed: 0.0065s/iter; left time: 8.6631s
Updating learning rate to 0.000148605226175
Validation loss decreased (0.3954 --> 0.3936).  Saving model state dict ...
Epoch: 3 cost time: 1.68937087059021
Epoch: 3, Steps: 257 | Train Loss: 0.8309205 Vali Loss: 0.3935576 Best vali loss: 0.3935576

best validation loss 0.39355759292782405

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0092798703729, 'e_layers': 4, 'learning_rate': 0.0004616341319, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3111576
	speed: 0.0132s/iter; left time: 25.8159s
	iters: 200, epoch: 1 | loss: 0.9703102
	speed: 0.0068s/iter; left time: 12.6769s
Updating learning rate to 0.0004616341319
Validation loss decreased (inf --> 0.3872).  Saving model state dict ...
Epoch: 1 cost time: 2.1226000785827637
Epoch: 1, Steps: 257 | Train Loss: 1.1407339 Vali Loss: 0.3872272 Best vali loss: 0.3872272
	iters: 100, epoch: 2 | loss: 0.4721870
	speed: 0.0142s/iter; left time: 24.1707s
	iters: 200, epoch: 2 | loss: 0.5898986
	speed: 0.0068s/iter; left time: 10.8994s
Updating learning rate to 0.00023081706595
Validation loss decreased (0.3872 --> 0.3766).  Saving model state dict ...
Epoch: 2 cost time: 1.7823810577392578
Epoch: 2, Steps: 257 | Train Loss: 0.5310428 Vali Loss: 0.3766060 Best vali loss: 0.3766060
	iters: 100, epoch: 3 | loss: 0.7541810
	speed: 0.0149s/iter; left time: 21.4391s
	iters: 200, epoch: 3 | loss: 0.8540816
	speed: 0.0069s/iter; left time: 9.3035s
Updating learning rate to 0.000115408532975
Validation loss decreased (0.3766 --> 0.3759).  Saving model state dict ...
Epoch: 3 cost time: 1.8202965259552002
Epoch: 3, Steps: 257 | Train Loss: 0.8041313 Vali Loss: 0.3759371 Best vali loss: 0.3759371

best validation loss 0.3759370699495604

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0092798703729, 'e_layers': 4, 'learning_rate': 0.0004616341319, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1814617
	speed: 0.0136s/iter; left time: 16.1719s
	iters: 200, epoch: 4 | loss: 0.5879133
	speed: 0.0068s/iter; left time: 7.3348s
Updating learning rate to 5.77042664875e-05
Epoch: 4 cost time: 2.110236883163452
Epoch: 4, Steps: 257 | Train Loss: 0.8846875 Vali Loss: 0.3859431 Best vali loss: 0.3759371
	iters: 100, epoch: 5 | loss: 0.4119518
	speed: 0.0140s/iter; left time: 13.0356s
	iters: 200, epoch: 5 | loss: 0.3686879
	speed: 0.0068s/iter; left time: 5.6139s
Updating learning rate to 2.885213324375e-05
Epoch: 5 cost time: 1.7855443954467773
Epoch: 5, Steps: 257 | Train Loss: 0.3903199 Vali Loss: 0.3853195 Best vali loss: 0.3759371
	iters: 100, epoch: 6 | loss: 0.6548834
	speed: 0.0140s/iter; left time: 9.4131s
	iters: 200, epoch: 6 | loss: 0.5868121
	speed: 0.0068s/iter; left time: 3.8762s
Updating learning rate to 1.4426066621875e-05
Epoch: 6 cost time: 1.785810947418213
Epoch: 6, Steps: 257 | Train Loss: 0.6208477 Vali Loss: 0.3897077 Best vali loss: 0.3759371
	iters: 100, epoch: 7 | loss: 0.3065083
	speed: 0.0138s/iter; left time: 5.7431s
	iters: 200, epoch: 7 | loss: 0.4827145
	speed: 0.0067s/iter; left time: 2.1034s
Updating learning rate to 7.2130333109375e-06
Epoch: 7 cost time: 1.7584209442138672
Epoch: 7, Steps: 257 | Train Loss: 0.3946114 Vali Loss: 0.3894182 Best vali loss: 0.3759371
	iters: 100, epoch: 8 | loss: 0.8283251
	speed: 0.0138s/iter; left time: 2.1867s
	iters: 200, epoch: 8 | loss: 0.3700331
	speed: 0.0069s/iter; left time: 0.3987s
Updating learning rate to 3.60651665546875e-06
Epoch: 8 cost time: 1.8011565208435059
Epoch: 8, Steps: 257 | Train Loss: 0.5991791 Vali Loss: 0.3878870 Best vali loss: 0.3759371

best validation loss 0.3759370699495604

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.009949567976, 'e_layers': 4, 'learning_rate': 0.0004621897427, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3106360
	speed: 0.0132s/iter; left time: 25.7434s
	iters: 200, epoch: 1 | loss: 0.9450912
	speed: 0.0068s/iter; left time: 12.5672s
Updating learning rate to 0.0004621897427
Validation loss decreased (inf --> 0.3922).  Saving model state dict ...
Epoch: 1 cost time: 2.1016077995300293
Epoch: 1, Steps: 257 | Train Loss: 1.1278636 Vali Loss: 0.3921766 Best vali loss: 0.3921766
	iters: 100, epoch: 2 | loss: 0.5302020
	speed: 0.0142s/iter; left time: 24.0638s
	iters: 200, epoch: 2 | loss: 0.6061386
	speed: 0.0067s/iter; left time: 10.7332s
Updating learning rate to 0.00023109487135
Validation loss decreased (0.3922 --> 0.3863).  Saving model state dict ...
Epoch: 2 cost time: 1.765066146850586
Epoch: 2, Steps: 257 | Train Loss: 0.5681703 Vali Loss: 0.3862568 Best vali loss: 0.3862568
	iters: 100, epoch: 3 | loss: 0.8004045
	speed: 0.0146s/iter; left time: 21.0058s
	iters: 200, epoch: 3 | loss: 0.9366959
	speed: 0.0069s/iter; left time: 9.2007s
Updating learning rate to 0.000115547435675
Validation loss decreased (0.3863 --> 0.3740).  Saving model state dict ...
Epoch: 3 cost time: 1.8014440536499023
Epoch: 3, Steps: 257 | Train Loss: 0.8685502 Vali Loss: 0.3740373 Best vali loss: 0.3740373
	iters: 100, epoch: 4 | loss: 0.3380680
	speed: 0.0147s/iter; left time: 17.4144s
	iters: 200, epoch: 4 | loss: 0.6904469
	speed: 0.0068s/iter; left time: 7.3351s
Updating learning rate to 5.77737178375e-05
Epoch: 4 cost time: 1.7880163192749023
Epoch: 4, Steps: 257 | Train Loss: 0.5142575 Vali Loss: 0.3802232 Best vali loss: 0.3740373
	iters: 100, epoch: 5 | loss: 1.2083925
	speed: 0.0140s/iter; left time: 13.0006s
	iters: 200, epoch: 5 | loss: 0.4847830
	speed: 0.0068s/iter; left time: 5.6353s
Updating learning rate to 2.888685891875e-05
Validation loss decreased (0.3740 --> 0.3713).  Saving model state dict ...
Epoch: 5 cost time: 1.7987251281738281
Epoch: 5, Steps: 257 | Train Loss: 0.8465877 Vali Loss: 0.3712999 Best vali loss: 0.3712999
	iters: 100, epoch: 6 | loss: 0.5080407
	speed: 0.0146s/iter; left time: 9.8148s
	iters: 200, epoch: 6 | loss: 0.3437769
	speed: 0.0067s/iter; left time: 3.8108s
Updating learning rate to 1.4443429459375e-05
Epoch: 6 cost time: 1.7694919109344482
Epoch: 6, Steps: 257 | Train Loss: 0.4259088 Vali Loss: 0.3724027 Best vali loss: 0.3712999
	iters: 100, epoch: 7 | loss: 0.3419348
	speed: 0.0141s/iter; left time: 5.8309s
	iters: 200, epoch: 7 | loss: 0.4631389
	speed: 0.0068s/iter; left time: 2.1327s
Updating learning rate to 7.2217147296875e-06
Epoch: 7 cost time: 1.7868537902832031
Epoch: 7, Steps: 257 | Train Loss: 0.4025369 Vali Loss: 0.3776364 Best vali loss: 0.3712999
	iters: 100, epoch: 8 | loss: 0.5286549
	speed: 0.0140s/iter; left time: 2.2121s
	iters: 200, epoch: 8 | loss: 0.6027460
	speed: 0.0067s/iter; left time: 0.3915s
Updating learning rate to 3.61085736484375e-06
Epoch: 8 cost time: 1.7859055995941162
Epoch: 8, Steps: 257 | Train Loss: 0.5657004 Vali Loss: 0.3760317 Best vali loss: 0.3712999

best validation loss 0.3712998843731721

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.009786534617, 'e_layers': 4, 'learning_rate': 0.0004565353751, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3061806
	speed: 0.0132s/iter; left time: 25.8008s
	iters: 200, epoch: 1 | loss: 0.9307725
	speed: 0.0069s/iter; left time: 12.8644s
Updating learning rate to 0.0004565353751
Validation loss decreased (inf --> 0.3991).  Saving model state dict ...
Epoch: 1 cost time: 2.1455113887786865
Epoch: 1, Steps: 257 | Train Loss: 1.1184766 Vali Loss: 0.3991292 Best vali loss: 0.3991292
	iters: 100, epoch: 2 | loss: 0.4741151
	speed: 0.0144s/iter; left time: 24.5321s
	iters: 200, epoch: 2 | loss: 0.5530434
	speed: 0.0067s/iter; left time: 10.7621s
Updating learning rate to 0.00022826768755
Validation loss decreased (0.3991 --> 0.3873).  Saving model state dict ...
Epoch: 2 cost time: 1.7717459201812744
Epoch: 2, Steps: 257 | Train Loss: 0.5135792 Vali Loss: 0.3873441 Best vali loss: 0.3873441
	iters: 100, epoch: 3 | loss: 0.8471391
	speed: 0.0144s/iter; left time: 20.8510s
	iters: 200, epoch: 3 | loss: 0.8652762
	speed: 0.0068s/iter; left time: 9.1756s
Updating learning rate to 0.000114133843775
Validation loss decreased (0.3873 --> 0.3783).  Saving model state dict ...
Epoch: 3 cost time: 1.788325548171997
Epoch: 3, Steps: 257 | Train Loss: 0.8562077 Vali Loss: 0.3783296 Best vali loss: 0.3783296
	iters: 100, epoch: 4 | loss: 0.3244900
	speed: 0.0147s/iter; left time: 17.3910s
	iters: 200, epoch: 4 | loss: 0.6457711
	speed: 0.0068s/iter; left time: 7.3885s
Updating learning rate to 5.70669218875e-05
Epoch: 4 cost time: 1.7931017875671387
Epoch: 4, Steps: 257 | Train Loss: 0.4851306 Vali Loss: 0.3795024 Best vali loss: 0.3783296
	iters: 100, epoch: 5 | loss: 1.2144415
	speed: 0.0139s/iter; left time: 12.9222s
	iters: 200, epoch: 5 | loss: 0.4664888
	speed: 0.0067s/iter; left time: 5.5409s
Updating learning rate to 2.853346094375e-05
Validation loss decreased (0.3783 --> 0.3767).  Saving model state dict ...
Epoch: 5 cost time: 1.763110637664795
Epoch: 5, Steps: 257 | Train Loss: 0.8404652 Vali Loss: 0.3767157 Best vali loss: 0.3767157
	iters: 100, epoch: 6 | loss: 0.5013838
	speed: 0.0145s/iter; left time: 9.7120s
	iters: 200, epoch: 6 | loss: 0.3481959
	speed: 0.0067s/iter; left time: 3.8312s
Updating learning rate to 1.4266730471875e-05
Validation loss decreased (0.3767 --> 0.3758).  Saving model state dict ...
Epoch: 6 cost time: 1.776029109954834
Epoch: 6, Steps: 257 | Train Loss: 0.4247898 Vali Loss: 0.3758405 Best vali loss: 0.3758405
	iters: 100, epoch: 7 | loss: 0.3114696
	speed: 0.0145s/iter; left time: 6.0184s
	iters: 200, epoch: 7 | loss: 0.4759167
	speed: 0.0067s/iter; left time: 2.1062s
Updating learning rate to 7.1333652359375e-06
Epoch: 7 cost time: 1.7622051239013672
Epoch: 7, Steps: 257 | Train Loss: 0.3936932 Vali Loss: 0.3779322 Best vali loss: 0.3758405
	iters: 100, epoch: 8 | loss: 0.5300457
	speed: 0.0139s/iter; left time: 2.2023s
	iters: 200, epoch: 8 | loss: 0.6073966
	speed: 0.0069s/iter; left time: 0.3999s
Updating learning rate to 3.56668261796875e-06
Epoch: 8 cost time: 1.8096284866333008
Epoch: 8, Steps: 257 | Train Loss: 0.5687212 Vali Loss: 0.3786430 Best vali loss: 0.3758405

best validation loss 0.37584046343220706

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0078280795155, 'e_layers': 2, 'learning_rate': 0.0008652294245, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008652294245
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 0.6809024810791016
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3667893 Best vali loss: 0.3667893
Updating learning rate to 0.00043261471225
Epoch: 2 cost time: 0.33973050117492676
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703866 Best vali loss: 0.3667893
Updating learning rate to 0.000216307356125
Validation loss decreased (0.3668 --> 0.3666).  Saving model state dict ...
Epoch: 3 cost time: 0.3595566749572754
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3666238 Best vali loss: 0.3666238

best validation loss 0.3666238075155172

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0116598346568, 'e_layers': 1, 'learning_rate': 0.0018475278889, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7866338
	speed: 0.0096s/iter; left time: 8.9381s
Updating learning rate to 0.001777210545599248
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 0.777012825012207
Epoch: 1, Steps: 129 | Train Loss: 0.7866338 Vali Loss: 0.3686854 Best vali loss: 0.3686854
	iters: 100, epoch: 2 | loss: 0.9397012
	speed: 0.0059s/iter; left time: 4.7269s
Updating learning rate to 0.0015769636937862281
Epoch: 2 cost time: 0.45342373847961426
Epoch: 2, Steps: 129 | Train Loss: 0.9397012 Vali Loss: 0.3712481 Best vali loss: 0.3686854
	iters: 100, epoch: 3 | loss: 0.7165801
	speed: 0.0057s/iter; left time: 3.8792s
Updating learning rate to 0.00127727310140724
Epoch: 3 cost time: 0.41917967796325684
Epoch: 3, Steps: 129 | Train Loss: 0.7165801 Vali Loss: 0.3763189 Best vali loss: 0.3686854

best validation loss 0.36868540428007984

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010598516599, 'e_layers': 4, 'learning_rate': 0.0003951901147, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3273440
	speed: 0.0126s/iter; left time: 24.6295s
	iters: 200, epoch: 1 | loss: 0.8018579
	speed: 0.0062s/iter; left time: 11.5506s
Updating learning rate to 0.0003951901147
Validation loss decreased (inf --> 0.3930).  Saving model state dict ...
Epoch: 1 cost time: 1.9694113731384277
Epoch: 1, Steps: 257 | Train Loss: 0.5646009 Vali Loss: 0.3929940 Best vali loss: 0.3929940
	iters: 100, epoch: 2 | loss: 0.8955161
	speed: 0.0135s/iter; left time: 22.9045s
	iters: 200, epoch: 2 | loss: 0.9316750
	speed: 0.0064s/iter; left time: 10.2258s
Updating learning rate to 0.00019759505735
Validation loss decreased (0.3930 --> 0.3793).  Saving model state dict ...
Epoch: 2 cost time: 1.6836233139038086
Epoch: 2, Steps: 257 | Train Loss: 0.9135955 Vali Loss: 0.3793214 Best vali loss: 0.3793214
	iters: 100, epoch: 3 | loss: 0.5979787
	speed: 0.0137s/iter; left time: 19.7774s
	iters: 200, epoch: 3 | loss: 0.9060134
	speed: 0.0063s/iter; left time: 8.4481s
Updating learning rate to 9.8797528675e-05
Epoch: 3 cost time: 1.66241455078125
Epoch: 3, Steps: 257 | Train Loss: 0.7519960 Vali Loss: 0.3816070 Best vali loss: 0.3793214

best validation loss 0.3793214006016437

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0078280795155, 'e_layers': 2, 'learning_rate': 0.0008652294245, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001081536780625
Epoch: 4 cost time: 0.6772630214691162
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3695771 Best vali loss: 0.3666238
Updating learning rate to 5.407683903125e-05
Epoch: 5 cost time: 0.3711965084075928
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3716739 Best vali loss: 0.3666238
Updating learning rate to 2.7038419515625e-05
Epoch: 6 cost time: 0.3679690361022949
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3710889 Best vali loss: 0.3666238
Updating learning rate to 1.35192097578125e-05
Epoch: 7 cost time: 0.3648240566253662
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3713275 Best vali loss: 0.3666238
Updating learning rate to 6.75960487890625e-06
Epoch: 8 cost time: 0.36475062370300293
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3715757 Best vali loss: 0.3666238

best validation loss 0.3666238075155172

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0013490217106, 'e_layers': 3, 'learning_rate': 0.0003570623716, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9730901
	speed: 0.0107s/iter; left time: 42.8027s
	iters: 200, epoch: 1 | loss: 0.5309591
	speed: 0.0045s/iter; left time: 17.7406s
	iters: 300, epoch: 1 | loss: 0.9793432
	speed: 0.0044s/iter; left time: 16.8583s
	iters: 400, epoch: 1 | loss: 0.9718260
	speed: 0.0044s/iter; left time: 16.3567s
	iters: 500, epoch: 1 | loss: 0.8150103
	speed: 0.0039s/iter; left time: 13.9848s
Updating learning rate to 0.0003570623716
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 2.5878918170928955
Epoch: 1, Steps: 514 | Train Loss: 0.8540457 Vali Loss: 0.3657308 Best vali loss: 0.3657308
	iters: 100, epoch: 2 | loss: 0.9150375
	speed: 0.0085s/iter; left time: 29.8117s
	iters: 200, epoch: 2 | loss: 0.4141283
	speed: 0.0040s/iter; left time: 13.6962s
	iters: 300, epoch: 2 | loss: 1.1016393
	speed: 0.0038s/iter; left time: 12.3900s
	iters: 400, epoch: 2 | loss: 0.8137975
	speed: 0.0038s/iter; left time: 12.1535s
	iters: 500, epoch: 2 | loss: 0.9417562
	speed: 0.0037s/iter; left time: 11.4618s
Updating learning rate to 0.0001785311858
Validation loss decreased (0.3657 --> 0.3622).  Saving model state dict ...
Epoch: 2 cost time: 2.039604663848877
Epoch: 2, Steps: 514 | Train Loss: 0.8372718 Vali Loss: 0.3621903 Best vali loss: 0.3621903
	iters: 100, epoch: 3 | loss: 0.7326352
	speed: 0.0081s/iter; left time: 24.0569s
	iters: 200, epoch: 3 | loss: 0.6429007
	speed: 0.0038s/iter; left time: 10.9892s
	iters: 300, epoch: 3 | loss: 0.3013532
	speed: 0.0038s/iter; left time: 10.5370s
	iters: 400, epoch: 3 | loss: 0.5019789
	speed: 0.0037s/iter; left time: 9.9232s
	iters: 500, epoch: 3 | loss: 0.8436664
	speed: 0.0038s/iter; left time: 9.7294s
Updating learning rate to 8.92655929e-05
Epoch: 3 cost time: 1.9894475936889648
Epoch: 3, Steps: 514 | Train Loss: 0.6045069 Vali Loss: 0.3702015 Best vali loss: 0.3621903
	iters: 100, epoch: 4 | loss: 0.5414647
	speed: 0.0084s/iter; left time: 20.6364s
	iters: 200, epoch: 4 | loss: 0.5432796
	speed: 0.0039s/iter; left time: 9.2504s
	iters: 300, epoch: 4 | loss: 0.4448780
	speed: 0.0038s/iter; left time: 8.5299s
	iters: 400, epoch: 4 | loss: 0.5321074
	speed: 0.0038s/iter; left time: 8.2056s
	iters: 500, epoch: 4 | loss: 0.6191086
	speed: 0.0037s/iter; left time: 7.5988s
Updating learning rate to 4.463279645e-05
Validation loss decreased (0.3622 --> 0.3533).  Saving model state dict ...
Epoch: 4 cost time: 2.003100633621216
Epoch: 4, Steps: 514 | Train Loss: 0.5361677 Vali Loss: 0.3533122 Best vali loss: 0.3533122
	iters: 100, epoch: 5 | loss: 0.3880486
	speed: 0.0084s/iter; left time: 16.3470s
	iters: 200, epoch: 5 | loss: 0.3451074
	speed: 0.0038s/iter; left time: 6.9723s
	iters: 300, epoch: 5 | loss: 0.3088550
	speed: 0.0042s/iter; left time: 7.4647s
	iters: 400, epoch: 5 | loss: 0.6695632
	speed: 0.0046s/iter; left time: 7.5606s
	iters: 500, epoch: 5 | loss: 0.5491194
	speed: 0.0044s/iter; left time: 6.8978s
Updating learning rate to 2.2316398225e-05
Validation loss decreased (0.3533 --> 0.3483).  Saving model state dict ...
Epoch: 5 cost time: 2.2092444896698
Epoch: 5, Steps: 514 | Train Loss: 0.4521387 Vali Loss: 0.3483232 Best vali loss: 0.3483232
	iters: 100, epoch: 6 | loss: 0.3512295
	speed: 0.0083s/iter; left time: 11.9360s
	iters: 200, epoch: 6 | loss: 0.8702633
	speed: 0.0037s/iter; left time: 4.9801s
	iters: 300, epoch: 6 | loss: 0.3493479
	speed: 0.0037s/iter; left time: 4.6418s
	iters: 400, epoch: 6 | loss: 0.2824191
	speed: 0.0038s/iter; left time: 4.3494s
	iters: 500, epoch: 6 | loss: 0.5167116
	speed: 0.0037s/iter; left time: 3.8810s
Updating learning rate to 1.11581991125e-05
Validation loss decreased (0.3483 --> 0.3455).  Saving model state dict ...
Epoch: 6 cost time: 1.9776945114135742
Epoch: 6, Steps: 514 | Train Loss: 0.4739943 Vali Loss: 0.3455005 Best vali loss: 0.3455005
	iters: 100, epoch: 7 | loss: 0.3109008
	speed: 0.0084s/iter; left time: 7.7809s
	iters: 200, epoch: 7 | loss: 0.4573993
	speed: 0.0042s/iter; left time: 3.5025s
	iters: 300, epoch: 7 | loss: 0.6476554
	speed: 0.0044s/iter; left time: 3.1939s
	iters: 400, epoch: 7 | loss: 0.5748304
	speed: 0.0045s/iter; left time: 2.8115s
	iters: 500, epoch: 7 | loss: 0.3079608
	speed: 0.0045s/iter; left time: 2.3731s
Updating learning rate to 5.57909955625e-06
Validation loss decreased (0.3455 --> 0.3455).  Saving model state dict ...
Epoch: 7 cost time: 2.2437567710876465
Epoch: 7, Steps: 514 | Train Loss: 0.4597493 Vali Loss: 0.3454712 Best vali loss: 0.3454712
	iters: 100, epoch: 8 | loss: 0.3101997
	speed: 0.0087s/iter; left time: 3.6275s
	iters: 200, epoch: 8 | loss: 0.8244846
	speed: 0.0044s/iter; left time: 1.3706s
	iters: 300, epoch: 8 | loss: 0.5112774
	speed: 0.0045s/iter; left time: 0.9639s
	iters: 400, epoch: 8 | loss: 0.6237822
	speed: 0.0044s/iter; left time: 0.5110s
	iters: 500, epoch: 8 | loss: 0.4814233
	speed: 0.0045s/iter; left time: 0.0672s
Updating learning rate to 2.789549778125e-06
Epoch: 8 cost time: 2.2952194213867188
Epoch: 8, Steps: 514 | Train Loss: 0.5502334 Vali Loss: 0.3467548 Best vali loss: 0.3454712

best validation loss 0.345471162833493

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0011064247545, 'e_layers': 2, 'learning_rate': 0.0002161275503, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6332855
	speed: 0.0099s/iter; left time: 19.3392s
	iters: 200, epoch: 1 | loss: 0.9084418
	speed: 0.0037s/iter; left time: 6.8519s
Updating learning rate to 0.0002079016852169868
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 1.286484956741333
Epoch: 1, Steps: 257 | Train Loss: 0.7708637 Vali Loss: 0.3662964 Best vali loss: 0.3662964
	iters: 100, epoch: 2 | loss: 0.5905760
	speed: 0.0081s/iter; left time: 13.7079s
	iters: 200, epoch: 2 | loss: 1.0129266
	speed: 0.0035s/iter; left time: 5.5737s
Updating learning rate to 0.0001844764033591833
Epoch: 2 cost time: 0.9769365787506104
Epoch: 2, Steps: 257 | Train Loss: 0.8017513 Vali Loss: 0.3678540 Best vali loss: 0.3662964
	iters: 100, epoch: 3 | loss: 0.4518588
	speed: 0.0082s/iter; left time: 11.8432s
	iters: 200, epoch: 3 | loss: 0.6899099
	speed: 0.0036s/iter; left time: 4.8647s
Updating learning rate to 0.0001494179915387313
Validation loss decreased (0.3663 --> 0.3637).  Saving model state dict ...
Epoch: 3 cost time: 0.9890754222869873
Epoch: 3, Steps: 257 | Train Loss: 0.5708843 Vali Loss: 0.3637110 Best vali loss: 0.3637110
	iters: 100, epoch: 4 | loss: 0.5423728
	speed: 0.0080s/iter; left time: 9.5137s
	iters: 200, epoch: 4 | loss: 0.5072407
	speed: 0.0035s/iter; left time: 3.8289s
Updating learning rate to 0.00010806377515
Epoch: 4 cost time: 0.9510440826416016
Epoch: 4, Steps: 257 | Train Loss: 0.5248067 Vali Loss: 0.3760847 Best vali loss: 0.3637110
	iters: 100, epoch: 5 | loss: 0.4760165
	speed: 0.0078s/iter; left time: 7.2879s
	iters: 200, epoch: 5 | loss: 0.7717876
	speed: 0.0035s/iter; left time: 2.8718s
Updating learning rate to 6.670955876126871e-05
Epoch: 5 cost time: 0.9261758327484131
Epoch: 5, Steps: 257 | Train Loss: 0.6239020 Vali Loss: 0.3798695 Best vali loss: 0.3637110
	iters: 100, epoch: 6 | loss: 0.4445223
	speed: 0.0080s/iter; left time: 5.3880s
	iters: 200, epoch: 6 | loss: 0.7016392
	speed: 0.0037s/iter; left time: 2.1100s
Updating learning rate to 3.1651146940816684e-05
Epoch: 6 cost time: 0.992974042892456
Epoch: 6, Steps: 257 | Train Loss: 0.5730807 Vali Loss: 0.3892116 Best vali loss: 0.3637110
	iters: 100, epoch: 7 | loss: 0.8521171
	speed: 0.0080s/iter; left time: 3.3330s
	iters: 200, epoch: 7 | loss: 0.6156895
	speed: 0.0036s/iter; left time: 1.1335s
Updating learning rate to 8.225865083013194e-06
Epoch: 7 cost time: 0.9878032207489014
Epoch: 7, Steps: 257 | Train Loss: 0.7339033 Vali Loss: 0.3802920 Best vali loss: 0.3637110
	iters: 100, epoch: 8 | loss: 0.2758717
	speed: 0.0083s/iter; left time: 1.3102s
	iters: 200, epoch: 8 | loss: 0.5411628
	speed: 0.0035s/iter; left time: 0.2052s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.996361494064331
Epoch: 8, Steps: 257 | Train Loss: 0.4085172 Vali Loss: 0.3840635 Best vali loss: 0.3637110

best validation loss 0.36371100637439663

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010534659888, 'e_layers': 4, 'learning_rate': 0.0003264325239, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7240403
	speed: 0.0129s/iter; left time: 12.0735s
Updating learning rate to 0.0003140084257386057
Validation loss decreased (inf --> 0.3652).  Saving model state dict ...
Epoch: 1 cost time: 1.2173919677734375
Epoch: 1, Steps: 129 | Train Loss: 0.7240403 Vali Loss: 0.3651891 Best vali loss: 0.3651891
	iters: 100, epoch: 2 | loss: 0.6526309
	speed: 0.0102s/iter; left time: 8.2086s
Updating learning rate to 0.00027862758757476487
Validation loss decreased (0.3652 --> 0.3535).  Saving model state dict ...
Epoch: 2 cost time: 0.835031270980835
Epoch: 2, Steps: 129 | Train Loss: 0.6526309 Vali Loss: 0.3535247 Best vali loss: 0.3535247
	iters: 100, epoch: 3 | loss: 0.6998155
	speed: 0.0105s/iter; left time: 7.1177s
Updating learning rate to 0.00022567642129082562
Epoch: 3 cost time: 0.8578805923461914
Epoch: 3, Steps: 129 | Train Loss: 0.6998155 Vali Loss: 0.3805683 Best vali loss: 0.3535247

best validation loss 0.35352472919377925

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010423186413, 'e_layers': 4, 'learning_rate': 0.0003600274848, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8986791
	speed: 0.0127s/iter; left time: 24.8022s
	iters: 200, epoch: 1 | loss: 0.5577463
	speed: 0.0065s/iter; left time: 12.0554s
Updating learning rate to 0.0003600274848
Validation loss decreased (inf --> 0.3754).  Saving model state dict ...
Epoch: 1 cost time: 2.029853105545044
Epoch: 1, Steps: 257 | Train Loss: 0.7282127 Vali Loss: 0.3753617 Best vali loss: 0.3753617
	iters: 100, epoch: 2 | loss: 1.1037128
	speed: 0.0134s/iter; left time: 22.8638s
	iters: 200, epoch: 2 | loss: 0.4428637
	speed: 0.0062s/iter; left time: 9.9041s
Updating learning rate to 0.0001800137424
Epoch: 2 cost time: 1.6406779289245605
Epoch: 2, Steps: 257 | Train Loss: 0.7732882 Vali Loss: 0.3816656 Best vali loss: 0.3753617
	iters: 100, epoch: 3 | loss: 0.6985027
	speed: 0.0130s/iter; left time: 18.7494s
	iters: 200, epoch: 3 | loss: 0.5025174
	speed: 0.0063s/iter; left time: 8.4756s
Updating learning rate to 9.00068712e-05
Validation loss decreased (0.3754 --> 0.3695).  Saving model state dict ...
Epoch: 3 cost time: 1.6601662635803223
Epoch: 3, Steps: 257 | Train Loss: 0.6005101 Vali Loss: 0.3694598 Best vali loss: 0.3694598

best validation loss 0.3694598017483657

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022728214612, 'e_layers': 2, 'learning_rate': 0.0007351654719, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007071849021987057
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.7663800716400146
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3662673 Best vali loss: 0.3662673
Updating learning rate to 0.0006275029811873491
Epoch: 2 cost time: 0.4557380676269531
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3676938 Best vali loss: 0.3662673
Updating learning rate to 0.0005082505590214964
Epoch: 3 cost time: 0.4555220603942871
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3840659 Best vali loss: 0.3662673

best validation loss 0.3662672732340095

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010534659888, 'e_layers': 4, 'learning_rate': 0.0003264325239, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6111090
	speed: 0.0129s/iter; left time: 7.0393s
Updating learning rate to 0.00016321626195
Epoch: 4 cost time: 1.1909263134002686
Epoch: 4, Steps: 129 | Train Loss: 0.6111090 Vali Loss: 0.3670868 Best vali loss: 0.3535247
	iters: 100, epoch: 5 | loss: 0.5186124
	speed: 0.0104s/iter; left time: 4.3483s
Updating learning rate to 0.00010075610260917441
Epoch: 5 cost time: 0.8780174255371094
Epoch: 5, Steps: 129 | Train Loss: 0.5186124 Vali Loss: 0.3628398 Best vali loss: 0.3535247
	iters: 100, epoch: 6 | loss: 0.6009316
	speed: 0.0101s/iter; left time: 2.9223s
Updating learning rate to 4.780493632523514e-05
Epoch: 6 cost time: 0.8495306968688965
Epoch: 6, Steps: 129 | Train Loss: 0.6009316 Vali Loss: 0.3695281 Best vali loss: 0.3535247
	iters: 100, epoch: 7 | loss: 0.2766841
	speed: 0.0101s/iter; left time: 1.6005s
Updating learning rate to 1.2424098161394283e-05
Epoch: 7 cost time: 0.8339362144470215
Epoch: 7, Steps: 129 | Train Loss: 0.2766841 Vali Loss: 0.3705172 Best vali loss: 0.3535247
	iters: 100, epoch: 8 | loss: 0.6746098
	speed: 0.0104s/iter; left time: 0.3106s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8657946586608887
Epoch: 8, Steps: 129 | Train Loss: 0.6746098 Vali Loss: 0.3691935 Best vali loss: 0.3535247

best validation loss 0.35352472919377925

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0083866779242, 'e_layers': 1, 'learning_rate': 0.0006081926295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4843487
	speed: 0.0083s/iter; left time: 33.4743s
	iters: 200, epoch: 1 | loss: 0.3417016
	speed: 0.0023s/iter; left time: 9.1531s
	iters: 300, epoch: 1 | loss: 0.5514532
	speed: 0.0023s/iter; left time: 8.6173s
	iters: 400, epoch: 1 | loss: 0.3495279
	speed: 0.0023s/iter; left time: 8.3802s
	iters: 500, epoch: 1 | loss: 0.6312876
	speed: 0.0023s/iter; left time: 8.3141s
Updating learning rate to 0.0005850446758596351
Validation loss decreased (inf --> 0.3648).  Saving model state dict ...
Epoch: 1 cost time: 1.5188355445861816
Epoch: 1, Steps: 514 | Train Loss: 0.4716638 Vali Loss: 0.3647714 Best vali loss: 0.3647714
	iters: 100, epoch: 2 | loss: 0.8823655
	speed: 0.0060s/iter; left time: 20.8954s
	iters: 200, epoch: 2 | loss: 0.8905955
	speed: 0.0024s/iter; left time: 8.1892s
	iters: 300, epoch: 2 | loss: 0.4085718
	speed: 0.0026s/iter; left time: 8.5055s
	iters: 400, epoch: 2 | loss: 0.8200614
	speed: 0.0025s/iter; left time: 7.8431s
	iters: 500, epoch: 2 | loss: 0.6335535
	speed: 0.0025s/iter; left time: 7.6226s
Updating learning rate to 0.0005191248810435637
Epoch: 2 cost time: 1.315260410308838
Epoch: 2, Steps: 514 | Train Loss: 0.7270295 Vali Loss: 0.3667497 Best vali loss: 0.3647714
	iters: 100, epoch: 3 | loss: 0.5036941
	speed: 0.0058s/iter; left time: 17.2830s
	iters: 200, epoch: 3 | loss: 0.7793835
	speed: 0.0023s/iter; left time: 6.4974s
	iters: 300, epoch: 3 | loss: 0.8201314
	speed: 0.0023s/iter; left time: 6.4145s
	iters: 400, epoch: 3 | loss: 1.0294453
	speed: 0.0022s/iter; left time: 5.8397s
	iters: 500, epoch: 3 | loss: 0.2908930
	speed: 0.0022s/iter; left time: 5.6785s
Updating learning rate to 0.0004204689362481047
Epoch: 3 cost time: 1.2045509815216064
Epoch: 3, Steps: 514 | Train Loss: 0.6847095 Vali Loss: 0.3821418 Best vali loss: 0.3647714
	iters: 100, epoch: 4 | loss: 0.3139833
	speed: 0.0054s/iter; left time: 13.2394s
	iters: 200, epoch: 4 | loss: 0.9246041
	speed: 0.0022s/iter; left time: 5.1795s
	iters: 300, epoch: 4 | loss: 0.4921071
	speed: 0.0022s/iter; left time: 5.0579s
	iters: 400, epoch: 4 | loss: 0.7580847
	speed: 0.0022s/iter; left time: 4.8159s
	iters: 500, epoch: 4 | loss: 0.4512114
	speed: 0.0023s/iter; left time: 4.7800s
Updating learning rate to 0.00030409631475
Epoch: 4 cost time: 1.185722827911377
Epoch: 4, Steps: 514 | Train Loss: 0.5879981 Vali Loss: 0.3714178 Best vali loss: 0.3647714
	iters: 100, epoch: 5 | loss: 0.7334438
	speed: 0.0056s/iter; left time: 10.8905s
	iters: 200, epoch: 5 | loss: 1.0432297
	speed: 0.0022s/iter; left time: 4.0821s
	iters: 300, epoch: 5 | loss: 0.4008745
	speed: 0.0022s/iter; left time: 3.8352s
	iters: 400, epoch: 5 | loss: 0.7205860
	speed: 0.0022s/iter; left time: 3.6345s
	iters: 500, epoch: 5 | loss: 0.4707252
	speed: 0.0022s/iter; left time: 3.4529s
Updating learning rate to 0.00018772369325189533
Epoch: 5 cost time: 1.1917526721954346
Epoch: 5, Steps: 514 | Train Loss: 0.6737718 Vali Loss: 0.3809874 Best vali loss: 0.3647714
	iters: 100, epoch: 6 | loss: 0.4404910
	speed: 0.0056s/iter; left time: 8.0777s
	iters: 200, epoch: 6 | loss: 0.6760254
	speed: 0.0022s/iter; left time: 3.0195s
	iters: 300, epoch: 6 | loss: 0.7278501
	speed: 0.0023s/iter; left time: 2.8272s
	iters: 400, epoch: 6 | loss: 0.4763454
	speed: 0.0023s/iter; left time: 2.5806s
	iters: 500, epoch: 6 | loss: 0.3283179
	speed: 0.0023s/iter; left time: 2.4201s
Updating learning rate to 8.906774845643628e-05
Epoch: 6 cost time: 1.217191219329834
Epoch: 6, Steps: 514 | Train Loss: 0.5298060 Vali Loss: 0.3832963 Best vali loss: 0.3647714
	iters: 100, epoch: 7 | loss: 0.2750411
	speed: 0.0055s/iter; left time: 5.0843s
	iters: 200, epoch: 7 | loss: 0.3592430
	speed: 0.0022s/iter; left time: 1.8295s
	iters: 300, epoch: 7 | loss: 0.5333494
	speed: 0.0022s/iter; left time: 1.6339s
	iters: 400, epoch: 7 | loss: 0.3273996
	speed: 0.0022s/iter; left time: 1.3909s
	iters: 500, epoch: 7 | loss: 0.3430149
	speed: 0.0023s/iter; left time: 1.1944s
Updating learning rate to 2.314795364036489e-05
Epoch: 7 cost time: 1.1834943294525146
Epoch: 7, Steps: 514 | Train Loss: 0.3676096 Vali Loss: 0.3850835 Best vali loss: 0.3647714
	iters: 100, epoch: 8 | loss: 0.6451914
	speed: 0.0055s/iter; left time: 2.2956s
	iters: 200, epoch: 8 | loss: 0.6183456
	speed: 0.0023s/iter; left time: 0.7134s
	iters: 300, epoch: 8 | loss: 0.6116832
	speed: 0.0022s/iter; left time: 0.4750s
	iters: 400, epoch: 8 | loss: 0.5315433
	speed: 0.0022s/iter; left time: 0.2559s
	iters: 500, epoch: 8 | loss: 0.6187133
	speed: 0.0022s/iter; left time: 0.0337s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1939826011657715
Epoch: 8, Steps: 514 | Train Loss: 0.6050954 Vali Loss: 0.3842383 Best vali loss: 0.3647714

best validation loss 0.3647714013610701

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010585937587, 'e_layers': 3, 'learning_rate': 0.0003574139806, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2295019
	speed: 0.0106s/iter; left time: 85.8060s
	iters: 200, epoch: 1 | loss: 1.3333154
	speed: 0.0043s/iter; left time: 34.4006s
	iters: 300, epoch: 1 | loss: 1.0445732
	speed: 0.0043s/iter; left time: 34.1918s
	iters: 400, epoch: 1 | loss: 0.3156024
	speed: 0.0044s/iter; left time: 34.0882s
	iters: 500, epoch: 1 | loss: 1.2450752
	speed: 0.0042s/iter; left time: 32.5031s
	iters: 600, epoch: 1 | loss: 1.0414989
	speed: 0.0044s/iter; left time: 33.5162s
	iters: 700, epoch: 1 | loss: 0.4860862
	speed: 0.0043s/iter; left time: 32.5650s
	iters: 800, epoch: 1 | loss: 0.3939638
	speed: 0.0044s/iter; left time: 32.3373s
	iters: 900, epoch: 1 | loss: 0.3255434
	speed: 0.0043s/iter; left time: 31.5205s
	iters: 1000, epoch: 1 | loss: 0.6575290
	speed: 0.0044s/iter; left time: 31.7007s
Updating learning rate to 0.0003438107209548631
Validation loss decreased (inf --> 0.3924).  Saving model state dict ...
Epoch: 1 cost time: 4.813074827194214
Epoch: 1, Steps: 1027 | Train Loss: 0.7072689 Vali Loss: 0.3923749 Best vali loss: 0.3923749
	iters: 100, epoch: 2 | loss: 1.9013439
	speed: 0.0120s/iter; left time: 85.1847s
	iters: 200, epoch: 2 | loss: 0.4249881
	speed: 0.0043s/iter; left time: 29.9833s
	iters: 300, epoch: 2 | loss: 0.3068273
	speed: 0.0040s/iter; left time: 27.4031s
	iters: 400, epoch: 2 | loss: 0.4362370
	speed: 0.0038s/iter; left time: 25.8017s
	iters: 500, epoch: 2 | loss: 0.3170240
	speed: 0.0039s/iter; left time: 26.1948s
	iters: 600, epoch: 2 | loss: 2.3296010
	speed: 0.0040s/iter; left time: 26.1214s
	iters: 700, epoch: 2 | loss: 0.7305728
	speed: 0.0040s/iter; left time: 25.8922s
	iters: 800, epoch: 2 | loss: 0.2713254
	speed: 0.0038s/iter; left time: 24.5306s
	iters: 900, epoch: 2 | loss: 0.3177404
	speed: 0.0038s/iter; left time: 23.6780s
	iters: 1000, epoch: 2 | loss: 0.3096891
	speed: 0.0038s/iter; left time: 23.5138s
Updating learning rate to 0.0003050719149865686
Validation loss decreased (0.3924 --> 0.3910).  Saving model state dict ...
Epoch: 2 cost time: 4.1183412075042725
Epoch: 2, Steps: 1027 | Train Loss: 0.7345349 Vali Loss: 0.3909678 Best vali loss: 0.3909678
	iters: 100, epoch: 3 | loss: 0.3851853
	speed: 0.0117s/iter; left time: 71.0657s
	iters: 200, epoch: 3 | loss: 0.3773982
	speed: 0.0040s/iter; left time: 23.9684s
	iters: 300, epoch: 3 | loss: 0.3342769
	speed: 0.0040s/iter; left time: 23.5573s
	iters: 400, epoch: 3 | loss: 0.3472103
	speed: 0.0041s/iter; left time: 23.3484s
	iters: 500, epoch: 3 | loss: 1.0290602
	speed: 0.0040s/iter; left time: 22.7663s
	iters: 600, epoch: 3 | loss: 0.4472260
	speed: 0.0040s/iter; left time: 22.0832s
	iters: 700, epoch: 3 | loss: 0.4115988
	speed: 0.0038s/iter; left time: 20.9222s
	iters: 800, epoch: 3 | loss: 0.7569806
	speed: 0.0038s/iter; left time: 20.6350s
	iters: 900, epoch: 3 | loss: 0.2813365
	speed: 0.0040s/iter; left time: 21.1751s
	iters: 1000, epoch: 3 | loss: 1.1639993
	speed: 0.0040s/iter; left time: 20.4408s
Updating learning rate to 0.0002470951947356388
Epoch: 3 cost time: 4.123308897018433
Epoch: 3, Steps: 1027 | Train Loss: 0.5534272 Vali Loss: 0.4120231 Best vali loss: 0.3909678
	iters: 100, epoch: 4 | loss: 0.2896794
	speed: 0.0115s/iter; left time: 57.9984s
	iters: 200, epoch: 4 | loss: 0.6132190
	speed: 0.0043s/iter; left time: 21.3491s
	iters: 300, epoch: 4 | loss: 1.0363613
	speed: 0.0044s/iter; left time: 21.1672s
	iters: 400, epoch: 4 | loss: 0.8100422
	speed: 0.0043s/iter; left time: 20.5365s
	iters: 500, epoch: 4 | loss: 1.1735260
	speed: 0.0044s/iter; left time: 20.2437s
	iters: 600, epoch: 4 | loss: 0.8108511
	speed: 0.0044s/iter; left time: 19.7825s
	iters: 700, epoch: 4 | loss: 1.1247663
	speed: 0.0043s/iter; left time: 19.1741s
	iters: 800, epoch: 4 | loss: 0.3208698
	speed: 0.0044s/iter; left time: 19.0205s
	iters: 900, epoch: 4 | loss: 0.7249925
	speed: 0.0043s/iter; left time: 18.4177s
	iters: 1000, epoch: 4 | loss: 0.2337717
	speed: 0.0042s/iter; left time: 17.4527s
Updating learning rate to 0.0001787069903
Epoch: 4 cost time: 4.493902683258057
Epoch: 4, Steps: 1027 | Train Loss: 0.7138079 Vali Loss: 0.3989602 Best vali loss: 0.3909678
	iters: 100, epoch: 5 | loss: 0.9868122
	speed: 0.0114s/iter; left time: 45.8594s
	iters: 200, epoch: 5 | loss: 0.1970374
	speed: 0.0043s/iter; left time: 17.0024s
	iters: 300, epoch: 5 | loss: 1.5348301
	speed: 0.0044s/iter; left time: 16.6574s
	iters: 400, epoch: 5 | loss: 0.2509258
	speed: 0.0044s/iter; left time: 16.1477s
	iters: 500, epoch: 5 | loss: 0.4341327
	speed: 0.0043s/iter; left time: 15.6880s
	iters: 600, epoch: 5 | loss: 0.6971920
	speed: 0.0044s/iter; left time: 15.4158s
	iters: 700, epoch: 5 | loss: 0.3860622
	speed: 0.0044s/iter; left time: 14.9801s
	iters: 800, epoch: 5 | loss: 0.3541823
	speed: 0.0044s/iter; left time: 14.5781s
	iters: 900, epoch: 5 | loss: 0.3057702
	speed: 0.0045s/iter; left time: 14.4423s
	iters: 1000, epoch: 5 | loss: 0.3645748
	speed: 0.0044s/iter; left time: 13.7713s
Updating learning rate to 0.00011031878586436121
Epoch: 5 cost time: 4.550935506820679
Epoch: 5, Steps: 1027 | Train Loss: 0.5511520 Vali Loss: 0.4026332 Best vali loss: 0.3909678
	iters: 100, epoch: 6 | loss: 0.3766168
	speed: 0.0116s/iter; left time: 34.4807s
	iters: 200, epoch: 6 | loss: 1.5780431
	speed: 0.0043s/iter; left time: 12.4348s
	iters: 300, epoch: 6 | loss: 0.8280802
	speed: 0.0043s/iter; left time: 12.0232s
	iters: 400, epoch: 6 | loss: 0.3630306
	speed: 0.0043s/iter; left time: 11.6484s
	iters: 500, epoch: 6 | loss: 0.6291075
	speed: 0.0043s/iter; left time: 11.1981s
	iters: 600, epoch: 6 | loss: 1.1807483
	speed: 0.0045s/iter; left time: 11.0641s
	iters: 700, epoch: 6 | loss: 0.2134404
	speed: 0.0044s/iter; left time: 10.4031s
	iters: 800, epoch: 6 | loss: 0.4438543
	speed: 0.0045s/iter; left time: 10.2526s
	iters: 900, epoch: 6 | loss: 0.5448034
	speed: 0.0045s/iter; left time: 9.7778s
	iters: 1000, epoch: 6 | loss: 1.7751956
	speed: 0.0044s/iter; left time: 9.2275s
Updating learning rate to 5.2342065613431444e-05
Epoch: 6 cost time: 4.542164325714111
Epoch: 6, Steps: 1027 | Train Loss: 0.7932920 Vali Loss: 0.4024786 Best vali loss: 0.3909678
	iters: 100, epoch: 7 | loss: 0.4082357
	speed: 0.0109s/iter; left time: 21.3683s
	iters: 200, epoch: 7 | loss: 0.8896179
	speed: 0.0037s/iter; left time: 6.9411s
	iters: 300, epoch: 7 | loss: 0.4041127
	speed: 0.0037s/iter; left time: 6.5255s
	iters: 400, epoch: 7 | loss: 1.0505457
	speed: 0.0037s/iter; left time: 6.1310s
	iters: 500, epoch: 7 | loss: 0.3360654
	speed: 0.0037s/iter; left time: 5.8147s
	iters: 600, epoch: 7 | loss: 0.3732408
	speed: 0.0037s/iter; left time: 5.4161s
	iters: 700, epoch: 7 | loss: 0.3101137
	speed: 0.0037s/iter; left time: 5.0768s
	iters: 800, epoch: 7 | loss: 1.2877257
	speed: 0.0037s/iter; left time: 4.6604s
	iters: 900, epoch: 7 | loss: 0.3839198
	speed: 0.0037s/iter; left time: 4.2848s
	iters: 1000, epoch: 7 | loss: 0.5391017
	speed: 0.0037s/iter; left time: 3.9259s
Updating learning rate to 1.3603259645136947e-05
Epoch: 7 cost time: 3.8712573051452637
Epoch: 7, Steps: 1027 | Train Loss: 0.5982679 Vali Loss: 0.4056206 Best vali loss: 0.3909678
	iters: 100, epoch: 8 | loss: 0.5506730
	speed: 0.0111s/iter; left time: 10.3299s
	iters: 200, epoch: 8 | loss: 0.5689065
	speed: 0.0044s/iter; left time: 3.6202s
	iters: 300, epoch: 8 | loss: 0.6413381
	speed: 0.0043s/iter; left time: 3.1611s
	iters: 400, epoch: 8 | loss: 0.5372916
	speed: 0.0043s/iter; left time: 2.7071s
	iters: 500, epoch: 8 | loss: 0.6481199
	speed: 0.0043s/iter; left time: 2.2844s
	iters: 600, epoch: 8 | loss: 1.7329786
	speed: 0.0039s/iter; left time: 1.6647s
	iters: 700, epoch: 8 | loss: 0.6930081
	speed: 0.0037s/iter; left time: 1.2126s
	iters: 800, epoch: 8 | loss: 1.0282290
	speed: 0.0038s/iter; left time: 0.8575s
	iters: 900, epoch: 8 | loss: 0.3358244
	speed: 0.0037s/iter; left time: 0.4765s
	iters: 1000, epoch: 8 | loss: 0.5880672
	speed: 0.0037s/iter; left time: 0.1040s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.188863754272461
Epoch: 8, Steps: 1027 | Train Loss: 0.7324436 Vali Loss: 0.4039663 Best vali loss: 0.3909678

best validation loss 0.3909678417596461

[INFO][smbo.py:320] Finished 750 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022904556167, 'e_layers': 3, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7612240
	speed: 0.0122s/iter; left time: 11.3362s
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3820).  Saving model state dict ...
Epoch: 1 cost time: 1.114717960357666
Epoch: 1, Steps: 129 | Train Loss: 0.7612240 Vali Loss: 0.3819787 Best vali loss: 0.3819787
	iters: 100, epoch: 2 | loss: 0.7276974
	speed: 0.0098s/iter; left time: 7.8876s
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3820 --> 0.3774).  Saving model state dict ...
Epoch: 2 cost time: 0.7698304653167725
Epoch: 2, Steps: 129 | Train Loss: 0.7276974 Vali Loss: 0.3774421 Best vali loss: 0.3774421
	iters: 100, epoch: 3 | loss: 0.5703076
	speed: 0.0099s/iter; left time: 6.6821s
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7618758678436279
Epoch: 3, Steps: 129 | Train Loss: 0.5703076 Vali Loss: 0.3812067 Best vali loss: 0.3774421

best validation loss 0.37744214363791384

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0105134275899, 'e_layers': 4, 'learning_rate': 0.0007058875162, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4682289
	speed: 0.0117s/iter; left time: 22.9394s
	iters: 200, epoch: 1 | loss: 0.8109529
	speed: 0.0054s/iter; left time: 9.9774s
Updating learning rate to 0.0007058875162
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 1.7493414878845215
Epoch: 1, Steps: 257 | Train Loss: 0.6395909 Vali Loss: 0.3844608 Best vali loss: 0.3844608
	iters: 100, epoch: 2 | loss: 0.2666761
	speed: 0.0112s/iter; left time: 19.0651s
	iters: 200, epoch: 2 | loss: 0.5145741
	speed: 0.0056s/iter; left time: 8.8847s
Updating learning rate to 0.0003529437581
Validation loss decreased (0.3845 --> 0.3784).  Saving model state dict ...
Epoch: 2 cost time: 1.4642999172210693
Epoch: 2, Steps: 257 | Train Loss: 0.3906251 Vali Loss: 0.3783700 Best vali loss: 0.3783700
	iters: 100, epoch: 3 | loss: 0.9110274
	speed: 0.0116s/iter; left time: 16.6781s
	iters: 200, epoch: 3 | loss: 0.5890326
	speed: 0.0054s/iter; left time: 7.2670s
Updating learning rate to 0.00017647187905
Epoch: 3 cost time: 1.4427945613861084
Epoch: 3, Steps: 257 | Train Loss: 0.7500300 Vali Loss: 0.3863515 Best vali loss: 0.3783700

best validation loss 0.3783700277388447

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0104812023959, 'e_layers': 4, 'learning_rate': 0.0005726777278, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3562140
	speed: 0.0116s/iter; left time: 22.7161s
	iters: 200, epoch: 1 | loss: 0.6069882
	speed: 0.0054s/iter; left time: 9.9381s
Updating learning rate to 0.0005726777278
Validation loss decreased (inf --> 0.3736).  Saving model state dict ...
Epoch: 1 cost time: 1.7386837005615234
Epoch: 1, Steps: 257 | Train Loss: 0.4816011 Vali Loss: 0.3735763 Best vali loss: 0.3735763
	iters: 100, epoch: 2 | loss: 0.8113749
	speed: 0.0113s/iter; left time: 19.2895s
	iters: 200, epoch: 2 | loss: 0.6254960
	speed: 0.0050s/iter; left time: 8.0185s
Updating learning rate to 0.0002863388639
Epoch: 2 cost time: 1.359755277633667
Epoch: 2, Steps: 257 | Train Loss: 0.7184355 Vali Loss: 0.3811375 Best vali loss: 0.3735763
	iters: 100, epoch: 3 | loss: 0.7617636
	speed: 0.0104s/iter; left time: 15.0068s
	iters: 200, epoch: 3 | loss: 0.6227408
	speed: 0.0049s/iter; left time: 6.6006s
Updating learning rate to 0.00014316943195
Validation loss decreased (0.3736 --> 0.3560).  Saving model state dict ...
Epoch: 3 cost time: 1.3553764820098877
Epoch: 3, Steps: 257 | Train Loss: 0.6922522 Vali Loss: 0.3560283 Best vali loss: 0.3560283

best validation loss 0.35602829993825064

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0104812023959, 'e_layers': 4, 'learning_rate': 0.0005726777278, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3188431
	speed: 0.0118s/iter; left time: 13.9487s
	iters: 200, epoch: 4 | loss: 0.4748904
	speed: 0.0048s/iter; left time: 5.2341s
Updating learning rate to 7.1584715975e-05
Validation loss decreased (0.3560 --> 0.3508).  Saving model state dict ...
Epoch: 4 cost time: 1.6815249919891357
Epoch: 4, Steps: 257 | Train Loss: 0.3968668 Vali Loss: 0.3507704 Best vali loss: 0.3507704
	iters: 100, epoch: 5 | loss: 0.6047837
	speed: 0.0113s/iter; left time: 10.5199s
	iters: 200, epoch: 5 | loss: 0.4626133
	speed: 0.0047s/iter; left time: 3.9328s
Updating learning rate to 3.57923579875e-05
Epoch: 5 cost time: 1.3229880332946777
Epoch: 5, Steps: 257 | Train Loss: 0.5336985 Vali Loss: 0.3615986 Best vali loss: 0.3507704
	iters: 100, epoch: 6 | loss: 0.6444010
	speed: 0.0106s/iter; left time: 7.1136s
	iters: 200, epoch: 6 | loss: 0.5685221
	speed: 0.0052s/iter; left time: 2.9715s
Updating learning rate to 1.789617899375e-05
Epoch: 6 cost time: 1.4034061431884766
Epoch: 6, Steps: 257 | Train Loss: 0.6064616 Vali Loss: 0.3652454 Best vali loss: 0.3507704
	iters: 100, epoch: 7 | loss: 0.4740943
	speed: 0.0106s/iter; left time: 4.4176s
	iters: 200, epoch: 7 | loss: 0.4943086
	speed: 0.0049s/iter; left time: 1.5399s
Updating learning rate to 8.948089496875e-06
Epoch: 7 cost time: 1.3014240264892578
Epoch: 7, Steps: 257 | Train Loss: 0.4842015 Vali Loss: 0.3637453 Best vali loss: 0.3507704
	iters: 100, epoch: 8 | loss: 0.2811254
	speed: 0.0110s/iter; left time: 1.7388s
	iters: 200, epoch: 8 | loss: 0.3222795
	speed: 0.0053s/iter; left time: 0.3080s
Updating learning rate to 4.4740447484375e-06
Epoch: 8 cost time: 1.4097604751586914
Epoch: 8, Steps: 257 | Train Loss: 0.3017025 Vali Loss: 0.3587021 Best vali loss: 0.3507704

best validation loss 0.3507703884528522

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0101249087047, 'e_layers': 4, 'learning_rate': 0.0005467702076, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3551932
	speed: 0.0117s/iter; left time: 22.8879s
	iters: 200, epoch: 1 | loss: 0.6067960
	speed: 0.0053s/iter; left time: 9.7783s
Updating learning rate to 0.0005259600056942937
Validation loss decreased (inf --> 0.3738).  Saving model state dict ...
Epoch: 1 cost time: 1.722139596939087
Epoch: 1, Steps: 257 | Train Loss: 0.4809946 Vali Loss: 0.3738391 Best vali loss: 0.3738391
	iters: 100, epoch: 2 | loss: 0.7989668
	speed: 0.0113s/iter; left time: 19.1457s
	iters: 200, epoch: 2 | loss: 0.5361353
	speed: 0.0055s/iter; left time: 8.8217s
Updating learning rate to 0.0004666975645723682
Epoch: 2 cost time: 1.4557712078094482
Epoch: 2, Steps: 257 | Train Loss: 0.6675510 Vali Loss: 0.3822968 Best vali loss: 0.3738391
	iters: 100, epoch: 3 | loss: 0.7917080
	speed: 0.0104s/iter; left time: 15.0005s
	iters: 200, epoch: 3 | loss: 0.6344703
	speed: 0.0049s/iter; left time: 6.5734s
Updating learning rate to 0.0003780050536796704
Validation loss decreased (0.3738 --> 0.3543).  Saving model state dict ...
Epoch: 3 cost time: 1.312429428100586
Epoch: 3, Steps: 257 | Train Loss: 0.7130892 Vali Loss: 0.3543291 Best vali loss: 0.3543291
	iters: 100, epoch: 4 | loss: 0.5493121
	speed: 0.0117s/iter; left time: 13.8523s
	iters: 200, epoch: 4 | loss: 0.5310389
	speed: 0.0053s/iter; left time: 5.7906s
Updating learning rate to 0.0002733851038
Epoch: 4 cost time: 1.4200992584228516
Epoch: 4, Steps: 257 | Train Loss: 0.5401755 Vali Loss: 0.3632389 Best vali loss: 0.3543291
	iters: 100, epoch: 5 | loss: 0.3090038
	speed: 0.0107s/iter; left time: 9.9809s
	iters: 200, epoch: 5 | loss: 0.3332264
	speed: 0.0049s/iter; left time: 4.0689s
Updating learning rate to 0.0001687651539203297
Validation loss decreased (0.3543 --> 0.3533).  Saving model state dict ...
Epoch: 5 cost time: 1.3078351020812988
Epoch: 5, Steps: 257 | Train Loss: 0.3211151 Vali Loss: 0.3532719 Best vali loss: 0.3532719
	iters: 100, epoch: 6 | loss: 0.4755248
	speed: 0.0111s/iter; left time: 7.4438s
	iters: 200, epoch: 6 | loss: 0.5218222
	speed: 0.0053s/iter; left time: 3.0201s
Updating learning rate to 8.007264302763183e-05
Epoch: 6 cost time: 1.3949103355407715
Epoch: 6, Steps: 257 | Train Loss: 0.4986735 Vali Loss: 0.3682117 Best vali loss: 0.3532719
	iters: 100, epoch: 7 | loss: 0.3383850
	speed: 0.0111s/iter; left time: 4.5970s
	iters: 200, epoch: 7 | loss: 0.3163709
	speed: 0.0054s/iter; left time: 1.7114s
Updating learning rate to 2.0810201905706403e-05
Epoch: 7 cost time: 1.434375286102295
Epoch: 7, Steps: 257 | Train Loss: 0.3273779 Vali Loss: 0.3769627 Best vali loss: 0.3532719
	iters: 100, epoch: 8 | loss: 0.6217375
	speed: 0.0112s/iter; left time: 1.7675s
	iters: 200, epoch: 8 | loss: 0.3581057
	speed: 0.0054s/iter; left time: 0.3151s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4402971267700195
Epoch: 8, Steps: 257 | Train Loss: 0.4899216 Vali Loss: 0.3814570 Best vali loss: 0.3532719

best validation loss 0.35327193323661865

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0101358536755, 'e_layers': 4, 'learning_rate': 0.0006626660246, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3586392
	speed: 0.0116s/iter; left time: 22.7696s
	iters: 200, epoch: 1 | loss: 0.6231249
	speed: 0.0054s/iter; left time: 10.0085s
Updating learning rate to 0.0006626660246
Validation loss decreased (inf --> 0.3756).  Saving model state dict ...
Epoch: 1 cost time: 1.7502391338348389
Epoch: 1, Steps: 257 | Train Loss: 0.4908821 Vali Loss: 0.3755826 Best vali loss: 0.3755826
	iters: 100, epoch: 2 | loss: 0.8170131
	speed: 0.0114s/iter; left time: 19.3839s
	iters: 200, epoch: 2 | loss: 0.5679010
	speed: 0.0055s/iter; left time: 8.7709s
Updating learning rate to 0.0003313330123
Epoch: 2 cost time: 1.4500148296356201
Epoch: 2, Steps: 257 | Train Loss: 0.6924571 Vali Loss: 0.3870738 Best vali loss: 0.3755826
	iters: 100, epoch: 3 | loss: 0.7286382
	speed: 0.0114s/iter; left time: 16.4209s
	iters: 200, epoch: 3 | loss: 0.7432644
	speed: 0.0054s/iter; left time: 7.2830s
Updating learning rate to 0.00016566650615
Validation loss decreased (0.3756 --> 0.3697).  Saving model state dict ...
Epoch: 3 cost time: 1.443882942199707
Epoch: 3, Steps: 257 | Train Loss: 0.7359513 Vali Loss: 0.3696612 Best vali loss: 0.3696612
	iters: 100, epoch: 4 | loss: 0.6357020
	speed: 0.0110s/iter; left time: 13.0358s
	iters: 200, epoch: 4 | loss: 0.5500000
	speed: 0.0050s/iter; left time: 5.3813s
Updating learning rate to 8.2833253075e-05
Epoch: 4 cost time: 1.2980713844299316
Epoch: 4, Steps: 257 | Train Loss: 0.5928510 Vali Loss: 0.3755423 Best vali loss: 0.3696612
	iters: 100, epoch: 5 | loss: 0.3402080
	speed: 0.0108s/iter; left time: 9.9958s
	iters: 200, epoch: 5 | loss: 0.3479181
	speed: 0.0054s/iter; left time: 4.4944s
Updating learning rate to 4.14166265375e-05
Validation loss decreased (0.3697 --> 0.3615).  Saving model state dict ...
Epoch: 5 cost time: 1.4512228965759277
Epoch: 5, Steps: 257 | Train Loss: 0.3440630 Vali Loss: 0.3614725 Best vali loss: 0.3614725
	iters: 100, epoch: 6 | loss: 0.5242590
	speed: 0.0110s/iter; left time: 7.4140s
	iters: 200, epoch: 6 | loss: 0.5951615
	speed: 0.0050s/iter; left time: 2.8466s
Updating learning rate to 2.070831326875e-05
Epoch: 6 cost time: 1.3253936767578125
Epoch: 6, Steps: 257 | Train Loss: 0.5597102 Vali Loss: 0.3669705 Best vali loss: 0.3614725
	iters: 100, epoch: 7 | loss: 0.4554268
	speed: 0.0104s/iter; left time: 4.3322s
	iters: 200, epoch: 7 | loss: 0.3646607
	speed: 0.0050s/iter; left time: 1.5875s
Updating learning rate to 1.0354156634375e-05
Epoch: 7 cost time: 1.3240561485290527
Epoch: 7, Steps: 257 | Train Loss: 0.4100437 Vali Loss: 0.3640452 Best vali loss: 0.3614725
	iters: 100, epoch: 8 | loss: 0.7582676
	speed: 0.0106s/iter; left time: 1.6728s
	iters: 200, epoch: 8 | loss: 0.4226882
	speed: 0.0050s/iter; left time: 0.2878s
Updating learning rate to 5.1770783171875e-06
Epoch: 8 cost time: 1.3339042663574219
Epoch: 8, Steps: 257 | Train Loss: 0.5904779 Vali Loss: 0.3630162 Best vali loss: 0.3614725

best validation loss 0.36147245570343933

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0068730575991, 'e_layers': 4, 'learning_rate': 0.0003820241764, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6773143
	speed: 0.0117s/iter; left time: 46.8181s
	iters: 200, epoch: 1 | loss: 0.6384423
	speed: 0.0056s/iter; left time: 21.7739s
	iters: 300, epoch: 1 | loss: 0.3081002
	speed: 0.0056s/iter; left time: 21.2655s
	iters: 400, epoch: 1 | loss: 0.7784163
	speed: 0.0056s/iter; left time: 20.6224s
	iters: 500, epoch: 1 | loss: 0.3972005
	speed: 0.0056s/iter; left time: 20.2379s
Updating learning rate to 0.00036748424695022064
Validation loss decreased (inf --> 0.3897).  Saving model state dict ...
Epoch: 1 cost time: 3.2231109142303467
Epoch: 1, Steps: 514 | Train Loss: 0.5598947 Vali Loss: 0.3897319 Best vali loss: 0.3897319
	iters: 100, epoch: 2 | loss: 0.3351959
	speed: 0.0115s/iter; left time: 40.2034s
	iters: 200, epoch: 2 | loss: 1.0712743
	speed: 0.0056s/iter; left time: 18.8747s
	iters: 300, epoch: 2 | loss: 0.6997440
	speed: 0.0055s/iter; left time: 18.0979s
	iters: 400, epoch: 2 | loss: 0.3402010
	speed: 0.0053s/iter; left time: 16.9491s
	iters: 500, epoch: 2 | loss: 0.5428278
	speed: 0.0054s/iter; left time: 16.8108s
Updating learning rate to 0.0003260780310548229
Epoch: 2 cost time: 2.8628225326538086
Epoch: 2, Steps: 514 | Train Loss: 0.5978486 Vali Loss: 0.3987851 Best vali loss: 0.3897319
	iters: 100, epoch: 3 | loss: 0.8469318
	speed: 0.0112s/iter; left time: 33.5760s
	iters: 200, epoch: 3 | loss: 0.4044151
	speed: 0.0057s/iter; left time: 16.5376s
	iters: 300, epoch: 3 | loss: 0.4055021
	speed: 0.0056s/iter; left time: 15.5742s
	iters: 400, epoch: 3 | loss: 0.2871692
	speed: 0.0056s/iter; left time: 14.9354s
	iters: 500, epoch: 3 | loss: 0.6610814
	speed: 0.0056s/iter; left time: 14.3961s
Updating learning rate to 0.0002641092497355993
Epoch: 3 cost time: 2.9464821815490723
Epoch: 3, Steps: 514 | Train Loss: 0.5210199 Vali Loss: 0.4130898 Best vali loss: 0.3897319

best validation loss 0.38973188860477304

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043079557112, 'e_layers': 3, 'learning_rate': 6.36659361e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3760948
	speed: 0.0102s/iter; left time: 82.4289s
	iters: 200, epoch: 1 | loss: 0.3593631
	speed: 0.0040s/iter; left time: 32.0705s
	iters: 300, epoch: 1 | loss: 0.2215537
	speed: 0.0040s/iter; left time: 31.5908s
	iters: 400, epoch: 1 | loss: 1.2420870
	speed: 0.0040s/iter; left time: 31.1949s
	iters: 500, epoch: 1 | loss: 0.2648204
	speed: 0.0040s/iter; left time: 30.8344s
	iters: 600, epoch: 1 | loss: 0.5473287
	speed: 0.0043s/iter; left time: 32.6107s
	iters: 700, epoch: 1 | loss: 1.6861207
	speed: 0.0045s/iter; left time: 33.4784s
	iters: 800, epoch: 1 | loss: 0.6774505
	speed: 0.0043s/iter; left time: 31.5653s
	iters: 900, epoch: 1 | loss: 0.7394436
	speed: 0.0041s/iter; left time: 30.2840s
	iters: 1000, epoch: 1 | loss: 0.3376049
	speed: 0.0042s/iter; left time: 30.5407s
Updating learning rate to 6.36659361e-05
Validation loss decreased (inf --> 0.3645).  Saving model state dict ...
Epoch: 1 cost time: 4.602269411087036
Epoch: 1, Steps: 1027 | Train Loss: 0.6451867 Vali Loss: 0.3645088 Best vali loss: 0.3645088
	iters: 100, epoch: 2 | loss: 0.2346548
	speed: 0.0116s/iter; left time: 82.2825s
	iters: 200, epoch: 2 | loss: 0.9420270
	speed: 0.0043s/iter; left time: 29.8017s
	iters: 300, epoch: 2 | loss: 0.4754815
	speed: 0.0042s/iter; left time: 29.1960s
	iters: 400, epoch: 2 | loss: 0.8255947
	speed: 0.0043s/iter; left time: 29.2343s
	iters: 500, epoch: 2 | loss: 0.3309003
	speed: 0.0043s/iter; left time: 28.4978s
	iters: 600, epoch: 2 | loss: 0.2861314
	speed: 0.0043s/iter; left time: 28.3072s
	iters: 700, epoch: 2 | loss: 0.2852062
	speed: 0.0043s/iter; left time: 27.6021s
	iters: 800, epoch: 2 | loss: 0.4037733
	speed: 0.0043s/iter; left time: 27.2036s
	iters: 900, epoch: 2 | loss: 0.4028189
	speed: 0.0042s/iter; left time: 26.6640s
	iters: 1000, epoch: 2 | loss: 0.2467957
	speed: 0.0042s/iter; left time: 26.2923s
Updating learning rate to 3.183296805e-05
Validation loss decreased (0.3645 --> 0.3539).  Saving model state dict ...
Epoch: 2 cost time: 4.423511266708374
Epoch: 2, Steps: 1027 | Train Loss: 0.4433384 Vali Loss: 0.3539372 Best vali loss: 0.3539372
	iters: 100, epoch: 3 | loss: 0.4607749
	speed: 0.0113s/iter; left time: 68.4071s
	iters: 200, epoch: 3 | loss: 0.3261952
	speed: 0.0037s/iter; left time: 21.9013s
	iters: 300, epoch: 3 | loss: 1.7699180
	speed: 0.0036s/iter; left time: 21.2953s
	iters: 400, epoch: 3 | loss: 0.3088239
	speed: 0.0037s/iter; left time: 21.0414s
	iters: 500, epoch: 3 | loss: 1.2651695
	speed: 0.0037s/iter; left time: 20.8345s
	iters: 600, epoch: 3 | loss: 0.2760978
	speed: 0.0037s/iter; left time: 20.3417s
	iters: 700, epoch: 3 | loss: 0.3869165
	speed: 0.0036s/iter; left time: 19.6223s
	iters: 800, epoch: 3 | loss: 1.0404053
	speed: 0.0036s/iter; left time: 19.4191s
	iters: 900, epoch: 3 | loss: 0.3900757
	speed: 0.0037s/iter; left time: 19.4041s
	iters: 1000, epoch: 3 | loss: 0.1541126
	speed: 0.0036s/iter; left time: 18.6331s
Updating learning rate to 1.5916484025e-05
Epoch: 3 cost time: 3.808940887451172
Epoch: 3, Steps: 1027 | Train Loss: 0.6378489 Vali Loss: 0.3661972 Best vali loss: 0.3539372

best validation loss 0.3539371754366663

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010514206395, 'e_layers': 4, 'learning_rate': 0.0003308483144, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4800642
	speed: 0.0160s/iter; left time: 14.9128s
Updating learning rate to 0.0003308483144
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 1.610633373260498
Epoch: 1, Steps: 129 | Train Loss: 0.4800642 Vali Loss: 0.3728268 Best vali loss: 0.3728268
	iters: 100, epoch: 2 | loss: 0.5746378
	speed: 0.0154s/iter; left time: 12.3784s
Updating learning rate to 0.0001654241572
Validation loss decreased (0.3728 --> 0.3627).  Saving model state dict ...
Epoch: 2 cost time: 1.2830841541290283
Epoch: 2, Steps: 129 | Train Loss: 0.5746378 Vali Loss: 0.3627105 Best vali loss: 0.3627105
	iters: 100, epoch: 3 | loss: 0.6811361
	speed: 0.0157s/iter; left time: 10.6023s
Updating learning rate to 8.27120786e-05
Validation loss decreased (0.3627 --> 0.3493).  Saving model state dict ...
Epoch: 3 cost time: 1.293682336807251
Epoch: 3, Steps: 129 | Train Loss: 0.6811361 Vali Loss: 0.3492582 Best vali loss: 0.3492582

best validation loss 0.34925818490138927

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010514206395, 'e_layers': 4, 'learning_rate': 0.0003308483144, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3757555
	speed: 0.0168s/iter; left time: 9.1889s
Updating learning rate to 4.13560393e-05
Epoch: 4 cost time: 1.6356797218322754
Epoch: 4, Steps: 129 | Train Loss: 0.3757555 Vali Loss: 0.3496393 Best vali loss: 0.3492582
	iters: 100, epoch: 5 | loss: 0.4489921
	speed: 0.0153s/iter; left time: 6.3835s
Updating learning rate to 2.067801965e-05
Epoch: 5 cost time: 1.295569658279419
Epoch: 5, Steps: 129 | Train Loss: 0.4489921 Vali Loss: 0.3496117 Best vali loss: 0.3492582
	iters: 100, epoch: 6 | loss: 0.5662469
	speed: 0.0154s/iter; left time: 4.4361s
Updating learning rate to 1.0339009825e-05
Epoch: 6 cost time: 1.3105766773223877
Epoch: 6, Steps: 129 | Train Loss: 0.5662469 Vali Loss: 0.3531691 Best vali loss: 0.3492582
	iters: 100, epoch: 7 | loss: 0.6090989
	speed: 0.0154s/iter; left time: 2.4497s
Updating learning rate to 5.1695049125e-06
Epoch: 7 cost time: 1.2996184825897217
Epoch: 7, Steps: 129 | Train Loss: 0.6090989 Vali Loss: 0.3549589 Best vali loss: 0.3492582
	iters: 100, epoch: 8 | loss: 0.4455709
	speed: 0.0152s/iter; left time: 0.4574s
Updating learning rate to 2.58475245625e-06
Epoch: 8 cost time: 1.2934026718139648
Epoch: 8, Steps: 129 | Train Loss: 0.4455709 Vali Loss: 0.3541195 Best vali loss: 0.3492582

best validation loss 0.34925818490138927

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020355283778, 'e_layers': 4, 'learning_rate': 0.0003726727081, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3291406
	speed: 0.0125s/iter; left time: 24.4696s
	iters: 200, epoch: 1 | loss: 0.7995395
	speed: 0.0063s/iter; left time: 11.7618s
Updating learning rate to 0.0003726727081
Validation loss decreased (inf --> 0.3918).  Saving model state dict ...
Epoch: 1 cost time: 1.9767568111419678
Epoch: 1, Steps: 257 | Train Loss: 0.5643400 Vali Loss: 0.3917693 Best vali loss: 0.3917693
	iters: 100, epoch: 2 | loss: 0.8835518
	speed: 0.0135s/iter; left time: 23.0247s
	iters: 200, epoch: 2 | loss: 0.9557567
	speed: 0.0063s/iter; left time: 10.1184s
Updating learning rate to 0.00018633635405
Epoch: 2 cost time: 1.6771702766418457
Epoch: 2, Steps: 257 | Train Loss: 0.9196542 Vali Loss: 0.4104356 Best vali loss: 0.3917693
	iters: 100, epoch: 3 | loss: 0.3934106
	speed: 0.0132s/iter; left time: 18.9866s
	iters: 200, epoch: 3 | loss: 0.9450239
	speed: 0.0063s/iter; left time: 8.4223s
Updating learning rate to 9.3168177025e-05
Validation loss decreased (0.3918 --> 0.3779).  Saving model state dict ...
Epoch: 3 cost time: 1.6560447216033936
Epoch: 3, Steps: 257 | Train Loss: 0.6692172 Vali Loss: 0.3779237 Best vali loss: 0.3779237
	iters: 100, epoch: 4 | loss: 0.5655345
	speed: 0.0136s/iter; left time: 16.1452s
	iters: 200, epoch: 4 | loss: 0.5328736
	speed: 0.0063s/iter; left time: 6.8416s
Updating learning rate to 4.65840885125e-05
Validation loss decreased (0.3779 --> 0.3577).  Saving model state dict ...
Epoch: 4 cost time: 1.6655189990997314
Epoch: 4, Steps: 257 | Train Loss: 0.5492040 Vali Loss: 0.3577486 Best vali loss: 0.3577486
	iters: 100, epoch: 5 | loss: 0.5764403
	speed: 0.0138s/iter; left time: 12.8205s
	iters: 200, epoch: 5 | loss: 0.6040036
	speed: 0.0063s/iter; left time: 5.2527s
Updating learning rate to 2.329204425625e-05
Validation loss decreased (0.3577 --> 0.3567).  Saving model state dict ...
Epoch: 5 cost time: 1.6666159629821777
Epoch: 5, Steps: 257 | Train Loss: 0.5902220 Vali Loss: 0.3566620 Best vali loss: 0.3566620
	iters: 100, epoch: 6 | loss: 0.5172903
	speed: 0.0136s/iter; left time: 9.1464s
	iters: 200, epoch: 6 | loss: 0.3692462
	speed: 0.0062s/iter; left time: 3.5502s
Updating learning rate to 1.1646022128125e-05
Validation loss decreased (0.3567 --> 0.3554).  Saving model state dict ...
Epoch: 6 cost time: 1.6473534107208252
Epoch: 6, Steps: 257 | Train Loss: 0.4432682 Vali Loss: 0.3553589 Best vali loss: 0.3553589
	iters: 100, epoch: 7 | loss: 0.3835246
	speed: 0.0138s/iter; left time: 5.7121s
	iters: 200, epoch: 7 | loss: 0.3193024
	speed: 0.0063s/iter; left time: 1.9688s
Updating learning rate to 5.8230110640625e-06
Validation loss decreased (0.3554 --> 0.3534).  Saving model state dict ...
Epoch: 7 cost time: 1.6625850200653076
Epoch: 7, Steps: 257 | Train Loss: 0.3514135 Vali Loss: 0.3534194 Best vali loss: 0.3534194
	iters: 100, epoch: 8 | loss: 0.4607753
	speed: 0.0136s/iter; left time: 2.1460s
	iters: 200, epoch: 8 | loss: 0.5627735
	speed: 0.0062s/iter; left time: 0.3624s
Updating learning rate to 2.91150553203125e-06
Epoch: 8 cost time: 1.6507365703582764
Epoch: 8, Steps: 257 | Train Loss: 0.5117744 Vali Loss: 0.3542490 Best vali loss: 0.3534194

best validation loss 0.3534194350828122

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018197602691, 'e_layers': 4, 'learning_rate': 0.0003699381847, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0064601
	speed: 0.0110s/iter; left time: 89.6045s
	iters: 200, epoch: 1 | loss: 0.4201885
	speed: 0.0050s/iter; left time: 40.4689s
	iters: 300, epoch: 1 | loss: 0.5850704
	speed: 0.0050s/iter; left time: 39.8385s
	iters: 400, epoch: 1 | loss: 0.2425516
	speed: 0.0051s/iter; left time: 39.8645s
	iters: 500, epoch: 1 | loss: 0.3231431
	speed: 0.0050s/iter; left time: 38.9044s
	iters: 600, epoch: 1 | loss: 1.0860008
	speed: 0.0050s/iter; left time: 38.3125s
	iters: 700, epoch: 1 | loss: 0.5092087
	speed: 0.0050s/iter; left time: 37.8694s
	iters: 800, epoch: 1 | loss: 0.8575746
	speed: 0.0051s/iter; left time: 37.9043s
	iters: 900, epoch: 1 | loss: 0.3239817
	speed: 0.0051s/iter; left time: 37.4349s
	iters: 1000, epoch: 1 | loss: 0.2174987
	speed: 0.0051s/iter; left time: 37.0796s
Updating learning rate to 0.0003699381847
Validation loss decreased (inf --> 0.3780).  Saving model state dict ...
Epoch: 1 cost time: 5.553772687911987
Epoch: 1, Steps: 1027 | Train Loss: 0.5571678 Vali Loss: 0.3780350 Best vali loss: 0.3780350
	iters: 100, epoch: 2 | loss: 0.3543916
	speed: 0.0135s/iter; left time: 95.6977s
	iters: 200, epoch: 2 | loss: 0.6976488
	speed: 0.0050s/iter; left time: 35.2344s
	iters: 300, epoch: 2 | loss: 0.4746517
	speed: 0.0051s/iter; left time: 34.8043s
	iters: 400, epoch: 2 | loss: 0.2999620
	speed: 0.0050s/iter; left time: 34.1939s
	iters: 500, epoch: 2 | loss: 0.2108305
	speed: 0.0049s/iter; left time: 32.8393s
	iters: 600, epoch: 2 | loss: 0.3069060
	speed: 0.0048s/iter; left time: 31.8657s
	iters: 700, epoch: 2 | loss: 0.2171423
	speed: 0.0047s/iter; left time: 30.8114s
	iters: 800, epoch: 2 | loss: 0.7634134
	speed: 0.0048s/iter; left time: 30.6570s
	iters: 900, epoch: 2 | loss: 1.3613088
	speed: 0.0048s/iter; left time: 30.0710s
	iters: 1000, epoch: 2 | loss: 0.3031758
	speed: 0.0048s/iter; left time: 29.6548s
Updating learning rate to 0.00018496909235
Epoch: 2 cost time: 5.0737690925598145
Epoch: 2, Steps: 1027 | Train Loss: 0.4989431 Vali Loss: 0.3846913 Best vali loss: 0.3780350
	iters: 100, epoch: 3 | loss: 0.4210912
	speed: 0.0123s/iter; left time: 74.3977s
	iters: 200, epoch: 3 | loss: 0.8764899
	speed: 0.0045s/iter; left time: 26.6385s
	iters: 300, epoch: 3 | loss: 0.3792197
	speed: 0.0044s/iter; left time: 25.8084s
	iters: 400, epoch: 3 | loss: 1.8882849
	speed: 0.0044s/iter; left time: 25.5432s
	iters: 500, epoch: 3 | loss: 1.4869694
	speed: 0.0044s/iter; left time: 25.1191s
	iters: 600, epoch: 3 | loss: 0.4113900
	speed: 0.0045s/iter; left time: 24.8614s
	iters: 700, epoch: 3 | loss: 0.4625355
	speed: 0.0045s/iter; left time: 24.5127s
	iters: 800, epoch: 3 | loss: 0.4854154
	speed: 0.0044s/iter; left time: 23.6667s
	iters: 900, epoch: 3 | loss: 0.3936411
	speed: 0.0046s/iter; left time: 24.1080s
	iters: 1000, epoch: 3 | loss: 1.1132592
	speed: 0.0046s/iter; left time: 23.5015s
Updating learning rate to 9.2484546175e-05
Epoch: 3 cost time: 4.6286890506744385
Epoch: 3, Steps: 1027 | Train Loss: 0.7918296 Vali Loss: 0.3865224 Best vali loss: 0.3780350
	iters: 100, epoch: 4 | loss: 0.7189277
	speed: 0.0124s/iter; left time: 62.4256s
	iters: 200, epoch: 4 | loss: 0.3029377
	speed: 0.0047s/iter; left time: 23.3363s
	iters: 300, epoch: 4 | loss: 1.4830903
	speed: 0.0047s/iter; left time: 22.9675s
	iters: 400, epoch: 4 | loss: 0.2522671
	speed: 0.0048s/iter; left time: 22.5322s
	iters: 500, epoch: 4 | loss: 1.4121467
	speed: 0.0048s/iter; left time: 22.1824s
	iters: 600, epoch: 4 | loss: 0.3225931
	speed: 0.0050s/iter; left time: 22.4563s
	iters: 700, epoch: 4 | loss: 1.2312585
	speed: 0.0048s/iter; left time: 21.5131s
	iters: 800, epoch: 4 | loss: 0.4223967
	speed: 0.0048s/iter; left time: 20.8616s
	iters: 900, epoch: 4 | loss: 0.4145196
	speed: 0.0049s/iter; left time: 20.7610s
	iters: 1000, epoch: 4 | loss: 0.4396484
	speed: 0.0049s/iter; left time: 20.1025s
Updating learning rate to 4.62422730875e-05
Validation loss decreased (0.3780 --> 0.3596).  Saving model state dict ...
Epoch: 4 cost time: 4.96516489982605
Epoch: 4, Steps: 1027 | Train Loss: 0.6999786 Vali Loss: 0.3596139 Best vali loss: 0.3596139
	iters: 100, epoch: 5 | loss: 0.2157939
	speed: 0.0130s/iter; left time: 52.2633s
	iters: 200, epoch: 5 | loss: 0.4438927
	speed: 0.0047s/iter; left time: 18.3741s
	iters: 300, epoch: 5 | loss: 0.5960631
	speed: 0.0047s/iter; left time: 17.7245s
	iters: 400, epoch: 5 | loss: 1.0495574
	speed: 0.0047s/iter; left time: 17.4337s
	iters: 500, epoch: 5 | loss: 0.9674394
	speed: 0.0047s/iter; left time: 16.8240s
	iters: 600, epoch: 5 | loss: 0.3382753
	speed: 0.0047s/iter; left time: 16.3740s
	iters: 700, epoch: 5 | loss: 0.3693167
	speed: 0.0047s/iter; left time: 16.0038s
	iters: 800, epoch: 5 | loss: 0.8795822
	speed: 0.0047s/iter; left time: 15.6034s
	iters: 900, epoch: 5 | loss: 0.7134368
	speed: 0.0047s/iter; left time: 15.0155s
	iters: 1000, epoch: 5 | loss: 0.8271136
	speed: 0.0046s/iter; left time: 14.3241s
Updating learning rate to 2.312113654375e-05
Validation loss decreased (0.3596 --> 0.3556).  Saving model state dict ...
Epoch: 5 cost time: 4.848326921463013
Epoch: 5, Steps: 1027 | Train Loss: 0.6400471 Vali Loss: 0.3555954 Best vali loss: 0.3555954
	iters: 100, epoch: 6 | loss: 0.3783267
	speed: 0.0125s/iter; left time: 37.2733s
	iters: 200, epoch: 6 | loss: 0.7881007
	speed: 0.0046s/iter; left time: 13.1666s
	iters: 300, epoch: 6 | loss: 0.4189399
	speed: 0.0045s/iter; left time: 12.6009s
	iters: 400, epoch: 6 | loss: 0.3246953
	speed: 0.0046s/iter; left time: 12.2050s
	iters: 500, epoch: 6 | loss: 0.7070017
	speed: 0.0045s/iter; left time: 11.6821s
	iters: 600, epoch: 6 | loss: 0.5345457
	speed: 0.0044s/iter; left time: 10.8589s
	iters: 700, epoch: 6 | loss: 0.6623147
	speed: 0.0044s/iter; left time: 10.5801s
	iters: 800, epoch: 6 | loss: 1.3335726
	speed: 0.0049s/iter; left time: 11.1806s
	iters: 900, epoch: 6 | loss: 0.8666724
	speed: 0.0050s/iter; left time: 10.8717s
	iters: 1000, epoch: 6 | loss: 0.3455008
	speed: 0.0049s/iter; left time: 10.1800s
Updating learning rate to 1.1560568271875e-05
Epoch: 6 cost time: 4.793291807174683
Epoch: 6, Steps: 1027 | Train Loss: 0.6359670 Vali Loss: 0.3636355 Best vali loss: 0.3555954
	iters: 100, epoch: 7 | loss: 0.5007971
	speed: 0.0129s/iter; left time: 25.1913s
	iters: 200, epoch: 7 | loss: 0.9212665
	speed: 0.0050s/iter; left time: 9.3550s
	iters: 300, epoch: 7 | loss: 1.0902779
	speed: 0.0050s/iter; left time: 8.7360s
	iters: 400, epoch: 7 | loss: 0.2645715
	speed: 0.0050s/iter; left time: 8.3204s
	iters: 500, epoch: 7 | loss: 0.2953878
	speed: 0.0050s/iter; left time: 7.8525s
	iters: 600, epoch: 7 | loss: 0.2496278
	speed: 0.0050s/iter; left time: 7.3184s
	iters: 700, epoch: 7 | loss: 0.2261268
	speed: 0.0051s/iter; left time: 6.8709s
	iters: 800, epoch: 7 | loss: 0.3888289
	speed: 0.0050s/iter; left time: 6.2969s
	iters: 900, epoch: 7 | loss: 0.1925457
	speed: 0.0050s/iter; left time: 5.7618s
	iters: 1000, epoch: 7 | loss: 0.2723319
	speed: 0.0050s/iter; left time: 5.2996s
Updating learning rate to 5.7802841359375e-06
Epoch: 7 cost time: 5.210378885269165
Epoch: 7, Steps: 1027 | Train Loss: 0.4401762 Vali Loss: 0.3573712 Best vali loss: 0.3555954
	iters: 100, epoch: 8 | loss: 0.2739088
	speed: 0.0127s/iter; left time: 11.7581s
	iters: 200, epoch: 8 | loss: 0.2479650
	speed: 0.0044s/iter; left time: 3.6703s
	iters: 300, epoch: 8 | loss: 0.4054825
	speed: 0.0045s/iter; left time: 3.2636s
	iters: 400, epoch: 8 | loss: 0.5232300
	speed: 0.0045s/iter; left time: 2.8209s
	iters: 500, epoch: 8 | loss: 0.7551786
	speed: 0.0045s/iter; left time: 2.3803s
	iters: 600, epoch: 8 | loss: 0.5801966
	speed: 0.0045s/iter; left time: 1.9192s
	iters: 700, epoch: 8 | loss: 0.4309307
	speed: 0.0045s/iter; left time: 1.4767s
	iters: 800, epoch: 8 | loss: 0.5121428
	speed: 0.0045s/iter; left time: 1.0345s
	iters: 900, epoch: 8 | loss: 0.8213566
	speed: 0.0047s/iter; left time: 0.6014s
	iters: 1000, epoch: 8 | loss: 0.2403148
	speed: 0.0049s/iter; left time: 0.1379s
Updating learning rate to 2.89014206796875e-06
Epoch: 8 cost time: 4.7474822998046875
Epoch: 8, Steps: 1027 | Train Loss: 0.4790706 Vali Loss: 0.3591487 Best vali loss: 0.3555954

best validation loss 0.35559542307919273

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0017972042985, 'e_layers': 4, 'learning_rate': 0.0003952537954, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0073788
	speed: 0.0112s/iter; left time: 90.8722s
	iters: 200, epoch: 1 | loss: 0.4604795
	speed: 0.0051s/iter; left time: 40.5370s
	iters: 300, epoch: 1 | loss: 0.5201933
	speed: 0.0051s/iter; left time: 40.2177s
	iters: 400, epoch: 1 | loss: 0.2481523
	speed: 0.0051s/iter; left time: 39.9515s
	iters: 500, epoch: 1 | loss: 0.3477769
	speed: 0.0048s/iter; left time: 36.9631s
	iters: 600, epoch: 1 | loss: 1.1529348
	speed: 0.0046s/iter; left time: 35.2395s
	iters: 700, epoch: 1 | loss: 0.4876705
	speed: 0.0046s/iter; left time: 34.7924s
	iters: 800, epoch: 1 | loss: 0.8551691
	speed: 0.0048s/iter; left time: 35.5542s
	iters: 900, epoch: 1 | loss: 0.3229441
	speed: 0.0048s/iter; left time: 34.7964s
	iters: 1000, epoch: 1 | loss: 0.2990448
	speed: 0.0048s/iter; left time: 34.5867s
Updating learning rate to 0.0003952537954
Validation loss decreased (inf --> 0.3965).  Saving model state dict ...
Epoch: 1 cost time: 5.349268674850464
Epoch: 1, Steps: 1027 | Train Loss: 0.5701744 Vali Loss: 0.3964711 Best vali loss: 0.3964711
	iters: 100, epoch: 2 | loss: 0.3764114
	speed: 0.0132s/iter; left time: 93.6466s
	iters: 200, epoch: 2 | loss: 0.5128656
	speed: 0.0051s/iter; left time: 35.8960s
	iters: 300, epoch: 2 | loss: 0.4196878
	speed: 0.0051s/iter; left time: 35.4048s
	iters: 400, epoch: 2 | loss: 0.2767074
	speed: 0.0051s/iter; left time: 34.7147s
	iters: 500, epoch: 2 | loss: 0.2296520
	speed: 0.0052s/iter; left time: 34.6413s
	iters: 600, epoch: 2 | loss: 0.2502263
	speed: 0.0052s/iter; left time: 34.0395s
	iters: 700, epoch: 2 | loss: 0.2185386
	speed: 0.0052s/iter; left time: 33.4854s
	iters: 800, epoch: 2 | loss: 0.7588118
	speed: 0.0052s/iter; left time: 33.0335s
	iters: 900, epoch: 2 | loss: 1.4092289
	speed: 0.0051s/iter; left time: 32.3178s
	iters: 1000, epoch: 2 | loss: 0.3295036
	speed: 0.0051s/iter; left time: 31.8252s
Updating learning rate to 0.0001976268977
Validation loss decreased (0.3965 --> 0.3874).  Saving model state dict ...
Epoch: 2 cost time: 5.324779510498047
Epoch: 2, Steps: 1027 | Train Loss: 0.4781633 Vali Loss: 0.3874236 Best vali loss: 0.3874236
	iters: 100, epoch: 3 | loss: 0.4496578
	speed: 0.0134s/iter; left time: 81.3359s
	iters: 200, epoch: 3 | loss: 0.8925401
	speed: 0.0050s/iter; left time: 29.9423s
	iters: 300, epoch: 3 | loss: 0.3109921
	speed: 0.0051s/iter; left time: 29.6714s
	iters: 400, epoch: 3 | loss: 1.8528491
	speed: 0.0050s/iter; left time: 28.9108s
	iters: 500, epoch: 3 | loss: 1.5336607
	speed: 0.0050s/iter; left time: 28.3848s
	iters: 600, epoch: 3 | loss: 0.5150827
	speed: 0.0050s/iter; left time: 27.8633s
	iters: 700, epoch: 3 | loss: 0.4667453
	speed: 0.0050s/iter; left time: 27.3322s
	iters: 800, epoch: 3 | loss: 0.5085649
	speed: 0.0050s/iter; left time: 26.8024s
	iters: 900, epoch: 3 | loss: 0.4556014
	speed: 0.0050s/iter; left time: 26.3623s
	iters: 1000, epoch: 3 | loss: 1.3831296
	speed: 0.0050s/iter; left time: 25.8217s
Updating learning rate to 9.881344885e-05
Validation loss decreased (0.3874 --> 0.3870).  Saving model state dict ...
Epoch: 3 cost time: 5.202293872833252
Epoch: 3, Steps: 1027 | Train Loss: 0.8368824 Vali Loss: 0.3869613 Best vali loss: 0.3869613

best validation loss 0.38696130473159385

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019667911728, 'e_layers': 4, 'learning_rate': 0.000357265271, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0062839
	speed: 0.0111s/iter; left time: 90.0345s
	iters: 200, epoch: 1 | loss: 0.4226191
	speed: 0.0051s/iter; left time: 40.7438s
	iters: 300, epoch: 1 | loss: 0.5905983
	speed: 0.0051s/iter; left time: 40.3846s
	iters: 400, epoch: 1 | loss: 0.2502954
	speed: 0.0051s/iter; left time: 40.0881s
	iters: 500, epoch: 1 | loss: 0.3565428
	speed: 0.0051s/iter; left time: 39.3303s
	iters: 600, epoch: 1 | loss: 0.9537393
	speed: 0.0051s/iter; left time: 39.0201s
	iters: 700, epoch: 1 | loss: 0.4926137
	speed: 0.0051s/iter; left time: 38.5408s
	iters: 800, epoch: 1 | loss: 0.8271170
	speed: 0.0051s/iter; left time: 37.5649s
	iters: 900, epoch: 1 | loss: 0.3267322
	speed: 0.0052s/iter; left time: 37.8228s
	iters: 1000, epoch: 1 | loss: 0.2238327
	speed: 0.0052s/iter; left time: 37.1987s
Updating learning rate to 0.000357265271
Validation loss decreased (inf --> 0.3804).  Saving model state dict ...
Epoch: 1 cost time: 5.5880725383758545
Epoch: 1, Steps: 1027 | Train Loss: 0.5450374 Vali Loss: 0.3803562 Best vali loss: 0.3803562
	iters: 100, epoch: 2 | loss: 0.3659936
	speed: 0.0127s/iter; left time: 90.0283s
	iters: 200, epoch: 2 | loss: 0.4180738
	speed: 0.0047s/iter; left time: 32.9207s
	iters: 300, epoch: 2 | loss: 0.4616979
	speed: 0.0047s/iter; left time: 32.1574s
	iters: 400, epoch: 2 | loss: 0.2677636
	speed: 0.0046s/iter; left time: 30.9367s
	iters: 500, epoch: 2 | loss: 0.2237839
	speed: 0.0045s/iter; left time: 30.0031s
	iters: 600, epoch: 2 | loss: 0.2430483
	speed: 0.0047s/iter; left time: 31.1509s
	iters: 700, epoch: 2 | loss: 0.1976952
	speed: 0.0047s/iter; left time: 30.4387s
	iters: 800, epoch: 2 | loss: 0.7413719
	speed: 0.0045s/iter; left time: 28.8624s
	iters: 900, epoch: 2 | loss: 1.3839573
	speed: 0.0045s/iter; left time: 28.5453s
	iters: 1000, epoch: 2 | loss: 0.2898441
	speed: 0.0046s/iter; left time: 28.5709s
Updating learning rate to 0.0001786326355
Validation loss decreased (0.3804 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 4.784137725830078
Epoch: 2, Steps: 1027 | Train Loss: 0.4593230 Vali Loss: 0.3740893 Best vali loss: 0.3740893
	iters: 100, epoch: 3 | loss: 0.4240062
	speed: 0.0128s/iter; left time: 77.7333s
	iters: 200, epoch: 3 | loss: 0.8832535
	speed: 0.0047s/iter; left time: 28.0035s
	iters: 300, epoch: 3 | loss: 0.3548450
	speed: 0.0047s/iter; left time: 27.5099s
	iters: 400, epoch: 3 | loss: 1.6984283
	speed: 0.0045s/iter; left time: 26.1686s
	iters: 500, epoch: 3 | loss: 1.4027930
	speed: 0.0045s/iter; left time: 25.6984s
	iters: 600, epoch: 3 | loss: 0.4198269
	speed: 0.0047s/iter; left time: 25.9648s
	iters: 700, epoch: 3 | loss: 0.5081851
	speed: 0.0044s/iter; left time: 24.2695s
	iters: 800, epoch: 3 | loss: 0.4601338
	speed: 0.0044s/iter; left time: 23.7962s
	iters: 900, epoch: 3 | loss: 0.4165072
	speed: 0.0046s/iter; left time: 24.1880s
	iters: 1000, epoch: 3 | loss: 1.1946032
	speed: 0.0046s/iter; left time: 23.5342s
Updating learning rate to 8.931631775e-05
Validation loss decreased (0.3741 --> 0.3690).  Saving model state dict ...
Epoch: 3 cost time: 4.748514652252197
Epoch: 3, Steps: 1027 | Train Loss: 0.7762582 Vali Loss: 0.3690340 Best vali loss: 0.3690340

best validation loss 0.36903396891704476

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018669872649, 'e_layers': 4, 'learning_rate': 0.0003660647998, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0066047
	speed: 0.0111s/iter; left time: 89.7824s
	iters: 200, epoch: 1 | loss: 0.4205010
	speed: 0.0048s/iter; left time: 38.3287s
	iters: 300, epoch: 1 | loss: 0.5836881
	speed: 0.0049s/iter; left time: 38.4517s
	iters: 400, epoch: 1 | loss: 0.2447051
	speed: 0.0051s/iter; left time: 39.8595s
	iters: 500, epoch: 1 | loss: 0.3471048
	speed: 0.0050s/iter; left time: 38.6745s
	iters: 600, epoch: 1 | loss: 1.0587192
	speed: 0.0051s/iter; left time: 38.8986s
	iters: 700, epoch: 1 | loss: 0.5019664
	speed: 0.0051s/iter; left time: 38.3620s
	iters: 800, epoch: 1 | loss: 0.9278569
	speed: 0.0051s/iter; left time: 37.9123s
	iters: 900, epoch: 1 | loss: 0.3183278
	speed: 0.0051s/iter; left time: 36.9543s
	iters: 1000, epoch: 1 | loss: 0.2165183
	speed: 0.0051s/iter; left time: 36.6478s
Updating learning rate to 0.0003660647998
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 5.510372877120972
Epoch: 1, Steps: 1027 | Train Loss: 0.5625992 Vali Loss: 0.3756981 Best vali loss: 0.3756981
	iters: 100, epoch: 2 | loss: 0.3455378
	speed: 0.0127s/iter; left time: 89.8543s
	iters: 200, epoch: 2 | loss: 0.5015475
	speed: 0.0048s/iter; left time: 33.3161s
	iters: 300, epoch: 2 | loss: 0.4712987
	speed: 0.0048s/iter; left time: 33.0590s
	iters: 400, epoch: 2 | loss: 0.2748958
	speed: 0.0048s/iter; left time: 32.4118s
	iters: 500, epoch: 2 | loss: 0.2103125
	speed: 0.0047s/iter; left time: 31.7124s
	iters: 600, epoch: 2 | loss: 0.3038118
	speed: 0.0047s/iter; left time: 30.6833s
	iters: 700, epoch: 2 | loss: 0.2195117
	speed: 0.0047s/iter; left time: 30.6653s
	iters: 800, epoch: 2 | loss: 0.7632483
	speed: 0.0047s/iter; left time: 30.3023s
	iters: 900, epoch: 2 | loss: 1.3701125
	speed: 0.0047s/iter; left time: 29.7654s
	iters: 1000, epoch: 2 | loss: 0.3103357
	speed: 0.0047s/iter; left time: 29.1018s
Updating learning rate to 0.0001830323999
Epoch: 2 cost time: 4.91606068611145
Epoch: 2, Steps: 1027 | Train Loss: 0.4770612 Vali Loss: 0.3798299 Best vali loss: 0.3756981
	iters: 100, epoch: 3 | loss: 0.4328149
	speed: 0.0126s/iter; left time: 76.3886s
	iters: 200, epoch: 3 | loss: 0.8954272
	speed: 0.0048s/iter; left time: 28.4007s
	iters: 300, epoch: 3 | loss: 0.3371831
	speed: 0.0047s/iter; left time: 27.6354s
	iters: 400, epoch: 3 | loss: 1.7746334
	speed: 0.0047s/iter; left time: 27.0694s
	iters: 500, epoch: 3 | loss: 1.5182098
	speed: 0.0047s/iter; left time: 26.8026s
	iters: 600, epoch: 3 | loss: 0.4576735
	speed: 0.0047s/iter; left time: 26.3407s
	iters: 700, epoch: 3 | loss: 0.4500257
	speed: 0.0047s/iter; left time: 25.8321s
	iters: 800, epoch: 3 | loss: 0.4786811
	speed: 0.0047s/iter; left time: 25.3700s
	iters: 900, epoch: 3 | loss: 0.4424927
	speed: 0.0047s/iter; left time: 24.8593s
	iters: 1000, epoch: 3 | loss: 1.3130611
	speed: 0.0047s/iter; left time: 24.0096s
Updating learning rate to 9.151619995e-05
Epoch: 3 cost time: 4.879334926605225
Epoch: 3, Steps: 1027 | Train Loss: 0.8100203 Vali Loss: 0.3806426 Best vali loss: 0.3756981

best validation loss 0.37569808755618883

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019667911728, 'e_layers': 4, 'learning_rate': 0.000357265271, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4433478
	speed: 0.0116s/iter; left time: 58.6590s
	iters: 200, epoch: 4 | loss: 0.4042616
	speed: 0.0053s/iter; left time: 25.9331s
	iters: 300, epoch: 4 | loss: 0.4339460
	speed: 0.0053s/iter; left time: 25.4250s
	iters: 400, epoch: 4 | loss: 0.2243202
	speed: 0.0051s/iter; left time: 23.9711s
	iters: 500, epoch: 4 | loss: 0.2995193
	speed: 0.0051s/iter; left time: 23.5217s
	iters: 600, epoch: 4 | loss: 0.4459698
	speed: 0.0052s/iter; left time: 23.5683s
	iters: 700, epoch: 4 | loss: 0.4092508
	speed: 0.0051s/iter; left time: 22.4594s
	iters: 800, epoch: 4 | loss: 0.7936629
	speed: 0.0051s/iter; left time: 21.9828s
	iters: 900, epoch: 4 | loss: 0.2908054
	speed: 0.0051s/iter; left time: 21.4841s
	iters: 1000, epoch: 4 | loss: 0.1848935
	speed: 0.0051s/iter; left time: 21.2865s
Updating learning rate to 4.4658158875e-05
Epoch: 4 cost time: 5.631466865539551
Epoch: 4, Steps: 1027 | Train Loss: 0.3929977 Vali Loss: 0.3713935 Best vali loss: 0.3690340
	iters: 100, epoch: 5 | loss: 0.3298185
	speed: 0.0129s/iter; left time: 51.8367s
	iters: 200, epoch: 5 | loss: 0.3143829
	speed: 0.0050s/iter; left time: 19.5344s
	iters: 300, epoch: 5 | loss: 0.3910075
	speed: 0.0051s/iter; left time: 19.4017s
	iters: 400, epoch: 5 | loss: 0.2305933
	speed: 0.0051s/iter; left time: 18.7728s
	iters: 500, epoch: 5 | loss: 0.1904158
	speed: 0.0051s/iter; left time: 18.4164s
	iters: 600, epoch: 5 | loss: 0.3480149
	speed: 0.0051s/iter; left time: 17.7822s
	iters: 700, epoch: 5 | loss: 0.2015449
	speed: 0.0051s/iter; left time: 17.4900s
	iters: 800, epoch: 5 | loss: 0.6717799
	speed: 0.0051s/iter; left time: 16.9121s
	iters: 900, epoch: 5 | loss: 1.1893051
	speed: 0.0051s/iter; left time: 16.3303s
	iters: 1000, epoch: 5 | loss: 0.2400232
	speed: 0.0051s/iter; left time: 15.7309s
Updating learning rate to 2.23290794375e-05
Validation loss decreased (0.3690 --> 0.3543).  Saving model state dict ...
Epoch: 5 cost time: 5.24829626083374
Epoch: 5, Steps: 1027 | Train Loss: 0.4106886 Vali Loss: 0.3542781 Best vali loss: 0.3542781
	iters: 100, epoch: 6 | loss: 0.4019731
	speed: 0.0124s/iter; left time: 36.9363s
	iters: 200, epoch: 6 | loss: 0.7359868
	speed: 0.0044s/iter; left time: 12.7796s
	iters: 300, epoch: 6 | loss: 0.2938613
	speed: 0.0045s/iter; left time: 12.4251s
	iters: 400, epoch: 6 | loss: 1.4392477
	speed: 0.0044s/iter; left time: 11.8651s
	iters: 500, epoch: 6 | loss: 1.0765450
	speed: 0.0045s/iter; left time: 11.5283s
	iters: 600, epoch: 6 | loss: 0.3521718
	speed: 0.0045s/iter; left time: 11.1700s
	iters: 700, epoch: 6 | loss: 0.2530074
	speed: 0.0044s/iter; left time: 10.5692s
	iters: 800, epoch: 6 | loss: 0.4091913
	speed: 0.0045s/iter; left time: 10.1937s
	iters: 900, epoch: 6 | loss: 0.2771740
	speed: 0.0044s/iter; left time: 9.6805s
	iters: 1000, epoch: 6 | loss: 0.8616074
	speed: 0.0045s/iter; left time: 9.2871s
Updating learning rate to 1.116453971875e-05
Validation loss decreased (0.3543 --> 0.3488).  Saving model state dict ...
Epoch: 6 cost time: 4.610729217529297
Epoch: 6, Steps: 1027 | Train Loss: 0.6100766 Vali Loss: 0.3487616 Best vali loss: 0.3487616
	iters: 100, epoch: 7 | loss: 0.6959825
	speed: 0.0124s/iter; left time: 24.2759s
	iters: 200, epoch: 7 | loss: 0.2817665
	speed: 0.0047s/iter; left time: 8.6265s
	iters: 300, epoch: 7 | loss: 1.2709875
	speed: 0.0048s/iter; left time: 8.3662s
	iters: 400, epoch: 7 | loss: 0.2422708
	speed: 0.0047s/iter; left time: 7.8102s
	iters: 500, epoch: 7 | loss: 1.1370741
	speed: 0.0048s/iter; left time: 7.4130s
	iters: 600, epoch: 7 | loss: 0.3102111
	speed: 0.0047s/iter; left time: 6.8923s
	iters: 700, epoch: 7 | loss: 1.1271214
	speed: 0.0048s/iter; left time: 6.5487s
	iters: 800, epoch: 7 | loss: 0.4408079
	speed: 0.0049s/iter; left time: 6.1553s
	iters: 900, epoch: 7 | loss: 0.3635127
	speed: 0.0047s/iter; left time: 5.4823s
	iters: 1000, epoch: 7 | loss: 0.3013412
	speed: 0.0048s/iter; left time: 5.0297s
Updating learning rate to 5.582269859375e-06
Epoch: 7 cost time: 4.921496868133545
Epoch: 7, Steps: 1027 | Train Loss: 0.6171076 Vali Loss: 0.3552416 Best vali loss: 0.3487616
	iters: 100, epoch: 8 | loss: 0.2597279
	speed: 0.0124s/iter; left time: 11.4654s
	iters: 200, epoch: 8 | loss: 0.4209038
	speed: 0.0044s/iter; left time: 3.6173s
	iters: 300, epoch: 8 | loss: 0.5632671
	speed: 0.0044s/iter; left time: 3.1953s
	iters: 400, epoch: 8 | loss: 0.9725460
	speed: 0.0045s/iter; left time: 2.8426s
	iters: 500, epoch: 8 | loss: 0.8838533
	speed: 0.0046s/iter; left time: 2.4065s
	iters: 600, epoch: 8 | loss: 0.2910955
	speed: 0.0043s/iter; left time: 1.8604s
	iters: 700, epoch: 8 | loss: 0.3202658
	speed: 0.0044s/iter; left time: 1.4276s
	iters: 800, epoch: 8 | loss: 0.8434353
	speed: 0.0044s/iter; left time: 0.9987s
	iters: 900, epoch: 8 | loss: 0.6147225
	speed: 0.0044s/iter; left time: 0.5585s
	iters: 1000, epoch: 8 | loss: 0.8049011
	speed: 0.0044s/iter; left time: 0.1233s
Updating learning rate to 2.7911349296875e-06
Epoch: 8 cost time: 4.568948745727539
Epoch: 8, Steps: 1027 | Train Loss: 0.5974718 Vali Loss: 0.3541265 Best vali loss: 0.3487616

best validation loss 0.3487616052913291

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010041962816, 'e_layers': 4, 'learning_rate': 7.14391959e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5847866
	speed: 0.0122s/iter; left time: 11.4173s
Updating learning rate to 6.872020340553712e-05
Validation loss decreased (inf --> 0.3873).  Saving model state dict ...
Epoch: 1 cost time: 1.1322405338287354
Epoch: 1, Steps: 129 | Train Loss: 0.5847866 Vali Loss: 0.3873342 Best vali loss: 0.3873342
	iters: 100, epoch: 2 | loss: 0.4941286
	speed: 0.0098s/iter; left time: 7.9007s
Updating learning rate to 6.09771678817021e-05
Validation loss decreased (0.3873 --> 0.3714).  Saving model state dict ...
Epoch: 2 cost time: 0.8236804008483887
Epoch: 2, Steps: 129 | Train Loss: 0.4941286 Vali Loss: 0.3713957 Best vali loss: 0.3713957
	iters: 100, epoch: 3 | loss: 0.8654892
	speed: 0.0100s/iter; left time: 6.7494s
Updating learning rate to 4.938889629620703e-05
Validation loss decreased (0.3714 --> 0.3674).  Saving model state dict ...
Epoch: 3 cost time: 0.824453592300415
Epoch: 3, Steps: 129 | Train Loss: 0.8654892 Vali Loss: 0.3673696 Best vali loss: 0.3673696
	iters: 100, epoch: 4 | loss: 0.9570566
	speed: 0.0099s/iter; left time: 5.4051s
Updating learning rate to 3.571959795e-05
Validation loss decreased (0.3674 --> 0.3651).  Saving model state dict ...
Epoch: 4 cost time: 0.819927453994751
Epoch: 4, Steps: 129 | Train Loss: 0.9570566 Vali Loss: 0.3650861 Best vali loss: 0.3650861
	iters: 100, epoch: 5 | loss: 0.7398651
	speed: 0.0098s/iter; left time: 4.0947s
Updating learning rate to 2.2050299603792978e-05
Epoch: 5 cost time: 0.818739652633667
Epoch: 5, Steps: 129 | Train Loss: 0.7398651 Vali Loss: 0.3667031 Best vali loss: 0.3650861
	iters: 100, epoch: 6 | loss: 0.8624692
	speed: 0.0090s/iter; left time: 2.6045s
Updating learning rate to 1.0462028018297901e-05
Validation loss decreased (0.3651 --> 0.3649).  Saving model state dict ...
Epoch: 6 cost time: 0.7225940227508545
Epoch: 6, Steps: 129 | Train Loss: 0.8624692 Vali Loss: 0.3649194 Best vali loss: 0.3649194
	iters: 100, epoch: 7 | loss: 0.4752918
	speed: 0.0089s/iter; left time: 1.4137s
Updating learning rate to 2.718992494462884e-06
Epoch: 7 cost time: 0.7345640659332275
Epoch: 7, Steps: 129 | Train Loss: 0.4752918 Vali Loss: 0.3653244 Best vali loss: 0.3649194
	iters: 100, epoch: 8 | loss: 0.3610517
	speed: 0.0095s/iter; left time: 0.2861s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8057551383972168
Epoch: 8, Steps: 129 | Train Loss: 0.3610517 Vali Loss: 0.3654710 Best vali loss: 0.3649194

best validation loss 0.36491936959311627

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0101899757246, 'e_layers': 3, 'learning_rate': 0.0002838424185, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002838424185
Validation loss decreased (inf --> 0.3636).  Saving model state dict ...
Epoch: 1 cost time: 1.0307071208953857
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3636100 Best vali loss: 0.3636100
Updating learning rate to 0.00014192120925
Epoch: 2 cost time: 0.7317605018615723
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3657553 Best vali loss: 0.3636100
Updating learning rate to 7.0960604625e-05
Epoch: 3 cost time: 0.7395539283752441
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4034157 Best vali loss: 0.3636100
Updating learning rate to 3.54803023125e-05
Epoch: 4 cost time: 0.7340049743652344
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3757268 Best vali loss: 0.3636100
Updating learning rate to 1.774015115625e-05
Epoch: 5 cost time: 0.7313718795776367
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4113842 Best vali loss: 0.3636100
Updating learning rate to 8.870075578125e-06
Epoch: 6 cost time: 0.7332713603973389
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3980793 Best vali loss: 0.3636100
Updating learning rate to 4.4350377890625e-06
Epoch: 7 cost time: 0.7429661750793457
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4037885 Best vali loss: 0.3636100
Updating learning rate to 2.21751889453125e-06
Epoch: 8 cost time: 0.7380275726318359
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4063377 Best vali loss: 0.3636100

best validation loss 0.36360998369153213

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0041733291724, 'e_layers': 4, 'learning_rate': 5.79796906e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3387227
	speed: 0.0116s/iter; left time: 46.5793s
	iters: 200, epoch: 1 | loss: 0.5845357
	speed: 0.0053s/iter; left time: 20.5702s
	iters: 300, epoch: 1 | loss: 0.4341433
	speed: 0.0052s/iter; left time: 19.7967s
	iters: 400, epoch: 1 | loss: 0.3863855
	speed: 0.0052s/iter; left time: 19.3426s
	iters: 500, epoch: 1 | loss: 0.4402210
	speed: 0.0052s/iter; left time: 18.8623s
Updating learning rate to 5.577297002333852e-05
Validation loss decreased (inf --> 0.4074).  Saving model state dict ...
Epoch: 1 cost time: 3.0429294109344482
Epoch: 1, Steps: 514 | Train Loss: 0.4368016 Vali Loss: 0.4074083 Best vali loss: 0.4074083
	iters: 100, epoch: 2 | loss: 0.4571906
	speed: 0.0098s/iter; left time: 34.1229s
	iters: 200, epoch: 2 | loss: 0.3953182
	speed: 0.0045s/iter; left time: 15.1887s
	iters: 300, epoch: 2 | loss: 1.0367985
	speed: 0.0047s/iter; left time: 15.3770s
	iters: 400, epoch: 2 | loss: 0.5145920
	speed: 0.0046s/iter; left time: 14.8230s
	iters: 500, epoch: 2 | loss: 0.3856578
	speed: 0.0046s/iter; left time: 14.3310s
Updating learning rate to 4.948876149717896e-05
Validation loss decreased (0.4074 --> 0.3952).  Saving model state dict ...
Epoch: 2 cost time: 2.4265739917755127
Epoch: 2, Steps: 514 | Train Loss: 0.5579114 Vali Loss: 0.3951703 Best vali loss: 0.3951703
	iters: 100, epoch: 3 | loss: 0.4438396
	speed: 0.0099s/iter; left time: 29.4248s
	iters: 200, epoch: 3 | loss: 0.8123970
	speed: 0.0052s/iter; left time: 14.8772s
	iters: 300, epoch: 3 | loss: 0.3764243
	speed: 0.0052s/iter; left time: 14.4047s
	iters: 400, epoch: 3 | loss: 0.5388693
	speed: 0.0050s/iter; left time: 13.4342s
	iters: 500, epoch: 3 | loss: 0.2679783
	speed: 0.0049s/iter; left time: 12.7770s
Updating learning rate to 4.0083778803136966e-05
Validation loss decreased (0.3952 --> 0.3872).  Saving model state dict ...
Epoch: 3 cost time: 2.662360906600952
Epoch: 3, Steps: 514 | Train Loss: 0.4879017 Vali Loss: 0.3872207 Best vali loss: 0.3872207

best validation loss 0.38722070856038154

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010588024745, 'e_layers': 3, 'learning_rate': 0.0003993425607, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6230491
	speed: 0.0106s/iter; left time: 42.6237s
	iters: 200, epoch: 1 | loss: 0.6597723
	speed: 0.0044s/iter; left time: 17.2847s
	iters: 300, epoch: 1 | loss: 0.2844018
	speed: 0.0045s/iter; left time: 16.9722s
	iters: 400, epoch: 1 | loss: 0.5542564
	speed: 0.0044s/iter; left time: 16.4123s
	iters: 500, epoch: 1 | loss: 1.1087433
	speed: 0.0044s/iter; left time: 15.9059s
Updating learning rate to 0.0003993425607
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 2.625459671020508
Epoch: 1, Steps: 514 | Train Loss: 0.6460446 Vali Loss: 0.3716829 Best vali loss: 0.3716829
	iters: 100, epoch: 2 | loss: 0.3784952
	speed: 0.0090s/iter; left time: 31.4491s
	iters: 200, epoch: 2 | loss: 0.4925903
	speed: 0.0043s/iter; left time: 14.6322s
	iters: 300, epoch: 2 | loss: 0.4078297
	speed: 0.0043s/iter; left time: 14.1780s
	iters: 400, epoch: 2 | loss: 0.2885356
	speed: 0.0044s/iter; left time: 13.9481s
	iters: 500, epoch: 2 | loss: 0.2827892
	speed: 0.0044s/iter; left time: 13.6533s
Updating learning rate to 0.00019967128035
Epoch: 2 cost time: 2.279114007949829
Epoch: 2, Steps: 514 | Train Loss: 0.3700480 Vali Loss: 0.3746166 Best vali loss: 0.3716829
	iters: 100, epoch: 3 | loss: 0.3886824
	speed: 0.0088s/iter; left time: 26.3435s
	iters: 200, epoch: 3 | loss: 0.9528420
	speed: 0.0042s/iter; left time: 12.0882s
	iters: 300, epoch: 3 | loss: 0.4358689
	speed: 0.0042s/iter; left time: 11.6460s
	iters: 400, epoch: 3 | loss: 0.6340440
	speed: 0.0043s/iter; left time: 11.5887s
	iters: 500, epoch: 3 | loss: 0.3560466
	speed: 0.0042s/iter; left time: 10.9827s
Updating learning rate to 9.9835640175e-05
Validation loss decreased (0.3717 --> 0.3530).  Saving model state dict ...
Epoch: 3 cost time: 2.2271203994750977
Epoch: 3, Steps: 514 | Train Loss: 0.5534968 Vali Loss: 0.3529873 Best vali loss: 0.3529873

best validation loss 0.3529873414217606

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010584049652, 'e_layers': 3, 'learning_rate': 0.000393447632, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6096472
	speed: 0.0105s/iter; left time: 85.5687s
	iters: 200, epoch: 1 | loss: 0.5790575
	speed: 0.0043s/iter; left time: 34.3346s
	iters: 300, epoch: 1 | loss: 0.2801431
	speed: 0.0042s/iter; left time: 33.5874s
	iters: 400, epoch: 1 | loss: 1.2596701
	speed: 0.0042s/iter; left time: 33.2176s
	iters: 500, epoch: 1 | loss: 1.0981479
	speed: 0.0043s/iter; left time: 33.0567s
	iters: 600, epoch: 1 | loss: 1.0459280
	speed: 0.0042s/iter; left time: 32.2215s
	iters: 700, epoch: 1 | loss: 0.5965060
	speed: 0.0042s/iter; left time: 31.7446s
	iters: 800, epoch: 1 | loss: 0.4966141
	speed: 0.0042s/iter; left time: 31.4912s
	iters: 900, epoch: 1 | loss: 1.2577922
	speed: 0.0043s/iter; left time: 31.4261s
	iters: 1000, epoch: 1 | loss: 1.7778819
	speed: 0.0043s/iter; left time: 30.6879s
Updating learning rate to 0.000393447632
Validation loss decreased (inf --> 0.3913).  Saving model state dict ...
Epoch: 1 cost time: 4.727577209472656
Epoch: 1, Steps: 1027 | Train Loss: 0.9001388 Vali Loss: 0.3913133 Best vali loss: 0.3913133
	iters: 100, epoch: 2 | loss: 0.8407120
	speed: 0.0110s/iter; left time: 77.7093s
	iters: 200, epoch: 2 | loss: 0.6271478
	speed: 0.0037s/iter; left time: 26.1254s
	iters: 300, epoch: 2 | loss: 0.9695033
	speed: 0.0037s/iter; left time: 25.5089s
	iters: 400, epoch: 2 | loss: 1.1287839
	speed: 0.0037s/iter; left time: 25.1226s
	iters: 500, epoch: 2 | loss: 0.2354563
	speed: 0.0037s/iter; left time: 24.8875s
	iters: 600, epoch: 2 | loss: 1.3317065
	speed: 0.0040s/iter; left time: 26.0739s
	iters: 700, epoch: 2 | loss: 0.9138341
	speed: 0.0040s/iter; left time: 26.0165s
	iters: 800, epoch: 2 | loss: 0.3487934
	speed: 0.0040s/iter; left time: 25.5641s
	iters: 900, epoch: 2 | loss: 1.8117177
	speed: 0.0040s/iter; left time: 25.1003s
	iters: 1000, epoch: 2 | loss: 0.9185935
	speed: 0.0040s/iter; left time: 24.6253s
Updating learning rate to 0.000196723816
Epoch: 2 cost time: 4.009836435317993
Epoch: 2, Steps: 1027 | Train Loss: 0.9126249 Vali Loss: 0.3918238 Best vali loss: 0.3913133
	iters: 100, epoch: 3 | loss: 0.2518599
	speed: 0.0110s/iter; left time: 66.4438s
	iters: 200, epoch: 3 | loss: 0.4768533
	speed: 0.0040s/iter; left time: 23.7331s
	iters: 300, epoch: 3 | loss: 0.6653355
	speed: 0.0039s/iter; left time: 23.1585s
	iters: 400, epoch: 3 | loss: 0.3369430
	speed: 0.0039s/iter; left time: 22.5998s
	iters: 500, epoch: 3 | loss: 0.4458653
	speed: 0.0039s/iter; left time: 22.3681s
	iters: 600, epoch: 3 | loss: 0.8031877
	speed: 0.0040s/iter; left time: 22.1368s
	iters: 700, epoch: 3 | loss: 1.0219035
	speed: 0.0039s/iter; left time: 21.5192s
	iters: 800, epoch: 3 | loss: 1.1335106
	speed: 0.0040s/iter; left time: 21.2044s
	iters: 900, epoch: 3 | loss: 0.3596145
	speed: 0.0040s/iter; left time: 20.8175s
	iters: 1000, epoch: 3 | loss: 0.3892997
	speed: 0.0040s/iter; left time: 20.5433s
Updating learning rate to 9.8361908e-05
Validation loss decreased (0.3913 --> 0.3828).  Saving model state dict ...
Epoch: 3 cost time: 4.111072063446045
Epoch: 3, Steps: 1027 | Train Loss: 0.5884373 Vali Loss: 0.3827709 Best vali loss: 0.3827709

best validation loss 0.38277086336860955

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010588024745, 'e_layers': 3, 'learning_rate': 0.0003993425607, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5412797
	speed: 0.0108s/iter; left time: 26.7269s
	iters: 200, epoch: 4 | loss: 0.4793544
	speed: 0.0043s/iter; left time: 10.2343s
	iters: 300, epoch: 4 | loss: 0.2292155
	speed: 0.0045s/iter; left time: 10.2377s
	iters: 400, epoch: 4 | loss: 0.4486555
	speed: 0.0045s/iter; left time: 9.8114s
	iters: 500, epoch: 4 | loss: 0.8192329
	speed: 0.0045s/iter; left time: 9.3675s
Updating learning rate to 4.99178200875e-05
Validation loss decreased (0.3530 --> 0.3437).  Saving model state dict ...
Epoch: 4 cost time: 2.636611223220825
Epoch: 4, Steps: 514 | Train Loss: 0.5035476 Vali Loss: 0.3436932 Best vali loss: 0.3436932
	iters: 100, epoch: 5 | loss: 0.3124236
	speed: 0.0092s/iter; left time: 17.9066s
	iters: 200, epoch: 5 | loss: 0.3776995
	speed: 0.0044s/iter; left time: 8.2277s
	iters: 300, epoch: 5 | loss: 0.3810948
	speed: 0.0044s/iter; left time: 7.7176s
	iters: 400, epoch: 5 | loss: 0.2622103
	speed: 0.0043s/iter; left time: 7.1912s
	iters: 500, epoch: 5 | loss: 0.2749191
	speed: 0.0045s/iter; left time: 6.9714s
Updating learning rate to 2.495891004375e-05
Epoch: 5 cost time: 2.317319631576538
Epoch: 5, Steps: 514 | Train Loss: 0.3216695 Vali Loss: 0.3461529 Best vali loss: 0.3436932
	iters: 100, epoch: 6 | loss: 0.2832836
	speed: 0.0087s/iter; left time: 12.5285s
	iters: 200, epoch: 6 | loss: 0.6619110
	speed: 0.0044s/iter; left time: 5.9051s
	iters: 300, epoch: 6 | loss: 0.3534025
	speed: 0.0042s/iter; left time: 5.2602s
	iters: 400, epoch: 6 | loss: 0.4882400
	speed: 0.0043s/iter; left time: 4.8841s
	iters: 500, epoch: 6 | loss: 0.3130052
	speed: 0.0042s/iter; left time: 4.3520s
Updating learning rate to 1.2479455021875e-05
Validation loss decreased (0.3437 --> 0.3426).  Saving model state dict ...
Epoch: 6 cost time: 2.2202935218811035
Epoch: 6, Steps: 514 | Train Loss: 0.4199685 Vali Loss: 0.3425775 Best vali loss: 0.3425775
	iters: 100, epoch: 7 | loss: 1.0096523
	speed: 0.0085s/iter; left time: 7.9254s
	iters: 200, epoch: 7 | loss: 0.7960485
	speed: 0.0040s/iter; left time: 3.3160s
	iters: 300, epoch: 7 | loss: 0.4152960
	speed: 0.0040s/iter; left time: 2.8991s
	iters: 400, epoch: 7 | loss: 0.4765195
	speed: 0.0041s/iter; left time: 2.5564s
	iters: 500, epoch: 7 | loss: 0.6012542
	speed: 0.0039s/iter; left time: 2.0750s
Updating learning rate to 6.2397275109375e-06
Validation loss decreased (0.3426 --> 0.3425).  Saving model state dict ...
Epoch: 7 cost time: 2.091085433959961
Epoch: 7, Steps: 514 | Train Loss: 0.6597541 Vali Loss: 0.3424866 Best vali loss: 0.3424866
	iters: 100, epoch: 8 | loss: 0.2064957
	speed: 0.0088s/iter; left time: 3.6333s
	iters: 200, epoch: 8 | loss: 0.2666349
	speed: 0.0040s/iter; left time: 1.2626s
	iters: 300, epoch: 8 | loss: 0.2800139
	speed: 0.0040s/iter; left time: 0.8701s
	iters: 400, epoch: 8 | loss: 0.5590452
	speed: 0.0040s/iter; left time: 0.4544s
	iters: 500, epoch: 8 | loss: 0.3591927
	speed: 0.0041s/iter; left time: 0.0611s
Updating learning rate to 3.11986375546875e-06
Validation loss decreased (0.3425 --> 0.3412).  Saving model state dict ...
Epoch: 8 cost time: 2.118255376815796
Epoch: 8, Steps: 514 | Train Loss: 0.3342765 Vali Loss: 0.3412238 Best vali loss: 0.3412238

best validation loss 0.34122383322837546

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022144720903, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3661).  Saving model state dict ...
Epoch: 1 cost time: 0.7709794044494629
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3661482 Best vali loss: 0.3661482
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.4566349983215332
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703546 Best vali loss: 0.3661482
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.4511070251464844
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3684012 Best vali loss: 0.3661482
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3661 --> 0.3601).  Saving model state dict ...
Epoch: 4 cost time: 0.4572632312774658
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3601397 Best vali loss: 0.3601397
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.4487137794494629
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3671399 Best vali loss: 0.3601397
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.4488387107849121
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3658606 Best vali loss: 0.3601397
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.4514026641845703
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3637606 Best vali loss: 0.3601397
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.4495975971221924
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3642515 Best vali loss: 0.3601397

best validation loss 0.3601397123926983

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010516138136, 'e_layers': 3, 'learning_rate': 0.0002875147127, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2674867
	speed: 0.0104s/iter; left time: 84.5947s
	iters: 200, epoch: 1 | loss: 0.2401122
	speed: 0.0041s/iter; left time: 32.5629s
	iters: 300, epoch: 1 | loss: 0.4311384
	speed: 0.0040s/iter; left time: 31.9775s
	iters: 400, epoch: 1 | loss: 1.0407605
	speed: 0.0040s/iter; left time: 30.9677s
	iters: 500, epoch: 1 | loss: 0.5476694
	speed: 0.0040s/iter; left time: 30.6588s
	iters: 600, epoch: 1 | loss: 0.8469661
	speed: 0.0040s/iter; left time: 30.4141s
	iters: 700, epoch: 1 | loss: 0.9388517
	speed: 0.0039s/iter; left time: 29.4240s
	iters: 800, epoch: 1 | loss: 0.3708572
	speed: 0.0039s/iter; left time: 28.9738s
	iters: 900, epoch: 1 | loss: 0.4371051
	speed: 0.0041s/iter; left time: 30.3623s
	iters: 1000, epoch: 1 | loss: 0.4194340
	speed: 0.0043s/iter; left time: 30.8817s
Updating learning rate to 0.0002875147127
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 4.510828495025635
Epoch: 1, Steps: 1027 | Train Loss: 0.5540381 Vali Loss: 0.3747905 Best vali loss: 0.3747905
	iters: 100, epoch: 2 | loss: 0.5741366
	speed: 0.0114s/iter; left time: 81.0106s
	iters: 200, epoch: 2 | loss: 0.2156507
	speed: 0.0040s/iter; left time: 27.9649s
	iters: 300, epoch: 2 | loss: 0.4717964
	speed: 0.0040s/iter; left time: 27.6264s
	iters: 400, epoch: 2 | loss: 0.2812054
	speed: 0.0040s/iter; left time: 27.1606s
	iters: 500, epoch: 2 | loss: 1.1176053
	speed: 0.0040s/iter; left time: 26.8178s
	iters: 600, epoch: 2 | loss: 0.3631289
	speed: 0.0040s/iter; left time: 26.3391s
	iters: 700, epoch: 2 | loss: 0.6266281
	speed: 0.0040s/iter; left time: 25.8811s
	iters: 800, epoch: 2 | loss: 0.5138023
	speed: 0.0040s/iter; left time: 25.5272s
	iters: 900, epoch: 2 | loss: 1.0215951
	speed: 0.0040s/iter; left time: 25.1616s
	iters: 1000, epoch: 2 | loss: 0.7010919
	speed: 0.0040s/iter; left time: 24.7032s
Updating learning rate to 0.00014375735635
Epoch: 2 cost time: 4.150382041931152
Epoch: 2, Steps: 1027 | Train Loss: 0.5886641 Vali Loss: 0.3891692 Best vali loss: 0.3747905
	iters: 100, epoch: 3 | loss: 0.8169241
	speed: 0.0108s/iter; left time: 65.3237s
	iters: 200, epoch: 3 | loss: 0.3278600
	speed: 0.0039s/iter; left time: 22.9714s
	iters: 300, epoch: 3 | loss: 0.2532520
	speed: 0.0038s/iter; left time: 22.3408s
	iters: 400, epoch: 3 | loss: 0.1919029
	speed: 0.0037s/iter; left time: 21.0459s
	iters: 500, epoch: 3 | loss: 1.0988386
	speed: 0.0036s/iter; left time: 20.6091s
	iters: 600, epoch: 3 | loss: 0.2286809
	speed: 0.0039s/iter; left time: 21.5207s
	iters: 700, epoch: 3 | loss: 0.5669801
	speed: 0.0037s/iter; left time: 20.1077s
	iters: 800, epoch: 3 | loss: 0.3126910
	speed: 0.0036s/iter; left time: 19.4015s
	iters: 900, epoch: 3 | loss: 0.7612587
	speed: 0.0036s/iter; left time: 18.9851s
	iters: 1000, epoch: 3 | loss: 0.6037383
	speed: 0.0036s/iter; left time: 18.6952s
Updating learning rate to 7.1878678175e-05
Validation loss decreased (0.3748 --> 0.3741).  Saving model state dict ...
Epoch: 3 cost time: 3.8628835678100586
Epoch: 3, Steps: 1027 | Train Loss: 0.5162127 Vali Loss: 0.3741402 Best vali loss: 0.3741402
	iters: 100, epoch: 4 | loss: 0.3947005
	speed: 0.0108s/iter; left time: 54.4702s
	iters: 200, epoch: 4 | loss: 1.6753768
	speed: 0.0037s/iter; left time: 18.0858s
	iters: 300, epoch: 4 | loss: 0.6217761
	speed: 0.0037s/iter; left time: 17.7881s
	iters: 400, epoch: 4 | loss: 0.5310247
	speed: 0.0036s/iter; left time: 17.1206s
	iters: 500, epoch: 4 | loss: 1.0626482
	speed: 0.0036s/iter; left time: 16.9042s
	iters: 600, epoch: 4 | loss: 1.0312595
	speed: 0.0036s/iter; left time: 16.4454s
	iters: 700, epoch: 4 | loss: 0.8591002
	speed: 0.0036s/iter; left time: 15.9363s
	iters: 800, epoch: 4 | loss: 0.3557427
	speed: 0.0036s/iter; left time: 15.6620s
	iters: 900, epoch: 4 | loss: 2.1060708
	speed: 0.0036s/iter; left time: 15.2553s
	iters: 1000, epoch: 4 | loss: 1.4020325
	speed: 0.0036s/iter; left time: 14.8231s
Updating learning rate to 3.59393390875e-05
Epoch: 4 cost time: 3.7702863216400146
Epoch: 4, Steps: 1027 | Train Loss: 1.0039732 Vali Loss: 0.3746315 Best vali loss: 0.3741402
	iters: 100, epoch: 5 | loss: 0.2038739
	speed: 0.0106s/iter; left time: 42.4159s
	iters: 200, epoch: 5 | loss: 0.6587169
	speed: 0.0036s/iter; left time: 14.1537s
	iters: 300, epoch: 5 | loss: 0.3593169
	speed: 0.0037s/iter; left time: 13.9085s
	iters: 400, epoch: 5 | loss: 0.3003780
	speed: 0.0036s/iter; left time: 13.5086s
	iters: 500, epoch: 5 | loss: 0.4235729
	speed: 0.0036s/iter; left time: 13.1502s
	iters: 600, epoch: 5 | loss: 0.4875986
	speed: 0.0037s/iter; left time: 12.8663s
	iters: 700, epoch: 5 | loss: 0.6583952
	speed: 0.0036s/iter; left time: 12.4063s
	iters: 800, epoch: 5 | loss: 1.1248951
	speed: 0.0036s/iter; left time: 12.0292s
	iters: 900, epoch: 5 | loss: 0.7633628
	speed: 0.0037s/iter; left time: 11.7181s
	iters: 1000, epoch: 5 | loss: 0.4030728
	speed: 0.0037s/iter; left time: 11.4035s
Updating learning rate to 1.796966954375e-05
Epoch: 5 cost time: 3.7807459831237793
Epoch: 5, Steps: 1027 | Train Loss: 0.5383183 Vali Loss: 0.3762163 Best vali loss: 0.3741402
	iters: 100, epoch: 6 | loss: 0.4857740
	speed: 0.0108s/iter; left time: 32.0620s
	iters: 200, epoch: 6 | loss: 0.2173379
	speed: 0.0036s/iter; left time: 10.4712s
	iters: 300, epoch: 6 | loss: 0.2979728
	speed: 0.0038s/iter; left time: 10.5465s
	iters: 400, epoch: 6 | loss: 0.7965317
	speed: 0.0037s/iter; left time: 9.8616s
	iters: 500, epoch: 6 | loss: 0.3021695
	speed: 0.0036s/iter; left time: 9.3151s
	iters: 600, epoch: 6 | loss: 0.4877291
	speed: 0.0036s/iter; left time: 9.0188s
	iters: 700, epoch: 6 | loss: 0.7755721
	speed: 0.0037s/iter; left time: 8.8481s
	iters: 800, epoch: 6 | loss: 0.5700132
	speed: 0.0038s/iter; left time: 8.7144s
	iters: 900, epoch: 6 | loss: 0.4987859
	speed: 0.0036s/iter; left time: 7.8329s
	iters: 1000, epoch: 6 | loss: 0.3326963
	speed: 0.0038s/iter; left time: 7.9392s
Updating learning rate to 8.984834771875e-06
Epoch: 6 cost time: 3.8373098373413086
Epoch: 6, Steps: 1027 | Train Loss: 0.4764583 Vali Loss: 0.3809780 Best vali loss: 0.3741402
	iters: 100, epoch: 7 | loss: 1.5322380
	speed: 0.0107s/iter; left time: 20.8952s
	iters: 200, epoch: 7 | loss: 0.7498985
	speed: 0.0037s/iter; left time: 6.7897s
	iters: 300, epoch: 7 | loss: 0.2036264
	speed: 0.0036s/iter; left time: 6.3553s
	iters: 400, epoch: 7 | loss: 0.2909668
	speed: 0.0036s/iter; left time: 6.0263s
	iters: 500, epoch: 7 | loss: 0.2346834
	speed: 0.0036s/iter; left time: 5.6180s
	iters: 600, epoch: 7 | loss: 0.4167298
	speed: 0.0036s/iter; left time: 5.2685s
	iters: 700, epoch: 7 | loss: 0.2796744
	speed: 0.0036s/iter; left time: 4.9001s
	iters: 800, epoch: 7 | loss: 0.3341002
	speed: 0.0036s/iter; left time: 4.5661s
	iters: 900, epoch: 7 | loss: 1.2804989
	speed: 0.0037s/iter; left time: 4.2661s
	iters: 1000, epoch: 7 | loss: 0.8035436
	speed: 0.0037s/iter; left time: 3.8931s
Updating learning rate to 4.4924173859375e-06
Epoch: 7 cost time: 3.7897112369537354
Epoch: 7, Steps: 1027 | Train Loss: 0.6125960 Vali Loss: 0.3850492 Best vali loss: 0.3741402
	iters: 100, epoch: 8 | loss: 0.4459820
	speed: 0.0105s/iter; left time: 9.7127s
	iters: 200, epoch: 8 | loss: 0.3687218
	speed: 0.0036s/iter; left time: 2.9497s
	iters: 300, epoch: 8 | loss: 0.4662018
	speed: 0.0036s/iter; left time: 2.5904s
	iters: 400, epoch: 8 | loss: 0.5732688
	speed: 0.0036s/iter; left time: 2.2457s
	iters: 500, epoch: 8 | loss: 0.6989793
	speed: 0.0036s/iter; left time: 1.8801s
	iters: 600, epoch: 8 | loss: 0.3957579
	speed: 0.0036s/iter; left time: 1.5273s
	iters: 700, epoch: 8 | loss: 0.3368444
	speed: 0.0036s/iter; left time: 1.1737s
	iters: 800, epoch: 8 | loss: 0.9445219
	speed: 0.0036s/iter; left time: 0.8185s
	iters: 900, epoch: 8 | loss: 0.2988782
	speed: 0.0036s/iter; left time: 0.4557s
	iters: 1000, epoch: 8 | loss: 0.8651336
	speed: 0.0036s/iter; left time: 0.1003s
Updating learning rate to 2.24620869296875e-06
Epoch: 8 cost time: 3.7079734802246094
Epoch: 8, Steps: 1027 | Train Loss: 0.5394290 Vali Loss: 0.3833900 Best vali loss: 0.3741402

best validation loss 0.37414019592033154

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015386576352, 'e_layers': 3, 'learning_rate': 0.0018412457, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3739593
	speed: 0.0099s/iter; left time: 39.7175s
	iters: 200, epoch: 1 | loss: 0.4135385
	speed: 0.0039s/iter; left time: 15.4172s
	iters: 300, epoch: 1 | loss: 0.4435415
	speed: 0.0039s/iter; left time: 14.7912s
	iters: 400, epoch: 1 | loss: 0.4979002
	speed: 0.0039s/iter; left time: 14.3897s
	iters: 500, epoch: 1 | loss: 0.6676370
	speed: 0.0040s/iter; left time: 14.4310s
Updating learning rate to 0.0017711674582772084
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 2.3572018146514893
Epoch: 1, Steps: 514 | Train Loss: 0.4793153 Vali Loss: 0.3721923 Best vali loss: 0.3721923
	iters: 100, epoch: 2 | loss: 0.3471973
	speed: 0.0085s/iter; left time: 29.8168s
	iters: 200, epoch: 2 | loss: 0.5285733
	speed: 0.0042s/iter; left time: 14.2429s
	iters: 300, epoch: 2 | loss: 0.7577365
	speed: 0.0040s/iter; left time: 13.2811s
	iters: 400, epoch: 2 | loss: 0.6624756
	speed: 0.0038s/iter; left time: 12.2941s
	iters: 500, epoch: 2 | loss: 0.5210364
	speed: 0.0038s/iter; left time: 11.6482s
Updating learning rate to 0.0015716015101502857
Epoch: 2 cost time: 2.0834298133850098
Epoch: 2, Steps: 514 | Train Loss: 0.5634038 Vali Loss: 0.3888991 Best vali loss: 0.3721923
	iters: 100, epoch: 3 | loss: 1.3035986
	speed: 0.0079s/iter; left time: 23.6083s
	iters: 200, epoch: 3 | loss: 0.7483082
	speed: 0.0039s/iter; left time: 11.1308s
	iters: 300, epoch: 3 | loss: 0.4904434
	speed: 0.0038s/iter; left time: 10.5945s
	iters: 400, epoch: 3 | loss: 0.3764234
	speed: 0.0039s/iter; left time: 10.4037s
	iters: 500, epoch: 3 | loss: 0.2667610
	speed: 0.0038s/iter; left time: 9.8708s
Updating learning rate to 0.0012729299621517312
Validation loss decreased (0.3722 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 2.0116899013519287
Epoch: 3, Steps: 514 | Train Loss: 0.6371069 Vali Loss: 0.3639136 Best vali loss: 0.3639136

best validation loss 0.3639135871748559

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0027312332642, 'e_layers': 3, 'learning_rate': 0.0004283505491, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6086630
	speed: 0.0105s/iter; left time: 85.1459s
	iters: 200, epoch: 1 | loss: 0.3709775
	speed: 0.0043s/iter; left time: 34.4108s
	iters: 300, epoch: 1 | loss: 1.1286795
	speed: 0.0043s/iter; left time: 34.3728s
	iters: 400, epoch: 1 | loss: 0.2401397
	speed: 0.0044s/iter; left time: 34.2142s
	iters: 500, epoch: 1 | loss: 0.8116965
	speed: 0.0043s/iter; left time: 33.5503s
	iters: 600, epoch: 1 | loss: 0.5369412
	speed: 0.0044s/iter; left time: 33.1870s
	iters: 700, epoch: 1 | loss: 0.3611342
	speed: 0.0043s/iter; left time: 32.6489s
	iters: 800, epoch: 1 | loss: 0.3508397
	speed: 0.0043s/iter; left time: 32.1786s
	iters: 900, epoch: 1 | loss: 1.1384205
	speed: 0.0043s/iter; left time: 31.7102s
	iters: 1000, epoch: 1 | loss: 1.0345781
	speed: 0.0043s/iter; left time: 31.1845s
Updating learning rate to 0.00041204742707673045
Validation loss decreased (inf --> 0.3979).  Saving model state dict ...
Epoch: 1 cost time: 4.80584454536438
Epoch: 1, Steps: 1027 | Train Loss: 0.6582070 Vali Loss: 0.3979278 Best vali loss: 0.3979278
	iters: 100, epoch: 2 | loss: 1.2800291
	speed: 0.0117s/iter; left time: 83.0242s
	iters: 200, epoch: 2 | loss: 0.3400180
	speed: 0.0043s/iter; left time: 30.0438s
	iters: 300, epoch: 2 | loss: 0.4345222
	speed: 0.0043s/iter; left time: 29.8885s
	iters: 400, epoch: 2 | loss: 1.1816438
	speed: 0.0043s/iter; left time: 29.4733s
	iters: 500, epoch: 2 | loss: 0.5848901
	speed: 0.0043s/iter; left time: 28.5273s
	iters: 600, epoch: 2 | loss: 0.7735202
	speed: 0.0041s/iter; left time: 26.8828s
	iters: 700, epoch: 2 | loss: 0.9511275
	speed: 0.0042s/iter; left time: 27.4722s
	iters: 800, epoch: 2 | loss: 0.5667131
	speed: 0.0043s/iter; left time: 27.3817s
	iters: 900, epoch: 2 | loss: 0.9873578
	speed: 0.0043s/iter; left time: 27.0729s
	iters: 1000, epoch: 2 | loss: 1.5970093
	speed: 0.0043s/iter; left time: 26.6930s
Updating learning rate to 0.0003656200635467956
Epoch: 2 cost time: 4.42389440536499
Epoch: 2, Steps: 1027 | Train Loss: 0.8696831 Vali Loss: 0.4001509 Best vali loss: 0.3979278
	iters: 100, epoch: 3 | loss: 0.8207798
	speed: 0.0108s/iter; left time: 65.3528s
	iters: 200, epoch: 3 | loss: 0.4816121
	speed: 0.0039s/iter; left time: 23.3134s
	iters: 300, epoch: 3 | loss: 0.4761540
	speed: 0.0039s/iter; left time: 22.9225s
	iters: 400, epoch: 3 | loss: 0.4952152
	speed: 0.0040s/iter; left time: 23.0604s
	iters: 500, epoch: 3 | loss: 0.2153560
	speed: 0.0040s/iter; left time: 22.7681s
	iters: 600, epoch: 3 | loss: 1.2728906
	speed: 0.0039s/iter; left time: 21.7424s
	iters: 700, epoch: 3 | loss: 1.4259207
	speed: 0.0039s/iter; left time: 21.2325s
	iters: 800, epoch: 3 | loss: 1.4461174
	speed: 0.0038s/iter; left time: 20.3795s
	iters: 900, epoch: 3 | loss: 0.4581512
	speed: 0.0039s/iter; left time: 20.6641s
	iters: 1000, epoch: 3 | loss: 0.6673313
	speed: 0.0038s/iter; left time: 19.8399s
Updating learning rate to 0.00029613660374252945
Epoch: 3 cost time: 4.057527780532837
Epoch: 3, Steps: 1027 | Train Loss: 0.7759528 Vali Loss: 0.4082246 Best vali loss: 0.3979278

best validation loss 0.3979278190050472

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011743044857, 'e_layers': 3, 'learning_rate': 0.0012387498486, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9930404
	speed: 0.0102s/iter; left time: 40.9664s
	iters: 200, epoch: 1 | loss: 0.6037710
	speed: 0.0042s/iter; left time: 16.5657s
	iters: 300, epoch: 1 | loss: 0.4775958
	speed: 0.0043s/iter; left time: 16.5247s
	iters: 400, epoch: 1 | loss: 0.2928174
	speed: 0.0044s/iter; left time: 16.3082s
	iters: 500, epoch: 1 | loss: 1.0775908
	speed: 0.0044s/iter; left time: 15.9057s
Updating learning rate to 0.0012387498486
Validation loss decreased (inf --> 0.4018).  Saving model state dict ...
Epoch: 1 cost time: 2.5665760040283203
Epoch: 1, Steps: 514 | Train Loss: 0.6889631 Vali Loss: 0.4018281 Best vali loss: 0.4018281
	iters: 100, epoch: 2 | loss: 1.2666427
	speed: 0.0086s/iter; left time: 30.1326s
	iters: 200, epoch: 2 | loss: 0.6842672
	speed: 0.0040s/iter; left time: 13.6927s
	iters: 300, epoch: 2 | loss: 1.8105593
	speed: 0.0041s/iter; left time: 13.3817s
	iters: 400, epoch: 2 | loss: 0.7049909
	speed: 0.0041s/iter; left time: 13.0204s
	iters: 500, epoch: 2 | loss: 0.7212166
	speed: 0.0040s/iter; left time: 12.4478s
Updating learning rate to 0.0006193749243
Epoch: 2 cost time: 2.131852865219116
Epoch: 2, Steps: 514 | Train Loss: 1.0375353 Vali Loss: 0.4025936 Best vali loss: 0.4018281
	iters: 100, epoch: 3 | loss: 1.0366719
	speed: 0.0087s/iter; left time: 25.9116s
	iters: 200, epoch: 3 | loss: 0.3750912
	speed: 0.0043s/iter; left time: 12.5385s
	iters: 300, epoch: 3 | loss: 0.4117134
	speed: 0.0044s/iter; left time: 12.1261s
	iters: 400, epoch: 3 | loss: 0.7138432
	speed: 0.0042s/iter; left time: 11.3066s
	iters: 500, epoch: 3 | loss: 0.6683215
	speed: 0.0042s/iter; left time: 10.7460s
Updating learning rate to 0.00030968746215
Epoch: 3 cost time: 2.248622417449951
Epoch: 3, Steps: 514 | Train Loss: 0.6411282 Vali Loss: 0.4055128 Best vali loss: 0.4018281

best validation loss 0.4018280793266821

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015386576352, 'e_layers': 3, 'learning_rate': 0.0018412457, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3299008
	speed: 0.0104s/iter; left time: 25.7236s
	iters: 200, epoch: 4 | loss: 0.4000766
	speed: 0.0042s/iter; left time: 9.9523s
	iters: 300, epoch: 4 | loss: 0.4240786
	speed: 0.0043s/iter; left time: 9.8100s
	iters: 400, epoch: 4 | loss: 0.5148206
	speed: 0.0045s/iter; left time: 9.7006s
	iters: 500, epoch: 4 | loss: 0.6956847
	speed: 0.0043s/iter; left time: 8.8430s
Updating learning rate to 0.00092062285
Epoch: 4 cost time: 2.564099073410034
Epoch: 4, Steps: 514 | Train Loss: 0.4729123 Vali Loss: 0.3704199 Best vali loss: 0.3639136
	iters: 100, epoch: 5 | loss: 0.3395837
	speed: 0.0086s/iter; left time: 16.8626s
	iters: 200, epoch: 5 | loss: 0.5480092
	speed: 0.0043s/iter; left time: 8.0169s
	iters: 300, epoch: 5 | loss: 0.7954302
	speed: 0.0044s/iter; left time: 7.6870s
	iters: 400, epoch: 5 | loss: 0.6981631
	speed: 0.0045s/iter; left time: 7.3774s
	iters: 500, epoch: 5 | loss: 0.4667053
	speed: 0.0043s/iter; left time: 6.7431s
Updating learning rate to 0.0005683157378482688
Epoch: 5 cost time: 2.2896602153778076
Epoch: 5, Steps: 514 | Train Loss: 0.5695783 Vali Loss: 0.3708052 Best vali loss: 0.3639136
	iters: 100, epoch: 6 | loss: 1.1983808
	speed: 0.0086s/iter; left time: 12.4008s
	iters: 200, epoch: 6 | loss: 0.6731244
	speed: 0.0043s/iter; left time: 5.7545s
	iters: 300, epoch: 6 | loss: 0.4154542
	speed: 0.0044s/iter; left time: 5.4407s
	iters: 400, epoch: 6 | loss: 0.3518038
	speed: 0.0044s/iter; left time: 5.0497s
	iters: 500, epoch: 6 | loss: 0.2388102
	speed: 0.0044s/iter; left time: 4.5829s
Updating learning rate to 0.00026964418984971433
Validation loss decreased (0.3639 --> 0.3618).  Saving model state dict ...
Epoch: 6 cost time: 2.272307872772217
Epoch: 6, Steps: 514 | Train Loss: 0.5755147 Vali Loss: 0.3618275 Best vali loss: 0.3618275
	iters: 100, epoch: 7 | loss: 1.0826526
	speed: 0.0084s/iter; left time: 7.8400s
	iters: 200, epoch: 7 | loss: 0.4739529
	speed: 0.0039s/iter; left time: 3.2477s
	iters: 300, epoch: 7 | loss: 0.6456247
	speed: 0.0041s/iter; left time: 2.9944s
	iters: 400, epoch: 7 | loss: 0.5194208
	speed: 0.0044s/iter; left time: 2.7772s
	iters: 500, epoch: 7 | loss: 0.3927594
	speed: 0.0045s/iter; left time: 2.3805s
Updating learning rate to 7.007824172279155e-05
Validation loss decreased (0.3618 --> 0.3586).  Saving model state dict ...
Epoch: 7 cost time: 2.2044427394866943
Epoch: 7, Steps: 514 | Train Loss: 0.6228821 Vali Loss: 0.3585959 Best vali loss: 0.3585959
	iters: 100, epoch: 8 | loss: 0.7733676
	speed: 0.0084s/iter; left time: 3.4882s
	iters: 200, epoch: 8 | loss: 0.4377005
	speed: 0.0040s/iter; left time: 1.2496s
	iters: 300, epoch: 8 | loss: 0.4868859
	speed: 0.0038s/iter; left time: 0.8190s
	iters: 400, epoch: 8 | loss: 0.5914779
	speed: 0.0039s/iter; left time: 0.4490s
	iters: 500, epoch: 8 | loss: 0.5723827
	speed: 0.0038s/iter; left time: 0.0570s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.0439627170562744
Epoch: 8, Steps: 514 | Train Loss: 0.5723630 Vali Loss: 0.3622870 Best vali loss: 0.3585959

best validation loss 0.3585958810709783

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010557167399, 'e_layers': 4, 'learning_rate': 0.0004180314156, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5018565
	speed: 0.0114s/iter; left time: 45.8397s
	iters: 200, epoch: 1 | loss: 0.8368198
	speed: 0.0054s/iter; left time: 21.2001s
	iters: 300, epoch: 1 | loss: 0.8415090
	speed: 0.0053s/iter; left time: 20.3110s
	iters: 400, epoch: 1 | loss: 1.0896195
	speed: 0.0052s/iter; left time: 19.2601s
	iters: 500, epoch: 1 | loss: 0.4927540
	speed: 0.0053s/iter; left time: 19.0789s
Updating learning rate to 0.0004180314156
Validation loss decreased (inf --> 0.3856).  Saving model state dict ...
Epoch: 1 cost time: 3.0872232913970947
Epoch: 1, Steps: 514 | Train Loss: 0.7525118 Vali Loss: 0.3856073 Best vali loss: 0.3856073
	iters: 100, epoch: 2 | loss: 1.0515293
	speed: 0.0098s/iter; left time: 34.4103s
	iters: 200, epoch: 2 | loss: 0.6189547
	speed: 0.0049s/iter; left time: 16.6688s
	iters: 300, epoch: 2 | loss: 0.7877946
	speed: 0.0049s/iter; left time: 16.2698s
	iters: 400, epoch: 2 | loss: 0.7370635
	speed: 0.0048s/iter; left time: 15.2505s
	iters: 500, epoch: 2 | loss: 0.3431210
	speed: 0.0048s/iter; left time: 15.0140s
Updating learning rate to 0.0002090157078
Validation loss decreased (0.3856 --> 0.3713).  Saving model state dict ...
Epoch: 2 cost time: 2.5424206256866455
Epoch: 2, Steps: 514 | Train Loss: 0.7076926 Vali Loss: 0.3712787 Best vali loss: 0.3712787
	iters: 100, epoch: 3 | loss: 0.5806873
	speed: 0.0101s/iter; left time: 30.1590s
	iters: 200, epoch: 3 | loss: 0.4732624
	speed: 0.0048s/iter; left time: 13.9015s
	iters: 300, epoch: 3 | loss: 0.4664354
	speed: 0.0049s/iter; left time: 13.6289s
	iters: 400, epoch: 3 | loss: 1.1762947
	speed: 0.0048s/iter; left time: 12.8776s
	iters: 500, epoch: 3 | loss: 0.3387437
	speed: 0.0047s/iter; left time: 12.2540s
Updating learning rate to 0.0001045078539
Validation loss decreased (0.3713 --> 0.3681).  Saving model state dict ...
Epoch: 3 cost time: 2.5552215576171875
Epoch: 3, Steps: 514 | Train Loss: 0.6070847 Vali Loss: 0.3680598 Best vali loss: 0.3680598
	iters: 100, epoch: 4 | loss: 0.5438296
	speed: 0.0102s/iter; left time: 25.2752s
	iters: 200, epoch: 4 | loss: 0.5335762
	speed: 0.0053s/iter; left time: 12.5234s
	iters: 300, epoch: 4 | loss: 0.2710156
	speed: 0.0053s/iter; left time: 12.0783s
	iters: 400, epoch: 4 | loss: 0.4246863
	speed: 0.0053s/iter; left time: 11.5273s
	iters: 500, epoch: 4 | loss: 0.7836891
	speed: 0.0053s/iter; left time: 10.9022s
Updating learning rate to 5.225392695e-05
Epoch: 4 cost time: 2.755605697631836
Epoch: 4, Steps: 514 | Train Loss: 0.5113594 Vali Loss: 0.3784185 Best vali loss: 0.3680598
	iters: 100, epoch: 5 | loss: 0.5268198
	speed: 0.0100s/iter; left time: 19.5330s
	iters: 200, epoch: 5 | loss: 0.6780120
	speed: 0.0050s/iter; left time: 9.1975s
	iters: 300, epoch: 5 | loss: 0.3658142
	speed: 0.0050s/iter; left time: 8.7810s
	iters: 400, epoch: 5 | loss: 0.4361263
	speed: 0.0051s/iter; left time: 8.5277s
	iters: 500, epoch: 5 | loss: 0.6954058
	speed: 0.0051s/iter; left time: 7.9501s
Updating learning rate to 2.6126963475e-05
Epoch: 5 cost time: 2.6316909790039062
Epoch: 5, Steps: 514 | Train Loss: 0.5404356 Vali Loss: 0.3728265 Best vali loss: 0.3680598
	iters: 100, epoch: 6 | loss: 0.5923479
	speed: 0.0102s/iter; left time: 14.7258s
	iters: 200, epoch: 6 | loss: 0.6151454
	speed: 0.0054s/iter; left time: 7.2657s
	iters: 300, epoch: 6 | loss: 0.4378347
	speed: 0.0049s/iter; left time: 6.0535s
	iters: 400, epoch: 6 | loss: 0.3287561
	speed: 0.0049s/iter; left time: 5.6320s
	iters: 500, epoch: 6 | loss: 0.4779435
	speed: 0.0050s/iter; left time: 5.2135s
Updating learning rate to 1.30634817375e-05
Epoch: 6 cost time: 2.6655147075653076
Epoch: 6, Steps: 514 | Train Loss: 0.4904055 Vali Loss: 0.3732862 Best vali loss: 0.3680598
	iters: 100, epoch: 7 | loss: 0.4193795
	speed: 0.0098s/iter; left time: 9.1445s
	iters: 200, epoch: 7 | loss: 0.2944863
	speed: 0.0050s/iter; left time: 4.1117s
	iters: 300, epoch: 7 | loss: 0.3638653
	speed: 0.0047s/iter; left time: 3.4476s
	iters: 400, epoch: 7 | loss: 0.6018859
	speed: 0.0050s/iter; left time: 3.1535s
	iters: 500, epoch: 7 | loss: 0.4449945
	speed: 0.0049s/iter; left time: 2.6023s
Updating learning rate to 6.53174086875e-06
Epoch: 7 cost time: 2.57259202003479
Epoch: 7, Steps: 514 | Train Loss: 0.4249223 Vali Loss: 0.3760177 Best vali loss: 0.3680598
	iters: 100, epoch: 8 | loss: 0.3238555
	speed: 0.0098s/iter; left time: 4.0619s
	iters: 200, epoch: 8 | loss: 0.3860162
	speed: 0.0050s/iter; left time: 1.5693s
	iters: 300, epoch: 8 | loss: 0.3566130
	speed: 0.0050s/iter; left time: 1.0742s
	iters: 400, epoch: 8 | loss: 1.0930731
	speed: 0.0050s/iter; left time: 0.5747s
	iters: 500, epoch: 8 | loss: 0.6047446
	speed: 0.0050s/iter; left time: 0.0749s
Updating learning rate to 3.265870434375e-06
Epoch: 8 cost time: 2.6061062812805176
Epoch: 8, Steps: 514 | Train Loss: 0.5528605 Vali Loss: 0.3760985 Best vali loss: 0.3680598

best validation loss 0.36805977727668926

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0101466814582, 'e_layers': 4, 'learning_rate': 0.000579051394, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4173943
	speed: 0.0114s/iter; left time: 45.8726s
	iters: 200, epoch: 1 | loss: 0.3456532
	speed: 0.0053s/iter; left time: 20.8783s
	iters: 300, epoch: 1 | loss: 0.3614512
	speed: 0.0053s/iter; left time: 20.1496s
	iters: 400, epoch: 1 | loss: 0.3619050
	speed: 0.0052s/iter; left time: 19.4134s
	iters: 500, epoch: 1 | loss: 0.9720953
	speed: 0.0049s/iter; left time: 17.6308s
Updating learning rate to 0.000579051394
Validation loss decreased (inf --> 0.3813).  Saving model state dict ...
Epoch: 1 cost time: 3.016700267791748
Epoch: 1, Steps: 514 | Train Loss: 0.4916998 Vali Loss: 0.3812708 Best vali loss: 0.3812708
	iters: 100, epoch: 2 | loss: 1.1585680
	speed: 0.0097s/iter; left time: 33.9322s
	iters: 200, epoch: 2 | loss: 1.0187029
	speed: 0.0047s/iter; left time: 15.9292s
	iters: 300, epoch: 2 | loss: 0.6535215
	speed: 0.0047s/iter; left time: 15.3871s
	iters: 400, epoch: 2 | loss: 0.3885490
	speed: 0.0049s/iter; left time: 15.5452s
	iters: 500, epoch: 2 | loss: 0.4516430
	speed: 0.0047s/iter; left time: 14.6467s
Updating learning rate to 0.000289525697
Epoch: 2 cost time: 2.488039016723633
Epoch: 2, Steps: 514 | Train Loss: 0.7341969 Vali Loss: 0.3890191 Best vali loss: 0.3812708
	iters: 100, epoch: 3 | loss: 0.3937451
	speed: 0.0097s/iter; left time: 28.9170s
	iters: 200, epoch: 3 | loss: 0.4401747
	speed: 0.0047s/iter; left time: 13.5276s
	iters: 300, epoch: 3 | loss: 0.7612780
	speed: 0.0050s/iter; left time: 13.8084s
	iters: 400, epoch: 3 | loss: 0.3676926
	speed: 0.0050s/iter; left time: 13.4239s
	iters: 500, epoch: 3 | loss: 1.1111447
	speed: 0.0050s/iter; left time: 12.9044s
Updating learning rate to 0.0001447628485
Validation loss decreased (0.3813 --> 0.3777).  Saving model state dict ...
Epoch: 3 cost time: 2.5685243606567383
Epoch: 3, Steps: 514 | Train Loss: 0.6148070 Vali Loss: 0.3777087 Best vali loss: 0.3777087
	iters: 100, epoch: 4 | loss: 0.6791154
	speed: 0.0103s/iter; left time: 25.4506s
	iters: 200, epoch: 4 | loss: 0.9343101
	speed: 0.0052s/iter; left time: 12.3870s
	iters: 300, epoch: 4 | loss: 0.4379711
	speed: 0.0052s/iter; left time: 11.7436s
	iters: 400, epoch: 4 | loss: 0.2858924
	speed: 0.0052s/iter; left time: 11.3897s
	iters: 500, epoch: 4 | loss: 0.4563991
	speed: 0.0053s/iter; left time: 11.0447s
Updating learning rate to 7.238142425e-05
Validation loss decreased (0.3777 --> 0.3734).  Saving model state dict ...
Epoch: 4 cost time: 2.738845109939575
Epoch: 4, Steps: 514 | Train Loss: 0.5587376 Vali Loss: 0.3734126 Best vali loss: 0.3734126
	iters: 100, epoch: 5 | loss: 0.7826411
	speed: 0.0098s/iter; left time: 19.2738s
	iters: 200, epoch: 5 | loss: 0.8102459
	speed: 0.0048s/iter; left time: 8.8315s
	iters: 300, epoch: 5 | loss: 0.6276538
	speed: 0.0047s/iter; left time: 8.3282s
	iters: 400, epoch: 5 | loss: 0.6727135
	speed: 0.0046s/iter; left time: 7.6623s
	iters: 500, epoch: 5 | loss: 0.8067145
	speed: 0.0047s/iter; left time: 7.3341s
Updating learning rate to 3.6190712125e-05
Validation loss decreased (0.3734 --> 0.3687).  Saving model state dict ...
Epoch: 5 cost time: 2.4638099670410156
Epoch: 5, Steps: 514 | Train Loss: 0.7399938 Vali Loss: 0.3687156 Best vali loss: 0.3687156
	iters: 100, epoch: 6 | loss: 0.4485656
	speed: 0.0104s/iter; left time: 15.0404s
	iters: 200, epoch: 6 | loss: 0.8705969
	speed: 0.0052s/iter; left time: 6.9672s
	iters: 300, epoch: 6 | loss: 0.4318962
	speed: 0.0052s/iter; left time: 6.4587s
	iters: 400, epoch: 6 | loss: 0.6926438
	speed: 0.0052s/iter; left time: 5.9057s
	iters: 500, epoch: 6 | loss: 0.2974183
	speed: 0.0053s/iter; left time: 5.5436s
Updating learning rate to 1.80953560625e-05
Epoch: 6 cost time: 2.731419563293457
Epoch: 6, Steps: 514 | Train Loss: 0.5482242 Vali Loss: 0.3734586 Best vali loss: 0.3687156
	iters: 100, epoch: 7 | loss: 0.2835726
	speed: 0.0095s/iter; left time: 8.8667s
	iters: 200, epoch: 7 | loss: 0.3474313
	speed: 0.0048s/iter; left time: 3.9406s
	iters: 300, epoch: 7 | loss: 1.0037111
	speed: 0.0048s/iter; left time: 3.5116s
	iters: 400, epoch: 7 | loss: 0.7099693
	speed: 0.0047s/iter; left time: 2.9771s
	iters: 500, epoch: 7 | loss: 0.5163512
	speed: 0.0047s/iter; left time: 2.5104s
Updating learning rate to 9.04767803125e-06
Epoch: 7 cost time: 2.4785408973693848
Epoch: 7, Steps: 514 | Train Loss: 0.5722071 Vali Loss: 0.3812691 Best vali loss: 0.3687156
	iters: 100, epoch: 8 | loss: 0.2537206
	speed: 0.0096s/iter; left time: 3.9896s
	iters: 200, epoch: 8 | loss: 0.5724947
	speed: 0.0047s/iter; left time: 1.4766s
	iters: 300, epoch: 8 | loss: 0.6627644
	speed: 0.0047s/iter; left time: 1.0052s
	iters: 400, epoch: 8 | loss: 0.4306866
	speed: 0.0047s/iter; left time: 0.5439s
	iters: 500, epoch: 8 | loss: 0.2023276
	speed: 0.0047s/iter; left time: 0.0701s
Updating learning rate to 4.523839015625e-06
Epoch: 8 cost time: 2.4653825759887695
Epoch: 8, Steps: 514 | Train Loss: 0.4243988 Vali Loss: 0.3741212 Best vali loss: 0.3687156

best validation loss 0.3687155594994371

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0066242221236, 'e_layers': 4, 'learning_rate': 6.02989612e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6539789
	speed: 0.0128s/iter; left time: 25.0788s
	iters: 200, epoch: 1 | loss: 0.4377115
	speed: 0.0067s/iter; left time: 12.3503s
Updating learning rate to 5.8003968642186114e-05
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 2.0626814365386963
Epoch: 1, Steps: 257 | Train Loss: 0.5458452 Vali Loss: 0.3669761 Best vali loss: 0.3669761
	iters: 100, epoch: 2 | loss: 0.9937672
	speed: 0.0138s/iter; left time: 23.4065s
	iters: 200, epoch: 2 | loss: 0.8229033
	speed: 0.0065s/iter; left time: 10.4458s
Updating learning rate to 5.146838278151226e-05
Validation loss decreased (0.3670 --> 0.3617).  Saving model state dict ...
Epoch: 2 cost time: 1.7206175327301025
Epoch: 2, Steps: 257 | Train Loss: 0.9083353 Vali Loss: 0.3617347 Best vali loss: 0.3617347
	iters: 100, epoch: 3 | loss: 0.5327066
	speed: 0.0142s/iter; left time: 20.4519s
	iters: 200, epoch: 3 | loss: 0.6997167
	speed: 0.0066s/iter; left time: 8.8050s
Updating learning rate to 4.168718732003269e-05
Epoch: 3 cost time: 1.7269294261932373
Epoch: 3, Steps: 257 | Train Loss: 0.6162117 Vali Loss: 0.3740470 Best vali loss: 0.3617347

best validation loss 0.3617346683337787

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0100766706901, 'e_layers': 4, 'learning_rate': 0.0005781556207, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4173046
	speed: 0.0112s/iter; left time: 45.1408s
	iters: 200, epoch: 1 | loss: 0.3445236
	speed: 0.0053s/iter; left time: 20.5675s
	iters: 300, epoch: 1 | loss: 0.4198912
	speed: 0.0050s/iter; left time: 19.1605s
	iters: 400, epoch: 1 | loss: 0.3464172
	speed: 0.0047s/iter; left time: 17.5229s
	iters: 500, epoch: 1 | loss: 0.9667516
	speed: 0.0048s/iter; left time: 17.3267s
Updating learning rate to 0.0005781556207
Validation loss decreased (inf --> 0.3857).  Saving model state dict ...
Epoch: 1 cost time: 2.9146437644958496
Epoch: 1, Steps: 514 | Train Loss: 0.4989776 Vali Loss: 0.3856670 Best vali loss: 0.3856670
	iters: 100, epoch: 2 | loss: 1.1595234
	speed: 0.0096s/iter; left time: 33.4422s
	iters: 200, epoch: 2 | loss: 0.9930296
	speed: 0.0048s/iter; left time: 16.2562s
	iters: 300, epoch: 2 | loss: 0.6203461
	speed: 0.0048s/iter; left time: 15.8778s
	iters: 400, epoch: 2 | loss: 0.3830647
	speed: 0.0048s/iter; left time: 15.2153s
	iters: 500, epoch: 2 | loss: 0.4446759
	speed: 0.0048s/iter; left time: 14.7655s
Updating learning rate to 0.00028907781035
Epoch: 2 cost time: 2.503000020980835
Epoch: 2, Steps: 514 | Train Loss: 0.7201279 Vali Loss: 0.3896564 Best vali loss: 0.3856670
	iters: 100, epoch: 3 | loss: 0.3918155
	speed: 0.0095s/iter; left time: 28.3669s
	iters: 200, epoch: 3 | loss: 0.4385484
	speed: 0.0044s/iter; left time: 12.8046s
	iters: 300, epoch: 3 | loss: 0.7724475
	speed: 0.0046s/iter; left time: 12.6925s
	iters: 400, epoch: 3 | loss: 0.3568662
	speed: 0.0045s/iter; left time: 12.1447s
	iters: 500, epoch: 3 | loss: 1.0660622
	speed: 0.0045s/iter; left time: 11.6656s
Updating learning rate to 0.000144538905175
Validation loss decreased (0.3857 --> 0.3809).  Saving model state dict ...
Epoch: 3 cost time: 2.368356227874756
Epoch: 3, Steps: 514 | Train Loss: 0.6051480 Vali Loss: 0.3809178 Best vali loss: 0.3809178

best validation loss 0.38091781066770874

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020081781014, 'e_layers': 4, 'learning_rate': 0.0007034731653, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007034731653
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 1.114126205444336
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3699180 Best vali loss: 0.3699180
Updating learning rate to 0.00035173658265
Validation loss decreased (0.3699 --> 0.3696).  Saving model state dict ...
Epoch: 2 cost time: 0.7946438789367676
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3695581 Best vali loss: 0.3695581
Updating learning rate to 0.000175868291325
Validation loss decreased (0.3696 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 0.7883694171905518
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3539203 Best vali loss: 0.3539203

best validation loss 0.3539202814486266

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020081781014, 'e_layers': 4, 'learning_rate': 0.0007034731653, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.79341456625e-05
Validation loss decreased (0.3539 --> 0.3462).  Saving model state dict ...
Epoch: 4 cost time: 1.1193459033966064
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3462024 Best vali loss: 0.3462024
Updating learning rate to 4.396707283125e-05
Epoch: 5 cost time: 0.793208122253418
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3494908 Best vali loss: 0.3462024
Updating learning rate to 2.1983536415625e-05
Epoch: 6 cost time: 0.7958214282989502
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3468337 Best vali loss: 0.3462024
Updating learning rate to 1.09917682078125e-05
Epoch: 7 cost time: 0.791560173034668
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3482841 Best vali loss: 0.3462024
Updating learning rate to 5.49588410390625e-06
Epoch: 8 cost time: 0.7949686050415039
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3485528 Best vali loss: 0.3462024

best validation loss 0.34620241973629634

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010640967513, 'e_layers': 4, 'learning_rate': 0.0004215236127, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5033113
	speed: 0.0112s/iter; left time: 45.0587s
	iters: 200, epoch: 1 | loss: 0.8113766
	speed: 0.0051s/iter; left time: 19.8374s
	iters: 300, epoch: 1 | loss: 0.8110422
	speed: 0.0051s/iter; left time: 19.3029s
	iters: 400, epoch: 1 | loss: 1.0407491
	speed: 0.0048s/iter; left time: 17.9498s
	iters: 500, epoch: 1 | loss: 0.5245493
	speed: 0.0048s/iter; left time: 17.5028s
Updating learning rate to 0.0004215236127
Validation loss decreased (inf --> 0.3863).  Saving model state dict ...
Epoch: 1 cost time: 2.9072980880737305
Epoch: 1, Steps: 514 | Train Loss: 0.7382057 Vali Loss: 0.3862811 Best vali loss: 0.3862811
	iters: 100, epoch: 2 | loss: 1.0226400
	speed: 0.0100s/iter; left time: 34.9351s
	iters: 200, epoch: 2 | loss: 0.6879110
	speed: 0.0049s/iter; left time: 16.5542s
	iters: 300, epoch: 2 | loss: 0.7825616
	speed: 0.0047s/iter; left time: 15.5679s
	iters: 400, epoch: 2 | loss: 0.6996058
	speed: 0.0048s/iter; left time: 15.2723s
	iters: 500, epoch: 2 | loss: 0.3436163
	speed: 0.0047s/iter; left time: 14.6136s
Updating learning rate to 0.00021076180635
Validation loss decreased (0.3863 --> 0.3748).  Saving model state dict ...
Epoch: 2 cost time: 2.50103759765625
Epoch: 2, Steps: 514 | Train Loss: 0.7072670 Vali Loss: 0.3748112 Best vali loss: 0.3748112
	iters: 100, epoch: 3 | loss: 0.5822433
	speed: 0.0096s/iter; left time: 28.5349s
	iters: 200, epoch: 3 | loss: 0.4806905
	speed: 0.0047s/iter; left time: 13.5251s
	iters: 300, epoch: 3 | loss: 0.4636829
	speed: 0.0047s/iter; left time: 13.0055s
	iters: 400, epoch: 3 | loss: 1.1552556
	speed: 0.0047s/iter; left time: 12.6246s
	iters: 500, epoch: 3 | loss: 0.3442290
	speed: 0.0047s/iter; left time: 12.0646s
Updating learning rate to 0.000105380903175
Validation loss decreased (0.3748 --> 0.3702).  Saving model state dict ...
Epoch: 3 cost time: 2.444689989089966
Epoch: 3, Steps: 514 | Train Loss: 0.6052203 Vali Loss: 0.3702446 Best vali loss: 0.3702446
	iters: 100, epoch: 4 | loss: 0.5312476
	speed: 0.0098s/iter; left time: 24.0925s
	iters: 200, epoch: 4 | loss: 0.5267154
	speed: 0.0046s/iter; left time: 10.9567s
	iters: 300, epoch: 4 | loss: 0.2761557
	speed: 0.0046s/iter; left time: 10.3405s
	iters: 400, epoch: 4 | loss: 0.4161228
	speed: 0.0049s/iter; left time: 10.5417s
	iters: 500, epoch: 4 | loss: 0.7496240
	speed: 0.0048s/iter; left time: 10.0326s
Updating learning rate to 5.26904515875e-05
Epoch: 4 cost time: 2.4906270503997803
Epoch: 4, Steps: 514 | Train Loss: 0.4999731 Vali Loss: 0.3753713 Best vali loss: 0.3702446
	iters: 100, epoch: 5 | loss: 0.4951417
	speed: 0.0104s/iter; left time: 20.2563s
	iters: 200, epoch: 5 | loss: 0.7006821
	speed: 0.0051s/iter; left time: 9.5207s
	iters: 300, epoch: 5 | loss: 0.3264818
	speed: 0.0052s/iter; left time: 9.1331s
	iters: 400, epoch: 5 | loss: 0.4456317
	speed: 0.0051s/iter; left time: 8.4680s
	iters: 500, epoch: 5 | loss: 0.7453051
	speed: 0.0052s/iter; left time: 8.0356s
Updating learning rate to 2.634522579375e-05
Epoch: 5 cost time: 2.7170660495758057
Epoch: 5, Steps: 514 | Train Loss: 0.5426485 Vali Loss: 0.3769614 Best vali loss: 0.3702446
	iters: 100, epoch: 6 | loss: 0.5713899
	speed: 0.0096s/iter; left time: 13.8656s
	iters: 200, epoch: 6 | loss: 0.6160741
	speed: 0.0048s/iter; left time: 6.5104s
	iters: 300, epoch: 6 | loss: 0.3981089
	speed: 0.0051s/iter; left time: 6.3627s
	iters: 400, epoch: 6 | loss: 0.3154881
	speed: 0.0049s/iter; left time: 5.6439s
	iters: 500, epoch: 6 | loss: 0.4982137
	speed: 0.0047s/iter; left time: 4.9223s
Updating learning rate to 1.3172612896875e-05
Epoch: 6 cost time: 2.52754545211792
Epoch: 6, Steps: 514 | Train Loss: 0.4798549 Vali Loss: 0.3738214 Best vali loss: 0.3702446
	iters: 100, epoch: 7 | loss: 0.4216667
	speed: 0.0093s/iter; left time: 8.6623s
	iters: 200, epoch: 7 | loss: 0.2701309
	speed: 0.0044s/iter; left time: 3.6812s
	iters: 300, epoch: 7 | loss: 0.3764825
	speed: 0.0047s/iter; left time: 3.4321s
	iters: 400, epoch: 7 | loss: 0.6489100
	speed: 0.0047s/iter; left time: 2.9728s
	iters: 500, epoch: 7 | loss: 0.4504193
	speed: 0.0049s/iter; left time: 2.6120s
Updating learning rate to 6.5863064484375e-06
Validation loss decreased (0.3702 --> 0.3668).  Saving model state dict ...
Epoch: 7 cost time: 2.475910186767578
Epoch: 7, Steps: 514 | Train Loss: 0.4335219 Vali Loss: 0.3668382 Best vali loss: 0.3668382
	iters: 100, epoch: 8 | loss: 0.3181681
	speed: 0.0103s/iter; left time: 4.2873s
	iters: 200, epoch: 8 | loss: 0.3692308
	speed: 0.0053s/iter; left time: 1.6580s
	iters: 300, epoch: 8 | loss: 0.3578779
	speed: 0.0050s/iter; left time: 1.0700s
	iters: 400, epoch: 8 | loss: 1.0394866
	speed: 0.0048s/iter; left time: 0.5532s
	iters: 500, epoch: 8 | loss: 0.5503141
	speed: 0.0049s/iter; left time: 0.0731s
Updating learning rate to 3.29315322421875e-06
Epoch: 8 cost time: 2.635122776031494
Epoch: 8, Steps: 514 | Train Loss: 0.5270155 Vali Loss: 0.3712792 Best vali loss: 0.3668382

best validation loss 0.3668381723299008

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0008175687486, 'e_layers': 4, 'learning_rate': 0.0004716473976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6261317
	speed: 0.0115s/iter; left time: 46.1093s
	iters: 200, epoch: 1 | loss: 0.6070561
	speed: 0.0054s/iter; left time: 20.9897s
	iters: 300, epoch: 1 | loss: 0.7849177
	speed: 0.0053s/iter; left time: 20.3148s
	iters: 400, epoch: 1 | loss: 0.4234166
	speed: 0.0052s/iter; left time: 19.4048s
	iters: 500, epoch: 1 | loss: 0.4314998
	speed: 0.0051s/iter; left time: 18.3684s
Updating learning rate to 0.0004716473976
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 3.0497474670410156
Epoch: 1, Steps: 514 | Train Loss: 0.5746044 Vali Loss: 0.3692524 Best vali loss: 0.3692524
	iters: 100, epoch: 2 | loss: 0.3276236
	speed: 0.0100s/iter; left time: 35.1137s
	iters: 200, epoch: 2 | loss: 0.2981466
	speed: 0.0050s/iter; left time: 16.9865s
	iters: 300, epoch: 2 | loss: 0.6054717
	speed: 0.0050s/iter; left time: 16.3447s
	iters: 400, epoch: 2 | loss: 0.7495815
	speed: 0.0050s/iter; left time: 15.9576s
	iters: 500, epoch: 2 | loss: 0.4652695
	speed: 0.0050s/iter; left time: 15.5701s
Updating learning rate to 0.0002358236988
Epoch: 2 cost time: 2.5958611965179443
Epoch: 2, Steps: 514 | Train Loss: 0.4892186 Vali Loss: 0.3737376 Best vali loss: 0.3692524
	iters: 100, epoch: 3 | loss: 0.4345386
	speed: 0.0101s/iter; left time: 30.2338s
	iters: 200, epoch: 3 | loss: 0.6719283
	speed: 0.0052s/iter; left time: 15.0448s
	iters: 300, epoch: 3 | loss: 0.7757009
	speed: 0.0054s/iter; left time: 15.0885s
	iters: 400, epoch: 3 | loss: 0.9794629
	speed: 0.0053s/iter; left time: 14.1788s
	iters: 500, epoch: 3 | loss: 0.5923684
	speed: 0.0052s/iter; left time: 13.5363s
Updating learning rate to 0.0001179118494
Validation loss decreased (0.3693 --> 0.3681).  Saving model state dict ...
Epoch: 3 cost time: 2.759760618209839
Epoch: 3, Steps: 514 | Train Loss: 0.6907998 Vali Loss: 0.3680629 Best vali loss: 0.3680629
	iters: 100, epoch: 4 | loss: 0.5213529
	speed: 0.0107s/iter; left time: 26.4592s
	iters: 200, epoch: 4 | loss: 0.2914089
	speed: 0.0053s/iter; left time: 12.5951s
	iters: 300, epoch: 4 | loss: 0.8930691
	speed: 0.0053s/iter; left time: 12.0004s
	iters: 400, epoch: 4 | loss: 0.6721295
	speed: 0.0050s/iter; left time: 10.9351s
	iters: 500, epoch: 4 | loss: 0.8253060
	speed: 0.0051s/iter; left time: 10.5760s
Updating learning rate to 5.89559247e-05
Validation loss decreased (0.3681 --> 0.3597).  Saving model state dict ...
Epoch: 4 cost time: 2.730842351913452
Epoch: 4, Steps: 514 | Train Loss: 0.6406533 Vali Loss: 0.3597497 Best vali loss: 0.3597497
	iters: 100, epoch: 5 | loss: 0.2195780
	speed: 0.0100s/iter; left time: 19.5872s
	iters: 200, epoch: 5 | loss: 0.3868448
	speed: 0.0051s/iter; left time: 9.3973s
	iters: 300, epoch: 5 | loss: 0.6811955
	speed: 0.0051s/iter; left time: 9.0459s
	iters: 400, epoch: 5 | loss: 0.3978570
	speed: 0.0051s/iter; left time: 8.4384s
	iters: 500, epoch: 5 | loss: 1.0452249
	speed: 0.0051s/iter; left time: 7.9421s
Updating learning rate to 2.947796235e-05
Validation loss decreased (0.3597 --> 0.3509).  Saving model state dict ...
Epoch: 5 cost time: 2.6698484420776367
Epoch: 5, Steps: 514 | Train Loss: 0.5461400 Vali Loss: 0.3509467 Best vali loss: 0.3509467
	iters: 100, epoch: 6 | loss: 0.4134749
	speed: 0.0104s/iter; left time: 14.9736s
	iters: 200, epoch: 6 | loss: 0.4864884
	speed: 0.0052s/iter; left time: 7.0146s
	iters: 300, epoch: 6 | loss: 0.8212618
	speed: 0.0052s/iter; left time: 6.4798s
	iters: 400, epoch: 6 | loss: 0.5301114
	speed: 0.0049s/iter; left time: 5.6325s
	iters: 500, epoch: 6 | loss: 0.9476452
	speed: 0.0049s/iter; left time: 5.0829s
Updating learning rate to 1.4738981175e-05
Validation loss decreased (0.3509 --> 0.3502).  Saving model state dict ...
Epoch: 6 cost time: 2.6636829376220703
Epoch: 6, Steps: 514 | Train Loss: 0.6397963 Vali Loss: 0.3501506 Best vali loss: 0.3501506
	iters: 100, epoch: 7 | loss: 0.5185037
	speed: 0.0101s/iter; left time: 9.4060s
	iters: 200, epoch: 7 | loss: 0.2697062
	speed: 0.0050s/iter; left time: 4.1337s
	iters: 300, epoch: 7 | loss: 0.4027666
	speed: 0.0048s/iter; left time: 3.4843s
	iters: 400, epoch: 7 | loss: 0.3028141
	speed: 0.0050s/iter; left time: 3.1235s
	iters: 500, epoch: 7 | loss: 0.3365169
	speed: 0.0049s/iter; left time: 2.6130s
Updating learning rate to 7.3694905875e-06
Epoch: 7 cost time: 2.580885410308838
Epoch: 7, Steps: 514 | Train Loss: 0.3660615 Vali Loss: 0.3529162 Best vali loss: 0.3501506
	iters: 100, epoch: 8 | loss: 0.3776534
	speed: 0.0100s/iter; left time: 4.1422s
	iters: 200, epoch: 8 | loss: 0.3853840
	speed: 0.0044s/iter; left time: 1.3973s
	iters: 300, epoch: 8 | loss: 0.3629544
	speed: 0.0045s/iter; left time: 0.9571s
	iters: 400, epoch: 8 | loss: 0.6449696
	speed: 0.0047s/iter; left time: 0.5363s
	iters: 500, epoch: 8 | loss: 0.3331371
	speed: 0.0049s/iter; left time: 0.0731s
Updating learning rate to 3.68474529375e-06
Epoch: 8 cost time: 2.470731496810913
Epoch: 8, Steps: 514 | Train Loss: 0.4208197 Vali Loss: 0.3513059 Best vali loss: 0.3501506

best validation loss 0.3501505983016346

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0021333285228, 'e_layers': 2, 'learning_rate': 0.0006789943624, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006789943624
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 0.7712974548339844
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3698676 Best vali loss: 0.3698676
Updating learning rate to 0.0003394971812
Epoch: 2 cost time: 0.4488093852996826
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3798813 Best vali loss: 0.3698676
Updating learning rate to 0.0001697485906
Validation loss decreased (0.3699 --> 0.3657).  Saving model state dict ...
Epoch: 3 cost time: 0.43895840644836426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3656608 Best vali loss: 0.3656608

best validation loss 0.36566076010524173

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006790098202, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006790098202
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.1039526462554932
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695539 Best vali loss: 0.3695539
Updating learning rate to 0.0003395049101
Epoch: 2 cost time: 0.7883992195129395
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3771495 Best vali loss: 0.3695539
Updating learning rate to 0.00016975245505
Validation loss decreased (0.3696 --> 0.3564).  Saving model state dict ...
Epoch: 3 cost time: 0.7761528491973877
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3563802 Best vali loss: 0.3563802

best validation loss 0.3563801951750323

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006796173501, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006796173501
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.0988578796386719
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695526 Best vali loss: 0.3695526
Updating learning rate to 0.00033980867505
Validation loss decreased (0.3696 --> 0.3581).  Saving model state dict ...
Epoch: 2 cost time: 0.7904698848724365
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3581457 Best vali loss: 0.3581457
Updating learning rate to 0.000169904337525
Validation loss decreased (0.3581 --> 0.3538).  Saving model state dict ...
Epoch: 3 cost time: 0.7904651165008545
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3537797 Best vali loss: 0.3537797

best validation loss 0.353779673260181

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0006796173501, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.49521687625e-05
Epoch: 4 cost time: 1.0866165161132812
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3607523 Best vali loss: 0.3537797
Updating learning rate to 4.247608438125e-05
Validation loss decreased (0.3538 --> 0.3499).  Saving model state dict ...
Epoch: 5 cost time: 0.7777721881866455
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3499278 Best vali loss: 0.3499278
Updating learning rate to 2.1238042190625e-05
Validation loss decreased (0.3499 --> 0.3460).  Saving model state dict ...
Epoch: 6 cost time: 0.7766730785369873
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3460456 Best vali loss: 0.3460456
Updating learning rate to 1.06190210953125e-05
Validation loss decreased (0.3460 --> 0.3436).  Saving model state dict ...
Epoch: 7 cost time: 0.7817273139953613
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3435672 Best vali loss: 0.3435672
Updating learning rate to 5.30951054765625e-06
Epoch: 8 cost time: 0.7815902233123779
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3463169 Best vali loss: 0.3435672

best validation loss 0.3435672110330848

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013260044514, 'e_layers': 4, 'learning_rate': 0.0009246917211, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6659174
	speed: 0.0112s/iter; left time: 21.8698s
	iters: 200, epoch: 1 | loss: 0.4605205
	speed: 0.0053s/iter; left time: 9.9005s
Updating learning rate to 0.0009246917211
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 1.694075345993042
Epoch: 1, Steps: 257 | Train Loss: 0.5632190 Vali Loss: 0.3732797 Best vali loss: 0.3732797
	iters: 100, epoch: 2 | loss: 0.5735120
	speed: 0.0113s/iter; left time: 19.2422s
	iters: 200, epoch: 2 | loss: 0.7237508
	speed: 0.0055s/iter; left time: 8.8236s
Updating learning rate to 0.00046234586055
Validation loss decreased (0.3733 --> 0.3714).  Saving model state dict ...
Epoch: 2 cost time: 1.4625518321990967
Epoch: 2, Steps: 257 | Train Loss: 0.6486314 Vali Loss: 0.3713680 Best vali loss: 0.3713680
	iters: 100, epoch: 3 | loss: 0.7653691
	speed: 0.0108s/iter; left time: 15.5789s
	iters: 200, epoch: 3 | loss: 0.3853659
	speed: 0.0049s/iter; left time: 6.5382s
Updating learning rate to 0.000231172930275
Epoch: 3 cost time: 1.3204069137573242
Epoch: 3, Steps: 257 | Train Loss: 0.5753675 Vali Loss: 0.3834686 Best vali loss: 0.3713680
	iters: 100, epoch: 4 | loss: 0.6318115
	speed: 0.0108s/iter; left time: 12.8303s
	iters: 200, epoch: 4 | loss: 0.7019894
	speed: 0.0050s/iter; left time: 5.4017s
Updating learning rate to 0.0001155864651375
Validation loss decreased (0.3714 --> 0.3625).  Saving model state dict ...
Epoch: 4 cost time: 1.3416154384613037
Epoch: 4, Steps: 257 | Train Loss: 0.6669005 Vali Loss: 0.3624886 Best vali loss: 0.3624886
	iters: 100, epoch: 5 | loss: 0.6017646
	speed: 0.0110s/iter; left time: 10.2363s
	iters: 200, epoch: 5 | loss: 0.4577837
	speed: 0.0052s/iter; left time: 4.2919s
Updating learning rate to 5.779323256875e-05
Validation loss decreased (0.3625 --> 0.3574).  Saving model state dict ...
Epoch: 5 cost time: 1.3622515201568604
Epoch: 5, Steps: 257 | Train Loss: 0.5297741 Vali Loss: 0.3573761 Best vali loss: 0.3573761
	iters: 100, epoch: 6 | loss: 0.3961543
	speed: 0.0107s/iter; left time: 7.2158s
	iters: 200, epoch: 6 | loss: 0.6964430
	speed: 0.0050s/iter; left time: 2.8501s
Updating learning rate to 2.8896616284375e-05
Epoch: 6 cost time: 1.3277266025543213
Epoch: 6, Steps: 257 | Train Loss: 0.5462987 Vali Loss: 0.3600014 Best vali loss: 0.3573761
	iters: 100, epoch: 7 | loss: 0.7678910
	speed: 0.0108s/iter; left time: 4.4993s
	iters: 200, epoch: 7 | loss: 0.4800981
	speed: 0.0056s/iter; left time: 1.7506s
Updating learning rate to 1.44483081421875e-05
Validation loss decreased (0.3574 --> 0.3548).  Saving model state dict ...
Epoch: 7 cost time: 1.465038776397705
Epoch: 7, Steps: 257 | Train Loss: 0.6239945 Vali Loss: 0.3548477 Best vali loss: 0.3548477
	iters: 100, epoch: 8 | loss: 0.8059539
	speed: 0.0113s/iter; left time: 1.7912s
	iters: 200, epoch: 8 | loss: 0.6881068
	speed: 0.0055s/iter; left time: 0.3170s
Updating learning rate to 7.22415407109375e-06
Epoch: 8 cost time: 1.4438683986663818
Epoch: 8, Steps: 257 | Train Loss: 0.7470303 Vali Loss: 0.3554890 Best vali loss: 0.3548477

best validation loss 0.3548477160555909

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0039919757709, 'e_layers': 1, 'learning_rate': 0.0027889125958, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8126798
	speed: 0.0089s/iter; left time: 17.4139s
	iters: 200, epoch: 1 | loss: 0.6824353
	speed: 0.0025s/iter; left time: 4.7164s
Updating learning rate to 0.0027889125958
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.0087099075317383
Epoch: 1, Steps: 257 | Train Loss: 0.7475576 Vali Loss: 0.3715518 Best vali loss: 0.3715518
	iters: 100, epoch: 2 | loss: 0.4602264
	speed: 0.0063s/iter; left time: 10.6845s
	iters: 200, epoch: 2 | loss: 0.5259062
	speed: 0.0025s/iter; left time: 4.0592s
Updating learning rate to 0.0013944562979
Epoch: 2 cost time: 0.698620080947876
Epoch: 2, Steps: 257 | Train Loss: 0.4930663 Vali Loss: 0.3824605 Best vali loss: 0.3715518
	iters: 100, epoch: 3 | loss: 0.6803634
	speed: 0.0062s/iter; left time: 8.9531s
	iters: 200, epoch: 3 | loss: 0.6082299
	speed: 0.0028s/iter; left time: 3.7195s
Updating learning rate to 0.00069722814895
Epoch: 3 cost time: 0.7234783172607422
Epoch: 3, Steps: 257 | Train Loss: 0.6442966 Vali Loss: 0.3915459 Best vali loss: 0.3715518
	iters: 100, epoch: 4 | loss: 0.5304585
	speed: 0.0063s/iter; left time: 7.4585s
	iters: 200, epoch: 4 | loss: 0.4553075
	speed: 0.0027s/iter; left time: 2.9030s
Updating learning rate to 0.000348614074475
Epoch: 4 cost time: 0.7219326496124268
Epoch: 4, Steps: 257 | Train Loss: 0.4928830 Vali Loss: 0.4491391 Best vali loss: 0.3715518
	iters: 100, epoch: 5 | loss: 0.6241860
	speed: 0.0061s/iter; left time: 5.6729s
	iters: 200, epoch: 5 | loss: 0.4352772
	speed: 0.0025s/iter; left time: 2.0871s
Updating learning rate to 0.0001743070372375
Epoch: 5 cost time: 0.6855349540710449
Epoch: 5, Steps: 257 | Train Loss: 0.5297316 Vali Loss: 0.4727312 Best vali loss: 0.3715518
	iters: 100, epoch: 6 | loss: 0.6696093
	speed: 0.0064s/iter; left time: 4.2747s
	iters: 200, epoch: 6 | loss: 0.2888009
	speed: 0.0026s/iter; left time: 1.5134s
Updating learning rate to 8.715351861875e-05
Epoch: 6 cost time: 0.7215900421142578
Epoch: 6, Steps: 257 | Train Loss: 0.4792051 Vali Loss: 0.4714663 Best vali loss: 0.3715518
	iters: 100, epoch: 7 | loss: 0.6850230
	speed: 0.0063s/iter; left time: 2.6263s
	iters: 200, epoch: 7 | loss: 0.4137180
	speed: 0.0026s/iter; left time: 0.8109s
Updating learning rate to 4.3576759309375e-05
Epoch: 7 cost time: 0.7134156227111816
Epoch: 7, Steps: 257 | Train Loss: 0.5493705 Vali Loss: 0.4773653 Best vali loss: 0.3715518
	iters: 100, epoch: 8 | loss: 0.4625931
	speed: 0.0065s/iter; left time: 1.0252s
	iters: 200, epoch: 8 | loss: 0.3945850
	speed: 0.0026s/iter; left time: 0.1497s
Updating learning rate to 2.17883796546875e-05
Epoch: 8 cost time: 0.7108886241912842
Epoch: 8, Steps: 257 | Train Loss: 0.4285891 Vali Loss: 0.4827058 Best vali loss: 0.3715518

best validation loss 0.3715517698547461

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010579409179, 'e_layers': 3, 'learning_rate': 0.0003540726809, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7316396
	speed: 0.0110s/iter; left time: 21.5743s
	iters: 200, epoch: 1 | loss: 0.4348506
	speed: 0.0044s/iter; left time: 8.2311s
Updating learning rate to 0.0003540726809
Validation loss decreased (inf --> 0.3652).  Saving model state dict ...
Epoch: 1 cost time: 1.526580572128296
Epoch: 1, Steps: 257 | Train Loss: 0.5832451 Vali Loss: 0.3652372 Best vali loss: 0.3652372
	iters: 100, epoch: 2 | loss: 0.5872517
	speed: 0.0092s/iter; left time: 15.6560s
	iters: 200, epoch: 2 | loss: 0.5644657
	speed: 0.0041s/iter; left time: 6.4950s
Updating learning rate to 0.00017703634045
Validation loss decreased (0.3652 --> 0.3635).  Saving model state dict ...
Epoch: 2 cost time: 1.090681791305542
Epoch: 2, Steps: 257 | Train Loss: 0.5758587 Vali Loss: 0.3634615 Best vali loss: 0.3634615
	iters: 100, epoch: 3 | loss: 0.7879377
	speed: 0.0092s/iter; left time: 13.2223s
	iters: 200, epoch: 3 | loss: 0.5663891
	speed: 0.0041s/iter; left time: 5.5086s
Updating learning rate to 8.8518170225e-05
Validation loss decreased (0.3635 --> 0.3572).  Saving model state dict ...
Epoch: 3 cost time: 1.1073033809661865
Epoch: 3, Steps: 257 | Train Loss: 0.6771634 Vali Loss: 0.3572295 Best vali loss: 0.3572295

best validation loss 0.3572294822610432

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043984254792, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.0868871212005615
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695795 Best vali loss: 0.3695795
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3696 --> 0.3554).  Saving model state dict ...
Epoch: 2 cost time: 0.777883768081665
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3554416 Best vali loss: 0.3554416
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3554 --> 0.3470).  Saving model state dict ...
Epoch: 3 cost time: 0.7763028144836426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3470159 Best vali loss: 0.3470159

best validation loss 0.34701589052007337

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0040824923309, 'e_layers': 4, 'learning_rate': 0.0006701574281, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006701574281
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.0953309535980225
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3689978 Best vali loss: 0.3689978
Updating learning rate to 0.00033507871405
Validation loss decreased (0.3690 --> 0.3580).  Saving model state dict ...
Epoch: 2 cost time: 0.775543212890625
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3579874 Best vali loss: 0.3579874
Updating learning rate to 0.000167539357025
Epoch: 3 cost time: 0.7834479808807373
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3710380 Best vali loss: 0.3579874

best validation loss 0.3579874435084742

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043984254792, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3470 --> 0.3427).  Saving model state dict ...
Epoch: 4 cost time: 1.0877923965454102
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3427086 Best vali loss: 0.3427086
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.780083179473877
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3427938 Best vali loss: 0.3427086
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3427 --> 0.3412).  Saving model state dict ...
Epoch: 6 cost time: 0.7812092304229736
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3412127 Best vali loss: 0.3412127
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3412 --> 0.3389).  Saving model state dict ...
Epoch: 7 cost time: 0.779625415802002
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3389111 Best vali loss: 0.3389111
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7777576446533203
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3402996 Best vali loss: 0.3389111

best validation loss 0.33891111749328656

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0091318904713, 'e_layers': 2, 'learning_rate': 0.0001489907805, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7518689
	speed: 0.0103s/iter; left time: 9.5637s
Updating learning rate to 0.0001489907805
Validation loss decreased (inf --> 0.4179).  Saving model state dict ...
Epoch: 1 cost time: 0.8789072036743164
Epoch: 1, Steps: 129 | Train Loss: 0.7518689 Vali Loss: 0.4178802 Best vali loss: 0.4178802
	iters: 100, epoch: 2 | loss: 0.8229262
	speed: 0.0069s/iter; left time: 5.5172s
Updating learning rate to 7.449539025e-05
Validation loss decreased (0.4179 --> 0.3976).  Saving model state dict ...
Epoch: 2 cost time: 0.5293984413146973
Epoch: 2, Steps: 129 | Train Loss: 0.8229262 Vali Loss: 0.3976371 Best vali loss: 0.3976371
	iters: 100, epoch: 3 | loss: 0.6452816
	speed: 0.0069s/iter; left time: 4.6850s
Updating learning rate to 3.7247695125e-05
Validation loss decreased (0.3976 --> 0.3916).  Saving model state dict ...
Epoch: 3 cost time: 0.5670959949493408
Epoch: 3, Steps: 129 | Train Loss: 0.6452816 Vali Loss: 0.3915741 Best vali loss: 0.3915741
	iters: 100, epoch: 4 | loss: 0.8350596
	speed: 0.0069s/iter; left time: 3.7784s
Updating learning rate to 1.86238475625e-05
Validation loss decreased (0.3916 --> 0.3891).  Saving model state dict ...
Epoch: 4 cost time: 0.5393192768096924
Epoch: 4, Steps: 129 | Train Loss: 0.8350596 Vali Loss: 0.3890686 Best vali loss: 0.3890686
	iters: 100, epoch: 5 | loss: 0.5228286
	speed: 0.0068s/iter; left time: 2.8534s
Updating learning rate to 9.31192378125e-06
Validation loss decreased (0.3891 --> 0.3879).  Saving model state dict ...
Epoch: 5 cost time: 0.5449795722961426
Epoch: 5, Steps: 129 | Train Loss: 0.5228286 Vali Loss: 0.3878577 Best vali loss: 0.3878577
	iters: 100, epoch: 6 | loss: 0.8191646
	speed: 0.0071s/iter; left time: 2.0541s
Updating learning rate to 4.655961890625e-06
Validation loss decreased (0.3879 --> 0.3873).  Saving model state dict ...
Epoch: 6 cost time: 0.5646891593933105
Epoch: 6, Steps: 129 | Train Loss: 0.8191646 Vali Loss: 0.3872622 Best vali loss: 0.3872622
	iters: 100, epoch: 7 | loss: 0.6579009
	speed: 0.0070s/iter; left time: 1.1084s
Updating learning rate to 2.3279809453125e-06
Validation loss decreased (0.3873 --> 0.3870).  Saving model state dict ...
Epoch: 7 cost time: 0.5536708831787109
Epoch: 7, Steps: 129 | Train Loss: 0.6579009 Vali Loss: 0.3869705 Best vali loss: 0.3869705
	iters: 100, epoch: 8 | loss: 0.8525553
	speed: 0.0065s/iter; left time: 0.1951s
Updating learning rate to 1.16399047265625e-06
Validation loss decreased (0.3870 --> 0.3868).  Saving model state dict ...
Epoch: 8 cost time: 0.513275146484375
Epoch: 8, Steps: 129 | Train Loss: 0.8525553 Vali Loss: 0.3868225 Best vali loss: 0.3868225

best validation loss 0.3868224591543726

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010590120338, 'e_layers': 4, 'learning_rate': 0.0003870272284, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3268008
	speed: 0.0124s/iter; left time: 24.3202s
	iters: 200, epoch: 1 | loss: 0.8025036
	speed: 0.0062s/iter; left time: 11.4709s
Updating learning rate to 0.00037229688162166547
Validation loss decreased (inf --> 0.3854).  Saving model state dict ...
Epoch: 1 cost time: 1.9433653354644775
Epoch: 1, Steps: 257 | Train Loss: 0.5646522 Vali Loss: 0.3853908 Best vali loss: 0.3853908
	iters: 100, epoch: 2 | loss: 0.8798029
	speed: 0.0133s/iter; left time: 22.5423s
	iters: 200, epoch: 2 | loss: 0.9252375
	speed: 0.0063s/iter; left time: 10.1101s
Updating learning rate to 0.00033034840305273735
Epoch: 2 cost time: 1.676929235458374
Epoch: 2, Steps: 257 | Train Loss: 0.9025202 Vali Loss: 0.3861561 Best vali loss: 0.3853908
	iters: 100, epoch: 3 | loss: 0.4131612
	speed: 0.0130s/iter; left time: 18.7677s
	iters: 200, epoch: 3 | loss: 0.9127581
	speed: 0.0061s/iter; left time: 8.2082s
Updating learning rate to 0.0002675680682914298
Validation loss decreased (0.3854 --> 0.3767).  Saving model state dict ...
Epoch: 3 cost time: 1.6196038722991943
Epoch: 3, Steps: 257 | Train Loss: 0.6629597 Vali Loss: 0.3766575 Best vali loss: 0.3766575
	iters: 100, epoch: 4 | loss: 0.5364932
	speed: 0.0132s/iter; left time: 15.7111s
	iters: 200, epoch: 4 | loss: 0.5965501
	speed: 0.0061s/iter; left time: 6.6699s
Updating learning rate to 0.0001935136142
Epoch: 4 cost time: 1.6217269897460938
Epoch: 4, Steps: 257 | Train Loss: 0.5665216 Vali Loss: 0.3772115 Best vali loss: 0.3766575
	iters: 100, epoch: 5 | loss: 0.5789991
	speed: 0.0128s/iter; left time: 11.8811s
	iters: 200, epoch: 5 | loss: 0.7118261
	speed: 0.0061s/iter; left time: 5.0704s
Updating learning rate to 0.00011945916010857024
Epoch: 5 cost time: 1.6164982318878174
Epoch: 5, Steps: 257 | Train Loss: 0.6454126 Vali Loss: 0.3785190 Best vali loss: 0.3766575
	iters: 100, epoch: 6 | loss: 0.5056784
	speed: 0.0131s/iter; left time: 8.8350s
	iters: 200, epoch: 6 | loss: 0.3654624
	speed: 0.0063s/iter; left time: 3.6254s
Updating learning rate to 5.6678825347262636e-05
Validation loss decreased (0.3767 --> 0.3586).  Saving model state dict ...
Epoch: 6 cost time: 1.6877498626708984
Epoch: 6, Steps: 257 | Train Loss: 0.4355704 Vali Loss: 0.3585903 Best vali loss: 0.3585903
	iters: 100, epoch: 7 | loss: 0.3708088
	speed: 0.0138s/iter; left time: 5.7466s
	iters: 200, epoch: 7 | loss: 0.2970117
	speed: 0.0063s/iter; left time: 1.9920s
Updating learning rate to 1.47303467783345e-05
Epoch: 7 cost time: 1.6797442436218262
Epoch: 7, Steps: 257 | Train Loss: 0.3339102 Vali Loss: 0.3659842 Best vali loss: 0.3585903
	iters: 100, epoch: 8 | loss: 0.4175870
	speed: 0.0130s/iter; left time: 2.0532s
	iters: 200, epoch: 8 | loss: 0.5317779
	speed: 0.0062s/iter; left time: 0.3590s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6318738460540771
Epoch: 8, Steps: 257 | Train Loss: 0.4746825 Vali Loss: 0.3670742 Best vali loss: 0.3585903

best validation loss 0.35859033659773865

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010603768505, 'e_layers': 3, 'learning_rate': 0.0004049591703, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9710988
	speed: 0.0106s/iter; left time: 42.5867s
	iters: 200, epoch: 1 | loss: 0.5381949
	speed: 0.0042s/iter; left time: 16.2769s
	iters: 300, epoch: 1 | loss: 1.0429217
	speed: 0.0043s/iter; left time: 16.5382s
	iters: 400, epoch: 1 | loss: 0.9484740
	speed: 0.0040s/iter; left time: 14.6785s
	iters: 500, epoch: 1 | loss: 0.8846582
	speed: 0.0040s/iter; left time: 14.5546s
Updating learning rate to 0.00038954632962146126
Validation loss decreased (inf --> 0.3723).  Saving model state dict ...
Epoch: 1 cost time: 2.492882013320923
Epoch: 1, Steps: 514 | Train Loss: 0.8770695 Vali Loss: 0.3723304 Best vali loss: 0.3723304
	iters: 100, epoch: 2 | loss: 1.0964977
	speed: 0.0086s/iter; left time: 30.2176s
	iters: 200, epoch: 2 | loss: 0.4321873
	speed: 0.0040s/iter; left time: 13.6032s
	iters: 300, epoch: 2 | loss: 1.0899100
	speed: 0.0042s/iter; left time: 13.7080s
	iters: 400, epoch: 2 | loss: 0.8214758
	speed: 0.0041s/iter; left time: 13.2104s
	iters: 500, epoch: 2 | loss: 1.0449966
	speed: 0.0041s/iter; left time: 12.8105s
Updating learning rate to 0.00034565427286140397
Epoch: 2 cost time: 2.1382975578308105
Epoch: 2, Steps: 514 | Train Loss: 0.8970135 Vali Loss: 0.3724322 Best vali loss: 0.3723304
	iters: 100, epoch: 3 | loss: 0.7389468
	speed: 0.0080s/iter; left time: 23.8161s
	iters: 200, epoch: 3 | loss: 0.6264111
	speed: 0.0037s/iter; left time: 10.7741s
	iters: 300, epoch: 3 | loss: 0.2975634
	speed: 0.0038s/iter; left time: 10.4734s
	iters: 400, epoch: 3 | loss: 0.6178313
	speed: 0.0037s/iter; left time: 9.9290s
	iters: 500, epoch: 3 | loss: 1.1005349
	speed: 0.0037s/iter; left time: 9.6654s
Updating learning rate to 0.0002799651677790615
Epoch: 3 cost time: 1.9695003032684326
Epoch: 3, Steps: 514 | Train Loss: 0.6762575 Vali Loss: 0.3828134 Best vali loss: 0.3723304

best validation loss 0.3723303937022016

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.004483369525, 'e_layers': 2, 'learning_rate': 0.0006639992958, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006639992958
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 0.7633240222930908
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709967 Best vali loss: 0.3709967
Updating learning rate to 0.0003319996479
Validation loss decreased (0.3710 --> 0.3601).  Saving model state dict ...
Epoch: 2 cost time: 0.4489452838897705
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3601205 Best vali loss: 0.3601205
Updating learning rate to 0.00016599982395
Validation loss decreased (0.3601 --> 0.3511).  Saving model state dict ...
Epoch: 3 cost time: 0.44568443298339844
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3511408 Best vali loss: 0.3511408

best validation loss 0.3511407668557757

[INFO][smbo.py:320] Finished 800 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0046360740817, 'e_layers': 2, 'learning_rate': 0.000665999632, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000665999632
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.7697393894195557
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709204 Best vali loss: 0.3709204
Updating learning rate to 0.000332999816
Validation loss decreased (0.3709 --> 0.3561).  Saving model state dict ...
Epoch: 2 cost time: 0.45059776306152344
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3561252 Best vali loss: 0.3561252
Updating learning rate to 0.000166499908
Validation loss decreased (0.3561 --> 0.3438).  Saving model state dict ...
Epoch: 3 cost time: 0.44287538528442383
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3438176 Best vali loss: 0.3438176

best validation loss 0.34381758999262435

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0046360740817, 'e_layers': 2, 'learning_rate': 0.000665999632, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.3249954e-05
Epoch: 4 cost time: 0.7584083080291748
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3473064 Best vali loss: 0.3438176
Updating learning rate to 4.1624977e-05
Validation loss decreased (0.3438 --> 0.3419).  Saving model state dict ...
Epoch: 5 cost time: 0.44533252716064453
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3419312 Best vali loss: 0.3419312
Updating learning rate to 2.08124885e-05
Epoch: 6 cost time: 0.4476921558380127
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3428003 Best vali loss: 0.3419312
Updating learning rate to 1.040624425e-05
Validation loss decreased (0.3419 --> 0.3411).  Saving model state dict ...
Epoch: 7 cost time: 0.4442310333251953
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3410833 Best vali loss: 0.3410833
Updating learning rate to 5.203122125e-06
Epoch: 8 cost time: 0.44408249855041504
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3415274 Best vali loss: 0.3410833

best validation loss 0.34108331797165115

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.005666016131, 'e_layers': 4, 'learning_rate': 0.0004067098876, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3325486
	speed: 0.0126s/iter; left time: 24.6380s
	iters: 200, epoch: 1 | loss: 0.8189712
	speed: 0.0063s/iter; left time: 11.6284s
Updating learning rate to 0.000391230414211803
Validation loss decreased (inf --> 0.3833).  Saving model state dict ...
Epoch: 1 cost time: 1.9776825904846191
Epoch: 1, Steps: 257 | Train Loss: 0.5757599 Vali Loss: 0.3832793 Best vali loss: 0.3832793
	iters: 100, epoch: 2 | loss: 0.8494314
	speed: 0.0135s/iter; left time: 22.8833s
	iters: 200, epoch: 2 | loss: 0.9474215
	speed: 0.0063s/iter; left time: 10.0319s
Updating learning rate to 0.00034714860354878927
Validation loss decreased (0.3833 --> 0.3780).  Saving model state dict ...
Epoch: 2 cost time: 1.6612625122070312
Epoch: 2, Steps: 257 | Train Loss: 0.8984264 Vali Loss: 0.3780406 Best vali loss: 0.3780406
	iters: 100, epoch: 3 | loss: 0.3956438
	speed: 0.0135s/iter; left time: 19.5267s
	iters: 200, epoch: 3 | loss: 0.9012901
	speed: 0.0063s/iter; left time: 8.4206s
Updating learning rate to 0.00028117551168179393
Epoch: 3 cost time: 1.6443133354187012
Epoch: 3, Steps: 257 | Train Loss: 0.6484670 Vali Loss: 0.3806854 Best vali loss: 0.3780406
	iters: 100, epoch: 4 | loss: 0.5747083
	speed: 0.0131s/iter; left time: 15.5116s
	iters: 200, epoch: 4 | loss: 0.5449640
	speed: 0.0062s/iter; left time: 6.7314s
Updating learning rate to 0.0002033549438
Validation loss decreased (0.3780 --> 0.3724).  Saving model state dict ...
Epoch: 4 cost time: 1.6378018856048584
Epoch: 4, Steps: 257 | Train Loss: 0.5598361 Vali Loss: 0.3723865 Best vali loss: 0.3723865
	iters: 100, epoch: 5 | loss: 0.5899846
	speed: 0.0135s/iter; left time: 12.5313s
	iters: 200, epoch: 5 | loss: 0.6759123
	speed: 0.0064s/iter; left time: 5.2920s
Updating learning rate to 0.00012553437591820608
Validation loss decreased (0.3724 --> 0.3655).  Saving model state dict ...
Epoch: 5 cost time: 1.6679835319519043
Epoch: 5, Steps: 257 | Train Loss: 0.6329485 Vali Loss: 0.3654558 Best vali loss: 0.3654558
	iters: 100, epoch: 6 | loss: 0.5168198
	speed: 0.0137s/iter; left time: 9.2159s
	iters: 200, epoch: 6 | loss: 0.3451945
	speed: 0.0062s/iter; left time: 3.5534s
Updating learning rate to 5.956128405121074e-05
Validation loss decreased (0.3655 --> 0.3602).  Saving model state dict ...
Epoch: 6 cost time: 1.6481602191925049
Epoch: 6, Steps: 257 | Train Loss: 0.4310072 Vali Loss: 0.3601609 Best vali loss: 0.3601609
	iters: 100, epoch: 7 | loss: 0.3577735
	speed: 0.0135s/iter; left time: 5.6214s
	iters: 200, epoch: 7 | loss: 0.2956721
	speed: 0.0063s/iter; left time: 1.9741s
Updating learning rate to 1.547947338819701e-05
Epoch: 7 cost time: 1.6648895740509033
Epoch: 7, Steps: 257 | Train Loss: 0.3267228 Vali Loss: 0.3605048 Best vali loss: 0.3601609
	iters: 100, epoch: 8 | loss: 0.4139497
	speed: 0.0132s/iter; left time: 2.0800s
	iters: 200, epoch: 8 | loss: 0.5208275
	speed: 0.0063s/iter; left time: 0.3669s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6758160591125488
Epoch: 8, Steps: 257 | Train Loss: 0.4673886 Vali Loss: 0.3647202 Best vali loss: 0.3601609

best validation loss 0.36016094884258826

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014289655375, 'e_layers': 4, 'learning_rate': 0.0004223773799, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6269760
	speed: 0.0113s/iter; left time: 45.1960s
	iters: 200, epoch: 1 | loss: 0.8429301
	speed: 0.0050s/iter; left time: 19.5639s
	iters: 300, epoch: 1 | loss: 1.4319429
	speed: 0.0051s/iter; left time: 19.3211s
	iters: 400, epoch: 1 | loss: 0.3016925
	speed: 0.0053s/iter; left time: 19.7874s
	iters: 500, epoch: 1 | loss: 0.9639506
	speed: 0.0052s/iter; left time: 18.8927s
Updating learning rate to 0.0004223773799
Validation loss decreased (inf --> 0.3837).  Saving model state dict ...
Epoch: 1 cost time: 2.990785837173462
Epoch: 1, Steps: 514 | Train Loss: 0.8334984 Vali Loss: 0.3836802 Best vali loss: 0.3836802
	iters: 100, epoch: 2 | loss: 1.0435269
	speed: 0.0104s/iter; left time: 36.4947s
	iters: 200, epoch: 2 | loss: 0.6801984
	speed: 0.0051s/iter; left time: 17.4605s
	iters: 300, epoch: 2 | loss: 0.8469320
	speed: 0.0052s/iter; left time: 17.0588s
	iters: 400, epoch: 2 | loss: 0.8375843
	speed: 0.0052s/iter; left time: 16.5713s
	iters: 500, epoch: 2 | loss: 0.5900530
	speed: 0.0052s/iter; left time: 16.2160s
Updating learning rate to 0.00021118868995
Epoch: 2 cost time: 2.720896005630493
Epoch: 2, Steps: 514 | Train Loss: 0.7996589 Vali Loss: 0.3862638 Best vali loss: 0.3836802
	iters: 100, epoch: 3 | loss: 0.2979988
	speed: 0.0101s/iter; left time: 30.0655s
	iters: 200, epoch: 3 | loss: 0.5975748
	speed: 0.0052s/iter; left time: 14.8692s
	iters: 300, epoch: 3 | loss: 0.5398385
	speed: 0.0052s/iter; left time: 14.5765s
	iters: 400, epoch: 3 | loss: 1.0610669
	speed: 0.0053s/iter; left time: 14.1831s
	iters: 500, epoch: 3 | loss: 0.4653585
	speed: 0.0052s/iter; left time: 13.5300s
Updating learning rate to 0.000105594344975
Validation loss decreased (0.3837 --> 0.3826).  Saving model state dict ...
Epoch: 3 cost time: 2.729764461517334
Epoch: 3, Steps: 514 | Train Loss: 0.5923675 Vali Loss: 0.3825617 Best vali loss: 0.3825617
	iters: 100, epoch: 4 | loss: 0.2927164
	speed: 0.0105s/iter; left time: 26.0379s
	iters: 200, epoch: 4 | loss: 0.6849052
	speed: 0.0054s/iter; left time: 12.7008s
	iters: 300, epoch: 4 | loss: 1.1272312
	speed: 0.0053s/iter; left time: 12.0618s
	iters: 400, epoch: 4 | loss: 0.3392920
	speed: 0.0051s/iter; left time: 10.9987s
	iters: 500, epoch: 4 | loss: 1.1223890
	speed: 0.0051s/iter; left time: 10.5381s
Updating learning rate to 5.27971724875e-05
Validation loss decreased (0.3826 --> 0.3757).  Saving model state dict ...
Epoch: 4 cost time: 2.7276699542999268
Epoch: 4, Steps: 514 | Train Loss: 0.7133068 Vali Loss: 0.3756855 Best vali loss: 0.3756855
	iters: 100, epoch: 5 | loss: 0.4699877
	speed: 0.0105s/iter; left time: 20.5722s
	iters: 200, epoch: 5 | loss: 0.3801200
	speed: 0.0050s/iter; left time: 9.3239s
	iters: 300, epoch: 5 | loss: 0.5691285
	speed: 0.0047s/iter; left time: 8.1835s
	iters: 400, epoch: 5 | loss: 0.8746281
	speed: 0.0048s/iter; left time: 7.9861s
	iters: 500, epoch: 5 | loss: 0.3429715
	speed: 0.0050s/iter; left time: 7.7857s
Updating learning rate to 2.639858624375e-05
Epoch: 5 cost time: 2.584934949874878
Epoch: 5, Steps: 514 | Train Loss: 0.5273671 Vali Loss: 0.3762914 Best vali loss: 0.3756855
	iters: 100, epoch: 6 | loss: 0.5939204
	speed: 0.0100s/iter; left time: 14.4067s
	iters: 200, epoch: 6 | loss: 0.6124198
	speed: 0.0053s/iter; left time: 7.1362s
	iters: 300, epoch: 6 | loss: 0.5065269
	speed: 0.0052s/iter; left time: 6.4087s
	iters: 400, epoch: 6 | loss: 0.4209921
	speed: 0.0049s/iter; left time: 5.6473s
	iters: 500, epoch: 6 | loss: 0.6026872
	speed: 0.0049s/iter; left time: 5.1054s
Updating learning rate to 1.3199293121875e-05
Epoch: 6 cost time: 2.6384105682373047
Epoch: 6, Steps: 514 | Train Loss: 0.5473093 Vali Loss: 0.3794238 Best vali loss: 0.3756855
	iters: 100, epoch: 7 | loss: 0.9868510
	speed: 0.0096s/iter; left time: 8.8745s
	iters: 200, epoch: 7 | loss: 1.0316098
	speed: 0.0048s/iter; left time: 4.0189s
	iters: 300, epoch: 7 | loss: 0.7445554
	speed: 0.0047s/iter; left time: 3.4552s
	iters: 400, epoch: 7 | loss: 0.3285280
	speed: 0.0046s/iter; left time: 2.8857s
	iters: 500, epoch: 7 | loss: 0.6794381
	speed: 0.0048s/iter; left time: 2.5197s
Updating learning rate to 6.5996465609375e-06
Epoch: 7 cost time: 2.476895332336426
Epoch: 7, Steps: 514 | Train Loss: 0.7541965 Vali Loss: 0.3771111 Best vali loss: 0.3756855
	iters: 100, epoch: 8 | loss: 0.6638363
	speed: 0.0096s/iter; left time: 3.9728s
	iters: 200, epoch: 8 | loss: 0.3299976
	speed: 0.0047s/iter; left time: 1.4867s
	iters: 300, epoch: 8 | loss: 0.4112290
	speed: 0.0048s/iter; left time: 1.0315s
	iters: 400, epoch: 8 | loss: 0.2722354
	speed: 0.0052s/iter; left time: 0.5930s
	iters: 500, epoch: 8 | loss: 1.0307611
	speed: 0.0050s/iter; left time: 0.0757s
Updating learning rate to 3.29982328046875e-06
Epoch: 8 cost time: 2.5780534744262695
Epoch: 8, Steps: 514 | Train Loss: 0.5416119 Vali Loss: 0.3782073 Best vali loss: 0.3756855

best validation loss 0.37568550626280733

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.007496089127, 'e_layers': 1, 'learning_rate': 0.0001317214395, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8673555
	speed: 0.0088s/iter; left time: 8.1735s
Updating learning rate to 0.0001317214395
Validation loss decreased (inf --> 0.4197).  Saving model state dict ...
Epoch: 1 cost time: 0.7715890407562256
Epoch: 1, Steps: 129 | Train Loss: 0.8673555 Vali Loss: 0.4196739 Best vali loss: 0.4196739
	iters: 100, epoch: 2 | loss: 0.8525650
	speed: 0.0056s/iter; left time: 4.5200s
Updating learning rate to 6.586071975e-05
Validation loss decreased (0.4197 --> 0.4001).  Saving model state dict ...
Epoch: 2 cost time: 0.41036367416381836
Epoch: 2, Steps: 129 | Train Loss: 0.8525650 Vali Loss: 0.4000698 Best vali loss: 0.4000698
	iters: 100, epoch: 3 | loss: 0.5795858
	speed: 0.0055s/iter; left time: 3.6952s
Updating learning rate to 3.2930359875e-05
Validation loss decreased (0.4001 --> 0.3936).  Saving model state dict ...
Epoch: 3 cost time: 0.40192222595214844
Epoch: 3, Steps: 129 | Train Loss: 0.5795858 Vali Loss: 0.3935970 Best vali loss: 0.3935970

best validation loss 0.393597048532752

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010566287723, 'e_layers': 2, 'learning_rate': 0.0003058362494, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4224300
	speed: 0.0119s/iter; left time: 11.1265s
Updating learning rate to 0.0003058362494
Validation loss decreased (inf --> 0.3621).  Saving model state dict ...
Epoch: 1 cost time: 1.0650296211242676
Epoch: 1, Steps: 129 | Train Loss: 0.4224300 Vali Loss: 0.3621000 Best vali loss: 0.3621000
	iters: 100, epoch: 2 | loss: 0.6625305
	speed: 0.0093s/iter; left time: 7.4964s
Updating learning rate to 0.0001529181247
Epoch: 2 cost time: 0.7411131858825684
Epoch: 2, Steps: 129 | Train Loss: 0.6625305 Vali Loss: 0.3719871 Best vali loss: 0.3621000
	iters: 100, epoch: 3 | loss: 0.6438383
	speed: 0.0092s/iter; left time: 6.1859s
Updating learning rate to 7.645906235e-05
Validation loss decreased (0.3621 --> 0.3603).  Saving model state dict ...
Epoch: 3 cost time: 0.7403724193572998
Epoch: 3, Steps: 129 | Train Loss: 0.6438383 Vali Loss: 0.3602904 Best vali loss: 0.3602904

best validation loss 0.36029037110697776

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010406860793, 'e_layers': 3, 'learning_rate': 0.0003866920548, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8775001
	speed: 0.0101s/iter; left time: 40.3508s
	iters: 200, epoch: 1 | loss: 0.9881283
	speed: 0.0040s/iter; left time: 15.8203s
	iters: 300, epoch: 1 | loss: 0.2718221
	speed: 0.0038s/iter; left time: 14.6685s
	iters: 400, epoch: 1 | loss: 1.1186855
	speed: 0.0040s/iter; left time: 14.9887s
	iters: 500, epoch: 1 | loss: 1.1137668
	speed: 0.0041s/iter; left time: 14.8388s
Updating learning rate to 0.0003866920548
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 2.463984251022339
Epoch: 1, Steps: 514 | Train Loss: 0.8739806 Vali Loss: 0.3675729 Best vali loss: 0.3675729
	iters: 100, epoch: 2 | loss: 0.3225958
	speed: 0.0085s/iter; left time: 29.5978s
	iters: 200, epoch: 2 | loss: 0.7298566
	speed: 0.0040s/iter; left time: 13.4786s
	iters: 300, epoch: 2 | loss: 0.3864369
	speed: 0.0039s/iter; left time: 12.9295s
	iters: 400, epoch: 2 | loss: 0.3702293
	speed: 0.0040s/iter; left time: 12.8561s
	iters: 500, epoch: 2 | loss: 0.6996965
	speed: 0.0040s/iter; left time: 12.3362s
Updating learning rate to 0.0001933460274
Epoch: 2 cost time: 2.0827829837799072
Epoch: 2, Steps: 514 | Train Loss: 0.5017630 Vali Loss: 0.3737973 Best vali loss: 0.3675729
	iters: 100, epoch: 3 | loss: 0.7274761
	speed: 0.0080s/iter; left time: 23.9541s
	iters: 200, epoch: 3 | loss: 0.3153378
	speed: 0.0038s/iter; left time: 11.0607s
	iters: 300, epoch: 3 | loss: 0.4007331
	speed: 0.0039s/iter; left time: 10.7502s
	iters: 400, epoch: 3 | loss: 0.3434477
	speed: 0.0039s/iter; left time: 10.3501s
	iters: 500, epoch: 3 | loss: 0.6089523
	speed: 0.0038s/iter; left time: 9.8517s
Updating learning rate to 9.66730137e-05
Validation loss decreased (0.3676 --> 0.3615).  Saving model state dict ...
Epoch: 3 cost time: 2.0126256942749023
Epoch: 3, Steps: 514 | Train Loss: 0.4791894 Vali Loss: 0.3615291 Best vali loss: 0.3615291

best validation loss 0.36152911828519785

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010566287723, 'e_layers': 2, 'learning_rate': 0.0003058362494, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3442791
	speed: 0.0121s/iter; left time: 6.5946s
Updating learning rate to 3.8229531175e-05
Validation loss decreased (0.3603 --> 0.3524).  Saving model state dict ...
Epoch: 4 cost time: 1.0595297813415527
Epoch: 4, Steps: 129 | Train Loss: 0.3442791 Vali Loss: 0.3524224 Best vali loss: 0.3524224
	iters: 100, epoch: 5 | loss: 0.5314579
	speed: 0.0095s/iter; left time: 3.9422s
Updating learning rate to 1.91147655875e-05
Validation loss decreased (0.3524 --> 0.3503).  Saving model state dict ...
Epoch: 5 cost time: 0.7386488914489746
Epoch: 5, Steps: 129 | Train Loss: 0.5314579 Vali Loss: 0.3503217 Best vali loss: 0.3503217
	iters: 100, epoch: 6 | loss: 0.5852637
	speed: 0.0095s/iter; left time: 2.7297s
Updating learning rate to 9.55738279375e-06
Epoch: 6 cost time: 0.748671293258667
Epoch: 6, Steps: 129 | Train Loss: 0.5852637 Vali Loss: 0.3533715 Best vali loss: 0.3503217
	iters: 100, epoch: 7 | loss: 0.4887737
	speed: 0.0093s/iter; left time: 1.4725s
Updating learning rate to 4.778691396875e-06
Epoch: 7 cost time: 0.737621545791626
Epoch: 7, Steps: 129 | Train Loss: 0.4887737 Vali Loss: 0.3507600 Best vali loss: 0.3503217
	iters: 100, epoch: 8 | loss: 0.5794069
	speed: 0.0092s/iter; left time: 0.2772s
Updating learning rate to 2.3893456984375e-06
Epoch: 8 cost time: 0.7452921867370605
Epoch: 8, Steps: 129 | Train Loss: 0.5794069 Vali Loss: 0.3511920 Best vali loss: 0.3503217

best validation loss 0.35032167678263426

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0008035317409, 'e_layers': 3, 'learning_rate': 0.0004004032373, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5178272
	speed: 0.0101s/iter; left time: 81.8996s
	iters: 200, epoch: 1 | loss: 0.6916358
	speed: 0.0043s/iter; left time: 34.7038s
	iters: 300, epoch: 1 | loss: 2.1933548
	speed: 0.0043s/iter; left time: 33.9985s
	iters: 400, epoch: 1 | loss: 1.0687995
	speed: 0.0043s/iter; left time: 33.7763s
	iters: 500, epoch: 1 | loss: 0.7403202
	speed: 0.0043s/iter; left time: 33.2411s
	iters: 600, epoch: 1 | loss: 0.9451922
	speed: 0.0041s/iter; left time: 31.2832s
	iters: 700, epoch: 1 | loss: 1.0391914
	speed: 0.0040s/iter; left time: 30.0632s
	iters: 800, epoch: 1 | loss: 1.0196331
	speed: 0.0039s/iter; left time: 28.7183s
	iters: 900, epoch: 1 | loss: 0.2513705
	speed: 0.0038s/iter; left time: 28.0843s
	iters: 1000, epoch: 1 | loss: 1.0803993
	speed: 0.0037s/iter; left time: 26.8976s
Updating learning rate to 0.0004004032373
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 4.584427356719971
Epoch: 1, Steps: 1027 | Train Loss: 0.9547724 Vali Loss: 0.3704235 Best vali loss: 0.3704235
	iters: 100, epoch: 2 | loss: 0.8817312
	speed: 0.0113s/iter; left time: 80.4078s
	iters: 200, epoch: 2 | loss: 0.4883871
	speed: 0.0042s/iter; left time: 29.6929s
	iters: 300, epoch: 2 | loss: 0.2317207
	speed: 0.0044s/iter; left time: 30.0352s
	iters: 400, epoch: 2 | loss: 0.6556309
	speed: 0.0043s/iter; left time: 29.3893s
	iters: 500, epoch: 2 | loss: 1.3261014
	speed: 0.0043s/iter; left time: 28.4811s
	iters: 600, epoch: 2 | loss: 0.8759485
	speed: 0.0042s/iter; left time: 27.5293s
	iters: 700, epoch: 2 | loss: 0.3174711
	speed: 0.0042s/iter; left time: 27.3671s
	iters: 800, epoch: 2 | loss: 0.6621295
	speed: 0.0042s/iter; left time: 27.0162s
	iters: 900, epoch: 2 | loss: 1.1749281
	speed: 0.0042s/iter; left time: 26.4661s
	iters: 1000, epoch: 2 | loss: 0.5622165
	speed: 0.0042s/iter; left time: 26.1621s
Updating learning rate to 0.00020020161865
Epoch: 2 cost time: 4.395855903625488
Epoch: 2, Steps: 1027 | Train Loss: 0.7176265 Vali Loss: 0.3894506 Best vali loss: 0.3704235
	iters: 100, epoch: 3 | loss: 0.8530136
	speed: 0.0112s/iter; left time: 67.6385s
	iters: 200, epoch: 3 | loss: 0.8744867
	speed: 0.0042s/iter; left time: 25.1537s
	iters: 300, epoch: 3 | loss: 0.5754535
	speed: 0.0042s/iter; left time: 24.6240s
	iters: 400, epoch: 3 | loss: 0.5205621
	speed: 0.0042s/iter; left time: 24.4409s
	iters: 500, epoch: 3 | loss: 0.2826908
	speed: 0.0042s/iter; left time: 23.8790s
	iters: 600, epoch: 3 | loss: 0.3626957
	speed: 0.0042s/iter; left time: 23.4299s
	iters: 700, epoch: 3 | loss: 0.1703797
	speed: 0.0042s/iter; left time: 22.8569s
	iters: 800, epoch: 3 | loss: 2.0035937
	speed: 0.0043s/iter; left time: 22.8835s
	iters: 900, epoch: 3 | loss: 1.9955485
	speed: 0.0042s/iter; left time: 22.3555s
	iters: 1000, epoch: 3 | loss: 0.9407095
	speed: 0.0042s/iter; left time: 21.7670s
Updating learning rate to 0.000100100809325
Epoch: 3 cost time: 4.385507583618164
Epoch: 3, Steps: 1027 | Train Loss: 0.8579134 Vali Loss: 0.3877836 Best vali loss: 0.3704235
	iters: 100, epoch: 4 | loss: 0.9651129
	speed: 0.0109s/iter; left time: 54.8841s
	iters: 200, epoch: 4 | loss: 0.2599802
	speed: 0.0040s/iter; left time: 19.6366s
	iters: 300, epoch: 4 | loss: 0.8274294
	speed: 0.0040s/iter; left time: 19.1514s
	iters: 400, epoch: 4 | loss: 0.3735866
	speed: 0.0040s/iter; left time: 18.9478s
	iters: 500, epoch: 4 | loss: 0.2629048
	speed: 0.0040s/iter; left time: 18.5486s
	iters: 600, epoch: 4 | loss: 0.9724445
	speed: 0.0040s/iter; left time: 18.1354s
	iters: 700, epoch: 4 | loss: 1.3637192
	speed: 0.0040s/iter; left time: 17.7426s
	iters: 800, epoch: 4 | loss: 0.4194693
	speed: 0.0040s/iter; left time: 17.3461s
	iters: 900, epoch: 4 | loss: 0.8636784
	speed: 0.0040s/iter; left time: 16.9388s
	iters: 1000, epoch: 4 | loss: 0.8594438
	speed: 0.0040s/iter; left time: 16.5481s
Updating learning rate to 5.00504046625e-05
Validation loss decreased (0.3704 --> 0.3697).  Saving model state dict ...
Epoch: 4 cost time: 4.140990734100342
Epoch: 4, Steps: 1027 | Train Loss: 0.7167769 Vali Loss: 0.3696996 Best vali loss: 0.3696996
	iters: 100, epoch: 5 | loss: 0.4460284
	speed: 0.0116s/iter; left time: 46.5412s
	iters: 200, epoch: 5 | loss: 0.3494706
	speed: 0.0038s/iter; left time: 14.8443s
	iters: 300, epoch: 5 | loss: 0.1467120
	speed: 0.0038s/iter; left time: 14.5129s
	iters: 400, epoch: 5 | loss: 0.2441006
	speed: 0.0038s/iter; left time: 14.1431s
	iters: 500, epoch: 5 | loss: 0.4729383
	speed: 0.0039s/iter; left time: 14.2181s
	iters: 600, epoch: 5 | loss: 0.8590962
	speed: 0.0038s/iter; left time: 13.3423s
	iters: 700, epoch: 5 | loss: 1.0281000
	speed: 0.0039s/iter; left time: 13.3540s
	iters: 800, epoch: 5 | loss: 0.2379023
	speed: 0.0040s/iter; left time: 13.1043s
	iters: 900, epoch: 5 | loss: 1.0438043
	speed: 0.0040s/iter; left time: 12.7321s
	iters: 1000, epoch: 5 | loss: 0.7341692
	speed: 0.0038s/iter; left time: 11.8151s
Updating learning rate to 2.502520233125e-05
Epoch: 5 cost time: 4.014662742614746
Epoch: 5, Steps: 1027 | Train Loss: 0.5562322 Vali Loss: 0.3719076 Best vali loss: 0.3696996
	iters: 100, epoch: 6 | loss: 0.8719001
	speed: 0.0106s/iter; left time: 31.6391s
	iters: 200, epoch: 6 | loss: 0.3543594
	speed: 0.0036s/iter; left time: 10.4783s
	iters: 300, epoch: 6 | loss: 0.3710647
	speed: 0.0036s/iter; left time: 10.1386s
	iters: 400, epoch: 6 | loss: 0.2508610
	speed: 0.0036s/iter; left time: 9.7481s
	iters: 500, epoch: 6 | loss: 0.3790036
	speed: 0.0036s/iter; left time: 9.4057s
	iters: 600, epoch: 6 | loss: 0.1977399
	speed: 0.0036s/iter; left time: 9.0495s
	iters: 700, epoch: 6 | loss: 0.5466492
	speed: 0.0037s/iter; left time: 8.8563s
	iters: 800, epoch: 6 | loss: 0.6550314
	speed: 0.0038s/iter; left time: 8.6350s
	iters: 900, epoch: 6 | loss: 0.8122311
	speed: 0.0037s/iter; left time: 8.1115s
	iters: 1000, epoch: 6 | loss: 0.3084285
	speed: 0.0037s/iter; left time: 7.7451s
Updating learning rate to 1.2512601165625e-05
Epoch: 6 cost time: 3.817525863647461
Epoch: 6, Steps: 1027 | Train Loss: 0.4747269 Vali Loss: 0.3751262 Best vali loss: 0.3696996
	iters: 100, epoch: 7 | loss: 0.6810740
	speed: 0.0108s/iter; left time: 21.1278s
	iters: 200, epoch: 7 | loss: 0.5636210
	speed: 0.0038s/iter; left time: 7.1098s
	iters: 300, epoch: 7 | loss: 0.4970520
	speed: 0.0038s/iter; left time: 6.6846s
	iters: 400, epoch: 7 | loss: 0.2181984
	speed: 0.0038s/iter; left time: 6.2487s
	iters: 500, epoch: 7 | loss: 0.9353715
	speed: 0.0038s/iter; left time: 5.9161s
	iters: 600, epoch: 7 | loss: 0.2415651
	speed: 0.0038s/iter; left time: 5.5168s
	iters: 700, epoch: 7 | loss: 0.8476420
	speed: 0.0038s/iter; left time: 5.1419s
	iters: 800, epoch: 7 | loss: 0.6933063
	speed: 0.0038s/iter; left time: 4.7504s
	iters: 900, epoch: 7 | loss: 0.2304125
	speed: 0.0038s/iter; left time: 4.4044s
	iters: 1000, epoch: 7 | loss: 0.3771451
	speed: 0.0039s/iter; left time: 4.1313s
Updating learning rate to 6.2563005828125e-06
Epoch: 7 cost time: 3.955110788345337
Epoch: 7, Steps: 1027 | Train Loss: 0.5285388 Vali Loss: 0.3724156 Best vali loss: 0.3696996
	iters: 100, epoch: 8 | loss: 0.2385751
	speed: 0.0109s/iter; left time: 10.0966s
	iters: 200, epoch: 8 | loss: 0.3717010
	speed: 0.0037s/iter; left time: 3.0583s
	iters: 300, epoch: 8 | loss: 0.8483214
	speed: 0.0037s/iter; left time: 2.6716s
	iters: 400, epoch: 8 | loss: 0.3060336
	speed: 0.0037s/iter; left time: 2.2928s
	iters: 500, epoch: 8 | loss: 0.8204582
	speed: 0.0037s/iter; left time: 1.9442s
	iters: 600, epoch: 8 | loss: 0.2225395
	speed: 0.0037s/iter; left time: 1.5819s
	iters: 700, epoch: 8 | loss: 0.7320548
	speed: 0.0040s/iter; left time: 1.3122s
	iters: 800, epoch: 8 | loss: 0.9789091
	speed: 0.0040s/iter; left time: 0.9102s
	iters: 900, epoch: 8 | loss: 0.9254709
	speed: 0.0040s/iter; left time: 0.5107s
	iters: 1000, epoch: 8 | loss: 0.1619489
	speed: 0.0040s/iter; left time: 0.1122s
Updating learning rate to 3.12815029140625e-06
Epoch: 8 cost time: 3.960596799850464
Epoch: 8, Steps: 1027 | Train Loss: 0.5606013 Vali Loss: 0.3730480 Best vali loss: 0.3696996

best validation loss 0.3696995669474536

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010448785476, 'e_layers': 3, 'learning_rate': 0.0003801453759, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8770650
	speed: 0.0106s/iter; left time: 42.6208s
	iters: 200, epoch: 1 | loss: 0.9790680
	speed: 0.0042s/iter; left time: 16.5091s
	iters: 300, epoch: 1 | loss: 0.2768657
	speed: 0.0041s/iter; left time: 15.6628s
	iters: 400, epoch: 1 | loss: 1.1211920
	speed: 0.0041s/iter; left time: 15.2451s
	iters: 500, epoch: 1 | loss: 1.1215640
	speed: 0.0044s/iter; left time: 15.7385s
Updating learning rate to 0.0003801453759
Validation loss decreased (inf --> 0.3835).  Saving model state dict ...
Epoch: 1 cost time: 2.5343949794769287
Epoch: 1, Steps: 514 | Train Loss: 0.8751509 Vali Loss: 0.3835335 Best vali loss: 0.3835335
	iters: 100, epoch: 2 | loss: 0.3161103
	speed: 0.0087s/iter; left time: 30.5174s
	iters: 200, epoch: 2 | loss: 0.6977496
	speed: 0.0040s/iter; left time: 13.4978s
	iters: 300, epoch: 2 | loss: 0.3733634
	speed: 0.0039s/iter; left time: 12.9940s
	iters: 400, epoch: 2 | loss: 0.3641664
	speed: 0.0040s/iter; left time: 12.8117s
	iters: 500, epoch: 2 | loss: 0.8341539
	speed: 0.0040s/iter; left time: 12.5200s
Updating learning rate to 0.00019007268795
Validation loss decreased (0.3835 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 2.1027584075927734
Epoch: 2, Steps: 514 | Train Loss: 0.5171087 Vali Loss: 0.3740558 Best vali loss: 0.3740558
	iters: 100, epoch: 3 | loss: 0.7179961
	speed: 0.0089s/iter; left time: 26.6648s
	iters: 200, epoch: 3 | loss: 0.3507128
	speed: 0.0044s/iter; left time: 12.6841s
	iters: 300, epoch: 3 | loss: 0.3795097
	speed: 0.0043s/iter; left time: 11.9687s
	iters: 400, epoch: 3 | loss: 0.3346779
	speed: 0.0042s/iter; left time: 11.1751s
	iters: 500, epoch: 3 | loss: 0.5964761
	speed: 0.0043s/iter; left time: 11.1751s
Updating learning rate to 9.5036343975e-05
Validation loss decreased (0.3741 --> 0.3623).  Saving model state dict ...
Epoch: 3 cost time: 2.2782628536224365
Epoch: 3, Steps: 514 | Train Loss: 0.4758745 Vali Loss: 0.3622936 Best vali loss: 0.3622936
	iters: 100, epoch: 4 | loss: 0.3670770
	speed: 0.0085s/iter; left time: 21.0835s
	iters: 200, epoch: 4 | loss: 0.3040412
	speed: 0.0040s/iter; left time: 9.4756s
	iters: 300, epoch: 4 | loss: 0.7752907
	speed: 0.0040s/iter; left time: 8.9947s
	iters: 400, epoch: 4 | loss: 0.4391897
	speed: 0.0040s/iter; left time: 8.6589s
	iters: 500, epoch: 4 | loss: 0.4221425
	speed: 0.0040s/iter; left time: 8.1940s
Updating learning rate to 4.75181719875e-05
Validation loss decreased (0.3623 --> 0.3529).  Saving model state dict ...
Epoch: 4 cost time: 2.0840134620666504
Epoch: 4, Steps: 514 | Train Loss: 0.4615482 Vali Loss: 0.3528846 Best vali loss: 0.3528846
	iters: 100, epoch: 5 | loss: 0.6834620
	speed: 0.0083s/iter; left time: 16.2516s
	iters: 200, epoch: 5 | loss: 0.3039050
	speed: 0.0039s/iter; left time: 7.2864s
	iters: 300, epoch: 5 | loss: 0.3862008
	speed: 0.0039s/iter; left time: 6.8925s
	iters: 400, epoch: 5 | loss: 0.4308189
	speed: 0.0039s/iter; left time: 6.4752s
	iters: 500, epoch: 5 | loss: 0.2504415
	speed: 0.0040s/iter; left time: 6.2736s
Updating learning rate to 2.375908599375e-05
Validation loss decreased (0.3529 --> 0.3521).  Saving model state dict ...
Epoch: 5 cost time: 2.0567221641540527
Epoch: 5, Steps: 514 | Train Loss: 0.4109656 Vali Loss: 0.3520525 Best vali loss: 0.3520525
	iters: 100, epoch: 6 | loss: 0.2871182
	speed: 0.0083s/iter; left time: 11.9628s
	iters: 200, epoch: 6 | loss: 0.4702604
	speed: 0.0038s/iter; left time: 5.1656s
	iters: 300, epoch: 6 | loss: 0.5284371
	speed: 0.0039s/iter; left time: 4.8153s
	iters: 400, epoch: 6 | loss: 0.3357256
	speed: 0.0041s/iter; left time: 4.6604s
	iters: 500, epoch: 6 | loss: 0.3833795
	speed: 0.0040s/iter; left time: 4.1327s
Updating learning rate to 1.1879542996875e-05
Epoch: 6 cost time: 2.061584234237671
Epoch: 6, Steps: 514 | Train Loss: 0.4009841 Vali Loss: 0.3535554 Best vali loss: 0.3520525
	iters: 100, epoch: 7 | loss: 0.2408992
	speed: 0.0083s/iter; left time: 7.6926s
	iters: 200, epoch: 7 | loss: 0.3375342
	speed: 0.0039s/iter; left time: 3.2563s
	iters: 300, epoch: 7 | loss: 0.2326782
	speed: 0.0037s/iter; left time: 2.6887s
	iters: 400, epoch: 7 | loss: 0.5706594
	speed: 0.0038s/iter; left time: 2.4183s
	iters: 500, epoch: 7 | loss: 0.3571285
	speed: 0.0040s/iter; left time: 2.1079s
Updating learning rate to 5.9397714984375e-06
Epoch: 7 cost time: 2.0394856929779053
Epoch: 7, Steps: 514 | Train Loss: 0.3477799 Vali Loss: 0.3552198 Best vali loss: 0.3520525
	iters: 100, epoch: 8 | loss: 0.3861244
	speed: 0.0082s/iter; left time: 3.4007s
	iters: 200, epoch: 8 | loss: 0.7158018
	speed: 0.0040s/iter; left time: 1.2633s
	iters: 300, epoch: 8 | loss: 0.8041174
	speed: 0.0039s/iter; left time: 0.8456s
	iters: 400, epoch: 8 | loss: 0.3443554
	speed: 0.0038s/iter; left time: 0.4346s
	iters: 500, epoch: 8 | loss: 0.6518804
	speed: 0.0037s/iter; left time: 0.0554s
Updating learning rate to 2.96988574921875e-06
Epoch: 8 cost time: 2.0284087657928467
Epoch: 8, Steps: 514 | Train Loss: 0.5804559 Vali Loss: 0.3564594 Best vali loss: 0.3520525

best validation loss 0.3520525344433391

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008029268279, 'e_layers': 4, 'learning_rate': 0.000390493284, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1493559
	speed: 0.0114s/iter; left time: 92.3968s
	iters: 200, epoch: 1 | loss: 0.5678648
	speed: 0.0052s/iter; left time: 41.7581s
	iters: 300, epoch: 1 | loss: 0.4707023
	speed: 0.0052s/iter; left time: 41.1821s
	iters: 400, epoch: 1 | loss: 0.3131114
	speed: 0.0049s/iter; left time: 38.6681s
	iters: 500, epoch: 1 | loss: 0.8402066
	speed: 0.0047s/iter; left time: 36.0494s
	iters: 600, epoch: 1 | loss: 0.2527737
	speed: 0.0047s/iter; left time: 35.8261s
	iters: 700, epoch: 1 | loss: 1.1378807
	speed: 0.0049s/iter; left time: 37.1620s
	iters: 800, epoch: 1 | loss: 0.3961203
	speed: 0.0049s/iter; left time: 36.1201s
	iters: 900, epoch: 1 | loss: 0.9962845
	speed: 0.0048s/iter; left time: 34.7724s
	iters: 1000, epoch: 1 | loss: 0.5864185
	speed: 0.0048s/iter; left time: 34.3022s
Updating learning rate to 0.000390493284
Validation loss decreased (inf --> 0.4033).  Saving model state dict ...
Epoch: 1 cost time: 5.39347767829895
Epoch: 1, Steps: 1027 | Train Loss: 0.6710719 Vali Loss: 0.4033238 Best vali loss: 0.4033238
	iters: 100, epoch: 2 | loss: 0.7371265
	speed: 0.0135s/iter; left time: 95.3946s
	iters: 200, epoch: 2 | loss: 0.8100529
	speed: 0.0047s/iter; left time: 32.7720s
	iters: 300, epoch: 2 | loss: 0.4062318
	speed: 0.0046s/iter; left time: 31.8196s
	iters: 400, epoch: 2 | loss: 0.5850996
	speed: 0.0046s/iter; left time: 31.3857s
	iters: 500, epoch: 2 | loss: 0.5854179
	speed: 0.0046s/iter; left time: 30.8741s
	iters: 600, epoch: 2 | loss: 0.3145640
	speed: 0.0045s/iter; left time: 29.8977s
	iters: 700, epoch: 2 | loss: 0.4596374
	speed: 0.0045s/iter; left time: 29.4112s
	iters: 800, epoch: 2 | loss: 0.4278583
	speed: 0.0046s/iter; left time: 29.2526s
	iters: 900, epoch: 2 | loss: 0.5152519
	speed: 0.0046s/iter; left time: 28.8706s
	iters: 1000, epoch: 2 | loss: 0.3047526
	speed: 0.0046s/iter; left time: 28.3280s
Updating learning rate to 0.000195246642
Validation loss decreased (0.4033 --> 0.3987).  Saving model state dict ...
Epoch: 2 cost time: 4.819458246231079
Epoch: 2, Steps: 1027 | Train Loss: 0.5145993 Vali Loss: 0.3986620 Best vali loss: 0.3986620
	iters: 100, epoch: 3 | loss: 0.4341795
	speed: 0.0129s/iter; left time: 78.2790s
	iters: 200, epoch: 3 | loss: 1.0480326
	speed: 0.0047s/iter; left time: 27.8725s
	iters: 300, epoch: 3 | loss: 0.7004620
	speed: 0.0047s/iter; left time: 27.4091s
	iters: 400, epoch: 3 | loss: 0.6123450
	speed: 0.0047s/iter; left time: 26.9064s
	iters: 500, epoch: 3 | loss: 0.8988149
	speed: 0.0047s/iter; left time: 26.7003s
	iters: 600, epoch: 3 | loss: 0.6821658
	speed: 0.0048s/iter; left time: 26.4880s
	iters: 700, epoch: 3 | loss: 1.3140408
	speed: 0.0047s/iter; left time: 25.6490s
	iters: 800, epoch: 3 | loss: 0.4342740
	speed: 0.0047s/iter; left time: 25.3847s
	iters: 900, epoch: 3 | loss: 1.3815407
	speed: 0.0047s/iter; left time: 24.5499s
	iters: 1000, epoch: 3 | loss: 0.3167895
	speed: 0.0047s/iter; left time: 24.2448s
Updating learning rate to 9.7623321e-05
Validation loss decreased (0.3987 --> 0.3985).  Saving model state dict ...
Epoch: 3 cost time: 4.852205514907837
Epoch: 3, Steps: 1027 | Train Loss: 0.7822645 Vali Loss: 0.3985343 Best vali loss: 0.3985343

best validation loss 0.39853428431835997

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0053187687904, 'e_layers': 4, 'learning_rate': 0.0003904966615, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5389935
	speed: 0.0124s/iter; left time: 49.7519s
	iters: 200, epoch: 1 | loss: 0.3997313
	speed: 0.0052s/iter; left time: 20.4377s
	iters: 300, epoch: 1 | loss: 0.4724597
	speed: 0.0052s/iter; left time: 19.8421s
	iters: 400, epoch: 1 | loss: 0.6698844
	speed: 0.0050s/iter; left time: 18.6011s
	iters: 500, epoch: 1 | loss: 0.6534843
	speed: 0.0049s/iter; left time: 17.7278s
Updating learning rate to 0.0003904966615
Validation loss decreased (inf --> 0.3841).  Saving model state dict ...
Epoch: 1 cost time: 3.15024995803833
Epoch: 1, Steps: 514 | Train Loss: 0.5469106 Vali Loss: 0.3840688 Best vali loss: 0.3840688
	iters: 100, epoch: 2 | loss: 0.3438998
	speed: 0.0102s/iter; left time: 35.8359s
	iters: 200, epoch: 2 | loss: 0.5184332
	speed: 0.0052s/iter; left time: 17.6362s
	iters: 300, epoch: 2 | loss: 0.9785459
	speed: 0.0051s/iter; left time: 16.9035s
	iters: 400, epoch: 2 | loss: 0.3120990
	speed: 0.0051s/iter; left time: 16.3744s
	iters: 500, epoch: 2 | loss: 0.3080621
	speed: 0.0051s/iter; left time: 15.7079s
Updating learning rate to 0.00019524833075
Validation loss decreased (0.3841 --> 0.3827).  Saving model state dict ...
Epoch: 2 cost time: 2.6757760047912598
Epoch: 2, Steps: 514 | Train Loss: 0.4922080 Vali Loss: 0.3826749 Best vali loss: 0.3826749
	iters: 100, epoch: 3 | loss: 0.7709007
	speed: 0.0106s/iter; left time: 31.6192s
	iters: 200, epoch: 3 | loss: 0.7038623
	speed: 0.0051s/iter; left time: 14.8189s
	iters: 300, epoch: 3 | loss: 0.9199048
	speed: 0.0052s/iter; left time: 14.4472s
	iters: 400, epoch: 3 | loss: 0.3174403
	speed: 0.0052s/iter; left time: 14.0508s
	iters: 500, epoch: 3 | loss: 0.3394031
	speed: 0.0053s/iter; left time: 13.7635s
Updating learning rate to 9.7624165375e-05
Validation loss decreased (0.3827 --> 0.3745).  Saving model state dict ...
Epoch: 3 cost time: 2.7299909591674805
Epoch: 3, Steps: 514 | Train Loss: 0.6103022 Vali Loss: 0.3745479 Best vali loss: 0.3745479

best validation loss 0.374547880232217

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0066524636383, 'e_layers': 4, 'learning_rate': 0.0004881640338, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7429046
	speed: 0.0106s/iter; left time: 20.6479s
	iters: 200, epoch: 1 | loss: 0.5932127
	speed: 0.0048s/iter; left time: 8.9469s
Updating learning rate to 0.0004881640338
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.614959478378296
Epoch: 1, Steps: 257 | Train Loss: 0.6680586 Vali Loss: 0.3687993 Best vali loss: 0.3687993
	iters: 100, epoch: 2 | loss: 0.4476684
	speed: 0.0103s/iter; left time: 17.5534s
	iters: 200, epoch: 2 | loss: 0.5407094
	speed: 0.0050s/iter; left time: 7.9270s
Updating learning rate to 0.0002440820169
Epoch: 2 cost time: 1.3051397800445557
Epoch: 2, Steps: 257 | Train Loss: 0.4941889 Vali Loss: 0.3748290 Best vali loss: 0.3687993
	iters: 100, epoch: 3 | loss: 0.6462765
	speed: 0.0104s/iter; left time: 14.9793s
	iters: 200, epoch: 3 | loss: 0.8739433
	speed: 0.0046s/iter; left time: 6.1860s
Updating learning rate to 0.00012204100845
Validation loss decreased (0.3688 --> 0.3572).  Saving model state dict ...
Epoch: 3 cost time: 1.2488899230957031
Epoch: 3, Steps: 257 | Train Loss: 0.7601099 Vali Loss: 0.3571505 Best vali loss: 0.3571505

best validation loss 0.35715049330752585

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0066524636383, 'e_layers': 4, 'learning_rate': 0.0004881640338, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6472945
	speed: 0.0119s/iter; left time: 14.0817s
	iters: 200, epoch: 4 | loss: 0.5359683
	speed: 0.0055s/iter; left time: 5.9801s
Updating learning rate to 6.1020504225e-05
Validation loss decreased (0.3572 --> 0.3483).  Saving model state dict ...
Epoch: 4 cost time: 1.7454426288604736
Epoch: 4, Steps: 257 | Train Loss: 0.5916314 Vali Loss: 0.3482650 Best vali loss: 0.3482650
	iters: 100, epoch: 5 | loss: 0.4044487
	speed: 0.0110s/iter; left time: 10.2469s
	iters: 200, epoch: 5 | loss: 0.4014760
	speed: 0.0052s/iter; left time: 4.2920s
Updating learning rate to 3.05102521125e-05
Epoch: 5 cost time: 1.352247953414917
Epoch: 5, Steps: 257 | Train Loss: 0.4029623 Vali Loss: 0.3520021 Best vali loss: 0.3482650
	iters: 100, epoch: 6 | loss: 0.5292721
	speed: 0.0110s/iter; left time: 7.3863s
	iters: 200, epoch: 6 | loss: 0.7848384
	speed: 0.0051s/iter; left time: 2.9043s
Updating learning rate to 1.525512605625e-05
Epoch: 6 cost time: 1.3624389171600342
Epoch: 6, Steps: 257 | Train Loss: 0.6570552 Vali Loss: 0.3519323 Best vali loss: 0.3482650
	iters: 100, epoch: 7 | loss: 0.4153480
	speed: 0.0105s/iter; left time: 4.3751s
	iters: 200, epoch: 7 | loss: 0.5526505
	speed: 0.0050s/iter; left time: 1.5789s
Updating learning rate to 7.627563028125e-06
Epoch: 7 cost time: 1.3220837116241455
Epoch: 7, Steps: 257 | Train Loss: 0.4839993 Vali Loss: 0.3551957 Best vali loss: 0.3482650
	iters: 100, epoch: 8 | loss: 0.3434563
	speed: 0.0105s/iter; left time: 1.6522s
	iters: 200, epoch: 8 | loss: 0.3640214
	speed: 0.0050s/iter; left time: 0.2881s
Updating learning rate to 3.8137815140625e-06
Epoch: 8 cost time: 1.328672170639038
Epoch: 8, Steps: 257 | Train Loss: 0.3537388 Vali Loss: 0.3562413 Best vali loss: 0.3482650

best validation loss 0.3482650440661987

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020772864038, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 0.7556650638580322
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703667 Best vali loss: 0.3703667
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3704 --> 0.3565).  Saving model state dict ...
Epoch: 2 cost time: 0.45239830017089844
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3565061 Best vali loss: 0.3565061
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3565 --> 0.3463).  Saving model state dict ...
Epoch: 3 cost time: 0.44213199615478516
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3463371 Best vali loss: 0.3463371
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.4433417320251465
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3478155 Best vali loss: 0.3463371
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3463 --> 0.3419).  Saving model state dict ...
Epoch: 5 cost time: 0.4451179504394531
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3418678 Best vali loss: 0.3418678
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3419 --> 0.3407).  Saving model state dict ...
Epoch: 6 cost time: 0.44837331771850586
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3407420 Best vali loss: 0.3407420
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3407 --> 0.3404).  Saving model state dict ...
Epoch: 7 cost time: 0.44545865058898926
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3404095 Best vali loss: 0.3404095
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.44367194175720215
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3406264 Best vali loss: 0.3404095

best validation loss 0.34040953135209373

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0049351064573, 'e_layers': 1, 'learning_rate': 0.0008307231179, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5432311
	speed: 0.0089s/iter; left time: 17.4411s
	iters: 200, epoch: 1 | loss: 0.4930217
	speed: 0.0026s/iter; left time: 4.9190s
Updating learning rate to 0.0007991056018558853
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 1.0267372131347656
Epoch: 1, Steps: 257 | Train Loss: 0.5181264 Vali Loss: 0.3698470 Best vali loss: 0.3698470
	iters: 100, epoch: 2 | loss: 0.7846618
	speed: 0.0065s/iter; left time: 11.1303s
	iters: 200, epoch: 2 | loss: 1.1710601
	speed: 0.0028s/iter; left time: 4.5430s
Updating learning rate to 0.0007090665339277609
Validation loss decreased (0.3698 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 0.7684831619262695
Epoch: 2, Steps: 257 | Train Loss: 0.9778610 Vali Loss: 0.3658516 Best vali loss: 0.3658516
	iters: 100, epoch: 3 | loss: 0.5854669
	speed: 0.0065s/iter; left time: 9.3972s
	iters: 200, epoch: 3 | loss: 0.4219700
	speed: 0.0027s/iter; left time: 3.5993s
Updating learning rate to 0.0005743135460015006
Epoch: 3 cost time: 0.7394492626190186
Epoch: 3, Steps: 257 | Train Loss: 0.5037185 Vali Loss: 0.3709606 Best vali loss: 0.3658516
	iters: 100, epoch: 4 | loss: 0.6026631
	speed: 0.0065s/iter; left time: 7.6862s
	iters: 200, epoch: 4 | loss: 0.6815872
	speed: 0.0027s/iter; left time: 2.9582s
Updating learning rate to 0.00041536155895
Epoch: 4 cost time: 0.7518062591552734
Epoch: 4, Steps: 257 | Train Loss: 0.6421251 Vali Loss: 0.3776279 Best vali loss: 0.3658516
	iters: 100, epoch: 5 | loss: 0.5054154
	speed: 0.0063s/iter; left time: 5.8155s
	iters: 200, epoch: 5 | loss: 0.6124608
	speed: 0.0024s/iter; left time: 1.9894s
Updating learning rate to 0.00025640957189849945
Epoch: 5 cost time: 0.6658966541290283
Epoch: 5, Steps: 257 | Train Loss: 0.5589381 Vali Loss: 0.3844404 Best vali loss: 0.3658516
	iters: 100, epoch: 6 | loss: 0.3265886
	speed: 0.0060s/iter; left time: 4.0406s
	iters: 200, epoch: 6 | loss: 0.4196540
	speed: 0.0024s/iter; left time: 1.3901s
Updating learning rate to 0.00012165658397223911
Epoch: 6 cost time: 0.6660442352294922
Epoch: 6, Steps: 257 | Train Loss: 0.3731213 Vali Loss: 0.3945333 Best vali loss: 0.3658516
	iters: 100, epoch: 7 | loss: 0.5150064
	speed: 0.0059s/iter; left time: 2.4524s
	iters: 200, epoch: 7 | loss: 0.5064535
	speed: 0.0025s/iter; left time: 0.7772s
Updating learning rate to 3.1617516044114733e-05
Epoch: 7 cost time: 0.6724371910095215
Epoch: 7, Steps: 257 | Train Loss: 0.5107299 Vali Loss: 0.3814488 Best vali loss: 0.3658516
	iters: 100, epoch: 8 | loss: 0.3085615
	speed: 0.0062s/iter; left time: 0.9805s
	iters: 200, epoch: 8 | loss: 0.6367048
	speed: 0.0024s/iter; left time: 0.1403s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6710562705993652
Epoch: 8, Steps: 257 | Train Loss: 0.4726331 Vali Loss: 0.3841127 Best vali loss: 0.3658516

best validation loss 0.3658516313331769

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0034705286329, 'e_layers': 4, 'learning_rate': 0.000395400369, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4961942
	speed: 0.0120s/iter; left time: 48.1689s
	iters: 200, epoch: 1 | loss: 0.6405756
	speed: 0.0056s/iter; left time: 22.0845s
	iters: 300, epoch: 1 | loss: 0.3236063
	speed: 0.0056s/iter; left time: 21.3798s
	iters: 400, epoch: 1 | loss: 0.8188881
	speed: 0.0056s/iter; left time: 20.8496s
	iters: 500, epoch: 1 | loss: 0.5040616
	speed: 0.0053s/iter; left time: 19.3042s
Updating learning rate to 0.000395400369
Validation loss decreased (inf --> 0.3937).  Saving model state dict ...
Epoch: 1 cost time: 3.2272658348083496
Epoch: 1, Steps: 514 | Train Loss: 0.5566652 Vali Loss: 0.3936875 Best vali loss: 0.3936875
	iters: 100, epoch: 2 | loss: 0.7051152
	speed: 0.0112s/iter; left time: 39.2306s
	iters: 200, epoch: 2 | loss: 0.5192035
	speed: 0.0055s/iter; left time: 18.7501s
	iters: 300, epoch: 2 | loss: 1.0055660
	speed: 0.0055s/iter; left time: 18.1428s
	iters: 400, epoch: 2 | loss: 1.0704679
	speed: 0.0053s/iter; left time: 16.8387s
	iters: 500, epoch: 2 | loss: 1.1014327
	speed: 0.0054s/iter; left time: 16.6409s
Updating learning rate to 0.0001977001845
Epoch: 2 cost time: 2.8329596519470215
Epoch: 2, Steps: 514 | Train Loss: 0.8803571 Vali Loss: 0.3962405 Best vali loss: 0.3936875
	iters: 100, epoch: 3 | loss: 0.8412693
	speed: 0.0107s/iter; left time: 31.9952s
	iters: 200, epoch: 3 | loss: 0.7379784
	speed: 0.0055s/iter; left time: 15.7901s
	iters: 300, epoch: 3 | loss: 0.8184869
	speed: 0.0056s/iter; left time: 15.4918s
	iters: 400, epoch: 3 | loss: 0.5062488
	speed: 0.0056s/iter; left time: 15.0207s
	iters: 500, epoch: 3 | loss: 0.8743411
	speed: 0.0055s/iter; left time: 14.1790s
Updating learning rate to 9.885009225e-05
Validation loss decreased (0.3937 --> 0.3902).  Saving model state dict ...
Epoch: 3 cost time: 2.8717026710510254
Epoch: 3, Steps: 514 | Train Loss: 0.7556649 Vali Loss: 0.3901747 Best vali loss: 0.3901747

best validation loss 0.390174697395158

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063702919195, 'e_layers': 4, 'learning_rate': 6.78613678e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8189957
	speed: 0.0116s/iter; left time: 94.1734s
	iters: 200, epoch: 1 | loss: 0.3864651
	speed: 0.0055s/iter; left time: 43.8216s
	iters: 300, epoch: 1 | loss: 0.3636135
	speed: 0.0055s/iter; left time: 43.3112s
	iters: 400, epoch: 1 | loss: 0.4385260
	speed: 0.0055s/iter; left time: 42.7904s
	iters: 500, epoch: 1 | loss: 1.2082459
	speed: 0.0055s/iter; left time: 42.2903s
	iters: 600, epoch: 1 | loss: 0.3416733
	speed: 0.0055s/iter; left time: 41.8855s
	iters: 700, epoch: 1 | loss: 0.4192318
	speed: 0.0056s/iter; left time: 41.7484s
	iters: 800, epoch: 1 | loss: 0.7124433
	speed: 0.0055s/iter; left time: 41.1300s
	iters: 900, epoch: 1 | loss: 0.2122798
	speed: 0.0055s/iter; left time: 40.2005s
	iters: 1000, epoch: 1 | loss: 0.9852986
	speed: 0.0055s/iter; left time: 39.8436s
Updating learning rate to 6.527854827932024e-05
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 6.001025915145874
Epoch: 1, Steps: 1027 | Train Loss: 0.5886773 Vali Loss: 0.3669177 Best vali loss: 0.3669177
	iters: 100, epoch: 2 | loss: 0.9790097
	speed: 0.0139s/iter; left time: 98.6894s
	iters: 200, epoch: 2 | loss: 0.7925103
	speed: 0.0053s/iter; left time: 37.2738s
	iters: 300, epoch: 2 | loss: 0.9280919
	speed: 0.0053s/iter; left time: 36.8167s
	iters: 400, epoch: 2 | loss: 0.3300329
	speed: 0.0053s/iter; left time: 36.2158s
	iters: 500, epoch: 2 | loss: 1.0929129
	speed: 0.0054s/iter; left time: 36.4561s
	iters: 600, epoch: 2 | loss: 1.0024339
	speed: 0.0054s/iter; left time: 35.6870s
	iters: 700, epoch: 2 | loss: 0.2634868
	speed: 0.0054s/iter; left time: 35.1419s
	iters: 800, epoch: 2 | loss: 0.3506305
	speed: 0.0054s/iter; left time: 34.6084s
	iters: 900, epoch: 2 | loss: 1.7000674
	speed: 0.0054s/iter; left time: 33.9792s
	iters: 1000, epoch: 2 | loss: 0.2853183
	speed: 0.0054s/iter; left time: 33.4584s
Updating learning rate to 5.792330057598721e-05
Epoch: 2 cost time: 5.575125694274902
Epoch: 2, Steps: 1027 | Train Loss: 0.7724495 Vali Loss: 0.3672656 Best vali loss: 0.3669177
	iters: 100, epoch: 3 | loss: 0.6542891
	speed: 0.0135s/iter; left time: 81.6754s
	iters: 200, epoch: 3 | loss: 0.7656147
	speed: 0.0054s/iter; left time: 32.3242s
	iters: 300, epoch: 3 | loss: 0.3088973
	speed: 0.0054s/iter; left time: 31.9364s
	iters: 400, epoch: 3 | loss: 0.7006063
	speed: 0.0054s/iter; left time: 31.3602s
	iters: 500, epoch: 3 | loss: 0.5604848
	speed: 0.0055s/iter; left time: 30.9799s
	iters: 600, epoch: 3 | loss: 0.2744422
	speed: 0.0054s/iter; left time: 30.1997s
	iters: 700, epoch: 3 | loss: 0.7866183
	speed: 0.0054s/iter; left time: 29.7503s
	iters: 800, epoch: 3 | loss: 0.3645199
	speed: 0.0055s/iter; left time: 29.2626s
	iters: 900, epoch: 3 | loss: 0.3080184
	speed: 0.0054s/iter; left time: 28.5214s
	iters: 1000, epoch: 3 | loss: 0.5377410
	speed: 0.0054s/iter; left time: 28.0457s
Updating learning rate to 4.691539447734689e-05
Validation loss decreased (0.3669 --> 0.3437).  Saving model state dict ...
Epoch: 3 cost time: 5.623371601104736
Epoch: 3, Steps: 1027 | Train Loss: 0.5261232 Vali Loss: 0.3436541 Best vali loss: 0.3436541

best validation loss 0.3436540509312467

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028976493662, 'e_layers': 2, 'learning_rate': 0.000396804463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7316992
	speed: 0.0095s/iter; left time: 38.1831s
	iters: 200, epoch: 1 | loss: 0.6224961
	speed: 0.0031s/iter; left time: 12.2196s
	iters: 300, epoch: 1 | loss: 0.4086854
	speed: 0.0032s/iter; left time: 12.1666s
	iters: 400, epoch: 1 | loss: 0.4859190
	speed: 0.0032s/iter; left time: 11.9365s
	iters: 500, epoch: 1 | loss: 1.1142551
	speed: 0.0032s/iter; left time: 11.5725s
Updating learning rate to 0.000396804463
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 1.9983468055725098
Epoch: 1, Steps: 514 | Train Loss: 0.6726109 Vali Loss: 0.3691705 Best vali loss: 0.3691705
	iters: 100, epoch: 2 | loss: 0.5093377
	speed: 0.0076s/iter; left time: 26.6234s
	iters: 200, epoch: 2 | loss: 0.3799713
	speed: 0.0033s/iter; left time: 11.3019s
	iters: 300, epoch: 2 | loss: 0.4572254
	speed: 0.0032s/iter; left time: 10.4480s
	iters: 400, epoch: 2 | loss: 0.3768761
	speed: 0.0031s/iter; left time: 9.8553s
	iters: 500, epoch: 2 | loss: 0.9332684
	speed: 0.0033s/iter; left time: 10.2847s
Updating learning rate to 0.0001984022315
Epoch: 2 cost time: 1.7186710834503174
Epoch: 2, Steps: 514 | Train Loss: 0.5313358 Vali Loss: 0.3914486 Best vali loss: 0.3691705
	iters: 100, epoch: 3 | loss: 0.5839965
	speed: 0.0073s/iter; left time: 21.6748s
	iters: 200, epoch: 3 | loss: 0.3090149
	speed: 0.0031s/iter; left time: 9.0009s
	iters: 300, epoch: 3 | loss: 0.4472125
	speed: 0.0032s/iter; left time: 9.0007s
	iters: 400, epoch: 3 | loss: 1.3213831
	speed: 0.0033s/iter; left time: 8.8018s
	iters: 500, epoch: 3 | loss: 0.3933310
	speed: 0.0032s/iter; left time: 8.3182s
Updating learning rate to 9.920111575e-05
Epoch: 3 cost time: 1.6998014450073242
Epoch: 3, Steps: 514 | Train Loss: 0.6109876 Vali Loss: 0.3762610 Best vali loss: 0.3691705

best validation loss 0.36917054594616994

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063702919195, 'e_layers': 4, 'learning_rate': 6.78613678e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7940887
	speed: 0.0123s/iter; left time: 61.7883s
	iters: 200, epoch: 4 | loss: 0.3728138
	speed: 0.0054s/iter; left time: 26.6691s
	iters: 300, epoch: 4 | loss: 0.2910929
	speed: 0.0054s/iter; left time: 26.0651s
	iters: 400, epoch: 4 | loss: 0.3055802
	speed: 0.0054s/iter; left time: 25.3428s
	iters: 500, epoch: 4 | loss: 0.8272655
	speed: 0.0053s/iter; left time: 24.5467s
	iters: 600, epoch: 4 | loss: 0.3241353
	speed: 0.0050s/iter; left time: 22.8318s
	iters: 700, epoch: 4 | loss: 0.3453838
	speed: 0.0051s/iter; left time: 22.5465s
	iters: 800, epoch: 4 | loss: 0.6630245
	speed: 0.0051s/iter; left time: 21.9009s
	iters: 900, epoch: 4 | loss: 0.1869329
	speed: 0.0051s/iter; left time: 21.5743s
	iters: 1000, epoch: 4 | loss: 0.7825258
	speed: 0.0051s/iter; left time: 21.1057s
Updating learning rate to 3.39306839e-05
Epoch: 4 cost time: 5.708184480667114
Epoch: 4, Steps: 1027 | Train Loss: 0.4892843 Vali Loss: 0.3478683 Best vali loss: 0.3436541
	iters: 100, epoch: 5 | loss: 0.7787952
	speed: 0.0132s/iter; left time: 52.7846s
	iters: 200, epoch: 5 | loss: 0.6615140
	speed: 0.0049s/iter; left time: 19.1629s
	iters: 300, epoch: 5 | loss: 0.6446889
	speed: 0.0050s/iter; left time: 18.8991s
	iters: 400, epoch: 5 | loss: 0.2826260
	speed: 0.0048s/iter; left time: 17.7977s
	iters: 500, epoch: 5 | loss: 0.9521796
	speed: 0.0049s/iter; left time: 17.6640s
	iters: 600, epoch: 5 | loss: 0.7637991
	speed: 0.0051s/iter; left time: 17.9016s
	iters: 700, epoch: 5 | loss: 0.2371229
	speed: 0.0051s/iter; left time: 17.3574s
	iters: 800, epoch: 5 | loss: 0.2983613
	speed: 0.0051s/iter; left time: 16.8344s
	iters: 900, epoch: 5 | loss: 1.3194482
	speed: 0.0051s/iter; left time: 16.3400s
	iters: 1000, epoch: 5 | loss: 0.2504624
	speed: 0.0051s/iter; left time: 15.8770s
Updating learning rate to 2.0945973322653114e-05
Epoch: 5 cost time: 5.1836090087890625
Epoch: 5, Steps: 1027 | Train Loss: 0.6188998 Vali Loss: 0.3723453 Best vali loss: 0.3436541
	iters: 100, epoch: 6 | loss: 0.6251950
	speed: 0.0132s/iter; left time: 39.3052s
	iters: 200, epoch: 6 | loss: 0.6228008
	speed: 0.0053s/iter; left time: 15.2228s
	iters: 300, epoch: 6 | loss: 0.3029914
	speed: 0.0053s/iter; left time: 14.7798s
	iters: 400, epoch: 6 | loss: 0.6250612
	speed: 0.0053s/iter; left time: 14.2359s
	iters: 500, epoch: 6 | loss: 0.3922003
	speed: 0.0049s/iter; left time: 12.6118s
	iters: 600, epoch: 6 | loss: 0.2599816
	speed: 0.0048s/iter; left time: 11.8155s
	iters: 700, epoch: 6 | loss: 0.4840964
	speed: 0.0048s/iter; left time: 11.3817s
	iters: 800, epoch: 6 | loss: 0.3366908
	speed: 0.0048s/iter; left time: 10.8934s
	iters: 900, epoch: 6 | loss: 0.2446745
	speed: 0.0048s/iter; left time: 10.4485s
	iters: 1000, epoch: 6 | loss: 0.4348632
	speed: 0.0048s/iter; left time: 9.9873s
Updating learning rate to 9.938067224012791e-06
Epoch: 6 cost time: 5.164828538894653
Epoch: 6, Steps: 1027 | Train Loss: 0.4328555 Vali Loss: 0.3637896 Best vali loss: 0.3436541
	iters: 100, epoch: 7 | loss: 0.4052512
	speed: 0.0126s/iter; left time: 24.7210s
	iters: 200, epoch: 7 | loss: 0.3062965
	speed: 0.0048s/iter; left time: 8.9491s
	iters: 300, epoch: 7 | loss: 0.2081582
	speed: 0.0048s/iter; left time: 8.4582s
	iters: 400, epoch: 7 | loss: 0.2661286
	speed: 0.0048s/iter; left time: 8.0078s
	iters: 500, epoch: 7 | loss: 0.4297174
	speed: 0.0048s/iter; left time: 7.4777s
	iters: 600, epoch: 7 | loss: 0.7439244
	speed: 0.0049s/iter; left time: 7.1755s
	iters: 700, epoch: 7 | loss: 0.7882313
	speed: 0.0052s/iter; left time: 7.0612s
	iters: 800, epoch: 7 | loss: 0.2536446
	speed: 0.0052s/iter; left time: 6.5396s
	iters: 900, epoch: 7 | loss: 0.4635980
	speed: 0.0052s/iter; left time: 5.9803s
	iters: 1000, epoch: 7 | loss: 0.3920977
	speed: 0.0052s/iter; left time: 5.4794s
Updating learning rate to 2.582819520679757e-06
Epoch: 7 cost time: 5.165853023529053
Epoch: 7, Steps: 1027 | Train Loss: 0.4257048 Vali Loss: 0.3786532 Best vali loss: 0.3436541
	iters: 100, epoch: 8 | loss: 0.2079101
	speed: 0.0129s/iter; left time: 11.9731s
	iters: 200, epoch: 8 | loss: 0.6386100
	speed: 0.0048s/iter; left time: 3.9517s
	iters: 300, epoch: 8 | loss: 0.2062861
	speed: 0.0048s/iter; left time: 3.4620s
	iters: 400, epoch: 8 | loss: 0.9339783
	speed: 0.0048s/iter; left time: 2.9855s
	iters: 500, epoch: 8 | loss: 0.5177863
	speed: 0.0048s/iter; left time: 2.5394s
	iters: 600, epoch: 8 | loss: 0.1930666
	speed: 0.0050s/iter; left time: 2.1583s
	iters: 700, epoch: 8 | loss: 0.1780656
	speed: 0.0051s/iter; left time: 1.6691s
	iters: 800, epoch: 8 | loss: 0.4675431
	speed: 0.0051s/iter; left time: 1.1514s
	iters: 900, epoch: 8 | loss: 0.1524180
	speed: 0.0051s/iter; left time: 0.6492s
	iters: 1000, epoch: 8 | loss: 0.3517484
	speed: 0.0050s/iter; left time: 0.1408s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.104010820388794
Epoch: 8, Steps: 1027 | Train Loss: 0.3847412 Vali Loss: 0.3773515 Best vali loss: 0.3436541

best validation loss 0.3436540509312467

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0035329796412, 'e_layers': 4, 'learning_rate': 0.0003933222292, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9675257
	speed: 0.0113s/iter; left time: 91.5616s
	iters: 200, epoch: 1 | loss: 0.2644025
	speed: 0.0051s/iter; left time: 40.8613s
	iters: 300, epoch: 1 | loss: 1.1556736
	speed: 0.0050s/iter; left time: 39.7469s
	iters: 400, epoch: 1 | loss: 0.5957984
	speed: 0.0051s/iter; left time: 39.9679s
	iters: 500, epoch: 1 | loss: 1.1996361
	speed: 0.0053s/iter; left time: 41.1831s
	iters: 600, epoch: 1 | loss: 0.5546627
	speed: 0.0054s/iter; left time: 41.0668s
	iters: 700, epoch: 1 | loss: 0.2724077
	speed: 0.0053s/iter; left time: 40.0632s
	iters: 800, epoch: 1 | loss: 0.3239458
	speed: 0.0053s/iter; left time: 39.5920s
	iters: 900, epoch: 1 | loss: 0.6320450
	speed: 0.0052s/iter; left time: 38.0578s
	iters: 1000, epoch: 1 | loss: 0.3947142
	speed: 0.0053s/iter; left time: 38.3056s
Updating learning rate to 0.0003933222292
Validation loss decreased (inf --> 0.4030).  Saving model state dict ...
Epoch: 1 cost time: 5.729605674743652
Epoch: 1, Steps: 1027 | Train Loss: 0.6360812 Vali Loss: 0.4029693 Best vali loss: 0.4029693
	iters: 100, epoch: 2 | loss: 1.4172977
	speed: 0.0133s/iter; left time: 94.2779s
	iters: 200, epoch: 2 | loss: 0.2399618
	speed: 0.0049s/iter; left time: 33.9074s
	iters: 300, epoch: 2 | loss: 0.4266997
	speed: 0.0049s/iter; left time: 33.4229s
	iters: 400, epoch: 2 | loss: 0.5677633
	speed: 0.0049s/iter; left time: 33.1353s
	iters: 500, epoch: 2 | loss: 1.8034539
	speed: 0.0048s/iter; left time: 32.4045s
	iters: 600, epoch: 2 | loss: 0.5500056
	speed: 0.0048s/iter; left time: 31.7576s
	iters: 700, epoch: 2 | loss: 1.4607263
	speed: 0.0050s/iter; left time: 32.2975s
	iters: 800, epoch: 2 | loss: 1.3981378
	speed: 0.0049s/iter; left time: 31.1623s
	iters: 900, epoch: 2 | loss: 0.3750938
	speed: 0.0049s/iter; left time: 30.7760s
	iters: 1000, epoch: 2 | loss: 0.4047319
	speed: 0.0049s/iter; left time: 30.5896s
Updating learning rate to 0.0001966611146
Validation loss decreased (0.4030 --> 0.3961).  Saving model state dict ...
Epoch: 2 cost time: 5.05620813369751
Epoch: 2, Steps: 1027 | Train Loss: 0.8643872 Vali Loss: 0.3961206 Best vali loss: 0.3961206
	iters: 100, epoch: 3 | loss: 0.7024164
	speed: 0.0139s/iter; left time: 84.4765s
	iters: 200, epoch: 3 | loss: 0.3539076
	speed: 0.0051s/iter; left time: 30.6081s
	iters: 300, epoch: 3 | loss: 0.3851560
	speed: 0.0052s/iter; left time: 30.4415s
	iters: 400, epoch: 3 | loss: 0.6633516
	speed: 0.0052s/iter; left time: 30.1763s
	iters: 500, epoch: 3 | loss: 0.7742871
	speed: 0.0051s/iter; left time: 29.1639s
	iters: 600, epoch: 3 | loss: 0.2343239
	speed: 0.0052s/iter; left time: 28.8245s
	iters: 700, epoch: 3 | loss: 0.3241375
	speed: 0.0053s/iter; left time: 28.7344s
	iters: 800, epoch: 3 | loss: 0.7140680
	speed: 0.0052s/iter; left time: 27.8986s
	iters: 900, epoch: 3 | loss: 0.5890247
	speed: 0.0053s/iter; left time: 27.6331s
	iters: 1000, epoch: 3 | loss: 0.9328847
	speed: 0.0052s/iter; left time: 26.8672s
Updating learning rate to 9.83305573e-05
Epoch: 3 cost time: 5.3869712352752686
Epoch: 3, Steps: 1027 | Train Loss: 0.5673558 Vali Loss: 0.4009134 Best vali loss: 0.3961206
	iters: 100, epoch: 4 | loss: 0.5885675
	speed: 0.0132s/iter; left time: 66.4739s
	iters: 200, epoch: 4 | loss: 1.0910779
	speed: 0.0050s/iter; left time: 24.8574s
	iters: 300, epoch: 4 | loss: 0.4918751
	speed: 0.0049s/iter; left time: 23.8740s
	iters: 400, epoch: 4 | loss: 0.3596877
	speed: 0.0049s/iter; left time: 23.1839s
	iters: 500, epoch: 4 | loss: 0.3602225
	speed: 0.0050s/iter; left time: 23.0496s
	iters: 600, epoch: 4 | loss: 0.4262334
	speed: 0.0050s/iter; left time: 22.6495s
	iters: 700, epoch: 4 | loss: 0.4101914
	speed: 0.0050s/iter; left time: 22.0321s
	iters: 800, epoch: 4 | loss: 0.6900842
	speed: 0.0050s/iter; left time: 21.5957s
	iters: 900, epoch: 4 | loss: 1.0546650
	speed: 0.0049s/iter; left time: 20.8791s
	iters: 1000, epoch: 4 | loss: 0.8036509
	speed: 0.0050s/iter; left time: 20.6404s
Updating learning rate to 4.916527865e-05
Epoch: 4 cost time: 5.166377782821655
Epoch: 4, Steps: 1027 | Train Loss: 0.6276256 Vali Loss: 0.3994133 Best vali loss: 0.3961206
	iters: 100, epoch: 5 | loss: 0.5862699
	speed: 0.0130s/iter; left time: 52.1558s
	iters: 200, epoch: 5 | loss: 1.3777831
	speed: 0.0047s/iter; left time: 18.3847s
	iters: 300, epoch: 5 | loss: 0.8502836
	speed: 0.0046s/iter; left time: 17.7083s
	iters: 400, epoch: 5 | loss: 0.3360016
	speed: 0.0046s/iter; left time: 17.2208s
	iters: 500, epoch: 5 | loss: 0.5158320
	speed: 0.0048s/iter; left time: 17.4649s
	iters: 600, epoch: 5 | loss: 0.7596381
	speed: 0.0050s/iter; left time: 17.4586s
	iters: 700, epoch: 5 | loss: 0.2122130
	speed: 0.0048s/iter; left time: 16.2540s
	iters: 800, epoch: 5 | loss: 0.8055681
	speed: 0.0048s/iter; left time: 15.7645s
	iters: 900, epoch: 5 | loss: 1.0465350
	speed: 0.0048s/iter; left time: 15.3313s
	iters: 1000, epoch: 5 | loss: 0.4493760
	speed: 0.0047s/iter; left time: 14.5273s
Updating learning rate to 2.4582639325e-05
Epoch: 5 cost time: 4.931341886520386
Epoch: 5, Steps: 1027 | Train Loss: 0.6939500 Vali Loss: 0.4060344 Best vali loss: 0.3961206
	iters: 100, epoch: 6 | loss: 0.4844634
	speed: 0.0132s/iter; left time: 39.3785s
	iters: 200, epoch: 6 | loss: 1.4914743
	speed: 0.0052s/iter; left time: 15.0610s
	iters: 300, epoch: 6 | loss: 0.5384865
	speed: 0.0052s/iter; left time: 14.5084s
	iters: 400, epoch: 6 | loss: 0.3300733
	speed: 0.0052s/iter; left time: 14.0556s
	iters: 500, epoch: 6 | loss: 0.9972200
	speed: 0.0053s/iter; left time: 13.5697s
	iters: 600, epoch: 6 | loss: 0.3966062
	speed: 0.0052s/iter; left time: 12.9438s
	iters: 700, epoch: 6 | loss: 0.3420282
	speed: 0.0053s/iter; left time: 12.5113s
	iters: 800, epoch: 6 | loss: 1.1253761
	speed: 0.0052s/iter; left time: 11.9245s
	iters: 900, epoch: 6 | loss: 0.6060211
	speed: 0.0052s/iter; left time: 11.3996s
	iters: 1000, epoch: 6 | loss: 0.3435465
	speed: 0.0051s/iter; left time: 10.6685s
Updating learning rate to 1.22913196625e-05
Epoch: 6 cost time: 5.398792266845703
Epoch: 6, Steps: 1027 | Train Loss: 0.6655296 Vali Loss: 0.4024910 Best vali loss: 0.3961206
	iters: 100, epoch: 7 | loss: 0.2932061
	speed: 0.0130s/iter; left time: 25.4801s
	iters: 200, epoch: 7 | loss: 0.6873952
	speed: 0.0052s/iter; left time: 9.7079s
	iters: 300, epoch: 7 | loss: 0.3148533
	speed: 0.0053s/iter; left time: 9.2598s
	iters: 400, epoch: 7 | loss: 0.3535926
	speed: 0.0053s/iter; left time: 8.7391s
	iters: 500, epoch: 7 | loss: 1.0040078
	speed: 0.0053s/iter; left time: 8.1675s
	iters: 600, epoch: 7 | loss: 0.7774816
	speed: 0.0052s/iter; left time: 7.6018s
	iters: 700, epoch: 7 | loss: 1.2653210
	speed: 0.0053s/iter; left time: 7.1606s
	iters: 800, epoch: 7 | loss: 0.6767977
	speed: 0.0053s/iter; left time: 6.6384s
	iters: 900, epoch: 7 | loss: 1.0105493
	speed: 0.0053s/iter; left time: 6.0702s
	iters: 1000, epoch: 7 | loss: 0.3156647
	speed: 0.0052s/iter; left time: 5.5021s
Updating learning rate to 6.14565983125e-06
Epoch: 7 cost time: 5.436281442642212
Epoch: 7, Steps: 1027 | Train Loss: 0.6698869 Vali Loss: 0.4030434 Best vali loss: 0.3961206
	iters: 100, epoch: 8 | loss: 0.3704467
	speed: 0.0126s/iter; left time: 11.7360s
	iters: 200, epoch: 8 | loss: 0.4983838
	speed: 0.0047s/iter; left time: 3.8611s
	iters: 300, epoch: 8 | loss: 0.4565461
	speed: 0.0047s/iter; left time: 3.3892s
	iters: 400, epoch: 8 | loss: 0.8239493
	speed: 0.0047s/iter; left time: 2.9263s
	iters: 500, epoch: 8 | loss: 1.1076621
	speed: 0.0048s/iter; left time: 2.5140s
	iters: 600, epoch: 8 | loss: 1.1412017
	speed: 0.0050s/iter; left time: 2.1426s
	iters: 700, epoch: 8 | loss: 1.5145892
	speed: 0.0050s/iter; left time: 1.6489s
	iters: 800, epoch: 8 | loss: 0.4132578
	speed: 0.0050s/iter; left time: 1.1421s
	iters: 900, epoch: 8 | loss: 0.8579565
	speed: 0.0050s/iter; left time: 0.6464s
	iters: 1000, epoch: 8 | loss: 1.0383656
	speed: 0.0050s/iter; left time: 0.1412s
Updating learning rate to 3.072829915625e-06
Epoch: 8 cost time: 5.031850576400757
Epoch: 8, Steps: 1027 | Train Loss: 0.8222359 Vali Loss: 0.4029197 Best vali loss: 0.3961206

best validation loss 0.3961205762882364

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0036163062942, 'e_layers': 4, 'learning_rate': 0.0003937355707, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9659235
	speed: 0.0114s/iter; left time: 92.2026s
	iters: 200, epoch: 1 | loss: 0.2762882
	speed: 0.0053s/iter; left time: 42.5293s
	iters: 300, epoch: 1 | loss: 1.1753857
	speed: 0.0051s/iter; left time: 40.3693s
	iters: 400, epoch: 1 | loss: 0.5472474
	speed: 0.0049s/iter; left time: 38.6174s
	iters: 500, epoch: 1 | loss: 1.0965708
	speed: 0.0049s/iter; left time: 38.0670s
	iters: 600, epoch: 1 | loss: 0.5418853
	speed: 0.0050s/iter; left time: 37.9381s
	iters: 700, epoch: 1 | loss: 0.2763128
	speed: 0.0050s/iter; left time: 37.2183s
	iters: 800, epoch: 1 | loss: 0.3246581
	speed: 0.0050s/iter; left time: 36.8815s
	iters: 900, epoch: 1 | loss: 0.5811865
	speed: 0.0050s/iter; left time: 36.3269s
	iters: 1000, epoch: 1 | loss: 0.4988834
	speed: 0.0050s/iter; left time: 36.0138s
Updating learning rate to 0.0003937355707
Validation loss decreased (inf --> 0.4073).  Saving model state dict ...
Epoch: 1 cost time: 5.528674364089966
Epoch: 1, Steps: 1027 | Train Loss: 0.6284342 Vali Loss: 0.4073018 Best vali loss: 0.4073018
	iters: 100, epoch: 2 | loss: 1.4378126
	speed: 0.0133s/iter; left time: 94.6168s
	iters: 200, epoch: 2 | loss: 0.2381544
	speed: 0.0047s/iter; left time: 32.7735s
	iters: 300, epoch: 2 | loss: 0.4212311
	speed: 0.0048s/iter; left time: 32.8257s
	iters: 400, epoch: 2 | loss: 0.5667876
	speed: 0.0047s/iter; left time: 32.0848s
	iters: 500, epoch: 2 | loss: 1.8441935
	speed: 0.0049s/iter; left time: 32.7842s
	iters: 600, epoch: 2 | loss: 0.5856096
	speed: 0.0049s/iter; left time: 32.2282s
	iters: 700, epoch: 2 | loss: 1.3341795
	speed: 0.0049s/iter; left time: 31.8456s
	iters: 800, epoch: 2 | loss: 1.4989059
	speed: 0.0049s/iter; left time: 31.3751s
	iters: 900, epoch: 2 | loss: 0.3894073
	speed: 0.0049s/iter; left time: 30.6482s
	iters: 1000, epoch: 2 | loss: 0.3882218
	speed: 0.0049s/iter; left time: 30.3914s
Updating learning rate to 0.00019686778535
Validation loss decreased (0.4073 --> 0.4008).  Saving model state dict ...
Epoch: 2 cost time: 5.004053592681885
Epoch: 2, Steps: 1027 | Train Loss: 0.8704503 Vali Loss: 0.4008009 Best vali loss: 0.4008009
	iters: 100, epoch: 3 | loss: 0.7461900
	speed: 0.0135s/iter; left time: 81.8890s
	iters: 200, epoch: 3 | loss: 0.3719982
	speed: 0.0047s/iter; left time: 28.1680s
	iters: 300, epoch: 3 | loss: 0.3852253
	speed: 0.0047s/iter; left time: 27.7452s
	iters: 400, epoch: 3 | loss: 0.6526471
	speed: 0.0048s/iter; left time: 27.3854s
	iters: 500, epoch: 3 | loss: 0.7706898
	speed: 0.0048s/iter; left time: 27.3434s
	iters: 600, epoch: 3 | loss: 0.2388876
	speed: 0.0049s/iter; left time: 27.2313s
	iters: 700, epoch: 3 | loss: 0.3298131
	speed: 0.0049s/iter; left time: 26.9336s
	iters: 800, epoch: 3 | loss: 0.7155254
	speed: 0.0050s/iter; left time: 26.7169s
	iters: 900, epoch: 3 | loss: 0.5910265
	speed: 0.0050s/iter; left time: 26.2242s
	iters: 1000, epoch: 3 | loss: 0.9530496
	speed: 0.0050s/iter; left time: 25.7553s
Updating learning rate to 9.8433892675e-05
Epoch: 3 cost time: 5.0442376136779785
Epoch: 3, Steps: 1027 | Train Loss: 0.5755053 Vali Loss: 0.4010027 Best vali loss: 0.4008009
	iters: 100, epoch: 4 | loss: 0.5890152
	speed: 0.0130s/iter; left time: 65.5256s
	iters: 200, epoch: 4 | loss: 1.1339184
	speed: 0.0047s/iter; left time: 23.2182s
	iters: 300, epoch: 4 | loss: 0.4953008
	speed: 0.0048s/iter; left time: 23.0460s
	iters: 400, epoch: 4 | loss: 0.3634166
	speed: 0.0047s/iter; left time: 22.4287s
	iters: 500, epoch: 4 | loss: 0.3604451
	speed: 0.0047s/iter; left time: 21.7854s
	iters: 600, epoch: 4 | loss: 0.4255580
	speed: 0.0047s/iter; left time: 21.3886s
	iters: 700, epoch: 4 | loss: 0.4087296
	speed: 0.0047s/iter; left time: 20.8208s
	iters: 800, epoch: 4 | loss: 0.6907364
	speed: 0.0048s/iter; left time: 20.8248s
	iters: 900, epoch: 4 | loss: 1.0581541
	speed: 0.0050s/iter; left time: 21.2613s
	iters: 1000, epoch: 4 | loss: 0.8090053
	speed: 0.0050s/iter; left time: 20.8492s
Updating learning rate to 4.92169463375e-05
Validation loss decreased (0.4008 --> 0.4001).  Saving model state dict ...
Epoch: 4 cost time: 4.96166729927063
Epoch: 4, Steps: 1027 | Train Loss: 0.6334279 Vali Loss: 0.4001251 Best vali loss: 0.4001251
	iters: 100, epoch: 5 | loss: 0.5850447
	speed: 0.0136s/iter; left time: 54.4509s
	iters: 200, epoch: 5 | loss: 1.3857949
	speed: 0.0047s/iter; left time: 18.3291s
	iters: 300, epoch: 5 | loss: 0.8508241
	speed: 0.0048s/iter; left time: 18.2304s
	iters: 400, epoch: 5 | loss: 0.3345744
	speed: 0.0047s/iter; left time: 17.6112s
	iters: 500, epoch: 5 | loss: 0.5114919
	speed: 0.0049s/iter; left time: 17.6961s
	iters: 600, epoch: 5 | loss: 0.7584216
	speed: 0.0049s/iter; left time: 17.3671s
	iters: 700, epoch: 5 | loss: 0.2115734
	speed: 0.0048s/iter; left time: 16.3217s
	iters: 800, epoch: 5 | loss: 0.8053127
	speed: 0.0047s/iter; left time: 15.6732s
	iters: 900, epoch: 5 | loss: 1.0364165
	speed: 0.0048s/iter; left time: 15.3677s
	iters: 1000, epoch: 5 | loss: 0.4487433
	speed: 0.0047s/iter; left time: 14.6967s
Updating learning rate to 2.460847316875e-05
Epoch: 5 cost time: 4.972674608230591
Epoch: 5, Steps: 1027 | Train Loss: 0.6928197 Vali Loss: 0.4055239 Best vali loss: 0.4001251
	iters: 100, epoch: 6 | loss: 0.4825784
	speed: 0.0128s/iter; left time: 38.0990s
	iters: 200, epoch: 6 | loss: 1.4995831
	speed: 0.0050s/iter; left time: 14.4007s
	iters: 300, epoch: 6 | loss: 0.5376840
	speed: 0.0050s/iter; left time: 13.8374s
	iters: 400, epoch: 6 | loss: 0.3301439
	speed: 0.0050s/iter; left time: 13.3939s
	iters: 500, epoch: 6 | loss: 0.9966792
	speed: 0.0050s/iter; left time: 12.8745s
	iters: 600, epoch: 6 | loss: 0.3959621
	speed: 0.0050s/iter; left time: 12.4348s
	iters: 700, epoch: 6 | loss: 0.3358233
	speed: 0.0050s/iter; left time: 11.8872s
	iters: 800, epoch: 6 | loss: 1.1257154
	speed: 0.0050s/iter; left time: 11.3370s
	iters: 900, epoch: 6 | loss: 0.6067449
	speed: 0.0049s/iter; left time: 10.7833s
	iters: 1000, epoch: 6 | loss: 0.3437840
	speed: 0.0050s/iter; left time: 10.3462s
Updating learning rate to 1.2304236584375e-05
Epoch: 6 cost time: 5.153123617172241
Epoch: 6, Steps: 1027 | Train Loss: 0.6654698 Vali Loss: 0.4036396 Best vali loss: 0.4001251
	iters: 100, epoch: 7 | loss: 0.2920549
	speed: 0.0128s/iter; left time: 25.0256s
	iters: 200, epoch: 7 | loss: 0.6879344
	speed: 0.0047s/iter; left time: 8.6752s
	iters: 300, epoch: 7 | loss: 0.3148003
	speed: 0.0047s/iter; left time: 8.2342s
	iters: 400, epoch: 7 | loss: 0.3538307
	speed: 0.0047s/iter; left time: 7.7483s
	iters: 500, epoch: 7 | loss: 1.0048261
	speed: 0.0047s/iter; left time: 7.2966s
	iters: 600, epoch: 7 | loss: 0.7775165
	speed: 0.0047s/iter; left time: 6.7928s
	iters: 700, epoch: 7 | loss: 1.2682437
	speed: 0.0047s/iter; left time: 6.3626s
	iters: 800, epoch: 7 | loss: 0.6763281
	speed: 0.0047s/iter; left time: 5.8522s
	iters: 900, epoch: 7 | loss: 1.0110043
	speed: 0.0049s/iter; left time: 5.6264s
	iters: 1000, epoch: 7 | loss: 0.3154718
	speed: 0.0050s/iter; left time: 5.2467s
Updating learning rate to 6.1521182921875e-06
Epoch: 7 cost time: 4.910459041595459
Epoch: 7, Steps: 1027 | Train Loss: 0.6702011 Vali Loss: 0.4034758 Best vali loss: 0.4001251
	iters: 100, epoch: 8 | loss: 0.3706648
	speed: 0.0128s/iter; left time: 11.8682s
	iters: 200, epoch: 8 | loss: 0.4983449
	speed: 0.0048s/iter; left time: 4.0009s
	iters: 300, epoch: 8 | loss: 0.4562709
	speed: 0.0049s/iter; left time: 3.5862s
	iters: 400, epoch: 8 | loss: 0.8249708
	speed: 0.0049s/iter; left time: 3.0955s
	iters: 500, epoch: 8 | loss: 1.1079500
	speed: 0.0049s/iter; left time: 2.6048s
	iters: 600, epoch: 8 | loss: 1.1398984
	speed: 0.0049s/iter; left time: 2.1058s
	iters: 700, epoch: 8 | loss: 1.5117604
	speed: 0.0049s/iter; left time: 1.6169s
	iters: 800, epoch: 8 | loss: 0.4130600
	speed: 0.0050s/iter; left time: 1.1305s
	iters: 900, epoch: 8 | loss: 0.8561528
	speed: 0.0048s/iter; left time: 0.6090s
	iters: 1000, epoch: 8 | loss: 1.0380768
	speed: 0.0047s/iter; left time: 0.1318s
Updating learning rate to 3.07605914609375e-06
Epoch: 8 cost time: 5.040261268615723
Epoch: 8, Steps: 1027 | Train Loss: 0.8217150 Vali Loss: 0.4033619 Best vali loss: 0.4001251

best validation loss 0.40012512402005185

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041122406638, 'e_layers': 4, 'learning_rate': 0.0003944828223, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9651379
	speed: 0.0114s/iter; left time: 92.5316s
	iters: 200, epoch: 1 | loss: 0.2671713
	speed: 0.0052s/iter; left time: 41.6787s
	iters: 300, epoch: 1 | loss: 1.1487721
	speed: 0.0052s/iter; left time: 41.4977s
	iters: 400, epoch: 1 | loss: 0.5808425
	speed: 0.0052s/iter; left time: 41.0185s
	iters: 500, epoch: 1 | loss: 1.2113545
	speed: 0.0053s/iter; left time: 40.7403s
	iters: 600, epoch: 1 | loss: 0.5177144
	speed: 0.0053s/iter; left time: 40.0835s
	iters: 700, epoch: 1 | loss: 0.2747163
	speed: 0.0053s/iter; left time: 39.4849s
	iters: 800, epoch: 1 | loss: 0.3240253
	speed: 0.0052s/iter; left time: 38.6904s
	iters: 900, epoch: 1 | loss: 0.5806007
	speed: 0.0053s/iter; left time: 38.5906s
	iters: 1000, epoch: 1 | loss: 0.4683760
	speed: 0.0053s/iter; left time: 38.0224s
Updating learning rate to 0.0003944828223
Validation loss decreased (inf --> 0.4004).  Saving model state dict ...
Epoch: 1 cost time: 5.742319107055664
Epoch: 1, Steps: 1027 | Train Loss: 0.6338711 Vali Loss: 0.4003737 Best vali loss: 0.4003737
	iters: 100, epoch: 2 | loss: 1.4429616
	speed: 0.0131s/iter; left time: 92.9254s
	iters: 200, epoch: 2 | loss: 0.2392379
	speed: 0.0047s/iter; left time: 33.1297s
	iters: 300, epoch: 2 | loss: 0.4207347
	speed: 0.0048s/iter; left time: 32.7294s
	iters: 400, epoch: 2 | loss: 0.5667150
	speed: 0.0048s/iter; left time: 32.8616s
	iters: 500, epoch: 2 | loss: 1.8530532
	speed: 0.0050s/iter; left time: 33.4263s
	iters: 600, epoch: 2 | loss: 0.5850140
	speed: 0.0050s/iter; left time: 32.7022s
	iters: 700, epoch: 2 | loss: 1.3286753
	speed: 0.0050s/iter; left time: 32.2482s
	iters: 800, epoch: 2 | loss: 1.5001731
	speed: 0.0050s/iter; left time: 31.9041s
	iters: 900, epoch: 2 | loss: 0.3893856
	speed: 0.0050s/iter; left time: 31.1997s
	iters: 1000, epoch: 2 | loss: 0.3884459
	speed: 0.0049s/iter; left time: 30.5679s
Updating learning rate to 0.00019724141115
Epoch: 2 cost time: 5.069524049758911
Epoch: 2, Steps: 1027 | Train Loss: 0.8714396 Vali Loss: 0.4011986 Best vali loss: 0.4003737
	iters: 100, epoch: 3 | loss: 0.7459553
	speed: 0.0130s/iter; left time: 79.0193s
	iters: 200, epoch: 3 | loss: 0.3707948
	speed: 0.0050s/iter; left time: 29.7918s
	iters: 300, epoch: 3 | loss: 0.3850237
	speed: 0.0048s/iter; left time: 28.3510s
	iters: 400, epoch: 3 | loss: 0.6513636
	speed: 0.0049s/iter; left time: 28.0056s
	iters: 500, epoch: 3 | loss: 0.7705262
	speed: 0.0049s/iter; left time: 27.5242s
	iters: 600, epoch: 3 | loss: 0.2389417
	speed: 0.0049s/iter; left time: 27.4705s
	iters: 700, epoch: 3 | loss: 0.3301542
	speed: 0.0049s/iter; left time: 27.0400s
	iters: 800, epoch: 3 | loss: 0.7147006
	speed: 0.0050s/iter; left time: 26.8862s
	iters: 900, epoch: 3 | loss: 0.5912761
	speed: 0.0050s/iter; left time: 26.3685s
	iters: 1000, epoch: 3 | loss: 0.9503327
	speed: 0.0050s/iter; left time: 25.8059s
Updating learning rate to 9.8620705575e-05
Epoch: 3 cost time: 5.11940336227417
Epoch: 3, Steps: 1027 | Train Loss: 0.5749069 Vali Loss: 0.4009682 Best vali loss: 0.4003737

best validation loss 0.4003736830647662

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0057700008494, 'e_layers': 4, 'learning_rate': 0.0003961689167, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9646798
	speed: 0.0121s/iter; left time: 97.8328s
	iters: 200, epoch: 1 | loss: 0.2598628
	speed: 0.0053s/iter; left time: 42.3872s
	iters: 300, epoch: 1 | loss: 1.2695087
	speed: 0.0053s/iter; left time: 41.9361s
	iters: 400, epoch: 1 | loss: 0.5761908
	speed: 0.0053s/iter; left time: 41.5870s
	iters: 500, epoch: 1 | loss: 1.1410432
	speed: 0.0052s/iter; left time: 39.7774s
	iters: 600, epoch: 1 | loss: 0.5382019
	speed: 0.0046s/iter; left time: 35.1836s
	iters: 700, epoch: 1 | loss: 0.2816437
	speed: 0.0047s/iter; left time: 35.2410s
	iters: 800, epoch: 1 | loss: 0.3246938
	speed: 0.0046s/iter; left time: 33.8545s
	iters: 900, epoch: 1 | loss: 0.5818255
	speed: 0.0046s/iter; left time: 33.6312s
	iters: 1000, epoch: 1 | loss: 0.4974810
	speed: 0.0046s/iter; left time: 33.0638s
Updating learning rate to 0.0003961689167
Validation loss decreased (inf --> 0.4070).  Saving model state dict ...
Epoch: 1 cost time: 5.416338205337524
Epoch: 1, Steps: 1027 | Train Loss: 0.6435131 Vali Loss: 0.4069743 Best vali loss: 0.4069743
	iters: 100, epoch: 2 | loss: 1.4389120
	speed: 0.0127s/iter; left time: 90.3296s
	iters: 200, epoch: 2 | loss: 0.2381032
	speed: 0.0046s/iter; left time: 32.3551s
	iters: 300, epoch: 2 | loss: 0.4209175
	speed: 0.0045s/iter; left time: 31.1245s
	iters: 400, epoch: 2 | loss: 0.5665253
	speed: 0.0049s/iter; left time: 33.0554s
	iters: 500, epoch: 2 | loss: 1.8411487
	speed: 0.0052s/iter; left time: 34.9757s
	iters: 600, epoch: 2 | loss: 0.5856020
	speed: 0.0053s/iter; left time: 34.8568s
	iters: 700, epoch: 2 | loss: 1.3360996
	speed: 0.0053s/iter; left time: 34.2032s
	iters: 800, epoch: 2 | loss: 1.4993407
	speed: 0.0053s/iter; left time: 33.7032s
	iters: 900, epoch: 2 | loss: 0.3892450
	speed: 0.0053s/iter; left time: 33.3323s
	iters: 1000, epoch: 2 | loss: 0.3877313
	speed: 0.0053s/iter; left time: 32.6181s
Updating learning rate to 0.00019808445835
Validation loss decreased (0.4070 --> 0.4006).  Saving model state dict ...
Epoch: 2 cost time: 5.212371349334717
Epoch: 2, Steps: 1027 | Train Loss: 0.8703625 Vali Loss: 0.4005778 Best vali loss: 0.4005778
	iters: 100, epoch: 3 | loss: 0.7459641
	speed: 0.0139s/iter; left time: 84.1032s
	iters: 200, epoch: 3 | loss: 0.3726192
	speed: 0.0050s/iter; left time: 29.5912s
	iters: 300, epoch: 3 | loss: 0.3852398
	speed: 0.0050s/iter; left time: 29.2161s
	iters: 400, epoch: 3 | loss: 0.6524475
	speed: 0.0050s/iter; left time: 28.7919s
	iters: 500, epoch: 3 | loss: 0.7707779
	speed: 0.0047s/iter; left time: 26.8942s
	iters: 600, epoch: 3 | loss: 0.2389094
	speed: 0.0046s/iter; left time: 25.4409s
	iters: 700, epoch: 3 | loss: 0.3297910
	speed: 0.0047s/iter; left time: 25.6487s
	iters: 800, epoch: 3 | loss: 0.7146686
	speed: 0.0046s/iter; left time: 24.9099s
	iters: 900, epoch: 3 | loss: 0.5913928
	speed: 0.0046s/iter; left time: 24.1000s
	iters: 1000, epoch: 3 | loss: 0.9543604
	speed: 0.0046s/iter; left time: 23.7889s
Updating learning rate to 9.9042229175e-05
Epoch: 3 cost time: 4.945137977600098
Epoch: 3, Steps: 1027 | Train Loss: 0.5756171 Vali Loss: 0.4010274 Best vali loss: 0.4005778

best validation loss 0.4005778446178774

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0055131722371, 'e_layers': 3, 'learning_rate': 0.0001237703353, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6986049
	speed: 0.0122s/iter; left time: 11.3920s
Updating learning rate to 0.0001237703353
Validation loss decreased (inf --> 0.3614).  Saving model state dict ...
Epoch: 1 cost time: 1.1208243370056152
Epoch: 1, Steps: 129 | Train Loss: 0.6986049 Vali Loss: 0.3613842 Best vali loss: 0.3613842
	iters: 100, epoch: 2 | loss: 0.6200016
	speed: 0.0100s/iter; left time: 8.0223s
Updating learning rate to 6.188516765e-05
Validation loss decreased (0.3614 --> 0.3565).  Saving model state dict ...
Epoch: 2 cost time: 0.7956562042236328
Epoch: 2, Steps: 129 | Train Loss: 0.6200016 Vali Loss: 0.3565361 Best vali loss: 0.3565361
	iters: 100, epoch: 3 | loss: 0.5904557
	speed: 0.0100s/iter; left time: 6.7427s
Updating learning rate to 3.0942583825e-05
Epoch: 3 cost time: 0.78055739402771
Epoch: 3, Steps: 129 | Train Loss: 0.5904557 Vali Loss: 0.3687063 Best vali loss: 0.3565361

best validation loss 0.3565360581359601

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0055131722371, 'e_layers': 3, 'learning_rate': 0.0001237703353, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6362264
	speed: 0.0126s/iter; left time: 6.8548s
Updating learning rate to 1.54712919125e-05
Epoch: 4 cost time: 1.1220552921295166
Epoch: 4, Steps: 129 | Train Loss: 0.6362264 Vali Loss: 0.3637941 Best vali loss: 0.3565361
	iters: 100, epoch: 5 | loss: 0.5147616
	speed: 0.0095s/iter; left time: 3.9800s
Updating learning rate to 7.73564595625e-06
Epoch: 5 cost time: 0.773125410079956
Epoch: 5, Steps: 129 | Train Loss: 0.5147616 Vali Loss: 0.3589759 Best vali loss: 0.3565361
	iters: 100, epoch: 6 | loss: 0.5519590
	speed: 0.0095s/iter; left time: 2.7419s
Updating learning rate to 3.867822978125e-06
Epoch: 6 cost time: 0.7759795188903809
Epoch: 6, Steps: 129 | Train Loss: 0.5519590 Vali Loss: 0.3635547 Best vali loss: 0.3565361
	iters: 100, epoch: 7 | loss: 0.5424911
	speed: 0.0096s/iter; left time: 1.5283s
Updating learning rate to 1.9339114890625e-06
Epoch: 7 cost time: 0.7784543037414551
Epoch: 7, Steps: 129 | Train Loss: 0.5424911 Vali Loss: 0.3625824 Best vali loss: 0.3565361
	iters: 100, epoch: 8 | loss: 0.3971379
	speed: 0.0096s/iter; left time: 0.2873s
Updating learning rate to 9.6695574453125e-07
Epoch: 8 cost time: 0.7872011661529541
Epoch: 8, Steps: 129 | Train Loss: 0.3971379 Vali Loss: 0.3630292 Best vali loss: 0.3565361

best validation loss 0.3565360581359601

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0038201781838, 'e_layers': 4, 'learning_rate': 0.0006551252592, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006551252592
Validation loss decreased (inf --> 0.3684).  Saving model state dict ...
Epoch: 1 cost time: 1.1027500629425049
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3684359 Best vali loss: 0.3684359
Updating learning rate to 0.0003275626296
Validation loss decreased (0.3684 --> 0.3657).  Saving model state dict ...
Epoch: 2 cost time: 0.782895565032959
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3656632 Best vali loss: 0.3656632
Updating learning rate to 0.0001637813148
Epoch: 3 cost time: 0.7803153991699219
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3705505 Best vali loss: 0.3656632
Updating learning rate to 8.18906574e-05
Validation loss decreased (0.3657 --> 0.3575).  Saving model state dict ...
Epoch: 4 cost time: 0.7792356014251709
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3575025 Best vali loss: 0.3575025
Updating learning rate to 4.09453287e-05
Validation loss decreased (0.3575 --> 0.3552).  Saving model state dict ...
Epoch: 5 cost time: 0.7799296379089355
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3552327 Best vali loss: 0.3552327
Updating learning rate to 2.047266435e-05
Epoch: 6 cost time: 0.7818043231964111
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3607675 Best vali loss: 0.3552327
Updating learning rate to 1.0236332175e-05
Epoch: 7 cost time: 0.7779126167297363
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3591024 Best vali loss: 0.3552327
Updating learning rate to 5.1181660875e-06
Epoch: 8 cost time: 0.7817502021789551
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3600403 Best vali loss: 0.3552327

best validation loss 0.35523265791079855

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0088756001763, 'e_layers': 2, 'learning_rate': 0.0016502269826, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3974339
	speed: 0.0113s/iter; left time: 10.5454s
Updating learning rate to 0.0016502269826
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 0.9230544567108154
Epoch: 1, Steps: 129 | Train Loss: 0.3974339 Vali Loss: 0.3714938 Best vali loss: 0.3714938
	iters: 100, epoch: 2 | loss: 0.6710109
	speed: 0.0072s/iter; left time: 5.8251s
Updating learning rate to 0.0008251134913
Epoch: 2 cost time: 0.5627107620239258
Epoch: 2, Steps: 129 | Train Loss: 0.6710109 Vali Loss: 0.3911003 Best vali loss: 0.3714938
	iters: 100, epoch: 3 | loss: 0.3912900
	speed: 0.0068s/iter; left time: 4.6110s
Updating learning rate to 0.00041255674565
Epoch: 3 cost time: 0.5277819633483887
Epoch: 3, Steps: 129 | Train Loss: 0.3912900 Vali Loss: 0.3748882 Best vali loss: 0.3714938
	iters: 100, epoch: 4 | loss: 0.7395853
	speed: 0.0069s/iter; left time: 3.7662s
Updating learning rate to 0.000206278372825
Epoch: 4 cost time: 0.5560512542724609
Epoch: 4, Steps: 129 | Train Loss: 0.7395853 Vali Loss: 0.3808409 Best vali loss: 0.3714938
	iters: 100, epoch: 5 | loss: 0.9630409
	speed: 0.0070s/iter; left time: 2.9134s
Updating learning rate to 0.0001031391864125
Epoch: 5 cost time: 0.5541326999664307
Epoch: 5, Steps: 129 | Train Loss: 0.9630409 Vali Loss: 0.3966441 Best vali loss: 0.3714938
	iters: 100, epoch: 6 | loss: 0.5530086
	speed: 0.0069s/iter; left time: 1.9735s
Updating learning rate to 5.156959320625e-05
Epoch: 6 cost time: 0.5302398204803467
Epoch: 6, Steps: 129 | Train Loss: 0.5530086 Vali Loss: 0.3999694 Best vali loss: 0.3714938
	iters: 100, epoch: 7 | loss: 0.4912546
	speed: 0.0072s/iter; left time: 1.1394s
Updating learning rate to 2.5784796603125e-05
Epoch: 7 cost time: 0.5755257606506348
Epoch: 7, Steps: 129 | Train Loss: 0.4912546 Vali Loss: 0.3954768 Best vali loss: 0.3714938
	iters: 100, epoch: 8 | loss: 0.6220160
	speed: 0.0071s/iter; left time: 0.2137s
Updating learning rate to 1.28923983015625e-05
Epoch: 8 cost time: 0.5688192844390869
Epoch: 8, Steps: 129 | Train Loss: 0.6220160 Vali Loss: 0.3946894 Best vali loss: 0.3714938

best validation loss 0.3714938087172967

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042164674506, 'e_layers': 4, 'learning_rate': 0.0006643278928, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006643278928
Validation loss decreased (inf --> 0.3684).  Saving model state dict ...
Epoch: 1 cost time: 1.109382152557373
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3683988 Best vali loss: 0.3683988
Updating learning rate to 0.0003321639464
Validation loss decreased (0.3684 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.7831215858459473
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619601 Best vali loss: 0.3619601
Updating learning rate to 0.0001660819732
Validation loss decreased (0.3620 --> 0.3528).  Saving model state dict ...
Epoch: 3 cost time: 0.7901365756988525
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3527887 Best vali loss: 0.3527887

best validation loss 0.35278872632090374

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0009949692672, 'e_layers': 2, 'learning_rate': 0.0018171694322, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9970005
	speed: 0.0102s/iter; left time: 9.5009s
Updating learning rate to 0.0018171694322
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 0.8748576641082764
Epoch: 1, Steps: 129 | Train Loss: 0.9970005 Vali Loss: 0.3702072 Best vali loss: 0.3702072
	iters: 100, epoch: 2 | loss: 0.7521811
	speed: 0.0069s/iter; left time: 5.5740s
Updating learning rate to 0.0009085847161
Epoch: 2 cost time: 0.5612483024597168
Epoch: 2, Steps: 129 | Train Loss: 0.7521811 Vali Loss: 0.3726488 Best vali loss: 0.3702072
	iters: 100, epoch: 3 | loss: 0.7606531
	speed: 0.0069s/iter; left time: 4.6584s
Updating learning rate to 0.00045429235805
Epoch: 3 cost time: 0.5279538631439209
Epoch: 3, Steps: 129 | Train Loss: 0.7606531 Vali Loss: 0.3844980 Best vali loss: 0.3702072

best validation loss 0.3702071975982494

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0048763413462, 'e_layers': 4, 'learning_rate': 0.0005263512027, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005263512027
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 0.7892935276031494
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3735327 Best vali loss: 0.3735327
Updating learning rate to 0.00026317560135
Validation loss decreased (0.3735 --> 0.3676).  Saving model state dict ...
Epoch: 2 cost time: 0.4735398292541504
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3676470 Best vali loss: 0.3676470
Updating learning rate to 0.000131587800675
Epoch: 3 cost time: 0.48192429542541504
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3677029 Best vali loss: 0.3676470

best validation loss 0.36764703497202783

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042164674506, 'e_layers': 4, 'learning_rate': 0.0006643278928, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.30409866e-05
Validation loss decreased (0.3528 --> 0.3489).  Saving model state dict ...
Epoch: 4 cost time: 1.1004359722137451
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3488565 Best vali loss: 0.3488565
Updating learning rate to 4.15204933e-05
Validation loss decreased (0.3489 --> 0.3445).  Saving model state dict ...
Epoch: 5 cost time: 0.7915196418762207
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3444652 Best vali loss: 0.3444652
Updating learning rate to 2.076024665e-05
Validation loss decreased (0.3445 --> 0.3393).  Saving model state dict ...
Epoch: 6 cost time: 0.7858037948608398
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3393231 Best vali loss: 0.3393231
Updating learning rate to 1.0380123325e-05
Validation loss decreased (0.3393 --> 0.3391).  Saving model state dict ...
Epoch: 7 cost time: 0.7822926044464111
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3391196 Best vali loss: 0.3391196
Updating learning rate to 5.1900616625e-06
Epoch: 8 cost time: 0.7886638641357422
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3399065 Best vali loss: 0.3391196

best validation loss 0.3391196291432634

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.003900074892, 'e_layers': 4, 'learning_rate': 0.0006642263823, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006642263823
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.095409631729126
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3688005 Best vali loss: 0.3688005
Updating learning rate to 0.00033211319115
Validation loss decreased (0.3688 --> 0.3633).  Saving model state dict ...
Epoch: 2 cost time: 0.7853403091430664
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3633016 Best vali loss: 0.3633016
Updating learning rate to 0.000166056595575
Validation loss decreased (0.3633 --> 0.3551).  Saving model state dict ...
Epoch: 3 cost time: 0.7827110290527344
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3550504 Best vali loss: 0.3550504
Updating learning rate to 8.30282977875e-05
Validation loss decreased (0.3551 --> 0.3429).  Saving model state dict ...
Epoch: 4 cost time: 0.7910106182098389
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3429140 Best vali loss: 0.3429140
Updating learning rate to 4.151414889375e-05
Epoch: 5 cost time: 0.7867527008056641
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3489864 Best vali loss: 0.3429140
Updating learning rate to 2.0757074446875e-05
Epoch: 6 cost time: 0.7830262184143066
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3440131 Best vali loss: 0.3429140
Updating learning rate to 1.03785372234375e-05
Epoch: 7 cost time: 0.7847111225128174
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3437901 Best vali loss: 0.3429140
Updating learning rate to 5.18926861171875e-06
Epoch: 8 cost time: 0.7826752662658691
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3433558 Best vali loss: 0.3429140

best validation loss 0.3429140302544727

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.00088245073, 'e_layers': 4, 'learning_rate': 0.0016921600575, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6218449
	speed: 0.0126s/iter; left time: 11.7357s
Updating learning rate to 0.001627756050178686
Validation loss decreased (inf --> 0.3792).  Saving model state dict ...
Epoch: 1 cost time: 1.1055502891540527
Epoch: 1, Steps: 129 | Train Loss: 0.6218449 Vali Loss: 0.3791638 Best vali loss: 0.3791638
	iters: 100, epoch: 2 | loss: 0.5416265
	speed: 0.0095s/iter; left time: 7.6250s
Updating learning rate to 0.001444348954505634
Validation loss decreased (0.3792 --> 0.3679).  Saving model state dict ...
Epoch: 2 cost time: 0.8016729354858398
Epoch: 2, Steps: 129 | Train Loss: 0.5416265 Vali Loss: 0.3678971 Best vali loss: 0.3678971
	iters: 100, epoch: 3 | loss: 0.5610427
	speed: 0.0098s/iter; left time: 6.5834s
Updating learning rate to 0.001169860838207604
Epoch: 3 cost time: 0.7975754737854004
Epoch: 3, Steps: 129 | Train Loss: 0.5610427 Vali Loss: 0.3775417 Best vali loss: 0.3678971
	iters: 100, epoch: 4 | loss: 0.5428727
	speed: 0.0095s/iter; left time: 5.1815s
Updating learning rate to 0.00084608002875
Epoch: 4 cost time: 0.8037614822387695
Epoch: 4, Steps: 129 | Train Loss: 0.5428727 Vali Loss: 0.3704158 Best vali loss: 0.3678971
	iters: 100, epoch: 5 | loss: 0.5371264
	speed: 0.0090s/iter; left time: 3.7379s
Updating learning rate to 0.0005222992192923962
Epoch: 5 cost time: 0.7185556888580322
Epoch: 5, Steps: 129 | Train Loss: 0.5371264 Vali Loss: 0.4026575 Best vali loss: 0.3678971
	iters: 100, epoch: 6 | loss: 0.7054155
	speed: 0.0090s/iter; left time: 2.5802s
Updating learning rate to 0.000247811102994366
Epoch: 6 cost time: 0.7587721347808838
Epoch: 6, Steps: 129 | Train Loss: 0.7054155 Vali Loss: 0.3779416 Best vali loss: 0.3678971
	iters: 100, epoch: 7 | loss: 0.5058364
	speed: 0.0097s/iter; left time: 1.5422s
Updating learning rate to 6.440400732131395e-05
Validation loss decreased (0.3679 --> 0.3657).  Saving model state dict ...
Epoch: 7 cost time: 0.8122506141662598
Epoch: 7, Steps: 129 | Train Loss: 0.5058364 Vali Loss: 0.3656649 Best vali loss: 0.3656649
	iters: 100, epoch: 8 | loss: 0.6483031
	speed: 0.0092s/iter; left time: 0.2760s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7408313751220703
Epoch: 8, Steps: 129 | Train Loss: 0.6483031 Vali Loss: 0.3735914 Best vali loss: 0.3656649

best validation loss 0.3656648690550641

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141703144, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.1115539073944092
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712862 Best vali loss: 0.3712862
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3713 --> 0.3598).  Saving model state dict ...
Epoch: 2 cost time: 0.7813620567321777
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3597777 Best vali loss: 0.3597777
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3598 --> 0.3505).  Saving model state dict ...
Epoch: 3 cost time: 0.7798125743865967
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3504960 Best vali loss: 0.3504960

best validation loss 0.35049602829637133

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0061066795052, 'e_layers': 4, 'learning_rate': 0.0003918264721, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5589478
	speed: 0.0118s/iter; left time: 23.1288s
	iters: 200, epoch: 1 | loss: 0.6676552
	speed: 0.0055s/iter; left time: 10.2014s
Updating learning rate to 0.0003918264721
Validation loss decreased (inf --> 0.3763).  Saving model state dict ...
Epoch: 1 cost time: 1.773033857345581
Epoch: 1, Steps: 257 | Train Loss: 0.6133015 Vali Loss: 0.3762781 Best vali loss: 0.3762781
	iters: 100, epoch: 2 | loss: 0.8156075
	speed: 0.0121s/iter; left time: 20.5304s
	iters: 200, epoch: 2 | loss: 0.5620551
	speed: 0.0054s/iter; left time: 8.6458s
Updating learning rate to 0.00019591323605
Epoch: 2 cost time: 1.4608154296875
Epoch: 2, Steps: 257 | Train Loss: 0.6888313 Vali Loss: 0.3784460 Best vali loss: 0.3762781
	iters: 100, epoch: 3 | loss: 0.5289168
	speed: 0.0112s/iter; left time: 16.2336s
	iters: 200, epoch: 3 | loss: 0.4962990
	speed: 0.0053s/iter; left time: 7.0837s
Updating learning rate to 9.7956618025e-05
Epoch: 3 cost time: 1.400987148284912
Epoch: 3, Steps: 257 | Train Loss: 0.5126079 Vali Loss: 0.3849960 Best vali loss: 0.3762781

best validation loss 0.37627813531514

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0064816244869, 'e_layers': 4, 'learning_rate': 0.0003920810896, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5592751
	speed: 0.0117s/iter; left time: 22.9738s
	iters: 200, epoch: 1 | loss: 0.6549959
	speed: 0.0055s/iter; left time: 10.1787s
Updating learning rate to 0.0003920810896
Validation loss decreased (inf --> 0.3780).  Saving model state dict ...
Epoch: 1 cost time: 1.774237871170044
Epoch: 1, Steps: 257 | Train Loss: 0.6071355 Vali Loss: 0.3780384 Best vali loss: 0.3780384
	iters: 100, epoch: 2 | loss: 0.9447328
	speed: 0.0117s/iter; left time: 19.8329s
	iters: 200, epoch: 2 | loss: 0.5996937
	speed: 0.0052s/iter; left time: 8.3229s
Updating learning rate to 0.0001960405448
Epoch: 2 cost time: 1.3940832614898682
Epoch: 2, Steps: 257 | Train Loss: 0.7722133 Vali Loss: 0.3943017 Best vali loss: 0.3780384
	iters: 100, epoch: 3 | loss: 0.5690309
	speed: 0.0112s/iter; left time: 16.2252s
	iters: 200, epoch: 3 | loss: 0.6747158
	speed: 0.0054s/iter; left time: 7.2454s
Updating learning rate to 9.80202724e-05
Epoch: 3 cost time: 1.418379306793213
Epoch: 3, Steps: 257 | Train Loss: 0.6218733 Vali Loss: 0.3805828 Best vali loss: 0.3780384

best validation loss 0.3780384118114333

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141703144, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3505 --> 0.3497).  Saving model state dict ...
Epoch: 4 cost time: 1.1035070419311523
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3496531 Best vali loss: 0.3496531
Updating learning rate to 4.419018625625e-05
Epoch: 5 cost time: 0.7844347953796387
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3496842 Best vali loss: 0.3496531
Updating learning rate to 2.2095093128125e-05
Validation loss decreased (0.3497 --> 0.3433).  Saving model state dict ...
Epoch: 6 cost time: 0.7884261608123779
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3433000 Best vali loss: 0.3433000
Updating learning rate to 1.10475465640625e-05
Validation loss decreased (0.3433 --> 0.3407).  Saving model state dict ...
Epoch: 7 cost time: 0.790374755859375
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3406552 Best vali loss: 0.3406552
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.7864336967468262
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3445400 Best vali loss: 0.3406552

best validation loss 0.3406552087698564

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012114431882, 'e_layers': 2, 'learning_rate': 0.0014542156111, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6549208
	speed: 0.0103s/iter; left time: 9.5762s
Updating learning rate to 0.0014542156111
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 0.8770527839660645
Epoch: 1, Steps: 129 | Train Loss: 0.6549208 Vali Loss: 0.3713337 Best vali loss: 0.3713337
	iters: 100, epoch: 2 | loss: 0.8882517
	speed: 0.0070s/iter; left time: 5.6341s
Updating learning rate to 0.00072710780555
Epoch: 2 cost time: 0.5424637794494629
Epoch: 2, Steps: 129 | Train Loss: 0.8882517 Vali Loss: 0.3813745 Best vali loss: 0.3713337
	iters: 100, epoch: 3 | loss: 0.4632165
	speed: 0.0072s/iter; left time: 4.8373s
Updating learning rate to 0.000363553902775
Epoch: 3 cost time: 0.5698020458221436
Epoch: 3, Steps: 129 | Train Loss: 0.4632165 Vali Loss: 0.3761840 Best vali loss: 0.3713337
	iters: 100, epoch: 4 | loss: 0.5727050
	speed: 0.0071s/iter; left time: 3.8703s
Updating learning rate to 0.0001817769513875
Epoch: 4 cost time: 0.5748987197875977
Epoch: 4, Steps: 129 | Train Loss: 0.5727050 Vali Loss: 0.3907516 Best vali loss: 0.3713337
	iters: 100, epoch: 5 | loss: 0.7300490
	speed: 0.0070s/iter; left time: 2.9009s
Updating learning rate to 9.088847569375e-05
Epoch: 5 cost time: 0.5623002052307129
Epoch: 5, Steps: 129 | Train Loss: 0.7300490 Vali Loss: 0.3840186 Best vali loss: 0.3713337
	iters: 100, epoch: 6 | loss: 0.3408162
	speed: 0.0068s/iter; left time: 1.9716s
Updating learning rate to 4.5444237846875e-05
Epoch: 6 cost time: 0.5256087779998779
Epoch: 6, Steps: 129 | Train Loss: 0.3408162 Vali Loss: 0.3897218 Best vali loss: 0.3713337
	iters: 100, epoch: 7 | loss: 0.5675723
	speed: 0.0072s/iter; left time: 1.1399s
Updating learning rate to 2.27221189234375e-05
Epoch: 7 cost time: 0.5877408981323242
Epoch: 7, Steps: 129 | Train Loss: 0.5675723 Vali Loss: 0.3960311 Best vali loss: 0.3713337
	iters: 100, epoch: 8 | loss: 0.5758153
	speed: 0.0072s/iter; left time: 0.2150s
Updating learning rate to 1.136105946171875e-05
Epoch: 8 cost time: 0.5766019821166992
Epoch: 8, Steps: 129 | Train Loss: 0.5758153 Vali Loss: 0.3949596 Best vali loss: 0.3713337

best validation loss 0.3713336985448489

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0064945168, 'e_layers': 4, 'learning_rate': 0.0003929662444, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5592697
	speed: 0.0118s/iter; left time: 23.1213s
	iters: 200, epoch: 1 | loss: 0.6515604
	speed: 0.0055s/iter; left time: 10.2705s
Updating learning rate to 0.0003929662444
Validation loss decreased (inf --> 0.3831).  Saving model state dict ...
Epoch: 1 cost time: 1.7752230167388916
Epoch: 1, Steps: 257 | Train Loss: 0.6054150 Vali Loss: 0.3830705 Best vali loss: 0.3830705
	iters: 100, epoch: 2 | loss: 0.9771996
	speed: 0.0121s/iter; left time: 20.5026s
	iters: 200, epoch: 2 | loss: 0.5920634
	speed: 0.0057s/iter; left time: 9.1301s
Updating learning rate to 0.0001964831222
Epoch: 2 cost time: 1.5121219158172607
Epoch: 2, Steps: 257 | Train Loss: 0.7846315 Vali Loss: 0.3832793 Best vali loss: 0.3830705
	iters: 100, epoch: 3 | loss: 0.5496302
	speed: 0.0117s/iter; left time: 16.8233s
	iters: 200, epoch: 3 | loss: 0.6512243
	speed: 0.0053s/iter; left time: 7.1536s
Updating learning rate to 9.82415611e-05
Epoch: 3 cost time: 1.4250710010528564
Epoch: 3, Steps: 257 | Train Loss: 0.6004272 Vali Loss: 0.3877934 Best vali loss: 0.3830705
	iters: 100, epoch: 4 | loss: 0.7109199
	speed: 0.0114s/iter; left time: 13.5749s
	iters: 200, epoch: 4 | loss: 0.3997537
	speed: 0.0054s/iter; left time: 5.8592s
Updating learning rate to 4.912078055e-05
Validation loss decreased (0.3831 --> 0.3817).  Saving model state dict ...
Epoch: 4 cost time: 1.440676212310791
Epoch: 4, Steps: 257 | Train Loss: 0.5553368 Vali Loss: 0.3817327 Best vali loss: 0.3817327
	iters: 100, epoch: 5 | loss: 0.7007847
	speed: 0.0122s/iter; left time: 11.3785s
	iters: 200, epoch: 5 | loss: 0.6276500
	speed: 0.0056s/iter; left time: 4.6343s
Updating learning rate to 2.4560390275e-05
Validation loss decreased (0.3817 --> 0.3800).  Saving model state dict ...
Epoch: 5 cost time: 1.4868769645690918
Epoch: 5, Steps: 257 | Train Loss: 0.6642174 Vali Loss: 0.3800382 Best vali loss: 0.3800382
	iters: 100, epoch: 6 | loss: 0.4456452
	speed: 0.0123s/iter; left time: 8.2414s
	iters: 200, epoch: 6 | loss: 0.4925747
	speed: 0.0056s/iter; left time: 3.2271s
Updating learning rate to 1.22801951375e-05
Epoch: 6 cost time: 1.5018956661224365
Epoch: 6, Steps: 257 | Train Loss: 0.4691099 Vali Loss: 0.3814932 Best vali loss: 0.3800382
	iters: 100, epoch: 7 | loss: 0.8066161
	speed: 0.0119s/iter; left time: 4.9374s
	iters: 200, epoch: 7 | loss: 0.6517841
	speed: 0.0056s/iter; left time: 1.7732s
Updating learning rate to 6.14009756875e-06
Epoch: 7 cost time: 1.4995439052581787
Epoch: 7, Steps: 257 | Train Loss: 0.7292001 Vali Loss: 0.3820055 Best vali loss: 0.3800382
	iters: 100, epoch: 8 | loss: 0.5346521
	speed: 0.0118s/iter; left time: 1.8708s
	iters: 200, epoch: 8 | loss: 0.3857213
	speed: 0.0056s/iter; left time: 0.3235s
Updating learning rate to 3.070048784375e-06
Epoch: 8 cost time: 1.482773780822754
Epoch: 8, Steps: 257 | Train Loss: 0.4601867 Vali Loss: 0.3856608 Best vali loss: 0.3800382

best validation loss 0.38003819687895785

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043818672452, 'e_layers': 4, 'learning_rate': 0.0006552653259, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6132551
	speed: 0.0134s/iter; left time: 12.5110s
Updating learning rate to 0.0006552653259
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 1.2762763500213623
Epoch: 1, Steps: 129 | Train Loss: 0.6132551 Vali Loss: 0.3800488 Best vali loss: 0.3800488
	iters: 100, epoch: 2 | loss: 0.5708106
	speed: 0.0116s/iter; left time: 9.3099s
Updating learning rate to 0.00032763266295
Epoch: 2 cost time: 0.9289538860321045
Epoch: 2, Steps: 129 | Train Loss: 0.5708106 Vali Loss: 0.3887198 Best vali loss: 0.3800488
	iters: 100, epoch: 3 | loss: 0.7049610
	speed: 0.0114s/iter; left time: 7.6659s
Updating learning rate to 0.000163816331475
Epoch: 3 cost time: 0.9359087944030762
Epoch: 3, Steps: 129 | Train Loss: 0.7049610 Vali Loss: 0.3894052 Best vali loss: 0.3800488

best validation loss 0.3800487968799876

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.005978198665, 'e_layers': 4, 'learning_rate': 0.0003977600843, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5591573
	speed: 0.0119s/iter; left time: 23.2688s
	iters: 200, epoch: 1 | loss: 0.7062640
	speed: 0.0057s/iter; left time: 10.5374s
Updating learning rate to 0.0003977600843
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.8206181526184082
Epoch: 1, Steps: 257 | Train Loss: 0.6327106 Vali Loss: 0.3734255 Best vali loss: 0.3734255
	iters: 100, epoch: 2 | loss: 0.8955504
	speed: 0.0122s/iter; left time: 20.7124s
	iters: 200, epoch: 2 | loss: 0.5661666
	speed: 0.0057s/iter; left time: 9.0905s
Updating learning rate to 0.00019888004215
Epoch: 2 cost time: 1.5135130882263184
Epoch: 2, Steps: 257 | Train Loss: 0.7308585 Vali Loss: 0.3925818 Best vali loss: 0.3734255
	iters: 100, epoch: 3 | loss: 0.5507060
	speed: 0.0117s/iter; left time: 16.8776s
	iters: 200, epoch: 3 | loss: 0.7549205
	speed: 0.0054s/iter; left time: 7.2492s
Updating learning rate to 9.9440021075e-05
Epoch: 3 cost time: 1.4351253509521484
Epoch: 3, Steps: 257 | Train Loss: 0.6528132 Vali Loss: 0.3861567 Best vali loss: 0.3734255

best validation loss 0.37342550002755726

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0064457228927, 'e_layers': 4, 'learning_rate': 0.0003951556064, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5593148
	speed: 0.0118s/iter; left time: 23.1769s
	iters: 200, epoch: 1 | loss: 0.6323342
	speed: 0.0055s/iter; left time: 10.1210s
Updating learning rate to 0.0003951556064
Validation loss decreased (inf --> 0.3730).  Saving model state dict ...
Epoch: 1 cost time: 1.76963472366333
Epoch: 1, Steps: 257 | Train Loss: 0.5958245 Vali Loss: 0.3729514 Best vali loss: 0.3729514
	iters: 100, epoch: 2 | loss: 0.8211337
	speed: 0.0120s/iter; left time: 20.4003s
	iters: 200, epoch: 2 | loss: 0.5734057
	speed: 0.0056s/iter; left time: 8.9783s
Updating learning rate to 0.0001975778032
Epoch: 2 cost time: 1.4947242736816406
Epoch: 2, Steps: 257 | Train Loss: 0.6972697 Vali Loss: 0.3793435 Best vali loss: 0.3729514
	iters: 100, epoch: 3 | loss: 0.5331770
	speed: 0.0118s/iter; left time: 17.0325s
	iters: 200, epoch: 3 | loss: 0.5446134
	speed: 0.0057s/iter; left time: 7.6797s
Updating learning rate to 9.87889016e-05
Epoch: 3 cost time: 1.515472173690796
Epoch: 3, Steps: 257 | Train Loss: 0.5388952 Vali Loss: 0.3735995 Best vali loss: 0.3729514

best validation loss 0.37295143689177124

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0064457228927, 'e_layers': 4, 'learning_rate': 0.0003951556064, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5260189
	speed: 0.0125s/iter; left time: 14.8817s
	iters: 200, epoch: 4 | loss: 0.5296909
	speed: 0.0060s/iter; left time: 6.4820s
Updating learning rate to 4.93944508e-05
Epoch: 4 cost time: 1.875417947769165
Epoch: 4, Steps: 257 | Train Loss: 0.5278549 Vali Loss: 0.3803439 Best vali loss: 0.3729514
	iters: 100, epoch: 5 | loss: 0.5174123
	speed: 0.0115s/iter; left time: 10.6421s
	iters: 200, epoch: 5 | loss: 0.4441092
	speed: 0.0053s/iter; left time: 4.3678s
Updating learning rate to 2.46972254e-05
Validation loss decreased (0.3730 --> 0.3491).  Saving model state dict ...
Epoch: 5 cost time: 1.3828716278076172
Epoch: 5, Steps: 257 | Train Loss: 0.4807607 Vali Loss: 0.3490836 Best vali loss: 0.3490836
	iters: 100, epoch: 6 | loss: 0.4736563
	speed: 0.0115s/iter; left time: 7.7546s
	iters: 200, epoch: 6 | loss: 0.4214419
	speed: 0.0053s/iter; left time: 3.0288s
Updating learning rate to 1.23486127e-05
Validation loss decreased (0.3491 --> 0.3439).  Saving model state dict ...
Epoch: 6 cost time: 1.4036498069763184
Epoch: 6, Steps: 257 | Train Loss: 0.4475491 Vali Loss: 0.3438544 Best vali loss: 0.3438544
	iters: 100, epoch: 7 | loss: 0.5229652
	speed: 0.0117s/iter; left time: 4.8438s
	iters: 200, epoch: 7 | loss: 0.3420293
	speed: 0.0052s/iter; left time: 1.6231s
Updating learning rate to 6.17430635e-06
Epoch: 7 cost time: 1.3806684017181396
Epoch: 7, Steps: 257 | Train Loss: 0.4324972 Vali Loss: 0.3459432 Best vali loss: 0.3438544
	iters: 100, epoch: 8 | loss: 0.6345797
	speed: 0.0115s/iter; left time: 1.8204s
	iters: 200, epoch: 8 | loss: 0.4068272
	speed: 0.0057s/iter; left time: 0.3289s
Updating learning rate to 3.087153175e-06
Epoch: 8 cost time: 1.507777452468872
Epoch: 8, Steps: 257 | Train Loss: 0.5207035 Vali Loss: 0.3470986 Best vali loss: 0.3438544

best validation loss 0.3438544446920833

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020856216981, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 0.6577794551849365
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3657833 Best vali loss: 0.3657833
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3658 --> 0.3619).  Saving model state dict ...
Epoch: 2 cost time: 0.3736839294433594
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3618742 Best vali loss: 0.3618742
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.37354564666748047
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3783959 Best vali loss: 0.3618742
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3619 --> 0.3516).  Saving model state dict ...
Epoch: 4 cost time: 0.36290764808654785
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3516321 Best vali loss: 0.3516321
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.34776806831359863
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3837161 Best vali loss: 0.3516321
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.36014676094055176
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3770808 Best vali loss: 0.3516321
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.33730554580688477
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3860220 Best vali loss: 0.3516321
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.3672511577606201
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3778980 Best vali loss: 0.3516321

best validation loss 0.35163210210022616

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020859601235, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 0.6428432464599609
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3657912 Best vali loss: 0.3657912
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3658 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.3496241569519043
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619687 Best vali loss: 0.3619687
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.3582139015197754
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3774223 Best vali loss: 0.3619687
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3620 --> 0.3518).  Saving model state dict ...
Epoch: 4 cost time: 0.36108875274658203
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3518149 Best vali loss: 0.3518149
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.34256911277770996
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3686018 Best vali loss: 0.3518149
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.35608577728271484
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3709759 Best vali loss: 0.3518149
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.36501502990722656
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3748316 Best vali loss: 0.3518149
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.3576207160949707
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3697279 Best vali loss: 0.3518149

best validation loss 0.3518149405190893

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0041309455211, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 1.0934679508209229
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3693747 Best vali loss: 0.3693747
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3694 --> 0.3622).  Saving model state dict ...
Epoch: 2 cost time: 0.7883870601654053
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3622294 Best vali loss: 0.3622294
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3622 --> 0.3540).  Saving model state dict ...
Epoch: 3 cost time: 0.779062032699585
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3539771 Best vali loss: 0.3539771

best validation loss 0.3539771220538846

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0114740030414, 'e_layers': 4, 'learning_rate': 0.000661842336, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000661842336
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 1.0892562866210938
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3685422 Best vali loss: 0.3685422
Updating learning rate to 0.000330921168
Validation loss decreased (0.3685 --> 0.3589).  Saving model state dict ...
Epoch: 2 cost time: 0.7874221801757812
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3588782 Best vali loss: 0.3588782
Updating learning rate to 0.000165460584
Epoch: 3 cost time: 0.7916991710662842
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3613639 Best vali loss: 0.3588782

best validation loss 0.35887822226597427

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0116337493847, 'e_layers': 4, 'learning_rate': 0.0006775129154, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006775129154
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 1.093386173248291
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3698457 Best vali loss: 0.3698457
Updating learning rate to 0.0003387564577
Epoch: 2 cost time: 0.7776937484741211
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3719577 Best vali loss: 0.3698457
Updating learning rate to 0.00016937822885
Validation loss decreased (0.3698 --> 0.3533).  Saving model state dict ...
Epoch: 3 cost time: 0.7851591110229492
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3532789 Best vali loss: 0.3532789

best validation loss 0.35327885408532644

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0116337493847, 'e_layers': 4, 'learning_rate': 0.0006775129154, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.4689114425e-05
Validation loss decreased (0.3533 --> 0.3481).  Saving model state dict ...
Epoch: 4 cost time: 1.0983915328979492
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3480942 Best vali loss: 0.3480942
Updating learning rate to 4.23445572125e-05
Validation loss decreased (0.3481 --> 0.3466).  Saving model state dict ...
Epoch: 5 cost time: 0.785820722579956
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3465602 Best vali loss: 0.3465602
Updating learning rate to 2.117227860625e-05
Validation loss decreased (0.3466 --> 0.3426).  Saving model state dict ...
Epoch: 6 cost time: 0.7816650867462158
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3426248 Best vali loss: 0.3426248
Updating learning rate to 1.0586139303125e-05
Validation loss decreased (0.3426 --> 0.3415).  Saving model state dict ...
Epoch: 7 cost time: 0.7837870121002197
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3415415 Best vali loss: 0.3415415
Updating learning rate to 5.2930696515625e-06
Epoch: 8 cost time: 0.7813692092895508
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3425921 Best vali loss: 0.3415415

best validation loss 0.34154154342143617

[INFO][smbo.py:320] Finished 850 trials.
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0041520944243, 'e_layers': 4, 'learning_rate': 0.0006651552524, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006651552524
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 1.093871831893921
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3686106 Best vali loss: 0.3686106
Updating learning rate to 0.0003325776262
Validation loss decreased (0.3686 --> 0.3669).  Saving model state dict ...
Epoch: 2 cost time: 0.7867858409881592
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3668511 Best vali loss: 0.3668511
Updating learning rate to 0.0001662888131
Validation loss decreased (0.3669 --> 0.3588).  Saving model state dict ...
Epoch: 3 cost time: 0.7804467678070068
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3587590 Best vali loss: 0.3587590
Updating learning rate to 8.314440655e-05
Validation loss decreased (0.3588 --> 0.3498).  Saving model state dict ...
Epoch: 4 cost time: 0.7919795513153076
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3498272 Best vali loss: 0.3498272
Updating learning rate to 4.1572203275e-05
Epoch: 5 cost time: 0.7853929996490479
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3523377 Best vali loss: 0.3498272
Updating learning rate to 2.07861016375e-05
Epoch: 6 cost time: 0.7797765731811523
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3546480 Best vali loss: 0.3498272
Updating learning rate to 1.039305081875e-05
Epoch: 7 cost time: 0.7842638492584229
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3521167 Best vali loss: 0.3498272
Updating learning rate to 5.196525409375e-06
Epoch: 8 cost time: 0.784416913986206
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3525333 Best vali loss: 0.3498272

best validation loss 0.34982720362882486

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008427189805, 'e_layers': 4, 'learning_rate': 0.0003166664495, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4750053
	speed: 0.0157s/iter; left time: 14.6737s
Updating learning rate to 0.0003166664495
Validation loss decreased (inf --> 0.3815).  Saving model state dict ...
Epoch: 1 cost time: 1.6002795696258545
Epoch: 1, Steps: 129 | Train Loss: 0.4750053 Vali Loss: 0.3815019 Best vali loss: 0.3815019
	iters: 100, epoch: 2 | loss: 0.5995889
	speed: 0.0156s/iter; left time: 12.5403s
Updating learning rate to 0.00015833322475
Epoch: 2 cost time: 1.2934231758117676
Epoch: 2, Steps: 129 | Train Loss: 0.5995889 Vali Loss: 0.3841580 Best vali loss: 0.3815019
	iters: 100, epoch: 3 | loss: 0.6844114
	speed: 0.0152s/iter; left time: 10.2738s
Updating learning rate to 7.9166612375e-05
Validation loss decreased (0.3815 --> 0.3626).  Saving model state dict ...
Epoch: 3 cost time: 1.2888696193695068
Epoch: 3, Steps: 129 | Train Loss: 0.6844114 Vali Loss: 0.3626319 Best vali loss: 0.3626319
	iters: 100, epoch: 4 | loss: 0.6694534
	speed: 0.0159s/iter; left time: 8.6996s
Updating learning rate to 3.95833061875e-05
Epoch: 4 cost time: 1.293161392211914
Epoch: 4, Steps: 129 | Train Loss: 0.6694534 Vali Loss: 0.3629431 Best vali loss: 0.3626319
	iters: 100, epoch: 5 | loss: 0.4793661
	speed: 0.0151s/iter; left time: 6.3005s
Updating learning rate to 1.979165309375e-05
Validation loss decreased (0.3626 --> 0.3600).  Saving model state dict ...
Epoch: 5 cost time: 1.2869274616241455
Epoch: 5, Steps: 129 | Train Loss: 0.4793661 Vali Loss: 0.3599838 Best vali loss: 0.3599838
	iters: 100, epoch: 6 | loss: 0.3790031
	speed: 0.0158s/iter; left time: 4.5598s
Updating learning rate to 9.895826546875e-06
Validation loss decreased (0.3600 --> 0.3510).  Saving model state dict ...
Epoch: 6 cost time: 1.3013041019439697
Epoch: 6, Steps: 129 | Train Loss: 0.3790031 Vali Loss: 0.3510361 Best vali loss: 0.3510361
	iters: 100, epoch: 7 | loss: 0.4112628
	speed: 0.0157s/iter; left time: 2.5011s
Updating learning rate to 4.9479132734375e-06
Epoch: 7 cost time: 1.2893610000610352
Epoch: 7, Steps: 129 | Train Loss: 0.4112628 Vali Loss: 0.3524433 Best vali loss: 0.3510361
	iters: 100, epoch: 8 | loss: 0.4948815
	speed: 0.0152s/iter; left time: 0.4559s
Updating learning rate to 2.47395663671875e-06
Epoch: 8 cost time: 1.301072120666504
Epoch: 8, Steps: 129 | Train Loss: 0.4948815 Vali Loss: 0.3510485 Best vali loss: 0.3510361

best validation loss 0.35103608010325776

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022134555186, 'e_layers': 4, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007077576329
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.0961084365844727
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713688 Best vali loss: 0.3713688
Updating learning rate to 0.00035387881645
Validation loss decreased (0.3714 --> 0.3713).  Saving model state dict ...
Epoch: 2 cost time: 0.7818350791931152
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3713193 Best vali loss: 0.3713193
Updating learning rate to 0.000176939408225
Validation loss decreased (0.3713 --> 0.3612).  Saving model state dict ...
Epoch: 3 cost time: 0.7883682250976562
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3611974 Best vali loss: 0.3611974

best validation loss 0.3611973741785248

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008317501133, 'e_layers': 2, 'learning_rate': 0.000376198658, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9359304
	speed: 0.0095s/iter; left time: 38.3081s
	iters: 200, epoch: 1 | loss: 0.4424993
	speed: 0.0034s/iter; left time: 13.2070s
	iters: 300, epoch: 1 | loss: 1.2592453
	speed: 0.0032s/iter; left time: 12.1339s
	iters: 400, epoch: 1 | loss: 0.4606056
	speed: 0.0032s/iter; left time: 11.8294s
	iters: 500, epoch: 1 | loss: 0.9889598
	speed: 0.0032s/iter; left time: 11.5830s
Updating learning rate to 0.000376198658
Validation loss decreased (inf --> 0.3780).  Saving model state dict ...
Epoch: 1 cost time: 2.041076898574829
Epoch: 1, Steps: 514 | Train Loss: 0.8174481 Vali Loss: 0.3780364 Best vali loss: 0.3780364
	iters: 100, epoch: 2 | loss: 0.5300300
	speed: 0.0071s/iter; left time: 24.9616s
	iters: 200, epoch: 2 | loss: 1.0143623
	speed: 0.0031s/iter; left time: 10.5284s
	iters: 300, epoch: 2 | loss: 0.3363914
	speed: 0.0031s/iter; left time: 10.2805s
	iters: 400, epoch: 2 | loss: 0.9854987
	speed: 0.0031s/iter; left time: 9.9355s
	iters: 500, epoch: 2 | loss: 0.7864591
	speed: 0.0031s/iter; left time: 9.7583s
Updating learning rate to 0.000188099329
Epoch: 2 cost time: 1.6508815288543701
Epoch: 2, Steps: 514 | Train Loss: 0.7305483 Vali Loss: 0.3940441 Best vali loss: 0.3780364
	iters: 100, epoch: 3 | loss: 0.6034280
	speed: 0.0070s/iter; left time: 20.7596s
	iters: 200, epoch: 3 | loss: 0.3542895
	speed: 0.0032s/iter; left time: 9.2397s
	iters: 300, epoch: 3 | loss: 0.5449834
	speed: 0.0031s/iter; left time: 8.6621s
	iters: 400, epoch: 3 | loss: 0.2586885
	speed: 0.0031s/iter; left time: 8.4094s
	iters: 500, epoch: 3 | loss: 0.8753518
	speed: 0.0032s/iter; left time: 8.1859s
Updating learning rate to 9.40496645e-05
Epoch: 3 cost time: 1.661078929901123
Epoch: 3, Steps: 514 | Train Loss: 0.5273483 Vali Loss: 0.4014361 Best vali loss: 0.3780364

best validation loss 0.37803644272105397

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008271963678, 'e_layers': 2, 'learning_rate': 0.0003900521027, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9355791
	speed: 0.0097s/iter; left time: 39.1016s
	iters: 200, epoch: 1 | loss: 0.4297511
	speed: 0.0036s/iter; left time: 13.9651s
	iters: 300, epoch: 1 | loss: 1.2460001
	speed: 0.0036s/iter; left time: 13.5523s
	iters: 400, epoch: 1 | loss: 0.4197203
	speed: 0.0035s/iter; left time: 13.1610s
	iters: 500, epoch: 1 | loss: 1.0774972
	speed: 0.0036s/iter; left time: 12.8527s
Updating learning rate to 0.0003900521027
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.184906244277954
Epoch: 1, Steps: 514 | Train Loss: 0.8217096 Vali Loss: 0.3747694 Best vali loss: 0.3747694
	iters: 100, epoch: 2 | loss: 0.5306371
	speed: 0.0074s/iter; left time: 26.0025s
	iters: 200, epoch: 2 | loss: 1.0472869
	speed: 0.0031s/iter; left time: 10.5022s
	iters: 300, epoch: 2 | loss: 0.3598795
	speed: 0.0031s/iter; left time: 10.2426s
	iters: 400, epoch: 2 | loss: 1.0034612
	speed: 0.0032s/iter; left time: 10.1142s
	iters: 500, epoch: 2 | loss: 0.7813326
	speed: 0.0033s/iter; left time: 10.2990s
Updating learning rate to 0.00019502605135
Epoch: 2 cost time: 1.6852996349334717
Epoch: 2, Steps: 514 | Train Loss: 0.7445195 Vali Loss: 0.3814257 Best vali loss: 0.3747694
	iters: 100, epoch: 3 | loss: 0.6171916
	speed: 0.0071s/iter; left time: 21.2532s
	iters: 200, epoch: 3 | loss: 0.3633048
	speed: 0.0033s/iter; left time: 9.4730s
	iters: 300, epoch: 3 | loss: 0.5529099
	speed: 0.0033s/iter; left time: 9.2621s
	iters: 400, epoch: 3 | loss: 0.2638709
	speed: 0.0033s/iter; left time: 8.7665s
	iters: 500, epoch: 3 | loss: 0.9186969
	speed: 0.0033s/iter; left time: 8.5486s
Updating learning rate to 9.7513025675e-05
Epoch: 3 cost time: 1.7235665321350098
Epoch: 3, Steps: 514 | Train Loss: 0.5431948 Vali Loss: 0.3949644 Best vali loss: 0.3747694

best validation loss 0.3747694453755156

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022134555186, 'e_layers': 4, 'learning_rate': 0.0007077576329, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.84697041125e-05
Validation loss decreased (0.3612 --> 0.3522).  Saving model state dict ...
Epoch: 4 cost time: 1.102987289428711
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3521567 Best vali loss: 0.3521567
Updating learning rate to 4.423485205625e-05
Validation loss decreased (0.3522 --> 0.3471).  Saving model state dict ...
Epoch: 5 cost time: 0.7821066379547119
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3470846 Best vali loss: 0.3470846
Updating learning rate to 2.2117426028125e-05
Validation loss decreased (0.3471 --> 0.3399).  Saving model state dict ...
Epoch: 6 cost time: 0.780829668045044
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3399173 Best vali loss: 0.3399173
Updating learning rate to 1.10587130140625e-05
Validation loss decreased (0.3399 --> 0.3392).  Saving model state dict ...
Epoch: 7 cost time: 0.7872474193572998
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3391916 Best vali loss: 0.3391916
Updating learning rate to 5.52935650703125e-06
Epoch: 8 cost time: 0.7884633541107178
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3441623 Best vali loss: 0.3391916

best validation loss 0.3391915699353621

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024162492917, 'e_layers': 4, 'learning_rate': 0.0003913963852, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.1882321
	speed: 0.0110s/iter; left time: 89.3547s
	iters: 200, epoch: 1 | loss: 0.7571170
	speed: 0.0051s/iter; left time: 40.8063s
	iters: 300, epoch: 1 | loss: 0.3591804
	speed: 0.0051s/iter; left time: 40.3432s
	iters: 400, epoch: 1 | loss: 0.4200222
	speed: 0.0051s/iter; left time: 39.5466s
	iters: 500, epoch: 1 | loss: 0.3465659
	speed: 0.0048s/iter; left time: 36.8034s
	iters: 600, epoch: 1 | loss: 0.2725449
	speed: 0.0048s/iter; left time: 36.2121s
	iters: 700, epoch: 1 | loss: 0.4230372
	speed: 0.0048s/iter; left time: 35.7458s
	iters: 800, epoch: 1 | loss: 0.3192255
	speed: 0.0048s/iter; left time: 35.3118s
	iters: 900, epoch: 1 | loss: 0.5047249
	speed: 0.0048s/iter; left time: 34.7626s
	iters: 1000, epoch: 1 | loss: 0.4041637
	speed: 0.0048s/iter; left time: 34.3792s
Updating learning rate to 0.0003913963852
Validation loss decreased (inf --> 0.3852).  Saving model state dict ...
Epoch: 1 cost time: 5.352012395858765
Epoch: 1, Steps: 1027 | Train Loss: 0.3994814 Vali Loss: 0.3852249 Best vali loss: 0.3852249
	iters: 100, epoch: 2 | loss: 1.2401425
	speed: 0.0131s/iter; left time: 92.9769s
	iters: 200, epoch: 2 | loss: 0.7112882
	speed: 0.0052s/iter; left time: 36.0850s
	iters: 300, epoch: 2 | loss: 0.4339536
	speed: 0.0051s/iter; left time: 35.2940s
	iters: 400, epoch: 2 | loss: 0.5870363
	speed: 0.0051s/iter; left time: 34.6648s
	iters: 500, epoch: 2 | loss: 1.0696236
	speed: 0.0051s/iter; left time: 33.9136s
	iters: 600, epoch: 2 | loss: 0.4635288
	speed: 0.0051s/iter; left time: 33.4124s
	iters: 700, epoch: 2 | loss: 0.5567909
	speed: 0.0050s/iter; left time: 32.7665s
	iters: 800, epoch: 2 | loss: 1.0740992
	speed: 0.0051s/iter; left time: 32.3870s
	iters: 900, epoch: 2 | loss: 1.4065006
	speed: 0.0051s/iter; left time: 32.0263s
	iters: 1000, epoch: 2 | loss: 0.9374215
	speed: 0.0051s/iter; left time: 31.3133s
Updating learning rate to 0.0001956981926
Epoch: 2 cost time: 5.270017385482788
Epoch: 2, Steps: 1027 | Train Loss: 0.8480385 Vali Loss: 0.4018503 Best vali loss: 0.3852249
	iters: 100, epoch: 3 | loss: 1.3321072
	speed: 0.0128s/iter; left time: 77.3332s
	iters: 200, epoch: 3 | loss: 0.9043114
	speed: 0.0047s/iter; left time: 28.1711s
	iters: 300, epoch: 3 | loss: 0.9715420
	speed: 0.0048s/iter; left time: 27.9190s
	iters: 400, epoch: 3 | loss: 0.6810743
	speed: 0.0048s/iter; left time: 27.6294s
	iters: 500, epoch: 3 | loss: 0.9239956
	speed: 0.0048s/iter; left time: 26.9681s
	iters: 600, epoch: 3 | loss: 0.5375974
	speed: 0.0048s/iter; left time: 26.4812s
	iters: 700, epoch: 3 | loss: 0.3916591
	speed: 0.0048s/iter; left time: 26.1538s
	iters: 800, epoch: 3 | loss: 0.3826286
	speed: 0.0047s/iter; left time: 25.2262s
	iters: 900, epoch: 3 | loss: 0.4945492
	speed: 0.0047s/iter; left time: 24.8495s
	iters: 1000, epoch: 3 | loss: 0.7845203
	speed: 0.0047s/iter; left time: 24.4491s
Updating learning rate to 9.78490963e-05
Epoch: 3 cost time: 4.941835880279541
Epoch: 3, Steps: 1027 | Train Loss: 0.7403985 Vali Loss: 0.3969913 Best vali loss: 0.3852249
	iters: 100, epoch: 4 | loss: 1.3884352
	speed: 0.0127s/iter; left time: 63.8518s
	iters: 200, epoch: 4 | loss: 0.3371933
	speed: 0.0047s/iter; left time: 23.0951s
	iters: 300, epoch: 4 | loss: 0.4045765
	speed: 0.0047s/iter; left time: 22.9226s
	iters: 400, epoch: 4 | loss: 0.4037287
	speed: 0.0047s/iter; left time: 22.1937s
	iters: 500, epoch: 4 | loss: 0.2647207
	speed: 0.0048s/iter; left time: 22.1980s
	iters: 600, epoch: 4 | loss: 0.4047796
	speed: 0.0047s/iter; left time: 21.3516s
	iters: 700, epoch: 4 | loss: 0.4134256
	speed: 0.0047s/iter; left time: 20.8474s
	iters: 800, epoch: 4 | loss: 0.4528859
	speed: 0.0046s/iter; left time: 20.1498s
	iters: 900, epoch: 4 | loss: 0.6242745
	speed: 0.0047s/iter; left time: 19.7239s
	iters: 1000, epoch: 4 | loss: 0.9761471
	speed: 0.0047s/iter; left time: 19.2918s
Updating learning rate to 4.892454815e-05
Epoch: 4 cost time: 4.884332656860352
Epoch: 4, Steps: 1027 | Train Loss: 0.5670167 Vali Loss: 0.3897576 Best vali loss: 0.3852249
	iters: 100, epoch: 5 | loss: 0.6248671
	speed: 0.0124s/iter; left time: 49.6958s
	iters: 200, epoch: 5 | loss: 0.2625130
	speed: 0.0046s/iter; left time: 17.8695s
	iters: 300, epoch: 5 | loss: 0.9472081
	speed: 0.0046s/iter; left time: 17.3826s
	iters: 400, epoch: 5 | loss: 0.6361133
	speed: 0.0046s/iter; left time: 17.1047s
	iters: 500, epoch: 5 | loss: 0.4589162
	speed: 0.0046s/iter; left time: 16.5572s
	iters: 600, epoch: 5 | loss: 0.4768964
	speed: 0.0046s/iter; left time: 16.0977s
	iters: 700, epoch: 5 | loss: 0.4249942
	speed: 0.0050s/iter; left time: 16.9174s
	iters: 800, epoch: 5 | loss: 0.7503021
	speed: 0.0051s/iter; left time: 16.7773s
	iters: 900, epoch: 5 | loss: 0.3917855
	speed: 0.0051s/iter; left time: 16.3795s
	iters: 1000, epoch: 5 | loss: 0.8986918
	speed: 0.0048s/iter; left time: 14.9187s
Updating learning rate to 2.4462274075e-05
Epoch: 5 cost time: 4.893723487854004
Epoch: 5, Steps: 1027 | Train Loss: 0.5872288 Vali Loss: 0.3910923 Best vali loss: 0.3852249
	iters: 100, epoch: 6 | loss: 0.4826114
	speed: 0.0127s/iter; left time: 38.0167s
	iters: 200, epoch: 6 | loss: 0.4182165
	speed: 0.0048s/iter; left time: 13.7346s
	iters: 300, epoch: 6 | loss: 0.6547705
	speed: 0.0047s/iter; left time: 13.1904s
	iters: 400, epoch: 6 | loss: 0.3398581
	speed: 0.0047s/iter; left time: 12.6630s
	iters: 500, epoch: 6 | loss: 0.4779913
	speed: 0.0048s/iter; left time: 12.4161s
	iters: 600, epoch: 6 | loss: 0.3808478
	speed: 0.0047s/iter; left time: 11.7766s
	iters: 700, epoch: 6 | loss: 0.3817148
	speed: 0.0048s/iter; left time: 11.3690s
	iters: 800, epoch: 6 | loss: 0.2602965
	speed: 0.0048s/iter; left time: 10.8671s
	iters: 900, epoch: 6 | loss: 0.5471292
	speed: 0.0048s/iter; left time: 10.4439s
	iters: 1000, epoch: 6 | loss: 0.2774125
	speed: 0.0048s/iter; left time: 10.0458s
Updating learning rate to 1.22311370375e-05
Epoch: 6 cost time: 4.979002952575684
Epoch: 6, Steps: 1027 | Train Loss: 0.4220848 Vali Loss: 0.3862976 Best vali loss: 0.3852249
	iters: 100, epoch: 7 | loss: 0.7186105
	speed: 0.0127s/iter; left time: 24.7856s
	iters: 200, epoch: 7 | loss: 1.2727462
	speed: 0.0048s/iter; left time: 8.9856s
	iters: 300, epoch: 7 | loss: 0.4702739
	speed: 0.0048s/iter; left time: 8.4815s
	iters: 400, epoch: 7 | loss: 0.9659926
	speed: 0.0048s/iter; left time: 7.9560s
	iters: 500, epoch: 7 | loss: 1.1983693
	speed: 0.0048s/iter; left time: 7.4748s
	iters: 600, epoch: 7 | loss: 0.5166526
	speed: 0.0048s/iter; left time: 6.9925s
	iters: 700, epoch: 7 | loss: 0.6459204
	speed: 0.0048s/iter; left time: 6.5248s
	iters: 800, epoch: 7 | loss: 0.4884407
	speed: 0.0048s/iter; left time: 6.0684s
	iters: 900, epoch: 7 | loss: 0.5657874
	speed: 0.0048s/iter; left time: 5.5844s
	iters: 1000, epoch: 7 | loss: 0.2856036
	speed: 0.0047s/iter; left time: 4.9596s
Updating learning rate to 6.11556851875e-06
Epoch: 7 cost time: 4.972135066986084
Epoch: 7, Steps: 1027 | Train Loss: 0.7128397 Vali Loss: 0.3855117 Best vali loss: 0.3852249
	iters: 100, epoch: 8 | loss: 1.6077087
	speed: 0.0126s/iter; left time: 11.6643s
	iters: 200, epoch: 8 | loss: 0.2910476
	speed: 0.0048s/iter; left time: 3.9477s
	iters: 300, epoch: 8 | loss: 0.8146150
	speed: 0.0048s/iter; left time: 3.4619s
	iters: 400, epoch: 8 | loss: 0.6328421
	speed: 0.0048s/iter; left time: 3.0070s
	iters: 500, epoch: 8 | loss: 0.2936224
	speed: 0.0048s/iter; left time: 2.5124s
	iters: 600, epoch: 8 | loss: 0.3423122
	speed: 0.0047s/iter; left time: 2.0300s
	iters: 700, epoch: 8 | loss: 0.2996084
	speed: 0.0048s/iter; left time: 1.5600s
	iters: 800, epoch: 8 | loss: 0.2515140
	speed: 0.0047s/iter; left time: 1.0790s
	iters: 900, epoch: 8 | loss: 0.6347830
	speed: 0.0047s/iter; left time: 0.6051s
	iters: 1000, epoch: 8 | loss: 0.1981762
	speed: 0.0047s/iter; left time: 0.1327s
Updating learning rate to 3.057784259375e-06
Validation loss decreased (0.3852 --> 0.3846).  Saving model state dict ...
Epoch: 8 cost time: 4.917735576629639
Epoch: 8, Steps: 1027 | Train Loss: 0.5366230 Vali Loss: 0.3845913 Best vali loss: 0.3845913

best validation loss 0.3845913138921228

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0062330188366, 'e_layers': 4, 'learning_rate': 0.0003967143905, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4488316
	speed: 0.0116s/iter; left time: 22.7116s
	iters: 200, epoch: 1 | loss: 0.5069157
	speed: 0.0056s/iter; left time: 10.3122s
Updating learning rate to 0.0003967143905
Validation loss decreased (inf --> 0.3811).  Saving model state dict ...
Epoch: 1 cost time: 1.7718541622161865
Epoch: 1, Steps: 257 | Train Loss: 0.4778736 Vali Loss: 0.3810790 Best vali loss: 0.3810790
	iters: 100, epoch: 2 | loss: 0.7298726
	speed: 0.0115s/iter; left time: 19.6201s
	iters: 200, epoch: 2 | loss: 0.5786517
	speed: 0.0054s/iter; left time: 8.5840s
Updating learning rate to 0.00019835719525
Validation loss decreased (0.3811 --> 0.3779).  Saving model state dict ...
Epoch: 2 cost time: 1.4314508438110352
Epoch: 2, Steps: 257 | Train Loss: 0.6542621 Vali Loss: 0.3778870 Best vali loss: 0.3778870
	iters: 100, epoch: 3 | loss: 0.4408295
	speed: 0.0117s/iter; left time: 16.8689s
	iters: 200, epoch: 3 | loss: 0.7158102
	speed: 0.0052s/iter; left time: 7.0166s
Updating learning rate to 9.9178597625e-05
Validation loss decreased (0.3779 --> 0.3561).  Saving model state dict ...
Epoch: 3 cost time: 1.3979690074920654
Epoch: 3, Steps: 257 | Train Loss: 0.5783199 Vali Loss: 0.3560895 Best vali loss: 0.3560895
	iters: 100, epoch: 4 | loss: 0.3991360
	speed: 0.0113s/iter; left time: 13.4369s
	iters: 200, epoch: 4 | loss: 0.6295534
	speed: 0.0052s/iter; left time: 5.6945s
Updating learning rate to 4.95892988125e-05
Validation loss decreased (0.3561 --> 0.3453).  Saving model state dict ...
Epoch: 4 cost time: 1.3875019550323486
Epoch: 4, Steps: 257 | Train Loss: 0.5143447 Vali Loss: 0.3452652 Best vali loss: 0.3452652
	iters: 100, epoch: 5 | loss: 0.5123970
	speed: 0.0115s/iter; left time: 10.6879s
	iters: 200, epoch: 5 | loss: 0.5454147
	speed: 0.0057s/iter; left time: 4.7515s
Updating learning rate to 2.479464940625e-05
Epoch: 5 cost time: 1.4779207706451416
Epoch: 5, Steps: 257 | Train Loss: 0.5289058 Vali Loss: 0.3481860 Best vali loss: 0.3452652
	iters: 100, epoch: 6 | loss: 0.8093619
	speed: 0.0113s/iter; left time: 7.6193s
	iters: 200, epoch: 6 | loss: 0.3861346
	speed: 0.0054s/iter; left time: 3.0974s
Updating learning rate to 1.2397324703125e-05
Epoch: 6 cost time: 1.44423246383667
Epoch: 6, Steps: 257 | Train Loss: 0.5977482 Vali Loss: 0.3497420 Best vali loss: 0.3452652
	iters: 100, epoch: 7 | loss: 0.3637336
	speed: 0.0115s/iter; left time: 4.7599s
	iters: 200, epoch: 7 | loss: 0.3243263
	speed: 0.0056s/iter; left time: 1.7502s
Updating learning rate to 6.1986623515625e-06
Epoch: 7 cost time: 1.4733002185821533
Epoch: 7, Steps: 257 | Train Loss: 0.3440300 Vali Loss: 0.3528632 Best vali loss: 0.3452652
	iters: 100, epoch: 8 | loss: 0.8018017
	speed: 0.0113s/iter; left time: 1.7895s
	iters: 200, epoch: 8 | loss: 0.5799708
	speed: 0.0054s/iter; left time: 0.3160s
Updating learning rate to 3.09933117578125e-06
Epoch: 8 cost time: 1.4526174068450928
Epoch: 8, Steps: 257 | Train Loss: 0.6908862 Vali Loss: 0.3547510 Best vali loss: 0.3452652

best validation loss 0.3452652063140232

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.002584077765, 'e_layers': 1, 'learning_rate': 0.0001610394747, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4650213
	speed: 0.0085s/iter; left time: 34.1948s
	iters: 200, epoch: 1 | loss: 0.4869376
	speed: 0.0025s/iter; left time: 9.6055s
	iters: 300, epoch: 1 | loss: 0.2772564
	speed: 0.0025s/iter; left time: 9.4131s
	iters: 400, epoch: 1 | loss: 0.2731527
	speed: 0.0026s/iter; left time: 9.5876s
	iters: 500, epoch: 1 | loss: 0.4052374
	speed: 0.0026s/iter; left time: 9.4168s
Updating learning rate to 0.0001610394747
Validation loss decreased (inf --> 0.3756).  Saving model state dict ...
Epoch: 1 cost time: 1.638869285583496
Epoch: 1, Steps: 514 | Train Loss: 0.3815211 Vali Loss: 0.3755696 Best vali loss: 0.3755696
	iters: 100, epoch: 2 | loss: 1.0709125
	speed: 0.0059s/iter; left time: 20.7610s
	iters: 200, epoch: 2 | loss: 0.9960200
	speed: 0.0025s/iter; left time: 8.6527s
	iters: 300, epoch: 2 | loss: 0.3973520
	speed: 0.0026s/iter; left time: 8.5164s
	iters: 400, epoch: 2 | loss: 0.2110554
	speed: 0.0025s/iter; left time: 7.8509s
	iters: 500, epoch: 2 | loss: 1.0874305
	speed: 0.0025s/iter; left time: 7.8767s
Updating learning rate to 8.051973735e-05
Validation loss decreased (0.3756 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 1.3364863395690918
Epoch: 2, Steps: 514 | Train Loss: 0.7525541 Vali Loss: 0.3666257 Best vali loss: 0.3666257
	iters: 100, epoch: 3 | loss: 0.6437591
	speed: 0.0058s/iter; left time: 17.3974s
	iters: 200, epoch: 3 | loss: 0.6121207
	speed: 0.0024s/iter; left time: 6.7864s
	iters: 300, epoch: 3 | loss: 0.4504195
	speed: 0.0024s/iter; left time: 6.5981s
	iters: 400, epoch: 3 | loss: 0.9115752
	speed: 0.0024s/iter; left time: 6.5254s
	iters: 500, epoch: 3 | loss: 0.3613963
	speed: 0.0024s/iter; left time: 6.1969s
Updating learning rate to 4.0259868675e-05
Validation loss decreased (0.3666 --> 0.3651).  Saving model state dict ...
Epoch: 3 cost time: 1.266862154006958
Epoch: 3, Steps: 514 | Train Loss: 0.5958542 Vali Loss: 0.3650688 Best vali loss: 0.3650688

best validation loss 0.36506878751200167

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0062345839925, 'e_layers': 4, 'learning_rate': 0.0003949253895, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4511818
	speed: 0.0116s/iter; left time: 22.6899s
	iters: 200, epoch: 1 | loss: 0.5102341
	speed: 0.0055s/iter; left time: 10.2233s
Updating learning rate to 0.0003949253895
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.7601802349090576
Epoch: 1, Steps: 257 | Train Loss: 0.4807080 Vali Loss: 0.3714687 Best vali loss: 0.3714687
	iters: 100, epoch: 2 | loss: 0.7496651
	speed: 0.0117s/iter; left time: 19.8204s
	iters: 200, epoch: 2 | loss: 0.5704610
	speed: 0.0056s/iter; left time: 8.9128s
Updating learning rate to 0.00019746269475
Epoch: 2 cost time: 1.4605703353881836
Epoch: 2, Steps: 257 | Train Loss: 0.6600631 Vali Loss: 0.3930045 Best vali loss: 0.3714687
	iters: 100, epoch: 3 | loss: 0.4693616
	speed: 0.0114s/iter; left time: 16.4040s
	iters: 200, epoch: 3 | loss: 0.6657828
	speed: 0.0054s/iter; left time: 7.2726s
Updating learning rate to 9.8731347375e-05
Validation loss decreased (0.3715 --> 0.3444).  Saving model state dict ...
Epoch: 3 cost time: 1.4309377670288086
Epoch: 3, Steps: 257 | Train Loss: 0.5675722 Vali Loss: 0.3444033 Best vali loss: 0.3444033

best validation loss 0.344403300819322

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0062884198377, 'e_layers': 4, 'learning_rate': 0.000455318295, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4196354
	speed: 0.0114s/iter; left time: 22.3972s
	iters: 200, epoch: 1 | loss: 0.6593909
	speed: 0.0053s/iter; left time: 9.8986s
Updating learning rate to 0.000455318295
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 1.7078585624694824
Epoch: 1, Steps: 257 | Train Loss: 0.5395132 Vali Loss: 0.3698739 Best vali loss: 0.3698739
	iters: 100, epoch: 2 | loss: 0.5750306
	speed: 0.0110s/iter; left time: 18.7567s
	iters: 200, epoch: 2 | loss: 0.5544934
	speed: 0.0050s/iter; left time: 8.0383s
Updating learning rate to 0.0002276591475
Validation loss decreased (0.3699 --> 0.3616).  Saving model state dict ...
Epoch: 2 cost time: 1.354262351989746
Epoch: 2, Steps: 257 | Train Loss: 0.5647620 Vali Loss: 0.3615989 Best vali loss: 0.3615989
	iters: 100, epoch: 3 | loss: 0.5195535
	speed: 0.0114s/iter; left time: 16.4890s
	iters: 200, epoch: 3 | loss: 0.3213610
	speed: 0.0054s/iter; left time: 7.2428s
Updating learning rate to 0.00011382957375
Validation loss decreased (0.3616 --> 0.3492).  Saving model state dict ...
Epoch: 3 cost time: 1.4289181232452393
Epoch: 3, Steps: 257 | Train Loss: 0.4204572 Vali Loss: 0.3491928 Best vali loss: 0.3491928

best validation loss 0.34919275117997806

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0062345839925, 'e_layers': 4, 'learning_rate': 0.0003949253895, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2829262
	speed: 0.0121s/iter; left time: 14.2952s
	iters: 200, epoch: 4 | loss: 0.4087574
	speed: 0.0056s/iter; left time: 6.0354s
Updating learning rate to 4.93656736875e-05
Epoch: 4 cost time: 1.767805814743042
Epoch: 4, Steps: 257 | Train Loss: 0.3458418 Vali Loss: 0.3478594 Best vali loss: 0.3444033
	iters: 100, epoch: 5 | loss: 0.5872701
	speed: 0.0114s/iter; left time: 10.6248s
	iters: 200, epoch: 5 | loss: 0.4795758
	speed: 0.0055s/iter; left time: 4.5474s
Updating learning rate to 2.468283684375e-05
Epoch: 5 cost time: 1.4516401290893555
Epoch: 5, Steps: 257 | Train Loss: 0.5334230 Vali Loss: 0.3489366 Best vali loss: 0.3444033
	iters: 100, epoch: 6 | loss: 0.3276321
	speed: 0.0114s/iter; left time: 7.6291s
	iters: 200, epoch: 6 | loss: 0.5239283
	speed: 0.0055s/iter; left time: 3.1690s
Updating learning rate to 1.2341418421875e-05
Epoch: 6 cost time: 1.4746954441070557
Epoch: 6, Steps: 257 | Train Loss: 0.4257802 Vali Loss: 0.3537322 Best vali loss: 0.3444033
	iters: 100, epoch: 7 | loss: 0.3681701
	speed: 0.0113s/iter; left time: 4.7005s
	iters: 200, epoch: 7 | loss: 0.5571304
	speed: 0.0055s/iter; left time: 1.7320s
Updating learning rate to 6.1707092109375e-06
Epoch: 7 cost time: 1.448155164718628
Epoch: 7, Steps: 257 | Train Loss: 0.4626503 Vali Loss: 0.3577027 Best vali loss: 0.3444033
	iters: 100, epoch: 8 | loss: 0.4885825
	speed: 0.0112s/iter; left time: 1.7631s
	iters: 200, epoch: 8 | loss: 0.5023062
	speed: 0.0054s/iter; left time: 0.3118s
Updating learning rate to 3.08535460546875e-06
Epoch: 8 cost time: 1.409677267074585
Epoch: 8, Steps: 257 | Train Loss: 0.4954443 Vali Loss: 0.3574665 Best vali loss: 0.3444033

best validation loss 0.344403300819322

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043259636637, 'e_layers': 4, 'learning_rate': 0.0006636257828, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006383680303878504
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.1071479320526123
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3688394 Best vali loss: 0.3688394
Updating learning rate to 0.0005664400369940555
Validation loss decreased (0.3688 --> 0.3611).  Saving model state dict ...
Epoch: 2 cost time: 0.7873780727386475
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3611307 Best vali loss: 0.3611307
Updating learning rate to 0.0004587921875839368
Epoch: 3 cost time: 0.7867448329925537
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3666651 Best vali loss: 0.3611307
Updating learning rate to 0.0003318128914
Validation loss decreased (0.3611 --> 0.3537).  Saving model state dict ...
Epoch: 4 cost time: 0.7806949615478516
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3537467 Best vali loss: 0.3537467
Updating learning rate to 0.00020483359521606323
Validation loss decreased (0.3537 --> 0.3458).  Saving model state dict ...
Epoch: 5 cost time: 0.7843532562255859
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3457690 Best vali loss: 0.3457690
Updating learning rate to 9.718574580594456e-05
Epoch: 6 cost time: 0.7903261184692383
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3459134 Best vali loss: 0.3457690
Updating learning rate to 2.5257752412149643e-05
Epoch: 7 cost time: 0.7810986042022705
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3531607 Best vali loss: 0.3457690
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7785217761993408
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3537669 Best vali loss: 0.3457690

best validation loss 0.34576899319126003

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141703144, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.0988950729370117
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672535 Best vali loss: 0.3672535
Updating learning rate to 0.00035352149005
Epoch: 2 cost time: 0.797091007232666
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3842797 Best vali loss: 0.3672535
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3673 --> 0.3621).  Saving model state dict ...
Epoch: 3 cost time: 0.7900316715240479
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3621170 Best vali loss: 0.3621170
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3621 --> 0.3517).  Saving model state dict ...
Epoch: 4 cost time: 0.7922005653381348
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3516943 Best vali loss: 0.3516943
Updating learning rate to 4.419018625625e-05
Validation loss decreased (0.3517 --> 0.3416).  Saving model state dict ...
Epoch: 5 cost time: 0.792182445526123
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3415771 Best vali loss: 0.3415771
Updating learning rate to 2.2095093128125e-05
Epoch: 6 cost time: 0.799656867980957
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3428612 Best vali loss: 0.3415771
Updating learning rate to 1.10475465640625e-05
Validation loss decreased (0.3416 --> 0.3408).  Saving model state dict ...
Epoch: 7 cost time: 0.7920970916748047
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3407888 Best vali loss: 0.3407888
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.7988052368164062
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3408191 Best vali loss: 0.3407888

best validation loss 0.3407888134008306

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.109389066696167
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672535 Best vali loss: 0.3672535
Updating learning rate to 0.00035352149005
Epoch: 2 cost time: 0.796400785446167
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3842797 Best vali loss: 0.3672535
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3673 --> 0.3621).  Saving model state dict ...
Epoch: 3 cost time: 0.7872202396392822
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3621170 Best vali loss: 0.3621170

best validation loss 0.36211701786119954

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0032493548808, 'e_layers': 4, 'learning_rate': 0.0003922225559, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4584499
	speed: 0.0125s/iter; left time: 24.4612s
	iters: 200, epoch: 1 | loss: 0.5787543
	speed: 0.0057s/iter; left time: 10.4966s
Updating learning rate to 0.0003922225559
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 1.8030469417572021
Epoch: 1, Steps: 257 | Train Loss: 0.5186021 Vali Loss: 0.3739103 Best vali loss: 0.3739103
	iters: 100, epoch: 2 | loss: 0.3939174
	speed: 0.0118s/iter; left time: 20.0985s
	iters: 200, epoch: 2 | loss: 0.6270925
	speed: 0.0054s/iter; left time: 8.6963s
Updating learning rate to 0.00019611127795
Epoch: 2 cost time: 1.4474432468414307
Epoch: 2, Steps: 257 | Train Loss: 0.5105049 Vali Loss: 0.3879361 Best vali loss: 0.3739103
	iters: 100, epoch: 3 | loss: 0.5953858
	speed: 0.0115s/iter; left time: 16.5870s
	iters: 200, epoch: 3 | loss: 0.3422250
	speed: 0.0054s/iter; left time: 7.3021s
Updating learning rate to 9.8055638975e-05
Epoch: 3 cost time: 1.4425675868988037
Epoch: 3, Steps: 257 | Train Loss: 0.4688054 Vali Loss: 0.3747107 Best vali loss: 0.3739103

best validation loss 0.37391025975551495

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0026128461307, 'e_layers': 4, 'learning_rate': 0.0003969699674, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9409137
	speed: 0.0112s/iter; left time: 90.7773s
	iters: 200, epoch: 1 | loss: 0.2661701
	speed: 0.0052s/iter; left time: 41.4334s
	iters: 300, epoch: 1 | loss: 0.2979859
	speed: 0.0052s/iter; left time: 40.9510s
	iters: 400, epoch: 1 | loss: 0.4291086
	speed: 0.0051s/iter; left time: 39.8626s
	iters: 500, epoch: 1 | loss: 0.3863851
	speed: 0.0051s/iter; left time: 39.4712s
	iters: 600, epoch: 1 | loss: 0.3483876
	speed: 0.0051s/iter; left time: 38.9541s
	iters: 700, epoch: 1 | loss: 0.4589339
	speed: 0.0051s/iter; left time: 38.3452s
	iters: 800, epoch: 1 | loss: 0.3451296
	speed: 0.0051s/iter; left time: 37.6813s
	iters: 900, epoch: 1 | loss: 0.5147464
	speed: 0.0051s/iter; left time: 37.1770s
	iters: 1000, epoch: 1 | loss: 1.6164187
	speed: 0.0051s/iter; left time: 36.6976s
Updating learning rate to 0.0003969699674
Validation loss decreased (inf --> 0.3875).  Saving model state dict ...
Epoch: 1 cost time: 5.595402240753174
Epoch: 1, Steps: 1027 | Train Loss: 0.5604180 Vali Loss: 0.3875494 Best vali loss: 0.3875494
	iters: 100, epoch: 2 | loss: 1.0123553
	speed: 0.0150s/iter; left time: 106.2431s
	iters: 200, epoch: 2 | loss: 1.8514749
	speed: 0.0051s/iter; left time: 35.8277s
	iters: 300, epoch: 2 | loss: 0.2093240
	speed: 0.0051s/iter; left time: 35.2998s
	iters: 400, epoch: 2 | loss: 0.4280662
	speed: 0.0051s/iter; left time: 34.8310s
	iters: 500, epoch: 2 | loss: 0.3392614
	speed: 0.0051s/iter; left time: 33.8147s
	iters: 600, epoch: 2 | loss: 0.9175974
	speed: 0.0051s/iter; left time: 33.5173s
	iters: 700, epoch: 2 | loss: 0.8036993
	speed: 0.0051s/iter; left time: 33.1044s
	iters: 800, epoch: 2 | loss: 0.4339894
	speed: 0.0050s/iter; left time: 31.9845s
	iters: 900, epoch: 2 | loss: 1.2924811
	speed: 0.0051s/iter; left time: 32.3505s
	iters: 1000, epoch: 2 | loss: 0.3914422
	speed: 0.0050s/iter; left time: 31.2469s
Updating learning rate to 0.0001984849837
Epoch: 2 cost time: 5.272636890411377
Epoch: 2, Steps: 1027 | Train Loss: 0.7679691 Vali Loss: 0.3959077 Best vali loss: 0.3875494
	iters: 100, epoch: 3 | loss: 0.8226359
	speed: 0.0127s/iter; left time: 76.9611s
	iters: 200, epoch: 3 | loss: 0.3721825
	speed: 0.0050s/iter; left time: 29.7452s
	iters: 300, epoch: 3 | loss: 0.2914558
	speed: 0.0050s/iter; left time: 29.5646s
	iters: 400, epoch: 3 | loss: 0.1533112
	speed: 0.0051s/iter; left time: 29.2962s
	iters: 500, epoch: 3 | loss: 0.4064028
	speed: 0.0050s/iter; left time: 28.5691s
	iters: 600, epoch: 3 | loss: 1.1961511
	speed: 0.0050s/iter; left time: 27.9284s
	iters: 700, epoch: 3 | loss: 0.3280120
	speed: 0.0050s/iter; left time: 27.4715s
	iters: 800, epoch: 3 | loss: 0.4704855
	speed: 0.0050s/iter; left time: 27.0694s
	iters: 900, epoch: 3 | loss: 0.9358116
	speed: 0.0051s/iter; left time: 26.6362s
	iters: 1000, epoch: 3 | loss: 1.3053859
	speed: 0.0050s/iter; left time: 26.0380s
Updating learning rate to 9.924249185e-05
Validation loss decreased (0.3875 --> 0.3795).  Saving model state dict ...
Epoch: 3 cost time: 5.217533111572266
Epoch: 3, Steps: 1027 | Train Loss: 0.6281834 Vali Loss: 0.3795295 Best vali loss: 0.3795295

best validation loss 0.3795295490028816

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3621 --> 0.3535).  Saving model state dict ...
Epoch: 4 cost time: 1.1231248378753662
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3535242 Best vali loss: 0.3535242
Updating learning rate to 4.419018625625e-05
Validation loss decreased (0.3535 --> 0.3469).  Saving model state dict ...
Epoch: 5 cost time: 0.8027348518371582
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3469428 Best vali loss: 0.3469428
Updating learning rate to 2.2095093128125e-05
Validation loss decreased (0.3469 --> 0.3440).  Saving model state dict ...
Epoch: 6 cost time: 0.7918086051940918
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3439650 Best vali loss: 0.3439650
Updating learning rate to 1.10475465640625e-05
Validation loss decreased (0.3440 --> 0.3437).  Saving model state dict ...
Epoch: 7 cost time: 0.7956893444061279
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3436777 Best vali loss: 0.3436777
Updating learning rate to 5.52377328203125e-06
Validation loss decreased (0.3437 --> 0.3429).  Saving model state dict ...
Epoch: 8 cost time: 0.7956562042236328
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3428864 Best vali loss: 0.3428864

best validation loss 0.3428863707132096

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020571620121, 'e_layers': 3, 'learning_rate': 0.0027296385159, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5070059
	speed: 0.0103s/iter; left time: 41.2143s
	iters: 200, epoch: 1 | loss: 0.7420999
	speed: 0.0042s/iter; left time: 16.3488s
	iters: 300, epoch: 1 | loss: 0.8581791
	speed: 0.0040s/iter; left time: 15.0917s
	iters: 400, epoch: 1 | loss: 0.7068198
	speed: 0.0045s/iter; left time: 16.6966s
	iters: 500, epoch: 1 | loss: 0.7446109
	speed: 0.0044s/iter; left time: 15.9493s
Updating learning rate to 0.0026257478359472475
Validation loss decreased (inf --> 0.4058).  Saving model state dict ...
Epoch: 1 cost time: 2.5401432514190674
Epoch: 1, Steps: 514 | Train Loss: 0.7117431 Vali Loss: 0.4057537 Best vali loss: 0.4057537
	iters: 100, epoch: 2 | loss: 0.4019461
	speed: 0.0087s/iter; left time: 30.5967s
	iters: 200, epoch: 2 | loss: 0.5661389
	speed: 0.0043s/iter; left time: 14.6252s
	iters: 300, epoch: 2 | loss: 0.6661882
	speed: 0.0043s/iter; left time: 14.0675s
	iters: 400, epoch: 2 | loss: 0.4254164
	speed: 0.0044s/iter; left time: 14.1055s
	iters: 500, epoch: 2 | loss: 0.8720666
	speed: 0.0044s/iter; left time: 13.4971s
Updating learning rate to 0.002329892210340437
Validation loss decreased (0.4058 --> 0.4014).  Saving model state dict ...
Epoch: 2 cost time: 2.246154308319092
Epoch: 2, Steps: 514 | Train Loss: 0.5863512 Vali Loss: 0.4013575 Best vali loss: 0.4013575
	iters: 100, epoch: 3 | loss: 0.7443622
	speed: 0.0089s/iter; left time: 26.4503s
	iters: 200, epoch: 3 | loss: 0.5520163
	speed: 0.0039s/iter; left time: 11.3713s
	iters: 300, epoch: 3 | loss: 0.7368507
	speed: 0.0038s/iter; left time: 10.5823s
	iters: 400, epoch: 3 | loss: 0.7088343
	speed: 0.0038s/iter; left time: 10.1686s
	iters: 500, epoch: 3 | loss: 0.9314595
	speed: 0.0038s/iter; left time: 9.7553s
Updating learning rate to 0.001887112976140281
Epoch: 3 cost time: 2.076658010482788
Epoch: 3, Steps: 514 | Train Loss: 0.7347046 Vali Loss: 0.4043042 Best vali loss: 0.4013575
	iters: 100, epoch: 4 | loss: 0.4611224
	speed: 0.0081s/iter; left time: 19.9578s
	iters: 200, epoch: 4 | loss: 0.2293961
	speed: 0.0040s/iter; left time: 9.4394s
	iters: 300, epoch: 4 | loss: 1.1227789
	speed: 0.0044s/iter; left time: 10.0695s
	iters: 400, epoch: 4 | loss: 0.7596222
	speed: 0.0043s/iter; left time: 9.3714s
	iters: 500, epoch: 4 | loss: 0.7125411
	speed: 0.0044s/iter; left time: 9.1820s
Updating learning rate to 0.00136481925795
Epoch: 4 cost time: 2.213630437850952
Epoch: 4, Steps: 514 | Train Loss: 0.6570921 Vali Loss: 0.4028752 Best vali loss: 0.4013575
	iters: 100, epoch: 5 | loss: 0.7721370
	speed: 0.0084s/iter; left time: 16.3983s
	iters: 200, epoch: 5 | loss: 0.3725012
	speed: 0.0043s/iter; left time: 7.8959s
	iters: 300, epoch: 5 | loss: 0.5217499
	speed: 0.0039s/iter; left time: 6.9027s
	iters: 400, epoch: 5 | loss: 0.7414614
	speed: 0.0040s/iter; left time: 6.5541s
	iters: 500, epoch: 5 | loss: 0.5250658
	speed: 0.0039s/iter; left time: 6.0532s
Updating learning rate to 0.0008425255397597192
Epoch: 5 cost time: 2.114870071411133
Epoch: 5, Steps: 514 | Train Loss: 0.5865831 Vali Loss: 0.4150393 Best vali loss: 0.4013575
	iters: 100, epoch: 6 | loss: 1.0579734
	speed: 0.0085s/iter; left time: 12.2866s
	iters: 200, epoch: 6 | loss: 0.5621030
	speed: 0.0039s/iter; left time: 5.1712s
	iters: 300, epoch: 6 | loss: 0.4871377
	speed: 0.0039s/iter; left time: 4.8717s
	iters: 400, epoch: 6 | loss: 0.6043449
	speed: 0.0039s/iter; left time: 4.4576s
	iters: 500, epoch: 6 | loss: 0.6337503
	speed: 0.0040s/iter; left time: 4.1872s
Updating learning rate to 0.0003997463055595633
Epoch: 6 cost time: 2.0938100814819336
Epoch: 6, Steps: 514 | Train Loss: 0.6690618 Vali Loss: 0.4038924 Best vali loss: 0.4013575
	iters: 100, epoch: 7 | loss: 0.8499763
	speed: 0.0083s/iter; left time: 7.7123s
	iters: 200, epoch: 7 | loss: 0.7021990
	speed: 0.0040s/iter; left time: 3.3127s
	iters: 300, epoch: 7 | loss: 1.3606538
	speed: 0.0041s/iter; left time: 3.0091s
	iters: 400, epoch: 7 | loss: 0.7343667
	speed: 0.0040s/iter; left time: 2.5345s
	iters: 500, epoch: 7 | loss: 0.4137434
	speed: 0.0040s/iter; left time: 2.1241s
Updating learning rate to 0.00010389067995275274
Epoch: 7 cost time: 2.116008758544922
Epoch: 7, Steps: 514 | Train Loss: 0.8121878 Vali Loss: 0.4040079 Best vali loss: 0.4013575
	iters: 100, epoch: 8 | loss: 0.4589511
	speed: 0.0087s/iter; left time: 3.6182s
	iters: 200, epoch: 8 | loss: 0.8828551
	speed: 0.0043s/iter; left time: 1.3690s
	iters: 300, epoch: 8 | loss: 0.5304323
	speed: 0.0042s/iter; left time: 0.9029s
	iters: 400, epoch: 8 | loss: 0.9178128
	speed: 0.0040s/iter; left time: 0.4552s
	iters: 500, epoch: 8 | loss: 0.6977154
	speed: 0.0039s/iter; left time: 0.0578s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1690287590026855
Epoch: 8, Steps: 514 | Train Loss: 0.6975533 Vali Loss: 0.4038753 Best vali loss: 0.4013575

best validation loss 0.40135749058545456

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.003365471457, 'e_layers': 3, 'learning_rate': 0.000395224614, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4325393
	speed: 0.0112s/iter; left time: 22.0030s
	iters: 200, epoch: 1 | loss: 0.6505489
	speed: 0.0050s/iter; left time: 9.2146s
Updating learning rate to 0.000395224614
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 1.6349010467529297
Epoch: 1, Steps: 257 | Train Loss: 0.5415441 Vali Loss: 0.3732001 Best vali loss: 0.3732001
	iters: 100, epoch: 2 | loss: 0.3828362
	speed: 0.0106s/iter; left time: 18.0830s
	iters: 200, epoch: 2 | loss: 0.6600611
	speed: 0.0048s/iter; left time: 7.6339s
Updating learning rate to 0.000197612307
Epoch: 2 cost time: 1.2662208080291748
Epoch: 2, Steps: 257 | Train Loss: 0.5214486 Vali Loss: 0.3826709 Best vali loss: 0.3732001
	iters: 100, epoch: 3 | loss: 0.5941270
	speed: 0.0102s/iter; left time: 14.7222s
	iters: 200, epoch: 3 | loss: 0.4055078
	speed: 0.0048s/iter; left time: 6.3797s
Updating learning rate to 9.88061535e-05
Epoch: 3 cost time: 1.2599401473999023
Epoch: 3, Steps: 257 | Train Loss: 0.4998174 Vali Loss: 0.3734667 Best vali loss: 0.3732001
	iters: 100, epoch: 4 | loss: 0.7395322
	speed: 0.0104s/iter; left time: 12.3192s
	iters: 200, epoch: 4 | loss: 0.4289887
	speed: 0.0048s/iter; left time: 5.1786s
Updating learning rate to 4.940307675e-05
Validation loss decreased (0.3732 --> 0.3443).  Saving model state dict ...
Epoch: 4 cost time: 1.2768490314483643
Epoch: 4, Steps: 257 | Train Loss: 0.5842604 Vali Loss: 0.3443426 Best vali loss: 0.3443426
	iters: 100, epoch: 5 | loss: 0.5288957
	speed: 0.0109s/iter; left time: 10.0922s
	iters: 200, epoch: 5 | loss: 0.5552874
	speed: 0.0049s/iter; left time: 4.0623s
Updating learning rate to 2.4701538375e-05
Epoch: 5 cost time: 1.29439115524292
Epoch: 5, Steps: 257 | Train Loss: 0.5420915 Vali Loss: 0.3477920 Best vali loss: 0.3443426
	iters: 100, epoch: 6 | loss: 0.8669075
	speed: 0.0105s/iter; left time: 7.0494s
	iters: 200, epoch: 6 | loss: 0.4418893
	speed: 0.0047s/iter; left time: 2.7049s
Updating learning rate to 1.23507691875e-05
Epoch: 6 cost time: 1.2677280902862549
Epoch: 6, Steps: 257 | Train Loss: 0.6543984 Vali Loss: 0.3464387 Best vali loss: 0.3443426
	iters: 100, epoch: 7 | loss: 0.3763889
	speed: 0.0106s/iter; left time: 4.4002s
	iters: 200, epoch: 7 | loss: 0.2341907
	speed: 0.0050s/iter; left time: 1.5651s
Updating learning rate to 6.17538459375e-06
Epoch: 7 cost time: 1.3205156326293945
Epoch: 7, Steps: 257 | Train Loss: 0.3052898 Vali Loss: 0.3496029 Best vali loss: 0.3443426
	iters: 100, epoch: 8 | loss: 0.3490553
	speed: 0.0105s/iter; left time: 1.6575s
	iters: 200, epoch: 8 | loss: 0.6578041
	speed: 0.0048s/iter; left time: 0.2768s
Updating learning rate to 3.087692296875e-06
Epoch: 8 cost time: 1.283217430114746
Epoch: 8, Steps: 257 | Train Loss: 0.5034297 Vali Loss: 0.3470206 Best vali loss: 0.3443426

best validation loss 0.34434260806775047

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010642555164, 'e_layers': 3, 'learning_rate': 0.0003652353369, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7923605
	speed: 0.0108s/iter; left time: 21.2072s
	iters: 200, epoch: 1 | loss: 0.5291340
	speed: 0.0047s/iter; left time: 8.7394s
Updating learning rate to 0.0003652353369
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 1.5489320755004883
Epoch: 1, Steps: 257 | Train Loss: 0.6607473 Vali Loss: 0.3677100 Best vali loss: 0.3677100
	iters: 100, epoch: 2 | loss: 0.5867668
	speed: 0.0100s/iter; left time: 16.9914s
	iters: 200, epoch: 2 | loss: 0.7529925
	speed: 0.0047s/iter; left time: 7.5673s
Updating learning rate to 0.00018261766845
Epoch: 2 cost time: 1.232229232788086
Epoch: 2, Steps: 257 | Train Loss: 0.6698796 Vali Loss: 0.3688007 Best vali loss: 0.3677100
	iters: 100, epoch: 3 | loss: 0.7450829
	speed: 0.0096s/iter; left time: 13.9159s
	iters: 200, epoch: 3 | loss: 0.5374910
	speed: 0.0047s/iter; left time: 6.2954s
Updating learning rate to 9.1308834225e-05
Validation loss decreased (0.3677 --> 0.3510).  Saving model state dict ...
Epoch: 3 cost time: 1.2340588569641113
Epoch: 3, Steps: 257 | Train Loss: 0.6412870 Vali Loss: 0.3509697 Best vali loss: 0.3509697

best validation loss 0.3509697015369805

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0063869349, 'e_layers': 3, 'learning_rate': 0.0003981402476, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6814768
	speed: 0.0106s/iter; left time: 42.5961s
	iters: 200, epoch: 1 | loss: 0.9821615
	speed: 0.0044s/iter; left time: 17.0605s
	iters: 300, epoch: 1 | loss: 0.8158453
	speed: 0.0045s/iter; left time: 17.0330s
	iters: 400, epoch: 1 | loss: 0.8474796
	speed: 0.0046s/iter; left time: 16.9906s
	iters: 500, epoch: 1 | loss: 1.0824199
	speed: 0.0045s/iter; left time: 16.1284s
Updating learning rate to 0.0003981402476
Validation loss decreased (inf --> 0.3741).  Saving model state dict ...
Epoch: 1 cost time: 2.64068603515625
Epoch: 1, Steps: 514 | Train Loss: 0.8818766 Vali Loss: 0.3740852 Best vali loss: 0.3740852
	iters: 100, epoch: 2 | loss: 1.7162384
	speed: 0.0084s/iter; left time: 29.3619s
	iters: 200, epoch: 2 | loss: 0.4166149
	speed: 0.0038s/iter; left time: 13.0468s
	iters: 300, epoch: 2 | loss: 0.9983816
	speed: 0.0039s/iter; left time: 12.9464s
	iters: 400, epoch: 2 | loss: 0.2948681
	speed: 0.0039s/iter; left time: 12.6227s
	iters: 500, epoch: 2 | loss: 0.4659283
	speed: 0.0046s/iter; left time: 14.1326s
Updating learning rate to 0.0001990701238
Epoch: 2 cost time: 2.1228444576263428
Epoch: 2, Steps: 514 | Train Loss: 0.7784063 Vali Loss: 0.3887542 Best vali loss: 0.3740852
	iters: 100, epoch: 3 | loss: 0.6398730
	speed: 0.0090s/iter; left time: 26.8536s
	iters: 200, epoch: 3 | loss: 0.5329118
	speed: 0.0044s/iter; left time: 12.7870s
	iters: 300, epoch: 3 | loss: 0.3812380
	speed: 0.0044s/iter; left time: 12.2517s
	iters: 400, epoch: 3 | loss: 0.4593169
	speed: 0.0046s/iter; left time: 12.2718s
	iters: 500, epoch: 3 | loss: 0.7939435
	speed: 0.0046s/iter; left time: 11.7937s
Updating learning rate to 9.95350619e-05
Validation loss decreased (0.3741 --> 0.3736).  Saving model state dict ...
Epoch: 3 cost time: 2.361180543899536
Epoch: 3, Steps: 514 | Train Loss: 0.5614567 Vali Loss: 0.3735714 Best vali loss: 0.3735714

best validation loss 0.37357139100260256

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002076789054, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 0.7596132755279541
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669368 Best vali loss: 0.3669368
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.45957207679748535
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3699845 Best vali loss: 0.3669368
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.45372796058654785
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3760925 Best vali loss: 0.3669368

best validation loss 0.3669367871607685

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0010642555164, 'e_layers': 3, 'learning_rate': 0.0003652353369, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5835410
	speed: 0.0110s/iter; left time: 13.0731s
	iters: 200, epoch: 4 | loss: 0.4039492
	speed: 0.0047s/iter; left time: 5.0582s
Updating learning rate to 4.56544171125e-05
Epoch: 4 cost time: 1.5484325885772705
Epoch: 4, Steps: 257 | Train Loss: 0.4937451 Vali Loss: 0.3546427 Best vali loss: 0.3509697
	iters: 100, epoch: 5 | loss: 0.4368162
	speed: 0.0096s/iter; left time: 8.9092s
	iters: 200, epoch: 5 | loss: 0.6604623
	speed: 0.0047s/iter; left time: 3.9146s
Updating learning rate to 2.282720855625e-05
Epoch: 5 cost time: 1.2360990047454834
Epoch: 5, Steps: 257 | Train Loss: 0.5486392 Vali Loss: 0.3529740 Best vali loss: 0.3509697
	iters: 100, epoch: 6 | loss: 0.7021124
	speed: 0.0098s/iter; left time: 6.5683s
	iters: 200, epoch: 6 | loss: 0.4760433
	speed: 0.0045s/iter; left time: 2.5542s
Updating learning rate to 1.1413604278125e-05
Validation loss decreased (0.3510 --> 0.3499).  Saving model state dict ...
Epoch: 6 cost time: 1.1951408386230469
Epoch: 6, Steps: 257 | Train Loss: 0.5890778 Vali Loss: 0.3499003 Best vali loss: 0.3499003
	iters: 100, epoch: 7 | loss: 0.5954472
	speed: 0.0097s/iter; left time: 4.0175s
	iters: 200, epoch: 7 | loss: 0.5928596
	speed: 0.0042s/iter; left time: 1.3233s
Updating learning rate to 5.7068021390625e-06
Epoch: 7 cost time: 1.140242099761963
Epoch: 7, Steps: 257 | Train Loss: 0.5941534 Vali Loss: 0.3514491 Best vali loss: 0.3499003
	iters: 100, epoch: 8 | loss: 0.4262381
	speed: 0.0093s/iter; left time: 1.4704s
	iters: 200, epoch: 8 | loss: 0.5753070
	speed: 0.0043s/iter; left time: 0.2486s
Updating learning rate to 2.85340106953125e-06
Epoch: 8 cost time: 1.1560120582580566
Epoch: 8, Steps: 257 | Train Loss: 0.5007725 Vali Loss: 0.3507904 Best vali loss: 0.3499003

best validation loss 0.34990032159509266

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0044962840039, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 1.1297438144683838
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3740423 Best vali loss: 0.3740423
Updating learning rate to 0.00033590954375
Epoch: 2 cost time: 0.8179552555084229
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3870582 Best vali loss: 0.3740423
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3740 --> 0.3547).  Saving model state dict ...
Epoch: 3 cost time: 0.8133969306945801
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3546793 Best vali loss: 0.3546793
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3547 --> 0.3539).  Saving model state dict ...
Epoch: 4 cost time: 0.8180053234100342
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3538525 Best vali loss: 0.3538525
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3539 --> 0.3517).  Saving model state dict ...
Epoch: 5 cost time: 0.8230679035186768
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3516739 Best vali loss: 0.3516739
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.8205380439758301
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3546273 Best vali loss: 0.3516739
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.8223981857299805
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3556317 Best vali loss: 0.3516739
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.8249549865722656
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3572345 Best vali loss: 0.3516739

best validation loss 0.35167385272989105

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0064303469729, 'e_layers': 3, 'learning_rate': 0.0003936942949, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6217118
	speed: 0.0109s/iter; left time: 21.2423s
	iters: 200, epoch: 1 | loss: 0.6481177
	speed: 0.0043s/iter; left time: 7.9952s
Updating learning rate to 0.0003936942949
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 1.4960601329803467
Epoch: 1, Steps: 257 | Train Loss: 0.6349148 Vali Loss: 0.3649195 Best vali loss: 0.3649195
	iters: 100, epoch: 2 | loss: 0.5156514
	speed: 0.0093s/iter; left time: 15.8334s
	iters: 200, epoch: 2 | loss: 0.6633667
	speed: 0.0047s/iter; left time: 7.5726s
Updating learning rate to 0.00019684714745
Validation loss decreased (0.3649 --> 0.3511).  Saving model state dict ...
Epoch: 2 cost time: 1.211155652999878
Epoch: 2, Steps: 257 | Train Loss: 0.5895091 Vali Loss: 0.3511422 Best vali loss: 0.3511422
	iters: 100, epoch: 3 | loss: 0.7028885
	speed: 0.0101s/iter; left time: 14.5477s
	iters: 200, epoch: 3 | loss: 0.5789863
	speed: 0.0048s/iter; left time: 6.3936s
Updating learning rate to 9.8423573725e-05
Epoch: 3 cost time: 1.2623634338378906
Epoch: 3, Steps: 257 | Train Loss: 0.6409374 Vali Loss: 0.3648966 Best vali loss: 0.3511422
	iters: 100, epoch: 4 | loss: 0.5167773
	speed: 0.0097s/iter; left time: 11.4794s
	iters: 200, epoch: 4 | loss: 0.5175157
	speed: 0.0041s/iter; left time: 4.4504s
Updating learning rate to 4.92117868625e-05
Epoch: 4 cost time: 1.1314609050750732
Epoch: 4, Steps: 257 | Train Loss: 0.5171465 Vali Loss: 0.3532314 Best vali loss: 0.3511422
	iters: 100, epoch: 5 | loss: 0.4377917
	speed: 0.0088s/iter; left time: 8.1660s
	iters: 200, epoch: 5 | loss: 0.6782778
	speed: 0.0041s/iter; left time: 3.3894s
Updating learning rate to 2.460589343125e-05
Validation loss decreased (0.3511 --> 0.3511).  Saving model state dict ...
Epoch: 5 cost time: 1.084688663482666
Epoch: 5, Steps: 257 | Train Loss: 0.5580347 Vali Loss: 0.3511334 Best vali loss: 0.3511334
	iters: 100, epoch: 6 | loss: 0.6787294
	speed: 0.0090s/iter; left time: 6.0253s
	iters: 200, epoch: 6 | loss: 0.6912529
	speed: 0.0041s/iter; left time: 2.3455s
Updating learning rate to 1.2302946715625e-05
Validation loss decreased (0.3511 --> 0.3504).  Saving model state dict ...
Epoch: 6 cost time: 1.096315622329712
Epoch: 6, Steps: 257 | Train Loss: 0.6849912 Vali Loss: 0.3503566 Best vali loss: 0.3503566
	iters: 100, epoch: 7 | loss: 0.3834072
	speed: 0.0096s/iter; left time: 4.0042s
	iters: 200, epoch: 7 | loss: 0.5750023
	speed: 0.0046s/iter; left time: 1.4457s
Updating learning rate to 6.1514733578125e-06
Epoch: 7 cost time: 1.2306270599365234
Epoch: 7, Steps: 257 | Train Loss: 0.4792047 Vali Loss: 0.3523679 Best vali loss: 0.3503566
	iters: 100, epoch: 8 | loss: 0.6417085
	speed: 0.0095s/iter; left time: 1.4950s
	iters: 200, epoch: 8 | loss: 0.4914440
	speed: 0.0042s/iter; left time: 0.2463s
Updating learning rate to 3.07573667890625e-06
Epoch: 8 cost time: 1.1500115394592285
Epoch: 8, Steps: 257 | Train Loss: 0.5665763 Vali Loss: 0.3522201 Best vali loss: 0.3503566

best validation loss 0.3503565948346743

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0014155549695, 'e_layers': 2, 'learning_rate': 5.9557712e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.9557712e-05
Validation loss decreased (inf --> 0.4188).  Saving model state dict ...
Epoch: 1 cost time: 0.6667342185974121
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4187559 Best vali loss: 0.4187559
Updating learning rate to 2.9778856e-05
Validation loss decreased (0.4188 --> 0.3992).  Saving model state dict ...
Epoch: 2 cost time: 0.3417954444885254
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3992228 Best vali loss: 0.3992228
Updating learning rate to 1.4889428e-05
Validation loss decreased (0.3992 --> 0.3922).  Saving model state dict ...
Epoch: 3 cost time: 0.33199405670166016
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3922347 Best vali loss: 0.3922347

best validation loss 0.3922347341281726

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0013594266889, 'e_layers': 4, 'learning_rate': 0.0003554419528, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8450259
	speed: 0.0168s/iter; left time: 15.6547s
Updating learning rate to 0.0003554419528
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 1.7201480865478516
Epoch: 1, Steps: 129 | Train Loss: 0.8450259 Vali Loss: 0.3721996 Best vali loss: 0.3721996
	iters: 100, epoch: 2 | loss: 0.4875547
	speed: 0.0168s/iter; left time: 13.5371s
Updating learning rate to 0.0001777209764
Validation loss decreased (0.3722 --> 0.3613).  Saving model state dict ...
Epoch: 2 cost time: 1.4002859592437744
Epoch: 2, Steps: 129 | Train Loss: 0.4875547 Vali Loss: 0.3613008 Best vali loss: 0.3613008
	iters: 100, epoch: 3 | loss: 0.4022422
	speed: 0.0171s/iter; left time: 11.5151s
Updating learning rate to 8.88604882e-05
Validation loss decreased (0.3613 --> 0.3576).  Saving model state dict ...
Epoch: 3 cost time: 1.4064137935638428
Epoch: 3, Steps: 129 | Train Loss: 0.4022422 Vali Loss: 0.3576246 Best vali loss: 0.3576246

best validation loss 0.35762456586412456

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.004401553532, 'e_layers': 2, 'learning_rate': 0.0003293442483, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6562732
	speed: 0.0103s/iter; left time: 20.2243s
	iters: 200, epoch: 1 | loss: 0.9281360
	speed: 0.0040s/iter; left time: 7.5198s
Updating learning rate to 0.0003293442483
Validation loss decreased (inf --> 0.3575).  Saving model state dict ...
Epoch: 1 cost time: 1.3898062705993652
Epoch: 1, Steps: 257 | Train Loss: 0.7922046 Vali Loss: 0.3575276 Best vali loss: 0.3575276
	iters: 100, epoch: 2 | loss: 0.3728391
	speed: 0.0094s/iter; left time: 16.0611s
	iters: 200, epoch: 2 | loss: 0.6693634
	speed: 0.0040s/iter; left time: 6.4506s
Updating learning rate to 0.00016467212415
Validation loss decreased (0.3575 --> 0.3497).  Saving model state dict ...
Epoch: 2 cost time: 1.078622579574585
Epoch: 2, Steps: 257 | Train Loss: 0.5211013 Vali Loss: 0.3497439 Best vali loss: 0.3497439
	iters: 100, epoch: 3 | loss: 0.6563575
	speed: 0.0094s/iter; left time: 13.5567s
	iters: 200, epoch: 3 | loss: 0.5044383
	speed: 0.0041s/iter; left time: 5.5245s
Updating learning rate to 8.2336062075e-05
Validation loss decreased (0.3497 --> 0.3439).  Saving model state dict ...
Epoch: 3 cost time: 1.1007015705108643
Epoch: 3, Steps: 257 | Train Loss: 0.5803979 Vali Loss: 0.3439375 Best vali loss: 0.3439375

best validation loss 0.34393752303947867

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.004401553532, 'e_layers': 2, 'learning_rate': 0.0003293442483, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5209118
	speed: 0.0107s/iter; left time: 12.6703s
	iters: 200, epoch: 4 | loss: 0.5498344
	speed: 0.0041s/iter; left time: 4.4564s
Updating learning rate to 4.11680310375e-05
Epoch: 4 cost time: 1.4113116264343262
Epoch: 4, Steps: 257 | Train Loss: 0.5353731 Vali Loss: 0.3494674 Best vali loss: 0.3439375
	iters: 100, epoch: 5 | loss: 0.3074033
	speed: 0.0093s/iter; left time: 8.6019s
	iters: 200, epoch: 5 | loss: 0.5225181
	speed: 0.0041s/iter; left time: 3.4193s
Updating learning rate to 2.058401551875e-05
Epoch: 5 cost time: 1.1035308837890625
Epoch: 5, Steps: 257 | Train Loss: 0.4149607 Vali Loss: 0.3491986 Best vali loss: 0.3439375
	iters: 100, epoch: 6 | loss: 0.5241858
	speed: 0.0092s/iter; left time: 6.1708s
	iters: 200, epoch: 6 | loss: 0.4088213
	speed: 0.0041s/iter; left time: 2.3696s
Updating learning rate to 1.0292007759375e-05
Epoch: 6 cost time: 1.1094415187835693
Epoch: 6, Steps: 257 | Train Loss: 0.4665036 Vali Loss: 0.3528830 Best vali loss: 0.3439375
	iters: 100, epoch: 7 | loss: 0.2489688
	speed: 0.0093s/iter; left time: 3.8416s
	iters: 200, epoch: 7 | loss: 0.6948338
	speed: 0.0040s/iter; left time: 1.2739s
Updating learning rate to 5.1460038796875e-06
Epoch: 7 cost time: 1.0976808071136475
Epoch: 7, Steps: 257 | Train Loss: 0.4719013 Vali Loss: 0.3544637 Best vali loss: 0.3439375
	iters: 100, epoch: 8 | loss: 0.3363060
	speed: 0.0091s/iter; left time: 1.4412s
	iters: 200, epoch: 8 | loss: 0.4501391
	speed: 0.0041s/iter; left time: 0.2369s
Updating learning rate to 2.57300193984375e-06
Epoch: 8 cost time: 1.0834228992462158
Epoch: 8, Steps: 257 | Train Loss: 0.3932226 Vali Loss: 0.3558767 Best vali loss: 0.3439375

best validation loss 0.34393752303947867

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.002482778422, 'e_layers': 4, 'learning_rate': 0.00039164426, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3329237
	speed: 0.0126s/iter; left time: 24.6550s
	iters: 200, epoch: 1 | loss: 0.8082005
	speed: 0.0064s/iter; left time: 11.8490s
Updating learning rate to 0.00039164426
Validation loss decreased (inf --> 0.3874).  Saving model state dict ...
Epoch: 1 cost time: 1.987809181213379
Epoch: 1, Steps: 257 | Train Loss: 0.5705621 Vali Loss: 0.3873773 Best vali loss: 0.3873773
	iters: 100, epoch: 2 | loss: 0.8613860
	speed: 0.0135s/iter; left time: 23.0001s
	iters: 200, epoch: 2 | loss: 0.9214793
	speed: 0.0064s/iter; left time: 10.3091s
Updating learning rate to 0.00019582213
Validation loss decreased (0.3874 --> 0.3861).  Saving model state dict ...
Epoch: 2 cost time: 1.6968023777008057
Epoch: 2, Steps: 257 | Train Loss: 0.8914326 Vali Loss: 0.3861202 Best vali loss: 0.3861202
	iters: 100, epoch: 3 | loss: 0.5846344
	speed: 0.0138s/iter; left time: 19.8490s
	iters: 200, epoch: 3 | loss: 0.9128771
	speed: 0.0063s/iter; left time: 8.4299s
Updating learning rate to 9.7911065e-05
Validation loss decreased (0.3861 --> 0.3678).  Saving model state dict ...
Epoch: 3 cost time: 1.6702167987823486
Epoch: 3, Steps: 257 | Train Loss: 0.7487557 Vali Loss: 0.3677719 Best vali loss: 0.3677719
	iters: 100, epoch: 4 | loss: 0.5823657
	speed: 0.0136s/iter; left time: 16.1807s
	iters: 200, epoch: 4 | loss: 0.5414222
	speed: 0.0063s/iter; left time: 6.8406s
Updating learning rate to 4.89555325e-05
Epoch: 4 cost time: 1.661393404006958
Epoch: 4, Steps: 257 | Train Loss: 0.5618939 Vali Loss: 0.3770459 Best vali loss: 0.3677719
	iters: 100, epoch: 5 | loss: 0.6028842
	speed: 0.0131s/iter; left time: 12.1296s
	iters: 200, epoch: 5 | loss: 0.7009878
	speed: 0.0062s/iter; left time: 5.1420s
Updating learning rate to 2.447776625e-05
Epoch: 5 cost time: 1.6455085277557373
Epoch: 5, Steps: 257 | Train Loss: 0.6519360 Vali Loss: 0.3714887 Best vali loss: 0.3677719
	iters: 100, epoch: 6 | loss: 0.5399708
	speed: 0.0130s/iter; left time: 8.7253s
	iters: 200, epoch: 6 | loss: 0.3865840
	speed: 0.0063s/iter; left time: 3.6172s
Updating learning rate to 1.2238883125e-05
Epoch: 6 cost time: 1.6566314697265625
Epoch: 6, Steps: 257 | Train Loss: 0.4632774 Vali Loss: 0.3728258 Best vali loss: 0.3677719
	iters: 100, epoch: 7 | loss: 0.3957377
	speed: 0.0131s/iter; left time: 5.4360s
	iters: 200, epoch: 7 | loss: 0.3263092
	speed: 0.0062s/iter; left time: 1.9671s
Updating learning rate to 6.1194415625e-06
Epoch: 7 cost time: 1.6494684219360352
Epoch: 7, Steps: 257 | Train Loss: 0.3610235 Vali Loss: 0.3711149 Best vali loss: 0.3677719
	iters: 100, epoch: 8 | loss: 0.4692119
	speed: 0.0129s/iter; left time: 2.0323s
	iters: 200, epoch: 8 | loss: 0.5851543
	speed: 0.0062s/iter; left time: 0.3615s
Updating learning rate to 3.05972078125e-06
Validation loss decreased (0.3678 --> 0.3670).  Saving model state dict ...
Epoch: 8 cost time: 1.6468181610107422
Epoch: 8, Steps: 257 | Train Loss: 0.5271831 Vali Loss: 0.3669774 Best vali loss: 0.3669774

best validation loss 0.36697736304026457

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008436095614, 'e_layers': 3, 'learning_rate': 0.0014370549788, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8273282
	speed: 0.0104s/iter; left time: 41.6070s
	iters: 200, epoch: 1 | loss: 0.5073191
	speed: 0.0044s/iter; left time: 17.0257s
	iters: 300, epoch: 1 | loss: 0.8493460
	speed: 0.0043s/iter; left time: 16.4429s
	iters: 400, epoch: 1 | loss: 0.2510544
	speed: 0.0045s/iter; left time: 16.6671s
	iters: 500, epoch: 1 | loss: 0.5703356
	speed: 0.0042s/iter; left time: 15.1134s
Updating learning rate to 0.0014370549788
Validation loss decreased (inf --> 0.3910).  Saving model state dict ...
Epoch: 1 cost time: 2.5504117012023926
Epoch: 1, Steps: 514 | Train Loss: 0.6010767 Vali Loss: 0.3909742 Best vali loss: 0.3909742
	iters: 100, epoch: 2 | loss: 0.7342368
	speed: 0.0084s/iter; left time: 29.3750s
	iters: 200, epoch: 2 | loss: 0.4680419
	speed: 0.0039s/iter; left time: 13.3578s
	iters: 300, epoch: 2 | loss: 0.3798858
	speed: 0.0044s/iter; left time: 14.4605s
	iters: 400, epoch: 2 | loss: 0.6065013
	speed: 0.0042s/iter; left time: 13.5599s
	iters: 500, epoch: 2 | loss: 0.5707599
	speed: 0.0042s/iter; left time: 13.1149s
Updating learning rate to 0.0007185274894
Epoch: 2 cost time: 2.1952931880950928
Epoch: 2, Steps: 514 | Train Loss: 0.5518851 Vali Loss: 0.4136334 Best vali loss: 0.3909742
	iters: 100, epoch: 3 | loss: 0.5535313
	speed: 0.0085s/iter; left time: 25.2309s
	iters: 200, epoch: 3 | loss: 0.4639362
	speed: 0.0040s/iter; left time: 11.6455s
	iters: 300, epoch: 3 | loss: 0.6098690
	speed: 0.0040s/iter; left time: 11.2018s
	iters: 400, epoch: 3 | loss: 0.6493201
	speed: 0.0041s/iter; left time: 10.9766s
	iters: 500, epoch: 3 | loss: 0.6409796
	speed: 0.0041s/iter; left time: 10.4945s
Updating learning rate to 0.0003592637447
Epoch: 3 cost time: 2.1222822666168213
Epoch: 3, Steps: 514 | Train Loss: 0.5835273 Vali Loss: 0.3991044 Best vali loss: 0.3909742
	iters: 100, epoch: 4 | loss: 0.8393633
	speed: 0.0087s/iter; left time: 21.5433s
	iters: 200, epoch: 4 | loss: 0.9382817
	speed: 0.0044s/iter; left time: 10.5228s
	iters: 300, epoch: 4 | loss: 0.9094015
	speed: 0.0041s/iter; left time: 9.2673s
	iters: 400, epoch: 4 | loss: 1.1948282
	speed: 0.0042s/iter; left time: 9.0492s
	iters: 500, epoch: 4 | loss: 0.4694472
	speed: 0.0042s/iter; left time: 8.6344s
Updating learning rate to 0.00017963187235
Epoch: 4 cost time: 2.229764699935913
Epoch: 4, Steps: 514 | Train Loss: 0.8702644 Vali Loss: 0.3927598 Best vali loss: 0.3909742
	iters: 100, epoch: 5 | loss: 0.4606429
	speed: 0.0086s/iter; left time: 16.8138s
	iters: 200, epoch: 5 | loss: 1.0853137
	speed: 0.0043s/iter; left time: 7.9387s
	iters: 300, epoch: 5 | loss: 0.4143169
	speed: 0.0042s/iter; left time: 7.4164s
	iters: 400, epoch: 5 | loss: 0.8763131
	speed: 0.0043s/iter; left time: 7.1098s
	iters: 500, epoch: 5 | loss: 0.3099656
	speed: 0.0042s/iter; left time: 6.5399s
Updating learning rate to 8.9815936175e-05
Validation loss decreased (0.3910 --> 0.3855).  Saving model state dict ...
Epoch: 5 cost time: 2.2334070205688477
Epoch: 5, Steps: 514 | Train Loss: 0.6293104 Vali Loss: 0.3854797 Best vali loss: 0.3854797
	iters: 100, epoch: 6 | loss: 0.7577789
	speed: 0.0086s/iter; left time: 12.4072s
	iters: 200, epoch: 6 | loss: 1.1025288
	speed: 0.0044s/iter; left time: 5.9517s
	iters: 300, epoch: 6 | loss: 0.2612404
	speed: 0.0043s/iter; left time: 5.3457s
	iters: 400, epoch: 6 | loss: 0.7711838
	speed: 0.0044s/iter; left time: 5.0339s
	iters: 500, epoch: 6 | loss: 0.6938931
	speed: 0.0044s/iter; left time: 4.5664s
Updating learning rate to 4.49079680875e-05
Validation loss decreased (0.3855 --> 0.3826).  Saving model state dict ...
Epoch: 6 cost time: 2.278658628463745
Epoch: 6, Steps: 514 | Train Loss: 0.7173250 Vali Loss: 0.3826156 Best vali loss: 0.3826156
	iters: 100, epoch: 7 | loss: 0.3475468
	speed: 0.0084s/iter; left time: 7.8425s
	iters: 200, epoch: 7 | loss: 0.5592618
	speed: 0.0040s/iter; left time: 3.2778s
	iters: 300, epoch: 7 | loss: 0.6832739
	speed: 0.0041s/iter; left time: 2.9720s
	iters: 400, epoch: 7 | loss: 0.5269257
	speed: 0.0040s/iter; left time: 2.4952s
	iters: 500, epoch: 7 | loss: 0.4118053
	speed: 0.0038s/iter; left time: 2.0228s
Updating learning rate to 2.245398404375e-05
Epoch: 7 cost time: 2.0832040309906006
Epoch: 7, Steps: 514 | Train Loss: 0.5057627 Vali Loss: 0.3834036 Best vali loss: 0.3826156
	iters: 100, epoch: 8 | loss: 0.9405189
	speed: 0.0082s/iter; left time: 3.4161s
	iters: 200, epoch: 8 | loss: 0.8562742
	speed: 0.0039s/iter; left time: 1.2281s
	iters: 300, epoch: 8 | loss: 0.6878068
	speed: 0.0041s/iter; left time: 0.8821s
	iters: 400, epoch: 8 | loss: 1.0369550
	speed: 0.0040s/iter; left time: 0.4581s
	iters: 500, epoch: 8 | loss: 0.4118142
	speed: 0.0041s/iter; left time: 0.0608s
Updating learning rate to 1.1226992021875e-05
Epoch: 8 cost time: 2.1051440238952637
Epoch: 8, Steps: 514 | Train Loss: 0.7866738 Vali Loss: 0.3845557 Best vali loss: 0.3826156

best validation loss 0.38261556531099533

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0010867939746, 'e_layers': 4, 'learning_rate': 0.0001642416202, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5122719
	speed: 0.0112s/iter; left time: 90.6203s
	iters: 200, epoch: 1 | loss: 0.4772778
	speed: 0.0051s/iter; left time: 40.7303s
	iters: 300, epoch: 1 | loss: 0.4997471
	speed: 0.0051s/iter; left time: 40.3672s
	iters: 400, epoch: 1 | loss: 0.3344626
	speed: 0.0050s/iter; left time: 39.4074s
	iters: 500, epoch: 1 | loss: 0.4759105
	speed: 0.0050s/iter; left time: 38.9420s
	iters: 600, epoch: 1 | loss: 0.3105586
	speed: 0.0050s/iter; left time: 38.4158s
	iters: 700, epoch: 1 | loss: 0.3332183
	speed: 0.0051s/iter; left time: 38.4756s
	iters: 800, epoch: 1 | loss: 0.3438740
	speed: 0.0051s/iter; left time: 37.7069s
	iters: 900, epoch: 1 | loss: 1.4916732
	speed: 0.0051s/iter; left time: 37.2337s
	iters: 1000, epoch: 1 | loss: 1.0581532
	speed: 0.0050s/iter; left time: 36.4457s
Updating learning rate to 0.0001642416202
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 5.560993671417236
Epoch: 1, Steps: 1027 | Train Loss: 0.5837147 Vali Loss: 0.3697333 Best vali loss: 0.3697333
	iters: 100, epoch: 2 | loss: 0.6977555
	speed: 0.0131s/iter; left time: 92.8658s
	iters: 200, epoch: 2 | loss: 1.0168844
	speed: 0.0051s/iter; left time: 35.5998s
	iters: 300, epoch: 2 | loss: 0.3186239
	speed: 0.0050s/iter; left time: 34.5742s
	iters: 400, epoch: 2 | loss: 0.2118138
	speed: 0.0050s/iter; left time: 34.2772s
	iters: 500, epoch: 2 | loss: 1.0370069
	speed: 0.0051s/iter; left time: 33.7948s
	iters: 600, epoch: 2 | loss: 0.3566254
	speed: 0.0050s/iter; left time: 33.2417s
	iters: 700, epoch: 2 | loss: 1.2434244
	speed: 0.0050s/iter; left time: 32.5706s
	iters: 800, epoch: 2 | loss: 0.3525501
	speed: 0.0050s/iter; left time: 32.1377s
	iters: 900, epoch: 2 | loss: 0.3823642
	speed: 0.0050s/iter; left time: 31.6932s
	iters: 1000, epoch: 2 | loss: 0.5940650
	speed: 0.0051s/iter; left time: 31.3451s
Updating learning rate to 8.21208101e-05
Validation loss decreased (0.3697 --> 0.3675).  Saving model state dict ...
Epoch: 2 cost time: 5.221439599990845
Epoch: 2, Steps: 1027 | Train Loss: 0.6211114 Vali Loss: 0.3674526 Best vali loss: 0.3674526
	iters: 100, epoch: 3 | loss: 0.9269509
	speed: 0.0130s/iter; left time: 78.5659s
	iters: 200, epoch: 3 | loss: 0.4772994
	speed: 0.0050s/iter; left time: 29.7942s
	iters: 300, epoch: 3 | loss: 0.4950699
	speed: 0.0050s/iter; left time: 29.3341s
	iters: 400, epoch: 3 | loss: 0.9702415
	speed: 0.0050s/iter; left time: 28.8094s
	iters: 500, epoch: 3 | loss: 1.4262142
	speed: 0.0050s/iter; left time: 28.1389s
	iters: 600, epoch: 3 | loss: 0.2448959
	speed: 0.0050s/iter; left time: 27.8845s
	iters: 700, epoch: 3 | loss: 0.5019946
	speed: 0.0050s/iter; left time: 27.3596s
	iters: 800, epoch: 3 | loss: 0.3387164
	speed: 0.0050s/iter; left time: 26.9455s
	iters: 900, epoch: 3 | loss: 0.8986104
	speed: 0.0050s/iter; left time: 26.2854s
	iters: 1000, epoch: 3 | loss: 0.9255515
	speed: 0.0050s/iter; left time: 25.8762s
Updating learning rate to 4.106040505e-05
Validation loss decreased (0.3675 --> 0.3669).  Saving model state dict ...
Epoch: 3 cost time: 5.173935174942017
Epoch: 3, Steps: 1027 | Train Loss: 0.7205545 Vali Loss: 0.3669418 Best vali loss: 0.3669418

best validation loss 0.36694175147822894

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019860880183, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.0967111587524414
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705753 Best vali loss: 0.3705753
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3706 --> 0.3638).  Saving model state dict ...
Epoch: 2 cost time: 0.775385856628418
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3638446 Best vali loss: 0.3638446
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3638 --> 0.3522).  Saving model state dict ...
Epoch: 3 cost time: 0.7685503959655762
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3522116 Best vali loss: 0.3522116

best validation loss 0.3522115602006144

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019895311325, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.085815191268921
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3707457 Best vali loss: 0.3707457
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3707 --> 0.3574).  Saving model state dict ...
Epoch: 2 cost time: 0.7790811061859131
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3574380 Best vali loss: 0.3574380
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3574 --> 0.3527).  Saving model state dict ...
Epoch: 3 cost time: 0.7827653884887695
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3527030 Best vali loss: 0.3527030

best validation loss 0.3527030126519194

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019860880183, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3522 --> 0.3518).  Saving model state dict ...
Epoch: 4 cost time: 1.089454174041748
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3517798 Best vali loss: 0.3517798
Updating learning rate to 4.419018625625e-05
Validation loss decreased (0.3518 --> 0.3468).  Saving model state dict ...
Epoch: 5 cost time: 0.7793779373168945
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3468094 Best vali loss: 0.3468094
Updating learning rate to 2.2095093128125e-05
Validation loss decreased (0.3468 --> 0.3412).  Saving model state dict ...
Epoch: 6 cost time: 0.781604528427124
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3411904 Best vali loss: 0.3411904
Updating learning rate to 1.10475465640625e-05
Validation loss decreased (0.3412 --> 0.3402).  Saving model state dict ...
Epoch: 7 cost time: 0.7789566516876221
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3401989 Best vali loss: 0.3401989
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.7824172973632812
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3406065 Best vali loss: 0.3401989

best validation loss 0.34019894239242043

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020851248882, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 0.760840892791748
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3671238 Best vali loss: 0.3671238
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.44911623001098633
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3712507 Best vali loss: 0.3671238
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3671 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 0.45017123222351074
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3662223 Best vali loss: 0.3662223
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3662 --> 0.3631).  Saving model state dict ...
Epoch: 4 cost time: 0.44959402084350586
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3630966 Best vali loss: 0.3630966
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3631 --> 0.3622).  Saving model state dict ...
Epoch: 5 cost time: 0.4464271068572998
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3622217 Best vali loss: 0.3622217
Updating learning rate to 2.2094537753125e-05
Validation loss decreased (0.3622 --> 0.3616).  Saving model state dict ...
Epoch: 6 cost time: 0.44687962532043457
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3615796 Best vali loss: 0.3615796
Updating learning rate to 1.10472688765625e-05
Validation loss decreased (0.3616 --> 0.3561).  Saving model state dict ...
Epoch: 7 cost time: 0.45635080337524414
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3561227 Best vali loss: 0.3561227
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.4509718418121338
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3569141 Best vali loss: 0.3561227

best validation loss 0.3561226522290168

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0090064644795, 'e_layers': 3, 'learning_rate': 0.0012380235145, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6965553
	speed: 0.0113s/iter; left time: 22.0341s
	iters: 200, epoch: 1 | loss: 0.3823268
	speed: 0.0051s/iter; left time: 9.5424s
Updating learning rate to 0.0012380235145
Validation loss decreased (inf --> 0.4010).  Saving model state dict ...
Epoch: 1 cost time: 1.6716532707214355
Epoch: 1, Steps: 257 | Train Loss: 0.5394410 Vali Loss: 0.4009849 Best vali loss: 0.4009849
	iters: 100, epoch: 2 | loss: 0.7120064
	speed: 0.0114s/iter; left time: 19.4479s
	iters: 200, epoch: 2 | loss: 0.5417070
	speed: 0.0052s/iter; left time: 8.3602s
Updating learning rate to 0.00061901175725
Epoch: 2 cost time: 1.3926167488098145
Epoch: 2, Steps: 257 | Train Loss: 0.6268567 Vali Loss: 0.4011676 Best vali loss: 0.4009849
	iters: 100, epoch: 3 | loss: 0.6401570
	speed: 0.0112s/iter; left time: 16.1529s
	iters: 200, epoch: 3 | loss: 0.5835404
	speed: 0.0052s/iter; left time: 6.9968s
Updating learning rate to 0.000309505878625
Epoch: 3 cost time: 1.3819708824157715
Epoch: 3, Steps: 257 | Train Loss: 0.6118487 Vali Loss: 0.4024033 Best vali loss: 0.4009849
	iters: 100, epoch: 4 | loss: 0.7435650
	speed: 0.0111s/iter; left time: 13.1838s
	iters: 200, epoch: 4 | loss: 0.7806349
	speed: 0.0052s/iter; left time: 5.6495s
Updating learning rate to 0.0001547529393125
Epoch: 4 cost time: 1.3913865089416504
Epoch: 4, Steps: 257 | Train Loss: 0.7621000 Vali Loss: 0.4030159 Best vali loss: 0.4009849
	iters: 100, epoch: 5 | loss: 0.8341177
	speed: 0.0114s/iter; left time: 10.5606s
	iters: 200, epoch: 5 | loss: 0.7757393
	speed: 0.0053s/iter; left time: 4.3800s
Updating learning rate to 7.737646965625e-05
Epoch: 5 cost time: 1.4060380458831787
Epoch: 5, Steps: 257 | Train Loss: 0.8049285 Vali Loss: 0.4054909 Best vali loss: 0.4009849
	iters: 100, epoch: 6 | loss: 0.6944340
	speed: 0.0111s/iter; left time: 7.4337s
	iters: 200, epoch: 6 | loss: 0.4122314
	speed: 0.0051s/iter; left time: 2.9447s
Updating learning rate to 3.8688234828125e-05
Epoch: 6 cost time: 1.3741555213928223
Epoch: 6, Steps: 257 | Train Loss: 0.5533327 Vali Loss: 0.4036750 Best vali loss: 0.4009849
	iters: 100, epoch: 7 | loss: 0.8619840
	speed: 0.0112s/iter; left time: 4.6560s
	iters: 200, epoch: 7 | loss: 0.5224225
	speed: 0.0053s/iter; left time: 1.6677s
Updating learning rate to 1.93441174140625e-05
Epoch: 7 cost time: 1.3886487483978271
Epoch: 7, Steps: 257 | Train Loss: 0.6922033 Vali Loss: 0.4034579 Best vali loss: 0.4009849
	iters: 100, epoch: 8 | loss: 1.0070322
	speed: 0.0113s/iter; left time: 1.7846s
	iters: 200, epoch: 8 | loss: 0.8839005
	speed: 0.0051s/iter; left time: 0.2959s
Updating learning rate to 9.67205870703125e-06
Epoch: 8 cost time: 1.376969814300537
Epoch: 8, Steps: 257 | Train Loss: 0.9454663 Vali Loss: 0.4032934 Best vali loss: 0.4009849

best validation loss 0.4009848939646438

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001181586992, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4792160
	speed: 0.0157s/iter; left time: 14.6789s
Updating learning rate to 0.00031792410765910556
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 1.6008551120758057
Epoch: 1, Steps: 129 | Train Loss: 0.4792160 Vali Loss: 0.3725181 Best vali loss: 0.3725181
	iters: 100, epoch: 2 | loss: 0.5609546
	speed: 0.0156s/iter; left time: 12.5535s
Updating learning rate to 0.0002821020707981138
Validation loss decreased (0.3725 --> 0.3582).  Saving model state dict ...
Epoch: 2 cost time: 1.2995514869689941
Epoch: 2, Steps: 129 | Train Loss: 0.5609546 Vali Loss: 0.3581921 Best vali loss: 0.3581921
	iters: 100, epoch: 3 | loss: 0.6729255
	speed: 0.0158s/iter; left time: 10.6979s
Updating learning rate to 0.00022849060400153797
Validation loss decreased (0.3582 --> 0.3579).  Saving model state dict ...
Epoch: 3 cost time: 1.2929620742797852
Epoch: 3, Steps: 129 | Train Loss: 0.6729255 Vali Loss: 0.3579041 Best vali loss: 0.3579041

best validation loss 0.3579040542449839

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022931380105, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.7543549537658691
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3662783 Best vali loss: 0.3662783
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.4523499011993408
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3710963 Best vali loss: 0.3662783
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.4414560794830322
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3821895 Best vali loss: 0.3662783

best validation loss 0.3662783065572937

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0012467063893, 'e_layers': 3, 'learning_rate': 0.0003969877945, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3354991
	speed: 0.0102s/iter; left time: 82.4092s
	iters: 200, epoch: 1 | loss: 0.2446940
	speed: 0.0040s/iter; left time: 32.3552s
	iters: 300, epoch: 1 | loss: 0.4723702
	speed: 0.0040s/iter; left time: 31.9614s
	iters: 400, epoch: 1 | loss: 0.4887908
	speed: 0.0040s/iter; left time: 31.1138s
	iters: 500, epoch: 1 | loss: 0.2979299
	speed: 0.0041s/iter; left time: 31.5141s
	iters: 600, epoch: 1 | loss: 0.3042797
	speed: 0.0040s/iter; left time: 30.5420s
	iters: 700, epoch: 1 | loss: 0.5340185
	speed: 0.0040s/iter; left time: 30.0349s
	iters: 800, epoch: 1 | loss: 0.5313056
	speed: 0.0040s/iter; left time: 29.6156s
	iters: 900, epoch: 1 | loss: 0.4824840
	speed: 0.0041s/iter; left time: 29.8203s
	iters: 1000, epoch: 1 | loss: 0.9160756
	speed: 0.0041s/iter; left time: 29.8751s
Updating learning rate to 0.0003969877945
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 4.4984290599823
Epoch: 1, Steps: 1027 | Train Loss: 0.4607447 Vali Loss: 0.3818205 Best vali loss: 0.3818205
	iters: 100, epoch: 2 | loss: 0.3381383
	speed: 0.0112s/iter; left time: 79.3519s
	iters: 200, epoch: 2 | loss: 0.4460865
	speed: 0.0042s/iter; left time: 29.0752s
	iters: 300, epoch: 2 | loss: 0.5204430
	speed: 0.0041s/iter; left time: 28.2834s
	iters: 400, epoch: 2 | loss: 0.3253565
	speed: 0.0041s/iter; left time: 28.1440s
	iters: 500, epoch: 2 | loss: 0.7405144
	speed: 0.0041s/iter; left time: 27.7007s
	iters: 600, epoch: 2 | loss: 0.4354730
	speed: 0.0041s/iter; left time: 27.3476s
	iters: 700, epoch: 2 | loss: 1.1177386
	speed: 0.0041s/iter; left time: 26.5907s
	iters: 800, epoch: 2 | loss: 0.2270688
	speed: 0.0041s/iter; left time: 26.3427s
	iters: 900, epoch: 2 | loss: 0.2711262
	speed: 0.0041s/iter; left time: 25.9653s
	iters: 1000, epoch: 2 | loss: 0.2075684
	speed: 0.0042s/iter; left time: 25.6986s
Updating learning rate to 0.00019849389725
Validation loss decreased (0.3818 --> 0.3743).  Saving model state dict ...
Epoch: 2 cost time: 4.280442953109741
Epoch: 2, Steps: 1027 | Train Loss: 0.4629514 Vali Loss: 0.3743216 Best vali loss: 0.3743216
	iters: 100, epoch: 3 | loss: 0.3910431
	speed: 0.0110s/iter; left time: 66.9552s
	iters: 200, epoch: 3 | loss: 0.3422536
	speed: 0.0042s/iter; left time: 24.7989s
	iters: 300, epoch: 3 | loss: 0.5513074
	speed: 0.0041s/iter; left time: 24.2050s
	iters: 400, epoch: 3 | loss: 0.3265267
	speed: 0.0042s/iter; left time: 24.0696s
	iters: 500, epoch: 3 | loss: 0.2383666
	speed: 0.0042s/iter; left time: 23.5888s
	iters: 600, epoch: 3 | loss: 0.9684513
	speed: 0.0041s/iter; left time: 22.9684s
	iters: 700, epoch: 3 | loss: 0.3742601
	speed: 0.0042s/iter; left time: 22.7355s
	iters: 800, epoch: 3 | loss: 0.9699016
	speed: 0.0041s/iter; left time: 22.2522s
	iters: 900, epoch: 3 | loss: 0.3269386
	speed: 0.0041s/iter; left time: 21.7800s
	iters: 1000, epoch: 3 | loss: 0.4322191
	speed: 0.0041s/iter; left time: 21.3282s
Updating learning rate to 9.9246948625e-05
Epoch: 3 cost time: 4.2907185554504395
Epoch: 3, Steps: 1027 | Train Loss: 0.4921268 Vali Loss: 0.3916719 Best vali loss: 0.3743216

best validation loss 0.37432161824876525

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.001181586992, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3742666
	speed: 0.0164s/iter; left time: 8.9588s
Updating learning rate to 0.0001652515671
Validation loss decreased (0.3579 --> 0.3476).  Saving model state dict ...
Epoch: 4 cost time: 1.5996685028076172
Epoch: 4, Steps: 129 | Train Loss: 0.3742666 Vali Loss: 0.3475952 Best vali loss: 0.3475952
	iters: 100, epoch: 5 | loss: 0.4821672
	speed: 0.0159s/iter; left time: 6.6097s
Updating learning rate to 0.00010201253019846206
Epoch: 5 cost time: 1.289069652557373
Epoch: 5, Steps: 129 | Train Loss: 0.4821672 Vali Loss: 0.3545234 Best vali loss: 0.3475952
	iters: 100, epoch: 6 | loss: 0.5047312
	speed: 0.0151s/iter; left time: 4.3433s
Updating learning rate to 4.840106340188624e-05
Epoch: 6 cost time: 1.2868828773498535
Epoch: 6, Steps: 129 | Train Loss: 0.5047312 Vali Loss: 0.3589381 Best vali loss: 0.3475952
	iters: 100, epoch: 7 | loss: 0.5440763
	speed: 0.0151s/iter; left time: 2.4055s
Updating learning rate to 1.2579026540894468e-05
Epoch: 7 cost time: 1.290534496307373
Epoch: 7, Steps: 129 | Train Loss: 0.5440763 Vali Loss: 0.3606660 Best vali loss: 0.3475952
	iters: 100, epoch: 8 | loss: 0.4061359
	speed: 0.0151s/iter; left time: 0.4530s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2972700595855713
Epoch: 8, Steps: 129 | Train Loss: 0.4061359 Vali Loss: 0.3664928 Best vali loss: 0.3475952

best validation loss 0.34759517772258613

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0025360669055, 'e_layers': 2, 'learning_rate': 0.0029497422945, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8407713
	speed: 0.0094s/iter; left time: 76.2830s
	iters: 200, epoch: 1 | loss: 0.2479388
	speed: 0.0031s/iter; left time: 24.8977s
	iters: 300, epoch: 1 | loss: 0.6165830
	speed: 0.0033s/iter; left time: 25.9922s
	iters: 400, epoch: 1 | loss: 0.6025940
	speed: 0.0034s/iter; left time: 26.3172s
	iters: 500, epoch: 1 | loss: 0.6725308
	speed: 0.0031s/iter; left time: 24.0121s
	iters: 600, epoch: 1 | loss: 0.7756440
	speed: 0.0033s/iter; left time: 25.4207s
	iters: 700, epoch: 1 | loss: 0.3142231
	speed: 0.0033s/iter; left time: 25.1737s
	iters: 800, epoch: 1 | loss: 0.6255486
	speed: 0.0033s/iter; left time: 24.8030s
	iters: 900, epoch: 1 | loss: 0.9369918
	speed: 0.0032s/iter; left time: 23.2197s
	iters: 1000, epoch: 1 | loss: 1.1615243
	speed: 0.0033s/iter; left time: 23.5310s
Updating learning rate to 0.002837474413285715
Validation loss decreased (inf --> 0.4072).  Saving model state dict ...
Epoch: 1 cost time: 3.6870365142822266
Epoch: 1, Steps: 1027 | Train Loss: 0.6794350 Vali Loss: 0.4071573 Best vali loss: 0.4071573
	iters: 100, epoch: 2 | loss: 0.9862023
	speed: 0.0094s/iter; left time: 66.9952s
	iters: 200, epoch: 2 | loss: 0.3090377
	speed: 0.0031s/iter; left time: 21.7133s
	iters: 300, epoch: 2 | loss: 0.3034192
	speed: 0.0031s/iter; left time: 21.3860s
	iters: 400, epoch: 2 | loss: 1.6893885
	speed: 0.0031s/iter; left time: 20.9179s
	iters: 500, epoch: 2 | loss: 1.1492656
	speed: 0.0032s/iter; left time: 21.0966s
	iters: 600, epoch: 2 | loss: 0.4976662
	speed: 0.0034s/iter; left time: 22.3136s
	iters: 700, epoch: 2 | loss: 1.1276245
	speed: 0.0034s/iter; left time: 22.1020s
	iters: 800, epoch: 2 | loss: 0.1825222
	speed: 0.0034s/iter; left time: 21.6176s
	iters: 900, epoch: 2 | loss: 1.2398130
	speed: 0.0031s/iter; left time: 19.4912s
	iters: 1000, epoch: 2 | loss: 0.6214157
	speed: 0.0031s/iter; left time: 19.3176s
Updating learning rate to 0.002517762536846858
Validation loss decreased (0.4072 --> 0.4061).  Saving model state dict ...
Epoch: 2 cost time: 3.326765298843384
Epoch: 2, Steps: 1027 | Train Loss: 0.8106355 Vali Loss: 0.4060621 Best vali loss: 0.4060621
	iters: 100, epoch: 3 | loss: 1.1442719
	speed: 0.0095s/iter; left time: 57.4785s
	iters: 200, epoch: 3 | loss: 0.2960224
	speed: 0.0031s/iter; left time: 18.5167s
	iters: 300, epoch: 3 | loss: 0.3577375
	speed: 0.0031s/iter; left time: 18.2631s
	iters: 400, epoch: 3 | loss: 0.5811379
	speed: 0.0031s/iter; left time: 17.8417s
	iters: 500, epoch: 3 | loss: 0.3287777
	speed: 0.0031s/iter; left time: 17.6087s
	iters: 600, epoch: 3 | loss: 1.4863899
	speed: 0.0031s/iter; left time: 17.3395s
	iters: 700, epoch: 3 | loss: 0.4883388
	speed: 0.0031s/iter; left time: 17.1808s
	iters: 800, epoch: 3 | loss: 1.3905679
	speed: 0.0031s/iter; left time: 16.3892s
	iters: 900, epoch: 3 | loss: 0.3874552
	speed: 0.0030s/iter; left time: 15.7271s
	iters: 1000, epoch: 3 | loss: 0.9732670
	speed: 0.0030s/iter; left time: 15.4515s
Updating learning rate to 0.0020392799001758676
Validation loss decreased (0.4061 --> 0.4029).  Saving model state dict ...
Epoch: 3 cost time: 3.2043025493621826
Epoch: 3, Steps: 1027 | Train Loss: 0.7433966 Vali Loss: 0.4029416 Best vali loss: 0.4029416
	iters: 100, epoch: 4 | loss: 0.8987808
	speed: 0.0092s/iter; left time: 46.2785s
	iters: 200, epoch: 4 | loss: 1.2331769
	speed: 0.0031s/iter; left time: 15.3774s
	iters: 300, epoch: 4 | loss: 0.2428169
	speed: 0.0030s/iter; left time: 14.5001s
	iters: 400, epoch: 4 | loss: 0.9032666
	speed: 0.0030s/iter; left time: 14.2546s
	iters: 500, epoch: 4 | loss: 0.4118493
	speed: 0.0030s/iter; left time: 13.9992s
	iters: 600, epoch: 4 | loss: 0.4563041
	speed: 0.0030s/iter; left time: 13.6077s
	iters: 700, epoch: 4 | loss: 0.2284982
	speed: 0.0030s/iter; left time: 13.3096s
	iters: 800, epoch: 4 | loss: 0.7618504
	speed: 0.0031s/iter; left time: 13.4378s
	iters: 900, epoch: 4 | loss: 0.5949391
	speed: 0.0032s/iter; left time: 13.3866s
	iters: 1000, epoch: 4 | loss: 0.4477718
	speed: 0.0032s/iter; left time: 13.0841s
Updating learning rate to 0.00147487114725
Epoch: 4 cost time: 3.1837711334228516
Epoch: 4, Steps: 1027 | Train Loss: 0.6179254 Vali Loss: 0.4043289 Best vali loss: 0.4029416
	iters: 100, epoch: 5 | loss: 0.9920590
	speed: 0.0092s/iter; left time: 36.8236s
	iters: 200, epoch: 5 | loss: 0.2583960
	speed: 0.0030s/iter; left time: 11.5710s
	iters: 300, epoch: 5 | loss: 0.8259310
	speed: 0.0029s/iter; left time: 11.0618s
	iters: 400, epoch: 5 | loss: 0.5318323
	speed: 0.0029s/iter; left time: 10.6480s
	iters: 500, epoch: 5 | loss: 1.0923898
	speed: 0.0029s/iter; left time: 10.3552s
	iters: 600, epoch: 5 | loss: 0.6085144
	speed: 0.0029s/iter; left time: 10.0584s
	iters: 700, epoch: 5 | loss: 0.7226468
	speed: 0.0029s/iter; left time: 9.7787s
	iters: 800, epoch: 5 | loss: 0.2491976
	speed: 0.0029s/iter; left time: 9.4697s
	iters: 900, epoch: 5 | loss: 0.2918063
	speed: 0.0029s/iter; left time: 9.1929s
	iters: 1000, epoch: 5 | loss: 0.4427829
	speed: 0.0029s/iter; left time: 8.9341s
Updating learning rate to 0.0009104623943241323
Validation loss decreased (0.4029 --> 0.4023).  Saving model state dict ...
Epoch: 5 cost time: 3.003554105758667
Epoch: 5, Steps: 1027 | Train Loss: 0.6015556 Vali Loss: 0.4022574 Best vali loss: 0.4022574
	iters: 100, epoch: 6 | loss: 1.0938169
	speed: 0.0095s/iter; left time: 28.3758s
	iters: 200, epoch: 6 | loss: 1.2410744
	speed: 0.0031s/iter; left time: 8.9019s
	iters: 300, epoch: 6 | loss: 0.3373166
	speed: 0.0030s/iter; left time: 8.2840s
	iters: 400, epoch: 6 | loss: 0.4143589
	speed: 0.0030s/iter; left time: 8.1377s
	iters: 500, epoch: 6 | loss: 0.2774412
	speed: 0.0033s/iter; left time: 8.5996s
	iters: 600, epoch: 6 | loss: 0.4285108
	speed: 0.0034s/iter; left time: 8.4923s
	iters: 700, epoch: 6 | loss: 0.3691191
	speed: 0.0034s/iter; left time: 8.0401s
	iters: 800, epoch: 6 | loss: 0.8600258
	speed: 0.0034s/iter; left time: 7.7302s
	iters: 900, epoch: 6 | loss: 0.3195128
	speed: 0.0034s/iter; left time: 7.4546s
	iters: 1000, epoch: 6 | loss: 0.7788715
	speed: 0.0034s/iter; left time: 7.1639s
Updating learning rate to 0.000431979757653142
Epoch: 6 cost time: 3.392841100692749
Epoch: 6, Steps: 1027 | Train Loss: 0.6120048 Vali Loss: 0.4035763 Best vali loss: 0.4022574
	iters: 100, epoch: 7 | loss: 1.0522118
	speed: 0.0097s/iter; left time: 18.8682s
	iters: 200, epoch: 7 | loss: 1.2001514
	speed: 0.0034s/iter; left time: 6.2779s
	iters: 300, epoch: 7 | loss: 0.2859629
	speed: 0.0034s/iter; left time: 5.9415s
	iters: 400, epoch: 7 | loss: 0.2215373
	speed: 0.0034s/iter; left time: 5.6024s
	iters: 500, epoch: 7 | loss: 0.7277455
	speed: 0.0034s/iter; left time: 5.2254s
	iters: 600, epoch: 7 | loss: 0.7825916
	speed: 0.0034s/iter; left time: 4.9191s
	iters: 700, epoch: 7 | loss: 0.3290555
	speed: 0.0034s/iter; left time: 4.6074s
	iters: 800, epoch: 7 | loss: 0.8622875
	speed: 0.0034s/iter; left time: 4.2594s
	iters: 900, epoch: 7 | loss: 0.4574038
	speed: 0.0034s/iter; left time: 3.9367s
	iters: 1000, epoch: 7 | loss: 0.4005994
	speed: 0.0034s/iter; left time: 3.5865s
Updating learning rate to 0.00011226788121428485
Epoch: 7 cost time: 3.5125930309295654
Epoch: 7, Steps: 1027 | Train Loss: 0.6319547 Vali Loss: 0.4061690 Best vali loss: 0.4022574
	iters: 100, epoch: 8 | loss: 0.3468178
	speed: 0.0094s/iter; left time: 8.7413s
	iters: 200, epoch: 8 | loss: 0.5508453
	speed: 0.0031s/iter; left time: 2.5499s
	iters: 300, epoch: 8 | loss: 0.4638995
	speed: 0.0031s/iter; left time: 2.2259s
	iters: 400, epoch: 8 | loss: 1.1326176
	speed: 0.0030s/iter; left time: 1.8986s
	iters: 500, epoch: 8 | loss: 0.7058750
	speed: 0.0032s/iter; left time: 1.6758s
	iters: 600, epoch: 8 | loss: 0.6149321
	speed: 0.0031s/iter; left time: 1.3424s
	iters: 700, epoch: 8 | loss: 0.2391941
	speed: 0.0032s/iter; left time: 1.0389s
	iters: 800, epoch: 8 | loss: 0.4728990
	speed: 0.0032s/iter; left time: 0.7211s
	iters: 900, epoch: 8 | loss: 0.5601498
	speed: 0.0032s/iter; left time: 0.4054s
	iters: 1000, epoch: 8 | loss: 0.7629213
	speed: 0.0032s/iter; left time: 0.0882s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2498936653137207
Epoch: 8, Steps: 1027 | Train Loss: 0.5850152 Vali Loss: 0.4031901 Best vali loss: 0.4022574

best validation loss 0.4022573719324438

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4264117
	speed: 0.0100s/iter; left time: 39.9528s
	iters: 200, epoch: 1 | loss: 1.0776739
	speed: 0.0034s/iter; left time: 13.4647s
	iters: 300, epoch: 1 | loss: 1.0150454
	speed: 0.0035s/iter; left time: 13.3786s
	iters: 400, epoch: 1 | loss: 0.5034420
	speed: 0.0035s/iter; left time: 12.8896s
	iters: 500, epoch: 1 | loss: 1.1468829
	speed: 0.0033s/iter; left time: 12.0921s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 2.14316987991333
Epoch: 1, Steps: 514 | Train Loss: 0.8338912 Vali Loss: 0.3735476 Best vali loss: 0.3735476
	iters: 100, epoch: 2 | loss: 0.3927171
	speed: 0.0074s/iter; left time: 26.0323s
	iters: 200, epoch: 2 | loss: 0.2642825
	speed: 0.0036s/iter; left time: 12.2093s
	iters: 300, epoch: 2 | loss: 0.4810844
	speed: 0.0036s/iter; left time: 11.8502s
	iters: 400, epoch: 2 | loss: 0.3858527
	speed: 0.0036s/iter; left time: 11.5094s
	iters: 500, epoch: 2 | loss: 0.6255172
	speed: 0.0036s/iter; left time: 11.1825s
Updating learning rate to 0.0001911554003
Validation loss decreased (0.3735 --> 0.3718).  Saving model state dict ...
Epoch: 2 cost time: 1.8862335681915283
Epoch: 2, Steps: 514 | Train Loss: 0.4298908 Vali Loss: 0.3717813 Best vali loss: 0.3717813
	iters: 100, epoch: 3 | loss: 0.3848554
	speed: 0.0075s/iter; left time: 22.2548s
	iters: 200, epoch: 3 | loss: 0.8528842
	speed: 0.0032s/iter; left time: 9.0896s
	iters: 300, epoch: 3 | loss: 0.5079440
	speed: 0.0033s/iter; left time: 9.0563s
	iters: 400, epoch: 3 | loss: 0.4628634
	speed: 0.0031s/iter; left time: 8.4559s
	iters: 500, epoch: 3 | loss: 1.0878614
	speed: 0.0030s/iter; left time: 7.8321s
Updating learning rate to 9.557770015e-05
Validation loss decreased (0.3718 --> 0.3479).  Saving model state dict ...
Epoch: 3 cost time: 1.6704046726226807
Epoch: 3, Steps: 514 | Train Loss: 0.6592817 Vali Loss: 0.3478898 Best vali loss: 0.3478898
	iters: 100, epoch: 4 | loss: 0.5596704
	speed: 0.0069s/iter; left time: 17.1272s
	iters: 200, epoch: 4 | loss: 0.4416791
	speed: 0.0031s/iter; left time: 7.4150s
	iters: 300, epoch: 4 | loss: 0.4878226
	speed: 0.0031s/iter; left time: 7.0864s
	iters: 400, epoch: 4 | loss: 0.6940621
	speed: 0.0032s/iter; left time: 6.9241s
	iters: 500, epoch: 4 | loss: 0.7152492
	speed: 0.0031s/iter; left time: 6.3248s
Updating learning rate to 4.7788850075e-05
Validation loss decreased (0.3479 --> 0.3403).  Saving model state dict ...
Epoch: 4 cost time: 1.653735876083374
Epoch: 4, Steps: 514 | Train Loss: 0.5796967 Vali Loss: 0.3402936 Best vali loss: 0.3402936
	iters: 100, epoch: 5 | loss: 0.5383694
	speed: 0.0073s/iter; left time: 14.2578s
	iters: 200, epoch: 5 | loss: 0.7387058
	speed: 0.0032s/iter; left time: 5.8499s
	iters: 300, epoch: 5 | loss: 0.4550225
	speed: 0.0030s/iter; left time: 5.3584s
	iters: 400, epoch: 5 | loss: 0.8167859
	speed: 0.0032s/iter; left time: 5.2264s
	iters: 500, epoch: 5 | loss: 0.5619948
	speed: 0.0033s/iter; left time: 5.1561s
Updating learning rate to 2.38944250375e-05
Validation loss decreased (0.3403 --> 0.3386).  Saving model state dict ...
Epoch: 5 cost time: 1.6694252490997314
Epoch: 5, Steps: 514 | Train Loss: 0.6221757 Vali Loss: 0.3386406 Best vali loss: 0.3386406
	iters: 100, epoch: 6 | loss: 0.2955243
	speed: 0.0068s/iter; left time: 9.8198s
	iters: 200, epoch: 6 | loss: 0.4700966
	speed: 0.0031s/iter; left time: 4.1067s
	iters: 300, epoch: 6 | loss: 0.3550917
	speed: 0.0030s/iter; left time: 3.6951s
	iters: 400, epoch: 6 | loss: 0.7400521
	speed: 0.0029s/iter; left time: 3.3669s
	iters: 500, epoch: 6 | loss: 0.9599390
	speed: 0.0030s/iter; left time: 3.1317s
Updating learning rate to 1.194721251875e-05
Epoch: 6 cost time: 1.584618330001831
Epoch: 6, Steps: 514 | Train Loss: 0.5641407 Vali Loss: 0.3411276 Best vali loss: 0.3386406
	iters: 100, epoch: 7 | loss: 0.3902740
	speed: 0.0068s/iter; left time: 6.3417s
	iters: 200, epoch: 7 | loss: 0.3010049
	speed: 0.0031s/iter; left time: 2.5729s
	iters: 300, epoch: 7 | loss: 0.3718832
	speed: 0.0031s/iter; left time: 2.2932s
	iters: 400, epoch: 7 | loss: 0.4057821
	speed: 0.0032s/iter; left time: 2.0227s
	iters: 500, epoch: 7 | loss: 0.8032370
	speed: 0.0032s/iter; left time: 1.6673s
Updating learning rate to 5.973606259375e-06
Validation loss decreased (0.3386 --> 0.3385).  Saving model state dict ...
Epoch: 7 cost time: 1.6619644165039062
Epoch: 7, Steps: 514 | Train Loss: 0.4544362 Vali Loss: 0.3385054 Best vali loss: 0.3385054
	iters: 100, epoch: 8 | loss: 0.3590983
	speed: 0.0073s/iter; left time: 3.0091s
	iters: 200, epoch: 8 | loss: 0.2255164
	speed: 0.0033s/iter; left time: 1.0550s
	iters: 300, epoch: 8 | loss: 0.3682625
	speed: 0.0030s/iter; left time: 0.6530s
	iters: 400, epoch: 8 | loss: 0.4342977
	speed: 0.0032s/iter; left time: 0.3635s
	iters: 500, epoch: 8 | loss: 0.2439712
	speed: 0.0030s/iter; left time: 0.0452s
Updating learning rate to 2.9868031296875e-06
Validation loss decreased (0.3385 --> 0.3383).  Saving model state dict ...
Epoch: 8 cost time: 1.654775619506836
Epoch: 8, Steps: 514 | Train Loss: 0.3262292 Vali Loss: 0.3382863 Best vali loss: 0.3382863

best validation loss 0.3382863036307464

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010585924352, 'e_layers': 3, 'learning_rate': 0.0009481825234, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009481825234
Validation loss decreased (inf --> 0.3743).  Saving model state dict ...
Epoch: 1 cost time: 1.0814979076385498
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3743176 Best vali loss: 0.3743176
Updating learning rate to 0.0004740912617
Epoch: 2 cost time: 0.7900159358978271
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3942947 Best vali loss: 0.3743176
Updating learning rate to 0.00023704563085
Epoch: 3 cost time: 0.7946500778198242
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3858208 Best vali loss: 0.3743176

best validation loss 0.3743176367638856

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0076350979946, 'e_layers': 3, 'learning_rate': 0.0004733900454, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4189084
	speed: 0.0108s/iter; left time: 21.1211s
	iters: 200, epoch: 1 | loss: 0.6431063
	speed: 0.0047s/iter; left time: 8.8156s
Updating learning rate to 0.0004733900454
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 1.5579841136932373
Epoch: 1, Steps: 257 | Train Loss: 0.5310074 Vali Loss: 0.3750525 Best vali loss: 0.3750525
	iters: 100, epoch: 2 | loss: 0.4249181
	speed: 0.0105s/iter; left time: 17.8856s
	iters: 200, epoch: 2 | loss: 0.6950909
	speed: 0.0048s/iter; left time: 7.6132s
Updating learning rate to 0.0002366950227
Validation loss decreased (0.3751 --> 0.3749).  Saving model state dict ...
Epoch: 2 cost time: 1.2721521854400635
Epoch: 2, Steps: 257 | Train Loss: 0.5600045 Vali Loss: 0.3749302 Best vali loss: 0.3749302
	iters: 100, epoch: 3 | loss: 0.6021938
	speed: 0.0109s/iter; left time: 15.6860s
	iters: 200, epoch: 3 | loss: 0.4144582
	speed: 0.0048s/iter; left time: 6.4580s
Updating learning rate to 0.00011834751135
Validation loss decreased (0.3749 --> 0.3735).  Saving model state dict ...
Epoch: 3 cost time: 1.281360387802124
Epoch: 3, Steps: 257 | Train Loss: 0.5083260 Vali Loss: 0.3734970 Best vali loss: 0.3734970

best validation loss 0.3734969945108492

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045161828484, 'e_layers': 4, 'learning_rate': 0.0007821102908, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007821102908
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 1.0911121368408203
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3692089 Best vali loss: 0.3692089
Updating learning rate to 0.0003910551454
Validation loss decreased (0.3692 --> 0.3640).  Saving model state dict ...
Epoch: 2 cost time: 0.7795548439025879
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3640006 Best vali loss: 0.3640006
Updating learning rate to 0.0001955275727
Validation loss decreased (0.3640 --> 0.3597).  Saving model state dict ...
Epoch: 3 cost time: 0.7915122509002686
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3596837 Best vali loss: 0.3596837

best validation loss 0.35968366992497025

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045161828484, 'e_layers': 4, 'learning_rate': 0.0007821102908, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 9.776378635e-05
Validation loss decreased (0.3597 --> 0.3551).  Saving model state dict ...
Epoch: 4 cost time: 1.0926434993743896
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3551377 Best vali loss: 0.3551377
Updating learning rate to 4.8881893175e-05
Epoch: 5 cost time: 0.78155517578125
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3570449 Best vali loss: 0.3551377
Updating learning rate to 2.44409465875e-05
Validation loss decreased (0.3551 --> 0.3524).  Saving model state dict ...
Epoch: 6 cost time: 0.7810349464416504
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3524417 Best vali loss: 0.3524417
Updating learning rate to 1.222047329375e-05
Validation loss decreased (0.3524 --> 0.3503).  Saving model state dict ...
Epoch: 7 cost time: 0.7867188453674316
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3503398 Best vali loss: 0.3503398
Updating learning rate to 6.110236646875e-06
Epoch: 8 cost time: 0.7819945812225342
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3527507 Best vali loss: 0.3503398

best validation loss 0.35033979125481923

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0047017692119, 'e_layers': 4, 'learning_rate': 0.0003590185549, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8113392
	speed: 0.0121s/iter; left time: 23.7132s
	iters: 200, epoch: 1 | loss: 0.6019958
	speed: 0.0060s/iter; left time: 11.1080s
Updating learning rate to 0.0003590185549
Validation loss decreased (inf --> 0.3644).  Saving model state dict ...
Epoch: 1 cost time: 1.8927111625671387
Epoch: 1, Steps: 257 | Train Loss: 0.7066675 Vali Loss: 0.3643988 Best vali loss: 0.3643988
	iters: 100, epoch: 2 | loss: 0.7309840
	speed: 0.0126s/iter; left time: 21.3367s
	iters: 200, epoch: 2 | loss: 0.4266647
	speed: 0.0058s/iter; left time: 9.2641s
Updating learning rate to 0.00017950927745
Epoch: 2 cost time: 1.5296988487243652
Epoch: 2, Steps: 257 | Train Loss: 0.5788244 Vali Loss: 0.3727008 Best vali loss: 0.3643988
	iters: 100, epoch: 3 | loss: 0.6183636
	speed: 0.0120s/iter; left time: 17.2608s
	iters: 200, epoch: 3 | loss: 0.6588472
	speed: 0.0057s/iter; left time: 7.6855s
Updating learning rate to 8.9754638725e-05
Validation loss decreased (0.3644 --> 0.3554).  Saving model state dict ...
Epoch: 3 cost time: 1.5101089477539062
Epoch: 3, Steps: 257 | Train Loss: 0.6386054 Vali Loss: 0.3554313 Best vali loss: 0.3554313
	iters: 100, epoch: 4 | loss: 0.4457020
	speed: 0.0125s/iter; left time: 14.8497s
	iters: 200, epoch: 4 | loss: 0.4606351
	speed: 0.0058s/iter; left time: 6.2653s
Updating learning rate to 4.48773193625e-05
Validation loss decreased (0.3554 --> 0.3496).  Saving model state dict ...
Epoch: 4 cost time: 1.513930320739746
Epoch: 4, Steps: 257 | Train Loss: 0.4531685 Vali Loss: 0.3496190 Best vali loss: 0.3496190
	iters: 100, epoch: 5 | loss: 0.5192649
	speed: 0.0127s/iter; left time: 11.7798s
	iters: 200, epoch: 5 | loss: 0.7905947
	speed: 0.0059s/iter; left time: 4.9143s
Updating learning rate to 2.243865968125e-05
Epoch: 5 cost time: 1.5665178298950195
Epoch: 5, Steps: 257 | Train Loss: 0.6549298 Vali Loss: 0.3540901 Best vali loss: 0.3496190
	iters: 100, epoch: 6 | loss: 0.4908951
	speed: 0.0124s/iter; left time: 8.3521s
	iters: 200, epoch: 6 | loss: 0.5534611
	speed: 0.0060s/iter; left time: 3.4074s
Updating learning rate to 1.1219329840625e-05
Epoch: 6 cost time: 1.571873664855957
Epoch: 6, Steps: 257 | Train Loss: 0.5221781 Vali Loss: 0.3551921 Best vali loss: 0.3496190
	iters: 100, epoch: 7 | loss: 0.5463331
	speed: 0.0122s/iter; left time: 5.0708s
	iters: 200, epoch: 7 | loss: 0.7531731
	speed: 0.0059s/iter; left time: 1.8704s
Updating learning rate to 5.6096649203125e-06
Epoch: 7 cost time: 1.5534279346466064
Epoch: 7, Steps: 257 | Train Loss: 0.6497531 Vali Loss: 0.3565818 Best vali loss: 0.3496190
	iters: 100, epoch: 8 | loss: 0.2907538
	speed: 0.0122s/iter; left time: 1.9323s
	iters: 200, epoch: 8 | loss: 0.2941482
	speed: 0.0058s/iter; left time: 0.3385s
Updating learning rate to 2.80483246015625e-06
Epoch: 8 cost time: 1.546076774597168
Epoch: 8, Steps: 257 | Train Loss: 0.2924510 Vali Loss: 0.3583683 Best vali loss: 0.3496190

best validation loss 0.349619033540396

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0051822041726, 'e_layers': 4, 'learning_rate': 0.0003591001493, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8111721
	speed: 0.0120s/iter; left time: 23.4198s
	iters: 200, epoch: 1 | loss: 0.5943922
	speed: 0.0060s/iter; left time: 11.1649s
Updating learning rate to 0.0003591001493
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 1.876589059829712
Epoch: 1, Steps: 257 | Train Loss: 0.7027822 Vali Loss: 0.3681253 Best vali loss: 0.3681253
	iters: 100, epoch: 2 | loss: 0.7748583
	speed: 0.0126s/iter; left time: 21.3954s
	iters: 200, epoch: 2 | loss: 0.4169061
	speed: 0.0059s/iter; left time: 9.4054s
Updating learning rate to 0.00017955007465
Epoch: 2 cost time: 1.557337999343872
Epoch: 2, Steps: 257 | Train Loss: 0.5958822 Vali Loss: 0.3908709 Best vali loss: 0.3681253
	iters: 100, epoch: 3 | loss: 0.6466989
	speed: 0.0123s/iter; left time: 17.7030s
	iters: 200, epoch: 3 | loss: 0.8618738
	speed: 0.0059s/iter; left time: 7.9261s
Updating learning rate to 8.9775037325e-05
Validation loss decreased (0.3681 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 1.5609924793243408
Epoch: 3, Steps: 257 | Train Loss: 0.7542863 Vali Loss: 0.3643700 Best vali loss: 0.3643700
	iters: 100, epoch: 4 | loss: 0.5251845
	speed: 0.0129s/iter; left time: 15.2487s
	iters: 200, epoch: 4 | loss: 0.5448899
	speed: 0.0058s/iter; left time: 6.2836s
Updating learning rate to 4.48875186625e-05
Validation loss decreased (0.3644 --> 0.3573).  Saving model state dict ...
Epoch: 4 cost time: 1.540698528289795
Epoch: 4, Steps: 257 | Train Loss: 0.5350372 Vali Loss: 0.3573485 Best vali loss: 0.3573485
	iters: 100, epoch: 5 | loss: 0.5631120
	speed: 0.0126s/iter; left time: 11.6986s
	iters: 200, epoch: 5 | loss: 0.8774848
	speed: 0.0059s/iter; left time: 4.9004s
Updating learning rate to 2.244375933125e-05
Validation loss decreased (0.3573 --> 0.3554).  Saving model state dict ...
Epoch: 5 cost time: 1.5495359897613525
Epoch: 5, Steps: 257 | Train Loss: 0.7202984 Vali Loss: 0.3554425 Best vali loss: 0.3554425
	iters: 100, epoch: 6 | loss: 0.5307983
	speed: 0.0127s/iter; left time: 8.5440s
	iters: 200, epoch: 6 | loss: 0.5769049
	speed: 0.0058s/iter; left time: 3.3136s
Updating learning rate to 1.1221879665625e-05
Validation loss decreased (0.3554 --> 0.3519).  Saving model state dict ...
Epoch: 6 cost time: 1.531947135925293
Epoch: 6, Steps: 257 | Train Loss: 0.5538516 Vali Loss: 0.3518665 Best vali loss: 0.3518665
	iters: 100, epoch: 7 | loss: 0.5781235
	speed: 0.0126s/iter; left time: 5.2229s
	iters: 200, epoch: 7 | loss: 0.8056380
	speed: 0.0057s/iter; left time: 1.8103s
Updating learning rate to 5.6109398328125e-06
Epoch: 7 cost time: 1.5285568237304688
Epoch: 7, Steps: 257 | Train Loss: 0.6918808 Vali Loss: 0.3529674 Best vali loss: 0.3518665
	iters: 100, epoch: 8 | loss: 0.3172169
	speed: 0.0122s/iter; left time: 1.9333s
	iters: 200, epoch: 8 | loss: 0.3005169
	speed: 0.0059s/iter; left time: 0.3430s
Updating learning rate to 2.80546991640625e-06
Epoch: 8 cost time: 1.5611295700073242
Epoch: 8, Steps: 257 | Train Loss: 0.3088669 Vali Loss: 0.3532865 Best vali loss: 0.3518665

best validation loss 0.351866515258909

[INFO][smbo.py:320] Finished 900 trials.
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0036899747942, 'e_layers': 3, 'learning_rate': 0.0009105249569, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2764395
	speed: 0.0101s/iter; left time: 40.7170s
	iters: 200, epoch: 1 | loss: 0.6244273
	speed: 0.0039s/iter; left time: 15.1367s
	iters: 300, epoch: 1 | loss: 0.7116840
	speed: 0.0039s/iter; left time: 14.8788s
	iters: 400, epoch: 1 | loss: 0.7113414
	speed: 0.0039s/iter; left time: 14.5993s
	iters: 500, epoch: 1 | loss: 1.1626788
	speed: 0.0040s/iter; left time: 14.5269s
Updating learning rate to 0.0009105249569
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 2.3792386054992676
Epoch: 1, Steps: 514 | Train Loss: 0.6973142 Vali Loss: 0.3687447 Best vali loss: 0.3687447
	iters: 100, epoch: 2 | loss: 0.6379066
	speed: 0.0084s/iter; left time: 29.2952s
	iters: 200, epoch: 2 | loss: 0.3992129
	speed: 0.0042s/iter; left time: 14.1297s
	iters: 300, epoch: 2 | loss: 0.5737318
	speed: 0.0042s/iter; left time: 13.7460s
	iters: 400, epoch: 2 | loss: 0.8184049
	speed: 0.0041s/iter; left time: 13.1126s
	iters: 500, epoch: 2 | loss: 0.4664718
	speed: 0.0040s/iter; left time: 12.3110s
Updating learning rate to 0.00045526247845
Epoch: 2 cost time: 2.1305534839630127
Epoch: 2, Steps: 514 | Train Loss: 0.5791456 Vali Loss: 0.3720740 Best vali loss: 0.3687447
	iters: 100, epoch: 3 | loss: 0.6728047
	speed: 0.0082s/iter; left time: 24.5731s
	iters: 200, epoch: 3 | loss: 0.5725121
	speed: 0.0038s/iter; left time: 10.9695s
	iters: 300, epoch: 3 | loss: 0.2792311
	speed: 0.0038s/iter; left time: 10.7096s
	iters: 400, epoch: 3 | loss: 0.5974817
	speed: 0.0038s/iter; left time: 10.2900s
	iters: 500, epoch: 3 | loss: 0.9153850
	speed: 0.0038s/iter; left time: 9.9233s
Updating learning rate to 0.000227631239225
Epoch: 3 cost time: 2.0179760456085205
Epoch: 3, Steps: 514 | Train Loss: 0.6074829 Vali Loss: 0.3731131 Best vali loss: 0.3687447

best validation loss 0.36874466438893017

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 4, 'learning_rate': 0.0003898494422, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4148375
	speed: 0.0115s/iter; left time: 45.9708s
	iters: 200, epoch: 1 | loss: 0.3372716
	speed: 0.0053s/iter; left time: 20.7204s
	iters: 300, epoch: 1 | loss: 0.3696635
	speed: 0.0052s/iter; left time: 19.8803s
	iters: 400, epoch: 1 | loss: 0.3389443
	speed: 0.0053s/iter; left time: 19.5070s
	iters: 500, epoch: 1 | loss: 0.9046887
	speed: 0.0052s/iter; left time: 18.7419s
Updating learning rate to 0.0003898494422
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 3.045989751815796
Epoch: 1, Steps: 514 | Train Loss: 0.4730811 Vali Loss: 0.3756866 Best vali loss: 0.3756866
	iters: 100, epoch: 2 | loss: 1.1332392
	speed: 0.0103s/iter; left time: 36.1397s
	iters: 200, epoch: 2 | loss: 0.9629161
	speed: 0.0050s/iter; left time: 17.1187s
	iters: 300, epoch: 2 | loss: 0.6060367
	speed: 0.0051s/iter; left time: 16.7041s
	iters: 400, epoch: 2 | loss: 0.4056421
	speed: 0.0051s/iter; left time: 16.3202s
	iters: 500, epoch: 2 | loss: 0.4473282
	speed: 0.0050s/iter; left time: 15.6389s
Updating learning rate to 0.0001949247211
Epoch: 2 cost time: 2.6635165214538574
Epoch: 2, Steps: 514 | Train Loss: 0.7110325 Vali Loss: 0.3765595 Best vali loss: 0.3756866
	iters: 100, epoch: 3 | loss: 0.4063449
	speed: 0.0098s/iter; left time: 29.3866s
	iters: 200, epoch: 3 | loss: 0.4903137
	speed: 0.0051s/iter; left time: 14.7021s
	iters: 300, epoch: 3 | loss: 0.7535385
	speed: 0.0050s/iter; left time: 13.8789s
	iters: 400, epoch: 3 | loss: 0.3464365
	speed: 0.0050s/iter; left time: 13.4204s
	iters: 500, epoch: 3 | loss: 0.9667097
	speed: 0.0049s/iter; left time: 12.6626s
Updating learning rate to 9.746236055e-05
Validation loss decreased (0.3757 --> 0.3663).  Saving model state dict ...
Epoch: 3 cost time: 2.625603675842285
Epoch: 3, Steps: 514 | Train Loss: 0.5926687 Vali Loss: 0.3663463 Best vali loss: 0.3663463

best validation loss 0.36634627510381823

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024206626739, 'e_layers': 2, 'learning_rate': 0.0003881106242, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7298124
	speed: 0.0097s/iter; left time: 38.8752s
	iters: 200, epoch: 1 | loss: 0.6217647
	speed: 0.0033s/iter; left time: 13.0189s
	iters: 300, epoch: 1 | loss: 0.4059951
	speed: 0.0033s/iter; left time: 12.7003s
	iters: 400, epoch: 1 | loss: 0.5082883
	speed: 0.0034s/iter; left time: 12.4427s
	iters: 500, epoch: 1 | loss: 1.1183800
	speed: 0.0034s/iter; left time: 12.3892s
Updating learning rate to 0.0003881106242
Validation loss decreased (inf --> 0.3731).  Saving model state dict ...
Epoch: 1 cost time: 2.090559482574463
Epoch: 1, Steps: 514 | Train Loss: 0.6768481 Vali Loss: 0.3731169 Best vali loss: 0.3731169
	iters: 100, epoch: 2 | loss: 0.5076851
	speed: 0.0078s/iter; left time: 27.2751s
	iters: 200, epoch: 2 | loss: 0.3489503
	speed: 0.0034s/iter; left time: 11.4562s
	iters: 300, epoch: 2 | loss: 0.4624789
	speed: 0.0035s/iter; left time: 11.6000s
	iters: 400, epoch: 2 | loss: 0.3660026
	speed: 0.0033s/iter; left time: 10.5898s
	iters: 500, epoch: 2 | loss: 0.9192119
	speed: 0.0033s/iter; left time: 10.1799s
Updating learning rate to 0.0001940553121
Epoch: 2 cost time: 1.7787790298461914
Epoch: 2, Steps: 514 | Train Loss: 0.5208658 Vali Loss: 0.3845550 Best vali loss: 0.3731169
	iters: 100, epoch: 3 | loss: 0.5775321
	speed: 0.0076s/iter; left time: 22.6855s
	iters: 200, epoch: 3 | loss: 0.3174401
	speed: 0.0033s/iter; left time: 9.4629s
	iters: 300, epoch: 3 | loss: 0.4511475
	speed: 0.0032s/iter; left time: 8.9906s
	iters: 400, epoch: 3 | loss: 1.2112501
	speed: 0.0033s/iter; left time: 8.8527s
	iters: 500, epoch: 3 | loss: 0.3772534
	speed: 0.0033s/iter; left time: 8.5509s
Updating learning rate to 9.702765605e-05
Validation loss decreased (0.3731 --> 0.3564).  Saving model state dict ...
Epoch: 3 cost time: 1.7509510517120361
Epoch: 3, Steps: 514 | Train Loss: 0.5869246 Vali Loss: 0.3563506 Best vali loss: 0.3563506

best validation loss 0.35635059533278457

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024206626739, 'e_layers': 2, 'learning_rate': 0.0003881106242, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6175834
	speed: 0.0100s/iter; left time: 24.7840s
	iters: 200, epoch: 4 | loss: 0.5823812
	speed: 0.0036s/iter; left time: 8.4374s
	iters: 300, epoch: 4 | loss: 0.3850422
	speed: 0.0034s/iter; left time: 7.8106s
	iters: 400, epoch: 4 | loss: 0.3545318
	speed: 0.0036s/iter; left time: 7.7911s
	iters: 500, epoch: 4 | loss: 0.8751677
	speed: 0.0035s/iter; left time: 7.2156s
Updating learning rate to 4.8513828025e-05
Validation loss decreased (0.3564 --> 0.3450).  Saving model state dict ...
Epoch: 4 cost time: 2.174348831176758
Epoch: 4, Steps: 514 | Train Loss: 0.5629413 Vali Loss: 0.3450116 Best vali loss: 0.3450116
	iters: 100, epoch: 5 | loss: 0.3203300
	speed: 0.0081s/iter; left time: 15.8990s
	iters: 200, epoch: 5 | loss: 0.2668672
	speed: 0.0036s/iter; left time: 6.6656s
	iters: 300, epoch: 5 | loss: 0.3599061
	speed: 0.0034s/iter; left time: 5.9912s
	iters: 400, epoch: 5 | loss: 0.3758856
	speed: 0.0035s/iter; left time: 5.8306s
	iters: 500, epoch: 5 | loss: 0.6792880
	speed: 0.0035s/iter; left time: 5.5216s
Updating learning rate to 2.42569140125e-05
Epoch: 5 cost time: 1.8579144477844238
Epoch: 5, Steps: 514 | Train Loss: 0.4004554 Vali Loss: 0.3467584 Best vali loss: 0.3450116
	iters: 100, epoch: 6 | loss: 0.5555519
	speed: 0.0078s/iter; left time: 11.2913s
	iters: 200, epoch: 6 | loss: 0.2310346
	speed: 0.0035s/iter; left time: 4.6579s
	iters: 300, epoch: 6 | loss: 0.3532827
	speed: 0.0035s/iter; left time: 4.3591s
	iters: 400, epoch: 6 | loss: 0.8915145
	speed: 0.0035s/iter; left time: 4.0207s
	iters: 500, epoch: 6 | loss: 0.3549235
	speed: 0.0035s/iter; left time: 3.6749s
Updating learning rate to 1.212845700625e-05
Epoch: 6 cost time: 1.8550715446472168
Epoch: 6, Steps: 514 | Train Loss: 0.4772615 Vali Loss: 0.3463626 Best vali loss: 0.3450116
	iters: 100, epoch: 7 | loss: 0.3618535
	speed: 0.0074s/iter; left time: 6.8370s
	iters: 200, epoch: 7 | loss: 0.4253763
	speed: 0.0036s/iter; left time: 2.9518s
	iters: 300, epoch: 7 | loss: 0.3655521
	speed: 0.0034s/iter; left time: 2.4716s
	iters: 400, epoch: 7 | loss: 0.4479840
	speed: 0.0034s/iter; left time: 2.1575s
	iters: 500, epoch: 7 | loss: 0.5685707
	speed: 0.0033s/iter; left time: 1.7639s
Updating learning rate to 6.064228503125e-06
Epoch: 7 cost time: 1.7917673587799072
Epoch: 7, Steps: 514 | Train Loss: 0.4338673 Vali Loss: 0.3456694 Best vali loss: 0.3450116
	iters: 100, epoch: 8 | loss: 0.3283527
	speed: 0.0078s/iter; left time: 3.2570s
	iters: 200, epoch: 8 | loss: 0.4423684
	speed: 0.0034s/iter; left time: 1.0696s
	iters: 300, epoch: 8 | loss: 0.3561167
	speed: 0.0032s/iter; left time: 0.6782s
	iters: 400, epoch: 8 | loss: 0.2495455
	speed: 0.0031s/iter; left time: 0.3611s
	iters: 500, epoch: 8 | loss: 0.6787063
	speed: 0.0032s/iter; left time: 0.0478s
Updating learning rate to 3.0321142515625e-06
Epoch: 8 cost time: 1.7335772514343262
Epoch: 8, Steps: 514 | Train Loss: 0.4110179 Vali Loss: 0.3457401 Best vali loss: 0.3450116

best validation loss 0.3450116438106844

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023843198087, 'e_layers': 2, 'learning_rate': 0.0003902999987, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7301773
	speed: 0.0100s/iter; left time: 40.1079s
	iters: 200, epoch: 1 | loss: 0.6229498
	speed: 0.0036s/iter; left time: 14.2222s
	iters: 300, epoch: 1 | loss: 0.4065936
	speed: 0.0037s/iter; left time: 14.1713s
	iters: 400, epoch: 1 | loss: 0.5208614
	speed: 0.0036s/iter; left time: 13.2274s
	iters: 500, epoch: 1 | loss: 1.1374696
	speed: 0.0035s/iter; left time: 12.5252s
Updating learning rate to 0.0003902999987
Validation loss decreased (inf --> 0.3779).  Saving model state dict ...
Epoch: 1 cost time: 2.2143025398254395
Epoch: 1, Steps: 514 | Train Loss: 0.6836104 Vali Loss: 0.3779178 Best vali loss: 0.3779178
	iters: 100, epoch: 2 | loss: 0.5097914
	speed: 0.0081s/iter; left time: 28.2771s
	iters: 200, epoch: 2 | loss: 0.3724745
	speed: 0.0036s/iter; left time: 12.0899s
	iters: 300, epoch: 2 | loss: 0.4382539
	speed: 0.0036s/iter; left time: 11.9412s
	iters: 400, epoch: 2 | loss: 0.3962033
	speed: 0.0035s/iter; left time: 11.1507s
	iters: 500, epoch: 2 | loss: 0.9783429
	speed: 0.0034s/iter; left time: 10.6064s
Updating learning rate to 0.00019514999935
Validation loss decreased (0.3779 --> 0.3730).  Saving model state dict ...
Epoch: 2 cost time: 1.8569929599761963
Epoch: 2, Steps: 514 | Train Loss: 0.5390132 Vali Loss: 0.3729892 Best vali loss: 0.3729892
	iters: 100, epoch: 3 | loss: 0.5830507
	speed: 0.0082s/iter; left time: 24.5799s
	iters: 200, epoch: 3 | loss: 0.2979125
	speed: 0.0034s/iter; left time: 9.9320s
	iters: 300, epoch: 3 | loss: 0.4203603
	speed: 0.0037s/iter; left time: 10.2268s
	iters: 400, epoch: 3 | loss: 1.4187760
	speed: 0.0036s/iter; left time: 9.7451s
	iters: 500, epoch: 3 | loss: 0.4060431
	speed: 0.0036s/iter; left time: 9.3980s
Updating learning rate to 9.7574999675e-05
Validation loss decreased (0.3730 --> 0.3709).  Saving model state dict ...
Epoch: 3 cost time: 1.8958454132080078
Epoch: 3, Steps: 514 | Train Loss: 0.6252285 Vali Loss: 0.3709305 Best vali loss: 0.3709305
	iters: 100, epoch: 4 | loss: 0.4434976
	speed: 0.0081s/iter; left time: 20.0257s
	iters: 200, epoch: 4 | loss: 0.4363064
	speed: 0.0036s/iter; left time: 8.6455s
	iters: 300, epoch: 4 | loss: 0.4173737
	speed: 0.0035s/iter; left time: 7.9942s
	iters: 400, epoch: 4 | loss: 0.7316369
	speed: 0.0035s/iter; left time: 7.6639s
	iters: 500, epoch: 4 | loss: 0.7033343
	speed: 0.0036s/iter; left time: 7.4704s
Updating learning rate to 4.87874998375e-05
Validation loss decreased (0.3709 --> 0.3661).  Saving model state dict ...
Epoch: 4 cost time: 1.890439510345459
Epoch: 4, Steps: 514 | Train Loss: 0.5464298 Vali Loss: 0.3661270 Best vali loss: 0.3661270
	iters: 100, epoch: 5 | loss: 0.3677570
	speed: 0.0080s/iter; left time: 15.7434s
	iters: 200, epoch: 5 | loss: 0.4482099
	speed: 0.0035s/iter; left time: 6.4728s
	iters: 300, epoch: 5 | loss: 0.3830613
	speed: 0.0036s/iter; left time: 6.3530s
	iters: 400, epoch: 5 | loss: 0.2621174
	speed: 0.0035s/iter; left time: 5.8794s
	iters: 500, epoch: 5 | loss: 0.7041832
	speed: 0.0036s/iter; left time: 5.5318s
Updating learning rate to 2.439374991875e-05
Validation loss decreased (0.3661 --> 0.3560).  Saving model state dict ...
Epoch: 5 cost time: 1.8689873218536377
Epoch: 5, Steps: 514 | Train Loss: 0.4330657 Vali Loss: 0.3560124 Best vali loss: 0.3560124
	iters: 100, epoch: 6 | loss: 0.3157372
	speed: 0.0076s/iter; left time: 10.9556s
	iters: 200, epoch: 6 | loss: 0.3433166
	speed: 0.0035s/iter; left time: 4.7604s
	iters: 300, epoch: 6 | loss: 0.5718294
	speed: 0.0035s/iter; left time: 4.4050s
	iters: 400, epoch: 6 | loss: 0.5996869
	speed: 0.0034s/iter; left time: 3.9415s
	iters: 500, epoch: 6 | loss: 0.5518503
	speed: 0.0035s/iter; left time: 3.6849s
Updating learning rate to 1.2196874959375e-05
Epoch: 6 cost time: 1.814744472503662
Epoch: 6, Steps: 514 | Train Loss: 0.4764841 Vali Loss: 0.3572528 Best vali loss: 0.3560124
	iters: 100, epoch: 7 | loss: 0.6340449
	speed: 0.0076s/iter; left time: 7.0333s
	iters: 200, epoch: 7 | loss: 0.2945864
	speed: 0.0035s/iter; left time: 2.8744s
	iters: 300, epoch: 7 | loss: 0.3300035
	speed: 0.0032s/iter; left time: 2.3654s
	iters: 400, epoch: 7 | loss: 1.0148679
	speed: 0.0030s/iter; left time: 1.9149s
	iters: 500, epoch: 7 | loss: 0.9100114
	speed: 0.0031s/iter; left time: 1.6602s
Updating learning rate to 6.0984374796875e-06
Epoch: 7 cost time: 1.7265634536743164
Epoch: 7, Steps: 514 | Train Loss: 0.6367028 Vali Loss: 0.3589777 Best vali loss: 0.3560124
	iters: 100, epoch: 8 | loss: 0.5100606
	speed: 0.0072s/iter; left time: 2.9711s
	iters: 200, epoch: 8 | loss: 0.5552678
	speed: 0.0033s/iter; left time: 1.0357s
	iters: 300, epoch: 8 | loss: 0.5021500
	speed: 0.0032s/iter; left time: 0.6901s
	iters: 400, epoch: 8 | loss: 0.5826176
	speed: 0.0030s/iter; left time: 0.3499s
	iters: 500, epoch: 8 | loss: 0.2161285
	speed: 0.0030s/iter; left time: 0.0457s
Updating learning rate to 3.04921873984375e-06
Epoch: 8 cost time: 1.679765224456787
Epoch: 8, Steps: 514 | Train Loss: 0.4732449 Vali Loss: 0.3605613 Best vali loss: 0.3560124

best validation loss 0.35601235712441104

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010629066085, 'e_layers': 2, 'learning_rate': 0.0003845044848, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3379544
	speed: 0.0097s/iter; left time: 38.8716s
	iters: 200, epoch: 1 | loss: 0.8730869
	speed: 0.0036s/iter; left time: 14.1780s
	iters: 300, epoch: 1 | loss: 0.5141631
	speed: 0.0035s/iter; left time: 13.4468s
	iters: 400, epoch: 1 | loss: 0.8649632
	speed: 0.0035s/iter; left time: 12.9959s
	iters: 500, epoch: 1 | loss: 0.7508389
	speed: 0.0035s/iter; left time: 12.6928s
Updating learning rate to 0.0003845044848
Validation loss decreased (inf --> 0.3790).  Saving model state dict ...
Epoch: 1 cost time: 2.175908327102661
Epoch: 1, Steps: 514 | Train Loss: 0.6682013 Vali Loss: 0.3789968 Best vali loss: 0.3789968
	iters: 100, epoch: 2 | loss: 0.8022104
	speed: 0.0077s/iter; left time: 27.0396s
	iters: 200, epoch: 2 | loss: 0.4840327
	speed: 0.0033s/iter; left time: 11.2105s
	iters: 300, epoch: 2 | loss: 0.2798865
	speed: 0.0033s/iter; left time: 10.8393s
	iters: 400, epoch: 2 | loss: 0.3134144
	speed: 0.0033s/iter; left time: 10.5272s
	iters: 500, epoch: 2 | loss: 1.2709022
	speed: 0.0033s/iter; left time: 10.0870s
Updating learning rate to 0.0001922522424
Epoch: 2 cost time: 1.7488226890563965
Epoch: 2, Steps: 514 | Train Loss: 0.6300892 Vali Loss: 0.3791998 Best vali loss: 0.3789968
	iters: 100, epoch: 3 | loss: 0.3928976
	speed: 0.0078s/iter; left time: 23.2485s
	iters: 200, epoch: 3 | loss: 0.5005218
	speed: 0.0037s/iter; left time: 10.5819s
	iters: 300, epoch: 3 | loss: 0.6787447
	speed: 0.0037s/iter; left time: 10.1682s
	iters: 400, epoch: 3 | loss: 0.2915941
	speed: 0.0036s/iter; left time: 9.7996s
	iters: 500, epoch: 3 | loss: 0.5129175
	speed: 0.0036s/iter; left time: 9.2777s
Updating learning rate to 9.61261212e-05
Validation loss decreased (0.3790 --> 0.3769).  Saving model state dict ...
Epoch: 3 cost time: 1.9141850471496582
Epoch: 3, Steps: 514 | Train Loss: 0.4753351 Vali Loss: 0.3768987 Best vali loss: 0.3768987
	iters: 100, epoch: 4 | loss: 0.4850469
	speed: 0.0079s/iter; left time: 19.5773s
	iters: 200, epoch: 4 | loss: 0.2941291
	speed: 0.0035s/iter; left time: 8.3218s
	iters: 300, epoch: 4 | loss: 0.5895622
	speed: 0.0036s/iter; left time: 8.1969s
	iters: 400, epoch: 4 | loss: 0.7992920
	speed: 0.0036s/iter; left time: 7.8052s
	iters: 500, epoch: 4 | loss: 1.0559829
	speed: 0.0036s/iter; left time: 7.5316s
Updating learning rate to 4.80630606e-05
Epoch: 4 cost time: 1.8704180717468262
Epoch: 4, Steps: 514 | Train Loss: 0.6448026 Vali Loss: 0.3967125 Best vali loss: 0.3768987
	iters: 100, epoch: 5 | loss: 0.4415435
	speed: 0.0075s/iter; left time: 14.7690s
	iters: 200, epoch: 5 | loss: 0.5904291
	speed: 0.0035s/iter; left time: 6.4657s
	iters: 300, epoch: 5 | loss: 0.4967314
	speed: 0.0036s/iter; left time: 6.2424s
	iters: 400, epoch: 5 | loss: 0.7732348
	speed: 0.0034s/iter; left time: 5.6221s
	iters: 500, epoch: 5 | loss: 0.4515238
	speed: 0.0034s/iter; left time: 5.2216s
Updating learning rate to 2.40315303e-05
Epoch: 5 cost time: 1.8142073154449463
Epoch: 5, Steps: 514 | Train Loss: 0.5506925 Vali Loss: 0.3826881 Best vali loss: 0.3768987
	iters: 100, epoch: 6 | loss: 0.3381521
	speed: 0.0074s/iter; left time: 10.7280s
	iters: 200, epoch: 6 | loss: 0.3618342
	speed: 0.0034s/iter; left time: 4.5473s
	iters: 300, epoch: 6 | loss: 0.6972942
	speed: 0.0033s/iter; left time: 4.1564s
	iters: 400, epoch: 6 | loss: 0.3289772
	speed: 0.0034s/iter; left time: 3.8661s
	iters: 500, epoch: 6 | loss: 0.6360223
	speed: 0.0034s/iter; left time: 3.5280s
Updating learning rate to 1.201576515e-05
Epoch: 6 cost time: 1.7750449180603027
Epoch: 6, Steps: 514 | Train Loss: 0.4724560 Vali Loss: 0.3897534 Best vali loss: 0.3768987
	iters: 100, epoch: 7 | loss: 0.5110906
	speed: 0.0078s/iter; left time: 7.2158s
	iters: 200, epoch: 7 | loss: 0.7906649
	speed: 0.0035s/iter; left time: 2.9138s
	iters: 300, epoch: 7 | loss: 0.4354044
	speed: 0.0036s/iter; left time: 2.6447s
	iters: 400, epoch: 7 | loss: 1.1787076
	speed: 0.0037s/iter; left time: 2.2987s
	iters: 500, epoch: 7 | loss: 0.4101701
	speed: 0.0036s/iter; left time: 1.9236s
Updating learning rate to 6.007882575e-06
Epoch: 7 cost time: 1.8957979679107666
Epoch: 7, Steps: 514 | Train Loss: 0.6652075 Vali Loss: 0.3887287 Best vali loss: 0.3768987
	iters: 100, epoch: 8 | loss: 0.4849662
	speed: 0.0075s/iter; left time: 3.1246s
	iters: 200, epoch: 8 | loss: 0.3259039
	speed: 0.0034s/iter; left time: 1.0825s
	iters: 300, epoch: 8 | loss: 0.4964365
	speed: 0.0032s/iter; left time: 0.6946s
	iters: 400, epoch: 8 | loss: 0.4071357
	speed: 0.0034s/iter; left time: 0.3859s
	iters: 500, epoch: 8 | loss: 0.3471428
	speed: 0.0034s/iter; left time: 0.0506s
Updating learning rate to 3.0039412875e-06
Epoch: 8 cost time: 1.7806975841522217
Epoch: 8, Steps: 514 | Train Loss: 0.4123170 Vali Loss: 0.3918090 Best vali loss: 0.3768987

best validation loss 0.3768987333376422

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0053632734952, 'e_layers': 2, 'learning_rate': 0.0003851297438, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7285678
	speed: 0.0099s/iter; left time: 39.5522s
	iters: 200, epoch: 1 | loss: 0.6208839
	speed: 0.0034s/iter; left time: 13.4596s
	iters: 300, epoch: 1 | loss: 0.4084979
	speed: 0.0036s/iter; left time: 13.5766s
	iters: 400, epoch: 1 | loss: 0.5040111
	speed: 0.0035s/iter; left time: 12.9882s
	iters: 500, epoch: 1 | loss: 1.1241498
	speed: 0.0034s/iter; left time: 12.3892s
Updating learning rate to 0.0003851297438
Validation loss decreased (inf --> 0.3808).  Saving model state dict ...
Epoch: 1 cost time: 2.1605160236358643
Epoch: 1, Steps: 514 | Train Loss: 0.6772221 Vali Loss: 0.3808133 Best vali loss: 0.3808133
	iters: 100, epoch: 2 | loss: 0.4852663
	speed: 0.0078s/iter; left time: 27.3514s
	iters: 200, epoch: 2 | loss: 0.3701603
	speed: 0.0032s/iter; left time: 10.9804s
	iters: 300, epoch: 2 | loss: 0.4256644
	speed: 0.0032s/iter; left time: 10.5891s
	iters: 400, epoch: 2 | loss: 0.3725468
	speed: 0.0032s/iter; left time: 10.1933s
	iters: 500, epoch: 2 | loss: 0.9398496
	speed: 0.0032s/iter; left time: 9.9644s
Updating learning rate to 0.0001925648719
Validation loss decreased (0.3808 --> 0.3724).  Saving model state dict ...
Epoch: 2 cost time: 1.7065315246582031
Epoch: 2, Steps: 514 | Train Loss: 0.5186975 Vali Loss: 0.3724432 Best vali loss: 0.3724432
	iters: 100, epoch: 3 | loss: 0.5829247
	speed: 0.0079s/iter; left time: 23.5148s
	iters: 200, epoch: 3 | loss: 0.3077340
	speed: 0.0037s/iter; left time: 10.6650s
	iters: 300, epoch: 3 | loss: 0.4430640
	speed: 0.0035s/iter; left time: 9.6155s
	iters: 400, epoch: 3 | loss: 1.3768269
	speed: 0.0036s/iter; left time: 9.5739s
	iters: 500, epoch: 3 | loss: 0.3854239
	speed: 0.0035s/iter; left time: 8.9780s
Updating learning rate to 9.628243595e-05
Validation loss decreased (0.3724 --> 0.3718).  Saving model state dict ...
Epoch: 3 cost time: 1.879913330078125
Epoch: 3, Steps: 514 | Train Loss: 0.6191947 Vali Loss: 0.3717891 Best vali loss: 0.3717891

best validation loss 0.3717891428348826

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015592881125, 'e_layers': 2, 'learning_rate': 0.0003869651974, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7297402
	speed: 0.0096s/iter; left time: 38.6544s
	iters: 200, epoch: 1 | loss: 0.6215532
	speed: 0.0034s/iter; left time: 13.3899s
	iters: 300, epoch: 1 | loss: 0.4075786
	speed: 0.0035s/iter; left time: 13.4031s
	iters: 400, epoch: 1 | loss: 0.5172576
	speed: 0.0035s/iter; left time: 12.9449s
	iters: 500, epoch: 1 | loss: 1.1231998
	speed: 0.0033s/iter; left time: 12.0371s
Updating learning rate to 0.0003869651974
Validation loss decreased (inf --> 0.3773).  Saving model state dict ...
Epoch: 1 cost time: 2.1230618953704834
Epoch: 1, Steps: 514 | Train Loss: 0.6798659 Vali Loss: 0.3772530 Best vali loss: 0.3772530
	iters: 100, epoch: 2 | loss: 0.5108507
	speed: 0.0080s/iter; left time: 27.9352s
	iters: 200, epoch: 2 | loss: 0.3706690
	speed: 0.0034s/iter; left time: 11.5859s
	iters: 300, epoch: 2 | loss: 0.4644193
	speed: 0.0033s/iter; left time: 10.9086s
	iters: 400, epoch: 2 | loss: 0.3703781
	speed: 0.0033s/iter; left time: 10.6420s
	iters: 500, epoch: 2 | loss: 0.9818705
	speed: 0.0033s/iter; left time: 10.1161s
Updating learning rate to 0.0001934825987
Validation loss decreased (0.3773 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 1.7934153079986572
Epoch: 2, Steps: 514 | Train Loss: 0.5396375 Vali Loss: 0.3683038 Best vali loss: 0.3683038
	iters: 100, epoch: 3 | loss: 0.5887336
	speed: 0.0076s/iter; left time: 22.6496s
	iters: 200, epoch: 3 | loss: 0.3239038
	speed: 0.0032s/iter; left time: 9.1534s
	iters: 300, epoch: 3 | loss: 0.4534774
	speed: 0.0032s/iter; left time: 8.8584s
	iters: 400, epoch: 3 | loss: 1.3444085
	speed: 0.0031s/iter; left time: 8.2499s
	iters: 500, epoch: 3 | loss: 0.3849567
	speed: 0.0030s/iter; left time: 7.8789s
Updating learning rate to 9.674129935e-05
Epoch: 3 cost time: 1.6598777770996094
Epoch: 3, Steps: 514 | Train Loss: 0.6190960 Vali Loss: 0.3798375 Best vali loss: 0.3683038

best validation loss 0.36830377533065783

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0119659252535, 'e_layers': 4, 'learning_rate': 0.0017895954814, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9774832
	speed: 0.0112s/iter; left time: 90.6848s
	iters: 200, epoch: 1 | loss: 0.7509913
	speed: 0.0051s/iter; left time: 40.9579s
	iters: 300, epoch: 1 | loss: 1.0803540
	speed: 0.0051s/iter; left time: 40.6115s
	iters: 400, epoch: 1 | loss: 0.4616857
	speed: 0.0051s/iter; left time: 39.8037s
	iters: 500, epoch: 1 | loss: 0.4345075
	speed: 0.0051s/iter; left time: 39.1868s
	iters: 600, epoch: 1 | loss: 1.5889060
	speed: 0.0051s/iter; left time: 38.6386s
	iters: 700, epoch: 1 | loss: 0.3336591
	speed: 0.0051s/iter; left time: 38.4668s
	iters: 800, epoch: 1 | loss: 0.6325184
	speed: 0.0051s/iter; left time: 37.9746s
	iters: 900, epoch: 1 | loss: 0.4283237
	speed: 0.0051s/iter; left time: 37.3816s
	iters: 1000, epoch: 1 | loss: 0.6536489
	speed: 0.0051s/iter; left time: 36.8966s
Updating learning rate to 0.0017214830590700717
Validation loss decreased (inf --> 0.3966).  Saving model state dict ...
Epoch: 1 cost time: 5.586675643920898
Epoch: 1, Steps: 1027 | Train Loss: 0.7342078 Vali Loss: 0.3965770 Best vali loss: 0.3965770
	iters: 100, epoch: 2 | loss: 0.6561261
	speed: 0.0127s/iter; left time: 90.3682s
	iters: 200, epoch: 2 | loss: 0.5021123
	speed: 0.0046s/iter; left time: 32.4354s
	iters: 300, epoch: 2 | loss: 0.4180914
	speed: 0.0046s/iter; left time: 31.9090s
	iters: 400, epoch: 2 | loss: 0.4667814
	speed: 0.0046s/iter; left time: 31.0230s
	iters: 500, epoch: 2 | loss: 0.2924516
	speed: 0.0045s/iter; left time: 29.9829s
	iters: 600, epoch: 2 | loss: 1.1652507
	speed: 0.0044s/iter; left time: 28.6813s
	iters: 700, epoch: 2 | loss: 1.4736114
	speed: 0.0046s/iter; left time: 29.8737s
	iters: 800, epoch: 2 | loss: 0.4156577
	speed: 0.0048s/iter; left time: 30.9526s
	iters: 900, epoch: 2 | loss: 0.5268825
	speed: 0.0048s/iter; left time: 30.5028s
	iters: 1000, epoch: 2 | loss: 0.2555873
	speed: 0.0049s/iter; left time: 30.0650s
Updating learning rate to 0.0015275152909393721
Epoch: 2 cost time: 4.821989059448242
Epoch: 2, Steps: 1027 | Train Loss: 0.6172552 Vali Loss: 0.4030542 Best vali loss: 0.3965770
	iters: 100, epoch: 3 | loss: 1.7954450
	speed: 0.0131s/iter; left time: 79.3358s
	iters: 200, epoch: 3 | loss: 0.5163379
	speed: 0.0051s/iter; left time: 30.4996s
	iters: 300, epoch: 3 | loss: 1.4398462
	speed: 0.0050s/iter; left time: 29.5979s
	iters: 400, epoch: 3 | loss: 1.1454357
	speed: 0.0051s/iter; left time: 29.1072s
	iters: 500, epoch: 3 | loss: 0.5338290
	speed: 0.0050s/iter; left time: 28.5958s
	iters: 600, epoch: 3 | loss: 0.3425334
	speed: 0.0051s/iter; left time: 28.1976s
	iters: 700, epoch: 3 | loss: 0.3947181
	speed: 0.0051s/iter; left time: 27.9695s
	iters: 800, epoch: 3 | loss: 1.2360526
	speed: 0.0051s/iter; left time: 27.2537s
	iters: 900, epoch: 3 | loss: 0.3403933
	speed: 0.0051s/iter; left time: 26.8374s
	iters: 1000, epoch: 3 | loss: 0.2442009
	speed: 0.0051s/iter; left time: 26.3854s
Updating learning rate to 0.0012372220113836038
Epoch: 3 cost time: 5.258935928344727
Epoch: 3, Steps: 1027 | Train Loss: 0.7988792 Vali Loss: 0.4016632 Best vali loss: 0.3965770

best validation loss 0.39657696581542606

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015592881125, 'e_layers': 2, 'learning_rate': 0.0003869651974, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6608252
	speed: 0.0103s/iter; left time: 25.3683s
	iters: 200, epoch: 4 | loss: 0.6089368
	speed: 0.0036s/iter; left time: 8.6414s
	iters: 300, epoch: 4 | loss: 0.3884077
	speed: 0.0036s/iter; left time: 8.2792s
	iters: 400, epoch: 4 | loss: 0.3833987
	speed: 0.0036s/iter; left time: 7.8770s
	iters: 500, epoch: 4 | loss: 0.9643301
	speed: 0.0037s/iter; left time: 7.5688s
Updating learning rate to 4.8370649675e-05
Epoch: 4 cost time: 2.2368831634521484
Epoch: 4, Steps: 514 | Train Loss: 0.6011797 Vali Loss: 0.3835071 Best vali loss: 0.3683038
	iters: 100, epoch: 5 | loss: 0.3412535
	speed: 0.0078s/iter; left time: 15.2958s
	iters: 200, epoch: 5 | loss: 0.2889012
	speed: 0.0036s/iter; left time: 6.6577s
	iters: 300, epoch: 5 | loss: 0.4014374
	speed: 0.0036s/iter; left time: 6.2663s
	iters: 400, epoch: 5 | loss: 0.3678530
	speed: 0.0035s/iter; left time: 5.7942s
	iters: 500, epoch: 5 | loss: 0.7044633
	speed: 0.0036s/iter; left time: 5.5428s
Updating learning rate to 2.41853248375e-05
Epoch: 5 cost time: 1.8601315021514893
Epoch: 5, Steps: 514 | Train Loss: 0.4207817 Vali Loss: 0.3942425 Best vali loss: 0.3683038
	iters: 100, epoch: 6 | loss: 0.5698330
	speed: 0.0078s/iter; left time: 11.1866s
	iters: 200, epoch: 6 | loss: 0.2645988
	speed: 0.0037s/iter; left time: 4.9566s
	iters: 300, epoch: 6 | loss: 0.3766872
	speed: 0.0036s/iter; left time: 4.4612s
	iters: 400, epoch: 6 | loss: 0.9482368
	speed: 0.0033s/iter; left time: 3.8195s
	iters: 500, epoch: 6 | loss: 0.3665409
	speed: 0.0034s/iter; left time: 3.5827s
Updating learning rate to 1.209266241875e-05
Epoch: 6 cost time: 1.8634161949157715
Epoch: 6, Steps: 514 | Train Loss: 0.5051793 Vali Loss: 0.3897916 Best vali loss: 0.3683038
	iters: 100, epoch: 7 | loss: 0.3915416
	speed: 0.0075s/iter; left time: 6.9377s
	iters: 200, epoch: 7 | loss: 0.4323864
	speed: 0.0034s/iter; left time: 2.8021s
	iters: 300, epoch: 7 | loss: 0.3847764
	speed: 0.0031s/iter; left time: 2.2886s
	iters: 400, epoch: 7 | loss: 0.5195580
	speed: 0.0031s/iter; left time: 1.9570s
	iters: 500, epoch: 7 | loss: 0.5793828
	speed: 0.0032s/iter; left time: 1.6798s
Updating learning rate to 6.046331209375e-06
Epoch: 7 cost time: 1.712602138519287
Epoch: 7, Steps: 514 | Train Loss: 0.4615290 Vali Loss: 0.3904662 Best vali loss: 0.3683038
	iters: 100, epoch: 8 | loss: 0.3445110
	speed: 0.0077s/iter; left time: 3.1978s
	iters: 200, epoch: 8 | loss: 0.4505196
	speed: 0.0036s/iter; left time: 1.1316s
	iters: 300, epoch: 8 | loss: 0.4065273
	speed: 0.0035s/iter; left time: 0.7465s
	iters: 400, epoch: 8 | loss: 0.2608060
	speed: 0.0035s/iter; left time: 0.3980s
	iters: 500, epoch: 8 | loss: 0.7092768
	speed: 0.0036s/iter; left time: 0.0544s
Updating learning rate to 3.0231656046875e-06
Epoch: 8 cost time: 1.8617935180664062
Epoch: 8, Steps: 514 | Train Loss: 0.4343282 Vali Loss: 0.3896021 Best vali loss: 0.3683038

best validation loss 0.36830377533065783

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.006035969405, 'e_layers': 4, 'learning_rate': 0.0003903929673, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5035356
	speed: 0.0115s/iter; left time: 46.0930s
	iters: 200, epoch: 1 | loss: 0.7039344
	speed: 0.0055s/iter; left time: 21.6618s
	iters: 300, epoch: 1 | loss: 0.3354459
	speed: 0.0056s/iter; left time: 21.2076s
	iters: 400, epoch: 1 | loss: 0.8486149
	speed: 0.0055s/iter; left time: 20.4833s
	iters: 500, epoch: 1 | loss: 0.5015861
	speed: 0.0056s/iter; left time: 20.0896s
Updating learning rate to 0.0003903929673
Validation loss decreased (inf --> 0.3921).  Saving model state dict ...
Epoch: 1 cost time: 3.1921279430389404
Epoch: 1, Steps: 514 | Train Loss: 0.5786234 Vali Loss: 0.3920767 Best vali loss: 0.3920767
	iters: 100, epoch: 2 | loss: 0.7087116
	speed: 0.0113s/iter; left time: 39.5362s
	iters: 200, epoch: 2 | loss: 0.5453010
	speed: 0.0053s/iter; left time: 17.9958s
	iters: 300, epoch: 2 | loss: 0.9987376
	speed: 0.0053s/iter; left time: 17.5116s
	iters: 400, epoch: 2 | loss: 1.0541822
	speed: 0.0052s/iter; left time: 16.7450s
	iters: 500, epoch: 2 | loss: 1.1255202
	speed: 0.0053s/iter; left time: 16.3882s
Updating learning rate to 0.00019519648365
Epoch: 2 cost time: 2.7691211700439453
Epoch: 2, Steps: 514 | Train Loss: 0.8864905 Vali Loss: 0.4054729 Best vali loss: 0.3920767
	iters: 100, epoch: 3 | loss: 0.8802684
	speed: 0.0106s/iter; left time: 31.7195s
	iters: 200, epoch: 3 | loss: 0.8738433
	speed: 0.0053s/iter; left time: 15.3069s
	iters: 300, epoch: 3 | loss: 0.8099838
	speed: 0.0055s/iter; left time: 15.4072s
	iters: 400, epoch: 3 | loss: 0.5696161
	speed: 0.0055s/iter; left time: 14.8439s
	iters: 500, epoch: 3 | loss: 0.8844955
	speed: 0.0055s/iter; left time: 14.0912s
Updating learning rate to 9.7598241825e-05
Epoch: 3 cost time: 2.8251662254333496
Epoch: 3, Steps: 514 | Train Loss: 0.8036414 Vali Loss: 0.4006260 Best vali loss: 0.3920767
	iters: 100, epoch: 4 | loss: 0.8022931
	speed: 0.0109s/iter; left time: 26.8729s
	iters: 200, epoch: 4 | loss: 0.4279480
	speed: 0.0053s/iter; left time: 12.5392s
	iters: 300, epoch: 4 | loss: 0.8355115
	speed: 0.0053s/iter; left time: 12.0750s
	iters: 400, epoch: 4 | loss: 0.4940839
	speed: 0.0054s/iter; left time: 11.6633s
	iters: 500, epoch: 4 | loss: 0.7772663
	speed: 0.0055s/iter; left time: 11.3044s
Updating learning rate to 4.87991209125e-05
Epoch: 4 cost time: 2.7965338230133057
Epoch: 4, Steps: 514 | Train Loss: 0.6674206 Vali Loss: 0.3965609 Best vali loss: 0.3920767
	iters: 100, epoch: 5 | loss: 0.2830914
	speed: 0.0109s/iter; left time: 21.3960s
	iters: 200, epoch: 5 | loss: 0.7450730
	speed: 0.0055s/iter; left time: 10.2333s
	iters: 300, epoch: 5 | loss: 0.5084594
	speed: 0.0055s/iter; left time: 9.6014s
	iters: 400, epoch: 5 | loss: 0.5138242
	speed: 0.0056s/iter; left time: 9.1996s
	iters: 500, epoch: 5 | loss: 0.7928303
	speed: 0.0055s/iter; left time: 8.5650s
Updating learning rate to 2.439956045625e-05
Epoch: 5 cost time: 2.8784983158111572
Epoch: 5, Steps: 514 | Train Loss: 0.5686556 Vali Loss: 0.4005316 Best vali loss: 0.3920767
	iters: 100, epoch: 6 | loss: 0.6010169
	speed: 0.0110s/iter; left time: 15.8523s
	iters: 200, epoch: 6 | loss: 0.5726417
	speed: 0.0056s/iter; left time: 7.5264s
	iters: 300, epoch: 6 | loss: 0.5330095
	speed: 0.0055s/iter; left time: 6.8076s
	iters: 400, epoch: 6 | loss: 0.3941361
	speed: 0.0055s/iter; left time: 6.3003s
	iters: 500, epoch: 6 | loss: 0.8693567
	speed: 0.0055s/iter; left time: 5.7291s
Updating learning rate to 1.2199780228125e-05
Epoch: 6 cost time: 2.8879268169403076
Epoch: 6, Steps: 514 | Train Loss: 0.5940322 Vali Loss: 0.4015497 Best vali loss: 0.3920767
	iters: 100, epoch: 7 | loss: 0.8115858
	speed: 0.0109s/iter; left time: 10.1457s
	iters: 200, epoch: 7 | loss: 0.5486820
	speed: 0.0056s/iter; left time: 4.6131s
	iters: 300, epoch: 7 | loss: 0.6647775
	speed: 0.0056s/iter; left time: 4.0507s
	iters: 400, epoch: 7 | loss: 0.5286751
	speed: 0.0055s/iter; left time: 3.4362s
	iters: 500, epoch: 7 | loss: 0.7315293
	speed: 0.0054s/iter; left time: 2.8382s
Updating learning rate to 6.0998901140625e-06
Epoch: 7 cost time: 2.8638877868652344
Epoch: 7, Steps: 514 | Train Loss: 0.6570499 Vali Loss: 0.4016936 Best vali loss: 0.3920767
	iters: 100, epoch: 8 | loss: 0.4717932
	speed: 0.0105s/iter; left time: 4.3560s
	iters: 200, epoch: 8 | loss: 0.3440278
	speed: 0.0053s/iter; left time: 1.6844s
	iters: 300, epoch: 8 | loss: 0.9519788
	speed: 0.0053s/iter; left time: 1.1335s
	iters: 400, epoch: 8 | loss: 1.0280498
	speed: 0.0053s/iter; left time: 0.6074s
	iters: 500, epoch: 8 | loss: 1.1888454
	speed: 0.0054s/iter; left time: 0.0804s
Updating learning rate to 3.04994505703125e-06
Epoch: 8 cost time: 2.76771879196167
Epoch: 8, Steps: 514 | Train Loss: 0.7969390 Vali Loss: 0.4020686 Best vali loss: 0.3920767

best validation loss 0.3920766775875054

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020785306445, 'e_layers': 2, 'learning_rate': 0.0001352482814, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5085365
	speed: 0.0108s/iter; left time: 10.0822s
Updating learning rate to 0.00013010070019639348
Validation loss decreased (inf --> 0.3625).  Saving model state dict ...
Epoch: 1 cost time: 0.9417543411254883
Epoch: 1, Steps: 129 | Train Loss: 0.5085365 Vali Loss: 0.3625133 Best vali loss: 0.3625133
	iters: 100, epoch: 2 | loss: 0.6748734
	speed: 0.0079s/iter; left time: 6.3406s
Updating learning rate to 0.0001154416291608832
Validation loss decreased (0.3625 --> 0.3587).  Saving model state dict ...
Epoch: 2 cost time: 0.6072595119476318
Epoch: 2, Steps: 129 | Train Loss: 0.6748734 Vali Loss: 0.3587401 Best vali loss: 0.3587401
	iters: 100, epoch: 3 | loss: 0.5825008
	speed: 0.0076s/iter; left time: 5.1394s
Updating learning rate to 9.350277897381578e-05
Validation loss decreased (0.3587 --> 0.3562).  Saving model state dict ...
Epoch: 3 cost time: 0.5688190460205078
Epoch: 3, Steps: 129 | Train Loss: 0.5825008 Vali Loss: 0.3561716 Best vali loss: 0.3561716
	iters: 100, epoch: 4 | loss: 0.4189300
	speed: 0.0073s/iter; left time: 3.9607s
Updating learning rate to 6.76241407e-05
Epoch: 4 cost time: 0.5477936267852783
Epoch: 4, Steps: 129 | Train Loss: 0.4189300 Vali Loss: 0.3701475 Best vali loss: 0.3561716
	iters: 100, epoch: 5 | loss: 0.5401115
	speed: 0.0072s/iter; left time: 3.0099s
Updating learning rate to 4.174550242618424e-05
Epoch: 5 cost time: 0.5602483749389648
Epoch: 5, Steps: 129 | Train Loss: 0.5401115 Vali Loss: 0.3657251 Best vali loss: 0.3561716
	iters: 100, epoch: 6 | loss: 0.4966356
	speed: 0.0070s/iter; left time: 2.0278s
Updating learning rate to 1.9806652239116805e-05
Epoch: 6 cost time: 0.5457189083099365
Epoch: 6, Steps: 129 | Train Loss: 0.4966356 Vali Loss: 0.3620912 Best vali loss: 0.3561716
	iters: 100, epoch: 7 | loss: 0.4056925
	speed: 0.0070s/iter; left time: 1.1164s
Updating learning rate to 5.1475812036065215e-06
Epoch: 7 cost time: 0.5437076091766357
Epoch: 7, Steps: 129 | Train Loss: 0.4056925 Vali Loss: 0.3678825 Best vali loss: 0.3561716
	iters: 100, epoch: 8 | loss: 0.4965277
	speed: 0.0070s/iter; left time: 0.2111s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5491564273834229
Epoch: 8, Steps: 129 | Train Loss: 0.4965277 Vali Loss: 0.3679954 Best vali loss: 0.3561716

best validation loss 0.35617156524086746

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010717464137, 'e_layers': 2, 'learning_rate': 0.0003995218562, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4267522
	speed: 0.0099s/iter; left time: 39.5927s
	iters: 200, epoch: 1 | loss: 1.0782458
	speed: 0.0035s/iter; left time: 13.8745s
	iters: 300, epoch: 1 | loss: 1.0150270
	speed: 0.0035s/iter; left time: 13.2552s
	iters: 400, epoch: 1 | loss: 0.5045918
	speed: 0.0035s/iter; left time: 12.8164s
	iters: 500, epoch: 1 | loss: 1.1811496
	speed: 0.0036s/iter; left time: 12.9298s
Updating learning rate to 0.00038431596096704876
Validation loss decreased (inf --> 0.3689).  Saving model state dict ...
Epoch: 1 cost time: 2.175644636154175
Epoch: 1, Steps: 514 | Train Loss: 0.8411533 Vali Loss: 0.3689456 Best vali loss: 0.3689456
	iters: 100, epoch: 2 | loss: 0.3874756
	speed: 0.0074s/iter; left time: 25.7607s
	iters: 200, epoch: 2 | loss: 0.2592353
	speed: 0.0031s/iter; left time: 10.6363s
	iters: 300, epoch: 2 | loss: 0.4646392
	speed: 0.0030s/iter; left time: 9.9340s
	iters: 400, epoch: 2 | loss: 0.3958189
	speed: 0.0031s/iter; left time: 9.8093s
	iters: 500, epoch: 2 | loss: 0.6208377
	speed: 0.0031s/iter; left time: 9.6032s
Updating learning rate to 0.00034101323497562835
Validation loss decreased (0.3689 --> 0.3626).  Saving model state dict ...
Epoch: 2 cost time: 1.6416549682617188
Epoch: 2, Steps: 514 | Train Loss: 0.4256014 Vali Loss: 0.3625970 Best vali loss: 0.3625970
	iters: 100, epoch: 3 | loss: 0.3613346
	speed: 0.0075s/iter; left time: 22.5333s
	iters: 200, epoch: 3 | loss: 0.8510662
	speed: 0.0035s/iter; left time: 10.1595s
	iters: 300, epoch: 3 | loss: 0.4898517
	speed: 0.0035s/iter; left time: 9.7404s
	iters: 400, epoch: 3 | loss: 0.4878992
	speed: 0.0033s/iter; left time: 8.9558s
	iters: 500, epoch: 3 | loss: 1.0523905
	speed: 0.0034s/iter; left time: 8.8071s
Updating learning rate to 0.0002762061257177439
Validation loss decreased (0.3626 --> 0.3617).  Saving model state dict ...
Epoch: 3 cost time: 1.8167412281036377
Epoch: 3, Steps: 514 | Train Loss: 0.6485084 Vali Loss: 0.3616685 Best vali loss: 0.3616685

best validation loss 0.3616685002398163

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070195455, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5599238
	speed: 0.0133s/iter; left time: 12.4019s
Updating learning rate to 0.0007070195455
Validation loss decreased (inf --> 0.3998).  Saving model state dict ...
Epoch: 1 cost time: 1.263202428817749
Epoch: 1, Steps: 129 | Train Loss: 0.5599238 Vali Loss: 0.3998108 Best vali loss: 0.3998108
	iters: 100, epoch: 2 | loss: 0.5619271
	speed: 0.0116s/iter; left time: 9.3282s
Updating learning rate to 0.00035350977275
Validation loss decreased (0.3998 --> 0.3880).  Saving model state dict ...
Epoch: 2 cost time: 0.9314069747924805
Epoch: 2, Steps: 129 | Train Loss: 0.5619271 Vali Loss: 0.3879561 Best vali loss: 0.3879561
	iters: 100, epoch: 3 | loss: 0.6984862
	speed: 0.0118s/iter; left time: 7.9364s
Updating learning rate to 0.000176754886375
Epoch: 3 cost time: 0.9289789199829102
Epoch: 3, Steps: 129 | Train Loss: 0.6984862 Vali Loss: 0.3929119 Best vali loss: 0.3879561

best validation loss 0.38795608282089233

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010648534122, 'e_layers': 3, 'learning_rate': 0.0002977594524, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002977594524
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 0.7743279933929443
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3637389 Best vali loss: 0.3637389
Updating learning rate to 0.0001488797262
Validation loss decreased (0.3637 --> 0.3613).  Saving model state dict ...
Epoch: 2 cost time: 0.46427345275878906
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3612610 Best vali loss: 0.3612610
Updating learning rate to 7.44398631e-05
Epoch: 3 cost time: 0.4734625816345215
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3644644 Best vali loss: 0.3612610

best validation loss 0.3612609849346176

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010648534122, 'e_layers': 3, 'learning_rate': 0.0002977594524, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 3.721993155e-05
Epoch: 4 cost time: 0.770362138748169
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3726349 Best vali loss: 0.3612610
Updating learning rate to 1.8609965775e-05
Epoch: 5 cost time: 0.472836971282959
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3659693 Best vali loss: 0.3612610
Updating learning rate to 9.3049828875e-06
Epoch: 6 cost time: 0.46813082695007324
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3671481 Best vali loss: 0.3612610
Updating learning rate to 4.65249144375e-06
Epoch: 7 cost time: 0.4658961296081543
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3694935 Best vali loss: 0.3612610
Updating learning rate to 2.326245721875e-06
Epoch: 8 cost time: 0.46674013137817383
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3658444 Best vali loss: 0.3612610

best validation loss 0.3612609849346176

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0008529108454, 'e_layers': 3, 'learning_rate': 0.0004510384969, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4189931
	speed: 0.0098s/iter; left time: 79.8719s
	iters: 200, epoch: 1 | loss: 0.7327597
	speed: 0.0037s/iter; left time: 29.9801s
	iters: 300, epoch: 1 | loss: 0.6356179
	speed: 0.0037s/iter; left time: 29.5383s
	iters: 400, epoch: 1 | loss: 0.3124406
	speed: 0.0039s/iter; left time: 30.2012s
	iters: 500, epoch: 1 | loss: 0.3296977
	speed: 0.0039s/iter; left time: 30.4582s
	iters: 600, epoch: 1 | loss: 0.4339696
	speed: 0.0040s/iter; left time: 30.4670s
	iters: 700, epoch: 1 | loss: 0.2920767
	speed: 0.0040s/iter; left time: 30.0744s
	iters: 800, epoch: 1 | loss: 0.2527107
	speed: 0.0038s/iter; left time: 28.2489s
	iters: 900, epoch: 1 | loss: 1.0020924
	speed: 0.0037s/iter; left time: 27.0124s
	iters: 1000, epoch: 1 | loss: 0.5853381
	speed: 0.0037s/iter; left time: 26.9765s
Updating learning rate to 0.0004510384969
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 4.268550634384155
Epoch: 1, Steps: 1027 | Train Loss: 0.4995696 Vali Loss: 0.3685989 Best vali loss: 0.3685989
	iters: 100, epoch: 2 | loss: 1.5099030
	speed: 0.0107s/iter; left time: 76.2034s
	iters: 200, epoch: 2 | loss: 1.6698368
	speed: 0.0037s/iter; left time: 25.6850s
	iters: 300, epoch: 2 | loss: 1.0159291
	speed: 0.0038s/iter; left time: 26.1852s
	iters: 400, epoch: 2 | loss: 1.1711893
	speed: 0.0040s/iter; left time: 27.3651s
	iters: 500, epoch: 2 | loss: 1.3976449
	speed: 0.0039s/iter; left time: 26.0610s
	iters: 600, epoch: 2 | loss: 0.9826902
	speed: 0.0039s/iter; left time: 25.5786s
	iters: 700, epoch: 2 | loss: 0.4986711
	speed: 0.0039s/iter; left time: 25.0547s
	iters: 800, epoch: 2 | loss: 0.4685535
	speed: 0.0039s/iter; left time: 24.7806s
	iters: 900, epoch: 2 | loss: 0.7832192
	speed: 0.0038s/iter; left time: 23.8898s
	iters: 1000, epoch: 2 | loss: 0.2661388
	speed: 0.0040s/iter; left time: 24.5769s
Updating learning rate to 0.00022551924845
Epoch: 2 cost time: 4.003118991851807
Epoch: 2, Steps: 1027 | Train Loss: 0.9763776 Vali Loss: 0.3708428 Best vali loss: 0.3685989
	iters: 100, epoch: 3 | loss: 0.9502217
	speed: 0.0109s/iter; left time: 66.2347s
	iters: 200, epoch: 3 | loss: 0.4285167
	speed: 0.0040s/iter; left time: 23.8128s
	iters: 300, epoch: 3 | loss: 0.3237002
	speed: 0.0043s/iter; left time: 25.0704s
	iters: 400, epoch: 3 | loss: 1.3409092
	speed: 0.0042s/iter; left time: 24.2092s
	iters: 500, epoch: 3 | loss: 1.2650615
	speed: 0.0042s/iter; left time: 23.9588s
	iters: 600, epoch: 3 | loss: 0.8714170
	speed: 0.0041s/iter; left time: 23.0843s
	iters: 700, epoch: 3 | loss: 0.4799326
	speed: 0.0042s/iter; left time: 22.9365s
	iters: 800, epoch: 3 | loss: 0.8624882
	speed: 0.0042s/iter; left time: 22.6424s
	iters: 900, epoch: 3 | loss: 0.3645371
	speed: 0.0042s/iter; left time: 22.0053s
	iters: 1000, epoch: 3 | loss: 1.2956003
	speed: 0.0042s/iter; left time: 21.8081s
Updating learning rate to 0.000112759624225
Epoch: 3 cost time: 4.317203521728516
Epoch: 3, Steps: 1027 | Train Loss: 0.8182385 Vali Loss: 0.3715683 Best vali loss: 0.3685989
	iters: 100, epoch: 4 | loss: 0.7768491
	speed: 0.0111s/iter; left time: 55.8987s
	iters: 200, epoch: 4 | loss: 0.3356613
	speed: 0.0041s/iter; left time: 20.4838s
	iters: 300, epoch: 4 | loss: 0.9638159
	speed: 0.0042s/iter; left time: 20.1887s
	iters: 400, epoch: 4 | loss: 0.4030527
	speed: 0.0041s/iter; left time: 19.5031s
	iters: 500, epoch: 4 | loss: 0.4486411
	speed: 0.0041s/iter; left time: 19.1929s
	iters: 600, epoch: 4 | loss: 0.3465905
	speed: 0.0039s/iter; left time: 17.7748s
	iters: 700, epoch: 4 | loss: 0.6929835
	speed: 0.0035s/iter; left time: 15.5224s
	iters: 800, epoch: 4 | loss: 0.6372035
	speed: 0.0036s/iter; left time: 15.5208s
	iters: 900, epoch: 4 | loss: 0.4132439
	speed: 0.0039s/iter; left time: 16.5496s
	iters: 1000, epoch: 4 | loss: 1.0821052
	speed: 0.0042s/iter; left time: 17.5124s
Updating learning rate to 5.63798121125e-05
Epoch: 4 cost time: 4.13965106010437
Epoch: 4, Steps: 1027 | Train Loss: 0.6100147 Vali Loss: 0.3711912 Best vali loss: 0.3685989
	iters: 100, epoch: 5 | loss: 0.9643832
	speed: 0.0114s/iter; left time: 45.7725s
	iters: 200, epoch: 5 | loss: 0.3316213
	speed: 0.0042s/iter; left time: 16.5417s
	iters: 300, epoch: 5 | loss: 0.8237141
	speed: 0.0042s/iter; left time: 16.1373s
	iters: 400, epoch: 5 | loss: 1.4025055
	speed: 0.0042s/iter; left time: 15.6660s
	iters: 500, epoch: 5 | loss: 1.1735007
	speed: 0.0042s/iter; left time: 15.1861s
	iters: 600, epoch: 5 | loss: 0.9791631
	speed: 0.0041s/iter; left time: 14.4673s
	iters: 700, epoch: 5 | loss: 1.2101940
	speed: 0.0040s/iter; left time: 13.6499s
	iters: 800, epoch: 5 | loss: 0.6155099
	speed: 0.0040s/iter; left time: 13.1219s
	iters: 900, epoch: 5 | loss: 0.4294040
	speed: 0.0040s/iter; left time: 12.8306s
	iters: 1000, epoch: 5 | loss: 0.8093952
	speed: 0.0040s/iter; left time: 12.4466s
Updating learning rate to 2.818990605625e-05
Epoch: 5 cost time: 4.277208566665649
Epoch: 5, Steps: 1027 | Train Loss: 0.8739391 Vali Loss: 0.3835979 Best vali loss: 0.3685989
	iters: 100, epoch: 6 | loss: 0.2921165
	speed: 0.0112s/iter; left time: 33.5290s
	iters: 200, epoch: 6 | loss: 0.4587095
	speed: 0.0043s/iter; left time: 12.2722s
	iters: 300, epoch: 6 | loss: 0.4759417
	speed: 0.0041s/iter; left time: 11.4580s
	iters: 400, epoch: 6 | loss: 0.5190449
	speed: 0.0039s/iter; left time: 10.5385s
	iters: 500, epoch: 6 | loss: 0.2625222
	speed: 0.0039s/iter; left time: 10.1068s
	iters: 600, epoch: 6 | loss: 0.3811123
	speed: 0.0039s/iter; left time: 9.7512s
	iters: 700, epoch: 6 | loss: 1.6396333
	speed: 0.0040s/iter; left time: 9.4182s
	iters: 800, epoch: 6 | loss: 0.2721572
	speed: 0.0040s/iter; left time: 9.0417s
	iters: 900, epoch: 6 | loss: 0.4016205
	speed: 0.0039s/iter; left time: 8.4932s
	iters: 1000, epoch: 6 | loss: 0.4961626
	speed: 0.0039s/iter; left time: 8.1158s
Updating learning rate to 1.4094953028125e-05
Epoch: 6 cost time: 4.1549553871154785
Epoch: 6, Steps: 1027 | Train Loss: 0.5199021 Vali Loss: 0.3838505 Best vali loss: 0.3685989
	iters: 100, epoch: 7 | loss: 0.2579444
	speed: 0.0114s/iter; left time: 22.2224s
	iters: 200, epoch: 7 | loss: 0.6047235
	speed: 0.0041s/iter; left time: 7.5281s
	iters: 300, epoch: 7 | loss: 0.7661344
	speed: 0.0042s/iter; left time: 7.3996s
	iters: 400, epoch: 7 | loss: 0.3323395
	speed: 0.0042s/iter; left time: 7.0086s
	iters: 500, epoch: 7 | loss: 0.9821131
	speed: 0.0042s/iter; left time: 6.5792s
	iters: 600, epoch: 7 | loss: 0.7377224
	speed: 0.0041s/iter; left time: 5.9287s
	iters: 700, epoch: 7 | loss: 0.7244011
	speed: 0.0040s/iter; left time: 5.4208s
	iters: 800, epoch: 7 | loss: 0.2100422
	speed: 0.0040s/iter; left time: 5.0199s
	iters: 900, epoch: 7 | loss: 0.4774508
	speed: 0.0040s/iter; left time: 4.6203s
	iters: 1000, epoch: 7 | loss: 0.8211920
	speed: 0.0040s/iter; left time: 4.2311s
Updating learning rate to 7.0474765140625e-06
Epoch: 7 cost time: 4.228482484817505
Epoch: 7, Steps: 1027 | Train Loss: 0.5914063 Vali Loss: 0.3862484 Best vali loss: 0.3685989
	iters: 100, epoch: 8 | loss: 0.8849558
	speed: 0.0110s/iter; left time: 10.2322s
	iters: 200, epoch: 8 | loss: 0.4889288
	speed: 0.0042s/iter; left time: 3.4879s
	iters: 300, epoch: 8 | loss: 0.2459088
	speed: 0.0043s/iter; left time: 3.1043s
	iters: 400, epoch: 8 | loss: 0.3310621
	speed: 0.0043s/iter; left time: 2.6850s
	iters: 500, epoch: 8 | loss: 0.2272447
	speed: 0.0043s/iter; left time: 2.2475s
	iters: 600, epoch: 8 | loss: 0.4518394
	speed: 0.0043s/iter; left time: 1.8275s
	iters: 700, epoch: 8 | loss: 0.4775539
	speed: 0.0042s/iter; left time: 1.3911s
	iters: 800, epoch: 8 | loss: 0.4579450
	speed: 0.0042s/iter; left time: 0.9646s
	iters: 900, epoch: 8 | loss: 0.1926482
	speed: 0.0042s/iter; left time: 0.5413s
	iters: 1000, epoch: 8 | loss: 0.2347989
	speed: 0.0042s/iter; left time: 0.1173s
Updating learning rate to 3.52373825703125e-06
Epoch: 8 cost time: 4.394607067108154
Epoch: 8, Steps: 1027 | Train Loss: 0.3992885 Vali Loss: 0.3882484 Best vali loss: 0.3685989

best validation loss 0.3685988667905916

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0063013326668, 'e_layers': 3, 'learning_rate': 0.0003944337463, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0714841
	speed: 0.0104s/iter; left time: 84.2120s
	iters: 200, epoch: 1 | loss: 0.4115744
	speed: 0.0043s/iter; left time: 34.2085s
	iters: 300, epoch: 1 | loss: 1.4261206
	speed: 0.0043s/iter; left time: 33.7155s
	iters: 400, epoch: 1 | loss: 1.1543586
	speed: 0.0042s/iter; left time: 33.1417s
	iters: 500, epoch: 1 | loss: 0.7253771
	speed: 0.0042s/iter; left time: 32.7193s
	iters: 600, epoch: 1 | loss: 0.5056810
	speed: 0.0043s/iter; left time: 32.8085s
	iters: 700, epoch: 1 | loss: 0.2278334
	speed: 0.0043s/iter; left time: 32.2457s
	iters: 800, epoch: 1 | loss: 0.8600589
	speed: 0.0042s/iter; left time: 31.4245s
	iters: 900, epoch: 1 | loss: 0.3505011
	speed: 0.0041s/iter; left time: 30.2710s
	iters: 1000, epoch: 1 | loss: 0.9166477
	speed: 0.0042s/iter; left time: 30.4230s
Updating learning rate to 0.0003944337463
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 4.696681976318359
Epoch: 1, Steps: 1027 | Train Loss: 0.7649637 Vali Loss: 0.3737060 Best vali loss: 0.3737060
	iters: 100, epoch: 2 | loss: 1.6079379
	speed: 0.0116s/iter; left time: 82.0097s
	iters: 200, epoch: 2 | loss: 1.0313410
	speed: 0.0043s/iter; left time: 29.9327s
	iters: 300, epoch: 2 | loss: 1.1900374
	speed: 0.0043s/iter; left time: 29.3590s
	iters: 400, epoch: 2 | loss: 0.6512806
	speed: 0.0043s/iter; left time: 29.0829s
	iters: 500, epoch: 2 | loss: 0.3321673
	speed: 0.0043s/iter; left time: 28.5588s
	iters: 600, epoch: 2 | loss: 0.2188983
	speed: 0.0043s/iter; left time: 28.1982s
	iters: 700, epoch: 2 | loss: 0.6870174
	speed: 0.0043s/iter; left time: 27.7208s
	iters: 800, epoch: 2 | loss: 0.6188728
	speed: 0.0043s/iter; left time: 27.3493s
	iters: 900, epoch: 2 | loss: 1.0137516
	speed: 0.0043s/iter; left time: 26.9309s
	iters: 1000, epoch: 2 | loss: 0.9616558
	speed: 0.0043s/iter; left time: 26.4807s
Updating learning rate to 0.00019721687315
Epoch: 2 cost time: 4.432702302932739
Epoch: 2, Steps: 1027 | Train Loss: 0.8312960 Vali Loss: 0.3817593 Best vali loss: 0.3737060
	iters: 100, epoch: 3 | loss: 1.0355961
	speed: 0.0114s/iter; left time: 69.0858s
	iters: 200, epoch: 3 | loss: 0.2781391
	speed: 0.0043s/iter; left time: 25.5758s
	iters: 300, epoch: 3 | loss: 0.3911336
	speed: 0.0043s/iter; left time: 25.1260s
	iters: 400, epoch: 3 | loss: 0.8913431
	speed: 0.0043s/iter; left time: 24.7185s
	iters: 500, epoch: 3 | loss: 0.3055921
	speed: 0.0043s/iter; left time: 24.4426s
	iters: 600, epoch: 3 | loss: 0.4558622
	speed: 0.0043s/iter; left time: 23.7971s
	iters: 700, epoch: 3 | loss: 0.5715426
	speed: 0.0043s/iter; left time: 23.3048s
	iters: 800, epoch: 3 | loss: 0.8265209
	speed: 0.0043s/iter; left time: 23.0734s
	iters: 900, epoch: 3 | loss: 0.3594306
	speed: 0.0043s/iter; left time: 22.4984s
	iters: 1000, epoch: 3 | loss: 1.2541801
	speed: 0.0043s/iter; left time: 22.1502s
Updating learning rate to 9.8608436575e-05
Epoch: 3 cost time: 4.444410562515259
Epoch: 3, Steps: 1027 | Train Loss: 0.6369340 Vali Loss: 0.3756577 Best vali loss: 0.3737060
	iters: 100, epoch: 4 | loss: 0.3268538
	speed: 0.0108s/iter; left time: 54.1405s
	iters: 200, epoch: 4 | loss: 0.2473980
	speed: 0.0036s/iter; left time: 17.7650s
	iters: 300, epoch: 4 | loss: 1.1220762
	speed: 0.0036s/iter; left time: 17.4066s
	iters: 400, epoch: 4 | loss: 0.3057314
	speed: 0.0036s/iter; left time: 17.0161s
	iters: 500, epoch: 4 | loss: 1.3037051
	speed: 0.0036s/iter; left time: 16.5731s
	iters: 600, epoch: 4 | loss: 0.4946894
	speed: 0.0039s/iter; left time: 17.9062s
	iters: 700, epoch: 4 | loss: 0.3306006
	speed: 0.0039s/iter; left time: 17.3851s
	iters: 800, epoch: 4 | loss: 0.1760837
	speed: 0.0039s/iter; left time: 16.9306s
	iters: 900, epoch: 4 | loss: 0.4090967
	speed: 0.0038s/iter; left time: 16.2332s
	iters: 1000, epoch: 4 | loss: 0.6592168
	speed: 0.0038s/iter; left time: 15.5853s
Updating learning rate to 4.93042182875e-05
Epoch: 4 cost time: 3.8894736766815186
Epoch: 4, Steps: 1027 | Train Loss: 0.5375452 Vali Loss: 0.3990169 Best vali loss: 0.3737060
	iters: 100, epoch: 5 | loss: 0.3558824
	speed: 0.0110s/iter; left time: 43.9146s
	iters: 200, epoch: 5 | loss: 0.5065718
	speed: 0.0040s/iter; left time: 15.6378s
	iters: 300, epoch: 5 | loss: 0.3142648
	speed: 0.0040s/iter; left time: 15.2312s
	iters: 400, epoch: 5 | loss: 0.3233335
	speed: 0.0040s/iter; left time: 14.8421s
	iters: 500, epoch: 5 | loss: 0.4467906
	speed: 0.0040s/iter; left time: 14.4299s
	iters: 600, epoch: 5 | loss: 0.6502546
	speed: 0.0040s/iter; left time: 14.0361s
	iters: 700, epoch: 5 | loss: 0.5760373
	speed: 0.0040s/iter; left time: 13.6406s
	iters: 800, epoch: 5 | loss: 0.7906880
	speed: 0.0040s/iter; left time: 13.2326s
	iters: 900, epoch: 5 | loss: 0.3860499
	speed: 0.0040s/iter; left time: 12.8403s
	iters: 1000, epoch: 5 | loss: 0.4025434
	speed: 0.0040s/iter; left time: 12.4371s
Updating learning rate to 2.465210914375e-05
Epoch: 5 cost time: 4.14840841293335
Epoch: 5, Steps: 1027 | Train Loss: 0.4752416 Vali Loss: 0.3879447 Best vali loss: 0.3737060
	iters: 100, epoch: 6 | loss: 0.6092156
	speed: 0.0109s/iter; left time: 32.4409s
	iters: 200, epoch: 6 | loss: 0.5442372
	speed: 0.0043s/iter; left time: 12.5253s
	iters: 300, epoch: 6 | loss: 0.7205277
	speed: 0.0044s/iter; left time: 12.1238s
	iters: 400, epoch: 6 | loss: 0.3788844
	speed: 0.0042s/iter; left time: 11.1778s
	iters: 500, epoch: 6 | loss: 0.6638787
	speed: 0.0040s/iter; left time: 10.3244s
	iters: 600, epoch: 6 | loss: 0.9781602
	speed: 0.0040s/iter; left time: 9.9771s
	iters: 700, epoch: 6 | loss: 0.2878155
	speed: 0.0040s/iter; left time: 9.5279s
	iters: 800, epoch: 6 | loss: 0.3686791
	speed: 0.0040s/iter; left time: 9.1292s
	iters: 900, epoch: 6 | loss: 0.4130839
	speed: 0.0041s/iter; left time: 8.8866s
	iters: 1000, epoch: 6 | loss: 0.3426599
	speed: 0.0043s/iter; left time: 9.0066s
Updating learning rate to 1.2326054571875e-05
Epoch: 6 cost time: 4.292691230773926
Epoch: 6, Steps: 1027 | Train Loss: 0.5307142 Vali Loss: 0.3851694 Best vali loss: 0.3737060
	iters: 100, epoch: 7 | loss: 0.2679805
	speed: 0.0113s/iter; left time: 22.0221s
	iters: 200, epoch: 7 | loss: 0.2042460
	speed: 0.0040s/iter; left time: 7.4183s
	iters: 300, epoch: 7 | loss: 0.3336912
	speed: 0.0040s/iter; left time: 7.0171s
	iters: 400, epoch: 7 | loss: 0.5699387
	speed: 0.0040s/iter; left time: 6.6247s
	iters: 500, epoch: 7 | loss: 0.2733107
	speed: 0.0040s/iter; left time: 6.2328s
	iters: 600, epoch: 7 | loss: 0.3380892
	speed: 0.0040s/iter; left time: 5.8216s
	iters: 700, epoch: 7 | loss: 0.3222404
	speed: 0.0043s/iter; left time: 5.8609s
	iters: 800, epoch: 7 | loss: 0.5028752
	speed: 0.0043s/iter; left time: 5.3628s
	iters: 900, epoch: 7 | loss: 0.3788839
	speed: 0.0042s/iter; left time: 4.8999s
	iters: 1000, epoch: 7 | loss: 0.6689696
	speed: 0.0042s/iter; left time: 4.4359s
Updating learning rate to 6.1630272859375e-06
Epoch: 7 cost time: 4.277150392532349
Epoch: 7, Steps: 1027 | Train Loss: 0.3860225 Vali Loss: 0.3921709 Best vali loss: 0.3737060
	iters: 100, epoch: 8 | loss: 0.5156447
	speed: 0.0113s/iter; left time: 10.4591s
	iters: 200, epoch: 8 | loss: 0.4966694
	speed: 0.0042s/iter; left time: 3.4862s
	iters: 300, epoch: 8 | loss: 0.3097896
	speed: 0.0043s/iter; left time: 3.0994s
	iters: 400, epoch: 8 | loss: 1.1362426
	speed: 0.0042s/iter; left time: 2.6619s
	iters: 500, epoch: 8 | loss: 0.5191086
	speed: 0.0040s/iter; left time: 2.1109s
	iters: 600, epoch: 8 | loss: 0.4861313
	speed: 0.0040s/iter; left time: 1.7164s
	iters: 700, epoch: 8 | loss: 0.8388645
	speed: 0.0040s/iter; left time: 1.3119s
	iters: 800, epoch: 8 | loss: 1.4223450
	speed: 0.0040s/iter; left time: 0.9121s
	iters: 900, epoch: 8 | loss: 1.0334983
	speed: 0.0040s/iter; left time: 0.5104s
	iters: 1000, epoch: 8 | loss: 0.3056432
	speed: 0.0040s/iter; left time: 0.1120s
Updating learning rate to 3.08151364296875e-06
Epoch: 8 cost time: 4.233858346939087
Epoch: 8, Steps: 1027 | Train Loss: 0.7063937 Vali Loss: 0.3894510 Best vali loss: 0.3737060

best validation loss 0.37370597752349083

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0018857677737, 'e_layers': 4, 'learning_rate': 5.09987881e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3932902
	speed: 0.0112s/iter; left time: 91.1456s
	iters: 200, epoch: 1 | loss: 0.5463061
	speed: 0.0051s/iter; left time: 40.5667s
	iters: 300, epoch: 1 | loss: 0.4490503
	speed: 0.0051s/iter; left time: 40.1743s
	iters: 400, epoch: 1 | loss: 1.2020370
	speed: 0.0050s/iter; left time: 39.1223s
	iters: 500, epoch: 1 | loss: 1.4859846
	speed: 0.0051s/iter; left time: 39.0849s
	iters: 600, epoch: 1 | loss: 0.6228419
	speed: 0.0050s/iter; left time: 38.4602s
	iters: 700, epoch: 1 | loss: 0.8651369
	speed: 0.0051s/iter; left time: 37.9788s
	iters: 800, epoch: 1 | loss: 0.3021196
	speed: 0.0051s/iter; left time: 37.7555s
	iters: 900, epoch: 1 | loss: 0.6052529
	speed: 0.0050s/iter; left time: 36.7868s
	iters: 1000, epoch: 1 | loss: 0.3342447
	speed: 0.0050s/iter; left time: 36.2394s
Updating learning rate to 4.905776230423509e-05
Validation loss decreased (inf --> 0.3639).  Saving model state dict ...
Epoch: 1 cost time: 5.536401987075806
Epoch: 1, Steps: 1027 | Train Loss: 0.6806264 Vali Loss: 0.3638627 Best vali loss: 0.3638627
	iters: 100, epoch: 2 | loss: 1.6579744
	speed: 0.0131s/iter; left time: 92.9766s
	iters: 200, epoch: 2 | loss: 0.9931964
	speed: 0.0047s/iter; left time: 32.7848s
	iters: 300, epoch: 2 | loss: 0.9833826
	speed: 0.0049s/iter; left time: 33.4898s
	iters: 400, epoch: 2 | loss: 0.4630163
	speed: 0.0046s/iter; left time: 31.2912s
	iters: 500, epoch: 2 | loss: 0.9239979
	speed: 0.0046s/iter; left time: 31.0356s
	iters: 600, epoch: 2 | loss: 0.8727363
	speed: 0.0046s/iter; left time: 30.1705s
	iters: 700, epoch: 2 | loss: 0.9791945
	speed: 0.0046s/iter; left time: 30.0823s
	iters: 800, epoch: 2 | loss: 0.3171001
	speed: 0.0046s/iter; left time: 29.5290s
	iters: 900, epoch: 2 | loss: 1.1459153
	speed: 0.0046s/iter; left time: 29.2043s
	iters: 1000, epoch: 2 | loss: 1.1531451
	speed: 0.0046s/iter; left time: 28.4257s
Updating learning rate to 4.35301884989029e-05
Validation loss decreased (0.3639 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 4.809821367263794
Epoch: 2, Steps: 1027 | Train Loss: 0.9489659 Vali Loss: 0.3629739 Best vali loss: 0.3629739
	iters: 100, epoch: 3 | loss: 1.2612016
	speed: 0.0136s/iter; left time: 82.6394s
	iters: 200, epoch: 3 | loss: 0.4845564
	speed: 0.0051s/iter; left time: 30.5816s
	iters: 300, epoch: 3 | loss: 0.3048436
	speed: 0.0051s/iter; left time: 30.0891s
	iters: 400, epoch: 3 | loss: 0.8637005
	speed: 0.0051s/iter; left time: 29.6368s
	iters: 500, epoch: 3 | loss: 0.4588153
	speed: 0.0052s/iter; left time: 29.4797s
	iters: 600, epoch: 3 | loss: 0.3722228
	speed: 0.0053s/iter; left time: 29.6608s
	iters: 700, epoch: 3 | loss: 0.4466344
	speed: 0.0052s/iter; left time: 28.3985s
	iters: 800, epoch: 3 | loss: 0.5148036
	speed: 0.0051s/iter; left time: 27.4101s
	iters: 900, epoch: 3 | loss: 1.5198712
	speed: 0.0051s/iter; left time: 26.8463s
	iters: 1000, epoch: 3 | loss: 1.0237335
	speed: 0.0050s/iter; left time: 25.7926s
Updating learning rate to 3.525758968828395e-05
Epoch: 3 cost time: 5.3264477252960205
Epoch: 3, Steps: 1027 | Train Loss: 0.7250383 Vali Loss: 0.3679027 Best vali loss: 0.3629739

best validation loss 0.3629739421992499

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010714454021, 'e_layers': 4, 'learning_rate': 5.84284068e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3899223
	speed: 0.0115s/iter; left time: 93.1214s
	iters: 200, epoch: 1 | loss: 0.5433695
	speed: 0.0050s/iter; left time: 40.2142s
	iters: 300, epoch: 1 | loss: 0.4509968
	speed: 0.0050s/iter; left time: 39.4244s
	iters: 400, epoch: 1 | loss: 1.2008636
	speed: 0.0050s/iter; left time: 39.4527s
	iters: 500, epoch: 1 | loss: 1.4789639
	speed: 0.0050s/iter; left time: 38.3173s
	iters: 600, epoch: 1 | loss: 0.6242912
	speed: 0.0050s/iter; left time: 38.0276s
	iters: 700, epoch: 1 | loss: 0.8835059
	speed: 0.0050s/iter; left time: 37.3399s
	iters: 800, epoch: 1 | loss: 0.3038500
	speed: 0.0050s/iter; left time: 36.9585s
	iters: 900, epoch: 1 | loss: 0.6082468
	speed: 0.0052s/iter; left time: 38.1269s
	iters: 1000, epoch: 1 | loss: 0.3331635
	speed: 0.0052s/iter; left time: 37.8627s
Updating learning rate to 5.620460797988164e-05
Validation loss decreased (inf --> 0.3623).  Saving model state dict ...
Epoch: 1 cost time: 5.562973737716675
Epoch: 1, Steps: 1027 | Train Loss: 0.6817173 Vali Loss: 0.3623034 Best vali loss: 0.3623034
	iters: 100, epoch: 2 | loss: 1.6402571
	speed: 0.0137s/iter; left time: 97.2078s
	iters: 200, epoch: 2 | loss: 0.9913924
	speed: 0.0051s/iter; left time: 35.9185s
	iters: 300, epoch: 2 | loss: 0.9616045
	speed: 0.0051s/iter; left time: 35.0795s
	iters: 400, epoch: 2 | loss: 0.4480643
	speed: 0.0050s/iter; left time: 33.8582s
	iters: 500, epoch: 2 | loss: 0.9307922
	speed: 0.0049s/iter; left time: 32.9205s
	iters: 600, epoch: 2 | loss: 0.8940488
	speed: 0.0049s/iter; left time: 32.2163s
	iters: 700, epoch: 2 | loss: 0.9582804
	speed: 0.0049s/iter; left time: 32.0244s
	iters: 800, epoch: 2 | loss: 0.3282564
	speed: 0.0050s/iter; left time: 31.6756s
	iters: 900, epoch: 2 | loss: 1.1650977
	speed: 0.0049s/iter; left time: 30.9864s
	iters: 1000, epoch: 2 | loss: 1.1519516
	speed: 0.0049s/iter; left time: 30.5205s
Updating learning rate to 4.987176473110309e-05
Validation loss decreased (0.3623 --> 0.3608).  Saving model state dict ...
Epoch: 2 cost time: 5.175623416900635
Epoch: 2, Steps: 1027 | Train Loss: 0.9469745 Vali Loss: 0.3607545 Best vali loss: 0.3607545
	iters: 100, epoch: 3 | loss: 1.2162347
	speed: 0.0133s/iter; left time: 80.5051s
	iters: 200, epoch: 3 | loss: 0.4499064
	speed: 0.0050s/iter; left time: 29.5456s
	iters: 300, epoch: 3 | loss: 0.3067459
	speed: 0.0050s/iter; left time: 29.0284s
	iters: 400, epoch: 3 | loss: 0.8484096
	speed: 0.0049s/iter; left time: 28.2549s
	iters: 500, epoch: 3 | loss: 0.4703439
	speed: 0.0049s/iter; left time: 28.0177s
	iters: 600, epoch: 3 | loss: 0.3552921
	speed: 0.0049s/iter; left time: 27.3959s
	iters: 700, epoch: 3 | loss: 0.4457869
	speed: 0.0050s/iter; left time: 27.0486s
	iters: 800, epoch: 3 | loss: 0.4314227
	speed: 0.0049s/iter; left time: 26.4480s
	iters: 900, epoch: 3 | loss: 1.4821682
	speed: 0.0050s/iter; left time: 26.2376s
	iters: 1000, epoch: 3 | loss: 1.0069314
	speed: 0.0050s/iter; left time: 25.7075s
Updating learning rate to 4.039399503092388e-05
Validation loss decreased (0.3608 --> 0.3595).  Saving model state dict ...
Epoch: 3 cost time: 5.125337839126587
Epoch: 3, Steps: 1027 | Train Loss: 0.7013242 Vali Loss: 0.3595254 Best vali loss: 0.3595254

best validation loss 0.359525364485143

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0054691389447, 'e_layers': 3, 'learning_rate': 5.47932343e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0724401
	speed: 0.0114s/iter; left time: 10.6317s
Updating learning rate to 5.2707790994932696e-05
Validation loss decreased (inf --> 0.4156).  Saving model state dict ...
Epoch: 1 cost time: 1.0144777297973633
Epoch: 1, Steps: 129 | Train Loss: 1.0724401 Vali Loss: 0.4156060 Best vali loss: 0.4156060
	iters: 100, epoch: 2 | loss: 0.4411806
	speed: 0.0087s/iter; left time: 6.9579s
Updating learning rate to 4.6768950918336664e-05
Validation loss decreased (0.4156 --> 0.3975).  Saving model state dict ...
Epoch: 2 cost time: 0.711634635925293
Epoch: 2, Steps: 129 | Train Loss: 0.4411806 Vali Loss: 0.3974674 Best vali loss: 0.3974674
	iters: 100, epoch: 3 | loss: 0.7207628
	speed: 0.0079s/iter; left time: 5.3026s
Updating learning rate to 3.7880848636154286e-05
Validation loss decreased (0.3975 --> 0.3871).  Saving model state dict ...
Epoch: 3 cost time: 0.6076936721801758
Epoch: 3, Steps: 129 | Train Loss: 0.7207628 Vali Loss: 0.3870970 Best vali loss: 0.3870970

best validation loss 0.38709696503191426

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010714454021, 'e_layers': 4, 'learning_rate': 5.84284068e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3506728
	speed: 0.0117s/iter; left time: 58.7843s
	iters: 200, epoch: 4 | loss: 0.4010552
	speed: 0.0049s/iter; left time: 24.0557s
	iters: 300, epoch: 4 | loss: 0.3862208
	speed: 0.0049s/iter; left time: 23.5087s
	iters: 400, epoch: 4 | loss: 0.8877358
	speed: 0.0049s/iter; left time: 23.2976s
	iters: 500, epoch: 4 | loss: 0.9855909
	speed: 0.0048s/iter; left time: 22.2061s
	iters: 600, epoch: 4 | loss: 0.5132917
	speed: 0.0047s/iter; left time: 21.0960s
	iters: 700, epoch: 4 | loss: 0.5036320
	speed: 0.0047s/iter; left time: 20.6640s
	iters: 800, epoch: 4 | loss: 0.2542172
	speed: 0.0046s/iter; left time: 20.0043s
	iters: 900, epoch: 4 | loss: 0.4005725
	speed: 0.0046s/iter; left time: 19.4819s
	iters: 1000, epoch: 4 | loss: 0.3199631
	speed: 0.0046s/iter; left time: 19.1868s
Updating learning rate to 2.92142034e-05
Validation loss decreased (0.3595 --> 0.3578).  Saving model state dict ...
Epoch: 4 cost time: 5.234374523162842
Epoch: 4, Steps: 1027 | Train Loss: 0.5002952 Vali Loss: 0.3578121 Best vali loss: 0.3578121
	iters: 100, epoch: 5 | loss: 1.4026823
	speed: 0.0132s/iter; left time: 52.9696s
	iters: 200, epoch: 5 | loss: 0.8971250
	speed: 0.0048s/iter; left time: 18.9499s
	iters: 300, epoch: 5 | loss: 0.7555808
	speed: 0.0048s/iter; left time: 18.3278s
	iters: 400, epoch: 5 | loss: 0.4106460
	speed: 0.0048s/iter; left time: 17.9012s
	iters: 500, epoch: 5 | loss: 0.8611637
	speed: 0.0048s/iter; left time: 17.4606s
	iters: 600, epoch: 5 | loss: 0.7657623
	speed: 0.0048s/iter; left time: 16.6787s
	iters: 700, epoch: 5 | loss: 0.7762663
	speed: 0.0047s/iter; left time: 16.1583s
	iters: 800, epoch: 5 | loss: 0.2550447
	speed: 0.0048s/iter; left time: 15.9708s
	iters: 900, epoch: 5 | loss: 0.9338263
	speed: 0.0048s/iter; left time: 15.5243s
	iters: 1000, epoch: 5 | loss: 0.8795484
	speed: 0.0046s/iter; left time: 14.4300s
Updating learning rate to 1.8034411769076126e-05
Validation loss decreased (0.3578 --> 0.3522).  Saving model state dict ...
Epoch: 5 cost time: 4.951716184616089
Epoch: 5, Steps: 1027 | Train Loss: 0.7937646 Vali Loss: 0.3522340 Best vali loss: 0.3522340
	iters: 100, epoch: 6 | loss: 0.8897505
	speed: 0.0135s/iter; left time: 40.2624s
	iters: 200, epoch: 6 | loss: 0.3761738
	speed: 0.0053s/iter; left time: 15.1542s
	iters: 300, epoch: 6 | loss: 0.2944629
	speed: 0.0052s/iter; left time: 14.5807s
	iters: 400, epoch: 6 | loss: 0.4526201
	speed: 0.0052s/iter; left time: 14.0167s
	iters: 500, epoch: 6 | loss: 0.3716005
	speed: 0.0052s/iter; left time: 13.5370s
	iters: 600, epoch: 6 | loss: 0.3358622
	speed: 0.0052s/iter; left time: 12.8524s
	iters: 700, epoch: 6 | loss: 0.4460014
	speed: 0.0050s/iter; left time: 11.9515s
	iters: 800, epoch: 6 | loss: 0.3011189
	speed: 0.0049s/iter; left time: 11.2952s
	iters: 900, epoch: 6 | loss: 1.2493641
	speed: 0.0049s/iter; left time: 10.7623s
	iters: 1000, epoch: 6 | loss: 0.8439968
	speed: 0.0050s/iter; left time: 10.3455s
Updating learning rate to 8.55664206889691e-06
Epoch: 6 cost time: 5.304033279418945
Epoch: 6, Steps: 1027 | Train Loss: 0.5560951 Vali Loss: 0.3571866 Best vali loss: 0.3522340
	iters: 100, epoch: 7 | loss: 0.5178195
	speed: 0.0127s/iter; left time: 24.8300s
	iters: 200, epoch: 7 | loss: 0.2333220
	speed: 0.0047s/iter; left time: 8.6514s
	iters: 300, epoch: 7 | loss: 1.2341969
	speed: 0.0049s/iter; left time: 8.5933s
	iters: 400, epoch: 7 | loss: 0.1794506
	speed: 0.0049s/iter; left time: 8.1421s
	iters: 500, epoch: 7 | loss: 0.7376033
	speed: 0.0049s/iter; left time: 7.5824s
	iters: 600, epoch: 7 | loss: 0.3144391
	speed: 0.0049s/iter; left time: 7.1654s
	iters: 700, epoch: 7 | loss: 0.2795417
	speed: 0.0049s/iter; left time: 6.6879s
	iters: 800, epoch: 7 | loss: 0.3838220
	speed: 0.0049s/iter; left time: 6.1460s
	iters: 900, epoch: 7 | loss: 0.3096944
	speed: 0.0049s/iter; left time: 5.6465s
	iters: 1000, epoch: 7 | loss: 0.4935484
	speed: 0.0047s/iter; left time: 4.9527s
Updating learning rate to 2.2237988201183565e-06
Epoch: 7 cost time: 5.003706932067871
Epoch: 7, Steps: 1027 | Train Loss: 0.4683438 Vali Loss: 0.3628412 Best vali loss: 0.3522340
	iters: 100, epoch: 8 | loss: 0.3120578
	speed: 0.0124s/iter; left time: 11.4699s
	iters: 200, epoch: 8 | loss: 0.3374366
	speed: 0.0045s/iter; left time: 3.7622s
	iters: 300, epoch: 8 | loss: 0.4265547
	speed: 0.0046s/iter; left time: 3.3365s
	iters: 400, epoch: 8 | loss: 0.5119841
	speed: 0.0045s/iter; left time: 2.8513s
	iters: 500, epoch: 8 | loss: 0.1986063
	speed: 0.0046s/iter; left time: 2.4114s
	iters: 600, epoch: 8 | loss: 0.1902237
	speed: 0.0046s/iter; left time: 1.9493s
	iters: 700, epoch: 8 | loss: 0.4963349
	speed: 0.0046s/iter; left time: 1.4938s
	iters: 800, epoch: 8 | loss: 0.5362108
	speed: 0.0046s/iter; left time: 1.0381s
	iters: 900, epoch: 8 | loss: 0.3816829
	speed: 0.0045s/iter; left time: 0.5820s
	iters: 1000, epoch: 8 | loss: 0.3291126
	speed: 0.0045s/iter; left time: 0.1272s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.7172605991363525
Epoch: 8, Steps: 1027 | Train Loss: 0.3720204 Vali Loss: 0.3691915 Best vali loss: 0.3522340

best validation loss 0.3522339885736027

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010631971247, 'e_layers': 3, 'learning_rate': 6.53393756e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5528082
	speed: 0.0102s/iter; left time: 82.4974s
	iters: 200, epoch: 1 | loss: 0.6612539
	speed: 0.0041s/iter; left time: 33.2017s
	iters: 300, epoch: 1 | loss: 1.0559156
	speed: 0.0041s/iter; left time: 32.4157s
	iters: 400, epoch: 1 | loss: 0.7057127
	speed: 0.0042s/iter; left time: 32.7626s
	iters: 500, epoch: 1 | loss: 0.5069942
	speed: 0.0042s/iter; left time: 32.1006s
	iters: 600, epoch: 1 | loss: 1.2505062
	speed: 0.0037s/iter; left time: 28.5626s
	iters: 700, epoch: 1 | loss: 0.6127774
	speed: 0.0036s/iter; left time: 27.3849s
	iters: 800, epoch: 1 | loss: 1.0820267
	speed: 0.0038s/iter; left time: 28.4067s
	iters: 900, epoch: 1 | loss: 0.8938575
	speed: 0.0036s/iter; left time: 26.5912s
	iters: 1000, epoch: 1 | loss: 0.6815798
	speed: 0.0037s/iter; left time: 26.7641s
Updating learning rate to 6.285254369195368e-05
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 4.366361141204834
Epoch: 1, Steps: 1027 | Train Loss: 0.8003432 Vali Loss: 0.3646703 Best vali loss: 0.3646703
	iters: 100, epoch: 2 | loss: 0.1745282
	speed: 0.0106s/iter; left time: 75.2521s
	iters: 200, epoch: 2 | loss: 0.7775553
	speed: 0.0040s/iter; left time: 27.7027s
	iters: 300, epoch: 2 | loss: 1.3141303
	speed: 0.0043s/iter; left time: 29.5597s
	iters: 400, epoch: 2 | loss: 0.5703807
	speed: 0.0043s/iter; left time: 29.0389s
	iters: 500, epoch: 2 | loss: 0.3836499
	speed: 0.0043s/iter; left time: 28.8562s
	iters: 600, epoch: 2 | loss: 1.5581337
	speed: 0.0043s/iter; left time: 28.5152s
	iters: 700, epoch: 2 | loss: 1.0927094
	speed: 0.0043s/iter; left time: 28.0060s
	iters: 800, epoch: 2 | loss: 1.3271835
	speed: 0.0043s/iter; left time: 27.6001s
	iters: 900, epoch: 2 | loss: 1.4528927
	speed: 0.0043s/iter; left time: 27.1412s
	iters: 1000, epoch: 2 | loss: 1.0187541
	speed: 0.0043s/iter; left time: 26.5965s
Updating learning rate to 5.577064558262742e-05
Validation loss decreased (0.3647 --> 0.3618).  Saving model state dict ...
Epoch: 2 cost time: 4.349963188171387
Epoch: 2, Steps: 1027 | Train Loss: 0.9669918 Vali Loss: 0.3618218 Best vali loss: 0.3618218
	iters: 100, epoch: 3 | loss: 0.2809667
	speed: 0.0110s/iter; left time: 66.6539s
	iters: 200, epoch: 3 | loss: 0.3425679
	speed: 0.0040s/iter; left time: 23.8043s
	iters: 300, epoch: 3 | loss: 0.7447782
	speed: 0.0040s/iter; left time: 23.3876s
	iters: 400, epoch: 3 | loss: 0.3328400
	speed: 0.0040s/iter; left time: 22.8291s
	iters: 500, epoch: 3 | loss: 0.4843106
	speed: 0.0040s/iter; left time: 22.6441s
	iters: 600, epoch: 3 | loss: 0.3451529
	speed: 0.0039s/iter; left time: 21.8710s
	iters: 700, epoch: 3 | loss: 0.9590411
	speed: 0.0040s/iter; left time: 21.6310s
	iters: 800, epoch: 3 | loss: 0.6779316
	speed: 0.0039s/iter; left time: 20.9717s
	iters: 900, epoch: 3 | loss: 0.4790447
	speed: 0.0039s/iter; left time: 20.5802s
	iters: 1000, epoch: 3 | loss: 1.0599051
	speed: 0.0039s/iter; left time: 20.0948s
Updating learning rate to 4.51718360615999e-05
Validation loss decreased (0.3618 --> 0.3573).  Saving model state dict ...
Epoch: 3 cost time: 4.097306966781616
Epoch: 3, Steps: 1027 | Train Loss: 0.5706539 Vali Loss: 0.3573346 Best vali loss: 0.3573346
	iters: 100, epoch: 4 | loss: 0.9529080
	speed: 0.0113s/iter; left time: 56.7155s
	iters: 200, epoch: 4 | loss: 0.2606409
	speed: 0.0042s/iter; left time: 20.7986s
	iters: 300, epoch: 4 | loss: 0.3321402
	speed: 0.0042s/iter; left time: 20.3884s
	iters: 400, epoch: 4 | loss: 0.6098663
	speed: 0.0042s/iter; left time: 20.0342s
	iters: 500, epoch: 4 | loss: 0.2622979
	speed: 0.0041s/iter; left time: 19.1510s
	iters: 600, epoch: 4 | loss: 0.3812001
	speed: 0.0040s/iter; left time: 18.0662s
	iters: 700, epoch: 4 | loss: 0.2775749
	speed: 0.0038s/iter; left time: 16.8384s
	iters: 800, epoch: 4 | loss: 0.6573380
	speed: 0.0038s/iter; left time: 16.4209s
	iters: 900, epoch: 4 | loss: 0.4290827
	speed: 0.0038s/iter; left time: 15.9763s
	iters: 1000, epoch: 4 | loss: 0.3494450
	speed: 0.0038s/iter; left time: 15.6336s
Updating learning rate to 3.26696878e-05
Epoch: 4 cost time: 4.152200222015381
Epoch: 4, Steps: 1027 | Train Loss: 0.4512494 Vali Loss: 0.3625027 Best vali loss: 0.3573346
	iters: 100, epoch: 5 | loss: 0.3723395
	speed: 0.0105s/iter; left time: 42.2316s
	iters: 200, epoch: 5 | loss: 0.2330606
	speed: 0.0037s/iter; left time: 14.3986s
	iters: 300, epoch: 5 | loss: 0.2508215
	speed: 0.0038s/iter; left time: 14.6246s
	iters: 400, epoch: 5 | loss: 0.5072837
	speed: 0.0039s/iter; left time: 14.6483s
	iters: 500, epoch: 5 | loss: 0.7773045
	speed: 0.0040s/iter; left time: 14.2966s
	iters: 600, epoch: 5 | loss: 0.2063423
	speed: 0.0040s/iter; left time: 13.9120s
	iters: 700, epoch: 5 | loss: 1.0098370
	speed: 0.0040s/iter; left time: 13.4848s
	iters: 800, epoch: 5 | loss: 0.5223638
	speed: 0.0039s/iter; left time: 12.9734s
	iters: 900, epoch: 5 | loss: 0.6567541
	speed: 0.0040s/iter; left time: 12.7005s
	iters: 1000, epoch: 5 | loss: 0.6305406
	speed: 0.0040s/iter; left time: 12.4359s
Updating learning rate to 2.0167539538400104e-05
Epoch: 5 cost time: 4.049293279647827
Epoch: 5, Steps: 1027 | Train Loss: 0.5166648 Vali Loss: 0.3662478 Best vali loss: 0.3573346
	iters: 100, epoch: 6 | loss: 0.8815702
	speed: 0.0109s/iter; left time: 32.5242s
	iters: 200, epoch: 6 | loss: 0.2995333
	speed: 0.0042s/iter; left time: 12.1416s
	iters: 300, epoch: 6 | loss: 0.3864466
	speed: 0.0043s/iter; left time: 11.9093s
	iters: 400, epoch: 6 | loss: 0.2887827
	speed: 0.0042s/iter; left time: 11.3667s
	iters: 500, epoch: 6 | loss: 0.2774828
	speed: 0.0042s/iter; left time: 10.9010s
	iters: 600, epoch: 6 | loss: 0.3500515
	speed: 0.0043s/iter; left time: 10.5679s
	iters: 700, epoch: 6 | loss: 0.2517858
	speed: 0.0043s/iter; left time: 10.1303s
	iters: 800, epoch: 6 | loss: 0.2150697
	speed: 0.0042s/iter; left time: 9.6819s
	iters: 900, epoch: 6 | loss: 0.4992943
	speed: 0.0043s/iter; left time: 9.3226s
	iters: 1000, epoch: 6 | loss: 0.5226402
	speed: 0.0040s/iter; left time: 8.3423s
Updating learning rate to 9.56873001737258e-06
Epoch: 6 cost time: 4.362882614135742
Epoch: 6, Steps: 1027 | Train Loss: 0.3972657 Vali Loss: 0.3625436 Best vali loss: 0.3573346
	iters: 100, epoch: 7 | loss: 0.3691949
	speed: 0.0105s/iter; left time: 20.5015s
	iters: 200, epoch: 7 | loss: 0.3662331
	speed: 0.0038s/iter; left time: 7.0537s
	iters: 300, epoch: 7 | loss: 0.8982123
	speed: 0.0040s/iter; left time: 7.0337s
	iters: 400, epoch: 7 | loss: 0.5663028
	speed: 0.0040s/iter; left time: 6.5922s
	iters: 500, epoch: 7 | loss: 1.3866109
	speed: 0.0040s/iter; left time: 6.2043s
	iters: 600, epoch: 7 | loss: 0.3253655
	speed: 0.0040s/iter; left time: 5.8347s
	iters: 700, epoch: 7 | loss: 0.2681150
	speed: 0.0040s/iter; left time: 5.3802s
	iters: 800, epoch: 7 | loss: 0.7302741
	speed: 0.0040s/iter; left time: 5.0066s
	iters: 900, epoch: 7 | loss: 0.4475901
	speed: 0.0038s/iter; left time: 4.3467s
	iters: 1000, epoch: 7 | loss: 0.3040334
	speed: 0.0040s/iter; left time: 4.2161s
Updating learning rate to 2.486831908046312e-06
Epoch: 7 cost time: 4.069507122039795
Epoch: 7, Steps: 1027 | Train Loss: 0.5661932 Vali Loss: 0.3648099 Best vali loss: 0.3573346
	iters: 100, epoch: 8 | loss: 0.8041421
	speed: 0.0107s/iter; left time: 9.9753s
	iters: 200, epoch: 8 | loss: 0.2618457
	speed: 0.0040s/iter; left time: 3.2874s
	iters: 300, epoch: 8 | loss: 0.1713989
	speed: 0.0039s/iter; left time: 2.8707s
	iters: 400, epoch: 8 | loss: 0.3886774
	speed: 0.0040s/iter; left time: 2.4904s
	iters: 500, epoch: 8 | loss: 0.7362002
	speed: 0.0040s/iter; left time: 2.0984s
	iters: 600, epoch: 8 | loss: 0.2914540
	speed: 0.0039s/iter; left time: 1.6897s
	iters: 700, epoch: 8 | loss: 0.2991996
	speed: 0.0040s/iter; left time: 1.3059s
	iters: 800, epoch: 8 | loss: 0.3777525
	speed: 0.0040s/iter; left time: 0.9075s
	iters: 900, epoch: 8 | loss: 0.1933300
	speed: 0.0040s/iter; left time: 0.5117s
	iters: 1000, epoch: 8 | loss: 0.6837918
	speed: 0.0040s/iter; left time: 0.1117s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.118187665939331
Epoch: 8, Steps: 1027 | Train Loss: 0.4207792 Vali Loss: 0.3630881 Best vali loss: 0.3573346

best validation loss 0.3573346148773823

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010633997979, 'e_layers': 3, 'learning_rate': 6.92647357e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0527319
	speed: 0.0102s/iter; left time: 82.7490s
	iters: 200, epoch: 1 | loss: 0.4965909
	speed: 0.0042s/iter; left time: 33.8553s
	iters: 300, epoch: 1 | loss: 1.4042215
	speed: 0.0042s/iter; left time: 33.1005s
	iters: 400, epoch: 1 | loss: 0.8770643
	speed: 0.0043s/iter; left time: 33.2616s
	iters: 500, epoch: 1 | loss: 0.4582561
	speed: 0.0042s/iter; left time: 32.6167s
	iters: 600, epoch: 1 | loss: 0.2181437
	speed: 0.0042s/iter; left time: 31.6578s
	iters: 700, epoch: 1 | loss: 0.4386913
	speed: 0.0042s/iter; left time: 31.7347s
	iters: 800, epoch: 1 | loss: 0.5367961
	speed: 0.0042s/iter; left time: 31.4970s
	iters: 900, epoch: 1 | loss: 0.4003668
	speed: 0.0043s/iter; left time: 31.1392s
	iters: 1000, epoch: 1 | loss: 0.2758287
	speed: 0.0042s/iter; left time: 30.3190s
Updating learning rate to 6.662850366901692e-05
Validation loss decreased (inf --> 0.3612).  Saving model state dict ...
Epoch: 1 cost time: 4.662965297698975
Epoch: 1, Steps: 1027 | Train Loss: 0.6158691 Vali Loss: 0.3611509 Best vali loss: 0.3611509
	iters: 100, epoch: 2 | loss: 1.0079291
	speed: 0.0113s/iter; left time: 80.0223s
	iters: 200, epoch: 2 | loss: 0.8254326
	speed: 0.0040s/iter; left time: 28.2804s
	iters: 300, epoch: 2 | loss: 0.5724870
	speed: 0.0040s/iter; left time: 27.7325s
	iters: 400, epoch: 2 | loss: 0.2641666
	speed: 0.0040s/iter; left time: 27.2264s
	iters: 500, epoch: 2 | loss: 0.3925093
	speed: 0.0040s/iter; left time: 27.0192s
	iters: 600, epoch: 2 | loss: 0.9858249
	speed: 0.0039s/iter; left time: 25.8840s
	iters: 700, epoch: 2 | loss: 0.1787114
	speed: 0.0036s/iter; left time: 23.4306s
	iters: 800, epoch: 2 | loss: 0.8136668
	speed: 0.0036s/iter; left time: 23.1534s
	iters: 900, epoch: 2 | loss: 0.4006176
	speed: 0.0037s/iter; left time: 23.0486s
	iters: 1000, epoch: 2 | loss: 0.2062404
	speed: 0.0036s/iter; left time: 22.4855s
Updating learning rate to 5.912115000528198e-05
Epoch: 2 cost time: 4.013446092605591
Epoch: 2, Steps: 1027 | Train Loss: 0.5647586 Vali Loss: 0.3653236 Best vali loss: 0.3611509
	iters: 100, epoch: 3 | loss: 0.5319787
	speed: 0.0107s/iter; left time: 64.8173s
	iters: 200, epoch: 3 | loss: 1.0074681
	speed: 0.0038s/iter; left time: 22.7588s
	iters: 300, epoch: 3 | loss: 0.9049887
	speed: 0.0037s/iter; left time: 21.9223s
	iters: 400, epoch: 3 | loss: 0.8593495
	speed: 0.0038s/iter; left time: 21.6769s
	iters: 500, epoch: 3 | loss: 0.7067610
	speed: 0.0037s/iter; left time: 20.9759s
	iters: 600, epoch: 3 | loss: 0.2584440
	speed: 0.0038s/iter; left time: 21.2456s
	iters: 700, epoch: 3 | loss: 0.4855794
	speed: 0.0039s/iter; left time: 21.3410s
	iters: 800, epoch: 3 | loss: 0.2951669
	speed: 0.0039s/iter; left time: 21.0402s
	iters: 900, epoch: 3 | loss: 0.6308665
	speed: 0.0039s/iter; left time: 20.7218s
	iters: 1000, epoch: 3 | loss: 0.4141016
	speed: 0.0037s/iter; left time: 19.3563s
Updating learning rate to 4.788560124976839e-05
Validation loss decreased (0.3612 --> 0.3587).  Saving model state dict ...
Epoch: 3 cost time: 3.9753754138946533
Epoch: 3, Steps: 1027 | Train Loss: 0.6094705 Vali Loss: 0.3586673 Best vali loss: 0.3586673
	iters: 100, epoch: 4 | loss: 0.2619553
	speed: 0.0104s/iter; left time: 52.3656s
	iters: 200, epoch: 4 | loss: 0.2261850
	speed: 0.0035s/iter; left time: 17.3758s
	iters: 300, epoch: 4 | loss: 0.3615016
	speed: 0.0040s/iter; left time: 19.5554s
	iters: 400, epoch: 4 | loss: 0.9652307
	speed: 0.0041s/iter; left time: 19.4441s
	iters: 500, epoch: 4 | loss: 0.3805279
	speed: 0.0040s/iter; left time: 18.5928s
	iters: 600, epoch: 4 | loss: 0.3620160
	speed: 0.0041s/iter; left time: 18.3809s
	iters: 700, epoch: 4 | loss: 0.4618546
	speed: 0.0040s/iter; left time: 17.9067s
	iters: 800, epoch: 4 | loss: 0.2636441
	speed: 0.0040s/iter; left time: 17.4765s
	iters: 900, epoch: 4 | loss: 0.4517746
	speed: 0.0040s/iter; left time: 16.9295s
	iters: 1000, epoch: 4 | loss: 0.2369065
	speed: 0.0040s/iter; left time: 16.5379s
Updating learning rate to 3.463236785e-05
Epoch: 4 cost time: 4.080742835998535
Epoch: 4, Steps: 1027 | Train Loss: 0.3971596 Vali Loss: 0.3618110 Best vali loss: 0.3586673
	iters: 100, epoch: 5 | loss: 0.7150428
	speed: 0.0105s/iter; left time: 42.0809s
	iters: 200, epoch: 5 | loss: 0.1955949
	speed: 0.0036s/iter; left time: 14.0020s
	iters: 300, epoch: 5 | loss: 0.2139073
	speed: 0.0036s/iter; left time: 13.7126s
	iters: 400, epoch: 5 | loss: 0.8085746
	speed: 0.0036s/iter; left time: 13.4013s
	iters: 500, epoch: 5 | loss: 0.8601352
	speed: 0.0036s/iter; left time: 12.8605s
	iters: 600, epoch: 5 | loss: 0.9524652
	speed: 0.0036s/iter; left time: 12.5324s
	iters: 700, epoch: 5 | loss: 0.3487381
	speed: 0.0038s/iter; left time: 12.8210s
	iters: 800, epoch: 5 | loss: 0.7384872
	speed: 0.0040s/iter; left time: 13.3303s
	iters: 900, epoch: 5 | loss: 0.3183859
	speed: 0.0040s/iter; left time: 12.8486s
	iters: 1000, epoch: 5 | loss: 0.3708657
	speed: 0.0040s/iter; left time: 12.4447s
Updating learning rate to 2.1379134450231618e-05
Epoch: 5 cost time: 3.8750529289245605
Epoch: 5, Steps: 1027 | Train Loss: 0.5522197 Vali Loss: 0.3654918 Best vali loss: 0.3586673
	iters: 100, epoch: 6 | loss: 1.0275652
	speed: 0.0108s/iter; left time: 32.1272s
	iters: 200, epoch: 6 | loss: 0.9633686
	speed: 0.0036s/iter; left time: 10.2781s
	iters: 300, epoch: 6 | loss: 0.9833224
	speed: 0.0037s/iter; left time: 10.1938s
	iters: 400, epoch: 6 | loss: 0.7372685
	speed: 0.0037s/iter; left time: 9.9635s
	iters: 500, epoch: 6 | loss: 0.4718091
	speed: 0.0041s/iter; left time: 10.6516s
	iters: 600, epoch: 6 | loss: 0.1777855
	speed: 0.0043s/iter; left time: 10.7514s
	iters: 700, epoch: 6 | loss: 0.4104252
	speed: 0.0043s/iter; left time: 10.2131s
	iters: 800, epoch: 6 | loss: 0.2601967
	speed: 0.0042s/iter; left time: 9.6679s
	iters: 900, epoch: 6 | loss: 0.8727209
	speed: 0.0040s/iter; left time: 8.7201s
	iters: 1000, epoch: 6 | loss: 0.4393488
	speed: 0.0040s/iter; left time: 8.3441s
Updating learning rate to 1.0143585694718029e-05
Epoch: 6 cost time: 4.10178542137146
Epoch: 6, Steps: 1027 | Train Loss: 0.6343811 Vali Loss: 0.3672574 Best vali loss: 0.3586673
	iters: 100, epoch: 7 | loss: 0.3057921
	speed: 0.0107s/iter; left time: 20.8280s
	iters: 200, epoch: 7 | loss: 0.8648747
	speed: 0.0036s/iter; left time: 6.6217s
	iters: 300, epoch: 7 | loss: 0.4823580
	speed: 0.0036s/iter; left time: 6.2849s
	iters: 400, epoch: 7 | loss: 0.2470517
	speed: 0.0036s/iter; left time: 6.0132s
	iters: 500, epoch: 7 | loss: 0.2048409
	speed: 0.0036s/iter; left time: 5.5779s
	iters: 600, epoch: 7 | loss: 0.2968772
	speed: 0.0036s/iter; left time: 5.2853s
	iters: 700, epoch: 7 | loss: 0.8879074
	speed: 0.0038s/iter; left time: 5.1687s
	iters: 800, epoch: 7 | loss: 0.3234473
	speed: 0.0041s/iter; left time: 5.0936s
	iters: 900, epoch: 7 | loss: 0.7140244
	speed: 0.0041s/iter; left time: 4.7259s
	iters: 1000, epoch: 7 | loss: 0.5194815
	speed: 0.0041s/iter; left time: 4.2786s
Updating learning rate to 2.6362320309830836e-06
Epoch: 7 cost time: 3.9086897373199463
Epoch: 7, Steps: 1027 | Train Loss: 0.4846655 Vali Loss: 0.3843635 Best vali loss: 0.3586673
	iters: 100, epoch: 8 | loss: 0.5193852
	speed: 0.0109s/iter; left time: 10.0798s
	iters: 200, epoch: 8 | loss: 0.2710944
	speed: 0.0039s/iter; left time: 3.2149s
	iters: 300, epoch: 8 | loss: 0.6838249
	speed: 0.0037s/iter; left time: 2.6932s
	iters: 400, epoch: 8 | loss: 1.3332560
	speed: 0.0036s/iter; left time: 2.2646s
	iters: 500, epoch: 8 | loss: 0.5211788
	speed: 0.0036s/iter; left time: 1.9095s
	iters: 600, epoch: 8 | loss: 0.4583685
	speed: 0.0036s/iter; left time: 1.5338s
	iters: 700, epoch: 8 | loss: 0.3770864
	speed: 0.0039s/iter; left time: 1.2730s
	iters: 800, epoch: 8 | loss: 0.3355422
	speed: 0.0037s/iter; left time: 0.8412s
	iters: 900, epoch: 8 | loss: 0.2574972
	speed: 0.0035s/iter; left time: 0.4528s
	iters: 1000, epoch: 8 | loss: 1.2263596
	speed: 0.0035s/iter; left time: 0.0991s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8279569149017334
Epoch: 8, Steps: 1027 | Train Loss: 0.5983593 Vali Loss: 0.3829309 Best vali loss: 0.3586673

best validation loss 0.35866726342961924

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010630897045, 'e_layers': 3, 'learning_rate': 6.66260161e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9223536
	speed: 0.0104s/iter; left time: 84.1614s
	iters: 200, epoch: 1 | loss: 0.6155281
	speed: 0.0043s/iter; left time: 34.4541s
	iters: 300, epoch: 1 | loss: 1.1951894
	speed: 0.0043s/iter; left time: 34.3696s
	iters: 400, epoch: 1 | loss: 0.3272309
	speed: 0.0043s/iter; left time: 33.9181s
	iters: 500, epoch: 1 | loss: 0.3784974
	speed: 0.0043s/iter; left time: 33.5641s
	iters: 600, epoch: 1 | loss: 0.5917150
	speed: 0.0043s/iter; left time: 32.8903s
	iters: 700, epoch: 1 | loss: 0.4178025
	speed: 0.0043s/iter; left time: 32.5128s
	iters: 800, epoch: 1 | loss: 0.8520397
	speed: 0.0043s/iter; left time: 31.8905s
	iters: 900, epoch: 1 | loss: 0.6750798
	speed: 0.0043s/iter; left time: 31.2873s
	iters: 1000, epoch: 1 | loss: 0.3531167
	speed: 0.0043s/iter; left time: 30.9187s
Updating learning rate to 6.409021435377874e-05
Validation loss decreased (inf --> 0.3623).  Saving model state dict ...
Epoch: 1 cost time: 4.7707679271698
Epoch: 1, Steps: 1027 | Train Loss: 0.6328553 Vali Loss: 0.3623487 Best vali loss: 0.3623487
	iters: 100, epoch: 2 | loss: 0.3301916
	speed: 0.0122s/iter; left time: 86.8234s
	iters: 200, epoch: 2 | loss: 0.4007230
	speed: 0.0041s/iter; left time: 29.0072s
	iters: 300, epoch: 2 | loss: 0.8593982
	speed: 0.0041s/iter; left time: 28.4549s
	iters: 400, epoch: 2 | loss: 1.1587242
	speed: 0.0041s/iter; left time: 28.1696s
	iters: 500, epoch: 2 | loss: 1.0440922
	speed: 0.0043s/iter; left time: 28.4743s
	iters: 600, epoch: 2 | loss: 0.9147156
	speed: 0.0043s/iter; left time: 28.3582s
	iters: 700, epoch: 2 | loss: 0.3079778
	speed: 0.0044s/iter; left time: 28.4553s
	iters: 800, epoch: 2 | loss: 0.4416786
	speed: 0.0042s/iter; left time: 27.1465s
	iters: 900, epoch: 2 | loss: 1.0223476
	speed: 0.0043s/iter; left time: 27.2443s
	iters: 1000, epoch: 2 | loss: 0.3325703
	speed: 0.0043s/iter; left time: 26.8912s
Updating learning rate to 5.686886194387705e-05
Validation loss decreased (0.3623 --> 0.3582).  Saving model state dict ...
Epoch: 2 cost time: 4.408918380737305
Epoch: 2, Steps: 1027 | Train Loss: 0.6812419 Vali Loss: 0.3582147 Best vali loss: 0.3582147
	iters: 100, epoch: 3 | loss: 0.9733104
	speed: 0.0117s/iter; left time: 70.8000s
	iters: 200, epoch: 3 | loss: 0.4019237
	speed: 0.0043s/iter; left time: 25.3735s
	iters: 300, epoch: 3 | loss: 1.1225653
	speed: 0.0043s/iter; left time: 25.4346s
	iters: 400, epoch: 3 | loss: 0.3565678
	speed: 0.0043s/iter; left time: 24.8363s
	iters: 500, epoch: 3 | loss: 0.3324553
	speed: 0.0043s/iter; left time: 24.4098s
	iters: 600, epoch: 3 | loss: 0.2250404
	speed: 0.0041s/iter; left time: 22.7504s
	iters: 700, epoch: 3 | loss: 0.3661817
	speed: 0.0040s/iter; left time: 21.8456s
	iters: 800, epoch: 3 | loss: 0.2196350
	speed: 0.0040s/iter; left time: 21.4527s
	iters: 900, epoch: 3 | loss: 0.7285038
	speed: 0.0040s/iter; left time: 21.0432s
	iters: 1000, epoch: 3 | loss: 0.2996497
	speed: 0.0040s/iter; left time: 20.6602s
Updating learning rate to 4.606134431297987e-05
Epoch: 3 cost time: 4.312361240386963
Epoch: 3, Steps: 1027 | Train Loss: 0.5025833 Vali Loss: 0.3746712 Best vali loss: 0.3582147

best validation loss 0.3582146966094352

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008156388585, 'e_layers': 3, 'learning_rate': 0.0003566179941, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3911666
	speed: 0.0100s/iter; left time: 40.1222s
	iters: 200, epoch: 1 | loss: 0.8092487
	speed: 0.0042s/iter; left time: 16.4072s
	iters: 300, epoch: 1 | loss: 0.6961774
	speed: 0.0044s/iter; left time: 16.8368s
	iters: 400, epoch: 1 | loss: 1.2619658
	speed: 0.0044s/iter; left time: 16.4060s
	iters: 500, epoch: 1 | loss: 0.9477109
	speed: 0.0044s/iter; left time: 15.7787s
Updating learning rate to 0.0003566179941
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 2.528285264968872
Epoch: 1, Steps: 514 | Train Loss: 0.8212539 Vali Loss: 0.3645839 Best vali loss: 0.3645839
	iters: 100, epoch: 2 | loss: 0.9088103
	speed: 0.0089s/iter; left time: 31.2472s
	iters: 200, epoch: 2 | loss: 0.5248343
	speed: 0.0041s/iter; left time: 13.9111s
	iters: 300, epoch: 2 | loss: 0.7012230
	speed: 0.0041s/iter; left time: 13.5379s
	iters: 400, epoch: 2 | loss: 0.4866908
	speed: 0.0039s/iter; left time: 12.3915s
	iters: 500, epoch: 2 | loss: 0.3935270
	speed: 0.0038s/iter; left time: 11.8352s
Updating learning rate to 0.00017830899705
Epoch: 2 cost time: 2.147778272628784
Epoch: 2, Steps: 514 | Train Loss: 0.6030171 Vali Loss: 0.3698645 Best vali loss: 0.3645839
	iters: 100, epoch: 3 | loss: 0.9008762
	speed: 0.0086s/iter; left time: 25.6286s
	iters: 200, epoch: 3 | loss: 0.4061131
	speed: 0.0040s/iter; left time: 11.6195s
	iters: 300, epoch: 3 | loss: 0.3369693
	speed: 0.0040s/iter; left time: 11.2687s
	iters: 400, epoch: 3 | loss: 0.4961888
	speed: 0.0044s/iter; left time: 11.7756s
	iters: 500, epoch: 3 | loss: 0.3817984
	speed: 0.0042s/iter; left time: 10.9773s
Updating learning rate to 8.9154498525e-05
Epoch: 3 cost time: 2.183656930923462
Epoch: 3, Steps: 514 | Train Loss: 0.5043892 Vali Loss: 0.3680493 Best vali loss: 0.3645839

best validation loss 0.364583913340784

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010626255394, 'e_layers': 3, 'learning_rate': 0.0001036693153, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3496775
	speed: 0.0103s/iter; left time: 83.2352s
	iters: 200, epoch: 1 | loss: 0.2728891
	speed: 0.0041s/iter; left time: 32.9632s
	iters: 300, epoch: 1 | loss: 0.4822032
	speed: 0.0041s/iter; left time: 32.4351s
	iters: 400, epoch: 1 | loss: 0.4814321
	speed: 0.0041s/iter; left time: 31.9025s
	iters: 500, epoch: 1 | loss: 0.2714090
	speed: 0.0039s/iter; left time: 30.3540s
	iters: 600, epoch: 1 | loss: 0.2894148
	speed: 0.0039s/iter; left time: 29.7102s
	iters: 700, epoch: 1 | loss: 0.5262604
	speed: 0.0040s/iter; left time: 30.0590s
	iters: 800, epoch: 1 | loss: 0.4920627
	speed: 0.0040s/iter; left time: 29.6061s
	iters: 900, epoch: 1 | loss: 0.4067803
	speed: 0.0040s/iter; left time: 29.0402s
	iters: 1000, epoch: 1 | loss: 0.9031316
	speed: 0.0040s/iter; left time: 28.8719s
Updating learning rate to 9.97236369275646e-05
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 4.479283094406128
Epoch: 1, Steps: 1027 | Train Loss: 0.4475261 Vali Loss: 0.3653013 Best vali loss: 0.3653013
	iters: 100, epoch: 2 | loss: 0.3662130
	speed: 0.0112s/iter; left time: 79.1193s
	iters: 200, epoch: 2 | loss: 0.4099922
	speed: 0.0043s/iter; left time: 29.9034s
	iters: 300, epoch: 2 | loss: 0.5047618
	speed: 0.0043s/iter; left time: 29.4253s
	iters: 400, epoch: 2 | loss: 0.3504542
	speed: 0.0043s/iter; left time: 29.1276s
	iters: 500, epoch: 2 | loss: 0.7265574
	speed: 0.0043s/iter; left time: 28.9082s
	iters: 600, epoch: 2 | loss: 0.4149357
	speed: 0.0043s/iter; left time: 28.4735s
	iters: 700, epoch: 2 | loss: 0.7353793
	speed: 0.0043s/iter; left time: 28.0771s
	iters: 800, epoch: 2 | loss: 0.2211314
	speed: 0.0043s/iter; left time: 27.3376s
	iters: 900, epoch: 2 | loss: 0.3172197
	speed: 0.0043s/iter; left time: 27.0394s
	iters: 1000, epoch: 2 | loss: 0.1834206
	speed: 0.0043s/iter; left time: 26.4420s
Updating learning rate to 8.848729557479815e-05
Validation loss decreased (0.3653 --> 0.3561).  Saving model state dict ...
Epoch: 2 cost time: 4.44961142539978
Epoch: 2, Steps: 1027 | Train Loss: 0.4230065 Vali Loss: 0.3560909 Best vali loss: 0.3560909
	iters: 100, epoch: 3 | loss: 0.3666741
	speed: 0.0116s/iter; left time: 70.1464s
	iters: 200, epoch: 3 | loss: 0.2836700
	speed: 0.0043s/iter; left time: 25.6337s
	iters: 300, epoch: 3 | loss: 0.3835557
	speed: 0.0043s/iter; left time: 25.1949s
	iters: 400, epoch: 3 | loss: 0.2624290
	speed: 0.0043s/iter; left time: 24.9724s
	iters: 500, epoch: 3 | loss: 0.2041073
	speed: 0.0043s/iter; left time: 24.4083s
	iters: 600, epoch: 3 | loss: 0.4931377
	speed: 0.0043s/iter; left time: 24.1585s
	iters: 700, epoch: 3 | loss: 0.3779928
	speed: 0.0043s/iter; left time: 23.2833s
	iters: 800, epoch: 3 | loss: 0.7876094
	speed: 0.0042s/iter; left time: 22.7623s
	iters: 900, epoch: 3 | loss: 0.3326343
	speed: 0.0043s/iter; left time: 22.5828s
	iters: 1000, epoch: 3 | loss: 0.3996274
	speed: 0.0042s/iter; left time: 21.9108s
Updating learning rate to 7.167092235497137e-05
Epoch: 3 cost time: 4.452892303466797
Epoch: 3, Steps: 1027 | Train Loss: 0.3891438 Vali Loss: 0.3721143 Best vali loss: 0.3560909

best validation loss 0.35609088243810505

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010626255394, 'e_layers': 3, 'learning_rate': 0.0001036693153, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2772366
	speed: 0.0104s/iter; left time: 52.2407s
	iters: 200, epoch: 4 | loss: 0.2019049
	speed: 0.0042s/iter; left time: 20.8387s
	iters: 300, epoch: 4 | loss: 0.4375969
	speed: 0.0043s/iter; left time: 20.7100s
	iters: 400, epoch: 4 | loss: 0.5201759
	speed: 0.0042s/iter; left time: 20.0940s
	iters: 500, epoch: 4 | loss: 0.2864599
	speed: 0.0042s/iter; left time: 19.5876s
	iters: 600, epoch: 4 | loss: 0.2637512
	speed: 0.0042s/iter; left time: 19.0837s
	iters: 700, epoch: 4 | loss: 0.5083278
	speed: 0.0042s/iter; left time: 18.6522s
	iters: 800, epoch: 4 | loss: 0.3283911
	speed: 0.0041s/iter; left time: 17.8218s
	iters: 900, epoch: 4 | loss: 0.3927029
	speed: 0.0042s/iter; left time: 17.6770s
	iters: 1000, epoch: 4 | loss: 0.8345793
	speed: 0.0042s/iter; left time: 17.4281s
Updating learning rate to 5.183465765e-05
Validation loss decreased (0.3561 --> 0.3517).  Saving model state dict ...
Epoch: 4 cost time: 4.653642892837524
Epoch: 4, Steps: 1027 | Train Loss: 0.4051127 Vali Loss: 0.3516626 Best vali loss: 0.3516626
	iters: 100, epoch: 5 | loss: 0.3184197
	speed: 0.0113s/iter; left time: 45.3539s
	iters: 200, epoch: 5 | loss: 0.3713852
	speed: 0.0042s/iter; left time: 16.3388s
	iters: 300, epoch: 5 | loss: 0.3408250
	speed: 0.0042s/iter; left time: 16.0606s
	iters: 400, epoch: 5 | loss: 0.3326427
	speed: 0.0042s/iter; left time: 15.6332s
	iters: 500, epoch: 5 | loss: 0.5361908
	speed: 0.0041s/iter; left time: 14.9320s
	iters: 600, epoch: 5 | loss: 0.4159093
	speed: 0.0042s/iter; left time: 14.7594s
	iters: 700, epoch: 5 | loss: 0.4247200
	speed: 0.0043s/iter; left time: 14.5764s
	iters: 800, epoch: 5 | loss: 0.2080245
	speed: 0.0043s/iter; left time: 14.3683s
	iters: 900, epoch: 5 | loss: 0.2967660
	speed: 0.0044s/iter; left time: 14.1338s
	iters: 1000, epoch: 5 | loss: 0.1830163
	speed: 0.0044s/iter; left time: 13.6081s
Updating learning rate to 3.199839294502864e-05
Epoch: 5 cost time: 4.4086267948150635
Epoch: 5, Steps: 1027 | Train Loss: 0.3427900 Vali Loss: 0.3702906 Best vali loss: 0.3516626
	iters: 100, epoch: 6 | loss: 0.3754641
	speed: 0.0108s/iter; left time: 32.3127s
	iters: 200, epoch: 6 | loss: 0.2219741
	speed: 0.0040s/iter; left time: 11.4295s
	iters: 300, epoch: 6 | loss: 0.3442225
	speed: 0.0040s/iter; left time: 11.1368s
	iters: 400, epoch: 6 | loss: 0.2503962
	speed: 0.0040s/iter; left time: 10.6941s
	iters: 500, epoch: 6 | loss: 0.1686234
	speed: 0.0040s/iter; left time: 10.2538s
	iters: 600, epoch: 6 | loss: 0.3294853
	speed: 0.0039s/iter; left time: 9.7778s
	iters: 700, epoch: 6 | loss: 0.2905232
	speed: 0.0040s/iter; left time: 9.4824s
	iters: 800, epoch: 6 | loss: 0.6425965
	speed: 0.0037s/iter; left time: 8.4911s
	iters: 900, epoch: 6 | loss: 0.3111033
	speed: 0.0037s/iter; left time: 8.0677s
	iters: 1000, epoch: 6 | loss: 0.3285871
	speed: 0.0037s/iter; left time: 7.6978s
Updating learning rate to 1.5182019725201852e-05
Epoch: 6 cost time: 4.034948348999023
Epoch: 6, Steps: 1027 | Train Loss: 0.3262976 Vali Loss: 0.3577241 Best vali loss: 0.3516626
	iters: 100, epoch: 7 | loss: 0.3240793
	speed: 0.0106s/iter; left time: 20.7498s
	iters: 200, epoch: 7 | loss: 1.0667430
	speed: 0.0037s/iter; left time: 6.8273s
	iters: 300, epoch: 7 | loss: 0.4161305
	speed: 0.0037s/iter; left time: 6.4383s
	iters: 400, epoch: 7 | loss: 0.7571454
	speed: 0.0039s/iter; left time: 6.4566s
	iters: 500, epoch: 7 | loss: 0.7277159
	speed: 0.0038s/iter; left time: 5.9126s
	iters: 600, epoch: 7 | loss: 0.5864099
	speed: 0.0038s/iter; left time: 5.4715s
	iters: 700, epoch: 7 | loss: 0.2208490
	speed: 0.0037s/iter; left time: 4.9759s
	iters: 800, epoch: 7 | loss: 0.1897273
	speed: 0.0036s/iter; left time: 4.5799s
	iters: 900, epoch: 7 | loss: 0.3434886
	speed: 0.0037s/iter; left time: 4.2528s
	iters: 1000, epoch: 7 | loss: 0.4301864
	speed: 0.0037s/iter; left time: 3.8854s
Updating learning rate to 3.945678372435407e-06
Epoch: 7 cost time: 3.8552396297454834
Epoch: 7, Steps: 1027 | Train Loss: 0.5062475 Vali Loss: 0.3554598 Best vali loss: 0.3516626
	iters: 100, epoch: 8 | loss: 0.2231624
	speed: 0.0109s/iter; left time: 10.1483s
	iters: 200, epoch: 8 | loss: 0.2376688
	speed: 0.0040s/iter; left time: 3.3200s
	iters: 300, epoch: 8 | loss: 0.2858146
	speed: 0.0040s/iter; left time: 2.9335s
	iters: 400, epoch: 8 | loss: 0.3189193
	speed: 0.0040s/iter; left time: 2.5253s
	iters: 500, epoch: 8 | loss: 0.2903574
	speed: 0.0040s/iter; left time: 2.1172s
	iters: 600, epoch: 8 | loss: 0.2332700
	speed: 0.0041s/iter; left time: 1.7383s
	iters: 700, epoch: 8 | loss: 0.5036659
	speed: 0.0040s/iter; left time: 1.3248s
	iters: 800, epoch: 8 | loss: 0.2753893
	speed: 0.0040s/iter; left time: 0.9190s
	iters: 900, epoch: 8 | loss: 0.2037697
	speed: 0.0040s/iter; left time: 0.5168s
	iters: 1000, epoch: 8 | loss: 0.3455248
	speed: 0.0040s/iter; left time: 0.1120s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.176973104476929
Epoch: 8, Steps: 1027 | Train Loss: 0.2917542 Vali Loss: 0.3566575 Best vali loss: 0.3516626

best validation loss 0.3516625580127206

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010625169128, 'e_layers': 3, 'learning_rate': 9.5800749e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6686229
	speed: 0.0104s/iter; left time: 84.7676s
	iters: 200, epoch: 1 | loss: 0.5209185
	speed: 0.0042s/iter; left time: 34.0689s
	iters: 300, epoch: 1 | loss: 0.4789310
	speed: 0.0042s/iter; left time: 33.5144s
	iters: 400, epoch: 1 | loss: 1.1353596
	speed: 0.0043s/iter; left time: 33.3222s
	iters: 500, epoch: 1 | loss: 0.4490412
	speed: 0.0042s/iter; left time: 32.2728s
	iters: 600, epoch: 1 | loss: 0.3577044
	speed: 0.0041s/iter; left time: 30.9390s
	iters: 700, epoch: 1 | loss: 0.3367149
	speed: 0.0042s/iter; left time: 31.6648s
	iters: 800, epoch: 1 | loss: 1.1869621
	speed: 0.0042s/iter; left time: 31.2224s
	iters: 900, epoch: 1 | loss: 1.5190769
	speed: 0.0043s/iter; left time: 31.1332s
	iters: 1000, epoch: 1 | loss: 0.7043648
	speed: 0.0042s/iter; left time: 30.6182s
Updating learning rate to 9.215455010017556e-05
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 4.672990560531616
Epoch: 1, Steps: 1027 | Train Loss: 0.7357696 Vali Loss: 0.3636655 Best vali loss: 0.3636655
	iters: 100, epoch: 2 | loss: 0.3614905
	speed: 0.0114s/iter; left time: 80.6995s
	iters: 200, epoch: 2 | loss: 0.3337807
	speed: 0.0042s/iter; left time: 29.5557s
	iters: 300, epoch: 2 | loss: 0.1818639
	speed: 0.0043s/iter; left time: 29.4336s
	iters: 400, epoch: 2 | loss: 0.3227084
	speed: 0.0043s/iter; left time: 29.1533s
	iters: 500, epoch: 2 | loss: 0.4721100
	speed: 0.0043s/iter; left time: 28.7108s
	iters: 600, epoch: 2 | loss: 0.5003413
	speed: 0.0043s/iter; left time: 28.1901s
	iters: 700, epoch: 2 | loss: 0.7475458
	speed: 0.0043s/iter; left time: 27.7861s
	iters: 800, epoch: 2 | loss: 0.3789764
	speed: 0.0043s/iter; left time: 27.3129s
	iters: 900, epoch: 2 | loss: 0.3403553
	speed: 0.0043s/iter; left time: 26.7390s
	iters: 1000, epoch: 2 | loss: 0.2410727
	speed: 0.0042s/iter; left time: 26.1133s
Updating learning rate to 8.177105413032518e-05
Epoch: 2 cost time: 4.420299530029297
Epoch: 2, Steps: 1027 | Train Loss: 0.3880245 Vali Loss: 0.3763227 Best vali loss: 0.3636655
	iters: 100, epoch: 3 | loss: 0.3876896
	speed: 0.0106s/iter; left time: 64.4494s
	iters: 200, epoch: 3 | loss: 0.9702663
	speed: 0.0035s/iter; left time: 20.8732s
	iters: 300, epoch: 3 | loss: 0.4319755
	speed: 0.0035s/iter; left time: 20.4092s
	iters: 400, epoch: 3 | loss: 0.3452779
	speed: 0.0035s/iter; left time: 19.9423s
	iters: 500, epoch: 3 | loss: 1.3899376
	speed: 0.0035s/iter; left time: 19.6507s
	iters: 600, epoch: 3 | loss: 0.2592968
	speed: 0.0035s/iter; left time: 19.4117s
	iters: 700, epoch: 3 | loss: 0.4671431
	speed: 0.0035s/iter; left time: 18.9846s
	iters: 800, epoch: 3 | loss: 0.1789249
	speed: 0.0036s/iter; left time: 19.1707s
	iters: 900, epoch: 3 | loss: 0.8371536
	speed: 0.0038s/iter; left time: 19.9577s
	iters: 1000, epoch: 3 | loss: 0.3742506
	speed: 0.0038s/iter; left time: 19.8428s
Updating learning rate to 6.623105422523323e-05
Epoch: 3 cost time: 3.695387601852417
Epoch: 3, Steps: 1027 | Train Loss: 0.5641916 Vali Loss: 0.3834040 Best vali loss: 0.3636655
	iters: 100, epoch: 4 | loss: 0.3028412
	speed: 0.0109s/iter; left time: 54.8307s
	iters: 200, epoch: 4 | loss: 0.8814166
	speed: 0.0040s/iter; left time: 19.8420s
	iters: 300, epoch: 4 | loss: 0.2282495
	speed: 0.0040s/iter; left time: 19.3514s
	iters: 400, epoch: 4 | loss: 0.2869249
	speed: 0.0040s/iter; left time: 18.9456s
	iters: 500, epoch: 4 | loss: 0.7166808
	speed: 0.0040s/iter; left time: 18.5415s
	iters: 600, epoch: 4 | loss: 0.2370924
	speed: 0.0039s/iter; left time: 17.5161s
	iters: 700, epoch: 4 | loss: 0.7012135
	speed: 0.0038s/iter; left time: 16.8943s
	iters: 800, epoch: 4 | loss: 0.8564765
	speed: 0.0040s/iter; left time: 17.1274s
	iters: 900, epoch: 4 | loss: 0.3652401
	speed: 0.0040s/iter; left time: 16.8195s
	iters: 1000, epoch: 4 | loss: 1.4526900
	speed: 0.0040s/iter; left time: 16.5025s
Updating learning rate to 4.79003745e-05
Epoch: 4 cost time: 4.104706048965454
Epoch: 4, Steps: 1027 | Train Loss: 0.6028825 Vali Loss: 0.4082671 Best vali loss: 0.3636655
	iters: 100, epoch: 5 | loss: 0.4670435
	speed: 0.0104s/iter; left time: 41.5825s
	iters: 200, epoch: 5 | loss: 0.3765369
	speed: 0.0036s/iter; left time: 13.9439s
	iters: 300, epoch: 5 | loss: 0.2122015
	speed: 0.0035s/iter; left time: 13.4467s
	iters: 400, epoch: 5 | loss: 0.7494062
	speed: 0.0035s/iter; left time: 13.1045s
	iters: 500, epoch: 5 | loss: 0.3093106
	speed: 0.0035s/iter; left time: 12.7875s
	iters: 600, epoch: 5 | loss: 0.4799645
	speed: 0.0035s/iter; left time: 12.4247s
	iters: 700, epoch: 5 | loss: 0.3045939
	speed: 0.0040s/iter; left time: 13.6141s
	iters: 800, epoch: 5 | loss: 0.3512344
	speed: 0.0036s/iter; left time: 11.9504s
	iters: 900, epoch: 5 | loss: 0.3890470
	speed: 0.0037s/iter; left time: 11.7751s
	iters: 1000, epoch: 5 | loss: 0.8311271
	speed: 0.0037s/iter; left time: 11.4738s
Updating learning rate to 2.9569694774766782e-05
Epoch: 5 cost time: 3.7656352519989014
Epoch: 5, Steps: 1027 | Train Loss: 0.4470466 Vali Loss: 0.3859345 Best vali loss: 0.3636655
	iters: 100, epoch: 6 | loss: 0.4399094
	speed: 0.0106s/iter; left time: 31.4874s
	iters: 200, epoch: 6 | loss: 0.8541040
	speed: 0.0036s/iter; left time: 10.2471s
	iters: 300, epoch: 6 | loss: 0.3589465
	speed: 0.0035s/iter; left time: 9.8638s
	iters: 400, epoch: 6 | loss: 0.4780613
	speed: 0.0035s/iter; left time: 9.4814s
	iters: 500, epoch: 6 | loss: 0.2510707
	speed: 0.0035s/iter; left time: 9.1281s
	iters: 600, epoch: 6 | loss: 0.3712202
	speed: 0.0035s/iter; left time: 8.7775s
	iters: 700, epoch: 6 | loss: 0.4769984
	speed: 0.0038s/iter; left time: 9.0869s
	iters: 800, epoch: 6 | loss: 0.3577767
	speed: 0.0040s/iter; left time: 9.0727s
	iters: 900, epoch: 6 | loss: 0.3645514
	speed: 0.0040s/iter; left time: 8.6632s
	iters: 1000, epoch: 6 | loss: 0.1848111
	speed: 0.0040s/iter; left time: 8.2691s
Updating learning rate to 1.4029694869674821e-05
Epoch: 6 cost time: 3.8479645252227783
Epoch: 6, Steps: 1027 | Train Loss: 0.4137450 Vali Loss: 0.4002296 Best vali loss: 0.3636655
	iters: 100, epoch: 7 | loss: 0.3276505
	speed: 0.0112s/iter; left time: 21.9896s
	iters: 200, epoch: 7 | loss: 0.7881571
	speed: 0.0042s/iter; left time: 7.7387s
	iters: 300, epoch: 7 | loss: 0.3190281
	speed: 0.0042s/iter; left time: 7.3777s
	iters: 400, epoch: 7 | loss: 0.1906659
	speed: 0.0042s/iter; left time: 6.9872s
	iters: 500, epoch: 7 | loss: 0.8970893
	speed: 0.0042s/iter; left time: 6.5603s
	iters: 600, epoch: 7 | loss: 0.3518955
	speed: 0.0042s/iter; left time: 6.1425s
	iters: 700, epoch: 7 | loss: 0.4625714
	speed: 0.0042s/iter; left time: 5.6625s
	iters: 800, epoch: 7 | loss: 0.6554244
	speed: 0.0042s/iter; left time: 5.2545s
	iters: 900, epoch: 7 | loss: 0.4146966
	speed: 0.0042s/iter; left time: 4.8226s
	iters: 1000, epoch: 7 | loss: 1.0727518
	speed: 0.0041s/iter; left time: 4.3765s
Updating learning rate to 3.64619889982444e-06
Epoch: 7 cost time: 4.339350461959839
Epoch: 7, Steps: 1027 | Train Loss: 0.5479931 Vali Loss: 0.3794410 Best vali loss: 0.3636655
	iters: 100, epoch: 8 | loss: 0.3128824
	speed: 0.0113s/iter; left time: 10.4789s
	iters: 200, epoch: 8 | loss: 0.9029394
	speed: 0.0042s/iter; left time: 3.4690s
	iters: 300, epoch: 8 | loss: 0.4188896
	speed: 0.0042s/iter; left time: 3.0797s
	iters: 400, epoch: 8 | loss: 0.7827812
	speed: 0.0042s/iter; left time: 2.6525s
	iters: 500, epoch: 8 | loss: 0.4982138
	speed: 0.0043s/iter; left time: 2.2468s
	iters: 600, epoch: 8 | loss: 1.2395036
	speed: 0.0042s/iter; left time: 1.7840s
	iters: 700, epoch: 8 | loss: 0.1875699
	speed: 0.0042s/iter; left time: 1.3814s
	iters: 800, epoch: 8 | loss: 0.5187116
	speed: 0.0039s/iter; left time: 0.8998s
	iters: 900, epoch: 8 | loss: 0.9039339
	speed: 0.0038s/iter; left time: 0.4856s
	iters: 1000, epoch: 8 | loss: 0.4821064
	speed: 0.0038s/iter; left time: 0.1058s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.23614764213562
Epoch: 8, Steps: 1027 | Train Loss: 0.6247532 Vali Loss: 0.3853953 Best vali loss: 0.3636655

best validation loss 0.36366552192944673

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010409786032, 'e_layers': 3, 'learning_rate': 9.14784232e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6694753
	speed: 0.0101s/iter; left time: 81.5913s
	iters: 200, epoch: 1 | loss: 0.5223256
	speed: 0.0041s/iter; left time: 33.0549s
	iters: 300, epoch: 1 | loss: 0.4793418
	speed: 0.0042s/iter; left time: 33.1043s
	iters: 400, epoch: 1 | loss: 1.1364030
	speed: 0.0042s/iter; left time: 32.5403s
	iters: 500, epoch: 1 | loss: 0.4494525
	speed: 0.0042s/iter; left time: 32.1427s
	iters: 600, epoch: 1 | loss: 0.3576278
	speed: 0.0042s/iter; left time: 31.6876s
	iters: 700, epoch: 1 | loss: 0.3370917
	speed: 0.0042s/iter; left time: 31.2861s
	iters: 800, epoch: 1 | loss: 1.1890543
	speed: 0.0042s/iter; left time: 31.3027s
	iters: 900, epoch: 1 | loss: 1.5188857
	speed: 0.0042s/iter; left time: 30.4348s
	iters: 1000, epoch: 1 | loss: 0.7041203
	speed: 0.0042s/iter; left time: 30.4548s
Updating learning rate to 8.799673303044281e-05
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 4.60443115234375
Epoch: 1, Steps: 1027 | Train Loss: 0.7363778 Vali Loss: 0.3637255 Best vali loss: 0.3637255
	iters: 100, epoch: 2 | loss: 0.3610097
	speed: 0.0115s/iter; left time: 81.2532s
	iters: 200, epoch: 2 | loss: 0.3343212
	speed: 0.0043s/iter; left time: 30.0205s
	iters: 300, epoch: 2 | loss: 0.1819417
	speed: 0.0043s/iter; left time: 29.3860s
	iters: 400, epoch: 2 | loss: 0.3228378
	speed: 0.0043s/iter; left time: 28.9230s
	iters: 500, epoch: 2 | loss: 0.4788614
	speed: 0.0043s/iter; left time: 28.5021s
	iters: 600, epoch: 2 | loss: 0.5008690
	speed: 0.0042s/iter; left time: 27.7701s
	iters: 700, epoch: 2 | loss: 0.7503521
	speed: 0.0041s/iter; left time: 26.6416s
	iters: 800, epoch: 2 | loss: 0.3790259
	speed: 0.0037s/iter; left time: 23.7864s
	iters: 900, epoch: 2 | loss: 0.3458858
	speed: 0.0037s/iter; left time: 23.2846s
	iters: 1000, epoch: 2 | loss: 0.2559531
	speed: 0.0037s/iter; left time: 22.9168s
Updating learning rate to 7.808171828848639e-05
Validation loss decreased (0.3637 --> 0.3485).  Saving model state dict ...
Epoch: 2 cost time: 4.213498115539551
Epoch: 2, Steps: 1027 | Train Loss: 0.3911058 Vali Loss: 0.3485008 Best vali loss: 0.3485008
	iters: 100, epoch: 3 | loss: 0.3710063
	speed: 0.0111s/iter; left time: 67.3805s
	iters: 200, epoch: 3 | loss: 0.9670821
	speed: 0.0040s/iter; left time: 23.7663s
	iters: 300, epoch: 3 | loss: 0.4536307
	speed: 0.0040s/iter; left time: 23.2109s
	iters: 400, epoch: 3 | loss: 0.3551812
	speed: 0.0040s/iter; left time: 23.0113s
	iters: 500, epoch: 3 | loss: 1.3845388
	speed: 0.0040s/iter; left time: 22.4910s
	iters: 600, epoch: 3 | loss: 0.2853180
	speed: 0.0040s/iter; left time: 22.2516s
	iters: 700, epoch: 3 | loss: 0.4663704
	speed: 0.0040s/iter; left time: 21.7968s
	iters: 800, epoch: 3 | loss: 0.1779487
	speed: 0.0040s/iter; left time: 21.3827s
	iters: 900, epoch: 3 | loss: 0.8424261
	speed: 0.0040s/iter; left time: 20.9079s
	iters: 1000, epoch: 3 | loss: 0.3716530
	speed: 0.0040s/iter; left time: 20.5025s
Updating learning rate to 6.324285008876113e-05
Epoch: 3 cost time: 4.141541004180908
Epoch: 3, Steps: 1027 | Train Loss: 0.5675155 Vali Loss: 0.3772481 Best vali loss: 0.3485008
	iters: 100, epoch: 4 | loss: 0.3058185
	speed: 0.0109s/iter; left time: 54.6994s
	iters: 200, epoch: 4 | loss: 0.8750212
	speed: 0.0037s/iter; left time: 18.3304s
	iters: 300, epoch: 4 | loss: 0.2329072
	speed: 0.0037s/iter; left time: 18.0038s
	iters: 400, epoch: 4 | loss: 0.2706486
	speed: 0.0037s/iter; left time: 17.6058s
	iters: 500, epoch: 4 | loss: 0.7303392
	speed: 0.0037s/iter; left time: 17.1738s
	iters: 600, epoch: 4 | loss: 0.2370395
	speed: 0.0037s/iter; left time: 16.8840s
	iters: 700, epoch: 4 | loss: 0.6960217
	speed: 0.0037s/iter; left time: 16.5602s
	iters: 800, epoch: 4 | loss: 0.8607748
	speed: 0.0039s/iter; left time: 17.0906s
	iters: 900, epoch: 4 | loss: 0.3598655
	speed: 0.0040s/iter; left time: 16.7888s
	iters: 1000, epoch: 4 | loss: 1.4659891
	speed: 0.0040s/iter; left time: 16.5419s
Updating learning rate to 4.57392116e-05
Epoch: 4 cost time: 3.973655939102173
Epoch: 4, Steps: 1027 | Train Loss: 0.6034425 Vali Loss: 0.4146470 Best vali loss: 0.3485008
	iters: 100, epoch: 5 | loss: 0.4736845
	speed: 0.0107s/iter; left time: 42.8950s
	iters: 200, epoch: 5 | loss: 0.3696499
	speed: 0.0040s/iter; left time: 15.4667s
	iters: 300, epoch: 5 | loss: 0.2186288
	speed: 0.0039s/iter; left time: 14.8924s
	iters: 400, epoch: 5 | loss: 0.7564577
	speed: 0.0036s/iter; left time: 13.5104s
	iters: 500, epoch: 5 | loss: 0.3056677
	speed: 0.0037s/iter; left time: 13.2642s
	iters: 600, epoch: 5 | loss: 0.4806405
	speed: 0.0038s/iter; left time: 13.2910s
	iters: 700, epoch: 5 | loss: 0.3039204
	speed: 0.0037s/iter; left time: 12.5729s
	iters: 800, epoch: 5 | loss: 0.3482234
	speed: 0.0037s/iter; left time: 12.1142s
	iters: 900, epoch: 5 | loss: 0.4180744
	speed: 0.0036s/iter; left time: 11.7066s
	iters: 1000, epoch: 5 | loss: 0.8370727
	speed: 0.0037s/iter; left time: 11.4466s
Updating learning rate to 2.823557311123887e-05
Epoch: 5 cost time: 3.886017322540283
Epoch: 5, Steps: 1027 | Train Loss: 0.4512020 Vali Loss: 0.3774401 Best vali loss: 0.3485008
	iters: 100, epoch: 6 | loss: 0.4337859
	speed: 0.0107s/iter; left time: 31.9743s
	iters: 200, epoch: 6 | loss: 0.8577717
	speed: 0.0039s/iter; left time: 11.1921s
	iters: 300, epoch: 6 | loss: 0.3526212
	speed: 0.0038s/iter; left time: 10.5874s
	iters: 400, epoch: 6 | loss: 0.4734007
	speed: 0.0038s/iter; left time: 10.2218s
	iters: 500, epoch: 6 | loss: 0.2494817
	speed: 0.0038s/iter; left time: 9.8228s
	iters: 600, epoch: 6 | loss: 0.3765139
	speed: 0.0039s/iter; left time: 9.5692s
	iters: 700, epoch: 6 | loss: 0.4768180
	speed: 0.0039s/iter; left time: 9.3167s
	iters: 800, epoch: 6 | loss: 0.3529548
	speed: 0.0037s/iter; left time: 8.5243s
	iters: 900, epoch: 6 | loss: 0.3778445
	speed: 0.0038s/iter; left time: 8.2379s
	iters: 1000, epoch: 6 | loss: 0.1844751
	speed: 0.0038s/iter; left time: 7.8645s
Updating learning rate to 1.3396704911513606e-05
Epoch: 6 cost time: 3.958669900894165
Epoch: 6, Steps: 1027 | Train Loss: 0.4135667 Vali Loss: 0.4106016 Best vali loss: 0.3485008
	iters: 100, epoch: 7 | loss: 0.3267748
	speed: 0.0109s/iter; left time: 21.3270s
	iters: 200, epoch: 7 | loss: 0.7928935
	speed: 0.0039s/iter; left time: 7.2483s
	iters: 300, epoch: 7 | loss: 0.3213267
	speed: 0.0039s/iter; left time: 6.9189s
	iters: 400, epoch: 7 | loss: 0.1872679
	speed: 0.0039s/iter; left time: 6.5097s
	iters: 500, epoch: 7 | loss: 0.9123148
	speed: 0.0039s/iter; left time: 6.1040s
	iters: 600, epoch: 7 | loss: 0.3586235
	speed: 0.0039s/iter; left time: 5.6959s
	iters: 700, epoch: 7 | loss: 0.4572998
	speed: 0.0038s/iter; left time: 5.1063s
	iters: 800, epoch: 7 | loss: 0.6576290
	speed: 0.0038s/iter; left time: 4.7316s
	iters: 900, epoch: 7 | loss: 0.4137456
	speed: 0.0038s/iter; left time: 4.3645s
	iters: 1000, epoch: 7 | loss: 1.0771719
	speed: 0.0037s/iter; left time: 3.9435s
Updating learning rate to 3.4816901695571764e-06
Epoch: 7 cost time: 3.9936206340789795
Epoch: 7, Steps: 1027 | Train Loss: 0.5505047 Vali Loss: 0.3743170 Best vali loss: 0.3485008
	iters: 100, epoch: 8 | loss: 0.3184784
	speed: 0.0107s/iter; left time: 9.9432s
	iters: 200, epoch: 8 | loss: 0.9013134
	speed: 0.0037s/iter; left time: 3.0820s
	iters: 300, epoch: 8 | loss: 0.4265100
	speed: 0.0036s/iter; left time: 2.6514s
	iters: 400, epoch: 8 | loss: 0.7881805
	speed: 0.0037s/iter; left time: 2.3008s
	iters: 500, epoch: 8 | loss: 0.4977303
	speed: 0.0037s/iter; left time: 1.9527s
	iters: 600, epoch: 8 | loss: 1.2665397
	speed: 0.0037s/iter; left time: 1.5956s
	iters: 700, epoch: 8 | loss: 0.1919797
	speed: 0.0037s/iter; left time: 1.2265s
	iters: 800, epoch: 8 | loss: 0.5501913
	speed: 0.0038s/iter; left time: 0.8649s
	iters: 900, epoch: 8 | loss: 0.9546391
	speed: 0.0039s/iter; left time: 0.5006s
	iters: 1000, epoch: 8 | loss: 0.4769115
	speed: 0.0040s/iter; left time: 0.1109s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.900622606277466
Epoch: 8, Steps: 1027 | Train Loss: 0.6372474 Vali Loss: 0.3853993 Best vali loss: 0.3485008

best validation loss 0.3485007570159927

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022853590949, 'e_layers': 3, 'learning_rate': 0.0003460788191, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4540090
	speed: 0.0103s/iter; left time: 9.6480s
Updating learning rate to 0.0003329069783510831
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 0.9873611927032471
Epoch: 1, Steps: 129 | Train Loss: 0.4540090 Vali Loss: 0.3664634 Best vali loss: 0.3664634
	iters: 100, epoch: 2 | loss: 0.8296614
	speed: 0.0083s/iter; left time: 6.6992s
Updating learning rate to 0.0002953967494553212
Epoch: 2 cost time: 0.6722903251647949
Epoch: 2, Steps: 129 | Train Loss: 0.8296614 Vali Loss: 0.3706389 Best vali loss: 0.3664634
	iters: 100, epoch: 3 | loss: 0.6048184
	speed: 0.0078s/iter; left time: 5.2551s
Updating learning rate to 0.00023925872473102251
Validation loss decreased (0.3665 --> 0.3516).  Saving model state dict ...
Epoch: 3 cost time: 0.6218931674957275
Epoch: 3, Steps: 129 | Train Loss: 0.6048184 Vali Loss: 0.3515607 Best vali loss: 0.3515607

best validation loss 0.3515607389813556

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.000959950734, 'e_layers': 2, 'learning_rate': 0.0003936787923, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266435
	speed: 0.0092s/iter; left time: 36.9103s
	iters: 200, epoch: 1 | loss: 1.0781717
	speed: 0.0033s/iter; left time: 12.9479s
	iters: 300, epoch: 1 | loss: 1.0145174
	speed: 0.0033s/iter; left time: 12.5513s
	iters: 400, epoch: 1 | loss: 0.5048927
	speed: 0.0032s/iter; left time: 11.9763s
	iters: 500, epoch: 1 | loss: 1.1571722
	speed: 0.0031s/iter; left time: 11.3099s
Updating learning rate to 0.0003936787923
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 2.0581984519958496
Epoch: 1, Steps: 514 | Train Loss: 0.8362795 Vali Loss: 0.3706276 Best vali loss: 0.3706276
	iters: 100, epoch: 2 | loss: 0.3851669
	speed: 0.0075s/iter; left time: 26.2024s
	iters: 200, epoch: 2 | loss: 0.2557243
	speed: 0.0035s/iter; left time: 11.9891s
	iters: 300, epoch: 2 | loss: 0.5116890
	speed: 0.0034s/iter; left time: 11.1304s
	iters: 400, epoch: 2 | loss: 0.4058569
	speed: 0.0033s/iter; left time: 10.6863s
	iters: 500, epoch: 2 | loss: 0.6115924
	speed: 0.0033s/iter; left time: 10.3279s
Updating learning rate to 0.00019683939615
Epoch: 2 cost time: 1.8034555912017822
Epoch: 2, Steps: 514 | Train Loss: 0.4340059 Vali Loss: 0.3846494 Best vali loss: 0.3706276
	iters: 100, epoch: 3 | loss: 0.3637047
	speed: 0.0071s/iter; left time: 21.1229s
	iters: 200, epoch: 3 | loss: 0.8753465
	speed: 0.0032s/iter; left time: 9.2013s
	iters: 300, epoch: 3 | loss: 0.5195835
	speed: 0.0030s/iter; left time: 8.2280s
	iters: 400, epoch: 3 | loss: 0.5086782
	speed: 0.0029s/iter; left time: 7.9170s
	iters: 500, epoch: 3 | loss: 1.0720429
	speed: 0.0031s/iter; left time: 8.0796s
Updating learning rate to 9.8419698075e-05
Validation loss decreased (0.3706 --> 0.3585).  Saving model state dict ...
Epoch: 3 cost time: 1.6453909873962402
Epoch: 3, Steps: 514 | Train Loss: 0.6678712 Vali Loss: 0.3584650 Best vali loss: 0.3584650

best validation loss 0.3584650389572024

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010666285738, 'e_layers': 4, 'learning_rate': 0.0003964258559, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5468511
	speed: 0.0133s/iter; left time: 26.0824s
	iters: 200, epoch: 1 | loss: 0.6063183
	speed: 0.0071s/iter; left time: 13.1442s
Updating learning rate to 0.0003964258559
Validation loss decreased (inf --> 0.3828).  Saving model state dict ...
Epoch: 1 cost time: 2.170285940170288
Epoch: 1, Steps: 257 | Train Loss: 0.5765847 Vali Loss: 0.3827506 Best vali loss: 0.3827506
	iters: 100, epoch: 2 | loss: 0.5820243
	speed: 0.0148s/iter; left time: 25.2037s
	iters: 200, epoch: 2 | loss: 0.7037076
	speed: 0.0071s/iter; left time: 11.2952s
Updating learning rate to 0.00019821292795
Validation loss decreased (0.3828 --> 0.3807).  Saving model state dict ...
Epoch: 2 cost time: 1.85117506980896
Epoch: 2, Steps: 257 | Train Loss: 0.6428660 Vali Loss: 0.3807016 Best vali loss: 0.3807016
	iters: 100, epoch: 3 | loss: 0.6288401
	speed: 0.0153s/iter; left time: 22.1183s
	iters: 200, epoch: 3 | loss: 0.7612733
	speed: 0.0073s/iter; left time: 9.7427s
Updating learning rate to 9.9106463975e-05
Epoch: 3 cost time: 1.8944103717803955
Epoch: 3, Steps: 257 | Train Loss: 0.6950567 Vali Loss: 0.3842731 Best vali loss: 0.3807016

best validation loss 0.38070156712428993

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022853590949, 'e_layers': 3, 'learning_rate': 0.0003460788191, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4098755
	speed: 0.0115s/iter; left time: 6.2957s
Updating learning rate to 0.00017303940955
Validation loss decreased (0.3516 --> 0.3507).  Saving model state dict ...
Epoch: 4 cost time: 1.008284330368042
Epoch: 4, Steps: 129 | Train Loss: 0.4098755 Vali Loss: 0.3507410 Best vali loss: 0.3507410
	iters: 100, epoch: 5 | loss: 0.6902719
	speed: 0.0081s/iter; left time: 3.3608s
Updating learning rate to 0.00010682009436897751
Validation loss decreased (0.3507 --> 0.3506).  Saving model state dict ...
Epoch: 5 cost time: 0.6343708038330078
Epoch: 5, Steps: 129 | Train Loss: 0.6902719 Vali Loss: 0.3505679 Best vali loss: 0.3505679
	iters: 100, epoch: 6 | loss: 0.5681359
	speed: 0.0079s/iter; left time: 2.2610s
Updating learning rate to 5.068206964467878e-05
Epoch: 6 cost time: 0.6319718360900879
Epoch: 6, Steps: 129 | Train Loss: 0.5681359 Vali Loss: 0.3535819 Best vali loss: 0.3505679
	iters: 100, epoch: 7 | loss: 0.3545762
	speed: 0.0085s/iter; left time: 1.3488s
Updating learning rate to 1.3171840748916914e-05
Validation loss decreased (0.3506 --> 0.3468).  Saving model state dict ...
Epoch: 7 cost time: 0.7087535858154297
Epoch: 7, Steps: 129 | Train Loss: 0.3545762 Vali Loss: 0.3467521 Best vali loss: 0.3467521
	iters: 100, epoch: 8 | loss: 0.5157897
	speed: 0.0082s/iter; left time: 0.2456s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6398284435272217
Epoch: 8, Steps: 129 | Train Loss: 0.5157897 Vali Loss: 0.3487298 Best vali loss: 0.3467521

best validation loss 0.34675210659302524

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010683845737, 'e_layers': 4, 'learning_rate': 0.0003979818688, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5501499
	speed: 0.0126s/iter; left time: 24.7291s
	iters: 200, epoch: 1 | loss: 0.5643359
	speed: 0.0072s/iter; left time: 13.4208s
Updating learning rate to 0.0003979818688
Validation loss decreased (inf --> 0.3791).  Saving model state dict ...
Epoch: 1 cost time: 2.1851015090942383
Epoch: 1, Steps: 257 | Train Loss: 0.5572429 Vali Loss: 0.3790763 Best vali loss: 0.3790763
	iters: 100, epoch: 2 | loss: 0.5837095
	speed: 0.0150s/iter; left time: 25.4606s
	iters: 200, epoch: 2 | loss: 0.7282044
	speed: 0.0071s/iter; left time: 11.3927s
Updating learning rate to 0.0001989909344
Epoch: 2 cost time: 1.8789093494415283
Epoch: 2, Steps: 257 | Train Loss: 0.6559570 Vali Loss: 0.3931398 Best vali loss: 0.3790763
	iters: 100, epoch: 3 | loss: 0.6383751
	speed: 0.0147s/iter; left time: 21.2087s
	iters: 200, epoch: 3 | loss: 0.7371856
	speed: 0.0071s/iter; left time: 9.5800s
Updating learning rate to 9.94954672e-05
Epoch: 3 cost time: 1.8829607963562012
Epoch: 3, Steps: 257 | Train Loss: 0.6877804 Vali Loss: 0.3802348 Best vali loss: 0.3790763
	iters: 100, epoch: 4 | loss: 0.4250016
	speed: 0.0148s/iter; left time: 17.5715s
	iters: 200, epoch: 4 | loss: 0.6305269
	speed: 0.0071s/iter; left time: 7.7458s
Updating learning rate to 4.97477336e-05
Validation loss decreased (0.3791 --> 0.3739).  Saving model state dict ...
Epoch: 4 cost time: 1.8802857398986816
Epoch: 4, Steps: 257 | Train Loss: 0.5277642 Vali Loss: 0.3739247 Best vali loss: 0.3739247
	iters: 100, epoch: 5 | loss: 0.5514962
	speed: 0.0153s/iter; left time: 14.2482s
	iters: 200, epoch: 5 | loss: 0.4751542
	speed: 0.0071s/iter; left time: 5.8999s
Updating learning rate to 2.48738668e-05
Epoch: 5 cost time: 1.8684258460998535
Epoch: 5, Steps: 257 | Train Loss: 0.5133252 Vali Loss: 0.3763161 Best vali loss: 0.3739247
	iters: 100, epoch: 6 | loss: 0.6324994
	speed: 0.0148s/iter; left time: 9.9644s
	iters: 200, epoch: 6 | loss: 0.3855165
	speed: 0.0073s/iter; left time: 4.1490s
Updating learning rate to 1.24369334e-05
Epoch: 6 cost time: 1.9040772914886475
Epoch: 6, Steps: 257 | Train Loss: 0.5090079 Vali Loss: 0.3755137 Best vali loss: 0.3739247
	iters: 100, epoch: 7 | loss: 0.3258264
	speed: 0.0149s/iter; left time: 6.1859s
	iters: 200, epoch: 7 | loss: 0.4545859
	speed: 0.0072s/iter; left time: 2.2819s
Updating learning rate to 6.2184667e-06
Validation loss decreased (0.3739 --> 0.3723).  Saving model state dict ...
Epoch: 7 cost time: 1.9004549980163574
Epoch: 7, Steps: 257 | Train Loss: 0.3902061 Vali Loss: 0.3723376 Best vali loss: 0.3723376
	iters: 100, epoch: 8 | loss: 0.3529828
	speed: 0.0153s/iter; left time: 2.4243s
	iters: 200, epoch: 8 | loss: 0.7259787
	speed: 0.0071s/iter; left time: 0.4143s
Updating learning rate to 3.10923335e-06
Epoch: 8 cost time: 1.8851661682128906
Epoch: 8, Steps: 257 | Train Loss: 0.5394807 Vali Loss: 0.3739076 Best vali loss: 0.3723376

best validation loss 0.3723376451986009

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010584503638, 'e_layers': 2, 'learning_rate': 0.0003924706204, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4265820
	speed: 0.0091s/iter; left time: 36.3557s
	iters: 200, epoch: 1 | loss: 1.0778219
	speed: 0.0031s/iter; left time: 12.1573s
	iters: 300, epoch: 1 | loss: 1.0147724
	speed: 0.0030s/iter; left time: 11.5811s
	iters: 400, epoch: 1 | loss: 0.5032276
	speed: 0.0030s/iter; left time: 11.2340s
	iters: 500, epoch: 1 | loss: 1.1570199
	speed: 0.0033s/iter; left time: 11.7737s
Updating learning rate to 0.00037753309684978334
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.9915177822113037
Epoch: 1, Steps: 514 | Train Loss: 0.8358847 Vali Loss: 0.3710547 Best vali loss: 0.3710547
	iters: 100, epoch: 2 | loss: 0.3950226
	speed: 0.0075s/iter; left time: 26.3515s
	iters: 200, epoch: 2 | loss: 0.2738851
	speed: 0.0036s/iter; left time: 12.3411s
	iters: 300, epoch: 2 | loss: 0.4397748
	speed: 0.0036s/iter; left time: 11.8467s
	iters: 400, epoch: 2 | loss: 0.3983147
	speed: 0.0034s/iter; left time: 10.8528s
	iters: 500, epoch: 2 | loss: 0.6466256
	speed: 0.0034s/iter; left time: 10.6188s
Updating learning rate to 0.00033499462875066565
Validation loss decreased (0.3711 --> 0.3539).  Saving model state dict ...
Epoch: 2 cost time: 1.8575282096862793
Epoch: 2, Steps: 514 | Train Loss: 0.4307245 Vali Loss: 0.3538764 Best vali loss: 0.3538764
	iters: 100, epoch: 3 | loss: 0.3886329
	speed: 0.0080s/iter; left time: 23.7820s
	iters: 200, epoch: 3 | loss: 0.8922839
	speed: 0.0034s/iter; left time: 9.8757s
	iters: 300, epoch: 3 | loss: 0.5044253
	speed: 0.0033s/iter; left time: 9.3089s
	iters: 400, epoch: 3 | loss: 0.4541710
	speed: 0.0034s/iter; left time: 9.0282s
	iters: 500, epoch: 3 | loss: 1.0592817
	speed: 0.0036s/iter; left time: 9.2107s
Updating learning rate to 0.00027133131225856415
Validation loss decreased (0.3539 --> 0.3516).  Saving model state dict ...
Epoch: 3 cost time: 1.8099069595336914
Epoch: 3, Steps: 514 | Train Loss: 0.6597590 Vali Loss: 0.3515704 Best vali loss: 0.3515704
	iters: 100, epoch: 4 | loss: 0.5553891
	speed: 0.0076s/iter; left time: 18.7710s
	iters: 200, epoch: 4 | loss: 0.4470837
	speed: 0.0031s/iter; left time: 7.4603s
	iters: 300, epoch: 4 | loss: 0.5023266
	speed: 0.0031s/iter; left time: 7.1251s
	iters: 400, epoch: 4 | loss: 0.6709536
	speed: 0.0031s/iter; left time: 6.7907s
	iters: 500, epoch: 4 | loss: 0.7337949
	speed: 0.0031s/iter; left time: 6.4594s
Updating learning rate to 0.0001962353102
Validation loss decreased (0.3516 --> 0.3501).  Saving model state dict ...
Epoch: 4 cost time: 1.681870460510254
Epoch: 4, Steps: 514 | Train Loss: 0.5819096 Vali Loss: 0.3501360 Best vali loss: 0.3501360
	iters: 100, epoch: 5 | loss: 0.5328124
	speed: 0.0076s/iter; left time: 14.8640s
	iters: 200, epoch: 5 | loss: 0.7083302
	speed: 0.0034s/iter; left time: 6.3305s
	iters: 300, epoch: 5 | loss: 0.4868518
	speed: 0.0034s/iter; left time: 5.9462s
	iters: 400, epoch: 5 | loss: 0.7524931
	speed: 0.0034s/iter; left time: 5.7001s
	iters: 500, epoch: 5 | loss: 0.5060947
	speed: 0.0034s/iter; left time: 5.3405s
Updating learning rate to 0.00012113930814143589
Epoch: 5 cost time: 1.80711030960083
Epoch: 5, Steps: 514 | Train Loss: 0.5973164 Vali Loss: 0.3515858 Best vali loss: 0.3501360
	iters: 100, epoch: 6 | loss: 0.2986369
	speed: 0.0074s/iter; left time: 10.6779s
	iters: 200, epoch: 6 | loss: 0.4706434
	speed: 0.0034s/iter; left time: 4.5402s
	iters: 300, epoch: 6 | loss: 0.3383211
	speed: 0.0034s/iter; left time: 4.1864s
	iters: 400, epoch: 6 | loss: 0.7307178
	speed: 0.0033s/iter; left time: 3.8121s
	iters: 500, epoch: 6 | loss: 0.8653353
	speed: 0.0033s/iter; left time: 3.4482s
Updating learning rate to 5.747599164933433e-05
Epoch: 6 cost time: 1.7786285877227783
Epoch: 6, Steps: 514 | Train Loss: 0.5407309 Vali Loss: 0.3687679 Best vali loss: 0.3501360
	iters: 100, epoch: 7 | loss: 0.3662912
	speed: 0.0070s/iter; left time: 6.4840s
	iters: 200, epoch: 7 | loss: 0.2779666
	speed: 0.0033s/iter; left time: 2.6955s
	iters: 300, epoch: 7 | loss: 0.3275492
	speed: 0.0034s/iter; left time: 2.4871s
	iters: 400, epoch: 7 | loss: 0.3415597
	speed: 0.0034s/iter; left time: 2.1147s
	iters: 500, epoch: 7 | loss: 0.6972845
	speed: 0.0033s/iter; left time: 1.7663s
Updating learning rate to 1.4937523550216662e-05
Epoch: 7 cost time: 1.7507941722869873
Epoch: 7, Steps: 514 | Train Loss: 0.4021303 Vali Loss: 0.3652891 Best vali loss: 0.3501360
	iters: 100, epoch: 8 | loss: 0.3308861
	speed: 0.0071s/iter; left time: 2.9409s
	iters: 200, epoch: 8 | loss: 0.2023291
	speed: 0.0034s/iter; left time: 1.0591s
	iters: 300, epoch: 8 | loss: 0.3136761
	speed: 0.0036s/iter; left time: 0.7679s
	iters: 400, epoch: 8 | loss: 0.3949035
	speed: 0.0033s/iter; left time: 0.3846s
	iters: 500, epoch: 8 | loss: 0.1992633
	speed: 0.0033s/iter; left time: 0.0500s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7721710205078125
Epoch: 8, Steps: 514 | Train Loss: 0.2882116 Vali Loss: 0.3655994 Best vali loss: 0.3501360

best validation loss 0.3501359666494583

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064223217443, 'e_layers': 4, 'learning_rate': 0.0003952970469, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0059121
	speed: 0.0117s/iter; left time: 46.8431s
	iters: 200, epoch: 1 | loss: 0.6539294
	speed: 0.0051s/iter; left time: 19.9293s
	iters: 300, epoch: 1 | loss: 0.7859173
	speed: 0.0051s/iter; left time: 19.4435s
	iters: 400, epoch: 1 | loss: 0.7293203
	speed: 0.0050s/iter; left time: 18.5719s
	iters: 500, epoch: 1 | loss: 0.5349558
	speed: 0.0051s/iter; left time: 18.3813s
Updating learning rate to 0.0003952970469
Validation loss decreased (inf --> 0.4091).  Saving model state dict ...
Epoch: 1 cost time: 2.9870753288269043
Epoch: 1, Steps: 514 | Train Loss: 0.7420070 Vali Loss: 0.4090501 Best vali loss: 0.4090501
	iters: 100, epoch: 2 | loss: 0.6388025
	speed: 0.0104s/iter; left time: 36.4379s
	iters: 200, epoch: 2 | loss: 0.4471781
	speed: 0.0053s/iter; left time: 17.8678s
	iters: 300, epoch: 2 | loss: 0.3426009
	speed: 0.0053s/iter; left time: 17.4146s
	iters: 400, epoch: 2 | loss: 0.9163465
	speed: 0.0052s/iter; left time: 16.7072s
	iters: 500, epoch: 2 | loss: 1.1738204
	speed: 0.0053s/iter; left time: 16.4294s
Updating learning rate to 0.00019764852345
Validation loss decreased (0.4091 --> 0.3967).  Saving model state dict ...
Epoch: 2 cost time: 2.7506918907165527
Epoch: 2, Steps: 514 | Train Loss: 0.7037497 Vali Loss: 0.3967498 Best vali loss: 0.3967498
	iters: 100, epoch: 3 | loss: 0.7883729
	speed: 0.0106s/iter; left time: 31.6633s
	iters: 200, epoch: 3 | loss: 0.8397022
	speed: 0.0052s/iter; left time: 14.9718s
	iters: 300, epoch: 3 | loss: 0.3674462
	speed: 0.0053s/iter; left time: 14.7363s
	iters: 400, epoch: 3 | loss: 0.7806465
	speed: 0.0053s/iter; left time: 14.2149s
	iters: 500, epoch: 3 | loss: 0.9018089
	speed: 0.0050s/iter; left time: 12.9668s
Updating learning rate to 9.8824261725e-05
Validation loss decreased (0.3967 --> 0.3940).  Saving model state dict ...
Epoch: 3 cost time: 2.712430715560913
Epoch: 3, Steps: 514 | Train Loss: 0.7355953 Vali Loss: 0.3940201 Best vali loss: 0.3940201

best validation loss 0.39402005925393996

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064358939614, 'e_layers': 4, 'learning_rate': 0.0003986513055, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9992747
	speed: 0.0111s/iter; left time: 44.4632s
	iters: 200, epoch: 1 | loss: 0.6464182
	speed: 0.0047s/iter; left time: 18.3743s
	iters: 300, epoch: 1 | loss: 0.7437384
	speed: 0.0046s/iter; left time: 17.7129s
	iters: 400, epoch: 1 | loss: 0.6281678
	speed: 0.0049s/iter; left time: 18.0952s
	iters: 500, epoch: 1 | loss: 0.4306939
	speed: 0.0054s/iter; left time: 19.3561s
Updating learning rate to 0.0003986513055
Validation loss decreased (inf --> 0.3930).  Saving model state dict ...
Epoch: 1 cost time: 2.8748905658721924
Epoch: 1, Steps: 514 | Train Loss: 0.6896586 Vali Loss: 0.3929854 Best vali loss: 0.3929854
	iters: 100, epoch: 2 | loss: 0.5806016
	speed: 0.0104s/iter; left time: 36.4000s
	iters: 200, epoch: 2 | loss: 0.4386391
	speed: 0.0054s/iter; left time: 18.2208s
	iters: 300, epoch: 2 | loss: 0.3282517
	speed: 0.0054s/iter; left time: 17.6819s
	iters: 400, epoch: 2 | loss: 0.6307094
	speed: 0.0052s/iter; left time: 16.7661s
	iters: 500, epoch: 2 | loss: 1.1261939
	speed: 0.0053s/iter; left time: 16.5021s
Updating learning rate to 0.00019932565275
Validation loss decreased (0.3930 --> 0.3806).  Saving model state dict ...
Epoch: 2 cost time: 2.759829521179199
Epoch: 2, Steps: 514 | Train Loss: 0.6208791 Vali Loss: 0.3805599 Best vali loss: 0.3805599
	iters: 100, epoch: 3 | loss: 0.7390018
	speed: 0.0107s/iter; left time: 31.9791s
	iters: 200, epoch: 3 | loss: 0.7917697
	speed: 0.0052s/iter; left time: 15.0450s
	iters: 300, epoch: 3 | loss: 0.3398955
	speed: 0.0052s/iter; left time: 14.5481s
	iters: 400, epoch: 3 | loss: 0.7622884
	speed: 0.0051s/iter; left time: 13.7233s
	iters: 500, epoch: 3 | loss: 0.8494827
	speed: 0.0052s/iter; left time: 13.4619s
Updating learning rate to 9.9662826375e-05
Epoch: 3 cost time: 2.726412534713745
Epoch: 3, Steps: 514 | Train Loss: 0.6964876 Vali Loss: 0.3876220 Best vali loss: 0.3805599

best validation loss 0.3805598624328733

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.005758180707, 'e_layers': 4, 'learning_rate': 0.000396492117, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0089481
	speed: 0.0115s/iter; left time: 46.1846s
	iters: 200, epoch: 1 | loss: 0.6597664
	speed: 0.0053s/iter; left time: 20.8265s
	iters: 300, epoch: 1 | loss: 0.7855266
	speed: 0.0053s/iter; left time: 20.0714s
	iters: 400, epoch: 1 | loss: 0.6482117
	speed: 0.0053s/iter; left time: 19.6993s
	iters: 500, epoch: 1 | loss: 0.5093557
	speed: 0.0047s/iter; left time: 17.0172s
Updating learning rate to 0.000396492117
Validation loss decreased (inf --> 0.4143).  Saving model state dict ...
Epoch: 1 cost time: 3.011380910873413
Epoch: 1, Steps: 514 | Train Loss: 0.7223617 Vali Loss: 0.4143269 Best vali loss: 0.4143269
	iters: 100, epoch: 2 | loss: 0.5896004
	speed: 0.0104s/iter; left time: 36.4241s
	iters: 200, epoch: 2 | loss: 0.4429708
	speed: 0.0053s/iter; left time: 17.9732s
	iters: 300, epoch: 2 | loss: 0.3185101
	speed: 0.0053s/iter; left time: 17.5817s
	iters: 400, epoch: 2 | loss: 0.7820286
	speed: 0.0053s/iter; left time: 17.0543s
	iters: 500, epoch: 2 | loss: 1.1700535
	speed: 0.0054s/iter; left time: 16.6313s
Updating learning rate to 0.0001982460585
Validation loss decreased (0.4143 --> 0.3883).  Saving model state dict ...
Epoch: 2 cost time: 2.774624824523926
Epoch: 2, Steps: 514 | Train Loss: 0.6606327 Vali Loss: 0.3883111 Best vali loss: 0.3883111
	iters: 100, epoch: 3 | loss: 0.8070696
	speed: 0.0111s/iter; left time: 33.1412s
	iters: 200, epoch: 3 | loss: 0.7871512
	speed: 0.0053s/iter; left time: 15.2725s
	iters: 300, epoch: 3 | loss: 0.3175334
	speed: 0.0053s/iter; left time: 14.8359s
	iters: 400, epoch: 3 | loss: 0.7570399
	speed: 0.0054s/iter; left time: 14.3669s
	iters: 500, epoch: 3 | loss: 0.8833317
	speed: 0.0051s/iter; left time: 13.2889s
Updating learning rate to 9.912302925e-05
Validation loss decreased (0.3883 --> 0.3877).  Saving model state dict ...
Epoch: 3 cost time: 2.7726054191589355
Epoch: 3, Steps: 514 | Train Loss: 0.7104252 Vali Loss: 0.3877009 Best vali loss: 0.3877009

best validation loss 0.3877009109335939

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064358939614, 'e_layers': 4, 'learning_rate': 0.0003986513055, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6810880
	speed: 0.0118s/iter; left time: 29.2445s
	iters: 200, epoch: 4 | loss: 0.6406980
	speed: 0.0052s/iter; left time: 12.3961s
	iters: 300, epoch: 4 | loss: 0.7136470
	speed: 0.0053s/iter; left time: 12.0290s
	iters: 400, epoch: 4 | loss: 0.5648461
	speed: 0.0053s/iter; left time: 11.5030s
	iters: 500, epoch: 4 | loss: 0.3389331
	speed: 0.0052s/iter; left time: 10.7831s
Updating learning rate to 4.98314131875e-05
Validation loss decreased (0.3806 --> 0.3705).  Saving model state dict ...
Epoch: 4 cost time: 3.0405828952789307
Epoch: 4, Steps: 514 | Train Loss: 0.5878424 Vali Loss: 0.3705144 Best vali loss: 0.3705144
	iters: 100, epoch: 5 | loss: 0.5878893
	speed: 0.0105s/iter; left time: 20.4675s
	iters: 200, epoch: 5 | loss: 0.3730976
	speed: 0.0048s/iter; left time: 8.8980s
	iters: 300, epoch: 5 | loss: 0.2772222
	speed: 0.0048s/iter; left time: 8.4667s
	iters: 400, epoch: 5 | loss: 0.4997260
	speed: 0.0050s/iter; left time: 8.2377s
	iters: 500, epoch: 5 | loss: 1.0292621
	speed: 0.0051s/iter; left time: 7.9148s
Updating learning rate to 2.491570659375e-05
Epoch: 5 cost time: 2.5960891246795654
Epoch: 5, Steps: 514 | Train Loss: 0.5534394 Vali Loss: 0.3790335 Best vali loss: 0.3705144
	iters: 100, epoch: 6 | loss: 0.6844783
	speed: 0.0105s/iter; left time: 15.1140s
	iters: 200, epoch: 6 | loss: 0.7353293
	speed: 0.0054s/iter; left time: 7.2455s
	iters: 300, epoch: 6 | loss: 0.2685258
	speed: 0.0047s/iter; left time: 5.8441s
	iters: 400, epoch: 6 | loss: 0.7609346
	speed: 0.0046s/iter; left time: 5.2335s
	iters: 500, epoch: 6 | loss: 0.7819351
	speed: 0.0048s/iter; left time: 4.9917s
Updating learning rate to 1.2457853296875e-05
Epoch: 6 cost time: 2.5917012691497803
Epoch: 6, Steps: 514 | Train Loss: 0.6462406 Vali Loss: 0.3893639 Best vali loss: 0.3705144
	iters: 100, epoch: 7 | loss: 0.5833274
	speed: 0.0096s/iter; left time: 8.9535s
	iters: 200, epoch: 7 | loss: 0.3041653
	speed: 0.0046s/iter; left time: 3.8369s
	iters: 300, epoch: 7 | loss: 0.3933621
	speed: 0.0047s/iter; left time: 3.4542s
	iters: 400, epoch: 7 | loss: 0.2961287
	speed: 0.0050s/iter; left time: 3.1349s
	iters: 500, epoch: 7 | loss: 0.4804187
	speed: 0.0047s/iter; left time: 2.4817s
Updating learning rate to 6.2289266484375e-06
Epoch: 7 cost time: 2.4983909130096436
Epoch: 7, Steps: 514 | Train Loss: 0.4114804 Vali Loss: 0.3854371 Best vali loss: 0.3705144
	iters: 100, epoch: 8 | loss: 0.7131811
	speed: 0.0097s/iter; left time: 4.0269s
	iters: 200, epoch: 8 | loss: 0.5922343
	speed: 0.0048s/iter; left time: 1.5247s
	iters: 300, epoch: 8 | loss: 0.2783219
	speed: 0.0047s/iter; left time: 1.0071s
	iters: 400, epoch: 8 | loss: 0.3457424
	speed: 0.0047s/iter; left time: 0.5422s
	iters: 500, epoch: 8 | loss: 0.5269789
	speed: 0.0048s/iter; left time: 0.0721s
Updating learning rate to 3.11446332421875e-06
Epoch: 8 cost time: 2.5001213550567627
Epoch: 8, Steps: 514 | Train Loss: 0.4912917 Vali Loss: 0.3875975 Best vali loss: 0.3705144

best validation loss 0.3705144041296541

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027160277635, 'e_layers': 3, 'learning_rate': 0.0002475634561, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3888439
	speed: 0.0101s/iter; left time: 81.7657s
	iters: 200, epoch: 1 | loss: 0.8442451
	speed: 0.0040s/iter; left time: 32.0638s
	iters: 300, epoch: 1 | loss: 0.4420190
	speed: 0.0042s/iter; left time: 33.6072s
	iters: 400, epoch: 1 | loss: 0.2213083
	speed: 0.0042s/iter; left time: 32.9863s
	iters: 500, epoch: 1 | loss: 0.3333773
	speed: 0.0042s/iter; left time: 32.6118s
	iters: 600, epoch: 1 | loss: 0.6529082
	speed: 0.0040s/iter; left time: 30.3495s
	iters: 700, epoch: 1 | loss: 0.5573618
	speed: 0.0040s/iter; left time: 29.9993s
	iters: 800, epoch: 1 | loss: 1.0711761
	speed: 0.0040s/iter; left time: 29.5226s
	iters: 900, epoch: 1 | loss: 0.2732121
	speed: 0.0040s/iter; left time: 28.9741s
	iters: 1000, epoch: 1 | loss: 0.4206348
	speed: 0.0040s/iter; left time: 28.8995s
Updating learning rate to 0.0002475634561
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 4.519089937210083
Epoch: 1, Steps: 1027 | Train Loss: 0.5205087 Vali Loss: 0.3709460 Best vali loss: 0.3709460
	iters: 100, epoch: 2 | loss: 1.1974020
	speed: 0.0112s/iter; left time: 79.2011s
	iters: 200, epoch: 2 | loss: 0.4947014
	speed: 0.0041s/iter; left time: 28.6571s
	iters: 300, epoch: 2 | loss: 0.4005559
	speed: 0.0041s/iter; left time: 28.1346s
	iters: 400, epoch: 2 | loss: 0.2197523
	speed: 0.0041s/iter; left time: 27.8905s
	iters: 500, epoch: 2 | loss: 0.2560751
	speed: 0.0040s/iter; left time: 27.0208s
	iters: 600, epoch: 2 | loss: 0.4716692
	speed: 0.0041s/iter; left time: 27.2021s
	iters: 700, epoch: 2 | loss: 0.4342684
	speed: 0.0041s/iter; left time: 26.3775s
	iters: 800, epoch: 2 | loss: 0.1960230
	speed: 0.0041s/iter; left time: 26.0736s
	iters: 900, epoch: 2 | loss: 1.0828685
	speed: 0.0041s/iter; left time: 25.9604s
	iters: 1000, epoch: 2 | loss: 0.3512841
	speed: 0.0041s/iter; left time: 25.4478s
Updating learning rate to 0.00012378172805
Validation loss decreased (0.3709 --> 0.3669).  Saving model state dict ...
Epoch: 2 cost time: 4.241452932357788
Epoch: 2, Steps: 1027 | Train Loss: 0.5104600 Vali Loss: 0.3668814 Best vali loss: 0.3668814
	iters: 100, epoch: 3 | loss: 0.4357154
	speed: 0.0106s/iter; left time: 64.2328s
	iters: 200, epoch: 3 | loss: 1.4396557
	speed: 0.0037s/iter; left time: 21.8482s
	iters: 300, epoch: 3 | loss: 0.5064902
	speed: 0.0037s/iter; left time: 21.5659s
	iters: 400, epoch: 3 | loss: 0.6442518
	speed: 0.0036s/iter; left time: 21.0181s
	iters: 500, epoch: 3 | loss: 0.3321581
	speed: 0.0037s/iter; left time: 20.8459s
	iters: 600, epoch: 3 | loss: 0.2719835
	speed: 0.0037s/iter; left time: 20.4263s
	iters: 700, epoch: 3 | loss: 0.3769147
	speed: 0.0037s/iter; left time: 20.1396s
	iters: 800, epoch: 3 | loss: 0.2005877
	speed: 0.0037s/iter; left time: 19.7384s
	iters: 900, epoch: 3 | loss: 0.3127634
	speed: 0.0036s/iter; left time: 18.7857s
	iters: 1000, epoch: 3 | loss: 0.3408509
	speed: 0.0035s/iter; left time: 17.9467s
Updating learning rate to 6.1890864025e-05
Validation loss decreased (0.3669 --> 0.3649).  Saving model state dict ...
Epoch: 3 cost time: 3.7755799293518066
Epoch: 3, Steps: 1027 | Train Loss: 0.4861371 Vali Loss: 0.3648820 Best vali loss: 0.3648820
	iters: 100, epoch: 4 | loss: 0.3377509
	speed: 0.0103s/iter; left time: 52.0977s
	iters: 200, epoch: 4 | loss: 0.6187422
	speed: 0.0035s/iter; left time: 17.0971s
	iters: 300, epoch: 4 | loss: 0.5204406
	speed: 0.0035s/iter; left time: 16.8165s
	iters: 400, epoch: 4 | loss: 1.6247245
	speed: 0.0035s/iter; left time: 16.3787s
	iters: 500, epoch: 4 | loss: 0.2574138
	speed: 0.0035s/iter; left time: 16.1227s
	iters: 600, epoch: 4 | loss: 0.3838083
	speed: 0.0035s/iter; left time: 15.7762s
	iters: 700, epoch: 4 | loss: 2.0454693
	speed: 0.0035s/iter; left time: 15.3458s
	iters: 800, epoch: 4 | loss: 1.0393143
	speed: 0.0035s/iter; left time: 14.9933s
	iters: 900, epoch: 4 | loss: 0.2900600
	speed: 0.0035s/iter; left time: 14.6526s
	iters: 1000, epoch: 4 | loss: 0.4794114
	speed: 0.0036s/iter; left time: 14.7607s
Updating learning rate to 3.09454320125e-05
Epoch: 4 cost time: 3.6130733489990234
Epoch: 4, Steps: 1027 | Train Loss: 0.7597135 Vali Loss: 0.3657628 Best vali loss: 0.3648820
	iters: 100, epoch: 5 | loss: 0.3378744
	speed: 0.0110s/iter; left time: 43.9675s
	iters: 200, epoch: 5 | loss: 0.5282713
	speed: 0.0042s/iter; left time: 16.2839s
	iters: 300, epoch: 5 | loss: 0.6698971
	speed: 0.0042s/iter; left time: 15.8627s
	iters: 400, epoch: 5 | loss: 0.5060028
	speed: 0.0042s/iter; left time: 15.6141s
	iters: 500, epoch: 5 | loss: 0.4933778
	speed: 0.0042s/iter; left time: 15.1402s
	iters: 600, epoch: 5 | loss: 0.6321693
	speed: 0.0042s/iter; left time: 14.6823s
	iters: 700, epoch: 5 | loss: 0.2675937
	speed: 0.0042s/iter; left time: 14.2995s
	iters: 800, epoch: 5 | loss: 0.3497744
	speed: 0.0042s/iter; left time: 13.8353s
	iters: 900, epoch: 5 | loss: 0.3716602
	speed: 0.0042s/iter; left time: 13.4807s
	iters: 1000, epoch: 5 | loss: 0.2360335
	speed: 0.0042s/iter; left time: 12.9845s
Updating learning rate to 1.547271600625e-05
Epoch: 5 cost time: 4.341153383255005
Epoch: 5, Steps: 1027 | Train Loss: 0.4392655 Vali Loss: 0.3674601 Best vali loss: 0.3648820
	iters: 100, epoch: 6 | loss: 0.3932761
	speed: 0.0105s/iter; left time: 31.2748s
	iters: 200, epoch: 6 | loss: 0.9836031
	speed: 0.0034s/iter; left time: 9.8936s
	iters: 300, epoch: 6 | loss: 0.9364315
	speed: 0.0034s/iter; left time: 9.5404s
	iters: 400, epoch: 6 | loss: 0.8098229
	speed: 0.0035s/iter; left time: 9.3639s
	iters: 500, epoch: 6 | loss: 0.3211193
	speed: 0.0034s/iter; left time: 8.8358s
	iters: 600, epoch: 6 | loss: 0.2590439
	speed: 0.0034s/iter; left time: 8.4353s
	iters: 700, epoch: 6 | loss: 0.3294764
	speed: 0.0034s/iter; left time: 8.1576s
	iters: 800, epoch: 6 | loss: 0.2205697
	speed: 0.0035s/iter; left time: 7.9260s
	iters: 900, epoch: 6 | loss: 0.3053796
	speed: 0.0034s/iter; left time: 7.4954s
	iters: 1000, epoch: 6 | loss: 0.3323338
	speed: 0.0034s/iter; left time: 7.0991s
Updating learning rate to 7.736358003125e-06
Epoch: 6 cost time: 3.568347215652466
Epoch: 6, Steps: 1027 | Train Loss: 0.4891056 Vali Loss: 0.3673211 Best vali loss: 0.3648820
	iters: 100, epoch: 7 | loss: 0.3498757
	speed: 0.0101s/iter; left time: 19.7031s
	iters: 200, epoch: 7 | loss: 1.0847222
	speed: 0.0035s/iter; left time: 6.4935s
	iters: 300, epoch: 7 | loss: 0.2390250
	speed: 0.0035s/iter; left time: 6.1229s
	iters: 400, epoch: 7 | loss: 0.7981476
	speed: 0.0035s/iter; left time: 5.8037s
	iters: 500, epoch: 7 | loss: 0.3185993
	speed: 0.0035s/iter; left time: 5.4260s
	iters: 600, epoch: 7 | loss: 0.5756839
	speed: 0.0035s/iter; left time: 5.1222s
	iters: 700, epoch: 7 | loss: 0.3347706
	speed: 0.0035s/iter; left time: 4.7759s
	iters: 800, epoch: 7 | loss: 0.3610642
	speed: 0.0035s/iter; left time: 4.4277s
	iters: 900, epoch: 7 | loss: 0.9995865
	speed: 0.0035s/iter; left time: 4.0762s
	iters: 1000, epoch: 7 | loss: 0.3254401
	speed: 0.0035s/iter; left time: 3.7216s
Updating learning rate to 3.8681790015625e-06
Epoch: 7 cost time: 3.6465749740600586
Epoch: 7, Steps: 1027 | Train Loss: 0.5386915 Vali Loss: 0.3674620 Best vali loss: 0.3648820
	iters: 100, epoch: 8 | loss: 0.4084456
	speed: 0.0100s/iter; left time: 9.2668s
	iters: 200, epoch: 8 | loss: 0.3724263
	speed: 0.0035s/iter; left time: 2.9173s
	iters: 300, epoch: 8 | loss: 0.3290769
	speed: 0.0035s/iter; left time: 2.5655s
	iters: 400, epoch: 8 | loss: 0.3087704
	speed: 0.0035s/iter; left time: 2.2154s
	iters: 500, epoch: 8 | loss: 0.2352025
	speed: 0.0035s/iter; left time: 1.8561s
	iters: 600, epoch: 8 | loss: 0.8242701
	speed: 0.0036s/iter; left time: 1.5451s
	iters: 700, epoch: 8 | loss: 0.2519453
	speed: 0.0040s/iter; left time: 1.2994s
	iters: 800, epoch: 8 | loss: 0.3626851
	speed: 0.0040s/iter; left time: 0.9095s
	iters: 900, epoch: 8 | loss: 0.9206480
	speed: 0.0040s/iter; left time: 0.5087s
	iters: 1000, epoch: 8 | loss: 0.2279024
	speed: 0.0039s/iter; left time: 0.1099s
Updating learning rate to 1.93408950078125e-06
Epoch: 8 cost time: 3.8505663871765137
Epoch: 8, Steps: 1027 | Train Loss: 0.4241373 Vali Loss: 0.3675078 Best vali loss: 0.3648820

best validation loss 0.3648819643294179

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007067957477, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007067957477
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 1.0977675914764404
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3714001 Best vali loss: 0.3714001
Updating learning rate to 0.00035339787385
Validation loss decreased (0.3714 --> 0.3664).  Saving model state dict ...
Epoch: 2 cost time: 0.7715573310852051
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3664123 Best vali loss: 0.3664123
Updating learning rate to 0.000176698936925
Validation loss decreased (0.3664 --> 0.3556).  Saving model state dict ...
Epoch: 3 cost time: 0.764739990234375
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3555571 Best vali loss: 0.3555571
Updating learning rate to 8.83494684625e-05
Validation loss decreased (0.3556 --> 0.3457).  Saving model state dict ...
Epoch: 4 cost time: 0.7745075225830078
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3456665 Best vali loss: 0.3456665
Updating learning rate to 4.417473423125e-05
Epoch: 5 cost time: 0.7681279182434082
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3465504 Best vali loss: 0.3456665
Updating learning rate to 2.2087367115625e-05
Validation loss decreased (0.3457 --> 0.3454).  Saving model state dict ...
Epoch: 6 cost time: 0.7808606624603271
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3453539 Best vali loss: 0.3453539
Updating learning rate to 1.10436835578125e-05
Epoch: 7 cost time: 0.775667667388916
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3459001 Best vali loss: 0.3453539
Updating learning rate to 5.52184177890625e-06
Validation loss decreased (0.3454 --> 0.3436).  Saving model state dict ...
Epoch: 8 cost time: 0.7712862491607666
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3436138 Best vali loss: 0.3436138

best validation loss 0.34361384101138837

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010796583252, 'e_layers': 4, 'learning_rate': 0.0003928704832, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4148237
	speed: 0.0110s/iter; left time: 44.2975s
	iters: 200, epoch: 1 | loss: 0.3373460
	speed: 0.0050s/iter; left time: 19.5973s
	iters: 300, epoch: 1 | loss: 0.4173602
	speed: 0.0054s/iter; left time: 20.4092s
	iters: 400, epoch: 1 | loss: 0.3327210
	speed: 0.0053s/iter; left time: 19.8018s
	iters: 500, epoch: 1 | loss: 0.9107189
	speed: 0.0048s/iter; left time: 17.5198s
Updating learning rate to 0.0003928704832
Validation loss decreased (inf --> 0.3796).  Saving model state dict ...
Epoch: 1 cost time: 2.9518239498138428
Epoch: 1, Steps: 514 | Train Loss: 0.4825939 Vali Loss: 0.3796025 Best vali loss: 0.3796025
	iters: 100, epoch: 2 | loss: 1.1437575
	speed: 0.0104s/iter; left time: 36.3206s
	iters: 200, epoch: 2 | loss: 0.9445434
	speed: 0.0053s/iter; left time: 18.1536s
	iters: 300, epoch: 2 | loss: 0.5833378
	speed: 0.0052s/iter; left time: 17.2443s
	iters: 400, epoch: 2 | loss: 0.4490261
	speed: 0.0053s/iter; left time: 16.8417s
	iters: 500, epoch: 2 | loss: 0.4466549
	speed: 0.0051s/iter; left time: 15.6810s
Updating learning rate to 0.0001964352416
Validation loss decreased (0.3796 --> 0.3771).  Saving model state dict ...
Epoch: 2 cost time: 2.715777635574341
Epoch: 2, Steps: 514 | Train Loss: 0.7134639 Vali Loss: 0.3771499 Best vali loss: 0.3771499
	iters: 100, epoch: 3 | loss: 0.3601198
	speed: 0.0102s/iter; left time: 30.3787s
	iters: 200, epoch: 3 | loss: 0.4156462
	speed: 0.0054s/iter; left time: 15.5396s
	iters: 300, epoch: 3 | loss: 0.7634685
	speed: 0.0052s/iter; left time: 14.3930s
	iters: 400, epoch: 3 | loss: 0.3452916
	speed: 0.0050s/iter; left time: 13.3221s
	iters: 500, epoch: 3 | loss: 0.9531718
	speed: 0.0049s/iter; left time: 12.7906s
Updating learning rate to 9.82176208e-05
Validation loss decreased (0.3771 --> 0.3556).  Saving model state dict ...
Epoch: 3 cost time: 2.6861283779144287
Epoch: 3, Steps: 514 | Train Loss: 0.5675396 Vali Loss: 0.3556073 Best vali loss: 0.3556073

best validation loss 0.35560725960141315

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011326422628, 'e_layers': 2, 'learning_rate': 0.000384445281, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4294308
	speed: 0.0096s/iter; left time: 38.5215s
	iters: 200, epoch: 1 | loss: 0.9813932
	speed: 0.0034s/iter; left time: 13.2781s
	iters: 300, epoch: 1 | loss: 0.5755209
	speed: 0.0035s/iter; left time: 13.2101s
	iters: 400, epoch: 1 | loss: 0.5973912
	speed: 0.0035s/iter; left time: 13.0407s
	iters: 500, epoch: 1 | loss: 0.2595786
	speed: 0.0036s/iter; left time: 12.9699s
Updating learning rate to 0.000384445281
Validation loss decreased (inf --> 0.3745).  Saving model state dict ...
Epoch: 1 cost time: 2.1342713832855225
Epoch: 1, Steps: 514 | Train Loss: 0.5686629 Vali Loss: 0.3744838 Best vali loss: 0.3744838
	iters: 100, epoch: 2 | loss: 0.3331184
	speed: 0.0072s/iter; left time: 25.1848s
	iters: 200, epoch: 2 | loss: 0.3742768
	speed: 0.0034s/iter; left time: 11.5940s
	iters: 300, epoch: 2 | loss: 0.9862387
	speed: 0.0032s/iter; left time: 10.6063s
	iters: 400, epoch: 2 | loss: 0.4175298
	speed: 0.0031s/iter; left time: 10.0647s
	iters: 500, epoch: 2 | loss: 0.6779953
	speed: 0.0031s/iter; left time: 9.6044s
Updating learning rate to 0.0001922226405
Validation loss decreased (0.3745 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 1.7049250602722168
Epoch: 2, Steps: 514 | Train Loss: 0.5578318 Vali Loss: 0.3672574 Best vali loss: 0.3672574
	iters: 100, epoch: 3 | loss: 0.2593051
	speed: 0.0073s/iter; left time: 21.6718s
	iters: 200, epoch: 3 | loss: 0.4054916
	speed: 0.0033s/iter; left time: 9.4294s
	iters: 300, epoch: 3 | loss: 0.6409376
	speed: 0.0031s/iter; left time: 8.6237s
	iters: 400, epoch: 3 | loss: 0.6330328
	speed: 0.0031s/iter; left time: 8.2394s
	iters: 500, epoch: 3 | loss: 0.3569188
	speed: 0.0030s/iter; left time: 7.8126s
Updating learning rate to 9.611132025e-05
Validation loss decreased (0.3673 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 1.6439571380615234
Epoch: 3, Steps: 514 | Train Loss: 0.4591372 Vali Loss: 0.3661532 Best vali loss: 0.3661532

best validation loss 0.3661531874379381

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0111934947977, 'e_layers': 4, 'learning_rate': 5.1332936e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7519712
	speed: 0.0121s/iter; left time: 11.3061s
Updating learning rate to 4.93791924570559e-05
Validation loss decreased (inf --> 0.4166).  Saving model state dict ...
Epoch: 1 cost time: 1.1068220138549805
Epoch: 1, Steps: 129 | Train Loss: 0.7519712 Vali Loss: 0.4165629 Best vali loss: 0.4165629
	iters: 100, epoch: 2 | loss: 0.6961192
	speed: 0.0096s/iter; left time: 7.7147s
Updating learning rate to 4.381540157190752e-05
Validation loss decreased (0.4166 --> 0.3985).  Saving model state dict ...
Epoch: 2 cost time: 0.7992804050445557
Epoch: 2, Steps: 129 | Train Loss: 0.6961192 Vali Loss: 0.3984919 Best vali loss: 0.3984919
	iters: 100, epoch: 3 | loss: 0.6766770
	speed: 0.0091s/iter; left time: 6.1248s
Updating learning rate to 3.548860007092875e-05
Validation loss decreased (0.3985 --> 0.3896).  Saving model state dict ...
Epoch: 3 cost time: 0.7277131080627441
Epoch: 3, Steps: 129 | Train Loss: 0.6766770 Vali Loss: 0.3896402 Best vali loss: 0.3896402

best validation loss 0.3896401581689276

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010796583252, 'e_layers': 4, 'learning_rate': 0.0003928704832, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4379641
	speed: 0.0115s/iter; left time: 28.4403s
	iters: 200, epoch: 4 | loss: 0.3199284
	speed: 0.0052s/iter; left time: 12.3130s
	iters: 300, epoch: 4 | loss: 0.3008285
	speed: 0.0052s/iter; left time: 11.8609s
	iters: 400, epoch: 4 | loss: 0.3101302
	speed: 0.0050s/iter; left time: 10.8458s
	iters: 500, epoch: 4 | loss: 0.7508012
	speed: 0.0047s/iter; left time: 9.8364s
Updating learning rate to 4.91088104e-05
Epoch: 4 cost time: 2.9519448280334473
Epoch: 4, Steps: 514 | Train Loss: 0.4239305 Vali Loss: 0.3561390 Best vali loss: 0.3556073
	iters: 100, epoch: 5 | loss: 1.0105057
	speed: 0.0096s/iter; left time: 18.7158s
	iters: 200, epoch: 5 | loss: 0.8356493
	speed: 0.0045s/iter; left time: 8.4127s
	iters: 300, epoch: 5 | loss: 0.4672225
	speed: 0.0049s/iter; left time: 8.5269s
	iters: 400, epoch: 5 | loss: 0.3841535
	speed: 0.0048s/iter; left time: 7.9606s
	iters: 500, epoch: 5 | loss: 0.4326861
	speed: 0.0045s/iter; left time: 6.9736s
Updating learning rate to 2.45544052e-05
Validation loss decreased (0.3556 --> 0.3513).  Saving model state dict ...
Epoch: 5 cost time: 2.438941478729248
Epoch: 5, Steps: 514 | Train Loss: 0.6260434 Vali Loss: 0.3513481 Best vali loss: 0.3513481
	iters: 100, epoch: 6 | loss: 0.2872806
	speed: 0.0103s/iter; left time: 14.8856s
	iters: 200, epoch: 6 | loss: 0.4269466
	speed: 0.0053s/iter; left time: 7.0864s
	iters: 300, epoch: 6 | loss: 0.7151351
	speed: 0.0051s/iter; left time: 6.3860s
	iters: 400, epoch: 6 | loss: 0.3080547
	speed: 0.0052s/iter; left time: 5.9173s
	iters: 500, epoch: 6 | loss: 0.9030182
	speed: 0.0052s/iter; left time: 5.3895s
Updating learning rate to 1.22772026e-05
Validation loss decreased (0.3513 --> 0.3483).  Saving model state dict ...
Epoch: 6 cost time: 2.721634864807129
Epoch: 6, Steps: 514 | Train Loss: 0.5280870 Vali Loss: 0.3483441 Best vali loss: 0.3483441
	iters: 100, epoch: 7 | loss: 0.6099818
	speed: 0.0102s/iter; left time: 9.5111s
	iters: 200, epoch: 7 | loss: 0.8318385
	speed: 0.0052s/iter; left time: 4.3386s
	iters: 300, epoch: 7 | loss: 0.3632901
	speed: 0.0053s/iter; left time: 3.8512s
	iters: 400, epoch: 7 | loss: 0.2484289
	speed: 0.0049s/iter; left time: 3.1000s
	iters: 500, epoch: 7 | loss: 0.3198118
	speed: 0.0045s/iter; left time: 2.4044s
Updating learning rate to 6.1386013e-06
Validation loss decreased (0.3483 --> 0.3460).  Saving model state dict ...
Epoch: 7 cost time: 2.624082088470459
Epoch: 7, Steps: 514 | Train Loss: 0.4746702 Vali Loss: 0.3460272 Best vali loss: 0.3460272
	iters: 100, epoch: 8 | loss: 0.5158327
	speed: 0.0095s/iter; left time: 3.9500s
	iters: 200, epoch: 8 | loss: 0.6753006
	speed: 0.0051s/iter; left time: 1.6162s
	iters: 300, epoch: 8 | loss: 0.4020933
	speed: 0.0051s/iter; left time: 1.1027s
	iters: 400, epoch: 8 | loss: 0.6223431
	speed: 0.0051s/iter; left time: 0.5911s
	iters: 500, epoch: 8 | loss: 0.5817921
	speed: 0.0051s/iter; left time: 0.0770s
Updating learning rate to 3.06930065e-06
Epoch: 8 cost time: 2.6404306888580322
Epoch: 8, Steps: 514 | Train Loss: 0.5594723 Vali Loss: 0.3462869 Best vali loss: 0.3460272

best validation loss 0.34602721314181983

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010957630701, 'e_layers': 1, 'learning_rate': 0.0003838615028, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8180206
	speed: 0.0088s/iter; left time: 35.3314s
	iters: 200, epoch: 1 | loss: 0.9374940
	speed: 0.0023s/iter; left time: 9.0059s
	iters: 300, epoch: 1 | loss: 0.4542818
	speed: 0.0023s/iter; left time: 8.6463s
	iters: 400, epoch: 1 | loss: 1.1236619
	speed: 0.0023s/iter; left time: 8.4518s
	iters: 500, epoch: 1 | loss: 0.4979444
	speed: 0.0023s/iter; left time: 8.3230s
Updating learning rate to 0.000369251644277972
Validation loss decreased (inf --> 0.3641).  Saving model state dict ...
Epoch: 1 cost time: 1.5659902095794678
Epoch: 1, Steps: 514 | Train Loss: 0.7662805 Vali Loss: 0.3640732 Best vali loss: 0.3640732
	iters: 100, epoch: 2 | loss: 0.8521062
	speed: 0.0060s/iter; left time: 20.9572s
	iters: 200, epoch: 2 | loss: 0.4201979
	speed: 0.0027s/iter; left time: 9.0567s
	iters: 300, epoch: 2 | loss: 1.0777216
	speed: 0.0026s/iter; left time: 8.4346s
	iters: 400, epoch: 2 | loss: 0.5024536
	speed: 0.0025s/iter; left time: 7.9864s
	iters: 500, epoch: 2 | loss: 0.3324208
	speed: 0.0025s/iter; left time: 7.7045s
Updating learning rate to 0.0003276462872331694
Epoch: 2 cost time: 1.354370355606079
Epoch: 2, Steps: 514 | Train Loss: 0.6369800 Vali Loss: 0.3694173 Best vali loss: 0.3640732
	iters: 100, epoch: 3 | loss: 0.2336953
	speed: 0.0058s/iter; left time: 17.1856s
	iters: 200, epoch: 3 | loss: 0.5352587
	speed: 0.0024s/iter; left time: 6.9934s
	iters: 300, epoch: 3 | loss: 1.1830108
	speed: 0.0024s/iter; left time: 6.8006s
	iters: 400, epoch: 3 | loss: 0.7731975
	speed: 0.0026s/iter; left time: 6.9455s
	iters: 500, epoch: 3 | loss: 0.8329077
	speed: 0.0025s/iter; left time: 6.3891s
Updating learning rate to 0.00026537947012216276
Epoch: 3 cost time: 1.3131847381591797
Epoch: 3, Steps: 514 | Train Loss: 0.7116140 Vali Loss: 0.3729842 Best vali loss: 0.3640732
	iters: 100, epoch: 4 | loss: 0.4213631
	speed: 0.0060s/iter; left time: 14.8300s
	iters: 200, epoch: 4 | loss: 0.5220853
	speed: 0.0026s/iter; left time: 6.1429s
	iters: 300, epoch: 4 | loss: 0.3880851
	speed: 0.0026s/iter; left time: 5.9264s
	iters: 400, epoch: 4 | loss: 0.4469547
	speed: 0.0027s/iter; left time: 5.7626s
	iters: 500, epoch: 4 | loss: 0.3109614
	speed: 0.0023s/iter; left time: 4.7481s
Updating learning rate to 0.0001919307514
Epoch: 4 cost time: 1.351283073425293
Epoch: 4, Steps: 514 | Train Loss: 0.4178899 Vali Loss: 0.3840709 Best vali loss: 0.3640732
	iters: 100, epoch: 5 | loss: 0.3577589
	speed: 0.0057s/iter; left time: 11.2384s
	iters: 200, epoch: 5 | loss: 0.6618077
	speed: 0.0023s/iter; left time: 4.3591s
	iters: 300, epoch: 5 | loss: 0.7720430
	speed: 0.0024s/iter; left time: 4.1325s
	iters: 400, epoch: 5 | loss: 0.3116075
	speed: 0.0023s/iter; left time: 3.7692s
	iters: 500, epoch: 5 | loss: 0.6909406
	speed: 0.0022s/iter; left time: 3.4107s
Updating learning rate to 0.00011848203267783724
Epoch: 5 cost time: 1.2392957210540771
Epoch: 5, Steps: 514 | Train Loss: 0.5588315 Vali Loss: 0.3867973 Best vali loss: 0.3640732
	iters: 100, epoch: 6 | loss: 0.4294904
	speed: 0.0061s/iter; left time: 8.8258s
	iters: 200, epoch: 6 | loss: 0.5978059
	speed: 0.0027s/iter; left time: 3.5791s
	iters: 300, epoch: 6 | loss: 0.8802748
	speed: 0.0025s/iter; left time: 3.1683s
	iters: 400, epoch: 6 | loss: 0.5560060
	speed: 0.0025s/iter; left time: 2.8785s
	iters: 500, epoch: 6 | loss: 0.6458200
	speed: 0.0025s/iter; left time: 2.5984s
Updating learning rate to 5.6215215566830556e-05
Epoch: 6 cost time: 1.3737192153930664
Epoch: 6, Steps: 514 | Train Loss: 0.6218794 Vali Loss: 0.3791254 Best vali loss: 0.3640732
	iters: 100, epoch: 7 | loss: 0.7121102
	speed: 0.0058s/iter; left time: 5.3800s
	iters: 200, epoch: 7 | loss: 0.6822925
	speed: 0.0024s/iter; left time: 2.0165s
	iters: 300, epoch: 7 | loss: 0.2387954
	speed: 0.0024s/iter; left time: 1.7683s
	iters: 400, epoch: 7 | loss: 0.9476687
	speed: 0.0024s/iter; left time: 1.5241s
	iters: 500, epoch: 7 | loss: 0.3377140
	speed: 0.0024s/iter; left time: 1.2807s
Updating learning rate to 1.4609858522028007e-05
Epoch: 7 cost time: 1.2901301383972168
Epoch: 7, Steps: 514 | Train Loss: 0.5837162 Vali Loss: 0.3875680 Best vali loss: 0.3640732
	iters: 100, epoch: 8 | loss: 0.2782721
	speed: 0.0059s/iter; left time: 2.4479s
	iters: 200, epoch: 8 | loss: 0.3314638
	speed: 0.0026s/iter; left time: 0.8091s
	iters: 300, epoch: 8 | loss: 0.4114350
	speed: 0.0025s/iter; left time: 0.5358s
	iters: 400, epoch: 8 | loss: 0.6591302
	speed: 0.0024s/iter; left time: 0.2773s
	iters: 500, epoch: 8 | loss: 0.3590675
	speed: 0.0024s/iter; left time: 0.0360s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3243093490600586
Epoch: 8, Steps: 514 | Train Loss: 0.4078737 Vali Loss: 0.3881141 Best vali loss: 0.3640732

best validation loss 0.36407324180504663

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029962572618, 'e_layers': 2, 'learning_rate': 0.0003903036699, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4267207
	speed: 0.0096s/iter; left time: 38.5942s
	iters: 200, epoch: 1 | loss: 1.0779810
	speed: 0.0033s/iter; left time: 13.0926s
	iters: 300, epoch: 1 | loss: 1.0152067
	speed: 0.0033s/iter; left time: 12.5006s
	iters: 400, epoch: 1 | loss: 0.5031625
	speed: 0.0033s/iter; left time: 12.1578s
	iters: 500, epoch: 1 | loss: 1.1181215
	speed: 0.0033s/iter; left time: 11.8861s
Updating learning rate to 0.0003903036699
Validation loss decreased (inf --> 0.3719).  Saving model state dict ...
Epoch: 1 cost time: 2.055394172668457
Epoch: 1, Steps: 514 | Train Loss: 0.8282385 Vali Loss: 0.3719062 Best vali loss: 0.3719062
	iters: 100, epoch: 2 | loss: 0.3911197
	speed: 0.0070s/iter; left time: 24.5095s
	iters: 200, epoch: 2 | loss: 0.2885078
	speed: 0.0032s/iter; left time: 10.7907s
	iters: 300, epoch: 2 | loss: 0.4969686
	speed: 0.0031s/iter; left time: 10.1844s
	iters: 400, epoch: 2 | loss: 0.3917179
	speed: 0.0031s/iter; left time: 9.8596s
	iters: 500, epoch: 2 | loss: 0.6673131
	speed: 0.0030s/iter; left time: 9.2353s
Updating learning rate to 0.00019515183495
Validation loss decreased (0.3719 --> 0.3584).  Saving model state dict ...
Epoch: 2 cost time: 1.6209557056427002
Epoch: 2, Steps: 514 | Train Loss: 0.4471254 Vali Loss: 0.3583906 Best vali loss: 0.3583906
	iters: 100, epoch: 3 | loss: 0.3513871
	speed: 0.0076s/iter; left time: 22.7699s
	iters: 200, epoch: 3 | loss: 0.8514736
	speed: 0.0031s/iter; left time: 8.8292s
	iters: 300, epoch: 3 | loss: 0.4859660
	speed: 0.0032s/iter; left time: 8.9422s
	iters: 400, epoch: 3 | loss: 0.4421287
	speed: 0.0032s/iter; left time: 8.5879s
	iters: 500, epoch: 3 | loss: 1.0402138
	speed: 0.0032s/iter; left time: 8.2471s
Updating learning rate to 9.7575917475e-05
Validation loss decreased (0.3584 --> 0.3513).  Saving model state dict ...
Epoch: 3 cost time: 1.6870977878570557
Epoch: 3, Steps: 514 | Train Loss: 0.6342339 Vali Loss: 0.3512746 Best vali loss: 0.3512746
	iters: 100, epoch: 4 | loss: 0.5635818
	speed: 0.0077s/iter; left time: 18.9990s
	iters: 200, epoch: 4 | loss: 0.4470826
	speed: 0.0033s/iter; left time: 7.7895s
	iters: 300, epoch: 4 | loss: 0.4591803
	speed: 0.0033s/iter; left time: 7.5534s
	iters: 400, epoch: 4 | loss: 0.6533483
	speed: 0.0033s/iter; left time: 7.0785s
	iters: 500, epoch: 4 | loss: 0.7008246
	speed: 0.0033s/iter; left time: 6.7869s
Updating learning rate to 4.87879587375e-05
Validation loss decreased (0.3513 --> 0.3433).  Saving model state dict ...
Epoch: 4 cost time: 1.7596354484558105
Epoch: 4, Steps: 514 | Train Loss: 0.5648035 Vali Loss: 0.3432710 Best vali loss: 0.3432710
	iters: 100, epoch: 5 | loss: 0.5549530
	speed: 0.0078s/iter; left time: 15.1982s
	iters: 200, epoch: 5 | loss: 0.7244548
	speed: 0.0036s/iter; left time: 6.6767s
	iters: 300, epoch: 5 | loss: 0.4601391
	speed: 0.0036s/iter; left time: 6.2732s
	iters: 400, epoch: 5 | loss: 0.7400370
	speed: 0.0033s/iter; left time: 5.4024s
	iters: 500, epoch: 5 | loss: 0.5393606
	speed: 0.0033s/iter; left time: 5.1050s
Updating learning rate to 2.439397936875e-05
Epoch: 5 cost time: 1.8240113258361816
Epoch: 5, Steps: 514 | Train Loss: 0.6037889 Vali Loss: 0.3514505 Best vali loss: 0.3432710
	iters: 100, epoch: 6 | loss: 0.3043372
	speed: 0.0074s/iter; left time: 10.6647s
	iters: 200, epoch: 6 | loss: 0.5007055
	speed: 0.0033s/iter; left time: 4.3890s
	iters: 300, epoch: 6 | loss: 0.3627127
	speed: 0.0031s/iter; left time: 3.8108s
	iters: 400, epoch: 6 | loss: 0.7428978
	speed: 0.0033s/iter; left time: 3.8062s
	iters: 500, epoch: 6 | loss: 0.9390587
	speed: 0.0032s/iter; left time: 3.3886s
Updating learning rate to 1.2196989684375e-05
Epoch: 6 cost time: 1.700136423110962
Epoch: 6, Steps: 514 | Train Loss: 0.5699424 Vali Loss: 0.3469981 Best vali loss: 0.3432710
	iters: 100, epoch: 7 | loss: 0.3805158
	speed: 0.0072s/iter; left time: 6.7022s
	iters: 200, epoch: 7 | loss: 0.3009079
	speed: 0.0034s/iter; left time: 2.8376s
	iters: 300, epoch: 7 | loss: 0.3653031
	speed: 0.0035s/iter; left time: 2.5789s
	iters: 400, epoch: 7 | loss: 0.4075508
	speed: 0.0035s/iter; left time: 2.1845s
	iters: 500, epoch: 7 | loss: 0.7859224
	speed: 0.0034s/iter; left time: 1.7764s
Updating learning rate to 6.0984948421875e-06
Epoch: 7 cost time: 1.8117001056671143
Epoch: 7, Steps: 514 | Train Loss: 0.4480400 Vali Loss: 0.3449140 Best vali loss: 0.3432710
	iters: 100, epoch: 8 | loss: 0.3763767
	speed: 0.0074s/iter; left time: 3.0766s
	iters: 200, epoch: 8 | loss: 0.2213349
	speed: 0.0036s/iter; left time: 1.1485s
	iters: 300, epoch: 8 | loss: 0.3556735
	speed: 0.0035s/iter; left time: 0.7560s
	iters: 400, epoch: 8 | loss: 0.4361764
	speed: 0.0036s/iter; left time: 0.4111s
	iters: 500, epoch: 8 | loss: 0.2419214
	speed: 0.0036s/iter; left time: 0.0545s
Updating learning rate to 3.04924742109375e-06
Epoch: 8 cost time: 1.8836162090301514
Epoch: 8, Steps: 514 | Train Loss: 0.3262966 Vali Loss: 0.3461734 Best vali loss: 0.3432710

best validation loss 0.34327095828965043

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0030562438668, 'e_layers': 2, 'learning_rate': 0.0003918426368, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266975
	speed: 0.0094s/iter; left time: 37.8964s
	iters: 200, epoch: 1 | loss: 1.0780730
	speed: 0.0033s/iter; left time: 12.9854s
	iters: 300, epoch: 1 | loss: 1.0154572
	speed: 0.0032s/iter; left time: 12.3262s
	iters: 400, epoch: 1 | loss: 0.5056761
	speed: 0.0032s/iter; left time: 11.9494s
	iters: 500, epoch: 1 | loss: 1.1293002
	speed: 0.0033s/iter; left time: 11.9448s
Updating learning rate to 0.0003918426368
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 2.0446174144744873
Epoch: 1, Steps: 514 | Train Loss: 0.8310408 Vali Loss: 0.3728201 Best vali loss: 0.3728201
	iters: 100, epoch: 2 | loss: 0.3895372
	speed: 0.0071s/iter; left time: 24.8053s
	iters: 200, epoch: 2 | loss: 0.2958850
	speed: 0.0033s/iter; left time: 11.2204s
	iters: 300, epoch: 2 | loss: 0.4891671
	speed: 0.0031s/iter; left time: 10.2486s
	iters: 400, epoch: 2 | loss: 0.3906141
	speed: 0.0031s/iter; left time: 9.9201s
	iters: 500, epoch: 2 | loss: 0.6190823
	speed: 0.0032s/iter; left time: 9.9225s
Updating learning rate to 0.0001959213184
Validation loss decreased (0.3728 --> 0.3530).  Saving model state dict ...
Epoch: 2 cost time: 1.6806612014770508
Epoch: 2, Steps: 514 | Train Loss: 0.4368571 Vali Loss: 0.3530474 Best vali loss: 0.3530474
	iters: 100, epoch: 3 | loss: 0.3566381
	speed: 0.0076s/iter; left time: 22.7992s
	iters: 200, epoch: 3 | loss: 0.8634261
	speed: 0.0036s/iter; left time: 10.4384s
	iters: 300, epoch: 3 | loss: 0.4953440
	speed: 0.0036s/iter; left time: 10.0573s
	iters: 400, epoch: 3 | loss: 0.4621620
	speed: 0.0036s/iter; left time: 9.7056s
	iters: 500, epoch: 3 | loss: 1.0589350
	speed: 0.0033s/iter; left time: 8.5692s
Updating learning rate to 9.79606592e-05
Validation loss decreased (0.3530 --> 0.3474).  Saving model state dict ...
Epoch: 3 cost time: 1.8655784130096436
Epoch: 3, Steps: 514 | Train Loss: 0.6473011 Vali Loss: 0.3474444 Best vali loss: 0.3474444

best validation loss 0.34744442813757126

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010603841393, 'e_layers': 2, 'learning_rate': 0.0003776371711, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4263669
	speed: 0.0096s/iter; left time: 38.5442s
	iters: 200, epoch: 1 | loss: 1.0771732
	speed: 0.0034s/iter; left time: 13.3867s
	iters: 300, epoch: 1 | loss: 1.0153660
	speed: 0.0036s/iter; left time: 13.6707s
	iters: 400, epoch: 1 | loss: 0.5040479
	speed: 0.0036s/iter; left time: 13.2549s
	iters: 500, epoch: 1 | loss: 1.1424855
	speed: 0.0035s/iter; left time: 12.7885s
Updating learning rate to 0.0003776371711
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 2.1555867195129395
Epoch: 1, Steps: 514 | Train Loss: 0.8330879 Vali Loss: 0.3741653 Best vali loss: 0.3741653
	iters: 100, epoch: 2 | loss: 0.3881741
	speed: 0.0075s/iter; left time: 26.2200s
	iters: 200, epoch: 2 | loss: 0.2560432
	speed: 0.0036s/iter; left time: 12.1053s
	iters: 300, epoch: 2 | loss: 0.5120695
	speed: 0.0036s/iter; left time: 11.7980s
	iters: 400, epoch: 2 | loss: 0.3875155
	speed: 0.0036s/iter; left time: 11.5813s
	iters: 500, epoch: 2 | loss: 0.6163341
	speed: 0.0036s/iter; left time: 11.0972s
Updating learning rate to 0.00018881858555
Validation loss decreased (0.3742 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 1.879542350769043
Epoch: 2, Steps: 514 | Train Loss: 0.4320273 Vali Loss: 0.3697226 Best vali loss: 0.3697226
	iters: 100, epoch: 3 | loss: 0.3940038
	speed: 0.0075s/iter; left time: 22.3096s
	iters: 200, epoch: 3 | loss: 0.8339792
	speed: 0.0034s/iter; left time: 9.8970s
	iters: 300, epoch: 3 | loss: 0.5277779
	speed: 0.0032s/iter; left time: 8.9829s
	iters: 400, epoch: 3 | loss: 0.4462474
	speed: 0.0034s/iter; left time: 9.0184s
	iters: 500, epoch: 3 | loss: 1.1182625
	speed: 0.0035s/iter; left time: 8.9924s
Updating learning rate to 9.4409292775e-05
Epoch: 3 cost time: 1.7825536727905273
Epoch: 3, Steps: 514 | Train Loss: 0.6640542 Vali Loss: 0.3713135 Best vali loss: 0.3697226

best validation loss 0.3697226415038811

[INFO][smbo.py:320] Finished 950 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008257342318, 'e_layers': 2, 'learning_rate': 0.0003732872725, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4262925
	speed: 0.0096s/iter; left time: 38.7179s
	iters: 200, epoch: 1 | loss: 1.0768279
	speed: 0.0034s/iter; left time: 13.1294s
	iters: 300, epoch: 1 | loss: 1.0151014
	speed: 0.0034s/iter; left time: 12.7978s
	iters: 400, epoch: 1 | loss: 0.5052729
	speed: 0.0033s/iter; left time: 12.4317s
	iters: 500, epoch: 1 | loss: 1.1576241
	speed: 0.0037s/iter; left time: 13.2462s
Updating learning rate to 0.0003732872725
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 2.1279051303863525
Epoch: 1, Steps: 514 | Train Loss: 0.8362238 Vali Loss: 0.3713829 Best vali loss: 0.3713829
	iters: 100, epoch: 2 | loss: 0.3950194
	speed: 0.0073s/iter; left time: 25.5670s
	iters: 200, epoch: 2 | loss: 0.3194677
	speed: 0.0035s/iter; left time: 11.8012s
	iters: 300, epoch: 2 | loss: 0.4622435
	speed: 0.0036s/iter; left time: 11.8514s
	iters: 400, epoch: 2 | loss: 0.3898275
	speed: 0.0036s/iter; left time: 11.4391s
	iters: 500, epoch: 2 | loss: 0.6377721
	speed: 0.0033s/iter; left time: 10.3544s
Updating learning rate to 0.00018664363625
Validation loss decreased (0.3714 --> 0.3576).  Saving model state dict ...
Epoch: 2 cost time: 1.823460340499878
Epoch: 2, Steps: 514 | Train Loss: 0.4408660 Vali Loss: 0.3575816 Best vali loss: 0.3575816
	iters: 100, epoch: 3 | loss: 0.3614173
	speed: 0.0076s/iter; left time: 22.7415s
	iters: 200, epoch: 3 | loss: 0.8676820
	speed: 0.0035s/iter; left time: 10.2236s
	iters: 300, epoch: 3 | loss: 0.4930085
	speed: 0.0034s/iter; left time: 9.5762s
	iters: 400, epoch: 3 | loss: 0.4670099
	speed: 0.0033s/iter; left time: 8.9447s
	iters: 500, epoch: 3 | loss: 1.0429682
	speed: 0.0033s/iter; left time: 8.5243s
Updating learning rate to 9.3321818125e-05
Epoch: 3 cost time: 1.8107900619506836
Epoch: 3, Steps: 514 | Train Loss: 0.6464172 Vali Loss: 0.3621551 Best vali loss: 0.3575816

best validation loss 0.3575815820038202

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0030562438668, 'e_layers': 2, 'learning_rate': 0.0003918426368, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3710196
	speed: 0.0107s/iter; left time: 26.3204s
	iters: 200, epoch: 4 | loss: 0.8936736
	speed: 0.0036s/iter; left time: 8.5121s
	iters: 300, epoch: 4 | loss: 0.7639294
	speed: 0.0036s/iter; left time: 8.2710s
	iters: 400, epoch: 4 | loss: 0.4711006
	speed: 0.0036s/iter; left time: 7.8481s
	iters: 500, epoch: 4 | loss: 0.4255719
	speed: 0.0034s/iter; left time: 7.1031s
Updating learning rate to 4.89803296e-05
Validation loss decreased (0.3474 --> 0.3438).  Saving model state dict ...
Epoch: 4 cost time: 2.1916701793670654
Epoch: 4, Steps: 514 | Train Loss: 0.5850590 Vali Loss: 0.3437770 Best vali loss: 0.3437770
	iters: 100, epoch: 5 | loss: 0.3983611
	speed: 0.0076s/iter; left time: 14.8222s
	iters: 200, epoch: 5 | loss: 0.2498350
	speed: 0.0033s/iter; left time: 6.2195s
	iters: 300, epoch: 5 | loss: 0.3540259
	speed: 0.0033s/iter; left time: 5.7315s
	iters: 400, epoch: 5 | loss: 0.3844615
	speed: 0.0032s/iter; left time: 5.3074s
	iters: 500, epoch: 5 | loss: 0.5791451
	speed: 0.0032s/iter; left time: 5.0236s
Updating learning rate to 2.44901648e-05
Epoch: 5 cost time: 1.7360270023345947
Epoch: 5, Steps: 514 | Train Loss: 0.3931657 Vali Loss: 0.3454068 Best vali loss: 0.3437770
	iters: 100, epoch: 6 | loss: 0.3033514
	speed: 0.0074s/iter; left time: 10.7322s
	iters: 200, epoch: 6 | loss: 0.7691159
	speed: 0.0035s/iter; left time: 4.7428s
	iters: 300, epoch: 6 | loss: 0.4465114
	speed: 0.0035s/iter; left time: 4.3854s
	iters: 400, epoch: 6 | loss: 0.4358569
	speed: 0.0035s/iter; left time: 4.0109s
	iters: 500, epoch: 6 | loss: 0.9652810
	speed: 0.0034s/iter; left time: 3.5840s
Updating learning rate to 1.22450824e-05
Epoch: 6 cost time: 1.8393356800079346
Epoch: 6, Steps: 514 | Train Loss: 0.5840233 Vali Loss: 0.3447596 Best vali loss: 0.3437770
	iters: 100, epoch: 7 | loss: 0.5499706
	speed: 0.0070s/iter; left time: 6.5323s
	iters: 200, epoch: 7 | loss: 0.4248092
	speed: 0.0031s/iter; left time: 2.5340s
	iters: 300, epoch: 7 | loss: 0.4450123
	speed: 0.0031s/iter; left time: 2.2374s
	iters: 400, epoch: 7 | loss: 0.6219201
	speed: 0.0031s/iter; left time: 1.9250s
	iters: 500, epoch: 7 | loss: 0.6568889
	speed: 0.0031s/iter; left time: 1.6190s
Updating learning rate to 6.1225412e-06
Validation loss decreased (0.3438 --> 0.3429).  Saving model state dict ...
Epoch: 7 cost time: 1.6286098957061768
Epoch: 7, Steps: 514 | Train Loss: 0.5397202 Vali Loss: 0.3428567 Best vali loss: 0.3428567
	iters: 100, epoch: 8 | loss: 0.5330824
	speed: 0.0073s/iter; left time: 3.0126s
	iters: 200, epoch: 8 | loss: 0.7013763
	speed: 0.0032s/iter; left time: 0.9972s
	iters: 300, epoch: 8 | loss: 0.4614483
	speed: 0.0032s/iter; left time: 0.6897s
	iters: 400, epoch: 8 | loss: 0.7944287
	speed: 0.0032s/iter; left time: 0.3626s
	iters: 500, epoch: 8 | loss: 0.5246463
	speed: 0.0031s/iter; left time: 0.0467s
Updating learning rate to 3.0612706e-06
Epoch: 8 cost time: 1.680781364440918
Epoch: 8, Steps: 514 | Train Loss: 0.6029964 Vali Loss: 0.3446167 Best vali loss: 0.3428567

best validation loss 0.34285670638318616

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008164446527, 'e_layers': 2, 'learning_rate': 0.0003760212659, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4263124
	speed: 0.0097s/iter; left time: 39.0233s
	iters: 200, epoch: 1 | loss: 1.0769495
	speed: 0.0033s/iter; left time: 12.9832s
	iters: 300, epoch: 1 | loss: 1.0151544
	speed: 0.0031s/iter; left time: 11.7947s
	iters: 400, epoch: 1 | loss: 0.5051895
	speed: 0.0035s/iter; left time: 12.9785s
	iters: 500, epoch: 1 | loss: 1.1667999
	speed: 0.0036s/iter; left time: 12.8295s
Updating learning rate to 0.0003760212659
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 2.115204095840454
Epoch: 1, Steps: 514 | Train Loss: 0.8380811 Vali Loss: 0.3733320 Best vali loss: 0.3733320
	iters: 100, epoch: 2 | loss: 0.3878258
	speed: 0.0075s/iter; left time: 26.1719s
	iters: 200, epoch: 2 | loss: 0.2705222
	speed: 0.0036s/iter; left time: 12.0691s
	iters: 300, epoch: 2 | loss: 0.4533783
	speed: 0.0036s/iter; left time: 11.8277s
	iters: 400, epoch: 2 | loss: 0.3853898
	speed: 0.0035s/iter; left time: 11.1734s
	iters: 500, epoch: 2 | loss: 0.6268410
	speed: 0.0034s/iter; left time: 10.3870s
Updating learning rate to 0.00018801063295
Validation loss decreased (0.3733 --> 0.3531).  Saving model state dict ...
Epoch: 2 cost time: 1.829756498336792
Epoch: 2, Steps: 514 | Train Loss: 0.4247914 Vali Loss: 0.3531030 Best vali loss: 0.3531030
	iters: 100, epoch: 3 | loss: 0.3654324
	speed: 0.0072s/iter; left time: 21.3935s
	iters: 200, epoch: 3 | loss: 0.8535861
	speed: 0.0029s/iter; left time: 8.4970s
	iters: 300, epoch: 3 | loss: 0.4932419
	speed: 0.0031s/iter; left time: 8.5203s
	iters: 400, epoch: 3 | loss: 0.4722142
	speed: 0.0031s/iter; left time: 8.4377s
	iters: 500, epoch: 3 | loss: 1.0480250
	speed: 0.0030s/iter; left time: 7.7943s
Updating learning rate to 9.4005316475e-05
Validation loss decreased (0.3531 --> 0.3521).  Saving model state dict ...
Epoch: 3 cost time: 1.607863426208496
Epoch: 3, Steps: 514 | Train Loss: 0.6464999 Vali Loss: 0.3520945 Best vali loss: 0.3520945
	iters: 100, epoch: 4 | loss: 0.5596198
	speed: 0.0071s/iter; left time: 17.5780s
	iters: 200, epoch: 4 | loss: 0.4593851
	speed: 0.0030s/iter; left time: 7.0596s
	iters: 300, epoch: 4 | loss: 0.4890015
	speed: 0.0031s/iter; left time: 7.0101s
	iters: 400, epoch: 4 | loss: 0.6720038
	speed: 0.0031s/iter; left time: 6.7574s
	iters: 500, epoch: 4 | loss: 0.7112882
	speed: 0.0031s/iter; left time: 6.4627s
Updating learning rate to 4.70026582375e-05
Validation loss decreased (0.3521 --> 0.3432).  Saving model state dict ...
Epoch: 4 cost time: 1.6336321830749512
Epoch: 4, Steps: 514 | Train Loss: 0.5782597 Vali Loss: 0.3431862 Best vali loss: 0.3431862
	iters: 100, epoch: 5 | loss: 0.5390993
	speed: 0.0068s/iter; left time: 13.2754s
	iters: 200, epoch: 5 | loss: 0.7219506
	speed: 0.0031s/iter; left time: 5.6737s
	iters: 300, epoch: 5 | loss: 0.4634580
	speed: 0.0031s/iter; left time: 5.3837s
	iters: 400, epoch: 5 | loss: 0.8043424
	speed: 0.0031s/iter; left time: 5.1424s
	iters: 500, epoch: 5 | loss: 0.5431475
	speed: 0.0031s/iter; left time: 4.8950s
Updating learning rate to 2.350132911875e-05
Epoch: 5 cost time: 1.6297180652618408
Epoch: 5, Steps: 514 | Train Loss: 0.6143996 Vali Loss: 0.3468638 Best vali loss: 0.3431862
	iters: 100, epoch: 6 | loss: 0.2974918
	speed: 0.0069s/iter; left time: 9.9334s
	iters: 200, epoch: 6 | loss: 0.4787104
	speed: 0.0031s/iter; left time: 4.1355s
	iters: 300, epoch: 6 | loss: 0.3466030
	speed: 0.0031s/iter; left time: 3.8202s
	iters: 400, epoch: 6 | loss: 0.7448675
	speed: 0.0030s/iter; left time: 3.4618s
	iters: 500, epoch: 6 | loss: 0.9328230
	speed: 0.0030s/iter; left time: 3.1632s
Updating learning rate to 1.1750664559375e-05
Epoch: 6 cost time: 1.6230998039245605
Epoch: 6, Steps: 514 | Train Loss: 0.5600991 Vali Loss: 0.3444645 Best vali loss: 0.3431862
	iters: 100, epoch: 7 | loss: 0.3907087
	speed: 0.0077s/iter; left time: 7.1455s
	iters: 200, epoch: 7 | loss: 0.2951323
	speed: 0.0036s/iter; left time: 2.9930s
	iters: 300, epoch: 7 | loss: 0.3445355
	speed: 0.0034s/iter; left time: 2.5064s
	iters: 400, epoch: 7 | loss: 0.4087526
	speed: 0.0036s/iter; left time: 2.2623s
	iters: 500, epoch: 7 | loss: 0.8023034
	speed: 0.0034s/iter; left time: 1.8181s
Updating learning rate to 5.8753322796875e-06
Epoch: 7 cost time: 1.8644344806671143
Epoch: 7, Steps: 514 | Train Loss: 0.4482865 Vali Loss: 0.3447002 Best vali loss: 0.3431862
	iters: 100, epoch: 8 | loss: 0.3798118
	speed: 0.0072s/iter; left time: 2.9988s
	iters: 200, epoch: 8 | loss: 0.2234239
	speed: 0.0033s/iter; left time: 1.0480s
	iters: 300, epoch: 8 | loss: 0.3539000
	speed: 0.0033s/iter; left time: 0.6993s
	iters: 400, epoch: 8 | loss: 0.4336609
	speed: 0.0032s/iter; left time: 0.3722s
	iters: 500, epoch: 8 | loss: 0.2476884
	speed: 0.0031s/iter; left time: 0.0458s
Updating learning rate to 2.93766613984375e-06
Epoch: 8 cost time: 1.7045528888702393
Epoch: 8, Steps: 514 | Train Loss: 0.3276970 Vali Loss: 0.3452277 Best vali loss: 0.3431862

best validation loss 0.34318619406761963

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.002228321915, 'e_layers': 4, 'learning_rate': 0.000356794228, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2803769
	speed: 0.0110s/iter; left time: 89.5062s
	iters: 200, epoch: 1 | loss: 0.2471861
	speed: 0.0051s/iter; left time: 40.6484s
	iters: 300, epoch: 1 | loss: 1.5716422
	speed: 0.0049s/iter; left time: 38.5894s
	iters: 400, epoch: 1 | loss: 0.4160749
	speed: 0.0048s/iter; left time: 37.6352s
	iters: 500, epoch: 1 | loss: 0.3924195
	speed: 0.0048s/iter; left time: 36.7388s
	iters: 600, epoch: 1 | loss: 0.2977954
	speed: 0.0048s/iter; left time: 36.4913s
	iters: 700, epoch: 1 | loss: 0.1748774
	speed: 0.0048s/iter; left time: 35.9269s
	iters: 800, epoch: 1 | loss: 0.1897198
	speed: 0.0048s/iter; left time: 35.4459s
	iters: 900, epoch: 1 | loss: 0.5834178
	speed: 0.0048s/iter; left time: 34.8516s
	iters: 1000, epoch: 1 | loss: 0.4953698
	speed: 0.0048s/iter; left time: 34.4624s
Updating learning rate to 0.00034321455628368274
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 5.319492340087891
Epoch: 1, Steps: 1027 | Train Loss: 0.4648880 Vali Loss: 0.3677559 Best vali loss: 0.3677559
	iters: 100, epoch: 2 | loss: 0.2812991
	speed: 0.0133s/iter; left time: 94.1223s
	iters: 200, epoch: 2 | loss: 0.5856830
	speed: 0.0051s/iter; left time: 35.6712s
	iters: 300, epoch: 2 | loss: 0.4987569
	speed: 0.0051s/iter; left time: 35.3368s
	iters: 400, epoch: 2 | loss: 1.2096598
	speed: 0.0051s/iter; left time: 34.7255s
	iters: 500, epoch: 2 | loss: 0.5513049
	speed: 0.0046s/iter; left time: 31.0868s
	iters: 600, epoch: 2 | loss: 0.3944327
	speed: 0.0044s/iter; left time: 29.1340s
	iters: 700, epoch: 2 | loss: 0.3978823
	speed: 0.0044s/iter; left time: 28.8591s
	iters: 800, epoch: 2 | loss: 1.7906060
	speed: 0.0044s/iter; left time: 28.3301s
	iters: 900, epoch: 2 | loss: 0.4376346
	speed: 0.0044s/iter; left time: 27.7191s
	iters: 1000, epoch: 2 | loss: 0.3363479
	speed: 0.0044s/iter; left time: 27.2555s
Updating learning rate to 0.0003045429230535096
Epoch: 2 cost time: 4.875553131103516
Epoch: 2, Steps: 1027 | Train Loss: 0.6483607 Vali Loss: 0.3832441 Best vali loss: 0.3677559
	iters: 100, epoch: 3 | loss: 1.1340899
	speed: 0.0128s/iter; left time: 77.4951s
	iters: 200, epoch: 3 | loss: 0.5702509
	speed: 0.0050s/iter; left time: 30.1032s
	iters: 300, epoch: 3 | loss: 1.1439983
	speed: 0.0050s/iter; left time: 29.5423s
	iters: 400, epoch: 3 | loss: 0.2817399
	speed: 0.0050s/iter; left time: 29.0078s
	iters: 500, epoch: 3 | loss: 0.4738983
	speed: 0.0051s/iter; left time: 28.9558s
	iters: 600, epoch: 3 | loss: 0.3753551
	speed: 0.0051s/iter; left time: 28.4480s
	iters: 700, epoch: 3 | loss: 0.4756150
	speed: 0.0051s/iter; left time: 28.1177s
	iters: 800, epoch: 3 | loss: 0.8771341
	speed: 0.0052s/iter; left time: 27.6542s
	iters: 900, epoch: 3 | loss: 0.2343215
	speed: 0.0052s/iter; left time: 27.1121s
	iters: 1000, epoch: 3 | loss: 1.1387281
	speed: 0.0052s/iter; left time: 26.5998s
Updating learning rate to 0.00024666673390954624
Validation loss decreased (0.3678 --> 0.3507).  Saving model state dict ...
Epoch: 3 cost time: 5.280517101287842
Epoch: 3, Steps: 1027 | Train Loss: 0.6705131 Vali Loss: 0.3506620 Best vali loss: 0.3506620
	iters: 100, epoch: 4 | loss: 0.3829750
	speed: 0.0129s/iter; left time: 65.1642s
	iters: 200, epoch: 4 | loss: 0.2534146
	speed: 0.0047s/iter; left time: 23.3004s
	iters: 300, epoch: 4 | loss: 0.4495394
	speed: 0.0047s/iter; left time: 22.7596s
	iters: 400, epoch: 4 | loss: 0.8087657
	speed: 0.0047s/iter; left time: 22.2385s
	iters: 500, epoch: 4 | loss: 0.5686940
	speed: 0.0047s/iter; left time: 21.9318s
	iters: 600, epoch: 4 | loss: 0.9490200
	speed: 0.0047s/iter; left time: 21.4298s
	iters: 700, epoch: 4 | loss: 0.2129383
	speed: 0.0048s/iter; left time: 21.1382s
	iters: 800, epoch: 4 | loss: 0.5886268
	speed: 0.0048s/iter; left time: 20.6753s
	iters: 900, epoch: 4 | loss: 0.3967761
	speed: 0.0047s/iter; left time: 20.1053s
	iters: 1000, epoch: 4 | loss: 0.3536697
	speed: 0.0048s/iter; left time: 19.7301s
Updating learning rate to 0.000178397114
Validation loss decreased (0.3507 --> 0.3422).  Saving model state dict ...
Epoch: 4 cost time: 4.9122090339660645
Epoch: 4, Steps: 1027 | Train Loss: 0.4964420 Vali Loss: 0.3422332 Best vali loss: 0.3422332
	iters: 100, epoch: 5 | loss: 0.8291615
	speed: 0.0125s/iter; left time: 50.2965s
	iters: 200, epoch: 5 | loss: 0.3132704
	speed: 0.0047s/iter; left time: 18.2652s
	iters: 300, epoch: 5 | loss: 0.1671520
	speed: 0.0045s/iter; left time: 17.2984s
	iters: 400, epoch: 5 | loss: 0.3063064
	speed: 0.0044s/iter; left time: 16.4038s
	iters: 500, epoch: 5 | loss: 0.3044952
	speed: 0.0044s/iter; left time: 16.0319s
	iters: 600, epoch: 5 | loss: 0.5375890
	speed: 0.0045s/iter; left time: 15.6386s
	iters: 700, epoch: 5 | loss: 0.3695053
	speed: 0.0045s/iter; left time: 15.2235s
	iters: 800, epoch: 5 | loss: 0.2975637
	speed: 0.0045s/iter; left time: 14.8547s
	iters: 900, epoch: 5 | loss: 1.0536888
	speed: 0.0044s/iter; left time: 14.1564s
	iters: 1000, epoch: 5 | loss: 0.1985107
	speed: 0.0045s/iter; left time: 13.8690s
Updating learning rate to 0.00011012749409045381
Epoch: 5 cost time: 4.658023118972778
Epoch: 5, Steps: 1027 | Train Loss: 0.4377243 Vali Loss: 0.3656654 Best vali loss: 0.3422332
	iters: 100, epoch: 6 | loss: 0.2323135
	speed: 0.0120s/iter; left time: 35.6659s
	iters: 200, epoch: 6 | loss: 0.5048791
	speed: 0.0044s/iter; left time: 12.5668s
	iters: 300, epoch: 6 | loss: 0.1891519
	speed: 0.0043s/iter; left time: 12.0598s
	iters: 400, epoch: 6 | loss: 0.4789308
	speed: 0.0044s/iter; left time: 11.8481s
	iters: 500, epoch: 6 | loss: 0.1890937
	speed: 0.0044s/iter; left time: 11.3170s
	iters: 600, epoch: 6 | loss: 0.3482082
	speed: 0.0045s/iter; left time: 11.1155s
	iters: 700, epoch: 6 | loss: 0.2491405
	speed: 0.0046s/iter; left time: 10.8530s
	iters: 800, epoch: 6 | loss: 0.3968125
	speed: 0.0046s/iter; left time: 10.5020s
	iters: 900, epoch: 6 | loss: 0.6738316
	speed: 0.0044s/iter; left time: 9.6474s
	iters: 1000, epoch: 6 | loss: 0.3239587
	speed: 0.0045s/iter; left time: 9.4544s
Updating learning rate to 5.225130494649044e-05
Epoch: 6 cost time: 4.608277797698975
Epoch: 6, Steps: 1027 | Train Loss: 0.3586321 Vali Loss: 0.3541962 Best vali loss: 0.3422332
	iters: 100, epoch: 7 | loss: 0.4810647
	speed: 0.0125s/iter; left time: 24.3653s
	iters: 200, epoch: 7 | loss: 0.1794290
	speed: 0.0044s/iter; left time: 8.2405s
	iters: 300, epoch: 7 | loss: 0.6639922
	speed: 0.0045s/iter; left time: 7.8179s
	iters: 400, epoch: 7 | loss: 0.5863276
	speed: 0.0045s/iter; left time: 7.3676s
	iters: 500, epoch: 7 | loss: 0.7811274
	speed: 0.0045s/iter; left time: 7.0317s
	iters: 600, epoch: 7 | loss: 1.4332159
	speed: 0.0047s/iter; left time: 6.9046s
	iters: 700, epoch: 7 | loss: 0.2268560
	speed: 0.0046s/iter; left time: 6.2635s
	iters: 800, epoch: 7 | loss: 0.3199252
	speed: 0.0046s/iter; left time: 5.7881s
	iters: 900, epoch: 7 | loss: 0.2251108
	speed: 0.0046s/iter; left time: 5.2900s
	iters: 1000, epoch: 7 | loss: 0.2962339
	speed: 0.0045s/iter; left time: 4.7176s
Updating learning rate to 1.3579671716317275e-05
Epoch: 7 cost time: 4.709549903869629
Epoch: 7, Steps: 1027 | Train Loss: 0.5193283 Vali Loss: 0.3598781 Best vali loss: 0.3422332
	iters: 100, epoch: 8 | loss: 0.7732812
	speed: 0.0120s/iter; left time: 11.1077s
	iters: 200, epoch: 8 | loss: 0.2681669
	speed: 0.0044s/iter; left time: 3.6378s
	iters: 300, epoch: 8 | loss: 0.4564803
	speed: 0.0043s/iter; left time: 3.1553s
	iters: 400, epoch: 8 | loss: 0.3241092
	speed: 0.0043s/iter; left time: 2.7159s
	iters: 500, epoch: 8 | loss: 1.0846639
	speed: 0.0044s/iter; left time: 2.3430s
	iters: 600, epoch: 8 | loss: 0.3268827
	speed: 0.0049s/iter; left time: 2.1106s
	iters: 700, epoch: 8 | loss: 0.8411083
	speed: 0.0049s/iter; left time: 1.6206s
	iters: 800, epoch: 8 | loss: 0.1688548
	speed: 0.0050s/iter; left time: 1.1305s
	iters: 900, epoch: 8 | loss: 0.4614870
	speed: 0.0049s/iter; left time: 0.6285s
	iters: 1000, epoch: 8 | loss: 0.3369857
	speed: 0.0049s/iter; left time: 0.1381s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.825525760650635
Epoch: 8, Steps: 1027 | Train Loss: 0.5042020 Vali Loss: 0.3621599 Best vali loss: 0.3422332

best validation loss 0.34223322973738485

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009467686526, 'e_layers': 2, 'learning_rate': 0.000370365969, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4262991
	speed: 0.0095s/iter; left time: 38.2506s
	iters: 200, epoch: 1 | loss: 1.0767943
	speed: 0.0034s/iter; left time: 13.2726s
	iters: 300, epoch: 1 | loss: 1.0148441
	speed: 0.0036s/iter; left time: 13.6305s
	iters: 400, epoch: 1 | loss: 0.5049954
	speed: 0.0034s/iter; left time: 12.6379s
	iters: 500, epoch: 1 | loss: 1.1504200
	speed: 0.0033s/iter; left time: 11.9998s
Updating learning rate to 0.000370365969
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 2.1156258583068848
Epoch: 1, Steps: 514 | Train Loss: 0.8346705 Vali Loss: 0.3731907 Best vali loss: 0.3731907
	iters: 100, epoch: 2 | loss: 0.3842339
	speed: 0.0074s/iter; left time: 25.8513s
	iters: 200, epoch: 2 | loss: 0.2763626
	speed: 0.0033s/iter; left time: 11.2838s
	iters: 300, epoch: 2 | loss: 0.4956826
	speed: 0.0035s/iter; left time: 11.4844s
	iters: 400, epoch: 2 | loss: 0.3914373
	speed: 0.0034s/iter; left time: 10.9585s
	iters: 500, epoch: 2 | loss: 0.5845031
	speed: 0.0035s/iter; left time: 10.7926s
Updating learning rate to 0.0001851829845
Validation loss decreased (0.3732 --> 0.3571).  Saving model state dict ...
Epoch: 2 cost time: 1.8062403202056885
Epoch: 2, Steps: 514 | Train Loss: 0.4264439 Vali Loss: 0.3570613 Best vali loss: 0.3570613
	iters: 100, epoch: 3 | loss: 0.3716433
	speed: 0.0073s/iter; left time: 21.8882s
	iters: 200, epoch: 3 | loss: 0.8592936
	speed: 0.0030s/iter; left time: 8.6189s
	iters: 300, epoch: 3 | loss: 0.4908464
	speed: 0.0030s/iter; left time: 8.2414s
	iters: 400, epoch: 3 | loss: 0.4590271
	speed: 0.0030s/iter; left time: 8.0816s
	iters: 500, epoch: 3 | loss: 1.1087984
	speed: 0.0030s/iter; left time: 7.8234s
Updating learning rate to 9.259149225e-05
Validation loss decreased (0.3571 --> 0.3505).  Saving model state dict ...
Epoch: 3 cost time: 1.6292064189910889
Epoch: 3, Steps: 514 | Train Loss: 0.6579218 Vali Loss: 0.3505160 Best vali loss: 0.3505160

best validation loss 0.3505160262167805

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 3, 'learning_rate': 0.0003952028144, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4846835
	speed: 0.0154s/iter; left time: 14.3704s
Updating learning rate to 0.0003952028144
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 1.4990909099578857
Epoch: 1, Steps: 129 | Train Loss: 0.4846835 Vali Loss: 0.3736686 Best vali loss: 0.3736686
	iters: 100, epoch: 2 | loss: 0.6147863
	speed: 0.0125s/iter; left time: 10.0700s
Updating learning rate to 0.0001976014072
Epoch: 2 cost time: 1.020799160003662
Epoch: 2, Steps: 129 | Train Loss: 0.6147863 Vali Loss: 0.3834059 Best vali loss: 0.3736686
	iters: 100, epoch: 3 | loss: 0.5057662
	speed: 0.0123s/iter; left time: 8.2807s
Updating learning rate to 9.88007036e-05
Validation loss decreased (0.3737 --> 0.3523).  Saving model state dict ...
Epoch: 3 cost time: 1.0227913856506348
Epoch: 3, Steps: 129 | Train Loss: 0.5057662 Vali Loss: 0.3523107 Best vali loss: 0.3523107

best validation loss 0.3523106969527037

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0084383085177, 'e_layers': 3, 'learning_rate': 5.53709772e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.326354486511456e-05
Validation loss decreased (inf --> 0.4161).  Saving model state dict ...
Epoch: 1 cost time: 0.6912591457366943
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4160534 Best vali loss: 0.4160534
Updating learning rate to 4.7262085329522855e-05
Validation loss decreased (0.4161 --> 0.3966).  Saving model state dict ...
Epoch: 2 cost time: 0.38605308532714844
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3966429 Best vali loss: 0.3966429
Updating learning rate to 3.828026640415257e-05
Validation loss decreased (0.3966 --> 0.3856).  Saving model state dict ...
Epoch: 3 cost time: 0.39864063262939453
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3855684 Best vali loss: 0.3855684

best validation loss 0.3855683923118944

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009467686526, 'e_layers': 2, 'learning_rate': 0.000370365969, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3579047
	speed: 0.0094s/iter; left time: 23.3206s
	iters: 200, epoch: 4 | loss: 0.9068199
	speed: 0.0035s/iter; left time: 8.3645s
	iters: 300, epoch: 4 | loss: 0.7818159
	speed: 0.0034s/iter; left time: 7.8019s
	iters: 400, epoch: 4 | loss: 0.4682071
	speed: 0.0035s/iter; left time: 7.5177s
	iters: 500, epoch: 4 | loss: 0.4360605
	speed: 0.0036s/iter; left time: 7.4515s
Updating learning rate to 4.6295746125e-05
Validation loss decreased (0.3505 --> 0.3470).  Saving model state dict ...
Epoch: 4 cost time: 2.131917715072632
Epoch: 4, Steps: 514 | Train Loss: 0.5901616 Vali Loss: 0.3469536 Best vali loss: 0.3469536
	iters: 100, epoch: 5 | loss: 0.3984292
	speed: 0.0075s/iter; left time: 14.7702s
	iters: 200, epoch: 5 | loss: 0.2397705
	speed: 0.0034s/iter; left time: 6.2899s
	iters: 300, epoch: 5 | loss: 0.3561195
	speed: 0.0033s/iter; left time: 5.8552s
	iters: 400, epoch: 5 | loss: 0.3766308
	speed: 0.0034s/iter; left time: 5.6851s
	iters: 500, epoch: 5 | loss: 0.5917242
	speed: 0.0034s/iter; left time: 5.2507s
Updating learning rate to 2.31478730625e-05
Epoch: 5 cost time: 1.7933053970336914
Epoch: 5, Steps: 514 | Train Loss: 0.3925348 Vali Loss: 0.3495337 Best vali loss: 0.3469536
	iters: 100, epoch: 6 | loss: 0.3140619
	speed: 0.0072s/iter; left time: 10.3740s
	iters: 200, epoch: 6 | loss: 0.7386557
	speed: 0.0034s/iter; left time: 4.5603s
	iters: 300, epoch: 6 | loss: 0.4519651
	speed: 0.0035s/iter; left time: 4.3194s
	iters: 400, epoch: 6 | loss: 0.4303143
	speed: 0.0034s/iter; left time: 3.9406s
	iters: 500, epoch: 6 | loss: 0.9725667
	speed: 0.0034s/iter; left time: 3.5789s
Updating learning rate to 1.157393653125e-05
Epoch: 6 cost time: 1.8034157752990723
Epoch: 6, Steps: 514 | Train Loss: 0.5815128 Vali Loss: 0.3481123 Best vali loss: 0.3469536
	iters: 100, epoch: 7 | loss: 0.5429653
	speed: 0.0074s/iter; left time: 6.9055s
	iters: 200, epoch: 7 | loss: 0.4306381
	speed: 0.0032s/iter; left time: 2.6706s
	iters: 300, epoch: 7 | loss: 0.4269416
	speed: 0.0031s/iter; left time: 2.2919s
	iters: 400, epoch: 7 | loss: 0.6147605
	speed: 0.0031s/iter; left time: 1.9436s
	iters: 500, epoch: 7 | loss: 0.6733699
	speed: 0.0032s/iter; left time: 1.6782s
Updating learning rate to 5.786968265625e-06
Validation loss decreased (0.3470 --> 0.3458).  Saving model state dict ...
Epoch: 7 cost time: 1.7087576389312744
Epoch: 7, Steps: 514 | Train Loss: 0.5377351 Vali Loss: 0.3458073 Best vali loss: 0.3458073
	iters: 100, epoch: 8 | loss: 0.5340807
	speed: 0.0076s/iter; left time: 3.1609s
	iters: 200, epoch: 8 | loss: 0.6929696
	speed: 0.0033s/iter; left time: 1.0379s
	iters: 300, epoch: 8 | loss: 0.4597429
	speed: 0.0033s/iter; left time: 0.7133s
	iters: 400, epoch: 8 | loss: 0.7641947
	speed: 0.0033s/iter; left time: 0.3753s
	iters: 500, epoch: 8 | loss: 0.5380672
	speed: 0.0033s/iter; left time: 0.0501s
Updating learning rate to 2.8934841328125e-06
Epoch: 8 cost time: 1.7506399154663086
Epoch: 8, Steps: 514 | Train Loss: 0.5978110 Vali Loss: 0.3465912 Best vali loss: 0.3458073

best validation loss 0.3458072564925098

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0026349974402, 'e_layers': 2, 'learning_rate': 0.0003961745808, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4268183
	speed: 0.0096s/iter; left time: 38.4667s
	iters: 200, epoch: 1 | loss: 1.0780014
	speed: 0.0031s/iter; left time: 12.1443s
	iters: 300, epoch: 1 | loss: 1.0147429
	speed: 0.0031s/iter; left time: 11.7024s
	iters: 400, epoch: 1 | loss: 0.5037045
	speed: 0.0033s/iter; left time: 12.1326s
	iters: 500, epoch: 1 | loss: 1.1391650
	speed: 0.0033s/iter; left time: 11.8058s
Updating learning rate to 0.0003961745808
Validation loss decreased (inf --> 0.3718).  Saving model state dict ...
Epoch: 1 cost time: 2.014817237854004
Epoch: 1, Steps: 514 | Train Loss: 0.8324864 Vali Loss: 0.3718190 Best vali loss: 0.3718190
	iters: 100, epoch: 2 | loss: 0.3954921
	speed: 0.0074s/iter; left time: 26.0638s
	iters: 200, epoch: 2 | loss: 0.2590751
	speed: 0.0033s/iter; left time: 11.3423s
	iters: 300, epoch: 2 | loss: 0.4531833
	speed: 0.0032s/iter; left time: 10.7160s
	iters: 400, epoch: 2 | loss: 0.3903061
	speed: 0.0030s/iter; left time: 9.7424s
	iters: 500, epoch: 2 | loss: 0.6091539
	speed: 0.0032s/iter; left time: 9.8140s
Updating learning rate to 0.0001980872904
Validation loss decreased (0.3718 --> 0.3651).  Saving model state dict ...
Epoch: 2 cost time: 1.7030160427093506
Epoch: 2, Steps: 514 | Train Loss: 0.4214421 Vali Loss: 0.3650810 Best vali loss: 0.3650810
	iters: 100, epoch: 3 | loss: 0.3575174
	speed: 0.0073s/iter; left time: 21.7633s
	iters: 200, epoch: 3 | loss: 0.8585047
	speed: 0.0032s/iter; left time: 9.2260s
	iters: 300, epoch: 3 | loss: 0.4953905
	speed: 0.0031s/iter; left time: 8.5531s
	iters: 400, epoch: 3 | loss: 0.4689838
	speed: 0.0030s/iter; left time: 8.1049s
	iters: 500, epoch: 3 | loss: 1.0949513
	speed: 0.0031s/iter; left time: 8.0533s
Updating learning rate to 9.90436452e-05
Validation loss decreased (0.3651 --> 0.3629).  Saving model state dict ...
Epoch: 3 cost time: 1.6612880229949951
Epoch: 3, Steps: 514 | Train Loss: 0.6550695 Vali Loss: 0.3628589 Best vali loss: 0.3628589
	iters: 100, epoch: 4 | loss: 0.5575228
	speed: 0.0068s/iter; left time: 16.8082s
	iters: 200, epoch: 4 | loss: 0.4460005
	speed: 0.0031s/iter; left time: 7.2497s
	iters: 300, epoch: 4 | loss: 0.4760363
	speed: 0.0030s/iter; left time: 6.8816s
	iters: 400, epoch: 4 | loss: 0.7021301
	speed: 0.0032s/iter; left time: 6.8448s
	iters: 500, epoch: 4 | loss: 0.6987026
	speed: 0.0031s/iter; left time: 6.3385s
Updating learning rate to 4.95218226e-05
Validation loss decreased (0.3629 --> 0.3435).  Saving model state dict ...
Epoch: 4 cost time: 1.6176526546478271
Epoch: 4, Steps: 514 | Train Loss: 0.5760785 Vali Loss: 0.3434511 Best vali loss: 0.3434511
	iters: 100, epoch: 5 | loss: 0.5581266
	speed: 0.0071s/iter; left time: 13.9606s
	iters: 200, epoch: 5 | loss: 0.7365882
	speed: 0.0031s/iter; left time: 5.8310s
	iters: 300, epoch: 5 | loss: 0.4648588
	speed: 0.0032s/iter; left time: 5.5606s
	iters: 400, epoch: 5 | loss: 0.7884035
	speed: 0.0031s/iter; left time: 5.1838s
	iters: 500, epoch: 5 | loss: 0.5370642
	speed: 0.0031s/iter; left time: 4.8586s
Updating learning rate to 2.47609113e-05
Epoch: 5 cost time: 1.661510944366455
Epoch: 5, Steps: 514 | Train Loss: 0.6170083 Vali Loss: 0.3514482 Best vali loss: 0.3434511
	iters: 100, epoch: 6 | loss: 0.2937087
	speed: 0.0068s/iter; left time: 9.7999s
	iters: 200, epoch: 6 | loss: 0.4635250
	speed: 0.0030s/iter; left time: 4.0045s
	iters: 300, epoch: 6 | loss: 0.3433160
	speed: 0.0031s/iter; left time: 3.8044s
	iters: 400, epoch: 6 | loss: 0.7448491
	speed: 0.0031s/iter; left time: 3.5235s
	iters: 500, epoch: 6 | loss: 0.9446347
	speed: 0.0031s/iter; left time: 3.2526s
Updating learning rate to 1.238045565e-05
Epoch: 6 cost time: 1.610011339187622
Epoch: 6, Steps: 514 | Train Loss: 0.5580067 Vali Loss: 0.3456595 Best vali loss: 0.3434511
	iters: 100, epoch: 7 | loss: 0.3999032
	speed: 0.0070s/iter; left time: 6.4700s
	iters: 200, epoch: 7 | loss: 0.2988597
	speed: 0.0031s/iter; left time: 2.5678s
	iters: 300, epoch: 7 | loss: 0.3510686
	speed: 0.0031s/iter; left time: 2.2634s
	iters: 400, epoch: 7 | loss: 0.4082458
	speed: 0.0031s/iter; left time: 1.9423s
	iters: 500, epoch: 7 | loss: 0.7857187
	speed: 0.0031s/iter; left time: 1.6518s
Updating learning rate to 6.190227825e-06
Validation loss decreased (0.3435 --> 0.3424).  Saving model state dict ...
Epoch: 7 cost time: 1.6612794399261475
Epoch: 7, Steps: 514 | Train Loss: 0.4487592 Vali Loss: 0.3423503 Best vali loss: 0.3423503
	iters: 100, epoch: 8 | loss: 0.3593982
	speed: 0.0070s/iter; left time: 2.9201s
	iters: 200, epoch: 8 | loss: 0.2267962
	speed: 0.0030s/iter; left time: 0.9353s
	iters: 300, epoch: 8 | loss: 0.3545260
	speed: 0.0030s/iter; left time: 0.6460s
	iters: 400, epoch: 8 | loss: 0.4318457
	speed: 0.0030s/iter; left time: 0.3505s
	iters: 500, epoch: 8 | loss: 0.2484175
	speed: 0.0032s/iter; left time: 0.0482s
Updating learning rate to 3.0951139125e-06
Epoch: 8 cost time: 1.6054542064666748
Epoch: 8, Steps: 514 | Train Loss: 0.3241967 Vali Loss: 0.3449155 Best vali loss: 0.3423503

best validation loss 0.34235028363398345

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0008026999496, 'e_layers': 4, 'learning_rate': 0.0001274193443, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3196189
	speed: 0.0115s/iter; left time: 46.1389s
	iters: 200, epoch: 1 | loss: 0.8237342
	speed: 0.0052s/iter; left time: 20.3526s
	iters: 300, epoch: 1 | loss: 1.2229074
	speed: 0.0048s/iter; left time: 18.1156s
	iters: 400, epoch: 1 | loss: 0.4022187
	speed: 0.0047s/iter; left time: 17.4983s
	iters: 500, epoch: 1 | loss: 0.8296391
	speed: 0.0047s/iter; left time: 16.9566s
Updating learning rate to 0.00012256973427238934
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 2.880790948867798
Epoch: 1, Steps: 514 | Train Loss: 0.7196236 Vali Loss: 0.3682034 Best vali loss: 0.3682034
	iters: 100, epoch: 2 | loss: 0.7190377
	speed: 0.0098s/iter; left time: 34.3725s
	iters: 200, epoch: 2 | loss: 0.3677742
	speed: 0.0047s/iter; left time: 15.8357s
	iters: 300, epoch: 2 | loss: 0.6766405
	speed: 0.0048s/iter; left time: 15.6922s
	iters: 400, epoch: 2 | loss: 0.4183606
	speed: 0.0047s/iter; left time: 15.1382s
	iters: 500, epoch: 2 | loss: 0.3997801
	speed: 0.0047s/iter; left time: 14.4151s
Updating learning rate to 0.00010875921335443673
Validation loss decreased (0.3682 --> 0.3661).  Saving model state dict ...
Epoch: 2 cost time: 2.4665045738220215
Epoch: 2, Steps: 514 | Train Loss: 0.5163186 Vali Loss: 0.3660582 Best vali loss: 0.3660582
	iters: 100, epoch: 3 | loss: 0.6432732
	speed: 0.0100s/iter; left time: 29.9285s
	iters: 200, epoch: 3 | loss: 0.6559340
	speed: 0.0046s/iter; left time: 13.3202s
	iters: 300, epoch: 3 | loss: 0.3965556
	speed: 0.0047s/iter; left time: 13.1105s
	iters: 400, epoch: 3 | loss: 0.6779739
	speed: 0.0046s/iter; left time: 12.3596s
	iters: 500, epoch: 3 | loss: 0.5676139
	speed: 0.0047s/iter; left time: 12.1190s
Updating learning rate to 8.809030816321658e-05
Validation loss decreased (0.3661 --> 0.3648).  Saving model state dict ...
Epoch: 3 cost time: 2.4821200370788574
Epoch: 3, Steps: 514 | Train Loss: 0.5882701 Vali Loss: 0.3647808 Best vali loss: 0.3647808
	iters: 100, epoch: 4 | loss: 0.4092342
	speed: 0.0099s/iter; left time: 24.4116s
	iters: 200, epoch: 4 | loss: 0.7013769
	speed: 0.0051s/iter; left time: 12.0983s
	iters: 300, epoch: 4 | loss: 0.5520728
	speed: 0.0053s/iter; left time: 12.0621s
	iters: 400, epoch: 4 | loss: 1.0953039
	speed: 0.0053s/iter; left time: 11.5281s
	iters: 500, epoch: 4 | loss: 0.9000453
	speed: 0.0053s/iter; left time: 11.0076s
Updating learning rate to 6.370967215e-05
Validation loss decreased (0.3648 --> 0.3605).  Saving model state dict ...
Epoch: 4 cost time: 2.7128922939300537
Epoch: 4, Steps: 514 | Train Loss: 0.7316066 Vali Loss: 0.3604807 Best vali loss: 0.3604807
	iters: 100, epoch: 5 | loss: 0.5676376
	speed: 0.0098s/iter; left time: 19.2051s
	iters: 200, epoch: 5 | loss: 0.3896270
	speed: 0.0046s/iter; left time: 8.5947s
	iters: 300, epoch: 5 | loss: 0.4499863
	speed: 0.0047s/iter; left time: 8.2112s
	iters: 400, epoch: 5 | loss: 0.3964809
	speed: 0.0046s/iter; left time: 7.5491s
	iters: 500, epoch: 5 | loss: 0.3193885
	speed: 0.0050s/iter; left time: 7.7300s
Updating learning rate to 3.9329036136783435e-05
Validation loss decreased (0.3605 --> 0.3594).  Saving model state dict ...
Epoch: 5 cost time: 2.459879159927368
Epoch: 5, Steps: 514 | Train Loss: 0.4246241 Vali Loss: 0.3593823 Best vali loss: 0.3593823
	iters: 100, epoch: 6 | loss: 0.7064733
	speed: 0.0098s/iter; left time: 14.1864s
	iters: 200, epoch: 6 | loss: 0.4164474
	speed: 0.0053s/iter; left time: 7.0783s
	iters: 300, epoch: 6 | loss: 0.6869476
	speed: 0.0053s/iter; left time: 6.5603s
	iters: 400, epoch: 6 | loss: 0.4103863
	speed: 0.0053s/iter; left time: 6.0183s
	iters: 500, epoch: 6 | loss: 0.4472854
	speed: 0.0052s/iter; left time: 5.4614s
Updating learning rate to 1.8660130945563275e-05
Epoch: 6 cost time: 2.735729217529297
Epoch: 6, Steps: 514 | Train Loss: 0.5335080 Vali Loss: 0.3615322 Best vali loss: 0.3593823
	iters: 100, epoch: 7 | loss: 0.9315048
	speed: 0.0100s/iter; left time: 9.3151s
	iters: 200, epoch: 7 | loss: 0.6681193
	speed: 0.0051s/iter; left time: 4.2515s
	iters: 300, epoch: 7 | loss: 0.3634043
	speed: 0.0053s/iter; left time: 3.8294s
	iters: 400, epoch: 7 | loss: 0.7931057
	speed: 0.0049s/iter; left time: 3.0838s
	iters: 500, epoch: 7 | loss: 0.7034295
	speed: 0.0049s/iter; left time: 2.5955s
Updating learning rate to 4.849610027610656e-06
Epoch: 7 cost time: 2.656511068344116
Epoch: 7, Steps: 514 | Train Loss: 0.6919127 Vali Loss: 0.3620130 Best vali loss: 0.3593823
	iters: 100, epoch: 8 | loss: 0.3137712
	speed: 0.0098s/iter; left time: 4.0660s
	iters: 200, epoch: 8 | loss: 0.3405920
	speed: 0.0051s/iter; left time: 1.6038s
	iters: 300, epoch: 8 | loss: 1.2419779
	speed: 0.0050s/iter; left time: 1.0814s
	iters: 400, epoch: 8 | loss: 0.4384087
	speed: 0.0051s/iter; left time: 0.5808s
	iters: 500, epoch: 8 | loss: 0.2995082
	speed: 0.0051s/iter; left time: 0.0759s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6333086490631104
Epoch: 8, Steps: 514 | Train Loss: 0.5268516 Vali Loss: 0.3598923 Best vali loss: 0.3593823

best validation loss 0.3593822543770953

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 2, 'learning_rate': 0.0003810451874, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5254337
	speed: 0.0102s/iter; left time: 9.5085s
Updating learning rate to 0.0003810451874
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.8570489883422852
Epoch: 1, Steps: 129 | Train Loss: 0.5254337 Vali Loss: 0.3662894 Best vali loss: 0.3662894
	iters: 100, epoch: 2 | loss: 0.5399927
	speed: 0.0069s/iter; left time: 5.5677s
Updating learning rate to 0.0001905225937
Validation loss decreased (0.3663 --> 0.3519).  Saving model state dict ...
Epoch: 2 cost time: 0.5436751842498779
Epoch: 2, Steps: 129 | Train Loss: 0.5399927 Vali Loss: 0.3519366 Best vali loss: 0.3519366
	iters: 100, epoch: 3 | loss: 0.5468901
	speed: 0.0068s/iter; left time: 4.5789s
Updating learning rate to 9.526129685e-05
Epoch: 3 cost time: 0.5212075710296631
Epoch: 3, Steps: 129 | Train Loss: 0.5468901 Vali Loss: 0.3692497 Best vali loss: 0.3519366

best validation loss 0.35193663360093574

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021830715098, 'e_layers': 2, 'learning_rate': 0.0003977955532, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4269065
	speed: 0.0098s/iter; left time: 39.3830s
	iters: 200, epoch: 1 | loss: 1.0781499
	speed: 0.0036s/iter; left time: 14.2683s
	iters: 300, epoch: 1 | loss: 1.0145351
	speed: 0.0034s/iter; left time: 13.1280s
	iters: 400, epoch: 1 | loss: 0.5053346
	speed: 0.0036s/iter; left time: 13.5290s
	iters: 500, epoch: 1 | loss: 1.1676042
	speed: 0.0035s/iter; left time: 12.6042s
Updating learning rate to 0.0003977955532
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 2.1900949478149414
Epoch: 1, Steps: 514 | Train Loss: 0.8385061 Vali Loss: 0.3734323 Best vali loss: 0.3734323
	iters: 100, epoch: 2 | loss: 0.3886536
	speed: 0.0074s/iter; left time: 25.8946s
	iters: 200, epoch: 2 | loss: 0.2728930
	speed: 0.0032s/iter; left time: 10.7564s
	iters: 300, epoch: 2 | loss: 0.4472874
	speed: 0.0032s/iter; left time: 10.4876s
	iters: 400, epoch: 2 | loss: 0.4082398
	speed: 0.0032s/iter; left time: 10.2744s
	iters: 500, epoch: 2 | loss: 0.6460209
	speed: 0.0032s/iter; left time: 9.8913s
Updating learning rate to 0.0001988977766
Validation loss decreased (0.3734 --> 0.3692).  Saving model state dict ...
Epoch: 2 cost time: 1.695608377456665
Epoch: 2, Steps: 514 | Train Loss: 0.4326189 Vali Loss: 0.3691804 Best vali loss: 0.3691804
	iters: 100, epoch: 3 | loss: 0.3673022
	speed: 0.0072s/iter; left time: 21.3927s
	iters: 200, epoch: 3 | loss: 0.8571059
	speed: 0.0030s/iter; left time: 8.7387s
	iters: 300, epoch: 3 | loss: 0.4801486
	speed: 0.0031s/iter; left time: 8.5805s
	iters: 400, epoch: 3 | loss: 0.4588667
	speed: 0.0032s/iter; left time: 8.4582s
	iters: 500, epoch: 3 | loss: 1.0555934
	speed: 0.0031s/iter; left time: 7.9804s
Updating learning rate to 9.94488883e-05
Validation loss decreased (0.3692 --> 0.3477).  Saving model state dict ...
Epoch: 3 cost time: 1.6337921619415283
Epoch: 3, Steps: 514 | Train Loss: 0.6438033 Vali Loss: 0.3476717 Best vali loss: 0.3476717

best validation loss 0.3476716610678053

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0016438757142, 'e_layers': 2, 'learning_rate': 0.0003984216023, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4268665
	speed: 0.0098s/iter; left time: 39.3377s
	iters: 200, epoch: 1 | loss: 1.0782521
	speed: 0.0035s/iter; left time: 13.8443s
	iters: 300, epoch: 1 | loss: 1.0150287
	speed: 0.0034s/iter; left time: 13.0566s
	iters: 400, epoch: 1 | loss: 0.5044336
	speed: 0.0035s/iter; left time: 13.1503s
	iters: 500, epoch: 1 | loss: 1.1431751
	speed: 0.0035s/iter; left time: 12.6814s
Updating learning rate to 0.0003984216023
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 2.146679401397705
Epoch: 1, Steps: 514 | Train Loss: 0.8335512 Vali Loss: 0.3712159 Best vali loss: 0.3712159
	iters: 100, epoch: 2 | loss: 0.3896153
	speed: 0.0070s/iter; left time: 24.3642s
	iters: 200, epoch: 2 | loss: 0.2619054
	speed: 0.0032s/iter; left time: 10.8503s
	iters: 300, epoch: 2 | loss: 0.4380787
	speed: 0.0032s/iter; left time: 10.4823s
	iters: 400, epoch: 2 | loss: 0.3894860
	speed: 0.0032s/iter; left time: 10.1161s
	iters: 500, epoch: 2 | loss: 0.6087278
	speed: 0.0032s/iter; left time: 9.9819s
Updating learning rate to 0.00019921080115
Validation loss decreased (0.3712 --> 0.3705).  Saving model state dict ...
Epoch: 2 cost time: 1.6760993003845215
Epoch: 2, Steps: 514 | Train Loss: 0.4175627 Vali Loss: 0.3704842 Best vali loss: 0.3704842
	iters: 100, epoch: 3 | loss: 0.3784725
	speed: 0.0074s/iter; left time: 21.9722s
	iters: 200, epoch: 3 | loss: 0.8868994
	speed: 0.0035s/iter; left time: 10.2257s
	iters: 300, epoch: 3 | loss: 0.5009863
	speed: 0.0034s/iter; left time: 9.6056s
	iters: 400, epoch: 3 | loss: 0.4740992
	speed: 0.0036s/iter; left time: 9.5519s
	iters: 500, epoch: 3 | loss: 1.1064812
	speed: 0.0037s/iter; left time: 9.6163s
Updating learning rate to 9.9605400575e-05
Validation loss decreased (0.3705 --> 0.3626).  Saving model state dict ...
Epoch: 3 cost time: 1.8813433647155762
Epoch: 3, Steps: 514 | Train Loss: 0.6693877 Vali Loss: 0.3625901 Best vali loss: 0.3625901

best validation loss 0.36259012681327774

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021830715098, 'e_layers': 2, 'learning_rate': 0.0003977955532, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3490821
	speed: 0.0100s/iter; left time: 24.7725s
	iters: 200, epoch: 4 | loss: 0.9009859
	speed: 0.0036s/iter; left time: 8.5792s
	iters: 300, epoch: 4 | loss: 0.7524734
	speed: 0.0036s/iter; left time: 8.2101s
	iters: 400, epoch: 4 | loss: 0.4748339
	speed: 0.0035s/iter; left time: 7.5673s
	iters: 500, epoch: 4 | loss: 0.4289078
	speed: 0.0036s/iter; left time: 7.4487s
Updating learning rate to 4.972444415e-05
Validation loss decreased (0.3477 --> 0.3472).  Saving model state dict ...
Epoch: 4 cost time: 2.195063591003418
Epoch: 4, Steps: 514 | Train Loss: 0.5812566 Vali Loss: 0.3471761 Best vali loss: 0.3471761
	iters: 100, epoch: 5 | loss: 0.3903306
	speed: 0.0073s/iter; left time: 14.3220s
	iters: 200, epoch: 5 | loss: 0.2379030
	speed: 0.0031s/iter; left time: 5.7351s
	iters: 300, epoch: 5 | loss: 0.3566763
	speed: 0.0031s/iter; left time: 5.5062s
	iters: 400, epoch: 5 | loss: 0.3728420
	speed: 0.0031s/iter; left time: 5.1437s
	iters: 500, epoch: 5 | loss: 0.5996472
	speed: 0.0031s/iter; left time: 4.8692s
Updating learning rate to 2.4862222075e-05
Validation loss decreased (0.3472 --> 0.3412).  Saving model state dict ...
Epoch: 5 cost time: 1.6440293788909912
Epoch: 5, Steps: 514 | Train Loss: 0.3914798 Vali Loss: 0.3411869 Best vali loss: 0.3411869
	iters: 100, epoch: 6 | loss: 0.3053465
	speed: 0.0071s/iter; left time: 10.2160s
	iters: 200, epoch: 6 | loss: 0.7149017
	speed: 0.0032s/iter; left time: 4.2985s
	iters: 300, epoch: 6 | loss: 0.4252728
	speed: 0.0031s/iter; left time: 3.8963s
	iters: 400, epoch: 6 | loss: 0.4209395
	speed: 0.0031s/iter; left time: 3.5892s
	iters: 500, epoch: 6 | loss: 0.9452298
	speed: 0.0032s/iter; left time: 3.3073s
Updating learning rate to 1.24311110375e-05
Epoch: 6 cost time: 1.6611778736114502
Epoch: 6, Steps: 514 | Train Loss: 0.5623381 Vali Loss: 0.3424037 Best vali loss: 0.3411869
	iters: 100, epoch: 7 | loss: 0.5479435
	speed: 0.0069s/iter; left time: 6.4067s
	iters: 200, epoch: 7 | loss: 0.4253324
	speed: 0.0031s/iter; left time: 2.6029s
	iters: 300, epoch: 7 | loss: 0.4329540
	speed: 0.0032s/iter; left time: 2.3116s
	iters: 400, epoch: 7 | loss: 0.6175880
	speed: 0.0031s/iter; left time: 1.9546s
	iters: 500, epoch: 7 | loss: 0.6471488
	speed: 0.0031s/iter; left time: 1.6446s
Updating learning rate to 6.21555551875e-06
Validation loss decreased (0.3412 --> 0.3389).  Saving model state dict ...
Epoch: 7 cost time: 1.6493892669677734
Epoch: 7, Steps: 514 | Train Loss: 0.5341933 Vali Loss: 0.3389311 Best vali loss: 0.3389311
	iters: 100, epoch: 8 | loss: 0.5176691
	speed: 0.0071s/iter; left time: 2.9368s
	iters: 200, epoch: 8 | loss: 0.6882008
	speed: 0.0031s/iter; left time: 0.9646s
	iters: 300, epoch: 8 | loss: 0.4800490
	speed: 0.0032s/iter; left time: 0.6861s
	iters: 400, epoch: 8 | loss: 0.7220675
	speed: 0.0030s/iter; left time: 0.3481s
	iters: 500, epoch: 8 | loss: 0.5165051
	speed: 0.0030s/iter; left time: 0.0456s
Updating learning rate to 3.107777759375e-06
Epoch: 8 cost time: 1.624756097793579
Epoch: 8, Steps: 514 | Train Loss: 0.5848983 Vali Loss: 0.3412369 Best vali loss: 0.3389311

best validation loss 0.33893112494575484

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0094525613861, 'e_layers': 3, 'learning_rate': 0.0043340623613, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3544330
	speed: 0.0106s/iter; left time: 42.4046s
	iters: 200, epoch: 1 | loss: 0.6697295
	speed: 0.0044s/iter; left time: 17.3166s
	iters: 300, epoch: 1 | loss: 1.1016488
	speed: 0.0044s/iter; left time: 16.7571s
	iters: 400, epoch: 1 | loss: 0.3052605
	speed: 0.0043s/iter; left time: 16.0662s
	iters: 500, epoch: 1 | loss: 0.3401658
	speed: 0.0042s/iter; left time: 15.3214s
Updating learning rate to 0.004169106934766304
Validation loss decreased (inf --> 0.3746).  Saving model state dict ...
Epoch: 1 cost time: 2.582200050354004
Epoch: 1, Steps: 514 | Train Loss: 0.5542475 Vali Loss: 0.3746475 Best vali loss: 0.3746475
	iters: 100, epoch: 2 | loss: 0.2753558
	speed: 0.0085s/iter; left time: 29.7345s
	iters: 200, epoch: 2 | loss: 0.7667842
	speed: 0.0042s/iter; left time: 14.1260s
	iters: 300, epoch: 2 | loss: 0.2858382
	speed: 0.0042s/iter; left time: 13.8979s
	iters: 400, epoch: 2 | loss: 0.3548251
	speed: 0.0042s/iter; left time: 13.4947s
	iters: 500, epoch: 2 | loss: 0.4634403
	speed: 0.0042s/iter; left time: 12.9729s
Updating learning rate to 0.003699353623530305
Epoch: 2 cost time: 2.206563949584961
Epoch: 2, Steps: 514 | Train Loss: 0.4292487 Vali Loss: 0.3979393 Best vali loss: 0.3746475
	iters: 100, epoch: 3 | loss: 0.6470503
	speed: 0.0084s/iter; left time: 25.0683s
	iters: 200, epoch: 3 | loss: 0.4676315
	speed: 0.0041s/iter; left time: 11.8144s
	iters: 300, epoch: 3 | loss: 0.5080515
	speed: 0.0040s/iter; left time: 11.2429s
	iters: 400, epoch: 3 | loss: 0.6686845
	speed: 0.0039s/iter; left time: 10.5804s
	iters: 500, epoch: 3 | loss: 0.8458590
	speed: 0.0040s/iter; left time: 10.2897s
Updating learning rate to 0.002996318110903315
Epoch: 3 cost time: 2.097020149230957
Epoch: 3, Steps: 514 | Train Loss: 0.6274554 Vali Loss: 0.3758341 Best vali loss: 0.3746475
	iters: 100, epoch: 4 | loss: 0.6372588
	speed: 0.0085s/iter; left time: 21.0372s
	iters: 200, epoch: 4 | loss: 0.4892077
	speed: 0.0041s/iter; left time: 9.6314s
	iters: 300, epoch: 4 | loss: 1.0242746
	speed: 0.0039s/iter; left time: 8.8805s
	iters: 400, epoch: 4 | loss: 0.6719436
	speed: 0.0041s/iter; left time: 8.7945s
	iters: 500, epoch: 4 | loss: 0.6161659
	speed: 0.0041s/iter; left time: 8.4990s
Updating learning rate to 0.00216703118065
Validation loss decreased (0.3746 --> 0.3694).  Saving model state dict ...
Epoch: 4 cost time: 2.131734609603882
Epoch: 4, Steps: 514 | Train Loss: 0.6877701 Vali Loss: 0.3693788 Best vali loss: 0.3693788
	iters: 100, epoch: 5 | loss: 0.4821911
	speed: 0.0084s/iter; left time: 16.4788s
	iters: 200, epoch: 5 | loss: 0.4648163
	speed: 0.0041s/iter; left time: 7.5874s
	iters: 300, epoch: 5 | loss: 0.3731374
	speed: 0.0040s/iter; left time: 7.1022s
	iters: 400, epoch: 5 | loss: 0.6401244
	speed: 0.0040s/iter; left time: 6.6811s
	iters: 500, epoch: 5 | loss: 0.9422385
	speed: 0.0041s/iter; left time: 6.3682s
Updating learning rate to 0.0013377442503966852
Validation loss decreased (0.3694 --> 0.3686).  Saving model state dict ...
Epoch: 5 cost time: 2.1382360458374023
Epoch: 5, Steps: 514 | Train Loss: 0.5805015 Vali Loss: 0.3686049 Best vali loss: 0.3686049
	iters: 100, epoch: 6 | loss: 0.6448274
	speed: 0.0084s/iter; left time: 12.0982s
	iters: 200, epoch: 6 | loss: 0.5326123
	speed: 0.0039s/iter; left time: 5.2725s
	iters: 300, epoch: 6 | loss: 0.4742572
	speed: 0.0040s/iter; left time: 5.0323s
	iters: 400, epoch: 6 | loss: 0.3099826
	speed: 0.0041s/iter; left time: 4.6542s
	iters: 500, epoch: 6 | loss: 0.8107196
	speed: 0.0040s/iter; left time: 4.1710s
Updating learning rate to 0.0006347087377696948
Epoch: 6 cost time: 2.1091983318328857
Epoch: 6, Steps: 514 | Train Loss: 0.5544798 Vali Loss: 0.3761622 Best vali loss: 0.3686049
	iters: 100, epoch: 7 | loss: 0.4471315
	speed: 0.0087s/iter; left time: 8.1192s
	iters: 200, epoch: 7 | loss: 0.6639102
	speed: 0.0044s/iter; left time: 3.6566s
	iters: 300, epoch: 7 | loss: 0.5010260
	speed: 0.0043s/iter; left time: 3.1499s
	iters: 400, epoch: 7 | loss: 0.5231478
	speed: 0.0043s/iter; left time: 2.7233s
	iters: 500, epoch: 7 | loss: 1.3166786
	speed: 0.0044s/iter; left time: 2.3197s
Updating learning rate to 0.00016495542653369624
Epoch: 7 cost time: 2.2860538959503174
Epoch: 7, Steps: 514 | Train Loss: 0.6903788 Vali Loss: 0.3720545 Best vali loss: 0.3686049
	iters: 100, epoch: 8 | loss: 0.5936508
	speed: 0.0085s/iter; left time: 3.5423s
	iters: 200, epoch: 8 | loss: 0.3986564
	speed: 0.0043s/iter; left time: 1.3480s
	iters: 300, epoch: 8 | loss: 0.9559652
	speed: 0.0043s/iter; left time: 0.9268s
	iters: 400, epoch: 8 | loss: 0.3599289
	speed: 0.0043s/iter; left time: 0.4998s
	iters: 500, epoch: 8 | loss: 0.6759438
	speed: 0.0042s/iter; left time: 0.0637s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.2617270946502686
Epoch: 8, Steps: 514 | Train Loss: 0.5968290 Vali Loss: 0.3743781 Best vali loss: 0.3686049

best validation loss 0.36860489896800525

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020504410233, 'e_layers': 2, 'learning_rate': 0.0003917176548, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3342027
	speed: 0.0091s/iter; left time: 73.8953s
	iters: 200, epoch: 1 | loss: 0.4889862
	speed: 0.0030s/iter; left time: 23.8345s
	iters: 300, epoch: 1 | loss: 0.3253267
	speed: 0.0029s/iter; left time: 23.1659s
	iters: 400, epoch: 1 | loss: 1.7869831
	speed: 0.0029s/iter; left time: 22.7819s
	iters: 500, epoch: 1 | loss: 0.7086970
	speed: 0.0029s/iter; left time: 22.4206s
	iters: 600, epoch: 1 | loss: 1.4804500
	speed: 0.0029s/iter; left time: 22.3595s
	iters: 700, epoch: 1 | loss: 1.5382341
	speed: 0.0030s/iter; left time: 22.2096s
	iters: 800, epoch: 1 | loss: 0.6995274
	speed: 0.0029s/iter; left time: 21.8367s
	iters: 900, epoch: 1 | loss: 1.0726364
	speed: 0.0030s/iter; left time: 21.7811s
	iters: 1000, epoch: 1 | loss: 1.9575022
	speed: 0.0030s/iter; left time: 21.3507s
Updating learning rate to 0.0003917176548
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 3.377574920654297
Epoch: 1, Steps: 1027 | Train Loss: 1.0392546 Vali Loss: 0.3688075 Best vali loss: 0.3688075
	iters: 100, epoch: 2 | loss: 0.2997291
	speed: 0.0093s/iter; left time: 65.6878s
	iters: 200, epoch: 2 | loss: 0.2538071
	speed: 0.0030s/iter; left time: 21.2013s
	iters: 300, epoch: 2 | loss: 0.7979830
	speed: 0.0031s/iter; left time: 21.0988s
	iters: 400, epoch: 2 | loss: 0.2989320
	speed: 0.0031s/iter; left time: 20.8308s
	iters: 500, epoch: 2 | loss: 0.2807868
	speed: 0.0031s/iter; left time: 20.4761s
	iters: 600, epoch: 2 | loss: 0.3417603
	speed: 0.0030s/iter; left time: 19.9819s
	iters: 700, epoch: 2 | loss: 0.4892900
	speed: 0.0030s/iter; left time: 19.7146s
	iters: 800, epoch: 2 | loss: 0.4656141
	speed: 0.0030s/iter; left time: 19.3232s
	iters: 900, epoch: 2 | loss: 0.4956620
	speed: 0.0030s/iter; left time: 19.1009s
	iters: 1000, epoch: 2 | loss: 0.5597481
	speed: 0.0030s/iter; left time: 18.8728s
Updating learning rate to 0.0001958588274
Epoch: 2 cost time: 3.170600652694702
Epoch: 2, Steps: 1027 | Train Loss: 0.4283312 Vali Loss: 0.3705337 Best vali loss: 0.3688075
	iters: 100, epoch: 3 | loss: 0.9512767
	speed: 0.0091s/iter; left time: 54.8873s
	iters: 200, epoch: 3 | loss: 0.4753293
	speed: 0.0031s/iter; left time: 18.4520s
	iters: 300, epoch: 3 | loss: 0.4765526
	speed: 0.0031s/iter; left time: 18.2214s
	iters: 400, epoch: 3 | loss: 1.1555669
	speed: 0.0029s/iter; left time: 16.6024s
	iters: 500, epoch: 3 | loss: 0.6177829
	speed: 0.0030s/iter; left time: 16.7826s
	iters: 600, epoch: 3 | loss: 0.4833942
	speed: 0.0030s/iter; left time: 16.5576s
	iters: 700, epoch: 3 | loss: 0.4091131
	speed: 0.0030s/iter; left time: 16.1371s
	iters: 800, epoch: 3 | loss: 0.4650644
	speed: 0.0029s/iter; left time: 15.8114s
	iters: 900, epoch: 3 | loss: 0.6360570
	speed: 0.0029s/iter; left time: 15.2201s
	iters: 1000, epoch: 3 | loss: 1.1017151
	speed: 0.0029s/iter; left time: 15.0996s
Updating learning rate to 9.79294137e-05
Epoch: 3 cost time: 3.0935068130493164
Epoch: 3, Steps: 1027 | Train Loss: 0.6771852 Vali Loss: 0.3818784 Best vali loss: 0.3688075
	iters: 100, epoch: 4 | loss: 1.3210057
	speed: 0.0091s/iter; left time: 45.7557s
	iters: 200, epoch: 4 | loss: 0.7497473
	speed: 0.0030s/iter; left time: 15.0114s
	iters: 300, epoch: 4 | loss: 0.2365437
	speed: 0.0031s/iter; left time: 14.8911s
	iters: 400, epoch: 4 | loss: 0.6844730
	speed: 0.0031s/iter; left time: 14.4717s
	iters: 500, epoch: 4 | loss: 1.2682093
	speed: 0.0031s/iter; left time: 14.5809s
	iters: 600, epoch: 4 | loss: 0.7347002
	speed: 0.0030s/iter; left time: 13.7851s
	iters: 700, epoch: 4 | loss: 0.2747684
	speed: 0.0031s/iter; left time: 13.5736s
	iters: 800, epoch: 4 | loss: 0.2415081
	speed: 0.0030s/iter; left time: 13.1514s
	iters: 900, epoch: 4 | loss: 1.2624080
	speed: 0.0030s/iter; left time: 12.8257s
	iters: 1000, epoch: 4 | loss: 0.7120481
	speed: 0.0031s/iter; left time: 12.7377s
Updating learning rate to 4.896470685e-05
Epoch: 4 cost time: 3.1794931888580322
Epoch: 4, Steps: 1027 | Train Loss: 0.7485412 Vali Loss: 0.3837128 Best vali loss: 0.3688075
	iters: 100, epoch: 5 | loss: 0.8812585
	speed: 0.0090s/iter; left time: 36.1163s
	iters: 200, epoch: 5 | loss: 0.6967923
	speed: 0.0030s/iter; left time: 11.6343s
	iters: 300, epoch: 5 | loss: 0.8573772
	speed: 0.0029s/iter; left time: 11.2261s
	iters: 400, epoch: 5 | loss: 0.9230731
	speed: 0.0030s/iter; left time: 11.0419s
	iters: 500, epoch: 5 | loss: 0.7638971
	speed: 0.0030s/iter; left time: 10.7248s
	iters: 600, epoch: 5 | loss: 0.5006642
	speed: 0.0030s/iter; left time: 10.5032s
	iters: 700, epoch: 5 | loss: 1.2269868
	speed: 0.0030s/iter; left time: 10.2247s
	iters: 800, epoch: 5 | loss: 1.3662844
	speed: 0.0030s/iter; left time: 9.9335s
	iters: 900, epoch: 5 | loss: 0.2540591
	speed: 0.0030s/iter; left time: 9.6254s
	iters: 1000, epoch: 5 | loss: 0.3127295
	speed: 0.0030s/iter; left time: 9.3261s
Updating learning rate to 2.4482353425e-05
Epoch: 5 cost time: 3.103712320327759
Epoch: 5, Steps: 1027 | Train Loss: 0.7783122 Vali Loss: 0.3880784 Best vali loss: 0.3688075
	iters: 100, epoch: 6 | loss: 0.6665964
	speed: 0.0091s/iter; left time: 27.1065s
	iters: 200, epoch: 6 | loss: 0.2170051
	speed: 0.0031s/iter; left time: 9.0300s
	iters: 300, epoch: 6 | loss: 0.7213867
	speed: 0.0032s/iter; left time: 8.9020s
	iters: 400, epoch: 6 | loss: 0.4788302
	speed: 0.0033s/iter; left time: 8.8108s
	iters: 500, epoch: 6 | loss: 0.2439447
	speed: 0.0030s/iter; left time: 7.8213s
	iters: 600, epoch: 6 | loss: 0.5111665
	speed: 0.0030s/iter; left time: 7.4923s
	iters: 700, epoch: 6 | loss: 0.3582475
	speed: 0.0030s/iter; left time: 7.2435s
	iters: 800, epoch: 6 | loss: 0.3065779
	speed: 0.0030s/iter; left time: 6.8959s
	iters: 900, epoch: 6 | loss: 0.4504117
	speed: 0.0030s/iter; left time: 6.5639s
	iters: 1000, epoch: 6 | loss: 1.4182322
	speed: 0.0030s/iter; left time: 6.3075s
Updating learning rate to 1.22411767125e-05
Epoch: 6 cost time: 3.204981565475464
Epoch: 6, Steps: 1027 | Train Loss: 0.5372399 Vali Loss: 0.3873838 Best vali loss: 0.3688075
	iters: 100, epoch: 7 | loss: 0.3701674
	speed: 0.0090s/iter; left time: 17.5688s
	iters: 200, epoch: 7 | loss: 0.3492230
	speed: 0.0030s/iter; left time: 5.5911s
	iters: 300, epoch: 7 | loss: 0.3670262
	speed: 0.0030s/iter; left time: 5.1838s
	iters: 400, epoch: 7 | loss: 0.2024963
	speed: 0.0029s/iter; left time: 4.8797s
	iters: 500, epoch: 7 | loss: 0.2563114
	speed: 0.0030s/iter; left time: 4.5926s
	iters: 600, epoch: 7 | loss: 0.3898787
	speed: 0.0029s/iter; left time: 4.2898s
	iters: 700, epoch: 7 | loss: 0.5315662
	speed: 0.0029s/iter; left time: 3.9594s
	iters: 800, epoch: 7 | loss: 0.4220407
	speed: 0.0030s/iter; left time: 3.7344s
	iters: 900, epoch: 7 | loss: 0.2101013
	speed: 0.0031s/iter; left time: 3.5336s
	iters: 1000, epoch: 7 | loss: 0.7599363
	speed: 0.0030s/iter; left time: 3.2158s
Updating learning rate to 6.12058835625e-06
Epoch: 7 cost time: 3.104418992996216
Epoch: 7, Steps: 1027 | Train Loss: 0.3858747 Vali Loss: 0.3840492 Best vali loss: 0.3688075
	iters: 100, epoch: 8 | loss: 1.1676039
	speed: 0.0093s/iter; left time: 8.6499s
	iters: 200, epoch: 8 | loss: 0.3336295
	speed: 0.0033s/iter; left time: 2.7390s
	iters: 300, epoch: 8 | loss: 0.5739849
	speed: 0.0033s/iter; left time: 2.4184s
	iters: 400, epoch: 8 | loss: 0.2089892
	speed: 0.0033s/iter; left time: 2.0736s
	iters: 500, epoch: 8 | loss: 0.4480000
	speed: 0.0033s/iter; left time: 1.7630s
	iters: 600, epoch: 8 | loss: 0.3535900
	speed: 0.0033s/iter; left time: 1.4216s
	iters: 700, epoch: 8 | loss: 0.8341202
	speed: 0.0033s/iter; left time: 1.0928s
	iters: 800, epoch: 8 | loss: 0.3704937
	speed: 0.0033s/iter; left time: 0.7626s
	iters: 900, epoch: 8 | loss: 0.3674881
	speed: 0.0033s/iter; left time: 0.4267s
	iters: 1000, epoch: 8 | loss: 0.3280130
	speed: 0.0033s/iter; left time: 0.0916s
Updating learning rate to 3.060294178125e-06
Epoch: 8 cost time: 3.442011594772339
Epoch: 8, Steps: 1027 | Train Loss: 0.4985912 Vali Loss: 0.3836865 Best vali loss: 0.3688075

best validation loss 0.3688074646506656

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019404849971, 'e_layers': 2, 'learning_rate': 0.0003725895824, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3340592
	speed: 0.0091s/iter; left time: 73.9405s
	iters: 200, epoch: 1 | loss: 0.4884361
	speed: 0.0031s/iter; left time: 24.7747s
	iters: 300, epoch: 1 | loss: 0.3307840
	speed: 0.0031s/iter; left time: 24.2365s
	iters: 400, epoch: 1 | loss: 1.8086543
	speed: 0.0031s/iter; left time: 24.1432s
	iters: 500, epoch: 1 | loss: 0.7149476
	speed: 0.0031s/iter; left time: 23.5549s
	iters: 600, epoch: 1 | loss: 1.4841323
	speed: 0.0031s/iter; left time: 23.3070s
	iters: 700, epoch: 1 | loss: 1.5448866
	speed: 0.0031s/iter; left time: 23.2385s
	iters: 800, epoch: 1 | loss: 0.6111508
	speed: 0.0031s/iter; left time: 22.7503s
	iters: 900, epoch: 1 | loss: 1.0980222
	speed: 0.0031s/iter; left time: 22.5279s
	iters: 1000, epoch: 1 | loss: 1.1509135
	speed: 0.0031s/iter; left time: 22.1732s
Updating learning rate to 0.0003725895824
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 3.4969470500946045
Epoch: 1, Steps: 1027 | Train Loss: 0.9565987 Vali Loss: 0.3818438 Best vali loss: 0.3818438
	iters: 100, epoch: 2 | loss: 0.3154187
	speed: 0.0091s/iter; left time: 64.7494s
	iters: 200, epoch: 2 | loss: 0.2696949
	speed: 0.0031s/iter; left time: 21.7100s
	iters: 300, epoch: 2 | loss: 0.8204706
	speed: 0.0031s/iter; left time: 21.3525s
	iters: 400, epoch: 2 | loss: 0.2953214
	speed: 0.0031s/iter; left time: 21.0633s
	iters: 500, epoch: 2 | loss: 0.2863355
	speed: 0.0031s/iter; left time: 20.8294s
	iters: 600, epoch: 2 | loss: 0.3663493
	speed: 0.0031s/iter; left time: 20.6149s
	iters: 700, epoch: 2 | loss: 0.4752988
	speed: 0.0031s/iter; left time: 20.2374s
	iters: 800, epoch: 2 | loss: 0.4814019
	speed: 0.0031s/iter; left time: 19.8469s
	iters: 900, epoch: 2 | loss: 0.5283787
	speed: 0.0032s/iter; left time: 19.8533s
	iters: 1000, epoch: 2 | loss: 0.5661623
	speed: 0.0031s/iter; left time: 19.3971s
Updating learning rate to 0.0001862947912
Validation loss decreased (0.3818 --> 0.3747).  Saving model state dict ...
Epoch: 2 cost time: 3.2384378910064697
Epoch: 2, Steps: 1027 | Train Loss: 0.4404832 Vali Loss: 0.3747191 Best vali loss: 0.3747191
	iters: 100, epoch: 3 | loss: 0.9776934
	speed: 0.0097s/iter; left time: 59.0394s
	iters: 200, epoch: 3 | loss: 0.4914695
	speed: 0.0032s/iter; left time: 18.9659s
	iters: 300, epoch: 3 | loss: 0.4503296
	speed: 0.0031s/iter; left time: 18.3795s
	iters: 400, epoch: 3 | loss: 1.1370252
	speed: 0.0030s/iter; left time: 17.5210s
	iters: 500, epoch: 3 | loss: 0.6849959
	speed: 0.0033s/iter; left time: 18.5330s
	iters: 600, epoch: 3 | loss: 0.3880032
	speed: 0.0033s/iter; left time: 18.4252s
	iters: 700, epoch: 3 | loss: 0.4279459
	speed: 0.0031s/iter; left time: 16.8936s
	iters: 800, epoch: 3 | loss: 0.4477828
	speed: 0.0032s/iter; left time: 17.1308s
	iters: 900, epoch: 3 | loss: 0.6370232
	speed: 0.0031s/iter; left time: 16.1508s
	iters: 1000, epoch: 3 | loss: 1.0768933
	speed: 0.0031s/iter; left time: 16.2142s
Updating learning rate to 9.31473956e-05
Epoch: 3 cost time: 3.283233404159546
Epoch: 3, Steps: 1027 | Train Loss: 0.6719162 Vali Loss: 0.3776419 Best vali loss: 0.3747191

best validation loss 0.37471911019566956

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020399819244, 'e_layers': 2, 'learning_rate': 0.0003706091007, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3340576
	speed: 0.0091s/iter; left time: 73.8870s
	iters: 200, epoch: 1 | loss: 0.4882759
	speed: 0.0031s/iter; left time: 25.0948s
	iters: 300, epoch: 1 | loss: 0.3294632
	speed: 0.0030s/iter; left time: 24.1266s
	iters: 400, epoch: 1 | loss: 1.7971746
	speed: 0.0030s/iter; left time: 23.7250s
	iters: 500, epoch: 1 | loss: 0.7189119
	speed: 0.0031s/iter; left time: 23.7095s
	iters: 600, epoch: 1 | loss: 1.4798555
	speed: 0.0033s/iter; left time: 25.2032s
	iters: 700, epoch: 1 | loss: 1.4519125
	speed: 0.0032s/iter; left time: 24.4175s
	iters: 800, epoch: 1 | loss: 0.6006476
	speed: 0.0032s/iter; left time: 24.0336s
	iters: 900, epoch: 1 | loss: 1.1030428
	speed: 0.0033s/iter; left time: 23.9754s
	iters: 1000, epoch: 1 | loss: 1.2888198
	speed: 0.0033s/iter; left time: 23.8939s
Updating learning rate to 0.0003706091007
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 3.5983331203460693
Epoch: 1, Steps: 1027 | Train Loss: 0.9592162 Vali Loss: 0.3748678 Best vali loss: 0.3748678
	iters: 100, epoch: 2 | loss: 0.2968427
	speed: 0.0094s/iter; left time: 66.6781s
	iters: 200, epoch: 2 | loss: 0.2654066
	speed: 0.0033s/iter; left time: 23.2666s
	iters: 300, epoch: 2 | loss: 0.9456496
	speed: 0.0033s/iter; left time: 22.9423s
	iters: 400, epoch: 2 | loss: 0.3157941
	speed: 0.0033s/iter; left time: 22.2649s
	iters: 500, epoch: 2 | loss: 0.2899784
	speed: 0.0033s/iter; left time: 21.8520s
	iters: 600, epoch: 2 | loss: 0.3293528
	speed: 0.0033s/iter; left time: 21.4343s
	iters: 700, epoch: 2 | loss: 0.4871820
	speed: 0.0033s/iter; left time: 21.1667s
	iters: 800, epoch: 2 | loss: 0.4722328
	speed: 0.0032s/iter; left time: 20.6100s
	iters: 900, epoch: 2 | loss: 0.5140283
	speed: 0.0032s/iter; left time: 20.1342s
	iters: 1000, epoch: 2 | loss: 0.5459166
	speed: 0.0032s/iter; left time: 19.8404s
Updating learning rate to 0.00018530455035
Epoch: 2 cost time: 3.3893582820892334
Epoch: 2, Steps: 1027 | Train Loss: 0.4462384 Vali Loss: 0.3813073 Best vali loss: 0.3748678
	iters: 100, epoch: 3 | loss: 0.9863288
	speed: 0.0090s/iter; left time: 54.3995s
	iters: 200, epoch: 3 | loss: 0.4320465
	speed: 0.0029s/iter; left time: 17.3681s
	iters: 300, epoch: 3 | loss: 0.4826084
	speed: 0.0029s/iter; left time: 17.0150s
	iters: 400, epoch: 3 | loss: 1.1301483
	speed: 0.0030s/iter; left time: 17.4541s
	iters: 500, epoch: 3 | loss: 0.6401665
	speed: 0.0031s/iter; left time: 17.3265s
	iters: 600, epoch: 3 | loss: 0.4551504
	speed: 0.0030s/iter; left time: 16.7871s
	iters: 700, epoch: 3 | loss: 0.4073055
	speed: 0.0030s/iter; left time: 16.4332s
	iters: 800, epoch: 3 | loss: 0.4500633
	speed: 0.0031s/iter; left time: 16.4660s
	iters: 900, epoch: 3 | loss: 0.6350484
	speed: 0.0032s/iter; left time: 16.7340s
	iters: 1000, epoch: 3 | loss: 1.0421597
	speed: 0.0029s/iter; left time: 14.7560s
Updating learning rate to 9.2652275175e-05
Epoch: 3 cost time: 3.1047184467315674
Epoch: 3, Steps: 1027 | Train Loss: 0.6661026 Vali Loss: 0.3842620 Best vali loss: 0.3748678

best validation loss 0.37486782425278997

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010685912042, 'e_layers': 2, 'learning_rate': 0.0003976776978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6121756
	speed: 0.0096s/iter; left time: 38.5832s
	iters: 200, epoch: 1 | loss: 0.9496763
	speed: 0.0035s/iter; left time: 13.6316s
	iters: 300, epoch: 1 | loss: 0.8323880
	speed: 0.0035s/iter; left time: 13.4081s
	iters: 400, epoch: 1 | loss: 0.3084021
	speed: 0.0036s/iter; left time: 13.3850s
	iters: 500, epoch: 1 | loss: 0.7108134
	speed: 0.0035s/iter; left time: 12.6832s
Updating learning rate to 0.0003976776978
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 2.1525628566741943
Epoch: 1, Steps: 514 | Train Loss: 0.6826911 Vali Loss: 0.3721923 Best vali loss: 0.3721923
	iters: 100, epoch: 2 | loss: 0.4129974
	speed: 0.0076s/iter; left time: 26.5523s
	iters: 200, epoch: 2 | loss: 0.6105907
	speed: 0.0036s/iter; left time: 12.2807s
	iters: 300, epoch: 2 | loss: 1.0312340
	speed: 0.0036s/iter; left time: 11.9704s
	iters: 400, epoch: 2 | loss: 0.3665864
	speed: 0.0036s/iter; left time: 11.5913s
	iters: 500, epoch: 2 | loss: 0.6086240
	speed: 0.0036s/iter; left time: 11.2113s
Updating learning rate to 0.0001988388489
Epoch: 2 cost time: 1.894089937210083
Epoch: 2, Steps: 514 | Train Loss: 0.6060065 Vali Loss: 0.3759244 Best vali loss: 0.3721923
	iters: 100, epoch: 3 | loss: 0.9450638
	speed: 0.0071s/iter; left time: 21.0645s
	iters: 200, epoch: 3 | loss: 0.7120711
	speed: 0.0030s/iter; left time: 8.7757s
	iters: 300, epoch: 3 | loss: 0.6650991
	speed: 0.0032s/iter; left time: 8.8186s
	iters: 400, epoch: 3 | loss: 0.4730489
	speed: 0.0032s/iter; left time: 8.6305s
	iters: 500, epoch: 3 | loss: 0.6001197
	speed: 0.0032s/iter; left time: 8.3127s
Updating learning rate to 9.941942445e-05
Epoch: 3 cost time: 1.6658568382263184
Epoch: 3, Steps: 514 | Train Loss: 0.6790805 Vali Loss: 0.3953009 Best vali loss: 0.3721923

best validation loss 0.3721922516003105

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010685912042, 'e_layers': 2, 'learning_rate': 0.0003976776978, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4613138
	speed: 0.0098s/iter; left time: 24.3127s
	iters: 200, epoch: 4 | loss: 0.8420460
	speed: 0.0035s/iter; left time: 8.3048s
	iters: 300, epoch: 4 | loss: 0.7353087
	speed: 0.0035s/iter; left time: 7.9126s
	iters: 400, epoch: 4 | loss: 0.2453372
	speed: 0.0035s/iter; left time: 7.6143s
	iters: 500, epoch: 4 | loss: 0.6052165
	speed: 0.0035s/iter; left time: 7.2041s
Updating learning rate to 4.9709712225e-05
Validation loss decreased (0.3722 --> 0.3677).  Saving model state dict ...
Epoch: 4 cost time: 2.146709442138672
Epoch: 4, Steps: 514 | Train Loss: 0.5778444 Vali Loss: 0.3677126 Best vali loss: 0.3677126
	iters: 100, epoch: 5 | loss: 0.3828442
	speed: 0.0074s/iter; left time: 14.4051s
	iters: 200, epoch: 5 | loss: 0.4162726
	speed: 0.0031s/iter; left time: 5.6998s
	iters: 300, epoch: 5 | loss: 0.8248299
	speed: 0.0030s/iter; left time: 5.3416s
	iters: 400, epoch: 5 | loss: 0.2984802
	speed: 0.0031s/iter; left time: 5.0781s
	iters: 500, epoch: 5 | loss: 0.4524809
	speed: 0.0030s/iter; left time: 4.6615s
Updating learning rate to 2.48548561125e-05
Validation loss decreased (0.3677 --> 0.3570).  Saving model state dict ...
Epoch: 5 cost time: 1.6296515464782715
Epoch: 5, Steps: 514 | Train Loss: 0.4749816 Vali Loss: 0.3570162 Best vali loss: 0.3570162
	iters: 100, epoch: 6 | loss: 0.6075464
	speed: 0.0071s/iter; left time: 10.2840s
	iters: 200, epoch: 6 | loss: 0.4367736
	speed: 0.0033s/iter; left time: 4.3961s
	iters: 300, epoch: 6 | loss: 0.5586783
	speed: 0.0032s/iter; left time: 3.9484s
	iters: 400, epoch: 6 | loss: 0.4033737
	speed: 0.0032s/iter; left time: 3.6504s
	iters: 500, epoch: 6 | loss: 0.5455926
	speed: 0.0031s/iter; left time: 3.2077s
Updating learning rate to 1.242742805625e-05
Epoch: 6 cost time: 1.6763765811920166
Epoch: 6, Steps: 514 | Train Loss: 0.5103930 Vali Loss: 0.3584630 Best vali loss: 0.3570162
	iters: 100, epoch: 7 | loss: 0.2305637
	speed: 0.0067s/iter; left time: 6.2076s
	iters: 200, epoch: 7 | loss: 0.1808834
	speed: 0.0031s/iter; left time: 2.5606s
	iters: 300, epoch: 7 | loss: 0.6150370
	speed: 0.0031s/iter; left time: 2.2437s
	iters: 400, epoch: 7 | loss: 0.3596501
	speed: 0.0030s/iter; left time: 1.9052s
	iters: 500, epoch: 7 | loss: 0.6070822
	speed: 0.0031s/iter; left time: 1.6259s
Updating learning rate to 6.213714028125e-06
Validation loss decreased (0.3570 --> 0.3564).  Saving model state dict ...
Epoch: 7 cost time: 1.6194360256195068
Epoch: 7, Steps: 514 | Train Loss: 0.3986433 Vali Loss: 0.3564265 Best vali loss: 0.3564265
	iters: 100, epoch: 8 | loss: 0.4045456
	speed: 0.0072s/iter; left time: 2.9968s
	iters: 200, epoch: 8 | loss: 0.3057247
	speed: 0.0032s/iter; left time: 0.9989s
	iters: 300, epoch: 8 | loss: 0.8744556
	speed: 0.0031s/iter; left time: 0.6733s
	iters: 400, epoch: 8 | loss: 0.5236459
	speed: 0.0030s/iter; left time: 0.3505s
	iters: 500, epoch: 8 | loss: 0.7843689
	speed: 0.0031s/iter; left time: 0.0466s
Updating learning rate to 3.1068570140625e-06
Epoch: 8 cost time: 1.6543195247650146
Epoch: 8, Steps: 514 | Train Loss: 0.5785481 Vali Loss: 0.3578206 Best vali loss: 0.3564265

best validation loss 0.3564264969530649

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015996385283, 'e_layers': 1, 'learning_rate': 0.0001677844995, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6354771
	speed: 0.0094s/iter; left time: 8.7485s
Updating learning rate to 0.0001677844995
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 0.759906530380249
Epoch: 1, Steps: 129 | Train Loss: 0.6354771 Vali Loss: 0.3654130 Best vali loss: 0.3654130
	iters: 100, epoch: 2 | loss: 0.6625276
	speed: 0.0057s/iter; left time: 4.5560s
Updating learning rate to 8.389224975e-05
Validation loss decreased (0.3654 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 0.42502284049987793
Epoch: 2, Steps: 129 | Train Loss: 0.6625276 Vali Loss: 0.3641118 Best vali loss: 0.3641118
	iters: 100, epoch: 3 | loss: 0.7212920
	speed: 0.0058s/iter; left time: 3.8880s
Updating learning rate to 4.1946124875e-05
Epoch: 3 cost time: 0.43181514739990234
Epoch: 3, Steps: 129 | Train Loss: 0.7212920 Vali Loss: 0.3668777 Best vali loss: 0.3641118
	iters: 100, epoch: 4 | loss: 0.5679660
	speed: 0.0060s/iter; left time: 3.2887s
Updating learning rate to 2.09730624375e-05
Epoch: 4 cost time: 0.4682619571685791
Epoch: 4, Steps: 129 | Train Loss: 0.5679660 Vali Loss: 0.3648583 Best vali loss: 0.3641118
	iters: 100, epoch: 5 | loss: 0.4696696
	speed: 0.0057s/iter; left time: 2.3655s
Updating learning rate to 1.048653121875e-05
Epoch: 5 cost time: 0.4248785972595215
Epoch: 5, Steps: 129 | Train Loss: 0.4696696 Vali Loss: 0.3647085 Best vali loss: 0.3641118
	iters: 100, epoch: 6 | loss: 0.7367231
	speed: 0.0056s/iter; left time: 1.6166s
Updating learning rate to 5.243265609375e-06
Validation loss decreased (0.3641 --> 0.3640).  Saving model state dict ...
Epoch: 6 cost time: 0.4265706539154053
Epoch: 6, Steps: 129 | Train Loss: 0.7367231 Vali Loss: 0.3640131 Best vali loss: 0.3640131
	iters: 100, epoch: 7 | loss: 0.5717441
	speed: 0.0056s/iter; left time: 0.8974s
Updating learning rate to 2.6216328046875e-06
Epoch: 7 cost time: 0.42685627937316895
Epoch: 7, Steps: 129 | Train Loss: 0.5717441 Vali Loss: 0.3640524 Best vali loss: 0.3640131
	iters: 100, epoch: 8 | loss: 0.6009991
	speed: 0.0056s/iter; left time: 0.1690s
Updating learning rate to 1.31081640234375e-06
Epoch: 8 cost time: 0.4297964572906494
Epoch: 8, Steps: 129 | Train Loss: 0.6009991 Vali Loss: 0.3641684 Best vali loss: 0.3640131

best validation loss 0.36401310595875874

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0018362930395, 'e_layers': 2, 'learning_rate': 0.0004022732482, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0559043
	speed: 0.0094s/iter; left time: 37.8672s
	iters: 200, epoch: 1 | loss: 0.3361474
	speed: 0.0034s/iter; left time: 13.3728s
	iters: 300, epoch: 1 | loss: 0.3323395
	speed: 0.0034s/iter; left time: 12.8154s
	iters: 400, epoch: 1 | loss: 0.9163337
	speed: 0.0034s/iter; left time: 12.6557s
	iters: 500, epoch: 1 | loss: 0.3824160
	speed: 0.0035s/iter; left time: 12.6736s
Updating learning rate to 0.0004022732482
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 2.0953381061553955
Epoch: 1, Steps: 514 | Train Loss: 0.6046282 Vali Loss: 0.3687952 Best vali loss: 0.3687952
	iters: 100, epoch: 2 | loss: 0.4743761
	speed: 0.0075s/iter; left time: 26.3732s
	iters: 200, epoch: 2 | loss: 0.6690883
	speed: 0.0034s/iter; left time: 11.7009s
	iters: 300, epoch: 2 | loss: 0.3783258
	speed: 0.0034s/iter; left time: 11.2550s
	iters: 400, epoch: 2 | loss: 0.4294964
	speed: 0.0034s/iter; left time: 10.8949s
	iters: 500, epoch: 2 | loss: 0.5819713
	speed: 0.0035s/iter; left time: 10.9008s
Updating learning rate to 0.0002011366241
Epoch: 2 cost time: 1.8344547748565674
Epoch: 2, Steps: 514 | Train Loss: 0.5066516 Vali Loss: 0.3792335 Best vali loss: 0.3687952
	iters: 100, epoch: 3 | loss: 0.9118902
	speed: 0.0074s/iter; left time: 22.2315s
	iters: 200, epoch: 3 | loss: 0.2966385
	speed: 0.0033s/iter; left time: 9.6621s
	iters: 300, epoch: 3 | loss: 0.8203706
	speed: 0.0033s/iter; left time: 9.1446s
	iters: 400, epoch: 3 | loss: 1.0392975
	speed: 0.0032s/iter; left time: 8.6406s
	iters: 500, epoch: 3 | loss: 0.4257366
	speed: 0.0032s/iter; left time: 8.1903s
Updating learning rate to 0.00010056831205
Validation loss decreased (0.3688 --> 0.3525).  Saving model state dict ...
Epoch: 3 cost time: 1.744872808456421
Epoch: 3, Steps: 514 | Train Loss: 0.6987867 Vali Loss: 0.3524916 Best vali loss: 0.3524916
	iters: 100, epoch: 4 | loss: 0.2289140
	speed: 0.0070s/iter; left time: 17.2902s
	iters: 200, epoch: 4 | loss: 0.4445191
	speed: 0.0031s/iter; left time: 7.4537s
	iters: 300, epoch: 4 | loss: 0.5768773
	speed: 0.0032s/iter; left time: 7.3726s
	iters: 400, epoch: 4 | loss: 0.6772759
	speed: 0.0031s/iter; left time: 6.7580s
	iters: 500, epoch: 4 | loss: 0.8796138
	speed: 0.0031s/iter; left time: 6.3927s
Updating learning rate to 5.0284156025e-05
Epoch: 4 cost time: 1.6575214862823486
Epoch: 4, Steps: 514 | Train Loss: 0.5614400 Vali Loss: 0.3585063 Best vali loss: 0.3524916
	iters: 100, epoch: 5 | loss: 0.5095866
	speed: 0.0069s/iter; left time: 13.5388s
	iters: 200, epoch: 5 | loss: 0.3634227
	speed: 0.0031s/iter; left time: 5.7890s
	iters: 300, epoch: 5 | loss: 0.6093996
	speed: 0.0031s/iter; left time: 5.4490s
	iters: 400, epoch: 5 | loss: 0.6884180
	speed: 0.0031s/iter; left time: 5.1101s
	iters: 500, epoch: 5 | loss: 0.2856113
	speed: 0.0031s/iter; left time: 4.7883s
Updating learning rate to 2.51420780125e-05
Epoch: 5 cost time: 1.6356110572814941
Epoch: 5, Steps: 514 | Train Loss: 0.4912876 Vali Loss: 0.3569401 Best vali loss: 0.3524916
	iters: 100, epoch: 6 | loss: 0.5225317
	speed: 0.0071s/iter; left time: 10.2959s
	iters: 200, epoch: 6 | loss: 0.2992989
	speed: 0.0032s/iter; left time: 4.3188s
	iters: 300, epoch: 6 | loss: 0.5655784
	speed: 0.0032s/iter; left time: 3.9626s
	iters: 400, epoch: 6 | loss: 0.3769549
	speed: 0.0031s/iter; left time: 3.5144s
	iters: 500, epoch: 6 | loss: 0.8301501
	speed: 0.0032s/iter; left time: 3.3107s
Updating learning rate to 1.257103900625e-05
Epoch: 6 cost time: 1.6872761249542236
Epoch: 6, Steps: 514 | Train Loss: 0.5189028 Vali Loss: 0.3537179 Best vali loss: 0.3524916
	iters: 100, epoch: 7 | loss: 0.4785295
	speed: 0.0069s/iter; left time: 6.4528s
	iters: 200, epoch: 7 | loss: 0.4839117
	speed: 0.0031s/iter; left time: 2.6065s
	iters: 300, epoch: 7 | loss: 0.5978571
	speed: 0.0033s/iter; left time: 2.4100s
	iters: 400, epoch: 7 | loss: 0.7700062
	speed: 0.0031s/iter; left time: 1.9333s
	iters: 500, epoch: 7 | loss: 0.6351548
	speed: 0.0030s/iter; left time: 1.5896s
Updating learning rate to 6.285519503125e-06
Epoch: 7 cost time: 1.6436386108398438
Epoch: 7, Steps: 514 | Train Loss: 0.5930918 Vali Loss: 0.3544212 Best vali loss: 0.3524916
	iters: 100, epoch: 8 | loss: 0.4572195
	speed: 0.0067s/iter; left time: 2.7859s
	iters: 200, epoch: 8 | loss: 0.2742712
	speed: 0.0031s/iter; left time: 0.9726s
	iters: 300, epoch: 8 | loss: 0.7359095
	speed: 0.0031s/iter; left time: 0.6716s
	iters: 400, epoch: 8 | loss: 0.4388949
	speed: 0.0031s/iter; left time: 0.3580s
	iters: 500, epoch: 8 | loss: 0.3995074
	speed: 0.0031s/iter; left time: 0.0462s
Updating learning rate to 3.1427597515625e-06
Epoch: 8 cost time: 1.6393225193023682
Epoch: 8, Steps: 514 | Train Loss: 0.4611605 Vali Loss: 0.3535958 Best vali loss: 0.3524916

best validation loss 0.35249162280606383

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0018278223718, 'e_layers': 2, 'learning_rate': 0.0004023637766, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6119175
	speed: 0.0098s/iter; left time: 39.2301s
	iters: 200, epoch: 1 | loss: 0.9491598
	speed: 0.0034s/iter; left time: 13.1921s
	iters: 300, epoch: 1 | loss: 0.8334404
	speed: 0.0034s/iter; left time: 12.8501s
	iters: 400, epoch: 1 | loss: 0.3081293
	speed: 0.0034s/iter; left time: 12.7049s
	iters: 500, epoch: 1 | loss: 0.7147164
	speed: 0.0036s/iter; left time: 13.1446s
Updating learning rate to 0.0004023637766
Validation loss decreased (inf --> 0.3738).  Saving model state dict ...
Epoch: 1 cost time: 2.1413657665252686
Epoch: 1, Steps: 514 | Train Loss: 0.6834727 Vali Loss: 0.3737514 Best vali loss: 0.3737514
	iters: 100, epoch: 2 | loss: 0.4148039
	speed: 0.0072s/iter; left time: 25.1075s
	iters: 200, epoch: 2 | loss: 0.5591829
	speed: 0.0030s/iter; left time: 10.2697s
	iters: 300, epoch: 2 | loss: 1.0401648
	speed: 0.0030s/iter; left time: 9.9614s
	iters: 400, epoch: 2 | loss: 0.3747113
	speed: 0.0030s/iter; left time: 9.5810s
	iters: 500, epoch: 2 | loss: 0.6425363
	speed: 0.0030s/iter; left time: 9.3818s
Updating learning rate to 0.0002011818883
Epoch: 2 cost time: 1.6110785007476807
Epoch: 2, Steps: 514 | Train Loss: 0.6062799 Vali Loss: 0.3756834 Best vali loss: 0.3737514
	iters: 100, epoch: 3 | loss: 0.9019347
	speed: 0.0071s/iter; left time: 21.1357s
	iters: 200, epoch: 3 | loss: 0.6512113
	speed: 0.0034s/iter; left time: 9.8265s
	iters: 300, epoch: 3 | loss: 0.6517193
	speed: 0.0034s/iter; left time: 9.4046s
	iters: 400, epoch: 3 | loss: 0.4940177
	speed: 0.0035s/iter; left time: 9.4922s
	iters: 500, epoch: 3 | loss: 0.6230173
	speed: 0.0035s/iter; left time: 9.1500s
Updating learning rate to 0.00010059094415
Epoch: 3 cost time: 1.827749490737915
Epoch: 3, Steps: 514 | Train Loss: 0.6643800 Vali Loss: 0.3849363 Best vali loss: 0.3737514

best validation loss 0.37375135514263086

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010707090776, 'e_layers': 2, 'learning_rate': 0.0004021735082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6117319
	speed: 0.0099s/iter; left time: 39.5695s
	iters: 200, epoch: 1 | loss: 0.9494884
	speed: 0.0036s/iter; left time: 14.1183s
	iters: 300, epoch: 1 | loss: 0.8327504
	speed: 0.0036s/iter; left time: 13.7567s
	iters: 400, epoch: 1 | loss: 0.3090266
	speed: 0.0036s/iter; left time: 13.4074s
	iters: 500, epoch: 1 | loss: 0.7111526
	speed: 0.0037s/iter; left time: 13.2438s
Updating learning rate to 0.0004021735082
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 2.2175636291503906
Epoch: 1, Steps: 514 | Train Loss: 0.6828300 Vali Loss: 0.3708022 Best vali loss: 0.3708022
	iters: 100, epoch: 2 | loss: 0.4203714
	speed: 0.0072s/iter; left time: 25.1059s
	iters: 200, epoch: 2 | loss: 0.5940016
	speed: 0.0031s/iter; left time: 10.4968s
	iters: 300, epoch: 2 | loss: 1.0076522
	speed: 0.0031s/iter; left time: 10.3692s
	iters: 400, epoch: 2 | loss: 0.3791678
	speed: 0.0031s/iter; left time: 9.8617s
	iters: 500, epoch: 2 | loss: 0.6472548
	speed: 0.0031s/iter; left time: 9.5742s
Updating learning rate to 0.0002010867541
Validation loss decreased (0.3708 --> 0.3596).  Saving model state dict ...
Epoch: 2 cost time: 1.6437435150146484
Epoch: 2, Steps: 514 | Train Loss: 0.6096895 Vali Loss: 0.3596156 Best vali loss: 0.3596156
	iters: 100, epoch: 3 | loss: 0.7741827
	speed: 0.0072s/iter; left time: 21.4768s
	iters: 200, epoch: 3 | loss: 0.5647871
	speed: 0.0031s/iter; left time: 8.9361s
	iters: 300, epoch: 3 | loss: 0.6234993
	speed: 0.0032s/iter; left time: 8.8096s
	iters: 400, epoch: 3 | loss: 0.5178263
	speed: 0.0031s/iter; left time: 8.2853s
	iters: 500, epoch: 3 | loss: 0.6122004
	speed: 0.0030s/iter; left time: 7.7835s
Updating learning rate to 0.00010054337705
Validation loss decreased (0.3596 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 1.6385998725891113
Epoch: 3, Steps: 514 | Train Loss: 0.6184992 Vali Loss: 0.3541849 Best vali loss: 0.3541849

best validation loss 0.35418485941142136

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010677941999, 'e_layers': 2, 'learning_rate': 0.000383933621, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4264325
	speed: 0.0098s/iter; left time: 39.2061s
	iters: 200, epoch: 1 | loss: 1.0776651
	speed: 0.0036s/iter; left time: 14.1520s
	iters: 300, epoch: 1 | loss: 1.0150049
	speed: 0.0036s/iter; left time: 13.6232s
	iters: 400, epoch: 1 | loss: 0.5038409
	speed: 0.0034s/iter; left time: 12.7688s
	iters: 500, epoch: 1 | loss: 1.1246276
	speed: 0.0034s/iter; left time: 12.2769s
Updating learning rate to 0.000383933621
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 2.159862756729126
Epoch: 1, Steps: 514 | Train Loss: 0.8295142 Vali Loss: 0.3737492 Best vali loss: 0.3737492
	iters: 100, epoch: 2 | loss: 0.3859911
	speed: 0.0072s/iter; left time: 25.0658s
	iters: 200, epoch: 2 | loss: 0.2585834
	speed: 0.0036s/iter; left time: 12.3322s
	iters: 300, epoch: 2 | loss: 0.5140902
	speed: 0.0036s/iter; left time: 11.8343s
	iters: 400, epoch: 2 | loss: 0.3955288
	speed: 0.0035s/iter; left time: 11.0446s
	iters: 500, epoch: 2 | loss: 0.6203145
	speed: 0.0034s/iter; left time: 10.4798s
Updating learning rate to 0.0001919668105
Validation loss decreased (0.3737 --> 0.3678).  Saving model state dict ...
Epoch: 2 cost time: 1.8377480506896973
Epoch: 2, Steps: 514 | Train Loss: 0.4349016 Vali Loss: 0.3677681 Best vali loss: 0.3677681
	iters: 100, epoch: 3 | loss: 0.3932864
	speed: 0.0076s/iter; left time: 22.7754s
	iters: 200, epoch: 3 | loss: 0.8532274
	speed: 0.0034s/iter; left time: 9.6663s
	iters: 300, epoch: 3 | loss: 0.5093670
	speed: 0.0035s/iter; left time: 9.8009s
	iters: 400, epoch: 3 | loss: 0.4620166
	speed: 0.0036s/iter; left time: 9.6629s
	iters: 500, epoch: 3 | loss: 1.0882362
	speed: 0.0036s/iter; left time: 9.3397s
Updating learning rate to 9.598340525e-05
Validation loss decreased (0.3678 --> 0.3598).  Saving model state dict ...
Epoch: 3 cost time: 1.8585286140441895
Epoch: 3, Steps: 514 | Train Loss: 0.6612267 Vali Loss: 0.3597525 Best vali loss: 0.3597525

best validation loss 0.35975245935275185

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010707090776, 'e_layers': 2, 'learning_rate': 0.0004021735082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4854237
	speed: 0.0097s/iter; left time: 24.0217s
	iters: 200, epoch: 4 | loss: 0.8263197
	speed: 0.0034s/iter; left time: 8.0168s
	iters: 300, epoch: 4 | loss: 0.7471519
	speed: 0.0034s/iter; left time: 7.6462s
	iters: 400, epoch: 4 | loss: 0.2583564
	speed: 0.0034s/iter; left time: 7.2809s
	iters: 500, epoch: 4 | loss: 0.6078599
	speed: 0.0034s/iter; left time: 6.9518s
Updating learning rate to 5.0271688525e-05
Validation loss decreased (0.3542 --> 0.3443).  Saving model state dict ...
Epoch: 4 cost time: 2.093736410140991
Epoch: 4, Steps: 514 | Train Loss: 0.5850223 Vali Loss: 0.3442934 Best vali loss: 0.3442934
	iters: 100, epoch: 5 | loss: 0.3829196
	speed: 0.0076s/iter; left time: 14.8137s
	iters: 200, epoch: 5 | loss: 0.4060701
	speed: 0.0034s/iter; left time: 6.2986s
	iters: 300, epoch: 5 | loss: 0.8484522
	speed: 0.0033s/iter; left time: 5.7134s
	iters: 400, epoch: 5 | loss: 0.2946267
	speed: 0.0032s/iter; left time: 5.3202s
	iters: 500, epoch: 5 | loss: 0.4521039
	speed: 0.0032s/iter; left time: 5.0361s
Updating learning rate to 2.51358442625e-05
Epoch: 5 cost time: 1.7408349514007568
Epoch: 5, Steps: 514 | Train Loss: 0.4768345 Vali Loss: 0.3458591 Best vali loss: 0.3442934
	iters: 100, epoch: 6 | loss: 0.6032195
	speed: 0.0070s/iter; left time: 10.1022s
	iters: 200, epoch: 6 | loss: 0.4311599
	speed: 0.0034s/iter; left time: 4.5028s
	iters: 300, epoch: 6 | loss: 0.5514816
	speed: 0.0033s/iter; left time: 4.0728s
	iters: 400, epoch: 6 | loss: 0.4037527
	speed: 0.0032s/iter; left time: 3.6486s
	iters: 500, epoch: 6 | loss: 0.5645537
	speed: 0.0032s/iter; left time: 3.3665s
Updating learning rate to 1.256792213125e-05
Epoch: 6 cost time: 1.710087537765503
Epoch: 6, Steps: 514 | Train Loss: 0.5108335 Vali Loss: 0.3492323 Best vali loss: 0.3442934
	iters: 100, epoch: 7 | loss: 0.2348620
	speed: 0.0070s/iter; left time: 6.5427s
	iters: 200, epoch: 7 | loss: 0.1784727
	speed: 0.0032s/iter; left time: 2.6746s
	iters: 300, epoch: 7 | loss: 0.6028300
	speed: 0.0034s/iter; left time: 2.4808s
	iters: 400, epoch: 7 | loss: 0.3456068
	speed: 0.0032s/iter; left time: 2.0095s
	iters: 500, epoch: 7 | loss: 0.6294366
	speed: 0.0031s/iter; left time: 1.6433s
Updating learning rate to 6.283961065625e-06
Epoch: 7 cost time: 1.7039434909820557
Epoch: 7, Steps: 514 | Train Loss: 0.3982416 Vali Loss: 0.3474745 Best vali loss: 0.3442934
	iters: 100, epoch: 8 | loss: 0.4950440
	speed: 0.0071s/iter; left time: 2.9545s
	iters: 200, epoch: 8 | loss: 0.3008451
	speed: 0.0033s/iter; left time: 1.0348s
	iters: 300, epoch: 8 | loss: 0.8662614
	speed: 0.0032s/iter; left time: 0.6823s
	iters: 400, epoch: 8 | loss: 0.5185540
	speed: 0.0032s/iter; left time: 0.3696s
	iters: 500, epoch: 8 | loss: 0.7747251
	speed: 0.0031s/iter; left time: 0.0470s
Updating learning rate to 3.1419805328125e-06
Epoch: 8 cost time: 1.6811442375183105
Epoch: 8, Steps: 514 | Train Loss: 0.5910859 Vali Loss: 0.3475898 Best vali loss: 0.3442934

best validation loss 0.3442934432760437

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021595089073, 'e_layers': 2, 'learning_rate': 0.000586207253, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3487395
	speed: 0.0092s/iter; left time: 37.0732s
	iters: 200, epoch: 1 | loss: 0.3740285
	speed: 0.0032s/iter; left time: 12.6448s
	iters: 300, epoch: 1 | loss: 0.4854595
	speed: 0.0032s/iter; left time: 12.3772s
	iters: 400, epoch: 1 | loss: 0.4852898
	speed: 0.0032s/iter; left time: 12.0037s
	iters: 500, epoch: 1 | loss: 1.3507267
	speed: 0.0033s/iter; left time: 11.9195s
Updating learning rate to 0.000586207253
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 2.012364625930786
Epoch: 1, Steps: 514 | Train Loss: 0.6088488 Vali Loss: 0.3725294 Best vali loss: 0.3725294
	iters: 100, epoch: 2 | loss: 1.1564335
	speed: 0.0075s/iter; left time: 26.3950s
	iters: 200, epoch: 2 | loss: 0.4600428
	speed: 0.0034s/iter; left time: 11.6395s
	iters: 300, epoch: 2 | loss: 0.6615229
	speed: 0.0035s/iter; left time: 11.3819s
	iters: 400, epoch: 2 | loss: 0.4522712
	speed: 0.0033s/iter; left time: 10.7087s
	iters: 500, epoch: 2 | loss: 0.3898409
	speed: 0.0035s/iter; left time: 10.9718s
Updating learning rate to 0.0002931036265
Epoch: 2 cost time: 1.8286266326904297
Epoch: 2, Steps: 514 | Train Loss: 0.6240222 Vali Loss: 0.3734796 Best vali loss: 0.3725294
	iters: 100, epoch: 3 | loss: 0.3409866
	speed: 0.0071s/iter; left time: 21.1578s
	iters: 200, epoch: 3 | loss: 0.6721643
	speed: 0.0034s/iter; left time: 9.8403s
	iters: 300, epoch: 3 | loss: 0.3856311
	speed: 0.0035s/iter; left time: 9.6814s
	iters: 400, epoch: 3 | loss: 0.4292858
	speed: 0.0030s/iter; left time: 8.1775s
	iters: 500, epoch: 3 | loss: 0.6366435
	speed: 0.0030s/iter; left time: 7.8290s
Updating learning rate to 0.00014655181325
Validation loss decreased (0.3725 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 1.7123570442199707
Epoch: 3, Steps: 514 | Train Loss: 0.4929422 Vali Loss: 0.3609360 Best vali loss: 0.3609360
	iters: 100, epoch: 4 | loss: 0.3225289
	speed: 0.0069s/iter; left time: 17.0354s
	iters: 200, epoch: 4 | loss: 0.6434680
	speed: 0.0030s/iter; left time: 7.2217s
	iters: 300, epoch: 4 | loss: 0.5201153
	speed: 0.0030s/iter; left time: 6.9003s
	iters: 400, epoch: 4 | loss: 0.3090860
	speed: 0.0030s/iter; left time: 6.6127s
	iters: 500, epoch: 4 | loss: 0.8117839
	speed: 0.0030s/iter; left time: 6.2757s
Updating learning rate to 7.3275906625e-05
Validation loss decreased (0.3609 --> 0.3504).  Saving model state dict ...
Epoch: 4 cost time: 1.6041982173919678
Epoch: 4, Steps: 514 | Train Loss: 0.5213964 Vali Loss: 0.3503734 Best vali loss: 0.3503734
	iters: 100, epoch: 5 | loss: 0.7036045
	speed: 0.0075s/iter; left time: 14.6028s
	iters: 200, epoch: 5 | loss: 0.3662940
	speed: 0.0035s/iter; left time: 6.4583s
	iters: 300, epoch: 5 | loss: 0.4283292
	speed: 0.0034s/iter; left time: 6.0321s
	iters: 400, epoch: 5 | loss: 0.4833406
	speed: 0.0034s/iter; left time: 5.5741s
	iters: 500, epoch: 5 | loss: 0.7771568
	speed: 0.0033s/iter; left time: 5.1951s
Updating learning rate to 3.66379533125e-05
Epoch: 5 cost time: 1.78985595703125
Epoch: 5, Steps: 514 | Train Loss: 0.5517450 Vali Loss: 0.3525702 Best vali loss: 0.3503734
	iters: 100, epoch: 6 | loss: 0.7134247
	speed: 0.0068s/iter; left time: 9.8472s
	iters: 200, epoch: 6 | loss: 0.3890373
	speed: 0.0030s/iter; left time: 4.0325s
	iters: 300, epoch: 6 | loss: 0.3550862
	speed: 0.0030s/iter; left time: 3.7515s
	iters: 400, epoch: 6 | loss: 0.5297435
	speed: 0.0030s/iter; left time: 3.3929s
	iters: 500, epoch: 6 | loss: 0.5396556
	speed: 0.0031s/iter; left time: 3.2582s
Updating learning rate to 1.831897665625e-05
Epoch: 6 cost time: 1.5988397598266602
Epoch: 6, Steps: 514 | Train Loss: 0.5053895 Vali Loss: 0.3560920 Best vali loss: 0.3503734
	iters: 100, epoch: 7 | loss: 0.6430216
	speed: 0.0068s/iter; left time: 6.3578s
	iters: 200, epoch: 7 | loss: 0.3733375
	speed: 0.0031s/iter; left time: 2.5861s
	iters: 300, epoch: 7 | loss: 0.2486742
	speed: 0.0031s/iter; left time: 2.2557s
	iters: 400, epoch: 7 | loss: 0.2245399
	speed: 0.0031s/iter; left time: 1.9656s
	iters: 500, epoch: 7 | loss: 0.3130379
	speed: 0.0031s/iter; left time: 1.6541s
Updating learning rate to 9.159488328125e-06
Epoch: 7 cost time: 1.648853063583374
Epoch: 7, Steps: 514 | Train Loss: 0.3605222 Vali Loss: 0.3551276 Best vali loss: 0.3503734
	iters: 100, epoch: 8 | loss: 0.3405069
	speed: 0.0071s/iter; left time: 2.9369s
	iters: 200, epoch: 8 | loss: 0.4864151
	speed: 0.0030s/iter; left time: 0.9589s
	iters: 300, epoch: 8 | loss: 0.3827273
	speed: 0.0031s/iter; left time: 0.6638s
	iters: 400, epoch: 8 | loss: 0.7457258
	speed: 0.0032s/iter; left time: 0.3626s
	iters: 500, epoch: 8 | loss: 0.8151009
	speed: 0.0032s/iter; left time: 0.0473s
Updating learning rate to 4.5797441640625e-06
Epoch: 8 cost time: 1.6480064392089844
Epoch: 8, Steps: 514 | Train Loss: 0.5540952 Vali Loss: 0.3564192 Best vali loss: 0.3503734

best validation loss 0.35037336728310536

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0034496132017, 'e_layers': 4, 'learning_rate': 0.0003432148612, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2801892
	speed: 0.0112s/iter; left time: 90.8850s
	iters: 200, epoch: 1 | loss: 0.2473449
	speed: 0.0050s/iter; left time: 39.7302s
	iters: 300, epoch: 1 | loss: 1.5602762
	speed: 0.0050s/iter; left time: 39.3796s
	iters: 400, epoch: 1 | loss: 0.4114304
	speed: 0.0050s/iter; left time: 38.8119s
	iters: 500, epoch: 1 | loss: 0.3795509
	speed: 0.0050s/iter; left time: 38.4521s
	iters: 600, epoch: 1 | loss: 0.2894987
	speed: 0.0051s/iter; left time: 38.5957s
	iters: 700, epoch: 1 | loss: 0.1572508
	speed: 0.0051s/iter; left time: 38.1991s
	iters: 800, epoch: 1 | loss: 0.1822776
	speed: 0.0051s/iter; left time: 37.5543s
	iters: 900, epoch: 1 | loss: 0.6044608
	speed: 0.0050s/iter; left time: 36.8533s
	iters: 1000, epoch: 1 | loss: 0.4893350
	speed: 0.0051s/iter; left time: 37.1086s
Updating learning rate to 0.00033015202335819104
Validation loss decreased (inf --> 0.3642).  Saving model state dict ...
Epoch: 1 cost time: 5.506673812866211
Epoch: 1, Steps: 1027 | Train Loss: 0.4601614 Vali Loss: 0.3641580 Best vali loss: 0.3641580
	iters: 100, epoch: 2 | loss: 0.2811000
	speed: 0.0132s/iter; left time: 93.4663s
	iters: 200, epoch: 2 | loss: 0.5746845
	speed: 0.0051s/iter; left time: 35.5439s
	iters: 300, epoch: 2 | loss: 0.5826961
	speed: 0.0052s/iter; left time: 35.5344s
	iters: 400, epoch: 2 | loss: 1.4328262
	speed: 0.0051s/iter; left time: 34.7481s
	iters: 500, epoch: 2 | loss: 0.5709263
	speed: 0.0051s/iter; left time: 34.2488s
	iters: 600, epoch: 2 | loss: 0.3724340
	speed: 0.0051s/iter; left time: 33.5387s
	iters: 700, epoch: 2 | loss: 0.3882391
	speed: 0.0049s/iter; left time: 31.6646s
	iters: 800, epoch: 2 | loss: 1.7162646
	speed: 0.0049s/iter; left time: 31.5204s
	iters: 900, epoch: 2 | loss: 0.4733036
	speed: 0.0049s/iter; left time: 31.0579s
	iters: 1000, epoch: 2 | loss: 0.3146048
	speed: 0.0049s/iter; left time: 30.1879s
Updating learning rate to 0.0002929522084792598
Epoch: 2 cost time: 5.204583406448364
Epoch: 2, Steps: 1027 | Train Loss: 0.6707079 Vali Loss: 0.3780457 Best vali loss: 0.3641580
	iters: 100, epoch: 3 | loss: 1.1135806
	speed: 0.0131s/iter; left time: 79.1330s
	iters: 200, epoch: 3 | loss: 0.6146424
	speed: 0.0052s/iter; left time: 30.9641s
	iters: 300, epoch: 3 | loss: 1.1256688
	speed: 0.0052s/iter; left time: 30.3284s
	iters: 400, epoch: 3 | loss: 0.2735760
	speed: 0.0051s/iter; left time: 29.5880s
	iters: 500, epoch: 3 | loss: 0.4349277
	speed: 0.0052s/iter; left time: 29.3041s
	iters: 600, epoch: 3 | loss: 0.3909694
	speed: 0.0051s/iter; left time: 28.4090s
	iters: 700, epoch: 3 | loss: 0.4170482
	speed: 0.0052s/iter; left time: 28.2583s
	iters: 800, epoch: 3 | loss: 0.8571378
	speed: 0.0051s/iter; left time: 27.3116s
	iters: 900, epoch: 3 | loss: 0.2251279
	speed: 0.0051s/iter; left time: 26.8560s
	iters: 1000, epoch: 3 | loss: 1.0111544
	speed: 0.0051s/iter; left time: 26.1976s
Updating learning rate to 0.00023727875116136193
Epoch: 3 cost time: 5.330302000045776
Epoch: 3, Steps: 1027 | Train Loss: 0.6463833 Vali Loss: 0.3799120 Best vali loss: 0.3641580
	iters: 100, epoch: 4 | loss: 0.4072727
	speed: 0.0132s/iter; left time: 66.4347s
	iters: 200, epoch: 4 | loss: 0.2450403
	speed: 0.0051s/iter; left time: 25.4090s
	iters: 300, epoch: 4 | loss: 0.4554323
	speed: 0.0052s/iter; left time: 24.9987s
	iters: 400, epoch: 4 | loss: 0.8014596
	speed: 0.0052s/iter; left time: 24.4353s
	iters: 500, epoch: 4 | loss: 0.5735254
	speed: 0.0047s/iter; left time: 21.7230s
	iters: 600, epoch: 4 | loss: 0.9278255
	speed: 0.0045s/iter; left time: 20.4001s
	iters: 700, epoch: 4 | loss: 0.2144136
	speed: 0.0048s/iter; left time: 21.4206s
	iters: 800, epoch: 4 | loss: 0.6153747
	speed: 0.0048s/iter; left time: 20.8653s
	iters: 900, epoch: 4 | loss: 0.4067408
	speed: 0.0051s/iter; left time: 21.7757s
	iters: 1000, epoch: 4 | loss: 0.3498298
	speed: 0.0052s/iter; left time: 21.4186s
Updating learning rate to 0.0001716074306
Validation loss decreased (0.3642 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 5.149956464767456
Epoch: 4, Steps: 1027 | Train Loss: 0.4996915 Vali Loss: 0.3512690 Best vali loss: 0.3512690
	iters: 100, epoch: 5 | loss: 0.8345554
	speed: 0.0133s/iter; left time: 53.4851s
	iters: 200, epoch: 5 | loss: 0.3077884
	speed: 0.0050s/iter; left time: 19.5802s
	iters: 300, epoch: 5 | loss: 0.1579145
	speed: 0.0050s/iter; left time: 19.0834s
	iters: 400, epoch: 5 | loss: 0.3530156
	speed: 0.0050s/iter; left time: 18.6188s
	iters: 500, epoch: 5 | loss: 0.2961812
	speed: 0.0050s/iter; left time: 17.9336s
	iters: 600, epoch: 5 | loss: 0.5124164
	speed: 0.0049s/iter; left time: 17.3102s
	iters: 700, epoch: 5 | loss: 0.3364459
	speed: 0.0051s/iter; left time: 17.4573s
	iters: 800, epoch: 5 | loss: 0.2424548
	speed: 0.0051s/iter; left time: 16.9568s
	iters: 900, epoch: 5 | loss: 1.0604692
	speed: 0.0051s/iter; left time: 16.3699s
	iters: 1000, epoch: 5 | loss: 0.1940248
	speed: 0.0051s/iter; left time: 15.8019s
Updating learning rate to 0.00010593611003863807
Epoch: 5 cost time: 5.220287799835205
Epoch: 5, Steps: 1027 | Train Loss: 0.4295266 Vali Loss: 0.3841531 Best vali loss: 0.3512690
	iters: 100, epoch: 6 | loss: 0.2031587
	speed: 0.0126s/iter; left time: 37.6394s
	iters: 200, epoch: 6 | loss: 0.4751348
	speed: 0.0045s/iter; left time: 12.9956s
	iters: 300, epoch: 6 | loss: 0.1865809
	speed: 0.0045s/iter; left time: 12.4947s
	iters: 400, epoch: 6 | loss: 0.4463514
	speed: 0.0045s/iter; left time: 12.0260s
	iters: 500, epoch: 6 | loss: 0.1783776
	speed: 0.0045s/iter; left time: 11.5570s
	iters: 600, epoch: 6 | loss: 0.3348392
	speed: 0.0045s/iter; left time: 11.1414s
	iters: 700, epoch: 6 | loss: 0.2368485
	speed: 0.0044s/iter; left time: 10.5579s
	iters: 800, epoch: 6 | loss: 0.4103290
	speed: 0.0044s/iter; left time: 10.1401s
	iters: 900, epoch: 6 | loss: 0.6323858
	speed: 0.0045s/iter; left time: 9.8081s
	iters: 1000, epoch: 6 | loss: 0.3380544
	speed: 0.0045s/iter; left time: 9.3475s
Updating learning rate to 5.026265272074017e-05
Epoch: 6 cost time: 4.649170160293579
Epoch: 6, Steps: 1027 | Train Loss: 0.3442060 Vali Loss: 0.3665529 Best vali loss: 0.3512690
	iters: 100, epoch: 7 | loss: 0.4255703
	speed: 0.0126s/iter; left time: 24.5749s
	iters: 200, epoch: 7 | loss: 0.1518704
	speed: 0.0046s/iter; left time: 8.5500s
	iters: 300, epoch: 7 | loss: 0.6060821
	speed: 0.0046s/iter; left time: 8.1000s
	iters: 400, epoch: 7 | loss: 0.5343151
	speed: 0.0046s/iter; left time: 7.6454s
	iters: 500, epoch: 7 | loss: 0.7879090
	speed: 0.0047s/iter; left time: 7.3092s
	iters: 600, epoch: 7 | loss: 1.5577933
	speed: 0.0046s/iter; left time: 6.6308s
	iters: 700, epoch: 7 | loss: 0.2328529
	speed: 0.0045s/iter; left time: 6.1499s
	iters: 800, epoch: 7 | loss: 0.3127100
	speed: 0.0046s/iter; left time: 5.7541s
	iters: 900, epoch: 7 | loss: 0.2160659
	speed: 0.0046s/iter; left time: 5.3349s
	iters: 1000, epoch: 7 | loss: 0.2828362
	speed: 0.0047s/iter; left time: 4.9342s
Updating learning rate to 1.3062837841808917e-05
Epoch: 7 cost time: 4.783595323562622
Epoch: 7, Steps: 1027 | Train Loss: 0.5108005 Vali Loss: 0.3714679 Best vali loss: 0.3512690
	iters: 100, epoch: 8 | loss: 0.7639928
	speed: 0.0128s/iter; left time: 11.9127s
	iters: 200, epoch: 8 | loss: 0.2543952
	speed: 0.0045s/iter; left time: 3.7182s
	iters: 300, epoch: 8 | loss: 0.4468877
	speed: 0.0044s/iter; left time: 3.2196s
	iters: 400, epoch: 8 | loss: 0.3072480
	speed: 0.0044s/iter; left time: 2.7940s
	iters: 500, epoch: 8 | loss: 1.0765316
	speed: 0.0045s/iter; left time: 2.3568s
	iters: 600, epoch: 8 | loss: 0.2825598
	speed: 0.0045s/iter; left time: 1.9087s
	iters: 700, epoch: 8 | loss: 0.8152215
	speed: 0.0045s/iter; left time: 1.4734s
	iters: 800, epoch: 8 | loss: 0.1649048
	speed: 0.0044s/iter; left time: 1.0102s
	iters: 900, epoch: 8 | loss: 0.4519822
	speed: 0.0044s/iter; left time: 0.5688s
	iters: 1000, epoch: 8 | loss: 0.3325410
	speed: 0.0045s/iter; left time: 0.1254s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.642342567443848
Epoch: 8, Steps: 1027 | Train Loss: 0.4896265 Vali Loss: 0.3858378 Best vali loss: 0.3512690

best validation loss 0.3512690290018243

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0067679724203, 'e_layers': 1, 'learning_rate': 0.0025232603707, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002427224491193286
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 0.654097318649292
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3720065 Best vali loss: 0.3720065
Updating learning rate to 0.0021537374447606257
Validation loss decreased (0.3720 --> 0.3704).  Saving model state dict ...
Epoch: 2 cost time: 0.301682710647583
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703601 Best vali loss: 0.3703601
Updating learning rate to 0.0017444351550551425
Epoch: 3 cost time: 0.3115391731262207
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3898173 Best vali loss: 0.3703601

best validation loss 0.3703600958311722

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.005609792326, 'e_layers': 1, 'learning_rate': 0.0001713319014, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0390315
	speed: 0.0087s/iter; left time: 34.9054s
	iters: 200, epoch: 1 | loss: 0.5394627
	speed: 0.0025s/iter; left time: 9.7921s
	iters: 300, epoch: 1 | loss: 0.7211542
	speed: 0.0025s/iter; left time: 9.5313s
	iters: 400, epoch: 1 | loss: 0.4074612
	speed: 0.0025s/iter; left time: 9.3061s
	iters: 500, epoch: 1 | loss: 0.6098718
	speed: 0.0025s/iter; left time: 9.0424s
Updating learning rate to 0.0001713319014
Validation loss decreased (inf --> 0.3645).  Saving model state dict ...
Epoch: 1 cost time: 1.63801908493042
Epoch: 1, Steps: 514 | Train Loss: 0.6633963 Vali Loss: 0.3644906 Best vali loss: 0.3644906
	iters: 100, epoch: 2 | loss: 0.2438202
	speed: 0.0059s/iter; left time: 20.5738s
	iters: 200, epoch: 2 | loss: 0.3532915
	speed: 0.0024s/iter; left time: 8.0765s
	iters: 300, epoch: 2 | loss: 1.0254945
	speed: 0.0024s/iter; left time: 7.9154s
	iters: 400, epoch: 2 | loss: 0.4310961
	speed: 0.0024s/iter; left time: 7.5821s
	iters: 500, epoch: 2 | loss: 0.9650804
	speed: 0.0024s/iter; left time: 7.3607s
Updating learning rate to 8.56659507e-05
Epoch: 2 cost time: 1.2778537273406982
Epoch: 2, Steps: 514 | Train Loss: 0.6037565 Vali Loss: 0.3667359 Best vali loss: 0.3644906
	iters: 100, epoch: 3 | loss: 0.6945173
	speed: 0.0057s/iter; left time: 16.9302s
	iters: 200, epoch: 3 | loss: 0.6315654
	speed: 0.0023s/iter; left time: 6.6729s
	iters: 300, epoch: 3 | loss: 0.5576901
	speed: 0.0023s/iter; left time: 6.2798s
	iters: 400, epoch: 3 | loss: 0.4000878
	speed: 0.0024s/iter; left time: 6.3327s
	iters: 500, epoch: 3 | loss: 0.5794150
	speed: 0.0023s/iter; left time: 5.9852s
Updating learning rate to 4.283297535e-05
Epoch: 3 cost time: 1.2376480102539062
Epoch: 3, Steps: 514 | Train Loss: 0.5726551 Vali Loss: 0.3647005 Best vali loss: 0.3644906

best validation loss 0.36449055708578854

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0023565174073, 'e_layers': 3, 'learning_rate': 0.001454628088, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5286873
	speed: 0.0114s/iter; left time: 10.6117s
Updating learning rate to 0.001454628088
Validation loss decreased (inf --> 0.3952).  Saving model state dict ...
Epoch: 1 cost time: 0.9985089302062988
Epoch: 1, Steps: 129 | Train Loss: 0.5286873 Vali Loss: 0.3952342 Best vali loss: 0.3952342
	iters: 100, epoch: 2 | loss: 0.8164181
	speed: 0.0084s/iter; left time: 6.7573s
Updating learning rate to 0.000727314044
Validation loss decreased (0.3952 --> 0.3796).  Saving model state dict ...
Epoch: 2 cost time: 0.693941593170166
Epoch: 2, Steps: 129 | Train Loss: 0.8164181 Vali Loss: 0.3796031 Best vali loss: 0.3796031
	iters: 100, epoch: 3 | loss: 0.5808577
	speed: 0.0084s/iter; left time: 5.6374s
Updating learning rate to 0.000363657022
Validation loss decreased (0.3796 --> 0.3591).  Saving model state dict ...
Epoch: 3 cost time: 0.6721382141113281
Epoch: 3, Steps: 129 | Train Loss: 0.5808577 Vali Loss: 0.3590640 Best vali loss: 0.3590640

best validation loss 0.3590639856686058

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0023565174073, 'e_layers': 3, 'learning_rate': 0.001454628088, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4446364
	speed: 0.0114s/iter; left time: 6.2344s
Updating learning rate to 0.000181828511
Epoch: 4 cost time: 0.9932334423065186
Epoch: 4, Steps: 129 | Train Loss: 0.4446364 Vali Loss: 0.3658634 Best vali loss: 0.3590640
	iters: 100, epoch: 5 | loss: 0.5840169
	speed: 0.0081s/iter; left time: 3.3628s
Updating learning rate to 9.09142555e-05
Epoch: 5 cost time: 0.6565709114074707
Epoch: 5, Steps: 129 | Train Loss: 0.5840169 Vali Loss: 0.3635204 Best vali loss: 0.3590640
	iters: 100, epoch: 6 | loss: 0.5029072
	speed: 0.0084s/iter; left time: 2.4086s
Updating learning rate to 4.545712775e-05
Epoch: 6 cost time: 0.6971983909606934
Epoch: 6, Steps: 129 | Train Loss: 0.5029072 Vali Loss: 0.3650971 Best vali loss: 0.3590640
	iters: 100, epoch: 7 | loss: 0.4623512
	speed: 0.0081s/iter; left time: 1.2863s
Updating learning rate to 2.2728563875e-05
Epoch: 7 cost time: 0.6421568393707275
Epoch: 7, Steps: 129 | Train Loss: 0.4623512 Vali Loss: 0.3676868 Best vali loss: 0.3590640
	iters: 100, epoch: 8 | loss: 0.4551412
	speed: 0.0079s/iter; left time: 0.2379s
Updating learning rate to 1.13642819375e-05
Epoch: 8 cost time: 0.6443643569946289
Epoch: 8, Steps: 129 | Train Loss: 0.4551412 Vali Loss: 0.3635465 Best vali loss: 0.3590640

best validation loss 0.3590639856686058

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0028971073898, 'e_layers': 1, 'learning_rate': 0.0004205547987, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5823771
	speed: 0.0086s/iter; left time: 34.4598s
	iters: 200, epoch: 1 | loss: 1.1391118
	speed: 0.0025s/iter; left time: 9.6995s
	iters: 300, epoch: 1 | loss: 0.7044246
	speed: 0.0024s/iter; left time: 9.3050s
	iters: 400, epoch: 1 | loss: 0.6828353
	speed: 0.0025s/iter; left time: 9.2336s
	iters: 500, epoch: 1 | loss: 0.6158289
	speed: 0.0025s/iter; left time: 8.8956s
Updating learning rate to 0.0004205547987
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 1.6123051643371582
Epoch: 1, Steps: 514 | Train Loss: 0.7449155 Vali Loss: 0.3697899 Best vali loss: 0.3697899
	iters: 100, epoch: 2 | loss: 0.3138199
	speed: 0.0059s/iter; left time: 20.7908s
	iters: 200, epoch: 2 | loss: 1.0642694
	speed: 0.0023s/iter; left time: 7.8316s
	iters: 300, epoch: 2 | loss: 0.9834662
	speed: 0.0024s/iter; left time: 7.7821s
	iters: 400, epoch: 2 | loss: 0.6602197
	speed: 0.0023s/iter; left time: 7.3334s
	iters: 500, epoch: 2 | loss: 0.4532390
	speed: 0.0023s/iter; left time: 7.0884s
Updating learning rate to 0.00021027739935
Validation loss decreased (0.3698 --> 0.3626).  Saving model state dict ...
Epoch: 2 cost time: 1.2462077140808105
Epoch: 2, Steps: 514 | Train Loss: 0.6950029 Vali Loss: 0.3626434 Best vali loss: 0.3626434
	iters: 100, epoch: 3 | loss: 0.5782129
	speed: 0.0059s/iter; left time: 17.4667s
	iters: 200, epoch: 3 | loss: 0.3714733
	speed: 0.0025s/iter; left time: 7.0704s
	iters: 300, epoch: 3 | loss: 0.2793492
	speed: 0.0026s/iter; left time: 7.1707s
	iters: 400, epoch: 3 | loss: 0.7138066
	speed: 0.0026s/iter; left time: 6.8799s
	iters: 500, epoch: 3 | loss: 0.3684602
	speed: 0.0024s/iter; left time: 6.2452s
Updating learning rate to 0.000105138699675
Epoch: 3 cost time: 1.3202893733978271
Epoch: 3, Steps: 514 | Train Loss: 0.4622604 Vali Loss: 0.3653733 Best vali loss: 0.3626434
	iters: 100, epoch: 4 | loss: 1.0292196
	speed: 0.0057s/iter; left time: 14.0369s
	iters: 200, epoch: 4 | loss: 0.5747583
	speed: 0.0024s/iter; left time: 5.5836s
	iters: 300, epoch: 4 | loss: 0.2596325
	speed: 0.0023s/iter; left time: 5.1795s
	iters: 400, epoch: 4 | loss: 0.9908553
	speed: 0.0023s/iter; left time: 5.0453s
	iters: 500, epoch: 4 | loss: 0.4636042
	speed: 0.0024s/iter; left time: 5.0064s
Updating learning rate to 5.25693498375e-05
Epoch: 4 cost time: 1.2517168521881104
Epoch: 4, Steps: 514 | Train Loss: 0.6636140 Vali Loss: 0.3708069 Best vali loss: 0.3626434
	iters: 100, epoch: 5 | loss: 0.7083518
	speed: 0.0058s/iter; left time: 11.3880s
	iters: 200, epoch: 5 | loss: 0.4958341
	speed: 0.0023s/iter; left time: 4.3328s
	iters: 300, epoch: 5 | loss: 0.4698060
	speed: 0.0024s/iter; left time: 4.2509s
	iters: 400, epoch: 5 | loss: 0.4545446
	speed: 0.0024s/iter; left time: 3.9414s
	iters: 500, epoch: 5 | loss: 0.5387434
	speed: 0.0023s/iter; left time: 3.5991s
Updating learning rate to 2.628467491875e-05
Epoch: 5 cost time: 1.2587039470672607
Epoch: 5, Steps: 514 | Train Loss: 0.5334560 Vali Loss: 0.3686397 Best vali loss: 0.3626434
	iters: 100, epoch: 6 | loss: 0.5324423
	speed: 0.0057s/iter; left time: 8.2951s
	iters: 200, epoch: 6 | loss: 0.3841387
	speed: 0.0023s/iter; left time: 3.1225s
	iters: 300, epoch: 6 | loss: 0.8038071
	speed: 0.0024s/iter; left time: 2.9561s
	iters: 400, epoch: 6 | loss: 0.4669412
	speed: 0.0024s/iter; left time: 2.7079s
	iters: 500, epoch: 6 | loss: 0.8133786
	speed: 0.0024s/iter; left time: 2.4699s
Updating learning rate to 1.3142337459375e-05
Epoch: 6 cost time: 1.2630884647369385
Epoch: 6, Steps: 514 | Train Loss: 0.6001416 Vali Loss: 0.3680870 Best vali loss: 0.3626434
	iters: 100, epoch: 7 | loss: 0.7367287
	speed: 0.0057s/iter; left time: 5.3370s
	iters: 200, epoch: 7 | loss: 0.8176563
	speed: 0.0023s/iter; left time: 1.9284s
	iters: 300, epoch: 7 | loss: 0.5942360
	speed: 0.0024s/iter; left time: 1.7652s
	iters: 400, epoch: 7 | loss: 0.8474859
	speed: 0.0024s/iter; left time: 1.4941s
	iters: 500, epoch: 7 | loss: 0.3575864
	speed: 0.0024s/iter; left time: 1.2640s
Updating learning rate to 6.5711687296875e-06
Epoch: 7 cost time: 1.2569880485534668
Epoch: 7, Steps: 514 | Train Loss: 0.6707387 Vali Loss: 0.3686870 Best vali loss: 0.3626434
	iters: 100, epoch: 8 | loss: 0.5558244
	speed: 0.0059s/iter; left time: 2.4327s
	iters: 200, epoch: 8 | loss: 0.6845400
	speed: 0.0026s/iter; left time: 0.8172s
	iters: 300, epoch: 8 | loss: 0.4133898
	speed: 0.0025s/iter; left time: 0.5434s
	iters: 400, epoch: 8 | loss: 0.3640352
	speed: 0.0024s/iter; left time: 0.2779s
	iters: 500, epoch: 8 | loss: 0.7391574
	speed: 0.0025s/iter; left time: 0.0370s
Updating learning rate to 3.28558436484375e-06
Epoch: 8 cost time: 1.3332347869873047
Epoch: 8, Steps: 514 | Train Loss: 0.5513894 Vali Loss: 0.3687207 Best vali loss: 0.3626434

best validation loss 0.3626434130261127

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021828155868, 'e_layers': 4, 'learning_rate': 0.0004382860321, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2845637
	speed: 0.0114s/iter; left time: 92.8678s
	iters: 200, epoch: 1 | loss: 0.2536458
	speed: 0.0051s/iter; left time: 40.6510s
	iters: 300, epoch: 1 | loss: 1.5466442
	speed: 0.0052s/iter; left time: 40.9368s
	iters: 400, epoch: 1 | loss: 0.4485104
	speed: 0.0051s/iter; left time: 39.9331s
	iters: 500, epoch: 1 | loss: 0.4115949
	speed: 0.0049s/iter; left time: 37.9598s
	iters: 600, epoch: 1 | loss: 0.3038576
	speed: 0.0047s/iter; left time: 35.8966s
	iters: 700, epoch: 1 | loss: 0.1785203
	speed: 0.0046s/iter; left time: 34.6276s
	iters: 800, epoch: 1 | loss: 0.1873920
	speed: 0.0047s/iter; left time: 34.7291s
	iters: 900, epoch: 1 | loss: 0.6068928
	speed: 0.0047s/iter; left time: 34.1585s
	iters: 1000, epoch: 1 | loss: 0.5024672
	speed: 0.0047s/iter; left time: 34.0550s
Updating learning rate to 0.0004216047632713874
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 5.361406326293945
Epoch: 1, Steps: 1027 | Train Loss: 0.4724089 Vali Loss: 0.3717173 Best vali loss: 0.3717173
	iters: 100, epoch: 2 | loss: 0.2809178
	speed: 0.0125s/iter; left time: 88.3845s
	iters: 200, epoch: 2 | loss: 0.5949754
	speed: 0.0047s/iter; left time: 32.8195s
	iters: 300, epoch: 2 | loss: 0.4905316
	speed: 0.0047s/iter; left time: 32.4173s
	iters: 400, epoch: 2 | loss: 1.3507339
	speed: 0.0047s/iter; left time: 31.9800s
	iters: 500, epoch: 2 | loss: 0.5671707
	speed: 0.0047s/iter; left time: 31.5712s
	iters: 600, epoch: 2 | loss: 0.3857946
	speed: 0.0048s/iter; left time: 31.3755s
	iters: 700, epoch: 2 | loss: 0.3944905
	speed: 0.0048s/iter; left time: 31.2642s
	iters: 800, epoch: 2 | loss: 2.0719826
	speed: 0.0047s/iter; left time: 30.0329s
	iters: 900, epoch: 2 | loss: 0.4964430
	speed: 0.0047s/iter; left time: 29.7368s
	iters: 1000, epoch: 2 | loss: 0.3627328
	speed: 0.0047s/iter; left time: 29.3507s
Updating learning rate to 0.0003741005287486274
Epoch: 2 cost time: 4.892853260040283
Epoch: 2, Steps: 1027 | Train Loss: 0.6995773 Vali Loss: 0.3737561 Best vali loss: 0.3717173
	iters: 100, epoch: 3 | loss: 1.1034909
	speed: 0.0122s/iter; left time: 73.8745s
	iters: 200, epoch: 3 | loss: 0.6550767
	speed: 0.0044s/iter; left time: 26.4888s
	iters: 300, epoch: 3 | loss: 1.1294847
	speed: 0.0044s/iter; left time: 25.9931s
	iters: 400, epoch: 3 | loss: 0.2955230
	speed: 0.0044s/iter; left time: 25.3677s
	iters: 500, epoch: 3 | loss: 0.4310920
	speed: 0.0044s/iter; left time: 25.0310s
	iters: 600, epoch: 3 | loss: 0.3772646
	speed: 0.0044s/iter; left time: 24.5600s
	iters: 700, epoch: 3 | loss: 0.4430599
	speed: 0.0044s/iter; left time: 24.2353s
	iters: 800, epoch: 3 | loss: 0.8867912
	speed: 0.0047s/iter; left time: 25.3133s
	iters: 900, epoch: 3 | loss: 0.2438074
	speed: 0.0050s/iter; left time: 26.2012s
	iters: 1000, epoch: 3 | loss: 1.0025935
	speed: 0.0050s/iter; left time: 25.7184s
Updating learning rate to 0.00030300541761085195
Epoch: 3 cost time: 4.74527382850647
Epoch: 3, Steps: 1027 | Train Loss: 0.6568184 Vali Loss: 0.3769620 Best vali loss: 0.3717173
	iters: 100, epoch: 4 | loss: 0.3867210
	speed: 0.0123s/iter; left time: 62.1882s
	iters: 200, epoch: 4 | loss: 0.2464514
	speed: 0.0045s/iter; left time: 22.2660s
	iters: 300, epoch: 4 | loss: 0.4565215
	speed: 0.0044s/iter; left time: 21.3462s
	iters: 400, epoch: 4 | loss: 0.8314524
	speed: 0.0044s/iter; left time: 21.0558s
	iters: 500, epoch: 4 | loss: 0.6455117
	speed: 0.0044s/iter; left time: 20.4179s
	iters: 600, epoch: 4 | loss: 0.9485602
	speed: 0.0044s/iter; left time: 19.9993s
	iters: 700, epoch: 4 | loss: 0.2151111
	speed: 0.0044s/iter; left time: 19.6791s
	iters: 800, epoch: 4 | loss: 0.6810024
	speed: 0.0044s/iter; left time: 19.0824s
	iters: 900, epoch: 4 | loss: 0.4151592
	speed: 0.0044s/iter; left time: 18.6800s
	iters: 1000, epoch: 4 | loss: 0.3535599
	speed: 0.0044s/iter; left time: 18.1695s
Updating learning rate to 0.00021914301605
Epoch: 4 cost time: 4.58657431602478
Epoch: 4, Steps: 1027 | Train Loss: 0.5180051 Vali Loss: 0.3837021 Best vali loss: 0.3717173
	iters: 100, epoch: 5 | loss: 0.9147611
	speed: 0.0120s/iter; left time: 48.0083s
	iters: 200, epoch: 5 | loss: 0.3298435
	speed: 0.0044s/iter; left time: 17.2708s
	iters: 300, epoch: 5 | loss: 0.1581033
	speed: 0.0044s/iter; left time: 16.8037s
	iters: 400, epoch: 5 | loss: 0.2997430
	speed: 0.0048s/iter; left time: 17.8882s
	iters: 500, epoch: 5 | loss: 0.3377426
	speed: 0.0051s/iter; left time: 18.2352s
	iters: 600, epoch: 5 | loss: 0.4523177
	speed: 0.0050s/iter; left time: 17.7130s
	iters: 700, epoch: 5 | loss: 0.3245886
	speed: 0.0051s/iter; left time: 17.2850s
	iters: 800, epoch: 5 | loss: 0.2555272
	speed: 0.0051s/iter; left time: 16.8222s
	iters: 900, epoch: 5 | loss: 1.0451802
	speed: 0.0051s/iter; left time: 16.2083s
	iters: 1000, epoch: 5 | loss: 0.2106986
	speed: 0.0051s/iter; left time: 15.7587s
Updating learning rate to 0.00013528061448914803
Epoch: 5 cost time: 5.0164244174957275
Epoch: 5, Steps: 1027 | Train Loss: 0.4328506 Vali Loss: 0.4031829 Best vali loss: 0.3717173
	iters: 100, epoch: 6 | loss: 0.2539812
	speed: 0.0130s/iter; left time: 38.7910s
	iters: 200, epoch: 6 | loss: 0.4928042
	speed: 0.0052s/iter; left time: 14.8510s
	iters: 300, epoch: 6 | loss: 0.2038081
	speed: 0.0051s/iter; left time: 14.2539s
	iters: 400, epoch: 6 | loss: 0.4930732
	speed: 0.0051s/iter; left time: 13.6530s
	iters: 500, epoch: 6 | loss: 0.1927488
	speed: 0.0051s/iter; left time: 13.0430s
	iters: 600, epoch: 6 | loss: 0.3336266
	speed: 0.0051s/iter; left time: 12.7140s
	iters: 700, epoch: 6 | loss: 0.2448281
	speed: 0.0051s/iter; left time: 12.1686s
	iters: 800, epoch: 6 | loss: 0.4103339
	speed: 0.0051s/iter; left time: 11.6039s
	iters: 900, epoch: 6 | loss: 0.6802360
	speed: 0.0051s/iter; left time: 11.1469s
	iters: 1000, epoch: 6 | loss: 0.3466502
	speed: 0.0051s/iter; left time: 10.6545s
Updating learning rate to 6.418550335137258e-05
Epoch: 6 cost time: 5.289675951004028
Epoch: 6, Steps: 1027 | Train Loss: 0.3652090 Vali Loss: 0.3902205 Best vali loss: 0.3717173
	iters: 100, epoch: 7 | loss: 0.4844425
	speed: 0.0129s/iter; left time: 25.1786s
	iters: 200, epoch: 7 | loss: 0.1815354
	speed: 0.0051s/iter; left time: 9.5432s
	iters: 300, epoch: 7 | loss: 0.6137333
	speed: 0.0052s/iter; left time: 9.1436s
	iters: 400, epoch: 7 | loss: 0.5582308
	speed: 0.0052s/iter; left time: 8.5862s
	iters: 500, epoch: 7 | loss: 0.7874855
	speed: 0.0050s/iter; left time: 7.7929s
	iters: 600, epoch: 7 | loss: 1.3702917
	speed: 0.0048s/iter; left time: 6.9859s
	iters: 700, epoch: 7 | loss: 0.2433700
	speed: 0.0048s/iter; left time: 6.4940s
	iters: 800, epoch: 7 | loss: 0.3251770
	speed: 0.0048s/iter; left time: 6.0484s
	iters: 900, epoch: 7 | loss: 0.2329239
	speed: 0.0048s/iter; left time: 5.5490s
	iters: 1000, epoch: 7 | loss: 0.2913086
	speed: 0.0048s/iter; left time: 5.0288s
Updating learning rate to 1.6681268828612594e-05
Epoch: 7 cost time: 5.1287384033203125
Epoch: 7, Steps: 1027 | Train Loss: 0.5088499 Vali Loss: 0.4027749 Best vali loss: 0.3717173
	iters: 100, epoch: 8 | loss: 0.7769048
	speed: 0.0128s/iter; left time: 11.8811s
	iters: 200, epoch: 8 | loss: 0.2590968
	speed: 0.0049s/iter; left time: 4.0559s
	iters: 300, epoch: 8 | loss: 0.4725301
	speed: 0.0049s/iter; left time: 3.5807s
	iters: 400, epoch: 8 | loss: 0.3634662
	speed: 0.0049s/iter; left time: 3.1048s
	iters: 500, epoch: 8 | loss: 1.0805441
	speed: 0.0050s/iter; left time: 2.6356s
	iters: 600, epoch: 8 | loss: 0.3265902
	speed: 0.0051s/iter; left time: 2.1661s
	iters: 700, epoch: 8 | loss: 0.8192096
	speed: 0.0050s/iter; left time: 1.6516s
	iters: 800, epoch: 8 | loss: 0.1734741
	speed: 0.0051s/iter; left time: 1.1531s
	iters: 900, epoch: 8 | loss: 0.4568925
	speed: 0.0050s/iter; left time: 0.6462s
	iters: 1000, epoch: 8 | loss: 0.3389612
	speed: 0.0050s/iter; left time: 0.1407s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.170979261398315
Epoch: 8, Steps: 1027 | Train Loss: 0.5067670 Vali Loss: 0.4039631 Best vali loss: 0.3717173

best validation loss 0.3717172792536336

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012265013145, 'e_layers': 4, 'learning_rate': 0.0007905481807, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2254723
	speed: 0.0112s/iter; left time: 91.0314s
	iters: 200, epoch: 1 | loss: 0.3759060
	speed: 0.0052s/iter; left time: 41.3900s
	iters: 300, epoch: 1 | loss: 0.3531104
	speed: 0.0051s/iter; left time: 40.0623s
	iters: 400, epoch: 1 | loss: 0.2024763
	speed: 0.0049s/iter; left time: 38.2042s
	iters: 500, epoch: 1 | loss: 0.4465228
	speed: 0.0046s/iter; left time: 35.2020s
	iters: 600, epoch: 1 | loss: 1.5229664
	speed: 0.0044s/iter; left time: 33.3030s
	iters: 700, epoch: 1 | loss: 0.2675188
	speed: 0.0044s/iter; left time: 33.2412s
	iters: 800, epoch: 1 | loss: 0.7458023
	speed: 0.0044s/iter; left time: 32.8214s
	iters: 900, epoch: 1 | loss: 0.3590482
	speed: 0.0045s/iter; left time: 32.6845s
	iters: 1000, epoch: 1 | loss: 0.3315870
	speed: 0.0044s/iter; left time: 32.0843s
Updating learning rate to 0.0007905481807
Validation loss decreased (inf --> 0.3787).  Saving model state dict ...
Epoch: 1 cost time: 5.146737098693848
Epoch: 1, Steps: 1027 | Train Loss: 0.4830411 Vali Loss: 0.3787496 Best vali loss: 0.3787496
	iters: 100, epoch: 2 | loss: 0.8949999
	speed: 0.0121s/iter; left time: 85.6837s
	iters: 200, epoch: 2 | loss: 0.3922048
	speed: 0.0044s/iter; left time: 30.9126s
	iters: 300, epoch: 2 | loss: 0.9732599
	speed: 0.0045s/iter; left time: 30.7135s
	iters: 400, epoch: 2 | loss: 0.7986115
	speed: 0.0044s/iter; left time: 30.1702s
	iters: 500, epoch: 2 | loss: 0.3319134
	speed: 0.0044s/iter; left time: 29.5719s
	iters: 600, epoch: 2 | loss: 1.0658659
	speed: 0.0044s/iter; left time: 29.2094s
	iters: 700, epoch: 2 | loss: 0.4877852
	speed: 0.0044s/iter; left time: 28.7959s
	iters: 800, epoch: 2 | loss: 0.2920063
	speed: 0.0044s/iter; left time: 28.1846s
	iters: 900, epoch: 2 | loss: 0.3786898
	speed: 0.0044s/iter; left time: 27.8144s
	iters: 1000, epoch: 2 | loss: 0.5617379
	speed: 0.0045s/iter; left time: 27.6325s
Updating learning rate to 0.00039527409035
Epoch: 2 cost time: 4.5929224491119385
Epoch: 2, Steps: 1027 | Train Loss: 0.6177075 Vali Loss: 0.4004704 Best vali loss: 0.3787496
	iters: 100, epoch: 3 | loss: 0.4610382
	speed: 0.0120s/iter; left time: 72.9422s
	iters: 200, epoch: 3 | loss: 0.4230123
	speed: 0.0044s/iter; left time: 26.3136s
	iters: 300, epoch: 3 | loss: 1.2138939
	speed: 0.0044s/iter; left time: 25.7006s
	iters: 400, epoch: 3 | loss: 1.4972510
	speed: 0.0043s/iter; left time: 25.0476s
	iters: 500, epoch: 3 | loss: 1.7223641
	speed: 0.0044s/iter; left time: 24.7327s
	iters: 600, epoch: 3 | loss: 0.3403794
	speed: 0.0044s/iter; left time: 24.5092s
	iters: 700, epoch: 3 | loss: 0.3127074
	speed: 0.0044s/iter; left time: 23.8308s
	iters: 800, epoch: 3 | loss: 0.8970726
	speed: 0.0044s/iter; left time: 23.4444s
	iters: 900, epoch: 3 | loss: 0.4678300
	speed: 0.0043s/iter; left time: 22.7454s
	iters: 1000, epoch: 3 | loss: 0.9935677
	speed: 0.0043s/iter; left time: 22.4071s
Updating learning rate to 0.000197637045175
Epoch: 3 cost time: 4.523230791091919
Epoch: 3, Steps: 1027 | Train Loss: 0.8329117 Vali Loss: 0.3894766 Best vali loss: 0.3787496

best validation loss 0.37874958491746946

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021890961539, 'e_layers': 4, 'learning_rate': 0.0004490039289, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2852160
	speed: 0.0111s/iter; left time: 90.1450s
	iters: 200, epoch: 1 | loss: 0.2543908
	speed: 0.0051s/iter; left time: 40.8115s
	iters: 300, epoch: 1 | loss: 1.5808443
	speed: 0.0051s/iter; left time: 40.1610s
	iters: 400, epoch: 1 | loss: 0.4242815
	speed: 0.0051s/iter; left time: 40.1646s
	iters: 500, epoch: 1 | loss: 0.3220940
	speed: 0.0051s/iter; left time: 39.6300s
	iters: 600, epoch: 1 | loss: 0.2912875
	speed: 0.0051s/iter; left time: 39.0145s
	iters: 700, epoch: 1 | loss: 0.2015643
	speed: 0.0051s/iter; left time: 38.0421s
	iters: 800, epoch: 1 | loss: 0.1905214
	speed: 0.0051s/iter; left time: 37.5317s
	iters: 900, epoch: 1 | loss: 0.6302688
	speed: 0.0051s/iter; left time: 37.4808s
	iters: 1000, epoch: 1 | loss: 0.5320386
	speed: 0.0051s/iter; left time: 37.1029s
Updating learning rate to 0.0004319147344139315
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 5.575154066085815
Epoch: 1, Steps: 1027 | Train Loss: 0.4712507 Vali Loss: 0.3707728 Best vali loss: 0.3707728
	iters: 100, epoch: 2 | loss: 0.2672448
	speed: 0.0128s/iter; left time: 90.6981s
	iters: 200, epoch: 2 | loss: 0.6048113
	speed: 0.0045s/iter; left time: 31.3302s
	iters: 300, epoch: 2 | loss: 0.5875251
	speed: 0.0045s/iter; left time: 30.7905s
	iters: 400, epoch: 2 | loss: 1.3965315
	speed: 0.0045s/iter; left time: 30.3846s
	iters: 500, epoch: 2 | loss: 0.5698947
	speed: 0.0045s/iter; left time: 30.0814s
	iters: 600, epoch: 2 | loss: 0.3739395
	speed: 0.0044s/iter; left time: 29.3095s
	iters: 700, epoch: 2 | loss: 0.4056429
	speed: 0.0045s/iter; left time: 28.9322s
	iters: 800, epoch: 2 | loss: 1.7356606
	speed: 0.0045s/iter; left time: 28.7347s
	iters: 900, epoch: 2 | loss: 0.4419942
	speed: 0.0045s/iter; left time: 28.4687s
	iters: 1000, epoch: 2 | loss: 0.3355773
	speed: 0.0044s/iter; left time: 27.4764s
Updating learning rate to 0.0003832488259022962
Validation loss decreased (0.3708 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 4.644733190536499
Epoch: 2, Steps: 1027 | Train Loss: 0.6718822 Vali Loss: 0.3694268 Best vali loss: 0.3694268
	iters: 100, epoch: 3 | loss: 1.1310130
	speed: 0.0128s/iter; left time: 77.3129s
	iters: 200, epoch: 3 | loss: 0.6624829
	speed: 0.0048s/iter; left time: 28.4449s
	iters: 300, epoch: 3 | loss: 1.1931388
	speed: 0.0047s/iter; left time: 27.8468s
	iters: 400, epoch: 3 | loss: 0.2792111
	speed: 0.0046s/iter; left time: 26.2842s
	iters: 500, epoch: 3 | loss: 0.4683695
	speed: 0.0048s/iter; left time: 27.1291s
	iters: 600, epoch: 3 | loss: 0.3774403
	speed: 0.0044s/iter; left time: 24.2003s
	iters: 700, epoch: 3 | loss: 0.4159456
	speed: 0.0043s/iter; left time: 23.6401s
	iters: 800, epoch: 3 | loss: 1.0701103
	speed: 0.0046s/iter; left time: 24.7988s
	iters: 900, epoch: 3 | loss: 0.2451617
	speed: 0.0048s/iter; left time: 25.0148s
	iters: 1000, epoch: 3 | loss: 1.0990208
	speed: 0.0047s/iter; left time: 24.4607s
Updating learning rate to 0.0003104151467784314
Epoch: 3 cost time: 4.811346769332886
Epoch: 3, Steps: 1027 | Train Loss: 0.6941894 Vali Loss: 0.3813256 Best vali loss: 0.3694268

best validation loss 0.3694268134464684

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021807215398, 'e_layers': 4, 'learning_rate': 0.0004498225651, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2852477
	speed: 0.0111s/iter; left time: 90.2230s
	iters: 200, epoch: 1 | loss: 0.2544073
	speed: 0.0051s/iter; left time: 41.2001s
	iters: 300, epoch: 1 | loss: 1.5548992
	speed: 0.0052s/iter; left time: 40.8510s
	iters: 400, epoch: 1 | loss: 0.4208139
	speed: 0.0048s/iter; left time: 37.4325s
	iters: 500, epoch: 1 | loss: 0.3498459
	speed: 0.0049s/iter; left time: 38.0313s
	iters: 600, epoch: 1 | loss: 0.2971165
	speed: 0.0050s/iter; left time: 38.3093s
	iters: 700, epoch: 1 | loss: 0.1627819
	speed: 0.0050s/iter; left time: 37.9563s
	iters: 800, epoch: 1 | loss: 0.1772711
	speed: 0.0051s/iter; left time: 37.9209s
	iters: 900, epoch: 1 | loss: 0.6062507
	speed: 0.0052s/iter; left time: 37.7232s
	iters: 1000, epoch: 1 | loss: 0.4817638
	speed: 0.0052s/iter; left time: 37.1915s
Updating learning rate to 0.00043270221312880793
Validation loss decreased (inf --> 0.3785).  Saving model state dict ...
Epoch: 1 cost time: 5.538617134094238
Epoch: 1, Steps: 1027 | Train Loss: 0.4590398 Vali Loss: 0.3784789 Best vali loss: 0.3784789
	iters: 100, epoch: 2 | loss: 0.2742906
	speed: 0.0131s/iter; left time: 93.1120s
	iters: 200, epoch: 2 | loss: 0.5731620
	speed: 0.0048s/iter; left time: 33.3344s
	iters: 300, epoch: 2 | loss: 0.5229188
	speed: 0.0048s/iter; left time: 32.8459s
	iters: 400, epoch: 2 | loss: 1.2510177
	speed: 0.0047s/iter; left time: 31.8486s
	iters: 500, epoch: 2 | loss: 0.5524548
	speed: 0.0047s/iter; left time: 31.1331s
	iters: 600, epoch: 2 | loss: 0.3758624
	speed: 0.0048s/iter; left time: 31.7131s
	iters: 700, epoch: 2 | loss: 0.3870983
	speed: 0.0049s/iter; left time: 31.5884s
	iters: 800, epoch: 2 | loss: 1.8334047
	speed: 0.0048s/iter; left time: 30.8435s
	iters: 900, epoch: 2 | loss: 0.4351332
	speed: 0.0049s/iter; left time: 31.0981s
	iters: 1000, epoch: 2 | loss: 0.3990313
	speed: 0.0049s/iter; left time: 30.4835s
Updating learning rate to 0.0003839475756064686
Validation loss decreased (0.3785 --> 0.3752).  Saving model state dict ...
Epoch: 2 cost time: 4.976351976394653
Epoch: 2, Steps: 1027 | Train Loss: 0.6604374 Vali Loss: 0.3752343 Best vali loss: 0.3752343
	iters: 100, epoch: 3 | loss: 0.9668697
	speed: 0.0131s/iter; left time: 79.3367s
	iters: 200, epoch: 3 | loss: 0.6122064
	speed: 0.0050s/iter; left time: 29.5777s
	iters: 300, epoch: 3 | loss: 1.1482795
	speed: 0.0049s/iter; left time: 28.9024s
	iters: 400, epoch: 3 | loss: 0.2786295
	speed: 0.0049s/iter; left time: 28.1068s
	iters: 500, epoch: 3 | loss: 0.4939851
	speed: 0.0049s/iter; left time: 27.6524s
	iters: 600, epoch: 3 | loss: 0.3779626
	speed: 0.0049s/iter; left time: 27.0793s
	iters: 700, epoch: 3 | loss: 0.4003107
	speed: 0.0049s/iter; left time: 26.7782s
	iters: 800, epoch: 3 | loss: 0.9840585
	speed: 0.0049s/iter; left time: 26.1794s
	iters: 900, epoch: 3 | loss: 0.2322127
	speed: 0.0049s/iter; left time: 25.7371s
	iters: 1000, epoch: 3 | loss: 1.1140192
	speed: 0.0049s/iter; left time: 25.1878s
Updating learning rate to 0.0003109811041338685
Epoch: 3 cost time: 5.071342468261719
Epoch: 3, Steps: 1027 | Train Loss: 0.6608534 Vali Loss: 0.3758146 Best vali loss: 0.3752343

best validation loss 0.37523428666568226

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021890961539, 'e_layers': 4, 'learning_rate': 0.0004490039289, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2788779
	speed: 0.0114s/iter; left time: 57.3168s
	iters: 200, epoch: 4 | loss: 0.2462109
	speed: 0.0052s/iter; left time: 25.5886s
	iters: 300, epoch: 4 | loss: 1.4896461
	speed: 0.0052s/iter; left time: 25.2180s
	iters: 400, epoch: 4 | loss: 0.4224888
	speed: 0.0052s/iter; left time: 24.7199s
	iters: 500, epoch: 4 | loss: 0.3468497
	speed: 0.0052s/iter; left time: 24.1074s
	iters: 600, epoch: 4 | loss: 0.2921651
	speed: 0.0052s/iter; left time: 23.6389s
	iters: 700, epoch: 4 | loss: 0.1644775
	speed: 0.0052s/iter; left time: 23.1565s
	iters: 800, epoch: 4 | loss: 0.1737123
	speed: 0.0052s/iter; left time: 22.5851s
	iters: 900, epoch: 4 | loss: 0.4730421
	speed: 0.0052s/iter; left time: 22.1658s
	iters: 1000, epoch: 4 | loss: 0.5862632
	speed: 0.0052s/iter; left time: 21.5612s
Updating learning rate to 0.00022450196445
Epoch: 4 cost time: 5.675620794296265
Epoch: 4, Steps: 1027 | Train Loss: 0.4473734 Vali Loss: 0.3755122 Best vali loss: 0.3694268
	iters: 100, epoch: 5 | loss: 0.2789867
	speed: 0.0129s/iter; left time: 51.8448s
	iters: 200, epoch: 5 | loss: 0.5803221
	speed: 0.0050s/iter; left time: 19.7399s
	iters: 300, epoch: 5 | loss: 0.5138357
	speed: 0.0050s/iter; left time: 19.1592s
	iters: 400, epoch: 5 | loss: 0.8622945
	speed: 0.0050s/iter; left time: 18.6900s
	iters: 500, epoch: 5 | loss: 0.5017601
	speed: 0.0050s/iter; left time: 18.0955s
	iters: 600, epoch: 5 | loss: 0.3124219
	speed: 0.0050s/iter; left time: 17.6284s
	iters: 700, epoch: 5 | loss: 0.3726517
	speed: 0.0050s/iter; left time: 17.2017s
	iters: 800, epoch: 5 | loss: 1.5790260
	speed: 0.0051s/iter; left time: 16.7803s
	iters: 900, epoch: 5 | loss: 0.3665566
	speed: 0.0051s/iter; left time: 16.3935s
	iters: 1000, epoch: 5 | loss: 0.3492839
	speed: 0.0052s/iter; left time: 16.0123s
Updating learning rate to 0.00013858878212156864
Epoch: 5 cost time: 5.239155292510986
Epoch: 5, Steps: 1027 | Train Loss: 0.5717139 Vali Loss: 0.3921706 Best vali loss: 0.3694268
	iters: 100, epoch: 6 | loss: 0.7663048
	speed: 0.0131s/iter; left time: 39.2026s
	iters: 200, epoch: 6 | loss: 0.4074591
	speed: 0.0052s/iter; left time: 14.9313s
	iters: 300, epoch: 6 | loss: 0.8841158
	speed: 0.0051s/iter; left time: 14.1777s
	iters: 400, epoch: 6 | loss: 0.2351449
	speed: 0.0051s/iter; left time: 13.7906s
	iters: 500, epoch: 6 | loss: 0.4124904
	speed: 0.0045s/iter; left time: 11.6312s
	iters: 600, epoch: 6 | loss: 0.3972286
	speed: 0.0044s/iter; left time: 10.9498s
	iters: 700, epoch: 6 | loss: 0.4197573
	speed: 0.0044s/iter; left time: 10.5119s
	iters: 800, epoch: 6 | loss: 0.6712154
	speed: 0.0045s/iter; left time: 10.2379s
	iters: 900, epoch: 6 | loss: 0.1846071
	speed: 0.0045s/iter; left time: 9.8006s
	iters: 1000, epoch: 6 | loss: 0.8625821
	speed: 0.0045s/iter; left time: 9.3421s
Updating learning rate to 6.57551029977038e-05
Epoch: 6 cost time: 4.894264459609985
Epoch: 6, Steps: 1027 | Train Loss: 0.5240906 Vali Loss: 0.3969301 Best vali loss: 0.3694268
	iters: 100, epoch: 7 | loss: 0.3491484
	speed: 0.0123s/iter; left time: 24.0588s
	iters: 200, epoch: 7 | loss: 0.2297832
	speed: 0.0044s/iter; left time: 8.2159s
	iters: 300, epoch: 7 | loss: 0.4281605
	speed: 0.0045s/iter; left time: 7.8220s
	iters: 400, epoch: 7 | loss: 0.7330598
	speed: 0.0044s/iter; left time: 7.2525s
	iters: 500, epoch: 7 | loss: 0.5200360
	speed: 0.0044s/iter; left time: 6.8067s
	iters: 600, epoch: 7 | loss: 0.7651261
	speed: 0.0045s/iter; left time: 6.5747s
	iters: 700, epoch: 7 | loss: 0.2173101
	speed: 0.0043s/iter; left time: 5.8662s
	iters: 800, epoch: 7 | loss: 0.5494125
	speed: 0.0043s/iter; left time: 5.4213s
	iters: 900, epoch: 7 | loss: 0.4004285
	speed: 0.0044s/iter; left time: 5.0768s
	iters: 1000, epoch: 7 | loss: 0.3249903
	speed: 0.0044s/iter; left time: 4.6555s
Updating learning rate to 1.7089194486068487e-05
Epoch: 7 cost time: 4.5689685344696045
Epoch: 7, Steps: 1027 | Train Loss: 0.4517455 Vali Loss: 0.4034330 Best vali loss: 0.3694268
	iters: 100, epoch: 8 | loss: 0.7466243
	speed: 0.0124s/iter; left time: 11.4659s
	iters: 200, epoch: 8 | loss: 0.2965556
	speed: 0.0048s/iter; left time: 4.0134s
	iters: 300, epoch: 8 | loss: 0.1716504
	speed: 0.0047s/iter; left time: 3.4504s
	iters: 400, epoch: 8 | loss: 0.3211506
	speed: 0.0047s/iter; left time: 2.9611s
	iters: 500, epoch: 8 | loss: 0.2734466
	speed: 0.0048s/iter; left time: 2.5096s
	iters: 600, epoch: 8 | loss: 0.4556694
	speed: 0.0048s/iter; left time: 2.0396s
	iters: 700, epoch: 8 | loss: 0.2866539
	speed: 0.0048s/iter; left time: 1.5691s
	iters: 800, epoch: 8 | loss: 0.2443381
	speed: 0.0048s/iter; left time: 1.0889s
	iters: 900, epoch: 8 | loss: 1.0048579
	speed: 0.0048s/iter; left time: 0.6111s
	iters: 1000, epoch: 8 | loss: 0.1895906
	speed: 0.0048s/iter; left time: 0.1338s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.94182825088501
Epoch: 8, Steps: 1027 | Train Loss: 0.3990537 Vali Loss: 0.4122456 Best vali loss: 0.3694268

best validation loss 0.3694268134464684

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0018920004317, 'e_layers': 2, 'learning_rate': 0.0008931492229, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0099435
	speed: 0.0090s/iter; left time: 73.3124s
	iters: 200, epoch: 1 | loss: 0.4844864
	speed: 0.0031s/iter; left time: 24.6099s
	iters: 300, epoch: 1 | loss: 0.9848770
	speed: 0.0031s/iter; left time: 24.1913s
	iters: 400, epoch: 1 | loss: 0.4145338
	speed: 0.0030s/iter; left time: 23.8171s
	iters: 500, epoch: 1 | loss: 1.5949982
	speed: 0.0032s/iter; left time: 24.3305s
	iters: 600, epoch: 1 | loss: 0.4445275
	speed: 0.0033s/iter; left time: 25.0910s
	iters: 700, epoch: 1 | loss: 0.4404711
	speed: 0.0033s/iter; left time: 24.6503s
	iters: 800, epoch: 1 | loss: 0.3983296
	speed: 0.0032s/iter; left time: 23.9703s
	iters: 900, epoch: 1 | loss: 0.6008705
	speed: 0.0033s/iter; left time: 23.8759s
	iters: 1000, epoch: 1 | loss: 0.8060689
	speed: 0.0033s/iter; left time: 23.4831s
Updating learning rate to 0.0008591557547078355
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 3.591465950012207
Epoch: 1, Steps: 1027 | Train Loss: 0.7179107 Vali Loss: 0.3721547 Best vali loss: 0.3721547
	iters: 100, epoch: 2 | loss: 0.4587763
	speed: 0.0095s/iter; left time: 67.0556s
	iters: 200, epoch: 2 | loss: 0.7907589
	speed: 0.0032s/iter; left time: 22.6638s
	iters: 300, epoch: 2 | loss: 1.1087224
	speed: 0.0033s/iter; left time: 22.5495s
	iters: 400, epoch: 2 | loss: 0.6564529
	speed: 0.0033s/iter; left time: 22.1330s
	iters: 500, epoch: 2 | loss: 0.8068588
	speed: 0.0033s/iter; left time: 21.8569s
	iters: 600, epoch: 2 | loss: 1.0762472
	speed: 0.0031s/iter; left time: 20.5977s
	iters: 700, epoch: 2 | loss: 1.2708167
	speed: 0.0030s/iter; left time: 19.4861s
	iters: 800, epoch: 2 | loss: 0.3826084
	speed: 0.0031s/iter; left time: 20.0813s
	iters: 900, epoch: 2 | loss: 0.8295470
	speed: 0.0033s/iter; left time: 20.5340s
	iters: 1000, epoch: 2 | loss: 0.4898886
	speed: 0.0030s/iter; left time: 18.7328s
Updating learning rate to 0.0007623505475120426
Epoch: 2 cost time: 3.298825263977051
Epoch: 2, Steps: 1027 | Train Loss: 0.7870677 Vali Loss: 0.3725094 Best vali loss: 0.3721547
	iters: 100, epoch: 3 | loss: 0.4887170
	speed: 0.0093s/iter; left time: 56.2257s
	iters: 200, epoch: 3 | loss: 0.3632011
	speed: 0.0033s/iter; left time: 19.4876s
	iters: 300, epoch: 3 | loss: 0.3447821
	speed: 0.0033s/iter; left time: 19.2901s
	iters: 400, epoch: 3 | loss: 0.4886466
	speed: 0.0033s/iter; left time: 18.7699s
	iters: 500, epoch: 3 | loss: 0.1817244
	speed: 0.0033s/iter; left time: 18.5302s
	iters: 600, epoch: 3 | loss: 0.5135897
	speed: 0.0033s/iter; left time: 18.2318s
	iters: 700, epoch: 3 | loss: 0.4481386
	speed: 0.0033s/iter; left time: 17.8541s
	iters: 800, epoch: 3 | loss: 0.6677725
	speed: 0.0032s/iter; left time: 17.3162s
	iters: 900, epoch: 3 | loss: 0.6072616
	speed: 0.0032s/iter; left time: 17.0405s
	iters: 1000, epoch: 3 | loss: 0.1767124
	speed: 0.0033s/iter; left time: 16.7969s
Updating learning rate to 0.0006174713165667923
Validation loss decreased (0.3722 --> 0.3702).  Saving model state dict ...
Epoch: 3 cost time: 3.3875718116760254
Epoch: 3, Steps: 1027 | Train Loss: 0.4280546 Vali Loss: 0.3701831 Best vali loss: 0.3701831
	iters: 100, epoch: 4 | loss: 0.2511740
	speed: 0.0092s/iter; left time: 46.4053s
	iters: 200, epoch: 4 | loss: 1.1009271
	speed: 0.0033s/iter; left time: 16.3972s
	iters: 300, epoch: 4 | loss: 0.5870371
	speed: 0.0033s/iter; left time: 15.8113s
	iters: 400, epoch: 4 | loss: 0.3521058
	speed: 0.0033s/iter; left time: 15.5126s
	iters: 500, epoch: 4 | loss: 0.4049731
	speed: 0.0033s/iter; left time: 15.1827s
	iters: 600, epoch: 4 | loss: 0.8435241
	speed: 0.0032s/iter; left time: 14.3042s
	iters: 700, epoch: 4 | loss: 0.3723908
	speed: 0.0031s/iter; left time: 13.7216s
	iters: 800, epoch: 4 | loss: 0.4319791
	speed: 0.0032s/iter; left time: 13.8292s
	iters: 900, epoch: 4 | loss: 0.3432949
	speed: 0.0033s/iter; left time: 13.8904s
	iters: 1000, epoch: 4 | loss: 0.3717880
	speed: 0.0033s/iter; left time: 13.6874s
Updating learning rate to 0.00044657461145
Epoch: 4 cost time: 3.3721415996551514
Epoch: 4, Steps: 1027 | Train Loss: 0.5059194 Vali Loss: 0.3823280 Best vali loss: 0.3701831
	iters: 100, epoch: 5 | loss: 0.9478816
	speed: 0.0092s/iter; left time: 36.9900s
	iters: 200, epoch: 5 | loss: 0.4439446
	speed: 0.0035s/iter; left time: 13.7080s
	iters: 300, epoch: 5 | loss: 1.1443173
	speed: 0.0035s/iter; left time: 13.3679s
	iters: 400, epoch: 5 | loss: 0.4075038
	speed: 0.0035s/iter; left time: 12.9058s
	iters: 500, epoch: 5 | loss: 0.2415919
	speed: 0.0034s/iter; left time: 12.3962s
	iters: 600, epoch: 5 | loss: 0.5486029
	speed: 0.0035s/iter; left time: 12.2690s
	iters: 700, epoch: 5 | loss: 0.3714818
	speed: 0.0035s/iter; left time: 11.8345s
	iters: 800, epoch: 5 | loss: 0.5030406
	speed: 0.0033s/iter; left time: 10.8228s
	iters: 900, epoch: 5 | loss: 0.2797752
	speed: 0.0033s/iter; left time: 10.5180s
	iters: 1000, epoch: 5 | loss: 0.5281337
	speed: 0.0033s/iter; left time: 10.1679s
Updating learning rate to 0.0002756779063332077
Epoch: 5 cost time: 3.5267608165740967
Epoch: 5, Steps: 1027 | Train Loss: 0.5416273 Vali Loss: 0.4028647 Best vali loss: 0.3701831
	iters: 100, epoch: 6 | loss: 0.7903547
	speed: 0.0090s/iter; left time: 26.8724s
	iters: 200, epoch: 6 | loss: 0.2650163
	speed: 0.0031s/iter; left time: 8.8745s
	iters: 300, epoch: 6 | loss: 0.6092281
	speed: 0.0031s/iter; left time: 8.5142s
	iters: 400, epoch: 6 | loss: 0.5835111
	speed: 0.0031s/iter; left time: 8.2332s
	iters: 500, epoch: 6 | loss: 0.3057174
	speed: 0.0030s/iter; left time: 7.8197s
	iters: 600, epoch: 6 | loss: 0.2743894
	speed: 0.0030s/iter; left time: 7.5179s
	iters: 700, epoch: 6 | loss: 0.3570268
	speed: 0.0031s/iter; left time: 7.2948s
	iters: 800, epoch: 6 | loss: 0.4432626
	speed: 0.0031s/iter; left time: 7.1179s
	iters: 900, epoch: 6 | loss: 0.7685733
	speed: 0.0031s/iter; left time: 6.6879s
	iters: 1000, epoch: 6 | loss: 0.9385836
	speed: 0.0031s/iter; left time: 6.4259s
Updating learning rate to 0.0001307986753879574
Epoch: 6 cost time: 3.194152355194092
Epoch: 6, Steps: 1027 | Train Loss: 0.5335663 Vali Loss: 0.4170826 Best vali loss: 0.3701831
	iters: 100, epoch: 7 | loss: 0.6669472
	speed: 0.0089s/iter; left time: 17.4244s
	iters: 200, epoch: 7 | loss: 0.3146763
	speed: 0.0029s/iter; left time: 5.3176s
	iters: 300, epoch: 7 | loss: 0.3800437
	speed: 0.0029s/iter; left time: 5.0118s
	iters: 400, epoch: 7 | loss: 1.2835736
	speed: 0.0029s/iter; left time: 4.7343s
	iters: 500, epoch: 7 | loss: 0.4104426
	speed: 0.0029s/iter; left time: 4.4507s
	iters: 600, epoch: 7 | loss: 0.2390663
	speed: 0.0029s/iter; left time: 4.1571s
	iters: 700, epoch: 7 | loss: 0.2167790
	speed: 0.0028s/iter; left time: 3.8563s
	iters: 800, epoch: 7 | loss: 0.4470760
	speed: 0.0029s/iter; left time: 3.5779s
	iters: 900, epoch: 7 | loss: 0.2361692
	speed: 0.0029s/iter; left time: 3.3221s
	iters: 1000, epoch: 7 | loss: 0.2820328
	speed: 0.0029s/iter; left time: 3.0191s
Updating learning rate to 3.399346819216448e-05
Epoch: 7 cost time: 2.97495436668396
Epoch: 7, Steps: 1027 | Train Loss: 0.4476807 Vali Loss: 0.4131975 Best vali loss: 0.3701831
	iters: 100, epoch: 8 | loss: 0.4781489
	speed: 0.0091s/iter; left time: 8.4805s
	iters: 200, epoch: 8 | loss: 0.8476788
	speed: 0.0030s/iter; left time: 2.5150s
	iters: 300, epoch: 8 | loss: 0.3776233
	speed: 0.0030s/iter; left time: 2.2163s
	iters: 400, epoch: 8 | loss: 0.5725073
	speed: 0.0031s/iter; left time: 1.9251s
	iters: 500, epoch: 8 | loss: 0.2907016
	speed: 0.0033s/iter; left time: 1.7316s
	iters: 600, epoch: 8 | loss: 0.3323280
	speed: 0.0031s/iter; left time: 1.3117s
	iters: 700, epoch: 8 | loss: 0.3589321
	speed: 0.0031s/iter; left time: 1.0032s
	iters: 800, epoch: 8 | loss: 0.7026845
	speed: 0.0032s/iter; left time: 0.7276s
	iters: 900, epoch: 8 | loss: 0.6382360
	speed: 0.0033s/iter; left time: 0.4206s
	iters: 1000, epoch: 8 | loss: 0.4509145
	speed: 0.0033s/iter; left time: 0.0924s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2693657875061035
Epoch: 8, Steps: 1027 | Train Loss: 0.5049755 Vali Loss: 0.4087470 Best vali loss: 0.3701831

best validation loss 0.3701830745504507

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0037142071839, 'e_layers': 1, 'learning_rate': 0.0026683771777, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8521553
	speed: 0.0093s/iter; left time: 8.7205s
Updating learning rate to 0.0025668181185986316
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 0.7488369941711426
Epoch: 1, Steps: 129 | Train Loss: 0.8521553 Vali Loss: 0.3696187 Best vali loss: 0.3696187
	iters: 100, epoch: 2 | loss: 0.7216725
	speed: 0.0055s/iter; left time: 4.4328s
Updating learning rate to 0.0022776023874075454
Epoch: 2 cost time: 0.4121968746185303
Epoch: 2, Steps: 129 | Train Loss: 0.7216725 Vali Loss: 0.3799464 Best vali loss: 0.3696187
	iters: 100, epoch: 3 | loss: 0.4604971
	speed: 0.0057s/iter; left time: 3.8395s
Updating learning rate to 0.0018447604574534538
Epoch: 3 cost time: 0.4449186325073242
Epoch: 3, Steps: 129 | Train Loss: 0.4604971 Vali Loss: 0.3895574 Best vali loss: 0.3696187
	iters: 100, epoch: 4 | loss: 0.5839804
	speed: 0.0059s/iter; left time: 3.2018s
Updating learning rate to 0.00133418858885
Epoch: 4 cost time: 0.4455268383026123
Epoch: 4, Steps: 129 | Train Loss: 0.5839804 Vali Loss: 0.3703135 Best vali loss: 0.3696187
	iters: 100, epoch: 5 | loss: 0.5892375
	speed: 0.0058s/iter; left time: 2.4140s
Updating learning rate to 0.0008236167202465465
Epoch: 5 cost time: 0.4363563060760498
Epoch: 5, Steps: 129 | Train Loss: 0.5892375 Vali Loss: 0.3891395 Best vali loss: 0.3696187
	iters: 100, epoch: 6 | loss: 0.5618237
	speed: 0.0059s/iter; left time: 1.7049s
Updating learning rate to 0.0003907747902924545
Epoch: 6 cost time: 0.4534792900085449
Epoch: 6, Steps: 129 | Train Loss: 0.5618237 Vali Loss: 0.3944632 Best vali loss: 0.3696187
	iters: 100, epoch: 7 | loss: 0.4684634
	speed: 0.0057s/iter; left time: 0.9139s
Updating learning rate to 0.00010155905910136865
Epoch: 7 cost time: 0.4346280097961426
Epoch: 7, Steps: 129 | Train Loss: 0.4684634 Vali Loss: 0.3905425 Best vali loss: 0.3696187
	iters: 100, epoch: 8 | loss: 0.5567841
	speed: 0.0060s/iter; left time: 0.1803s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45792675018310547
Epoch: 8, Steps: 129 | Train Loss: 0.5567841 Vali Loss: 0.3888693 Best vali loss: 0.3696187

best validation loss 0.3696187417376018

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011533814215, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266518
	speed: 0.0094s/iter; left time: 37.8855s
	iters: 200, epoch: 1 | loss: 0.9924296
	speed: 0.0034s/iter; left time: 13.4587s
	iters: 300, epoch: 1 | loss: 0.3760199
	speed: 0.0033s/iter; left time: 12.5399s
	iters: 400, epoch: 1 | loss: 0.6703949
	speed: 0.0033s/iter; left time: 12.1981s
	iters: 500, epoch: 1 | loss: 0.4318022
	speed: 0.0034s/iter; left time: 12.1326s
Updating learning rate to 0.0003677599621661719
Validation loss decreased (inf --> 0.3566).  Saving model state dict ...
Epoch: 1 cost time: 2.0701303482055664
Epoch: 1, Steps: 514 | Train Loss: 0.5794597 Vali Loss: 0.3566387 Best vali loss: 0.3566387
	iters: 100, epoch: 2 | loss: 1.3162696
	speed: 0.0075s/iter; left time: 26.0977s
	iters: 200, epoch: 2 | loss: 0.6634859
	speed: 0.0036s/iter; left time: 12.1894s
	iters: 300, epoch: 2 | loss: 0.8008304
	speed: 0.0036s/iter; left time: 11.8280s
	iters: 400, epoch: 2 | loss: 0.3213512
	speed: 0.0036s/iter; left time: 11.4625s
	iters: 500, epoch: 2 | loss: 0.2689846
	speed: 0.0036s/iter; left time: 11.0164s
Updating learning rate to 0.000326322680112559
Epoch: 2 cost time: 1.8749101161956787
Epoch: 2, Steps: 514 | Train Loss: 0.6741843 Vali Loss: 0.3699878 Best vali loss: 0.3566387
	iters: 100, epoch: 3 | loss: 0.3739598
	speed: 0.0073s/iter; left time: 21.6881s
	iters: 200, epoch: 3 | loss: 0.3660477
	speed: 0.0032s/iter; left time: 9.3334s
	iters: 300, epoch: 3 | loss: 0.6374485
	speed: 0.0032s/iter; left time: 8.7777s
	iters: 400, epoch: 3 | loss: 1.0794607
	speed: 0.0031s/iter; left time: 8.4116s
	iters: 500, epoch: 3 | loss: 0.5740014
	speed: 0.0032s/iter; left time: 8.1595s
Updating learning rate to 0.0002643074050019267
Epoch: 3 cost time: 1.6809895038604736
Epoch: 3, Steps: 514 | Train Loss: 0.6061836 Vali Loss: 0.3584660 Best vali loss: 0.3566387

best validation loss 0.3566387476234867

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010990765793, 'e_layers': 2, 'learning_rate': 0.0003805984854, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266255
	speed: 0.0094s/iter; left time: 37.7779s
	iters: 200, epoch: 1 | loss: 0.9924591
	speed: 0.0034s/iter; left time: 13.1356s
	iters: 300, epoch: 1 | loss: 0.3762637
	speed: 0.0033s/iter; left time: 12.4139s
	iters: 400, epoch: 1 | loss: 0.6777477
	speed: 0.0032s/iter; left time: 11.8682s
	iters: 500, epoch: 1 | loss: 0.3958220
	speed: 0.0033s/iter; left time: 11.7619s
Updating learning rate to 0.0003805984854
Validation loss decreased (inf --> 0.3620).  Saving model state dict ...
Epoch: 1 cost time: 2.0384156703948975
Epoch: 1, Steps: 514 | Train Loss: 0.5737836 Vali Loss: 0.3620353 Best vali loss: 0.3620353
	iters: 100, epoch: 2 | loss: 1.2776035
	speed: 0.0072s/iter; left time: 25.1417s
	iters: 200, epoch: 2 | loss: 0.6881176
	speed: 0.0031s/iter; left time: 10.6620s
	iters: 300, epoch: 2 | loss: 0.8003107
	speed: 0.0031s/iter; left time: 10.0951s
	iters: 400, epoch: 2 | loss: 0.3169926
	speed: 0.0031s/iter; left time: 9.7678s
	iters: 500, epoch: 2 | loss: 0.2655477
	speed: 0.0033s/iter; left time: 10.2115s
Updating learning rate to 0.0001902992427
Validation loss decreased (0.3620 --> 0.3499).  Saving model state dict ...
Epoch: 2 cost time: 1.6613988876342773
Epoch: 2, Steps: 514 | Train Loss: 0.6697144 Vali Loss: 0.3499254 Best vali loss: 0.3499254
	iters: 100, epoch: 3 | loss: 0.3848943
	speed: 0.0073s/iter; left time: 21.7487s
	iters: 200, epoch: 3 | loss: 0.3422664
	speed: 0.0034s/iter; left time: 9.9305s
	iters: 300, epoch: 3 | loss: 0.6420687
	speed: 0.0033s/iter; left time: 9.1746s
	iters: 400, epoch: 3 | loss: 0.9902486
	speed: 0.0031s/iter; left time: 8.4102s
	iters: 500, epoch: 3 | loss: 0.5797534
	speed: 0.0032s/iter; left time: 8.1731s
Updating learning rate to 9.514962135e-05
Validation loss decreased (0.3499 --> 0.3461).  Saving model state dict ...
Epoch: 3 cost time: 1.7110016345977783
Epoch: 3, Steps: 514 | Train Loss: 0.5878463 Vali Loss: 0.3461276 Best vali loss: 0.3461276

best validation loss 0.34612762791000323

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012657586282, 'e_layers': 2, 'learning_rate': 0.0003808407331, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5918480
	speed: 0.0098s/iter; left time: 39.3356s
	iters: 200, epoch: 1 | loss: 0.4697821
	speed: 0.0032s/iter; left time: 12.6042s
	iters: 300, epoch: 1 | loss: 0.5579542
	speed: 0.0031s/iter; left time: 11.9192s
	iters: 400, epoch: 1 | loss: 0.4873528
	speed: 0.0033s/iter; left time: 12.3828s
	iters: 500, epoch: 1 | loss: 0.4267132
	speed: 0.0032s/iter; left time: 11.5035s
Updating learning rate to 0.00036634584577884184
Validation loss decreased (inf --> 0.3780).  Saving model state dict ...
Epoch: 1 cost time: 2.054924488067627
Epoch: 1, Steps: 514 | Train Loss: 0.5067301 Vali Loss: 0.3780486 Best vali loss: 0.3780486
	iters: 100, epoch: 2 | loss: 0.3648162
	speed: 0.0080s/iter; left time: 27.8432s
	iters: 200, epoch: 2 | loss: 0.3466224
	speed: 0.0033s/iter; left time: 11.3788s
	iters: 300, epoch: 2 | loss: 0.9522691
	speed: 0.0032s/iter; left time: 10.7185s
	iters: 400, epoch: 2 | loss: 1.0425924
	speed: 0.0033s/iter; left time: 10.7089s
	iters: 500, epoch: 2 | loss: 0.5228817
	speed: 0.0033s/iter; left time: 10.3426s
Updating learning rate to 0.000325067899013533
Validation loss decreased (0.3780 --> 0.3739).  Saving model state dict ...
Epoch: 2 cost time: 1.7903804779052734
Epoch: 2, Steps: 514 | Train Loss: 0.6458364 Vali Loss: 0.3739264 Best vali loss: 0.3739264
	iters: 100, epoch: 3 | loss: 0.6831993
	speed: 0.0077s/iter; left time: 22.9058s
	iters: 200, epoch: 3 | loss: 0.3005919
	speed: 0.0032s/iter; left time: 9.3259s
	iters: 300, epoch: 3 | loss: 0.5285035
	speed: 0.0032s/iter; left time: 8.7898s
	iters: 400, epoch: 3 | loss: 0.3700929
	speed: 0.0032s/iter; left time: 8.5541s
	iters: 500, epoch: 3 | loss: 0.5632604
	speed: 0.0031s/iter; left time: 8.0950s
Updating learning rate to 0.00026329108601357254
Validation loss decreased (0.3739 --> 0.3603).  Saving model state dict ...
Epoch: 3 cost time: 1.700099229812622
Epoch: 3, Steps: 514 | Train Loss: 0.4891296 Vali Loss: 0.3603126 Best vali loss: 0.3603126

best validation loss 0.3603126110754219

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010990765793, 'e_layers': 2, 'learning_rate': 0.0003805984854, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3072751
	speed: 0.0097s/iter; left time: 23.9206s
	iters: 200, epoch: 4 | loss: 0.8063556
	speed: 0.0035s/iter; left time: 8.4056s
	iters: 300, epoch: 4 | loss: 0.3236131
	speed: 0.0036s/iter; left time: 8.0805s
	iters: 400, epoch: 4 | loss: 0.5511265
	speed: 0.0036s/iter; left time: 7.7644s
	iters: 500, epoch: 4 | loss: 0.3497310
	speed: 0.0036s/iter; left time: 7.3802s
Updating learning rate to 4.7574810675e-05
Epoch: 4 cost time: 2.167942762374878
Epoch: 4, Steps: 514 | Train Loss: 0.4676203 Vali Loss: 0.3500340 Best vali loss: 0.3461276
	iters: 100, epoch: 5 | loss: 1.0037035
	speed: 0.0079s/iter; left time: 15.3707s
	iters: 200, epoch: 5 | loss: 0.6418204
	speed: 0.0035s/iter; left time: 6.5037s
	iters: 300, epoch: 5 | loss: 0.7261024
	speed: 0.0036s/iter; left time: 6.2877s
	iters: 400, epoch: 5 | loss: 0.2841078
	speed: 0.0035s/iter; left time: 5.7968s
	iters: 500, epoch: 5 | loss: 0.2648996
	speed: 0.0034s/iter; left time: 5.2418s
Updating learning rate to 2.37874053375e-05
Epoch: 5 cost time: 1.8540518283843994
Epoch: 5, Steps: 514 | Train Loss: 0.5841267 Vali Loss: 0.3462526 Best vali loss: 0.3461276
	iters: 100, epoch: 6 | loss: 0.3280205
	speed: 0.0076s/iter; left time: 10.9739s
	iters: 200, epoch: 6 | loss: 0.3129315
	speed: 0.0035s/iter; left time: 4.7457s
	iters: 300, epoch: 6 | loss: 0.5824149
	speed: 0.0034s/iter; left time: 4.1686s
	iters: 400, epoch: 6 | loss: 0.8476514
	speed: 0.0034s/iter; left time: 3.8487s
	iters: 500, epoch: 6 | loss: 0.5577100
	speed: 0.0034s/iter; left time: 3.4967s
Updating learning rate to 1.189370266875e-05
Validation loss decreased (0.3461 --> 0.3413).  Saving model state dict ...
Epoch: 6 cost time: 1.8215928077697754
Epoch: 6, Steps: 514 | Train Loss: 0.5257456 Vali Loss: 0.3412751 Best vali loss: 0.3412751
	iters: 100, epoch: 7 | loss: 0.4236728
	speed: 0.0077s/iter; left time: 7.1521s
	iters: 200, epoch: 7 | loss: 0.2821144
	speed: 0.0034s/iter; left time: 2.7883s
	iters: 300, epoch: 7 | loss: 0.5056309
	speed: 0.0034s/iter; left time: 2.4486s
	iters: 400, epoch: 7 | loss: 0.2790927
	speed: 0.0035s/iter; left time: 2.1872s
	iters: 500, epoch: 7 | loss: 0.8741888
	speed: 0.0036s/iter; left time: 1.9061s
Updating learning rate to 5.946851334375e-06
Epoch: 7 cost time: 1.8387112617492676
Epoch: 7, Steps: 514 | Train Loss: 0.4729399 Vali Loss: 0.3413371 Best vali loss: 0.3412751
	iters: 100, epoch: 8 | loss: 0.3919153
	speed: 0.0075s/iter; left time: 3.1143s
	iters: 200, epoch: 8 | loss: 0.4076581
	speed: 0.0032s/iter; left time: 1.0032s
	iters: 300, epoch: 8 | loss: 0.2599202
	speed: 0.0031s/iter; left time: 0.6596s
	iters: 400, epoch: 8 | loss: 0.6458443
	speed: 0.0032s/iter; left time: 0.3662s
	iters: 500, epoch: 8 | loss: 0.7560650
	speed: 0.0033s/iter; left time: 0.0489s
Updating learning rate to 2.9734256671875e-06
Epoch: 8 cost time: 1.7043535709381104
Epoch: 8, Steps: 514 | Train Loss: 0.4922806 Vali Loss: 0.3421305 Best vali loss: 0.3412751

best validation loss 0.34127512416108885

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012563106417, 'e_layers': 3, 'learning_rate': 0.0003826092031, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2914866
	speed: 0.0109s/iter; left time: 43.6937s
	iters: 200, epoch: 1 | loss: 0.6607968
	speed: 0.0045s/iter; left time: 17.5106s
	iters: 300, epoch: 1 | loss: 0.7343868
	speed: 0.0045s/iter; left time: 17.1365s
	iters: 400, epoch: 1 | loss: 0.6969013
	speed: 0.0045s/iter; left time: 16.6013s
	iters: 500, epoch: 1 | loss: 0.6199622
	speed: 0.0044s/iter; left time: 15.9781s
Updating learning rate to 0.0003826092031
Validation loss decreased (inf --> 0.3760).  Saving model state dict ...
Epoch: 1 cost time: 2.6800498962402344
Epoch: 1, Steps: 514 | Train Loss: 0.6007067 Vali Loss: 0.3760391 Best vali loss: 0.3760391
	iters: 100, epoch: 2 | loss: 0.6526141
	speed: 0.0097s/iter; left time: 33.9501s
	iters: 200, epoch: 2 | loss: 0.4278603
	speed: 0.0045s/iter; left time: 15.3871s
	iters: 300, epoch: 2 | loss: 0.3295992
	speed: 0.0043s/iter; left time: 14.2551s
	iters: 400, epoch: 2 | loss: 0.4069192
	speed: 0.0044s/iter; left time: 14.1875s
	iters: 500, epoch: 2 | loss: 0.6080335
	speed: 0.0046s/iter; left time: 14.1194s
Updating learning rate to 0.00019130460155
Epoch: 2 cost time: 2.3503544330596924
Epoch: 2, Steps: 514 | Train Loss: 0.4850053 Vali Loss: 0.3774113 Best vali loss: 0.3760391
	iters: 100, epoch: 3 | loss: 0.2881225
	speed: 0.0095s/iter; left time: 28.2921s
	iters: 200, epoch: 3 | loss: 0.2311138
	speed: 0.0046s/iter; left time: 13.1965s
	iters: 300, epoch: 3 | loss: 0.8283208
	speed: 0.0046s/iter; left time: 12.7901s
	iters: 400, epoch: 3 | loss: 0.2975156
	speed: 0.0046s/iter; left time: 12.2998s
	iters: 500, epoch: 3 | loss: 0.5546303
	speed: 0.0046s/iter; left time: 11.8426s
Updating learning rate to 9.5652300775e-05
Epoch: 3 cost time: 2.4090657234191895
Epoch: 3, Steps: 514 | Train Loss: 0.4399406 Vali Loss: 0.3786386 Best vali loss: 0.3760391
	iters: 100, epoch: 4 | loss: 1.2035902
	speed: 0.0094s/iter; left time: 23.2115s
	iters: 200, epoch: 4 | loss: 0.6668543
	speed: 0.0042s/iter; left time: 10.0615s
	iters: 300, epoch: 4 | loss: 0.7850473
	speed: 0.0044s/iter; left time: 9.9156s
	iters: 400, epoch: 4 | loss: 0.3664947
	speed: 0.0044s/iter; left time: 9.4606s
	iters: 500, epoch: 4 | loss: 1.3027153
	speed: 0.0044s/iter; left time: 9.1169s
Updating learning rate to 4.78261503875e-05
Epoch: 4 cost time: 2.281996965408325
Epoch: 4, Steps: 514 | Train Loss: 0.8649403 Vali Loss: 0.3783103 Best vali loss: 0.3760391
	iters: 100, epoch: 5 | loss: 1.5527445
	speed: 0.0095s/iter; left time: 18.6668s
	iters: 200, epoch: 5 | loss: 0.2833189
	speed: 0.0045s/iter; left time: 8.4382s
	iters: 300, epoch: 5 | loss: 0.3782821
	speed: 0.0045s/iter; left time: 7.9083s
	iters: 400, epoch: 5 | loss: 0.6483802
	speed: 0.0042s/iter; left time: 7.0204s
	iters: 500, epoch: 5 | loss: 0.3975574
	speed: 0.0042s/iter; left time: 6.4823s
Updating learning rate to 2.391307519375e-05
Epoch: 5 cost time: 2.316368579864502
Epoch: 5, Steps: 514 | Train Loss: 0.6520566 Vali Loss: 0.3765893 Best vali loss: 0.3760391
	iters: 100, epoch: 6 | loss: 0.8998377
	speed: 0.0097s/iter; left time: 13.9707s
	iters: 200, epoch: 6 | loss: 0.7365884
	speed: 0.0045s/iter; left time: 6.0069s
	iters: 300, epoch: 6 | loss: 0.4988842
	speed: 0.0045s/iter; left time: 5.5715s
	iters: 400, epoch: 6 | loss: 0.6941361
	speed: 0.0044s/iter; left time: 5.0305s
	iters: 500, epoch: 6 | loss: 0.3800298
	speed: 0.0044s/iter; left time: 4.6395s
Updating learning rate to 1.1956537596875e-05
Epoch: 6 cost time: 2.3596396446228027
Epoch: 6, Steps: 514 | Train Loss: 0.6418952 Vali Loss: 0.3812302 Best vali loss: 0.3760391
	iters: 100, epoch: 7 | loss: 1.1899552
	speed: 0.0096s/iter; left time: 8.9375s
	iters: 200, epoch: 7 | loss: 0.2944203
	speed: 0.0045s/iter; left time: 3.7619s
	iters: 300, epoch: 7 | loss: 0.3331827
	speed: 0.0044s/iter; left time: 3.2385s
	iters: 400, epoch: 7 | loss: 0.3600608
	speed: 0.0045s/iter; left time: 2.8030s
	iters: 500, epoch: 7 | loss: 0.6399683
	speed: 0.0042s/iter; left time: 2.2122s
Updating learning rate to 5.9782687984375e-06
Epoch: 7 cost time: 2.333618402481079
Epoch: 7, Steps: 514 | Train Loss: 0.5635175 Vali Loss: 0.3855028 Best vali loss: 0.3760391
	iters: 100, epoch: 8 | loss: 0.3705362
	speed: 0.0096s/iter; left time: 3.9710s
	iters: 200, epoch: 8 | loss: 0.9153748
	speed: 0.0046s/iter; left time: 1.4415s
	iters: 300, epoch: 8 | loss: 0.3679957
	speed: 0.0046s/iter; left time: 0.9885s
	iters: 400, epoch: 8 | loss: 0.5943089
	speed: 0.0046s/iter; left time: 0.5266s
	iters: 500, epoch: 8 | loss: 0.5847322
	speed: 0.0047s/iter; left time: 0.0698s
Updating learning rate to 2.98913439921875e-06
Epoch: 8 cost time: 2.4173364639282227
Epoch: 8, Steps: 514 | Train Loss: 0.5665896 Vali Loss: 0.3837243 Best vali loss: 0.3760391

best validation loss 0.3760391237254461

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011634734312, 'e_layers': 3, 'learning_rate': 0.0003833476135, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2917496
	speed: 0.0111s/iter; left time: 44.4656s
	iters: 200, epoch: 1 | loss: 0.6505589
	speed: 0.0046s/iter; left time: 18.0138s
	iters: 300, epoch: 1 | loss: 0.7686819
	speed: 0.0047s/iter; left time: 17.7337s
	iters: 400, epoch: 1 | loss: 0.7159526
	speed: 0.0046s/iter; left time: 16.9029s
	iters: 500, epoch: 1 | loss: 0.6198517
	speed: 0.0043s/iter; left time: 15.6642s
Updating learning rate to 0.0003833476135
Validation loss decreased (inf --> 0.3840).  Saving model state dict ...
Epoch: 1 cost time: 2.716892719268799
Epoch: 1, Steps: 514 | Train Loss: 0.6093590 Vali Loss: 0.3840020 Best vali loss: 0.3840020
	iters: 100, epoch: 2 | loss: 0.6450799
	speed: 0.0099s/iter; left time: 34.6300s
	iters: 200, epoch: 2 | loss: 0.4340864
	speed: 0.0045s/iter; left time: 15.1969s
	iters: 300, epoch: 2 | loss: 0.3365453
	speed: 0.0045s/iter; left time: 14.9481s
	iters: 400, epoch: 2 | loss: 0.3804041
	speed: 0.0046s/iter; left time: 14.7569s
	iters: 500, epoch: 2 | loss: 0.6523424
	speed: 0.0046s/iter; left time: 14.1357s
Updating learning rate to 0.00019167380675
Epoch: 2 cost time: 2.39839243888855
Epoch: 2, Steps: 514 | Train Loss: 0.4896916 Vali Loss: 0.4107181 Best vali loss: 0.3840020
	iters: 100, epoch: 3 | loss: 0.3176223
	speed: 0.0095s/iter; left time: 28.3418s
	iters: 200, epoch: 3 | loss: 0.2308867
	speed: 0.0042s/iter; left time: 12.1514s
	iters: 300, epoch: 3 | loss: 0.8212496
	speed: 0.0043s/iter; left time: 11.8965s
	iters: 400, epoch: 3 | loss: 0.2803705
	speed: 0.0043s/iter; left time: 11.4716s
	iters: 500, epoch: 3 | loss: 0.5223064
	speed: 0.0042s/iter; left time: 10.9268s
Updating learning rate to 9.5836903375e-05
Validation loss decreased (0.3840 --> 0.3769).  Saving model state dict ...
Epoch: 3 cost time: 2.2703542709350586
Epoch: 3, Steps: 514 | Train Loss: 0.4344871 Vali Loss: 0.3768959 Best vali loss: 0.3768959
	iters: 100, epoch: 4 | loss: 1.1639676
	speed: 0.0098s/iter; left time: 24.2377s
	iters: 200, epoch: 4 | loss: 0.5657221
	speed: 0.0044s/iter; left time: 10.3879s
	iters: 300, epoch: 4 | loss: 0.6802494
	speed: 0.0044s/iter; left time: 9.9864s
	iters: 400, epoch: 4 | loss: 0.3886419
	speed: 0.0045s/iter; left time: 9.8224s
	iters: 500, epoch: 4 | loss: 1.1445110
	speed: 0.0045s/iter; left time: 9.3563s
Updating learning rate to 4.79184516875e-05
Epoch: 4 cost time: 2.3458428382873535
Epoch: 4, Steps: 514 | Train Loss: 0.7886184 Vali Loss: 0.3994198 Best vali loss: 0.3768959
	iters: 100, epoch: 5 | loss: 1.2801213
	speed: 0.0094s/iter; left time: 18.3112s
	iters: 200, epoch: 5 | loss: 0.2622687
	speed: 0.0043s/iter; left time: 8.0376s
	iters: 300, epoch: 5 | loss: 0.3839110
	speed: 0.0044s/iter; left time: 7.7448s
	iters: 400, epoch: 5 | loss: 0.5420858
	speed: 0.0043s/iter; left time: 7.1874s
	iters: 500, epoch: 5 | loss: 0.4012894
	speed: 0.0044s/iter; left time: 6.8933s
Updating learning rate to 2.395922584375e-05
Epoch: 5 cost time: 2.3124630451202393
Epoch: 5, Steps: 514 | Train Loss: 0.5739353 Vali Loss: 0.3963193 Best vali loss: 0.3768959
	iters: 100, epoch: 6 | loss: 0.8072914
	speed: 0.0098s/iter; left time: 14.1349s
	iters: 200, epoch: 6 | loss: 0.5463431
	speed: 0.0045s/iter; left time: 6.0424s
	iters: 300, epoch: 6 | loss: 0.4618133
	speed: 0.0044s/iter; left time: 5.5199s
	iters: 400, epoch: 6 | loss: 0.6505347
	speed: 0.0043s/iter; left time: 4.9305s
	iters: 500, epoch: 6 | loss: 0.3187146
	speed: 0.0043s/iter; left time: 4.4598s
Updating learning rate to 1.1979612921875e-05
Epoch: 6 cost time: 2.3310768604278564
Epoch: 6, Steps: 514 | Train Loss: 0.5569394 Vali Loss: 0.3985284 Best vali loss: 0.3768959
	iters: 100, epoch: 7 | loss: 0.9067121
	speed: 0.0095s/iter; left time: 8.8559s
	iters: 200, epoch: 7 | loss: 0.3005419
	speed: 0.0045s/iter; left time: 3.7712s
	iters: 300, epoch: 7 | loss: 0.3342370
	speed: 0.0045s/iter; left time: 3.3026s
	iters: 400, epoch: 7 | loss: 0.3637706
	speed: 0.0044s/iter; left time: 2.7490s
	iters: 500, epoch: 7 | loss: 0.5842985
	speed: 0.0044s/iter; left time: 2.3341s
Updating learning rate to 5.9898064609375e-06
Epoch: 7 cost time: 2.369724750518799
Epoch: 7, Steps: 514 | Train Loss: 0.4979120 Vali Loss: 0.4029480 Best vali loss: 0.3768959
	iters: 100, epoch: 8 | loss: 0.3433139
	speed: 0.0095s/iter; left time: 3.9348s
	iters: 200, epoch: 8 | loss: 0.9225783
	speed: 0.0044s/iter; left time: 1.3768s
	iters: 300, epoch: 8 | loss: 0.3811198
	speed: 0.0043s/iter; left time: 0.9323s
	iters: 400, epoch: 8 | loss: 0.6011530
	speed: 0.0043s/iter; left time: 0.4914s
	iters: 500, epoch: 8 | loss: 0.5838735
	speed: 0.0042s/iter; left time: 0.0637s
Updating learning rate to 2.99490323046875e-06
Epoch: 8 cost time: 2.2932138442993164
Epoch: 8, Steps: 514 | Train Loss: 0.5664077 Vali Loss: 0.4015568 Best vali loss: 0.3768959

best validation loss 0.3768958926552171

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0047087519114, 'e_layers': 2, 'learning_rate': 0.0003799317167, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8221971
	speed: 0.0103s/iter; left time: 41.4139s
	iters: 200, epoch: 1 | loss: 0.7366158
	speed: 0.0034s/iter; left time: 13.4348s
	iters: 300, epoch: 1 | loss: 0.8264066
	speed: 0.0034s/iter; left time: 12.9266s
	iters: 400, epoch: 1 | loss: 0.6901512
	speed: 0.0035s/iter; left time: 12.9214s
	iters: 500, epoch: 1 | loss: 0.3345354
	speed: 0.0034s/iter; left time: 12.2410s
Updating learning rate to 0.0003799317167
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 2.176272392272949
Epoch: 1, Steps: 514 | Train Loss: 0.6819812 Vali Loss: 0.3693736 Best vali loss: 0.3693736
	iters: 100, epoch: 2 | loss: 0.3220711
	speed: 0.0079s/iter; left time: 27.4850s
	iters: 200, epoch: 2 | loss: 0.3746440
	speed: 0.0037s/iter; left time: 12.5605s
	iters: 300, epoch: 2 | loss: 0.6541057
	speed: 0.0037s/iter; left time: 12.1511s
	iters: 400, epoch: 2 | loss: 0.6738299
	speed: 0.0037s/iter; left time: 11.7839s
	iters: 500, epoch: 2 | loss: 0.4895755
	speed: 0.0037s/iter; left time: 11.4257s
Updating learning rate to 0.00018996585835
Validation loss decreased (0.3694 --> 0.3669).  Saving model state dict ...
Epoch: 2 cost time: 1.9326064586639404
Epoch: 2, Steps: 514 | Train Loss: 0.5028452 Vali Loss: 0.3669248 Best vali loss: 0.3669248
	iters: 100, epoch: 3 | loss: 0.4253355
	speed: 0.0081s/iter; left time: 24.1511s
	iters: 200, epoch: 3 | loss: 0.5783386
	speed: 0.0037s/iter; left time: 10.6325s
	iters: 300, epoch: 3 | loss: 0.5848711
	speed: 0.0035s/iter; left time: 9.8132s
	iters: 400, epoch: 3 | loss: 0.2489484
	speed: 0.0034s/iter; left time: 9.1795s
	iters: 500, epoch: 3 | loss: 0.6503545
	speed: 0.0034s/iter; left time: 8.8317s
Updating learning rate to 9.4982929175e-05
Validation loss decreased (0.3669 --> 0.3508).  Saving model state dict ...
Epoch: 3 cost time: 1.8820264339447021
Epoch: 3, Steps: 514 | Train Loss: 0.4975696 Vali Loss: 0.3508015 Best vali loss: 0.3508015

best validation loss 0.3508014759520885

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0017876232876, 'e_layers': 2, 'learning_rate': 0.0003936959405, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4268058
	speed: 0.0111s/iter; left time: 44.4743s
	iters: 200, epoch: 1 | loss: 1.0780162
	speed: 0.0036s/iter; left time: 14.2177s
	iters: 300, epoch: 1 | loss: 1.0149465
	speed: 0.0036s/iter; left time: 13.8844s
	iters: 400, epoch: 1 | loss: 0.5046071
	speed: 0.0036s/iter; left time: 13.3967s
	iters: 500, epoch: 1 | loss: 1.1528522
	speed: 0.0036s/iter; left time: 13.0535s
Updating learning rate to 0.0003936959405
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 2.4098153114318848
Epoch: 1, Steps: 514 | Train Loss: 0.8354455 Vali Loss: 0.3706383 Best vali loss: 0.3706383
	iters: 100, epoch: 2 | loss: 0.3918603
	speed: 0.0076s/iter; left time: 26.6149s
	iters: 200, epoch: 2 | loss: 0.3140691
	speed: 0.0036s/iter; left time: 12.2755s
	iters: 300, epoch: 2 | loss: 0.4607359
	speed: 0.0036s/iter; left time: 11.7979s
	iters: 400, epoch: 2 | loss: 0.3929479
	speed: 0.0035s/iter; left time: 11.3481s
	iters: 500, epoch: 2 | loss: 0.6187099
	speed: 0.0036s/iter; left time: 11.2030s
Updating learning rate to 0.00019684797025
Validation loss decreased (0.3706 --> 0.3581).  Saving model state dict ...
Epoch: 2 cost time: 1.8922193050384521
Epoch: 2, Steps: 514 | Train Loss: 0.4356646 Vali Loss: 0.3580834 Best vali loss: 0.3580834
	iters: 100, epoch: 3 | loss: 0.3527078
	speed: 0.0075s/iter; left time: 22.4474s
	iters: 200, epoch: 3 | loss: 0.8562002
	speed: 0.0031s/iter; left time: 8.8663s
	iters: 300, epoch: 3 | loss: 0.5029978
	speed: 0.0030s/iter; left time: 8.4029s
	iters: 400, epoch: 3 | loss: 0.5001168
	speed: 0.0030s/iter; left time: 8.1093s
	iters: 500, epoch: 3 | loss: 1.0503486
	speed: 0.0030s/iter; left time: 7.8837s
Updating learning rate to 9.8423985125e-05
Validation loss decreased (0.3581 --> 0.3483).  Saving model state dict ...
Epoch: 3 cost time: 1.6294808387756348
Epoch: 3, Steps: 514 | Train Loss: 0.6524742 Vali Loss: 0.3483377 Best vali loss: 0.3483377

best validation loss 0.34833767669374205

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0088431867213, 'e_layers': 4, 'learning_rate': 0.0003297532858, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4819288
	speed: 0.0127s/iter; left time: 24.9112s
	iters: 200, epoch: 1 | loss: 0.5678051
	speed: 0.0072s/iter; left time: 13.3761s
Updating learning rate to 0.0003297532858
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 2.205334186553955
Epoch: 1, Steps: 257 | Train Loss: 0.5248670 Vali Loss: 0.3697858 Best vali loss: 0.3697858
	iters: 100, epoch: 2 | loss: 0.5746129
	speed: 0.0150s/iter; left time: 25.5844s
	iters: 200, epoch: 2 | loss: 0.7074471
	speed: 0.0071s/iter; left time: 11.3848s
Updating learning rate to 0.0001648766429
Epoch: 2 cost time: 1.8759527206420898
Epoch: 2, Steps: 257 | Train Loss: 0.6410300 Vali Loss: 0.3841276 Best vali loss: 0.3697858
	iters: 100, epoch: 3 | loss: 0.5812210
	speed: 0.0147s/iter; left time: 21.1673s
	iters: 200, epoch: 3 | loss: 0.6026900
	speed: 0.0071s/iter; left time: 9.5827s
Updating learning rate to 8.243832145e-05
Validation loss decreased (0.3698 --> 0.3553).  Saving model state dict ...
Epoch: 3 cost time: 1.8734180927276611
Epoch: 3, Steps: 257 | Train Loss: 0.5919555 Vali Loss: 0.3553308 Best vali loss: 0.3553308

best validation loss 0.3553308321005703

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0017876232876, 'e_layers': 2, 'learning_rate': 0.0003936959405, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3709166
	speed: 0.0100s/iter; left time: 24.7917s
	iters: 200, epoch: 4 | loss: 0.9439207
	speed: 0.0036s/iter; left time: 8.4277s
	iters: 300, epoch: 4 | loss: 0.8215944
	speed: 0.0034s/iter; left time: 7.7688s
	iters: 400, epoch: 4 | loss: 0.4630948
	speed: 0.0034s/iter; left time: 7.4368s
	iters: 500, epoch: 4 | loss: 0.4508537
	speed: 0.0036s/iter; left time: 7.3526s
Updating learning rate to 4.92119925625e-05
Validation loss decreased (0.3483 --> 0.3392).  Saving model state dict ...
Epoch: 4 cost time: 2.153897762298584
Epoch: 4, Steps: 514 | Train Loss: 0.6100760 Vali Loss: 0.3391799 Best vali loss: 0.3391799
	iters: 100, epoch: 5 | loss: 0.3810644
	speed: 0.0075s/iter; left time: 14.6563s
	iters: 200, epoch: 5 | loss: 0.2447240
	speed: 0.0036s/iter; left time: 6.6299s
	iters: 300, epoch: 5 | loss: 0.3520327
	speed: 0.0036s/iter; left time: 6.2580s
	iters: 400, epoch: 5 | loss: 0.3775113
	speed: 0.0036s/iter; left time: 6.0034s
	iters: 500, epoch: 5 | loss: 0.5888489
	speed: 0.0032s/iter; left time: 5.0482s
Updating learning rate to 2.460599628125e-05
Epoch: 5 cost time: 1.8364734649658203
Epoch: 5, Steps: 514 | Train Loss: 0.3888363 Vali Loss: 0.3422487 Best vali loss: 0.3391799
	iters: 100, epoch: 6 | loss: 0.3116412
	speed: 0.0070s/iter; left time: 10.0741s
	iters: 200, epoch: 6 | loss: 0.7636722
	speed: 0.0031s/iter; left time: 4.1095s
	iters: 300, epoch: 6 | loss: 0.4456456
	speed: 0.0031s/iter; left time: 3.8656s
	iters: 400, epoch: 6 | loss: 0.4276688
	speed: 0.0031s/iter; left time: 3.5383s
	iters: 500, epoch: 6 | loss: 0.9804249
	speed: 0.0031s/iter; left time: 3.2267s
Updating learning rate to 1.2302998140625e-05
Epoch: 6 cost time: 1.6342670917510986
Epoch: 6, Steps: 514 | Train Loss: 0.5858105 Vali Loss: 0.3407466 Best vali loss: 0.3391799
	iters: 100, epoch: 7 | loss: 0.5499852
	speed: 0.0078s/iter; left time: 7.2200s
	iters: 200, epoch: 7 | loss: 0.4339360
	speed: 0.0037s/iter; left time: 3.0586s
	iters: 300, epoch: 7 | loss: 0.4487907
	speed: 0.0035s/iter; left time: 2.5610s
	iters: 400, epoch: 7 | loss: 0.6397271
	speed: 0.0034s/iter; left time: 2.1524s
	iters: 500, epoch: 7 | loss: 0.6656728
	speed: 0.0035s/iter; left time: 1.8644s
Updating learning rate to 6.1514990703125e-06
Validation loss decreased (0.3392 --> 0.3387).  Saving model state dict ...
Epoch: 7 cost time: 1.8876957893371582
Epoch: 7, Steps: 514 | Train Loss: 0.5476224 Vali Loss: 0.3386824 Best vali loss: 0.3386824
	iters: 100, epoch: 8 | loss: 0.5363991
	speed: 0.0074s/iter; left time: 3.0603s
	iters: 200, epoch: 8 | loss: 0.7115153
	speed: 0.0036s/iter; left time: 1.1280s
	iters: 300, epoch: 8 | loss: 0.4585248
	speed: 0.0035s/iter; left time: 0.7588s
	iters: 400, epoch: 8 | loss: 0.7695035
	speed: 0.0034s/iter; left time: 0.3890s
	iters: 500, epoch: 8 | loss: 0.5399913
	speed: 0.0034s/iter; left time: 0.0504s
Updating learning rate to 3.07574953515625e-06
Epoch: 8 cost time: 1.8161771297454834
Epoch: 8, Steps: 514 | Train Loss: 0.6031868 Vali Loss: 0.3401155 Best vali loss: 0.3386824

best validation loss 0.33868244340705494

[INFO][smbo.py:320] Finished 1000 trials.
{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0070373536542, 'e_layers': 3, 'learning_rate': 0.0004918650646, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3559673
	speed: 0.0109s/iter; left time: 21.3690s
	iters: 200, epoch: 1 | loss: 0.8095108
	speed: 0.0045s/iter; left time: 8.4218s
Updating learning rate to 0.0004918650646
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.530540943145752
Epoch: 1, Steps: 257 | Train Loss: 0.5827391 Vali Loss: 0.3733609 Best vali loss: 0.3733609
	iters: 100, epoch: 2 | loss: 0.6764199
	speed: 0.0097s/iter; left time: 16.4107s
	iters: 200, epoch: 2 | loss: 0.6940946
	speed: 0.0045s/iter; left time: 7.2589s
Updating learning rate to 0.0002459325323
Validation loss decreased (0.3734 --> 0.3689).  Saving model state dict ...
Epoch: 2 cost time: 1.2110450267791748
Epoch: 2, Steps: 257 | Train Loss: 0.6852572 Vali Loss: 0.3689257 Best vali loss: 0.3689257
	iters: 100, epoch: 3 | loss: 0.7281511
	speed: 0.0095s/iter; left time: 13.6672s
	iters: 200, epoch: 3 | loss: 0.6497543
	speed: 0.0041s/iter; left time: 5.4393s
Updating learning rate to 0.00012296626615
Epoch: 3 cost time: 1.1282384395599365
Epoch: 3, Steps: 257 | Train Loss: 0.6889527 Vali Loss: 0.3693348 Best vali loss: 0.3689257
	iters: 100, epoch: 4 | loss: 0.5153903
	speed: 0.0091s/iter; left time: 10.7679s
	iters: 200, epoch: 4 | loss: 0.4386659
	speed: 0.0043s/iter; left time: 4.6226s
Updating learning rate to 6.1483133075e-05
Validation loss decreased (0.3689 --> 0.3668).  Saving model state dict ...
Epoch: 4 cost time: 1.1382968425750732
Epoch: 4, Steps: 257 | Train Loss: 0.4770281 Vali Loss: 0.3667610 Best vali loss: 0.3667610
	iters: 100, epoch: 5 | loss: 0.6313764
	speed: 0.0100s/iter; left time: 9.2974s
	iters: 200, epoch: 5 | loss: 0.4874340
	speed: 0.0046s/iter; left time: 3.8063s
Updating learning rate to 3.07415665375e-05
Validation loss decreased (0.3668 --> 0.3664).  Saving model state dict ...
Epoch: 5 cost time: 1.2086193561553955
Epoch: 5, Steps: 257 | Train Loss: 0.5594052 Vali Loss: 0.3664189 Best vali loss: 0.3664189
	iters: 100, epoch: 6 | loss: 0.4995096
	speed: 0.0092s/iter; left time: 6.1547s
	iters: 200, epoch: 6 | loss: 0.6648757
	speed: 0.0042s/iter; left time: 2.4202s
Updating learning rate to 1.537078326875e-05
Epoch: 6 cost time: 1.1357498168945312
Epoch: 6, Steps: 257 | Train Loss: 0.5821927 Vali Loss: 0.3667271 Best vali loss: 0.3664189
	iters: 100, epoch: 7 | loss: 0.5837253
	speed: 0.0094s/iter; left time: 3.9203s
	iters: 200, epoch: 7 | loss: 0.7568012
	speed: 0.0045s/iter; left time: 1.4083s
Updating learning rate to 7.685391634375e-06
Epoch: 7 cost time: 1.188096523284912
Epoch: 7, Steps: 257 | Train Loss: 0.6702633 Vali Loss: 0.3678862 Best vali loss: 0.3664189
	iters: 100, epoch: 8 | loss: 0.6497527
	speed: 0.0095s/iter; left time: 1.5022s
	iters: 200, epoch: 8 | loss: 0.6838316
	speed: 0.0048s/iter; left time: 0.2755s
Updating learning rate to 3.8426958171875e-06
Epoch: 8 cost time: 1.2382915019989014
Epoch: 8, Steps: 257 | Train Loss: 0.6667921 Vali Loss: 0.3680183 Best vali loss: 0.3664189

best validation loss 0.36641894844754036

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0079173963017, 'e_layers': 4, 'learning_rate': 0.0003267139735, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4817210
	speed: 0.0136s/iter; left time: 26.6466s
	iters: 200, epoch: 1 | loss: 0.5671620
	speed: 0.0071s/iter; left time: 13.2226s
Updating learning rate to 0.0003267139735
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 2.197540044784546
Epoch: 1, Steps: 257 | Train Loss: 0.5244415 Vali Loss: 0.3653798 Best vali loss: 0.3653798
	iters: 100, epoch: 2 | loss: 0.5237802
	speed: 0.0150s/iter; left time: 25.5532s
	iters: 200, epoch: 2 | loss: 0.6816737
	speed: 0.0071s/iter; left time: 11.3097s
Updating learning rate to 0.00016335698675
Epoch: 2 cost time: 1.8762695789337158
Epoch: 2, Steps: 257 | Train Loss: 0.6027269 Vali Loss: 0.3965884 Best vali loss: 0.3653798
	iters: 100, epoch: 3 | loss: 0.6067628
	speed: 0.0146s/iter; left time: 21.0050s
	iters: 200, epoch: 3 | loss: 0.6313322
	speed: 0.0071s/iter; left time: 9.4807s
Updating learning rate to 8.1678493375e-05
Validation loss decreased (0.3654 --> 0.3491).  Saving model state dict ...
Epoch: 3 cost time: 1.8585984706878662
Epoch: 3, Steps: 257 | Train Loss: 0.6190475 Vali Loss: 0.3490981 Best vali loss: 0.3490981
	iters: 100, epoch: 4 | loss: 0.3532300
	speed: 0.0151s/iter; left time: 17.9446s
	iters: 200, epoch: 4 | loss: 0.5975906
	speed: 0.0071s/iter; left time: 7.6608s
Updating learning rate to 4.08392466875e-05
Validation loss decreased (0.3491 --> 0.3454).  Saving model state dict ...
Epoch: 4 cost time: 1.851485013961792
Epoch: 4, Steps: 257 | Train Loss: 0.4754103 Vali Loss: 0.3454372 Best vali loss: 0.3454372
	iters: 100, epoch: 5 | loss: 0.4506298
	speed: 0.0152s/iter; left time: 14.0876s
	iters: 200, epoch: 5 | loss: 0.4128737
	speed: 0.0071s/iter; left time: 5.8814s
Updating learning rate to 2.041962334375e-05
Epoch: 5 cost time: 1.862795114517212
Epoch: 5, Steps: 257 | Train Loss: 0.4317518 Vali Loss: 0.3476482 Best vali loss: 0.3454372
	iters: 100, epoch: 6 | loss: 0.5118229
	speed: 0.0146s/iter; left time: 9.8410s
	iters: 200, epoch: 6 | loss: 0.2976629
	speed: 0.0071s/iter; left time: 4.0798s
Updating learning rate to 1.0209811671875e-05
Epoch: 6 cost time: 1.8731305599212646
Epoch: 6, Steps: 257 | Train Loss: 0.4047429 Vali Loss: 0.3515150 Best vali loss: 0.3454372
	iters: 100, epoch: 7 | loss: 0.2753493
	speed: 0.0146s/iter; left time: 6.0753s
	iters: 200, epoch: 7 | loss: 0.3853888
	speed: 0.0071s/iter; left time: 2.2325s
Updating learning rate to 5.1049058359375e-06
Epoch: 7 cost time: 1.8767504692077637
Epoch: 7, Steps: 257 | Train Loss: 0.3303691 Vali Loss: 0.3483506 Best vali loss: 0.3454372
	iters: 100, epoch: 8 | loss: 0.2959208
	speed: 0.0146s/iter; left time: 2.3006s
	iters: 200, epoch: 8 | loss: 0.6153260
	speed: 0.0071s/iter; left time: 0.4125s
Updating learning rate to 2.55245291796875e-06
Epoch: 8 cost time: 1.8667237758636475
Epoch: 8, Steps: 257 | Train Loss: 0.4556234 Vali Loss: 0.3508924 Best vali loss: 0.3454372

best validation loss 0.3454372204240038

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0085142035405, 'e_layers': 4, 'learning_rate': 0.0003273472666, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4815156
	speed: 0.0135s/iter; left time: 26.4767s
	iters: 200, epoch: 1 | loss: 0.5643220
	speed: 0.0073s/iter; left time: 13.4951s
Updating learning rate to 0.0003273472666
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 2.2144720554351807
Epoch: 1, Steps: 257 | Train Loss: 0.5229188 Vali Loss: 0.3664930 Best vali loss: 0.3664930
	iters: 100, epoch: 2 | loss: 0.5625499
	speed: 0.0152s/iter; left time: 25.7659s
	iters: 200, epoch: 2 | loss: 0.7534067
	speed: 0.0072s/iter; left time: 11.5336s
Updating learning rate to 0.0001636736333
Epoch: 2 cost time: 1.8869404792785645
Epoch: 2, Steps: 257 | Train Loss: 0.6579783 Vali Loss: 0.3851522 Best vali loss: 0.3664930
	iters: 100, epoch: 3 | loss: 0.6364663
	speed: 0.0146s/iter; left time: 21.1322s
	iters: 200, epoch: 3 | loss: 0.6652133
	speed: 0.0071s/iter; left time: 9.5764s
Updating learning rate to 8.183681665e-05
Epoch: 3 cost time: 1.8688578605651855
Epoch: 3, Steps: 257 | Train Loss: 0.6508398 Vali Loss: 0.3765881 Best vali loss: 0.3664930

best validation loss 0.3664929613031901

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0015686483623, 'e_layers': 3, 'learning_rate': 0.0008794921301, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2723037
	speed: 0.0105s/iter; left time: 85.1482s
	iters: 200, epoch: 1 | loss: 0.9024864
	speed: 0.0042s/iter; left time: 33.5178s
	iters: 300, epoch: 1 | loss: 0.8320851
	speed: 0.0042s/iter; left time: 33.2185s
	iters: 400, epoch: 1 | loss: 0.3578199
	speed: 0.0042s/iter; left time: 32.6134s
	iters: 500, epoch: 1 | loss: 0.2963387
	speed: 0.0041s/iter; left time: 31.3510s
	iters: 600, epoch: 1 | loss: 0.3635606
	speed: 0.0040s/iter; left time: 30.7774s
	iters: 700, epoch: 1 | loss: 0.5619016
	speed: 0.0041s/iter; left time: 30.8087s
	iters: 800, epoch: 1 | loss: 1.0644751
	speed: 0.0040s/iter; left time: 29.8134s
	iters: 900, epoch: 1 | loss: 1.0499135
	speed: 0.0041s/iter; left time: 29.7185s
	iters: 1000, epoch: 1 | loss: 0.3160806
	speed: 0.0040s/iter; left time: 29.0949s
Updating learning rate to 0.0008460184540520718
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 4.557492256164551
Epoch: 1, Steps: 1027 | Train Loss: 0.6016965 Vali Loss: 0.3693757 Best vali loss: 0.3693757
	iters: 100, epoch: 2 | loss: 0.9685740
	speed: 0.0107s/iter; left time: 76.1632s
	iters: 200, epoch: 2 | loss: 0.3494894
	speed: 0.0038s/iter; left time: 26.2710s
	iters: 300, epoch: 2 | loss: 0.9312442
	speed: 0.0038s/iter; left time: 26.4085s
	iters: 400, epoch: 2 | loss: 0.3272173
	speed: 0.0039s/iter; left time: 26.2841s
	iters: 500, epoch: 2 | loss: 0.2481029
	speed: 0.0038s/iter; left time: 25.2219s
	iters: 600, epoch: 2 | loss: 0.4151726
	speed: 0.0038s/iter; left time: 25.1954s
	iters: 700, epoch: 2 | loss: 1.0078061
	speed: 0.0038s/iter; left time: 24.5525s
	iters: 800, epoch: 2 | loss: 0.3004951
	speed: 0.0038s/iter; left time: 24.0506s
	iters: 900, epoch: 2 | loss: 0.5034364
	speed: 0.0039s/iter; left time: 24.3308s
	iters: 1000, epoch: 2 | loss: 0.5199498
	speed: 0.0039s/iter; left time: 24.0244s
Updating learning rate to 0.0007506934896469556
Validation loss decreased (0.3694 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 3.9580841064453125
Epoch: 2, Steps: 1027 | Train Loss: 0.5571488 Vali Loss: 0.3668287 Best vali loss: 0.3668287
	iters: 100, epoch: 3 | loss: 0.6460122
	speed: 0.0111s/iter; left time: 67.4812s
	iters: 200, epoch: 3 | loss: 0.3157453
	speed: 0.0042s/iter; left time: 25.0125s
	iters: 300, epoch: 3 | loss: 1.1989361
	speed: 0.0040s/iter; left time: 23.7386s
	iters: 400, epoch: 3 | loss: 0.4801196
	speed: 0.0041s/iter; left time: 23.4790s
	iters: 500, epoch: 3 | loss: 0.6690016
	speed: 0.0041s/iter; left time: 23.4037s
	iters: 600, epoch: 3 | loss: 0.5241997
	speed: 0.0041s/iter; left time: 22.7315s
	iters: 700, epoch: 3 | loss: 0.6060243
	speed: 0.0042s/iter; left time: 22.7467s
	iters: 800, epoch: 3 | loss: 1.2470452
	speed: 0.0042s/iter; left time: 22.3903s
	iters: 900, epoch: 3 | loss: 0.9709070
	speed: 0.0042s/iter; left time: 21.8931s
	iters: 1000, epoch: 3 | loss: 0.4228019
	speed: 0.0042s/iter; left time: 21.5170s
Updating learning rate to 0.000608029598592376
Epoch: 3 cost time: 4.295414924621582
Epoch: 3, Steps: 1027 | Train Loss: 0.7080793 Vali Loss: 0.3826286 Best vali loss: 0.3668287

best validation loss 0.366828660822102

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.004300865732, 'e_layers': 2, 'learning_rate': 7.91725163e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6684275
	speed: 0.0119s/iter; left time: 11.1373s
Updating learning rate to 7.615919182349313e-05
Validation loss decreased (inf --> 0.3656).  Saving model state dict ...
Epoch: 1 cost time: 1.0576066970825195
Epoch: 1, Steps: 129 | Train Loss: 0.6684275 Vali Loss: 0.3656031 Best vali loss: 0.3656031
	iters: 100, epoch: 2 | loss: 0.4321752
	speed: 0.0092s/iter; left time: 7.4028s
Updating learning rate to 6.757796972966623e-05
Epoch: 2 cost time: 0.7267599105834961
Epoch: 2, Steps: 129 | Train Loss: 0.4321752 Vali Loss: 0.3677935 Best vali loss: 0.3656031
	iters: 100, epoch: 3 | loss: 0.4386157
	speed: 0.0089s/iter; left time: 6.0154s
Updating learning rate to 5.4735263293332514e-05
Validation loss decreased (0.3656 --> 0.3572).  Saving model state dict ...
Epoch: 3 cost time: 0.7200450897216797
Epoch: 3, Steps: 129 | Train Loss: 0.4386157 Vali Loss: 0.3571897 Best vali loss: 0.3571897

best validation loss 0.3571897060791495

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.004300865732, 'e_layers': 2, 'learning_rate': 7.91725163e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6977403
	speed: 0.0120s/iter; left time: 6.5517s
Updating learning rate to 3.958625815e-05
Epoch: 4 cost time: 1.0466015338897705
Epoch: 4, Steps: 129 | Train Loss: 0.6977403 Vali Loss: 0.3586528 Best vali loss: 0.3571897
	iters: 100, epoch: 5 | loss: 0.4007075
	speed: 0.0091s/iter; left time: 3.7745s
Updating learning rate to 2.4437253006667496e-05
Epoch: 5 cost time: 0.725977897644043
Epoch: 5, Steps: 129 | Train Loss: 0.4007075 Vali Loss: 0.3650748 Best vali loss: 0.3571897
	iters: 100, epoch: 6 | loss: 0.4043922
	speed: 0.0089s/iter; left time: 2.5621s
Updating learning rate to 1.159454657033377e-05
Epoch: 6 cost time: 0.7216124534606934
Epoch: 6, Steps: 129 | Train Loss: 0.4043922 Vali Loss: 0.3578275 Best vali loss: 0.3571897
	iters: 100, epoch: 7 | loss: 0.4104409
	speed: 0.0088s/iter; left time: 1.3946s
Updating learning rate to 3.0133244765068856e-06
Epoch: 7 cost time: 0.7122251987457275
Epoch: 7, Steps: 129 | Train Loss: 0.4104409 Vali Loss: 0.3684320 Best vali loss: 0.3571897
	iters: 100, epoch: 8 | loss: 0.5299727
	speed: 0.0088s/iter; left time: 0.2645s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7164535522460938
Epoch: 8, Steps: 129 | Train Loss: 0.5299727 Vali Loss: 0.3655043 Best vali loss: 0.3571897

best validation loss 0.3571897060791495

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0028866365306, 'e_layers': 4, 'learning_rate': 0.0003940566095, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5081965
	speed: 0.0133s/iter; left time: 26.0167s
	iters: 200, epoch: 1 | loss: 0.5697058
	speed: 0.0071s/iter; left time: 13.1304s
Updating learning rate to 0.0003940566095
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 2.1778793334960938
Epoch: 1, Steps: 257 | Train Loss: 0.5389512 Vali Loss: 0.3703228 Best vali loss: 0.3703228
	iters: 100, epoch: 2 | loss: 0.9920554
	speed: 0.0152s/iter; left time: 25.7877s
	iters: 200, epoch: 2 | loss: 0.7842205
	speed: 0.0072s/iter; left time: 11.5610s
Updating learning rate to 0.00019702830475
Epoch: 2 cost time: 1.89884352684021
Epoch: 2, Steps: 257 | Train Loss: 0.8881379 Vali Loss: 0.3943331 Best vali loss: 0.3703228
	iters: 100, epoch: 3 | loss: 0.5716172
	speed: 0.0149s/iter; left time: 21.4820s
	iters: 200, epoch: 3 | loss: 0.5834815
	speed: 0.0073s/iter; left time: 9.7603s
Updating learning rate to 9.8514152375e-05
Epoch: 3 cost time: 1.9052681922912598
Epoch: 3, Steps: 257 | Train Loss: 0.5775493 Vali Loss: 0.3782348 Best vali loss: 0.3703228
	iters: 100, epoch: 4 | loss: 0.6633878
	speed: 0.0146s/iter; left time: 17.3400s
	iters: 200, epoch: 4 | loss: 1.0064677
	speed: 0.0071s/iter; left time: 7.6991s
Updating learning rate to 4.92570761875e-05
Epoch: 4 cost time: 1.863696813583374
Epoch: 4, Steps: 257 | Train Loss: 0.8349277 Vali Loss: 0.3731308 Best vali loss: 0.3703228
	iters: 100, epoch: 5 | loss: 0.3425126
	speed: 0.0146s/iter; left time: 13.5966s
	iters: 200, epoch: 5 | loss: 0.5079635
	speed: 0.0073s/iter; left time: 6.0500s
Updating learning rate to 2.462853809375e-05
Epoch: 5 cost time: 1.909742832183838
Epoch: 5, Steps: 257 | Train Loss: 0.4252381 Vali Loss: 0.3810728 Best vali loss: 0.3703228
	iters: 100, epoch: 6 | loss: 0.7028905
	speed: 0.0147s/iter; left time: 9.9040s
	iters: 200, epoch: 6 | loss: 0.6722291
	speed: 0.0072s/iter; left time: 4.1282s
Updating learning rate to 1.2314269046875e-05
Epoch: 6 cost time: 1.8973698616027832
Epoch: 6, Steps: 257 | Train Loss: 0.6875598 Vali Loss: 0.3739556 Best vali loss: 0.3703228
	iters: 100, epoch: 7 | loss: 0.4058302
	speed: 0.0147s/iter; left time: 6.1204s
	iters: 200, epoch: 7 | loss: 0.7046446
	speed: 0.0073s/iter; left time: 2.2851s
Updating learning rate to 6.1571345234375e-06
Epoch: 7 cost time: 1.8973312377929688
Epoch: 7, Steps: 257 | Train Loss: 0.5552374 Vali Loss: 0.3746833 Best vali loss: 0.3703228
	iters: 100, epoch: 8 | loss: 0.8324584
	speed: 0.0148s/iter; left time: 2.3333s
	iters: 200, epoch: 8 | loss: 0.4465120
	speed: 0.0072s/iter; left time: 0.4199s
Updating learning rate to 3.07856726171875e-06
Epoch: 8 cost time: 1.8941771984100342
Epoch: 8, Steps: 257 | Train Loss: 0.6394852 Vali Loss: 0.3754158 Best vali loss: 0.3703228

best validation loss 0.37032276292446786

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0032866721615, 'e_layers': 4, 'learning_rate': 0.0027768837152, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027768837152
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 0.7157220840454102
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695266 Best vali loss: 0.3695266
Updating learning rate to 0.0013884418576
Epoch: 2 cost time: 0.4662942886352539
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3787953 Best vali loss: 0.3695266
Updating learning rate to 0.0006942209288
Epoch: 3 cost time: 0.4656360149383545
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3719232 Best vali loss: 0.3695266
Updating learning rate to 0.0003471104644
Epoch: 4 cost time: 0.45452404022216797
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3750097 Best vali loss: 0.3695266
Updating learning rate to 0.0001735552322
Epoch: 5 cost time: 0.43062901496887207
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3773508 Best vali loss: 0.3695266
Updating learning rate to 8.67776161e-05
Epoch: 6 cost time: 0.42226719856262207
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3781967 Best vali loss: 0.3695266
Updating learning rate to 4.338880805e-05
Epoch: 7 cost time: 0.4621438980102539
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3791676 Best vali loss: 0.3695266
Updating learning rate to 2.1694404025e-05
Epoch: 8 cost time: 0.45670533180236816
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3788461 Best vali loss: 0.3695266

best validation loss 0.3695266373382336

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001701111683, 'e_layers': 2, 'learning_rate': 0.0003902431452, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266449
	speed: 0.0096s/iter; left time: 38.5573s
	iters: 200, epoch: 1 | loss: 1.0776287
	speed: 0.0033s/iter; left time: 13.0686s
	iters: 300, epoch: 1 | loss: 1.0149274
	speed: 0.0033s/iter; left time: 12.6570s
	iters: 400, epoch: 1 | loss: 0.5034926
	speed: 0.0032s/iter; left time: 11.9053s
	iters: 500, epoch: 1 | loss: 1.1542606
	speed: 0.0031s/iter; left time: 11.3697s
Updating learning rate to 0.0003902431452
Validation loss decreased (inf --> 0.3731).  Saving model state dict ...
Epoch: 1 cost time: 2.043944835662842
Epoch: 1, Steps: 514 | Train Loss: 0.8353909 Vali Loss: 0.3731308 Best vali loss: 0.3731308
	iters: 100, epoch: 2 | loss: 0.3932742
	speed: 0.0076s/iter; left time: 26.5674s
	iters: 200, epoch: 2 | loss: 0.2714973
	speed: 0.0036s/iter; left time: 12.0889s
	iters: 300, epoch: 2 | loss: 0.4895561
	speed: 0.0033s/iter; left time: 10.9024s
	iters: 400, epoch: 2 | loss: 0.3940279
	speed: 0.0033s/iter; left time: 10.7099s
	iters: 500, epoch: 2 | loss: 0.6184593
	speed: 0.0034s/iter; left time: 10.5022s
Updating learning rate to 0.0001951215726
Validation loss decreased (0.3731 --> 0.3730).  Saving model state dict ...
Epoch: 2 cost time: 1.8105766773223877
Epoch: 2, Steps: 514 | Train Loss: 0.4333630 Vali Loss: 0.3730338 Best vali loss: 0.3730338
	iters: 100, epoch: 3 | loss: 0.3684012
	speed: 0.0076s/iter; left time: 22.6939s
	iters: 200, epoch: 3 | loss: 0.8852653
	speed: 0.0037s/iter; left time: 10.5627s
	iters: 300, epoch: 3 | loss: 0.4972220
	speed: 0.0034s/iter; left time: 9.4035s
	iters: 400, epoch: 3 | loss: 0.4832146
	speed: 0.0034s/iter; left time: 9.2465s
	iters: 500, epoch: 3 | loss: 1.1423299
	speed: 0.0035s/iter; left time: 8.9390s
Updating learning rate to 9.75607863e-05
Validation loss decreased (0.3730 --> 0.3500).  Saving model state dict ...
Epoch: 3 cost time: 1.8510634899139404
Epoch: 3, Steps: 514 | Train Loss: 0.6752866 Vali Loss: 0.3500073 Best vali loss: 0.3500073

best validation loss 0.35000729949628906

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001658267726, 'e_layers': 2, 'learning_rate': 0.0003900269104, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266539
	speed: 0.0098s/iter; left time: 39.1455s
	iters: 200, epoch: 1 | loss: 1.0775841
	speed: 0.0037s/iter; left time: 14.4787s
	iters: 300, epoch: 1 | loss: 1.0147778
	speed: 0.0038s/iter; left time: 14.4429s
	iters: 400, epoch: 1 | loss: 0.5040381
	speed: 0.0035s/iter; left time: 12.9550s
	iters: 500, epoch: 1 | loss: 1.1332865
	speed: 0.0035s/iter; left time: 12.7887s
Updating learning rate to 0.0003900269104
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.2143805027008057
Epoch: 1, Steps: 514 | Train Loss: 0.8312681 Vali Loss: 0.3747904 Best vali loss: 0.3747904
	iters: 100, epoch: 2 | loss: 0.3891560
	speed: 0.0074s/iter; left time: 25.7717s
	iters: 200, epoch: 2 | loss: 0.2695618
	speed: 0.0034s/iter; left time: 11.4723s
	iters: 300, epoch: 2 | loss: 0.5314583
	speed: 0.0034s/iter; left time: 11.0753s
	iters: 400, epoch: 2 | loss: 0.3881690
	speed: 0.0034s/iter; left time: 10.8669s
	iters: 500, epoch: 2 | loss: 0.6206893
	speed: 0.0034s/iter; left time: 10.6758s
Updating learning rate to 0.0001950134552
Validation loss decreased (0.3748 --> 0.3699).  Saving model state dict ...
Epoch: 2 cost time: 1.7909388542175293
Epoch: 2, Steps: 514 | Train Loss: 0.4398069 Vali Loss: 0.3698723 Best vali loss: 0.3698723
	iters: 100, epoch: 3 | loss: 0.3985390
	speed: 0.0073s/iter; left time: 21.7408s
	iters: 200, epoch: 3 | loss: 0.8349081
	speed: 0.0031s/iter; left time: 9.0482s
	iters: 300, epoch: 3 | loss: 0.5137058
	speed: 0.0032s/iter; left time: 8.8151s
	iters: 400, epoch: 3 | loss: 0.4680627
	speed: 0.0031s/iter; left time: 8.4453s
	iters: 500, epoch: 3 | loss: 1.1382093
	speed: 0.0031s/iter; left time: 8.0155s
Updating learning rate to 9.75067276e-05
Validation loss decreased (0.3699 --> 0.3519).  Saving model state dict ...
Epoch: 3 cost time: 1.662933111190796
Epoch: 3, Steps: 514 | Train Loss: 0.6706850 Vali Loss: 0.3519426 Best vali loss: 0.3519426

best validation loss 0.3519425684904537

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017247838282, 'e_layers': 1, 'learning_rate': 0.0049967495679, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5179056
	speed: 0.0086s/iter; left time: 69.4944s
	iters: 200, epoch: 1 | loss: 1.3272229
	speed: 0.0023s/iter; left time: 18.2946s
	iters: 300, epoch: 1 | loss: 0.3523550
	speed: 0.0023s/iter; left time: 18.3364s
	iters: 400, epoch: 1 | loss: 1.1643608
	speed: 0.0023s/iter; left time: 17.6574s
	iters: 500, epoch: 1 | loss: 0.3299047
	speed: 0.0022s/iter; left time: 17.3621s
	iters: 600, epoch: 1 | loss: 1.4156215
	speed: 0.0022s/iter; left time: 17.0435s
	iters: 700, epoch: 1 | loss: 1.0756991
	speed: 0.0023s/iter; left time: 17.1341s
	iters: 800, epoch: 1 | loss: 0.9701950
	speed: 0.0023s/iter; left time: 16.8507s
	iters: 900, epoch: 1 | loss: 0.5806150
	speed: 0.0023s/iter; left time: 16.6808s
	iters: 1000, epoch: 1 | loss: 0.3573205
	speed: 0.0022s/iter; left time: 16.1906s
Updating learning rate to 0.004806572111383712
Validation loss decreased (inf --> 0.3880).  Saving model state dict ...
Epoch: 1 cost time: 2.692298412322998
Epoch: 1, Steps: 1027 | Train Loss: 0.8091200 Vali Loss: 0.3880232 Best vali loss: 0.3880232
	iters: 100, epoch: 2 | loss: 0.9305991
	speed: 0.0074s/iter; left time: 52.5893s
	iters: 200, epoch: 2 | loss: 0.6240125
	speed: 0.0021s/iter; left time: 14.7608s
	iters: 300, epoch: 2 | loss: 0.5242774
	speed: 0.0021s/iter; left time: 14.5961s
	iters: 400, epoch: 2 | loss: 0.9563271
	speed: 0.0021s/iter; left time: 14.4001s
	iters: 500, epoch: 2 | loss: 0.9100072
	speed: 0.0021s/iter; left time: 14.1844s
	iters: 600, epoch: 2 | loss: 0.8981267
	speed: 0.0021s/iter; left time: 13.7573s
	iters: 700, epoch: 2 | loss: 0.5807383
	speed: 0.0021s/iter; left time: 13.4914s
	iters: 800, epoch: 2 | loss: 0.4318288
	speed: 0.0021s/iter; left time: 13.6366s
	iters: 900, epoch: 2 | loss: 1.2452292
	speed: 0.0021s/iter; left time: 13.1975s
	iters: 1000, epoch: 2 | loss: 0.5109772
	speed: 0.0021s/iter; left time: 12.6932s
Updating learning rate to 0.00426499253562652
Validation loss decreased (0.3880 --> 0.3831).  Saving model state dict ...
Epoch: 2 cost time: 2.1983988285064697
Epoch: 2, Steps: 1027 | Train Loss: 0.7612124 Vali Loss: 0.3831132 Best vali loss: 0.3831132
	iters: 100, epoch: 3 | loss: 1.0331861
	speed: 0.0070s/iter; left time: 42.5317s
	iters: 200, epoch: 3 | loss: 0.7360904
	speed: 0.0020s/iter; left time: 11.9399s
	iters: 300, epoch: 3 | loss: 0.4456072
	speed: 0.0020s/iter; left time: 11.7096s
	iters: 400, epoch: 3 | loss: 0.3683207
	speed: 0.0021s/iter; left time: 11.9055s
	iters: 500, epoch: 3 | loss: 0.2599355
	speed: 0.0021s/iter; left time: 11.7828s
	iters: 600, epoch: 3 | loss: 0.7348764
	speed: 0.0021s/iter; left time: 11.7391s
	iters: 700, epoch: 3 | loss: 0.6111934
	speed: 0.0021s/iter; left time: 11.5874s
	iters: 800, epoch: 3 | loss: 0.3670039
	speed: 0.0022s/iter; left time: 12.0449s
	iters: 900, epoch: 3 | loss: 0.2476436
	speed: 0.0023s/iter; left time: 12.2228s
	iters: 1000, epoch: 3 | loss: 0.3817045
	speed: 0.0024s/iter; left time: 12.3858s
Updating learning rate to 0.0034544614216063755
Validation loss decreased (0.3831 --> 0.3670).  Saving model state dict ...
Epoch: 3 cost time: 2.240569591522217
Epoch: 3, Steps: 1027 | Train Loss: 0.5185562 Vali Loss: 0.3670133 Best vali loss: 0.3670133

best validation loss 0.36701327759648117

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001701111683, 'e_layers': 2, 'learning_rate': 0.0003902431452, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3509598
	speed: 0.0096s/iter; left time: 23.7918s
	iters: 200, epoch: 4 | loss: 0.9495574
	speed: 0.0033s/iter; left time: 7.8993s
	iters: 300, epoch: 4 | loss: 0.7654356
	speed: 0.0033s/iter; left time: 7.5017s
	iters: 400, epoch: 4 | loss: 0.4729880
	speed: 0.0033s/iter; left time: 7.1616s
	iters: 500, epoch: 4 | loss: 0.4489384
	speed: 0.0034s/iter; left time: 6.9886s
Updating learning rate to 4.878039315e-05
Validation loss decreased (0.3500 --> 0.3451).  Saving model state dict ...
Epoch: 4 cost time: 2.0709543228149414
Epoch: 4, Steps: 514 | Train Loss: 0.5975758 Vali Loss: 0.3450712 Best vali loss: 0.3450712
	iters: 100, epoch: 5 | loss: 0.3901590
	speed: 0.0073s/iter; left time: 14.2970s
	iters: 200, epoch: 5 | loss: 0.2265685
	speed: 0.0033s/iter; left time: 6.0567s
	iters: 300, epoch: 5 | loss: 0.3593886
	speed: 0.0032s/iter; left time: 5.5675s
	iters: 400, epoch: 5 | loss: 0.3718049
	speed: 0.0032s/iter; left time: 5.2516s
	iters: 500, epoch: 5 | loss: 0.5858526
	speed: 0.0032s/iter; left time: 5.0231s
Updating learning rate to 2.4390196575e-05
Epoch: 5 cost time: 1.701167106628418
Epoch: 5, Steps: 514 | Train Loss: 0.3867547 Vali Loss: 0.3459335 Best vali loss: 0.3450712
	iters: 100, epoch: 6 | loss: 0.3134553
	speed: 0.0075s/iter; left time: 10.7569s
	iters: 200, epoch: 6 | loss: 0.7369875
	speed: 0.0032s/iter; left time: 4.3336s
	iters: 300, epoch: 6 | loss: 0.4688931
	speed: 0.0032s/iter; left time: 4.0230s
	iters: 400, epoch: 6 | loss: 0.4401618
	speed: 0.0033s/iter; left time: 3.7395s
	iters: 500, epoch: 6 | loss: 1.0024713
	speed: 0.0032s/iter; left time: 3.3376s
Updating learning rate to 1.21950982875e-05
Validation loss decreased (0.3451 --> 0.3435).  Saving model state dict ...
Epoch: 6 cost time: 1.6988234519958496
Epoch: 6, Steps: 514 | Train Loss: 0.5923938 Vali Loss: 0.3434649 Best vali loss: 0.3434649
	iters: 100, epoch: 7 | loss: 0.5436458
	speed: 0.0071s/iter; left time: 6.6238s
	iters: 200, epoch: 7 | loss: 0.4519081
	speed: 0.0034s/iter; left time: 2.8456s
	iters: 300, epoch: 7 | loss: 0.4389989
	speed: 0.0032s/iter; left time: 2.3186s
	iters: 400, epoch: 7 | loss: 0.6362257
	speed: 0.0032s/iter; left time: 2.0137s
	iters: 500, epoch: 7 | loss: 0.6605412
	speed: 0.0034s/iter; left time: 1.7819s
Updating learning rate to 6.09754914375e-06
Validation loss decreased (0.3435 --> 0.3433).  Saving model state dict ...
Epoch: 7 cost time: 1.7254743576049805
Epoch: 7, Steps: 514 | Train Loss: 0.5462640 Vali Loss: 0.3433296 Best vali loss: 0.3433296
	iters: 100, epoch: 8 | loss: 0.5419149
	speed: 0.0073s/iter; left time: 3.0371s
	iters: 200, epoch: 8 | loss: 0.6963220
	speed: 0.0033s/iter; left time: 1.0486s
	iters: 300, epoch: 8 | loss: 0.4469531
	speed: 0.0033s/iter; left time: 0.7183s
	iters: 400, epoch: 8 | loss: 0.7209262
	speed: 0.0032s/iter; left time: 0.3707s
	iters: 500, epoch: 8 | loss: 0.5471032
	speed: 0.0033s/iter; left time: 0.0490s
Updating learning rate to 3.048774571875e-06
Epoch: 8 cost time: 1.7280423641204834
Epoch: 8, Steps: 514 | Train Loss: 0.5906439 Vali Loss: 0.3433624 Best vali loss: 0.3433296

best validation loss 0.34332958654242557

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0016736366862, 'e_layers': 2, 'learning_rate': 0.0003909786884, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4266630
	speed: 0.0096s/iter; left time: 38.6722s
	iters: 200, epoch: 1 | loss: 1.0776870
	speed: 0.0035s/iter; left time: 13.8219s
	iters: 300, epoch: 1 | loss: 1.0147361
	speed: 0.0036s/iter; left time: 13.6665s
	iters: 400, epoch: 1 | loss: 0.5035386
	speed: 0.0035s/iter; left time: 13.1565s
	iters: 500, epoch: 1 | loss: 1.1167073
	speed: 0.0035s/iter; left time: 12.6372s
Updating learning rate to 0.0003909786884
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.16377329826355
Epoch: 1, Steps: 514 | Train Loss: 0.8278664 Vali Loss: 0.3748103 Best vali loss: 0.3748103
	iters: 100, epoch: 2 | loss: 0.3898590
	speed: 0.0073s/iter; left time: 25.6614s
	iters: 200, epoch: 2 | loss: 0.2640348
	speed: 0.0035s/iter; left time: 11.8387s
	iters: 300, epoch: 2 | loss: 0.5087265
	speed: 0.0034s/iter; left time: 11.1082s
	iters: 400, epoch: 2 | loss: 0.3997382
	speed: 0.0033s/iter; left time: 10.6013s
	iters: 500, epoch: 2 | loss: 0.6209378
	speed: 0.0035s/iter; left time: 10.7497s
Updating learning rate to 0.0001954893442
Validation loss decreased (0.3748 --> 0.3739).  Saving model state dict ...
Epoch: 2 cost time: 1.7985341548919678
Epoch: 2, Steps: 514 | Train Loss: 0.4366593 Vali Loss: 0.3739457 Best vali loss: 0.3739457
	iters: 100, epoch: 3 | loss: 0.4271582
	speed: 0.0075s/iter; left time: 22.5250s
	iters: 200, epoch: 3 | loss: 0.8888697
	speed: 0.0032s/iter; left time: 9.3105s
	iters: 300, epoch: 3 | loss: 0.5396180
	speed: 0.0032s/iter; left time: 8.8537s
	iters: 400, epoch: 3 | loss: 0.4463521
	speed: 0.0031s/iter; left time: 8.4034s
	iters: 500, epoch: 3 | loss: 1.1681631
	speed: 0.0033s/iter; left time: 8.4067s
Updating learning rate to 9.77446721e-05
Validation loss decreased (0.3739 --> 0.3708).  Saving model state dict ...
Epoch: 3 cost time: 1.7011988162994385
Epoch: 3, Steps: 514 | Train Loss: 0.6940322 Vali Loss: 0.3707814 Best vali loss: 0.3707814
	iters: 100, epoch: 4 | loss: 0.5646639
	speed: 0.0075s/iter; left time: 18.5179s
	iters: 200, epoch: 4 | loss: 0.4555402
	speed: 0.0033s/iter; left time: 7.7590s
	iters: 300, epoch: 4 | loss: 0.5608063
	speed: 0.0033s/iter; left time: 7.4959s
	iters: 400, epoch: 4 | loss: 0.7363095
	speed: 0.0033s/iter; left time: 7.0722s
	iters: 500, epoch: 4 | loss: 0.7447343
	speed: 0.0032s/iter; left time: 6.7146s
Updating learning rate to 4.887233605e-05
Validation loss decreased (0.3708 --> 0.3569).  Saving model state dict ...
Epoch: 4 cost time: 1.722609519958496
Epoch: 4, Steps: 514 | Train Loss: 0.6124109 Vali Loss: 0.3568819 Best vali loss: 0.3568819
	iters: 100, epoch: 5 | loss: 0.5576195
	speed: 0.0075s/iter; left time: 14.6820s
	iters: 200, epoch: 5 | loss: 0.7783067
	speed: 0.0032s/iter; left time: 5.9004s
	iters: 300, epoch: 5 | loss: 0.4822404
	speed: 0.0032s/iter; left time: 5.5959s
	iters: 400, epoch: 5 | loss: 0.8680351
	speed: 0.0032s/iter; left time: 5.3062s
	iters: 500, epoch: 5 | loss: 0.5923046
	speed: 0.0032s/iter; left time: 5.0466s
Updating learning rate to 2.4436168025e-05
Epoch: 5 cost time: 1.6883869171142578
Epoch: 5, Steps: 514 | Train Loss: 0.6557012 Vali Loss: 0.3650903 Best vali loss: 0.3568819
	iters: 100, epoch: 6 | loss: 0.2896523
	speed: 0.0072s/iter; left time: 10.3662s
	iters: 200, epoch: 6 | loss: 0.4739446
	speed: 0.0032s/iter; left time: 4.3339s
	iters: 300, epoch: 6 | loss: 0.3701818
	speed: 0.0033s/iter; left time: 4.0423s
	iters: 400, epoch: 6 | loss: 0.7584688
	speed: 0.0032s/iter; left time: 3.6784s
	iters: 500, epoch: 6 | loss: 1.0227835
	speed: 0.0035s/iter; left time: 3.6359s
Updating learning rate to 1.22180840125e-05
Epoch: 6 cost time: 1.7281494140625
Epoch: 6, Steps: 514 | Train Loss: 0.5830062 Vali Loss: 0.3598339 Best vali loss: 0.3568819
	iters: 100, epoch: 7 | loss: 0.4066156
	speed: 0.0072s/iter; left time: 6.6696s
	iters: 200, epoch: 7 | loss: 0.3034596
	speed: 0.0032s/iter; left time: 2.6429s
	iters: 300, epoch: 7 | loss: 0.3646875
	speed: 0.0033s/iter; left time: 2.4415s
	iters: 400, epoch: 7 | loss: 0.4067394
	speed: 0.0032s/iter; left time: 2.0124s
	iters: 500, epoch: 7 | loss: 0.8302974
	speed: 0.0033s/iter; left time: 1.7291s
Updating learning rate to 6.10904200625e-06
Epoch: 7 cost time: 1.7177906036376953
Epoch: 7, Steps: 514 | Train Loss: 0.4623599 Vali Loss: 0.3591819 Best vali loss: 0.3568819
	iters: 100, epoch: 8 | loss: 0.3742034
	speed: 0.0073s/iter; left time: 3.0201s
	iters: 200, epoch: 8 | loss: 0.2282928
	speed: 0.0035s/iter; left time: 1.0927s
	iters: 300, epoch: 8 | loss: 0.4021735
	speed: 0.0035s/iter; left time: 0.7538s
	iters: 400, epoch: 8 | loss: 0.4543487
	speed: 0.0032s/iter; left time: 0.3731s
	iters: 500, epoch: 8 | loss: 0.2685114
	speed: 0.0033s/iter; left time: 0.0490s
Updating learning rate to 3.054521003125e-06
Epoch: 8 cost time: 1.7669119834899902
Epoch: 8, Steps: 514 | Train Loss: 0.3455060 Vali Loss: 0.3587747 Best vali loss: 0.3568819

best validation loss 0.35688185762094377

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0020710907528, 'e_layers': 1, 'learning_rate': 0.0006862775721, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006862775721
Validation loss decreased (inf --> 0.3877).  Saving model state dict ...
Epoch: 1 cost time: 0.6166291236877441
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3877356 Best vali loss: 0.3877356
Updating learning rate to 0.00034313878605
Validation loss decreased (0.3877 --> 0.3722).  Saving model state dict ...
Epoch: 2 cost time: 0.3440670967102051
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3721627 Best vali loss: 0.3721627
Updating learning rate to 0.000171569393025
Validation loss decreased (0.3722 --> 0.3685).  Saving model state dict ...
Epoch: 3 cost time: 0.31194567680358887
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3685467 Best vali loss: 0.3685467
Updating learning rate to 8.57846965125e-05
Validation loss decreased (0.3685 --> 0.3674).  Saving model state dict ...
Epoch: 4 cost time: 0.2912302017211914
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3673997 Best vali loss: 0.3673997
Updating learning rate to 4.289234825625e-05
Validation loss decreased (0.3674 --> 0.3668).  Saving model state dict ...
Epoch: 5 cost time: 0.308168888092041
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3667634 Best vali loss: 0.3667634
Updating learning rate to 2.1446174128125e-05
Validation loss decreased (0.3668 --> 0.3666).  Saving model state dict ...
Epoch: 6 cost time: 0.32993483543395996
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3666087 Best vali loss: 0.3666087
Updating learning rate to 1.07230870640625e-05
Validation loss decreased (0.3666 --> 0.3666).  Saving model state dict ...
Epoch: 7 cost time: 0.3230888843536377
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3665681 Best vali loss: 0.3665681
Updating learning rate to 5.36154353203125e-06
Validation loss decreased (0.3666 --> 0.3665).  Saving model state dict ...
Epoch: 8 cost time: 0.3086085319519043
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3665338 Best vali loss: 0.3665338

best validation loss 0.36653375712265435

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017301351012, 'e_layers': 4, 'learning_rate': 0.0002751999423, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4192043
	speed: 0.0113s/iter; left time: 22.0971s
	iters: 200, epoch: 1 | loss: 0.6318412
	speed: 0.0054s/iter; left time: 10.0202s
Updating learning rate to 0.00026472576816962854
Validation loss decreased (inf --> 0.3595).  Saving model state dict ...
Epoch: 1 cost time: 1.7175538539886475
Epoch: 1, Steps: 257 | Train Loss: 0.5255228 Vali Loss: 0.3595323 Best vali loss: 0.3595323
	iters: 100, epoch: 2 | loss: 0.5570281
	speed: 0.0109s/iter; left time: 18.5546s
	iters: 200, epoch: 2 | loss: 0.5019250
	speed: 0.0051s/iter; left time: 8.2218s
Updating learning rate to 0.0002348978438412383
Validation loss decreased (0.3595 --> 0.3566).  Saving model state dict ...
Epoch: 2 cost time: 1.3615481853485107
Epoch: 2, Steps: 257 | Train Loss: 0.5294766 Vali Loss: 0.3566341 Best vali loss: 0.3566341
	iters: 100, epoch: 3 | loss: 0.4873615
	speed: 0.0115s/iter; left time: 16.5898s
	iters: 200, epoch: 3 | loss: 0.3302887
	speed: 0.0055s/iter; left time: 7.3652s
Updating learning rate to 0.00019025720040301937
Epoch: 3 cost time: 1.4538013935089111
Epoch: 3, Steps: 257 | Train Loss: 0.4088251 Vali Loss: 0.3616040 Best vali loss: 0.3566341

best validation loss 0.3566340963240925

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.00167660758, 'e_layers': 2, 'learning_rate': 0.0003821593084, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4265238
	speed: 0.0096s/iter; left time: 38.5882s
	iters: 200, epoch: 1 | loss: 1.0772394
	speed: 0.0035s/iter; left time: 13.7361s
	iters: 300, epoch: 1 | loss: 1.0151849
	speed: 0.0035s/iter; left time: 13.1858s
	iters: 400, epoch: 1 | loss: 0.5047476
	speed: 0.0033s/iter; left time: 12.3152s
	iters: 500, epoch: 1 | loss: 1.1529235
	speed: 0.0033s/iter; left time: 11.8948s
Updating learning rate to 0.0003821593084
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 2.0970587730407715
Epoch: 1, Steps: 514 | Train Loss: 0.8353238 Vali Loss: 0.3751312 Best vali loss: 0.3751312
	iters: 100, epoch: 2 | loss: 0.3888899
	speed: 0.0068s/iter; left time: 23.6884s
	iters: 200, epoch: 2 | loss: 0.2575192
	speed: 0.0032s/iter; left time: 10.8068s
	iters: 300, epoch: 2 | loss: 0.4620615
	speed: 0.0030s/iter; left time: 10.0367s
	iters: 400, epoch: 2 | loss: 0.3942247
	speed: 0.0031s/iter; left time: 9.8920s
	iters: 500, epoch: 2 | loss: 0.6492207
	speed: 0.0030s/iter; left time: 9.4280s
Updating learning rate to 0.0001910796542
Validation loss decreased (0.3751 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 1.6209359169006348
Epoch: 2, Steps: 514 | Train Loss: 0.4303832 Vali Loss: 0.3620178 Best vali loss: 0.3620178
	iters: 100, epoch: 3 | loss: 0.3678786
	speed: 0.0075s/iter; left time: 22.4348s
	iters: 200, epoch: 3 | loss: 0.8976222
	speed: 0.0034s/iter; left time: 9.8757s
	iters: 300, epoch: 3 | loss: 0.4947942
	speed: 0.0034s/iter; left time: 9.5985s
	iters: 400, epoch: 3 | loss: 0.4515152
	speed: 0.0034s/iter; left time: 9.0141s
	iters: 500, epoch: 3 | loss: 1.0590048
	speed: 0.0034s/iter; left time: 8.6712s
Updating learning rate to 9.55398271e-05
Epoch: 3 cost time: 1.8079333305358887
Epoch: 3, Steps: 514 | Train Loss: 0.6541630 Vali Loss: 0.3663097 Best vali loss: 0.3620178

best validation loss 0.3620178218089293

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0007046619701, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006778423708072352
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.0847587585449219
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710039 Best vali loss: 0.3710039
Updating learning rate to 0.0006014666138009911
Epoch: 2 cost time: 0.7735762596130371
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3882424 Best vali loss: 0.3710039
Updating learning rate to 0.00048716221573750715
Epoch: 3 cost time: 0.7816128730773926
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3711426 Best vali loss: 0.3710039

best validation loss 0.3710039257534829

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017301351012, 'e_layers': 4, 'learning_rate': 0.0002751999423, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3516327
	speed: 0.0117s/iter; left time: 13.8850s
	iters: 200, epoch: 4 | loss: 0.3918116
	speed: 0.0053s/iter; left time: 5.7948s
Updating learning rate to 0.00013759997115
Epoch: 4 cost time: 1.7140533924102783
Epoch: 4, Steps: 257 | Train Loss: 0.3717222 Vali Loss: 0.3803984 Best vali loss: 0.3566341
	iters: 100, epoch: 5 | loss: 0.3791580
	speed: 0.0107s/iter; left time: 9.9246s
	iters: 200, epoch: 5 | loss: 0.3625517
	speed: 0.0050s/iter; left time: 4.1417s
Updating learning rate to 8.494274189698069e-05
Epoch: 5 cost time: 1.3296504020690918
Epoch: 5, Steps: 257 | Train Loss: 0.3708548 Vali Loss: 0.3937434 Best vali loss: 0.3566341
	iters: 100, epoch: 6 | loss: 0.3494152
	speed: 0.0110s/iter; left time: 7.3807s
	iters: 200, epoch: 6 | loss: 0.2567479
	speed: 0.0055s/iter; left time: 3.1305s
Updating learning rate to 4.030209845876171e-05
Epoch: 6 cost time: 1.4532334804534912
Epoch: 6, Steps: 257 | Train Loss: 0.3030815 Vali Loss: 0.4046567 Best vali loss: 0.3566341
	iters: 100, epoch: 7 | loss: 0.4019414
	speed: 0.0113s/iter; left time: 4.7026s
	iters: 200, epoch: 7 | loss: 0.4562522
	speed: 0.0054s/iter; left time: 1.6920s
Updating learning rate to 1.0474174130371458e-05
Epoch: 7 cost time: 1.427363395690918
Epoch: 7, Steps: 257 | Train Loss: 0.4290968 Vali Loss: 0.4071613 Best vali loss: 0.3566341
	iters: 100, epoch: 8 | loss: 0.4091741
	speed: 0.0110s/iter; left time: 1.7313s
	iters: 200, epoch: 8 | loss: 0.2496432
	speed: 0.0055s/iter; left time: 0.3191s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4199638366699219
Epoch: 8, Steps: 257 | Train Loss: 0.3294087 Vali Loss: 0.4106718 Best vali loss: 0.3566341

best validation loss 0.3566340963240925

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.010979620423, 'e_layers': 4, 'learning_rate': 0.0003751286685, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00036085118369268073
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 0.7608997821807861
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3705445 Best vali loss: 0.3705445
Updating learning rate to 0.0003201923469069152
Validation loss decreased (0.3705 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 0.4703242778778076
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3642223 Best vali loss: 0.3642223
Updating learning rate to 0.00025934209747006297
Epoch: 3 cost time: 0.47412610054016113
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3644502 Best vali loss: 0.3642223
Updating learning rate to 0.00018756433425
Validation loss decreased (0.3642 --> 0.3632).  Saving model state dict ...
Epoch: 4 cost time: 0.4691650867462158
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3632317 Best vali loss: 0.3632317
Updating learning rate to 0.00011578657102993705
Validation loss decreased (0.3632 --> 0.3624).  Saving model state dict ...
Epoch: 5 cost time: 0.48722314834594727
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3623761 Best vali loss: 0.3623761
Updating learning rate to 5.49363215930848e-05
Validation loss decreased (0.3624 --> 0.3582).  Saving model state dict ...
Epoch: 6 cost time: 0.4192826747894287
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3582071 Best vali loss: 0.3582071
Updating learning rate to 1.4277484807319272e-05
Epoch: 7 cost time: 0.43538713455200195
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3621211 Best vali loss: 0.3582071
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43214893341064453
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3612987 Best vali loss: 0.3582071

best validation loss 0.35820714111178237

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0023666987475, 'e_layers': 1, 'learning_rate': 0.0049478014508, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7266387
	speed: 0.0094s/iter; left time: 8.7392s
Updating learning rate to 0.0049478014508
Validation loss decreased (inf --> 0.4028).  Saving model state dict ...
Epoch: 1 cost time: 0.7529540061950684
Epoch: 1, Steps: 129 | Train Loss: 0.7266387 Vali Loss: 0.4027891 Best vali loss: 0.4027891
	iters: 100, epoch: 2 | loss: 0.6515375
	speed: 0.0059s/iter; left time: 4.7349s
Updating learning rate to 0.0024739007254
Validation loss decreased (0.4028 --> 0.3881).  Saving model state dict ...
Epoch: 2 cost time: 0.4198267459869385
Epoch: 2, Steps: 129 | Train Loss: 0.6515375 Vali Loss: 0.3881206 Best vali loss: 0.3881206
	iters: 100, epoch: 3 | loss: 0.5093171
	speed: 0.0058s/iter; left time: 3.9166s
Updating learning rate to 0.0012369503627
Epoch: 3 cost time: 0.4150261878967285
Epoch: 3, Steps: 129 | Train Loss: 0.5093171 Vali Loss: 0.4009895 Best vali loss: 0.3881206
	iters: 100, epoch: 4 | loss: 0.5513959
	speed: 0.0056s/iter; left time: 3.0843s
Updating learning rate to 0.00061847518135
Epoch: 4 cost time: 0.4231753349304199
Epoch: 4, Steps: 129 | Train Loss: 0.5513959 Vali Loss: 0.4051091 Best vali loss: 0.3881206
	iters: 100, epoch: 5 | loss: 0.6259820
	speed: 0.0055s/iter; left time: 2.3142s
Updating learning rate to 0.000309237590675
Epoch: 5 cost time: 0.41547608375549316
Epoch: 5, Steps: 129 | Train Loss: 0.6259820 Vali Loss: 0.4330435 Best vali loss: 0.3881206
	iters: 100, epoch: 6 | loss: 0.5874431
	speed: 0.0056s/iter; left time: 1.6098s
Updating learning rate to 0.0001546187953375
Epoch: 6 cost time: 0.4094557762145996
Epoch: 6, Steps: 129 | Train Loss: 0.5874431 Vali Loss: 0.4644422 Best vali loss: 0.3881206
	iters: 100, epoch: 7 | loss: 0.6590587
	speed: 0.0058s/iter; left time: 0.9173s
Updating learning rate to 7.730939766875e-05
Epoch: 7 cost time: 0.43792104721069336
Epoch: 7, Steps: 129 | Train Loss: 0.6590587 Vali Loss: 0.4609738 Best vali loss: 0.3881206
	iters: 100, epoch: 8 | loss: 0.4648872
	speed: 0.0059s/iter; left time: 0.1762s
Updating learning rate to 3.8654698834375e-05
Epoch: 8 cost time: 0.42221951484680176
Epoch: 8, Steps: 129 | Train Loss: 0.4648872 Vali Loss: 0.4714993 Best vali loss: 0.3881206

best validation loss 0.38812059243676233

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018318580204, 'e_layers': 2, 'learning_rate': 0.0003977955532, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4268922
	speed: 0.0096s/iter; left time: 38.3856s
	iters: 200, epoch: 1 | loss: 1.0781798
	speed: 0.0034s/iter; left time: 13.2719s
	iters: 300, epoch: 1 | loss: 1.0144832
	speed: 0.0034s/iter; left time: 13.0096s
	iters: 400, epoch: 1 | loss: 0.5045519
	speed: 0.0034s/iter; left time: 12.5286s
	iters: 500, epoch: 1 | loss: 1.1523613
	speed: 0.0031s/iter; left time: 11.1290s
Updating learning rate to 0.0003977955532
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 2.063164234161377
Epoch: 1, Steps: 514 | Train Loss: 0.8352937 Vali Loss: 0.3729411 Best vali loss: 0.3729411
	iters: 100, epoch: 2 | loss: 0.3887617
	speed: 0.0073s/iter; left time: 25.4160s
	iters: 200, epoch: 2 | loss: 0.2590071
	speed: 0.0032s/iter; left time: 11.0296s
	iters: 300, epoch: 2 | loss: 0.4816388
	speed: 0.0032s/iter; left time: 10.4589s
	iters: 400, epoch: 2 | loss: 0.3873902
	speed: 0.0031s/iter; left time: 10.0261s
	iters: 500, epoch: 2 | loss: 0.6209472
	speed: 0.0031s/iter; left time: 9.6998s
Updating learning rate to 0.0001988977766
Validation loss decreased (0.3729 --> 0.3653).  Saving model state dict ...
Epoch: 2 cost time: 1.6831316947937012
Epoch: 2, Steps: 514 | Train Loss: 0.4275490 Vali Loss: 0.3653107 Best vali loss: 0.3653107
	iters: 100, epoch: 3 | loss: 0.3635837
	speed: 0.0070s/iter; left time: 20.9435s
	iters: 200, epoch: 3 | loss: 0.8626462
	speed: 0.0032s/iter; left time: 9.2082s
	iters: 300, epoch: 3 | loss: 0.5017257
	speed: 0.0031s/iter; left time: 8.5728s
	iters: 400, epoch: 3 | loss: 0.5045989
	speed: 0.0031s/iter; left time: 8.3422s
	iters: 500, epoch: 3 | loss: 1.0487908
	speed: 0.0031s/iter; left time: 7.9912s
Updating learning rate to 9.94488883e-05
Validation loss decreased (0.3653 --> 0.3509).  Saving model state dict ...
Epoch: 3 cost time: 1.6409227848052979
Epoch: 3, Steps: 514 | Train Loss: 0.6562691 Vali Loss: 0.3509167 Best vali loss: 0.3509167

best validation loss 0.35091674447293836

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025806545696, 'e_layers': 2, 'learning_rate': 0.000396693539, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7318506
	speed: 0.0098s/iter; left time: 39.4109s
	iters: 200, epoch: 1 | loss: 0.6227152
	speed: 0.0035s/iter; left time: 13.5493s
	iters: 300, epoch: 1 | loss: 0.4091047
	speed: 0.0033s/iter; left time: 12.6521s
	iters: 400, epoch: 1 | loss: 0.4996957
	speed: 0.0035s/iter; left time: 13.0123s
	iters: 500, epoch: 1 | loss: 1.1277148
	speed: 0.0036s/iter; left time: 13.1654s
Updating learning rate to 0.000396693539
Validation loss decreased (inf --> 0.3767).  Saving model state dict ...
Epoch: 1 cost time: 2.1603732109069824
Epoch: 1, Steps: 514 | Train Loss: 0.6782162 Vali Loss: 0.3767164 Best vali loss: 0.3767164
	iters: 100, epoch: 2 | loss: 0.4914069
	speed: 0.0075s/iter; left time: 26.2711s
	iters: 200, epoch: 2 | loss: 0.3658571
	speed: 0.0031s/iter; left time: 10.5210s
	iters: 300, epoch: 2 | loss: 0.6599093
	speed: 0.0030s/iter; left time: 10.0474s
	iters: 400, epoch: 2 | loss: 0.3799391
	speed: 0.0031s/iter; left time: 10.0050s
	iters: 500, epoch: 2 | loss: 0.9380492
	speed: 0.0033s/iter; left time: 10.2328s
Updating learning rate to 0.0001983467695
Validation loss decreased (0.3767 --> 0.3738).  Saving model state dict ...
Epoch: 2 cost time: 1.6657376289367676
Epoch: 2, Steps: 514 | Train Loss: 0.5670323 Vali Loss: 0.3737778 Best vali loss: 0.3737778
	iters: 100, epoch: 3 | loss: 0.5812213
	speed: 0.0084s/iter; left time: 25.0265s
	iters: 200, epoch: 3 | loss: 0.3034675
	speed: 0.0036s/iter; left time: 10.3193s
	iters: 300, epoch: 3 | loss: 0.4508227
	speed: 0.0036s/iter; left time: 10.0934s
	iters: 400, epoch: 3 | loss: 1.3742898
	speed: 0.0038s/iter; left time: 10.2678s
	iters: 500, epoch: 3 | loss: 0.3914657
	speed: 0.0032s/iter; left time: 8.2847s
Updating learning rate to 9.917338475e-05
Validation loss decreased (0.3738 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 1.8859846591949463
Epoch: 3, Steps: 514 | Train Loss: 0.6202534 Vali Loss: 0.3673200 Best vali loss: 0.3673200

best validation loss 0.36732002227385996

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0026186974191, 'e_layers': 2, 'learning_rate': 0.0003937642432, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7309588
	speed: 0.0096s/iter; left time: 38.6037s
	iters: 200, epoch: 1 | loss: 0.6226450
	speed: 0.0034s/iter; left time: 13.3086s
	iters: 300, epoch: 1 | loss: 0.4091459
	speed: 0.0035s/iter; left time: 13.2686s
	iters: 400, epoch: 1 | loss: 0.5008256
	speed: 0.0034s/iter; left time: 12.7848s
	iters: 500, epoch: 1 | loss: 1.1363072
	speed: 0.0035s/iter; left time: 12.5778s
Updating learning rate to 0.0003937642432
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 2.1379168033599854
Epoch: 1, Steps: 514 | Train Loss: 0.6799765 Vali Loss: 0.3818478 Best vali loss: 0.3818478
	iters: 100, epoch: 2 | loss: 0.4884083
	speed: 0.0076s/iter; left time: 26.7518s
	iters: 200, epoch: 2 | loss: 0.3820997
	speed: 0.0032s/iter; left time: 10.8043s
	iters: 300, epoch: 2 | loss: 0.4478521
	speed: 0.0031s/iter; left time: 10.3357s
	iters: 400, epoch: 2 | loss: 0.3767891
	speed: 0.0031s/iter; left time: 9.8045s
	iters: 500, epoch: 2 | loss: 0.9633907
	speed: 0.0031s/iter; left time: 9.6502s
Updating learning rate to 0.0001968821216
Validation loss decreased (0.3818 --> 0.3704).  Saving model state dict ...
Epoch: 2 cost time: 1.6785202026367188
Epoch: 2, Steps: 514 | Train Loss: 0.5317080 Vali Loss: 0.3704277 Best vali loss: 0.3704277
	iters: 100, epoch: 3 | loss: 0.5817973
	speed: 0.0074s/iter; left time: 22.1795s
	iters: 200, epoch: 3 | loss: 0.2908583
	speed: 0.0031s/iter; left time: 9.0293s
	iters: 300, epoch: 3 | loss: 0.4514562
	speed: 0.0032s/iter; left time: 8.8314s
	iters: 400, epoch: 3 | loss: 1.3355217
	speed: 0.0031s/iter; left time: 8.3628s
	iters: 500, epoch: 3 | loss: 0.3877546
	speed: 0.0031s/iter; left time: 8.0484s
Updating learning rate to 9.84410608e-05
Epoch: 3 cost time: 1.6532938480377197
Epoch: 3, Steps: 514 | Train Loss: 0.6094776 Vali Loss: 0.3740263 Best vali loss: 0.3704277

best validation loss 0.3704276723922587

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018318580204, 'e_layers': 2, 'learning_rate': 0.0003977955532, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3646493
	speed: 0.0108s/iter; left time: 26.7776s
	iters: 200, epoch: 4 | loss: 0.8815231
	speed: 0.0036s/iter; left time: 8.5305s
	iters: 300, epoch: 4 | loss: 0.7939446
	speed: 0.0036s/iter; left time: 8.2282s
	iters: 400, epoch: 4 | loss: 0.4640383
	speed: 0.0036s/iter; left time: 7.9155s
	iters: 500, epoch: 4 | loss: 0.4241868
	speed: 0.0037s/iter; left time: 7.6086s
Updating learning rate to 4.972444415e-05
Validation loss decreased (0.3509 --> 0.3457).  Saving model state dict ...
Epoch: 4 cost time: 2.310711622238159
Epoch: 4, Steps: 514 | Train Loss: 0.5856684 Vali Loss: 0.3457490 Best vali loss: 0.3457490
	iters: 100, epoch: 5 | loss: 0.3885921
	speed: 0.0090s/iter; left time: 17.6580s
	iters: 200, epoch: 5 | loss: 0.2303763
	speed: 0.0031s/iter; left time: 5.8189s
	iters: 300, epoch: 5 | loss: 0.3471036
	speed: 0.0032s/iter; left time: 5.6233s
	iters: 400, epoch: 5 | loss: 0.3819335
	speed: 0.0031s/iter; left time: 5.2068s
	iters: 500, epoch: 5 | loss: 0.5905344
	speed: 0.0031s/iter; left time: 4.8144s
Updating learning rate to 2.4862222075e-05
Epoch: 5 cost time: 1.6653621196746826
Epoch: 5, Steps: 514 | Train Loss: 0.3877080 Vali Loss: 0.3492049 Best vali loss: 0.3457490
	iters: 100, epoch: 6 | loss: 0.3106788
	speed: 0.0068s/iter; left time: 9.8565s
	iters: 200, epoch: 6 | loss: 0.7224030
	speed: 0.0032s/iter; left time: 4.2610s
	iters: 300, epoch: 6 | loss: 0.4424739
	speed: 0.0031s/iter; left time: 3.9121s
	iters: 400, epoch: 6 | loss: 0.4314717
	speed: 0.0032s/iter; left time: 3.6330s
	iters: 500, epoch: 6 | loss: 0.9669349
	speed: 0.0030s/iter; left time: 3.1716s
Updating learning rate to 1.24311110375e-05
Validation loss decreased (0.3457 --> 0.3448).  Saving model state dict ...
Epoch: 6 cost time: 1.652513027191162
Epoch: 6, Steps: 514 | Train Loss: 0.5747925 Vali Loss: 0.3447584 Best vali loss: 0.3447584
	iters: 100, epoch: 7 | loss: 0.5319825
	speed: 0.0067s/iter; left time: 6.2431s
	iters: 200, epoch: 7 | loss: 0.4347725
	speed: 0.0030s/iter; left time: 2.4902s
	iters: 300, epoch: 7 | loss: 0.4190381
	speed: 0.0030s/iter; left time: 2.2055s
	iters: 400, epoch: 7 | loss: 0.6165900
	speed: 0.0030s/iter; left time: 1.8817s
	iters: 500, epoch: 7 | loss: 0.6539002
	speed: 0.0030s/iter; left time: 1.5864s
Updating learning rate to 6.21555551875e-06
Epoch: 7 cost time: 1.5835285186767578
Epoch: 7, Steps: 514 | Train Loss: 0.5312566 Vali Loss: 0.3468896 Best vali loss: 0.3447584
	iters: 100, epoch: 8 | loss: 0.5164669
	speed: 0.0067s/iter; left time: 2.7923s
	iters: 200, epoch: 8 | loss: 0.6814680
	speed: 0.0031s/iter; left time: 0.9845s
	iters: 300, epoch: 8 | loss: 0.4506901
	speed: 0.0032s/iter; left time: 0.6809s
	iters: 400, epoch: 8 | loss: 0.7341157
	speed: 0.0031s/iter; left time: 0.3542s
	iters: 500, epoch: 8 | loss: 0.5288492
	speed: 0.0030s/iter; left time: 0.0450s
Updating learning rate to 3.107777759375e-06
Epoch: 8 cost time: 1.6240386962890625
Epoch: 8, Steps: 514 | Train Loss: 0.5823180 Vali Loss: 0.3482234 Best vali loss: 0.3447584

best validation loss 0.34475844267075095

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025139271891, 'e_layers': 2, 'learning_rate': 0.0003947840908, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7312921
	speed: 0.0103s/iter; left time: 41.2780s
	iters: 200, epoch: 1 | loss: 0.6224723
	speed: 0.0034s/iter; left time: 13.3894s
	iters: 300, epoch: 1 | loss: 0.4087095
	speed: 0.0034s/iter; left time: 12.9071s
	iters: 400, epoch: 1 | loss: 0.5159308
	speed: 0.0034s/iter; left time: 12.7638s
	iters: 500, epoch: 1 | loss: 1.1451439
	speed: 0.0034s/iter; left time: 12.4476s
Updating learning rate to 0.0003947840908
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 2.128416061401367
Epoch: 1, Steps: 514 | Train Loss: 0.6847097 Vali Loss: 0.3715795 Best vali loss: 0.3715795
	iters: 100, epoch: 2 | loss: 0.5167266
	speed: 0.0078s/iter; left time: 27.2691s
	iters: 200, epoch: 2 | loss: 0.3618554
	speed: 0.0036s/iter; left time: 12.1276s
	iters: 300, epoch: 2 | loss: 0.4833910
	speed: 0.0036s/iter; left time: 11.9820s
	iters: 400, epoch: 2 | loss: 0.3718078
	speed: 0.0036s/iter; left time: 11.5921s
	iters: 500, epoch: 2 | loss: 0.9744651
	speed: 0.0035s/iter; left time: 10.7833s
Updating learning rate to 0.0001973920454
Validation loss decreased (0.3716 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 1.872490406036377
Epoch: 2, Steps: 514 | Train Loss: 0.5416492 Vali Loss: 0.3694273 Best vali loss: 0.3694273
	iters: 100, epoch: 3 | loss: 0.5861585
	speed: 0.0081s/iter; left time: 24.0575s
	iters: 200, epoch: 3 | loss: 0.3135211
	speed: 0.0037s/iter; left time: 10.6447s
	iters: 300, epoch: 3 | loss: 0.4530197
	speed: 0.0035s/iter; left time: 9.7174s
	iters: 400, epoch: 3 | loss: 1.3914165
	speed: 0.0033s/iter; left time: 8.9250s
	iters: 500, epoch: 3 | loss: 0.3838466
	speed: 0.0033s/iter; left time: 8.4840s
Updating learning rate to 9.86960227e-05
Epoch: 3 cost time: 1.8404405117034912
Epoch: 3, Steps: 514 | Train Loss: 0.6255925 Vali Loss: 0.3754832 Best vali loss: 0.3694273
	iters: 100, epoch: 4 | loss: 0.4218477
	speed: 0.0073s/iter; left time: 18.1376s
	iters: 200, epoch: 4 | loss: 0.4671587
	speed: 0.0033s/iter; left time: 7.8623s
	iters: 300, epoch: 4 | loss: 0.3971855
	speed: 0.0033s/iter; left time: 7.5741s
	iters: 400, epoch: 4 | loss: 0.6814867
	speed: 0.0034s/iter; left time: 7.4053s
	iters: 500, epoch: 4 | loss: 0.6648008
	speed: 0.0035s/iter; left time: 7.1501s
Updating learning rate to 4.934801135e-05
Epoch: 4 cost time: 1.7794904708862305
Epoch: 4, Steps: 514 | Train Loss: 0.5264959 Vali Loss: 0.3977445 Best vali loss: 0.3694273
	iters: 100, epoch: 5 | loss: 0.3550681
	speed: 0.0077s/iter; left time: 14.9935s
	iters: 200, epoch: 5 | loss: 0.4696616
	speed: 0.0036s/iter; left time: 6.7523s
	iters: 300, epoch: 5 | loss: 0.4034291
	speed: 0.0037s/iter; left time: 6.4414s
	iters: 400, epoch: 5 | loss: 0.2766664
	speed: 0.0036s/iter; left time: 5.9758s
	iters: 500, epoch: 5 | loss: 0.7335753
	speed: 0.0036s/iter; left time: 5.5354s
Updating learning rate to 2.4674005675e-05
Epoch: 5 cost time: 1.897047758102417
Epoch: 5, Steps: 514 | Train Loss: 0.4476801 Vali Loss: 0.3928520 Best vali loss: 0.3694273
	iters: 100, epoch: 6 | loss: 0.3191423
	speed: 0.0076s/iter; left time: 11.0022s
	iters: 200, epoch: 6 | loss: 0.3427707
	speed: 0.0032s/iter; left time: 4.2821s
	iters: 300, epoch: 6 | loss: 0.5759293
	speed: 0.0032s/iter; left time: 3.9172s
	iters: 400, epoch: 6 | loss: 0.6226015
	speed: 0.0031s/iter; left time: 3.5148s
	iters: 500, epoch: 6 | loss: 0.5201427
	speed: 0.0031s/iter; left time: 3.2107s
Updating learning rate to 1.23370028375e-05
Epoch: 6 cost time: 1.6937158107757568
Epoch: 6, Steps: 514 | Train Loss: 0.4761173 Vali Loss: 0.3956426 Best vali loss: 0.3694273
	iters: 100, epoch: 7 | loss: 0.6373857
	speed: 0.0071s/iter; left time: 6.5863s
	iters: 200, epoch: 7 | loss: 0.3111988
	speed: 0.0032s/iter; left time: 2.6662s
	iters: 300, epoch: 7 | loss: 0.3283114
	speed: 0.0031s/iter; left time: 2.2375s
	iters: 400, epoch: 7 | loss: 1.0313214
	speed: 0.0032s/iter; left time: 2.0110s
	iters: 500, epoch: 7 | loss: 0.9410863
	speed: 0.0031s/iter; left time: 1.6513s
Updating learning rate to 6.16850141875e-06
Epoch: 7 cost time: 1.66497802734375
Epoch: 7, Steps: 514 | Train Loss: 0.6498607 Vali Loss: 0.3944429 Best vali loss: 0.3694273
	iters: 100, epoch: 8 | loss: 0.5035414
	speed: 0.0074s/iter; left time: 3.0836s
	iters: 200, epoch: 8 | loss: 0.5365117
	speed: 0.0033s/iter; left time: 1.0357s
	iters: 300, epoch: 8 | loss: 0.5214266
	speed: 0.0031s/iter; left time: 0.6690s
	iters: 400, epoch: 8 | loss: 0.5936338
	speed: 0.0033s/iter; left time: 0.3805s
	iters: 500, epoch: 8 | loss: 0.2163691
	speed: 0.0033s/iter; left time: 0.0492s
Updating learning rate to 3.084250709375e-06
Epoch: 8 cost time: 1.7177326679229736
Epoch: 8, Steps: 514 | Train Loss: 0.4742965 Vali Loss: 0.3963047 Best vali loss: 0.3694273

best validation loss 0.3694272903246121

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.002133229922, 'e_layers': 2, 'learning_rate': 0.0003976885858, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3242655
	speed: 0.0098s/iter; left time: 19.1205s
	iters: 200, epoch: 1 | loss: 0.3732839
	speed: 0.0037s/iter; left time: 6.8660s
Updating learning rate to 0.0003825524652669894
Validation loss decreased (inf --> 0.3612).  Saving model state dict ...
Epoch: 1 cost time: 1.3018500804901123
Epoch: 1, Steps: 257 | Train Loss: 0.3487747 Vali Loss: 0.3611918 Best vali loss: 0.3611918
	iters: 100, epoch: 2 | loss: 0.4260189
	speed: 0.0082s/iter; left time: 13.8693s
	iters: 200, epoch: 2 | loss: 0.6299872
	speed: 0.0037s/iter; left time: 5.8836s
Updating learning rate to 0.00033944844080983406
Epoch: 2 cost time: 0.9872181415557861
Epoch: 2, Steps: 257 | Train Loss: 0.5280031 Vali Loss: 0.3745836 Best vali loss: 0.3611918
	iters: 100, epoch: 3 | loss: 0.6455027
	speed: 0.0081s/iter; left time: 11.6452s
	iters: 200, epoch: 3 | loss: 0.4179665
	speed: 0.0038s/iter; left time: 5.0813s
Updating learning rate to 0.00027493870941318126
Epoch: 3 cost time: 0.9981663227081299
Epoch: 3, Steps: 257 | Train Loss: 0.5317346 Vali Loss: 0.3720404 Best vali loss: 0.3611918
	iters: 100, epoch: 4 | loss: 0.3582923
	speed: 0.0081s/iter; left time: 9.5672s
	iters: 200, epoch: 4 | loss: 0.8479696
	speed: 0.0037s/iter; left time: 4.0691s
Updating learning rate to 0.0001988442929
Epoch: 4 cost time: 1.0009372234344482
Epoch: 4, Steps: 257 | Train Loss: 0.6031309 Vali Loss: 0.3659014 Best vali loss: 0.3611918
	iters: 100, epoch: 5 | loss: 0.4095644
	speed: 0.0080s/iter; left time: 7.4222s
	iters: 200, epoch: 5 | loss: 0.8859400
	speed: 0.0034s/iter; left time: 2.8534s
Updating learning rate to 0.00012274987638681876
Validation loss decreased (0.3612 --> 0.3551).  Saving model state dict ...
Epoch: 5 cost time: 0.9323127269744873
Epoch: 5, Steps: 257 | Train Loss: 0.6477522 Vali Loss: 0.3550981 Best vali loss: 0.3550981
	iters: 100, epoch: 6 | loss: 0.4920281
	speed: 0.0081s/iter; left time: 5.4699s
	iters: 200, epoch: 6 | loss: 0.4780268
	speed: 0.0037s/iter; left time: 2.1074s
Updating learning rate to 5.824014499016595e-05
Epoch: 6 cost time: 0.9939122200012207
Epoch: 6, Steps: 257 | Train Loss: 0.4850275 Vali Loss: 0.3613227 Best vali loss: 0.3550981
	iters: 100, epoch: 7 | loss: 0.3900534
	speed: 0.0083s/iter; left time: 3.4581s
	iters: 200, epoch: 7 | loss: 0.5382627
	speed: 0.0037s/iter; left time: 1.1644s
Updating learning rate to 1.5136120533010627e-05
Epoch: 7 cost time: 0.9998641014099121
Epoch: 7, Steps: 257 | Train Loss: 0.4641580 Vali Loss: 0.3597396 Best vali loss: 0.3550981
	iters: 100, epoch: 8 | loss: 0.4588543
	speed: 0.0080s/iter; left time: 1.2657s
	iters: 200, epoch: 8 | loss: 0.5829272
	speed: 0.0037s/iter; left time: 0.2161s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.989232063293457
Epoch: 8, Steps: 257 | Train Loss: 0.5208907 Vali Loss: 0.3551359 Best vali loss: 0.3550981

best validation loss 0.35509805811645945

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010765072813, 'e_layers': 2, 'learning_rate': 0.0003859407514, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266450
	speed: 0.0096s/iter; left time: 38.6083s
	iters: 200, epoch: 1 | loss: 0.9920818
	speed: 0.0035s/iter; left time: 13.7963s
	iters: 300, epoch: 1 | loss: 0.3766918
	speed: 0.0035s/iter; left time: 13.3007s
	iters: 400, epoch: 1 | loss: 0.6662441
	speed: 0.0034s/iter; left time: 12.7857s
	iters: 500, epoch: 1 | loss: 0.3909104
	speed: 0.0033s/iter; left time: 12.0201s
Updating learning rate to 0.0003859407514
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 2.1238088607788086
Epoch: 1, Steps: 514 | Train Loss: 0.5705146 Vali Loss: 0.3709748 Best vali loss: 0.3709748
	iters: 100, epoch: 2 | loss: 1.3498209
	speed: 0.0074s/iter; left time: 25.8159s
	iters: 200, epoch: 2 | loss: 0.6830173
	speed: 0.0035s/iter; left time: 12.0460s
	iters: 300, epoch: 2 | loss: 0.7843178
	speed: 0.0035s/iter; left time: 11.6421s
	iters: 400, epoch: 2 | loss: 0.2997794
	speed: 0.0035s/iter; left time: 11.3006s
	iters: 500, epoch: 2 | loss: 0.2701412
	speed: 0.0033s/iter; left time: 10.2577s
Updating learning rate to 0.0001929703757
Epoch: 2 cost time: 1.8424279689788818
Epoch: 2, Steps: 514 | Train Loss: 0.6774153 Vali Loss: 0.3716543 Best vali loss: 0.3709748
	iters: 100, epoch: 3 | loss: 0.3738492
	speed: 0.0075s/iter; left time: 22.5029s
	iters: 200, epoch: 3 | loss: 0.3398616
	speed: 0.0034s/iter; left time: 9.8907s
	iters: 300, epoch: 3 | loss: 0.6354052
	speed: 0.0036s/iter; left time: 9.9849s
	iters: 400, epoch: 3 | loss: 0.9508585
	speed: 0.0034s/iter; left time: 9.2528s
	iters: 500, epoch: 3 | loss: 0.6007295
	speed: 0.0033s/iter; left time: 8.5027s
Updating learning rate to 9.648518785e-05
Validation loss decreased (0.3710 --> 0.3648).  Saving model state dict ...
Epoch: 3 cost time: 1.8153808116912842
Epoch: 3, Steps: 514 | Train Loss: 0.5801408 Vali Loss: 0.3648461 Best vali loss: 0.3648461

best validation loss 0.3648461190445718

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063646960114, 'e_layers': 4, 'learning_rate': 0.0033212576238, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6468573
	speed: 0.0110s/iter; left time: 21.5720s
	iters: 200, epoch: 1 | loss: 0.8071066
	speed: 0.0048s/iter; left time: 8.9104s
Updating learning rate to 0.0033212576238
Validation loss decreased (inf --> 0.3875).  Saving model state dict ...
Epoch: 1 cost time: 1.5837998390197754
Epoch: 1, Steps: 257 | Train Loss: 0.7269819 Vali Loss: 0.3875044 Best vali loss: 0.3875044
	iters: 100, epoch: 2 | loss: 0.9329975
	speed: 0.0103s/iter; left time: 17.5561s
	iters: 200, epoch: 2 | loss: 0.4854657
	speed: 0.0048s/iter; left time: 7.6179s
Updating learning rate to 0.0016606288119
Validation loss decreased (0.3875 --> 0.3806).  Saving model state dict ...
Epoch: 2 cost time: 1.286236047744751
Epoch: 2, Steps: 257 | Train Loss: 0.7092316 Vali Loss: 0.3805694 Best vali loss: 0.3805694
	iters: 100, epoch: 3 | loss: 0.5088079
	speed: 0.0103s/iter; left time: 14.8544s
	iters: 200, epoch: 3 | loss: 0.5079994
	speed: 0.0048s/iter; left time: 6.4484s
Updating learning rate to 0.00083031440595
Validation loss decreased (0.3806 --> 0.3769).  Saving model state dict ...
Epoch: 3 cost time: 1.282921314239502
Epoch: 3, Steps: 257 | Train Loss: 0.5084036 Vali Loss: 0.3768778 Best vali loss: 0.3768778

best validation loss 0.3768778178921383

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019573052669, 'e_layers': 4, 'learning_rate': 0.0001508220291, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6501268
	speed: 0.0113s/iter; left time: 45.3965s
	iters: 200, epoch: 1 | loss: 0.2872269
	speed: 0.0049s/iter; left time: 18.9795s
	iters: 300, epoch: 1 | loss: 0.9033577
	speed: 0.0049s/iter; left time: 18.5602s
	iters: 400, epoch: 1 | loss: 0.8110500
	speed: 0.0049s/iter; left time: 18.0633s
	iters: 500, epoch: 1 | loss: 1.2870690
	speed: 0.0049s/iter; left time: 17.7059s
Updating learning rate to 0.0001508220291
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 2.869943380355835
Epoch: 1, Steps: 514 | Train Loss: 0.7877661 Vali Loss: 0.3696636 Best vali loss: 0.3696636
	iters: 100, epoch: 2 | loss: 0.4344909
	speed: 0.0100s/iter; left time: 34.9021s
	iters: 200, epoch: 2 | loss: 0.2207117
	speed: 0.0051s/iter; left time: 17.4891s
	iters: 300, epoch: 2 | loss: 0.3245525
	speed: 0.0051s/iter; left time: 16.9748s
	iters: 400, epoch: 2 | loss: 0.4609851
	speed: 0.0051s/iter; left time: 16.4501s
	iters: 500, epoch: 2 | loss: 0.3583989
	speed: 0.0048s/iter; left time: 14.9791s
Updating learning rate to 7.541101455e-05
Epoch: 2 cost time: 2.656452178955078
Epoch: 2, Steps: 514 | Train Loss: 0.3598278 Vali Loss: 0.3698693 Best vali loss: 0.3696636
	iters: 100, epoch: 3 | loss: 0.6119221
	speed: 0.0099s/iter; left time: 29.6307s
	iters: 200, epoch: 3 | loss: 0.8891293
	speed: 0.0053s/iter; left time: 15.4047s
	iters: 300, epoch: 3 | loss: 0.9369801
	speed: 0.0052s/iter; left time: 14.5911s
	iters: 400, epoch: 3 | loss: 0.6163476
	speed: 0.0051s/iter; left time: 13.7299s
	iters: 500, epoch: 3 | loss: 0.9157700
	speed: 0.0052s/iter; left time: 13.3915s
Updating learning rate to 3.7705507275e-05
Validation loss decreased (0.3697 --> 0.3614).  Saving model state dict ...
Epoch: 3 cost time: 2.733337640762329
Epoch: 3, Steps: 514 | Train Loss: 0.7940298 Vali Loss: 0.3614161 Best vali loss: 0.3614161

best validation loss 0.3614160776021204

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019573052669, 'e_layers': 4, 'learning_rate': 0.0001508220291, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5272977
	speed: 0.0115s/iter; left time: 28.3985s
	iters: 200, epoch: 4 | loss: 0.2732880
	speed: 0.0052s/iter; left time: 12.3494s
	iters: 300, epoch: 4 | loss: 0.7922004
	speed: 0.0052s/iter; left time: 11.7934s
	iters: 400, epoch: 4 | loss: 0.6283000
	speed: 0.0052s/iter; left time: 11.2892s
	iters: 500, epoch: 4 | loss: 0.9393479
	speed: 0.0053s/iter; left time: 10.8850s
Updating learning rate to 1.88527536375e-05
Epoch: 4 cost time: 3.025667190551758
Epoch: 4, Steps: 514 | Train Loss: 0.6320868 Vali Loss: 0.3906394 Best vali loss: 0.3614161
	iters: 100, epoch: 5 | loss: 0.3468671
	speed: 0.0096s/iter; left time: 18.7454s
	iters: 200, epoch: 5 | loss: 0.1903016
	speed: 0.0046s/iter; left time: 8.5803s
	iters: 300, epoch: 5 | loss: 0.3363222
	speed: 0.0046s/iter; left time: 8.1406s
	iters: 400, epoch: 5 | loss: 0.4458594
	speed: 0.0047s/iter; left time: 7.7597s
	iters: 500, epoch: 5 | loss: 0.3506749
	speed: 0.0047s/iter; left time: 7.2667s
Updating learning rate to 9.42637681875e-06
Epoch: 5 cost time: 2.451545238494873
Epoch: 5, Steps: 514 | Train Loss: 0.3340051 Vali Loss: 0.3957175 Best vali loss: 0.3614161
	iters: 100, epoch: 6 | loss: 0.5777024
	speed: 0.0091s/iter; left time: 13.1255s
	iters: 200, epoch: 6 | loss: 0.8426279
	speed: 0.0045s/iter; left time: 6.0832s
	iters: 300, epoch: 6 | loss: 0.8622167
	speed: 0.0045s/iter; left time: 5.6036s
	iters: 400, epoch: 6 | loss: 0.4011205
	speed: 0.0045s/iter; left time: 5.1893s
	iters: 500, epoch: 6 | loss: 0.8317305
	speed: 0.0047s/iter; left time: 4.8749s
Updating learning rate to 4.713188409375e-06
Epoch: 6 cost time: 2.3836095333099365
Epoch: 6, Steps: 514 | Train Loss: 0.7030796 Vali Loss: 0.3834489 Best vali loss: 0.3614161
	iters: 100, epoch: 7 | loss: 0.3033513
	speed: 0.0101s/iter; left time: 9.3367s
	iters: 200, epoch: 7 | loss: 0.5342287
	speed: 0.0054s/iter; left time: 4.4416s
	iters: 300, epoch: 7 | loss: 0.3008008
	speed: 0.0053s/iter; left time: 3.8986s
	iters: 400, epoch: 7 | loss: 0.5804276
	speed: 0.0054s/iter; left time: 3.3684s
	iters: 500, epoch: 7 | loss: 0.3208665
	speed: 0.0053s/iter; left time: 2.8054s
Updating learning rate to 2.3565942046875e-06
Epoch: 7 cost time: 2.7825510501861572
Epoch: 7, Steps: 514 | Train Loss: 0.4079350 Vali Loss: 0.3918909 Best vali loss: 0.3614161
	iters: 100, epoch: 8 | loss: 0.5416409
	speed: 0.0100s/iter; left time: 4.1323s
	iters: 200, epoch: 8 | loss: 1.0663917
	speed: 0.0049s/iter; left time: 1.5293s
	iters: 300, epoch: 8 | loss: 0.5960934
	speed: 0.0051s/iter; left time: 1.0884s
	iters: 400, epoch: 8 | loss: 0.5850288
	speed: 0.0052s/iter; left time: 0.5986s
	iters: 500, epoch: 8 | loss: 0.6532385
	speed: 0.0051s/iter; left time: 0.0764s
Updating learning rate to 1.17829710234375e-06
Epoch: 8 cost time: 2.6490821838378906
Epoch: 8, Steps: 514 | Train Loss: 0.6884787 Vali Loss: 0.3906176 Best vali loss: 0.3614161

best validation loss 0.3614160776021204

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001067472178, 'e_layers': 2, 'learning_rate': 0.0003860288604, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4266317
	speed: 0.0096s/iter; left time: 38.3584s
	iters: 200, epoch: 1 | loss: 0.9920277
	speed: 0.0033s/iter; left time: 12.9390s
	iters: 300, epoch: 1 | loss: 0.3767107
	speed: 0.0033s/iter; left time: 12.4476s
	iters: 400, epoch: 1 | loss: 0.6689974
	speed: 0.0033s/iter; left time: 12.1332s
	iters: 500, epoch: 1 | loss: 0.3775852
	speed: 0.0033s/iter; left time: 12.0549s
Updating learning rate to 0.0003860288604
Validation loss decreased (inf --> 0.3557).  Saving model state dict ...
Epoch: 1 cost time: 2.051730155944824
Epoch: 1, Steps: 514 | Train Loss: 0.5683905 Vali Loss: 0.3557015 Best vali loss: 0.3557015
	iters: 100, epoch: 2 | loss: 1.3781437
	speed: 0.0074s/iter; left time: 25.9882s
	iters: 200, epoch: 2 | loss: 0.6610811
	speed: 0.0035s/iter; left time: 11.8814s
	iters: 300, epoch: 2 | loss: 0.7978213
	speed: 0.0034s/iter; left time: 11.1453s
	iters: 400, epoch: 2 | loss: 0.3049946
	speed: 0.0033s/iter; left time: 10.5021s
	iters: 500, epoch: 2 | loss: 0.2712204
	speed: 0.0035s/iter; left time: 10.8084s
Updating learning rate to 0.0001930144302
Epoch: 2 cost time: 1.80497407913208
Epoch: 2, Steps: 514 | Train Loss: 0.6826522 Vali Loss: 0.3574862 Best vali loss: 0.3557015
	iters: 100, epoch: 3 | loss: 0.3673488
	speed: 0.0072s/iter; left time: 21.4723s
	iters: 200, epoch: 3 | loss: 0.3287594
	speed: 0.0034s/iter; left time: 9.7211s
	iters: 300, epoch: 3 | loss: 0.6432829
	speed: 0.0035s/iter; left time: 9.8238s
	iters: 400, epoch: 3 | loss: 0.9832819
	speed: 0.0035s/iter; left time: 9.4762s
	iters: 500, epoch: 3 | loss: 0.5996777
	speed: 0.0034s/iter; left time: 8.8742s
Updating learning rate to 9.65072151e-05
Epoch: 3 cost time: 1.8225860595703125
Epoch: 3, Steps: 514 | Train Loss: 0.5844701 Vali Loss: 0.3686036 Best vali loss: 0.3557015
	iters: 100, epoch: 4 | loss: 0.4247990
	speed: 0.0071s/iter; left time: 17.5844s
	iters: 200, epoch: 4 | loss: 0.3491142
	speed: 0.0035s/iter; left time: 8.3144s
	iters: 300, epoch: 4 | loss: 0.5823177
	speed: 0.0036s/iter; left time: 8.0813s
	iters: 400, epoch: 4 | loss: 0.2912729
	speed: 0.0035s/iter; left time: 7.5212s
	iters: 500, epoch: 4 | loss: 0.9080653
	speed: 0.0034s/iter; left time: 7.1006s
Updating learning rate to 4.825360755e-05
Epoch: 4 cost time: 1.820570468902588
Epoch: 4, Steps: 514 | Train Loss: 0.5111138 Vali Loss: 0.3713373 Best vali loss: 0.3557015
	iters: 100, epoch: 5 | loss: 0.4334882
	speed: 0.0073s/iter; left time: 14.2846s
	iters: 200, epoch: 5 | loss: 0.3981621
	speed: 0.0036s/iter; left time: 6.7312s
	iters: 300, epoch: 5 | loss: 0.2800660
	speed: 0.0035s/iter; left time: 6.0740s
	iters: 400, epoch: 5 | loss: 0.6519920
	speed: 0.0034s/iter; left time: 5.6063s
	iters: 500, epoch: 5 | loss: 0.7799512
	speed: 0.0035s/iter; left time: 5.4406s
Updating learning rate to 2.4126803775e-05
Epoch: 5 cost time: 1.8229060173034668
Epoch: 5, Steps: 514 | Train Loss: 0.5087319 Vali Loss: 0.3609069 Best vali loss: 0.3557015
	iters: 100, epoch: 6 | loss: 0.4753201
	speed: 0.0071s/iter; left time: 10.3109s
	iters: 200, epoch: 6 | loss: 0.6829461
	speed: 0.0035s/iter; left time: 4.7529s
	iters: 300, epoch: 6 | loss: 0.4038316
	speed: 0.0033s/iter; left time: 4.0762s
	iters: 400, epoch: 6 | loss: 0.5216716
	speed: 0.0032s/iter; left time: 3.6576s
	iters: 500, epoch: 6 | loss: 0.4761762
	speed: 0.0032s/iter; left time: 3.3111s
Updating learning rate to 1.20634018875e-05
Epoch: 6 cost time: 1.749732255935669
Epoch: 6, Steps: 514 | Train Loss: 0.5119891 Vali Loss: 0.3566041 Best vali loss: 0.3557015
	iters: 100, epoch: 7 | loss: 0.2220612
	speed: 0.0070s/iter; left time: 6.5132s
	iters: 200, epoch: 7 | loss: 0.2384833
	speed: 0.0032s/iter; left time: 2.6620s
	iters: 300, epoch: 7 | loss: 0.8452524
	speed: 0.0034s/iter; left time: 2.4967s
	iters: 400, epoch: 7 | loss: 0.3389051
	speed: 0.0033s/iter; left time: 2.0925s
	iters: 500, epoch: 7 | loss: 0.2684538
	speed: 0.0033s/iter; left time: 1.7204s
Updating learning rate to 6.03170094375e-06
Epoch: 7 cost time: 1.7213873863220215
Epoch: 7, Steps: 514 | Train Loss: 0.3826312 Vali Loss: 0.3599160 Best vali loss: 0.3557015
	iters: 100, epoch: 8 | loss: 0.7626209
	speed: 0.0073s/iter; left time: 3.0199s
	iters: 200, epoch: 8 | loss: 0.2812075
	speed: 0.0033s/iter; left time: 1.0381s
	iters: 300, epoch: 8 | loss: 0.3301308
	speed: 0.0033s/iter; left time: 0.7127s
	iters: 400, epoch: 8 | loss: 0.4745358
	speed: 0.0032s/iter; left time: 0.3729s
	iters: 500, epoch: 8 | loss: 0.5936382
	speed: 0.0032s/iter; left time: 0.0487s
Updating learning rate to 3.015850471875e-06
Epoch: 8 cost time: 1.7193126678466797
Epoch: 8, Steps: 514 | Train Loss: 0.4884266 Vali Loss: 0.3596110 Best vali loss: 0.3557015

best validation loss 0.35570152302973396

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010606547123, 'e_layers': 2, 'learning_rate': 0.000383244247, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4266022
	speed: 0.0092s/iter; left time: 36.7780s
	iters: 200, epoch: 1 | loss: 0.9922288
	speed: 0.0032s/iter; left time: 12.4104s
	iters: 300, epoch: 1 | loss: 0.3762715
	speed: 0.0031s/iter; left time: 12.0083s
	iters: 400, epoch: 1 | loss: 0.6681998
	speed: 0.0031s/iter; left time: 11.5409s
	iters: 500, epoch: 1 | loss: 0.3912696
	speed: 0.0031s/iter; left time: 11.1039s
Updating learning rate to 0.000383244247
Validation loss decreased (inf --> 0.3580).  Saving model state dict ...
Epoch: 1 cost time: 1.9441604614257812
Epoch: 1, Steps: 514 | Train Loss: 0.5709144 Vali Loss: 0.3580469 Best vali loss: 0.3580469
	iters: 100, epoch: 2 | loss: 1.2440796
	speed: 0.0070s/iter; left time: 24.5933s
	iters: 200, epoch: 2 | loss: 0.6617194
	speed: 0.0032s/iter; left time: 10.9188s
	iters: 300, epoch: 2 | loss: 0.7871242
	speed: 0.0032s/iter; left time: 10.6706s
	iters: 400, epoch: 2 | loss: 0.3102383
	speed: 0.0032s/iter; left time: 10.3308s
	iters: 500, epoch: 2 | loss: 0.2740922
	speed: 0.0032s/iter; left time: 9.9024s
Updating learning rate to 0.0001916221235
Validation loss decreased (0.3580 --> 0.3440).  Saving model state dict ...
Epoch: 2 cost time: 1.6891372203826904
Epoch: 2, Steps: 514 | Train Loss: 0.6554507 Vali Loss: 0.3440382 Best vali loss: 0.3440382
	iters: 100, epoch: 3 | loss: 0.3882795
	speed: 0.0071s/iter; left time: 21.2835s
	iters: 200, epoch: 3 | loss: 0.3432311
	speed: 0.0030s/iter; left time: 8.5352s
	iters: 300, epoch: 3 | loss: 0.6635288
	speed: 0.0029s/iter; left time: 8.1976s
	iters: 400, epoch: 3 | loss: 1.0124054
	speed: 0.0030s/iter; left time: 8.0286s
	iters: 500, epoch: 3 | loss: 0.5850164
	speed: 0.0030s/iter; left time: 7.8340s
Updating learning rate to 9.581106175e-05
Epoch: 3 cost time: 1.5838027000427246
Epoch: 3, Steps: 514 | Train Loss: 0.5984922 Vali Loss: 0.3566728 Best vali loss: 0.3440382
	iters: 100, epoch: 4 | loss: 0.4208317
	speed: 0.0072s/iter; left time: 17.7509s
	iters: 200, epoch: 4 | loss: 0.3226305
	speed: 0.0031s/iter; left time: 7.4408s
	iters: 300, epoch: 4 | loss: 0.5589662
	speed: 0.0031s/iter; left time: 7.0801s
	iters: 400, epoch: 4 | loss: 0.2958810
	speed: 0.0032s/iter; left time: 6.9279s
	iters: 500, epoch: 4 | loss: 0.8926501
	speed: 0.0031s/iter; left time: 6.4992s
Updating learning rate to 4.7905530875e-05
Epoch: 4 cost time: 1.66937255859375
Epoch: 4, Steps: 514 | Train Loss: 0.4981919 Vali Loss: 0.3486657 Best vali loss: 0.3440382
	iters: 100, epoch: 5 | loss: 0.4202757
	speed: 0.0074s/iter; left time: 14.5050s
	iters: 200, epoch: 5 | loss: 0.4071242
	speed: 0.0036s/iter; left time: 6.5974s
	iters: 300, epoch: 5 | loss: 0.2702278
	speed: 0.0034s/iter; left time: 5.9586s
	iters: 400, epoch: 5 | loss: 0.6424786
	speed: 0.0035s/iter; left time: 5.7293s
	iters: 500, epoch: 5 | loss: 0.7471215
	speed: 0.0034s/iter; left time: 5.3140s
Updating learning rate to 2.39527654375e-05
Epoch: 5 cost time: 1.8340935707092285
Epoch: 5, Steps: 514 | Train Loss: 0.4974456 Vali Loss: 0.3451413 Best vali loss: 0.3440382
	iters: 100, epoch: 6 | loss: 0.4736126
	speed: 0.0073s/iter; left time: 10.5292s
	iters: 200, epoch: 6 | loss: 0.6750789
	speed: 0.0033s/iter; left time: 4.4507s
	iters: 300, epoch: 6 | loss: 0.3987659
	speed: 0.0032s/iter; left time: 3.9910s
	iters: 400, epoch: 6 | loss: 0.5282033
	speed: 0.0033s/iter; left time: 3.7500s
	iters: 500, epoch: 6 | loss: 0.4638115
	speed: 0.0033s/iter; left time: 3.4348s
Updating learning rate to 1.197638271875e-05
Epoch: 6 cost time: 1.7329463958740234
Epoch: 6, Steps: 514 | Train Loss: 0.5078944 Vali Loss: 0.3441505 Best vali loss: 0.3440382
	iters: 100, epoch: 7 | loss: 0.2134748
	speed: 0.0071s/iter; left time: 6.5811s
	iters: 200, epoch: 7 | loss: 0.2369569
	speed: 0.0033s/iter; left time: 2.7374s
	iters: 300, epoch: 7 | loss: 0.8266946
	speed: 0.0033s/iter; left time: 2.4230s
	iters: 400, epoch: 7 | loss: 0.3477715
	speed: 0.0032s/iter; left time: 2.0395s
	iters: 500, epoch: 7 | loss: 0.2696036
	speed: 0.0032s/iter; left time: 1.6838s
Updating learning rate to 5.988191359375e-06
Epoch: 7 cost time: 1.712364673614502
Epoch: 7, Steps: 514 | Train Loss: 0.3789003 Vali Loss: 0.3447439 Best vali loss: 0.3440382
	iters: 100, epoch: 8 | loss: 0.7691790
	speed: 0.0074s/iter; left time: 3.0867s
	iters: 200, epoch: 8 | loss: 0.2622445
	speed: 0.0033s/iter; left time: 1.0368s
	iters: 300, epoch: 8 | loss: 0.3130134
	speed: 0.0033s/iter; left time: 0.7055s
	iters: 400, epoch: 8 | loss: 0.5048574
	speed: 0.0032s/iter; left time: 0.3673s
	iters: 500, epoch: 8 | loss: 0.5623842
	speed: 0.0032s/iter; left time: 0.0486s
Updating learning rate to 2.9940956796875e-06
Validation loss decreased (0.3440 --> 0.3438).  Saving model state dict ...
Epoch: 8 cost time: 1.7452070713043213
Epoch: 8, Steps: 514 | Train Loss: 0.4823357 Vali Loss: 0.3437760 Best vali loss: 0.3437760

best validation loss 0.3437759811933242

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010631620232, 'e_layers': 2, 'learning_rate': 0.0003859119178, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266424
	speed: 0.0097s/iter; left time: 39.0094s
	iters: 200, epoch: 1 | loss: 0.9920754
	speed: 0.0034s/iter; left time: 13.4191s
	iters: 300, epoch: 1 | loss: 0.3765556
	speed: 0.0033s/iter; left time: 12.6732s
	iters: 400, epoch: 1 | loss: 0.6724343
	speed: 0.0033s/iter; left time: 12.3827s
	iters: 500, epoch: 1 | loss: 0.3887801
	speed: 0.0035s/iter; left time: 12.7665s
Updating learning rate to 0.0003859119178
Validation loss decreased (inf --> 0.3564).  Saving model state dict ...
Epoch: 1 cost time: 2.103048801422119
Epoch: 1, Steps: 514 | Train Loss: 0.5712975 Vali Loss: 0.3564208 Best vali loss: 0.3564208
	iters: 100, epoch: 2 | loss: 1.2905111
	speed: 0.0073s/iter; left time: 25.4182s
	iters: 200, epoch: 2 | loss: 0.6619364
	speed: 0.0034s/iter; left time: 11.4563s
	iters: 300, epoch: 2 | loss: 0.7873325
	speed: 0.0033s/iter; left time: 10.9992s
	iters: 400, epoch: 2 | loss: 0.3076856
	speed: 0.0035s/iter; left time: 11.3151s
	iters: 500, epoch: 2 | loss: 0.2739239
	speed: 0.0034s/iter; left time: 10.6586s
Updating learning rate to 0.0001929559589
Epoch: 2 cost time: 1.7984974384307861
Epoch: 2, Steps: 514 | Train Loss: 0.6642779 Vali Loss: 0.3823079 Best vali loss: 0.3564208
	iters: 100, epoch: 3 | loss: 0.3660736
	speed: 0.0071s/iter; left time: 21.0989s
	iters: 200, epoch: 3 | loss: 0.3508745
	speed: 0.0032s/iter; left time: 9.3651s
	iters: 300, epoch: 3 | loss: 0.6304953
	speed: 0.0034s/iter; left time: 9.4246s
	iters: 400, epoch: 3 | loss: 1.0460320
	speed: 0.0034s/iter; left time: 9.2288s
	iters: 500, epoch: 3 | loss: 0.5898178
	speed: 0.0034s/iter; left time: 8.6897s
Updating learning rate to 9.647797945e-05
Validation loss decreased (0.3564 --> 0.3468).  Saving model state dict ...
Epoch: 3 cost time: 1.7594363689422607
Epoch: 3, Steps: 514 | Train Loss: 0.5966586 Vali Loss: 0.3467639 Best vali loss: 0.3467639

best validation loss 0.3467639039740815

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010529211103, 'e_layers': 1, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8929142
	speed: 0.0089s/iter; left time: 35.7844s
	iters: 200, epoch: 1 | loss: 0.4900604
	speed: 0.0025s/iter; left time: 9.7701s
	iters: 300, epoch: 1 | loss: 0.3058999
	speed: 0.0025s/iter; left time: 9.3876s
	iters: 400, epoch: 1 | loss: 0.9499581
	speed: 0.0026s/iter; left time: 9.6247s
	iters: 500, epoch: 1 | loss: 0.4452605
	speed: 0.0026s/iter; left time: 9.2292s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.6619985103607178
Epoch: 1, Steps: 514 | Train Loss: 0.6168186 Vali Loss: 0.3695817 Best vali loss: 0.3695817
	iters: 100, epoch: 2 | loss: 0.3774110
	speed: 0.0065s/iter; left time: 22.5841s
	iters: 200, epoch: 2 | loss: 0.8784835
	speed: 0.0026s/iter; left time: 8.9697s
	iters: 300, epoch: 2 | loss: 0.3603979
	speed: 0.0026s/iter; left time: 8.6847s
	iters: 400, epoch: 2 | loss: 0.4588240
	speed: 0.0025s/iter; left time: 8.0827s
	iters: 500, epoch: 2 | loss: 0.8047989
	speed: 0.0026s/iter; left time: 8.1134s
Updating learning rate to 0.0001911554003
Epoch: 2 cost time: 1.3875892162322998
Epoch: 2, Steps: 514 | Train Loss: 0.5759831 Vali Loss: 0.3803677 Best vali loss: 0.3695817
	iters: 100, epoch: 3 | loss: 0.4316358
	speed: 0.0060s/iter; left time: 17.8376s
	iters: 200, epoch: 3 | loss: 0.6523033
	speed: 0.0024s/iter; left time: 6.7923s
	iters: 300, epoch: 3 | loss: 0.6094587
	speed: 0.0024s/iter; left time: 6.6573s
	iters: 400, epoch: 3 | loss: 0.2955213
	speed: 0.0024s/iter; left time: 6.4405s
	iters: 500, epoch: 3 | loss: 0.9953717
	speed: 0.0022s/iter; left time: 5.7817s
Updating learning rate to 9.557770015e-05
Epoch: 3 cost time: 1.2415497303009033
Epoch: 3, Steps: 514 | Train Loss: 0.5968582 Vali Loss: 0.3834197 Best vali loss: 0.3695817

best validation loss 0.3695816935045546

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0037401582438, 'e_layers': 4, 'learning_rate': 0.000397709092, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8800722
	speed: 0.0111s/iter; left time: 44.5221s
	iters: 200, epoch: 1 | loss: 0.8338925
	speed: 0.0050s/iter; left time: 19.4865s
	iters: 300, epoch: 1 | loss: 0.7045915
	speed: 0.0051s/iter; left time: 19.3879s
	iters: 400, epoch: 1 | loss: 0.8338653
	speed: 0.0051s/iter; left time: 18.9167s
	iters: 500, epoch: 1 | loss: 0.8026987
	speed: 0.0051s/iter; left time: 18.3720s
Updating learning rate to 0.000397709092
Validation loss decreased (inf --> 0.3603).  Saving model state dict ...
Epoch: 1 cost time: 2.928114652633667
Epoch: 1, Steps: 514 | Train Loss: 0.8110240 Vali Loss: 0.3602522 Best vali loss: 0.3602522
	iters: 100, epoch: 2 | loss: 1.1782295
	speed: 0.0104s/iter; left time: 36.2336s
	iters: 200, epoch: 2 | loss: 0.3990216
	speed: 0.0053s/iter; left time: 17.8804s
	iters: 300, epoch: 2 | loss: 0.4339344
	speed: 0.0052s/iter; left time: 17.1561s
	iters: 400, epoch: 2 | loss: 1.1158148
	speed: 0.0053s/iter; left time: 16.8849s
	iters: 500, epoch: 2 | loss: 0.7387083
	speed: 0.0053s/iter; left time: 16.4163s
Updating learning rate to 0.000198854546
Epoch: 2 cost time: 2.7469305992126465
Epoch: 2, Steps: 514 | Train Loss: 0.7731417 Vali Loss: 0.3610101 Best vali loss: 0.3602522
	iters: 100, epoch: 3 | loss: 0.4685091
	speed: 0.0097s/iter; left time: 29.0768s
	iters: 200, epoch: 3 | loss: 0.6740667
	speed: 0.0050s/iter; left time: 14.3068s
	iters: 300, epoch: 3 | loss: 0.2633658
	speed: 0.0049s/iter; left time: 13.7767s
	iters: 400, epoch: 3 | loss: 0.2220755
	speed: 0.0050s/iter; left time: 13.3385s
	iters: 500, epoch: 3 | loss: 0.8033942
	speed: 0.0049s/iter; left time: 12.6241s
Updating learning rate to 9.9427273e-05
Validation loss decreased (0.3603 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 2.584066390991211
Epoch: 3, Steps: 514 | Train Loss: 0.4862823 Vali Loss: 0.3542149 Best vali loss: 0.3542149

best validation loss 0.3542148693195729

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010631620232, 'e_layers': 2, 'learning_rate': 0.0003859119178, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3332933
	speed: 0.0098s/iter; left time: 24.1439s
	iters: 200, epoch: 4 | loss: 0.7910117
	speed: 0.0035s/iter; left time: 8.2058s
	iters: 300, epoch: 4 | loss: 0.3229171
	speed: 0.0034s/iter; left time: 7.7771s
	iters: 400, epoch: 4 | loss: 0.5339489
	speed: 0.0033s/iter; left time: 7.2304s
	iters: 500, epoch: 4 | loss: 0.3418437
	speed: 0.0033s/iter; left time: 6.9093s
Updating learning rate to 4.8238989725e-05
Epoch: 4 cost time: 2.0954763889312744
Epoch: 4, Steps: 514 | Train Loss: 0.4646029 Vali Loss: 0.3533365 Best vali loss: 0.3467639
	iters: 100, epoch: 5 | loss: 1.0149326
	speed: 0.0076s/iter; left time: 14.7814s
	iters: 200, epoch: 5 | loss: 0.6426883
	speed: 0.0036s/iter; left time: 6.7003s
	iters: 300, epoch: 5 | loss: 0.7221276
	speed: 0.0036s/iter; left time: 6.3136s
	iters: 400, epoch: 5 | loss: 0.2920544
	speed: 0.0035s/iter; left time: 5.8816s
	iters: 500, epoch: 5 | loss: 0.2628062
	speed: 0.0036s/iter; left time: 5.5988s
Updating learning rate to 2.41194948625e-05
Epoch: 5 cost time: 1.887115716934204
Epoch: 5, Steps: 514 | Train Loss: 0.5869218 Vali Loss: 0.3509488 Best vali loss: 0.3467639
	iters: 100, epoch: 6 | loss: 0.3473142
	speed: 0.0072s/iter; left time: 10.3806s
	iters: 200, epoch: 6 | loss: 0.3148694
	speed: 0.0032s/iter; left time: 4.3458s
	iters: 300, epoch: 6 | loss: 0.5877515
	speed: 0.0032s/iter; left time: 4.0162s
	iters: 400, epoch: 6 | loss: 0.8594341
	speed: 0.0032s/iter; left time: 3.6762s
	iters: 500, epoch: 6 | loss: 0.5609095
	speed: 0.0033s/iter; left time: 3.3930s
Updating learning rate to 1.205974743125e-05
Epoch: 6 cost time: 1.715665578842163
Epoch: 6, Steps: 514 | Train Loss: 0.5340557 Vali Loss: 0.3492959 Best vali loss: 0.3467639
	iters: 100, epoch: 7 | loss: 0.4194181
	speed: 0.0073s/iter; left time: 6.8189s
	iters: 200, epoch: 7 | loss: 0.2739313
	speed: 0.0034s/iter; left time: 2.8212s
	iters: 300, epoch: 7 | loss: 0.5251151
	speed: 0.0034s/iter; left time: 2.4955s
	iters: 400, epoch: 7 | loss: 0.2864111
	speed: 0.0033s/iter; left time: 2.0956s
	iters: 500, epoch: 7 | loss: 0.8913915
	speed: 0.0033s/iter; left time: 1.7441s
Updating learning rate to 6.029873715625e-06
Epoch: 7 cost time: 1.766371488571167
Epoch: 7, Steps: 514 | Train Loss: 0.4792534 Vali Loss: 0.3501841 Best vali loss: 0.3467639
	iters: 100, epoch: 8 | loss: 0.4027517
	speed: 0.0072s/iter; left time: 2.9898s
	iters: 200, epoch: 8 | loss: 0.4140484
	speed: 0.0035s/iter; left time: 1.0885s
	iters: 300, epoch: 8 | loss: 0.2573757
	speed: 0.0034s/iter; left time: 0.7395s
	iters: 400, epoch: 8 | loss: 0.6458200
	speed: 0.0032s/iter; left time: 0.3677s
	iters: 500, epoch: 8 | loss: 0.7538790
	speed: 0.0033s/iter; left time: 0.0492s
Updating learning rate to 3.0149368578125e-06
Epoch: 8 cost time: 1.763216257095337
Epoch: 8, Steps: 514 | Train Loss: 0.4947750 Vali Loss: 0.3488187 Best vali loss: 0.3467639

best validation loss 0.3467639039740815

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022189693868, 'e_layers': 3, 'learning_rate': 0.0003967408578, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6231031
	speed: 0.0106s/iter; left time: 42.4314s
	iters: 200, epoch: 1 | loss: 0.6602241
	speed: 0.0043s/iter; left time: 16.9419s
	iters: 300, epoch: 1 | loss: 0.2832180
	speed: 0.0044s/iter; left time: 16.6957s
	iters: 400, epoch: 1 | loss: 0.5536771
	speed: 0.0044s/iter; left time: 16.3730s
	iters: 500, epoch: 1 | loss: 1.0677549
	speed: 0.0044s/iter; left time: 15.9866s
Updating learning rate to 0.0003967408578
Validation loss decreased (inf --> 0.3781).  Saving model state dict ...
Epoch: 1 cost time: 2.6093978881835938
Epoch: 1, Steps: 514 | Train Loss: 0.6375955 Vali Loss: 0.3780691 Best vali loss: 0.3780691
	iters: 100, epoch: 2 | loss: 0.3641364
	speed: 0.0091s/iter; left time: 31.9745s
	iters: 200, epoch: 2 | loss: 0.4679143
	speed: 0.0046s/iter; left time: 15.6264s
	iters: 300, epoch: 2 | loss: 0.3965968
	speed: 0.0046s/iter; left time: 15.0188s
	iters: 400, epoch: 2 | loss: 0.2880880
	speed: 0.0046s/iter; left time: 14.5739s
	iters: 500, epoch: 2 | loss: 0.2873676
	speed: 0.0045s/iter; left time: 13.9994s
Updating learning rate to 0.0001983704289
Validation loss decreased (0.3781 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 2.3859713077545166
Epoch: 2, Steps: 514 | Train Loss: 0.3608206 Vali Loss: 0.3703103 Best vali loss: 0.3703103
	iters: 100, epoch: 3 | loss: 0.3769464
	speed: 0.0089s/iter; left time: 26.6790s
	iters: 200, epoch: 3 | loss: 0.9516512
	speed: 0.0044s/iter; left time: 12.7909s
	iters: 300, epoch: 3 | loss: 0.6347132
	speed: 0.0044s/iter; left time: 12.1179s
	iters: 400, epoch: 3 | loss: 0.6438427
	speed: 0.0044s/iter; left time: 11.8874s
	iters: 500, epoch: 3 | loss: 0.3673340
	speed: 0.0045s/iter; left time: 11.5096s
Updating learning rate to 9.918521445e-05
Epoch: 3 cost time: 2.3014321327209473
Epoch: 3, Steps: 514 | Train Loss: 0.5948975 Vali Loss: 0.3795264 Best vali loss: 0.3703103
	iters: 100, epoch: 4 | loss: 1.0783583
	speed: 0.0086s/iter; left time: 21.2319s
	iters: 200, epoch: 4 | loss: 0.8710377
	speed: 0.0044s/iter; left time: 10.3922s
	iters: 300, epoch: 4 | loss: 0.4589953
	speed: 0.0040s/iter; left time: 9.1413s
	iters: 400, epoch: 4 | loss: 0.5306582
	speed: 0.0038s/iter; left time: 8.2818s
	iters: 500, epoch: 4 | loss: 0.6370866
	speed: 0.0040s/iter; left time: 8.3555s
Updating learning rate to 4.9592607225e-05
Validation loss decreased (0.3703 --> 0.3531).  Saving model state dict ...
Epoch: 4 cost time: 2.160271406173706
Epoch: 4, Steps: 514 | Train Loss: 0.7152272 Vali Loss: 0.3530748 Best vali loss: 0.3530748
	iters: 100, epoch: 5 | loss: 0.2157184
	speed: 0.0089s/iter; left time: 17.3406s
	iters: 200, epoch: 5 | loss: 0.2715926
	speed: 0.0044s/iter; left time: 8.1388s
	iters: 300, epoch: 5 | loss: 0.2927110
	speed: 0.0042s/iter; left time: 7.4493s
	iters: 400, epoch: 5 | loss: 0.5866495
	speed: 0.0043s/iter; left time: 7.1153s
	iters: 500, epoch: 5 | loss: 0.3733390
	speed: 0.0044s/iter; left time: 6.8492s
Updating learning rate to 2.47963036125e-05
Validation loss decreased (0.3531 --> 0.3416).  Saving model state dict ...
Epoch: 5 cost time: 2.260953187942505
Epoch: 5, Steps: 514 | Train Loss: 0.3480021 Vali Loss: 0.3416166 Best vali loss: 0.3416166
	iters: 100, epoch: 6 | loss: 0.4882713
	speed: 0.0088s/iter; left time: 12.6569s
	iters: 200, epoch: 6 | loss: 0.6049083
	speed: 0.0039s/iter; left time: 5.2317s
	iters: 300, epoch: 6 | loss: 0.4050269
	speed: 0.0040s/iter; left time: 4.9676s
	iters: 400, epoch: 6 | loss: 1.2787877
	speed: 0.0041s/iter; left time: 4.6403s
	iters: 500, epoch: 6 | loss: 0.6749750
	speed: 0.0041s/iter; left time: 4.2484s
Updating learning rate to 1.239815180625e-05
Epoch: 6 cost time: 2.1310603618621826
Epoch: 6, Steps: 514 | Train Loss: 0.6903938 Vali Loss: 0.3422330 Best vali loss: 0.3416166
	iters: 100, epoch: 7 | loss: 0.4779390
	speed: 0.0084s/iter; left time: 7.8232s
	iters: 200, epoch: 7 | loss: 0.5291288
	speed: 0.0040s/iter; left time: 3.3358s
	iters: 300, epoch: 7 | loss: 0.6379457
	speed: 0.0043s/iter; left time: 3.1241s
	iters: 400, epoch: 7 | loss: 0.6283074
	speed: 0.0042s/iter; left time: 2.6716s
	iters: 500, epoch: 7 | loss: 0.3589506
	speed: 0.0043s/iter; left time: 2.2936s
Updating learning rate to 6.199075903125e-06
Epoch: 7 cost time: 2.190728187561035
Epoch: 7, Steps: 514 | Train Loss: 0.5264543 Vali Loss: 0.3425738 Best vali loss: 0.3416166
	iters: 100, epoch: 8 | loss: 0.4762835
	speed: 0.0087s/iter; left time: 3.6279s
	iters: 200, epoch: 8 | loss: 0.3546432
	speed: 0.0043s/iter; left time: 1.3545s
	iters: 300, epoch: 8 | loss: 0.6369013
	speed: 0.0043s/iter; left time: 0.9171s
	iters: 400, epoch: 8 | loss: 0.4197018
	speed: 0.0042s/iter; left time: 0.4782s
	iters: 500, epoch: 8 | loss: 0.3970869
	speed: 0.0038s/iter; left time: 0.0576s
Updating learning rate to 3.0995379515625e-06
Validation loss decreased (0.3416 --> 0.3398).  Saving model state dict ...
Epoch: 8 cost time: 2.197902202606201
Epoch: 8, Steps: 514 | Train Loss: 0.4569233 Vali Loss: 0.3398034 Best vali loss: 0.3398034

best validation loss 0.33980337849768766

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021678299177, 'e_layers': 3, 'learning_rate': 0.0003965956527, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6231020
	speed: 0.0106s/iter; left time: 42.7355s
	iters: 200, epoch: 1 | loss: 0.6599736
	speed: 0.0045s/iter; left time: 17.5251s
	iters: 300, epoch: 1 | loss: 0.2860667
	speed: 0.0043s/iter; left time: 16.5779s
	iters: 400, epoch: 1 | loss: 0.5519645
	speed: 0.0044s/iter; left time: 16.4198s
	iters: 500, epoch: 1 | loss: 1.1124564
	speed: 0.0044s/iter; left time: 15.8353s
Updating learning rate to 0.0003965956527
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 2.6282269954681396
Epoch: 1, Steps: 514 | Train Loss: 0.6467127 Vali Loss: 0.3715659 Best vali loss: 0.3715659
	iters: 100, epoch: 2 | loss: 0.3519370
	speed: 0.0084s/iter; left time: 29.2377s
	iters: 200, epoch: 2 | loss: 0.4904834
	speed: 0.0044s/iter; left time: 14.9255s
	iters: 300, epoch: 2 | loss: 0.4211383
	speed: 0.0045s/iter; left time: 14.8082s
	iters: 400, epoch: 2 | loss: 0.3033434
	speed: 0.0045s/iter; left time: 14.4228s
	iters: 500, epoch: 2 | loss: 0.3085242
	speed: 0.0045s/iter; left time: 13.9280s
Updating learning rate to 0.00019829782635
Epoch: 2 cost time: 2.2879080772399902
Epoch: 2, Steps: 514 | Train Loss: 0.3750852 Vali Loss: 0.3782968 Best vali loss: 0.3715659
	iters: 100, epoch: 3 | loss: 0.3923798
	speed: 0.0087s/iter; left time: 26.0043s
	iters: 200, epoch: 3 | loss: 0.9951116
	speed: 0.0043s/iter; left time: 12.5327s
	iters: 300, epoch: 3 | loss: 0.6479900
	speed: 0.0043s/iter; left time: 11.8451s
	iters: 400, epoch: 3 | loss: 0.7084287
	speed: 0.0043s/iter; left time: 11.5198s
	iters: 500, epoch: 3 | loss: 0.4025661
	speed: 0.0043s/iter; left time: 11.1176s
Updating learning rate to 9.9148913175e-05
Validation loss decreased (0.3716 --> 0.3651).  Saving model state dict ...
Epoch: 3 cost time: 2.255460500717163
Epoch: 3, Steps: 514 | Train Loss: 0.6292952 Vali Loss: 0.3651263 Best vali loss: 0.3651263
	iters: 100, epoch: 4 | loss: 1.2307563
	speed: 0.0089s/iter; left time: 22.0611s
	iters: 200, epoch: 4 | loss: 0.9006833
	speed: 0.0043s/iter; left time: 10.1868s
	iters: 300, epoch: 4 | loss: 0.4961790
	speed: 0.0039s/iter; left time: 8.9009s
	iters: 400, epoch: 4 | loss: 0.5500227
	speed: 0.0039s/iter; left time: 8.5477s
	iters: 500, epoch: 4 | loss: 0.6372671
	speed: 0.0038s/iter; left time: 7.8692s
Updating learning rate to 4.95744565875e-05
Validation loss decreased (0.3651 --> 0.3473).  Saving model state dict ...
Epoch: 4 cost time: 2.120392084121704
Epoch: 4, Steps: 514 | Train Loss: 0.7629817 Vali Loss: 0.3473405 Best vali loss: 0.3473405
	iters: 100, epoch: 5 | loss: 0.2167957
	speed: 0.0089s/iter; left time: 17.4659s
	iters: 200, epoch: 5 | loss: 0.2779963
	speed: 0.0043s/iter; left time: 8.0097s
	iters: 300, epoch: 5 | loss: 0.2923005
	speed: 0.0042s/iter; left time: 7.2976s
	iters: 400, epoch: 5 | loss: 0.6041008
	speed: 0.0038s/iter; left time: 6.3378s
	iters: 500, epoch: 5 | loss: 0.4355487
	speed: 0.0037s/iter; left time: 5.8075s
Updating learning rate to 2.478722829375e-05
Validation loss decreased (0.3473 --> 0.3465).  Saving model state dict ...
Epoch: 5 cost time: 2.13576078414917
Epoch: 5, Steps: 514 | Train Loss: 0.3653484 Vali Loss: 0.3464817 Best vali loss: 0.3464817
	iters: 100, epoch: 6 | loss: 0.4895214
	speed: 0.0085s/iter; left time: 12.2580s
	iters: 200, epoch: 6 | loss: 0.6365325
	speed: 0.0039s/iter; left time: 5.2910s
	iters: 300, epoch: 6 | loss: 0.4326111
	speed: 0.0038s/iter; left time: 4.7734s
	iters: 400, epoch: 6 | loss: 1.3240640
	speed: 0.0039s/iter; left time: 4.4597s
	iters: 500, epoch: 6 | loss: 0.6589262
	speed: 0.0039s/iter; left time: 4.0235s
Updating learning rate to 1.2393614146875e-05
Validation loss decreased (0.3465 --> 0.3454).  Saving model state dict ...
Epoch: 6 cost time: 2.0523335933685303
Epoch: 6, Steps: 514 | Train Loss: 0.7083310 Vali Loss: 0.3453599 Best vali loss: 0.3453599
	iters: 100, epoch: 7 | loss: 0.4948727
	speed: 0.0086s/iter; left time: 7.9985s
	iters: 200, epoch: 7 | loss: 0.5766069
	speed: 0.0039s/iter; left time: 3.2270s
	iters: 300, epoch: 7 | loss: 0.6574625
	speed: 0.0040s/iter; left time: 2.8869s
	iters: 400, epoch: 7 | loss: 0.6988634
	speed: 0.0038s/iter; left time: 2.3659s
	iters: 500, epoch: 7 | loss: 0.3678913
	speed: 0.0039s/iter; left time: 2.0439s
Updating learning rate to 6.1968070734375e-06
Validation loss decreased (0.3454 --> 0.3443).  Saving model state dict ...
Epoch: 7 cost time: 2.0524892807006836
Epoch: 7, Steps: 514 | Train Loss: 0.5591394 Vali Loss: 0.3442766 Best vali loss: 0.3442766
	iters: 100, epoch: 8 | loss: 0.5342239
	speed: 0.0084s/iter; left time: 3.4720s
	iters: 200, epoch: 8 | loss: 0.3493313
	speed: 0.0040s/iter; left time: 1.2444s
	iters: 300, epoch: 8 | loss: 0.6475133
	speed: 0.0040s/iter; left time: 0.8533s
	iters: 400, epoch: 8 | loss: 0.4705425
	speed: 0.0039s/iter; left time: 0.4492s
	iters: 500, epoch: 8 | loss: 0.4265734
	speed: 0.0038s/iter; left time: 0.0568s
Updating learning rate to 3.09840353671875e-06
Validation loss decreased (0.3443 --> 0.3422).  Saving model state dict ...
Epoch: 8 cost time: 2.050583600997925
Epoch: 8, Steps: 514 | Train Loss: 0.4856369 Vali Loss: 0.3421920 Best vali loss: 0.3421920

best validation loss 0.34219202313769775

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0047182065791, 'e_layers': 4, 'learning_rate': 0.0015809877119, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6137916
	speed: 0.0116s/iter; left time: 10.8169s
Updating learning rate to 0.0015809877119
Validation loss decreased (inf --> 0.3917).  Saving model state dict ...
Epoch: 1 cost time: 1.0430700778961182
Epoch: 1, Steps: 129 | Train Loss: 0.6137916 Vali Loss: 0.3917434 Best vali loss: 0.3917434
	iters: 100, epoch: 2 | loss: 0.8936668
	speed: 0.0097s/iter; left time: 7.8341s
Updating learning rate to 0.00079049385595
Epoch: 2 cost time: 0.8104438781738281
Epoch: 2, Steps: 129 | Train Loss: 0.8936668 Vali Loss: 0.4026169 Best vali loss: 0.3917434
	iters: 100, epoch: 3 | loss: 0.8599159
	speed: 0.0093s/iter; left time: 6.3096s
Updating learning rate to 0.000395246927975
Epoch: 3 cost time: 0.7352793216705322
Epoch: 3, Steps: 129 | Train Loss: 0.8599159 Vali Loss: 0.4037832 Best vali loss: 0.3917434

best validation loss 0.3917434111091149

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021886067588, 'e_layers': 3, 'learning_rate': 0.0003999523306, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6229876
	speed: 0.0106s/iter; left time: 42.7238s
	iters: 200, epoch: 1 | loss: 0.6611887
	speed: 0.0044s/iter; left time: 17.2859s
	iters: 300, epoch: 1 | loss: 0.2858924
	speed: 0.0045s/iter; left time: 17.0421s
	iters: 400, epoch: 1 | loss: 0.5512655
	speed: 0.0044s/iter; left time: 16.2324s
	iters: 500, epoch: 1 | loss: 1.1081283
	speed: 0.0043s/iter; left time: 15.4901s
Updating learning rate to 0.0003999523306
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 2.6152966022491455
Epoch: 1, Steps: 514 | Train Loss: 0.6458925 Vali Loss: 0.3696921 Best vali loss: 0.3696921
	iters: 100, epoch: 2 | loss: 0.3596283
	speed: 0.0089s/iter; left time: 30.9833s
	iters: 200, epoch: 2 | loss: 0.4878094
	speed: 0.0043s/iter; left time: 14.6780s
	iters: 300, epoch: 2 | loss: 0.4132051
	speed: 0.0045s/iter; left time: 14.8196s
	iters: 400, epoch: 2 | loss: 0.2961394
	speed: 0.0044s/iter; left time: 13.9266s
	iters: 500, epoch: 2 | loss: 0.2628242
	speed: 0.0041s/iter; left time: 12.7186s
Updating learning rate to 0.0001999761653
Validation loss decreased (0.3697 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 2.2745087146759033
Epoch: 2, Steps: 514 | Train Loss: 0.3639213 Vali Loss: 0.3649071 Best vali loss: 0.3649071
	iters: 100, epoch: 3 | loss: 0.3559306
	speed: 0.0087s/iter; left time: 25.9221s
	iters: 200, epoch: 3 | loss: 0.9192241
	speed: 0.0037s/iter; left time: 10.6870s
	iters: 300, epoch: 3 | loss: 0.6208073
	speed: 0.0037s/iter; left time: 10.3122s
	iters: 400, epoch: 3 | loss: 0.6382571
	speed: 0.0040s/iter; left time: 10.6832s
	iters: 500, epoch: 3 | loss: 0.3631275
	speed: 0.0045s/iter; left time: 11.7589s
Updating learning rate to 9.998808265e-05
Epoch: 3 cost time: 2.083099842071533
Epoch: 3, Steps: 514 | Train Loss: 0.5794693 Vali Loss: 0.3675149 Best vali loss: 0.3649071

best validation loss 0.3649071403008781

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.00222323623, 'e_layers': 3, 'learning_rate': 0.0004054572669, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6228840
	speed: 0.0105s/iter; left time: 42.0508s
	iters: 200, epoch: 1 | loss: 0.6627387
	speed: 0.0039s/iter; left time: 15.2694s
	iters: 300, epoch: 1 | loss: 0.2833661
	speed: 0.0040s/iter; left time: 15.2427s
	iters: 400, epoch: 1 | loss: 0.5652086
	speed: 0.0042s/iter; left time: 15.7011s
	iters: 500, epoch: 1 | loss: 1.1059436
	speed: 0.0040s/iter; left time: 14.5276s
Updating learning rate to 0.0004054572669
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 2.4522061347961426
Epoch: 1, Steps: 514 | Train Loss: 0.6480282 Vali Loss: 0.3715137 Best vali loss: 0.3715137
	iters: 100, epoch: 2 | loss: 0.3600076
	speed: 0.0087s/iter; left time: 30.5512s
	iters: 200, epoch: 2 | loss: 0.4777916
	speed: 0.0042s/iter; left time: 14.3816s
	iters: 300, epoch: 2 | loss: 0.4064842
	speed: 0.0041s/iter; left time: 13.3898s
	iters: 400, epoch: 2 | loss: 0.2929634
	speed: 0.0041s/iter; left time: 13.0120s
	iters: 500, epoch: 2 | loss: 0.2950342
	speed: 0.0040s/iter; left time: 12.5252s
Updating learning rate to 0.00020272863345
Validation loss decreased (0.3715 --> 0.3685).  Saving model state dict ...
Epoch: 2 cost time: 2.154965400695801
Epoch: 2, Steps: 514 | Train Loss: 0.3664562 Vali Loss: 0.3685213 Best vali loss: 0.3685213
	iters: 100, epoch: 3 | loss: 0.3609097
	speed: 0.0087s/iter; left time: 25.9588s
	iters: 200, epoch: 3 | loss: 1.0077639
	speed: 0.0039s/iter; left time: 11.2318s
	iters: 300, epoch: 3 | loss: 0.4220589
	speed: 0.0040s/iter; left time: 11.2436s
	iters: 400, epoch: 3 | loss: 0.6858292
	speed: 0.0042s/iter; left time: 11.2018s
	iters: 500, epoch: 3 | loss: 0.3626970
	speed: 0.0039s/iter; left time: 10.1031s
Updating learning rate to 0.000101364316725
Epoch: 3 cost time: 2.112929105758667
Epoch: 3, Steps: 514 | Train Loss: 0.5678518 Vali Loss: 0.3713476 Best vali loss: 0.3685213

best validation loss 0.3685212671639643

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021886067588, 'e_layers': 3, 'learning_rate': 0.0003999523306, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5341036
	speed: 0.0107s/iter; left time: 26.4248s
	iters: 200, epoch: 4 | loss: 0.4904181
	speed: 0.0043s/iter; left time: 10.1762s
	iters: 300, epoch: 4 | loss: 0.2397945
	speed: 0.0043s/iter; left time: 9.6655s
	iters: 400, epoch: 4 | loss: 0.5262467
	speed: 0.0044s/iter; left time: 9.5509s
	iters: 500, epoch: 4 | loss: 0.8022138
	speed: 0.0042s/iter; left time: 8.7232s
Updating learning rate to 4.9994041325e-05
Validation loss decreased (0.3649 --> 0.3545).  Saving model state dict ...
Epoch: 4 cost time: 2.56502366065979
Epoch: 4, Steps: 514 | Train Loss: 0.5185553 Vali Loss: 0.3545113 Best vali loss: 0.3545113
	iters: 100, epoch: 5 | loss: 0.3078740
	speed: 0.0091s/iter; left time: 17.7338s
	iters: 200, epoch: 5 | loss: 0.3997115
	speed: 0.0043s/iter; left time: 7.9768s
	iters: 300, epoch: 5 | loss: 0.3787686
	speed: 0.0042s/iter; left time: 7.3074s
	iters: 400, epoch: 5 | loss: 0.2744911
	speed: 0.0042s/iter; left time: 6.9844s
	iters: 500, epoch: 5 | loss: 0.2735122
	speed: 0.0042s/iter; left time: 6.5310s
Updating learning rate to 2.49970206625e-05
Epoch: 5 cost time: 2.227987051010132
Epoch: 5, Steps: 514 | Train Loss: 0.3268715 Vali Loss: 0.3576527 Best vali loss: 0.3545113
	iters: 100, epoch: 6 | loss: 0.2881271
	speed: 0.0084s/iter; left time: 12.0781s
	iters: 200, epoch: 6 | loss: 0.6588077
	speed: 0.0039s/iter; left time: 5.2926s
	iters: 300, epoch: 6 | loss: 0.3433405
	speed: 0.0040s/iter; left time: 4.9752s
	iters: 400, epoch: 6 | loss: 0.5258638
	speed: 0.0041s/iter; left time: 4.6638s
	iters: 500, epoch: 6 | loss: 0.3193309
	speed: 0.0041s/iter; left time: 4.2574s
Updating learning rate to 1.249851033125e-05
Validation loss decreased (0.3545 --> 0.3533).  Saving model state dict ...
Epoch: 6 cost time: 2.113868236541748
Epoch: 6, Steps: 514 | Train Loss: 0.4270940 Vali Loss: 0.3533020 Best vali loss: 0.3533020
	iters: 100, epoch: 7 | loss: 0.8760777
	speed: 0.0086s/iter; left time: 8.0188s
	iters: 200, epoch: 7 | loss: 0.7839578
	speed: 0.0040s/iter; left time: 3.2773s
	iters: 300, epoch: 7 | loss: 0.4263587
	speed: 0.0041s/iter; left time: 3.0046s
	iters: 400, epoch: 7 | loss: 0.4663100
	speed: 0.0040s/iter; left time: 2.5145s
	iters: 500, epoch: 7 | loss: 0.6097751
	speed: 0.0041s/iter; left time: 2.1684s
Updating learning rate to 6.249255165625e-06
Epoch: 7 cost time: 2.1203505992889404
Epoch: 7, Steps: 514 | Train Loss: 0.6324959 Vali Loss: 0.3587314 Best vali loss: 0.3533020
	iters: 100, epoch: 8 | loss: 0.2194563
	speed: 0.0086s/iter; left time: 3.5881s
	iters: 200, epoch: 8 | loss: 0.2632564
	speed: 0.0044s/iter; left time: 1.3827s
	iters: 300, epoch: 8 | loss: 0.2748834
	speed: 0.0042s/iter; left time: 0.8994s
	iters: 400, epoch: 8 | loss: 0.5608852
	speed: 0.0040s/iter; left time: 0.4606s
	iters: 500, epoch: 8 | loss: 0.3562804
	speed: 0.0044s/iter; left time: 0.0662s
Updating learning rate to 3.1246275828125e-06
Validation loss decreased (0.3533 --> 0.3530).  Saving model state dict ...
Epoch: 8 cost time: 2.226811408996582
Epoch: 8, Steps: 514 | Train Loss: 0.3349523 Vali Loss: 0.3529664 Best vali loss: 0.3529664

best validation loss 0.3529664377917944

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 3, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6236325
	speed: 0.0104s/iter; left time: 41.8934s
	iters: 200, epoch: 1 | loss: 0.6556799
	speed: 0.0040s/iter; left time: 15.7657s
	iters: 300, epoch: 1 | loss: 0.2854361
	speed: 0.0040s/iter; left time: 15.1070s
	iters: 400, epoch: 1 | loss: 0.5483828
	speed: 0.0039s/iter; left time: 14.3617s
	iters: 500, epoch: 1 | loss: 1.0924010
	speed: 0.0039s/iter; left time: 13.9765s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 2.401113748550415
Epoch: 1, Steps: 514 | Train Loss: 0.6411065 Vali Loss: 0.3729355 Best vali loss: 0.3729355
	iters: 100, epoch: 2 | loss: 0.3708701
	speed: 0.0087s/iter; left time: 30.4215s
	iters: 200, epoch: 2 | loss: 0.4852909
	speed: 0.0040s/iter; left time: 13.5629s
	iters: 300, epoch: 2 | loss: 0.3957910
	speed: 0.0040s/iter; left time: 13.1082s
	iters: 400, epoch: 2 | loss: 0.2994953
	speed: 0.0040s/iter; left time: 12.8749s
	iters: 500, epoch: 2 | loss: 0.2882176
	speed: 0.0040s/iter; left time: 12.5078s
Updating learning rate to 0.0001911554003
Validation loss decreased (0.3729 --> 0.3702).  Saving model state dict ...
Epoch: 2 cost time: 2.1086137294769287
Epoch: 2, Steps: 514 | Train Loss: 0.3679330 Vali Loss: 0.3701976 Best vali loss: 0.3701976
	iters: 100, epoch: 3 | loss: 0.3616367
	speed: 0.0090s/iter; left time: 26.9620s
	iters: 200, epoch: 3 | loss: 0.9031720
	speed: 0.0044s/iter; left time: 12.8234s
	iters: 300, epoch: 3 | loss: 0.4068912
	speed: 0.0044s/iter; left time: 12.3703s
	iters: 400, epoch: 3 | loss: 0.6574586
	speed: 0.0044s/iter; left time: 11.8723s
	iters: 500, epoch: 3 | loss: 0.3504173
	speed: 0.0043s/iter; left time: 11.1326s
Updating learning rate to 9.557770015e-05
Validation loss decreased (0.3702 --> 0.3583).  Saving model state dict ...
Epoch: 3 cost time: 2.3135461807250977
Epoch: 3, Steps: 514 | Train Loss: 0.5359151 Vali Loss: 0.3583266 Best vali loss: 0.3583266
	iters: 100, epoch: 4 | loss: 1.1000339
	speed: 0.0087s/iter; left time: 21.4120s
	iters: 200, epoch: 4 | loss: 0.8725827
	speed: 0.0040s/iter; left time: 9.5311s
	iters: 300, epoch: 4 | loss: 0.4429872
	speed: 0.0040s/iter; left time: 9.1708s
	iters: 400, epoch: 4 | loss: 0.5549626
	speed: 0.0041s/iter; left time: 8.8214s
	iters: 500, epoch: 4 | loss: 0.6269870
	speed: 0.0043s/iter; left time: 8.9085s
Updating learning rate to 4.7788850075e-05
Validation loss decreased (0.3583 --> 0.3486).  Saving model state dict ...
Epoch: 4 cost time: 2.1637823581695557
Epoch: 4, Steps: 514 | Train Loss: 0.7195107 Vali Loss: 0.3485901 Best vali loss: 0.3485901
	iters: 100, epoch: 5 | loss: 0.2169116
	speed: 0.0087s/iter; left time: 17.0892s
	iters: 200, epoch: 5 | loss: 0.2751060
	speed: 0.0044s/iter; left time: 8.1808s
	iters: 300, epoch: 5 | loss: 0.2743992
	speed: 0.0043s/iter; left time: 7.5303s
	iters: 400, epoch: 5 | loss: 0.5837603
	speed: 0.0043s/iter; left time: 7.1262s
	iters: 500, epoch: 5 | loss: 0.3821671
	speed: 0.0043s/iter; left time: 6.6365s
Updating learning rate to 2.38944250375e-05
Validation loss decreased (0.3486 --> 0.3455).  Saving model state dict ...
Epoch: 5 cost time: 2.2457375526428223
Epoch: 5, Steps: 514 | Train Loss: 0.3464688 Vali Loss: 0.3455343 Best vali loss: 0.3455343
	iters: 100, epoch: 6 | loss: 0.4835711
	speed: 0.0087s/iter; left time: 12.6169s
	iters: 200, epoch: 6 | loss: 0.5893030
	speed: 0.0043s/iter; left time: 5.7256s
	iters: 300, epoch: 6 | loss: 0.3966438
	speed: 0.0044s/iter; left time: 5.5152s
	iters: 400, epoch: 6 | loss: 1.2738799
	speed: 0.0044s/iter; left time: 5.0614s
	iters: 500, epoch: 6 | loss: 0.6750811
	speed: 0.0044s/iter; left time: 4.5834s
Updating learning rate to 1.194721251875e-05
Epoch: 6 cost time: 2.2934651374816895
Epoch: 6, Steps: 514 | Train Loss: 0.6836958 Vali Loss: 0.3470677 Best vali loss: 0.3455343
	iters: 100, epoch: 7 | loss: 0.4791219
	speed: 0.0086s/iter; left time: 7.9880s
	iters: 200, epoch: 7 | loss: 0.5334051
	speed: 0.0044s/iter; left time: 3.6614s
	iters: 300, epoch: 7 | loss: 0.6398357
	speed: 0.0042s/iter; left time: 3.0344s
	iters: 400, epoch: 7 | loss: 0.6168546
	speed: 0.0042s/iter; left time: 2.6394s
	iters: 500, epoch: 7 | loss: 0.3641994
	speed: 0.0041s/iter; left time: 2.1863s
Updating learning rate to 5.973606259375e-06
Epoch: 7 cost time: 2.225472927093506
Epoch: 7, Steps: 514 | Train Loss: 0.5266833 Vali Loss: 0.3510348 Best vali loss: 0.3455343
	iters: 100, epoch: 8 | loss: 0.4885233
	speed: 0.0089s/iter; left time: 3.6759s
	iters: 200, epoch: 8 | loss: 0.3485850
	speed: 0.0044s/iter; left time: 1.3927s
	iters: 300, epoch: 8 | loss: 0.6401603
	speed: 0.0043s/iter; left time: 0.9261s
	iters: 400, epoch: 8 | loss: 0.4264433
	speed: 0.0044s/iter; left time: 0.5067s
	iters: 500, epoch: 8 | loss: 0.3984544
	speed: 0.0044s/iter; left time: 0.0657s
Updating learning rate to 2.9868031296875e-06
Epoch: 8 cost time: 2.305384635925293
Epoch: 8, Steps: 514 | Train Loss: 0.4604332 Vali Loss: 0.3475824 Best vali loss: 0.3455343

best validation loss 0.345534343686694

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 4, 'learning_rate': 0.0003285815379, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4846765
	speed: 0.0157s/iter; left time: 14.6800s
Updating learning rate to 0.0003285815379
Validation loss decreased (inf --> 0.3843).  Saving model state dict ...
Epoch: 1 cost time: 1.5979692935943604
Epoch: 1, Steps: 129 | Train Loss: 0.4846765 Vali Loss: 0.3842810 Best vali loss: 0.3842810
	iters: 100, epoch: 2 | loss: 0.6109440
	speed: 0.0156s/iter; left time: 12.5356s
Updating learning rate to 0.00016429076895
Validation loss decreased (0.3843 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 1.288243055343628
Epoch: 2, Steps: 129 | Train Loss: 0.6109440 Vali Loss: 0.3650071 Best vali loss: 0.3650071
	iters: 100, epoch: 3 | loss: 0.6836742
	speed: 0.0160s/iter; left time: 10.7957s
Updating learning rate to 8.2145384475e-05
Validation loss decreased (0.3650 --> 0.3456).  Saving model state dict ...
Epoch: 3 cost time: 1.2847373485565186
Epoch: 3, Steps: 129 | Train Loss: 0.6836742 Vali Loss: 0.3456200 Best vali loss: 0.3456200
	iters: 100, epoch: 4 | loss: 0.6679628
	speed: 0.0158s/iter; left time: 8.6371s
Updating learning rate to 4.10726922375e-05
Epoch: 4 cost time: 1.28977370262146
Epoch: 4, Steps: 129 | Train Loss: 0.6679628 Vali Loss: 0.3518399 Best vali loss: 0.3456200
	iters: 100, epoch: 5 | loss: 0.4619279
	speed: 0.0152s/iter; left time: 6.3541s
Updating learning rate to 2.053634611875e-05
Epoch: 5 cost time: 1.2948567867279053
Epoch: 5, Steps: 129 | Train Loss: 0.4619279 Vali Loss: 0.3479515 Best vali loss: 0.3456200
	iters: 100, epoch: 6 | loss: 0.3508042
	speed: 0.0153s/iter; left time: 4.3993s
Updating learning rate to 1.0268173059375e-05
Epoch: 6 cost time: 1.2978603839874268
Epoch: 6, Steps: 129 | Train Loss: 0.3508042 Vali Loss: 0.3464020 Best vali loss: 0.3456200
	iters: 100, epoch: 7 | loss: 0.3829222
	speed: 0.0152s/iter; left time: 2.4141s
Updating learning rate to 5.1340865296875e-06
Validation loss decreased (0.3456 --> 0.3441).  Saving model state dict ...
Epoch: 7 cost time: 1.2895135879516602
Epoch: 7, Steps: 129 | Train Loss: 0.3829222 Vali Loss: 0.3441383 Best vali loss: 0.3441383
	iters: 100, epoch: 8 | loss: 0.4773694
	speed: 0.0158s/iter; left time: 0.4734s
Updating learning rate to 2.56704326484375e-06
Validation loss decreased (0.3441 --> 0.3433).  Saving model state dict ...
Epoch: 8 cost time: 1.2904484272003174
Epoch: 8, Steps: 129 | Train Loss: 0.4773694 Vali Loss: 0.3432706 Best vali loss: 0.3432706

best validation loss 0.34327063819280074

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022171412589, 'e_layers': 2, 'learning_rate': 0.0004288980483, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4278470
	speed: 0.0095s/iter; left time: 38.3032s
	iters: 200, epoch: 1 | loss: 1.0793649
	speed: 0.0032s/iter; left time: 12.4549s
	iters: 300, epoch: 1 | loss: 1.0117974
	speed: 0.0031s/iter; left time: 11.7658s
	iters: 400, epoch: 1 | loss: 0.5055400
	speed: 0.0030s/iter; left time: 11.2381s
	iters: 500, epoch: 1 | loss: 1.1780909
	speed: 0.0030s/iter; left time: 10.7685s
Updating learning rate to 0.0004288980483
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 1.9574882984161377
Epoch: 1, Steps: 514 | Train Loss: 0.8405280 Vali Loss: 0.3720529 Best vali loss: 0.3720529
	iters: 100, epoch: 2 | loss: 0.3996728
	speed: 0.0068s/iter; left time: 23.6651s
	iters: 200, epoch: 2 | loss: 0.2622147
	speed: 0.0029s/iter; left time: 9.9868s
	iters: 300, epoch: 2 | loss: 0.6069233
	speed: 0.0031s/iter; left time: 10.1194s
	iters: 400, epoch: 2 | loss: 0.4019341
	speed: 0.0031s/iter; left time: 9.8056s
	iters: 500, epoch: 2 | loss: 0.6363745
	speed: 0.0031s/iter; left time: 9.5082s
Updating learning rate to 0.00021444902415
Epoch: 2 cost time: 1.5975594520568848
Epoch: 2, Steps: 514 | Train Loss: 0.4614239 Vali Loss: 0.3818004 Best vali loss: 0.3720529
	iters: 100, epoch: 3 | loss: 0.3449162
	speed: 0.0072s/iter; left time: 21.5201s
	iters: 200, epoch: 3 | loss: 0.8976159
	speed: 0.0036s/iter; left time: 10.3010s
	iters: 300, epoch: 3 | loss: 0.5154545
	speed: 0.0034s/iter; left time: 9.5995s
	iters: 400, epoch: 3 | loss: 0.4599795
	speed: 0.0036s/iter; left time: 9.6757s
	iters: 500, epoch: 3 | loss: 1.1318876
	speed: 0.0036s/iter; left time: 9.2026s
Updating learning rate to 0.000107224512075
Validation loss decreased (0.3721 --> 0.3519).  Saving model state dict ...
Epoch: 3 cost time: 1.8449673652648926
Epoch: 3, Steps: 514 | Train Loss: 0.6699707 Vali Loss: 0.3519173 Best vali loss: 0.3519173

best validation loss 0.35191728429382113

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0099605900722, 'e_layers': 2, 'learning_rate': 0.0003978522946, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4267206
	speed: 0.0098s/iter; left time: 39.2120s
	iters: 200, epoch: 1 | loss: 1.0790145
	speed: 0.0034s/iter; left time: 13.3934s
	iters: 300, epoch: 1 | loss: 1.0143270
	speed: 0.0035s/iter; left time: 13.5236s
	iters: 400, epoch: 1 | loss: 0.5040200
	speed: 0.0035s/iter; left time: 12.8684s
	iters: 500, epoch: 1 | loss: 1.1437565
	speed: 0.0036s/iter; left time: 12.9880s
Updating learning rate to 0.0003978522946
Validation loss decreased (inf --> 0.3730).  Saving model state dict ...
Epoch: 1 cost time: 2.1437554359436035
Epoch: 1, Steps: 514 | Train Loss: 0.8335677 Vali Loss: 0.3730051 Best vali loss: 0.3730051
	iters: 100, epoch: 2 | loss: 0.3987481
	speed: 0.0072s/iter; left time: 25.2766s
	iters: 200, epoch: 2 | loss: 0.2579409
	speed: 0.0030s/iter; left time: 10.3499s
	iters: 300, epoch: 2 | loss: 0.5092040
	speed: 0.0030s/iter; left time: 9.9179s
	iters: 400, epoch: 2 | loss: 0.3857411
	speed: 0.0033s/iter; left time: 10.6337s
	iters: 500, epoch: 2 | loss: 0.6385030
	speed: 0.0031s/iter; left time: 9.5924s
Updating learning rate to 0.0001989261473
Validation loss decreased (0.3730 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 1.6484756469726562
Epoch: 2, Steps: 514 | Train Loss: 0.4380274 Vali Loss: 0.3667437 Best vali loss: 0.3667437
	iters: 100, epoch: 3 | loss: 0.3523857
	speed: 0.0072s/iter; left time: 21.4395s
	iters: 200, epoch: 3 | loss: 0.8897424
	speed: 0.0030s/iter; left time: 8.7448s
	iters: 300, epoch: 3 | loss: 0.5014411
	speed: 0.0031s/iter; left time: 8.6692s
	iters: 400, epoch: 3 | loss: 0.4718579
	speed: 0.0031s/iter; left time: 8.4422s
	iters: 500, epoch: 3 | loss: 1.0503864
	speed: 0.0032s/iter; left time: 8.1636s
Updating learning rate to 9.946307365e-05
Validation loss decreased (0.3667 --> 0.3578).  Saving model state dict ...
Epoch: 3 cost time: 1.650740623474121
Epoch: 3, Steps: 514 | Train Loss: 0.6531627 Vali Loss: 0.3578104 Best vali loss: 0.3578104

best validation loss 0.35781044887419067

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.112285852432251
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672623 Best vali loss: 0.3672623
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3673 --> 0.3661).  Saving model state dict ...
Epoch: 2 cost time: 0.7928040027618408
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3660654 Best vali loss: 0.3660654
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3661 --> 0.3494).  Saving model state dict ...
Epoch: 3 cost time: 0.7925221920013428
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3493849 Best vali loss: 0.3493849

best validation loss 0.3493849223863868

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.83781510125e-05
Validation loss decreased (0.3494 --> 0.3383).  Saving model state dict ...
Epoch: 4 cost time: 1.1169703006744385
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3383016 Best vali loss: 0.3383016
Updating learning rate to 4.418907550625e-05
Epoch: 5 cost time: 0.7921328544616699
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3424514 Best vali loss: 0.3383016
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.7921829223632812
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3393795 Best vali loss: 0.3383016
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.7936601638793945
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3418609 Best vali loss: 0.3383016
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.7958543300628662
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3421590 Best vali loss: 0.3383016

best validation loss 0.3383015634737221

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0099169414216, 'e_layers': 2, 'learning_rate': 0.0003995406451, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4267584
	speed: 0.0093s/iter; left time: 37.1423s
	iters: 200, epoch: 1 | loss: 1.0792760
	speed: 0.0032s/iter; left time: 12.3590s
	iters: 300, epoch: 1 | loss: 1.0146955
	speed: 0.0032s/iter; left time: 12.1887s
	iters: 400, epoch: 1 | loss: 0.5050656
	speed: 0.0031s/iter; left time: 11.4960s
	iters: 500, epoch: 1 | loss: 1.1408339
	speed: 0.0031s/iter; left time: 11.2063s
Updating learning rate to 0.0003995406451
Validation loss decreased (inf --> 0.3738).  Saving model state dict ...
Epoch: 1 cost time: 1.9584696292877197
Epoch: 1, Steps: 514 | Train Loss: 0.8333259 Vali Loss: 0.3738286 Best vali loss: 0.3738286
	iters: 100, epoch: 2 | loss: 0.3917460
	speed: 0.0075s/iter; left time: 26.1479s
	iters: 200, epoch: 2 | loss: 0.2873365
	speed: 0.0034s/iter; left time: 11.4415s
	iters: 300, epoch: 2 | loss: 0.5089492
	speed: 0.0033s/iter; left time: 10.7642s
	iters: 400, epoch: 2 | loss: 0.3938884
	speed: 0.0032s/iter; left time: 10.2303s
	iters: 500, epoch: 2 | loss: 0.6140471
	speed: 0.0032s/iter; left time: 9.9892s
Updating learning rate to 0.00019977032255
Validation loss decreased (0.3738 --> 0.3646).  Saving model state dict ...
Epoch: 2 cost time: 1.7539863586425781
Epoch: 2, Steps: 514 | Train Loss: 0.4391934 Vali Loss: 0.3646175 Best vali loss: 0.3646175
	iters: 100, epoch: 3 | loss: 0.3889343
	speed: 0.0076s/iter; left time: 22.7561s
	iters: 200, epoch: 3 | loss: 0.8748453
	speed: 0.0035s/iter; left time: 10.1584s
	iters: 300, epoch: 3 | loss: 0.4969631
	speed: 0.0036s/iter; left time: 9.9969s
	iters: 400, epoch: 3 | loss: 0.4712590
	speed: 0.0035s/iter; left time: 9.5149s
	iters: 500, epoch: 3 | loss: 1.0745322
	speed: 0.0035s/iter; left time: 9.1751s
Updating learning rate to 9.9885161275e-05
Validation loss decreased (0.3646 --> 0.3534).  Saving model state dict ...
Epoch: 3 cost time: 1.8648889064788818
Epoch: 3, Steps: 514 | Train Loss: 0.6613068 Vali Loss: 0.3534173 Best vali loss: 0.3534173
	iters: 100, epoch: 4 | loss: 0.5569027
	speed: 0.0078s/iter; left time: 19.2221s
	iters: 200, epoch: 4 | loss: 0.4456022
	speed: 0.0036s/iter; left time: 8.5974s
	iters: 300, epoch: 4 | loss: 0.5068089
	speed: 0.0036s/iter; left time: 8.2387s
	iters: 400, epoch: 4 | loss: 0.6983808
	speed: 0.0036s/iter; left time: 7.8353s
	iters: 500, epoch: 4 | loss: 0.7125435
	speed: 0.0035s/iter; left time: 7.2259s
Updating learning rate to 4.99425806375e-05
Validation loss decreased (0.3534 --> 0.3457).  Saving model state dict ...
Epoch: 4 cost time: 1.8737461566925049
Epoch: 4, Steps: 514 | Train Loss: 0.5840476 Vali Loss: 0.3457070 Best vali loss: 0.3457070
	iters: 100, epoch: 5 | loss: 0.5462824
	speed: 0.0072s/iter; left time: 14.1482s
	iters: 200, epoch: 5 | loss: 0.7552180
	speed: 0.0035s/iter; left time: 6.4193s
	iters: 300, epoch: 5 | loss: 0.4994843
	speed: 0.0037s/iter; left time: 6.4391s
	iters: 400, epoch: 5 | loss: 0.8162127
	speed: 0.0033s/iter; left time: 5.4860s
	iters: 500, epoch: 5 | loss: 0.5469963
	speed: 0.0033s/iter; left time: 5.1343s
Updating learning rate to 2.497129031875e-05
Epoch: 5 cost time: 1.7959821224212646
Epoch: 5, Steps: 514 | Train Loss: 0.6328387 Vali Loss: 0.3470826 Best vali loss: 0.3457070
	iters: 100, epoch: 6 | loss: 0.2950267
	speed: 0.0071s/iter; left time: 10.2813s
	iters: 200, epoch: 6 | loss: 0.4892795
	speed: 0.0032s/iter; left time: 4.3350s
	iters: 300, epoch: 6 | loss: 0.3726343
	speed: 0.0033s/iter; left time: 4.0872s
	iters: 400, epoch: 6 | loss: 0.7563309
	speed: 0.0032s/iter; left time: 3.7027s
	iters: 500, epoch: 6 | loss: 0.9686037
	speed: 0.0032s/iter; left time: 3.3632s
Updating learning rate to 1.2485645159375e-05
Validation loss decreased (0.3457 --> 0.3428).  Saving model state dict ...
Epoch: 6 cost time: 1.714350938796997
Epoch: 6, Steps: 514 | Train Loss: 0.5763750 Vali Loss: 0.3427729 Best vali loss: 0.3427729
	iters: 100, epoch: 7 | loss: 0.3878909
	speed: 0.0074s/iter; left time: 6.8954s
	iters: 200, epoch: 7 | loss: 0.2943632
	speed: 0.0031s/iter; left time: 2.5752s
	iters: 300, epoch: 7 | loss: 0.3740321
	speed: 0.0031s/iter; left time: 2.2366s
	iters: 400, epoch: 7 | loss: 0.3944050
	speed: 0.0031s/iter; left time: 1.9550s
	iters: 500, epoch: 7 | loss: 0.7776012
	speed: 0.0032s/iter; left time: 1.6768s
Updating learning rate to 6.2428225796875e-06
Validation loss decreased (0.3428 --> 0.3427).  Saving model state dict ...
Epoch: 7 cost time: 1.6586670875549316
Epoch: 7, Steps: 514 | Train Loss: 0.4456585 Vali Loss: 0.3426937 Best vali loss: 0.3426937
	iters: 100, epoch: 8 | loss: 0.3653219
	speed: 0.0074s/iter; left time: 3.0538s
	iters: 200, epoch: 8 | loss: 0.2267779
	speed: 0.0032s/iter; left time: 0.9993s
	iters: 300, epoch: 8 | loss: 0.3621115
	speed: 0.0032s/iter; left time: 0.6960s
	iters: 400, epoch: 8 | loss: 0.4282929
	speed: 0.0032s/iter; left time: 0.3657s
	iters: 500, epoch: 8 | loss: 0.2350590
	speed: 0.0032s/iter; left time: 0.0474s
Updating learning rate to 3.12141128984375e-06
Validation loss decreased (0.3427 --> 0.3423).  Saving model state dict ...
Epoch: 8 cost time: 1.6903066635131836
Epoch: 8, Steps: 514 | Train Loss: 0.3235127 Vali Loss: 0.3422805 Best vali loss: 0.3422805

best validation loss 0.3422804779587185

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022186881679, 'e_layers': 4, 'learning_rate': 0.0003979537897, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4461257
	speed: 0.0116s/iter; left time: 22.6769s
	iters: 200, epoch: 1 | loss: 0.4218978
	speed: 0.0052s/iter; left time: 9.6317s
Updating learning rate to 0.0003979537897
Validation loss decreased (inf --> 0.3762).  Saving model state dict ...
Epoch: 1 cost time: 1.7093212604522705
Epoch: 1, Steps: 257 | Train Loss: 0.4340117 Vali Loss: 0.3761501 Best vali loss: 0.3761501
	iters: 100, epoch: 2 | loss: 0.7942199
	speed: 0.0110s/iter; left time: 18.7162s
	iters: 200, epoch: 2 | loss: 0.4557457
	speed: 0.0055s/iter; left time: 8.7259s
Updating learning rate to 0.00019897689485
Epoch: 2 cost time: 1.4391067028045654
Epoch: 2, Steps: 257 | Train Loss: 0.6249828 Vali Loss: 0.3846997 Best vali loss: 0.3761501
	iters: 100, epoch: 3 | loss: 0.5089928
	speed: 0.0113s/iter; left time: 16.3424s
	iters: 200, epoch: 3 | loss: 0.5023952
	speed: 0.0051s/iter; left time: 6.7831s
Updating learning rate to 9.9488447425e-05
Epoch: 3 cost time: 1.3788530826568604
Epoch: 3, Steps: 257 | Train Loss: 0.5056940 Vali Loss: 0.3763950 Best vali loss: 0.3761501
	iters: 100, epoch: 4 | loss: 0.6632524
	speed: 0.0110s/iter; left time: 13.0725s
	iters: 200, epoch: 4 | loss: 0.2380427
	speed: 0.0054s/iter; left time: 5.9185s
Updating learning rate to 4.97442237125e-05
Validation loss decreased (0.3762 --> 0.3461).  Saving model state dict ...
Epoch: 4 cost time: 1.4288711547851562
Epoch: 4, Steps: 257 | Train Loss: 0.4506475 Vali Loss: 0.3461262 Best vali loss: 0.3461262
	iters: 100, epoch: 5 | loss: 0.6196406
	speed: 0.0114s/iter; left time: 10.5548s
	iters: 200, epoch: 5 | loss: 0.6485581
	speed: 0.0056s/iter; left time: 4.6028s
Updating learning rate to 2.487211185625e-05
Validation loss decreased (0.3461 --> 0.3456).  Saving model state dict ...
Epoch: 5 cost time: 1.4676456451416016
Epoch: 5, Steps: 257 | Train Loss: 0.6340994 Vali Loss: 0.3456492 Best vali loss: 0.3456492
	iters: 100, epoch: 6 | loss: 0.4890755
	speed: 0.0116s/iter; left time: 7.7665s
	iters: 200, epoch: 6 | loss: 0.5220752
	speed: 0.0054s/iter; left time: 3.0860s
Updating learning rate to 1.2436055928125e-05
Validation loss decreased (0.3456 --> 0.3414).  Saving model state dict ...
Epoch: 6 cost time: 1.4109139442443848
Epoch: 6, Steps: 257 | Train Loss: 0.5055754 Vali Loss: 0.3414150 Best vali loss: 0.3414150
	iters: 100, epoch: 7 | loss: 0.3952375
	speed: 0.0109s/iter; left time: 4.5211s
	iters: 200, epoch: 7 | loss: 0.4991117
	speed: 0.0049s/iter; left time: 1.5563s
Updating learning rate to 6.2180279640625e-06
Epoch: 7 cost time: 1.3339354991912842
Epoch: 7, Steps: 257 | Train Loss: 0.4471746 Vali Loss: 0.3441711 Best vali loss: 0.3414150
	iters: 100, epoch: 8 | loss: 0.4047798
	speed: 0.0102s/iter; left time: 1.6115s
	iters: 200, epoch: 8 | loss: 0.4647131
	speed: 0.0048s/iter; left time: 0.2792s
Updating learning rate to 3.10901398203125e-06
Validation loss decreased (0.3414 --> 0.3414).  Saving model state dict ...
Epoch: 8 cost time: 1.2848386764526367
Epoch: 8, Steps: 257 | Train Loss: 0.4347464 Vali Loss: 0.3413804 Best vali loss: 0.3413804

best validation loss 0.3413804007068364

[INFO][smbo.py:320] Finished 1050 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.007776199615, 'e_layers': 2, 'learning_rate': 0.0003925772477, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4264758
	speed: 0.0097s/iter; left time: 38.9102s
	iters: 200, epoch: 1 | loss: 1.0782801
	speed: 0.0036s/iter; left time: 14.0635s
	iters: 300, epoch: 1 | loss: 1.0160056
	speed: 0.0036s/iter; left time: 13.6309s
	iters: 400, epoch: 1 | loss: 0.5039389
	speed: 0.0035s/iter; left time: 13.1160s
	iters: 500, epoch: 1 | loss: 1.1160955
	speed: 0.0034s/iter; left time: 12.1512s
Updating learning rate to 0.0003925772477
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.156879186630249
Epoch: 1, Steps: 514 | Train Loss: 0.8281592 Vali Loss: 0.3748425 Best vali loss: 0.3748425
	iters: 100, epoch: 2 | loss: 0.3893382
	speed: 0.0077s/iter; left time: 26.8127s
	iters: 200, epoch: 2 | loss: 0.2627656
	speed: 0.0034s/iter; left time: 11.6998s
	iters: 300, epoch: 2 | loss: 0.4961341
	speed: 0.0034s/iter; left time: 11.2150s
	iters: 400, epoch: 2 | loss: 0.3886834
	speed: 0.0036s/iter; left time: 11.3613s
	iters: 500, epoch: 2 | loss: 0.6056915
	speed: 0.0036s/iter; left time: 11.0499s
Updating learning rate to 0.00019628862385
Epoch: 2 cost time: 1.8401856422424316
Epoch: 2, Steps: 514 | Train Loss: 0.4285226 Vali Loss: 0.3755635 Best vali loss: 0.3748425
	iters: 100, epoch: 3 | loss: 0.3630100
	speed: 0.0074s/iter; left time: 22.0367s
	iters: 200, epoch: 3 | loss: 0.9013818
	speed: 0.0036s/iter; left time: 10.3241s
	iters: 300, epoch: 3 | loss: 0.5100436
	speed: 0.0036s/iter; left time: 10.0587s
	iters: 400, epoch: 3 | loss: 0.4663134
	speed: 0.0036s/iter; left time: 9.5930s
	iters: 500, epoch: 3 | loss: 1.0418631
	speed: 0.0035s/iter; left time: 9.1520s
Updating learning rate to 9.8144311925e-05
Validation loss decreased (0.3748 --> 0.3544).  Saving model state dict ...
Epoch: 3 cost time: 1.8679718971252441
Epoch: 3, Steps: 514 | Train Loss: 0.6565224 Vali Loss: 0.3543745 Best vali loss: 0.3543745

best validation loss 0.35437454137446134

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050509423521, 'e_layers': 2, 'learning_rate': 0.0021122411501, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0021122411501
Validation loss decreased (inf --> 0.3745).  Saving model state dict ...
Epoch: 1 cost time: 0.6824328899383545
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3745013 Best vali loss: 0.3745013
Updating learning rate to 0.00105612057505
Validation loss decreased (0.3745 --> 0.3723).  Saving model state dict ...
Epoch: 2 cost time: 0.34357738494873047
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3722850 Best vali loss: 0.3722850
Updating learning rate to 0.000528060287525
Epoch: 3 cost time: 0.3705899715423584
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3760955 Best vali loss: 0.3722850

best validation loss 0.3722849794712891

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042727375319, 'e_layers': 4, 'learning_rate': 0.0006626559512, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006626559512
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 1.0896317958831787
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3682786 Best vali loss: 0.3682786
Updating learning rate to 0.0003313279756
Validation loss decreased (0.3683 --> 0.3529).  Saving model state dict ...
Epoch: 2 cost time: 0.7848091125488281
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3528668 Best vali loss: 0.3528668
Updating learning rate to 0.0001656639878
Epoch: 3 cost time: 0.7789015769958496
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3537517 Best vali loss: 0.3528668

best validation loss 0.35286681682515475

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042727375319, 'e_layers': 4, 'learning_rate': 0.0006626559512, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.28319939e-05
Epoch: 4 cost time: 1.0988879203796387
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3554832 Best vali loss: 0.3528668
Updating learning rate to 4.141599695e-05
Epoch: 5 cost time: 0.7769675254821777
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3529547 Best vali loss: 0.3528668
Updating learning rate to 2.0707998475e-05
Validation loss decreased (0.3529 --> 0.3466).  Saving model state dict ...
Epoch: 6 cost time: 0.7780792713165283
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3465582 Best vali loss: 0.3465582
Updating learning rate to 1.03539992375e-05
Validation loss decreased (0.3466 --> 0.3452).  Saving model state dict ...
Epoch: 7 cost time: 0.784980058670044
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3451975 Best vali loss: 0.3451975
Updating learning rate to 5.17699961875e-06
Epoch: 8 cost time: 0.7847416400909424
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3474068 Best vali loss: 0.3451975

best validation loss 0.3451975224294456

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.002216027541, 'e_layers': 4, 'learning_rate': 0.0004189603888, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4450654
	speed: 0.0114s/iter; left time: 22.3751s
	iters: 200, epoch: 1 | loss: 0.4225122
	speed: 0.0054s/iter; left time: 10.0390s
Updating learning rate to 0.0004189603888
Validation loss decreased (inf --> 0.3759).  Saving model state dict ...
Epoch: 1 cost time: 1.7002272605895996
Epoch: 1, Steps: 257 | Train Loss: 0.4337888 Vali Loss: 0.3758982 Best vali loss: 0.3758982
	iters: 100, epoch: 2 | loss: 0.8402852
	speed: 0.0106s/iter; left time: 17.9618s
	iters: 200, epoch: 2 | loss: 0.4349974
	speed: 0.0047s/iter; left time: 7.5576s
Updating learning rate to 0.0002094801944
Validation loss decreased (0.3759 --> 0.3746).  Saving model state dict ...
Epoch: 2 cost time: 1.281137466430664
Epoch: 2, Steps: 257 | Train Loss: 0.6376413 Vali Loss: 0.3745708 Best vali loss: 0.3745708
	iters: 100, epoch: 3 | loss: 0.4911936
	speed: 0.0105s/iter; left time: 15.1630s
	iters: 200, epoch: 3 | loss: 0.4967603
	speed: 0.0049s/iter; left time: 6.5164s
Updating learning rate to 0.0001047400972
Validation loss decreased (0.3746 --> 0.3575).  Saving model state dict ...
Epoch: 3 cost time: 1.3063910007476807
Epoch: 3, Steps: 257 | Train Loss: 0.4939770 Vali Loss: 0.3574681 Best vali loss: 0.3574681
	iters: 100, epoch: 4 | loss: 0.6389818
	speed: 0.0107s/iter; left time: 12.6460s
	iters: 200, epoch: 4 | loss: 0.2336143
	speed: 0.0050s/iter; left time: 5.4527s
Updating learning rate to 5.23700486e-05
Validation loss decreased (0.3575 --> 0.3565).  Saving model state dict ...
Epoch: 4 cost time: 1.326113224029541
Epoch: 4, Steps: 257 | Train Loss: 0.4362980 Vali Loss: 0.3565472 Best vali loss: 0.3565472
	iters: 100, epoch: 5 | loss: 0.6110889
	speed: 0.0106s/iter; left time: 9.8034s
	iters: 200, epoch: 5 | loss: 0.6369033
	speed: 0.0047s/iter; left time: 3.8918s
Updating learning rate to 2.61850243e-05
Validation loss decreased (0.3565 --> 0.3459).  Saving model state dict ...
Epoch: 5 cost time: 1.252638816833496
Epoch: 5, Steps: 257 | Train Loss: 0.6239961 Vali Loss: 0.3459220 Best vali loss: 0.3459220
	iters: 100, epoch: 6 | loss: 0.4748465
	speed: 0.0103s/iter; left time: 6.9274s
	iters: 200, epoch: 6 | loss: 0.5096122
	speed: 0.0050s/iter; left time: 2.8572s
Updating learning rate to 1.309251215e-05
Validation loss decreased (0.3459 --> 0.3409).  Saving model state dict ...
Epoch: 6 cost time: 1.3078413009643555
Epoch: 6, Steps: 257 | Train Loss: 0.4922294 Vali Loss: 0.3408920 Best vali loss: 0.3408920
	iters: 100, epoch: 7 | loss: 0.3834471
	speed: 0.0106s/iter; left time: 4.4112s
	iters: 200, epoch: 7 | loss: 0.4736277
	speed: 0.0048s/iter; left time: 1.5075s
Updating learning rate to 6.546256075e-06
Epoch: 7 cost time: 1.28125
Epoch: 7, Steps: 257 | Train Loss: 0.4285374 Vali Loss: 0.3440562 Best vali loss: 0.3408920
	iters: 100, epoch: 8 | loss: 0.3962841
	speed: 0.0099s/iter; left time: 1.5625s
	iters: 200, epoch: 8 | loss: 0.4514962
	speed: 0.0047s/iter; left time: 0.2751s
Updating learning rate to 3.2731280375e-06
Epoch: 8 cost time: 1.2626152038574219
Epoch: 8, Steps: 257 | Train Loss: 0.4238902 Vali Loss: 0.3453499 Best vali loss: 0.3408920

best validation loss 0.34089199083258925

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.1160547733306885
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672285 Best vali loss: 0.3672285
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7986247539520264
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3683256 Best vali loss: 0.3672285
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7974929809570312
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3765783 Best vali loss: 0.3672285
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3672 --> 0.3471).  Saving model state dict ...
Epoch: 4 cost time: 0.7948391437530518
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3470682 Best vali loss: 0.3470682
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3471 --> 0.3397).  Saving model state dict ...
Epoch: 5 cost time: 0.7894065380096436
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3397370 Best vali loss: 0.3397370
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7958667278289795
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3475157 Best vali loss: 0.3397370
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.794687032699585
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3614056 Best vali loss: 0.3397370
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7932333946228027
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3604259 Best vali loss: 0.3397370

best validation loss 0.3397369638407394

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3803).  Saving model state dict ...
Epoch: 1 cost time: 1.2504494190216064
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3803379 Best vali loss: 0.3803379
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3803 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 0.951392412185669
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3703369 Best vali loss: 0.3703369
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 0.9536504745483398
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3740299 Best vali loss: 0.3703369

best validation loss 0.3703368696693353

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0097682979981, 'e_layers': 3, 'learning_rate': 0.0003958094006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6239030
	speed: 0.0103s/iter; left time: 41.2206s
	iters: 200, epoch: 1 | loss: 0.6589279
	speed: 0.0042s/iter; left time: 16.3678s
	iters: 300, epoch: 1 | loss: 0.2847489
	speed: 0.0039s/iter; left time: 15.0234s
	iters: 400, epoch: 1 | loss: 0.5553333
	speed: 0.0040s/iter; left time: 14.9522s
	iters: 500, epoch: 1 | loss: 1.0771059
	speed: 0.0041s/iter; left time: 14.7210s
Updating learning rate to 0.0003958094006
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 2.445751190185547
Epoch: 1, Steps: 514 | Train Loss: 0.6400038 Vali Loss: 0.3710632 Best vali loss: 0.3710632
	iters: 100, epoch: 2 | loss: 0.3610342
	speed: 0.0088s/iter; left time: 30.9619s
	iters: 200, epoch: 2 | loss: 0.4835726
	speed: 0.0044s/iter; left time: 14.9130s
	iters: 300, epoch: 2 | loss: 0.4086777
	speed: 0.0044s/iter; left time: 14.5941s
	iters: 400, epoch: 2 | loss: 0.2887303
	speed: 0.0043s/iter; left time: 13.8103s
	iters: 500, epoch: 2 | loss: 0.2843059
	speed: 0.0041s/iter; left time: 12.6464s
Updating learning rate to 0.0001979047003
Epoch: 2 cost time: 2.2621073722839355
Epoch: 2, Steps: 514 | Train Loss: 0.3652641 Vali Loss: 0.3744120 Best vali loss: 0.3710632
	iters: 100, epoch: 3 | loss: 0.3565174
	speed: 0.0086s/iter; left time: 25.6096s
	iters: 200, epoch: 3 | loss: 1.0561230
	speed: 0.0042s/iter; left time: 12.1972s
	iters: 300, epoch: 3 | loss: 0.4181723
	speed: 0.0043s/iter; left time: 12.0480s
	iters: 400, epoch: 3 | loss: 0.6827261
	speed: 0.0043s/iter; left time: 11.6020s
	iters: 500, epoch: 3 | loss: 0.3786223
	speed: 0.0044s/iter; left time: 11.3283s
Updating learning rate to 9.895235015e-05
Epoch: 3 cost time: 2.259868621826172
Epoch: 3, Steps: 514 | Train Loss: 0.5784322 Vali Loss: 0.3766569 Best vali loss: 0.3710632

best validation loss 0.3710631642688234

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0025392949525, 'e_layers': 3, 'learning_rate': 0.000161840578, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7457682
	speed: 0.0104s/iter; left time: 41.8108s
	iters: 200, epoch: 1 | loss: 1.0101579
	speed: 0.0042s/iter; left time: 16.5946s
	iters: 300, epoch: 1 | loss: 0.2682585
	speed: 0.0043s/iter; left time: 16.3466s
	iters: 400, epoch: 1 | loss: 1.1228447
	speed: 0.0043s/iter; left time: 16.0102s
	iters: 500, epoch: 1 | loss: 1.1038034
	speed: 0.0042s/iter; left time: 15.3129s
Updating learning rate to 0.00015568088777199822
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 2.5509140491485596
Epoch: 1, Steps: 514 | Train Loss: 0.8501666 Vali Loss: 0.3657582 Best vali loss: 0.3657582
	iters: 100, epoch: 2 | loss: 0.3398477
	speed: 0.0087s/iter; left time: 30.4755s
	iters: 200, epoch: 2 | loss: 0.6650330
	speed: 0.0044s/iter; left time: 15.0315s
	iters: 300, epoch: 2 | loss: 0.3762957
	speed: 0.0042s/iter; left time: 13.9116s
	iters: 400, epoch: 2 | loss: 0.3769740
	speed: 0.0042s/iter; left time: 13.5347s
	iters: 500, epoch: 2 | loss: 0.7409922
	speed: 0.0043s/iter; left time: 13.2978s
Updating learning rate to 0.0001381395740874752
Epoch: 2 cost time: 2.2467808723449707
Epoch: 2, Steps: 514 | Train Loss: 0.4998285 Vali Loss: 0.3667660 Best vali loss: 0.3657582
	iters: 100, epoch: 3 | loss: 0.7424609
	speed: 0.0086s/iter; left time: 25.6666s
	iters: 200, epoch: 3 | loss: 0.4787724
	speed: 0.0040s/iter; left time: 11.4770s
	iters: 300, epoch: 3 | loss: 0.4174008
	speed: 0.0039s/iter; left time: 10.9698s
	iters: 400, epoch: 3 | loss: 0.3631274
	speed: 0.0039s/iter; left time: 10.5005s
	iters: 500, epoch: 3 | loss: 0.6567135
	speed: 0.0040s/iter; left time: 10.3458s
Updating learning rate to 0.00011188714294249502
Epoch: 3 cost time: 2.0868968963623047
Epoch: 3, Steps: 514 | Train Loss: 0.5316950 Vali Loss: 0.3695874 Best vali loss: 0.3657582

best validation loss 0.36575823423904613

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0025392949525, 'e_layers': 3, 'learning_rate': 0.000161840578, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5360513
	speed: 0.0107s/iter; left time: 26.3274s
	iters: 200, epoch: 4 | loss: 0.7743855
	speed: 0.0043s/iter; left time: 10.0862s
	iters: 300, epoch: 4 | loss: 0.2560208
	speed: 0.0043s/iter; left time: 9.8019s
	iters: 400, epoch: 4 | loss: 0.9874004
	speed: 0.0044s/iter; left time: 9.5342s
	iters: 500, epoch: 4 | loss: 0.9830071
	speed: 0.0045s/iter; left time: 9.2257s
Updating learning rate to 8.0920289e-05
Validation loss decreased (0.3658 --> 0.3638).  Saving model state dict ...
Epoch: 4 cost time: 2.5833957195281982
Epoch: 4, Steps: 514 | Train Loss: 0.7073730 Vali Loss: 0.3637630 Best vali loss: 0.3637630
	iters: 100, epoch: 5 | loss: 0.2960104
	speed: 0.0092s/iter; left time: 17.9675s
	iters: 200, epoch: 5 | loss: 0.5547704
	speed: 0.0045s/iter; left time: 8.2662s
	iters: 300, epoch: 5 | loss: 0.3405965
	speed: 0.0044s/iter; left time: 7.7263s
	iters: 400, epoch: 5 | loss: 0.3514967
	speed: 0.0044s/iter; left time: 7.2502s
	iters: 500, epoch: 5 | loss: 0.4967836
	speed: 0.0044s/iter; left time: 6.8263s
Updating learning rate to 4.995343505750499e-05
Validation loss decreased (0.3638 --> 0.3553).  Saving model state dict ...
Epoch: 5 cost time: 2.312619686126709
Epoch: 5, Steps: 514 | Train Loss: 0.4079315 Vali Loss: 0.3552947 Best vali loss: 0.3552947
	iters: 100, epoch: 6 | loss: 0.6083415
	speed: 0.0090s/iter; left time: 12.9387s
	iters: 200, epoch: 6 | loss: 0.3237938
	speed: 0.0042s/iter; left time: 5.6520s
	iters: 300, epoch: 6 | loss: 0.3827344
	speed: 0.0042s/iter; left time: 5.2062s
	iters: 400, epoch: 6 | loss: 0.3274202
	speed: 0.0042s/iter; left time: 4.7686s
	iters: 500, epoch: 6 | loss: 0.5742726
	speed: 0.0042s/iter; left time: 4.3496s
Updating learning rate to 2.3701003912524817e-05
Epoch: 6 cost time: 2.1985890865325928
Epoch: 6, Steps: 514 | Train Loss: 0.4433125 Vali Loss: 0.3627211 Best vali loss: 0.3552947
	iters: 100, epoch: 7 | loss: 0.3741961
	speed: 0.0077s/iter; left time: 7.1609s
	iters: 200, epoch: 7 | loss: 0.2956074
	speed: 0.0038s/iter; left time: 3.1753s
	iters: 300, epoch: 7 | loss: 0.7514167
	speed: 0.0037s/iter; left time: 2.6745s
	iters: 400, epoch: 7 | loss: 0.4134907
	speed: 0.0037s/iter; left time: 2.3076s
	iters: 500, epoch: 7 | loss: 0.4300848
	speed: 0.0038s/iter; left time: 2.0336s
Updating learning rate to 6.1596902280017815e-06
Epoch: 7 cost time: 1.9602198600769043
Epoch: 7, Steps: 514 | Train Loss: 0.4529592 Vali Loss: 0.3588665 Best vali loss: 0.3552947
	iters: 100, epoch: 8 | loss: 0.6592122
	speed: 0.0080s/iter; left time: 3.3331s
	iters: 200, epoch: 8 | loss: 0.2835343
	speed: 0.0037s/iter; left time: 1.1716s
	iters: 300, epoch: 8 | loss: 0.3905225
	speed: 0.0037s/iter; left time: 0.7985s
	iters: 400, epoch: 8 | loss: 0.4262058
	speed: 0.0039s/iter; left time: 0.4496s
	iters: 500, epoch: 8 | loss: 0.2431731
	speed: 0.0038s/iter; left time: 0.0575s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.00762939453125
Epoch: 8, Steps: 514 | Train Loss: 0.4005296 Vali Loss: 0.3610023 Best vali loss: 0.3552947

best validation loss 0.35529474717928994

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0036990191645, 'e_layers': 3, 'learning_rate': 0.000470589755, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9674008
	speed: 0.0106s/iter; left time: 42.6262s
	iters: 200, epoch: 1 | loss: 0.5455049
	speed: 0.0042s/iter; left time: 16.3362s
	iters: 300, epoch: 1 | loss: 0.9932994
	speed: 0.0043s/iter; left time: 16.5058s
	iters: 400, epoch: 1 | loss: 0.8654113
	speed: 0.0045s/iter; left time: 16.5369s
	iters: 500, epoch: 1 | loss: 0.8839368
	speed: 0.0043s/iter; left time: 15.6648s
Updating learning rate to 0.000470589755
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 2.5948050022125244
Epoch: 1, Steps: 514 | Train Loss: 0.8511106 Vali Loss: 0.3707405 Best vali loss: 0.3707405
	iters: 100, epoch: 2 | loss: 0.7901610
	speed: 0.0089s/iter; left time: 31.1638s
	iters: 200, epoch: 2 | loss: 0.4382005
	speed: 0.0044s/iter; left time: 14.8815s
	iters: 300, epoch: 2 | loss: 1.1373476
	speed: 0.0043s/iter; left time: 14.2318s
	iters: 400, epoch: 2 | loss: 0.8607720
	speed: 0.0041s/iter; left time: 13.2709s
	iters: 500, epoch: 2 | loss: 1.0338734
	speed: 0.0040s/iter; left time: 12.3977s
Updating learning rate to 0.0002352948775
Validation loss decreased (0.3707 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 2.227933645248413
Epoch: 2, Steps: 514 | Train Loss: 0.8520709 Vali Loss: 0.3702840 Best vali loss: 0.3702840
	iters: 100, epoch: 3 | loss: 0.7858740
	speed: 0.0090s/iter; left time: 26.8048s
	iters: 200, epoch: 3 | loss: 0.6299521
	speed: 0.0043s/iter; left time: 12.3800s
	iters: 300, epoch: 3 | loss: 0.3081881
	speed: 0.0043s/iter; left time: 12.0572s
	iters: 400, epoch: 3 | loss: 0.5839183
	speed: 0.0044s/iter; left time: 11.8908s
	iters: 500, epoch: 3 | loss: 0.9037491
	speed: 0.0044s/iter; left time: 11.2489s
Updating learning rate to 0.00011764743875
Validation loss decreased (0.3703 --> 0.3652).  Saving model state dict ...
Epoch: 3 cost time: 2.2725462913513184
Epoch: 3, Steps: 514 | Train Loss: 0.6423363 Vali Loss: 0.3651527 Best vali loss: 0.3651527
	iters: 100, epoch: 4 | loss: 0.5569576
	speed: 0.0088s/iter; left time: 21.7194s
	iters: 200, epoch: 4 | loss: 0.5477864
	speed: 0.0043s/iter; left time: 10.1267s
	iters: 300, epoch: 4 | loss: 0.4254963
	speed: 0.0044s/iter; left time: 9.9128s
	iters: 400, epoch: 4 | loss: 0.5532684
	speed: 0.0041s/iter; left time: 8.9865s
	iters: 500, epoch: 4 | loss: 0.6326222
	speed: 0.0039s/iter; left time: 8.0174s
Updating learning rate to 5.8823719375e-05
Validation loss decreased (0.3652 --> 0.3618).  Saving model state dict ...
Epoch: 4 cost time: 2.179443359375
Epoch: 4, Steps: 514 | Train Loss: 0.5432262 Vali Loss: 0.3617716 Best vali loss: 0.3617716
	iters: 100, epoch: 5 | loss: 0.3974570
	speed: 0.0091s/iter; left time: 17.8515s
	iters: 200, epoch: 5 | loss: 0.3668624
	speed: 0.0045s/iter; left time: 8.3486s
	iters: 300, epoch: 5 | loss: 0.2916708
	speed: 0.0045s/iter; left time: 7.8848s
	iters: 400, epoch: 5 | loss: 0.6571285
	speed: 0.0045s/iter; left time: 7.4394s
	iters: 500, epoch: 5 | loss: 0.5719362
	speed: 0.0041s/iter; left time: 6.3803s
Updating learning rate to 2.94118596875e-05
Validation loss decreased (0.3618 --> 0.3551).  Saving model state dict ...
Epoch: 5 cost time: 2.3015527725219727
Epoch: 5, Steps: 514 | Train Loss: 0.4570110 Vali Loss: 0.3551055 Best vali loss: 0.3551055
	iters: 100, epoch: 6 | loss: 0.3587520
	speed: 0.0082s/iter; left time: 11.8676s
	iters: 200, epoch: 6 | loss: 0.8184087
	speed: 0.0039s/iter; left time: 5.2650s
	iters: 300, epoch: 6 | loss: 0.3370671
	speed: 0.0039s/iter; left time: 4.8587s
	iters: 400, epoch: 6 | loss: 0.2750009
	speed: 0.0038s/iter; left time: 4.3849s
	iters: 500, epoch: 6 | loss: 0.5309387
	speed: 0.0038s/iter; left time: 3.9677s
Updating learning rate to 1.470592984375e-05
Validation loss decreased (0.3551 --> 0.3492).  Saving model state dict ...
Epoch: 6 cost time: 2.0400631427764893
Epoch: 6, Steps: 514 | Train Loss: 0.4640335 Vali Loss: 0.3491686 Best vali loss: 0.3491686
	iters: 100, epoch: 7 | loss: 0.3150810
	speed: 0.0085s/iter; left time: 7.9107s
	iters: 200, epoch: 7 | loss: 0.4611404
	speed: 0.0037s/iter; left time: 3.1016s
	iters: 300, epoch: 7 | loss: 0.6228784
	speed: 0.0037s/iter; left time: 2.7267s
	iters: 400, epoch: 7 | loss: 0.5728978
	speed: 0.0040s/iter; left time: 2.5109s
	iters: 500, epoch: 7 | loss: 0.3236524
	speed: 0.0039s/iter; left time: 2.0846s
Updating learning rate to 7.352964921875e-06
Validation loss decreased (0.3492 --> 0.3476).  Saving model state dict ...
Epoch: 7 cost time: 2.035203456878662
Epoch: 7, Steps: 514 | Train Loss: 0.4591300 Vali Loss: 0.3475600 Best vali loss: 0.3475600
	iters: 100, epoch: 8 | loss: 0.3201425
	speed: 0.0081s/iter; left time: 3.3726s
	iters: 200, epoch: 8 | loss: 0.7915314
	speed: 0.0040s/iter; left time: 1.2480s
	iters: 300, epoch: 8 | loss: 0.5087478
	speed: 0.0039s/iter; left time: 0.8466s
	iters: 400, epoch: 8 | loss: 0.6100824
	speed: 0.0036s/iter; left time: 0.4192s
	iters: 500, epoch: 8 | loss: 0.4741450
	speed: 0.0036s/iter; left time: 0.0547s
Updating learning rate to 3.6764824609375e-06
Epoch: 8 cost time: 1.9892246723175049
Epoch: 8, Steps: 514 | Train Loss: 0.5409298 Vali Loss: 0.3487667 Best vali loss: 0.3475600

best validation loss 0.34756001081822663

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020881059308, 'e_layers': 4, 'learning_rate': 0.0007391967633, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007391967633
Validation loss decreased (inf --> 0.3723).  Saving model state dict ...
Epoch: 1 cost time: 1.1083827018737793
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3722771 Best vali loss: 0.3722771
Updating learning rate to 0.00036959838165
Epoch: 2 cost time: 0.7932720184326172
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3801681 Best vali loss: 0.3722771
Updating learning rate to 0.000184799190825
Validation loss decreased (0.3723 --> 0.3659).  Saving model state dict ...
Epoch: 3 cost time: 0.7863037586212158
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3658745 Best vali loss: 0.3658745
Updating learning rate to 9.23995954125e-05
Validation loss decreased (0.3659 --> 0.3571).  Saving model state dict ...
Epoch: 4 cost time: 0.7886030673980713
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3570525 Best vali loss: 0.3570525
Updating learning rate to 4.619979770625e-05
Validation loss decreased (0.3571 --> 0.3473).  Saving model state dict ...
Epoch: 5 cost time: 0.792034387588501
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3473296 Best vali loss: 0.3473296
Updating learning rate to 2.3099898853125e-05
Epoch: 6 cost time: 0.7921559810638428
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3486874 Best vali loss: 0.3473296
Updating learning rate to 1.15499494265625e-05
Epoch: 7 cost time: 0.794539213180542
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3495818 Best vali loss: 0.3473296
Updating learning rate to 5.77497471328125e-06
Epoch: 8 cost time: 0.7907118797302246
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3508053 Best vali loss: 0.3473296

best validation loss 0.34732959569086025

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020882461951, 'e_layers': 4, 'learning_rate': 0.000741816794, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000741816794
Validation loss decreased (inf --> 0.3718).  Saving model state dict ...
Epoch: 1 cost time: 1.1127345561981201
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3718098 Best vali loss: 0.3718098
Updating learning rate to 0.000370908397
Validation loss decreased (0.3718 --> 0.3714).  Saving model state dict ...
Epoch: 2 cost time: 0.7912845611572266
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3714402 Best vali loss: 0.3714402
Updating learning rate to 0.0001854541985
Validation loss decreased (0.3714 --> 0.3711).  Saving model state dict ...
Epoch: 3 cost time: 0.7908720970153809
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3711064 Best vali loss: 0.3711064

best validation loss 0.37110636658190743

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0065274325259, 'e_layers': 4, 'learning_rate': 0.0004703762386, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8413649
	speed: 0.0137s/iter; left time: 26.8234s
	iters: 200, epoch: 1 | loss: 0.7378733
	speed: 0.0073s/iter; left time: 13.6326s
Updating learning rate to 0.0004703762386
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 2.23903751373291
Epoch: 1, Steps: 257 | Train Loss: 0.7896191 Vali Loss: 0.3800160 Best vali loss: 0.3800160
	iters: 100, epoch: 2 | loss: 0.8412760
	speed: 0.0152s/iter; left time: 25.9074s
	iters: 200, epoch: 2 | loss: 0.4017706
	speed: 0.0074s/iter; left time: 11.7664s
Updating learning rate to 0.0002351881193
Epoch: 2 cost time: 1.9160540103912354
Epoch: 2, Steps: 257 | Train Loss: 0.6215233 Vali Loss: 0.3970449 Best vali loss: 0.3800160
	iters: 100, epoch: 3 | loss: 0.3880661
	speed: 0.0149s/iter; left time: 21.5283s
	iters: 200, epoch: 3 | loss: 0.5085727
	speed: 0.0073s/iter; left time: 9.7985s
Updating learning rate to 0.00011759405965
Validation loss decreased (0.3800 --> 0.3752).  Saving model state dict ...
Epoch: 3 cost time: 1.9133374691009521
Epoch: 3, Steps: 257 | Train Loss: 0.4483194 Vali Loss: 0.3751982 Best vali loss: 0.3751982

best validation loss 0.3751982235955349

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0108293046627, 'e_layers': 1, 'learning_rate': 0.0043964554262, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3341427
	speed: 0.0087s/iter; left time: 35.0690s
	iters: 200, epoch: 1 | loss: 0.3859456
	speed: 0.0025s/iter; left time: 9.7231s
	iters: 300, epoch: 1 | loss: 0.9843839
	speed: 0.0025s/iter; left time: 9.5916s
	iters: 400, epoch: 1 | loss: 0.4906929
	speed: 0.0024s/iter; left time: 9.0472s
	iters: 500, epoch: 1 | loss: 0.3366135
	speed: 0.0024s/iter; left time: 8.7004s
Updating learning rate to 0.0043964554262
Validation loss decreased (inf --> 0.4052).  Saving model state dict ...
Epoch: 1 cost time: 1.6116726398468018
Epoch: 1, Steps: 514 | Train Loss: 0.5063557 Vali Loss: 0.4051827 Best vali loss: 0.4051827
	iters: 100, epoch: 2 | loss: 0.7257996
	speed: 0.0061s/iter; left time: 21.2663s
	iters: 200, epoch: 2 | loss: 0.5499909
	speed: 0.0027s/iter; left time: 9.0732s
	iters: 300, epoch: 2 | loss: 0.8499589
	speed: 0.0026s/iter; left time: 8.5434s
	iters: 400, epoch: 2 | loss: 0.5057871
	speed: 0.0024s/iter; left time: 7.6893s
	iters: 500, epoch: 2 | loss: 0.2729142
	speed: 0.0024s/iter; left time: 7.2924s
Updating learning rate to 0.0021982277131
Epoch: 2 cost time: 1.3394849300384521
Epoch: 2, Steps: 514 | Train Loss: 0.5808901 Vali Loss: 0.4164268 Best vali loss: 0.4051827
	iters: 100, epoch: 3 | loss: 0.3859586
	speed: 0.0059s/iter; left time: 17.5892s
	iters: 200, epoch: 3 | loss: 0.5884323
	speed: 0.0025s/iter; left time: 7.2914s
	iters: 300, epoch: 3 | loss: 0.4111803
	speed: 0.0025s/iter; left time: 7.0407s
	iters: 400, epoch: 3 | loss: 0.3079585
	speed: 0.0024s/iter; left time: 6.4157s
	iters: 500, epoch: 3 | loss: 0.3799736
	speed: 0.0025s/iter; left time: 6.3519s
Updating learning rate to 0.00109911385655
Validation loss decreased (0.4052 --> 0.3892).  Saving model state dict ...
Epoch: 3 cost time: 1.3200170993804932
Epoch: 3, Steps: 514 | Train Loss: 0.4147007 Vali Loss: 0.3891675 Best vali loss: 0.3891675

best validation loss 0.38916750965980274

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020882461951, 'e_layers': 4, 'learning_rate': 0.000741816794, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 9.272709925e-05
Validation loss decreased (0.3711 --> 0.3668).  Saving model state dict ...
Epoch: 4 cost time: 1.100031852722168
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3667511 Best vali loss: 0.3667511
Updating learning rate to 4.6363549625e-05
Epoch: 5 cost time: 0.7903480529785156
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3715320 Best vali loss: 0.3667511
Updating learning rate to 2.31817748125e-05
Validation loss decreased (0.3668 --> 0.3622).  Saving model state dict ...
Epoch: 6 cost time: 0.7943117618560791
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3622362 Best vali loss: 0.3622362
Updating learning rate to 1.159088740625e-05
Validation loss decreased (0.3622 --> 0.3616).  Saving model state dict ...
Epoch: 7 cost time: 0.7882981300354004
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3615529 Best vali loss: 0.3615529
Updating learning rate to 5.795443703125e-06
Epoch: 8 cost time: 0.7901642322540283
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3622205 Best vali loss: 0.3615529

best validation loss 0.36155288232333066

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0074631786607, 'e_layers': 4, 'learning_rate': 0.0003934701538, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5796158
	speed: 0.0113s/iter; left time: 91.8903s
	iters: 200, epoch: 1 | loss: 0.8422280
	speed: 0.0052s/iter; left time: 42.0631s
	iters: 300, epoch: 1 | loss: 0.3194529
	speed: 0.0052s/iter; left time: 41.4477s
	iters: 400, epoch: 1 | loss: 0.4974256
	speed: 0.0052s/iter; left time: 40.5093s
	iters: 500, epoch: 1 | loss: 0.2557600
	speed: 0.0051s/iter; left time: 39.4506s
	iters: 600, epoch: 1 | loss: 1.0843017
	speed: 0.0052s/iter; left time: 39.7363s
	iters: 700, epoch: 1 | loss: 0.2869720
	speed: 0.0052s/iter; left time: 39.2845s
	iters: 800, epoch: 1 | loss: 2.0155776
	speed: 0.0052s/iter; left time: 38.2632s
	iters: 900, epoch: 1 | loss: 0.6989257
	speed: 0.0052s/iter; left time: 38.2138s
	iters: 1000, epoch: 1 | loss: 0.5676611
	speed: 0.0053s/iter; left time: 37.9275s
Updating learning rate to 0.0003934701538
Validation loss decreased (inf --> 0.3758).  Saving model state dict ...
Epoch: 1 cost time: 5.697443008422852
Epoch: 1, Steps: 1027 | Train Loss: 0.7147920 Vali Loss: 0.3757865 Best vali loss: 0.3757865
	iters: 100, epoch: 2 | loss: 0.3150599
	speed: 0.0128s/iter; left time: 91.0246s
	iters: 200, epoch: 2 | loss: 1.2872183
	speed: 0.0048s/iter; left time: 33.3720s
	iters: 300, epoch: 2 | loss: 0.2307217
	speed: 0.0048s/iter; left time: 33.1791s
	iters: 400, epoch: 2 | loss: 0.2771334
	speed: 0.0048s/iter; left time: 32.7362s
	iters: 500, epoch: 2 | loss: 1.2437367
	speed: 0.0048s/iter; left time: 32.2264s
	iters: 600, epoch: 2 | loss: 1.3296025
	speed: 0.0048s/iter; left time: 31.6896s
	iters: 700, epoch: 2 | loss: 0.7100493
	speed: 0.0048s/iter; left time: 31.2186s
	iters: 800, epoch: 2 | loss: 0.2989482
	speed: 0.0048s/iter; left time: 30.4836s
	iters: 900, epoch: 2 | loss: 0.6006663
	speed: 0.0048s/iter; left time: 30.3608s
	iters: 1000, epoch: 2 | loss: 0.2430745
	speed: 0.0048s/iter; left time: 29.5451s
Updating learning rate to 0.0001967350769
Epoch: 2 cost time: 4.9572248458862305
Epoch: 2, Steps: 1027 | Train Loss: 0.6536211 Vali Loss: 0.3862990 Best vali loss: 0.3757865
	iters: 100, epoch: 3 | loss: 0.3838639
	speed: 0.0124s/iter; left time: 75.4657s
	iters: 200, epoch: 3 | loss: 0.5696720
	speed: 0.0047s/iter; left time: 27.9252s
	iters: 300, epoch: 3 | loss: 0.6954457
	speed: 0.0047s/iter; left time: 27.7246s
	iters: 400, epoch: 3 | loss: 0.6206720
	speed: 0.0046s/iter; left time: 26.5752s
	iters: 500, epoch: 3 | loss: 0.5021567
	speed: 0.0047s/iter; left time: 26.3858s
	iters: 600, epoch: 3 | loss: 0.8121821
	speed: 0.0048s/iter; left time: 26.6122s
	iters: 700, epoch: 3 | loss: 0.9652282
	speed: 0.0048s/iter; left time: 26.1165s
	iters: 800, epoch: 3 | loss: 1.1058774
	speed: 0.0048s/iter; left time: 25.6581s
	iters: 900, epoch: 3 | loss: 0.9061074
	speed: 0.0048s/iter; left time: 25.1124s
	iters: 1000, epoch: 3 | loss: 1.1772287
	speed: 0.0048s/iter; left time: 24.8072s
Updating learning rate to 9.836753845e-05
Epoch: 3 cost time: 4.905395746231079
Epoch: 3, Steps: 1027 | Train Loss: 0.7738434 Vali Loss: 0.3828723 Best vali loss: 0.3757865
	iters: 100, epoch: 4 | loss: 0.2586303
	speed: 0.0123s/iter; left time: 61.9747s
	iters: 200, epoch: 4 | loss: 0.5824767
	speed: 0.0046s/iter; left time: 22.8525s
	iters: 300, epoch: 4 | loss: 1.1743078
	speed: 0.0048s/iter; left time: 23.2449s
	iters: 400, epoch: 4 | loss: 0.8029196
	speed: 0.0048s/iter; left time: 22.9142s
	iters: 500, epoch: 4 | loss: 0.7653071
	speed: 0.0049s/iter; left time: 22.5102s
	iters: 600, epoch: 4 | loss: 1.1845865
	speed: 0.0048s/iter; left time: 21.9455s
	iters: 700, epoch: 4 | loss: 0.7075770
	speed: 0.0044s/iter; left time: 19.7299s
	iters: 800, epoch: 4 | loss: 0.2554751
	speed: 0.0043s/iter; left time: 18.8607s
	iters: 900, epoch: 4 | loss: 0.2329102
	speed: 0.0044s/iter; left time: 18.7040s
	iters: 1000, epoch: 4 | loss: 0.2908394
	speed: 0.0044s/iter; left time: 18.1912s
Updating learning rate to 4.9183769225e-05
Epoch: 4 cost time: 4.7557759284973145
Epoch: 4, Steps: 1027 | Train Loss: 0.6255030 Vali Loss: 0.3763873 Best vali loss: 0.3757865
	iters: 100, epoch: 5 | loss: 1.4781114
	speed: 0.0123s/iter; left time: 49.4936s
	iters: 200, epoch: 5 | loss: 0.4641971
	speed: 0.0049s/iter; left time: 19.1156s
	iters: 300, epoch: 5 | loss: 1.0022640
	speed: 0.0049s/iter; left time: 18.6634s
	iters: 400, epoch: 5 | loss: 0.6595639
	speed: 0.0049s/iter; left time: 18.0679s
	iters: 500, epoch: 5 | loss: 0.4426010
	speed: 0.0049s/iter; left time: 17.5149s
	iters: 600, epoch: 5 | loss: 0.2902379
	speed: 0.0049s/iter; left time: 17.0769s
	iters: 700, epoch: 5 | loss: 0.3669991
	speed: 0.0048s/iter; left time: 16.5323s
	iters: 800, epoch: 5 | loss: 1.1475873
	speed: 0.0049s/iter; left time: 16.1519s
	iters: 900, epoch: 5 | loss: 0.2374392
	speed: 0.0049s/iter; left time: 15.6857s
	iters: 1000, epoch: 5 | loss: 0.9573771
	speed: 0.0048s/iter; left time: 15.0233s
Updating learning rate to 2.45918846125e-05
Epoch: 5 cost time: 5.033281087875366
Epoch: 5, Steps: 1027 | Train Loss: 0.7046378 Vali Loss: 0.3834861 Best vali loss: 0.3757865
	iters: 100, epoch: 6 | loss: 0.5484253
	speed: 0.0122s/iter; left time: 36.2447s
	iters: 200, epoch: 6 | loss: 0.1860373
	speed: 0.0044s/iter; left time: 12.7910s
	iters: 300, epoch: 6 | loss: 1.0271918
	speed: 0.0044s/iter; left time: 12.3540s
	iters: 400, epoch: 6 | loss: 0.3346964
	speed: 0.0044s/iter; left time: 11.8680s
	iters: 500, epoch: 6 | loss: 0.3751891
	speed: 0.0044s/iter; left time: 11.4464s
	iters: 600, epoch: 6 | loss: 0.2154873
	speed: 0.0044s/iter; left time: 10.9599s
	iters: 700, epoch: 6 | loss: 1.0117803
	speed: 0.0044s/iter; left time: 10.5229s
	iters: 800, epoch: 6 | loss: 0.4404987
	speed: 0.0044s/iter; left time: 10.1421s
	iters: 900, epoch: 6 | loss: 0.3464362
	speed: 0.0044s/iter; left time: 9.6638s
	iters: 1000, epoch: 6 | loss: 0.4114568
	speed: 0.0044s/iter; left time: 9.2642s
Updating learning rate to 1.229594230625e-05
Epoch: 6 cost time: 4.5903942584991455
Epoch: 6, Steps: 1027 | Train Loss: 0.4897199 Vali Loss: 0.3898840 Best vali loss: 0.3757865
	iters: 100, epoch: 7 | loss: 0.9399410
	speed: 0.0124s/iter; left time: 24.3324s
	iters: 200, epoch: 7 | loss: 1.2911935
	speed: 0.0044s/iter; left time: 8.1189s
	iters: 300, epoch: 7 | loss: 0.3269161
	speed: 0.0044s/iter; left time: 7.6383s
	iters: 400, epoch: 7 | loss: 0.4917760
	speed: 0.0043s/iter; left time: 7.1933s
	iters: 500, epoch: 7 | loss: 0.5738883
	speed: 0.0044s/iter; left time: 6.7663s
	iters: 600, epoch: 7 | loss: 0.9157025
	speed: 0.0044s/iter; left time: 6.3737s
	iters: 700, epoch: 7 | loss: 0.3595704
	speed: 0.0044s/iter; left time: 5.9756s
	iters: 800, epoch: 7 | loss: 0.6663605
	speed: 0.0044s/iter; left time: 5.5279s
	iters: 900, epoch: 7 | loss: 0.3655597
	speed: 0.0045s/iter; left time: 5.1559s
	iters: 1000, epoch: 7 | loss: 0.7351657
	speed: 0.0045s/iter; left time: 4.7007s
Updating learning rate to 6.147971153125e-06
Epoch: 7 cost time: 4.586801052093506
Epoch: 7, Steps: 1027 | Train Loss: 0.6666074 Vali Loss: 0.3913380 Best vali loss: 0.3757865
	iters: 100, epoch: 8 | loss: 0.5609166
	speed: 0.0130s/iter; left time: 12.0585s
	iters: 200, epoch: 8 | loss: 0.8358814
	speed: 0.0051s/iter; left time: 4.2214s
	iters: 300, epoch: 8 | loss: 0.2570203
	speed: 0.0051s/iter; left time: 3.7321s
	iters: 400, epoch: 8 | loss: 0.4753137
	speed: 0.0051s/iter; left time: 3.2299s
	iters: 500, epoch: 8 | loss: 0.3075247
	speed: 0.0049s/iter; left time: 2.5997s
	iters: 600, epoch: 8 | loss: 0.2938488
	speed: 0.0045s/iter; left time: 1.9066s
	iters: 700, epoch: 8 | loss: 0.5081858
	speed: 0.0045s/iter; left time: 1.4712s
	iters: 800, epoch: 8 | loss: 0.4108765
	speed: 0.0045s/iter; left time: 1.0295s
	iters: 900, epoch: 8 | loss: 0.3465774
	speed: 0.0045s/iter; left time: 0.5745s
	iters: 1000, epoch: 8 | loss: 0.3796721
	speed: 0.0045s/iter; left time: 0.1257s
Updating learning rate to 3.0739855765625e-06
Epoch: 8 cost time: 4.940743923187256
Epoch: 8, Steps: 1027 | Train Loss: 0.4375817 Vali Loss: 0.3900992 Best vali loss: 0.3757865

best validation loss 0.3757865179264241

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0009297312336, 'e_layers': 3, 'learning_rate': 0.0009776341808, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4275807
	speed: 0.0110s/iter; left time: 10.2892s
Updating learning rate to 0.0009404251953622794
Validation loss decreased (inf --> 0.3730).  Saving model state dict ...
Epoch: 1 cost time: 0.9728822708129883
Epoch: 1, Steps: 129 | Train Loss: 0.4275807 Vali Loss: 0.3730152 Best vali loss: 0.3730152
	iters: 100, epoch: 2 | loss: 0.5430236
	speed: 0.0079s/iter; left time: 6.3506s
Updating learning rate to 0.0008344629697817176
Validation loss decreased (0.3730 --> 0.3698).  Saving model state dict ...
Epoch: 2 cost time: 0.6356284618377686
Epoch: 2, Steps: 129 | Train Loss: 0.5430236 Vali Loss: 0.3698034 Best vali loss: 0.3698034
	iters: 100, epoch: 3 | loss: 0.6537920
	speed: 0.0076s/iter; left time: 5.1335s
Updating learning rate to 0.0006758792923529884
Validation loss decreased (0.3698 --> 0.3688).  Saving model state dict ...
Epoch: 3 cost time: 0.5938339233398438
Epoch: 3, Steps: 129 | Train Loss: 0.6537920 Vali Loss: 0.3687681 Best vali loss: 0.3687681
	iters: 100, epoch: 4 | loss: 0.4467721
	speed: 0.0075s/iter; left time: 4.0838s
Updating learning rate to 0.0004888170904
Epoch: 4 cost time: 0.6080212593078613
Epoch: 4, Steps: 129 | Train Loss: 0.4467721 Vali Loss: 0.3773251 Best vali loss: 0.3687681
	iters: 100, epoch: 5 | loss: 0.6578270
	speed: 0.0076s/iter; left time: 3.1785s
Updating learning rate to 0.00030175488844701165
Epoch: 5 cost time: 0.6165268421173096
Epoch: 5, Steps: 129 | Train Loss: 0.6578270 Vali Loss: 0.3762276 Best vali loss: 0.3687681
	iters: 100, epoch: 6 | loss: 0.8231780
	speed: 0.0076s/iter; left time: 2.1870s
Updating learning rate to 0.0001431712110182824
Epoch: 6 cost time: 0.6148769855499268
Epoch: 6, Steps: 129 | Train Loss: 0.8231780 Vali Loss: 0.3810179 Best vali loss: 0.3687681
	iters: 100, epoch: 7 | loss: 0.5165862
	speed: 0.0075s/iter; left time: 1.1882s
Updating learning rate to 3.720898543772061e-05
Epoch: 7 cost time: 0.5990056991577148
Epoch: 7, Steps: 129 | Train Loss: 0.5165862 Vali Loss: 0.3749234 Best vali loss: 0.3687681
	iters: 100, epoch: 8 | loss: 0.6024275
	speed: 0.0078s/iter; left time: 0.2327s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6330242156982422
Epoch: 8, Steps: 129 | Train Loss: 0.6024275 Vali Loss: 0.3742529 Best vali loss: 0.3687681

best validation loss 0.3687680669992518

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0075965110559, 'e_layers': 1, 'learning_rate': 0.0029628006908, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5177087
	speed: 0.0086s/iter; left time: 69.6399s
	iters: 200, epoch: 1 | loss: 1.1286213
	speed: 0.0024s/iter; left time: 19.0378s
	iters: 300, epoch: 1 | loss: 0.5791716
	speed: 0.0024s/iter; left time: 18.7994s
	iters: 400, epoch: 1 | loss: 0.3203992
	speed: 0.0024s/iter; left time: 18.4904s
	iters: 500, epoch: 1 | loss: 1.0330628
	speed: 0.0024s/iter; left time: 18.5499s
	iters: 600, epoch: 1 | loss: 0.4582083
	speed: 0.0024s/iter; left time: 18.3469s
	iters: 700, epoch: 1 | loss: 1.5764550
	speed: 0.0024s/iter; left time: 17.8625s
	iters: 800, epoch: 1 | loss: 2.1635292
	speed: 0.0024s/iter; left time: 17.6439s
	iters: 900, epoch: 1 | loss: 1.7790539
	speed: 0.0024s/iter; left time: 17.4512s
	iters: 1000, epoch: 1 | loss: 1.7766973
	speed: 0.0024s/iter; left time: 17.2480s
Updating learning rate to 0.0029628006908
Validation loss decreased (inf --> 0.3973).  Saving model state dict ...
Epoch: 1 cost time: 2.7830498218536377
Epoch: 1, Steps: 1027 | Train Loss: 1.1332907 Vali Loss: 0.3973348 Best vali loss: 0.3973348
	iters: 100, epoch: 2 | loss: 0.5765627
	speed: 0.0075s/iter; left time: 53.5021s
	iters: 200, epoch: 2 | loss: 0.2103446
	speed: 0.0021s/iter; left time: 14.7303s
	iters: 300, epoch: 2 | loss: 0.2707265
	speed: 0.0021s/iter; left time: 14.5549s
	iters: 400, epoch: 2 | loss: 0.3957998
	speed: 0.0021s/iter; left time: 14.3807s
	iters: 500, epoch: 2 | loss: 1.7906053
	speed: 0.0022s/iter; left time: 14.4627s
	iters: 600, epoch: 2 | loss: 0.6947898
	speed: 0.0022s/iter; left time: 14.6423s
	iters: 700, epoch: 2 | loss: 0.3510781
	speed: 0.0022s/iter; left time: 14.0785s
	iters: 800, epoch: 2 | loss: 0.7166069
	speed: 0.0021s/iter; left time: 13.5201s
	iters: 900, epoch: 2 | loss: 0.3245900
	speed: 0.0021s/iter; left time: 13.1048s
	iters: 1000, epoch: 2 | loss: 1.1125674
	speed: 0.0021s/iter; left time: 13.2324s
Updating learning rate to 0.0014814003454
Epoch: 2 cost time: 2.2343266010284424
Epoch: 2, Steps: 1027 | Train Loss: 0.6443671 Vali Loss: 0.4053957 Best vali loss: 0.3973348
	iters: 100, epoch: 3 | loss: 0.6713546
	speed: 0.0074s/iter; left time: 44.8704s
	iters: 200, epoch: 3 | loss: 0.9290738
	speed: 0.0021s/iter; left time: 12.7705s
	iters: 300, epoch: 3 | loss: 1.0835789
	speed: 0.0022s/iter; left time: 12.8873s
	iters: 400, epoch: 3 | loss: 1.0528373
	speed: 0.0024s/iter; left time: 13.8571s
	iters: 500, epoch: 3 | loss: 0.2839144
	speed: 0.0024s/iter; left time: 13.6609s
	iters: 600, epoch: 3 | loss: 1.0097420
	speed: 0.0024s/iter; left time: 13.4406s
	iters: 700, epoch: 3 | loss: 1.0443933
	speed: 0.0024s/iter; left time: 13.3323s
	iters: 800, epoch: 3 | loss: 0.5092126
	speed: 0.0024s/iter; left time: 13.0063s
	iters: 900, epoch: 3 | loss: 1.4717795
	speed: 0.0024s/iter; left time: 12.5232s
	iters: 1000, epoch: 3 | loss: 0.6478770
	speed: 0.0023s/iter; left time: 11.8438s
Updating learning rate to 0.0007407001727
Epoch: 3 cost time: 2.4274611473083496
Epoch: 3, Steps: 1027 | Train Loss: 0.8703763 Vali Loss: 0.4078143 Best vali loss: 0.3973348

best validation loss 0.3973347757326362

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0026737269808, 'e_layers': 4, 'learning_rate': 0.0003539278276, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5803518
	speed: 0.0111s/iter; left time: 89.8385s
	iters: 200, epoch: 1 | loss: 0.8113853
	speed: 0.0050s/iter; left time: 39.7802s
	iters: 300, epoch: 1 | loss: 0.3112365
	speed: 0.0049s/iter; left time: 39.0981s
	iters: 400, epoch: 1 | loss: 0.5183038
	speed: 0.0050s/iter; left time: 38.8217s
	iters: 500, epoch: 1 | loss: 0.2713758
	speed: 0.0049s/iter; left time: 37.9138s
	iters: 600, epoch: 1 | loss: 1.1296703
	speed: 0.0049s/iter; left time: 37.4631s
	iters: 700, epoch: 1 | loss: 0.2595834
	speed: 0.0049s/iter; left time: 37.0036s
	iters: 800, epoch: 1 | loss: 2.0481892
	speed: 0.0049s/iter; left time: 36.2033s
	iters: 900, epoch: 1 | loss: 0.6642448
	speed: 0.0049s/iter; left time: 35.6167s
	iters: 1000, epoch: 1 | loss: 0.5918931
	speed: 0.0049s/iter; left time: 35.2978s
Updating learning rate to 0.0003539278276
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 5.404515504837036
Epoch: 1, Steps: 1027 | Train Loss: 0.7186234 Vali Loss: 0.3775394 Best vali loss: 0.3775394
	iters: 100, epoch: 2 | loss: 0.2808480
	speed: 0.0134s/iter; left time: 95.0178s
	iters: 200, epoch: 2 | loss: 1.2019147
	speed: 0.0049s/iter; left time: 34.4397s
	iters: 300, epoch: 2 | loss: 0.2378230
	speed: 0.0050s/iter; left time: 34.3133s
	iters: 400, epoch: 2 | loss: 0.2819851
	speed: 0.0049s/iter; left time: 33.4588s
	iters: 500, epoch: 2 | loss: 1.2006837
	speed: 0.0049s/iter; left time: 32.5273s
	iters: 600, epoch: 2 | loss: 1.3845962
	speed: 0.0049s/iter; left time: 32.3726s
	iters: 700, epoch: 2 | loss: 0.7223875
	speed: 0.0052s/iter; left time: 33.5662s
	iters: 800, epoch: 2 | loss: 0.3327366
	speed: 0.0051s/iter; left time: 32.3391s
	iters: 900, epoch: 2 | loss: 0.6175192
	speed: 0.0051s/iter; left time: 31.7925s
	iters: 1000, epoch: 2 | loss: 0.2467610
	speed: 0.0051s/iter; left time: 31.7013s
Updating learning rate to 0.0001769639138
Validation loss decreased (0.3775 --> 0.3738).  Saving model state dict ...
Epoch: 2 cost time: 5.169391632080078
Epoch: 2, Steps: 1027 | Train Loss: 0.6507255 Vali Loss: 0.3737542 Best vali loss: 0.3737542
	iters: 100, epoch: 3 | loss: 0.3810201
	speed: 0.0131s/iter; left time: 79.3201s
	iters: 200, epoch: 3 | loss: 0.5102056
	speed: 0.0050s/iter; left time: 29.5690s
	iters: 300, epoch: 3 | loss: 0.6849760
	speed: 0.0049s/iter; left time: 28.8543s
	iters: 400, epoch: 3 | loss: 0.7117399
	speed: 0.0049s/iter; left time: 27.9910s
	iters: 500, epoch: 3 | loss: 0.5201761
	speed: 0.0049s/iter; left time: 27.9392s
	iters: 600, epoch: 3 | loss: 0.7940087
	speed: 0.0049s/iter; left time: 27.0375s
	iters: 700, epoch: 3 | loss: 0.9257453
	speed: 0.0048s/iter; left time: 26.4927s
	iters: 800, epoch: 3 | loss: 1.0432194
	speed: 0.0048s/iter; left time: 25.7061s
	iters: 900, epoch: 3 | loss: 0.8152349
	speed: 0.0048s/iter; left time: 25.2433s
	iters: 1000, epoch: 3 | loss: 1.0759981
	speed: 0.0049s/iter; left time: 25.0434s
Updating learning rate to 8.84819569e-05
Epoch: 3 cost time: 5.041474103927612
Epoch: 3, Steps: 1027 | Train Loss: 0.7462324 Vali Loss: 0.3825946 Best vali loss: 0.3737542

best validation loss 0.37375420299752055

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010586658788, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5255744
	speed: 0.0106s/iter; left time: 9.8880s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.8984785079956055
Epoch: 1, Steps: 129 | Train Loss: 0.5255744 Vali Loss: 0.3662883 Best vali loss: 0.3662883
	iters: 100, epoch: 2 | loss: 0.5425290
	speed: 0.0071s/iter; left time: 5.7046s
Updating learning rate to 0.0001911554003
Validation loss decreased (0.3663 --> 0.3513).  Saving model state dict ...
Epoch: 2 cost time: 0.551140546798706
Epoch: 2, Steps: 129 | Train Loss: 0.5425290 Vali Loss: 0.3512729 Best vali loss: 0.3512729
	iters: 100, epoch: 3 | loss: 0.5451311
	speed: 0.0073s/iter; left time: 4.9170s
Updating learning rate to 9.557770015e-05
Epoch: 3 cost time: 0.5872359275817871
Epoch: 3, Steps: 129 | Train Loss: 0.5451311 Vali Loss: 0.3652091 Best vali loss: 0.3512729

best validation loss 0.3512728965352701

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010586658788, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5099203
	speed: 0.0110s/iter; left time: 6.0202s
Updating learning rate to 4.7788850075e-05
Epoch: 4 cost time: 0.9232175350189209
Epoch: 4, Steps: 129 | Train Loss: 0.5099203 Vali Loss: 0.3658749 Best vali loss: 0.3512729
	iters: 100, epoch: 5 | loss: 0.4665870
	speed: 0.0071s/iter; left time: 2.9756s
Updating learning rate to 2.38944250375e-05
Epoch: 5 cost time: 0.5594010353088379
Epoch: 5, Steps: 129 | Train Loss: 0.4665870 Vali Loss: 0.3684729 Best vali loss: 0.3512729
	iters: 100, epoch: 6 | loss: 0.5025333
	speed: 0.0073s/iter; left time: 2.1139s
Updating learning rate to 1.194721251875e-05
Epoch: 6 cost time: 0.5889897346496582
Epoch: 6, Steps: 129 | Train Loss: 0.5025333 Vali Loss: 0.3677816 Best vali loss: 0.3512729
	iters: 100, epoch: 7 | loss: 0.5469788
	speed: 0.0070s/iter; left time: 1.1137s
Updating learning rate to 5.973606259375e-06
Epoch: 7 cost time: 0.5405991077423096
Epoch: 7, Steps: 129 | Train Loss: 0.5469788 Vali Loss: 0.3688807 Best vali loss: 0.3512729
	iters: 100, epoch: 8 | loss: 0.6707785
	speed: 0.0072s/iter; left time: 0.2149s
Updating learning rate to 2.9868031296875e-06
Epoch: 8 cost time: 0.5686721801757812
Epoch: 8, Steps: 129 | Train Loss: 0.6707785 Vali Loss: 0.3675586 Best vali loss: 0.3512729

best validation loss 0.3512728965352701

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0088262860873, 'e_layers': 2, 'learning_rate': 0.0006198870847, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006198870847
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 0.7548742294311523
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706721 Best vali loss: 0.3706721
Updating learning rate to 0.00030994354235
Validation loss decreased (0.3707 --> 0.3578).  Saving model state dict ...
Epoch: 2 cost time: 0.44064784049987793
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3577681 Best vali loss: 0.3577681
Updating learning rate to 0.000154971771175
Epoch: 3 cost time: 0.4433925151824951
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3627900 Best vali loss: 0.3577681
Updating learning rate to 7.74858855875e-05
Epoch: 4 cost time: 0.4496190547943115
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4018086 Best vali loss: 0.3577681
Updating learning rate to 3.874294279375e-05
Epoch: 5 cost time: 0.44228625297546387
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3815290 Best vali loss: 0.3577681
Updating learning rate to 1.9371471396875e-05
Epoch: 6 cost time: 0.43663883209228516
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3840636 Best vali loss: 0.3577681
Updating learning rate to 9.6857356984375e-06
Epoch: 7 cost time: 0.4421505928039551
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3807414 Best vali loss: 0.3577681
Updating learning rate to 4.84286784921875e-06
Epoch: 8 cost time: 0.4406564235687256
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3853441 Best vali loss: 0.3577681

best validation loss 0.3577680769392924

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.001062890444, 'e_layers': 1, 'learning_rate': 0.0004306163127, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4602722
	speed: 0.0094s/iter; left time: 8.7721s
Updating learning rate to 0.0004306163127
Validation loss decreased (inf --> 0.3865).  Saving model state dict ...
Epoch: 1 cost time: 0.7603003978729248
Epoch: 1, Steps: 129 | Train Loss: 0.4602722 Vali Loss: 0.3864909 Best vali loss: 0.3864909
	iters: 100, epoch: 2 | loss: 0.4025297
	speed: 0.0060s/iter; left time: 4.8235s
Updating learning rate to 0.00021530815635
Validation loss decreased (0.3865 --> 0.3804).  Saving model state dict ...
Epoch: 2 cost time: 0.43545055389404297
Epoch: 2, Steps: 129 | Train Loss: 0.4025297 Vali Loss: 0.3804322 Best vali loss: 0.3804322
	iters: 100, epoch: 3 | loss: 0.5173805
	speed: 0.0060s/iter; left time: 4.0439s
Updating learning rate to 0.000107654078175
Epoch: 3 cost time: 0.44681811332702637
Epoch: 3, Steps: 129 | Train Loss: 0.5173805 Vali Loss: 0.3858866 Best vali loss: 0.3804322
	iters: 100, epoch: 4 | loss: 0.6932101
	speed: 0.0059s/iter; left time: 3.2441s
Updating learning rate to 5.38270390875e-05
Epoch: 4 cost time: 0.4470553398132324
Epoch: 4, Steps: 129 | Train Loss: 0.6932101 Vali Loss: 0.3907915 Best vali loss: 0.3804322
	iters: 100, epoch: 5 | loss: 0.3974951
	speed: 0.0059s/iter; left time: 2.4625s
Updating learning rate to 2.691351954375e-05
Epoch: 5 cost time: 0.4463183879852295
Epoch: 5, Steps: 129 | Train Loss: 0.3974951 Vali Loss: 0.3854263 Best vali loss: 0.3804322
	iters: 100, epoch: 6 | loss: 0.4928223
	speed: 0.0059s/iter; left time: 1.7038s
Updating learning rate to 1.3456759771875e-05
Epoch: 6 cost time: 0.44774723052978516
Epoch: 6, Steps: 129 | Train Loss: 0.4928223 Vali Loss: 0.3871298 Best vali loss: 0.3804322
	iters: 100, epoch: 7 | loss: 0.3751272
	speed: 0.0058s/iter; left time: 0.9240s
Updating learning rate to 6.7283798859375e-06
Epoch: 7 cost time: 0.4291410446166992
Epoch: 7, Steps: 129 | Train Loss: 0.3751272 Vali Loss: 0.3864557 Best vali loss: 0.3804322
	iters: 100, epoch: 8 | loss: 0.5957680
	speed: 0.0058s/iter; left time: 0.1741s
Updating learning rate to 3.36418994296875e-06
Epoch: 8 cost time: 0.44399499893188477
Epoch: 8, Steps: 129 | Train Loss: 0.5957680 Vali Loss: 0.3862259 Best vali loss: 0.3804322

best validation loss 0.38043217784295147

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0030627609211, 'e_layers': 2, 'learning_rate': 0.0020359616624, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6916262
	speed: 0.0098s/iter; left time: 39.2321s
	iters: 200, epoch: 1 | loss: 0.4437558
	speed: 0.0036s/iter; left time: 14.0118s
	iters: 300, epoch: 1 | loss: 0.5058379
	speed: 0.0036s/iter; left time: 13.8717s
	iters: 400, epoch: 1 | loss: 0.4330271
	speed: 0.0034s/iter; left time: 12.6358s
	iters: 500, epoch: 1 | loss: 0.5199584
	speed: 0.0035s/iter; left time: 12.5714s
Updating learning rate to 0.0020359616624
Validation loss decreased (inf --> 0.4054).  Saving model state dict ...
Epoch: 1 cost time: 2.1770920753479004
Epoch: 1, Steps: 514 | Train Loss: 0.5188411 Vali Loss: 0.4054177 Best vali loss: 0.4054177
	iters: 100, epoch: 2 | loss: 0.5835956
	speed: 0.0074s/iter; left time: 25.7943s
	iters: 200, epoch: 2 | loss: 0.6563517
	speed: 0.0036s/iter; left time: 12.2462s
	iters: 300, epoch: 2 | loss: 0.8558617
	speed: 0.0035s/iter; left time: 11.4677s
	iters: 400, epoch: 2 | loss: 0.4388979
	speed: 0.0034s/iter; left time: 10.8438s
	iters: 500, epoch: 2 | loss: 0.8931556
	speed: 0.0033s/iter; left time: 10.3435s
Updating learning rate to 0.0010179808312
Validation loss decreased (0.4054 --> 0.4032).  Saving model state dict ...
Epoch: 2 cost time: 1.801135540008545
Epoch: 2, Steps: 514 | Train Loss: 0.6855725 Vali Loss: 0.4031797 Best vali loss: 0.4031797
	iters: 100, epoch: 3 | loss: 0.3014285
	speed: 0.0074s/iter; left time: 22.0116s
	iters: 200, epoch: 3 | loss: 0.5226916
	speed: 0.0034s/iter; left time: 9.9341s
	iters: 300, epoch: 3 | loss: 0.6667925
	speed: 0.0035s/iter; left time: 9.6923s
	iters: 400, epoch: 3 | loss: 0.9841744
	speed: 0.0036s/iter; left time: 9.7384s
	iters: 500, epoch: 3 | loss: 0.4174151
	speed: 0.0036s/iter; left time: 9.3805s
Updating learning rate to 0.0005089904156
Validation loss decreased (0.4032 --> 0.3890).  Saving model state dict ...
Epoch: 3 cost time: 1.8674302101135254
Epoch: 3, Steps: 514 | Train Loss: 0.5785004 Vali Loss: 0.3889575 Best vali loss: 0.3889575

best validation loss 0.3889574633014694

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008625858702, 'e_layers': 3, 'learning_rate': 0.0028993598721, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0028993598721
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.6997730731964111
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708858 Best vali loss: 0.3708858
Updating learning rate to 0.00144967993605
Validation loss decreased (0.3709 --> 0.3702).  Saving model state dict ...
Epoch: 2 cost time: 0.4014594554901123
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3701576 Best vali loss: 0.3701576
Updating learning rate to 0.000724839968025
Epoch: 3 cost time: 0.39599132537841797
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3729580 Best vali loss: 0.3701576

best validation loss 0.37015764058690176

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 4, 'learning_rate': 0.0003823108006, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5527864
	speed: 0.0113s/iter; left time: 45.3740s
	iters: 200, epoch: 1 | loss: 0.7541275
	speed: 0.0050s/iter; left time: 19.6434s
	iters: 300, epoch: 1 | loss: 0.4396142
	speed: 0.0050s/iter; left time: 19.1653s
	iters: 400, epoch: 1 | loss: 0.4055227
	speed: 0.0050s/iter; left time: 18.7182s
	iters: 500, epoch: 1 | loss: 0.7950724
	speed: 0.0051s/iter; left time: 18.4458s
Updating learning rate to 0.0003677599621661719
Validation loss decreased (inf --> 0.3625).  Saving model state dict ...
Epoch: 1 cost time: 2.9637365341186523
Epoch: 1, Steps: 514 | Train Loss: 0.5894246 Vali Loss: 0.3624878 Best vali loss: 0.3624878
	iters: 100, epoch: 2 | loss: 0.3214276
	speed: 0.0098s/iter; left time: 34.2214s
	iters: 200, epoch: 2 | loss: 0.4119278
	speed: 0.0048s/iter; left time: 16.2819s
	iters: 300, epoch: 2 | loss: 0.3599513
	speed: 0.0048s/iter; left time: 15.6891s
	iters: 400, epoch: 2 | loss: 0.6504490
	speed: 0.0047s/iter; left time: 15.1290s
	iters: 500, epoch: 2 | loss: 0.6131610
	speed: 0.0049s/iter; left time: 15.1855s
Updating learning rate to 0.000326322680112559
Epoch: 2 cost time: 2.501575469970703
Epoch: 2, Steps: 514 | Train Loss: 0.4713834 Vali Loss: 0.3700611 Best vali loss: 0.3624878
	iters: 100, epoch: 3 | loss: 0.7022967
	speed: 0.0100s/iter; left time: 29.8582s
	iters: 200, epoch: 3 | loss: 0.7664149
	speed: 0.0052s/iter; left time: 14.8909s
	iters: 300, epoch: 3 | loss: 0.7655188
	speed: 0.0051s/iter; left time: 14.1176s
	iters: 400, epoch: 3 | loss: 0.3585107
	speed: 0.0049s/iter; left time: 13.1996s
	iters: 500, epoch: 3 | loss: 0.4788503
	speed: 0.0049s/iter; left time: 12.6523s
Updating learning rate to 0.0002643074050019267
Epoch: 3 cost time: 2.633714437484741
Epoch: 3, Steps: 514 | Train Loss: 0.6143183 Vali Loss: 0.3740801 Best vali loss: 0.3624878

best validation loss 0.36248780138249015

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 4, 'learning_rate': 0.0003823108006, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5024645
	speed: 0.0113s/iter; left time: 28.0279s
	iters: 200, epoch: 4 | loss: 0.6804030
	speed: 0.0051s/iter; left time: 11.9984s
	iters: 300, epoch: 4 | loss: 0.4206173
	speed: 0.0051s/iter; left time: 11.5259s
	iters: 400, epoch: 4 | loss: 0.3524813
	speed: 0.0050s/iter; left time: 10.8487s
	iters: 500, epoch: 4 | loss: 0.6255107
	speed: 0.0052s/iter; left time: 10.8042s
Updating learning rate to 0.0001911554003
Epoch: 4 cost time: 2.9515223503112793
Epoch: 4, Steps: 514 | Train Loss: 0.5162954 Vali Loss: 0.3862515 Best vali loss: 0.3624878
	iters: 100, epoch: 5 | loss: 0.2620413
	speed: 0.0101s/iter; left time: 19.8401s
	iters: 200, epoch: 5 | loss: 0.2806913
	speed: 0.0051s/iter; left time: 9.5097s
	iters: 300, epoch: 5 | loss: 0.3335490
	speed: 0.0047s/iter; left time: 8.3347s
	iters: 400, epoch: 5 | loss: 0.4991044
	speed: 0.0047s/iter; left time: 7.7630s
	iters: 500, epoch: 5 | loss: 0.5011348
	speed: 0.0047s/iter; left time: 7.3826s
Updating learning rate to 0.00011800339559807329
Validation loss decreased (0.3625 --> 0.3487).  Saving model state dict ...
Epoch: 5 cost time: 2.5586209297180176
Epoch: 5, Steps: 514 | Train Loss: 0.3753041 Vali Loss: 0.3486726 Best vali loss: 0.3486726
	iters: 100, epoch: 6 | loss: 0.5132118
	speed: 0.0096s/iter; left time: 13.8829s
	iters: 200, epoch: 6 | loss: 0.6138961
	speed: 0.0043s/iter; left time: 5.8265s
	iters: 300, epoch: 6 | loss: 0.6688511
	speed: 0.0044s/iter; left time: 5.4154s
	iters: 400, epoch: 6 | loss: 0.2847580
	speed: 0.0043s/iter; left time: 4.9707s
	iters: 500, epoch: 6 | loss: 0.4528191
	speed: 0.0043s/iter; left time: 4.5337s
Updating learning rate to 5.598812048744101e-05
Epoch: 6 cost time: 2.3068032264709473
Epoch: 6, Steps: 514 | Train Loss: 0.5067072 Vali Loss: 0.3623073 Best vali loss: 0.3486726
	iters: 100, epoch: 7 | loss: 0.3922544
	speed: 0.0095s/iter; left time: 8.8350s
	iters: 200, epoch: 7 | loss: 0.5342972
	speed: 0.0048s/iter; left time: 3.9969s
	iters: 300, epoch: 7 | loss: 0.3703307
	speed: 0.0048s/iter; left time: 3.4986s
	iters: 400, epoch: 7 | loss: 0.3488719
	speed: 0.0047s/iter; left time: 2.9741s
	iters: 500, epoch: 7 | loss: 0.5793808
	speed: 0.0047s/iter; left time: 2.4953s
Updating learning rate to 1.455083843382812e-05
Epoch: 7 cost time: 2.506908893585205
Epoch: 7, Steps: 514 | Train Loss: 0.4450270 Vali Loss: 0.3589784 Best vali loss: 0.3486726
	iters: 100, epoch: 8 | loss: 0.3867692
	speed: 0.0094s/iter; left time: 3.9192s
	iters: 200, epoch: 8 | loss: 0.2652900
	speed: 0.0048s/iter; left time: 1.5010s
	iters: 300, epoch: 8 | loss: 0.3318048
	speed: 0.0048s/iter; left time: 1.0301s
	iters: 400, epoch: 8 | loss: 0.4448384
	speed: 0.0048s/iter; left time: 0.5483s
	iters: 500, epoch: 8 | loss: 0.4074950
	speed: 0.0048s/iter; left time: 0.0716s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.482363224029541
Epoch: 8, Steps: 514 | Train Loss: 0.3672395 Vali Loss: 0.3638458 Best vali loss: 0.3486726

best validation loss 0.348672596070996

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0084677461205, 'e_layers': 1, 'learning_rate': 0.0003966600428, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3554312
	speed: 0.0085s/iter; left time: 34.0113s
	iters: 200, epoch: 1 | loss: 0.4992045
	speed: 0.0023s/iter; left time: 9.0648s
	iters: 300, epoch: 1 | loss: 0.8797693
	speed: 0.0024s/iter; left time: 9.1370s
	iters: 400, epoch: 1 | loss: 0.6266609
	speed: 0.0024s/iter; left time: 8.7951s
	iters: 500, epoch: 1 | loss: 0.8698939
	speed: 0.0024s/iter; left time: 8.6043s
Updating learning rate to 0.0003966600428
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.5564897060394287
Epoch: 1, Steps: 514 | Train Loss: 0.6461920 Vali Loss: 0.3703956 Best vali loss: 0.3703956
	iters: 100, epoch: 2 | loss: 0.7943310
	speed: 0.0061s/iter; left time: 21.2642s
	iters: 200, epoch: 2 | loss: 0.9535983
	speed: 0.0027s/iter; left time: 9.1149s
	iters: 300, epoch: 2 | loss: 0.2939824
	speed: 0.0027s/iter; left time: 8.7548s
	iters: 400, epoch: 2 | loss: 0.7442256
	speed: 0.0026s/iter; left time: 8.4624s
	iters: 500, epoch: 2 | loss: 0.4036430
	speed: 0.0025s/iter; left time: 7.8698s
Updating learning rate to 0.0001983300214
Validation loss decreased (0.3704 --> 0.3665).  Saving model state dict ...
Epoch: 2 cost time: 1.399655818939209
Epoch: 2, Steps: 514 | Train Loss: 0.6379560 Vali Loss: 0.3664991 Best vali loss: 0.3664991
	iters: 100, epoch: 3 | loss: 0.4844256
	speed: 0.0058s/iter; left time: 17.1789s
	iters: 200, epoch: 3 | loss: 0.2593291
	speed: 0.0023s/iter; left time: 6.7190s
	iters: 300, epoch: 3 | loss: 0.7387136
	speed: 0.0023s/iter; left time: 6.3427s
	iters: 400, epoch: 3 | loss: 1.1779320
	speed: 0.0023s/iter; left time: 6.0537s
	iters: 500, epoch: 3 | loss: 0.3684146
	speed: 0.0023s/iter; left time: 5.9360s
Updating learning rate to 9.91650107e-05
Epoch: 3 cost time: 1.227811574935913
Epoch: 3, Steps: 514 | Train Loss: 0.6057630 Vali Loss: 0.3678591 Best vali loss: 0.3664991
	iters: 100, epoch: 4 | loss: 0.3066205
	speed: 0.0061s/iter; left time: 15.0783s
	iters: 200, epoch: 4 | loss: 0.6543400
	speed: 0.0028s/iter; left time: 6.6902s
	iters: 300, epoch: 4 | loss: 0.6603081
	speed: 0.0028s/iter; left time: 6.4257s
	iters: 400, epoch: 4 | loss: 0.3189219
	speed: 0.0025s/iter; left time: 5.4509s
	iters: 500, epoch: 4 | loss: 0.4383874
	speed: 0.0024s/iter; left time: 4.9131s
Updating learning rate to 4.958250535e-05
Epoch: 4 cost time: 1.4099421501159668
Epoch: 4, Steps: 514 | Train Loss: 0.4757156 Vali Loss: 0.3817046 Best vali loss: 0.3664991
	iters: 100, epoch: 5 | loss: 0.5680848
	speed: 0.0060s/iter; left time: 11.6795s
	iters: 200, epoch: 5 | loss: 0.3874992
	speed: 0.0024s/iter; left time: 4.4378s
	iters: 300, epoch: 5 | loss: 0.4649846
	speed: 0.0022s/iter; left time: 3.9312s
	iters: 400, epoch: 5 | loss: 0.9137945
	speed: 0.0022s/iter; left time: 3.6420s
	iters: 500, epoch: 5 | loss: 0.6615337
	speed: 0.0022s/iter; left time: 3.4296s
Updating learning rate to 2.4791252675e-05
Epoch: 5 cost time: 1.2263827323913574
Epoch: 5, Steps: 514 | Train Loss: 0.5991793 Vali Loss: 0.3811512 Best vali loss: 0.3664991
	iters: 100, epoch: 6 | loss: 0.2750642
	speed: 0.0054s/iter; left time: 7.8421s
	iters: 200, epoch: 6 | loss: 0.4381757
	speed: 0.0023s/iter; left time: 3.0776s
	iters: 300, epoch: 6 | loss: 0.4477695
	speed: 0.0023s/iter; left time: 2.9042s
	iters: 400, epoch: 6 | loss: 0.4290487
	speed: 0.0023s/iter; left time: 2.6622s
	iters: 500, epoch: 6 | loss: 1.0453975
	speed: 0.0025s/iter; left time: 2.5823s
Updating learning rate to 1.23956263375e-05
Epoch: 6 cost time: 1.2468223571777344
Epoch: 6, Steps: 514 | Train Loss: 0.5270912 Vali Loss: 0.3819996 Best vali loss: 0.3664991
	iters: 100, epoch: 7 | loss: 0.3480646
	speed: 0.0055s/iter; left time: 5.1128s
	iters: 200, epoch: 7 | loss: 0.3464336
	speed: 0.0024s/iter; left time: 1.9565s
	iters: 300, epoch: 7 | loss: 0.2696017
	speed: 0.0025s/iter; left time: 1.8024s
	iters: 400, epoch: 7 | loss: 0.6167040
	speed: 0.0024s/iter; left time: 1.5229s
	iters: 500, epoch: 7 | loss: 0.3104764
	speed: 0.0023s/iter; left time: 1.2218s
Updating learning rate to 6.19781316875e-06
Epoch: 7 cost time: 1.2565958499908447
Epoch: 7, Steps: 514 | Train Loss: 0.3782561 Vali Loss: 0.3834765 Best vali loss: 0.3664991
	iters: 100, epoch: 8 | loss: 0.5655425
	speed: 0.0056s/iter; left time: 2.3424s
	iters: 200, epoch: 8 | loss: 0.3564903
	speed: 0.0023s/iter; left time: 0.7323s
	iters: 300, epoch: 8 | loss: 0.2541749
	speed: 0.0023s/iter; left time: 0.5050s
	iters: 400, epoch: 8 | loss: 0.4537354
	speed: 0.0022s/iter; left time: 0.2578s
	iters: 500, epoch: 8 | loss: 0.4296708
	speed: 0.0023s/iter; left time: 0.0352s
Updating learning rate to 3.098906584375e-06
Epoch: 8 cost time: 1.240319013595581
Epoch: 8, Steps: 514 | Train Loss: 0.4119228 Vali Loss: 0.3854984 Best vali loss: 0.3664991

best validation loss 0.36649914654392624

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021785220102, 'e_layers': 4, 'learning_rate': 0.0003956582213, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4462543
	speed: 0.0116s/iter; left time: 22.6453s
	iters: 200, epoch: 1 | loss: 0.4212741
	speed: 0.0054s/iter; left time: 9.9527s
Updating learning rate to 0.0003956582213
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.7255032062530518
Epoch: 1, Steps: 257 | Train Loss: 0.4337642 Vali Loss: 0.3712716 Best vali loss: 0.3712716
	iters: 100, epoch: 2 | loss: 0.8045653
	speed: 0.0114s/iter; left time: 19.3214s
	iters: 200, epoch: 2 | loss: 0.4487834
	speed: 0.0056s/iter; left time: 8.8819s
Updating learning rate to 0.00019782911065
Epoch: 2 cost time: 1.4647696018218994
Epoch: 2, Steps: 257 | Train Loss: 0.6266744 Vali Loss: 0.3868236 Best vali loss: 0.3712716
	iters: 100, epoch: 3 | loss: 0.4796633
	speed: 0.0107s/iter; left time: 15.4488s
	iters: 200, epoch: 3 | loss: 0.4917931
	speed: 0.0052s/iter; left time: 6.9745s
Updating learning rate to 9.8914555325e-05
Validation loss decreased (0.3713 --> 0.3577).  Saving model state dict ...
Epoch: 3 cost time: 1.3404467105865479
Epoch: 3, Steps: 257 | Train Loss: 0.4857282 Vali Loss: 0.3576794 Best vali loss: 0.3576794
	iters: 100, epoch: 4 | loss: 0.6613201
	speed: 0.0105s/iter; left time: 12.4000s
	iters: 200, epoch: 4 | loss: 0.2295531
	speed: 0.0048s/iter; left time: 5.2355s
Updating learning rate to 4.94572776625e-05
Epoch: 4 cost time: 1.2894325256347656
Epoch: 4, Steps: 257 | Train Loss: 0.4454366 Vali Loss: 0.3609148 Best vali loss: 0.3576794
	iters: 100, epoch: 5 | loss: 0.6272821
	speed: 0.0109s/iter; left time: 10.1604s
	iters: 200, epoch: 5 | loss: 0.6388701
	speed: 0.0054s/iter; left time: 4.5110s
Updating learning rate to 2.472863883125e-05
Validation loss decreased (0.3577 --> 0.3498).  Saving model state dict ...
Epoch: 5 cost time: 1.4513132572174072
Epoch: 5, Steps: 257 | Train Loss: 0.6330761 Vali Loss: 0.3498242 Best vali loss: 0.3498242
	iters: 100, epoch: 6 | loss: 0.4856398
	speed: 0.0112s/iter; left time: 7.5354s
	iters: 200, epoch: 6 | loss: 0.5281363
	speed: 0.0050s/iter; left time: 2.8544s
Updating learning rate to 1.2364319415625e-05
Validation loss decreased (0.3498 --> 0.3445).  Saving model state dict ...
Epoch: 6 cost time: 1.3324642181396484
Epoch: 6, Steps: 257 | Train Loss: 0.5068880 Vali Loss: 0.3445433 Best vali loss: 0.3445433
	iters: 100, epoch: 7 | loss: 0.3884392
	speed: 0.0107s/iter; left time: 4.4327s
	iters: 200, epoch: 7 | loss: 0.4903042
	speed: 0.0050s/iter; left time: 1.5674s
Updating learning rate to 6.1821597078125e-06
Epoch: 7 cost time: 1.3140366077423096
Epoch: 7, Steps: 257 | Train Loss: 0.4393717 Vali Loss: 0.3512429 Best vali loss: 0.3445433
	iters: 100, epoch: 8 | loss: 0.4070434
	speed: 0.0102s/iter; left time: 1.6121s
	iters: 200, epoch: 8 | loss: 0.4647589
	speed: 0.0048s/iter; left time: 0.2780s
Updating learning rate to 3.09107985390625e-06
Epoch: 8 cost time: 1.2855892181396484
Epoch: 8, Steps: 257 | Train Loss: 0.4359012 Vali Loss: 0.3474409 Best vali loss: 0.3445433

best validation loss 0.34454326839250293

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018459979228, 'e_layers': 4, 'learning_rate': 0.0003665026814, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00035255350367798254
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 0.8757505416870117
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3670283 Best vali loss: 0.3670283
Updating learning rate to 0.0003128296063704964
Validation loss decreased (0.3670 --> 0.3577).  Saving model state dict ...
Epoch: 2 cost time: 0.5769088268280029
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3577419 Best vali loss: 0.3577419
Updating learning rate to 0.0002533785927445805
Epoch: 3 cost time: 0.5769016742706299
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3711725 Best vali loss: 0.3577419

best validation loss 0.3577418576523457

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043974120688, 'e_layers': 3, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 0.9308316707611084
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3703668 Best vali loss: 0.3703668
Updating learning rate to 0.00033590954375
Epoch: 2 cost time: 0.6114263534545898
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3797089 Best vali loss: 0.3703668
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3704 --> 0.3543).  Saving model state dict ...
Epoch: 3 cost time: 0.6134083271026611
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3543244 Best vali loss: 0.3543244

best validation loss 0.35432442979400425

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0059681352415, 'e_layers': 2, 'learning_rate': 0.0003973413493, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7375975
	speed: 0.0101s/iter; left time: 19.6944s
	iters: 200, epoch: 1 | loss: 0.4698797
	speed: 0.0039s/iter; left time: 7.2493s
Updating learning rate to 0.0003973413493
Validation loss decreased (inf --> 0.3626).  Saving model state dict ...
Epoch: 1 cost time: 1.3590962886810303
Epoch: 1, Steps: 257 | Train Loss: 0.6037386 Vali Loss: 0.3626319 Best vali loss: 0.3626319
	iters: 100, epoch: 2 | loss: 0.3898557
	speed: 0.0089s/iter; left time: 15.1246s
	iters: 200, epoch: 2 | loss: 0.4405577
	speed: 0.0038s/iter; left time: 6.0899s
Updating learning rate to 0.00019867067465
Epoch: 2 cost time: 1.0211923122406006
Epoch: 2, Steps: 257 | Train Loss: 0.4152067 Vali Loss: 0.3748287 Best vali loss: 0.3626319
	iters: 100, epoch: 3 | loss: 0.4802800
	speed: 0.0089s/iter; left time: 12.8641s
	iters: 200, epoch: 3 | loss: 1.0886487
	speed: 0.0041s/iter; left time: 5.4875s
Updating learning rate to 9.9335337325e-05
Validation loss decreased (0.3626 --> 0.3603).  Saving model state dict ...
Epoch: 3 cost time: 1.0801239013671875
Epoch: 3, Steps: 257 | Train Loss: 0.7844644 Vali Loss: 0.3603428 Best vali loss: 0.3603428

best validation loss 0.36034284491670154

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043974120688, 'e_layers': 3, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3543 --> 0.3443).  Saving model state dict ...
Epoch: 4 cost time: 0.9324650764465332
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3443401 Best vali loss: 0.3443401
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3443 --> 0.3431).  Saving model state dict ...
Epoch: 5 cost time: 0.6142349243164062
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3430967 Best vali loss: 0.3430967
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.6166143417358398
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3482200 Best vali loss: 0.3430967
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.6117954254150391
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3443152 Best vali loss: 0.3430967
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.6106796264648438
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3460112 Best vali loss: 0.3430967

best validation loss 0.34309674737964024

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010553908095, 'e_layers': 3, 'learning_rate': 8.04367503e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5720299
	speed: 0.0095s/iter; left time: 37.9861s
	iters: 200, epoch: 1 | loss: 0.5946918
	speed: 0.0041s/iter; left time: 15.8699s
	iters: 300, epoch: 1 | loss: 0.3415119
	speed: 0.0041s/iter; left time: 15.7541s
	iters: 400, epoch: 1 | loss: 0.6902267
	speed: 0.0039s/iter; left time: 14.2965s
	iters: 500, epoch: 1 | loss: 0.4597538
	speed: 0.0039s/iter; left time: 13.9266s
Updating learning rate to 8.04367503e-05
Validation loss decreased (inf --> 0.3852).  Saving model state dict ...
Epoch: 1 cost time: 2.4045846462249756
Epoch: 1, Steps: 514 | Train Loss: 0.5316428 Vali Loss: 0.3851940 Best vali loss: 0.3851940
	iters: 100, epoch: 2 | loss: 0.6611860
	speed: 0.0084s/iter; left time: 29.3771s
	iters: 200, epoch: 2 | loss: 1.0298028
	speed: 0.0044s/iter; left time: 14.8668s
	iters: 300, epoch: 2 | loss: 0.4001126
	speed: 0.0044s/iter; left time: 14.4674s
	iters: 400, epoch: 2 | loss: 0.4048758
	speed: 0.0044s/iter; left time: 14.1590s
	iters: 500, epoch: 2 | loss: 0.3574653
	speed: 0.0044s/iter; left time: 13.5735s
Updating learning rate to 4.021837515e-05
Validation loss decreased (0.3852 --> 0.3727).  Saving model state dict ...
Epoch: 2 cost time: 2.2800722122192383
Epoch: 2, Steps: 514 | Train Loss: 0.5706885 Vali Loss: 0.3726584 Best vali loss: 0.3726584
	iters: 100, epoch: 3 | loss: 1.0275095
	speed: 0.0082s/iter; left time: 24.5553s
	iters: 200, epoch: 3 | loss: 0.4735422
	speed: 0.0039s/iter; left time: 11.1781s
	iters: 300, epoch: 3 | loss: 0.7427918
	speed: 0.0040s/iter; left time: 11.1203s
	iters: 400, epoch: 3 | loss: 0.2401703
	speed: 0.0039s/iter; left time: 10.5230s
	iters: 500, epoch: 3 | loss: 0.5060894
	speed: 0.0039s/iter; left time: 10.0500s
Updating learning rate to 2.0109187575e-05
Validation loss decreased (0.3727 --> 0.3680).  Saving model state dict ...
Epoch: 3 cost time: 2.053252935409546
Epoch: 3, Steps: 514 | Train Loss: 0.5980206 Vali Loss: 0.3680432 Best vali loss: 0.3680432
	iters: 100, epoch: 4 | loss: 1.4436679
	speed: 0.0081s/iter; left time: 20.0924s
	iters: 200, epoch: 4 | loss: 0.5084037
	speed: 0.0039s/iter; left time: 9.2204s
	iters: 300, epoch: 4 | loss: 0.4873729
	speed: 0.0039s/iter; left time: 8.8577s
	iters: 400, epoch: 4 | loss: 0.7907591
	speed: 0.0038s/iter; left time: 8.2055s
	iters: 500, epoch: 4 | loss: 0.3716637
	speed: 0.0042s/iter; left time: 8.6233s
Updating learning rate to 1.00545937875e-05
Validation loss decreased (0.3680 --> 0.3676).  Saving model state dict ...
Epoch: 4 cost time: 2.0624918937683105
Epoch: 4, Steps: 514 | Train Loss: 0.7203734 Vali Loss: 0.3676180 Best vali loss: 0.3676180
	iters: 100, epoch: 5 | loss: 0.9608789
	speed: 0.0082s/iter; left time: 16.0278s
	iters: 200, epoch: 5 | loss: 1.3587885
	speed: 0.0039s/iter; left time: 7.2043s
	iters: 300, epoch: 5 | loss: 0.9231829
	speed: 0.0037s/iter; left time: 6.4963s
	iters: 400, epoch: 5 | loss: 0.8195325
	speed: 0.0037s/iter; left time: 6.0737s
	iters: 500, epoch: 5 | loss: 0.3033785
	speed: 0.0037s/iter; left time: 5.7602s
Updating learning rate to 5.02729689375e-06
Validation loss decreased (0.3676 --> 0.3674).  Saving model state dict ...
Epoch: 5 cost time: 1.9787302017211914
Epoch: 5, Steps: 514 | Train Loss: 0.8731523 Vali Loss: 0.3674352 Best vali loss: 0.3674352
	iters: 100, epoch: 6 | loss: 0.5317544
	speed: 0.0080s/iter; left time: 11.4854s
	iters: 200, epoch: 6 | loss: 0.4564586
	speed: 0.0039s/iter; left time: 5.2587s
	iters: 300, epoch: 6 | loss: 1.1360971
	speed: 0.0038s/iter; left time: 4.7147s
	iters: 400, epoch: 6 | loss: 0.8182690
	speed: 0.0042s/iter; left time: 4.8533s
	iters: 500, epoch: 6 | loss: 1.2399136
	speed: 0.0041s/iter; left time: 4.2970s
Updating learning rate to 2.513648446875e-06
Validation loss decreased (0.3674 --> 0.3673).  Saving model state dict ...
Epoch: 6 cost time: 2.0842559337615967
Epoch: 6, Steps: 514 | Train Loss: 0.8364985 Vali Loss: 0.3673362 Best vali loss: 0.3673362
	iters: 100, epoch: 7 | loss: 0.5193707
	speed: 0.0085s/iter; left time: 7.8753s
	iters: 200, epoch: 7 | loss: 1.0284021
	speed: 0.0038s/iter; left time: 3.1818s
	iters: 300, epoch: 7 | loss: 0.6720853
	speed: 0.0039s/iter; left time: 2.8620s
	iters: 400, epoch: 7 | loss: 0.5846292
	speed: 0.0039s/iter; left time: 2.4533s
	iters: 500, epoch: 7 | loss: 0.6392611
	speed: 0.0039s/iter; left time: 2.0717s
Updating learning rate to 1.2568242234375e-06
Validation loss decreased (0.3673 --> 0.3673).  Saving model state dict ...
Epoch: 7 cost time: 2.0634772777557373
Epoch: 7, Steps: 514 | Train Loss: 0.6887497 Vali Loss: 0.3672980 Best vali loss: 0.3672980
	iters: 100, epoch: 8 | loss: 0.4678932
	speed: 0.0087s/iter; left time: 3.6281s
	iters: 200, epoch: 8 | loss: 0.6759790
	speed: 0.0044s/iter; left time: 1.3884s
	iters: 300, epoch: 8 | loss: 0.6814094
	speed: 0.0044s/iter; left time: 0.9488s
	iters: 400, epoch: 8 | loss: 1.0242156
	speed: 0.0044s/iter; left time: 0.5046s
	iters: 500, epoch: 8 | loss: 0.6804217
	speed: 0.0044s/iter; left time: 0.0659s
Updating learning rate to 6.2841211171875e-07
Validation loss decreased (0.3673 --> 0.3673).  Saving model state dict ...
Epoch: 8 cost time: 2.3069772720336914
Epoch: 8, Steps: 514 | Train Loss: 0.7059838 Vali Loss: 0.3672709 Best vali loss: 0.3672709

best validation loss 0.3672709200728853

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061262053607, 'e_layers': 4, 'learning_rate': 0.0003968694313, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4149354
	speed: 0.0107s/iter; left time: 43.1029s
	iters: 200, epoch: 1 | loss: 0.3393052
	speed: 0.0052s/iter; left time: 20.4671s
	iters: 300, epoch: 1 | loss: 0.4101639
	speed: 0.0052s/iter; left time: 19.9193s
	iters: 400, epoch: 1 | loss: 0.3376982
	speed: 0.0052s/iter; left time: 19.3260s
	iters: 500, epoch: 1 | loss: 0.8893822
	speed: 0.0052s/iter; left time: 18.9265s
Updating learning rate to 0.0003968694313
Validation loss decreased (inf --> 0.3738).  Saving model state dict ...
Epoch: 1 cost time: 3.039989471435547
Epoch: 1, Steps: 514 | Train Loss: 0.4782970 Vali Loss: 0.3737957 Best vali loss: 0.3737957
	iters: 100, epoch: 2 | loss: 1.1510929
	speed: 0.0104s/iter; left time: 36.4305s
	iters: 200, epoch: 2 | loss: 0.9535271
	speed: 0.0052s/iter; left time: 17.6979s
	iters: 300, epoch: 2 | loss: 0.5740880
	speed: 0.0050s/iter; left time: 16.3788s
	iters: 400, epoch: 2 | loss: 0.3987985
	speed: 0.0046s/iter; left time: 14.8165s
	iters: 500, epoch: 2 | loss: 0.4385296
	speed: 0.0047s/iter; left time: 14.5150s
Updating learning rate to 0.00019843471565
Epoch: 2 cost time: 2.5840907096862793
Epoch: 2, Steps: 514 | Train Loss: 0.7032072 Vali Loss: 0.3779222 Best vali loss: 0.3737957
	iters: 100, epoch: 3 | loss: 0.3624810
	speed: 0.0095s/iter; left time: 28.2334s
	iters: 200, epoch: 3 | loss: 0.4912597
	speed: 0.0048s/iter; left time: 13.8281s
	iters: 300, epoch: 3 | loss: 0.7575606
	speed: 0.0051s/iter; left time: 14.1511s
	iters: 400, epoch: 3 | loss: 0.3269018
	speed: 0.0053s/iter; left time: 14.2069s
	iters: 500, epoch: 3 | loss: 0.9600518
	speed: 0.0053s/iter; left time: 13.7153s
Updating learning rate to 9.9217357825e-05
Validation loss decreased (0.3738 --> 0.3590).  Saving model state dict ...
Epoch: 3 cost time: 2.626514196395874
Epoch: 3, Steps: 514 | Train Loss: 0.5796510 Vali Loss: 0.3590449 Best vali loss: 0.3590449
	iters: 100, epoch: 4 | loss: 0.6745525
	speed: 0.0104s/iter; left time: 25.7404s
	iters: 200, epoch: 4 | loss: 0.9000486
	speed: 0.0052s/iter; left time: 12.2922s
	iters: 300, epoch: 4 | loss: 0.3882281
	speed: 0.0052s/iter; left time: 11.8033s
	iters: 400, epoch: 4 | loss: 0.2553213
	speed: 0.0052s/iter; left time: 11.2272s
	iters: 500, epoch: 4 | loss: 0.3421127
	speed: 0.0053s/iter; left time: 10.8868s
Updating learning rate to 4.96086789125e-05
Validation loss decreased (0.3590 --> 0.3532).  Saving model state dict ...
Epoch: 4 cost time: 2.7318637371063232
Epoch: 4, Steps: 514 | Train Loss: 0.5120526 Vali Loss: 0.3532159 Best vali loss: 0.3532159
	iters: 100, epoch: 5 | loss: 0.5483741
	speed: 0.0104s/iter; left time: 20.3601s
	iters: 200, epoch: 5 | loss: 0.6856375
	speed: 0.0053s/iter; left time: 9.7784s
	iters: 300, epoch: 5 | loss: 0.4607363
	speed: 0.0053s/iter; left time: 9.2729s
	iters: 400, epoch: 5 | loss: 0.6403480
	speed: 0.0053s/iter; left time: 8.7765s
	iters: 500, epoch: 5 | loss: 0.6531371
	speed: 0.0048s/iter; left time: 7.5467s
Updating learning rate to 2.480433945625e-05
Epoch: 5 cost time: 2.705362558364868
Epoch: 5, Steps: 514 | Train Loss: 0.5976466 Vali Loss: 0.3535203 Best vali loss: 0.3532159
	iters: 100, epoch: 6 | loss: 0.3979153
	speed: 0.0096s/iter; left time: 13.9009s
	iters: 200, epoch: 6 | loss: 0.7113275
	speed: 0.0048s/iter; left time: 6.3807s
	iters: 300, epoch: 6 | loss: 0.4108877
	speed: 0.0049s/iter; left time: 6.0639s
	iters: 400, epoch: 6 | loss: 0.6291031
	speed: 0.0049s/iter; left time: 5.5808s
	iters: 500, epoch: 6 | loss: 0.2813728
	speed: 0.0049s/iter; left time: 5.1228s
Updating learning rate to 1.2402169728125e-05
Validation loss decreased (0.3532 --> 0.3453).  Saving model state dict ...
Epoch: 6 cost time: 2.540799379348755
Epoch: 6, Steps: 514 | Train Loss: 0.4861213 Vali Loss: 0.3452826 Best vali loss: 0.3452826
	iters: 100, epoch: 7 | loss: 0.2299474
	speed: 0.0097s/iter; left time: 8.9759s
	iters: 200, epoch: 7 | loss: 0.3192226
	speed: 0.0047s/iter; left time: 3.9302s
	iters: 300, epoch: 7 | loss: 0.8155933
	speed: 0.0048s/iter; left time: 3.4799s
	iters: 400, epoch: 7 | loss: 0.6250110
	speed: 0.0048s/iter; left time: 3.0252s
	iters: 500, epoch: 7 | loss: 0.5194713
	speed: 0.0049s/iter; left time: 2.5761s
Updating learning rate to 6.2010848640625e-06
Epoch: 7 cost time: 2.516195297241211
Epoch: 7, Steps: 514 | Train Loss: 0.5018491 Vali Loss: 0.3505334 Best vali loss: 0.3452826
	iters: 100, epoch: 8 | loss: 0.2387339
	speed: 0.0095s/iter; left time: 3.9480s
	iters: 200, epoch: 8 | loss: 0.5191577
	speed: 0.0046s/iter; left time: 1.4551s
	iters: 300, epoch: 8 | loss: 0.6333932
	speed: 0.0048s/iter; left time: 1.0317s
	iters: 400, epoch: 8 | loss: 0.4061927
	speed: 0.0050s/iter; left time: 0.5784s
	iters: 500, epoch: 8 | loss: 0.2059642
	speed: 0.0050s/iter; left time: 0.0756s
Updating learning rate to 3.10054243203125e-06
Epoch: 8 cost time: 2.533165216445923
Epoch: 8, Steps: 514 | Train Loss: 0.4006884 Vali Loss: 0.3470625 Best vali loss: 0.3452826

best validation loss 0.34528259504988995

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010797501212, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4264120
	speed: 0.0097s/iter; left time: 38.9282s
	iters: 200, epoch: 1 | loss: 1.0775995
	speed: 0.0035s/iter; left time: 13.8416s
	iters: 300, epoch: 1 | loss: 1.0152270
	speed: 0.0032s/iter; left time: 12.2231s
	iters: 400, epoch: 1 | loss: 0.5046583
	speed: 0.0032s/iter; left time: 11.6966s
	iters: 500, epoch: 1 | loss: 1.1550617
	speed: 0.0032s/iter; left time: 11.5567s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3752).  Saving model state dict ...
Epoch: 1 cost time: 2.0525126457214355
Epoch: 1, Steps: 514 | Train Loss: 0.8357917 Vali Loss: 0.3751689 Best vali loss: 0.3751689
	iters: 100, epoch: 2 | loss: 0.3889959
	speed: 0.0075s/iter; left time: 26.1162s
	iters: 200, epoch: 2 | loss: 0.2631663
	speed: 0.0036s/iter; left time: 12.2578s
	iters: 300, epoch: 2 | loss: 0.4822942
	speed: 0.0036s/iter; left time: 11.7589s
	iters: 400, epoch: 2 | loss: 0.3807765
	speed: 0.0032s/iter; left time: 10.2916s
	iters: 500, epoch: 2 | loss: 0.6230914
	speed: 0.0031s/iter; left time: 9.6609s
Updating learning rate to 0.0001911554003
Epoch: 2 cost time: 1.7890992164611816
Epoch: 2, Steps: 514 | Train Loss: 0.4276649 Vali Loss: 0.3801169 Best vali loss: 0.3751689
	iters: 100, epoch: 3 | loss: 0.4008452
	speed: 0.0073s/iter; left time: 21.6606s
	iters: 200, epoch: 3 | loss: 0.8527192
	speed: 0.0031s/iter; left time: 8.9564s
	iters: 300, epoch: 3 | loss: 0.5035092
	speed: 0.0033s/iter; left time: 9.0885s
	iters: 400, epoch: 3 | loss: 0.4593526
	speed: 0.0033s/iter; left time: 8.9448s
	iters: 500, epoch: 3 | loss: 1.1400630
	speed: 0.0032s/iter; left time: 8.4009s
Updating learning rate to 9.557770015e-05
Validation loss decreased (0.3752 --> 0.3513).  Saving model state dict ...
Epoch: 3 cost time: 1.7104942798614502
Epoch: 3, Steps: 514 | Train Loss: 0.6712978 Vali Loss: 0.3513004 Best vali loss: 0.3513004

best validation loss 0.3513003745107145

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009031126991, 'e_layers': 4, 'learning_rate': 0.0024897757089, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8762057
	speed: 0.0108s/iter; left time: 43.5329s
	iters: 200, epoch: 1 | loss: 0.7225803
	speed: 0.0052s/iter; left time: 20.1932s
	iters: 300, epoch: 1 | loss: 0.4461481
	speed: 0.0052s/iter; left time: 19.7970s
	iters: 400, epoch: 1 | loss: 0.5482063
	speed: 0.0052s/iter; left time: 19.2585s
	iters: 500, epoch: 1 | loss: 0.6404195
	speed: 0.0052s/iter; left time: 18.6343s
Updating learning rate to 0.0023950142634482446
Validation loss decreased (inf --> 0.4050).  Saving model state dict ...
Epoch: 1 cost time: 3.020270347595215
Epoch: 1, Steps: 514 | Train Loss: 0.6467120 Vali Loss: 0.4050228 Best vali loss: 0.4050228
	iters: 100, epoch: 2 | loss: 0.4304580
	speed: 0.0102s/iter; left time: 35.6779s
	iters: 200, epoch: 2 | loss: 1.3331375
	speed: 0.0054s/iter; left time: 18.2610s
	iters: 300, epoch: 2 | loss: 0.6470377
	speed: 0.0053s/iter; left time: 17.3240s
	iters: 400, epoch: 2 | loss: 0.5351915
	speed: 0.0052s/iter; left time: 16.6165s
	iters: 500, epoch: 2 | loss: 0.6691039
	speed: 0.0051s/iter; left time: 15.7406s
Updating learning rate to 0.0021251564981483667
Epoch: 2 cost time: 2.7269227504730225
Epoch: 2, Steps: 514 | Train Loss: 0.7229857 Vali Loss: 0.4089012 Best vali loss: 0.4050228
	iters: 100, epoch: 3 | loss: 0.3432404
	speed: 0.0098s/iter; left time: 29.1275s
	iters: 200, epoch: 3 | loss: 1.1855781
	speed: 0.0048s/iter; left time: 13.8161s
	iters: 300, epoch: 3 | loss: 0.5941689
	speed: 0.0049s/iter; left time: 13.5597s
	iters: 400, epoch: 3 | loss: 0.9176952
	speed: 0.0046s/iter; left time: 12.4457s
	iters: 500, epoch: 3 | loss: 0.4113215
	speed: 0.0048s/iter; left time: 12.2883s
Updating learning rate to 0.0017212858115005383
Validation loss decreased (0.4050 --> 0.4015).  Saving model state dict ...
Epoch: 3 cost time: 2.5135891437530518
Epoch: 3, Steps: 514 | Train Loss: 0.6904008 Vali Loss: 0.4014773 Best vali loss: 0.4014773

best validation loss 0.40147732529635516

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0022660027283, 'e_layers': 4, 'learning_rate': 0.0003936466728, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7025332
	speed: 0.0140s/iter; left time: 13.0584s
Updating learning rate to 0.0003936466728
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 1.3328640460968018
Epoch: 1, Steps: 129 | Train Loss: 0.7025332 Vali Loss: 0.3646669 Best vali loss: 0.3646669
	iters: 100, epoch: 2 | loss: 0.7370325
	speed: 0.0122s/iter; left time: 9.8151s
Updating learning rate to 0.0001968233364
Epoch: 2 cost time: 0.9883196353912354
Epoch: 2, Steps: 129 | Train Loss: 0.7370325 Vali Loss: 0.3681524 Best vali loss: 0.3646669
	iters: 100, epoch: 3 | loss: 0.5563824
	speed: 0.0120s/iter; left time: 8.0837s
Updating learning rate to 9.84116682e-05
Validation loss decreased (0.3647 --> 0.3583).  Saving model state dict ...
Epoch: 3 cost time: 0.9920358657836914
Epoch: 3, Steps: 129 | Train Loss: 0.5563824 Vali Loss: 0.3582666 Best vali loss: 0.3582666

best validation loss 0.3582666474850098

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010797501212, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3547363
	speed: 0.0092s/iter; left time: 22.8086s
	iters: 200, epoch: 4 | loss: 0.9194127
	speed: 0.0035s/iter; left time: 8.2630s
	iters: 300, epoch: 4 | loss: 0.7893288
	speed: 0.0035s/iter; left time: 8.0529s
	iters: 400, epoch: 4 | loss: 0.4720460
	speed: 0.0035s/iter; left time: 7.6273s
	iters: 500, epoch: 4 | loss: 0.4402247
	speed: 0.0035s/iter; left time: 7.3024s
Updating learning rate to 4.7788850075e-05
Validation loss decreased (0.3513 --> 0.3483).  Saving model state dict ...
Epoch: 4 cost time: 2.1746890544891357
Epoch: 4, Steps: 514 | Train Loss: 0.5951497 Vali Loss: 0.3483215 Best vali loss: 0.3483215
	iters: 100, epoch: 5 | loss: 0.4011744
	speed: 0.0069s/iter; left time: 13.5115s
	iters: 200, epoch: 5 | loss: 0.2292288
	speed: 0.0031s/iter; left time: 5.7329s
	iters: 300, epoch: 5 | loss: 0.3614534
	speed: 0.0032s/iter; left time: 5.5410s
	iters: 400, epoch: 5 | loss: 0.3767239
	speed: 0.0031s/iter; left time: 5.1571s
	iters: 500, epoch: 5 | loss: 0.6188819
	speed: 0.0030s/iter; left time: 4.6832s
Updating learning rate to 2.38944250375e-05
Validation loss decreased (0.3483 --> 0.3445).  Saving model state dict ...
Epoch: 5 cost time: 1.6274504661560059
Epoch: 5, Steps: 514 | Train Loss: 0.3974925 Vali Loss: 0.3444855 Best vali loss: 0.3444855
	iters: 100, epoch: 6 | loss: 0.3197497
	speed: 0.0076s/iter; left time: 10.8952s
	iters: 200, epoch: 6 | loss: 0.7273243
	speed: 0.0036s/iter; left time: 4.8065s
	iters: 300, epoch: 6 | loss: 0.4398430
	speed: 0.0036s/iter; left time: 4.4766s
	iters: 400, epoch: 6 | loss: 0.4401759
	speed: 0.0035s/iter; left time: 3.9985s
	iters: 500, epoch: 6 | loss: 1.0272779
	speed: 0.0034s/iter; left time: 3.5378s
Updating learning rate to 1.194721251875e-05
Validation loss decreased (0.3445 --> 0.3419).  Saving model state dict ...
Epoch: 6 cost time: 1.8626832962036133
Epoch: 6, Steps: 514 | Train Loss: 0.5908742 Vali Loss: 0.3419278 Best vali loss: 0.3419278
	iters: 100, epoch: 7 | loss: 0.5507897
	speed: 0.0076s/iter; left time: 7.0447s
	iters: 200, epoch: 7 | loss: 0.4345256
	speed: 0.0036s/iter; left time: 2.9557s
	iters: 300, epoch: 7 | loss: 0.4396622
	speed: 0.0034s/iter; left time: 2.4910s
	iters: 400, epoch: 7 | loss: 0.6306064
	speed: 0.0032s/iter; left time: 2.0049s
	iters: 500, epoch: 7 | loss: 0.6646695
	speed: 0.0032s/iter; left time: 1.6723s
Updating learning rate to 5.973606259375e-06
Validation loss decreased (0.3419 --> 0.3415).  Saving model state dict ...
Epoch: 7 cost time: 1.766465663909912
Epoch: 7, Steps: 514 | Train Loss: 0.5440507 Vali Loss: 0.3414961 Best vali loss: 0.3414961
	iters: 100, epoch: 8 | loss: 0.5224724
	speed: 0.0072s/iter; left time: 2.9972s
	iters: 200, epoch: 8 | loss: 0.7037857
	speed: 0.0032s/iter; left time: 1.0145s
	iters: 300, epoch: 8 | loss: 0.4657928
	speed: 0.0032s/iter; left time: 0.6848s
	iters: 400, epoch: 8 | loss: 0.8059372
	speed: 0.0033s/iter; left time: 0.3755s
	iters: 500, epoch: 8 | loss: 0.5638260
	speed: 0.0032s/iter; left time: 0.0485s
Updating learning rate to 2.9868031296875e-06
Epoch: 8 cost time: 1.7112395763397217
Epoch: 8, Steps: 514 | Train Loss: 0.6123628 Vali Loss: 0.3422673 Best vali loss: 0.3414961

best validation loss 0.341496078157706

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008741090724, 'e_layers': 4, 'learning_rate': 9.10634797e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9794357
	speed: 0.0113s/iter; left time: 45.1770s
	iters: 200, epoch: 1 | loss: 0.9108164
	speed: 0.0052s/iter; left time: 20.1781s
	iters: 300, epoch: 1 | loss: 0.6905130
	speed: 0.0052s/iter; left time: 19.6904s
	iters: 400, epoch: 1 | loss: 0.7543617
	speed: 0.0051s/iter; left time: 19.0680s
	iters: 500, epoch: 1 | loss: 0.6423576
	speed: 0.0051s/iter; left time: 18.5240s
Updating learning rate to 8.759758237704352e-05
Validation loss decreased (inf --> 0.3976).  Saving model state dict ...
Epoch: 1 cost time: 2.9915075302124023
Epoch: 1, Steps: 514 | Train Loss: 0.7954969 Vali Loss: 0.3975737 Best vali loss: 0.3975737
	iters: 100, epoch: 2 | loss: 0.6416695
	speed: 0.0098s/iter; left time: 34.1879s
	iters: 200, epoch: 2 | loss: 0.7122324
	speed: 0.0046s/iter; left time: 15.5221s
	iters: 300, epoch: 2 | loss: 0.2907321
	speed: 0.0047s/iter; left time: 15.3570s
	iters: 400, epoch: 2 | loss: 0.3392451
	speed: 0.0046s/iter; left time: 14.6808s
	iters: 500, epoch: 2 | loss: 0.5129265
	speed: 0.0047s/iter; left time: 14.4584s
Updating learning rate to 7.772754185715676e-05
Validation loss decreased (0.3976 --> 0.3815).  Saving model state dict ...
Epoch: 2 cost time: 2.435441255569458
Epoch: 2, Steps: 514 | Train Loss: 0.4993611 Vali Loss: 0.3814742 Best vali loss: 0.3814742
	iters: 100, epoch: 3 | loss: 0.6129304
	speed: 0.0099s/iter; left time: 29.4537s
	iters: 200, epoch: 3 | loss: 0.6914463
	speed: 0.0050s/iter; left time: 14.3453s
	iters: 300, epoch: 3 | loss: 0.6567252
	speed: 0.0050s/iter; left time: 13.9197s
	iters: 400, epoch: 3 | loss: 0.3166706
	speed: 0.0049s/iter; left time: 13.0706s
	iters: 500, epoch: 3 | loss: 0.6167810
	speed: 0.0048s/iter; left time: 12.3648s
Updating learning rate to 6.295598233735234e-05
Validation loss decreased (0.3815 --> 0.3742).  Saving model state dict ...
Epoch: 3 cost time: 2.583211898803711
Epoch: 3, Steps: 514 | Train Loss: 0.5789107 Vali Loss: 0.3742030 Best vali loss: 0.3742030
	iters: 100, epoch: 4 | loss: 0.6862050
	speed: 0.0093s/iter; left time: 22.9390s
	iters: 200, epoch: 4 | loss: 0.3742138
	speed: 0.0048s/iter; left time: 11.2873s
	iters: 300, epoch: 4 | loss: 0.4219175
	speed: 0.0048s/iter; left time: 10.9220s
	iters: 400, epoch: 4 | loss: 0.8226500
	speed: 0.0048s/iter; left time: 10.4631s
	iters: 500, epoch: 4 | loss: 0.7297499
	speed: 0.0048s/iter; left time: 9.9661s
Updating learning rate to 4.553173985e-05
Validation loss decreased (0.3742 --> 0.3704).  Saving model state dict ...
Epoch: 4 cost time: 2.477020740509033
Epoch: 4, Steps: 514 | Train Loss: 0.6069472 Vali Loss: 0.3704116 Best vali loss: 0.3704116
	iters: 100, epoch: 5 | loss: 1.2697849
	speed: 0.0096s/iter; left time: 18.7324s
	iters: 200, epoch: 5 | loss: 1.2510988
	speed: 0.0047s/iter; left time: 8.6745s
	iters: 300, epoch: 5 | loss: 0.5147852
	speed: 0.0047s/iter; left time: 8.2259s
	iters: 400, epoch: 5 | loss: 0.6707846
	speed: 0.0050s/iter; left time: 8.2161s
	iters: 500, epoch: 5 | loss: 0.6067537
	speed: 0.0046s/iter; left time: 7.1968s
Updating learning rate to 2.8107497362647663e-05
Validation loss decreased (0.3704 --> 0.3686).  Saving model state dict ...
Epoch: 5 cost time: 2.4732584953308105
Epoch: 5, Steps: 514 | Train Loss: 0.8626414 Vali Loss: 0.3685653 Best vali loss: 0.3685653
	iters: 100, epoch: 6 | loss: 1.2456338
	speed: 0.0097s/iter; left time: 13.9785s
	iters: 200, epoch: 6 | loss: 0.6966681
	speed: 0.0047s/iter; left time: 6.2731s
	iters: 300, epoch: 6 | loss: 0.7020859
	speed: 0.0049s/iter; left time: 6.0308s
	iters: 400, epoch: 6 | loss: 0.6624717
	speed: 0.0048s/iter; left time: 5.4294s
	iters: 500, epoch: 6 | loss: 0.7070142
	speed: 0.0045s/iter; left time: 4.7274s
Updating learning rate to 1.3335937842843246e-05
Validation loss decreased (0.3686 --> 0.3679).  Saving model state dict ...
Epoch: 6 cost time: 2.4977011680603027
Epoch: 6, Steps: 514 | Train Loss: 0.8027748 Vali Loss: 0.3679334 Best vali loss: 0.3679334
	iters: 100, epoch: 7 | loss: 0.5432463
	speed: 0.0095s/iter; left time: 8.8602s
	iters: 200, epoch: 7 | loss: 0.8675039
	speed: 0.0047s/iter; left time: 3.9023s
	iters: 300, epoch: 7 | loss: 0.4715399
	speed: 0.0048s/iter; left time: 3.5341s
	iters: 400, epoch: 7 | loss: 0.7870204
	speed: 0.0049s/iter; left time: 3.0583s
	iters: 500, epoch: 7 | loss: 0.6804650
	speed: 0.0049s/iter; left time: 2.5772s
Updating learning rate to 3.465897322956475e-06
Validation loss decreased (0.3679 --> 0.3678).  Saving model state dict ...
Epoch: 7 cost time: 2.5220813751220703
Epoch: 7, Steps: 514 | Train Loss: 0.6699551 Vali Loss: 0.3678234 Best vali loss: 0.3678234
	iters: 100, epoch: 8 | loss: 0.3234226
	speed: 0.0098s/iter; left time: 4.0764s
	iters: 200, epoch: 8 | loss: 0.3672177
	speed: 0.0051s/iter; left time: 1.5974s
	iters: 300, epoch: 8 | loss: 0.6302639
	speed: 0.0050s/iter; left time: 1.0793s
	iters: 400, epoch: 8 | loss: 0.6736343
	speed: 0.0051s/iter; left time: 0.5811s
	iters: 500, epoch: 8 | loss: 1.0130839
	speed: 0.0052s/iter; left time: 0.0773s
Updating learning rate to 0.0
Validation loss decreased (0.3678 --> 0.3678).  Saving model state dict ...
Epoch: 8 cost time: 2.652242422103882
Epoch: 8, Steps: 514 | Train Loss: 0.6015245 Vali Loss: 0.3677774 Best vali loss: 0.3677774

best validation loss 0.36777735257956745

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 0.779376745223999
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3663877 Best vali loss: 0.3663877
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.4531412124633789
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3673082 Best vali loss: 0.3663877
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3664 --> 0.3617).  Saving model state dict ...
Epoch: 3 cost time: 0.4444761276245117
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3617494 Best vali loss: 0.3617494
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3617 --> 0.3465).  Saving model state dict ...
Epoch: 4 cost time: 0.4520413875579834
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3465286 Best vali loss: 0.3465286
Updating learning rate to 0.0002182291873478251
Epoch: 5 cost time: 0.45319628715515137
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3505788 Best vali loss: 0.3465286
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.45433735847473145
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3542797 Best vali loss: 0.3465286
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.4506876468658447
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3575607 Best vali loss: 0.3465286
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4471447467803955
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3580560 Best vali loss: 0.3465286

best validation loss 0.3465286437209791

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010261795739, 'e_layers': 4, 'learning_rate': 0.0003604643687, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5022990
	speed: 0.0123s/iter; left time: 11.4309s
Updating learning rate to 0.0003604643687
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 1.1335411071777344
Epoch: 1, Steps: 129 | Train Loss: 0.5022990 Vali Loss: 0.3701087 Best vali loss: 0.3701087
	iters: 100, epoch: 2 | loss: 0.7085138
	speed: 0.0098s/iter; left time: 7.8689s
Updating learning rate to 0.00018023218435
Validation loss decreased (0.3701 --> 0.3629).  Saving model state dict ...
Epoch: 2 cost time: 0.8111715316772461
Epoch: 2, Steps: 129 | Train Loss: 0.7085138 Vali Loss: 0.3628846 Best vali loss: 0.3628846
	iters: 100, epoch: 3 | loss: 0.3336052
	speed: 0.0099s/iter; left time: 6.7029s
Updating learning rate to 9.0116092175e-05
Epoch: 3 cost time: 0.8255627155303955
Epoch: 3, Steps: 129 | Train Loss: 0.3336052 Vali Loss: 0.3749247 Best vali loss: 0.3628846

best validation loss 0.362884595433949

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014986437144, 'e_layers': 2, 'learning_rate': 0.0003422374997, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5155677
	speed: 0.0094s/iter; left time: 76.2670s
	iters: 200, epoch: 1 | loss: 0.4892893
	speed: 0.0031s/iter; left time: 24.9902s
	iters: 300, epoch: 1 | loss: 1.9716153
	speed: 0.0031s/iter; left time: 24.8736s
	iters: 400, epoch: 1 | loss: 0.9182297
	speed: 0.0031s/iter; left time: 24.2456s
	iters: 500, epoch: 1 | loss: 0.5914425
	speed: 0.0031s/iter; left time: 23.9165s
	iters: 600, epoch: 1 | loss: 0.9939690
	speed: 0.0031s/iter; left time: 23.8370s
	iters: 700, epoch: 1 | loss: 1.2264600
	speed: 0.0031s/iter; left time: 23.2379s
	iters: 800, epoch: 1 | loss: 0.3415945
	speed: 0.0031s/iter; left time: 23.1842s
	iters: 900, epoch: 1 | loss: 0.3562853
	speed: 0.0031s/iter; left time: 22.7759s
	iters: 1000, epoch: 1 | loss: 0.8003725
	speed: 0.0031s/iter; left time: 22.5138s
Updating learning rate to 0.0003292118604653338
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 3.5508053302764893
Epoch: 1, Steps: 1027 | Train Loss: 0.8204826 Vali Loss: 0.3817868 Best vali loss: 0.3817868
	iters: 100, epoch: 2 | loss: 0.7181193
	speed: 0.0091s/iter; left time: 64.4425s
	iters: 200, epoch: 2 | loss: 0.4832002
	speed: 0.0033s/iter; left time: 22.7317s
	iters: 300, epoch: 2 | loss: 0.4077551
	speed: 0.0032s/iter; left time: 21.9269s
	iters: 400, epoch: 2 | loss: 0.3060590
	speed: 0.0032s/iter; left time: 21.7034s
	iters: 500, epoch: 2 | loss: 0.8706253
	speed: 0.0031s/iter; left time: 20.4696s
	iters: 600, epoch: 2 | loss: 0.5956246
	speed: 0.0030s/iter; left time: 20.0981s
	iters: 700, epoch: 2 | loss: 0.3825209
	speed: 0.0030s/iter; left time: 19.7332s
	iters: 800, epoch: 2 | loss: 0.9089341
	speed: 0.0030s/iter; left time: 19.3050s
	iters: 900, epoch: 2 | loss: 0.2361016
	speed: 0.0030s/iter; left time: 19.1843s
	iters: 1000, epoch: 2 | loss: 1.3872222
	speed: 0.0030s/iter; left time: 18.8689s
Updating learning rate to 0.00029211797825709945
Validation loss decreased (0.3818 --> 0.3698).  Saving model state dict ...
Epoch: 2 cost time: 3.2190604209899902
Epoch: 2, Steps: 1027 | Train Loss: 0.6296162 Vali Loss: 0.3697666 Best vali loss: 0.3697666
	iters: 100, epoch: 3 | loss: 0.3917835
	speed: 0.0089s/iter; left time: 53.9296s
	iters: 200, epoch: 3 | loss: 0.8052003
	speed: 0.0029s/iter; left time: 17.0445s
	iters: 300, epoch: 3 | loss: 0.5891837
	speed: 0.0029s/iter; left time: 16.9955s
	iters: 400, epoch: 3 | loss: 0.2235009
	speed: 0.0029s/iter; left time: 16.5415s
	iters: 500, epoch: 3 | loss: 0.3240218
	speed: 0.0028s/iter; left time: 16.1216s
	iters: 600, epoch: 3 | loss: 0.2865991
	speed: 0.0029s/iter; left time: 16.0109s
	iters: 700, epoch: 3 | loss: 0.4487192
	speed: 0.0029s/iter; left time: 16.0789s
	iters: 800, epoch: 3 | loss: 0.2130681
	speed: 0.0028s/iter; left time: 15.0922s
	iters: 900, epoch: 3 | loss: 0.5068637
	speed: 0.0032s/iter; left time: 16.5846s
	iters: 1000, epoch: 3 | loss: 0.1904317
	speed: 0.0031s/iter; left time: 16.2064s
Updating learning rate to 0.00023660306038462118
Epoch: 3 cost time: 3.048924207687378
Epoch: 3, Steps: 1027 | Train Loss: 0.3979372 Vali Loss: 0.3811375 Best vali loss: 0.3697666

best validation loss 0.3697665715849938

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022465551274, 'e_layers': 2, 'learning_rate': 0.0003947839652, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4268322
	speed: 0.0097s/iter; left time: 39.0364s
	iters: 200, epoch: 1 | loss: 1.0779754
	speed: 0.0034s/iter; left time: 13.4344s
	iters: 300, epoch: 1 | loss: 1.0147161
	speed: 0.0034s/iter; left time: 13.1416s
	iters: 400, epoch: 1 | loss: 0.5036317
	speed: 0.0034s/iter; left time: 12.4932s
	iters: 500, epoch: 1 | loss: 1.1474828
	speed: 0.0034s/iter; left time: 12.3759s
Updating learning rate to 0.0003947839652
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 2.1093013286590576
Epoch: 1, Steps: 514 | Train Loss: 0.8341276 Vali Loss: 0.3696150 Best vali loss: 0.3696150
	iters: 100, epoch: 2 | loss: 0.3970906
	speed: 0.0072s/iter; left time: 25.2044s
	iters: 200, epoch: 2 | loss: 0.2545528
	speed: 0.0034s/iter; left time: 11.4850s
	iters: 300, epoch: 2 | loss: 0.4879269
	speed: 0.0035s/iter; left time: 11.3872s
	iters: 400, epoch: 2 | loss: 0.3877907
	speed: 0.0035s/iter; left time: 11.2221s
	iters: 500, epoch: 2 | loss: 0.6173534
	speed: 0.0034s/iter; left time: 10.4808s
Updating learning rate to 0.0001973919826
Validation loss decreased (0.3696 --> 0.3634).  Saving model state dict ...
Epoch: 2 cost time: 1.8024652004241943
Epoch: 2, Steps: 514 | Train Loss: 0.4289429 Vali Loss: 0.3633815 Best vali loss: 0.3633815
	iters: 100, epoch: 3 | loss: 0.3398693
	speed: 0.0074s/iter; left time: 22.0120s
	iters: 200, epoch: 3 | loss: 0.8787012
	speed: 0.0034s/iter; left time: 9.8965s
	iters: 300, epoch: 3 | loss: 0.4907402
	speed: 0.0034s/iter; left time: 9.3624s
	iters: 400, epoch: 3 | loss: 0.4782937
	speed: 0.0033s/iter; left time: 8.8362s
	iters: 500, epoch: 3 | loss: 1.0746484
	speed: 0.0033s/iter; left time: 8.5730s
Updating learning rate to 9.86959913e-05
Validation loss decreased (0.3634 --> 0.3544).  Saving model state dict ...
Epoch: 3 cost time: 1.7691550254821777
Epoch: 3, Steps: 514 | Train Loss: 0.6524505 Vali Loss: 0.3544118 Best vali loss: 0.3544118

best validation loss 0.35441176352660175

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022465551274, 'e_layers': 2, 'learning_rate': 0.0003947839652, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3729937
	speed: 0.0096s/iter; left time: 23.7852s
	iters: 200, epoch: 4 | loss: 0.9077655
	speed: 0.0036s/iter; left time: 8.4342s
	iters: 300, epoch: 4 | loss: 0.7788806
	speed: 0.0036s/iter; left time: 8.0797s
	iters: 400, epoch: 4 | loss: 0.5224839
	speed: 0.0035s/iter; left time: 7.6972s
	iters: 500, epoch: 4 | loss: 0.4213626
	speed: 0.0036s/iter; left time: 7.4197s
Updating learning rate to 4.934799565e-05
Validation loss decreased (0.3544 --> 0.3450).  Saving model state dict ...
Epoch: 4 cost time: 2.162454605102539
Epoch: 4, Steps: 514 | Train Loss: 0.6006973 Vali Loss: 0.3449626 Best vali loss: 0.3449626
	iters: 100, epoch: 5 | loss: 0.3794695
	speed: 0.0073s/iter; left time: 14.1937s
	iters: 200, epoch: 5 | loss: 0.2366756
	speed: 0.0031s/iter; left time: 5.7707s
	iters: 300, epoch: 5 | loss: 0.3536621
	speed: 0.0030s/iter; left time: 5.3288s
	iters: 400, epoch: 5 | loss: 0.3796596
	speed: 0.0029s/iter; left time: 4.8765s
	iters: 500, epoch: 5 | loss: 0.5932700
	speed: 0.0030s/iter; left time: 4.6539s
Updating learning rate to 2.4673997825e-05
Epoch: 5 cost time: 1.6095466613769531
Epoch: 5, Steps: 514 | Train Loss: 0.3885474 Vali Loss: 0.3456782 Best vali loss: 0.3449626
	iters: 100, epoch: 6 | loss: 0.3109679
	speed: 0.0074s/iter; left time: 10.6254s
	iters: 200, epoch: 6 | loss: 0.7443238
	speed: 0.0036s/iter; left time: 4.8589s
	iters: 300, epoch: 6 | loss: 0.4443240
	speed: 0.0036s/iter; left time: 4.5251s
	iters: 400, epoch: 6 | loss: 0.4255520
	speed: 0.0036s/iter; left time: 4.1561s
	iters: 500, epoch: 6 | loss: 0.9803360
	speed: 0.0037s/iter; left time: 3.8354s
Updating learning rate to 1.23369989125e-05
Validation loss decreased (0.3450 --> 0.3437).  Saving model state dict ...
Epoch: 6 cost time: 1.909165859222412
Epoch: 6, Steps: 514 | Train Loss: 0.5811007 Vali Loss: 0.3436521 Best vali loss: 0.3436521
	iters: 100, epoch: 7 | loss: 0.5368559
	speed: 0.0075s/iter; left time: 7.0101s
	iters: 200, epoch: 7 | loss: 0.4239767
	speed: 0.0033s/iter; left time: 2.7387s
	iters: 300, epoch: 7 | loss: 0.4485817
	speed: 0.0033s/iter; left time: 2.4296s
	iters: 400, epoch: 7 | loss: 0.6174840
	speed: 0.0034s/iter; left time: 2.1089s
	iters: 500, epoch: 7 | loss: 0.6547261
	speed: 0.0031s/iter; left time: 1.6293s
Updating learning rate to 6.16849945625e-06
Validation loss decreased (0.3437 --> 0.3428).  Saving model state dict ...
Epoch: 7 cost time: 1.7436981201171875
Epoch: 7, Steps: 514 | Train Loss: 0.5363249 Vali Loss: 0.3427781 Best vali loss: 0.3427781
	iters: 100, epoch: 8 | loss: 0.5297536
	speed: 0.0074s/iter; left time: 3.0526s
	iters: 200, epoch: 8 | loss: 0.6988617
	speed: 0.0033s/iter; left time: 1.0318s
	iters: 300, epoch: 8 | loss: 0.4691090
	speed: 0.0033s/iter; left time: 0.7193s
	iters: 400, epoch: 8 | loss: 0.7715638
	speed: 0.0032s/iter; left time: 0.3643s
	iters: 500, epoch: 8 | loss: 0.5263355
	speed: 0.0032s/iter; left time: 0.0479s
Updating learning rate to 3.084249728125e-06
Epoch: 8 cost time: 1.7196199893951416
Epoch: 8, Steps: 514 | Train Loss: 0.5991247 Vali Loss: 0.3441265 Best vali loss: 0.3427781

best validation loss 0.34277805036083886

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022143336782, 'e_layers': 2, 'learning_rate': 0.0003977955532, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4297026
	speed: 0.0099s/iter; left time: 39.6996s
	iters: 200, epoch: 1 | loss: 0.9837881
	speed: 0.0034s/iter; left time: 13.4738s
	iters: 300, epoch: 1 | loss: 0.5818901
	speed: 0.0032s/iter; left time: 12.2427s
	iters: 400, epoch: 1 | loss: 0.5998330
	speed: 0.0031s/iter; left time: 11.5553s
	iters: 500, epoch: 1 | loss: 0.2555267
	speed: 0.0031s/iter; left time: 11.0489s
Updating learning rate to 0.0003977955532
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 2.0409469604492188
Epoch: 1, Steps: 514 | Train Loss: 0.5701481 Vali Loss: 0.3728364 Best vali loss: 0.3728364
	iters: 100, epoch: 2 | loss: 0.3357834
	speed: 0.0076s/iter; left time: 26.5238s
	iters: 200, epoch: 2 | loss: 0.3667688
	speed: 0.0033s/iter; left time: 11.1151s
	iters: 300, epoch: 2 | loss: 0.9048700
	speed: 0.0031s/iter; left time: 10.3252s
	iters: 400, epoch: 2 | loss: 0.4382560
	speed: 0.0031s/iter; left time: 9.8098s
	iters: 500, epoch: 2 | loss: 0.6487353
	speed: 0.0030s/iter; left time: 9.4219s
Updating learning rate to 0.0001988977766
Validation loss decreased (0.3728 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 1.6742057800292969
Epoch: 2, Steps: 514 | Train Loss: 0.5388827 Vali Loss: 0.3629996 Best vali loss: 0.3629996
	iters: 100, epoch: 3 | loss: 0.2430542
	speed: 0.0074s/iter; left time: 22.1431s
	iters: 200, epoch: 3 | loss: 0.4086839
	speed: 0.0034s/iter; left time: 9.7658s
	iters: 300, epoch: 3 | loss: 0.6246442
	speed: 0.0034s/iter; left time: 9.4415s
	iters: 400, epoch: 3 | loss: 0.6257349
	speed: 0.0033s/iter; left time: 8.9041s
	iters: 500, epoch: 3 | loss: 0.3528045
	speed: 0.0032s/iter; left time: 8.2905s
Updating learning rate to 9.94488883e-05
Validation loss decreased (0.3630 --> 0.3483).  Saving model state dict ...
Epoch: 3 cost time: 1.7634267807006836
Epoch: 3, Steps: 514 | Train Loss: 0.4509843 Vali Loss: 0.3483094 Best vali loss: 0.3483094
	iters: 100, epoch: 4 | loss: 0.4116191
	speed: 0.0074s/iter; left time: 18.3045s
	iters: 200, epoch: 4 | loss: 0.6685198
	speed: 0.0032s/iter; left time: 7.6792s
	iters: 300, epoch: 4 | loss: 0.6713001
	speed: 0.0033s/iter; left time: 7.4035s
	iters: 400, epoch: 4 | loss: 1.0325248
	speed: 0.0033s/iter; left time: 7.1662s
	iters: 500, epoch: 4 | loss: 0.3447200
	speed: 0.0031s/iter; left time: 6.4223s
Updating learning rate to 4.972444415e-05
Epoch: 4 cost time: 1.707411289215088
Epoch: 4, Steps: 514 | Train Loss: 0.6257368 Vali Loss: 0.3496455 Best vali loss: 0.3483094
	iters: 100, epoch: 5 | loss: 0.2770046
	speed: 0.0071s/iter; left time: 13.9641s
	iters: 200, epoch: 5 | loss: 0.8419136
	speed: 0.0035s/iter; left time: 6.4389s
	iters: 300, epoch: 5 | loss: 0.9377880
	speed: 0.0034s/iter; left time: 5.8991s
	iters: 400, epoch: 5 | loss: 0.7962053
	speed: 0.0032s/iter; left time: 5.2991s
	iters: 500, epoch: 5 | loss: 0.2362334
	speed: 0.0032s/iter; left time: 4.9380s
Updating learning rate to 2.4862222075e-05
Validation loss decreased (0.3483 --> 0.3464).  Saving model state dict ...
Epoch: 5 cost time: 1.743420124053955
Epoch: 5, Steps: 514 | Train Loss: 0.6178290 Vali Loss: 0.3464100 Best vali loss: 0.3464100
	iters: 100, epoch: 6 | loss: 0.4363347
	speed: 0.0073s/iter; left time: 10.5924s
	iters: 200, epoch: 6 | loss: 0.5382184
	speed: 0.0033s/iter; left time: 4.4020s
	iters: 300, epoch: 6 | loss: 0.6120743
	speed: 0.0034s/iter; left time: 4.1969s
	iters: 400, epoch: 6 | loss: 0.4658743
	speed: 0.0033s/iter; left time: 3.7586s
	iters: 500, epoch: 6 | loss: 0.6535938
	speed: 0.0033s/iter; left time: 3.4718s
Updating learning rate to 1.24311110375e-05
Validation loss decreased (0.3464 --> 0.3464).  Saving model state dict ...
Epoch: 6 cost time: 1.7443723678588867
Epoch: 6, Steps: 514 | Train Loss: 0.5412191 Vali Loss: 0.3464030 Best vali loss: 0.3464030
	iters: 100, epoch: 7 | loss: 0.3553383
	speed: 0.0076s/iter; left time: 7.0704s
	iters: 200, epoch: 7 | loss: 0.2932034
	speed: 0.0035s/iter; left time: 2.9146s
	iters: 300, epoch: 7 | loss: 0.4079130
	speed: 0.0035s/iter; left time: 2.5692s
	iters: 400, epoch: 7 | loss: 0.3119662
	speed: 0.0035s/iter; left time: 2.2312s
	iters: 500, epoch: 7 | loss: 0.2816390
	speed: 0.0035s/iter; left time: 1.8637s
Updating learning rate to 6.21555551875e-06
Epoch: 7 cost time: 1.8543238639831543
Epoch: 7, Steps: 514 | Train Loss: 0.3300120 Vali Loss: 0.3471710 Best vali loss: 0.3464030
	iters: 100, epoch: 8 | loss: 0.4307139
	speed: 0.0072s/iter; left time: 2.9885s
	iters: 200, epoch: 8 | loss: 0.5102990
	speed: 0.0033s/iter; left time: 1.0499s
	iters: 300, epoch: 8 | loss: 0.6141856
	speed: 0.0033s/iter; left time: 0.7174s
	iters: 400, epoch: 8 | loss: 0.3088060
	speed: 0.0033s/iter; left time: 0.3841s
	iters: 500, epoch: 8 | loss: 0.4903745
	speed: 0.0033s/iter; left time: 0.0498s
Updating learning rate to 3.107777759375e-06
Validation loss decreased (0.3464 --> 0.3460).  Saving model state dict ...
Epoch: 8 cost time: 1.7550606727600098
Epoch: 8, Steps: 514 | Train Loss: 0.4708758 Vali Loss: 0.3460035 Best vali loss: 0.3460035

best validation loss 0.34600353291320424

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021991860951, 'e_layers': 2, 'learning_rate': 0.0003967702299, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4296738
	speed: 0.0097s/iter; left time: 38.9093s
	iters: 200, epoch: 1 | loss: 0.9837005
	speed: 0.0033s/iter; left time: 12.7894s
	iters: 300, epoch: 1 | loss: 0.5819371
	speed: 0.0031s/iter; left time: 11.8118s
	iters: 400, epoch: 1 | loss: 0.5988420
	speed: 0.0030s/iter; left time: 11.2275s
	iters: 500, epoch: 1 | loss: 0.2514674
	speed: 0.0031s/iter; left time: 11.3082s
Updating learning rate to 0.0003967702299
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 2.000081777572632
Epoch: 1, Steps: 514 | Train Loss: 0.5691242 Vali Loss: 0.3720653 Best vali loss: 0.3720653
	iters: 100, epoch: 2 | loss: 0.3318169
	speed: 0.0070s/iter; left time: 24.6538s
	iters: 200, epoch: 2 | loss: 0.3668262
	speed: 0.0032s/iter; left time: 10.8948s
	iters: 300, epoch: 2 | loss: 1.0075972
	speed: 0.0032s/iter; left time: 10.4222s
	iters: 400, epoch: 2 | loss: 0.4178929
	speed: 0.0033s/iter; left time: 10.6603s
	iters: 500, epoch: 2 | loss: 0.6627984
	speed: 0.0033s/iter; left time: 10.3292s
Updating learning rate to 0.00019838511495
Epoch: 2 cost time: 1.7204489707946777
Epoch: 2, Steps: 514 | Train Loss: 0.5573863 Vali Loss: 0.3756844 Best vali loss: 0.3720653
	iters: 100, epoch: 3 | loss: 0.2452780
	speed: 0.0069s/iter; left time: 20.4663s
	iters: 200, epoch: 3 | loss: 0.3904290
	speed: 0.0031s/iter; left time: 8.8003s
	iters: 300, epoch: 3 | loss: 0.6507336
	speed: 0.0031s/iter; left time: 8.5075s
	iters: 400, epoch: 3 | loss: 0.6189715
	speed: 0.0031s/iter; left time: 8.3725s
	iters: 500, epoch: 3 | loss: 0.3697249
	speed: 0.0031s/iter; left time: 8.0431s
Updating learning rate to 9.9192557475e-05
Epoch: 3 cost time: 1.6240055561065674
Epoch: 3, Steps: 514 | Train Loss: 0.4550274 Vali Loss: 0.3725794 Best vali loss: 0.3720653
	iters: 100, epoch: 4 | loss: 0.4035133
	speed: 0.0069s/iter; left time: 17.0214s
	iters: 200, epoch: 4 | loss: 0.7465181
	speed: 0.0031s/iter; left time: 7.3434s
	iters: 300, epoch: 4 | loss: 0.6812898
	speed: 0.0031s/iter; left time: 7.0596s
	iters: 400, epoch: 4 | loss: 1.0840116
	speed: 0.0033s/iter; left time: 7.1941s
	iters: 500, epoch: 4 | loss: 0.3403060
	speed: 0.0031s/iter; left time: 6.4548s
Updating learning rate to 4.95962787375e-05
Epoch: 4 cost time: 1.6707844734191895
Epoch: 4, Steps: 514 | Train Loss: 0.6511277 Vali Loss: 0.3798890 Best vali loss: 0.3720653
	iters: 100, epoch: 5 | loss: 0.3009343
	speed: 0.0070s/iter; left time: 13.6223s
	iters: 200, epoch: 5 | loss: 0.8467721
	speed: 0.0031s/iter; left time: 5.7748s
	iters: 300, epoch: 5 | loss: 0.9208772
	speed: 0.0031s/iter; left time: 5.3986s
	iters: 400, epoch: 5 | loss: 0.8238932
	speed: 0.0030s/iter; left time: 5.0515s
	iters: 500, epoch: 5 | loss: 0.2493737
	speed: 0.0031s/iter; left time: 4.7496s
Updating learning rate to 2.479813936875e-05
Epoch: 5 cost time: 1.6320040225982666
Epoch: 5, Steps: 514 | Train Loss: 0.6283701 Vali Loss: 0.3760754 Best vali loss: 0.3720653
	iters: 100, epoch: 6 | loss: 0.4395613
	speed: 0.0073s/iter; left time: 10.5782s
	iters: 200, epoch: 6 | loss: 0.5395348
	speed: 0.0035s/iter; left time: 4.7179s
	iters: 300, epoch: 6 | loss: 0.6113548
	speed: 0.0034s/iter; left time: 4.2473s
	iters: 400, epoch: 6 | loss: 0.4692388
	speed: 0.0034s/iter; left time: 3.8893s
	iters: 500, epoch: 6 | loss: 0.6642612
	speed: 0.0032s/iter; left time: 3.3614s
Updating learning rate to 1.2399069684375e-05
Epoch: 6 cost time: 1.7946765422821045
Epoch: 6, Steps: 514 | Train Loss: 0.5447902 Vali Loss: 0.3721287 Best vali loss: 0.3720653
	iters: 100, epoch: 7 | loss: 0.3730812
	speed: 0.0074s/iter; left time: 6.9081s
	iters: 200, epoch: 7 | loss: 0.2909908
	speed: 0.0032s/iter; left time: 2.6660s
	iters: 300, epoch: 7 | loss: 0.4073268
	speed: 0.0031s/iter; left time: 2.2529s
	iters: 400, epoch: 7 | loss: 0.3107288
	speed: 0.0031s/iter; left time: 1.9568s
	iters: 500, epoch: 7 | loss: 0.2763440
	speed: 0.0031s/iter; left time: 1.6209s
Updating learning rate to 6.1995348421875e-06
Validation loss decreased (0.3721 --> 0.3705).  Saving model state dict ...
Epoch: 7 cost time: 1.6792542934417725
Epoch: 7, Steps: 514 | Train Loss: 0.3316943 Vali Loss: 0.3705291 Best vali loss: 0.3705291
	iters: 100, epoch: 8 | loss: 0.4517611
	speed: 0.0075s/iter; left time: 3.1139s
	iters: 200, epoch: 8 | loss: 0.5270697
	speed: 0.0034s/iter; left time: 1.0560s
	iters: 300, epoch: 8 | loss: 0.6131739
	speed: 0.0034s/iter; left time: 0.7319s
	iters: 400, epoch: 8 | loss: 0.3308298
	speed: 0.0033s/iter; left time: 0.3799s
	iters: 500, epoch: 8 | loss: 0.5135716
	speed: 0.0034s/iter; left time: 0.0512s
Updating learning rate to 3.09976742109375e-06
Validation loss decreased (0.3705 --> 0.3694).  Saving model state dict ...
Epoch: 8 cost time: 1.7813384532928467
Epoch: 8, Steps: 514 | Train Loss: 0.4872812 Vali Loss: 0.3693716 Best vali loss: 0.3693716

best validation loss 0.3693716220455226

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010601728723, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4803613
	speed: 0.0158s/iter; left time: 14.7544s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 1.598958969116211
Epoch: 1, Steps: 129 | Train Loss: 0.4803613 Vali Loss: 0.3698695 Best vali loss: 0.3698695
	iters: 100, epoch: 2 | loss: 0.6219583
	speed: 0.0154s/iter; left time: 12.4203s
Updating learning rate to 0.0001652515671
Validation loss decreased (0.3699 --> 0.3563).  Saving model state dict ...
Epoch: 2 cost time: 1.288867712020874
Epoch: 2, Steps: 129 | Train Loss: 0.6219583 Vali Loss: 0.3563481 Best vali loss: 0.3563481
	iters: 100, epoch: 3 | loss: 0.6853747
	speed: 0.0157s/iter; left time: 10.6187s
Updating learning rate to 8.262578355e-05
Validation loss decreased (0.3563 --> 0.3480).  Saving model state dict ...
Epoch: 3 cost time: 1.2853233814239502
Epoch: 3, Steps: 129 | Train Loss: 0.6853747 Vali Loss: 0.3479526 Best vali loss: 0.3479526

best validation loss 0.34795259750193835

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0044405202939, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.0902185440063477
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687463 Best vali loss: 0.3687463
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3687 --> 0.3569).  Saving model state dict ...
Epoch: 2 cost time: 0.7800436019897461
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3569354 Best vali loss: 0.3569354
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3569 --> 0.3522).  Saving model state dict ...
Epoch: 3 cost time: 0.7824983596801758
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3521576 Best vali loss: 0.3521576

best validation loss 0.3521576259834125

[INFO][smbo.py:320] Finished 1100 trials.
{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.002602100471, 'e_layers': 3, 'learning_rate': 0.0036490286324, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003510145749711006
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 0.7369928359985352
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715489 Best vali loss: 0.3715489
Updating learning rate to 0.0031146407615569565
Epoch: 2 cost time: 0.3965952396392822
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3873519 Best vali loss: 0.3715489
Updating learning rate to 0.0025227257171226607
Validation loss decreased (0.3715 --> 0.3712).  Saving model state dict ...
Epoch: 3 cost time: 0.4263427257537842
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3712303 Best vali loss: 0.3712303

best validation loss 0.3712303009389192

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010601728723, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3686560
	speed: 0.0168s/iter; left time: 9.1975s
Updating learning rate to 4.1312891775e-05
Validation loss decreased (0.3480 --> 0.3436).  Saving model state dict ...
Epoch: 4 cost time: 1.6300303936004639
Epoch: 4, Steps: 129 | Train Loss: 0.3686560 Vali Loss: 0.3436321 Best vali loss: 0.3436321
	iters: 100, epoch: 5 | loss: 0.4520801
	speed: 0.0159s/iter; left time: 6.6245s
Updating learning rate to 2.06564458875e-05
Epoch: 5 cost time: 1.291975498199463
Epoch: 5, Steps: 129 | Train Loss: 0.4520801 Vali Loss: 0.3459531 Best vali loss: 0.3436321
	iters: 100, epoch: 6 | loss: 0.5578827
	speed: 0.0152s/iter; left time: 4.3874s
Updating learning rate to 1.032822294375e-05
Epoch: 6 cost time: 1.2852091789245605
Epoch: 6, Steps: 129 | Train Loss: 0.5578827 Vali Loss: 0.3480003 Best vali loss: 0.3436321
	iters: 100, epoch: 7 | loss: 0.6166483
	speed: 0.0151s/iter; left time: 2.4071s
Updating learning rate to 5.164111471875e-06
Epoch: 7 cost time: 1.285742998123169
Epoch: 7, Steps: 129 | Train Loss: 0.6166483 Vali Loss: 0.3500199 Best vali loss: 0.3436321
	iters: 100, epoch: 8 | loss: 0.4476276
	speed: 0.0152s/iter; left time: 0.4554s
Updating learning rate to 2.5820557359375e-06
Epoch: 8 cost time: 1.2903087139129639
Epoch: 8, Steps: 129 | Train Loss: 0.4476276 Vali Loss: 0.3493512 Best vali loss: 0.3436321

best validation loss 0.3436320590598176

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0059703083572, 'e_layers': 2, 'learning_rate': 0.0003948202653, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4266714
	speed: 0.0099s/iter; left time: 39.7531s
	iters: 200, epoch: 1 | loss: 1.0782639
	speed: 0.0036s/iter; left time: 14.2211s
	iters: 300, epoch: 1 | loss: 1.0148314
	speed: 0.0036s/iter; left time: 13.7992s
	iters: 400, epoch: 1 | loss: 0.5041136
	speed: 0.0036s/iter; left time: 13.3257s
	iters: 500, epoch: 1 | loss: 1.1723868
	speed: 0.0036s/iter; left time: 13.0097s
Updating learning rate to 0.0003948202653
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 2.2161364555358887
Epoch: 1, Steps: 514 | Train Loss: 0.8392534 Vali Loss: 0.3713419 Best vali loss: 0.3713419
	iters: 100, epoch: 2 | loss: 0.3902124
	speed: 0.0075s/iter; left time: 26.1875s
	iters: 200, epoch: 2 | loss: 0.2678096
	speed: 0.0032s/iter; left time: 10.9532s
	iters: 300, epoch: 2 | loss: 0.4573388
	speed: 0.0032s/iter; left time: 10.6567s
	iters: 400, epoch: 2 | loss: 0.3909784
	speed: 0.0033s/iter; left time: 10.4059s
	iters: 500, epoch: 2 | loss: 0.6133802
	speed: 0.0033s/iter; left time: 10.2899s
Updating learning rate to 0.00019741013265
Validation loss decreased (0.3713 --> 0.3624).  Saving model state dict ...
Epoch: 2 cost time: 1.7323777675628662
Epoch: 2, Steps: 514 | Train Loss: 0.4239439 Vali Loss: 0.3623835 Best vali loss: 0.3623835
	iters: 100, epoch: 3 | loss: 0.3570522
	speed: 0.0072s/iter; left time: 21.4823s
	iters: 200, epoch: 3 | loss: 0.8758751
	speed: 0.0032s/iter; left time: 9.3133s
	iters: 300, epoch: 3 | loss: 0.5040524
	speed: 0.0032s/iter; left time: 9.0318s
	iters: 400, epoch: 3 | loss: 0.4645259
	speed: 0.0032s/iter; left time: 8.6571s
	iters: 500, epoch: 3 | loss: 1.0664463
	speed: 0.0033s/iter; left time: 8.5613s
Updating learning rate to 9.8705066325e-05
Validation loss decreased (0.3624 --> 0.3457).  Saving model state dict ...
Epoch: 3 cost time: 1.709580659866333
Epoch: 3, Steps: 514 | Train Loss: 0.6535904 Vali Loss: 0.3457003 Best vali loss: 0.3457003
	iters: 100, epoch: 4 | loss: 0.5449821
	speed: 0.0075s/iter; left time: 18.4963s
	iters: 200, epoch: 4 | loss: 0.4441628
	speed: 0.0032s/iter; left time: 7.6652s
	iters: 300, epoch: 4 | loss: 0.5229024
	speed: 0.0034s/iter; left time: 7.7675s
	iters: 400, epoch: 4 | loss: 0.6847744
	speed: 0.0035s/iter; left time: 7.5687s
	iters: 500, epoch: 4 | loss: 0.7270305
	speed: 0.0034s/iter; left time: 7.1421s
Updating learning rate to 4.93525331625e-05
Validation loss decreased (0.3457 --> 0.3399).  Saving model state dict ...
Epoch: 4 cost time: 1.7768113613128662
Epoch: 4, Steps: 514 | Train Loss: 0.5847704 Vali Loss: 0.3399313 Best vali loss: 0.3399313
	iters: 100, epoch: 5 | loss: 0.5352636
	speed: 0.0072s/iter; left time: 14.1740s
	iters: 200, epoch: 5 | loss: 0.7439498
	speed: 0.0032s/iter; left time: 5.9165s
	iters: 300, epoch: 5 | loss: 0.4790901
	speed: 0.0032s/iter; left time: 5.6518s
	iters: 400, epoch: 5 | loss: 0.8117403
	speed: 0.0033s/iter; left time: 5.4737s
	iters: 500, epoch: 5 | loss: 0.5814816
	speed: 0.0033s/iter; left time: 5.1347s
Updating learning rate to 2.467626658125e-05
Epoch: 5 cost time: 1.720231294631958
Epoch: 5, Steps: 514 | Train Loss: 0.6303051 Vali Loss: 0.3441249 Best vali loss: 0.3399313
	iters: 100, epoch: 6 | loss: 0.2968717
	speed: 0.0072s/iter; left time: 10.4523s
	iters: 200, epoch: 6 | loss: 0.4752416
	speed: 0.0032s/iter; left time: 4.2654s
	iters: 300, epoch: 6 | loss: 0.3530991
	speed: 0.0031s/iter; left time: 3.8353s
	iters: 400, epoch: 6 | loss: 0.7470626
	speed: 0.0031s/iter; left time: 3.5118s
	iters: 500, epoch: 6 | loss: 0.9521577
	speed: 0.0031s/iter; left time: 3.2083s
Updating learning rate to 1.2338133290625e-05
Epoch: 6 cost time: 1.6640214920043945
Epoch: 6, Steps: 514 | Train Loss: 0.5648865 Vali Loss: 0.3416613 Best vali loss: 0.3399313
	iters: 100, epoch: 7 | loss: 0.3799160
	speed: 0.0073s/iter; left time: 6.7698s
	iters: 200, epoch: 7 | loss: 0.3034143
	speed: 0.0034s/iter; left time: 2.8226s
	iters: 300, epoch: 7 | loss: 0.3673415
	speed: 0.0034s/iter; left time: 2.4570s
	iters: 400, epoch: 7 | loss: 0.4118246
	speed: 0.0033s/iter; left time: 2.0977s
	iters: 500, epoch: 7 | loss: 0.8081990
	speed: 0.0033s/iter; left time: 1.7700s
Updating learning rate to 6.1690666453125e-06
Validation loss decreased (0.3399 --> 0.3396).  Saving model state dict ...
Epoch: 7 cost time: 1.786393165588379
Epoch: 7, Steps: 514 | Train Loss: 0.4541391 Vali Loss: 0.3395679 Best vali loss: 0.3395679
	iters: 100, epoch: 8 | loss: 0.3727829
	speed: 0.0076s/iter; left time: 3.1576s
	iters: 200, epoch: 8 | loss: 0.2309994
	speed: 0.0033s/iter; left time: 1.0506s
	iters: 300, epoch: 8 | loss: 0.3811162
	speed: 0.0034s/iter; left time: 0.7336s
	iters: 400, epoch: 8 | loss: 0.4326774
	speed: 0.0034s/iter; left time: 0.3914s
	iters: 500, epoch: 8 | loss: 0.2536754
	speed: 0.0034s/iter; left time: 0.0514s
Updating learning rate to 3.08453332265625e-06
Epoch: 8 cost time: 1.7880349159240723
Epoch: 8, Steps: 514 | Train Loss: 0.3342503 Vali Loss: 0.3410993 Best vali loss: 0.3395679

best validation loss 0.3395679087559226

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0061438855701, 'e_layers': 4, 'learning_rate': 0.0026446692174, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5533797
	speed: 0.0115s/iter; left time: 22.4329s
	iters: 200, epoch: 1 | loss: 0.6354041
	speed: 0.0054s/iter; left time: 10.0229s
Updating learning rate to 0.0026446692174
Validation loss decreased (inf --> 0.4035).  Saving model state dict ...
Epoch: 1 cost time: 1.7260146141052246
Epoch: 1, Steps: 257 | Train Loss: 0.5943919 Vali Loss: 0.4035077 Best vali loss: 0.4035077
	iters: 100, epoch: 2 | loss: 0.8028442
	speed: 0.0113s/iter; left time: 19.1788s
	iters: 200, epoch: 2 | loss: 0.8689802
	speed: 0.0054s/iter; left time: 8.6926s
Updating learning rate to 0.0013223346087
Validation loss decreased (0.4035 --> 0.4027).  Saving model state dict ...
Epoch: 2 cost time: 1.4510390758514404
Epoch: 2, Steps: 257 | Train Loss: 0.8359122 Vali Loss: 0.4026589 Best vali loss: 0.4026589
	iters: 100, epoch: 3 | loss: 0.9052376
	speed: 0.0111s/iter; left time: 16.0104s
	iters: 200, epoch: 3 | loss: 0.7133463
	speed: 0.0050s/iter; left time: 6.7026s
Updating learning rate to 0.00066116730435
Validation loss decreased (0.4027 --> 0.4019).  Saving model state dict ...
Epoch: 3 cost time: 1.3226587772369385
Epoch: 3, Steps: 257 | Train Loss: 0.8092920 Vali Loss: 0.4019166 Best vali loss: 0.4019166
	iters: 100, epoch: 4 | loss: 0.7252746
	speed: 0.0107s/iter; left time: 12.6991s
	iters: 200, epoch: 4 | loss: 0.8487822
	speed: 0.0051s/iter; left time: 5.5123s
Updating learning rate to 0.000330583652175
Epoch: 4 cost time: 1.3555448055267334
Epoch: 4, Steps: 257 | Train Loss: 0.7870284 Vali Loss: 0.4022030 Best vali loss: 0.4019166
	iters: 100, epoch: 5 | loss: 0.7355032
	speed: 0.0110s/iter; left time: 10.2485s
	iters: 200, epoch: 5 | loss: 0.6902057
	speed: 0.0052s/iter; left time: 4.3341s
Updating learning rate to 0.0001652918260875
Epoch: 5 cost time: 1.3768291473388672
Epoch: 5, Steps: 257 | Train Loss: 0.7128544 Vali Loss: 0.4026936 Best vali loss: 0.4019166
	iters: 100, epoch: 6 | loss: 0.6134582
	speed: 0.0104s/iter; left time: 7.0095s
	iters: 200, epoch: 6 | loss: 0.6043897
	speed: 0.0049s/iter; left time: 2.8115s
Updating learning rate to 8.264591304375e-05
Epoch: 6 cost time: 1.3142738342285156
Epoch: 6, Steps: 257 | Train Loss: 0.6089240 Vali Loss: 0.4033069 Best vali loss: 0.4019166
	iters: 100, epoch: 7 | loss: 0.7443554
	speed: 0.0103s/iter; left time: 4.2802s
	iters: 200, epoch: 7 | loss: 0.6536869
	speed: 0.0049s/iter; left time: 1.5336s
Updating learning rate to 4.1322956521875e-05
Epoch: 7 cost time: 1.3040010929107666
Epoch: 7, Steps: 257 | Train Loss: 0.6990211 Vali Loss: 0.4032315 Best vali loss: 0.4019166
	iters: 100, epoch: 8 | loss: 0.4551711
	speed: 0.0109s/iter; left time: 1.7300s
	iters: 200, epoch: 8 | loss: 0.4640827
	speed: 0.0055s/iter; left time: 0.3217s
Updating learning rate to 2.06614782609375e-05
Epoch: 8 cost time: 1.4628491401672363
Epoch: 8, Steps: 257 | Train Loss: 0.4596269 Vali Loss: 0.4034025 Best vali loss: 0.4019166

best validation loss 0.40191660830220444

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0038086791192, 'e_layers': 4, 'learning_rate': 8.29494957e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7433116
	speed: 0.0112s/iter; left time: 91.1659s
	iters: 200, epoch: 1 | loss: 1.8122077
	speed: 0.0051s/iter; left time: 40.5660s
	iters: 300, epoch: 1 | loss: 0.2459071
	speed: 0.0051s/iter; left time: 40.2196s
	iters: 400, epoch: 1 | loss: 0.8161615
	speed: 0.0051s/iter; left time: 39.9342s
	iters: 500, epoch: 1 | loss: 0.2691518
	speed: 0.0051s/iter; left time: 39.4709s
	iters: 600, epoch: 1 | loss: 0.5053990
	speed: 0.0051s/iter; left time: 39.0402s
	iters: 700, epoch: 1 | loss: 0.6083616
	speed: 0.0051s/iter; left time: 38.1142s
	iters: 800, epoch: 1 | loss: 0.5767710
	speed: 0.0051s/iter; left time: 37.7428s
	iters: 900, epoch: 1 | loss: 0.5745327
	speed: 0.0051s/iter; left time: 36.9581s
	iters: 1000, epoch: 1 | loss: 0.4637517
	speed: 0.0051s/iter; left time: 36.5732s
Updating learning rate to 7.97924185046815e-05
Validation loss decreased (inf --> 0.3662).  Saving model state dict ...
Epoch: 1 cost time: 5.583442687988281
Epoch: 1, Steps: 1027 | Train Loss: 0.6615556 Vali Loss: 0.3661560 Best vali loss: 0.3661560
	iters: 100, epoch: 2 | loss: 0.2924152
	speed: 0.0136s/iter; left time: 96.6668s
	iters: 200, epoch: 2 | loss: 0.4992956
	speed: 0.0047s/iter; left time: 32.7422s
	iters: 300, epoch: 2 | loss: 0.3515298
	speed: 0.0049s/iter; left time: 34.0073s
	iters: 400, epoch: 2 | loss: 0.7215589
	speed: 0.0046s/iter; left time: 31.5037s
	iters: 500, epoch: 2 | loss: 0.7234062
	speed: 0.0051s/iter; left time: 34.1219s
	iters: 600, epoch: 2 | loss: 0.8602598
	speed: 0.0053s/iter; left time: 34.8885s
	iters: 700, epoch: 2 | loss: 0.4852233
	speed: 0.0053s/iter; left time: 34.5155s
	iters: 800, epoch: 2 | loss: 0.2502289
	speed: 0.0053s/iter; left time: 33.7920s
	iters: 900, epoch: 2 | loss: 0.3238558
	speed: 0.0053s/iter; left time: 33.4558s
	iters: 1000, epoch: 2 | loss: 0.4080466
	speed: 0.0052s/iter; left time: 32.0935s
Updating learning rate to 7.080182330273718e-05
Epoch: 2 cost time: 5.263795614242554
Epoch: 2, Steps: 1027 | Train Loss: 0.4915820 Vali Loss: 0.3664129 Best vali loss: 0.3661560
	iters: 100, epoch: 3 | loss: 0.3906689
	speed: 0.0125s/iter; left time: 76.0738s
	iters: 200, epoch: 3 | loss: 0.2784507
	speed: 0.0048s/iter; left time: 28.5570s
	iters: 300, epoch: 3 | loss: 0.8242962
	speed: 0.0048s/iter; left time: 27.9103s
	iters: 400, epoch: 3 | loss: 0.7322135
	speed: 0.0048s/iter; left time: 27.7396s
	iters: 500, epoch: 3 | loss: 0.4056924
	speed: 0.0047s/iter; left time: 26.8485s
	iters: 600, epoch: 3 | loss: 0.2018676
	speed: 0.0047s/iter; left time: 26.3408s
	iters: 700, epoch: 3 | loss: 0.2117962
	speed: 0.0048s/iter; left time: 26.3001s
	iters: 800, epoch: 3 | loss: 0.1899715
	speed: 0.0047s/iter; left time: 25.1514s
	iters: 900, epoch: 3 | loss: 1.5638771
	speed: 0.0047s/iter; left time: 24.5345s
	iters: 1000, epoch: 3 | loss: 0.5096615
	speed: 0.0047s/iter; left time: 24.1593s
Updating learning rate to 5.734644671371463e-05
Validation loss decreased (0.3662 --> 0.3488).  Saving model state dict ...
Epoch: 3 cost time: 4.914712190628052
Epoch: 3, Steps: 1027 | Train Loss: 0.5308496 Vali Loss: 0.3487532 Best vali loss: 0.3487532

best validation loss 0.3487531527789028

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0091255187689, 'e_layers': 4, 'learning_rate': 0.000131501589, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000131501589
Validation loss decreased (inf --> 0.4081).  Saving model state dict ...
Epoch: 1 cost time: 0.7856779098510742
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4080894 Best vali loss: 0.4080894
Updating learning rate to 6.57507945e-05
Validation loss decreased (0.4081 --> 0.3885).  Saving model state dict ...
Epoch: 2 cost time: 0.47705888748168945
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3884782 Best vali loss: 0.3884782
Updating learning rate to 3.287539725e-05
Validation loss decreased (0.3885 --> 0.3827).  Saving model state dict ...
Epoch: 3 cost time: 0.47837376594543457
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3827276 Best vali loss: 0.3827276

best validation loss 0.3827275792952839

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6053879
	speed: 0.0113s/iter; left time: 45.4679s
	iters: 200, epoch: 1 | loss: 0.8436655
	speed: 0.0052s/iter; left time: 20.4949s
	iters: 300, epoch: 1 | loss: 1.3957123
	speed: 0.0053s/iter; left time: 20.3554s
	iters: 400, epoch: 1 | loss: 0.3189809
	speed: 0.0053s/iter; left time: 19.7462s
	iters: 500, epoch: 1 | loss: 1.0177127
	speed: 0.0052s/iter; left time: 18.9087s
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3912).  Saving model state dict ...
Epoch: 1 cost time: 3.0651540756225586
Epoch: 1, Steps: 514 | Train Loss: 0.8362918 Vali Loss: 0.3911912 Best vali loss: 0.3911912
	iters: 100, epoch: 2 | loss: 1.0221174
	speed: 0.0099s/iter; left time: 34.6344s
	iters: 200, epoch: 2 | loss: 0.8984033
	speed: 0.0050s/iter; left time: 16.8701s
	iters: 300, epoch: 2 | loss: 0.8854103
	speed: 0.0050s/iter; left time: 16.3726s
	iters: 400, epoch: 2 | loss: 0.8571593
	speed: 0.0049s/iter; left time: 15.7990s
	iters: 500, epoch: 2 | loss: 0.6157331
	speed: 0.0048s/iter; left time: 14.7779s
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 2.5499839782714844
Epoch: 2, Steps: 514 | Train Loss: 0.8557647 Vali Loss: 0.3930064 Best vali loss: 0.3911912
	iters: 100, epoch: 3 | loss: 0.3174051
	speed: 0.0101s/iter; left time: 30.1937s
	iters: 200, epoch: 3 | loss: 0.6201831
	speed: 0.0049s/iter; left time: 14.1789s
	iters: 300, epoch: 3 | loss: 0.6104678
	speed: 0.0048s/iter; left time: 13.4097s
	iters: 400, epoch: 3 | loss: 1.0281787
	speed: 0.0048s/iter; left time: 12.9518s
	iters: 500, epoch: 3 | loss: 0.4346683
	speed: 0.0050s/iter; left time: 12.8450s
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 2.6029469966888428
Epoch: 3, Steps: 514 | Train Loss: 0.6021806 Vali Loss: 0.3985028 Best vali loss: 0.3911912

best validation loss 0.39119124027272806

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0038086791192, 'e_layers': 4, 'learning_rate': 8.29494957e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7182016
	speed: 0.0131s/iter; left time: 66.0582s
	iters: 200, epoch: 4 | loss: 1.3171427
	speed: 0.0053s/iter; left time: 26.1226s
	iters: 300, epoch: 4 | loss: 0.1890242
	speed: 0.0053s/iter; left time: 25.5819s
	iters: 400, epoch: 4 | loss: 0.6081196
	speed: 0.0050s/iter; left time: 23.6345s
	iters: 500, epoch: 4 | loss: 0.2257818
	speed: 0.0050s/iter; left time: 23.0055s
	iters: 600, epoch: 4 | loss: 0.3065121
	speed: 0.0049s/iter; left time: 22.0360s
	iters: 700, epoch: 4 | loss: 0.5179181
	speed: 0.0048s/iter; left time: 21.4535s
	iters: 800, epoch: 4 | loss: 0.5417708
	speed: 0.0049s/iter; left time: 21.0767s
	iters: 900, epoch: 4 | loss: 0.5271631
	speed: 0.0048s/iter; left time: 20.4727s
	iters: 1000, epoch: 4 | loss: 0.2735739
	speed: 0.0050s/iter; left time: 20.5255s
Updating learning rate to 4.147474785e-05
Epoch: 4 cost time: 5.530867099761963
Epoch: 4, Steps: 1027 | Train Loss: 0.5225208 Vali Loss: 0.3521257 Best vali loss: 0.3487532
	iters: 100, epoch: 5 | loss: 0.2500203
	speed: 0.0132s/iter; left time: 52.8324s
	iters: 200, epoch: 5 | loss: 0.3122589
	speed: 0.0050s/iter; left time: 19.5403s
	iters: 300, epoch: 5 | loss: 0.3603352
	speed: 0.0050s/iter; left time: 18.9498s
	iters: 400, epoch: 5 | loss: 0.6892163
	speed: 0.0048s/iter; left time: 17.7462s
	iters: 500, epoch: 5 | loss: 0.6678030
	speed: 0.0048s/iter; left time: 17.4069s
	iters: 600, epoch: 5 | loss: 0.5879037
	speed: 0.0048s/iter; left time: 16.8782s
	iters: 700, epoch: 5 | loss: 0.4537448
	speed: 0.0048s/iter; left time: 16.4752s
	iters: 800, epoch: 5 | loss: 0.2364867
	speed: 0.0049s/iter; left time: 16.1693s
	iters: 900, epoch: 5 | loss: 0.2130185
	speed: 0.0050s/iter; left time: 16.1410s
	iters: 1000, epoch: 5 | loss: 0.3400020
	speed: 0.0049s/iter; left time: 15.3871s
Updating learning rate to 2.5603048986285377e-05
Epoch: 5 cost time: 5.086755752563477
Epoch: 5, Steps: 1027 | Train Loss: 0.4110790 Vali Loss: 0.3591387 Best vali loss: 0.3487532
	iters: 100, epoch: 6 | loss: 0.3467385
	speed: 0.0133s/iter; left time: 39.6978s
	iters: 200, epoch: 6 | loss: 0.2434372
	speed: 0.0050s/iter; left time: 14.4415s
	iters: 300, epoch: 6 | loss: 0.4997093
	speed: 0.0050s/iter; left time: 13.9346s
	iters: 400, epoch: 6 | loss: 0.6638029
	speed: 0.0050s/iter; left time: 13.4111s
	iters: 500, epoch: 6 | loss: 0.2689757
	speed: 0.0050s/iter; left time: 12.8567s
	iters: 600, epoch: 6 | loss: 0.1731126
	speed: 0.0050s/iter; left time: 12.4389s
	iters: 700, epoch: 6 | loss: 0.1771657
	speed: 0.0050s/iter; left time: 11.9078s
	iters: 800, epoch: 6 | loss: 0.1614248
	speed: 0.0050s/iter; left time: 11.4290s
	iters: 900, epoch: 6 | loss: 0.9712719
	speed: 0.0050s/iter; left time: 10.8922s
	iters: 1000, epoch: 6 | loss: 0.4574610
	speed: 0.0050s/iter; left time: 10.4284s
Updating learning rate to 1.214767239726282e-05
Epoch: 6 cost time: 5.17680025100708
Epoch: 6, Steps: 1027 | Train Loss: 0.3963100 Vali Loss: 0.3679674 Best vali loss: 0.3487532
	iters: 100, epoch: 7 | loss: 0.2383554
	speed: 0.0128s/iter; left time: 25.0772s
	iters: 200, epoch: 7 | loss: 0.1901150
	speed: 0.0049s/iter; left time: 9.0177s
	iters: 300, epoch: 7 | loss: 0.5612838
	speed: 0.0048s/iter; left time: 8.5027s
	iters: 400, epoch: 7 | loss: 0.2188311
	speed: 0.0049s/iter; left time: 8.0269s
	iters: 500, epoch: 7 | loss: 0.4146820
	speed: 0.0049s/iter; left time: 7.5792s
	iters: 600, epoch: 7 | loss: 0.4079920
	speed: 0.0049s/iter; left time: 7.1121s
	iters: 700, epoch: 7 | loss: 0.4053526
	speed: 0.0049s/iter; left time: 6.6089s
	iters: 800, epoch: 7 | loss: 0.3517220
	speed: 0.0049s/iter; left time: 6.1264s
	iters: 900, epoch: 7 | loss: 0.2522638
	speed: 0.0049s/iter; left time: 5.6053s
	iters: 1000, epoch: 7 | loss: 0.1782826
	speed: 0.0049s/iter; left time: 5.1324s
Updating learning rate to 3.1570771953185053e-06
Epoch: 7 cost time: 5.037960052490234
Epoch: 7, Steps: 1027 | Train Loss: 0.3218880 Vali Loss: 0.3751072 Best vali loss: 0.3487532
	iters: 100, epoch: 8 | loss: 0.4902575
	speed: 0.0136s/iter; left time: 12.5755s
	iters: 200, epoch: 8 | loss: 0.5626917
	speed: 0.0051s/iter; left time: 4.1876s
	iters: 300, epoch: 8 | loss: 0.5591061
	speed: 0.0050s/iter; left time: 3.6420s
	iters: 400, epoch: 8 | loss: 0.3582366
	speed: 0.0050s/iter; left time: 3.1567s
	iters: 500, epoch: 8 | loss: 0.6103152
	speed: 0.0050s/iter; left time: 2.6474s
	iters: 600, epoch: 8 | loss: 0.3000062
	speed: 0.0050s/iter; left time: 2.1527s
	iters: 700, epoch: 8 | loss: 0.4892146
	speed: 0.0050s/iter; left time: 1.6434s
	iters: 800, epoch: 8 | loss: 0.4482429
	speed: 0.0050s/iter; left time: 1.1463s
	iters: 900, epoch: 8 | loss: 0.4471650
	speed: 0.0050s/iter; left time: 0.6426s
	iters: 1000, epoch: 8 | loss: 0.4373764
	speed: 0.0050s/iter; left time: 0.1407s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.19843316078186
Epoch: 8, Steps: 1027 | Train Loss: 0.4702612 Vali Loss: 0.3802647 Best vali loss: 0.3487532

best validation loss 0.3487531527789028

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0102481085001, 'e_layers': 4, 'learning_rate': 7.83663181e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6055087
	speed: 0.0112s/iter; left time: 44.9587s
	iters: 200, epoch: 1 | loss: 0.3314378
	speed: 0.0050s/iter; left time: 19.5542s
	iters: 300, epoch: 1 | loss: 0.6624224
	speed: 0.0050s/iter; left time: 19.1451s
	iters: 400, epoch: 1 | loss: 1.1676527
	speed: 0.0051s/iter; left time: 18.8593s
	iters: 500, epoch: 1 | loss: 0.6194794
	speed: 0.0045s/iter; left time: 16.3920s
Updating learning rate to 7.53836777154294e-05
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 2.870508909225464
Epoch: 1, Steps: 514 | Train Loss: 0.6773002 Vali Loss: 0.3701166 Best vali loss: 0.3701166
	iters: 100, epoch: 2 | loss: 0.4743713
	speed: 0.0098s/iter; left time: 34.2070s
	iters: 200, epoch: 2 | loss: 0.7657239
	speed: 0.0050s/iter; left time: 17.0067s
	iters: 300, epoch: 2 | loss: 1.0247447
	speed: 0.0051s/iter; left time: 16.6603s
	iters: 400, epoch: 2 | loss: 0.7557161
	speed: 0.0050s/iter; left time: 15.8414s
	iters: 500, epoch: 2 | loss: 0.3808816
	speed: 0.0048s/iter; left time: 14.7386s
Updating learning rate to 6.688983652256604e-05
Validation loss decreased (0.3701 --> 0.3645).  Saving model state dict ...
Epoch: 2 cost time: 2.6071321964263916
Epoch: 2, Steps: 514 | Train Loss: 0.6802876 Vali Loss: 0.3645499 Best vali loss: 0.3645499
	iters: 100, epoch: 3 | loss: 0.3671573
	speed: 0.0095s/iter; left time: 28.3522s
	iters: 200, epoch: 3 | loss: 0.5224334
	speed: 0.0048s/iter; left time: 13.7969s
	iters: 300, epoch: 3 | loss: 0.8960881
	speed: 0.0047s/iter; left time: 13.2095s
	iters: 400, epoch: 3 | loss: 0.7016938
	speed: 0.0047s/iter; left time: 12.6567s
	iters: 500, epoch: 3 | loss: 0.3639402
	speed: 0.0047s/iter; left time: 12.0280s
Updating learning rate to 5.417790484616123e-05
Validation loss decreased (0.3645 --> 0.3616).  Saving model state dict ...
Epoch: 3 cost time: 2.467261791229248
Epoch: 3, Steps: 514 | Train Loss: 0.5702625 Vali Loss: 0.3616376 Best vali loss: 0.3616376
	iters: 100, epoch: 4 | loss: 0.7338046
	speed: 0.0093s/iter; left time: 22.9827s
	iters: 200, epoch: 4 | loss: 0.3826492
	speed: 0.0050s/iter; left time: 11.8140s
	iters: 300, epoch: 4 | loss: 0.2772057
	speed: 0.0051s/iter; left time: 11.4852s
	iters: 400, epoch: 4 | loss: 0.4371569
	speed: 0.0047s/iter; left time: 10.3033s
	iters: 500, epoch: 4 | loss: 0.8854652
	speed: 0.0045s/iter; left time: 9.2470s
Updating learning rate to 3.918315905e-05
Epoch: 4 cost time: 2.4909110069274902
Epoch: 4, Steps: 514 | Train Loss: 0.5432563 Vali Loss: 0.3622200 Best vali loss: 0.3616376
	iters: 100, epoch: 5 | loss: 0.6646565
	speed: 0.0099s/iter; left time: 19.3883s
	iters: 200, epoch: 5 | loss: 0.6656572
	speed: 0.0050s/iter; left time: 9.3237s
	iters: 300, epoch: 5 | loss: 0.6200553
	speed: 0.0053s/iter; left time: 9.2295s
	iters: 400, epoch: 5 | loss: 0.5479457
	speed: 0.0053s/iter; left time: 8.7560s
	iters: 500, epoch: 5 | loss: 0.6128311
	speed: 0.0052s/iter; left time: 8.0474s
Updating learning rate to 2.4188413253838772e-05
Epoch: 5 cost time: 2.695807456970215
Epoch: 5, Steps: 514 | Train Loss: 0.6222291 Vali Loss: 0.3747496 Best vali loss: 0.3616376
	iters: 100, epoch: 6 | loss: 0.8295302
	speed: 0.0094s/iter; left time: 13.5799s
	iters: 200, epoch: 6 | loss: 0.7006216
	speed: 0.0050s/iter; left time: 6.7287s
	iters: 300, epoch: 6 | loss: 1.1196250
	speed: 0.0047s/iter; left time: 5.8687s
	iters: 400, epoch: 6 | loss: 0.4130865
	speed: 0.0045s/iter; left time: 5.1659s
	iters: 500, epoch: 6 | loss: 0.6174518
	speed: 0.0046s/iter; left time: 4.7995s
Updating learning rate to 1.1476481577433962e-05
Epoch: 6 cost time: 2.4605724811553955
Epoch: 6, Steps: 514 | Train Loss: 0.7360630 Vali Loss: 0.3778797 Best vali loss: 0.3616376
	iters: 100, epoch: 7 | loss: 0.5604761
	speed: 0.0093s/iter; left time: 8.6373s
	iters: 200, epoch: 7 | loss: 0.7450932
	speed: 0.0047s/iter; left time: 3.8741s
	iters: 300, epoch: 7 | loss: 0.9363490
	speed: 0.0047s/iter; left time: 3.3958s
	iters: 400, epoch: 7 | loss: 0.6643369
	speed: 0.0047s/iter; left time: 2.9437s
	iters: 500, epoch: 7 | loss: 1.1802694
	speed: 0.0047s/iter; left time: 2.4968s
Updating learning rate to 2.982640384570606e-06
Epoch: 7 cost time: 2.4564688205718994
Epoch: 7, Steps: 514 | Train Loss: 0.8173049 Vali Loss: 0.3794824 Best vali loss: 0.3616376
	iters: 100, epoch: 8 | loss: 0.2962511
	speed: 0.0092s/iter; left time: 3.7979s
	iters: 200, epoch: 8 | loss: 0.5323892
	speed: 0.0047s/iter; left time: 1.4761s
	iters: 300, epoch: 8 | loss: 0.6784498
	speed: 0.0048s/iter; left time: 1.0220s
	iters: 400, epoch: 8 | loss: 0.3478175
	speed: 0.0047s/iter; left time: 0.5388s
	iters: 500, epoch: 8 | loss: 0.4437315
	speed: 0.0047s/iter; left time: 0.0704s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.4420671463012695
Epoch: 8, Steps: 514 | Train Loss: 0.4597278 Vali Loss: 0.3778197 Best vali loss: 0.3616376

best validation loss 0.36163760707631326

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022965436265, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6980838
	speed: 0.0113s/iter; left time: 45.2954s
	iters: 200, epoch: 1 | loss: 0.8399378
	speed: 0.0051s/iter; left time: 19.9205s
	iters: 300, epoch: 1 | loss: 1.4230698
	speed: 0.0051s/iter; left time: 19.6305s
	iters: 400, epoch: 1 | loss: 0.3064702
	speed: 0.0052s/iter; left time: 19.1823s
	iters: 500, epoch: 1 | loss: 1.0594802
	speed: 0.0051s/iter; left time: 18.5598s
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3986).  Saving model state dict ...
Epoch: 1 cost time: 2.991016387939453
Epoch: 1, Steps: 514 | Train Loss: 0.8654084 Vali Loss: 0.3986172 Best vali loss: 0.3986172
	iters: 100, epoch: 2 | loss: 1.0597562
	speed: 0.0102s/iter; left time: 35.7292s
	iters: 200, epoch: 2 | loss: 0.8902043
	speed: 0.0044s/iter; left time: 14.9942s
	iters: 300, epoch: 2 | loss: 0.8958332
	speed: 0.0047s/iter; left time: 15.5789s
	iters: 400, epoch: 2 | loss: 0.8645992
	speed: 0.0048s/iter; left time: 15.2977s
	iters: 500, epoch: 2 | loss: 0.6439426
	speed: 0.0046s/iter; left time: 14.3576s
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 2.4810168743133545
Epoch: 2, Steps: 514 | Train Loss: 0.8708671 Vali Loss: 0.4037592 Best vali loss: 0.3986172
	iters: 100, epoch: 3 | loss: 0.3209889
	speed: 0.0101s/iter; left time: 30.0158s
	iters: 200, epoch: 3 | loss: 0.6309854
	speed: 0.0053s/iter; left time: 15.1776s
	iters: 300, epoch: 3 | loss: 0.6191978
	speed: 0.0050s/iter; left time: 13.9076s
	iters: 400, epoch: 3 | loss: 1.0137081
	speed: 0.0049s/iter; left time: 13.0494s
	iters: 500, epoch: 3 | loss: 0.4252799
	speed: 0.0049s/iter; left time: 12.7434s
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 2.6553728580474854
Epoch: 3, Steps: 514 | Train Loss: 0.6020320 Vali Loss: 0.4082435 Best vali loss: 0.3986172
	iters: 100, epoch: 4 | loss: 0.3621607
	speed: 0.0102s/iter; left time: 25.0902s
	iters: 200, epoch: 4 | loss: 0.8434136
	speed: 0.0052s/iter; left time: 12.3066s
	iters: 300, epoch: 4 | loss: 1.2519525
	speed: 0.0053s/iter; left time: 11.9342s
	iters: 400, epoch: 4 | loss: 0.3695617
	speed: 0.0052s/iter; left time: 11.1920s
	iters: 500, epoch: 4 | loss: 1.3066344
	speed: 0.0051s/iter; left time: 10.5376s
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 2.6994380950927734
Epoch: 4, Steps: 514 | Train Loss: 0.8267446 Vali Loss: 0.4033583 Best vali loss: 0.3986172
	iters: 100, epoch: 5 | loss: 0.5431536
	speed: 0.0099s/iter; left time: 19.3911s
	iters: 200, epoch: 5 | loss: 0.5067822
	speed: 0.0045s/iter; left time: 8.4059s
	iters: 300, epoch: 5 | loss: 0.6015404
	speed: 0.0049s/iter; left time: 8.5653s
	iters: 400, epoch: 5 | loss: 0.9896510
	speed: 0.0049s/iter; left time: 8.1126s
	iters: 500, epoch: 5 | loss: 0.3691339
	speed: 0.0049s/iter; left time: 7.5820s
Updating learning rate to 0.0002182291873478251
Epoch: 5 cost time: 2.5117082595825195
Epoch: 5, Steps: 514 | Train Loss: 0.6020522 Vali Loss: 0.4044686 Best vali loss: 0.3986172
	iters: 100, epoch: 6 | loss: 0.7135444
	speed: 0.0094s/iter; left time: 13.6069s
	iters: 200, epoch: 6 | loss: 0.8595890
	speed: 0.0049s/iter; left time: 6.6233s
	iters: 300, epoch: 6 | loss: 0.6852136
	speed: 0.0050s/iter; left time: 6.2123s
	iters: 400, epoch: 6 | loss: 0.5018464
	speed: 0.0049s/iter; left time: 5.5932s
	iters: 500, epoch: 6 | loss: 0.6395034
	speed: 0.0048s/iter; left time: 5.0433s
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 2.544710159301758
Epoch: 6, Steps: 514 | Train Loss: 0.6799394 Vali Loss: 0.4032624 Best vali loss: 0.3986172
	iters: 100, epoch: 7 | loss: 1.0107211
	speed: 0.0094s/iter; left time: 8.7382s
	iters: 200, epoch: 7 | loss: 1.1877304
	speed: 0.0049s/iter; left time: 4.0541s
	iters: 300, epoch: 7 | loss: 0.8335145
	speed: 0.0049s/iter; left time: 3.5511s
	iters: 400, epoch: 7 | loss: 0.3726383
	speed: 0.0049s/iter; left time: 3.0884s
	iters: 500, epoch: 7 | loss: 1.0084100
	speed: 0.0046s/iter; left time: 2.4441s
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 2.490997791290283
Epoch: 7, Steps: 514 | Train Loss: 0.8826029 Vali Loss: 0.4044426 Best vali loss: 0.3986172
	iters: 100, epoch: 8 | loss: 0.7988789
	speed: 0.0096s/iter; left time: 3.9883s
	iters: 200, epoch: 8 | loss: 0.3745728
	speed: 0.0049s/iter; left time: 1.5427s
	iters: 300, epoch: 8 | loss: 0.5249350
	speed: 0.0049s/iter; left time: 1.0512s
	iters: 400, epoch: 8 | loss: 0.3524093
	speed: 0.0046s/iter; left time: 0.5317s
	iters: 500, epoch: 8 | loss: 1.0779334
	speed: 0.0045s/iter; left time: 0.0673s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.4865005016326904
Epoch: 8, Steps: 514 | Train Loss: 0.6257459 Vali Loss: 0.4043258 Best vali loss: 0.3986172

best validation loss 0.3986171777098493

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.001153687923, 'e_layers': 1, 'learning_rate': 0.0004182190095, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8438566
	speed: 0.0089s/iter; left time: 17.3695s
	iters: 200, epoch: 1 | loss: 0.8301429
	speed: 0.0028s/iter; left time: 5.1216s
Updating learning rate to 0.0004182190095
Validation loss decreased (inf --> 0.3640).  Saving model state dict ...
Epoch: 1 cost time: 1.0509777069091797
Epoch: 1, Steps: 257 | Train Loss: 0.8369997 Vali Loss: 0.3640129 Best vali loss: 0.3640129
	iters: 100, epoch: 2 | loss: 0.4540546
	speed: 0.0064s/iter; left time: 10.8597s
	iters: 200, epoch: 2 | loss: 0.8298452
	speed: 0.0027s/iter; left time: 4.2455s
Updating learning rate to 0.00020910950475
Epoch: 2 cost time: 0.7245166301727295
Epoch: 2, Steps: 257 | Train Loss: 0.6419499 Vali Loss: 0.3660957 Best vali loss: 0.3640129
	iters: 100, epoch: 3 | loss: 0.5101202
	speed: 0.0064s/iter; left time: 9.2002s
	iters: 200, epoch: 3 | loss: 0.8348919
	speed: 0.0027s/iter; left time: 3.6051s
Updating learning rate to 0.000104554752375
Epoch: 3 cost time: 0.72804856300354
Epoch: 3, Steps: 257 | Train Loss: 0.6725060 Vali Loss: 0.3744792 Best vali loss: 0.3640129

best validation loss 0.36401285512742454

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0033821765531, 'e_layers': 1, 'learning_rate': 7.56729211e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5755713
	speed: 0.0089s/iter; left time: 17.3237s
	iters: 200, epoch: 1 | loss: 0.5920926
	speed: 0.0029s/iter; left time: 5.3390s
Updating learning rate to 7.279279203481575e-05
Validation loss decreased (inf --> 0.4107).  Saving model state dict ...
Epoch: 1 cost time: 1.0603652000427246
Epoch: 1, Steps: 257 | Train Loss: 0.5838319 Vali Loss: 0.4106740 Best vali loss: 0.4106740
	iters: 100, epoch: 2 | loss: 0.8195735
	speed: 0.0064s/iter; left time: 10.8565s
	iters: 200, epoch: 2 | loss: 1.1577927
	speed: 0.0025s/iter; left time: 4.0144s
Updating learning rate to 6.459087838100228e-05
Validation loss decreased (0.4107 --> 0.3891).  Saving model state dict ...
Epoch: 2 cost time: 0.6943800449371338
Epoch: 2, Steps: 257 | Train Loss: 0.9886831 Vali Loss: 0.3890585 Best vali loss: 0.3890585
	iters: 100, epoch: 3 | loss: 0.6019473
	speed: 0.0061s/iter; left time: 8.8359s
	iters: 200, epoch: 3 | loss: 0.4517651
	speed: 0.0026s/iter; left time: 3.4921s
Updating learning rate to 5.231584714182032e-05
Validation loss decreased (0.3891 --> 0.3790).  Saving model state dict ...
Epoch: 3 cost time: 0.699526309967041
Epoch: 3, Steps: 257 | Train Loss: 0.5268562 Vali Loss: 0.3790471 Best vali loss: 0.3790471

best validation loss 0.3790470715941521

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 1, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0381548
	speed: 0.0095s/iter; left time: 8.8781s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.3641).  Saving model state dict ...
Epoch: 1 cost time: 0.7614917755126953
Epoch: 1, Steps: 129 | Train Loss: 1.0381548 Vali Loss: 0.3641201 Best vali loss: 0.3641201
	iters: 100, epoch: 2 | loss: 0.7578765
	speed: 0.0060s/iter; left time: 4.7906s
Updating learning rate to 0.0001652515671
Epoch: 2 cost time: 0.44127607345581055
Epoch: 2, Steps: 129 | Train Loss: 0.7578765 Vali Loss: 0.3701564 Best vali loss: 0.3641201
	iters: 100, epoch: 3 | loss: 0.4568558
	speed: 0.0058s/iter; left time: 3.9283s
Updating learning rate to 8.262578355e-05
Epoch: 3 cost time: 0.4380800724029541
Epoch: 3, Steps: 129 | Train Loss: 0.4568558 Vali Loss: 0.3700715 Best vali loss: 0.3641201

best validation loss 0.36412005946772036

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.001153687923, 'e_layers': 1, 'learning_rate': 0.0004182190095, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6437645
	speed: 0.0091s/iter; left time: 10.7362s
	iters: 200, epoch: 4 | loss: 0.8065295
	speed: 0.0027s/iter; left time: 2.9282s
Updating learning rate to 5.22773761875e-05
Epoch: 4 cost time: 1.042382001876831
Epoch: 4, Steps: 257 | Train Loss: 0.7251470 Vali Loss: 0.3703881 Best vali loss: 0.3640129
	iters: 100, epoch: 5 | loss: 0.4485255
	speed: 0.0064s/iter; left time: 5.9032s
	iters: 200, epoch: 5 | loss: 0.7264966
	speed: 0.0027s/iter; left time: 2.2319s
Updating learning rate to 2.613868809375e-05
Epoch: 5 cost time: 0.7291269302368164
Epoch: 5, Steps: 257 | Train Loss: 0.5875110 Vali Loss: 0.3726860 Best vali loss: 0.3640129
	iters: 100, epoch: 6 | loss: 0.4602264
	speed: 0.0064s/iter; left time: 4.2685s
	iters: 200, epoch: 6 | loss: 0.8026314
	speed: 0.0027s/iter; left time: 1.5488s
Updating learning rate to 1.3069344046875e-05
Epoch: 6 cost time: 0.7429244518280029
Epoch: 6, Steps: 257 | Train Loss: 0.6314289 Vali Loss: 0.3755415 Best vali loss: 0.3640129
	iters: 100, epoch: 7 | loss: 0.6004259
	speed: 0.0065s/iter; left time: 2.7154s
	iters: 200, epoch: 7 | loss: 0.4566816
	speed: 0.0027s/iter; left time: 0.8615s
Updating learning rate to 6.5346720234375e-06
Epoch: 7 cost time: 0.7448341846466064
Epoch: 7, Steps: 257 | Train Loss: 0.5285538 Vali Loss: 0.3751675 Best vali loss: 0.3640129
	iters: 100, epoch: 8 | loss: 0.7351164
	speed: 0.0065s/iter; left time: 1.0290s
	iters: 200, epoch: 8 | loss: 0.4852891
	speed: 0.0026s/iter; left time: 0.1514s
Updating learning rate to 3.26733601171875e-06
Epoch: 8 cost time: 0.7196311950683594
Epoch: 8, Steps: 257 | Train Loss: 0.6102027 Vali Loss: 0.3757794 Best vali loss: 0.3640129

best validation loss 0.36401285512742454

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001027334895, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4264461
	speed: 0.0096s/iter; left time: 38.4226s
	iters: 200, epoch: 1 | loss: 1.0776341
	speed: 0.0034s/iter; left time: 13.3322s
	iters: 300, epoch: 1 | loss: 1.0149096
	speed: 0.0034s/iter; left time: 12.9869s
	iters: 400, epoch: 1 | loss: 0.5045297
	speed: 0.0036s/iter; left time: 13.2158s
	iters: 500, epoch: 1 | loss: 1.1416507
	speed: 0.0035s/iter; left time: 12.6022s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3750).  Saving model state dict ...
Epoch: 1 cost time: 2.1264102458953857
Epoch: 1, Steps: 514 | Train Loss: 0.8330340 Vali Loss: 0.3750124 Best vali loss: 0.3750124
	iters: 100, epoch: 2 | loss: 0.3859331
	speed: 0.0073s/iter; left time: 25.5258s
	iters: 200, epoch: 2 | loss: 0.2586330
	speed: 0.0035s/iter; left time: 12.0214s
	iters: 300, epoch: 2 | loss: 0.4844785
	speed: 0.0034s/iter; left time: 11.2124s
	iters: 400, epoch: 2 | loss: 0.3876400
	speed: 0.0033s/iter; left time: 10.7093s
	iters: 500, epoch: 2 | loss: 0.5984340
	speed: 0.0034s/iter; left time: 10.4368s
Updating learning rate to 0.0001911554003
Validation loss decreased (0.3750 --> 0.3558).  Saving model state dict ...
Epoch: 2 cost time: 1.8045551776885986
Epoch: 2, Steps: 514 | Train Loss: 0.4230237 Vali Loss: 0.3557992 Best vali loss: 0.3557992
	iters: 100, epoch: 3 | loss: 0.3541264
	speed: 0.0075s/iter; left time: 22.2662s
	iters: 200, epoch: 3 | loss: 0.9117159
	speed: 0.0035s/iter; left time: 10.0391s
	iters: 300, epoch: 3 | loss: 0.5034975
	speed: 0.0034s/iter; left time: 9.5862s
	iters: 400, epoch: 3 | loss: 0.4587848
	speed: 0.0034s/iter; left time: 9.0528s
	iters: 500, epoch: 3 | loss: 1.0851493
	speed: 0.0034s/iter; left time: 8.7611s
Updating learning rate to 9.557770015e-05
Validation loss decreased (0.3558 --> 0.3464).  Saving model state dict ...
Epoch: 3 cost time: 1.808664083480835
Epoch: 3, Steps: 514 | Train Loss: 0.6626548 Vali Loss: 0.3464319 Best vali loss: 0.3464319
	iters: 100, epoch: 4 | loss: 0.5542830
	speed: 0.0077s/iter; left time: 19.0048s
	iters: 200, epoch: 4 | loss: 0.4459239
	speed: 0.0035s/iter; left time: 8.2246s
	iters: 300, epoch: 4 | loss: 0.4745024
	speed: 0.0035s/iter; left time: 7.8787s
	iters: 400, epoch: 4 | loss: 0.6778951
	speed: 0.0035s/iter; left time: 7.6970s
	iters: 500, epoch: 4 | loss: 0.7187769
	speed: 0.0035s/iter; left time: 7.1712s
Updating learning rate to 4.7788850075e-05
Validation loss decreased (0.3464 --> 0.3400).  Saving model state dict ...
Epoch: 4 cost time: 1.8420920372009277
Epoch: 4, Steps: 514 | Train Loss: 0.5742762 Vali Loss: 0.3399567 Best vali loss: 0.3399567
	iters: 100, epoch: 5 | loss: 0.5447202
	speed: 0.0074s/iter; left time: 14.5722s
	iters: 200, epoch: 5 | loss: 0.7334605
	speed: 0.0034s/iter; left time: 6.3346s
	iters: 300, epoch: 5 | loss: 0.4585827
	speed: 0.0034s/iter; left time: 6.0150s
	iters: 400, epoch: 5 | loss: 0.7917705
	speed: 0.0034s/iter; left time: 5.6625s
	iters: 500, epoch: 5 | loss: 0.5381936
	speed: 0.0034s/iter; left time: 5.3349s
Updating learning rate to 2.38944250375e-05
Epoch: 5 cost time: 1.7983949184417725
Epoch: 5, Steps: 514 | Train Loss: 0.6133455 Vali Loss: 0.3411852 Best vali loss: 0.3399567
	iters: 100, epoch: 6 | loss: 0.2991994
	speed: 0.0073s/iter; left time: 10.5763s
	iters: 200, epoch: 6 | loss: 0.4559815
	speed: 0.0032s/iter; left time: 4.2933s
	iters: 300, epoch: 6 | loss: 0.3387122
	speed: 0.0032s/iter; left time: 3.9359s
	iters: 400, epoch: 6 | loss: 0.7363396
	speed: 0.0032s/iter; left time: 3.7142s
	iters: 500, epoch: 6 | loss: 0.9557219
	speed: 0.0033s/iter; left time: 3.4197s
Updating learning rate to 1.194721251875e-05
Epoch: 6 cost time: 1.7130627632141113
Epoch: 6, Steps: 514 | Train Loss: 0.5571909 Vali Loss: 0.3412462 Best vali loss: 0.3399567
	iters: 100, epoch: 7 | loss: 0.3910978
	speed: 0.0072s/iter; left time: 6.6541s
	iters: 200, epoch: 7 | loss: 0.2964721
	speed: 0.0033s/iter; left time: 2.7258s
	iters: 300, epoch: 7 | loss: 0.3634070
	speed: 0.0033s/iter; left time: 2.4095s
	iters: 400, epoch: 7 | loss: 0.3994285
	speed: 0.0032s/iter; left time: 2.0099s
	iters: 500, epoch: 7 | loss: 0.8019347
	speed: 0.0032s/iter; left time: 1.6874s
Updating learning rate to 5.973606259375e-06
Validation loss decreased (0.3400 --> 0.3399).  Saving model state dict ...
Epoch: 7 cost time: 1.7133064270019531
Epoch: 7, Steps: 514 | Train Loss: 0.4504680 Vali Loss: 0.3398876 Best vali loss: 0.3398876
	iters: 100, epoch: 8 | loss: 0.3691745
	speed: 0.0077s/iter; left time: 3.1802s
	iters: 200, epoch: 8 | loss: 0.2279218
	speed: 0.0032s/iter; left time: 1.0201s
	iters: 300, epoch: 8 | loss: 0.3575148
	speed: 0.0033s/iter; left time: 0.7090s
	iters: 400, epoch: 8 | loss: 0.4279912
	speed: 0.0032s/iter; left time: 0.3719s
	iters: 500, epoch: 8 | loss: 0.2448879
	speed: 0.0032s/iter; left time: 0.0478s
Updating learning rate to 2.9868031296875e-06
Epoch: 8 cost time: 1.7119147777557373
Epoch: 8, Steps: 514 | Train Loss: 0.3254980 Vali Loss: 0.3412063 Best vali loss: 0.3398876

best validation loss 0.3398876023462339

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021830715098, 'e_layers': 2, 'learning_rate': 0.0003971734192, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8179461
	speed: 0.0100s/iter; left time: 19.4808s
	iters: 200, epoch: 1 | loss: 0.5300387
	speed: 0.0037s/iter; left time: 6.9141s
Updating learning rate to 0.0003971734192
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 1.3004848957061768
Epoch: 1, Steps: 257 | Train Loss: 0.6739924 Vali Loss: 0.3637022 Best vali loss: 0.3637022
	iters: 100, epoch: 2 | loss: 0.3376852
	speed: 0.0084s/iter; left time: 14.3346s
	iters: 200, epoch: 2 | loss: 0.4721605
	speed: 0.0037s/iter; left time: 5.8540s
Updating learning rate to 0.0001985867096
Validation loss decreased (0.3637 --> 0.3565).  Saving model state dict ...
Epoch: 2 cost time: 1.004671335220337
Epoch: 2, Steps: 257 | Train Loss: 0.4049228 Vali Loss: 0.3564752 Best vali loss: 0.3564752
	iters: 100, epoch: 3 | loss: 0.6768362
	speed: 0.0083s/iter; left time: 11.9377s
	iters: 200, epoch: 3 | loss: 0.4140427
	speed: 0.0038s/iter; left time: 5.0419s
Updating learning rate to 9.92933548e-05
Validation loss decreased (0.3565 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 1.0120518207550049
Epoch: 3, Steps: 257 | Train Loss: 0.5454394 Vali Loss: 0.3539426 Best vali loss: 0.3539426
	iters: 100, epoch: 4 | loss: 0.5429463
	speed: 0.0081s/iter; left time: 9.6474s
	iters: 200, epoch: 4 | loss: 0.5309602
	speed: 0.0035s/iter; left time: 3.7628s
Updating learning rate to 4.96466774e-05
Validation loss decreased (0.3539 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 0.9433917999267578
Epoch: 4, Steps: 257 | Train Loss: 0.5369533 Vali Loss: 0.3513495 Best vali loss: 0.3513495
	iters: 100, epoch: 5 | loss: 0.6594700
	speed: 0.0079s/iter; left time: 7.3455s
	iters: 200, epoch: 5 | loss: 0.7477707
	speed: 0.0034s/iter; left time: 2.8398s
Updating learning rate to 2.48233387e-05
Epoch: 5 cost time: 0.9314372539520264
Epoch: 5, Steps: 257 | Train Loss: 0.7036203 Vali Loss: 0.3546797 Best vali loss: 0.3513495
	iters: 100, epoch: 6 | loss: 0.4411278
	speed: 0.0080s/iter; left time: 5.4042s
	iters: 200, epoch: 6 | loss: 0.6645491
	speed: 0.0037s/iter; left time: 2.1227s
Updating learning rate to 1.241166935e-05
Validation loss decreased (0.3513 --> 0.3485).  Saving model state dict ...
Epoch: 6 cost time: 0.9877109527587891
Epoch: 6, Steps: 257 | Train Loss: 0.5528385 Vali Loss: 0.3484571 Best vali loss: 0.3484571
	iters: 100, epoch: 7 | loss: 0.4340850
	speed: 0.0082s/iter; left time: 3.3951s
	iters: 200, epoch: 7 | loss: 0.6584979
	speed: 0.0036s/iter; left time: 1.1468s
Updating learning rate to 6.205834675e-06
Epoch: 7 cost time: 0.9958834648132324
Epoch: 7, Steps: 257 | Train Loss: 0.5462915 Vali Loss: 0.3493249 Best vali loss: 0.3484571
	iters: 100, epoch: 8 | loss: 0.5386552
	speed: 0.0079s/iter; left time: 1.2555s
	iters: 200, epoch: 8 | loss: 0.5101452
	speed: 0.0037s/iter; left time: 0.2141s
Updating learning rate to 3.1029173375e-06
Epoch: 8 cost time: 0.9819395542144775
Epoch: 8, Steps: 257 | Train Loss: 0.5244002 Vali Loss: 0.3488133 Best vali loss: 0.3484571

best validation loss 0.34845709393207125

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0044245207952, 'e_layers': 4, 'learning_rate': 0.0003967755794, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4148633
	speed: 0.0107s/iter; left time: 42.9156s
	iters: 200, epoch: 1 | loss: 0.3373980
	speed: 0.0047s/iter; left time: 18.4293s
	iters: 300, epoch: 1 | loss: 0.3884013
	speed: 0.0047s/iter; left time: 17.8587s
	iters: 400, epoch: 1 | loss: 0.3407715
	speed: 0.0047s/iter; left time: 17.4325s
	iters: 500, epoch: 1 | loss: 0.8831201
	speed: 0.0047s/iter; left time: 16.9928s
Updating learning rate to 0.0003967755794
Validation loss decreased (inf --> 0.3770).  Saving model state dict ...
Epoch: 1 cost time: 2.7484447956085205
Epoch: 1, Steps: 514 | Train Loss: 0.4729108 Vali Loss: 0.3770193 Best vali loss: 0.3770193
	iters: 100, epoch: 2 | loss: 1.1564636
	speed: 0.0095s/iter; left time: 33.1244s
	iters: 200, epoch: 2 | loss: 0.9213985
	speed: 0.0046s/iter; left time: 15.7935s
	iters: 300, epoch: 2 | loss: 0.5856618
	speed: 0.0047s/iter; left time: 15.6233s
	iters: 400, epoch: 2 | loss: 0.3927998
	speed: 0.0048s/iter; left time: 15.3730s
	iters: 500, epoch: 2 | loss: 0.4449982
	speed: 0.0048s/iter; left time: 14.7418s
Updating learning rate to 0.0001983877897
Validation loss decreased (0.3770 --> 0.3758).  Saving model state dict ...
Epoch: 2 cost time: 2.4728055000305176
Epoch: 2, Steps: 514 | Train Loss: 0.7002644 Vali Loss: 0.3758408 Best vali loss: 0.3758408
	iters: 100, epoch: 3 | loss: 0.4007758
	speed: 0.0096s/iter; left time: 28.7590s
	iters: 200, epoch: 3 | loss: 0.4672593
	speed: 0.0046s/iter; left time: 13.2913s
	iters: 300, epoch: 3 | loss: 0.7517751
	speed: 0.0046s/iter; left time: 12.6971s
	iters: 400, epoch: 3 | loss: 0.3661880
	speed: 0.0047s/iter; left time: 12.5734s
	iters: 500, epoch: 3 | loss: 1.0031910
	speed: 0.0048s/iter; left time: 12.2851s
Updating learning rate to 9.919389485e-05
Epoch: 3 cost time: 2.4335100650787354
Epoch: 3, Steps: 514 | Train Loss: 0.5978378 Vali Loss: 0.3782393 Best vali loss: 0.3758408

best validation loss 0.37584077869276633

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0073254454918, 'e_layers': 3, 'learning_rate': 0.0017429435656, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0003996
	speed: 0.0102s/iter; left time: 82.5425s
	iters: 200, epoch: 1 | loss: 0.4468081
	speed: 0.0039s/iter; left time: 31.5942s
	iters: 300, epoch: 1 | loss: 1.8261997
	speed: 0.0040s/iter; left time: 31.5756s
	iters: 400, epoch: 1 | loss: 1.1478424
	speed: 0.0041s/iter; left time: 32.3231s
	iters: 500, epoch: 1 | loss: 1.0143923
	speed: 0.0042s/iter; left time: 32.1388s
	iters: 600, epoch: 1 | loss: 0.5311689
	speed: 0.0040s/iter; left time: 30.7241s
	iters: 700, epoch: 1 | loss: 0.2632395
	speed: 0.0040s/iter; left time: 30.0730s
	iters: 800, epoch: 1 | loss: 0.8549832
	speed: 0.0039s/iter; left time: 28.6834s
	iters: 900, epoch: 1 | loss: 0.4070290
	speed: 0.0038s/iter; left time: 27.5966s
	iters: 1000, epoch: 1 | loss: 0.7575284
	speed: 0.0038s/iter; left time: 27.2411s
Updating learning rate to 0.0016766067260900416
Validation loss decreased (inf --> 0.4019).  Saving model state dict ...
Epoch: 1 cost time: 4.426530599594116
Epoch: 1, Steps: 1027 | Train Loss: 0.8249591 Vali Loss: 0.4019088 Best vali loss: 0.4019088
	iters: 100, epoch: 2 | loss: 0.9913867
	speed: 0.0107s/iter; left time: 75.9634s
	iters: 200, epoch: 2 | loss: 1.0227742
	speed: 0.0038s/iter; left time: 26.6206s
	iters: 300, epoch: 2 | loss: 1.2028013
	speed: 0.0039s/iter; left time: 27.0184s
	iters: 400, epoch: 2 | loss: 0.8395694
	speed: 0.0038s/iter; left time: 26.0809s
	iters: 500, epoch: 2 | loss: 0.3810059
	speed: 0.0040s/iter; left time: 26.6849s
	iters: 600, epoch: 2 | loss: 0.2609707
	speed: 0.0039s/iter; left time: 25.9874s
	iters: 700, epoch: 2 | loss: 0.5950009
	speed: 0.0037s/iter; left time: 24.1055s
	iters: 800, epoch: 2 | loss: 0.6304904
	speed: 0.0039s/iter; left time: 24.8003s
	iters: 900, epoch: 2 | loss: 1.0230435
	speed: 0.0040s/iter; left time: 24.9077s
	iters: 1000, epoch: 2 | loss: 0.9893105
	speed: 0.0040s/iter; left time: 24.5935s
Updating learning rate to 0.00148769539003061
Epoch: 2 cost time: 4.025221824645996
Epoch: 2, Steps: 1027 | Train Loss: 0.7936354 Vali Loss: 0.4048683 Best vali loss: 0.4019088
	iters: 100, epoch: 3 | loss: 1.0686394
	speed: 0.0111s/iter; left time: 67.4938s
	iters: 200, epoch: 3 | loss: 0.2793234
	speed: 0.0043s/iter; left time: 25.5971s
	iters: 300, epoch: 3 | loss: 0.4239481
	speed: 0.0044s/iter; left time: 25.5239s
	iters: 400, epoch: 3 | loss: 0.9086540
	speed: 0.0044s/iter; left time: 25.2037s
	iters: 500, epoch: 3 | loss: 0.3244118
	speed: 0.0044s/iter; left time: 24.6977s
	iters: 600, epoch: 3 | loss: 0.4954551
	speed: 0.0043s/iter; left time: 24.0985s
	iters: 700, epoch: 3 | loss: 0.6026489
	speed: 0.0044s/iter; left time: 23.8531s
	iters: 800, epoch: 3 | loss: 0.7953889
	speed: 0.0044s/iter; left time: 23.3694s
	iters: 900, epoch: 3 | loss: 0.3950067
	speed: 0.0044s/iter; left time: 23.0329s
	iters: 1000, epoch: 3 | loss: 1.0985948
	speed: 0.0044s/iter; left time: 22.4619s
Updating learning rate to 0.0012049695958512281
Epoch: 3 cost time: 4.505724906921387
Epoch: 3, Steps: 1027 | Train Loss: 0.6392071 Vali Loss: 0.4036510 Best vali loss: 0.4019088

best validation loss 0.40190881351356655

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0053274349024, 'e_layers': 3, 'learning_rate': 0.000191354594, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6586035
	speed: 0.0111s/iter; left time: 10.3852s
Updating learning rate to 0.00018407159342430355
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.9612548351287842
Epoch: 1, Steps: 129 | Train Loss: 0.6586035 Vali Loss: 0.3709309 Best vali loss: 0.3709309
	iters: 100, epoch: 2 | loss: 0.7232280
	speed: 0.0080s/iter; left time: 6.4441s
Updating learning rate to 0.00016333136251429933
Validation loss decreased (0.3709 --> 0.3618).  Saving model state dict ...
Epoch: 2 cost time: 0.6476049423217773
Epoch: 2, Steps: 129 | Train Loss: 0.7232280 Vali Loss: 0.3617813 Best vali loss: 0.3617813
	iters: 100, epoch: 3 | loss: 0.7417242
	speed: 0.0080s/iter; left time: 5.4014s
Updating learning rate to 0.00013229141341537413
Validation loss decreased (0.3618 --> 0.3521).  Saving model state dict ...
Epoch: 3 cost time: 0.6109814643859863
Epoch: 3, Steps: 129 | Train Loss: 0.7417242 Vali Loss: 0.3520737 Best vali loss: 0.3520737

best validation loss 0.35207365898814325

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0053274349024, 'e_layers': 3, 'learning_rate': 0.000191354594, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5629557
	speed: 0.0117s/iter; left time: 6.3707s
Updating learning rate to 9.5677297e-05
Epoch: 4 cost time: 1.0146970748901367
Epoch: 4, Steps: 129 | Train Loss: 0.5629557 Vali Loss: 0.3598684 Best vali loss: 0.3520737
	iters: 100, epoch: 5 | loss: 0.5438523
	speed: 0.0085s/iter; left time: 3.5327s
Updating learning rate to 5.90631805846259e-05
Epoch: 5 cost time: 0.7044174671173096
Epoch: 5, Steps: 129 | Train Loss: 0.5438523 Vali Loss: 0.3624767 Best vali loss: 0.3520737
	iters: 100, epoch: 6 | loss: 0.6861139
	speed: 0.0085s/iter; left time: 2.4400s
Updating learning rate to 2.8023231485700687e-05
Epoch: 6 cost time: 0.6909956932067871
Epoch: 6, Steps: 129 | Train Loss: 0.6861139 Vali Loss: 0.3630014 Best vali loss: 0.3520737
	iters: 100, epoch: 7 | loss: 0.5355240
	speed: 0.0084s/iter; left time: 1.3351s
Updating learning rate to 7.283000575696463e-06
Epoch: 7 cost time: 0.6933426856994629
Epoch: 7, Steps: 129 | Train Loss: 0.5355240 Vali Loss: 0.3744225 Best vali loss: 0.3520737
	iters: 100, epoch: 8 | loss: 0.5397059
	speed: 0.0083s/iter; left time: 0.2502s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6641149520874023
Epoch: 8, Steps: 129 | Train Loss: 0.5397059 Vali Loss: 0.3753506 Best vali loss: 0.3520737

best validation loss 0.35207365898814325

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020318176613, 'e_layers': 2, 'learning_rate': 0.0003936959405, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9355305
	speed: 0.0098s/iter; left time: 39.2452s
	iters: 200, epoch: 1 | loss: 0.4387538
	speed: 0.0033s/iter; left time: 12.9912s
	iters: 300, epoch: 1 | loss: 1.2491758
	speed: 0.0034s/iter; left time: 13.0208s
	iters: 400, epoch: 1 | loss: 0.4037849
	speed: 0.0033s/iter; left time: 12.2076s
	iters: 500, epoch: 1 | loss: 1.1180823
	speed: 0.0031s/iter; left time: 11.2914s
Updating learning rate to 0.0003936959405
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 2.0588133335113525
Epoch: 1, Steps: 514 | Train Loss: 0.8290655 Vali Loss: 0.3733617 Best vali loss: 0.3733617
	iters: 100, epoch: 2 | loss: 0.6005046
	speed: 0.0073s/iter; left time: 25.5918s
	iters: 200, epoch: 2 | loss: 1.0391527
	speed: 0.0033s/iter; left time: 11.1930s
	iters: 300, epoch: 2 | loss: 0.3407511
	speed: 0.0032s/iter; left time: 10.6089s
	iters: 400, epoch: 2 | loss: 1.0004947
	speed: 0.0032s/iter; left time: 10.2729s
	iters: 500, epoch: 2 | loss: 0.7963733
	speed: 0.0033s/iter; left time: 10.0890s
Updating learning rate to 0.00019684797025
Epoch: 2 cost time: 1.7161543369293213
Epoch: 2, Steps: 514 | Train Loss: 0.7554553 Vali Loss: 0.3831092 Best vali loss: 0.3733617
	iters: 100, epoch: 3 | loss: 0.6070963
	speed: 0.0075s/iter; left time: 22.4542s
	iters: 200, epoch: 3 | loss: 0.3804109
	speed: 0.0035s/iter; left time: 10.0551s
	iters: 300, epoch: 3 | loss: 0.5242249
	speed: 0.0034s/iter; left time: 9.3830s
	iters: 400, epoch: 3 | loss: 0.2496793
	speed: 0.0034s/iter; left time: 9.0342s
	iters: 500, epoch: 3 | loss: 0.9718511
	speed: 0.0034s/iter; left time: 8.8586s
Updating learning rate to 9.8423985125e-05
Epoch: 3 cost time: 1.811363935470581
Epoch: 3, Steps: 514 | Train Loss: 0.5466525 Vali Loss: 0.3894395 Best vali loss: 0.3733617
	iters: 100, epoch: 4 | loss: 0.4117537
	speed: 0.0073s/iter; left time: 18.0833s
	iters: 200, epoch: 4 | loss: 0.5162613
	speed: 0.0034s/iter; left time: 8.0992s
	iters: 300, epoch: 4 | loss: 0.4859413
	speed: 0.0034s/iter; left time: 7.8123s
	iters: 400, epoch: 4 | loss: 0.3942263
	speed: 0.0036s/iter; left time: 7.7394s
	iters: 500, epoch: 4 | loss: 0.3774029
	speed: 0.0035s/iter; left time: 7.3031s
Updating learning rate to 4.92119925625e-05
Validation loss decreased (0.3734 --> 0.3656).  Saving model state dict ...
Epoch: 4 cost time: 1.8363759517669678
Epoch: 4, Steps: 514 | Train Loss: 0.4371171 Vali Loss: 0.3655735 Best vali loss: 0.3655735
	iters: 100, epoch: 5 | loss: 0.9697149
	speed: 0.0075s/iter; left time: 14.7739s
	iters: 200, epoch: 5 | loss: 0.3470061
	speed: 0.0032s/iter; left time: 5.9863s
	iters: 300, epoch: 5 | loss: 0.5275473
	speed: 0.0035s/iter; left time: 6.0941s
	iters: 400, epoch: 5 | loss: 0.6805216
	speed: 0.0033s/iter; left time: 5.4458s
	iters: 500, epoch: 5 | loss: 0.3475190
	speed: 0.0033s/iter; left time: 5.1009s
Updating learning rate to 2.460599628125e-05
Validation loss decreased (0.3656 --> 0.3638).  Saving model state dict ...
Epoch: 5 cost time: 1.7465178966522217
Epoch: 5, Steps: 514 | Train Loss: 0.5744618 Vali Loss: 0.3638094 Best vali loss: 0.3638094
	iters: 100, epoch: 6 | loss: 0.3112924
	speed: 0.0077s/iter; left time: 11.1423s
	iters: 200, epoch: 6 | loss: 0.7219328
	speed: 0.0035s/iter; left time: 4.7278s
	iters: 300, epoch: 6 | loss: 0.2980488
	speed: 0.0035s/iter; left time: 4.3228s
	iters: 400, epoch: 6 | loss: 0.5422100
	speed: 0.0033s/iter; left time: 3.8001s
	iters: 500, epoch: 6 | loss: 0.2832600
	speed: 0.0033s/iter; left time: 3.4133s
Updating learning rate to 1.2302998140625e-05
Epoch: 6 cost time: 1.784811019897461
Epoch: 6, Steps: 514 | Train Loss: 0.4313488 Vali Loss: 0.3876657 Best vali loss: 0.3638094
	iters: 100, epoch: 7 | loss: 0.6841611
	speed: 0.0073s/iter; left time: 6.8243s
	iters: 200, epoch: 7 | loss: 0.3696502
	speed: 0.0034s/iter; left time: 2.8356s
	iters: 300, epoch: 7 | loss: 0.2645741
	speed: 0.0035s/iter; left time: 2.5644s
	iters: 400, epoch: 7 | loss: 0.3272007
	speed: 0.0035s/iter; left time: 2.1856s
	iters: 500, epoch: 7 | loss: 0.4498522
	speed: 0.0035s/iter; left time: 1.8274s
Updating learning rate to 6.1514990703125e-06
Epoch: 7 cost time: 1.8192121982574463
Epoch: 7, Steps: 514 | Train Loss: 0.4190877 Vali Loss: 0.3795812 Best vali loss: 0.3638094
	iters: 100, epoch: 8 | loss: 0.5163407
	speed: 0.0072s/iter; left time: 2.9963s
	iters: 200, epoch: 8 | loss: 0.3319721
	speed: 0.0036s/iter; left time: 1.1379s
	iters: 300, epoch: 8 | loss: 0.3412033
	speed: 0.0036s/iter; left time: 0.7734s
	iters: 400, epoch: 8 | loss: 0.4513588
	speed: 0.0034s/iter; left time: 0.3958s
	iters: 500, epoch: 8 | loss: 0.2301866
	speed: 0.0034s/iter; left time: 0.0511s
Updating learning rate to 3.07574953515625e-06
Epoch: 8 cost time: 1.834320068359375
Epoch: 8, Steps: 514 | Train Loss: 0.3742123 Vali Loss: 0.3813892 Best vali loss: 0.3638094

best validation loss 0.3638093630726539

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0094475805296, 'e_layers': 3, 'learning_rate': 0.0028118539514, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4403745
	speed: 0.0102s/iter; left time: 82.5388s
	iters: 200, epoch: 1 | loss: 0.4987822
	speed: 0.0041s/iter; left time: 32.5543s
	iters: 300, epoch: 1 | loss: 1.0826187
	speed: 0.0040s/iter; left time: 31.9268s
	iters: 400, epoch: 1 | loss: 0.4644824
	speed: 0.0042s/iter; left time: 32.6061s
	iters: 500, epoch: 1 | loss: 0.9888209
	speed: 0.0042s/iter; left time: 32.1723s
	iters: 600, epoch: 1 | loss: 0.9175894
	speed: 0.0042s/iter; left time: 31.6567s
	iters: 700, epoch: 1 | loss: 0.4663396
	speed: 0.0038s/iter; left time: 28.1902s
	iters: 800, epoch: 1 | loss: 0.3224799
	speed: 0.0039s/iter; left time: 28.6945s
	iters: 900, epoch: 1 | loss: 0.4772611
	speed: 0.0038s/iter; left time: 28.1434s
	iters: 1000, epoch: 1 | loss: 0.5725592
	speed: 0.0039s/iter; left time: 28.3759s
Updating learning rate to 0.0028118539514
Validation loss decreased (inf --> 0.4049).  Saving model state dict ...
Epoch: 1 cost time: 4.443631172180176
Epoch: 1, Steps: 1027 | Train Loss: 0.6231308 Vali Loss: 0.4049197 Best vali loss: 0.4049197
	iters: 100, epoch: 2 | loss: 0.3703642
	speed: 0.0110s/iter; left time: 77.9065s
	iters: 200, epoch: 2 | loss: 0.9687747
	speed: 0.0039s/iter; left time: 27.4327s
	iters: 300, epoch: 2 | loss: 1.2920247
	speed: 0.0039s/iter; left time: 26.8240s
	iters: 400, epoch: 2 | loss: 0.2249990
	speed: 0.0039s/iter; left time: 26.4026s
	iters: 500, epoch: 2 | loss: 0.4033039
	speed: 0.0039s/iter; left time: 26.2944s
	iters: 600, epoch: 2 | loss: 0.1921495
	speed: 0.0040s/iter; left time: 26.1601s
	iters: 700, epoch: 2 | loss: 0.2824147
	speed: 0.0039s/iter; left time: 25.2139s
	iters: 800, epoch: 2 | loss: 1.0420309
	speed: 0.0039s/iter; left time: 24.7445s
	iters: 900, epoch: 2 | loss: 1.1925926
	speed: 0.0039s/iter; left time: 24.4032s
	iters: 1000, epoch: 2 | loss: 0.4835722
	speed: 0.0039s/iter; left time: 24.0188s
Updating learning rate to 0.0014059269757
Epoch: 2 cost time: 4.048797845840454
Epoch: 2, Steps: 1027 | Train Loss: 0.6452227 Vali Loss: 0.4053276 Best vali loss: 0.4049197
	iters: 100, epoch: 3 | loss: 0.7435987
	speed: 0.0106s/iter; left time: 64.3263s
	iters: 200, epoch: 3 | loss: 1.2349205
	speed: 0.0036s/iter; left time: 21.4330s
	iters: 300, epoch: 3 | loss: 0.2504801
	speed: 0.0036s/iter; left time: 20.9736s
	iters: 400, epoch: 3 | loss: 0.9168561
	speed: 0.0036s/iter; left time: 20.7051s
	iters: 500, epoch: 3 | loss: 0.4918522
	speed: 0.0038s/iter; left time: 21.3219s
	iters: 600, epoch: 3 | loss: 0.7989431
	speed: 0.0039s/iter; left time: 21.5852s
	iters: 700, epoch: 3 | loss: 2.0341151
	speed: 0.0039s/iter; left time: 21.3747s
	iters: 800, epoch: 3 | loss: 0.4519371
	speed: 0.0039s/iter; left time: 21.0144s
	iters: 900, epoch: 3 | loss: 0.5631550
	speed: 0.0036s/iter; left time: 19.0018s
	iters: 1000, epoch: 3 | loss: 0.7134149
	speed: 0.0036s/iter; left time: 18.4331s
Updating learning rate to 0.00070296348785
Validation loss decreased (0.4049 --> 0.4034).  Saving model state dict ...
Epoch: 3 cost time: 3.844923973083496
Epoch: 3, Steps: 1027 | Train Loss: 0.8199273 Vali Loss: 0.4034081 Best vali loss: 0.4034081
	iters: 100, epoch: 4 | loss: 0.8469012
	speed: 0.0108s/iter; left time: 54.1888s
	iters: 200, epoch: 4 | loss: 1.1934266
	speed: 0.0040s/iter; left time: 19.7759s
	iters: 300, epoch: 4 | loss: 1.0160921
	speed: 0.0041s/iter; left time: 20.0681s
	iters: 400, epoch: 4 | loss: 0.4536302
	speed: 0.0041s/iter; left time: 19.5781s
	iters: 500, epoch: 4 | loss: 0.5126584
	speed: 0.0041s/iter; left time: 19.0200s
	iters: 600, epoch: 4 | loss: 0.3274050
	speed: 0.0041s/iter; left time: 18.6064s
	iters: 700, epoch: 4 | loss: 0.4372645
	speed: 0.0041s/iter; left time: 18.3222s
	iters: 800, epoch: 4 | loss: 0.2896928
	speed: 0.0041s/iter; left time: 17.9444s
	iters: 900, epoch: 4 | loss: 1.1047291
	speed: 0.0042s/iter; left time: 17.6005s
	iters: 1000, epoch: 4 | loss: 1.1713669
	speed: 0.0042s/iter; left time: 17.2008s
Updating learning rate to 0.000351481743925
Epoch: 4 cost time: 4.257611989974976
Epoch: 4, Steps: 1027 | Train Loss: 0.7353167 Vali Loss: 0.4039118 Best vali loss: 0.4034081
	iters: 100, epoch: 5 | loss: 0.3430580
	speed: 0.0111s/iter; left time: 44.5358s
	iters: 200, epoch: 5 | loss: 1.3955704
	speed: 0.0041s/iter; left time: 16.0322s
	iters: 300, epoch: 5 | loss: 0.8827631
	speed: 0.0041s/iter; left time: 15.7163s
	iters: 400, epoch: 5 | loss: 0.3547722
	speed: 0.0041s/iter; left time: 15.1749s
	iters: 500, epoch: 5 | loss: 0.7774995
	speed: 0.0041s/iter; left time: 14.7597s
	iters: 600, epoch: 5 | loss: 0.9312397
	speed: 0.0041s/iter; left time: 14.3217s
	iters: 700, epoch: 5 | loss: 0.9405670
	speed: 0.0040s/iter; left time: 13.7015s
	iters: 800, epoch: 5 | loss: 0.4379924
	speed: 0.0041s/iter; left time: 13.4078s
	iters: 900, epoch: 5 | loss: 0.8265767
	speed: 0.0041s/iter; left time: 13.0281s
	iters: 1000, epoch: 5 | loss: 1.4128349
	speed: 0.0041s/iter; left time: 12.7787s
Updating learning rate to 0.0001757408719625
Epoch: 5 cost time: 4.241020202636719
Epoch: 5, Steps: 1027 | Train Loss: 0.8302874 Vali Loss: 0.4038019 Best vali loss: 0.4034081
	iters: 100, epoch: 6 | loss: 0.3600724
	speed: 0.0107s/iter; left time: 32.0372s
	iters: 200, epoch: 6 | loss: 1.3788462
	speed: 0.0036s/iter; left time: 10.3816s
	iters: 300, epoch: 6 | loss: 0.6901069
	speed: 0.0036s/iter; left time: 10.0023s
	iters: 400, epoch: 6 | loss: 1.0332955
	speed: 0.0036s/iter; left time: 9.6723s
	iters: 500, epoch: 6 | loss: 0.5892897
	speed: 0.0036s/iter; left time: 9.2244s
	iters: 600, epoch: 6 | loss: 1.0518718
	speed: 0.0036s/iter; left time: 8.9451s
	iters: 700, epoch: 6 | loss: 0.3022165
	speed: 0.0036s/iter; left time: 8.6252s
	iters: 800, epoch: 6 | loss: 0.9915022
	speed: 0.0039s/iter; left time: 8.7956s
	iters: 900, epoch: 6 | loss: 0.9815707
	speed: 0.0039s/iter; left time: 8.4979s
	iters: 1000, epoch: 6 | loss: 0.6429038
	speed: 0.0040s/iter; left time: 8.2255s
Updating learning rate to 8.787043598125e-05
Epoch: 6 cost time: 3.8378794193267822
Epoch: 6, Steps: 1027 | Train Loss: 0.8021676 Vali Loss: 0.4037374 Best vali loss: 0.4034081
	iters: 100, epoch: 7 | loss: 0.4519168
	speed: 0.0108s/iter; left time: 21.1471s
	iters: 200, epoch: 7 | loss: 0.3402565
	speed: 0.0042s/iter; left time: 7.7019s
	iters: 300, epoch: 7 | loss: 0.6770968
	speed: 0.0042s/iter; left time: 7.3078s
	iters: 400, epoch: 7 | loss: 1.1651833
	speed: 0.0042s/iter; left time: 6.8833s
	iters: 500, epoch: 7 | loss: 0.5663040
	speed: 0.0041s/iter; left time: 6.4476s
	iters: 600, epoch: 7 | loss: 0.8224282
	speed: 0.0041s/iter; left time: 6.0195s
	iters: 700, epoch: 7 | loss: 0.2164587
	speed: 0.0042s/iter; left time: 5.6580s
	iters: 800, epoch: 7 | loss: 0.3399321
	speed: 0.0042s/iter; left time: 5.2428s
	iters: 900, epoch: 7 | loss: 1.0264943
	speed: 0.0040s/iter; left time: 4.6707s
	iters: 1000, epoch: 7 | loss: 0.2932476
	speed: 0.0040s/iter; left time: 4.1677s
Updating learning rate to 4.3935217990625e-05
Epoch: 7 cost time: 4.264714479446411
Epoch: 7, Steps: 1027 | Train Loss: 0.5899318 Vali Loss: 0.4035904 Best vali loss: 0.4034081
	iters: 100, epoch: 8 | loss: 0.8957074
	speed: 0.0108s/iter; left time: 10.0277s
	iters: 200, epoch: 8 | loss: 1.0764107
	speed: 0.0039s/iter; left time: 3.2097s
	iters: 300, epoch: 8 | loss: 1.7005175
	speed: 0.0039s/iter; left time: 2.8673s
	iters: 400, epoch: 8 | loss: 0.4188309
	speed: 0.0039s/iter; left time: 2.4594s
	iters: 500, epoch: 8 | loss: 0.2972657
	speed: 0.0039s/iter; left time: 2.0660s
	iters: 600, epoch: 8 | loss: 0.5577096
	speed: 0.0039s/iter; left time: 1.6616s
	iters: 700, epoch: 8 | loss: 0.2492809
	speed: 0.0039s/iter; left time: 1.2764s
	iters: 800, epoch: 8 | loss: 0.6808693
	speed: 0.0039s/iter; left time: 0.8943s
	iters: 900, epoch: 8 | loss: 0.4684680
	speed: 0.0039s/iter; left time: 0.5035s
	iters: 1000, epoch: 8 | loss: 0.4125692
	speed: 0.0039s/iter; left time: 0.1102s
Updating learning rate to 2.19676089953125e-05
Epoch: 8 cost time: 4.056980609893799
Epoch: 8, Steps: 1027 | Train Loss: 0.6757629 Vali Loss: 0.4035953 Best vali loss: 0.4034081

best validation loss 0.40340807380517013

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070182929, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070182929
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.1064174175262451
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3712910 Best vali loss: 0.3712910
Updating learning rate to 0.00035350914645
Epoch: 2 cost time: 0.7716391086578369
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3780851 Best vali loss: 0.3712910
Updating learning rate to 0.000176754573225
Validation loss decreased (0.3713 --> 0.3615).  Saving model state dict ...
Epoch: 3 cost time: 0.7737648487091064
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3615406 Best vali loss: 0.3615406

best validation loss 0.36154056724256056

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0074141898833, 'e_layers': 4, 'learning_rate': 5.01367762e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7461643
	speed: 0.0115s/iter; left time: 46.0710s
	iters: 200, epoch: 1 | loss: 0.3409820
	speed: 0.0051s/iter; left time: 19.9849s
	iters: 300, epoch: 1 | loss: 0.8515911
	speed: 0.0050s/iter; left time: 19.2466s
	iters: 400, epoch: 1 | loss: 0.8797206
	speed: 0.0049s/iter; left time: 18.2797s
	iters: 500, epoch: 1 | loss: 1.3230364
	speed: 0.0050s/iter; left time: 18.2086s
Updating learning rate to 4.822855877863951e-05
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 2.964120864868164
Epoch: 1, Steps: 514 | Train Loss: 0.8282989 Vali Loss: 0.3735276 Best vali loss: 0.3735276
	iters: 100, epoch: 2 | loss: 0.3650133
	speed: 0.0102s/iter; left time: 35.8174s
	iters: 200, epoch: 2 | loss: 0.6418865
	speed: 0.0052s/iter; left time: 17.6680s
	iters: 300, epoch: 2 | loss: 0.7652669
	speed: 0.0051s/iter; left time: 16.9893s
	iters: 400, epoch: 2 | loss: 0.8224474
	speed: 0.0052s/iter; left time: 16.6656s
	iters: 500, epoch: 2 | loss: 0.9371746
	speed: 0.0052s/iter; left time: 16.1805s
Updating learning rate to 4.279441531892615e-05
Validation loss decreased (0.3735 --> 0.3653).  Saving model state dict ...
Epoch: 2 cost time: 2.717876434326172
Epoch: 2, Steps: 514 | Train Loss: 0.7063577 Vali Loss: 0.3652570 Best vali loss: 0.3652570
	iters: 100, epoch: 3 | loss: 0.4802211
	speed: 0.0101s/iter; left time: 30.2645s
	iters: 200, epoch: 3 | loss: 0.9259062
	speed: 0.0045s/iter; left time: 13.0091s
	iters: 300, epoch: 3 | loss: 0.4879865
	speed: 0.0047s/iter; left time: 13.0156s
	iters: 400, epoch: 3 | loss: 0.6262231
	speed: 0.0046s/iter; left time: 12.2491s
	iters: 500, epoch: 3 | loss: 0.7171881
	speed: 0.0046s/iter; left time: 11.9727s
Updating learning rate to 3.466164490196817e-05
Validation loss decreased (0.3653 --> 0.3635).  Saving model state dict ...
Epoch: 3 cost time: 2.444550037384033
Epoch: 3, Steps: 514 | Train Loss: 0.6475050 Vali Loss: 0.3635033 Best vali loss: 0.3635033

best validation loss 0.363503274953904

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0006625912991, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006373729193792771
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.093712329864502
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3689797 Best vali loss: 0.3689797
Updating learning rate to 0.000565557049924407
Validation loss decreased (0.3690 --> 0.3565).  Saving model state dict ...
Epoch: 2 cost time: 0.779951810836792
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3564996 Best vali loss: 0.3564996
Updating learning rate to 0.0004580770058474159
Epoch: 3 cost time: 0.7766048908233643
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3769737 Best vali loss: 0.3564996

best validation loss 0.3564996093804335

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0006625912991, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00033129564955
Epoch: 4 cost time: 1.0898568630218506
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3574297 Best vali loss: 0.3564996
Updating learning rate to 0.0002045142932525841
Validation loss decreased (0.3565 --> 0.3510).  Saving model state dict ...
Epoch: 5 cost time: 0.7732341289520264
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3509960 Best vali loss: 0.3509960
Updating learning rate to 9.703424917559303e-05
Epoch: 6 cost time: 0.7808516025543213
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3580045 Best vali loss: 0.3509960
Updating learning rate to 2.5218379720722918e-05
Epoch: 7 cost time: 0.7727210521697998
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3692382 Best vali loss: 0.3509960
Updating learning rate to 0.0
Epoch: 8 cost time: 0.783503532409668
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3769847 Best vali loss: 0.3509960

best validation loss 0.3509960287095053

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0029019204458, 'e_layers': 4, 'learning_rate': 0.0007331934557, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6870332
	speed: 0.0158s/iter; left time: 14.7481s
Updating learning rate to 0.0007052879413962254
Validation loss decreased (inf --> 0.3969).  Saving model state dict ...
Epoch: 1 cost time: 1.6008965969085693
Epoch: 1, Steps: 129 | Train Loss: 0.6870332 Vali Loss: 0.3969012 Best vali loss: 0.3969012
	iters: 100, epoch: 2 | loss: 0.4558640
	speed: 0.0156s/iter; left time: 12.5603s
Updating learning rate to 0.0006258197600735343
Validation loss decreased (0.3969 --> 0.3940).  Saving model state dict ...
Epoch: 2 cost time: 1.2909948825836182
Epoch: 2, Steps: 129 | Train Loss: 0.4558640 Vali Loss: 0.3940368 Best vali loss: 0.3940368
	iters: 100, epoch: 3 | loss: 0.8231837
	speed: 0.0159s/iter; left time: 10.7628s
Updating learning rate to 0.0005068872219574488
Validation loss decreased (0.3940 --> 0.3854).  Saving model state dict ...
Epoch: 3 cost time: 1.2908341884613037
Epoch: 3, Steps: 129 | Train Loss: 0.8231837 Vali Loss: 0.3854277 Best vali loss: 0.3854277
	iters: 100, epoch: 4 | loss: 0.6125892
	speed: 0.0158s/iter; left time: 8.6454s
Updating learning rate to 0.00036659672785
Epoch: 4 cost time: 1.2914924621582031
Epoch: 4, Steps: 129 | Train Loss: 0.6125892 Vali Loss: 0.3892639 Best vali loss: 0.3854277
	iters: 100, epoch: 5 | loss: 0.6448505
	speed: 0.0153s/iter; left time: 6.3959s
Updating learning rate to 0.0002263062337425513
Validation loss decreased (0.3854 --> 0.3783).  Saving model state dict ...
Epoch: 5 cost time: 1.295644998550415
Epoch: 5, Steps: 129 | Train Loss: 0.6448505 Vali Loss: 0.3783386 Best vali loss: 0.3783386
	iters: 100, epoch: 6 | loss: 0.4581434
	speed: 0.0157s/iter; left time: 4.5191s
Updating learning rate to 0.00010737369562646576
Validation loss decreased (0.3783 --> 0.3765).  Saving model state dict ...
Epoch: 6 cost time: 1.2808802127838135
Epoch: 6, Steps: 129 | Train Loss: 0.4581434 Vali Loss: 0.3764631 Best vali loss: 0.3764631
	iters: 100, epoch: 7 | loss: 0.5662594
	speed: 0.0158s/iter; left time: 2.5172s
Updating learning rate to 2.7905514303774588e-05
Epoch: 7 cost time: 1.299593448638916
Epoch: 7, Steps: 129 | Train Loss: 0.5662594 Vali Loss: 0.3803552 Best vali loss: 0.3764631
	iters: 100, epoch: 8 | loss: 0.5098432
	speed: 0.0154s/iter; left time: 0.4605s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.301868200302124
Epoch: 8, Steps: 129 | Train Loss: 0.5098432 Vali Loss: 0.3805361 Best vali loss: 0.3764631

best validation loss 0.3764630977671835

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.001685329961, 'e_layers': 1, 'learning_rate': 0.0009904955793, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8748117
	speed: 0.0093s/iter; left time: 8.7179s
Updating learning rate to 0.00095279708602909
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 0.7530221939086914
Epoch: 1, Steps: 129 | Train Loss: 0.8748117 Vali Loss: 0.3690489 Best vali loss: 0.3690489
	iters: 100, epoch: 2 | loss: 0.4207646
	speed: 0.0057s/iter; left time: 4.6165s
Updating learning rate to 0.0008454408600791639
Validation loss decreased (0.3690 --> 0.3685).  Saving model state dict ...
Epoch: 2 cost time: 0.4452085494995117
Epoch: 2, Steps: 129 | Train Loss: 0.4207646 Vali Loss: 0.3685480 Best vali loss: 0.3685480
	iters: 100, epoch: 3 | loss: 0.4016004
	speed: 0.0060s/iter; left time: 4.0266s
Updating learning rate to 0.000684770913664486
Validation loss decreased (0.3685 --> 0.3663).  Saving model state dict ...
Epoch: 3 cost time: 0.46012139320373535
Epoch: 3, Steps: 129 | Train Loss: 0.4016004 Vali Loss: 0.3662802 Best vali loss: 0.3662802
	iters: 100, epoch: 4 | loss: 0.4235477
	speed: 0.0055s/iter; left time: 3.0116s
Updating learning rate to 0.00049524778965
Epoch: 4 cost time: 0.4065361022949219
Epoch: 4, Steps: 129 | Train Loss: 0.4235477 Vali Loss: 0.3695220 Best vali loss: 0.3662802
	iters: 100, epoch: 5 | loss: 0.6389126
	speed: 0.0053s/iter; left time: 2.1915s
Updating learning rate to 0.00030572466563551405
Epoch: 5 cost time: 0.39415860176086426
Epoch: 5, Steps: 129 | Train Loss: 0.6389126 Vali Loss: 0.3671847 Best vali loss: 0.3662802
	iters: 100, epoch: 6 | loss: 0.4839070
	speed: 0.0053s/iter; left time: 1.5360s
Updating learning rate to 0.00014505471922083616
Epoch: 6 cost time: 0.4124586582183838
Epoch: 6, Steps: 129 | Train Loss: 0.4839070 Vali Loss: 0.3682577 Best vali loss: 0.3662802
	iters: 100, epoch: 7 | loss: 0.7437416
	speed: 0.0054s/iter; left time: 0.8509s
Updating learning rate to 3.769849327090993e-05
Epoch: 7 cost time: 0.3921983242034912
Epoch: 7, Steps: 129 | Train Loss: 0.7437416 Vali Loss: 0.3688190 Best vali loss: 0.3662802
	iters: 100, epoch: 8 | loss: 0.6160221
	speed: 0.0054s/iter; left time: 0.1631s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4095573425292969
Epoch: 8, Steps: 129 | Train Loss: 0.6160221 Vali Loss: 0.3704837 Best vali loss: 0.3662802

best validation loss 0.36628023637769735

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022205518906, 'e_layers': 2, 'learning_rate': 0.0004153530071, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4273523
	speed: 0.0099s/iter; left time: 39.9136s
	iters: 200, epoch: 1 | loss: 1.0790800
	speed: 0.0034s/iter; left time: 13.2852s
	iters: 300, epoch: 1 | loss: 1.0133110
	speed: 0.0033s/iter; left time: 12.4401s
	iters: 400, epoch: 1 | loss: 0.5035265
	speed: 0.0033s/iter; left time: 12.1192s
	iters: 500, epoch: 1 | loss: 1.1640459
	speed: 0.0033s/iter; left time: 11.8306s
Updating learning rate to 0.0004153530071
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 2.093297004699707
Epoch: 1, Steps: 514 | Train Loss: 0.8374632 Vali Loss: 0.3710339 Best vali loss: 0.3710339
	iters: 100, epoch: 2 | loss: 0.3974690
	speed: 0.0075s/iter; left time: 26.3138s
	iters: 200, epoch: 2 | loss: 0.2728449
	speed: 0.0034s/iter; left time: 11.4882s
	iters: 300, epoch: 2 | loss: 0.5214309
	speed: 0.0034s/iter; left time: 11.3293s
	iters: 400, epoch: 2 | loss: 0.4032631
	speed: 0.0033s/iter; left time: 10.6439s
	iters: 500, epoch: 2 | loss: 0.6215081
	speed: 0.0034s/iter; left time: 10.5634s
Updating learning rate to 0.00020767650355
Validation loss decreased (0.3710 --> 0.3664).  Saving model state dict ...
Epoch: 2 cost time: 1.7900512218475342
Epoch: 2, Steps: 514 | Train Loss: 0.4433032 Vali Loss: 0.3664239 Best vali loss: 0.3664239
	iters: 100, epoch: 3 | loss: 0.3706547
	speed: 0.0074s/iter; left time: 22.1324s
	iters: 200, epoch: 3 | loss: 0.8443781
	speed: 0.0034s/iter; left time: 9.9476s
	iters: 300, epoch: 3 | loss: 0.5028449
	speed: 0.0034s/iter; left time: 9.4382s
	iters: 400, epoch: 3 | loss: 0.4926816
	speed: 0.0033s/iter; left time: 8.8842s
	iters: 500, epoch: 3 | loss: 1.2137253
	speed: 0.0031s/iter; left time: 8.1250s
Updating learning rate to 0.000103838251775
Validation loss decreased (0.3664 --> 0.3497).  Saving model state dict ...
Epoch: 3 cost time: 1.7609055042266846
Epoch: 3, Steps: 514 | Train Loss: 0.6848569 Vali Loss: 0.3496531 Best vali loss: 0.3496531

best validation loss 0.34965314771431133

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022155682395, 'e_layers': 2, 'learning_rate': 0.0004428208013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4284364
	speed: 0.0098s/iter; left time: 39.4967s
	iters: 200, epoch: 1 | loss: 1.0800660
	speed: 0.0032s/iter; left time: 12.6847s
	iters: 300, epoch: 1 | loss: 1.0106939
	speed: 0.0030s/iter; left time: 11.5144s
	iters: 400, epoch: 1 | loss: 0.5029756
	speed: 0.0033s/iter; left time: 12.1641s
	iters: 500, epoch: 1 | loss: 1.1874306
	speed: 0.0034s/iter; left time: 12.3042s
Updating learning rate to 0.0004428208013
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 2.056868076324463
Epoch: 1, Steps: 514 | Train Loss: 0.8419205 Vali Loss: 0.3725173 Best vali loss: 0.3725173
	iters: 100, epoch: 2 | loss: 0.3931777
	speed: 0.0071s/iter; left time: 24.9938s
	iters: 200, epoch: 2 | loss: 0.2771334
	speed: 0.0031s/iter; left time: 10.5593s
	iters: 300, epoch: 2 | loss: 0.5183347
	speed: 0.0031s/iter; left time: 10.1740s
	iters: 400, epoch: 2 | loss: 0.3861030
	speed: 0.0031s/iter; left time: 9.8810s
	iters: 500, epoch: 2 | loss: 0.6163243
	speed: 0.0030s/iter; left time: 9.3669s
Updating learning rate to 0.00022141040065
Epoch: 2 cost time: 1.6331312656402588
Epoch: 2, Steps: 514 | Train Loss: 0.4382146 Vali Loss: 0.3730673 Best vali loss: 0.3725173
	iters: 100, epoch: 3 | loss: 0.3983291
	speed: 0.0068s/iter; left time: 20.3812s
	iters: 200, epoch: 3 | loss: 0.8563060
	speed: 0.0031s/iter; left time: 8.9975s
	iters: 300, epoch: 3 | loss: 0.5078324
	speed: 0.0032s/iter; left time: 8.8433s
	iters: 400, epoch: 3 | loss: 0.4534912
	speed: 0.0030s/iter; left time: 8.1538s
	iters: 500, epoch: 3 | loss: 1.1089702
	speed: 0.0033s/iter; left time: 8.5206s
Updating learning rate to 0.000110705200325
Validation loss decreased (0.3725 --> 0.3559).  Saving model state dict ...
Epoch: 3 cost time: 1.6535193920135498
Epoch: 3, Steps: 514 | Train Loss: 0.6649858 Vali Loss: 0.3559012 Best vali loss: 0.3559012

best validation loss 0.35590124191141786

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025726326462, 'e_layers': 4, 'learning_rate': 0.000417964688, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4971115
	speed: 0.0135s/iter; left time: 26.3440s
	iters: 200, epoch: 1 | loss: 0.5895833
	speed: 0.0072s/iter; left time: 13.2946s
Updating learning rate to 0.000417964688
Validation loss decreased (inf --> 0.3826).  Saving model state dict ...
Epoch: 1 cost time: 2.1949362754821777
Epoch: 1, Steps: 257 | Train Loss: 0.5433474 Vali Loss: 0.3825932 Best vali loss: 0.3825932
	iters: 100, epoch: 2 | loss: 0.5805701
	speed: 0.0149s/iter; left time: 25.3285s
	iters: 200, epoch: 2 | loss: 0.6875077
	speed: 0.0071s/iter; left time: 11.4272s
Updating learning rate to 0.000208982344
Epoch: 2 cost time: 1.868971347808838
Epoch: 2, Steps: 257 | Train Loss: 0.6340389 Vali Loss: 0.3930193 Best vali loss: 0.3825932
	iters: 100, epoch: 3 | loss: 0.6597242
	speed: 0.0146s/iter; left time: 21.1101s
	iters: 200, epoch: 3 | loss: 0.8808742
	speed: 0.0071s/iter; left time: 9.5208s
Updating learning rate to 0.000104491172
Epoch: 3 cost time: 1.864745855331421
Epoch: 3, Steps: 257 | Train Loss: 0.7702992 Vali Loss: 0.3894036 Best vali loss: 0.3825932

best validation loss 0.38259315409922645

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022205518906, 'e_layers': 2, 'learning_rate': 0.0004153530071, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3520977
	speed: 0.0095s/iter; left time: 23.4397s
	iters: 200, epoch: 4 | loss: 0.9134956
	speed: 0.0030s/iter; left time: 7.1149s
	iters: 300, epoch: 4 | loss: 0.7888999
	speed: 0.0030s/iter; left time: 6.7312s
	iters: 400, epoch: 4 | loss: 0.4631847
	speed: 0.0031s/iter; left time: 6.7883s
	iters: 500, epoch: 4 | loss: 0.4504158
	speed: 0.0030s/iter; left time: 6.1453s
Updating learning rate to 5.19191258875e-05
Validation loss decreased (0.3497 --> 0.3433).  Saving model state dict ...
Epoch: 4 cost time: 1.9121477603912354
Epoch: 4, Steps: 514 | Train Loss: 0.5936187 Vali Loss: 0.3432825 Best vali loss: 0.3432825
	iters: 100, epoch: 5 | loss: 0.3860488
	speed: 0.0070s/iter; left time: 13.6512s
	iters: 200, epoch: 5 | loss: 0.2219324
	speed: 0.0031s/iter; left time: 5.7793s
	iters: 300, epoch: 5 | loss: 0.3599032
	speed: 0.0031s/iter; left time: 5.4436s
	iters: 400, epoch: 5 | loss: 0.3706296
	speed: 0.0032s/iter; left time: 5.3602s
	iters: 500, epoch: 5 | loss: 0.5882834
	speed: 0.0031s/iter; left time: 4.8416s
Updating learning rate to 2.595956294375e-05
Validation loss decreased (0.3433 --> 0.3412).  Saving model state dict ...
Epoch: 5 cost time: 1.6499300003051758
Epoch: 5, Steps: 514 | Train Loss: 0.3853595 Vali Loss: 0.3412094 Best vali loss: 0.3412094
	iters: 100, epoch: 6 | loss: 0.3123067
	speed: 0.0071s/iter; left time: 10.1948s
	iters: 200, epoch: 6 | loss: 0.7419907
	speed: 0.0032s/iter; left time: 4.2613s
	iters: 300, epoch: 6 | loss: 0.4717043
	speed: 0.0031s/iter; left time: 3.8715s
	iters: 400, epoch: 6 | loss: 0.4366062
	speed: 0.0031s/iter; left time: 3.5222s
	iters: 500, epoch: 6 | loss: 0.9850638
	speed: 0.0031s/iter; left time: 3.2073s
Updating learning rate to 1.2979781471875e-05
Validation loss decreased (0.3412 --> 0.3390).  Saving model state dict ...
Epoch: 6 cost time: 1.6480224132537842
Epoch: 6, Steps: 514 | Train Loss: 0.5895343 Vali Loss: 0.3389831 Best vali loss: 0.3389831
	iters: 100, epoch: 7 | loss: 0.5555198
	speed: 0.0075s/iter; left time: 6.9871s
	iters: 200, epoch: 7 | loss: 0.4251848
	speed: 0.0036s/iter; left time: 2.9896s
	iters: 300, epoch: 7 | loss: 0.4664463
	speed: 0.0036s/iter; left time: 2.6352s
	iters: 400, epoch: 7 | loss: 0.6351768
	speed: 0.0036s/iter; left time: 2.2404s
	iters: 500, epoch: 7 | loss: 0.6744990
	speed: 0.0032s/iter; left time: 1.6865s
Updating learning rate to 6.4898907359375e-06
Epoch: 7 cost time: 1.8441147804260254
Epoch: 7, Steps: 514 | Train Loss: 0.5513653 Vali Loss: 0.3392559 Best vali loss: 0.3389831
	iters: 100, epoch: 8 | loss: 0.5348714
	speed: 0.0069s/iter; left time: 2.8608s
	iters: 200, epoch: 8 | loss: 0.7156261
	speed: 0.0031s/iter; left time: 0.9728s
	iters: 300, epoch: 8 | loss: 0.4830345
	speed: 0.0031s/iter; left time: 0.6745s
	iters: 400, epoch: 8 | loss: 0.7673115
	speed: 0.0031s/iter; left time: 0.3609s
	iters: 500, epoch: 8 | loss: 0.5425267
	speed: 0.0031s/iter; left time: 0.0465s
Updating learning rate to 3.24494536796875e-06
Epoch: 8 cost time: 1.6461460590362549
Epoch: 8, Steps: 514 | Train Loss: 0.6086740 Vali Loss: 0.3403910 Best vali loss: 0.3389831

best validation loss 0.3389831150210442

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0067863677074, 'e_layers': 2, 'learning_rate': 0.0028816426011, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6280995
	speed: 0.0105s/iter; left time: 9.7732s
Updating learning rate to 0.0028816426011
Validation loss decreased (inf --> 0.3835).  Saving model state dict ...
Epoch: 1 cost time: 0.893496036529541
Epoch: 1, Steps: 129 | Train Loss: 0.6280995 Vali Loss: 0.3834633 Best vali loss: 0.3834633
	iters: 100, epoch: 2 | loss: 0.6504220
	speed: 0.0075s/iter; left time: 5.9917s
Updating learning rate to 0.00144082130055
Validation loss decreased (0.3835 --> 0.3832).  Saving model state dict ...
Epoch: 2 cost time: 0.5918600559234619
Epoch: 2, Steps: 129 | Train Loss: 0.6504220 Vali Loss: 0.3831539 Best vali loss: 0.3831539
	iters: 100, epoch: 3 | loss: 0.5040405
	speed: 0.0074s/iter; left time: 4.9829s
Updating learning rate to 0.000720410650275
Validation loss decreased (0.3832 --> 0.3766).  Saving model state dict ...
Epoch: 3 cost time: 0.577538251876831
Epoch: 3, Steps: 129 | Train Loss: 0.5040405 Vali Loss: 0.3765946 Best vali loss: 0.3765946
	iters: 100, epoch: 4 | loss: 0.6367955
	speed: 0.0076s/iter; left time: 4.1384s
Updating learning rate to 0.0003602053251375
Epoch: 4 cost time: 0.5944681167602539
Epoch: 4, Steps: 129 | Train Loss: 0.6367955 Vali Loss: 0.3794922 Best vali loss: 0.3765946
	iters: 100, epoch: 5 | loss: 0.3850991
	speed: 0.0070s/iter; left time: 2.9144s
Updating learning rate to 0.00018010266256875
Epoch: 5 cost time: 0.5386765003204346
Epoch: 5, Steps: 129 | Train Loss: 0.3850991 Vali Loss: 0.3776224 Best vali loss: 0.3765946
	iters: 100, epoch: 6 | loss: 0.6498287
	speed: 0.0069s/iter; left time: 1.9837s
Updating learning rate to 9.0051331284375e-05
Epoch: 6 cost time: 0.5377905368804932
Epoch: 6, Steps: 129 | Train Loss: 0.6498287 Vali Loss: 0.3838632 Best vali loss: 0.3765946
	iters: 100, epoch: 7 | loss: 0.4910400
	speed: 0.0068s/iter; left time: 1.0830s
Updating learning rate to 4.50256656421875e-05
Epoch: 7 cost time: 0.5370099544525146
Epoch: 7, Steps: 129 | Train Loss: 0.4910400 Vali Loss: 0.3798430 Best vali loss: 0.3765946
	iters: 100, epoch: 8 | loss: 0.9701278
	speed: 0.0068s/iter; left time: 0.2029s
Updating learning rate to 2.251283282109375e-05
Epoch: 8 cost time: 0.5321121215820312
Epoch: 8, Steps: 129 | Train Loss: 0.9701278 Vali Loss: 0.3844468 Best vali loss: 0.3765946

best validation loss 0.3765946345619696

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.004520595634, 'e_layers': 4, 'learning_rate': 0.0004146359561, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5295669
	speed: 0.0118s/iter; left time: 47.3172s
	iters: 200, epoch: 1 | loss: 0.6559870
	speed: 0.0055s/iter; left time: 21.6400s
	iters: 300, epoch: 1 | loss: 0.3586117
	speed: 0.0055s/iter; left time: 20.9264s
	iters: 400, epoch: 1 | loss: 0.8546011
	speed: 0.0055s/iter; left time: 20.5033s
	iters: 500, epoch: 1 | loss: 0.4902898
	speed: 0.0056s/iter; left time: 20.0631s
Updating learning rate to 0.0004146359561
Validation loss decreased (inf --> 0.3919).  Saving model state dict ...
Epoch: 1 cost time: 3.193726062774658
Epoch: 1, Steps: 514 | Train Loss: 0.5778113 Vali Loss: 0.3918628 Best vali loss: 0.3918628
	iters: 100, epoch: 2 | loss: 0.7023411
	speed: 0.0112s/iter; left time: 39.3319s
	iters: 200, epoch: 2 | loss: 0.5479277
	speed: 0.0054s/iter; left time: 18.4328s
	iters: 300, epoch: 2 | loss: 0.9917461
	speed: 0.0055s/iter; left time: 18.0307s
	iters: 400, epoch: 2 | loss: 1.0602753
	speed: 0.0055s/iter; left time: 17.6931s
	iters: 500, epoch: 2 | loss: 1.1048663
	speed: 0.0054s/iter; left time: 16.6209s
Updating learning rate to 0.00020731797805
Epoch: 2 cost time: 2.83280873298645
Epoch: 2, Steps: 514 | Train Loss: 0.8814313 Vali Loss: 0.4043460 Best vali loss: 0.3918628
	iters: 100, epoch: 3 | loss: 0.8698669
	speed: 0.0107s/iter; left time: 31.8448s
	iters: 200, epoch: 3 | loss: 0.8174105
	speed: 0.0053s/iter; left time: 15.3446s
	iters: 300, epoch: 3 | loss: 0.8154467
	speed: 0.0053s/iter; left time: 14.8846s
	iters: 400, epoch: 3 | loss: 0.5519239
	speed: 0.0053s/iter; left time: 14.2627s
	iters: 500, epoch: 3 | loss: 0.8833873
	speed: 0.0054s/iter; left time: 14.0581s
Updating learning rate to 0.000103658989025
Epoch: 3 cost time: 2.7979846000671387
Epoch: 3, Steps: 514 | Train Loss: 0.7876070 Vali Loss: 0.4008905 Best vali loss: 0.3918628
	iters: 100, epoch: 4 | loss: 0.8289168
	speed: 0.0109s/iter; left time: 26.8126s
	iters: 200, epoch: 4 | loss: 0.4175881
	speed: 0.0054s/iter; left time: 12.7952s
	iters: 300, epoch: 4 | loss: 0.8009335
	speed: 0.0054s/iter; left time: 12.1883s
	iters: 400, epoch: 4 | loss: 0.4966114
	speed: 0.0054s/iter; left time: 11.6389s
	iters: 500, epoch: 4 | loss: 0.7195640
	speed: 0.0054s/iter; left time: 11.1243s
Updating learning rate to 5.18294945125e-05
Validation loss decreased (0.3919 --> 0.3904).  Saving model state dict ...
Epoch: 4 cost time: 2.8066141605377197
Epoch: 4, Steps: 514 | Train Loss: 0.6527228 Vali Loss: 0.3903953 Best vali loss: 0.3903953
	iters: 100, epoch: 5 | loss: 0.2874640
	speed: 0.0114s/iter; left time: 22.3556s
	iters: 200, epoch: 5 | loss: 0.7263098
	speed: 0.0054s/iter; left time: 10.1052s
	iters: 300, epoch: 5 | loss: 0.4598485
	speed: 0.0053s/iter; left time: 9.3785s
	iters: 400, epoch: 5 | loss: 0.5230370
	speed: 0.0054s/iter; left time: 8.8982s
	iters: 500, epoch: 5 | loss: 0.7482199
	speed: 0.0054s/iter; left time: 8.4096s
Updating learning rate to 2.591474725625e-05
Epoch: 5 cost time: 2.8272581100463867
Epoch: 5, Steps: 514 | Train Loss: 0.5489758 Vali Loss: 0.3934190 Best vali loss: 0.3903953
	iters: 100, epoch: 6 | loss: 0.5863187
	speed: 0.0109s/iter; left time: 15.7941s
	iters: 200, epoch: 6 | loss: 0.5794299
	speed: 0.0056s/iter; left time: 7.4704s
	iters: 300, epoch: 6 | loss: 0.5518085
	speed: 0.0057s/iter; left time: 7.0500s
	iters: 400, epoch: 6 | loss: 0.3981180
	speed: 0.0057s/iter; left time: 6.4901s
	iters: 500, epoch: 6 | loss: 0.8197061
	speed: 0.0057s/iter; left time: 5.9360s
Updating learning rate to 1.2957373628125e-05
Epoch: 6 cost time: 2.936129570007324
Epoch: 6, Steps: 514 | Train Loss: 0.5870762 Vali Loss: 0.3941783 Best vali loss: 0.3903953
	iters: 100, epoch: 7 | loss: 0.8547016
	speed: 0.0108s/iter; left time: 10.0090s
	iters: 200, epoch: 7 | loss: 0.5196305
	speed: 0.0053s/iter; left time: 4.4259s
	iters: 300, epoch: 7 | loss: 0.5765416
	speed: 0.0054s/iter; left time: 3.9375s
	iters: 400, epoch: 7 | loss: 0.5223730
	speed: 0.0053s/iter; left time: 3.3498s
	iters: 500, epoch: 7 | loss: 0.7867115
	speed: 0.0054s/iter; left time: 2.8495s
Updating learning rate to 6.4786868140625e-06
Epoch: 7 cost time: 2.799002170562744
Epoch: 7, Steps: 514 | Train Loss: 0.6519917 Vali Loss: 0.3935023 Best vali loss: 0.3903953
	iters: 100, epoch: 8 | loss: 0.4555293
	speed: 0.0106s/iter; left time: 4.3980s
	iters: 200, epoch: 8 | loss: 0.3463340
	speed: 0.0055s/iter; left time: 1.7241s
	iters: 300, epoch: 8 | loss: 0.8384284
	speed: 0.0055s/iter; left time: 1.1758s
	iters: 400, epoch: 8 | loss: 0.9566613
	speed: 0.0055s/iter; left time: 0.6345s
	iters: 500, epoch: 8 | loss: 1.2468733
	speed: 0.0054s/iter; left time: 0.0808s
Updating learning rate to 3.23934340703125e-06
Epoch: 8 cost time: 2.8340487480163574
Epoch: 8, Steps: 514 | Train Loss: 0.7687653 Vali Loss: 0.3937197 Best vali loss: 0.3903953

best validation loss 0.39039526835874394

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7327759
	speed: 0.0118s/iter; left time: 47.2091s
	iters: 200, epoch: 1 | loss: 0.8507351
	speed: 0.0054s/iter; left time: 21.0948s
	iters: 300, epoch: 1 | loss: 1.4249383
	speed: 0.0054s/iter; left time: 20.6017s
	iters: 400, epoch: 1 | loss: 0.3383273
	speed: 0.0053s/iter; left time: 19.7915s
	iters: 500, epoch: 1 | loss: 1.0210537
	speed: 0.0053s/iter; left time: 19.2126s
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.4076).  Saving model state dict ...
Epoch: 1 cost time: 3.116771697998047
Epoch: 1, Steps: 514 | Train Loss: 0.8735661 Vali Loss: 0.4075985 Best vali loss: 0.4075985
	iters: 100, epoch: 2 | loss: 1.0618874
	speed: 0.0100s/iter; left time: 34.9216s
	iters: 200, epoch: 2 | loss: 0.9486092
	speed: 0.0048s/iter; left time: 16.4490s
	iters: 300, epoch: 2 | loss: 0.9030769
	speed: 0.0048s/iter; left time: 15.9048s
	iters: 400, epoch: 2 | loss: 0.8623068
	speed: 0.0048s/iter; left time: 15.4737s
	iters: 500, epoch: 2 | loss: 0.6437064
	speed: 0.0048s/iter; left time: 15.0110s
Updating learning rate to 0.00035351260405
Validation loss decreased (0.4076 --> 0.4024).  Saving model state dict ...
Epoch: 2 cost time: 2.528296947479248
Epoch: 2, Steps: 514 | Train Loss: 0.8839173 Vali Loss: 0.4023856 Best vali loss: 0.4023856
	iters: 100, epoch: 3 | loss: 0.3202367
	speed: 0.0107s/iter; left time: 31.8467s
	iters: 200, epoch: 3 | loss: 0.6317096
	speed: 0.0052s/iter; left time: 15.1035s
	iters: 300, epoch: 3 | loss: 0.6210604
	speed: 0.0053s/iter; left time: 14.6362s
	iters: 400, epoch: 3 | loss: 1.0145668
	speed: 0.0052s/iter; left time: 14.0910s
	iters: 500, epoch: 3 | loss: 0.4249511
	speed: 0.0046s/iter; left time: 11.9775s
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 2.6834027767181396
Epoch: 3, Steps: 514 | Train Loss: 0.6025049 Vali Loss: 0.4075709 Best vali loss: 0.4023856

best validation loss 0.40238557007083253

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0060022917356, 'e_layers': 3, 'learning_rate': 9.68471895e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7957096
	speed: 0.0109s/iter; left time: 21.3130s
	iters: 200, epoch: 1 | loss: 0.5999549
	speed: 0.0046s/iter; left time: 8.5446s
Updating learning rate to 9.3161162830146e-05
Validation loss decreased (inf --> 0.3718).  Saving model state dict ...
Epoch: 1 cost time: 1.5359346866607666
Epoch: 1, Steps: 257 | Train Loss: 0.6978323 Vali Loss: 0.3717792 Best vali loss: 0.3717792
	iters: 100, epoch: 2 | loss: 0.6167150
	speed: 0.0095s/iter; left time: 16.1387s
	iters: 200, epoch: 2 | loss: 0.4228746
	speed: 0.0044s/iter; left time: 7.0395s
Updating learning rate to 8.266424696715431e-05
Validation loss decreased (0.3718 --> 0.3665).  Saving model state dict ...
Epoch: 2 cost time: 1.1661264896392822
Epoch: 2, Steps: 257 | Train Loss: 0.5197948 Vali Loss: 0.3665460 Best vali loss: 0.3665460
	iters: 100, epoch: 3 | loss: 0.4876127
	speed: 0.0094s/iter; left time: 13.5380s
	iters: 200, epoch: 3 | loss: 0.3143674
	speed: 0.0042s/iter; left time: 5.6323s
Updating learning rate to 6.695450219638614e-05
Validation loss decreased (0.3665 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 1.1463851928710938
Epoch: 3, Steps: 257 | Train Loss: 0.4009901 Vali Loss: 0.3665394 Best vali loss: 0.3665394

best validation loss 0.36653939289990484

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018096595454, 'e_layers': 2, 'learning_rate': 0.000241032673, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4879881
	speed: 0.0095s/iter; left time: 76.8448s
	iters: 200, epoch: 1 | loss: 0.5360898
	speed: 0.0033s/iter; left time: 26.6889s
	iters: 300, epoch: 1 | loss: 0.8530962
	speed: 0.0033s/iter; left time: 25.9869s
	iters: 400, epoch: 1 | loss: 0.3362172
	speed: 0.0033s/iter; left time: 25.6578s
	iters: 500, epoch: 1 | loss: 0.8678969
	speed: 0.0033s/iter; left time: 25.5383s
	iters: 600, epoch: 1 | loss: 0.5119065
	speed: 0.0033s/iter; left time: 25.2830s
	iters: 700, epoch: 1 | loss: 0.6741825
	speed: 0.0033s/iter; left time: 24.6761s
	iters: 800, epoch: 1 | loss: 0.3818457
	speed: 0.0033s/iter; left time: 24.6388s
	iters: 900, epoch: 1 | loss: 0.9012825
	speed: 0.0033s/iter; left time: 24.1896s
	iters: 1000, epoch: 1 | loss: 0.5230587
	speed: 0.0033s/iter; left time: 23.9012s
Updating learning rate to 0.00023185891312559295
Validation loss decreased (inf --> 0.3569).  Saving model state dict ...
Epoch: 1 cost time: 3.729994535446167
Epoch: 1, Steps: 1027 | Train Loss: 0.7073564 Vali Loss: 0.3569397 Best vali loss: 0.3569397
	iters: 100, epoch: 2 | loss: 0.9571418
	speed: 0.0091s/iter; left time: 64.3027s
	iters: 200, epoch: 2 | loss: 1.4378231
	speed: 0.0028s/iter; left time: 19.9162s
	iters: 300, epoch: 2 | loss: 0.7021514
	speed: 0.0028s/iter; left time: 19.6244s
	iters: 400, epoch: 2 | loss: 1.0462633
	speed: 0.0028s/iter; left time: 19.2709s
	iters: 500, epoch: 2 | loss: 1.1846853
	speed: 0.0028s/iter; left time: 19.0347s
	iters: 600, epoch: 2 | loss: 0.8621835
	speed: 0.0029s/iter; left time: 18.9840s
	iters: 700, epoch: 2 | loss: 0.3858825
	speed: 0.0030s/iter; left time: 19.3449s
	iters: 800, epoch: 2 | loss: 0.2911331
	speed: 0.0029s/iter; left time: 18.7793s
	iters: 900, epoch: 2 | loss: 0.5471293
	speed: 0.0029s/iter; left time: 18.0503s
	iters: 1000, epoch: 2 | loss: 0.2324256
	speed: 0.0029s/iter; left time: 17.7270s
Updating learning rate to 0.00020573425528290983
Epoch: 2 cost time: 3.0011277198791504
Epoch: 2, Steps: 1027 | Train Loss: 0.7646819 Vali Loss: 0.3772972 Best vali loss: 0.3569397
	iters: 100, epoch: 3 | loss: 0.4189287
	speed: 0.0090s/iter; left time: 54.2802s
	iters: 200, epoch: 3 | loss: 0.3235511
	speed: 0.0030s/iter; left time: 17.7234s
	iters: 300, epoch: 3 | loss: 0.4306508
	speed: 0.0030s/iter; left time: 17.7695s
	iters: 400, epoch: 3 | loss: 0.3435538
	speed: 0.0030s/iter; left time: 17.5767s
	iters: 500, epoch: 3 | loss: 1.1092564
	speed: 0.0031s/iter; left time: 17.4467s
	iters: 600, epoch: 3 | loss: 0.9129912
	speed: 0.0031s/iter; left time: 17.0206s
	iters: 700, epoch: 3 | loss: 0.5767165
	speed: 0.0031s/iter; left time: 16.7719s
	iters: 800, epoch: 3 | loss: 1.8224599
	speed: 0.0030s/iter; left time: 16.1127s
	iters: 900, epoch: 3 | loss: 0.8295739
	speed: 0.0029s/iter; left time: 15.0654s
	iters: 1000, epoch: 3 | loss: 0.2616447
	speed: 0.0029s/iter; left time: 14.9217s
Updating learning rate to 0.00016663594180788617
Validation loss decreased (0.3569 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 3.1156551837921143
Epoch: 3, Steps: 1027 | Train Loss: 0.7029327 Vali Loss: 0.3539001 Best vali loss: 0.3539001

best validation loss 0.35390007616494634

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0018096595454, 'e_layers': 2, 'learning_rate': 0.000241032673, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9233122
	speed: 0.0095s/iter; left time: 47.8702s
	iters: 200, epoch: 4 | loss: 0.3635486
	speed: 0.0033s/iter; left time: 16.4644s
	iters: 300, epoch: 4 | loss: 0.8276060
	speed: 0.0033s/iter; left time: 16.1665s
	iters: 400, epoch: 4 | loss: 0.2716598
	speed: 0.0033s/iter; left time: 15.6987s
	iters: 500, epoch: 4 | loss: 0.7873144
	speed: 0.0033s/iter; left time: 15.4412s
	iters: 600, epoch: 4 | loss: 0.4355557
	speed: 0.0033s/iter; left time: 14.9305s
	iters: 700, epoch: 4 | loss: 0.6673117
	speed: 0.0033s/iter; left time: 14.7119s
	iters: 800, epoch: 4 | loss: 0.3398603
	speed: 0.0033s/iter; left time: 14.3439s
	iters: 900, epoch: 4 | loss: 0.8919848
	speed: 0.0033s/iter; left time: 13.8710s
	iters: 1000, epoch: 4 | loss: 0.4025688
	speed: 0.0033s/iter; left time: 13.5893s
Updating learning rate to 0.0001205163365
Validation loss decreased (0.3539 --> 0.3495).  Saving model state dict ...
Epoch: 4 cost time: 3.743299722671509
Epoch: 4, Steps: 1027 | Train Loss: 0.5910722 Vali Loss: 0.3495380 Best vali loss: 0.3495380
	iters: 100, epoch: 5 | loss: 0.9185628
	speed: 0.0092s/iter; left time: 37.0695s
	iters: 200, epoch: 5 | loss: 0.9683711
	speed: 0.0029s/iter; left time: 11.2460s
	iters: 300, epoch: 5 | loss: 0.5000175
	speed: 0.0029s/iter; left time: 10.9443s
	iters: 400, epoch: 5 | loss: 0.9928508
	speed: 0.0029s/iter; left time: 10.6395s
	iters: 500, epoch: 5 | loss: 0.6475995
	speed: 0.0029s/iter; left time: 10.4890s
	iters: 600, epoch: 5 | loss: 0.6332586
	speed: 0.0031s/iter; left time: 10.8501s
	iters: 700, epoch: 5 | loss: 0.2945414
	speed: 0.0030s/iter; left time: 10.3488s
	iters: 800, epoch: 5 | loss: 0.2871849
	speed: 0.0029s/iter; left time: 9.7551s
	iters: 900, epoch: 5 | loss: 0.4201499
	speed: 0.0029s/iter; left time: 9.1746s
	iters: 1000, epoch: 5 | loss: 0.2061468
	speed: 0.0029s/iter; left time: 8.8731s
Updating learning rate to 7.439673119211387e-05
Validation loss decreased (0.3495 --> 0.3410).  Saving model state dict ...
Epoch: 5 cost time: 3.0421061515808105
Epoch: 5, Steps: 1027 | Train Loss: 0.5868683 Vali Loss: 0.3409835 Best vali loss: 0.3409835
	iters: 100, epoch: 6 | loss: 0.3782247
	speed: 0.0098s/iter; left time: 29.1224s
	iters: 200, epoch: 6 | loss: 0.3292183
	speed: 0.0033s/iter; left time: 9.6167s
	iters: 300, epoch: 6 | loss: 0.4023430
	speed: 0.0033s/iter; left time: 9.2939s
	iters: 400, epoch: 6 | loss: 0.3380093
	speed: 0.0034s/iter; left time: 9.0183s
	iters: 500, epoch: 6 | loss: 1.0227742
	speed: 0.0034s/iter; left time: 8.6513s
	iters: 600, epoch: 6 | loss: 0.7293558
	speed: 0.0033s/iter; left time: 8.1868s
	iters: 700, epoch: 6 | loss: 0.4773233
	speed: 0.0034s/iter; left time: 8.1133s
	iters: 800, epoch: 6 | loss: 1.1976374
	speed: 0.0033s/iter; left time: 7.5385s
	iters: 900, epoch: 6 | loss: 0.7595277
	speed: 0.0033s/iter; left time: 7.1167s
	iters: 1000, epoch: 6 | loss: 0.2261800
	speed: 0.0033s/iter; left time: 6.8428s
Updating learning rate to 3.529841771709018e-05
Epoch: 6 cost time: 3.462358236312866
Epoch: 6, Steps: 1027 | Train Loss: 0.5860594 Vali Loss: 0.3445099 Best vali loss: 0.3409835
	iters: 100, epoch: 7 | loss: 0.3675789
	speed: 0.0094s/iter; left time: 18.3021s
	iters: 200, epoch: 7 | loss: 0.3762731
	speed: 0.0033s/iter; left time: 6.1938s
	iters: 300, epoch: 7 | loss: 0.1938534
	speed: 0.0033s/iter; left time: 5.8046s
	iters: 400, epoch: 7 | loss: 0.2852178
	speed: 0.0033s/iter; left time: 5.4849s
	iters: 500, epoch: 7 | loss: 0.5827501
	speed: 0.0033s/iter; left time: 5.0710s
	iters: 600, epoch: 7 | loss: 0.5402691
	speed: 0.0032s/iter; left time: 4.7245s
	iters: 700, epoch: 7 | loss: 0.3144040
	speed: 0.0033s/iter; left time: 4.4770s
	iters: 800, epoch: 7 | loss: 0.2487959
	speed: 0.0034s/iter; left time: 4.2050s
	iters: 900, epoch: 7 | loss: 0.3146209
	speed: 0.0033s/iter; left time: 3.7812s
	iters: 1000, epoch: 7 | loss: 0.4664218
	speed: 0.0033s/iter; left time: 3.5163s
Updating learning rate to 9.173759874407078e-06
Epoch: 7 cost time: 3.433271646499634
Epoch: 7, Steps: 1027 | Train Loss: 0.3690185 Vali Loss: 0.3493401 Best vali loss: 0.3409835
	iters: 100, epoch: 8 | loss: 0.2962888
	speed: 0.0090s/iter; left time: 8.3530s
	iters: 200, epoch: 8 | loss: 0.3938102
	speed: 0.0030s/iter; left time: 2.4668s
	iters: 300, epoch: 8 | loss: 0.2750166
	speed: 0.0029s/iter; left time: 2.0926s
	iters: 400, epoch: 8 | loss: 0.4040063
	speed: 0.0029s/iter; left time: 1.8107s
	iters: 500, epoch: 8 | loss: 0.4698564
	speed: 0.0029s/iter; left time: 1.5225s
	iters: 600, epoch: 8 | loss: 0.1957799
	speed: 0.0029s/iter; left time: 1.2323s
	iters: 700, epoch: 8 | loss: 0.5518455
	speed: 0.0029s/iter; left time: 0.9435s
	iters: 800, epoch: 8 | loss: 0.7504233
	speed: 0.0029s/iter; left time: 0.6559s
	iters: 900, epoch: 8 | loss: 0.2520079
	speed: 0.0030s/iter; left time: 0.3820s
	iters: 1000, epoch: 8 | loss: 0.2919238
	speed: 0.0029s/iter; left time: 0.0801s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.031306505203247
Epoch: 8, Steps: 1027 | Train Loss: 0.3880959 Vali Loss: 0.3449971 Best vali loss: 0.3409835

best validation loss 0.3409834576613308

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012847228125, 'e_layers': 4, 'learning_rate': 0.0001779376336, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6517556
	speed: 0.0123s/iter; left time: 11.5088s
Updating learning rate to 0.0001779376336
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 1.1234686374664307
Epoch: 1, Steps: 129 | Train Loss: 0.6517556 Vali Loss: 0.3697533 Best vali loss: 0.3697533
	iters: 100, epoch: 2 | loss: 0.7611154
	speed: 0.0099s/iter; left time: 7.9596s
Updating learning rate to 8.89688168e-05
Validation loss decreased (0.3698 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.8225138187408447
Epoch: 2, Steps: 129 | Train Loss: 0.7611154 Vali Loss: 0.3670336 Best vali loss: 0.3670336
	iters: 100, epoch: 3 | loss: 0.5190567
	speed: 0.0097s/iter; left time: 6.5525s
Updating learning rate to 4.44844084e-05
Validation loss decreased (0.3670 --> 0.3642).  Saving model state dict ...
Epoch: 3 cost time: 0.8019587993621826
Epoch: 3, Steps: 129 | Train Loss: 0.5190567 Vali Loss: 0.3641842 Best vali loss: 0.3641842
	iters: 100, epoch: 4 | loss: 0.7427481
	speed: 0.0097s/iter; left time: 5.2732s
Updating learning rate to 2.22422042e-05
Epoch: 4 cost time: 0.7948276996612549
Epoch: 4, Steps: 129 | Train Loss: 0.7427481 Vali Loss: 0.3653826 Best vali loss: 0.3641842
	iters: 100, epoch: 5 | loss: 0.4944875
	speed: 0.0097s/iter; left time: 4.0394s
Updating learning rate to 1.11211021e-05
Epoch: 5 cost time: 0.8080735206604004
Epoch: 5, Steps: 129 | Train Loss: 0.4944875 Vali Loss: 0.3657278 Best vali loss: 0.3641842
	iters: 100, epoch: 6 | loss: 0.5311617
	speed: 0.0089s/iter; left time: 2.5613s
Updating learning rate to 5.56055105e-06
Epoch: 6 cost time: 0.713855504989624
Epoch: 6, Steps: 129 | Train Loss: 0.5311617 Vali Loss: 0.3660956 Best vali loss: 0.3641842
	iters: 100, epoch: 7 | loss: 0.5331025
	speed: 0.0089s/iter; left time: 1.4115s
Updating learning rate to 2.780275525e-06
Epoch: 7 cost time: 0.7233710289001465
Epoch: 7, Steps: 129 | Train Loss: 0.5331025 Vali Loss: 0.3663186 Best vali loss: 0.3641842
	iters: 100, epoch: 8 | loss: 0.7866014
	speed: 0.0088s/iter; left time: 0.2642s
Updating learning rate to 1.3901377625e-06
Epoch: 8 cost time: 0.7078173160552979
Epoch: 8, Steps: 129 | Train Loss: 0.7866014 Vali Loss: 0.3663939 Best vali loss: 0.3641842

best validation loss 0.36418424991118653

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010444055255, 'e_layers': 1, 'learning_rate': 0.0001006928039, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3802180
	speed: 0.0088s/iter; left time: 71.3500s
	iters: 200, epoch: 1 | loss: 0.3973613
	speed: 0.0025s/iter; left time: 19.6822s
	iters: 300, epoch: 1 | loss: 0.5258965
	speed: 0.0024s/iter; left time: 19.3780s
	iters: 400, epoch: 1 | loss: 0.2661833
	speed: 0.0024s/iter; left time: 19.0250s
	iters: 500, epoch: 1 | loss: 0.9952033
	speed: 0.0025s/iter; left time: 19.0100s
	iters: 600, epoch: 1 | loss: 0.6792226
	speed: 0.0022s/iter; left time: 16.5321s
	iters: 700, epoch: 1 | loss: 1.0876200
	speed: 0.0023s/iter; left time: 17.3701s
	iters: 800, epoch: 1 | loss: 0.6079579
	speed: 0.0024s/iter; left time: 17.5880s
	iters: 900, epoch: 1 | loss: 0.5130317
	speed: 0.0021s/iter; left time: 15.5166s
	iters: 1000, epoch: 1 | loss: 0.3041590
	speed: 0.0021s/iter; left time: 15.2667s
Updating learning rate to 9.686041224719133e-05
Validation loss decreased (inf --> 0.3610).  Saving model state dict ...
Epoch: 1 cost time: 2.7425894737243652
Epoch: 1, Steps: 1027 | Train Loss: 0.5756854 Vali Loss: 0.3609544 Best vali loss: 0.3609544
	iters: 100, epoch: 2 | loss: 0.2887439
	speed: 0.0077s/iter; left time: 54.8093s
	iters: 200, epoch: 2 | loss: 0.2571107
	speed: 0.0025s/iter; left time: 17.3975s
	iters: 300, epoch: 2 | loss: 0.5592551
	speed: 0.0025s/iter; left time: 17.0181s
	iters: 400, epoch: 2 | loss: 0.2496128
	speed: 0.0025s/iter; left time: 16.8786s
	iters: 500, epoch: 2 | loss: 1.2989311
	speed: 0.0025s/iter; left time: 16.5518s
	iters: 600, epoch: 2 | loss: 0.3804173
	speed: 0.0025s/iter; left time: 16.4337s
	iters: 700, epoch: 2 | loss: 0.3309195
	speed: 0.0025s/iter; left time: 16.0042s
	iters: 800, epoch: 2 | loss: 0.7897303
	speed: 0.0025s/iter; left time: 15.8631s
	iters: 900, epoch: 2 | loss: 0.5449079
	speed: 0.0025s/iter; left time: 15.6440s
	iters: 1000, epoch: 2 | loss: 0.6964209
	speed: 0.0025s/iter; left time: 15.4501s
Updating learning rate to 8.594668417718861e-05
Epoch: 2 cost time: 2.5909764766693115
Epoch: 2, Steps: 1027 | Train Loss: 0.5396049 Vali Loss: 0.3646019 Best vali loss: 0.3609544
	iters: 100, epoch: 3 | loss: 0.3892757
	speed: 0.0077s/iter; left time: 46.4338s
	iters: 200, epoch: 3 | loss: 0.4062802
	speed: 0.0024s/iter; left time: 14.2256s
	iters: 300, epoch: 3 | loss: 0.3431586
	speed: 0.0021s/iter; left time: 12.4986s
	iters: 400, epoch: 3 | loss: 0.7096402
	speed: 0.0021s/iter; left time: 12.0004s
	iters: 500, epoch: 3 | loss: 0.5008833
	speed: 0.0021s/iter; left time: 12.0360s
	iters: 600, epoch: 3 | loss: 0.5665547
	speed: 0.0021s/iter; left time: 11.9270s
	iters: 700, epoch: 3 | loss: 0.6646709
	speed: 0.0021s/iter; left time: 11.7033s
	iters: 800, epoch: 3 | loss: 0.3122433
	speed: 0.0022s/iter; left time: 11.6292s
	iters: 900, epoch: 3 | loss: 1.1544752
	speed: 0.0021s/iter; left time: 11.2393s
	iters: 1000, epoch: 3 | loss: 1.6572436
	speed: 0.0022s/iter; left time: 11.1149s
Updating learning rate to 6.961313585545845e-05
Epoch: 3 cost time: 2.291306734085083
Epoch: 3, Steps: 1027 | Train Loss: 0.6704426 Vali Loss: 0.3747892 Best vali loss: 0.3609544
	iters: 100, epoch: 4 | loss: 0.4272084
	speed: 0.0073s/iter; left time: 36.8485s
	iters: 200, epoch: 4 | loss: 0.3384144
	speed: 0.0023s/iter; left time: 11.2719s
	iters: 300, epoch: 4 | loss: 0.7917286
	speed: 0.0023s/iter; left time: 11.0691s
	iters: 400, epoch: 4 | loss: 0.2806253
	speed: 0.0023s/iter; left time: 10.7091s
	iters: 500, epoch: 4 | loss: 0.3384462
	speed: 0.0022s/iter; left time: 10.2306s
	iters: 600, epoch: 4 | loss: 0.2315391
	speed: 0.0022s/iter; left time: 10.1443s
	iters: 700, epoch: 4 | loss: 0.9863294
	speed: 0.0022s/iter; left time: 9.6518s
	iters: 800, epoch: 4 | loss: 0.2739081
	speed: 0.0022s/iter; left time: 9.5485s
	iters: 900, epoch: 4 | loss: 0.3028324
	speed: 0.0022s/iter; left time: 9.3196s
	iters: 1000, epoch: 4 | loss: 0.3293903
	speed: 0.0022s/iter; left time: 9.1740s
Updating learning rate to 5.034640195e-05
Epoch: 4 cost time: 2.319284677505493
Epoch: 4, Steps: 1027 | Train Loss: 0.4300422 Vali Loss: 0.3842564 Best vali loss: 0.3609544
	iters: 100, epoch: 5 | loss: 0.3925940
	speed: 0.0070s/iter; left time: 28.0340s
	iters: 200, epoch: 5 | loss: 0.3323272
	speed: 0.0021s/iter; left time: 8.2456s
	iters: 300, epoch: 5 | loss: 0.2124743
	speed: 0.0021s/iter; left time: 7.9320s
	iters: 400, epoch: 5 | loss: 0.3285380
	speed: 0.0021s/iter; left time: 7.7708s
	iters: 500, epoch: 5 | loss: 0.2311448
	speed: 0.0021s/iter; left time: 7.6599s
	iters: 600, epoch: 5 | loss: 0.8053410
	speed: 0.0021s/iter; left time: 7.2854s
	iters: 700, epoch: 5 | loss: 0.2752672
	speed: 0.0020s/iter; left time: 6.9403s
	iters: 800, epoch: 5 | loss: 0.6639899
	speed: 0.0020s/iter; left time: 6.6564s
	iters: 900, epoch: 5 | loss: 0.6611478
	speed: 0.0022s/iter; left time: 7.0039s
	iters: 1000, epoch: 5 | loss: 0.6708781
	speed: 0.0023s/iter; left time: 7.0424s
Updating learning rate to 3.107966804454155e-05
Epoch: 5 cost time: 2.2062458992004395
Epoch: 5, Steps: 1027 | Train Loss: 0.4573702 Vali Loss: 0.3843733 Best vali loss: 0.3609544
	iters: 100, epoch: 6 | loss: 0.3779331
	speed: 0.0077s/iter; left time: 22.8288s
	iters: 200, epoch: 6 | loss: 0.1815016
	speed: 0.0025s/iter; left time: 7.2126s
	iters: 300, epoch: 6 | loss: 0.5182335
	speed: 0.0024s/iter; left time: 6.7789s
	iters: 400, epoch: 6 | loss: 0.2460457
	speed: 0.0025s/iter; left time: 6.7619s
	iters: 500, epoch: 6 | loss: 0.3214825
	speed: 0.0023s/iter; left time: 5.9687s
	iters: 600, epoch: 6 | loss: 0.2421909
	speed: 0.0022s/iter; left time: 5.5168s
	iters: 700, epoch: 6 | loss: 0.3087588
	speed: 0.0025s/iter; left time: 5.9491s
	iters: 800, epoch: 6 | loss: 0.5027825
	speed: 0.0021s/iter; left time: 4.8399s
	iters: 900, epoch: 6 | loss: 0.3923952
	speed: 0.0024s/iter; left time: 5.1294s
	iters: 1000, epoch: 6 | loss: 0.7516147
	speed: 0.0022s/iter; left time: 4.5216s
Updating learning rate to 1.4746119722811383e-05
Epoch: 6 cost time: 2.4710381031036377
Epoch: 6, Steps: 1027 | Train Loss: 0.3842939 Vali Loss: 0.3852907 Best vali loss: 0.3609544
	iters: 100, epoch: 7 | loss: 0.3163956
	speed: 0.0073s/iter; left time: 14.3470s
	iters: 200, epoch: 7 | loss: 0.2858498
	speed: 0.0020s/iter; left time: 3.7709s
	iters: 300, epoch: 7 | loss: 0.6297674
	speed: 0.0020s/iter; left time: 3.5841s
	iters: 400, epoch: 7 | loss: 0.4285297
	speed: 0.0020s/iter; left time: 3.3675s
	iters: 500, epoch: 7 | loss: 0.4040325
	speed: 0.0021s/iter; left time: 3.2114s
	iters: 600, epoch: 7 | loss: 0.3944593
	speed: 0.0021s/iter; left time: 3.0913s
	iters: 700, epoch: 7 | loss: 0.4034818
	speed: 0.0021s/iter; left time: 2.8211s
	iters: 800, epoch: 7 | loss: 0.6593998
	speed: 0.0021s/iter; left time: 2.6558s
	iters: 900, epoch: 7 | loss: 1.3354299
	speed: 0.0021s/iter; left time: 2.4054s
	iters: 1000, epoch: 7 | loss: 0.2098992
	speed: 0.0020s/iter; left time: 2.1540s
Updating learning rate to 3.832391652808665e-06
Epoch: 7 cost time: 2.1731417179107666
Epoch: 7, Steps: 1027 | Train Loss: 0.5067245 Vali Loss: 0.3858102 Best vali loss: 0.3609544
	iters: 100, epoch: 8 | loss: 0.4224169
	speed: 0.0069s/iter; left time: 6.4471s
	iters: 200, epoch: 8 | loss: 0.7390463
	speed: 0.0020s/iter; left time: 1.6822s
	iters: 300, epoch: 8 | loss: 0.2502955
	speed: 0.0020s/iter; left time: 1.4773s
	iters: 400, epoch: 8 | loss: 0.4238087
	speed: 0.0020s/iter; left time: 1.2717s
	iters: 500, epoch: 8 | loss: 0.3552796
	speed: 0.0020s/iter; left time: 1.0649s
	iters: 600, epoch: 8 | loss: 0.2085918
	speed: 0.0023s/iter; left time: 0.9856s
	iters: 700, epoch: 8 | loss: 0.3038343
	speed: 0.0023s/iter; left time: 0.7599s
	iters: 800, epoch: 8 | loss: 0.7318997
	speed: 0.0025s/iter; left time: 0.5637s
	iters: 900, epoch: 8 | loss: 0.3067871
	speed: 0.0025s/iter; left time: 0.3206s
	iters: 1000, epoch: 8 | loss: 0.2842416
	speed: 0.0024s/iter; left time: 0.0680s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3320164680480957
Epoch: 8, Steps: 1027 | Train Loss: 0.4026202 Vali Loss: 0.3873797 Best vali loss: 0.3609544

best validation loss 0.36095439091412634

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020851248882, 'e_layers': 2, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3463320
	speed: 0.0097s/iter; left time: 38.9740s
	iters: 200, epoch: 1 | loss: 0.3991491
	speed: 0.0034s/iter; left time: 13.4310s
	iters: 300, epoch: 1 | loss: 0.3260634
	speed: 0.0035s/iter; left time: 13.4395s
	iters: 400, epoch: 1 | loss: 0.7552442
	speed: 0.0036s/iter; left time: 13.3842s
	iters: 500, epoch: 1 | loss: 0.4901399
	speed: 0.0036s/iter; left time: 12.9237s
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3958).  Saving model state dict ...
Epoch: 1 cost time: 2.1647236347198486
Epoch: 1, Steps: 514 | Train Loss: 0.4633857 Vali Loss: 0.3958317 Best vali loss: 0.3958317
	iters: 100, epoch: 2 | loss: 0.6081054
	speed: 0.0075s/iter; left time: 26.1326s
	iters: 200, epoch: 2 | loss: 0.4690093
	speed: 0.0035s/iter; left time: 11.8344s
	iters: 300, epoch: 2 | loss: 1.0069844
	speed: 0.0035s/iter; left time: 11.6359s
	iters: 400, epoch: 2 | loss: 0.6302144
	speed: 0.0035s/iter; left time: 11.2086s
	iters: 500, epoch: 2 | loss: 0.4029951
	speed: 0.0034s/iter; left time: 10.5017s
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 1.8309063911437988
Epoch: 2, Steps: 514 | Train Loss: 0.6234617 Vali Loss: 0.3976869 Best vali loss: 0.3958317
	iters: 100, epoch: 3 | loss: 0.4419059
	speed: 0.0075s/iter; left time: 22.4044s
	iters: 200, epoch: 3 | loss: 0.4579880
	speed: 0.0035s/iter; left time: 10.0951s
	iters: 300, epoch: 3 | loss: 0.6130062
	speed: 0.0033s/iter; left time: 9.2898s
	iters: 400, epoch: 3 | loss: 0.7719455
	speed: 0.0034s/iter; left time: 9.1618s
	iters: 500, epoch: 3 | loss: 0.3950599
	speed: 0.0033s/iter; left time: 8.5401s
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3958 --> 0.3902).  Saving model state dict ...
Epoch: 3 cost time: 1.8030259609222412
Epoch: 3, Steps: 514 | Train Loss: 0.5359811 Vali Loss: 0.3902345 Best vali loss: 0.3902345

best validation loss 0.39023447861137467

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022324943672, 'e_layers': 4, 'learning_rate': 0.0003936436305, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4146249
	speed: 0.0112s/iter; left time: 44.9428s
	iters: 200, epoch: 1 | loss: 0.3393654
	speed: 0.0052s/iter; left time: 20.4187s
	iters: 300, epoch: 1 | loss: 0.3676412
	speed: 0.0052s/iter; left time: 19.7446s
	iters: 400, epoch: 1 | loss: 0.3329250
	speed: 0.0051s/iter; left time: 18.8688s
	iters: 500, epoch: 1 | loss: 0.9152142
	speed: 0.0050s/iter; left time: 18.2026s
Updating learning rate to 0.0003936436305
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 2.9746546745300293
Epoch: 1, Steps: 514 | Train Loss: 0.4739541 Vali Loss: 0.3743878 Best vali loss: 0.3743878
	iters: 100, epoch: 2 | loss: 1.1553149
	speed: 0.0099s/iter; left time: 34.7613s
	iters: 200, epoch: 2 | loss: 0.9714634
	speed: 0.0048s/iter; left time: 16.4339s
	iters: 300, epoch: 2 | loss: 0.5794535
	speed: 0.0049s/iter; left time: 16.0982s
	iters: 400, epoch: 2 | loss: 0.4000957
	speed: 0.0049s/iter; left time: 15.5884s
	iters: 500, epoch: 2 | loss: 0.4595926
	speed: 0.0049s/iter; left time: 15.1698s
Updating learning rate to 0.00019682181525
Epoch: 2 cost time: 2.5564682483673096
Epoch: 2, Steps: 514 | Train Loss: 0.7131841 Vali Loss: 0.3854108 Best vali loss: 0.3743878
	iters: 100, epoch: 3 | loss: 0.3956360
	speed: 0.0097s/iter; left time: 28.8585s
	iters: 200, epoch: 3 | loss: 0.4904799
	speed: 0.0048s/iter; left time: 13.7993s
	iters: 300, epoch: 3 | loss: 0.7621385
	speed: 0.0049s/iter; left time: 13.7358s
	iters: 400, epoch: 3 | loss: 0.3672016
	speed: 0.0048s/iter; left time: 12.9774s
	iters: 500, epoch: 3 | loss: 0.9906445
	speed: 0.0047s/iter; left time: 12.1718s
Updating learning rate to 9.8410907625e-05
Validation loss decreased (0.3744 --> 0.3737).  Saving model state dict ...
Epoch: 3 cost time: 2.5048635005950928
Epoch: 3, Steps: 514 | Train Loss: 0.6012201 Vali Loss: 0.3737465 Best vali loss: 0.3737465

best validation loss 0.37374652916883905

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0009704034251, 'e_layers': 1, 'learning_rate': 0.0001542508167, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3257082
	speed: 0.0087s/iter; left time: 34.7553s
	iters: 200, epoch: 1 | loss: 0.6891313
	speed: 0.0023s/iter; left time: 8.9627s
	iters: 300, epoch: 1 | loss: 0.4059066
	speed: 0.0023s/iter; left time: 8.8503s
	iters: 400, epoch: 1 | loss: 0.3257843
	speed: 0.0022s/iter; left time: 8.3216s
	iters: 500, epoch: 1 | loss: 0.3733033
	speed: 0.0023s/iter; left time: 8.3309s
Updating learning rate to 0.0001542508167
Validation loss decreased (inf --> 0.3902).  Saving model state dict ...
Epoch: 1 cost time: 1.554107427597046
Epoch: 1, Steps: 514 | Train Loss: 0.4239667 Vali Loss: 0.3902143 Best vali loss: 0.3902143
	iters: 100, epoch: 2 | loss: 0.1994829
	speed: 0.0059s/iter; left time: 20.5575s
	iters: 200, epoch: 2 | loss: 0.8027593
	speed: 0.0026s/iter; left time: 8.7882s
	iters: 300, epoch: 2 | loss: 0.3885770
	speed: 0.0026s/iter; left time: 8.4821s
	iters: 400, epoch: 2 | loss: 1.0346113
	speed: 0.0025s/iter; left time: 7.8703s
	iters: 500, epoch: 2 | loss: 0.2544371
	speed: 0.0024s/iter; left time: 7.3775s
Updating learning rate to 7.712540835e-05
Validation loss decreased (0.3902 --> 0.3761).  Saving model state dict ...
Epoch: 2 cost time: 1.3340308666229248
Epoch: 2, Steps: 514 | Train Loss: 0.5359735 Vali Loss: 0.3761308 Best vali loss: 0.3761308
	iters: 100, epoch: 3 | loss: 0.5420104
	speed: 0.0055s/iter; left time: 16.3533s
	iters: 200, epoch: 3 | loss: 0.6323801
	speed: 0.0023s/iter; left time: 6.7343s
	iters: 300, epoch: 3 | loss: 0.7795275
	speed: 0.0024s/iter; left time: 6.5711s
	iters: 400, epoch: 3 | loss: 0.2454462
	speed: 0.0023s/iter; left time: 6.2994s
	iters: 500, epoch: 3 | loss: 0.5020871
	speed: 0.0024s/iter; left time: 6.2561s
Updating learning rate to 3.8562704175e-05
Validation loss decreased (0.3761 --> 0.3714).  Saving model state dict ...
Epoch: 3 cost time: 1.2476224899291992
Epoch: 3, Steps: 514 | Train Loss: 0.5402903 Vali Loss: 0.3713776 Best vali loss: 0.3713776

best validation loss 0.37137761809268494

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0009704034251, 'e_layers': 1, 'learning_rate': 0.0001542508167, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2634555
	speed: 0.0087s/iter; left time: 21.5136s
	iters: 200, epoch: 4 | loss: 0.6305847
	speed: 0.0024s/iter; left time: 5.7234s
	iters: 300, epoch: 4 | loss: 0.3751526
	speed: 0.0024s/iter; left time: 5.4497s
	iters: 400, epoch: 4 | loss: 0.2753576
	speed: 0.0024s/iter; left time: 5.2130s
	iters: 500, epoch: 4 | loss: 0.3386627
	speed: 0.0024s/iter; left time: 5.0020s
Updating learning rate to 1.92813520875e-05
Validation loss decreased (0.3714 --> 0.3695).  Saving model state dict ...
Epoch: 4 cost time: 1.5954208374023438
Epoch: 4, Steps: 514 | Train Loss: 0.3766426 Vali Loss: 0.3695228 Best vali loss: 0.3695228
	iters: 100, epoch: 5 | loss: 0.1832720
	speed: 0.0058s/iter; left time: 11.3860s
	iters: 200, epoch: 5 | loss: 0.7919899
	speed: 0.0024s/iter; left time: 4.3659s
	iters: 300, epoch: 5 | loss: 0.3725248
	speed: 0.0023s/iter; left time: 4.1194s
	iters: 400, epoch: 5 | loss: 0.9511631
	speed: 0.0023s/iter; left time: 3.7820s
	iters: 500, epoch: 5 | loss: 0.2467919
	speed: 0.0023s/iter; left time: 3.5285s
Updating learning rate to 9.64067604375e-06
Validation loss decreased (0.3695 --> 0.3690).  Saving model state dict ...
Epoch: 5 cost time: 1.234633207321167
Epoch: 5, Steps: 514 | Train Loss: 0.5091483 Vali Loss: 0.3689931 Best vali loss: 0.3689931
	iters: 100, epoch: 6 | loss: 0.5319791
	speed: 0.0056s/iter; left time: 8.1137s
	iters: 200, epoch: 6 | loss: 0.6282282
	speed: 0.0023s/iter; left time: 3.1088s
	iters: 300, epoch: 6 | loss: 0.7699609
	speed: 0.0023s/iter; left time: 2.8623s
	iters: 400, epoch: 6 | loss: 0.2439178
	speed: 0.0023s/iter; left time: 2.5940s
	iters: 500, epoch: 6 | loss: 0.4962918
	speed: 0.0022s/iter; left time: 2.3383s
Updating learning rate to 4.820338021875e-06
Validation loss decreased (0.3690 --> 0.3687).  Saving model state dict ...
Epoch: 6 cost time: 1.2226388454437256
Epoch: 6, Steps: 514 | Train Loss: 0.5340756 Vali Loss: 0.3686520 Best vali loss: 0.3686520
	iters: 100, epoch: 7 | loss: 0.7839111
	speed: 0.0057s/iter; left time: 5.3140s
	iters: 200, epoch: 7 | loss: 0.3493848
	speed: 0.0024s/iter; left time: 1.9981s
	iters: 300, epoch: 7 | loss: 0.5139714
	speed: 0.0024s/iter; left time: 1.7460s
	iters: 400, epoch: 7 | loss: 0.7720535
	speed: 0.0023s/iter; left time: 1.4555s
	iters: 500, epoch: 7 | loss: 0.3416660
	speed: 0.0023s/iter; left time: 1.2079s
Updating learning rate to 2.4101690109375e-06
Validation loss decreased (0.3687 --> 0.3685).  Saving model state dict ...
Epoch: 7 cost time: 1.2518141269683838
Epoch: 7, Steps: 514 | Train Loss: 0.5521974 Vali Loss: 0.3685266 Best vali loss: 0.3685266
	iters: 100, epoch: 8 | loss: 0.5479017
	speed: 0.0055s/iter; left time: 2.2790s
	iters: 200, epoch: 8 | loss: 0.5518759
	speed: 0.0023s/iter; left time: 0.7149s
	iters: 300, epoch: 8 | loss: 0.5295851
	speed: 0.0022s/iter; left time: 0.4666s
	iters: 400, epoch: 8 | loss: 1.2869529
	speed: 0.0022s/iter; left time: 0.2488s
	iters: 500, epoch: 8 | loss: 0.7201557
	speed: 0.0022s/iter; left time: 0.0328s
Updating learning rate to 1.20508450546875e-06
Validation loss decreased (0.3685 --> 0.3684).  Saving model state dict ...
Epoch: 8 cost time: 1.1737072467803955
Epoch: 8, Steps: 514 | Train Loss: 0.7272943 Vali Loss: 0.3684434 Best vali loss: 0.3684434

best validation loss 0.3684433837653612

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009514991395, 'e_layers': 4, 'learning_rate': 0.0003566016144, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4650507
	speed: 0.0112s/iter; left time: 44.9703s
	iters: 200, epoch: 1 | loss: 0.6472623
	speed: 0.0051s/iter; left time: 19.9880s
	iters: 300, epoch: 1 | loss: 1.2326823
	speed: 0.0052s/iter; left time: 19.6843s
	iters: 400, epoch: 1 | loss: 0.7535250
	speed: 0.0051s/iter; left time: 18.7860s
	iters: 500, epoch: 1 | loss: 0.8569500
	speed: 0.0052s/iter; left time: 18.6195s
Updating learning rate to 0.0003430292736023211
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 2.9821746349334717
Epoch: 1, Steps: 514 | Train Loss: 0.7910940 Vali Loss: 0.3721795 Best vali loss: 0.3721795
	iters: 100, epoch: 2 | loss: 0.7588918
	speed: 0.0102s/iter; left time: 35.8046s
	iters: 200, epoch: 2 | loss: 0.5692654
	speed: 0.0049s/iter; left time: 16.7474s
	iters: 300, epoch: 2 | loss: 0.6299346
	speed: 0.0049s/iter; left time: 16.3120s
	iters: 400, epoch: 2 | loss: 0.8360134
	speed: 0.0049s/iter; left time: 15.8007s
	iters: 500, epoch: 2 | loss: 0.4065883
	speed: 0.0049s/iter; left time: 15.1882s
Updating learning rate to 0.0003043785170621552
Validation loss decreased (0.3722 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 2.585344076156616
Epoch: 2, Steps: 514 | Train Loss: 0.6401387 Vali Loss: 0.3642893 Best vali loss: 0.3642893
	iters: 100, epoch: 3 | loss: 0.4965573
	speed: 0.0101s/iter; left time: 30.0108s
	iters: 200, epoch: 3 | loss: 0.8368346
	speed: 0.0044s/iter; left time: 12.8178s
	iters: 300, epoch: 3 | loss: 0.8346003
	speed: 0.0044s/iter; left time: 12.1975s
	iters: 400, epoch: 3 | loss: 1.1004951
	speed: 0.0045s/iter; left time: 12.0044s
	iters: 500, epoch: 3 | loss: 0.6806838
	speed: 0.0053s/iter; left time: 13.7135s
Updating learning rate to 0.0002465335720927621
Epoch: 3 cost time: 2.462090492248535
Epoch: 3, Steps: 514 | Train Loss: 0.7898342 Vali Loss: 0.3731800 Best vali loss: 0.3642893
	iters: 100, epoch: 4 | loss: 0.2688724
	speed: 0.0101s/iter; left time: 24.9768s
	iters: 200, epoch: 4 | loss: 0.5436800
	speed: 0.0053s/iter; left time: 12.4598s
	iters: 300, epoch: 4 | loss: 0.6307764
	speed: 0.0052s/iter; left time: 11.8079s
	iters: 400, epoch: 4 | loss: 0.3299733
	speed: 0.0051s/iter; left time: 11.1386s
	iters: 500, epoch: 4 | loss: 0.4524366
	speed: 0.0051s/iter; left time: 10.4883s
Updating learning rate to 0.0001783008072
Epoch: 4 cost time: 2.6994516849517822
Epoch: 4, Steps: 514 | Train Loss: 0.4451477 Vali Loss: 0.3752924 Best vali loss: 0.3642893
	iters: 100, epoch: 5 | loss: 0.6890497
	speed: 0.0095s/iter; left time: 18.5867s
	iters: 200, epoch: 5 | loss: 0.6316464
	speed: 0.0047s/iter; left time: 8.7179s
	iters: 300, epoch: 5 | loss: 0.2685642
	speed: 0.0045s/iter; left time: 7.9661s
	iters: 400, epoch: 5 | loss: 0.3761127
	speed: 0.0048s/iter; left time: 8.0171s
	iters: 500, epoch: 5 | loss: 0.3074159
	speed: 0.0049s/iter; left time: 7.6011s
Updating learning rate to 0.0001100680423072379
Epoch: 5 cost time: 2.4676530361175537
Epoch: 5, Steps: 514 | Train Loss: 0.4545578 Vali Loss: 0.3728770 Best vali loss: 0.3642893
	iters: 100, epoch: 6 | loss: 0.2444079
	speed: 0.0101s/iter; left time: 14.6423s
	iters: 200, epoch: 6 | loss: 0.2431231
	speed: 0.0051s/iter; left time: 6.8521s
	iters: 300, epoch: 6 | loss: 0.4808178
	speed: 0.0051s/iter; left time: 6.3399s
	iters: 400, epoch: 6 | loss: 0.7421833
	speed: 0.0051s/iter; left time: 5.7807s
	iters: 500, epoch: 6 | loss: 0.4678087
	speed: 0.0051s/iter; left time: 5.3624s
Updating learning rate to 5.2223097337844813e-05
Epoch: 6 cost time: 2.67206072807312
Epoch: 6, Steps: 514 | Train Loss: 0.4356682 Vali Loss: 0.3695535 Best vali loss: 0.3642893
	iters: 100, epoch: 7 | loss: 0.2866740
	speed: 0.0098s/iter; left time: 9.1011s
	iters: 200, epoch: 7 | loss: 0.2888541
	speed: 0.0050s/iter; left time: 4.1276s
	iters: 300, epoch: 7 | loss: 0.6235238
	speed: 0.0049s/iter; left time: 3.6067s
	iters: 400, epoch: 7 | loss: 0.4729583
	speed: 0.0049s/iter; left time: 3.1085s
	iters: 500, epoch: 7 | loss: 0.2127164
	speed: 0.0050s/iter; left time: 2.6299s
Updating learning rate to 1.3572340797678933e-05
Epoch: 7 cost time: 2.6103103160858154
Epoch: 7, Steps: 514 | Train Loss: 0.3769453 Vali Loss: 0.3726814 Best vali loss: 0.3642893
	iters: 100, epoch: 8 | loss: 0.2772256
	speed: 0.0100s/iter; left time: 4.1527s
	iters: 200, epoch: 8 | loss: 0.1925965
	speed: 0.0049s/iter; left time: 1.5283s
	iters: 300, epoch: 8 | loss: 0.6095710
	speed: 0.0049s/iter; left time: 1.0627s
	iters: 400, epoch: 8 | loss: 0.5317366
	speed: 0.0049s/iter; left time: 0.5667s
	iters: 500, epoch: 8 | loss: 0.2088272
	speed: 0.0049s/iter; left time: 0.0740s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.575805425643921
Epoch: 8, Steps: 514 | Train Loss: 0.3639914 Vali Loss: 0.3809936 Best vali loss: 0.3642893

best validation loss 0.36428932152937343

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0020410149084, 'e_layers': 4, 'learning_rate': 0.0004183436531, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4451573
	speed: 0.0115s/iter; left time: 22.5682s
	iters: 200, epoch: 1 | loss: 0.4226169
	speed: 0.0054s/iter; left time: 10.1168s
Updating learning rate to 0.0004183436531
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 1.7454321384429932
Epoch: 1, Steps: 257 | Train Loss: 0.4338871 Vali Loss: 0.3776457 Best vali loss: 0.3776457
	iters: 100, epoch: 2 | loss: 0.8181156
	speed: 0.0110s/iter; left time: 18.6418s
	iters: 200, epoch: 2 | loss: 0.4527921
	speed: 0.0052s/iter; left time: 8.2620s
Updating learning rate to 0.00020917182655
Validation loss decreased (0.3776 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 1.3735723495483398
Epoch: 2, Steps: 257 | Train Loss: 0.6354539 Vali Loss: 0.3702927 Best vali loss: 0.3702927
	iters: 100, epoch: 3 | loss: 0.4672785
	speed: 0.0109s/iter; left time: 15.7570s
	iters: 200, epoch: 3 | loss: 0.4964476
	speed: 0.0050s/iter; left time: 6.7327s
Updating learning rate to 0.000104585913275
Validation loss decreased (0.3703 --> 0.3504).  Saving model state dict ...
Epoch: 3 cost time: 1.3238632678985596
Epoch: 3, Steps: 257 | Train Loss: 0.4818630 Vali Loss: 0.3503866 Best vali loss: 0.3503866
	iters: 100, epoch: 4 | loss: 0.6658375
	speed: 0.0106s/iter; left time: 12.5894s
	iters: 200, epoch: 4 | loss: 0.2238844
	speed: 0.0048s/iter; left time: 5.2018s
Updating learning rate to 5.22929566375e-05
Epoch: 4 cost time: 1.2868833541870117
Epoch: 4, Steps: 257 | Train Loss: 0.4448609 Vali Loss: 0.3564627 Best vali loss: 0.3503866
	iters: 100, epoch: 5 | loss: 0.6332788
	speed: 0.0105s/iter; left time: 9.7296s
	iters: 200, epoch: 5 | loss: 0.6169857
	speed: 0.0049s/iter; left time: 4.0432s
Updating learning rate to 2.614647831875e-05
Epoch: 5 cost time: 1.3240525722503662
Epoch: 5, Steps: 257 | Train Loss: 0.6251322 Vali Loss: 0.3518029 Best vali loss: 0.3503866
	iters: 100, epoch: 6 | loss: 0.4818265
	speed: 0.0109s/iter; left time: 7.3274s
	iters: 200, epoch: 6 | loss: 0.5347460
	speed: 0.0049s/iter; left time: 2.8039s
Updating learning rate to 1.3073239159375e-05
Validation loss decreased (0.3504 --> 0.3474).  Saving model state dict ...
Epoch: 6 cost time: 1.34214186668396
Epoch: 6, Steps: 257 | Train Loss: 0.5082862 Vali Loss: 0.3473905 Best vali loss: 0.3473905
	iters: 100, epoch: 7 | loss: 0.3969030
	speed: 0.0112s/iter; left time: 4.6592s
	iters: 200, epoch: 7 | loss: 0.4871714
	speed: 0.0055s/iter; left time: 1.7348s
Updating learning rate to 6.5366195796875e-06
Epoch: 7 cost time: 1.4675712585449219
Epoch: 7, Steps: 257 | Train Loss: 0.4420372 Vali Loss: 0.3522638 Best vali loss: 0.3473905
	iters: 100, epoch: 8 | loss: 0.4032744
	speed: 0.0113s/iter; left time: 1.7827s
	iters: 200, epoch: 8 | loss: 0.4604667
	speed: 0.0053s/iter; left time: 0.3070s
Updating learning rate to 3.26830978984375e-06
Epoch: 8 cost time: 1.4112327098846436
Epoch: 8, Steps: 257 | Train Loss: 0.4318705 Vali Loss: 0.3495284 Best vali loss: 0.3473905

best validation loss 0.3473905105253568

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0041114725425, 'e_layers': 2, 'learning_rate': 6.6225884e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3569361
	speed: 0.0092s/iter; left time: 74.3807s
	iters: 200, epoch: 1 | loss: 0.6547987
	speed: 0.0032s/iter; left time: 25.7641s
	iters: 300, epoch: 1 | loss: 0.4443301
	speed: 0.0033s/iter; left time: 26.0722s
	iters: 400, epoch: 1 | loss: 0.5702460
	speed: 0.0033s/iter; left time: 25.9327s
	iters: 500, epoch: 1 | loss: 0.2988880
	speed: 0.0033s/iter; left time: 25.4650s
	iters: 600, epoch: 1 | loss: 1.1871059
	speed: 0.0033s/iter; left time: 24.9376s
	iters: 700, epoch: 1 | loss: 0.4650970
	speed: 0.0033s/iter; left time: 25.0485s
	iters: 800, epoch: 1 | loss: 0.9991293
	speed: 0.0034s/iter; left time: 24.9216s
	iters: 900, epoch: 1 | loss: 0.4285557
	speed: 0.0033s/iter; left time: 24.4725s
	iters: 1000, epoch: 1 | loss: 0.5373189
	speed: 0.0033s/iter; left time: 24.0364s
Updating learning rate to 6.370531137503336e-05
Validation loss decreased (inf --> 0.3827).  Saving model state dict ...
Epoch: 1 cost time: 3.7180728912353516
Epoch: 1, Steps: 1027 | Train Loss: 0.5942406 Vali Loss: 0.3827094 Best vali loss: 0.3827094
	iters: 100, epoch: 2 | loss: 0.9557360
	speed: 0.0097s/iter; left time: 68.5058s
	iters: 200, epoch: 2 | loss: 0.8312019
	speed: 0.0034s/iter; left time: 23.5735s
	iters: 300, epoch: 2 | loss: 0.9404578
	speed: 0.0030s/iter; left time: 20.9711s
	iters: 400, epoch: 2 | loss: 0.5110620
	speed: 0.0031s/iter; left time: 21.0397s
	iters: 500, epoch: 2 | loss: 1.4500358
	speed: 0.0030s/iter; left time: 20.3498s
	iters: 600, epoch: 2 | loss: 0.2475538
	speed: 0.0029s/iter; left time: 19.2785s
	iters: 700, epoch: 2 | loss: 0.7817638
	speed: 0.0028s/iter; left time: 18.4292s
	iters: 800, epoch: 2 | loss: 0.3661283
	speed: 0.0029s/iter; left time: 18.2712s
	iters: 900, epoch: 2 | loss: 1.1760175
	speed: 0.0030s/iter; left time: 18.9794s
	iters: 1000, epoch: 2 | loss: 1.5181359
	speed: 0.0031s/iter; left time: 18.9066s
Updating learning rate to 5.652732783323684e-05
Validation loss decreased (0.3827 --> 0.3698).  Saving model state dict ...
Epoch: 2 cost time: 3.1782150268554688
Epoch: 2, Steps: 1027 | Train Loss: 0.8778093 Vali Loss: 0.3698273 Best vali loss: 0.3698273
	iters: 100, epoch: 3 | loss: 1.0371523
	speed: 0.0088s/iter; left time: 53.4464s
	iters: 200, epoch: 3 | loss: 0.4528954
	speed: 0.0030s/iter; left time: 17.9049s
	iters: 300, epoch: 3 | loss: 0.4182270
	speed: 0.0030s/iter; left time: 17.6447s
	iters: 400, epoch: 3 | loss: 0.9792272
	speed: 0.0030s/iter; left time: 17.1108s
	iters: 500, epoch: 3 | loss: 0.2884805
	speed: 0.0030s/iter; left time: 17.0302s
	iters: 600, epoch: 3 | loss: 0.3021117
	speed: 0.0029s/iter; left time: 16.3693s
	iters: 700, epoch: 3 | loss: 0.3724282
	speed: 0.0030s/iter; left time: 16.5080s
	iters: 800, epoch: 3 | loss: 0.3432867
	speed: 0.0030s/iter; left time: 16.3366s
	iters: 900, epoch: 3 | loss: 0.2431424
	speed: 0.0028s/iter; left time: 14.8185s
	iters: 1000, epoch: 3 | loss: 1.0321460
	speed: 0.0028s/iter; left time: 14.5881s
Updating learning rate to 4.5784716300266145e-05
Validation loss decreased (0.3698 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 3.071110725402832
Epoch: 3, Steps: 1027 | Train Loss: 0.5469097 Vali Loss: 0.3662489 Best vali loss: 0.3662489

best validation loss 0.36624885371251287

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0078901715202, 'e_layers': 4, 'learning_rate': 0.0004217146017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6183708
	speed: 0.0120s/iter; left time: 11.1939s
Updating learning rate to 0.0004217146017
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.088944673538208
Epoch: 1, Steps: 129 | Train Loss: 0.6183708 Vali Loss: 0.3669198 Best vali loss: 0.3669198
	iters: 100, epoch: 2 | loss: 0.4670950
	speed: 0.0089s/iter; left time: 7.1417s
Updating learning rate to 0.00021085730085
Epoch: 2 cost time: 0.7107548713684082
Epoch: 2, Steps: 129 | Train Loss: 0.4670950 Vali Loss: 0.3712372 Best vali loss: 0.3669198
	iters: 100, epoch: 3 | loss: 0.5640292
	speed: 0.0093s/iter; left time: 6.2839s
Updating learning rate to 0.000105428650425
Validation loss decreased (0.3669 --> 0.3606).  Saving model state dict ...
Epoch: 3 cost time: 0.7934751510620117
Epoch: 3, Steps: 129 | Train Loss: 0.5640292 Vali Loss: 0.3605770 Best vali loss: 0.3605770

best validation loss 0.3605770133567465

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0107448189194, 'e_layers': 4, 'learning_rate': 0.0003036392569, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00029208267580842326
Validation loss decreased (inf --> 0.4111).  Saving model state dict ...
Epoch: 1 cost time: 0.7610702514648438
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4110832 Best vali loss: 0.4110832
Updating learning rate to 0.00025917231724421707
Validation loss decreased (0.4111 --> 0.3905).  Saving model state dict ...
Epoch: 2 cost time: 0.46424293518066406
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3905143 Best vali loss: 0.3905143
Updating learning rate to 0.00020991848496563863
Validation loss decreased (0.3905 --> 0.3819).  Saving model state dict ...
Epoch: 3 cost time: 0.4566810131072998
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3818888 Best vali loss: 0.3818888

best validation loss 0.38188879947765403

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0078901715202, 'e_layers': 4, 'learning_rate': 0.0004217146017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5049517
	speed: 0.0123s/iter; left time: 6.7001s
Updating learning rate to 5.27143252125e-05
Epoch: 4 cost time: 1.1014204025268555
Epoch: 4, Steps: 129 | Train Loss: 0.5049517 Vali Loss: 0.3682543 Best vali loss: 0.3605770
	iters: 100, epoch: 5 | loss: 0.3944139
	speed: 0.0096s/iter; left time: 4.0224s
Updating learning rate to 2.635716260625e-05
Epoch: 5 cost time: 0.8098342418670654
Epoch: 5, Steps: 129 | Train Loss: 0.3944139 Vali Loss: 0.3631029 Best vali loss: 0.3605770
	iters: 100, epoch: 6 | loss: 0.5062199
	speed: 0.0092s/iter; left time: 2.6502s
Updating learning rate to 1.3178581303125e-05
Validation loss decreased (0.3606 --> 0.3597).  Saving model state dict ...
Epoch: 6 cost time: 0.7579848766326904
Epoch: 6, Steps: 129 | Train Loss: 0.5062199 Vali Loss: 0.3596932 Best vali loss: 0.3596932
	iters: 100, epoch: 7 | loss: 0.5265535
	speed: 0.0094s/iter; left time: 1.4884s
Updating learning rate to 6.5892906515625e-06
Validation loss decreased (0.3597 --> 0.3588).  Saving model state dict ...
Epoch: 7 cost time: 0.7549591064453125
Epoch: 7, Steps: 129 | Train Loss: 0.5265535 Vali Loss: 0.3588338 Best vali loss: 0.3588338
	iters: 100, epoch: 8 | loss: 0.4202200
	speed: 0.0093s/iter; left time: 0.2794s
Updating learning rate to 3.29464532578125e-06
Epoch: 8 cost time: 0.7722272872924805
Epoch: 8, Steps: 129 | Train Loss: 0.4202200 Vali Loss: 0.3650821 Best vali loss: 0.3588338

best validation loss 0.3588337608896679

[INFO][smbo.py:320] Finished 1150 trials.
{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0009216145743, 'e_layers': 3, 'learning_rate': 0.0004076514327, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7507313
	speed: 0.0100s/iter; left time: 19.5271s
	iters: 200, epoch: 1 | loss: 0.4365907
	speed: 0.0044s/iter; left time: 8.1915s
Updating learning rate to 0.0004076514327
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 1.4880118370056152
Epoch: 1, Steps: 257 | Train Loss: 0.5936610 Vali Loss: 0.3674812 Best vali loss: 0.3674812
	iters: 100, epoch: 2 | loss: 0.6702904
	speed: 0.0094s/iter; left time: 15.9320s
	iters: 200, epoch: 2 | loss: 0.5662453
	speed: 0.0041s/iter; left time: 6.5774s
Updating learning rate to 0.00020382571635
Epoch: 2 cost time: 1.1245019435882568
Epoch: 2, Steps: 257 | Train Loss: 0.6182678 Vali Loss: 0.3838224 Best vali loss: 0.3674812
	iters: 100, epoch: 3 | loss: 0.7821205
	speed: 0.0092s/iter; left time: 13.2199s
	iters: 200, epoch: 3 | loss: 0.6242645
	speed: 0.0043s/iter; left time: 5.8293s
Updating learning rate to 0.000101912858175
Validation loss decreased (0.3675 --> 0.3557).  Saving model state dict ...
Epoch: 3 cost time: 1.1594352722167969
Epoch: 3, Steps: 257 | Train Loss: 0.7031925 Vali Loss: 0.3557022 Best vali loss: 0.3557022
	iters: 100, epoch: 4 | loss: 0.5993534
	speed: 0.0095s/iter; left time: 11.2688s
	iters: 200, epoch: 4 | loss: 0.3812670
	speed: 0.0043s/iter; left time: 4.6770s
Updating learning rate to 5.09564290875e-05
Epoch: 4 cost time: 1.1511824131011963
Epoch: 4, Steps: 257 | Train Loss: 0.4903102 Vali Loss: 0.3590731 Best vali loss: 0.3557022
	iters: 100, epoch: 5 | loss: 0.4120427
	speed: 0.0095s/iter; left time: 8.8642s
	iters: 200, epoch: 5 | loss: 0.8887166
	speed: 0.0045s/iter; left time: 3.7617s
Updating learning rate to 2.547821454375e-05
Epoch: 5 cost time: 1.1984202861785889
Epoch: 5, Steps: 257 | Train Loss: 0.6503796 Vali Loss: 0.3563172 Best vali loss: 0.3557022
	iters: 100, epoch: 6 | loss: 0.5784531
	speed: 0.0097s/iter; left time: 6.5411s
	iters: 200, epoch: 6 | loss: 0.9585731
	speed: 0.0046s/iter; left time: 2.6358s
Updating learning rate to 1.2739107271875e-05
Validation loss decreased (0.3557 --> 0.3538).  Saving model state dict ...
Epoch: 6 cost time: 1.213778018951416
Epoch: 6, Steps: 257 | Train Loss: 0.7685131 Vali Loss: 0.3538023 Best vali loss: 0.3538023
	iters: 100, epoch: 7 | loss: 0.5860292
	speed: 0.0097s/iter; left time: 4.0307s
	iters: 200, epoch: 7 | loss: 0.5196996
	speed: 0.0045s/iter; left time: 1.4095s
Updating learning rate to 6.3695536359375e-06
Validation loss decreased (0.3538 --> 0.3538).  Saving model state dict ...
Epoch: 7 cost time: 1.2082080841064453
Epoch: 7, Steps: 257 | Train Loss: 0.5528644 Vali Loss: 0.3537734 Best vali loss: 0.3537734
	iters: 100, epoch: 8 | loss: 0.5677761
	speed: 0.0096s/iter; left time: 1.5170s
	iters: 200, epoch: 8 | loss: 0.7363359
	speed: 0.0041s/iter; left time: 0.2386s
Updating learning rate to 3.18477681796875e-06
Validation loss decreased (0.3538 --> 0.3528).  Saving model state dict ...
Epoch: 8 cost time: 1.1060082912445068
Epoch: 8, Steps: 257 | Train Loss: 0.6520560 Vali Loss: 0.3528484 Best vali loss: 0.3528484

best validation loss 0.352848361365219

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022205518906, 'e_layers': 2, 'learning_rate': 0.0003985889749, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4269054
	speed: 0.0092s/iter; left time: 36.8713s
	iters: 200, epoch: 1 | loss: 1.0782194
	speed: 0.0036s/iter; left time: 14.2399s
	iters: 300, epoch: 1 | loss: 1.0144759
	speed: 0.0036s/iter; left time: 13.8052s
	iters: 400, epoch: 1 | loss: 0.5036719
	speed: 0.0036s/iter; left time: 13.4452s
	iters: 500, epoch: 1 | loss: 1.1281885
	speed: 0.0037s/iter; left time: 13.2017s
Updating learning rate to 0.0003834185853473825
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 2.222933530807495
Epoch: 1, Steps: 514 | Train Loss: 0.8302922 Vali Loss: 0.3725175 Best vali loss: 0.3725175
	iters: 100, epoch: 2 | loss: 0.3944454
	speed: 0.0075s/iter; left time: 26.3757s
	iters: 200, epoch: 2 | loss: 0.2960981
	speed: 0.0034s/iter; left time: 11.3869s
	iters: 300, epoch: 2 | loss: 0.4126469
	speed: 0.0035s/iter; left time: 11.4163s
	iters: 400, epoch: 2 | loss: 0.3929693
	speed: 0.0033s/iter; left time: 10.6585s
	iters: 500, epoch: 2 | loss: 0.6412904
	speed: 0.0034s/iter; left time: 10.6319s
Updating learning rate to 0.00034021697097899226
Validation loss decreased (0.3725 --> 0.3501).  Saving model state dict ...
Epoch: 2 cost time: 1.7806265354156494
Epoch: 2, Steps: 514 | Train Loss: 0.4274900 Vali Loss: 0.3501274 Best vali loss: 0.3501274
	iters: 100, epoch: 3 | loss: 0.3385543
	speed: 0.0072s/iter; left time: 21.5755s
	iters: 200, epoch: 3 | loss: 0.8799257
	speed: 0.0031s/iter; left time: 8.9785s
	iters: 300, epoch: 3 | loss: 0.4843631
	speed: 0.0033s/iter; left time: 9.0644s
	iters: 400, epoch: 3 | loss: 0.4713611
	speed: 0.0032s/iter; left time: 8.7213s
	iters: 500, epoch: 3 | loss: 1.0502123
	speed: 0.0033s/iter; left time: 8.5377s
Updating learning rate to 0.0002755611859588073
Validation loss decreased (0.3501 --> 0.3443).  Saving model state dict ...
Epoch: 3 cost time: 1.6957588195800781
Epoch: 3, Steps: 514 | Train Loss: 0.6448833 Vali Loss: 0.3442726 Best vali loss: 0.3442726
	iters: 100, epoch: 4 | loss: 0.5557744
	speed: 0.0075s/iter; left time: 18.5300s
	iters: 200, epoch: 4 | loss: 0.4356578
	speed: 0.0035s/iter; left time: 8.2251s
	iters: 300, epoch: 4 | loss: 0.4479989
	speed: 0.0034s/iter; left time: 7.8032s
	iters: 400, epoch: 4 | loss: 0.6886477
	speed: 0.0035s/iter; left time: 7.6170s
	iters: 500, epoch: 4 | loss: 0.6838598
	speed: 0.0035s/iter; left time: 7.2673s
Updating learning rate to 0.00019929448745
Validation loss decreased (0.3443 --> 0.3409).  Saving model state dict ...
Epoch: 4 cost time: 1.8332836627960205
Epoch: 4, Steps: 514 | Train Loss: 0.5623877 Vali Loss: 0.3408758 Best vali loss: 0.3408758
	iters: 100, epoch: 5 | loss: 0.5213367
	speed: 0.0076s/iter; left time: 14.9691s
	iters: 200, epoch: 5 | loss: 0.6940124
	speed: 0.0035s/iter; left time: 6.5007s
	iters: 300, epoch: 5 | loss: 0.4599485
	speed: 0.0034s/iter; left time: 5.9798s
	iters: 400, epoch: 5 | loss: 0.7353107
	speed: 0.0034s/iter; left time: 5.6186s
	iters: 500, epoch: 5 | loss: 0.5018654
	speed: 0.0033s/iter; left time: 5.1922s
Updating learning rate to 0.0001230277889411927
Epoch: 5 cost time: 1.8050391674041748
Epoch: 5, Steps: 514 | Train Loss: 0.5824947 Vali Loss: 0.3457889 Best vali loss: 0.3408758
	iters: 100, epoch: 6 | loss: 0.2922938
	speed: 0.0070s/iter; left time: 10.1334s
	iters: 200, epoch: 6 | loss: 0.4573894
	speed: 0.0035s/iter; left time: 4.6743s
	iters: 300, epoch: 6 | loss: 0.3301353
	speed: 0.0033s/iter; left time: 4.1092s
	iters: 400, epoch: 6 | loss: 0.7322995
	speed: 0.0033s/iter; left time: 3.7808s
	iters: 500, epoch: 6 | loss: 0.8643334
	speed: 0.0033s/iter; left time: 3.3968s
Updating learning rate to 5.837200392100772e-05
Epoch: 6 cost time: 1.7607970237731934
Epoch: 6, Steps: 514 | Train Loss: 0.5352903 Vali Loss: 0.3746345 Best vali loss: 0.3408758
	iters: 100, epoch: 7 | loss: 0.3680377
	speed: 0.0072s/iter; left time: 6.6543s
	iters: 200, epoch: 7 | loss: 0.2781126
	speed: 0.0033s/iter; left time: 2.7180s
	iters: 300, epoch: 7 | loss: 0.3222974
	speed: 0.0033s/iter; left time: 2.4212s
	iters: 400, epoch: 7 | loss: 0.3402422
	speed: 0.0033s/iter; left time: 2.1052s
	iters: 500, epoch: 7 | loss: 0.6975686
	speed: 0.0033s/iter; left time: 1.7472s
Updating learning rate to 1.5170389552617498e-05
Epoch: 7 cost time: 1.7493703365325928
Epoch: 7, Steps: 514 | Train Loss: 0.4012517 Vali Loss: 0.3519891 Best vali loss: 0.3408758
	iters: 100, epoch: 8 | loss: 0.3243860
	speed: 0.0069s/iter; left time: 2.8804s
	iters: 200, epoch: 8 | loss: 0.2005602
	speed: 0.0031s/iter; left time: 0.9816s
	iters: 300, epoch: 8 | loss: 0.3061582
	speed: 0.0032s/iter; left time: 0.6957s
	iters: 400, epoch: 8 | loss: 0.4046324
	speed: 0.0032s/iter; left time: 0.3671s
	iters: 500, epoch: 8 | loss: 0.1974883
	speed: 0.0032s/iter; left time: 0.0481s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6729354858398438
Epoch: 8, Steps: 514 | Train Loss: 0.2866450 Vali Loss: 0.3631723 Best vali loss: 0.3408758

best validation loss 0.34087583133420213

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010524457769, 'e_layers': 2, 'learning_rate': 0.000382384526, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4264416
	speed: 0.0096s/iter; left time: 38.5126s
	iters: 200, epoch: 1 | loss: 1.0776941
	speed: 0.0033s/iter; left time: 13.0404s
	iters: 300, epoch: 1 | loss: 1.0149857
	speed: 0.0033s/iter; left time: 12.6789s
	iters: 400, epoch: 1 | loss: 0.5032560
	speed: 0.0033s/iter; left time: 12.4112s
	iters: 500, epoch: 1 | loss: 1.1355655
	speed: 0.0033s/iter; left time: 12.0621s
Updating learning rate to 0.000367830881560215
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 2.0688371658325195
Epoch: 1, Steps: 514 | Train Loss: 0.8315886 Vali Loss: 0.3736998 Best vali loss: 0.3736998
	iters: 100, epoch: 2 | loss: 0.3901396
	speed: 0.0074s/iter; left time: 25.9271s
	iters: 200, epoch: 2 | loss: 0.2591259
	speed: 0.0035s/iter; left time: 11.9973s
	iters: 300, epoch: 2 | loss: 0.5055819
	speed: 0.0035s/iter; left time: 11.5617s
	iters: 400, epoch: 2 | loss: 0.4024482
	speed: 0.0035s/iter; left time: 11.0563s
	iters: 500, epoch: 2 | loss: 0.6221040
	speed: 0.0034s/iter; left time: 10.5612s
Updating learning rate to 0.00032638560867770183
Validation loss decreased (0.3737 --> 0.3682).  Saving model state dict ...
Epoch: 2 cost time: 1.839237928390503
Epoch: 2, Steps: 514 | Train Loss: 0.4358799 Vali Loss: 0.3681572 Best vali loss: 0.3681572
	iters: 100, epoch: 3 | loss: 0.3745741
	speed: 0.0075s/iter; left time: 22.3344s
	iters: 200, epoch: 3 | loss: 0.8216342
	speed: 0.0035s/iter; left time: 9.9935s
	iters: 300, epoch: 3 | loss: 0.5025168
	speed: 0.0034s/iter; left time: 9.3864s
	iters: 400, epoch: 3 | loss: 0.4952551
	speed: 0.0033s/iter; left time: 8.8982s
	iters: 500, epoch: 3 | loss: 1.1346086
	speed: 0.0033s/iter; left time: 8.5420s
Updating learning rate to 0.00026435837444648897
Epoch: 3 cost time: 1.7920069694519043
Epoch: 3, Steps: 514 | Train Loss: 0.6657178 Vali Loss: 0.3728323 Best vali loss: 0.3681572

best validation loss 0.36815721109831495

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0010161439773, 'e_layers': 1, 'learning_rate': 0.0002611181016, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00025117988561822137
Validation loss decreased (inf --> 0.3641).  Saving model state dict ...
Epoch: 1 cost time: 0.6211459636688232
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3640992 Best vali loss: 0.3640992
Updating learning rate to 0.00022287824096595894
Validation loss decreased (0.3641 --> 0.3616).  Saving model state dict ...
Epoch: 2 cost time: 0.32577991485595703
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3616148 Best vali loss: 0.3616148
Updating learning rate to 0.00018052183648647213
Epoch: 3 cost time: 0.32718777656555176
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3687610 Best vali loss: 0.3616148

best validation loss 0.36161475863110104

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001054333677, 'e_layers': 2, 'learning_rate': 0.0003818221205, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7287626
	speed: 0.0092s/iter; left time: 37.1135s
	iters: 200, epoch: 1 | loss: 0.6188940
	speed: 0.0034s/iter; left time: 13.4177s
	iters: 300, epoch: 1 | loss: 0.4093454
	speed: 0.0033s/iter; left time: 12.7106s
	iters: 400, epoch: 1 | loss: 0.5228152
	speed: 0.0035s/iter; left time: 12.9802s
	iters: 500, epoch: 1 | loss: 1.1344767
	speed: 0.0035s/iter; left time: 12.5977s
Updating learning rate to 0.0003818221205
Validation loss decreased (inf --> 0.3781).  Saving model state dict ...
Epoch: 1 cost time: 2.1464431285858154
Epoch: 1, Steps: 514 | Train Loss: 0.6828588 Vali Loss: 0.3780733 Best vali loss: 0.3780733
	iters: 100, epoch: 2 | loss: 0.4564463
	speed: 0.0075s/iter; left time: 26.3264s
	iters: 200, epoch: 2 | loss: 0.3362355
	speed: 0.0032s/iter; left time: 10.9030s
	iters: 300, epoch: 2 | loss: 0.4416028
	speed: 0.0032s/iter; left time: 10.4603s
	iters: 400, epoch: 2 | loss: 0.3788608
	speed: 0.0032s/iter; left time: 10.1476s
	iters: 500, epoch: 2 | loss: 0.9355804
	speed: 0.0032s/iter; left time: 9.7903s
Updating learning rate to 0.00019091106025
Validation loss decreased (0.3781 --> 0.3698).  Saving model state dict ...
Epoch: 2 cost time: 1.6821515560150146
Epoch: 2, Steps: 514 | Train Loss: 0.5097452 Vali Loss: 0.3697690 Best vali loss: 0.3697690
	iters: 100, epoch: 3 | loss: 0.5810002
	speed: 0.0077s/iter; left time: 22.9195s
	iters: 200, epoch: 3 | loss: 0.2916417
	speed: 0.0031s/iter; left time: 9.0647s
	iters: 300, epoch: 3 | loss: 0.4470924
	speed: 0.0031s/iter; left time: 8.7531s
	iters: 400, epoch: 3 | loss: 1.2325208
	speed: 0.0033s/iter; left time: 8.7556s
	iters: 500, epoch: 3 | loss: 0.3764621
	speed: 0.0033s/iter; left time: 8.6190s
Updating learning rate to 9.5455530125e-05
Validation loss decreased (0.3698 --> 0.3565).  Saving model state dict ...
Epoch: 3 cost time: 1.6980876922607422
Epoch: 3, Steps: 514 | Train Loss: 0.5857434 Vali Loss: 0.3565355 Best vali loss: 0.3565355

best validation loss 0.35653552905983915

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.001054333677, 'e_layers': 2, 'learning_rate': 0.0003818221205, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6357028
	speed: 0.0091s/iter; left time: 22.4002s
	iters: 200, epoch: 4 | loss: 0.5886069
	speed: 0.0032s/iter; left time: 7.6569s
	iters: 300, epoch: 4 | loss: 0.3919229
	speed: 0.0033s/iter; left time: 7.4075s
	iters: 400, epoch: 4 | loss: 0.3582909
	speed: 0.0033s/iter; left time: 7.2128s
	iters: 500, epoch: 4 | loss: 0.8693783
	speed: 0.0033s/iter; left time: 6.8940s
Updating learning rate to 4.77277650625e-05
Validation loss decreased (0.3565 --> 0.3484).  Saving model state dict ...
Epoch: 4 cost time: 2.0411245822906494
Epoch: 4, Steps: 514 | Train Loss: 0.5687804 Vali Loss: 0.3484427 Best vali loss: 0.3484427
	iters: 100, epoch: 5 | loss: 0.3124749
	speed: 0.0076s/iter; left time: 14.9495s
	iters: 200, epoch: 5 | loss: 0.2677707
	speed: 0.0031s/iter; left time: 5.6644s
	iters: 300, epoch: 5 | loss: 0.3713282
	speed: 0.0032s/iter; left time: 5.6462s
	iters: 400, epoch: 5 | loss: 0.3567320
	speed: 0.0032s/iter; left time: 5.2945s
	iters: 500, epoch: 5 | loss: 0.6637946
	speed: 0.0033s/iter; left time: 5.0997s
Updating learning rate to 2.386388253125e-05
Epoch: 5 cost time: 1.6822936534881592
Epoch: 5, Steps: 514 | Train Loss: 0.3944201 Vali Loss: 0.3489723 Best vali loss: 0.3484427
	iters: 100, epoch: 6 | loss: 0.5639675
	speed: 0.0075s/iter; left time: 10.8333s
	iters: 200, epoch: 6 | loss: 0.2183123
	speed: 0.0034s/iter; left time: 4.5072s
	iters: 300, epoch: 6 | loss: 0.3511261
	speed: 0.0033s/iter; left time: 4.0734s
	iters: 400, epoch: 6 | loss: 0.8697698
	speed: 0.0034s/iter; left time: 3.8478s
	iters: 500, epoch: 6 | loss: 0.3454972
	speed: 0.0037s/iter; left time: 3.8688s
Updating learning rate to 1.1931941265625e-05
Epoch: 6 cost time: 1.8096740245819092
Epoch: 6, Steps: 514 | Train Loss: 0.4697345 Vali Loss: 0.3502061 Best vali loss: 0.3484427
	iters: 100, epoch: 7 | loss: 0.3640039
	speed: 0.0074s/iter; left time: 6.9024s
	iters: 200, epoch: 7 | loss: 0.4188162
	speed: 0.0032s/iter; left time: 2.6481s
	iters: 300, epoch: 7 | loss: 0.3816972
	speed: 0.0031s/iter; left time: 2.2340s
	iters: 400, epoch: 7 | loss: 0.4636805
	speed: 0.0031s/iter; left time: 1.9218s
	iters: 500, epoch: 7 | loss: 0.5817593
	speed: 0.0031s/iter; left time: 1.6222s
Updating learning rate to 5.9659706328125e-06
Epoch: 7 cost time: 1.6503024101257324
Epoch: 7, Steps: 514 | Train Loss: 0.4419914 Vali Loss: 0.3509492 Best vali loss: 0.3484427
	iters: 100, epoch: 8 | loss: 0.3324577
	speed: 0.0072s/iter; left time: 3.0073s
	iters: 200, epoch: 8 | loss: 0.4217917
	speed: 0.0033s/iter; left time: 1.0302s
	iters: 300, epoch: 8 | loss: 0.3459409
	speed: 0.0032s/iter; left time: 0.6862s
	iters: 400, epoch: 8 | loss: 0.2482131
	speed: 0.0031s/iter; left time: 0.3604s
	iters: 500, epoch: 8 | loss: 0.6569759
	speed: 0.0031s/iter; left time: 0.0466s
Updating learning rate to 2.98298531640625e-06
Epoch: 8 cost time: 1.690643310546875
Epoch: 8, Steps: 514 | Train Loss: 0.4010759 Vali Loss: 0.3524885 Best vali loss: 0.3484427

best validation loss 0.34844266230675935

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0018563741297, 'e_layers': 3, 'learning_rate': 0.0007264292027, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5778558
	speed: 0.0107s/iter; left time: 43.0582s
	iters: 200, epoch: 1 | loss: 0.4447245
	speed: 0.0045s/iter; left time: 17.6527s
	iters: 300, epoch: 1 | loss: 0.9710520
	speed: 0.0045s/iter; left time: 16.9827s
	iters: 400, epoch: 1 | loss: 1.3395835
	speed: 0.0042s/iter; left time: 15.5256s
	iters: 500, epoch: 1 | loss: 0.7991795
	speed: 0.0040s/iter; left time: 14.5197s
Updating learning rate to 0.0006987811374465114
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 2.569077491760254
Epoch: 1, Steps: 514 | Train Loss: 0.8264791 Vali Loss: 0.3698659 Best vali loss: 0.3698659
	iters: 100, epoch: 2 | loss: 0.8319645
	speed: 0.0083s/iter; left time: 29.1421s
	iters: 200, epoch: 2 | loss: 0.4420201
	speed: 0.0037s/iter; left time: 12.6653s
	iters: 300, epoch: 2 | loss: 0.2647941
	speed: 0.0038s/iter; left time: 12.5012s
	iters: 400, epoch: 2 | loss: 0.7128314
	speed: 0.0039s/iter; left time: 12.5455s
	iters: 500, epoch: 2 | loss: 1.1977850
	speed: 0.0039s/iter; left time: 12.1622s
Updating learning rate to 0.0006200461089905535
Epoch: 2 cost time: 2.0230870246887207
Epoch: 2, Steps: 514 | Train Loss: 0.6898790 Vali Loss: 0.3736358 Best vali loss: 0.3698659
	iters: 100, epoch: 3 | loss: 0.6758428
	speed: 0.0079s/iter; left time: 23.7168s
	iters: 200, epoch: 3 | loss: 0.9101108
	speed: 0.0037s/iter; left time: 10.6091s
	iters: 300, epoch: 3 | loss: 0.7962745
	speed: 0.0038s/iter; left time: 10.6053s
	iters: 400, epoch: 3 | loss: 0.6000204
	speed: 0.0037s/iter; left time: 9.8828s
	iters: 500, epoch: 3 | loss: 0.5614716
	speed: 0.0037s/iter; left time: 9.5334s
Updating learning rate to 0.0005022108116797358
Epoch: 3 cost time: 1.949906826019287
Epoch: 3, Steps: 514 | Train Loss: 0.7087440 Vali Loss: 0.3759684 Best vali loss: 0.3698659
	iters: 100, epoch: 4 | loss: 0.7046029
	speed: 0.0087s/iter; left time: 21.5608s
	iters: 200, epoch: 4 | loss: 0.2755317
	speed: 0.0044s/iter; left time: 10.5431s
	iters: 300, epoch: 4 | loss: 0.3766191
	speed: 0.0044s/iter; left time: 9.9614s
	iters: 400, epoch: 4 | loss: 0.4492958
	speed: 0.0042s/iter; left time: 9.2212s
	iters: 500, epoch: 4 | loss: 0.3321874
	speed: 0.0042s/iter; left time: 8.7029s
Updating learning rate to 0.00036321460135
Epoch: 4 cost time: 2.271798849105835
Epoch: 4, Steps: 514 | Train Loss: 0.4276474 Vali Loss: 0.3904508 Best vali loss: 0.3698659
	iters: 100, epoch: 5 | loss: 0.5698698
	speed: 0.0086s/iter; left time: 16.9216s
	iters: 200, epoch: 5 | loss: 0.3466169
	speed: 0.0044s/iter; left time: 8.1827s
	iters: 300, epoch: 5 | loss: 0.4259917
	speed: 0.0041s/iter; left time: 7.2205s
	iters: 400, epoch: 5 | loss: 0.7572700
	speed: 0.0042s/iter; left time: 6.9843s
	iters: 500, epoch: 5 | loss: 0.7779971
	speed: 0.0043s/iter; left time: 6.6944s
Updating learning rate to 0.00022421839102026425
Epoch: 5 cost time: 2.2469382286071777
Epoch: 5, Steps: 514 | Train Loss: 0.5755491 Vali Loss: 0.3860000 Best vali loss: 0.3698659
	iters: 100, epoch: 6 | loss: 0.6341522
	speed: 0.0086s/iter; left time: 12.4314s
	iters: 200, epoch: 6 | loss: 0.5880656
	speed: 0.0044s/iter; left time: 5.8653s
	iters: 300, epoch: 6 | loss: 0.5162835
	speed: 0.0044s/iter; left time: 5.5259s
	iters: 400, epoch: 6 | loss: 0.3418054
	speed: 0.0043s/iter; left time: 4.9088s
	iters: 500, epoch: 6 | loss: 0.8337091
	speed: 0.0044s/iter; left time: 4.6103s
Updating learning rate to 0.00010638309370944648
Validation loss decreased (0.3699 --> 0.3691).  Saving model state dict ...
Epoch: 6 cost time: 2.2888104915618896
Epoch: 6, Steps: 514 | Train Loss: 0.5828031 Vali Loss: 0.3690910 Best vali loss: 0.3690910
	iters: 100, epoch: 7 | loss: 0.9447922
	speed: 0.0088s/iter; left time: 8.1305s
	iters: 200, epoch: 7 | loss: 0.3517227
	speed: 0.0044s/iter; left time: 3.6367s
	iters: 300, epoch: 7 | loss: 0.4768056
	speed: 0.0044s/iter; left time: 3.1769s
	iters: 400, epoch: 7 | loss: 0.6613792
	speed: 0.0044s/iter; left time: 2.7807s
	iters: 500, epoch: 7 | loss: 0.7269755
	speed: 0.0044s/iter; left time: 2.3410s
Updating learning rate to 2.7648065253488624e-05
Epoch: 7 cost time: 2.300813913345337
Epoch: 7, Steps: 514 | Train Loss: 0.6323350 Vali Loss: 0.3705311 Best vali loss: 0.3690910
	iters: 100, epoch: 8 | loss: 0.4505806
	speed: 0.0088s/iter; left time: 3.6332s
	iters: 200, epoch: 8 | loss: 0.3426272
	speed: 0.0044s/iter; left time: 1.3931s
	iters: 300, epoch: 8 | loss: 0.7034442
	speed: 0.0043s/iter; left time: 0.9335s
	iters: 400, epoch: 8 | loss: 0.3041114
	speed: 0.0043s/iter; left time: 0.4998s
	iters: 500, epoch: 8 | loss: 0.3616481
	speed: 0.0043s/iter; left time: 0.0644s
Updating learning rate to 0.0
Validation loss decreased (0.3691 --> 0.3670).  Saving model state dict ...
Epoch: 8 cost time: 2.284557580947876
Epoch: 8, Steps: 514 | Train Loss: 0.4324823 Vali Loss: 0.3669975 Best vali loss: 0.3669975

best validation loss 0.36699745138056855

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0039837149858, 'e_layers': 4, 'learning_rate': 0.0011859621439, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5567579
	speed: 0.0121s/iter; left time: 23.7290s
	iters: 200, epoch: 1 | loss: 0.2622401
	speed: 0.0057s/iter; left time: 10.5244s
Updating learning rate to 0.0011408241474912078
Validation loss decreased (inf --> 0.3980).  Saving model state dict ...
Epoch: 1 cost time: 1.8208551406860352
Epoch: 1, Steps: 257 | Train Loss: 0.4094990 Vali Loss: 0.3980257 Best vali loss: 0.3980257
	iters: 100, epoch: 2 | loss: 0.5364484
	speed: 0.0119s/iter; left time: 20.1672s
	iters: 200, epoch: 2 | loss: 0.5343172
	speed: 0.0055s/iter; left time: 8.8330s
Updating learning rate to 0.0010122820090411131
Epoch: 2 cost time: 1.4641757011413574
Epoch: 2, Steps: 257 | Train Loss: 0.5353828 Vali Loss: 0.4085618 Best vali loss: 0.3980257
	iters: 100, epoch: 3 | loss: 0.9789336
	speed: 0.0118s/iter; left time: 16.9926s
	iters: 200, epoch: 3 | loss: 0.7623180
	speed: 0.0057s/iter; left time: 7.6354s
Updating learning rate to 0.0008199051038913564
Epoch: 3 cost time: 1.5130066871643066
Epoch: 3, Steps: 257 | Train Loss: 0.8706258 Vali Loss: 0.4141028 Best vali loss: 0.3980257
	iters: 100, epoch: 4 | loss: 0.5154416
	speed: 0.0117s/iter; left time: 13.8552s
	iters: 200, epoch: 4 | loss: 0.6437750
	speed: 0.0056s/iter; left time: 6.0607s
Updating learning rate to 0.00059298107195
Epoch: 4 cost time: 1.4906105995178223
Epoch: 4, Steps: 257 | Train Loss: 0.5796083 Vali Loss: 0.4093056 Best vali loss: 0.3980257
	iters: 100, epoch: 5 | loss: 0.7158674
	speed: 0.0115s/iter; left time: 10.6657s
	iters: 200, epoch: 5 | loss: 0.4146284
	speed: 0.0056s/iter; left time: 4.6587s
Updating learning rate to 0.0003660570400086438
Epoch: 5 cost time: 1.4853568077087402
Epoch: 5, Steps: 257 | Train Loss: 0.5652479 Vali Loss: 0.4061944 Best vali loss: 0.3980257
	iters: 100, epoch: 6 | loss: 0.9303076
	speed: 0.0116s/iter; left time: 7.8249s
	iters: 200, epoch: 6 | loss: 1.0904115
	speed: 0.0056s/iter; left time: 3.1787s
Updating learning rate to 0.000173680134858887
Epoch: 6 cost time: 1.4748890399932861
Epoch: 6, Steps: 257 | Train Loss: 1.0103596 Vali Loss: 0.4068699 Best vali loss: 0.3980257
	iters: 100, epoch: 7 | loss: 0.6198666
	speed: 0.0115s/iter; left time: 4.7698s
	iters: 200, epoch: 7 | loss: 0.4601995
	speed: 0.0055s/iter; left time: 1.7352s
Updating learning rate to 4.513799640879231e-05
Epoch: 7 cost time: 1.4613862037658691
Epoch: 7, Steps: 257 | Train Loss: 0.5400330 Vali Loss: 0.4049935 Best vali loss: 0.3980257
	iters: 100, epoch: 8 | loss: 0.5102528
	speed: 0.0114s/iter; left time: 1.8030s
	iters: 200, epoch: 8 | loss: 0.8708518
	speed: 0.0056s/iter; left time: 0.3247s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4789047241210938
Epoch: 8, Steps: 257 | Train Loss: 0.6905523 Vali Loss: 0.4035358 Best vali loss: 0.3980257

best validation loss 0.39802571312617696

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010619163491, 'e_layers': 2, 'learning_rate': 0.0003771286788, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7283348
	speed: 0.0096s/iter; left time: 38.4831s
	iters: 200, epoch: 1 | loss: 0.6178070
	speed: 0.0033s/iter; left time: 13.0296s
	iters: 300, epoch: 1 | loss: 0.4087580
	speed: 0.0033s/iter; left time: 12.6640s
	iters: 400, epoch: 1 | loss: 0.5041831
	speed: 0.0033s/iter; left time: 12.1067s
	iters: 500, epoch: 1 | loss: 1.1429007
	speed: 0.0033s/iter; left time: 11.7926s
Updating learning rate to 0.0003771286788
Validation loss decreased (inf --> 0.3723).  Saving model state dict ...
Epoch: 1 cost time: 2.0477066040039062
Epoch: 1, Steps: 514 | Train Loss: 0.6803967 Vali Loss: 0.3722694 Best vali loss: 0.3722694
	iters: 100, epoch: 2 | loss: 0.5022981
	speed: 0.0073s/iter; left time: 25.5727s
	iters: 200, epoch: 2 | loss: 0.3436243
	speed: 0.0031s/iter; left time: 10.4988s
	iters: 300, epoch: 2 | loss: 0.4359811
	speed: 0.0031s/iter; left time: 10.2575s
	iters: 400, epoch: 2 | loss: 0.3923279
	speed: 0.0032s/iter; left time: 10.2683s
	iters: 500, epoch: 2 | loss: 0.9743550
	speed: 0.0031s/iter; left time: 9.7277s
Updating learning rate to 0.0001885643394
Validation loss decreased (0.3723 --> 0.3655).  Saving model state dict ...
Epoch: 2 cost time: 1.6536622047424316
Epoch: 2, Steps: 514 | Train Loss: 0.5297173 Vali Loss: 0.3654572 Best vali loss: 0.3654572
	iters: 100, epoch: 3 | loss: 0.5826144
	speed: 0.0080s/iter; left time: 23.8412s
	iters: 200, epoch: 3 | loss: 0.3001946
	speed: 0.0033s/iter; left time: 9.5179s
	iters: 300, epoch: 3 | loss: 0.4308141
	speed: 0.0033s/iter; left time: 9.2707s
	iters: 400, epoch: 3 | loss: 1.3125817
	speed: 0.0034s/iter; left time: 9.0495s
	iters: 500, epoch: 3 | loss: 0.3727547
	speed: 0.0032s/iter; left time: 8.3369s
Updating learning rate to 9.42821697e-05
Epoch: 3 cost time: 1.7522239685058594
Epoch: 3, Steps: 514 | Train Loss: 0.5997919 Vali Loss: 0.3679426 Best vali loss: 0.3654572

best validation loss 0.36545718576912795

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0035145471929, 'e_layers': 4, 'learning_rate': 0.0001954894725, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1754241
	speed: 0.0114s/iter; left time: 45.7965s
	iters: 200, epoch: 1 | loss: 0.5655692
	speed: 0.0052s/iter; left time: 20.1846s
	iters: 300, epoch: 1 | loss: 0.5613333
	speed: 0.0052s/iter; left time: 19.7623s
	iters: 400, epoch: 1 | loss: 1.0657982
	speed: 0.0052s/iter; left time: 19.4556s
	iters: 500, epoch: 1 | loss: 0.5962445
	speed: 0.0051s/iter; left time: 18.4510s
Updating learning rate to 0.00018804909748208903
Validation loss decreased (inf --> 0.3719).  Saving model state dict ...
Epoch: 1 cost time: 3.002272605895996
Epoch: 1, Steps: 514 | Train Loss: 0.7928738 Vali Loss: 0.3719093 Best vali loss: 0.3719093
	iters: 100, epoch: 2 | loss: 0.7110064
	speed: 0.0101s/iter; left time: 35.3539s
	iters: 200, epoch: 2 | loss: 0.7963103
	speed: 0.0050s/iter; left time: 16.9721s
	iters: 300, epoch: 2 | loss: 0.5288083
	speed: 0.0050s/iter; left time: 16.4758s
	iters: 400, epoch: 2 | loss: 0.3253779
	speed: 0.0050s/iter; left time: 15.9028s
	iters: 500, epoch: 2 | loss: 0.5395429
	speed: 0.0050s/iter; left time: 15.5995s
Updating learning rate to 0.00016686070207766555
Validation loss decreased (0.3719 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 2.6170811653137207
Epoch: 2, Steps: 514 | Train Loss: 0.5802091 Vali Loss: 0.3667674 Best vali loss: 0.3667674
	iters: 100, epoch: 3 | loss: 1.0344909
	speed: 0.0099s/iter; left time: 29.6752s
	iters: 200, epoch: 3 | loss: 1.1547706
	speed: 0.0047s/iter; left time: 13.5839s
	iters: 300, epoch: 3 | loss: 0.4969823
	speed: 0.0048s/iter; left time: 13.4315s
	iters: 400, epoch: 3 | loss: 0.3110072
	speed: 0.0048s/iter; left time: 12.9348s
	iters: 500, epoch: 3 | loss: 0.3635224
	speed: 0.0049s/iter; left time: 12.5964s
Updating learning rate to 0.00013515002741377042
Epoch: 3 cost time: 2.5225000381469727
Epoch: 3, Steps: 514 | Train Loss: 0.6721547 Vali Loss: 0.3706419 Best vali loss: 0.3667674

best validation loss 0.36676736641492264

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008982088542, 'e_layers': 3, 'learning_rate': 0.0015200987044, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4084837
	speed: 0.0115s/iter; left time: 22.5137s
	iters: 200, epoch: 1 | loss: 0.6303623
	speed: 0.0050s/iter; left time: 9.3650s
Updating learning rate to 0.0015200987044
Validation loss decreased (inf --> 0.3975).  Saving model state dict ...
Epoch: 1 cost time: 1.6622066497802734
Epoch: 1, Steps: 257 | Train Loss: 0.5194230 Vali Loss: 0.3975294 Best vali loss: 0.3975294
	iters: 100, epoch: 2 | loss: 0.4793316
	speed: 0.0109s/iter; left time: 18.4840s
	iters: 200, epoch: 2 | loss: 0.7032152
	speed: 0.0051s/iter; left time: 8.1605s
Updating learning rate to 0.0007600493522
Epoch: 2 cost time: 1.332202434539795
Epoch: 2, Steps: 257 | Train Loss: 0.5912734 Vali Loss: 0.4004465 Best vali loss: 0.3975294
	iters: 100, epoch: 3 | loss: 0.6317401
	speed: 0.0105s/iter; left time: 15.2026s
	iters: 200, epoch: 3 | loss: 0.4762732
	speed: 0.0048s/iter; left time: 6.4445s
Updating learning rate to 0.0003800246761
Validation loss decreased (0.3975 --> 0.3941).  Saving model state dict ...
Epoch: 3 cost time: 1.2763381004333496
Epoch: 3, Steps: 257 | Train Loss: 0.5540067 Vali Loss: 0.3940744 Best vali loss: 0.3940744

best validation loss 0.3940743547291559

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010619163491, 'e_layers': 2, 'learning_rate': 0.0003771286788, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7052721
	speed: 0.0102s/iter; left time: 25.2486s
	iters: 200, epoch: 4 | loss: 0.5885639
	speed: 0.0037s/iter; left time: 8.7695s
	iters: 300, epoch: 4 | loss: 0.3805063
	speed: 0.0035s/iter; left time: 7.9778s
	iters: 400, epoch: 4 | loss: 0.3810151
	speed: 0.0036s/iter; left time: 7.8859s
	iters: 500, epoch: 4 | loss: 0.8946098
	speed: 0.0037s/iter; left time: 7.6170s
Updating learning rate to 4.714108485e-05
Validation loss decreased (0.3655 --> 0.3646).  Saving model state dict ...
Epoch: 4 cost time: 2.2300565242767334
Epoch: 4, Steps: 514 | Train Loss: 0.5899934 Vali Loss: 0.3645863 Best vali loss: 0.3645863
	iters: 100, epoch: 5 | loss: 0.3372725
	speed: 0.0084s/iter; left time: 16.3754s
	iters: 200, epoch: 5 | loss: 0.3065662
	speed: 0.0035s/iter; left time: 6.5274s
	iters: 300, epoch: 5 | loss: 0.3591064
	speed: 0.0036s/iter; left time: 6.2683s
	iters: 400, epoch: 5 | loss: 0.3632951
	speed: 0.0036s/iter; left time: 5.9313s
	iters: 500, epoch: 5 | loss: 0.6634963
	speed: 0.0033s/iter; left time: 5.1836s
Updating learning rate to 2.3570542425e-05
Epoch: 5 cost time: 1.8587729930877686
Epoch: 5, Steps: 514 | Train Loss: 0.4059473 Vali Loss: 0.3675615 Best vali loss: 0.3645863
	iters: 100, epoch: 6 | loss: 0.5483703
	speed: 0.0072s/iter; left time: 10.3357s
	iters: 200, epoch: 6 | loss: 0.2472645
	speed: 0.0030s/iter; left time: 4.0730s
	iters: 300, epoch: 6 | loss: 0.3660988
	speed: 0.0030s/iter; left time: 3.7811s
	iters: 400, epoch: 6 | loss: 0.8872103
	speed: 0.0030s/iter; left time: 3.4827s
	iters: 500, epoch: 6 | loss: 0.3564946
	speed: 0.0031s/iter; left time: 3.1875s
Updating learning rate to 1.17852712125e-05
Validation loss decreased (0.3646 --> 0.3596).  Saving model state dict ...
Epoch: 6 cost time: 1.6197850704193115
Epoch: 6, Steps: 514 | Train Loss: 0.4810877 Vali Loss: 0.3595833 Best vali loss: 0.3595833
	iters: 100, epoch: 7 | loss: 0.4003890
	speed: 0.0077s/iter; left time: 7.1325s
	iters: 200, epoch: 7 | loss: 0.4187637
	speed: 0.0033s/iter; left time: 2.7064s
	iters: 300, epoch: 7 | loss: 0.3964838
	speed: 0.0032s/iter; left time: 2.3634s
	iters: 400, epoch: 7 | loss: 0.4736629
	speed: 0.0034s/iter; left time: 2.1411s
	iters: 500, epoch: 7 | loss: 0.5803733
	speed: 0.0031s/iter; left time: 1.6660s
Updating learning rate to 5.89263560625e-06
Epoch: 7 cost time: 1.7240560054779053
Epoch: 7, Steps: 514 | Train Loss: 0.4539346 Vali Loss: 0.3612429 Best vali loss: 0.3595833
	iters: 100, epoch: 8 | loss: 0.3393566
	speed: 0.0072s/iter; left time: 3.0008s
	iters: 200, epoch: 8 | loss: 0.4322034
	speed: 0.0032s/iter; left time: 0.9970s
	iters: 300, epoch: 8 | loss: 0.3472307
	speed: 0.0032s/iter; left time: 0.6788s
	iters: 400, epoch: 8 | loss: 0.2537411
	speed: 0.0032s/iter; left time: 0.3633s
	iters: 500, epoch: 8 | loss: 0.6769065
	speed: 0.0031s/iter; left time: 0.0465s
Updating learning rate to 2.946317803125e-06
Validation loss decreased (0.3596 --> 0.3588).  Saving model state dict ...
Epoch: 8 cost time: 1.6701607704162598
Epoch: 8, Steps: 514 | Train Loss: 0.4098877 Vali Loss: 0.3587784 Best vali loss: 0.3587784

best validation loss 0.3587783584894506

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010683620273, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4264177
	speed: 0.0098s/iter; left time: 39.2716s
	iters: 200, epoch: 1 | loss: 1.0776556
	speed: 0.0034s/iter; left time: 13.4072s
	iters: 300, epoch: 1 | loss: 1.0151554
	speed: 0.0034s/iter; left time: 13.1459s
	iters: 400, epoch: 1 | loss: 0.5037471
	speed: 0.0034s/iter; left time: 12.7312s
	iters: 500, epoch: 1 | loss: 1.1416053
	speed: 0.0034s/iter; left time: 12.2117s
Updating learning rate to 0.0003677599621661719
Validation loss decreased (inf --> 0.3743).  Saving model state dict ...
Epoch: 1 cost time: 2.130521059036255
Epoch: 1, Steps: 514 | Train Loss: 0.8329162 Vali Loss: 0.3743383 Best vali loss: 0.3743383
	iters: 100, epoch: 2 | loss: 0.3888795
	speed: 0.0072s/iter; left time: 25.1567s
	iters: 200, epoch: 2 | loss: 0.2614352
	speed: 0.0032s/iter; left time: 10.8041s
	iters: 300, epoch: 2 | loss: 0.4718141
	speed: 0.0032s/iter; left time: 10.4598s
	iters: 400, epoch: 2 | loss: 0.3907744
	speed: 0.0032s/iter; left time: 10.1286s
	iters: 500, epoch: 2 | loss: 0.6149917
	speed: 0.0032s/iter; left time: 10.0038s
Updating learning rate to 0.000326322680112559
Validation loss decreased (0.3743 --> 0.3646).  Saving model state dict ...
Epoch: 2 cost time: 1.6850805282592773
Epoch: 2, Steps: 514 | Train Loss: 0.4255790 Vali Loss: 0.3646108 Best vali loss: 0.3646108
	iters: 100, epoch: 3 | loss: 0.3705665
	speed: 0.0075s/iter; left time: 22.2412s
	iters: 200, epoch: 3 | loss: 0.8418419
	speed: 0.0032s/iter; left time: 9.3685s
	iters: 300, epoch: 3 | loss: 0.4945775
	speed: 0.0032s/iter; left time: 8.9874s
	iters: 400, epoch: 3 | loss: 0.4675311
	speed: 0.0032s/iter; left time: 8.5360s
	iters: 500, epoch: 3 | loss: 1.1891119
	speed: 0.0035s/iter; left time: 9.1005s
Updating learning rate to 0.0002643074050019267
Validation loss decreased (0.3646 --> 0.3536).  Saving model state dict ...
Epoch: 3 cost time: 1.7405779361724854
Epoch: 3, Steps: 514 | Train Loss: 0.6727258 Vali Loss: 0.3535863 Best vali loss: 0.3535863
	iters: 100, epoch: 4 | loss: 0.5803982
	speed: 0.0077s/iter; left time: 18.9326s
	iters: 200, epoch: 4 | loss: 0.4530731
	speed: 0.0036s/iter; left time: 8.4662s
	iters: 300, epoch: 4 | loss: 0.4588254
	speed: 0.0036s/iter; left time: 8.1132s
	iters: 400, epoch: 4 | loss: 0.6978968
	speed: 0.0036s/iter; left time: 7.7512s
	iters: 500, epoch: 4 | loss: 0.6873291
	speed: 0.0034s/iter; left time: 7.0873s
Updating learning rate to 0.0001911554003
Validation loss decreased (0.3536 --> 0.3480).  Saving model state dict ...
Epoch: 4 cost time: 1.8583564758300781
Epoch: 4, Steps: 514 | Train Loss: 0.5755045 Vali Loss: 0.3480029 Best vali loss: 0.3480029
	iters: 100, epoch: 5 | loss: 0.5254678
	speed: 0.0076s/iter; left time: 14.8037s
	iters: 200, epoch: 5 | loss: 0.6968397
	speed: 0.0034s/iter; left time: 6.2881s
	iters: 300, epoch: 5 | loss: 0.4539526
	speed: 0.0033s/iter; left time: 5.8526s
	iters: 400, epoch: 5 | loss: 0.7467744
	speed: 0.0033s/iter; left time: 5.5282s
	iters: 500, epoch: 5 | loss: 0.5235516
	speed: 0.0034s/iter; left time: 5.2834s
Updating learning rate to 0.00011800339559807329
Validation loss decreased (0.3480 --> 0.3457).  Saving model state dict ...
Epoch: 5 cost time: 1.7918181419372559
Epoch: 5, Steps: 514 | Train Loss: 0.5893172 Vali Loss: 0.3457226 Best vali loss: 0.3457226
	iters: 100, epoch: 6 | loss: 0.3016464
	speed: 0.0075s/iter; left time: 10.8673s
	iters: 200, epoch: 6 | loss: 0.4710591
	speed: 0.0033s/iter; left time: 4.4858s
	iters: 300, epoch: 6 | loss: 0.3200094
	speed: 0.0033s/iter; left time: 4.0602s
	iters: 400, epoch: 6 | loss: 0.7239726
	speed: 0.0033s/iter; left time: 3.8182s
	iters: 500, epoch: 6 | loss: 0.8660115
	speed: 0.0034s/iter; left time: 3.5603s
Updating learning rate to 5.598812048744101e-05
Epoch: 6 cost time: 1.7674705982208252
Epoch: 6, Steps: 514 | Train Loss: 0.5365398 Vali Loss: 0.3527969 Best vali loss: 0.3457226
	iters: 100, epoch: 7 | loss: 0.3728980
	speed: 0.0074s/iter; left time: 6.8569s
	iters: 200, epoch: 7 | loss: 0.2792962
	speed: 0.0033s/iter; left time: 2.7651s
	iters: 300, epoch: 7 | loss: 0.3221316
	speed: 0.0033s/iter; left time: 2.3752s
	iters: 400, epoch: 7 | loss: 0.3456363
	speed: 0.0032s/iter; left time: 2.0015s
	iters: 500, epoch: 7 | loss: 0.6878657
	speed: 0.0032s/iter; left time: 1.7138s
Updating learning rate to 1.455083843382812e-05
Epoch: 7 cost time: 1.7283012866973877
Epoch: 7, Steps: 514 | Train Loss: 0.4015656 Vali Loss: 0.3562366 Best vali loss: 0.3457226
	iters: 100, epoch: 8 | loss: 0.3267733
	speed: 0.0071s/iter; left time: 2.9568s
	iters: 200, epoch: 8 | loss: 0.2155349
	speed: 0.0032s/iter; left time: 1.0100s
	iters: 300, epoch: 8 | loss: 0.3114008
	speed: 0.0032s/iter; left time: 0.6854s
	iters: 400, epoch: 8 | loss: 0.4020781
	speed: 0.0032s/iter; left time: 0.3664s
	iters: 500, epoch: 8 | loss: 0.1984916
	speed: 0.0032s/iter; left time: 0.0480s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.694148063659668
Epoch: 8, Steps: 514 | Train Loss: 0.2908558 Vali Loss: 0.3605999 Best vali loss: 0.3457226

best validation loss 0.3457226111870149

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023028686593, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.0932466983795166
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715520 Best vali loss: 0.3715520
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3716 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.7795827388763428
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3647640 Best vali loss: 0.3647640
Updating learning rate to 0.0004887960207521749
Epoch: 3 cost time: 0.7781970500946045
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3673284 Best vali loss: 0.3647640
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3648 --> 0.3611).  Saving model state dict ...
Epoch: 4 cost time: 0.7745180130004883
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3610567 Best vali loss: 0.3610567
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3611 --> 0.3505).  Saving model state dict ...
Epoch: 5 cost time: 0.7757766246795654
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3504819 Best vali loss: 0.3504819
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7830889225006104
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3521944 Best vali loss: 0.3504819
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7838704586029053
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3558802 Best vali loss: 0.3504819
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7821292877197266
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3612109 Best vali loss: 0.3504819

best validation loss 0.350481913635445

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0011365582991, 'e_layers': 2, 'learning_rate': 0.0003144589776, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003024905954095326
Validation loss decreased (inf --> 0.3689).  Saving model state dict ...
Epoch: 1 cost time: 0.6943020820617676
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3688942 Best vali loss: 0.3688942
Updating learning rate to 0.0002684075265329743
Validation loss decreased (0.3689 --> 0.3589).  Saving model state dict ...
Epoch: 2 cost time: 0.4042975902557373
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3588639 Best vali loss: 0.3588639
Updating learning rate to 0.00021739860924299248
Epoch: 3 cost time: 0.39780688285827637
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3624620 Best vali loss: 0.3588639

best validation loss 0.358863869362121

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0014880296331, 'e_layers': 3, 'learning_rate': 9.44530449e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8459041
	speed: 0.0105s/iter; left time: 20.6069s
	iters: 200, epoch: 1 | loss: 0.4407425
	speed: 0.0045s/iter; left time: 8.3805s
Updating learning rate to 9.085813993323979e-05
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.4785711765289307
Epoch: 1, Steps: 257 | Train Loss: 0.6433233 Vali Loss: 0.3676181 Best vali loss: 0.3676181
	iters: 100, epoch: 2 | loss: 0.7257081
	speed: 0.0095s/iter; left time: 16.0948s
	iters: 200, epoch: 2 | loss: 0.5922351
	speed: 0.0044s/iter; left time: 7.0625s
Updating learning rate to 8.062071672625373e-05
Epoch: 2 cost time: 1.1695141792297363
Epoch: 2, Steps: 257 | Train Loss: 0.6589716 Vali Loss: 0.3684950 Best vali loss: 0.3676181
	iters: 100, epoch: 3 | loss: 0.7412423
	speed: 0.0093s/iter; left time: 13.4347s
	iters: 200, epoch: 3 | loss: 0.8079756
	speed: 0.0045s/iter; left time: 6.0040s
Updating learning rate to 6.529933015983297e-05
Validation loss decreased (0.3676 --> 0.3658).  Saving model state dict ...
Epoch: 3 cost time: 1.1883511543273926
Epoch: 3, Steps: 257 | Train Loss: 0.7746090 Vali Loss: 0.3658389 Best vali loss: 0.3658389

best validation loss 0.36583891769757676

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.002641450713, 'e_layers': 1, 'learning_rate': 0.0026960539055, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3953238
	speed: 0.0085s/iter; left time: 69.2522s
	iters: 200, epoch: 1 | loss: 0.4376046
	speed: 0.0024s/iter; left time: 18.9279s
	iters: 300, epoch: 1 | loss: 0.6304276
	speed: 0.0024s/iter; left time: 19.2957s
	iters: 400, epoch: 1 | loss: 0.3394091
	speed: 0.0024s/iter; left time: 18.5621s
	iters: 500, epoch: 1 | loss: 0.9896817
	speed: 0.0024s/iter; left time: 18.4179s
	iters: 600, epoch: 1 | loss: 0.7279383
	speed: 0.0024s/iter; left time: 17.9380s
	iters: 700, epoch: 1 | loss: 1.1573399
	speed: 0.0024s/iter; left time: 17.8531s
	iters: 800, epoch: 1 | loss: 0.6352847
	speed: 0.0024s/iter; left time: 17.4447s
	iters: 900, epoch: 1 | loss: 0.4936816
	speed: 0.0024s/iter; left time: 17.2137s
	iters: 1000, epoch: 1 | loss: 0.2987427
	speed: 0.0024s/iter; left time: 17.2252s
Updating learning rate to 0.0026960539055
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 2.7907779216766357
Epoch: 1, Steps: 1027 | Train Loss: 0.6105434 Vali Loss: 0.3728559 Best vali loss: 0.3728559
	iters: 100, epoch: 2 | loss: 0.4388713
	speed: 0.0075s/iter; left time: 53.3008s
	iters: 200, epoch: 2 | loss: 0.2663355
	speed: 0.0025s/iter; left time: 17.1535s
	iters: 300, epoch: 2 | loss: 0.6235011
	speed: 0.0024s/iter; left time: 16.6964s
	iters: 400, epoch: 2 | loss: 0.2699312
	speed: 0.0024s/iter; left time: 16.2546s
	iters: 500, epoch: 2 | loss: 1.3554022
	speed: 0.0024s/iter; left time: 15.9366s
	iters: 600, epoch: 2 | loss: 0.4026396
	speed: 0.0024s/iter; left time: 16.0269s
	iters: 700, epoch: 2 | loss: 0.4119954
	speed: 0.0024s/iter; left time: 15.4113s
	iters: 800, epoch: 2 | loss: 0.8770877
	speed: 0.0024s/iter; left time: 15.5773s
	iters: 900, epoch: 2 | loss: 0.5406078
	speed: 0.0023s/iter; left time: 14.6620s
	iters: 1000, epoch: 2 | loss: 1.2957389
	speed: 0.0023s/iter; left time: 14.4356s
Updating learning rate to 0.00134802695275
Epoch: 2 cost time: 2.499157428741455
Epoch: 2, Steps: 1027 | Train Loss: 0.6482111 Vali Loss: 0.4023512 Best vali loss: 0.3728559
	iters: 100, epoch: 3 | loss: 0.3093596
	speed: 0.0073s/iter; left time: 44.1168s
	iters: 200, epoch: 3 | loss: 0.4258112
	speed: 0.0021s/iter; left time: 12.6784s
	iters: 300, epoch: 3 | loss: 0.3992881
	speed: 0.0022s/iter; left time: 12.6628s
	iters: 400, epoch: 3 | loss: 0.7248523
	speed: 0.0021s/iter; left time: 12.2062s
	iters: 500, epoch: 3 | loss: 0.5100334
	speed: 0.0021s/iter; left time: 12.0490s
	iters: 600, epoch: 3 | loss: 0.5569237
	speed: 0.0021s/iter; left time: 11.8179s
	iters: 700, epoch: 3 | loss: 0.8145336
	speed: 0.0021s/iter; left time: 11.4126s
	iters: 800, epoch: 3 | loss: 0.3002583
	speed: 0.0021s/iter; left time: 11.1216s
	iters: 900, epoch: 3 | loss: 1.1992754
	speed: 0.0021s/iter; left time: 10.9907s
	iters: 1000, epoch: 3 | loss: 1.8453177
	speed: 0.0021s/iter; left time: 10.7340s
Updating learning rate to 0.000674013476375
Epoch: 3 cost time: 2.206911325454712
Epoch: 3, Steps: 1027 | Train Loss: 0.7085653 Vali Loss: 0.4036211 Best vali loss: 0.3728559

best validation loss 0.37285594331843447

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0011365582991, 'e_layers': 2, 'learning_rate': 0.0003144589776, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001572294888
Epoch: 4 cost time: 0.7058985233306885
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3791667 Best vali loss: 0.3588639
Updating learning rate to 9.706036835700757e-05
Epoch: 5 cost time: 0.3929591178894043
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3759553 Best vali loss: 0.3588639
Updating learning rate to 4.605145106702569e-05
Epoch: 6 cost time: 0.40480780601501465
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3691352 Best vali loss: 0.3588639
Updating learning rate to 1.1968382190467406e-05
Epoch: 7 cost time: 0.38994526863098145
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3835905 Best vali loss: 0.3588639
Updating learning rate to 0.0
Epoch: 8 cost time: 0.38996076583862305
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3776837 Best vali loss: 0.3588639

best validation loss 0.358863869362121

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009918189543, 'e_layers': 4, 'learning_rate': 6.40298629e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8632295
	speed: 0.0123s/iter; left time: 11.5021s
Updating learning rate to 6.40298629e-05
Validation loss decreased (inf --> 0.4190).  Saving model state dict ...
Epoch: 1 cost time: 1.1255521774291992
Epoch: 1, Steps: 129 | Train Loss: 0.8632295 Vali Loss: 0.4189613 Best vali loss: 0.4189613
	iters: 100, epoch: 2 | loss: 0.6370100
	speed: 0.0095s/iter; left time: 7.6687s
Updating learning rate to 3.201493145e-05
Validation loss decreased (0.4190 --> 0.3985).  Saving model state dict ...
Epoch: 2 cost time: 0.7565262317657471
Epoch: 2, Steps: 129 | Train Loss: 0.6370100 Vali Loss: 0.3984606 Best vali loss: 0.3984606
	iters: 100, epoch: 3 | loss: 0.4253406
	speed: 0.0090s/iter; left time: 6.1028s
Updating learning rate to 1.6007465725e-05
Validation loss decreased (0.3985 --> 0.3921).  Saving model state dict ...
Epoch: 3 cost time: 0.7505991458892822
Epoch: 3, Steps: 129 | Train Loss: 0.4253406 Vali Loss: 0.3920854 Best vali loss: 0.3920854
	iters: 100, epoch: 4 | loss: 0.8758971
	speed: 0.0091s/iter; left time: 4.9625s
Updating learning rate to 8.0037328625e-06
Validation loss decreased (0.3921 --> 0.3895).  Saving model state dict ...
Epoch: 4 cost time: 0.7490479946136475
Epoch: 4, Steps: 129 | Train Loss: 0.8758971 Vali Loss: 0.3895151 Best vali loss: 0.3895151
	iters: 100, epoch: 5 | loss: 0.6874512
	speed: 0.0093s/iter; left time: 3.8599s
Updating learning rate to 4.00186643125e-06
Validation loss decreased (0.3895 --> 0.3884).  Saving model state dict ...
Epoch: 5 cost time: 0.7675023078918457
Epoch: 5, Steps: 129 | Train Loss: 0.6874512 Vali Loss: 0.3883617 Best vali loss: 0.3883617
	iters: 100, epoch: 6 | loss: 0.6866426
	speed: 0.0094s/iter; left time: 2.7102s
Updating learning rate to 2.000933215625e-06
Validation loss decreased (0.3884 --> 0.3878).  Saving model state dict ...
Epoch: 6 cost time: 0.7900278568267822
Epoch: 6, Steps: 129 | Train Loss: 0.6866426 Vali Loss: 0.3877929 Best vali loss: 0.3877929
	iters: 100, epoch: 7 | loss: 0.7702243
	speed: 0.0092s/iter; left time: 1.4577s
Updating learning rate to 1.0004666078125e-06
Validation loss decreased (0.3878 --> 0.3875).  Saving model state dict ...
Epoch: 7 cost time: 0.7543306350708008
Epoch: 7, Steps: 129 | Train Loss: 0.7702243 Vali Loss: 0.3875242 Best vali loss: 0.3875242
	iters: 100, epoch: 8 | loss: 0.6066313
	speed: 0.0094s/iter; left time: 0.2831s
Updating learning rate to 5.0023330390625e-07
Validation loss decreased (0.3875 --> 0.3874).  Saving model state dict ...
Epoch: 8 cost time: 0.7925076484680176
Epoch: 8, Steps: 129 | Train Loss: 0.6066313 Vali Loss: 0.3873905 Best vali loss: 0.3873905

best validation loss 0.38739047730835574

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.002220461454, 'e_layers': 2, 'learning_rate': 0.0004363432466, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4280957
	speed: 0.0099s/iter; left time: 39.6041s
	iters: 200, epoch: 1 | loss: 1.0795871
	speed: 0.0035s/iter; left time: 13.7982s
	iters: 300, epoch: 1 | loss: 1.0117857
	speed: 0.0034s/iter; left time: 13.0805s
	iters: 400, epoch: 1 | loss: 0.5030730
	speed: 0.0035s/iter; left time: 12.9658s
	iters: 500, epoch: 1 | loss: 1.1685251
	speed: 0.0035s/iter; left time: 12.7964s
Updating learning rate to 0.0004363432466
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 2.165578842163086
Epoch: 1, Steps: 514 | Train Loss: 0.8382133 Vali Loss: 0.3723659 Best vali loss: 0.3723659
	iters: 100, epoch: 2 | loss: 0.3941657
	speed: 0.0071s/iter; left time: 24.8083s
	iters: 200, epoch: 2 | loss: 0.2647756
	speed: 0.0031s/iter; left time: 10.5604s
	iters: 300, epoch: 2 | loss: 0.4917549
	speed: 0.0032s/iter; left time: 10.4208s
	iters: 400, epoch: 2 | loss: 0.4038146
	speed: 0.0030s/iter; left time: 9.5622s
	iters: 500, epoch: 2 | loss: 0.6176183
	speed: 0.0030s/iter; left time: 9.1960s
Updating learning rate to 0.0002181716233
Validation loss decreased (0.3724 --> 0.3634).  Saving model state dict ...
Epoch: 2 cost time: 1.6244781017303467
Epoch: 2, Steps: 514 | Train Loss: 0.4344258 Vali Loss: 0.3633902 Best vali loss: 0.3633902
	iters: 100, epoch: 3 | loss: 0.3775612
	speed: 0.0075s/iter; left time: 22.4151s
	iters: 200, epoch: 3 | loss: 0.8640880
	speed: 0.0036s/iter; left time: 10.3141s
	iters: 300, epoch: 3 | loss: 0.4839862
	speed: 0.0036s/iter; left time: 10.0519s
	iters: 400, epoch: 3 | loss: 0.4549306
	speed: 0.0034s/iter; left time: 9.2397s
	iters: 500, epoch: 3 | loss: 1.1171486
	speed: 0.0034s/iter; left time: 8.7582s
Updating learning rate to 0.00010908581165
Validation loss decreased (0.3634 --> 0.3479).  Saving model state dict ...
Epoch: 3 cost time: 1.8530356884002686
Epoch: 3, Steps: 514 | Train Loss: 0.6595429 Vali Loss: 0.3478999 Best vali loss: 0.3478999
	iters: 100, epoch: 4 | loss: 0.5570912
	speed: 0.0078s/iter; left time: 19.3802s
	iters: 200, epoch: 4 | loss: 0.4516259
	speed: 0.0035s/iter; left time: 8.3661s
	iters: 300, epoch: 4 | loss: 0.4915571
	speed: 0.0034s/iter; left time: 7.7883s
	iters: 400, epoch: 4 | loss: 0.6602010
	speed: 0.0036s/iter; left time: 7.9005s
	iters: 500, epoch: 4 | loss: 0.7187393
	speed: 0.0035s/iter; left time: 7.1889s
Updating learning rate to 5.4542905825e-05
Validation loss decreased (0.3479 --> 0.3422).  Saving model state dict ...
Epoch: 4 cost time: 1.862394094467163
Epoch: 4, Steps: 514 | Train Loss: 0.5758429 Vali Loss: 0.3421997 Best vali loss: 0.3421997
	iters: 100, epoch: 5 | loss: 0.5329666
	speed: 0.0077s/iter; left time: 15.0730s
	iters: 200, epoch: 5 | loss: 0.7201814
	speed: 0.0035s/iter; left time: 6.4611s
	iters: 300, epoch: 5 | loss: 0.4711480
	speed: 0.0034s/iter; left time: 6.0161s
	iters: 400, epoch: 5 | loss: 0.8100447
	speed: 0.0033s/iter; left time: 5.5197s
	iters: 500, epoch: 5 | loss: 0.5473301
	speed: 0.0034s/iter; left time: 5.2297s
Updating learning rate to 2.72714529125e-05
Epoch: 5 cost time: 1.8103077411651611
Epoch: 5, Steps: 514 | Train Loss: 0.6163341 Vali Loss: 0.3453681 Best vali loss: 0.3421997
	iters: 100, epoch: 6 | loss: 0.2882948
	speed: 0.0069s/iter; left time: 9.9639s
	iters: 200, epoch: 6 | loss: 0.4688409
	speed: 0.0031s/iter; left time: 4.1146s
	iters: 300, epoch: 6 | loss: 0.3448145
	speed: 0.0031s/iter; left time: 3.8607s
	iters: 400, epoch: 6 | loss: 0.7365089
	speed: 0.0031s/iter; left time: 3.5176s
	iters: 500, epoch: 6 | loss: 0.9512435
	speed: 0.0031s/iter; left time: 3.2050s
Updating learning rate to 1.363572645625e-05
Epoch: 6 cost time: 1.6184282302856445
Epoch: 6, Steps: 514 | Train Loss: 0.5579405 Vali Loss: 0.3435736 Best vali loss: 0.3421997
	iters: 100, epoch: 7 | loss: 0.3858021
	speed: 0.0075s/iter; left time: 6.9287s
	iters: 200, epoch: 7 | loss: 0.2908542
	speed: 0.0036s/iter; left time: 2.9762s
	iters: 300, epoch: 7 | loss: 0.3507099
	speed: 0.0036s/iter; left time: 2.6112s
	iters: 400, epoch: 7 | loss: 0.3925132
	speed: 0.0035s/iter; left time: 2.2254s
	iters: 500, epoch: 7 | loss: 0.7879826
	speed: 0.0034s/iter; left time: 1.8243s
Updating learning rate to 6.817863228125e-06
Validation loss decreased (0.3422 --> 0.3419).  Saving model state dict ...
Epoch: 7 cost time: 1.8597135543823242
Epoch: 7, Steps: 514 | Train Loss: 0.4415724 Vali Loss: 0.3419050 Best vali loss: 0.3419050
	iters: 100, epoch: 8 | loss: 0.3567672
	speed: 0.0076s/iter; left time: 3.1539s
	iters: 200, epoch: 8 | loss: 0.2237693
	speed: 0.0034s/iter; left time: 1.0852s
	iters: 300, epoch: 8 | loss: 0.3601606
	speed: 0.0034s/iter; left time: 0.7391s
	iters: 400, epoch: 8 | loss: 0.4261979
	speed: 0.0035s/iter; left time: 0.3975s
	iters: 500, epoch: 8 | loss: 0.2423017
	speed: 0.0035s/iter; left time: 0.0525s
Updating learning rate to 3.4089316140625e-06
Epoch: 8 cost time: 1.822767734527588
Epoch: 8, Steps: 514 | Train Loss: 0.3218393 Vali Loss: 0.3435933 Best vali loss: 0.3419050

best validation loss 0.34190503277455425

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0011192188358, 'e_layers': 1, 'learning_rate': 0.0010271871033, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3492165
	speed: 0.0087s/iter; left time: 34.8761s
	iters: 200, epoch: 1 | loss: 0.4378837
	speed: 0.0025s/iter; left time: 9.6414s
	iters: 300, epoch: 1 | loss: 1.3770396
	speed: 0.0026s/iter; left time: 10.0928s
	iters: 400, epoch: 1 | loss: 0.9168658
	speed: 0.0027s/iter; left time: 9.9173s
	iters: 500, epoch: 1 | loss: 0.6216083
	speed: 0.0026s/iter; left time: 9.4864s
Updating learning rate to 0.0010271871033
Validation loss decreased (inf --> 0.3648).  Saving model state dict ...
Epoch: 1 cost time: 1.6826066970825195
Epoch: 1, Steps: 514 | Train Loss: 0.7405228 Vali Loss: 0.3648312 Best vali loss: 0.3648312
	iters: 100, epoch: 2 | loss: 0.2995611
	speed: 0.0059s/iter; left time: 20.7017s
	iters: 200, epoch: 2 | loss: 0.6577647
	speed: 0.0025s/iter; left time: 8.5557s
	iters: 300, epoch: 2 | loss: 0.2609431
	speed: 0.0024s/iter; left time: 7.8626s
	iters: 400, epoch: 2 | loss: 0.6116143
	speed: 0.0024s/iter; left time: 7.6034s
	iters: 500, epoch: 2 | loss: 0.5082133
	speed: 0.0022s/iter; left time: 6.9184s
Updating learning rate to 0.00051359355165
Epoch: 2 cost time: 1.273184061050415
Epoch: 2, Steps: 514 | Train Loss: 0.4676193 Vali Loss: 0.3690295 Best vali loss: 0.3648312
	iters: 100, epoch: 3 | loss: 0.6220772
	speed: 0.0056s/iter; left time: 16.6214s
	iters: 200, epoch: 3 | loss: 0.3732550
	speed: 0.0023s/iter; left time: 6.5494s
	iters: 300, epoch: 3 | loss: 0.4963664
	speed: 0.0023s/iter; left time: 6.4421s
	iters: 400, epoch: 3 | loss: 0.3969337
	speed: 0.0024s/iter; left time: 6.3423s
	iters: 500, epoch: 3 | loss: 0.5217847
	speed: 0.0024s/iter; left time: 6.0944s
Updating learning rate to 0.000256796775825
Epoch: 3 cost time: 1.238407850265503
Epoch: 3, Steps: 514 | Train Loss: 0.4820834 Vali Loss: 0.3810547 Best vali loss: 0.3648312

best validation loss 0.36483115115896425

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.006603233031, 'e_layers': 2, 'learning_rate': 0.000685001466, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000685001466
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 0.662653923034668
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3709819 Best vali loss: 0.3709819
Updating learning rate to 0.000342500733
Validation loss decreased (0.3710 --> 0.3680).  Saving model state dict ...
Epoch: 2 cost time: 0.3571963310241699
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3680109 Best vali loss: 0.3680109
Updating learning rate to 0.0001712503665
Validation loss decreased (0.3680 --> 0.3670).  Saving model state dict ...
Epoch: 3 cost time: 0.35344815254211426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3670118 Best vali loss: 0.3670118

best validation loss 0.36701182713677233

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008084437654, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4837444
	speed: 0.0134s/iter; left time: 26.2530s
	iters: 200, epoch: 1 | loss: 0.5854552
	speed: 0.0073s/iter; left time: 13.4861s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.3763).  Saving model state dict ...
Epoch: 1 cost time: 2.219012498855591
Epoch: 1, Steps: 257 | Train Loss: 0.5345998 Vali Loss: 0.3763058 Best vali loss: 0.3763058
	iters: 100, epoch: 2 | loss: 0.5501842
	speed: 0.0150s/iter; left time: 25.5520s
	iters: 200, epoch: 2 | loss: 0.7510089
	speed: 0.0070s/iter; left time: 11.2796s
Updating learning rate to 0.0001652515671
Validation loss decreased (0.3763 --> 0.3751).  Saving model state dict ...
Epoch: 2 cost time: 1.8551061153411865
Epoch: 2, Steps: 257 | Train Loss: 0.6505965 Vali Loss: 0.3751421 Best vali loss: 0.3751421
	iters: 100, epoch: 3 | loss: 0.6258379
	speed: 0.0152s/iter; left time: 21.8974s
	iters: 200, epoch: 3 | loss: 0.6998730
	speed: 0.0071s/iter; left time: 9.5280s
Updating learning rate to 8.262578355e-05
Validation loss decreased (0.3751 --> 0.3739).  Saving model state dict ...
Epoch: 3 cost time: 1.8554444313049316
Epoch: 3, Steps: 257 | Train Loss: 0.6628554 Vali Loss: 0.3738979 Best vali loss: 0.3738979

best validation loss 0.3738979385386281

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0011192188358, 'e_layers': 1, 'learning_rate': 0.0010271871033, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2864904
	speed: 0.0088s/iter; left time: 21.6436s
	iters: 200, epoch: 4 | loss: 0.4481282
	speed: 0.0024s/iter; left time: 5.6938s
	iters: 300, epoch: 4 | loss: 1.1191505
	speed: 0.0024s/iter; left time: 5.4570s
	iters: 400, epoch: 4 | loss: 0.9448302
	speed: 0.0024s/iter; left time: 5.1903s
	iters: 500, epoch: 4 | loss: 0.5168546
	speed: 0.0024s/iter; left time: 4.9247s
Updating learning rate to 0.0001283983879125
Epoch: 4 cost time: 1.6033031940460205
Epoch: 4, Steps: 514 | Train Loss: 0.6630908 Vali Loss: 0.3734352 Best vali loss: 0.3648312
	iters: 100, epoch: 5 | loss: 0.3041486
	speed: 0.0058s/iter; left time: 11.2680s
	iters: 200, epoch: 5 | loss: 0.6727147
	speed: 0.0023s/iter; left time: 4.3636s
	iters: 300, epoch: 5 | loss: 0.2388736
	speed: 0.0023s/iter; left time: 4.1249s
	iters: 400, epoch: 5 | loss: 0.5544571
	speed: 0.0024s/iter; left time: 3.9555s
	iters: 500, epoch: 5 | loss: 0.5023402
	speed: 0.0023s/iter; left time: 3.6193s
Updating learning rate to 6.419919395625e-05
Epoch: 5 cost time: 1.2531940937042236
Epoch: 5, Steps: 514 | Train Loss: 0.4545068 Vali Loss: 0.3746885 Best vali loss: 0.3648312
	iters: 100, epoch: 6 | loss: 0.5620192
	speed: 0.0056s/iter; left time: 8.0701s
	iters: 200, epoch: 6 | loss: 0.3758415
	speed: 0.0022s/iter; left time: 3.0089s
	iters: 300, epoch: 6 | loss: 0.4898442
	speed: 0.0023s/iter; left time: 2.8522s
	iters: 400, epoch: 6 | loss: 0.3860356
	speed: 0.0023s/iter; left time: 2.6801s
	iters: 500, epoch: 6 | loss: 0.4911553
	speed: 0.0023s/iter; left time: 2.4444s
Updating learning rate to 3.2099596978125e-05
Epoch: 6 cost time: 1.227820873260498
Epoch: 6, Steps: 514 | Train Loss: 0.4609791 Vali Loss: 0.3789920 Best vali loss: 0.3648312
	iters: 100, epoch: 7 | loss: 0.2997920
	speed: 0.0057s/iter; left time: 5.2912s
	iters: 200, epoch: 7 | loss: 0.4515684
	speed: 0.0023s/iter; left time: 1.9476s
	iters: 300, epoch: 7 | loss: 0.5519226
	speed: 0.0024s/iter; left time: 1.7793s
	iters: 400, epoch: 7 | loss: 0.3529741
	speed: 0.0024s/iter; left time: 1.5242s
	iters: 500, epoch: 7 | loss: 0.5651116
	speed: 0.0024s/iter; left time: 1.2761s
Updating learning rate to 1.60497984890625e-05
Epoch: 7 cost time: 1.2664194107055664
Epoch: 7, Steps: 514 | Train Loss: 0.4442737 Vali Loss: 0.3775842 Best vali loss: 0.3648312
	iters: 100, epoch: 8 | loss: 0.5452436
	speed: 0.0059s/iter; left time: 2.4381s
	iters: 200, epoch: 8 | loss: 0.3152150
	speed: 0.0022s/iter; left time: 0.7050s
	iters: 300, epoch: 8 | loss: 0.6280402
	speed: 0.0022s/iter; left time: 0.4789s
	iters: 400, epoch: 8 | loss: 0.3529024
	speed: 0.0022s/iter; left time: 0.2527s
	iters: 500, epoch: 8 | loss: 1.0044031
	speed: 0.0023s/iter; left time: 0.0342s
Updating learning rate to 8.02489924453125e-06
Epoch: 8 cost time: 1.2168335914611816
Epoch: 8, Steps: 514 | Train Loss: 0.5691608 Vali Loss: 0.3772127 Best vali loss: 0.3648312

best validation loss 0.36483115115896425

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023082524013, 'e_layers': 3, 'learning_rate': 0.0004050671805, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6228834
	speed: 0.0106s/iter; left time: 42.4355s
	iters: 200, epoch: 1 | loss: 0.6631818
	speed: 0.0045s/iter; left time: 17.4330s
	iters: 300, epoch: 1 | loss: 0.2842658
	speed: 0.0045s/iter; left time: 17.0912s
	iters: 400, epoch: 1 | loss: 0.5658919
	speed: 0.0045s/iter; left time: 16.7218s
	iters: 500, epoch: 1 | loss: 1.1053489
	speed: 0.0045s/iter; left time: 16.2551s
Updating learning rate to 0.0004050671805
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 2.6446502208709717
Epoch: 1, Steps: 514 | Train Loss: 0.6483144 Vali Loss: 0.3696053 Best vali loss: 0.3696053
	iters: 100, epoch: 2 | loss: 0.3440944
	speed: 0.0087s/iter; left time: 30.4042s
	iters: 200, epoch: 2 | loss: 0.4881727
	speed: 0.0045s/iter; left time: 15.1666s
	iters: 300, epoch: 2 | loss: 0.3965946
	speed: 0.0043s/iter; left time: 14.2831s
	iters: 400, epoch: 2 | loss: 0.2825577
	speed: 0.0043s/iter; left time: 13.7753s
	iters: 500, epoch: 2 | loss: 0.2704095
	speed: 0.0044s/iter; left time: 13.5202s
Updating learning rate to 0.00020253359025
Epoch: 2 cost time: 2.2816293239593506
Epoch: 2, Steps: 514 | Train Loss: 0.3563658 Vali Loss: 0.3805444 Best vali loss: 0.3696053
	iters: 100, epoch: 3 | loss: 0.3823723
	speed: 0.0086s/iter; left time: 25.5562s
	iters: 200, epoch: 3 | loss: 0.9191468
	speed: 0.0043s/iter; left time: 12.4045s
	iters: 300, epoch: 3 | loss: 0.4163031
	speed: 0.0043s/iter; left time: 11.9343s
	iters: 400, epoch: 3 | loss: 0.6211088
	speed: 0.0044s/iter; left time: 11.7755s
	iters: 500, epoch: 3 | loss: 0.3810911
	speed: 0.0044s/iter; left time: 11.3554s
Updating learning rate to 0.000101266795125
Epoch: 3 cost time: 2.2691454887390137
Epoch: 3, Steps: 514 | Train Loss: 0.5440044 Vali Loss: 0.3739914 Best vali loss: 0.3696053
	iters: 100, epoch: 4 | loss: 1.1518902
	speed: 0.0087s/iter; left time: 21.5496s
	iters: 200, epoch: 4 | loss: 0.8627461
	speed: 0.0042s/iter; left time: 10.0733s
	iters: 300, epoch: 4 | loss: 0.4738800
	speed: 0.0042s/iter; left time: 9.6414s
	iters: 400, epoch: 4 | loss: 0.5099962
	speed: 0.0041s/iter; left time: 8.7973s
	iters: 500, epoch: 4 | loss: 0.6264294
	speed: 0.0040s/iter; left time: 8.2907s
Updating learning rate to 5.06333975625e-05
Validation loss decreased (0.3696 --> 0.3647).  Saving model state dict ...
Epoch: 4 cost time: 2.185703992843628
Epoch: 4, Steps: 514 | Train Loss: 0.7249884 Vali Loss: 0.3647445 Best vali loss: 0.3647445
	iters: 100, epoch: 5 | loss: 0.2140343
	speed: 0.0087s/iter; left time: 17.1215s
	iters: 200, epoch: 5 | loss: 0.2705850
	speed: 0.0040s/iter; left time: 7.3466s
	iters: 300, epoch: 5 | loss: 0.2807931
	speed: 0.0039s/iter; left time: 6.8706s
	iters: 400, epoch: 5 | loss: 0.5920945
	speed: 0.0039s/iter; left time: 6.4046s
	iters: 500, epoch: 5 | loss: 0.3770223
	speed: 0.0040s/iter; left time: 6.2970s
Updating learning rate to 2.531669878125e-05
Validation loss decreased (0.3647 --> 0.3558).  Saving model state dict ...
Epoch: 5 cost time: 2.0880696773529053
Epoch: 5, Steps: 514 | Train Loss: 0.3469059 Vali Loss: 0.3558022 Best vali loss: 0.3558022
	iters: 100, epoch: 6 | loss: 0.4837226
	speed: 0.0086s/iter; left time: 12.3767s
	iters: 200, epoch: 6 | loss: 0.5911509
	speed: 0.0041s/iter; left time: 5.5480s
	iters: 300, epoch: 6 | loss: 0.4437174
	speed: 0.0041s/iter; left time: 5.0637s
	iters: 400, epoch: 6 | loss: 1.2541630
	speed: 0.0041s/iter; left time: 4.6977s
	iters: 500, epoch: 6 | loss: 0.6503040
	speed: 0.0041s/iter; left time: 4.2337s
Updating learning rate to 1.2658349390625e-05
Epoch: 6 cost time: 2.1519887447357178
Epoch: 6, Steps: 514 | Train Loss: 0.6846116 Vali Loss: 0.3574320 Best vali loss: 0.3558022
	iters: 100, epoch: 7 | loss: 0.4709752
	speed: 0.0087s/iter; left time: 8.1136s
	iters: 200, epoch: 7 | loss: 0.5020878
	speed: 0.0044s/iter; left time: 3.6435s
	iters: 300, epoch: 7 | loss: 0.6185444
	speed: 0.0043s/iter; left time: 3.1369s
	iters: 400, epoch: 7 | loss: 0.6741056
	speed: 0.0043s/iter; left time: 2.6749s
	iters: 500, epoch: 7 | loss: 0.3667391
	speed: 0.0042s/iter; left time: 2.2247s
Updating learning rate to 6.3291746953125e-06
Validation loss decreased (0.3558 --> 0.3522).  Saving model state dict ...
Epoch: 7 cost time: 2.2560110092163086
Epoch: 7, Steps: 514 | Train Loss: 0.5264904 Vali Loss: 0.3521841 Best vali loss: 0.3521841
	iters: 100, epoch: 8 | loss: 0.4912809
	speed: 0.0088s/iter; left time: 3.6468s
	iters: 200, epoch: 8 | loss: 0.3488768
	speed: 0.0039s/iter; left time: 1.2406s
	iters: 300, epoch: 8 | loss: 0.6400518
	speed: 0.0039s/iter; left time: 0.8348s
	iters: 400, epoch: 8 | loss: 0.4364351
	speed: 0.0039s/iter; left time: 0.4519s
	iters: 500, epoch: 8 | loss: 0.4022913
	speed: 0.0039s/iter; left time: 0.0588s
Updating learning rate to 3.16458734765625e-06
Epoch: 8 cost time: 2.1125457286834717
Epoch: 8, Steps: 514 | Train Loss: 0.4637872 Vali Loss: 0.3530139 Best vali loss: 0.3521841

best validation loss 0.3521841197796093

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022189693868, 'e_layers': 3, 'learning_rate': 0.0003973416388, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2913113
	speed: 0.0106s/iter; left time: 42.6782s
	iters: 200, epoch: 1 | loss: 0.7563029
	speed: 0.0045s/iter; left time: 17.5224s
	iters: 300, epoch: 1 | loss: 0.7252127
	speed: 0.0046s/iter; left time: 17.7176s
	iters: 400, epoch: 1 | loss: 0.6709627
	speed: 0.0047s/iter; left time: 17.2961s
	iters: 500, epoch: 1 | loss: 0.6277535
	speed: 0.0046s/iter; left time: 16.4771s
Updating learning rate to 0.0003973416388
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 2.705653190612793
Epoch: 1, Steps: 514 | Train Loss: 0.6143086 Vali Loss: 0.3756518 Best vali loss: 0.3756518
	iters: 100, epoch: 2 | loss: 0.6750577
	speed: 0.0093s/iter; left time: 32.4680s
	iters: 200, epoch: 2 | loss: 0.4552696
	speed: 0.0042s/iter; left time: 14.2420s
	iters: 300, epoch: 2 | loss: 0.3489684
	speed: 0.0042s/iter; left time: 13.8101s
	iters: 400, epoch: 2 | loss: 0.3941739
	speed: 0.0042s/iter; left time: 13.3384s
	iters: 500, epoch: 2 | loss: 0.7832780
	speed: 0.0042s/iter; left time: 12.8815s
Updating learning rate to 0.0001986708194
Epoch: 2 cost time: 2.197852849960327
Epoch: 2, Steps: 514 | Train Loss: 0.5313495 Vali Loss: 0.3998150 Best vali loss: 0.3756518
	iters: 100, epoch: 3 | loss: 0.3243263
	speed: 0.0087s/iter; left time: 26.0099s
	iters: 200, epoch: 3 | loss: 0.2427649
	speed: 0.0041s/iter; left time: 11.8858s
	iters: 300, epoch: 3 | loss: 0.8666938
	speed: 0.0041s/iter; left time: 11.4481s
	iters: 400, epoch: 3 | loss: 0.3019815
	speed: 0.0041s/iter; left time: 11.0353s
	iters: 500, epoch: 3 | loss: 0.6068335
	speed: 0.0042s/iter; left time: 10.7505s
Updating learning rate to 9.93354097e-05
Epoch: 3 cost time: 2.1680755615234375
Epoch: 3, Steps: 514 | Train Loss: 0.4685200 Vali Loss: 0.3852220 Best vali loss: 0.3756518
	iters: 100, epoch: 4 | loss: 1.2148473
	speed: 0.0092s/iter; left time: 22.6674s
	iters: 200, epoch: 4 | loss: 0.5927619
	speed: 0.0045s/iter; left time: 10.6246s
	iters: 300, epoch: 4 | loss: 0.7672120
	speed: 0.0045s/iter; left time: 10.1617s
	iters: 400, epoch: 4 | loss: 0.4096442
	speed: 0.0047s/iter; left time: 10.1589s
	iters: 500, epoch: 4 | loss: 1.3297683
	speed: 0.0046s/iter; left time: 9.5998s
Updating learning rate to 4.966770485e-05
Epoch: 4 cost time: 2.3884265422821045
Epoch: 4, Steps: 514 | Train Loss: 0.8628468 Vali Loss: 0.3811008 Best vali loss: 0.3756518
	iters: 100, epoch: 5 | loss: 1.5279013
	speed: 0.0091s/iter; left time: 17.8328s
	iters: 200, epoch: 5 | loss: 0.3149410
	speed: 0.0043s/iter; left time: 7.9600s
	iters: 300, epoch: 5 | loss: 0.4587609
	speed: 0.0043s/iter; left time: 7.5258s
	iters: 400, epoch: 5 | loss: 0.6502596
	speed: 0.0045s/iter; left time: 7.4377s
	iters: 500, epoch: 5 | loss: 0.4119455
	speed: 0.0046s/iter; left time: 7.1445s
Updating learning rate to 2.4833852425e-05
Validation loss decreased (0.3757 --> 0.3720).  Saving model state dict ...
Epoch: 5 cost time: 2.304570198059082
Epoch: 5, Steps: 514 | Train Loss: 0.6727617 Vali Loss: 0.3719845 Best vali loss: 0.3719845
	iters: 100, epoch: 6 | loss: 0.9164956
	speed: 0.0096s/iter; left time: 13.8632s
	iters: 200, epoch: 6 | loss: 0.8282945
	speed: 0.0042s/iter; left time: 5.6428s
	iters: 300, epoch: 6 | loss: 0.5063964
	speed: 0.0044s/iter; left time: 5.4264s
	iters: 400, epoch: 6 | loss: 0.6702748
	speed: 0.0043s/iter; left time: 4.9331s
	iters: 500, epoch: 6 | loss: 0.3681830
	speed: 0.0045s/iter; left time: 4.6912s
Updating learning rate to 1.24169262125e-05
Epoch: 6 cost time: 2.275848627090454
Epoch: 6, Steps: 514 | Train Loss: 0.6579289 Vali Loss: 0.3727506 Best vali loss: 0.3719845
	iters: 100, epoch: 7 | loss: 1.1646539
	speed: 0.0090s/iter; left time: 8.4000s
	iters: 200, epoch: 7 | loss: 0.3084857
	speed: 0.0044s/iter; left time: 3.6869s
	iters: 300, epoch: 7 | loss: 0.3359294
	speed: 0.0045s/iter; left time: 3.2902s
	iters: 400, epoch: 7 | loss: 0.3566431
	speed: 0.0046s/iter; left time: 2.8627s
	iters: 500, epoch: 7 | loss: 0.6783099
	speed: 0.0046s/iter; left time: 2.4313s
Updating learning rate to 6.20846310625e-06
Epoch: 7 cost time: 2.344428539276123
Epoch: 7, Steps: 514 | Train Loss: 0.5688044 Vali Loss: 0.3733705 Best vali loss: 0.3719845
	iters: 100, epoch: 8 | loss: 0.3851181
	speed: 0.0093s/iter; left time: 3.8502s
	iters: 200, epoch: 8 | loss: 1.0396651
	speed: 0.0046s/iter; left time: 1.4340s
	iters: 300, epoch: 8 | loss: 0.4153527
	speed: 0.0046s/iter; left time: 0.9815s
	iters: 400, epoch: 8 | loss: 0.6427463
	speed: 0.0045s/iter; left time: 0.5130s
	iters: 500, epoch: 8 | loss: 0.6053374
	speed: 0.0045s/iter; left time: 0.0672s
Updating learning rate to 3.104231553125e-06
Validation loss decreased (0.3720 --> 0.3714).  Saving model state dict ...
Epoch: 8 cost time: 2.3566784858703613
Epoch: 8, Steps: 514 | Train Loss: 0.6176439 Vali Loss: 0.3714291 Best vali loss: 0.3714291

best validation loss 0.3714290504722558

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022205518906, 'e_layers': 2, 'learning_rate': 0.0006775661709, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8058013
	speed: 0.0097s/iter; left time: 39.1027s
	iters: 200, epoch: 1 | loss: 0.6153644
	speed: 0.0035s/iter; left time: 13.7075s
	iters: 300, epoch: 1 | loss: 0.4206043
	speed: 0.0035s/iter; left time: 13.5011s
	iters: 400, epoch: 1 | loss: 0.4902029
	speed: 0.0035s/iter; left time: 13.1341s
	iters: 500, epoch: 1 | loss: 1.1934586
	speed: 0.0036s/iter; left time: 13.1160s
Updating learning rate to 0.0006775661709
Validation loss decreased (inf --> 0.3832).  Saving model state dict ...
Epoch: 1 cost time: 2.180814504623413
Epoch: 1, Steps: 514 | Train Loss: 0.7050863 Vali Loss: 0.3831982 Best vali loss: 0.3831982
	iters: 100, epoch: 2 | loss: 0.3900743
	speed: 0.0079s/iter; left time: 27.6738s
	iters: 200, epoch: 2 | loss: 0.3687337
	speed: 0.0036s/iter; left time: 12.3428s
	iters: 300, epoch: 2 | loss: 0.4712231
	speed: 0.0036s/iter; left time: 11.8998s
	iters: 400, epoch: 2 | loss: 0.4012980
	speed: 0.0034s/iter; left time: 10.9439s
	iters: 500, epoch: 2 | loss: 0.9885346
	speed: 0.0034s/iter; left time: 10.6194s
Updating learning rate to 0.00033878308545
Validation loss decreased (0.3832 --> 0.3708).  Saving model state dict ...
Epoch: 2 cost time: 1.861579179763794
Epoch: 2, Steps: 514 | Train Loss: 0.5239727 Vali Loss: 0.3707696 Best vali loss: 0.3707696
	iters: 100, epoch: 3 | loss: 0.5854961
	speed: 0.0080s/iter; left time: 23.9761s
	iters: 200, epoch: 3 | loss: 0.3189926
	speed: 0.0037s/iter; left time: 10.6003s
	iters: 300, epoch: 3 | loss: 0.4509457
	speed: 0.0036s/iter; left time: 10.1121s
	iters: 400, epoch: 3 | loss: 1.4563322
	speed: 0.0034s/iter; left time: 9.0595s
	iters: 500, epoch: 3 | loss: 0.4277233
	speed: 0.0033s/iter; left time: 8.5477s
Updating learning rate to 0.000169391542725
Epoch: 3 cost time: 1.855421543121338
Epoch: 3, Steps: 514 | Train Loss: 0.6478980 Vali Loss: 0.3863887 Best vali loss: 0.3707696

best validation loss 0.3707695981725494

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0051375567058, 'e_layers': 3, 'learning_rate': 0.0049571431139, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7357646
	speed: 0.0114s/iter; left time: 10.6447s
Updating learning rate to 0.0049571431139
Validation loss decreased (inf --> 0.3747).  Saving model state dict ...
Epoch: 1 cost time: 1.007859468460083
Epoch: 1, Steps: 129 | Train Loss: 0.7357646 Vali Loss: 0.3747125 Best vali loss: 0.3747125
	iters: 100, epoch: 2 | loss: 0.6398032
	speed: 0.0080s/iter; left time: 6.4535s
Updating learning rate to 0.00247857155695
Epoch: 2 cost time: 0.645798921585083
Epoch: 2, Steps: 129 | Train Loss: 0.6398032 Vali Loss: 0.4029218 Best vali loss: 0.3747125
	iters: 100, epoch: 3 | loss: 0.4463080
	speed: 0.0081s/iter; left time: 5.4351s
Updating learning rate to 0.001239285778475
Epoch: 3 cost time: 0.6758360862731934
Epoch: 3, Steps: 129 | Train Loss: 0.4463080 Vali Loss: 0.3876929 Best vali loss: 0.3747125

best validation loss 0.374712462673487

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022814819786, 'e_layers': 4, 'learning_rate': 0.0007049541386, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006781234193058324
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 1.1143438816070557
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3666486 Best vali loss: 0.3666486
Updating learning rate to 0.0006017159952147906
Validation loss decreased (0.3666 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 0.7950265407562256
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3642036 Best vali loss: 0.3642036
Updating learning rate to 0.00048736420400971164
Epoch: 3 cost time: 0.7858724594116211
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3708119 Best vali loss: 0.3642036

best validation loss 0.36420360084601144

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022814819786, 'e_layers': 4, 'learning_rate': 0.0007049541386, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0003524770693
Validation loss decreased (0.3642 --> 0.3497).  Saving model state dict ...
Epoch: 4 cost time: 1.1059491634368896
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3497355 Best vali loss: 0.3497355
Updating learning rate to 0.0002175899345902884
Epoch: 5 cost time: 0.7901158332824707
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3683891 Best vali loss: 0.3497355
Updating learning rate to 0.00010323814338520938
Validation loss decreased (0.3497 --> 0.3459).  Saving model state dict ...
Epoch: 6 cost time: 0.7945902347564697
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3458901 Best vali loss: 0.3458901
Updating learning rate to 2.6830719294167582e-05
Epoch: 7 cost time: 0.791996955871582
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3498342 Best vali loss: 0.3458901
Updating learning rate to 0.0
Epoch: 8 cost time: 0.790252685546875
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3542316 Best vali loss: 0.3458901

best validation loss 0.34589011386944407

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0090135192123, 'e_layers': 3, 'learning_rate': 8.51017431e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7621236
	speed: 0.0106s/iter; left time: 42.4822s
	iters: 200, epoch: 1 | loss: 0.4582544
	speed: 0.0039s/iter; left time: 15.4153s
	iters: 300, epoch: 1 | loss: 0.8032402
	speed: 0.0043s/iter; left time: 16.4951s
	iters: 400, epoch: 1 | loss: 0.4664219
	speed: 0.0045s/iter; left time: 16.5691s
	iters: 500, epoch: 1 | loss: 0.8831819
	speed: 0.0039s/iter; left time: 14.1644s
Updating learning rate to 8.51017431e-05
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 2.501408815383911
Epoch: 1, Steps: 514 | Train Loss: 0.6746444 Vali Loss: 0.3650034 Best vali loss: 0.3650034
	iters: 100, epoch: 2 | loss: 0.4853269
	speed: 0.0084s/iter; left time: 29.3801s
	iters: 200, epoch: 2 | loss: 0.3419903
	speed: 0.0039s/iter; left time: 13.2069s
	iters: 300, epoch: 2 | loss: 0.3630709
	speed: 0.0039s/iter; left time: 13.0096s
	iters: 400, epoch: 2 | loss: 1.1534981
	speed: 0.0039s/iter; left time: 12.6058s
	iters: 500, epoch: 2 | loss: 0.7061661
	speed: 0.0039s/iter; left time: 12.2012s
Updating learning rate to 4.255087155e-05
Validation loss decreased (0.3650 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 2.0689358711242676
Epoch: 2, Steps: 514 | Train Loss: 0.6100105 Vali Loss: 0.3648333 Best vali loss: 0.3648333
	iters: 100, epoch: 3 | loss: 0.4372351
	speed: 0.0084s/iter; left time: 25.1259s
	iters: 200, epoch: 3 | loss: 0.3660254
	speed: 0.0040s/iter; left time: 11.4258s
	iters: 300, epoch: 3 | loss: 0.5252497
	speed: 0.0038s/iter; left time: 10.6371s
	iters: 400, epoch: 3 | loss: 0.4705439
	speed: 0.0038s/iter; left time: 10.2686s
	iters: 500, epoch: 3 | loss: 0.2826092
	speed: 0.0037s/iter; left time: 9.5053s
Updating learning rate to 2.1275435775e-05
Epoch: 3 cost time: 2.0189602375030518
Epoch: 3, Steps: 514 | Train Loss: 0.4163327 Vali Loss: 0.3694200 Best vali loss: 0.3648333
	iters: 100, epoch: 4 | loss: 0.3676541
	speed: 0.0087s/iter; left time: 21.5307s
	iters: 200, epoch: 4 | loss: 0.5549375
	speed: 0.0044s/iter; left time: 10.4040s
	iters: 300, epoch: 4 | loss: 0.5397451
	speed: 0.0045s/iter; left time: 10.2309s
	iters: 400, epoch: 4 | loss: 0.3012275
	speed: 0.0044s/iter; left time: 9.5081s
	iters: 500, epoch: 4 | loss: 0.8313000
	speed: 0.0043s/iter; left time: 8.9317s
Updating learning rate to 1.06377178875e-05
Epoch: 4 cost time: 2.307882308959961
Epoch: 4, Steps: 514 | Train Loss: 0.5189728 Vali Loss: 0.3679737 Best vali loss: 0.3648333
	iters: 100, epoch: 5 | loss: 0.9225854
	speed: 0.0090s/iter; left time: 17.6225s
	iters: 200, epoch: 5 | loss: 0.4786051
	speed: 0.0044s/iter; left time: 8.0815s
	iters: 300, epoch: 5 | loss: 0.5461619
	speed: 0.0044s/iter; left time: 7.7318s
	iters: 400, epoch: 5 | loss: 0.4994313
	speed: 0.0045s/iter; left time: 7.4466s
	iters: 500, epoch: 5 | loss: 0.7811388
	speed: 0.0045s/iter; left time: 7.0597s
Updating learning rate to 5.31885894375e-06
Epoch: 5 cost time: 2.3388512134552
Epoch: 5, Steps: 514 | Train Loss: 0.6455845 Vali Loss: 0.3718838 Best vali loss: 0.3648333
	iters: 100, epoch: 6 | loss: 0.9419976
	speed: 0.0086s/iter; left time: 12.4485s
	iters: 200, epoch: 6 | loss: 0.8596271
	speed: 0.0037s/iter; left time: 5.0304s
	iters: 300, epoch: 6 | loss: 0.9404294
	speed: 0.0037s/iter; left time: 4.6478s
	iters: 400, epoch: 6 | loss: 0.4483937
	speed: 0.0037s/iter; left time: 4.2103s
	iters: 500, epoch: 6 | loss: 0.2849830
	speed: 0.0040s/iter; left time: 4.1948s
Updating learning rate to 2.659429471875e-06
Epoch: 6 cost time: 2.0315330028533936
Epoch: 6, Steps: 514 | Train Loss: 0.6950862 Vali Loss: 0.3747106 Best vali loss: 0.3648333
	iters: 100, epoch: 7 | loss: 0.9818597
	speed: 0.0079s/iter; left time: 7.3572s
	iters: 200, epoch: 7 | loss: 0.5251414
	speed: 0.0037s/iter; left time: 3.0835s
	iters: 300, epoch: 7 | loss: 0.2098253
	speed: 0.0038s/iter; left time: 2.7635s
	iters: 400, epoch: 7 | loss: 0.3555917
	speed: 0.0040s/iter; left time: 2.5157s
	iters: 500, epoch: 7 | loss: 0.6351803
	speed: 0.0040s/iter; left time: 2.1163s
Updating learning rate to 1.3297147359375e-06
Epoch: 7 cost time: 2.027594804763794
Epoch: 7, Steps: 514 | Train Loss: 0.5415197 Vali Loss: 0.3741889 Best vali loss: 0.3648333
	iters: 100, epoch: 8 | loss: 0.3329037
	speed: 0.0080s/iter; left time: 3.3019s
	iters: 200, epoch: 8 | loss: 0.3124288
	speed: 0.0038s/iter; left time: 1.2068s
	iters: 300, epoch: 8 | loss: 0.2945926
	speed: 0.0038s/iter; left time: 0.8214s
	iters: 400, epoch: 8 | loss: 0.7927182
	speed: 0.0038s/iter; left time: 0.4411s
	iters: 500, epoch: 8 | loss: 0.4542066
	speed: 0.0038s/iter; left time: 0.0573s
Updating learning rate to 6.6485736796875e-07
Epoch: 8 cost time: 2.000041961669922
Epoch: 8, Steps: 514 | Train Loss: 0.4373700 Vali Loss: 0.3751748 Best vali loss: 0.3648333

best validation loss 0.3648332605661718

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022211394199, 'e_layers': 2, 'learning_rate': 0.0004153530071, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4273506
	speed: 0.0095s/iter; left time: 38.0320s
	iters: 200, epoch: 1 | loss: 1.0791413
	speed: 0.0032s/iter; left time: 12.3454s
	iters: 300, epoch: 1 | loss: 1.0136926
	speed: 0.0031s/iter; left time: 11.8414s
	iters: 400, epoch: 1 | loss: 0.5040758
	speed: 0.0031s/iter; left time: 11.6679s
	iters: 500, epoch: 1 | loss: 1.1492423
	speed: 0.0031s/iter; left time: 11.3650s
Updating learning rate to 0.00039954457456335257
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 1.9677116870880127
Epoch: 1, Steps: 514 | Train Loss: 0.8347005 Vali Loss: 0.3725226 Best vali loss: 0.3725226
	iters: 100, epoch: 2 | loss: 0.3891107
	speed: 0.0070s/iter; left time: 24.6520s
	iters: 200, epoch: 2 | loss: 0.2791889
	speed: 0.0030s/iter; left time: 10.1781s
	iters: 300, epoch: 2 | loss: 0.4993372
	speed: 0.0030s/iter; left time: 9.9759s
	iters: 400, epoch: 2 | loss: 0.3950434
	speed: 0.0030s/iter; left time: 9.5383s
	iters: 500, epoch: 2 | loss: 0.6183698
	speed: 0.0030s/iter; left time: 9.2403s
Updating learning rate to 0.00035452596750331706
Epoch: 2 cost time: 1.615192174911499
Epoch: 2, Steps: 514 | Train Loss: 0.4362100 Vali Loss: 0.3918458 Best vali loss: 0.3725226
	iters: 100, epoch: 3 | loss: 0.3716750
	speed: 0.0069s/iter; left time: 20.5791s
	iters: 200, epoch: 3 | loss: 0.9329367
	speed: 0.0031s/iter; left time: 8.9762s
	iters: 300, epoch: 3 | loss: 0.4990104
	speed: 0.0031s/iter; left time: 8.5390s
	iters: 400, epoch: 3 | loss: 0.4751129
	speed: 0.0031s/iter; left time: 8.1932s
	iters: 500, epoch: 3 | loss: 1.0945622
	speed: 0.0032s/iter; left time: 8.3353s
Updating learning rate to 0.00028715086075009475
Validation loss decreased (0.3725 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 1.6424505710601807
Epoch: 3, Steps: 514 | Train Loss: 0.6746594 Vali Loss: 0.3677160 Best vali loss: 0.3677160
	iters: 100, epoch: 4 | loss: 0.5596181
	speed: 0.0069s/iter; left time: 17.1151s
	iters: 200, epoch: 4 | loss: 0.4691971
	speed: 0.0031s/iter; left time: 7.4539s
	iters: 300, epoch: 4 | loss: 0.5037670
	speed: 0.0031s/iter; left time: 7.0743s
	iters: 400, epoch: 4 | loss: 0.6726620
	speed: 0.0032s/iter; left time: 6.8443s
	iters: 500, epoch: 4 | loss: 0.6866380
	speed: 0.0031s/iter; left time: 6.3528s
Updating learning rate to 0.00020767650355
Validation loss decreased (0.3677 --> 0.3505).  Saving model state dict ...
Epoch: 4 cost time: 1.6406784057617188
Epoch: 4, Steps: 514 | Train Loss: 0.5783764 Vali Loss: 0.3504832 Best vali loss: 0.3504832
	iters: 100, epoch: 5 | loss: 0.5318645
	speed: 0.0070s/iter; left time: 13.6730s
	iters: 200, epoch: 5 | loss: 0.7055611
	speed: 0.0032s/iter; left time: 5.9736s
	iters: 300, epoch: 5 | loss: 0.4663729
	speed: 0.0031s/iter; left time: 5.4959s
	iters: 400, epoch: 5 | loss: 0.7448611
	speed: 0.0031s/iter; left time: 5.2019s
	iters: 500, epoch: 5 | loss: 0.5157172
	speed: 0.0031s/iter; left time: 4.8486s
Updating learning rate to 0.00012820214634990526
Epoch: 5 cost time: 1.661057949066162
Epoch: 5, Steps: 514 | Train Loss: 0.5928754 Vali Loss: 0.3574147 Best vali loss: 0.3504832
	iters: 100, epoch: 6 | loss: 0.2987968
	speed: 0.0072s/iter; left time: 10.4489s
	iters: 200, epoch: 6 | loss: 0.4706403
	speed: 0.0035s/iter; left time: 4.6530s
	iters: 300, epoch: 6 | loss: 0.3502028
	speed: 0.0034s/iter; left time: 4.2725s
	iters: 400, epoch: 6 | loss: 0.7284995
	speed: 0.0034s/iter; left time: 3.8958s
	iters: 500, epoch: 6 | loss: 0.8584011
	speed: 0.0034s/iter; left time: 3.5614s
Updating learning rate to 6.08270395966829e-05
Epoch: 6 cost time: 1.8119027614593506
Epoch: 6, Steps: 514 | Train Loss: 0.5413081 Vali Loss: 0.3673071 Best vali loss: 0.3504832
	iters: 100, epoch: 7 | loss: 0.3610388
	speed: 0.0074s/iter; left time: 6.8615s
	iters: 200, epoch: 7 | loss: 0.2875323
	speed: 0.0030s/iter; left time: 2.5032s
	iters: 300, epoch: 7 | loss: 0.3273665
	speed: 0.0030s/iter; left time: 2.1595s
	iters: 400, epoch: 7 | loss: 0.3483398
	speed: 0.0031s/iter; left time: 1.9416s
	iters: 500, epoch: 7 | loss: 0.6887623
	speed: 0.0030s/iter; left time: 1.5892s
Updating learning rate to 1.5808432536647417e-05
Epoch: 7 cost time: 1.6089389324188232
Epoch: 7, Steps: 514 | Train Loss: 0.4026080 Vali Loss: 0.3566208 Best vali loss: 0.3504832
	iters: 100, epoch: 8 | loss: 0.3338949
	speed: 0.0069s/iter; left time: 2.8570s
	iters: 200, epoch: 8 | loss: 0.2081094
	speed: 0.0030s/iter; left time: 0.9405s
	iters: 300, epoch: 8 | loss: 0.3173982
	speed: 0.0030s/iter; left time: 0.6399s
	iters: 400, epoch: 8 | loss: 0.3982822
	speed: 0.0030s/iter; left time: 0.3498s
	iters: 500, epoch: 8 | loss: 0.2003658
	speed: 0.0031s/iter; left time: 0.0463s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5999987125396729
Epoch: 8, Steps: 514 | Train Loss: 0.2916101 Vali Loss: 0.3602052 Best vali loss: 0.3504832

best validation loss 0.35048321693960016

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7217035
	speed: 0.0112s/iter; left time: 45.0429s
	iters: 200, epoch: 1 | loss: 0.8354638
	speed: 0.0049s/iter; left time: 19.3164s
	iters: 300, epoch: 1 | loss: 1.4158584
	speed: 0.0048s/iter; left time: 18.3913s
	iters: 400, epoch: 1 | loss: 0.3012427
	speed: 0.0050s/iter; left time: 18.4031s
	iters: 500, epoch: 1 | loss: 1.0098348
	speed: 0.0048s/iter; left time: 17.4295s
Updating learning rate to 0.0007074898879
Validation loss decreased (inf --> 0.4070).  Saving model state dict ...
Epoch: 1 cost time: 2.864372491836548
Epoch: 1, Steps: 514 | Train Loss: 0.8568206 Vali Loss: 0.4069790 Best vali loss: 0.4069790
	iters: 100, epoch: 2 | loss: 1.0180978
	speed: 0.0102s/iter; left time: 35.6237s
	iters: 200, epoch: 2 | loss: 1.0451591
	speed: 0.0050s/iter; left time: 16.9107s
	iters: 300, epoch: 2 | loss: 0.8875347
	speed: 0.0049s/iter; left time: 16.2905s
	iters: 400, epoch: 2 | loss: 0.8612419
	speed: 0.0050s/iter; left time: 15.8702s
	iters: 500, epoch: 2 | loss: 0.6186457
	speed: 0.0048s/iter; left time: 14.7911s
Updating learning rate to 0.00035374494395
Validation loss decreased (0.4070 --> 0.3988).  Saving model state dict ...
Epoch: 2 cost time: 2.582882881164551
Epoch: 2, Steps: 514 | Train Loss: 0.8861358 Vali Loss: 0.3987512 Best vali loss: 0.3987512
	iters: 100, epoch: 3 | loss: 0.3230282
	speed: 0.0103s/iter; left time: 30.8352s
	iters: 200, epoch: 3 | loss: 0.6203120
	speed: 0.0050s/iter; left time: 14.3918s
	iters: 300, epoch: 3 | loss: 0.5500021
	speed: 0.0049s/iter; left time: 13.6490s
	iters: 400, epoch: 3 | loss: 1.0605110
	speed: 0.0049s/iter; left time: 13.2583s
	iters: 500, epoch: 3 | loss: 0.4417934
	speed: 0.0050s/iter; left time: 12.9671s
Updating learning rate to 0.000176872471975
Validation loss decreased (0.3988 --> 0.3981).  Saving model state dict ...
Epoch: 3 cost time: 2.6043362617492676
Epoch: 3, Steps: 514 | Train Loss: 0.5991293 Vali Loss: 0.3980649 Best vali loss: 0.3980649

best validation loss 0.3980649488731077

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017762593232, 'e_layers': 3, 'learning_rate': 0.0008148510775, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7312499
	speed: 0.0122s/iter; left time: 11.3760s
Updating learning rate to 0.0008148510775
Validation loss decreased (inf --> 0.3804).  Saving model state dict ...
Epoch: 1 cost time: 1.101710557937622
Epoch: 1, Steps: 129 | Train Loss: 0.7312499 Vali Loss: 0.3804384 Best vali loss: 0.3804384
	iters: 100, epoch: 2 | loss: 0.6948329
	speed: 0.0095s/iter; left time: 7.6333s
Updating learning rate to 0.00040742553875
Epoch: 2 cost time: 0.7419743537902832
Epoch: 2, Steps: 129 | Train Loss: 0.6948329 Vali Loss: 0.3847120 Best vali loss: 0.3804384
	iters: 100, epoch: 3 | loss: 0.5889249
	speed: 0.0092s/iter; left time: 6.1839s
Updating learning rate to 0.000203712769375
Epoch: 3 cost time: 0.7333357334136963
Epoch: 3, Steps: 129 | Train Loss: 0.5889249 Vali Loss: 0.3816321 Best vali loss: 0.3804384

best validation loss 0.3804384267517532

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4272358
	speed: 0.0097s/iter; left time: 39.0165s
	iters: 200, epoch: 1 | loss: 1.0790846
	speed: 0.0033s/iter; left time: 12.8493s
	iters: 300, epoch: 1 | loss: 1.0137324
	speed: 0.0032s/iter; left time: 12.3534s
	iters: 400, epoch: 1 | loss: 0.5028310
	speed: 0.0031s/iter; left time: 11.6077s
	iters: 500, epoch: 1 | loss: 1.1683400
	speed: 0.0031s/iter; left time: 11.3675s
Updating learning rate to 0.0003957152226005332
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 2.016822576522827
Epoch: 1, Steps: 514 | Train Loss: 0.8382448 Vali Loss: 0.3697481 Best vali loss: 0.3697481
	iters: 100, epoch: 2 | loss: 0.3943497
	speed: 0.0074s/iter; left time: 25.8649s
	iters: 200, epoch: 2 | loss: 0.2686038
	speed: 0.0036s/iter; left time: 12.1624s
	iters: 300, epoch: 2 | loss: 0.4464475
	speed: 0.0036s/iter; left time: 11.8589s
	iters: 400, epoch: 2 | loss: 0.3957503
	speed: 0.0035s/iter; left time: 11.1580s
	iters: 500, epoch: 2 | loss: 0.6246468
	speed: 0.0036s/iter; left time: 11.0631s
Updating learning rate to 0.00035112808702649433
Validation loss decreased (0.3697 --> 0.3569).  Saving model state dict ...
Epoch: 2 cost time: 1.8680362701416016
Epoch: 2, Steps: 514 | Train Loss: 0.4259596 Vali Loss: 0.3568507 Best vali loss: 0.3568507
	iters: 100, epoch: 3 | loss: 0.3594458
	speed: 0.0073s/iter; left time: 21.9238s
	iters: 200, epoch: 3 | loss: 0.8871214
	speed: 0.0035s/iter; left time: 9.9773s
	iters: 300, epoch: 3 | loss: 0.4992565
	speed: 0.0033s/iter; left time: 9.0913s
	iters: 400, epoch: 3 | loss: 0.5152608
	speed: 0.0033s/iter; left time: 8.7373s
	iters: 500, epoch: 3 | loss: 1.0969328
	speed: 0.0033s/iter; left time: 8.4780s
Updating learning rate to 0.00028439872298564043
Epoch: 3 cost time: 1.7584664821624756
Epoch: 3, Steps: 514 | Train Loss: 0.6716034 Vali Loss: 0.3629181 Best vali loss: 0.3568507

best validation loss 0.3568507274148038

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3650688
	speed: 0.0100s/iter; left time: 24.5970s
	iters: 200, epoch: 4 | loss: 0.8733169
	speed: 0.0035s/iter; left time: 8.2566s
	iters: 300, epoch: 4 | loss: 0.7277410
	speed: 0.0035s/iter; left time: 8.0277s
	iters: 400, epoch: 4 | loss: 0.5149680
	speed: 0.0035s/iter; left time: 7.4948s
	iters: 500, epoch: 4 | loss: 0.4431130
	speed: 0.0033s/iter; left time: 6.9236s
Updating learning rate to 0.00020568607125
Validation loss decreased (0.3569 --> 0.3380).  Saving model state dict ...
Epoch: 4 cost time: 2.1335744857788086
Epoch: 4, Steps: 514 | Train Loss: 0.5848415 Vali Loss: 0.3380407 Best vali loss: 0.3380407
	iters: 100, epoch: 5 | loss: 0.3768367
	speed: 0.0074s/iter; left time: 14.4013s
	iters: 200, epoch: 5 | loss: 0.2401529
	speed: 0.0033s/iter; left time: 6.1304s
	iters: 300, epoch: 5 | loss: 0.3518924
	speed: 0.0033s/iter; left time: 5.8106s
	iters: 400, epoch: 5 | loss: 0.3825915
	speed: 0.0035s/iter; left time: 5.8304s
	iters: 500, epoch: 5 | loss: 0.5994959
	speed: 0.0034s/iter; left time: 5.3156s
Updating learning rate to 0.0001269734195143596
Epoch: 5 cost time: 1.792715072631836
Epoch: 5, Steps: 514 | Train Loss: 0.3901939 Vali Loss: 0.3423380 Best vali loss: 0.3380407
	iters: 100, epoch: 6 | loss: 0.2964022
	speed: 0.0071s/iter; left time: 10.2835s
	iters: 200, epoch: 6 | loss: 0.6415389
	speed: 0.0035s/iter; left time: 4.7268s
	iters: 300, epoch: 6 | loss: 0.3868399
	speed: 0.0035s/iter; left time: 4.3129s
	iters: 400, epoch: 6 | loss: 0.3942174
	speed: 0.0035s/iter; left time: 3.9485s
	iters: 500, epoch: 6 | loss: 0.8828110
	speed: 0.0035s/iter; left time: 3.6621s
Updating learning rate to 6.024405547350564e-05
Epoch: 6 cost time: 1.8240416049957275
Epoch: 6, Steps: 514 | Train Loss: 0.5203619 Vali Loss: 0.3579327 Best vali loss: 0.3380407
	iters: 100, epoch: 7 | loss: 0.4995606
	speed: 0.0069s/iter; left time: 6.4368s
	iters: 200, epoch: 7 | loss: 0.4167287
	speed: 0.0031s/iter; left time: 2.5514s
	iters: 300, epoch: 7 | loss: 0.3771772
	speed: 0.0031s/iter; left time: 2.2413s
	iters: 400, epoch: 7 | loss: 0.5763061
	speed: 0.0032s/iter; left time: 1.9824s
	iters: 500, epoch: 7 | loss: 0.5871175
	speed: 0.0031s/iter; left time: 1.6491s
Updating learning rate to 1.5656919899466785e-05
Epoch: 7 cost time: 1.6483745574951172
Epoch: 7, Steps: 514 | Train Loss: 0.4913780 Vali Loss: 0.3520686 Best vali loss: 0.3380407
	iters: 100, epoch: 8 | loss: 0.4632090
	speed: 0.0073s/iter; left time: 3.0253s
	iters: 200, epoch: 8 | loss: 0.5953825
	speed: 0.0031s/iter; left time: 0.9734s
	iters: 300, epoch: 8 | loss: 0.3734251
	speed: 0.0031s/iter; left time: 0.6645s
	iters: 400, epoch: 8 | loss: 0.5802858
	speed: 0.0031s/iter; left time: 0.3526s
	iters: 500, epoch: 8 | loss: 0.4502757
	speed: 0.0031s/iter; left time: 0.0466s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.640441656112671
Epoch: 8, Steps: 514 | Train Loss: 0.4925156 Vali Loss: 0.3559584 Best vali loss: 0.3380407

best validation loss 0.3380406815931933

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022176884584, 'e_layers': 2, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4268162
	speed: 0.0100s/iter; left time: 39.9522s
	iters: 200, epoch: 1 | loss: 1.0779593
	speed: 0.0033s/iter; left time: 12.9843s
	iters: 300, epoch: 1 | loss: 1.0150231
	speed: 0.0034s/iter; left time: 12.8092s
	iters: 400, epoch: 1 | loss: 0.5025977
	speed: 0.0031s/iter; left time: 11.4719s
	iters: 500, epoch: 1 | loss: 1.1514890
	speed: 0.0032s/iter; left time: 11.4933s
Updating learning rate to 0.0003789142607398986
Validation loss decreased (inf --> 0.3726).  Saving model state dict ...
Epoch: 1 cost time: 2.0492467880249023
Epoch: 1, Steps: 514 | Train Loss: 0.8347771 Vali Loss: 0.3725828 Best vali loss: 0.3725828
	iters: 100, epoch: 2 | loss: 0.3952245
	speed: 0.0070s/iter; left time: 24.6037s
	iters: 200, epoch: 2 | loss: 0.2685202
	speed: 0.0031s/iter; left time: 10.5240s
	iters: 300, epoch: 2 | loss: 0.4433817
	speed: 0.0031s/iter; left time: 10.2475s
	iters: 400, epoch: 2 | loss: 0.3860548
	speed: 0.0031s/iter; left time: 9.8005s
	iters: 500, epoch: 2 | loss: 0.6168451
	speed: 0.0031s/iter; left time: 9.4916s
Updating learning rate to 0.00033622017026867744
Validation loss decreased (0.3726 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 1.625072717666626
Epoch: 2, Steps: 514 | Train Loss: 0.4220053 Vali Loss: 0.3696873 Best vali loss: 0.3696873
	iters: 100, epoch: 3 | loss: 0.3926551
	speed: 0.0075s/iter; left time: 22.3343s
	iters: 200, epoch: 3 | loss: 0.8958112
	speed: 0.0034s/iter; left time: 9.6894s
	iters: 300, epoch: 3 | loss: 0.5096861
	speed: 0.0031s/iter; left time: 8.5310s
	iters: 400, epoch: 3 | loss: 0.4763315
	speed: 0.0030s/iter; left time: 8.1700s
	iters: 500, epoch: 3 | loss: 1.0466524
	speed: 0.0031s/iter; left time: 8.0029s
Updating learning rate to 0.00027232394843768623
Validation loss decreased (0.3697 --> 0.3402).  Saving model state dict ...
Epoch: 3 cost time: 1.6759121417999268
Epoch: 3, Steps: 514 | Train Loss: 0.6642273 Vali Loss: 0.3401555 Best vali loss: 0.3401555
	iters: 100, epoch: 4 | loss: 0.5531871
	speed: 0.0071s/iter; left time: 17.5920s
	iters: 200, epoch: 4 | loss: 0.4609011
	speed: 0.0030s/iter; left time: 7.2088s
	iters: 300, epoch: 4 | loss: 0.4876051
	speed: 0.0031s/iter; left time: 7.0679s
	iters: 400, epoch: 4 | loss: 0.6760938
	speed: 0.0030s/iter; left time: 6.4996s
	iters: 500, epoch: 4 | loss: 0.7087153
	speed: 0.0030s/iter; left time: 6.2242s
Updating learning rate to 0.0001969532158
Validation loss decreased (0.3402 --> 0.3386).  Saving model state dict ...
Epoch: 4 cost time: 1.618424654006958
Epoch: 4, Steps: 514 | Train Loss: 0.5773005 Vali Loss: 0.3385917 Best vali loss: 0.3385917
	iters: 100, epoch: 5 | loss: 0.5368750
	speed: 0.0068s/iter; left time: 13.3953s
	iters: 200, epoch: 5 | loss: 0.7203456
	speed: 0.0031s/iter; left time: 5.8188s
	iters: 300, epoch: 5 | loss: 0.4518319
	speed: 0.0031s/iter; left time: 5.5029s
	iters: 400, epoch: 5 | loss: 0.8007670
	speed: 0.0031s/iter; left time: 5.1697s
	iters: 500, epoch: 5 | loss: 0.5104478
	speed: 0.0032s/iter; left time: 4.9265s
Updating learning rate to 0.00012158248316231378
Epoch: 5 cost time: 1.6477060317993164
Epoch: 5, Steps: 514 | Train Loss: 0.6040535 Vali Loss: 0.3506840 Best vali loss: 0.3385917
	iters: 100, epoch: 6 | loss: 0.3044233
	speed: 0.0065s/iter; left time: 9.4205s
	iters: 200, epoch: 6 | loss: 0.4588274
	speed: 0.0029s/iter; left time: 3.9269s
	iters: 300, epoch: 6 | loss: 0.3740975
	speed: 0.0030s/iter; left time: 3.7803s
	iters: 400, epoch: 6 | loss: 0.7309641
	speed: 0.0033s/iter; left time: 3.7855s
	iters: 500, epoch: 6 | loss: 0.8694930
	speed: 0.0032s/iter; left time: 3.3635s
Updating learning rate to 5.768626133132254e-05
Epoch: 6 cost time: 1.6337554454803467
Epoch: 6, Steps: 514 | Train Loss: 0.5475610 Vali Loss: 0.3578174 Best vali loss: 0.3385917
	iters: 100, epoch: 7 | loss: 0.3759640
	speed: 0.0077s/iter; left time: 7.1828s
	iters: 200, epoch: 7 | loss: 0.2775554
	speed: 0.0035s/iter; left time: 2.9089s
	iters: 300, epoch: 7 | loss: 0.3277169
	speed: 0.0035s/iter; left time: 2.5422s
	iters: 400, epoch: 7 | loss: 0.3420688
	speed: 0.0032s/iter; left time: 1.9877s
	iters: 500, epoch: 7 | loss: 0.7090120
	speed: 0.0031s/iter; left time: 1.6538s
Updating learning rate to 1.4992170860101427e-05
Epoch: 7 cost time: 1.7902255058288574
Epoch: 7, Steps: 514 | Train Loss: 0.4064634 Vali Loss: 0.3463776 Best vali loss: 0.3385917
	iters: 100, epoch: 8 | loss: 0.3347262
	speed: 0.0073s/iter; left time: 3.0304s
	iters: 200, epoch: 8 | loss: 0.2144128
	speed: 0.0035s/iter; left time: 1.0976s
	iters: 300, epoch: 8 | loss: 0.3285846
	speed: 0.0034s/iter; left time: 0.7269s
	iters: 400, epoch: 8 | loss: 0.4205150
	speed: 0.0035s/iter; left time: 0.4068s
	iters: 500, epoch: 8 | loss: 0.2075243
	speed: 0.0035s/iter; left time: 0.0530s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.831265926361084
Epoch: 8, Steps: 514 | Train Loss: 0.3011526 Vali Loss: 0.3546237 Best vali loss: 0.3385917

best validation loss 0.3385917459349267

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.002223720073, 'e_layers': 2, 'learning_rate': 0.0004960252868, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7821524
	speed: 0.0098s/iter; left time: 39.2517s
	iters: 200, epoch: 1 | loss: 0.6088302
	speed: 0.0033s/iter; left time: 13.0964s
	iters: 300, epoch: 1 | loss: 0.4119774
	speed: 0.0032s/iter; left time: 12.3234s
	iters: 400, epoch: 1 | loss: 0.4999271
	speed: 0.0032s/iter; left time: 11.9532s
	iters: 500, epoch: 1 | loss: 1.1815050
	speed: 0.0032s/iter; left time: 11.6349s
Updating learning rate to 0.0004960252868
Validation loss decreased (inf --> 0.3906).  Saving model state dict ...
Epoch: 1 cost time: 2.04964542388916
Epoch: 1, Steps: 514 | Train Loss: 0.6968784 Vali Loss: 0.3906067 Best vali loss: 0.3906067
	iters: 100, epoch: 2 | loss: 0.5080766
	speed: 0.0075s/iter; left time: 26.0802s
	iters: 200, epoch: 2 | loss: 0.3852901
	speed: 0.0032s/iter; left time: 11.0210s
	iters: 300, epoch: 2 | loss: 0.4522902
	speed: 0.0031s/iter; left time: 10.3763s
	iters: 400, epoch: 2 | loss: 0.3951519
	speed: 0.0032s/iter; left time: 10.1967s
	iters: 500, epoch: 2 | loss: 1.0332133
	speed: 0.0032s/iter; left time: 9.8150s
Updating learning rate to 0.0002480126434
Validation loss decreased (0.3906 --> 0.3840).  Saving model state dict ...
Epoch: 2 cost time: 1.6954026222229004
Epoch: 2, Steps: 514 | Train Loss: 0.5548044 Vali Loss: 0.3840281 Best vali loss: 0.3840281
	iters: 100, epoch: 3 | loss: 0.5853724
	speed: 0.0080s/iter; left time: 23.8262s
	iters: 200, epoch: 3 | loss: 0.3160138
	speed: 0.0037s/iter; left time: 10.6634s
	iters: 300, epoch: 3 | loss: 0.4415871
	speed: 0.0037s/iter; left time: 10.2505s
	iters: 400, epoch: 3 | loss: 1.3637601
	speed: 0.0037s/iter; left time: 9.8767s
	iters: 500, epoch: 3 | loss: 0.3976985
	speed: 0.0037s/iter; left time: 9.5266s
Updating learning rate to 0.0001240063217
Validation loss decreased (0.3840 --> 0.3756).  Saving model state dict ...
Epoch: 3 cost time: 1.936337947845459
Epoch: 3, Steps: 514 | Train Loss: 0.6208864 Vali Loss: 0.3756193 Best vali loss: 0.3756193
	iters: 100, epoch: 4 | loss: 0.4391741
	speed: 0.0082s/iter; left time: 20.1971s
	iters: 200, epoch: 4 | loss: 0.4942225
	speed: 0.0035s/iter; left time: 8.2793s
	iters: 300, epoch: 4 | loss: 0.4214430
	speed: 0.0036s/iter; left time: 8.0930s
	iters: 400, epoch: 4 | loss: 0.7640763
	speed: 0.0037s/iter; left time: 8.0311s
	iters: 500, epoch: 4 | loss: 0.7145138
	speed: 0.0036s/iter; left time: 7.4761s
Updating learning rate to 6.200316085e-05
Epoch: 4 cost time: 1.893540859222412
Epoch: 4, Steps: 514 | Train Loss: 0.5666859 Vali Loss: 0.3824314 Best vali loss: 0.3756193
	iters: 100, epoch: 5 | loss: 0.3783730
	speed: 0.0074s/iter; left time: 14.4088s
	iters: 200, epoch: 5 | loss: 0.4992701
	speed: 0.0033s/iter; left time: 6.1085s
	iters: 300, epoch: 5 | loss: 0.4146885
	speed: 0.0033s/iter; left time: 5.7746s
	iters: 400, epoch: 5 | loss: 0.3055718
	speed: 0.0033s/iter; left time: 5.4572s
	iters: 500, epoch: 5 | loss: 0.8011161
	speed: 0.0033s/iter; left time: 5.1504s
Updating learning rate to 3.1001580425e-05
Epoch: 5 cost time: 1.7421600818634033
Epoch: 5, Steps: 514 | Train Loss: 0.4798039 Vali Loss: 0.3825637 Best vali loss: 0.3756193
	iters: 100, epoch: 6 | loss: 0.3503969
	speed: 0.0074s/iter; left time: 10.6941s
	iters: 200, epoch: 6 | loss: 0.3480504
	speed: 0.0033s/iter; left time: 4.4877s
	iters: 300, epoch: 6 | loss: 0.6389084
	speed: 0.0033s/iter; left time: 4.0473s
	iters: 400, epoch: 6 | loss: 0.6460864
	speed: 0.0032s/iter; left time: 3.6811s
	iters: 500, epoch: 6 | loss: 0.5741006
	speed: 0.0032s/iter; left time: 3.3253s
Updating learning rate to 1.55007902125e-05
Epoch: 6 cost time: 1.71760892868042
Epoch: 6, Steps: 514 | Train Loss: 0.5115085 Vali Loss: 0.3875503 Best vali loss: 0.3756193
	iters: 100, epoch: 7 | loss: 0.6861337
	speed: 0.0075s/iter; left time: 6.9440s
	iters: 200, epoch: 7 | loss: 0.3231225
	speed: 0.0035s/iter; left time: 2.8767s
	iters: 300, epoch: 7 | loss: 0.3485285
	speed: 0.0035s/iter; left time: 2.5516s
	iters: 400, epoch: 7 | loss: 1.1837387
	speed: 0.0034s/iter; left time: 2.1518s
	iters: 500, epoch: 7 | loss: 1.0454606
	speed: 0.0032s/iter; left time: 1.6775s
Updating learning rate to 7.75039510625e-06
Epoch: 7 cost time: 1.7857530117034912
Epoch: 7, Steps: 514 | Train Loss: 0.7173968 Vali Loss: 0.3854675 Best vali loss: 0.3756193
	iters: 100, epoch: 8 | loss: 0.5556072
	speed: 0.0071s/iter; left time: 2.9331s
	iters: 200, epoch: 8 | loss: 0.5998317
	speed: 0.0031s/iter; left time: 0.9668s
	iters: 300, epoch: 8 | loss: 0.5413018
	speed: 0.0033s/iter; left time: 0.6994s
	iters: 400, epoch: 8 | loss: 0.7028015
	speed: 0.0032s/iter; left time: 0.3649s
	iters: 500, epoch: 8 | loss: 0.2379382
	speed: 0.0031s/iter; left time: 0.0465s
Updating learning rate to 3.875197553125e-06
Epoch: 8 cost time: 1.6580843925476074
Epoch: 8, Steps: 514 | Train Loss: 0.5274961 Vali Loss: 0.3859821 Best vali loss: 0.3756193

best validation loss 0.37561931282223326

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0081844030406, 'e_layers': 2, 'learning_rate': 0.0013329674084, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6263548
	speed: 0.0096s/iter; left time: 18.8046s
	iters: 200, epoch: 1 | loss: 0.4925707
	speed: 0.0034s/iter; left time: 6.2458s
Updating learning rate to 0.0012822343572626868
Validation loss decreased (inf --> 0.3723).  Saving model state dict ...
Epoch: 1 cost time: 1.2119789123535156
Epoch: 1, Steps: 257 | Train Loss: 0.5594628 Vali Loss: 0.3723179 Best vali loss: 0.3723179
	iters: 100, epoch: 2 | loss: 0.5145752
	speed: 0.0078s/iter; left time: 13.2345s
	iters: 200, epoch: 2 | loss: 0.9156262
	speed: 0.0037s/iter; left time: 5.8767s
Updating learning rate to 0.001137758850990149
Epoch: 2 cost time: 0.9627387523651123
Epoch: 2, Steps: 257 | Train Loss: 0.7151007 Vali Loss: 0.3803324 Best vali loss: 0.3723179
	iters: 100, epoch: 3 | loss: 0.6495159
	speed: 0.0080s/iter; left time: 11.5664s
	iters: 200, epoch: 3 | loss: 0.4712016
	speed: 0.0037s/iter; left time: 4.9255s
Updating learning rate to 0.0009215359757386553
Epoch: 3 cost time: 0.9742045402526855
Epoch: 3, Steps: 257 | Train Loss: 0.5603587 Vali Loss: 0.3753136 Best vali loss: 0.3723179

best validation loss 0.3723178765745669

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021793505105, 'e_layers': 2, 'learning_rate': 0.0007321802993, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4494437
	speed: 0.0097s/iter; left time: 38.9234s
	iters: 200, epoch: 1 | loss: 1.0975496
	speed: 0.0033s/iter; left time: 12.8072s
	iters: 300, epoch: 1 | loss: 0.9943953
	speed: 0.0031s/iter; left time: 11.7981s
	iters: 400, epoch: 1 | loss: 0.5588862
	speed: 0.0031s/iter; left time: 11.5838s
	iters: 500, epoch: 1 | loss: 1.2715502
	speed: 0.0031s/iter; left time: 11.1435s
Updating learning rate to 0.000704313345965629
Validation loss decreased (inf --> 0.3826).  Saving model state dict ...
Epoch: 1 cost time: 2.0033743381500244
Epoch: 1, Steps: 514 | Train Loss: 0.8743650 Vali Loss: 0.3826133 Best vali loss: 0.3826133
	iters: 100, epoch: 2 | loss: 0.4051307
	speed: 0.0071s/iter; left time: 24.8356s
	iters: 200, epoch: 2 | loss: 0.2902835
	speed: 0.0032s/iter; left time: 10.8334s
	iters: 300, epoch: 2 | loss: 0.5488589
	speed: 0.0033s/iter; left time: 10.9320s
	iters: 400, epoch: 2 | loss: 0.4043742
	speed: 0.0032s/iter; left time: 10.3619s
	iters: 500, epoch: 2 | loss: 0.6164677
	speed: 0.0031s/iter; left time: 9.6332s
Updating learning rate to 0.000624954976993113
Validation loss decreased (0.3826 --> 0.3810).  Saving model state dict ...
Epoch: 2 cost time: 1.6993741989135742
Epoch: 2, Steps: 514 | Train Loss: 0.4530230 Vali Loss: 0.3809890 Best vali loss: 0.3809890
	iters: 100, epoch: 3 | loss: 0.4065875
	speed: 0.0078s/iter; left time: 23.2886s
	iters: 200, epoch: 3 | loss: 0.8573520
	speed: 0.0036s/iter; left time: 10.3097s
	iters: 300, epoch: 3 | loss: 0.5433034
	speed: 0.0036s/iter; left time: 9.9089s
	iters: 400, epoch: 3 | loss: 0.4832372
	speed: 0.0036s/iter; left time: 9.5425s
	iters: 500, epoch: 3 | loss: 1.2408187
	speed: 0.0036s/iter; left time: 9.1912s
Updating learning rate to 0.0005061867846731114
Validation loss decreased (0.3810 --> 0.3760).  Saving model state dict ...
Epoch: 3 cost time: 1.8778624534606934
Epoch: 3, Steps: 514 | Train Loss: 0.7062598 Vali Loss: 0.3759565 Best vali loss: 0.3759565

best validation loss 0.37595652807906477

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.095914363861084
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687493 Best vali loss: 0.3687493
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3687 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.780815839767456
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3620354 Best vali loss: 0.3620354
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3620 --> 0.3527).  Saving model state dict ...
Epoch: 3 cost time: 0.7822089195251465
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3526968 Best vali loss: 0.3526968

best validation loss 0.35269675026473923

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3527 --> 0.3472).  Saving model state dict ...
Epoch: 4 cost time: 1.0946455001831055
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3472173 Best vali loss: 0.3472173
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3472 --> 0.3397).  Saving model state dict ...
Epoch: 5 cost time: 0.7814955711364746
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3397240 Best vali loss: 0.3397240
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3397 --> 0.3374).  Saving model state dict ...
Epoch: 6 cost time: 0.7776317596435547
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3374226 Best vali loss: 0.3374226
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3374 --> 0.3367).  Saving model state dict ...
Epoch: 7 cost time: 0.7828123569488525
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3367117 Best vali loss: 0.3367117
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7768971920013428
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3399835 Best vali loss: 0.3367117

best validation loss 0.33671166648564965

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021942137147, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8049643
	speed: 0.0096s/iter; left time: 38.4697s
	iters: 200, epoch: 1 | loss: 0.3314548
	speed: 0.0035s/iter; left time: 13.6139s
	iters: 300, epoch: 1 | loss: 0.5315380
	speed: 0.0035s/iter; left time: 13.2247s
	iters: 400, epoch: 1 | loss: 1.0634489
	speed: 0.0034s/iter; left time: 12.7014s
	iters: 500, epoch: 1 | loss: 0.9194263
	speed: 0.0033s/iter; left time: 12.0592s
Updating learning rate to 0.00039412601865045424
Validation loss decreased (inf --> 0.3820).  Saving model state dict ...
Epoch: 1 cost time: 2.120285749435425
Epoch: 1, Steps: 514 | Train Loss: 0.7301665 Vali Loss: 0.3819646 Best vali loss: 0.3819646
	iters: 100, epoch: 2 | loss: 1.2355481
	speed: 0.0070s/iter; left time: 24.5886s
	iters: 200, epoch: 2 | loss: 0.7047356
	speed: 0.0030s/iter; left time: 10.2621s
	iters: 300, epoch: 2 | loss: 0.6968369
	speed: 0.0031s/iter; left time: 10.3293s
	iters: 400, epoch: 2 | loss: 0.7023545
	speed: 0.0030s/iter; left time: 9.5943s
	iters: 500, epoch: 2 | loss: 0.6865812
	speed: 0.0030s/iter; left time: 9.3169s
Updating learning rate to 0.00034971794632172426
Validation loss decreased (0.3820 --> 0.3742).  Saving model state dict ...
Epoch: 2 cost time: 1.6175198554992676
Epoch: 2, Steps: 514 | Train Loss: 0.8052113 Vali Loss: 0.3742089 Best vali loss: 0.3742089
	iters: 100, epoch: 3 | loss: 0.4394033
	speed: 0.0070s/iter; left time: 20.7686s
	iters: 200, epoch: 3 | loss: 0.3797608
	speed: 0.0031s/iter; left time: 9.0004s
	iters: 300, epoch: 3 | loss: 0.5388200
	speed: 0.0032s/iter; left time: 8.7832s
	iters: 400, epoch: 3 | loss: 0.5120743
	speed: 0.0031s/iter; left time: 8.3525s
	iters: 500, epoch: 3 | loss: 1.0099492
	speed: 0.0031s/iter; left time: 8.1247s
Updating learning rate to 0.00028325656936568113
Validation loss decreased (0.3742 --> 0.3611).  Saving model state dict ...
Epoch: 3 cost time: 1.6480982303619385
Epoch: 3, Steps: 514 | Train Loss: 0.5760015 Vali Loss: 0.3611288 Best vali loss: 0.3611288
	iters: 100, epoch: 4 | loss: 0.4109581
	speed: 0.0072s/iter; left time: 17.7963s
	iters: 200, epoch: 4 | loss: 0.5163745
	speed: 0.0030s/iter; left time: 7.2300s
	iters: 300, epoch: 4 | loss: 0.4063328
	speed: 0.0031s/iter; left time: 6.9731s
	iters: 400, epoch: 4 | loss: 0.3738384
	speed: 0.0031s/iter; left time: 6.7795s
	iters: 500, epoch: 4 | loss: 0.3295409
	speed: 0.0030s/iter; left time: 6.2956s
Updating learning rate to 0.00020486002995
Validation loss decreased (0.3611 --> 0.3466).  Saving model state dict ...
Epoch: 4 cost time: 1.6216745376586914
Epoch: 4, Steps: 514 | Train Loss: 0.4074090 Vali Loss: 0.3466403 Best vali loss: 0.3466403
	iters: 100, epoch: 5 | loss: 0.4066974
	speed: 0.0072s/iter; left time: 14.1559s
	iters: 200, epoch: 5 | loss: 0.4970399
	speed: 0.0031s/iter; left time: 5.7164s
	iters: 300, epoch: 5 | loss: 0.2363480
	speed: 0.0031s/iter; left time: 5.3608s
	iters: 400, epoch: 5 | loss: 0.3845121
	speed: 0.0030s/iter; left time: 4.9563s
	iters: 500, epoch: 5 | loss: 0.4579623
	speed: 0.0030s/iter; left time: 4.7110s
Updating learning rate to 0.00012646349053431892
Validation loss decreased (0.3466 --> 0.3346).  Saving model state dict ...
Epoch: 5 cost time: 1.6233954429626465
Epoch: 5, Steps: 514 | Train Loss: 0.3965119 Vali Loss: 0.3346330 Best vali loss: 0.3346330
	iters: 100, epoch: 6 | loss: 0.3789001
	speed: 0.0070s/iter; left time: 10.1399s
	iters: 200, epoch: 6 | loss: 0.3578568
	speed: 0.0031s/iter; left time: 4.2165s
	iters: 300, epoch: 6 | loss: 0.2713584
	speed: 0.0031s/iter; left time: 3.8472s
	iters: 400, epoch: 6 | loss: 0.5003304
	speed: 0.0031s/iter; left time: 3.5172s
	iters: 500, epoch: 6 | loss: 0.5862927
	speed: 0.0031s/iter; left time: 3.2622s
Updating learning rate to 6.000211357827579e-05
Epoch: 6 cost time: 1.6553864479064941
Epoch: 6, Steps: 514 | Train Loss: 0.4189477 Vali Loss: 0.3394319 Best vali loss: 0.3346330
	iters: 100, epoch: 7 | loss: 0.3559967
	speed: 0.0070s/iter; left time: 6.5421s
	iters: 200, epoch: 7 | loss: 0.2195889
	speed: 0.0031s/iter; left time: 2.5798s
	iters: 300, epoch: 7 | loss: 0.4924254
	speed: 0.0031s/iter; left time: 2.2887s
	iters: 400, epoch: 7 | loss: 0.4703369
	speed: 0.0030s/iter; left time: 1.9177s
	iters: 500, epoch: 7 | loss: 0.3223932
	speed: 0.0031s/iter; left time: 1.6162s
Updating learning rate to 1.5594041249545802e-05
Epoch: 7 cost time: 1.6469712257385254
Epoch: 7, Steps: 514 | Train Loss: 0.3721482 Vali Loss: 0.3446005 Best vali loss: 0.3346330
	iters: 100, epoch: 8 | loss: 0.2162016
	speed: 0.0072s/iter; left time: 3.0006s
	iters: 200, epoch: 8 | loss: 0.4042811
	speed: 0.0030s/iter; left time: 0.9521s
	iters: 300, epoch: 8 | loss: 0.6200933
	speed: 0.0030s/iter; left time: 0.6458s
	iters: 400, epoch: 8 | loss: 0.5896612
	speed: 0.0030s/iter; left time: 0.3453s
	iters: 500, epoch: 8 | loss: 0.3581453
	speed: 0.0030s/iter; left time: 0.0450s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.627124547958374
Epoch: 8, Steps: 514 | Train Loss: 0.4376765 Vali Loss: 0.3431061 Best vali loss: 0.3346330

best validation loss 0.3346329672456022

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022176884584, 'e_layers': 4, 'learning_rate': 0.0003957372189, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6363965
	speed: 0.0111s/iter; left time: 44.6028s
	iters: 200, epoch: 1 | loss: 0.4955411
	speed: 0.0048s/iter; left time: 18.8085s
	iters: 300, epoch: 1 | loss: 1.0758511
	speed: 0.0045s/iter; left time: 17.3126s
	iters: 400, epoch: 1 | loss: 1.7425073
	speed: 0.0045s/iter; left time: 16.5576s
	iters: 500, epoch: 1 | loss: 0.4569891
	speed: 0.0047s/iter; left time: 16.8963s
Updating learning rate to 0.0003806753678473244
Validation loss decreased (inf --> 0.3573).  Saving model state dict ...
Epoch: 1 cost time: 2.7573752403259277
Epoch: 1, Steps: 514 | Train Loss: 0.8814570 Vali Loss: 0.3573407 Best vali loss: 0.3573407
	iters: 100, epoch: 2 | loss: 0.8613860
	speed: 0.0096s/iter; left time: 33.4713s
	iters: 200, epoch: 2 | loss: 0.4733487
	speed: 0.0046s/iter; left time: 15.4871s
	iters: 300, epoch: 2 | loss: 1.2359220
	speed: 0.0047s/iter; left time: 15.3902s
	iters: 400, epoch: 2 | loss: 0.4073439
	speed: 0.0047s/iter; left time: 15.0833s
	iters: 500, epoch: 2 | loss: 0.6590796
	speed: 0.0047s/iter; left time: 14.5295s
Updating learning rate to 0.0003377828449760476
Epoch: 2 cost time: 2.4545910358428955
Epoch: 2, Steps: 514 | Train Loss: 0.7274160 Vali Loss: 0.3911294 Best vali loss: 0.3573407
	iters: 100, epoch: 3 | loss: 0.5121677
	speed: 0.0093s/iter; left time: 27.7164s
	iters: 200, epoch: 3 | loss: 0.8943458
	speed: 0.0048s/iter; left time: 13.7131s
	iters: 300, epoch: 3 | loss: 0.6527983
	speed: 0.0046s/iter; left time: 12.6756s
	iters: 400, epoch: 3 | loss: 1.1720258
	speed: 0.0045s/iter; left time: 12.1478s
	iters: 500, epoch: 3 | loss: 1.4399359
	speed: 0.0045s/iter; left time: 11.6815s
Updating learning rate to 0.0002735896480716335
Epoch: 3 cost time: 2.41508412361145
Epoch: 3, Steps: 514 | Train Loss: 0.9342547 Vali Loss: 0.3817043 Best vali loss: 0.3573407
	iters: 100, epoch: 4 | loss: 0.5943584
	speed: 0.0103s/iter; left time: 25.3937s
	iters: 200, epoch: 4 | loss: 0.8147700
	speed: 0.0053s/iter; left time: 12.5640s
	iters: 300, epoch: 4 | loss: 0.7549783
	speed: 0.0053s/iter; left time: 12.0100s
	iters: 400, epoch: 4 | loss: 0.3634493
	speed: 0.0053s/iter; left time: 11.5388s
	iters: 500, epoch: 4 | loss: 0.5605598
	speed: 0.0049s/iter; left time: 10.1202s
Updating learning rate to 0.00019786860945
Epoch: 4 cost time: 2.7143781185150146
Epoch: 4, Steps: 514 | Train Loss: 0.6176232 Vali Loss: 0.3719192 Best vali loss: 0.3573407
	iters: 100, epoch: 5 | loss: 0.4744538
	speed: 0.0102s/iter; left time: 19.8724s
	iters: 200, epoch: 5 | loss: 0.8696849
	speed: 0.0053s/iter; left time: 9.8418s
	iters: 300, epoch: 5 | loss: 0.2816269
	speed: 0.0052s/iter; left time: 9.1854s
	iters: 400, epoch: 5 | loss: 1.0223728
	speed: 0.0052s/iter; left time: 8.5869s
	iters: 500, epoch: 5 | loss: 0.5552855
	speed: 0.0052s/iter; left time: 8.0432s
Updating learning rate to 0.00012214757082836658
Validation loss decreased (0.3573 --> 0.3508).  Saving model state dict ...
Epoch: 5 cost time: 2.723558187484741
Epoch: 5, Steps: 514 | Train Loss: 0.6406848 Vali Loss: 0.3507632 Best vali loss: 0.3507632
	iters: 100, epoch: 6 | loss: 0.2590738
	speed: 0.0099s/iter; left time: 14.2925s
	iters: 200, epoch: 6 | loss: 0.3366660
	speed: 0.0046s/iter; left time: 6.2367s
	iters: 300, epoch: 6 | loss: 0.2374287
	speed: 0.0051s/iter; left time: 6.3198s
	iters: 400, epoch: 6 | loss: 0.3322617
	speed: 0.0050s/iter; left time: 5.7237s
	iters: 500, epoch: 6 | loss: 0.3950035
	speed: 0.0050s/iter; left time: 5.2562s
Updating learning rate to 5.795437392395244e-05
Epoch: 6 cost time: 2.5550529956817627
Epoch: 6, Steps: 514 | Train Loss: 0.3120868 Vali Loss: 0.3536238 Best vali loss: 0.3507632
	iters: 100, epoch: 7 | loss: 0.9126909
	speed: 0.0098s/iter; left time: 9.0718s
	iters: 200, epoch: 7 | loss: 0.3710637
	speed: 0.0051s/iter; left time: 4.2177s
	iters: 300, epoch: 7 | loss: 0.4811662
	speed: 0.0048s/iter; left time: 3.5264s
	iters: 400, epoch: 7 | loss: 0.3570245
	speed: 0.0047s/iter; left time: 2.9496s
	iters: 500, epoch: 7 | loss: 0.3858725
	speed: 0.0049s/iter; left time: 2.6156s
Updating learning rate to 1.5061851052675627e-05
Epoch: 7 cost time: 2.5892632007598877
Epoch: 7, Steps: 514 | Train Loss: 0.5015635 Vali Loss: 0.3661294 Best vali loss: 0.3507632
	iters: 100, epoch: 8 | loss: 0.3320173
	speed: 0.0098s/iter; left time: 4.0526s
	iters: 200, epoch: 8 | loss: 0.6274405
	speed: 0.0048s/iter; left time: 1.5098s
	iters: 300, epoch: 8 | loss: 0.2299730
	speed: 0.0048s/iter; left time: 1.0261s
	iters: 400, epoch: 8 | loss: 0.5099426
	speed: 0.0047s/iter; left time: 0.5387s
	iters: 500, epoch: 8 | loss: 0.3366035
	speed: 0.0044s/iter; left time: 0.0663s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.4522347450256348
Epoch: 8, Steps: 514 | Train Loss: 0.4071954 Vali Loss: 0.3593713 Best vali loss: 0.3507632

best validation loss 0.35076320756863516

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0052602018033, 'e_layers': 2, 'learning_rate': 0.0004220610201, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4273004
	speed: 0.0097s/iter; left time: 39.0563s
	iters: 200, epoch: 1 | loss: 1.0790986
	speed: 0.0036s/iter; left time: 14.0580s
	iters: 300, epoch: 1 | loss: 1.0142349
	speed: 0.0035s/iter; left time: 13.1911s
	iters: 400, epoch: 1 | loss: 0.5082878
	speed: 0.0036s/iter; left time: 13.2501s
	iters: 500, epoch: 1 | loss: 1.0819108
	speed: 0.0036s/iter; left time: 13.0304s
Updating learning rate to 0.0004220610201
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 2.184910297393799
Epoch: 1, Steps: 514 | Train Loss: 0.8221665 Vali Loss: 0.3709714 Best vali loss: 0.3709714
	iters: 100, epoch: 2 | loss: 0.3896359
	speed: 0.0074s/iter; left time: 25.7781s
	iters: 200, epoch: 2 | loss: 0.3208643
	speed: 0.0034s/iter; left time: 11.6449s
	iters: 300, epoch: 2 | loss: 0.4851414
	speed: 0.0032s/iter; left time: 10.6279s
	iters: 400, epoch: 2 | loss: 0.3888530
	speed: 0.0032s/iter; left time: 10.3333s
	iters: 500, epoch: 2 | loss: 0.6499190
	speed: 0.0032s/iter; left time: 9.9105s
Updating learning rate to 0.00021103051005
Epoch: 2 cost time: 1.7378721237182617
Epoch: 2, Steps: 514 | Train Loss: 0.4468827 Vali Loss: 0.3731528 Best vali loss: 0.3709714
	iters: 100, epoch: 3 | loss: 0.3560023
	speed: 0.0074s/iter; left time: 22.1063s
	iters: 200, epoch: 3 | loss: 0.8769599
	speed: 0.0032s/iter; left time: 9.1354s
	iters: 300, epoch: 3 | loss: 0.4904956
	speed: 0.0033s/iter; left time: 9.2754s
	iters: 400, epoch: 3 | loss: 0.4706598
	speed: 0.0034s/iter; left time: 9.2585s
	iters: 500, epoch: 3 | loss: 1.0685850
	speed: 0.0033s/iter; left time: 8.6504s
Updating learning rate to 0.000105515255025
Validation loss decreased (0.3710 --> 0.3588).  Saving model state dict ...
Epoch: 3 cost time: 1.7537789344787598
Epoch: 3, Steps: 514 | Train Loss: 0.6525405 Vali Loss: 0.3588333 Best vali loss: 0.3588333

best validation loss 0.3588333314200516

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0048048850301, 'e_layers': 2, 'learning_rate': 0.0004227211022, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4274143
	speed: 0.0099s/iter; left time: 39.8385s
	iters: 200, epoch: 1 | loss: 1.0790898
	speed: 0.0036s/iter; left time: 14.2168s
	iters: 300, epoch: 1 | loss: 1.0139891
	speed: 0.0036s/iter; left time: 13.7738s
	iters: 400, epoch: 1 | loss: 0.5076452
	speed: 0.0037s/iter; left time: 13.6378s
	iters: 500, epoch: 1 | loss: 1.0543939
	speed: 0.0036s/iter; left time: 13.0575s
Updating learning rate to 0.00040663223824159597
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 2.2249088287353516
Epoch: 1, Steps: 514 | Train Loss: 0.8165064 Vali Loss: 0.3714973 Best vali loss: 0.3714973
	iters: 100, epoch: 2 | loss: 0.3907528
	speed: 0.0074s/iter; left time: 25.7199s
	iters: 200, epoch: 2 | loss: 0.2978291
	speed: 0.0033s/iter; left time: 11.1400s
	iters: 300, epoch: 2 | loss: 0.4374350
	speed: 0.0033s/iter; left time: 10.7946s
	iters: 400, epoch: 2 | loss: 0.3950951
	speed: 0.0032s/iter; left time: 10.2298s
	iters: 500, epoch: 2 | loss: 0.6346911
	speed: 0.0031s/iter; left time: 9.5328s
Updating learning rate to 0.0003608150300581358
Validation loss decreased (0.3715 --> 0.3548).  Saving model state dict ...
Epoch: 2 cost time: 1.71958589553833
Epoch: 2, Steps: 514 | Train Loss: 0.4311606 Vali Loss: 0.3547793 Best vali loss: 0.3547793
	iters: 100, epoch: 3 | loss: 0.3452516
	speed: 0.0076s/iter; left time: 22.6965s
	iters: 200, epoch: 3 | loss: 0.8933225
	speed: 0.0036s/iter; left time: 10.5179s
	iters: 300, epoch: 3 | loss: 0.4888287
	speed: 0.0036s/iter; left time: 10.0927s
	iters: 400, epoch: 3 | loss: 0.4727181
	speed: 0.0037s/iter; left time: 9.8215s
	iters: 500, epoch: 3 | loss: 1.0555137
	speed: 0.0036s/iter; left time: 9.4296s
Updating learning rate to 0.00029224473226152495
Epoch: 3 cost time: 1.9198012351989746
Epoch: 3, Steps: 514 | Train Loss: 0.6511269 Vali Loss: 0.3564956 Best vali loss: 0.3547793

best validation loss 0.35477931659910206

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0049011021393, 'e_layers': 2, 'learning_rate': 0.0006882167357, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006882167357
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.7736630439758301
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708369 Best vali loss: 0.3708369
Updating learning rate to 0.00034410836785
Validation loss decreased (0.3708 --> 0.3584).  Saving model state dict ...
Epoch: 2 cost time: 0.44054698944091797
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3583817 Best vali loss: 0.3583817
Updating learning rate to 0.000172054183925
Validation loss decreased (0.3584 --> 0.3531).  Saving model state dict ...
Epoch: 3 cost time: 0.44370388984680176
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3530813 Best vali loss: 0.3530813

best validation loss 0.35308131238332197

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0049011021393, 'e_layers': 2, 'learning_rate': 0.0006882167357, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.60270919625e-05
Validation loss decreased (0.3531 --> 0.3530).  Saving model state dict ...
Epoch: 4 cost time: 0.7685308456420898
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3530210 Best vali loss: 0.3530210
Updating learning rate to 4.301354598125e-05
Validation loss decreased (0.3530 --> 0.3510).  Saving model state dict ...
Epoch: 5 cost time: 0.44310545921325684
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3509843 Best vali loss: 0.3509843
Updating learning rate to 2.1506772990625e-05
Validation loss decreased (0.3510 --> 0.3488).  Saving model state dict ...
Epoch: 6 cost time: 0.4511730670928955
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3488465 Best vali loss: 0.3488465
Updating learning rate to 1.07533864953125e-05
Epoch: 7 cost time: 0.44986557960510254
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3524154 Best vali loss: 0.3488465
Updating learning rate to 5.37669324765625e-06
Epoch: 8 cost time: 0.44469237327575684
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3527690 Best vali loss: 0.3488465

best validation loss 0.34884646182444334

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010468883378, 'e_layers': 2, 'learning_rate': 0.0002500362262, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3148344
	speed: 0.0095s/iter; left time: 77.0552s
	iters: 200, epoch: 1 | loss: 0.3287416
	speed: 0.0034s/iter; left time: 26.9969s
	iters: 300, epoch: 1 | loss: 0.7620652
	speed: 0.0034s/iter; left time: 26.6785s
	iters: 400, epoch: 1 | loss: 0.3944552
	speed: 0.0034s/iter; left time: 26.7255s
	iters: 500, epoch: 1 | loss: 0.5526279
	speed: 0.0034s/iter; left time: 26.0689s
	iters: 600, epoch: 1 | loss: 0.9160154
	speed: 0.0033s/iter; left time: 25.4081s
	iters: 700, epoch: 1 | loss: 0.8865564
	speed: 0.0034s/iter; left time: 25.3183s
	iters: 800, epoch: 1 | loss: 1.4816412
	speed: 0.0034s/iter; left time: 24.9929s
	iters: 900, epoch: 1 | loss: 1.4192282
	speed: 0.0034s/iter; left time: 24.6343s
	iters: 1000, epoch: 1 | loss: 1.1137645
	speed: 0.0034s/iter; left time: 24.5093s
Updating learning rate to 0.0002500362262
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 3.8095622062683105
Epoch: 1, Steps: 1027 | Train Loss: 0.8169930 Vali Loss: 0.3696367 Best vali loss: 0.3696367
	iters: 100, epoch: 2 | loss: 0.3112477
	speed: 0.0092s/iter; left time: 65.1158s
	iters: 200, epoch: 2 | loss: 1.2352959
	speed: 0.0031s/iter; left time: 21.7580s
	iters: 300, epoch: 2 | loss: 0.9510800
	speed: 0.0031s/iter; left time: 21.0712s
	iters: 400, epoch: 2 | loss: 0.5411558
	speed: 0.0031s/iter; left time: 20.7902s
	iters: 500, epoch: 2 | loss: 0.3557205
	speed: 0.0031s/iter; left time: 20.5993s
	iters: 600, epoch: 2 | loss: 0.5882256
	speed: 0.0030s/iter; left time: 19.9651s
	iters: 700, epoch: 2 | loss: 1.0510035
	speed: 0.0031s/iter; left time: 19.9933s
	iters: 800, epoch: 2 | loss: 0.2935073
	speed: 0.0031s/iter; left time: 19.9002s
	iters: 900, epoch: 2 | loss: 0.3534603
	speed: 0.0030s/iter; left time: 19.0673s
	iters: 1000, epoch: 2 | loss: 0.7078304
	speed: 0.0031s/iter; left time: 18.9077s
Updating learning rate to 0.0001250181131
Epoch: 2 cost time: 3.183215618133545
Epoch: 2, Steps: 1027 | Train Loss: 0.6388527 Vali Loss: 0.3701665 Best vali loss: 0.3696367
	iters: 100, epoch: 3 | loss: 0.6592970
	speed: 0.0088s/iter; left time: 53.1888s
	iters: 200, epoch: 3 | loss: 0.4172811
	speed: 0.0029s/iter; left time: 17.2010s
	iters: 300, epoch: 3 | loss: 0.3771915
	speed: 0.0029s/iter; left time: 16.9565s
	iters: 400, epoch: 3 | loss: 0.9558508
	speed: 0.0029s/iter; left time: 16.8982s
	iters: 500, epoch: 3 | loss: 0.4510352
	speed: 0.0030s/iter; left time: 16.9865s
	iters: 600, epoch: 3 | loss: 0.2946465
	speed: 0.0029s/iter; left time: 16.0412s
	iters: 700, epoch: 3 | loss: 0.2355737
	speed: 0.0029s/iter; left time: 15.7080s
	iters: 800, epoch: 3 | loss: 0.7905518
	speed: 0.0030s/iter; left time: 16.2643s
	iters: 900, epoch: 3 | loss: 0.4204670
	speed: 0.0030s/iter; left time: 15.8922s
	iters: 1000, epoch: 3 | loss: 0.2638619
	speed: 0.0029s/iter; left time: 15.1485s
Updating learning rate to 6.250905655e-05
Validation loss decreased (0.3696 --> 0.3627).  Saving model state dict ...
Epoch: 3 cost time: 3.0534827709198
Epoch: 3, Steps: 1027 | Train Loss: 0.4865757 Vali Loss: 0.3626679 Best vali loss: 0.3626679
	iters: 100, epoch: 4 | loss: 0.3275520
	speed: 0.0089s/iter; left time: 44.9197s
	iters: 200, epoch: 4 | loss: 0.8103214
	speed: 0.0030s/iter; left time: 14.7013s
	iters: 300, epoch: 4 | loss: 0.9305672
	speed: 0.0029s/iter; left time: 14.0663s
	iters: 400, epoch: 4 | loss: 0.2221931
	speed: 0.0029s/iter; left time: 13.5934s
	iters: 500, epoch: 4 | loss: 0.4798481
	speed: 0.0028s/iter; left time: 13.1678s
	iters: 600, epoch: 4 | loss: 0.3941672
	speed: 0.0029s/iter; left time: 13.0306s
	iters: 700, epoch: 4 | loss: 0.2765028
	speed: 0.0028s/iter; left time: 12.3473s
	iters: 800, epoch: 4 | loss: 0.3928601
	speed: 0.0028s/iter; left time: 12.3483s
	iters: 900, epoch: 4 | loss: 0.8187706
	speed: 0.0028s/iter; left time: 12.0062s
	iters: 1000, epoch: 4 | loss: 0.8717403
	speed: 0.0028s/iter; left time: 11.5873s
Updating learning rate to 3.1254528275e-05
Validation loss decreased (0.3627 --> 0.3519).  Saving model state dict ...
Epoch: 4 cost time: 2.976935863494873
Epoch: 4, Steps: 1027 | Train Loss: 0.5524523 Vali Loss: 0.3519165 Best vali loss: 0.3519165
	iters: 100, epoch: 5 | loss: 0.4089665
	speed: 0.0089s/iter; left time: 35.5570s
	iters: 200, epoch: 5 | loss: 0.6025496
	speed: 0.0029s/iter; left time: 11.2241s
	iters: 300, epoch: 5 | loss: 0.3772588
	speed: 0.0029s/iter; left time: 10.8699s
	iters: 400, epoch: 5 | loss: 0.6358796
	speed: 0.0029s/iter; left time: 10.6827s
	iters: 500, epoch: 5 | loss: 0.2865147
	speed: 0.0029s/iter; left time: 10.3391s
	iters: 600, epoch: 5 | loss: 0.2270631
	speed: 0.0028s/iter; left time: 9.8805s
	iters: 700, epoch: 5 | loss: 0.7602528
	speed: 0.0028s/iter; left time: 9.4873s
	iters: 800, epoch: 5 | loss: 0.8297641
	speed: 0.0028s/iter; left time: 9.2832s
	iters: 900, epoch: 5 | loss: 0.2246782
	speed: 0.0028s/iter; left time: 9.0571s
	iters: 1000, epoch: 5 | loss: 0.7397730
	speed: 0.0028s/iter; left time: 8.7423s
Updating learning rate to 1.56272641375e-05
Validation loss decreased (0.3519 --> 0.3465).  Saving model state dict ...
Epoch: 5 cost time: 2.953803777694702
Epoch: 5, Steps: 1027 | Train Loss: 0.5092700 Vali Loss: 0.3464876 Best vali loss: 0.3464876
	iters: 100, epoch: 6 | loss: 0.2796680
	speed: 0.0093s/iter; left time: 27.8256s
	iters: 200, epoch: 6 | loss: 0.2377862
	speed: 0.0030s/iter; left time: 8.7311s
	iters: 300, epoch: 6 | loss: 0.6955969
	speed: 0.0030s/iter; left time: 8.4297s
	iters: 400, epoch: 6 | loss: 0.1827888
	speed: 0.0030s/iter; left time: 8.1522s
	iters: 500, epoch: 6 | loss: 0.5800056
	speed: 0.0031s/iter; left time: 7.9021s
	iters: 600, epoch: 6 | loss: 0.4853734
	speed: 0.0030s/iter; left time: 7.4686s
	iters: 700, epoch: 6 | loss: 0.6501631
	speed: 0.0030s/iter; left time: 7.0863s
	iters: 800, epoch: 6 | loss: 0.3899656
	speed: 0.0029s/iter; left time: 6.5059s
	iters: 900, epoch: 6 | loss: 0.3531454
	speed: 0.0030s/iter; left time: 6.5574s
	iters: 1000, epoch: 6 | loss: 0.4166229
	speed: 0.0028s/iter; left time: 5.8820s
Updating learning rate to 7.81363206875e-06
Epoch: 6 cost time: 3.100579261779785
Epoch: 6, Steps: 1027 | Train Loss: 0.4271116 Vali Loss: 0.3498334 Best vali loss: 0.3464876
	iters: 100, epoch: 7 | loss: 0.3879541
	speed: 0.0088s/iter; left time: 17.2540s
	iters: 200, epoch: 7 | loss: 0.6982270
	speed: 0.0030s/iter; left time: 5.5111s
	iters: 300, epoch: 7 | loss: 1.0049224
	speed: 0.0028s/iter; left time: 4.9087s
	iters: 400, epoch: 7 | loss: 0.8370942
	speed: 0.0030s/iter; left time: 4.9264s
	iters: 500, epoch: 7 | loss: 0.1929201
	speed: 0.0030s/iter; left time: 4.6515s
	iters: 600, epoch: 7 | loss: 0.8110334
	speed: 0.0030s/iter; left time: 4.3845s
	iters: 700, epoch: 7 | loss: 0.4359305
	speed: 0.0030s/iter; left time: 4.0676s
	iters: 800, epoch: 7 | loss: 0.4096608
	speed: 0.0030s/iter; left time: 3.8146s
	iters: 900, epoch: 7 | loss: 0.7143207
	speed: 0.0030s/iter; left time: 3.5095s
	iters: 1000, epoch: 7 | loss: 0.2732709
	speed: 0.0030s/iter; left time: 3.1976s
Updating learning rate to 3.906816034375e-06
Epoch: 7 cost time: 3.1064178943634033
Epoch: 7, Steps: 1027 | Train Loss: 0.5765334 Vali Loss: 0.3482195 Best vali loss: 0.3464876
	iters: 100, epoch: 8 | loss: 0.4335216
	speed: 0.0089s/iter; left time: 8.2782s
	iters: 200, epoch: 8 | loss: 0.2751032
	speed: 0.0030s/iter; left time: 2.5085s
	iters: 300, epoch: 8 | loss: 0.3752179
	speed: 0.0029s/iter; left time: 2.1124s
	iters: 400, epoch: 8 | loss: 0.8424307
	speed: 0.0029s/iter; left time: 1.7937s
	iters: 500, epoch: 8 | loss: 0.6206149
	speed: 0.0028s/iter; left time: 1.4993s
	iters: 600, epoch: 8 | loss: 0.1730522
	speed: 0.0028s/iter; left time: 1.2191s
	iters: 700, epoch: 8 | loss: 0.9197493
	speed: 0.0028s/iter; left time: 0.9212s
	iters: 800, epoch: 8 | loss: 0.2792396
	speed: 0.0028s/iter; left time: 0.6404s
	iters: 900, epoch: 8 | loss: 0.5258876
	speed: 0.0028s/iter; left time: 0.3607s
	iters: 1000, epoch: 8 | loss: 0.3147055
	speed: 0.0028s/iter; left time: 0.0784s
Updating learning rate to 1.9534080171875e-06
Epoch: 8 cost time: 2.989567756652832
Epoch: 8, Steps: 1027 | Train Loss: 0.4759522 Vali Loss: 0.3503122 Best vali loss: 0.3464876

best validation loss 0.3464876239391113

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021942137147, 'e_layers': 2, 'learning_rate': 0.0004105606834, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8052285
	speed: 0.0099s/iter; left time: 39.6845s
	iters: 200, epoch: 1 | loss: 0.3316550
	speed: 0.0034s/iter; left time: 13.1542s
	iters: 300, epoch: 1 | loss: 0.5339415
	speed: 0.0036s/iter; left time: 13.5389s
	iters: 400, epoch: 1 | loss: 1.0691094
	speed: 0.0034s/iter; left time: 12.4420s
	iters: 500, epoch: 1 | loss: 0.9280097
	speed: 0.0033s/iter; left time: 12.0656s
Updating learning rate to 0.0004105606834
Validation loss decreased (inf --> 0.3824).  Saving model state dict ...
Epoch: 1 cost time: 2.1117138862609863
Epoch: 1, Steps: 514 | Train Loss: 0.7335888 Vali Loss: 0.3824099 Best vali loss: 0.3824099
	iters: 100, epoch: 2 | loss: 1.1707618
	speed: 0.0071s/iter; left time: 24.9603s
	iters: 200, epoch: 2 | loss: 0.7038174
	speed: 0.0031s/iter; left time: 10.5527s
	iters: 300, epoch: 2 | loss: 0.6933013
	speed: 0.0031s/iter; left time: 10.2388s
	iters: 400, epoch: 2 | loss: 0.6369018
	speed: 0.0032s/iter; left time: 10.1423s
	iters: 500, epoch: 2 | loss: 0.6779595
	speed: 0.0032s/iter; left time: 9.8095s
Updating learning rate to 0.0002052803417
Validation loss decreased (0.3824 --> 0.3765).  Saving model state dict ...
Epoch: 2 cost time: 1.6583983898162842
Epoch: 2, Steps: 514 | Train Loss: 0.7765484 Vali Loss: 0.3765389 Best vali loss: 0.3765389
	iters: 100, epoch: 3 | loss: 0.4491775
	speed: 0.0071s/iter; left time: 21.3075s
	iters: 200, epoch: 3 | loss: 0.3808137
	speed: 0.0031s/iter; left time: 8.9415s
	iters: 300, epoch: 3 | loss: 0.5167683
	speed: 0.0031s/iter; left time: 8.5627s
	iters: 400, epoch: 3 | loss: 0.4935134
	speed: 0.0030s/iter; left time: 8.0453s
	iters: 500, epoch: 3 | loss: 0.9822889
	speed: 0.0030s/iter; left time: 7.6501s
Updating learning rate to 0.00010264017085
Epoch: 3 cost time: 1.6115331649780273
Epoch: 3, Steps: 514 | Train Loss: 0.5645124 Vali Loss: 0.3825481 Best vali loss: 0.3765389
	iters: 100, epoch: 4 | loss: 0.4451528
	speed: 0.0068s/iter; left time: 16.8545s
	iters: 200, epoch: 4 | loss: 0.5140909
	speed: 0.0031s/iter; left time: 7.2362s
	iters: 300, epoch: 4 | loss: 0.4096087
	speed: 0.0031s/iter; left time: 6.9633s
	iters: 400, epoch: 4 | loss: 0.3776959
	speed: 0.0031s/iter; left time: 6.6445s
	iters: 500, epoch: 4 | loss: 0.3387642
	speed: 0.0031s/iter; left time: 6.4629s
Updating learning rate to 5.1320085425e-05
Validation loss decreased (0.3765 --> 0.3714).  Saving model state dict ...
Epoch: 4 cost time: 1.6362662315368652
Epoch: 4, Steps: 514 | Train Loss: 0.4170625 Vali Loss: 0.3714250 Best vali loss: 0.3714250
	iters: 100, epoch: 5 | loss: 0.4258935
	speed: 0.0076s/iter; left time: 14.9101s
	iters: 200, epoch: 5 | loss: 0.6101800
	speed: 0.0034s/iter; left time: 6.3221s
	iters: 300, epoch: 5 | loss: 0.2473632
	speed: 0.0033s/iter; left time: 5.8838s
	iters: 400, epoch: 5 | loss: 0.3849976
	speed: 0.0035s/iter; left time: 5.7236s
	iters: 500, epoch: 5 | loss: 0.5249413
	speed: 0.0033s/iter; left time: 5.0943s
Updating learning rate to 2.56600427125e-05
Validation loss decreased (0.3714 --> 0.3677).  Saving model state dict ...
Epoch: 5 cost time: 1.7802109718322754
Epoch: 5, Steps: 514 | Train Loss: 0.4386751 Vali Loss: 0.3677241 Best vali loss: 0.3677241
	iters: 100, epoch: 6 | loss: 0.3725339
	speed: 0.0074s/iter; left time: 10.6861s
	iters: 200, epoch: 6 | loss: 0.3455533
	speed: 0.0032s/iter; left time: 4.3646s
	iters: 300, epoch: 6 | loss: 0.2741012
	speed: 0.0032s/iter; left time: 3.9739s
	iters: 400, epoch: 6 | loss: 0.5639368
	speed: 0.0033s/iter; left time: 3.7466s
	iters: 500, epoch: 6 | loss: 0.6280925
	speed: 0.0033s/iter; left time: 3.4017s
Updating learning rate to 1.283002135625e-05
Validation loss decreased (0.3677 --> 0.3671).  Saving model state dict ...
Epoch: 6 cost time: 1.7380237579345703
Epoch: 6, Steps: 514 | Train Loss: 0.4368436 Vali Loss: 0.3671336 Best vali loss: 0.3671336
	iters: 100, epoch: 7 | loss: 0.3803726
	speed: 0.0075s/iter; left time: 6.9504s
	iters: 200, epoch: 7 | loss: 0.2597511
	speed: 0.0035s/iter; left time: 2.9320s
	iters: 300, epoch: 7 | loss: 0.5777372
	speed: 0.0035s/iter; left time: 2.5328s
	iters: 400, epoch: 7 | loss: 0.5123127
	speed: 0.0035s/iter; left time: 2.1720s
	iters: 500, epoch: 7 | loss: 0.4129609
	speed: 0.0035s/iter; left time: 1.8440s
Updating learning rate to 6.415010678125e-06
Epoch: 7 cost time: 1.8354897499084473
Epoch: 7, Steps: 514 | Train Loss: 0.4286269 Vali Loss: 0.3688401 Best vali loss: 0.3671336
	iters: 100, epoch: 8 | loss: 0.3109628
	speed: 0.0071s/iter; left time: 2.9619s
	iters: 200, epoch: 8 | loss: 0.5033365
	speed: 0.0033s/iter; left time: 1.0413s
	iters: 300, epoch: 8 | loss: 0.7189323
	speed: 0.0033s/iter; left time: 0.7040s
	iters: 400, epoch: 8 | loss: 0.6604698
	speed: 0.0032s/iter; left time: 0.3694s
	iters: 500, epoch: 8 | loss: 0.4380360
	speed: 0.0032s/iter; left time: 0.0483s
Updating learning rate to 3.2075053390625e-06
Validation loss decreased (0.3671 --> 0.3659).  Saving model state dict ...
Epoch: 8 cost time: 1.7255079746246338
Epoch: 8, Steps: 514 | Train Loss: 0.5263475 Vali Loss: 0.3658871 Best vali loss: 0.3658871

best validation loss 0.36588712424801

[INFO][smbo.py:320] Finished 1200 trials.
{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.002079077075, 'e_layers': 2, 'learning_rate': 0.0004105629745, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8052746
	speed: 0.0098s/iter; left time: 39.4705s
	iters: 200, epoch: 1 | loss: 0.3316471
	speed: 0.0033s/iter; left time: 12.7201s
	iters: 300, epoch: 1 | loss: 0.5337870
	speed: 0.0032s/iter; left time: 12.2203s
	iters: 400, epoch: 1 | loss: 1.0119439
	speed: 0.0034s/iter; left time: 12.5704s
	iters: 500, epoch: 1 | loss: 0.9023352
	speed: 0.0031s/iter; left time: 11.1350s
Updating learning rate to 0.00039493685172375167
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 2.0379037857055664
Epoch: 1, Steps: 514 | Train Loss: 0.7169976 Vali Loss: 0.3674191 Best vali loss: 0.3674191
	iters: 100, epoch: 2 | loss: 1.1302350
	speed: 0.0070s/iter; left time: 24.6197s
	iters: 200, epoch: 2 | loss: 0.6511452
	speed: 0.0034s/iter; left time: 11.6931s
	iters: 300, epoch: 2 | loss: 0.6751747
	speed: 0.0035s/iter; left time: 11.4182s
	iters: 400, epoch: 2 | loss: 0.5882319
	speed: 0.0034s/iter; left time: 11.0358s
	iters: 500, epoch: 2 | loss: 0.6965092
	speed: 0.0033s/iter; left time: 10.1837s
Updating learning rate to 0.0003504374189365348
Validation loss decreased (0.3674 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 1.780369520187378
Epoch: 2, Steps: 514 | Train Loss: 0.7482592 Vali Loss: 0.3660131 Best vali loss: 0.3660131
	iters: 100, epoch: 3 | loss: 0.4549042
	speed: 0.0072s/iter; left time: 21.4318s
	iters: 200, epoch: 3 | loss: 0.3917554
	speed: 0.0031s/iter; left time: 8.8988s
	iters: 300, epoch: 3 | loss: 0.5216513
	speed: 0.0031s/iter; left time: 8.7727s
	iters: 400, epoch: 3 | loss: 0.4885834
	speed: 0.0030s/iter; left time: 8.1161s
	iters: 500, epoch: 3 | loss: 1.0156038
	speed: 0.0032s/iter; left time: 8.1497s
Updating learning rate to 0.00028383931139184046
Validation loss decreased (0.3660 --> 0.3652).  Saving model state dict ...
Epoch: 3 cost time: 1.6479499340057373
Epoch: 3, Steps: 514 | Train Loss: 0.5744996 Vali Loss: 0.3652489 Best vali loss: 0.3652489

best validation loss 0.3652488792340741

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.007543257661, 'e_layers': 4, 'learning_rate': 0.0002095497581, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002015742453256406
Validation loss decreased (inf --> 0.3770).  Saving model state dict ...
Epoch: 1 cost time: 0.7813458442687988
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3769883 Best vali loss: 0.3769883
Updating learning rate to 0.00017886190652425531
Validation loss decreased (0.3770 --> 0.3656).  Saving model state dict ...
Epoch: 2 cost time: 0.4894266128540039
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3656195 Best vali loss: 0.3656195
Updating learning rate to 0.00014487048939049114
Validation loss decreased (0.3656 --> 0.3650).  Saving model state dict ...
Epoch: 3 cost time: 0.47934699058532715
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3649996 Best vali loss: 0.3649996

best validation loss 0.36499959136741805

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.001051742736, 'e_layers': 2, 'learning_rate': 0.0001515974205, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5206162
	speed: 0.0100s/iter; left time: 19.5858s
	iters: 200, epoch: 1 | loss: 0.4017833
	speed: 0.0038s/iter; left time: 7.0816s
Updating learning rate to 0.0001458275872407285
Validation loss decreased (inf --> 0.3639).  Saving model state dict ...
Epoch: 1 cost time: 1.316899299621582
Epoch: 1, Steps: 257 | Train Loss: 0.4611998 Vali Loss: 0.3639465 Best vali loss: 0.3639465
	iters: 100, epoch: 2 | loss: 0.6789981
	speed: 0.0084s/iter; left time: 14.3286s
	iters: 200, epoch: 2 | loss: 0.7275497
	speed: 0.0036s/iter; left time: 5.7149s
Updating learning rate to 0.00012939649227296926
Epoch: 2 cost time: 0.9993469715118408
Epoch: 2, Steps: 257 | Train Loss: 0.7032739 Vali Loss: 0.3779391 Best vali loss: 0.3639465
	iters: 100, epoch: 3 | loss: 0.3830624
	speed: 0.0077s/iter; left time: 11.1552s
	iters: 200, epoch: 3 | loss: 0.5599322
	speed: 0.0033s/iter; left time: 4.4087s
Updating learning rate to 0.00010480562085731692
Epoch: 3 cost time: 0.8988144397735596
Epoch: 3, Steps: 257 | Train Loss: 0.4714973 Vali Loss: 0.3694593 Best vali loss: 0.3639465

best validation loss 0.3639465174295579

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.001051742736, 'e_layers': 2, 'learning_rate': 0.0001515974205, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4815384
	speed: 0.0100s/iter; left time: 11.8217s
	iters: 200, epoch: 4 | loss: 0.3770236
	speed: 0.0037s/iter; left time: 4.0196s
Updating learning rate to 7.579871025e-05
Epoch: 4 cost time: 1.296433925628662
Epoch: 4, Steps: 257 | Train Loss: 0.4292810 Vali Loss: 0.3714711 Best vali loss: 0.3639465
	iters: 100, epoch: 5 | loss: 0.5937945
	speed: 0.0081s/iter; left time: 7.5225s
	iters: 200, epoch: 5 | loss: 0.6052015
	speed: 0.0035s/iter; left time: 2.9322s
Updating learning rate to 4.6791799642683096e-05
Validation loss decreased (0.3639 --> 0.3615).  Saving model state dict ...
Epoch: 5 cost time: 0.9675905704498291
Epoch: 5, Steps: 257 | Train Loss: 0.5994980 Vali Loss: 0.3614790 Best vali loss: 0.3614790
	iters: 100, epoch: 6 | loss: 0.3355284
	speed: 0.0081s/iter; left time: 5.4496s
	iters: 200, epoch: 6 | loss: 0.5222743
	speed: 0.0038s/iter; left time: 2.1514s
Updating learning rate to 2.220092822703074e-05
Epoch: 6 cost time: 0.9948437213897705
Epoch: 6, Steps: 257 | Train Loss: 0.4289013 Vali Loss: 0.3629716 Best vali loss: 0.3614790
	iters: 100, epoch: 7 | loss: 0.5906786
	speed: 0.0077s/iter; left time: 3.1800s
	iters: 200, epoch: 7 | loss: 0.4636368
	speed: 0.0034s/iter; left time: 1.0668s
Updating learning rate to 5.769833259271522e-06
Epoch: 7 cost time: 0.889310359954834
Epoch: 7, Steps: 257 | Train Loss: 0.5271577 Vali Loss: 0.3641501 Best vali loss: 0.3614790
	iters: 100, epoch: 8 | loss: 0.4700975
	speed: 0.0081s/iter; left time: 1.2828s
	iters: 200, epoch: 8 | loss: 0.5275939
	speed: 0.0037s/iter; left time: 0.2143s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0048749446868896
Epoch: 8, Steps: 257 | Train Loss: 0.4988457 Vali Loss: 0.3644350 Best vali loss: 0.3614790

best validation loss 0.36147904102132455

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0061753671162, 'e_layers': 2, 'learning_rate': 0.0004097036617, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8064935
	speed: 0.0100s/iter; left time: 40.1065s
	iters: 200, epoch: 1 | loss: 0.3314337
	speed: 0.0036s/iter; left time: 14.2155s
	iters: 300, epoch: 1 | loss: 0.5343596
	speed: 0.0037s/iter; left time: 13.9427s
	iters: 400, epoch: 1 | loss: 1.0794305
	speed: 0.0036s/iter; left time: 13.5343s
	iters: 500, epoch: 1 | loss: 0.9218535
	speed: 0.0037s/iter; left time: 13.1917s
Updating learning rate to 0.0004097036617
Validation loss decreased (inf --> 0.3810).  Saving model state dict ...
Epoch: 1 cost time: 2.2314159870147705
Epoch: 1, Steps: 514 | Train Loss: 0.7347141 Vali Loss: 0.3810368 Best vali loss: 0.3810368
	iters: 100, epoch: 2 | loss: 1.2231969
	speed: 0.0075s/iter; left time: 26.2638s
	iters: 200, epoch: 2 | loss: 0.6832780
	speed: 0.0034s/iter; left time: 11.6383s
	iters: 300, epoch: 2 | loss: 0.7022725
	speed: 0.0034s/iter; left time: 11.0881s
	iters: 400, epoch: 2 | loss: 0.6118411
	speed: 0.0033s/iter; left time: 10.6907s
	iters: 500, epoch: 2 | loss: 0.6611117
	speed: 0.0034s/iter; left time: 10.6304s
Updating learning rate to 0.00020485183085
Validation loss decreased (0.3810 --> 0.3778).  Saving model state dict ...
Epoch: 2 cost time: 1.795945167541504
Epoch: 2, Steps: 514 | Train Loss: 0.7763400 Vali Loss: 0.3777684 Best vali loss: 0.3777684
	iters: 100, epoch: 3 | loss: 0.4598193
	speed: 0.0078s/iter; left time: 23.1432s
	iters: 200, epoch: 3 | loss: 0.4032963
	speed: 0.0031s/iter; left time: 8.8514s
	iters: 300, epoch: 3 | loss: 0.5294374
	speed: 0.0032s/iter; left time: 8.9125s
	iters: 400, epoch: 3 | loss: 0.4785375
	speed: 0.0031s/iter; left time: 8.3961s
	iters: 500, epoch: 3 | loss: 0.9746106
	speed: 0.0031s/iter; left time: 8.0578s
Updating learning rate to 0.000102425915425
Validation loss decreased (0.3778 --> 0.3611).  Saving model state dict ...
Epoch: 3 cost time: 1.6980717182159424
Epoch: 3, Steps: 514 | Train Loss: 0.5691402 Vali Loss: 0.3610881 Best vali loss: 0.3610881
	iters: 100, epoch: 4 | loss: 0.3972470
	speed: 0.0078s/iter; left time: 19.3666s
	iters: 200, epoch: 4 | loss: 0.5377994
	speed: 0.0033s/iter; left time: 7.9089s
	iters: 300, epoch: 4 | loss: 0.4255942
	speed: 0.0033s/iter; left time: 7.4519s
	iters: 400, epoch: 4 | loss: 0.3626346
	speed: 0.0033s/iter; left time: 7.0929s
	iters: 500, epoch: 4 | loss: 0.3391192
	speed: 0.0033s/iter; left time: 6.7741s
Updating learning rate to 5.12129577125e-05
Validation loss decreased (0.3611 --> 0.3559).  Saving model state dict ...
Epoch: 4 cost time: 1.77174973487854
Epoch: 4, Steps: 514 | Train Loss: 0.4124789 Vali Loss: 0.3558610 Best vali loss: 0.3558610
	iters: 100, epoch: 5 | loss: 0.4348701
	speed: 0.0075s/iter; left time: 14.6735s
	iters: 200, epoch: 5 | loss: 0.5243022
	speed: 0.0034s/iter; left time: 6.2628s
	iters: 300, epoch: 5 | loss: 0.2468497
	speed: 0.0033s/iter; left time: 5.8570s
	iters: 400, epoch: 5 | loss: 0.4029120
	speed: 0.0033s/iter; left time: 5.4894s
	iters: 500, epoch: 5 | loss: 0.4973248
	speed: 0.0034s/iter; left time: 5.2244s
Updating learning rate to 2.560647885625e-05
Validation loss decreased (0.3559 --> 0.3442).  Saving model state dict ...
Epoch: 5 cost time: 1.7644221782684326
Epoch: 5, Steps: 514 | Train Loss: 0.4212518 Vali Loss: 0.3441834 Best vali loss: 0.3441834
	iters: 100, epoch: 6 | loss: 0.3783887
	speed: 0.0078s/iter; left time: 11.3256s
	iters: 200, epoch: 6 | loss: 0.3568231
	speed: 0.0032s/iter; left time: 4.3128s
	iters: 300, epoch: 6 | loss: 0.2678688
	speed: 0.0032s/iter; left time: 4.0252s
	iters: 400, epoch: 6 | loss: 0.5634598
	speed: 0.0033s/iter; left time: 3.7373s
	iters: 500, epoch: 6 | loss: 0.6453062
	speed: 0.0032s/iter; left time: 3.3868s
Updating learning rate to 1.2803239428125e-05
Epoch: 6 cost time: 1.7193703651428223
Epoch: 6, Steps: 514 | Train Loss: 0.4423693 Vali Loss: 0.3489629 Best vali loss: 0.3441834
	iters: 100, epoch: 7 | loss: 0.3778020
	speed: 0.0074s/iter; left time: 6.8979s
	iters: 200, epoch: 7 | loss: 0.2411489
	speed: 0.0035s/iter; left time: 2.9214s
	iters: 300, epoch: 7 | loss: 0.6357174
	speed: 0.0035s/iter; left time: 2.5811s
	iters: 400, epoch: 7 | loss: 0.4807908
	speed: 0.0035s/iter; left time: 2.2235s
	iters: 500, epoch: 7 | loss: 0.3986955
	speed: 0.0035s/iter; left time: 1.8324s
Updating learning rate to 6.4016197140625e-06
Epoch: 7 cost time: 1.8459022045135498
Epoch: 7, Steps: 514 | Train Loss: 0.4268309 Vali Loss: 0.3474263 Best vali loss: 0.3441834
	iters: 100, epoch: 8 | loss: 0.2791717
	speed: 0.0074s/iter; left time: 3.0559s
	iters: 200, epoch: 8 | loss: 0.4563764
	speed: 0.0035s/iter; left time: 1.1099s
	iters: 300, epoch: 8 | loss: 0.7084974
	speed: 0.0033s/iter; left time: 0.7155s
	iters: 400, epoch: 8 | loss: 0.6544794
	speed: 0.0034s/iter; left time: 0.3884s
	iters: 500, epoch: 8 | loss: 0.4196280
	speed: 0.0034s/iter; left time: 0.0514s
Updating learning rate to 3.20080985703125e-06
Epoch: 8 cost time: 1.8071091175079346
Epoch: 8, Steps: 514 | Train Loss: 0.5036306 Vali Loss: 0.3452900 Best vali loss: 0.3441834

best validation loss 0.34418343155697895

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0059573243219, 'e_layers': 2, 'learning_rate': 0.0004096056651, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8066713
	speed: 0.0100s/iter; left time: 40.0263s
	iters: 200, epoch: 1 | loss: 0.3317295
	speed: 0.0034s/iter; left time: 13.2206s
	iters: 300, epoch: 1 | loss: 0.5327644
	speed: 0.0034s/iter; left time: 12.7750s
	iters: 400, epoch: 1 | loss: 1.0606568
	speed: 0.0035s/iter; left time: 12.9398s
	iters: 500, epoch: 1 | loss: 0.9176247
	speed: 0.0036s/iter; left time: 12.9245s
Updating learning rate to 0.0004096056651
Validation loss decreased (inf --> 0.3840).  Saving model state dict ...
Epoch: 1 cost time: 2.141822576522827
Epoch: 1, Steps: 514 | Train Loss: 0.7298894 Vali Loss: 0.3840018 Best vali loss: 0.3840018
	iters: 100, epoch: 2 | loss: 1.2780581
	speed: 0.0072s/iter; left time: 25.3054s
	iters: 200, epoch: 2 | loss: 0.7045301
	speed: 0.0030s/iter; left time: 10.2795s
	iters: 300, epoch: 2 | loss: 0.6883662
	speed: 0.0030s/iter; left time: 9.9043s
	iters: 400, epoch: 2 | loss: 0.6553663
	speed: 0.0030s/iter; left time: 9.6086s
	iters: 500, epoch: 2 | loss: 0.7088552
	speed: 0.0031s/iter; left time: 9.5358s
Updating learning rate to 0.00020480283255
Validation loss decreased (0.3840 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 1.6176297664642334
Epoch: 2, Steps: 514 | Train Loss: 0.8070352 Vali Loss: 0.3691016 Best vali loss: 0.3691016
	iters: 100, epoch: 3 | loss: 0.4744106
	speed: 0.0069s/iter; left time: 20.6660s
	iters: 200, epoch: 3 | loss: 0.4286950
	speed: 0.0031s/iter; left time: 9.0189s
	iters: 300, epoch: 3 | loss: 0.5417126
	speed: 0.0031s/iter; left time: 8.6681s
	iters: 400, epoch: 3 | loss: 0.5035255
	speed: 0.0031s/iter; left time: 8.2801s
	iters: 500, epoch: 3 | loss: 1.0539353
	speed: 0.0033s/iter; left time: 8.4119s
Updating learning rate to 0.000102401416275
Epoch: 3 cost time: 1.6508588790893555
Epoch: 3, Steps: 514 | Train Loss: 0.6004558 Vali Loss: 0.3800184 Best vali loss: 0.3691016
	iters: 100, epoch: 4 | loss: 0.4039327
	speed: 0.0069s/iter; left time: 17.1711s
	iters: 200, epoch: 4 | loss: 0.4928645
	speed: 0.0031s/iter; left time: 7.2349s
	iters: 300, epoch: 4 | loss: 0.4339478
	speed: 0.0030s/iter; left time: 6.8267s
	iters: 400, epoch: 4 | loss: 0.3888001
	speed: 0.0032s/iter; left time: 6.8799s
	iters: 500, epoch: 4 | loss: 0.3337842
	speed: 0.0032s/iter; left time: 6.6181s
Updating learning rate to 5.12007081375e-05
Epoch: 4 cost time: 1.645376443862915
Epoch: 4, Steps: 514 | Train Loss: 0.4106658 Vali Loss: 0.3857311 Best vali loss: 0.3691016
	iters: 100, epoch: 5 | loss: 0.3626184
	speed: 0.0069s/iter; left time: 13.4076s
	iters: 200, epoch: 5 | loss: 0.5069307
	speed: 0.0031s/iter; left time: 5.6725s
	iters: 300, epoch: 5 | loss: 0.2439333
	speed: 0.0031s/iter; left time: 5.3914s
	iters: 400, epoch: 5 | loss: 0.3936886
	speed: 0.0031s/iter; left time: 5.1283s
	iters: 500, epoch: 5 | loss: 0.5172337
	speed: 0.0031s/iter; left time: 4.7841s
Updating learning rate to 2.560035406875e-05
Epoch: 5 cost time: 1.628783941268921
Epoch: 5, Steps: 514 | Train Loss: 0.4048809 Vali Loss: 0.3886689 Best vali loss: 0.3691016
	iters: 100, epoch: 6 | loss: 0.3857471
	speed: 0.0071s/iter; left time: 10.2234s
	iters: 200, epoch: 6 | loss: 0.3499497
	speed: 0.0031s/iter; left time: 4.1796s
	iters: 300, epoch: 6 | loss: 0.2725124
	speed: 0.0031s/iter; left time: 3.8122s
	iters: 400, epoch: 6 | loss: 0.5823616
	speed: 0.0030s/iter; left time: 3.4794s
	iters: 500, epoch: 6 | loss: 0.6334297
	speed: 0.0030s/iter; left time: 3.1362s
Updating learning rate to 1.2800177034375e-05
Epoch: 6 cost time: 1.636218786239624
Epoch: 6, Steps: 514 | Train Loss: 0.4448001 Vali Loss: 0.3893637 Best vali loss: 0.3691016
	iters: 100, epoch: 7 | loss: 0.3922527
	speed: 0.0069s/iter; left time: 6.4246s
	iters: 200, epoch: 7 | loss: 0.2330177
	speed: 0.0030s/iter; left time: 2.4857s
	iters: 300, epoch: 7 | loss: 0.6097575
	speed: 0.0030s/iter; left time: 2.2045s
	iters: 400, epoch: 7 | loss: 0.4953373
	speed: 0.0031s/iter; left time: 1.9494s
	iters: 500, epoch: 7 | loss: 0.3794221
	speed: 0.0031s/iter; left time: 1.6456s
Updating learning rate to 6.4000885171875e-06
Epoch: 7 cost time: 1.6207129955291748
Epoch: 7, Steps: 514 | Train Loss: 0.4219575 Vali Loss: 0.3921949 Best vali loss: 0.3691016
	iters: 100, epoch: 8 | loss: 0.2842283
	speed: 0.0068s/iter; left time: 2.8130s
	iters: 200, epoch: 8 | loss: 0.4979579
	speed: 0.0030s/iter; left time: 0.9571s
	iters: 300, epoch: 8 | loss: 0.7015620
	speed: 0.0030s/iter; left time: 0.6501s
	iters: 400, epoch: 8 | loss: 0.6659116
	speed: 0.0031s/iter; left time: 0.3573s
	iters: 500, epoch: 8 | loss: 0.4104861
	speed: 0.0031s/iter; left time: 0.0459s
Updating learning rate to 3.20004425859375e-06
Epoch: 8 cost time: 1.6125566959381104
Epoch: 8, Steps: 514 | Train Loss: 0.5120292 Vali Loss: 0.3906859 Best vali loss: 0.3691016

best validation loss 0.3691016241703146

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0050908036971, 'e_layers': 4, 'learning_rate': 0.0003306885568, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6499070
	speed: 0.0121s/iter; left time: 11.3329s
Updating learning rate to 0.00031810247303160804
Validation loss decreased (inf --> 0.3680).  Saving model state dict ...
Epoch: 1 cost time: 1.1306684017181396
Epoch: 1, Steps: 129 | Train Loss: 0.6499070 Vali Loss: 0.3679996 Best vali loss: 0.3679996
	iters: 100, epoch: 2 | loss: 0.5738052
	speed: 0.0097s/iter; left time: 7.7834s
Updating learning rate to 0.0002822603388870364
Epoch: 2 cost time: 0.8104140758514404
Epoch: 2, Steps: 129 | Train Loss: 0.5738052 Vali Loss: 0.3682205 Best vali loss: 0.3679996
	iters: 100, epoch: 3 | loss: 0.7303795
	speed: 0.0092s/iter; left time: 6.2246s
Updating learning rate to 0.00022861879438004098
Validation loss decreased (0.3680 --> 0.3664).  Saving model state dict ...
Epoch: 3 cost time: 0.7513244152069092
Epoch: 3, Steps: 129 | Train Loss: 0.7303795 Vali Loss: 0.3664326 Best vali loss: 0.3664326

best validation loss 0.36643261738516725

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0111082261692, 'e_layers': 4, 'learning_rate': 8.88658653e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4662165
	speed: 0.0114s/iter; left time: 92.6215s
	iters: 200, epoch: 1 | loss: 0.6712389
	speed: 0.0051s/iter; left time: 41.0389s
	iters: 300, epoch: 1 | loss: 0.3600803
	speed: 0.0051s/iter; left time: 40.6288s
	iters: 400, epoch: 1 | loss: 0.5206823
	speed: 0.0051s/iter; left time: 39.9705s
	iters: 500, epoch: 1 | loss: 1.3048614
	speed: 0.0052s/iter; left time: 39.8704s
	iters: 600, epoch: 1 | loss: 0.2634529
	speed: 0.0051s/iter; left time: 39.0214s
	iters: 700, epoch: 1 | loss: 0.4231203
	speed: 0.0051s/iter; left time: 38.4215s
	iters: 800, epoch: 1 | loss: 1.3713826
	speed: 0.0051s/iter; left time: 37.9023s
	iters: 900, epoch: 1 | loss: 0.8352268
	speed: 0.0051s/iter; left time: 37.3161s
	iters: 1000, epoch: 1 | loss: 1.1414047
	speed: 0.0052s/iter; left time: 37.3234s
Updating learning rate to 8.88658653e-05
Validation loss decreased (inf --> 0.3850).  Saving model state dict ...
Epoch: 1 cost time: 5.636289834976196
Epoch: 1, Steps: 1027 | Train Loss: 0.7357667 Vali Loss: 0.3849902 Best vali loss: 0.3849902
	iters: 100, epoch: 2 | loss: 1.0794504
	speed: 0.0130s/iter; left time: 91.9873s
	iters: 200, epoch: 2 | loss: 1.1902251
	speed: 0.0050s/iter; left time: 35.2361s
	iters: 300, epoch: 2 | loss: 0.5762534
	speed: 0.0050s/iter; left time: 34.7415s
	iters: 400, epoch: 2 | loss: 0.4852728
	speed: 0.0050s/iter; left time: 34.0523s
	iters: 500, epoch: 2 | loss: 0.3177906
	speed: 0.0051s/iter; left time: 33.8418s
	iters: 600, epoch: 2 | loss: 1.0378851
	speed: 0.0050s/iter; left time: 33.1059s
	iters: 700, epoch: 2 | loss: 0.3800454
	speed: 0.0050s/iter; left time: 32.6524s
	iters: 800, epoch: 2 | loss: 1.2158749
	speed: 0.0050s/iter; left time: 32.1365s
	iters: 900, epoch: 2 | loss: 0.4001178
	speed: 0.0050s/iter; left time: 31.5314s
	iters: 1000, epoch: 2 | loss: 0.8355656
	speed: 0.0050s/iter; left time: 30.9870s
Updating learning rate to 4.443293265e-05
Validation loss decreased (0.3850 --> 0.3744).  Saving model state dict ...
Epoch: 2 cost time: 5.20561408996582
Epoch: 2, Steps: 1027 | Train Loss: 0.7518481 Vali Loss: 0.3744217 Best vali loss: 0.3744217
	iters: 100, epoch: 3 | loss: 1.2296978
	speed: 0.0129s/iter; left time: 78.4809s
	iters: 200, epoch: 3 | loss: 0.2328765
	speed: 0.0050s/iter; left time: 30.0772s
	iters: 300, epoch: 3 | loss: 0.4577274
	speed: 0.0050s/iter; left time: 29.4363s
	iters: 400, epoch: 3 | loss: 1.1191223
	speed: 0.0050s/iter; left time: 28.8109s
	iters: 500, epoch: 3 | loss: 0.8703299
	speed: 0.0050s/iter; left time: 28.5649s
	iters: 600, epoch: 3 | loss: 1.0268812
	speed: 0.0050s/iter; left time: 27.8115s
	iters: 700, epoch: 3 | loss: 0.2982970
	speed: 0.0050s/iter; left time: 27.3180s
	iters: 800, epoch: 3 | loss: 0.9403328
	speed: 0.0050s/iter; left time: 26.9060s
	iters: 900, epoch: 3 | loss: 0.2856363
	speed: 0.0050s/iter; left time: 26.3552s
	iters: 1000, epoch: 3 | loss: 0.4072284
	speed: 0.0050s/iter; left time: 25.8890s
Updating learning rate to 2.2216466325e-05
Validation loss decreased (0.3744 --> 0.3718).  Saving model state dict ...
Epoch: 3 cost time: 5.1934404373168945
Epoch: 3, Steps: 1027 | Train Loss: 0.6868130 Vali Loss: 0.3718208 Best vali loss: 0.3718208

best validation loss 0.3718208315798716

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021281425911, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3533213
	speed: 0.0096s/iter; left time: 38.3425s
	iters: 200, epoch: 1 | loss: 0.3364877
	speed: 0.0032s/iter; left time: 12.3598s
	iters: 300, epoch: 1 | loss: 0.8900154
	speed: 0.0033s/iter; left time: 12.7452s
	iters: 400, epoch: 1 | loss: 0.8942875
	speed: 0.0032s/iter; left time: 11.7812s
	iters: 500, epoch: 1 | loss: 0.6785071
	speed: 0.0030s/iter; left time: 10.9681s
Updating learning rate to 0.00039412601865045424
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 2.0098161697387695
Epoch: 1, Steps: 514 | Train Loss: 0.6305238 Vali Loss: 0.3741602 Best vali loss: 0.3741602
	iters: 100, epoch: 2 | loss: 1.0868856
	speed: 0.0067s/iter; left time: 23.4932s
	iters: 200, epoch: 2 | loss: 0.8547743
	speed: 0.0031s/iter; left time: 10.5239s
	iters: 300, epoch: 2 | loss: 1.1721483
	speed: 0.0031s/iter; left time: 10.0763s
	iters: 400, epoch: 2 | loss: 0.3725580
	speed: 0.0032s/iter; left time: 10.1017s
	iters: 500, epoch: 2 | loss: 0.6453123
	speed: 0.0032s/iter; left time: 9.8835s
Updating learning rate to 0.00034971794632172426
Validation loss decreased (0.3742 --> 0.3614).  Saving model state dict ...
Epoch: 2 cost time: 1.6305820941925049
Epoch: 2, Steps: 514 | Train Loss: 0.8263357 Vali Loss: 0.3613977 Best vali loss: 0.3613977
	iters: 100, epoch: 3 | loss: 0.9767043
	speed: 0.0077s/iter; left time: 22.8771s
	iters: 200, epoch: 3 | loss: 0.6866376
	speed: 0.0036s/iter; left time: 10.2643s
	iters: 300, epoch: 3 | loss: 0.4166776
	speed: 0.0036s/iter; left time: 10.0520s
	iters: 400, epoch: 3 | loss: 0.6746420
	speed: 0.0036s/iter; left time: 9.6381s
	iters: 500, epoch: 3 | loss: 0.2400973
	speed: 0.0036s/iter; left time: 9.2639s
Updating learning rate to 0.00028325656936568113
Epoch: 3 cost time: 1.8786206245422363
Epoch: 3, Steps: 514 | Train Loss: 0.5989517 Vali Loss: 0.3806501 Best vali loss: 0.3613977

best validation loss 0.3613977254256752

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021281425911, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3334769
	speed: 0.0097s/iter; left time: 23.9809s
	iters: 200, epoch: 4 | loss: 0.3076105
	speed: 0.0035s/iter; left time: 8.2457s
	iters: 300, epoch: 4 | loss: 0.7284724
	speed: 0.0034s/iter; left time: 7.7561s
	iters: 400, epoch: 4 | loss: 0.9029070
	speed: 0.0035s/iter; left time: 7.5200s
	iters: 500, epoch: 4 | loss: 0.4915404
	speed: 0.0034s/iter; left time: 7.0741s
Updating learning rate to 0.00020486002995
Epoch: 4 cost time: 2.1216259002685547
Epoch: 4, Steps: 514 | Train Loss: 0.5528014 Vali Loss: 0.3648671 Best vali loss: 0.3613977
	iters: 100, epoch: 5 | loss: 0.8110588
	speed: 0.0074s/iter; left time: 14.5088s
	iters: 200, epoch: 5 | loss: 0.6998844
	speed: 0.0035s/iter; left time: 6.5656s
	iters: 300, epoch: 5 | loss: 0.7786278
	speed: 0.0036s/iter; left time: 6.2613s
	iters: 400, epoch: 5 | loss: 0.3719021
	speed: 0.0035s/iter; left time: 5.7402s
	iters: 500, epoch: 5 | loss: 0.4829819
	speed: 0.0034s/iter; left time: 5.3211s
Updating learning rate to 0.00012646349053431892
Validation loss decreased (0.3614 --> 0.3595).  Saving model state dict ...
Epoch: 5 cost time: 1.8388009071350098
Epoch: 5, Steps: 514 | Train Loss: 0.6288910 Vali Loss: 0.3594677 Best vali loss: 0.3594677
	iters: 100, epoch: 6 | loss: 0.7305090
	speed: 0.0072s/iter; left time: 10.4296s
	iters: 200, epoch: 6 | loss: 0.5585577
	speed: 0.0036s/iter; left time: 4.8321s
	iters: 300, epoch: 6 | loss: 0.3324015
	speed: 0.0036s/iter; left time: 4.4695s
	iters: 400, epoch: 6 | loss: 0.6191775
	speed: 0.0036s/iter; left time: 4.0638s
	iters: 500, epoch: 6 | loss: 0.2139566
	speed: 0.0034s/iter; left time: 3.5936s
Updating learning rate to 6.000211357827579e-05
Epoch: 6 cost time: 1.83809232711792
Epoch: 6, Steps: 514 | Train Loss: 0.4909205 Vali Loss: 0.3622889 Best vali loss: 0.3594677
	iters: 100, epoch: 7 | loss: 0.4210183
	speed: 0.0074s/iter; left time: 6.9107s
	iters: 200, epoch: 7 | loss: 0.2392075
	speed: 0.0035s/iter; left time: 2.9312s
	iters: 300, epoch: 7 | loss: 0.2419416
	speed: 0.0035s/iter; left time: 2.5598s
	iters: 400, epoch: 7 | loss: 0.2851896
	speed: 0.0034s/iter; left time: 2.1253s
	iters: 500, epoch: 7 | loss: 0.6704301
	speed: 0.0035s/iter; left time: 1.8761s
Updating learning rate to 1.5594041249545802e-05
Validation loss decreased (0.3595 --> 0.3573).  Saving model state dict ...
Epoch: 7 cost time: 1.8405563831329346
Epoch: 7, Steps: 514 | Train Loss: 0.3715574 Vali Loss: 0.3572960 Best vali loss: 0.3572960
	iters: 100, epoch: 8 | loss: 0.3834297
	speed: 0.0073s/iter; left time: 3.0477s
	iters: 200, epoch: 8 | loss: 0.4141334
	speed: 0.0034s/iter; left time: 1.0624s
	iters: 300, epoch: 8 | loss: 0.2126165
	speed: 0.0033s/iter; left time: 0.7118s
	iters: 400, epoch: 8 | loss: 0.5832772
	speed: 0.0035s/iter; left time: 0.3992s
	iters: 500, epoch: 8 | loss: 0.4042814
	speed: 0.0034s/iter; left time: 0.0507s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7836029529571533
Epoch: 8, Steps: 514 | Train Loss: 0.3995476 Vali Loss: 0.3641874 Best vali loss: 0.3572960

best validation loss 0.35729603077081895

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0024229713972, 'e_layers': 4, 'learning_rate': 0.0008842875842, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6420940
	speed: 0.0113s/iter; left time: 45.2077s
	iters: 200, epoch: 1 | loss: 1.2765324
	speed: 0.0052s/iter; left time: 20.2380s
	iters: 300, epoch: 1 | loss: 0.9599038
	speed: 0.0052s/iter; left time: 19.8008s
	iters: 400, epoch: 1 | loss: 0.6622823
	speed: 0.0053s/iter; left time: 19.5447s
	iters: 500, epoch: 1 | loss: 0.2083123
	speed: 0.0052s/iter; left time: 18.8240s
Updating learning rate to 0.0008506313920481156
Validation loss decreased (inf --> 0.4040).  Saving model state dict ...
Epoch: 1 cost time: 3.0129735469818115
Epoch: 1, Steps: 514 | Train Loss: 0.7498250 Vali Loss: 0.4040460 Best vali loss: 0.4040460
	iters: 100, epoch: 2 | loss: 0.5863232
	speed: 0.0099s/iter; left time: 34.7983s
	iters: 200, epoch: 2 | loss: 0.6491535
	speed: 0.0054s/iter; left time: 18.3234s
	iters: 300, epoch: 2 | loss: 0.6877084
	speed: 0.0054s/iter; left time: 17.7224s
	iters: 400, epoch: 2 | loss: 0.3737763
	speed: 0.0049s/iter; left time: 15.8236s
	iters: 500, epoch: 2 | loss: 0.7371947
	speed: 0.0050s/iter; left time: 15.4137s
Updating learning rate to 0.000754786665753445
Epoch: 2 cost time: 2.6910669803619385
Epoch: 2, Steps: 514 | Train Loss: 0.6068312 Vali Loss: 0.4045582 Best vali loss: 0.4040460
	iters: 100, epoch: 3 | loss: 0.8023711
	speed: 0.0099s/iter; left time: 29.6299s
	iters: 200, epoch: 3 | loss: 0.7544531
	speed: 0.0050s/iter; left time: 14.4898s
	iters: 300, epoch: 3 | loss: 0.3618901
	speed: 0.0050s/iter; left time: 13.8026s
	iters: 400, epoch: 3 | loss: 0.2758062
	speed: 0.0050s/iter; left time: 13.3781s
	iters: 500, epoch: 3 | loss: 1.0186538
	speed: 0.0050s/iter; left time: 12.8943s
Updating learning rate to 0.0006113448960597447
Epoch: 3 cost time: 2.612898349761963
Epoch: 3, Steps: 514 | Train Loss: 0.6426348 Vali Loss: 0.4092670 Best vali loss: 0.4040460
	iters: 100, epoch: 4 | loss: 0.7465993
	speed: 0.0100s/iter; left time: 24.7966s
	iters: 200, epoch: 4 | loss: 0.4768479
	speed: 0.0053s/iter; left time: 12.5534s
	iters: 300, epoch: 4 | loss: 0.3749027
	speed: 0.0053s/iter; left time: 12.0148s
	iters: 400, epoch: 4 | loss: 0.7502415
	speed: 0.0053s/iter; left time: 11.4869s
	iters: 500, epoch: 4 | loss: 0.4503354
	speed: 0.0053s/iter; left time: 10.9426s
Updating learning rate to 0.0004421437921
Validation loss decreased (0.4040 --> 0.4040).  Saving model state dict ...
Epoch: 4 cost time: 2.759861946105957
Epoch: 4, Steps: 514 | Train Loss: 0.5597854 Vali Loss: 0.4039614 Best vali loss: 0.4039614
	iters: 100, epoch: 5 | loss: 0.3779781
	speed: 0.0100s/iter; left time: 19.6517s
	iters: 200, epoch: 5 | loss: 0.4040578
	speed: 0.0051s/iter; left time: 9.4751s
	iters: 300, epoch: 5 | loss: 0.7533711
	speed: 0.0048s/iter; left time: 8.4303s
	iters: 400, epoch: 5 | loss: 0.5335380
	speed: 0.0047s/iter; left time: 7.7191s
	iters: 500, epoch: 5 | loss: 0.7249991
	speed: 0.0046s/iter; left time: 7.2277s
Updating learning rate to 0.00027294268814025537
Validation loss decreased (0.4040 --> 0.4039).  Saving model state dict ...
Epoch: 5 cost time: 2.534636974334717
Epoch: 5, Steps: 514 | Train Loss: 0.5587888 Vali Loss: 0.4038824 Best vali loss: 0.4038824
	iters: 100, epoch: 6 | loss: 0.5081214
	speed: 0.0103s/iter; left time: 14.8621s
	iters: 200, epoch: 6 | loss: 0.4695046
	speed: 0.0054s/iter; left time: 7.1991s
	iters: 300, epoch: 6 | loss: 1.0159889
	speed: 0.0052s/iter; left time: 6.5149s
	iters: 400, epoch: 6 | loss: 0.4888426
	speed: 0.0053s/iter; left time: 6.0282s
	iters: 500, epoch: 6 | loss: 0.9094183
	speed: 0.0053s/iter; left time: 5.5299s
Updating learning rate to 0.00012950091844655498
Epoch: 6 cost time: 2.7656805515289307
Epoch: 6, Steps: 514 | Train Loss: 0.6783752 Vali Loss: 0.4038842 Best vali loss: 0.4038824
	iters: 100, epoch: 7 | loss: 0.4717874
	speed: 0.0103s/iter; left time: 9.5292s
	iters: 200, epoch: 7 | loss: 0.4487892
	speed: 0.0053s/iter; left time: 4.3924s
	iters: 300, epoch: 7 | loss: 0.6319897
	speed: 0.0053s/iter; left time: 3.8863s
	iters: 400, epoch: 7 | loss: 0.8027917
	speed: 0.0053s/iter; left time: 3.3622s
	iters: 500, epoch: 7 | loss: 0.6076572
	speed: 0.0053s/iter; left time: 2.8120s
Updating learning rate to 3.365619215188444e-05
Validation loss decreased (0.4039 --> 0.4036).  Saving model state dict ...
Epoch: 7 cost time: 2.7768466472625732
Epoch: 7, Steps: 514 | Train Loss: 0.5926030 Vali Loss: 0.4035937 Best vali loss: 0.4035937
	iters: 100, epoch: 8 | loss: 0.8506162
	speed: 0.0102s/iter; left time: 4.2411s
	iters: 200, epoch: 8 | loss: 0.4403516
	speed: 0.0050s/iter; left time: 1.5657s
	iters: 300, epoch: 8 | loss: 0.3717678
	speed: 0.0049s/iter; left time: 1.0580s
	iters: 400, epoch: 8 | loss: 0.6755384
	speed: 0.0049s/iter; left time: 0.5610s
	iters: 500, epoch: 8 | loss: 0.6028427
	speed: 0.0048s/iter; left time: 0.0716s
Updating learning rate to 0.0
Validation loss decreased (0.4036 --> 0.4036).  Saving model state dict ...
Epoch: 8 cost time: 2.5596911907196045
Epoch: 8, Steps: 514 | Train Loss: 0.5882233 Vali Loss: 0.4035786 Best vali loss: 0.4035786

best validation loss 0.40357860912274285

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.001178424473, 'e_layers': 2, 'learning_rate': 0.0004097656938, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3532385
	speed: 0.0097s/iter; left time: 38.7624s
	iters: 200, epoch: 1 | loss: 0.3364816
	speed: 0.0032s/iter; left time: 12.4702s
	iters: 300, epoch: 1 | loss: 0.8893860
	speed: 0.0034s/iter; left time: 13.0948s
	iters: 400, epoch: 1 | loss: 0.8951327
	speed: 0.0034s/iter; left time: 12.8097s
	iters: 500, epoch: 1 | loss: 0.6737937
	speed: 0.0032s/iter; left time: 11.4730s
Updating learning rate to 0.00039416991571355353
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 2.06347393989563
Epoch: 1, Steps: 514 | Train Loss: 0.6296065 Vali Loss: 0.3682933 Best vali loss: 0.3682933
	iters: 100, epoch: 2 | loss: 1.0830057
	speed: 0.0075s/iter; left time: 26.1302s
	iters: 200, epoch: 2 | loss: 0.8508241
	speed: 0.0033s/iter; left time: 11.0556s
	iters: 300, epoch: 2 | loss: 1.2440063
	speed: 0.0033s/iter; left time: 10.8877s
	iters: 400, epoch: 2 | loss: 0.3746426
	speed: 0.0033s/iter; left time: 10.5624s
	iters: 500, epoch: 2 | loss: 0.6350144
	speed: 0.0033s/iter; left time: 10.2254s
Updating learning rate to 0.00034975689729179523
Epoch: 2 cost time: 1.7347767353057861
Epoch: 2, Steps: 514 | Train Loss: 0.8374986 Vali Loss: 0.3727903 Best vali loss: 0.3682933
	iters: 100, epoch: 3 | loss: 0.9812296
	speed: 0.0074s/iter; left time: 22.1698s
	iters: 200, epoch: 3 | loss: 0.6604096
	speed: 0.0032s/iter; left time: 9.2981s
	iters: 300, epoch: 3 | loss: 0.4263982
	speed: 0.0032s/iter; left time: 8.8352s
	iters: 400, epoch: 3 | loss: 0.6618364
	speed: 0.0031s/iter; left time: 8.4084s
	iters: 500, epoch: 3 | loss: 0.2358305
	speed: 0.0032s/iter; left time: 8.1918s
Updating learning rate to 0.0002832881179844232
Validation loss decreased (0.3683 --> 0.3615).  Saving model state dict ...
Epoch: 3 cost time: 1.6969871520996094
Epoch: 3, Steps: 514 | Train Loss: 0.5931409 Vali Loss: 0.3614735 Best vali loss: 0.3614735
	iters: 100, epoch: 4 | loss: 0.5069301
	speed: 0.0073s/iter; left time: 18.0035s
	iters: 200, epoch: 4 | loss: 0.3161249
	speed: 0.0034s/iter; left time: 7.9848s
	iters: 300, epoch: 4 | loss: 0.3100854
	speed: 0.0035s/iter; left time: 7.9145s
	iters: 400, epoch: 4 | loss: 0.3701386
	speed: 0.0033s/iter; left time: 7.1462s
	iters: 500, epoch: 4 | loss: 0.7788895
	speed: 0.0034s/iter; left time: 6.9529s
Updating learning rate to 0.0002048828469
Validation loss decreased (0.3615 --> 0.3612).  Saving model state dict ...
Epoch: 4 cost time: 1.7658274173736572
Epoch: 4, Steps: 514 | Train Loss: 0.4564337 Vali Loss: 0.3611872 Best vali loss: 0.3611872
	iters: 100, epoch: 5 | loss: 0.4252644
	speed: 0.0075s/iter; left time: 14.6792s
	iters: 200, epoch: 5 | loss: 0.4752808
	speed: 0.0035s/iter; left time: 6.5451s
	iters: 300, epoch: 5 | loss: 0.2286633
	speed: 0.0035s/iter; left time: 6.1355s
	iters: 400, epoch: 5 | loss: 0.6229273
	speed: 0.0036s/iter; left time: 5.8897s
	iters: 500, epoch: 5 | loss: 0.4820051
	speed: 0.0036s/iter; left time: 5.5897s
Updating learning rate to 0.0001264775758155768
Validation loss decreased (0.3612 --> 0.3534).  Saving model state dict ...
Epoch: 5 cost time: 1.862206220626831
Epoch: 5, Steps: 514 | Train Loss: 0.4468282 Vali Loss: 0.3534341 Best vali loss: 0.3534341
	iters: 100, epoch: 6 | loss: 0.2246303
	speed: 0.0074s/iter; left time: 10.6452s
	iters: 200, epoch: 6 | loss: 0.2538865
	speed: 0.0035s/iter; left time: 4.6812s
	iters: 300, epoch: 6 | loss: 0.3742194
	speed: 0.0036s/iter; left time: 4.4150s
	iters: 400, epoch: 6 | loss: 0.4046593
	speed: 0.0035s/iter; left time: 4.0181s
	iters: 500, epoch: 6 | loss: 0.3520461
	speed: 0.0034s/iter; left time: 3.5733s
Updating learning rate to 6.0008796508204796e-05
Epoch: 6 cost time: 1.8388862609863281
Epoch: 6, Steps: 514 | Train Loss: 0.3218883 Vali Loss: 0.3580702 Best vali loss: 0.3534341
	iters: 100, epoch: 7 | loss: 0.4173387
	speed: 0.0072s/iter; left time: 6.6768s
	iters: 200, epoch: 7 | loss: 0.4998238
	speed: 0.0034s/iter; left time: 2.8531s
	iters: 300, epoch: 7 | loss: 0.6931074
	speed: 0.0035s/iter; left time: 2.5447s
	iters: 400, epoch: 7 | loss: 0.5660851
	speed: 0.0034s/iter; left time: 2.1288s
	iters: 500, epoch: 7 | loss: 0.2601196
	speed: 0.0036s/iter; left time: 1.8855s
Updating learning rate to 1.559577808644647e-05
Epoch: 7 cost time: 1.8235065937042236
Epoch: 7, Steps: 514 | Train Loss: 0.4872949 Vali Loss: 0.3580108 Best vali loss: 0.3534341
	iters: 100, epoch: 8 | loss: 0.2591417
	speed: 0.0071s/iter; left time: 2.9552s
	iters: 200, epoch: 8 | loss: 0.4365425
	speed: 0.0033s/iter; left time: 1.0399s
	iters: 300, epoch: 8 | loss: 0.2754272
	speed: 0.0033s/iter; left time: 0.7068s
	iters: 400, epoch: 8 | loss: 0.3949634
	speed: 0.0033s/iter; left time: 0.3788s
	iters: 500, epoch: 8 | loss: 0.3404767
	speed: 0.0034s/iter; left time: 0.0510s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7566850185394287
Epoch: 8, Steps: 514 | Train Loss: 0.3413103 Vali Loss: 0.3588135 Best vali loss: 0.3534341

best validation loss 0.3534341327450833

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011197228014, 'e_layers': 2, 'learning_rate': 0.0004806042017, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5106087
	speed: 0.0101s/iter; left time: 9.4064s
Updating learning rate to 0.00046231229344477807
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 0.8330914974212646
Epoch: 1, Steps: 129 | Train Loss: 0.5106087 Vali Loss: 0.3692741 Best vali loss: 0.3692741
	iters: 100, epoch: 2 | loss: 0.9130051
	speed: 0.0068s/iter; left time: 5.4712s
Updating learning rate to 0.0004102213458944086
Validation loss decreased (0.3693 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 0.5299050807952881
Epoch: 2, Steps: 129 | Train Loss: 0.9130051 Vali Loss: 0.3642061 Best vali loss: 0.3642061
	iters: 100, epoch: 3 | loss: 0.7431381
	speed: 0.0065s/iter; left time: 4.4060s
Updating learning rate to 0.00033226173360782
Epoch: 3 cost time: 0.5184047222137451
Epoch: 3, Steps: 129 | Train Loss: 0.7431381 Vali Loss: 0.3693923 Best vali loss: 0.3642061

best validation loss 0.36420613543692176

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021448340855, 'e_layers': 2, 'learning_rate': 0.0004117228454, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9688666
	speed: 0.0097s/iter; left time: 39.0839s
	iters: 200, epoch: 1 | loss: 0.3816662
	speed: 0.0033s/iter; left time: 12.7345s
	iters: 300, epoch: 1 | loss: 0.4521818
	speed: 0.0034s/iter; left time: 12.8516s
	iters: 400, epoch: 1 | loss: 0.3948605
	speed: 0.0033s/iter; left time: 12.0853s
	iters: 500, epoch: 1 | loss: 0.3064637
	speed: 0.0033s/iter; left time: 11.9489s
Updating learning rate to 0.0003960525776661844
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 2.063662052154541
Epoch: 1, Steps: 514 | Train Loss: 0.5008078 Vali Loss: 0.3680771 Best vali loss: 0.3680771
	iters: 100, epoch: 2 | loss: 0.6487213
	speed: 0.0072s/iter; left time: 25.1835s
	iters: 200, epoch: 2 | loss: 0.4888271
	speed: 0.0034s/iter; left time: 11.6278s
	iters: 300, epoch: 2 | loss: 0.3228513
	speed: 0.0033s/iter; left time: 10.8886s
	iters: 400, epoch: 2 | loss: 0.6734290
	speed: 0.0033s/iter; left time: 10.7161s
	iters: 500, epoch: 2 | loss: 0.2764287
	speed: 0.0035s/iter; left time: 10.8377s
Updating learning rate to 0.00035142743067588023
Validation loss decreased (0.3681 --> 0.3524).  Saving model state dict ...
Epoch: 2 cost time: 1.7768702507019043
Epoch: 2, Steps: 514 | Train Loss: 0.4820515 Vali Loss: 0.3523550 Best vali loss: 0.3523550
	iters: 100, epoch: 3 | loss: 0.6911196
	speed: 0.0073s/iter; left time: 21.6977s
	iters: 200, epoch: 3 | loss: 0.5863482
	speed: 0.0031s/iter; left time: 9.0816s
	iters: 300, epoch: 3 | loss: 0.5677306
	speed: 0.0031s/iter; left time: 8.7155s
	iters: 400, epoch: 3 | loss: 0.4249695
	speed: 0.0032s/iter; left time: 8.6074s
	iters: 500, epoch: 3 | loss: 0.5409002
	speed: 0.0034s/iter; left time: 8.8713s
Updating learning rate to 0.0002846411785303966
Epoch: 3 cost time: 1.7149131298065186
Epoch: 3, Steps: 514 | Train Loss: 0.5622136 Vali Loss: 0.3652688 Best vali loss: 0.3523550

best validation loss 0.3523550449455183

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0019777744911, 'e_layers': 2, 'learning_rate': 0.0004106702617, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9689279
	speed: 0.0097s/iter; left time: 38.9115s
	iters: 200, epoch: 1 | loss: 0.3820098
	speed: 0.0036s/iter; left time: 13.9163s
	iters: 300, epoch: 1 | loss: 0.4468170
	speed: 0.0034s/iter; left time: 13.1328s
	iters: 400, epoch: 1 | loss: 0.3942637
	speed: 0.0036s/iter; left time: 13.5218s
	iters: 500, epoch: 1 | loss: 0.3040098
	speed: 0.0035s/iter; left time: 12.5658s
Updating learning rate to 0.0003950400555478419
Validation loss decreased (inf --> 0.3684).  Saving model state dict ...
Epoch: 1 cost time: 2.157931089401245
Epoch: 1, Steps: 514 | Train Loss: 0.4992056 Vali Loss: 0.3684294 Best vali loss: 0.3684294
	iters: 100, epoch: 2 | loss: 0.6419452
	speed: 0.0074s/iter; left time: 25.9533s
	iters: 200, epoch: 2 | loss: 0.4965692
	speed: 0.0034s/iter; left time: 11.5540s
	iters: 300, epoch: 2 | loss: 0.3344693
	speed: 0.0035s/iter; left time: 11.5887s
	iters: 400, epoch: 2 | loss: 0.6867121
	speed: 0.0034s/iter; left time: 10.8828s
	iters: 500, epoch: 2 | loss: 0.2809135
	speed: 0.0036s/iter; left time: 11.0165s
Updating learning rate to 0.00035052899428986205
Validation loss decreased (0.3684 --> 0.3657).  Saving model state dict ...
Epoch: 2 cost time: 1.8281996250152588
Epoch: 2, Steps: 514 | Train Loss: 0.4881219 Vali Loss: 0.3657474 Best vali loss: 0.3657474
	iters: 100, epoch: 3 | loss: 0.6981665
	speed: 0.0074s/iter; left time: 21.9749s
	iters: 200, epoch: 3 | loss: 0.5873234
	speed: 0.0030s/iter; left time: 8.5390s
	iters: 300, epoch: 3 | loss: 0.5542623
	speed: 0.0030s/iter; left time: 8.4764s
	iters: 400, epoch: 3 | loss: 0.4127706
	speed: 0.0030s/iter; left time: 8.1726s
	iters: 500, epoch: 3 | loss: 0.5621528
	speed: 0.0029s/iter; left time: 7.6003s
Updating learning rate to 0.00028391348350881285
Epoch: 3 cost time: 1.6110265254974365
Epoch: 3, Steps: 514 | Train Loss: 0.5629351 Vali Loss: 0.3746576 Best vali loss: 0.3657474

best validation loss 0.365747417003092

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021448340855, 'e_layers': 2, 'learning_rate': 0.0004117228454, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9085376
	speed: 0.0098s/iter; left time: 24.2244s
	iters: 200, epoch: 4 | loss: 0.3322760
	speed: 0.0035s/iter; left time: 8.3901s
	iters: 300, epoch: 4 | loss: 0.3319331
	speed: 0.0033s/iter; left time: 7.4277s
	iters: 400, epoch: 4 | loss: 0.3511029
	speed: 0.0032s/iter; left time: 6.9624s
	iters: 500, epoch: 4 | loss: 0.2554011
	speed: 0.0032s/iter; left time: 6.5390s
Updating learning rate to 0.0002058614227
Epoch: 4 cost time: 2.0549330711364746
Epoch: 4, Steps: 514 | Train Loss: 0.4358501 Vali Loss: 0.3562980 Best vali loss: 0.3523550
	iters: 100, epoch: 5 | loss: 0.5428020
	speed: 0.0068s/iter; left time: 13.2122s
	iters: 200, epoch: 5 | loss: 0.4164480
	speed: 0.0031s/iter; left time: 5.7133s
	iters: 300, epoch: 5 | loss: 0.3169929
	speed: 0.0031s/iter; left time: 5.4252s
	iters: 400, epoch: 5 | loss: 0.5366006
	speed: 0.0030s/iter; left time: 5.0058s
	iters: 500, epoch: 5 | loss: 0.2316099
	speed: 0.0031s/iter; left time: 4.8286s
Updating learning rate to 0.0001270816668696034
Validation loss decreased (0.3524 --> 0.3487).  Saving model state dict ...
Epoch: 5 cost time: 1.6165320873260498
Epoch: 5, Steps: 514 | Train Loss: 0.4088907 Vali Loss: 0.3487186 Best vali loss: 0.3487186
	iters: 100, epoch: 6 | loss: 0.6643195
	speed: 0.0070s/iter; left time: 10.1589s
	iters: 200, epoch: 6 | loss: 0.4780237
	speed: 0.0032s/iter; left time: 4.2767s
	iters: 300, epoch: 6 | loss: 0.4600463
	speed: 0.0031s/iter; left time: 3.8627s
	iters: 400, epoch: 6 | loss: 0.3686510
	speed: 0.0031s/iter; left time: 3.5446s
	iters: 500, epoch: 6 | loss: 0.4777398
	speed: 0.0032s/iter; left time: 3.3526s
Updating learning rate to 6.029541472411975e-05
Epoch: 6 cost time: 1.6625874042510986
Epoch: 6, Steps: 514 | Train Loss: 0.4897560 Vali Loss: 0.3500474 Best vali loss: 0.3487186
	iters: 100, epoch: 7 | loss: 0.4761986
	speed: 0.0068s/iter; left time: 6.2903s
	iters: 200, epoch: 7 | loss: 0.7742492
	speed: 0.0031s/iter; left time: 2.5483s
	iters: 300, epoch: 7 | loss: 0.2838255
	speed: 0.0031s/iter; left time: 2.2810s
	iters: 400, epoch: 7 | loss: 0.6194262
	speed: 0.0031s/iter; left time: 1.9345s
	iters: 500, epoch: 7 | loss: 0.5559105
	speed: 0.0031s/iter; left time: 1.6450s
Updating learning rate to 1.5670267733815607e-05
Epoch: 7 cost time: 1.6294829845428467
Epoch: 7, Steps: 514 | Train Loss: 0.5419220 Vali Loss: 0.3524787 Best vali loss: 0.3487186
	iters: 100, epoch: 8 | loss: 0.5291567
	speed: 0.0073s/iter; left time: 3.0248s
	iters: 200, epoch: 8 | loss: 0.1976221
	speed: 0.0031s/iter; left time: 0.9708s
	iters: 300, epoch: 8 | loss: 0.3756500
	speed: 0.0033s/iter; left time: 0.7011s
	iters: 400, epoch: 8 | loss: 0.2327322
	speed: 0.0031s/iter; left time: 0.3565s
	iters: 500, epoch: 8 | loss: 0.5390729
	speed: 0.0030s/iter; left time: 0.0454s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6680903434753418
Epoch: 8, Steps: 514 | Train Loss: 0.3748468 Vali Loss: 0.3559506 Best vali loss: 0.3487186

best validation loss 0.3487186010085295

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018972110637, 'e_layers': 2, 'learning_rate': 0.000413435944, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9688326
	speed: 0.0092s/iter; left time: 37.0289s
	iters: 200, epoch: 1 | loss: 0.3821151
	speed: 0.0032s/iter; left time: 12.6233s
	iters: 300, epoch: 1 | loss: 0.4460894
	speed: 0.0032s/iter; left time: 12.3476s
	iters: 400, epoch: 1 | loss: 0.3922633
	speed: 0.0032s/iter; left time: 12.0215s
	iters: 500, epoch: 1 | loss: 0.3037412
	speed: 0.0032s/iter; left time: 11.5343s
Updating learning rate to 0.0003977004753330413
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.9995388984680176
Epoch: 1, Steps: 514 | Train Loss: 0.4986083 Vali Loss: 0.3672527 Best vali loss: 0.3672527
	iters: 100, epoch: 2 | loss: 0.6425653
	speed: 0.0072s/iter; left time: 25.1085s
	iters: 200, epoch: 2 | loss: 0.4695564
	speed: 0.0031s/iter; left time: 10.4350s
	iters: 300, epoch: 2 | loss: 0.3296671
	speed: 0.0031s/iter; left time: 10.1161s
	iters: 400, epoch: 2 | loss: 0.6838803
	speed: 0.0031s/iter; left time: 9.8612s
	iters: 500, epoch: 2 | loss: 0.2869506
	speed: 0.0031s/iter; left time: 9.6552s
Updating learning rate to 0.00035288965179433086
Epoch: 2 cost time: 1.6397500038146973
Epoch: 2, Steps: 514 | Train Loss: 0.4825239 Vali Loss: 0.3675766 Best vali loss: 0.3672527
	iters: 100, epoch: 3 | loss: 0.6888233
	speed: 0.0067s/iter; left time: 20.0185s
	iters: 200, epoch: 3 | loss: 0.5728894
	speed: 0.0031s/iter; left time: 8.8686s
	iters: 300, epoch: 3 | loss: 0.5481440
	speed: 0.0030s/iter; left time: 8.2524s
	iters: 400, epoch: 3 | loss: 0.4143481
	speed: 0.0031s/iter; left time: 8.3332s
	iters: 500, epoch: 3 | loss: 0.5302575
	speed: 0.0031s/iter; left time: 8.0004s
Updating learning rate to 0.00028582551505651054
Validation loss decreased (0.3673 --> 0.3529).  Saving model state dict ...
Epoch: 3 cost time: 1.6136517524719238
Epoch: 3, Steps: 514 | Train Loss: 0.5508925 Vali Loss: 0.3529285 Best vali loss: 0.3529285
	iters: 100, epoch: 4 | loss: 0.5422753
	speed: 0.0077s/iter; left time: 19.0254s
	iters: 200, epoch: 4 | loss: 0.8234099
	speed: 0.0034s/iter; left time: 8.1272s
	iters: 300, epoch: 4 | loss: 0.3009431
	speed: 0.0034s/iter; left time: 7.7668s
	iters: 400, epoch: 4 | loss: 0.6908323
	speed: 0.0034s/iter; left time: 7.4761s
	iters: 500, epoch: 4 | loss: 0.6481312
	speed: 0.0033s/iter; left time: 6.8830s
Updating learning rate to 0.000206717972
Validation loss decreased (0.3529 --> 0.3479).  Saving model state dict ...
Epoch: 4 cost time: 1.8048450946807861
Epoch: 4, Steps: 514 | Train Loss: 0.6011184 Vali Loss: 0.3479313 Best vali loss: 0.3479313
	iters: 100, epoch: 5 | loss: 0.5471599
	speed: 0.0069s/iter; left time: 13.5905s
	iters: 200, epoch: 5 | loss: 0.2273293
	speed: 0.0031s/iter; left time: 5.7197s
	iters: 300, epoch: 5 | loss: 0.4059965
	speed: 0.0032s/iter; left time: 5.5709s
	iters: 400, epoch: 5 | loss: 0.2430643
	speed: 0.0032s/iter; left time: 5.2652s
	iters: 500, epoch: 5 | loss: 0.5668468
	speed: 0.0032s/iter; left time: 4.9799s
Updating learning rate to 0.00012761042894348949
Epoch: 5 cost time: 1.6516005992889404
Epoch: 5, Steps: 514 | Train Loss: 0.3980794 Vali Loss: 0.3517121 Best vali loss: 0.3479313
	iters: 100, epoch: 6 | loss: 0.2698811
	speed: 0.0074s/iter; left time: 10.7249s
	iters: 200, epoch: 6 | loss: 0.3625165
	speed: 0.0033s/iter; left time: 4.3916s
	iters: 300, epoch: 6 | loss: 0.3794889
	speed: 0.0035s/iter; left time: 4.3071s
	iters: 400, epoch: 6 | loss: 0.2696544
	speed: 0.0034s/iter; left time: 3.9362s
	iters: 500, epoch: 6 | loss: 0.4356635
	speed: 0.0033s/iter; left time: 3.4405s
Updating learning rate to 6.054629220566915e-05
Epoch: 6 cost time: 1.796069622039795
Epoch: 6, Steps: 514 | Train Loss: 0.3434409 Vali Loss: 0.3490978 Best vali loss: 0.3479313
	iters: 100, epoch: 7 | loss: 0.2261789
	speed: 0.0075s/iter; left time: 6.9975s
	iters: 200, epoch: 7 | loss: 0.3958460
	speed: 0.0035s/iter; left time: 2.8855s
	iters: 300, epoch: 7 | loss: 0.3565674
	speed: 0.0035s/iter; left time: 2.5232s
	iters: 400, epoch: 7 | loss: 0.4208364
	speed: 0.0035s/iter; left time: 2.1896s
	iters: 500, epoch: 7 | loss: 0.3535747
	speed: 0.0035s/iter; left time: 1.8732s
Updating learning rate to 1.5735468666958738e-05
Epoch: 7 cost time: 1.847787857055664
Epoch: 7, Steps: 514 | Train Loss: 0.3506007 Vali Loss: 0.3535069 Best vali loss: 0.3479313
	iters: 100, epoch: 8 | loss: 0.2870782
	speed: 0.0072s/iter; left time: 2.9722s
	iters: 200, epoch: 8 | loss: 0.4185278
	speed: 0.0034s/iter; left time: 1.0662s
	iters: 300, epoch: 8 | loss: 0.3706549
	speed: 0.0033s/iter; left time: 0.7069s
	iters: 400, epoch: 8 | loss: 0.5482476
	speed: 0.0033s/iter; left time: 0.3795s
	iters: 500, epoch: 8 | loss: 0.3929039
	speed: 0.0034s/iter; left time: 0.0515s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7668147087097168
Epoch: 8, Steps: 514 | Train Loss: 0.4034825 Vali Loss: 0.3506242 Best vali loss: 0.3479313

best validation loss 0.3479313420874665

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0009589403132, 'e_layers': 2, 'learning_rate': 0.0004129821724, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9687380
	speed: 0.0096s/iter; left time: 38.3993s
	iters: 200, epoch: 1 | loss: 0.3822984
	speed: 0.0033s/iter; left time: 13.0039s
	iters: 300, epoch: 1 | loss: 0.4454853
	speed: 0.0033s/iter; left time: 12.4856s
	iters: 400, epoch: 1 | loss: 0.3947326
	speed: 0.0033s/iter; left time: 12.1453s
	iters: 500, epoch: 1 | loss: 0.3032325
	speed: 0.0033s/iter; left time: 11.7478s
Updating learning rate to 0.0003972639743862038
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 2.0389461517333984
Epoch: 1, Steps: 514 | Train Loss: 0.4988973 Vali Loss: 0.3691855 Best vali loss: 0.3691855
	iters: 100, epoch: 2 | loss: 0.6406296
	speed: 0.0072s/iter; left time: 25.3401s
	iters: 200, epoch: 2 | loss: 0.4654045
	speed: 0.0032s/iter; left time: 10.9009s
	iters: 300, epoch: 2 | loss: 0.3188379
	speed: 0.0033s/iter; left time: 10.7854s
	iters: 400, epoch: 2 | loss: 0.8608540
	speed: 0.0031s/iter; left time: 9.9754s
	iters: 500, epoch: 2 | loss: 0.2709118
	speed: 0.0031s/iter; left time: 9.6966s
Updating learning rate to 0.0003525023335065959
Validation loss decreased (0.3692 --> 0.3596).  Saving model state dict ...
Epoch: 2 cost time: 1.6935999393463135
Epoch: 2, Steps: 514 | Train Loss: 0.5113276 Vali Loss: 0.3596243 Best vali loss: 0.3596243
	iters: 100, epoch: 3 | loss: 0.6837286
	speed: 0.0074s/iter; left time: 21.9508s
	iters: 200, epoch: 3 | loss: 0.5747974
	speed: 0.0032s/iter; left time: 9.2116s
	iters: 300, epoch: 3 | loss: 0.5410737
	speed: 0.0033s/iter; left time: 9.1072s
	iters: 400, epoch: 3 | loss: 0.3976902
	speed: 0.0032s/iter; left time: 8.6510s
	iters: 500, epoch: 3 | loss: 0.5453534
	speed: 0.0032s/iter; left time: 8.3050s
Updating learning rate to 0.0002855118038198116
Epoch: 3 cost time: 1.701911211013794
Epoch: 3, Steps: 514 | Train Loss: 0.5485287 Vali Loss: 0.3672638 Best vali loss: 0.3596243
	iters: 100, epoch: 4 | loss: 0.5707952
	speed: 0.0075s/iter; left time: 18.4256s
	iters: 200, epoch: 4 | loss: 0.8356835
	speed: 0.0033s/iter; left time: 7.8295s
	iters: 300, epoch: 4 | loss: 0.2978651
	speed: 0.0032s/iter; left time: 7.3725s
	iters: 400, epoch: 4 | loss: 0.6817104
	speed: 0.0032s/iter; left time: 6.8446s
	iters: 500, epoch: 4 | loss: 0.6400076
	speed: 0.0031s/iter; left time: 6.4313s
Updating learning rate to 0.0002064910862
Validation loss decreased (0.3596 --> 0.3485).  Saving model state dict ...
Epoch: 4 cost time: 1.726149559020996
Epoch: 4, Steps: 514 | Train Loss: 0.6052123 Vali Loss: 0.3484616 Best vali loss: 0.3484616
	iters: 100, epoch: 5 | loss: 0.5302727
	speed: 0.0070s/iter; left time: 13.7045s
	iters: 200, epoch: 5 | loss: 0.2341611
	speed: 0.0032s/iter; left time: 5.9476s
	iters: 300, epoch: 5 | loss: 0.4136965
	speed: 0.0032s/iter; left time: 5.6500s
	iters: 400, epoch: 5 | loss: 0.2437911
	speed: 0.0032s/iter; left time: 5.2959s
	iters: 500, epoch: 5 | loss: 0.5916734
	speed: 0.0032s/iter; left time: 5.0106s
Updating learning rate to 0.0001274703685801884
Epoch: 5 cost time: 1.6789329051971436
Epoch: 5, Steps: 514 | Train Loss: 0.4027190 Vali Loss: 0.3632272 Best vali loss: 0.3484616
	iters: 100, epoch: 6 | loss: 0.2741993
	speed: 0.0071s/iter; left time: 10.2620s
	iters: 200, epoch: 6 | loss: 0.3742433
	speed: 0.0031s/iter; left time: 4.1160s
	iters: 300, epoch: 6 | loss: 0.3810759
	speed: 0.0031s/iter; left time: 3.7932s
	iters: 400, epoch: 6 | loss: 0.2736997
	speed: 0.0032s/iter; left time: 3.6222s
	iters: 500, epoch: 6 | loss: 0.4268080
	speed: 0.0031s/iter; left time: 3.1888s
Updating learning rate to 6.0479838893404085e-05
Epoch: 6 cost time: 1.6418650150299072
Epoch: 6, Steps: 514 | Train Loss: 0.3460052 Vali Loss: 0.3528487 Best vali loss: 0.3484616
	iters: 100, epoch: 7 | loss: 0.2294854
	speed: 0.0069s/iter; left time: 6.4481s
	iters: 200, epoch: 7 | loss: 0.3771497
	speed: 0.0031s/iter; left time: 2.5524s
	iters: 300, epoch: 7 | loss: 0.3501703
	speed: 0.0031s/iter; left time: 2.2458s
	iters: 400, epoch: 7 | loss: 0.4127772
	speed: 0.0031s/iter; left time: 1.9395s
	iters: 500, epoch: 7 | loss: 0.3392512
	speed: 0.0031s/iter; left time: 1.6293s
Updating learning rate to 1.5718198013796187e-05
Epoch: 7 cost time: 1.6326861381530762
Epoch: 7, Steps: 514 | Train Loss: 0.3417667 Vali Loss: 0.3617498 Best vali loss: 0.3484616
	iters: 100, epoch: 8 | loss: 0.2980304
	speed: 0.0073s/iter; left time: 3.0396s
	iters: 200, epoch: 8 | loss: 0.4064414
	speed: 0.0035s/iter; left time: 1.0976s
	iters: 300, epoch: 8 | loss: 0.3686873
	speed: 0.0034s/iter; left time: 0.7253s
	iters: 400, epoch: 8 | loss: 0.5507282
	speed: 0.0034s/iter; left time: 0.3882s
	iters: 500, epoch: 8 | loss: 0.3891639
	speed: 0.0033s/iter; left time: 0.0501s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7908985614776611
Epoch: 8, Steps: 514 | Train Loss: 0.4026102 Vali Loss: 0.3583662 Best vali loss: 0.3484616

best validation loss 0.3484615602550666

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.002177324515, 'e_layers': 2, 'learning_rate': 0.0004097216472, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8049661
	speed: 0.0095s/iter; left time: 37.9746s
	iters: 200, epoch: 1 | loss: 0.3313222
	speed: 0.0035s/iter; left time: 13.7650s
	iters: 300, epoch: 1 | loss: 0.5308302
	speed: 0.0031s/iter; left time: 11.8129s
	iters: 400, epoch: 1 | loss: 1.0704669
	speed: 0.0032s/iter; left time: 11.8974s
	iters: 500, epoch: 1 | loss: 0.9075034
	speed: 0.0032s/iter; left time: 11.5746s
Updating learning rate to 0.0003941275455374452
Validation loss decreased (inf --> 0.3952).  Saving model state dict ...
Epoch: 1 cost time: 2.012336015701294
Epoch: 1, Steps: 514 | Train Loss: 0.7290177 Vali Loss: 0.3951761 Best vali loss: 0.3951761
	iters: 100, epoch: 2 | loss: 1.1510670
	speed: 0.0072s/iter; left time: 25.0571s
	iters: 200, epoch: 2 | loss: 0.6910759
	speed: 0.0032s/iter; left time: 10.7644s
	iters: 300, epoch: 2 | loss: 0.6922130
	speed: 0.0034s/iter; left time: 11.0821s
	iters: 400, epoch: 2 | loss: 0.5930014
	speed: 0.0032s/iter; left time: 10.0950s
	iters: 500, epoch: 2 | loss: 0.6459231
	speed: 0.0031s/iter; left time: 9.6095s
Updating learning rate to 0.00034971930116702113
Validation loss decreased (0.3952 --> 0.3726).  Saving model state dict ...
Epoch: 2 cost time: 1.689605951309204
Epoch: 2, Steps: 514 | Train Loss: 0.7546561 Vali Loss: 0.3726312 Best vali loss: 0.3726312
	iters: 100, epoch: 3 | loss: 0.4818354
	speed: 0.0073s/iter; left time: 21.8361s
	iters: 200, epoch: 3 | loss: 0.3966451
	speed: 0.0033s/iter; left time: 9.5487s
	iters: 300, epoch: 3 | loss: 0.5029094
	speed: 0.0033s/iter; left time: 9.1816s
	iters: 400, epoch: 3 | loss: 0.4923574
	speed: 0.0034s/iter; left time: 9.0481s
	iters: 500, epoch: 3 | loss: 1.0020978
	speed: 0.0034s/iter; left time: 8.6652s
Updating learning rate to 0.0002832576667323872
Validation loss decreased (0.3726 --> 0.3661).  Saving model state dict ...
Epoch: 3 cost time: 1.7587592601776123
Epoch: 3, Steps: 514 | Train Loss: 0.5751690 Vali Loss: 0.3660774 Best vali loss: 0.3660774

best validation loss 0.36607739309430826

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0017468475259, 'e_layers': 1, 'learning_rate': 7.80340014e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5419700
	speed: 0.0076s/iter; left time: 62.0755s
	iters: 200, epoch: 1 | loss: 0.6079240
	speed: 0.0024s/iter; left time: 19.2652s
	iters: 300, epoch: 1 | loss: 0.8119006
	speed: 0.0024s/iter; left time: 18.7374s
	iters: 400, epoch: 1 | loss: 0.2606109
	speed: 0.0024s/iter; left time: 18.7485s
	iters: 500, epoch: 1 | loss: 0.2247745
	speed: 0.0024s/iter; left time: 18.3241s
	iters: 600, epoch: 1 | loss: 0.3388277
	speed: 0.0023s/iter; left time: 17.8175s
	iters: 700, epoch: 1 | loss: 0.8279525
	speed: 0.0024s/iter; left time: 18.1387s
	iters: 800, epoch: 1 | loss: 1.3273566
	speed: 0.0024s/iter; left time: 17.8629s
	iters: 900, epoch: 1 | loss: 0.5337393
	speed: 0.0023s/iter; left time: 17.0908s
	iters: 1000, epoch: 1 | loss: 1.1413250
	speed: 0.0023s/iter; left time: 16.3875s
Updating learning rate to 7.506400906670854e-05
Validation loss decreased (inf --> 0.3835).  Saving model state dict ...
Epoch: 1 cost time: 2.762385129928589
Epoch: 1, Steps: 1027 | Train Loss: 0.6616381 Vali Loss: 0.3835474 Best vali loss: 0.3835474
	iters: 100, epoch: 2 | loss: 0.6438603
	speed: 0.0072s/iter; left time: 51.1587s
	iters: 200, epoch: 2 | loss: 0.7325101
	speed: 0.0021s/iter; left time: 14.5199s
	iters: 300, epoch: 2 | loss: 0.5279340
	speed: 0.0020s/iter; left time: 14.0831s
	iters: 400, epoch: 2 | loss: 0.2321018
	speed: 0.0020s/iter; left time: 13.8118s
	iters: 500, epoch: 2 | loss: 0.6751124
	speed: 0.0020s/iter; left time: 13.7060s
	iters: 600, epoch: 2 | loss: 0.4837599
	speed: 0.0021s/iter; left time: 13.5678s
	iters: 700, epoch: 2 | loss: 0.2248787
	speed: 0.0020s/iter; left time: 13.2374s
	iters: 800, epoch: 2 | loss: 0.2486524
	speed: 0.0021s/iter; left time: 13.4639s
	iters: 900, epoch: 2 | loss: 0.4154215
	speed: 0.0022s/iter; left time: 13.5943s
	iters: 1000, epoch: 2 | loss: 0.6847692
	speed: 0.0021s/iter; left time: 12.9530s
Updating learning rate to 6.660618647653027e-05
Validation loss decreased (0.3835 --> 0.3699).  Saving model state dict ...
Epoch: 2 cost time: 2.1735665798187256
Epoch: 2, Steps: 1027 | Train Loss: 0.4869000 Vali Loss: 0.3698523 Best vali loss: 0.3698523
	iters: 100, epoch: 3 | loss: 0.8393233
	speed: 0.0072s/iter; left time: 43.7261s
	iters: 200, epoch: 3 | loss: 0.4481169
	speed: 0.0022s/iter; left time: 13.2900s
	iters: 300, epoch: 3 | loss: 0.7280405
	speed: 0.0023s/iter; left time: 13.2233s
	iters: 400, epoch: 3 | loss: 0.7985774
	speed: 0.0023s/iter; left time: 13.0394s
	iters: 500, epoch: 3 | loss: 1.9588311
	speed: 0.0023s/iter; left time: 13.1131s
	iters: 600, epoch: 3 | loss: 0.7331883
	speed: 0.0023s/iter; left time: 12.8095s
	iters: 700, epoch: 3 | loss: 1.7765375
	speed: 0.0023s/iter; left time: 12.4732s
	iters: 800, epoch: 3 | loss: 0.4962773
	speed: 0.0023s/iter; left time: 12.1411s
	iters: 900, epoch: 3 | loss: 0.4600713
	speed: 0.0022s/iter; left time: 11.7791s
	iters: 1000, epoch: 3 | loss: 0.9514156
	speed: 0.0022s/iter; left time: 11.4479s
Updating learning rate to 5.3948160448467107e-05
Validation loss decreased (0.3699 --> 0.3657).  Saving model state dict ...
Epoch: 3 cost time: 2.3630127906799316
Epoch: 3, Steps: 1027 | Train Loss: 0.9190379 Vali Loss: 0.3656974 Best vali loss: 0.3656974

best validation loss 0.36569740362392195

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021904570098, 'e_layers': 2, 'learning_rate': 0.0004166921915, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8074474
	speed: 0.0088s/iter; left time: 35.3738s
	iters: 200, epoch: 1 | loss: 0.3318187
	speed: 0.0032s/iter; left time: 12.5973s
	iters: 300, epoch: 1 | loss: 0.5315078
	speed: 0.0032s/iter; left time: 12.2645s
	iters: 400, epoch: 1 | loss: 1.0765625
	speed: 0.0032s/iter; left time: 12.0410s
	iters: 500, epoch: 1 | loss: 0.9331067
	speed: 0.0032s/iter; left time: 11.5626s
Updating learning rate to 0.00040083278929206183
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 2.0133655071258545
Epoch: 1, Steps: 514 | Train Loss: 0.7360886 Vali Loss: 0.3800203 Best vali loss: 0.3800203
	iters: 100, epoch: 2 | loss: 1.3614315
	speed: 0.0072s/iter; left time: 25.0354s
	iters: 200, epoch: 2 | loss: 0.6689947
	speed: 0.0032s/iter; left time: 10.7733s
	iters: 300, epoch: 2 | loss: 0.6949962
	speed: 0.0031s/iter; left time: 10.1227s
	iters: 400, epoch: 2 | loss: 0.6505409
	speed: 0.0031s/iter; left time: 9.8312s
	iters: 500, epoch: 2 | loss: 0.7098365
	speed: 0.0032s/iter; left time: 9.8523s
Updating learning rate to 0.00035566903288856673
Validation loss decreased (0.3800 --> 0.3657).  Saving model state dict ...
Epoch: 2 cost time: 1.6691126823425293
Epoch: 2, Steps: 514 | Train Loss: 0.8171600 Vali Loss: 0.3656752 Best vali loss: 0.3656752
	iters: 100, epoch: 3 | loss: 0.4831568
	speed: 0.0072s/iter; left time: 21.5875s
	iters: 200, epoch: 3 | loss: 0.5117232
	speed: 0.0031s/iter; left time: 9.0029s
	iters: 300, epoch: 3 | loss: 0.5124666
	speed: 0.0030s/iter; left time: 8.4326s
	iters: 400, epoch: 3 | loss: 0.4907238
	speed: 0.0032s/iter; left time: 8.5174s
	iters: 500, epoch: 3 | loss: 1.1955570
	speed: 0.0031s/iter; left time: 7.9830s
Updating learning rate to 0.00028807669479147567
Epoch: 3 cost time: 1.6539113521575928
Epoch: 3, Steps: 514 | Train Loss: 0.6387255 Vali Loss: 0.3711639 Best vali loss: 0.3656752

best validation loss 0.36567518488597306

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021904570098, 'e_layers': 2, 'learning_rate': 0.0004166921915, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5846030
	speed: 0.0098s/iter; left time: 24.2296s
	iters: 200, epoch: 4 | loss: 0.3124995
	speed: 0.0032s/iter; left time: 7.6613s
	iters: 300, epoch: 4 | loss: 0.4439444
	speed: 0.0031s/iter; left time: 7.0400s
	iters: 400, epoch: 4 | loss: 0.8277655
	speed: 0.0033s/iter; left time: 7.2260s
	iters: 500, epoch: 4 | loss: 0.8748885
	speed: 0.0034s/iter; left time: 6.9930s
Updating learning rate to 0.00020834609575
Epoch: 4 cost time: 2.032888412475586
Epoch: 4, Steps: 514 | Train Loss: 0.6087402 Vali Loss: 0.3864687 Best vali loss: 0.3656752
	iters: 100, epoch: 5 | loss: 0.8335412
	speed: 0.0070s/iter; left time: 13.7538s
	iters: 200, epoch: 5 | loss: 0.5124457
	speed: 0.0031s/iter; left time: 5.7733s
	iters: 300, epoch: 5 | loss: 0.5709399
	speed: 0.0030s/iter; left time: 5.2733s
	iters: 400, epoch: 5 | loss: 0.5685992
	speed: 0.0030s/iter; left time: 5.0439s
	iters: 500, epoch: 5 | loss: 0.5848963
	speed: 0.0031s/iter; left time: 4.8940s
Updating learning rate to 0.00012861549670852438
Epoch: 5 cost time: 1.6294043064117432
Epoch: 5, Steps: 514 | Train Loss: 0.6140845 Vali Loss: 0.3672542 Best vali loss: 0.3656752
	iters: 100, epoch: 6 | loss: 0.4065222
	speed: 0.0070s/iter; left time: 10.1481s
	iters: 200, epoch: 6 | loss: 0.3552910
	speed: 0.0035s/iter; left time: 4.7413s
	iters: 300, epoch: 6 | loss: 0.4985315
	speed: 0.0034s/iter; left time: 4.2879s
	iters: 400, epoch: 6 | loss: 0.4306195
	speed: 0.0034s/iter; left time: 3.8603s
	iters: 500, epoch: 6 | loss: 0.7926466
	speed: 0.0032s/iter; left time: 3.2884s
Updating learning rate to 6.102315861143329e-05
Validation loss decreased (0.3657 --> 0.3572).  Saving model state dict ...
Epoch: 6 cost time: 1.7788121700286865
Epoch: 6, Steps: 514 | Train Loss: 0.4967222 Vali Loss: 0.3571865 Best vali loss: 0.3571865
	iters: 100, epoch: 7 | loss: 0.3336493
	speed: 0.0074s/iter; left time: 6.9059s
	iters: 200, epoch: 7 | loss: 0.3937399
	speed: 0.0032s/iter; left time: 2.6599s
	iters: 300, epoch: 7 | loss: 0.3756381
	speed: 0.0032s/iter; left time: 2.3129s
	iters: 400, epoch: 7 | loss: 0.3436878
	speed: 0.0033s/iter; left time: 2.0579s
	iters: 500, epoch: 7 | loss: 0.3069435
	speed: 0.0033s/iter; left time: 1.7256s
Updating learning rate to 1.5859402207938215e-05
Validation loss decreased (0.3572 --> 0.3542).  Saving model state dict ...
Epoch: 7 cost time: 1.7149629592895508
Epoch: 7, Steps: 514 | Train Loss: 0.3507317 Vali Loss: 0.3541833 Best vali loss: 0.3541833
	iters: 100, epoch: 8 | loss: 0.3419914
	speed: 0.0075s/iter; left time: 3.1313s
	iters: 200, epoch: 8 | loss: 0.4300329
	speed: 0.0033s/iter; left time: 1.0415s
	iters: 300, epoch: 8 | loss: 0.2390417
	speed: 0.0035s/iter; left time: 0.7619s
	iters: 400, epoch: 8 | loss: 0.2950399
	speed: 0.0034s/iter; left time: 0.3960s
	iters: 500, epoch: 8 | loss: 0.4193190
	speed: 0.0034s/iter; left time: 0.0510s
Updating learning rate to 0.0
Validation loss decreased (0.3542 --> 0.3521).  Saving model state dict ...
Epoch: 8 cost time: 1.8049888610839844
Epoch: 8, Steps: 514 | Train Loss: 0.3450850 Vali Loss: 0.3520523 Best vali loss: 0.3520523

best validation loss 0.3520522600716833

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0035099940991, 'e_layers': 1, 'learning_rate': 0.0003334711714, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00032077918066951156
Validation loss decreased (inf --> 0.3645).  Saving model state dict ...
Epoch: 1 cost time: 0.6130971908569336
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3645001 Best vali loss: 0.3645001
Updating learning rate to 0.00028463544901358075
Epoch: 2 cost time: 0.30936670303344727
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3691532 Best vali loss: 0.3645001
Updating learning rate to 0.0002305425319330796
Epoch: 3 cost time: 0.30973076820373535
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3682258 Best vali loss: 0.3645001
Updating learning rate to 0.0001667355857
Epoch: 4 cost time: 0.3076212406158447
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3735047 Best vali loss: 0.3645001
Updating learning rate to 0.00010292863946692043
Epoch: 5 cost time: 0.30254054069519043
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3792894 Best vali loss: 0.3645001
Updating learning rate to 4.883572238641927e-05
Epoch: 6 cost time: 0.3046555519104004
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3805523 Best vali loss: 0.3645001
Updating learning rate to 1.2691990730488414e-05
Epoch: 7 cost time: 0.314772367477417
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3797351 Best vali loss: 0.3645001
Updating learning rate to 0.0
Epoch: 8 cost time: 0.30939698219299316
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3804728 Best vali loss: 0.3645001

best validation loss 0.3645000540203102

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022123337779, 'e_layers': 2, 'learning_rate': 0.0004173799743, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8076221
	speed: 0.0094s/iter; left time: 37.5633s
	iters: 200, epoch: 1 | loss: 0.3318155
	speed: 0.0036s/iter; left time: 14.2431s
	iters: 300, epoch: 1 | loss: 0.5309566
	speed: 0.0036s/iter; left time: 13.7723s
	iters: 400, epoch: 1 | loss: 1.0701971
	speed: 0.0035s/iter; left time: 13.1235s
	iters: 500, epoch: 1 | loss: 0.9184089
	speed: 0.0035s/iter; left time: 12.4978s
Updating learning rate to 0.00040149439491792845
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.209826707839966
Epoch: 1, Steps: 514 | Train Loss: 0.7318000 Vali Loss: 0.3747676 Best vali loss: 0.3747676
	iters: 100, epoch: 2 | loss: 1.2574216
	speed: 0.0088s/iter; left time: 30.7889s
	iters: 200, epoch: 2 | loss: 0.6425015
	speed: 0.0031s/iter; left time: 10.6018s
	iters: 300, epoch: 2 | loss: 0.7004965
	speed: 0.0031s/iter; left time: 10.1595s
	iters: 400, epoch: 2 | loss: 0.6217397
	speed: 0.0031s/iter; left time: 9.8396s
	iters: 500, epoch: 2 | loss: 0.7306471
	speed: 0.0031s/iter; left time: 9.7542s
Updating learning rate to 0.00035625609222949845
Validation loss decreased (0.3748 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 1.8191783428192139
Epoch: 2, Steps: 514 | Train Loss: 0.7905613 Vali Loss: 0.3690482 Best vali loss: 0.3690482
	iters: 100, epoch: 3 | loss: 0.4764991
	speed: 0.0078s/iter; left time: 23.3884s
	iters: 200, epoch: 3 | loss: 0.3729466
	speed: 0.0036s/iter; left time: 10.4595s
	iters: 300, epoch: 3 | loss: 0.5243067
	speed: 0.0036s/iter; left time: 10.0977s
	iters: 400, epoch: 3 | loss: 0.5792254
	speed: 0.0036s/iter; left time: 9.6642s
	iters: 500, epoch: 3 | loss: 1.0812976
	speed: 0.0034s/iter; left time: 8.7627s
Updating learning rate to 0.0002885521877327885
Epoch: 3 cost time: 1.8769006729125977
Epoch: 3, Steps: 514 | Train Loss: 0.6068551 Vali Loss: 0.3761400 Best vali loss: 0.3690482
	iters: 100, epoch: 4 | loss: 0.3838988
	speed: 0.0071s/iter; left time: 17.4675s
	iters: 200, epoch: 4 | loss: 0.4898337
	speed: 0.0031s/iter; left time: 7.4223s
	iters: 300, epoch: 4 | loss: 0.4372990
	speed: 0.0031s/iter; left time: 7.0863s
	iters: 400, epoch: 4 | loss: 0.3706216
	speed: 0.0032s/iter; left time: 6.8672s
	iters: 500, epoch: 4 | loss: 0.3401982
	speed: 0.0031s/iter; left time: 6.4725s
Updating learning rate to 0.00020868998715
Validation loss decreased (0.3690 --> 0.3545).  Saving model state dict ...
Epoch: 4 cost time: 1.659940481185913
Epoch: 4, Steps: 514 | Train Loss: 0.4043703 Vali Loss: 0.3545377 Best vali loss: 0.3545377
	iters: 100, epoch: 5 | loss: 0.3954453
	speed: 0.0070s/iter; left time: 13.6864s
	iters: 200, epoch: 5 | loss: 0.6384737
	speed: 0.0030s/iter; left time: 5.5491s
	iters: 300, epoch: 5 | loss: 0.2502058
	speed: 0.0031s/iter; left time: 5.3807s
	iters: 400, epoch: 5 | loss: 0.3384596
	speed: 0.0031s/iter; left time: 5.1002s
	iters: 500, epoch: 5 | loss: 0.4268677
	speed: 0.0031s/iter; left time: 4.8045s
Updating learning rate to 0.00012882778656721154
Validation loss decreased (0.3545 --> 0.3433).  Saving model state dict ...
Epoch: 5 cost time: 1.6119751930236816
Epoch: 5, Steps: 514 | Train Loss: 0.4098904 Vali Loss: 0.3433000 Best vali loss: 0.3433000
	iters: 100, epoch: 6 | loss: 0.3619101
	speed: 0.0070s/iter; left time: 10.0509s
	iters: 200, epoch: 6 | loss: 0.3263003
	speed: 0.0033s/iter; left time: 4.4024s
	iters: 300, epoch: 6 | loss: 0.2690629
	speed: 0.0031s/iter; left time: 3.8557s
	iters: 400, epoch: 6 | loss: 0.5047293
	speed: 0.0031s/iter; left time: 3.5963s
	iters: 500, epoch: 6 | loss: 0.5524626
	speed: 0.0031s/iter; left time: 3.2670s
Updating learning rate to 6.112388207050155e-05
Epoch: 6 cost time: 1.6691343784332275
Epoch: 6, Steps: 514 | Train Loss: 0.4028930 Vali Loss: 0.3469760 Best vali loss: 0.3433000
	iters: 100, epoch: 7 | loss: 0.3628801
	speed: 0.0066s/iter; left time: 6.0876s
	iters: 200, epoch: 7 | loss: 0.2333700
	speed: 0.0030s/iter; left time: 2.5019s
	iters: 300, epoch: 7 | loss: 0.5108904
	speed: 0.0030s/iter; left time: 2.1673s
	iters: 400, epoch: 7 | loss: 0.4530608
	speed: 0.0030s/iter; left time: 1.8703s
	iters: 500, epoch: 7 | loss: 0.3466556
	speed: 0.0030s/iter; left time: 1.5866s
Updating learning rate to 1.5885579382071563e-05
Epoch: 7 cost time: 1.5745880603790283
Epoch: 7, Steps: 514 | Train Loss: 0.3813714 Vali Loss: 0.3459361 Best vali loss: 0.3433000
	iters: 100, epoch: 8 | loss: 0.2342321
	speed: 0.0072s/iter; left time: 2.9725s
	iters: 200, epoch: 8 | loss: 0.4091024
	speed: 0.0033s/iter; left time: 1.0373s
	iters: 300, epoch: 8 | loss: 0.6147574
	speed: 0.0031s/iter; left time: 0.6731s
	iters: 400, epoch: 8 | loss: 0.6140989
	speed: 0.0032s/iter; left time: 0.3637s
	iters: 500, epoch: 8 | loss: 0.3637236
	speed: 0.0031s/iter; left time: 0.0468s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.709305763244629
Epoch: 8, Steps: 514 | Train Loss: 0.4471829 Vali Loss: 0.3482531 Best vali loss: 0.3433000

best validation loss 0.3432999838019167

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0017737023471, 'e_layers': 2, 'learning_rate': 0.0012848817153, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4452333
	speed: 0.0102s/iter; left time: 9.5479s
Updating learning rate to 0.0012359788168818321
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 0.8629779815673828
Epoch: 1, Steps: 129 | Train Loss: 0.4452333 Vali Loss: 0.3685513 Best vali loss: 0.3685513
	iters: 100, epoch: 2 | loss: 0.5945866
	speed: 0.0069s/iter; left time: 5.5583s
Updating learning rate to 0.0010967151446056166
Validation loss decreased (0.3686 --> 0.3680).  Saving model state dict ...
Epoch: 2 cost time: 0.5515601634979248
Epoch: 2, Steps: 129 | Train Loss: 0.5945866 Vali Loss: 0.3679585 Best vali loss: 0.3679585
	iters: 100, epoch: 3 | loss: 0.7020610
	speed: 0.0070s/iter; left time: 4.7366s
Updating learning rate to 0.0008882923301470741
Epoch: 3 cost time: 0.5502996444702148
Epoch: 3, Steps: 129 | Train Loss: 0.7020610 Vali Loss: 0.4050789 Best vali loss: 0.3679585

best validation loss 0.3679584866422567

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0009059474143, 'e_layers': 3, 'learning_rate': 0.0004247371756, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3376929
	speed: 0.0104s/iter; left time: 84.4344s
	iters: 200, epoch: 1 | loss: 1.2870674
	speed: 0.0043s/iter; left time: 34.1820s
	iters: 300, epoch: 1 | loss: 0.9747161
	speed: 0.0043s/iter; left time: 33.8416s
	iters: 400, epoch: 1 | loss: 0.2960521
	speed: 0.0043s/iter; left time: 33.2428s
	iters: 500, epoch: 1 | loss: 0.8733564
	speed: 0.0042s/iter; left time: 32.5207s
	iters: 600, epoch: 1 | loss: 1.6726855
	speed: 0.0042s/iter; left time: 32.2281s
	iters: 700, epoch: 1 | loss: 0.2314066
	speed: 0.0041s/iter; left time: 31.1497s
	iters: 800, epoch: 1 | loss: 0.3730601
	speed: 0.0042s/iter; left time: 30.9397s
	iters: 900, epoch: 1 | loss: 0.3938596
	speed: 0.0042s/iter; left time: 30.5929s
	iters: 1000, epoch: 1 | loss: 0.9981511
	speed: 0.0042s/iter; left time: 30.1965s
Updating learning rate to 0.0004247371756
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 4.666747331619263
Epoch: 1, Steps: 1027 | Train Loss: 0.7438048 Vali Loss: 0.3657624 Best vali loss: 0.3657624
	iters: 100, epoch: 2 | loss: 0.5564329
	speed: 0.0112s/iter; left time: 79.6184s
	iters: 200, epoch: 2 | loss: 0.7243279
	speed: 0.0043s/iter; left time: 29.8774s
	iters: 300, epoch: 2 | loss: 0.3001918
	speed: 0.0043s/iter; left time: 29.3104s
	iters: 400, epoch: 2 | loss: 0.7754788
	speed: 0.0043s/iter; left time: 28.8686s
	iters: 500, epoch: 2 | loss: 0.6063321
	speed: 0.0042s/iter; left time: 28.3433s
	iters: 600, epoch: 2 | loss: 0.9936437
	speed: 0.0040s/iter; left time: 26.1714s
	iters: 700, epoch: 2 | loss: 0.7019009
	speed: 0.0038s/iter; left time: 24.4896s
	iters: 800, epoch: 2 | loss: 0.1916414
	speed: 0.0038s/iter; left time: 24.4676s
	iters: 900, epoch: 2 | loss: 0.9157252
	speed: 0.0038s/iter; left time: 23.6628s
	iters: 1000, epoch: 2 | loss: 0.4779122
	speed: 0.0038s/iter; left time: 23.2651s
Updating learning rate to 0.0002123685878
Epoch: 2 cost time: 4.179548978805542
Epoch: 2, Steps: 1027 | Train Loss: 0.6243587 Vali Loss: 0.3704666 Best vali loss: 0.3657624
	iters: 100, epoch: 3 | loss: 0.2703496
	speed: 0.0104s/iter; left time: 63.3046s
	iters: 200, epoch: 3 | loss: 1.1864042
	speed: 0.0039s/iter; left time: 23.0728s
	iters: 300, epoch: 3 | loss: 0.4265678
	speed: 0.0038s/iter; left time: 22.3073s
	iters: 400, epoch: 3 | loss: 0.9912640
	speed: 0.0036s/iter; left time: 20.5137s
	iters: 500, epoch: 3 | loss: 0.2426300
	speed: 0.0036s/iter; left time: 20.1079s
	iters: 600, epoch: 3 | loss: 1.5344280
	speed: 0.0035s/iter; left time: 19.6612s
	iters: 700, epoch: 3 | loss: 0.1888724
	speed: 0.0036s/iter; left time: 19.9386s
	iters: 800, epoch: 3 | loss: 1.2341685
	speed: 0.0039s/iter; left time: 20.7094s
	iters: 900, epoch: 3 | loss: 1.3712356
	speed: 0.0038s/iter; left time: 20.2070s
	iters: 1000, epoch: 3 | loss: 0.2883019
	speed: 0.0039s/iter; left time: 19.8818s
Updating learning rate to 0.0001061842939
Epoch: 3 cost time: 3.8790016174316406
Epoch: 3, Steps: 1027 | Train Loss: 0.7734222 Vali Loss: 0.3774313 Best vali loss: 0.3657624

best validation loss 0.36576240410212213

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021927711156, 'e_layers': 2, 'learning_rate': 0.0004200970325, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8085906
	speed: 0.0101s/iter; left time: 40.5192s
	iters: 200, epoch: 1 | loss: 0.3323251
	speed: 0.0037s/iter; left time: 14.4528s
	iters: 300, epoch: 1 | loss: 0.5343684
	speed: 0.0035s/iter; left time: 13.4747s
	iters: 400, epoch: 1 | loss: 1.0824873
	speed: 0.0036s/iter; left time: 13.4883s
	iters: 500, epoch: 1 | loss: 0.9194710
	speed: 0.0037s/iter; left time: 13.4488s
Updating learning rate to 0.0004041080412477394
Validation loss decreased (inf --> 0.3767).  Saving model state dict ...
Epoch: 1 cost time: 2.226419448852539
Epoch: 1, Steps: 514 | Train Loss: 0.7354485 Vali Loss: 0.3766722 Best vali loss: 0.3766722
	iters: 100, epoch: 2 | loss: 1.2904422
	speed: 0.0073s/iter; left time: 25.5587s
	iters: 200, epoch: 2 | loss: 0.6854434
	speed: 0.0032s/iter; left time: 10.7727s
	iters: 300, epoch: 2 | loss: 0.6598985
	speed: 0.0032s/iter; left time: 10.4505s
	iters: 400, epoch: 2 | loss: 0.6239367
	speed: 0.0034s/iter; left time: 10.9261s
	iters: 500, epoch: 2 | loss: 0.6906679
	speed: 0.0031s/iter; left time: 9.6615s
Updating learning rate to 0.0003585752464685477
Validation loss decreased (0.3767 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 1.704913854598999
Epoch: 2, Steps: 514 | Train Loss: 0.7900777 Vali Loss: 0.3667115 Best vali loss: 0.3667115
	iters: 100, epoch: 3 | loss: 0.4798375
	speed: 0.0073s/iter; left time: 21.6901s
	iters: 200, epoch: 3 | loss: 0.4171178
	speed: 0.0031s/iter; left time: 9.0101s
	iters: 300, epoch: 3 | loss: 0.5050140
	speed: 0.0032s/iter; left time: 8.9118s
	iters: 400, epoch: 3 | loss: 0.5440306
	speed: 0.0032s/iter; left time: 8.5889s
	iters: 500, epoch: 3 | loss: 1.0492198
	speed: 0.0032s/iter; left time: 8.1643s
Updating learning rate to 0.00029043060341174434
Epoch: 3 cost time: 1.662886142730713
Epoch: 3, Steps: 514 | Train Loss: 0.5990440 Vali Loss: 0.3685349 Best vali loss: 0.3667115

best validation loss 0.36671154335697415

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0009059474143, 'e_layers': 3, 'learning_rate': 0.0004247371756, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3058859
	speed: 0.0103s/iter; left time: 51.8760s
	iters: 200, epoch: 4 | loss: 0.8545433
	speed: 0.0041s/iter; left time: 20.2134s
	iters: 300, epoch: 4 | loss: 0.8448929
	speed: 0.0040s/iter; left time: 19.3565s
	iters: 400, epoch: 4 | loss: 0.2939813
	speed: 0.0040s/iter; left time: 19.1168s
	iters: 500, epoch: 4 | loss: 0.6701638
	speed: 0.0039s/iter; left time: 18.2182s
	iters: 600, epoch: 4 | loss: 1.2713091
	speed: 0.0039s/iter; left time: 17.6050s
	iters: 700, epoch: 4 | loss: 0.2377111
	speed: 0.0037s/iter; left time: 16.4225s
	iters: 800, epoch: 4 | loss: 0.3069868
	speed: 0.0036s/iter; left time: 15.7864s
	iters: 900, epoch: 4 | loss: 0.4439757
	speed: 0.0036s/iter; left time: 15.1418s
	iters: 1000, epoch: 4 | loss: 0.9857881
	speed: 0.0036s/iter; left time: 14.8805s
Updating learning rate to 5.309214695e-05
Epoch: 4 cost time: 4.281958341598511
Epoch: 4, Steps: 1027 | Train Loss: 0.6215238 Vali Loss: 0.3668263 Best vali loss: 0.3657624
	iters: 100, epoch: 5 | loss: 0.5659915
	speed: 0.0109s/iter; left time: 43.8072s
	iters: 200, epoch: 5 | loss: 0.7265388
	speed: 0.0038s/iter; left time: 14.7395s
	iters: 300, epoch: 5 | loss: 0.3100594
	speed: 0.0038s/iter; left time: 14.5488s
	iters: 400, epoch: 5 | loss: 0.7487825
	speed: 0.0038s/iter; left time: 14.1526s
	iters: 500, epoch: 5 | loss: 0.4780860
	speed: 0.0038s/iter; left time: 13.8463s
	iters: 600, epoch: 5 | loss: 0.9724780
	speed: 0.0038s/iter; left time: 13.3818s
	iters: 700, epoch: 5 | loss: 0.7130695
	speed: 0.0037s/iter; left time: 12.4541s
	iters: 800, epoch: 5 | loss: 0.1854345
	speed: 0.0036s/iter; left time: 11.9146s
	iters: 900, epoch: 5 | loss: 0.7469923
	speed: 0.0037s/iter; left time: 11.8779s
	iters: 1000, epoch: 5 | loss: 0.3877681
	speed: 0.0037s/iter; left time: 11.5290s
Updating learning rate to 2.6546073475e-05
Epoch: 5 cost time: 3.893669843673706
Epoch: 5, Steps: 1027 | Train Loss: 0.5835201 Vali Loss: 0.3714910 Best vali loss: 0.3657624
	iters: 100, epoch: 6 | loss: 0.2583892
	speed: 0.0106s/iter; left time: 31.7517s
	iters: 200, epoch: 6 | loss: 1.0031207
	speed: 0.0036s/iter; left time: 10.3826s
	iters: 300, epoch: 6 | loss: 0.3694651
	speed: 0.0036s/iter; left time: 9.9805s
	iters: 400, epoch: 6 | loss: 1.0013629
	speed: 0.0036s/iter; left time: 9.6071s
	iters: 500, epoch: 6 | loss: 0.2543109
	speed: 0.0036s/iter; left time: 9.2159s
	iters: 600, epoch: 6 | loss: 1.3288405
	speed: 0.0035s/iter; left time: 8.7831s
	iters: 700, epoch: 6 | loss: 0.1958980
	speed: 0.0035s/iter; left time: 8.4380s
	iters: 800, epoch: 6 | loss: 1.2097611
	speed: 0.0035s/iter; left time: 8.0494s
	iters: 900, epoch: 6 | loss: 1.3657131
	speed: 0.0035s/iter; left time: 7.6799s
	iters: 1000, epoch: 6 | loss: 0.2891231
	speed: 0.0035s/iter; left time: 7.3278s
Updating learning rate to 1.32730367375e-05
Epoch: 6 cost time: 3.7142183780670166
Epoch: 6, Steps: 1027 | Train Loss: 0.7275985 Vali Loss: 0.3706538 Best vali loss: 0.3657624
	iters: 100, epoch: 7 | loss: 0.3315233
	speed: 0.0108s/iter; left time: 21.1675s
	iters: 200, epoch: 7 | loss: 0.4980805
	speed: 0.0041s/iter; left time: 7.6072s
	iters: 300, epoch: 7 | loss: 0.5433564
	speed: 0.0041s/iter; left time: 7.1759s
	iters: 400, epoch: 7 | loss: 0.7737640
	speed: 0.0041s/iter; left time: 6.8012s
	iters: 500, epoch: 7 | loss: 0.7994823
	speed: 0.0041s/iter; left time: 6.4093s
	iters: 600, epoch: 7 | loss: 0.4547912
	speed: 0.0041s/iter; left time: 5.9488s
	iters: 700, epoch: 7 | loss: 0.3364441
	speed: 0.0041s/iter; left time: 5.5418s
	iters: 800, epoch: 7 | loss: 0.7650147
	speed: 0.0041s/iter; left time: 5.1739s
	iters: 900, epoch: 7 | loss: 0.2883454
	speed: 0.0041s/iter; left time: 4.7206s
	iters: 1000, epoch: 7 | loss: 0.3594549
	speed: 0.0041s/iter; left time: 4.3467s
Updating learning rate to 6.63651836875e-06
Epoch: 7 cost time: 4.249858617782593
Epoch: 7, Steps: 1027 | Train Loss: 0.5150257 Vali Loss: 0.3708108 Best vali loss: 0.3657624
	iters: 100, epoch: 8 | loss: 0.6308486
	speed: 0.0108s/iter; left time: 9.9950s
	iters: 200, epoch: 8 | loss: 0.2995188
	speed: 0.0040s/iter; left time: 3.3461s
	iters: 300, epoch: 8 | loss: 0.8765503
	speed: 0.0041s/iter; left time: 2.9778s
	iters: 400, epoch: 8 | loss: 0.5147220
	speed: 0.0042s/iter; left time: 2.6260s
	iters: 500, epoch: 8 | loss: 0.5422266
	speed: 0.0042s/iter; left time: 2.2272s
	iters: 600, epoch: 8 | loss: 0.4522968
	speed: 0.0042s/iter; left time: 1.7919s
	iters: 700, epoch: 8 | loss: 0.3270347
	speed: 0.0043s/iter; left time: 1.4042s
	iters: 800, epoch: 8 | loss: 0.2927538
	speed: 0.0043s/iter; left time: 0.9860s
	iters: 900, epoch: 8 | loss: 0.2464852
	speed: 0.0040s/iter; left time: 0.5126s
	iters: 1000, epoch: 8 | loss: 0.2199484
	speed: 0.0039s/iter; left time: 0.1091s
Updating learning rate to 3.318259184375e-06
Epoch: 8 cost time: 4.268531560897827
Epoch: 8, Steps: 1027 | Train Loss: 0.4402385 Vali Loss: 0.3709467 Best vali loss: 0.3657624

best validation loss 0.36576240410212213

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0011492878379, 'e_layers': 1, 'learning_rate': 0.0008656569352, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6883004
	speed: 0.0087s/iter; left time: 34.9811s
	iters: 200, epoch: 1 | loss: 0.7746177
	speed: 0.0025s/iter; left time: 9.9528s
	iters: 300, epoch: 1 | loss: 1.0546311
	speed: 0.0025s/iter; left time: 9.5758s
	iters: 400, epoch: 1 | loss: 0.6173477
	speed: 0.0026s/iter; left time: 9.4686s
	iters: 500, epoch: 1 | loss: 0.4344577
	speed: 0.0025s/iter; left time: 9.1531s
Updating learning rate to 0.0008327098299038647
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 1.6637272834777832
Epoch: 1, Steps: 514 | Train Loss: 0.7138709 Vali Loss: 0.3677931 Best vali loss: 0.3677931
	iters: 100, epoch: 2 | loss: 0.5412509
	speed: 0.0061s/iter; left time: 21.4579s
	iters: 200, epoch: 2 | loss: 0.6126341
	speed: 0.0026s/iter; left time: 8.7088s
	iters: 300, epoch: 2 | loss: 0.7864576
	speed: 0.0026s/iter; left time: 8.5484s
	iters: 400, epoch: 2 | loss: 0.3692855
	speed: 0.0027s/iter; left time: 8.5012s
	iters: 500, epoch: 2 | loss: 0.9749519
	speed: 0.0025s/iter; left time: 7.8455s
Updating learning rate to 0.0007388844121305419
Epoch: 2 cost time: 1.3746082782745361
Epoch: 2, Steps: 514 | Train Loss: 0.6569160 Vali Loss: 0.3786635 Best vali loss: 0.3677931
	iters: 100, epoch: 3 | loss: 0.8770370
	speed: 0.0058s/iter; left time: 17.4205s
	iters: 200, epoch: 3 | loss: 0.9867172
	speed: 0.0024s/iter; left time: 6.8098s
	iters: 300, epoch: 3 | loss: 0.6494831
	speed: 0.0024s/iter; left time: 6.6477s
	iters: 400, epoch: 3 | loss: 0.2887080
	speed: 0.0024s/iter; left time: 6.5313s
	iters: 500, epoch: 3 | loss: 0.7190589
	speed: 0.0024s/iter; left time: 6.2470s
Updating learning rate to 0.0005984647512064901
Epoch: 3 cost time: 1.2858459949493408
Epoch: 3, Steps: 514 | Train Loss: 0.7042008 Vali Loss: 0.3912506 Best vali loss: 0.3677931
	iters: 100, epoch: 4 | loss: 0.5817020
	speed: 0.0058s/iter; left time: 14.2981s
	iters: 200, epoch: 4 | loss: 0.5855445
	speed: 0.0024s/iter; left time: 5.6731s
	iters: 300, epoch: 4 | loss: 0.6238208
	speed: 0.0024s/iter; left time: 5.4292s
	iters: 400, epoch: 4 | loss: 0.8590924
	speed: 0.0023s/iter; left time: 5.0650s
	iters: 500, epoch: 4 | loss: 0.4147870
	speed: 0.0023s/iter; left time: 4.8574s
Updating learning rate to 0.0004328284676
Epoch: 4 cost time: 1.2627053260803223
Epoch: 4, Steps: 514 | Train Loss: 0.6129893 Vali Loss: 0.3897854 Best vali loss: 0.3677931
	iters: 100, epoch: 5 | loss: 0.7930920
	speed: 0.0059s/iter; left time: 11.5122s
	iters: 200, epoch: 5 | loss: 0.7497632
	speed: 0.0025s/iter; left time: 4.5506s
	iters: 300, epoch: 5 | loss: 0.2627454
	speed: 0.0024s/iter; left time: 4.2775s
	iters: 400, epoch: 5 | loss: 0.4631653
	speed: 0.0024s/iter; left time: 3.9978s
	iters: 500, epoch: 5 | loss: 0.5176511
	speed: 0.0024s/iter; left time: 3.7154s
Updating learning rate to 0.00026719218399350996
Epoch: 5 cost time: 1.2972848415374756
Epoch: 5, Steps: 514 | Train Loss: 0.5572834 Vali Loss: 0.3984895 Best vali loss: 0.3677931
	iters: 100, epoch: 6 | loss: 0.6625307
	speed: 0.0059s/iter; left time: 8.5234s
	iters: 200, epoch: 6 | loss: 0.3037274
	speed: 0.0024s/iter; left time: 3.2856s
	iters: 300, epoch: 6 | loss: 0.6781009
	speed: 0.0024s/iter; left time: 2.9293s
	iters: 400, epoch: 6 | loss: 0.3076510
	speed: 0.0024s/iter; left time: 2.7274s
	iters: 500, epoch: 6 | loss: 0.5317227
	speed: 0.0025s/iter; left time: 2.5658s
Updating learning rate to 0.00012677252306945815
Epoch: 6 cost time: 1.2804851531982422
Epoch: 6, Steps: 514 | Train Loss: 0.4967466 Vali Loss: 0.3956421 Best vali loss: 0.3677931
	iters: 100, epoch: 7 | loss: 0.7289319
	speed: 0.0058s/iter; left time: 5.3853s
	iters: 200, epoch: 7 | loss: 0.5360888
	speed: 0.0024s/iter; left time: 2.0070s
	iters: 300, epoch: 7 | loss: 0.4198870
	speed: 0.0024s/iter; left time: 1.7625s
	iters: 400, epoch: 7 | loss: 0.3491986
	speed: 0.0024s/iter; left time: 1.5390s
	iters: 500, epoch: 7 | loss: 0.3280537
	speed: 0.0024s/iter; left time: 1.2539s
Updating learning rate to 3.2947105296135385e-05
Epoch: 7 cost time: 1.2840757369995117
Epoch: 7, Steps: 514 | Train Loss: 0.4724320 Vali Loss: 0.4083506 Best vali loss: 0.3677931
	iters: 100, epoch: 8 | loss: 0.7404260
	speed: 0.0059s/iter; left time: 2.4480s
	iters: 200, epoch: 8 | loss: 0.3345126
	speed: 0.0024s/iter; left time: 0.7692s
	iters: 300, epoch: 8 | loss: 0.4630487
	speed: 0.0024s/iter; left time: 0.5220s
	iters: 400, epoch: 8 | loss: 0.2841499
	speed: 0.0024s/iter; left time: 0.2747s
	iters: 500, epoch: 8 | loss: 0.5639867
	speed: 0.0024s/iter; left time: 0.0360s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2987313270568848
Epoch: 8, Steps: 514 | Train Loss: 0.4772248 Vali Loss: 0.4035456 Best vali loss: 0.3677931

best validation loss 0.36779312062825575

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0014401027306, 'e_layers': 1, 'learning_rate': 0.0012772157833, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6944349
	speed: 0.0088s/iter; left time: 17.3092s
	iters: 200, epoch: 1 | loss: 1.4828202
	speed: 0.0027s/iter; left time: 4.9657s
Updating learning rate to 0.0012772157833
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 1.031710147857666
Epoch: 1, Steps: 257 | Train Loss: 1.0886275 Vali Loss: 0.3720423 Best vali loss: 0.3720423
	iters: 100, epoch: 2 | loss: 0.5977244
	speed: 0.0065s/iter; left time: 11.0713s
	iters: 200, epoch: 2 | loss: 0.7082118
	speed: 0.0026s/iter; left time: 4.1994s
Updating learning rate to 0.00063860789165
Validation loss decreased (0.3720 --> 0.3687).  Saving model state dict ...
Epoch: 2 cost time: 0.7209582328796387
Epoch: 2, Steps: 257 | Train Loss: 0.6529681 Vali Loss: 0.3686539 Best vali loss: 0.3686539
	iters: 100, epoch: 3 | loss: 0.3771150
	speed: 0.0064s/iter; left time: 9.2797s
	iters: 200, epoch: 3 | loss: 0.6480706
	speed: 0.0027s/iter; left time: 3.5952s
Updating learning rate to 0.000319303945825
Epoch: 3 cost time: 0.7329955101013184
Epoch: 3, Steps: 257 | Train Loss: 0.5125928 Vali Loss: 0.3788999 Best vali loss: 0.3686539
	iters: 100, epoch: 4 | loss: 0.5480011
	speed: 0.0063s/iter; left time: 7.4330s
	iters: 200, epoch: 4 | loss: 0.4792392
	speed: 0.0025s/iter; left time: 2.7109s
Updating learning rate to 0.0001596519729125
Epoch: 4 cost time: 0.6899690628051758
Epoch: 4, Steps: 257 | Train Loss: 0.5136201 Vali Loss: 0.3898856 Best vali loss: 0.3686539
	iters: 100, epoch: 5 | loss: 0.3252494
	speed: 0.0061s/iter; left time: 5.6301s
	iters: 200, epoch: 5 | loss: 0.6958390
	speed: 0.0025s/iter; left time: 2.0608s
Updating learning rate to 7.982598645625e-05
Epoch: 5 cost time: 0.6826555728912354
Epoch: 5, Steps: 257 | Train Loss: 0.5105442 Vali Loss: 0.3862486 Best vali loss: 0.3686539
	iters: 100, epoch: 6 | loss: 0.6329826
	speed: 0.0063s/iter; left time: 4.2149s
	iters: 200, epoch: 6 | loss: 0.4567665
	speed: 0.0026s/iter; left time: 1.4632s
Updating learning rate to 3.9912993228125e-05
Epoch: 6 cost time: 0.7221817970275879
Epoch: 6, Steps: 257 | Train Loss: 0.5448745 Vali Loss: 0.3860054 Best vali loss: 0.3686539
	iters: 100, epoch: 7 | loss: 0.4142561
	speed: 0.0066s/iter; left time: 2.7249s
	iters: 200, epoch: 7 | loss: 0.6826886
	speed: 0.0027s/iter; left time: 0.8507s
Updating learning rate to 1.99564966140625e-05
Epoch: 7 cost time: 0.7471084594726562
Epoch: 7, Steps: 257 | Train Loss: 0.5484723 Vali Loss: 0.3865057 Best vali loss: 0.3686539
	iters: 100, epoch: 8 | loss: 0.6228801
	speed: 0.0064s/iter; left time: 1.0093s
	iters: 200, epoch: 8 | loss: 0.6125665
	speed: 0.0026s/iter; left time: 0.1486s
Updating learning rate to 9.97824830703125e-06
Epoch: 8 cost time: 0.7143793106079102
Epoch: 8, Steps: 257 | Train Loss: 0.6177233 Vali Loss: 0.3866797 Best vali loss: 0.3686539

best validation loss 0.3686538834702992

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0048416987425, 'e_layers': 4, 'learning_rate': 0.0003943831055, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9313275
	speed: 0.0117s/iter; left time: 22.8778s
	iters: 200, epoch: 1 | loss: 0.6963938
	speed: 0.0054s/iter; left time: 10.0321s
Updating learning rate to 0.0003943831055
Validation loss decreased (inf --> 0.3746).  Saving model state dict ...
Epoch: 1 cost time: 1.7471721172332764
Epoch: 1, Steps: 257 | Train Loss: 0.8138607 Vali Loss: 0.3745568 Best vali loss: 0.3745568
	iters: 100, epoch: 2 | loss: 1.1760646
	speed: 0.0114s/iter; left time: 19.3351s
	iters: 200, epoch: 2 | loss: 1.0175145
	speed: 0.0053s/iter; left time: 8.4904s
Updating learning rate to 0.00019719155275
Validation loss decreased (0.3746 --> 0.3712).  Saving model state dict ...
Epoch: 2 cost time: 1.422900676727295
Epoch: 2, Steps: 257 | Train Loss: 1.0967895 Vali Loss: 0.3711913 Best vali loss: 0.3711913
	iters: 100, epoch: 3 | loss: 0.5047190
	speed: 0.0106s/iter; left time: 15.3431s
	iters: 200, epoch: 3 | loss: 0.6643226
	speed: 0.0048s/iter; left time: 6.4152s
Updating learning rate to 9.8595776375e-05
Validation loss decreased (0.3712 --> 0.3704).  Saving model state dict ...
Epoch: 3 cost time: 1.2762815952301025
Epoch: 3, Steps: 257 | Train Loss: 0.5845208 Vali Loss: 0.3703873 Best vali loss: 0.3703873

best validation loss 0.3703872651037392

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.009488262331, 'e_layers': 3, 'learning_rate': 0.000141456595, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000141456595
Validation loss decreased (inf --> 0.4275).  Saving model state dict ...
Epoch: 1 cost time: 0.7226400375366211
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4274589 Best vali loss: 0.4274589
Updating learning rate to 7.07282975e-05
Validation loss decreased (0.4275 --> 0.4094).  Saving model state dict ...
Epoch: 2 cost time: 0.4147965908050537
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4093803 Best vali loss: 0.4093803
Updating learning rate to 3.536414875e-05
Validation loss decreased (0.4094 --> 0.4027).  Saving model state dict ...
Epoch: 3 cost time: 0.37291717529296875
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4027144 Best vali loss: 0.4027144

best validation loss 0.4027143575236465

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0094639565353, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 1.0889523029327393
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3685707 Best vali loss: 0.3685707
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3686 --> 0.3602).  Saving model state dict ...
Epoch: 2 cost time: 0.7720921039581299
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3601748 Best vali loss: 0.3601748
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3602 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 0.7743687629699707
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3538964 Best vali loss: 0.3538964

best validation loss 0.35389643943848453

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0094639565353, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3539 --> 0.3521).  Saving model state dict ...
Epoch: 4 cost time: 1.0882458686828613
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3521496 Best vali loss: 0.3521496
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3521 --> 0.3475).  Saving model state dict ...
Epoch: 5 cost time: 0.7791228294372559
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3475282 Best vali loss: 0.3475282
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3475 --> 0.3440).  Saving model state dict ...
Epoch: 6 cost time: 0.7737033367156982
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3439980 Best vali loss: 0.3439980
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3440 --> 0.3415).  Saving model state dict ...
Epoch: 7 cost time: 0.7690308094024658
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3414912 Best vali loss: 0.3414912
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7708652019500732
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3445076 Best vali loss: 0.3414912

best validation loss 0.34149122967701295

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0080015138287, 'e_layers': 4, 'learning_rate': 0.0007416477606, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007134204734755853
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 0.9046380519866943
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3674584 Best vali loss: 0.3674584
Updating learning rate to 0.0006330359606860385
Validation loss decreased (0.3675 --> 0.3607).  Saving model state dict ...
Epoch: 2 cost time: 0.5797441005706787
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3606889 Best vali loss: 0.3606889
Updating learning rate to 0.0005127320356161452
Validation loss decreased (0.3607 --> 0.3581).  Saving model state dict ...
Epoch: 3 cost time: 0.589317798614502
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3581219 Best vali loss: 0.3581219
Updating learning rate to 0.0003708238803
Epoch: 4 cost time: 0.584453821182251
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3749959 Best vali loss: 0.3581219
Updating learning rate to 0.00022891572498385482
Epoch: 5 cost time: 0.5804264545440674
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3583538 Best vali loss: 0.3581219
Updating learning rate to 0.00010861179991396142
Validation loss decreased (0.3581 --> 0.3576).  Saving model state dict ...
Epoch: 6 cost time: 0.5816729068756104
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3576498 Best vali loss: 0.3576498
Updating learning rate to 2.8227287124414647e-05
Validation loss decreased (0.3576 --> 0.3515).  Saving model state dict ...
Epoch: 7 cost time: 0.5805478096008301
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3514781 Best vali loss: 0.3514781
Updating learning rate to 0.0
Epoch: 8 cost time: 0.587369441986084
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3533383 Best vali loss: 0.3514781

best validation loss 0.3514780675615449

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0105273503766, 'e_layers': 2, 'learning_rate': 0.0001579366513, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6579140
	speed: 0.0100s/iter; left time: 19.5696s
	iters: 200, epoch: 1 | loss: 0.3960125
	speed: 0.0035s/iter; left time: 6.4936s
Updating learning rate to 0.0001579366513
Validation loss decreased (inf --> 0.3953).  Saving model state dict ...
Epoch: 1 cost time: 1.2719926834106445
Epoch: 1, Steps: 257 | Train Loss: 0.5269633 Vali Loss: 0.3953068 Best vali loss: 0.3953068
	iters: 100, epoch: 2 | loss: 0.5571367
	speed: 0.0082s/iter; left time: 13.9076s
	iters: 200, epoch: 2 | loss: 0.6923908
	speed: 0.0036s/iter; left time: 5.7082s
Updating learning rate to 7.896832565e-05
Validation loss decreased (0.3953 --> 0.3797).  Saving model state dict ...
Epoch: 2 cost time: 0.9819855690002441
Epoch: 2, Steps: 257 | Train Loss: 0.6247637 Vali Loss: 0.3796966 Best vali loss: 0.3796966
	iters: 100, epoch: 3 | loss: 0.4056313
	speed: 0.0081s/iter; left time: 11.7076s
	iters: 200, epoch: 3 | loss: 0.5555137
	speed: 0.0034s/iter; left time: 4.5336s
Updating learning rate to 3.9484162825e-05
Validation loss decreased (0.3797 --> 0.3754).  Saving model state dict ...
Epoch: 3 cost time: 0.9144089221954346
Epoch: 3, Steps: 257 | Train Loss: 0.4805725 Vali Loss: 0.3753870 Best vali loss: 0.3753870
	iters: 100, epoch: 4 | loss: 0.6706994
	speed: 0.0078s/iter; left time: 9.1923s
	iters: 200, epoch: 4 | loss: 0.5235754
	speed: 0.0033s/iter; left time: 3.5681s
Updating learning rate to 1.97420814125e-05
Validation loss decreased (0.3754 --> 0.3732).  Saving model state dict ...
Epoch: 4 cost time: 0.9113986492156982
Epoch: 4, Steps: 257 | Train Loss: 0.5971374 Vali Loss: 0.3731997 Best vali loss: 0.3731997
	iters: 100, epoch: 5 | loss: 0.7808855
	speed: 0.0077s/iter; left time: 7.1625s
	iters: 200, epoch: 5 | loss: 0.8086212
	speed: 0.0033s/iter; left time: 2.7185s
Updating learning rate to 9.87104070625e-06
Validation loss decreased (0.3732 --> 0.3724).  Saving model state dict ...
Epoch: 5 cost time: 0.9035470485687256
Epoch: 5, Steps: 257 | Train Loss: 0.7947534 Vali Loss: 0.3723878 Best vali loss: 0.3723878
	iters: 100, epoch: 6 | loss: 0.8222660
	speed: 0.0075s/iter; left time: 5.0325s
	iters: 200, epoch: 6 | loss: 0.8929911
	speed: 0.0034s/iter; left time: 1.9544s
Updating learning rate to 4.935520353125e-06
Validation loss decreased (0.3724 --> 0.3719).  Saving model state dict ...
Epoch: 6 cost time: 0.9084389209747314
Epoch: 6, Steps: 257 | Train Loss: 0.8576286 Vali Loss: 0.3719311 Best vali loss: 0.3719311
	iters: 100, epoch: 7 | loss: 0.6342550
	speed: 0.0084s/iter; left time: 3.4822s
	iters: 200, epoch: 7 | loss: 0.6230774
	speed: 0.0037s/iter; left time: 1.1596s
Updating learning rate to 2.4677601765625e-06
Validation loss decreased (0.3719 --> 0.3719).  Saving model state dict ...
Epoch: 7 cost time: 1.0235669612884521
Epoch: 7, Steps: 257 | Train Loss: 0.6286662 Vali Loss: 0.3718561 Best vali loss: 0.3718561
	iters: 100, epoch: 8 | loss: 0.7149506
	speed: 0.0080s/iter; left time: 1.2677s
	iters: 200, epoch: 8 | loss: 0.4865765
	speed: 0.0036s/iter; left time: 0.2115s
Updating learning rate to 1.23388008828125e-06
Validation loss decreased (0.3719 --> 0.3718).  Saving model state dict ...
Epoch: 8 cost time: 0.9714245796203613
Epoch: 8, Steps: 257 | Train Loss: 0.6007635 Vali Loss: 0.3718096 Best vali loss: 0.3718096

best validation loss 0.37180961763929055

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.002202781024, 'e_layers': 4, 'learning_rate': 0.0004020938206, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3728106
	speed: 0.0114s/iter; left time: 45.6784s
	iters: 200, epoch: 1 | loss: 0.4401705
	speed: 0.0050s/iter; left time: 19.4647s
	iters: 300, epoch: 1 | loss: 0.5067804
	speed: 0.0046s/iter; left time: 17.3888s
	iters: 400, epoch: 1 | loss: 0.4651505
	speed: 0.0046s/iter; left time: 17.0633s
	iters: 500, epoch: 1 | loss: 0.6521239
	speed: 0.0048s/iter; left time: 17.2853s
Updating learning rate to 0.0003867900358008026
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 2.8314521312713623
Epoch: 1, Steps: 514 | Train Loss: 0.4874072 Vali Loss: 0.3698801 Best vali loss: 0.3698801
	iters: 100, epoch: 2 | loss: 0.6169816
	speed: 0.0103s/iter; left time: 36.0106s
	iters: 200, epoch: 2 | loss: 1.0195788
	speed: 0.0050s/iter; left time: 17.0419s
	iters: 300, epoch: 2 | loss: 0.8851484
	speed: 0.0052s/iter; left time: 17.2459s
	iters: 400, epoch: 2 | loss: 0.6104235
	speed: 0.0051s/iter; left time: 16.1868s
	iters: 500, epoch: 2 | loss: 0.7238136
	speed: 0.0050s/iter; left time: 15.5279s
Updating learning rate to 0.00034320854390973356
Epoch: 2 cost time: 2.6687002182006836
Epoch: 2, Steps: 514 | Train Loss: 0.7711892 Vali Loss: 0.3836724 Best vali loss: 0.3698801
	iters: 100, epoch: 3 | loss: 0.5796411
	speed: 0.0102s/iter; left time: 30.3002s
	iters: 200, epoch: 3 | loss: 0.5894307
	speed: 0.0051s/iter; left time: 14.5808s
	iters: 300, epoch: 3 | loss: 0.7123279
	speed: 0.0051s/iter; left time: 14.1815s
	iters: 400, epoch: 3 | loss: 0.6623715
	speed: 0.0052s/iter; left time: 13.9045s
	iters: 500, epoch: 3 | loss: 1.1956240
	speed: 0.0051s/iter; left time: 13.2738s
Updating learning rate to 0.0002779842320000004
Epoch: 3 cost time: 2.6805005073547363
Epoch: 3, Steps: 514 | Train Loss: 0.7478790 Vali Loss: 0.3784870 Best vali loss: 0.3698801

best validation loss 0.36988009669340427

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0015828111081, 'e_layers': 3, 'learning_rate': 0.0019096795526, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4640922
	speed: 0.0103s/iter; left time: 83.5304s
	iters: 200, epoch: 1 | loss: 0.2786053
	speed: 0.0041s/iter; left time: 32.7615s
	iters: 300, epoch: 1 | loss: 0.9604046
	speed: 0.0041s/iter; left time: 32.4482s
	iters: 400, epoch: 1 | loss: 0.3116436
	speed: 0.0040s/iter; left time: 31.1936s
	iters: 500, epoch: 1 | loss: 0.4441413
	speed: 0.0040s/iter; left time: 30.5085s
	iters: 600, epoch: 1 | loss: 0.3605959
	speed: 0.0041s/iter; left time: 30.9379s
	iters: 700, epoch: 1 | loss: 0.5290312
	speed: 0.0041s/iter; left time: 30.7004s
	iters: 800, epoch: 1 | loss: 0.5045900
	speed: 0.0040s/iter; left time: 29.9606s
	iters: 900, epoch: 1 | loss: 0.3648638
	speed: 0.0042s/iter; left time: 30.4152s
	iters: 1000, epoch: 1 | loss: 0.5678169
	speed: 0.0042s/iter; left time: 30.1073s
Updating learning rate to 0.0018369967024512255
Validation loss decreased (inf --> 0.3905).  Saving model state dict ...
Epoch: 1 cost time: 4.531023025512695
Epoch: 1, Steps: 1027 | Train Loss: 0.4785785 Vali Loss: 0.3904851 Best vali loss: 0.3904851
	iters: 100, epoch: 2 | loss: 0.3791008
	speed: 0.0112s/iter; left time: 79.6138s
	iters: 200, epoch: 2 | loss: 0.9821902
	speed: 0.0042s/iter; left time: 29.0517s
	iters: 300, epoch: 2 | loss: 0.3919899
	speed: 0.0041s/iter; left time: 28.2873s
	iters: 400, epoch: 2 | loss: 1.2602019
	speed: 0.0041s/iter; left time: 27.5536s
	iters: 500, epoch: 2 | loss: 0.4165194
	speed: 0.0041s/iter; left time: 27.5485s
	iters: 600, epoch: 2 | loss: 0.4201444
	speed: 0.0041s/iter; left time: 27.0839s
	iters: 700, epoch: 2 | loss: 1.0399950
	speed: 0.0041s/iter; left time: 26.8757s
	iters: 800, epoch: 2 | loss: 0.5713593
	speed: 0.0042s/iter; left time: 26.6130s
	iters: 900, epoch: 2 | loss: 0.3773261
	speed: 0.0041s/iter; left time: 26.0744s
	iters: 1000, epoch: 2 | loss: 0.3435580
	speed: 0.0041s/iter; left time: 25.3894s
Updating learning rate to 0.001630013457068376
Epoch: 2 cost time: 4.278420448303223
Epoch: 2, Steps: 1027 | Train Loss: 0.6182385 Vali Loss: 0.4008642 Best vali loss: 0.3904851
	iters: 100, epoch: 3 | loss: 0.2710110
	speed: 0.0110s/iter; left time: 66.5144s
	iters: 200, epoch: 3 | loss: 1.6280106
	speed: 0.0041s/iter; left time: 24.5569s
	iters: 300, epoch: 3 | loss: 0.4493476
	speed: 0.0041s/iter; left time: 24.3067s
	iters: 400, epoch: 3 | loss: 0.6207127
	speed: 0.0041s/iter; left time: 23.8440s
	iters: 500, epoch: 3 | loss: 0.6297976
	speed: 0.0042s/iter; left time: 23.5452s
	iters: 600, epoch: 3 | loss: 1.0756381
	speed: 0.0042s/iter; left time: 23.2951s
	iters: 700, epoch: 3 | loss: 0.1730834
	speed: 0.0041s/iter; left time: 22.6585s
	iters: 800, epoch: 3 | loss: 0.2516310
	speed: 0.0042s/iter; left time: 22.4492s
	iters: 900, epoch: 3 | loss: 0.2572928
	speed: 0.0042s/iter; left time: 21.8997s
	iters: 1000, epoch: 3 | loss: 0.6376591
	speed: 0.0042s/iter; left time: 21.5965s
Updating learning rate to 0.0013202411392531986
Validation loss decreased (0.3905 --> 0.3839).  Saving model state dict ...
Epoch: 3 cost time: 4.311763525009155
Epoch: 3, Steps: 1027 | Train Loss: 0.5994184 Vali Loss: 0.3839448 Best vali loss: 0.3839448

best validation loss 0.38394483450822137

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0031203934828, 'e_layers': 2, 'learning_rate': 0.0001780089882, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001780089882
Validation loss decreased (inf --> 0.4024).  Saving model state dict ...
Epoch: 1 cost time: 0.6792628765106201
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4024130 Best vali loss: 0.4024130
Updating learning rate to 8.90044941e-05
Validation loss decreased (0.4024 --> 0.3822).  Saving model state dict ...
Epoch: 2 cost time: 0.35732531547546387
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3822469 Best vali loss: 0.3822469
Updating learning rate to 4.450224705e-05
Validation loss decreased (0.3822 --> 0.3769).  Saving model state dict ...
Epoch: 3 cost time: 0.34185361862182617
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3768531 Best vali loss: 0.3768531

best validation loss 0.3768531279503011

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.002202781024, 'e_layers': 4, 'learning_rate': 0.0004020938206, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3630902
	speed: 0.0116s/iter; left time: 28.6949s
	iters: 200, epoch: 4 | loss: 0.4094656
	speed: 0.0052s/iter; left time: 12.3864s
	iters: 300, epoch: 4 | loss: 0.4439793
	speed: 0.0053s/iter; left time: 11.9370s
	iters: 400, epoch: 4 | loss: 0.4773444
	speed: 0.0052s/iter; left time: 11.3160s
	iters: 500, epoch: 4 | loss: 0.7336270
	speed: 0.0052s/iter; left time: 10.7095s
Updating learning rate to 0.0002010469103
Validation loss decreased (0.3699 --> 0.3664).  Saving model state dict ...
Epoch: 4 cost time: 3.0333712100982666
Epoch: 4, Steps: 514 | Train Loss: 0.4855013 Vali Loss: 0.3664365 Best vali loss: 0.3664365
	iters: 100, epoch: 5 | loss: 0.5481193
	speed: 0.0101s/iter; left time: 19.7974s
	iters: 200, epoch: 5 | loss: 0.9819635
	speed: 0.0050s/iter; left time: 9.3395s
	iters: 300, epoch: 5 | loss: 0.6751844
	speed: 0.0052s/iter; left time: 9.0547s
	iters: 400, epoch: 5 | loss: 0.5518414
	speed: 0.0051s/iter; left time: 8.4115s
	iters: 500, epoch: 5 | loss: 0.5994023
	speed: 0.0051s/iter; left time: 7.8639s
Updating learning rate to 0.0001241095885999997
Validation loss decreased (0.3664 --> 0.3569).  Saving model state dict ...
Epoch: 5 cost time: 2.6395606994628906
Epoch: 5, Steps: 514 | Train Loss: 0.6713022 Vali Loss: 0.3569177 Best vali loss: 0.3569177
	iters: 100, epoch: 6 | loss: 0.4407265
	speed: 0.0104s/iter; left time: 15.0630s
	iters: 200, epoch: 6 | loss: 0.4883895
	speed: 0.0052s/iter; left time: 6.9275s
	iters: 300, epoch: 6 | loss: 0.6386278
	speed: 0.0050s/iter; left time: 6.1708s
	iters: 400, epoch: 6 | loss: 0.6511478
	speed: 0.0048s/iter; left time: 5.4385s
	iters: 500, epoch: 6 | loss: 0.8074093
	speed: 0.0047s/iter; left time: 4.8546s
Updating learning rate to 5.8885276690266466e-05
Validation loss decreased (0.3569 --> 0.3569).  Saving model state dict ...
Epoch: 6 cost time: 2.592973232269287
Epoch: 6, Steps: 514 | Train Loss: 0.6052602 Vali Loss: 0.3568921 Best vali loss: 0.3568921
	iters: 100, epoch: 7 | loss: 0.8053386
	speed: 0.0099s/iter; left time: 9.2075s
	iters: 200, epoch: 7 | loss: 0.4687727
	speed: 0.0048s/iter; left time: 4.0007s
	iters: 300, epoch: 7 | loss: 0.5853093
	speed: 0.0047s/iter; left time: 3.4483s
	iters: 400, epoch: 7 | loss: 0.6436176
	speed: 0.0047s/iter; left time: 2.9652s
	iters: 500, epoch: 7 | loss: 0.5221235
	speed: 0.0046s/iter; left time: 2.4528s
Updating learning rate to 1.5303784799197402e-05
Validation loss decreased (0.3569 --> 0.3477).  Saving model state dict ...
Epoch: 7 cost time: 2.491455078125
Epoch: 7, Steps: 514 | Train Loss: 0.6050323 Vali Loss: 0.3477221 Best vali loss: 0.3477221
	iters: 100, epoch: 8 | loss: 0.5884013
	speed: 0.0103s/iter; left time: 4.2705s
	iters: 200, epoch: 8 | loss: 0.4462457
	speed: 0.0050s/iter; left time: 1.5901s
	iters: 300, epoch: 8 | loss: 0.3148175
	speed: 0.0048s/iter; left time: 1.0293s
	iters: 400, epoch: 8 | loss: 0.2136645
	speed: 0.0047s/iter; left time: 0.5388s
	iters: 500, epoch: 8 | loss: 0.5332479
	speed: 0.0046s/iter; left time: 0.0692s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.546438694000244
Epoch: 8, Steps: 514 | Train Loss: 0.4192754 Vali Loss: 0.3509463 Best vali loss: 0.3477221

best validation loss 0.347722093137402

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022085948267, 'e_layers': 2, 'learning_rate': 0.0004099023218, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8050199
	speed: 0.0096s/iter; left time: 38.4615s
	iters: 200, epoch: 1 | loss: 0.3315256
	speed: 0.0035s/iter; left time: 13.8016s
	iters: 300, epoch: 1 | loss: 0.5300443
	speed: 0.0033s/iter; left time: 12.7058s
	iters: 400, epoch: 1 | loss: 0.9995098
	speed: 0.0031s/iter; left time: 11.3267s
	iters: 500, epoch: 1 | loss: 0.9158407
	speed: 0.0031s/iter; left time: 11.2963s
Updating learning rate to 0.0004099023218
Validation loss decreased (inf --> 0.3832).  Saving model state dict ...
Epoch: 1 cost time: 2.055837392807007
Epoch: 1, Steps: 514 | Train Loss: 0.7163880 Vali Loss: 0.3832134 Best vali loss: 0.3832134
	iters: 100, epoch: 2 | loss: 1.2707478
	speed: 0.0071s/iter; left time: 24.7263s
	iters: 200, epoch: 2 | loss: 0.6672112
	speed: 0.0030s/iter; left time: 10.3619s
	iters: 300, epoch: 2 | loss: 0.6819461
	speed: 0.0031s/iter; left time: 10.3244s
	iters: 400, epoch: 2 | loss: 0.6915068
	speed: 0.0031s/iter; left time: 9.8837s
	iters: 500, epoch: 2 | loss: 0.6966939
	speed: 0.0031s/iter; left time: 9.7226s
Updating learning rate to 0.0002049511609
Validation loss decreased (0.3832 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 1.6438374519348145
Epoch: 2, Steps: 514 | Train Loss: 0.8016212 Vali Loss: 0.3659412 Best vali loss: 0.3659412
	iters: 100, epoch: 3 | loss: 0.4682251
	speed: 0.0072s/iter; left time: 21.4875s
	iters: 200, epoch: 3 | loss: 0.4557609
	speed: 0.0031s/iter; left time: 8.8317s
	iters: 300, epoch: 3 | loss: 0.5264972
	speed: 0.0031s/iter; left time: 8.5684s
	iters: 400, epoch: 3 | loss: 0.5021479
	speed: 0.0030s/iter; left time: 8.1305s
	iters: 500, epoch: 3 | loss: 1.0843763
	speed: 0.0031s/iter; left time: 8.0481s
Updating learning rate to 0.00010247558045
Epoch: 3 cost time: 1.6358551979064941
Epoch: 3, Steps: 514 | Train Loss: 0.6074015 Vali Loss: 0.3736803 Best vali loss: 0.3659412
	iters: 100, epoch: 4 | loss: 0.4278310
	speed: 0.0073s/iter; left time: 18.1507s
	iters: 200, epoch: 4 | loss: 0.5194699
	speed: 0.0032s/iter; left time: 7.6053s
	iters: 300, epoch: 4 | loss: 0.4379182
	speed: 0.0030s/iter; left time: 6.8362s
	iters: 400, epoch: 4 | loss: 0.3881945
	speed: 0.0031s/iter; left time: 6.7618s
	iters: 500, epoch: 4 | loss: 0.3827795
	speed: 0.0032s/iter; left time: 6.5643s
Updating learning rate to 5.1237790225e-05
Epoch: 4 cost time: 1.6749505996704102
Epoch: 4, Steps: 514 | Train Loss: 0.4312386 Vali Loss: 0.3768831 Best vali loss: 0.3659412
	iters: 100, epoch: 5 | loss: 0.3594204
	speed: 0.0076s/iter; left time: 14.7821s
	iters: 200, epoch: 5 | loss: 0.5729594
	speed: 0.0035s/iter; left time: 6.5052s
	iters: 300, epoch: 5 | loss: 0.2430594
	speed: 0.0035s/iter; left time: 6.1459s
	iters: 400, epoch: 5 | loss: 0.4157180
	speed: 0.0036s/iter; left time: 6.0360s
	iters: 500, epoch: 5 | loss: 0.5238514
	speed: 0.0034s/iter; left time: 5.3269s
Updating learning rate to 2.56188951125e-05
Epoch: 5 cost time: 1.8740332126617432
Epoch: 5, Steps: 514 | Train Loss: 0.4230017 Vali Loss: 0.3801827 Best vali loss: 0.3659412
	iters: 100, epoch: 6 | loss: 0.3758012
	speed: 0.0075s/iter; left time: 10.8702s
	iters: 200, epoch: 6 | loss: 0.3821615
	speed: 0.0033s/iter; left time: 4.3732s
	iters: 300, epoch: 6 | loss: 0.2808414
	speed: 0.0032s/iter; left time: 4.0014s
	iters: 400, epoch: 6 | loss: 0.5759499
	speed: 0.0033s/iter; left time: 3.7824s
	iters: 500, epoch: 6 | loss: 0.6510584
	speed: 0.0033s/iter; left time: 3.4194s
Updating learning rate to 1.280944755625e-05
Epoch: 6 cost time: 1.7394437789916992
Epoch: 6, Steps: 514 | Train Loss: 0.4531625 Vali Loss: 0.3842933 Best vali loss: 0.3659412
	iters: 100, epoch: 7 | loss: 0.3928767
	speed: 0.0072s/iter; left time: 6.6934s
	iters: 200, epoch: 7 | loss: 0.2429075
	speed: 0.0032s/iter; left time: 2.6371s
	iters: 300, epoch: 7 | loss: 0.5960923
	speed: 0.0032s/iter; left time: 2.2968s
	iters: 400, epoch: 7 | loss: 0.5030421
	speed: 0.0031s/iter; left time: 1.9547s
	iters: 500, epoch: 7 | loss: 0.4137222
	speed: 0.0031s/iter; left time: 1.6246s
Updating learning rate to 6.404723778125e-06
Epoch: 7 cost time: 1.6734864711761475
Epoch: 7, Steps: 514 | Train Loss: 0.4297282 Vali Loss: 0.3837373 Best vali loss: 0.3659412
	iters: 100, epoch: 8 | loss: 0.3055755
	speed: 0.0076s/iter; left time: 3.1349s
	iters: 200, epoch: 8 | loss: 0.4978273
	speed: 0.0033s/iter; left time: 1.0357s
	iters: 300, epoch: 8 | loss: 0.6990076
	speed: 0.0032s/iter; left time: 0.6828s
	iters: 400, epoch: 8 | loss: 0.6803675
	speed: 0.0033s/iter; left time: 0.3815s
	iters: 500, epoch: 8 | loss: 0.4311415
	speed: 0.0032s/iter; left time: 0.0479s
Updating learning rate to 3.2023618890625e-06
Epoch: 8 cost time: 1.7226788997650146
Epoch: 8, Steps: 514 | Train Loss: 0.5227839 Vali Loss: 0.3831365 Best vali loss: 0.3659412

best validation loss 0.3659411856608213

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022166418113, 'e_layers': 2, 'learning_rate': 0.0004054062349, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8034534
	speed: 0.0098s/iter; left time: 39.2904s
	iters: 200, epoch: 1 | loss: 0.3314062
	speed: 0.0034s/iter; left time: 13.1495s
	iters: 300, epoch: 1 | loss: 0.5230629
	speed: 0.0033s/iter; left time: 12.6745s
	iters: 400, epoch: 1 | loss: 1.0749080
	speed: 0.0033s/iter; left time: 12.1018s
	iters: 500, epoch: 1 | loss: 0.9194059
	speed: 0.0033s/iter; left time: 11.7840s
Updating learning rate to 0.0003899763788382864
Validation loss decreased (inf --> 0.3900).  Saving model state dict ...
Epoch: 1 cost time: 2.077329397201538
Epoch: 1, Steps: 514 | Train Loss: 0.7304473 Vali Loss: 0.3900451 Best vali loss: 0.3900451
	iters: 100, epoch: 2 | loss: 1.2354138
	speed: 0.0073s/iter; left time: 25.4445s
	iters: 200, epoch: 2 | loss: 0.6923278
	speed: 0.0033s/iter; left time: 11.3804s
	iters: 300, epoch: 2 | loss: 0.6730480
	speed: 0.0033s/iter; left time: 10.8741s
	iters: 400, epoch: 2 | loss: 0.6423455
	speed: 0.0032s/iter; left time: 10.2684s
	iters: 500, epoch: 2 | loss: 0.6944898
	speed: 0.0032s/iter; left time: 9.9609s
Updating learning rate to 0.0003460358663665482
Validation loss decreased (0.3900 --> 0.3721).  Saving model state dict ...
Epoch: 2 cost time: 1.7388231754302979
Epoch: 2, Steps: 514 | Train Loss: 0.7875250 Vali Loss: 0.3720921 Best vali loss: 0.3720921
	iters: 100, epoch: 3 | loss: 0.4760924
	speed: 0.0075s/iter; left time: 22.3773s
	iters: 200, epoch: 3 | loss: 0.4722838
	speed: 0.0035s/iter; left time: 10.0482s
	iters: 300, epoch: 3 | loss: 0.5397338
	speed: 0.0035s/iter; left time: 9.7586s
	iters: 400, epoch: 3 | loss: 0.5126317
	speed: 0.0035s/iter; left time: 9.4220s
	iters: 500, epoch: 3 | loss: 1.2404478
	speed: 0.0034s/iter; left time: 8.8771s
Updating learning rate to 0.0002802742421868699
Validation loss decreased (0.3721 --> 0.3682).  Saving model state dict ...
Epoch: 3 cost time: 1.822767734527588
Epoch: 3, Steps: 514 | Train Loss: 0.6482379 Vali Loss: 0.3682144 Best vali loss: 0.3682144
	iters: 100, epoch: 4 | loss: 0.4535094
	speed: 0.0074s/iter; left time: 18.3646s
	iters: 200, epoch: 4 | loss: 0.5287340
	speed: 0.0033s/iter; left time: 7.8469s
	iters: 300, epoch: 4 | loss: 0.4686631
	speed: 0.0033s/iter; left time: 7.5484s
	iters: 400, epoch: 4 | loss: 0.3959566
	speed: 0.0033s/iter; left time: 7.2414s
	iters: 500, epoch: 4 | loss: 0.3488724
	speed: 0.0033s/iter; left time: 6.8953s
Updating learning rate to 0.00020270311745
Epoch: 4 cost time: 1.7626519203186035
Epoch: 4, Steps: 514 | Train Loss: 0.4391471 Vali Loss: 0.3938607 Best vali loss: 0.3682144
	iters: 100, epoch: 5 | loss: 0.3809647
	speed: 0.0073s/iter; left time: 14.2056s
	iters: 200, epoch: 5 | loss: 0.5519308
	speed: 0.0033s/iter; left time: 6.1965s
	iters: 300, epoch: 5 | loss: 0.2563545
	speed: 0.0033s/iter; left time: 5.7388s
	iters: 400, epoch: 5 | loss: 0.4163516
	speed: 0.0033s/iter; left time: 5.5460s
	iters: 500, epoch: 5 | loss: 0.4550792
	speed: 0.0034s/iter; left time: 5.2351s
Updating learning rate to 0.00012513199271313007
Epoch: 5 cost time: 1.76548171043396
Epoch: 5, Steps: 514 | Train Loss: 0.4121362 Vali Loss: 0.4122366 Best vali loss: 0.3682144
	iters: 100, epoch: 6 | loss: 0.3979368
	speed: 0.0071s/iter; left time: 10.2442s
	iters: 200, epoch: 6 | loss: 0.3476551
	speed: 0.0032s/iter; left time: 4.2799s
	iters: 300, epoch: 6 | loss: 0.2816250
	speed: 0.0031s/iter; left time: 3.8186s
	iters: 400, epoch: 6 | loss: 0.5497683
	speed: 0.0031s/iter; left time: 3.5046s
	iters: 500, epoch: 6 | loss: 0.5980925
	speed: 0.0032s/iter; left time: 3.3675s
Updating learning rate to 5.937036853345182e-05
Epoch: 6 cost time: 1.6701250076293945
Epoch: 6, Steps: 514 | Train Loss: 0.4350155 Vali Loss: 0.3992568 Best vali loss: 0.3682144
	iters: 100, epoch: 7 | loss: 0.3931857
	speed: 0.0073s/iter; left time: 6.7670s
	iters: 200, epoch: 7 | loss: 0.2559005
	speed: 0.0033s/iter; left time: 2.7672s
	iters: 300, epoch: 7 | loss: 0.5455596
	speed: 0.0033s/iter; left time: 2.3902s
	iters: 400, epoch: 7 | loss: 0.5088133
	speed: 0.0034s/iter; left time: 2.1525s
	iters: 500, epoch: 7 | loss: 0.3566908
	speed: 0.0033s/iter; left time: 1.7229s
Updating learning rate to 1.542985606171355e-05
Epoch: 7 cost time: 1.7561125755310059
Epoch: 7, Steps: 514 | Train Loss: 0.4120300 Vali Loss: 0.4086691 Best vali loss: 0.3682144
	iters: 100, epoch: 8 | loss: 0.2626836
	speed: 0.0072s/iter; left time: 2.9725s
	iters: 200, epoch: 8 | loss: 0.4710028
	speed: 0.0033s/iter; left time: 1.0447s
	iters: 300, epoch: 8 | loss: 0.6789427
	speed: 0.0033s/iter; left time: 0.7066s
	iters: 400, epoch: 8 | loss: 0.6509201
	speed: 0.0033s/iter; left time: 0.3766s
	iters: 500, epoch: 8 | loss: 0.3884294
	speed: 0.0033s/iter; left time: 0.0495s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7358510494232178
Epoch: 8, Steps: 514 | Train Loss: 0.4903957 Vali Loss: 0.4098175 Best vali loss: 0.3682144

best validation loss 0.36821437483335057

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021925561452, 'e_layers': 2, 'learning_rate': 0.0004052646279, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8034717
	speed: 0.0097s/iter; left time: 39.0952s
	iters: 200, epoch: 1 | loss: 0.3312095
	speed: 0.0033s/iter; left time: 13.0568s
	iters: 300, epoch: 1 | loss: 0.5213966
	speed: 0.0030s/iter; left time: 11.5498s
	iters: 400, epoch: 1 | loss: 1.0798463
	speed: 0.0030s/iter; left time: 11.2521s
	iters: 500, epoch: 1 | loss: 0.9161447
	speed: 0.0030s/iter; left time: 10.9202s
Updating learning rate to 0.0003898401614338063
Validation loss decreased (inf --> 0.3763).  Saving model state dict ...
Epoch: 1 cost time: 1.9925878047943115
Epoch: 1, Steps: 514 | Train Loss: 0.7304138 Vali Loss: 0.3763253 Best vali loss: 0.3763253
	iters: 100, epoch: 2 | loss: 1.1190132
	speed: 0.0075s/iter; left time: 26.2050s
	iters: 200, epoch: 2 | loss: 0.6533582
	speed: 0.0035s/iter; left time: 11.7958s
	iters: 300, epoch: 2 | loss: 0.6979488
	speed: 0.0036s/iter; left time: 11.7772s
	iters: 400, epoch: 2 | loss: 0.6290083
	speed: 0.0034s/iter; left time: 10.8742s
	iters: 500, epoch: 2 | loss: 0.7117245
	speed: 0.0036s/iter; left time: 11.0433s
Updating learning rate to 0.00034591499723156643
Validation loss decreased (0.3763 --> 0.3615).  Saving model state dict ...
Epoch: 2 cost time: 1.8318512439727783
Epoch: 2, Steps: 514 | Train Loss: 0.7622106 Vali Loss: 0.3614592 Best vali loss: 0.3614592
	iters: 100, epoch: 3 | loss: 0.4792159
	speed: 0.0077s/iter; left time: 22.9668s
	iters: 200, epoch: 3 | loss: 0.3926684
	speed: 0.0036s/iter; left time: 10.2962s
	iters: 300, epoch: 3 | loss: 0.5584524
	speed: 0.0034s/iter; left time: 9.5583s
	iters: 400, epoch: 3 | loss: 0.4740848
	speed: 0.0035s/iter; left time: 9.5268s
	iters: 500, epoch: 3 | loss: 0.9220045
	speed: 0.0034s/iter; left time: 8.8616s
Updating learning rate to 0.0002801763433604665
Validation loss decreased (0.3615 --> 0.3589).  Saving model state dict ...
Epoch: 3 cost time: 1.8437144756317139
Epoch: 3, Steps: 514 | Train Loss: 0.5652852 Vali Loss: 0.3589012 Best vali loss: 0.3589012

best validation loss 0.3589011910329399

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.001473133808, 'e_layers': 2, 'learning_rate': 0.0020294940758, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020294940758
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 0.6687822341918945
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3694755 Best vali loss: 0.3694755
Updating learning rate to 0.0010147470379
Epoch: 2 cost time: 0.3590519428253174
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3738877 Best vali loss: 0.3694755
Updating learning rate to 0.00050737351895
Validation loss decreased (0.3695 --> 0.3663).  Saving model state dict ...
Epoch: 3 cost time: 0.3568692207336426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3662948 Best vali loss: 0.3662948

best validation loss 0.36629475822383156

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0063549230458, 'e_layers': 1, 'learning_rate': 0.0042272505675, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0042272505675
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 0.6196091175079346
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3688479 Best vali loss: 0.3688479
Updating learning rate to 0.00211362528375
Epoch: 2 cost time: 0.3087649345397949
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3732109 Best vali loss: 0.3688479
Updating learning rate to 0.001056812641875
Epoch: 3 cost time: 0.31452465057373047
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3865115 Best vali loss: 0.3688479

best validation loss 0.3688479466147882

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021925561452, 'e_layers': 2, 'learning_rate': 0.0004052646279, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5414488
	speed: 0.0099s/iter; left time: 24.5359s
	iters: 200, epoch: 4 | loss: 0.2910439
	speed: 0.0036s/iter; left time: 8.6045s
	iters: 300, epoch: 4 | loss: 0.3527967
	speed: 0.0036s/iter; left time: 8.1213s
	iters: 400, epoch: 4 | loss: 0.6339582
	speed: 0.0035s/iter; left time: 7.6997s
	iters: 500, epoch: 4 | loss: 0.8280914
	speed: 0.0034s/iter; left time: 7.0382s
Updating learning rate to 0.00020263231395
Epoch: 4 cost time: 2.1783032417297363
Epoch: 4, Steps: 514 | Train Loss: 0.5294678 Vali Loss: 0.3728139 Best vali loss: 0.3589012
	iters: 100, epoch: 5 | loss: 0.7192290
	speed: 0.0077s/iter; left time: 15.0482s
	iters: 200, epoch: 5 | loss: 0.4068543
	speed: 0.0036s/iter; left time: 6.6737s
	iters: 300, epoch: 5 | loss: 0.5911745
	speed: 0.0036s/iter; left time: 6.2581s
	iters: 400, epoch: 5 | loss: 0.4552465
	speed: 0.0036s/iter; left time: 5.9115s
	iters: 500, epoch: 5 | loss: 0.5563498
	speed: 0.0036s/iter; left time: 5.6606s
Updating learning rate to 0.00012508828453953354
Validation loss decreased (0.3589 --> 0.3567).  Saving model state dict ...
Epoch: 5 cost time: 1.8982524871826172
Epoch: 5, Steps: 514 | Train Loss: 0.5457708 Vali Loss: 0.3566871 Best vali loss: 0.3566871
	iters: 100, epoch: 6 | loss: 0.3347299
	speed: 0.0073s/iter; left time: 10.4865s
	iters: 200, epoch: 6 | loss: 0.3107804
	speed: 0.0033s/iter; left time: 4.4136s
	iters: 300, epoch: 6 | loss: 0.4836532
	speed: 0.0032s/iter; left time: 4.0261s
	iters: 400, epoch: 6 | loss: 0.4280339
	speed: 0.0033s/iter; left time: 3.7951s
	iters: 500, epoch: 6 | loss: 0.6518472
	speed: 0.0034s/iter; left time: 3.5109s
Updating learning rate to 5.9349630668433564e-05
Epoch: 6 cost time: 1.7431039810180664
Epoch: 6, Steps: 514 | Train Loss: 0.4418089 Vali Loss: 0.3567338 Best vali loss: 0.3566871
	iters: 100, epoch: 7 | loss: 0.3196586
	speed: 0.0070s/iter; left time: 6.5215s
	iters: 200, epoch: 7 | loss: 0.3267834
	speed: 0.0032s/iter; left time: 2.6584s
	iters: 300, epoch: 7 | loss: 0.3283255
	speed: 0.0032s/iter; left time: 2.2971s
	iters: 400, epoch: 7 | loss: 0.3366291
	speed: 0.0032s/iter; left time: 2.0120s
	iters: 500, epoch: 7 | loss: 0.2810261
	speed: 0.0033s/iter; left time: 1.7250s
Updating learning rate to 1.5424466466193715e-05
Epoch: 7 cost time: 1.6899549961090088
Epoch: 7, Steps: 514 | Train Loss: 0.3184845 Vali Loss: 0.3584918 Best vali loss: 0.3566871
	iters: 100, epoch: 8 | loss: 0.3297301
	speed: 0.0072s/iter; left time: 3.0081s
	iters: 200, epoch: 8 | loss: 0.4304711
	speed: 0.0032s/iter; left time: 1.0165s
	iters: 300, epoch: 8 | loss: 0.2294673
	speed: 0.0032s/iter; left time: 0.6935s
	iters: 400, epoch: 8 | loss: 0.2772670
	speed: 0.0033s/iter; left time: 0.3771s
	iters: 500, epoch: 8 | loss: 0.3603520
	speed: 0.0032s/iter; left time: 0.0481s
Updating learning rate to 0.0
Validation loss decreased (0.3567 --> 0.3553).  Saving model state dict ...
Epoch: 8 cost time: 1.724323034286499
Epoch: 8, Steps: 514 | Train Loss: 0.3254575 Vali Loss: 0.3552549 Best vali loss: 0.3552549

best validation loss 0.3552548649093257

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0053504112651, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.0927326679229736
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687792 Best vali loss: 0.3687792
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3688 --> 0.3658).  Saving model state dict ...
Epoch: 2 cost time: 0.7815287113189697
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3657583 Best vali loss: 0.3657583
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3658 --> 0.3554).  Saving model state dict ...
Epoch: 3 cost time: 0.7778196334838867
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3553715 Best vali loss: 0.3553715
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3554 --> 0.3444).  Saving model state dict ...
Epoch: 4 cost time: 0.7801620960235596
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3444453 Best vali loss: 0.3444453
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7868361473083496
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3455349 Best vali loss: 0.3444453
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3444 --> 0.3426).  Saving model state dict ...
Epoch: 6 cost time: 0.7758505344390869
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3425814 Best vali loss: 0.3425814
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.7796778678894043
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3436965 Best vali loss: 0.3425814
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7827963829040527
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3430113 Best vali loss: 0.3425814

best validation loss 0.34258139831378087

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0027811569427, 'e_layers': 4, 'learning_rate': 0.0043690023424, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7682946
	speed: 0.0115s/iter; left time: 22.4515s
	iters: 200, epoch: 1 | loss: 0.6413867
	speed: 0.0050s/iter; left time: 9.2059s
Updating learning rate to 0.0043690023424
Validation loss decreased (inf --> 0.3873).  Saving model state dict ...
Epoch: 1 cost time: 1.634174108505249
Epoch: 1, Steps: 257 | Train Loss: 0.7048407 Vali Loss: 0.3872896 Best vali loss: 0.3872896
	iters: 100, epoch: 2 | loss: 0.4944934
	speed: 0.0107s/iter; left time: 18.2491s
	iters: 200, epoch: 2 | loss: 0.9380926
	speed: 0.0048s/iter; left time: 7.6349s
Updating learning rate to 0.0021845011712
Validation loss decreased (0.3873 --> 0.3842).  Saving model state dict ...
Epoch: 2 cost time: 1.310856819152832
Epoch: 2, Steps: 257 | Train Loss: 0.7162930 Vali Loss: 0.3841933 Best vali loss: 0.3841933
	iters: 100, epoch: 3 | loss: 0.9537405
	speed: 0.0103s/iter; left time: 14.8346s
	iters: 200, epoch: 3 | loss: 0.4328747
	speed: 0.0053s/iter; left time: 7.1164s
Updating learning rate to 0.0010922505856
Validation loss decreased (0.3842 --> 0.3838).  Saving model state dict ...
Epoch: 3 cost time: 1.3689532279968262
Epoch: 3, Steps: 257 | Train Loss: 0.6933076 Vali Loss: 0.3837530 Best vali loss: 0.3837530
	iters: 100, epoch: 4 | loss: 0.6247297
	speed: 0.0105s/iter; left time: 12.4687s
	iters: 200, epoch: 4 | loss: 0.8023992
	speed: 0.0050s/iter; left time: 5.4684s
Updating learning rate to 0.0005461252928
Validation loss decreased (0.3838 --> 0.3829).  Saving model state dict ...
Epoch: 4 cost time: 1.3128070831298828
Epoch: 4, Steps: 257 | Train Loss: 0.7135644 Vali Loss: 0.3828851 Best vali loss: 0.3828851
	iters: 100, epoch: 5 | loss: 0.5644113
	speed: 0.0104s/iter; left time: 9.6233s
	iters: 200, epoch: 5 | loss: 0.6304696
	speed: 0.0049s/iter; left time: 4.0619s
Updating learning rate to 0.0002730626464
Epoch: 5 cost time: 1.3109288215637207
Epoch: 5, Steps: 257 | Train Loss: 0.5974405 Vali Loss: 0.3885482 Best vali loss: 0.3828851
	iters: 100, epoch: 6 | loss: 0.4633446
	speed: 0.0108s/iter; left time: 7.2562s
	iters: 200, epoch: 6 | loss: 0.4958404
	speed: 0.0053s/iter; left time: 3.0434s
Updating learning rate to 0.0001365313232
Epoch: 6 cost time: 1.404808521270752
Epoch: 6, Steps: 257 | Train Loss: 0.4795925 Vali Loss: 0.3902596 Best vali loss: 0.3828851
	iters: 100, epoch: 7 | loss: 0.5431849
	speed: 0.0110s/iter; left time: 4.5594s
	iters: 200, epoch: 7 | loss: 0.5832469
	speed: 0.0053s/iter; left time: 1.6731s
Updating learning rate to 6.82656616e-05
Epoch: 7 cost time: 1.4027419090270996
Epoch: 7, Steps: 257 | Train Loss: 0.5632159 Vali Loss: 0.3881669 Best vali loss: 0.3828851
	iters: 100, epoch: 8 | loss: 0.7110672
	speed: 0.0110s/iter; left time: 1.7322s
	iters: 200, epoch: 8 | loss: 0.5993184
	speed: 0.0054s/iter; left time: 0.3160s
Updating learning rate to 3.41328308e-05
Epoch: 8 cost time: 1.43398118019104
Epoch: 8, Steps: 257 | Train Loss: 0.6551928 Vali Loss: 0.3910589 Best vali loss: 0.3828851

best validation loss 0.38288506496631797

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0021940661293, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8187746
	speed: 0.0100s/iter; left time: 40.1111s
	iters: 200, epoch: 1 | loss: 0.7403367
	speed: 0.0037s/iter; left time: 14.4421s
	iters: 300, epoch: 1 | loss: 0.8286108
	speed: 0.0037s/iter; left time: 14.1522s
	iters: 400, epoch: 1 | loss: 0.6889401
	speed: 0.0035s/iter; left time: 12.9735s
	iters: 500, epoch: 1 | loss: 0.3251444
	speed: 0.0036s/iter; left time: 12.9135s
Updating learning rate to 0.00039412601865045424
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 2.234853506088257
Epoch: 1, Steps: 514 | Train Loss: 0.6803613 Vali Loss: 0.3673940 Best vali loss: 0.3673940
	iters: 100, epoch: 2 | loss: 0.3272516
	speed: 0.0074s/iter; left time: 25.9314s
	iters: 200, epoch: 2 | loss: 0.3693442
	speed: 0.0033s/iter; left time: 11.1522s
	iters: 300, epoch: 2 | loss: 0.6655555
	speed: 0.0032s/iter; left time: 10.4448s
	iters: 400, epoch: 2 | loss: 0.6591636
	speed: 0.0032s/iter; left time: 10.1187s
	iters: 500, epoch: 2 | loss: 0.8189493
	speed: 0.0032s/iter; left time: 9.8963s
Updating learning rate to 0.00034971794632172426
Epoch: 2 cost time: 1.6941773891448975
Epoch: 2, Steps: 514 | Train Loss: 0.5680529 Vali Loss: 0.3695525 Best vali loss: 0.3673940
	iters: 100, epoch: 3 | loss: 0.4408582
	speed: 0.0072s/iter; left time: 21.4570s
	iters: 200, epoch: 3 | loss: 0.5818679
	speed: 0.0031s/iter; left time: 8.8361s
	iters: 300, epoch: 3 | loss: 0.7345380
	speed: 0.0031s/iter; left time: 8.5557s
	iters: 400, epoch: 3 | loss: 0.2540501
	speed: 0.0031s/iter; left time: 8.3183s
	iters: 500, epoch: 3 | loss: 0.6380058
	speed: 0.0031s/iter; left time: 7.9788s
Updating learning rate to 0.00028325656936568113
Epoch: 3 cost time: 1.6347427368164062
Epoch: 3, Steps: 514 | Train Loss: 0.5298640 Vali Loss: 0.3691913 Best vali loss: 0.3673940

best validation loss 0.3673939914155334

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0021942973199, 'e_layers': 2, 'learning_rate': 0.0004097216472, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8188092
	speed: 0.0098s/iter; left time: 39.4648s
	iters: 200, epoch: 1 | loss: 0.7402589
	speed: 0.0033s/iter; left time: 12.8318s
	iters: 300, epoch: 1 | loss: 0.8285075
	speed: 0.0031s/iter; left time: 11.8600s
	iters: 400, epoch: 1 | loss: 0.6891260
	speed: 0.0031s/iter; left time: 11.5974s
	iters: 500, epoch: 1 | loss: 0.3251734
	speed: 0.0031s/iter; left time: 11.2589s
Updating learning rate to 0.0003941275455374452
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 2.0052101612091064
Epoch: 1, Steps: 514 | Train Loss: 0.6803750 Vali Loss: 0.3671981 Best vali loss: 0.3671981
	iters: 100, epoch: 2 | loss: 0.3260153
	speed: 0.0072s/iter; left time: 25.0469s
	iters: 200, epoch: 2 | loss: 0.3658574
	speed: 0.0030s/iter; left time: 10.3524s
	iters: 300, epoch: 2 | loss: 0.6642832
	speed: 0.0030s/iter; left time: 9.9190s
	iters: 400, epoch: 2 | loss: 0.6547933
	speed: 0.0030s/iter; left time: 9.7042s
	iters: 500, epoch: 2 | loss: 0.5273993
	speed: 0.0031s/iter; left time: 9.7449s
Updating learning rate to 0.00034971930116702113
Epoch: 2 cost time: 1.6236276626586914
Epoch: 2, Steps: 514 | Train Loss: 0.5076697 Vali Loss: 0.3763918 Best vali loss: 0.3671981
	iters: 100, epoch: 3 | loss: 0.4711484
	speed: 0.0071s/iter; left time: 21.1837s
	iters: 200, epoch: 3 | loss: 0.5690789
	speed: 0.0031s/iter; left time: 9.0090s
	iters: 300, epoch: 3 | loss: 0.6439632
	speed: 0.0032s/iter; left time: 8.8103s
	iters: 400, epoch: 3 | loss: 0.2714338
	speed: 0.0032s/iter; left time: 8.5369s
	iters: 500, epoch: 3 | loss: 0.6512662
	speed: 0.0031s/iter; left time: 8.1396s
Updating learning rate to 0.0002832576667323872
Epoch: 3 cost time: 1.6650481224060059
Epoch: 3, Steps: 514 | Train Loss: 0.5213781 Vali Loss: 0.3737439 Best vali loss: 0.3671981

best validation loss 0.3671980796370853

[INFO][smbo.py:320] Finished 1250 trials.
{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0054971335875, 'e_layers': 4, 'learning_rate': 0.0006708853163, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7152697
	speed: 0.0114s/iter; left time: 45.6294s
	iters: 200, epoch: 1 | loss: 0.8448736
	speed: 0.0051s/iter; left time: 19.8492s
	iters: 300, epoch: 1 | loss: 1.4067706
	speed: 0.0050s/iter; left time: 19.1678s
	iters: 400, epoch: 1 | loss: 0.3149923
	speed: 0.0053s/iter; left time: 19.8265s
	iters: 500, epoch: 1 | loss: 1.0602496
	speed: 0.0054s/iter; left time: 19.3662s
Updating learning rate to 0.0006708853163
Validation loss decreased (inf --> 0.3988).  Saving model state dict ...
Epoch: 1 cost time: 3.011732339859009
Epoch: 1, Steps: 514 | Train Loss: 0.8684312 Vali Loss: 0.3987631 Best vali loss: 0.3987631
	iters: 100, epoch: 2 | loss: 1.0686957
	speed: 0.0107s/iter; left time: 37.3023s
	iters: 200, epoch: 2 | loss: 0.8906136
	speed: 0.0048s/iter; left time: 16.2201s
	iters: 300, epoch: 2 | loss: 0.8961110
	speed: 0.0049s/iter; left time: 16.3063s
	iters: 400, epoch: 2 | loss: 0.8650284
	speed: 0.0051s/iter; left time: 16.2561s
	iters: 500, epoch: 2 | loss: 0.6445138
	speed: 0.0050s/iter; left time: 15.6460s
Updating learning rate to 0.00033544265815
Epoch: 2 cost time: 2.5998647212982178
Epoch: 2, Steps: 514 | Train Loss: 0.8729925 Vali Loss: 0.4039601 Best vali loss: 0.3987631
	iters: 100, epoch: 3 | loss: 0.3210232
	speed: 0.0101s/iter; left time: 30.2165s
	iters: 200, epoch: 3 | loss: 0.6314487
	speed: 0.0052s/iter; left time: 14.8761s
	iters: 300, epoch: 3 | loss: 0.6211203
	speed: 0.0052s/iter; left time: 14.4739s
	iters: 400, epoch: 3 | loss: 1.0179534
	speed: 0.0052s/iter; left time: 13.8526s
	iters: 500, epoch: 3 | loss: 0.4243000
	speed: 0.0050s/iter; left time: 12.9329s
Updating learning rate to 0.000167721329075
Epoch: 3 cost time: 2.6873183250427246
Epoch: 3, Steps: 514 | Train Loss: 0.6031691 Vali Loss: 0.4071037 Best vali loss: 0.3987631

best validation loss 0.39876306306402437

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0021942973199, 'e_layers': 2, 'learning_rate': 0.0004097216472, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5883959
	speed: 0.0098s/iter; left time: 24.2134s
	iters: 200, epoch: 4 | loss: 0.5927463
	speed: 0.0034s/iter; left time: 8.1664s
	iters: 300, epoch: 4 | loss: 0.7668932
	speed: 0.0034s/iter; left time: 7.6355s
	iters: 400, epoch: 4 | loss: 0.7034446
	speed: 0.0034s/iter; left time: 7.3666s
	iters: 500, epoch: 4 | loss: 0.3102460
	speed: 0.0033s/iter; left time: 6.9215s
Updating learning rate to 0.0002048608236
Validation loss decreased (0.3672 --> 0.3528).  Saving model state dict ...
Epoch: 4 cost time: 2.094628095626831
Epoch: 4, Steps: 514 | Train Loss: 0.5923452 Vali Loss: 0.3527519 Best vali loss: 0.3527519
	iters: 100, epoch: 5 | loss: 0.3042140
	speed: 0.0071s/iter; left time: 13.8593s
	iters: 200, epoch: 5 | loss: 0.2670729
	speed: 0.0031s/iter; left time: 5.8410s
	iters: 300, epoch: 5 | loss: 0.5749344
	speed: 0.0030s/iter; left time: 5.3374s
	iters: 400, epoch: 5 | loss: 0.6207655
	speed: 0.0031s/iter; left time: 5.0763s
	iters: 500, epoch: 5 | loss: 0.4695163
	speed: 0.0031s/iter; left time: 4.7923s
Updating learning rate to 0.00012646398046761283
Validation loss decreased (0.3528 --> 0.3523).  Saving model state dict ...
Epoch: 5 cost time: 1.626887559890747
Epoch: 5, Steps: 514 | Train Loss: 0.4473006 Vali Loss: 0.3523009 Best vali loss: 0.3523009
	iters: 100, epoch: 6 | loss: 0.3701229
	speed: 0.0072s/iter; left time: 10.3685s
	iters: 200, epoch: 6 | loss: 0.4932458
	speed: 0.0031s/iter; left time: 4.2065s
	iters: 300, epoch: 6 | loss: 0.4606908
	speed: 0.0032s/iter; left time: 3.9946s
	iters: 400, epoch: 6 | loss: 0.2314112
	speed: 0.0033s/iter; left time: 3.7557s
	iters: 500, epoch: 6 | loss: 0.5682762
	speed: 0.0032s/iter; left time: 3.3423s
Updating learning rate to 6.00023460329789e-05
Epoch: 6 cost time: 1.6934459209442139
Epoch: 6, Steps: 514 | Train Loss: 0.4247494 Vali Loss: 0.3557321 Best vali loss: 0.3523009
	iters: 100, epoch: 7 | loss: 0.1899308
	speed: 0.0068s/iter; left time: 6.3447s
	iters: 200, epoch: 7 | loss: 0.3785219
	speed: 0.0030s/iter; left time: 2.4830s
	iters: 300, epoch: 7 | loss: 0.5161477
	speed: 0.0031s/iter; left time: 2.2449s
	iters: 400, epoch: 7 | loss: 0.4287159
	speed: 0.0031s/iter; left time: 1.9570s
	iters: 500, epoch: 7 | loss: 0.2927642
	speed: 0.0030s/iter; left time: 1.6052s
Updating learning rate to 1.5594101662554822e-05
Epoch: 7 cost time: 1.6100740432739258
Epoch: 7, Steps: 514 | Train Loss: 0.3612161 Vali Loss: 0.3623814 Best vali loss: 0.3523009
	iters: 100, epoch: 8 | loss: 0.3081590
	speed: 0.0065s/iter; left time: 2.7136s
	iters: 200, epoch: 8 | loss: 0.4451469
	speed: 0.0030s/iter; left time: 0.9559s
	iters: 300, epoch: 8 | loss: 0.4769405
	speed: 0.0034s/iter; left time: 0.7349s
	iters: 400, epoch: 8 | loss: 0.6241016
	speed: 0.0032s/iter; left time: 0.3719s
	iters: 500, epoch: 8 | loss: 0.5959476
	speed: 0.0033s/iter; left time: 0.0489s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.677015781402588
Epoch: 8, Steps: 514 | Train Loss: 0.4900591 Vali Loss: 0.3636809 Best vali loss: 0.3523009

best validation loss 0.35230089660829084

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022118283479, 'e_layers': 2, 'learning_rate': 0.0003472139975, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4263392
	speed: 0.0098s/iter; left time: 39.5064s
	iters: 200, epoch: 1 | loss: 1.0761296
	speed: 0.0034s/iter; left time: 13.2704s
	iters: 300, epoch: 1 | loss: 1.0147370
	speed: 0.0034s/iter; left time: 12.9003s
	iters: 400, epoch: 1 | loss: 0.5072827
	speed: 0.0034s/iter; left time: 12.6536s
	iters: 500, epoch: 1 | loss: 1.0905921
	speed: 0.0034s/iter; left time: 12.3901s
Updating learning rate to 0.0003472139975
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 2.1113719940185547
Epoch: 1, Steps: 514 | Train Loss: 0.8230161 Vali Loss: 0.3733310 Best vali loss: 0.3733310
	iters: 100, epoch: 2 | loss: 0.3912280
	speed: 0.0073s/iter; left time: 25.4036s
	iters: 200, epoch: 2 | loss: 0.2870207
	speed: 0.0035s/iter; left time: 11.9686s
	iters: 300, epoch: 2 | loss: 0.4416923
	speed: 0.0036s/iter; left time: 11.7294s
	iters: 400, epoch: 2 | loss: 0.3864893
	speed: 0.0034s/iter; left time: 10.9413s
	iters: 500, epoch: 2 | loss: 0.6318371
	speed: 0.0035s/iter; left time: 10.8430s
Updating learning rate to 0.00017360699875
Validation loss decreased (0.3733 --> 0.3633).  Saving model state dict ...
Epoch: 2 cost time: 1.8308465480804443
Epoch: 2, Steps: 514 | Train Loss: 0.4276535 Vali Loss: 0.3632946 Best vali loss: 0.3632946
	iters: 100, epoch: 3 | loss: 0.3476817
	speed: 0.0072s/iter; left time: 21.4932s
	iters: 200, epoch: 3 | loss: 0.8716981
	speed: 0.0034s/iter; left time: 9.7222s
	iters: 300, epoch: 3 | loss: 0.4957124
	speed: 0.0033s/iter; left time: 9.1649s
	iters: 400, epoch: 3 | loss: 0.4640212
	speed: 0.0035s/iter; left time: 9.3347s
	iters: 500, epoch: 3 | loss: 1.0327952
	speed: 0.0033s/iter; left time: 8.6314s
Updating learning rate to 8.6803499375e-05
Validation loss decreased (0.3633 --> 0.3557).  Saving model state dict ...
Epoch: 3 cost time: 1.7729055881500244
Epoch: 3, Steps: 514 | Train Loss: 0.6423817 Vali Loss: 0.3556976 Best vali loss: 0.3556976
	iters: 100, epoch: 4 | loss: 0.5424817
	speed: 0.0073s/iter; left time: 18.1533s
	iters: 200, epoch: 4 | loss: 0.4366139
	speed: 0.0033s/iter; left time: 7.9323s
	iters: 300, epoch: 4 | loss: 0.5043360
	speed: 0.0035s/iter; left time: 7.9765s
	iters: 400, epoch: 4 | loss: 0.6734875
	speed: 0.0033s/iter; left time: 7.2163s
	iters: 500, epoch: 4 | loss: 0.7091881
	speed: 0.0035s/iter; left time: 7.1943s
Updating learning rate to 4.34017496875e-05
Validation loss decreased (0.3557 --> 0.3431).  Saving model state dict ...
Epoch: 4 cost time: 1.8036847114562988
Epoch: 4, Steps: 514 | Train Loss: 0.5732215 Vali Loss: 0.3430694 Best vali loss: 0.3430694
	iters: 100, epoch: 5 | loss: 0.5406293
	speed: 0.0078s/iter; left time: 15.2554s
	iters: 200, epoch: 5 | loss: 0.7662445
	speed: 0.0036s/iter; left time: 6.6221s
	iters: 300, epoch: 5 | loss: 0.4756392
	speed: 0.0035s/iter; left time: 6.2054s
	iters: 400, epoch: 5 | loss: 0.7898214
	speed: 0.0036s/iter; left time: 5.9045s
	iters: 500, epoch: 5 | loss: 0.5473632
	speed: 0.0035s/iter; left time: 5.4986s
Updating learning rate to 2.170087484375e-05
Epoch: 5 cost time: 1.8615360260009766
Epoch: 5, Steps: 514 | Train Loss: 0.6239395 Vali Loss: 0.3472340 Best vali loss: 0.3430694
	iters: 100, epoch: 6 | loss: 0.2983405
	speed: 0.0076s/iter; left time: 10.9670s
	iters: 200, epoch: 6 | loss: 0.4805950
	speed: 0.0036s/iter; left time: 4.8175s
	iters: 300, epoch: 6 | loss: 0.3683313
	speed: 0.0035s/iter; left time: 4.3477s
	iters: 400, epoch: 6 | loss: 0.7437272
	speed: 0.0034s/iter; left time: 3.9346s
	iters: 500, epoch: 6 | loss: 0.9765869
	speed: 0.0035s/iter; left time: 3.6263s
Updating learning rate to 1.0850437421875e-05
Epoch: 6 cost time: 1.8591396808624268
Epoch: 6, Steps: 514 | Train Loss: 0.5735162 Vali Loss: 0.3458081 Best vali loss: 0.3430694
	iters: 100, epoch: 7 | loss: 0.3902256
	speed: 0.0072s/iter; left time: 6.7165s
	iters: 200, epoch: 7 | loss: 0.2984352
	speed: 0.0035s/iter; left time: 2.8802s
	iters: 300, epoch: 7 | loss: 0.3611589
	speed: 0.0035s/iter; left time: 2.5649s
	iters: 400, epoch: 7 | loss: 0.4130226
	speed: 0.0033s/iter; left time: 2.1013s
	iters: 500, epoch: 7 | loss: 0.8027159
	speed: 0.0035s/iter; left time: 1.8614s
Updating learning rate to 5.4252187109375e-06
Validation loss decreased (0.3431 --> 0.3429).  Saving model state dict ...
Epoch: 7 cost time: 1.8191032409667969
Epoch: 7, Steps: 514 | Train Loss: 0.4531116 Vali Loss: 0.3429222 Best vali loss: 0.3429222
	iters: 100, epoch: 8 | loss: 0.3676225
	speed: 0.0072s/iter; left time: 3.0021s
	iters: 200, epoch: 8 | loss: 0.2238000
	speed: 0.0034s/iter; left time: 1.0596s
	iters: 300, epoch: 8 | loss: 0.3723831
	speed: 0.0033s/iter; left time: 0.7050s
	iters: 400, epoch: 8 | loss: 0.4460014
	speed: 0.0033s/iter; left time: 0.3780s
	iters: 500, epoch: 8 | loss: 0.2519442
	speed: 0.0034s/iter; left time: 0.0503s
Updating learning rate to 2.71260935546875e-06
Epoch: 8 cost time: 1.7580909729003906
Epoch: 8, Steps: 514 | Train Loss: 0.3323502 Vali Loss: 0.3436924 Best vali loss: 0.3429222

best validation loss 0.34292224579452296

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010334660929, 'e_layers': 2, 'learning_rate': 0.0003431221999, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4261044
	speed: 0.0098s/iter; left time: 39.4698s
	iters: 200, epoch: 1 | loss: 1.0753533
	speed: 0.0036s/iter; left time: 13.9599s
	iters: 300, epoch: 1 | loss: 1.0148969
	speed: 0.0036s/iter; left time: 13.6392s
	iters: 400, epoch: 1 | loss: 0.5077984
	speed: 0.0035s/iter; left time: 12.8449s
	iters: 500, epoch: 1 | loss: 1.1443002
	speed: 0.0035s/iter; left time: 12.8112s
Updating learning rate to 0.0003431221999
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 2.1648075580596924
Epoch: 1, Steps: 514 | Train Loss: 0.8336906 Vali Loss: 0.3720926 Best vali loss: 0.3720926
	iters: 100, epoch: 2 | loss: 0.3912885
	speed: 0.0074s/iter; left time: 25.8827s
	iters: 200, epoch: 2 | loss: 0.2721957
	speed: 0.0035s/iter; left time: 11.9768s
	iters: 300, epoch: 2 | loss: 0.4969317
	speed: 0.0035s/iter; left time: 11.6136s
	iters: 400, epoch: 2 | loss: 0.3907655
	speed: 0.0035s/iter; left time: 11.3360s
	iters: 500, epoch: 2 | loss: 0.6093274
	speed: 0.0034s/iter; left time: 10.4214s
Updating learning rate to 0.00017156109995
Epoch: 2 cost time: 1.818509817123413
Epoch: 2, Steps: 514 | Train Loss: 0.4321018 Vali Loss: 0.3822175 Best vali loss: 0.3720926
	iters: 100, epoch: 3 | loss: 0.3768090
	speed: 0.0071s/iter; left time: 21.2595s
	iters: 200, epoch: 3 | loss: 0.8975514
	speed: 0.0034s/iter; left time: 9.7404s
	iters: 300, epoch: 3 | loss: 0.5048950
	speed: 0.0032s/iter; left time: 8.8561s
	iters: 400, epoch: 3 | loss: 0.4637842
	speed: 0.0031s/iter; left time: 8.3473s
	iters: 500, epoch: 3 | loss: 1.1450484
	speed: 0.0031s/iter; left time: 8.0479s
Updating learning rate to 8.5780549975e-05
Epoch: 3 cost time: 1.7177553176879883
Epoch: 3, Steps: 514 | Train Loss: 0.6776176 Vali Loss: 0.3815362 Best vali loss: 0.3720926
	iters: 100, epoch: 4 | loss: 0.5957068
	speed: 0.0067s/iter; left time: 16.6643s
	iters: 200, epoch: 4 | loss: 0.4460899
	speed: 0.0031s/iter; left time: 7.3248s
	iters: 300, epoch: 4 | loss: 0.5140538
	speed: 0.0032s/iter; left time: 7.3761s
	iters: 400, epoch: 4 | loss: 0.6919938
	speed: 0.0031s/iter; left time: 6.7642s
	iters: 500, epoch: 4 | loss: 0.7079319
	speed: 0.0031s/iter; left time: 6.4530s
Updating learning rate to 4.28902749875e-05
Validation loss decreased (0.3721 --> 0.3465).  Saving model state dict ...
Epoch: 4 cost time: 1.650256872177124
Epoch: 4, Steps: 514 | Train Loss: 0.5911553 Vali Loss: 0.3465197 Best vali loss: 0.3465197
	iters: 100, epoch: 5 | loss: 0.5368211
	speed: 0.0070s/iter; left time: 13.6357s
	iters: 200, epoch: 5 | loss: 0.7612491
	speed: 0.0031s/iter; left time: 5.8104s
	iters: 300, epoch: 5 | loss: 0.4865142
	speed: 0.0031s/iter; left time: 5.4338s
	iters: 400, epoch: 5 | loss: 0.8452667
	speed: 0.0030s/iter; left time: 5.0524s
	iters: 500, epoch: 5 | loss: 0.5643023
	speed: 0.0032s/iter; left time: 4.9399s
Updating learning rate to 2.144513749375e-05
Epoch: 5 cost time: 1.6476068496704102
Epoch: 5, Steps: 514 | Train Loss: 0.6388307 Vali Loss: 0.3591716 Best vali loss: 0.3465197
	iters: 100, epoch: 6 | loss: 0.2994537
	speed: 0.0069s/iter; left time: 9.9234s
	iters: 200, epoch: 6 | loss: 0.4705393
	speed: 0.0030s/iter; left time: 4.0706s
	iters: 300, epoch: 6 | loss: 0.3875495
	speed: 0.0031s/iter; left time: 3.8414s
	iters: 400, epoch: 6 | loss: 0.7471069
	speed: 0.0031s/iter; left time: 3.5282s
	iters: 500, epoch: 6 | loss: 1.0021064
	speed: 0.0031s/iter; left time: 3.2289s
Updating learning rate to 1.0722568746875e-05
Epoch: 6 cost time: 1.6279246807098389
Epoch: 6, Steps: 514 | Train Loss: 0.5813511 Vali Loss: 0.3560985 Best vali loss: 0.3465197
	iters: 100, epoch: 7 | loss: 0.3858318
	speed: 0.0068s/iter; left time: 6.2735s
	iters: 200, epoch: 7 | loss: 0.3012749
	speed: 0.0031s/iter; left time: 2.5405s
	iters: 300, epoch: 7 | loss: 0.3677775
	speed: 0.0031s/iter; left time: 2.2525s
	iters: 400, epoch: 7 | loss: 0.4007897
	speed: 0.0031s/iter; left time: 1.9225s
	iters: 500, epoch: 7 | loss: 0.7923802
	speed: 0.0030s/iter; left time: 1.5763s
Updating learning rate to 5.3612843734375e-06
Epoch: 7 cost time: 1.6062495708465576
Epoch: 7, Steps: 514 | Train Loss: 0.4496108 Vali Loss: 0.3531658 Best vali loss: 0.3465197
	iters: 100, epoch: 8 | loss: 0.3542787
	speed: 0.0067s/iter; left time: 2.8003s
	iters: 200, epoch: 8 | loss: 0.2234416
	speed: 0.0033s/iter; left time: 1.0340s
	iters: 300, epoch: 8 | loss: 0.3698667
	speed: 0.0031s/iter; left time: 0.6566s
	iters: 400, epoch: 8 | loss: 0.4547152
	speed: 0.0031s/iter; left time: 0.3553s
	iters: 500, epoch: 8 | loss: 0.2507780
	speed: 0.0031s/iter; left time: 0.0459s
Updating learning rate to 2.68064218671875e-06
Epoch: 8 cost time: 1.6404519081115723
Epoch: 8, Steps: 514 | Train Loss: 0.3306160 Vali Loss: 0.3566037 Best vali loss: 0.3465197

best validation loss 0.34651971509742363

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.005768308508, 'e_layers': 2, 'learning_rate': 0.0003552468667, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4263403
	speed: 0.0096s/iter; left time: 38.7245s
	iters: 200, epoch: 1 | loss: 1.0765586
	speed: 0.0036s/iter; left time: 13.8963s
	iters: 300, epoch: 1 | loss: 1.0160348
	speed: 0.0035s/iter; left time: 13.2276s
	iters: 400, epoch: 1 | loss: 0.5073352
	speed: 0.0035s/iter; left time: 13.1734s
	iters: 500, epoch: 1 | loss: 1.1594381
	speed: 0.0035s/iter; left time: 12.8174s
Updating learning rate to 0.0003552468667
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 2.1662535667419434
Epoch: 1, Steps: 514 | Train Loss: 0.8371414 Vali Loss: 0.3731791 Best vali loss: 0.3731791
	iters: 100, epoch: 2 | loss: 0.3902446
	speed: 0.0075s/iter; left time: 26.3963s
	iters: 200, epoch: 2 | loss: 0.2715619
	speed: 0.0036s/iter; left time: 12.1121s
	iters: 300, epoch: 2 | loss: 0.4552939
	speed: 0.0034s/iter; left time: 11.2512s
	iters: 400, epoch: 2 | loss: 0.3910893
	speed: 0.0033s/iter; left time: 10.5546s
	iters: 500, epoch: 2 | loss: 0.6280839
	speed: 0.0034s/iter; left time: 10.4803s
Updating learning rate to 0.00017762343335
Validation loss decreased (0.3732 --> 0.3542).  Saving model state dict ...
Epoch: 2 cost time: 1.809356927871704
Epoch: 2, Steps: 514 | Train Loss: 0.4272547 Vali Loss: 0.3541664 Best vali loss: 0.3541664
	iters: 100, epoch: 3 | loss: 0.3505643
	speed: 0.0073s/iter; left time: 21.8307s
	iters: 200, epoch: 3 | loss: 0.8598219
	speed: 0.0032s/iter; left time: 9.3572s
	iters: 300, epoch: 3 | loss: 0.5100063
	speed: 0.0032s/iter; left time: 8.8053s
	iters: 400, epoch: 3 | loss: 0.4503049
	speed: 0.0032s/iter; left time: 8.6504s
	iters: 500, epoch: 3 | loss: 1.0398605
	speed: 0.0032s/iter; left time: 8.3190s
Updating learning rate to 8.8811716675e-05
Epoch: 3 cost time: 1.6975677013397217
Epoch: 3, Steps: 514 | Train Loss: 0.6421116 Vali Loss: 0.3577384 Best vali loss: 0.3541664

best validation loss 0.3541664152400667

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0021965854205, 'e_layers': 2, 'learning_rate': 0.0003934707767, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6118751
	speed: 0.0096s/iter; left time: 38.6937s
	iters: 200, epoch: 1 | loss: 0.9496762
	speed: 0.0034s/iter; left time: 13.3999s
	iters: 300, epoch: 1 | loss: 0.8312539
	speed: 0.0033s/iter; left time: 12.6918s
	iters: 400, epoch: 1 | loss: 0.3063167
	speed: 0.0034s/iter; left time: 12.6556s
	iters: 500, epoch: 1 | loss: 0.7141377
	speed: 0.0035s/iter; left time: 12.6690s
Updating learning rate to 0.00037849518696722443
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 2.1225168704986572
Epoch: 1, Steps: 514 | Train Loss: 0.6826519 Vali Loss: 0.3719530 Best vali loss: 0.3719530
	iters: 100, epoch: 2 | loss: 0.4122669
	speed: 0.0073s/iter; left time: 25.5004s
	iters: 200, epoch: 2 | loss: 0.5573145
	speed: 0.0034s/iter; left time: 11.5085s
	iters: 300, epoch: 2 | loss: 1.0335805
	speed: 0.0033s/iter; left time: 10.9954s
	iters: 400, epoch: 2 | loss: 0.3652510
	speed: 0.0036s/iter; left time: 11.5265s
	iters: 500, epoch: 2 | loss: 0.6247186
	speed: 0.0036s/iter; left time: 11.1952s
Updating learning rate to 0.0003358483155516539
Validation loss decreased (0.3720 --> 0.3717).  Saving model state dict ...
Epoch: 2 cost time: 1.8307256698608398
Epoch: 2, Steps: 514 | Train Loss: 0.5986263 Vali Loss: 0.3716950 Best vali loss: 0.3716950
	iters: 100, epoch: 3 | loss: 0.7944913
	speed: 0.0076s/iter; left time: 22.7499s
	iters: 200, epoch: 3 | loss: 0.7365103
	speed: 0.0033s/iter; left time: 9.3833s
	iters: 300, epoch: 3 | loss: 0.6545452
	speed: 0.0032s/iter; left time: 8.9566s
	iters: 400, epoch: 3 | loss: 0.4887513
	speed: 0.0032s/iter; left time: 8.6547s
	iters: 500, epoch: 3 | loss: 0.5999053
	speed: 0.0032s/iter; left time: 8.3570s
Updating learning rate to 0.0002720227620314569
Epoch: 3 cost time: 1.730079174041748
Epoch: 3, Steps: 514 | Train Loss: 0.6548407 Vali Loss: 0.3721166 Best vali loss: 0.3716950

best validation loss 0.37169504488849453

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.006854395317, 'e_layers': 3, 'learning_rate': 0.0002249149277, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6650965
	speed: 0.0111s/iter; left time: 10.3921s
Updating learning rate to 0.00021635461297914293
Validation loss decreased (inf --> 0.3645).  Saving model state dict ...
Epoch: 1 cost time: 0.9997138977050781
Epoch: 1, Steps: 129 | Train Loss: 0.6650965 Vali Loss: 0.3644592 Best vali loss: 0.3644592
	iters: 100, epoch: 2 | loss: 0.6225280
	speed: 0.0083s/iter; left time: 6.6733s
Updating learning rate to 0.00019197689913337602
Validation loss decreased (0.3645 --> 0.3581).  Saving model state dict ...
Epoch: 2 cost time: 0.6842551231384277
Epoch: 2, Steps: 129 | Train Loss: 0.6225280 Vali Loss: 0.3580730 Best vali loss: 0.3580730
	iters: 100, epoch: 3 | loss: 0.5428621
	speed: 0.0084s/iter; left time: 5.6624s
Updating learning rate to 0.00015549307211119103
Epoch: 3 cost time: 0.6845669746398926
Epoch: 3, Steps: 129 | Train Loss: 0.5428621 Vali Loss: 0.3763009 Best vali loss: 0.3580730

best validation loss 0.35807296668850835

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.005768308508, 'e_layers': 2, 'learning_rate': 0.0003552468667, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3665235
	speed: 0.0099s/iter; left time: 24.5415s
	iters: 200, epoch: 4 | loss: 0.9122250
	speed: 0.0034s/iter; left time: 8.1738s
	iters: 300, epoch: 4 | loss: 0.7948231
	speed: 0.0034s/iter; left time: 7.7756s
	iters: 400, epoch: 4 | loss: 0.4994519
	speed: 0.0034s/iter; left time: 7.3970s
	iters: 500, epoch: 4 | loss: 0.4434724
	speed: 0.0035s/iter; left time: 7.2642s
Updating learning rate to 4.44058583375e-05
Validation loss decreased (0.3542 --> 0.3523).  Saving model state dict ...
Epoch: 4 cost time: 2.142488718032837
Epoch: 4, Steps: 514 | Train Loss: 0.6032992 Vali Loss: 0.3523477 Best vali loss: 0.3523477
	iters: 100, epoch: 5 | loss: 0.3915077
	speed: 0.0077s/iter; left time: 14.9855s
	iters: 200, epoch: 5 | loss: 0.2409896
	speed: 0.0035s/iter; left time: 6.4763s
	iters: 300, epoch: 5 | loss: 0.3567601
	speed: 0.0036s/iter; left time: 6.2430s
	iters: 400, epoch: 5 | loss: 0.3774621
	speed: 0.0036s/iter; left time: 5.9519s
	iters: 500, epoch: 5 | loss: 0.5928864
	speed: 0.0036s/iter; left time: 5.5614s
Updating learning rate to 2.220292916875e-05
Validation loss decreased (0.3523 --> 0.3515).  Saving model state dict ...
Epoch: 5 cost time: 1.874110460281372
Epoch: 5, Steps: 514 | Train Loss: 0.3919212 Vali Loss: 0.3514862 Best vali loss: 0.3514862
	iters: 100, epoch: 6 | loss: 0.3143491
	speed: 0.0073s/iter; left time: 10.4931s
	iters: 200, epoch: 6 | loss: 0.7861611
	speed: 0.0031s/iter; left time: 4.1519s
	iters: 300, epoch: 6 | loss: 0.4555956
	speed: 0.0033s/iter; left time: 4.1366s
	iters: 400, epoch: 6 | loss: 0.4343609
	speed: 0.0033s/iter; left time: 3.7485s
	iters: 500, epoch: 6 | loss: 0.9799312
	speed: 0.0032s/iter; left time: 3.3672s
Updating learning rate to 1.1101464584375e-05
Validation loss decreased (0.3515 --> 0.3505).  Saving model state dict ...
Epoch: 6 cost time: 1.7078056335449219
Epoch: 6, Steps: 514 | Train Loss: 0.5940796 Vali Loss: 0.3505070 Best vali loss: 0.3505070
	iters: 100, epoch: 7 | loss: 0.5536548
	speed: 0.0071s/iter; left time: 6.5683s
	iters: 200, epoch: 7 | loss: 0.4319192
	speed: 0.0031s/iter; left time: 2.5644s
	iters: 300, epoch: 7 | loss: 0.4559281
	speed: 0.0031s/iter; left time: 2.2511s
	iters: 400, epoch: 7 | loss: 0.6343850
	speed: 0.0031s/iter; left time: 1.9298s
	iters: 500, epoch: 7 | loss: 0.6729577
	speed: 0.0030s/iter; left time: 1.6109s
Updating learning rate to 5.5507322921875e-06
Validation loss decreased (0.3505 --> 0.3466).  Saving model state dict ...
Epoch: 7 cost time: 1.617508888244629
Epoch: 7, Steps: 514 | Train Loss: 0.5497690 Vali Loss: 0.3465592 Best vali loss: 0.3465592
	iters: 100, epoch: 8 | loss: 0.5241401
	speed: 0.0070s/iter; left time: 2.9208s
	iters: 200, epoch: 8 | loss: 0.7179004
	speed: 0.0031s/iter; left time: 0.9721s
	iters: 300, epoch: 8 | loss: 0.4757384
	speed: 0.0031s/iter; left time: 0.6629s
	iters: 400, epoch: 8 | loss: 0.8025248
	speed: 0.0031s/iter; left time: 0.3554s
	iters: 500, epoch: 8 | loss: 0.5388811
	speed: 0.0031s/iter; left time: 0.0472s
Updating learning rate to 2.77536614609375e-06
Epoch: 8 cost time: 1.63447904586792
Epoch: 8, Steps: 514 | Train Loss: 0.6118369 Vali Loss: 0.3478491 Best vali loss: 0.3465592

best validation loss 0.34655918986015094

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.002139704363, 'e_layers': 2, 'learning_rate': 0.0004080609065, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4271640
	speed: 0.0097s/iter; left time: 39.0096s
	iters: 200, epoch: 1 | loss: 1.0785774
	speed: 0.0034s/iter; left time: 13.3211s
	iters: 300, epoch: 1 | loss: 1.0136195
	speed: 0.0031s/iter; left time: 11.9602s
	iters: 400, epoch: 1 | loss: 0.5036072
	speed: 0.0034s/iter; left time: 12.7017s
	iters: 500, epoch: 1 | loss: 1.1680758
	speed: 0.0034s/iter; left time: 12.2594s
Updating learning rate to 0.0004080609065
Validation loss decreased (inf --> 0.3730).  Saving model state dict ...
Epoch: 1 cost time: 2.0939273834228516
Epoch: 1, Steps: 514 | Train Loss: 0.8382088 Vali Loss: 0.3730288 Best vali loss: 0.3730288
	iters: 100, epoch: 2 | loss: 0.3939770
	speed: 0.0073s/iter; left time: 25.5318s
	iters: 200, epoch: 2 | loss: 0.2724114
	speed: 0.0031s/iter; left time: 10.6650s
	iters: 300, epoch: 2 | loss: 0.4450727
	speed: 0.0032s/iter; left time: 10.4813s
	iters: 400, epoch: 2 | loss: 0.4045128
	speed: 0.0032s/iter; left time: 10.1617s
	iters: 500, epoch: 2 | loss: 0.6290107
	speed: 0.0032s/iter; left time: 10.0491s
Updating learning rate to 0.00020403045325
Validation loss decreased (0.3730 --> 0.3562).  Saving model state dict ...
Epoch: 2 cost time: 1.6854679584503174
Epoch: 2, Steps: 514 | Train Loss: 0.4289969 Vali Loss: 0.3561970 Best vali loss: 0.3561970
	iters: 100, epoch: 3 | loss: 0.3849443
	speed: 0.0070s/iter; left time: 20.8997s
	iters: 200, epoch: 3 | loss: 0.8520597
	speed: 0.0031s/iter; left time: 8.9138s
	iters: 300, epoch: 3 | loss: 0.4923236
	speed: 0.0031s/iter; left time: 8.5637s
	iters: 400, epoch: 3 | loss: 0.4585939
	speed: 0.0030s/iter; left time: 8.0299s
	iters: 500, epoch: 3 | loss: 1.1233917
	speed: 0.0031s/iter; left time: 7.9188s
Updating learning rate to 0.000102015226625
Validation loss decreased (0.3562 --> 0.3451).  Saving model state dict ...
Epoch: 3 cost time: 1.6188061237335205
Epoch: 3, Steps: 514 | Train Loss: 0.6622626 Vali Loss: 0.3451305 Best vali loss: 0.3451305
	iters: 100, epoch: 4 | loss: 0.5625910
	speed: 0.0073s/iter; left time: 17.9303s
	iters: 200, epoch: 4 | loss: 0.4420630
	speed: 0.0031s/iter; left time: 7.4143s
	iters: 300, epoch: 4 | loss: 0.4974745
	speed: 0.0032s/iter; left time: 7.1790s
	iters: 400, epoch: 4 | loss: 0.7044357
	speed: 0.0031s/iter; left time: 6.7337s
	iters: 500, epoch: 4 | loss: 0.7274187
	speed: 0.0031s/iter; left time: 6.3898s
Updating learning rate to 5.10076133125e-05
Epoch: 4 cost time: 1.6487798690795898
Epoch: 4, Steps: 514 | Train Loss: 0.5867966 Vali Loss: 0.3469282 Best vali loss: 0.3451305
	iters: 100, epoch: 5 | loss: 0.5515617
	speed: 0.0070s/iter; left time: 13.6512s
	iters: 200, epoch: 5 | loss: 0.7379999
	speed: 0.0031s/iter; left time: 5.7055s
	iters: 300, epoch: 5 | loss: 0.4721994
	speed: 0.0031s/iter; left time: 5.5033s
	iters: 400, epoch: 5 | loss: 0.8124396
	speed: 0.0032s/iter; left time: 5.3531s
	iters: 500, epoch: 5 | loss: 0.5584293
	speed: 0.0031s/iter; left time: 4.8455s
Updating learning rate to 2.550380665625e-05
Epoch: 5 cost time: 1.6461482048034668
Epoch: 5, Steps: 514 | Train Loss: 0.6265260 Vali Loss: 0.3487094 Best vali loss: 0.3451305
	iters: 100, epoch: 6 | loss: 0.3026710
	speed: 0.0071s/iter; left time: 10.2625s
	iters: 200, epoch: 6 | loss: 0.4635954
	speed: 0.0030s/iter; left time: 4.0774s
	iters: 300, epoch: 6 | loss: 0.3634010
	speed: 0.0031s/iter; left time: 3.9107s
	iters: 400, epoch: 6 | loss: 0.7429886
	speed: 0.0032s/iter; left time: 3.6066s
	iters: 500, epoch: 6 | loss: 0.9538229
	speed: 0.0031s/iter; left time: 3.2846s
Updating learning rate to 1.2751903328125e-05
Validation loss decreased (0.3451 --> 0.3439).  Saving model state dict ...
Epoch: 6 cost time: 1.6628479957580566
Epoch: 6, Steps: 514 | Train Loss: 0.5652958 Vali Loss: 0.3439013 Best vali loss: 0.3439013
	iters: 100, epoch: 7 | loss: 0.3910422
	speed: 0.0076s/iter; left time: 7.0966s
	iters: 200, epoch: 7 | loss: 0.3000315
	speed: 0.0035s/iter; left time: 2.8951s
	iters: 300, epoch: 7 | loss: 0.3618730
	speed: 0.0035s/iter; left time: 2.5577s
	iters: 400, epoch: 7 | loss: 0.3924264
	speed: 0.0036s/iter; left time: 2.2755s
	iters: 500, epoch: 7 | loss: 0.8014181
	speed: 0.0036s/iter; left time: 1.9299s
Updating learning rate to 6.3759516640625e-06
Validation loss decreased (0.3439 --> 0.3431).  Saving model state dict ...
Epoch: 7 cost time: 1.88447904586792
Epoch: 7, Steps: 514 | Train Loss: 0.4493582 Vali Loss: 0.3431483 Best vali loss: 0.3431483
	iters: 100, epoch: 8 | loss: 0.3534139
	speed: 0.0077s/iter; left time: 3.1893s
	iters: 200, epoch: 8 | loss: 0.2300723
	speed: 0.0033s/iter; left time: 1.0450s
	iters: 300, epoch: 8 | loss: 0.3520518
	speed: 0.0033s/iter; left time: 0.7108s
	iters: 400, epoch: 8 | loss: 0.4309956
	speed: 0.0033s/iter; left time: 0.3801s
	iters: 500, epoch: 8 | loss: 0.2320126
	speed: 0.0033s/iter; left time: 0.0492s
Updating learning rate to 3.18797583203125e-06
Epoch: 8 cost time: 1.7448139190673828
Epoch: 8, Steps: 514 | Train Loss: 0.3197092 Vali Loss: 0.3440129 Best vali loss: 0.3431483

best validation loss 0.34314832696453296

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021954548949, 'e_layers': 2, 'learning_rate': 0.0004118915113, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4272459
	speed: 0.0097s/iter; left time: 38.8074s
	iters: 200, epoch: 1 | loss: 1.0790576
	speed: 0.0034s/iter; left time: 13.2903s
	iters: 300, epoch: 1 | loss: 1.0147336
	speed: 0.0033s/iter; left time: 12.7087s
	iters: 400, epoch: 1 | loss: 0.5047199
	speed: 0.0034s/iter; left time: 12.5972s
	iters: 500, epoch: 1 | loss: 1.1420043
	speed: 0.0035s/iter; left time: 12.7353s
Updating learning rate to 0.0003962148241026057
Validation loss decreased (inf --> 0.3746).  Saving model state dict ...
Epoch: 1 cost time: 2.128671169281006
Epoch: 1, Steps: 514 | Train Loss: 0.8335522 Vali Loss: 0.3745694 Best vali loss: 0.3745694
	iters: 100, epoch: 2 | loss: 0.3900384
	speed: 0.0074s/iter; left time: 25.9671s
	iters: 200, epoch: 2 | loss: 0.2627130
	speed: 0.0033s/iter; left time: 11.1606s
	iters: 300, epoch: 2 | loss: 0.4212808
	speed: 0.0033s/iter; left time: 10.7908s
	iters: 400, epoch: 2 | loss: 0.3880362
	speed: 0.0033s/iter; left time: 10.4465s
	iters: 500, epoch: 2 | loss: 0.6619265
	speed: 0.0032s/iter; left time: 9.8731s
Updating learning rate to 0.0003515713960267027
Validation loss decreased (0.3746 --> 0.3601).  Saving model state dict ...
Epoch: 2 cost time: 1.724548578262329
Epoch: 2, Steps: 514 | Train Loss: 0.4247990 Vali Loss: 0.3600865 Best vali loss: 0.3600865
	iters: 100, epoch: 3 | loss: 0.3500105
	speed: 0.0075s/iter; left time: 22.2953s
	iters: 200, epoch: 3 | loss: 0.8947496
	speed: 0.0030s/iter; left time: 8.7973s
	iters: 300, epoch: 3 | loss: 0.5121804
	speed: 0.0031s/iter; left time: 8.5793s
	iters: 400, epoch: 3 | loss: 0.4967238
	speed: 0.0030s/iter; left time: 8.1846s
	iters: 500, epoch: 3 | loss: 1.1175524
	speed: 0.0030s/iter; left time: 7.8414s
Updating learning rate to 0.0002847577843031641
Validation loss decreased (0.3601 --> 0.3447).  Saving model state dict ...
Epoch: 3 cost time: 1.6328210830688477
Epoch: 3, Steps: 514 | Train Loss: 0.6742434 Vali Loss: 0.3447306 Best vali loss: 0.3447306
	iters: 100, epoch: 4 | loss: 0.5599161
	speed: 0.0070s/iter; left time: 17.2249s
	iters: 200, epoch: 4 | loss: 0.4567633
	speed: 0.0031s/iter; left time: 7.3492s
	iters: 300, epoch: 4 | loss: 0.5011169
	speed: 0.0031s/iter; left time: 7.0152s
	iters: 400, epoch: 4 | loss: 0.7083322
	speed: 0.0030s/iter; left time: 6.5782s
	iters: 500, epoch: 4 | loss: 0.7318597
	speed: 0.0031s/iter; left time: 6.3608s
Updating learning rate to 0.00020594575565
Validation loss decreased (0.3447 --> 0.3442).  Saving model state dict ...
Epoch: 4 cost time: 1.618455410003662
Epoch: 4, Steps: 514 | Train Loss: 0.5915976 Vali Loss: 0.3441561 Best vali loss: 0.3441561
	iters: 100, epoch: 5 | loss: 0.5481338
	speed: 0.0076s/iter; left time: 14.9465s
	iters: 200, epoch: 5 | loss: 0.7500427
	speed: 0.0034s/iter; left time: 6.3986s
	iters: 300, epoch: 5 | loss: 0.4890058
	speed: 0.0036s/iter; left time: 6.2441s
	iters: 400, epoch: 5 | loss: 0.7631071
	speed: 0.0034s/iter; left time: 5.6375s
	iters: 500, epoch: 5 | loss: 0.5288416
	speed: 0.0034s/iter; left time: 5.2993s
Updating learning rate to 0.00012713372699683595
Validation loss decreased (0.3442 --> 0.3421).  Saving model state dict ...
Epoch: 5 cost time: 1.8222129344940186
Epoch: 5, Steps: 514 | Train Loss: 0.6158262 Vali Loss: 0.3420846 Best vali loss: 0.3420846
	iters: 100, epoch: 6 | loss: 0.2969956
	speed: 0.0077s/iter; left time: 11.1341s
	iters: 200, epoch: 6 | loss: 0.4539689
	speed: 0.0034s/iter; left time: 4.6000s
	iters: 300, epoch: 6 | loss: 0.3301685
	speed: 0.0036s/iter; left time: 4.4409s
	iters: 400, epoch: 6 | loss: 0.7370992
	speed: 0.0037s/iter; left time: 4.2619s
	iters: 500, epoch: 6 | loss: 0.8772811
	speed: 0.0037s/iter; left time: 3.8889s
Updating learning rate to 6.032011527329728e-05
Epoch: 6 cost time: 1.9005064964294434
Epoch: 6, Steps: 514 | Train Loss: 0.5391027 Vali Loss: 0.3501313 Best vali loss: 0.3420846
	iters: 100, epoch: 7 | loss: 0.3870777
	speed: 0.0074s/iter; left time: 6.8449s
	iters: 200, epoch: 7 | loss: 0.2882101
	speed: 0.0035s/iter; left time: 2.8689s
	iters: 300, epoch: 7 | loss: 0.3314552
	speed: 0.0035s/iter; left time: 2.5691s
	iters: 400, epoch: 7 | loss: 0.3575678
	speed: 0.0034s/iter; left time: 2.1203s
	iters: 500, epoch: 7 | loss: 0.7076423
	speed: 0.0034s/iter; left time: 1.7858s
Updating learning rate to 1.567668719739431e-05
Epoch: 7 cost time: 1.80293607711792
Epoch: 7, Steps: 514 | Train Loss: 0.4143906 Vali Loss: 0.3509441 Best vali loss: 0.3420846
	iters: 100, epoch: 8 | loss: 0.3306512
	speed: 0.0072s/iter; left time: 2.9712s
	iters: 200, epoch: 8 | loss: 0.2245926
	speed: 0.0033s/iter; left time: 1.0322s
	iters: 300, epoch: 8 | loss: 0.3219591
	speed: 0.0033s/iter; left time: 0.7081s
	iters: 400, epoch: 8 | loss: 0.3974029
	speed: 0.0036s/iter; left time: 0.4102s
	iters: 500, epoch: 8 | loss: 0.2137660
	speed: 0.0035s/iter; left time: 0.0519s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7827744483947754
Epoch: 8, Steps: 514 | Train Loss: 0.2976743 Vali Loss: 0.3548128 Best vali loss: 0.3420846

best validation loss 0.34208461746485624

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0051247843336, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.0915415287017822
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3689786 Best vali loss: 0.3689786
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3690 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 0.7732279300689697
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3662782 Best vali loss: 0.3662782
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3663 --> 0.3538).  Saving model state dict ...
Epoch: 3 cost time: 0.7713844776153564
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3537871 Best vali loss: 0.3537871

best validation loss 0.35378708169596135

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.005992553568, 'e_layers': 2, 'learning_rate': 0.000382835603, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4264766
	speed: 0.0097s/iter; left time: 38.9574s
	iters: 200, epoch: 1 | loss: 1.0778652
	speed: 0.0035s/iter; left time: 13.5576s
	iters: 300, epoch: 1 | loss: 1.0159665
	speed: 0.0033s/iter; left time: 12.6307s
	iters: 400, epoch: 1 | loss: 0.5047503
	speed: 0.0033s/iter; left time: 12.2687s
	iters: 500, epoch: 1 | loss: 1.1749414
	speed: 0.0033s/iter; left time: 11.9336s
Updating learning rate to 0.000382835603
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 2.0884218215942383
Epoch: 1, Steps: 514 | Train Loss: 0.8400000 Vali Loss: 0.3727658 Best vali loss: 0.3727658
	iters: 100, epoch: 2 | loss: 0.3850873
	speed: 0.0074s/iter; left time: 25.7574s
	iters: 200, epoch: 2 | loss: 0.3185527
	speed: 0.0031s/iter; left time: 10.5412s
	iters: 300, epoch: 2 | loss: 0.4449924
	speed: 0.0032s/iter; left time: 10.4099s
	iters: 400, epoch: 2 | loss: 0.3919868
	speed: 0.0032s/iter; left time: 10.2311s
	iters: 500, epoch: 2 | loss: 0.6047554
	speed: 0.0033s/iter; left time: 10.2829s
Updating learning rate to 0.0001914178015
Epoch: 2 cost time: 1.7001113891601562
Epoch: 2, Steps: 514 | Train Loss: 0.4290749 Vali Loss: 0.3857442 Best vali loss: 0.3727658
	iters: 100, epoch: 3 | loss: 0.3460095
	speed: 0.0074s/iter; left time: 22.0691s
	iters: 200, epoch: 3 | loss: 0.8879174
	speed: 0.0036s/iter; left time: 10.3336s
	iters: 300, epoch: 3 | loss: 0.4888528
	speed: 0.0033s/iter; left time: 9.2844s
	iters: 400, epoch: 3 | loss: 0.4531324
	speed: 0.0034s/iter; left time: 9.2008s
	iters: 500, epoch: 3 | loss: 1.0561779
	speed: 0.0035s/iter; left time: 8.9222s
Updating learning rate to 9.570890075e-05
Validation loss decreased (0.3728 --> 0.3557).  Saving model state dict ...
Epoch: 3 cost time: 1.831315040588379
Epoch: 3, Steps: 514 | Train Loss: 0.6464180 Vali Loss: 0.3556507 Best vali loss: 0.3556507

best validation loss 0.35565071103615004

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0102068643175, 'e_layers': 1, 'learning_rate': 0.0001850474421, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9328345
	speed: 0.0082s/iter; left time: 66.1962s
	iters: 200, epoch: 1 | loss: 0.2550727
	speed: 0.0023s/iter; left time: 18.7286s
	iters: 300, epoch: 1 | loss: 0.3228074
	speed: 0.0024s/iter; left time: 18.9142s
	iters: 400, epoch: 1 | loss: 0.5723689
	speed: 0.0024s/iter; left time: 18.5125s
	iters: 500, epoch: 1 | loss: 1.4442786
	speed: 0.0024s/iter; left time: 18.2233s
	iters: 600, epoch: 1 | loss: 0.5636666
	speed: 0.0023s/iter; left time: 17.7720s
	iters: 700, epoch: 1 | loss: 0.5699596
	speed: 0.0023s/iter; left time: 17.1220s
	iters: 800, epoch: 1 | loss: 0.3188804
	speed: 0.0023s/iter; left time: 16.8338s
	iters: 900, epoch: 1 | loss: 0.2719368
	speed: 0.0022s/iter; left time: 16.3430s
	iters: 1000, epoch: 1 | loss: 0.4487211
	speed: 0.0023s/iter; left time: 16.5644s
Updating learning rate to 0.0001850474421
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 2.7158145904541016
Epoch: 1, Steps: 1027 | Train Loss: 0.5700527 Vali Loss: 0.3681851 Best vali loss: 0.3681851
	iters: 100, epoch: 2 | loss: 0.7177684
	speed: 0.0076s/iter; left time: 53.5310s
	iters: 200, epoch: 2 | loss: 0.2761749
	speed: 0.0023s/iter; left time: 16.4122s
	iters: 300, epoch: 2 | loss: 0.2659287
	speed: 0.0024s/iter; left time: 16.2595s
	iters: 400, epoch: 2 | loss: 1.5521799
	speed: 0.0023s/iter; left time: 15.9475s
	iters: 500, epoch: 2 | loss: 0.3444989
	speed: 0.0023s/iter; left time: 15.6547s
	iters: 600, epoch: 2 | loss: 0.4256472
	speed: 0.0024s/iter; left time: 15.4901s
	iters: 700, epoch: 2 | loss: 0.3803088
	speed: 0.0023s/iter; left time: 15.2104s
	iters: 800, epoch: 2 | loss: 0.4062043
	speed: 0.0024s/iter; left time: 15.3556s
	iters: 900, epoch: 2 | loss: 1.1765862
	speed: 0.0024s/iter; left time: 15.3015s
	iters: 1000, epoch: 2 | loss: 0.8649462
	speed: 0.0023s/iter; left time: 14.5401s
Updating learning rate to 9.252372105e-05
Validation loss decreased (0.3682 --> 0.3681).  Saving model state dict ...
Epoch: 2 cost time: 2.4654765129089355
Epoch: 2, Steps: 1027 | Train Loss: 0.6410243 Vali Loss: 0.3680619 Best vali loss: 0.3680619
	iters: 100, epoch: 3 | loss: 0.3690912
	speed: 0.0074s/iter; left time: 44.9043s
	iters: 200, epoch: 3 | loss: 0.5755127
	speed: 0.0024s/iter; left time: 14.0592s
	iters: 300, epoch: 3 | loss: 0.4553068
	speed: 0.0024s/iter; left time: 13.7956s
	iters: 400, epoch: 3 | loss: 0.8667372
	speed: 0.0024s/iter; left time: 13.7106s
	iters: 500, epoch: 3 | loss: 0.5537453
	speed: 0.0024s/iter; left time: 13.5295s
	iters: 600, epoch: 3 | loss: 0.3337535
	speed: 0.0024s/iter; left time: 13.2494s
	iters: 700, epoch: 3 | loss: 0.2915070
	speed: 0.0024s/iter; left time: 13.0472s
	iters: 800, epoch: 3 | loss: 0.2665895
	speed: 0.0024s/iter; left time: 12.7436s
	iters: 900, epoch: 3 | loss: 0.3861653
	speed: 0.0024s/iter; left time: 12.5463s
	iters: 1000, epoch: 3 | loss: 0.3311498
	speed: 0.0024s/iter; left time: 12.2961s
Updating learning rate to 4.6261860525e-05
Validation loss decreased (0.3681 --> 0.3670).  Saving model state dict ...
Epoch: 3 cost time: 2.4819295406341553
Epoch: 3, Steps: 1027 | Train Loss: 0.4429558 Vali Loss: 0.3669647 Best vali loss: 0.3669647

best validation loss 0.3669647024574823

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0051247843336, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Epoch: 4 cost time: 1.107379674911499
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3543520 Best vali loss: 0.3537871
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3538 --> 0.3521).  Saving model state dict ...
Epoch: 5 cost time: 0.769324541091919
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3521313 Best vali loss: 0.3521313
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3521 --> 0.3473).  Saving model state dict ...
Epoch: 6 cost time: 0.7706058025360107
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3472917 Best vali loss: 0.3472917
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3473 --> 0.3449).  Saving model state dict ...
Epoch: 7 cost time: 0.7805459499359131
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3449039 Best vali loss: 0.3449039
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7734260559082031
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3458226 Best vali loss: 0.3449039

best validation loss 0.34490386200794304

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0050956777046, 'e_layers': 4, 'learning_rate': 0.00083234124, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00083234124
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 0.7842612266540527
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3733856 Best vali loss: 0.3733856
Updating learning rate to 0.00041617062
Epoch: 2 cost time: 0.5069198608398438
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3757483 Best vali loss: 0.3733856
Updating learning rate to 0.00020808531
Validation loss decreased (0.3734 --> 0.3516).  Saving model state dict ...
Epoch: 3 cost time: 0.4931497573852539
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3516413 Best vali loss: 0.3516413
Updating learning rate to 0.000104042655
Epoch: 4 cost time: 0.4796786308288574
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3529365 Best vali loss: 0.3516413
Updating learning rate to 5.20213275e-05
Validation loss decreased (0.3516 --> 0.3513).  Saving model state dict ...
Epoch: 5 cost time: 0.49854397773742676
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3513097 Best vali loss: 0.3513097
Updating learning rate to 2.601066375e-05
Epoch: 6 cost time: 0.48694944381713867
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3518202 Best vali loss: 0.3513097
Updating learning rate to 1.3005331875e-05
Validation loss decreased (0.3513 --> 0.3508).  Saving model state dict ...
Epoch: 7 cost time: 0.47670936584472656
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3507759 Best vali loss: 0.3507759
Updating learning rate to 6.5026659375e-06
Epoch: 8 cost time: 0.48233890533447266
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3512538 Best vali loss: 0.3507759

best validation loss 0.3507759268133954

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022522625422, 'e_layers': 4, 'learning_rate': 0.0004252904901, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6133404
	speed: 0.0118s/iter; left time: 23.0346s
	iters: 200, epoch: 1 | loss: 1.0239828
	speed: 0.0055s/iter; left time: 10.2402s
Updating learning rate to 0.0004252904901
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.7713990211486816
Epoch: 1, Steps: 257 | Train Loss: 0.8186616 Vali Loss: 0.3654564 Best vali loss: 0.3654564
	iters: 100, epoch: 2 | loss: 0.5898929
	speed: 0.0116s/iter; left time: 19.7321s
	iters: 200, epoch: 2 | loss: 0.5498243
	speed: 0.0054s/iter; left time: 8.6163s
Updating learning rate to 0.00021264524505
Validation loss decreased (0.3655 --> 0.3629).  Saving model state dict ...
Epoch: 2 cost time: 1.4445340633392334
Epoch: 2, Steps: 257 | Train Loss: 0.5698586 Vali Loss: 0.3628758 Best vali loss: 0.3628758
	iters: 100, epoch: 3 | loss: 0.8549706
	speed: 0.0110s/iter; left time: 15.8888s
	iters: 200, epoch: 3 | loss: 0.7812850
	speed: 0.0049s/iter; left time: 6.5453s
Updating learning rate to 0.000106322622525
Validation loss decreased (0.3629 --> 0.3520).  Saving model state dict ...
Epoch: 3 cost time: 1.2905993461608887
Epoch: 3, Steps: 257 | Train Loss: 0.8181278 Vali Loss: 0.3519732 Best vali loss: 0.3519732
	iters: 100, epoch: 4 | loss: 0.6442757
	speed: 0.0107s/iter; left time: 12.6555s
	iters: 200, epoch: 4 | loss: 0.2808716
	speed: 0.0050s/iter; left time: 5.4610s
Updating learning rate to 5.31613112625e-05
Validation loss decreased (0.3520 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 1.3372220993041992
Epoch: 4, Steps: 257 | Train Loss: 0.4625736 Vali Loss: 0.3513423 Best vali loss: 0.3513423
	iters: 100, epoch: 5 | loss: 0.6247588
	speed: 0.0108s/iter; left time: 10.0310s
	iters: 200, epoch: 5 | loss: 0.7259124
	speed: 0.0050s/iter; left time: 4.1533s
Updating learning rate to 2.658065563125e-05
Validation loss decreased (0.3513 --> 0.3493).  Saving model state dict ...
Epoch: 5 cost time: 1.3277778625488281
Epoch: 5, Steps: 257 | Train Loss: 0.6753356 Vali Loss: 0.3492908 Best vali loss: 0.3492908
	iters: 100, epoch: 6 | loss: 0.3776715
	speed: 0.0103s/iter; left time: 6.9303s
	iters: 200, epoch: 6 | loss: 0.2853454
	speed: 0.0047s/iter; left time: 2.7119s
Updating learning rate to 1.3290327815625e-05
Epoch: 6 cost time: 1.2655463218688965
Epoch: 6, Steps: 257 | Train Loss: 0.3315085 Vali Loss: 0.3494308 Best vali loss: 0.3492908
	iters: 100, epoch: 7 | loss: 0.5786185
	speed: 0.0104s/iter; left time: 4.2976s
	iters: 200, epoch: 7 | loss: 0.4092194
	speed: 0.0049s/iter; left time: 1.5422s
Updating learning rate to 6.6451639078125e-06
Epoch: 7 cost time: 1.310002088546753
Epoch: 7, Steps: 257 | Train Loss: 0.4939189 Vali Loss: 0.3504026 Best vali loss: 0.3492908
	iters: 100, epoch: 8 | loss: 0.5939053
	speed: 0.0103s/iter; left time: 1.6330s
	iters: 200, epoch: 8 | loss: 0.5907668
	speed: 0.0048s/iter; left time: 0.2783s
Updating learning rate to 3.32258195390625e-06
Validation loss decreased (0.3493 --> 0.3473).  Saving model state dict ...
Epoch: 8 cost time: 1.2963356971740723
Epoch: 8, Steps: 257 | Train Loss: 0.5923361 Vali Loss: 0.3472555 Best vali loss: 0.3472555

best validation loss 0.34725549318233034

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021379255036, 'e_layers': 2, 'learning_rate': 0.0004085053469, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3588843
	speed: 0.0101s/iter; left time: 19.8325s
	iters: 200, epoch: 1 | loss: 0.9099543
	speed: 0.0038s/iter; left time: 7.0354s
Updating learning rate to 0.00039295753791116655
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 1.324138879776001
Epoch: 1, Steps: 257 | Train Loss: 0.6344193 Vali Loss: 0.3734540 Best vali loss: 0.3734540
	iters: 100, epoch: 2 | loss: 0.6894898
	speed: 0.0084s/iter; left time: 14.2550s
	iters: 200, epoch: 2 | loss: 0.4672727
	speed: 0.0037s/iter; left time: 5.9074s
Updating learning rate to 0.0003486811239219765
Epoch: 2 cost time: 1.0104773044586182
Epoch: 2, Steps: 257 | Train Loss: 0.5783813 Vali Loss: 0.3765432 Best vali loss: 0.3734540
	iters: 100, epoch: 3 | loss: 0.4245401
	speed: 0.0081s/iter; left time: 11.6519s
	iters: 200, epoch: 3 | loss: 0.4597773
	speed: 0.0035s/iter; left time: 4.6547s
Updating learning rate to 0.0002824167875955919
Validation loss decreased (0.3735 --> 0.3670).  Saving model state dict ...
Epoch: 3 cost time: 0.9491641521453857
Epoch: 3, Steps: 257 | Train Loss: 0.4421587 Vali Loss: 0.3670351 Best vali loss: 0.3670351

best validation loss 0.367035118430443

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8178985
	speed: 0.0099s/iter; left time: 19.4690s
	iters: 200, epoch: 1 | loss: 0.5296841
	speed: 0.0037s/iter; left time: 6.8369s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3613).  Saving model state dict ...
Epoch: 1 cost time: 1.3045449256896973
Epoch: 1, Steps: 257 | Train Loss: 0.6737913 Vali Loss: 0.3613018 Best vali loss: 0.3613018
	iters: 100, epoch: 2 | loss: 0.3441889
	speed: 0.0081s/iter; left time: 13.7185s
	iters: 200, epoch: 2 | loss: 0.4628219
	speed: 0.0037s/iter; left time: 5.8871s
Updating learning rate to 0.0001911554003
Epoch: 2 cost time: 0.9883887767791748
Epoch: 2, Steps: 257 | Train Loss: 0.4035054 Vali Loss: 0.3744272 Best vali loss: 0.3613018
	iters: 100, epoch: 3 | loss: 0.6445245
	speed: 0.0080s/iter; left time: 11.6146s
	iters: 200, epoch: 3 | loss: 0.3986569
	speed: 0.0036s/iter; left time: 4.7681s
Updating learning rate to 9.557770015e-05
Epoch: 3 cost time: 0.9610352516174316
Epoch: 3, Steps: 257 | Train Loss: 0.5215907 Vali Loss: 0.3725505 Best vali loss: 0.3613018

best validation loss 0.36130180529854855

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0048502680245, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 1.111398696899414
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3713143 Best vali loss: 0.3713143
Updating learning rate to 0.00033590954375
Epoch: 2 cost time: 0.790565013885498
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3713367 Best vali loss: 0.3713143
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3713 --> 0.3458).  Saving model state dict ...
Epoch: 3 cost time: 0.7965941429138184
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3457948 Best vali loss: 0.3457948

best validation loss 0.34579477280905296

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0048502680245, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3458 --> 0.3398).  Saving model state dict ...
Epoch: 4 cost time: 1.1035654544830322
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3397543 Best vali loss: 0.3397543
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7927639484405518
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3434247 Best vali loss: 0.3397543
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.7945621013641357
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3416002 Best vali loss: 0.3397543
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.7869668006896973
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3410797 Best vali loss: 0.3397543
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7946681976318359
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3438284 Best vali loss: 0.3397543

best validation loss 0.3397542512018695

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0049228667319, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.1128997802734375
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708796 Best vali loss: 0.3708796
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3709 --> 0.3619).  Saving model state dict ...
Epoch: 2 cost time: 0.7911818027496338
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3618585 Best vali loss: 0.3618585
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3619 --> 0.3506).  Saving model state dict ...
Epoch: 3 cost time: 0.7908117771148682
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3506216 Best vali loss: 0.3506216
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3506 --> 0.3475).  Saving model state dict ...
Epoch: 4 cost time: 0.7860016822814941
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3475120 Best vali loss: 0.3475120
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7941527366638184
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3507070 Best vali loss: 0.3475120
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.789520263671875
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3521153 Best vali loss: 0.3475120
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.7845375537872314
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3531269 Best vali loss: 0.3475120
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7916679382324219
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3536326 Best vali loss: 0.3475120

best validation loss 0.3475119943234682

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004113922021, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6105983
	speed: 0.0098s/iter; left time: 39.3059s
	iters: 200, epoch: 1 | loss: 0.9490002
	speed: 0.0031s/iter; left time: 12.1388s
	iters: 300, epoch: 1 | loss: 0.8353899
	speed: 0.0031s/iter; left time: 11.6986s
	iters: 400, epoch: 1 | loss: 0.3086878
	speed: 0.0030s/iter; left time: 11.1794s
	iters: 500, epoch: 1 | loss: 0.7117230
	speed: 0.0030s/iter; left time: 10.7454s
Updating learning rate to 0.0003957345187274684
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.9565815925598145
Epoch: 1, Steps: 514 | Train Loss: 0.6830798 Vali Loss: 0.3707003 Best vali loss: 0.3707003
	iters: 100, epoch: 2 | loss: 0.4153599
	speed: 0.0069s/iter; left time: 24.2675s
	iters: 200, epoch: 2 | loss: 0.5575985
	speed: 0.0030s/iter; left time: 10.2496s
	iters: 300, epoch: 2 | loss: 1.0147623
	speed: 0.0030s/iter; left time: 10.0355s
	iters: 400, epoch: 2 | loss: 0.3586312
	speed: 0.0031s/iter; left time: 9.9844s
	iters: 500, epoch: 2 | loss: 0.6112491
	speed: 0.0031s/iter; left time: 9.4886s
Updating learning rate to 0.0003511452089660883
Epoch: 2 cost time: 1.6210837364196777
Epoch: 2, Steps: 514 | Train Loss: 0.5915202 Vali Loss: 0.3716443 Best vali loss: 0.3707003
	iters: 100, epoch: 3 | loss: 0.8780131
	speed: 0.0072s/iter; left time: 21.3725s
	iters: 200, epoch: 3 | loss: 0.6945962
	speed: 0.0030s/iter; left time: 8.7749s
	iters: 300, epoch: 3 | loss: 0.6649845
	speed: 0.0031s/iter; left time: 8.5666s
	iters: 400, epoch: 3 | loss: 0.5146112
	speed: 0.0029s/iter; left time: 7.8755s
	iters: 500, epoch: 3 | loss: 0.6285115
	speed: 0.0032s/iter; left time: 8.2711s
Updating learning rate to 0.00028441259102393037
Epoch: 3 cost time: 1.6188504695892334
Epoch: 3, Steps: 514 | Train Loss: 0.6761433 Vali Loss: 0.3842672 Best vali loss: 0.3707003
	iters: 100, epoch: 4 | loss: 0.2349848
	speed: 0.0068s/iter; left time: 16.8109s
	iters: 200, epoch: 4 | loss: 0.1873191
	speed: 0.0031s/iter; left time: 7.3796s
	iters: 300, epoch: 4 | loss: 0.6834545
	speed: 0.0032s/iter; left time: 7.3177s
	iters: 400, epoch: 4 | loss: 0.3538351
	speed: 0.0031s/iter; left time: 6.7693s
	iters: 500, epoch: 4 | loss: 0.7210888
	speed: 0.0031s/iter; left time: 6.4433s
Updating learning rate to 0.00020569610105
Epoch: 4 cost time: 1.6544110774993896
Epoch: 4, Steps: 514 | Train Loss: 0.4361364 Vali Loss: 0.3816320 Best vali loss: 0.3707003
	iters: 100, epoch: 5 | loss: 0.4596264
	speed: 0.0068s/iter; left time: 13.2165s
	iters: 200, epoch: 5 | loss: 0.3127047
	speed: 0.0031s/iter; left time: 5.8062s
	iters: 300, epoch: 5 | loss: 0.8598911
	speed: 0.0031s/iter; left time: 5.5160s
	iters: 400, epoch: 5 | loss: 0.5441716
	speed: 0.0031s/iter; left time: 5.1735s
	iters: 500, epoch: 5 | loss: 0.7899755
	speed: 0.0031s/iter; left time: 4.8069s
Updating learning rate to 0.00012697961107606967
Validation loss decreased (0.3707 --> 0.3553).  Saving model state dict ...
Epoch: 5 cost time: 1.6420176029205322
Epoch: 5, Steps: 514 | Train Loss: 0.5932738 Vali Loss: 0.3552729 Best vali loss: 0.3552729
	iters: 100, epoch: 6 | loss: 0.7467976
	speed: 0.0070s/iter; left time: 10.0768s
	iters: 200, epoch: 6 | loss: 0.4787014
	speed: 0.0031s/iter; left time: 4.1844s
	iters: 300, epoch: 6 | loss: 0.3447330
	speed: 0.0031s/iter; left time: 3.8416s
	iters: 400, epoch: 6 | loss: 0.2202163
	speed: 0.0031s/iter; left time: 3.5495s
	iters: 500, epoch: 6 | loss: 0.5293726
	speed: 0.0029s/iter; left time: 3.0652s
Updating learning rate to 6.0246993133911696e-05
Epoch: 6 cost time: 1.62034273147583
Epoch: 6, Steps: 514 | Train Loss: 0.4639642 Vali Loss: 0.3628517 Best vali loss: 0.3552729
	iters: 100, epoch: 7 | loss: 0.5233337
	speed: 0.0067s/iter; left time: 6.2611s
	iters: 200, epoch: 7 | loss: 0.3178794
	speed: 0.0031s/iter; left time: 2.6075s
	iters: 300, epoch: 7 | loss: 0.3988123
	speed: 0.0031s/iter; left time: 2.2530s
	iters: 400, epoch: 7 | loss: 0.3903458
	speed: 0.0032s/iter; left time: 1.9819s
	iters: 500, epoch: 7 | loss: 0.3086599
	speed: 0.0031s/iter; left time: 1.6413s
Updating learning rate to 1.5657683372531603e-05
Epoch: 7 cost time: 1.6374802589416504
Epoch: 7, Steps: 514 | Train Loss: 0.3878062 Vali Loss: 0.3672507 Best vali loss: 0.3552729
	iters: 100, epoch: 8 | loss: 0.3894251
	speed: 0.0068s/iter; left time: 2.8407s
	iters: 200, epoch: 8 | loss: 0.2745563
	speed: 0.0031s/iter; left time: 0.9853s
	iters: 300, epoch: 8 | loss: 0.5851887
	speed: 0.0031s/iter; left time: 0.6662s
	iters: 400, epoch: 8 | loss: 0.3190359
	speed: 0.0031s/iter; left time: 0.3562s
	iters: 500, epoch: 8 | loss: 0.3489978
	speed: 0.0031s/iter; left time: 0.0462s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6423137187957764
Epoch: 8, Steps: 514 | Train Loss: 0.3834408 Vali Loss: 0.3684829 Best vali loss: 0.3552729

best validation loss 0.3552728944536745

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001681708522, 'e_layers': 2, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4267384
	speed: 0.0097s/iter; left time: 39.0884s
	iters: 200, epoch: 1 | loss: 1.0777073
	speed: 0.0035s/iter; left time: 13.6443s
	iters: 300, epoch: 1 | loss: 1.0144886
	speed: 0.0036s/iter; left time: 13.6305s
	iters: 400, epoch: 1 | loss: 0.5044557
	speed: 0.0036s/iter; left time: 13.2435s
	iters: 500, epoch: 1 | loss: 1.1558679
	speed: 0.0036s/iter; left time: 12.9738s
Updating learning rate to 0.0003789142607398986
Validation loss decreased (inf --> 0.3723).  Saving model state dict ...
Epoch: 1 cost time: 2.180722713470459
Epoch: 1, Steps: 514 | Train Loss: 0.8358516 Vali Loss: 0.3723000 Best vali loss: 0.3723000
	iters: 100, epoch: 2 | loss: 0.3859938
	speed: 0.0074s/iter; left time: 25.8347s
	iters: 200, epoch: 2 | loss: 0.2659290
	speed: 0.0035s/iter; left time: 11.8813s
	iters: 300, epoch: 2 | loss: 0.4680947
	speed: 0.0036s/iter; left time: 11.8460s
	iters: 400, epoch: 2 | loss: 0.3910768
	speed: 0.0036s/iter; left time: 11.4381s
	iters: 500, epoch: 2 | loss: 0.6275753
	speed: 0.0035s/iter; left time: 10.8238s
Updating learning rate to 0.00033622017026867744
Validation loss decreased (0.3723 --> 0.3652).  Saving model state dict ...
Epoch: 2 cost time: 1.8592674732208252
Epoch: 2, Steps: 514 | Train Loss: 0.4277340 Vali Loss: 0.3652337 Best vali loss: 0.3652337
	iters: 100, epoch: 3 | loss: 0.3521976
	speed: 0.0074s/iter; left time: 22.0113s
	iters: 200, epoch: 3 | loss: 0.9376915
	speed: 0.0033s/iter; left time: 9.5933s
	iters: 300, epoch: 3 | loss: 0.4959895
	speed: 0.0032s/iter; left time: 8.9388s
	iters: 400, epoch: 3 | loss: 0.4601272
	speed: 0.0033s/iter; left time: 8.8864s
	iters: 500, epoch: 3 | loss: 1.1164277
	speed: 0.0033s/iter; left time: 8.4851s
Updating learning rate to 0.00027232394843768623
Validation loss decreased (0.3652 --> 0.3594).  Saving model state dict ...
Epoch: 3 cost time: 1.7377667427062988
Epoch: 3, Steps: 514 | Train Loss: 0.6724867 Vali Loss: 0.3594174 Best vali loss: 0.3594174

best validation loss 0.3594173944769299

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022354123748, 'e_layers': 3, 'learning_rate': 0.0006335531617, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6119539
	speed: 0.0106s/iter; left time: 42.5227s
	iters: 200, epoch: 1 | loss: 0.7613747
	speed: 0.0043s/iter; left time: 16.7266s
	iters: 300, epoch: 1 | loss: 0.2910894
	speed: 0.0042s/iter; left time: 16.0962s
	iters: 400, epoch: 1 | loss: 0.5693673
	speed: 0.0043s/iter; left time: 15.9193s
	iters: 500, epoch: 1 | loss: 1.1068769
	speed: 0.0038s/iter; left time: 13.8518s
Updating learning rate to 0.0006335531617
Validation loss decreased (inf --> 0.3837).  Saving model state dict ...
Epoch: 1 cost time: 2.51037335395813
Epoch: 1, Steps: 514 | Train Loss: 0.6681324 Vali Loss: 0.3837449 Best vali loss: 0.3837449
	iters: 100, epoch: 2 | loss: 0.3680618
	speed: 0.0086s/iter; left time: 30.2487s
	iters: 200, epoch: 2 | loss: 0.5062740
	speed: 0.0038s/iter; left time: 12.9861s
	iters: 300, epoch: 2 | loss: 0.4181780
	speed: 0.0038s/iter; left time: 12.6082s
	iters: 400, epoch: 2 | loss: 0.3010893
	speed: 0.0039s/iter; left time: 12.4995s
	iters: 500, epoch: 2 | loss: 0.2903461
	speed: 0.0039s/iter; left time: 12.2230s
Updating learning rate to 0.00031677658085
Validation loss decreased (0.3837 --> 0.3827).  Saving model state dict ...
Epoch: 2 cost time: 2.050196886062622
Epoch: 2, Steps: 514 | Train Loss: 0.3767898 Vali Loss: 0.3826543 Best vali loss: 0.3826543
	iters: 100, epoch: 3 | loss: 0.3825745
	speed: 0.0082s/iter; left time: 24.4454s
	iters: 200, epoch: 3 | loss: 1.0749264
	speed: 0.0038s/iter; left time: 10.9053s
	iters: 300, epoch: 3 | loss: 0.6961490
	speed: 0.0041s/iter; left time: 11.5261s
	iters: 400, epoch: 3 | loss: 0.7962728
	speed: 0.0037s/iter; left time: 10.0319s
	iters: 500, epoch: 3 | loss: 0.5144340
	speed: 0.0039s/iter; left time: 9.9775s
Updating learning rate to 0.000158388290425
Validation loss decreased (0.3827 --> 0.3813).  Saving model state dict ...
Epoch: 3 cost time: 2.0296616554260254
Epoch: 3, Steps: 514 | Train Loss: 0.6928713 Vali Loss: 0.3812585 Best vali loss: 0.3812585

best validation loss 0.38125853549052313

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0092360588727, 'e_layers': 4, 'learning_rate': 0.0007008165161, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3631180
	speed: 0.0114s/iter; left time: 45.9003s
	iters: 200, epoch: 1 | loss: 1.4232351
	speed: 0.0052s/iter; left time: 20.4973s
	iters: 300, epoch: 1 | loss: 0.6539230
	speed: 0.0052s/iter; left time: 19.7919s
	iters: 400, epoch: 1 | loss: 0.5269754
	speed: 0.0052s/iter; left time: 19.4738s
	iters: 500, epoch: 1 | loss: 1.3235875
	speed: 0.0052s/iter; left time: 18.7695s
Updating learning rate to 0.0007008165161
Validation loss decreased (inf --> 0.3974).  Saving model state dict ...
Epoch: 1 cost time: 3.026020050048828
Epoch: 1, Steps: 514 | Train Loss: 0.8581678 Vali Loss: 0.3974478 Best vali loss: 0.3974478
	iters: 100, epoch: 2 | loss: 0.3199816
	speed: 0.0102s/iter; left time: 35.7958s
	iters: 200, epoch: 2 | loss: 0.3769993
	speed: 0.0052s/iter; left time: 17.5978s
	iters: 300, epoch: 2 | loss: 0.5714033
	speed: 0.0050s/iter; left time: 16.5205s
	iters: 400, epoch: 2 | loss: 0.3682250
	speed: 0.0051s/iter; left time: 16.3529s
	iters: 500, epoch: 2 | loss: 1.2634329
	speed: 0.0051s/iter; left time: 15.6582s
Updating learning rate to 0.00035040825805
Epoch: 2 cost time: 2.6686489582061768
Epoch: 2, Steps: 514 | Train Loss: 0.5800084 Vali Loss: 0.4016730 Best vali loss: 0.3974478
	iters: 100, epoch: 3 | loss: 0.8351382
	speed: 0.0101s/iter; left time: 30.1379s
	iters: 200, epoch: 3 | loss: 0.5113119
	speed: 0.0048s/iter; left time: 13.9574s
	iters: 300, epoch: 3 | loss: 1.4512935
	speed: 0.0048s/iter; left time: 13.3984s
	iters: 400, epoch: 3 | loss: 1.1708665
	speed: 0.0049s/iter; left time: 13.0761s
	iters: 500, epoch: 3 | loss: 1.0596905
	speed: 0.0045s/iter; left time: 11.6904s
Updating learning rate to 0.000175204129025
Epoch: 3 cost time: 2.5251519680023193
Epoch: 3, Steps: 514 | Train Loss: 1.0056601 Vali Loss: 0.4112088 Best vali loss: 0.3974478

best validation loss 0.39744784947931183

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001681708522, 'e_layers': 2, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3831376
	speed: 0.0100s/iter; left time: 24.6940s
	iters: 200, epoch: 4 | loss: 0.9738911
	speed: 0.0035s/iter; left time: 8.3574s
	iters: 300, epoch: 4 | loss: 0.8258720
	speed: 0.0034s/iter; left time: 7.8097s
	iters: 400, epoch: 4 | loss: 0.4866176
	speed: 0.0035s/iter; left time: 7.6325s
	iters: 500, epoch: 4 | loss: 0.4472003
	speed: 0.0032s/iter; left time: 6.5908s
Updating learning rate to 0.0001969532158
Validation loss decreased (0.3594 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 2.1169676780700684
Epoch: 4, Steps: 514 | Train Loss: 0.6233437 Vali Loss: 0.3552912 Best vali loss: 0.3552912
	iters: 100, epoch: 5 | loss: 0.3819061
	speed: 0.0076s/iter; left time: 14.9058s
	iters: 200, epoch: 5 | loss: 0.2302756
	speed: 0.0034s/iter; left time: 6.3999s
	iters: 300, epoch: 5 | loss: 0.3485124
	speed: 0.0037s/iter; left time: 6.5097s
	iters: 400, epoch: 5 | loss: 0.3793327
	speed: 0.0038s/iter; left time: 6.2919s
	iters: 500, epoch: 5 | loss: 0.5760292
	speed: 0.0037s/iter; left time: 5.7321s
Updating learning rate to 0.00012158248316231378
Validation loss decreased (0.3553 --> 0.3478).  Saving model state dict ...
Epoch: 5 cost time: 1.9021906852722168
Epoch: 5, Steps: 514 | Train Loss: 0.3832112 Vali Loss: 0.3478390 Best vali loss: 0.3478390
	iters: 100, epoch: 6 | loss: 0.2974398
	speed: 0.0075s/iter; left time: 10.8096s
	iters: 200, epoch: 6 | loss: 0.6621261
	speed: 0.0031s/iter; left time: 4.2157s
	iters: 300, epoch: 6 | loss: 0.3999402
	speed: 0.0032s/iter; left time: 4.0275s
	iters: 400, epoch: 6 | loss: 0.3961912
	speed: 0.0032s/iter; left time: 3.6545s
	iters: 500, epoch: 6 | loss: 0.8887786
	speed: 0.0032s/iter; left time: 3.3184s
Updating learning rate to 5.768626133132254e-05
Validation loss decreased (0.3478 --> 0.3478).  Saving model state dict ...
Epoch: 6 cost time: 1.6908607482910156
Epoch: 6, Steps: 514 | Train Loss: 0.5288951 Vali Loss: 0.3478380 Best vali loss: 0.3478380
	iters: 100, epoch: 7 | loss: 0.5140072
	speed: 0.0075s/iter; left time: 6.9825s
	iters: 200, epoch: 7 | loss: 0.4178258
	speed: 0.0030s/iter; left time: 2.5079s
	iters: 300, epoch: 7 | loss: 0.3850124
	speed: 0.0030s/iter; left time: 2.1971s
	iters: 400, epoch: 7 | loss: 0.5866221
	speed: 0.0030s/iter; left time: 1.9069s
	iters: 500, epoch: 7 | loss: 0.5979744
	speed: 0.0031s/iter; left time: 1.6564s
Updating learning rate to 1.4992170860101427e-05
Validation loss decreased (0.3478 --> 0.3461).  Saving model state dict ...
Epoch: 7 cost time: 1.634716510772705
Epoch: 7, Steps: 514 | Train Loss: 0.5002884 Vali Loss: 0.3461217 Best vali loss: 0.3461217
	iters: 100, epoch: 8 | loss: 0.4588756
	speed: 0.0071s/iter; left time: 2.9481s
	iters: 200, epoch: 8 | loss: 0.5990312
	speed: 0.0031s/iter; left time: 0.9843s
	iters: 300, epoch: 8 | loss: 0.3976330
	speed: 0.0031s/iter; left time: 0.6685s
	iters: 400, epoch: 8 | loss: 0.6032854
	speed: 0.0031s/iter; left time: 0.3547s
	iters: 500, epoch: 8 | loss: 0.4683305
	speed: 0.0031s/iter; left time: 0.0461s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6603734493255615
Epoch: 8, Steps: 514 | Train Loss: 0.5054311 Vali Loss: 0.3496445 Best vali loss: 0.3461217

best validation loss 0.3461217301767795

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0021086692706, 'e_layers': 2, 'learning_rate': 6.30413865e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5229144
	speed: 0.0103s/iter; left time: 9.6499s
Updating learning rate to 6.30413865e-05
Validation loss decreased (inf --> 0.4000).  Saving model state dict ...
Epoch: 1 cost time: 0.8844711780548096
Epoch: 1, Steps: 129 | Train Loss: 0.5229144 Vali Loss: 0.4000361 Best vali loss: 0.4000361
	iters: 100, epoch: 2 | loss: 0.6902552
	speed: 0.0072s/iter; left time: 5.7776s
Updating learning rate to 3.152069325e-05
Validation loss decreased (0.4000 --> 0.3801).  Saving model state dict ...
Epoch: 2 cost time: 0.572047233581543
Epoch: 2, Steps: 129 | Train Loss: 0.6902552 Vali Loss: 0.3800853 Best vali loss: 0.3800853
	iters: 100, epoch: 3 | loss: 0.7229459
	speed: 0.0069s/iter; left time: 4.6460s
Updating learning rate to 1.5760346625e-05
Validation loss decreased (0.3801 --> 0.3745).  Saving model state dict ...
Epoch: 3 cost time: 0.5515933036804199
Epoch: 3, Steps: 129 | Train Loss: 0.7229459 Vali Loss: 0.3744591 Best vali loss: 0.3744591
	iters: 100, epoch: 4 | loss: 0.6225642
	speed: 0.0071s/iter; left time: 3.8701s
Updating learning rate to 7.8801733125e-06
Validation loss decreased (0.3745 --> 0.3726).  Saving model state dict ...
Epoch: 4 cost time: 0.5736019611358643
Epoch: 4, Steps: 129 | Train Loss: 0.6225642 Vali Loss: 0.3725596 Best vali loss: 0.3725596
	iters: 100, epoch: 5 | loss: 0.7305555
	speed: 0.0070s/iter; left time: 2.8983s
Updating learning rate to 3.94008665625e-06
Validation loss decreased (0.3726 --> 0.3717).  Saving model state dict ...
Epoch: 5 cost time: 0.5489213466644287
Epoch: 5, Steps: 129 | Train Loss: 0.7305555 Vali Loss: 0.3716685 Best vali loss: 0.3716685
	iters: 100, epoch: 6 | loss: 0.8394079
	speed: 0.0069s/iter; left time: 1.9891s
Updating learning rate to 1.970043328125e-06
Validation loss decreased (0.3717 --> 0.3713).  Saving model state dict ...
Epoch: 6 cost time: 0.5554318428039551
Epoch: 6, Steps: 129 | Train Loss: 0.8394079 Vali Loss: 0.3712659 Best vali loss: 0.3712659
	iters: 100, epoch: 7 | loss: 0.7523422
	speed: 0.0071s/iter; left time: 1.1344s
Updating learning rate to 9.850216640625e-07
Validation loss decreased (0.3713 --> 0.3711).  Saving model state dict ...
Epoch: 7 cost time: 0.5766468048095703
Epoch: 7, Steps: 129 | Train Loss: 0.7523422 Vali Loss: 0.3710652 Best vali loss: 0.3710652
	iters: 100, epoch: 8 | loss: 0.5553902
	speed: 0.0071s/iter; left time: 0.2134s
Updating learning rate to 4.9251083203125e-07
Validation loss decreased (0.3711 --> 0.3710).  Saving model state dict ...
Epoch: 8 cost time: 0.5530376434326172
Epoch: 8, Steps: 129 | Train Loss: 0.5553902 Vali Loss: 0.3709540 Best vali loss: 0.3709540

best validation loss 0.370953982412698

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050992599886, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 1.0858237743377686
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3694925 Best vali loss: 0.3694925
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3695 --> 0.3656).  Saving model state dict ...
Epoch: 2 cost time: 0.7744877338409424
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3656185 Best vali loss: 0.3656185
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3656 --> 0.3527).  Saving model state dict ...
Epoch: 3 cost time: 0.7757349014282227
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3527453 Best vali loss: 0.3527453
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3527 --> 0.3403).  Saving model state dict ...
Epoch: 4 cost time: 0.7675747871398926
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3403118 Best vali loss: 0.3403118
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7789430618286133
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3435044 Best vali loss: 0.3403118
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.7646679878234863
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3438208 Best vali loss: 0.3403118
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.7782459259033203
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3439216 Best vali loss: 0.3403118
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.771049976348877
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3436082 Best vali loss: 0.3403118

best validation loss 0.34031180326034605

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020543422412, 'e_layers': 4, 'learning_rate': 0.0003933417115, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5139489
	speed: 0.0155s/iter; left time: 14.4452s
Updating learning rate to 0.0003933417115
Validation loss decreased (inf --> 0.3799).  Saving model state dict ...
Epoch: 1 cost time: 1.5516314506530762
Epoch: 1, Steps: 129 | Train Loss: 0.5139489 Vali Loss: 0.3799407 Best vali loss: 0.3799407
	iters: 100, epoch: 2 | loss: 0.6773331
	speed: 0.0150s/iter; left time: 12.0387s
Updating learning rate to 0.00019667085575
Epoch: 2 cost time: 1.235201358795166
Epoch: 2, Steps: 129 | Train Loss: 0.6773331 Vali Loss: 0.3902411 Best vali loss: 0.3799407
	iters: 100, epoch: 3 | loss: 0.5891675
	speed: 0.0147s/iter; left time: 9.9268s
Updating learning rate to 9.8335427875e-05
Validation loss decreased (0.3799 --> 0.3656).  Saving model state dict ...
Epoch: 3 cost time: 1.2431550025939941
Epoch: 3, Steps: 129 | Train Loss: 0.5891675 Vali Loss: 0.3656395 Best vali loss: 0.3656395

best validation loss 0.3656394708016064

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0096013391005, 'e_layers': 4, 'learning_rate': 0.0003903902024, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6432142
	speed: 0.0113s/iter; left time: 45.3428s
	iters: 200, epoch: 1 | loss: 0.6116231
	speed: 0.0053s/iter; left time: 20.5896s
	iters: 300, epoch: 1 | loss: 0.7967552
	speed: 0.0052s/iter; left time: 19.7239s
	iters: 400, epoch: 1 | loss: 0.4188779
	speed: 0.0047s/iter; left time: 17.5898s
	iters: 500, epoch: 1 | loss: 0.4191801
	speed: 0.0051s/iter; left time: 18.5968s
Updating learning rate to 0.00037553186004514927
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 2.9808156490325928
Epoch: 1, Steps: 514 | Train Loss: 0.5779301 Vali Loss: 0.3703006 Best vali loss: 0.3703006
	iters: 100, epoch: 2 | loss: 0.2896031
	speed: 0.0100s/iter; left time: 34.9448s
	iters: 200, epoch: 2 | loss: 0.2827249
	speed: 0.0051s/iter; left time: 17.3386s
	iters: 300, epoch: 2 | loss: 0.6098417
	speed: 0.0050s/iter; left time: 16.5398s
	iters: 400, epoch: 2 | loss: 0.7256036
	speed: 0.0049s/iter; left time: 15.5234s
	iters: 500, epoch: 2 | loss: 0.4520584
	speed: 0.0048s/iter; left time: 14.9320s
Updating learning rate to 0.00033321888091291437
Epoch: 2 cost time: 2.5870139598846436
Epoch: 2, Steps: 514 | Train Loss: 0.4719664 Vali Loss: 0.3720286 Best vali loss: 0.3703006
	iters: 100, epoch: 3 | loss: 0.4052559
	speed: 0.0100s/iter; left time: 29.8245s
	iters: 200, epoch: 3 | loss: 0.6432769
	speed: 0.0047s/iter; left time: 13.6962s
	iters: 300, epoch: 3 | loss: 0.7215161
	speed: 0.0050s/iter; left time: 13.8651s
	iters: 400, epoch: 3 | loss: 1.0362045
	speed: 0.0050s/iter; left time: 13.5293s
	iters: 500, epoch: 3 | loss: 0.4959249
	speed: 0.0050s/iter; left time: 12.8896s
Updating learning rate to 0.00026989303250806704
Epoch: 3 cost time: 2.5775177478790283
Epoch: 3, Steps: 514 | Train Loss: 0.6604357 Vali Loss: 0.3779347 Best vali loss: 0.3703006

best validation loss 0.3703005754994503

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0041444797286, 'e_layers': 4, 'learning_rate': 0.0003556581874, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0966554
	speed: 0.0113s/iter; left time: 91.7184s
	iters: 200, epoch: 1 | loss: 0.2801388
	speed: 0.0052s/iter; left time: 42.0867s
	iters: 300, epoch: 1 | loss: 0.5838093
	speed: 0.0052s/iter; left time: 41.3287s
	iters: 400, epoch: 1 | loss: 0.4292814
	speed: 0.0052s/iter; left time: 40.7636s
	iters: 500, epoch: 1 | loss: 1.7480516
	speed: 0.0052s/iter; left time: 40.0020s
	iters: 600, epoch: 1 | loss: 0.3694555
	speed: 0.0050s/iter; left time: 38.2060s
	iters: 700, epoch: 1 | loss: 0.3922567
	speed: 0.0049s/iter; left time: 36.8507s
	iters: 800, epoch: 1 | loss: 2.3555048
	speed: 0.0049s/iter; left time: 36.4165s
	iters: 900, epoch: 1 | loss: 0.8247845
	speed: 0.0049s/iter; left time: 35.8681s
	iters: 1000, epoch: 1 | loss: 0.2576286
	speed: 0.0050s/iter; left time: 35.8325s
Updating learning rate to 0.0003556581874
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 5.55530309677124
Epoch: 1, Steps: 1027 | Train Loss: 0.8337566 Vali Loss: 0.3775518 Best vali loss: 0.3775518
	iters: 100, epoch: 2 | loss: 1.8074123
	speed: 0.0134s/iter; left time: 94.7643s
	iters: 200, epoch: 2 | loss: 0.7514783
	speed: 0.0052s/iter; left time: 36.4146s
	iters: 300, epoch: 2 | loss: 0.4974659
	speed: 0.0050s/iter; left time: 34.5461s
	iters: 400, epoch: 2 | loss: 0.2588693
	speed: 0.0050s/iter; left time: 33.7850s
	iters: 500, epoch: 2 | loss: 1.4617407
	speed: 0.0047s/iter; left time: 31.3760s
	iters: 600, epoch: 2 | loss: 0.2455959
	speed: 0.0045s/iter; left time: 29.8568s
	iters: 700, epoch: 2 | loss: 0.6282470
	speed: 0.0048s/iter; left time: 31.4556s
	iters: 800, epoch: 2 | loss: 0.8519954
	speed: 0.0046s/iter; left time: 29.1787s
	iters: 900, epoch: 2 | loss: 0.7569084
	speed: 0.0049s/iter; left time: 30.7162s
	iters: 1000, epoch: 2 | loss: 0.4373811
	speed: 0.0048s/iter; left time: 29.8274s
Updating learning rate to 0.0001778290937
Epoch: 2 cost time: 5.043121099472046
Epoch: 2, Steps: 1027 | Train Loss: 0.7697094 Vali Loss: 0.3791955 Best vali loss: 0.3775518
	iters: 100, epoch: 3 | loss: 1.3089919
	speed: 0.0126s/iter; left time: 76.3433s
	iters: 200, epoch: 3 | loss: 1.0888633
	speed: 0.0048s/iter; left time: 28.7252s
	iters: 300, epoch: 3 | loss: 0.2689649
	speed: 0.0048s/iter; left time: 28.3921s
	iters: 400, epoch: 3 | loss: 0.3197434
	speed: 0.0048s/iter; left time: 27.7672s
	iters: 500, epoch: 3 | loss: 1.0317677
	speed: 0.0048s/iter; left time: 27.2200s
	iters: 600, epoch: 3 | loss: 0.6886930
	speed: 0.0049s/iter; left time: 27.0727s
	iters: 700, epoch: 3 | loss: 0.2227156
	speed: 0.0048s/iter; left time: 26.4309s
	iters: 800, epoch: 3 | loss: 1.5404706
	speed: 0.0048s/iter; left time: 25.7382s
	iters: 900, epoch: 3 | loss: 0.9748454
	speed: 0.0048s/iter; left time: 25.1982s
	iters: 1000, epoch: 3 | loss: 0.2899434
	speed: 0.0048s/iter; left time: 24.7417s
Updating learning rate to 8.891454685e-05
Epoch: 3 cost time: 4.983802318572998
Epoch: 3, Steps: 1027 | Train Loss: 0.7734999 Vali Loss: 0.3792789 Best vali loss: 0.3775518

best validation loss 0.3775517814285863

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0020543422412, 'e_layers': 4, 'learning_rate': 0.0003933417115, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4470452
	speed: 0.0160s/iter; left time: 8.7479s
Updating learning rate to 4.91677139375e-05
Validation loss decreased (0.3656 --> 0.3477).  Saving model state dict ...
Epoch: 4 cost time: 1.5630338191986084
Epoch: 4, Steps: 129 | Train Loss: 0.4470452 Vali Loss: 0.3477048 Best vali loss: 0.3477048
	iters: 100, epoch: 5 | loss: 0.5528972
	speed: 0.0152s/iter; left time: 6.3491s
Updating learning rate to 2.458385696875e-05
Epoch: 5 cost time: 1.239466905593872
Epoch: 5, Steps: 129 | Train Loss: 0.5528972 Vali Loss: 0.3529819 Best vali loss: 0.3477048
	iters: 100, epoch: 6 | loss: 0.4794978
	speed: 0.0147s/iter; left time: 4.2435s
Updating learning rate to 1.2291928484375e-05
Epoch: 6 cost time: 1.2366869449615479
Epoch: 6, Steps: 129 | Train Loss: 0.4794978 Vali Loss: 0.3539578 Best vali loss: 0.3477048
	iters: 100, epoch: 7 | loss: 0.4611506
	speed: 0.0146s/iter; left time: 2.3264s
Updating learning rate to 6.1459642421875e-06
Epoch: 7 cost time: 1.237947702407837
Epoch: 7, Steps: 129 | Train Loss: 0.4611506 Vali Loss: 0.3555871 Best vali loss: 0.3477048
	iters: 100, epoch: 8 | loss: 0.5278791
	speed: 0.0147s/iter; left time: 0.4403s
Updating learning rate to 3.07298212109375e-06
Epoch: 8 cost time: 1.2479338645935059
Epoch: 8, Steps: 129 | Train Loss: 0.5278791 Vali Loss: 0.3533234 Best vali loss: 0.3477048

best validation loss 0.3477047823618344

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0008931950073, 'e_layers': 3, 'learning_rate': 0.001784369658, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017164561317301824
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 0.7134106159210205
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3658073 Best vali loss: 0.3658073
Updating learning rate to 0.0015230547716576603
Epoch: 2 cost time: 0.40447306632995605
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3991286 Best vali loss: 0.3658073
Updating learning rate to 0.0012336091816657808
Epoch: 3 cost time: 0.4049713611602783
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3837316 Best vali loss: 0.3658073
Updating learning rate to 0.000892184829
Epoch: 4 cost time: 0.4147987365722656
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3679368 Best vali loss: 0.3658073
Updating learning rate to 0.0005507604763342193
Epoch: 5 cost time: 0.38951802253723145
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4025503 Best vali loss: 0.3658073
Updating learning rate to 0.00026131488634233976
Epoch: 6 cost time: 0.41132378578186035
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3729751 Best vali loss: 0.3658073
Updating learning rate to 6.791352626981771e-05
Validation loss decreased (0.3658 --> 0.3594).  Saving model state dict ...
Epoch: 7 cost time: 0.40289998054504395
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3593913 Best vali loss: 0.3593913
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4104268550872803
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3686174 Best vali loss: 0.3593913

best validation loss 0.3593912780401983

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0090165055225, 'e_layers': 2, 'learning_rate': 0.0007499793316, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5455440
	speed: 0.0102s/iter; left time: 9.5394s
Updating learning rate to 0.0007214349429358676
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 0.8799176216125488
Epoch: 1, Steps: 129 | Train Loss: 0.5455440 Vali Loss: 0.3671188 Best vali loss: 0.3671188
	iters: 100, epoch: 2 | loss: 0.6359829
	speed: 0.0072s/iter; left time: 5.7523s
Updating learning rate to 0.0006401474013620572
Epoch: 2 cost time: 0.5749914646148682
Epoch: 2, Steps: 129 | Train Loss: 0.6359829 Vali Loss: 0.3766003 Best vali loss: 0.3671188
	iters: 100, epoch: 3 | loss: 0.5376547
	speed: 0.0072s/iter; left time: 4.8622s
Updating learning rate to 0.0005184919982097819
Validation loss decreased (0.3671 --> 0.3558).  Saving model state dict ...
Epoch: 3 cost time: 0.567138671875
Epoch: 3, Steps: 129 | Train Loss: 0.5376547 Vali Loss: 0.3557840 Best vali loss: 0.3557840
	iters: 100, epoch: 4 | loss: 0.6828694
	speed: 0.0068s/iter; left time: 3.7088s
Updating learning rate to 0.0003749896658
Epoch: 4 cost time: 0.5451533794403076
Epoch: 4, Steps: 129 | Train Loss: 0.6828694 Vali Loss: 0.3843525 Best vali loss: 0.3557840
	iters: 100, epoch: 5 | loss: 0.6483197
	speed: 0.0067s/iter; left time: 2.7898s
Updating learning rate to 0.00023148733339021808
Epoch: 5 cost time: 0.5208554267883301
Epoch: 5, Steps: 129 | Train Loss: 0.6483197 Vali Loss: 0.3920745 Best vali loss: 0.3557840
	iters: 100, epoch: 6 | loss: 0.6310350
	speed: 0.0068s/iter; left time: 1.9694s
Updating learning rate to 0.00010983193023794284
Epoch: 6 cost time: 0.5489213466644287
Epoch: 6, Steps: 129 | Train Loss: 0.6310350 Vali Loss: 0.3864475 Best vali loss: 0.3557840
	iters: 100, epoch: 7 | loss: 0.5041343
	speed: 0.0067s/iter; left time: 1.0620s
Updating learning rate to 2.8544388664132348e-05
Epoch: 7 cost time: 0.5252704620361328
Epoch: 7, Steps: 129 | Train Loss: 0.5041343 Vali Loss: 0.4078470 Best vali loss: 0.3557840
	iters: 100, epoch: 8 | loss: 0.6735825
	speed: 0.0068s/iter; left time: 0.2049s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5436711311340332
Epoch: 8, Steps: 129 | Train Loss: 0.6735825 Vali Loss: 0.3928884 Best vali loss: 0.3557840

best validation loss 0.355783999680536

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010640627703, 'e_layers': 2, 'learning_rate': 0.0003901009704, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4265310
	speed: 0.0098s/iter; left time: 39.3112s
	iters: 200, epoch: 1 | loss: 1.0777692
	speed: 0.0036s/iter; left time: 14.1257s
	iters: 300, epoch: 1 | loss: 1.0150404
	speed: 0.0034s/iter; left time: 13.0806s
	iters: 400, epoch: 1 | loss: 0.5042315
	speed: 0.0034s/iter; left time: 12.7266s
	iters: 500, epoch: 1 | loss: 1.1419455
	speed: 0.0034s/iter; left time: 12.4094s
Updating learning rate to 0.0003901009704
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 2.154195785522461
Epoch: 1, Steps: 514 | Train Loss: 0.8331035 Vali Loss: 0.3725075 Best vali loss: 0.3725075
	iters: 100, epoch: 2 | loss: 0.3927067
	speed: 0.0074s/iter; left time: 26.0351s
	iters: 200, epoch: 2 | loss: 0.2663668
	speed: 0.0033s/iter; left time: 11.1706s
	iters: 300, epoch: 2 | loss: 0.5216714
	speed: 0.0032s/iter; left time: 10.6756s
	iters: 400, epoch: 2 | loss: 0.3914062
	speed: 0.0032s/iter; left time: 10.1398s
	iters: 500, epoch: 2 | loss: 0.6103765
	speed: 0.0032s/iter; left time: 9.7688s
Updating learning rate to 0.0001950504852
Validation loss decreased (0.3725 --> 0.3671).  Saving model state dict ...
Epoch: 2 cost time: 1.6937255859375
Epoch: 2, Steps: 514 | Train Loss: 0.4365055 Vali Loss: 0.3671263 Best vali loss: 0.3671263
	iters: 100, epoch: 3 | loss: 0.3827322
	speed: 0.0072s/iter; left time: 21.5610s
	iters: 200, epoch: 3 | loss: 0.8593959
	speed: 0.0033s/iter; left time: 9.5120s
	iters: 300, epoch: 3 | loss: 0.5069799
	speed: 0.0033s/iter; left time: 9.1171s
	iters: 400, epoch: 3 | loss: 0.4511881
	speed: 0.0032s/iter; left time: 8.6787s
	iters: 500, epoch: 3 | loss: 1.0674092
	speed: 0.0033s/iter; left time: 8.6192s
Updating learning rate to 9.75252426e-05
Epoch: 3 cost time: 1.7227303981781006
Epoch: 3, Steps: 514 | Train Loss: 0.6535410 Vali Loss: 0.3692689 Best vali loss: 0.3671263

best validation loss 0.3671263210138778

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056831160316, 'e_layers': 4, 'learning_rate': 0.0013499813337, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0013499813337
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 0.7842581272125244
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3747738 Best vali loss: 0.3747738
Updating learning rate to 0.00067499066685
Epoch: 2 cost time: 0.4761049747467041
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3773759 Best vali loss: 0.3747738
Updating learning rate to 0.000337495333425
Validation loss decreased (0.3748 --> 0.3634).  Saving model state dict ...
Epoch: 3 cost time: 0.45435094833374023
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3633878 Best vali loss: 0.3633878

best validation loss 0.36338776342995277

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0015959457317, 'e_layers': 1, 'learning_rate': 0.0002533139385, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7096572
	speed: 0.0086s/iter; left time: 34.6878s
	iters: 200, epoch: 1 | loss: 0.7297316
	speed: 0.0023s/iter; left time: 9.0945s
	iters: 300, epoch: 1 | loss: 1.0398090
	speed: 0.0023s/iter; left time: 8.7906s
	iters: 400, epoch: 1 | loss: 0.6319203
	speed: 0.0024s/iter; left time: 8.8638s
	iters: 500, epoch: 1 | loss: 0.4371816
	speed: 0.0023s/iter; left time: 8.4057s
Updating learning rate to 0.00024367275078998642
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 1.5480492115020752
Epoch: 1, Steps: 514 | Train Loss: 0.7096600 Vali Loss: 0.3656583 Best vali loss: 0.3656583
	iters: 100, epoch: 2 | loss: 0.5354779
	speed: 0.0057s/iter; left time: 20.0885s
	iters: 200, epoch: 2 | loss: 0.6062079
	speed: 0.0023s/iter; left time: 7.9318s
	iters: 300, epoch: 2 | loss: 0.7892435
	speed: 0.0024s/iter; left time: 7.7848s
	iters: 400, epoch: 2 | loss: 0.3966772
	speed: 0.0024s/iter; left time: 7.7161s
	iters: 500, epoch: 2 | loss: 0.9910733
	speed: 0.0023s/iter; left time: 7.2763s
Updating learning rate to 0.00021621697109121103
Epoch: 2 cost time: 1.2582228183746338
Epoch: 2, Steps: 514 | Train Loss: 0.6637360 Vali Loss: 0.3683768 Best vali loss: 0.3656583
	iters: 100, epoch: 3 | loss: 0.8444343
	speed: 0.0060s/iter; left time: 17.7927s
	iters: 200, epoch: 3 | loss: 0.8984287
	speed: 0.0025s/iter; left time: 7.2774s
	iters: 300, epoch: 3 | loss: 0.6531513
	speed: 0.0024s/iter; left time: 6.7263s
	iters: 400, epoch: 3 | loss: 0.2753843
	speed: 0.0024s/iter; left time: 6.5025s
	iters: 500, epoch: 3 | loss: 0.7784879
	speed: 0.0024s/iter; left time: 6.2389s
Updating learning rate to 0.00017512649297554965
Epoch: 3 cost time: 1.3043570518493652
Epoch: 3, Steps: 514 | Train Loss: 0.6899773 Vali Loss: 0.3749460 Best vali loss: 0.3656583

best validation loss 0.3656583497121432

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056831160316, 'e_layers': 4, 'learning_rate': 0.0013499813337, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001687476667125
Validation loss decreased (0.3634 --> 0.3597).  Saving model state dict ...
Epoch: 4 cost time: 0.7835240364074707
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3597224 Best vali loss: 0.3597224
Updating learning rate to 8.437383335625e-05
Validation loss decreased (0.3597 --> 0.3526).  Saving model state dict ...
Epoch: 5 cost time: 0.43753504753112793
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3525995 Best vali loss: 0.3525995
Updating learning rate to 4.2186916678125e-05
Epoch: 6 cost time: 0.44511985778808594
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3578696 Best vali loss: 0.3525995
Updating learning rate to 2.10934583390625e-05
Epoch: 7 cost time: 0.4874715805053711
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3574079 Best vali loss: 0.3525995
Updating learning rate to 1.054672916953125e-05
Epoch: 8 cost time: 0.44045376777648926
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3566096 Best vali loss: 0.3525995

best validation loss 0.3525995015980921

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0025126352037, 'e_layers': 3, 'learning_rate': 0.0013855298055, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2400448
	speed: 0.0104s/iter; left time: 84.1649s
	iters: 200, epoch: 1 | loss: 1.0663352
	speed: 0.0042s/iter; left time: 33.7600s
	iters: 300, epoch: 1 | loss: 0.7886885
	speed: 0.0042s/iter; left time: 32.8756s
	iters: 400, epoch: 1 | loss: 0.7886271
	speed: 0.0042s/iter; left time: 32.5923s
	iters: 500, epoch: 1 | loss: 0.6282820
	speed: 0.0041s/iter; left time: 31.9872s
	iters: 600, epoch: 1 | loss: 0.6258471
	speed: 0.0042s/iter; left time: 31.6433s
	iters: 700, epoch: 1 | loss: 1.0168028
	speed: 0.0042s/iter; left time: 31.3462s
	iters: 800, epoch: 1 | loss: 1.4119369
	speed: 0.0041s/iter; left time: 30.5925s
	iters: 900, epoch: 1 | loss: 1.0672487
	speed: 0.0042s/iter; left time: 31.0098s
	iters: 1000, epoch: 1 | loss: 1.8286382
	speed: 0.0042s/iter; left time: 30.3754s
Updating learning rate to 0.001332796217242897
Validation loss decreased (inf --> 0.3811).  Saving model state dict ...
Epoch: 1 cost time: 4.631750583648682
Epoch: 1, Steps: 1027 | Train Loss: 0.9462451 Vali Loss: 0.3811353 Best vali loss: 0.3811353
	iters: 100, epoch: 2 | loss: 0.5404046
	speed: 0.0112s/iter; left time: 79.3703s
	iters: 200, epoch: 2 | loss: 0.3298152
	speed: 0.0039s/iter; left time: 27.5969s
	iters: 300, epoch: 2 | loss: 1.0756756
	speed: 0.0038s/iter; left time: 26.4672s
	iters: 400, epoch: 2 | loss: 0.3993807
	speed: 0.0036s/iter; left time: 24.4938s
	iters: 500, epoch: 2 | loss: 0.3297126
	speed: 0.0036s/iter; left time: 24.0892s
	iters: 600, epoch: 2 | loss: 0.4733019
	speed: 0.0036s/iter; left time: 23.7408s
	iters: 700, epoch: 2 | loss: 0.9608948
	speed: 0.0039s/iter; left time: 25.2374s
	iters: 800, epoch: 2 | loss: 0.8684947
	speed: 0.0038s/iter; left time: 24.4718s
	iters: 900, epoch: 2 | loss: 0.8822849
	speed: 0.0039s/iter; left time: 24.6012s
	iters: 1000, epoch: 2 | loss: 1.1308260
	speed: 0.0039s/iter; left time: 23.9463s
Updating learning rate to 0.001182623663252564
Validation loss decreased (0.3811 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 3.951284408569336
Epoch: 2, Steps: 1027 | Train Loss: 0.6990791 Vali Loss: 0.3694497 Best vali loss: 0.3694497
	iters: 100, epoch: 3 | loss: 0.5660456
	speed: 0.0113s/iter; left time: 68.8003s
	iters: 200, epoch: 3 | loss: 0.4254874
	speed: 0.0041s/iter; left time: 24.3770s
	iters: 300, epoch: 3 | loss: 1.1427602
	speed: 0.0041s/iter; left time: 23.8622s
	iters: 400, epoch: 3 | loss: 0.3680515
	speed: 0.0040s/iter; left time: 23.2661s
	iters: 500, epoch: 3 | loss: 1.4474907
	speed: 0.0041s/iter; left time: 23.1320s
	iters: 600, epoch: 3 | loss: 0.2804959
	speed: 0.0041s/iter; left time: 22.9554s
	iters: 700, epoch: 3 | loss: 0.4508233
	speed: 0.0039s/iter; left time: 21.5738s
	iters: 800, epoch: 3 | loss: 0.6861132
	speed: 0.0039s/iter; left time: 21.0653s
	iters: 900, epoch: 3 | loss: 0.6163166
	speed: 0.0039s/iter; left time: 20.5816s
	iters: 1000, epoch: 3 | loss: 1.0719162
	speed: 0.0039s/iter; left time: 20.3866s
Updating learning rate to 0.0009578745535564376
Epoch: 3 cost time: 4.176579475402832
Epoch: 3, Steps: 1027 | Train Loss: 0.7055501 Vali Loss: 0.3728714 Best vali loss: 0.3694497
	iters: 100, epoch: 4 | loss: 0.5923294
	speed: 0.0110s/iter; left time: 55.4903s
	iters: 200, epoch: 4 | loss: 0.2817679
	speed: 0.0040s/iter; left time: 19.8845s
	iters: 300, epoch: 4 | loss: 0.5002664
	speed: 0.0040s/iter; left time: 19.5400s
	iters: 400, epoch: 4 | loss: 0.3911035
	speed: 0.0041s/iter; left time: 19.1819s
	iters: 500, epoch: 4 | loss: 0.3573320
	speed: 0.0041s/iter; left time: 19.0515s
	iters: 600, epoch: 4 | loss: 0.4122794
	speed: 0.0040s/iter; left time: 18.2881s
	iters: 700, epoch: 4 | loss: 0.5943030
	speed: 0.0040s/iter; left time: 17.7293s
	iters: 800, epoch: 4 | loss: 0.6655391
	speed: 0.0041s/iter; left time: 17.6644s
	iters: 900, epoch: 4 | loss: 1.7586250
	speed: 0.0041s/iter; left time: 17.2746s
	iters: 1000, epoch: 4 | loss: 0.3209139
	speed: 0.0041s/iter; left time: 16.7893s
Updating learning rate to 0.00069276490275
Epoch: 4 cost time: 4.204629898071289
Epoch: 4, Steps: 1027 | Train Loss: 0.5874460 Vali Loss: 0.3729976 Best vali loss: 0.3694497
	iters: 100, epoch: 5 | loss: 0.8521415
	speed: 0.0108s/iter; left time: 43.2954s
	iters: 200, epoch: 5 | loss: 0.9944314
	speed: 0.0036s/iter; left time: 14.0140s
	iters: 300, epoch: 5 | loss: 0.3342801
	speed: 0.0036s/iter; left time: 13.6260s
	iters: 400, epoch: 5 | loss: 1.0753787
	speed: 0.0036s/iter; left time: 13.3196s
	iters: 500, epoch: 5 | loss: 0.1735384
	speed: 0.0040s/iter; left time: 14.2811s
	iters: 600, epoch: 5 | loss: 0.3162863
	speed: 0.0037s/iter; left time: 12.8109s
	iters: 700, epoch: 5 | loss: 0.2915764
	speed: 0.0038s/iter; left time: 12.9738s
	iters: 800, epoch: 5 | loss: 0.4409612
	speed: 0.0039s/iter; left time: 12.9693s
	iters: 900, epoch: 5 | loss: 1.4322950
	speed: 0.0039s/iter; left time: 12.5680s
	iters: 1000, epoch: 5 | loss: 0.4944848
	speed: 0.0039s/iter; left time: 12.1710s
Updating learning rate to 0.0004276552519435624
Epoch: 5 cost time: 3.902367353439331
Epoch: 5, Steps: 1027 | Train Loss: 0.6405374 Vali Loss: 0.3905133 Best vali loss: 0.3694497
	iters: 100, epoch: 6 | loss: 0.3096326
	speed: 0.0108s/iter; left time: 32.2904s
	iters: 200, epoch: 6 | loss: 0.3591572
	speed: 0.0040s/iter; left time: 11.4481s
	iters: 300, epoch: 6 | loss: 0.3039246
	speed: 0.0040s/iter; left time: 11.1108s
	iters: 400, epoch: 6 | loss: 1.6850606
	speed: 0.0040s/iter; left time: 10.7247s
	iters: 500, epoch: 6 | loss: 0.3605642
	speed: 0.0040s/iter; left time: 10.3188s
	iters: 600, epoch: 6 | loss: 0.5307358
	speed: 0.0040s/iter; left time: 9.9540s
	iters: 700, epoch: 6 | loss: 0.3144532
	speed: 0.0041s/iter; left time: 9.8529s
	iters: 800, epoch: 6 | loss: 0.4026158
	speed: 0.0041s/iter; left time: 9.4231s
	iters: 900, epoch: 6 | loss: 0.4943057
	speed: 0.0042s/iter; left time: 9.0995s
	iters: 1000, epoch: 6 | loss: 0.1730027
	speed: 0.0042s/iter; left time: 8.7009s
Updating learning rate to 0.0002029061422474359
Epoch: 6 cost time: 4.213135004043579
Epoch: 6, Steps: 1027 | Train Loss: 0.4933452 Vali Loss: 0.4005253 Best vali loss: 0.3694497
	iters: 100, epoch: 7 | loss: 0.5039986
	speed: 0.0108s/iter; left time: 21.0854s
	iters: 200, epoch: 7 | loss: 0.7803319
	speed: 0.0040s/iter; left time: 7.3971s
	iters: 300, epoch: 7 | loss: 0.2528262
	speed: 0.0040s/iter; left time: 6.9524s
	iters: 400, epoch: 7 | loss: 0.1711381
	speed: 0.0040s/iter; left time: 6.5548s
	iters: 500, epoch: 7 | loss: 0.4574904
	speed: 0.0040s/iter; left time: 6.2344s
	iters: 600, epoch: 7 | loss: 0.7871953
	speed: 0.0040s/iter; left time: 5.7714s
	iters: 700, epoch: 7 | loss: 0.4086248
	speed: 0.0042s/iter; left time: 5.6512s
	iters: 800, epoch: 7 | loss: 1.1285387
	speed: 0.0040s/iter; left time: 5.0008s
	iters: 900, epoch: 7 | loss: 0.2750155
	speed: 0.0041s/iter; left time: 4.7630s
	iters: 1000, epoch: 7 | loss: 0.4828129
	speed: 0.0042s/iter; left time: 4.3849s
Updating learning rate to 5.273358825710298e-05
Epoch: 7 cost time: 4.17775821685791
Epoch: 7, Steps: 1027 | Train Loss: 0.5247972 Vali Loss: 0.3962208 Best vali loss: 0.3694497
	iters: 100, epoch: 8 | loss: 0.2392475
	speed: 0.0105s/iter; left time: 9.7617s
	iters: 200, epoch: 8 | loss: 0.3460789
	speed: 0.0039s/iter; left time: 3.2178s
	iters: 300, epoch: 8 | loss: 0.2677422
	speed: 0.0037s/iter; left time: 2.6734s
	iters: 400, epoch: 8 | loss: 0.2492066
	speed: 0.0037s/iter; left time: 2.3128s
	iters: 500, epoch: 8 | loss: 0.2997375
	speed: 0.0039s/iter; left time: 2.0332s
	iters: 600, epoch: 8 | loss: 0.6975677
	speed: 0.0037s/iter; left time: 1.5797s
	iters: 700, epoch: 8 | loss: 0.7922446
	speed: 0.0039s/iter; left time: 1.2686s
	iters: 800, epoch: 8 | loss: 0.5440850
	speed: 0.0039s/iter; left time: 0.8959s
	iters: 900, epoch: 8 | loss: 1.1090492
	speed: 0.0040s/iter; left time: 0.5089s
	iters: 1000, epoch: 8 | loss: 0.2439938
	speed: 0.0040s/iter; left time: 0.1125s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.9847779273986816
Epoch: 8, Steps: 1027 | Train Loss: 0.4788953 Vali Loss: 0.3999536 Best vali loss: 0.3694497

best validation loss 0.369449721549021

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.004563688123, 'e_layers': 2, 'learning_rate': 0.0003461365552, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5810837
	speed: 0.0112s/iter; left time: 10.4362s
Updating learning rate to 0.0003461365552
Validation loss decreased (inf --> 0.3812).  Saving model state dict ...
Epoch: 1 cost time: 0.9646923542022705
Epoch: 1, Steps: 129 | Train Loss: 0.5810837 Vali Loss: 0.3812304 Best vali loss: 0.3812304
	iters: 100, epoch: 2 | loss: 0.7398916
	speed: 0.0084s/iter; left time: 6.7633s
Updating learning rate to 0.0001730682776
Validation loss decreased (0.3812 --> 0.3729).  Saving model state dict ...
Epoch: 2 cost time: 0.6549990177154541
Epoch: 2, Steps: 129 | Train Loss: 0.7398916 Vali Loss: 0.3728547 Best vali loss: 0.3728547
	iters: 100, epoch: 3 | loss: 0.4779544
	speed: 0.0085s/iter; left time: 5.7418s
Updating learning rate to 8.65341388e-05
Validation loss decreased (0.3729 --> 0.3661).  Saving model state dict ...
Epoch: 3 cost time: 0.6514682769775391
Epoch: 3, Steps: 129 | Train Loss: 0.4779544 Vali Loss: 0.3660708 Best vali loss: 0.3660708
	iters: 100, epoch: 4 | loss: 0.7011392
	speed: 0.0086s/iter; left time: 4.7018s
Updating learning rate to 4.32670694e-05
Epoch: 4 cost time: 0.6621730327606201
Epoch: 4, Steps: 129 | Train Loss: 0.7011392 Vali Loss: 0.3797206 Best vali loss: 0.3660708
	iters: 100, epoch: 5 | loss: 0.6191543
	speed: 0.0082s/iter; left time: 3.4035s
Updating learning rate to 2.16335347e-05
Epoch: 5 cost time: 0.6537878513336182
Epoch: 5, Steps: 129 | Train Loss: 0.6191543 Vali Loss: 0.3783116 Best vali loss: 0.3660708
	iters: 100, epoch: 6 | loss: 0.5322605
	speed: 0.0083s/iter; left time: 2.3861s
Updating learning rate to 1.081676735e-05
Epoch: 6 cost time: 0.6563875675201416
Epoch: 6, Steps: 129 | Train Loss: 0.5322605 Vali Loss: 0.3807566 Best vali loss: 0.3660708
	iters: 100, epoch: 7 | loss: 0.5651162
	speed: 0.0083s/iter; left time: 1.3118s
Updating learning rate to 5.408383675e-06
Epoch: 7 cost time: 0.6534378528594971
Epoch: 7, Steps: 129 | Train Loss: 0.5651162 Vali Loss: 0.3817904 Best vali loss: 0.3660708
	iters: 100, epoch: 8 | loss: 0.3567278
	speed: 0.0083s/iter; left time: 0.2482s
Updating learning rate to 2.7041918375e-06
Epoch: 8 cost time: 0.6595265865325928
Epoch: 8, Steps: 129 | Train Loss: 0.3567278 Vali Loss: 0.3827536 Best vali loss: 0.3660708

best validation loss 0.3660707734305638

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021720653593, 'e_layers': 2, 'learning_rate': 0.0004305257116, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8120008
	speed: 0.0097s/iter; left time: 38.8535s
	iters: 200, epoch: 1 | loss: 0.3329934
	speed: 0.0032s/iter; left time: 12.7091s
	iters: 300, epoch: 1 | loss: 0.5305890
	speed: 0.0033s/iter; left time: 12.4627s
	iters: 400, epoch: 1 | loss: 1.0811865
	speed: 0.0033s/iter; left time: 12.0950s
	iters: 500, epoch: 1 | loss: 0.9339489
	speed: 0.0033s/iter; left time: 11.8417s
Updating learning rate to 0.00041413980238354855
Validation loss decreased (inf --> 0.3816).  Saving model state dict ...
Epoch: 1 cost time: 2.040709972381592
Epoch: 1, Steps: 514 | Train Loss: 0.7381437 Vali Loss: 0.3815516 Best vali loss: 0.3815516
	iters: 100, epoch: 2 | loss: 1.3882174
	speed: 0.0073s/iter; left time: 25.5726s
	iters: 200, epoch: 2 | loss: 0.7095890
	speed: 0.0033s/iter; left time: 11.0875s
	iters: 300, epoch: 2 | loss: 0.7008428
	speed: 0.0033s/iter; left time: 10.8453s
	iters: 400, epoch: 2 | loss: 0.6385260
	speed: 0.0031s/iter; left time: 9.9711s
	iters: 500, epoch: 2 | loss: 0.6545735
	speed: 0.0032s/iter; left time: 9.7936s
Updating learning rate to 0.00036747668087376193
Epoch: 2 cost time: 1.7152245044708252
Epoch: 2, Steps: 514 | Train Loss: 0.8183498 Vali Loss: 0.3898629 Best vali loss: 0.3815516
	iters: 100, epoch: 3 | loss: 0.4701516
	speed: 0.0071s/iter; left time: 21.1246s
	iters: 200, epoch: 3 | loss: 0.5270965
	speed: 0.0033s/iter; left time: 9.5139s
	iters: 300, epoch: 3 | loss: 0.5386484
	speed: 0.0032s/iter; left time: 8.8852s
	iters: 400, epoch: 3 | loss: 0.5111651
	speed: 0.0033s/iter; left time: 8.7734s
	iters: 500, epoch: 3 | loss: 1.1927336
	speed: 0.0033s/iter; left time: 8.5250s
Updating learning rate to 0.0002976403843182554
Validation loss decreased (0.3816 --> 0.3690).  Saving model state dict ...
Epoch: 3 cost time: 1.7240703105926514
Epoch: 3, Steps: 514 | Train Loss: 0.6479591 Vali Loss: 0.3689759 Best vali loss: 0.3689759

best validation loss 0.36897592323819406

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.004092713565, 'e_layers': 1, 'learning_rate': 0.0002973599122, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6554852
	speed: 0.0093s/iter; left time: 8.6508s
Updating learning rate to 0.00028604232443546663
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 0.7413504123687744
Epoch: 1, Steps: 129 | Train Loss: 0.6554852 Vali Loss: 0.3799915 Best vali loss: 0.3799915
	iters: 100, epoch: 2 | loss: 0.4827493
	speed: 0.0060s/iter; left time: 4.8270s
Updating learning rate to 0.0002538125612848282
Validation loss decreased (0.3800 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 0.45066237449645996
Epoch: 2, Steps: 129 | Train Loss: 0.4827493 Vali Loss: 0.3690154 Best vali loss: 0.3690154
	iters: 100, epoch: 3 | loss: 0.6245026
	speed: 0.0057s/iter; left time: 3.8640s
Updating learning rate to 0.00020557731202423889
Validation loss decreased (0.3690 --> 0.3678).  Saving model state dict ...
Epoch: 3 cost time: 0.4426722526550293
Epoch: 3, Steps: 129 | Train Loss: 0.6245026 Vali Loss: 0.3677630 Best vali loss: 0.3677630

best validation loss 0.36776297984750894

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050778014322, 'e_layers': 4, 'learning_rate': 0.0006649761855, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006649761855
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.1109001636505127
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3691082 Best vali loss: 0.3691082
Updating learning rate to 0.00033248809275
Validation loss decreased (0.3691 --> 0.3576).  Saving model state dict ...
Epoch: 2 cost time: 0.7778618335723877
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3575589 Best vali loss: 0.3575589
Updating learning rate to 0.000166244046375
Validation loss decreased (0.3576 --> 0.3561).  Saving model state dict ...
Epoch: 3 cost time: 0.7798500061035156
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3560705 Best vali loss: 0.3560705

best validation loss 0.3560705409068724

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050778014322, 'e_layers': 4, 'learning_rate': 0.0006649761855, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.31220231875e-05
Validation loss decreased (0.3561 --> 0.3487).  Saving model state dict ...
Epoch: 4 cost time: 1.1013281345367432
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3487009 Best vali loss: 0.3487009
Updating learning rate to 4.156101159375e-05
Validation loss decreased (0.3487 --> 0.3485).  Saving model state dict ...
Epoch: 5 cost time: 0.772167444229126
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3485169 Best vali loss: 0.3485169
Updating learning rate to 2.0780505796875e-05
Validation loss decreased (0.3485 --> 0.3432).  Saving model state dict ...
Epoch: 6 cost time: 0.7788956165313721
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3432086 Best vali loss: 0.3432086
Updating learning rate to 1.03902528984375e-05
Epoch: 7 cost time: 0.7813534736633301
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3437393 Best vali loss: 0.3432086
Updating learning rate to 5.19512644921875e-06
Epoch: 8 cost time: 0.7717161178588867
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3446384 Best vali loss: 0.3432086

best validation loss 0.3432085756234429

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010292344258, 'e_layers': 2, 'learning_rate': 0.0002959087166, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4261401
	speed: 0.0099s/iter; left time: 39.7323s
	iters: 200, epoch: 1 | loss: 1.0746245
	speed: 0.0035s/iter; left time: 13.5447s
	iters: 300, epoch: 1 | loss: 1.0134488
	speed: 0.0034s/iter; left time: 12.8889s
	iters: 400, epoch: 1 | loss: 0.5067171
	speed: 0.0034s/iter; left time: 12.6566s
	iters: 500, epoch: 1 | loss: 1.0638956
	speed: 0.0034s/iter; left time: 12.1257s
Updating learning rate to 0.0002846463616792114
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 2.1294872760772705
Epoch: 1, Steps: 514 | Train Loss: 0.8169652 Vali Loss: 0.3702830 Best vali loss: 0.3702830
	iters: 100, epoch: 2 | loss: 0.3902971
	speed: 0.0075s/iter; left time: 26.1264s
	iters: 200, epoch: 2 | loss: 0.3064950
	speed: 0.0032s/iter; left time: 10.8252s
	iters: 300, epoch: 2 | loss: 0.4123903
	speed: 0.0032s/iter; left time: 10.4759s
	iters: 400, epoch: 2 | loss: 0.3899340
	speed: 0.0030s/iter; left time: 9.6366s
	iters: 500, epoch: 2 | loss: 0.6242608
	speed: 0.0032s/iter; left time: 9.9123s
Updating learning rate to 0.00025257388836003416
Validation loss decreased (0.3703 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 1.6732430458068848
Epoch: 2, Steps: 514 | Train Loss: 0.4246754 Vali Loss: 0.3649249 Best vali loss: 0.3649249
	iters: 100, epoch: 3 | loss: 0.3355895
	speed: 0.0070s/iter; left time: 20.9510s
	iters: 200, epoch: 3 | loss: 0.8819111
	speed: 0.0031s/iter; left time: 8.9881s
	iters: 300, epoch: 3 | loss: 0.5051525
	speed: 0.0031s/iter; left time: 8.6846s
	iters: 400, epoch: 3 | loss: 0.5209183
	speed: 0.0031s/iter; left time: 8.3442s
	iters: 500, epoch: 3 | loss: 1.0734055
	speed: 0.0031s/iter; left time: 8.0528s
Updating learning rate to 0.0002045740399676183
Epoch: 3 cost time: 1.6390233039855957
Epoch: 3, Steps: 514 | Train Loss: 0.6633954 Vali Loss: 0.4037933 Best vali loss: 0.3649249
	iters: 100, epoch: 4 | loss: 0.5467940
	speed: 0.0069s/iter; left time: 17.0107s
	iters: 200, epoch: 4 | loss: 0.4422499
	speed: 0.0030s/iter; left time: 7.1017s
	iters: 300, epoch: 4 | loss: 0.4730424
	speed: 0.0029s/iter; left time: 6.6933s
	iters: 400, epoch: 4 | loss: 0.6574202
	speed: 0.0030s/iter; left time: 6.4064s
	iters: 500, epoch: 4 | loss: 0.6813715
	speed: 0.0029s/iter; left time: 6.0987s
Updating learning rate to 0.0001479543583
Epoch: 4 cost time: 1.575594186782837
Epoch: 4, Steps: 514 | Train Loss: 0.5601756 Vali Loss: 0.3878992 Best vali loss: 0.3649249
	iters: 100, epoch: 5 | loss: 0.5196538
	speed: 0.0068s/iter; left time: 13.2265s
	iters: 200, epoch: 5 | loss: 0.7342854
	speed: 0.0032s/iter; left time: 5.9019s
	iters: 300, epoch: 5 | loss: 0.4878450
	speed: 0.0032s/iter; left time: 5.6331s
	iters: 400, epoch: 5 | loss: 0.7085814
	speed: 0.0031s/iter; left time: 5.0732s
	iters: 500, epoch: 5 | loss: 0.4976336
	speed: 0.0031s/iter; left time: 4.8528s
Updating learning rate to 9.133467663238169e-05
Epoch: 5 cost time: 1.661048412322998
Epoch: 5, Steps: 514 | Train Loss: 0.5895998 Vali Loss: 0.3876833 Best vali loss: 0.3649249
	iters: 100, epoch: 6 | loss: 0.3046336
	speed: 0.0071s/iter; left time: 10.2232s
	iters: 200, epoch: 6 | loss: 0.4718375
	speed: 0.0031s/iter; left time: 4.1395s
	iters: 300, epoch: 6 | loss: 0.3657405
	speed: 0.0031s/iter; left time: 3.8611s
	iters: 400, epoch: 6 | loss: 0.7301069
	speed: 0.0031s/iter; left time: 3.5528s
	iters: 500, epoch: 6 | loss: 0.8674988
	speed: 0.0031s/iter; left time: 3.2391s
Updating learning rate to 4.333482823996586e-05
Epoch: 6 cost time: 1.646782636642456
Epoch: 6, Steps: 514 | Train Loss: 0.5479634 Vali Loss: 0.4122360 Best vali loss: 0.3649249
	iters: 100, epoch: 7 | loss: 0.3502099
	speed: 0.0069s/iter; left time: 6.3706s
	iters: 200, epoch: 7 | loss: 0.2863118
	speed: 0.0032s/iter; left time: 2.6701s
	iters: 300, epoch: 7 | loss: 0.3403598
	speed: 0.0031s/iter; left time: 2.2657s
	iters: 400, epoch: 7 | loss: 0.3571392
	speed: 0.0030s/iter; left time: 1.8934s
	iters: 500, epoch: 7 | loss: 0.7071431
	speed: 0.0030s/iter; left time: 1.6128s
Updating learning rate to 1.1262354920788583e-05
Epoch: 7 cost time: 1.6328349113464355
Epoch: 7, Steps: 514 | Train Loss: 0.4082328 Vali Loss: 0.4039896 Best vali loss: 0.3649249
	iters: 100, epoch: 8 | loss: 0.3391981
	speed: 0.0067s/iter; left time: 2.7688s
	iters: 200, epoch: 8 | loss: 0.2066975
	speed: 0.0031s/iter; left time: 0.9655s
	iters: 300, epoch: 8 | loss: 0.3381117
	speed: 0.0032s/iter; left time: 0.6816s
	iters: 400, epoch: 8 | loss: 0.3993452
	speed: 0.0032s/iter; left time: 0.3684s
	iters: 500, epoch: 8 | loss: 0.2024195
	speed: 0.0032s/iter; left time: 0.0474s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6626977920532227
Epoch: 8, Steps: 514 | Train Loss: 0.2971544 Vali Loss: 0.4113861 Best vali loss: 0.3649249

best validation loss 0.3649249189494869

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022141703144, 'e_layers': 2, 'learning_rate': 0.0007070429801, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4484604
	speed: 0.0096s/iter; left time: 38.6444s
	iters: 200, epoch: 1 | loss: 1.0930989
	speed: 0.0032s/iter; left time: 12.5806s
	iters: 300, epoch: 1 | loss: 0.9904489
	speed: 0.0030s/iter; left time: 11.5883s
	iters: 400, epoch: 1 | loss: 0.5294600
	speed: 0.0032s/iter; left time: 11.8281s
	iters: 500, epoch: 1 | loss: 1.2980475
	speed: 0.0031s/iter; left time: 11.3237s
Updating learning rate to 0.0006801327590100875
Validation loss decreased (inf --> 0.3795).  Saving model state dict ...
Epoch: 1 cost time: 2.008833646774292
Epoch: 1, Steps: 514 | Train Loss: 0.8719031 Vali Loss: 0.3794852 Best vali loss: 0.3794852
	iters: 100, epoch: 2 | loss: 0.4049526
	speed: 0.0074s/iter; left time: 25.8057s
	iters: 200, epoch: 2 | loss: 0.2949821
	speed: 0.0032s/iter; left time: 10.7593s
	iters: 300, epoch: 2 | loss: 0.5322120
	speed: 0.0031s/iter; left time: 10.1789s
	iters: 400, epoch: 2 | loss: 0.4045174
	speed: 0.0031s/iter; left time: 9.9211s
	iters: 500, epoch: 2 | loss: 0.6181131
	speed: 0.0031s/iter; left time: 9.6401s
Updating learning rate to 0.0006034989329595276
Validation loss decreased (0.3795 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 1.655468463897705
Epoch: 2, Steps: 514 | Train Loss: 0.4509554 Vali Loss: 0.3740770 Best vali loss: 0.3740770
	iters: 100, epoch: 3 | loss: 0.4000498
	speed: 0.0069s/iter; left time: 20.6245s
	iters: 200, epoch: 3 | loss: 0.8595220
	speed: 0.0031s/iter; left time: 9.0155s
	iters: 300, epoch: 3 | loss: 0.5626037
	speed: 0.0030s/iter; left time: 8.2942s
	iters: 400, epoch: 3 | loss: 0.4598748
	speed: 0.0030s/iter; left time: 8.0355s
	iters: 500, epoch: 3 | loss: 1.3101381
	speed: 0.0031s/iter; left time: 7.9276s
Updating learning rate to 0.000488808307277155
Epoch: 3 cost time: 1.610818862915039
Epoch: 3, Steps: 514 | Train Loss: 0.7184377 Vali Loss: 0.3887247 Best vali loss: 0.3740770
	iters: 100, epoch: 4 | loss: 0.7118605
	speed: 0.0072s/iter; left time: 17.8163s
	iters: 200, epoch: 4 | loss: 0.4975614
	speed: 0.0036s/iter; left time: 8.4870s
	iters: 300, epoch: 4 | loss: 0.6066296
	speed: 0.0034s/iter; left time: 7.6533s
	iters: 400, epoch: 4 | loss: 1.0586449
	speed: 0.0034s/iter; left time: 7.3235s
	iters: 500, epoch: 4 | loss: 0.7545459
	speed: 0.0032s/iter; left time: 6.7269s
Updating learning rate to 0.00035352149005
Epoch: 4 cost time: 1.7953500747680664
Epoch: 4, Steps: 514 | Train Loss: 0.7258484 Vali Loss: 0.3757830 Best vali loss: 0.3740770
	iters: 100, epoch: 5 | loss: 0.5898970
	speed: 0.0072s/iter; left time: 14.1495s
	iters: 200, epoch: 5 | loss: 0.8559403
	speed: 0.0033s/iter; left time: 6.1294s
	iters: 300, epoch: 5 | loss: 0.6072915
	speed: 0.0034s/iter; left time: 5.9284s
	iters: 400, epoch: 5 | loss: 1.0166453
	speed: 0.0034s/iter; left time: 5.6148s
	iters: 500, epoch: 5 | loss: 0.6454706
	speed: 0.0033s/iter; left time: 5.1108s
Updating learning rate to 0.00021823467282284508
Epoch: 5 cost time: 1.747004508972168
Epoch: 5, Steps: 514 | Train Loss: 0.7430489 Vali Loss: 0.3803050 Best vali loss: 0.3740770
	iters: 100, epoch: 6 | loss: 0.2953928
	speed: 0.0073s/iter; left time: 10.5780s
	iters: 200, epoch: 6 | loss: 0.4775863
	speed: 0.0034s/iter; left time: 4.5609s
	iters: 300, epoch: 6 | loss: 0.4375984
	speed: 0.0033s/iter; left time: 4.0442s
	iters: 400, epoch: 6 | loss: 0.7698349
	speed: 0.0033s/iter; left time: 3.7177s
	iters: 500, epoch: 6 | loss: 1.0663180
	speed: 0.0033s/iter; left time: 3.4765s
Updating learning rate to 0.00010354404714047244
Epoch: 6 cost time: 1.7621479034423828
Epoch: 6, Steps: 514 | Train Loss: 0.6093461 Vali Loss: 0.3970009 Best vali loss: 0.3740770
	iters: 100, epoch: 7 | loss: 0.3880756
	speed: 0.0076s/iter; left time: 7.0592s
	iters: 200, epoch: 7 | loss: 0.3285991
	speed: 0.0036s/iter; left time: 2.9528s
	iters: 300, epoch: 7 | loss: 0.3929406
	speed: 0.0035s/iter; left time: 2.5790s
	iters: 400, epoch: 7 | loss: 0.4369214
	speed: 0.0035s/iter; left time: 2.2179s
	iters: 500, epoch: 7 | loss: 0.8443598
	speed: 0.0032s/iter; left time: 1.6867s
Updating learning rate to 2.6910221089912496e-05
Epoch: 7 cost time: 1.832514762878418
Epoch: 7, Steps: 514 | Train Loss: 0.4781793 Vali Loss: 0.3848579 Best vali loss: 0.3740770
	iters: 100, epoch: 8 | loss: 0.3924083
	speed: 0.0075s/iter; left time: 3.1162s
	iters: 200, epoch: 8 | loss: 0.2434786
	speed: 0.0035s/iter; left time: 1.0906s
	iters: 300, epoch: 8 | loss: 0.3855956
	speed: 0.0032s/iter; left time: 0.6912s
	iters: 400, epoch: 8 | loss: 0.4476297
	speed: 0.0032s/iter; left time: 0.3687s
	iters: 500, epoch: 8 | loss: 0.2647581
	speed: 0.0032s/iter; left time: 0.0485s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7512898445129395
Epoch: 8, Steps: 514 | Train Loss: 0.3467741 Vali Loss: 0.3917312 Best vali loss: 0.3740770

best validation loss 0.3740770087377964

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141053352, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3820).  Saving model state dict ...
Epoch: 1 cost time: 1.315272331237793
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3820236 Best vali loss: 0.3820236
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 1.005479097366333
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3904316 Best vali loss: 0.3820236
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3820 --> 0.3812).  Saving model state dict ...
Epoch: 3 cost time: 1.0097792148590088
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3811878 Best vali loss: 0.3811878

best validation loss 0.3811877909132914

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022140228266, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3821).  Saving model state dict ...
Epoch: 1 cost time: 1.3238904476165771
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3821053 Best vali loss: 0.3821053
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 1.015805959701538
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3871701 Best vali loss: 0.3821053
Updating learning rate to 0.000176756302025
Epoch: 3 cost time: 1.0103166103363037
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3857212 Best vali loss: 0.3821053

best validation loss 0.3821053003749585

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050730104466, 'e_layers': 4, 'learning_rate': 0.0006749036916, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006749036916
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 1.1007308959960938
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3692659 Best vali loss: 0.3692659
Updating learning rate to 0.0003374518458
Validation loss decreased (0.3693 --> 0.3578).  Saving model state dict ...
Epoch: 2 cost time: 0.7853899002075195
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3577851 Best vali loss: 0.3577851
Updating learning rate to 0.0001687259229
Validation loss decreased (0.3578 --> 0.3562).  Saving model state dict ...
Epoch: 3 cost time: 0.7848711013793945
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3562362 Best vali loss: 0.3562362

best validation loss 0.3562361845450223

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050730104466, 'e_layers': 4, 'learning_rate': 0.0006749036916, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.436296145e-05
Validation loss decreased (0.3562 --> 0.3488).  Saving model state dict ...
Epoch: 4 cost time: 1.098445177078247
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3488238 Best vali loss: 0.3488238
Updating learning rate to 4.2181480725e-05
Validation loss decreased (0.3488 --> 0.3474).  Saving model state dict ...
Epoch: 5 cost time: 0.7801270484924316
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3474296 Best vali loss: 0.3474296
Updating learning rate to 2.10907403625e-05
Validation loss decreased (0.3474 --> 0.3437).  Saving model state dict ...
Epoch: 6 cost time: 0.7814180850982666
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3436503 Best vali loss: 0.3436503
Updating learning rate to 1.054537018125e-05
Validation loss decreased (0.3437 --> 0.3427).  Saving model state dict ...
Epoch: 7 cost time: 0.7819309234619141
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3427173 Best vali loss: 0.3427173
Updating learning rate to 5.272685090625e-06
Epoch: 8 cost time: 0.7840030193328857
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3428863 Best vali loss: 0.3427173

best validation loss 0.3427172679798074

[INFO][smbo.py:320] Finished 1300 trials.
{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0084402086488, 'e_layers': 4, 'learning_rate': 0.0007281693766, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5579622
	speed: 0.0120s/iter; left time: 11.2203s
Updating learning rate to 0.0007004550799211215
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 1.1111204624176025
Epoch: 1, Steps: 129 | Train Loss: 0.5579622 Vali Loss: 0.3677698 Best vali loss: 0.3677698
	iters: 100, epoch: 2 | loss: 0.6835313
	speed: 0.0091s/iter; left time: 7.3039s
Updating learning rate to 0.0006215314403231204
Validation loss decreased (0.3678 --> 0.3529).  Saving model state dict ...
Epoch: 2 cost time: 0.7295396327972412
Epoch: 2, Steps: 129 | Train Loss: 0.6835313 Vali Loss: 0.3529124 Best vali loss: 0.3529124
	iters: 100, epoch: 3 | loss: 0.5080359
	speed: 0.0096s/iter; left time: 6.4539s
Updating learning rate to 0.0005034138664902179
Epoch: 3 cost time: 0.7963800430297852
Epoch: 3, Steps: 129 | Train Loss: 0.5080359 Vali Loss: 0.3723623 Best vali loss: 0.3529124
	iters: 100, epoch: 4 | loss: 0.5234744
	speed: 0.0093s/iter; left time: 5.0701s
Updating learning rate to 0.0003640846883
Epoch: 4 cost time: 0.7679927349090576
Epoch: 4, Steps: 129 | Train Loss: 0.5234744 Vali Loss: 0.3679427 Best vali loss: 0.3529124
	iters: 100, epoch: 5 | loss: 0.4911949
	speed: 0.0091s/iter; left time: 3.7922s
Updating learning rate to 0.00022475551010978217
Epoch: 5 cost time: 0.7405831813812256
Epoch: 5, Steps: 129 | Train Loss: 0.4911949 Vali Loss: 0.3758820 Best vali loss: 0.3529124
	iters: 100, epoch: 6 | loss: 0.5288514
	speed: 0.0095s/iter; left time: 2.7310s
Updating learning rate to 0.00010663793627687956
Epoch: 6 cost time: 0.8073604106903076
Epoch: 6, Steps: 129 | Train Loss: 0.5288514 Vali Loss: 0.3755021 Best vali loss: 0.3529124
	iters: 100, epoch: 7 | loss: 0.4818165
	speed: 0.0091s/iter; left time: 1.4459s
Updating learning rate to 2.771429667887845e-05
Epoch: 7 cost time: 0.7260928153991699
Epoch: 7, Steps: 129 | Train Loss: 0.4818165 Vali Loss: 0.3921280 Best vali loss: 0.3529124
	iters: 100, epoch: 8 | loss: 0.3145869
	speed: 0.0089s/iter; left time: 0.2658s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.718146800994873
Epoch: 8, Steps: 129 | Train Loss: 0.3145869 Vali Loss: 0.3899312 Best vali loss: 0.3529124

best validation loss 0.35291239104008626

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022918445222, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006805626573947573
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.1072266101837158
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669496 Best vali loss: 0.3669496
Updating learning rate to 0.0006038803926275002
Epoch: 2 cost time: 0.7857856750488281
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3741558 Best vali loss: 0.3669496
Updating learning rate to 0.0004891172732825823
Validation loss decreased (0.3669 --> 0.3557).  Saving model state dict ...
Epoch: 3 cost time: 0.7884037494659424
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3557369 Best vali loss: 0.3557369
Updating learning rate to 0.00035374494395
Validation loss decreased (0.3557 --> 0.3492).  Saving model state dict ...
Epoch: 4 cost time: 0.7916505336761475
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3492348 Best vali loss: 0.3492348
Updating learning rate to 0.0002183726146174177
Validation loss decreased (0.3492 --> 0.3442).  Saving model state dict ...
Epoch: 5 cost time: 0.7905566692352295
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3442141 Best vali loss: 0.3442141
Updating learning rate to 0.00010360949527249985
Epoch: 6 cost time: 0.7921905517578125
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3450434 Best vali loss: 0.3442141
Updating learning rate to 2.692723050524267e-05
Epoch: 7 cost time: 0.7956063747406006
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3537725 Best vali loss: 0.3442141
Updating learning rate to 0.0
Epoch: 8 cost time: 0.797224760055542
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3564049 Best vali loss: 0.3442141

best validation loss 0.3442141232532696

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0060113242631, 'e_layers': 2, 'learning_rate': 0.000264884955, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3949946
	speed: 0.0097s/iter; left time: 78.4437s
	iters: 200, epoch: 1 | loss: 0.3705950
	speed: 0.0033s/iter; left time: 26.4929s
	iters: 300, epoch: 1 | loss: 0.6924557
	speed: 0.0033s/iter; left time: 26.4418s
	iters: 400, epoch: 1 | loss: 0.4530273
	speed: 0.0033s/iter; left time: 26.0271s
	iters: 500, epoch: 1 | loss: 0.1543489
	speed: 0.0033s/iter; left time: 25.7962s
	iters: 600, epoch: 1 | loss: 0.2436895
	speed: 0.0033s/iter; left time: 25.3922s
	iters: 700, epoch: 1 | loss: 0.2919532
	speed: 0.0034s/iter; left time: 25.3065s
	iters: 800, epoch: 1 | loss: 1.0586452
	speed: 0.0033s/iter; left time: 24.2653s
	iters: 900, epoch: 1 | loss: 0.3967177
	speed: 0.0031s/iter; left time: 23.0213s
	iters: 1000, epoch: 1 | loss: 1.0743111
	speed: 0.0031s/iter; left time: 22.6768s
Updating learning rate to 0.0002548033716973366
Validation loss decreased (inf --> 0.3850).  Saving model state dict ...
Epoch: 1 cost time: 3.728634834289551
Epoch: 1, Steps: 1027 | Train Loss: 0.5130738 Vali Loss: 0.3849524 Best vali loss: 0.3849524
	iters: 100, epoch: 2 | loss: 0.7451239
	speed: 0.0097s/iter; left time: 68.8068s
	iters: 200, epoch: 2 | loss: 0.4603458
	speed: 0.0034s/iter; left time: 23.5571s
	iters: 300, epoch: 2 | loss: 0.3814828
	speed: 0.0034s/iter; left time: 23.2265s
	iters: 400, epoch: 2 | loss: 0.4501983
	speed: 0.0034s/iter; left time: 22.8070s
	iters: 500, epoch: 2 | loss: 0.2747267
	speed: 0.0033s/iter; left time: 22.2991s
	iters: 600, epoch: 2 | loss: 0.2536478
	speed: 0.0034s/iter; left time: 22.2048s
	iters: 700, epoch: 2 | loss: 0.4696005
	speed: 0.0033s/iter; left time: 21.6408s
	iters: 800, epoch: 2 | loss: 0.2115422
	speed: 0.0033s/iter; left time: 21.3270s
	iters: 900, epoch: 2 | loss: 0.5347566
	speed: 0.0034s/iter; left time: 21.1604s
	iters: 1000, epoch: 2 | loss: 1.3127239
	speed: 0.0033s/iter; left time: 20.6238s
Updating learning rate to 0.0002260934514573967
Epoch: 2 cost time: 3.4872913360595703
Epoch: 2, Steps: 1027 | Train Loss: 0.5094149 Vali Loss: 0.3861359 Best vali loss: 0.3849524
	iters: 100, epoch: 3 | loss: 0.2915845
	speed: 0.0093s/iter; left time: 56.3799s
	iters: 200, epoch: 3 | loss: 0.2543684
	speed: 0.0034s/iter; left time: 19.9876s
	iters: 300, epoch: 3 | loss: 0.3101032
	speed: 0.0034s/iter; left time: 19.7828s
	iters: 400, epoch: 3 | loss: 0.5323311
	speed: 0.0034s/iter; left time: 19.6416s
	iters: 500, epoch: 3 | loss: 1.1723778
	speed: 0.0034s/iter; left time: 18.9771s
	iters: 600, epoch: 3 | loss: 0.5606393
	speed: 0.0033s/iter; left time: 18.2302s
	iters: 700, epoch: 3 | loss: 0.5291664
	speed: 0.0029s/iter; left time: 15.6156s
	iters: 800, epoch: 3 | loss: 0.2655698
	speed: 0.0028s/iter; left time: 15.1348s
	iters: 900, epoch: 3 | loss: 0.2666676
	speed: 0.0028s/iter; left time: 14.9776s
	iters: 1000, epoch: 3 | loss: 0.7279839
	speed: 0.0029s/iter; left time: 15.1792s
Updating learning rate to 0.00018312601938063618
Validation loss decreased (0.3850 --> 0.3738).  Saving model state dict ...
Epoch: 3 cost time: 3.267374038696289
Epoch: 3, Steps: 1027 | Train Loss: 0.4910792 Vali Loss: 0.3738144 Best vali loss: 0.3738144

best validation loss 0.3738144355579069

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0041988074629, 'e_layers': 2, 'learning_rate': 0.00034995295, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3813720
	speed: 0.0094s/iter; left time: 75.9620s
	iters: 200, epoch: 1 | loss: 0.3741811
	speed: 0.0031s/iter; left time: 25.1847s
	iters: 300, epoch: 1 | loss: 0.7466062
	speed: 0.0032s/iter; left time: 24.9910s
	iters: 400, epoch: 1 | loss: 0.4431538
	speed: 0.0031s/iter; left time: 24.4142s
	iters: 500, epoch: 1 | loss: 0.1511386
	speed: 0.0031s/iter; left time: 24.1441s
	iters: 600, epoch: 1 | loss: 0.2589209
	speed: 0.0031s/iter; left time: 23.8359s
	iters: 700, epoch: 1 | loss: 0.3090712
	speed: 0.0031s/iter; left time: 23.5654s
	iters: 800, epoch: 1 | loss: 1.1170262
	speed: 0.0031s/iter; left time: 23.3519s
	iters: 900, epoch: 1 | loss: 0.3729217
	speed: 0.0031s/iter; left time: 23.0416s
	iters: 1000, epoch: 1 | loss: 1.0726355
	speed: 0.0032s/iter; left time: 22.7657s
Updating learning rate to 0.00033663365892347283
Validation loss decreased (inf --> 0.3730).  Saving model state dict ...
Epoch: 1 cost time: 3.5706419944763184
Epoch: 1, Steps: 1027 | Train Loss: 0.5227027 Vali Loss: 0.3729976 Best vali loss: 0.3729976
	iters: 100, epoch: 2 | loss: 0.6791295
	speed: 0.0095s/iter; left time: 67.3644s
	iters: 200, epoch: 2 | loss: 0.4328915
	speed: 0.0032s/iter; left time: 22.3060s
	iters: 300, epoch: 2 | loss: 0.4241064
	speed: 0.0032s/iter; left time: 22.0214s
	iters: 400, epoch: 2 | loss: 0.4724330
	speed: 0.0032s/iter; left time: 21.6109s
	iters: 500, epoch: 2 | loss: 0.2924280
	speed: 0.0032s/iter; left time: 21.4049s
	iters: 600, epoch: 2 | loss: 0.2597823
	speed: 0.0032s/iter; left time: 21.1947s
	iters: 700, epoch: 2 | loss: 0.5336038
	speed: 0.0032s/iter; left time: 20.7427s
	iters: 800, epoch: 2 | loss: 0.2306119
	speed: 0.0032s/iter; left time: 20.1739s
	iters: 900, epoch: 2 | loss: 0.5701042
	speed: 0.0032s/iter; left time: 20.1126s
	iters: 1000, epoch: 2 | loss: 1.4693573
	speed: 0.0032s/iter; left time: 19.8478s
Updating learning rate to 0.0002987035270206184
Epoch: 2 cost time: 3.3332126140594482
Epoch: 2, Steps: 1027 | Train Loss: 0.5364448 Vali Loss: 0.3797715 Best vali loss: 0.3729976
	iters: 100, epoch: 3 | loss: 0.2520694
	speed: 0.0092s/iter; left time: 55.7752s
	iters: 200, epoch: 3 | loss: 0.2549996
	speed: 0.0033s/iter; left time: 19.7374s
	iters: 300, epoch: 3 | loss: 0.2823872
	speed: 0.0034s/iter; left time: 19.7757s
	iters: 400, epoch: 3 | loss: 0.5092576
	speed: 0.0033s/iter; left time: 18.7990s
	iters: 500, epoch: 3 | loss: 1.1357422
	speed: 0.0032s/iter; left time: 17.8953s
	iters: 600, epoch: 3 | loss: 0.5647010
	speed: 0.0032s/iter; left time: 17.5420s
	iters: 700, epoch: 3 | loss: 0.5270094
	speed: 0.0032s/iter; left time: 17.2405s
	iters: 800, epoch: 3 | loss: 0.2496223
	speed: 0.0031s/iter; left time: 16.8688s
	iters: 900, epoch: 3 | loss: 0.3254981
	speed: 0.0032s/iter; left time: 16.6253s
	iters: 1000, epoch: 3 | loss: 0.7418338
	speed: 0.0032s/iter; left time: 16.3211s
Updating learning rate to 0.00024193707303614434
Epoch: 3 cost time: 3.321734666824341
Epoch: 3, Steps: 1027 | Train Loss: 0.4843120 Vali Loss: 0.3872344 Best vali loss: 0.3729976

best validation loss 0.37299758954109047

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021930597417, 'e_layers': 2, 'learning_rate': 0.0004096946061, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8049518
	speed: 0.0096s/iter; left time: 38.7016s
	iters: 200, epoch: 1 | loss: 0.3314777
	speed: 0.0032s/iter; left time: 12.3433s
	iters: 300, epoch: 1 | loss: 0.5310535
	speed: 0.0030s/iter; left time: 11.5251s
	iters: 400, epoch: 1 | loss: 1.0619321
	speed: 0.0030s/iter; left time: 11.1712s
	iters: 500, epoch: 1 | loss: 0.9042682
	speed: 0.0030s/iter; left time: 10.7913s
Updating learning rate to 0.0003941015336280319
Validation loss decreased (inf --> 0.3811).  Saving model state dict ...
Epoch: 1 cost time: 1.9429588317871094
Epoch: 1, Steps: 514 | Train Loss: 0.7267367 Vali Loss: 0.3811250 Best vali loss: 0.3811250
	iters: 100, epoch: 2 | loss: 1.1715491
	speed: 0.0067s/iter; left time: 23.5886s
	iters: 200, epoch: 2 | loss: 0.6318141
	speed: 0.0029s/iter; left time: 9.9983s
	iters: 300, epoch: 2 | loss: 0.7051538
	speed: 0.0030s/iter; left time: 10.0030s
	iters: 400, epoch: 2 | loss: 0.5999509
	speed: 0.0031s/iter; left time: 9.8133s
	iters: 500, epoch: 2 | loss: 0.6765429
	speed: 0.0030s/iter; left time: 9.4133s
Updating learning rate to 0.0003496962201444307
Validation loss decreased (0.3811 --> 0.3587).  Saving model state dict ...
Epoch: 2 cost time: 1.595357894897461
Epoch: 2, Steps: 514 | Train Loss: 0.7570021 Vali Loss: 0.3586754 Best vali loss: 0.3586754
	iters: 100, epoch: 3 | loss: 0.4652509
	speed: 0.0072s/iter; left time: 21.3787s
	iters: 200, epoch: 3 | loss: 0.5560114
	speed: 0.0032s/iter; left time: 9.1705s
	iters: 300, epoch: 3 | loss: 0.5078422
	speed: 0.0031s/iter; left time: 8.7099s
	iters: 400, epoch: 3 | loss: 0.4893735
	speed: 0.0032s/iter; left time: 8.5435s
	iters: 500, epoch: 3 | loss: 1.0295777
	speed: 0.0031s/iter; left time: 7.9844s
Updating learning rate to 0.0002832389720919057
Validation loss decreased (0.3587 --> 0.3586).  Saving model state dict ...
Epoch: 3 cost time: 1.6716134548187256
Epoch: 3, Steps: 514 | Train Loss: 0.6096112 Vali Loss: 0.3586246 Best vali loss: 0.3586246

best validation loss 0.3586245647757836

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021930597417, 'e_layers': 2, 'learning_rate': 0.0004096946061, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5625921
	speed: 0.0096s/iter; left time: 23.8181s
	iters: 200, epoch: 4 | loss: 0.2939823
	speed: 0.0032s/iter; left time: 7.5353s
	iters: 300, epoch: 4 | loss: 0.3447098
	speed: 0.0031s/iter; left time: 7.1025s
	iters: 400, epoch: 4 | loss: 0.7654845
	speed: 0.0031s/iter; left time: 6.6850s
	iters: 500, epoch: 4 | loss: 0.8925050
	speed: 0.0031s/iter; left time: 6.3536s
Updating learning rate to 0.00020484730305
Epoch: 4 cost time: 1.96226167678833
Epoch: 4, Steps: 514 | Train Loss: 0.5718548 Vali Loss: 0.3920781 Best vali loss: 0.3586246
	iters: 100, epoch: 5 | loss: 0.7958706
	speed: 0.0068s/iter; left time: 13.2789s
	iters: 200, epoch: 5 | loss: 0.4638743
	speed: 0.0031s/iter; left time: 5.6858s
	iters: 300, epoch: 5 | loss: 0.6052909
	speed: 0.0030s/iter; left time: 5.2872s
	iters: 400, epoch: 5 | loss: 0.4734425
	speed: 0.0030s/iter; left time: 4.9450s
	iters: 500, epoch: 5 | loss: 0.5767894
	speed: 0.0031s/iter; left time: 4.8321s
Updating learning rate to 0.0001264556340080943
Validation loss decreased (0.3586 --> 0.3555).  Saving model state dict ...
Epoch: 5 cost time: 1.6032617092132568
Epoch: 5, Steps: 514 | Train Loss: 0.5830536 Vali Loss: 0.3554545 Best vali loss: 0.3554545
	iters: 100, epoch: 6 | loss: 0.3544862
	speed: 0.0077s/iter; left time: 11.1027s
	iters: 200, epoch: 6 | loss: 0.3100841
	speed: 0.0032s/iter; left time: 4.2362s
	iters: 300, epoch: 6 | loss: 0.4679036
	speed: 0.0031s/iter; left time: 3.8086s
	iters: 400, epoch: 6 | loss: 0.4391379
	speed: 0.0031s/iter; left time: 3.5362s
	iters: 500, epoch: 6 | loss: 0.6851631
	speed: 0.0031s/iter; left time: 3.1813s
Updating learning rate to 5.999838595556927e-05
Epoch: 6 cost time: 1.6827507019042969
Epoch: 6, Steps: 514 | Train Loss: 0.4513550 Vali Loss: 0.3577658 Best vali loss: 0.3554545
	iters: 100, epoch: 7 | loss: 0.3337284
	speed: 0.0067s/iter; left time: 6.2616s
	iters: 200, epoch: 7 | loss: 0.3609617
	speed: 0.0030s/iter; left time: 2.5275s
	iters: 300, epoch: 7 | loss: 0.3566970
	speed: 0.0031s/iter; left time: 2.2906s
	iters: 400, epoch: 7 | loss: 0.3612672
	speed: 0.0030s/iter; left time: 1.9089s
	iters: 500, epoch: 7 | loss: 0.2851009
	speed: 0.0030s/iter; left time: 1.6053s
Updating learning rate to 1.559307247196812e-05
Epoch: 7 cost time: 1.6127729415893555
Epoch: 7, Steps: 514 | Train Loss: 0.3395510 Vali Loss: 0.3584092 Best vali loss: 0.3554545
	iters: 100, epoch: 8 | loss: 0.3410753
	speed: 0.0069s/iter; left time: 2.8483s
	iters: 200, epoch: 8 | loss: 0.4501374
	speed: 0.0032s/iter; left time: 1.0217s
	iters: 300, epoch: 8 | loss: 0.2358934
	speed: 0.0033s/iter; left time: 0.6993s
	iters: 400, epoch: 8 | loss: 0.2852822
	speed: 0.0033s/iter; left time: 0.3747s
	iters: 500, epoch: 8 | loss: 0.4179547
	speed: 0.0029s/iter; left time: 0.0440s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6676528453826904
Epoch: 8, Steps: 514 | Train Loss: 0.3460686 Vali Loss: 0.3561123 Best vali loss: 0.3554545

best validation loss 0.3554545077804498

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021926581862, 'e_layers': 2, 'learning_rate': 0.0004097216472, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8049607
	speed: 0.0097s/iter; left time: 39.1043s
	iters: 200, epoch: 1 | loss: 0.3314968
	speed: 0.0035s/iter; left time: 13.8604s
	iters: 300, epoch: 1 | loss: 0.5311944
	speed: 0.0035s/iter; left time: 13.4723s
	iters: 400, epoch: 1 | loss: 1.0648263
	speed: 0.0033s/iter; left time: 12.3415s
	iters: 500, epoch: 1 | loss: 0.9320619
	speed: 0.0033s/iter; left time: 12.0339s
Updating learning rate to 0.0003941275455374452
Validation loss decreased (inf --> 0.3849).  Saving model state dict ...
Epoch: 1 cost time: 2.1222140789031982
Epoch: 1, Steps: 514 | Train Loss: 0.7329080 Vali Loss: 0.3849472 Best vali loss: 0.3849472
	iters: 100, epoch: 2 | loss: 1.3453649
	speed: 0.0077s/iter; left time: 26.9750s
	iters: 200, epoch: 2 | loss: 0.6894631
	speed: 0.0036s/iter; left time: 12.1336s
	iters: 300, epoch: 2 | loss: 0.6610102
	speed: 0.0035s/iter; left time: 11.5413s
	iters: 400, epoch: 2 | loss: 0.6061005
	speed: 0.0034s/iter; left time: 10.7652s
	iters: 500, epoch: 2 | loss: 0.6754349
	speed: 0.0033s/iter; left time: 10.3134s
Updating learning rate to 0.00034971930116702113
Validation loss decreased (0.3849 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 1.8275277614593506
Epoch: 2, Steps: 514 | Train Loss: 0.7954747 Vali Loss: 0.3672544 Best vali loss: 0.3672544
	iters: 100, epoch: 3 | loss: 0.4795328
	speed: 0.0077s/iter; left time: 22.8700s
	iters: 200, epoch: 3 | loss: 0.4334321
	speed: 0.0035s/iter; left time: 10.2276s
	iters: 300, epoch: 3 | loss: 0.5156490
	speed: 0.0035s/iter; left time: 9.7386s
	iters: 400, epoch: 3 | loss: 0.5102693
	speed: 0.0034s/iter; left time: 9.1156s
	iters: 500, epoch: 3 | loss: 0.9851720
	speed: 0.0034s/iter; left time: 8.8013s
Updating learning rate to 0.0002832576667323872
Validation loss decreased (0.3673 --> 0.3594).  Saving model state dict ...
Epoch: 3 cost time: 1.8345682621002197
Epoch: 3, Steps: 514 | Train Loss: 0.5848110 Vali Loss: 0.3594302 Best vali loss: 0.3594302
	iters: 100, epoch: 4 | loss: 0.4297137
	speed: 0.0074s/iter; left time: 18.3508s
	iters: 200, epoch: 4 | loss: 0.5140940
	speed: 0.0034s/iter; left time: 8.0720s
	iters: 300, epoch: 4 | loss: 0.3989039
	speed: 0.0034s/iter; left time: 7.7188s
	iters: 400, epoch: 4 | loss: 0.3985122
	speed: 0.0033s/iter; left time: 7.2290s
	iters: 500, epoch: 4 | loss: 0.3499873
	speed: 0.0035s/iter; left time: 7.1701s
Updating learning rate to 0.0002048608236
Validation loss decreased (0.3594 --> 0.3591).  Saving model state dict ...
Epoch: 4 cost time: 1.7954635620117188
Epoch: 4, Steps: 514 | Train Loss: 0.4182422 Vali Loss: 0.3591109 Best vali loss: 0.3591109
	iters: 100, epoch: 5 | loss: 0.4174874
	speed: 0.0073s/iter; left time: 14.2999s
	iters: 200, epoch: 5 | loss: 0.6616714
	speed: 0.0033s/iter; left time: 6.1350s
	iters: 300, epoch: 5 | loss: 0.2516047
	speed: 0.0033s/iter; left time: 5.8223s
	iters: 400, epoch: 5 | loss: 0.3466352
	speed: 0.0033s/iter; left time: 5.3908s
	iters: 500, epoch: 5 | loss: 0.4353521
	speed: 0.0032s/iter; left time: 4.9722s
Updating learning rate to 0.00012646398046761283
Validation loss decreased (0.3591 --> 0.3473).  Saving model state dict ...
Epoch: 5 cost time: 1.7249033451080322
Epoch: 5, Steps: 514 | Train Loss: 0.4225501 Vali Loss: 0.3473407 Best vali loss: 0.3473407
	iters: 100, epoch: 6 | loss: 0.3617647
	speed: 0.0076s/iter; left time: 11.0231s
	iters: 200, epoch: 6 | loss: 0.3330171
	speed: 0.0036s/iter; left time: 4.8152s
	iters: 300, epoch: 6 | loss: 0.2713069
	speed: 0.0035s/iter; left time: 4.3064s
	iters: 400, epoch: 6 | loss: 0.5256724
	speed: 0.0033s/iter; left time: 3.8286s
	iters: 500, epoch: 6 | loss: 0.5742161
	speed: 0.0034s/iter; left time: 3.5335s
Updating learning rate to 6.00023460329789e-05
Epoch: 6 cost time: 1.8303377628326416
Epoch: 6, Steps: 514 | Train Loss: 0.4131954 Vali Loss: 0.3518959 Best vali loss: 0.3473407
	iters: 100, epoch: 7 | loss: 0.3795581
	speed: 0.0074s/iter; left time: 6.8747s
	iters: 200, epoch: 7 | loss: 0.2398368
	speed: 0.0035s/iter; left time: 2.8670s
	iters: 300, epoch: 7 | loss: 0.5108824
	speed: 0.0035s/iter; left time: 2.5638s
	iters: 400, epoch: 7 | loss: 0.4697253
	speed: 0.0034s/iter; left time: 2.1115s
	iters: 500, epoch: 7 | loss: 0.3444388
	speed: 0.0032s/iter; left time: 1.6709s
Updating learning rate to 1.5594101662554822e-05
Epoch: 7 cost time: 1.793858528137207
Epoch: 7, Steps: 514 | Train Loss: 0.3888883 Vali Loss: 0.3510146 Best vali loss: 0.3473407
	iters: 100, epoch: 8 | loss: 0.2393664
	speed: 0.0070s/iter; left time: 2.9059s
	iters: 200, epoch: 8 | loss: 0.4248170
	speed: 0.0033s/iter; left time: 1.0350s
	iters: 300, epoch: 8 | loss: 0.6111705
	speed: 0.0032s/iter; left time: 0.6923s
	iters: 400, epoch: 8 | loss: 0.6084297
	speed: 0.0032s/iter; left time: 0.3692s
	iters: 500, epoch: 8 | loss: 0.3852624
	speed: 0.0032s/iter; left time: 0.0473s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6995189189910889
Epoch: 8, Steps: 514 | Train Loss: 0.4538092 Vali Loss: 0.3499515 Best vali loss: 0.3473407

best validation loss 0.34734068414551333

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0021931125712, 'e_layers': 3, 'learning_rate': 0.0004082403862, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4286216
	speed: 0.0105s/iter; left time: 41.9830s
	iters: 200, epoch: 1 | loss: 0.8080392
	speed: 0.0045s/iter; left time: 17.4603s
	iters: 300, epoch: 1 | loss: 0.4951110
	speed: 0.0044s/iter; left time: 16.7698s
	iters: 400, epoch: 1 | loss: 0.7331955
	speed: 0.0043s/iter; left time: 15.9349s
	iters: 500, epoch: 1 | loss: 0.6075333
	speed: 0.0043s/iter; left time: 15.3728s
Updating learning rate to 0.0003927026616773416
Validation loss decreased (inf --> 0.3743).  Saving model state dict ...
Epoch: 1 cost time: 2.5788047313690186
Epoch: 1, Steps: 514 | Train Loss: 0.6145001 Vali Loss: 0.3742979 Best vali loss: 0.3742979
	iters: 100, epoch: 2 | loss: 0.6627322
	speed: 0.0087s/iter; left time: 30.5772s
	iters: 200, epoch: 2 | loss: 0.4861127
	speed: 0.0044s/iter; left time: 15.1101s
	iters: 300, epoch: 2 | loss: 0.5673768
	speed: 0.0043s/iter; left time: 14.1752s
	iters: 400, epoch: 2 | loss: 0.6263490
	speed: 0.0045s/iter; left time: 14.2706s
	iters: 500, epoch: 2 | loss: 0.7317221
	speed: 0.0042s/iter; left time: 12.9296s
Updating learning rate to 0.00034845496581811753
Epoch: 2 cost time: 2.270242691040039
Epoch: 2, Steps: 514 | Train Loss: 0.6148586 Vali Loss: 0.3780286 Best vali loss: 0.3742979
	iters: 100, epoch: 3 | loss: 0.3513109
	speed: 0.0087s/iter; left time: 25.9763s
	iters: 200, epoch: 3 | loss: 0.5600333
	speed: 0.0044s/iter; left time: 12.8373s
	iters: 300, epoch: 3 | loss: 0.8793983
	speed: 0.0043s/iter; left time: 11.9944s
	iters: 400, epoch: 3 | loss: 0.5718039
	speed: 0.0042s/iter; left time: 11.3315s
	iters: 500, epoch: 3 | loss: 1.0535481
	speed: 0.0039s/iter; left time: 10.1487s
Updating learning rate to 0.00028223360921053294
Epoch: 3 cost time: 2.227729558944702
Epoch: 3, Steps: 514 | Train Loss: 0.6832189 Vali Loss: 0.3762082 Best vali loss: 0.3742979
	iters: 100, epoch: 4 | loss: 0.3321831
	speed: 0.0085s/iter; left time: 20.9509s
	iters: 200, epoch: 4 | loss: 0.6462600
	speed: 0.0041s/iter; left time: 9.6727s
	iters: 300, epoch: 4 | loss: 0.7202249
	speed: 0.0042s/iter; left time: 9.4990s
	iters: 400, epoch: 4 | loss: 0.6116585
	speed: 0.0040s/iter; left time: 8.6428s
	iters: 500, epoch: 4 | loss: 0.5555706
	speed: 0.0041s/iter; left time: 8.5558s
Updating learning rate to 0.0002041201931
Epoch: 4 cost time: 2.153809070587158
Epoch: 4, Steps: 514 | Train Loss: 0.5731794 Vali Loss: 0.3894885 Best vali loss: 0.3742979
	iters: 100, epoch: 5 | loss: 0.7076107
	speed: 0.0083s/iter; left time: 16.2417s
	iters: 200, epoch: 5 | loss: 0.6520025
	speed: 0.0041s/iter; left time: 7.6085s
	iters: 300, epoch: 5 | loss: 0.4166909
	speed: 0.0038s/iter; left time: 6.7520s
	iters: 400, epoch: 5 | loss: 0.5099998
	speed: 0.0040s/iter; left time: 6.6429s
	iters: 500, epoch: 5 | loss: 0.5354462
	speed: 0.0041s/iter; left time: 6.3424s
Updating learning rate to 0.0001260067769894671
Epoch: 5 cost time: 2.11725115776062
Epoch: 5, Steps: 514 | Train Loss: 0.5643500 Vali Loss: 0.3769384 Best vali loss: 0.3742979
	iters: 100, epoch: 6 | loss: 0.7516604
	speed: 0.0081s/iter; left time: 11.7292s
	iters: 200, epoch: 6 | loss: 0.7360279
	speed: 0.0040s/iter; left time: 5.3679s
	iters: 300, epoch: 6 | loss: 0.5957269
	speed: 0.0040s/iter; left time: 5.0055s
	iters: 400, epoch: 6 | loss: 0.2806931
	speed: 0.0042s/iter; left time: 4.8076s
	iters: 500, epoch: 6 | loss: 0.3724075
	speed: 0.0043s/iter; left time: 4.4415s
Updating learning rate to 5.978542038188249e-05
Validation loss decreased (0.3743 --> 0.3702).  Saving model state dict ...
Epoch: 6 cost time: 2.1399238109588623
Epoch: 6, Steps: 514 | Train Loss: 0.5473032 Vali Loss: 0.3701859 Best vali loss: 0.3701859
	iters: 100, epoch: 7 | loss: 0.5029272
	speed: 0.0085s/iter; left time: 7.8754s
	iters: 200, epoch: 7 | loss: 0.3578952
	speed: 0.0041s/iter; left time: 3.3828s
	iters: 300, epoch: 7 | loss: 0.3772950
	speed: 0.0038s/iter; left time: 2.7685s
	iters: 400, epoch: 7 | loss: 0.3949937
	speed: 0.0040s/iter; left time: 2.4900s
	iters: 500, epoch: 7 | loss: 0.3923561
	speed: 0.0040s/iter; left time: 2.1157s
Updating learning rate to 1.5537724522658425e-05
Epoch: 7 cost time: 2.0816478729248047
Epoch: 7, Steps: 514 | Train Loss: 0.4050935 Vali Loss: 0.3751749 Best vali loss: 0.3701859
	iters: 100, epoch: 8 | loss: 0.6112790
	speed: 0.0086s/iter; left time: 3.5739s
	iters: 200, epoch: 8 | loss: 0.7089649
	speed: 0.0041s/iter; left time: 1.2827s
	iters: 300, epoch: 8 | loss: 0.5079325
	speed: 0.0040s/iter; left time: 0.8536s
	iters: 400, epoch: 8 | loss: 0.7411563
	speed: 0.0039s/iter; left time: 0.4538s
	iters: 500, epoch: 8 | loss: 0.5497564
	speed: 0.0040s/iter; left time: 0.0606s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.113103151321411
Epoch: 8, Steps: 514 | Train Loss: 0.6238178 Vali Loss: 0.3753192 Best vali loss: 0.3701859

best validation loss 0.37018590582377314

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0028025373313, 'e_layers': 4, 'learning_rate': 6.82212175e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.562470201562541e-05
Validation loss decreased (inf --> 0.4054).  Saving model state dict ...
Epoch: 1 cost time: 0.7961986064910889
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4053540 Best vali loss: 0.4053540
Updating learning rate to 5.8230451507526174e-05
Validation loss decreased (0.4054 --> 0.3856).  Saving model state dict ...
Epoch: 2 cost time: 0.4805715084075928
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3855825 Best vali loss: 0.3855825
Updating learning rate to 4.716417358651266e-05
Validation loss decreased (0.3856 --> 0.3760).  Saving model state dict ...
Epoch: 3 cost time: 0.4839174747467041
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3760456 Best vali loss: 0.3760456

best validation loss 0.3760456025951738

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006642855215, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006390026592787182
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 0.7917723655700684
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3698679 Best vali loss: 0.3698679
Updating learning rate to 0.0005670031591983461
Validation loss decreased (0.3699 --> 0.3511).  Saving model state dict ...
Epoch: 2 cost time: 0.4811699390411377
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3510863 Best vali loss: 0.3510863
Updating learning rate to 0.00045924829246902685
Validation loss decreased (0.3511 --> 0.3509).  Saving model state dict ...
Epoch: 3 cost time: 0.4783966541290283
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3508719 Best vali loss: 0.3508719

best validation loss 0.3508718543296244

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0016922263383, 'e_layers': 4, 'learning_rate': 0.0003564551649, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5534492
	speed: 0.0115s/iter; left time: 46.2550s
	iters: 200, epoch: 1 | loss: 0.4800915
	speed: 0.0053s/iter; left time: 20.6893s
	iters: 300, epoch: 1 | loss: 0.5396731
	speed: 0.0052s/iter; left time: 19.8046s
	iters: 400, epoch: 1 | loss: 0.8729838
	speed: 0.0050s/iter; left time: 18.5657s
	iters: 500, epoch: 1 | loss: 1.3503227
	speed: 0.0049s/iter; left time: 17.6298s
Updating learning rate to 0.0003428883980045228
Validation loss decreased (inf --> 0.3770).  Saving model state dict ...
Epoch: 1 cost time: 2.9746973514556885
Epoch: 1, Steps: 514 | Train Loss: 0.7593041 Vali Loss: 0.3769996 Best vali loss: 0.3769996
	iters: 100, epoch: 2 | loss: 0.4553213
	speed: 0.0100s/iter; left time: 35.0804s
	iters: 200, epoch: 2 | loss: 0.4304771
	speed: 0.0048s/iter; left time: 16.2860s
	iters: 300, epoch: 2 | loss: 0.4858642
	speed: 0.0050s/iter; left time: 16.4629s
	iters: 400, epoch: 2 | loss: 0.6834773
	speed: 0.0050s/iter; left time: 15.8363s
	iters: 500, epoch: 2 | loss: 1.1323321
	speed: 0.0049s/iter; left time: 15.2725s
Updating learning rate to 0.0003042535145948795
Validation loss decreased (0.3770 --> 0.3720).  Saving model state dict ...
Epoch: 2 cost time: 2.5487306118011475
Epoch: 2, Steps: 514 | Train Loss: 0.6374944 Vali Loss: 0.3719977 Best vali loss: 0.3719977
	iters: 100, epoch: 3 | loss: 0.5061542
	speed: 0.0094s/iter; left time: 28.1826s
	iters: 200, epoch: 3 | loss: 0.8018379
	speed: 0.0046s/iter; left time: 13.2041s
	iters: 300, epoch: 3 | loss: 0.5695286
	speed: 0.0047s/iter; left time: 12.9540s
	iters: 400, epoch: 3 | loss: 0.6268998
	speed: 0.0052s/iter; left time: 13.8469s
	iters: 500, epoch: 3 | loss: 0.6083368
	speed: 0.0053s/iter; left time: 13.5770s
Updating learning rate to 0.00024643232544409804
Validation loss decreased (0.3720 --> 0.3701).  Saving model state dict ...
Epoch: 3 cost time: 2.5483596324920654
Epoch: 3, Steps: 514 | Train Loss: 0.6225515 Vali Loss: 0.3701428 Best vali loss: 0.3701428

best validation loss 0.3701427582322029

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006642855215, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00033214276075
Epoch: 4 cost time: 0.7772557735443115
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3761917 Best vali loss: 0.3508719
Updating learning rate to 0.0002050372290309732
Epoch: 5 cost time: 0.47886037826538086
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3592768 Best vali loss: 0.3508719
Updating learning rate to 9.728236230165396e-05
Epoch: 6 cost time: 0.49480485916137695
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3563291 Best vali loss: 0.3508719
Updating learning rate to 2.5282862221281842e-05
Epoch: 7 cost time: 0.49315643310546875
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3611916 Best vali loss: 0.3508719
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4928109645843506
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3657182 Best vali loss: 0.3508719

best validation loss 0.3508718543296244

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0015255165959, 'e_layers': 2, 'learning_rate': 0.0001946737892, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4047667
	speed: 0.0094s/iter; left time: 76.1209s
	iters: 200, epoch: 1 | loss: 0.4487776
	speed: 0.0033s/iter; left time: 26.3203s
	iters: 300, epoch: 1 | loss: 1.1944432
	speed: 0.0033s/iter; left time: 26.2737s
	iters: 400, epoch: 1 | loss: 0.9611478
	speed: 0.0033s/iter; left time: 25.6985s
	iters: 500, epoch: 1 | loss: 0.2844149
	speed: 0.0033s/iter; left time: 25.5909s
	iters: 600, epoch: 1 | loss: 0.7325251
	speed: 0.0033s/iter; left time: 25.1310s
	iters: 700, epoch: 1 | loss: 0.5365147
	speed: 0.0032s/iter; left time: 23.6909s
	iters: 800, epoch: 1 | loss: 0.2494207
	speed: 0.0031s/iter; left time: 23.1320s
	iters: 900, epoch: 1 | loss: 1.8644900
	speed: 0.0032s/iter; left time: 23.0560s
	iters: 1000, epoch: 1 | loss: 0.9931256
	speed: 0.0031s/iter; left time: 22.7197s
Updating learning rate to 0.00018726445927914838
Validation loss decreased (inf --> 0.3628).  Saving model state dict ...
Epoch: 1 cost time: 3.6617653369903564
Epoch: 1, Steps: 1027 | Train Loss: 0.7669626 Vali Loss: 0.3628219 Best vali loss: 0.3628219
	iters: 100, epoch: 2 | loss: 0.3986833
	speed: 0.0095s/iter; left time: 67.5809s
	iters: 200, epoch: 2 | loss: 0.1917377
	speed: 0.0034s/iter; left time: 23.6274s
	iters: 300, epoch: 2 | loss: 0.3889050
	speed: 0.0033s/iter; left time: 22.5999s
	iters: 400, epoch: 2 | loss: 0.4286971
	speed: 0.0033s/iter; left time: 22.6742s
	iters: 500, epoch: 2 | loss: 1.0524549
	speed: 0.0033s/iter; left time: 22.3205s
	iters: 600, epoch: 2 | loss: 0.9820733
	speed: 0.0033s/iter; left time: 21.9049s
	iters: 700, epoch: 2 | loss: 0.2036889
	speed: 0.0033s/iter; left time: 21.6670s
	iters: 800, epoch: 2 | loss: 0.4173291
	speed: 0.0033s/iter; left time: 21.2911s
	iters: 900, epoch: 2 | loss: 0.8326209
	speed: 0.0034s/iter; left time: 21.1703s
	iters: 1000, epoch: 2 | loss: 0.8541991
	speed: 0.0033s/iter; left time: 20.6898s
Updating learning rate to 0.00016616447283130024
Validation loss decreased (0.3628 --> 0.3578).  Saving model state dict ...
Epoch: 2 cost time: 3.467590808868408
Epoch: 2, Steps: 1027 | Train Loss: 0.5750389 Vali Loss: 0.3577521 Best vali loss: 0.3577521
	iters: 100, epoch: 3 | loss: 0.3066555
	speed: 0.0097s/iter; left time: 59.0049s
	iters: 200, epoch: 3 | loss: 0.6778421
	speed: 0.0035s/iter; left time: 20.8154s
	iters: 300, epoch: 3 | loss: 0.2813798
	speed: 0.0034s/iter; left time: 20.2152s
	iters: 400, epoch: 3 | loss: 0.8021238
	speed: 0.0034s/iter; left time: 19.3402s
	iters: 500, epoch: 3 | loss: 0.6991063
	speed: 0.0034s/iter; left time: 18.9876s
	iters: 600, epoch: 3 | loss: 0.7266760
	speed: 0.0034s/iter; left time: 18.6444s
	iters: 700, epoch: 3 | loss: 1.4046360
	speed: 0.0029s/iter; left time: 15.7316s
	iters: 800, epoch: 3 | loss: 0.3290035
	speed: 0.0030s/iter; left time: 15.9203s
	iters: 900, epoch: 3 | loss: 1.0017602
	speed: 0.0030s/iter; left time: 15.7494s
	iters: 1000, epoch: 3 | loss: 0.8688320
	speed: 0.0031s/iter; left time: 16.0418s
Updating learning rate to 0.00013458611152128699
Epoch: 3 cost time: 3.354635000228882
Epoch: 3, Steps: 1027 | Train Loss: 0.7098015 Vali Loss: 0.3678064 Best vali loss: 0.3577521
	iters: 100, epoch: 4 | loss: 0.3268788
	speed: 0.0087s/iter; left time: 43.8946s
	iters: 200, epoch: 4 | loss: 0.3091706
	speed: 0.0028s/iter; left time: 13.8767s
	iters: 300, epoch: 4 | loss: 0.7948893
	speed: 0.0028s/iter; left time: 13.5787s
	iters: 400, epoch: 4 | loss: 0.2052288
	speed: 0.0028s/iter; left time: 13.3943s
	iters: 500, epoch: 4 | loss: 0.2922754
	speed: 0.0028s/iter; left time: 12.9907s
	iters: 600, epoch: 4 | loss: 0.5924982
	speed: 0.0028s/iter; left time: 12.7552s
	iters: 700, epoch: 4 | loss: 0.3754068
	speed: 0.0028s/iter; left time: 12.4854s
	iters: 800, epoch: 4 | loss: 0.3758405
	speed: 0.0028s/iter; left time: 12.3384s
	iters: 900, epoch: 4 | loss: 0.5389291
	speed: 0.0028s/iter; left time: 12.0259s
	iters: 1000, epoch: 4 | loss: 0.6290660
	speed: 0.0028s/iter; left time: 11.6391s
Updating learning rate to 9.73368946e-05
Epoch: 4 cost time: 2.930971384048462
Epoch: 4, Steps: 1027 | Train Loss: 0.4440184 Vali Loss: 0.3667882 Best vali loss: 0.3577521
	iters: 100, epoch: 5 | loss: 0.4347728
	speed: 0.0097s/iter; left time: 38.7843s
	iters: 200, epoch: 5 | loss: 0.3407935
	speed: 0.0035s/iter; left time: 13.6652s
	iters: 300, epoch: 5 | loss: 1.2105995
	speed: 0.0034s/iter; left time: 13.0670s
	iters: 400, epoch: 5 | loss: 0.2617427
	speed: 0.0035s/iter; left time: 12.8424s
	iters: 500, epoch: 5 | loss: 0.2715778
	speed: 0.0034s/iter; left time: 12.1571s
	iters: 600, epoch: 5 | loss: 1.2863311
	speed: 0.0034s/iter; left time: 11.7627s
	iters: 700, epoch: 5 | loss: 0.5750484
	speed: 0.0033s/iter; left time: 11.3009s
	iters: 800, epoch: 5 | loss: 0.7233818
	speed: 0.0034s/iter; left time: 11.1816s
	iters: 900, epoch: 5 | loss: 0.3446387
	speed: 0.0034s/iter; left time: 10.7716s
	iters: 1000, epoch: 5 | loss: 0.8332785
	speed: 0.0034s/iter; left time: 10.4463s
Updating learning rate to 6.0087677678713034e-05
Validation loss decreased (0.3578 --> 0.3445).  Saving model state dict ...
Epoch: 5 cost time: 3.514904260635376
Epoch: 5, Steps: 1027 | Train Loss: 0.6282165 Vali Loss: 0.3444680 Best vali loss: 0.3444680
	iters: 100, epoch: 6 | loss: 0.3515288
	speed: 0.0091s/iter; left time: 27.2285s
	iters: 200, epoch: 6 | loss: 0.8334522
	speed: 0.0029s/iter; left time: 8.4039s
	iters: 300, epoch: 6 | loss: 0.1865784
	speed: 0.0031s/iter; left time: 8.5174s
	iters: 400, epoch: 6 | loss: 0.4632681
	speed: 0.0030s/iter; left time: 8.1257s
	iters: 500, epoch: 6 | loss: 0.6381727
	speed: 0.0030s/iter; left time: 7.8664s
	iters: 600, epoch: 6 | loss: 0.4901102
	speed: 0.0031s/iter; left time: 7.5977s
	iters: 700, epoch: 6 | loss: 0.3652339
	speed: 0.0030s/iter; left time: 7.2491s
	iters: 800, epoch: 6 | loss: 0.2579583
	speed: 0.0031s/iter; left time: 6.9656s
	iters: 900, epoch: 6 | loss: 0.2656534
	speed: 0.0029s/iter; left time: 6.3994s
	iters: 1000, epoch: 6 | loss: 0.3003458
	speed: 0.0030s/iter; left time: 6.1562s
Updating learning rate to 2.8509316368699766e-05
Epoch: 6 cost time: 3.118232011795044
Epoch: 6, Steps: 1027 | Train Loss: 0.4152302 Vali Loss: 0.3578482 Best vali loss: 0.3444680
	iters: 100, epoch: 7 | loss: 0.3696363
	speed: 0.0088s/iter; left time: 17.2827s
	iters: 200, epoch: 7 | loss: 0.9469759
	speed: 0.0029s/iter; left time: 5.3759s
	iters: 300, epoch: 7 | loss: 0.3059807
	speed: 0.0029s/iter; left time: 5.1092s
	iters: 400, epoch: 7 | loss: 0.2551506
	speed: 0.0029s/iter; left time: 4.8017s
	iters: 500, epoch: 7 | loss: 0.3945671
	speed: 0.0029s/iter; left time: 4.5103s
	iters: 600, epoch: 7 | loss: 0.5562326
	speed: 0.0029s/iter; left time: 4.2216s
	iters: 700, epoch: 7 | loss: 0.6563298
	speed: 0.0029s/iter; left time: 3.9800s
	iters: 800, epoch: 7 | loss: 0.3109040
	speed: 0.0028s/iter; left time: 3.5640s
	iters: 900, epoch: 7 | loss: 0.4998282
	speed: 0.0031s/iter; left time: 3.5421s
	iters: 1000, epoch: 7 | loss: 0.2389266
	speed: 0.0030s/iter; left time: 3.1158s
Updating learning rate to 7.409329920851609e-06
Epoch: 7 cost time: 3.0426084995269775
Epoch: 7, Steps: 1027 | Train Loss: 0.4534532 Vali Loss: 0.3538312 Best vali loss: 0.3444680
	iters: 100, epoch: 8 | loss: 0.7234888
	speed: 0.0092s/iter; left time: 8.4928s
	iters: 200, epoch: 8 | loss: 0.2293645
	speed: 0.0031s/iter; left time: 2.5686s
	iters: 300, epoch: 8 | loss: 0.1931936
	speed: 0.0029s/iter; left time: 2.1307s
	iters: 400, epoch: 8 | loss: 0.2340064
	speed: 0.0030s/iter; left time: 1.9138s
	iters: 500, epoch: 8 | loss: 0.3970439
	speed: 0.0031s/iter; left time: 1.6364s
	iters: 600, epoch: 8 | loss: 0.9538627
	speed: 0.0031s/iter; left time: 1.3319s
	iters: 700, epoch: 8 | loss: 0.2261803
	speed: 0.0031s/iter; left time: 1.0035s
	iters: 800, epoch: 8 | loss: 0.2578905
	speed: 0.0031s/iter; left time: 0.7004s
	iters: 900, epoch: 8 | loss: 0.7209292
	speed: 0.0031s/iter; left time: 0.3924s
	iters: 1000, epoch: 8 | loss: 0.1975851
	speed: 0.0031s/iter; left time: 0.0857s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.186494827270508
Epoch: 8, Steps: 1027 | Train Loss: 0.4133545 Vali Loss: 0.3618475 Best vali loss: 0.3444680

best validation loss 0.34446801532696647

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3823).  Saving model state dict ...
Epoch: 1 cost time: 1.31003737449646
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3822554 Best vali loss: 0.3822554
Updating learning rate to 0.00035352149005
Epoch: 2 cost time: 1.005702257156372
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3840474 Best vali loss: 0.3822554
Updating learning rate to 0.000176760745025
Validation loss decreased (0.3823 --> 0.3814).  Saving model state dict ...
Epoch: 3 cost time: 1.006976842880249
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3814317 Best vali loss: 0.3814317
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3814 --> 0.3693).  Saving model state dict ...
Epoch: 4 cost time: 1.0095114707946777
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3693202 Best vali loss: 0.3693202
Updating learning rate to 4.419018625625e-05
Epoch: 5 cost time: 1.0103225708007812
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3886255 Best vali loss: 0.3693202
Updating learning rate to 2.2095093128125e-05
Epoch: 6 cost time: 1.0047039985656738
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3787616 Best vali loss: 0.3693202
Updating learning rate to 1.10475465640625e-05
Epoch: 7 cost time: 1.0093257427215576
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3764294 Best vali loss: 0.3693202
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 1.0116524696350098
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3737341 Best vali loss: 0.3693202

best validation loss 0.3693201870253138

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001344088457, 'e_layers': 2, 'learning_rate': 0.0009826234057, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7386308
	speed: 0.0099s/iter; left time: 19.3476s
	iters: 200, epoch: 1 | loss: 0.6853198
	speed: 0.0038s/iter; left time: 7.0381s
Updating learning rate to 0.0009826234057
Validation loss decreased (inf --> 0.3816).  Saving model state dict ...
Epoch: 1 cost time: 1.304640531539917
Epoch: 1, Steps: 257 | Train Loss: 0.7119753 Vali Loss: 0.3815648 Best vali loss: 0.3815648
	iters: 100, epoch: 2 | loss: 0.6010924
	speed: 0.0082s/iter; left time: 13.8758s
	iters: 200, epoch: 2 | loss: 0.9223352
	speed: 0.0037s/iter; left time: 5.9660s
Updating learning rate to 0.00049131170285
Validation loss decreased (0.3816 --> 0.3580).  Saving model state dict ...
Epoch: 2 cost time: 0.9985880851745605
Epoch: 2, Steps: 257 | Train Loss: 0.7617138 Vali Loss: 0.3579728 Best vali loss: 0.3579728
	iters: 100, epoch: 3 | loss: 0.3567627
	speed: 0.0079s/iter; left time: 11.4139s
	iters: 200, epoch: 3 | loss: 0.4179743
	speed: 0.0037s/iter; left time: 4.9331s
Updating learning rate to 0.000245655851425
Validation loss decreased (0.3580 --> 0.3578).  Saving model state dict ...
Epoch: 3 cost time: 0.9648637771606445
Epoch: 3, Steps: 257 | Train Loss: 0.3873685 Vali Loss: 0.3577851 Best vali loss: 0.3577851

best validation loss 0.35778513766225056

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022183365899, 'e_layers': 2, 'learning_rate': 0.0003589185053, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4263890
	speed: 0.0099s/iter; left time: 39.5826s
	iters: 200, epoch: 1 | loss: 1.0767386
	speed: 0.0034s/iter; left time: 13.1782s
	iters: 300, epoch: 1 | loss: 1.0150470
	speed: 0.0033s/iter; left time: 12.3968s
	iters: 400, epoch: 1 | loss: 0.5060370
	speed: 0.0033s/iter; left time: 12.2228s
	iters: 500, epoch: 1 | loss: 1.1377803
	speed: 0.0033s/iter; left time: 12.0172s
Updating learning rate to 0.0003589185053
Validation loss decreased (inf --> 0.3725).  Saving model state dict ...
Epoch: 1 cost time: 2.083204746246338
Epoch: 1, Steps: 514 | Train Loss: 0.8323984 Vali Loss: 0.3725180 Best vali loss: 0.3725180
	iters: 100, epoch: 2 | loss: 0.3873761
	speed: 0.0071s/iter; left time: 24.9319s
	iters: 200, epoch: 2 | loss: 0.2684419
	speed: 0.0031s/iter; left time: 10.6443s
	iters: 300, epoch: 2 | loss: 0.4398522
	speed: 0.0031s/iter; left time: 10.2578s
	iters: 400, epoch: 2 | loss: 0.3893313
	speed: 0.0031s/iter; left time: 9.9229s
	iters: 500, epoch: 2 | loss: 0.6198635
	speed: 0.0031s/iter; left time: 9.5847s
Updating learning rate to 0.00017945925265
Validation loss decreased (0.3725 --> 0.3518).  Saving model state dict ...
Epoch: 2 cost time: 1.6436102390289307
Epoch: 2, Steps: 514 | Train Loss: 0.4209730 Vali Loss: 0.3517815 Best vali loss: 0.3517815
	iters: 100, epoch: 3 | loss: 0.3645778
	speed: 0.0074s/iter; left time: 22.0391s
	iters: 200, epoch: 3 | loss: 0.8478746
	speed: 0.0033s/iter; left time: 9.4355s
	iters: 300, epoch: 3 | loss: 0.4876372
	speed: 0.0031s/iter; left time: 8.5227s
	iters: 400, epoch: 3 | loss: 0.4671874
	speed: 0.0031s/iter; left time: 8.3649s
	iters: 500, epoch: 3 | loss: 1.0833504
	speed: 0.0031s/iter; left time: 7.9723s
Updating learning rate to 8.9729626325e-05
Epoch: 3 cost time: 1.6659233570098877
Epoch: 3, Steps: 514 | Train Loss: 0.6501255 Vali Loss: 0.3683480 Best vali loss: 0.3517815

best validation loss 0.351781478600324

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.004313918152, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.0875637531280518
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3691499 Best vali loss: 0.3691499
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3691 --> 0.3675).  Saving model state dict ...
Epoch: 2 cost time: 0.7724268436431885
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3674696 Best vali loss: 0.3674696
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3675 --> 0.3589).  Saving model state dict ...
Epoch: 3 cost time: 0.7753617763519287
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3588922 Best vali loss: 0.3588922

best validation loss 0.3588922266407425

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022183365899, 'e_layers': 2, 'learning_rate': 0.0003589185053, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3573604
	speed: 0.0097s/iter; left time: 24.0175s
	iters: 200, epoch: 4 | loss: 0.8991274
	speed: 0.0035s/iter; left time: 8.2459s
	iters: 300, epoch: 4 | loss: 0.7682874
	speed: 0.0034s/iter; left time: 7.7962s
	iters: 400, epoch: 4 | loss: 0.4723415
	speed: 0.0033s/iter; left time: 7.2424s
	iters: 500, epoch: 4 | loss: 0.4419585
	speed: 0.0033s/iter; left time: 6.8979s
Updating learning rate to 4.48648131625e-05
Validation loss decreased (0.3518 --> 0.3477).  Saving model state dict ...
Epoch: 4 cost time: 2.10214900970459
Epoch: 4, Steps: 514 | Train Loss: 0.5878150 Vali Loss: 0.3476546 Best vali loss: 0.3476546
	iters: 100, epoch: 5 | loss: 0.3929088
	speed: 0.0076s/iter; left time: 14.7801s
	iters: 200, epoch: 5 | loss: 0.2488009
	speed: 0.0035s/iter; left time: 6.4524s
	iters: 300, epoch: 5 | loss: 0.3543298
	speed: 0.0035s/iter; left time: 6.1562s
	iters: 400, epoch: 5 | loss: 0.3793891
	speed: 0.0036s/iter; left time: 6.0016s
	iters: 500, epoch: 5 | loss: 0.5911677
	speed: 0.0034s/iter; left time: 5.3364s
Updating learning rate to 2.243240658125e-05
Validation loss decreased (0.3477 --> 0.3463).  Saving model state dict ...
Epoch: 5 cost time: 1.855787754058838
Epoch: 5, Steps: 514 | Train Loss: 0.3933193 Vali Loss: 0.3462832 Best vali loss: 0.3462832
	iters: 100, epoch: 6 | loss: 0.3095749
	speed: 0.0073s/iter; left time: 10.5494s
	iters: 200, epoch: 6 | loss: 0.7698618
	speed: 0.0035s/iter; left time: 4.6454s
	iters: 300, epoch: 6 | loss: 0.4523074
	speed: 0.0031s/iter; left time: 3.8708s
	iters: 400, epoch: 6 | loss: 0.4285463
	speed: 0.0031s/iter; left time: 3.4932s
	iters: 500, epoch: 6 | loss: 0.9780042
	speed: 0.0030s/iter; left time: 3.1800s
Updating learning rate to 1.1216203290625e-05
Epoch: 6 cost time: 1.6928269863128662
Epoch: 6, Steps: 514 | Train Loss: 0.5876589 Vali Loss: 0.3470107 Best vali loss: 0.3462832
	iters: 100, epoch: 7 | loss: 0.5502599
	speed: 0.0068s/iter; left time: 6.2982s
	iters: 200, epoch: 7 | loss: 0.4270222
	speed: 0.0030s/iter; left time: 2.4563s
	iters: 300, epoch: 7 | loss: 0.4393628
	speed: 0.0030s/iter; left time: 2.2181s
	iters: 400, epoch: 7 | loss: 0.6388579
	speed: 0.0031s/iter; left time: 1.9527s
	iters: 500, epoch: 7 | loss: 0.6794312
	speed: 0.0032s/iter; left time: 1.6692s
Updating learning rate to 5.6081016453125e-06
Validation loss decreased (0.3463 --> 0.3443).  Saving model state dict ...
Epoch: 7 cost time: 1.6127746105194092
Epoch: 7, Steps: 514 | Train Loss: 0.5469868 Vali Loss: 0.3442862 Best vali loss: 0.3442862
	iters: 100, epoch: 8 | loss: 0.5378068
	speed: 0.0079s/iter; left time: 3.2608s
	iters: 200, epoch: 8 | loss: 0.7064692
	speed: 0.0036s/iter; left time: 1.1313s
	iters: 300, epoch: 8 | loss: 0.4751839
	speed: 0.0036s/iter; left time: 0.7834s
	iters: 400, epoch: 8 | loss: 0.7822860
	speed: 0.0035s/iter; left time: 0.3997s
	iters: 500, epoch: 8 | loss: 0.5349066
	speed: 0.0036s/iter; left time: 0.0539s
Updating learning rate to 2.80405082265625e-06
Epoch: 8 cost time: 1.8874657154083252
Epoch: 8, Steps: 514 | Train Loss: 0.6073305 Vali Loss: 0.3455594 Best vali loss: 0.3442862

best validation loss 0.3442861916742531

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0029089473393, 'e_layers': 1, 'learning_rate': 0.0013440168048, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4939154
	speed: 0.0094s/iter; left time: 8.7449s
Updating learning rate to 0.0012928632110529687
Validation loss decreased (inf --> 0.3640).  Saving model state dict ...
Epoch: 1 cost time: 0.7525880336761475
Epoch: 1, Steps: 129 | Train Loss: 0.4939154 Vali Loss: 0.3640156 Best vali loss: 0.3640156
	iters: 100, epoch: 2 | loss: 0.3827810
	speed: 0.0058s/iter; left time: 4.6619s
Updating learning rate to 0.0011471901007513781
Epoch: 2 cost time: 0.4436788558959961
Epoch: 2, Steps: 129 | Train Loss: 0.3827810 Vali Loss: 0.3730332 Best vali loss: 0.3640156
	iters: 100, epoch: 3 | loss: 0.7285811
	speed: 0.0058s/iter; left time: 3.9076s
Updating learning rate to 0.0009291748844086125
Epoch: 3 cost time: 0.45046067237854004
Epoch: 3, Steps: 129 | Train Loss: 0.7285811 Vali Loss: 0.3781708 Best vali loss: 0.3640156
	iters: 100, epoch: 4 | loss: 0.5317249
	speed: 0.0057s/iter; left time: 3.1384s
Updating learning rate to 0.0006720084024
Epoch: 4 cost time: 0.44788384437561035
Epoch: 4, Steps: 129 | Train Loss: 0.5317249 Vali Loss: 0.3929948 Best vali loss: 0.3640156
	iters: 100, epoch: 5 | loss: 0.4097892
	speed: 0.0058s/iter; left time: 2.4154s
Updating learning rate to 0.0004148419203913876
Epoch: 5 cost time: 0.4357473850250244
Epoch: 5, Steps: 129 | Train Loss: 0.4097892 Vali Loss: 0.3973004 Best vali loss: 0.3640156
	iters: 100, epoch: 6 | loss: 0.4852480
	speed: 0.0057s/iter; left time: 1.6450s
Updating learning rate to 0.00019682670404862188
Epoch: 6 cost time: 0.44857001304626465
Epoch: 6, Steps: 129 | Train Loss: 0.4852480 Vali Loss: 0.3923160 Best vali loss: 0.3640156
	iters: 100, epoch: 7 | loss: 0.4510991
	speed: 0.0057s/iter; left time: 0.9129s
Updating learning rate to 5.115359374703134e-05
Epoch: 7 cost time: 0.4318060874938965
Epoch: 7, Steps: 129 | Train Loss: 0.4510991 Vali Loss: 0.3875655 Best vali loss: 0.3640156
	iters: 100, epoch: 8 | loss: 0.5278261
	speed: 0.0057s/iter; left time: 0.1718s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.43242359161376953
Epoch: 8, Steps: 129 | Train Loss: 0.5278261 Vali Loss: 0.3973742 Best vali loss: 0.3640156

best validation loss 0.36401562580659486

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0025952909884, 'e_layers': 4, 'learning_rate': 0.0008443801066, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3715082
	speed: 0.0110s/iter; left time: 44.2171s
	iters: 200, epoch: 1 | loss: 1.3195950
	speed: 0.0047s/iter; left time: 18.4405s
	iters: 300, epoch: 1 | loss: 0.6189773
	speed: 0.0047s/iter; left time: 17.9934s
	iters: 400, epoch: 1 | loss: 0.5251428
	speed: 0.0047s/iter; left time: 17.5183s
	iters: 500, epoch: 1 | loss: 1.3017697
	speed: 0.0047s/iter; left time: 17.0367s
Updating learning rate to 0.0008122428023737192
Validation loss decreased (inf --> 0.4005).  Saving model state dict ...
Epoch: 1 cost time: 2.783752918243408
Epoch: 1, Steps: 514 | Train Loss: 0.8273986 Vali Loss: 0.4005019 Best vali loss: 0.4005019
	iters: 100, epoch: 2 | loss: 0.3196495
	speed: 0.0096s/iter; left time: 33.7095s
	iters: 200, epoch: 2 | loss: 0.4258323
	speed: 0.0046s/iter; left time: 15.7042s
	iters: 300, epoch: 2 | loss: 0.5723114
	speed: 0.0046s/iter; left time: 15.2427s
	iters: 400, epoch: 2 | loss: 0.3365782
	speed: 0.0047s/iter; left time: 14.9615s
	iters: 500, epoch: 2 | loss: 1.2237725
	speed: 0.0046s/iter; left time: 14.3245s
Updating learning rate to 0.0007207235029379399
Epoch: 2 cost time: 2.435959815979004
Epoch: 2, Steps: 514 | Train Loss: 0.5756288 Vali Loss: 0.4048450 Best vali loss: 0.4005019
	iters: 100, epoch: 3 | loss: 0.8145527
	speed: 0.0093s/iter; left time: 27.9072s
	iters: 200, epoch: 3 | loss: 0.5109897
	speed: 0.0046s/iter; left time: 13.3085s
	iters: 300, epoch: 3 | loss: 1.7290827
	speed: 0.0047s/iter; left time: 13.0350s
	iters: 400, epoch: 3 | loss: 1.1355187
	speed: 0.0046s/iter; left time: 12.4690s
	iters: 500, epoch: 3 | loss: 1.0675646
	speed: 0.0046s/iter; left time: 11.9545s
Updating learning rate to 0.0005837551920072442
Validation loss decreased (0.4005 --> 0.3983).  Saving model state dict ...
Epoch: 3 cost time: 2.438924551010132
Epoch: 3, Steps: 514 | Train Loss: 1.0515417 Vali Loss: 0.3982666 Best vali loss: 0.3982666
	iters: 100, epoch: 4 | loss: 0.7480358
	speed: 0.0095s/iter; left time: 23.4892s
	iters: 200, epoch: 4 | loss: 1.0303860
	speed: 0.0046s/iter; left time: 10.9377s
	iters: 300, epoch: 4 | loss: 0.6908765
	speed: 0.0046s/iter; left time: 10.5054s
	iters: 400, epoch: 4 | loss: 0.3867882
	speed: 0.0046s/iter; left time: 10.0430s
	iters: 500, epoch: 4 | loss: 0.6650754
	speed: 0.0046s/iter; left time: 9.4719s
Updating learning rate to 0.0004221900533
Epoch: 4 cost time: 2.418046474456787
Epoch: 4, Steps: 514 | Train Loss: 0.7042324 Vali Loss: 0.3985619 Best vali loss: 0.3982666
	iters: 100, epoch: 5 | loss: 1.2926314
	speed: 0.0098s/iter; left time: 19.2552s
	iters: 200, epoch: 5 | loss: 0.5229238
	speed: 0.0053s/iter; left time: 9.9009s
	iters: 300, epoch: 5 | loss: 0.7012746
	speed: 0.0053s/iter; left time: 9.3444s
	iters: 400, epoch: 5 | loss: 1.6277789
	speed: 0.0053s/iter; left time: 8.8402s
	iters: 500, epoch: 5 | loss: 1.2325481
	speed: 0.0053s/iter; left time: 8.2516s
Updating learning rate to 0.00026062491459275585
Epoch: 5 cost time: 2.7782516479492188
Epoch: 5, Steps: 514 | Train Loss: 1.0754314 Vali Loss: 0.4015370 Best vali loss: 0.3982666
	iters: 100, epoch: 6 | loss: 0.7077966
	speed: 0.0098s/iter; left time: 14.1521s
	iters: 200, epoch: 6 | loss: 0.4753705
	speed: 0.0049s/iter; left time: 6.5834s
	iters: 300, epoch: 6 | loss: 0.7406111
	speed: 0.0050s/iter; left time: 6.1687s
	iters: 400, epoch: 6 | loss: 0.3817857
	speed: 0.0050s/iter; left time: 5.6597s
	iters: 500, epoch: 6 | loss: 0.6958475
	speed: 0.0050s/iter; left time: 5.2359s
Updating learning rate to 0.0001236566036620601
Epoch: 6 cost time: 2.5970444679260254
Epoch: 6, Steps: 514 | Train Loss: 0.6002823 Vali Loss: 0.4008903 Best vali loss: 0.3982666
	iters: 100, epoch: 7 | loss: 1.3018539
	speed: 0.0098s/iter; left time: 9.0998s
	iters: 200, epoch: 7 | loss: 0.6023180
	speed: 0.0048s/iter; left time: 3.9841s
	iters: 300, epoch: 7 | loss: 0.6194373
	speed: 0.0048s/iter; left time: 3.5334s
	iters: 400, epoch: 7 | loss: 0.8203679
	speed: 0.0050s/iter; left time: 3.1214s
	iters: 500, epoch: 7 | loss: 0.3280953
	speed: 0.0049s/iter; left time: 2.5832s
Updating learning rate to 3.213730422628077e-05
Epoch: 7 cost time: 2.5351364612579346
Epoch: 7, Steps: 514 | Train Loss: 0.7344145 Vali Loss: 0.4054129 Best vali loss: 0.3982666
	iters: 100, epoch: 8 | loss: 0.6729344
	speed: 0.0096s/iter; left time: 3.9869s
	iters: 200, epoch: 8 | loss: 1.1059812
	speed: 0.0048s/iter; left time: 1.5256s
	iters: 300, epoch: 8 | loss: 0.9370736
	speed: 0.0048s/iter; left time: 1.0245s
	iters: 400, epoch: 8 | loss: 0.6064252
	speed: 0.0047s/iter; left time: 0.5404s
	iters: 500, epoch: 8 | loss: 0.3986206
	speed: 0.0046s/iter; left time: 0.0691s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.4825990200042725
Epoch: 8, Steps: 514 | Train Loss: 0.7442070 Vali Loss: 0.4041145 Best vali loss: 0.3982666

best validation loss 0.3982665832127007

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042994753124, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.0915043354034424
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3691183 Best vali loss: 0.3691183
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3691 --> 0.3568).  Saving model state dict ...
Epoch: 2 cost time: 0.7794361114501953
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3567725 Best vali loss: 0.3567725
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3568 --> 0.3562).  Saving model state dict ...
Epoch: 3 cost time: 0.773853063583374
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3562416 Best vali loss: 0.3562416

best validation loss 0.3562415747019537

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014907549328, 'e_layers': 4, 'learning_rate': 0.0006732027317, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006732027317
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.097757339477539
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695859 Best vali loss: 0.3695859
Updating learning rate to 0.00033660136585
Epoch: 2 cost time: 0.7797529697418213
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3815847 Best vali loss: 0.3695859
Updating learning rate to 0.000168300682925
Validation loss decreased (0.3696 --> 0.3564).  Saving model state dict ...
Epoch: 3 cost time: 0.7735111713409424
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3563992 Best vali loss: 0.3563992

best validation loss 0.3563991562205354

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007074898879, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006805626573947573
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 1.1097486019134521
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3671121 Best vali loss: 0.3671121
Updating learning rate to 0.0006038803926275002
Validation loss decreased (0.3671 --> 0.3619).  Saving model state dict ...
Epoch: 2 cost time: 0.7949109077453613
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619318 Best vali loss: 0.3619318
Updating learning rate to 0.0004891172732825823
Epoch: 3 cost time: 0.7961862087249756
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3649949 Best vali loss: 0.3619318

best validation loss 0.36193184161701464

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0042994753124, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3562 --> 0.3471).  Saving model state dict ...
Epoch: 4 cost time: 1.094353437423706
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3470843 Best vali loss: 0.3470843
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3471 --> 0.3454).  Saving model state dict ...
Epoch: 5 cost time: 0.7831101417541504
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3454372 Best vali loss: 0.3454372
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3454 --> 0.3422).  Saving model state dict ...
Epoch: 6 cost time: 0.779961347579956
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3421982 Best vali loss: 0.3421982
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3422 --> 0.3416).  Saving model state dict ...
Epoch: 7 cost time: 0.7783780097961426
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3415904 Best vali loss: 0.3415904
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7764883041381836
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3425137 Best vali loss: 0.3415904

best validation loss 0.341590366171479

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0100138664466, 'e_layers': 4, 'learning_rate': 0.0001416591184, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8269258
	speed: 0.0129s/iter; left time: 25.1887s
	iters: 200, epoch: 1 | loss: 0.5620034
	speed: 0.0065s/iter; left time: 12.1282s
Updating learning rate to 0.0001362675392416765
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 2.02923846244812
Epoch: 1, Steps: 257 | Train Loss: 0.6944646 Vali Loss: 0.3692647 Best vali loss: 0.3692647
	iters: 100, epoch: 2 | loss: 0.9536371
	speed: 0.0138s/iter; left time: 23.4503s
	iters: 200, epoch: 2 | loss: 0.3884997
	speed: 0.0064s/iter; left time: 10.3162s
Updating learning rate to 0.000120913620818774
Validation loss decreased (0.3693 --> 0.3574).  Saving model state dict ...
Epoch: 2 cost time: 1.7035698890686035
Epoch: 2, Steps: 257 | Train Loss: 0.6710684 Vali Loss: 0.3573854 Best vali loss: 0.3573854
	iters: 100, epoch: 3 | loss: 0.6373041
	speed: 0.0137s/iter; left time: 19.7826s
	iters: 200, epoch: 3 | loss: 0.4448050
	speed: 0.0063s/iter; left time: 8.4323s
Updating learning rate to 9.793485802756232e-05
Epoch: 3 cost time: 1.6465966701507568
Epoch: 3, Steps: 257 | Train Loss: 0.5410546 Vali Loss: 0.3613475 Best vali loss: 0.3573854
	iters: 100, epoch: 4 | loss: 0.3231557
	speed: 0.0131s/iter; left time: 15.5552s
	iters: 200, epoch: 4 | loss: 0.5651829
	speed: 0.0065s/iter; left time: 7.0157s
Updating learning rate to 7.08295592e-05
Validation loss decreased (0.3574 --> 0.3505).  Saving model state dict ...
Epoch: 4 cost time: 1.6930437088012695
Epoch: 4, Steps: 257 | Train Loss: 0.4441693 Vali Loss: 0.3505343 Best vali loss: 0.3505343
	iters: 100, epoch: 5 | loss: 0.6006361
	speed: 0.0138s/iter; left time: 12.8417s
	iters: 200, epoch: 5 | loss: 0.3678880
	speed: 0.0065s/iter; left time: 5.4261s
Updating learning rate to 4.372426037243768e-05
Epoch: 5 cost time: 1.713202714920044
Epoch: 5, Steps: 257 | Train Loss: 0.4842620 Vali Loss: 0.3520645 Best vali loss: 0.3505343
	iters: 100, epoch: 6 | loss: 0.4993222
	speed: 0.0132s/iter; left time: 8.8936s
	iters: 200, epoch: 6 | loss: 0.4863729
	speed: 0.0064s/iter; left time: 3.6573s
Updating learning rate to 2.074549758122599e-05
Epoch: 6 cost time: 1.6840424537658691
Epoch: 6, Steps: 257 | Train Loss: 0.4928475 Vali Loss: 0.3612208 Best vali loss: 0.3505343
	iters: 100, epoch: 7 | loss: 0.4897955
	speed: 0.0132s/iter; left time: 5.4808s
	iters: 200, epoch: 7 | loss: 0.5526162
	speed: 0.0063s/iter; left time: 1.9688s
Updating learning rate to 5.3915791583234905e-06
Epoch: 7 cost time: 1.663295030593872
Epoch: 7, Steps: 257 | Train Loss: 0.5212059 Vali Loss: 0.3602926 Best vali loss: 0.3505343
	iters: 100, epoch: 8 | loss: 0.4933218
	speed: 0.0131s/iter; left time: 2.0730s
	iters: 200, epoch: 8 | loss: 0.5134841
	speed: 0.0064s/iter; left time: 0.3719s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6873340606689453
Epoch: 8, Steps: 257 | Train Loss: 0.5034029 Vali Loss: 0.3603423 Best vali loss: 0.3505343

best validation loss 0.3505342859182002

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021940661293, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8049602
	speed: 0.0098s/iter; left time: 39.2938s
	iters: 200, epoch: 1 | loss: 0.3314731
	speed: 0.0033s/iter; left time: 12.8430s
	iters: 300, epoch: 1 | loss: 0.5316494
	speed: 0.0032s/iter; left time: 12.3140s
	iters: 400, epoch: 1 | loss: 1.0657350
	speed: 0.0032s/iter; left time: 11.9022s
	iters: 500, epoch: 1 | loss: 0.9073177
	speed: 0.0033s/iter; left time: 11.7732s
Updating learning rate to 0.00039412601865045424
Validation loss decreased (inf --> 0.3867).  Saving model state dict ...
Epoch: 1 cost time: 2.043013095855713
Epoch: 1, Steps: 514 | Train Loss: 0.7282271 Vali Loss: 0.3866950 Best vali loss: 0.3866950
	iters: 100, epoch: 2 | loss: 1.3588123
	speed: 0.0076s/iter; left time: 26.5394s
	iters: 200, epoch: 2 | loss: 0.6990870
	speed: 0.0036s/iter; left time: 12.1987s
	iters: 300, epoch: 2 | loss: 0.6904381
	speed: 0.0036s/iter; left time: 11.8501s
	iters: 400, epoch: 2 | loss: 0.6374082
	speed: 0.0036s/iter; left time: 11.4685s
	iters: 500, epoch: 2 | loss: 0.7206434
	speed: 0.0036s/iter; left time: 11.1291s
Updating learning rate to 0.00034971794632172426
Validation loss decreased (0.3867 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 1.8880698680877686
Epoch: 2, Steps: 514 | Train Loss: 0.8212778 Vali Loss: 0.3659161 Best vali loss: 0.3659161
	iters: 100, epoch: 3 | loss: 0.4974689
	speed: 0.0074s/iter; left time: 22.0423s
	iters: 200, epoch: 3 | loss: 0.4851546
	speed: 0.0034s/iter; left time: 9.9246s
	iters: 300, epoch: 3 | loss: 0.5158010
	speed: 0.0034s/iter; left time: 9.4089s
	iters: 400, epoch: 3 | loss: 0.4993176
	speed: 0.0034s/iter; left time: 9.0780s
	iters: 500, epoch: 3 | loss: 1.0825893
	speed: 0.0034s/iter; left time: 8.7327s
Updating learning rate to 0.00028325656936568113
Epoch: 3 cost time: 1.7919023036956787
Epoch: 3, Steps: 514 | Train Loss: 0.6160663 Vali Loss: 0.3662486 Best vali loss: 0.3659161
	iters: 100, epoch: 4 | loss: 0.4317658
	speed: 0.0072s/iter; left time: 17.8809s
	iters: 200, epoch: 4 | loss: 0.5494252
	speed: 0.0035s/iter; left time: 8.1817s
	iters: 300, epoch: 4 | loss: 0.4283950
	speed: 0.0034s/iter; left time: 7.6954s
	iters: 400, epoch: 4 | loss: 0.3723927
	speed: 0.0034s/iter; left time: 7.4139s
	iters: 500, epoch: 4 | loss: 0.3531798
	speed: 0.0034s/iter; left time: 6.9433s
Updating learning rate to 0.00020486002995
Validation loss decreased (0.3659 --> 0.3600).  Saving model state dict ...
Epoch: 4 cost time: 1.788200855255127
Epoch: 4, Steps: 514 | Train Loss: 0.4270317 Vali Loss: 0.3599552 Best vali loss: 0.3599552
	iters: 100, epoch: 5 | loss: 0.3895584
	speed: 0.0070s/iter; left time: 13.6798s
	iters: 200, epoch: 5 | loss: 0.5666364
	speed: 0.0031s/iter; left time: 5.7878s
	iters: 300, epoch: 5 | loss: 0.2421250
	speed: 0.0031s/iter; left time: 5.4202s
	iters: 400, epoch: 5 | loss: 0.3892796
	speed: 0.0031s/iter; left time: 5.1631s
	iters: 500, epoch: 5 | loss: 0.4692711
	speed: 0.0032s/iter; left time: 4.9336s
Updating learning rate to 0.00012646349053431892
Validation loss decreased (0.3600 --> 0.3488).  Saving model state dict ...
Epoch: 5 cost time: 1.6549327373504639
Epoch: 5, Steps: 514 | Train Loss: 0.4113741 Vali Loss: 0.3488498 Best vali loss: 0.3488498
	iters: 100, epoch: 6 | loss: 0.3749625
	speed: 0.0070s/iter; left time: 10.1708s
	iters: 200, epoch: 6 | loss: 0.3497622
	speed: 0.0031s/iter; left time: 4.0992s
	iters: 300, epoch: 6 | loss: 0.2650868
	speed: 0.0030s/iter; left time: 3.7851s
	iters: 400, epoch: 6 | loss: 0.5571320
	speed: 0.0030s/iter; left time: 3.4332s
	iters: 500, epoch: 6 | loss: 0.5974993
	speed: 0.0030s/iter; left time: 3.1545s
Updating learning rate to 6.000211357827579e-05
Validation loss decreased (0.3488 --> 0.3470).  Saving model state dict ...
Epoch: 6 cost time: 1.6234090328216553
Epoch: 6, Steps: 514 | Train Loss: 0.4288885 Vali Loss: 0.3469971 Best vali loss: 0.3469971
	iters: 100, epoch: 7 | loss: 0.3787501
	speed: 0.0069s/iter; left time: 6.4097s
	iters: 200, epoch: 7 | loss: 0.2507315
	speed: 0.0031s/iter; left time: 2.5656s
	iters: 300, epoch: 7 | loss: 0.5396295
	speed: 0.0032s/iter; left time: 2.3282s
	iters: 400, epoch: 7 | loss: 0.4911549
	speed: 0.0031s/iter; left time: 1.9208s
	iters: 500, epoch: 7 | loss: 0.3507422
	speed: 0.0030s/iter; left time: 1.6070s
Updating learning rate to 1.5594041249545802e-05
Epoch: 7 cost time: 1.6444597244262695
Epoch: 7, Steps: 514 | Train Loss: 0.4022016 Vali Loss: 0.3496478 Best vali loss: 0.3469971
	iters: 100, epoch: 8 | loss: 0.2603672
	speed: 0.0068s/iter; left time: 2.8370s
	iters: 200, epoch: 8 | loss: 0.4566511
	speed: 0.0031s/iter; left time: 0.9718s
	iters: 300, epoch: 8 | loss: 0.6492184
	speed: 0.0031s/iter; left time: 0.6558s
	iters: 400, epoch: 8 | loss: 0.6184646
	speed: 0.0031s/iter; left time: 0.3589s
	iters: 500, epoch: 8 | loss: 0.3889964
	speed: 0.0032s/iter; left time: 0.0476s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6417114734649658
Epoch: 8, Steps: 514 | Train Loss: 0.4747396 Vali Loss: 0.3473341 Best vali loss: 0.3469971

best validation loss 0.34699709274914037

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.002193950609, 'e_layers': 4, 'learning_rate': 0.000707468223, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006805418170659154
Validation loss decreased (inf --> 0.3824).  Saving model state dict ...
Epoch: 1 cost time: 1.4043445587158203
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3823593 Best vali loss: 0.3823593
Updating learning rate to 0.0006038619004786483
Validation loss decreased (0.3824 --> 0.3820).  Saving model state dict ...
Epoch: 2 cost time: 1.0998828411102295
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3820134 Best vali loss: 0.3820134
Updating learning rate to 0.0004891022954334355
Validation loss decreased (0.3820 --> 0.3796).  Saving model state dict ...
Epoch: 3 cost time: 1.1011121273040771
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3795751 Best vali loss: 0.3795751

best validation loss 0.37957507483148856

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022133958238, 'e_layers': 4, 'learning_rate': 0.000412045111, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4146279
	speed: 0.0116s/iter; left time: 46.4013s
	iters: 200, epoch: 1 | loss: 0.3385357
	speed: 0.0051s/iter; left time: 20.0931s
	iters: 300, epoch: 1 | loss: 0.3976703
	speed: 0.0051s/iter; left time: 19.4155s
	iters: 400, epoch: 1 | loss: 0.3474711
	speed: 0.0050s/iter; left time: 18.7327s
	iters: 500, epoch: 1 | loss: 0.9379085
	speed: 0.0049s/iter; left time: 17.6184s
Updating learning rate to 0.00039636257776212063
Validation loss decreased (inf --> 0.3777).  Saving model state dict ...
Epoch: 1 cost time: 2.9730606079101562
Epoch: 1, Steps: 514 | Train Loss: 0.4872427 Vali Loss: 0.3777082 Best vali loss: 0.3777082
	iters: 100, epoch: 2 | loss: 1.1393338
	speed: 0.0104s/iter; left time: 36.2412s
	iters: 200, epoch: 2 | loss: 0.9603299
	speed: 0.0049s/iter; left time: 16.5716s
	iters: 300, epoch: 2 | loss: 0.6183072
	speed: 0.0049s/iter; left time: 16.0170s
	iters: 400, epoch: 2 | loss: 0.4084463
	speed: 0.0050s/iter; left time: 15.8681s
	iters: 500, epoch: 2 | loss: 0.4390866
	speed: 0.0050s/iter; left time: 15.3789s
Updating learning rate to 0.0003517025015714318
Validation loss decreased (0.3777 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 2.596323013305664
Epoch: 2, Steps: 514 | Train Loss: 0.7131008 Vali Loss: 0.3740671 Best vali loss: 0.3740671
	iters: 100, epoch: 3 | loss: 0.4204038
	speed: 0.0104s/iter; left time: 30.9572s
	iters: 200, epoch: 3 | loss: 0.4271515
	speed: 0.0053s/iter; left time: 15.2058s
	iters: 300, epoch: 3 | loss: 0.7772616
	speed: 0.0052s/iter; left time: 14.4526s
	iters: 400, epoch: 3 | loss: 0.3663320
	speed: 0.0046s/iter; left time: 12.4115s
	iters: 500, epoch: 3 | loss: 1.1370847
	speed: 0.0046s/iter; left time: 11.8135s
Updating learning rate to 0.0002848639741833672
Epoch: 3 cost time: 2.6006481647491455
Epoch: 3, Steps: 514 | Train Loss: 0.6256467 Vali Loss: 0.3819759 Best vali loss: 0.3740671

best validation loss 0.3740670553593364

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017399541635, 'e_layers': 4, 'learning_rate': 6.18101561e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5965542
	speed: 0.0115s/iter; left time: 22.4788s
	iters: 200, epoch: 1 | loss: 0.5268152
	speed: 0.0054s/iter; left time: 10.0008s
Updating learning rate to 6.18101561e-05
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 1.7171986103057861
Epoch: 1, Steps: 257 | Train Loss: 0.5616847 Vali Loss: 0.3673806 Best vali loss: 0.3673806
	iters: 100, epoch: 2 | loss: 0.3476071
	speed: 0.0113s/iter; left time: 19.2719s
	iters: 200, epoch: 2 | loss: 0.3565220
	speed: 0.0054s/iter; left time: 8.6660s
Updating learning rate to 3.090507805e-05
Epoch: 2 cost time: 1.4450292587280273
Epoch: 2, Steps: 257 | Train Loss: 0.3520646 Vali Loss: 0.3680483 Best vali loss: 0.3673806
	iters: 100, epoch: 3 | loss: 0.5307479
	speed: 0.0114s/iter; left time: 16.4401s
	iters: 200, epoch: 3 | loss: 0.6167420
	speed: 0.0054s/iter; left time: 7.3094s
Updating learning rate to 1.5452539025e-05
Validation loss decreased (0.3674 --> 0.3649).  Saving model state dict ...
Epoch: 3 cost time: 1.4357388019561768
Epoch: 3, Steps: 257 | Train Loss: 0.5737449 Vali Loss: 0.3649208 Best vali loss: 0.3649208

best validation loss 0.36492082518772434

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017399541635, 'e_layers': 4, 'learning_rate': 6.18101561e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5775064
	speed: 0.0121s/iter; left time: 14.3267s
	iters: 200, epoch: 4 | loss: 0.5028804
	speed: 0.0054s/iter; left time: 5.9049s
Updating learning rate to 7.7262695125e-06
Validation loss decreased (0.3649 --> 0.3626).  Saving model state dict ...
Epoch: 4 cost time: 1.7572143077850342
Epoch: 4, Steps: 257 | Train Loss: 0.5401934 Vali Loss: 0.3626162 Best vali loss: 0.3626162
	iters: 100, epoch: 5 | loss: 0.3489208
	speed: 0.0110s/iter; left time: 10.2051s
	iters: 200, epoch: 5 | loss: 0.3610786
	speed: 0.0048s/iter; left time: 3.9914s
Updating learning rate to 3.86313475625e-06
Epoch: 5 cost time: 1.3092615604400635
Epoch: 5, Steps: 257 | Train Loss: 0.3549997 Vali Loss: 0.3632027 Best vali loss: 0.3626162
	iters: 100, epoch: 6 | loss: 0.5113303
	speed: 0.0104s/iter; left time: 7.0140s
	iters: 200, epoch: 6 | loss: 0.5948367
	speed: 0.0050s/iter; left time: 2.8547s
Updating learning rate to 1.931567378125e-06
Epoch: 6 cost time: 1.3222906589508057
Epoch: 6, Steps: 257 | Train Loss: 0.5530835 Vali Loss: 0.3628374 Best vali loss: 0.3626162
	iters: 100, epoch: 7 | loss: 0.4634922
	speed: 0.0107s/iter; left time: 4.4598s
	iters: 200, epoch: 7 | loss: 0.8234619
	speed: 0.0055s/iter; left time: 1.7230s
Updating learning rate to 9.657836890625e-07
Validation loss decreased (0.3626 --> 0.3626).  Saving model state dict ...
Epoch: 7 cost time: 1.4357798099517822
Epoch: 7, Steps: 257 | Train Loss: 0.6434770 Vali Loss: 0.3625574 Best vali loss: 0.3625574
	iters: 100, epoch: 8 | loss: 0.5268062
	speed: 0.0109s/iter; left time: 1.7156s
	iters: 200, epoch: 8 | loss: 0.5828110
	speed: 0.0050s/iter; left time: 0.2910s
Updating learning rate to 4.8289184453125e-07
Validation loss decreased (0.3626 --> 0.3625).  Saving model state dict ...
Epoch: 8 cost time: 1.3313236236572266
Epoch: 8, Steps: 257 | Train Loss: 0.5548086 Vali Loss: 0.3624706 Best vali loss: 0.3624706

best validation loss 0.3624706162450824

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0050738410721, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3700).  Saving model state dict ...
Epoch: 1 cost time: 1.0985350608825684
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3699543 Best vali loss: 0.3699543
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3700 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 0.7855710983276367
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3641302 Best vali loss: 0.3641302
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3641 --> 0.3478).  Saving model state dict ...
Epoch: 3 cost time: 0.7949156761169434
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3478109 Best vali loss: 0.3478109
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3478 --> 0.3467).  Saving model state dict ...
Epoch: 4 cost time: 0.7995295524597168
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3466671 Best vali loss: 0.3466671
Updating learning rate to 4.198869296875e-05
Validation loss decreased (0.3467 --> 0.3432).  Saving model state dict ...
Epoch: 5 cost time: 0.7947943210601807
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3431878 Best vali loss: 0.3431878
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.800870418548584
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3456644 Best vali loss: 0.3431878
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.7961220741271973
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3459046 Best vali loss: 0.3431878
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7882668972015381
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3467698 Best vali loss: 0.3431878

best validation loss 0.34318780333447785

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010634813318, 'e_layers': 2, 'learning_rate': 0.0004823592611, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4304962
	speed: 0.0096s/iter; left time: 38.5789s
	iters: 200, epoch: 1 | loss: 1.0824684
	speed: 0.0034s/iter; left time: 13.4830s
	iters: 300, epoch: 1 | loss: 1.0056287
	speed: 0.0035s/iter; left time: 13.3025s
	iters: 400, epoch: 1 | loss: 0.5014666
	speed: 0.0034s/iter; left time: 12.8075s
	iters: 500, epoch: 1 | loss: 1.1841353
	speed: 0.0034s/iter; left time: 12.2788s
Updating learning rate to 0.0004823592611
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 2.120999574661255
Epoch: 1, Steps: 514 | Train Loss: 0.8408391 Vali Loss: 0.3844872 Best vali loss: 0.3844872
	iters: 100, epoch: 2 | loss: 0.4005622
	speed: 0.0075s/iter; left time: 26.0925s
	iters: 200, epoch: 2 | loss: 0.2695434
	speed: 0.0033s/iter; left time: 11.0665s
	iters: 300, epoch: 2 | loss: 0.4889554
	speed: 0.0030s/iter; left time: 10.0232s
	iters: 400, epoch: 2 | loss: 0.3910371
	speed: 0.0032s/iter; left time: 10.1963s
	iters: 500, epoch: 2 | loss: 0.6164516
	speed: 0.0033s/iter; left time: 10.3242s
Updating learning rate to 0.00024117963055
Validation loss decreased (0.3845 --> 0.3745).  Saving model state dict ...
Epoch: 2 cost time: 1.700181007385254
Epoch: 2, Steps: 514 | Train Loss: 0.4333099 Vali Loss: 0.3744802 Best vali loss: 0.3744802
	iters: 100, epoch: 3 | loss: 0.3613865
	speed: 0.0074s/iter; left time: 22.0977s
	iters: 200, epoch: 3 | loss: 0.8666743
	speed: 0.0034s/iter; left time: 9.7395s
	iters: 300, epoch: 3 | loss: 0.5143515
	speed: 0.0033s/iter; left time: 9.2604s
	iters: 400, epoch: 3 | loss: 0.4619085
	speed: 0.0033s/iter; left time: 8.8677s
	iters: 500, epoch: 3 | loss: 1.0722933
	speed: 0.0032s/iter; left time: 8.1441s
Updating learning rate to 0.000120589815275
Validation loss decreased (0.3745 --> 0.3659).  Saving model state dict ...
Epoch: 3 cost time: 1.748875617980957
Epoch: 3, Steps: 514 | Train Loss: 0.6553228 Vali Loss: 0.3658592 Best vali loss: 0.3658592
	iters: 100, epoch: 4 | loss: 0.5546855
	speed: 0.0075s/iter; left time: 18.4377s
	iters: 200, epoch: 4 | loss: 0.4761203
	speed: 0.0035s/iter; left time: 8.2381s
	iters: 300, epoch: 4 | loss: 0.4835058
	speed: 0.0035s/iter; left time: 7.8628s
	iters: 400, epoch: 4 | loss: 0.6979346
	speed: 0.0036s/iter; left time: 7.7103s
	iters: 500, epoch: 4 | loss: 0.7349167
	speed: 0.0035s/iter; left time: 7.3256s
Updating learning rate to 6.02949076375e-05
Validation loss decreased (0.3659 --> 0.3577).  Saving model state dict ...
Epoch: 4 cost time: 1.8313791751861572
Epoch: 4, Steps: 514 | Train Loss: 0.5894326 Vali Loss: 0.3576653 Best vali loss: 0.3576653
	iters: 100, epoch: 5 | loss: 0.5390714
	speed: 0.0074s/iter; left time: 14.5454s
	iters: 200, epoch: 5 | loss: 0.7655960
	speed: 0.0033s/iter; left time: 6.1988s
	iters: 300, epoch: 5 | loss: 0.4665715
	speed: 0.0033s/iter; left time: 5.8494s
	iters: 400, epoch: 5 | loss: 0.8354064
	speed: 0.0034s/iter; left time: 5.6747s
	iters: 500, epoch: 5 | loss: 0.5658795
	speed: 0.0033s/iter; left time: 5.2038s
Updating learning rate to 3.014745381875e-05
Epoch: 5 cost time: 1.7751750946044922
Epoch: 5, Steps: 514 | Train Loss: 0.6345050 Vali Loss: 0.3589681 Best vali loss: 0.3576653
	iters: 100, epoch: 6 | loss: 0.2930557
	speed: 0.0075s/iter; left time: 10.8939s
	iters: 200, epoch: 6 | loss: 0.4651830
	speed: 0.0036s/iter; left time: 4.8379s
	iters: 300, epoch: 6 | loss: 0.3675424
	speed: 0.0034s/iter; left time: 4.2796s
	iters: 400, epoch: 6 | loss: 0.7434394
	speed: 0.0035s/iter; left time: 4.0169s
	iters: 500, epoch: 6 | loss: 0.9878052
	speed: 0.0034s/iter; left time: 3.5017s
Updating learning rate to 1.5073726909375e-05
Epoch: 6 cost time: 1.846764326095581
Epoch: 6, Steps: 514 | Train Loss: 0.5714052 Vali Loss: 0.3578211 Best vali loss: 0.3576653
	iters: 100, epoch: 7 | loss: 0.3928849
	speed: 0.0071s/iter; left time: 6.6156s
	iters: 200, epoch: 7 | loss: 0.3018112
	speed: 0.0032s/iter; left time: 2.6187s
	iters: 300, epoch: 7 | loss: 0.3787404
	speed: 0.0031s/iter; left time: 2.2742s
	iters: 400, epoch: 7 | loss: 0.4033259
	speed: 0.0031s/iter; left time: 1.9780s
	iters: 500, epoch: 7 | loss: 0.7811905
	speed: 0.0033s/iter; left time: 1.7196s
Updating learning rate to 7.5368634546875e-06
Validation loss decreased (0.3577 --> 0.3554).  Saving model state dict ...
Epoch: 7 cost time: 1.6797893047332764
Epoch: 7, Steps: 514 | Train Loss: 0.4515906 Vali Loss: 0.3553737 Best vali loss: 0.3553737
	iters: 100, epoch: 8 | loss: 0.3631316
	speed: 0.0071s/iter; left time: 2.9671s
	iters: 200, epoch: 8 | loss: 0.2263488
	speed: 0.0031s/iter; left time: 0.9858s
	iters: 300, epoch: 8 | loss: 0.3577204
	speed: 0.0031s/iter; left time: 0.6693s
	iters: 400, epoch: 8 | loss: 0.4423296
	speed: 0.0031s/iter; left time: 0.3547s
	iters: 500, epoch: 8 | loss: 0.2495515
	speed: 0.0031s/iter; left time: 0.0463s
Updating learning rate to 3.76843172734375e-06
Epoch: 8 cost time: 1.647040605545044
Epoch: 8, Steps: 514 | Train Loss: 0.3278164 Vali Loss: 0.3554094 Best vali loss: 0.3553737

best validation loss 0.3553736677162774

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0040712968771, 'e_layers': 2, 'learning_rate': 0.0001489404586, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00014327174993169234
Validation loss decreased (inf --> 0.4161).  Saving model state dict ...
Epoch: 1 cost time: 0.6812648773193359
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4160968 Best vali loss: 0.4160968
Updating learning rate to 0.00012712863343454712
Validation loss decreased (0.4161 --> 0.3955).  Saving model state dict ...
Epoch: 2 cost time: 0.36757373809814453
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3955186 Best vali loss: 0.3955186
Updating learning rate to 0.0001029687522575393
Validation loss decreased (0.3955 --> 0.3835).  Saving model state dict ...
Epoch: 3 cost time: 0.35505175590515137
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3835327 Best vali loss: 0.3835327

best validation loss 0.3835327135087933

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021942137147, 'e_layers': 2, 'learning_rate': 0.0004097908268, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8049846
	speed: 0.0098s/iter; left time: 39.2109s
	iters: 200, epoch: 1 | loss: 0.3314889
	speed: 0.0036s/iter; left time: 14.0145s
	iters: 300, epoch: 1 | loss: 0.5311678
	speed: 0.0034s/iter; left time: 13.0917s
	iters: 400, epoch: 1 | loss: 1.0635582
	speed: 0.0034s/iter; left time: 12.6878s
	iters: 500, epoch: 1 | loss: 0.9291210
	speed: 0.0035s/iter; left time: 12.4697s
Updating learning rate to 0.00039419409214569884
Validation loss decreased (inf --> 0.3833).  Saving model state dict ...
Epoch: 1 cost time: 2.146497964859009
Epoch: 1, Steps: 514 | Train Loss: 0.7320641 Vali Loss: 0.3832556 Best vali loss: 0.3832556
	iters: 100, epoch: 2 | loss: 1.2624887
	speed: 0.0074s/iter; left time: 25.7870s
	iters: 200, epoch: 2 | loss: 0.6408259
	speed: 0.0034s/iter; left time: 11.4028s
	iters: 300, epoch: 2 | loss: 0.6853477
	speed: 0.0033s/iter; left time: 10.9769s
	iters: 400, epoch: 2 | loss: 0.6626993
	speed: 0.0033s/iter; left time: 10.5811s
	iters: 500, epoch: 2 | loss: 0.6824654
	speed: 0.0032s/iter; left time: 9.9129s
Updating learning rate to 0.000349778349649161
Validation loss decreased (0.3833 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 1.7452363967895508
Epoch: 2, Steps: 514 | Train Loss: 0.7867654 Vali Loss: 0.3690203 Best vali loss: 0.3690203
	iters: 100, epoch: 3 | loss: 0.4825808
	speed: 0.0077s/iter; left time: 23.0308s
	iters: 200, epoch: 3 | loss: 0.3971328
	speed: 0.0035s/iter; left time: 10.2339s
	iters: 300, epoch: 3 | loss: 0.5245022
	speed: 0.0034s/iter; left time: 9.6005s
	iters: 400, epoch: 3 | loss: 0.4900040
	speed: 0.0036s/iter; left time: 9.5882s
	iters: 500, epoch: 3 | loss: 1.0875627
	speed: 0.0036s/iter; left time: 9.3057s
Updating learning rate to 0.000283305493475776
Validation loss decreased (0.3690 --> 0.3603).  Saving model state dict ...
Epoch: 3 cost time: 1.8662316799163818
Epoch: 3, Steps: 514 | Train Loss: 0.5963565 Vali Loss: 0.3602921 Best vali loss: 0.3602921

best validation loss 0.36029207495083276

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006686126435, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006686126435
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 1.1183674335479736
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3692796 Best vali loss: 0.3692796
Updating learning rate to 0.00033430632175
Validation loss decreased (0.3693 --> 0.3581).  Saving model state dict ...
Epoch: 2 cost time: 0.7739753723144531
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3581185 Best vali loss: 0.3581185
Updating learning rate to 0.000167153160875
Validation loss decreased (0.3581 --> 0.3572).  Saving model state dict ...
Epoch: 3 cost time: 0.78273606300354
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3572359 Best vali loss: 0.3572359

best validation loss 0.3572359037539814

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006686126435, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.35765804375e-05
Validation loss decreased (0.3572 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 1.0934374332427979
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3512995 Best vali loss: 0.3512995
Updating learning rate to 4.178829021875e-05
Validation loss decreased (0.3513 --> 0.3501).  Saving model state dict ...
Epoch: 5 cost time: 0.783367395401001
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3501490 Best vali loss: 0.3501490
Updating learning rate to 2.0894145109375e-05
Validation loss decreased (0.3501 --> 0.3469).  Saving model state dict ...
Epoch: 6 cost time: 0.7806553840637207
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3468525 Best vali loss: 0.3468525
Updating learning rate to 1.04470725546875e-05
Validation loss decreased (0.3469 --> 0.3453).  Saving model state dict ...
Epoch: 7 cost time: 0.778252363204956
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3453198 Best vali loss: 0.3453198
Updating learning rate to 5.22353627734375e-06
Epoch: 8 cost time: 0.7904343605041504
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3479601 Best vali loss: 0.3453198

best validation loss 0.345319822858031

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0053645792749, 'e_layers': 2, 'learning_rate': 0.0004183729756, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8339230
	speed: 0.0096s/iter; left time: 77.8694s
	iters: 200, epoch: 1 | loss: 1.3572584
	speed: 0.0031s/iter; left time: 25.0675s
	iters: 300, epoch: 1 | loss: 0.3795721
	speed: 0.0030s/iter; left time: 24.1334s
	iters: 400, epoch: 1 | loss: 0.5060964
	speed: 0.0030s/iter; left time: 23.6701s
	iters: 500, epoch: 1 | loss: 1.2094616
	speed: 0.0031s/iter; left time: 24.1574s
	iters: 600, epoch: 1 | loss: 0.4121427
	speed: 0.0031s/iter; left time: 23.6754s
	iters: 700, epoch: 1 | loss: 1.2511148
	speed: 0.0031s/iter; left time: 23.6248s
	iters: 800, epoch: 1 | loss: 1.2332549
	speed: 0.0031s/iter; left time: 23.3078s
	iters: 900, epoch: 1 | loss: 1.0777656
	speed: 0.0031s/iter; left time: 22.8055s
	iters: 1000, epoch: 1 | loss: 0.5145337
	speed: 0.0031s/iter; left time: 22.4206s
Updating learning rate to 0.000402449602356342
Validation loss decreased (inf --> 0.3891).  Saving model state dict ...
Epoch: 1 cost time: 3.572615623474121
Epoch: 1, Steps: 1027 | Train Loss: 0.8775123 Vali Loss: 0.3891105 Best vali loss: 0.3891105
	iters: 100, epoch: 2 | loss: 0.4589630
	speed: 0.0091s/iter; left time: 64.7698s
	iters: 200, epoch: 2 | loss: 0.8066356
	speed: 0.0031s/iter; left time: 21.9158s
	iters: 300, epoch: 2 | loss: 0.4773579
	speed: 0.0031s/iter; left time: 21.6797s
	iters: 400, epoch: 2 | loss: 0.4176361
	speed: 0.0034s/iter; left time: 22.7499s
	iters: 500, epoch: 2 | loss: 0.2294242
	speed: 0.0034s/iter; left time: 22.7443s
	iters: 600, epoch: 2 | loss: 0.8904389
	speed: 0.0034s/iter; left time: 22.5864s
	iters: 700, epoch: 2 | loss: 0.7280897
	speed: 0.0034s/iter; left time: 22.2805s
	iters: 800, epoch: 2 | loss: 0.9683284
	speed: 0.0035s/iter; left time: 22.2514s
	iters: 900, epoch: 2 | loss: 0.3308226
	speed: 0.0034s/iter; left time: 21.6906s
	iters: 1000, epoch: 2 | loss: 0.3473902
	speed: 0.0034s/iter; left time: 21.2334s
Updating learning rate to 0.000357103671855977
Validation loss decreased (0.3891 --> 0.3744).  Saving model state dict ...
Epoch: 2 cost time: 3.4481239318847656
Epoch: 2, Steps: 1027 | Train Loss: 0.5655087 Vali Loss: 0.3744283 Best vali loss: 0.3744283
	iters: 100, epoch: 3 | loss: 1.0693495
	speed: 0.0093s/iter; left time: 56.1466s
	iters: 200, epoch: 3 | loss: 0.2033015
	speed: 0.0030s/iter; left time: 18.1056s
	iters: 300, epoch: 3 | loss: 0.7915702
	speed: 0.0031s/iter; left time: 18.0024s
	iters: 400, epoch: 3 | loss: 0.6905799
	speed: 0.0032s/iter; left time: 18.4934s
	iters: 500, epoch: 3 | loss: 0.4439191
	speed: 0.0034s/iter; left time: 19.4576s
	iters: 600, epoch: 3 | loss: 0.8310170
	speed: 0.0034s/iter; left time: 19.0814s
	iters: 700, epoch: 3 | loss: 0.8451408
	speed: 0.0034s/iter; left time: 18.8321s
	iters: 800, epoch: 3 | loss: 0.6813145
	speed: 0.0034s/iter; left time: 18.4859s
	iters: 900, epoch: 3 | loss: 0.3852260
	speed: 0.0034s/iter; left time: 18.1549s
	iters: 1000, epoch: 3 | loss: 1.0271738
	speed: 0.0034s/iter; left time: 17.7655s
Updating learning rate to 0.000289238690955702
Epoch: 3 cost time: 3.434030294418335
Epoch: 3, Steps: 1027 | Train Loss: 0.6968592 Vali Loss: 0.3785404 Best vali loss: 0.3744283
	iters: 100, epoch: 4 | loss: 0.9718208
	speed: 0.0096s/iter; left time: 48.3937s
	iters: 200, epoch: 4 | loss: 0.2662262
	speed: 0.0034s/iter; left time: 16.5820s
	iters: 300, epoch: 4 | loss: 0.3278186
	speed: 0.0034s/iter; left time: 16.2055s
	iters: 400, epoch: 4 | loss: 0.7789597
	speed: 0.0033s/iter; left time: 15.5596s
	iters: 500, epoch: 4 | loss: 0.2254235
	speed: 0.0031s/iter; left time: 14.2787s
	iters: 600, epoch: 4 | loss: 0.7120097
	speed: 0.0031s/iter; left time: 13.9522s
	iters: 700, epoch: 4 | loss: 0.9659721
	speed: 0.0031s/iter; left time: 13.7105s
	iters: 800, epoch: 4 | loss: 0.4184768
	speed: 0.0034s/iter; left time: 14.6688s
	iters: 900, epoch: 4 | loss: 0.2520641
	speed: 0.0033s/iter; left time: 14.1345s
	iters: 1000, epoch: 4 | loss: 0.3064752
	speed: 0.0033s/iter; left time: 13.7841s
Updating learning rate to 0.0002091864878
Epoch: 4 cost time: 3.397369146347046
Epoch: 4, Steps: 1027 | Train Loss: 0.5225247 Vali Loss: 0.3813654 Best vali loss: 0.3744283
	iters: 100, epoch: 5 | loss: 1.0096631
	speed: 0.0095s/iter; left time: 37.9571s
	iters: 200, epoch: 5 | loss: 0.4653041
	speed: 0.0030s/iter; left time: 11.8279s
	iters: 300, epoch: 5 | loss: 0.2891296
	speed: 0.0030s/iter; left time: 11.5971s
	iters: 400, epoch: 5 | loss: 0.7962970
	speed: 0.0030s/iter; left time: 11.2757s
	iters: 500, epoch: 5 | loss: 0.5397039
	speed: 0.0031s/iter; left time: 11.0225s
	iters: 600, epoch: 5 | loss: 0.2495195
	speed: 0.0031s/iter; left time: 10.7942s
	iters: 700, epoch: 5 | loss: 0.4821133
	speed: 0.0031s/iter; left time: 10.4335s
	iters: 800, epoch: 5 | loss: 0.5114281
	speed: 0.0031s/iter; left time: 10.1520s
	iters: 900, epoch: 5 | loss: 0.9584552
	speed: 0.0031s/iter; left time: 9.8215s
	iters: 1000, epoch: 5 | loss: 0.3369459
	speed: 0.0031s/iter; left time: 9.5212s
Updating learning rate to 0.00012913428464429803
Epoch: 5 cost time: 3.1793503761291504
Epoch: 5, Steps: 1027 | Train Loss: 0.5638560 Vali Loss: 0.3810417 Best vali loss: 0.3744283
	iters: 100, epoch: 6 | loss: 1.2430454
	speed: 0.0095s/iter; left time: 28.3899s
	iters: 200, epoch: 6 | loss: 0.3589083
	speed: 0.0033s/iter; left time: 9.6471s
	iters: 300, epoch: 6 | loss: 0.2393274
	speed: 0.0033s/iter; left time: 9.2503s
	iters: 400, epoch: 6 | loss: 0.4179781
	speed: 0.0034s/iter; left time: 9.0004s
	iters: 500, epoch: 6 | loss: 0.5925931
	speed: 0.0032s/iter; left time: 8.3354s
	iters: 600, epoch: 6 | loss: 0.2210482
	speed: 0.0031s/iter; left time: 7.6305s
	iters: 700, epoch: 6 | loss: 0.4184941
	speed: 0.0033s/iter; left time: 7.8817s
	iters: 800, epoch: 6 | loss: 0.7890547
	speed: 0.0034s/iter; left time: 7.6486s
	iters: 900, epoch: 6 | loss: 0.2408931
	speed: 0.0033s/iter; left time: 7.3003s
	iters: 1000, epoch: 6 | loss: 0.9933056
	speed: 0.0034s/iter; left time: 7.0251s
Updating learning rate to 6.126930374402302e-05
Epoch: 6 cost time: 3.4417335987091064
Epoch: 6, Steps: 1027 | Train Loss: 0.5514648 Vali Loss: 0.3856260 Best vali loss: 0.3744283
	iters: 100, epoch: 7 | loss: 0.2518430
	speed: 0.0094s/iter; left time: 18.4080s
	iters: 200, epoch: 7 | loss: 0.4400110
	speed: 0.0032s/iter; left time: 5.9977s
	iters: 300, epoch: 7 | loss: 0.4959907
	speed: 0.0032s/iter; left time: 5.5956s
	iters: 400, epoch: 7 | loss: 0.2086536
	speed: 0.0032s/iter; left time: 5.3171s
	iters: 500, epoch: 7 | loss: 0.2373025
	speed: 0.0031s/iter; left time: 4.7454s
	iters: 600, epoch: 7 | loss: 0.2998174
	speed: 0.0028s/iter; left time: 4.1065s
	iters: 700, epoch: 7 | loss: 0.5358241
	speed: 0.0028s/iter; left time: 3.8230s
	iters: 800, epoch: 7 | loss: 0.4301507
	speed: 0.0029s/iter; left time: 3.6415s
	iters: 900, epoch: 7 | loss: 0.8638720
	speed: 0.0030s/iter; left time: 3.4771s
	iters: 1000, epoch: 7 | loss: 0.4317404
	speed: 0.0030s/iter; left time: 3.1653s
Updating learning rate to 1.5923373243658013e-05
Epoch: 7 cost time: 3.153695821762085
Epoch: 7, Steps: 1027 | Train Loss: 0.4195205 Vali Loss: 0.3890358 Best vali loss: 0.3744283
	iters: 100, epoch: 8 | loss: 0.3965496
	speed: 0.0091s/iter; left time: 8.4082s
	iters: 200, epoch: 8 | loss: 0.2699313
	speed: 0.0031s/iter; left time: 2.5327s
	iters: 300, epoch: 8 | loss: 0.6532738
	speed: 0.0031s/iter; left time: 2.2369s
	iters: 400, epoch: 8 | loss: 0.6604527
	speed: 0.0031s/iter; left time: 1.9272s
	iters: 500, epoch: 8 | loss: 0.4464251
	speed: 0.0031s/iter; left time: 1.6211s
	iters: 600, epoch: 8 | loss: 1.0514674
	speed: 0.0030s/iter; left time: 1.3015s
	iters: 700, epoch: 8 | loss: 0.2203512
	speed: 0.0031s/iter; left time: 1.0005s
	iters: 800, epoch: 8 | loss: 0.5455997
	speed: 0.0030s/iter; left time: 0.6927s
	iters: 900, epoch: 8 | loss: 0.3019758
	speed: 0.0031s/iter; left time: 0.3930s
	iters: 1000, epoch: 8 | loss: 0.5637588
	speed: 0.0031s/iter; left time: 0.0863s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.183088541030884
Epoch: 8, Steps: 1027 | Train Loss: 0.5109786 Vali Loss: 0.3922843 Best vali loss: 0.3744283

best validation loss 0.3744283008786222

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0044267752575, 'e_layers': 3, 'learning_rate': 0.0002132020538, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7562147
	speed: 0.0111s/iter; left time: 21.6588s
	iters: 200, epoch: 1 | loss: 0.8303517
	speed: 0.0046s/iter; left time: 8.5405s
Updating learning rate to 0.0002050875337975951
Validation loss decreased (inf --> 0.3639).  Saving model state dict ...
Epoch: 1 cost time: 1.546541690826416
Epoch: 1, Steps: 257 | Train Loss: 0.7932832 Vali Loss: 0.3638763 Best vali loss: 0.3638763
	iters: 100, epoch: 2 | loss: 0.5797580
	speed: 0.0099s/iter; left time: 16.7926s
	iters: 200, epoch: 2 | loss: 0.4142500
	speed: 0.0047s/iter; left time: 7.5265s
Updating learning rate to 0.00018197933590243957
Validation loss decreased (0.3639 --> 0.3583).  Saving model state dict ...
Epoch: 2 cost time: 1.2486746311187744
Epoch: 2, Steps: 257 | Train Loss: 0.4970040 Vali Loss: 0.3582708 Best vali loss: 0.3582708
	iters: 100, epoch: 3 | loss: 0.3865770
	speed: 0.0099s/iter; left time: 14.2587s
	iters: 200, epoch: 3 | loss: 0.4699783
	speed: 0.0042s/iter; left time: 5.5824s
Updating learning rate to 0.00014739547376773528
Validation loss decreased (0.3583 --> 0.3569).  Saving model state dict ...
Epoch: 3 cost time: 1.151977777481079
Epoch: 3, Steps: 257 | Train Loss: 0.4282776 Vali Loss: 0.3569129 Best vali loss: 0.3569129
	iters: 100, epoch: 4 | loss: 0.4306420
	speed: 0.0089s/iter; left time: 10.6101s
	iters: 200, epoch: 4 | loss: 0.4096798
	speed: 0.0040s/iter; left time: 4.3561s
Updating learning rate to 0.0001066010269
Validation loss decreased (0.3569 --> 0.3514).  Saving model state dict ...
Epoch: 4 cost time: 1.0672743320465088
Epoch: 4, Steps: 257 | Train Loss: 0.4201609 Vali Loss: 0.3513618 Best vali loss: 0.3513618
	iters: 100, epoch: 5 | loss: 0.4179396
	speed: 0.0092s/iter; left time: 8.5484s
	iters: 200, epoch: 5 | loss: 0.3373428
	speed: 0.0042s/iter; left time: 3.4592s
Updating learning rate to 6.580658003226475e-05
Validation loss decreased (0.3514 --> 0.3498).  Saving model state dict ...
Epoch: 5 cost time: 1.1366515159606934
Epoch: 5, Steps: 257 | Train Loss: 0.3776412 Vali Loss: 0.3497995 Best vali loss: 0.3497995
	iters: 100, epoch: 6 | loss: 0.5058671
	speed: 0.0094s/iter; left time: 6.3027s
	iters: 200, epoch: 6 | loss: 0.5640622
	speed: 0.0040s/iter; left time: 2.2886s
Updating learning rate to 3.122271789756044e-05
Epoch: 6 cost time: 1.0881578922271729
Epoch: 6, Steps: 257 | Train Loss: 0.5349646 Vali Loss: 0.3523501 Best vali loss: 0.3497995
	iters: 100, epoch: 7 | loss: 0.3349153
	speed: 0.0085s/iter; left time: 3.5164s
	iters: 200, epoch: 7 | loss: 0.4523900
	speed: 0.0038s/iter; left time: 1.2051s
Updating learning rate to 8.114520002404897e-06
Epoch: 7 cost time: 1.0324537754058838
Epoch: 7, Steps: 257 | Train Loss: 0.3936526 Vali Loss: 0.3520446 Best vali loss: 0.3497995
	iters: 100, epoch: 8 | loss: 0.5414788
	speed: 0.0088s/iter; left time: 1.3950s
	iters: 200, epoch: 8 | loss: 0.5114599
	speed: 0.0040s/iter; left time: 0.2309s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.079862117767334
Epoch: 8, Steps: 257 | Train Loss: 0.5264693 Vali Loss: 0.3563797 Best vali loss: 0.3497995

best validation loss 0.3497995287824005

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0049016726633, 'e_layers': 2, 'learning_rate': 0.0004187670883, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8339698
	speed: 0.0094s/iter; left time: 75.9986s
	iters: 200, epoch: 1 | loss: 1.3574874
	speed: 0.0031s/iter; left time: 25.1248s
	iters: 300, epoch: 1 | loss: 0.3800045
	speed: 0.0031s/iter; left time: 24.7862s
	iters: 400, epoch: 1 | loss: 0.5042818
	speed: 0.0031s/iter; left time: 24.1730s
	iters: 500, epoch: 1 | loss: 1.1990629
	speed: 0.0031s/iter; left time: 24.0427s
	iters: 600, epoch: 1 | loss: 0.4172247
	speed: 0.0030s/iter; left time: 23.1098s
	iters: 700, epoch: 1 | loss: 1.2672744
	speed: 0.0030s/iter; left time: 22.2544s
	iters: 800, epoch: 1 | loss: 1.2355428
	speed: 0.0031s/iter; left time: 22.7388s
	iters: 900, epoch: 1 | loss: 1.1279091
	speed: 0.0031s/iter; left time: 22.8834s
	iters: 1000, epoch: 1 | loss: 0.5270204
	speed: 0.0031s/iter; left time: 22.4736s
Updating learning rate to 0.0004028287150348584
Validation loss decreased (inf --> 0.3984).  Saving model state dict ...
Epoch: 1 cost time: 3.5215342044830322
Epoch: 1, Steps: 1027 | Train Loss: 0.8849778 Vali Loss: 0.3984292 Best vali loss: 0.3984292
	iters: 100, epoch: 2 | loss: 0.4703078
	speed: 0.0091s/iter; left time: 64.7984s
	iters: 200, epoch: 2 | loss: 0.7912961
	speed: 0.0030s/iter; left time: 20.9220s
	iters: 300, epoch: 2 | loss: 0.4390334
	speed: 0.0030s/iter; left time: 20.6318s
	iters: 400, epoch: 2 | loss: 0.3792280
	speed: 0.0030s/iter; left time: 20.5717s
	iters: 500, epoch: 2 | loss: 0.2584006
	speed: 0.0030s/iter; left time: 19.8883s
	iters: 600, epoch: 2 | loss: 0.8945310
	speed: 0.0029s/iter; left time: 19.3661s
	iters: 700, epoch: 2 | loss: 0.7221946
	speed: 0.0029s/iter; left time: 18.9098s
	iters: 800, epoch: 2 | loss: 0.9615884
	speed: 0.0029s/iter; left time: 18.7609s
	iters: 900, epoch: 2 | loss: 0.3312568
	speed: 0.0029s/iter; left time: 18.3137s
	iters: 1000, epoch: 2 | loss: 0.4299604
	speed: 0.0029s/iter; left time: 18.1689s
Updating learning rate to 0.0003574400680873379
Validation loss decreased (0.3984 --> 0.3780).  Saving model state dict ...
Epoch: 2 cost time: 3.073378324508667
Epoch: 2, Steps: 1027 | Train Loss: 0.5677797 Vali Loss: 0.3779964 Best vali loss: 0.3779964
	iters: 100, epoch: 3 | loss: 1.0286400
	speed: 0.0097s/iter; left time: 58.6256s
	iters: 200, epoch: 3 | loss: 0.2040474
	speed: 0.0034s/iter; left time: 20.1573s
	iters: 300, epoch: 3 | loss: 0.7968507
	speed: 0.0034s/iter; left time: 19.7384s
	iters: 400, epoch: 3 | loss: 0.5492985
	speed: 0.0034s/iter; left time: 19.7673s
	iters: 500, epoch: 3 | loss: 0.4783781
	speed: 0.0034s/iter; left time: 19.4108s
	iters: 600, epoch: 3 | loss: 0.8148477
	speed: 0.0034s/iter; left time: 18.9243s
	iters: 700, epoch: 3 | loss: 0.8910686
	speed: 0.0034s/iter; left time: 18.5257s
	iters: 800, epoch: 3 | loss: 0.6278694
	speed: 0.0034s/iter; left time: 18.4596s
	iters: 900, epoch: 3 | loss: 0.3617100
	speed: 0.0034s/iter; left time: 18.0723s
	iters: 1000, epoch: 3 | loss: 1.1243054
	speed: 0.0034s/iter; left time: 17.7677s
Updating learning rate to 0.00028951115750608933
Validation loss decreased (0.3780 --> 0.3690).  Saving model state dict ...
Epoch: 3 cost time: 3.551435708999634
Epoch: 3, Steps: 1027 | Train Loss: 0.6877016 Vali Loss: 0.3689712 Best vali loss: 0.3689712

best validation loss 0.3689711738370491

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022144307704, 'e_layers': 2, 'learning_rate': 0.0004349287236, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8133426
	speed: 0.0098s/iter; left time: 39.2283s
	iters: 200, epoch: 1 | loss: 0.3331170
	speed: 0.0036s/iter; left time: 14.1624s
	iters: 300, epoch: 1 | loss: 0.5260831
	speed: 0.0035s/iter; left time: 13.2505s
	iters: 400, epoch: 1 | loss: 1.0870990
	speed: 0.0034s/iter; left time: 12.6580s
	iters: 500, epoch: 1 | loss: 0.9020900
	speed: 0.0035s/iter; left time: 12.6766s
Updating learning rate to 0.00041837523471764936
Validation loss decreased (inf --> 0.3878).  Saving model state dict ...
Epoch: 1 cost time: 2.1627848148345947
Epoch: 1, Steps: 514 | Train Loss: 0.7323463 Vali Loss: 0.3878432 Best vali loss: 0.3878432
	iters: 100, epoch: 2 | loss: 1.2890171
	speed: 0.0071s/iter; left time: 25.0150s
	iters: 200, epoch: 2 | loss: 0.6653399
	speed: 0.0032s/iter; left time: 10.7645s
	iters: 300, epoch: 2 | loss: 0.6813130
	speed: 0.0031s/iter; left time: 10.2477s
	iters: 400, epoch: 2 | loss: 0.6256192
	speed: 0.0032s/iter; left time: 10.1647s
	iters: 500, epoch: 2 | loss: 0.6681616
	speed: 0.0032s/iter; left time: 9.8862s
Updating learning rate to 0.0003712348866951848
Validation loss decreased (0.3878 --> 0.3728).  Saving model state dict ...
Epoch: 2 cost time: 1.6757807731628418
Epoch: 2, Steps: 514 | Train Loss: 0.7858902 Vali Loss: 0.3727586 Best vali loss: 0.3727586
	iters: 100, epoch: 3 | loss: 0.4850798
	speed: 0.0070s/iter; left time: 20.8883s
	iters: 200, epoch: 3 | loss: 0.4283629
	speed: 0.0030s/iter; left time: 8.6271s
	iters: 300, epoch: 3 | loss: 0.5016093
	speed: 0.0030s/iter; left time: 8.3107s
	iters: 400, epoch: 3 | loss: 0.4996978
	speed: 0.0030s/iter; left time: 8.0105s
	iters: 500, epoch: 3 | loss: 1.1716689
	speed: 0.0031s/iter; left time: 8.0152s
Updating learning rate to 0.00030068437019070774
Validation loss decreased (0.3728 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 1.5935537815093994
Epoch: 3, Steps: 514 | Train Loss: 0.6172837 Vali Loss: 0.3644484 Best vali loss: 0.3644484

best validation loss 0.36444837554615933

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022138270954, 'e_layers': 2, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8179651
	speed: 0.0101s/iter; left time: 19.8342s
	iters: 200, epoch: 1 | loss: 0.5298755
	speed: 0.0038s/iter; left time: 7.1323s
Updating learning rate to 0.0003789142607398986
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 1.3485076427459717
Epoch: 1, Steps: 257 | Train Loss: 0.6739203 Vali Loss: 0.3646884 Best vali loss: 0.3646884
	iters: 100, epoch: 2 | loss: 0.3367946
	speed: 0.0083s/iter; left time: 14.1426s
	iters: 200, epoch: 2 | loss: 0.4659381
	speed: 0.0035s/iter; left time: 5.6503s
Updating learning rate to 0.00033622017026867744
Epoch: 2 cost time: 0.9663407802581787
Epoch: 2, Steps: 257 | Train Loss: 0.4013664 Vali Loss: 0.3648935 Best vali loss: 0.3646884
	iters: 100, epoch: 3 | loss: 0.6531180
	speed: 0.0082s/iter; left time: 11.8290s
	iters: 200, epoch: 3 | loss: 0.4062406
	speed: 0.0037s/iter; left time: 4.9126s
Updating learning rate to 0.00027232394843768623
Validation loss decreased (0.3647 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 0.9969186782836914
Epoch: 3, Steps: 257 | Train Loss: 0.5296793 Vali Loss: 0.3609275 Best vali loss: 0.3609275

best validation loss 0.36092748801225766

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022138270954, 'e_layers': 2, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6692042
	speed: 0.0103s/iter; left time: 12.2320s
	iters: 200, epoch: 4 | loss: 0.5065782
	speed: 0.0038s/iter; left time: 4.1779s
Updating learning rate to 0.0001969532158
Validation loss decreased (0.3609 --> 0.3561).  Saving model state dict ...
Epoch: 4 cost time: 1.3415839672088623
Epoch: 4, Steps: 257 | Train Loss: 0.5878912 Vali Loss: 0.3561104 Best vali loss: 0.3561104
	iters: 100, epoch: 5 | loss: 0.3058378
	speed: 0.0079s/iter; left time: 7.3819s
	iters: 200, epoch: 5 | loss: 0.3712570
	speed: 0.0033s/iter; left time: 2.7718s
Updating learning rate to 0.00012158248316231378
Epoch: 5 cost time: 0.913841724395752
Epoch: 5, Steps: 257 | Train Loss: 0.3385474 Vali Loss: 0.3635653 Best vali loss: 0.3561104
	iters: 100, epoch: 6 | loss: 0.5664570
	speed: 0.0077s/iter; left time: 5.1983s
	iters: 200, epoch: 6 | loss: 0.3507336
	speed: 0.0033s/iter; left time: 1.8777s
Updating learning rate to 5.768626133132254e-05
Epoch: 6 cost time: 0.9077632427215576
Epoch: 6, Steps: 257 | Train Loss: 0.4585953 Vali Loss: 0.3688995 Best vali loss: 0.3561104
	iters: 100, epoch: 7 | loss: 0.4649127
	speed: 0.0075s/iter; left time: 3.1257s
	iters: 200, epoch: 7 | loss: 0.4756594
	speed: 0.0034s/iter; left time: 1.0729s
Updating learning rate to 1.4992170860101427e-05
Validation loss decreased (0.3561 --> 0.3534).  Saving model state dict ...
Epoch: 7 cost time: 0.9125816822052002
Epoch: 7, Steps: 257 | Train Loss: 0.4702860 Vali Loss: 0.3533802 Best vali loss: 0.3533802
	iters: 100, epoch: 8 | loss: 0.5577980
	speed: 0.0079s/iter; left time: 1.2445s
	iters: 200, epoch: 8 | loss: 0.5830981
	speed: 0.0033s/iter; left time: 0.1910s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.9101986885070801
Epoch: 8, Steps: 257 | Train Loss: 0.5704480 Vali Loss: 0.3572814 Best vali loss: 0.3533802

best validation loss 0.35338019334028653

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.002206786331, 'e_layers': 2, 'learning_rate': 0.000408907268, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3344657
	speed: 0.0093s/iter; left time: 75.4836s
	iters: 200, epoch: 1 | loss: 0.4891034
	speed: 0.0033s/iter; left time: 26.5865s
	iters: 300, epoch: 1 | loss: 0.3285037
	speed: 0.0033s/iter; left time: 25.9617s
	iters: 400, epoch: 1 | loss: 1.8133800
	speed: 0.0032s/iter; left time: 25.3316s
	iters: 500, epoch: 1 | loss: 0.7696945
	speed: 0.0033s/iter; left time: 25.4576s
	iters: 600, epoch: 1 | loss: 1.4742475
	speed: 0.0033s/iter; left time: 24.9144s
	iters: 700, epoch: 1 | loss: 1.4425586
	speed: 0.0033s/iter; left time: 24.6463s
	iters: 800, epoch: 1 | loss: 0.6017665
	speed: 0.0033s/iter; left time: 24.2551s
	iters: 900, epoch: 1 | loss: 1.1044415
	speed: 0.0031s/iter; left time: 22.9362s
	iters: 1000, epoch: 1 | loss: 1.2001917
	speed: 0.0032s/iter; left time: 22.7757s
Updating learning rate to 0.0003933441618001537
Validation loss decreased (inf --> 0.3821).  Saving model state dict ...
Epoch: 1 cost time: 3.6856935024261475
Epoch: 1, Steps: 1027 | Train Loss: 0.9558353 Vali Loss: 0.3821084 Best vali loss: 0.3821084
	iters: 100, epoch: 2 | loss: 0.2985629
	speed: 0.0092s/iter; left time: 65.1533s
	iters: 200, epoch: 2 | loss: 0.2613594
	speed: 0.0030s/iter; left time: 21.1049s
	iters: 300, epoch: 2 | loss: 0.9448361
	speed: 0.0031s/iter; left time: 21.2471s
	iters: 400, epoch: 2 | loss: 0.3135031
	speed: 0.0033s/iter; left time: 22.6742s
	iters: 500, epoch: 2 | loss: 0.2897185
	speed: 0.0033s/iter; left time: 22.3319s
	iters: 600, epoch: 2 | loss: 0.3411055
	speed: 0.0033s/iter; left time: 21.8810s
	iters: 700, epoch: 2 | loss: 0.4671744
	speed: 0.0032s/iter; left time: 20.6964s
	iters: 800, epoch: 2 | loss: 0.4666618
	speed: 0.0031s/iter; left time: 19.8752s
	iters: 900, epoch: 2 | loss: 0.5074885
	speed: 0.0030s/iter; left time: 18.8590s
	iters: 1000, epoch: 2 | loss: 0.5509030
	speed: 0.0030s/iter; left time: 18.6314s
Updating learning rate to 0.00034902418503963246
Validation loss decreased (0.3821 --> 0.3773).  Saving model state dict ...
Epoch: 2 cost time: 3.269721269607544
Epoch: 2, Steps: 1027 | Train Loss: 0.4441313 Vali Loss: 0.3772888 Best vali loss: 0.3772888
	iters: 100, epoch: 3 | loss: 1.0125844
	speed: 0.0094s/iter; left time: 57.1886s
	iters: 200, epoch: 3 | loss: 0.4305703
	speed: 0.0030s/iter; left time: 17.9548s
	iters: 300, epoch: 3 | loss: 0.4640847
	speed: 0.0030s/iter; left time: 17.7029s
	iters: 400, epoch: 3 | loss: 1.1411092
	speed: 0.0032s/iter; left time: 18.6119s
	iters: 500, epoch: 3 | loss: 0.6846043
	speed: 0.0030s/iter; left time: 17.2595s
	iters: 600, epoch: 3 | loss: 0.4511326
	speed: 0.0032s/iter; left time: 17.6237s
	iters: 700, epoch: 3 | loss: 0.4129262
	speed: 0.0031s/iter; left time: 17.0826s
	iters: 800, epoch: 3 | loss: 0.4479192
	speed: 0.0032s/iter; left time: 17.4069s
	iters: 900, epoch: 3 | loss: 0.6453694
	speed: 0.0031s/iter; left time: 16.2240s
	iters: 1000, epoch: 3 | loss: 1.1729057
	speed: 0.0031s/iter; left time: 16.0701s
Updating learning rate to 0.0002826946524186358
Epoch: 3 cost time: 3.233287811279297
Epoch: 3, Steps: 1027 | Train Loss: 0.6863206 Vali Loss: 0.3889557 Best vali loss: 0.3772888
	iters: 100, epoch: 4 | loss: 1.3555382
	speed: 0.0096s/iter; left time: 48.4020s
	iters: 200, epoch: 4 | loss: 0.7745077
	speed: 0.0033s/iter; left time: 16.5245s
	iters: 300, epoch: 4 | loss: 0.2420371
	speed: 0.0033s/iter; left time: 16.1443s
	iters: 400, epoch: 4 | loss: 0.7051185
	speed: 0.0033s/iter; left time: 15.8656s
	iters: 500, epoch: 4 | loss: 1.2603135
	speed: 0.0033s/iter; left time: 15.4906s
	iters: 600, epoch: 4 | loss: 0.8101640
	speed: 0.0033s/iter; left time: 15.1477s
	iters: 700, epoch: 4 | loss: 0.2620095
	speed: 0.0033s/iter; left time: 14.7244s
	iters: 800, epoch: 4 | loss: 0.2274776
	speed: 0.0033s/iter; left time: 14.4580s
	iters: 900, epoch: 4 | loss: 1.1170791
	speed: 0.0033s/iter; left time: 14.1303s
	iters: 1000, epoch: 4 | loss: 0.7214090
	speed: 0.0033s/iter; left time: 13.8184s
Updating learning rate to 0.000204453634
Epoch: 4 cost time: 3.471721887588501
Epoch: 4, Steps: 1027 | Train Loss: 0.7475654 Vali Loss: 0.3971502 Best vali loss: 0.3772888
	iters: 100, epoch: 5 | loss: 0.8565649
	speed: 0.0096s/iter; left time: 38.5975s
	iters: 200, epoch: 5 | loss: 0.7327443
	speed: 0.0033s/iter; left time: 12.8816s
	iters: 300, epoch: 5 | loss: 0.8549150
	speed: 0.0033s/iter; left time: 12.6970s
	iters: 400, epoch: 5 | loss: 0.9650689
	speed: 0.0033s/iter; left time: 12.3635s
	iters: 500, epoch: 5 | loss: 0.7816697
	speed: 0.0033s/iter; left time: 12.0221s
	iters: 600, epoch: 5 | loss: 0.5491064
	speed: 0.0033s/iter; left time: 11.6177s
	iters: 700, epoch: 5 | loss: 1.2085681
	speed: 0.0033s/iter; left time: 11.3155s
	iters: 800, epoch: 5 | loss: 1.2608626
	speed: 0.0033s/iter; left time: 11.0275s
	iters: 900, epoch: 5 | loss: 0.2698234
	speed: 0.0033s/iter; left time: 10.6335s
	iters: 1000, epoch: 5 | loss: 0.3109811
	speed: 0.0033s/iter; left time: 10.3119s
Updating learning rate to 0.00012621261558136418
Epoch: 5 cost time: 3.4583611488342285
Epoch: 5, Steps: 1027 | Train Loss: 0.7790304 Vali Loss: 0.4047915 Best vali loss: 0.3772888
	iters: 100, epoch: 6 | loss: 0.6451287
	speed: 0.0093s/iter; left time: 27.7504s
	iters: 200, epoch: 6 | loss: 0.2176204
	speed: 0.0033s/iter; left time: 9.4779s
	iters: 300, epoch: 6 | loss: 0.7256603
	speed: 0.0034s/iter; left time: 9.5884s
	iters: 400, epoch: 6 | loss: 0.4785655
	speed: 0.0034s/iter; left time: 9.2486s
	iters: 500, epoch: 6 | loss: 0.2448047
	speed: 0.0035s/iter; left time: 9.0376s
	iters: 600, epoch: 6 | loss: 0.4814585
	speed: 0.0035s/iter; left time: 8.6602s
	iters: 700, epoch: 6 | loss: 0.3380412
	speed: 0.0033s/iter; left time: 7.8456s
	iters: 800, epoch: 6 | loss: 0.3162404
	speed: 0.0033s/iter; left time: 7.4631s
	iters: 900, epoch: 6 | loss: 0.4582544
	speed: 0.0032s/iter; left time: 7.0662s
	iters: 1000, epoch: 6 | loss: 1.2346494
	speed: 0.0033s/iter; left time: 6.9239s
Updating learning rate to 5.9883082960367535e-05
Epoch: 6 cost time: 3.488326072692871
Epoch: 6, Steps: 1027 | Train Loss: 0.5140424 Vali Loss: 0.4193414 Best vali loss: 0.3772888
	iters: 100, epoch: 7 | loss: 0.3485399
	speed: 0.0095s/iter; left time: 18.5793s
	iters: 200, epoch: 7 | loss: 0.3580695
	speed: 0.0033s/iter; left time: 6.1535s
	iters: 300, epoch: 7 | loss: 0.3662511
	speed: 0.0033s/iter; left time: 5.7846s
	iters: 400, epoch: 7 | loss: 0.1876964
	speed: 0.0033s/iter; left time: 5.5220s
	iters: 500, epoch: 7 | loss: 0.2726093
	speed: 0.0033s/iter; left time: 5.2068s
	iters: 600, epoch: 7 | loss: 0.3707384
	speed: 0.0033s/iter; left time: 4.7931s
	iters: 700, epoch: 7 | loss: 0.5078742
	speed: 0.0033s/iter; left time: 4.5218s
	iters: 800, epoch: 7 | loss: 0.3886715
	speed: 0.0033s/iter; left time: 4.1414s
	iters: 900, epoch: 7 | loss: 0.2030056
	speed: 0.0033s/iter; left time: 3.8434s
	iters: 1000, epoch: 7 | loss: 0.6474208
	speed: 0.0033s/iter; left time: 3.5245s
Updating learning rate to 1.556310619984628e-05
Epoch: 7 cost time: 3.453474760055542
Epoch: 7, Steps: 1027 | Train Loss: 0.3650877 Vali Loss: 0.4162384 Best vali loss: 0.3772888
	iters: 100, epoch: 8 | loss: 1.1328055
	speed: 0.0095s/iter; left time: 8.8320s
	iters: 200, epoch: 8 | loss: 0.3179979
	speed: 0.0034s/iter; left time: 2.8193s
	iters: 300, epoch: 8 | loss: 0.4973650
	speed: 0.0035s/iter; left time: 2.5117s
	iters: 400, epoch: 8 | loss: 0.1935077
	speed: 0.0034s/iter; left time: 2.1344s
	iters: 500, epoch: 8 | loss: 0.4666949
	speed: 0.0033s/iter; left time: 1.7587s
	iters: 600, epoch: 8 | loss: 0.3114189
	speed: 0.0033s/iter; left time: 1.4319s
	iters: 700, epoch: 8 | loss: 0.7541317
	speed: 0.0033s/iter; left time: 1.0896s
	iters: 800, epoch: 8 | loss: 0.3248491
	speed: 0.0030s/iter; left time: 0.6902s
	iters: 900, epoch: 8 | loss: 0.3655173
	speed: 0.0031s/iter; left time: 0.3910s
	iters: 1000, epoch: 8 | loss: 0.2482691
	speed: 0.0031s/iter; left time: 0.0878s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4018497467041016
Epoch: 8, Steps: 1027 | Train Loss: 0.4612557 Vali Loss: 0.4213713 Best vali loss: 0.3772888

best validation loss 0.37728882220615806

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0072817655644, 'e_layers': 1, 'learning_rate': 0.0008949121542, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4851807
	speed: 0.0085s/iter; left time: 69.1145s
	iters: 200, epoch: 1 | loss: 0.7801917
	speed: 0.0021s/iter; left time: 16.5051s
	iters: 300, epoch: 1 | loss: 0.4087099
	speed: 0.0021s/iter; left time: 16.4050s
	iters: 400, epoch: 1 | loss: 0.2342537
	speed: 0.0020s/iter; left time: 15.9071s
	iters: 500, epoch: 1 | loss: 0.8740765
	speed: 0.0021s/iter; left time: 15.8738s
	iters: 600, epoch: 1 | loss: 0.7235749
	speed: 0.0020s/iter; left time: 15.4435s
	iters: 700, epoch: 1 | loss: 0.5450324
	speed: 0.0020s/iter; left time: 15.2439s
	iters: 800, epoch: 1 | loss: 0.4843910
	speed: 0.0021s/iter; left time: 15.2609s
	iters: 900, epoch: 1 | loss: 0.3404489
	speed: 0.0021s/iter; left time: 15.0564s
	iters: 1000, epoch: 1 | loss: 0.2883090
	speed: 0.0021s/iter; left time: 14.8528s
Updating learning rate to 0.0008608515884304822
Validation loss decreased (inf --> 0.3782).  Saving model state dict ...
Epoch: 1 cost time: 2.4790279865264893
Epoch: 1, Steps: 1027 | Train Loss: 0.6164169 Vali Loss: 0.3781501 Best vali loss: 0.3781501
	iters: 100, epoch: 2 | loss: 1.7377191
	speed: 0.0084s/iter; left time: 59.6859s
	iters: 200, epoch: 2 | loss: 0.2741188
	speed: 0.0024s/iter; left time: 16.5962s
	iters: 300, epoch: 2 | loss: 0.2612917
	speed: 0.0024s/iter; left time: 16.4237s
	iters: 400, epoch: 2 | loss: 0.3180434
	speed: 0.0024s/iter; left time: 16.0612s
	iters: 500, epoch: 2 | loss: 0.4482220
	speed: 0.0024s/iter; left time: 16.0140s
	iters: 600, epoch: 2 | loss: 0.7991154
	speed: 0.0024s/iter; left time: 15.6685s
	iters: 700, epoch: 2 | loss: 0.5201814
	speed: 0.0024s/iter; left time: 15.4367s
	iters: 800, epoch: 2 | loss: 0.7423681
	speed: 0.0024s/iter; left time: 15.1310s
	iters: 900, epoch: 2 | loss: 0.5165116
	speed: 0.0024s/iter; left time: 14.9622s
	iters: 1000, epoch: 2 | loss: 0.4801863
	speed: 0.0024s/iter; left time: 14.6412s
Updating learning rate to 0.0007638553035005406
Validation loss decreased (0.3782 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 2.47892165184021
Epoch: 2, Steps: 1027 | Train Loss: 0.6097758 Vali Loss: 0.3694374 Best vali loss: 0.3694374
	iters: 100, epoch: 3 | loss: 0.5024821
	speed: 0.0077s/iter; left time: 46.9066s
	iters: 200, epoch: 3 | loss: 0.3483584
	speed: 0.0024s/iter; left time: 14.1899s
	iters: 300, epoch: 3 | loss: 0.4824180
	speed: 0.0024s/iter; left time: 13.9029s
	iters: 400, epoch: 3 | loss: 1.4115578
	speed: 0.0024s/iter; left time: 13.6574s
	iters: 500, epoch: 3 | loss: 0.3497217
	speed: 0.0024s/iter; left time: 13.3193s
	iters: 600, epoch: 3 | loss: 0.2612412
	speed: 0.0024s/iter; left time: 13.2321s
	iters: 700, epoch: 3 | loss: 0.6966645
	speed: 0.0024s/iter; left time: 13.0225s
	iters: 800, epoch: 3 | loss: 1.0029681
	speed: 0.0024s/iter; left time: 12.8740s
	iters: 900, epoch: 3 | loss: 0.7213454
	speed: 0.0024s/iter; left time: 12.5046s
	iters: 1000, epoch: 3 | loss: 0.9771616
	speed: 0.0023s/iter; left time: 12.1088s
Updating learning rate to 0.0006186901045172463
Validation loss decreased (0.3694 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 2.4657325744628906
Epoch: 3, Steps: 1027 | Train Loss: 0.6753919 Vali Loss: 0.3661890 Best vali loss: 0.3661890
	iters: 100, epoch: 4 | loss: 0.2979726
	speed: 0.0077s/iter; left time: 38.5524s
	iters: 200, epoch: 4 | loss: 0.1833568
	speed: 0.0024s/iter; left time: 12.0401s
	iters: 300, epoch: 4 | loss: 0.6452169
	speed: 0.0024s/iter; left time: 11.8022s
	iters: 400, epoch: 4 | loss: 0.3218194
	speed: 0.0024s/iter; left time: 11.5340s
	iters: 500, epoch: 4 | loss: 0.6008694
	speed: 0.0024s/iter; left time: 11.1632s
	iters: 600, epoch: 4 | loss: 0.2187847
	speed: 0.0024s/iter; left time: 11.0421s
	iters: 700, epoch: 4 | loss: 0.8719435
	speed: 0.0024s/iter; left time: 10.8652s
	iters: 800, epoch: 4 | loss: 0.4407959
	speed: 0.0025s/iter; left time: 10.7450s
	iters: 900, epoch: 4 | loss: 0.4962668
	speed: 0.0025s/iter; left time: 10.4693s
	iters: 1000, epoch: 4 | loss: 0.4774129
	speed: 0.0025s/iter; left time: 10.1394s
Updating learning rate to 0.0004474560771
Epoch: 4 cost time: 2.5502045154571533
Epoch: 4, Steps: 1027 | Train Loss: 0.4554439 Vali Loss: 0.3830626 Best vali loss: 0.3661890
	iters: 100, epoch: 5 | loss: 0.2994791
	speed: 0.0073s/iter; left time: 29.2628s
	iters: 200, epoch: 5 | loss: 1.0379328
	speed: 0.0021s/iter; left time: 8.3113s
	iters: 300, epoch: 5 | loss: 0.4842562
	speed: 0.0022s/iter; left time: 8.2649s
	iters: 400, epoch: 5 | loss: 0.6449713
	speed: 0.0021s/iter; left time: 7.6970s
	iters: 500, epoch: 5 | loss: 1.4320338
	speed: 0.0021s/iter; left time: 7.6288s
	iters: 600, epoch: 5 | loss: 0.4033017
	speed: 0.0020s/iter; left time: 7.1079s
	iters: 700, epoch: 5 | loss: 0.2672340
	speed: 0.0021s/iter; left time: 7.1496s
	iters: 800, epoch: 5 | loss: 0.2291994
	speed: 0.0021s/iter; left time: 7.0760s
	iters: 900, epoch: 5 | loss: 0.2223697
	speed: 0.0021s/iter; left time: 6.6613s
	iters: 1000, epoch: 5 | loss: 0.4057057
	speed: 0.0021s/iter; left time: 6.4783s
Updating learning rate to 0.00027622204968275375
Epoch: 5 cost time: 2.20473313331604
Epoch: 5, Steps: 1027 | Train Loss: 0.5426484 Vali Loss: 0.3849212 Best vali loss: 0.3661890
	iters: 100, epoch: 6 | loss: 0.7719612
	speed: 0.0071s/iter; left time: 21.1449s
	iters: 200, epoch: 6 | loss: 0.4270389
	speed: 0.0020s/iter; left time: 5.8753s
	iters: 300, epoch: 6 | loss: 0.2337311
	speed: 0.0020s/iter; left time: 5.6366s
	iters: 400, epoch: 6 | loss: 0.5582348
	speed: 0.0021s/iter; left time: 5.5710s
	iters: 500, epoch: 6 | loss: 0.5972940
	speed: 0.0020s/iter; left time: 5.2729s
	iters: 600, epoch: 6 | loss: 0.8052865
	speed: 0.0021s/iter; left time: 5.1490s
	iters: 700, epoch: 6 | loss: 0.4674158
	speed: 0.0020s/iter; left time: 4.8751s
	iters: 800, epoch: 6 | loss: 0.3888213
	speed: 0.0022s/iter; left time: 5.1187s
	iters: 900, epoch: 6 | loss: 0.5430327
	speed: 0.0022s/iter; left time: 4.8939s
	iters: 1000, epoch: 6 | loss: 0.3530436
	speed: 0.0022s/iter; left time: 4.6571s
Updating learning rate to 0.0001310568506994594
Epoch: 6 cost time: 2.2123048305511475
Epoch: 6, Steps: 1027 | Train Loss: 0.5145860 Vali Loss: 0.3843829 Best vali loss: 0.3661890
	iters: 100, epoch: 7 | loss: 0.5065686
	speed: 0.0076s/iter; left time: 14.9179s
	iters: 200, epoch: 7 | loss: 1.0457399
	speed: 0.0024s/iter; left time: 4.4023s
	iters: 300, epoch: 7 | loss: 0.4290798
	speed: 0.0024s/iter; left time: 4.1888s
	iters: 400, epoch: 7 | loss: 0.7945176
	speed: 0.0024s/iter; left time: 3.9438s
	iters: 500, epoch: 7 | loss: 0.3721930
	speed: 0.0024s/iter; left time: 3.6769s
	iters: 600, epoch: 7 | loss: 0.4808210
	speed: 0.0024s/iter; left time: 3.4485s
	iters: 700, epoch: 7 | loss: 0.3717521
	speed: 0.0024s/iter; left time: 3.2218s
	iters: 800, epoch: 7 | loss: 0.7807332
	speed: 0.0024s/iter; left time: 2.9516s
	iters: 900, epoch: 7 | loss: 1.2067443
	speed: 0.0024s/iter; left time: 2.7282s
	iters: 1000, epoch: 7 | loss: 0.5991883
	speed: 0.0024s/iter; left time: 2.5170s
Updating learning rate to 3.4060565769517725e-05
Epoch: 7 cost time: 2.493852376937866
Epoch: 7, Steps: 1027 | Train Loss: 0.6587338 Vali Loss: 0.3917708 Best vali loss: 0.3661890
	iters: 100, epoch: 8 | loss: 0.4413124
	speed: 0.0071s/iter; left time: 6.6126s
	iters: 200, epoch: 8 | loss: 0.2526086
	speed: 0.0021s/iter; left time: 1.7372s
	iters: 300, epoch: 8 | loss: 0.2927969
	speed: 0.0021s/iter; left time: 1.5155s
	iters: 400, epoch: 8 | loss: 0.2146325
	speed: 0.0021s/iter; left time: 1.3120s
	iters: 500, epoch: 8 | loss: 0.3430836
	speed: 0.0021s/iter; left time: 1.0973s
	iters: 600, epoch: 8 | loss: 0.3761911
	speed: 0.0021s/iter; left time: 0.8907s
	iters: 700, epoch: 8 | loss: 0.6241016
	speed: 0.0021s/iter; left time: 0.6846s
	iters: 800, epoch: 8 | loss: 0.7874120
	speed: 0.0021s/iter; left time: 0.4751s
	iters: 900, epoch: 8 | loss: 0.2104786
	speed: 0.0021s/iter; left time: 0.2666s
	iters: 1000, epoch: 8 | loss: 0.4637466
	speed: 0.0021s/iter; left time: 0.0585s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.181293487548828
Epoch: 8, Steps: 1027 | Train Loss: 0.4006364 Vali Loss: 0.3949628 Best vali loss: 0.3661890

best validation loss 0.36618904426898846

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021942137147, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7163374
	speed: 0.0107s/iter; left time: 9.9796s
Updating learning rate to 0.00039412601865045424
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 0.9179434776306152
Epoch: 1, Steps: 129 | Train Loss: 0.7163374 Vali Loss: 0.3699069 Best vali loss: 0.3699069
	iters: 100, epoch: 2 | loss: 0.5765675
	speed: 0.0069s/iter; left time: 5.5122s
Updating learning rate to 0.00034971794632172426
Epoch: 2 cost time: 0.5285851955413818
Epoch: 2, Steps: 129 | Train Loss: 0.5765675 Vali Loss: 0.3849243 Best vali loss: 0.3699069
	iters: 100, epoch: 3 | loss: 0.6571044
	speed: 0.0073s/iter; left time: 4.9217s
Updating learning rate to 0.00028325656936568113
Validation loss decreased (0.3699 --> 0.3539).  Saving model state dict ...
Epoch: 3 cost time: 0.5838041305541992
Epoch: 3, Steps: 129 | Train Loss: 0.6571044 Vali Loss: 0.3539243 Best vali loss: 0.3539243

best validation loss 0.35392426341362226

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4265060
	speed: 0.0093s/iter; left time: 37.2240s
	iters: 200, epoch: 1 | loss: 0.9919249
	speed: 0.0033s/iter; left time: 13.0260s
	iters: 300, epoch: 1 | loss: 0.3777761
	speed: 0.0035s/iter; left time: 13.2065s
	iters: 400, epoch: 1 | loss: 0.6767088
	speed: 0.0035s/iter; left time: 12.9180s
	iters: 500, epoch: 1 | loss: 0.3888965
	speed: 0.0033s/iter; left time: 11.8724s
Updating learning rate to 0.0003957152226005332
Validation loss decreased (inf --> 0.3579).  Saving model state dict ...
Epoch: 1 cost time: 2.0754709243774414
Epoch: 1, Steps: 514 | Train Loss: 0.5723625 Vali Loss: 0.3578568 Best vali loss: 0.3578568
	iters: 100, epoch: 2 | loss: 1.3575610
	speed: 0.0071s/iter; left time: 25.0118s
	iters: 200, epoch: 2 | loss: 0.6999198
	speed: 0.0031s/iter; left time: 10.6641s
	iters: 300, epoch: 2 | loss: 0.7718446
	speed: 0.0031s/iter; left time: 10.2445s
	iters: 400, epoch: 2 | loss: 0.2945435
	speed: 0.0031s/iter; left time: 10.0386s
	iters: 500, epoch: 2 | loss: 0.2734940
	speed: 0.0033s/iter; left time: 10.1029s
Updating learning rate to 0.00035112808702649433
Epoch: 2 cost time: 1.6741092205047607
Epoch: 2, Steps: 514 | Train Loss: 0.6794726 Vali Loss: 0.3713627 Best vali loss: 0.3578568
	iters: 100, epoch: 3 | loss: 0.3682831
	speed: 0.0073s/iter; left time: 21.7195s
	iters: 200, epoch: 3 | loss: 0.4226870
	speed: 0.0035s/iter; left time: 10.1299s
	iters: 300, epoch: 3 | loss: 0.6667396
	speed: 0.0036s/iter; left time: 9.9623s
	iters: 400, epoch: 3 | loss: 1.2678006
	speed: 0.0036s/iter; left time: 9.5640s
	iters: 500, epoch: 3 | loss: 0.6003162
	speed: 0.0036s/iter; left time: 9.3028s
Updating learning rate to 0.00028439872298564043
Epoch: 3 cost time: 1.8615882396697998
Epoch: 3, Steps: 514 | Train Loss: 0.6651653 Vali Loss: 0.3616445 Best vali loss: 0.3578568

best validation loss 0.3578567724272404

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012597931337, 'e_layers': 4, 'learning_rate': 0.0002761085838, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7916168
	speed: 0.0115s/iter; left time: 45.9911s
	iters: 200, epoch: 1 | loss: 0.3411947
	speed: 0.0052s/iter; left time: 20.5204s
	iters: 300, epoch: 1 | loss: 0.3159199
	speed: 0.0052s/iter; left time: 19.7383s
	iters: 400, epoch: 1 | loss: 1.0082784
	speed: 0.0053s/iter; left time: 19.6379s
	iters: 500, epoch: 1 | loss: 1.8784401
	speed: 0.0052s/iter; left time: 18.6779s
Updating learning rate to 0.0002655998265617487
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 3.0396246910095215
Epoch: 1, Steps: 514 | Train Loss: 0.8670900 Vali Loss: 0.3733840 Best vali loss: 0.3733840
	iters: 100, epoch: 2 | loss: 0.7187364
	speed: 0.0098s/iter; left time: 34.2425s
	iters: 200, epoch: 2 | loss: 0.3603202
	speed: 0.0048s/iter; left time: 16.3051s
	iters: 300, epoch: 2 | loss: 1.1963395
	speed: 0.0049s/iter; left time: 16.0046s
	iters: 400, epoch: 2 | loss: 0.8893317
	speed: 0.0048s/iter; left time: 15.3887s
	iters: 500, epoch: 2 | loss: 0.7519054
	speed: 0.0046s/iter; left time: 14.3682s
Updating learning rate to 0.00023567341787439705
Validation loss decreased (0.3734 --> 0.3707).  Saving model state dict ...
Epoch: 2 cost time: 2.4966416358947754
Epoch: 2, Steps: 514 | Train Loss: 0.7833266 Vali Loss: 0.3706579 Best vali loss: 0.3706579
	iters: 100, epoch: 3 | loss: 0.8609011
	speed: 0.0095s/iter; left time: 28.4687s
	iters: 200, epoch: 3 | loss: 0.8422738
	speed: 0.0047s/iter; left time: 13.6704s
	iters: 300, epoch: 3 | loss: 0.7096019
	speed: 0.0048s/iter; left time: 13.4252s
	iters: 400, epoch: 3 | loss: 0.6874960
	speed: 0.0049s/iter; left time: 13.0566s
	iters: 500, epoch: 3 | loss: 0.7871472
	speed: 0.0046s/iter; left time: 11.7724s
Updating learning rate to 0.000190885382177024
Epoch: 3 cost time: 2.4751296043395996
Epoch: 3, Steps: 514 | Train Loss: 0.7774840 Vali Loss: 0.3747075 Best vali loss: 0.3706579

best validation loss 0.3706578669238887

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021942137147, 'e_layers': 2, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5318359
	speed: 0.0108s/iter; left time: 5.8998s
Updating learning rate to 0.00020486002995
Validation loss decreased (0.3539 --> 0.3525).  Saving model state dict ...
Epoch: 4 cost time: 0.9194250106811523
Epoch: 4, Steps: 129 | Train Loss: 0.5318359 Vali Loss: 0.3525262 Best vali loss: 0.3525262
	iters: 100, epoch: 5 | loss: 0.4307983
	speed: 0.0073s/iter; left time: 3.0367s
Updating learning rate to 0.00012646349053431892
Epoch: 5 cost time: 0.5728087425231934
Epoch: 5, Steps: 129 | Train Loss: 0.4307983 Vali Loss: 0.3636569 Best vali loss: 0.3525262
	iters: 100, epoch: 6 | loss: 0.5525842
	speed: 0.0070s/iter; left time: 2.0195s
Updating learning rate to 6.000211357827579e-05
Validation loss decreased (0.3525 --> 0.3461).  Saving model state dict ...
Epoch: 6 cost time: 0.5659573078155518
Epoch: 6, Steps: 129 | Train Loss: 0.5525842 Vali Loss: 0.3461290 Best vali loss: 0.3461290
	iters: 100, epoch: 7 | loss: 0.6272218
	speed: 0.0075s/iter; left time: 1.1914s
Updating learning rate to 1.5594041249545802e-05
Epoch: 7 cost time: 0.5871217250823975
Epoch: 7, Steps: 129 | Train Loss: 0.6272218 Vali Loss: 0.3493404 Best vali loss: 0.3461290
	iters: 100, epoch: 8 | loss: 0.3628149
	speed: 0.0073s/iter; left time: 0.2190s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5853121280670166
Epoch: 8, Steps: 129 | Train Loss: 0.3628149 Vali Loss: 0.3493466 Best vali loss: 0.3461290

best validation loss 0.34612900902808064

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010660866261, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7541602
	speed: 0.0097s/iter; left time: 38.7278s
	iters: 200, epoch: 1 | loss: 0.4195639
	speed: 0.0033s/iter; left time: 12.9125s
	iters: 300, epoch: 1 | loss: 0.6907283
	speed: 0.0032s/iter; left time: 12.2214s
	iters: 400, epoch: 1 | loss: 0.3585695
	speed: 0.0033s/iter; left time: 12.2962s
	iters: 500, epoch: 1 | loss: 0.2589989
	speed: 0.0031s/iter; left time: 11.0770s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3703).  Saving model state dict ...
Epoch: 1 cost time: 2.0345284938812256
Epoch: 1, Steps: 514 | Train Loss: 0.4964042 Vali Loss: 0.3703165 Best vali loss: 0.3703165
	iters: 100, epoch: 2 | loss: 0.3424369
	speed: 0.0071s/iter; left time: 24.8441s
	iters: 200, epoch: 2 | loss: 0.5647274
	speed: 0.0031s/iter; left time: 10.5856s
	iters: 300, epoch: 2 | loss: 0.7164410
	speed: 0.0031s/iter; left time: 10.1727s
	iters: 400, epoch: 2 | loss: 0.6211100
	speed: 0.0031s/iter; left time: 9.7834s
	iters: 500, epoch: 2 | loss: 0.8213400
	speed: 0.0031s/iter; left time: 9.4889s
Updating learning rate to 0.0001911554003
Epoch: 2 cost time: 1.6319985389709473
Epoch: 2, Steps: 514 | Train Loss: 0.6132111 Vali Loss: 0.3742588 Best vali loss: 0.3703165
	iters: 100, epoch: 3 | loss: 0.5896999
	speed: 0.0068s/iter; left time: 20.2780s
	iters: 200, epoch: 3 | loss: 0.6731018
	speed: 0.0031s/iter; left time: 8.9154s
	iters: 300, epoch: 3 | loss: 0.6491806
	speed: 0.0031s/iter; left time: 8.6598s
	iters: 400, epoch: 3 | loss: 0.3863500
	speed: 0.0031s/iter; left time: 8.2835s
	iters: 500, epoch: 3 | loss: 0.4766050
	speed: 0.0031s/iter; left time: 7.9590s
Updating learning rate to 9.557770015e-05
Epoch: 3 cost time: 1.6399891376495361
Epoch: 3, Steps: 514 | Train Loss: 0.5549875 Vali Loss: 0.3775319 Best vali loss: 0.3703165
	iters: 100, epoch: 4 | loss: 0.3271654
	speed: 0.0068s/iter; left time: 16.7088s
	iters: 200, epoch: 4 | loss: 0.3884067
	speed: 0.0031s/iter; left time: 7.2618s
	iters: 300, epoch: 4 | loss: 0.8191754
	speed: 0.0030s/iter; left time: 6.9025s
	iters: 400, epoch: 4 | loss: 0.6990421
	speed: 0.0030s/iter; left time: 6.5984s
	iters: 500, epoch: 4 | loss: 0.1915519
	speed: 0.0031s/iter; left time: 6.3284s
Updating learning rate to 4.7788850075e-05
Epoch: 4 cost time: 1.6161248683929443
Epoch: 4, Steps: 514 | Train Loss: 0.4850683 Vali Loss: 0.3829965 Best vali loss: 0.3703165
	iters: 100, epoch: 5 | loss: 0.6227198
	speed: 0.0074s/iter; left time: 14.3944s
	iters: 200, epoch: 5 | loss: 0.2562610
	speed: 0.0037s/iter; left time: 6.7797s
	iters: 300, epoch: 5 | loss: 0.4826228
	speed: 0.0036s/iter; left time: 6.3676s
	iters: 400, epoch: 5 | loss: 0.6986788
	speed: 0.0035s/iter; left time: 5.8676s
	iters: 500, epoch: 5 | loss: 0.9225829
	speed: 0.0037s/iter; left time: 5.7642s
Updating learning rate to 2.38944250375e-05
Epoch: 5 cost time: 1.911972999572754
Epoch: 5, Steps: 514 | Train Loss: 0.5965730 Vali Loss: 0.3886130 Best vali loss: 0.3703165
	iters: 100, epoch: 6 | loss: 0.6314254
	speed: 0.0072s/iter; left time: 10.4075s
	iters: 200, epoch: 6 | loss: 0.6627613
	speed: 0.0031s/iter; left time: 4.1011s
	iters: 300, epoch: 6 | loss: 0.6105989
	speed: 0.0031s/iter; left time: 3.8066s
	iters: 400, epoch: 6 | loss: 0.2343549
	speed: 0.0031s/iter; left time: 3.5333s
	iters: 500, epoch: 6 | loss: 0.2981333
	speed: 0.0031s/iter; left time: 3.2677s
Updating learning rate to 1.194721251875e-05
Epoch: 6 cost time: 1.629471778869629
Epoch: 6, Steps: 514 | Train Loss: 0.4874548 Vali Loss: 0.3875997 Best vali loss: 0.3703165
	iters: 100, epoch: 7 | loss: 0.3507770
	speed: 0.0072s/iter; left time: 6.7008s
	iters: 200, epoch: 7 | loss: 0.3696376
	speed: 0.0034s/iter; left time: 2.7884s
	iters: 300, epoch: 7 | loss: 0.3881901
	speed: 0.0034s/iter; left time: 2.4519s
	iters: 400, epoch: 7 | loss: 0.3216678
	speed: 0.0031s/iter; left time: 1.9763s
	iters: 500, epoch: 7 | loss: 0.4149975
	speed: 0.0031s/iter; left time: 1.6583s
Updating learning rate to 5.973606259375e-06
Epoch: 7 cost time: 1.70068359375
Epoch: 7, Steps: 514 | Train Loss: 0.3690540 Vali Loss: 0.3864329 Best vali loss: 0.3703165
	iters: 100, epoch: 8 | loss: 1.0014530
	speed: 0.0070s/iter; left time: 2.8897s
	iters: 200, epoch: 8 | loss: 0.4364294
	speed: 0.0031s/iter; left time: 0.9883s
	iters: 300, epoch: 8 | loss: 0.3515937
	speed: 0.0031s/iter; left time: 0.6589s
	iters: 400, epoch: 8 | loss: 0.5817758
	speed: 0.0031s/iter; left time: 0.3553s
	iters: 500, epoch: 8 | loss: 0.3709137
	speed: 0.0031s/iter; left time: 0.0465s
Updating learning rate to 2.9868031296875e-06
Epoch: 8 cost time: 1.6369965076446533
Epoch: 8, Steps: 514 | Train Loss: 0.5484331 Vali Loss: 0.3891230 Best vali loss: 0.3703165

best validation loss 0.3703165426323362

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022029131209, 'e_layers': 4, 'learning_rate': 0.0004210675535, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3749193
	speed: 0.0127s/iter; left time: 24.9289s
	iters: 200, epoch: 1 | loss: 0.9830071
	speed: 0.0056s/iter; left time: 10.3755s
Updating learning rate to 0.00040504162399162565
Validation loss decreased (inf --> 0.3778).  Saving model state dict ...
Epoch: 1 cost time: 1.8109166622161865
Epoch: 1, Steps: 257 | Train Loss: 0.6789632 Vali Loss: 0.3777614 Best vali loss: 0.3777614
	iters: 100, epoch: 2 | loss: 0.7359622
	speed: 0.0110s/iter; left time: 18.6522s
	iters: 200, epoch: 2 | loss: 0.6036648
	speed: 0.0047s/iter; left time: 7.5996s
Updating learning rate to 0.0003594036379587397
Validation loss decreased (0.3778 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 1.2845234870910645
Epoch: 2, Steps: 257 | Train Loss: 0.6698135 Vali Loss: 0.3658759 Best vali loss: 0.3658759
	iters: 100, epoch: 3 | loss: 0.3547040
	speed: 0.0107s/iter; left time: 15.4462s
	iters: 200, epoch: 3 | loss: 0.7425497
	speed: 0.0049s/iter; left time: 6.6475s
Updating learning rate to 0.0002911015650654756
Epoch: 3 cost time: 1.3159542083740234
Epoch: 3, Steps: 257 | Train Loss: 0.5486268 Vali Loss: 0.3873462 Best vali loss: 0.3658759
	iters: 100, epoch: 4 | loss: 0.5653447
	speed: 0.0112s/iter; left time: 13.2922s
	iters: 200, epoch: 4 | loss: 0.4900283
	speed: 0.0051s/iter; left time: 5.5714s
Updating learning rate to 0.00021053377675
Validation loss decreased (0.3659 --> 0.3535).  Saving model state dict ...
Epoch: 4 cost time: 1.4062590599060059
Epoch: 4, Steps: 257 | Train Loss: 0.5276865 Vali Loss: 0.3534550 Best vali loss: 0.3534550
	iters: 100, epoch: 5 | loss: 0.4554584
	speed: 0.0116s/iter; left time: 10.8028s
	iters: 200, epoch: 5 | loss: 0.5608135
	speed: 0.0055s/iter; left time: 4.5950s
Updating learning rate to 0.00012996598843452448
Validation loss decreased (0.3535 --> 0.3508).  Saving model state dict ...
Epoch: 5 cost time: 1.4820196628570557
Epoch: 5, Steps: 257 | Train Loss: 0.5081360 Vali Loss: 0.3508300 Best vali loss: 0.3508300
	iters: 100, epoch: 6 | loss: 0.8649723
	speed: 0.0118s/iter; left time: 7.9277s
	iters: 200, epoch: 6 | loss: 0.2905284
	speed: 0.0055s/iter; left time: 3.1712s
Updating learning rate to 6.166391554126033e-05
Epoch: 6 cost time: 1.475388526916504
Epoch: 6, Steps: 257 | Train Loss: 0.5777504 Vali Loss: 0.3582852 Best vali loss: 0.3508300
	iters: 100, epoch: 7 | loss: 0.7812988
	speed: 0.0109s/iter; left time: 4.5296s
	iters: 200, epoch: 7 | loss: 0.5727257
	speed: 0.0052s/iter; left time: 1.6502s
Updating learning rate to 1.602592950837439e-05
Epoch: 7 cost time: 1.378253698348999
Epoch: 7, Steps: 257 | Train Loss: 0.6770122 Vali Loss: 0.3712836 Best vali loss: 0.3508300
	iters: 100, epoch: 8 | loss: 0.5748956
	speed: 0.0108s/iter; left time: 1.7114s
	iters: 200, epoch: 8 | loss: 0.4031433
	speed: 0.0048s/iter; left time: 0.2802s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3321566581726074
Epoch: 8, Steps: 257 | Train Loss: 0.4890194 Vali Loss: 0.3670374 Best vali loss: 0.3508300

best validation loss 0.35083003110876254

[INFO][smbo.py:320] Finished 1350 trials.
{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0016315716131, 'e_layers': 1, 'learning_rate': 0.0001181912383, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00011369285214376706
Validation loss decreased (inf --> 0.4348).  Saving model state dict ...
Epoch: 1 cost time: 0.62575364112854
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4348021 Best vali loss: 0.4348021
Updating learning rate to 0.0001008825321893826
Validation loss decreased (0.4348 --> 0.4210).  Saving model state dict ...
Epoch: 2 cost time: 0.31425905227661133
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4209574 Best vali loss: 0.4209574
Updating learning rate to 8.171053352406213e-05
Validation loss decreased (0.4210 --> 0.4104).  Saving model state dict ...
Epoch: 3 cost time: 0.32796382904052734
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4103833 Best vali loss: 0.4103833

best validation loss 0.41038326499270084

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0044001085276, 'e_layers': 4, 'learning_rate': 0.0003970730712, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5359077
	speed: 0.0109s/iter; left time: 43.7209s
	iters: 200, epoch: 1 | loss: 0.9293882
	speed: 0.0047s/iter; left time: 18.4745s
	iters: 300, epoch: 1 | loss: 0.3322214
	speed: 0.0047s/iter; left time: 18.0693s
	iters: 400, epoch: 1 | loss: 0.4710152
	speed: 0.0048s/iter; left time: 17.6502s
	iters: 500, epoch: 1 | loss: 0.4607149
	speed: 0.0046s/iter; left time: 16.6497s
Updating learning rate to 0.00038196037729653845
Validation loss decreased (inf --> 0.3731).  Saving model state dict ...
Epoch: 1 cost time: 2.7666404247283936
Epoch: 1, Steps: 514 | Train Loss: 0.5458495 Vali Loss: 0.3731100 Best vali loss: 0.3731100
	iters: 100, epoch: 2 | loss: 0.2827585
	speed: 0.0101s/iter; left time: 35.2205s
	iters: 200, epoch: 2 | loss: 0.6270766
	speed: 0.0052s/iter; left time: 17.5773s
	iters: 300, epoch: 2 | loss: 0.7461888
	speed: 0.0052s/iter; left time: 17.2011s
	iters: 400, epoch: 2 | loss: 0.3699993
	speed: 0.0049s/iter; left time: 15.6439s
	iters: 500, epoch: 2 | loss: 0.7993867
	speed: 0.0046s/iter; left time: 14.4007s
Updating learning rate to 0.0003389230662360444
Validation loss decreased (0.3731 --> 0.3729).  Saving model state dict ...
Epoch: 2 cost time: 2.627418279647827
Epoch: 2, Steps: 514 | Train Loss: 0.5650820 Vali Loss: 0.3728766 Best vali loss: 0.3728766
	iters: 100, epoch: 3 | loss: 0.9460370
	speed: 0.0091s/iter; left time: 27.2785s
	iters: 200, epoch: 3 | loss: 0.3965532
	speed: 0.0046s/iter; left time: 13.2994s
	iters: 300, epoch: 3 | loss: 0.2028972
	speed: 0.0051s/iter; left time: 14.2706s
	iters: 400, epoch: 3 | loss: 0.4447321
	speed: 0.0052s/iter; left time: 14.0452s
	iters: 500, epoch: 3 | loss: 0.2402002
	speed: 0.0051s/iter; left time: 13.0760s
Updating learning rate to 0.00027451317849328183
Validation loss decreased (0.3729 --> 0.3688).  Saving model state dict ...
Epoch: 3 cost time: 2.565657138824463
Epoch: 3, Steps: 514 | Train Loss: 0.4460839 Vali Loss: 0.3687521 Best vali loss: 0.3687521

best validation loss 0.36875212010442626

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0017432932691, 'e_layers': 1, 'learning_rate': 0.0007102551407, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007102551407
Validation loss decreased (inf --> 0.3867).  Saving model state dict ...
Epoch: 1 cost time: 0.6009907722473145
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3867101 Best vali loss: 0.3867101
Updating learning rate to 0.00035512757035
Validation loss decreased (0.3867 --> 0.3715).  Saving model state dict ...
Epoch: 2 cost time: 0.3170609474182129
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3715384 Best vali loss: 0.3715384
Updating learning rate to 0.000177563785175
Validation loss decreased (0.3715 --> 0.3681).  Saving model state dict ...
Epoch: 3 cost time: 0.32552409172058105
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3681178 Best vali loss: 0.3681178

best validation loss 0.36811775712695244

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0017432932691, 'e_layers': 1, 'learning_rate': 0.0007102551407, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.87818925875e-05
Validation loss decreased (0.3681 --> 0.3668).  Saving model state dict ...
Epoch: 4 cost time: 0.5988390445709229
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3667668 Best vali loss: 0.3667668
Updating learning rate to 4.439094629375e-05
Validation loss decreased (0.3668 --> 0.3665).  Saving model state dict ...
Epoch: 5 cost time: 0.31780481338500977
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3665054 Best vali loss: 0.3665054
Updating learning rate to 2.2195473146875e-05
Validation loss decreased (0.3665 --> 0.3664).  Saving model state dict ...
Epoch: 6 cost time: 0.3067159652709961
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3664479 Best vali loss: 0.3664479
Updating learning rate to 1.10977365734375e-05
Validation loss decreased (0.3664 --> 0.3664).  Saving model state dict ...
Epoch: 7 cost time: 0.3059065341949463
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3663829 Best vali loss: 0.3663829
Updating learning rate to 5.54886828671875e-06
Validation loss decreased (0.3664 --> 0.3663).  Saving model state dict ...
Epoch: 8 cost time: 0.29964780807495117
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3663306 Best vali loss: 0.3663306

best validation loss 0.36633055450171526

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021979587667, 'e_layers': 3, 'learning_rate': 0.0004097200599, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4461573
	speed: 0.0108s/iter; left time: 43.4856s
	iters: 200, epoch: 1 | loss: 0.2917278
	speed: 0.0044s/iter; left time: 17.2312s
	iters: 300, epoch: 1 | loss: 0.7359970
	speed: 0.0043s/iter; left time: 16.2191s
	iters: 400, epoch: 1 | loss: 1.0954255
	speed: 0.0045s/iter; left time: 16.5534s
	iters: 500, epoch: 1 | loss: 0.6514252
	speed: 0.0041s/iter; left time: 14.9644s
Updating learning rate to 0.00039412601865045424
Validation loss decreased (inf --> 0.3625).  Saving model state dict ...
Epoch: 1 cost time: 2.594907760620117
Epoch: 1, Steps: 514 | Train Loss: 0.6441465 Vali Loss: 0.3625196 Best vali loss: 0.3625196
	iters: 100, epoch: 2 | loss: 0.3485002
	speed: 0.0088s/iter; left time: 30.7156s
	iters: 200, epoch: 2 | loss: 0.6558869
	speed: 0.0043s/iter; left time: 14.4812s
	iters: 300, epoch: 2 | loss: 0.6533574
	speed: 0.0044s/iter; left time: 14.4171s
	iters: 400, epoch: 2 | loss: 0.9207805
	speed: 0.0043s/iter; left time: 13.7092s
	iters: 500, epoch: 2 | loss: 0.8418431
	speed: 0.0043s/iter; left time: 13.4243s
Updating learning rate to 0.00034971794632172426
Epoch: 2 cost time: 2.2516794204711914
Epoch: 2, Steps: 514 | Train Loss: 0.6840736 Vali Loss: 0.3651749 Best vali loss: 0.3625196
	iters: 100, epoch: 3 | loss: 0.7984535
	speed: 0.0082s/iter; left time: 24.4351s
	iters: 200, epoch: 3 | loss: 0.2536305
	speed: 0.0042s/iter; left time: 12.0329s
	iters: 300, epoch: 3 | loss: 0.5703617
	speed: 0.0041s/iter; left time: 11.4476s
	iters: 400, epoch: 3 | loss: 0.3275685
	speed: 0.0043s/iter; left time: 11.6021s
	iters: 500, epoch: 3 | loss: 0.9103916
	speed: 0.0043s/iter; left time: 11.0847s
Updating learning rate to 0.00028325656936568113
Epoch: 3 cost time: 2.1792337894439697
Epoch: 3, Steps: 514 | Train Loss: 0.5720812 Vali Loss: 0.3777428 Best vali loss: 0.3625196
	iters: 100, epoch: 4 | loss: 0.5266712
	speed: 0.0085s/iter; left time: 21.0218s
	iters: 200, epoch: 4 | loss: 0.4258377
	speed: 0.0043s/iter; left time: 10.1454s
	iters: 300, epoch: 4 | loss: 0.3463263
	speed: 0.0044s/iter; left time: 9.9219s
	iters: 400, epoch: 4 | loss: 1.0438472
	speed: 0.0044s/iter; left time: 9.6376s
	iters: 500, epoch: 4 | loss: 0.5887710
	speed: 0.0044s/iter; left time: 9.1508s
Updating learning rate to 0.00020486002995
Validation loss decreased (0.3625 --> 0.3552).  Saving model state dict ...
Epoch: 4 cost time: 2.277606964111328
Epoch: 4, Steps: 514 | Train Loss: 0.5862907 Vali Loss: 0.3552468 Best vali loss: 0.3552468
	iters: 100, epoch: 5 | loss: 0.4490921
	speed: 0.0089s/iter; left time: 17.3530s
	iters: 200, epoch: 5 | loss: 0.5167003
	speed: 0.0043s/iter; left time: 7.9858s
	iters: 300, epoch: 5 | loss: 0.9398717
	speed: 0.0043s/iter; left time: 7.5558s
	iters: 400, epoch: 5 | loss: 0.2431352
	speed: 0.0043s/iter; left time: 7.0905s
	iters: 500, epoch: 5 | loss: 0.4417880
	speed: 0.0044s/iter; left time: 6.7764s
Updating learning rate to 0.00012646349053431892
Epoch: 5 cost time: 2.261242628097534
Epoch: 5, Steps: 514 | Train Loss: 0.5181174 Vali Loss: 0.3621259 Best vali loss: 0.3552468
	iters: 100, epoch: 6 | loss: 0.2294964
	speed: 0.0084s/iter; left time: 12.0924s
	iters: 200, epoch: 6 | loss: 0.2919619
	speed: 0.0041s/iter; left time: 5.5073s
	iters: 300, epoch: 6 | loss: 0.4653647
	speed: 0.0040s/iter; left time: 5.0285s
	iters: 400, epoch: 6 | loss: 0.2405457
	speed: 0.0041s/iter; left time: 4.6451s
	iters: 500, epoch: 6 | loss: 0.3722619
	speed: 0.0039s/iter; left time: 4.1157s
Updating learning rate to 6.000211357827579e-05
Validation loss decreased (0.3552 --> 0.3548).  Saving model state dict ...
Epoch: 6 cost time: 2.140057325363159
Epoch: 6, Steps: 514 | Train Loss: 0.3199261 Vali Loss: 0.3547726 Best vali loss: 0.3547726
	iters: 100, epoch: 7 | loss: 0.3664832
	speed: 0.0087s/iter; left time: 8.0768s
	iters: 200, epoch: 7 | loss: 0.4399710
	speed: 0.0040s/iter; left time: 3.3464s
	iters: 300, epoch: 7 | loss: 0.4949410
	speed: 0.0040s/iter; left time: 2.8897s
	iters: 400, epoch: 7 | loss: 0.3864419
	speed: 0.0042s/iter; left time: 2.6133s
	iters: 500, epoch: 7 | loss: 0.2570508
	speed: 0.0040s/iter; left time: 2.0984s
Updating learning rate to 1.5594041249545802e-05
Epoch: 7 cost time: 2.1272952556610107
Epoch: 7, Steps: 514 | Train Loss: 0.3889776 Vali Loss: 0.3608680 Best vali loss: 0.3547726
	iters: 100, epoch: 8 | loss: 0.6146601
	speed: 0.0090s/iter; left time: 3.7252s
	iters: 200, epoch: 8 | loss: 0.4523111
	speed: 0.0043s/iter; left time: 1.3663s
	iters: 300, epoch: 8 | loss: 0.3845170
	speed: 0.0043s/iter; left time: 0.9181s
	iters: 400, epoch: 8 | loss: 0.3717423
	speed: 0.0045s/iter; left time: 0.5126s
	iters: 500, epoch: 8 | loss: 0.6820305
	speed: 0.0045s/iter; left time: 0.0668s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.303417205810547
Epoch: 8, Steps: 514 | Train Loss: 0.5010522 Vali Loss: 0.3592271 Best vali loss: 0.3547726

best validation loss 0.35477263871251014

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 4, 'learning_rate': 0.0003297216103, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4846967
	speed: 0.0133s/iter; left time: 26.0021s
	iters: 200, epoch: 1 | loss: 0.5678039
	speed: 0.0072s/iter; left time: 13.3903s
Updating learning rate to 0.0003297216103
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 2.197526216506958
Epoch: 1, Steps: 257 | Train Loss: 0.5262503 Vali Loss: 0.3748921 Best vali loss: 0.3748921
	iters: 100, epoch: 2 | loss: 0.5344312
	speed: 0.0149s/iter; left time: 25.3379s
	iters: 200, epoch: 2 | loss: 0.7052641
	speed: 0.0071s/iter; left time: 11.3863s
Updating learning rate to 0.00016486080515
Epoch: 2 cost time: 1.8634796142578125
Epoch: 2, Steps: 257 | Train Loss: 0.6198476 Vali Loss: 0.3885661 Best vali loss: 0.3748921
	iters: 100, epoch: 3 | loss: 0.6069508
	speed: 0.0146s/iter; left time: 21.0111s
	iters: 200, epoch: 3 | loss: 0.6912213
	speed: 0.0071s/iter; left time: 9.4973s
Updating learning rate to 8.2430402575e-05
Validation loss decreased (0.3749 --> 0.3736).  Saving model state dict ...
Epoch: 3 cost time: 1.8594012260437012
Epoch: 3, Steps: 257 | Train Loss: 0.6490861 Vali Loss: 0.3735813 Best vali loss: 0.3735813
	iters: 100, epoch: 4 | loss: 0.4031059
	speed: 0.0152s/iter; left time: 18.0372s
	iters: 200, epoch: 4 | loss: 0.5966334
	speed: 0.0072s/iter; left time: 7.8099s
Updating learning rate to 4.12152012875e-05
Validation loss decreased (0.3736 --> 0.3672).  Saving model state dict ...
Epoch: 4 cost time: 1.886103630065918
Epoch: 4, Steps: 257 | Train Loss: 0.4998696 Vali Loss: 0.3672348 Best vali loss: 0.3672348
	iters: 100, epoch: 5 | loss: 0.5216513
	speed: 0.0154s/iter; left time: 14.3462s
	iters: 200, epoch: 5 | loss: 0.4611672
	speed: 0.0072s/iter; left time: 5.9284s
Updating learning rate to 2.060760064375e-05
Validation loss decreased (0.3672 --> 0.3506).  Saving model state dict ...
Epoch: 5 cost time: 1.884547472000122
Epoch: 5, Steps: 257 | Train Loss: 0.4914092 Vali Loss: 0.3505738 Best vali loss: 0.3505738
	iters: 100, epoch: 6 | loss: 0.5941392
	speed: 0.0153s/iter; left time: 10.3004s
	iters: 200, epoch: 6 | loss: 0.3058511
	speed: 0.0071s/iter; left time: 4.0802s
Updating learning rate to 1.0303800321875e-05
Validation loss decreased (0.3506 --> 0.3499).  Saving model state dict ...
Epoch: 6 cost time: 1.8805286884307861
Epoch: 6, Steps: 257 | Train Loss: 0.4499952 Vali Loss: 0.3498572 Best vali loss: 0.3498572
	iters: 100, epoch: 7 | loss: 0.2992076
	speed: 0.0153s/iter; left time: 6.3367s
	iters: 200, epoch: 7 | loss: 0.4338419
	speed: 0.0071s/iter; left time: 2.2508s
Updating learning rate to 5.1519001609375e-06
Validation loss decreased (0.3499 --> 0.3479).  Saving model state dict ...
Epoch: 7 cost time: 1.8734886646270752
Epoch: 7, Steps: 257 | Train Loss: 0.3665248 Vali Loss: 0.3479391 Best vali loss: 0.3479391
	iters: 100, epoch: 8 | loss: 0.3346398
	speed: 0.0152s/iter; left time: 2.4077s
	iters: 200, epoch: 8 | loss: 0.6825696
	speed: 0.0072s/iter; left time: 0.4162s
Updating learning rate to 2.57595008046875e-06
Validation loss decreased (0.3479 --> 0.3457).  Saving model state dict ...
Epoch: 8 cost time: 1.8724703788757324
Epoch: 8, Steps: 257 | Train Loss: 0.5086047 Vali Loss: 0.3456583 Best vali loss: 0.3456583

best validation loss 0.3456582530074129

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.01039089376, 'e_layers': 4, 'learning_rate': 0.0004540240386, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6284389
	speed: 0.0114s/iter; left time: 22.3956s
	iters: 200, epoch: 1 | loss: 0.6310226
	speed: 0.0052s/iter; left time: 9.6545s
Updating learning rate to 0.0004367437775653272
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 1.6784141063690186
Epoch: 1, Steps: 257 | Train Loss: 0.6297308 Vali Loss: 0.3659098 Best vali loss: 0.3659098
	iters: 100, epoch: 2 | loss: 0.6579649
	speed: 0.0111s/iter; left time: 18.8810s
	iters: 200, epoch: 2 | loss: 0.6875772
	speed: 0.0051s/iter; left time: 8.1655s
Updating learning rate to 0.0003875337575578814
Validation loss decreased (0.3659 --> 0.3608).  Saving model state dict ...
Epoch: 2 cost time: 1.3668560981750488
Epoch: 2, Steps: 257 | Train Loss: 0.6727710 Vali Loss: 0.3608187 Best vali loss: 0.3608187
	iters: 100, epoch: 3 | loss: 0.6479264
	speed: 0.0113s/iter; left time: 16.3022s
	iters: 200, epoch: 3 | loss: 0.7046457
	speed: 0.0052s/iter; left time: 7.0421s
Updating learning rate to 0.000313885758033854
Epoch: 3 cost time: 1.396054744720459
Epoch: 3, Steps: 257 | Train Loss: 0.6762860 Vali Loss: 0.3638402 Best vali loss: 0.3608187

best validation loss 0.36081869343409134

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0048839047995, 'e_layers': 4, 'learning_rate': 0.0035494766188, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8249260
	speed: 0.0122s/iter; left time: 23.7823s
	iters: 200, epoch: 1 | loss: 0.6430683
	speed: 0.0059s/iter; left time: 10.9473s
Updating learning rate to 0.0034143827090183437
Validation loss decreased (inf --> 0.4094).  Saving model state dict ...
Epoch: 1 cost time: 1.8659398555755615
Epoch: 1, Steps: 257 | Train Loss: 0.7339971 Vali Loss: 0.4093804 Best vali loss: 0.4093804
	iters: 100, epoch: 2 | loss: 0.8661432
	speed: 0.0124s/iter; left time: 21.0019s
	iters: 200, epoch: 2 | loss: 0.4790608
	speed: 0.0058s/iter; left time: 9.3221s
Updating learning rate to 0.0030296678028082892
Validation loss decreased (0.4094 --> 0.4061).  Saving model state dict ...
Epoch: 2 cost time: 1.513706922531128
Epoch: 2, Steps: 257 | Train Loss: 0.6726020 Vali Loss: 0.4061232 Best vali loss: 0.4061232
	iters: 100, epoch: 3 | loss: 0.6696506
	speed: 0.0128s/iter; left time: 18.3990s
	iters: 200, epoch: 3 | loss: 0.7597966
	speed: 0.0058s/iter; left time: 7.7522s
Updating learning rate to 0.002453901257191009
Validation loss decreased (0.4061 --> 0.4046).  Saving model state dict ...
Epoch: 3 cost time: 1.532350778579712
Epoch: 3, Steps: 257 | Train Loss: 0.7147236 Vali Loss: 0.4046132 Best vali loss: 0.4046132

best validation loss 0.4046131617896449

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0056439625802, 'e_layers': 1, 'learning_rate': 0.000381065886, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8924235
	speed: 0.0085s/iter; left time: 68.8206s
	iters: 200, epoch: 1 | loss: 0.7607415
	speed: 0.0025s/iter; left time: 19.7106s
	iters: 300, epoch: 1 | loss: 1.5395622
	speed: 0.0024s/iter; left time: 19.0917s
	iters: 400, epoch: 1 | loss: 0.4838937
	speed: 0.0024s/iter; left time: 18.5548s
	iters: 500, epoch: 1 | loss: 0.3343480
	speed: 0.0024s/iter; left time: 18.5974s
	iters: 600, epoch: 1 | loss: 0.4986374
	speed: 0.0024s/iter; left time: 18.0933s
	iters: 700, epoch: 1 | loss: 0.9555703
	speed: 0.0024s/iter; left time: 17.8887s
	iters: 800, epoch: 1 | loss: 0.5885820
	speed: 0.0024s/iter; left time: 17.6418s
	iters: 900, epoch: 1 | loss: 0.4759165
	speed: 0.0024s/iter; left time: 17.3632s
	iters: 1000, epoch: 1 | loss: 1.0054145
	speed: 0.0024s/iter; left time: 17.0983s
Updating learning rate to 0.00036656242930683966
Validation loss decreased (inf --> 0.3756).  Saving model state dict ...
Epoch: 1 cost time: 2.8005197048187256
Epoch: 1, Steps: 1027 | Train Loss: 0.7535090 Vali Loss: 0.3756079 Best vali loss: 0.3756079
	iters: 100, epoch: 2 | loss: 0.1763301
	speed: 0.0073s/iter; left time: 52.0945s
	iters: 200, epoch: 2 | loss: 0.4780698
	speed: 0.0021s/iter; left time: 14.9202s
	iters: 300, epoch: 2 | loss: 0.2923457
	speed: 0.0022s/iter; left time: 14.8850s
	iters: 400, epoch: 2 | loss: 0.6282350
	speed: 0.0021s/iter; left time: 14.4410s
	iters: 500, epoch: 2 | loss: 0.3709140
	speed: 0.0021s/iter; left time: 14.2137s
	iters: 600, epoch: 2 | loss: 0.4747950
	speed: 0.0021s/iter; left time: 13.7937s
	iters: 700, epoch: 2 | loss: 0.3402884
	speed: 0.0021s/iter; left time: 13.7202s
	iters: 800, epoch: 2 | loss: 0.6645758
	speed: 0.0021s/iter; left time: 13.6107s
	iters: 900, epoch: 2 | loss: 0.4834440
	speed: 0.0021s/iter; left time: 13.4005s
	iters: 1000, epoch: 2 | loss: 0.7302721
	speed: 0.0021s/iter; left time: 12.9820s
Updating learning rate to 0.00032526007903472995
Validation loss decreased (0.3756 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 2.219259262084961
Epoch: 2, Steps: 1027 | Train Loss: 0.4639270 Vali Loss: 0.3690547 Best vali loss: 0.3690547
	iters: 100, epoch: 3 | loss: 0.8170061
	speed: 0.0073s/iter; left time: 44.3447s
	iters: 200, epoch: 3 | loss: 0.8624783
	speed: 0.0022s/iter; left time: 13.3998s
	iters: 300, epoch: 3 | loss: 0.3934568
	speed: 0.0022s/iter; left time: 13.1729s
	iters: 400, epoch: 3 | loss: 0.5014871
	speed: 0.0022s/iter; left time: 12.7215s
	iters: 500, epoch: 3 | loss: 0.5551831
	speed: 0.0022s/iter; left time: 12.6479s
	iters: 600, epoch: 3 | loss: 1.2633183
	speed: 0.0022s/iter; left time: 12.3775s
	iters: 700, epoch: 3 | loss: 0.3685208
	speed: 0.0022s/iter; left time: 12.2177s
	iters: 800, epoch: 3 | loss: 0.3168882
	speed: 0.0022s/iter; left time: 11.9649s
	iters: 900, epoch: 3 | loss: 0.2983146
	speed: 0.0022s/iter; left time: 11.7802s
	iters: 1000, epoch: 3 | loss: 0.7644976
	speed: 0.0022s/iter; left time: 11.5647s
Updating learning rate to 0.000263446743605862
Epoch: 3 cost time: 2.3359580039978027
Epoch: 3, Steps: 1027 | Train Loss: 0.6141151 Vali Loss: 0.3993893 Best vali loss: 0.3690547

best validation loss 0.3690547007357442

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.01039089376, 'e_layers': 4, 'learning_rate': 0.0004540240386, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5399670
	speed: 0.0119s/iter; left time: 14.1166s
	iters: 200, epoch: 4 | loss: 0.4990055
	speed: 0.0054s/iter; left time: 5.8792s
Updating learning rate to 0.0002270120193
Validation loss decreased (0.3608 --> 0.3450).  Saving model state dict ...
Epoch: 4 cost time: 1.7310431003570557
Epoch: 4, Steps: 257 | Train Loss: 0.5194863 Vali Loss: 0.3449759 Best vali loss: 0.3449759
	iters: 100, epoch: 5 | loss: 0.4542626
	speed: 0.0115s/iter; left time: 10.6746s
	iters: 200, epoch: 5 | loss: 0.4075443
	speed: 0.0051s/iter; left time: 4.2566s
Updating learning rate to 0.00014013828056614602
Epoch: 5 cost time: 1.391174554824829
Epoch: 5, Steps: 257 | Train Loss: 0.4309035 Vali Loss: 0.3619830 Best vali loss: 0.3449759
	iters: 100, epoch: 6 | loss: 0.4551120
	speed: 0.0109s/iter; left time: 7.3451s
	iters: 200, epoch: 6 | loss: 0.4418448
	speed: 0.0055s/iter; left time: 3.1681s
Updating learning rate to 6.649028104211861e-05
Epoch: 6 cost time: 1.4292292594909668
Epoch: 6, Steps: 257 | Train Loss: 0.4484784 Vali Loss: 0.3718466 Best vali loss: 0.3449759
	iters: 100, epoch: 7 | loss: 0.4871914
	speed: 0.0111s/iter; left time: 4.6149s
	iters: 200, epoch: 7 | loss: 0.3278295
	speed: 0.0053s/iter; left time: 1.6816s
Updating learning rate to 1.7280261034672797e-05
Epoch: 7 cost time: 1.4277172088623047
Epoch: 7, Steps: 257 | Train Loss: 0.4075105 Vali Loss: 0.3904581 Best vali loss: 0.3449759
	iters: 100, epoch: 8 | loss: 0.4224329
	speed: 0.0110s/iter; left time: 1.7387s
	iters: 200, epoch: 8 | loss: 0.3398281
	speed: 0.0052s/iter; left time: 0.2990s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3762922286987305
Epoch: 8, Steps: 257 | Train Loss: 0.3811305 Vali Loss: 0.3942466 Best vali loss: 0.3449759

best validation loss 0.34497590988932986

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063421632947, 'e_layers': 4, 'learning_rate': 0.0003462280669, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4505478
	speed: 0.0114s/iter; left time: 92.1500s
	iters: 200, epoch: 1 | loss: 0.5196378
	speed: 0.0052s/iter; left time: 41.3602s
	iters: 300, epoch: 1 | loss: 0.3334994
	speed: 0.0053s/iter; left time: 41.6544s
	iters: 400, epoch: 1 | loss: 0.6118504
	speed: 0.0053s/iter; left time: 41.3157s
	iters: 500, epoch: 1 | loss: 1.2924756
	speed: 0.0052s/iter; left time: 40.1702s
	iters: 600, epoch: 1 | loss: 0.9997023
	speed: 0.0052s/iter; left time: 39.9095s
	iters: 700, epoch: 1 | loss: 0.4012983
	speed: 0.0052s/iter; left time: 38.9358s
	iters: 800, epoch: 1 | loss: 0.6913236
	speed: 0.0052s/iter; left time: 38.6205s
	iters: 900, epoch: 1 | loss: 0.4270722
	speed: 0.0053s/iter; left time: 38.4369s
	iters: 1000, epoch: 1 | loss: 0.7627400
	speed: 0.0053s/iter; left time: 38.1012s
Updating learning rate to 0.0003330505457449292
Validation loss decreased (inf --> 0.4123).  Saving model state dict ...
Epoch: 1 cost time: 5.726949691772461
Epoch: 1, Steps: 1027 | Train Loss: 0.6490147 Vali Loss: 0.4122750 Best vali loss: 0.4122750
	iters: 100, epoch: 2 | loss: 0.9149530
	speed: 0.0138s/iter; left time: 97.8244s
	iters: 200, epoch: 2 | loss: 0.3456742
	speed: 0.0053s/iter; left time: 36.9378s
	iters: 300, epoch: 2 | loss: 0.9719150
	speed: 0.0053s/iter; left time: 36.2272s
	iters: 400, epoch: 2 | loss: 0.8078640
	speed: 0.0053s/iter; left time: 35.7658s
	iters: 500, epoch: 2 | loss: 0.6142578
	speed: 0.0052s/iter; left time: 34.9327s
	iters: 600, epoch: 2 | loss: 0.4039391
	speed: 0.0050s/iter; left time: 33.1078s
	iters: 700, epoch: 2 | loss: 0.4523573
	speed: 0.0049s/iter; left time: 31.8322s
	iters: 800, epoch: 2 | loss: 0.3416000
	speed: 0.0047s/iter; left time: 30.1090s
	iters: 900, epoch: 2 | loss: 0.4794007
	speed: 0.0047s/iter; left time: 29.2777s
	iters: 1000, epoch: 2 | loss: 0.7094045
	speed: 0.0047s/iter; left time: 28.8189s
Updating learning rate to 0.0002955241404210498
Validation loss decreased (0.4123 --> 0.4037).  Saving model state dict ...
Epoch: 2 cost time: 5.18376088142395
Epoch: 2, Steps: 1027 | Train Loss: 0.6041366 Vali Loss: 0.4037365 Best vali loss: 0.4037365
	iters: 100, epoch: 3 | loss: 0.5399914
	speed: 0.0136s/iter; left time: 82.1635s
	iters: 200, epoch: 3 | loss: 0.5780192
	speed: 0.0052s/iter; left time: 30.8484s
	iters: 300, epoch: 3 | loss: 0.2938658
	speed: 0.0052s/iter; left time: 30.2991s
	iters: 400, epoch: 3 | loss: 1.4202291
	speed: 0.0052s/iter; left time: 30.0836s
	iters: 500, epoch: 3 | loss: 1.0546050
	speed: 0.0052s/iter; left time: 29.5672s
	iters: 600, epoch: 3 | loss: 0.5199667
	speed: 0.0052s/iter; left time: 28.8206s
	iters: 700, epoch: 3 | loss: 0.2614734
	speed: 0.0052s/iter; left time: 28.2406s
	iters: 800, epoch: 3 | loss: 1.4345165
	speed: 0.0052s/iter; left time: 28.1050s
	iters: 900, epoch: 3 | loss: 0.9180963
	speed: 0.0053s/iter; left time: 27.6603s
	iters: 1000, epoch: 3 | loss: 1.2590002
	speed: 0.0052s/iter; left time: 27.0567s
Updating learning rate to 0.00023936190596121097
Validation loss decreased (0.4037 --> 0.4035).  Saving model state dict ...
Epoch: 3 cost time: 5.3825907707214355
Epoch: 3, Steps: 1027 | Train Loss: 0.8279764 Vali Loss: 0.4034660 Best vali loss: 0.4034660
	iters: 100, epoch: 4 | loss: 0.4991511
	speed: 0.0136s/iter; left time: 68.3604s
	iters: 200, epoch: 4 | loss: 0.8945471
	speed: 0.0049s/iter; left time: 24.0845s
	iters: 300, epoch: 4 | loss: 0.5206509
	speed: 0.0049s/iter; left time: 23.6167s
	iters: 400, epoch: 4 | loss: 0.4448815
	speed: 0.0048s/iter; left time: 22.9088s
	iters: 500, epoch: 4 | loss: 0.4069911
	speed: 0.0047s/iter; left time: 21.7641s
	iters: 600, epoch: 4 | loss: 1.3149531
	speed: 0.0047s/iter; left time: 21.2009s
	iters: 700, epoch: 4 | loss: 0.2519091
	speed: 0.0047s/iter; left time: 20.8134s
	iters: 800, epoch: 4 | loss: 0.5065566
	speed: 0.0047s/iter; left time: 20.4947s
	iters: 900, epoch: 4 | loss: 0.2626088
	speed: 0.0049s/iter; left time: 20.5771s
	iters: 1000, epoch: 4 | loss: 0.4586194
	speed: 0.0050s/iter; left time: 20.6658s
Updating learning rate to 0.00017311403345
Epoch: 4 cost time: 4.987403631210327
Epoch: 4, Steps: 1027 | Train Loss: 0.5560869 Vali Loss: 0.4142569 Best vali loss: 0.4034660
	iters: 100, epoch: 5 | loss: 0.6490741
	speed: 0.0132s/iter; left time: 52.9996s
	iters: 200, epoch: 5 | loss: 1.2329791
	speed: 0.0053s/iter; left time: 20.5785s
	iters: 300, epoch: 5 | loss: 0.4076087
	speed: 0.0053s/iter; left time: 20.0868s
	iters: 400, epoch: 5 | loss: 0.2251294
	speed: 0.0052s/iter; left time: 19.4175s
	iters: 500, epoch: 5 | loss: 1.0679594
	speed: 0.0050s/iter; left time: 18.0592s
	iters: 600, epoch: 5 | loss: 0.6507691
	speed: 0.0050s/iter; left time: 17.5806s
	iters: 700, epoch: 5 | loss: 0.5535846
	speed: 0.0050s/iter; left time: 17.0896s
	iters: 800, epoch: 5 | loss: 0.4732439
	speed: 0.0050s/iter; left time: 16.5807s
	iters: 900, epoch: 5 | loss: 1.0666806
	speed: 0.0050s/iter; left time: 16.1288s
	iters: 1000, epoch: 5 | loss: 0.4749117
	speed: 0.0050s/iter; left time: 15.5528s
Updating learning rate to 0.00010686616093878905
Validation loss decreased (0.4035 --> 0.4015).  Saving model state dict ...
Epoch: 5 cost time: 5.289914846420288
Epoch: 5, Steps: 1027 | Train Loss: 0.6801941 Vali Loss: 0.4015435 Best vali loss: 0.4015435
	iters: 100, epoch: 6 | loss: 0.5283287
	speed: 0.0141s/iter; left time: 42.0803s
	iters: 200, epoch: 6 | loss: 0.3574756
	speed: 0.0053s/iter; left time: 15.2584s
	iters: 300, epoch: 6 | loss: 0.3269297
	speed: 0.0053s/iter; left time: 14.8490s
	iters: 400, epoch: 6 | loss: 1.1328166
	speed: 0.0053s/iter; left time: 14.2798s
	iters: 500, epoch: 6 | loss: 0.3868023
	speed: 0.0053s/iter; left time: 13.7480s
	iters: 600, epoch: 6 | loss: 1.1887358
	speed: 0.0053s/iter; left time: 13.1385s
	iters: 700, epoch: 6 | loss: 0.5266240
	speed: 0.0053s/iter; left time: 12.6534s
	iters: 800, epoch: 6 | loss: 0.4842669
	speed: 0.0053s/iter; left time: 12.0964s
	iters: 900, epoch: 6 | loss: 0.6062125
	speed: 0.0053s/iter; left time: 11.5947s
	iters: 1000, epoch: 6 | loss: 1.4456042
	speed: 0.0053s/iter; left time: 11.0183s
Updating learning rate to 5.070392647895019e-05
Epoch: 6 cost time: 5.494534969329834
Epoch: 6, Steps: 1027 | Train Loss: 0.6983796 Vali Loss: 0.4018402 Best vali loss: 0.4015435
	iters: 100, epoch: 7 | loss: 0.2645464
	speed: 0.0131s/iter; left time: 25.6632s
	iters: 200, epoch: 7 | loss: 0.4299718
	speed: 0.0053s/iter; left time: 9.7784s
	iters: 300, epoch: 7 | loss: 0.3422943
	speed: 0.0053s/iter; left time: 9.2538s
	iters: 400, epoch: 7 | loss: 0.3429423
	speed: 0.0052s/iter; left time: 8.6187s
	iters: 500, epoch: 7 | loss: 0.4459795
	speed: 0.0052s/iter; left time: 8.1416s
	iters: 600, epoch: 7 | loss: 0.5773500
	speed: 0.0052s/iter; left time: 7.5264s
	iters: 700, epoch: 7 | loss: 1.8017385
	speed: 0.0052s/iter; left time: 7.0510s
	iters: 800, epoch: 7 | loss: 0.5014850
	speed: 0.0052s/iter; left time: 6.4974s
	iters: 900, epoch: 7 | loss: 0.4548287
	speed: 0.0052s/iter; left time: 5.9572s
	iters: 1000, epoch: 7 | loss: 1.1264125
	speed: 0.0052s/iter; left time: 5.5209s
Updating learning rate to 1.3177521155070744e-05
Epoch: 7 cost time: 5.399930000305176
Epoch: 7, Steps: 1027 | Train Loss: 0.6287549 Vali Loss: 0.4043234 Best vali loss: 0.4015435
	iters: 100, epoch: 8 | loss: 0.4541664
	speed: 0.0131s/iter; left time: 12.1392s
	iters: 200, epoch: 8 | loss: 0.3273148
	speed: 0.0052s/iter; left time: 4.3368s
	iters: 300, epoch: 8 | loss: 0.7829183
	speed: 0.0053s/iter; left time: 3.8348s
	iters: 400, epoch: 8 | loss: 1.0189573
	speed: 0.0052s/iter; left time: 3.2847s
	iters: 500, epoch: 8 | loss: 1.3025719
	speed: 0.0052s/iter; left time: 2.7693s
	iters: 600, epoch: 8 | loss: 0.3481231
	speed: 0.0053s/iter; left time: 2.2506s
	iters: 700, epoch: 8 | loss: 0.2086667
	speed: 0.0053s/iter; left time: 1.7289s
	iters: 800, epoch: 8 | loss: 1.5345972
	speed: 0.0053s/iter; left time: 1.2043s
	iters: 900, epoch: 8 | loss: 0.5607859
	speed: 0.0052s/iter; left time: 0.6703s
	iters: 1000, epoch: 8 | loss: 1.1571442
	speed: 0.0050s/iter; left time: 0.1408s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.404042482376099
Epoch: 8, Steps: 1027 | Train Loss: 0.7695246 Vali Loss: 0.4035192 Best vali loss: 0.4015435

best validation loss 0.4015434651454446

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0064185617555, 'e_layers': 3, 'learning_rate': 0.00047232941, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6565958
	speed: 0.0104s/iter; left time: 41.6974s
	iters: 200, epoch: 1 | loss: 0.3235597
	speed: 0.0042s/iter; left time: 16.6127s
	iters: 300, epoch: 1 | loss: 0.5953018
	speed: 0.0042s/iter; left time: 15.9123s
	iters: 400, epoch: 1 | loss: 0.6879832
	speed: 0.0043s/iter; left time: 15.9716s
	iters: 500, epoch: 1 | loss: 0.4932904
	speed: 0.0042s/iter; left time: 15.2544s
Updating learning rate to 0.00047232941
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 2.5133872032165527
Epoch: 1, Steps: 514 | Train Loss: 0.5513462 Vali Loss: 0.3680774 Best vali loss: 0.3680774
	iters: 100, epoch: 2 | loss: 0.8567752
	speed: 0.0087s/iter; left time: 30.3433s
	iters: 200, epoch: 2 | loss: 0.4713689
	speed: 0.0043s/iter; left time: 14.7213s
	iters: 300, epoch: 2 | loss: 0.3035979
	speed: 0.0042s/iter; left time: 13.9230s
	iters: 400, epoch: 2 | loss: 0.9950507
	speed: 0.0042s/iter; left time: 13.4242s
	iters: 500, epoch: 2 | loss: 0.3811525
	speed: 0.0037s/iter; left time: 11.4298s
Updating learning rate to 0.000236164705
Epoch: 2 cost time: 2.172703981399536
Epoch: 2, Steps: 514 | Train Loss: 0.6015891 Vali Loss: 0.3835141 Best vali loss: 0.3680774
	iters: 100, epoch: 3 | loss: 0.6783000
	speed: 0.0081s/iter; left time: 24.3238s
	iters: 200, epoch: 3 | loss: 0.5367979
	speed: 0.0040s/iter; left time: 11.4545s
	iters: 300, epoch: 3 | loss: 0.5678844
	speed: 0.0037s/iter; left time: 10.4090s
	iters: 400, epoch: 3 | loss: 0.3864996
	speed: 0.0036s/iter; left time: 9.6105s
	iters: 500, epoch: 3 | loss: 0.5896915
	speed: 0.0036s/iter; left time: 9.2540s
Updating learning rate to 0.0001180823525
Epoch: 3 cost time: 1.9953160285949707
Epoch: 3, Steps: 514 | Train Loss: 0.5518347 Vali Loss: 0.3697489 Best vali loss: 0.3680774
	iters: 100, epoch: 4 | loss: 0.9003545
	speed: 0.0079s/iter; left time: 19.6393s
	iters: 200, epoch: 4 | loss: 0.3741242
	speed: 0.0039s/iter; left time: 9.2356s
	iters: 300, epoch: 4 | loss: 0.2693753
	speed: 0.0039s/iter; left time: 8.7961s
	iters: 400, epoch: 4 | loss: 0.2819653
	speed: 0.0038s/iter; left time: 8.3292s
	iters: 500, epoch: 4 | loss: 0.6673489
	speed: 0.0038s/iter; left time: 7.9133s
Updating learning rate to 5.904117625e-05
Epoch: 4 cost time: 2.0134854316711426
Epoch: 4, Steps: 514 | Train Loss: 0.4986336 Vali Loss: 0.3773719 Best vali loss: 0.3680774
	iters: 100, epoch: 5 | loss: 0.7568466
	speed: 0.0087s/iter; left time: 16.9915s
	iters: 200, epoch: 5 | loss: 0.4672377
	speed: 0.0042s/iter; left time: 7.8484s
	iters: 300, epoch: 5 | loss: 0.6647409
	speed: 0.0042s/iter; left time: 7.3272s
	iters: 400, epoch: 5 | loss: 0.4012962
	speed: 0.0042s/iter; left time: 6.9701s
	iters: 500, epoch: 5 | loss: 0.7071281
	speed: 0.0043s/iter; left time: 6.6496s
Updating learning rate to 2.9520588125e-05
Epoch: 5 cost time: 2.2246270179748535
Epoch: 5, Steps: 514 | Train Loss: 0.5994499 Vali Loss: 0.3710584 Best vali loss: 0.3680774
	iters: 100, epoch: 6 | loss: 0.9542232
	speed: 0.0082s/iter; left time: 11.7699s
	iters: 200, epoch: 6 | loss: 0.6770860
	speed: 0.0038s/iter; left time: 5.0869s
	iters: 300, epoch: 6 | loss: 0.6576384
	speed: 0.0038s/iter; left time: 4.7092s
	iters: 400, epoch: 6 | loss: 0.5659046
	speed: 0.0039s/iter; left time: 4.4933s
	iters: 500, epoch: 6 | loss: 0.4224439
	speed: 0.0036s/iter; left time: 3.7740s
Updating learning rate to 1.47602940625e-05
Epoch: 6 cost time: 1.989250898361206
Epoch: 6, Steps: 514 | Train Loss: 0.6554592 Vali Loss: 0.3796781 Best vali loss: 0.3680774
	iters: 100, epoch: 7 | loss: 0.3467942
	speed: 0.0082s/iter; left time: 7.6469s
	iters: 200, epoch: 7 | loss: 0.6845298
	speed: 0.0038s/iter; left time: 3.1222s
	iters: 300, epoch: 7 | loss: 0.6435820
	speed: 0.0038s/iter; left time: 2.7976s
	iters: 400, epoch: 7 | loss: 0.5493119
	speed: 0.0038s/iter; left time: 2.3728s
	iters: 500, epoch: 7 | loss: 0.3830310
	speed: 0.0037s/iter; left time: 1.9607s
Updating learning rate to 7.38014703125e-06
Epoch: 7 cost time: 1.9997448921203613
Epoch: 7, Steps: 514 | Train Loss: 0.5214498 Vali Loss: 0.3802283 Best vali loss: 0.3680774
	iters: 100, epoch: 8 | loss: 0.8839425
	speed: 0.0083s/iter; left time: 3.4291s
	iters: 200, epoch: 8 | loss: 0.3517852
	speed: 0.0037s/iter; left time: 1.1676s
	iters: 300, epoch: 8 | loss: 0.3637837
	speed: 0.0039s/iter; left time: 0.8408s
	iters: 400, epoch: 8 | loss: 0.5791448
	speed: 0.0038s/iter; left time: 0.4414s
	iters: 500, epoch: 8 | loss: 0.6144002
	speed: 0.0038s/iter; left time: 0.0564s
Updating learning rate to 3.690073515625e-06
Epoch: 8 cost time: 1.9868907928466797
Epoch: 8, Steps: 514 | Train Loss: 0.5586113 Vali Loss: 0.3784786 Best vali loss: 0.3680774

best validation loss 0.36807735155982446

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0044414466674, 'e_layers': 2, 'learning_rate': 0.0036967156042, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0035560177442177376
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 0.6592252254486084
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3674158 Best vali loss: 0.3674158
Updating learning rate to 0.0031553441380239725
Epoch: 2 cost time: 0.3623194694519043
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3726799 Best vali loss: 0.3674158
Updating learning rate to 0.0025556937100464213
Validation loss decreased (0.3674 --> 0.3633).  Saving model state dict ...
Epoch: 3 cost time: 0.34609270095825195
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3633201 Best vali loss: 0.3633201

best validation loss 0.3633201156009157

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022153028359, 'e_layers': 4, 'learning_rate': 0.0003966857258, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4146537
	speed: 0.0113s/iter; left time: 45.5264s
	iters: 200, epoch: 1 | loss: 0.3377589
	speed: 0.0050s/iter; left time: 19.3727s
	iters: 300, epoch: 1 | loss: 0.3950274
	speed: 0.0047s/iter; left time: 17.8200s
	iters: 400, epoch: 1 | loss: 0.3341065
	speed: 0.0046s/iter; left time: 17.2231s
	iters: 500, epoch: 1 | loss: 0.9167096
	speed: 0.0050s/iter; left time: 18.1953s
Updating learning rate to 0.0003815877743530022
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 2.874859571456909
Epoch: 1, Steps: 514 | Train Loss: 0.4796512 Vali Loss: 0.3714421 Best vali loss: 0.3714421
	iters: 100, epoch: 2 | loss: 1.1286050
	speed: 0.0100s/iter; left time: 35.1536s
	iters: 200, epoch: 2 | loss: 0.9643057
	speed: 0.0050s/iter; left time: 17.0024s
	iters: 300, epoch: 2 | loss: 0.6290496
	speed: 0.0050s/iter; left time: 16.5140s
	iters: 400, epoch: 2 | loss: 0.3699904
	speed: 0.0050s/iter; left time: 15.9732s
	iters: 500, epoch: 2 | loss: 0.4349679
	speed: 0.0050s/iter; left time: 15.4819s
Updating learning rate to 0.0003385924462565437
Epoch: 2 cost time: 2.6145684719085693
Epoch: 2, Steps: 514 | Train Loss: 0.7053837 Vali Loss: 0.3860162 Best vali loss: 0.3714421
	iters: 100, epoch: 3 | loss: 0.4074588
	speed: 0.0095s/iter; left time: 28.2114s
	iters: 200, epoch: 3 | loss: 0.4880072
	speed: 0.0048s/iter; left time: 13.9022s
	iters: 300, epoch: 3 | loss: 0.7695177
	speed: 0.0048s/iter; left time: 13.3094s
	iters: 400, epoch: 3 | loss: 0.3831849
	speed: 0.0049s/iter; left time: 13.1722s
	iters: 500, epoch: 3 | loss: 1.1238606
	speed: 0.0050s/iter; left time: 12.9225s
Updating learning rate to 0.0002742453904596904
Epoch: 3 cost time: 2.5392510890960693
Epoch: 3, Steps: 514 | Train Loss: 0.6344058 Vali Loss: 0.3740493 Best vali loss: 0.3714421

best validation loss 0.37144214079398774

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022154773801, 'e_layers': 4, 'learning_rate': 0.0003933287389, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4146568
	speed: 0.0112s/iter; left time: 44.8561s
	iters: 200, epoch: 1 | loss: 0.3394789
	speed: 0.0051s/iter; left time: 20.0345s
	iters: 300, epoch: 1 | loss: 0.3688919
	speed: 0.0051s/iter; left time: 19.5237s
	iters: 400, epoch: 1 | loss: 0.3570785
	speed: 0.0052s/iter; left time: 19.1653s
	iters: 500, epoch: 1 | loss: 0.9380779
	speed: 0.0049s/iter; left time: 17.7321s
Updating learning rate to 0.000378358555159093
Validation loss decreased (inf --> 0.3778).  Saving model state dict ...
Epoch: 1 cost time: 2.9643492698669434
Epoch: 1, Steps: 514 | Train Loss: 0.4836368 Vali Loss: 0.3778281 Best vali loss: 0.3778281
	iters: 100, epoch: 2 | loss: 1.1744629
	speed: 0.0099s/iter; left time: 34.5086s
	iters: 200, epoch: 2 | loss: 0.9467505
	speed: 0.0050s/iter; left time: 16.9253s
	iters: 300, epoch: 2 | loss: 0.5631663
	speed: 0.0050s/iter; left time: 16.4580s
	iters: 400, epoch: 2 | loss: 0.4051627
	speed: 0.0048s/iter; left time: 15.4567s
	iters: 500, epoch: 2 | loss: 0.4333916
	speed: 0.0048s/iter; left time: 14.7575s
Updating learning rate to 0.0003357270787058715
Validation loss decreased (0.3778 --> 0.3616).  Saving model state dict ...
Epoch: 2 cost time: 2.550797939300537
Epoch: 2, Steps: 514 | Train Loss: 0.7045868 Vali Loss: 0.3615532 Best vali loss: 0.3615532
	iters: 100, epoch: 3 | loss: 0.3974831
	speed: 0.0100s/iter; left time: 29.8201s
	iters: 200, epoch: 3 | loss: 0.4821462
	speed: 0.0050s/iter; left time: 14.3453s
	iters: 300, epoch: 3 | loss: 0.7445697
	speed: 0.0046s/iter; left time: 12.8684s
	iters: 400, epoch: 3 | loss: 0.3632523
	speed: 0.0049s/iter; left time: 13.1530s
	iters: 500, epoch: 3 | loss: 0.9770755
	speed: 0.0050s/iter; left time: 12.8388s
Updating learning rate to 0.00027192456537504213
Epoch: 3 cost time: 2.5704867839813232
Epoch: 3, Steps: 514 | Train Loss: 0.5929053 Vali Loss: 0.3751770 Best vali loss: 0.3615532

best validation loss 0.3615532080644709

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022154773801, 'e_layers': 4, 'learning_rate': 0.0003933287389, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4300017
	speed: 0.0116s/iter; left time: 28.6560s
	iters: 200, epoch: 4 | loss: 0.3146651
	speed: 0.0053s/iter; left time: 12.4795s
	iters: 300, epoch: 4 | loss: 0.3021519
	speed: 0.0053s/iter; left time: 12.0258s
	iters: 400, epoch: 4 | loss: 0.3287233
	speed: 0.0053s/iter; left time: 11.5822s
	iters: 500, epoch: 4 | loss: 0.8191766
	speed: 0.0054s/iter; left time: 11.0946s
Updating learning rate to 0.00019666436945
Epoch: 4 cost time: 3.079263687133789
Epoch: 4, Steps: 514 | Train Loss: 0.4389437 Vali Loss: 0.3639506 Best vali loss: 0.3615532
	iters: 100, epoch: 5 | loss: 1.0422866
	speed: 0.0096s/iter; left time: 18.7145s
	iters: 200, epoch: 5 | loss: 0.8221408
	speed: 0.0055s/iter; left time: 10.3022s
	iters: 300, epoch: 5 | loss: 0.4858438
	speed: 0.0052s/iter; left time: 9.1186s
	iters: 400, epoch: 5 | loss: 0.3917943
	speed: 0.0051s/iter; left time: 8.4245s
	iters: 500, epoch: 5 | loss: 0.4086361
	speed: 0.0053s/iter; left time: 8.2580s
Updating learning rate to 0.00012140417352495792
Epoch: 5 cost time: 2.7105016708374023
Epoch: 5, Steps: 514 | Train Loss: 0.6301403 Vali Loss: 0.3633449 Best vali loss: 0.3615532
	iters: 100, epoch: 6 | loss: 0.3429262
	speed: 0.0096s/iter; left time: 13.9127s
	iters: 200, epoch: 6 | loss: 0.3380169
	speed: 0.0047s/iter; left time: 6.3294s
	iters: 300, epoch: 6 | loss: 0.6718547
	speed: 0.0046s/iter; left time: 5.6586s
	iters: 400, epoch: 6 | loss: 0.3063184
	speed: 0.0046s/iter; left time: 5.2070s
	iters: 500, epoch: 6 | loss: 0.8780746
	speed: 0.0048s/iter; left time: 4.9825s
Updating learning rate to 5.7601660194128525e-05
Validation loss decreased (0.3616 --> 0.3520).  Saving model state dict ...
Epoch: 6 cost time: 2.4392342567443848
Epoch: 6, Steps: 514 | Train Loss: 0.5074382 Vali Loss: 0.3519897 Best vali loss: 0.3519897
	iters: 100, epoch: 7 | loss: 0.5600172
	speed: 0.0095s/iter; left time: 8.8466s
	iters: 200, epoch: 7 | loss: 0.7319341
	speed: 0.0047s/iter; left time: 3.9056s
	iters: 300, epoch: 7 | loss: 0.3528757
	speed: 0.0048s/iter; left time: 3.5259s
	iters: 400, epoch: 7 | loss: 0.2312483
	speed: 0.0046s/iter; left time: 2.8874s
	iters: 500, epoch: 7 | loss: 0.2932153
	speed: 0.0044s/iter; left time: 2.3453s
Updating learning rate to 1.497018374090702e-05
Validation loss decreased (0.3520 --> 0.3433).  Saving model state dict ...
Epoch: 7 cost time: 2.4299230575561523
Epoch: 7, Steps: 514 | Train Loss: 0.4338581 Vali Loss: 0.3433020 Best vali loss: 0.3433020
	iters: 100, epoch: 8 | loss: 0.4325148
	speed: 0.0099s/iter; left time: 4.1195s
	iters: 200, epoch: 8 | loss: 0.6043971
	speed: 0.0048s/iter; left time: 1.5249s
	iters: 300, epoch: 8 | loss: 0.3296755
	speed: 0.0049s/iter; left time: 1.0499s
	iters: 400, epoch: 8 | loss: 0.6063280
	speed: 0.0049s/iter; left time: 0.5634s
	iters: 500, epoch: 8 | loss: 0.4916673
	speed: 0.0049s/iter; left time: 0.0737s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5831053256988525
Epoch: 8, Steps: 514 | Train Loss: 0.4929166 Vali Loss: 0.3474889 Best vali loss: 0.3433020

best validation loss 0.3433019746380377

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0049358127276, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.0899243354797363
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3690114 Best vali loss: 0.3690114
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3690 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 0.7736673355102539
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3619642 Best vali loss: 0.3619642
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3620 --> 0.3610).  Saving model state dict ...
Epoch: 3 cost time: 0.7781765460968018
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3610432 Best vali loss: 0.3610432
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3610 --> 0.3531).  Saving model state dict ...
Epoch: 4 cost time: 0.7759313583374023
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3531329 Best vali loss: 0.3531329
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7774655818939209
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3533980 Best vali loss: 0.3531329
Updating learning rate to 2.0994346484375e-05
Epoch: 6 cost time: 0.7755541801452637
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3532483 Best vali loss: 0.3531329
Updating learning rate to 1.04971732421875e-05
Epoch: 7 cost time: 0.7730910778045654
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3551111 Best vali loss: 0.3531329
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7819352149963379
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3549420 Best vali loss: 0.3531329

best validation loss 0.353132869148067

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0049416748054, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.1009271144866943
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3690546 Best vali loss: 0.3690546
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3691 --> 0.3645).  Saving model state dict ...
Epoch: 2 cost time: 0.7812497615814209
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3644528 Best vali loss: 0.3644528
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3645 --> 0.3623).  Saving model state dict ...
Epoch: 3 cost time: 0.7819228172302246
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3622808 Best vali loss: 0.3622808
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3623 --> 0.3510).  Saving model state dict ...
Epoch: 4 cost time: 0.779071569442749
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3509828 Best vali loss: 0.3509828
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7771706581115723
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3518993 Best vali loss: 0.3509828
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3510 --> 0.3492).  Saving model state dict ...
Epoch: 6 cost time: 0.7750780582427979
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3492040 Best vali loss: 0.3492040
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3492 --> 0.3486).  Saving model state dict ...
Epoch: 7 cost time: 0.781365156173706
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3486460 Best vali loss: 0.3486460
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7861478328704834
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3486493 Best vali loss: 0.3486460

best validation loss 0.3486459796929875

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022364956404, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.1073777675628662
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3672796 Best vali loss: 0.3672796
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.7921168804168701
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3727538 Best vali loss: 0.3672796
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3673 --> 0.3616).  Saving model state dict ...
Epoch: 3 cost time: 0.7878482341766357
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3616151 Best vali loss: 0.3616151

best validation loss 0.36161512721966665

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0060784251569, 'e_layers': 4, 'learning_rate': 0.0002501279343, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4111696
	speed: 0.0114s/iter; left time: 92.5640s
	iters: 200, epoch: 1 | loss: 0.5475069
	speed: 0.0052s/iter; left time: 41.6227s
	iters: 300, epoch: 1 | loss: 0.3216499
	speed: 0.0052s/iter; left time: 41.1082s
	iters: 400, epoch: 1 | loss: 0.6262256
	speed: 0.0051s/iter; left time: 40.2021s
	iters: 500, epoch: 1 | loss: 1.2307675
	speed: 0.0049s/iter; left time: 38.0209s
	iters: 600, epoch: 1 | loss: 1.0200452
	speed: 0.0050s/iter; left time: 38.0621s
	iters: 700, epoch: 1 | loss: 0.4119373
	speed: 0.0050s/iter; left time: 37.6140s
	iters: 800, epoch: 1 | loss: 0.7021503
	speed: 0.0050s/iter; left time: 37.0372s
	iters: 900, epoch: 1 | loss: 0.3787598
	speed: 0.0050s/iter; left time: 36.4801s
	iters: 1000, epoch: 1 | loss: 0.7037222
	speed: 0.0050s/iter; left time: 35.8672s
Updating learning rate to 0.0002406080066545489
Validation loss decreased (inf --> 0.3842).  Saving model state dict ...
Epoch: 1 cost time: 5.553675174713135
Epoch: 1, Steps: 1027 | Train Loss: 0.6353934 Vali Loss: 0.3842104 Best vali loss: 0.3842104
	iters: 100, epoch: 2 | loss: 0.8771678
	speed: 0.0137s/iter; left time: 96.9584s
	iters: 200, epoch: 2 | loss: 0.3076745
	speed: 0.0053s/iter; left time: 36.9728s
	iters: 300, epoch: 2 | loss: 0.9244422
	speed: 0.0052s/iter; left time: 35.9659s
	iters: 400, epoch: 2 | loss: 0.5958161
	speed: 0.0052s/iter; left time: 35.6003s
	iters: 500, epoch: 2 | loss: 0.6116374
	speed: 0.0053s/iter; left time: 35.1704s
	iters: 600, epoch: 2 | loss: 0.3705812
	speed: 0.0053s/iter; left time: 34.7021s
	iters: 700, epoch: 2 | loss: 0.4446380
	speed: 0.0053s/iter; left time: 34.2906s
	iters: 800, epoch: 2 | loss: 0.3407444
	speed: 0.0053s/iter; left time: 33.5522s
	iters: 900, epoch: 2 | loss: 0.4420038
	speed: 0.0053s/iter; left time: 33.0547s
	iters: 1000, epoch: 2 | loss: 0.6681691
	speed: 0.0053s/iter; left time: 32.5134s
Updating learning rate to 0.00021349754640385661
Validation loss decreased (0.3842 --> 0.3826).  Saving model state dict ...
Epoch: 2 cost time: 5.441336393356323
Epoch: 2, Steps: 1027 | Train Loss: 0.5582874 Vali Loss: 0.3825882 Best vali loss: 0.3825882
	iters: 100, epoch: 3 | loss: 0.5155216
	speed: 0.0136s/iter; left time: 82.6573s
	iters: 200, epoch: 3 | loss: 0.5137499
	speed: 0.0048s/iter; left time: 28.5788s
	iters: 300, epoch: 3 | loss: 0.2841426
	speed: 0.0047s/iter; left time: 27.2752s
	iters: 400, epoch: 3 | loss: 1.0682992
	speed: 0.0048s/iter; left time: 27.8647s
	iters: 500, epoch: 3 | loss: 0.9616107
	speed: 0.0048s/iter; left time: 26.9496s
	iters: 600, epoch: 3 | loss: 0.5990047
	speed: 0.0049s/iter; left time: 27.1430s
	iters: 700, epoch: 3 | loss: 0.2449270
	speed: 0.0050s/iter; left time: 27.0856s
	iters: 800, epoch: 3 | loss: 1.0897108
	speed: 0.0048s/iter; left time: 25.9467s
	iters: 900, epoch: 3 | loss: 0.9021632
	speed: 0.0050s/iter; left time: 26.3143s
	iters: 1000, epoch: 3 | loss: 0.7464823
	speed: 0.0049s/iter; left time: 25.4203s
Updating learning rate to 0.00017292387536415685
Validation loss decreased (0.3826 --> 0.3778).  Saving model state dict ...
Epoch: 3 cost time: 5.016238212585449
Epoch: 3, Steps: 1027 | Train Loss: 0.6925612 Vali Loss: 0.3778324 Best vali loss: 0.3778324

best validation loss 0.37783239044702827

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0088649753384, 'e_layers': 4, 'learning_rate': 0.000248327684, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4121346
	speed: 0.0121s/iter; left time: 98.5817s
	iters: 200, epoch: 1 | loss: 0.5631252
	speed: 0.0053s/iter; left time: 42.4491s
	iters: 300, epoch: 1 | loss: 0.3195291
	speed: 0.0053s/iter; left time: 41.6908s
	iters: 400, epoch: 1 | loss: 0.6154536
	speed: 0.0051s/iter; left time: 40.0901s
	iters: 500, epoch: 1 | loss: 1.3443475
	speed: 0.0049s/iter; left time: 37.6396s
	iters: 600, epoch: 1 | loss: 0.9935415
	speed: 0.0050s/iter; left time: 38.0323s
	iters: 700, epoch: 1 | loss: 0.4000827
	speed: 0.0050s/iter; left time: 37.7326s
	iters: 800, epoch: 1 | loss: 0.6417355
	speed: 0.0048s/iter; left time: 35.8955s
	iters: 900, epoch: 1 | loss: 0.3686160
	speed: 0.0050s/iter; left time: 36.7445s
	iters: 1000, epoch: 1 | loss: 0.7157396
	speed: 0.0049s/iter; left time: 35.1835s
Updating learning rate to 0.00023887627430176526
Validation loss decreased (inf --> 0.3850).  Saving model state dict ...
Epoch: 1 cost time: 5.549850702285767
Epoch: 1, Steps: 1027 | Train Loss: 0.6374305 Vali Loss: 0.3850260 Best vali loss: 0.3850260
	iters: 100, epoch: 2 | loss: 0.8694397
	speed: 0.0133s/iter; left time: 94.2865s
	iters: 200, epoch: 2 | loss: 0.3209232
	speed: 0.0048s/iter; left time: 33.5678s
	iters: 300, epoch: 2 | loss: 0.8708376
	speed: 0.0048s/iter; left time: 33.0395s
	iters: 400, epoch: 2 | loss: 0.6648656
	speed: 0.0048s/iter; left time: 32.6211s
	iters: 500, epoch: 2 | loss: 0.6211874
	speed: 0.0048s/iter; left time: 32.2217s
	iters: 600, epoch: 2 | loss: 0.4042191
	speed: 0.0048s/iter; left time: 31.5606s
	iters: 700, epoch: 2 | loss: 0.4544166
	speed: 0.0048s/iter; left time: 31.0768s
	iters: 800, epoch: 2 | loss: 0.3551071
	speed: 0.0048s/iter; left time: 30.7749s
	iters: 900, epoch: 2 | loss: 0.4851981
	speed: 0.0049s/iter; left time: 30.5457s
	iters: 1000, epoch: 2 | loss: 0.6914989
	speed: 0.0048s/iter; left time: 29.7916s
Updating learning rate to 0.00021196093665637504
Epoch: 2 cost time: 4.9789488315582275
Epoch: 2, Steps: 1027 | Train Loss: 0.5737693 Vali Loss: 0.4099124 Best vali loss: 0.3850260
	iters: 100, epoch: 3 | loss: 0.5514745
	speed: 0.0127s/iter; left time: 77.2594s
	iters: 200, epoch: 3 | loss: 0.6130769
	speed: 0.0048s/iter; left time: 28.4276s
	iters: 300, epoch: 3 | loss: 0.2956845
	speed: 0.0047s/iter; left time: 27.4739s
	iters: 400, epoch: 3 | loss: 1.4416178
	speed: 0.0047s/iter; left time: 27.1842s
	iters: 500, epoch: 3 | loss: 1.0532308
	speed: 0.0047s/iter; left time: 26.8520s
	iters: 600, epoch: 3 | loss: 0.5129061
	speed: 0.0047s/iter; left time: 26.0687s
	iters: 700, epoch: 3 | loss: 0.2617248
	speed: 0.0048s/iter; left time: 26.3209s
	iters: 800, epoch: 3 | loss: 1.4626442
	speed: 0.0047s/iter; left time: 25.1584s
	iters: 900, epoch: 3 | loss: 0.9187292
	speed: 0.0048s/iter; left time: 25.4325s
	iters: 1000, epoch: 3 | loss: 1.2733361
	speed: 0.0048s/iter; left time: 24.8718s
Updating learning rate to 0.00017167928723219668
Epoch: 3 cost time: 4.920068979263306
Epoch: 3, Steps: 1027 | Train Loss: 0.8384425 Vali Loss: 0.4021249 Best vali loss: 0.3850260

best validation loss 0.3850260202624709

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022364956404, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3616 --> 0.3537).  Saving model state dict ...
Epoch: 4 cost time: 1.105919361114502
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3536968 Best vali loss: 0.3536968
Updating learning rate to 0.0002182291873478251
Epoch: 5 cost time: 0.8000702857971191
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3554725 Best vali loss: 0.3536968
Updating learning rate to 0.00010354144449133006
Epoch: 6 cost time: 0.7909183502197266
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3575268 Best vali loss: 0.3536968
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7959904670715332
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3573152 Best vali loss: 0.3536968
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7976946830749512
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3637950 Best vali loss: 0.3536968

best validation loss 0.3536967844415039

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761609593, 'e_layers': 4, 'learning_rate': 0.0006717172989, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006717172989
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 1.0853400230407715
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3687368 Best vali loss: 0.3687368
Updating learning rate to 0.00033585864945
Validation loss decreased (0.3687 --> 0.3571).  Saving model state dict ...
Epoch: 2 cost time: 0.783522367477417
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3571449 Best vali loss: 0.3571449
Updating learning rate to 0.000167929324725
Epoch: 3 cost time: 0.7784459590911865
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3593687 Best vali loss: 0.3571449
Updating learning rate to 8.39646623625e-05
Validation loss decreased (0.3571 --> 0.3454).  Saving model state dict ...
Epoch: 4 cost time: 0.7747628688812256
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3453523 Best vali loss: 0.3453523
Updating learning rate to 4.198233118125e-05
Epoch: 5 cost time: 0.780113697052002
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3466972 Best vali loss: 0.3453523
Updating learning rate to 2.0991165590625e-05
Epoch: 6 cost time: 0.7781982421875
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3468264 Best vali loss: 0.3453523
Updating learning rate to 1.04955827953125e-05
Epoch: 7 cost time: 0.778998851776123
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3470483 Best vali loss: 0.3453523
Updating learning rate to 5.24779139765625e-06
Epoch: 8 cost time: 0.7771952152252197
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3464825 Best vali loss: 0.3453523

best validation loss 0.34535231731963767

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761691343, 'e_layers': 4, 'learning_rate': 0.000675579337, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000675579337
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 1.0919537544250488
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3692829 Best vali loss: 0.3692829
Updating learning rate to 0.0003377896685
Validation loss decreased (0.3693 --> 0.3596).  Saving model state dict ...
Epoch: 2 cost time: 0.7795131206512451
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3595910 Best vali loss: 0.3595910
Updating learning rate to 0.00016889483425
Validation loss decreased (0.3596 --> 0.3576).  Saving model state dict ...
Epoch: 3 cost time: 0.7885732650756836
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3575623 Best vali loss: 0.3575623
Updating learning rate to 8.4447417125e-05
Validation loss decreased (0.3576 --> 0.3414).  Saving model state dict ...
Epoch: 4 cost time: 0.7876780033111572
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3414048 Best vali loss: 0.3414048
Updating learning rate to 4.22237085625e-05
Epoch: 5 cost time: 0.7885997295379639
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3423070 Best vali loss: 0.3414048
Updating learning rate to 2.111185428125e-05
Epoch: 6 cost time: 0.7847995758056641
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3428753 Best vali loss: 0.3414048
Updating learning rate to 1.0555927140625e-05
Epoch: 7 cost time: 0.7826268672943115
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3428545 Best vali loss: 0.3414048
Updating learning rate to 5.2779635703125e-06
Epoch: 8 cost time: 0.7802093029022217
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3429235 Best vali loss: 0.3414048

best validation loss 0.3414047762312449

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010632998303, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4266076
	speed: 0.0096s/iter; left time: 38.3561s
	iters: 200, epoch: 1 | loss: 0.9922144
	speed: 0.0036s/iter; left time: 13.9045s
	iters: 300, epoch: 1 | loss: 0.3764074
	speed: 0.0030s/iter; left time: 11.5192s
	iters: 400, epoch: 1 | loss: 0.6756268
	speed: 0.0030s/iter; left time: 11.0614s
	iters: 500, epoch: 1 | loss: 0.4080051
	speed: 0.0030s/iter; left time: 10.7723s
Updating learning rate to 0.0003823108006
Validation loss decreased (inf --> 0.3656).  Saving model state dict ...
Epoch: 1 cost time: 1.9851326942443848
Epoch: 1, Steps: 514 | Train Loss: 0.5757723 Vali Loss: 0.3655639 Best vali loss: 0.3655639
	iters: 100, epoch: 2 | loss: 1.3146570
	speed: 0.0074s/iter; left time: 26.0452s
	iters: 200, epoch: 2 | loss: 0.6707973
	speed: 0.0036s/iter; left time: 12.3878s
	iters: 300, epoch: 2 | loss: 0.8130300
	speed: 0.0036s/iter; left time: 11.9001s
	iters: 400, epoch: 2 | loss: 0.3145933
	speed: 0.0034s/iter; left time: 10.7777s
	iters: 500, epoch: 2 | loss: 0.2737420
	speed: 0.0035s/iter; left time: 10.9997s
Updating learning rate to 0.0001911554003
Validation loss decreased (0.3656 --> 0.3573).  Saving model state dict ...
Epoch: 2 cost time: 1.8593018054962158
Epoch: 2, Steps: 514 | Train Loss: 0.6773639 Vali Loss: 0.3573225 Best vali loss: 0.3573225
	iters: 100, epoch: 3 | loss: 0.3736286
	speed: 0.0078s/iter; left time: 23.3999s
	iters: 200, epoch: 3 | loss: 0.3732305
	speed: 0.0036s/iter; left time: 10.4355s
	iters: 300, epoch: 3 | loss: 0.6164012
	speed: 0.0035s/iter; left time: 9.8036s
	iters: 400, epoch: 3 | loss: 0.9729973
	speed: 0.0033s/iter; left time: 8.9731s
	iters: 500, epoch: 3 | loss: 0.5766750
	speed: 0.0035s/iter; left time: 9.0060s
Updating learning rate to 9.557770015e-05
Epoch: 3 cost time: 1.8500187397003174
Epoch: 3, Steps: 514 | Train Loss: 0.5825865 Vali Loss: 0.3583196 Best vali loss: 0.3573225

best validation loss 0.35732249522724413

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022141302088, 'e_layers': 4, 'learning_rate': 0.0007092158107, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007092158107
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.1105899810791016
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3673399 Best vali loss: 0.3673399
Updating learning rate to 0.00035460790535
Epoch: 2 cost time: 0.7908737659454346
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3856921 Best vali loss: 0.3673399
Updating learning rate to 0.000177303952675
Validation loss decreased (0.3673 --> 0.3625).  Saving model state dict ...
Epoch: 3 cost time: 0.7893357276916504
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3625373 Best vali loss: 0.3625373

best validation loss 0.3625373399445022

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0114143524654, 'e_layers': 4, 'learning_rate': 0.0007059516417, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006790829572046858
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.096930980682373
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695575 Best vali loss: 0.3695575
Updating learning rate to 0.0006025674173679229
Epoch: 2 cost time: 0.8003387451171875
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3699549 Best vali loss: 0.3695575
Updating learning rate to 0.00048805381951476303
Epoch: 3 cost time: 0.7945597171783447
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3884035 Best vali loss: 0.3695575

best validation loss 0.36955754044950595

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010632998303, 'e_layers': 2, 'learning_rate': 0.0003823108006, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3073068
	speed: 0.0097s/iter; left time: 24.0158s
	iters: 200, epoch: 4 | loss: 0.8124549
	speed: 0.0032s/iter; left time: 7.4827s
	iters: 300, epoch: 4 | loss: 0.3237522
	speed: 0.0030s/iter; left time: 6.7659s
	iters: 400, epoch: 4 | loss: 0.5566814
	speed: 0.0030s/iter; left time: 6.4495s
	iters: 500, epoch: 4 | loss: 0.3477936
	speed: 0.0030s/iter; left time: 6.1755s
Updating learning rate to 4.7788850075e-05
Validation loss decreased (0.3573 --> 0.3445).  Saving model state dict ...
Epoch: 4 cost time: 1.930124044418335
Epoch: 4, Steps: 514 | Train Loss: 0.4695978 Vali Loss: 0.3444756 Best vali loss: 0.3444756
	iters: 100, epoch: 5 | loss: 1.0211930
	speed: 0.0075s/iter; left time: 14.6965s
	iters: 200, epoch: 5 | loss: 0.6375265
	speed: 0.0031s/iter; left time: 5.8490s
	iters: 300, epoch: 5 | loss: 0.7152572
	speed: 0.0030s/iter; left time: 5.3429s
	iters: 400, epoch: 5 | loss: 0.2853523
	speed: 0.0031s/iter; left time: 5.1583s
	iters: 500, epoch: 5 | loss: 0.2601143
	speed: 0.0031s/iter; left time: 4.8321s
Updating learning rate to 2.38944250375e-05
Validation loss decreased (0.3445 --> 0.3444).  Saving model state dict ...
Epoch: 5 cost time: 1.6852715015411377
Epoch: 5, Steps: 514 | Train Loss: 0.5838887 Vali Loss: 0.3443594 Best vali loss: 0.3443594
	iters: 100, epoch: 6 | loss: 0.3360743
	speed: 0.0069s/iter; left time: 9.9007s
	iters: 200, epoch: 6 | loss: 0.3106415
	speed: 0.0031s/iter; left time: 4.1443s
	iters: 300, epoch: 6 | loss: 0.5899624
	speed: 0.0031s/iter; left time: 3.8003s
	iters: 400, epoch: 6 | loss: 0.8260180
	speed: 0.0031s/iter; left time: 3.5953s
	iters: 500, epoch: 6 | loss: 0.5561256
	speed: 0.0030s/iter; left time: 3.1388s
Updating learning rate to 1.194721251875e-05
Validation loss decreased (0.3444 --> 0.3426).  Saving model state dict ...
Epoch: 6 cost time: 1.62864089012146
Epoch: 6, Steps: 514 | Train Loss: 0.5237644 Vali Loss: 0.3426370 Best vali loss: 0.3426370
	iters: 100, epoch: 7 | loss: 0.4086825
	speed: 0.0070s/iter; left time: 6.4914s
	iters: 200, epoch: 7 | loss: 0.2812552
	speed: 0.0031s/iter; left time: 2.5459s
	iters: 300, epoch: 7 | loss: 0.4975416
	speed: 0.0032s/iter; left time: 2.3000s
	iters: 400, epoch: 7 | loss: 0.2868655
	speed: 0.0031s/iter; left time: 1.9730s
	iters: 500, epoch: 7 | loss: 0.8862796
	speed: 0.0030s/iter; left time: 1.5771s
Updating learning rate to 5.973606259375e-06
Epoch: 7 cost time: 1.631664514541626
Epoch: 7, Steps: 514 | Train Loss: 0.4721249 Vali Loss: 0.3438523 Best vali loss: 0.3426370
	iters: 100, epoch: 8 | loss: 0.3767250
	speed: 0.0071s/iter; left time: 2.9295s
	iters: 200, epoch: 8 | loss: 0.3977050
	speed: 0.0032s/iter; left time: 1.0110s
	iters: 300, epoch: 8 | loss: 0.2660911
	speed: 0.0033s/iter; left time: 0.7183s
	iters: 400, epoch: 8 | loss: 0.6313365
	speed: 0.0033s/iter; left time: 0.3828s
	iters: 500, epoch: 8 | loss: 0.7690659
	speed: 0.0031s/iter; left time: 0.0472s
Updating learning rate to 2.9868031296875e-06
Epoch: 8 cost time: 1.7051856517791748
Epoch: 8, Steps: 514 | Train Loss: 0.4881847 Vali Loss: 0.3446654 Best vali loss: 0.3426370

best validation loss 0.3426370217020245

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0030369283449, 'e_layers': 4, 'learning_rate': 6.23215336e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6532423
	speed: 0.0129s/iter; left time: 25.2374s
	iters: 200, epoch: 1 | loss: 0.4373385
	speed: 0.0066s/iter; left time: 12.1638s
Updating learning rate to 6.23215336e-05
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 2.0370259284973145
Epoch: 1, Steps: 257 | Train Loss: 0.5452904 Vali Loss: 0.3669560 Best vali loss: 0.3669560
	iters: 100, epoch: 2 | loss: 0.9940349
	speed: 0.0138s/iter; left time: 23.4837s
	iters: 200, epoch: 2 | loss: 0.8230318
	speed: 0.0065s/iter; left time: 10.4357s
Updating learning rate to 3.11607668e-05
Validation loss decreased (0.3670 --> 0.3616).  Saving model state dict ...
Epoch: 2 cost time: 1.714674472808838
Epoch: 2, Steps: 257 | Train Loss: 0.9085334 Vali Loss: 0.3615981 Best vali loss: 0.3615981
	iters: 100, epoch: 3 | loss: 0.5086719
	speed: 0.0140s/iter; left time: 20.1985s
	iters: 200, epoch: 3 | loss: 0.7053276
	speed: 0.0066s/iter; left time: 8.8712s
Updating learning rate to 1.55803834e-05
Epoch: 3 cost time: 1.7257399559020996
Epoch: 3, Steps: 257 | Train Loss: 0.6069998 Vali Loss: 0.3717198 Best vali loss: 0.3615981
	iters: 100, epoch: 4 | loss: 0.7036002
	speed: 0.0137s/iter; left time: 16.1967s
	iters: 200, epoch: 4 | loss: 0.5200375
	speed: 0.0066s/iter; left time: 7.1354s
Updating learning rate to 7.7901917e-06
Epoch: 4 cost time: 1.732900857925415
Epoch: 4, Steps: 257 | Train Loss: 0.6118189 Vali Loss: 0.3634236 Best vali loss: 0.3615981
	iters: 100, epoch: 5 | loss: 0.7306072
	speed: 0.0133s/iter; left time: 12.3444s
	iters: 200, epoch: 5 | loss: 0.6775312
	speed: 0.0065s/iter; left time: 5.3728s
Updating learning rate to 3.89509585e-06
Epoch: 5 cost time: 1.72221040725708
Epoch: 5, Steps: 257 | Train Loss: 0.7040692 Vali Loss: 0.3643541 Best vali loss: 0.3615981
	iters: 100, epoch: 6 | loss: 0.3907230
	speed: 0.0136s/iter; left time: 9.1688s
	iters: 200, epoch: 6 | loss: 0.5155552
	speed: 0.0066s/iter; left time: 3.7587s
Updating learning rate to 1.947547925e-06
Epoch: 6 cost time: 1.7287662029266357
Epoch: 6, Steps: 257 | Train Loss: 0.4531391 Vali Loss: 0.3648252 Best vali loss: 0.3615981
	iters: 100, epoch: 7 | loss: 0.6262791
	speed: 0.0136s/iter; left time: 5.6410s
	iters: 200, epoch: 7 | loss: 0.6933530
	speed: 0.0064s/iter; left time: 2.0185s
Updating learning rate to 9.737739625e-07
Epoch: 7 cost time: 1.709179401397705
Epoch: 7, Steps: 257 | Train Loss: 0.6598160 Vali Loss: 0.3624144 Best vali loss: 0.3615981
	iters: 100, epoch: 8 | loss: 0.6384867
	speed: 0.0136s/iter; left time: 2.1442s
	iters: 200, epoch: 8 | loss: 0.3645606
	speed: 0.0067s/iter; left time: 0.3898s
Updating learning rate to 4.8688698125e-07
Epoch: 8 cost time: 1.7623412609100342
Epoch: 8, Steps: 257 | Train Loss: 0.5015237 Vali Loss: 0.3645609 Best vali loss: 0.3615981

best validation loss 0.3615980569705045

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.001218565624, 'e_layers': 2, 'learning_rate': 5.14485397e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6982222
	speed: 0.0104s/iter; left time: 9.6993s
Updating learning rate to 5.14485397e-05
Validation loss decreased (inf --> 0.4250).  Saving model state dict ...
Epoch: 1 cost time: 0.8925118446350098
Epoch: 1, Steps: 129 | Train Loss: 0.6982222 Vali Loss: 0.4250478 Best vali loss: 0.4250478
	iters: 100, epoch: 2 | loss: 0.6887454
	speed: 0.0071s/iter; left time: 5.6813s
Updating learning rate to 2.572426985e-05
Validation loss decreased (0.4250 --> 0.4067).  Saving model state dict ...
Epoch: 2 cost time: 0.5713427066802979
Epoch: 2, Steps: 129 | Train Loss: 0.6887454 Vali Loss: 0.4066863 Best vali loss: 0.4066863
	iters: 100, epoch: 3 | loss: 0.8193626
	speed: 0.0073s/iter; left time: 4.9168s
Updating learning rate to 1.2862134925e-05
Validation loss decreased (0.4067 --> 0.3993).  Saving model state dict ...
Epoch: 3 cost time: 0.574122428894043
Epoch: 3, Steps: 129 | Train Loss: 0.8193626 Vali Loss: 0.3993205 Best vali loss: 0.3993205
	iters: 100, epoch: 4 | loss: 0.5307922
	speed: 0.0072s/iter; left time: 3.9498s
Updating learning rate to 6.4310674625e-06
Validation loss decreased (0.3993 --> 0.3961).  Saving model state dict ...
Epoch: 4 cost time: 0.581416130065918
Epoch: 4, Steps: 129 | Train Loss: 0.5307922 Vali Loss: 0.3961073 Best vali loss: 0.3961073
	iters: 100, epoch: 5 | loss: 0.6747476
	speed: 0.0074s/iter; left time: 3.0816s
Updating learning rate to 3.21553373125e-06
Validation loss decreased (0.3961 --> 0.3946).  Saving model state dict ...
Epoch: 5 cost time: 0.5799345970153809
Epoch: 5, Steps: 129 | Train Loss: 0.6747476 Vali Loss: 0.3945539 Best vali loss: 0.3945539
	iters: 100, epoch: 6 | loss: 0.6250426
	speed: 0.0071s/iter; left time: 2.0576s
Updating learning rate to 1.607766865625e-06
Validation loss decreased (0.3946 --> 0.3938).  Saving model state dict ...
Epoch: 6 cost time: 0.5720093250274658
Epoch: 6, Steps: 129 | Train Loss: 0.6250426 Vali Loss: 0.3938401 Best vali loss: 0.3938401
	iters: 100, epoch: 7 | loss: 0.8481269
	speed: 0.0069s/iter; left time: 1.0974s
Updating learning rate to 8.038834328125e-07
Validation loss decreased (0.3938 --> 0.3935).  Saving model state dict ...
Epoch: 7 cost time: 0.5333807468414307
Epoch: 7, Steps: 129 | Train Loss: 0.8481269 Vali Loss: 0.3934787 Best vali loss: 0.3934787
	iters: 100, epoch: 8 | loss: 0.8735583
	speed: 0.0069s/iter; left time: 0.2057s
Updating learning rate to 4.0194171640625e-07
Validation loss decreased (0.3935 --> 0.3933).  Saving model state dict ...
Epoch: 8 cost time: 0.533210039138794
Epoch: 8, Steps: 129 | Train Loss: 0.8735583 Vali Loss: 0.3932979 Best vali loss: 0.3932979

best validation loss 0.39329791903964195

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022324874229, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4272322
	speed: 0.0100s/iter; left time: 40.0772s
	iters: 200, epoch: 1 | loss: 1.0790303
	speed: 0.0033s/iter; left time: 13.0794s
	iters: 300, epoch: 1 | loss: 1.0145742
	speed: 0.0032s/iter; left time: 12.2502s
	iters: 400, epoch: 1 | loss: 0.5041854
	speed: 0.0032s/iter; left time: 11.9692s
	iters: 500, epoch: 1 | loss: 1.1171982
	speed: 0.0032s/iter; left time: 11.5432s
Updating learning rate to 0.0003957152226005332
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 2.0732979774475098
Epoch: 1, Steps: 514 | Train Loss: 0.8284441 Vali Loss: 0.3734417 Best vali loss: 0.3734417
	iters: 100, epoch: 2 | loss: 0.3866345
	speed: 0.0072s/iter; left time: 25.0669s
	iters: 200, epoch: 2 | loss: 0.2571198
	speed: 0.0034s/iter; left time: 11.4803s
	iters: 300, epoch: 2 | loss: 0.4832909
	speed: 0.0035s/iter; left time: 11.4389s
	iters: 400, epoch: 2 | loss: 0.3965322
	speed: 0.0033s/iter; left time: 10.6859s
	iters: 500, epoch: 2 | loss: 0.5915243
	speed: 0.0034s/iter; left time: 10.5132s
Updating learning rate to 0.00035112808702649433
Validation loss decreased (0.3734 --> 0.3654).  Saving model state dict ...
Epoch: 2 cost time: 1.777240514755249
Epoch: 2, Steps: 514 | Train Loss: 0.4230203 Vali Loss: 0.3653840 Best vali loss: 0.3653840
	iters: 100, epoch: 3 | loss: 0.3775379
	speed: 0.0076s/iter; left time: 22.7465s
	iters: 200, epoch: 3 | loss: 0.9109715
	speed: 0.0036s/iter; left time: 10.2846s
	iters: 300, epoch: 3 | loss: 0.5020436
	speed: 0.0036s/iter; left time: 9.9025s
	iters: 400, epoch: 3 | loss: 0.4742039
	speed: 0.0035s/iter; left time: 9.4409s
	iters: 500, epoch: 3 | loss: 1.1043704
	speed: 0.0035s/iter; left time: 9.0670s
Updating learning rate to 0.00028439872298564043
Validation loss decreased (0.3654 --> 0.3443).  Saving model state dict ...
Epoch: 3 cost time: 1.8648996353149414
Epoch: 3, Steps: 514 | Train Loss: 0.6738255 Vali Loss: 0.3443191 Best vali loss: 0.3443191

best validation loss 0.3443190806741096

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0078268174626, 'e_layers': 1, 'learning_rate': 0.0043329974773, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004168082580500254
Validation loss decreased (inf --> 0.3799).  Saving model state dict ...
Epoch: 1 cost time: 0.6409323215484619
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3799494 Best vali loss: 0.3799494
Updating learning rate to 0.0036984446881815165
Validation loss decreased (0.3799 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 0.31250810623168945
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3683478 Best vali loss: 0.3683478
Updating learning rate to 0.0029955819121712194
Epoch: 3 cost time: 0.34221529960632324
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3910850 Best vali loss: 0.3683478

best validation loss 0.3683478240296976

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.006896504473, 'e_layers': 4, 'learning_rate': 0.0003604638378, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5438453
	speed: 0.0119s/iter; left time: 11.1438s
Updating learning rate to 0.00034674449987694416
Validation loss decreased (inf --> 0.3852).  Saving model state dict ...
Epoch: 1 cost time: 1.0714001655578613
Epoch: 1, Steps: 129 | Train Loss: 0.5438453 Vali Loss: 0.3851963 Best vali loss: 0.3851963
	iters: 100, epoch: 2 | loss: 0.8296742
	speed: 0.0088s/iter; left time: 7.0871s
Updating learning rate to 0.0003076751309404539
Validation loss decreased (0.3852 --> 0.3733).  Saving model state dict ...
Epoch: 2 cost time: 0.723860502243042
Epoch: 2, Steps: 129 | Train Loss: 0.8296742 Vali Loss: 0.3732994 Best vali loss: 0.3732994
	iters: 100, epoch: 3 | loss: 0.5470570
	speed: 0.0094s/iter; left time: 6.3512s
Updating learning rate to 0.0002492036882463985
Validation loss decreased (0.3733 --> 0.3681).  Saving model state dict ...
Epoch: 3 cost time: 0.8120381832122803
Epoch: 3, Steps: 129 | Train Loss: 0.5470570 Vali Loss: 0.3681264 Best vali loss: 0.3681264

best validation loss 0.3681263977043287

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022324874229, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3737479
	speed: 0.0098s/iter; left time: 24.1608s
	iters: 200, epoch: 4 | loss: 0.9344425
	speed: 0.0036s/iter; left time: 8.5112s
	iters: 300, epoch: 4 | loss: 0.7864296
	speed: 0.0035s/iter; left time: 7.9811s
	iters: 400, epoch: 4 | loss: 0.4625338
	speed: 0.0034s/iter; left time: 7.3801s
	iters: 500, epoch: 4 | loss: 0.4445025
	speed: 0.0034s/iter; left time: 7.1256s
Updating learning rate to 0.00020568607125
Validation loss decreased (0.3443 --> 0.3396).  Saving model state dict ...
Epoch: 4 cost time: 2.1507515907287598
Epoch: 4, Steps: 514 | Train Loss: 0.6003313 Vali Loss: 0.3395699 Best vali loss: 0.3395699
	iters: 100, epoch: 5 | loss: 0.3907552
	speed: 0.0075s/iter; left time: 14.7505s
	iters: 200, epoch: 5 | loss: 0.2387275
	speed: 0.0036s/iter; left time: 6.6419s
	iters: 300, epoch: 5 | loss: 0.3495426
	speed: 0.0035s/iter; left time: 6.1110s
	iters: 400, epoch: 5 | loss: 0.3701438
	speed: 0.0034s/iter; left time: 5.7123s
	iters: 500, epoch: 5 | loss: 0.5624787
	speed: 0.0035s/iter; left time: 5.3908s
Updating learning rate to 0.0001269734195143596
Epoch: 5 cost time: 1.838965892791748
Epoch: 5, Steps: 514 | Train Loss: 0.3823296 Vali Loss: 0.3446958 Best vali loss: 0.3395699
	iters: 100, epoch: 6 | loss: 0.3010615
	speed: 0.0075s/iter; left time: 10.7512s
	iters: 200, epoch: 6 | loss: 0.6331864
	speed: 0.0036s/iter; left time: 4.8100s
	iters: 300, epoch: 6 | loss: 0.3794977
	speed: 0.0034s/iter; left time: 4.2466s
	iters: 400, epoch: 6 | loss: 0.3930524
	speed: 0.0036s/iter; left time: 4.0798s
	iters: 500, epoch: 6 | loss: 0.9082978
	speed: 0.0035s/iter; left time: 3.6811s
Updating learning rate to 6.024405547350564e-05
Epoch: 6 cost time: 1.8596792221069336
Epoch: 6, Steps: 514 | Train Loss: 0.5230192 Vali Loss: 0.3494380 Best vali loss: 0.3395699
	iters: 100, epoch: 7 | loss: 0.5179179
	speed: 0.0075s/iter; left time: 6.9230s
	iters: 200, epoch: 7 | loss: 0.4228887
	speed: 0.0034s/iter; left time: 2.7900s
	iters: 300, epoch: 7 | loss: 0.3821314
	speed: 0.0033s/iter; left time: 2.4329s
	iters: 400, epoch: 7 | loss: 0.5673691
	speed: 0.0033s/iter; left time: 2.0935s
	iters: 500, epoch: 7 | loss: 0.5966508
	speed: 0.0033s/iter; left time: 1.7618s
Updating learning rate to 1.5656919899466785e-05
Epoch: 7 cost time: 1.7810001373291016
Epoch: 7, Steps: 514 | Train Loss: 0.4973916 Vali Loss: 0.3544073 Best vali loss: 0.3395699
	iters: 100, epoch: 8 | loss: 0.4597189
	speed: 0.0072s/iter; left time: 3.0087s
	iters: 200, epoch: 8 | loss: 0.6030089
	speed: 0.0033s/iter; left time: 1.0454s
	iters: 300, epoch: 8 | loss: 0.3929579
	speed: 0.0033s/iter; left time: 0.7162s
	iters: 400, epoch: 8 | loss: 0.6010922
	speed: 0.0034s/iter; left time: 0.3853s
	iters: 500, epoch: 8 | loss: 0.4519486
	speed: 0.0033s/iter; left time: 0.0497s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7702851295471191
Epoch: 8, Steps: 514 | Train Loss: 0.5017453 Vali Loss: 0.3556100 Best vali loss: 0.3395699

best validation loss 0.33956989777697094

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050761691343, 'e_layers': 4, 'learning_rate': 0.000691819044, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000691819044
Validation loss decreased (inf --> 0.3689).  Saving model state dict ...
Epoch: 1 cost time: 1.0978474617004395
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3689144 Best vali loss: 0.3689144
Updating learning rate to 0.000345909522
Validation loss decreased (0.3689 --> 0.3552).  Saving model state dict ...
Epoch: 2 cost time: 0.7727863788604736
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3552442 Best vali loss: 0.3552442
Updating learning rate to 0.000172954761
Epoch: 3 cost time: 0.7732689380645752
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3577067 Best vali loss: 0.3552442
Updating learning rate to 8.64773805e-05
Validation loss decreased (0.3552 --> 0.3436).  Saving model state dict ...
Epoch: 4 cost time: 0.7690219879150391
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3435575 Best vali loss: 0.3435575
Updating learning rate to 4.323869025e-05
Epoch: 5 cost time: 0.7777340412139893
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3459917 Best vali loss: 0.3435575
Updating learning rate to 2.1619345125e-05
Validation loss decreased (0.3436 --> 0.3428).  Saving model state dict ...
Epoch: 6 cost time: 0.7720918655395508
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3428010 Best vali loss: 0.3428010
Updating learning rate to 1.08096725625e-05
Epoch: 7 cost time: 0.7804708480834961
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3437596 Best vali loss: 0.3428010
Updating learning rate to 5.40483628125e-06
Epoch: 8 cost time: 0.7793982028961182
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3437561 Best vali loss: 0.3428010

best validation loss 0.3428010120724414

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0025628861794, 'e_layers': 2, 'learning_rate': 0.0004101677978, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7282513
	speed: 0.0106s/iter; left time: 9.9032s
Updating learning rate to 0.000394556715541324
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 0.9116077423095703
Epoch: 1, Steps: 129 | Train Loss: 0.7282513 Vali Loss: 0.3655372 Best vali loss: 0.3655372
	iters: 100, epoch: 2 | loss: 0.4878691
	speed: 0.0074s/iter; left time: 5.9246s
Updating learning rate to 0.00035010011452436633
Epoch: 2 cost time: 0.5892090797424316
Epoch: 2, Steps: 129 | Train Loss: 0.4878691 Vali Loss: 0.3671194 Best vali loss: 0.3655372
	iters: 100, epoch: 3 | loss: 1.0087992
	speed: 0.0065s/iter; left time: 4.3722s
Updating learning rate to 0.0002835661092538671
Epoch: 3 cost time: 0.48900580406188965
Epoch: 3, Steps: 129 | Train Loss: 1.0087992 Vali Loss: 0.3670450 Best vali loss: 0.3655372
	iters: 100, epoch: 4 | loss: 0.3865501
	speed: 0.0064s/iter; left time: 3.4741s
Updating learning rate to 0.0002050838989
Epoch: 4 cost time: 0.5045289993286133
Epoch: 4, Steps: 129 | Train Loss: 0.3865501 Vali Loss: 0.3791730 Best vali loss: 0.3655372
	iters: 100, epoch: 5 | loss: 0.5437454
	speed: 0.0064s/iter; left time: 2.6480s
Updating learning rate to 0.00012660168854613295
Epoch: 5 cost time: 0.5024113655090332
Epoch: 5, Steps: 129 | Train Loss: 0.5437454 Vali Loss: 0.3697937 Best vali loss: 0.3655372
	iters: 100, epoch: 6 | loss: 0.3981722
	speed: 0.0064s/iter; left time: 1.8559s
Updating learning rate to 6.0067683275633684e-05
Epoch: 6 cost time: 0.5100092887878418
Epoch: 6, Steps: 129 | Train Loss: 0.3981722 Vali Loss: 0.3664347 Best vali loss: 0.3655372
	iters: 100, epoch: 7 | loss: 0.4511892
	speed: 0.0067s/iter; left time: 1.0661s
Updating learning rate to 1.561108225867601e-05
Epoch: 7 cost time: 0.547966480255127
Epoch: 7, Steps: 129 | Train Loss: 0.4511892 Vali Loss: 0.3678799 Best vali loss: 0.3655372
	iters: 100, epoch: 8 | loss: 0.4532647
	speed: 0.0066s/iter; left time: 0.1970s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5106863975524902
Epoch: 8, Steps: 129 | Train Loss: 0.4532647 Vali Loss: 0.3667539 Best vali loss: 0.3655372

best validation loss 0.365537212698305

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0043701484118, 'e_layers': 3, 'learning_rate': 0.0031986822055, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6219348
	speed: 0.0104s/iter; left time: 84.7358s
	iters: 200, epoch: 1 | loss: 0.6421469
	speed: 0.0043s/iter; left time: 34.6734s
	iters: 300, epoch: 1 | loss: 0.2889399
	speed: 0.0043s/iter; left time: 34.2583s
	iters: 400, epoch: 1 | loss: 0.9775126
	speed: 0.0043s/iter; left time: 33.4004s
	iters: 500, epoch: 1 | loss: 1.0085239
	speed: 0.0043s/iter; left time: 33.1100s
	iters: 600, epoch: 1 | loss: 1.0552326
	speed: 0.0043s/iter; left time: 32.4361s
	iters: 700, epoch: 1 | loss: 0.2844321
	speed: 0.0043s/iter; left time: 32.2151s
	iters: 800, epoch: 1 | loss: 0.4430817
	speed: 0.0043s/iter; left time: 32.2006s
	iters: 900, epoch: 1 | loss: 1.0443441
	speed: 0.0043s/iter; left time: 31.6484s
	iters: 1000, epoch: 1 | loss: 0.9630102
	speed: 0.0043s/iter; left time: 30.9285s
Updating learning rate to 0.0030769396130847556
Validation loss decreased (inf --> 0.4034).  Saving model state dict ...
Epoch: 1 cost time: 4.764794826507568
Epoch: 1, Steps: 1027 | Train Loss: 0.7329159 Vali Loss: 0.4033514 Best vali loss: 0.4033514
	iters: 100, epoch: 2 | loss: 1.4064007
	speed: 0.0118s/iter; left time: 83.6271s
	iters: 200, epoch: 2 | loss: 1.4641114
	speed: 0.0044s/iter; left time: 30.6042s
	iters: 300, epoch: 2 | loss: 0.4781305
	speed: 0.0043s/iter; left time: 29.7339s
	iters: 400, epoch: 2 | loss: 0.3029183
	speed: 0.0043s/iter; left time: 29.3333s
	iters: 500, epoch: 2 | loss: 1.1795640
	speed: 0.0043s/iter; left time: 28.8229s
	iters: 600, epoch: 2 | loss: 0.6304236
	speed: 0.0043s/iter; left time: 28.3499s
	iters: 700, epoch: 2 | loss: 0.4412117
	speed: 0.0043s/iter; left time: 28.1588s
	iters: 800, epoch: 2 | loss: 0.3764986
	speed: 0.0042s/iter; left time: 27.0881s
	iters: 900, epoch: 2 | loss: 0.3870089
	speed: 0.0043s/iter; left time: 27.1124s
	iters: 1000, epoch: 2 | loss: 0.9946498
	speed: 0.0043s/iter; left time: 26.8065s
Updating learning rate to 0.0027302460419348956
Epoch: 2 cost time: 4.4754626750946045
Epoch: 2, Steps: 1027 | Train Loss: 0.7660918 Vali Loss: 0.4131979 Best vali loss: 0.4033514
	iters: 100, epoch: 3 | loss: 0.3865510
	speed: 0.0112s/iter; left time: 67.6249s
	iters: 200, epoch: 3 | loss: 0.3221522
	speed: 0.0043s/iter; left time: 25.5507s
	iters: 300, epoch: 3 | loss: 0.9018551
	speed: 0.0043s/iter; left time: 25.1616s
	iters: 400, epoch: 3 | loss: 0.4776835
	speed: 0.0043s/iter; left time: 24.8210s
	iters: 500, epoch: 3 | loss: 1.0710522
	speed: 0.0043s/iter; left time: 24.4190s
	iters: 600, epoch: 3 | loss: 0.8061301
	speed: 0.0043s/iter; left time: 23.8478s
	iters: 700, epoch: 3 | loss: 0.8169257
	speed: 0.0043s/iter; left time: 23.5955s
	iters: 800, epoch: 3 | loss: 0.7818305
	speed: 0.0043s/iter; left time: 23.0166s
	iters: 900, epoch: 3 | loss: 0.2039926
	speed: 0.0043s/iter; left time: 22.5457s
	iters: 1000, epoch: 3 | loss: 0.3928541
	speed: 0.0043s/iter; left time: 21.9887s
Updating learning rate to 0.0022113824454729376
Epoch: 3 cost time: 4.444658517837524
Epoch: 3, Steps: 1027 | Train Loss: 0.6161027 Vali Loss: 0.4067909 Best vali loss: 0.4033514

best validation loss 0.40335138633349554

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020851625336, 'e_layers': 2, 'learning_rate': 0.000711264225, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000711264225
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 0.7559702396392822
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706314 Best vali loss: 0.3706314
Updating learning rate to 0.0003556321125
Validation loss decreased (0.3706 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 0.4474003314971924
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3642577 Best vali loss: 0.3642577
Updating learning rate to 0.00017781605625
Validation loss decreased (0.3643 --> 0.3566).  Saving model state dict ...
Epoch: 3 cost time: 0.4437105655670166
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3566279 Best vali loss: 0.3566279

best validation loss 0.3566279311662573

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0098275619414, 'e_layers': 3, 'learning_rate': 0.0006145058257, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006145058257
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 0.7358980178833008
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3734446 Best vali loss: 0.3734446
Updating learning rate to 0.00030725291285
Validation loss decreased (0.3734 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.4140317440032959
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3649587 Best vali loss: 0.3649587
Updating learning rate to 0.000153626456425
Epoch: 3 cost time: 0.4269680976867676
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3674455 Best vali loss: 0.3649587

best validation loss 0.364958698728464

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0020851625336, 'e_layers': 2, 'learning_rate': 0.000711264225, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.8908028125e-05
Validation loss decreased (0.3566 --> 0.3527).  Saving model state dict ...
Epoch: 4 cost time: 0.7494339942932129
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3526542 Best vali loss: 0.3526542
Updating learning rate to 4.44540140625e-05
Validation loss decreased (0.3527 --> 0.3473).  Saving model state dict ...
Epoch: 5 cost time: 0.44519639015197754
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3473340 Best vali loss: 0.3473340
Updating learning rate to 2.222700703125e-05
Validation loss decreased (0.3473 --> 0.3472).  Saving model state dict ...
Epoch: 6 cost time: 0.44788479804992676
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3472443 Best vali loss: 0.3472443
Updating learning rate to 1.1113503515625e-05
Epoch: 7 cost time: 0.4435398578643799
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3495096 Best vali loss: 0.3472443
Updating learning rate to 5.5567517578125e-06
Epoch: 8 cost time: 0.443218469619751
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3485036 Best vali loss: 0.3472443

best validation loss 0.34724425703931183

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022001918869, 'e_layers': 2, 'learning_rate': 0.0003779863227, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6121702
	speed: 0.0094s/iter; left time: 76.0184s
	iters: 200, epoch: 1 | loss: 0.9897127
	speed: 0.0030s/iter; left time: 24.2323s
	iters: 300, epoch: 1 | loss: 0.6354814
	speed: 0.0031s/iter; left time: 24.3777s
	iters: 400, epoch: 1 | loss: 0.4494968
	speed: 0.0031s/iter; left time: 24.2074s
	iters: 500, epoch: 1 | loss: 0.2847479
	speed: 0.0031s/iter; left time: 24.2948s
	iters: 600, epoch: 1 | loss: 0.3757401
	speed: 0.0031s/iter; left time: 23.8677s
	iters: 700, epoch: 1 | loss: 1.0061915
	speed: 0.0031s/iter; left time: 23.1690s
	iters: 800, epoch: 1 | loss: 0.9117701
	speed: 0.0031s/iter; left time: 23.1265s
	iters: 900, epoch: 1 | loss: 0.3447353
	speed: 0.0031s/iter; left time: 22.9792s
	iters: 1000, epoch: 1 | loss: 0.3407876
	speed: 0.0031s/iter; left time: 22.6373s
Updating learning rate to 0.0003779863227
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 3.5486931800842285
Epoch: 1, Steps: 1027 | Train Loss: 0.5950833 Vali Loss: 0.3694365 Best vali loss: 0.3694365
	iters: 100, epoch: 2 | loss: 1.1012005
	speed: 0.0092s/iter; left time: 65.4902s
	iters: 200, epoch: 2 | loss: 1.3266379
	speed: 0.0029s/iter; left time: 20.3508s
	iters: 300, epoch: 2 | loss: 1.2315912
	speed: 0.0029s/iter; left time: 19.9499s
	iters: 400, epoch: 2 | loss: 0.5366406
	speed: 0.0029s/iter; left time: 19.6485s
	iters: 500, epoch: 2 | loss: 0.5881618
	speed: 0.0029s/iter; left time: 19.3026s
	iters: 600, epoch: 2 | loss: 0.6096700
	speed: 0.0031s/iter; left time: 20.6769s
	iters: 700, epoch: 2 | loss: 1.1108224
	speed: 0.0032s/iter; left time: 20.5834s
	iters: 800, epoch: 2 | loss: 0.4509170
	speed: 0.0030s/iter; left time: 19.1748s
	iters: 900, epoch: 2 | loss: 0.8694713
	speed: 0.0029s/iter; left time: 18.1955s
	iters: 1000, epoch: 2 | loss: 0.6828870
	speed: 0.0029s/iter; left time: 18.1021s
Updating learning rate to 0.00018899316135
Validation loss decreased (0.3694 --> 0.3652).  Saving model state dict ...
Epoch: 2 cost time: 3.085641622543335
Epoch: 2, Steps: 1027 | Train Loss: 0.8508000 Vali Loss: 0.3651828 Best vali loss: 0.3651828
	iters: 100, epoch: 3 | loss: 1.0127321
	speed: 0.0095s/iter; left time: 57.4507s
	iters: 200, epoch: 3 | loss: 1.4429817
	speed: 0.0033s/iter; left time: 19.5545s
	iters: 300, epoch: 3 | loss: 1.1004467
	speed: 0.0033s/iter; left time: 19.3061s
	iters: 400, epoch: 3 | loss: 0.2178769
	speed: 0.0033s/iter; left time: 19.2169s
	iters: 500, epoch: 3 | loss: 0.2854724
	speed: 0.0033s/iter; left time: 18.7603s
	iters: 600, epoch: 3 | loss: 0.3658604
	speed: 0.0033s/iter; left time: 18.3488s
	iters: 700, epoch: 3 | loss: 0.9542831
	speed: 0.0033s/iter; left time: 18.1036s
	iters: 800, epoch: 3 | loss: 0.3958040
	speed: 0.0033s/iter; left time: 17.9473s
	iters: 900, epoch: 3 | loss: 0.3433734
	speed: 0.0033s/iter; left time: 17.3623s
	iters: 1000, epoch: 3 | loss: 0.4809492
	speed: 0.0033s/iter; left time: 17.1563s
Updating learning rate to 9.4496580675e-05
Epoch: 3 cost time: 3.426461696624756
Epoch: 3, Steps: 1027 | Train Loss: 0.6599780 Vali Loss: 0.3859519 Best vali loss: 0.3651828
	iters: 100, epoch: 4 | loss: 0.4597953
	speed: 0.0096s/iter; left time: 48.3981s
	iters: 200, epoch: 4 | loss: 0.4719138
	speed: 0.0034s/iter; left time: 16.7514s
	iters: 300, epoch: 4 | loss: 0.3249893
	speed: 0.0035s/iter; left time: 16.7007s
	iters: 400, epoch: 4 | loss: 0.4472679
	speed: 0.0034s/iter; left time: 16.1061s
	iters: 500, epoch: 4 | loss: 0.3189696
	speed: 0.0034s/iter; left time: 15.6468s
	iters: 600, epoch: 4 | loss: 0.3423627
	speed: 0.0032s/iter; left time: 14.5141s
	iters: 700, epoch: 4 | loss: 0.3199191
	speed: 0.0031s/iter; left time: 13.7598s
	iters: 800, epoch: 4 | loss: 0.3766586
	speed: 0.0031s/iter; left time: 13.2625s
	iters: 900, epoch: 4 | loss: 0.4110582
	speed: 0.0031s/iter; left time: 13.1585s
	iters: 1000, epoch: 4 | loss: 0.4410575
	speed: 0.0031s/iter; left time: 12.8891s
Updating learning rate to 4.72482903375e-05
Validation loss decreased (0.3652 --> 0.3560).  Saving model state dict ...
Epoch: 4 cost time: 3.3825623989105225
Epoch: 4, Steps: 1027 | Train Loss: 0.3913992 Vali Loss: 0.3560088 Best vali loss: 0.3560088
	iters: 100, epoch: 5 | loss: 0.2785613
	speed: 0.0096s/iter; left time: 38.5803s
	iters: 200, epoch: 5 | loss: 0.2612057
	speed: 0.0034s/iter; left time: 13.1082s
	iters: 300, epoch: 5 | loss: 0.2359444
	speed: 0.0034s/iter; left time: 12.7929s
	iters: 400, epoch: 5 | loss: 0.2851254
	speed: 0.0034s/iter; left time: 12.5643s
	iters: 500, epoch: 5 | loss: 0.7316539
	speed: 0.0034s/iter; left time: 12.2123s
	iters: 600, epoch: 5 | loss: 0.3208466
	speed: 0.0034s/iter; left time: 11.8895s
	iters: 700, epoch: 5 | loss: 0.6305699
	speed: 0.0033s/iter; left time: 11.3925s
	iters: 800, epoch: 5 | loss: 0.7526024
	speed: 0.0036s/iter; left time: 11.9096s
	iters: 900, epoch: 5 | loss: 0.4359721
	speed: 0.0035s/iter; left time: 11.0917s
	iters: 1000, epoch: 5 | loss: 0.2625285
	speed: 0.0034s/iter; left time: 10.4891s
Updating learning rate to 2.362414516875e-05
Epoch: 5 cost time: 3.528132200241089
Epoch: 5, Steps: 1027 | Train Loss: 0.4195010 Vali Loss: 0.3599639 Best vali loss: 0.3560088
	iters: 100, epoch: 6 | loss: 0.3802120
	speed: 0.0096s/iter; left time: 28.7148s
	iters: 200, epoch: 6 | loss: 0.4905012
	speed: 0.0034s/iter; left time: 9.6755s
	iters: 300, epoch: 6 | loss: 0.1955262
	speed: 0.0034s/iter; left time: 9.3888s
	iters: 400, epoch: 6 | loss: 0.5508609
	speed: 0.0034s/iter; left time: 9.1210s
	iters: 500, epoch: 6 | loss: 0.7497598
	speed: 0.0034s/iter; left time: 8.7934s
	iters: 600, epoch: 6 | loss: 0.4518995
	speed: 0.0035s/iter; left time: 8.6478s
	iters: 700, epoch: 6 | loss: 0.3915896
	speed: 0.0033s/iter; left time: 7.9720s
	iters: 800, epoch: 6 | loss: 0.8803046
	speed: 0.0034s/iter; left time: 7.8237s
	iters: 900, epoch: 6 | loss: 0.3781236
	speed: 0.0033s/iter; left time: 7.2958s
	iters: 1000, epoch: 6 | loss: 0.2589999
	speed: 0.0034s/iter; left time: 7.0504s
Updating learning rate to 1.1812072584375e-05
Epoch: 6 cost time: 3.5171003341674805
Epoch: 6, Steps: 1027 | Train Loss: 0.4727777 Vali Loss: 0.3619475 Best vali loss: 0.3560088
	iters: 100, epoch: 7 | loss: 0.3382152
	speed: 0.0095s/iter; left time: 18.6010s
	iters: 200, epoch: 7 | loss: 0.6568543
	speed: 0.0034s/iter; left time: 6.2332s
	iters: 300, epoch: 7 | loss: 0.3636352
	speed: 0.0033s/iter; left time: 5.8528s
	iters: 400, epoch: 7 | loss: 0.9174756
	speed: 0.0033s/iter; left time: 5.5276s
	iters: 500, epoch: 7 | loss: 0.4799559
	speed: 0.0034s/iter; left time: 5.2797s
	iters: 600, epoch: 7 | loss: 0.3546537
	speed: 0.0034s/iter; left time: 4.8844s
	iters: 700, epoch: 7 | loss: 0.7073374
	speed: 0.0034s/iter; left time: 4.5402s
	iters: 800, epoch: 7 | loss: 0.4130748
	speed: 0.0034s/iter; left time: 4.2177s
	iters: 900, epoch: 7 | loss: 1.1883827
	speed: 0.0034s/iter; left time: 3.8732s
	iters: 1000, epoch: 7 | loss: 0.4242681
	speed: 0.0034s/iter; left time: 3.5528s
Updating learning rate to 5.9060362921875e-06
Epoch: 7 cost time: 3.4881234169006348
Epoch: 7, Steps: 1027 | Train Loss: 0.5843853 Vali Loss: 0.3621513 Best vali loss: 0.3560088
	iters: 100, epoch: 8 | loss: 0.5128416
	speed: 0.0095s/iter; left time: 8.8314s
	iters: 200, epoch: 8 | loss: 0.6165656
	speed: 0.0034s/iter; left time: 2.7873s
	iters: 300, epoch: 8 | loss: 0.4349526
	speed: 0.0034s/iter; left time: 2.4898s
	iters: 400, epoch: 8 | loss: 0.6525019
	speed: 0.0034s/iter; left time: 2.1662s
	iters: 500, epoch: 8 | loss: 0.2219399
	speed: 0.0034s/iter; left time: 1.8119s
	iters: 600, epoch: 8 | loss: 0.2007264
	speed: 0.0034s/iter; left time: 1.4587s
	iters: 700, epoch: 8 | loss: 0.7777534
	speed: 0.0034s/iter; left time: 1.1257s
	iters: 800, epoch: 8 | loss: 0.2504076
	speed: 0.0034s/iter; left time: 0.7725s
	iters: 900, epoch: 8 | loss: 0.2376119
	speed: 0.0034s/iter; left time: 0.4307s
	iters: 1000, epoch: 8 | loss: 0.2890021
	speed: 0.0034s/iter; left time: 0.0942s
Updating learning rate to 2.95301814609375e-06
Epoch: 8 cost time: 3.5360214710235596
Epoch: 8, Steps: 1027 | Train Loss: 0.4194303 Vali Loss: 0.3604693 Best vali loss: 0.3560088

best validation loss 0.3560088155253229

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0016784174419, 'e_layers': 2, 'learning_rate': 0.0033280107028, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0033280107028
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 0.6619405746459961
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706528 Best vali loss: 0.3706528
Updating learning rate to 0.0016640053514
Epoch: 2 cost time: 0.35278892517089844
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3739482 Best vali loss: 0.3706528
Updating learning rate to 0.0008320026757
Epoch: 3 cost time: 0.3538076877593994
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4019006 Best vali loss: 0.3706528
Updating learning rate to 0.00041600133785
Epoch: 4 cost time: 0.36110806465148926
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3882860 Best vali loss: 0.3706528
Updating learning rate to 0.000208000668925
Epoch: 5 cost time: 0.35312342643737793
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3964484 Best vali loss: 0.3706528
Updating learning rate to 0.0001040003344625
Epoch: 6 cost time: 0.3451530933380127
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3997389 Best vali loss: 0.3706528
Updating learning rate to 5.200016723125e-05
Epoch: 7 cost time: 0.3507347106933594
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3992245 Best vali loss: 0.3706528
Updating learning rate to 2.6000083615625e-05
Epoch: 8 cost time: 0.34754347801208496
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3989164 Best vali loss: 0.3706528

best validation loss 0.37065278322148654

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0012155045426, 'e_layers': 2, 'learning_rate': 0.0006996821348, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5312855
	speed: 0.0103s/iter; left time: 20.0684s
	iters: 200, epoch: 1 | loss: 0.6675109
	speed: 0.0038s/iter; left time: 6.9669s
Updating learning rate to 0.0006996821348
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 1.342219591140747
Epoch: 1, Steps: 257 | Train Loss: 0.5993982 Vali Loss: 0.3739463 Best vali loss: 0.3739463
	iters: 100, epoch: 2 | loss: 0.4676741
	speed: 0.0087s/iter; left time: 14.7354s
	iters: 200, epoch: 2 | loss: 0.7102053
	speed: 0.0038s/iter; left time: 6.0745s
Updating learning rate to 0.0003498410674
Epoch: 2 cost time: 1.0310885906219482
Epoch: 2, Steps: 257 | Train Loss: 0.5889397 Vali Loss: 0.3769062 Best vali loss: 0.3739463
	iters: 100, epoch: 3 | loss: 0.8143580
	speed: 0.0087s/iter; left time: 12.5955s
	iters: 200, epoch: 3 | loss: 0.7630507
	speed: 0.0038s/iter; left time: 5.0855s
Updating learning rate to 0.0001749205337
Epoch: 3 cost time: 1.0251197814941406
Epoch: 3, Steps: 257 | Train Loss: 0.7887044 Vali Loss: 0.3913622 Best vali loss: 0.3739463

best validation loss 0.373946328323576

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0023027050378, 'e_layers': 4, 'learning_rate': 0.0006973259918, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006707856015560767
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 1.1021919250488281
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701538 Best vali loss: 0.3701538
Updating learning rate to 0.0005952049646497074
Epoch: 2 cost time: 0.7819712162017822
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3827988 Best vali loss: 0.3701538
Updating learning rate to 0.00048209054790970726
Validation loss decreased (0.3702 --> 0.3578).  Saving model state dict ...
Epoch: 3 cost time: 0.7785496711730957
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3577680 Best vali loss: 0.3577680

best validation loss 0.35776803759320075

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010585547403, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5544431
	speed: 0.0119s/iter; left time: 23.1945s
	iters: 200, epoch: 1 | loss: 0.6083090
	speed: 0.0057s/iter; left time: 10.5024s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 1.8029215335845947
Epoch: 1, Steps: 257 | Train Loss: 0.5813760 Vali Loss: 0.3664941 Best vali loss: 0.3664941
	iters: 100, epoch: 2 | loss: 0.7574253
	speed: 0.0118s/iter; left time: 20.1158s
	iters: 200, epoch: 2 | loss: 0.5579838
	speed: 0.0053s/iter; left time: 8.5330s
Updating learning rate to 0.0001652515671
Epoch: 2 cost time: 1.4289300441741943
Epoch: 2, Steps: 257 | Train Loss: 0.6577046 Vali Loss: 0.3815310 Best vali loss: 0.3664941
	iters: 100, epoch: 3 | loss: 0.4960916
	speed: 0.0113s/iter; left time: 16.3309s
	iters: 200, epoch: 3 | loss: 0.4598461
	speed: 0.0054s/iter; left time: 7.1910s
Updating learning rate to 8.262578355e-05
Validation loss decreased (0.3665 --> 0.3556).  Saving model state dict ...
Epoch: 3 cost time: 1.414318323135376
Epoch: 3, Steps: 257 | Train Loss: 0.4779689 Vali Loss: 0.3555863 Best vali loss: 0.3555863

best validation loss 0.3555862878652359

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010585547403, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5140523
	speed: 0.0122s/iter; left time: 14.4208s
	iters: 200, epoch: 4 | loss: 0.4451514
	speed: 0.0054s/iter; left time: 5.8653s
Updating learning rate to 4.1312891775e-05
Validation loss decreased (0.3556 --> 0.3429).  Saving model state dict ...
Epoch: 4 cost time: 1.7492854595184326
Epoch: 4, Steps: 257 | Train Loss: 0.4796018 Vali Loss: 0.3428510 Best vali loss: 0.3428510
	iters: 100, epoch: 5 | loss: 0.4799190
	speed: 0.0119s/iter; left time: 11.0805s
	iters: 200, epoch: 5 | loss: 0.4097017
	speed: 0.0052s/iter; left time: 4.3312s
Updating learning rate to 2.06564458875e-05
Epoch: 5 cost time: 1.412334680557251
Epoch: 5, Steps: 257 | Train Loss: 0.4448103 Vali Loss: 0.3440616 Best vali loss: 0.3428510
	iters: 100, epoch: 6 | loss: 0.4571568
	speed: 0.0114s/iter; left time: 7.6536s
	iters: 200, epoch: 6 | loss: 0.3915303
	speed: 0.0056s/iter; left time: 3.2262s
Updating learning rate to 1.032822294375e-05
Validation loss decreased (0.3429 --> 0.3426).  Saving model state dict ...
Epoch: 6 cost time: 1.4770758152008057
Epoch: 6, Steps: 257 | Train Loss: 0.4243436 Vali Loss: 0.3426294 Best vali loss: 0.3426294
	iters: 100, epoch: 7 | loss: 0.4891560
	speed: 0.0119s/iter; left time: 4.9246s
	iters: 200, epoch: 7 | loss: 0.3339988
	speed: 0.0052s/iter; left time: 1.6322s
Updating learning rate to 5.164111471875e-06
Epoch: 7 cost time: 1.4040141105651855
Epoch: 7, Steps: 257 | Train Loss: 0.4115774 Vali Loss: 0.3457910 Best vali loss: 0.3426294
	iters: 100, epoch: 8 | loss: 0.6082405
	speed: 0.0116s/iter; left time: 1.8364s
	iters: 200, epoch: 8 | loss: 0.3927784
	speed: 0.0053s/iter; left time: 0.3101s
Updating learning rate to 2.5820557359375e-06
Epoch: 8 cost time: 1.4199440479278564
Epoch: 8, Steps: 257 | Train Loss: 0.5005095 Vali Loss: 0.3457323 Best vali loss: 0.3426294

best validation loss 0.3426293892804204

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0045698746399, 'e_layers': 4, 'learning_rate': 0.0005997961272, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4833031
	speed: 0.0115s/iter; left time: 46.2088s
	iters: 200, epoch: 1 | loss: 0.4447223
	speed: 0.0051s/iter; left time: 19.8502s
	iters: 300, epoch: 1 | loss: 1.3288612
	speed: 0.0050s/iter; left time: 19.0585s
	iters: 400, epoch: 1 | loss: 0.5553727
	speed: 0.0050s/iter; left time: 18.5621s
	iters: 500, epoch: 1 | loss: 0.7087718
	speed: 0.0050s/iter; left time: 18.1853s
Updating learning rate to 0.0005997961272
Validation loss decreased (inf --> 0.3995).  Saving model state dict ...
Epoch: 1 cost time: 2.948707342147827
Epoch: 1, Steps: 514 | Train Loss: 0.7042062 Vali Loss: 0.3994509 Best vali loss: 0.3994509
	iters: 100, epoch: 2 | loss: 0.9194638
	speed: 0.0098s/iter; left time: 34.2639s
	iters: 200, epoch: 2 | loss: 0.8306493
	speed: 0.0049s/iter; left time: 16.5149s
	iters: 300, epoch: 2 | loss: 1.1136483
	speed: 0.0048s/iter; left time: 15.9788s
	iters: 400, epoch: 2 | loss: 0.4422284
	speed: 0.0048s/iter; left time: 15.4864s
	iters: 500, epoch: 2 | loss: 0.4009026
	speed: 0.0048s/iter; left time: 14.9600s
Updating learning rate to 0.0002998980636
Epoch: 2 cost time: 2.5214552879333496
Epoch: 2, Steps: 514 | Train Loss: 0.7413785 Vali Loss: 0.4028322 Best vali loss: 0.3994509
	iters: 100, epoch: 3 | loss: 0.5326238
	speed: 0.0098s/iter; left time: 29.3567s
	iters: 200, epoch: 3 | loss: 0.6270337
	speed: 0.0048s/iter; left time: 13.8057s
	iters: 300, epoch: 3 | loss: 0.2803560
	speed: 0.0046s/iter; left time: 12.8592s
	iters: 400, epoch: 3 | loss: 0.3029732
	speed: 0.0048s/iter; left time: 12.9826s
	iters: 500, epoch: 3 | loss: 1.2981738
	speed: 0.0050s/iter; left time: 12.9099s
Updating learning rate to 0.0001499490318
Epoch: 3 cost time: 2.5335240364074707
Epoch: 3, Steps: 514 | Train Loss: 0.6082321 Vali Loss: 0.4011043 Best vali loss: 0.3994509
	iters: 100, epoch: 4 | loss: 0.3443128
	speed: 0.0095s/iter; left time: 23.3876s
	iters: 200, epoch: 4 | loss: 0.9349550
	speed: 0.0047s/iter; left time: 11.2490s
	iters: 300, epoch: 4 | loss: 0.6562123
	speed: 0.0048s/iter; left time: 10.7967s
	iters: 400, epoch: 4 | loss: 0.7190898
	speed: 0.0050s/iter; left time: 10.8156s
	iters: 500, epoch: 4 | loss: 0.8256900
	speed: 0.0053s/iter; left time: 10.9680s
Updating learning rate to 7.49745159e-05
Epoch: 4 cost time: 2.5633578300476074
Epoch: 4, Steps: 514 | Train Loss: 0.6960520 Vali Loss: 0.4070408 Best vali loss: 0.3994509
	iters: 100, epoch: 5 | loss: 0.3897914
	speed: 0.0102s/iter; left time: 19.9283s
	iters: 200, epoch: 5 | loss: 0.4386451
	speed: 0.0051s/iter; left time: 9.5022s
	iters: 300, epoch: 5 | loss: 0.5253870
	speed: 0.0051s/iter; left time: 8.9927s
	iters: 400, epoch: 5 | loss: 0.5688741
	speed: 0.0052s/iter; left time: 8.5550s
	iters: 500, epoch: 5 | loss: 1.1584781
	speed: 0.0052s/iter; left time: 8.0662s
Updating learning rate to 3.748725795e-05
Epoch: 5 cost time: 2.696392774581909
Epoch: 5, Steps: 514 | Train Loss: 0.6162351 Vali Loss: 0.4045623 Best vali loss: 0.3994509
	iters: 100, epoch: 6 | loss: 0.8636849
	speed: 0.0101s/iter; left time: 14.6043s
	iters: 200, epoch: 6 | loss: 0.7583895
	speed: 0.0047s/iter; left time: 6.3272s
	iters: 300, epoch: 6 | loss: 0.7663841
	speed: 0.0046s/iter; left time: 5.7358s
	iters: 400, epoch: 6 | loss: 1.0771384
	speed: 0.0044s/iter; left time: 5.0248s
	iters: 500, epoch: 6 | loss: 1.0474766
	speed: 0.0046s/iter; left time: 4.8223s
Updating learning rate to 1.8743628975e-05
Epoch: 6 cost time: 2.4505574703216553
Epoch: 6, Steps: 514 | Train Loss: 0.9026147 Vali Loss: 0.4043751 Best vali loss: 0.3994509
	iters: 100, epoch: 7 | loss: 0.9521480
	speed: 0.0100s/iter; left time: 9.2946s
	iters: 200, epoch: 7 | loss: 0.3597616
	speed: 0.0051s/iter; left time: 4.2381s
	iters: 300, epoch: 7 | loss: 0.5647085
	speed: 0.0051s/iter; left time: 3.7190s
	iters: 400, epoch: 7 | loss: 0.5275303
	speed: 0.0050s/iter; left time: 3.1691s
	iters: 500, epoch: 7 | loss: 1.4341782
	speed: 0.0052s/iter; left time: 2.7613s
Updating learning rate to 9.3718144875e-06
Epoch: 7 cost time: 2.681617021560669
Epoch: 7, Steps: 514 | Train Loss: 0.7676653 Vali Loss: 0.4031071 Best vali loss: 0.3994509
	iters: 100, epoch: 8 | loss: 1.2666216
	speed: 0.0099s/iter; left time: 4.1049s
	iters: 200, epoch: 8 | loss: 1.0516876
	speed: 0.0051s/iter; left time: 1.6208s
	iters: 300, epoch: 8 | loss: 0.4063765
	speed: 0.0050s/iter; left time: 1.0841s
	iters: 400, epoch: 8 | loss: 0.5283884
	speed: 0.0051s/iter; left time: 0.5842s
	iters: 500, epoch: 8 | loss: 0.3794289
	speed: 0.0051s/iter; left time: 0.0760s
Updating learning rate to 4.68590724375e-06
Epoch: 8 cost time: 2.6582844257354736
Epoch: 8, Steps: 514 | Train Loss: 0.7265006 Vali Loss: 0.4034082 Best vali loss: 0.3994509

best validation loss 0.39945093768636

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022932361561, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3667).  Saving model state dict ...
Epoch: 1 cost time: 1.1024608612060547
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3667241 Best vali loss: 0.3667241
Updating learning rate to 0.0006034837636086699
Validation loss decreased (0.3667 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 0.7811260223388672
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3646540 Best vali loss: 0.3646540
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3647 --> 0.3615).  Saving model state dict ...
Epoch: 3 cost time: 0.7942326068878174
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3614928 Best vali loss: 0.3614928
Updating learning rate to 0.00035351260405
Epoch: 4 cost time: 0.7919881343841553
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3665336 Best vali loss: 0.3614928
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3615 --> 0.3464).  Saving model state dict ...
Epoch: 5 cost time: 0.7827534675598145
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3464048 Best vali loss: 0.3464048
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3464 --> 0.3378).  Saving model state dict ...
Epoch: 6 cost time: 0.7886359691619873
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3378312 Best vali loss: 0.3378312
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.7899303436279297
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3470179 Best vali loss: 0.3378312
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7879869937896729
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3521481 Best vali loss: 0.3378312

best validation loss 0.33783124432348316

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0064202883262, 'e_layers': 1, 'learning_rate': 0.000215260554, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3685609
	speed: 0.0087s/iter; left time: 70.5270s
	iters: 200, epoch: 1 | loss: 0.4971050
	speed: 0.0023s/iter; left time: 18.3435s
	iters: 300, epoch: 1 | loss: 1.2554296
	speed: 0.0023s/iter; left time: 18.1099s
	iters: 400, epoch: 1 | loss: 1.0547603
	speed: 0.0022s/iter; left time: 17.5695s
	iters: 500, epoch: 1 | loss: 0.3898193
	speed: 0.0024s/iter; left time: 18.8035s
	iters: 600, epoch: 1 | loss: 0.2914208
	speed: 0.0024s/iter; left time: 18.4646s
	iters: 700, epoch: 1 | loss: 0.4339204
	speed: 0.0025s/iter; left time: 18.5245s
	iters: 800, epoch: 1 | loss: 0.3227620
	speed: 0.0024s/iter; left time: 17.9833s
	iters: 900, epoch: 1 | loss: 0.3640981
	speed: 0.0023s/iter; left time: 17.0152s
	iters: 1000, epoch: 1 | loss: 0.1972098
	speed: 0.0023s/iter; left time: 16.6458s
Updating learning rate to 0.00020706768699882031
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 2.771169424057007
Epoch: 1, Steps: 1027 | Train Loss: 0.5175086 Vali Loss: 0.3671317 Best vali loss: 0.3671317
	iters: 100, epoch: 2 | loss: 1.5545423
	speed: 0.0075s/iter; left time: 53.4701s
	iters: 200, epoch: 2 | loss: 0.2447861
	speed: 0.0021s/iter; left time: 14.4035s
	iters: 300, epoch: 2 | loss: 0.2808970
	speed: 0.0021s/iter; left time: 14.3886s
	iters: 400, epoch: 2 | loss: 0.2483788
	speed: 0.0021s/iter; left time: 14.0761s
	iters: 500, epoch: 2 | loss: 0.6570973
	speed: 0.0020s/iter; left time: 13.6595s
	iters: 600, epoch: 2 | loss: 0.6748461
	speed: 0.0021s/iter; left time: 13.5370s
	iters: 700, epoch: 2 | loss: 0.6157868
	speed: 0.0020s/iter; left time: 13.2127s
	iters: 800, epoch: 2 | loss: 0.7267932
	speed: 0.0020s/iter; left time: 13.0586s
	iters: 900, epoch: 2 | loss: 0.3044129
	speed: 0.0020s/iter; left time: 12.8340s
	iters: 1000, epoch: 2 | loss: 0.2222510
	speed: 0.0020s/iter; left time: 12.6473s
Updating learning rate to 0.0001837363757276865
Epoch: 2 cost time: 2.1512365341186523
Epoch: 2, Steps: 1027 | Train Loss: 0.5529791 Vali Loss: 0.3742188 Best vali loss: 0.3671317
	iters: 100, epoch: 3 | loss: 0.2422203
	speed: 0.0069s/iter; left time: 42.1377s
	iters: 200, epoch: 3 | loss: 0.3737027
	speed: 0.0021s/iter; left time: 12.3064s
	iters: 300, epoch: 3 | loss: 0.9260640
	speed: 0.0021s/iter; left time: 12.4710s
	iters: 400, epoch: 3 | loss: 0.2117114
	speed: 0.0023s/iter; left time: 13.2667s
	iters: 500, epoch: 3 | loss: 0.4436963
	speed: 0.0023s/iter; left time: 12.8937s
	iters: 600, epoch: 3 | loss: 1.4853476
	speed: 0.0023s/iter; left time: 12.6820s
	iters: 700, epoch: 3 | loss: 1.1660001
	speed: 0.0023s/iter; left time: 12.4383s
	iters: 800, epoch: 3 | loss: 0.6012853
	speed: 0.0022s/iter; left time: 12.0232s
	iters: 900, epoch: 3 | loss: 0.3608074
	speed: 0.0020s/iter; left time: 10.6324s
	iters: 1000, epoch: 3 | loss: 0.6947407
	speed: 0.0022s/iter; left time: 11.3479s
Updating learning rate to 0.0001488186008287654
Epoch: 3 cost time: 2.2769217491149902
Epoch: 3, Steps: 1027 | Train Loss: 0.6505576 Vali Loss: 0.3827977 Best vali loss: 0.3671317

best validation loss 0.367131728759449

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0065550829552, 'e_layers': 1, 'learning_rate': 0.0002265674892, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3670848
	speed: 0.0085s/iter; left time: 69.2386s
	iters: 200, epoch: 1 | loss: 0.4982079
	speed: 0.0024s/iter; left time: 18.9691s
	iters: 300, epoch: 1 | loss: 1.2527227
	speed: 0.0024s/iter; left time: 18.8440s
	iters: 400, epoch: 1 | loss: 1.0535530
	speed: 0.0024s/iter; left time: 18.8643s
	iters: 500, epoch: 1 | loss: 0.3908685
	speed: 0.0025s/iter; left time: 18.9985s
	iters: 600, epoch: 1 | loss: 0.2942109
	speed: 0.0023s/iter; left time: 17.8818s
	iters: 700, epoch: 1 | loss: 0.4366939
	speed: 0.0024s/iter; left time: 17.8279s
	iters: 800, epoch: 1 | loss: 0.3270088
	speed: 0.0023s/iter; left time: 17.2663s
	iters: 900, epoch: 1 | loss: 0.3727829
	speed: 0.0023s/iter; left time: 17.0333s
	iters: 1000, epoch: 1 | loss: 0.1987356
	speed: 0.0023s/iter; left time: 16.9065s
Updating learning rate to 0.000217944277602176
Validation loss decreased (inf --> 0.3679).  Saving model state dict ...
Epoch: 1 cost time: 2.781980514526367
Epoch: 1, Steps: 1027 | Train Loss: 0.5191869 Vali Loss: 0.3679386 Best vali loss: 0.3679386
	iters: 100, epoch: 2 | loss: 1.5586668
	speed: 0.0076s/iter; left time: 53.5533s
	iters: 200, epoch: 2 | loss: 0.2439951
	speed: 0.0023s/iter; left time: 16.3184s
	iters: 300, epoch: 2 | loss: 0.2957667
	speed: 0.0024s/iter; left time: 16.3750s
	iters: 400, epoch: 2 | loss: 0.2477914
	speed: 0.0024s/iter; left time: 16.1375s
	iters: 500, epoch: 2 | loss: 0.5729346
	speed: 0.0023s/iter; left time: 15.6653s
	iters: 600, epoch: 2 | loss: 0.6594108
	speed: 0.0024s/iter; left time: 15.6389s
	iters: 700, epoch: 2 | loss: 0.6702880
	speed: 0.0024s/iter; left time: 15.5872s
	iters: 800, epoch: 2 | loss: 0.7228091
	speed: 0.0023s/iter; left time: 14.5348s
	iters: 900, epoch: 2 | loss: 0.3073660
	speed: 0.0022s/iter; left time: 13.7818s
	iters: 1000, epoch: 2 | loss: 0.2196641
	speed: 0.0022s/iter; left time: 13.9130s
Updating learning rate to 0.00019338744860486492
Epoch: 2 cost time: 2.4319732189178467
Epoch: 2, Steps: 1027 | Train Loss: 0.5498693 Vali Loss: 0.3838271 Best vali loss: 0.3679386
	iters: 100, epoch: 3 | loss: 0.2381770
	speed: 0.0074s/iter; left time: 44.8714s
	iters: 200, epoch: 3 | loss: 0.3545617
	speed: 0.0022s/iter; left time: 13.1441s
	iters: 300, epoch: 3 | loss: 0.9088094
	speed: 0.0024s/iter; left time: 14.0603s
	iters: 400, epoch: 3 | loss: 0.2095478
	speed: 0.0024s/iter; left time: 14.0205s
	iters: 500, epoch: 3 | loss: 0.4551193
	speed: 0.0024s/iter; left time: 13.5451s
	iters: 600, epoch: 3 | loss: 1.5114168
	speed: 0.0024s/iter; left time: 13.4222s
	iters: 700, epoch: 3 | loss: 1.3843031
	speed: 0.0024s/iter; left time: 12.9325s
	iters: 800, epoch: 3 | loss: 0.6131580
	speed: 0.0024s/iter; left time: 13.0345s
	iters: 900, epoch: 3 | loss: 0.3927201
	speed: 0.0024s/iter; left time: 12.7465s
	iters: 1000, epoch: 3 | loss: 0.7067543
	speed: 0.0024s/iter; left time: 12.6239s
Updating learning rate to 0.0001566355568146982
Epoch: 3 cost time: 2.479607582092285
Epoch: 3, Steps: 1027 | Train Loss: 0.6774567 Vali Loss: 0.3922834 Best vali loss: 0.3679386

best validation loss 0.36793861068302147

[INFO][smbo.py:320] Finished 1400 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0014976277229, 'e_layers': 2, 'learning_rate': 0.0014646198093, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6186954
	speed: 0.0104s/iter; left time: 9.6941s
Updating learning rate to 0.001408876037011427
Validation loss decreased (inf --> 0.3847).  Saving model state dict ...
Epoch: 1 cost time: 0.8863563537597656
Epoch: 1, Steps: 129 | Train Loss: 0.6186954 Vali Loss: 0.3847009 Best vali loss: 0.3847009
	iters: 100, epoch: 2 | loss: 0.7533299
	speed: 0.0071s/iter; left time: 5.7273s
Updating learning rate to 0.001250131204158089
Validation loss decreased (0.3847 --> 0.3844).  Saving model state dict ...
Epoch: 2 cost time: 0.5623691082000732
Epoch: 2, Steps: 129 | Train Loss: 0.7533299 Vali Loss: 0.3843640 Best vali loss: 0.3843640
	iters: 100, epoch: 3 | loss: 0.4350695
	speed: 0.0075s/iter; left time: 5.0347s
Updating learning rate to 0.0010125527725164136
Validation loss decreased (0.3844 --> 0.3814).  Saving model state dict ...
Epoch: 3 cost time: 0.5821259021759033
Epoch: 3, Steps: 129 | Train Loss: 0.4350695 Vali Loss: 0.3813909 Best vali loss: 0.3813909

best validation loss 0.3813909398783401

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0064202883262, 'e_layers': 1, 'learning_rate': 0.000215260554, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2984748
	speed: 0.0090s/iter; left time: 45.1525s
	iters: 200, epoch: 4 | loss: 0.3645683
	speed: 0.0024s/iter; left time: 11.9701s
	iters: 300, epoch: 4 | loss: 0.6720904
	speed: 0.0025s/iter; left time: 11.8564s
	iters: 400, epoch: 4 | loss: 0.9397765
	speed: 0.0025s/iter; left time: 11.6445s
	iters: 500, epoch: 4 | loss: 0.3629111
	speed: 0.0024s/iter; left time: 11.2994s
	iters: 600, epoch: 4 | loss: 0.2404720
	speed: 0.0024s/iter; left time: 11.0751s
	iters: 700, epoch: 4 | loss: 0.3450442
	speed: 0.0023s/iter; left time: 10.2288s
	iters: 800, epoch: 4 | loss: 0.2224883
	speed: 0.0024s/iter; left time: 10.3175s
	iters: 900, epoch: 4 | loss: 0.2961668
	speed: 0.0024s/iter; left time: 10.1023s
	iters: 1000, epoch: 4 | loss: 0.1767581
	speed: 0.0024s/iter; left time: 9.9334s
Updating learning rate to 0.000107630277
Epoch: 4 cost time: 2.8287248611450195
Epoch: 4, Steps: 1027 | Train Loss: 0.3918751 Vali Loss: 0.4074645 Best vali loss: 0.3671317
	iters: 100, epoch: 5 | loss: 1.2298058
	speed: 0.0072s/iter; left time: 28.9388s
	iters: 200, epoch: 5 | loss: 0.1608109
	speed: 0.0020s/iter; left time: 8.0005s
	iters: 300, epoch: 5 | loss: 0.2431124
	speed: 0.0021s/iter; left time: 7.8959s
	iters: 400, epoch: 5 | loss: 0.2614266
	speed: 0.0021s/iter; left time: 7.6424s
	iters: 500, epoch: 5 | loss: 0.4157621
	speed: 0.0020s/iter; left time: 7.2185s
	iters: 600, epoch: 5 | loss: 0.5367596
	speed: 0.0020s/iter; left time: 7.0116s
	iters: 700, epoch: 5 | loss: 0.4759231
	speed: 0.0020s/iter; left time: 6.8606s
	iters: 800, epoch: 5 | loss: 0.6913578
	speed: 0.0020s/iter; left time: 6.6423s
	iters: 900, epoch: 5 | loss: 0.2532003
	speed: 0.0020s/iter; left time: 6.4183s
	iters: 1000, epoch: 5 | loss: 0.2011327
	speed: 0.0020s/iter; left time: 6.2228s
Updating learning rate to 6.644195317123463e-05
Epoch: 5 cost time: 2.114989757537842
Epoch: 5, Steps: 1027 | Train Loss: 0.4469291 Vali Loss: 0.3991487 Best vali loss: 0.3671317
	iters: 100, epoch: 6 | loss: 0.2277425
	speed: 0.0070s/iter; left time: 20.8888s
	iters: 200, epoch: 6 | loss: 0.2218316
	speed: 0.0021s/iter; left time: 5.9934s
	iters: 300, epoch: 6 | loss: 0.6896714
	speed: 0.0022s/iter; left time: 6.1005s
	iters: 400, epoch: 6 | loss: 0.1977321
	speed: 0.0021s/iter; left time: 5.5817s
	iters: 500, epoch: 6 | loss: 0.3372720
	speed: 0.0021s/iter; left time: 5.3946s
	iters: 600, epoch: 6 | loss: 1.1169199
	speed: 0.0021s/iter; left time: 5.0936s
	iters: 700, epoch: 6 | loss: 0.9863857
	speed: 0.0021s/iter; left time: 4.9081s
	iters: 800, epoch: 6 | loss: 0.5114771
	speed: 0.0021s/iter; left time: 4.7461s
	iters: 900, epoch: 6 | loss: 0.3037056
	speed: 0.0021s/iter; left time: 4.5967s
	iters: 1000, epoch: 6 | loss: 0.5845203
	speed: 0.0021s/iter; left time: 4.4026s
Updating learning rate to 3.152417827231351e-05
Epoch: 6 cost time: 2.1899635791778564
Epoch: 6, Steps: 1027 | Train Loss: 0.5177258 Vali Loss: 0.4000512 Best vali loss: 0.3671317
	iters: 100, epoch: 7 | loss: 0.2817837
	speed: 0.0073s/iter; left time: 14.3349s
	iters: 200, epoch: 7 | loss: 0.3610688
	speed: 0.0021s/iter; left time: 3.8312s
	iters: 300, epoch: 7 | loss: 0.6530100
	speed: 0.0020s/iter; left time: 3.5775s
	iters: 400, epoch: 7 | loss: 0.2063281
	speed: 0.0020s/iter; left time: 3.3782s
	iters: 500, epoch: 7 | loss: 0.2730702
	speed: 0.0021s/iter; left time: 3.1990s
	iters: 600, epoch: 7 | loss: 0.2914718
	speed: 0.0021s/iter; left time: 3.0002s
	iters: 700, epoch: 7 | loss: 1.0170733
	speed: 0.0020s/iter; left time: 2.7428s
	iters: 800, epoch: 7 | loss: 0.4795357
	speed: 0.0021s/iter; left time: 2.5792s
	iters: 900, epoch: 7 | loss: 0.3820450
	speed: 0.0020s/iter; left time: 2.3462s
	iters: 1000, epoch: 7 | loss: 0.2155798
	speed: 0.0020s/iter; left time: 2.1444s
Updating learning rate to 8.192867001179702e-06
Epoch: 7 cost time: 2.1406757831573486
Epoch: 7, Steps: 1027 | Train Loss: 0.4160966 Vali Loss: 0.4018537 Best vali loss: 0.3671317
	iters: 100, epoch: 8 | loss: 0.8854774
	speed: 0.0072s/iter; left time: 6.6799s
	iters: 200, epoch: 8 | loss: 0.4044877
	speed: 0.0022s/iter; left time: 1.7965s
	iters: 300, epoch: 8 | loss: 0.3272860
	speed: 0.0022s/iter; left time: 1.5940s
	iters: 400, epoch: 8 | loss: 0.5207866
	speed: 0.0022s/iter; left time: 1.3559s
	iters: 500, epoch: 8 | loss: 0.7565025
	speed: 0.0022s/iter; left time: 1.1426s
	iters: 600, epoch: 8 | loss: 0.3969145
	speed: 0.0020s/iter; left time: 0.8704s
	iters: 700, epoch: 8 | loss: 0.3454488
	speed: 0.0020s/iter; left time: 0.6642s
	iters: 800, epoch: 8 | loss: 0.7963401
	speed: 0.0020s/iter; left time: 0.4620s
	iters: 900, epoch: 8 | loss: 0.1470734
	speed: 0.0020s/iter; left time: 0.2589s
	iters: 1000, epoch: 8 | loss: 0.3114013
	speed: 0.0021s/iter; left time: 0.0579s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.194532871246338
Epoch: 8, Steps: 1027 | Train Loss: 0.4891718 Vali Loss: 0.4029521 Best vali loss: 0.3671317

best validation loss 0.367131728759449

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0079867628768, 'e_layers': 4, 'learning_rate': 0.0029558818722, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0029558818722
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 0.7850205898284912
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3708873 Best vali loss: 0.3708873
Updating learning rate to 0.0014779409361
Epoch: 2 cost time: 0.41860151290893555
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3757730 Best vali loss: 0.3708873
Updating learning rate to 0.00073897046805
Validation loss decreased (0.3709 --> 0.3683).  Saving model state dict ...
Epoch: 3 cost time: 0.4054741859436035
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3683127 Best vali loss: 0.3683127
Updating learning rate to 0.000369485234025
Epoch: 4 cost time: 0.42842769622802734
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3737262 Best vali loss: 0.3683127
Updating learning rate to 0.0001847426170125
Epoch: 5 cost time: 0.42364954948425293
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3728958 Best vali loss: 0.3683127
Updating learning rate to 9.237130850625e-05
Epoch: 6 cost time: 0.4440019130706787
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3747896 Best vali loss: 0.3683127
Updating learning rate to 4.6185654253125e-05
Epoch: 7 cost time: 0.5106871128082275
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3733729 Best vali loss: 0.3683127
Updating learning rate to 2.30928271265625e-05
Epoch: 8 cost time: 0.4660923480987549
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3750079 Best vali loss: 0.3683127

best validation loss 0.3683127421995511

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004249391497, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4276932
	speed: 0.0096s/iter; left time: 38.4847s
	iters: 200, epoch: 1 | loss: 1.0793427
	speed: 0.0035s/iter; left time: 13.7368s
	iters: 300, epoch: 1 | loss: 1.0128924
	speed: 0.0037s/iter; left time: 14.0231s
	iters: 400, epoch: 1 | loss: 0.5035704
	speed: 0.0035s/iter; left time: 13.0079s
	iters: 500, epoch: 1 | loss: 1.1942575
	speed: 0.0032s/iter; left time: 11.5513s
Updating learning rate to 0.00040876586633528986
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 2.1337108612060547
Epoch: 1, Steps: 514 | Train Loss: 0.8435512 Vali Loss: 0.3715281 Best vali loss: 0.3715281
	iters: 100, epoch: 2 | loss: 0.3960979
	speed: 0.0072s/iter; left time: 25.3254s
	iters: 200, epoch: 2 | loss: 0.2543807
	speed: 0.0033s/iter; left time: 11.0918s
	iters: 300, epoch: 2 | loss: 0.4899685
	speed: 0.0032s/iter; left time: 10.7005s
	iters: 400, epoch: 2 | loss: 0.3809090
	speed: 0.0033s/iter; left time: 10.4721s
	iters: 500, epoch: 2 | loss: 0.6395140
	speed: 0.0033s/iter; left time: 10.3323s
Updating learning rate to 0.0003627082520222577
Epoch: 2 cost time: 1.7298481464385986
Epoch: 2, Steps: 514 | Train Loss: 0.4321740 Vali Loss: 0.3739496 Best vali loss: 0.3715281
	iters: 100, epoch: 3 | loss: 0.3684332
	speed: 0.0073s/iter; left time: 21.6923s
	iters: 200, epoch: 3 | loss: 0.9155505
	speed: 0.0033s/iter; left time: 9.3790s
	iters: 300, epoch: 3 | loss: 0.5247851
	speed: 0.0033s/iter; left time: 9.0955s
	iters: 400, epoch: 3 | loss: 0.4623039
	speed: 0.0032s/iter; left time: 8.6541s
	iters: 500, epoch: 3 | loss: 1.3243444
	speed: 0.0032s/iter; left time: 8.2476s
Updating learning rate to 0.00029377816102674935
Epoch: 3 cost time: 1.7173635959625244
Epoch: 3, Steps: 514 | Train Loss: 0.7190834 Vali Loss: 0.3854278 Best vali loss: 0.3715281
	iters: 100, epoch: 4 | loss: 0.6348083
	speed: 0.0074s/iter; left time: 18.1868s
	iters: 200, epoch: 4 | loss: 0.4601983
	speed: 0.0031s/iter; left time: 7.4273s
	iters: 300, epoch: 4 | loss: 0.5432471
	speed: 0.0032s/iter; left time: 7.1830s
	iters: 400, epoch: 4 | loss: 0.7286800
	speed: 0.0034s/iter; left time: 7.3556s
	iters: 500, epoch: 4 | loss: 0.7311543
	speed: 0.0033s/iter; left time: 6.8551s
Updating learning rate to 0.00021246957485
Validation loss decreased (0.3715 --> 0.3488).  Saving model state dict ...
Epoch: 4 cost time: 1.7179417610168457
Epoch: 4, Steps: 514 | Train Loss: 0.6196176 Vali Loss: 0.3488452 Best vali loss: 0.3488452
	iters: 100, epoch: 5 | loss: 0.5300968
	speed: 0.0074s/iter; left time: 14.5690s
	iters: 200, epoch: 5 | loss: 0.7222250
	speed: 0.0033s/iter; left time: 6.2177s
	iters: 300, epoch: 5 | loss: 0.4852212
	speed: 0.0033s/iter; left time: 5.7602s
	iters: 400, epoch: 5 | loss: 0.8792171
	speed: 0.0032s/iter; left time: 5.3753s
	iters: 500, epoch: 5 | loss: 0.5333249
	speed: 0.0034s/iter; left time: 5.3254s
Updating learning rate to 0.00013116098867325065
Epoch: 5 cost time: 1.7559645175933838
Epoch: 5, Steps: 514 | Train Loss: 0.6300170 Vali Loss: 0.3744395 Best vali loss: 0.3488452
	iters: 100, epoch: 6 | loss: 0.2932999
	speed: 0.0073s/iter; left time: 10.4898s
	iters: 200, epoch: 6 | loss: 0.4845122
	speed: 0.0031s/iter; left time: 4.1644s
	iters: 300, epoch: 6 | loss: 0.3782540
	speed: 0.0032s/iter; left time: 4.0267s
	iters: 400, epoch: 6 | loss: 0.7365178
	speed: 0.0032s/iter; left time: 3.6169s
	iters: 500, epoch: 6 | loss: 0.8968972
	speed: 0.0033s/iter; left time: 3.4327s
Updating learning rate to 6.223089767774229e-05
Epoch: 6 cost time: 1.6883010864257812
Epoch: 6, Steps: 514 | Train Loss: 0.5578962 Vali Loss: 0.3533180 Best vali loss: 0.3488452
	iters: 100, epoch: 7 | loss: 0.3740465
	speed: 0.0071s/iter; left time: 6.5693s
	iters: 200, epoch: 7 | loss: 0.2876348
	speed: 0.0033s/iter; left time: 2.6993s
	iters: 300, epoch: 7 | loss: 0.3515522
	speed: 0.0032s/iter; left time: 2.3620s
	iters: 400, epoch: 7 | loss: 0.3746937
	speed: 0.0033s/iter; left time: 2.0757s
	iters: 500, epoch: 7 | loss: 0.7099209
	speed: 0.0032s/iter; left time: 1.6906s
Updating learning rate to 1.6173283364710154e-05
Validation loss decreased (0.3488 --> 0.3486).  Saving model state dict ...
Epoch: 7 cost time: 1.7105226516723633
Epoch: 7, Steps: 514 | Train Loss: 0.4195696 Vali Loss: 0.3485965 Best vali loss: 0.3485965
	iters: 100, epoch: 8 | loss: 0.3463047
	speed: 0.0074s/iter; left time: 3.0798s
	iters: 200, epoch: 8 | loss: 0.2219453
	speed: 0.0032s/iter; left time: 1.0115s
	iters: 300, epoch: 8 | loss: 0.3579231
	speed: 0.0032s/iter; left time: 0.6829s
	iters: 400, epoch: 8 | loss: 0.4154713
	speed: 0.0031s/iter; left time: 0.3615s
	iters: 500, epoch: 8 | loss: 0.2185406
	speed: 0.0032s/iter; left time: 0.0483s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.692049503326416
Epoch: 8, Steps: 514 | Train Loss: 0.3120370 Vali Loss: 0.3507016 Best vali loss: 0.3485965

best validation loss 0.34859652701026095

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022160808245, 'e_layers': 4, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4944360
	speed: 0.0112s/iter; left time: 45.0427s
	iters: 200, epoch: 1 | loss: 0.4518902
	speed: 0.0052s/iter; left time: 20.2013s
	iters: 300, epoch: 1 | loss: 1.2798856
	speed: 0.0051s/iter; left time: 19.2857s
	iters: 400, epoch: 1 | loss: 0.5332506
	speed: 0.0051s/iter; left time: 18.8514s
	iters: 500, epoch: 1 | loss: 0.6036599
	speed: 0.0052s/iter; left time: 18.6622s
Updating learning rate to 0.0003789142607398986
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 2.977797031402588
Epoch: 1, Steps: 514 | Train Loss: 0.6726245 Vali Loss: 0.3741563 Best vali loss: 0.3741563
	iters: 100, epoch: 2 | loss: 0.8829086
	speed: 0.0098s/iter; left time: 34.3171s
	iters: 200, epoch: 2 | loss: 0.7614992
	speed: 0.0048s/iter; left time: 16.2298s
	iters: 300, epoch: 2 | loss: 0.9926149
	speed: 0.0049s/iter; left time: 16.1160s
	iters: 400, epoch: 2 | loss: 0.4167647
	speed: 0.0048s/iter; left time: 15.3578s
	iters: 500, epoch: 2 | loss: 0.3887697
	speed: 0.0048s/iter; left time: 14.7559s
Updating learning rate to 0.00033622017026867744
Epoch: 2 cost time: 2.5128560066223145
Epoch: 2, Steps: 514 | Train Loss: 0.6885114 Vali Loss: 0.3844251 Best vali loss: 0.3741563
	iters: 100, epoch: 3 | loss: 0.5110888
	speed: 0.0098s/iter; left time: 29.3200s
	iters: 200, epoch: 3 | loss: 0.5712709
	speed: 0.0051s/iter; left time: 14.7244s
	iters: 300, epoch: 3 | loss: 0.2503138
	speed: 0.0051s/iter; left time: 14.2313s
	iters: 400, epoch: 3 | loss: 0.2803673
	speed: 0.0051s/iter; left time: 13.7974s
	iters: 500, epoch: 3 | loss: 0.9169853
	speed: 0.0050s/iter; left time: 12.8228s
Updating learning rate to 0.00027232394843768623
Validation loss decreased (0.3742 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 2.6566691398620605
Epoch: 3, Steps: 514 | Train Loss: 0.5060052 Vali Loss: 0.3609467 Best vali loss: 0.3609467

best validation loss 0.36094671069756

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022509890863, 'e_layers': 4, 'learning_rate': 0.0004231239402, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4146380
	speed: 0.0114s/iter; left time: 45.8305s
	iters: 200, epoch: 1 | loss: 0.3390635
	speed: 0.0052s/iter; left time: 20.4639s
	iters: 300, epoch: 1 | loss: 0.3872909
	speed: 0.0052s/iter; left time: 19.8292s
	iters: 400, epoch: 1 | loss: 0.3362614
	speed: 0.0052s/iter; left time: 19.3596s
	iters: 500, epoch: 1 | loss: 0.9362365
	speed: 0.0052s/iter; left time: 18.9440s
Updating learning rate to 0.00040701974413315484
Validation loss decreased (inf --> 0.3808).  Saving model state dict ...
Epoch: 1 cost time: 3.0445966720581055
Epoch: 1, Steps: 514 | Train Loss: 0.4826981 Vali Loss: 0.3808172 Best vali loss: 0.3808172
	iters: 100, epoch: 2 | loss: 1.1541841
	speed: 0.0102s/iter; left time: 35.6237s
	iters: 200, epoch: 2 | loss: 0.9941366
	speed: 0.0053s/iter; left time: 17.8984s
	iters: 300, epoch: 2 | loss: 0.6040288
	speed: 0.0052s/iter; left time: 17.2268s
	iters: 400, epoch: 2 | loss: 0.3882375
	speed: 0.0052s/iter; left time: 16.7793s
	iters: 500, epoch: 2 | loss: 0.4282984
	speed: 0.0053s/iter; left time: 16.2919s
Updating learning rate to 0.0003611588737988956
Validation loss decreased (0.3808 --> 0.3796).  Saving model state dict ...
Epoch: 2 cost time: 2.740196704864502
Epoch: 2, Steps: 514 | Train Loss: 0.7137771 Vali Loss: 0.3796429 Best vali loss: 0.3796429
	iters: 100, epoch: 3 | loss: 0.4543816
	speed: 0.0100s/iter; left time: 29.7665s
	iters: 200, epoch: 3 | loss: 0.5437848
	speed: 0.0051s/iter; left time: 14.7013s
	iters: 300, epoch: 3 | loss: 0.7591418
	speed: 0.0050s/iter; left time: 13.8439s
	iters: 400, epoch: 3 | loss: 0.3483018
	speed: 0.0051s/iter; left time: 13.7645s
	iters: 500, epoch: 3 | loss: 1.1612663
	speed: 0.0052s/iter; left time: 13.4196s
Updating learning rate to 0.0002925232309757885
Validation loss decreased (0.3796 --> 0.3750).  Saving model state dict ...
Epoch: 3 cost time: 2.672023296356201
Epoch: 3, Steps: 514 | Train Loss: 0.6533753 Vali Loss: 0.3750455 Best vali loss: 0.3750455

best validation loss 0.3750454759082532

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002298965816, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000680598354883289
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.105159044265747
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669421 Best vali loss: 0.3669421
Updating learning rate to 0.0006039120679084697
Validation loss decreased (0.3669 --> 0.3599).  Saving model state dict ...
Epoch: 2 cost time: 0.778963565826416
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3599306 Best vali loss: 0.3599306
Updating learning rate to 0.0004891429289045357
Epoch: 3 cost time: 0.785571813583374
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3663989 Best vali loss: 0.3599306

best validation loss 0.3599305639683849

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.002298965816, 'e_layers': 4, 'learning_rate': 0.0007075269978, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0003537634989
Validation loss decreased (0.3599 --> 0.3420).  Saving model state dict ...
Epoch: 4 cost time: 1.105968952178955
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3420076 Best vali loss: 0.3420076
Updating learning rate to 0.00021838406889546433
Epoch: 5 cost time: 0.7824363708496094
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3571816 Best vali loss: 0.3420076
Updating learning rate to 0.00010361492989153027
Epoch: 6 cost time: 0.7822608947753906
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3556060 Best vali loss: 0.3420076
Updating learning rate to 2.6928642916710897e-05
Epoch: 7 cost time: 0.7829837799072266
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3581609 Best vali loss: 0.3420076
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7872743606567383
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3626401 Best vali loss: 0.3420076

best validation loss 0.3420076092006181

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0068295892275, 'e_layers': 1, 'learning_rate': 0.0001444477973, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1940691
	speed: 0.0085s/iter; left time: 69.0733s
	iters: 200, epoch: 1 | loss: 0.5194386
	speed: 0.0024s/iter; left time: 19.0451s
	iters: 300, epoch: 1 | loss: 1.0707821
	speed: 0.0024s/iter; left time: 18.9198s
	iters: 400, epoch: 1 | loss: 0.7791387
	speed: 0.0024s/iter; left time: 18.3955s
	iters: 500, epoch: 1 | loss: 0.9933637
	speed: 0.0024s/iter; left time: 18.8523s
	iters: 600, epoch: 1 | loss: 0.7760763
	speed: 0.0025s/iter; left time: 18.7650s
	iters: 700, epoch: 1 | loss: 0.3297926
	speed: 0.0024s/iter; left time: 17.8699s
	iters: 800, epoch: 1 | loss: 0.5881647
	speed: 0.0024s/iter; left time: 17.6642s
	iters: 900, epoch: 1 | loss: 0.5967067
	speed: 0.0024s/iter; left time: 17.2819s
	iters: 1000, epoch: 1 | loss: 0.6238378
	speed: 0.0024s/iter; left time: 17.2202s
Updating learning rate to 0.0001444477973
Validation loss decreased (inf --> 0.3643).  Saving model state dict ...
Epoch: 1 cost time: 2.7944443225860596
Epoch: 1, Steps: 1027 | Train Loss: 0.7471370 Vali Loss: 0.3642507 Best vali loss: 0.3642507
	iters: 100, epoch: 2 | loss: 0.7726386
	speed: 0.0077s/iter; left time: 54.4206s
	iters: 200, epoch: 2 | loss: 0.1571994
	speed: 0.0025s/iter; left time: 17.4188s
	iters: 300, epoch: 2 | loss: 0.3946497
	speed: 0.0025s/iter; left time: 16.8895s
	iters: 400, epoch: 2 | loss: 0.4449341
	speed: 0.0025s/iter; left time: 16.7141s
	iters: 500, epoch: 2 | loss: 0.4012638
	speed: 0.0025s/iter; left time: 16.5168s
	iters: 600, epoch: 2 | loss: 0.6855381
	speed: 0.0025s/iter; left time: 16.2402s
	iters: 700, epoch: 2 | loss: 0.5443712
	speed: 0.0025s/iter; left time: 15.9487s
	iters: 800, epoch: 2 | loss: 0.5958374
	speed: 0.0025s/iter; left time: 15.9665s
	iters: 900, epoch: 2 | loss: 0.4076945
	speed: 0.0025s/iter; left time: 15.6871s
	iters: 1000, epoch: 2 | loss: 0.8376631
	speed: 0.0024s/iter; left time: 14.8013s
Updating learning rate to 7.222389865e-05
Epoch: 2 cost time: 2.5642447471618652
Epoch: 2, Steps: 1027 | Train Loss: 0.5241790 Vali Loss: 0.3688783 Best vali loss: 0.3642507
	iters: 100, epoch: 3 | loss: 1.0145071
	speed: 0.0072s/iter; left time: 43.7752s
	iters: 200, epoch: 3 | loss: 0.9373968
	speed: 0.0020s/iter; left time: 11.9999s
	iters: 300, epoch: 3 | loss: 0.4111503
	speed: 0.0021s/iter; left time: 12.3556s
	iters: 400, epoch: 3 | loss: 1.0116299
	speed: 0.0024s/iter; left time: 13.7199s
	iters: 500, epoch: 3 | loss: 0.5410529
	speed: 0.0025s/iter; left time: 14.0652s
	iters: 600, epoch: 3 | loss: 0.5660995
	speed: 0.0025s/iter; left time: 13.6812s
	iters: 700, epoch: 3 | loss: 0.2367137
	speed: 0.0024s/iter; left time: 12.9710s
	iters: 800, epoch: 3 | loss: 0.4200400
	speed: 0.0025s/iter; left time: 13.1485s
	iters: 900, epoch: 3 | loss: 0.2730534
	speed: 0.0025s/iter; left time: 13.1345s
	iters: 1000, epoch: 3 | loss: 0.3428576
	speed: 0.0025s/iter; left time: 12.8922s
Updating learning rate to 3.6111949325e-05
Epoch: 3 cost time: 2.4334170818328857
Epoch: 3, Steps: 1027 | Train Loss: 0.5754501 Vali Loss: 0.3703998 Best vali loss: 0.3642507
	iters: 100, epoch: 4 | loss: 0.3724688
	speed: 0.0073s/iter; left time: 36.6200s
	iters: 200, epoch: 4 | loss: 0.4249274
	speed: 0.0020s/iter; left time: 9.9377s
	iters: 300, epoch: 4 | loss: 0.7034858
	speed: 0.0020s/iter; left time: 9.6774s
	iters: 400, epoch: 4 | loss: 0.7236072
	speed: 0.0021s/iter; left time: 9.8049s
	iters: 500, epoch: 4 | loss: 1.3241947
	speed: 0.0020s/iter; left time: 9.2752s
	iters: 600, epoch: 4 | loss: 0.2949235
	speed: 0.0021s/iter; left time: 9.3073s
	iters: 700, epoch: 4 | loss: 0.2855215
	speed: 0.0020s/iter; left time: 9.0063s
	iters: 800, epoch: 4 | loss: 0.6228428
	speed: 0.0021s/iter; left time: 8.9217s
	iters: 900, epoch: 4 | loss: 0.1683262
	speed: 0.0021s/iter; left time: 8.7889s
	iters: 1000, epoch: 4 | loss: 0.6168596
	speed: 0.0021s/iter; left time: 8.5303s
Updating learning rate to 1.80559746625e-05
Epoch: 4 cost time: 2.1476798057556152
Epoch: 4, Steps: 1027 | Train Loss: 0.5537158 Vali Loss: 0.3737282 Best vali loss: 0.3642507
	iters: 100, epoch: 5 | loss: 0.1839639
	speed: 0.0071s/iter; left time: 28.4091s
	iters: 200, epoch: 5 | loss: 0.3231826
	speed: 0.0021s/iter; left time: 8.1173s
	iters: 300, epoch: 5 | loss: 0.5468643
	speed: 0.0020s/iter; left time: 7.6594s
	iters: 400, epoch: 5 | loss: 1.4896314
	speed: 0.0021s/iter; left time: 7.9361s
	iters: 500, epoch: 5 | loss: 0.4205833
	speed: 0.0020s/iter; left time: 7.2627s
	iters: 600, epoch: 5 | loss: 0.3348373
	speed: 0.0020s/iter; left time: 7.0410s
	iters: 700, epoch: 5 | loss: 1.5874623
	speed: 0.0020s/iter; left time: 6.8526s
	iters: 800, epoch: 5 | loss: 0.2691082
	speed: 0.0020s/iter; left time: 6.6826s
	iters: 900, epoch: 5 | loss: 0.3928075
	speed: 0.0020s/iter; left time: 6.4222s
	iters: 1000, epoch: 5 | loss: 0.9897695
	speed: 0.0021s/iter; left time: 6.6637s
Updating learning rate to 9.02798733125e-06
Epoch: 5 cost time: 2.1630125045776367
Epoch: 5, Steps: 1027 | Train Loss: 0.6538210 Vali Loss: 0.3751192 Best vali loss: 0.3642507
	iters: 100, epoch: 6 | loss: 0.4572832
	speed: 0.0073s/iter; left time: 21.6498s
	iters: 200, epoch: 6 | loss: 0.2734646
	speed: 0.0021s/iter; left time: 6.0593s
	iters: 300, epoch: 6 | loss: 0.3323415
	speed: 0.0021s/iter; left time: 5.8154s
	iters: 400, epoch: 6 | loss: 0.3770421
	speed: 0.0021s/iter; left time: 5.6154s
	iters: 500, epoch: 6 | loss: 0.4357901
	speed: 0.0021s/iter; left time: 5.4621s
	iters: 600, epoch: 6 | loss: 0.3290514
	speed: 0.0021s/iter; left time: 5.2011s
	iters: 700, epoch: 6 | loss: 1.0485746
	speed: 0.0021s/iter; left time: 5.0221s
	iters: 800, epoch: 6 | loss: 1.2486989
	speed: 0.0021s/iter; left time: 4.8361s
	iters: 900, epoch: 6 | loss: 1.2775849
	speed: 0.0021s/iter; left time: 4.6462s
	iters: 1000, epoch: 6 | loss: 0.5125722
	speed: 0.0021s/iter; left time: 4.4629s
Updating learning rate to 4.513993665625e-06
Epoch: 6 cost time: 2.2054007053375244
Epoch: 6, Steps: 1027 | Train Loss: 0.6292404 Vali Loss: 0.3748266 Best vali loss: 0.3642507
	iters: 100, epoch: 7 | loss: 0.5691686
	speed: 0.0069s/iter; left time: 13.5806s
	iters: 200, epoch: 7 | loss: 0.7772082
	speed: 0.0021s/iter; left time: 3.8225s
	iters: 300, epoch: 7 | loss: 0.5891466
	speed: 0.0023s/iter; left time: 3.9718s
	iters: 400, epoch: 7 | loss: 0.7896619
	speed: 0.0025s/iter; left time: 4.0622s
	iters: 500, epoch: 7 | loss: 0.7507381
	speed: 0.0024s/iter; left time: 3.8043s
	iters: 600, epoch: 7 | loss: 0.3744977
	speed: 0.0024s/iter; left time: 3.5385s
	iters: 700, epoch: 7 | loss: 0.5003560
	speed: 0.0021s/iter; left time: 2.8018s
	iters: 800, epoch: 7 | loss: 0.3601632
	speed: 0.0020s/iter; left time: 2.5261s
	iters: 900, epoch: 7 | loss: 0.5890069
	speed: 0.0020s/iter; left time: 2.3463s
	iters: 1000, epoch: 7 | loss: 0.7266055
	speed: 0.0020s/iter; left time: 2.1103s
Updating learning rate to 2.2569968328125e-06
Epoch: 7 cost time: 2.2825186252593994
Epoch: 7, Steps: 1027 | Train Loss: 0.6026553 Vali Loss: 0.3754443 Best vali loss: 0.3642507
	iters: 100, epoch: 8 | loss: 0.4472154
	speed: 0.0071s/iter; left time: 6.6050s
	iters: 200, epoch: 8 | loss: 0.2863180
	speed: 0.0022s/iter; left time: 1.8051s
	iters: 300, epoch: 8 | loss: 0.2406909
	speed: 0.0021s/iter; left time: 1.5198s
	iters: 400, epoch: 8 | loss: 0.4923538
	speed: 0.0021s/iter; left time: 1.3275s
	iters: 500, epoch: 8 | loss: 0.7122535
	speed: 0.0021s/iter; left time: 1.0830s
	iters: 600, epoch: 8 | loss: 0.5080831
	speed: 0.0021s/iter; left time: 0.8776s
	iters: 700, epoch: 8 | loss: 0.4297695
	speed: 0.0020s/iter; left time: 0.6716s
	iters: 800, epoch: 8 | loss: 0.4660817
	speed: 0.0020s/iter; left time: 0.4653s
	iters: 900, epoch: 8 | loss: 0.7618273
	speed: 0.0021s/iter; left time: 0.2626s
	iters: 1000, epoch: 8 | loss: 0.5519327
	speed: 0.0020s/iter; left time: 0.0570s
Updating learning rate to 1.12849841640625e-06
Epoch: 8 cost time: 2.1700947284698486
Epoch: 8, Steps: 1027 | Train Loss: 0.4896526 Vali Loss: 0.3755941 Best vali loss: 0.3642507

best validation loss 0.3642506768228029

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072755642576, 'e_layers': 4, 'learning_rate': 0.0004287539993, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4149063
	speed: 0.0113s/iter; left time: 45.3478s
	iters: 200, epoch: 1 | loss: 0.3380830
	speed: 0.0049s/iter; left time: 19.1333s
	iters: 300, epoch: 1 | loss: 0.3843167
	speed: 0.0049s/iter; left time: 18.5244s
	iters: 400, epoch: 1 | loss: 0.3362941
	speed: 0.0049s/iter; left time: 18.0878s
	iters: 500, epoch: 1 | loss: 0.8958227
	speed: 0.0050s/iter; left time: 18.1489s
Updating learning rate to 0.00041243552186781427
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 2.891045331954956
Epoch: 1, Steps: 514 | Train Loss: 0.4738846 Vali Loss: 0.3774797 Best vali loss: 0.3774797
	iters: 100, epoch: 2 | loss: 1.1421909
	speed: 0.0100s/iter; left time: 34.9132s
	iters: 200, epoch: 2 | loss: 0.9323322
	speed: 0.0049s/iter; left time: 16.8239s
	iters: 300, epoch: 2 | loss: 0.6587586
	speed: 0.0048s/iter; left time: 15.9367s
	iters: 400, epoch: 2 | loss: 0.3902734
	speed: 0.0050s/iter; left time: 15.8761s
	iters: 500, epoch: 2 | loss: 0.4517353
	speed: 0.0050s/iter; left time: 15.4776s
Updating learning rate to 0.0003659644298329411
Epoch: 2 cost time: 2.584120273590088
Epoch: 2, Steps: 514 | Train Loss: 0.7150581 Vali Loss: 0.4006521 Best vali loss: 0.3774797
	iters: 100, epoch: 3 | loss: 0.3971222
	speed: 0.0099s/iter; left time: 29.6813s
	iters: 200, epoch: 3 | loss: 0.4463782
	speed: 0.0049s/iter; left time: 14.1345s
	iters: 300, epoch: 3 | loss: 0.7730609
	speed: 0.0050s/iter; left time: 13.8177s
	iters: 400, epoch: 3 | loss: 0.3721600
	speed: 0.0048s/iter; left time: 13.0059s
	iters: 500, epoch: 3 | loss: 1.1433074
	speed: 0.0048s/iter; left time: 12.5366s
Updating learning rate to 0.00029641552569619167
Validation loss decreased (0.3775 --> 0.3769).  Saving model state dict ...
Epoch: 3 cost time: 2.557185649871826
Epoch: 3, Steps: 514 | Train Loss: 0.6264057 Vali Loss: 0.3769067 Best vali loss: 0.3769067
	iters: 100, epoch: 4 | loss: 0.7126441
	speed: 0.0103s/iter; left time: 25.4849s
	iters: 200, epoch: 4 | loss: 0.9326499
	speed: 0.0051s/iter; left time: 12.0231s
	iters: 300, epoch: 4 | loss: 0.4257771
	speed: 0.0051s/iter; left time: 11.6309s
	iters: 400, epoch: 4 | loss: 0.3155780
	speed: 0.0052s/iter; left time: 11.2980s
	iters: 500, epoch: 4 | loss: 0.4477517
	speed: 0.0052s/iter; left time: 10.7130s
Updating learning rate to 0.00021437699965
Epoch: 4 cost time: 2.6846325397491455
Epoch: 4, Steps: 514 | Train Loss: 0.5668802 Vali Loss: 0.3932038 Best vali loss: 0.3769067
	iters: 100, epoch: 5 | loss: 0.8625806
	speed: 0.0105s/iter; left time: 20.5445s
	iters: 200, epoch: 5 | loss: 0.8097254
	speed: 0.0052s/iter; left time: 9.7432s
	iters: 300, epoch: 5 | loss: 0.6166017
	speed: 0.0053s/iter; left time: 9.2815s
	iters: 400, epoch: 5 | loss: 0.6844763
	speed: 0.0053s/iter; left time: 8.7943s
	iters: 500, epoch: 5 | loss: 0.8342366
	speed: 0.0051s/iter; left time: 7.9581s
Updating learning rate to 0.00013233847360380834
Epoch: 5 cost time: 2.7336785793304443
Epoch: 5, Steps: 514 | Train Loss: 0.7615241 Vali Loss: 0.3842134 Best vali loss: 0.3769067
	iters: 100, epoch: 6 | loss: 0.4476031
	speed: 0.0095s/iter; left time: 13.6911s
	iters: 200, epoch: 6 | loss: 0.8722401
	speed: 0.0048s/iter; left time: 6.4853s
	iters: 300, epoch: 6 | loss: 0.4440095
	speed: 0.0049s/iter; left time: 6.0478s
	iters: 400, epoch: 6 | loss: 0.7099948
	speed: 0.0049s/iter; left time: 5.5549s
	iters: 500, epoch: 6 | loss: 0.3075301
	speed: 0.0051s/iter; left time: 5.3333s
Updating learning rate to 6.278956946705889e-05
Epoch: 6 cost time: 2.569281578063965
Epoch: 6, Steps: 514 | Train Loss: 0.5562755 Vali Loss: 0.3799425 Best vali loss: 0.3769067
	iters: 100, epoch: 7 | loss: 0.2788955
	speed: 0.0098s/iter; left time: 9.1285s
	iters: 200, epoch: 7 | loss: 0.3315375
	speed: 0.0048s/iter; left time: 3.9924s
	iters: 300, epoch: 7 | loss: 0.9701523
	speed: 0.0049s/iter; left time: 3.5610s
	iters: 400, epoch: 7 | loss: 0.7477421
	speed: 0.0050s/iter; left time: 3.1175s
	iters: 500, epoch: 7 | loss: 0.5141141
	speed: 0.0049s/iter; left time: 2.6157s
Updating learning rate to 1.6318477432185717e-05
Epoch: 7 cost time: 2.575045108795166
Epoch: 7, Steps: 514 | Train Loss: 0.5684883 Vali Loss: 0.3981431 Best vali loss: 0.3769067
	iters: 100, epoch: 8 | loss: 0.2693371
	speed: 0.0099s/iter; left time: 4.0984s
	iters: 200, epoch: 8 | loss: 0.5357124
	speed: 0.0047s/iter; left time: 1.4807s
	iters: 300, epoch: 8 | loss: 0.6675549
	speed: 0.0046s/iter; left time: 0.9991s
	iters: 400, epoch: 8 | loss: 0.4068731
	speed: 0.0048s/iter; left time: 0.5518s
	iters: 500, epoch: 8 | loss: 0.2213754
	speed: 0.0048s/iter; left time: 0.0717s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.505460739135742
Epoch: 8, Steps: 514 | Train Loss: 0.4201706 Vali Loss: 0.3918746 Best vali loss: 0.3769067

best validation loss 0.37690671778380985

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 3, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6227232
	speed: 0.0109s/iter; left time: 43.5863s
	iters: 200, epoch: 1 | loss: 0.6632822
	speed: 0.0042s/iter; left time: 16.5496s
	iters: 300, epoch: 1 | loss: 0.2823099
	speed: 0.0042s/iter; left time: 15.9576s
	iters: 400, epoch: 1 | loss: 0.5595639
	speed: 0.0040s/iter; left time: 14.7849s
	iters: 500, epoch: 1 | loss: 1.1101004
	speed: 0.0039s/iter; left time: 14.1985s
Updating learning rate to 0.0003957152226005332
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 2.4924917221069336
Epoch: 1, Steps: 514 | Train Loss: 0.6475959 Vali Loss: 0.3726503 Best vali loss: 0.3726503
	iters: 100, epoch: 2 | loss: 0.3638992
	speed: 0.0092s/iter; left time: 32.1134s
	iters: 200, epoch: 2 | loss: 0.4836070
	speed: 0.0045s/iter; left time: 15.1642s
	iters: 300, epoch: 2 | loss: 0.4021069
	speed: 0.0044s/iter; left time: 14.5886s
	iters: 400, epoch: 2 | loss: 0.2929691
	speed: 0.0045s/iter; left time: 14.3434s
	iters: 500, epoch: 2 | loss: 0.2762792
	speed: 0.0043s/iter; left time: 13.4023s
Updating learning rate to 0.00035112808702649433
Validation loss decreased (0.3727 --> 0.3709).  Saving model state dict ...
Epoch: 2 cost time: 2.318687677383423
Epoch: 2, Steps: 514 | Train Loss: 0.3637723 Vali Loss: 0.3709007 Best vali loss: 0.3709007
	iters: 100, epoch: 3 | loss: 0.4196221
	speed: 0.0089s/iter; left time: 26.4646s
	iters: 200, epoch: 3 | loss: 1.0670600
	speed: 0.0044s/iter; left time: 12.5688s
	iters: 300, epoch: 3 | loss: 0.6995544
	speed: 0.0042s/iter; left time: 11.7633s
	iters: 400, epoch: 3 | loss: 0.8179066
	speed: 0.0042s/iter; left time: 11.3230s
	iters: 500, epoch: 3 | loss: 0.3981760
	speed: 0.0039s/iter; left time: 10.0966s
Updating learning rate to 0.00028439872298564043
Epoch: 3 cost time: 2.1830127239227295
Epoch: 3, Steps: 514 | Train Loss: 0.6804638 Vali Loss: 0.3873585 Best vali loss: 0.3709007

best validation loss 0.3709007268804464

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0011980975165, 'e_layers': 4, 'learning_rate': 0.0008248436841, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4405686
	speed: 0.0114s/iter; left time: 45.8769s
	iters: 200, epoch: 1 | loss: 0.8367206
	speed: 0.0052s/iter; left time: 20.2622s
	iters: 300, epoch: 1 | loss: 0.8195383
	speed: 0.0049s/iter; left time: 18.8302s
	iters: 400, epoch: 1 | loss: 1.0961994
	speed: 0.0050s/iter; left time: 18.4848s
	iters: 500, epoch: 1 | loss: 0.5364443
	speed: 0.0051s/iter; left time: 18.3747s
Updating learning rate to 0.0007934499406805978
Validation loss decreased (inf --> 0.4023).  Saving model state dict ...
Epoch: 1 cost time: 2.953052282333374
Epoch: 1, Steps: 514 | Train Loss: 0.7458942 Vali Loss: 0.4022875 Best vali loss: 0.4022875
	iters: 100, epoch: 2 | loss: 1.1072749
	speed: 0.0103s/iter; left time: 36.0956s
	iters: 200, epoch: 2 | loss: 0.7840340
	speed: 0.0051s/iter; left time: 17.3839s
	iters: 300, epoch: 2 | loss: 0.8951915
	speed: 0.0049s/iter; left time: 16.0910s
	iters: 400, epoch: 2 | loss: 0.7191933
	speed: 0.0048s/iter; left time: 15.2350s
	iters: 500, epoch: 2 | loss: 0.4082719
	speed: 0.0049s/iter; left time: 15.2038s
Updating learning rate to 0.0007040481232730021
Epoch: 2 cost time: 2.5919411182403564
Epoch: 2, Steps: 514 | Train Loss: 0.7827931 Vali Loss: 0.4094277 Best vali loss: 0.4022875
	iters: 100, epoch: 3 | loss: 0.6080619
	speed: 0.0100s/iter; left time: 29.8453s
	iters: 200, epoch: 3 | loss: 0.5177282
	speed: 0.0049s/iter; left time: 14.1986s
	iters: 300, epoch: 3 | loss: 0.4969720
	speed: 0.0049s/iter; left time: 13.6513s
	iters: 400, epoch: 3 | loss: 1.3570106
	speed: 0.0049s/iter; left time: 13.0878s
	iters: 500, epoch: 3 | loss: 0.3671961
	speed: 0.0049s/iter; left time: 12.7472s
Updating learning rate to 0.0005702488481480269
Epoch: 3 cost time: 2.561861515045166
Epoch: 3, Steps: 514 | Train Loss: 0.6693938 Vali Loss: 0.4042793 Best vali loss: 0.4022875

best validation loss 0.4022874677755041

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050775219313, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006718190875
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.0964300632476807
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3689959 Best vali loss: 0.3689959
Updating learning rate to 0.00033590954375
Validation loss decreased (0.3690 --> 0.3669).  Saving model state dict ...
Epoch: 2 cost time: 0.7784707546234131
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3669051 Best vali loss: 0.3669051
Updating learning rate to 0.000167954771875
Validation loss decreased (0.3669 --> 0.3630).  Saving model state dict ...
Epoch: 3 cost time: 0.7819926738739014
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3630426 Best vali loss: 0.3630426

best validation loss 0.3630425626379099

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0050775219313, 'e_layers': 4, 'learning_rate': 0.0006718190875, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.39773859375e-05
Validation loss decreased (0.3630 --> 0.3507).  Saving model state dict ...
Epoch: 4 cost time: 1.0970523357391357
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3507355 Best vali loss: 0.3507355
Updating learning rate to 4.198869296875e-05
Epoch: 5 cost time: 0.7726073265075684
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3521228 Best vali loss: 0.3507355
Updating learning rate to 2.0994346484375e-05
Validation loss decreased (0.3507 --> 0.3482).  Saving model state dict ...
Epoch: 6 cost time: 0.770892858505249
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3481585 Best vali loss: 0.3481585
Updating learning rate to 1.04971732421875e-05
Validation loss decreased (0.3482 --> 0.3450).  Saving model state dict ...
Epoch: 7 cost time: 0.774852991104126
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3449560 Best vali loss: 0.3449560
Updating learning rate to 5.24858662109375e-06
Epoch: 8 cost time: 0.7792749404907227
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3476835 Best vali loss: 0.3449560

best validation loss 0.3449560172899767

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0022932361561, 'e_layers': 4, 'learning_rate': 0.0007060285997, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006791569861652172
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 1.1029202938079834
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3668387 Best vali loss: 0.3668387
Updating learning rate to 0.0006026331051297562
Epoch: 2 cost time: 0.79189133644104
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3801084 Best vali loss: 0.3668387
Updating learning rate to 0.00048810702379055703
Validation loss decreased (0.3668 --> 0.3524).  Saving model state dict ...
Epoch: 3 cost time: 0.7954323291778564
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3524219 Best vali loss: 0.3524219
Updating learning rate to 0.00035301429985
Validation loss decreased (0.3524 --> 0.3427).  Saving model state dict ...
Epoch: 4 cost time: 0.7923939228057861
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3427074 Best vali loss: 0.3427074
Updating learning rate to 0.000217921575909443
Epoch: 5 cost time: 0.7886495590209961
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3611078 Best vali loss: 0.3427074
Updating learning rate to 0.00010339549457024379
Epoch: 6 cost time: 0.7840259075164795
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3682925 Best vali loss: 0.3427074
Updating learning rate to 2.68716135347828e-05
Epoch: 7 cost time: 0.7909946441650391
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3736791 Best vali loss: 0.3427074
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7908539772033691
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3759213 Best vali loss: 0.3427074

best validation loss 0.3427073848622253

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022134457991, 'e_layers': 2, 'learning_rate': 0.0004922365918, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3532534
	speed: 0.0097s/iter; left time: 38.9046s
	iters: 200, epoch: 1 | loss: 0.3389565
	speed: 0.0036s/iter; left time: 13.9234s
	iters: 300, epoch: 1 | loss: 0.8931847
	speed: 0.0035s/iter; left time: 13.4734s
	iters: 400, epoch: 1 | loss: 0.9019298
	speed: 0.0035s/iter; left time: 12.8555s
	iters: 500, epoch: 1 | loss: 0.6753171
	speed: 0.0034s/iter; left time: 12.4535s
Updating learning rate to 0.0004922365918
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 2.1469948291778564
Epoch: 1, Steps: 514 | Train Loss: 0.6325283 Vali Loss: 0.3713279 Best vali loss: 0.3713279
	iters: 100, epoch: 2 | loss: 1.0406982
	speed: 0.0075s/iter; left time: 26.1539s
	iters: 200, epoch: 2 | loss: 0.9150279
	speed: 0.0035s/iter; left time: 11.9070s
	iters: 300, epoch: 2 | loss: 1.5340369
	speed: 0.0036s/iter; left time: 11.9039s
	iters: 400, epoch: 2 | loss: 0.3884717
	speed: 0.0035s/iter; left time: 11.2766s
	iters: 500, epoch: 2 | loss: 0.6204309
	speed: 0.0034s/iter; left time: 10.4935s
Updating learning rate to 0.0002461182959
Epoch: 2 cost time: 1.8467285633087158
Epoch: 2, Steps: 514 | Train Loss: 0.8997331 Vali Loss: 0.3976181 Best vali loss: 0.3713279
	iters: 100, epoch: 3 | loss: 0.9523986
	speed: 0.0074s/iter; left time: 22.1183s
	iters: 200, epoch: 3 | loss: 0.7627777
	speed: 0.0033s/iter; left time: 9.5812s
	iters: 300, epoch: 3 | loss: 0.4570644
	speed: 0.0033s/iter; left time: 9.1947s
	iters: 400, epoch: 3 | loss: 0.6623582
	speed: 0.0033s/iter; left time: 8.8414s
	iters: 500, epoch: 3 | loss: 0.2429167
	speed: 0.0034s/iter; left time: 8.6866s
Updating learning rate to 0.00012305914795
Epoch: 3 cost time: 1.7574479579925537
Epoch: 3, Steps: 514 | Train Loss: 0.6155031 Vali Loss: 0.3713662 Best vali loss: 0.3713279
	iters: 100, epoch: 4 | loss: 0.5377733
	speed: 0.0071s/iter; left time: 17.4510s
	iters: 200, epoch: 4 | loss: 0.2639396
	speed: 0.0034s/iter; left time: 7.9970s
	iters: 300, epoch: 4 | loss: 0.3168150
	speed: 0.0033s/iter; left time: 7.5088s
	iters: 400, epoch: 4 | loss: 0.3138993
	speed: 0.0031s/iter; left time: 6.7518s
	iters: 500, epoch: 4 | loss: 0.7904936
	speed: 0.0032s/iter; left time: 6.6967s
Updating learning rate to 6.1529573975e-05
Validation loss decreased (0.3713 --> 0.3571).  Saving model state dict ...
Epoch: 4 cost time: 1.7217178344726562
Epoch: 4, Steps: 514 | Train Loss: 0.4445842 Vali Loss: 0.3570665 Best vali loss: 0.3570665
	iters: 100, epoch: 5 | loss: 0.4415617
	speed: 0.0073s/iter; left time: 14.2777s
	iters: 200, epoch: 5 | loss: 0.5061592
	speed: 0.0032s/iter; left time: 6.0340s
	iters: 300, epoch: 5 | loss: 0.2359200
	speed: 0.0033s/iter; left time: 5.8748s
	iters: 400, epoch: 5 | loss: 0.6653327
	speed: 0.0033s/iter; left time: 5.4266s
	iters: 500, epoch: 5 | loss: 0.5372524
	speed: 0.0033s/iter; left time: 5.0605s
Updating learning rate to 3.07647869875e-05
Validation loss decreased (0.3571 --> 0.3570).  Saving model state dict ...
Epoch: 5 cost time: 1.7278380393981934
Epoch: 5, Steps: 514 | Train Loss: 0.4772452 Vali Loss: 0.3569856 Best vali loss: 0.3569856
	iters: 100, epoch: 6 | loss: 0.2528655
	speed: 0.0071s/iter; left time: 10.2267s
	iters: 200, epoch: 6 | loss: 0.2859545
	speed: 0.0030s/iter; left time: 4.0871s
	iters: 300, epoch: 6 | loss: 0.3965763
	speed: 0.0030s/iter; left time: 3.7776s
	iters: 400, epoch: 6 | loss: 0.4480091
	speed: 0.0032s/iter; left time: 3.6766s
	iters: 500, epoch: 6 | loss: 0.3803005
	speed: 0.0031s/iter; left time: 3.2466s
Updating learning rate to 1.538239349375e-05
Validation loss decreased (0.3570 --> 0.3564).  Saving model state dict ...
Epoch: 6 cost time: 1.6359894275665283
Epoch: 6, Steps: 514 | Train Loss: 0.3527412 Vali Loss: 0.3563637 Best vali loss: 0.3563637
	iters: 100, epoch: 7 | loss: 0.5012695
	speed: 0.0072s/iter; left time: 6.7079s
	iters: 200, epoch: 7 | loss: 0.5847485
	speed: 0.0032s/iter; left time: 2.6656s
	iters: 300, epoch: 7 | loss: 0.8500155
	speed: 0.0035s/iter; left time: 2.5394s
	iters: 400, epoch: 7 | loss: 0.5915515
	speed: 0.0035s/iter; left time: 2.2168s
	iters: 500, epoch: 7 | loss: 0.3259758
	speed: 0.0036s/iter; left time: 1.8861s
Updating learning rate to 7.691196746875e-06
Validation loss decreased (0.3564 --> 0.3534).  Saving model state dict ...
Epoch: 7 cost time: 1.7943036556243896
Epoch: 7, Steps: 514 | Train Loss: 0.5707122 Vali Loss: 0.3533740 Best vali loss: 0.3533740
	iters: 100, epoch: 8 | loss: 0.2900628
	speed: 0.0074s/iter; left time: 3.0757s
	iters: 200, epoch: 8 | loss: 0.5461485
	speed: 0.0031s/iter; left time: 0.9788s
	iters: 300, epoch: 8 | loss: 0.2894816
	speed: 0.0031s/iter; left time: 0.6652s
	iters: 400, epoch: 8 | loss: 0.4243866
	speed: 0.0033s/iter; left time: 0.3825s
	iters: 500, epoch: 8 | loss: 0.3880244
	speed: 0.0033s/iter; left time: 0.0495s
Updating learning rate to 3.8455983734375e-06
Epoch: 8 cost time: 1.6976897716522217
Epoch: 8, Steps: 514 | Train Loss: 0.3876208 Vali Loss: 0.3546354 Best vali loss: 0.3533740

best validation loss 0.35337396684470485

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 2, 'learning_rate': 0.0006891207814, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006891207814
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 0.7692441940307617
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706804 Best vali loss: 0.3706804
Updating learning rate to 0.0003445603907
Validation loss decreased (0.3707 --> 0.3575).  Saving model state dict ...
Epoch: 2 cost time: 0.44393491744995117
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3575385 Best vali loss: 0.3575385
Updating learning rate to 0.00017228019535
Epoch: 3 cost time: 0.44592952728271484
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3653343 Best vali loss: 0.3575385

best validation loss 0.35753847996471905

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.002214191515, 'e_layers': 4, 'learning_rate': 0.0009047645238, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4709117
	speed: 0.0116s/iter; left time: 22.7930s
	iters: 200, epoch: 1 | loss: 0.5770969
	speed: 0.0055s/iter; left time: 10.2835s
Updating learning rate to 0.0008703289745405705
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 1.753671646118164
Epoch: 1, Steps: 257 | Train Loss: 0.5240043 Vali Loss: 0.3749175 Best vali loss: 0.3749175
	iters: 100, epoch: 2 | loss: 0.7292511
	speed: 0.0113s/iter; left time: 19.1850s
	iters: 200, epoch: 2 | loss: 0.8560830
	speed: 0.0055s/iter; left time: 8.7453s
Updating learning rate to 0.0007722648269779987
Epoch: 2 cost time: 1.4347960948944092
Epoch: 2, Steps: 257 | Train Loss: 0.7926670 Vali Loss: 0.3825429 Best vali loss: 0.3749175
	iters: 100, epoch: 3 | loss: 0.8481674
	speed: 0.0113s/iter; left time: 16.3507s
	iters: 200, epoch: 3 | loss: 0.6814528
	speed: 0.0056s/iter; left time: 7.5294s
Updating learning rate to 0.000625501458624975
Validation loss decreased (0.3749 --> 0.3691).  Saving model state dict ...
Epoch: 3 cost time: 1.4805912971496582
Epoch: 3, Steps: 257 | Train Loss: 0.7648101 Vali Loss: 0.3690981 Best vali loss: 0.3690981

best validation loss 0.3690980694382973

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0015794468859, 'e_layers': 4, 'learning_rate': 0.0002532315305, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1652743
	speed: 0.0115s/iter; left time: 93.4513s
	iters: 200, epoch: 1 | loss: 0.5250893
	speed: 0.0052s/iter; left time: 41.5897s
	iters: 300, epoch: 1 | loss: 0.4187341
	speed: 0.0052s/iter; left time: 40.9088s
	iters: 400, epoch: 1 | loss: 0.2786841
	speed: 0.0052s/iter; left time: 40.2689s
	iters: 500, epoch: 1 | loss: 0.7918237
	speed: 0.0051s/iter; left time: 39.2659s
	iters: 600, epoch: 1 | loss: 0.2395284
	speed: 0.0050s/iter; left time: 38.1308s
	iters: 700, epoch: 1 | loss: 0.9997588
	speed: 0.0050s/iter; left time: 37.4763s
	iters: 800, epoch: 1 | loss: 0.3647645
	speed: 0.0050s/iter; left time: 36.9973s
	iters: 900, epoch: 1 | loss: 1.0065151
	speed: 0.0050s/iter; left time: 36.5071s
	iters: 1000, epoch: 1 | loss: 0.5689190
	speed: 0.0049s/iter; left time: 35.3204s
Updating learning rate to 0.00024359347925772884
Validation loss decreased (inf --> 0.3810).  Saving model state dict ...
Epoch: 1 cost time: 5.544867277145386
Epoch: 1, Steps: 1027 | Train Loss: 0.6359091 Vali Loss: 0.3809845 Best vali loss: 0.3809845
	iters: 100, epoch: 2 | loss: 0.6557063
	speed: 0.0129s/iter; left time: 91.4083s
	iters: 200, epoch: 2 | loss: 0.7990571
	speed: 0.0046s/iter; left time: 32.4084s
	iters: 300, epoch: 2 | loss: 0.4949791
	speed: 0.0047s/iter; left time: 32.2132s
	iters: 400, epoch: 2 | loss: 0.4714120
	speed: 0.0046s/iter; left time: 31.5652s
	iters: 500, epoch: 2 | loss: 0.5709718
	speed: 0.0046s/iter; left time: 31.0966s
	iters: 600, epoch: 2 | loss: 0.2877761
	speed: 0.0047s/iter; left time: 30.6521s
	iters: 700, epoch: 2 | loss: 0.4435939
	speed: 0.0046s/iter; left time: 30.0924s
	iters: 800, epoch: 2 | loss: 0.4886835
	speed: 0.0046s/iter; left time: 29.3392s
	iters: 900, epoch: 2 | loss: 0.4989696
	speed: 0.0046s/iter; left time: 28.8146s
	iters: 1000, epoch: 2 | loss: 0.2938591
	speed: 0.0046s/iter; left time: 28.5198s
Updating learning rate to 0.00021614663146339903
Epoch: 2 cost time: 4.799312353134155
Epoch: 2, Steps: 1027 | Train Loss: 0.5005009 Vali Loss: 0.3922241 Best vali loss: 0.3809845
	iters: 100, epoch: 3 | loss: 0.4331946
	speed: 0.0127s/iter; left time: 76.7566s
	iters: 200, epoch: 3 | loss: 1.0519655
	speed: 0.0048s/iter; left time: 28.8240s
	iters: 300, epoch: 3 | loss: 0.6495799
	speed: 0.0046s/iter; left time: 27.0724s
	iters: 400, epoch: 3 | loss: 0.5221111
	speed: 0.0048s/iter; left time: 27.4794s
	iters: 500, epoch: 3 | loss: 0.8941019
	speed: 0.0047s/iter; left time: 26.6973s
	iters: 600, epoch: 3 | loss: 0.6504409
	speed: 0.0048s/iter; left time: 26.5773s
	iters: 700, epoch: 3 | loss: 1.1210786
	speed: 0.0048s/iter; left time: 26.0540s
	iters: 800, epoch: 3 | loss: 0.4180047
	speed: 0.0048s/iter; left time: 25.4768s
	iters: 900, epoch: 3 | loss: 1.1393886
	speed: 0.0049s/iter; left time: 25.5505s
	iters: 1000, epoch: 3 | loss: 0.3173009
	speed: 0.0048s/iter; left time: 24.7252s
Updating learning rate to 0.0001750695208874025
Epoch: 3 cost time: 4.94814920425415
Epoch: 3, Steps: 1027 | Train Loss: 0.7197167 Vali Loss: 0.3874647 Best vali loss: 0.3809845

best validation loss 0.3809845256430695

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 2, 'learning_rate': 0.0006891207814, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.6140097675e-05
Epoch: 4 cost time: 0.749253511428833
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3620837 Best vali loss: 0.3575385
Updating learning rate to 4.30700488375e-05
Validation loss decreased (0.3575 --> 0.3572).  Saving model state dict ...
Epoch: 5 cost time: 0.44161152839660645
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3571623 Best vali loss: 0.3571623
Updating learning rate to 2.153502441875e-05
Epoch: 6 cost time: 0.4393637180328369
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3591710 Best vali loss: 0.3571623
Updating learning rate to 1.0767512209375e-05
Epoch: 7 cost time: 0.4366426467895508
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3579860 Best vali loss: 0.3571623
Updating learning rate to 5.3837561046875e-06
Epoch: 8 cost time: 0.43769073486328125
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3594086 Best vali loss: 0.3571623

best validation loss 0.3571622747569281

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0013956686424, 'e_layers': 4, 'learning_rate': 0.0002826931348, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002719337680115871
Validation loss decreased (inf --> 0.3865).  Saving model state dict ...
Epoch: 1 cost time: 0.7766320705413818
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3865126 Best vali loss: 0.3865126
Updating learning rate to 0.00024129368370598135
Validation loss decreased (0.3865 --> 0.3719).  Saving model state dict ...
Epoch: 2 cost time: 0.47367215156555176
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3718567 Best vali loss: 0.3718567
Updating learning rate to 0.0001954375569656555
Validation loss decreased (0.3719 --> 0.3708).  Saving model state dict ...
Epoch: 3 cost time: 0.44887733459472656
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3708463 Best vali loss: 0.3708463
Updating learning rate to 0.0001413465674
Epoch: 4 cost time: 0.47897768020629883
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3709851 Best vali loss: 0.3708463
Updating learning rate to 8.725557783434449e-05
Validation loss decreased (0.3708 --> 0.3701).  Saving model state dict ...
Epoch: 5 cost time: 0.46243906021118164
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3700691 Best vali loss: 0.3700691
Updating learning rate to 4.139945109401861e-05
Epoch: 6 cost time: 0.4792160987854004
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3716098 Best vali loss: 0.3700691
Updating learning rate to 1.0759366788412917e-05
Epoch: 7 cost time: 0.4757533073425293
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3709126 Best vali loss: 0.3700691
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45330810546875
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3709359 Best vali loss: 0.3700691

best validation loss 0.37006907036824405

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0023130599568, 'e_layers': 3, 'learning_rate': 0.0001326377102, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4562125
	speed: 0.0105s/iter; left time: 41.9389s
	iters: 200, epoch: 1 | loss: 0.5287532
	speed: 0.0043s/iter; left time: 16.8294s
	iters: 300, epoch: 1 | loss: 0.5778500
	speed: 0.0043s/iter; left time: 16.5031s
	iters: 400, epoch: 1 | loss: 0.6616931
	speed: 0.0043s/iter; left time: 15.9098s
	iters: 500, epoch: 1 | loss: 1.3459096
	speed: 0.0041s/iter; left time: 14.9603s
Updating learning rate to 0.00012758948794647178
Validation loss decreased (inf --> 0.3569).  Saving model state dict ...
Epoch: 1 cost time: 2.549351692199707
Epoch: 1, Steps: 514 | Train Loss: 0.7140837 Vali Loss: 0.3568755 Best vali loss: 0.3568755
	iters: 100, epoch: 2 | loss: 0.9067712
	speed: 0.0086s/iter; left time: 30.0743s
	iters: 200, epoch: 2 | loss: 0.9132993
	speed: 0.0040s/iter; left time: 13.5953s
	iters: 300, epoch: 2 | loss: 0.5221370
	speed: 0.0040s/iter; left time: 13.1796s
	iters: 400, epoch: 2 | loss: 0.8711917
	speed: 0.0039s/iter; left time: 12.4344s
	iters: 500, epoch: 2 | loss: 0.6486557
	speed: 0.0038s/iter; left time: 11.9024s
Updating learning rate to 0.00011321336726173805
Validation loss decreased (0.3569 --> 0.3550).  Saving model state dict ...
Epoch: 2 cost time: 2.0750672817230225
Epoch: 2, Steps: 514 | Train Loss: 0.7724110 Vali Loss: 0.3549931 Best vali loss: 0.3549931
	iters: 100, epoch: 3 | loss: 0.2826349
	speed: 0.0088s/iter; left time: 26.3160s
	iters: 200, epoch: 3 | loss: 0.4393701
	speed: 0.0043s/iter; left time: 12.3742s
	iters: 300, epoch: 3 | loss: 0.5618385
	speed: 0.0043s/iter; left time: 12.0157s
	iters: 400, epoch: 3 | loss: 0.5610855
	speed: 0.0044s/iter; left time: 11.8570s
	iters: 500, epoch: 3 | loss: 0.6576049
	speed: 0.0044s/iter; left time: 11.4220s
Updating learning rate to 9.169798220019104e-05
Validation loss decreased (0.3550 --> 0.3521).  Saving model state dict ...
Epoch: 3 cost time: 2.2761900424957275
Epoch: 3, Steps: 514 | Train Loss: 0.5005068 Vali Loss: 0.3521248 Best vali loss: 0.3521248
	iters: 100, epoch: 4 | loss: 1.0760161
	speed: 0.0091s/iter; left time: 22.4470s
	iters: 200, epoch: 4 | loss: 0.2962367
	speed: 0.0045s/iter; left time: 10.5908s
	iters: 300, epoch: 4 | loss: 0.3083174
	speed: 0.0044s/iter; left time: 9.9102s
	iters: 400, epoch: 4 | loss: 0.4132262
	speed: 0.0043s/iter; left time: 9.2885s
	iters: 500, epoch: 4 | loss: 0.2745632
	speed: 0.0044s/iter; left time: 9.1995s
Updating learning rate to 6.63188551e-05
Epoch: 4 cost time: 2.311199426651001
Epoch: 4, Steps: 514 | Train Loss: 0.4736719 Vali Loss: 0.3580852 Best vali loss: 0.3521248
	iters: 100, epoch: 5 | loss: 0.3635826
	speed: 0.0087s/iter; left time: 17.0114s
	iters: 200, epoch: 5 | loss: 0.4878227
	speed: 0.0043s/iter; left time: 7.9143s
	iters: 300, epoch: 5 | loss: 0.3556111
	speed: 0.0043s/iter; left time: 7.5319s
	iters: 400, epoch: 5 | loss: 0.4893518
	speed: 0.0042s/iter; left time: 7.0417s
	iters: 500, epoch: 5 | loss: 0.2656868
	speed: 0.0040s/iter; left time: 6.2125s
Updating learning rate to 4.0939727999808964e-05
Epoch: 5 cost time: 2.2136762142181396
Epoch: 5, Steps: 514 | Train Loss: 0.3924110 Vali Loss: 0.3686396 Best vali loss: 0.3521248
	iters: 100, epoch: 6 | loss: 1.0421474
	speed: 0.0085s/iter; left time: 12.2795s
	iters: 200, epoch: 6 | loss: 0.4835148
	speed: 0.0040s/iter; left time: 5.3143s
	iters: 300, epoch: 6 | loss: 0.6930635
	speed: 0.0040s/iter; left time: 4.9136s
	iters: 400, epoch: 6 | loss: 0.5272997
	speed: 0.0040s/iter; left time: 4.5310s
	iters: 500, epoch: 6 | loss: 0.7361986
	speed: 0.0039s/iter; left time: 4.0178s
Updating learning rate to 1.9424342938261954e-05
Epoch: 6 cost time: 2.075752019882202
Epoch: 6, Steps: 514 | Train Loss: 0.6964448 Vali Loss: 0.3789080 Best vali loss: 0.3521248
	iters: 100, epoch: 7 | loss: 0.2050133
	speed: 0.0086s/iter; left time: 7.9886s
	iters: 200, epoch: 7 | loss: 0.3249619
	speed: 0.0043s/iter; left time: 3.5565s
	iters: 300, epoch: 7 | loss: 0.5375742
	speed: 0.0042s/iter; left time: 3.0691s
	iters: 400, epoch: 7 | loss: 0.3163687
	speed: 0.0039s/iter; left time: 2.4527s
	iters: 500, epoch: 7 | loss: 0.3367196
	speed: 0.0040s/iter; left time: 2.1252s
Updating learning rate to 5.0482222535282355e-06
Epoch: 7 cost time: 2.1521687507629395
Epoch: 7, Steps: 514 | Train Loss: 0.3441275 Vali Loss: 0.3860089 Best vali loss: 0.3521248
	iters: 100, epoch: 8 | loss: 0.3718492
	speed: 0.0086s/iter; left time: 3.5509s
	iters: 200, epoch: 8 | loss: 0.4283229
	speed: 0.0042s/iter; left time: 1.3246s
	iters: 300, epoch: 8 | loss: 0.4580352
	speed: 0.0040s/iter; left time: 0.8570s
	iters: 400, epoch: 8 | loss: 0.3641475
	speed: 0.0040s/iter; left time: 0.4609s
	iters: 500, epoch: 8 | loss: 0.6139657
	speed: 0.0040s/iter; left time: 0.0603s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1347575187683105
Epoch: 8, Steps: 514 | Train Loss: 0.4472641 Vali Loss: 0.3823919 Best vali loss: 0.3521248

best validation loss 0.3521247954991571

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7501944
	speed: 0.0161s/iter; left time: 15.0293s
Updating learning rate to 0.0003305031342
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.6178367137908936
Epoch: 1, Steps: 129 | Train Loss: 0.7501944 Vali Loss: 0.3673164 Best vali loss: 0.3673164
	iters: 100, epoch: 2 | loss: 0.7127917
	speed: 0.0158s/iter; left time: 12.6814s
Updating learning rate to 0.0001652515671
Validation loss decreased (0.3673 --> 0.3564).  Saving model state dict ...
Epoch: 2 cost time: 1.3039989471435547
Epoch: 2, Steps: 129 | Train Loss: 0.7127917 Vali Loss: 0.3563660 Best vali loss: 0.3563660
	iters: 100, epoch: 3 | loss: 0.4884715
	speed: 0.0160s/iter; left time: 10.7898s
Updating learning rate to 8.262578355e-05
Validation loss decreased (0.3564 --> 0.3520).  Saving model state dict ...
Epoch: 3 cost time: 1.2987852096557617
Epoch: 3, Steps: 129 | Train Loss: 0.4884715 Vali Loss: 0.3519971 Best vali loss: 0.3519971

best validation loss 0.3519971424914999

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0066795951521, 'e_layers': 2, 'learning_rate': 0.0015098986227, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4579000
	speed: 0.0103s/iter; left time: 9.5774s
Updating learning rate to 0.0015098986227
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.8536295890808105
Epoch: 1, Steps: 129 | Train Loss: 0.4579000 Vali Loss: 0.3663361 Best vali loss: 0.3663361
	iters: 100, epoch: 2 | loss: 0.5102022
	speed: 0.0067s/iter; left time: 5.3942s
Updating learning rate to 0.00075494931135
Epoch: 2 cost time: 0.5255136489868164
Epoch: 2, Steps: 129 | Train Loss: 0.5102022 Vali Loss: 0.3682893 Best vali loss: 0.3663361
	iters: 100, epoch: 3 | loss: 0.4713838
	speed: 0.0069s/iter; left time: 4.6695s
Updating learning rate to 0.000377474655675
Epoch: 3 cost time: 0.5652997493743896
Epoch: 3, Steps: 129 | Train Loss: 0.4713838 Vali Loss: 0.3717821 Best vali loss: 0.3663361

best validation loss 0.3663360937170992

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0021972134064, 'e_layers': 2, 'learning_rate': 0.0003946810463, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4268250
	speed: 0.0096s/iter; left time: 38.6517s
	iters: 200, epoch: 1 | loss: 1.0780710
	speed: 0.0035s/iter; left time: 13.8431s
	iters: 300, epoch: 1 | loss: 1.0150516
	speed: 0.0033s/iter; left time: 12.7567s
	iters: 400, epoch: 1 | loss: 0.5023737
	speed: 0.0034s/iter; left time: 12.7299s
	iters: 500, epoch: 1 | loss: 1.1242690
	speed: 0.0035s/iter; left time: 12.8054s
Updating learning rate to 0.00037965939342335473
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 2.1239521503448486
Epoch: 1, Steps: 514 | Train Loss: 0.8293181 Vali Loss: 0.3740396 Best vali loss: 0.3740396
	iters: 100, epoch: 2 | loss: 0.3942453
	speed: 0.0070s/iter; left time: 24.5788s
	iters: 200, epoch: 2 | loss: 0.2586660
	speed: 0.0032s/iter; left time: 10.7664s
	iters: 300, epoch: 2 | loss: 0.4274969
	speed: 0.0031s/iter; left time: 10.2193s
	iters: 400, epoch: 2 | loss: 0.4022414
	speed: 0.0031s/iter; left time: 9.8844s
	iters: 500, epoch: 2 | loss: 0.6089841
	speed: 0.0031s/iter; left time: 9.6899s
Updating learning rate to 0.00033688134527226583
Validation loss decreased (0.3740 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 1.6548562049865723
Epoch: 2, Steps: 514 | Train Loss: 0.4183267 Vali Loss: 0.3637365 Best vali loss: 0.3637365
	iters: 100, epoch: 3 | loss: 0.3737249
	speed: 0.0072s/iter; left time: 21.3561s
	iters: 200, epoch: 3 | loss: 0.8575234
	speed: 0.0032s/iter; left time: 9.2828s
	iters: 300, epoch: 3 | loss: 0.4779082
	speed: 0.0030s/iter; left time: 8.4108s
	iters: 400, epoch: 3 | loss: 0.4594671
	speed: 0.0030s/iter; left time: 8.0914s
	iters: 500, epoch: 3 | loss: 1.0609876
	speed: 0.0030s/iter; left time: 7.7245s
Updating learning rate to 0.0002728594718937645
Epoch: 3 cost time: 1.6350362300872803
Epoch: 3, Steps: 514 | Train Loss: 0.6459222 Vali Loss: 0.3751737 Best vali loss: 0.3637365

best validation loss 0.36373652984444893

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010588855404, 'e_layers': 4, 'learning_rate': 0.0003305031342, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6314269
	speed: 0.0167s/iter; left time: 9.1252s
Updating learning rate to 4.1312891775e-05
Validation loss decreased (0.3520 --> 0.3456).  Saving model state dict ...
Epoch: 4 cost time: 1.6198375225067139
Epoch: 4, Steps: 129 | Train Loss: 0.6314269 Vali Loss: 0.3455818 Best vali loss: 0.3455818
	iters: 100, epoch: 5 | loss: 0.5474237
	speed: 0.0158s/iter; left time: 6.6024s
Updating learning rate to 2.06564458875e-05
Validation loss decreased (0.3456 --> 0.3444).  Saving model state dict ...
Epoch: 5 cost time: 1.2940869331359863
Epoch: 5, Steps: 129 | Train Loss: 0.5474237 Vali Loss: 0.3444231 Best vali loss: 0.3444231
	iters: 100, epoch: 6 | loss: 0.4385930
	speed: 0.0159s/iter; left time: 4.5726s
Updating learning rate to 1.032822294375e-05
Validation loss decreased (0.3444 --> 0.3427).  Saving model state dict ...
Epoch: 6 cost time: 1.308579444885254
Epoch: 6, Steps: 129 | Train Loss: 0.4385930 Vali Loss: 0.3427276 Best vali loss: 0.3427276
	iters: 100, epoch: 7 | loss: 0.7207814
	speed: 0.0159s/iter; left time: 2.5261s
Updating learning rate to 5.164111471875e-06
Epoch: 7 cost time: 1.297447681427002
Epoch: 7, Steps: 129 | Train Loss: 0.7207814 Vali Loss: 0.3440124 Best vali loss: 0.3427276
	iters: 100, epoch: 8 | loss: 0.5802758
	speed: 0.0153s/iter; left time: 0.4581s
Updating learning rate to 2.5820557359375e-06
Epoch: 8 cost time: 1.3022093772888184
Epoch: 8, Steps: 129 | Train Loss: 0.5802758 Vali Loss: 0.3445400 Best vali loss: 0.3427276

best validation loss 0.34272757124572933

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0059147347213, 'e_layers': 2, 'learning_rate': 0.0004084078378, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4268931
	speed: 0.0098s/iter; left time: 39.2542s
	iters: 200, epoch: 1 | loss: 1.0787421
	speed: 0.0036s/iter; left time: 14.0297s
	iters: 300, epoch: 1 | loss: 1.0141286
	speed: 0.0036s/iter; left time: 13.6659s
	iters: 400, epoch: 1 | loss: 0.5038185
	speed: 0.0036s/iter; left time: 13.3815s
	iters: 500, epoch: 1 | loss: 1.1962152
	speed: 0.0034s/iter; left time: 12.3748s
Updating learning rate to 0.0004084078378
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 2.17399263381958
Epoch: 1, Steps: 514 | Train Loss: 0.8439595 Vali Loss: 0.3689602 Best vali loss: 0.3689602
	iters: 100, epoch: 2 | loss: 0.3927503
	speed: 0.0072s/iter; left time: 25.2552s
	iters: 200, epoch: 2 | loss: 0.2594337
	speed: 0.0034s/iter; left time: 11.3991s
	iters: 300, epoch: 2 | loss: 0.5286602
	speed: 0.0035s/iter; left time: 11.4306s
	iters: 400, epoch: 2 | loss: 0.4066942
	speed: 0.0036s/iter; left time: 11.3776s
	iters: 500, epoch: 2 | loss: 0.6356242
	speed: 0.0035s/iter; left time: 10.9374s
Updating learning rate to 0.0002042039189
Epoch: 2 cost time: 1.8118362426757812
Epoch: 2, Steps: 514 | Train Loss: 0.4446325 Vali Loss: 0.3859861 Best vali loss: 0.3689602
	iters: 100, epoch: 3 | loss: 0.3730749
	speed: 0.0071s/iter; left time: 21.2117s
	iters: 200, epoch: 3 | loss: 0.9250946
	speed: 0.0035s/iter; left time: 10.1939s
	iters: 300, epoch: 3 | loss: 0.5259419
	speed: 0.0034s/iter; left time: 9.5253s
	iters: 400, epoch: 3 | loss: 0.4526086
	speed: 0.0036s/iter; left time: 9.5563s
	iters: 500, epoch: 3 | loss: 1.1417481
	speed: 0.0034s/iter; left time: 8.8889s
Updating learning rate to 0.00010210195945
Epoch: 3 cost time: 1.8081583976745605
Epoch: 3, Steps: 514 | Train Loss: 0.6836936 Vali Loss: 0.3825418 Best vali loss: 0.3689602
	iters: 100, epoch: 4 | loss: 0.5996784
	speed: 0.0071s/iter; left time: 17.6441s
	iters: 200, epoch: 4 | loss: 0.4556158
	speed: 0.0035s/iter; left time: 8.3143s
	iters: 300, epoch: 4 | loss: 0.5336776
	speed: 0.0034s/iter; left time: 7.6444s
	iters: 400, epoch: 4 | loss: 0.7063927
	speed: 0.0034s/iter; left time: 7.4729s
	iters: 500, epoch: 4 | loss: 0.7611519
	speed: 0.0035s/iter; left time: 7.2209s
Updating learning rate to 5.1050979725e-05
Validation loss decreased (0.3690 --> 0.3626).  Saving model state dict ...
Epoch: 4 cost time: 1.820237636566162
Epoch: 4, Steps: 514 | Train Loss: 0.6113033 Vali Loss: 0.3625896 Best vali loss: 0.3625896
	iters: 100, epoch: 5 | loss: 0.5654485
	speed: 0.0074s/iter; left time: 14.4428s
	iters: 200, epoch: 5 | loss: 0.8317555
	speed: 0.0034s/iter; left time: 6.3413s
	iters: 300, epoch: 5 | loss: 0.4848456
	speed: 0.0035s/iter; left time: 6.1971s
	iters: 400, epoch: 5 | loss: 0.9107543
	speed: 0.0035s/iter; left time: 5.7175s
	iters: 500, epoch: 5 | loss: 0.5690835
	speed: 0.0036s/iter; left time: 5.5449s
Updating learning rate to 2.55254898625e-05
Validation loss decreased (0.3626 --> 0.3614).  Saving model state dict ...
Epoch: 5 cost time: 1.8370351791381836
Epoch: 5, Steps: 514 | Train Loss: 0.6723775 Vali Loss: 0.3614221 Best vali loss: 0.3614221
	iters: 100, epoch: 6 | loss: 0.2950271
	speed: 0.0073s/iter; left time: 10.4777s
	iters: 200, epoch: 6 | loss: 0.4741536
	speed: 0.0034s/iter; left time: 4.5542s
	iters: 300, epoch: 6 | loss: 0.4111988
	speed: 0.0035s/iter; left time: 4.4024s
	iters: 400, epoch: 6 | loss: 0.7515238
	speed: 0.0035s/iter; left time: 4.0295s
	iters: 500, epoch: 6 | loss: 1.0594848
	speed: 0.0033s/iter; left time: 3.4478s
Updating learning rate to 1.276274493125e-05
Validation loss decreased (0.3614 --> 0.3587).  Saving model state dict ...
Epoch: 6 cost time: 1.801537036895752
Epoch: 6, Steps: 514 | Train Loss: 0.5982776 Vali Loss: 0.3587105 Best vali loss: 0.3587105
	iters: 100, epoch: 7 | loss: 0.4095156
	speed: 0.0076s/iter; left time: 7.0181s
	iters: 200, epoch: 7 | loss: 0.3122271
	speed: 0.0031s/iter; left time: 2.5541s
	iters: 300, epoch: 7 | loss: 0.3880410
	speed: 0.0031s/iter; left time: 2.2634s
	iters: 400, epoch: 7 | loss: 0.4122879
	speed: 0.0030s/iter; left time: 1.8938s
	iters: 500, epoch: 7 | loss: 0.8316844
	speed: 0.0030s/iter; left time: 1.5964s
Updating learning rate to 6.381372465625e-06
Validation loss decreased (0.3587 --> 0.3554).  Saving model state dict ...
Epoch: 7 cost time: 1.642491102218628
Epoch: 7, Steps: 514 | Train Loss: 0.4707512 Vali Loss: 0.3554271 Best vali loss: 0.3554271
	iters: 100, epoch: 8 | loss: 0.3769851
	speed: 0.0070s/iter; left time: 2.8930s
	iters: 200, epoch: 8 | loss: 0.2335671
	speed: 0.0031s/iter; left time: 0.9691s
	iters: 300, epoch: 8 | loss: 0.3920162
	speed: 0.0031s/iter; left time: 0.6664s
	iters: 400, epoch: 8 | loss: 0.4338745
	speed: 0.0030s/iter; left time: 0.3467s
	iters: 500, epoch: 8 | loss: 0.2722288
	speed: 0.0032s/iter; left time: 0.0475s
Updating learning rate to 3.1906862328125e-06
Epoch: 8 cost time: 1.6302285194396973
Epoch: 8, Steps: 514 | Train Loss: 0.3417343 Vali Loss: 0.3561760 Best vali loss: 0.3554271

best validation loss 0.355427058980835

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0060447792735, 'e_layers': 2, 'learning_rate': 0.0004086302122, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4269440
	speed: 0.0095s/iter; left time: 37.9621s
	iters: 200, epoch: 1 | loss: 1.0788314
	speed: 0.0032s/iter; left time: 12.4235s
	iters: 300, epoch: 1 | loss: 1.0142959
	speed: 0.0032s/iter; left time: 12.1095s
	iters: 400, epoch: 1 | loss: 0.5043557
	speed: 0.0031s/iter; left time: 11.4173s
	iters: 500, epoch: 1 | loss: 1.1400418
	speed: 0.0031s/iter; left time: 11.1042s
Updating learning rate to 0.0004086302122
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.9659888744354248
Epoch: 1, Steps: 514 | Train Loss: 0.8328938 Vali Loss: 0.3673154 Best vali loss: 0.3673154
	iters: 100, epoch: 2 | loss: 0.3861248
	speed: 0.0069s/iter; left time: 24.3095s
	iters: 200, epoch: 2 | loss: 0.2809049
	speed: 0.0031s/iter; left time: 10.6007s
	iters: 300, epoch: 2 | loss: 0.4953952
	speed: 0.0030s/iter; left time: 9.9408s
	iters: 400, epoch: 2 | loss: 0.4000919
	speed: 0.0031s/iter; left time: 9.8063s
	iters: 500, epoch: 2 | loss: 0.6002491
	speed: 0.0031s/iter; left time: 9.5977s
Updating learning rate to 0.0002043151061
Validation loss decreased (0.3673 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 1.6290006637573242
Epoch: 2, Steps: 514 | Train Loss: 0.4325532 Vali Loss: 0.3623211 Best vali loss: 0.3623211
	iters: 100, epoch: 3 | loss: 0.3698901
	speed: 0.0075s/iter; left time: 22.3874s
	iters: 200, epoch: 3 | loss: 0.9034276
	speed: 0.0037s/iter; left time: 10.5766s
	iters: 300, epoch: 3 | loss: 0.4941323
	speed: 0.0036s/iter; left time: 10.0025s
	iters: 400, epoch: 3 | loss: 0.4437609
	speed: 0.0033s/iter; left time: 8.8089s
	iters: 500, epoch: 3 | loss: 1.0517979
	speed: 0.0033s/iter; left time: 8.5345s
Updating learning rate to 0.00010215755305
Validation loss decreased (0.3623 --> 0.3553).  Saving model state dict ...
Epoch: 3 cost time: 1.8404655456542969
Epoch: 3, Steps: 514 | Train Loss: 0.6526017 Vali Loss: 0.3553241 Best vali loss: 0.3553241
	iters: 100, epoch: 4 | loss: 0.5401134
	speed: 0.0078s/iter; left time: 19.1965s
	iters: 200, epoch: 4 | loss: 0.4421348
	speed: 0.0033s/iter; left time: 7.7942s
	iters: 300, epoch: 4 | loss: 0.4828644
	speed: 0.0032s/iter; left time: 7.2499s
	iters: 400, epoch: 4 | loss: 0.6931222
	speed: 0.0034s/iter; left time: 7.2739s
	iters: 500, epoch: 4 | loss: 0.7125528
	speed: 0.0032s/iter; left time: 6.5867s
Updating learning rate to 5.1078776525e-05
Validation loss decreased (0.3553 --> 0.3433).  Saving model state dict ...
Epoch: 4 cost time: 1.7303345203399658
Epoch: 4, Steps: 514 | Train Loss: 0.5741575 Vali Loss: 0.3432751 Best vali loss: 0.3432751
	iters: 100, epoch: 5 | loss: 0.5409623
	speed: 0.0076s/iter; left time: 14.9097s
	iters: 200, epoch: 5 | loss: 0.7449445
	speed: 0.0036s/iter; left time: 6.6634s
	iters: 300, epoch: 5 | loss: 0.4813525
	speed: 0.0035s/iter; left time: 6.2150s
	iters: 400, epoch: 5 | loss: 0.8127463
	speed: 0.0035s/iter; left time: 5.8497s
	iters: 500, epoch: 5 | loss: 0.5465621
	speed: 0.0036s/iter; left time: 5.5898s
Updating learning rate to 2.55393882625e-05
Epoch: 5 cost time: 1.8805232048034668
Epoch: 5, Steps: 514 | Train Loss: 0.6253136 Vali Loss: 0.3458891 Best vali loss: 0.3432751
	iters: 100, epoch: 6 | loss: 0.2943276
	speed: 0.0074s/iter; left time: 10.7080s
	iters: 200, epoch: 6 | loss: 0.4718611
	speed: 0.0035s/iter; left time: 4.7320s
	iters: 300, epoch: 6 | loss: 0.3501491
	speed: 0.0035s/iter; left time: 4.4073s
	iters: 400, epoch: 6 | loss: 0.7365925
	speed: 0.0035s/iter; left time: 3.9942s
	iters: 500, epoch: 6 | loss: 0.9472115
	speed: 0.0035s/iter; left time: 3.6002s
Updating learning rate to 1.276969413125e-05
Validation loss decreased (0.3433 --> 0.3424).  Saving model state dict ...
Epoch: 6 cost time: 1.844813585281372
Epoch: 6, Steps: 514 | Train Loss: 0.5600284 Vali Loss: 0.3424483 Best vali loss: 0.3424483
	iters: 100, epoch: 7 | loss: 0.3842611
	speed: 0.0072s/iter; left time: 6.7006s
	iters: 200, epoch: 7 | loss: 0.2935809
	speed: 0.0032s/iter; left time: 2.6245s
	iters: 300, epoch: 7 | loss: 0.3548188
	speed: 0.0033s/iter; left time: 2.4357s
	iters: 400, epoch: 7 | loss: 0.4140569
	speed: 0.0033s/iter; left time: 2.1022s
	iters: 500, epoch: 7 | loss: 0.8011947
	speed: 0.0032s/iter; left time: 1.6932s
Updating learning rate to 6.384847065625e-06
Validation loss decreased (0.3424 --> 0.3413).  Saving model state dict ...
Epoch: 7 cost time: 1.6997263431549072
Epoch: 7, Steps: 514 | Train Loss: 0.4495825 Vali Loss: 0.3413099 Best vali loss: 0.3413099
	iters: 100, epoch: 8 | loss: 0.3770830
	speed: 0.0072s/iter; left time: 2.9842s
	iters: 200, epoch: 8 | loss: 0.2384859
	speed: 0.0032s/iter; left time: 1.0183s
	iters: 300, epoch: 8 | loss: 0.3680468
	speed: 0.0033s/iter; left time: 0.7081s
	iters: 400, epoch: 8 | loss: 0.4439459
	speed: 0.0032s/iter; left time: 0.3726s
	iters: 500, epoch: 8 | loss: 0.2514094
	speed: 0.0032s/iter; left time: 0.0479s
Updating learning rate to 3.1924235328125e-06
Epoch: 8 cost time: 1.7064707279205322
Epoch: 8, Steps: 514 | Train Loss: 0.3357942 Vali Loss: 0.3423032 Best vali loss: 0.3413099

best validation loss 0.3413098812630228

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.002183675184, 'e_layers': 3, 'learning_rate': 0.0003977955532, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8379959
	speed: 0.0099s/iter; left time: 39.7794s
	iters: 200, epoch: 1 | loss: 0.5749793
	speed: 0.0045s/iter; left time: 17.6596s
	iters: 300, epoch: 1 | loss: 0.3144924
	speed: 0.0045s/iter; left time: 17.1085s
	iters: 400, epoch: 1 | loss: 0.4552718
	speed: 0.0045s/iter; left time: 16.6343s
	iters: 500, epoch: 1 | loss: 0.5221874
	speed: 0.0044s/iter; left time: 16.0073s
Updating learning rate to 0.00038265536146274236
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 2.645470142364502
Epoch: 1, Steps: 514 | Train Loss: 0.5409854 Vali Loss: 0.3697173 Best vali loss: 0.3697173
	iters: 100, epoch: 2 | loss: 0.5891725
	speed: 0.0088s/iter; left time: 30.8266s
	iters: 200, epoch: 2 | loss: 0.6423114
	speed: 0.0045s/iter; left time: 15.1726s
	iters: 300, epoch: 2 | loss: 0.6381209
	speed: 0.0045s/iter; left time: 14.8442s
	iters: 400, epoch: 2 | loss: 0.9644150
	speed: 0.0043s/iter; left time: 13.8384s
	iters: 500, epoch: 2 | loss: 0.2418804
	speed: 0.0044s/iter; left time: 13.6994s
Updating learning rate to 0.000339539743196787
Validation loss decreased (0.3697 --> 0.3656).  Saving model state dict ...
Epoch: 2 cost time: 2.3099353313446045
Epoch: 2, Steps: 514 | Train Loss: 0.6151800 Vali Loss: 0.3656078 Best vali loss: 0.3656078
	iters: 100, epoch: 3 | loss: 0.7037179
	speed: 0.0086s/iter; left time: 25.6971s
	iters: 200, epoch: 3 | loss: 0.8605086
	speed: 0.0039s/iter; left time: 11.2056s
	iters: 300, epoch: 3 | loss: 0.4916302
	speed: 0.0038s/iter; left time: 10.6455s
	iters: 400, epoch: 3 | loss: 0.2482337
	speed: 0.0040s/iter; left time: 10.6170s
	iters: 500, epoch: 3 | loss: 0.7525979
	speed: 0.0041s/iter; left time: 10.4780s
Updating learning rate to 0.0002750126604390729
Epoch: 3 cost time: 2.0901901721954346
Epoch: 3, Steps: 514 | Train Loss: 0.6113376 Vali Loss: 0.3748819 Best vali loss: 0.3656078

best validation loss 0.36560777641818193

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013585056304, 'e_layers': 4, 'learning_rate': 0.0004708309519, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7707244
	speed: 0.0107s/iter; left time: 42.9945s
	iters: 200, epoch: 1 | loss: 0.5944350
	speed: 0.0052s/iter; left time: 20.2897s
	iters: 300, epoch: 1 | loss: 1.2410201
	speed: 0.0052s/iter; left time: 19.7218s
	iters: 400, epoch: 1 | loss: 0.7450095
	speed: 0.0052s/iter; left time: 19.2806s
	iters: 500, epoch: 1 | loss: 0.7877299
	speed: 0.0048s/iter; left time: 17.3745s
Updating learning rate to 0.0004529110158166081
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 2.9677815437316895
Epoch: 1, Steps: 514 | Train Loss: 0.8277838 Vali Loss: 0.3675297 Best vali loss: 0.3675297
	iters: 100, epoch: 2 | loss: 0.3574456
	speed: 0.0097s/iter; left time: 33.9074s
	iters: 200, epoch: 2 | loss: 0.2268946
	speed: 0.0052s/iter; left time: 17.5148s
	iters: 300, epoch: 2 | loss: 0.3105408
	speed: 0.0054s/iter; left time: 17.7171s
	iters: 400, epoch: 2 | loss: 0.6514533
	speed: 0.0053s/iter; left time: 16.8047s
	iters: 500, epoch: 2 | loss: 0.3977327
	speed: 0.0052s/iter; left time: 16.0286s
Updating learning rate to 0.0004018793553905036
Epoch: 2 cost time: 2.684979200363159
Epoch: 2, Steps: 514 | Train Loss: 0.3888134 Vali Loss: 0.3712519 Best vali loss: 0.3675297
	iters: 100, epoch: 3 | loss: 0.4837764
	speed: 0.0102s/iter; left time: 30.3327s
	iters: 200, epoch: 3 | loss: 0.5807581
	speed: 0.0051s/iter; left time: 14.5761s
	iters: 300, epoch: 3 | loss: 0.4416069
	speed: 0.0051s/iter; left time: 14.1031s
	iters: 400, epoch: 3 | loss: 0.3589027
	speed: 0.0051s/iter; left time: 13.6404s
	iters: 500, epoch: 3 | loss: 0.8404270
	speed: 0.0050s/iter; left time: 13.0441s
Updating learning rate to 0.0003255050783184073
Epoch: 3 cost time: 2.6520488262176514
Epoch: 3, Steps: 514 | Train Loss: 0.5410942 Vali Loss: 0.3792220 Best vali loss: 0.3675297

best validation loss 0.36752973227580543

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0117873952936, 'e_layers': 4, 'learning_rate': 0.0001196892752, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7120651
	speed: 0.0110s/iter; left time: 10.2573s
Updating learning rate to 0.0001196892752
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 1.0666437149047852
Epoch: 1, Steps: 129 | Train Loss: 0.7120651 Vali Loss: 0.3775048 Best vali loss: 0.3775048
	iters: 100, epoch: 2 | loss: 0.4614699
	speed: 0.0093s/iter; left time: 7.5148s
Updating learning rate to 5.98446376e-05
Validation loss decreased (0.3775 --> 0.3681).  Saving model state dict ...
Epoch: 2 cost time: 0.7851626873016357
Epoch: 2, Steps: 129 | Train Loss: 0.4614699 Vali Loss: 0.3681466 Best vali loss: 0.3681466
	iters: 100, epoch: 3 | loss: 0.8364522
	speed: 0.0095s/iter; left time: 6.4143s
Updating learning rate to 2.99223188e-05
Validation loss decreased (0.3681 --> 0.3635).  Saving model state dict ...
Epoch: 3 cost time: 0.7894151210784912
Epoch: 3, Steps: 129 | Train Loss: 0.8364522 Vali Loss: 0.3635349 Best vali loss: 0.3635349

best validation loss 0.3635348583602718

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0117873952936, 'e_layers': 4, 'learning_rate': 0.0001196892752, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6705745
	speed: 0.0115s/iter; left time: 6.2721s
Updating learning rate to 1.49611594e-05
Epoch: 4 cost time: 1.0981519222259521
Epoch: 4, Steps: 129 | Train Loss: 0.6705745 Vali Loss: 0.3637029 Best vali loss: 0.3635349
	iters: 100, epoch: 5 | loss: 0.4598090
	speed: 0.0094s/iter; left time: 3.9396s
Updating learning rate to 7.4805797e-06
Epoch: 5 cost time: 0.8001952171325684
Epoch: 5, Steps: 129 | Train Loss: 0.4598090 Vali Loss: 0.3636299 Best vali loss: 0.3635349
	iters: 100, epoch: 6 | loss: 0.8306440
	speed: 0.0093s/iter; left time: 2.6899s
Updating learning rate to 3.74028985e-06
Validation loss decreased (0.3635 --> 0.3634).  Saving model state dict ...
Epoch: 6 cost time: 0.7596883773803711
Epoch: 6, Steps: 129 | Train Loss: 0.8306440 Vali Loss: 0.3633903 Best vali loss: 0.3633903
	iters: 100, epoch: 7 | loss: 0.6512519
	speed: 0.0098s/iter; left time: 1.5547s
Updating learning rate to 1.870144925e-06
Epoch: 7 cost time: 0.803272008895874
Epoch: 7, Steps: 129 | Train Loss: 0.6512519 Vali Loss: 0.3633951 Best vali loss: 0.3633903
	iters: 100, epoch: 8 | loss: 0.5933102
	speed: 0.0096s/iter; left time: 0.2884s
Updating learning rate to 9.350724625e-07
Validation loss decreased (0.3634 --> 0.3634).  Saving model state dict ...
Epoch: 8 cost time: 0.8106200695037842
Epoch: 8, Steps: 129 | Train Loss: 0.5933102 Vali Loss: 0.3633577 Best vali loss: 0.3633577

best validation loss 0.36335771387124577

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022141703144, 'e_layers': 3, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 0.9280641078948975
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732496 Best vali loss: 0.3732496
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3732 --> 0.3621).  Saving model state dict ...
Epoch: 2 cost time: 0.6207807064056396
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3621322 Best vali loss: 0.3621322
Updating learning rate to 0.000176760745025
Epoch: 3 cost time: 0.6118812561035156
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3637745 Best vali loss: 0.3621322
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3621 --> 0.3557).  Saving model state dict ...
Epoch: 4 cost time: 0.6059525012969971
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3556888 Best vali loss: 0.3556888
Updating learning rate to 4.419018625625e-05
Validation loss decreased (0.3557 --> 0.3482).  Saving model state dict ...
Epoch: 5 cost time: 0.6108987331390381
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3482237 Best vali loss: 0.3482237
Updating learning rate to 2.2095093128125e-05
Epoch: 6 cost time: 0.6078364849090576
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3513002 Best vali loss: 0.3482237
Updating learning rate to 1.10475465640625e-05
Epoch: 7 cost time: 0.6058547496795654
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3494146 Best vali loss: 0.3482237
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.6065926551818848
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3500846 Best vali loss: 0.3482237

best validation loss 0.3482236649292157

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 3, 'learning_rate': 0.0007070429801, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070429801
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 0.9276235103607178
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732496 Best vali loss: 0.3732496
Updating learning rate to 0.00035352149005
Validation loss decreased (0.3732 --> 0.3621).  Saving model state dict ...
Epoch: 2 cost time: 0.6137690544128418
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3621322 Best vali loss: 0.3621322
Updating learning rate to 0.000176760745025
Epoch: 3 cost time: 0.6156244277954102
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3637745 Best vali loss: 0.3621322
Updating learning rate to 8.83803725125e-05
Validation loss decreased (0.3621 --> 0.3557).  Saving model state dict ...
Epoch: 4 cost time: 0.6049623489379883
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3556888 Best vali loss: 0.3556888
Updating learning rate to 4.419018625625e-05
Validation loss decreased (0.3557 --> 0.3482).  Saving model state dict ...
Epoch: 5 cost time: 0.6119577884674072
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3482237 Best vali loss: 0.3482237
Updating learning rate to 2.2095093128125e-05
Epoch: 6 cost time: 0.6076393127441406
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3513002 Best vali loss: 0.3482237
Updating learning rate to 1.10475465640625e-05
Epoch: 7 cost time: 0.6054513454437256
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3494146 Best vali loss: 0.3482237
Updating learning rate to 5.52377328203125e-06
Epoch: 8 cost time: 0.6062698364257812
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3500846 Best vali loss: 0.3482237

best validation loss 0.3482236649292157

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0030442223278, 'e_layers': 1, 'learning_rate': 0.0002101326502, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7978767
	speed: 0.0076s/iter; left time: 62.0843s
	iters: 200, epoch: 1 | loss: 0.3794928
	speed: 0.0022s/iter; left time: 17.6779s
	iters: 300, epoch: 1 | loss: 0.3201355
	speed: 0.0022s/iter; left time: 17.2927s
	iters: 400, epoch: 1 | loss: 0.4928983
	speed: 0.0022s/iter; left time: 17.1353s
	iters: 500, epoch: 1 | loss: 1.4922750
	speed: 0.0022s/iter; left time: 16.7071s
	iters: 600, epoch: 1 | loss: 0.4943071
	speed: 0.0022s/iter; left time: 16.5746s
	iters: 700, epoch: 1 | loss: 0.5878769
	speed: 0.0022s/iter; left time: 16.3928s
	iters: 800, epoch: 1 | loss: 0.8315934
	speed: 0.0023s/iter; left time: 17.1317s
	iters: 900, epoch: 1 | loss: 0.5288545
	speed: 0.0023s/iter; left time: 16.9485s
	iters: 1000, epoch: 1 | loss: 0.8431755
	speed: 0.0023s/iter; left time: 16.8928s
Updating learning rate to 0.00020213495241606686
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 2.6366968154907227
Epoch: 1, Steps: 1027 | Train Loss: 0.6768486 Vali Loss: 0.3716453 Best vali loss: 0.3716453
	iters: 100, epoch: 2 | loss: 0.8792203
	speed: 0.0073s/iter; left time: 51.8184s
	iters: 200, epoch: 2 | loss: 0.5110465
	speed: 0.0021s/iter; left time: 14.4940s
	iters: 300, epoch: 2 | loss: 0.4572074
	speed: 0.0021s/iter; left time: 14.2030s
	iters: 400, epoch: 2 | loss: 1.1520070
	speed: 0.0021s/iter; left time: 13.9493s
	iters: 500, epoch: 2 | loss: 1.2630377
	speed: 0.0021s/iter; left time: 13.8158s
	iters: 600, epoch: 2 | loss: 0.7059167
	speed: 0.0021s/iter; left time: 13.5231s
	iters: 700, epoch: 2 | loss: 0.7700750
	speed: 0.0020s/iter; left time: 13.2842s
	iters: 800, epoch: 2 | loss: 0.4401639
	speed: 0.0020s/iter; left time: 13.0928s
	iters: 900, epoch: 2 | loss: 0.2722055
	speed: 0.0021s/iter; left time: 12.9445s
	iters: 1000, epoch: 2 | loss: 0.4425085
	speed: 0.0021s/iter; left time: 12.7561s
Updating learning rate to 0.00017935943605256035
Validation loss decreased (0.3716 --> 0.3689).  Saving model state dict ...
Epoch: 2 cost time: 2.1610422134399414
Epoch: 2, Steps: 1027 | Train Loss: 0.6893388 Vali Loss: 0.3688754 Best vali loss: 0.3688754
	iters: 100, epoch: 3 | loss: 0.3742861
	speed: 0.0068s/iter; left time: 41.3165s
	iters: 200, epoch: 3 | loss: 0.5573456
	speed: 0.0021s/iter; left time: 12.3573s
	iters: 300, epoch: 3 | loss: 0.2122637
	speed: 0.0025s/iter; left time: 14.3834s
	iters: 400, epoch: 3 | loss: 0.4320181
	speed: 0.0024s/iter; left time: 14.1188s
	iters: 500, epoch: 3 | loss: 0.4988534
	speed: 0.0024s/iter; left time: 13.8707s
	iters: 600, epoch: 3 | loss: 0.4916808
	speed: 0.0025s/iter; left time: 13.6428s
	iters: 700, epoch: 3 | loss: 0.5970352
	speed: 0.0025s/iter; left time: 13.4816s
	iters: 800, epoch: 3 | loss: 0.4047151
	speed: 0.0025s/iter; left time: 13.3429s
	iters: 900, epoch: 3 | loss: 0.4859445
	speed: 0.0025s/iter; left time: 12.9475s
	iters: 1000, epoch: 3 | loss: 0.5214494
	speed: 0.0024s/iter; left time: 12.6130s
Updating learning rate to 0.0001452734670152544
Epoch: 3 cost time: 2.4828288555145264
Epoch: 3, Steps: 1027 | Train Loss: 0.4575592 Vali Loss: 0.3711399 Best vali loss: 0.3688754

best validation loss 0.3688753848108655

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029417030217, 'e_layers': 2, 'learning_rate': 0.0002487338462, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3011516
	speed: 0.0084s/iter; left time: 68.4875s
	iters: 200, epoch: 1 | loss: 0.3828082
	speed: 0.0030s/iter; left time: 24.1164s
	iters: 300, epoch: 1 | loss: 0.2475680
	speed: 0.0030s/iter; left time: 23.8201s
	iters: 400, epoch: 1 | loss: 0.3962719
	speed: 0.0030s/iter; left time: 23.8304s
	iters: 500, epoch: 1 | loss: 1.7063602
	speed: 0.0031s/iter; left time: 23.8197s
	iters: 600, epoch: 1 | loss: 0.6218513
	speed: 0.0030s/iter; left time: 23.0509s
	iters: 700, epoch: 1 | loss: 0.7857112
	speed: 0.0030s/iter; left time: 22.8349s
	iters: 800, epoch: 1 | loss: 0.5213913
	speed: 0.0030s/iter; left time: 22.5506s
	iters: 900, epoch: 1 | loss: 0.3895868
	speed: 0.0030s/iter; left time: 21.8523s
	iters: 1000, epoch: 1 | loss: 0.9785623
	speed: 0.0030s/iter; left time: 21.4226s
Updating learning rate to 0.00023926697787349515
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 3.455366611480713
Epoch: 1, Steps: 1027 | Train Loss: 0.6331263 Vali Loss: 0.3673507 Best vali loss: 0.3673507
	iters: 100, epoch: 2 | loss: 0.2012534
	speed: 0.0094s/iter; left time: 66.9513s
	iters: 200, epoch: 2 | loss: 1.1934389
	speed: 0.0032s/iter; left time: 22.5129s
	iters: 300, epoch: 2 | loss: 0.3772761
	speed: 0.0032s/iter; left time: 22.2178s
	iters: 400, epoch: 2 | loss: 0.3233792
	speed: 0.0032s/iter; left time: 21.9138s
	iters: 500, epoch: 2 | loss: 0.3877909
	speed: 0.0033s/iter; left time: 21.8557s
	iters: 600, epoch: 2 | loss: 0.2212565
	speed: 0.0033s/iter; left time: 21.4709s
	iters: 700, epoch: 2 | loss: 0.3760493
	speed: 0.0033s/iter; left time: 21.1845s
	iters: 800, epoch: 2 | loss: 0.2231646
	speed: 0.0033s/iter; left time: 20.7933s
	iters: 900, epoch: 2 | loss: 0.5505332
	speed: 0.0033s/iter; left time: 20.7764s
	iters: 1000, epoch: 2 | loss: 0.5137273
	speed: 0.0033s/iter; left time: 20.5955s
Updating learning rate to 0.00021230761777931586
Epoch: 2 cost time: 3.3903374671936035
Epoch: 2, Steps: 1027 | Train Loss: 0.4367869 Vali Loss: 0.3684688 Best vali loss: 0.3673507
	iters: 100, epoch: 3 | loss: 0.8177616
	speed: 0.0093s/iter; left time: 56.2311s
	iters: 200, epoch: 3 | loss: 0.3214690
	speed: 0.0030s/iter; left time: 17.8283s
	iters: 300, epoch: 3 | loss: 0.4727511
	speed: 0.0030s/iter; left time: 17.5181s
	iters: 400, epoch: 3 | loss: 0.9256818
	speed: 0.0030s/iter; left time: 17.2536s
	iters: 500, epoch: 3 | loss: 0.2122679
	speed: 0.0030s/iter; left time: 16.9113s
	iters: 600, epoch: 3 | loss: 0.5125691
	speed: 0.0030s/iter; left time: 16.4887s
	iters: 700, epoch: 3 | loss: 0.2401346
	speed: 0.0031s/iter; left time: 16.8998s
	iters: 800, epoch: 3 | loss: 0.6274424
	speed: 0.0032s/iter; left time: 16.9424s
	iters: 900, epoch: 3 | loss: 0.3788969
	speed: 0.0032s/iter; left time: 16.5797s
	iters: 1000, epoch: 3 | loss: 0.7558630
	speed: 0.0031s/iter; left time: 15.8601s
Updating learning rate to 0.00017196008410459316
Validation loss decreased (0.3674 --> 0.3596).  Saving model state dict ...
Epoch: 3 cost time: 3.172917366027832
Epoch: 3, Steps: 1027 | Train Loss: 0.5264837 Vali Loss: 0.3595924 Best vali loss: 0.3595924

best validation loss 0.35959240052929564

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0026677249219, 'e_layers': 2, 'learning_rate': 0.0002484617788, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3010326
	speed: 0.0085s/iter; left time: 69.0950s
	iters: 200, epoch: 1 | loss: 0.3827993
	speed: 0.0032s/iter; left time: 26.0487s
	iters: 300, epoch: 1 | loss: 0.2474592
	speed: 0.0033s/iter; left time: 26.1139s
	iters: 400, epoch: 1 | loss: 0.3948081
	speed: 0.0033s/iter; left time: 25.6020s
	iters: 500, epoch: 1 | loss: 1.7061703
	speed: 0.0032s/iter; left time: 24.9719s
	iters: 600, epoch: 1 | loss: 0.6220528
	speed: 0.0032s/iter; left time: 24.6821s
	iters: 700, epoch: 1 | loss: 0.7847800
	speed: 0.0032s/iter; left time: 24.4030s
	iters: 800, epoch: 1 | loss: 0.5213947
	speed: 0.0033s/iter; left time: 24.2266s
	iters: 900, epoch: 1 | loss: 0.3903358
	speed: 0.0033s/iter; left time: 24.4197s
	iters: 1000, epoch: 1 | loss: 1.0028167
	speed: 0.0032s/iter; left time: 23.3155s
Updating learning rate to 0.0002390052654223334
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 3.6859488487243652
Epoch: 1, Steps: 1027 | Train Loss: 0.6353649 Vali Loss: 0.3675850 Best vali loss: 0.3675850
	iters: 100, epoch: 2 | loss: 0.2024255
	speed: 0.0093s/iter; left time: 66.1308s
	iters: 200, epoch: 2 | loss: 1.1891540
	speed: 0.0033s/iter; left time: 23.0870s
	iters: 300, epoch: 2 | loss: 0.3768874
	speed: 0.0034s/iter; left time: 23.4184s
	iters: 400, epoch: 2 | loss: 0.3236614
	speed: 0.0033s/iter; left time: 22.6618s
	iters: 500, epoch: 2 | loss: 0.3879355
	speed: 0.0034s/iter; left time: 22.7654s
	iters: 600, epoch: 2 | loss: 0.2256938
	speed: 0.0033s/iter; left time: 21.8183s
	iters: 700, epoch: 2 | loss: 0.3783660
	speed: 0.0031s/iter; left time: 20.4414s
	iters: 800, epoch: 2 | loss: 0.2250428
	speed: 0.0030s/iter; left time: 18.9397s
	iters: 900, epoch: 2 | loss: 0.5548872
	speed: 0.0030s/iter; left time: 18.7044s
	iters: 1000, epoch: 2 | loss: 0.5143563
	speed: 0.0030s/iter; left time: 18.5037s
Updating learning rate to 0.000212075393727576
Epoch: 2 cost time: 3.3364222049713135
Epoch: 2, Steps: 1027 | Train Loss: 0.4378410 Vali Loss: 0.3703334 Best vali loss: 0.3675850
	iters: 100, epoch: 3 | loss: 0.8281292
	speed: 0.0092s/iter; left time: 55.6298s
	iters: 200, epoch: 3 | loss: 0.3279667
	speed: 0.0031s/iter; left time: 18.6977s
	iters: 300, epoch: 3 | loss: 0.4683464
	speed: 0.0032s/iter; left time: 18.4791s
	iters: 400, epoch: 3 | loss: 1.0278778
	speed: 0.0032s/iter; left time: 18.2591s
	iters: 500, epoch: 3 | loss: 0.2277882
	speed: 0.0031s/iter; left time: 17.8195s
	iters: 600, epoch: 3 | loss: 0.5158954
	speed: 0.0031s/iter; left time: 17.4435s
	iters: 700, epoch: 3 | loss: 0.2445300
	speed: 0.0031s/iter; left time: 17.1398s
	iters: 800, epoch: 3 | loss: 0.6348037
	speed: 0.0031s/iter; left time: 16.7867s
	iters: 900, epoch: 3 | loss: 0.3872866
	speed: 0.0031s/iter; left time: 16.3024s
	iters: 1000, epoch: 3 | loss: 0.7504400
	speed: 0.0031s/iter; left time: 15.9549s
Updating learning rate to 0.00017177199256135988
Validation loss decreased (0.3676 --> 0.3625).  Saving model state dict ...
Epoch: 3 cost time: 3.2575008869171143
Epoch: 3, Steps: 1027 | Train Loss: 0.5413064 Vali Loss: 0.3624849 Best vali loss: 0.3624849

best validation loss 0.3624848578966905

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029417030217, 'e_layers': 2, 'learning_rate': 0.0002487338462, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2815078
	speed: 0.0086s/iter; left time: 43.4752s
	iters: 200, epoch: 4 | loss: 0.3810373
	speed: 0.0031s/iter; left time: 15.2010s
	iters: 300, epoch: 4 | loss: 0.3078879
	speed: 0.0031s/iter; left time: 15.0616s
	iters: 400, epoch: 4 | loss: 0.2888646
	speed: 0.0031s/iter; left time: 14.6822s
	iters: 500, epoch: 4 | loss: 1.4378150
	speed: 0.0031s/iter; left time: 14.3695s
	iters: 600, epoch: 4 | loss: 0.5080084
	speed: 0.0031s/iter; left time: 14.0028s
	iters: 700, epoch: 4 | loss: 0.5981141
	speed: 0.0031s/iter; left time: 13.7802s
	iters: 800, epoch: 4 | loss: 0.4430766
	speed: 0.0031s/iter; left time: 13.3771s
	iters: 900, epoch: 4 | loss: 0.3502952
	speed: 0.0031s/iter; left time: 12.9779s
	iters: 1000, epoch: 4 | loss: 0.4614326
	speed: 0.0029s/iter; left time: 12.0981s
Updating learning rate to 0.0001243669231
Validation loss decreased (0.3596 --> 0.3520).  Saving model state dict ...
Epoch: 4 cost time: 3.494577407836914
Epoch: 4, Steps: 1027 | Train Loss: 0.5058040 Vali Loss: 0.3520395 Best vali loss: 0.3520395
	iters: 100, epoch: 5 | loss: 0.1763011
	speed: 0.0092s/iter; left time: 36.8228s
	iters: 200, epoch: 5 | loss: 0.7822424
	speed: 0.0032s/iter; left time: 12.4172s
	iters: 300, epoch: 5 | loss: 0.2632716
	speed: 0.0031s/iter; left time: 11.9295s
	iters: 400, epoch: 5 | loss: 0.3498441
	speed: 0.0030s/iter; left time: 11.2933s
	iters: 500, epoch: 5 | loss: 0.4045641
	speed: 0.0031s/iter; left time: 11.2577s
	iters: 600, epoch: 5 | loss: 0.1998188
	speed: 0.0031s/iter; left time: 10.9356s
	iters: 700, epoch: 5 | loss: 0.3821832
	speed: 0.0033s/iter; left time: 11.2628s
	iters: 800, epoch: 5 | loss: 0.1864746
	speed: 0.0033s/iter; left time: 11.0405s
	iters: 900, epoch: 5 | loss: 0.4401072
	speed: 0.0032s/iter; left time: 10.4290s
	iters: 1000, epoch: 5 | loss: 0.5160856
	speed: 0.0033s/iter; left time: 10.1058s
Updating learning rate to 7.677376209540683e-05
Epoch: 5 cost time: 3.3195152282714844
Epoch: 5, Steps: 1027 | Train Loss: 0.3700893 Vali Loss: 0.3520592 Best vali loss: 0.3520395
	iters: 100, epoch: 6 | loss: 0.6931137
	speed: 0.0093s/iter; left time: 27.6696s
	iters: 200, epoch: 6 | loss: 0.3227873
	speed: 0.0031s/iter; left time: 8.8007s
	iters: 300, epoch: 6 | loss: 0.4598055
	speed: 0.0030s/iter; left time: 8.3107s
	iters: 400, epoch: 6 | loss: 0.7379434
	speed: 0.0030s/iter; left time: 7.9971s
	iters: 500, epoch: 6 | loss: 0.1917695
	speed: 0.0030s/iter; left time: 7.8364s
	iters: 600, epoch: 6 | loss: 0.4791437
	speed: 0.0031s/iter; left time: 7.6380s
	iters: 700, epoch: 6 | loss: 0.2483593
	speed: 0.0031s/iter; left time: 7.3235s
	iters: 800, epoch: 6 | loss: 0.6252017
	speed: 0.0030s/iter; left time: 6.8588s
	iters: 900, epoch: 6 | loss: 0.3814892
	speed: 0.0030s/iter; left time: 6.5406s
	iters: 1000, epoch: 6 | loss: 0.7302587
	speed: 0.0030s/iter; left time: 6.2465s
Updating learning rate to 3.642622842068413e-05
Epoch: 6 cost time: 3.153813600540161
Epoch: 6, Steps: 1027 | Train Loss: 0.4869872 Vali Loss: 0.3536880 Best vali loss: 0.3520395
	iters: 100, epoch: 7 | loss: 0.4935257
	speed: 0.0094s/iter; left time: 18.3557s
	iters: 200, epoch: 7 | loss: 0.2200871
	speed: 0.0034s/iter; left time: 6.3024s
	iters: 300, epoch: 7 | loss: 0.5710797
	speed: 0.0034s/iter; left time: 5.9620s
	iters: 400, epoch: 7 | loss: 0.8561499
	speed: 0.0034s/iter; left time: 5.5450s
	iters: 500, epoch: 7 | loss: 0.3575371
	speed: 0.0034s/iter; left time: 5.3237s
	iters: 600, epoch: 7 | loss: 0.4457522
	speed: 0.0034s/iter; left time: 4.9484s
	iters: 700, epoch: 7 | loss: 0.3480283
	speed: 0.0033s/iter; left time: 4.5078s
	iters: 800, epoch: 7 | loss: 0.3605033
	speed: 0.0029s/iter; left time: 3.6007s
	iters: 900, epoch: 7 | loss: 0.4987275
	speed: 0.0028s/iter; left time: 3.2894s
	iters: 1000, epoch: 7 | loss: 0.2611586
	speed: 0.0028s/iter; left time: 2.9852s
Updating learning rate to 9.466868326504852e-06
Validation loss decreased (0.3520 --> 0.3506).  Saving model state dict ...
Epoch: 7 cost time: 3.3278913497924805
Epoch: 7, Steps: 1027 | Train Loss: 0.4412549 Vali Loss: 0.3505625 Best vali loss: 0.3505625
	iters: 100, epoch: 8 | loss: 0.3087574
	speed: 0.0093s/iter; left time: 8.6150s
	iters: 200, epoch: 8 | loss: 0.8509662
	speed: 0.0032s/iter; left time: 2.6312s
	iters: 300, epoch: 8 | loss: 0.7713343
	speed: 0.0031s/iter; left time: 2.2658s
	iters: 400, epoch: 8 | loss: 0.4195272
	speed: 0.0030s/iter; left time: 1.8981s
	iters: 500, epoch: 8 | loss: 0.3170026
	speed: 0.0030s/iter; left time: 1.5987s
	iters: 600, epoch: 8 | loss: 0.4336564
	speed: 0.0030s/iter; left time: 1.2973s
	iters: 700, epoch: 8 | loss: 0.3853833
	speed: 0.0030s/iter; left time: 0.9907s
	iters: 800, epoch: 8 | loss: 0.5493649
	speed: 0.0030s/iter; left time: 0.6903s
	iters: 900, epoch: 8 | loss: 0.2276877
	speed: 0.0030s/iter; left time: 0.3882s
	iters: 1000, epoch: 8 | loss: 0.8519323
	speed: 0.0031s/iter; left time: 0.0860s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1908793449401855
Epoch: 8, Steps: 1027 | Train Loss: 0.5115612 Vali Loss: 0.3509808 Best vali loss: 0.3505625

best validation loss 0.3505625446969259

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022132621462, 'e_layers': 3, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007070252081
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 0.9370207786560059
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732291 Best vali loss: 0.3732291
Updating learning rate to 0.00035351260405
Epoch: 2 cost time: 0.59393310546875
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3766193 Best vali loss: 0.3732291
Updating learning rate to 0.000176756302025
Validation loss decreased (0.3732 --> 0.3563).  Saving model state dict ...
Epoch: 3 cost time: 0.6037020683288574
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3562881 Best vali loss: 0.3562881
Updating learning rate to 8.83781510125e-05
Epoch: 4 cost time: 0.6031618118286133
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3596950 Best vali loss: 0.3562881
Updating learning rate to 4.418907550625e-05
Validation loss decreased (0.3563 --> 0.3514).  Saving model state dict ...
Epoch: 5 cost time: 0.6020023822784424
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3513546 Best vali loss: 0.3513546
Updating learning rate to 2.2094537753125e-05
Epoch: 6 cost time: 0.6025643348693848
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3638924 Best vali loss: 0.3513546
Updating learning rate to 1.10472688765625e-05
Epoch: 7 cost time: 0.6020257472991943
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3596327 Best vali loss: 0.3513546
Updating learning rate to 5.52363443828125e-06
Epoch: 8 cost time: 0.6022584438323975
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3589578 Best vali loss: 0.3513546

best validation loss 0.3513545691849909

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022308516818, 'e_layers': 4, 'learning_rate': 0.0004117471859, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4146234
	speed: 0.0114s/iter; left time: 45.6664s
	iters: 200, epoch: 1 | loss: 0.3383983
	speed: 0.0052s/iter; left time: 20.2534s
	iters: 300, epoch: 1 | loss: 0.3967252
	speed: 0.0052s/iter; left time: 19.7234s
	iters: 400, epoch: 1 | loss: 0.3386322
	speed: 0.0052s/iter; left time: 19.2342s
	iters: 500, epoch: 1 | loss: 0.9554302
	speed: 0.0049s/iter; left time: 17.8715s
Updating learning rate to 0.00039607599176106495
Validation loss decreased (inf --> 0.3758).  Saving model state dict ...
Epoch: 1 cost time: 2.988398313522339
Epoch: 1, Steps: 514 | Train Loss: 0.4887619 Vali Loss: 0.3757639 Best vali loss: 0.3757639
	iters: 100, epoch: 2 | loss: 1.1586139
	speed: 0.0104s/iter; left time: 36.2507s
	iters: 200, epoch: 2 | loss: 0.9493614
	speed: 0.0053s/iter; left time: 17.8624s
	iters: 300, epoch: 2 | loss: 0.6254130
	speed: 0.0053s/iter; left time: 17.4324s
	iters: 400, epoch: 2 | loss: 0.3691730
	speed: 0.0052s/iter; left time: 16.7034s
	iters: 500, epoch: 2 | loss: 0.4365869
	speed: 0.0052s/iter; left time: 16.2452s
Updating learning rate to 0.000351448206592184
Validation loss decreased (0.3758 --> 0.3750).  Saving model state dict ...
Epoch: 2 cost time: 2.7343313694000244
Epoch: 2, Steps: 514 | Train Loss: 0.7078296 Vali Loss: 0.3750143 Best vali loss: 0.3750143
	iters: 100, epoch: 3 | loss: 0.4410218
	speed: 0.0104s/iter; left time: 31.0248s
	iters: 200, epoch: 3 | loss: 0.4542112
	speed: 0.0052s/iter; left time: 14.9569s
	iters: 300, epoch: 3 | loss: 0.7642941
	speed: 0.0052s/iter; left time: 14.3640s
	iters: 400, epoch: 3 | loss: 0.3699110
	speed: 0.0052s/iter; left time: 13.9935s
	iters: 500, epoch: 3 | loss: 1.0712101
	speed: 0.0050s/iter; left time: 12.9197s
Updating learning rate to 0.0002846580061334394
Epoch: 3 cost time: 2.684199810028076
Epoch: 3, Steps: 514 | Train Loss: 0.6201297 Vali Loss: 0.3806112 Best vali loss: 0.3750143
	iters: 100, epoch: 4 | loss: 0.6843582
	speed: 0.0103s/iter; left time: 25.4325s
	iters: 200, epoch: 4 | loss: 0.9160064
	speed: 0.0052s/iter; left time: 12.3089s
	iters: 300, epoch: 4 | loss: 0.4276943
	speed: 0.0052s/iter; left time: 11.8154s
	iters: 400, epoch: 4 | loss: 0.3169426
	speed: 0.0050s/iter; left time: 10.8331s
	iters: 500, epoch: 4 | loss: 0.4316270
	speed: 0.0048s/iter; left time: 9.8393s
Updating learning rate to 0.00020587359295
Epoch: 4 cost time: 2.648263454437256
Epoch: 4, Steps: 514 | Train Loss: 0.5553257 Vali Loss: 0.3911946 Best vali loss: 0.3750143
	iters: 100, epoch: 5 | loss: 0.6619608
	speed: 0.0101s/iter; left time: 19.7300s
	iters: 200, epoch: 5 | loss: 0.7394248
	speed: 0.0050s/iter; left time: 9.2909s
	iters: 300, epoch: 5 | loss: 0.6002186
	speed: 0.0048s/iter; left time: 8.4857s
	iters: 400, epoch: 5 | loss: 0.6761917
	speed: 0.0047s/iter; left time: 7.8571s
	iters: 500, epoch: 5 | loss: 0.7334489
	speed: 0.0047s/iter; left time: 7.3446s
Updating learning rate to 0.00012708917976656065
Validation loss decreased (0.3750 --> 0.3702).  Saving model state dict ...
Epoch: 5 cost time: 2.5503242015838623
Epoch: 5, Steps: 514 | Train Loss: 0.6822490 Vali Loss: 0.3702046 Best vali loss: 0.3702046
	iters: 100, epoch: 6 | loss: 0.4343022
	speed: 0.0096s/iter; left time: 13.8945s
	iters: 200, epoch: 6 | loss: 0.7809177
	speed: 0.0048s/iter; left time: 6.4570s
	iters: 300, epoch: 6 | loss: 0.4100322
	speed: 0.0047s/iter; left time: 5.8414s
	iters: 400, epoch: 6 | loss: 0.6558138
	speed: 0.0048s/iter; left time: 5.5415s
	iters: 500, epoch: 6 | loss: 0.2987134
	speed: 0.0044s/iter; left time: 4.5747s
Updating learning rate to 6.029897930781601e-05
Validation loss decreased (0.3702 --> 0.3526).  Saving model state dict ...
Epoch: 6 cost time: 2.4349093437194824
Epoch: 6, Steps: 514 | Train Loss: 0.5159559 Vali Loss: 0.3525626 Best vali loss: 0.3525626
	iters: 100, epoch: 7 | loss: 0.2697112
	speed: 0.0092s/iter; left time: 8.5215s
	iters: 200, epoch: 7 | loss: 0.3921616
	speed: 0.0045s/iter; left time: 3.6991s
	iters: 300, epoch: 7 | loss: 0.8532723
	speed: 0.0044s/iter; left time: 3.1999s
	iters: 400, epoch: 7 | loss: 0.6695535
	speed: 0.0044s/iter; left time: 2.7976s
	iters: 500, epoch: 7 | loss: 0.5251657
	speed: 0.0047s/iter; left time: 2.4629s
Updating learning rate to 1.5671194138935064e-05
Epoch: 7 cost time: 2.350071668624878
Epoch: 7, Steps: 514 | Train Loss: 0.5419729 Vali Loss: 0.3637132 Best vali loss: 0.3525626
	iters: 100, epoch: 8 | loss: 0.2375516
	speed: 0.0098s/iter; left time: 4.0850s
	iters: 200, epoch: 8 | loss: 0.5091502
	speed: 0.0049s/iter; left time: 1.5327s
	iters: 300, epoch: 8 | loss: 0.6148340
	speed: 0.0048s/iter; left time: 1.0422s
	iters: 400, epoch: 8 | loss: 0.4094845
	speed: 0.0048s/iter; left time: 0.5569s
	iters: 500, epoch: 8 | loss: 0.1991962
	speed: 0.0048s/iter; left time: 0.0717s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5272011756896973
Epoch: 8, Steps: 514 | Train Loss: 0.3940433 Vali Loss: 0.3548281 Best vali loss: 0.3525626

best validation loss 0.35256260038593196

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0037065220554, 'e_layers': 2, 'learning_rate': 0.0004326480262, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4279024
	speed: 0.0100s/iter; left time: 40.1468s
	iters: 200, epoch: 1 | loss: 1.0795923
	speed: 0.0032s/iter; left time: 12.6421s
	iters: 300, epoch: 1 | loss: 1.0121666
	speed: 0.0031s/iter; left time: 11.8886s
	iters: 400, epoch: 1 | loss: 0.5022941
	speed: 0.0032s/iter; left time: 11.6992s
	iters: 500, epoch: 1 | loss: 1.1565728
	speed: 0.0032s/iter; left time: 11.4775s
Updating learning rate to 0.0004326480262
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 2.031126022338867
Epoch: 1, Steps: 514 | Train Loss: 0.8357057 Vali Loss: 0.3708676 Best vali loss: 0.3708676
	iters: 100, epoch: 2 | loss: 0.3880386
	speed: 0.0077s/iter; left time: 26.8247s
	iters: 200, epoch: 2 | loss: 0.3072887
	speed: 0.0037s/iter; left time: 12.4212s
	iters: 300, epoch: 2 | loss: 0.5153326
	speed: 0.0036s/iter; left time: 12.0236s
	iters: 400, epoch: 2 | loss: 0.3897325
	speed: 0.0036s/iter; left time: 11.6100s
	iters: 500, epoch: 2 | loss: 0.6055154
	speed: 0.0036s/iter; left time: 11.1834s
Updating learning rate to 0.0002163240131
Validation loss decreased (0.3709 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 1.916973352432251
Epoch: 2, Steps: 514 | Train Loss: 0.4411816 Vali Loss: 0.3641134 Best vali loss: 0.3641134
	iters: 100, epoch: 3 | loss: 0.3634588
	speed: 0.0077s/iter; left time: 22.8925s
	iters: 200, epoch: 3 | loss: 0.8950580
	speed: 0.0035s/iter; left time: 10.0763s
	iters: 300, epoch: 3 | loss: 0.4882383
	speed: 0.0035s/iter; left time: 9.7713s
	iters: 400, epoch: 3 | loss: 0.4749799
	speed: 0.0035s/iter; left time: 9.4604s
	iters: 500, epoch: 3 | loss: 1.0768982
	speed: 0.0034s/iter; left time: 8.8008s
Updating learning rate to 0.00010816200655
Validation loss decreased (0.3641 --> 0.3567).  Saving model state dict ...
Epoch: 3 cost time: 1.8497602939605713
Epoch: 3, Steps: 514 | Train Loss: 0.6597266 Vali Loss: 0.3567013 Best vali loss: 0.3567013

best validation loss 0.35670134051609603

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0030063688696, 'e_layers': 4, 'learning_rate': 0.0012526252921, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5879329
	speed: 0.0112s/iter; left time: 45.0170s
	iters: 200, epoch: 1 | loss: 0.9127122
	speed: 0.0050s/iter; left time: 19.7560s
	iters: 300, epoch: 1 | loss: 1.4453640
	speed: 0.0051s/iter; left time: 19.3811s
	iters: 400, epoch: 1 | loss: 0.4525835
	speed: 0.0050s/iter; left time: 18.6585s
	iters: 500, epoch: 1 | loss: 0.4409423
	speed: 0.0051s/iter; left time: 18.5731s
Updating learning rate to 0.001204950080688581
Validation loss decreased (inf --> 0.3951).  Saving model state dict ...
Epoch: 1 cost time: 2.9453718662261963
Epoch: 1, Steps: 514 | Train Loss: 0.7679070 Vali Loss: 0.3950581 Best vali loss: 0.3950581
	iters: 100, epoch: 2 | loss: 0.4695807
	speed: 0.0098s/iter; left time: 34.2473s
	iters: 200, epoch: 2 | loss: 0.4294643
	speed: 0.0049s/iter; left time: 16.8045s
	iters: 300, epoch: 2 | loss: 1.1287972
	speed: 0.0049s/iter; left time: 16.1384s
	iters: 400, epoch: 2 | loss: 0.7212070
	speed: 0.0048s/iter; left time: 15.4221s
	iters: 500, epoch: 2 | loss: 0.2583876
	speed: 0.0049s/iter; left time: 15.0960s
Updating learning rate to 0.0010691825652148449
Epoch: 2 cost time: 2.5539841651916504
Epoch: 2, Steps: 514 | Train Loss: 0.6014873 Vali Loss: 0.3954028 Best vali loss: 0.3950581
	iters: 100, epoch: 3 | loss: 1.2111205
	speed: 0.0097s/iter; left time: 28.9284s
	iters: 200, epoch: 3 | loss: 0.7638350
	speed: 0.0046s/iter; left time: 13.2305s
	iters: 300, epoch: 3 | loss: 0.4608723
	speed: 0.0046s/iter; left time: 12.7238s
	iters: 400, epoch: 3 | loss: 1.1531582
	speed: 0.0045s/iter; left time: 12.2050s
	iters: 500, epoch: 3 | loss: 0.2727956
	speed: 0.0048s/iter; left time: 12.3115s
Updating learning rate to 0.0008659921191740757
Epoch: 3 cost time: 2.438591957092285
Epoch: 3, Steps: 514 | Train Loss: 0.7723563 Vali Loss: 0.3953891 Best vali loss: 0.3950581

best validation loss 0.39505811810259267

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0023991423314, 'e_layers': 3, 'learning_rate': 0.000728193879, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5382162
	speed: 0.0108s/iter; left time: 21.1964s
	iters: 200, epoch: 1 | loss: 0.8452974
	speed: 0.0045s/iter; left time: 8.3234s
Updating learning rate to 0.000728193879
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.5129187107086182
Epoch: 1, Steps: 257 | Train Loss: 0.6917568 Vali Loss: 0.3689855 Best vali loss: 0.3689855
	iters: 100, epoch: 2 | loss: 0.5154697
	speed: 0.0093s/iter; left time: 15.8231s
	iters: 200, epoch: 2 | loss: 0.7319009
	speed: 0.0039s/iter; left time: 6.2906s
Updating learning rate to 0.0003640969395
Epoch: 2 cost time: 1.069181203842163
Epoch: 2, Steps: 257 | Train Loss: 0.6236853 Vali Loss: 0.3709562 Best vali loss: 0.3689855
	iters: 100, epoch: 3 | loss: 0.5675968
	speed: 0.0092s/iter; left time: 13.2547s
	iters: 200, epoch: 3 | loss: 0.4479132
	speed: 0.0045s/iter; left time: 6.0849s
Updating learning rate to 0.00018204846975
Epoch: 3 cost time: 1.1921393871307373
Epoch: 3, Steps: 257 | Train Loss: 0.5077550 Vali Loss: 0.3742256 Best vali loss: 0.3689855

best validation loss 0.3689854781145197

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0037065220554, 'e_layers': 2, 'learning_rate': 0.0004326480262, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3692692
	speed: 0.0098s/iter; left time: 24.1405s
	iters: 200, epoch: 4 | loss: 0.8738601
	speed: 0.0031s/iter; left time: 7.4596s
	iters: 300, epoch: 4 | loss: 0.8423796
	speed: 0.0031s/iter; left time: 6.9314s
	iters: 400, epoch: 4 | loss: 0.4732604
	speed: 0.0029s/iter; left time: 6.2967s
	iters: 500, epoch: 4 | loss: 0.4552020
	speed: 0.0030s/iter; left time: 6.1383s
Updating learning rate to 5.4081003275e-05
Validation loss decreased (0.3567 --> 0.3554).  Saving model state dict ...
Epoch: 4 cost time: 1.935788869857788
Epoch: 4, Steps: 514 | Train Loss: 0.6027943 Vali Loss: 0.3554163 Best vali loss: 0.3554163
	iters: 100, epoch: 5 | loss: 0.3876442
	speed: 0.0070s/iter; left time: 13.6071s
	iters: 200, epoch: 5 | loss: 0.2388048
	speed: 0.0031s/iter; left time: 5.7703s
	iters: 300, epoch: 5 | loss: 0.3545256
	speed: 0.0031s/iter; left time: 5.3767s
	iters: 400, epoch: 5 | loss: 0.3813023
	speed: 0.0030s/iter; left time: 5.0429s
	iters: 500, epoch: 5 | loss: 0.6165921
	speed: 0.0030s/iter; left time: 4.6478s
Updating learning rate to 2.70405016375e-05
Validation loss decreased (0.3554 --> 0.3505).  Saving model state dict ...
Epoch: 5 cost time: 1.6087324619293213
Epoch: 5, Steps: 514 | Train Loss: 0.3957738 Vali Loss: 0.3505316 Best vali loss: 0.3505316
	iters: 100, epoch: 6 | loss: 0.3083118
	speed: 0.0071s/iter; left time: 10.2157s
	iters: 200, epoch: 6 | loss: 0.7546215
	speed: 0.0031s/iter; left time: 4.1692s
	iters: 300, epoch: 6 | loss: 0.4598450
	speed: 0.0030s/iter; left time: 3.7224s
	iters: 400, epoch: 6 | loss: 0.4397365
	speed: 0.0029s/iter; left time: 3.3436s
	iters: 500, epoch: 6 | loss: 0.9823127
	speed: 0.0029s/iter; left time: 3.0459s
Updating learning rate to 1.352025081875e-05
Validation loss decreased (0.3505 --> 0.3481).  Saving model state dict ...
Epoch: 6 cost time: 1.6059906482696533
Epoch: 6, Steps: 514 | Train Loss: 0.5889655 Vali Loss: 0.3481007 Best vali loss: 0.3481007
	iters: 100, epoch: 7 | loss: 0.5353009
	speed: 0.0069s/iter; left time: 6.4249s
	iters: 200, epoch: 7 | loss: 0.4444899
	speed: 0.0031s/iter; left time: 2.5910s
	iters: 300, epoch: 7 | loss: 0.4379618
	speed: 0.0031s/iter; left time: 2.2674s
	iters: 400, epoch: 7 | loss: 0.6268058
	speed: 0.0031s/iter; left time: 1.9517s
	iters: 500, epoch: 7 | loss: 0.6772475
	speed: 0.0031s/iter; left time: 1.6363s
Updating learning rate to 6.760125409375e-06
Validation loss decreased (0.3481 --> 0.3477).  Saving model state dict ...
Epoch: 7 cost time: 1.64790940284729
Epoch: 7, Steps: 514 | Train Loss: 0.5443612 Vali Loss: 0.3477035 Best vali loss: 0.3477035
	iters: 100, epoch: 8 | loss: 0.5291984
	speed: 0.0073s/iter; left time: 3.0267s
	iters: 200, epoch: 8 | loss: 0.6890605
	speed: 0.0031s/iter; left time: 0.9797s
	iters: 300, epoch: 8 | loss: 0.4444691
	speed: 0.0031s/iter; left time: 0.6698s
	iters: 400, epoch: 8 | loss: 0.7753587
	speed: 0.0031s/iter; left time: 0.3577s
	iters: 500, epoch: 8 | loss: 0.5204911
	speed: 0.0031s/iter; left time: 0.0464s
Updating learning rate to 3.3800627046875e-06
Validation loss decreased (0.3477 --> 0.3465).  Saving model state dict ...
Epoch: 8 cost time: 1.6405115127563477
Epoch: 8, Steps: 514 | Train Loss: 0.5917156 Vali Loss: 0.3465089 Best vali loss: 0.3465089

best validation loss 0.34650892678553086

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0063314889176, 'e_layers': 4, 'learning_rate': 0.0001694591415, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8413132
	speed: 0.0113s/iter; left time: 91.3761s
	iters: 200, epoch: 1 | loss: 0.2560131
	speed: 0.0052s/iter; left time: 41.5042s
	iters: 300, epoch: 1 | loss: 1.1707213
	speed: 0.0052s/iter; left time: 41.3054s
	iters: 400, epoch: 1 | loss: 0.4218253
	speed: 0.0049s/iter; left time: 38.2299s
	iters: 500, epoch: 1 | loss: 1.4603173
	speed: 0.0048s/iter; left time: 36.8099s
	iters: 600, epoch: 1 | loss: 1.2218580
	speed: 0.0048s/iter; left time: 36.2347s
	iters: 700, epoch: 1 | loss: 0.4168423
	speed: 0.0047s/iter; left time: 35.0288s
	iters: 800, epoch: 1 | loss: 0.3978503
	speed: 0.0045s/iter; left time: 33.5950s
	iters: 900, epoch: 1 | loss: 0.2857886
	speed: 0.0046s/iter; left time: 33.2977s
	iters: 1000, epoch: 1 | loss: 0.2959983
	speed: 0.0045s/iter; left time: 32.5966s
Updating learning rate to 0.0001694591415
Validation loss decreased (inf --> 0.3599).  Saving model state dict ...
Epoch: 1 cost time: 5.280571937561035
Epoch: 1, Steps: 1027 | Train Loss: 0.6768528 Vali Loss: 0.3599004 Best vali loss: 0.3599004
	iters: 100, epoch: 2 | loss: 0.5835121
	speed: 0.0127s/iter; left time: 90.1246s
	iters: 200, epoch: 2 | loss: 0.2488867
	speed: 0.0048s/iter; left time: 33.3862s
	iters: 300, epoch: 2 | loss: 0.4068628
	speed: 0.0047s/iter; left time: 32.6313s
	iters: 400, epoch: 2 | loss: 0.3117006
	speed: 0.0047s/iter; left time: 32.0989s
	iters: 500, epoch: 2 | loss: 0.2816425
	speed: 0.0048s/iter; left time: 32.0322s
	iters: 600, epoch: 2 | loss: 0.4985002
	speed: 0.0047s/iter; left time: 31.2301s
	iters: 700, epoch: 2 | loss: 0.3045566
	speed: 0.0048s/iter; left time: 31.0621s
	iters: 800, epoch: 2 | loss: 0.7533351
	speed: 0.0048s/iter; left time: 30.5406s
	iters: 900, epoch: 2 | loss: 0.8404580
	speed: 0.0048s/iter; left time: 29.9600s
	iters: 1000, epoch: 2 | loss: 0.3496416
	speed: 0.0047s/iter; left time: 29.1722s
Updating learning rate to 8.472957075e-05
Epoch: 2 cost time: 4.912923812866211
Epoch: 2, Steps: 1027 | Train Loss: 0.4579096 Vali Loss: 0.3666463 Best vali loss: 0.3599004
	iters: 100, epoch: 3 | loss: 0.3572324
	speed: 0.0123s/iter; left time: 74.8777s
	iters: 200, epoch: 3 | loss: 0.3709594
	speed: 0.0045s/iter; left time: 26.7342s
	iters: 300, epoch: 3 | loss: 0.4552622
	speed: 0.0045s/iter; left time: 26.5696s
	iters: 400, epoch: 3 | loss: 0.1946335
	speed: 0.0045s/iter; left time: 26.1754s
	iters: 500, epoch: 3 | loss: 0.3084306
	speed: 0.0045s/iter; left time: 25.7454s
	iters: 600, epoch: 3 | loss: 0.3166297
	speed: 0.0045s/iter; left time: 25.2719s
	iters: 700, epoch: 3 | loss: 0.3526698
	speed: 0.0045s/iter; left time: 24.6798s
	iters: 800, epoch: 3 | loss: 0.8714890
	speed: 0.0045s/iter; left time: 24.1973s
	iters: 900, epoch: 3 | loss: 1.1786839
	speed: 0.0045s/iter; left time: 23.8011s
	iters: 1000, epoch: 3 | loss: 0.8189561
	speed: 0.0045s/iter; left time: 23.4235s
Updating learning rate to 4.2364785375e-05
Validation loss decreased (0.3599 --> 0.3433).  Saving model state dict ...
Epoch: 3 cost time: 4.685449123382568
Epoch: 3, Steps: 1027 | Train Loss: 0.5224947 Vali Loss: 0.3432561 Best vali loss: 0.3432561
	iters: 100, epoch: 4 | loss: 0.4308499
	speed: 0.0129s/iter; left time: 64.7689s
	iters: 200, epoch: 4 | loss: 0.4205915
	speed: 0.0046s/iter; left time: 22.9521s
	iters: 300, epoch: 4 | loss: 0.5547735
	speed: 0.0046s/iter; left time: 22.3582s
	iters: 400, epoch: 4 | loss: 0.3127124
	speed: 0.0046s/iter; left time: 21.6023s
	iters: 500, epoch: 4 | loss: 0.2330563
	speed: 0.0046s/iter; left time: 21.2952s
	iters: 600, epoch: 4 | loss: 0.3095790
	speed: 0.0047s/iter; left time: 21.1819s
	iters: 700, epoch: 4 | loss: 0.2277651
	speed: 0.0047s/iter; left time: 20.6562s
	iters: 800, epoch: 4 | loss: 0.2093670
	speed: 0.0047s/iter; left time: 20.2680s
	iters: 900, epoch: 4 | loss: 0.3445486
	speed: 0.0046s/iter; left time: 19.6864s
	iters: 1000, epoch: 4 | loss: 0.5915291
	speed: 0.0047s/iter; left time: 19.2673s
Updating learning rate to 2.11823926875e-05
Epoch: 4 cost time: 4.804501056671143
Epoch: 4, Steps: 1027 | Train Loss: 0.3634772 Vali Loss: 0.3480925 Best vali loss: 0.3432561
	iters: 100, epoch: 5 | loss: 1.0452799
	speed: 0.0124s/iter; left time: 49.5407s
	iters: 200, epoch: 5 | loss: 0.2508097
	speed: 0.0045s/iter; left time: 17.7043s
	iters: 300, epoch: 5 | loss: 0.2210944
	speed: 0.0045s/iter; left time: 17.2157s
	iters: 400, epoch: 5 | loss: 0.4738818
	speed: 0.0045s/iter; left time: 16.8426s
	iters: 500, epoch: 5 | loss: 0.2369756
	speed: 0.0046s/iter; left time: 16.4732s
	iters: 600, epoch: 5 | loss: 0.1749375
	speed: 0.0045s/iter; left time: 15.7919s
	iters: 700, epoch: 5 | loss: 0.6606346
	speed: 0.0045s/iter; left time: 15.2599s
	iters: 800, epoch: 5 | loss: 0.4454506
	speed: 0.0045s/iter; left time: 14.8715s
	iters: 900, epoch: 5 | loss: 0.1840571
	speed: 0.0045s/iter; left time: 14.4123s
	iters: 1000, epoch: 5 | loss: 0.6882666
	speed: 0.0045s/iter; left time: 13.9835s
Updating learning rate to 1.059119634375e-05
Epoch: 5 cost time: 4.676236391067505
Epoch: 5, Steps: 1027 | Train Loss: 0.4381388 Vali Loss: 0.3463017 Best vali loss: 0.3432561
	iters: 100, epoch: 6 | loss: 0.1962542
	speed: 0.0126s/iter; left time: 37.5270s
	iters: 200, epoch: 6 | loss: 0.3350212
	speed: 0.0048s/iter; left time: 13.9274s
	iters: 300, epoch: 6 | loss: 0.2713787
	speed: 0.0048s/iter; left time: 13.2832s
	iters: 400, epoch: 6 | loss: 0.4446718
	speed: 0.0047s/iter; left time: 12.5861s
	iters: 500, epoch: 6 | loss: 0.6509156
	speed: 0.0048s/iter; left time: 12.3720s
	iters: 600, epoch: 6 | loss: 0.8519641
	speed: 0.0048s/iter; left time: 11.9065s
	iters: 700, epoch: 6 | loss: 0.2984627
	speed: 0.0048s/iter; left time: 11.3461s
	iters: 800, epoch: 6 | loss: 0.7854963
	speed: 0.0048s/iter; left time: 10.9622s
	iters: 900, epoch: 6 | loss: 0.4446784
	speed: 0.0048s/iter; left time: 10.5218s
	iters: 1000, epoch: 6 | loss: 0.7509682
	speed: 0.0048s/iter; left time: 9.9313s
Updating learning rate to 5.295598171875e-06
Epoch: 6 cost time: 4.953003883361816
Epoch: 6, Steps: 1027 | Train Loss: 0.5029811 Vali Loss: 0.3455109 Best vali loss: 0.3432561
	iters: 100, epoch: 7 | loss: 0.5551181
	speed: 0.0126s/iter; left time: 24.6931s
	iters: 200, epoch: 7 | loss: 0.3368057
	speed: 0.0046s/iter; left time: 8.5284s
	iters: 300, epoch: 7 | loss: 0.5024078
	speed: 0.0047s/iter; left time: 8.2979s
	iters: 400, epoch: 7 | loss: 0.3567515
	speed: 0.0047s/iter; left time: 7.8115s
	iters: 500, epoch: 7 | loss: 0.2878187
	speed: 0.0046s/iter; left time: 7.2287s
	iters: 600, epoch: 7 | loss: 0.4445583
	speed: 0.0047s/iter; left time: 6.7958s
	iters: 700, epoch: 7 | loss: 0.2694895
	speed: 0.0047s/iter; left time: 6.4020s
	iters: 800, epoch: 7 | loss: 0.2262021
	speed: 0.0047s/iter; left time: 5.9355s
	iters: 900, epoch: 7 | loss: 0.3353915
	speed: 0.0047s/iter; left time: 5.3731s
	iters: 1000, epoch: 7 | loss: 0.2673639
	speed: 0.0046s/iter; left time: 4.8409s
Updating learning rate to 2.6477990859375e-06
Epoch: 7 cost time: 4.831118583679199
Epoch: 7, Steps: 1027 | Train Loss: 0.3581907 Vali Loss: 0.3488144 Best vali loss: 0.3432561
	iters: 100, epoch: 8 | loss: 0.2069773
	speed: 0.0123s/iter; left time: 11.3839s
	iters: 200, epoch: 8 | loss: 0.4687871
	speed: 0.0045s/iter; left time: 3.7160s
	iters: 300, epoch: 8 | loss: 1.3418878
	speed: 0.0045s/iter; left time: 3.2872s
	iters: 400, epoch: 8 | loss: 0.4107265
	speed: 0.0045s/iter; left time: 2.8276s
	iters: 500, epoch: 8 | loss: 0.7208341
	speed: 0.0045s/iter; left time: 2.3673s
	iters: 600, epoch: 8 | loss: 0.4099379
	speed: 0.0045s/iter; left time: 1.9192s
	iters: 700, epoch: 8 | loss: 1.2300719
	speed: 0.0045s/iter; left time: 1.4728s
	iters: 800, epoch: 8 | loss: 0.8560418
	speed: 0.0045s/iter; left time: 1.0246s
	iters: 900, epoch: 8 | loss: 0.3795938
	speed: 0.0045s/iter; left time: 0.5750s
	iters: 1000, epoch: 8 | loss: 0.3171327
	speed: 0.0045s/iter; left time: 0.1254s
Updating learning rate to 1.32389954296875e-06
Epoch: 8 cost time: 4.653641700744629
Epoch: 8, Steps: 1027 | Train Loss: 0.6341991 Vali Loss: 0.3485289 Best vali loss: 0.3432561

best validation loss 0.3432560550264853

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063623062545, 'e_layers': 4, 'learning_rate': 6.90241625e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8188952
	speed: 0.0115s/iter; left time: 93.1943s
	iters: 200, epoch: 1 | loss: 0.3867242
	speed: 0.0054s/iter; left time: 43.1814s
	iters: 300, epoch: 1 | loss: 0.3634339
	speed: 0.0054s/iter; left time: 42.7136s
	iters: 400, epoch: 1 | loss: 0.4388106
	speed: 0.0051s/iter; left time: 39.8050s
	iters: 500, epoch: 1 | loss: 1.2074500
	speed: 0.0049s/iter; left time: 38.0944s
	iters: 600, epoch: 1 | loss: 0.3416711
	speed: 0.0050s/iter; left time: 38.2222s
	iters: 700, epoch: 1 | loss: 0.4203131
	speed: 0.0050s/iter; left time: 37.5282s
	iters: 800, epoch: 1 | loss: 0.7121173
	speed: 0.0050s/iter; left time: 37.3715s
	iters: 900, epoch: 1 | loss: 0.2120167
	speed: 0.0049s/iter; left time: 36.0589s
	iters: 1000, epoch: 1 | loss: 0.9856516
	speed: 0.0050s/iter; left time: 35.9775s
Updating learning rate to 6.639708674124154e-05
Validation loss decreased (inf --> 0.3667).  Saving model state dict ...
Epoch: 1 cost time: 5.595256567001343
Epoch: 1, Steps: 1027 | Train Loss: 0.5887084 Vali Loss: 0.3667456 Best vali loss: 0.3667456
	iters: 100, epoch: 2 | loss: 0.9784409
	speed: 0.0135s/iter; left time: 95.5487s
	iters: 200, epoch: 2 | loss: 0.7921691
	speed: 0.0050s/iter; left time: 34.6448s
	iters: 300, epoch: 2 | loss: 0.9211082
	speed: 0.0050s/iter; left time: 34.4763s
	iters: 400, epoch: 2 | loss: 0.3293583
	speed: 0.0050s/iter; left time: 33.8031s
	iters: 500, epoch: 2 | loss: 1.0966414
	speed: 0.0049s/iter; left time: 32.6637s
	iters: 600, epoch: 2 | loss: 1.0006529
	speed: 0.0049s/iter; left time: 32.5653s
	iters: 700, epoch: 2 | loss: 0.2616768
	speed: 0.0050s/iter; left time: 32.7372s
	iters: 800, epoch: 2 | loss: 0.3501258
	speed: 0.0050s/iter; left time: 32.1665s
	iters: 900, epoch: 2 | loss: 1.7158746
	speed: 0.0050s/iter; left time: 31.7134s
	iters: 1000, epoch: 2 | loss: 0.2905312
	speed: 0.0050s/iter; left time: 30.9531s
Updating learning rate to 5.8915807934736096e-05
Validation loss decreased (0.3667 --> 0.3614).  Saving model state dict ...
Epoch: 2 cost time: 5.157164096832275
Epoch: 2, Steps: 1027 | Train Loss: 0.7736579 Vali Loss: 0.3613782 Best vali loss: 0.3613782
	iters: 100, epoch: 3 | loss: 0.6608790
	speed: 0.0138s/iter; left time: 83.6669s
	iters: 200, epoch: 3 | loss: 0.7626103
	speed: 0.0050s/iter; left time: 30.1064s
	iters: 300, epoch: 3 | loss: 0.3121246
	speed: 0.0051s/iter; left time: 29.6597s
	iters: 400, epoch: 3 | loss: 0.7005259
	speed: 0.0050s/iter; left time: 29.0499s
	iters: 500, epoch: 3 | loss: 0.6173224
	speed: 0.0051s/iter; left time: 28.7713s
	iters: 600, epoch: 3 | loss: 0.2704587
	speed: 0.0051s/iter; left time: 28.2016s
	iters: 700, epoch: 3 | loss: 1.0457028
	speed: 0.0050s/iter; left time: 27.5833s
	iters: 800, epoch: 3 | loss: 0.3644087
	speed: 0.0051s/iter; left time: 27.0938s
	iters: 900, epoch: 3 | loss: 0.2847738
	speed: 0.0051s/iter; left time: 26.6656s
	iters: 1000, epoch: 3 | loss: 0.5452163
	speed: 0.0051s/iter; left time: 26.1499s
Updating learning rate to 4.771928296081286e-05
Validation loss decreased (0.3614 --> 0.3423).  Saving model state dict ...
Epoch: 3 cost time: 5.235806941986084
Epoch: 3, Steps: 1027 | Train Loss: 0.5564023 Vali Loss: 0.3422621 Best vali loss: 0.3422621
	iters: 100, epoch: 4 | loss: 0.4508218
	speed: 0.0141s/iter; left time: 70.8525s
	iters: 200, epoch: 4 | loss: 0.3486927
	speed: 0.0054s/iter; left time: 26.5639s
	iters: 300, epoch: 4 | loss: 0.2386934
	speed: 0.0052s/iter; left time: 25.2174s
	iters: 400, epoch: 4 | loss: 0.3066785
	speed: 0.0051s/iter; left time: 23.9410s
	iters: 500, epoch: 4 | loss: 0.4570139
	speed: 0.0048s/iter; left time: 22.2757s
	iters: 600, epoch: 4 | loss: 0.8830029
	speed: 0.0048s/iter; left time: 21.6991s
	iters: 700, epoch: 4 | loss: 0.9201763
	speed: 0.0048s/iter; left time: 21.2757s
	iters: 800, epoch: 4 | loss: 0.2669227
	speed: 0.0051s/iter; left time: 21.9251s
	iters: 900, epoch: 4 | loss: 0.4715033
	speed: 0.0050s/iter; left time: 21.3827s
	iters: 1000, epoch: 4 | loss: 0.4149004
	speed: 0.0051s/iter; left time: 21.1307s
Updating learning rate to 3.451208125e-05
Epoch: 4 cost time: 5.237885475158691
Epoch: 4, Steps: 1027 | Train Loss: 0.4758406 Vali Loss: 0.3544196 Best vali loss: 0.3422621
	iters: 100, epoch: 5 | loss: 0.2663117
	speed: 0.0135s/iter; left time: 54.2674s
	iters: 200, epoch: 5 | loss: 0.6727807
	speed: 0.0053s/iter; left time: 20.7569s
	iters: 300, epoch: 5 | loss: 0.2279520
	speed: 0.0052s/iter; left time: 19.6599s
	iters: 400, epoch: 5 | loss: 1.0313876
	speed: 0.0051s/iter; left time: 19.0869s
	iters: 500, epoch: 5 | loss: 0.6379905
	speed: 0.0052s/iter; left time: 18.5919s
	iters: 600, epoch: 5 | loss: 0.2202248
	speed: 0.0051s/iter; left time: 17.9714s
	iters: 700, epoch: 5 | loss: 0.1794958
	speed: 0.0051s/iter; left time: 17.4783s
	iters: 800, epoch: 5 | loss: 0.5149433
	speed: 0.0051s/iter; left time: 16.9857s
	iters: 900, epoch: 5 | loss: 0.1936616
	speed: 0.0051s/iter; left time: 16.4134s
	iters: 1000, epoch: 5 | loss: 0.3811603
	speed: 0.0051s/iter; left time: 15.9116s
Updating learning rate to 2.1304879539187143e-05
Epoch: 5 cost time: 5.365290641784668
Epoch: 5, Steps: 1027 | Train Loss: 0.4325908 Vali Loss: 0.3621866 Best vali loss: 0.3422621
	iters: 100, epoch: 6 | loss: 0.4296491
	speed: 0.0134s/iter; left time: 40.0687s
	iters: 200, epoch: 6 | loss: 0.3874465
	speed: 0.0054s/iter; left time: 15.6221s
	iters: 300, epoch: 6 | loss: 0.2504187
	speed: 0.0054s/iter; left time: 14.9514s
	iters: 400, epoch: 6 | loss: 0.6675033
	speed: 0.0054s/iter; left time: 14.5224s
	iters: 500, epoch: 6 | loss: 0.4532505
	speed: 0.0052s/iter; left time: 13.4194s
	iters: 600, epoch: 6 | loss: 0.4597173
	speed: 0.0050s/iter; left time: 12.5041s
	iters: 700, epoch: 6 | loss: 0.2771599
	speed: 0.0051s/iter; left time: 12.0597s
	iters: 800, epoch: 6 | loss: 0.3258252
	speed: 0.0051s/iter; left time: 11.6117s
	iters: 900, epoch: 6 | loss: 0.2995295
	speed: 0.0051s/iter; left time: 11.0459s
	iters: 1000, epoch: 6 | loss: 0.8437772
	speed: 0.0051s/iter; left time: 10.5155s
Updating learning rate to 1.0108354565263902e-05
Epoch: 6 cost time: 5.38896632194519
Epoch: 6, Steps: 1027 | Train Loss: 0.4394277 Vali Loss: 0.3691873 Best vali loss: 0.3422621
	iters: 100, epoch: 7 | loss: 0.2350990
	speed: 0.0129s/iter; left time: 25.2356s
	iters: 200, epoch: 7 | loss: 0.2686459
	speed: 0.0049s/iter; left time: 9.0222s
	iters: 300, epoch: 7 | loss: 0.3634504
	speed: 0.0048s/iter; left time: 8.3944s
	iters: 400, epoch: 7 | loss: 0.7391986
	speed: 0.0048s/iter; left time: 7.9947s
	iters: 500, epoch: 7 | loss: 0.5335412
	speed: 0.0048s/iter; left time: 7.4526s
	iters: 600, epoch: 7 | loss: 0.6420093
	speed: 0.0048s/iter; left time: 6.9621s
	iters: 700, epoch: 7 | loss: 0.2189894
	speed: 0.0048s/iter; left time: 6.5163s
	iters: 800, epoch: 7 | loss: 0.3003131
	speed: 0.0048s/iter; left time: 6.0230s
	iters: 900, epoch: 7 | loss: 0.3579857
	speed: 0.0048s/iter; left time: 5.5689s
	iters: 1000, epoch: 7 | loss: 0.4709180
	speed: 0.0048s/iter; left time: 5.0562s
Updating learning rate to 2.6270757587584555e-06
Epoch: 7 cost time: 5.000946521759033
Epoch: 7, Steps: 1027 | Train Loss: 0.4130150 Vali Loss: 0.3723139 Best vali loss: 0.3422621
	iters: 100, epoch: 8 | loss: 0.5108938
	speed: 0.0134s/iter; left time: 12.4710s
	iters: 200, epoch: 8 | loss: 0.2419537
	speed: 0.0054s/iter; left time: 4.5042s
	iters: 300, epoch: 8 | loss: 0.9196715
	speed: 0.0054s/iter; left time: 3.9513s
	iters: 400, epoch: 8 | loss: 0.1572894
	speed: 0.0054s/iter; left time: 3.4145s
	iters: 500, epoch: 8 | loss: 0.7026632
	speed: 0.0054s/iter; left time: 2.8616s
	iters: 600, epoch: 8 | loss: 0.3433053
	speed: 0.0054s/iter; left time: 2.3213s
	iters: 700, epoch: 8 | loss: 0.2546028
	speed: 0.0051s/iter; left time: 1.6659s
	iters: 800, epoch: 8 | loss: 0.1957432
	speed: 0.0049s/iter; left time: 1.1100s
	iters: 900, epoch: 8 | loss: 0.2712064
	speed: 0.0049s/iter; left time: 0.6246s
	iters: 1000, epoch: 8 | loss: 0.3265146
	speed: 0.0048s/iter; left time: 0.1357s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.397595643997192
Epoch: 8, Steps: 1027 | Train Loss: 0.3923844 Vali Loss: 0.3756533 Best vali loss: 0.3422621

best validation loss 0.34226207611954285

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063233400762, 'e_layers': 4, 'learning_rate': 0.0001128443107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8246743
	speed: 0.0116s/iter; left time: 94.1042s
	iters: 200, epoch: 1 | loss: 0.4010729
	speed: 0.0054s/iter; left time: 43.2031s
	iters: 300, epoch: 1 | loss: 0.3627953
	speed: 0.0054s/iter; left time: 43.0244s
	iters: 400, epoch: 1 | loss: 0.4677230
	speed: 0.0054s/iter; left time: 42.3405s
	iters: 500, epoch: 1 | loss: 1.1731833
	speed: 0.0053s/iter; left time: 40.8518s
	iters: 600, epoch: 1 | loss: 0.3626837
	speed: 0.0050s/iter; left time: 38.3298s
	iters: 700, epoch: 1 | loss: 0.4011495
	speed: 0.0050s/iter; left time: 37.8007s
	iters: 800, epoch: 1 | loss: 0.7228845
	speed: 0.0050s/iter; left time: 37.3219s
	iters: 900, epoch: 1 | loss: 0.2216364
	speed: 0.0050s/iter; left time: 36.8826s
	iters: 1000, epoch: 1 | loss: 1.0179775
	speed: 0.0050s/iter; left time: 36.3024s
Updating learning rate to 0.0001085494298580372
Validation loss decreased (inf --> 0.3626).  Saving model state dict ...
Epoch: 1 cost time: 5.7040488719940186
Epoch: 1, Steps: 1027 | Train Loss: 0.5955781 Vali Loss: 0.3626440 Best vali loss: 0.3626440
	iters: 100, epoch: 2 | loss: 0.9633666
	speed: 0.0135s/iter; left time: 95.7090s
	iters: 200, epoch: 2 | loss: 0.7985431
	speed: 0.0050s/iter; left time: 35.1496s
	iters: 300, epoch: 2 | loss: 0.9717287
	speed: 0.0050s/iter; left time: 34.7353s
	iters: 400, epoch: 2 | loss: 0.3013789
	speed: 0.0050s/iter; left time: 33.9545s
	iters: 500, epoch: 2 | loss: 1.0696157
	speed: 0.0048s/iter; left time: 32.4416s
	iters: 600, epoch: 2 | loss: 1.0181167
	speed: 0.0047s/iter; left time: 31.2963s
	iters: 700, epoch: 2 | loss: 0.2599874
	speed: 0.0048s/iter; left time: 31.1133s
	iters: 800, epoch: 2 | loss: 0.3536755
	speed: 0.0048s/iter; left time: 30.8533s
	iters: 900, epoch: 2 | loss: 1.8764422
	speed: 0.0048s/iter; left time: 29.8992s
	iters: 1000, epoch: 2 | loss: 0.2836620
	speed: 0.0048s/iter; left time: 29.5351s
Updating learning rate to 9.631864400714584e-05
Validation loss decreased (0.3626 --> 0.3524).  Saving model state dict ...
Epoch: 2 cost time: 5.0555644035339355
Epoch: 2, Steps: 1027 | Train Loss: 0.7896517 Vali Loss: 0.3524402 Best vali loss: 0.3524402
	iters: 100, epoch: 3 | loss: 0.6606148
	speed: 0.0137s/iter; left time: 83.3411s
	iters: 200, epoch: 3 | loss: 0.7688792
	speed: 0.0051s/iter; left time: 30.2999s
	iters: 300, epoch: 3 | loss: 0.3097886
	speed: 0.0051s/iter; left time: 29.8269s
	iters: 400, epoch: 3 | loss: 0.7122796
	speed: 0.0051s/iter; left time: 29.3384s
	iters: 500, epoch: 3 | loss: 0.5585515
	speed: 0.0050s/iter; left time: 28.1161s
	iters: 600, epoch: 3 | loss: 0.2837894
	speed: 0.0049s/iter; left time: 27.3982s
	iters: 700, epoch: 3 | loss: 0.7057064
	speed: 0.0051s/iter; left time: 27.6560s
	iters: 800, epoch: 3 | loss: 0.3711133
	speed: 0.0050s/iter; left time: 27.0142s
	iters: 900, epoch: 3 | loss: 0.2930554
	speed: 0.0051s/iter; left time: 26.5889s
	iters: 1000, epoch: 3 | loss: 0.5420164
	speed: 0.0048s/iter; left time: 25.0102s
Updating learning rate to 7.801397942077431e-05
Epoch: 3 cost time: 5.193101167678833
Epoch: 3, Steps: 1027 | Train Loss: 0.5205795 Vali Loss: 0.3579590 Best vali loss: 0.3524402

best validation loss 0.35244023553983167

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014753553349, 'e_layers': 2, 'learning_rate': 0.0002449269749, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0658362
	speed: 0.0094s/iter; left time: 76.3043s
	iters: 200, epoch: 1 | loss: 0.2419121
	speed: 0.0033s/iter; left time: 26.4047s
	iters: 300, epoch: 1 | loss: 0.3197142
	speed: 0.0032s/iter; left time: 25.6552s
	iters: 400, epoch: 1 | loss: 0.2910393
	speed: 0.0032s/iter; left time: 24.8229s
	iters: 500, epoch: 1 | loss: 0.9095355
	speed: 0.0032s/iter; left time: 24.5511s
	iters: 600, epoch: 1 | loss: 0.4746069
	speed: 0.0032s/iter; left time: 24.0141s
	iters: 700, epoch: 1 | loss: 1.0200181
	speed: 0.0032s/iter; left time: 24.0558s
	iters: 800, epoch: 1 | loss: 0.9999896
	speed: 0.0032s/iter; left time: 23.6437s
	iters: 900, epoch: 1 | loss: 0.4044641
	speed: 0.0032s/iter; left time: 23.3216s
	iters: 1000, epoch: 1 | loss: 0.7606685
	speed: 0.0032s/iter; left time: 23.0292s
Updating learning rate to 0.0002449269749
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 3.6549904346466064
Epoch: 1, Steps: 1027 | Train Loss: 0.6487785 Vali Loss: 0.3743760 Best vali loss: 0.3743760
	iters: 100, epoch: 2 | loss: 0.3199120
	speed: 0.0097s/iter; left time: 68.7133s
	iters: 200, epoch: 2 | loss: 0.8670281
	speed: 0.0034s/iter; left time: 23.6188s
	iters: 300, epoch: 2 | loss: 0.4269474
	speed: 0.0034s/iter; left time: 23.2988s
	iters: 400, epoch: 2 | loss: 0.1807313
	speed: 0.0033s/iter; left time: 22.7451s
	iters: 500, epoch: 2 | loss: 0.2235044
	speed: 0.0034s/iter; left time: 22.4460s
	iters: 600, epoch: 2 | loss: 1.1240803
	speed: 0.0034s/iter; left time: 22.1434s
	iters: 700, epoch: 2 | loss: 1.1340321
	speed: 0.0034s/iter; left time: 21.8808s
	iters: 800, epoch: 2 | loss: 0.4710506
	speed: 0.0033s/iter; left time: 21.3618s
	iters: 900, epoch: 2 | loss: 0.5234652
	speed: 0.0034s/iter; left time: 21.1627s
	iters: 1000, epoch: 2 | loss: 0.4240353
	speed: 0.0034s/iter; left time: 20.8339s
Updating learning rate to 0.00012246348745
Validation loss decreased (0.3744 --> 0.3701).  Saving model state dict ...
Epoch: 2 cost time: 3.4948158264160156
Epoch: 2, Steps: 1027 | Train Loss: 0.5694787 Vali Loss: 0.3701268 Best vali loss: 0.3701268
	iters: 100, epoch: 3 | loss: 0.2355132
	speed: 0.0102s/iter; left time: 61.7635s
	iters: 200, epoch: 3 | loss: 0.4264592
	speed: 0.0034s/iter; left time: 20.1369s
	iters: 300, epoch: 3 | loss: 1.0793629
	speed: 0.0034s/iter; left time: 19.7929s
	iters: 400, epoch: 3 | loss: 0.3138440
	speed: 0.0034s/iter; left time: 19.3939s
	iters: 500, epoch: 3 | loss: 1.0027826
	speed: 0.0034s/iter; left time: 19.1330s
	iters: 600, epoch: 3 | loss: 0.7843858
	speed: 0.0034s/iter; left time: 18.7838s
	iters: 700, epoch: 3 | loss: 1.3240145
	speed: 0.0034s/iter; left time: 18.4589s
	iters: 800, epoch: 3 | loss: 1.0678133
	speed: 0.0034s/iter; left time: 18.1584s
	iters: 900, epoch: 3 | loss: 0.2902324
	speed: 0.0034s/iter; left time: 17.6318s
	iters: 1000, epoch: 3 | loss: 0.1730866
	speed: 0.0034s/iter; left time: 17.3434s
Updating learning rate to 6.1231743725e-05
Epoch: 3 cost time: 3.504918336868286
Epoch: 3, Steps: 1027 | Train Loss: 0.6697494 Vali Loss: 0.3787348 Best vali loss: 0.3701268

best validation loss 0.37012676113598003

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0067158532723, 'e_layers': 3, 'learning_rate': 0.0045008671186, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8620514
	speed: 0.0106s/iter; left time: 20.7926s
	iters: 200, epoch: 1 | loss: 0.8813274
	speed: 0.0045s/iter; left time: 8.4380s
Updating learning rate to 0.004329563064013795
Validation loss decreased (inf --> 0.4040).  Saving model state dict ...
Epoch: 1 cost time: 1.5194907188415527
Epoch: 1, Steps: 257 | Train Loss: 0.8716894 Vali Loss: 0.4040053 Best vali loss: 0.4040053
	iters: 100, epoch: 2 | loss: 0.6691660
	speed: 0.0099s/iter; left time: 16.9002s
	iters: 200, epoch: 2 | loss: 0.7688688
	speed: 0.0047s/iter; left time: 7.4585s
Updating learning rate to 0.0038417303896908085
Epoch: 2 cost time: 1.236107587814331
Epoch: 2, Steps: 257 | Train Loss: 0.7190174 Vali Loss: 0.4046234 Best vali loss: 0.4040053
	iters: 100, epoch: 3 | loss: 0.6238394
	speed: 0.0094s/iter; left time: 13.5703s
	iters: 200, epoch: 3 | loss: 0.5422125
	speed: 0.0043s/iter; left time: 5.8348s
Updating learning rate to 0.00311163719808251
Validation loss decreased (0.4040 --> 0.4039).  Saving model state dict ...
Epoch: 3 cost time: 1.1510365009307861
Epoch: 3, Steps: 257 | Train Loss: 0.5830260 Vali Loss: 0.4038709 Best vali loss: 0.4038709

best validation loss 0.40387086149283147

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063233400762, 'e_layers': 4, 'learning_rate': 0.0001128443107, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7873842
	speed: 0.0120s/iter; left time: 60.6360s
	iters: 200, epoch: 4 | loss: 0.3764866
	speed: 0.0054s/iter; left time: 26.6379s
	iters: 300, epoch: 4 | loss: 0.2814603
	speed: 0.0054s/iter; left time: 26.1582s
	iters: 400, epoch: 4 | loss: 0.3444202
	speed: 0.0054s/iter; left time: 25.3527s
	iters: 500, epoch: 4 | loss: 0.7998700
	speed: 0.0052s/iter; left time: 23.9963s
	iters: 600, epoch: 4 | loss: 0.3249428
	speed: 0.0049s/iter; left time: 22.3351s
	iters: 700, epoch: 4 | loss: 0.3713519
	speed: 0.0049s/iter; left time: 21.8657s
	iters: 800, epoch: 4 | loss: 0.6436719
	speed: 0.0049s/iter; left time: 21.3853s
	iters: 900, epoch: 4 | loss: 0.2051249
	speed: 0.0049s/iter; left time: 20.8130s
	iters: 1000, epoch: 4 | loss: 1.0325147
	speed: 0.0049s/iter; left time: 20.4219s
Updating learning rate to 5.642215535e-05
Validation loss decreased (0.3524 --> 0.3431).  Saving model state dict ...
Epoch: 4 cost time: 5.624457359313965
Epoch: 4, Steps: 1027 | Train Loss: 0.5167227 Vali Loss: 0.3430859 Best vali loss: 0.3430859
	iters: 100, epoch: 5 | loss: 0.6896272
	speed: 0.0137s/iter; left time: 55.1072s
	iters: 200, epoch: 5 | loss: 0.6372187
	speed: 0.0050s/iter; left time: 19.6375s
	iters: 300, epoch: 5 | loss: 0.5429998
	speed: 0.0050s/iter; left time: 19.2110s
	iters: 400, epoch: 5 | loss: 0.2607234
	speed: 0.0050s/iter; left time: 18.6871s
	iters: 500, epoch: 5 | loss: 0.9053650
	speed: 0.0051s/iter; left time: 18.2425s
	iters: 600, epoch: 5 | loss: 0.7674899
	speed: 0.0051s/iter; left time: 17.8656s
	iters: 700, epoch: 5 | loss: 0.2201268
	speed: 0.0050s/iter; left time: 17.1860s
	iters: 800, epoch: 5 | loss: 0.2935179
	speed: 0.0050s/iter; left time: 16.6796s
	iters: 900, epoch: 5 | loss: 1.1994545
	speed: 0.0050s/iter; left time: 16.1885s
	iters: 1000, epoch: 5 | loss: 0.2480865
	speed: 0.0050s/iter; left time: 15.6054s
Updating learning rate to 3.483033127922569e-05
Epoch: 5 cost time: 5.220916748046875
Epoch: 5, Steps: 1027 | Train Loss: 0.5764610 Vali Loss: 0.3660216 Best vali loss: 0.3430859
	iters: 100, epoch: 6 | loss: 0.6007149
	speed: 0.0133s/iter; left time: 39.7189s
	iters: 200, epoch: 6 | loss: 0.6061665
	speed: 0.0054s/iter; left time: 15.6410s
	iters: 300, epoch: 6 | loss: 0.2834576
	speed: 0.0054s/iter; left time: 15.0030s
	iters: 400, epoch: 6 | loss: 0.5774145
	speed: 0.0054s/iter; left time: 14.4246s
	iters: 500, epoch: 6 | loss: 0.3519697
	speed: 0.0054s/iter; left time: 13.8852s
	iters: 600, epoch: 6 | loss: 0.2483572
	speed: 0.0054s/iter; left time: 13.4237s
	iters: 700, epoch: 6 | loss: 0.4719199
	speed: 0.0054s/iter; left time: 12.8024s
	iters: 800, epoch: 6 | loss: 0.3006940
	speed: 0.0054s/iter; left time: 12.2589s
	iters: 900, epoch: 6 | loss: 0.2301491
	speed: 0.0054s/iter; left time: 11.7411s
	iters: 1000, epoch: 6 | loss: 0.4025932
	speed: 0.0054s/iter; left time: 11.2045s
Updating learning rate to 1.652566669285416e-05
Epoch: 6 cost time: 5.573288202285767
Epoch: 6, Steps: 1027 | Train Loss: 0.4073437 Vali Loss: 0.3704326 Best vali loss: 0.3430859
	iters: 100, epoch: 7 | loss: 0.3760786
	speed: 0.0133s/iter; left time: 25.9709s
	iters: 200, epoch: 7 | loss: 0.2919608
	speed: 0.0051s/iter; left time: 9.3912s
	iters: 300, epoch: 7 | loss: 0.1856586
	speed: 0.0050s/iter; left time: 8.8247s
	iters: 400, epoch: 7 | loss: 0.2423483
	speed: 0.0051s/iter; left time: 8.3920s
	iters: 500, epoch: 7 | loss: 0.3761221
	speed: 0.0051s/iter; left time: 7.9317s
	iters: 600, epoch: 7 | loss: 0.6574918
	speed: 0.0050s/iter; left time: 7.3328s
	iters: 700, epoch: 7 | loss: 0.7197654
	speed: 0.0050s/iter; left time: 6.8225s
	iters: 800, epoch: 7 | loss: 0.2429678
	speed: 0.0050s/iter; left time: 6.3314s
	iters: 900, epoch: 7 | loss: 0.4449362
	speed: 0.0050s/iter; left time: 5.7881s
	iters: 1000, epoch: 7 | loss: 0.3313448
	speed: 0.0050s/iter; left time: 5.3221s
Updating learning rate to 4.294880841962804e-06
Epoch: 7 cost time: 5.222113370895386
Epoch: 7, Steps: 1027 | Train Loss: 0.3868674 Vali Loss: 0.3781014 Best vali loss: 0.3430859
	iters: 100, epoch: 8 | loss: 0.1791354
	speed: 0.0131s/iter; left time: 12.1721s
	iters: 200, epoch: 8 | loss: 0.5847312
	speed: 0.0050s/iter; left time: 4.1749s
	iters: 300, epoch: 8 | loss: 0.1807199
	speed: 0.0051s/iter; left time: 3.6880s
	iters: 400, epoch: 8 | loss: 0.8622642
	speed: 0.0050s/iter; left time: 3.1666s
	iters: 500, epoch: 8 | loss: 0.4500466
	speed: 0.0051s/iter; left time: 2.6699s
	iters: 600, epoch: 8 | loss: 0.1663727
	speed: 0.0050s/iter; left time: 2.1494s
	iters: 700, epoch: 8 | loss: 0.1810104
	speed: 0.0050s/iter; left time: 1.6561s
	iters: 800, epoch: 8 | loss: 0.3548217
	speed: 0.0050s/iter; left time: 1.1440s
	iters: 900, epoch: 8 | loss: 0.1439157
	speed: 0.0050s/iter; left time: 0.6456s
	iters: 1000, epoch: 8 | loss: 0.3654045
	speed: 0.0050s/iter; left time: 0.1410s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.217531681060791
Epoch: 8, Steps: 1027 | Train Loss: 0.3468422 Vali Loss: 0.3815076 Best vali loss: 0.3430859

best validation loss 0.34308586640535965

[INFO][smbo.py:320] Finished 1450 trials.
{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0024322885552, 'e_layers': 4, 'learning_rate': 0.0037002690685, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7533551
	speed: 0.0111s/iter; left time: 44.6532s
	iters: 200, epoch: 1 | loss: 0.7363155
	speed: 0.0051s/iter; left time: 19.7773s
	iters: 300, epoch: 1 | loss: 0.9040396
	speed: 0.0051s/iter; left time: 19.3202s
	iters: 400, epoch: 1 | loss: 0.5529069
	speed: 0.0050s/iter; left time: 18.4987s
	iters: 500, epoch: 1 | loss: 1.2813363
	speed: 0.0043s/iter; left time: 15.6853s
Updating learning rate to 0.0037002690685
Validation loss decreased (inf --> 0.4001).  Saving model state dict ...
Epoch: 1 cost time: 2.860081195831299
Epoch: 1, Steps: 514 | Train Loss: 0.8455907 Vali Loss: 0.4001406 Best vali loss: 0.4001406
	iters: 100, epoch: 2 | loss: 0.5456755
	speed: 0.0102s/iter; left time: 35.5329s
	iters: 200, epoch: 2 | loss: 0.4814557
	speed: 0.0052s/iter; left time: 17.6972s
	iters: 300, epoch: 2 | loss: 0.2806197
	speed: 0.0049s/iter; left time: 16.1885s
	iters: 400, epoch: 2 | loss: 1.1432517
	speed: 0.0045s/iter; left time: 14.3841s
	iters: 500, epoch: 2 | loss: 0.2408713
	speed: 0.0048s/iter; left time: 14.8095s
Updating learning rate to 0.00185013453425
Epoch: 2 cost time: 2.577897787094116
Epoch: 2, Steps: 514 | Train Loss: 0.5383748 Vali Loss: 0.4028234 Best vali loss: 0.4001406
	iters: 100, epoch: 3 | loss: 0.4414559
	speed: 0.0094s/iter; left time: 28.1012s
	iters: 200, epoch: 3 | loss: 0.6344507
	speed: 0.0049s/iter; left time: 14.1123s
	iters: 300, epoch: 3 | loss: 0.4724421
	speed: 0.0051s/iter; left time: 14.1935s
	iters: 400, epoch: 3 | loss: 0.8841181
	speed: 0.0050s/iter; left time: 13.5260s
	iters: 500, epoch: 3 | loss: 0.4933696
	speed: 0.0052s/iter; left time: 13.4311s
Updating learning rate to 0.000925067267125
Epoch: 3 cost time: 2.6098856925964355
Epoch: 3, Steps: 514 | Train Loss: 0.5851673 Vali Loss: 0.4045526 Best vali loss: 0.4001406
	iters: 100, epoch: 4 | loss: 0.8384829
	speed: 0.0100s/iter; left time: 24.6547s
	iters: 200, epoch: 4 | loss: 1.0806695
	speed: 0.0052s/iter; left time: 12.2905s
	iters: 300, epoch: 4 | loss: 0.3906470
	speed: 0.0052s/iter; left time: 11.8649s
	iters: 400, epoch: 4 | loss: 0.6378263
	speed: 0.0052s/iter; left time: 11.2503s
	iters: 500, epoch: 4 | loss: 0.3194501
	speed: 0.0052s/iter; left time: 10.6856s
Updating learning rate to 0.0004625336335625
Epoch: 4 cost time: 2.710641622543335
Epoch: 4, Steps: 514 | Train Loss: 0.6534152 Vali Loss: 0.4039574 Best vali loss: 0.4001406
	iters: 100, epoch: 5 | loss: 0.5796415
	speed: 0.0101s/iter; left time: 19.7124s
	iters: 200, epoch: 5 | loss: 0.8836176
	speed: 0.0051s/iter; left time: 9.4580s
	iters: 300, epoch: 5 | loss: 0.7249297
	speed: 0.0052s/iter; left time: 9.1084s
	iters: 400, epoch: 5 | loss: 0.4903884
	speed: 0.0052s/iter; left time: 8.6338s
	iters: 500, epoch: 5 | loss: 1.0452787
	speed: 0.0052s/iter; left time: 8.1006s
Updating learning rate to 0.00023126681678125
Epoch: 5 cost time: 2.7034168243408203
Epoch: 5, Steps: 514 | Train Loss: 0.7447712 Vali Loss: 0.4035603 Best vali loss: 0.4001406
	iters: 100, epoch: 6 | loss: 0.6722172
	speed: 0.0102s/iter; left time: 14.6983s
	iters: 200, epoch: 6 | loss: 0.5024377
	speed: 0.0051s/iter; left time: 6.8273s
	iters: 300, epoch: 6 | loss: 0.7135273
	speed: 0.0051s/iter; left time: 6.3961s
	iters: 400, epoch: 6 | loss: 1.1677182
	speed: 0.0052s/iter; left time: 5.9821s
	iters: 500, epoch: 6 | loss: 0.4252813
	speed: 0.0049s/iter; left time: 5.0667s
Updating learning rate to 0.000115633408390625
Epoch: 6 cost time: 2.658665180206299
Epoch: 6, Steps: 514 | Train Loss: 0.6962363 Vali Loss: 0.4006883 Best vali loss: 0.4001406
	iters: 100, epoch: 7 | loss: 0.7322794
	speed: 0.0095s/iter; left time: 8.8067s
	iters: 200, epoch: 7 | loss: 0.6338670
	speed: 0.0045s/iter; left time: 3.7221s
	iters: 300, epoch: 7 | loss: 0.3303852
	speed: 0.0046s/iter; left time: 3.3182s
	iters: 400, epoch: 7 | loss: 0.4690767
	speed: 0.0048s/iter; left time: 3.0186s
	iters: 500, epoch: 7 | loss: 0.7863275
	speed: 0.0045s/iter; left time: 2.3673s
Updating learning rate to 5.78167041953125e-05
Validation loss decreased (0.4001 --> 0.3962).  Saving model state dict ...
Epoch: 7 cost time: 2.402287244796753
Epoch: 7, Steps: 514 | Train Loss: 0.5903872 Vali Loss: 0.3962260 Best vali loss: 0.3962260
	iters: 100, epoch: 8 | loss: 0.3564312
	speed: 0.0097s/iter; left time: 4.0307s
	iters: 200, epoch: 8 | loss: 0.4800519
	speed: 0.0048s/iter; left time: 1.5087s
	iters: 300, epoch: 8 | loss: 0.2932692
	speed: 0.0047s/iter; left time: 1.0070s
	iters: 400, epoch: 8 | loss: 0.5154880
	speed: 0.0047s/iter; left time: 0.5436s
	iters: 500, epoch: 8 | loss: 0.7108291
	speed: 0.0046s/iter; left time: 0.0695s
Updating learning rate to 2.890835209765625e-05
Validation loss decreased (0.3962 --> 0.3918).  Saving model state dict ...
Epoch: 8 cost time: 2.470595598220825
Epoch: 8, Steps: 514 | Train Loss: 0.4712139 Vali Loss: 0.3917885 Best vali loss: 0.3917885

best validation loss 0.3917885478915306

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0019719914036, 'e_layers': 3, 'learning_rate': 0.000145408864, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3357057
	speed: 0.0099s/iter; left time: 80.1603s
	iters: 200, epoch: 1 | loss: 0.4166321
	speed: 0.0036s/iter; left time: 29.2570s
	iters: 300, epoch: 1 | loss: 1.1624333
	speed: 0.0036s/iter; left time: 28.4842s
	iters: 400, epoch: 1 | loss: 0.4845584
	speed: 0.0036s/iter; left time: 28.1005s
	iters: 500, epoch: 1 | loss: 0.4197992
	speed: 0.0036s/iter; left time: 27.7207s
	iters: 600, epoch: 1 | loss: 0.6290031
	speed: 0.0036s/iter; left time: 27.2495s
	iters: 700, epoch: 1 | loss: 0.3039384
	speed: 0.0037s/iter; left time: 27.4509s
	iters: 800, epoch: 1 | loss: 0.8068317
	speed: 0.0036s/iter; left time: 26.7480s
	iters: 900, epoch: 1 | loss: 0.3353475
	speed: 0.0036s/iter; left time: 26.2627s
	iters: 1000, epoch: 1 | loss: 1.0340549
	speed: 0.0036s/iter; left time: 26.1315s
Updating learning rate to 0.000145408864
Validation loss decreased (inf --> 0.3792).  Saving model state dict ...
Epoch: 1 cost time: 4.075113534927368
Epoch: 1, Steps: 1027 | Train Loss: 0.5928304 Vali Loss: 0.3791758 Best vali loss: 0.3791758
	iters: 100, epoch: 2 | loss: 0.7856268
	speed: 0.0111s/iter; left time: 79.0079s
	iters: 200, epoch: 2 | loss: 0.3335577
	speed: 0.0040s/iter; left time: 27.9598s
	iters: 300, epoch: 2 | loss: 1.2516574
	speed: 0.0041s/iter; left time: 28.0440s
	iters: 400, epoch: 2 | loss: 0.2950090
	speed: 0.0041s/iter; left time: 27.6412s
	iters: 500, epoch: 2 | loss: 0.3550571
	speed: 0.0041s/iter; left time: 27.6804s
	iters: 600, epoch: 2 | loss: 0.2387716
	speed: 0.0042s/iter; left time: 27.4780s
	iters: 700, epoch: 2 | loss: 0.1995741
	speed: 0.0042s/iter; left time: 27.0495s
	iters: 800, epoch: 2 | loss: 0.7203816
	speed: 0.0041s/iter; left time: 26.4246s
	iters: 900, epoch: 2 | loss: 0.9057675
	speed: 0.0037s/iter; left time: 23.0544s
	iters: 1000, epoch: 2 | loss: 0.6168914
	speed: 0.0036s/iter; left time: 22.3264s
Updating learning rate to 7.2704432e-05
Validation loss decreased (0.3792 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 4.14004921913147
Epoch: 2, Steps: 1027 | Train Loss: 0.5702294 Vali Loss: 0.3702672 Best vali loss: 0.3702672
	iters: 100, epoch: 3 | loss: 0.2035210
	speed: 0.0107s/iter; left time: 64.9924s
	iters: 200, epoch: 3 | loss: 0.2340258
	speed: 0.0040s/iter; left time: 23.7193s
	iters: 300, epoch: 3 | loss: 0.7051867
	speed: 0.0040s/iter; left time: 23.4608s
	iters: 400, epoch: 3 | loss: 1.3094628
	speed: 0.0040s/iter; left time: 23.0432s
	iters: 500, epoch: 3 | loss: 0.6673372
	speed: 0.0040s/iter; left time: 22.3719s
	iters: 600, epoch: 3 | loss: 0.6076741
	speed: 0.0040s/iter; left time: 22.2029s
	iters: 700, epoch: 3 | loss: 0.8561873
	speed: 0.0040s/iter; left time: 21.8014s
	iters: 800, epoch: 3 | loss: 0.2666473
	speed: 0.0040s/iter; left time: 21.3439s
	iters: 900, epoch: 3 | loss: 0.2732013
	speed: 0.0040s/iter; left time: 20.9867s
	iters: 1000, epoch: 3 | loss: 0.3105453
	speed: 0.0040s/iter; left time: 20.6165s
Updating learning rate to 3.6352216e-05
Validation loss decreased (0.3703 --> 0.3692).  Saving model state dict ...
Epoch: 3 cost time: 4.133601665496826
Epoch: 3, Steps: 1027 | Train Loss: 0.5433789 Vali Loss: 0.3691740 Best vali loss: 0.3691740
	iters: 100, epoch: 4 | loss: 0.7080836
	speed: 0.0111s/iter; left time: 55.9804s
	iters: 200, epoch: 4 | loss: 0.6032961
	speed: 0.0040s/iter; left time: 19.5133s
	iters: 300, epoch: 4 | loss: 0.3043866
	speed: 0.0039s/iter; left time: 19.0346s
	iters: 400, epoch: 4 | loss: 0.3978414
	speed: 0.0040s/iter; left time: 18.7517s
	iters: 500, epoch: 4 | loss: 0.2310799
	speed: 0.0039s/iter; left time: 18.2965s
	iters: 600, epoch: 4 | loss: 1.7362107
	speed: 0.0039s/iter; left time: 17.8226s
	iters: 700, epoch: 4 | loss: 1.4620215
	speed: 0.0039s/iter; left time: 17.4202s
	iters: 800, epoch: 4 | loss: 1.0272472
	speed: 0.0040s/iter; left time: 17.3849s
	iters: 900, epoch: 4 | loss: 1.4200150
	speed: 0.0039s/iter; left time: 16.4488s
	iters: 1000, epoch: 4 | loss: 0.6696202
	speed: 0.0038s/iter; left time: 15.9021s
Updating learning rate to 1.8176108e-05
Epoch: 4 cost time: 4.081310033798218
Epoch: 4, Steps: 1027 | Train Loss: 0.8559802 Vali Loss: 0.3695435 Best vali loss: 0.3691740
	iters: 100, epoch: 5 | loss: 0.3889199
	speed: 0.0108s/iter; left time: 43.3372s
	iters: 200, epoch: 5 | loss: 0.3792320
	speed: 0.0039s/iter; left time: 15.1243s
	iters: 300, epoch: 5 | loss: 1.1534497
	speed: 0.0039s/iter; left time: 14.8808s
	iters: 400, epoch: 5 | loss: 0.7746192
	speed: 0.0039s/iter; left time: 14.3225s
	iters: 500, epoch: 5 | loss: 0.8283976
	speed: 0.0039s/iter; left time: 14.0390s
	iters: 600, epoch: 5 | loss: 0.3598985
	speed: 0.0040s/iter; left time: 14.0531s
	iters: 700, epoch: 5 | loss: 0.4364423
	speed: 0.0040s/iter; left time: 13.4929s
	iters: 800, epoch: 5 | loss: 0.3398485
	speed: 0.0042s/iter; left time: 13.8093s
	iters: 900, epoch: 5 | loss: 0.2038022
	speed: 0.0042s/iter; left time: 13.3600s
	iters: 1000, epoch: 5 | loss: 0.5614364
	speed: 0.0042s/iter; left time: 12.9381s
Updating learning rate to 9.088054e-06
Validation loss decreased (0.3692 --> 0.3685).  Saving model state dict ...
Epoch: 5 cost time: 4.142908096313477
Epoch: 5, Steps: 1027 | Train Loss: 0.5426046 Vali Loss: 0.3685485 Best vali loss: 0.3685485
	iters: 100, epoch: 6 | loss: 0.4834139
	speed: 0.0112s/iter; left time: 33.3355s
	iters: 200, epoch: 6 | loss: 0.9269141
	speed: 0.0042s/iter; left time: 12.1655s
	iters: 300, epoch: 6 | loss: 0.2900827
	speed: 0.0041s/iter; left time: 11.3165s
	iters: 400, epoch: 6 | loss: 0.4511496
	speed: 0.0039s/iter; left time: 10.3794s
	iters: 500, epoch: 6 | loss: 0.2998877
	speed: 0.0039s/iter; left time: 9.9463s
	iters: 600, epoch: 6 | loss: 0.3310034
	speed: 0.0039s/iter; left time: 9.6628s
	iters: 700, epoch: 6 | loss: 0.3265756
	speed: 0.0039s/iter; left time: 9.3178s
	iters: 800, epoch: 6 | loss: 0.3899219
	speed: 0.0039s/iter; left time: 8.9770s
	iters: 900, epoch: 6 | loss: 0.9427943
	speed: 0.0040s/iter; left time: 8.6698s
	iters: 1000, epoch: 6 | loss: 0.1936965
	speed: 0.0038s/iter; left time: 7.8639s
Updating learning rate to 4.544027e-06
Epoch: 6 cost time: 4.115911960601807
Epoch: 6, Steps: 1027 | Train Loss: 0.4635440 Vali Loss: 0.3688055 Best vali loss: 0.3685485
	iters: 100, epoch: 7 | loss: 0.3596041
	speed: 0.0102s/iter; left time: 19.9971s
	iters: 200, epoch: 7 | loss: 0.2557147
	speed: 0.0035s/iter; left time: 6.5470s
	iters: 300, epoch: 7 | loss: 0.2719663
	speed: 0.0035s/iter; left time: 6.1909s
	iters: 400, epoch: 7 | loss: 0.2291015
	speed: 0.0035s/iter; left time: 5.7708s
	iters: 500, epoch: 7 | loss: 0.1656672
	speed: 0.0035s/iter; left time: 5.4615s
	iters: 600, epoch: 7 | loss: 0.1987225
	speed: 0.0035s/iter; left time: 5.1178s
	iters: 700, epoch: 7 | loss: 0.2374637
	speed: 0.0035s/iter; left time: 4.7493s
	iters: 800, epoch: 7 | loss: 0.2480207
	speed: 0.0036s/iter; left time: 4.5492s
	iters: 900, epoch: 7 | loss: 1.0462072
	speed: 0.0037s/iter; left time: 4.2267s
	iters: 1000, epoch: 7 | loss: 0.3779385
	speed: 0.0041s/iter; left time: 4.2967s
Updating learning rate to 2.2720135e-06
Epoch: 7 cost time: 3.7474334239959717
Epoch: 7, Steps: 1027 | Train Loss: 0.3390406 Vali Loss: 0.3688960 Best vali loss: 0.3685485
	iters: 100, epoch: 8 | loss: 0.4811217
	speed: 0.0108s/iter; left time: 10.0277s
	iters: 200, epoch: 8 | loss: 0.3533126
	speed: 0.0035s/iter; left time: 2.9237s
	iters: 300, epoch: 8 | loss: 0.3759396
	speed: 0.0035s/iter; left time: 2.5250s
	iters: 400, epoch: 8 | loss: 0.9033940
	speed: 0.0035s/iter; left time: 2.1938s
	iters: 500, epoch: 8 | loss: 0.4370706
	speed: 0.0035s/iter; left time: 1.8331s
	iters: 600, epoch: 8 | loss: 0.5823878
	speed: 0.0035s/iter; left time: 1.4880s
	iters: 700, epoch: 8 | loss: 0.3305218
	speed: 0.0035s/iter; left time: 1.1383s
	iters: 800, epoch: 8 | loss: 0.3988172
	speed: 0.0035s/iter; left time: 0.7968s
	iters: 900, epoch: 8 | loss: 0.4596742
	speed: 0.0035s/iter; left time: 0.4479s
	iters: 1000, epoch: 8 | loss: 1.1306398
	speed: 0.0035s/iter; left time: 0.0982s
Updating learning rate to 1.13600675e-06
Epoch: 8 cost time: 3.6649153232574463
Epoch: 8, Steps: 1027 | Train Loss: 0.5452879 Vali Loss: 0.3689543 Best vali loss: 0.3685485

best validation loss 0.3685485298190932

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0010674370391, 'e_layers': 2, 'learning_rate': 0.0003178078399, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3821789
	speed: 0.0096s/iter; left time: 78.2294s
	iters: 200, epoch: 1 | loss: 0.3624054
	speed: 0.0033s/iter; left time: 26.8474s
	iters: 300, epoch: 1 | loss: 0.6904567
	speed: 0.0034s/iter; left time: 26.6765s
	iters: 400, epoch: 1 | loss: 0.4524617
	speed: 0.0034s/iter; left time: 26.6547s
	iters: 500, epoch: 1 | loss: 0.1598081
	speed: 0.0034s/iter; left time: 26.2155s
	iters: 600, epoch: 1 | loss: 0.2530777
	speed: 0.0034s/iter; left time: 25.8211s
	iters: 700, epoch: 1 | loss: 0.2927917
	speed: 0.0034s/iter; left time: 25.5227s
	iters: 800, epoch: 1 | loss: 1.0592641
	speed: 0.0034s/iter; left time: 25.0224s
	iters: 900, epoch: 1 | loss: 0.3745137
	speed: 0.0034s/iter; left time: 24.6323s
	iters: 1000, epoch: 1 | loss: 1.0827132
	speed: 0.0034s/iter; left time: 24.4592s
Updating learning rate to 0.0003178078399
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 3.8341002464294434
Epoch: 1, Steps: 1027 | Train Loss: 0.5109671 Vali Loss: 0.3749473 Best vali loss: 0.3749473
	iters: 100, epoch: 2 | loss: 0.8260214
	speed: 0.0096s/iter; left time: 68.1813s
	iters: 200, epoch: 2 | loss: 0.4535650
	speed: 0.0032s/iter; left time: 22.1698s
	iters: 300, epoch: 2 | loss: 0.4094416
	speed: 0.0032s/iter; left time: 21.8811s
	iters: 400, epoch: 2 | loss: 0.4938236
	speed: 0.0032s/iter; left time: 21.4904s
	iters: 500, epoch: 2 | loss: 0.2952536
	speed: 0.0032s/iter; left time: 21.2136s
	iters: 600, epoch: 2 | loss: 0.2758797
	speed: 0.0031s/iter; left time: 20.6894s
	iters: 700, epoch: 2 | loss: 0.5278026
	speed: 0.0032s/iter; left time: 20.6141s
	iters: 800, epoch: 2 | loss: 0.2319910
	speed: 0.0032s/iter; left time: 20.2627s
	iters: 900, epoch: 2 | loss: 0.5768442
	speed: 0.0032s/iter; left time: 20.0032s
	iters: 1000, epoch: 2 | loss: 1.6050858
	speed: 0.0032s/iter; left time: 19.5688s
Updating learning rate to 0.00015890391995
Epoch: 2 cost time: 3.2955644130706787
Epoch: 2, Steps: 1027 | Train Loss: 0.5695708 Vali Loss: 0.3884105 Best vali loss: 0.3749473
	iters: 100, epoch: 3 | loss: 0.2692306
	speed: 0.0093s/iter; left time: 56.5856s
	iters: 200, epoch: 3 | loss: 0.2469878
	speed: 0.0030s/iter; left time: 17.6774s
	iters: 300, epoch: 3 | loss: 0.2963343
	speed: 0.0029s/iter; left time: 17.1131s
	iters: 400, epoch: 3 | loss: 0.5097635
	speed: 0.0030s/iter; left time: 17.0309s
	iters: 500, epoch: 3 | loss: 1.1261245
	speed: 0.0029s/iter; left time: 16.5883s
	iters: 600, epoch: 3 | loss: 0.6249164
	speed: 0.0029s/iter; left time: 16.1894s
	iters: 700, epoch: 3 | loss: 0.4742633
	speed: 0.0029s/iter; left time: 15.9787s
	iters: 800, epoch: 3 | loss: 0.2351926
	speed: 0.0030s/iter; left time: 16.0610s
	iters: 900, epoch: 3 | loss: 0.2633292
	speed: 0.0031s/iter; left time: 16.5569s
	iters: 1000, epoch: 3 | loss: 0.7065755
	speed: 0.0031s/iter; left time: 16.2179s
Updating learning rate to 7.9451959975e-05
Epoch: 3 cost time: 3.1227736473083496
Epoch: 3, Steps: 1027 | Train Loss: 0.4752718 Vali Loss: 0.3841802 Best vali loss: 0.3749473

best validation loss 0.37494725713209925

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3492619
	speed: 0.0097s/iter; left time: 39.0399s
	iters: 200, epoch: 1 | loss: 0.3521847
	speed: 0.0035s/iter; left time: 13.6429s
	iters: 300, epoch: 1 | loss: 0.4668783
	speed: 0.0036s/iter; left time: 13.7459s
	iters: 400, epoch: 1 | loss: 0.4900540
	speed: 0.0034s/iter; left time: 12.6749s
	iters: 500, epoch: 1 | loss: 1.2631004
	speed: 0.0034s/iter; left time: 12.2720s
Updating learning rate to 0.0003957152226005332
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 2.147292375564575
Epoch: 1, Steps: 514 | Train Loss: 0.5842959 Vali Loss: 0.3742300 Best vali loss: 0.3742300
	iters: 100, epoch: 2 | loss: 1.0580093
	speed: 0.0067s/iter; left time: 23.6076s
	iters: 200, epoch: 2 | loss: 0.4214859
	speed: 0.0029s/iter; left time: 10.0094s
	iters: 300, epoch: 2 | loss: 0.6174058
	speed: 0.0032s/iter; left time: 10.4947s
	iters: 400, epoch: 2 | loss: 0.4495524
	speed: 0.0031s/iter; left time: 9.8414s
	iters: 500, epoch: 2 | loss: 0.4218730
	speed: 0.0031s/iter; left time: 9.5299s
Updating learning rate to 0.00035112808702649433
Validation loss decreased (0.3742 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 1.6033759117126465
Epoch: 2, Steps: 514 | Train Loss: 0.5936653 Vali Loss: 0.3683428 Best vali loss: 0.3683428
	iters: 100, epoch: 3 | loss: 0.3436159
	speed: 0.0070s/iter; left time: 20.7948s
	iters: 200, epoch: 3 | loss: 0.6213594
	speed: 0.0032s/iter; left time: 9.0989s
	iters: 300, epoch: 3 | loss: 0.4099818
	speed: 0.0033s/iter; left time: 9.1281s
	iters: 400, epoch: 3 | loss: 0.4658582
	speed: 0.0032s/iter; left time: 8.4972s
	iters: 500, epoch: 3 | loss: 0.6474511
	speed: 0.0031s/iter; left time: 7.9035s
Updating learning rate to 0.00028439872298564043
Validation loss decreased (0.3683 --> 0.3482).  Saving model state dict ...
Epoch: 3 cost time: 1.6655378341674805
Epoch: 3, Steps: 514 | Train Loss: 0.4976533 Vali Loss: 0.3482008 Best vali loss: 0.3482008

best validation loss 0.34820077825037576

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0078589152673, 'e_layers': 1, 'learning_rate': 0.0041979510286, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004038176031204122
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 0.6034927368164062
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3674517 Best vali loss: 0.3674517
Updating learning rate to 0.003583175334006051
Epoch: 2 cost time: 0.31121182441711426
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3821901 Best vali loss: 0.3674517
Updating learning rate to 0.002902218668562604
Validation loss decreased (0.3675 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 0.2982785701751709
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3672820 Best vali loss: 0.3672820

best validation loss 0.36728203078852656

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022158696115, 'e_layers': 2, 'learning_rate': 0.0004113721425, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3604261
	speed: 0.0094s/iter; left time: 23.2836s
	iters: 200, epoch: 4 | loss: 0.2487705
	speed: 0.0031s/iter; left time: 7.4215s
	iters: 300, epoch: 4 | loss: 0.3643030
	speed: 0.0031s/iter; left time: 7.0495s
	iters: 400, epoch: 4 | loss: 0.4081773
	speed: 0.0032s/iter; left time: 6.8596s
	iters: 500, epoch: 4 | loss: 0.7571079
	speed: 0.0031s/iter; left time: 6.4451s
Updating learning rate to 0.00020568607125
Validation loss decreased (0.3482 --> 0.3480).  Saving model state dict ...
Epoch: 4 cost time: 1.9589881896972656
Epoch: 4, Steps: 514 | Train Loss: 0.4277570 Vali Loss: 0.3479642 Best vali loss: 0.3479642
	iters: 100, epoch: 5 | loss: 0.6445132
	speed: 0.0069s/iter; left time: 13.5856s
	iters: 200, epoch: 5 | loss: 0.4249515
	speed: 0.0031s/iter; left time: 5.7561s
	iters: 300, epoch: 5 | loss: 0.5141189
	speed: 0.0030s/iter; left time: 5.1954s
	iters: 400, epoch: 5 | loss: 0.4253015
	speed: 0.0030s/iter; left time: 4.9019s
	iters: 500, epoch: 5 | loss: 0.3708594
	speed: 0.0030s/iter; left time: 4.6136s
Updating learning rate to 0.0001269734195143596
Validation loss decreased (0.3480 --> 0.3453).  Saving model state dict ...
Epoch: 5 cost time: 1.5935420989990234
Epoch: 5, Steps: 514 | Train Loss: 0.4759489 Vali Loss: 0.3452991 Best vali loss: 0.3452991
	iters: 100, epoch: 6 | loss: 0.3278095
	speed: 0.0073s/iter; left time: 10.4944s
	iters: 200, epoch: 6 | loss: 0.5292734
	speed: 0.0036s/iter; left time: 4.8902s
	iters: 300, epoch: 6 | loss: 0.3808509
	speed: 0.0036s/iter; left time: 4.5048s
	iters: 400, epoch: 6 | loss: 0.3793067
	speed: 0.0036s/iter; left time: 4.1476s
	iters: 500, epoch: 6 | loss: 0.5769703
	speed: 0.0036s/iter; left time: 3.7398s
Updating learning rate to 6.024405547350564e-05
Epoch: 6 cost time: 1.89805006980896
Epoch: 6, Steps: 514 | Train Loss: 0.4388422 Vali Loss: 0.3529362 Best vali loss: 0.3452991
	iters: 100, epoch: 7 | loss: 0.3235905
	speed: 0.0073s/iter; left time: 6.7472s
	iters: 200, epoch: 7 | loss: 0.5550508
	speed: 0.0033s/iter; left time: 2.7039s
	iters: 300, epoch: 7 | loss: 0.4192640
	speed: 0.0032s/iter; left time: 2.3628s
	iters: 400, epoch: 7 | loss: 0.2802543
	speed: 0.0033s/iter; left time: 2.0645s
	iters: 500, epoch: 7 | loss: 0.6512062
	speed: 0.0033s/iter; left time: 1.7234s
Updating learning rate to 1.5656919899466785e-05
Epoch: 7 cost time: 1.7265021800994873
Epoch: 7, Steps: 514 | Train Loss: 0.4458731 Vali Loss: 0.3517148 Best vali loss: 0.3452991
	iters: 100, epoch: 8 | loss: 0.6304027
	speed: 0.0071s/iter; left time: 2.9454s
	iters: 200, epoch: 8 | loss: 0.3421207
	speed: 0.0032s/iter; left time: 1.0125s
	iters: 300, epoch: 8 | loss: 0.3801679
	speed: 0.0032s/iter; left time: 0.6862s
	iters: 400, epoch: 8 | loss: 0.4111163
	speed: 0.0032s/iter; left time: 0.3730s
	iters: 500, epoch: 8 | loss: 0.6989480
	speed: 0.0033s/iter; left time: 0.0500s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.708329439163208
Epoch: 8, Steps: 514 | Train Loss: 0.4925511 Vali Loss: 0.3526224 Best vali loss: 0.3452991

best validation loss 0.345299092912955

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008340124584, 'e_layers': 1, 'learning_rate': 0.0030189587933, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8101249
	speed: 0.0093s/iter; left time: 8.6542s
Updating learning rate to 0.0030189587933
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 0.7584259510040283
Epoch: 1, Steps: 129 | Train Loss: 0.8101249 Vali Loss: 0.3681000 Best vali loss: 0.3681000
	iters: 100, epoch: 2 | loss: 0.5585278
	speed: 0.0059s/iter; left time: 4.7175s
Updating learning rate to 0.00150947939665
Epoch: 2 cost time: 0.44356369972229004
Epoch: 2, Steps: 129 | Train Loss: 0.5585278 Vali Loss: 0.3739460 Best vali loss: 0.3681000
	iters: 100, epoch: 3 | loss: 0.5788633
	speed: 0.0058s/iter; left time: 3.8951s
Updating learning rate to 0.000754739698325
Epoch: 3 cost time: 0.42865729331970215
Epoch: 3, Steps: 129 | Train Loss: 0.5788633 Vali Loss: 0.3812694 Best vali loss: 0.3681000
	iters: 100, epoch: 4 | loss: 0.5583519
	speed: 0.0058s/iter; left time: 3.1419s
Updating learning rate to 0.0003773698491625
Epoch: 4 cost time: 0.44306111335754395
Epoch: 4, Steps: 129 | Train Loss: 0.5583519 Vali Loss: 0.3781743 Best vali loss: 0.3681000
	iters: 100, epoch: 5 | loss: 0.4459797
	speed: 0.0060s/iter; left time: 2.4922s
Updating learning rate to 0.00018868492458125
Epoch: 5 cost time: 0.46044278144836426
Epoch: 5, Steps: 129 | Train Loss: 0.4459797 Vali Loss: 0.3881148 Best vali loss: 0.3681000
	iters: 100, epoch: 6 | loss: 0.5212941
	speed: 0.0059s/iter; left time: 1.6897s
Updating learning rate to 9.4342462290625e-05
Epoch: 6 cost time: 0.4495048522949219
Epoch: 6, Steps: 129 | Train Loss: 0.5212941 Vali Loss: 0.3913647 Best vali loss: 0.3681000
	iters: 100, epoch: 7 | loss: 0.6425822
	speed: 0.0059s/iter; left time: 0.9346s
Updating learning rate to 4.71712311453125e-05
Epoch: 7 cost time: 0.4372241497039795
Epoch: 7, Steps: 129 | Train Loss: 0.6425822 Vali Loss: 0.3941341 Best vali loss: 0.3681000
	iters: 100, epoch: 8 | loss: 0.5149814
	speed: 0.0059s/iter; left time: 0.1772s
Updating learning rate to 2.358561557265625e-05
Epoch: 8 cost time: 0.44888949394226074
Epoch: 8, Steps: 129 | Train Loss: 0.5149814 Vali Loss: 0.3946456 Best vali loss: 0.3681000

best validation loss 0.3681000251432767

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.001063016946, 'e_layers': 2, 'learning_rate': 0.0003791419802, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3497817
	speed: 0.0096s/iter; left time: 38.5023s
	iters: 200, epoch: 1 | loss: 0.3481997
	speed: 0.0032s/iter; left time: 12.6662s
	iters: 300, epoch: 1 | loss: 0.4674078
	speed: 0.0033s/iter; left time: 12.4330s
	iters: 400, epoch: 1 | loss: 0.4921254
	speed: 0.0033s/iter; left time: 12.0849s
	iters: 500, epoch: 1 | loss: 1.2327228
	speed: 0.0031s/iter; left time: 11.3569s
Updating learning rate to 0.0003791419802
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 2.0204010009765625
Epoch: 1, Steps: 514 | Train Loss: 0.5780475 Vali Loss: 0.3712332 Best vali loss: 0.3712332
	iters: 100, epoch: 2 | loss: 1.0181239
	speed: 0.0069s/iter; left time: 23.9886s
	iters: 200, epoch: 2 | loss: 0.4314870
	speed: 0.0031s/iter; left time: 10.4570s
	iters: 300, epoch: 2 | loss: 0.6558667
	speed: 0.0030s/iter; left time: 9.8897s
	iters: 400, epoch: 2 | loss: 0.4382672
	speed: 0.0029s/iter; left time: 9.3481s
	iters: 500, epoch: 2 | loss: 0.4157828
	speed: 0.0031s/iter; left time: 9.5898s
Updating learning rate to 0.0001895709901
Validation loss decreased (0.3712 --> 0.3581).  Saving model state dict ...
Epoch: 2 cost time: 1.5970470905303955
Epoch: 2, Steps: 514 | Train Loss: 0.5919055 Vali Loss: 0.3580657 Best vali loss: 0.3580657
	iters: 100, epoch: 3 | loss: 0.3466384
	speed: 0.0069s/iter; left time: 20.6238s
	iters: 200, epoch: 3 | loss: 0.6235389
	speed: 0.0031s/iter; left time: 8.9754s
	iters: 300, epoch: 3 | loss: 0.4048048
	speed: 0.0030s/iter; left time: 8.4764s
	iters: 400, epoch: 3 | loss: 0.4693392
	speed: 0.0030s/iter; left time: 8.0471s
	iters: 500, epoch: 3 | loss: 0.6610573
	speed: 0.0030s/iter; left time: 7.8235s
Updating learning rate to 9.478549505e-05
Validation loss decreased (0.3581 --> 0.3543).  Saving model state dict ...
Epoch: 3 cost time: 1.611647367477417
Epoch: 3, Steps: 514 | Train Loss: 0.5010757 Vali Loss: 0.3543192 Best vali loss: 0.3543192
	iters: 100, epoch: 4 | loss: 0.3228628
	speed: 0.0069s/iter; left time: 17.0159s
	iters: 200, epoch: 4 | loss: 0.6410859
	speed: 0.0030s/iter; left time: 7.2042s
	iters: 300, epoch: 4 | loss: 0.5210733
	speed: 0.0030s/iter; left time: 6.8915s
	iters: 400, epoch: 4 | loss: 0.3064466
	speed: 0.0030s/iter; left time: 6.5129s
	iters: 500, epoch: 4 | loss: 0.7899198
	speed: 0.0030s/iter; left time: 6.2681s
Updating learning rate to 4.7392747525e-05
Validation loss decreased (0.3543 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 1.5962915420532227
Epoch: 4, Steps: 514 | Train Loss: 0.5162777 Vali Loss: 0.3512908 Best vali loss: 0.3512908
	iters: 100, epoch: 5 | loss: 0.7069762
	speed: 0.0070s/iter; left time: 13.6209s
	iters: 200, epoch: 5 | loss: 0.3665932
	speed: 0.0030s/iter; left time: 5.6170s
	iters: 300, epoch: 5 | loss: 0.4485088
	speed: 0.0029s/iter; left time: 5.1575s
	iters: 400, epoch: 5 | loss: 0.4706232
	speed: 0.0032s/iter; left time: 5.2954s
	iters: 500, epoch: 5 | loss: 0.7747929
	speed: 0.0032s/iter; left time: 4.9483s
Updating learning rate to 2.36963737625e-05
Validation loss decreased (0.3513 --> 0.3482).  Saving model state dict ...
Epoch: 5 cost time: 1.6407499313354492
Epoch: 5, Steps: 514 | Train Loss: 0.5534989 Vali Loss: 0.3482167 Best vali loss: 0.3482167
	iters: 100, epoch: 6 | loss: 0.7250028
	speed: 0.0069s/iter; left time: 9.8943s
	iters: 200, epoch: 6 | loss: 0.4011636
	speed: 0.0031s/iter; left time: 4.1588s
	iters: 300, epoch: 6 | loss: 0.3411795
	speed: 0.0032s/iter; left time: 3.9363s
	iters: 400, epoch: 6 | loss: 0.5394636
	speed: 0.0031s/iter; left time: 3.5276s
	iters: 500, epoch: 6 | loss: 0.5481415
	speed: 0.0031s/iter; left time: 3.1959s
Updating learning rate to 1.184818688125e-05
Epoch: 6 cost time: 1.6383459568023682
Epoch: 6, Steps: 514 | Train Loss: 0.5109902 Vali Loss: 0.3540540 Best vali loss: 0.3482167
	iters: 100, epoch: 7 | loss: 0.6682037
	speed: 0.0070s/iter; left time: 6.4858s
	iters: 200, epoch: 7 | loss: 0.3682254
	speed: 0.0031s/iter; left time: 2.5514s
	iters: 300, epoch: 7 | loss: 0.2477793
	speed: 0.0030s/iter; left time: 2.1662s
	iters: 400, epoch: 7 | loss: 0.2171222
	speed: 0.0030s/iter; left time: 1.9122s
	iters: 500, epoch: 7 | loss: 0.3268040
	speed: 0.0030s/iter; left time: 1.6099s
Updating learning rate to 5.924093440625e-06
Epoch: 7 cost time: 1.6224853992462158
Epoch: 7, Steps: 514 | Train Loss: 0.3656269 Vali Loss: 0.3499675 Best vali loss: 0.3482167
	iters: 100, epoch: 8 | loss: 0.3537922
	speed: 0.0067s/iter; left time: 2.7678s
	iters: 200, epoch: 8 | loss: 0.5057080
	speed: 0.0031s/iter; left time: 0.9728s
	iters: 300, epoch: 8 | loss: 0.4097629
	speed: 0.0031s/iter; left time: 0.6708s
	iters: 400, epoch: 8 | loss: 0.7741097
	speed: 0.0031s/iter; left time: 0.3543s
	iters: 500, epoch: 8 | loss: 0.8390138
	speed: 0.0031s/iter; left time: 0.0463s
Updating learning rate to 2.9620467203125e-06
Epoch: 8 cost time: 1.6245980262756348
Epoch: 8, Steps: 514 | Train Loss: 0.5764773 Vali Loss: 0.3496193 Best vali loss: 0.3482167

best validation loss 0.34821670677198174

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022932361561, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006801156634165616
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 0.8026418685913086
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3686187 Best vali loss: 0.3686187
Updating learning rate to 0.0006034837636086699
Epoch: 2 cost time: 0.4927246570587158
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3809994 Best vali loss: 0.3686187
Updating learning rate to 0.0004887960207521749
Validation loss decreased (0.3686 --> 0.3668).  Saving model state dict ...
Epoch: 3 cost time: 0.49576830863952637
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3667686 Best vali loss: 0.3667686

best validation loss 0.36676861764405705

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0057078108737, 'e_layers': 1, 'learning_rate': 0.0044149505431, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00424691649345984
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 0.6132547855377197
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3737139 Best vali loss: 0.3737139
Updating learning rate to 0.00376839600536462
Validation loss decreased (0.3737 --> 0.3706).  Saving model state dict ...
Epoch: 2 cost time: 0.3082578182220459
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3706210 Best vali loss: 0.3706210
Updating learning rate to 0.0030522394853278127
Epoch: 3 cost time: 0.3173646926879883
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3855705 Best vali loss: 0.3706210

best validation loss 0.37062100039718193

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022176884584, 'e_layers': 4, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4146518
	speed: 0.0111s/iter; left time: 44.6983s
	iters: 200, epoch: 1 | loss: 0.3394519
	speed: 0.0046s/iter; left time: 17.8320s
	iters: 300, epoch: 1 | loss: 0.4166539
	speed: 0.0047s/iter; left time: 17.9855s
	iters: 400, epoch: 1 | loss: 0.3337518
	speed: 0.0048s/iter; left time: 17.9322s
	iters: 500, epoch: 1 | loss: 0.8913854
	speed: 0.0047s/iter; left time: 17.0069s
Updating learning rate to 0.0003789142607398986
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 2.7931711673736572
Epoch: 1, Steps: 514 | Train Loss: 0.4791790 Vali Loss: 0.3749065 Best vali loss: 0.3749065
	iters: 100, epoch: 2 | loss: 1.1100870
	speed: 0.0096s/iter; left time: 33.5984s
	iters: 200, epoch: 2 | loss: 0.9579161
	speed: 0.0047s/iter; left time: 16.0264s
	iters: 300, epoch: 2 | loss: 0.5969052
	speed: 0.0048s/iter; left time: 15.7864s
	iters: 400, epoch: 2 | loss: 0.3996924
	speed: 0.0046s/iter; left time: 14.7401s
	iters: 500, epoch: 2 | loss: 0.4489289
	speed: 0.0045s/iter; left time: 14.0813s
Updating learning rate to 0.00033622017026867744
Epoch: 2 cost time: 2.4405882358551025
Epoch: 2, Steps: 514 | Train Loss: 0.7027060 Vali Loss: 0.3782583 Best vali loss: 0.3749065
	iters: 100, epoch: 3 | loss: 0.4007355
	speed: 0.0095s/iter; left time: 28.3252s
	iters: 200, epoch: 3 | loss: 0.5070035
	speed: 0.0048s/iter; left time: 13.7712s
	iters: 300, epoch: 3 | loss: 0.7563096
	speed: 0.0048s/iter; left time: 13.2403s
	iters: 400, epoch: 3 | loss: 0.3576526
	speed: 0.0047s/iter; left time: 12.5776s
	iters: 500, epoch: 3 | loss: 1.1096178
	speed: 0.0047s/iter; left time: 12.2465s
Updating learning rate to 0.00027232394843768623
Epoch: 3 cost time: 2.4902422428131104
Epoch: 3, Steps: 514 | Train Loss: 0.6262638 Vali Loss: 0.3810928 Best vali loss: 0.3749065

best validation loss 0.374906523291512

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022932361561, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00035351260405
Validation loss decreased (0.3668 --> 0.3625).  Saving model state dict ...
Epoch: 4 cost time: 0.8160877227783203
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3625011 Best vali loss: 0.3625011
Updating learning rate to 0.0002182291873478251
Validation loss decreased (0.3625 --> 0.3554).  Saving model state dict ...
Epoch: 5 cost time: 0.4875519275665283
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3554085 Best vali loss: 0.3554085
Updating learning rate to 0.00010354144449133006
Validation loss decreased (0.3554 --> 0.3518).  Saving model state dict ...
Epoch: 6 cost time: 0.5000731945037842
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3518240 Best vali loss: 0.3518240
Updating learning rate to 2.690954468343839e-05
Epoch: 7 cost time: 0.49859189987182617
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3702062 Best vali loss: 0.3518240
Updating learning rate to 0.0
Epoch: 8 cost time: 0.49358320236206055
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3599176 Best vali loss: 0.3518240

best validation loss 0.3518239653180765

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0079238535584, 'e_layers': 4, 'learning_rate': 7.47409438e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8188730
	speed: 0.0114s/iter; left time: 92.4314s
	iters: 200, epoch: 1 | loss: 0.3880782
	speed: 0.0052s/iter; left time: 41.2940s
	iters: 300, epoch: 1 | loss: 0.3625442
	speed: 0.0051s/iter; left time: 40.6530s
	iters: 400, epoch: 1 | loss: 0.4393026
	speed: 0.0051s/iter; left time: 40.1841s
	iters: 500, epoch: 1 | loss: 1.2034812
	speed: 0.0052s/iter; left time: 39.8185s
	iters: 600, epoch: 1 | loss: 0.3431964
	speed: 0.0053s/iter; left time: 40.2016s
	iters: 700, epoch: 1 | loss: 0.4210370
	speed: 0.0052s/iter; left time: 39.3916s
	iters: 800, epoch: 1 | loss: 0.7114922
	speed: 0.0048s/iter; left time: 35.2896s
	iters: 900, epoch: 1 | loss: 0.2115990
	speed: 0.0048s/iter; left time: 35.0086s
	iters: 1000, epoch: 1 | loss: 0.9878141
	speed: 0.0048s/iter; left time: 34.5381s
Updating learning rate to 7.47409438e-05
Validation loss decreased (inf --> 0.3661).  Saving model state dict ...
Epoch: 1 cost time: 5.534099340438843
Epoch: 1, Steps: 1027 | Train Loss: 0.5887418 Vali Loss: 0.3661224 Best vali loss: 0.3661224
	iters: 100, epoch: 2 | loss: 0.9726647
	speed: 0.0134s/iter; left time: 94.7449s
	iters: 200, epoch: 2 | loss: 0.7963994
	speed: 0.0051s/iter; left time: 35.7443s
	iters: 300, epoch: 2 | loss: 0.9191367
	speed: 0.0051s/iter; left time: 35.0419s
	iters: 400, epoch: 2 | loss: 0.3327450
	speed: 0.0051s/iter; left time: 34.8565s
	iters: 500, epoch: 2 | loss: 1.0911727
	speed: 0.0051s/iter; left time: 33.8944s
	iters: 600, epoch: 2 | loss: 1.0095379
	speed: 0.0053s/iter; left time: 34.7812s
	iters: 700, epoch: 2 | loss: 0.2678443
	speed: 0.0054s/iter; left time: 35.2338s
	iters: 800, epoch: 2 | loss: 0.3500156
	speed: 0.0054s/iter; left time: 34.6540s
	iters: 900, epoch: 2 | loss: 1.7002934
	speed: 0.0054s/iter; left time: 34.2674s
	iters: 1000, epoch: 2 | loss: 0.2878186
	speed: 0.0054s/iter; left time: 33.6349s
Updating learning rate to 3.73704719e-05
Validation loss decreased (0.3661 --> 0.3640).  Saving model state dict ...
Epoch: 2 cost time: 5.441799163818359
Epoch: 2, Steps: 1027 | Train Loss: 0.7727628 Vali Loss: 0.3639968 Best vali loss: 0.3639968
	iters: 100, epoch: 3 | loss: 0.6671084
	speed: 0.0138s/iter; left time: 83.5060s
	iters: 200, epoch: 3 | loss: 0.7903556
	speed: 0.0049s/iter; left time: 29.1813s
	iters: 300, epoch: 3 | loss: 0.3083386
	speed: 0.0049s/iter; left time: 28.7736s
	iters: 400, epoch: 3 | loss: 0.6893111
	speed: 0.0049s/iter; left time: 28.2631s
	iters: 500, epoch: 3 | loss: 0.5883349
	speed: 0.0049s/iter; left time: 27.8274s
	iters: 600, epoch: 3 | loss: 0.2744496
	speed: 0.0049s/iter; left time: 27.1543s
	iters: 700, epoch: 3 | loss: 0.8113552
	speed: 0.0050s/iter; left time: 27.0489s
	iters: 800, epoch: 3 | loss: 0.3550039
	speed: 0.0049s/iter; left time: 26.3194s
	iters: 900, epoch: 3 | loss: 0.3132663
	speed: 0.0049s/iter; left time: 25.7990s
	iters: 1000, epoch: 3 | loss: 0.5398824
	speed: 0.0049s/iter; left time: 25.3910s
Updating learning rate to 1.868523595e-05
Validation loss decreased (0.3640 --> 0.3431).  Saving model state dict ...
Epoch: 3 cost time: 5.088592052459717
Epoch: 3, Steps: 1027 | Train Loss: 0.5337406 Vali Loss: 0.3430723 Best vali loss: 0.3430723
	iters: 100, epoch: 4 | loss: 0.4439603
	speed: 0.0143s/iter; left time: 72.0090s
	iters: 200, epoch: 4 | loss: 0.3495029
	speed: 0.0051s/iter; left time: 25.2645s
	iters: 300, epoch: 4 | loss: 0.2284343
	speed: 0.0051s/iter; left time: 24.8320s
	iters: 400, epoch: 4 | loss: 0.3005398
	speed: 0.0051s/iter; left time: 24.3071s
	iters: 500, epoch: 4 | loss: 0.4514244
	speed: 0.0051s/iter; left time: 23.6607s
	iters: 600, epoch: 4 | loss: 0.8923938
	speed: 0.0051s/iter; left time: 23.2509s
	iters: 700, epoch: 4 | loss: 0.9319551
	speed: 0.0051s/iter; left time: 22.6127s
	iters: 800, epoch: 4 | loss: 0.2738262
	speed: 0.0051s/iter; left time: 22.1370s
	iters: 900, epoch: 4 | loss: 0.4768701
	speed: 0.0051s/iter; left time: 21.4802s
	iters: 1000, epoch: 4 | loss: 0.4066920
	speed: 0.0050s/iter; left time: 20.6749s
Updating learning rate to 9.342617975e-06
Epoch: 4 cost time: 5.309692621231079
Epoch: 4, Steps: 1027 | Train Loss: 0.4755599 Vali Loss: 0.3503841 Best vali loss: 0.3430723
	iters: 100, epoch: 5 | loss: 0.2641316
	speed: 0.0132s/iter; left time: 53.0925s
	iters: 200, epoch: 5 | loss: 0.7115509
	speed: 0.0053s/iter; left time: 20.7834s
	iters: 300, epoch: 5 | loss: 0.2313420
	speed: 0.0054s/iter; left time: 20.4419s
	iters: 400, epoch: 5 | loss: 1.0066426
	speed: 0.0054s/iter; left time: 19.9379s
	iters: 500, epoch: 5 | loss: 0.6486757
	speed: 0.0054s/iter; left time: 19.3923s
	iters: 600, epoch: 5 | loss: 0.2116671
	speed: 0.0054s/iter; left time: 18.9357s
	iters: 700, epoch: 5 | loss: 0.1832941
	speed: 0.0054s/iter; left time: 18.3161s
	iters: 800, epoch: 5 | loss: 0.5298892
	speed: 0.0053s/iter; left time: 17.5747s
	iters: 900, epoch: 5 | loss: 0.1773262
	speed: 0.0054s/iter; left time: 17.2263s
	iters: 1000, epoch: 5 | loss: 0.4413571
	speed: 0.0054s/iter; left time: 16.6936s
Updating learning rate to 4.6713089875e-06
Epoch: 5 cost time: 5.549954175949097
Epoch: 5, Steps: 1027 | Train Loss: 0.4405877 Vali Loss: 0.3520430 Best vali loss: 0.3430723
	iters: 100, epoch: 6 | loss: 0.4394352
	speed: 0.0134s/iter; left time: 39.9805s
	iters: 200, epoch: 6 | loss: 0.3937543
	speed: 0.0051s/iter; left time: 14.7531s
	iters: 300, epoch: 6 | loss: 0.2519302
	speed: 0.0050s/iter; left time: 14.0317s
	iters: 400, epoch: 6 | loss: 0.7095222
	speed: 0.0049s/iter; left time: 13.2736s
	iters: 500, epoch: 6 | loss: 0.4602844
	speed: 0.0049s/iter; left time: 12.6872s
	iters: 600, epoch: 6 | loss: 0.4838062
	speed: 0.0049s/iter; left time: 12.0565s
	iters: 700, epoch: 6 | loss: 0.3075527
	speed: 0.0050s/iter; left time: 11.8292s
	iters: 800, epoch: 6 | loss: 0.3126113
	speed: 0.0049s/iter; left time: 11.0689s
	iters: 900, epoch: 6 | loss: 0.3009579
	speed: 0.0049s/iter; left time: 10.6057s
	iters: 1000, epoch: 6 | loss: 0.9271284
	speed: 0.0049s/iter; left time: 10.1879s
Updating learning rate to 2.33565449375e-06
Epoch: 6 cost time: 5.154940366744995
Epoch: 6, Steps: 1027 | Train Loss: 0.4586983 Vali Loss: 0.3544563 Best vali loss: 0.3430723
	iters: 100, epoch: 7 | loss: 0.2458929
	speed: 0.0135s/iter; left time: 26.4105s
	iters: 200, epoch: 7 | loss: 0.2940673
	speed: 0.0050s/iter; left time: 9.3135s
	iters: 300, epoch: 7 | loss: 0.3716752
	speed: 0.0050s/iter; left time: 8.7921s
	iters: 400, epoch: 7 | loss: 0.8213996
	speed: 0.0050s/iter; left time: 8.3101s
	iters: 500, epoch: 7 | loss: 0.6227992
	speed: 0.0051s/iter; left time: 7.8676s
	iters: 600, epoch: 7 | loss: 0.6525691
	speed: 0.0050s/iter; left time: 7.3318s
	iters: 700, epoch: 7 | loss: 0.2283840
	speed: 0.0050s/iter; left time: 6.7481s
	iters: 800, epoch: 7 | loss: 0.3006535
	speed: 0.0050s/iter; left time: 6.2577s
	iters: 900, epoch: 7 | loss: 0.4125319
	speed: 0.0049s/iter; left time: 5.6507s
	iters: 1000, epoch: 7 | loss: 0.4865668
	speed: 0.0050s/iter; left time: 5.2309s
Updating learning rate to 1.167827246875e-06
Epoch: 7 cost time: 5.17097282409668
Epoch: 7, Steps: 1027 | Train Loss: 0.4436540 Vali Loss: 0.3551555 Best vali loss: 0.3430723
	iters: 100, epoch: 8 | loss: 0.6375528
	speed: 0.0131s/iter; left time: 12.1151s
	iters: 200, epoch: 8 | loss: 0.2477477
	speed: 0.0051s/iter; left time: 4.1878s
	iters: 300, epoch: 8 | loss: 0.9791213
	speed: 0.0050s/iter; left time: 3.6698s
	iters: 400, epoch: 8 | loss: 0.1732520
	speed: 0.0051s/iter; left time: 3.1955s
	iters: 500, epoch: 8 | loss: 0.8049693
	speed: 0.0051s/iter; left time: 2.6675s
	iters: 600, epoch: 8 | loss: 0.3641792
	speed: 0.0051s/iter; left time: 2.1825s
	iters: 700, epoch: 8 | loss: 0.2634758
	speed: 0.0050s/iter; left time: 1.6535s
	iters: 800, epoch: 8 | loss: 0.2021125
	speed: 0.0051s/iter; left time: 1.1673s
	iters: 900, epoch: 8 | loss: 0.3217360
	speed: 0.0050s/iter; left time: 0.6462s
	iters: 1000, epoch: 8 | loss: 0.3571967
	speed: 0.0050s/iter; left time: 0.1408s
Updating learning rate to 5.839136234375e-07
Epoch: 8 cost time: 5.247932195663452
Epoch: 8, Steps: 1027 | Train Loss: 0.4351343 Vali Loss: 0.3552954 Best vali loss: 0.3430723

best validation loss 0.34307232718687863

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.003331648747, 'e_layers': 3, 'learning_rate': 0.0004338520044, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6229997
	speed: 0.0123s/iter; left time: 11.4471s
Updating learning rate to 0.0004338520044
Validation loss decreased (inf --> 0.3619).  Saving model state dict ...
Epoch: 1 cost time: 1.1058948040008545
Epoch: 1, Steps: 129 | Train Loss: 0.6229997 Vali Loss: 0.3619150 Best vali loss: 0.3619150
	iters: 100, epoch: 2 | loss: 0.6662579
	speed: 0.0095s/iter; left time: 7.6622s
Updating learning rate to 0.0002169260022
Epoch: 2 cost time: 0.757504940032959
Epoch: 2, Steps: 129 | Train Loss: 0.6662579 Vali Loss: 0.3758565 Best vali loss: 0.3619150
	iters: 100, epoch: 3 | loss: 0.5435413
	speed: 0.0092s/iter; left time: 6.1767s
Updating learning rate to 0.0001084630011
Epoch: 3 cost time: 0.729032039642334
Epoch: 3, Steps: 129 | Train Loss: 0.5435413 Vali Loss: 0.3741631 Best vali loss: 0.3619150
	iters: 100, epoch: 4 | loss: 0.5784253
	speed: 0.0093s/iter; left time: 5.0889s
Updating learning rate to 5.423150055e-05
Epoch: 4 cost time: 0.7680072784423828
Epoch: 4, Steps: 129 | Train Loss: 0.5784253 Vali Loss: 0.3803138 Best vali loss: 0.3619150
	iters: 100, epoch: 5 | loss: 0.3339684
	speed: 0.0092s/iter; left time: 3.8570s
Updating learning rate to 2.7115750275e-05
Epoch: 5 cost time: 0.7323369979858398
Epoch: 5, Steps: 129 | Train Loss: 0.3339684 Vali Loss: 0.3813755 Best vali loss: 0.3619150
	iters: 100, epoch: 6 | loss: 0.3955787
	speed: 0.0090s/iter; left time: 2.5887s
Updating learning rate to 1.35578751375e-05
Epoch: 6 cost time: 0.7271358966827393
Epoch: 6, Steps: 129 | Train Loss: 0.3955787 Vali Loss: 0.3782856 Best vali loss: 0.3619150
	iters: 100, epoch: 7 | loss: 0.5507562
	speed: 0.0093s/iter; left time: 1.4759s
Updating learning rate to 6.77893756875e-06
Epoch: 7 cost time: 0.7570455074310303
Epoch: 7, Steps: 129 | Train Loss: 0.5507562 Vali Loss: 0.3802864 Best vali loss: 0.3619150
	iters: 100, epoch: 8 | loss: 0.3719757
	speed: 0.0092s/iter; left time: 0.2759s
Updating learning rate to 3.389468784375e-06
Epoch: 8 cost time: 0.7264277935028076
Epoch: 8, Steps: 129 | Train Loss: 0.3719757 Vali Loss: 0.3790696 Best vali loss: 0.3619150

best validation loss 0.3619149787018482

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0063922477984, 'e_layers': 4, 'learning_rate': 7.67180916e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4467937
	speed: 0.0116s/iter; left time: 93.9159s
	iters: 200, epoch: 1 | loss: 0.4969661
	speed: 0.0052s/iter; left time: 41.9912s
	iters: 300, epoch: 1 | loss: 0.2966319
	speed: 0.0052s/iter; left time: 41.4845s
	iters: 400, epoch: 1 | loss: 0.5625546
	speed: 0.0052s/iter; left time: 40.8967s
	iters: 500, epoch: 1 | loss: 0.9787938
	speed: 0.0053s/iter; left time: 40.5811s
	iters: 600, epoch: 1 | loss: 1.0169014
	speed: 0.0052s/iter; left time: 39.5324s
	iters: 700, epoch: 1 | loss: 0.3939343
	speed: 0.0053s/iter; left time: 39.5970s
	iters: 800, epoch: 1 | loss: 0.6113713
	speed: 0.0052s/iter; left time: 38.7416s
	iters: 900, epoch: 1 | loss: 0.3640506
	speed: 0.0052s/iter; left time: 38.0385s
	iters: 1000, epoch: 1 | loss: 0.6733229
	speed: 0.0052s/iter; left time: 37.8386s
Updating learning rate to 7.379818310128304e-05
Validation loss decreased (inf --> 0.3856).  Saving model state dict ...
Epoch: 1 cost time: 5.730055093765259
Epoch: 1, Steps: 1027 | Train Loss: 0.5841321 Vali Loss: 0.3856254 Best vali loss: 0.3856254
	iters: 100, epoch: 2 | loss: 0.8718526
	speed: 0.0140s/iter; left time: 99.3937s
	iters: 200, epoch: 2 | loss: 0.2781623
	speed: 0.0052s/iter; left time: 36.0342s
	iters: 300, epoch: 2 | loss: 0.7816172
	speed: 0.0051s/iter; left time: 35.0446s
	iters: 400, epoch: 2 | loss: 0.4800200
	speed: 0.0049s/iter; left time: 33.5874s
	iters: 500, epoch: 2 | loss: 0.6339215
	speed: 0.0049s/iter; left time: 33.0920s
	iters: 600, epoch: 2 | loss: 0.3432184
	speed: 0.0050s/iter; left time: 32.6563s
	iters: 700, epoch: 2 | loss: 0.4232624
	speed: 0.0050s/iter; left time: 32.1389s
	iters: 800, epoch: 2 | loss: 0.3197635
	speed: 0.0049s/iter; left time: 31.5393s
	iters: 900, epoch: 2 | loss: 0.4860872
	speed: 0.0049s/iter; left time: 31.1134s
	iters: 1000, epoch: 2 | loss: 0.7326047
	speed: 0.0049s/iter; left time: 30.4018s
Updating learning rate to 6.548298720502535e-05
Validation loss decreased (0.3856 --> 0.3710).  Saving model state dict ...
Epoch: 2 cost time: 5.18126654624939
Epoch: 2, Steps: 1027 | Train Loss: 0.5350510 Vali Loss: 0.3710195 Best vali loss: 0.3710195
	iters: 100, epoch: 3 | loss: 0.4983708
	speed: 0.0135s/iter; left time: 82.1249s
	iters: 200, epoch: 3 | loss: 0.5232588
	speed: 0.0048s/iter; left time: 28.3979s
	iters: 300, epoch: 3 | loss: 0.2731841
	speed: 0.0046s/iter; left time: 27.1591s
	iters: 400, epoch: 3 | loss: 0.8508036
	speed: 0.0047s/iter; left time: 26.8175s
	iters: 500, epoch: 3 | loss: 0.6567841
	speed: 0.0047s/iter; left time: 26.5657s
	iters: 600, epoch: 3 | loss: 0.3114020
	speed: 0.0046s/iter; left time: 25.7932s
	iters: 700, epoch: 3 | loss: 0.2258765
	speed: 0.0047s/iter; left time: 25.5051s
	iters: 800, epoch: 3 | loss: 0.8455710
	speed: 0.0047s/iter; left time: 25.0002s
	iters: 900, epoch: 3 | loss: 0.7982659
	speed: 0.0047s/iter; left time: 24.5255s
	iters: 1000, epoch: 3 | loss: 0.3864574
	speed: 0.0046s/iter; left time: 23.9352s
Updating learning rate to 5.303841710899368e-05
Epoch: 3 cost time: 4.849437952041626
Epoch: 3, Steps: 1027 | Train Loss: 0.5369974 Vali Loss: 0.4105615 Best vali loss: 0.3710195

best validation loss 0.37101952631487595

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022368186234, 'e_layers': 2, 'learning_rate': 0.0004254206652, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3498287
	speed: 0.0102s/iter; left time: 19.9214s
	iters: 200, epoch: 1 | loss: 0.4968281
	speed: 0.0037s/iter; left time: 6.7919s
Updating learning rate to 0.0004254206652
Validation loss decreased (inf --> 0.3949).  Saving model state dict ...
Epoch: 1 cost time: 1.3169918060302734
Epoch: 1, Steps: 257 | Train Loss: 0.4233284 Vali Loss: 0.3948767 Best vali loss: 0.3948767
	iters: 100, epoch: 2 | loss: 0.6898564
	speed: 0.0082s/iter; left time: 13.8608s
	iters: 200, epoch: 2 | loss: 0.8650838
	speed: 0.0034s/iter; left time: 5.4423s
Updating learning rate to 0.0002127103326
Validation loss decreased (0.3949 --> 0.3705).  Saving model state dict ...
Epoch: 2 cost time: 0.9274036884307861
Epoch: 2, Steps: 257 | Train Loss: 0.7774701 Vali Loss: 0.3704578 Best vali loss: 0.3704578
	iters: 100, epoch: 3 | loss: 0.4354295
	speed: 0.0086s/iter; left time: 12.4295s
	iters: 200, epoch: 3 | loss: 0.5668522
	speed: 0.0038s/iter; left time: 5.0966s
Updating learning rate to 0.0001063551663
Validation loss decreased (0.3705 --> 0.3464).  Saving model state dict ...
Epoch: 3 cost time: 1.031104326248169
Epoch: 3, Steps: 257 | Train Loss: 0.5011408 Vali Loss: 0.3464222 Best vali loss: 0.3464222

best validation loss 0.34642217752975657

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0115077314451, 'e_layers': 3, 'learning_rate': 6.50831035e-05, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2043526
	speed: 0.0106s/iter; left time: 86.1319s
	iters: 200, epoch: 1 | loss: 1.5056531
	speed: 0.0043s/iter; left time: 34.4714s
	iters: 300, epoch: 1 | loss: 1.0089684
	speed: 0.0041s/iter; left time: 32.4789s
	iters: 400, epoch: 1 | loss: 0.2885751
	speed: 0.0040s/iter; left time: 31.3514s
	iters: 500, epoch: 1 | loss: 1.2183493
	speed: 0.0040s/iter; left time: 31.0977s
	iters: 600, epoch: 1 | loss: 1.0414352
	speed: 0.0041s/iter; left time: 30.8775s
	iters: 700, epoch: 1 | loss: 0.4450651
	speed: 0.0041s/iter; left time: 30.4819s
	iters: 800, epoch: 1 | loss: 0.3234781
	speed: 0.0040s/iter; left time: 29.9699s
	iters: 900, epoch: 1 | loss: 0.2485630
	speed: 0.0040s/iter; left time: 29.4196s
	iters: 1000, epoch: 1 | loss: 0.5977420
	speed: 0.0040s/iter; left time: 28.8713s
Updating learning rate to 6.260602536798185e-05
Validation loss decreased (inf --> 0.3636).  Saving model state dict ...
Epoch: 1 cost time: 4.565853834152222
Epoch: 1, Steps: 1027 | Train Loss: 0.6882182 Vali Loss: 0.3635551 Best vali loss: 0.3635551
	iters: 100, epoch: 2 | loss: 1.8119878
	speed: 0.0111s/iter; left time: 78.6786s
	iters: 200, epoch: 2 | loss: 0.3492509
	speed: 0.0038s/iter; left time: 26.4353s
	iters: 300, epoch: 2 | loss: 0.2858639
	speed: 0.0037s/iter; left time: 25.7877s
	iters: 400, epoch: 2 | loss: 0.3880801
	speed: 0.0038s/iter; left time: 25.5132s
	iters: 500, epoch: 2 | loss: 0.2309657
	speed: 0.0037s/iter; left time: 25.0605s
	iters: 600, epoch: 2 | loss: 2.0016885
	speed: 0.0038s/iter; left time: 24.7232s
	iters: 700, epoch: 2 | loss: 0.6776080
	speed: 0.0038s/iter; left time: 24.4524s
	iters: 800, epoch: 2 | loss: 0.2407435
	speed: 0.0038s/iter; left time: 23.9997s
	iters: 900, epoch: 2 | loss: 0.2845696
	speed: 0.0037s/iter; left time: 23.5867s
	iters: 1000, epoch: 2 | loss: 0.2493856
	speed: 0.0038s/iter; left time: 23.3116s
Updating learning rate to 5.555190366275797e-05
Validation loss decreased (0.3636 --> 0.3567).  Saving model state dict ...
Epoch: 2 cost time: 3.8992066383361816
Epoch: 2, Steps: 1027 | Train Loss: 0.6520143 Vali Loss: 0.3566617 Best vali loss: 0.3566617
	iters: 100, epoch: 3 | loss: 0.2877328
	speed: 0.0112s/iter; left time: 68.1677s
	iters: 200, epoch: 3 | loss: 0.3560021
	speed: 0.0038s/iter; left time: 22.5626s
	iters: 300, epoch: 3 | loss: 0.3176136
	speed: 0.0039s/iter; left time: 22.6016s
	iters: 400, epoch: 3 | loss: 0.3050589
	speed: 0.0038s/iter; left time: 22.1506s
	iters: 500, epoch: 3 | loss: 0.8104509
	speed: 0.0037s/iter; left time: 20.9729s
	iters: 600, epoch: 3 | loss: 0.4178668
	speed: 0.0037s/iter; left time: 20.7610s
	iters: 700, epoch: 3 | loss: 0.3699926
	speed: 0.0038s/iter; left time: 20.4873s
	iters: 800, epoch: 3 | loss: 0.7521687
	speed: 0.0037s/iter; left time: 19.8499s
	iters: 900, epoch: 3 | loss: 0.2256539
	speed: 0.0037s/iter; left time: 19.6926s
	iters: 1000, epoch: 3 | loss: 0.6823854
	speed: 0.0037s/iter; left time: 19.2357s
Updating learning rate to 4.49946644681762e-05
Epoch: 3 cost time: 3.9042861461639404
Epoch: 3, Steps: 1027 | Train Loss: 0.4524926 Vali Loss: 0.3615585 Best vali loss: 0.3566617

best validation loss 0.35666173797225204

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0022368186234, 'e_layers': 2, 'learning_rate': 0.0004254206652, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3059563
	speed: 0.0101s/iter; left time: 11.9968s
	iters: 200, epoch: 4 | loss: 0.4334196
	speed: 0.0034s/iter; left time: 3.7361s
Updating learning rate to 5.317758315e-05
Epoch: 4 cost time: 1.2507760524749756
Epoch: 4, Steps: 257 | Train Loss: 0.3696879 Vali Loss: 0.3554166 Best vali loss: 0.3464222
	iters: 100, epoch: 5 | loss: 0.3332554
	speed: 0.0082s/iter; left time: 7.6460s
	iters: 200, epoch: 5 | loss: 0.7674990
	speed: 0.0037s/iter; left time: 3.0423s
Updating learning rate to 2.6588791575e-05
Epoch: 5 cost time: 0.995924711227417
Epoch: 5, Steps: 257 | Train Loss: 0.5503772 Vali Loss: 0.3501585 Best vali loss: 0.3464222
	iters: 100, epoch: 6 | loss: 0.3736084
	speed: 0.0081s/iter; left time: 5.4498s
	iters: 200, epoch: 6 | loss: 0.4753065
	speed: 0.0037s/iter; left time: 2.0908s
Updating learning rate to 1.32943957875e-05
Epoch: 6 cost time: 0.988060712814331
Epoch: 6, Steps: 257 | Train Loss: 0.4244574 Vali Loss: 0.3505654 Best vali loss: 0.3464222
	iters: 100, epoch: 7 | loss: 0.5673337
	speed: 0.0083s/iter; left time: 3.4438s
	iters: 200, epoch: 7 | loss: 0.3697735
	speed: 0.0037s/iter; left time: 1.1701s
Updating learning rate to 6.64719789375e-06
Epoch: 7 cost time: 1.008204698562622
Epoch: 7, Steps: 257 | Train Loss: 0.4685536 Vali Loss: 0.3519593 Best vali loss: 0.3464222
	iters: 100, epoch: 8 | loss: 0.2762258
	speed: 0.0084s/iter; left time: 1.3207s
	iters: 200, epoch: 8 | loss: 0.2853650
	speed: 0.0035s/iter; left time: 0.2040s
Updating learning rate to 3.323598946875e-06
Epoch: 8 cost time: 0.9843506813049316
Epoch: 8, Steps: 257 | Train Loss: 0.2807954 Vali Loss: 0.3513608 Best vali loss: 0.3464222

best validation loss 0.34642217752975657

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0027810860632, 'e_layers': 1, 'learning_rate': 0.0006478968497, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006232377441581857
Validation loss decreased (inf --> 0.3755).  Saving model state dict ...
Epoch: 1 cost time: 0.6111459732055664
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3755393 Best vali loss: 0.3755393
Updating learning rate to 0.0005530145528161358
Validation loss decreased (0.3755 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.3085145950317383
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3649606 Best vali loss: 0.3649606
Updating learning rate to 0.0004479181199808624
Epoch: 3 cost time: 0.30403852462768555
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3698912 Best vali loss: 0.3649606
Updating learning rate to 0.00032394842485
Epoch: 4 cost time: 0.3098106384277344
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3665114 Best vali loss: 0.3649606
Updating learning rate to 0.0001999787297191377
Epoch: 5 cost time: 0.2923011779785156
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3680523 Best vali loss: 0.3649606
Updating learning rate to 9.488229688386434e-05
Epoch: 6 cost time: 0.33371806144714355
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3705891 Best vali loss: 0.3649606
Updating learning rate to 2.4659105541814297e-05
Epoch: 7 cost time: 0.3081381320953369
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3697133 Best vali loss: 0.3649606
Updating learning rate to 0.0
Epoch: 8 cost time: 0.3186459541320801
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3700929 Best vali loss: 0.3649606

best validation loss 0.3649606077165173

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022237142045, 'e_layers': 4, 'learning_rate': 0.0003425401349, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2802212
	speed: 0.0111s/iter; left time: 90.3035s
	iters: 200, epoch: 1 | loss: 0.2474527
	speed: 0.0050s/iter; left time: 40.3525s
	iters: 300, epoch: 1 | loss: 1.5570215
	speed: 0.0050s/iter; left time: 39.7878s
	iters: 400, epoch: 1 | loss: 0.4093347
	speed: 0.0050s/iter; left time: 39.1744s
	iters: 500, epoch: 1 | loss: 0.3666470
	speed: 0.0047s/iter; left time: 36.0162s
	iters: 600, epoch: 1 | loss: 0.2867229
	speed: 0.0046s/iter; left time: 35.1378s
	iters: 700, epoch: 1 | loss: 0.1575422
	speed: 0.0047s/iter; left time: 35.6120s
	iters: 800, epoch: 1 | loss: 0.1842550
	speed: 0.0047s/iter; left time: 35.1123s
	iters: 900, epoch: 1 | loss: 0.5709250
	speed: 0.0048s/iter; left time: 34.8271s
	iters: 1000, epoch: 1 | loss: 0.5036651
	speed: 0.0046s/iter; left time: 33.3199s
Updating learning rate to 0.0003425401349
Validation loss decreased (inf --> 0.3762).  Saving model state dict ...
Epoch: 1 cost time: 5.286241769790649
Epoch: 1, Steps: 1027 | Train Loss: 0.4563787 Vali Loss: 0.3761781 Best vali loss: 0.3761781
	iters: 100, epoch: 2 | loss: 0.2743327
	speed: 0.0130s/iter; left time: 92.2374s
	iters: 200, epoch: 2 | loss: 0.5686786
	speed: 0.0051s/iter; left time: 35.8211s
	iters: 300, epoch: 2 | loss: 0.5025615
	speed: 0.0051s/iter; left time: 35.1573s
	iters: 400, epoch: 2 | loss: 1.2054622
	speed: 0.0052s/iter; left time: 35.0057s
	iters: 500, epoch: 2 | loss: 0.5774034
	speed: 0.0050s/iter; left time: 33.7742s
	iters: 600, epoch: 2 | loss: 0.3749236
	speed: 0.0051s/iter; left time: 33.8011s
	iters: 700, epoch: 2 | loss: 0.3882212
	speed: 0.0051s/iter; left time: 33.0527s
	iters: 800, epoch: 2 | loss: 1.8088856
	speed: 0.0051s/iter; left time: 32.7904s
	iters: 900, epoch: 2 | loss: 0.5396660
	speed: 0.0050s/iter; left time: 31.4319s
	iters: 1000, epoch: 2 | loss: 0.3292600
	speed: 0.0051s/iter; left time: 31.3182s
Updating learning rate to 0.00017127006745
Validation loss decreased (0.3762 --> 0.3737).  Saving model state dict ...
Epoch: 2 cost time: 5.270143270492554
Epoch: 2, Steps: 1027 | Train Loss: 0.6569395 Vali Loss: 0.3736523 Best vali loss: 0.3736523
	iters: 100, epoch: 3 | loss: 0.9631835
	speed: 0.0127s/iter; left time: 76.9073s
	iters: 200, epoch: 3 | loss: 0.5999593
	speed: 0.0045s/iter; left time: 26.6702s
	iters: 300, epoch: 3 | loss: 1.1610004
	speed: 0.0045s/iter; left time: 26.3444s
	iters: 400, epoch: 3 | loss: 0.2738915
	speed: 0.0045s/iter; left time: 25.8026s
	iters: 500, epoch: 3 | loss: 0.4671145
	speed: 0.0045s/iter; left time: 25.4651s
	iters: 600, epoch: 3 | loss: 0.3783481
	speed: 0.0045s/iter; left time: 25.0519s
	iters: 700, epoch: 3 | loss: 0.4229638
	speed: 0.0045s/iter; left time: 24.6670s
	iters: 800, epoch: 3 | loss: 0.9070033
	speed: 0.0050s/iter; left time: 26.6650s
	iters: 900, epoch: 3 | loss: 0.2050459
	speed: 0.0050s/iter; left time: 26.3433s
	iters: 1000, epoch: 3 | loss: 1.0835563
	speed: 0.0050s/iter; left time: 25.7902s
Updating learning rate to 8.5635033725e-05
Epoch: 3 cost time: 4.821648120880127
Epoch: 3, Steps: 1027 | Train Loss: 0.6462067 Vali Loss: 0.3769136 Best vali loss: 0.3736523
	iters: 100, epoch: 4 | loss: 0.3771493
	speed: 0.0127s/iter; left time: 63.9472s
	iters: 200, epoch: 4 | loss: 0.2460531
	speed: 0.0051s/iter; left time: 25.0367s
	iters: 300, epoch: 4 | loss: 0.4655239
	speed: 0.0050s/iter; left time: 24.3412s
	iters: 400, epoch: 4 | loss: 0.7909409
	speed: 0.0051s/iter; left time: 24.0277s
	iters: 500, epoch: 4 | loss: 0.5820848
	speed: 0.0050s/iter; left time: 23.3677s
	iters: 600, epoch: 4 | loss: 0.8721847
	speed: 0.0050s/iter; left time: 22.8566s
	iters: 700, epoch: 4 | loss: 0.2218275
	speed: 0.0050s/iter; left time: 22.2681s
	iters: 800, epoch: 4 | loss: 0.6150997
	speed: 0.0051s/iter; left time: 21.9930s
	iters: 900, epoch: 4 | loss: 0.4400822
	speed: 0.0051s/iter; left time: 21.5890s
	iters: 1000, epoch: 4 | loss: 0.3673707
	speed: 0.0051s/iter; left time: 21.1507s
Updating learning rate to 4.28175168625e-05
Epoch: 4 cost time: 5.234503269195557
Epoch: 4, Steps: 1027 | Train Loss: 0.4978317 Vali Loss: 0.3847980 Best vali loss: 0.3736523
	iters: 100, epoch: 5 | loss: 0.9026081
	speed: 0.0130s/iter; left time: 52.0365s
	iters: 200, epoch: 5 | loss: 0.3272436
	speed: 0.0052s/iter; left time: 20.1587s
	iters: 300, epoch: 5 | loss: 0.1505987
	speed: 0.0049s/iter; left time: 18.7406s
	iters: 400, epoch: 5 | loss: 0.3167587
	speed: 0.0048s/iter; left time: 17.8785s
	iters: 500, epoch: 5 | loss: 0.3293755
	speed: 0.0048s/iter; left time: 17.2689s
	iters: 600, epoch: 5 | loss: 0.5037931
	speed: 0.0048s/iter; left time: 16.7055s
	iters: 700, epoch: 5 | loss: 0.3324921
	speed: 0.0048s/iter; left time: 16.3620s
	iters: 800, epoch: 5 | loss: 0.2615392
	speed: 0.0048s/iter; left time: 15.8210s
	iters: 900, epoch: 5 | loss: 1.1278483
	speed: 0.0048s/iter; left time: 15.3657s
	iters: 1000, epoch: 5 | loss: 0.2419616
	speed: 0.0048s/iter; left time: 14.7809s
Updating learning rate to 2.140875843125e-05
Epoch: 5 cost time: 5.0336833000183105
Epoch: 5, Steps: 1027 | Train Loss: 0.4494219 Vali Loss: 0.3877774 Best vali loss: 0.3736523
	iters: 100, epoch: 6 | loss: 0.2173336
	speed: 0.0131s/iter; left time: 38.9379s
	iters: 200, epoch: 6 | loss: 0.5812663
	speed: 0.0052s/iter; left time: 14.9430s
	iters: 300, epoch: 6 | loss: 0.2004526
	speed: 0.0052s/iter; left time: 14.5085s
	iters: 400, epoch: 6 | loss: 0.5106612
	speed: 0.0052s/iter; left time: 13.8990s
	iters: 500, epoch: 6 | loss: 0.2005116
	speed: 0.0052s/iter; left time: 13.3212s
	iters: 600, epoch: 6 | loss: 0.3268339
	speed: 0.0051s/iter; left time: 12.7203s
	iters: 700, epoch: 6 | loss: 0.2468715
	speed: 0.0051s/iter; left time: 12.2529s
	iters: 800, epoch: 6 | loss: 0.4234489
	speed: 0.0052s/iter; left time: 11.8102s
	iters: 900, epoch: 6 | loss: 0.8072930
	speed: 0.0051s/iter; left time: 11.1635s
	iters: 1000, epoch: 6 | loss: 0.3373982
	speed: 0.0052s/iter; left time: 10.7810s
Updating learning rate to 1.0704379215625e-05
Epoch: 6 cost time: 5.340521574020386
Epoch: 6, Steps: 1027 | Train Loss: 0.3852071 Vali Loss: 0.3825756 Best vali loss: 0.3736523
	iters: 100, epoch: 7 | loss: 0.5541091
	speed: 0.0125s/iter; left time: 24.5179s
	iters: 200, epoch: 7 | loss: 0.2500824
	speed: 0.0045s/iter; left time: 8.3137s
	iters: 300, epoch: 7 | loss: 0.6830184
	speed: 0.0045s/iter; left time: 7.9177s
	iters: 400, epoch: 7 | loss: 0.6287426
	speed: 0.0045s/iter; left time: 7.5226s
	iters: 500, epoch: 7 | loss: 1.1243941
	speed: 0.0046s/iter; left time: 7.1111s
	iters: 600, epoch: 7 | loss: 1.6867087
	speed: 0.0045s/iter; left time: 6.5657s
	iters: 700, epoch: 7 | loss: 0.2733330
	speed: 0.0046s/iter; left time: 6.2378s
	iters: 800, epoch: 7 | loss: 0.3143334
	speed: 0.0046s/iter; left time: 5.7524s
	iters: 900, epoch: 7 | loss: 0.2617160
	speed: 0.0046s/iter; left time: 5.3043s
	iters: 1000, epoch: 7 | loss: 0.3125826
	speed: 0.0046s/iter; left time: 4.8535s
Updating learning rate to 5.3521896078125e-06
Epoch: 7 cost time: 4.723644495010376
Epoch: 7, Steps: 1027 | Train Loss: 0.6089020 Vali Loss: 0.3862188 Best vali loss: 0.3736523
	iters: 100, epoch: 8 | loss: 1.0296990
	speed: 0.0129s/iter; left time: 11.9829s
	iters: 200, epoch: 8 | loss: 0.2967169
	speed: 0.0051s/iter; left time: 4.2510s
	iters: 300, epoch: 8 | loss: 0.4545445
	speed: 0.0051s/iter; left time: 3.7132s
	iters: 400, epoch: 8 | loss: 0.4250733
	speed: 0.0051s/iter; left time: 3.2235s
	iters: 500, epoch: 8 | loss: 1.2359293
	speed: 0.0051s/iter; left time: 2.6891s
	iters: 600, epoch: 8 | loss: 0.3798736
	speed: 0.0051s/iter; left time: 2.1729s
	iters: 700, epoch: 8 | loss: 0.9547999
	speed: 0.0051s/iter; left time: 1.6603s
	iters: 800, epoch: 8 | loss: 0.1954458
	speed: 0.0051s/iter; left time: 1.1586s
	iters: 900, epoch: 8 | loss: 0.6359229
	speed: 0.0051s/iter; left time: 0.6500s
	iters: 1000, epoch: 8 | loss: 0.3812586
	speed: 0.0051s/iter; left time: 0.1427s
Updating learning rate to 2.67609480390625e-06
Epoch: 8 cost time: 5.272599935531616
Epoch: 8, Steps: 1027 | Train Loss: 0.5989264 Vali Loss: 0.3875843 Best vali loss: 0.3736523

best validation loss 0.37365227312376553

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022268404157, 'e_layers': 4, 'learning_rate': 0.0003410974874, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2801997
	speed: 0.0109s/iter; left time: 88.6156s
	iters: 200, epoch: 1 | loss: 0.2474989
	speed: 0.0051s/iter; left time: 41.2416s
	iters: 300, epoch: 1 | loss: 1.5554634
	speed: 0.0052s/iter; left time: 40.8516s
	iters: 400, epoch: 1 | loss: 0.4111193
	speed: 0.0052s/iter; left time: 40.3774s
	iters: 500, epoch: 1 | loss: 0.3655032
	speed: 0.0050s/iter; left time: 38.8407s
	iters: 600, epoch: 1 | loss: 0.2890310
	speed: 0.0051s/iter; left time: 38.9767s
	iters: 700, epoch: 1 | loss: 0.1662059
	speed: 0.0051s/iter; left time: 38.2095s
	iters: 800, epoch: 1 | loss: 0.1833447
	speed: 0.0051s/iter; left time: 38.1928s
	iters: 900, epoch: 1 | loss: 0.5755849
	speed: 0.0051s/iter; left time: 37.4118s
	iters: 1000, epoch: 1 | loss: 0.5174811
	speed: 0.0050s/iter; left time: 35.9712s
Updating learning rate to 0.0003410974874
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 5.569584369659424
Epoch: 1, Steps: 1027 | Train Loss: 0.4591432 Vali Loss: 0.3701226 Best vali loss: 0.3701226
	iters: 100, epoch: 2 | loss: 0.3073449
	speed: 0.0128s/iter; left time: 90.7828s
	iters: 200, epoch: 2 | loss: 0.5712445
	speed: 0.0050s/iter; left time: 34.7332s
	iters: 300, epoch: 2 | loss: 0.5266139
	speed: 0.0050s/iter; left time: 34.4619s
	iters: 400, epoch: 2 | loss: 1.2386310
	speed: 0.0050s/iter; left time: 33.6661s
	iters: 500, epoch: 2 | loss: 0.5665419
	speed: 0.0050s/iter; left time: 33.2610s
	iters: 600, epoch: 2 | loss: 0.3686360
	speed: 0.0050s/iter; left time: 32.8173s
	iters: 700, epoch: 2 | loss: 0.4046142
	speed: 0.0050s/iter; left time: 32.2308s
	iters: 800, epoch: 2 | loss: 1.6551981
	speed: 0.0050s/iter; left time: 31.9117s
	iters: 900, epoch: 2 | loss: 0.3773357
	speed: 0.0050s/iter; left time: 31.1378s
	iters: 1000, epoch: 2 | loss: 0.3532990
	speed: 0.0050s/iter; left time: 30.7647s
Updating learning rate to 0.0001705487437
Validation loss decreased (0.3701 --> 0.3625).  Saving model state dict ...
Epoch: 2 cost time: 5.141418695449829
Epoch: 2, Steps: 1027 | Train Loss: 0.6369459 Vali Loss: 0.3625289 Best vali loss: 0.3625289
	iters: 100, epoch: 3 | loss: 0.8629171
	speed: 0.0129s/iter; left time: 78.4537s
	iters: 200, epoch: 3 | loss: 0.5828325
	speed: 0.0049s/iter; left time: 28.9450s
	iters: 300, epoch: 3 | loss: 1.0043058
	speed: 0.0048s/iter; left time: 28.1374s
	iters: 400, epoch: 3 | loss: 0.2776358
	speed: 0.0047s/iter; left time: 27.2929s
	iters: 500, epoch: 3 | loss: 0.4848377
	speed: 0.0048s/iter; left time: 27.1472s
	iters: 600, epoch: 3 | loss: 0.3935142
	speed: 0.0048s/iter; left time: 26.7676s
	iters: 700, epoch: 3 | loss: 0.4086520
	speed: 0.0048s/iter; left time: 26.1805s
	iters: 800, epoch: 3 | loss: 0.8539305
	speed: 0.0047s/iter; left time: 25.1182s
	iters: 900, epoch: 3 | loss: 0.2309951
	speed: 0.0048s/iter; left time: 25.4754s
	iters: 1000, epoch: 3 | loss: 0.9305245
	speed: 0.0051s/iter; left time: 26.2175s
Updating learning rate to 8.527437185e-05
Validation loss decreased (0.3625 --> 0.3492).  Saving model state dict ...
Epoch: 3 cost time: 4.992967844009399
Epoch: 3, Steps: 1027 | Train Loss: 0.6030145 Vali Loss: 0.3491618 Best vali loss: 0.3491618

best validation loss 0.34916178126232095

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022176884584, 'e_layers': 3, 'learning_rate': 0.0003939064316, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6231759
	speed: 0.0107s/iter; left time: 42.7465s
	iters: 200, epoch: 1 | loss: 0.6596990
	speed: 0.0045s/iter; left time: 17.5481s
	iters: 300, epoch: 1 | loss: 0.2837792
	speed: 0.0043s/iter; left time: 16.5459s
	iters: 400, epoch: 1 | loss: 0.5494789
	speed: 0.0042s/iter; left time: 15.5192s
	iters: 500, epoch: 1 | loss: 1.0659145
	speed: 0.0042s/iter; left time: 15.1621s
Updating learning rate to 0.0003789142607398986
Validation loss decreased (inf --> 0.3747).  Saving model state dict ...
Epoch: 1 cost time: 2.5715930461883545
Epoch: 1, Steps: 514 | Train Loss: 0.6364095 Vali Loss: 0.3747429 Best vali loss: 0.3747429
	iters: 100, epoch: 2 | loss: 0.3613371
	speed: 0.0090s/iter; left time: 31.5323s
	iters: 200, epoch: 2 | loss: 0.4731351
	speed: 0.0044s/iter; left time: 14.9557s
	iters: 300, epoch: 2 | loss: 0.3975596
	speed: 0.0044s/iter; left time: 14.5797s
	iters: 400, epoch: 2 | loss: 0.2929006
	speed: 0.0044s/iter; left time: 14.1560s
	iters: 500, epoch: 2 | loss: 0.2946108
	speed: 0.0044s/iter; left time: 13.5492s
Updating learning rate to 0.00033622017026867744
Validation loss decreased (0.3747 --> 0.3700).  Saving model state dict ...
Epoch: 2 cost time: 2.3112850189208984
Epoch: 2, Steps: 514 | Train Loss: 0.3639086 Vali Loss: 0.3699584 Best vali loss: 0.3699584
	iters: 100, epoch: 3 | loss: 0.4150003
	speed: 0.0085s/iter; left time: 25.2573s
	iters: 200, epoch: 3 | loss: 0.8823867
	speed: 0.0043s/iter; left time: 12.4526s
	iters: 300, epoch: 3 | loss: 0.5218471
	speed: 0.0043s/iter; left time: 11.8705s
	iters: 400, epoch: 3 | loss: 0.6730596
	speed: 0.0042s/iter; left time: 11.4080s
	iters: 500, epoch: 3 | loss: 0.3835098
	speed: 0.0043s/iter; left time: 11.0057s
Updating learning rate to 0.00027232394843768623
Validation loss decreased (0.3700 --> 0.3528).  Saving model state dict ...
Epoch: 3 cost time: 2.2074990272521973
Epoch: 3, Steps: 514 | Train Loss: 0.5751607 Vali Loss: 0.3527992 Best vali loss: 0.3527992

best validation loss 0.35279924705595306

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.002819949699, 'e_layers': 4, 'learning_rate': 0.0001970906598, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3760835
	speed: 0.0110s/iter; left time: 89.0176s
	iters: 200, epoch: 1 | loss: 0.3782573
	speed: 0.0051s/iter; left time: 40.8035s
	iters: 300, epoch: 1 | loss: 0.8737932
	speed: 0.0051s/iter; left time: 40.3111s
	iters: 400, epoch: 1 | loss: 0.3010193
	speed: 0.0051s/iter; left time: 39.6647s
	iters: 500, epoch: 1 | loss: 1.0163437
	speed: 0.0051s/iter; left time: 39.3004s
	iters: 600, epoch: 1 | loss: 0.3638476
	speed: 0.0051s/iter; left time: 38.7008s
	iters: 700, epoch: 1 | loss: 0.4067748
	speed: 0.0051s/iter; left time: 38.0471s
	iters: 800, epoch: 1 | loss: 0.3560739
	speed: 0.0051s/iter; left time: 37.6115s
	iters: 900, epoch: 1 | loss: 0.2907301
	speed: 0.0051s/iter; left time: 37.1663s
	iters: 1000, epoch: 1 | loss: 0.2790155
	speed: 0.0051s/iter; left time: 36.5606s
Updating learning rate to 0.0001970906598
Validation loss decreased (inf --> 0.3638).  Saving model state dict ...
Epoch: 1 cost time: 5.54923939704895
Epoch: 1, Steps: 1027 | Train Loss: 0.4641939 Vali Loss: 0.3638047 Best vali loss: 0.3638047
	iters: 100, epoch: 2 | loss: 0.3813559
	speed: 0.0130s/iter; left time: 92.1784s
	iters: 200, epoch: 2 | loss: 0.5898727
	speed: 0.0052s/iter; left time: 36.0723s
	iters: 300, epoch: 2 | loss: 0.4542592
	speed: 0.0051s/iter; left time: 35.3017s
	iters: 400, epoch: 2 | loss: 0.9230440
	speed: 0.0052s/iter; left time: 34.9843s
	iters: 500, epoch: 2 | loss: 0.5874091
	speed: 0.0051s/iter; left time: 34.2759s
	iters: 600, epoch: 2 | loss: 0.8137633
	speed: 0.0051s/iter; left time: 33.8917s
	iters: 700, epoch: 2 | loss: 0.2832384
	speed: 0.0051s/iter; left time: 33.1914s
	iters: 800, epoch: 2 | loss: 0.6437192
	speed: 0.0051s/iter; left time: 32.5076s
	iters: 900, epoch: 2 | loss: 0.2359162
	speed: 0.0051s/iter; left time: 32.1537s
	iters: 1000, epoch: 2 | loss: 0.2672274
	speed: 0.0051s/iter; left time: 31.6824s
Updating learning rate to 9.85453299e-05
Validation loss decreased (0.3638 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 5.304631948471069
Epoch: 2, Steps: 1027 | Train Loss: 0.5179805 Vali Loss: 0.3637389 Best vali loss: 0.3637389
	iters: 100, epoch: 3 | loss: 0.2324926
	speed: 0.0133s/iter; left time: 80.8681s
	iters: 200, epoch: 3 | loss: 0.8341144
	speed: 0.0051s/iter; left time: 30.4339s
	iters: 300, epoch: 3 | loss: 1.0227088
	speed: 0.0051s/iter; left time: 30.0746s
	iters: 400, epoch: 3 | loss: 0.4938489
	speed: 0.0052s/iter; left time: 29.8819s
	iters: 500, epoch: 3 | loss: 0.2896461
	speed: 0.0048s/iter; left time: 27.0802s
	iters: 600, epoch: 3 | loss: 0.5668187
	speed: 0.0045s/iter; left time: 25.2151s
	iters: 700, epoch: 3 | loss: 0.4003220
	speed: 0.0046s/iter; left time: 24.9899s
	iters: 800, epoch: 3 | loss: 0.4669001
	speed: 0.0045s/iter; left time: 24.3235s
	iters: 900, epoch: 3 | loss: 1.0695651
	speed: 0.0047s/iter; left time: 24.7195s
	iters: 1000, epoch: 3 | loss: 0.2665398
	speed: 0.0048s/iter; left time: 24.8406s
Updating learning rate to 4.927266495e-05
Validation loss decreased (0.3637 --> 0.3529).  Saving model state dict ...
Epoch: 3 cost time: 5.011054754257202
Epoch: 3, Steps: 1027 | Train Loss: 0.5642956 Vali Loss: 0.3529053 Best vali loss: 0.3529053

best validation loss 0.35290533765594245

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0022268404157, 'e_layers': 4, 'learning_rate': 0.0003410974874, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2222098
	speed: 0.0114s/iter; left time: 57.4089s
	iters: 200, epoch: 4 | loss: 0.2509253
	speed: 0.0052s/iter; left time: 25.4643s
	iters: 300, epoch: 4 | loss: 1.2202177
	speed: 0.0052s/iter; left time: 25.1568s
	iters: 400, epoch: 4 | loss: 0.3874020
	speed: 0.0052s/iter; left time: 24.4807s
	iters: 500, epoch: 4 | loss: 0.2016397
	speed: 0.0052s/iter; left time: 24.1112s
	iters: 600, epoch: 4 | loss: 0.2834856
	speed: 0.0052s/iter; left time: 23.4781s
	iters: 700, epoch: 4 | loss: 0.1599792
	speed: 0.0052s/iter; left time: 22.8732s
	iters: 800, epoch: 4 | loss: 0.1497834
	speed: 0.0051s/iter; left time: 22.2299s
	iters: 900, epoch: 4 | loss: 0.4760620
	speed: 0.0048s/iter; left time: 20.4166s
	iters: 1000, epoch: 4 | loss: 0.3854316
	speed: 0.0046s/iter; left time: 19.0301s
Updating learning rate to 4.2637185925e-05
Validation loss decreased (0.3492 --> 0.3457).  Saving model state dict ...
Epoch: 4 cost time: 5.5373852252960205
Epoch: 4, Steps: 1027 | Train Loss: 0.3737136 Vali Loss: 0.3456793 Best vali loss: 0.3456793
	iters: 100, epoch: 5 | loss: 0.2018904
	speed: 0.0133s/iter; left time: 53.1644s
	iters: 200, epoch: 5 | loss: 0.5632414
	speed: 0.0052s/iter; left time: 20.1366s
	iters: 300, epoch: 5 | loss: 0.4841500
	speed: 0.0051s/iter; left time: 19.6051s
	iters: 400, epoch: 5 | loss: 0.7503906
	speed: 0.0052s/iter; left time: 19.1489s
	iters: 500, epoch: 5 | loss: 0.4707056
	speed: 0.0052s/iter; left time: 18.8572s
	iters: 600, epoch: 5 | loss: 0.2881463
	speed: 0.0052s/iter; left time: 18.1071s
	iters: 700, epoch: 5 | loss: 0.3603626
	speed: 0.0051s/iter; left time: 17.2413s
	iters: 800, epoch: 5 | loss: 1.5408689
	speed: 0.0049s/iter; left time: 16.1562s
	iters: 900, epoch: 5 | loss: 0.3562548
	speed: 0.0048s/iter; left time: 15.4979s
	iters: 1000, epoch: 5 | loss: 0.2978970
	speed: 0.0049s/iter; left time: 15.1305s
Updating learning rate to 2.13185929625e-05
Validation loss decreased (0.3457 --> 0.3452).  Saving model state dict ...
Epoch: 5 cost time: 5.235008955001831
Epoch: 5, Steps: 1027 | Train Loss: 0.5313908 Vali Loss: 0.3452476 Best vali loss: 0.3452476
	iters: 100, epoch: 6 | loss: 0.6870548
	speed: 0.0129s/iter; left time: 38.5990s
	iters: 200, epoch: 6 | loss: 0.4141403
	speed: 0.0047s/iter; left time: 13.5979s
	iters: 300, epoch: 6 | loss: 0.9343776
	speed: 0.0047s/iter; left time: 13.1330s
	iters: 400, epoch: 6 | loss: 0.2293957
	speed: 0.0047s/iter; left time: 12.6699s
	iters: 500, epoch: 6 | loss: 0.3871654
	speed: 0.0047s/iter; left time: 12.0910s
	iters: 600, epoch: 6 | loss: 0.3755038
	speed: 0.0047s/iter; left time: 11.5616s
	iters: 700, epoch: 6 | loss: 0.4128788
	speed: 0.0045s/iter; left time: 10.7150s
	iters: 800, epoch: 6 | loss: 0.7070582
	speed: 0.0045s/iter; left time: 10.1669s
	iters: 900, epoch: 6 | loss: 0.1488974
	speed: 0.0045s/iter; left time: 9.7161s
	iters: 1000, epoch: 6 | loss: 0.8242610
	speed: 0.0044s/iter; left time: 9.2404s
Updating learning rate to 1.065929648125e-05
Epoch: 6 cost time: 4.763842582702637
Epoch: 6, Steps: 1027 | Train Loss: 0.5120733 Vali Loss: 0.3457586 Best vali loss: 0.3452476
	iters: 100, epoch: 7 | loss: 0.3769695
	speed: 0.0128s/iter; left time: 25.0746s
	iters: 200, epoch: 7 | loss: 0.2372359
	speed: 0.0051s/iter; left time: 9.4450s
	iters: 300, epoch: 7 | loss: 0.4307397
	speed: 0.0051s/iter; left time: 8.9137s
	iters: 400, epoch: 7 | loss: 0.7535527
	speed: 0.0049s/iter; left time: 8.1078s
	iters: 500, epoch: 7 | loss: 0.5248269
	speed: 0.0047s/iter; left time: 7.3741s
	iters: 600, epoch: 7 | loss: 0.7972393
	speed: 0.0047s/iter; left time: 6.8976s
	iters: 700, epoch: 7 | loss: 0.2082591
	speed: 0.0048s/iter; left time: 6.4405s
	iters: 800, epoch: 7 | loss: 0.5624708
	speed: 0.0047s/iter; left time: 5.9372s
	iters: 900, epoch: 7 | loss: 0.3897471
	speed: 0.0047s/iter; left time: 5.4728s
	iters: 1000, epoch: 7 | loss: 0.3338957
	speed: 0.0048s/iter; left time: 5.0242s
Updating learning rate to 5.329648240625e-06
Validation loss decreased (0.3452 --> 0.3448).  Saving model state dict ...
Epoch: 7 cost time: 5.027224540710449
Epoch: 7, Steps: 1027 | Train Loss: 0.4614937 Vali Loss: 0.3448487 Best vali loss: 0.3448487
	iters: 100, epoch: 8 | loss: 0.7997737
	speed: 0.0131s/iter; left time: 12.1991s
	iters: 200, epoch: 8 | loss: 0.2905226
	speed: 0.0051s/iter; left time: 4.2560s
	iters: 300, epoch: 8 | loss: 0.1610028
	speed: 0.0051s/iter; left time: 3.7131s
	iters: 400, epoch: 8 | loss: 0.2944458
	speed: 0.0051s/iter; left time: 3.1737s
	iters: 500, epoch: 8 | loss: 0.2917242
	speed: 0.0051s/iter; left time: 2.6787s
	iters: 600, epoch: 8 | loss: 0.4778338
	speed: 0.0051s/iter; left time: 2.1761s
	iters: 700, epoch: 8 | loss: 0.2987798
	speed: 0.0050s/iter; left time: 1.6537s
	iters: 800, epoch: 8 | loss: 0.2318059
	speed: 0.0051s/iter; left time: 1.1622s
	iters: 900, epoch: 8 | loss: 1.0085114
	speed: 0.0050s/iter; left time: 0.6425s
	iters: 1000, epoch: 8 | loss: 0.2036265
	speed: 0.0051s/iter; left time: 0.1425s
Updating learning rate to 2.6648241203125e-06
Epoch: 8 cost time: 5.255152225494385
Epoch: 8, Steps: 1027 | Train Loss: 0.4058027 Vali Loss: 0.3457815 Best vali loss: 0.3448487

best validation loss 0.3448486999818993

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0012703056663, 'e_layers': 3, 'learning_rate': 0.0004160750373, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3000451
	speed: 0.0109s/iter; left time: 21.3368s
	iters: 200, epoch: 1 | loss: 0.4142974
	speed: 0.0047s/iter; left time: 8.7755s
Updating learning rate to 0.0004160750373
Validation loss decreased (inf --> 0.3628).  Saving model state dict ...
Epoch: 1 cost time: 1.5410687923431396
Epoch: 1, Steps: 257 | Train Loss: 0.3571713 Vali Loss: 0.3628407 Best vali loss: 0.3628407
	iters: 100, epoch: 2 | loss: 0.7125589
	speed: 0.0096s/iter; left time: 16.2397s
	iters: 200, epoch: 2 | loss: 0.7713822
	speed: 0.0044s/iter; left time: 6.9879s
Updating learning rate to 0.00020803751865
Epoch: 2 cost time: 1.161970853805542
Epoch: 2, Steps: 257 | Train Loss: 0.7419705 Vali Loss: 0.3633121 Best vali loss: 0.3628407
	iters: 100, epoch: 3 | loss: 0.5097340
	speed: 0.0095s/iter; left time: 13.7636s
	iters: 200, epoch: 3 | loss: 0.5599732
	speed: 0.0044s/iter; left time: 5.8766s
Updating learning rate to 0.000104018759325
Validation loss decreased (0.3628 --> 0.3585).  Saving model state dict ...
Epoch: 3 cost time: 1.1805412769317627
Epoch: 3, Steps: 257 | Train Loss: 0.5348536 Vali Loss: 0.3584615 Best vali loss: 0.3584615
	iters: 100, epoch: 4 | loss: 0.3845045
	speed: 0.0097s/iter; left time: 11.5358s
	iters: 200, epoch: 4 | loss: 0.4647456
	speed: 0.0044s/iter; left time: 4.7964s
Updating learning rate to 5.20093796625e-05
Validation loss decreased (0.3585 --> 0.3514).  Saving model state dict ...
Epoch: 4 cost time: 1.1715247631072998
Epoch: 4, Steps: 257 | Train Loss: 0.4246250 Vali Loss: 0.3513829 Best vali loss: 0.3513829
	iters: 100, epoch: 5 | loss: 0.4351796
	speed: 0.0097s/iter; left time: 8.9660s
	iters: 200, epoch: 5 | loss: 0.5378717
	speed: 0.0042s/iter; left time: 3.4699s
Updating learning rate to 2.600468983125e-05
Epoch: 5 cost time: 1.1284897327423096
Epoch: 5, Steps: 257 | Train Loss: 0.4865256 Vali Loss: 0.3557182 Best vali loss: 0.3513829
	iters: 100, epoch: 6 | loss: 0.3576452
	speed: 0.0094s/iter; left time: 6.3217s
	iters: 200, epoch: 6 | loss: 0.5167413
	speed: 0.0043s/iter; left time: 2.4765s
Updating learning rate to 1.3002344915625e-05
Epoch: 6 cost time: 1.1435110569000244
Epoch: 6, Steps: 257 | Train Loss: 0.4371932 Vali Loss: 0.3556683 Best vali loss: 0.3513829
	iters: 100, epoch: 7 | loss: 0.4900346
	speed: 0.0093s/iter; left time: 3.8710s
	iters: 200, epoch: 7 | loss: 0.3539165
	speed: 0.0043s/iter; left time: 1.3407s
Updating learning rate to 6.5011724578125e-06
Epoch: 7 cost time: 1.1328322887420654
Epoch: 7, Steps: 257 | Train Loss: 0.4219755 Vali Loss: 0.3569314 Best vali loss: 0.3513829
	iters: 100, epoch: 8 | loss: 0.3751139
	speed: 0.0092s/iter; left time: 1.4471s
	iters: 200, epoch: 8 | loss: 0.5911517
	speed: 0.0044s/iter; left time: 0.2541s
Updating learning rate to 3.25058622890625e-06
Epoch: 8 cost time: 1.1587059497833252
Epoch: 8, Steps: 257 | Train Loss: 0.4831328 Vali Loss: 0.3588250 Best vali loss: 0.3513829

best validation loss 0.35138292492958323

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0074484125102, 'e_layers': 3, 'learning_rate': 0.0002452168915, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7901992
	speed: 0.0117s/iter; left time: 10.8894s
Updating learning rate to 0.00023588387929144545
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 1.050079584121704
Epoch: 1, Steps: 129 | Train Loss: 0.7901992 Vali Loss: 0.3663701 Best vali loss: 0.3663701
	iters: 100, epoch: 2 | loss: 0.6077189
	speed: 0.0091s/iter; left time: 7.3563s
Updating learning rate to 0.0002093057091705679
Validation loss decreased (0.3664 --> 0.3588).  Saving model state dict ...
Epoch: 2 cost time: 0.7475621700286865
Epoch: 2, Steps: 129 | Train Loss: 0.6077189 Vali Loss: 0.3588285 Best vali loss: 0.3588285
	iters: 100, epoch: 3 | loss: 0.8325964
	speed: 0.0094s/iter; left time: 6.3731s
Updating learning rate to 0.0001695286666065589
Epoch: 3 cost time: 0.7517755031585693
Epoch: 3, Steps: 129 | Train Loss: 0.8325964 Vali Loss: 0.3608620 Best vali loss: 0.3588285
	iters: 100, epoch: 4 | loss: 0.4446012
	speed: 0.0091s/iter; left time: 4.9916s
Updating learning rate to 0.00012260844575
Epoch: 4 cost time: 0.7595512866973877
Epoch: 4, Steps: 129 | Train Loss: 0.4446012 Vali Loss: 0.3692182 Best vali loss: 0.3588285
	iters: 100, epoch: 5 | loss: 0.3172568
	speed: 0.0091s/iter; left time: 3.7789s
Updating learning rate to 7.56882248934411e-05
Epoch: 5 cost time: 0.7308938503265381
Epoch: 5, Steps: 129 | Train Loss: 0.3172568 Vali Loss: 0.3744844 Best vali loss: 0.3588285
	iters: 100, epoch: 6 | loss: 0.4961962
	speed: 0.0092s/iter; left time: 2.6535s
Updating learning rate to 3.591118232943207e-05
Validation loss decreased (0.3588 --> 0.3588).  Saving model state dict ...
Epoch: 6 cost time: 0.7596025466918945
Epoch: 6, Steps: 129 | Train Loss: 0.4961962 Vali Loss: 0.3588159 Best vali loss: 0.3588159
	iters: 100, epoch: 7 | loss: 0.4189632
	speed: 0.0094s/iter; left time: 1.4977s
Updating learning rate to 9.333012208554538e-06
Epoch: 7 cost time: 0.7557649612426758
Epoch: 7, Steps: 129 | Train Loss: 0.4189632 Vali Loss: 0.3778234 Best vali loss: 0.3588159
	iters: 100, epoch: 8 | loss: 0.4259960
	speed: 0.0091s/iter; left time: 0.2722s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7418637275695801
Epoch: 8, Steps: 129 | Train Loss: 0.4259960 Vali Loss: 0.3799185 Best vali loss: 0.3588159

best validation loss 0.3588159012888176

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0027115710175, 'e_layers': 4, 'learning_rate': 0.0001986228328, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3760206
	speed: 0.0113s/iter; left time: 91.8860s
	iters: 200, epoch: 1 | loss: 0.3780886
	speed: 0.0053s/iter; left time: 42.2044s
	iters: 300, epoch: 1 | loss: 0.8738380
	speed: 0.0051s/iter; left time: 40.6670s
	iters: 400, epoch: 1 | loss: 0.3010329
	speed: 0.0051s/iter; left time: 39.9579s
	iters: 500, epoch: 1 | loss: 1.0160630
	speed: 0.0051s/iter; left time: 39.0462s
	iters: 600, epoch: 1 | loss: 0.3639336
	speed: 0.0051s/iter; left time: 38.7005s
	iters: 700, epoch: 1 | loss: 0.4059449
	speed: 0.0052s/iter; left time: 38.9344s
	iters: 800, epoch: 1 | loss: 0.3539388
	speed: 0.0051s/iter; left time: 37.6115s
	iters: 900, epoch: 1 | loss: 0.2884358
	speed: 0.0052s/iter; left time: 37.6981s
	iters: 1000, epoch: 1 | loss: 0.2792225
	speed: 0.0051s/iter; left time: 36.8591s
Updating learning rate to 0.0001986228328
Validation loss decreased (inf --> 0.3638).  Saving model state dict ...
Epoch: 1 cost time: 5.62748122215271
Epoch: 1, Steps: 1027 | Train Loss: 0.4636519 Vali Loss: 0.3637762 Best vali loss: 0.3637762
	iters: 100, epoch: 2 | loss: 0.3781675
	speed: 0.0131s/iter; left time: 92.7365s
	iters: 200, epoch: 2 | loss: 0.8195383
	speed: 0.0049s/iter; left time: 34.1896s
	iters: 300, epoch: 2 | loss: 0.4444499
	speed: 0.0049s/iter; left time: 33.4871s
	iters: 400, epoch: 2 | loss: 0.9183298
	speed: 0.0048s/iter; left time: 32.8950s
	iters: 500, epoch: 2 | loss: 0.5741566
	speed: 0.0048s/iter; left time: 32.3768s
	iters: 600, epoch: 2 | loss: 0.8838093
	speed: 0.0049s/iter; left time: 32.0699s
	iters: 700, epoch: 2 | loss: 0.2850668
	speed: 0.0049s/iter; left time: 31.5160s
	iters: 800, epoch: 2 | loss: 0.6462186
	speed: 0.0049s/iter; left time: 31.0547s
	iters: 900, epoch: 2 | loss: 0.2468165
	speed: 0.0049s/iter; left time: 30.5410s
	iters: 1000, epoch: 2 | loss: 0.2643237
	speed: 0.0049s/iter; left time: 30.3776s
Updating learning rate to 9.93114164e-05
Validation loss decreased (0.3638 --> 0.3635).  Saving model state dict ...
Epoch: 2 cost time: 5.0407280921936035
Epoch: 2, Steps: 1027 | Train Loss: 0.5460877 Vali Loss: 0.3635085 Best vali loss: 0.3635085
	iters: 100, epoch: 3 | loss: 0.2572069
	speed: 0.0127s/iter; left time: 77.2058s
	iters: 200, epoch: 3 | loss: 0.8165265
	speed: 0.0047s/iter; left time: 28.0932s
	iters: 300, epoch: 3 | loss: 1.0294129
	speed: 0.0047s/iter; left time: 27.4783s
	iters: 400, epoch: 3 | loss: 0.4869466
	speed: 0.0046s/iter; left time: 26.7657s
	iters: 500, epoch: 3 | loss: 0.2910636
	speed: 0.0046s/iter; left time: 26.2870s
	iters: 600, epoch: 3 | loss: 0.5660799
	speed: 0.0047s/iter; left time: 25.9675s
	iters: 700, epoch: 3 | loss: 0.4231309
	speed: 0.0047s/iter; left time: 25.4725s
	iters: 800, epoch: 3 | loss: 0.4722798
	speed: 0.0047s/iter; left time: 25.0783s
	iters: 900, epoch: 3 | loss: 1.0756898
	speed: 0.0046s/iter; left time: 24.3885s
	iters: 1000, epoch: 3 | loss: 0.2638677
	speed: 0.0047s/iter; left time: 24.0891s
Updating learning rate to 4.96557082e-05
Validation loss decreased (0.3635 --> 0.3514).  Saving model state dict ...
Epoch: 3 cost time: 4.840947866439819
Epoch: 3, Steps: 1027 | Train Loss: 0.5682204 Vali Loss: 0.3513962 Best vali loss: 0.3513962

best validation loss 0.35139616500652143

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0024768120646, 'e_layers': 3, 'learning_rate': 0.0007263731745, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006987272416928996
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 1.0971171855926514
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701199 Best vali loss: 0.3701199
Updating learning rate to 0.0006199982859304746
Epoch: 2 cost time: 0.7819380760192871
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3769130 Best vali loss: 0.3701199
Updating learning rate to 0.0005021720770477931
Epoch: 3 cost time: 0.7777523994445801
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3989988 Best vali loss: 0.3701199

best validation loss 0.37011988762553877

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0011848260657, 'e_layers': 1, 'learning_rate': 0.0008536567143, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4063676
	speed: 0.0094s/iter; left time: 8.7611s
Updating learning rate to 0.0008211663402163025
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 0.7460172176361084
Epoch: 1, Steps: 129 | Train Loss: 0.4063676 Vali Loss: 0.3673775 Best vali loss: 0.3673775
	iters: 100, epoch: 2 | loss: 0.5528577
	speed: 0.0057s/iter; left time: 4.5841s
Updating learning rate to 0.0007286415828934785
Validation loss decreased (0.3674 --> 0.3672).  Saving model state dict ...
Epoch: 2 cost time: 0.42939209938049316
Epoch: 2, Steps: 129 | Train Loss: 0.5528577 Vali Loss: 0.3671648 Best vali loss: 0.3671648
	iters: 100, epoch: 3 | loss: 0.5914994
	speed: 0.0057s/iter; left time: 3.8701s
Updating learning rate to 0.0005901684978949144
Epoch: 3 cost time: 0.4291117191314697
Epoch: 3, Steps: 129 | Train Loss: 0.5914994 Vali Loss: 0.3718795 Best vali loss: 0.3671648

best validation loss 0.36716480260982026

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0027115710175, 'e_layers': 4, 'learning_rate': 0.0001986228328, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3468305
	speed: 0.0115s/iter; left time: 58.1595s
	iters: 200, epoch: 4 | loss: 0.3022584
	speed: 0.0050s/iter; left time: 24.6819s
	iters: 300, epoch: 4 | loss: 0.4764404
	speed: 0.0051s/iter; left time: 24.4247s
	iters: 400, epoch: 4 | loss: 0.2744621
	speed: 0.0050s/iter; left time: 23.4707s
	iters: 500, epoch: 4 | loss: 0.7770756
	speed: 0.0049s/iter; left time: 22.7254s
	iters: 600, epoch: 4 | loss: 0.3527605
	speed: 0.0050s/iter; left time: 22.6339s
	iters: 700, epoch: 4 | loss: 0.4118972
	speed: 0.0050s/iter; left time: 22.1016s
	iters: 800, epoch: 4 | loss: 0.3246756
	speed: 0.0050s/iter; left time: 21.5064s
	iters: 900, epoch: 4 | loss: 0.2057367
	speed: 0.0050s/iter; left time: 21.0426s
	iters: 1000, epoch: 4 | loss: 0.2689402
	speed: 0.0051s/iter; left time: 21.2315s
Updating learning rate to 2.48278541e-05
Epoch: 4 cost time: 5.4874608516693115
Epoch: 4, Steps: 1027 | Train Loss: 0.3741077 Vali Loss: 0.3519838 Best vali loss: 0.3513962
	iters: 100, epoch: 5 | loss: 0.3263696
	speed: 0.0139s/iter; left time: 55.7341s
	iters: 200, epoch: 5 | loss: 0.3474444
	speed: 0.0053s/iter; left time: 20.9087s
	iters: 300, epoch: 5 | loss: 0.4391232
	speed: 0.0054s/iter; left time: 20.4129s
	iters: 400, epoch: 5 | loss: 0.6803707
	speed: 0.0053s/iter; left time: 19.8249s
	iters: 500, epoch: 5 | loss: 0.4356237
	speed: 0.0053s/iter; left time: 19.1919s
	iters: 600, epoch: 5 | loss: 0.7051760
	speed: 0.0053s/iter; left time: 18.6098s
	iters: 700, epoch: 5 | loss: 0.2552636
	speed: 0.0053s/iter; left time: 18.0820s
	iters: 800, epoch: 5 | loss: 0.5256446
	speed: 0.0053s/iter; left time: 17.5337s
	iters: 900, epoch: 5 | loss: 0.2110583
	speed: 0.0054s/iter; left time: 17.1917s
	iters: 1000, epoch: 5 | loss: 0.2461638
	speed: 0.0053s/iter; left time: 16.4889s
Updating learning rate to 1.241392705e-05
Epoch: 5 cost time: 5.51082968711853
Epoch: 5, Steps: 1027 | Train Loss: 0.4172238 Vali Loss: 0.3526208 Best vali loss: 0.3513962
	iters: 100, epoch: 6 | loss: 0.2143064
	speed: 0.0132s/iter; left time: 39.2249s
	iters: 200, epoch: 6 | loss: 0.7641485
	speed: 0.0052s/iter; left time: 14.9150s
	iters: 300, epoch: 6 | loss: 0.6827846
	speed: 0.0053s/iter; left time: 14.6224s
	iters: 400, epoch: 6 | loss: 0.4519673
	speed: 0.0052s/iter; left time: 14.0330s
	iters: 500, epoch: 6 | loss: 0.2600295
	speed: 0.0050s/iter; left time: 13.0184s
	iters: 600, epoch: 6 | loss: 0.5510103
	speed: 0.0050s/iter; left time: 12.3598s
	iters: 700, epoch: 6 | loss: 0.3611562
	speed: 0.0050s/iter; left time: 11.8064s
	iters: 800, epoch: 6 | loss: 0.4743058
	speed: 0.0050s/iter; left time: 11.3664s
	iters: 900, epoch: 6 | loss: 0.9119093
	speed: 0.0049s/iter; left time: 10.7800s
	iters: 1000, epoch: 6 | loss: 0.2581367
	speed: 0.0050s/iter; left time: 10.3525s
Updating learning rate to 6.206963525e-06
Epoch: 6 cost time: 5.245494365692139
Epoch: 6, Steps: 1027 | Train Loss: 0.4929755 Vali Loss: 0.3559987 Best vali loss: 0.3513962
	iters: 100, epoch: 7 | loss: 0.4170601
	speed: 0.0132s/iter; left time: 25.7449s
	iters: 200, epoch: 7 | loss: 0.3997149
	speed: 0.0052s/iter; left time: 9.7088s
	iters: 300, epoch: 7 | loss: 0.9419606
	speed: 0.0052s/iter; left time: 9.1239s
	iters: 400, epoch: 7 | loss: 0.6428248
	speed: 0.0052s/iter; left time: 8.6253s
	iters: 500, epoch: 7 | loss: 0.3291002
	speed: 0.0051s/iter; left time: 7.9257s
	iters: 600, epoch: 7 | loss: 0.3311985
	speed: 0.0052s/iter; left time: 7.4991s
	iters: 700, epoch: 7 | loss: 0.3552407
	speed: 0.0049s/iter; left time: 6.5958s
	iters: 800, epoch: 7 | loss: 0.2347023
	speed: 0.0046s/iter; left time: 5.7229s
	iters: 900, epoch: 7 | loss: 0.3906520
	speed: 0.0045s/iter; left time: 5.2527s
	iters: 1000, epoch: 7 | loss: 0.8403867
	speed: 0.0045s/iter; left time: 4.7984s
Updating learning rate to 3.1034817625e-06
Epoch: 7 cost time: 5.130417585372925
Epoch: 7, Steps: 1027 | Train Loss: 0.4882841 Vali Loss: 0.3568665 Best vali loss: 0.3513962
	iters: 100, epoch: 8 | loss: 0.5110381
	speed: 0.0131s/iter; left time: 12.1487s
	iters: 200, epoch: 8 | loss: 0.6137012
	speed: 0.0051s/iter; left time: 4.2163s
	iters: 300, epoch: 8 | loss: 0.6875529
	speed: 0.0052s/iter; left time: 3.7627s
	iters: 400, epoch: 8 | loss: 0.8091031
	speed: 0.0052s/iter; left time: 3.2746s
	iters: 500, epoch: 8 | loss: 0.2335607
	speed: 0.0052s/iter; left time: 2.7537s
	iters: 600, epoch: 8 | loss: 0.4025965
	speed: 0.0052s/iter; left time: 2.2061s
	iters: 700, epoch: 8 | loss: 0.9527392
	speed: 0.0052s/iter; left time: 1.7064s
	iters: 800, epoch: 8 | loss: 0.3767862
	speed: 0.0052s/iter; left time: 1.1811s
	iters: 900, epoch: 8 | loss: 0.3096179
	speed: 0.0047s/iter; left time: 0.6004s
	iters: 1000, epoch: 8 | loss: 0.5206960
	speed: 0.0048s/iter; left time: 0.1351s
Updating learning rate to 1.55174088125e-06
Epoch: 8 cost time: 5.263839960098267
Epoch: 8, Steps: 1027 | Train Loss: 0.5417392 Vali Loss: 0.3568353 Best vali loss: 0.3513962

best validation loss 0.35139616500652143

[INFO][smbo.py:328] Configuration budget is exhausted:
[INFO][smbo.py:329] --- Remaining wallclock time: -0.6946289539337158
[INFO][smbo.py:330] --- Remaining cpu time: inf
[INFO][smbo.py:331] --- Remaining trials: 20
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.003098386677, 'e_layers': 1, 'learning_rate': 0.0005, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2887171
	speed: 0.0084s/iter; left time: 68.0379s
	iters: 200, epoch: 1 | loss: 0.3668302
	speed: 0.0023s/iter; left time: 18.1093s
	iters: 300, epoch: 1 | loss: 0.3722475
	speed: 0.0023s/iter; left time: 17.8907s
	iters: 400, epoch: 1 | loss: 0.4765303
	speed: 0.0023s/iter; left time: 17.9058s
	iters: 500, epoch: 1 | loss: 0.5380989
	speed: 0.0022s/iter; left time: 17.3432s
	iters: 600, epoch: 1 | loss: 1.8254241
	speed: 0.0022s/iter; left time: 16.8025s
	iters: 700, epoch: 1 | loss: 0.3124222
	speed: 0.0021s/iter; left time: 16.1283s
	iters: 800, epoch: 1 | loss: 0.3053548
	speed: 0.0021s/iter; left time: 15.7194s
	iters: 900, epoch: 1 | loss: 0.2902839
	speed: 0.0021s/iter; left time: 15.5294s
	iters: 1000, epoch: 1 | loss: 0.8669170
	speed: 0.0021s/iter; left time: 15.3780s
Updating learning rate to 0.0004809698831278217
Validation loss decreased (inf --> 0.3660).  Saving model state dict ...
Epoch: 1 cost time: 2.6027534008026123
Epoch: 1, Steps: 1027 | Train Loss: 0.5642826 Vali Loss: 0.3659566 Best vali loss: 0.3659566
	iters: 100, epoch: 2 | loss: 0.4003803
	speed: 0.0074s/iter; left time: 52.5949s
	iters: 200, epoch: 2 | loss: 0.2695107
	speed: 0.0022s/iter; left time: 15.3903s
	iters: 300, epoch: 2 | loss: 0.3544131
	speed: 0.0023s/iter; left time: 15.7901s
	iters: 400, epoch: 2 | loss: 0.9076534
	speed: 0.0023s/iter; left time: 15.3572s
	iters: 500, epoch: 2 | loss: 0.6799340
	speed: 0.0023s/iter; left time: 15.0879s
	iters: 600, epoch: 2 | loss: 0.2403506
	speed: 0.0022s/iter; left time: 14.7600s
	iters: 700, epoch: 2 | loss: 0.8917809
	speed: 0.0023s/iter; left time: 14.7992s
	iters: 800, epoch: 2 | loss: 0.2400889
	speed: 0.0023s/iter; left time: 14.6210s
	iters: 900, epoch: 2 | loss: 0.2591216
	speed: 0.0023s/iter; left time: 14.6092s
	iters: 1000, epoch: 2 | loss: 0.3724574
	speed: 0.0023s/iter; left time: 13.9933s
Updating learning rate to 0.00042677669529663686
Epoch: 2 cost time: 2.367011547088623
Epoch: 2, Steps: 1027 | Train Loss: 0.4615691 Vali Loss: 0.3684681 Best vali loss: 0.3659566
	iters: 100, epoch: 3 | loss: 0.5010828
	speed: 0.0071s/iter; left time: 43.2130s
	iters: 200, epoch: 3 | loss: 0.9375905
	speed: 0.0022s/iter; left time: 13.2075s
	iters: 300, epoch: 3 | loss: 0.3383739
	speed: 0.0021s/iter; left time: 12.5329s
	iters: 400, epoch: 3 | loss: 0.4281971
	speed: 0.0022s/iter; left time: 12.7736s
	iters: 500, epoch: 3 | loss: 0.5888224
	speed: 0.0022s/iter; left time: 12.4960s
	iters: 600, epoch: 3 | loss: 0.6012668
	speed: 0.0022s/iter; left time: 12.4876s
	iters: 700, epoch: 3 | loss: 0.2427109
	speed: 0.0022s/iter; left time: 12.1993s
	iters: 800, epoch: 3 | loss: 0.4627784
	speed: 0.0022s/iter; left time: 11.8512s
	iters: 900, epoch: 3 | loss: 0.2997419
	speed: 0.0022s/iter; left time: 11.5936s
	iters: 1000, epoch: 3 | loss: 0.2049239
	speed: 0.0022s/iter; left time: 11.5203s
Updating learning rate to 0.0003456708580912725
Epoch: 3 cost time: 2.3189032077789307
Epoch: 3, Steps: 1027 | Train Loss: 0.4605489 Vali Loss: 0.3754163 Best vali loss: 0.3659566
	iters: 100, epoch: 4 | loss: 0.7711829
	speed: 0.0072s/iter; left time: 36.4733s
	iters: 200, epoch: 4 | loss: 0.3769971
	speed: 0.0021s/iter; left time: 10.2736s
	iters: 300, epoch: 4 | loss: 0.3395211
	speed: 0.0021s/iter; left time: 10.0922s
	iters: 400, epoch: 4 | loss: 0.1939733
	speed: 0.0021s/iter; left time: 9.8849s
	iters: 500, epoch: 4 | loss: 0.6079667
	speed: 0.0021s/iter; left time: 9.6566s
	iters: 600, epoch: 4 | loss: 0.5953928
	speed: 0.0021s/iter; left time: 9.4158s
	iters: 700, epoch: 4 | loss: 1.0782107
	speed: 0.0021s/iter; left time: 9.2383s
	iters: 800, epoch: 4 | loss: 0.4735647
	speed: 0.0021s/iter; left time: 9.0439s
	iters: 900, epoch: 4 | loss: 1.0485998
	speed: 0.0021s/iter; left time: 8.8473s
	iters: 1000, epoch: 4 | loss: 0.7125406
	speed: 0.0021s/iter; left time: 8.7756s
Updating learning rate to 0.00025
Epoch: 4 cost time: 2.1894593238830566
Epoch: 4, Steps: 1027 | Train Loss: 0.6197950 Vali Loss: 0.3673504 Best vali loss: 0.3659566
	iters: 100, epoch: 5 | loss: 0.4424810
	speed: 0.0072s/iter; left time: 28.8513s
	iters: 200, epoch: 5 | loss: 0.8268924
	speed: 0.0021s/iter; left time: 8.0462s
	iters: 300, epoch: 5 | loss: 0.3291218
	speed: 0.0020s/iter; left time: 7.7911s
	iters: 400, epoch: 5 | loss: 0.2042926
	speed: 0.0021s/iter; left time: 7.6804s
	iters: 500, epoch: 5 | loss: 1.6442838
	speed: 0.0020s/iter; left time: 7.3662s
	iters: 600, epoch: 5 | loss: 0.5364747
	speed: 0.0021s/iter; left time: 7.3578s
	iters: 700, epoch: 5 | loss: 0.2200306
	speed: 0.0021s/iter; left time: 7.0424s
	iters: 800, epoch: 5 | loss: 0.2694538
	speed: 0.0021s/iter; left time: 6.8446s
	iters: 900, epoch: 5 | loss: 0.4610839
	speed: 0.0020s/iter; left time: 6.4724s
	iters: 1000, epoch: 5 | loss: 0.4867272
	speed: 0.0020s/iter; left time: 6.3307s
Updating learning rate to 0.00015432914190872756
Epoch: 5 cost time: 2.1587305068969727
Epoch: 5, Steps: 1027 | Train Loss: 0.5420842 Vali Loss: 0.3753361 Best vali loss: 0.3659566
	iters: 100, epoch: 6 | loss: 0.7982970
	speed: 0.0074s/iter; left time: 21.9911s
	iters: 200, epoch: 6 | loss: 0.6137468
	speed: 0.0020s/iter; left time: 5.8525s
	iters: 300, epoch: 6 | loss: 0.6052104
	speed: 0.0020s/iter; left time: 5.6945s
	iters: 400, epoch: 6 | loss: 1.2669059
	speed: 0.0021s/iter; left time: 5.5056s
	iters: 500, epoch: 6 | loss: 0.2412828
	speed: 0.0021s/iter; left time: 5.2991s
	iters: 600, epoch: 6 | loss: 0.3367415
	speed: 0.0020s/iter; left time: 5.0812s
	iters: 700, epoch: 6 | loss: 0.6105035
	speed: 0.0020s/iter; left time: 4.8644s
	iters: 800, epoch: 6 | loss: 0.4388474
	speed: 0.0021s/iter; left time: 4.8838s
	iters: 900, epoch: 6 | loss: 0.3498640
	speed: 0.0022s/iter; left time: 4.6963s
	iters: 1000, epoch: 6 | loss: 0.6203685
	speed: 0.0021s/iter; left time: 4.3756s
Updating learning rate to 7.322330470336314e-05
Epoch: 6 cost time: 2.1755971908569336
Epoch: 6, Steps: 1027 | Train Loss: 0.5881768 Vali Loss: 0.3718455 Best vali loss: 0.3659566
	iters: 100, epoch: 7 | loss: 0.7428134
	speed: 0.0072s/iter; left time: 14.1565s
	iters: 200, epoch: 7 | loss: 0.7308449
	speed: 0.0022s/iter; left time: 4.0770s
	iters: 300, epoch: 7 | loss: 0.8268752
	speed: 0.0021s/iter; left time: 3.7418s
	iters: 400, epoch: 7 | loss: 0.5006623
	speed: 0.0021s/iter; left time: 3.4403s
	iters: 500, epoch: 7 | loss: 0.5624242
	speed: 0.0021s/iter; left time: 3.2386s
	iters: 600, epoch: 7 | loss: 0.2497287
	speed: 0.0021s/iter; left time: 3.0438s
	iters: 700, epoch: 7 | loss: 0.5840889
	speed: 0.0021s/iter; left time: 2.8206s
	iters: 800, epoch: 7 | loss: 1.1861171
	speed: 0.0021s/iter; left time: 2.6418s
	iters: 900, epoch: 7 | loss: 1.1104513
	speed: 0.0021s/iter; left time: 2.4035s
	iters: 1000, epoch: 7 | loss: 0.4847402
	speed: 0.0021s/iter; left time: 2.1996s
Updating learning rate to 1.9030116872178316e-05
Epoch: 7 cost time: 2.2141075134277344
Epoch: 7, Steps: 1027 | Train Loss: 0.6978746 Vali Loss: 0.3741688 Best vali loss: 0.3659566
	iters: 100, epoch: 8 | loss: 1.0000393
	speed: 0.0071s/iter; left time: 6.6251s
	iters: 200, epoch: 8 | loss: 0.4949030
	speed: 0.0021s/iter; left time: 1.7092s
	iters: 300, epoch: 8 | loss: 0.2021149
	speed: 0.0021s/iter; left time: 1.5142s
	iters: 400, epoch: 8 | loss: 0.3691242
	speed: 0.0021s/iter; left time: 1.3214s
	iters: 500, epoch: 8 | loss: 0.3115898
	speed: 0.0021s/iter; left time: 1.1200s
	iters: 600, epoch: 8 | loss: 0.2895049
	speed: 0.0021s/iter; left time: 0.8853s
	iters: 700, epoch: 8 | loss: 0.3767343
	speed: 0.0022s/iter; left time: 0.7054s
	iters: 800, epoch: 8 | loss: 0.2090365
	speed: 0.0022s/iter; left time: 0.4908s
	iters: 900, epoch: 8 | loss: 0.5614210
	speed: 0.0021s/iter; left time: 0.2656s
	iters: 1000, epoch: 8 | loss: 0.1720266
	speed: 0.0021s/iter; left time: 0.0582s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1900761127471924
Epoch: 8, Steps: 1027 | Train Loss: 0.3986495 Vali Loss: 0.3742050 Best vali loss: 0.3659566

best validation loss 0.3659565966232352

Default cost: 0.3659565966232352
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.002214173781, 'e_layers': 4, 'learning_rate': 0.0007070252081, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8
start_epoch 8
train_epoch 8

best validation loss 0.3340936536990355

Configuration(values={
  'alpha_d_ff': 2,
  'batch_size': 128,
  'd_core': 32,
  'd_model': 512,
  'dropout': 0.002214173781,
  'e_layers': 4,
  'learning_rate': 0.0007070252081,
  'lradj': 'type1',
})
Incumbent cost: 0.3340936536990355


Time taken (1 parallel trials): 14425 seconds


