horizon=336
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123 \
    --restore_experiment;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][smbo.py:498] Continuing from previous run.
[INFO][abstract_intensifier.py:288] Added existing seed 843828734 from runhistory to the intensifier.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5570660
	speed: 0.0134s/iter; left time: 12.5312s
Updating learning rate to 0.00019474249802669145
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 1.3150739669799805
Epoch: 1, Steps: 129 | Train Loss: 0.5570660 Vali Loss: 0.3677309 Best vali loss: 0.3677309
	iters: 100, epoch: 2 | loss: 0.6623986
	speed: 0.0122s/iter; left time: 9.7906s
Updating learning rate to 0.00017279992502057686
Validation loss decreased (0.3677 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 1.010319471359253
Epoch: 2, Steps: 129 | Train Loss: 0.6623986 Vali Loss: 0.3668142 Best vali loss: 0.3668142
	iters: 100, epoch: 3 | loss: 0.5501056
	speed: 0.0120s/iter; left time: 8.1167s
Updating learning rate to 0.00013996054381191757
Epoch: 3 cost time: 1.0159122943878174
Epoch: 3, Steps: 129 | Train Loss: 0.5501056 Vali Loss: 0.3714865 Best vali loss: 0.3668142

best validation loss 0.36681419396681497

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 246, in train
    checkpoint = torch.load(checkpoint_path)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/serialization.py", line 1114, in load
    return _legacy_load(
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/serialization.py", line 1338, in _legacy_load
    magic_number = pickle_module.load(f, **pickle_load_args)
EOFError: Ran out of input


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception EOFError - Ran out of input


[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016623644096, 'e_layers': 2, 'learning_rate': 0.0022181710066, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8024221
	speed: 0.0134s/iter; left time: 12.5223s
Updating learning rate to 0.0022181710066
Validation loss decreased (inf --> 0.4070).  Saving model state dict ...
Epoch: 1 cost time: 1.2700438499450684
Epoch: 1, Steps: 129 | Train Loss: 0.8024221 Vali Loss: 0.4070248 Best vali loss: 0.4070248
	iters: 100, epoch: 2 | loss: 0.9292223
	speed: 0.0119s/iter; left time: 9.5451s
Updating learning rate to 0.0011090855033
Validation loss decreased (0.4070 --> 0.3900).  Saving model state dict ...
Epoch: 2 cost time: 0.9485015869140625
Epoch: 2, Steps: 129 | Train Loss: 0.9292223 Vali Loss: 0.3899843 Best vali loss: 0.3899843
	iters: 100, epoch: 3 | loss: 0.7573324
	speed: 0.0120s/iter; left time: 8.0773s
Updating learning rate to 0.00055454275165
Validation loss decreased (0.3900 --> 0.3829).  Saving model state dict ...
Epoch: 3 cost time: 0.9523687362670898
Epoch: 3, Steps: 129 | Train Loss: 0.7573324 Vali Loss: 0.3829295 Best vali loss: 0.3829295
	iters: 100, epoch: 4 | loss: 0.3938640
	speed: 0.0121s/iter; left time: 6.5902s
Updating learning rate to 0.000277271375825
Validation loss decreased (0.3829 --> 0.3812).  Saving model state dict ...
Epoch: 4 cost time: 0.9538874626159668
Epoch: 4, Steps: 129 | Train Loss: 0.3938640 Vali Loss: 0.3811775 Best vali loss: 0.3811775
	iters: 100, epoch: 5 | loss: 0.7406166
	speed: 0.0120s/iter; left time: 4.9841s
Updating learning rate to 0.0001386356879125
Epoch: 5 cost time: 0.9479005336761475
Epoch: 5, Steps: 129 | Train Loss: 0.7406166 Vali Loss: 0.3840151 Best vali loss: 0.3811775
	iters: 100, epoch: 6 | loss: 0.6656395
	speed: 0.0108s/iter; left time: 3.1136s
Updating learning rate to 6.931784395625e-05
Epoch: 6 cost time: 0.8354001045227051
Epoch: 6, Steps: 129 | Train Loss: 0.6656395 Vali Loss: 0.3886123 Best vali loss: 0.3811775
	iters: 100, epoch: 7 | loss: 0.3698381
	speed: 0.0105s/iter; left time: 1.6622s
Updating learning rate to 3.4658921978125e-05
Epoch: 7 cost time: 0.8335685729980469
Epoch: 7, Steps: 129 | Train Loss: 0.3698381 Vali Loss: 0.3834613 Best vali loss: 0.3811775
	iters: 100, epoch: 8 | loss: 0.5247474
	speed: 0.0114s/iter; left time: 0.3429s
Updating learning rate to 1.73294609890625e-05
Epoch: 8 cost time: 0.9505906105041504
Epoch: 8, Steps: 129 | Train Loss: 0.5247474 Vali Loss: 0.3853624 Best vali loss: 0.3811775

best validation loss 0.3811775122503869

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0026286092899, 'e_layers': 3, 'learning_rate': 0.0009450298731, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6247965
	speed: 0.0123s/iter; left time: 24.0278s
	iters: 200, epoch: 1 | loss: 0.5688944
	speed: 0.0060s/iter; left time: 11.1373s
Updating learning rate to 0.0009450298731
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.906486988067627
Epoch: 1, Steps: 257 | Train Loss: 0.5968454 Vali Loss: 0.3710729 Best vali loss: 0.3710729
	iters: 100, epoch: 2 | loss: 0.7199185
	speed: 0.0138s/iter; left time: 23.4187s
	iters: 200, epoch: 2 | loss: 0.5843561
	speed: 0.0063s/iter; left time: 10.1514s
Updating learning rate to 0.00047251493655
Epoch: 2 cost time: 1.6972510814666748
Epoch: 2, Steps: 257 | Train Loss: 0.6521373 Vali Loss: 0.3731786 Best vali loss: 0.3710729
	iters: 100, epoch: 3 | loss: 0.4149957
	speed: 0.0133s/iter; left time: 19.1268s
	iters: 200, epoch: 3 | loss: 0.4966478
	speed: 0.0059s/iter; left time: 7.9762s
Updating learning rate to 0.000236257468275
Validation loss decreased (0.3711 --> 0.3649).  Saving model state dict ...
Epoch: 3 cost time: 1.6241085529327393
Epoch: 3, Steps: 257 | Train Loss: 0.4558218 Vali Loss: 0.3648996 Best vali loss: 0.3648996
	iters: 100, epoch: 4 | loss: 0.3909226
	speed: 0.0148s/iter; left time: 17.5868s
	iters: 200, epoch: 4 | loss: 0.4223435
	speed: 0.0068s/iter; left time: 7.3612s
Updating learning rate to 0.0001181287341375
Validation loss decreased (0.3649 --> 0.3610).  Saving model state dict ...
Epoch: 4 cost time: 1.8400354385375977
Epoch: 4, Steps: 257 | Train Loss: 0.4066330 Vali Loss: 0.3610373 Best vali loss: 0.3610373
	iters: 100, epoch: 5 | loss: 0.3878398
	speed: 0.0148s/iter; left time: 13.7596s
	iters: 200, epoch: 5 | loss: 0.3963484
	speed: 0.0073s/iter; left time: 6.0282s
Updating learning rate to 5.906436706875e-05
Validation loss decreased (0.3610 --> 0.3525).  Saving model state dict ...
Epoch: 5 cost time: 1.8454184532165527
Epoch: 5, Steps: 257 | Train Loss: 0.3920941 Vali Loss: 0.3524878 Best vali loss: 0.3524878
	iters: 100, epoch: 6 | loss: 0.3815714
	speed: 0.0150s/iter; left time: 10.0910s
	iters: 200, epoch: 6 | loss: 0.3593248
	speed: 0.0068s/iter; left time: 3.8961s
Updating learning rate to 2.9532183534375e-05
Validation loss decreased (0.3525 --> 0.3502).  Saving model state dict ...
Epoch: 6 cost time: 1.8100860118865967
Epoch: 6, Steps: 257 | Train Loss: 0.3704481 Vali Loss: 0.3501662 Best vali loss: 0.3501662
	iters: 100, epoch: 7 | loss: 0.3476552
	speed: 0.0142s/iter; left time: 5.9076s
	iters: 200, epoch: 7 | loss: 0.4689195
	speed: 0.0122s/iter; left time: 3.8565s
Updating learning rate to 1.47660917671875e-05
Epoch: 7 cost time: 2.6546688079833984
Epoch: 7, Steps: 257 | Train Loss: 0.4082873 Vali Loss: 0.3520283 Best vali loss: 0.3501662
	iters: 100, epoch: 8 | loss: 0.4474232
	speed: 0.0242s/iter; left time: 3.8261s
	iters: 200, epoch: 8 | loss: 0.6560271
	speed: 0.0124s/iter; left time: 0.7173s
Updating learning rate to 7.38304588359375e-06
Validation loss decreased (0.3502 --> 0.3502).  Saving model state dict ...
Epoch: 8 cost time: 3.101630687713623
Epoch: 8, Steps: 257 | Train Loss: 0.5517252 Vali Loss: 0.3501602 Best vali loss: 0.3501602

best validation loss 0.35016019125350095

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0109152090083, 'e_layers': 2, 'learning_rate': 0.0001568907823, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4684866
	speed: 0.0166s/iter; left time: 134.4857s
	iters: 200, epoch: 1 | loss: 0.5629015
	speed: 0.0094s/iter; left time: 75.2485s
	iters: 300, epoch: 1 | loss: 0.2379050
	speed: 0.0091s/iter; left time: 72.0701s
	iters: 400, epoch: 1 | loss: 0.2764527
	speed: 0.0067s/iter; left time: 52.6805s
	iters: 500, epoch: 1 | loss: 0.4672261
	speed: 0.0070s/iter; left time: 54.3743s
	iters: 600, epoch: 1 | loss: 0.4091306
	speed: 0.0041s/iter; left time: 31.2510s
	iters: 700, epoch: 1 | loss: 0.5756189
	speed: 0.0038s/iter; left time: 28.4079s
	iters: 800, epoch: 1 | loss: 0.5984159
	speed: 0.0050s/iter; left time: 37.2109s
	iters: 900, epoch: 1 | loss: 0.7506647
	speed: 0.0059s/iter; left time: 43.2983s
	iters: 1000, epoch: 1 | loss: 0.5546847
	speed: 0.0084s/iter; left time: 60.8877s
Updating learning rate to 0.00015091948245332703
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 7.533795118331909
Epoch: 1, Steps: 1027 | Train Loss: 0.4901487 Vali Loss: 0.3704731 Best vali loss: 0.3704731
	iters: 100, epoch: 2 | loss: 0.3193543
	speed: 0.0246s/iter; left time: 174.6756s
	iters: 200, epoch: 2 | loss: 1.1057613
	speed: 0.0077s/iter; left time: 53.6718s
	iters: 300, epoch: 2 | loss: 0.5355846
	speed: 0.0078s/iter; left time: 54.0716s
	iters: 400, epoch: 2 | loss: 0.7794980
	speed: 0.0071s/iter; left time: 47.9998s
	iters: 500, epoch: 2 | loss: 0.4693297
	speed: 0.0078s/iter; left time: 51.9048s
	iters: 600, epoch: 2 | loss: 0.4057058
	speed: 0.0074s/iter; left time: 48.7939s
	iters: 700, epoch: 2 | loss: 0.4292429
	speed: 0.0081s/iter; left time: 52.3436s
	iters: 800, epoch: 2 | loss: 0.2584114
	speed: 0.0076s/iter; left time: 48.4879s
	iters: 900, epoch: 2 | loss: 0.2448559
	speed: 0.0060s/iter; left time: 37.5350s
	iters: 1000, epoch: 2 | loss: 0.5471355
	speed: 0.0075s/iter; left time: 46.5668s
Updating learning rate to 0.00013391465918499617
Validation loss decreased (0.3705 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 7.728497743606567
Epoch: 2, Steps: 1027 | Train Loss: 0.5094880 Vali Loss: 0.3683396 Best vali loss: 0.3683396
	iters: 100, epoch: 3 | loss: 0.6754475
	speed: 0.0253s/iter; left time: 153.3314s
	iters: 200, epoch: 3 | loss: 0.4920691
	speed: 0.0069s/iter; left time: 41.2781s
	iters: 300, epoch: 3 | loss: 0.2292506
	speed: 0.0077s/iter; left time: 45.2064s
	iters: 400, epoch: 3 | loss: 0.4126250
	speed: 0.0055s/iter; left time: 31.7440s
	iters: 500, epoch: 3 | loss: 1.3528478
	speed: 0.0060s/iter; left time: 34.0549s
	iters: 600, epoch: 3 | loss: 0.7179032
	speed: 0.0048s/iter; left time: 26.7276s
	iters: 700, epoch: 3 | loss: 0.3756381
	speed: 0.0062s/iter; left time: 33.9345s
	iters: 800, epoch: 3 | loss: 0.5748748
	speed: 0.0074s/iter; left time: 39.8040s
	iters: 900, epoch: 3 | loss: 0.1648097
	speed: 0.0079s/iter; left time: 41.4021s
	iters: 1000, epoch: 3 | loss: 0.4567145
	speed: 0.0067s/iter; left time: 34.8258s
Updating learning rate to 0.00010846514268850405
Validation loss decreased (0.3683 --> 0.3658).  Saving model state dict ...
Epoch: 3 cost time: 6.786667346954346
Epoch: 3, Steps: 1027 | Train Loss: 0.5452180 Vali Loss: 0.3658068 Best vali loss: 0.3658068

best validation loss 0.3658068006305657

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0005522653273, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.5600268
	speed: 0.0139s/iter; left time: 113.1391s
	iters: 200, epoch: 1 | loss: 0.5776867
	speed: 0.0101s/iter; left time: 81.3462s
	iters: 300, epoch: 1 | loss: 0.4839483
	speed: 0.0091s/iter; left time: 71.9820s
	iters: 400, epoch: 1 | loss: 0.9436911
	speed: 0.0070s/iter; left time: 54.5355s
	iters: 500, epoch: 1 | loss: 0.9803427
	speed: 0.0079s/iter; left time: 60.9558s
	iters: 600, epoch: 1 | loss: 0.5255890
	speed: 0.0092s/iter; left time: 70.2282s
	iters: 700, epoch: 1 | loss: 0.2322623
	speed: 0.0059s/iter; left time: 44.5850s
	iters: 800, epoch: 1 | loss: 0.5318700
	speed: 0.0063s/iter; left time: 46.3737s
	iters: 900, epoch: 1 | loss: 1.0633504
	speed: 0.0052s/iter; left time: 37.7044s
	iters: 1000, epoch: 1 | loss: 0.3996250
	speed: 0.0068s/iter; left time: 49.4306s
Updating learning rate to 0.0005312459798540583
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 8.018058061599731
Epoch: 1, Steps: 1027 | Train Loss: 0.7298392 Vali Loss: 0.3774799 Best vali loss: 0.3774799
	iters: 100, epoch: 2 | loss: 0.3345805
	speed: 0.0246s/iter; left time: 174.5976s
	iters: 200, epoch: 2 | loss: 0.8014755
	speed: 0.0037s/iter; left time: 26.0135s
	iters: 300, epoch: 2 | loss: 0.4105512
	speed: 0.0037s/iter; left time: 25.4348s
	iters: 400, epoch: 2 | loss: 1.3326952
	speed: 0.0047s/iter; left time: 31.7588s
	iters: 500, epoch: 2 | loss: 0.3598890
	speed: 0.0046s/iter; left time: 30.5879s
	iters: 600, epoch: 2 | loss: 0.4357277
	speed: 0.0045s/iter; left time: 29.8360s
	iters: 700, epoch: 2 | loss: 0.3203920
	speed: 0.0046s/iter; left time: 29.9232s
	iters: 800, epoch: 2 | loss: 1.2096057
	speed: 0.0050s/iter; left time: 32.0521s
	iters: 900, epoch: 2 | loss: 0.3962246
	speed: 0.0046s/iter; left time: 28.8581s
	iters: 1000, epoch: 2 | loss: 0.3379487
	speed: 0.0050s/iter; left time: 30.9491s
Updating learning rate to 0.000471387942624019
Validation loss decreased (0.3775 --> 0.3765).  Saving model state dict ...
Epoch: 2 cost time: 4.675111532211304
Epoch: 2, Steps: 1027 | Train Loss: 0.5939090 Vali Loss: 0.3764578 Best vali loss: 0.3764578
	iters: 100, epoch: 3 | loss: 0.3507084
	speed: 0.0186s/iter; left time: 112.7977s
	iters: 200, epoch: 3 | loss: 0.1955350
	speed: 0.0049s/iter; left time: 29.0960s
	iters: 300, epoch: 3 | loss: 0.3921110
	speed: 0.0052s/iter; left time: 30.7195s
	iters: 400, epoch: 3 | loss: 0.2964245
	speed: 0.0054s/iter; left time: 31.0245s
	iters: 500, epoch: 3 | loss: 0.3428231
	speed: 0.0052s/iter; left time: 29.3049s
	iters: 600, epoch: 3 | loss: 0.7869807
	speed: 0.0047s/iter; left time: 26.4162s
	iters: 700, epoch: 3 | loss: 1.1458668
	speed: 0.0039s/iter; left time: 21.4584s
	iters: 800, epoch: 3 | loss: 0.3137991
	speed: 0.0033s/iter; left time: 17.4689s
	iters: 900, epoch: 3 | loss: 0.2573051
	speed: 0.0035s/iter; left time: 18.1803s
	iters: 1000, epoch: 3 | loss: 0.2698491
	speed: 0.0038s/iter; left time: 19.5714s
Updating learning rate to 0.00038180405916369686
Epoch: 3 cost time: 4.63330340385437
Epoch: 3, Steps: 1027 | Train Loss: 0.4351403 Vali Loss: 0.3919457 Best vali loss: 0.3764578

best validation loss 0.3764577802599999

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0034268099749, 'e_layers': 2, 'learning_rate': 0.0001980131493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7235293
	speed: 0.0149s/iter; left time: 13.8701s
Updating learning rate to 0.0001904767225531858
Validation loss decreased (inf --> 0.4026).  Saving model state dict ...
Epoch: 1 cost time: 1.4161741733551025
Epoch: 1, Steps: 129 | Train Loss: 0.7235293 Vali Loss: 0.4026235 Best vali loss: 0.4026235
	iters: 100, epoch: 2 | loss: 0.5932261
	speed: 0.0135s/iter; left time: 10.8325s
Updating learning rate to 0.00016901479496706713
Validation loss decreased (0.4026 --> 0.3853).  Saving model state dict ...
Epoch: 2 cost time: 1.0646610260009766
Epoch: 2, Steps: 129 | Train Loss: 0.5932261 Vali Loss: 0.3852757 Best vali loss: 0.3852757
	iters: 100, epoch: 3 | loss: 0.6058450
	speed: 0.0167s/iter; left time: 11.2566s
Updating learning rate to 0.00013689475046377249
Validation loss decreased (0.3853 --> 0.3777).  Saving model state dict ...
Epoch: 3 cost time: 1.6599783897399902
Epoch: 3, Steps: 129 | Train Loss: 0.6058450 Vali Loss: 0.3776865 Best vali loss: 0.3776865

best validation loss 0.37768650597111414

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0109152090083, 'e_layers': 2, 'learning_rate': 0.0001568907823, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4616250
	speed: 0.0130s/iter; left time: 65.4103s
	iters: 200, epoch: 4 | loss: 0.5162606
	speed: 0.0068s/iter; left time: 33.5913s
	iters: 300, epoch: 4 | loss: 0.2431660
	speed: 0.0066s/iter; left time: 31.6786s
	iters: 400, epoch: 4 | loss: 0.2505797
	speed: 0.0066s/iter; left time: 31.0235s
	iters: 500, epoch: 4 | loss: 0.4664179
	speed: 0.0059s/iter; left time: 27.3597s
	iters: 600, epoch: 4 | loss: 0.4040225
	speed: 0.0069s/iter; left time: 31.2628s
	iters: 700, epoch: 4 | loss: 0.5226632
	speed: 0.0062s/iter; left time: 27.6747s
	iters: 800, epoch: 4 | loss: 0.5760718
	speed: 0.0066s/iter; left time: 28.4632s
	iters: 900, epoch: 4 | loss: 0.7455394
	speed: 0.0065s/iter; left time: 27.5860s
	iters: 1000, epoch: 4 | loss: 0.5337248
	speed: 0.0057s/iter; left time: 23.4428s
Updating learning rate to 7.844539115e-05
Epoch: 4 cost time: 6.9200568199157715
Epoch: 4, Steps: 1027 | Train Loss: 0.4720071 Vali Loss: 0.3714427 Best vali loss: 0.3658068
	iters: 100, epoch: 5 | loss: 0.3316338
	speed: 0.0197s/iter; left time: 79.0346s
	iters: 200, epoch: 5 | loss: 1.0091177
	speed: 0.0060s/iter; left time: 23.5983s
	iters: 300, epoch: 5 | loss: 0.5017269
	speed: 0.0059s/iter; left time: 22.4462s
	iters: 400, epoch: 5 | loss: 0.7464134
	speed: 0.0061s/iter; left time: 22.7224s
	iters: 500, epoch: 5 | loss: 0.4446643
	speed: 0.0065s/iter; left time: 23.4883s
	iters: 600, epoch: 5 | loss: 0.3828450
	speed: 0.0059s/iter; left time: 20.7994s
	iters: 700, epoch: 5 | loss: 0.3759604
	speed: 0.0052s/iter; left time: 17.6653s
	iters: 800, epoch: 5 | loss: 0.2682326
	speed: 0.0056s/iter; left time: 18.6539s
	iters: 900, epoch: 5 | loss: 0.2309200
	speed: 0.0067s/iter; left time: 21.4661s
	iters: 1000, epoch: 5 | loss: 0.5166514
	speed: 0.0059s/iter; left time: 18.3866s
Updating learning rate to 4.842563961149597e-05
Epoch: 5 cost time: 6.2433021068573
Epoch: 5, Steps: 1027 | Train Loss: 0.4808165 Vali Loss: 0.3667247 Best vali loss: 0.3658068
	iters: 100, epoch: 6 | loss: 0.6078873
	speed: 0.0177s/iter; left time: 52.7086s
	iters: 200, epoch: 6 | loss: 0.4471925
	speed: 0.0052s/iter; left time: 15.1116s
	iters: 300, epoch: 6 | loss: 0.2575679
	speed: 0.0056s/iter; left time: 15.5746s
	iters: 400, epoch: 6 | loss: 0.3959010
	speed: 0.0063s/iter; left time: 16.8438s
	iters: 500, epoch: 6 | loss: 1.0974329
	speed: 0.0060s/iter; left time: 15.5412s
	iters: 600, epoch: 6 | loss: 0.5985910
	speed: 0.0059s/iter; left time: 14.7415s
	iters: 700, epoch: 6 | loss: 0.3446681
	speed: 0.0058s/iter; left time: 13.9134s
	iters: 800, epoch: 6 | loss: 0.5249852
	speed: 0.0059s/iter; left time: 13.4489s
	iters: 900, epoch: 6 | loss: 0.1681495
	speed: 0.0072s/iter; left time: 15.6909s
	iters: 1000, epoch: 6 | loss: 0.4180526
	speed: 0.0048s/iter; left time: 9.9458s
Updating learning rate to 2.2976123115003823e-05
Validation loss decreased (0.3658 --> 0.3647).  Saving model state dict ...
Epoch: 6 cost time: 6.002653121948242
Epoch: 6, Steps: 1027 | Train Loss: 0.4860428 Vali Loss: 0.3647052 Best vali loss: 0.3647052
	iters: 100, epoch: 7 | loss: 0.2600636
	speed: 0.0188s/iter; left time: 36.8041s
	iters: 200, epoch: 7 | loss: 0.8519824
	speed: 0.0054s/iter; left time: 10.0494s
	iters: 300, epoch: 7 | loss: 0.6066948
	speed: 0.0054s/iter; left time: 9.4371s
	iters: 400, epoch: 7 | loss: 0.4676776
	speed: 0.0077s/iter; left time: 12.7046s
	iters: 500, epoch: 7 | loss: 0.4279920
	speed: 0.0071s/iter; left time: 11.1020s
	iters: 600, epoch: 7 | loss: 0.4842338
	speed: 0.0083s/iter; left time: 12.1380s
	iters: 700, epoch: 7 | loss: 0.8403694
	speed: 0.0074s/iter; left time: 9.9850s
	iters: 800, epoch: 7 | loss: 0.6644489
	speed: 0.0087s/iter; left time: 10.9379s
	iters: 900, epoch: 7 | loss: 0.4406556
	speed: 0.0061s/iter; left time: 7.0794s
	iters: 1000, epoch: 7 | loss: 0.6828677
	speed: 0.0048s/iter; left time: 5.0850s
Updating learning rate to 5.97129984667297e-06
Epoch: 7 cost time: 6.899190902709961
Epoch: 7, Steps: 1027 | Train Loss: 0.5726986 Vali Loss: 0.3667522 Best vali loss: 0.3647052
	iters: 100, epoch: 8 | loss: 0.3329572
	speed: 0.0252s/iter; left time: 23.4169s
	iters: 200, epoch: 8 | loss: 0.9814584
	speed: 0.0071s/iter; left time: 5.9067s
	iters: 300, epoch: 8 | loss: 0.5025620
	speed: 0.0067s/iter; left time: 4.8888s
	iters: 400, epoch: 8 | loss: 0.9384349
	speed: 0.0066s/iter; left time: 4.1492s
	iters: 500, epoch: 8 | loss: 0.8575081
	speed: 0.0070s/iter; left time: 3.7129s
	iters: 600, epoch: 8 | loss: 0.9120340
	speed: 0.0070s/iter; left time: 3.0060s
	iters: 700, epoch: 8 | loss: 0.8757004
	speed: 0.0072s/iter; left time: 2.3542s
	iters: 800, epoch: 8 | loss: 0.2554962
	speed: 0.0068s/iter; left time: 1.5485s
	iters: 900, epoch: 8 | loss: 0.3687811
	speed: 0.0065s/iter; left time: 0.8363s
	iters: 1000, epoch: 8 | loss: 0.6913493
	speed: 0.0063s/iter; left time: 0.1763s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.056473731994629
Epoch: 8, Steps: 1027 | Train Loss: 0.6716282 Vali Loss: 0.3658689 Best vali loss: 0.3647052

best validation loss 0.36470518496275417

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041929184328, 'e_layers': 4, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8087046
	speed: 0.0179s/iter; left time: 145.4470s
	iters: 200, epoch: 1 | loss: 0.4958608
	speed: 0.0086s/iter; left time: 68.7172s
	iters: 300, epoch: 1 | loss: 0.4499746
	speed: 0.0084s/iter; left time: 66.7549s
	iters: 400, epoch: 1 | loss: 0.3446541
	speed: 0.0096s/iter; left time: 74.6607s
	iters: 500, epoch: 1 | loss: 0.4654601
	speed: 0.0097s/iter; left time: 75.2365s
	iters: 600, epoch: 1 | loss: 0.7642887
	speed: 0.0101s/iter; left time: 76.8117s
	iters: 700, epoch: 1 | loss: 1.1730828
	speed: 0.0103s/iter; left time: 77.1588s
	iters: 800, epoch: 1 | loss: 0.3023582
	speed: 0.0104s/iter; left time: 77.2367s
	iters: 900, epoch: 1 | loss: 1.6908909
	speed: 0.0100s/iter; left time: 73.4200s
	iters: 1000, epoch: 1 | loss: 0.3958063
	speed: 0.0098s/iter; left time: 70.5130s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 10.454776763916016
Epoch: 1, Steps: 1027 | Train Loss: 0.6891081 Vali Loss: 0.3724335 Best vali loss: 0.3724335
	iters: 100, epoch: 2 | loss: 0.4140365
	speed: 0.0262s/iter; left time: 186.0410s
	iters: 200, epoch: 2 | loss: 0.5583882
	speed: 0.0103s/iter; left time: 72.1917s
	iters: 300, epoch: 2 | loss: 0.5293754
	speed: 0.0102s/iter; left time: 70.5913s
	iters: 400, epoch: 2 | loss: 0.5987962
	speed: 0.0104s/iter; left time: 70.4116s
	iters: 500, epoch: 2 | loss: 0.2469954
	speed: 0.0097s/iter; left time: 65.2049s
	iters: 600, epoch: 2 | loss: 0.4746923
	speed: 0.0090s/iter; left time: 59.2003s
	iters: 700, epoch: 2 | loss: 0.4298891
	speed: 0.0086s/iter; left time: 55.5602s
	iters: 800, epoch: 2 | loss: 0.2359059
	speed: 0.0089s/iter; left time: 57.0914s
	iters: 900, epoch: 2 | loss: 0.3223263
	speed: 0.0102s/iter; left time: 63.9338s
	iters: 1000, epoch: 2 | loss: 1.8842525
	speed: 0.0104s/iter; left time: 64.2260s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 10.10305905342102
Epoch: 2, Steps: 1027 | Train Loss: 0.5694658 Vali Loss: 0.3788571 Best vali loss: 0.3724335
	iters: 100, epoch: 3 | loss: 1.5509760
	speed: 0.0278s/iter; left time: 168.3006s
	iters: 200, epoch: 3 | loss: 0.6186770
	speed: 0.0098s/iter; left time: 58.5467s
	iters: 300, epoch: 3 | loss: 0.9793649
	speed: 0.0097s/iter; left time: 56.6668s
	iters: 400, epoch: 3 | loss: 0.9847497
	speed: 0.0075s/iter; left time: 43.4815s
	iters: 500, epoch: 3 | loss: 1.2657256
	speed: 0.0131s/iter; left time: 74.0532s
	iters: 600, epoch: 3 | loss: 0.2576067
	speed: 0.0118s/iter; left time: 65.6409s
	iters: 700, epoch: 3 | loss: 1.0166498
	speed: 0.0159s/iter; left time: 86.8879s
	iters: 800, epoch: 3 | loss: 1.3906180
	speed: 0.0138s/iter; left time: 74.0672s
	iters: 900, epoch: 3 | loss: 0.5746395
	speed: 0.0152s/iter; left time: 79.7404s
	iters: 1000, epoch: 3 | loss: 1.3925277
	speed: 0.0146s/iter; left time: 75.6338s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 12.616671323776245
Epoch: 3, Steps: 1027 | Train Loss: 1.0031535 Vali Loss: 0.3766075 Best vali loss: 0.3724335
	iters: 100, epoch: 4 | loss: 0.2830460
	speed: 0.0372s/iter; left time: 187.3206s
	iters: 200, epoch: 4 | loss: 0.3003251
	speed: 0.0100s/iter; left time: 49.3282s
	iters: 300, epoch: 4 | loss: 0.6780055
	speed: 0.0072s/iter; left time: 34.6829s
	iters: 400, epoch: 4 | loss: 0.8467660
	speed: 0.0070s/iter; left time: 33.1896s
	iters: 500, epoch: 4 | loss: 0.4181392
	speed: 0.0074s/iter; left time: 34.1885s
	iters: 600, epoch: 4 | loss: 0.4590308
	speed: 0.0084s/iter; left time: 38.2530s
	iters: 700, epoch: 4 | loss: 0.2094707
	speed: 0.0093s/iter; left time: 41.2814s
	iters: 800, epoch: 4 | loss: 0.7140340
	speed: 0.0095s/iter; left time: 40.9873s
	iters: 900, epoch: 4 | loss: 0.2805834
	speed: 0.0093s/iter; left time: 39.4209s
	iters: 1000, epoch: 4 | loss: 0.4964207
	speed: 0.0094s/iter; left time: 38.9521s
Updating learning rate to 0.00109417918315
Epoch: 4 cost time: 9.450062036514282
Epoch: 4, Steps: 1027 | Train Loss: 0.4685821 Vali Loss: 0.3912964 Best vali loss: 0.3724335
	iters: 100, epoch: 5 | loss: 0.3325029
	speed: 0.0254s/iter; left time: 101.7762s
	iters: 200, epoch: 5 | loss: 0.9470304
	speed: 0.0091s/iter; left time: 35.6672s
	iters: 300, epoch: 5 | loss: 0.9066220
	speed: 0.0092s/iter; left time: 35.2214s
	iters: 400, epoch: 5 | loss: 0.2502582
	speed: 0.0093s/iter; left time: 34.3594s
	iters: 500, epoch: 5 | loss: 1.2220236
	speed: 0.0090s/iter; left time: 32.5299s
	iters: 600, epoch: 5 | loss: 1.0804921
	speed: 0.0092s/iter; left time: 32.3637s
	iters: 700, epoch: 5 | loss: 0.7680396
	speed: 0.0091s/iter; left time: 31.0813s
	iters: 800, epoch: 5 | loss: 0.2979303
	speed: 0.0094s/iter; left time: 31.2396s
	iters: 900, epoch: 5 | loss: 0.7986187
	speed: 0.0094s/iter; left time: 30.2078s
	iters: 1000, epoch: 5 | loss: 0.5457219
	speed: 0.0092s/iter; left time: 28.6388s
Updating learning rate to 0.0006754549377197279
Epoch: 5 cost time: 9.58914566040039
Epoch: 5, Steps: 1027 | Train Loss: 0.7149240 Vali Loss: 0.4036319 Best vali loss: 0.3724335
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0017396805512, 'e_layers': 3, 'learning_rate': 0.0001422302375, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3683440
	speed: 0.0146s/iter; left time: 118.8021s
	iters: 200, epoch: 1 | loss: 0.3560055
	speed: 0.0075s/iter; left time: 60.0293s
	iters: 300, epoch: 1 | loss: 0.2207417
	speed: 0.0070s/iter; left time: 55.4764s
	iters: 400, epoch: 1 | loss: 1.3174907
	speed: 0.0079s/iter; left time: 61.4534s
	iters: 500, epoch: 1 | loss: 0.2657722
	speed: 0.0088s/iter; left time: 67.6939s
	iters: 600, epoch: 1 | loss: 0.5534085
	speed: 0.0076s/iter; left time: 57.5700s
	iters: 700, epoch: 1 | loss: 1.7270156
	speed: 0.0065s/iter; left time: 49.0947s
	iters: 800, epoch: 1 | loss: 0.6803219
	speed: 0.0078s/iter; left time: 57.5515s
	iters: 900, epoch: 1 | loss: 0.7289274
	speed: 0.0077s/iter; left time: 56.3065s
	iters: 1000, epoch: 1 | loss: 0.3593873
	speed: 0.0081s/iter; left time: 58.5613s
Updating learning rate to 0.00013681692141523464
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 8.241588354110718
Epoch: 1, Steps: 1027 | Train Loss: 0.6577415 Vali Loss: 0.3682437 Best vali loss: 0.3682437
	iters: 100, epoch: 2 | loss: 0.2521305
	speed: 0.0232s/iter; left time: 164.8263s
	iters: 200, epoch: 2 | loss: 0.8515720
	speed: 0.0074s/iter; left time: 51.8942s
	iters: 300, epoch: 2 | loss: 0.5222945
	speed: 0.0080s/iter; left time: 54.8670s
	iters: 400, epoch: 2 | loss: 0.8668574
	speed: 0.0071s/iter; left time: 48.3340s
	iters: 500, epoch: 2 | loss: 0.3501796
	speed: 0.0078s/iter; left time: 52.1917s
	iters: 600, epoch: 2 | loss: 0.3022537
	speed: 0.0071s/iter; left time: 46.6775s
	iters: 700, epoch: 2 | loss: 0.2951517
	speed: 0.0106s/iter; left time: 68.6576s
	iters: 800, epoch: 2 | loss: 0.4043478
	speed: 0.0074s/iter; left time: 47.4366s
	iters: 900, epoch: 2 | loss: 0.4043749
	speed: 0.0061s/iter; left time: 38.3720s
	iters: 1000, epoch: 2 | loss: 0.2487440
	speed: 0.0060s/iter; left time: 36.8428s
Updating learning rate to 0.00012140110146301159
Validation loss decreased (0.3682 --> 0.3586).  Saving model state dict ...
Epoch: 2 cost time: 7.721109867095947
Epoch: 2, Steps: 1027 | Train Loss: 0.4497906 Vali Loss: 0.3586000 Best vali loss: 0.3586000
	iters: 100, epoch: 3 | loss: 0.4919014
	speed: 0.0227s/iter; left time: 137.3813s
	iters: 200, epoch: 3 | loss: 0.3862285
	speed: 0.0086s/iter; left time: 51.3792s
	iters: 300, epoch: 3 | loss: 1.6795256
	speed: 0.0088s/iter; left time: 51.4295s
	iters: 400, epoch: 3 | loss: 0.4053413
	speed: 0.0082s/iter; left time: 47.3416s
	iters: 500, epoch: 3 | loss: 1.2585566
	speed: 0.0086s/iter; left time: 48.5588s
	iters: 600, epoch: 3 | loss: 0.2664226
	speed: 0.0088s/iter; left time: 49.1741s
	iters: 700, epoch: 3 | loss: 0.3799840
	speed: 0.0086s/iter; left time: 46.9526s
	iters: 800, epoch: 3 | loss: 0.9103200
	speed: 0.0072s/iter; left time: 38.4771s
	iters: 900, epoch: 3 | loss: 0.3602068
	speed: 0.0089s/iter; left time: 46.8039s
	iters: 1000, epoch: 3 | loss: 0.1486353
	speed: 0.0127s/iter; left time: 65.5373s
Updating learning rate to 9.832969648630095e-05
Validation loss decreased (0.3586 --> 0.3547).  Saving model state dict ...
Epoch: 3 cost time: 9.217943668365479
Epoch: 3, Steps: 1027 | Train Loss: 0.6287122 Vali Loss: 0.3547248 Best vali loss: 0.3547248
	iters: 100, epoch: 4 | loss: 0.3795558
	speed: 0.0329s/iter; left time: 165.8276s
	iters: 200, epoch: 4 | loss: 0.2906940
	speed: 0.0140s/iter; left time: 69.0773s
	iters: 300, epoch: 4 | loss: 0.3057176
	speed: 0.0093s/iter; left time: 44.9712s
	iters: 400, epoch: 4 | loss: 0.7612048
	speed: 0.0078s/iter; left time: 37.0370s
	iters: 500, epoch: 4 | loss: 0.4539307
	speed: 0.0097s/iter; left time: 44.7547s
	iters: 600, epoch: 4 | loss: 0.9213066
	speed: 0.0097s/iter; left time: 44.1121s
	iters: 700, epoch: 4 | loss: 0.2504588
	speed: 0.0093s/iter; left time: 41.0669s
	iters: 800, epoch: 4 | loss: 0.2618695
	speed: 0.0075s/iter; left time: 32.4530s
	iters: 900, epoch: 4 | loss: 0.3776546
	speed: 0.0127s/iter; left time: 53.7811s
	iters: 1000, epoch: 4 | loss: 0.3080146
	speed: 0.0119s/iter; left time: 49.2698s
Updating learning rate to 7.111511875e-05
Validation loss decreased (0.3547 --> 0.3477).  Saving model state dict ...
Epoch: 4 cost time: 10.685985088348389
Epoch: 4, Steps: 1027 | Train Loss: 0.4310407 Vali Loss: 0.3477287 Best vali loss: 0.3477287
	iters: 100, epoch: 5 | loss: 0.4210224
	speed: 0.0360s/iter; left time: 144.1850s
	iters: 200, epoch: 5 | loss: 0.4230777
	speed: 0.0130s/iter; left time: 50.7616s
	iters: 300, epoch: 5 | loss: 0.4223171
	speed: 0.0109s/iter; left time: 41.7032s
	iters: 400, epoch: 5 | loss: 0.7644290
	speed: 0.0131s/iter; left time: 48.4659s
	iters: 500, epoch: 5 | loss: 0.3360263
	speed: 0.0133s/iter; left time: 48.0670s
	iters: 600, epoch: 5 | loss: 0.4024588
	speed: 0.0105s/iter; left time: 37.0142s
	iters: 700, epoch: 5 | loss: 0.3252857
	speed: 0.0075s/iter; left time: 25.4648s
	iters: 800, epoch: 5 | loss: 0.2601909
	speed: 0.0103s/iter; left time: 34.1079s
	iters: 900, epoch: 5 | loss: 0.1849709
	speed: 0.0120s/iter; left time: 38.5247s
	iters: 1000, epoch: 5 | loss: 0.4230701
	speed: 0.0128s/iter; left time: 39.9503s
Updating learning rate to 4.3900541013699053e-05
Epoch: 5 cost time: 12.069392204284668
Epoch: 5, Steps: 1027 | Train Loss: 0.3962849 Vali Loss: 0.3507760 Best vali loss: 0.3477287
	iters: 100, epoch: 6 | loss: 0.3888884
	speed: 0.0364s/iter; left time: 108.6437s
	iters: 200, epoch: 6 | loss: 0.3005773
	speed: 0.0115s/iter; left time: 33.2437s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.00111869257, 'e_layers': 2, 'learning_rate': 0.001620968523, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8783610
	speed: 0.0161s/iter; left time: 130.5337s
	iters: 200, epoch: 1 | loss: 0.1967039
	speed: 0.0106s/iter; left time: 84.9448s
	iters: 300, epoch: 1 | loss: 0.2028820
	speed: 0.0106s/iter; left time: 84.2453s
	iters: 400, epoch: 1 | loss: 0.2842688
	speed: 0.0093s/iter; left time: 72.5697s
	iters: 500, epoch: 1 | loss: 0.3916122
	speed: 0.0056s/iter; left time: 43.2038s
	iters: 600, epoch: 1 | loss: 0.2937337
	speed: 0.0078s/iter; left time: 59.0322s
	iters: 700, epoch: 1 | loss: 1.4404967
	speed: 0.0102s/iter; left time: 76.6151s
	iters: 800, epoch: 1 | loss: 1.0047754
	speed: 0.0101s/iter; left time: 74.6728s
	iters: 900, epoch: 1 | loss: 0.9445977
	speed: 0.0089s/iter; left time: 65.4592s
	iters: 1000, epoch: 1 | loss: 0.2324682
	speed: 0.0064s/iter; left time: 45.8600s
Updating learning rate to 0.001620968523
Validation loss decreased (inf --> 0.3965).  Saving model state dict ...
Epoch: 1 cost time: 9.407907009124756
Epoch: 1, Steps: 1027 | Train Loss: 0.5869900 Vali Loss: 0.3965432 Best vali loss: 0.3965432
	iters: 100, epoch: 2 | loss: 0.8899759
	speed: 0.0253s/iter; left time: 179.6415s
	iters: 200, epoch: 2 | loss: 0.3067661
	speed: 0.0079s/iter; left time: 55.5618s
	iters: 300, epoch: 2 | loss: 0.2573965
	speed: 0.0074s/iter; left time: 51.0685s
	iters: 400, epoch: 2 | loss: 0.2707908
	speed: 0.0073s/iter; left time: 49.8057s
	iters: 500, epoch: 2 | loss: 0.2360376
	speed: 0.0068s/iter; left time: 45.6490s
	iters: 600, epoch: 2 | loss: 0.4081704
	speed: 0.0069s/iter; left time: 45.6323s
	iters: 700, epoch: 2 | loss: 2.0777776
	speed: 0.0075s/iter; left time: 48.9479s
	iters: 800, epoch: 2 | loss: 0.7793667
	speed: 0.0056s/iter; left time: 35.7811s
	iters: 900, epoch: 2 | loss: 0.8017319
	speed: 0.0056s/iter; left time: 35.3563s
	iters: 1000, epoch: 2 | loss: 0.3616253
	speed: 0.0052s/iter; left time: 32.2283s
Updating learning rate to 0.0008104842615
Validation loss decreased (0.3965 --> 0.3731).  Saving model state dict ...
Epoch: 2 cost time: 7.00791335105896
Epoch: 2, Steps: 1027 | Train Loss: 0.6389639 Vali Loss: 0.3730865 Best vali loss: 0.3730865
	iters: 100, epoch: 3 | loss: 0.2025699
	speed: 0.0217s/iter; left time: 131.3873s
	iters: 200, epoch: 3 | loss: 0.4084802
	speed: 0.0075s/iter; left time: 44.4541s
	iters: 300, epoch: 3 | loss: 0.9630638
	speed: 0.0071s/iter; left time: 41.6196s
	iters: 400, epoch: 3 | loss: 1.0606328
	speed: 0.0066s/iter; left time: 37.9534s
	iters: 500, epoch: 3 | loss: 0.5148427
	speed: 0.0065s/iter; left time: 37.0452s
	iters: 600, epoch: 3 | loss: 0.3372544
	speed: 0.0071s/iter; left time: 39.3401s
	iters: 700, epoch: 3 | loss: 0.9341512
	speed: 0.0066s/iter; left time: 36.0535s
	iters: 800, epoch: 3 | loss: 0.8129818
	speed: 0.0058s/iter; left time: 30.8437s
	iters: 900, epoch: 3 | loss: 0.9282160
	speed: 0.0065s/iter; left time: 34.3007s
	iters: 1000, epoch: 3 | loss: 0.2938242
	speed: 0.0068s/iter; left time: 34.8727s
Updating learning rate to 0.00040524213075
Epoch: 3 cost time: 6.927589654922485
Epoch: 3, Steps: 1027 | Train Loss: 0.6456017 Vali Loss: 0.3813448 Best vali loss: 0.3730865

best validation loss 0.37308654207846037

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0028630346006, 'e_layers': 2, 'learning_rate': 0.002038872325, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7869781
	speed: 0.0186s/iter; left time: 36.4792s
	iters: 200, epoch: 1 | loss: 0.9699132
	speed: 0.0129s/iter; left time: 23.9037s
Updating learning rate to 0.0019612723677356002
Validation loss decreased (inf --> 0.3790).  Saving model state dict ...
Epoch: 1 cost time: 3.531440258026123
Epoch: 1, Steps: 257 | Train Loss: 0.8784457 Vali Loss: 0.3790259 Best vali loss: 0.3790259
	iters: 100, epoch: 2 | loss: 0.5328851
	speed: 0.0331s/iter; left time: 56.3504s
	iters: 200, epoch: 2 | loss: 0.3458818
	speed: 0.0190s/iter; left time: 30.4591s
Updating learning rate to 0.0017402863859905414
Validation loss decreased (0.3790 --> 0.3723).  Saving model state dict ...
Epoch: 2 cost time: 4.366776704788208
Epoch: 2, Steps: 257 | Train Loss: 0.4393834 Vali Loss: 0.3723024 Best vali loss: 0.3723024
	iters: 100, epoch: 3 | loss: 0.4926625
	speed: 0.0332s/iter; left time: 47.8732s
	iters: 200, epoch: 3 | loss: 0.5341167
	speed: 0.0128s/iter; left time: 17.2335s
Updating learning rate to 0.0014095574922425955
Epoch: 3 cost time: 3.2107901573181152
Epoch: 3, Steps: 257 | Train Loss: 0.5133896 Vali Loss: 0.3757161 Best vali loss: 0.3723024

best validation loss 0.37230236629840197

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0025880614769, 'e_layers': 2, 'learning_rate': 0.0008050296962, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3180364
	speed: 0.0140s/iter; left time: 27.4269s
	iters: 200, epoch: 1 | loss: 0.4521911
	speed: 0.0077s/iter; left time: 14.2634s
Updating learning rate to 0.0008050296962
Validation loss decreased (inf --> 0.3743).  Saving model state dict ...
Epoch: 1 cost time: 2.4983577728271484
Epoch: 1, Steps: 257 | Train Loss: 0.3851137 Vali Loss: 0.3742859 Best vali loss: 0.3742859
	iters: 100, epoch: 2 | loss: 0.5326905
	speed: 0.0165s/iter; left time: 28.1327s
	iters: 200, epoch: 2 | loss: 0.5468046
	speed: 0.0056s/iter; left time: 8.9812s
Updating learning rate to 0.0004025148481
Epoch: 2 cost time: 1.5457289218902588
Epoch: 2, Steps: 257 | Train Loss: 0.5397475 Vali Loss: 0.3852880 Best vali loss: 0.3742859
	iters: 100, epoch: 3 | loss: 0.6673807
	speed: 0.0177s/iter; left time: 25.5463s
	iters: 200, epoch: 3 | loss: 0.9310975
	speed: 0.0097s/iter; left time: 13.0871s
Updating learning rate to 0.00020125742405
Epoch: 3 cost time: 2.3523383140563965
Epoch: 3, Steps: 257 | Train Loss: 0.7992391 Vali Loss: 0.3762150 Best vali loss: 0.3742859

best validation loss 0.37428585108230533

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0028630346006, 'e_layers': 2, 'learning_rate': 0.002038872325, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7213683
	speed: 0.0156s/iter; left time: 18.5067s
	iters: 200, epoch: 4 | loss: 0.8283830
	speed: 0.0080s/iter; left time: 8.7409s
Updating learning rate to 0.0010194361625
Epoch: 4 cost time: 2.452401876449585
Epoch: 4, Steps: 257 | Train Loss: 0.7748756 Vali Loss: 0.3748363 Best vali loss: 0.3723024
	iters: 100, epoch: 5 | loss: 0.5248879
	speed: 0.0167s/iter; left time: 15.5366s
	iters: 200, epoch: 5 | loss: 0.3239313
	speed: 0.0062s/iter; left time: 5.1228s
Updating learning rate to 0.0006293148327574047
Epoch: 5 cost time: 1.707350730895996
Epoch: 5, Steps: 257 | Train Loss: 0.4244096 Vali Loss: 0.3840722 Best vali loss: 0.3723024
	iters: 100, epoch: 6 | loss: 0.4612551
	speed: 0.0185s/iter; left time: 12.4453s
	iters: 200, epoch: 6 | loss: 0.4529078
	speed: 0.0095s/iter; left time: 5.4171s
Updating learning rate to 0.00029858593900945887
Epoch: 6 cost time: 2.3274285793304443
Epoch: 6, Steps: 257 | Train Loss: 0.4570815 Vali Loss: 0.3828209 Best vali loss: 0.3723024
	iters: 100, epoch: 7 | loss: 0.4696175
	speed: 0.0184s/iter; left time: 7.6455s
	iters: 200, epoch: 7 | loss: 0.5442275
	speed: 0.0094s/iter; left time: 2.9531s
Updating learning rate to 7.759995726439987e-05
Epoch: 7 cost time: 2.3065614700317383
Epoch: 7, Steps: 257 | Train Loss: 0.5069225 Vali Loss: 0.3956132 Best vali loss: 0.3723024
	iters: 100, epoch: 8 | loss: 0.7733520
	speed: 0.0184s/iter; left time: 2.9099s
	iters: 200, epoch: 8 | loss: 0.4586855
	speed: 0.0071s/iter; left time: 0.4107s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8384323120117188
Epoch: 8, Steps: 257 | Train Loss: 0.6160188 Vali Loss: 0.3932147 Best vali loss: 0.3723024

best validation loss 0.37230236629840197

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041129782689, 'e_layers': 1, 'learning_rate': 6.6769528e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.422826415731963e-05
Validation loss decreased (inf --> 0.4325).  Saving model state dict ...
Epoch: 1 cost time: 1.5786309242248535
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4324535 Best vali loss: 0.4324535
Updating learning rate to 5.699135701271253e-05
Validation loss decreased (0.4325 --> 0.4182).  Saving model state dict ...
Epoch: 2 cost time: 1.2032532691955566
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4181871 Best vali loss: 0.4181871
Updating learning rate to 4.616056007621849e-05
Validation loss decreased (0.4182 --> 0.4083).  Saving model state dict ...
Epoch: 3 cost time: 1.2606213092803955
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4082653 Best vali loss: 0.4082653
Updating learning rate to 3.3384764e-05
Validation loss decreased (0.4083 --> 0.4019).  Saving model state dict ...
Epoch: 4 cost time: 0.8619515895843506
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4018769 Best vali loss: 0.4018769
Updating learning rate to 2.0608967923781517e-05
Validation loss decreased (0.4019 --> 0.3978).  Saving model state dict ...
Epoch: 5 cost time: 0.5892446041107178
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3977653 Best vali loss: 0.3977653
Updating learning rate to 9.778170987287473e-06
Validation loss decreased (0.3978 --> 0.3956).  Saving model state dict ...
Epoch: 6 cost time: 0.7283952236175537
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3955984 Best vali loss: 0.3955984
Updating learning rate to 2.541263842680365e-06
Validation loss decreased (0.3956 --> 0.3946).  Saving model state dict ...
Epoch: 7 cost time: 0.5854291915893555
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3945868 Best vali loss: 0.3945868
Updating learning rate to 0.0
Validation loss decreased (0.3946 --> 0.3943).  Saving model state dict ...
Epoch: 8 cost time: 0.5814304351806641
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3943390 Best vali loss: 0.3943390

best validation loss 0.3943390333465134

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0081331261032, 'e_layers': 3, 'learning_rate': 0.0002596282648, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2277146
	speed: 0.0125s/iter; left time: 101.1861s
	iters: 200, epoch: 1 | loss: 0.3794141
	speed: 0.0059s/iter; left time: 47.1977s
	iters: 300, epoch: 1 | loss: 0.6276337
	speed: 0.0067s/iter; left time: 52.7649s
	iters: 400, epoch: 1 | loss: 0.4207208
	speed: 0.0069s/iter; left time: 54.2244s
	iters: 500, epoch: 1 | loss: 1.7593275
	speed: 0.0057s/iter; left time: 44.2610s
	iters: 600, epoch: 1 | loss: 0.4425802
	speed: 0.0047s/iter; left time: 36.1650s
	iters: 700, epoch: 1 | loss: 1.0862349
	speed: 0.0043s/iter; left time: 32.2444s
	iters: 800, epoch: 1 | loss: 0.2729642
	speed: 0.0045s/iter; left time: 33.2060s
	iters: 900, epoch: 1 | loss: 0.2925863
	speed: 0.0062s/iter; left time: 45.0328s
	iters: 1000, epoch: 1 | loss: 0.9080371
	speed: 0.0083s/iter; left time: 59.7506s
Updating learning rate to 0.0002497467523550703
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 6.485146999359131
Epoch: 1, Steps: 1027 | Train Loss: 0.6417213 Vali Loss: 0.3656562 Best vali loss: 0.3656562
	iters: 100, epoch: 2 | loss: 1.2465694
	speed: 0.0258s/iter; left time: 182.7051s
	iters: 200, epoch: 2 | loss: 0.3019075
	speed: 0.0077s/iter; left time: 53.7024s
	iters: 300, epoch: 2 | loss: 0.3594506
	speed: 0.0079s/iter; left time: 54.4606s
	iters: 400, epoch: 2 | loss: 0.8477393
	speed: 0.0086s/iter; left time: 58.5041s
	iters: 500, epoch: 2 | loss: 0.6802502
	speed: 0.0085s/iter; left time: 57.1904s
	iters: 600, epoch: 2 | loss: 0.5564838
	speed: 0.0075s/iter; left time: 49.4258s
	iters: 700, epoch: 2 | loss: 0.3043611
	speed: 0.0079s/iter; left time: 51.2471s
	iters: 800, epoch: 2 | loss: 0.4505847
	speed: 0.0088s/iter; left time: 56.0156s
	iters: 900, epoch: 2 | loss: 0.3087604
	speed: 0.0091s/iter; left time: 57.0004s
	iters: 1000, epoch: 2 | loss: 0.2251895
	speed: 0.0091s/iter; left time: 56.3130s
Updating learning rate to 0.00022160658571388828
Epoch: 2 cost time: 8.656764030456543
Epoch: 2, Steps: 1027 | Train Loss: 0.5281296 Vali Loss: 0.3689828 Best vali loss: 0.3656562
	iters: 100, epoch: 3 | loss: 0.4116457
	speed: 0.0264s/iter; left time: 159.7837s
	iters: 200, epoch: 3 | loss: 0.3028705
	speed: 0.0084s/iter; left time: 50.2094s
	iters: 300, epoch: 3 | loss: 0.2616053
	speed: 0.0087s/iter; left time: 50.7661s
	iters: 400, epoch: 3 | loss: 0.2138495
	speed: 0.0086s/iter; left time: 49.6620s
	iters: 500, epoch: 3 | loss: 0.6414557
	speed: 0.0082s/iter; left time: 46.4499s
	iters: 600, epoch: 3 | loss: 0.8606027
	speed: 0.0082s/iter; left time: 45.5324s
	iters: 700, epoch: 3 | loss: 0.5957654
	speed: 0.0095s/iter; left time: 52.1604s
	iters: 800, epoch: 3 | loss: 0.2139595
	speed: 0.0094s/iter; left time: 50.1664s
	iters: 900, epoch: 3 | loss: 0.2097764
	speed: 0.0093s/iter; left time: 48.7899s
	iters: 1000, epoch: 3 | loss: 0.3845974
	speed: 0.0087s/iter; left time: 45.0026s
Updating learning rate to 0.00017949185015632822
Validation loss decreased (0.3657 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 9.01179575920105
Epoch: 3, Steps: 1027 | Train Loss: 0.4096128 Vali Loss: 0.3644105 Best vali loss: 0.3644105
	iters: 100, epoch: 4 | loss: 0.1763372
	speed: 0.0273s/iter; left time: 137.5300s
	iters: 200, epoch: 4 | loss: 0.3814506
	speed: 0.0087s/iter; left time: 42.7664s
	iters: 300, epoch: 4 | loss: 0.7031623
	speed: 0.0080s/iter; left time: 38.6958s
	iters: 400, epoch: 4 | loss: 0.2354349
	speed: 0.0078s/iter; left time: 37.0346s
	iters: 500, epoch: 4 | loss: 0.2869714
	speed: 0.0086s/iter; left time: 39.9001s
	iters: 600, epoch: 4 | loss: 1.3183619
	speed: 0.0076s/iter; left time: 34.2622s
	iters: 700, epoch: 4 | loss: 1.2375410
	speed: 0.0089s/iter; left time: 39.5500s
	iters: 800, epoch: 4 | loss: 0.5759678
	speed: 0.0088s/iter; left time: 38.2268s
	iters: 900, epoch: 4 | loss: 0.2859533
	speed: 0.0077s/iter; left time: 32.5164s
	iters: 1000, epoch: 4 | loss: 0.6680927
	speed: 0.0078s/iter; left time: 32.0911s
Updating learning rate to 0.0001298141324
Epoch: 4 cost time: 8.610634803771973
Epoch: 4, Steps: 1027 | Train Loss: 0.5869273 Vali Loss: 0.3672298 Best vali loss: 0.3644105
	iters: 100, epoch: 5 | loss: 0.6817167
	speed: 0.0264s/iter; left time: 105.8117s
	iters: 200, epoch: 5 | loss: 0.5227123
	speed: 0.0084s/iter; left time: 32.7331s
	iters: 300, epoch: 5 | loss: 1.0144608
	speed: 0.0083s/iter; left time: 31.6816s
	iters: 400, epoch: 5 | loss: 0.2064113
	speed: 0.0086s/iter; left time: 31.7189s
	iters: 500, epoch: 5 | loss: 0.5772744
	speed: 0.0096s/iter; left time: 34.6548s
	iters: 600, epoch: 5 | loss: 0.2664222
	speed: 0.0093s/iter; left time: 32.4866s
	iters: 700, epoch: 5 | loss: 0.4821202
	speed: 0.0093s/iter; left time: 31.6494s
	iters: 800, epoch: 5 | loss: 0.8742636
	speed: 0.0092s/iter; left time: 30.5994s
	iters: 900, epoch: 5 | loss: 0.4286485
	speed: 0.0090s/iter; left time: 28.7292s
	iters: 1000, epoch: 5 | loss: 0.6426787
	speed: 0.0093s/iter; left time: 28.9922s
Updating learning rate to 8.01364146436718e-05
Validation loss decreased (0.3644 --> 0.3563).  Saving model state dict ...
Epoch: 5 cost time: 9.249527215957642
Epoch: 5, Steps: 1027 | Train Loss: 0.5696709 Vali Loss: 0.3562814 Best vali loss: 0.3562814
	iters: 100, epoch: 6 | loss: 0.5926651
	speed: 0.0275s/iter; left time: 82.0301s
	iters: 200, epoch: 6 | loss: 0.2680252
	speed: 0.0079s/iter; left time: 22.8656s
	iters: 300, epoch: 6 | loss: 0.4054191
	speed: 0.0093s/iter; left time: 25.8358s
	iters: 400, epoch: 6 | loss: 0.5436118
	speed: 0.0091s/iter; left time: 24.4673s
	iters: 500, epoch: 6 | loss: 0.7952123
	speed: 0.0098s/iter; left time: 25.2244s
	iters: 600, epoch: 6 | loss: 0.4556718
	speed: 0.0100s/iter; left time: 24.8004s
	iters: 700, epoch: 6 | loss: 0.6092033
	speed: 0.0085s/iter; left time: 20.2947s
	iters: 800, epoch: 6 | loss: 1.3051286
	speed: 0.0080s/iter; left time: 18.3483s
	iters: 900, epoch: 6 | loss: 0.3789800
	speed: 0.0093s/iter; left time: 20.2106s
	iters: 1000, epoch: 6 | loss: 0.8262817
	speed: 0.0093s/iter; left time: 19.2735s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020104155457, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7320375
	speed: 0.0157s/iter; left time: 30.6770s
	iters: 200, epoch: 1 | loss: 0.6109490
	speed: 0.0108s/iter; left time: 20.1175s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 2.80519700050354
Epoch: 1, Steps: 257 | Train Loss: 0.6714933 Vali Loss: 0.3736772 Best vali loss: 0.3736772
	iters: 100, epoch: 2 | loss: 0.2726733
	speed: 0.0149s/iter; left time: 25.3207s
	iters: 200, epoch: 2 | loss: 0.9553322
	speed: 0.0057s/iter; left time: 9.1296s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 1.486041784286499
Epoch: 2, Steps: 257 | Train Loss: 0.6140027 Vali Loss: 0.3742566 Best vali loss: 0.3736772
	iters: 100, epoch: 3 | loss: 0.2846559
	speed: 0.0128s/iter; left time: 18.4851s
	iters: 200, epoch: 3 | loss: 0.4332749
	speed: 0.0062s/iter; left time: 8.3750s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.8013191223144531
Epoch: 3, Steps: 257 | Train Loss: 0.3589654 Vali Loss: 0.3769444 Best vali loss: 0.3736772

best validation loss 0.3736771585899158

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009333650974, 'e_layers': 1, 'learning_rate': 0.0001326193565, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001326193565
Validation loss decreased (inf --> 0.4307).  Saving model state dict ...
Epoch: 1 cost time: 0.8582475185394287
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4306925 Best vali loss: 0.4306925
Updating learning rate to 6.630967825e-05
Validation loss decreased (0.4307 --> 0.4155).  Saving model state dict ...
Epoch: 2 cost time: 0.4359414577484131
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4154762 Best vali loss: 0.4154762
Updating learning rate to 3.3154839125e-05
Validation loss decreased (0.4155 --> 0.4095).  Saving model state dict ...
Epoch: 3 cost time: 0.33026814460754395
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4094720 Best vali loss: 0.4094720

best validation loss 0.409471990797515

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0016936034194, 'e_layers': 3, 'learning_rate': 0.0035832659824, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0034468860415416544
Validation loss decreased (inf --> 0.4057).  Saving model state dict ...
Epoch: 1 cost time: 1.578996181488037
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4057449 Best vali loss: 0.4057449
Updating learning rate to 0.003058508828675058
Epoch: 2 cost time: 1.21467924118042
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4059592 Best vali loss: 0.4057449
Updating learning rate to 0.0024772612538109485
Validation loss decreased (0.4057 --> 0.3967).  Saving model state dict ...
Epoch: 3 cost time: 1.1918847560882568
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3967307 Best vali loss: 0.3967307

best validation loss 0.3967306699757492

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0020104155457, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6339145
	speed: 0.0104s/iter; left time: 12.3126s
	iters: 200, epoch: 4 | loss: 0.4587582
	speed: 0.0043s/iter; left time: 4.6945s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 1.5475995540618896
Epoch: 4, Steps: 257 | Train Loss: 0.5463363 Vali Loss: 0.3805745 Best vali loss: 0.3736772
	iters: 100, epoch: 5 | loss: 0.2722178
	speed: 0.0156s/iter; left time: 14.4596s
	iters: 200, epoch: 5 | loss: 0.7654022
	speed: 0.0064s/iter; left time: 5.2860s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 1.7535314559936523
Epoch: 5, Steps: 257 | Train Loss: 0.5188100 Vali Loss: 0.3797737 Best vali loss: 0.3736772
	iters: 100, epoch: 6 | loss: 0.2468872
	speed: 0.0122s/iter; left time: 8.2291s
	iters: 200, epoch: 6 | loss: 0.3302937
	speed: 0.0037s/iter; left time: 2.1362s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 1.2511522769927979
Epoch: 6, Steps: 257 | Train Loss: 0.2885905 Vali Loss: 0.3848296 Best vali loss: 0.3736772
	iters: 100, epoch: 7 | loss: 0.4034462
	speed: 0.0177s/iter; left time: 7.3571s
	iters: 200, epoch: 7 | loss: 0.3965864
	speed: 0.0089s/iter; left time: 2.7993s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 1.9179601669311523
Epoch: 7, Steps: 257 | Train Loss: 0.4000163 Vali Loss: 0.3853198 Best vali loss: 0.3736772
	iters: 100, epoch: 8 | loss: 0.6606802
	speed: 0.0178s/iter; left time: 2.8146s
	iters: 200, epoch: 8 | loss: 0.6035996
	speed: 0.0037s/iter; left time: 0.2142s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3730390071868896
Epoch: 8, Steps: 257 | Train Loss: 0.6321399 Vali Loss: 0.3859878 Best vali loss: 0.3736772

best validation loss 0.3736771585899158

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0074460408096, 'e_layers': 3, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2369596
	speed: 0.0156s/iter; left time: 62.7180s
	iters: 200, epoch: 1 | loss: 0.7051135
	speed: 0.0089s/iter; left time: 34.9791s
	iters: 300, epoch: 1 | loss: 1.0155828
	speed: 0.0088s/iter; left time: 33.5767s
	iters: 400, epoch: 1 | loss: 1.0270000
	speed: 0.0092s/iter; left time: 34.0289s
	iters: 500, epoch: 1 | loss: 0.7724296
	speed: 0.0092s/iter; left time: 33.0919s
Updating learning rate to 0.0027349231343
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 5.013056039810181
Epoch: 1, Steps: 514 | Train Loss: 0.9514171 Vali Loss: 0.3757322 Best vali loss: 0.3757322
	iters: 100, epoch: 2 | loss: 0.3926333
	speed: 0.0201s/iter; left time: 70.3236s
	iters: 200, epoch: 2 | loss: 0.7388225
	speed: 0.0081s/iter; left time: 27.5097s
	iters: 300, epoch: 2 | loss: 0.4867197
	speed: 0.0061s/iter; left time: 20.0861s
	iters: 400, epoch: 2 | loss: 0.3359029
	speed: 0.0061s/iter; left time: 19.5807s
	iters: 500, epoch: 2 | loss: 0.4522030
	speed: 0.0076s/iter; left time: 23.4963s
Updating learning rate to 0.00136746156715
Validation loss decreased (0.3757 --> 0.3732).  Saving model state dict ...
Epoch: 2 cost time: 3.8937225341796875
Epoch: 2, Steps: 514 | Train Loss: 0.4812563 Vali Loss: 0.3732317 Best vali loss: 0.3732317
	iters: 100, epoch: 3 | loss: 0.6138231
	speed: 0.0173s/iter; left time: 51.7561s
	iters: 200, epoch: 3 | loss: 0.6119000
	speed: 0.0080s/iter; left time: 22.9809s
	iters: 300, epoch: 3 | loss: 0.7395859
	speed: 0.0082s/iter; left time: 22.7160s
	iters: 400, epoch: 3 | loss: 0.8163776
	speed: 0.0089s/iter; left time: 23.9663s
	iters: 500, epoch: 3 | loss: 0.6171455
	speed: 0.0085s/iter; left time: 22.0312s
Updating learning rate to 0.000683730783575
Validation loss decreased (0.3732 --> 0.3726).  Saving model state dict ...
Epoch: 3 cost time: 4.375330209732056
Epoch: 3, Steps: 514 | Train Loss: 0.6797664 Vali Loss: 0.3725935 Best vali loss: 0.3725935
	iters: 100, epoch: 4 | loss: 0.4548798
	speed: 0.0183s/iter; left time: 45.2327s
	iters: 200, epoch: 4 | loss: 0.3191777
	speed: 0.0084s/iter; left time: 19.9006s
	iters: 300, epoch: 4 | loss: 0.6436471
	speed: 0.0083s/iter; left time: 18.7393s
	iters: 400, epoch: 4 | loss: 0.4661033
	speed: 0.0087s/iter; left time: 18.7922s
	iters: 500, epoch: 4 | loss: 0.2817356
	speed: 0.0081s/iter; left time: 16.7085s
Updating learning rate to 0.0003418653917875
Epoch: 4 cost time: 4.35831880569458
Epoch: 4, Steps: 514 | Train Loss: 0.4331087 Vali Loss: 0.3768569 Best vali loss: 0.3725935
	iters: 100, epoch: 5 | loss: 0.7615880
	speed: 0.0183s/iter; left time: 35.7289s
	iters: 200, epoch: 5 | loss: 0.5512679
	speed: 0.0083s/iter; left time: 15.4102s
	iters: 300, epoch: 5 | loss: 0.5527004
	speed: 0.0083s/iter; left time: 14.5648s
	iters: 400, epoch: 5 | loss: 0.3443736
	speed: 0.0087s/iter; left time: 14.3732s
	iters: 500, epoch: 5 | loss: 0.6109316
	speed: 0.0084s/iter; left time: 13.1262s
Updating learning rate to 0.00017093269589375
Validation loss decreased (0.3726 --> 0.3664).  Saving model state dict ...
Epoch: 5 cost time: 4.37711763381958
Epoch: 5, Steps: 514 | Train Loss: 0.5641723 Vali Loss: 0.3663842 Best vali loss: 0.3663842
	iters: 100, epoch: 6 | loss: 0.5423486
	speed: 0.0193s/iter; left time: 27.7964s
	iters: 200, epoch: 6 | loss: 0.7535682
	speed: 0.0083s/iter; left time: 11.1884s
	iters: 300, epoch: 6 | loss: 0.4864270
	speed: 0.0082s/iter; left time: 10.2388s
	iters: 400, epoch: 6 | loss: 0.5425204
	speed: 0.0092s/iter; left time: 10.5031s
	iters: 500, epoch: 6 | loss: 0.4427271
	speed: 0.0084s/iter; left time: 8.7239s
Updating learning rate to 8.5466347946875e-05
Validation loss decreased (0.3664 --> 0.3658).  Saving model state dict ...
Epoch: 6 cost time: 4.428741216659546
Epoch: 6, Steps: 514 | Train Loss: 0.5535183 Vali Loss: 0.3657601 Best vali loss: 0.3657601
	iters: 100, epoch: 7 | loss: 0.2732792
	speed: 0.0176s/iter; left time: 16.3405s
	iters: 200, epoch: 7 | loss: 0.6847021
	speed: 0.0080s/iter; left time: 6.6679s
	iters: 300, epoch: 7 | loss: 0.3287541
	speed: 0.0074s/iter; left time: 5.3615s
	iters: 400, epoch: 7 | loss: 0.6597552
	speed: 0.0090s/iter; left time: 5.6756s
	iters: 500, epoch: 7 | loss: 0.4586355
	speed: 0.0085s/iter; left time: 4.4979s
Updating learning rate to 4.27331739734375e-05
Validation loss decreased (0.3658 --> 0.3635).  Saving model state dict ...
Epoch: 7 cost time: 4.295426845550537
Epoch: 7, Steps: 514 | Train Loss: 0.4810252 Vali Loss: 0.3635145 Best vali loss: 0.3635145
	iters: 100, epoch: 8 | loss: 0.3936367
	speed: 0.0184s/iter; left time: 7.6153s
	iters: 200, epoch: 8 | loss: 0.8438534
	speed: 0.0087s/iter; left time: 2.7463s
	iters: 300, epoch: 8 | loss: 0.3393552
	speed: 0.0094s/iter; left time: 2.0186s
	iters: 400, epoch: 8 | loss: 0.2938462
	speed: 0.0088s/iter; left time: 1.0070s
	iters: 500, epoch: 8 | loss: 0.3404685
	speed: 0.0086s/iter; left time: 0.1289s
Updating learning rate to 2.136658698671875e-05
Validation loss decreased (0.3635 --> 0.3626).  Saving model state dict ...
Epoch: 8 cost time: 4.579582214355469
Epoch: 8, Steps: 514 | Train Loss: 0.4422320 Vali Loss: 0.3625623 Best vali loss: 0.3625623

best validation loss 0.3625622827903695

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0010150710951, 'e_layers': 1, 'learning_rate': 0.0009798333945, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3075886
	speed: 0.0114s/iter; left time: 92.4693s
	iters: 200, epoch: 1 | loss: 0.9724235
	speed: 0.0048s/iter; left time: 38.2479s
	iters: 300, epoch: 1 | loss: 0.2163095
	speed: 0.0044s/iter; left time: 34.7460s
	iters: 400, epoch: 1 | loss: 0.2242943
	speed: 0.0048s/iter; left time: 37.8189s
	iters: 500, epoch: 1 | loss: 0.4369278
	speed: 0.0048s/iter; left time: 37.2158s
	iters: 600, epoch: 1 | loss: 1.0526062
	speed: 0.0049s/iter; left time: 37.0460s
	iters: 700, epoch: 1 | loss: 0.4445528
	speed: 0.0048s/iter; left time: 35.9285s
	iters: 800, epoch: 1 | loss: 1.1056424
	speed: 0.0049s/iter; left time: 36.0428s
	iters: 900, epoch: 1 | loss: 0.7473882
	speed: 0.0048s/iter; left time: 35.2743s
	iters: 1000, epoch: 1 | loss: 0.9027693
	speed: 0.0051s/iter; left time: 36.6933s
Updating learning rate to 0.0009425407064748036
Validation loss decreased (inf --> 0.3822).  Saving model state dict ...
Epoch: 1 cost time: 5.29525899887085
Epoch: 1, Steps: 1027 | Train Loss: 0.6410503 Vali Loss: 0.3821775 Best vali loss: 0.3821775
	iters: 100, epoch: 2 | loss: 0.2830982
	speed: 0.0170s/iter; left time: 120.3451s
	iters: 200, epoch: 2 | loss: 0.2021995
	speed: 0.0045s/iter; left time: 31.6788s
	iters: 300, epoch: 2 | loss: 0.5112710
	speed: 0.0043s/iter; left time: 29.8960s
	iters: 400, epoch: 2 | loss: 1.0488497
	speed: 0.0043s/iter; left time: 29.2426s
	iters: 500, epoch: 2 | loss: 0.4829880
	speed: 0.0044s/iter; left time: 29.2495s
	iters: 600, epoch: 2 | loss: 0.2610339
	speed: 0.0049s/iter; left time: 32.1877s
	iters: 700, epoch: 2 | loss: 0.3944017
	speed: 0.0049s/iter; left time: 31.8817s
	iters: 800, epoch: 2 | loss: 0.8575444
	speed: 0.0049s/iter; left time: 31.0545s
	iters: 900, epoch: 2 | loss: 0.7089078
	speed: 0.0049s/iter; left time: 30.5615s
	iters: 1000, epoch: 2 | loss: 1.9714804
	speed: 0.0046s/iter; left time: 28.5101s
Updating learning rate to 0.0008363401160919918
Validation loss decreased (0.3822 --> 0.3735).  Saving model state dict ...
Epoch: 2 cost time: 4.766465187072754
Epoch: 2, Steps: 1027 | Train Loss: 0.6721775 Vali Loss: 0.3734655 Best vali loss: 0.3734655
	iters: 100, epoch: 3 | loss: 1.0075454
	speed: 0.0175s/iter; left time: 106.0028s
	iters: 200, epoch: 3 | loss: 0.3938693
	speed: 0.0051s/iter; left time: 30.3678s
	iters: 300, epoch: 3 | loss: 0.5440068
	speed: 0.0050s/iter; left time: 29.4773s
	iters: 400, epoch: 3 | loss: 0.3264814
	speed: 0.0050s/iter; left time: 28.8905s
	iters: 500, epoch: 3 | loss: 0.3577313
	speed: 0.0051s/iter; left time: 29.0518s
	iters: 600, epoch: 3 | loss: 1.5029864
	speed: 0.0051s/iter; left time: 28.3961s
	iters: 700, epoch: 3 | loss: 0.3305798
	speed: 0.0045s/iter; left time: 24.7551s
	iters: 800, epoch: 3 | loss: 0.4562711
	speed: 0.0040s/iter; left time: 21.5975s
	iters: 900, epoch: 3 | loss: 0.2355637
	speed: 0.0040s/iter; left time: 20.9119s
	iters: 1000, epoch: 3 | loss: 0.7458901
	speed: 0.0041s/iter; left time: 21.4262s
Updating learning rate to 0.0006773997005265986
Epoch: 3 cost time: 4.825568199157715
Epoch: 3, Steps: 1027 | Train Loss: 0.5900925 Vali Loss: 0.3913700 Best vali loss: 0.3734655
	iters: 100, epoch: 4 | loss: 0.1607888
	speed: 0.0155s/iter; left time: 78.0273s
	iters: 200, epoch: 4 | loss: 0.8379248
	speed: 0.0051s/iter; left time: 25.3403s
	iters: 300, epoch: 4 | loss: 1.0382948
	speed: 0.0050s/iter; left time: 24.2268s
	iters: 400, epoch: 4 | loss: 0.3688668
	speed: 0.0051s/iter; left time: 23.9756s
	iters: 500, epoch: 4 | loss: 0.4323268
	speed: 0.0051s/iter; left time: 23.6742s
	iters: 600, epoch: 4 | loss: 0.4743212
	speed: 0.0052s/iter; left time: 23.6802s
	iters: 700, epoch: 4 | loss: 0.7451280
	speed: 0.0042s/iter; left time: 18.5249s
	iters: 800, epoch: 4 | loss: 0.2452672
	speed: 0.0048s/iter; left time: 20.9556s
	iters: 900, epoch: 4 | loss: 0.2148332
	speed: 0.0039s/iter; left time: 16.3367s
	iters: 1000, epoch: 4 | loss: 0.3967500
	speed: 0.0040s/iter; left time: 16.6399s
Updating learning rate to 0.00048991669725
Epoch: 4 cost time: 4.92902135848999
Epoch: 4, Steps: 1027 | Train Loss: 0.4914502 Vali Loss: 0.3893836 Best vali loss: 0.3734655
	iters: 100, epoch: 5 | loss: 0.2552379
	speed: 0.0135s/iter; left time: 54.2316s
	iters: 200, epoch: 5 | loss: 0.3849423
	speed: 0.0043s/iter; left time: 16.7275s
	iters: 300, epoch: 5 | loss: 0.2174657
	speed: 0.0042s/iter; left time: 16.1343s
	iters: 400, epoch: 5 | loss: 0.3752199
	speed: 0.0048s/iter; left time: 17.7048s
	iters: 500, epoch: 5 | loss: 1.4501891
	speed: 0.0042s/iter; left time: 15.2937s
	iters: 600, epoch: 5 | loss: 0.1936847
	speed: 0.0051s/iter; left time: 17.8269s
	iters: 700, epoch: 5 | loss: 0.4473653
	speed: 0.0044s/iter; left time: 15.1546s
	iters: 800, epoch: 5 | loss: 0.4666150
	speed: 0.0045s/iter; left time: 15.0102s
	iters: 900, epoch: 5 | loss: 0.2472572
	speed: 0.0043s/iter; left time: 13.7830s
	iters: 1000, epoch: 5 | loss: 0.2795915
	speed: 0.0042s/iter; left time: 13.2084s
Updating learning rate to 0.0003024336939734015
Epoch: 5 cost time: 4.539174318313599
Epoch: 5, Steps: 1027 | Train Loss: 0.4317568 Vali Loss: 0.4013079 Best vali loss: 0.3734655
	iters: 100, epoch: 6 | loss: 0.3649729
	speed: 0.0155s/iter; left time: 46.1305s
	iters: 200, epoch: 6 | loss: 0.4131552
	speed: 0.0044s/iter; left time: 12.7487s
	iters: 300, epoch: 6 | loss: 0.1804978
	speed: 0.0041s/iter; left time: 11.2684s
	iters: 400, epoch: 6 | loss: 0.5618153
	speed: 0.0036s/iter; left time: 9.7189s
	iters: 500, epoch: 6 | loss: 0.3120433
	speed: 0.0039s/iter; left time: 10.0984s
	iters: 600, epoch: 6 | loss: 0.3384279
	speed: 0.0045s/iter; left time: 11.1792s
	iters: 700, epoch: 6 | loss: 0.8208134
	speed: 0.0047s/iter; left time: 11.1218s
	iters: 800, epoch: 6 | loss: 0.3587252
	speed: 0.0046s/iter; left time: 10.4874s
	iters: 900, epoch: 6 | loss: 0.1833107
	speed: 0.0046s/iter; left time: 10.1286s
	iters: 1000, epoch: 6 | loss: 0.3368277
	speed: 0.0046s/iter; left time: 9.5553s
Updating learning rate to 0.00014349327840800823
Epoch: 6 cost time: 4.524951457977295
Epoch: 6, Steps: 1027 | Train Loss: 0.3870590 Vali Loss: 0.4051574 Best vali loss: 0.3734655
	iters: 100, epoch: 7 | loss: 0.9218640
	speed: 0.0169s/iter; left time: 32.9924s
	iters: 200, epoch: 7 | loss: 0.2168632
	speed: 0.0046s/iter; left time: 8.6242s
	iters: 300, epoch: 7 | loss: 0.4007310
	speed: 0.0045s/iter; left time: 7.9642s
	iters: 400, epoch: 7 | loss: 0.4413298
	speed: 0.0046s/iter; left time: 7.6858s
	iters: 500, epoch: 7 | loss: 0.2645887
	speed: 0.0046s/iter; left time: 7.1185s
	iters: 600, epoch: 7 | loss: 0.2644971
	speed: 0.0047s/iter; left time: 6.7706s
	iters: 700, epoch: 7 | loss: 0.6868222
	speed: 0.0047s/iter; left time: 6.3496s
	iters: 800, epoch: 7 | loss: 0.2580495
	speed: 0.0046s/iter; left time: 5.7164s
	iters: 900, epoch: 7 | loss: 0.7123007
	speed: 0.0044s/iter; left time: 5.0408s
	iters: 1000, epoch: 7 | loss: 0.2418586
	speed: 0.0042s/iter; left time: 4.3854s
Updating learning rate to 3.72926880251964e-05
Epoch: 7 cost time: 4.708346843719482
Epoch: 7, Steps: 1027 | Train Loss: 0.4408905 Vali Loss: 0.4135805 Best vali loss: 0.3734655
	iters: 100, epoch: 8 | loss: 0.5289794
	speed: 0.0156s/iter; left time: 14.4693s
	iters: 200, epoch: 8 | loss: 0.3291830
	speed: 0.0046s/iter; left time: 3.7909s
	iters: 300, epoch: 8 | loss: 0.1633052
	speed: 0.0046s/iter; left time: 3.3451s
	iters: 400, epoch: 8 | loss: 0.3625096
	speed: 0.0046s/iter; left time: 2.8853s
	iters: 500, epoch: 8 | loss: 0.2583843
	speed: 0.0046s/iter; left time: 2.4156s
	iters: 600, epoch: 8 | loss: 0.1846706
	speed: 0.0047s/iter; left time: 2.0274s
	iters: 700, epoch: 8 | loss: 0.5222579
	speed: 0.0046s/iter; left time: 1.5044s
	iters: 800, epoch: 8 | loss: 0.3797644
	speed: 0.0042s/iter; left time: 0.9642s
	iters: 900, epoch: 8 | loss: 0.2893352
	speed: 0.0043s/iter; left time: 0.5547s
	iters: 1000, epoch: 8 | loss: 0.5493763
	speed: 0.0047s/iter; left time: 0.1312s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.664821147918701
Epoch: 8, Steps: 1027 | Train Loss: 0.3567766 Vali Loss: 0.4179623 Best vali loss: 0.3734655

best validation loss 0.3734654661128938

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0099942109668, 'e_layers': 3, 'learning_rate': 0.000143598518, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7544818
	speed: 0.0159s/iter; left time: 14.7886s
Updating learning rate to 0.0001381331248395768
Validation loss decreased (inf --> 0.3935).  Saving model state dict ...
Epoch: 1 cost time: 1.5415873527526855
Epoch: 1, Steps: 129 | Train Loss: 0.7544818 Vali Loss: 0.3934583 Best vali loss: 0.3934583
	iters: 100, epoch: 2 | loss: 0.6196654
	speed: 0.0180s/iter; left time: 14.4932s
Updating learning rate to 0.00012256900192306926
Validation loss decreased (0.3935 --> 0.3770).  Saving model state dict ...
Epoch: 2 cost time: 1.450394868850708
Epoch: 2, Steps: 129 | Train Loss: 0.6196654 Vali Loss: 0.3769524 Best vali loss: 0.3769524
	iters: 100, epoch: 3 | loss: 0.4232743
	speed: 0.0117s/iter; left time: 7.8853s
Updating learning rate to 9.927564587539008e-05
Validation loss decreased (0.3770 --> 0.3707).  Saving model state dict ...
Epoch: 3 cost time: 1.0549628734588623
Epoch: 3, Steps: 129 | Train Loss: 0.4232743 Vali Loss: 0.3706842 Best vali loss: 0.3706842

best validation loss 0.3706841815197163

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0028532417254, 'e_layers': 4, 'learning_rate': 0.0002361700896, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002361700896
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.1118237972259521
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3715587 Best vali loss: 0.3715587
Updating learning rate to 0.0001180850448
Validation loss decreased (0.3716 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 0.7593975067138672
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3642759 Best vali loss: 0.3642759
Updating learning rate to 5.90425224e-05
Epoch: 3 cost time: 0.8240597248077393
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3644483 Best vali loss: 0.3642759

best validation loss 0.3642758529991907

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0047944010131, 'e_layers': 1, 'learning_rate': 0.0014991040224, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5799943
	speed: 0.0136s/iter; left time: 12.6460s
Updating learning rate to 0.0014420477729003508
Validation loss decreased (inf --> 0.3643).  Saving model state dict ...
Epoch: 1 cost time: 1.347902774810791
Epoch: 1, Steps: 129 | Train Loss: 0.5799943 Vali Loss: 0.3642722 Best vali loss: 0.3642722
	iters: 100, epoch: 2 | loss: 0.4585611
	speed: 0.0125s/iter; left time: 10.0373s
Updating learning rate to 0.001279565321171535
Epoch: 2 cost time: 0.8962018489837646
Epoch: 2, Steps: 129 | Train Loss: 0.4585611 Vali Loss: 0.3852989 Best vali loss: 0.3642722
	iters: 100, epoch: 3 | loss: 0.4166884
	speed: 0.0107s/iter; left time: 7.2313s
Updating learning rate to 0.0010363931475821722
Epoch: 3 cost time: 0.6851978302001953
Epoch: 3, Steps: 129 | Train Loss: 0.4166884 Vali Loss: 0.3913691 Best vali loss: 0.3642722

best validation loss 0.3642721552277361

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0047944010131, 'e_layers': 1, 'learning_rate': 0.0014991040224, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4571734
	speed: 0.0151s/iter; left time: 8.2597s
Updating learning rate to 0.0007495520112
Epoch: 4 cost time: 1.419525146484375
Epoch: 4, Steps: 129 | Train Loss: 0.4571734 Vali Loss: 0.3933649 Best vali loss: 0.3642722
	iters: 100, epoch: 5 | loss: 0.3966362
	speed: 0.0130s/iter; left time: 5.4098s
Updating learning rate to 0.00046271087481782784
Epoch: 5 cost time: 0.9586482048034668
Epoch: 5, Steps: 129 | Train Loss: 0.3966362 Vali Loss: 0.4129862 Best vali loss: 0.3642722
	iters: 100, epoch: 6 | loss: 0.3672914
	speed: 0.0121s/iter; left time: 3.4764s
Updating learning rate to 0.00021953870122846505
Epoch: 6 cost time: 0.863792896270752
Epoch: 6, Steps: 129 | Train Loss: 0.3672914 Vali Loss: 0.4080578 Best vali loss: 0.3642722
	iters: 100, epoch: 7 | loss: 0.5581925
	speed: 0.0072s/iter; left time: 1.1448s
Updating learning rate to 5.705624949964924e-05
Epoch: 7 cost time: 0.5604453086853027
Epoch: 7, Steps: 129 | Train Loss: 0.5581925 Vali Loss: 0.3980329 Best vali loss: 0.3642722
	iters: 100, epoch: 8 | loss: 0.3081664
	speed: 0.0116s/iter; left time: 0.3477s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0195915699005127
Epoch: 8, Steps: 129 | Train Loss: 0.3081664 Vali Loss: 0.4023022 Best vali loss: 0.3642722

best validation loss 0.3642721552277361

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0061868976715, 'e_layers': 4, 'learning_rate': 0.0013459980288, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5781008
	speed: 0.0186s/iter; left time: 17.3541s
Updating learning rate to 0.0012947690292044289
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.9121665954589844
Epoch: 1, Steps: 129 | Train Loss: 0.5781008 Vali Loss: 0.3704248 Best vali loss: 0.3704248
	iters: 100, epoch: 2 | loss: 0.6691031
	speed: 0.0170s/iter; left time: 13.6490s
Updating learning rate to 0.001148881181214103
Validation loss decreased (0.3704 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 1.2591173648834229
Epoch: 2, Steps: 129 | Train Loss: 0.6691031 Vali Loss: 0.3693943 Best vali loss: 0.3693943
	iters: 100, epoch: 3 | loss: 0.6540440
	speed: 0.0143s/iter; left time: 9.6577s
Updating learning rate to 0.0009305445872089146
Epoch: 3 cost time: 1.3132014274597168
Epoch: 3, Steps: 129 | Train Loss: 0.6540440 Vali Loss: 0.3774689 Best vali loss: 0.3693943
	iters: 100, epoch: 4 | loss: 0.5059215
	speed: 0.0172s/iter; left time: 9.4156s
Updating learning rate to 0.0006729990144
Epoch: 4 cost time: 1.4632413387298584
Epoch: 4, Steps: 129 | Train Loss: 0.5059215 Vali Loss: 0.3698978 Best vali loss: 0.3693943
	iters: 100, epoch: 5 | loss: 0.5454561
	speed: 0.0164s/iter; left time: 6.8254s
Updating learning rate to 0.00041545344159108557
Epoch: 5 cost time: 1.3390932083129883
Epoch: 5, Steps: 129 | Train Loss: 0.5454561 Vali Loss: 0.3797140 Best vali loss: 0.3693943
	iters: 100, epoch: 6 | loss: 0.5714297
	speed: 0.0164s/iter; left time: 4.7166s
Updating learning rate to 0.0001971168475858971
Epoch: 6 cost time: 1.3814771175384521
Epoch: 6, Steps: 129 | Train Loss: 0.5714297 Vali Loss: 0.3799591 Best vali loss: 0.3693943
	iters: 100, epoch: 7 | loss: 0.7759790
	speed: 0.0180s/iter; left time: 2.8588s
Updating learning rate to 5.122899959557127e-05
Epoch: 7 cost time: 1.3649113178253174
Epoch: 7, Steps: 129 | Train Loss: 0.7759790 Vali Loss: 0.3802193 Best vali loss: 0.3693943
	iters: 100, epoch: 8 | loss: 0.6377551
	speed: 0.0173s/iter; left time: 0.5183s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.350766658782959
Epoch: 8, Steps: 129 | Train Loss: 0.6377551 Vali Loss: 0.3805905 Best vali loss: 0.3693943

best validation loss 0.36939431637349907

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0068963321244, 'e_layers': 2, 'learning_rate': 0.0002633971008, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5182868
	speed: 0.0133s/iter; left time: 53.2602s
	iters: 200, epoch: 1 | loss: 0.7425364
	speed: 0.0074s/iter; left time: 28.9914s
	iters: 300, epoch: 1 | loss: 0.4132462
	speed: 0.0075s/iter; left time: 28.4678s
	iters: 400, epoch: 1 | loss: 0.8223926
	speed: 0.0102s/iter; left time: 37.7829s
	iters: 500, epoch: 1 | loss: 0.7785293
	speed: 0.0111s/iter; left time: 39.9307s
Updating learning rate to 0.0002633971008
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 4.7748799324035645
Epoch: 1, Steps: 514 | Train Loss: 0.6549982 Vali Loss: 0.3704142 Best vali loss: 0.3704142
	iters: 100, epoch: 2 | loss: 0.7150170
	speed: 0.0374s/iter; left time: 130.8762s
	iters: 200, epoch: 2 | loss: 0.7073088
	speed: 0.0116s/iter; left time: 39.3263s
	iters: 300, epoch: 2 | loss: 0.5910704
	speed: 0.0106s/iter; left time: 34.8844s
	iters: 400, epoch: 2 | loss: 0.2689507
	speed: 0.0119s/iter; left time: 38.1232s
	iters: 500, epoch: 2 | loss: 0.8916078
	speed: 0.0115s/iter; left time: 35.4983s
Updating learning rate to 0.0001316985504
Validation loss decreased (0.3704 --> 0.3688).  Saving model state dict ...
Epoch: 2 cost time: 5.965487718582153
Epoch: 2, Steps: 514 | Train Loss: 0.6347909 Vali Loss: 0.3687962 Best vali loss: 0.3687962
	iters: 100, epoch: 3 | loss: 0.6460925
	speed: 0.0347s/iter; left time: 103.6139s
	iters: 200, epoch: 3 | loss: 0.3207447
	speed: 0.0072s/iter; left time: 20.7965s
	iters: 300, epoch: 3 | loss: 0.5116950
	speed: 0.0075s/iter; left time: 20.9578s
	iters: 400, epoch: 3 | loss: 0.5264838
	speed: 0.0081s/iter; left time: 21.7508s
	iters: 500, epoch: 3 | loss: 0.8585531
	speed: 0.0075s/iter; left time: 19.4493s
Updating learning rate to 6.58492752e-05
Validation loss decreased (0.3688 --> 0.3657).  Saving model state dict ...
Epoch: 3 cost time: 4.1582629680633545
Epoch: 3, Steps: 514 | Train Loss: 0.5727138 Vali Loss: 0.3656609 Best vali loss: 0.3656609
	iters: 100, epoch: 4 | loss: 0.8344326
	speed: 0.0172s/iter; left time: 42.5631s
	iters: 200, epoch: 4 | loss: 0.3931801
	speed: 0.0077s/iter; left time: 18.1824s
	iters: 300, epoch: 4 | loss: 0.3789500
	speed: 0.0076s/iter; left time: 17.3686s
	iters: 400, epoch: 4 | loss: 0.5404210
	speed: 0.0083s/iter; left time: 17.9357s
	iters: 500, epoch: 4 | loss: 0.4733183
	speed: 0.0075s/iter; left time: 15.5555s
Updating learning rate to 3.29246376e-05
Epoch: 4 cost time: 4.032460689544678
Epoch: 4, Steps: 514 | Train Loss: 0.5240604 Vali Loss: 0.3691703 Best vali loss: 0.3656609
	iters: 100, epoch: 5 | loss: 0.9062157
	speed: 0.0171s/iter; left time: 33.4235s
	iters: 200, epoch: 5 | loss: 0.6651102
	speed: 0.0078s/iter; left time: 14.3963s
	iters: 300, epoch: 5 | loss: 1.0464708
	speed: 0.0078s/iter; left time: 13.6195s
	iters: 400, epoch: 5 | loss: 0.3439823
	speed: 0.0078s/iter; left time: 12.8899s
	iters: 500, epoch: 5 | loss: 0.6395975
	speed: 0.0074s/iter; left time: 11.4991s
Updating learning rate to 1.64623188e-05
Epoch: 5 cost time: 3.9853386878967285
Epoch: 5, Steps: 514 | Train Loss: 0.7202753 Vali Loss: 0.3702121 Best vali loss: 0.3656609
	iters: 100, epoch: 6 | loss: 0.5441533
	speed: 0.0168s/iter; left time: 24.2583s
	iters: 200, epoch: 6 | loss: 0.8514761
	speed: 0.0079s/iter; left time: 10.6276s
	iters: 300, epoch: 6 | loss: 0.6088122
	speed: 0.0077s/iter; left time: 9.5452s
	iters: 400, epoch: 6 | loss: 0.7116843
	speed: 0.0074s/iter; left time: 8.4138s
	iters: 500, epoch: 6 | loss: 0.5323653
	speed: 0.0076s/iter; left time: 7.8865s
Updating learning rate to 8.2311594e-06
Epoch: 6 cost time: 3.9601387977600098
Epoch: 6, Steps: 514 | Train Loss: 0.6496983 Vali Loss: 0.3706590 Best vali loss: 0.3656609
	iters: 100, epoch: 7 | loss: 0.4201101
	speed: 0.0173s/iter; left time: 16.1115s
	iters: 200, epoch: 7 | loss: 0.3447292
	speed: 0.0077s/iter; left time: 6.4230s
	iters: 300, epoch: 7 | loss: 0.5241465
	speed: 0.0077s/iter; left time: 5.5805s
	iters: 400, epoch: 7 | loss: 0.7115951
	speed: 0.0083s/iter; left time: 5.2277s
	iters: 500, epoch: 7 | loss: 0.4571761
	speed: 0.0077s/iter; left time: 4.0814s
Updating learning rate to 4.1155797e-06
Epoch: 7 cost time: 4.093288421630859
Epoch: 7, Steps: 514 | Train Loss: 0.4915514 Vali Loss: 0.3713194 Best vali loss: 0.3656609
	iters: 100, epoch: 8 | loss: 0.9372284
	speed: 0.0164s/iter; left time: 6.8021s
	iters: 200, epoch: 8 | loss: 0.7296304
	speed: 0.0078s/iter; left time: 2.4522s
	iters: 300, epoch: 8 | loss: 0.3698431
	speed: 0.0074s/iter; left time: 1.5830s
	iters: 400, epoch: 8 | loss: 0.7918715
	speed: 0.0081s/iter; left time: 0.9336s
	iters: 500, epoch: 8 | loss: 0.8530198
	speed: 0.0075s/iter; left time: 0.1121s
Updating learning rate to 2.05778985e-06
Epoch: 8 cost time: 4.003673553466797
Epoch: 8, Steps: 514 | Train Loss: 0.7363186 Vali Loss: 0.3713397 Best vali loss: 0.3656609

best validation loss 0.3656608689276315

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0003874306649, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6241336
	speed: 0.0102s/iter; left time: 19.9482s
	iters: 200, epoch: 1 | loss: 0.8394744
	speed: 0.0036s/iter; left time: 6.7714s
Updating learning rate to 0.00037268496323417447
Validation loss decreased (inf --> 0.3763).  Saving model state dict ...
Epoch: 1 cost time: 1.2873680591583252
Epoch: 1, Steps: 257 | Train Loss: 0.7318040 Vali Loss: 0.3763418 Best vali loss: 0.3763418
	iters: 100, epoch: 2 | loss: 0.5980344
	speed: 0.0086s/iter; left time: 14.6148s
	iters: 200, epoch: 2 | loss: 0.4477312
	speed: 0.0043s/iter; left time: 6.9473s
Updating learning rate to 0.00033069275764520146
Validation loss decreased (0.3763 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 1.3050196170806885
Epoch: 2, Steps: 257 | Train Loss: 0.5228828 Vali Loss: 0.3673004 Best vali loss: 0.3673004
	iters: 100, epoch: 3 | loss: 0.6168780
	speed: 0.0179s/iter; left time: 25.7918s
	iters: 200, epoch: 3 | loss: 0.8621215
	speed: 0.0059s/iter; left time: 7.9883s
Updating learning rate to 0.0002678469807737105
Validation loss decreased (0.3673 --> 0.3657).  Saving model state dict ...
Epoch: 3 cost time: 1.7246780395507812
Epoch: 3, Steps: 257 | Train Loss: 0.7394997 Vali Loss: 0.3656829 Best vali loss: 0.3656829

best validation loss 0.3656828718827141

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010380139511, 'e_layers': 3, 'learning_rate': 0.0006489795465, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3999046
	speed: 0.0159s/iter; left time: 63.9787s
	iters: 200, epoch: 1 | loss: 0.5129442
	speed: 0.0085s/iter; left time: 33.4410s
	iters: 300, epoch: 1 | loss: 0.2644008
	speed: 0.0071s/iter; left time: 26.9153s
	iters: 400, epoch: 1 | loss: 0.4890208
	speed: 0.0107s/iter; left time: 39.5637s
	iters: 500, epoch: 1 | loss: 0.7152281
	speed: 0.0107s/iter; left time: 38.5829s
Updating learning rate to 0.0006242792332649034
Validation loss decreased (inf --> 0.3971).  Saving model state dict ...
Epoch: 1 cost time: 5.112600803375244
Epoch: 1, Steps: 514 | Train Loss: 0.4762997 Vali Loss: 0.3970519 Best vali loss: 0.3970519
	iters: 100, epoch: 2 | loss: 0.3719933
	speed: 0.0221s/iter; left time: 77.1980s
	iters: 200, epoch: 2 | loss: 0.6269841
	speed: 0.0104s/iter; left time: 35.2954s
	iters: 300, epoch: 2 | loss: 1.2350056
	speed: 0.0100s/iter; left time: 32.9950s
	iters: 400, epoch: 2 | loss: 0.8011647
	speed: 0.0107s/iter; left time: 34.1595s
	iters: 500, epoch: 2 | loss: 0.6549021
	speed: 0.0106s/iter; left time: 32.8142s
Updating learning rate to 0.0005539386923407602
Epoch: 2 cost time: 5.383551836013794
Epoch: 2, Steps: 514 | Train Loss: 0.7380100 Vali Loss: 0.3998072 Best vali loss: 0.3970519
	iters: 100, epoch: 3 | loss: 0.4421370
	speed: 0.0218s/iter; left time: 65.1202s
	iters: 200, epoch: 3 | loss: 0.8092697
	speed: 0.0100s/iter; left time: 28.7520s
	iters: 300, epoch: 3 | loss: 0.6121739
	speed: 0.0097s/iter; left time: 27.1293s
	iters: 400, epoch: 3 | loss: 0.5801583
	speed: 0.0107s/iter; left time: 28.7954s
	iters: 500, epoch: 3 | loss: 0.2572649
	speed: 0.0105s/iter; left time: 27.1989s
Updating learning rate to 0.00044866663344467976
Epoch: 3 cost time: 5.3009560108184814
Epoch: 3, Steps: 514 | Train Loss: 0.5402007 Vali Loss: 0.3982153 Best vali loss: 0.3970519

best validation loss 0.39705185938209353

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020081810667, 'e_layers': 3, 'learning_rate': 9.68867655e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3690376
	speed: 0.0166s/iter; left time: 66.7617s
	iters: 200, epoch: 1 | loss: 0.4187206
	speed: 0.0056s/iter; left time: 21.8192s
	iters: 300, epoch: 1 | loss: 0.9515462
	speed: 0.0068s/iter; left time: 26.0580s
	iters: 400, epoch: 1 | loss: 0.6551713
	speed: 0.0094s/iter; left time: 34.9817s
	iters: 500, epoch: 1 | loss: 0.5776664
	speed: 0.0095s/iter; left time: 34.3972s
Updating learning rate to 9.68867655e-05
Validation loss decreased (inf --> 0.3717).  Saving model state dict ...
Epoch: 1 cost time: 4.6343653202056885
Epoch: 1, Steps: 514 | Train Loss: 0.5944284 Vali Loss: 0.3717167 Best vali loss: 0.3717167
	iters: 100, epoch: 2 | loss: 0.8319515
	speed: 0.0180s/iter; left time: 62.9482s
	iters: 200, epoch: 2 | loss: 0.3249316
	speed: 0.0089s/iter; left time: 30.1294s
	iters: 300, epoch: 2 | loss: 0.8443459
	speed: 0.0097s/iter; left time: 31.9238s
	iters: 400, epoch: 2 | loss: 0.5502375
	speed: 0.0086s/iter; left time: 27.6342s
	iters: 500, epoch: 2 | loss: 0.6957338
	speed: 0.0098s/iter; left time: 30.2283s
Updating learning rate to 4.844338275e-05
Validation loss decreased (0.3717 --> 0.3646).  Saving model state dict ...
Epoch: 2 cost time: 4.768757581710815
Epoch: 2, Steps: 514 | Train Loss: 0.6494401 Vali Loss: 0.3645784 Best vali loss: 0.3645784
	iters: 100, epoch: 3 | loss: 0.5633086
	speed: 0.0227s/iter; left time: 67.8949s
	iters: 200, epoch: 3 | loss: 0.3820355
	speed: 0.0109s/iter; left time: 31.3950s
	iters: 300, epoch: 3 | loss: 1.0086683
	speed: 0.0102s/iter; left time: 28.5213s
	iters: 400, epoch: 3 | loss: 0.3685964
	speed: 0.0108s/iter; left time: 28.9378s
	iters: 500, epoch: 3 | loss: 0.8744228
	speed: 0.0103s/iter; left time: 26.6762s
Updating learning rate to 2.4221691375e-05
Validation loss decreased (0.3646 --> 0.3629).  Saving model state dict ...
Epoch: 3 cost time: 5.470620155334473
Epoch: 3, Steps: 514 | Train Loss: 0.6394063 Vali Loss: 0.3628814 Best vali loss: 0.3628814

best validation loss 0.3628814300174563

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020081810667, 'e_layers': 3, 'learning_rate': 9.68867655e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3157234
	speed: 0.0181s/iter; left time: 44.7019s
	iters: 200, epoch: 4 | loss: 0.3689367
	speed: 0.0094s/iter; left time: 22.2850s
	iters: 300, epoch: 4 | loss: 0.9193650
	speed: 0.0101s/iter; left time: 23.0215s
	iters: 400, epoch: 4 | loss: 0.5914826
	speed: 0.0104s/iter; left time: 22.6529s
	iters: 500, epoch: 4 | loss: 0.5750166
	speed: 0.0100s/iter; left time: 20.6636s
Updating learning rate to 1.21108456875e-05
Epoch: 4 cost time: 5.5661585330963135
Epoch: 4, Steps: 514 | Train Loss: 0.5541049 Vali Loss: 0.3651064 Best vali loss: 0.3628814
	iters: 100, epoch: 5 | loss: 0.8191551
	speed: 0.0230s/iter; left time: 45.0828s
	iters: 200, epoch: 5 | loss: 0.3173720
	speed: 0.0119s/iter; left time: 22.0832s
	iters: 300, epoch: 5 | loss: 0.8480165
	speed: 0.0117s/iter; left time: 20.4999s
	iters: 400, epoch: 5 | loss: 0.5256740
	speed: 0.0131s/iter; left time: 21.6282s
	iters: 500, epoch: 5 | loss: 0.6965225
	speed: 0.0131s/iter; left time: 20.3830s
Updating learning rate to 6.05542284375e-06
Epoch: 5 cost time: 6.361216068267822
Epoch: 5, Steps: 514 | Train Loss: 0.6413480 Vali Loss: 0.3641392 Best vali loss: 0.3628814
	iters: 100, epoch: 6 | loss: 0.5609046
	speed: 0.0362s/iter; left time: 52.2699s
	iters: 200, epoch: 6 | loss: 0.3874494
	speed: 0.0093s/iter; left time: 12.4584s
	iters: 300, epoch: 6 | loss: 0.8089718
	speed: 0.0087s/iter; left time: 10.8682s
	iters: 400, epoch: 6 | loss: 0.3695484
	speed: 0.0093s/iter; left time: 10.6244s
	iters: 500, epoch: 6 | loss: 0.8708664
	speed: 0.0103s/iter; left time: 10.7428s
Updating learning rate to 3.027711421875e-06
Epoch: 6 cost time: 5.068349361419678
Epoch: 6, Steps: 514 | Train Loss: 0.5995481 Vali Loss: 0.3641010 Best vali loss: 0.3628814
	iters: 100, epoch: 7 | loss: 1.0072913
	speed: 0.0190s/iter; left time: 17.6051s
	iters: 200, epoch: 7 | loss: 0.4549186
	speed: 0.0096s/iter; left time: 7.9242s
	iters: 300, epoch: 7 | loss: 1.0787843
	speed: 0.0113s/iter; left time: 8.2039s
	iters: 400, epoch: 7 | loss: 0.2276205
	speed: 0.0118s/iter; left time: 7.4290s
	iters: 500, epoch: 7 | loss: 0.5577084
	speed: 0.0108s/iter; left time: 5.7260s
Updating learning rate to 1.5138557109375e-06
Epoch: 7 cost time: 5.361719846725464
Epoch: 7, Steps: 514 | Train Loss: 0.6652646 Vali Loss: 0.3639905 Best vali loss: 0.3628814
	iters: 100, epoch: 8 | loss: 0.6816418
	speed: 0.0217s/iter; left time: 9.0022s
	iters: 200, epoch: 8 | loss: 0.4084787
	speed: 0.0109s/iter; left time: 3.4300s
	iters: 300, epoch: 8 | loss: 0.6773719
	speed: 0.0110s/iter; left time: 2.3592s
	iters: 400, epoch: 8 | loss: 0.4977077
	speed: 0.0109s/iter; left time: 1.2555s
	iters: 500, epoch: 8 | loss: 1.1085490
	speed: 0.0104s/iter; left time: 0.1564s
Updating learning rate to 7.5692785546875e-07
Epoch: 8 cost time: 5.613917589187622
Epoch: 8, Steps: 514 | Train Loss: 0.6747498 Vali Loss: 0.3640838 Best vali loss: 0.3628814

best validation loss 0.3628814300174563

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009624923866, 'e_layers': 3, 'learning_rate': 0.0001266733621, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3888912
	speed: 0.0175s/iter; left time: 70.3609s
	iters: 200, epoch: 1 | loss: 0.4791107
	speed: 0.0094s/iter; left time: 36.9344s
	iters: 300, epoch: 1 | loss: 0.7304789
	speed: 0.0107s/iter; left time: 40.9010s
	iters: 400, epoch: 1 | loss: 0.2941099
	speed: 0.0106s/iter; left time: 39.2654s
	iters: 500, epoch: 1 | loss: 0.4189633
	speed: 0.0105s/iter; left time: 37.8971s
Updating learning rate to 0.00012185214432929046
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 5.722061634063721
Epoch: 1, Steps: 514 | Train Loss: 0.4623108 Vali Loss: 0.3716128 Best vali loss: 0.3716128
	iters: 100, epoch: 2 | loss: 0.5714543
	speed: 0.0198s/iter; left time: 69.1559s
	iters: 200, epoch: 2 | loss: 0.9799588
	speed: 0.0079s/iter; left time: 26.8840s
	iters: 300, epoch: 2 | loss: 0.4225523
	speed: 0.0084s/iter; left time: 27.7972s
	iters: 400, epoch: 2 | loss: 0.5595790
	speed: 0.0085s/iter; left time: 27.2892s
	iters: 500, epoch: 2 | loss: 0.3687333
	speed: 0.0084s/iter; left time: 25.9996s
Updating learning rate to 0.0001081224777183045
Validation loss decreased (0.3716 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 4.382711887359619
Epoch: 2, Steps: 514 | Train Loss: 0.5804556 Vali Loss: 0.3663382 Best vali loss: 0.3663382
	iters: 100, epoch: 3 | loss: 0.6666005
	speed: 0.0176s/iter; left time: 52.4439s
	iters: 200, epoch: 3 | loss: 0.8485113
	speed: 0.0088s/iter; left time: 25.5117s
	iters: 300, epoch: 3 | loss: 1.0054896
	speed: 0.0084s/iter; left time: 23.2635s
	iters: 400, epoch: 3 | loss: 0.3169479
	speed: 0.0093s/iter; left time: 25.0221s
	iters: 500, epoch: 3 | loss: 0.3137525
	speed: 0.0097s/iter; left time: 25.1524s
Updating learning rate to 8.757457954882694e-05
Validation loss decreased (0.3663 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 4.638532638549805
Epoch: 3, Steps: 514 | Train Loss: 0.6302604 Vali Loss: 0.3609376 Best vali loss: 0.3609376
	iters: 100, epoch: 4 | loss: 0.4349875
	speed: 0.0210s/iter; left time: 51.7696s
	iters: 200, epoch: 4 | loss: 0.3341611
	speed: 0.0101s/iter; left time: 23.8914s
	iters: 300, epoch: 4 | loss: 0.2630226
	speed: 0.0097s/iter; left time: 22.0414s
	iters: 400, epoch: 4 | loss: 0.5437716
	speed: 0.0092s/iter; left time: 19.9709s
	iters: 500, epoch: 4 | loss: 0.8830143
	speed: 0.0093s/iter; left time: 19.3032s
Updating learning rate to 6.333668105e-05
Epoch: 4 cost time: 4.924562454223633
Epoch: 4, Steps: 514 | Train Loss: 0.4917914 Vali Loss: 0.3620304 Best vali loss: 0.3609376
	iters: 100, epoch: 5 | loss: 0.5100131
	speed: 0.0199s/iter; left time: 38.8632s
	iters: 200, epoch: 5 | loss: 0.7036889
	speed: 0.0104s/iter; left time: 19.2404s
	iters: 300, epoch: 5 | loss: 0.5683977
	speed: 0.0094s/iter; left time: 16.4602s
	iters: 400, epoch: 5 | loss: 0.3499200
	speed: 0.0090s/iter; left time: 14.9149s
	iters: 500, epoch: 5 | loss: 0.8671718
	speed: 0.0098s/iter; left time: 15.2127s
Updating learning rate to 3.909878255117306e-05
Validation loss decreased (0.3609 --> 0.3608).  Saving model state dict ...
Epoch: 5 cost time: 4.958459138870239
Epoch: 5, Steps: 514 | Train Loss: 0.5998383 Vali Loss: 0.3607664 Best vali loss: 0.3607664
	iters: 100, epoch: 6 | loss: 1.0886997
	speed: 0.0190s/iter; left time: 27.3744s
	iters: 200, epoch: 6 | loss: 0.3517947
	speed: 0.0074s/iter; left time: 9.9899s
	iters: 300, epoch: 6 | loss: 0.6359723
	speed: 0.0079s/iter; left time: 9.7892s
	iters: 400, epoch: 6 | loss: 0.4369403
	speed: 0.0102s/iter; left time: 11.6531s
	iters: 500, epoch: 6 | loss: 0.7746298
	speed: 0.0096s/iter; left time: 9.9824s
Updating learning rate to 1.85508843816955e-05
Validation loss decreased (0.3608 --> 0.3605).  Saving model state dict ...
Epoch: 6 cost time: 4.508465051651001
Epoch: 6, Steps: 514 | Train Loss: 0.6576074 Vali Loss: 0.3604707 Best vali loss: 0.3604707
	iters: 100, epoch: 7 | loss: 1.0278428
	speed: 0.0220s/iter; left time: 20.4672s
	iters: 200, epoch: 7 | loss: 0.3133685
	speed: 0.0105s/iter; left time: 8.7355s
	iters: 300, epoch: 7 | loss: 0.4876734
	speed: 0.0096s/iter; left time: 7.0206s
	iters: 400, epoch: 7 | loss: 0.4174861
	speed: 0.0091s/iter; left time: 5.7112s
	iters: 500, epoch: 7 | loss: 0.3666449
	speed: 0.0107s/iter; left time: 5.6815s
Updating learning rate to 4.821217770709526e-06
Epoch: 7 cost time: 5.2511842250823975
Epoch: 7, Steps: 514 | Train Loss: 0.5226031 Vali Loss: 0.3620709 Best vali loss: 0.3604707
	iters: 100, epoch: 8 | loss: 0.5229746
	speed: 0.0256s/iter; left time: 10.6086s
	iters: 200, epoch: 8 | loss: 0.3555791
	speed: 0.0111s/iter; left time: 3.4905s
	iters: 300, epoch: 8 | loss: 0.5471725
	speed: 0.0095s/iter; left time: 2.0476s
	iters: 400, epoch: 8 | loss: 0.4068072
	speed: 0.0093s/iter; left time: 1.0685s
	iters: 500, epoch: 8 | loss: 0.7476342
	speed: 0.0097s/iter; left time: 0.1454s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.349348306655884
Epoch: 8, Steps: 514 | Train Loss: 0.5160335 Vali Loss: 0.3623228 Best vali loss: 0.3604707

best validation loss 0.36047074112067756

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.003058511047, 'e_layers': 2, 'learning_rate': 0.0003064791207, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8282441
	speed: 0.0166s/iter; left time: 66.6928s
	iters: 200, epoch: 1 | loss: 0.7360260
	speed: 0.0093s/iter; left time: 36.2120s
	iters: 300, epoch: 1 | loss: 0.8309348
	speed: 0.0095s/iter; left time: 36.3244s
	iters: 400, epoch: 1 | loss: 0.6900561
	speed: 0.0099s/iter; left time: 36.8712s
	iters: 500, epoch: 1 | loss: 0.3330668
	speed: 0.0097s/iter; left time: 34.9214s
Updating learning rate to 0.0003064791207
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 5.323298692703247
Epoch: 1, Steps: 514 | Train Loss: 0.6836656 Vali Loss: 0.3681360 Best vali loss: 0.3681360
	iters: 100, epoch: 2 | loss: 0.3234403
	speed: 0.0213s/iter; left time: 74.4089s
	iters: 200, epoch: 2 | loss: 0.3775921
	speed: 0.0097s/iter; left time: 32.9820s
	iters: 300, epoch: 2 | loss: 0.6365375
	speed: 0.0096s/iter; left time: 31.6764s
	iters: 400, epoch: 2 | loss: 0.6489446
	speed: 0.0101s/iter; left time: 32.3001s
	iters: 500, epoch: 2 | loss: 0.5444384
	speed: 0.0093s/iter; left time: 28.7406s
Updating learning rate to 0.00015323956035
Validation loss decreased (0.3681 --> 0.3658).  Saving model state dict ...
Epoch: 2 cost time: 5.0100257396698
Epoch: 2, Steps: 514 | Train Loss: 0.5061906 Vali Loss: 0.3657670 Best vali loss: 0.3657670
	iters: 100, epoch: 3 | loss: 0.4327321
	speed: 0.0199s/iter; left time: 59.4455s
	iters: 200, epoch: 3 | loss: 0.5702878
	speed: 0.0092s/iter; left time: 26.4588s
	iters: 300, epoch: 3 | loss: 0.5647035
	speed: 0.0095s/iter; left time: 26.5670s
	iters: 400, epoch: 3 | loss: 0.2485585
	speed: 0.0103s/iter; left time: 27.7485s
	iters: 500, epoch: 3 | loss: 0.6496605
	speed: 0.0094s/iter; left time: 24.3601s
Updating learning rate to 7.6619780175e-05
Validation loss decreased (0.3658 --> 0.3602).  Saving model state dict ...
Epoch: 3 cost time: 4.907408714294434
Epoch: 3, Steps: 514 | Train Loss: 0.4931885 Vali Loss: 0.3602063 Best vali loss: 0.3602063
	iters: 100, epoch: 4 | loss: 0.2153762
	speed: 0.0230s/iter; left time: 56.8742s
	iters: 200, epoch: 4 | loss: 0.4300408
	speed: 0.0096s/iter; left time: 22.8501s
	iters: 300, epoch: 4 | loss: 0.5638160
	speed: 0.0090s/iter; left time: 20.5243s
	iters: 400, epoch: 4 | loss: 0.5457485
	speed: 0.0097s/iter; left time: 21.0749s
	iters: 500, epoch: 4 | loss: 0.3236112
	speed: 0.0096s/iter; left time: 19.9300s
Updating learning rate to 3.83098900875e-05
Validation loss decreased (0.3602 --> 0.3491).  Saving model state dict ...
Epoch: 4 cost time: 4.96779203414917
Epoch: 4, Steps: 514 | Train Loss: 0.4157185 Vali Loss: 0.3490927 Best vali loss: 0.3490927
	iters: 100, epoch: 5 | loss: 0.3510580
	speed: 0.0224s/iter; left time: 43.7911s
	iters: 200, epoch: 5 | loss: 0.5563074
	speed: 0.0095s/iter; left time: 17.7161s
	iters: 300, epoch: 5 | loss: 0.5544910
	speed: 0.0094s/iter; left time: 16.4407s
	iters: 400, epoch: 5 | loss: 0.7342328
	speed: 0.0079s/iter; left time: 13.0963s
	iters: 500, epoch: 5 | loss: 0.7066571
	speed: 0.0052s/iter; left time: 8.1028s
Updating learning rate to 1.915494504375e-05
Epoch: 5 cost time: 4.274879693984985
Epoch: 5, Steps: 514 | Train Loss: 0.5805493 Vali Loss: 0.3502979 Best vali loss: 0.3490927
	iters: 100, epoch: 6 | loss: 0.5096250
	speed: 0.0240s/iter; left time: 34.5777s
	iters: 200, epoch: 6 | loss: 0.3125444
	speed: 0.0127s/iter; left time: 17.0231s
	iters: 300, epoch: 6 | loss: 0.7442928
	speed: 0.0111s/iter; left time: 13.8275s
	iters: 400, epoch: 6 | loss: 0.3632456
	speed: 0.0119s/iter; left time: 13.6396s
	iters: 500, epoch: 6 | loss: 0.4516613
	speed: 0.0077s/iter; left time: 8.0063s
Updating learning rate to 9.577472521875e-06
Epoch: 6 cost time: 5.653215169906616
Epoch: 6, Steps: 514 | Train Loss: 0.4762738 Vali Loss: 0.3523570 Best vali loss: 0.3490927
	iters: 100, epoch: 7 | loss: 0.6218332
	speed: 0.0225s/iter; left time: 20.8622s
	iters: 200, epoch: 7 | loss: 0.6920654
	speed: 0.0088s/iter; left time: 7.3288s
	iters: 300, epoch: 7 | loss: 0.7420638
	speed: 0.0092s/iter; left time: 6.7305s
	iters: 400, epoch: 7 | loss: 0.5905304
	speed: 0.0100s/iter; left time: 6.2590s
	iters: 500, epoch: 7 | loss: 0.2901575
	speed: 0.0099s/iter; left time: 5.2443s
Updating learning rate to 4.7887362609375e-06
Epoch: 7 cost time: 4.937118053436279
Epoch: 7, Steps: 514 | Train Loss: 0.5873300 Vali Loss: 0.3494919 Best vali loss: 0.3490927
	iters: 100, epoch: 8 | loss: 0.2643516
	speed: 0.0203s/iter; left time: 8.4417s
	iters: 200, epoch: 8 | loss: 0.3183841
	speed: 0.0081s/iter; left time: 2.5590s
	iters: 300, epoch: 8 | loss: 0.5251928
	speed: 0.0075s/iter; left time: 1.6127s
	iters: 400, epoch: 8 | loss: 0.4439553
	speed: 0.0083s/iter; left time: 0.9566s
	iters: 500, epoch: 8 | loss: 0.6050640
	speed: 0.0082s/iter; left time: 0.1231s
Updating learning rate to 2.39436813046875e-06
Epoch: 8 cost time: 4.248336553573608
Epoch: 8, Steps: 514 | Train Loss: 0.4313896 Vali Loss: 0.3501750 Best vali loss: 0.3490927

best validation loss 0.34909271691543414

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0049649181558, 'e_layers': 4, 'learning_rate': 0.0002370731574, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002370731574
Validation loss decreased (inf --> 0.3652).  Saving model state dict ...
Epoch: 1 cost time: 1.558201551437378
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3651698 Best vali loss: 0.3651698
Updating learning rate to 0.0001185365787
Epoch: 2 cost time: 1.2064216136932373
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3785870 Best vali loss: 0.3651698
Updating learning rate to 5.926828935e-05
Validation loss decreased (0.3652 --> 0.3621).  Saving model state dict ...
Epoch: 3 cost time: 1.8037819862365723
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3620901 Best vali loss: 0.3620901

best validation loss 0.36209006366888996

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0017158468584, 'e_layers': 1, 'learning_rate': 0.0001815841717, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9233575
	speed: 0.0131s/iter; left time: 52.4868s
	iters: 200, epoch: 1 | loss: 0.5908437
	speed: 0.0101s/iter; left time: 39.6668s
	iters: 300, epoch: 1 | loss: 0.6322851
	speed: 0.0104s/iter; left time: 39.7612s
	iters: 400, epoch: 1 | loss: 0.8130015
	speed: 0.0106s/iter; left time: 39.3040s
	iters: 500, epoch: 1 | loss: 0.4092954
	speed: 0.0072s/iter; left time: 26.1487s
Updating learning rate to 0.0001815841717
Validation loss decreased (inf --> 0.3862).  Saving model state dict ...
Epoch: 1 cost time: 4.864318370819092
Epoch: 1, Steps: 514 | Train Loss: 0.6737566 Vali Loss: 0.3862218 Best vali loss: 0.3862218
	iters: 100, epoch: 2 | loss: 0.4083990
	speed: 0.0350s/iter; left time: 122.3917s
	iters: 200, epoch: 2 | loss: 0.8856238
	speed: 0.0104s/iter; left time: 35.4222s
	iters: 300, epoch: 2 | loss: 0.6643727
	speed: 0.0082s/iter; left time: 27.0341s
	iters: 400, epoch: 2 | loss: 0.3109716
	speed: 0.0087s/iter; left time: 27.6881s
	iters: 500, epoch: 2 | loss: 0.3936893
	speed: 0.0091s/iter; left time: 28.0788s
Updating learning rate to 9.079208585e-05
Validation loss decreased (0.3862 --> 0.3709).  Saving model state dict ...
Epoch: 2 cost time: 4.809372186660767
Epoch: 2, Steps: 514 | Train Loss: 0.5326113 Vali Loss: 0.3709441 Best vali loss: 0.3709441
	iters: 100, epoch: 3 | loss: 0.9597506
	speed: 0.0270s/iter; left time: 80.4623s
	iters: 200, epoch: 3 | loss: 0.5115359
	speed: 0.0096s/iter; left time: 27.6362s
	iters: 300, epoch: 3 | loss: 0.2907706
	speed: 0.0071s/iter; left time: 19.8500s
	iters: 400, epoch: 3 | loss: 0.7058190
	speed: 0.0057s/iter; left time: 15.3269s
	iters: 500, epoch: 3 | loss: 0.3467492
	speed: 0.0054s/iter; left time: 14.0121s
Updating learning rate to 4.5396042925e-05
Validation loss decreased (0.3709 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 3.8389930725097656
Epoch: 3, Steps: 514 | Train Loss: 0.5629251 Vali Loss: 0.3677073 Best vali loss: 0.3677073

best validation loss 0.3677072731825598

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0049912964393, 'e_layers': 1, 'learning_rate': 0.0001181631268, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6675243
	speed: 0.0227s/iter; left time: 21.2190s
Updating learning rate to 0.0001181631268
Validation loss decreased (inf --> 0.4230).  Saving model state dict ...
Epoch: 1 cost time: 2.515366554260254
Epoch: 1, Steps: 129 | Train Loss: 0.6675243 Vali Loss: 0.4229567 Best vali loss: 0.4229567
	iters: 100, epoch: 2 | loss: 0.8250538
	speed: 0.0293s/iter; left time: 23.5184s
Updating learning rate to 5.90815634e-05
Validation loss decreased (0.4230 --> 0.4057).  Saving model state dict ...
Epoch: 2 cost time: 2.140207529067993
Epoch: 2, Steps: 129 | Train Loss: 0.8250538 Vali Loss: 0.4057145 Best vali loss: 0.4057145
	iters: 100, epoch: 3 | loss: 0.5978929
	speed: 0.0282s/iter; left time: 19.0629s
Updating learning rate to 2.95407817e-05
Validation loss decreased (0.4057 --> 0.3992).  Saving model state dict ...
Epoch: 3 cost time: 2.171611785888672
Epoch: 3, Steps: 129 | Train Loss: 0.5978929 Vali Loss: 0.3991647 Best vali loss: 0.3991647

best validation loss 0.3991646977445231

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0049649181558, 'e_layers': 4, 'learning_rate': 0.0002370731574, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.9634144675e-05
Validation loss decreased (0.3621 --> 0.3586).  Saving model state dict ...
Epoch: 4 cost time: 2.195786714553833
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3586435 Best vali loss: 0.3586435
Updating learning rate to 1.48170723375e-05
Validation loss decreased (0.3586 --> 0.3582).  Saving model state dict ...
Epoch: 5 cost time: 1.3340775966644287
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3581585 Best vali loss: 0.3581585
Updating learning rate to 7.40853616875e-06
Epoch: 6 cost time: 1.588176965713501
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3597539 Best vali loss: 0.3581585
Updating learning rate to 3.704268084375e-06
Epoch: 7 cost time: 1.7272393703460693
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3597224 Best vali loss: 0.3581585
Updating learning rate to 1.8521340421875e-06
Epoch: 8 cost time: 1.4777553081512451
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3596148 Best vali loss: 0.3581585

best validation loss 0.3581584981007754

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009181308581, 'e_layers': 2, 'learning_rate': 0.0006089978534, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6382523
	speed: 0.0158s/iter; left time: 63.3520s
	iters: 200, epoch: 1 | loss: 0.6903335
	speed: 0.0110s/iter; left time: 43.1827s
	iters: 300, epoch: 1 | loss: 0.7720023
	speed: 0.0099s/iter; left time: 37.9167s
	iters: 400, epoch: 1 | loss: 0.8335841
	speed: 0.0112s/iter; left time: 41.4001s
	iters: 500, epoch: 1 | loss: 0.7116494
	speed: 0.0096s/iter; left time: 34.5050s
Updating learning rate to 0.0005858192527497845
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 5.573843717575073
Epoch: 1, Steps: 514 | Train Loss: 0.7291643 Vali Loss: 0.3676858 Best vali loss: 0.3676858
	iters: 100, epoch: 2 | loss: 0.7434738
	speed: 0.0433s/iter; left time: 151.6454s
	iters: 200, epoch: 2 | loss: 0.4682969
	speed: 0.0127s/iter; left time: 43.2757s
	iters: 300, epoch: 2 | loss: 0.4465147
	speed: 0.0138s/iter; left time: 45.5293s
	iters: 400, epoch: 2 | loss: 0.6147419
	speed: 0.0146s/iter; left time: 46.5960s
	iters: 500, epoch: 2 | loss: 0.1950830
	speed: 0.0129s/iter; left time: 39.8660s
Updating learning rate to 0.0005198121826335955
Epoch: 2 cost time: 6.916468620300293
Epoch: 2, Steps: 514 | Train Loss: 0.4936221 Vali Loss: 0.3682806 Best vali loss: 0.3676858
	iters: 100, epoch: 3 | loss: 0.8385625
	speed: 0.0615s/iter; left time: 183.5782s
	iters: 200, epoch: 3 | loss: 0.4260684
	speed: 0.0135s/iter; left time: 39.0300s
	iters: 300, epoch: 3 | loss: 0.2554122
	speed: 0.0153s/iter; left time: 42.6429s
	iters: 400, epoch: 3 | loss: 0.7472567
	speed: 0.0098s/iter; left time: 26.2543s
	iters: 500, epoch: 3 | loss: 0.2946680
	speed: 0.0101s/iter; left time: 26.0818s
Updating learning rate to 0.00042102562112104186
Epoch: 3 cost time: 6.357964992523193
Epoch: 3, Steps: 514 | Train Loss: 0.5123935 Vali Loss: 0.3738523 Best vali loss: 0.3676858
	iters: 100, epoch: 4 | loss: 0.8461742
	speed: 0.0314s/iter; left time: 77.5904s
	iters: 200, epoch: 4 | loss: 1.3367617
	speed: 0.0092s/iter; left time: 21.7363s
	iters: 300, epoch: 4 | loss: 0.5060124
	speed: 0.0075s/iter; left time: 17.0473s
	iters: 400, epoch: 4 | loss: 0.8472258
	speed: 0.0050s/iter; left time: 10.9188s
	iters: 500, epoch: 4 | loss: 0.3786939
	speed: 0.0082s/iter; left time: 16.8830s
Updating learning rate to 0.0003044989267
Epoch: 4 cost time: 4.073129892349243
Epoch: 4, Steps: 514 | Train Loss: 0.7829736 Vali Loss: 0.3754576 Best vali loss: 0.3676858
	iters: 100, epoch: 5 | loss: 0.6591344
	speed: 0.0327s/iter; left time: 64.0184s
	iters: 200, epoch: 5 | loss: 0.4262810
	speed: 0.0094s/iter; left time: 17.5268s
	iters: 300, epoch: 5 | loss: 1.0642502
	speed: 0.0094s/iter; left time: 16.5985s
	iters: 400, epoch: 5 | loss: 1.0195388
	speed: 0.0111s/iter; left time: 18.3761s
	iters: 500, epoch: 5 | loss: 0.4732813
	speed: 0.0105s/iter; left time: 16.3213s
Updating learning rate to 0.00018797223227895812
Epoch: 5 cost time: 5.118546009063721
Epoch: 5, Steps: 514 | Train Loss: 0.7284971 Vali Loss: 0.3702660 Best vali loss: 0.3676858
	iters: 100, epoch: 6 | loss: 0.4188284
	speed: 0.0319s/iter; left time: 46.0694s
	iters: 200, epoch: 6 | loss: 0.4174092
	speed: 0.0095s/iter; left time: 12.8121s
	iters: 300, epoch: 6 | loss: 0.5198308
	speed: 0.0088s/iter; left time: 10.8767s
	iters: 400, epoch: 6 | loss: 0.6429304
	speed: 0.0101s/iter; left time: 11.6010s
	iters: 500, epoch: 6 | loss: 0.3690788
	speed: 0.0076s/iter; left time: 7.9201s
Updating learning rate to 8.918567076640455e-05
Epoch: 6 cost time: 4.72497820854187
Epoch: 6, Steps: 514 | Train Loss: 0.4736155 Vali Loss: 0.3754056 Best vali loss: 0.3676858
	iters: 100, epoch: 7 | loss: 0.4102848
	speed: 0.0178s/iter; left time: 16.5331s
	iters: 200, epoch: 7 | loss: 0.5185742
	speed: 0.0077s/iter; left time: 6.3982s
	iters: 300, epoch: 7 | loss: 0.9342090
	speed: 0.0083s/iter; left time: 6.0214s
	iters: 400, epoch: 7 | loss: 0.8306347
	speed: 0.0079s/iter; left time: 4.9634s
	iters: 500, epoch: 7 | loss: 0.2618751
	speed: 0.0078s/iter; left time: 4.1187s
Updating learning rate to 2.3178600650215432e-05
Epoch: 7 cost time: 4.1364219188690186
Epoch: 7, Steps: 514 | Train Loss: 0.5911156 Vali Loss: 0.3792976 Best vali loss: 0.3676858
	iters: 100, epoch: 8 | loss: 0.4012723
	speed: 0.0117s/iter; left time: 4.8734s
	iters: 200, epoch: 8 | loss: 0.5275213
	speed: 0.0050s/iter; left time: 1.5899s
	iters: 300, epoch: 8 | loss: 0.3302425
	speed: 0.0061s/iter; left time: 1.3208s
	iters: 400, epoch: 8 | loss: 0.5588324
	speed: 0.0078s/iter; left time: 0.8975s
	iters: 500, epoch: 8 | loss: 0.5864888
	speed: 0.0073s/iter; left time: 0.1092s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.292588233947754
Epoch: 8, Steps: 514 | Train Loss: 0.4808715 Vali Loss: 0.3741005 Best vali loss: 0.3676858

best validation loss 0.36768584702244445

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0114792280081, 'e_layers': 4, 'learning_rate': 0.0045159486331, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7523962
	speed: 0.0165s/iter; left time: 15.3523s
Updating learning rate to 0.0043440705725467064
Validation loss decreased (inf --> 0.3816).  Saving model state dict ...
Epoch: 1 cost time: 1.6754181385040283
Epoch: 1, Steps: 129 | Train Loss: 0.7523962 Vali Loss: 0.3815604 Best vali loss: 0.3815604
	iters: 100, epoch: 2 | loss: 0.8589234
	speed: 0.0180s/iter; left time: 14.5073s
Updating learning rate to 0.003854603267527565
Validation loss decreased (0.3816 --> 0.3746).  Saving model state dict ...
Epoch: 2 cost time: 1.5485491752624512
Epoch: 2, Steps: 129 | Train Loss: 0.8589234 Vali Loss: 0.3745519 Best vali loss: 0.3745519
	iters: 100, epoch: 3 | loss: 0.5864497
	speed: 0.0168s/iter; left time: 11.3336s
Updating learning rate to 0.003122063678199572
Epoch: 3 cost time: 1.39680814743042
Epoch: 3, Steps: 129 | Train Loss: 0.5864497 Vali Loss: 0.4068827 Best vali loss: 0.3745519
	iters: 100, epoch: 4 | loss: 0.7731370
	speed: 0.0175s/iter; left time: 9.5308s
Updating learning rate to 0.00225797431655
Validation loss decreased (0.3746 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 1.388059377670288
Epoch: 4, Steps: 129 | Train Loss: 0.7731370 Vali Loss: 0.3677868 Best vali loss: 0.3677868
	iters: 100, epoch: 5 | loss: 0.5431118
	speed: 0.0209s/iter; left time: 8.7160s
Updating learning rate to 0.0013938849549004284
Epoch: 5 cost time: 1.9686684608459473
Epoch: 5, Steps: 129 | Train Loss: 0.5431118 Vali Loss: 0.3817914 Best vali loss: 0.3677868
	iters: 100, epoch: 6 | loss: 0.4672860
	speed: 0.0290s/iter; left time: 8.3507s
Updating learning rate to 0.0006613453655724351
Epoch: 6 cost time: 1.786226511001587
Epoch: 6, Steps: 129 | Train Loss: 0.4672860 Vali Loss: 0.3807448 Best vali loss: 0.3677868
	iters: 100, epoch: 7 | loss: 0.4109057
	speed: 0.0275s/iter; left time: 4.3708s
Updating learning rate to 0.00017187806055329383
Epoch: 7 cost time: 2.305586576461792
Epoch: 7, Steps: 129 | Train Loss: 0.4109057 Vali Loss: 0.3897434 Best vali loss: 0.3677868
	iters: 100, epoch: 8 | loss: 0.5686754
	speed: 0.0273s/iter; left time: 0.8199s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.10941219329834
Epoch: 8, Steps: 129 | Train Loss: 0.5686754 Vali Loss: 0.3890472 Best vali loss: 0.3677868

best validation loss 0.3677868303943477

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0015756290456, 'e_layers': 1, 'learning_rate': 0.0033110827246, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003185062142154823
Validation loss decreased (inf --> 0.3747).  Saving model state dict ...
Epoch: 1 cost time: 0.9795165061950684
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3747160 Best vali loss: 0.3747160
Updating learning rate to 0.002826185886117145
Validation loss decreased (0.3747 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 0.6104061603546143
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3643024 Best vali loss: 0.3643024
Updating learning rate to 0.0022890896132473407
Epoch: 3 cost time: 0.6117069721221924
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3744006 Best vali loss: 0.3643024

best validation loss 0.3643024319164411

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0029043411772, 'e_layers': 4, 'learning_rate': 0.0013039113529, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7902282
	speed: 0.0187s/iter; left time: 36.6402s
	iters: 200, epoch: 1 | loss: 0.8630803
	speed: 0.0100s/iter; left time: 18.6246s
Updating learning rate to 0.0013039113529
Validation loss decreased (inf --> 0.3752).  Saving model state dict ...
Epoch: 1 cost time: 3.0390477180480957
Epoch: 1, Steps: 257 | Train Loss: 0.8266543 Vali Loss: 0.3752441 Best vali loss: 0.3752441
	iters: 100, epoch: 2 | loss: 0.6151412
	speed: 0.0198s/iter; left time: 33.7325s
	iters: 200, epoch: 2 | loss: 0.7133341
	speed: 0.0094s/iter; left time: 15.0687s
Updating learning rate to 0.00065195567645
Validation loss decreased (0.3752 --> 0.3749).  Saving model state dict ...
Epoch: 2 cost time: 2.459078311920166
Epoch: 2, Steps: 257 | Train Loss: 0.6642376 Vali Loss: 0.3749050 Best vali loss: 0.3749050
	iters: 100, epoch: 3 | loss: 0.5439758
	speed: 0.0207s/iter; left time: 29.8577s
	iters: 200, epoch: 3 | loss: 0.4678352
	speed: 0.0074s/iter; left time: 9.9100s
Updating learning rate to 0.000325977838225
Validation loss decreased (0.3749 --> 0.3731).  Saving model state dict ...
Epoch: 3 cost time: 2.313769578933716
Epoch: 3, Steps: 257 | Train Loss: 0.5059055 Vali Loss: 0.3730917 Best vali loss: 0.3730917

best validation loss 0.37309165291327157

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0104773939528, 'e_layers': 3, 'learning_rate': 7.61018272e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4119084
	speed: 0.0155s/iter; left time: 62.2506s
	iters: 200, epoch: 1 | loss: 0.2986443
	speed: 0.0083s/iter; left time: 32.3909s
	iters: 300, epoch: 1 | loss: 0.7578046
	speed: 0.0060s/iter; left time: 23.0668s
	iters: 400, epoch: 1 | loss: 1.1101819
	speed: 0.0063s/iter; left time: 23.5281s
	iters: 500, epoch: 1 | loss: 0.6603155
	speed: 0.0085s/iter; left time: 30.8062s
Updating learning rate to 7.61018272e-05
Validation loss decreased (inf --> 0.3648).  Saving model state dict ...
Epoch: 1 cost time: 4.275219202041626
Epoch: 1, Steps: 514 | Train Loss: 0.6477710 Vali Loss: 0.3648423 Best vali loss: 0.3648423
	iters: 100, epoch: 2 | loss: 0.3518669
	speed: 0.0335s/iter; left time: 117.1548s
	iters: 200, epoch: 2 | loss: 0.6508160
	speed: 0.0104s/iter; left time: 35.2382s
	iters: 300, epoch: 2 | loss: 0.6789026
	speed: 0.0108s/iter; left time: 35.6188s
	iters: 400, epoch: 2 | loss: 0.9257957
	speed: 0.0116s/iter; left time: 37.0905s
	iters: 500, epoch: 2 | loss: 0.7880676
	speed: 0.0118s/iter; left time: 36.6328s
Updating learning rate to 3.80509136e-05
Validation loss decreased (0.3648 --> 0.3618).  Saving model state dict ...
Epoch: 2 cost time: 5.871392250061035
Epoch: 2, Steps: 514 | Train Loss: 0.6790898 Vali Loss: 0.3617804 Best vali loss: 0.3617804
	iters: 100, epoch: 3 | loss: 0.7706161
	speed: 0.0327s/iter; left time: 97.5661s
	iters: 200, epoch: 3 | loss: 0.2713252
	speed: 0.0112s/iter; left time: 32.2622s
	iters: 300, epoch: 3 | loss: 0.5725413
	speed: 0.0116s/iter; left time: 32.2094s
	iters: 400, epoch: 3 | loss: 0.3240983
	speed: 0.0082s/iter; left time: 22.0790s
	iters: 500, epoch: 3 | loss: 0.9026229
	speed: 0.0084s/iter; left time: 21.7207s
Updating learning rate to 1.90254568e-05
Validation loss decreased (0.3618 --> 0.3561).  Saving model state dict ...
Epoch: 3 cost time: 5.224828481674194
Epoch: 3, Steps: 514 | Train Loss: 0.5682407 Vali Loss: 0.3560980 Best vali loss: 0.3560980

best validation loss 0.35609798704242895

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0104773939528, 'e_layers': 3, 'learning_rate': 7.61018272e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3519699
	speed: 0.0173s/iter; left time: 42.6286s
	iters: 200, epoch: 4 | loss: 0.2524694
	speed: 0.0088s/iter; left time: 20.8360s
	iters: 300, epoch: 4 | loss: 0.6293429
	speed: 0.0091s/iter; left time: 20.7715s
	iters: 400, epoch: 4 | loss: 0.8270473
	speed: 0.0092s/iter; left time: 20.0161s
	iters: 500, epoch: 4 | loss: 0.5849138
	speed: 0.0089s/iter; left time: 18.4522s
Updating learning rate to 9.5127284e-06
Epoch: 4 cost time: 5.024372339248657
Epoch: 4, Steps: 514 | Train Loss: 0.5291487 Vali Loss: 0.3572198 Best vali loss: 0.3560980
	iters: 100, epoch: 5 | loss: 0.3603105
	speed: 0.0196s/iter; left time: 38.4070s
	iters: 200, epoch: 5 | loss: 0.6646569
	speed: 0.0087s/iter; left time: 16.0700s
	iters: 300, epoch: 5 | loss: 0.5881618
	speed: 0.0082s/iter; left time: 14.3810s
	iters: 400, epoch: 5 | loss: 0.7764466
	speed: 0.0107s/iter; left time: 17.7758s
	iters: 500, epoch: 5 | loss: 0.8175238
	speed: 0.0102s/iter; left time: 15.9037s
Updating learning rate to 4.7563642e-06
Epoch: 5 cost time: 4.887976169586182
Epoch: 5, Steps: 514 | Train Loss: 0.6414199 Vali Loss: 0.3589387 Best vali loss: 0.3560980
	iters: 100, epoch: 6 | loss: 0.7331309
	speed: 0.0216s/iter; left time: 31.2286s
	iters: 200, epoch: 6 | loss: 0.2717693
	speed: 0.0111s/iter; left time: 14.8483s
	iters: 300, epoch: 6 | loss: 0.5553680
	speed: 0.0115s/iter; left time: 14.2852s
	iters: 400, epoch: 6 | loss: 0.3118986
	speed: 0.0094s/iter; left time: 10.7969s
	iters: 500, epoch: 6 | loss: 0.8491617
	speed: 0.0110s/iter; left time: 11.4930s
Updating learning rate to 2.3781821e-06
Epoch: 6 cost time: 5.5843260288238525
Epoch: 6, Steps: 514 | Train Loss: 0.5442657 Vali Loss: 0.3594648 Best vali loss: 0.3560980
	iters: 100, epoch: 7 | loss: 0.5493154
	speed: 0.0208s/iter; left time: 19.3028s
	iters: 200, epoch: 7 | loss: 0.4239182
	speed: 0.0078s/iter; left time: 6.4745s
	iters: 300, epoch: 7 | loss: 0.3594472
	speed: 0.0135s/iter; left time: 9.8764s
	iters: 400, epoch: 7 | loss: 1.0988404
	speed: 0.0133s/iter; left time: 8.3839s
	iters: 500, epoch: 7 | loss: 0.5900005
	speed: 0.0125s/iter; left time: 6.6047s
Updating learning rate to 1.18909105e-06
Epoch: 7 cost time: 5.87571382522583
Epoch: 7, Steps: 514 | Train Loss: 0.6043043 Vali Loss: 0.3573644 Best vali loss: 0.3560980
	iters: 100, epoch: 8 | loss: 0.4832044
	speed: 0.0287s/iter; left time: 11.9245s
	iters: 200, epoch: 8 | loss: 0.5455063
	speed: 0.0125s/iter; left time: 3.9352s
	iters: 300, epoch: 8 | loss: 1.0481775
	speed: 0.0126s/iter; left time: 2.7178s
	iters: 400, epoch: 8 | loss: 0.2848983
	speed: 0.0133s/iter; left time: 1.5247s
	iters: 500, epoch: 8 | loss: 0.4681280
	speed: 0.0134s/iter; left time: 0.2017s
Updating learning rate to 5.94545525e-07
Epoch: 8 cost time: 6.203920364379883
Epoch: 8, Steps: 514 | Train Loss: 0.5659829 Vali Loss: 0.3588913 Best vali loss: 0.3560980

best validation loss 0.35609798704242895

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0074509676079, 'e_layers': 3, 'learning_rate': 0.0002732562098, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3385172
	speed: 0.0241s/iter; left time: 47.0766s
	iters: 200, epoch: 1 | loss: 0.5683514
	speed: 0.0130s/iter; left time: 24.1238s
Updating learning rate to 0.00026285601458291507
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 4.091023206710815
Epoch: 1, Steps: 257 | Train Loss: 0.4534343 Vali Loss: 0.3647483 Best vali loss: 0.3647483
	iters: 100, epoch: 2 | loss: 0.3659315
	speed: 0.0314s/iter; left time: 53.3515s
	iters: 200, epoch: 2 | loss: 0.9125564
	speed: 0.0120s/iter; left time: 19.1590s
Updating learning rate to 0.00023323876437545695
Epoch: 2 cost time: 3.284116744995117
Epoch: 2, Steps: 257 | Train Loss: 0.6392439 Vali Loss: 0.3730269 Best vali loss: 0.3647483
	iters: 100, epoch: 3 | loss: 0.9845668
	speed: 0.0294s/iter; left time: 42.3565s
	iters: 200, epoch: 3 | loss: 0.8145284
	speed: 0.0136s/iter; left time: 18.3052s
Updating learning rate to 0.00018891341704066955
Epoch: 3 cost time: 3.4545483589172363
Epoch: 3, Steps: 257 | Train Loss: 0.8995476 Vali Loss: 0.3699524 Best vali loss: 0.3647483
	iters: 100, epoch: 4 | loss: 0.5825976
	speed: 0.0395s/iter; left time: 46.8925s
	iters: 200, epoch: 4 | loss: 0.5428485
	speed: 0.0131s/iter; left time: 14.2617s
Updating learning rate to 0.0001366281049
Epoch: 4 cost time: 4.1805267333984375
Epoch: 4, Steps: 257 | Train Loss: 0.5627230 Vali Loss: 0.3698243 Best vali loss: 0.3647483
	iters: 100, epoch: 5 | loss: 0.6225508
	speed: 0.0330s/iter; left time: 30.6630s
	iters: 200, epoch: 5 | loss: 0.6276595
	speed: 0.0126s/iter; left time: 10.4059s
Updating learning rate to 8.434279275933047e-05
Epoch: 5 cost time: 3.3436152935028076
Epoch: 5, Steps: 257 | Train Loss: 0.6251051 Vali Loss: 0.3710053 Best vali loss: 0.3647483
	iters: 100, epoch: 6 | loss: 0.4367608
	speed: 0.0224s/iter; left time: 15.0802s
	iters: 200, epoch: 6 | loss: 0.5769579
	speed: 0.0085s/iter; left time: 4.8520s
Updating learning rate to 4.001744542454305e-05
Epoch: 6 cost time: 2.1806387901306152
Epoch: 6, Steps: 257 | Train Loss: 0.5068594 Vali Loss: 0.3674949 Best vali loss: 0.3647483
	iters: 100, epoch: 7 | loss: 0.6497394
	speed: 0.0194s/iter; left time: 8.0626s
	iters: 200, epoch: 7 | loss: 0.3926767
	speed: 0.0107s/iter; left time: 3.3813s
Updating learning rate to 1.0400195217084955e-05
Validation loss decreased (0.3647 --> 0.3641).  Saving model state dict ...
Epoch: 7 cost time: 2.6119368076324463
Epoch: 7, Steps: 257 | Train Loss: 0.5212081 Vali Loss: 0.3641370 Best vali loss: 0.3641370
	iters: 100, epoch: 8 | loss: 0.3189027
	speed: 0.0177s/iter; left time: 2.7915s
	iters: 200, epoch: 8 | loss: 0.6177965
	speed: 0.0084s/iter; left time: 0.4858s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.1891610622406006
Epoch: 8, Steps: 257 | Train Loss: 0.4683496 Vali Loss: 0.3646295 Best vali loss: 0.3641370

best validation loss 0.36413704860655405

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0074701995035, 'e_layers': 3, 'learning_rate': 0.0001169716147, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5279950
	speed: 0.0153s/iter; left time: 123.8269s
	iters: 200, epoch: 1 | loss: 0.9384641
	speed: 0.0081s/iter; left time: 65.3303s
	iters: 300, epoch: 1 | loss: 1.0555685
	speed: 0.0080s/iter; left time: 63.2029s
	iters: 400, epoch: 1 | loss: 0.6094946
	speed: 0.0069s/iter; left time: 54.0596s
	iters: 500, epoch: 1 | loss: 1.0839339
	speed: 0.0082s/iter; left time: 63.0258s
	iters: 600, epoch: 1 | loss: 1.3059807
	speed: 0.0083s/iter; left time: 62.8953s
	iters: 700, epoch: 1 | loss: 0.3769963
	speed: 0.0086s/iter; left time: 64.6849s
	iters: 800, epoch: 1 | loss: 0.4596476
	speed: 0.0085s/iter; left time: 62.7474s
	iters: 900, epoch: 1 | loss: 0.3686263
	speed: 0.0082s/iter; left time: 60.3377s
	iters: 1000, epoch: 1 | loss: 0.1981826
	speed: 0.0073s/iter; left time: 52.7033s
Updating learning rate to 0.00011251964770306318
Validation loss decreased (inf --> 0.3855).  Saving model state dict ...
Epoch: 1 cost time: 8.61544919013977
Epoch: 1, Steps: 1027 | Train Loss: 0.6924890 Vali Loss: 0.3855301 Best vali loss: 0.3855301
	iters: 100, epoch: 2 | loss: 0.6917432
	speed: 0.0233s/iter; left time: 165.4850s
	iters: 200, epoch: 2 | loss: 0.2979020
	speed: 0.0083s/iter; left time: 57.8629s
	iters: 300, epoch: 2 | loss: 0.4416274
	speed: 0.0082s/iter; left time: 56.3538s
	iters: 400, epoch: 2 | loss: 0.3488185
	speed: 0.0068s/iter; left time: 45.8421s
	iters: 500, epoch: 2 | loss: 0.9273413
	speed: 0.0063s/iter; left time: 42.1225s
	iters: 600, epoch: 2 | loss: 0.2261547
	speed: 0.0072s/iter; left time: 47.6893s
	iters: 700, epoch: 2 | loss: 0.4141470
	speed: 0.0076s/iter; left time: 49.3052s
	iters: 800, epoch: 2 | loss: 1.2790877
	speed: 0.0075s/iter; left time: 48.0519s
	iters: 900, epoch: 2 | loss: 0.7749399
	speed: 0.0069s/iter; left time: 43.5847s
	iters: 1000, epoch: 2 | loss: 0.9698436
	speed: 0.0060s/iter; left time: 36.9768s
Updating learning rate to 9.984151833035502e-05
Validation loss decreased (0.3855 --> 0.3711).  Saving model state dict ...
Epoch: 2 cost time: 7.471933364868164
Epoch: 2, Steps: 1027 | Train Loss: 0.6371605 Vali Loss: 0.3711025 Best vali loss: 0.3711025
	iters: 100, epoch: 3 | loss: 0.6199977
	speed: 0.0183s/iter; left time: 110.9156s
	iters: 200, epoch: 3 | loss: 0.2764353
	speed: 0.0069s/iter; left time: 41.0498s
	iters: 300, epoch: 3 | loss: 0.2976853
	speed: 0.0074s/iter; left time: 43.1026s
	iters: 400, epoch: 3 | loss: 0.4248753
	speed: 0.0073s/iter; left time: 42.0834s
	iters: 500, epoch: 3 | loss: 0.8087218
	speed: 0.0074s/iter; left time: 42.0515s
	iters: 600, epoch: 3 | loss: 1.1301311
	speed: 0.0066s/iter; left time: 36.5089s
	iters: 700, epoch: 3 | loss: 0.1672054
	speed: 0.0059s/iter; left time: 32.1612s
	iters: 800, epoch: 3 | loss: 0.2137766
	speed: 0.0077s/iter; left time: 41.0451s
	iters: 900, epoch: 3 | loss: 0.5174506
	speed: 0.0083s/iter; left time: 43.6781s
	iters: 1000, epoch: 3 | loss: 1.0510615
	speed: 0.0073s/iter; left time: 37.8654s
Updating learning rate to 8.08673568513414e-05
Validation loss decreased (0.3711 --> 0.3680).  Saving model state dict ...
Epoch: 3 cost time: 7.300312280654907
Epoch: 3, Steps: 1027 | Train Loss: 0.5507341 Vali Loss: 0.3680242 Best vali loss: 0.3680242
	iters: 100, epoch: 4 | loss: 0.4627483
	speed: 0.0209s/iter; left time: 105.1070s
	iters: 200, epoch: 4 | loss: 0.4959173
	speed: 0.0072s/iter; left time: 35.4751s
	iters: 300, epoch: 4 | loss: 0.7631826
	speed: 0.0071s/iter; left time: 34.4692s
	iters: 400, epoch: 4 | loss: 0.4433998
	speed: 0.0076s/iter; left time: 35.8310s
	iters: 500, epoch: 4 | loss: 0.3380595
	speed: 0.0069s/iter; left time: 31.9060s
	iters: 600, epoch: 4 | loss: 0.5736637
	speed: 0.0062s/iter; left time: 28.0304s
	iters: 700, epoch: 4 | loss: 0.4846736
	speed: 0.0058s/iter; left time: 25.7358s
	iters: 800, epoch: 4 | loss: 0.8193725
	speed: 0.0057s/iter; left time: 24.6213s
	iters: 900, epoch: 4 | loss: 0.6802843
	speed: 0.0053s/iter; left time: 22.4285s
	iters: 1000, epoch: 4 | loss: 0.3100965
	speed: 0.0061s/iter; left time: 25.4102s
Updating learning rate to 5.848580735e-05
Validation loss decreased (0.3680 --> 0.3670).  Saving model state dict ...
Epoch: 4 cost time: 6.760138034820557
Epoch: 4, Steps: 1027 | Train Loss: 0.5371398 Vali Loss: 0.3670095 Best vali loss: 0.3670095
	iters: 100, epoch: 5 | loss: 1.5538286
	speed: 0.0249s/iter; left time: 99.9596s
	iters: 200, epoch: 5 | loss: 0.3919490
	speed: 0.0081s/iter; left time: 31.5630s
	iters: 300, epoch: 5 | loss: 0.9475864
	speed: 0.0073s/iter; left time: 27.7522s
	iters: 400, epoch: 5 | loss: 0.4741888
	speed: 0.0082s/iter; left time: 30.2880s
	iters: 500, epoch: 5 | loss: 0.7500790
	speed: 0.0084s/iter; left time: 30.3782s
	iters: 600, epoch: 5 | loss: 0.4523320
	speed: 0.0083s/iter; left time: 29.1566s
	iters: 700, epoch: 5 | loss: 0.4591219
	speed: 0.0083s/iter; left time: 28.3572s
	iters: 800, epoch: 5 | loss: 0.3915644
	speed: 0.0079s/iter; left time: 26.2519s
	iters: 900, epoch: 5 | loss: 1.1386092
	speed: 0.0080s/iter; left time: 25.6243s
	iters: 1000, epoch: 5 | loss: 0.1822874
	speed: 0.0077s/iter; left time: 24.0598s
Updating learning rate to 3.610425784865861e-05
Validation loss decreased (0.3670 --> 0.3661).  Saving model state dict ...
Epoch: 5 cost time: 8.320819854736328
Epoch: 5, Steps: 1027 | Train Loss: 0.6741547 Vali Loss: 0.3660531 Best vali loss: 0.3660531
	iters: 100, epoch: 6 | loss: 1.2661728
	speed: 0.0213s/iter; left time: 63.5315s
	iters: 200, epoch: 6 | loss: 0.2159312
	speed: 0.0065s/iter; left time: 18.8351s
	iters: 300, epoch: 6 | loss: 0.4670922
	speed: 0.0080s/iter; left time: 22.2085s
	iters: 400, epoch: 6 | loss: 0.3155853
	speed: 0.0081s/iter; left time: 21.8482s
	iters: 500, epoch: 6 | loss: 0.4566545
	speed: 0.0080s/iter; left time: 20.6715s
	iters: 600, epoch: 6 | loss: 0.2709687
	speed: 0.0081s/iter; left time: 20.1832s
	iters: 700, epoch: 6 | loss: 1.3777099
	speed: 0.0079s/iter; left time: 18.7503s
	iters: 800, epoch: 6 | loss: 0.1539434
	speed: 0.0078s/iter; left time: 17.7265s
	iters: 900, epoch: 6 | loss: 0.8517063
	speed: 0.0081s/iter; left time: 17.6687s
	iters: 1000, epoch: 6 | loss: 1.2413012
	speed: 0.0071s/iter; left time: 14.8128s
Updating learning rate to 1.713009636964498e-05
Validation loss decreased (0.3661 --> 0.3659).  Saving model state dict ...
Epoch: 6 cost time: 7.842890501022339
Epoch: 6, Steps: 1027 | Train Loss: 0.6617065 Vali Loss: 0.3658910 Best vali loss: 0.3658910
	iters: 100, epoch: 7 | loss: 1.0371991
	speed: 0.0232s/iter; left time: 45.4268s
	iters: 200, epoch: 7 | loss: 0.8338000
	speed: 0.0076s/iter; left time: 14.1836s
	iters: 300, epoch: 7 | loss: 0.4147388
	speed: 0.0080s/iter; left time: 14.1257s
	iters: 400, epoch: 7 | loss: 0.4011222
	speed: 0.0081s/iter; left time: 13.4086s
	iters: 500, epoch: 7 | loss: 1.0266999
	speed: 0.0082s/iter; left time: 12.7598s
	iters: 600, epoch: 7 | loss: 0.4924355
	speed: 0.0078s/iter; left time: 11.4046s
	iters: 700, epoch: 7 | loss: 1.0717620
	speed: 0.0075s/iter; left time: 10.1463s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0031777012672, 'e_layers': 1, 'learning_rate': 0.0002535692665, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9924691
	speed: 0.0117s/iter; left time: 95.1777s
	iters: 200, epoch: 1 | loss: 0.4003683
	speed: 0.0045s/iter; left time: 35.7696s
	iters: 300, epoch: 1 | loss: 0.2277424
	speed: 0.0042s/iter; left time: 33.3030s
	iters: 400, epoch: 1 | loss: 0.7763143
	speed: 0.0043s/iter; left time: 33.5268s
	iters: 500, epoch: 1 | loss: 0.2470915
	speed: 0.0043s/iter; left time: 33.2897s
	iters: 600, epoch: 1 | loss: 0.4125407
	speed: 0.0040s/iter; left time: 30.4252s
	iters: 700, epoch: 1 | loss: 0.2603231
	speed: 0.0036s/iter; left time: 27.2336s
	iters: 800, epoch: 1 | loss: 0.9020155
	speed: 0.0037s/iter; left time: 27.4476s
	iters: 900, epoch: 1 | loss: 0.9710149
	speed: 0.0051s/iter; left time: 37.4363s
	iters: 1000, epoch: 1 | loss: 0.6363671
	speed: 0.0044s/iter; left time: 31.8613s
Updating learning rate to 0.00024391836094662494
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 4.784269094467163
Epoch: 1, Steps: 1027 | Train Loss: 0.5826247 Vali Loss: 0.3710698 Best vali loss: 0.3710698
	iters: 100, epoch: 2 | loss: 0.1705839
	speed: 0.0161s/iter; left time: 113.9505s
	iters: 200, epoch: 2 | loss: 0.5475956
	speed: 0.0054s/iter; left time: 37.4012s
	iters: 300, epoch: 2 | loss: 0.3667842
	speed: 0.0044s/iter; left time: 30.5977s
	iters: 400, epoch: 2 | loss: 0.4458490
	speed: 0.0055s/iter; left time: 37.4127s
	iters: 500, epoch: 2 | loss: 1.0476371
	speed: 0.0058s/iter; left time: 38.6830s
	iters: 600, epoch: 2 | loss: 1.3801564
	speed: 0.0051s/iter; left time: 33.7919s
	iters: 700, epoch: 2 | loss: 0.7415706
	speed: 0.0047s/iter; left time: 30.7796s
	iters: 800, epoch: 2 | loss: 0.6000572
	speed: 0.0051s/iter; left time: 32.7644s
	iters: 900, epoch: 2 | loss: 1.6323749
	speed: 0.0043s/iter; left time: 26.9314s
	iters: 1000, epoch: 2 | loss: 0.9841201
	speed: 0.0039s/iter; left time: 24.1870s
Updating learning rate to 0.0002164349071713244
Validation loss decreased (0.3711 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 5.16404914855957
Epoch: 2, Steps: 1027 | Train Loss: 0.7916729 Vali Loss: 0.3690231 Best vali loss: 0.3690231
	iters: 100, epoch: 3 | loss: 0.3996763
	speed: 0.0189s/iter; left time: 114.6484s
	iters: 200, epoch: 3 | loss: 0.2524405
	speed: 0.0049s/iter; left time: 29.2844s
	iters: 300, epoch: 3 | loss: 1.4330531
	speed: 0.0074s/iter; left time: 43.4707s
	iters: 400, epoch: 3 | loss: 0.3838396
	speed: 0.0069s/iter; left time: 39.8979s
	iters: 500, epoch: 3 | loss: 0.2044188
	speed: 0.0060s/iter; left time: 33.7740s
	iters: 600, epoch: 3 | loss: 0.6208130
	speed: 0.0056s/iter; left time: 31.3002s
	iters: 700, epoch: 3 | loss: 0.9577703
	speed: 0.0063s/iter; left time: 34.3177s
	iters: 800, epoch: 3 | loss: 0.3898596
	speed: 0.0069s/iter; left time: 36.8625s
	iters: 900, epoch: 3 | loss: 1.0622984
	speed: 0.0064s/iter; left time: 33.7957s
	iters: 1000, epoch: 3 | loss: 0.2568901
	speed: 0.0066s/iter; left time: 33.9714s
Updating learning rate to 0.0001753030118732591
Validation loss decreased (0.3690 --> 0.3652).  Saving model state dict ...
Epoch: 3 cost time: 6.424377918243408
Epoch: 3, Steps: 1027 | Train Loss: 0.5961060 Vali Loss: 0.3652098 Best vali loss: 0.3652098

best validation loss 0.3652098129798012

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.002287398968, 'e_layers': 3, 'learning_rate': 0.0011131188943, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010707533289976822
Validation loss decreased (inf --> 0.3630).  Saving model state dict ...
Epoch: 1 cost time: 0.9083640575408936
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3630164 Best vali loss: 0.3630164
Updating learning rate to 0.0009501064063632008
Epoch: 2 cost time: 0.5905675888061523
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3721581 Best vali loss: 0.3630164
Updating learning rate to 0.0007695455267005787
Epoch: 3 cost time: 0.6051146984100342
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3732152 Best vali loss: 0.3630164

best validation loss 0.36301640792071

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026787077049, 'e_layers': 2, 'learning_rate': 0.0003369998911, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3677713
	speed: 0.0136s/iter; left time: 110.0031s
	iters: 200, epoch: 1 | loss: 0.9098830
	speed: 0.0065s/iter; left time: 52.4114s
	iters: 300, epoch: 1 | loss: 0.5775641
	speed: 0.0061s/iter; left time: 48.2636s
	iters: 400, epoch: 1 | loss: 0.7476217
	speed: 0.0060s/iter; left time: 46.7700s
	iters: 500, epoch: 1 | loss: 1.0611084
	speed: 0.0061s/iter; left time: 46.9641s
	iters: 600, epoch: 1 | loss: 2.4781160
	speed: 0.0065s/iter; left time: 49.5921s
	iters: 700, epoch: 1 | loss: 1.0911433
	speed: 0.0066s/iter; left time: 49.9316s
	iters: 800, epoch: 1 | loss: 1.4394772
	speed: 0.0066s/iter; left time: 49.2971s
	iters: 900, epoch: 1 | loss: 0.4264252
	speed: 0.0064s/iter; left time: 46.4952s
	iters: 1000, epoch: 1 | loss: 0.3953578
	speed: 0.0055s/iter; left time: 39.6138s
Updating learning rate to 0.00032417359647291124
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 6.8266825675964355
Epoch: 1, Steps: 1027 | Train Loss: 1.0494468 Vali Loss: 0.3714501 Best vali loss: 0.3714501
	iters: 100, epoch: 2 | loss: 0.3614709
	speed: 0.0221s/iter; left time: 156.9401s
	iters: 200, epoch: 2 | loss: 0.2116410
	speed: 0.0063s/iter; left time: 43.8933s
	iters: 300, epoch: 2 | loss: 0.2915461
	speed: 0.0057s/iter; left time: 39.0824s
	iters: 400, epoch: 2 | loss: 1.0742117
	speed: 0.0059s/iter; left time: 39.7275s
	iters: 500, epoch: 2 | loss: 0.3955027
	speed: 0.0064s/iter; left time: 42.9226s
	iters: 600, epoch: 2 | loss: 1.4519478
	speed: 0.0065s/iter; left time: 42.8863s
	iters: 700, epoch: 2 | loss: 0.5131981
	speed: 0.0063s/iter; left time: 40.7660s
	iters: 800, epoch: 2 | loss: 1.1522843
	speed: 0.0065s/iter; left time: 41.2370s
	iters: 900, epoch: 2 | loss: 0.3092095
	speed: 0.0064s/iter; left time: 40.4733s
	iters: 1000, epoch: 2 | loss: 0.3237166
	speed: 0.0061s/iter; left time: 37.4609s
Updating learning rate to 0.000287647399677969
Epoch: 2 cost time: 6.489591836929321
Epoch: 2, Steps: 1027 | Train Loss: 0.6084729 Vali Loss: 0.3725513 Best vali loss: 0.3714501
	iters: 100, epoch: 3 | loss: 0.3882979
	speed: 0.0207s/iter; left time: 125.5541s
	iters: 200, epoch: 3 | loss: 1.2505391
	speed: 0.0058s/iter; left time: 34.4987s
	iters: 300, epoch: 3 | loss: 0.5424228
	speed: 0.0059s/iter; left time: 34.5432s
	iters: 400, epoch: 3 | loss: 0.1890326
	speed: 0.0063s/iter; left time: 36.5940s
	iters: 500, epoch: 3 | loss: 0.4661120
	speed: 0.0062s/iter; left time: 34.8940s
	iters: 600, epoch: 3 | loss: 0.3762130
	speed: 0.0055s/iter; left time: 30.7017s
	iters: 700, epoch: 3 | loss: 0.7554191
	speed: 0.0063s/iter; left time: 34.5187s
	iters: 800, epoch: 3 | loss: 0.2409257
	speed: 0.0067s/iter; left time: 36.0090s
	iters: 900, epoch: 3 | loss: 0.6396797
	speed: 0.0071s/iter; left time: 37.2872s
	iters: 1000, epoch: 3 | loss: 0.4400085
	speed: 0.0071s/iter; left time: 36.4934s
Updating learning rate to 0.00023298208306640473
Validation loss decreased (0.3715 --> 0.3676).  Saving model state dict ...
Epoch: 3 cost time: 6.503331661224365
Epoch: 3, Steps: 1027 | Train Loss: 0.5288650 Vali Loss: 0.3675511 Best vali loss: 0.3675511

best validation loss 0.3675511478440935

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.002287398968, 'e_layers': 3, 'learning_rate': 0.0011131188943, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00055655944715
Epoch: 4 cost time: 0.9234726428985596
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3632863 Best vali loss: 0.3630164
Updating learning rate to 0.00034357336759942124
Epoch: 5 cost time: 0.6076290607452393
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3652346 Best vali loss: 0.3630164
Updating learning rate to 0.0001630124879367991
Epoch: 6 cost time: 0.620962381362915
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3656423 Best vali loss: 0.3630164
Updating learning rate to 4.23655653023178e-05
Validation loss decreased (0.3630 --> 0.3609).  Saving model state dict ...
Epoch: 7 cost time: 0.589130163192749
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3609316 Best vali loss: 0.3609316
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6403102874755859
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3644208 Best vali loss: 0.3609316

best validation loss 0.3609316057798202

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0034070980994, 'e_layers': 1, 'learning_rate': 6.92167917e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7458864
	speed: 0.0138s/iter; left time: 12.8990s
Updating learning rate to 6.658238442886356e-05
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.2431066036224365
Epoch: 1, Steps: 129 | Train Loss: 0.7458864 Vali Loss: 0.3675819 Best vali loss: 0.3675819
	iters: 100, epoch: 2 | loss: 0.6506011
	speed: 0.0115s/iter; left time: 9.2319s
Updating learning rate to 5.9080227241523365e-05
Validation loss decreased (0.3676 --> 0.3633).  Saving model state dict ...
Epoch: 2 cost time: 0.8770346641540527
Epoch: 2, Steps: 129 | Train Loss: 0.6506011 Vali Loss: 0.3633332 Best vali loss: 0.3633332
	iters: 100, epoch: 3 | loss: 0.4129553
	speed: 0.0117s/iter; left time: 7.9128s
Updating learning rate to 4.785245556252773e-05
Epoch: 3 cost time: 0.8963263034820557
Epoch: 3, Steps: 129 | Train Loss: 0.4129553 Vali Loss: 0.3680014 Best vali loss: 0.3633332
	iters: 100, epoch: 4 | loss: 0.8322230
	speed: 0.0117s/iter; left time: 6.3753s
Updating learning rate to 3.460839585e-05
Epoch: 4 cost time: 0.9029567241668701
Epoch: 4, Steps: 129 | Train Loss: 0.8322230 Vali Loss: 0.3696507 Best vali loss: 0.3633332
	iters: 100, epoch: 5 | loss: 0.5752547
	speed: 0.0124s/iter; left time: 5.1691s
Updating learning rate to 2.1364336137472275e-05
Epoch: 5 cost time: 0.9166195392608643
Epoch: 5, Steps: 129 | Train Loss: 0.5752547 Vali Loss: 0.3702976 Best vali loss: 0.3633332
	iters: 100, epoch: 6 | loss: 0.5856924
	speed: 0.0113s/iter; left time: 3.2539s
Updating learning rate to 1.0136564458476632e-05
Epoch: 6 cost time: 0.8729853630065918
Epoch: 6, Steps: 129 | Train Loss: 0.5856924 Vali Loss: 0.3688500 Best vali loss: 0.3633332
	iters: 100, epoch: 7 | loss: 0.4298192
	speed: 0.0111s/iter; left time: 1.7578s
Updating learning rate to 2.634407271136444e-06
Epoch: 7 cost time: 0.8405413627624512
Epoch: 7, Steps: 129 | Train Loss: 0.4298192 Vali Loss: 0.3693030 Best vali loss: 0.3633332
	iters: 100, epoch: 8 | loss: 0.6524819
	speed: 0.0158s/iter; left time: 0.4728s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2955529689788818
Epoch: 8, Steps: 129 | Train Loss: 0.6524819 Vali Loss: 0.3693852 Best vali loss: 0.3633332

best validation loss 0.36333322753372266

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0009923553162, 'e_layers': 2, 'learning_rate': 0.0015677066798, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5701329
	speed: 0.0129s/iter; left time: 104.7376s
	iters: 200, epoch: 1 | loss: 1.0647743
	speed: 0.0065s/iter; left time: 51.8782s
	iters: 300, epoch: 1 | loss: 1.4685392
	speed: 0.0067s/iter; left time: 52.7115s
	iters: 400, epoch: 1 | loss: 0.8248481
	speed: 0.0064s/iter; left time: 50.3749s
	iters: 500, epoch: 1 | loss: 0.4199960
	speed: 0.0065s/iter; left time: 49.7913s
	iters: 600, epoch: 1 | loss: 1.4961911
	speed: 0.0063s/iter; left time: 48.0510s
	iters: 700, epoch: 1 | loss: 0.4086962
	speed: 0.0053s/iter; left time: 39.4955s
	iters: 800, epoch: 1 | loss: 0.3784578
	speed: 0.0057s/iter; left time: 42.2896s
	iters: 900, epoch: 1 | loss: 0.3518639
	speed: 0.0061s/iter; left time: 44.5007s
	iters: 1000, epoch: 1 | loss: 0.9472599
	speed: 0.0050s/iter; left time: 36.3031s
Updating learning rate to 0.0015677066798
Validation loss decreased (inf --> 0.3914).  Saving model state dict ...
Epoch: 1 cost time: 6.5752739906311035
Epoch: 1, Steps: 1027 | Train Loss: 0.7930759 Vali Loss: 0.3914489 Best vali loss: 0.3914489
	iters: 100, epoch: 2 | loss: 0.9559487
	speed: 0.0207s/iter; left time: 146.8297s
	iters: 200, epoch: 2 | loss: 0.2540399
	speed: 0.0061s/iter; left time: 42.9748s
	iters: 300, epoch: 2 | loss: 0.2695864
	speed: 0.0070s/iter; left time: 48.3409s
	iters: 400, epoch: 2 | loss: 0.7551926
	speed: 0.0063s/iter; left time: 42.9830s
	iters: 500, epoch: 2 | loss: 0.3785138
	speed: 0.0065s/iter; left time: 43.4459s
	iters: 600, epoch: 2 | loss: 0.6136223
	speed: 0.0063s/iter; left time: 41.5942s
	iters: 700, epoch: 2 | loss: 1.1182576
	speed: 0.0059s/iter; left time: 38.2021s
	iters: 800, epoch: 2 | loss: 0.5151513
	speed: 0.0075s/iter; left time: 48.1227s
	iters: 900, epoch: 2 | loss: 0.5403097
	speed: 0.0079s/iter; left time: 49.4586s
	iters: 1000, epoch: 2 | loss: 0.2816677
	speed: 0.0070s/iter; left time: 43.1908s
Updating learning rate to 0.0007838533399
Epoch: 2 cost time: 6.969883918762207
Epoch: 2, Steps: 1027 | Train Loss: 0.5682290 Vali Loss: 0.3997919 Best vali loss: 0.3914489
	iters: 100, epoch: 3 | loss: 0.3142899
	speed: 0.0155s/iter; left time: 94.1075s
	iters: 200, epoch: 3 | loss: 0.4504435
	speed: 0.0067s/iter; left time: 40.0454s
	iters: 300, epoch: 3 | loss: 0.5127713
	speed: 0.0073s/iter; left time: 43.0005s
	iters: 400, epoch: 3 | loss: 0.3073156
	speed: 0.0066s/iter; left time: 38.2057s
	iters: 500, epoch: 3 | loss: 0.3727173
	speed: 0.0055s/iter; left time: 31.3562s
	iters: 600, epoch: 3 | loss: 1.6977398
	speed: 0.0065s/iter; left time: 36.3249s
	iters: 700, epoch: 3 | loss: 0.8203512
	speed: 0.0068s/iter; left time: 36.9446s
	iters: 800, epoch: 3 | loss: 0.3593943
	speed: 0.0066s/iter; left time: 35.2193s
	iters: 900, epoch: 3 | loss: 0.7640222
	speed: 0.0060s/iter; left time: 31.5014s
	iters: 1000, epoch: 3 | loss: 0.2821187
	speed: 0.0066s/iter; left time: 34.1591s
Updating learning rate to 0.00039192666995
Validation loss decreased (0.3914 --> 0.3802).  Saving model state dict ...
Epoch: 3 cost time: 6.648384094238281
Epoch: 3, Steps: 1027 | Train Loss: 0.5881164 Vali Loss: 0.3802476 Best vali loss: 0.3802476
	iters: 100, epoch: 4 | loss: 0.5499895
	speed: 0.0207s/iter; left time: 104.0283s
	iters: 200, epoch: 4 | loss: 1.1693455
	speed: 0.0056s/iter; left time: 27.8521s
	iters: 300, epoch: 4 | loss: 0.5567209
	speed: 0.0056s/iter; left time: 27.2330s
	iters: 400, epoch: 4 | loss: 0.4917719
	speed: 0.0061s/iter; left time: 28.7409s
	iters: 500, epoch: 4 | loss: 1.2243705
	speed: 0.0061s/iter; left time: 28.2029s
	iters: 600, epoch: 4 | loss: 1.2566766
	speed: 0.0062s/iter; left time: 28.2353s
	iters: 700, epoch: 4 | loss: 0.3256292
	speed: 0.0066s/iter; left time: 29.4691s
	iters: 800, epoch: 4 | loss: 0.3584301
	speed: 0.0066s/iter; left time: 28.6873s
	iters: 900, epoch: 4 | loss: 0.3862690
	speed: 0.0063s/iter; left time: 26.5828s
	iters: 1000, epoch: 4 | loss: 0.6540627
	speed: 0.0063s/iter; left time: 26.1964s
Updating learning rate to 0.000195963334975
Validation loss decreased (0.3802 --> 0.3729).  Saving model state dict ...
Epoch: 4 cost time: 6.3663129806518555
Epoch: 4, Steps: 1027 | Train Loss: 0.6973266 Vali Loss: 0.3728861 Best vali loss: 0.3728861
	iters: 100, epoch: 5 | loss: 0.9600725
	speed: 0.0216s/iter; left time: 86.5581s
	iters: 200, epoch: 5 | loss: 0.3493883
	speed: 0.0059s/iter; left time: 23.0787s
	iters: 300, epoch: 5 | loss: 0.3450972
	speed: 0.0061s/iter; left time: 23.1937s
	iters: 400, epoch: 5 | loss: 0.3919721
	speed: 0.0063s/iter; left time: 23.5018s
	iters: 500, epoch: 5 | loss: 0.6743619
	speed: 0.0062s/iter; left time: 22.4086s
	iters: 600, epoch: 5 | loss: 1.0536606
	speed: 0.0063s/iter; left time: 22.0480s
	iters: 700, epoch: 5 | loss: 0.3166221
	speed: 0.0063s/iter; left time: 21.6456s
	iters: 800, epoch: 5 | loss: 1.0373256
	speed: 0.0062s/iter; left time: 20.5043s
	iters: 900, epoch: 5 | loss: 1.4337853
	speed: 0.0062s/iter; left time: 19.9297s
	iters: 1000, epoch: 5 | loss: 0.5907968
	speed: 0.0062s/iter; left time: 19.3854s
Updating learning rate to 9.79816674875e-05
Epoch: 5 cost time: 6.400797367095947
Epoch: 5, Steps: 1027 | Train Loss: 0.7153082 Vali Loss: 0.3763729 Best vali loss: 0.3728861
	iters: 100, epoch: 6 | loss: 1.3708602
	speed: 0.0180s/iter; left time: 53.6977s
	iters: 200, epoch: 6 | loss: 0.4034192
	speed: 0.0062s/iter; left time: 17.9935s
	iters: 300, epoch: 6 | loss: 0.3677896
	speed: 0.0071s/iter; left time: 19.6151s
	iters: 400, epoch: 6 | loss: 0.3238706
	speed: 0.0068s/iter; left time: 18.2438s
	iters: 500, epoch: 6 | loss: 0.9370960
	speed: 0.0060s/iter; left time: 15.3826s
	iters: 600, epoch: 6 | loss: 0.8519836
	speed: 0.0062s/iter; left time: 15.5120s
	iters: 700, epoch: 6 | loss: 0.4270768
	speed: 0.0058s/iter; left time: 13.9097s
	iters: 800, epoch: 6 | loss: 0.3488622
	speed: 0.0060s/iter; left time: 13.6618s
	iters: 900, epoch: 6 | loss: 0.4830444
	speed: 0.0081s/iter; left time: 17.6266s
	iters: 1000, epoch: 6 | loss: 0.9412296
	speed: 0.0070s/iter; left time: 14.4733s
Updating learning rate to 4.899083374375e-05
Epoch: 6 cost time: 6.758619070053101
Epoch: 6, Steps: 1027 | Train Loss: 0.6455232 Vali Loss: 0.3784680 Best vali loss: 0.3728861
	iters: 100, epoch: 7 | loss: 0.2579604
	speed: 0.0280s/iter; left time: 54.8346s
	iters: 200, epoch: 7 | loss: 0.4263920
	speed: 0.0044s/iter; left time: 8.1374s
	iters: 300, epoch: 7 | loss: 0.3601284
	speed: 0.0045s/iter; left time: 7.9436s
	iters: 400, epoch: 7 | loss: 0.4176774
	speed: 0.0094s/iter; left time: 15.5609s
	iters: 500, epoch: 7 | loss: 0.3275354
	speed: 0.0100s/iter; left time: 15.5414s
	iters: 600, epoch: 7 | loss: 0.5749940
	speed: 0.0085s/iter; left time: 12.4097s
	iters: 700, epoch: 7 | loss: 0.9135284
	speed: 0.0072s/iter; left time: 9.7055s
	iters: 800, epoch: 7 | loss: 0.3903030
	speed: 0.0102s/iter; left time: 12.8011s
	iters: 900, epoch: 7 | loss: 1.2115523
	speed: 0.0105s/iter; left time: 12.1400s
	iters: 1000, epoch: 7 | loss: 1.1339862
	speed: 0.0086s/iter; left time: 9.0917s
Updating learning rate to 2.4495416871875e-05
Epoch: 7 cost time: 8.361672639846802
Epoch: 7, Steps: 1027 | Train Loss: 0.6014058 Vali Loss: 0.3796761 Best vali loss: 0.3728861
	iters: 100, epoch: 8 | loss: 0.5575475
	speed: 0.0301s/iter; left time: 27.9678s
	iters: 200, epoch: 8 | loss: 0.5067850
	speed: 0.0047s/iter; left time: 3.8727s
	iters: 300, epoch: 8 | loss: 0.4443719
	speed: 0.0057s/iter; left time: 4.1565s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0012951973113, 'e_layers': 1, 'learning_rate': 0.0019297602429, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4008767
	speed: 0.0132s/iter; left time: 12.2712s
Updating learning rate to 0.0019297602429
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 1.233945608139038
Epoch: 1, Steps: 129 | Train Loss: 0.4008767 Vali Loss: 0.3743780 Best vali loss: 0.3743780
	iters: 100, epoch: 2 | loss: 0.5705547
	speed: 0.0127s/iter; left time: 10.2444s
Updating learning rate to 0.00096488012145
Epoch: 2 cost time: 0.8913013935089111
Epoch: 2, Steps: 129 | Train Loss: 0.5705547 Vali Loss: 0.3824956 Best vali loss: 0.3743780
	iters: 100, epoch: 3 | loss: 0.5992575
	speed: 0.0115s/iter; left time: 7.7594s
Updating learning rate to 0.000482440060725
Epoch: 3 cost time: 0.8675403594970703
Epoch: 3, Steps: 129 | Train Loss: 0.5992575 Vali Loss: 0.3847320 Best vali loss: 0.3743780

best validation loss 0.37437800708828833

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0023270275026, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5174185
	speed: 0.0118s/iter; left time: 95.8158s
	iters: 200, epoch: 1 | loss: 0.4371031
	speed: 0.0062s/iter; left time: 49.3602s
	iters: 300, epoch: 1 | loss: 0.4698887
	speed: 0.0064s/iter; left time: 50.7480s
	iters: 400, epoch: 1 | loss: 0.3135629
	speed: 0.0061s/iter; left time: 47.7257s
	iters: 500, epoch: 1 | loss: 0.3976242
	speed: 0.0062s/iter; left time: 48.1453s
	iters: 600, epoch: 1 | loss: 0.9104878
	speed: 0.0057s/iter; left time: 43.4014s
	iters: 700, epoch: 1 | loss: 0.8058568
	speed: 0.0080s/iter; left time: 59.9582s
	iters: 800, epoch: 1 | loss: 0.5106985
	speed: 0.0075s/iter; left time: 55.5486s
	iters: 900, epoch: 1 | loss: 0.9914908
	speed: 0.0090s/iter; left time: 65.8803s
	iters: 1000, epoch: 1 | loss: 1.2161378
	speed: 0.0080s/iter; left time: 57.6218s
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 7.436426639556885
Epoch: 1, Steps: 1027 | Train Loss: 0.6570269 Vali Loss: 0.3740296 Best vali loss: 0.3740296
	iters: 100, epoch: 2 | loss: 0.4230088
	speed: 0.0212s/iter; left time: 150.2501s
	iters: 200, epoch: 2 | loss: 0.3920318
	speed: 0.0058s/iter; left time: 40.7359s
	iters: 300, epoch: 2 | loss: 0.4152887
	speed: 0.0054s/iter; left time: 36.9309s
	iters: 400, epoch: 2 | loss: 0.4791085
	speed: 0.0057s/iter; left time: 38.8498s
	iters: 500, epoch: 2 | loss: 0.6215113
	speed: 0.0063s/iter; left time: 42.1754s
	iters: 600, epoch: 2 | loss: 0.8995230
	speed: 0.0054s/iter; left time: 35.8270s
	iters: 700, epoch: 2 | loss: 0.4016925
	speed: 0.0056s/iter; left time: 36.6221s
	iters: 800, epoch: 2 | loss: 0.3871355
	speed: 0.0095s/iter; left time: 60.4830s
	iters: 900, epoch: 2 | loss: 1.4989332
	speed: 0.0083s/iter; left time: 52.4244s
	iters: 1000, epoch: 2 | loss: 0.4698545
	speed: 0.0083s/iter; left time: 51.4551s
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.3740 --> 0.3682).  Saving model state dict ...
Epoch: 2 cost time: 6.967099666595459
Epoch: 2, Steps: 1027 | Train Loss: 0.5988088 Vali Loss: 0.3681588 Best vali loss: 0.3681588
	iters: 100, epoch: 3 | loss: 0.4497453
	speed: 0.0278s/iter; left time: 168.4353s
	iters: 200, epoch: 3 | loss: 0.2765432
	speed: 0.0086s/iter; left time: 51.4394s
	iters: 300, epoch: 3 | loss: 1.0436425
	speed: 0.0055s/iter; left time: 32.3688s
	iters: 400, epoch: 3 | loss: 0.1876274
	speed: 0.0051s/iter; left time: 29.6060s
	iters: 500, epoch: 3 | loss: 0.3655394
	speed: 0.0047s/iter; left time: 26.8499s
	iters: 600, epoch: 3 | loss: 0.3234907
	speed: 0.0051s/iter; left time: 28.4623s
	iters: 700, epoch: 3 | loss: 0.4263039
	speed: 0.0064s/iter; left time: 34.9574s
	iters: 800, epoch: 3 | loss: 1.1886970
	speed: 0.0072s/iter; left time: 38.8032s
	iters: 900, epoch: 3 | loss: 0.2803722
	speed: 0.0069s/iter; left time: 36.3285s
	iters: 1000, epoch: 3 | loss: 0.7028416
	speed: 0.0069s/iter; left time: 35.7540s
Updating learning rate to 8.93085473266162e-05
Epoch: 3 cost time: 6.6450910568237305
Epoch: 3, Steps: 1027 | Train Loss: 0.5244803 Vali Loss: 0.3705386 Best vali loss: 0.3681588

best validation loss 0.36815883032465263

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0067140529486, 'e_layers': 4, 'learning_rate': 0.0011984411391, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4728704
	speed: 0.0199s/iter; left time: 39.0289s
	iters: 200, epoch: 1 | loss: 0.8201102
	speed: 0.0115s/iter; left time: 21.2650s
Updating learning rate to 0.0011528281892170008
Validation loss decreased (inf --> 0.3806).  Saving model state dict ...
Epoch: 1 cost time: 3.55570912361145
Epoch: 1, Steps: 257 | Train Loss: 0.6464903 Vali Loss: 0.3805981 Best vali loss: 0.3805981
	iters: 100, epoch: 2 | loss: 0.5417231
	speed: 0.0453s/iter; left time: 77.0710s
	iters: 200, epoch: 2 | loss: 0.7316722
	speed: 0.0116s/iter; left time: 18.5457s
Updating learning rate to 0.0010229334977052702
Validation loss decreased (0.3806 --> 0.3781).  Saving model state dict ...
Epoch: 2 cost time: 3.571166515350342
Epoch: 2, Steps: 257 | Train Loss: 0.6366977 Vali Loss: 0.3780662 Best vali loss: 0.3780662
	iters: 100, epoch: 3 | loss: 0.6737656
	speed: 0.0296s/iter; left time: 42.6804s
	iters: 200, epoch: 3 | loss: 0.6619787
	speed: 0.0113s/iter; left time: 15.2393s
Updating learning rate to 0.000828532353849158
Validation loss decreased (0.3781 --> 0.3635).  Saving model state dict ...
Epoch: 3 cost time: 3.084662914276123
Epoch: 3, Steps: 257 | Train Loss: 0.6678721 Vali Loss: 0.3634988 Best vali loss: 0.3634988

best validation loss 0.36349875241927876

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0067140529486, 'e_layers': 4, 'learning_rate': 0.0011984411391, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4714501
	speed: 0.0195s/iter; left time: 23.0969s
	iters: 200, epoch: 4 | loss: 0.5867478
	speed: 0.0203s/iter; left time: 21.9947s
Updating learning rate to 0.00059922056955
Validation loss decreased (0.3635 --> 0.3626).  Saving model state dict ...
Epoch: 4 cost time: 4.501537322998047
Epoch: 4, Steps: 257 | Train Loss: 0.5290989 Vali Loss: 0.3626099 Best vali loss: 0.3626099
	iters: 100, epoch: 5 | loss: 0.5320436
	speed: 0.0328s/iter; left time: 30.5097s
	iters: 200, epoch: 5 | loss: 0.6504039
	speed: 0.0120s/iter; left time: 9.9734s
Updating learning rate to 0.000369908785250842
Validation loss decreased (0.3626 --> 0.3625).  Saving model state dict ...
Epoch: 5 cost time: 3.3649375438690186
Epoch: 5, Steps: 257 | Train Loss: 0.5912237 Vali Loss: 0.3625116 Best vali loss: 0.3625116
	iters: 100, epoch: 6 | loss: 0.5722879
	speed: 0.0280s/iter; left time: 18.8185s
	iters: 200, epoch: 6 | loss: 0.6138068
	speed: 0.0091s/iter; left time: 5.2200s
Updating learning rate to 0.0001755076413947298
Validation loss decreased (0.3625 --> 0.3561).  Saving model state dict ...
Epoch: 6 cost time: 3.1760942935943604
Epoch: 6, Steps: 257 | Train Loss: 0.5930474 Vali Loss: 0.3561387 Best vali loss: 0.3561387
	iters: 100, epoch: 7 | loss: 0.5687901
	speed: 0.0365s/iter; left time: 15.1632s
	iters: 200, epoch: 7 | loss: 0.6945292
	speed: 0.0234s/iter; left time: 7.3739s
Updating learning rate to 4.5612949882999016e-05
Validation loss decreased (0.3561 --> 0.3554).  Saving model state dict ...
Epoch: 7 cost time: 5.479490756988525
Epoch: 7, Steps: 257 | Train Loss: 0.6316597 Vali Loss: 0.3554064 Best vali loss: 0.3554064
	iters: 100, epoch: 8 | loss: 0.6635575
	speed: 0.0662s/iter; left time: 10.4557s
	iters: 200, epoch: 8 | loss: 0.3237175
	speed: 0.0266s/iter; left time: 1.5454s
Updating learning rate to 0.0
Validation loss decreased (0.3554 --> 0.3524).  Saving model state dict ...
Epoch: 8 cost time: 6.579161167144775
Epoch: 8, Steps: 257 | Train Loss: 0.4936375 Vali Loss: 0.3524369 Best vali loss: 0.3524369

best validation loss 0.3524369411477874

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0011495782693, 'e_layers': 3, 'learning_rate': 0.0004088541863, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5077450
	speed: 0.0144s/iter; left time: 116.9318s
	iters: 200, epoch: 1 | loss: 0.5955294
	speed: 0.0100s/iter; left time: 80.2346s
	iters: 300, epoch: 1 | loss: 0.4389765
	speed: 0.0144s/iter; left time: 114.1876s
	iters: 400, epoch: 1 | loss: 1.6373299
	speed: 0.0147s/iter; left time: 115.0480s
	iters: 500, epoch: 1 | loss: 0.7473505
	speed: 0.0130s/iter; left time: 100.0203s
	iters: 600, epoch: 1 | loss: 0.2904466
	speed: 0.0144s/iter; left time: 109.3886s
	iters: 700, epoch: 1 | loss: 0.3793995
	speed: 0.0150s/iter; left time: 112.4092s
	iters: 800, epoch: 1 | loss: 0.6836405
	speed: 0.0112s/iter; left time: 83.2139s
	iters: 900, epoch: 1 | loss: 1.0962497
	speed: 0.0073s/iter; left time: 53.7191s
	iters: 1000, epoch: 1 | loss: 0.9323785
	speed: 0.0072s/iter; left time: 52.0369s
Updating learning rate to 0.00039329310040206325
Validation loss decreased (inf --> 0.3799).  Saving model state dict ...
Epoch: 1 cost time: 12.101648569107056
Epoch: 1, Steps: 1027 | Train Loss: 0.7309046 Vali Loss: 0.3799434 Best vali loss: 0.3799434
	iters: 100, epoch: 2 | loss: 0.3048708
	speed: 0.0324s/iter; left time: 229.9218s
	iters: 200, epoch: 2 | loss: 0.3460038
	speed: 0.0143s/iter; left time: 100.2831s
	iters: 300, epoch: 2 | loss: 0.3389850
	speed: 0.0132s/iter; left time: 90.9440s
	iters: 400, epoch: 2 | loss: 0.6223952
	speed: 0.0106s/iter; left time: 71.7231s
	iters: 500, epoch: 2 | loss: 0.2579107
	speed: 0.0110s/iter; left time: 73.8067s
	iters: 600, epoch: 2 | loss: 0.5695136
	speed: 0.0158s/iter; left time: 104.2954s
	iters: 700, epoch: 2 | loss: 0.9875325
	speed: 0.0142s/iter; left time: 92.4300s
	iters: 800, epoch: 2 | loss: 0.3113433
	speed: 0.0144s/iter; left time: 91.9671s
	iters: 900, epoch: 2 | loss: 0.4946146
	speed: 0.0158s/iter; left time: 99.4026s
	iters: 1000, epoch: 2 | loss: 0.3565268
	speed: 0.0099s/iter; left time: 61.3566s
Updating learning rate to 0.000348978876974619
Validation loss decreased (0.3799 --> 0.3762).  Saving model state dict ...
Epoch: 2 cost time: 13.202839136123657
Epoch: 2, Steps: 1027 | Train Loss: 0.4589696 Vali Loss: 0.3761738 Best vali loss: 0.3761738
	iters: 100, epoch: 3 | loss: 0.8359874
	speed: 0.0398s/iter; left time: 241.3239s
	iters: 200, epoch: 3 | loss: 0.4695240
	speed: 0.0143s/iter; left time: 85.2595s
	iters: 300, epoch: 3 | loss: 0.2697851
	speed: 0.0156s/iter; left time: 91.3418s
	iters: 400, epoch: 3 | loss: 0.2134167
	speed: 0.0134s/iter; left time: 77.4518s
	iters: 500, epoch: 3 | loss: 0.8716785
	speed: 0.0129s/iter; left time: 73.0841s
	iters: 600, epoch: 3 | loss: 0.3276251
	speed: 0.0149s/iter; left time: 83.0766s
	iters: 700, epoch: 3 | loss: 0.2672764
	speed: 0.0112s/iter; left time: 61.1469s
	iters: 800, epoch: 3 | loss: 0.2688520
	speed: 0.0109s/iter; left time: 58.5674s
	iters: 900, epoch: 3 | loss: 0.2984236
	speed: 0.0124s/iter; left time: 65.1110s
	iters: 1000, epoch: 3 | loss: 1.2894528
	speed: 0.0124s/iter; left time: 64.0768s
Updating learning rate to 0.00028265795482505996
Validation loss decreased (0.3762 --> 0.3573).  Saving model state dict ...
Epoch: 3 cost time: 13.686893939971924
Epoch: 3, Steps: 1027 | Train Loss: 0.5112022 Vali Loss: 0.3572926 Best vali loss: 0.3572926
	iters: 100, epoch: 4 | loss: 0.6353679
	speed: 0.0313s/iter; left time: 157.4263s
	iters: 200, epoch: 4 | loss: 0.2824398
	speed: 0.0102s/iter; left time: 50.2653s
	iters: 300, epoch: 4 | loss: 0.9023317
	speed: 0.0105s/iter; left time: 50.8268s
	iters: 400, epoch: 4 | loss: 1.0888325
	speed: 0.0097s/iter; left time: 45.7144s
	iters: 500, epoch: 4 | loss: 1.3242958
	speed: 0.0090s/iter; left time: 41.8321s
	iters: 600, epoch: 4 | loss: 0.2762922
	speed: 0.0087s/iter; left time: 39.5281s
	iters: 700, epoch: 4 | loss: 0.3652131
	speed: 0.0067s/iter; left time: 29.8835s
	iters: 800, epoch: 4 | loss: 0.2983213
	speed: 0.0057s/iter; left time: 24.9316s
	iters: 900, epoch: 4 | loss: 0.6183928
	speed: 0.0077s/iter; left time: 32.4058s
	iters: 1000, epoch: 4 | loss: 0.3606545
	speed: 0.0075s/iter; left time: 30.8411s
Updating learning rate to 0.00020442709315
Validation loss decreased (0.3573 --> 0.3541).  Saving model state dict ...
Epoch: 4 cost time: 8.690014839172363
Epoch: 4, Steps: 1027 | Train Loss: 0.6152142 Vali Loss: 0.3540586 Best vali loss: 0.3540586
	iters: 100, epoch: 5 | loss: 1.0270022
	speed: 0.0206s/iter; left time: 82.4959s
	iters: 200, epoch: 5 | loss: 0.2875950
	speed: 0.0116s/iter; left time: 45.3973s
	iters: 300, epoch: 5 | loss: 1.1790050
	speed: 0.0101s/iter; left time: 38.4332s
	iters: 400, epoch: 5 | loss: 0.4128001
	speed: 0.0101s/iter; left time: 37.4305s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0084246134311, 'e_layers': 2, 'learning_rate': 0.000337778408, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5298718
	speed: 0.0206s/iter; left time: 19.2335s
Updating learning rate to 0.000337778408
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 1.978708267211914
Epoch: 1, Steps: 129 | Train Loss: 0.5298718 Vali Loss: 0.3663016 Best vali loss: 0.3663016
	iters: 100, epoch: 2 | loss: 0.6163552
	speed: 0.0132s/iter; left time: 10.6180s
Updating learning rate to 0.000168889204
Validation loss decreased (0.3663 --> 0.3531).  Saving model state dict ...
Epoch: 2 cost time: 1.2267050743103027
Epoch: 2, Steps: 129 | Train Loss: 0.6163552 Vali Loss: 0.3531133 Best vali loss: 0.3531133
	iters: 100, epoch: 3 | loss: 0.7484340
	speed: 0.0214s/iter; left time: 14.4643s
Updating learning rate to 8.4444602e-05
Epoch: 3 cost time: 1.826986312866211
Epoch: 3, Steps: 129 | Train Loss: 0.7484340 Vali Loss: 0.3714860 Best vali loss: 0.3531133
	iters: 100, epoch: 4 | loss: 0.3017621
	speed: 0.0223s/iter; left time: 12.2021s
Updating learning rate to 4.2222301e-05
Epoch: 4 cost time: 1.571296215057373
Epoch: 4, Steps: 129 | Train Loss: 0.3017621 Vali Loss: 0.3577948 Best vali loss: 0.3531133
	iters: 100, epoch: 5 | loss: 0.3929015
	speed: 0.0224s/iter; left time: 9.3300s
Updating learning rate to 2.11111505e-05
Epoch: 5 cost time: 1.7882225513458252
Epoch: 5, Steps: 129 | Train Loss: 0.3929015 Vali Loss: 0.3589912 Best vali loss: 0.3531133
	iters: 100, epoch: 6 | loss: 0.4542593
	speed: 0.0230s/iter; left time: 6.6262s
Updating learning rate to 1.055557525e-05
Epoch: 6 cost time: 2.073063373565674
Epoch: 6, Steps: 129 | Train Loss: 0.4542593 Vali Loss: 0.3625281 Best vali loss: 0.3531133
	iters: 100, epoch: 7 | loss: 0.4480886
	speed: 0.0390s/iter; left time: 6.2025s
Updating learning rate to 5.277787625e-06
Epoch: 7 cost time: 2.6892342567443848
Epoch: 7, Steps: 129 | Train Loss: 0.4480886 Vali Loss: 0.3580672 Best vali loss: 0.3531133
	iters: 100, epoch: 8 | loss: 0.3141112
	speed: 0.0227s/iter; left time: 0.6799s
Updating learning rate to 2.6388938125e-06
Epoch: 8 cost time: 1.6711575984954834
Epoch: 8, Steps: 129 | Train Loss: 0.3141112 Vali Loss: 0.3585308 Best vali loss: 0.3531133

best validation loss 0.35311331866063866

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0042142753194, 'e_layers': 1, 'learning_rate': 0.0005493796823, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005493796823
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 0.8469622135162354
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3692078 Best vali loss: 0.3692078
Updating learning rate to 0.00027468984115
Epoch: 2 cost time: 0.5186553001403809
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3727518 Best vali loss: 0.3692078
Updating learning rate to 0.000137344920575
Epoch: 3 cost time: 0.5155520439147949
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3728255 Best vali loss: 0.3692078

best validation loss 0.3692077850780225

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011869092877, 'e_layers': 4, 'learning_rate': 0.0006116296897, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005883509207450297
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 1.3388218879699707
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3695611 Best vali loss: 0.3695611
Updating learning rate to 0.0005220585954309469
Validation loss decreased (0.3696 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 1.2780146598815918
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3629694 Best vali loss: 0.3629694
Updating learning rate to 0.00042284511934539536
Validation loss decreased (0.3630 --> 0.3547).  Saving model state dict ...
Epoch: 3 cost time: 1.2484800815582275
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3547371 Best vali loss: 0.3547371

best validation loss 0.35473709145088794

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0024158334153, 'e_layers': 4, 'learning_rate': 5.15091965e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8042945
	speed: 0.0219s/iter; left time: 20.4114s
Updating learning rate to 4.9548744441226004e-05
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 2.404837131500244
Epoch: 1, Steps: 129 | Train Loss: 0.8042945 Vali Loss: 0.3692506 Best vali loss: 0.3692506
	iters: 100, epoch: 2 | loss: 0.7654445
	speed: 0.0258s/iter; left time: 20.7109s
Updating learning rate to 4.396584931931019e-05
Validation loss decreased (0.3693 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 2.131451368331909
Epoch: 2, Steps: 129 | Train Loss: 0.7654445 Vali Loss: 0.3642737 Best vali loss: 0.3642737
	iters: 100, epoch: 3 | loss: 0.6330665
	speed: 0.0256s/iter; left time: 17.2571s
Updating learning rate to 3.561045630749393e-05
Epoch: 3 cost time: 2.2614262104034424
Epoch: 3, Steps: 129 | Train Loss: 0.6330665 Vali Loss: 0.3673823 Best vali loss: 0.3642737

best validation loss 0.36427373589841694

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011869092877, 'e_layers': 4, 'learning_rate': 0.0006116296897, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00030581484485
Validation loss decreased (0.3547 --> 0.3447).  Saving model state dict ...
Epoch: 4 cost time: 1.6691954135894775
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3446938 Best vali loss: 0.3446938
Updating learning rate to 0.0001887845703546046
Epoch: 5 cost time: 1.6837208271026611
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3551459 Best vali loss: 0.3446938
Updating learning rate to 8.957109426905308e-05
Epoch: 6 cost time: 1.1887142658233643
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3493459 Best vali loss: 0.3446938
Updating learning rate to 2.3278768954970312e-05
Epoch: 7 cost time: 1.3057503700256348
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3618413 Best vali loss: 0.3446938
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3509917259216309
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3593088 Best vali loss: 0.3446938

best validation loss 0.3446937824864753

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003920399489, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003920399489
Validation loss decreased (inf --> 0.3652).  Saving model state dict ...
Epoch: 1 cost time: 1.5833375453948975
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3651900 Best vali loss: 0.3651900
Updating learning rate to 0.00019601997445
Validation loss decreased (0.3652 --> 0.3628).  Saving model state dict ...
Epoch: 2 cost time: 1.2231693267822266
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3627687 Best vali loss: 0.3627687
Updating learning rate to 9.8009987225e-05
Validation loss decreased (0.3628 --> 0.3581).  Saving model state dict ...
Epoch: 3 cost time: 1.1257851123809814
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3580555 Best vali loss: 0.3580555
Updating learning rate to 4.90049936125e-05
Epoch: 4 cost time: 0.9269320964813232
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3645109 Best vali loss: 0.3580555
Updating learning rate to 2.450249680625e-05
Epoch: 5 cost time: 1.4862325191497803
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3594681 Best vali loss: 0.3580555
Updating learning rate to 1.2251248403125e-05
Epoch: 6 cost time: 1.6171977519989014
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3583175 Best vali loss: 0.3580555
Updating learning rate to 6.1256242015625e-06
Validation loss decreased (0.3581 --> 0.3571).  Saving model state dict ...
Epoch: 7 cost time: 0.8038442134857178
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3571083 Best vali loss: 0.3571083
Updating learning rate to 3.06281210078125e-06
Epoch: 8 cost time: 1.664729356765747
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3587965 Best vali loss: 0.3571083

best validation loss 0.3571083475072632

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0009370256828, 'e_layers': 1, 'learning_rate': 5.98025299e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.7526431633502125e-05
Validation loss decreased (inf --> 0.4412).  Saving model state dict ...
Epoch: 1 cost time: 1.7570884227752686
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4411730 Best vali loss: 0.4411730
Updating learning rate to 5.104465216220063e-05
Validation loss decreased (0.4412 --> 0.4332).  Saving model state dict ...
Epoch: 2 cost time: 1.3559350967407227
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4332280 Best vali loss: 0.4332280
Updating learning rate to 4.1343983653123954e-05
Validation loss decreased (0.4332 --> 0.4270).  Saving model state dict ...
Epoch: 3 cost time: 1.6397483348846436
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4269778 Best vali loss: 0.4269778
Updating learning rate to 2.990126495e-05
Validation loss decreased (0.4270 --> 0.4226).  Saving model state dict ...
Epoch: 4 cost time: 1.4626789093017578
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4226484 Best vali loss: 0.4226484
Updating learning rate to 1.8458546246876045e-05
Validation loss decreased (0.4226 --> 0.4196).  Saving model state dict ...
Epoch: 5 cost time: 1.5383083820343018
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4195969 Best vali loss: 0.4195969
Updating learning rate to 8.757877737799368e-06
Validation loss decreased (0.4196 --> 0.4178).  Saving model state dict ...
Epoch: 6 cost time: 1.0936815738677979
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4178291 Best vali loss: 0.4178291
Updating learning rate to 2.276098266497876e-06
Validation loss decreased (0.4178 --> 0.4170).  Saving model state dict ...
Epoch: 7 cost time: 0.6213657855987549
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4170109 Best vali loss: 0.4170109
Updating learning rate to 0.0
Validation loss decreased (0.4170 --> 0.4168).  Saving model state dict ...
Epoch: 8 cost time: 0.5984537601470947
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4168001 Best vali loss: 0.4168001

best validation loss 0.4168001100333126

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032174734801, 'e_layers': 1, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8325168
	speed: 0.0218s/iter; left time: 42.6452s
	iters: 200, epoch: 1 | loss: 0.9267629
	speed: 0.0111s/iter; left time: 20.6720s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.3861).  Saving model state dict ...
Epoch: 1 cost time: 3.671447277069092
Epoch: 1, Steps: 257 | Train Loss: 0.8796398 Vali Loss: 0.3860565 Best vali loss: 0.3860565
	iters: 100, epoch: 2 | loss: 0.4418711
	speed: 0.0304s/iter; left time: 51.7282s
	iters: 200, epoch: 2 | loss: 0.3049630
	speed: 0.0094s/iter; left time: 14.9862s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.3861 --> 0.3701).  Saving model state dict ...
Epoch: 2 cost time: 2.668165445327759
Epoch: 2, Steps: 257 | Train Loss: 0.3734171 Vali Loss: 0.3701385 Best vali loss: 0.3701385
	iters: 100, epoch: 3 | loss: 0.9375229
	speed: 0.0211s/iter; left time: 30.4277s
	iters: 200, epoch: 3 | loss: 0.5800354
	speed: 0.0087s/iter; left time: 11.7424s
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.3701 --> 0.3678).  Saving model state dict ...
Epoch: 3 cost time: 2.329261064529419
Epoch: 3, Steps: 257 | Train Loss: 0.7587792 Vali Loss: 0.3678106 Best vali loss: 0.3678106

best validation loss 0.36781060384158304

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0048029309342, 'e_layers': 3, 'learning_rate': 0.0041360832156, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2323347
	speed: 0.0217s/iter; left time: 176.3951s
	iters: 200, epoch: 1 | loss: 0.4077870
	speed: 0.0154s/iter; left time: 123.0655s
	iters: 300, epoch: 1 | loss: 0.7525278
	speed: 0.0161s/iter; left time: 127.0956s
	iters: 400, epoch: 1 | loss: 0.4207186
	speed: 0.0097s/iter; left time: 75.7348s
	iters: 500, epoch: 1 | loss: 1.9962094
	speed: 0.0119s/iter; left time: 91.7661s
	iters: 600, epoch: 1 | loss: 0.4603496
	speed: 0.0072s/iter; left time: 55.0163s
	iters: 700, epoch: 1 | loss: 1.2138735
	speed: 0.0054s/iter; left time: 40.8951s
	iters: 800, epoch: 1 | loss: 0.3525763
	speed: 0.0061s/iter; left time: 45.2093s
	iters: 900, epoch: 1 | loss: 0.3499473
	speed: 0.0074s/iter; left time: 54.3387s
	iters: 1000, epoch: 1 | loss: 1.0079622
	speed: 0.0075s/iter; left time: 53.9926s
Updating learning rate to 0.0041360832156
Validation loss decreased (inf --> 0.4032).  Saving model state dict ...
Epoch: 1 cost time: 10.75438380241394
Epoch: 1, Steps: 1027 | Train Loss: 0.7194286 Vali Loss: 0.4031577 Best vali loss: 0.4031577
	iters: 100, epoch: 2 | loss: 1.3652966
	speed: 0.0220s/iter; left time: 155.7935s
	iters: 200, epoch: 2 | loss: 0.3457215
	speed: 0.0070s/iter; left time: 48.7907s
	iters: 300, epoch: 2 | loss: 0.3927785
	speed: 0.0074s/iter; left time: 51.1008s
	iters: 400, epoch: 2 | loss: 1.1769762
	speed: 0.0070s/iter; left time: 47.3015s
	iters: 500, epoch: 2 | loss: 0.6206217
	speed: 0.0067s/iter; left time: 44.8818s
	iters: 600, epoch: 2 | loss: 0.6000526
	speed: 0.0061s/iter; left time: 40.2335s
	iters: 700, epoch: 2 | loss: 0.3174748
	speed: 0.0065s/iter; left time: 42.2786s
	iters: 800, epoch: 2 | loss: 0.4540305
	speed: 0.0068s/iter; left time: 43.5988s
	iters: 900, epoch: 2 | loss: 0.3487465
	speed: 0.0079s/iter; left time: 49.3839s
	iters: 1000, epoch: 2 | loss: 0.2965547
	speed: 0.0084s/iter; left time: 51.9254s
Updating learning rate to 0.0020680416078
Validation loss decreased (0.4032 --> 0.4026).  Saving model state dict ...
Epoch: 2 cost time: 7.38469934463501
Epoch: 2, Steps: 1027 | Train Loss: 0.5918254 Vali Loss: 0.4026237 Best vali loss: 0.4026237
	iters: 100, epoch: 3 | loss: 0.4383711
	speed: 0.0237s/iter; left time: 143.5858s
	iters: 200, epoch: 3 | loss: 0.3358589
	speed: 0.0075s/iter; left time: 44.7245s
	iters: 300, epoch: 3 | loss: 0.3495612
	speed: 0.0078s/iter; left time: 45.8286s
	iters: 400, epoch: 3 | loss: 0.2369213
	speed: 0.0083s/iter; left time: 47.5680s
	iters: 500, epoch: 3 | loss: 1.0413684
	speed: 0.0084s/iter; left time: 47.6396s
	iters: 600, epoch: 3 | loss: 0.9931890
	speed: 0.0081s/iter; left time: 44.8887s
	iters: 700, epoch: 3 | loss: 0.6549729
	speed: 0.0076s/iter; left time: 41.7287s
	iters: 800, epoch: 3 | loss: 0.2565709
	speed: 0.0083s/iter; left time: 44.4857s
	iters: 900, epoch: 3 | loss: 0.2745982
	speed: 0.0083s/iter; left time: 43.8250s
	iters: 1000, epoch: 3 | loss: 0.3828648
	speed: 0.0076s/iter; left time: 39.1742s
Updating learning rate to 0.0010340208039
Epoch: 3 cost time: 8.234923839569092
Epoch: 3, Steps: 1027 | Train Loss: 0.4964277 Vali Loss: 0.4053221 Best vali loss: 0.4026237

best validation loss 0.40262369758253713

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0018123888695, 'e_layers': 4, 'learning_rate': 0.0001970993665, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7100139
	speed: 0.0154s/iter; left time: 14.3265s
Updating learning rate to 0.0001970993665
Validation loss decreased (inf --> 0.3984).  Saving model state dict ...
Epoch: 1 cost time: 1.4824762344360352
Epoch: 1, Steps: 129 | Train Loss: 0.7100139 Vali Loss: 0.3984053 Best vali loss: 0.3984053
	iters: 100, epoch: 2 | loss: 0.7923861
	speed: 0.0147s/iter; left time: 11.8185s
Updating learning rate to 9.854968325e-05
Validation loss decreased (0.3984 --> 0.3822).  Saving model state dict ...
Epoch: 2 cost time: 1.215463638305664
Epoch: 2, Steps: 129 | Train Loss: 0.7923861 Vali Loss: 0.3822201 Best vali loss: 0.3822201
	iters: 100, epoch: 3 | loss: 0.6439943
	speed: 0.0155s/iter; left time: 10.4446s
Updating learning rate to 4.9274841625e-05
Validation loss decreased (0.3822 --> 0.3806).  Saving model state dict ...
Epoch: 3 cost time: 1.251488208770752
Epoch: 3, Steps: 129 | Train Loss: 0.6439943 Vali Loss: 0.3805681 Best vali loss: 0.3805681

best validation loss 0.3805681111770435

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032174734801, 'e_layers': 1, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7847860
	speed: 0.0124s/iter; left time: 14.7150s
	iters: 200, epoch: 4 | loss: 0.8313257
	speed: 0.0054s/iter; left time: 5.8634s
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 1.7349810600280762
Epoch: 4, Steps: 257 | Train Loss: 0.8080558 Vali Loss: 0.3705390 Best vali loss: 0.3678106
	iters: 100, epoch: 5 | loss: 0.3142095
	speed: 0.0134s/iter; left time: 12.4378s
	iters: 200, epoch: 5 | loss: 0.2948298
	speed: 0.0054s/iter; left time: 4.4727s
Updating learning rate to 9.118741539478246e-05
Epoch: 5 cost time: 1.5525908470153809
Epoch: 5, Steps: 257 | Train Loss: 0.3045196 Vali Loss: 0.3692822 Best vali loss: 0.3678106
	iters: 100, epoch: 6 | loss: 0.8643643
	speed: 0.0228s/iter; left time: 15.3371s
	iters: 200, epoch: 6 | loss: 0.5680654
	speed: 0.0109s/iter; left time: 6.2517s
Updating learning rate to 4.326495838688198e-05
Epoch: 6 cost time: 2.708683490753174
Epoch: 6, Steps: 257 | Train Loss: 0.7162149 Vali Loss: 0.3688084 Best vali loss: 0.3678106
	iters: 100, epoch: 7 | loss: 0.3065298
	speed: 0.0298s/iter; left time: 12.3576s
	iters: 200, epoch: 7 | loss: 0.5294786
	speed: 0.0147s/iter; left time: 4.6432s
Updating learning rate to 1.124419633759687e-05
Epoch: 7 cost time: 3.7494900226593018
Epoch: 7, Steps: 257 | Train Loss: 0.4180042 Vali Loss: 0.3688751 Best vali loss: 0.3678106
	iters: 100, epoch: 8 | loss: 0.6682600
	speed: 0.0387s/iter; left time: 6.1098s
	iters: 200, epoch: 8 | loss: 0.2958212
	speed: 0.0115s/iter; left time: 0.6666s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.16941499710083
Epoch: 8, Steps: 257 | Train Loss: 0.4820406 Vali Loss: 0.3695691 Best vali loss: 0.3678106

best validation loss 0.36781060384158304

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0013503779473, 'e_layers': 3, 'learning_rate': 0.0001206404714, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5222012
	speed: 0.0198s/iter; left time: 18.4377s
Updating learning rate to 0.00011604886685948663
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 2.0701534748077393
Epoch: 1, Steps: 129 | Train Loss: 0.5222012 Vali Loss: 0.3665786 Best vali loss: 0.3665786
	iters: 100, epoch: 2 | loss: 0.4674361
	speed: 0.0225s/iter; left time: 18.1022s
Updating learning rate to 0.00010297308340624088
Validation loss decreased (0.3666 --> 0.3609).  Saving model state dict ...
Epoch: 2 cost time: 1.8485898971557617
Epoch: 2, Steps: 129 | Train Loss: 0.4674361 Vali Loss: 0.3609139 Best vali loss: 0.3609139
	iters: 100, epoch: 3 | loss: 0.4097193
	speed: 0.0253s/iter; left time: 17.0662s
Updating learning rate to 8.340379053874723e-05
Epoch: 3 cost time: 2.0948705673217773
Epoch: 3, Steps: 129 | Train Loss: 0.4097193 Vali Loss: 0.3677710 Best vali loss: 0.3609139
	iters: 100, epoch: 4 | loss: 0.5847020
	speed: 0.0284s/iter; left time: 15.5321s
Updating learning rate to 6.03202357e-05
Validation loss decreased (0.3609 --> 0.3567).  Saving model state dict ...
Epoch: 4 cost time: 1.9758000373840332
Epoch: 4, Steps: 129 | Train Loss: 0.5847020 Vali Loss: 0.3566906 Best vali loss: 0.3566906
	iters: 100, epoch: 5 | loss: 0.6259030
	speed: 0.0222s/iter; left time: 9.2526s
Updating learning rate to 3.723668086125278e-05
Epoch: 5 cost time: 1.8849239349365234
Epoch: 5, Steps: 129 | Train Loss: 0.6259030 Vali Loss: 0.3631047 Best vali loss: 0.3566906
	iters: 100, epoch: 6 | loss: 0.3781359
	speed: 0.0232s/iter; left time: 6.6945s
Updating learning rate to 1.7667387993759133e-05
Epoch: 6 cost time: 1.890601396560669
Epoch: 6, Steps: 129 | Train Loss: 0.3781359 Vali Loss: 0.3601363 Best vali loss: 0.3566906
	iters: 100, epoch: 7 | loss: 0.3400902
	speed: 0.0328s/iter; left time: 5.2195s
Updating learning rate to 4.591604540513372e-06
Epoch: 7 cost time: 2.2520039081573486
Epoch: 7, Steps: 129 | Train Loss: 0.3400902 Vali Loss: 0.3628909 Best vali loss: 0.3566906
	iters: 100, epoch: 8 | loss: 0.6086395
	speed: 0.0243s/iter; left time: 0.7297s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.614260196685791
Epoch: 8, Steps: 129 | Train Loss: 0.6086395 Vali Loss: 0.3639051 Best vali loss: 0.3566906

best validation loss 0.35669056521417586

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.001776105869, 'e_layers': 2, 'learning_rate': 0.0032448267506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0445920
	speed: 0.0161s/iter; left time: 130.8862s
	iters: 200, epoch: 1 | loss: 0.5805833
	speed: 0.0083s/iter; left time: 66.3400s
	iters: 300, epoch: 1 | loss: 1.0209522
	speed: 0.0071s/iter; left time: 56.1678s
	iters: 400, epoch: 1 | loss: 0.4203682
	speed: 0.0084s/iter; left time: 65.3372s
	iters: 500, epoch: 1 | loss: 1.8074775
	speed: 0.0079s/iter; left time: 61.3105s
	iters: 600, epoch: 1 | loss: 0.4418423
	speed: 0.0076s/iter; left time: 58.0296s
	iters: 700, epoch: 1 | loss: 0.4435659
	speed: 0.0096s/iter; left time: 72.0778s
	iters: 800, epoch: 1 | loss: 0.4121759
	speed: 0.0092s/iter; left time: 68.0213s
	iters: 900, epoch: 1 | loss: 0.6556159
	speed: 0.0082s/iter; left time: 60.0917s
	iters: 1000, epoch: 1 | loss: 0.8287277
	speed: 0.0082s/iter; left time: 59.5384s
Updating learning rate to 0.0032448267506
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 8.994651317596436
Epoch: 1, Steps: 1027 | Train Loss: 0.7655901 Vali Loss: 0.3775217 Best vali loss: 0.3775217
	iters: 100, epoch: 2 | loss: 0.5119624
	speed: 0.0268s/iter; left time: 190.0027s
	iters: 200, epoch: 2 | loss: 0.8822286
	speed: 0.0085s/iter; left time: 59.4432s
	iters: 300, epoch: 2 | loss: 1.1148744
	speed: 0.0088s/iter; left time: 60.9476s
	iters: 400, epoch: 2 | loss: 0.6748281
	speed: 0.0089s/iter; left time: 60.2988s
	iters: 500, epoch: 2 | loss: 1.0846578
	speed: 0.0082s/iter; left time: 55.0147s
	iters: 600, epoch: 2 | loss: 1.2421547
	speed: 0.0077s/iter; left time: 50.6111s
	iters: 700, epoch: 2 | loss: 1.9697983
	speed: 0.0079s/iter; left time: 51.5174s
	iters: 800, epoch: 2 | loss: 0.4241122
	speed: 0.0071s/iter; left time: 45.4441s
	iters: 900, epoch: 2 | loss: 0.8079172
	speed: 0.0079s/iter; left time: 49.4670s
	iters: 1000, epoch: 2 | loss: 0.5007694
	speed: 0.0086s/iter; left time: 53.1381s
Updating learning rate to 0.0016224133753
Epoch: 2 cost time: 8.503115177154541
Epoch: 2, Steps: 1027 | Train Loss: 0.9213303 Vali Loss: 0.3798982 Best vali loss: 0.3775217
	iters: 100, epoch: 3 | loss: 0.5448906
	speed: 0.0288s/iter; left time: 174.8328s
	iters: 200, epoch: 3 | loss: 0.4059561
	speed: 0.0083s/iter; left time: 49.6190s
	iters: 300, epoch: 3 | loss: 0.3415119
	speed: 0.0086s/iter; left time: 50.4618s
	iters: 400, epoch: 3 | loss: 0.5122293
	speed: 0.0079s/iter; left time: 45.7841s
	iters: 500, epoch: 3 | loss: 0.1878632
	speed: 0.0071s/iter; left time: 39.9295s
	iters: 600, epoch: 3 | loss: 0.5444468
	speed: 0.0061s/iter; left time: 34.2030s
	iters: 700, epoch: 3 | loss: 0.4457394
	speed: 0.0067s/iter; left time: 36.6860s
	iters: 800, epoch: 3 | loss: 0.6456336
	speed: 0.0083s/iter; left time: 44.3602s
	iters: 900, epoch: 3 | loss: 0.6675194
	speed: 0.0076s/iter; left time: 40.1437s
	iters: 1000, epoch: 3 | loss: 0.1726125
	speed: 0.0065s/iter; left time: 33.6383s
Updating learning rate to 0.00081120668765
Validation loss decreased (0.3775 --> 0.3733).  Saving model state dict ...
Epoch: 3 cost time: 7.685199737548828
Epoch: 3, Steps: 1027 | Train Loss: 0.4468403 Vali Loss: 0.3733178 Best vali loss: 0.3733178
	iters: 100, epoch: 4 | loss: 0.2667139
	speed: 0.0231s/iter; left time: 116.1596s
	iters: 200, epoch: 4 | loss: 1.2582841
	speed: 0.0085s/iter; left time: 41.8505s
	iters: 300, epoch: 4 | loss: 0.5894652
	speed: 0.0080s/iter; left time: 38.5304s
	iters: 400, epoch: 4 | loss: 0.3601105
	speed: 0.0087s/iter; left time: 41.2660s
	iters: 500, epoch: 4 | loss: 0.3439522
	speed: 0.0087s/iter; left time: 40.1326s
	iters: 600, epoch: 4 | loss: 0.9604709
	speed: 0.0089s/iter; left time: 40.3187s
	iters: 700, epoch: 4 | loss: 0.4283614
	speed: 0.0071s/iter; left time: 31.6024s
	iters: 800, epoch: 4 | loss: 0.6033052
	speed: 0.0066s/iter; left time: 28.4991s
	iters: 900, epoch: 4 | loss: 0.4624780
	speed: 0.0083s/iter; left time: 35.2644s
	iters: 1000, epoch: 4 | loss: 0.3922193
	speed: 0.0086s/iter; left time: 35.3859s
Updating learning rate to 0.000405603343825
Epoch: 4 cost time: 8.437949419021606
Epoch: 4, Steps: 1027 | Train Loss: 0.5665361 Vali Loss: 0.3845577 Best vali loss: 0.3733178
	iters: 100, epoch: 5 | loss: 1.1243201
	speed: 0.0280s/iter; left time: 112.4061s
	iters: 200, epoch: 5 | loss: 0.4549736
	speed: 0.0082s/iter; left time: 31.9591s
	iters: 300, epoch: 5 | loss: 1.2875208
	speed: 0.0077s/iter; left time: 29.1725s
	iters: 400, epoch: 5 | loss: 0.3936636
	speed: 0.0070s/iter; left time: 25.9982s
	iters: 500, epoch: 5 | loss: 0.3432638
	speed: 0.0080s/iter; left time: 28.8066s
	iters: 600, epoch: 5 | loss: 0.6326272
	speed: 0.0080s/iter; left time: 28.2236s
	iters: 700, epoch: 5 | loss: 0.3902833
	speed: 0.0085s/iter; left time: 28.8534s
	iters: 800, epoch: 5 | loss: 0.5098778
	speed: 0.0088s/iter; left time: 28.9901s
	iters: 900, epoch: 5 | loss: 0.4142926
	speed: 0.0086s/iter; left time: 27.6369s
	iters: 1000, epoch: 5 | loss: 0.6477662
	speed: 0.0082s/iter; left time: 25.5418s
Updating learning rate to 0.0002028016719125
Epoch: 5 cost time: 8.409427165985107
Epoch: 5, Steps: 1027 | Train Loss: 0.6198589 Vali Loss: 0.3977758 Best vali loss: 0.3733178
	iters: 100, epoch: 6 | loss: 1.0526156
	speed: 0.0258s/iter; left time: 76.8238s
	iters: 200, epoch: 6 | loss: 0.2757222
	speed: 0.0085s/iter; left time: 24.5691s
	iters: 300, epoch: 6 | loss: 0.6709780
	speed: 0.0085s/iter; left time: 23.6001s
	iters: 400, epoch: 6 | loss: 0.7697828
	speed: 0.0086s/iter; left time: 23.1179s
	iters: 500, epoch: 6 | loss: 0.3485005
	speed: 0.0086s/iter; left time: 22.2490s
	iters: 600, epoch: 6 | loss: 0.2966864
	speed: 0.0079s/iter; left time: 19.4991s
	iters: 700, epoch: 6 | loss: 0.3613750
	speed: 0.0079s/iter; left time: 18.8034s
	iters: 800, epoch: 6 | loss: 0.5286965
	speed: 0.0078s/iter; left time: 17.8532s
	iters: 900, epoch: 6 | loss: 0.8391230
	speed: 0.0067s/iter; left time: 14.5851s
	iters: 1000, epoch: 6 | loss: 1.0973502
	speed: 0.0077s/iter; left time: 16.0622s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0039792071051, 'e_layers': 4, 'learning_rate': 0.0015522577592, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014931784660533567
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 1.278188943862915
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3701259 Best vali loss: 0.3701259
Updating learning rate to 0.0013249348734398773
Epoch: 2 cost time: 0.8207736015319824
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3719053 Best vali loss: 0.3701259
Updating learning rate to 0.0010731405432029995
Epoch: 3 cost time: 0.7393622398376465
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3706633 Best vali loss: 0.3701259

best validation loss 0.3701258903636445

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.001507338874, 'e_layers': 4, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5726559
	speed: 0.0334s/iter; left time: 31.1896s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 4.031672477722168
Epoch: 1, Steps: 129 | Train Loss: 0.5726559 Vali Loss: 0.3714553 Best vali loss: 0.3714553
	iters: 100, epoch: 2 | loss: 0.6973607
	speed: 0.0661s/iter; left time: 53.1535s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.3715 --> 0.3635).  Saving model state dict ...
Epoch: 2 cost time: 4.457231521606445
Epoch: 2, Steps: 129 | Train Loss: 0.6973607 Vali Loss: 0.3635153 Best vali loss: 0.3635153
	iters: 100, epoch: 3 | loss: 0.5568007
	speed: 0.0604s/iter; left time: 40.7959s
Updating learning rate to 1.70765195e-05
Validation loss decreased (0.3635 --> 0.3633).  Saving model state dict ...
Epoch: 3 cost time: 4.31996488571167
Epoch: 3, Steps: 129 | Train Loss: 0.5568007 Vali Loss: 0.3633347 Best vali loss: 0.3633347

best validation loss 0.36333474186642467

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0011651101235, 'e_layers': 4, 'learning_rate': 0.0001196858658, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5736749
	speed: 0.0320s/iter; left time: 62.6957s
	iters: 200, epoch: 1 | loss: 0.5933655
	speed: 0.0246s/iter; left time: 45.6319s
Updating learning rate to 0.00011513059377175631
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 6.575561761856079
Epoch: 1, Steps: 257 | Train Loss: 0.5835202 Vali Loss: 0.3694876 Best vali loss: 0.3694876
	iters: 100, epoch: 2 | loss: 0.7081512
	speed: 0.0711s/iter; left time: 120.8515s
	iters: 200, epoch: 2 | loss: 0.3614867
	speed: 0.0231s/iter; left time: 36.8948s
Updating learning rate to 0.00010215827655968155
Validation loss decreased (0.3695 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 5.992327690124512
Epoch: 2, Steps: 257 | Train Loss: 0.5348189 Vali Loss: 0.3672784 Best vali loss: 0.3672784
	iters: 100, epoch: 3 | loss: 0.4641929
	speed: 0.0723s/iter; left time: 104.2723s
	iters: 200, epoch: 3 | loss: 0.9411845
	speed: 0.0218s/iter; left time: 29.2882s
Updating learning rate to 8.274383186496576e-05
Validation loss decreased (0.3673 --> 0.3642).  Saving model state dict ...
Epoch: 3 cost time: 5.451614141464233
Epoch: 3, Steps: 257 | Train Loss: 0.7026887 Vali Loss: 0.3642325 Best vali loss: 0.3642325

best validation loss 0.3642325057964662

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.001507338874, 'e_layers': 4, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5484017
	speed: 0.0256s/iter; left time: 13.9619s
Updating learning rate to 8.53825975e-06
Epoch: 4 cost time: 2.6830649375915527
Epoch: 4, Steps: 129 | Train Loss: 0.5484017 Vali Loss: 0.3637097 Best vali loss: 0.3633347
	iters: 100, epoch: 5 | loss: 0.6817633
	speed: 0.0210s/iter; left time: 8.7495s
Updating learning rate to 4.269129875e-06
Validation loss decreased (0.3633 --> 0.3632).  Saving model state dict ...
Epoch: 5 cost time: 1.5677223205566406
Epoch: 5, Steps: 129 | Train Loss: 0.6817633 Vali Loss: 0.3632167 Best vali loss: 0.3632167
	iters: 100, epoch: 6 | loss: 0.5459907
	speed: 0.0191s/iter; left time: 5.4978s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 1.6796541213989258
Epoch: 6, Steps: 129 | Train Loss: 0.5459907 Vali Loss: 0.3633339 Best vali loss: 0.3632167
	iters: 100, epoch: 7 | loss: 0.6994913
	speed: 0.0210s/iter; left time: 3.3351s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 1.5973436832427979
Epoch: 7, Steps: 129 | Train Loss: 0.6994913 Vali Loss: 0.3633462 Best vali loss: 0.3632167
	iters: 100, epoch: 8 | loss: 0.6483502
	speed: 0.0181s/iter; left time: 0.5430s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 1.5324480533599854
Epoch: 8, Steps: 129 | Train Loss: 0.6483502 Vali Loss: 0.3633609 Best vali loss: 0.3632167

best validation loss 0.3632166922443742

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0014886121307, 'e_layers': 1, 'learning_rate': 8.87995762e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.87995762e-05
Validation loss decreased (inf --> 0.4077).  Saving model state dict ...
Epoch: 1 cost time: 0.8420462608337402
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4076647 Best vali loss: 0.4076647
Updating learning rate to 4.43997881e-05
Validation loss decreased (0.4077 --> 0.3871).  Saving model state dict ...
Epoch: 2 cost time: 0.8745996952056885
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3871028 Best vali loss: 0.3871028
Updating learning rate to 2.219989405e-05
Validation loss decreased (0.3871 --> 0.3809).  Saving model state dict ...
Epoch: 3 cost time: 0.5680983066558838
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3809269 Best vali loss: 0.3809269
Updating learning rate to 1.1099947025e-05
Validation loss decreased (0.3809 --> 0.3785).  Saving model state dict ...
Epoch: 4 cost time: 0.6017451286315918
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3785405 Best vali loss: 0.3785405
Updating learning rate to 5.5499735125e-06
Validation loss decreased (0.3785 --> 0.3774).  Saving model state dict ...
Epoch: 5 cost time: 0.5898516178131104
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3774053 Best vali loss: 0.3774053
Updating learning rate to 2.77498675625e-06
Validation loss decreased (0.3774 --> 0.3769).  Saving model state dict ...
Epoch: 6 cost time: 0.5142624378204346
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3768594 Best vali loss: 0.3768594
Updating learning rate to 1.387493378125e-06
Validation loss decreased (0.3769 --> 0.3766).  Saving model state dict ...
Epoch: 7 cost time: 0.5894513130187988
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3765944 Best vali loss: 0.3765944
Updating learning rate to 6.937466890625e-07
Validation loss decreased (0.3766 --> 0.3765).  Saving model state dict ...
Epoch: 8 cost time: 0.5717508792877197
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3764608 Best vali loss: 0.3764608

best validation loss 0.3764607924843584

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010826978283, 'e_layers': 3, 'learning_rate': 0.000733585835, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8766297
	speed: 0.0134s/iter; left time: 53.9374s
	iters: 200, epoch: 1 | loss: 0.3477929
	speed: 0.0082s/iter; left time: 32.0959s
	iters: 300, epoch: 1 | loss: 0.6539251
	speed: 0.0099s/iter; left time: 37.9340s
	iters: 400, epoch: 1 | loss: 0.5894262
	speed: 0.0106s/iter; left time: 39.4009s
	iters: 500, epoch: 1 | loss: 0.9462145
	speed: 0.0110s/iter; left time: 39.7404s
Updating learning rate to 0.000733585835
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 5.139228820800781
Epoch: 1, Steps: 514 | Train Loss: 0.6827977 Vali Loss: 0.3704764 Best vali loss: 0.3704764
	iters: 100, epoch: 2 | loss: 0.6488296
	speed: 0.0346s/iter; left time: 121.0764s
	iters: 200, epoch: 2 | loss: 0.5831214
	speed: 0.0116s/iter; left time: 39.3851s
	iters: 300, epoch: 2 | loss: 0.3231682
	speed: 0.0087s/iter; left time: 28.6129s
	iters: 400, epoch: 2 | loss: 0.4943401
	speed: 0.0120s/iter; left time: 38.4462s
	iters: 500, epoch: 2 | loss: 0.6989462
	speed: 0.0119s/iter; left time: 36.7272s
Updating learning rate to 0.0003667929175
Validation loss decreased (0.3705 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 5.778158664703369
Epoch: 2, Steps: 514 | Train Loss: 0.5496811 Vali Loss: 0.3689514 Best vali loss: 0.3689514
	iters: 100, epoch: 3 | loss: 0.2614180
	speed: 0.0315s/iter; left time: 94.0934s
	iters: 200, epoch: 3 | loss: 0.8570936
	speed: 0.0109s/iter; left time: 31.3275s
	iters: 300, epoch: 3 | loss: 0.4901848
	speed: 0.0129s/iter; left time: 35.8624s
	iters: 400, epoch: 3 | loss: 0.3948620
	speed: 0.0130s/iter; left time: 35.0378s
	iters: 500, epoch: 3 | loss: 0.3312385
	speed: 0.0131s/iter; left time: 33.8487s
Updating learning rate to 0.00018339645875
Epoch: 3 cost time: 6.362832307815552
Epoch: 3, Steps: 514 | Train Loss: 0.4669594 Vali Loss: 0.3754702 Best vali loss: 0.3689514
	iters: 100, epoch: 4 | loss: 0.6808815
	speed: 0.0197s/iter; left time: 48.7074s
	iters: 200, epoch: 4 | loss: 0.6400908
	speed: 0.0095s/iter; left time: 22.5361s
	iters: 300, epoch: 4 | loss: 0.9733602
	speed: 0.0099s/iter; left time: 22.4451s
	iters: 400, epoch: 4 | loss: 0.8697579
	speed: 0.0089s/iter; left time: 19.3936s
	iters: 500, epoch: 4 | loss: 0.7022420
	speed: 0.0068s/iter; left time: 13.9981s
Updating learning rate to 9.1698229375e-05
Epoch: 4 cost time: 4.646600961685181
Epoch: 4, Steps: 514 | Train Loss: 0.7732665 Vali Loss: 0.3759066 Best vali loss: 0.3689514
	iters: 100, epoch: 5 | loss: 0.4319866
	speed: 0.0191s/iter; left time: 37.4302s
	iters: 200, epoch: 5 | loss: 1.1990672
	speed: 0.0087s/iter; left time: 16.1103s
	iters: 300, epoch: 5 | loss: 0.4061932
	speed: 0.0091s/iter; left time: 15.9091s
	iters: 400, epoch: 5 | loss: 0.5011575
	speed: 0.0098s/iter; left time: 16.2291s
	iters: 500, epoch: 5 | loss: 0.7046536
	speed: 0.0101s/iter; left time: 15.6598s
Updating learning rate to 4.58491146875e-05
Epoch: 5 cost time: 4.898176431655884
Epoch: 5, Steps: 514 | Train Loss: 0.6486116 Vali Loss: 0.3758759 Best vali loss: 0.3689514
	iters: 100, epoch: 6 | loss: 0.6797096
	speed: 0.0195s/iter; left time: 28.1648s
	iters: 200, epoch: 6 | loss: 0.4683834
	speed: 0.0097s/iter; left time: 13.0233s
	iters: 300, epoch: 6 | loss: 0.2685469
	speed: 0.0096s/iter; left time: 11.9093s
	iters: 400, epoch: 6 | loss: 0.4044962
	speed: 0.0098s/iter; left time: 11.1802s
	iters: 500, epoch: 6 | loss: 0.3251252
	speed: 0.0085s/iter; left time: 8.9027s
Updating learning rate to 2.292455734375e-05
Epoch: 6 cost time: 4.908642530441284
Epoch: 6, Steps: 514 | Train Loss: 0.4292523 Vali Loss: 0.3753814 Best vali loss: 0.3689514
	iters: 100, epoch: 7 | loss: 1.0326228
	speed: 0.0204s/iter; left time: 18.9143s
	iters: 200, epoch: 7 | loss: 0.2162333
	speed: 0.0094s/iter; left time: 7.7569s
	iters: 300, epoch: 7 | loss: 0.2611257
	speed: 0.0096s/iter; left time: 6.9645s
	iters: 400, epoch: 7 | loss: 0.3473714
	speed: 0.0095s/iter; left time: 5.9910s
	iters: 500, epoch: 7 | loss: 0.3948591
	speed: 0.0093s/iter; left time: 4.9404s
Updating learning rate to 1.1462278671875e-05
Epoch: 7 cost time: 4.922013759613037
Epoch: 7, Steps: 514 | Train Loss: 0.4504425 Vali Loss: 0.3763635 Best vali loss: 0.3689514
	iters: 100, epoch: 8 | loss: 0.3501178
	speed: 0.0192s/iter; left time: 7.9677s
	iters: 200, epoch: 8 | loss: 0.5884520
	speed: 0.0097s/iter; left time: 3.0657s
	iters: 300, epoch: 8 | loss: 0.8754100
	speed: 0.0095s/iter; left time: 2.0485s
	iters: 400, epoch: 8 | loss: 0.3626929
	speed: 0.0095s/iter; left time: 1.0910s
	iters: 500, epoch: 8 | loss: 0.7584582
	speed: 0.0092s/iter; left time: 0.1384s
Updating learning rate to 5.7311393359375e-06
Epoch: 8 cost time: 4.949352979660034
Epoch: 8, Steps: 514 | Train Loss: 0.5870262 Vali Loss: 0.3770471 Best vali loss: 0.3689514

best validation loss 0.3689513834614182

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0051497513565, 'e_layers': 1, 'learning_rate': 0.0002849508877, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002849508877
Validation loss decreased (inf --> 0.3797).  Saving model state dict ...
Epoch: 1 cost time: 0.8965859413146973
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3796665 Best vali loss: 0.3796665
Updating learning rate to 0.00014247544385
Validation loss decreased (0.3797 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 0.579179048538208
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3672985 Best vali loss: 0.3672985
Updating learning rate to 7.1237721925e-05
Validation loss decreased (0.3673 --> 0.3645).  Saving model state dict ...
Epoch: 3 cost time: 0.6020913124084473
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3644697 Best vali loss: 0.3644697

best validation loss 0.3644697288515994

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0031640813448, 'e_layers': 4, 'learning_rate': 0.002125626793, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9445080
	speed: 0.0167s/iter; left time: 67.0483s
	iters: 200, epoch: 1 | loss: 0.3849352
	speed: 0.0087s/iter; left time: 34.0737s
	iters: 300, epoch: 1 | loss: 1.0813061
	speed: 0.0086s/iter; left time: 32.7788s
	iters: 400, epoch: 1 | loss: 0.5127890
	speed: 0.0088s/iter; left time: 32.5748s
	iters: 500, epoch: 1 | loss: 0.5285517
	speed: 0.0099s/iter; left time: 35.6628s
Updating learning rate to 0.002044724940405153
Validation loss decreased (inf --> 0.3957).  Saving model state dict ...
Epoch: 1 cost time: 5.142236709594727
Epoch: 1, Steps: 514 | Train Loss: 0.6904180 Vali Loss: 0.3957159 Best vali loss: 0.3957159
	iters: 100, epoch: 2 | loss: 0.5299873
	speed: 0.0221s/iter; left time: 77.2183s
	iters: 200, epoch: 2 | loss: 0.8625833
	speed: 0.0113s/iter; left time: 38.3694s
	iters: 300, epoch: 2 | loss: 0.4559290
	speed: 0.0111s/iter; left time: 36.5723s
	iters: 400, epoch: 2 | loss: 1.1912330
	speed: 0.0102s/iter; left time: 32.7819s
	iters: 500, epoch: 2 | loss: 1.4919882
	speed: 0.0094s/iter; left time: 29.1326s
Updating learning rate to 0.0018143359563010568
Epoch: 2 cost time: 5.483572483062744
Epoch: 2, Steps: 514 | Train Loss: 0.9063442 Vali Loss: 0.4027550 Best vali loss: 0.3957159
	iters: 100, epoch: 3 | loss: 0.5614327
	speed: 0.0229s/iter; left time: 68.3783s
	iters: 200, epoch: 3 | loss: 0.7408765
	speed: 0.0105s/iter; left time: 30.2012s
	iters: 300, epoch: 3 | loss: 0.3533598
	speed: 0.0103s/iter; left time: 28.7956s
	iters: 400, epoch: 3 | loss: 1.0927038
	speed: 0.0106s/iter; left time: 28.5305s
	iters: 500, epoch: 3 | loss: 0.8032828
	speed: 0.0102s/iter; left time: 26.4111s
Updating learning rate to 0.0014695344750362193
Epoch: 3 cost time: 5.589284181594849
Epoch: 3, Steps: 514 | Train Loss: 0.7103311 Vali Loss: 0.4019818 Best vali loss: 0.3957159

best validation loss 0.39571593690714807

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0097583782409, 'e_layers': 4, 'learning_rate': 0.0001196486596, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0511067
	speed: 0.0158s/iter; left time: 63.4283s
	iters: 200, epoch: 1 | loss: 0.9973611
	speed: 0.0102s/iter; left time: 39.7951s
	iters: 300, epoch: 1 | loss: 0.3371020
	speed: 0.0103s/iter; left time: 39.1794s
	iters: 400, epoch: 1 | loss: 0.7809578
	speed: 0.0118s/iter; left time: 43.7174s
	iters: 500, epoch: 1 | loss: 0.4931661
	speed: 0.0097s/iter; left time: 35.1115s
Updating learning rate to 0.00011509480364842505
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 5.64333701133728
Epoch: 1, Steps: 514 | Train Loss: 0.7319387 Vali Loss: 0.3674931 Best vali loss: 0.3674931
	iters: 100, epoch: 2 | loss: 0.7213746
	speed: 0.0204s/iter; left time: 71.5095s
	iters: 200, epoch: 2 | loss: 0.6534216
	speed: 0.0099s/iter; left time: 33.7127s
	iters: 300, epoch: 2 | loss: 0.7621660
	speed: 0.0098s/iter; left time: 32.1762s
	iters: 400, epoch: 2 | loss: 0.9031658
	speed: 0.0103s/iter; left time: 32.9094s
	iters: 500, epoch: 2 | loss: 0.6895087
	speed: 0.0093s/iter; left time: 28.8798s
Updating learning rate to 0.00010212651908152045
Validation loss decreased (0.3675 --> 0.3626).  Saving model state dict ...
Epoch: 2 cost time: 5.110307216644287
Epoch: 2, Steps: 514 | Train Loss: 0.7459273 Vali Loss: 0.3626483 Best vali loss: 0.3626483
	iters: 100, epoch: 3 | loss: 0.3707635
	speed: 0.0210s/iter; left time: 62.6289s
	iters: 200, epoch: 3 | loss: 0.8060834
	speed: 0.0119s/iter; left time: 34.2952s
	iters: 300, epoch: 3 | loss: 0.6622065
	speed: 0.0099s/iter; left time: 27.6878s
	iters: 400, epoch: 3 | loss: 0.7365133
	speed: 0.0100s/iter; left time: 26.7751s
	iters: 500, epoch: 3 | loss: 0.4278395
	speed: 0.0093s/iter; left time: 23.9993s
Updating learning rate to 8.271810966680513e-05
Validation loss decreased (0.3626 --> 0.3581).  Saving model state dict ...
Epoch: 3 cost time: 5.316498756408691
Epoch: 3, Steps: 514 | Train Loss: 0.6006812 Vali Loss: 0.3580796 Best vali loss: 0.3580796

best validation loss 0.35807959512900744

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0097583782409, 'e_layers': 4, 'learning_rate': 0.0001196486596, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7952788
	speed: 0.0176s/iter; left time: 43.3684s
	iters: 200, epoch: 4 | loss: 0.9991734
	speed: 0.0100s/iter; left time: 23.6523s
	iters: 300, epoch: 4 | loss: 0.3615614
	speed: 0.0101s/iter; left time: 22.9699s
	iters: 400, epoch: 4 | loss: 0.7330843
	speed: 0.0098s/iter; left time: 21.2515s
	iters: 500, epoch: 4 | loss: 0.4369109
	speed: 0.0114s/iter; left time: 23.5445s
Updating learning rate to 5.98243298e-05
Epoch: 4 cost time: 5.640270233154297
Epoch: 4, Steps: 514 | Train Loss: 0.6652018 Vali Loss: 0.3602162 Best vali loss: 0.3580796
	iters: 100, epoch: 5 | loss: 0.4178701
	speed: 0.0204s/iter; left time: 39.9913s
	iters: 200, epoch: 5 | loss: 0.5757335
	speed: 0.0098s/iter; left time: 18.1644s
	iters: 300, epoch: 5 | loss: 0.4977610
	speed: 0.0100s/iter; left time: 17.5526s
	iters: 400, epoch: 5 | loss: 0.8164352
	speed: 0.0093s/iter; left time: 15.4629s
	iters: 500, epoch: 5 | loss: 0.6754417
	speed: 0.0095s/iter; left time: 14.8329s
Updating learning rate to 3.6930549933194876e-05
Epoch: 5 cost time: 5.045944929122925
Epoch: 5, Steps: 514 | Train Loss: 0.5966483 Vali Loss: 0.3598891 Best vali loss: 0.3580796
	iters: 100, epoch: 6 | loss: 0.3523469
	speed: 0.0201s/iter; left time: 28.9516s
	iters: 200, epoch: 6 | loss: 0.7514136
	speed: 0.0098s/iter; left time: 13.1994s
	iters: 300, epoch: 6 | loss: 0.6685312
	speed: 0.0112s/iter; left time: 13.9154s
	iters: 400, epoch: 6 | loss: 0.7417973
	speed: 0.0100s/iter; left time: 11.4525s
	iters: 500, epoch: 6 | loss: 0.4189768
	speed: 0.0095s/iter; left time: 9.9403s
Updating learning rate to 1.752214051847955e-05
Epoch: 6 cost time: 5.238739252090454
Epoch: 6, Steps: 514 | Train Loss: 0.5866132 Vali Loss: 0.3649143 Best vali loss: 0.3580796
	iters: 100, epoch: 7 | loss: 0.3908762
	speed: 0.0202s/iter; left time: 18.7407s
	iters: 200, epoch: 7 | loss: 0.6252330
	speed: 0.0100s/iter; left time: 8.2690s
	iters: 300, epoch: 7 | loss: 0.4246118
	speed: 0.0098s/iter; left time: 7.1754s
	iters: 400, epoch: 7 | loss: 0.8061697
	speed: 0.0093s/iter; left time: 5.8473s
	iters: 500, epoch: 7 | loss: 0.7171846
	speed: 0.0094s/iter; left time: 4.9865s
Updating learning rate to 4.55385595157496e-06
Epoch: 7 cost time: 5.017503023147583
Epoch: 7, Steps: 514 | Train Loss: 0.5928151 Vali Loss: 0.3684854 Best vali loss: 0.3580796
	iters: 100, epoch: 8 | loss: 0.7310996
	speed: 0.0142s/iter; left time: 5.8880s
	iters: 200, epoch: 8 | loss: 0.3664190
	speed: 0.0092s/iter; left time: 2.8855s
	iters: 300, epoch: 8 | loss: 0.6294844
	speed: 0.0099s/iter; left time: 2.1341s
	iters: 400, epoch: 8 | loss: 0.8016877
	speed: 0.0097s/iter; left time: 1.1181s
	iters: 500, epoch: 8 | loss: 0.6736509
	speed: 0.0088s/iter; left time: 0.1320s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.668625354766846
Epoch: 8, Steps: 514 | Train Loss: 0.6404683 Vali Loss: 0.3681425 Best vali loss: 0.3580796

best validation loss 0.35807959512900744

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 7.41197855e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1047301
	speed: 0.0153s/iter; left time: 124.0923s
	iters: 200, epoch: 1 | loss: 0.4063083
	speed: 0.0092s/iter; left time: 73.4857s
	iters: 300, epoch: 1 | loss: 1.4008853
	speed: 0.0085s/iter; left time: 67.6463s
	iters: 400, epoch: 1 | loss: 1.1889492
	speed: 0.0098s/iter; left time: 76.2566s
	iters: 500, epoch: 1 | loss: 0.7151423
	speed: 0.0091s/iter; left time: 70.2630s
	iters: 600, epoch: 1 | loss: 0.5421373
	speed: 0.0075s/iter; left time: 57.1267s
	iters: 700, epoch: 1 | loss: 0.2440738
	speed: 0.0095s/iter; left time: 71.6398s
	iters: 800, epoch: 1 | loss: 0.8418940
	speed: 0.0098s/iter; left time: 72.5266s
	iters: 900, epoch: 1 | loss: 0.3867629
	speed: 0.0097s/iter; left time: 71.2588s
	iters: 1000, epoch: 1 | loss: 0.9443330
	speed: 0.0092s/iter; left time: 66.6590s
Updating learning rate to 7.129876913878843e-05
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 9.725859642028809
Epoch: 1, Steps: 1027 | Train Loss: 0.7775216 Vali Loss: 0.3652862 Best vali loss: 0.3652862
	iters: 100, epoch: 2 | loss: 1.2932688
	speed: 0.0295s/iter; left time: 208.9759s
	iters: 200, epoch: 2 | loss: 1.0512367
	speed: 0.0100s/iter; left time: 70.1993s
	iters: 300, epoch: 2 | loss: 1.2067257
	speed: 0.0079s/iter; left time: 54.6262s
	iters: 400, epoch: 2 | loss: 0.6147339
	speed: 0.0073s/iter; left time: 49.4137s
	iters: 500, epoch: 2 | loss: 0.3054259
	speed: 0.0073s/iter; left time: 48.7933s
	iters: 600, epoch: 2 | loss: 0.2010365
	speed: 0.0092s/iter; left time: 60.6361s
	iters: 700, epoch: 2 | loss: 0.6952785
	speed: 0.0087s/iter; left time: 56.1644s
	iters: 800, epoch: 2 | loss: 0.5708945
	speed: 0.0088s/iter; left time: 56.1308s
	iters: 900, epoch: 2 | loss: 0.9992744
	speed: 0.0077s/iter; left time: 48.2172s
	iters: 1000, epoch: 2 | loss: 0.6022553
	speed: 0.0070s/iter; left time: 43.1081s
Updating learning rate to 6.326519422357117e-05
Epoch: 2 cost time: 8.626086950302124
Epoch: 2, Steps: 1027 | Train Loss: 0.7540130 Vali Loss: 0.3687526 Best vali loss: 0.3652862
	iters: 100, epoch: 3 | loss: 0.9955347
	speed: 0.0300s/iter; left time: 182.0034s
	iters: 200, epoch: 3 | loss: 0.2810953
	speed: 0.0101s/iter; left time: 60.1194s
	iters: 300, epoch: 3 | loss: 0.3396388
	speed: 0.0097s/iter; left time: 57.1323s
	iters: 400, epoch: 3 | loss: 0.8590463
	speed: 0.0092s/iter; left time: 53.1731s
	iters: 500, epoch: 3 | loss: 0.2494909
	speed: 0.0099s/iter; left time: 56.1167s
	iters: 600, epoch: 3 | loss: 0.4455167
	speed: 0.0096s/iter; left time: 53.1996s
	iters: 700, epoch: 3 | loss: 0.5368065
	speed: 0.0076s/iter; left time: 41.3797s
	iters: 800, epoch: 3 | loss: 0.7680161
	speed: 0.0074s/iter; left time: 39.4604s
	iters: 900, epoch: 3 | loss: 0.3708740
	speed: 0.0082s/iter; left time: 43.1134s
	iters: 1000, epoch: 3 | loss: 0.8653171
	speed: 0.0085s/iter; left time: 44.0545s
Updating learning rate to 5.124209971065211e-05
Validation loss decreased (0.3653 --> 0.3526).  Saving model state dict ...
Epoch: 3 cost time: 9.208290100097656
Epoch: 3, Steps: 1027 | Train Loss: 0.5711336 Vali Loss: 0.3525544 Best vali loss: 0.3525544
	iters: 100, epoch: 4 | loss: 0.2858232
	speed: 0.0259s/iter; left time: 130.4198s
	iters: 200, epoch: 4 | loss: 0.2633493
	speed: 0.0085s/iter; left time: 41.9530s
	iters: 300, epoch: 4 | loss: 0.9852756
	speed: 0.0088s/iter; left time: 42.4739s
	iters: 400, epoch: 4 | loss: 0.3111280
	speed: 0.0090s/iter; left time: 42.6807s
	iters: 500, epoch: 4 | loss: 1.1072757
	speed: 0.0089s/iter; left time: 41.1230s
	iters: 600, epoch: 4 | loss: 0.4711046
	speed: 0.0089s/iter; left time: 40.5554s
	iters: 700, epoch: 4 | loss: 0.3122508
	speed: 0.0089s/iter; left time: 39.4646s
	iters: 800, epoch: 4 | loss: 0.1727108
	speed: 0.0089s/iter; left time: 38.4454s
	iters: 900, epoch: 4 | loss: 0.4376009
	speed: 0.0085s/iter; left time: 35.9892s
	iters: 1000, epoch: 4 | loss: 0.6456156
	speed: 0.0084s/iter; left time: 34.8211s
Updating learning rate to 3.705989275e-05
Validation loss decreased (0.3526 --> 0.3501).  Saving model state dict ...
Epoch: 4 cost time: 9.031123161315918
Epoch: 4, Steps: 1027 | Train Loss: 0.4992134 Vali Loss: 0.3500946 Best vali loss: 0.3500946
	iters: 100, epoch: 5 | loss: 0.3382850
	speed: 0.0254s/iter; left time: 101.7844s
	iters: 200, epoch: 5 | loss: 0.4470538
	speed: 0.0084s/iter; left time: 32.8727s
	iters: 300, epoch: 5 | loss: 0.2995364
	speed: 0.0078s/iter; left time: 29.6555s
	iters: 400, epoch: 5 | loss: 0.2776581
	speed: 0.0082s/iter; left time: 30.2888s
	iters: 500, epoch: 5 | loss: 0.4581589
	speed: 0.0097s/iter; left time: 34.8369s
	iters: 600, epoch: 5 | loss: 0.5519817
	speed: 0.0092s/iter; left time: 32.4473s
	iters: 700, epoch: 5 | loss: 0.4707945
	speed: 0.0098s/iter; left time: 33.4620s
	iters: 800, epoch: 5 | loss: 0.5992859
	speed: 0.0107s/iter; left time: 35.4662s
	iters: 900, epoch: 5 | loss: 0.3932366
	speed: 0.0104s/iter; left time: 33.5201s
	iters: 1000, epoch: 5 | loss: 0.3378556
	speed: 0.0101s/iter; left time: 31.4989s
Updating learning rate to 2.2877685789347898e-05
Epoch: 5 cost time: 9.650256156921387
Epoch: 5, Steps: 1027 | Train Loss: 0.4173846 Vali Loss: 0.3504704 Best vali loss: 0.3500946
	iters: 100, epoch: 6 | loss: 0.5448176
	speed: 0.0332s/iter; left time: 98.8787s
	iters: 200, epoch: 6 | loss: 0.4951518
	speed: 0.0110s/iter; left time: 31.6084s
	iters: 300, epoch: 6 | loss: 0.6862133
	speed: 0.0101s/iter; left time: 28.0845s
	iters: 400, epoch: 6 | loss: 0.3136245
	speed: 0.0098s/iter; left time: 26.3227s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7451047
	speed: 0.0121s/iter; left time: 23.7010s
	iters: 200, epoch: 1 | loss: 0.5367600
	speed: 0.0081s/iter; left time: 15.1246s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.3972).  Saving model state dict ...
Epoch: 1 cost time: 2.18528413772583
Epoch: 1, Steps: 257 | Train Loss: 0.6409324 Vali Loss: 0.3972260 Best vali loss: 0.3972260
	iters: 100, epoch: 2 | loss: 0.9943453
	speed: 0.0181s/iter; left time: 30.8183s
	iters: 200, epoch: 2 | loss: 0.6705810
	speed: 0.0082s/iter; left time: 13.1516s
Updating learning rate to 0.00164194791575
Epoch: 2 cost time: 2.187563419342041
Epoch: 2, Steps: 257 | Train Loss: 0.8324632 Vali Loss: 0.4015176 Best vali loss: 0.3972260
	iters: 100, epoch: 3 | loss: 0.6091980
	speed: 0.0183s/iter; left time: 26.4432s
	iters: 200, epoch: 3 | loss: 0.6449847
	speed: 0.0082s/iter; left time: 11.0551s
Updating learning rate to 0.000820973957875
Epoch: 3 cost time: 2.187788963317871
Epoch: 3, Steps: 257 | Train Loss: 0.6270913 Vali Loss: 0.4037795 Best vali loss: 0.3972260
	iters: 100, epoch: 4 | loss: 0.6394178
	speed: 0.0180s/iter; left time: 21.3962s
	iters: 200, epoch: 4 | loss: 0.6726139
	speed: 0.0124s/iter; left time: 13.4783s
Updating learning rate to 0.0004104869789375
Epoch: 4 cost time: 2.630459785461426
Epoch: 4, Steps: 257 | Train Loss: 0.6560158 Vali Loss: 0.4034620 Best vali loss: 0.3972260
	iters: 100, epoch: 5 | loss: 0.3647648
	speed: 0.0179s/iter; left time: 16.6104s
	iters: 200, epoch: 5 | loss: 0.6444293
	speed: 0.0080s/iter; left time: 6.6646s
Updating learning rate to 0.00020524348946875
Epoch: 5 cost time: 2.1511037349700928
Epoch: 5, Steps: 257 | Train Loss: 0.5045970 Vali Loss: 0.4032486 Best vali loss: 0.3972260
	iters: 100, epoch: 6 | loss: 0.7232563
	speed: 0.0180s/iter; left time: 12.0966s
	iters: 200, epoch: 6 | loss: 0.5644151
	speed: 0.0084s/iter; left time: 4.7983s
Updating learning rate to 0.000102621744734375
Epoch: 6 cost time: 2.21366548538208
Epoch: 6, Steps: 257 | Train Loss: 0.6438357 Vali Loss: 0.4030703 Best vali loss: 0.3972260
	iters: 100, epoch: 7 | loss: 0.6156653
	speed: 0.0178s/iter; left time: 7.3677s
	iters: 200, epoch: 7 | loss: 0.7178630
	speed: 0.0083s/iter; left time: 2.6134s
Updating learning rate to 5.13108723671875e-05
Epoch: 7 cost time: 2.205554962158203
Epoch: 7, Steps: 257 | Train Loss: 0.6667642 Vali Loss: 0.4032401 Best vali loss: 0.3972260
	iters: 100, epoch: 8 | loss: 0.8059818
	speed: 0.0270s/iter; left time: 4.2682s
	iters: 200, epoch: 8 | loss: 0.7571643
	speed: 0.0124s/iter; left time: 0.7173s
Updating learning rate to 2.565543618359375e-05
Epoch: 8 cost time: 3.305428981781006
Epoch: 8, Steps: 257 | Train Loss: 0.7815731 Vali Loss: 0.4032308 Best vali loss: 0.3972260

best validation loss 0.3972259919512248

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0010217492465, 'e_layers': 4, 'learning_rate': 8.45510235e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7101943
	speed: 0.0368s/iter; left time: 34.2936s
Updating learning rate to 8.45510235e-05
Validation loss decreased (inf --> 0.4226).  Saving model state dict ...
Epoch: 1 cost time: 4.413038492202759
Epoch: 1, Steps: 129 | Train Loss: 0.7101943 Vali Loss: 0.4226388 Best vali loss: 0.4226388
	iters: 100, epoch: 2 | loss: 0.7614520
	speed: 0.0609s/iter; left time: 48.9295s
Updating learning rate to 4.227551175e-05
Validation loss decreased (0.4226 --> 0.4059).  Saving model state dict ...
Epoch: 2 cost time: 4.374864339828491
Epoch: 2, Steps: 129 | Train Loss: 0.7614520 Vali Loss: 0.4059300 Best vali loss: 0.4059300
	iters: 100, epoch: 3 | loss: 0.7591534
	speed: 0.0610s/iter; left time: 41.1509s
Updating learning rate to 2.1137755875e-05
Validation loss decreased (0.4059 --> 0.4003).  Saving model state dict ...
Epoch: 3 cost time: 3.471414804458618
Epoch: 3, Steps: 129 | Train Loss: 0.7591534 Vali Loss: 0.4003201 Best vali loss: 0.4003201

best validation loss 0.4003200825164735

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0056984617756, 'e_layers': 3, 'learning_rate': 0.0002260913018, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9524274
	speed: 0.0185s/iter; left time: 36.1892s
	iters: 200, epoch: 1 | loss: 0.5296642
	speed: 0.0138s/iter; left time: 25.5367s
Updating learning rate to 0.0002260913018
Validation loss decreased (inf --> 0.3585).  Saving model state dict ...
Epoch: 1 cost time: 3.590022325515747
Epoch: 1, Steps: 257 | Train Loss: 0.7410458 Vali Loss: 0.3584784 Best vali loss: 0.3584784
	iters: 100, epoch: 2 | loss: 0.8097839
	speed: 0.0302s/iter; left time: 51.4042s
	iters: 200, epoch: 2 | loss: 0.6804040
	speed: 0.0143s/iter; left time: 22.9004s
Updating learning rate to 0.0001130456509
Epoch: 2 cost time: 3.8457024097442627
Epoch: 2, Steps: 257 | Train Loss: 0.7450939 Vali Loss: 0.3604306 Best vali loss: 0.3584784
	iters: 100, epoch: 3 | loss: 0.4030603
	speed: 0.0428s/iter; left time: 61.7104s
	iters: 200, epoch: 3 | loss: 1.0032164
	speed: 0.0118s/iter; left time: 15.7958s
Updating learning rate to 5.652282545e-05
Validation loss decreased (0.3585 --> 0.3544).  Saving model state dict ...
Epoch: 3 cost time: 3.178248167037964
Epoch: 3, Steps: 257 | Train Loss: 0.7031384 Vali Loss: 0.3544368 Best vali loss: 0.3544368

best validation loss 0.35443681345004696

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.010989339883, 'e_layers': 1, 'learning_rate': 0.0033337143242, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6388049
	speed: 0.0101s/iter; left time: 81.8172s
	iters: 200, epoch: 1 | loss: 0.3716707
	speed: 0.0042s/iter; left time: 33.4829s
	iters: 300, epoch: 1 | loss: 1.6526608
	speed: 0.0042s/iter; left time: 33.4822s
	iters: 400, epoch: 1 | loss: 0.9384286
	speed: 0.0043s/iter; left time: 33.6327s
	iters: 500, epoch: 1 | loss: 0.9669037
	speed: 0.0046s/iter; left time: 35.4473s
	iters: 600, epoch: 1 | loss: 0.3642868
	speed: 0.0042s/iter; left time: 32.0344s
	iters: 700, epoch: 1 | loss: 0.5037013
	speed: 0.0042s/iter; left time: 31.6357s
	iters: 800, epoch: 1 | loss: 0.4016473
	speed: 0.0044s/iter; left time: 32.3868s
	iters: 900, epoch: 1 | loss: 0.3923824
	speed: 0.0044s/iter; left time: 32.2356s
	iters: 1000, epoch: 1 | loss: 0.3958780
	speed: 0.0046s/iter; left time: 33.3088s
Updating learning rate to 0.003206832377784038
Validation loss decreased (inf --> 0.3855).  Saving model state dict ...
Epoch: 1 cost time: 4.743770122528076
Epoch: 1, Steps: 1027 | Train Loss: 0.6626365 Vali Loss: 0.3855040 Best vali loss: 0.3855040
	iters: 100, epoch: 2 | loss: 0.7398032
	speed: 0.0174s/iter; left time: 123.2264s
	iters: 200, epoch: 2 | loss: 0.2343608
	speed: 0.0045s/iter; left time: 31.5567s
	iters: 300, epoch: 2 | loss: 0.3471793
	speed: 0.0045s/iter; left time: 31.1853s
	iters: 400, epoch: 2 | loss: 0.5244790
	speed: 0.0045s/iter; left time: 30.6757s
	iters: 500, epoch: 2 | loss: 0.9260499
	speed: 0.0046s/iter; left time: 30.7250s
	iters: 600, epoch: 2 | loss: 1.0037456
	speed: 0.0040s/iter; left time: 26.4915s
	iters: 700, epoch: 2 | loss: 0.7203815
	speed: 0.0033s/iter; left time: 21.4004s
	iters: 800, epoch: 2 | loss: 0.9374768
	speed: 0.0033s/iter; left time: 21.4036s
	iters: 900, epoch: 2 | loss: 0.2836120
	speed: 0.0040s/iter; left time: 25.2525s
	iters: 1000, epoch: 2 | loss: 0.3453434
	speed: 0.0035s/iter; left time: 21.9442s
Updating learning rate to 0.002845503164690274
Validation loss decreased (0.3855 --> 0.3662).  Saving model state dict ...
Epoch: 2 cost time: 4.219331502914429
Epoch: 2, Steps: 1027 | Train Loss: 0.6062431 Vali Loss: 0.3662475 Best vali loss: 0.3662475
	iters: 100, epoch: 3 | loss: 0.2435962
	speed: 0.0161s/iter; left time: 97.6004s
	iters: 200, epoch: 3 | loss: 0.4141992
	speed: 0.0045s/iter; left time: 26.9010s
	iters: 300, epoch: 3 | loss: 0.2839528
	speed: 0.0051s/iter; left time: 29.8911s
	iters: 400, epoch: 3 | loss: 0.3388118
	speed: 0.0043s/iter; left time: 24.9215s
	iters: 500, epoch: 3 | loss: 0.8104134
	speed: 0.0049s/iter; left time: 28.0123s
	iters: 600, epoch: 3 | loss: 0.8479976
	speed: 0.0046s/iter; left time: 25.6218s
	iters: 700, epoch: 3 | loss: 0.3970456
	speed: 0.0047s/iter; left time: 25.6163s
	iters: 800, epoch: 3 | loss: 0.9278604
	speed: 0.0050s/iter; left time: 26.7076s
	iters: 900, epoch: 3 | loss: 0.3183889
	speed: 0.0049s/iter; left time: 25.5349s
	iters: 1000, epoch: 3 | loss: 0.2746452
	speed: 0.0045s/iter; left time: 23.4889s
Updating learning rate to 0.0023047357821547607
Epoch: 3 cost time: 4.90727424621582
Epoch: 3, Steps: 1027 | Train Loss: 0.4856911 Vali Loss: 0.3714898 Best vali loss: 0.3662475

best validation loss 0.36624745766985395

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0056984617756, 'e_layers': 3, 'learning_rate': 0.0002260913018, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6362342
	speed: 0.0191s/iter; left time: 22.6378s
	iters: 200, epoch: 4 | loss: 0.4296468
	speed: 0.0105s/iter; left time: 11.4544s
Updating learning rate to 2.8261412725e-05
Epoch: 4 cost time: 3.086519956588745
Epoch: 4, Steps: 257 | Train Loss: 0.5329405 Vali Loss: 0.3659431 Best vali loss: 0.3544368
	iters: 100, epoch: 5 | loss: 0.5846076
	speed: 0.0213s/iter; left time: 19.8215s
	iters: 200, epoch: 5 | loss: 0.5379510
	speed: 0.0105s/iter; left time: 8.7167s
Updating learning rate to 1.41307063625e-05
Epoch: 5 cost time: 2.733060598373413
Epoch: 5, Steps: 257 | Train Loss: 0.5612793 Vali Loss: 0.3664448 Best vali loss: 0.3544368
	iters: 100, epoch: 6 | loss: 0.3603645
	speed: 0.0210s/iter; left time: 14.0946s
	iters: 200, epoch: 6 | loss: 0.8116287
	speed: 0.0109s/iter; left time: 6.2080s
Updating learning rate to 7.06535318125e-06
Epoch: 6 cost time: 2.8308541774749756
Epoch: 6, Steps: 257 | Train Loss: 0.5859966 Vali Loss: 0.3688821 Best vali loss: 0.3544368
	iters: 100, epoch: 7 | loss: 0.5422987
	speed: 0.0230s/iter; left time: 9.5243s
	iters: 200, epoch: 7 | loss: 0.3450004
	speed: 0.0130s/iter; left time: 4.0885s
Updating learning rate to 3.532676590625e-06
Epoch: 7 cost time: 3.1603994369506836
Epoch: 7, Steps: 257 | Train Loss: 0.4436496 Vali Loss: 0.3729311 Best vali loss: 0.3544368
	iters: 100, epoch: 8 | loss: 0.5586228
	speed: 0.0211s/iter; left time: 3.3274s
	iters: 200, epoch: 8 | loss: 0.2814369
	speed: 0.0103s/iter; left time: 0.5951s
Updating learning rate to 1.7663382953125e-06
Epoch: 8 cost time: 2.6691269874572754
Epoch: 8, Steps: 257 | Train Loss: 0.4200299 Vali Loss: 0.3712184 Best vali loss: 0.3544368

best validation loss 0.35443681345004696

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.002530286228, 'e_layers': 2, 'learning_rate': 0.0027643246753, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2386141
	speed: 0.0134s/iter; left time: 108.5426s
	iters: 200, epoch: 1 | loss: 0.9263183
	speed: 0.0073s/iter; left time: 58.6966s
	iters: 300, epoch: 1 | loss: 1.1546903
	speed: 0.0073s/iter; left time: 58.0948s
	iters: 400, epoch: 1 | loss: 0.4077753
	speed: 0.0071s/iter; left time: 55.5613s
	iters: 500, epoch: 1 | loss: 0.7703544
	speed: 0.0062s/iter; left time: 47.8601s
	iters: 600, epoch: 1 | loss: 0.8204536
	speed: 0.0063s/iter; left time: 48.3565s
	iters: 700, epoch: 1 | loss: 0.4955842
	speed: 0.0069s/iter; left time: 51.7790s
	iters: 800, epoch: 1 | loss: 0.9531540
	speed: 0.0073s/iter; left time: 53.9127s
	iters: 900, epoch: 1 | loss: 1.0792159
	speed: 0.0073s/iter; left time: 53.4212s
	iters: 1000, epoch: 1 | loss: 0.9255444
	speed: 0.0074s/iter; left time: 53.3948s
Updating learning rate to 0.0027643246753
Validation loss decreased (inf --> 0.3767).  Saving model state dict ...
Epoch: 1 cost time: 7.583478212356567
Epoch: 1, Steps: 1027 | Train Loss: 0.8771704 Vali Loss: 0.3766716 Best vali loss: 0.3766716
	iters: 100, epoch: 2 | loss: 0.7717073
	speed: 0.0244s/iter; left time: 173.0806s
	iters: 200, epoch: 2 | loss: 0.4086470
	speed: 0.0062s/iter; left time: 43.1478s
	iters: 300, epoch: 2 | loss: 0.6173775
	speed: 0.0072s/iter; left time: 49.3390s
	iters: 400, epoch: 2 | loss: 0.5711656
	speed: 0.0075s/iter; left time: 50.8901s
	iters: 500, epoch: 2 | loss: 1.0400616
	speed: 0.0079s/iter; left time: 53.1579s
	iters: 600, epoch: 2 | loss: 0.5160378
	speed: 0.0076s/iter; left time: 49.8651s
	iters: 700, epoch: 2 | loss: 0.3611843
	speed: 0.0068s/iter; left time: 44.0109s
	iters: 800, epoch: 2 | loss: 0.7305310
	speed: 0.0071s/iter; left time: 45.6596s
	iters: 900, epoch: 2 | loss: 0.8730641
	speed: 0.0075s/iter; left time: 47.0521s
	iters: 1000, epoch: 2 | loss: 0.1815050
	speed: 0.0071s/iter; left time: 44.1639s
Updating learning rate to 0.00138216233765
Epoch: 2 cost time: 7.402453422546387
Epoch: 2, Steps: 1027 | Train Loss: 0.6071281 Vali Loss: 0.3777365 Best vali loss: 0.3766716
	iters: 100, epoch: 3 | loss: 0.5428975
	speed: 0.0234s/iter; left time: 142.0480s
	iters: 200, epoch: 3 | loss: 0.7056980
	speed: 0.0074s/iter; left time: 44.0526s
	iters: 300, epoch: 3 | loss: 0.7317395
	speed: 0.0072s/iter; left time: 42.3799s
	iters: 400, epoch: 3 | loss: 0.4372941
	speed: 0.0073s/iter; left time: 41.9787s
	iters: 500, epoch: 3 | loss: 0.7330472
	speed: 0.0073s/iter; left time: 41.2603s
	iters: 600, epoch: 3 | loss: 0.2498292
	speed: 0.0072s/iter; left time: 40.1144s
	iters: 700, epoch: 3 | loss: 0.4117185
	speed: 0.0067s/iter; left time: 36.7487s
	iters: 800, epoch: 3 | loss: 0.4514367
	speed: 0.0058s/iter; left time: 30.8874s
	iters: 900, epoch: 3 | loss: 0.4483628
	speed: 0.0072s/iter; left time: 38.0743s
	iters: 1000, epoch: 3 | loss: 0.3143141
	speed: 0.0072s/iter; left time: 37.2392s
Updating learning rate to 0.000691081168825
Validation loss decreased (0.3767 --> 0.3727).  Saving model state dict ...
Epoch: 3 cost time: 7.285601854324341
Epoch: 3, Steps: 1027 | Train Loss: 0.5026338 Vali Loss: 0.3727259 Best vali loss: 0.3727259
	iters: 100, epoch: 4 | loss: 0.5578826
	speed: 0.0223s/iter; left time: 112.1993s
	iters: 200, epoch: 4 | loss: 1.1102328
	speed: 0.0075s/iter; left time: 37.0352s
	iters: 300, epoch: 4 | loss: 0.2353236
	speed: 0.0073s/iter; left time: 35.4058s
	iters: 400, epoch: 4 | loss: 1.3367983
	speed: 0.0062s/iter; left time: 29.4282s
	iters: 500, epoch: 4 | loss: 0.4453314
	speed: 0.0072s/iter; left time: 33.5247s
	iters: 600, epoch: 4 | loss: 0.2762582
	speed: 0.0077s/iter; left time: 34.7530s
	iters: 700, epoch: 4 | loss: 0.4865898
	speed: 0.0075s/iter; left time: 33.3408s
	iters: 800, epoch: 4 | loss: 1.1304039
	speed: 0.0072s/iter; left time: 31.0749s
	iters: 900, epoch: 4 | loss: 0.3713520
	speed: 0.0070s/iter; left time: 29.6801s
	iters: 1000, epoch: 4 | loss: 0.3761370
	speed: 0.0070s/iter; left time: 28.7781s
Updating learning rate to 0.0003455405844125
Epoch: 4 cost time: 7.3919453620910645
Epoch: 4, Steps: 1027 | Train Loss: 0.6326310 Vali Loss: 0.3902621 Best vali loss: 0.3727259
	iters: 100, epoch: 5 | loss: 0.2726296
	speed: 0.0172s/iter; left time: 69.1337s
	iters: 200, epoch: 5 | loss: 0.3607980
	speed: 0.0071s/iter; left time: 27.6221s
	iters: 300, epoch: 5 | loss: 0.4140486
	speed: 0.0093s/iter; left time: 35.4312s
	iters: 400, epoch: 5 | loss: 0.2328246
	speed: 0.0094s/iter; left time: 35.0232s
	iters: 500, epoch: 5 | loss: 0.5317945
	speed: 0.0091s/iter; left time: 32.9946s
	iters: 600, epoch: 5 | loss: 0.9580923
	speed: 0.0091s/iter; left time: 31.7902s
	iters: 700, epoch: 5 | loss: 0.3360468
	speed: 0.0084s/iter; left time: 28.7812s
	iters: 800, epoch: 5 | loss: 0.9624488
	speed: 0.0076s/iter; left time: 25.0848s
	iters: 900, epoch: 5 | loss: 0.6405683
	speed: 0.0087s/iter; left time: 28.0317s
	iters: 1000, epoch: 5 | loss: 0.5595971
	speed: 0.0086s/iter; left time: 26.7713s
Updating learning rate to 0.00017277029220625
Epoch: 5 cost time: 8.47257113456726
Epoch: 5, Steps: 1027 | Train Loss: 0.5268849 Vali Loss: 0.3845728 Best vali loss: 0.3727259
	iters: 100, epoch: 6 | loss: 0.7936479
	speed: 0.0306s/iter; left time: 91.3208s
	iters: 200, epoch: 6 | loss: 0.4276768
	speed: 0.0084s/iter; left time: 24.1484s
	iters: 300, epoch: 6 | loss: 0.1889716
	speed: 0.0067s/iter; left time: 18.6257s
	iters: 400, epoch: 6 | loss: 0.3078568
	speed: 0.0089s/iter; left time: 23.9210s
	iters: 500, epoch: 6 | loss: 1.1535248
	speed: 0.0088s/iter; left time: 22.7270s
	iters: 600, epoch: 6 | loss: 0.7566100
	speed: 0.0089s/iter; left time: 22.1807s
	iters: 700, epoch: 6 | loss: 0.4089673
	speed: 0.0092s/iter; left time: 21.8708s
	iters: 800, epoch: 6 | loss: 0.9352481
	speed: 0.0091s/iter; left time: 20.7657s
	iters: 900, epoch: 6 | loss: 0.4448720
	speed: 0.0091s/iter; left time: 19.8595s
	iters: 1000, epoch: 6 | loss: 0.3431751
	speed: 0.0075s/iter; left time: 15.6696s
Updating learning rate to 8.6385146103125e-05
Epoch: 6 cost time: 8.805214643478394
Epoch: 6, Steps: 1027 | Train Loss: 0.5760550 Vali Loss: 0.3943253 Best vali loss: 0.3727259
	iters: 100, epoch: 7 | loss: 0.4097849
	speed: 0.0166s/iter; left time: 32.4793s
	iters: 200, epoch: 7 | loss: 0.2790839
	speed: 0.0063s/iter; left time: 11.7044s
	iters: 300, epoch: 7 | loss: 0.3000866
	speed: 0.0087s/iter; left time: 15.2742s
	iters: 400, epoch: 7 | loss: 0.2092606
	speed: 0.0087s/iter; left time: 14.4636s
	iters: 500, epoch: 7 | loss: 0.6242979
	speed: 0.0053s/iter; left time: 8.2911s
	iters: 600, epoch: 7 | loss: 1.1117862
	speed: 0.0076s/iter; left time: 11.0487s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 3, 'learning_rate': 0.0006184251923, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0603253
	speed: 0.0132s/iter; left time: 106.8199s
	iters: 200, epoch: 1 | loss: 0.2753171
	speed: 0.0061s/iter; left time: 49.2571s
	iters: 300, epoch: 1 | loss: 0.9981894
	speed: 0.0077s/iter; left time: 61.3124s
	iters: 400, epoch: 1 | loss: 1.2268081
	speed: 0.0078s/iter; left time: 61.2790s
	iters: 500, epoch: 1 | loss: 0.6203596
	speed: 0.0083s/iter; left time: 64.2592s
	iters: 600, epoch: 1 | loss: 0.4505053
	speed: 0.0063s/iter; left time: 48.2741s
	iters: 700, epoch: 1 | loss: 0.3354906
	speed: 0.0056s/iter; left time: 42.2493s
	iters: 800, epoch: 1 | loss: 0.2560906
	speed: 0.0077s/iter; left time: 57.3663s
	iters: 900, epoch: 1 | loss: 1.8222897
	speed: 0.0084s/iter; left time: 61.6863s
	iters: 1000, epoch: 1 | loss: 0.1782494
	speed: 0.0081s/iter; left time: 58.2665s
Updating learning rate to 0.0005948877849276632
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 7.800299406051636
Epoch: 1, Steps: 1027 | Train Loss: 0.7223625 Vali Loss: 0.3669985 Best vali loss: 0.3669985
	iters: 100, epoch: 2 | loss: 0.6149146
	speed: 0.0275s/iter; left time: 195.0207s
	iters: 200, epoch: 2 | loss: 0.8350204
	speed: 0.0121s/iter; left time: 84.2515s
	iters: 300, epoch: 2 | loss: 0.5577469
	speed: 0.0092s/iter; left time: 63.0539s
	iters: 400, epoch: 2 | loss: 0.2228811
	speed: 0.0106s/iter; left time: 71.9691s
	iters: 500, epoch: 2 | loss: 0.5738783
	speed: 0.0123s/iter; left time: 82.4099s
	iters: 600, epoch: 2 | loss: 0.2359338
	speed: 0.0137s/iter; left time: 90.0547s
	iters: 700, epoch: 2 | loss: 0.3461988
	speed: 0.0109s/iter; left time: 70.7925s
	iters: 800, epoch: 2 | loss: 0.3551008
	speed: 0.0130s/iter; left time: 82.9807s
	iters: 900, epoch: 2 | loss: 0.8063110
	speed: 0.0087s/iter; left time: 54.5555s
	iters: 1000, epoch: 2 | loss: 0.2513187
	speed: 0.0098s/iter; left time: 60.6781s
Updating learning rate to 0.0005278589197159623
Validation loss decreased (0.3670 --> 0.3653).  Saving model state dict ...
Epoch: 2 cost time: 11.221409320831299
Epoch: 2, Steps: 1027 | Train Loss: 0.4799304 Vali Loss: 0.3653287 Best vali loss: 0.3653287
	iters: 100, epoch: 3 | loss: 0.3573599
	speed: 0.0253s/iter; left time: 153.4362s
	iters: 200, epoch: 3 | loss: 0.8039824
	speed: 0.0063s/iter; left time: 37.7542s
	iters: 300, epoch: 3 | loss: 0.2592618
	speed: 0.0076s/iter; left time: 44.3974s
	iters: 400, epoch: 3 | loss: 2.1429675
	speed: 0.0082s/iter; left time: 47.0551s
	iters: 500, epoch: 3 | loss: 0.4903041
	speed: 0.0068s/iter; left time: 38.4397s
	iters: 600, epoch: 3 | loss: 0.7757182
	speed: 0.0068s/iter; left time: 37.9838s
	iters: 700, epoch: 3 | loss: 0.2272158
	speed: 0.0074s/iter; left time: 40.6109s
	iters: 800, epoch: 3 | loss: 0.1828306
	speed: 0.0081s/iter; left time: 43.2319s
	iters: 900, epoch: 3 | loss: 0.2799464
	speed: 0.0100s/iter; left time: 52.5542s
	iters: 1000, epoch: 3 | loss: 0.3603839
	speed: 0.0090s/iter; left time: 46.5571s
Updating learning rate to 0.00042754313377520235
Epoch: 3 cost time: 8.136583089828491
Epoch: 3, Steps: 1027 | Train Loss: 0.5879971 Vali Loss: 0.3697471 Best vali loss: 0.3653287
	iters: 100, epoch: 4 | loss: 0.1622139
	speed: 0.0212s/iter; left time: 106.6258s
	iters: 200, epoch: 4 | loss: 0.3486509
	speed: 0.0062s/iter; left time: 30.3976s
	iters: 300, epoch: 4 | loss: 0.4808718
	speed: 0.0064s/iter; left time: 31.1862s
	iters: 400, epoch: 4 | loss: 0.7445488
	speed: 0.0065s/iter; left time: 30.8593s
	iters: 500, epoch: 4 | loss: 0.2575116
	speed: 0.0054s/iter; left time: 24.9311s
	iters: 600, epoch: 4 | loss: 0.4450700
	speed: 0.0056s/iter; left time: 25.3023s
	iters: 700, epoch: 4 | loss: 0.7502480
	speed: 0.0063s/iter; left time: 27.8683s
	iters: 800, epoch: 4 | loss: 0.2649638
	speed: 0.0079s/iter; left time: 34.2678s
	iters: 900, epoch: 4 | loss: 0.4692650
	speed: 0.0070s/iter; left time: 29.4972s
	iters: 1000, epoch: 4 | loss: 0.8521765
	speed: 0.0077s/iter; left time: 31.8521s
Updating learning rate to 0.00030921259615
Validation loss decreased (0.3653 --> 0.3614).  Saving model state dict ...
Epoch: 4 cost time: 6.805586576461792
Epoch: 4, Steps: 1027 | Train Loss: 0.4775520 Vali Loss: 0.3613731 Best vali loss: 0.3613731
	iters: 100, epoch: 5 | loss: 0.1743174
	speed: 0.0212s/iter; left time: 85.0017s
	iters: 200, epoch: 5 | loss: 0.7670746
	speed: 0.0071s/iter; left time: 27.8474s
	iters: 300, epoch: 5 | loss: 0.9995823
	speed: 0.0071s/iter; left time: 26.9574s
	iters: 400, epoch: 5 | loss: 0.7142184
	speed: 0.0067s/iter; left time: 24.7562s
	iters: 500, epoch: 5 | loss: 0.2280136
	speed: 0.0129s/iter; left time: 46.4609s
	iters: 600, epoch: 5 | loss: 0.2108900
	speed: 0.0113s/iter; left time: 39.6659s
	iters: 700, epoch: 5 | loss: 0.5097609
	speed: 0.0106s/iter; left time: 36.1485s
	iters: 800, epoch: 5 | loss: 0.3898175
	speed: 0.0130s/iter; left time: 43.0334s
	iters: 900, epoch: 5 | loss: 0.4611002
	speed: 0.0136s/iter; left time: 43.7394s
	iters: 1000, epoch: 5 | loss: 0.2552852
	speed: 0.0132s/iter; left time: 41.0657s
Updating learning rate to 0.00019088205852479766
Validation loss decreased (0.3614 --> 0.3606).  Saving model state dict ...
Epoch: 5 cost time: 10.62608289718628
Epoch: 5, Steps: 1027 | Train Loss: 0.4710060 Vali Loss: 0.3606126 Best vali loss: 0.3606126
	iters: 100, epoch: 6 | loss: 0.2793548
	speed: 0.0416s/iter; left time: 124.1117s
	iters: 200, epoch: 6 | loss: 0.1283843
	speed: 0.0119s/iter; left time: 34.1681s
	iters: 300, epoch: 6 | loss: 0.6829781
	speed: 0.0147s/iter; left time: 41.0221s
	iters: 400, epoch: 6 | loss: 0.4739578
	speed: 0.0140s/iter; left time: 37.5680s
	iters: 500, epoch: 6 | loss: 0.2688139
	speed: 0.0145s/iter; left time: 37.4008s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0012503605036, 'e_layers': 4, 'learning_rate': 0.0037162746313, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8281102
	speed: 0.0250s/iter; left time: 100.4936s
	iters: 200, epoch: 1 | loss: 0.9373854
	speed: 0.0175s/iter; left time: 68.4248s
	iters: 300, epoch: 1 | loss: 0.5529224
	speed: 0.0144s/iter; left time: 54.7473s
	iters: 400, epoch: 1 | loss: 0.6200221
	speed: 0.0158s/iter; left time: 58.6082s
	iters: 500, epoch: 1 | loss: 0.2860274
	speed: 0.0166s/iter; left time: 60.0428s
Updating learning rate to 0.0037162746313
Validation loss decreased (inf --> 0.4029).  Saving model state dict ...
Epoch: 1 cost time: 8.850369453430176
Epoch: 1, Steps: 514 | Train Loss: 0.6448935 Vali Loss: 0.4028638 Best vali loss: 0.4028638
	iters: 100, epoch: 2 | loss: 0.7906229
	speed: 0.0299s/iter; left time: 104.4508s
	iters: 200, epoch: 2 | loss: 1.5257992
	speed: 0.0157s/iter; left time: 53.4124s
	iters: 300, epoch: 2 | loss: 0.3354809
	speed: 0.0161s/iter; left time: 53.0573s
	iters: 400, epoch: 2 | loss: 0.7449043
	speed: 0.0116s/iter; left time: 37.0382s
	iters: 500, epoch: 2 | loss: 0.5685643
	speed: 0.0118s/iter; left time: 36.6881s
Updating learning rate to 0.00185813731565
Epoch: 2 cost time: 7.314159154891968
Epoch: 2, Steps: 514 | Train Loss: 0.7930743 Vali Loss: 0.4057363 Best vali loss: 0.4028638
	iters: 100, epoch: 3 | loss: 0.9378819
	speed: 0.0231s/iter; left time: 68.8635s
	iters: 200, epoch: 3 | loss: 0.4687635
	speed: 0.0120s/iter; left time: 34.5130s
	iters: 300, epoch: 3 | loss: 0.2940636
	speed: 0.0107s/iter; left time: 29.8456s
	iters: 400, epoch: 3 | loss: 0.3641278
	speed: 0.0104s/iter; left time: 28.0451s
	iters: 500, epoch: 3 | loss: 0.7825164
	speed: 0.0112s/iter; left time: 28.8769s
Updating learning rate to 0.000929068657825
Epoch: 3 cost time: 5.8413777351379395
Epoch: 3, Steps: 514 | Train Loss: 0.5694706 Vali Loss: 0.4029447 Best vali loss: 0.4028638

best validation loss 0.4028637922992875

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5544616
	speed: 0.0120s/iter; left time: 23.4775s
	iters: 200, epoch: 1 | loss: 0.5009557
	speed: 0.0061s/iter; left time: 11.4055s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.8722949028015137
Epoch: 1, Steps: 257 | Train Loss: 0.5277086 Vali Loss: 0.3672177 Best vali loss: 0.3672177
	iters: 100, epoch: 2 | loss: 0.3676723
	speed: 0.0137s/iter; left time: 23.2870s
	iters: 200, epoch: 2 | loss: 0.6470698
	speed: 0.0057s/iter; left time: 9.0940s
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 1.530306100845337
Epoch: 2, Steps: 257 | Train Loss: 0.5073711 Vali Loss: 0.3760928 Best vali loss: 0.3672177
	iters: 100, epoch: 3 | loss: 0.3755044
	speed: 0.0127s/iter; left time: 18.3597s
	iters: 200, epoch: 3 | loss: 0.3296528
	speed: 0.0055s/iter; left time: 7.3840s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 1.4608848094940186
Epoch: 3, Steps: 257 | Train Loss: 0.3525786 Vali Loss: 0.3811423 Best vali loss: 0.3672177

best validation loss 0.3672177486429046

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4875861
	speed: 0.0185s/iter; left time: 17.2678s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.8526582717895508
Epoch: 1, Steps: 129 | Train Loss: 0.4875861 Vali Loss: 0.3670311 Best vali loss: 0.3670311
	iters: 100, epoch: 2 | loss: 0.5387921
	speed: 0.0175s/iter; left time: 14.1094s
Updating learning rate to 6.252043389458952e-05
Validation loss decreased (0.3670 --> 0.3640).  Saving model state dict ...
Epoch: 2 cost time: 1.4404821395874023
Epoch: 2, Steps: 129 | Train Loss: 0.5387921 Vali Loss: 0.3639807 Best vali loss: 0.3639807
	iters: 100, epoch: 3 | loss: 0.6547741
	speed: 0.0172s/iter; left time: 11.5835s
Updating learning rate to 5.063887571827247e-05
Epoch: 3 cost time: 1.460087537765503
Epoch: 3, Steps: 129 | Train Loss: 0.6547741 Vali Loss: 0.3663580 Best vali loss: 0.3639807

best validation loss 0.36398073231073164

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4597807
	speed: 0.0196s/iter; left time: 10.7026s
Updating learning rate to 3.662362225e-05
Validation loss decreased (0.3640 --> 0.3638).  Saving model state dict ...
Epoch: 4 cost time: 1.9063990116119385
Epoch: 4, Steps: 129 | Train Loss: 0.4597807 Vali Loss: 0.3638235 Best vali loss: 0.3638235
	iters: 100, epoch: 5 | loss: 0.5038663
	speed: 0.0217s/iter; left time: 9.0629s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.3638 --> 0.3585).  Saving model state dict ...
Epoch: 5 cost time: 1.741657018661499
Epoch: 5, Steps: 129 | Train Loss: 0.5038663 Vali Loss: 0.3584803 Best vali loss: 0.3584803
	iters: 100, epoch: 6 | loss: 0.6225976
	speed: 0.0181s/iter; left time: 5.2205s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.3585 --> 0.3575).  Saving model state dict ...
Epoch: 6 cost time: 1.5053348541259766
Epoch: 6, Steps: 129 | Train Loss: 0.6225976 Vali Loss: 0.3575089 Best vali loss: 0.3575089
	iters: 100, epoch: 7 | loss: 0.3739056
	speed: 0.0190s/iter; left time: 3.0178s
Updating learning rate to 2.7878072468000404e-06
Validation loss decreased (0.3575 --> 0.3552).  Saving model state dict ...
Epoch: 7 cost time: 1.5944938659667969
Epoch: 7, Steps: 129 | Train Loss: 0.3739056 Vali Loss: 0.3551879 Best vali loss: 0.3551879
	iters: 100, epoch: 8 | loss: 0.6753291
	speed: 0.0189s/iter; left time: 0.5669s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5014657974243164
Epoch: 8, Steps: 129 | Train Loss: 0.6753291 Vali Loss: 0.3559932 Best vali loss: 0.3551879

best validation loss 0.3551879487243757

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0015532343716, 'e_layers': 1, 'learning_rate': 0.0005105690972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4339423
	speed: 0.0132s/iter; left time: 25.8162s
	iters: 200, epoch: 1 | loss: 0.4132406
	speed: 0.0060s/iter; left time: 11.1422s
Updating learning rate to 0.0005105690972
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.9877264499664307
Epoch: 1, Steps: 257 | Train Loss: 0.4235914 Vali Loss: 0.3668710 Best vali loss: 0.3668710
	iters: 100, epoch: 2 | loss: 0.5055065
	speed: 0.0149s/iter; left time: 25.3125s
	iters: 200, epoch: 2 | loss: 0.3390815
	speed: 0.0062s/iter; left time: 9.8486s
Updating learning rate to 0.0002552845486
Epoch: 2 cost time: 1.659989833831787
Epoch: 2, Steps: 257 | Train Loss: 0.4222940 Vali Loss: 0.3772788 Best vali loss: 0.3668710
	iters: 100, epoch: 3 | loss: 0.7356062
	speed: 0.0108s/iter; left time: 15.6489s
	iters: 200, epoch: 3 | loss: 0.2943859
	speed: 0.0037s/iter; left time: 5.0355s
Updating learning rate to 0.0001276422743
Epoch: 3 cost time: 1.1022610664367676
Epoch: 3, Steps: 257 | Train Loss: 0.5149961 Vali Loss: 0.3810400 Best vali loss: 0.3668710
	iters: 100, epoch: 4 | loss: 0.4146059
	speed: 0.0134s/iter; left time: 15.8839s
	iters: 200, epoch: 4 | loss: 0.4955538
	speed: 0.0054s/iter; left time: 5.8325s
Updating learning rate to 6.382113715e-05
Epoch: 4 cost time: 1.4864997863769531
Epoch: 4, Steps: 257 | Train Loss: 0.4550798 Vali Loss: 0.3948875 Best vali loss: 0.3668710
	iters: 100, epoch: 5 | loss: 0.3500396
	speed: 0.0137s/iter; left time: 12.6906s
	iters: 200, epoch: 5 | loss: 0.7740214
	speed: 0.0055s/iter; left time: 4.5480s
Updating learning rate to 3.1910568575e-05
Epoch: 5 cost time: 1.5103402137756348
Epoch: 5, Steps: 257 | Train Loss: 0.5620305 Vali Loss: 0.3976230 Best vali loss: 0.3668710
	iters: 100, epoch: 6 | loss: 0.6285145
	speed: 0.0143s/iter; left time: 9.5849s
	iters: 200, epoch: 6 | loss: 0.6178002
	speed: 0.0058s/iter; left time: 3.3314s
Updating learning rate to 1.59552842875e-05
Epoch: 6 cost time: 1.7170190811157227
Epoch: 6, Steps: 257 | Train Loss: 0.6231574 Vali Loss: 0.3980011 Best vali loss: 0.3668710
	iters: 100, epoch: 7 | loss: 0.2876025
	speed: 0.0170s/iter; left time: 7.0654s
	iters: 200, epoch: 7 | loss: 0.3814375
	speed: 0.0057s/iter; left time: 1.8009s
Updating learning rate to 7.97764214375e-06
Epoch: 7 cost time: 1.592742681503296
Epoch: 7, Steps: 257 | Train Loss: 0.3345200 Vali Loss: 0.3994440 Best vali loss: 0.3668710
	iters: 100, epoch: 8 | loss: 0.4356024
	speed: 0.0140s/iter; left time: 2.2141s
	iters: 200, epoch: 8 | loss: 0.3651330
	speed: 0.0060s/iter; left time: 0.3473s
Updating learning rate to 3.988821071875e-06
Epoch: 8 cost time: 1.507873773574829
Epoch: 8, Steps: 257 | Train Loss: 0.4003677 Vali Loss: 0.3998065 Best vali loss: 0.3668710

best validation loss 0.3668710204964771

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0031492887959, 'e_layers': 2, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8471752
	speed: 0.0115s/iter; left time: 93.2883s
	iters: 200, epoch: 1 | loss: 1.0733324
	speed: 0.0058s/iter; left time: 46.3941s
	iters: 300, epoch: 1 | loss: 0.3746295
	speed: 0.0067s/iter; left time: 52.9781s
	iters: 400, epoch: 1 | loss: 0.4653437
	speed: 0.0067s/iter; left time: 52.0669s
	iters: 500, epoch: 1 | loss: 1.0074514
	speed: 0.0067s/iter; left time: 51.5956s
	iters: 600, epoch: 1 | loss: 0.3887441
	speed: 0.0067s/iter; left time: 51.1595s
	iters: 700, epoch: 1 | loss: 1.2970994
	speed: 0.0067s/iter; left time: 50.5164s
	iters: 800, epoch: 1 | loss: 1.2338969
	speed: 0.0066s/iter; left time: 48.9849s
	iters: 900, epoch: 1 | loss: 0.9685284
	speed: 0.0062s/iter; left time: 45.5985s
	iters: 1000, epoch: 1 | loss: 0.5021940
	speed: 0.0059s/iter; left time: 42.3774s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.3719).  Saving model state dict ...
Epoch: 1 cost time: 6.799466371536255
Epoch: 1, Steps: 1027 | Train Loss: 0.8158395 Vali Loss: 0.3718767 Best vali loss: 0.3718767
	iters: 100, epoch: 2 | loss: 0.4386756
	speed: 0.0204s/iter; left time: 144.4803s
	iters: 200, epoch: 2 | loss: 0.8041452
	speed: 0.0069s/iter; left time: 48.1975s
	iters: 300, epoch: 2 | loss: 0.4298292
	speed: 0.0060s/iter; left time: 41.0823s
	iters: 400, epoch: 2 | loss: 0.4378809
	speed: 0.0050s/iter; left time: 34.0534s
	iters: 500, epoch: 2 | loss: 0.2323768
	speed: 0.0057s/iter; left time: 37.8160s
	iters: 600, epoch: 2 | loss: 0.9231520
	speed: 0.0059s/iter; left time: 38.7856s
	iters: 700, epoch: 2 | loss: 0.7100488
	speed: 0.0063s/iter; left time: 40.9975s
	iters: 800, epoch: 2 | loss: 0.8954408
	speed: 0.0071s/iter; left time: 45.5284s
	iters: 900, epoch: 2 | loss: 0.3334877
	speed: 0.0070s/iter; left time: 43.8299s
	iters: 1000, epoch: 2 | loss: 0.3404430
	speed: 0.0067s/iter; left time: 41.5666s
Updating learning rate to 5.35870624e-05
Epoch: 2 cost time: 6.6196205615997314
Epoch: 2, Steps: 1027 | Train Loss: 0.5545480 Vali Loss: 0.3721027 Best vali loss: 0.3718767
	iters: 100, epoch: 3 | loss: 0.9670154
	speed: 0.0226s/iter; left time: 137.1569s
	iters: 200, epoch: 3 | loss: 0.2126868
	speed: 0.0055s/iter; left time: 32.8927s
	iters: 300, epoch: 3 | loss: 0.7698069
	speed: 0.0063s/iter; left time: 36.9263s
	iters: 400, epoch: 3 | loss: 0.3777526
	speed: 0.0072s/iter; left time: 41.4926s
	iters: 500, epoch: 3 | loss: 0.3813061
	speed: 0.0074s/iter; left time: 42.0599s
	iters: 600, epoch: 3 | loss: 0.7675736
	speed: 0.0074s/iter; left time: 41.0133s
	iters: 700, epoch: 3 | loss: 0.7702817
	speed: 0.0071s/iter; left time: 38.7158s
	iters: 800, epoch: 3 | loss: 0.6132941
	speed: 0.0066s/iter; left time: 35.5173s
	iters: 900, epoch: 3 | loss: 0.2862642
	speed: 0.0063s/iter; left time: 33.0800s
	iters: 1000, epoch: 3 | loss: 0.9112007
	speed: 0.0054s/iter; left time: 27.7253s
Updating learning rate to 2.67935312e-05
Validation loss decreased (0.3719 --> 0.3557).  Saving model state dict ...
Epoch: 3 cost time: 6.71511697769165
Epoch: 3, Steps: 1027 | Train Loss: 0.6057182 Vali Loss: 0.3557240 Best vali loss: 0.3557240
	iters: 100, epoch: 4 | loss: 0.7768052
	speed: 0.0197s/iter; left time: 99.3891s
	iters: 200, epoch: 4 | loss: 0.2407005
	speed: 0.0065s/iter; left time: 32.2371s
	iters: 300, epoch: 4 | loss: 0.3293379
	speed: 0.0069s/iter; left time: 33.3876s
	iters: 400, epoch: 4 | loss: 0.7060977
	speed: 0.0070s/iter; left time: 33.1107s
	iters: 500, epoch: 4 | loss: 0.2024549
	speed: 0.0065s/iter; left time: 29.9884s
	iters: 600, epoch: 4 | loss: 0.6063275
	speed: 0.0057s/iter; left time: 26.0527s
	iters: 700, epoch: 4 | loss: 0.8521614
	speed: 0.0053s/iter; left time: 23.4641s
	iters: 800, epoch: 4 | loss: 0.4087603
	speed: 0.0073s/iter; left time: 31.8128s
	iters: 900, epoch: 4 | loss: 0.2343835
	speed: 0.0074s/iter; left time: 31.5370s
	iters: 1000, epoch: 4 | loss: 0.3325980
	speed: 0.0074s/iter; left time: 30.6647s
Updating learning rate to 1.33967656e-05
Epoch: 4 cost time: 6.917164325714111
Epoch: 4, Steps: 1027 | Train Loss: 0.4689627 Vali Loss: 0.3585744 Best vali loss: 0.3557240
	iters: 100, epoch: 5 | loss: 0.9521782
	speed: 0.0214s/iter; left time: 85.7008s
	iters: 200, epoch: 5 | loss: 0.4826096
	speed: 0.0061s/iter; left time: 23.8426s
	iters: 300, epoch: 5 | loss: 0.3035268
	speed: 0.0056s/iter; left time: 21.4550s
	iters: 400, epoch: 5 | loss: 0.7713154
	speed: 0.0061s/iter; left time: 22.5142s
	iters: 500, epoch: 5 | loss: 0.4775730
	speed: 0.0064s/iter; left time: 23.0301s
	iters: 600, epoch: 5 | loss: 0.2448116
	speed: 0.0044s/iter; left time: 15.3797s
	iters: 700, epoch: 5 | loss: 0.4546097
	speed: 0.0059s/iter; left time: 20.1017s
	iters: 800, epoch: 5 | loss: 0.6220689
	speed: 0.0083s/iter; left time: 27.5823s
	iters: 900, epoch: 5 | loss: 0.9306306
	speed: 0.0086s/iter; left time: 27.4803s
	iters: 1000, epoch: 5 | loss: 0.2409561
	speed: 0.0065s/iter; left time: 20.1869s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 6.664686679840088
Epoch: 5, Steps: 1027 | Train Loss: 0.5480280 Vali Loss: 0.3569199 Best vali loss: 0.3557240
	iters: 100, epoch: 6 | loss: 1.2726594
	speed: 0.0224s/iter; left time: 66.9188s
	iters: 200, epoch: 6 | loss: 0.3686541
	speed: 0.0066s/iter; left time: 18.9611s
	iters: 300, epoch: 6 | loss: 0.2446878
	speed: 0.0075s/iter; left time: 20.9256s
	iters: 400, epoch: 6 | loss: 0.4477471
	speed: 0.0060s/iter; left time: 16.1899s
	iters: 500, epoch: 6 | loss: 0.6522431
	speed: 0.0069s/iter; left time: 17.8260s
	iters: 600, epoch: 6 | loss: 0.2067119
	speed: 0.0075s/iter; left time: 18.6885s
	iters: 700, epoch: 6 | loss: 0.3769359
	speed: 0.0074s/iter; left time: 17.6800s
	iters: 800, epoch: 6 | loss: 0.7677950
	speed: 0.0077s/iter; left time: 17.5547s
	iters: 900, epoch: 6 | loss: 0.2677107
	speed: 0.0069s/iter; left time: 15.0846s
	iters: 1000, epoch: 6 | loss: 1.1273826
	speed: 0.0069s/iter; left time: 14.3666s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 7.332159996032715
Epoch: 6, Steps: 1027 | Train Loss: 0.5732528 Vali Loss: 0.3648652 Best vali loss: 0.3557240
	iters: 100, epoch: 7 | loss: 0.2453562
	speed: 0.0235s/iter; left time: 45.9967s
	iters: 200, epoch: 7 | loss: 0.4705561
	speed: 0.0074s/iter; left time: 13.7981s
	iters: 300, epoch: 7 | loss: 0.4937128
	speed: 0.0070s/iter; left time: 12.3116s
	iters: 400, epoch: 7 | loss: 0.2176062
	speed: 0.0069s/iter; left time: 11.4239s
	iters: 500, epoch: 7 | loss: 0.2437450
	speed: 0.0056s/iter; left time: 8.7585s
	iters: 600, epoch: 7 | loss: 0.3955453
	speed: 0.0065s/iter; left time: 9.4483s
	iters: 700, epoch: 7 | loss: 0.5264601
	speed: 0.0078s/iter; left time: 10.5878s
	iters: 800, epoch: 7 | loss: 0.4540242
	speed: 0.0054s/iter; left time: 6.8063s
	iters: 900, epoch: 7 | loss: 0.9273263
	speed: 0.0055s/iter; left time: 6.3042s
	iters: 1000, epoch: 7 | loss: 0.6383317
	speed: 0.0053s/iter; left time: 5.5418s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 6.546628952026367
Epoch: 7, Steps: 1027 | Train Loss: 0.4612664 Vali Loss: 0.3650415 Best vali loss: 0.3557240
	iters: 100, epoch: 8 | loss: 0.3945516
	speed: 0.0175s/iter; left time: 16.2432s
	iters: 200, epoch: 8 | loss: 0.3117581
	speed: 0.0058s/iter; left time: 4.7893s
	iters: 300, epoch: 8 | loss: 1.0664945
	speed: 0.0051s/iter; left time: 3.6799s
	iters: 400, epoch: 8 | loss: 0.7627263
	speed: 0.0057s/iter; left time: 3.5640s
	iters: 500, epoch: 8 | loss: 0.5982755
	speed: 0.0058s/iter; left time: 3.0456s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0042539720696, 'e_layers': 2, 'learning_rate': 0.0002408411284, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7463074
	speed: 0.0251s/iter; left time: 23.3908s
Updating learning rate to 0.00023167465875784137
Validation loss decreased (inf --> 0.3853).  Saving model state dict ...
Epoch: 1 cost time: 2.732593059539795
Epoch: 1, Steps: 129 | Train Loss: 0.7463074 Vali Loss: 0.3852749 Best vali loss: 0.3852749
	iters: 100, epoch: 2 | loss: 0.7407286
	speed: 0.0228s/iter; left time: 18.3023s
Updating learning rate to 0.00020557076174012998
Validation loss decreased (0.3853 --> 0.3705).  Saving model state dict ...
Epoch: 2 cost time: 1.2848553657531738
Epoch: 2, Steps: 129 | Train Loss: 0.7407286 Vali Loss: 0.3705113 Best vali loss: 0.3705113
	iters: 100, epoch: 3 | loss: 0.9328638
	speed: 0.0140s/iter; left time: 9.4795s
Updating learning rate to 0.00016650351903539664
Validation loss decreased (0.3705 --> 0.3667).  Saving model state dict ...
Epoch: 3 cost time: 1.1080272197723389
Epoch: 3, Steps: 129 | Train Loss: 0.9328638 Vali Loss: 0.3667461 Best vali loss: 0.3667461

best validation loss 0.36674609441888356

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0034190960824, 'e_layers': 4, 'learning_rate': 8.10959522e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8363308
	speed: 0.0160s/iter; left time: 64.3806s
	iters: 200, epoch: 1 | loss: 0.6163191
	speed: 0.0092s/iter; left time: 35.9535s
	iters: 300, epoch: 1 | loss: 0.3774235
	speed: 0.0092s/iter; left time: 35.2369s
	iters: 400, epoch: 1 | loss: 0.4267325
	speed: 0.0085s/iter; left time: 31.4813s
	iters: 500, epoch: 1 | loss: 0.5311440
	speed: 0.0095s/iter; left time: 34.3873s
Updating learning rate to 7.800942130354682e-05
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 5.068836212158203
Epoch: 1, Steps: 514 | Train Loss: 0.5575900 Vali Loss: 0.3646156 Best vali loss: 0.3646156
	iters: 100, epoch: 2 | loss: 0.3778511
	speed: 0.0211s/iter; left time: 73.6632s
	iters: 200, epoch: 2 | loss: 1.1066896
	speed: 0.0095s/iter; left time: 32.1612s
	iters: 300, epoch: 2 | loss: 0.5862781
	speed: 0.0095s/iter; left time: 31.1989s
	iters: 400, epoch: 2 | loss: 0.5471752
	speed: 0.0092s/iter; left time: 29.3043s
	iters: 500, epoch: 2 | loss: 0.7244996
	speed: 0.0088s/iter; left time: 27.3803s
Updating learning rate to 6.921972496370005e-05
Validation loss decreased (0.3646 --> 0.3588).  Saving model state dict ...
Epoch: 2 cost time: 4.836207866668701
Epoch: 2, Steps: 514 | Train Loss: 0.6684987 Vali Loss: 0.3587875 Best vali loss: 0.3587875
	iters: 100, epoch: 3 | loss: 0.2709265
	speed: 0.0193s/iter; left time: 57.5835s
	iters: 200, epoch: 3 | loss: 0.9752169
	speed: 0.0119s/iter; left time: 34.4733s
	iters: 300, epoch: 3 | loss: 0.5011573
	speed: 0.0099s/iter; left time: 27.6190s
	iters: 400, epoch: 3 | loss: 0.8454440
	speed: 0.0104s/iter; left time: 28.0351s
	iters: 500, epoch: 3 | loss: 0.3726536
	speed: 0.0127s/iter; left time: 32.8153s
Updating learning rate to 5.606501476940563e-05
Epoch: 3 cost time: 5.555111646652222
Epoch: 3, Steps: 514 | Train Loss: 0.5930797 Vali Loss: 0.3634953 Best vali loss: 0.3587875

best validation loss 0.35878752123981655

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0009709004671, 'e_layers': 1, 'learning_rate': 0.0002959396638, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2834038
	speed: 0.0124s/iter; left time: 100.6626s
	iters: 200, epoch: 1 | loss: 0.3062579
	speed: 0.0071s/iter; left time: 56.7086s
	iters: 300, epoch: 1 | loss: 0.3687233
	speed: 0.0049s/iter; left time: 38.9635s
	iters: 400, epoch: 1 | loss: 0.3978536
	speed: 0.0042s/iter; left time: 33.1726s
	iters: 500, epoch: 1 | loss: 1.1632153
	speed: 0.0044s/iter; left time: 33.7575s
	iters: 600, epoch: 1 | loss: 1.7627746
	speed: 0.0051s/iter; left time: 38.9576s
	iters: 700, epoch: 1 | loss: 1.3332256
	speed: 0.0085s/iter; left time: 64.2459s
	iters: 800, epoch: 1 | loss: 0.6269429
	speed: 0.0077s/iter; left time: 56.9338s
	iters: 900, epoch: 1 | loss: 0.6424943
	speed: 0.0065s/iter; left time: 47.8065s
	iters: 1000, epoch: 1 | loss: 0.7401308
	speed: 0.0051s/iter; left time: 36.6211s
Updating learning rate to 0.0002846761310215457
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 6.447425127029419
Epoch: 1, Steps: 1027 | Train Loss: 0.7625022 Vali Loss: 0.3669878 Best vali loss: 0.3669878
	iters: 100, epoch: 2 | loss: 0.7249628
	speed: 0.0158s/iter; left time: 111.6922s
	iters: 200, epoch: 2 | loss: 1.0487289
	speed: 0.0044s/iter; left time: 30.6889s
	iters: 300, epoch: 2 | loss: 0.6760305
	speed: 0.0045s/iter; left time: 30.7335s
	iters: 400, epoch: 2 | loss: 0.5500907
	speed: 0.0060s/iter; left time: 40.5763s
	iters: 500, epoch: 2 | loss: 0.3708217
	speed: 0.0046s/iter; left time: 31.0594s
	iters: 600, epoch: 2 | loss: 0.5094593
	speed: 0.0040s/iter; left time: 26.2603s
	iters: 700, epoch: 2 | loss: 0.4298777
	speed: 0.0052s/iter; left time: 33.7581s
	iters: 800, epoch: 2 | loss: 0.3274353
	speed: 0.0043s/iter; left time: 27.3508s
	iters: 900, epoch: 2 | loss: 1.4922996
	speed: 0.0040s/iter; left time: 24.9154s
	iters: 1000, epoch: 2 | loss: 1.0689250
	speed: 0.0047s/iter; left time: 29.3087s
Updating learning rate to 0.0002526003034475235
Validation loss decreased (0.3670 --> 0.3657).  Saving model state dict ...
Epoch: 2 cost time: 4.788119077682495
Epoch: 2, Steps: 1027 | Train Loss: 0.7198632 Vali Loss: 0.3657310 Best vali loss: 0.3657310
	iters: 100, epoch: 3 | loss: 0.9657341
	speed: 0.0171s/iter; left time: 103.4673s
	iters: 200, epoch: 3 | loss: 0.2697815
	speed: 0.0054s/iter; left time: 32.0997s
	iters: 300, epoch: 3 | loss: 0.2635886
	speed: 0.0051s/iter; left time: 29.9172s
	iters: 400, epoch: 3 | loss: 0.1683074
	speed: 0.0052s/iter; left time: 29.8411s
	iters: 500, epoch: 3 | loss: 0.3495903
	speed: 0.0047s/iter; left time: 26.7409s
	iters: 600, epoch: 3 | loss: 0.3039691
	speed: 0.0035s/iter; left time: 19.5491s
	iters: 700, epoch: 3 | loss: 0.7351137
	speed: 0.0040s/iter; left time: 21.7110s
	iters: 800, epoch: 3 | loss: 0.7630215
	speed: 0.0041s/iter; left time: 22.1277s
	iters: 900, epoch: 3 | loss: 0.2240000
	speed: 0.0046s/iter; left time: 24.0218s
	iters: 1000, epoch: 3 | loss: 0.4985198
	speed: 0.0049s/iter; left time: 25.1562s
Updating learning rate to 0.00020459543505797737
Epoch: 3 cost time: 4.858327627182007
Epoch: 3, Steps: 1027 | Train Loss: 0.4541626 Vali Loss: 0.3783599 Best vali loss: 0.3657310

best validation loss 0.3657310338292

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0034190960824, 'e_layers': 4, 'learning_rate': 8.10959522e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7581061
	speed: 0.0219s/iter; left time: 54.1898s
	iters: 200, epoch: 4 | loss: 0.5553719
	speed: 0.0132s/iter; left time: 31.3610s
	iters: 300, epoch: 4 | loss: 0.3462252
	speed: 0.0122s/iter; left time: 27.7631s
	iters: 400, epoch: 4 | loss: 0.3390979
	speed: 0.0124s/iter; left time: 26.9225s
	iters: 500, epoch: 4 | loss: 0.4907162
	speed: 0.0080s/iter; left time: 16.5987s
Updating learning rate to 4.05479761e-05
Epoch: 4 cost time: 6.533754587173462
Epoch: 4, Steps: 514 | Train Loss: 0.4979035 Vali Loss: 0.3603605 Best vali loss: 0.3587875
	iters: 100, epoch: 5 | loss: 0.3361857
	speed: 0.0298s/iter; left time: 58.3132s
	iters: 200, epoch: 5 | loss: 0.8954988
	speed: 0.0114s/iter; left time: 21.1952s
	iters: 300, epoch: 5 | loss: 0.4752236
	speed: 0.0123s/iter; left time: 21.6013s
	iters: 400, epoch: 5 | loss: 0.4283178
	speed: 0.0119s/iter; left time: 19.7288s
	iters: 500, epoch: 5 | loss: 0.4399399
	speed: 0.0124s/iter; left time: 19.2792s
Updating learning rate to 2.5030937430594375e-05
Validation loss decreased (0.3588 --> 0.3588).  Saving model state dict ...
Epoch: 5 cost time: 6.2496888637542725
Epoch: 5, Steps: 514 | Train Loss: 0.5150331 Vali Loss: 0.3587602 Best vali loss: 0.3587602
	iters: 100, epoch: 6 | loss: 0.2517051
	speed: 0.0213s/iter; left time: 30.7940s
	iters: 200, epoch: 6 | loss: 0.8363736
	speed: 0.0114s/iter; left time: 15.3682s
	iters: 300, epoch: 6 | loss: 0.4944583
	speed: 0.0126s/iter; left time: 15.6105s
	iters: 400, epoch: 6 | loss: 0.7709597
	speed: 0.0148s/iter; left time: 16.8643s
	iters: 500, epoch: 6 | loss: 0.3571340
	speed: 0.0121s/iter; left time: 12.5794s
Updating learning rate to 1.1876227236299943e-05
Validation loss decreased (0.3588 --> 0.3573).  Saving model state dict ...
Epoch: 6 cost time: 6.399324178695679
Epoch: 6, Steps: 514 | Train Loss: 0.5421262 Vali Loss: 0.3572766 Best vali loss: 0.3572766
	iters: 100, epoch: 7 | loss: 0.4977449
	speed: 0.0260s/iter; left time: 24.1202s
	iters: 200, epoch: 7 | loss: 0.8462793
	speed: 0.0116s/iter; left time: 9.6203s
	iters: 300, epoch: 7 | loss: 1.0087003
	speed: 0.0115s/iter; left time: 8.3588s
	iters: 400, epoch: 7 | loss: 0.4156489
	speed: 0.0119s/iter; left time: 7.4923s
	iters: 500, epoch: 7 | loss: 0.4759352
	speed: 0.0113s/iter; left time: 5.9620s
Updating learning rate to 3.0865308964531722e-06
Validation loss decreased (0.3573 --> 0.3573).  Saving model state dict ...
Epoch: 7 cost time: 5.979950428009033
Epoch: 7, Steps: 514 | Train Loss: 0.6488617 Vali Loss: 0.3572690 Best vali loss: 0.3572690
	iters: 100, epoch: 8 | loss: 0.5970366
	speed: 0.0283s/iter; left time: 11.7534s
	iters: 200, epoch: 8 | loss: 0.3991808
	speed: 0.0120s/iter; left time: 3.7790s
	iters: 300, epoch: 8 | loss: 0.5584828
	speed: 0.0141s/iter; left time: 3.0253s
	iters: 400, epoch: 8 | loss: 0.5058028
	speed: 0.0124s/iter; left time: 1.4285s
	iters: 500, epoch: 8 | loss: 0.4626539
	speed: 0.0101s/iter; left time: 0.1515s
Updating learning rate to 0.0
Validation loss decreased (0.3573 --> 0.3570).  Saving model state dict ...
Epoch: 8 cost time: 6.213557720184326
Epoch: 8, Steps: 514 | Train Loss: 0.5046314 Vali Loss: 0.3570215 Best vali loss: 0.3570215

best validation loss 0.3570214772329818

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0051001719473, 'e_layers': 3, 'learning_rate': 8.73188916e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4422484
	speed: 0.0285s/iter; left time: 55.6881s
	iters: 200, epoch: 1 | loss: 0.6019421
	speed: 0.0201s/iter; left time: 37.2885s
Updating learning rate to 8.73188916e-05
Validation loss decreased (inf --> 0.4157).  Saving model state dict ...
Epoch: 1 cost time: 5.760693550109863
Epoch: 1, Steps: 257 | Train Loss: 0.5220952 Vali Loss: 0.4156889 Best vali loss: 0.4156889
	iters: 100, epoch: 2 | loss: 0.3958360
	speed: 0.0645s/iter; left time: 109.7089s
	iters: 200, epoch: 2 | loss: 0.7145848
	speed: 0.0246s/iter; left time: 39.3619s
Updating learning rate to 4.36594458e-05
Validation loss decreased (0.4157 --> 0.3961).  Saving model state dict ...
Epoch: 2 cost time: 6.2711663246154785
Epoch: 2, Steps: 257 | Train Loss: 0.5552104 Vali Loss: 0.3961122 Best vali loss: 0.3961122
	iters: 100, epoch: 3 | loss: 0.4162867
	speed: 0.0295s/iter; left time: 42.5961s
	iters: 200, epoch: 3 | loss: 0.6639072
	speed: 0.0096s/iter; left time: 12.8399s
Updating learning rate to 2.18297229e-05
Validation loss decreased (0.3961 --> 0.3907).  Saving model state dict ...
Epoch: 3 cost time: 2.52156138420105
Epoch: 3, Steps: 257 | Train Loss: 0.5400969 Vali Loss: 0.3907494 Best vali loss: 0.3907494
	iters: 100, epoch: 4 | loss: 0.6896855
	speed: 0.0328s/iter; left time: 38.9083s
	iters: 200, epoch: 4 | loss: 0.5944955
	speed: 0.0133s/iter; left time: 14.3989s
Updating learning rate to 1.091486145e-05
Validation loss decreased (0.3907 --> 0.3885).  Saving model state dict ...
Epoch: 4 cost time: 3.6199862957000732
Epoch: 4, Steps: 257 | Train Loss: 0.6420905 Vali Loss: 0.3884826 Best vali loss: 0.3884826
	iters: 100, epoch: 5 | loss: 0.7898331
	speed: 0.0283s/iter; left time: 26.2673s
	iters: 200, epoch: 5 | loss: 0.9904492
	speed: 0.0102s/iter; left time: 8.4639s
Updating learning rate to 5.457430725e-06
Validation loss decreased (0.3885 --> 0.3875).  Saving model state dict ...
Epoch: 5 cost time: 2.9897513389587402
Epoch: 5, Steps: 257 | Train Loss: 0.8901412 Vali Loss: 0.3875061 Best vali loss: 0.3875061
	iters: 100, epoch: 6 | loss: 0.7325971
	speed: 0.0314s/iter; left time: 21.1006s
	iters: 200, epoch: 6 | loss: 0.7989827
	speed: 0.0090s/iter; left time: 5.1209s
Updating learning rate to 2.7287153625e-06
Validation loss decreased (0.3875 --> 0.3870).  Saving model state dict ...
Epoch: 6 cost time: 2.3792052268981934
Epoch: 6, Steps: 257 | Train Loss: 0.7657899 Vali Loss: 0.3870086 Best vali loss: 0.3870086
	iters: 100, epoch: 7 | loss: 0.7223638
	speed: 0.0204s/iter; left time: 8.4679s
	iters: 200, epoch: 7 | loss: 0.7300197
	speed: 0.0090s/iter; left time: 2.8286s
Updating learning rate to 1.36435768125e-06
Validation loss decreased (0.3870 --> 0.3868).  Saving model state dict ...
Epoch: 7 cost time: 2.4712657928466797
Epoch: 7, Steps: 257 | Train Loss: 0.7261918 Vali Loss: 0.3867748 Best vali loss: 0.3867748
	iters: 100, epoch: 8 | loss: 0.4833723
	speed: 0.0201s/iter; left time: 3.1792s
	iters: 200, epoch: 8 | loss: 0.6403594
	speed: 0.0067s/iter; left time: 0.3908s
Updating learning rate to 6.82178840625e-07
Validation loss decreased (0.3868 --> 0.3867).  Saving model state dict ...
Epoch: 8 cost time: 2.1015453338623047
Epoch: 8, Steps: 257 | Train Loss: 0.5618659 Vali Loss: 0.3866568 Best vali loss: 0.3866568

best validation loss 0.386656839791356

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019719493758, 'e_layers': 2, 'learning_rate': 0.000382679163, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3492265
	speed: 0.0177s/iter; left time: 34.6263s
	iters: 200, epoch: 1 | loss: 0.5116115
	speed: 0.0133s/iter; left time: 24.7218s
Updating learning rate to 0.0003681143046071253
Validation loss decreased (inf --> 0.3754).  Saving model state dict ...
Epoch: 1 cost time: 3.558466911315918
Epoch: 1, Steps: 257 | Train Loss: 0.4304190 Vali Loss: 0.3753617 Best vali loss: 0.3753617
	iters: 100, epoch: 2 | loss: 0.5906718
	speed: 0.0303s/iter; left time: 51.5376s
	iters: 200, epoch: 2 | loss: 0.8272281
	speed: 0.0132s/iter; left time: 21.0527s
Updating learning rate to 0.0003266370970880461
Validation loss decreased (0.3754 --> 0.3502).  Saving model state dict ...
Epoch: 2 cost time: 3.4075236320495605
Epoch: 2, Steps: 257 | Train Loss: 0.7089500 Vali Loss: 0.3501920 Best vali loss: 0.3501920
	iters: 100, epoch: 3 | loss: 0.4309317
	speed: 0.0328s/iter; left time: 47.3231s
	iters: 200, epoch: 3 | loss: 0.5598973
	speed: 0.0203s/iter; left time: 27.2615s
Updating learning rate to 0.00026456206929571986
Validation loss decreased (0.3502 --> 0.3460).  Saving model state dict ...
Epoch: 3 cost time: 4.8746116161346436
Epoch: 3, Steps: 257 | Train Loss: 0.4954145 Vali Loss: 0.3459883 Best vali loss: 0.3459883
	iters: 100, epoch: 4 | loss: 0.6032854
	speed: 0.0713s/iter; left time: 84.6209s
	iters: 200, epoch: 4 | loss: 0.3989347
	speed: 0.0216s/iter; left time: 23.4473s
Updating learning rate to 0.0001913395815
Validation loss decreased (0.3460 --> 0.3446).  Saving model state dict ...
Epoch: 4 cost time: 5.6495139598846436
Epoch: 4, Steps: 257 | Train Loss: 0.5011101 Vali Loss: 0.3446080 Best vali loss: 0.3446080
	iters: 100, epoch: 5 | loss: 0.2867763
	speed: 0.0591s/iter; left time: 54.9402s
	iters: 200, epoch: 5 | loss: 0.2924128
	speed: 0.0140s/iter; left time: 11.5854s
Updating learning rate to 0.00011811709370428018
Epoch: 5 cost time: 3.911088705062866
Epoch: 5, Steps: 257 | Train Loss: 0.2895945 Vali Loss: 0.3511778 Best vali loss: 0.3446080
	iters: 100, epoch: 6 | loss: 0.4845419
	speed: 0.0220s/iter; left time: 14.7925s
	iters: 200, epoch: 6 | loss: 0.4592831
	speed: 0.0105s/iter; left time: 6.0145s
Updating learning rate to 5.604206591195394e-05
Epoch: 6 cost time: 2.7841713428497314
Epoch: 6, Steps: 257 | Train Loss: 0.4719125 Vali Loss: 0.3567052 Best vali loss: 0.3446080
	iters: 100, epoch: 7 | loss: 0.3173063
	speed: 0.0320s/iter; left time: 13.2650s
	iters: 200, epoch: 7 | loss: 0.3680148
	speed: 0.0154s/iter; left time: 4.8506s
Updating learning rate to 1.4564858392874752e-05
Epoch: 7 cost time: 4.058453559875488
Epoch: 7, Steps: 257 | Train Loss: 0.3426605 Vali Loss: 0.3622458 Best vali loss: 0.3446080
	iters: 100, epoch: 8 | loss: 0.4675523
	speed: 0.0271s/iter; left time: 4.2881s
	iters: 200, epoch: 8 | loss: 0.4459277
	speed: 0.0102s/iter; left time: 0.5911s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.8833508491516113
Epoch: 8, Steps: 257 | Train Loss: 0.4567400 Vali Loss: 0.3667208 Best vali loss: 0.3446080

best validation loss 0.34460798615556804

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.010890309514, 'e_layers': 4, 'learning_rate': 7.09981557e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2856468
	speed: 0.0175s/iter; left time: 141.7622s
	iters: 200, epoch: 1 | loss: 0.4625647
	speed: 0.0103s/iter; left time: 82.2195s
	iters: 300, epoch: 1 | loss: 0.5243073
	speed: 0.0112s/iter; left time: 88.3055s
	iters: 400, epoch: 1 | loss: 0.3414793
	speed: 0.0106s/iter; left time: 82.6834s
	iters: 500, epoch: 1 | loss: 0.1868972
	speed: 0.0082s/iter; left time: 63.1579s
	iters: 600, epoch: 1 | loss: 0.3855751
	speed: 0.0083s/iter; left time: 63.2107s
	iters: 700, epoch: 1 | loss: 0.6767062
	speed: 0.0091s/iter; left time: 68.1136s
	iters: 800, epoch: 1 | loss: 0.4149170
	speed: 0.0102s/iter; left time: 75.4850s
	iters: 900, epoch: 1 | loss: 0.5649771
	speed: 0.0109s/iter; left time: 80.0106s
	iters: 1000, epoch: 1 | loss: 1.5590330
	speed: 0.0103s/iter; left time: 74.5585s
Updating learning rate to 6.829594929863977e-05
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 10.595595598220825
Epoch: 1, Steps: 1027 | Train Loss: 0.6402104 Vali Loss: 0.3646863 Best vali loss: 0.3646863
	iters: 100, epoch: 2 | loss: 0.2640534
	speed: 0.0232s/iter; left time: 164.1602s
	iters: 200, epoch: 2 | loss: 0.8295271
	speed: 0.0095s/iter; left time: 66.4960s
	iters: 300, epoch: 2 | loss: 0.8696333
	speed: 0.0093s/iter; left time: 64.3468s
	iters: 400, epoch: 2 | loss: 0.3587085
	speed: 0.0087s/iter; left time: 59.0767s
	iters: 500, epoch: 2 | loss: 0.3106427
	speed: 0.0072s/iter; left time: 47.9807s
	iters: 600, epoch: 2 | loss: 0.3275538
	speed: 0.0096s/iter; left time: 63.1350s
	iters: 700, epoch: 2 | loss: 0.6985648
	speed: 0.0068s/iter; left time: 43.8466s
	iters: 800, epoch: 2 | loss: 0.2718225
	speed: 0.0087s/iter; left time: 55.7679s
	iters: 900, epoch: 2 | loss: 1.2319165
	speed: 0.0085s/iter; left time: 53.4679s
	iters: 1000, epoch: 2 | loss: 0.4635524
	speed: 0.0091s/iter; left time: 56.5465s
Updating learning rate to 6.0600716523604165e-05
Epoch: 2 cost time: 8.86727786064148
Epoch: 2, Steps: 1027 | Train Loss: 0.5625975 Vali Loss: 0.3684237 Best vali loss: 0.3646863
	iters: 100, epoch: 3 | loss: 0.4460913
	speed: 0.0209s/iter; left time: 126.9833s
	iters: 200, epoch: 3 | loss: 0.2084602
	speed: 0.0086s/iter; left time: 51.3049s
	iters: 300, epoch: 3 | loss: 0.8153142
	speed: 0.0094s/iter; left time: 54.9745s
	iters: 400, epoch: 3 | loss: 0.4808428
	speed: 0.0073s/iter; left time: 41.9709s
	iters: 500, epoch: 3 | loss: 0.4387473
	speed: 0.0076s/iter; left time: 43.2562s
	iters: 600, epoch: 3 | loss: 0.3896303
	speed: 0.0095s/iter; left time: 52.6219s
	iters: 700, epoch: 3 | loss: 0.3192570
	speed: 0.0087s/iter; left time: 47.4551s
	iters: 800, epoch: 3 | loss: 0.4624158
	speed: 0.0081s/iter; left time: 43.2311s
	iters: 900, epoch: 3 | loss: 0.3281886
	speed: 0.0078s/iter; left time: 41.1145s
	iters: 1000, epoch: 3 | loss: 0.8830988
	speed: 0.0092s/iter; left time: 47.4368s
Updating learning rate to 4.9083986807433535e-05
Epoch: 3 cost time: 8.861326456069946
Epoch: 3, Steps: 1027 | Train Loss: 0.4772046 Vali Loss: 0.3758364 Best vali loss: 0.3646863

best validation loss 0.3646862796341272

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6248721
	speed: 0.0308s/iter; left time: 28.7265s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.4114).  Saving model state dict ...
Epoch: 1 cost time: 3.353502035140991
Epoch: 1, Steps: 129 | Train Loss: 0.6248721 Vali Loss: 0.4114492 Best vali loss: 0.4114492
	iters: 100, epoch: 2 | loss: 0.7707484
	speed: 0.0539s/iter; left time: 43.3631s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.4114 --> 0.3933).  Saving model state dict ...
Epoch: 2 cost time: 3.685565948486328
Epoch: 2, Steps: 129 | Train Loss: 0.7707484 Vali Loss: 0.3933034 Best vali loss: 0.3933034
	iters: 100, epoch: 3 | loss: 0.4905261
	speed: 0.0603s/iter; left time: 40.6874s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.3933 --> 0.3861).  Saving model state dict ...
Epoch: 3 cost time: 4.227184057235718
Epoch: 3, Steps: 129 | Train Loss: 0.4905261 Vali Loss: 0.3860705 Best vali loss: 0.3860705

best validation loss 0.38607048538672667

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0045499900215, 'e_layers': 3, 'learning_rate': 0.0001562179321, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9437967
	speed: 0.0277s/iter; left time: 54.3032s
	iters: 200, epoch: 1 | loss: 0.6132233
	speed: 0.0168s/iter; left time: 31.1973s
Updating learning rate to 0.00015027224108921395
Validation loss decreased (inf --> 0.3808).  Saving model state dict ...
Epoch: 1 cost time: 5.423396587371826
Epoch: 1, Steps: 257 | Train Loss: 0.7785100 Vali Loss: 0.3808042 Best vali loss: 0.3808042
	iters: 100, epoch: 2 | loss: 0.5306835
	speed: 0.0620s/iter; left time: 105.3806s
	iters: 200, epoch: 2 | loss: 0.5632651
	speed: 0.0253s/iter; left time: 40.5110s
Updating learning rate to 0.0001333403456154248
Validation loss decreased (0.3808 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 6.211183786392212
Epoch: 2, Steps: 257 | Train Loss: 0.5469743 Vali Loss: 0.3670451 Best vali loss: 0.3670451
	iters: 100, epoch: 3 | loss: 0.8360679
	speed: 0.0689s/iter; left time: 99.4547s
	iters: 200, epoch: 3 | loss: 0.3644255
	speed: 0.0239s/iter; left time: 32.1146s
Updating learning rate to 0.00010799997327650227
Epoch: 3 cost time: 5.678201675415039
Epoch: 3, Steps: 257 | Train Loss: 0.6002467 Vali Loss: 0.3686194 Best vali loss: 0.3670451

best validation loss 0.36704513110908404

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.010890309514, 'e_layers': 4, 'learning_rate': 7.09981557e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.2766128
	speed: 0.0194s/iter; left time: 97.5751s
	iters: 200, epoch: 4 | loss: 0.4076382
	speed: 0.0142s/iter; left time: 70.1558s
	iters: 300, epoch: 4 | loss: 0.5404891
	speed: 0.0131s/iter; left time: 63.4953s
	iters: 400, epoch: 4 | loss: 0.3080291
	speed: 0.0144s/iter; left time: 68.0856s
	iters: 500, epoch: 4 | loss: 0.2037010
	speed: 0.0125s/iter; left time: 57.8725s
	iters: 600, epoch: 4 | loss: 0.2879698
	speed: 0.0108s/iter; left time: 49.1162s
	iters: 700, epoch: 4 | loss: 0.4392222
	speed: 0.0098s/iter; left time: 43.6328s
	iters: 800, epoch: 4 | loss: 0.3615492
	speed: 0.0121s/iter; left time: 52.5837s
	iters: 900, epoch: 4 | loss: 0.4460643
	speed: 0.0129s/iter; left time: 54.6038s
	iters: 1000, epoch: 4 | loss: 1.2564057
	speed: 0.0118s/iter; left time: 48.8545s
Updating learning rate to 3.549907785e-05
Validation loss decreased (0.3647 --> 0.3561).  Saving model state dict ...
Epoch: 4 cost time: 13.127368211746216
Epoch: 4, Steps: 1027 | Train Loss: 0.5527681 Vali Loss: 0.3560810 Best vali loss: 0.3560810
	iters: 100, epoch: 5 | loss: 0.2465263
	speed: 0.0401s/iter; left time: 160.9193s
	iters: 200, epoch: 5 | loss: 0.8254884
	speed: 0.0121s/iter; left time: 47.3597s
	iters: 300, epoch: 5 | loss: 0.7216853
	speed: 0.0139s/iter; left time: 52.8241s
	iters: 400, epoch: 5 | loss: 0.2620778
	speed: 0.0118s/iter; left time: 43.9116s
	iters: 500, epoch: 5 | loss: 0.2878701
	speed: 0.0139s/iter; left time: 50.3039s
	iters: 600, epoch: 5 | loss: 0.2862181
	speed: 0.0142s/iter; left time: 49.8455s
	iters: 700, epoch: 5 | loss: 0.5414513
	speed: 0.0100s/iter; left time: 34.2539s
	iters: 800, epoch: 5 | loss: 0.2817450
	speed: 0.0145s/iter; left time: 47.9592s
	iters: 900, epoch: 5 | loss: 1.1621127
	speed: 0.0131s/iter; left time: 41.9644s
	iters: 1000, epoch: 5 | loss: 0.3516613
	speed: 0.0098s/iter; left time: 30.5947s
Updating learning rate to 2.191416889256647e-05
Epoch: 5 cost time: 13.038790941238403
Epoch: 5, Steps: 1027 | Train Loss: 0.4966836 Vali Loss: 0.3623166 Best vali loss: 0.3560810
	iters: 100, epoch: 6 | loss: 0.3479616
	speed: 0.0242s/iter; left time: 72.0960s
	iters: 200, epoch: 6 | loss: 0.1842332
	speed: 0.0088s/iter; left time: 25.2991s
	iters: 300, epoch: 6 | loss: 0.6597329
	speed: 0.0102s/iter; left time: 28.2997s
	iters: 400, epoch: 6 | loss: 0.4624580
	speed: 0.0103s/iter; left time: 27.6561s
	iters: 500, epoch: 6 | loss: 0.4533194
	speed: 0.0098s/iter; left time: 25.2445s
	iters: 600, epoch: 6 | loss: 0.3981392
	speed: 0.0104s/iter; left time: 25.7621s
	iters: 700, epoch: 6 | loss: 0.2924942
	speed: 0.0099s/iter; left time: 23.6847s
	iters: 800, epoch: 6 | loss: 0.3941191
	speed: 0.0098s/iter; left time: 22.3314s
	iters: 900, epoch: 6 | loss: 0.2882262
	speed: 0.0105s/iter; left time: 22.8954s
	iters: 1000, epoch: 6 | loss: 0.8821271
	speed: 0.0091s/iter; left time: 18.8866s
Updating learning rate to 1.0397439176395836e-05
Epoch: 6 cost time: 10.00798773765564
Epoch: 6, Steps: 1027 | Train Loss: 0.4362811 Vali Loss: 0.3719192 Best vali loss: 0.3560810
	iters: 100, epoch: 7 | loss: 0.3447554
	speed: 0.0267s/iter; left time: 52.2147s
	iters: 200, epoch: 7 | loss: 0.4396690
	speed: 0.0104s/iter; left time: 19.2527s
	iters: 300, epoch: 7 | loss: 1.0855985
	speed: 0.0106s/iter; left time: 18.6471s
	iters: 400, epoch: 7 | loss: 0.3883101
	speed: 0.0093s/iter; left time: 15.3374s
	iters: 500, epoch: 7 | loss: 0.3963505
	speed: 0.0083s/iter; left time: 12.8356s
	iters: 600, epoch: 7 | loss: 0.4329522
	speed: 0.0105s/iter; left time: 15.2676s
	iters: 700, epoch: 7 | loss: 0.2332559
	speed: 0.0094s/iter; left time: 12.8018s
	iters: 800, epoch: 7 | loss: 0.3294941
	speed: 0.0104s/iter; left time: 13.0839s
	iters: 900, epoch: 7 | loss: 0.3333022
	speed: 0.0094s/iter; left time: 10.8509s
	iters: 1000, epoch: 7 | loss: 0.2546540
	speed: 0.0098s/iter; left time: 10.3058s
Updating learning rate to 2.702206401360226e-06
Epoch: 7 cost time: 10.120402574539185
Epoch: 7, Steps: 1027 | Train Loss: 0.4238342 Vali Loss: 0.3566811 Best vali loss: 0.3560810
	iters: 100, epoch: 8 | loss: 0.3095174
	speed: 0.0254s/iter; left time: 23.5567s
	iters: 200, epoch: 8 | loss: 0.3554009
	speed: 0.0109s/iter; left time: 9.0540s
	iters: 300, epoch: 8 | loss: 0.2900286
	speed: 0.0101s/iter; left time: 7.3316s
	iters: 400, epoch: 8 | loss: 0.3641787
	speed: 0.0109s/iter; left time: 6.8237s
	iters: 500, epoch: 8 | loss: 0.4253954
	speed: 0.0112s/iter; left time: 5.8950s
	iters: 600, epoch: 8 | loss: 0.6838428
	speed: 0.0111s/iter; left time: 4.7627s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0042539720696, 'e_layers': 2, 'learning_rate': 0.0003142995314, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7462595
	speed: 0.0154s/iter; left time: 30.0767s
	iters: 200, epoch: 1 | loss: 0.7032542
	speed: 0.0081s/iter; left time: 15.0603s
Updating learning rate to 0.0003142995314
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 2.483840227127075
Epoch: 1, Steps: 257 | Train Loss: 0.7247568 Vali Loss: 0.3671235 Best vali loss: 0.3671235
	iters: 100, epoch: 2 | loss: 0.9376515
	speed: 0.0195s/iter; left time: 33.1214s
	iters: 200, epoch: 2 | loss: 0.4032749
	speed: 0.0083s/iter; left time: 13.3007s
Updating learning rate to 0.0001571497657
Epoch: 2 cost time: 2.3247971534729004
Epoch: 2, Steps: 257 | Train Loss: 0.6704632 Vali Loss: 0.3679635 Best vali loss: 0.3671235
	iters: 100, epoch: 3 | loss: 0.4257162
	speed: 0.0177s/iter; left time: 25.5611s
	iters: 200, epoch: 3 | loss: 0.5159147
	speed: 0.0082s/iter; left time: 11.0236s
Updating learning rate to 7.857488285e-05
Epoch: 3 cost time: 2.2265357971191406
Epoch: 3, Steps: 257 | Train Loss: 0.4708154 Vali Loss: 0.3671698 Best vali loss: 0.3671235
	iters: 100, epoch: 4 | loss: 0.5325495
	speed: 0.0216s/iter; left time: 25.6184s
	iters: 200, epoch: 4 | loss: 0.8978751
	speed: 0.0090s/iter; left time: 9.7674s
Updating learning rate to 3.9287441425e-05
Epoch: 4 cost time: 2.3558595180511475
Epoch: 4, Steps: 257 | Train Loss: 0.7152123 Vali Loss: 0.3708158 Best vali loss: 0.3671235
	iters: 100, epoch: 5 | loss: 0.4960994
	speed: 0.0192s/iter; left time: 17.8678s
	iters: 200, epoch: 5 | loss: 0.4129607
	speed: 0.0088s/iter; left time: 7.2545s
Updating learning rate to 1.96437207125e-05
Epoch: 5 cost time: 2.495088815689087
Epoch: 5, Steps: 257 | Train Loss: 0.4545300 Vali Loss: 0.3703307 Best vali loss: 0.3671235
	iters: 100, epoch: 6 | loss: 0.5781095
	speed: 0.0215s/iter; left time: 14.4479s
	iters: 200, epoch: 6 | loss: 0.4348614
	speed: 0.0089s/iter; left time: 5.0683s
Updating learning rate to 9.82186035625e-06
Epoch: 6 cost time: 2.3485002517700195
Epoch: 6, Steps: 257 | Train Loss: 0.5064854 Vali Loss: 0.3707401 Best vali loss: 0.3671235
	iters: 100, epoch: 7 | loss: 0.5675427
	speed: 0.0187s/iter; left time: 7.7403s
	iters: 200, epoch: 7 | loss: 0.6734077
	speed: 0.0096s/iter; left time: 3.0371s
Updating learning rate to 4.910930178125e-06
Epoch: 7 cost time: 2.3973278999328613
Epoch: 7, Steps: 257 | Train Loss: 0.6204752 Vali Loss: 0.3710155 Best vali loss: 0.3671235
	iters: 100, epoch: 8 | loss: 0.7688755
	speed: 0.0199s/iter; left time: 3.1405s
	iters: 200, epoch: 8 | loss: 0.5305466
	speed: 0.0091s/iter; left time: 0.5272s
Updating learning rate to 2.4554650890625e-06
Epoch: 8 cost time: 2.3901138305664062
Epoch: 8, Steps: 257 | Train Loss: 0.6497110 Vali Loss: 0.3711841 Best vali loss: 0.3671235

best validation loss 0.367123464985306

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0013296661499, 'e_layers': 3, 'learning_rate': 0.0001100824216, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6899169
	speed: 0.0194s/iter; left time: 18.1075s
Updating learning rate to 0.00010589265890275919
Validation loss decreased (inf --> 0.3643).  Saving model state dict ...
Epoch: 1 cost time: 1.9677090644836426
Epoch: 1, Steps: 129 | Train Loss: 0.6899169 Vali Loss: 0.3642879 Best vali loss: 0.3642879
	iters: 100, epoch: 2 | loss: 0.6970158
	speed: 0.0197s/iter; left time: 15.8453s
Updating learning rate to 9.396122420139823e-05
Validation loss decreased (0.3643 --> 0.3614).  Saving model state dict ...
Epoch: 2 cost time: 1.5846920013427734
Epoch: 2, Steps: 129 | Train Loss: 0.6970158 Vali Loss: 0.3613831 Best vali loss: 0.3613831
	iters: 100, epoch: 3 | loss: 0.5496426
	speed: 0.0191s/iter; left time: 12.8771s
Updating learning rate to 7.610457027047445e-05
Epoch: 3 cost time: 1.480039358139038
Epoch: 3, Steps: 129 | Train Loss: 0.5496426 Vali Loss: 0.3632511 Best vali loss: 0.3613831
	iters: 100, epoch: 4 | loss: 0.3516631
	speed: 0.0274s/iter; left time: 14.9641s
Updating learning rate to 5.50412108e-05
Epoch: 4 cost time: 2.2048728466033936
Epoch: 4, Steps: 129 | Train Loss: 0.3516631 Vali Loss: 0.3758551 Best vali loss: 0.3613831
	iters: 100, epoch: 5 | loss: 0.7086073
	speed: 0.0239s/iter; left time: 9.9719s
Updating learning rate to 3.3977851329525555e-05
Epoch: 5 cost time: 2.1015658378601074
Epoch: 5, Steps: 129 | Train Loss: 0.7086073 Vali Loss: 0.3824753 Best vali loss: 0.3613831
	iters: 100, epoch: 6 | loss: 0.4585795
	speed: 0.0305s/iter; left time: 8.7706s
Updating learning rate to 1.6121197398601768e-05
Epoch: 6 cost time: 2.568180561065674
Epoch: 6, Steps: 129 | Train Loss: 0.4585795 Vali Loss: 0.3684850 Best vali loss: 0.3613831
	iters: 100, epoch: 7 | loss: 0.2899963
	speed: 0.0328s/iter; left time: 5.2216s
Updating learning rate to 4.189762697240813e-06
Epoch: 7 cost time: 2.351818561553955
Epoch: 7, Steps: 129 | Train Loss: 0.2899963 Vali Loss: 0.3680289 Best vali loss: 0.3613831
	iters: 100, epoch: 8 | loss: 0.4990059
	speed: 0.0332s/iter; left time: 0.9945s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.887538433074951
Epoch: 8, Steps: 129 | Train Loss: 0.4990059 Vali Loss: 0.3677916 Best vali loss: 0.3613831

best validation loss 0.3613831106946604

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047346959752, 'e_layers': 2, 'learning_rate': 6.2121158e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.2121158e-05
Validation loss decreased (inf --> 0.4399).  Saving model state dict ...
Epoch: 1 cost time: 3.0940394401550293
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4399440 Best vali loss: 0.4399440
Updating learning rate to 3.1060579e-05
Validation loss decreased (0.4399 --> 0.4298).  Saving model state dict ...
Epoch: 2 cost time: 2.6561458110809326
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4297973 Best vali loss: 0.4297973
Updating learning rate to 1.55302895e-05
Validation loss decreased (0.4298 --> 0.4255).  Saving model state dict ...
Epoch: 3 cost time: 1.9186606407165527
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4254842 Best vali loss: 0.4254842

best validation loss 0.4254841755790186

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0037119342294, 'e_layers': 1, 'learning_rate': 0.001111853217, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0010695358236715651
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 1.6550064086914062
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3734623 Best vali loss: 0.3734623
Updating learning rate to 0.0009490260832123891
Validation loss decreased (0.3735 --> 0.3718).  Saving model state dict ...
Epoch: 2 cost time: 0.6117172241210938
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3717517 Best vali loss: 0.3717517
Updating learning rate to 0.0007686705111838636
Epoch: 3 cost time: 0.401841402053833
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3731352 Best vali loss: 0.3717517

best validation loss 0.3717517336717055

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012054035715, 'e_layers': 1, 'learning_rate': 0.000380413518, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5481123
	speed: 0.0167s/iter; left time: 67.1598s
	iters: 200, epoch: 1 | loss: 0.5468590
	speed: 0.0084s/iter; left time: 32.9594s
	iters: 300, epoch: 1 | loss: 0.3015932
	speed: 0.0089s/iter; left time: 34.0470s
	iters: 400, epoch: 1 | loss: 0.4088464
	speed: 0.0099s/iter; left time: 36.9357s
	iters: 500, epoch: 1 | loss: 0.7577599
	speed: 0.0095s/iter; left time: 34.3553s
Updating learning rate to 0.000365934890585407
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 5.1835036277771
Epoch: 1, Steps: 514 | Train Loss: 0.5126342 Vali Loss: 0.3727699 Best vali loss: 0.3727699
	iters: 100, epoch: 2 | loss: 0.9733541
	speed: 0.0336s/iter; left time: 117.6451s
	iters: 200, epoch: 2 | loss: 0.5171930
	speed: 0.0088s/iter; left time: 29.9035s
	iters: 300, epoch: 2 | loss: 0.3063539
	speed: 0.0066s/iter; left time: 21.9221s
	iters: 400, epoch: 2 | loss: 0.5494011
	speed: 0.0046s/iter; left time: 14.6215s
	iters: 500, epoch: 2 | loss: 0.6860271
	speed: 0.0059s/iter; left time: 18.3731s
Updating learning rate to 0.00032470324811641535
Epoch: 2 cost time: 3.774143934249878
Epoch: 2, Steps: 514 | Train Loss: 0.6064658 Vali Loss: 0.3801475 Best vali loss: 0.3727699
	iters: 100, epoch: 3 | loss: 0.4004326
	speed: 0.0253s/iter; left time: 75.3777s
	iters: 200, epoch: 3 | loss: 0.6251380
	speed: 0.0085s/iter; left time: 24.4822s
	iters: 300, epoch: 3 | loss: 0.5300840
	speed: 0.0084s/iter; left time: 23.5279s
	iters: 400, epoch: 3 | loss: 0.5118213
	speed: 0.0085s/iter; left time: 22.7638s
	iters: 500, epoch: 3 | loss: 0.5160651
	speed: 0.0109s/iter; left time: 28.1823s
Updating learning rate to 0.00026299573439315943
Epoch: 3 cost time: 4.365094184875488
Epoch: 3, Steps: 514 | Train Loss: 0.5167082 Vali Loss: 0.3762901 Best vali loss: 0.3727699

best validation loss 0.3727698779234952

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0037119342294, 'e_layers': 1, 'learning_rate': 0.001111853217, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0005559266085
Epoch: 4 cost time: 1.8919174671173096
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4015648 Best vali loss: 0.3717517
Updating learning rate to 0.0003431827058161366
Epoch: 5 cost time: 0.7093925476074219
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3944231 Best vali loss: 0.3717517
Updating learning rate to 0.00016282713378761108
Epoch: 6 cost time: 0.7984554767608643
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3944974 Best vali loss: 0.3717517
Updating learning rate to 4.231739332843488e-05
Epoch: 7 cost time: 0.7815344333648682
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3944931 Best vali loss: 0.3717517
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7673587799072266
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3970946 Best vali loss: 0.3717517

best validation loss 0.3717517336717055

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0082598314051, 'e_layers': 2, 'learning_rate': 0.0001301574132, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0001252035916300472
Validation loss decreased (inf --> 0.3879).  Saving model state dict ...
Epoch: 1 cost time: 0.9226884841918945
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3879154 Best vali loss: 0.3879154
Updating learning rate to 0.00011109630134770973
Validation loss decreased (0.3879 --> 0.3714).  Saving model state dict ...
Epoch: 2 cost time: 0.46839165687561035
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3714044 Best vali loss: 0.3714044
Updating learning rate to 8.998324941556862e-05
Validation loss decreased (0.3714 --> 0.3667).  Saving model state dict ...
Epoch: 3 cost time: 0.480316162109375
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3666806 Best vali loss: 0.3666806
Updating learning rate to 6.50787066e-05
Validation loss decreased (0.3667 --> 0.3647).  Saving model state dict ...
Epoch: 4 cost time: 0.5190677642822266
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3647446 Best vali loss: 0.3647446
Updating learning rate to 4.017416378443138e-05
Validation loss decreased (0.3647 --> 0.3638).  Saving model state dict ...
Epoch: 5 cost time: 0.6188280582427979
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3638193 Best vali loss: 0.3638193
Updating learning rate to 1.906111185229028e-05
Validation loss decreased (0.3638 --> 0.3636).  Saving model state dict ...
Epoch: 6 cost time: 0.6201090812683105
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3635561 Best vali loss: 0.3635561
Updating learning rate to 4.953821569952809e-06
Epoch: 7 cost time: 0.613518238067627
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3635561 Best vali loss: 0.3635561
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6134896278381348
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3636249 Best vali loss: 0.3635561

best validation loss 0.36355605587978024

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0038481438487, 'e_layers': 2, 'learning_rate': 0.0029619392807, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1732466
	speed: 0.0144s/iter; left time: 57.9088s
	iters: 200, epoch: 1 | loss: 0.3227676
	speed: 0.0084s/iter; left time: 32.7465s
	iters: 300, epoch: 1 | loss: 0.7569426
	speed: 0.0084s/iter; left time: 32.0669s
	iters: 400, epoch: 1 | loss: 1.2117578
	speed: 0.0083s/iter; left time: 30.9790s
	iters: 500, epoch: 1 | loss: 0.9634073
	speed: 0.0074s/iter; left time: 26.8633s
Updating learning rate to 0.0029619392807
Validation loss decreased (inf --> 0.4204).  Saving model state dict ...
Epoch: 1 cost time: 4.542618751525879
Epoch: 1, Steps: 514 | Train Loss: 0.8856244 Vali Loss: 0.4203736 Best vali loss: 0.4203736
	iters: 100, epoch: 2 | loss: 1.5630335
	speed: 0.0223s/iter; left time: 77.9285s
	iters: 200, epoch: 2 | loss: 0.7034190
	speed: 0.0108s/iter; left time: 36.7376s
	iters: 300, epoch: 2 | loss: 0.6917291
	speed: 0.0105s/iter; left time: 34.6052s
	iters: 400, epoch: 2 | loss: 0.7069679
	speed: 0.0109s/iter; left time: 34.8402s
	iters: 500, epoch: 2 | loss: 0.7580099
	speed: 0.0116s/iter; left time: 35.7983s
Updating learning rate to 0.00148096964035
Validation loss decreased (0.4204 --> 0.4001).  Saving model state dict ...
Epoch: 2 cost time: 5.670330286026001
Epoch: 2, Steps: 514 | Train Loss: 0.8846319 Vali Loss: 0.4001472 Best vali loss: 0.4001472
	iters: 100, epoch: 3 | loss: 0.5986490
	speed: 0.0270s/iter; left time: 80.7196s
	iters: 200, epoch: 3 | loss: 0.6294782
	speed: 0.0103s/iter; left time: 29.6338s
	iters: 300, epoch: 3 | loss: 0.5853285
	speed: 0.0107s/iter; left time: 29.8269s
	iters: 400, epoch: 3 | loss: 0.6118347
	speed: 0.0111s/iter; left time: 29.7266s
	iters: 500, epoch: 3 | loss: 1.3757124
	speed: 0.0074s/iter; left time: 19.1596s
Updating learning rate to 0.000740484820175
Epoch: 3 cost time: 5.19209623336792
Epoch: 3, Steps: 514 | Train Loss: 0.7602005 Vali Loss: 0.4024873 Best vali loss: 0.4001472
	iters: 100, epoch: 4 | loss: 0.5208489
	speed: 0.0335s/iter; left time: 82.9002s
	iters: 200, epoch: 4 | loss: 0.6685496
	speed: 0.0113s/iter; left time: 26.7736s
	iters: 300, epoch: 4 | loss: 0.5923311
	speed: 0.0099s/iter; left time: 22.4745s
	iters: 400, epoch: 4 | loss: 0.4545411
	speed: 0.0109s/iter; left time: 23.6461s
	iters: 500, epoch: 4 | loss: 0.3803549
	speed: 0.0107s/iter; left time: 22.1483s
Updating learning rate to 0.0003702424100875
Epoch: 4 cost time: 5.565000057220459
Epoch: 4, Steps: 514 | Train Loss: 0.5233251 Vali Loss: 0.4048580 Best vali loss: 0.4001472
	iters: 100, epoch: 5 | loss: 0.7306288
	speed: 0.0270s/iter; left time: 52.8403s
	iters: 200, epoch: 5 | loss: 0.7595898
	speed: 0.0106s/iter; left time: 19.6099s
	iters: 300, epoch: 5 | loss: 0.2974030
	speed: 0.0104s/iter; left time: 18.2115s
	iters: 400, epoch: 5 | loss: 0.6695256
	speed: 0.0095s/iter; left time: 15.7803s
	iters: 500, epoch: 5 | loss: 0.6209368
	speed: 0.0075s/iter; left time: 11.7548s
Updating learning rate to 0.00018512120504375
Epoch: 5 cost time: 4.993834733963013
Epoch: 5, Steps: 514 | Train Loss: 0.6156168 Vali Loss: 0.4046643 Best vali loss: 0.4001472
	iters: 100, epoch: 6 | loss: 0.7765810
	speed: 0.0176s/iter; left time: 25.3930s
	iters: 200, epoch: 6 | loss: 0.4899851
	speed: 0.0082s/iter; left time: 11.0248s
	iters: 300, epoch: 6 | loss: 0.3621261
	speed: 0.0080s/iter; left time: 9.9784s
	iters: 400, epoch: 6 | loss: 0.7917293
	speed: 0.0079s/iter; left time: 9.0785s
	iters: 500, epoch: 6 | loss: 0.6875566
	speed: 0.0078s/iter; left time: 8.1689s
Updating learning rate to 9.2560602521875e-05
Epoch: 6 cost time: 4.25292706489563
Epoch: 6, Steps: 514 | Train Loss: 0.6215956 Vali Loss: 0.4045554 Best vali loss: 0.4001472
	iters: 100, epoch: 7 | loss: 0.5250940
	speed: 0.0169s/iter; left time: 15.6559s
	iters: 200, epoch: 7 | loss: 0.2822848
	speed: 0.0080s/iter; left time: 6.6299s
	iters: 300, epoch: 7 | loss: 0.7475855
	speed: 0.0080s/iter; left time: 5.8108s
	iters: 400, epoch: 7 | loss: 0.5840122
	speed: 0.0080s/iter; left time: 5.0485s
	iters: 500, epoch: 7 | loss: 0.5650509
	speed: 0.0078s/iter; left time: 4.1352s
Updating learning rate to 4.62803012609375e-05
Epoch: 7 cost time: 4.104709625244141
Epoch: 7, Steps: 514 | Train Loss: 0.5408055 Vali Loss: 0.4041552 Best vali loss: 0.4001472
	iters: 100, epoch: 8 | loss: 0.5824995
	speed: 0.0191s/iter; left time: 7.9113s
	iters: 200, epoch: 8 | loss: 0.5554352
	speed: 0.0079s/iter; left time: 2.4739s
	iters: 300, epoch: 8 | loss: 0.8267517
	speed: 0.0080s/iter; left time: 1.7100s
	iters: 400, epoch: 8 | loss: 1.3071131
	speed: 0.0078s/iter; left time: 0.9024s
	iters: 500, epoch: 8 | loss: 0.6815575
	speed: 0.0079s/iter; left time: 0.1190s
Updating learning rate to 2.314015063046875e-05
Epoch: 8 cost time: 4.120427846908569
Epoch: 8, Steps: 514 | Train Loss: 0.7906714 Vali Loss: 0.4040995 Best vali loss: 0.4001472

best validation loss 0.4001471529892245

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7148471
	speed: 0.0148s/iter; left time: 28.9569s
	iters: 200, epoch: 1 | loss: 0.7124249
	speed: 0.0083s/iter; left time: 15.4549s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 2.498260736465454
Epoch: 1, Steps: 257 | Train Loss: 0.7136360 Vali Loss: 0.3734035 Best vali loss: 0.3734035
	iters: 100, epoch: 2 | loss: 0.5078289
	speed: 0.0226s/iter; left time: 38.5033s
	iters: 200, epoch: 2 | loss: 0.3638742
	speed: 0.0083s/iter; left time: 13.2159s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.3734 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 2.6811983585357666
Epoch: 2, Steps: 257 | Train Loss: 0.4358515 Vali Loss: 0.3635688 Best vali loss: 0.3635688
	iters: 100, epoch: 3 | loss: 0.5455037
	speed: 0.0176s/iter; left time: 25.4502s
	iters: 200, epoch: 3 | loss: 0.6350930
	speed: 0.0065s/iter; left time: 8.7792s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 1.8887238502502441
Epoch: 3, Steps: 257 | Train Loss: 0.5902984 Vali Loss: 0.3655377 Best vali loss: 0.3635688

best validation loss 0.3635688483715057

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.003384061485, 'e_layers': 3, 'learning_rate': 9.19244501e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7128842
	speed: 0.0172s/iter; left time: 16.0049s
Updating learning rate to 8.842578404237255e-05
Validation loss decreased (inf --> 0.4281).  Saving model state dict ...
Epoch: 1 cost time: 1.6395788192749023
Epoch: 1, Steps: 129 | Train Loss: 0.7128842 Vali Loss: 0.4281171 Best vali loss: 0.4281171
	iters: 100, epoch: 2 | loss: 0.9303722
	speed: 0.0143s/iter; left time: 11.4909s
Updating learning rate to 7.846242606127721e-05
Validation loss decreased (0.4281 --> 0.4100).  Saving model state dict ...
Epoch: 2 cost time: 1.153860092163086
Epoch: 2, Steps: 129 | Train Loss: 0.9303722 Vali Loss: 0.4100094 Best vali loss: 0.4100094
	iters: 100, epoch: 3 | loss: 0.7415957
	speed: 0.0158s/iter; left time: 10.6341s
Updating learning rate to 6.355120709127072e-05
Validation loss decreased (0.4100 --> 0.3986).  Saving model state dict ...
Epoch: 3 cost time: 1.1763925552368164
Epoch: 3, Steps: 129 | Train Loss: 0.7415957 Vali Loss: 0.3986205 Best vali loss: 0.3986205

best validation loss 0.3986204999486215

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010602146623, 'e_layers': 1, 'learning_rate': 0.000796404306, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5398040
	speed: 0.0137s/iter; left time: 26.7298s
	iters: 200, epoch: 1 | loss: 1.0392188
	speed: 0.0089s/iter; left time: 16.6095s
Updating learning rate to 0.0007660929719586279
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 2.547717809677124
Epoch: 1, Steps: 257 | Train Loss: 0.7895114 Vali Loss: 0.3673880 Best vali loss: 0.3673880
	iters: 100, epoch: 2 | loss: 0.7293118
	speed: 0.0352s/iter; left time: 59.8434s
	iters: 200, epoch: 2 | loss: 1.0925629
	speed: 0.0129s/iter; left time: 20.6131s
Updating learning rate to 0.0006797735956693831
Validation loss decreased (0.3674 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 3.3757455348968506
Epoch: 2, Steps: 257 | Train Loss: 0.9109373 Vali Loss: 0.3650100 Best vali loss: 0.3650100
	iters: 100, epoch: 3 | loss: 0.5146260
	speed: 0.0329s/iter; left time: 47.5082s
	iters: 200, epoch: 3 | loss: 0.6682271
	speed: 0.0136s/iter; left time: 18.2070s
Updating learning rate to 0.0005505875196852087
Epoch: 3 cost time: 3.597050189971924
Epoch: 3, Steps: 257 | Train Loss: 0.5914265 Vali Loss: 0.3769690 Best vali loss: 0.3650100

best validation loss 0.36501000497804875

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6187267
	speed: 0.0234s/iter; left time: 27.7538s
	iters: 200, epoch: 4 | loss: 0.6448041
	speed: 0.0143s/iter; left time: 15.5344s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 4.302562952041626
Epoch: 4, Steps: 257 | Train Loss: 0.6317654 Vali Loss: 0.3641419 Best vali loss: 0.3635688
	iters: 100, epoch: 5 | loss: 0.5009366
	speed: 0.0412s/iter; left time: 38.2296s
	iters: 200, epoch: 5 | loss: 0.3617215
	speed: 0.0159s/iter; left time: 13.1943s
Updating learning rate to 3.3224917040731837e-05
Validation loss decreased (0.3636 --> 0.3595).  Saving model state dict ...
Epoch: 5 cost time: 3.9383931159973145
Epoch: 5, Steps: 257 | Train Loss: 0.4313290 Vali Loss: 0.3595196 Best vali loss: 0.3595196
	iters: 100, epoch: 6 | loss: 0.5316986
	speed: 0.0205s/iter; left time: 13.7922s
	iters: 200, epoch: 6 | loss: 0.6110383
	speed: 0.0140s/iter; left time: 7.9855s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 3.4142887592315674
Epoch: 6, Steps: 257 | Train Loss: 0.5713685 Vali Loss: 0.3613649 Best vali loss: 0.3595196
	iters: 100, epoch: 7 | loss: 0.7603070
	speed: 0.0297s/iter; left time: 12.3150s
	iters: 200, epoch: 7 | loss: 0.5802144
	speed: 0.0094s/iter; left time: 2.9491s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 2.5934712886810303
Epoch: 7, Steps: 257 | Train Loss: 0.6702607 Vali Loss: 0.3602670 Best vali loss: 0.3595196
	iters: 100, epoch: 8 | loss: 0.4012331
	speed: 0.0218s/iter; left time: 3.4379s
	iters: 200, epoch: 8 | loss: 0.6620668
	speed: 0.0098s/iter; left time: 0.5700s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.624412775039673
Epoch: 8, Steps: 257 | Train Loss: 0.5316500 Vali Loss: 0.3609883 Best vali loss: 0.3595196

best validation loss 0.35951955162705984

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0026888458224, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2880802
	speed: 0.0188s/iter; left time: 152.9595s
	iters: 200, epoch: 1 | loss: 1.0722648
	speed: 0.0102s/iter; left time: 81.9119s
	iters: 300, epoch: 1 | loss: 0.8796365
	speed: 0.0058s/iter; left time: 45.8670s
	iters: 400, epoch: 1 | loss: 0.8955539
	speed: 0.0078s/iter; left time: 61.3209s
	iters: 500, epoch: 1 | loss: 1.0350972
	speed: 0.0092s/iter; left time: 71.0060s
	iters: 600, epoch: 1 | loss: 0.5891145
	speed: 0.0088s/iter; left time: 67.1261s
	iters: 700, epoch: 1 | loss: 1.0216949
	speed: 0.0088s/iter; left time: 66.1066s
	iters: 800, epoch: 1 | loss: 1.4027044
	speed: 0.0088s/iter; left time: 65.6171s
	iters: 900, epoch: 1 | loss: 1.0992594
	speed: 0.0090s/iter; left time: 65.9686s
	iters: 1000, epoch: 1 | loss: 1.7959270
	speed: 0.0091s/iter; left time: 65.5192s
Updating learning rate to 0.0002954316154
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 9.61052131652832
Epoch: 1, Steps: 1027 | Train Loss: 1.0079333 Vali Loss: 0.3674974 Best vali loss: 0.3674974
	iters: 100, epoch: 2 | loss: 0.5526773
	speed: 0.0288s/iter; left time: 204.3177s
	iters: 200, epoch: 2 | loss: 0.3303777
	speed: 0.0085s/iter; left time: 59.2501s
	iters: 300, epoch: 2 | loss: 1.0700983
	speed: 0.0077s/iter; left time: 53.3392s
	iters: 400, epoch: 2 | loss: 0.4049129
	speed: 0.0086s/iter; left time: 58.7058s
	iters: 500, epoch: 2 | loss: 0.3172197
	speed: 0.0091s/iter; left time: 60.6031s
	iters: 600, epoch: 2 | loss: 0.4923825
	speed: 0.0090s/iter; left time: 59.3255s
	iters: 700, epoch: 2 | loss: 0.8777075
	speed: 0.0092s/iter; left time: 59.4748s
	iters: 800, epoch: 2 | loss: 0.8461074
	speed: 0.0091s/iter; left time: 58.0131s
	iters: 900, epoch: 2 | loss: 0.8673409
	speed: 0.0092s/iter; left time: 58.0140s
	iters: 1000, epoch: 2 | loss: 1.0585611
	speed: 0.0088s/iter; left time: 54.7082s
Updating learning rate to 0.0001477158077
Validation loss decreased (0.3675 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 9.121049642562866
Epoch: 2, Steps: 1027 | Train Loss: 0.6817385 Vali Loss: 0.3629733 Best vali loss: 0.3629733
	iters: 100, epoch: 3 | loss: 0.5622296
	speed: 0.0282s/iter; left time: 171.0945s
	iters: 200, epoch: 3 | loss: 0.4228206
	speed: 0.0084s/iter; left time: 50.0162s
	iters: 300, epoch: 3 | loss: 1.1536319
	speed: 0.0076s/iter; left time: 44.6081s
	iters: 400, epoch: 3 | loss: 0.3610360
	speed: 0.0079s/iter; left time: 45.7403s
	iters: 500, epoch: 3 | loss: 1.6594973
	speed: 0.0068s/iter; left time: 38.5852s
	iters: 600, epoch: 3 | loss: 0.2668497
	speed: 0.0086s/iter; left time: 47.9125s
	iters: 700, epoch: 3 | loss: 0.4248322
	speed: 0.0090s/iter; left time: 49.2310s
	iters: 800, epoch: 3 | loss: 0.6710022
	speed: 0.0091s/iter; left time: 48.5491s
	iters: 900, epoch: 3 | loss: 0.6151366
	speed: 0.0085s/iter; left time: 44.8768s
	iters: 1000, epoch: 3 | loss: 0.9639511
	speed: 0.0089s/iter; left time: 45.8024s
Updating learning rate to 7.385790385e-05
Epoch: 3 cost time: 8.66898512840271
Epoch: 3, Steps: 1027 | Train Loss: 0.7100987 Vali Loss: 0.3713159 Best vali loss: 0.3629733
	iters: 100, epoch: 4 | loss: 0.5465879
	speed: 0.0220s/iter; left time: 110.6047s
	iters: 200, epoch: 4 | loss: 0.2739928
	speed: 0.0075s/iter; left time: 36.9543s
	iters: 300, epoch: 4 | loss: 0.5055673
	speed: 0.0070s/iter; left time: 33.6591s
	iters: 400, epoch: 4 | loss: 0.4109426
	speed: 0.0055s/iter; left time: 26.1316s
	iters: 500, epoch: 4 | loss: 0.3358493
	speed: 0.0079s/iter; left time: 36.4723s
	iters: 600, epoch: 4 | loss: 0.4031533
	speed: 0.0081s/iter; left time: 36.7257s
	iters: 700, epoch: 4 | loss: 0.7216007
	speed: 0.0073s/iter; left time: 32.4472s
	iters: 800, epoch: 4 | loss: 0.6689513
	speed: 0.0071s/iter; left time: 30.9027s
	iters: 900, epoch: 4 | loss: 1.5905701
	speed: 0.0082s/iter; left time: 34.7876s
	iters: 1000, epoch: 4 | loss: 0.3458639
	speed: 0.0078s/iter; left time: 32.3488s
Updating learning rate to 3.6928951925e-05
Epoch: 4 cost time: 7.687506437301636
Epoch: 4, Steps: 1027 | Train Loss: 0.5803079 Vali Loss: 0.3727864 Best vali loss: 0.3629733
	iters: 100, epoch: 5 | loss: 0.9132578
	speed: 0.0229s/iter; left time: 91.9489s
	iters: 200, epoch: 5 | loss: 0.9178452
	speed: 0.0070s/iter; left time: 27.2411s
	iters: 300, epoch: 5 | loss: 0.3114177
	speed: 0.0083s/iter; left time: 31.5496s
	iters: 400, epoch: 5 | loss: 0.9307008
	speed: 0.0068s/iter; left time: 25.3561s
	iters: 500, epoch: 5 | loss: 0.1708948
	speed: 0.0069s/iter; left time: 24.9453s
	iters: 600, epoch: 5 | loss: 0.3223006
	speed: 0.0080s/iter; left time: 27.9650s
	iters: 700, epoch: 5 | loss: 0.2925197
	speed: 0.0081s/iter; left time: 27.5117s
	iters: 800, epoch: 5 | loss: 0.3598738
	speed: 0.0080s/iter; left time: 26.6323s
	iters: 900, epoch: 5 | loss: 1.5678527
	speed: 0.0084s/iter; left time: 27.0741s
	iters: 1000, epoch: 5 | loss: 0.4566124
	speed: 0.0080s/iter; left time: 24.9959s
Updating learning rate to 1.84644759625e-05
Epoch: 5 cost time: 7.936750173568726
Epoch: 5, Steps: 1027 | Train Loss: 0.6243276 Vali Loss: 0.3727136 Best vali loss: 0.3629733
	iters: 100, epoch: 6 | loss: 0.3119662
	speed: 0.0222s/iter; left time: 66.0759s
	iters: 200, epoch: 6 | loss: 0.3268187
	speed: 0.0064s/iter; left time: 18.5667s
	iters: 300, epoch: 6 | loss: 0.3029779
	speed: 0.0069s/iter; left time: 19.0617s
	iters: 400, epoch: 6 | loss: 1.5057091
	speed: 0.0077s/iter; left time: 20.5739s
	iters: 500, epoch: 6 | loss: 0.6221147
	speed: 0.0067s/iter; left time: 17.2568s
	iters: 600, epoch: 6 | loss: 0.5395226
	speed: 0.0064s/iter; left time: 15.9764s
	iters: 700, epoch: 6 | loss: 0.2953814
	speed: 0.0078s/iter; left time: 18.5606s
	iters: 800, epoch: 6 | loss: 0.3849827
	speed: 0.0078s/iter; left time: 17.7644s
	iters: 900, epoch: 6 | loss: 0.5289070
	speed: 0.0077s/iter; left time: 16.6956s
	iters: 1000, epoch: 6 | loss: 0.1926481
	speed: 0.0076s/iter; left time: 15.8278s
Updating learning rate to 9.23223798125e-06
Epoch: 6 cost time: 7.460376262664795
Epoch: 6, Steps: 1027 | Train Loss: 0.5011029 Vali Loss: 0.3713966 Best vali loss: 0.3629733
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069459756953, 'e_layers': 2, 'learning_rate': 0.0031567606928, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8076880
	speed: 0.0138s/iter; left time: 27.0389s
	iters: 200, epoch: 1 | loss: 0.6551394
	speed: 0.0092s/iter; left time: 17.0034s
Updating learning rate to 0.003036613642957035
Validation loss decreased (inf --> 0.3726).  Saving model state dict ...
Epoch: 1 cost time: 2.783658504486084
Epoch: 1, Steps: 257 | Train Loss: 0.7314137 Vali Loss: 0.3725938 Best vali loss: 0.3725938
	iters: 100, epoch: 2 | loss: 0.8831102
	speed: 0.0201s/iter; left time: 34.1923s
	iters: 200, epoch: 2 | loss: 0.7962460
	speed: 0.0081s/iter; left time: 12.9737s
Updating learning rate to 0.002694463792631012
Epoch: 2 cost time: 2.110344648361206
Epoch: 2, Steps: 257 | Train Loss: 0.8396781 Vali Loss: 0.3793016 Best vali loss: 0.3725938
	iters: 100, epoch: 3 | loss: 0.8045042
	speed: 0.0170s/iter; left time: 24.5680s
	iters: 200, epoch: 3 | loss: 0.7287357
	speed: 0.0080s/iter; left time: 10.7186s
Updating learning rate to 0.0021824003549379516
Epoch: 3 cost time: 2.1210885047912598
Epoch: 3, Steps: 257 | Train Loss: 0.7666200 Vali Loss: 0.3758010 Best vali loss: 0.3725938
	iters: 100, epoch: 4 | loss: 0.3907295
	speed: 0.0169s/iter; left time: 20.0566s
	iters: 200, epoch: 4 | loss: 0.8506889
	speed: 0.0078s/iter; left time: 8.4849s
Updating learning rate to 0.0015783803464
Epoch: 4 cost time: 2.108017683029175
Epoch: 4, Steps: 257 | Train Loss: 0.6207092 Vali Loss: 0.3759000 Best vali loss: 0.3725938
	iters: 100, epoch: 5 | loss: 0.4150643
	speed: 0.0169s/iter; left time: 15.6905s
	iters: 200, epoch: 5 | loss: 0.2867480
	speed: 0.0107s/iter; left time: 8.9051s
Updating learning rate to 0.0009743603378620486
Epoch: 5 cost time: 2.4932193756103516
Epoch: 5, Steps: 257 | Train Loss: 0.3509062 Vali Loss: 0.3784608 Best vali loss: 0.3725938
	iters: 100, epoch: 6 | loss: 0.7508288
	speed: 0.0182s/iter; left time: 12.2040s
	iters: 200, epoch: 6 | loss: 0.4636042
	speed: 0.0077s/iter; left time: 4.4218s
Updating learning rate to 0.0004622969001689882
Validation loss decreased (0.3726 --> 0.3694).  Saving model state dict ...
Epoch: 6 cost time: 2.0927200317382812
Epoch: 6, Steps: 257 | Train Loss: 0.6072165 Vali Loss: 0.3694411 Best vali loss: 0.3694411
	iters: 100, epoch: 7 | loss: 0.4097099
	speed: 0.0160s/iter; left time: 6.6598s
	iters: 200, epoch: 7 | loss: 0.2912842
	speed: 0.0078s/iter; left time: 2.4481s
Updating learning rate to 0.00012014704984296518
Validation loss decreased (0.3694 --> 0.3661).  Saving model state dict ...
Epoch: 7 cost time: 2.0478460788726807
Epoch: 7, Steps: 257 | Train Loss: 0.3504971 Vali Loss: 0.3661185 Best vali loss: 0.3661185
	iters: 100, epoch: 8 | loss: 0.4988568
	speed: 0.0164s/iter; left time: 2.5919s
	iters: 200, epoch: 8 | loss: 0.3303356
	speed: 0.0079s/iter; left time: 0.4595s
Updating learning rate to 0.0
Validation loss decreased (0.3661 --> 0.3631).  Saving model state dict ...
Epoch: 8 cost time: 2.0955348014831543
Epoch: 8, Steps: 257 | Train Loss: 0.4145962 Vali Loss: 0.3631066 Best vali loss: 0.3631066

best validation loss 0.363106576609471

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 3, 'learning_rate': 0.0013544172464, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7104939
	speed: 0.0196s/iter; left time: 38.3356s
	iters: 200, epoch: 1 | loss: 0.7004207
	speed: 0.0059s/iter; left time: 10.9318s
Updating learning rate to 0.0013544172464
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 2.6128551959991455
Epoch: 1, Steps: 257 | Train Loss: 0.7054573 Vali Loss: 0.3672363 Best vali loss: 0.3672363
	iters: 100, epoch: 2 | loss: 0.4439691
	speed: 0.0180s/iter; left time: 30.5767s
	iters: 200, epoch: 2 | loss: 0.9914150
	speed: 0.0098s/iter; left time: 15.6018s
Updating learning rate to 0.0006772086232
Epoch: 2 cost time: 2.5343384742736816
Epoch: 2, Steps: 257 | Train Loss: 0.7176920 Vali Loss: 0.3716994 Best vali loss: 0.3672363
	iters: 100, epoch: 3 | loss: 0.5952530
	speed: 0.0193s/iter; left time: 27.7805s
	iters: 200, epoch: 3 | loss: 0.6194918
	speed: 0.0094s/iter; left time: 12.6892s
Updating learning rate to 0.0003386043116
Epoch: 3 cost time: 2.4738409519195557
Epoch: 3, Steps: 257 | Train Loss: 0.6073724 Vali Loss: 0.3764336 Best vali loss: 0.3672363

best validation loss 0.3672362988262139

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 1.367971658706665
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669169 Best vali loss: 0.3669169
Updating learning rate to 0.0005975820137081337
Validation loss decreased (0.3669 --> 0.3614).  Saving model state dict ...
Epoch: 2 cost time: 0.9982094764709473
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3614463 Best vali loss: 0.3614463
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 1.071122169494629
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3665489 Best vali loss: 0.3614463

best validation loss 0.36144633048409797

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4483611
	speed: 0.0182s/iter; left time: 147.7917s
	iters: 200, epoch: 1 | loss: 0.3075066
	speed: 0.0121s/iter; left time: 97.0590s
	iters: 300, epoch: 1 | loss: 0.2333665
	speed: 0.0129s/iter; left time: 102.4770s
	iters: 400, epoch: 1 | loss: 1.1574903
	speed: 0.0120s/iter; left time: 93.7322s
	iters: 500, epoch: 1 | loss: 0.2455897
	speed: 0.0119s/iter; left time: 92.2121s
	iters: 600, epoch: 1 | loss: 0.6157740
	speed: 0.0125s/iter; left time: 94.9120s
	iters: 700, epoch: 1 | loss: 1.1975372
	speed: 0.0122s/iter; left time: 91.6637s
	iters: 800, epoch: 1 | loss: 0.5250953
	speed: 0.0106s/iter; left time: 78.6397s
	iters: 900, epoch: 1 | loss: 0.8515900
	speed: 0.0099s/iter; left time: 72.5893s
	iters: 1000, epoch: 1 | loss: 0.9864082
	speed: 0.0145s/iter; left time: 104.6927s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 12.91474437713623
Epoch: 1, Steps: 1027 | Train Loss: 0.6568719 Vali Loss: 0.3708296 Best vali loss: 0.3708296
	iters: 100, epoch: 2 | loss: 0.7100091
	speed: 0.0471s/iter; left time: 333.8276s
	iters: 200, epoch: 2 | loss: 0.4996687
	speed: 0.0189s/iter; left time: 132.1197s
	iters: 300, epoch: 2 | loss: 0.9346297
	speed: 0.0144s/iter; left time: 99.1858s
	iters: 400, epoch: 2 | loss: 1.0053335
	speed: 0.0169s/iter; left time: 114.7526s
	iters: 500, epoch: 2 | loss: 0.4633304
	speed: 0.0174s/iter; left time: 116.6365s
	iters: 600, epoch: 2 | loss: 0.3447898
	speed: 0.0146s/iter; left time: 96.3580s
	iters: 700, epoch: 2 | loss: 0.2551934
	speed: 0.0161s/iter; left time: 104.3037s
	iters: 800, epoch: 2 | loss: 0.3418238
	speed: 0.0159s/iter; left time: 101.5517s
	iters: 900, epoch: 2 | loss: 0.2879581
	speed: 0.0164s/iter; left time: 103.3313s
	iters: 1000, epoch: 2 | loss: 1.2794007
	speed: 0.0168s/iter; left time: 103.8681s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.3708 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 16.863903284072876
Epoch: 2, Steps: 1027 | Train Loss: 0.6122137 Vali Loss: 0.3691413 Best vali loss: 0.3691413
	iters: 100, epoch: 3 | loss: 0.7053914
	speed: 0.0295s/iter; left time: 178.8425s
	iters: 200, epoch: 3 | loss: 0.6453400
	speed: 0.0130s/iter; left time: 77.5489s
	iters: 300, epoch: 3 | loss: 0.2569985
	speed: 0.0157s/iter; left time: 92.1498s
	iters: 400, epoch: 3 | loss: 0.1963135
	speed: 0.0107s/iter; left time: 61.4074s
	iters: 500, epoch: 3 | loss: 1.1672274
	speed: 0.0182s/iter; left time: 102.8697s
	iters: 600, epoch: 3 | loss: 0.3859089
	speed: 0.0130s/iter; left time: 72.5252s
	iters: 700, epoch: 3 | loss: 0.1898936
	speed: 0.0188s/iter; left time: 102.9592s
	iters: 800, epoch: 3 | loss: 0.2490687
	speed: 0.0181s/iter; left time: 97.3005s
	iters: 900, epoch: 3 | loss: 0.2782202
	speed: 0.0117s/iter; left time: 61.5704s
	iters: 1000, epoch: 3 | loss: 1.8799696
	speed: 0.0097s/iter; left time: 50.0774s
Updating learning rate to 0.0004164486617318853
Epoch: 3 cost time: 14.138219594955444
Epoch: 3, Steps: 1027 | Train Loss: 0.5954332 Vali Loss: 0.3709889 Best vali loss: 0.3691413

best validation loss 0.3691413199386334

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.000350055439
Validation loss decreased (0.3614 --> 0.3584).  Saving model state dict ...
Epoch: 4 cost time: 1.2797787189483643
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3583991 Best vali loss: 0.3583991
Updating learning rate to 0.0002160950220854117
Epoch: 5 cost time: 0.9493367671966553
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3599755 Best vali loss: 0.3583991
Updating learning rate to 0.00010252886429186618
Validation loss decreased (0.3584 --> 0.3520).  Saving model state dict ...
Epoch: 6 cost time: 0.9106142520904541
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3520116 Best vali loss: 0.3520116
Updating learning rate to 2.6646383663646746e-05
Epoch: 7 cost time: 1.0592634677886963
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3528957 Best vali loss: 0.3520116
Updating learning rate to 0.0
Validation loss decreased (0.3520 --> 0.3518).  Saving model state dict ...
Epoch: 8 cost time: 0.9565343856811523
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3517713 Best vali loss: 0.3517713

best validation loss 0.3517712671770797

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0008068994639, 'e_layers': 4, 'learning_rate': 0.001591082265, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5114385
	speed: 0.0178s/iter; left time: 144.1396s
	iters: 200, epoch: 1 | loss: 0.6723447
	speed: 0.0112s/iter; left time: 89.4024s
	iters: 300, epoch: 1 | loss: 1.8774613
	speed: 0.0105s/iter; left time: 82.8351s
	iters: 400, epoch: 1 | loss: 0.4371727
	speed: 0.0120s/iter; left time: 94.0911s
	iters: 500, epoch: 1 | loss: 0.2588385
	speed: 0.0121s/iter; left time: 93.4306s
	iters: 600, epoch: 1 | loss: 0.3123489
	speed: 0.0116s/iter; left time: 88.1676s
	iters: 700, epoch: 1 | loss: 0.4460657
	speed: 0.0120s/iter; left time: 90.1696s
	iters: 800, epoch: 1 | loss: 0.8782415
	speed: 0.0115s/iter; left time: 85.4457s
	iters: 900, epoch: 1 | loss: 0.2984265
	speed: 0.0108s/iter; left time: 78.8052s
	iters: 1000, epoch: 1 | loss: 0.5471947
	speed: 0.0105s/iter; left time: 75.8107s
Updating learning rate to 0.0015305253020875995
Validation loss decreased (inf --> 0.4052).  Saving model state dict ...
Epoch: 1 cost time: 11.967489242553711
Epoch: 1, Steps: 1027 | Train Loss: 0.6239533 Vali Loss: 0.4051607 Best vali loss: 0.4051607
	iters: 100, epoch: 2 | loss: 1.2565181
	speed: 0.0336s/iter; left time: 237.8721s
	iters: 200, epoch: 2 | loss: 0.3725032
	speed: 0.0129s/iter; left time: 90.1973s
	iters: 300, epoch: 2 | loss: 0.2641456
	speed: 0.0114s/iter; left time: 78.3358s
	iters: 400, epoch: 2 | loss: 1.6525526
	speed: 0.0077s/iter; left time: 52.4945s
	iters: 500, epoch: 2 | loss: 0.3736772
	speed: 0.0088s/iter; left time: 59.0242s
	iters: 600, epoch: 2 | loss: 0.2805740
	speed: 0.0100s/iter; left time: 65.6899s
	iters: 700, epoch: 2 | loss: 1.3372315
	speed: 0.0107s/iter; left time: 69.6479s
	iters: 800, epoch: 2 | loss: 0.4821182
	speed: 0.0101s/iter; left time: 64.3536s
	iters: 900, epoch: 2 | loss: 1.3199295
	speed: 0.0103s/iter; left time: 64.5723s
	iters: 1000, epoch: 2 | loss: 0.3446963
	speed: 0.0092s/iter; left time: 56.8755s
Updating learning rate to 0.0013580736620035757
Epoch: 2 cost time: 10.988929271697998
Epoch: 2, Steps: 1027 | Train Loss: 0.7683946 Vali Loss: 0.4122051 Best vali loss: 0.4051607
	iters: 100, epoch: 3 | loss: 1.4507976
	speed: 0.0326s/iter; left time: 197.5621s
	iters: 200, epoch: 3 | loss: 0.4100672
	speed: 0.0117s/iter; left time: 69.8960s
	iters: 300, epoch: 3 | loss: 0.2870447
	speed: 0.0097s/iter; left time: 56.7292s
	iters: 400, epoch: 3 | loss: 0.5311179
	speed: 0.0130s/iter; left time: 74.8677s
	iters: 500, epoch: 3 | loss: 0.5939767
	speed: 0.0171s/iter; left time: 96.8180s
	iters: 600, epoch: 3 | loss: 0.5467692
	speed: 0.0167s/iter; left time: 92.6604s
	iters: 700, epoch: 3 | loss: 1.4294451
	speed: 0.0155s/iter; left time: 84.8199s
	iters: 800, epoch: 3 | loss: 0.3252304
	speed: 0.0172s/iter; left time: 92.4097s
	iters: 900, epoch: 3 | loss: 0.8781139
	speed: 0.0153s/iter; left time: 80.7496s
	iters: 1000, epoch: 3 | loss: 0.4193943
	speed: 0.0159s/iter; left time: 82.1246s
Updating learning rate to 0.0010999815436727107
Epoch: 3 cost time: 14.964767932891846
Epoch: 3, Steps: 1027 | Train Loss: 0.6871957 Vali Loss: 0.4066717 Best vali loss: 0.4051607
	iters: 100, epoch: 4 | loss: 0.4851004
	speed: 0.0401s/iter; left time: 202.1314s
	iters: 200, epoch: 4 | loss: 0.3986539
	speed: 0.0111s/iter; left time: 55.0113s
	iters: 300, epoch: 4 | loss: 0.5823159
	speed: 0.0096s/iter; left time: 46.2986s
	iters: 400, epoch: 4 | loss: 0.5617365
	speed: 0.0094s/iter; left time: 44.5921s
	iters: 500, epoch: 4 | loss: 0.2063245
	speed: 0.0107s/iter; left time: 49.5543s
	iters: 600, epoch: 4 | loss: 0.4482282
	speed: 0.0111s/iter; left time: 50.1374s
	iters: 700, epoch: 4 | loss: 0.4211198
	speed: 0.0092s/iter; left time: 40.6634s
	iters: 800, epoch: 4 | loss: 0.2161767
	speed: 0.0110s/iter; left time: 47.7273s
	iters: 900, epoch: 4 | loss: 1.2191727
	speed: 0.0112s/iter; left time: 47.5501s
	iters: 1000, epoch: 4 | loss: 0.5971527
	speed: 0.0121s/iter; left time: 49.9410s
Updating learning rate to 0.0007955411325
Validation loss decreased (0.4052 --> 0.4007).  Saving model state dict ...
Epoch: 4 cost time: 11.126341819763184
Epoch: 4, Steps: 1027 | Train Loss: 0.5135981 Vali Loss: 0.4007181 Best vali loss: 0.4007181
	iters: 100, epoch: 5 | loss: 1.2231553
	speed: 0.0304s/iter; left time: 122.0106s
	iters: 200, epoch: 5 | loss: 0.9053984
	speed: 0.0114s/iter; left time: 44.5256s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0082075118519, 'e_layers': 4, 'learning_rate': 0.0021560363745, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6138867
	speed: 0.0160s/iter; left time: 31.3100s
	iters: 200, epoch: 1 | loss: 0.8176218
	speed: 0.0102s/iter; left time: 18.8539s
Updating learning rate to 0.0021560363745
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 3.0911474227905273
Epoch: 1, Steps: 257 | Train Loss: 0.7157543 Vali Loss: 0.3744039 Best vali loss: 0.3744039
	iters: 100, epoch: 2 | loss: 0.7779087
	speed: 0.0228s/iter; left time: 38.7827s
	iters: 200, epoch: 2 | loss: 0.7038295
	speed: 0.0104s/iter; left time: 16.6826s
Updating learning rate to 0.00107801818725
Validation loss decreased (0.3744 --> 0.3744).  Saving model state dict ...
Epoch: 2 cost time: 2.7331249713897705
Epoch: 2, Steps: 257 | Train Loss: 0.7408691 Vali Loss: 0.3743736 Best vali loss: 0.3743736
	iters: 100, epoch: 3 | loss: 0.5153131
	speed: 0.0215s/iter; left time: 31.0045s
	iters: 200, epoch: 3 | loss: 0.7354353
	speed: 0.0108s/iter; left time: 14.4842s
Updating learning rate to 0.000539009093625
Epoch: 3 cost time: 2.8328964710235596
Epoch: 3, Steps: 257 | Train Loss: 0.6253742 Vali Loss: 0.3748725 Best vali loss: 0.3743736
	iters: 100, epoch: 4 | loss: 0.3656320
	speed: 0.0224s/iter; left time: 26.5240s
	iters: 200, epoch: 4 | loss: 0.5732042
	speed: 0.0100s/iter; left time: 10.8993s
Updating learning rate to 0.0002695045468125
Validation loss decreased (0.3744 --> 0.3715).  Saving model state dict ...
Epoch: 4 cost time: 2.6307873725891113
Epoch: 4, Steps: 257 | Train Loss: 0.4694181 Vali Loss: 0.3714709 Best vali loss: 0.3714709
	iters: 100, epoch: 5 | loss: 0.4269257
	speed: 0.0204s/iter; left time: 18.9815s
	iters: 200, epoch: 5 | loss: 0.5252012
	speed: 0.0126s/iter; left time: 10.4254s
Updating learning rate to 0.00013475227340625
Epoch: 5 cost time: 3.0922935009002686
Epoch: 5, Steps: 257 | Train Loss: 0.4760634 Vali Loss: 0.3783649 Best vali loss: 0.3714709
	iters: 100, epoch: 6 | loss: 0.5292077
	speed: 0.0302s/iter; left time: 20.2662s
	iters: 200, epoch: 6 | loss: 0.3928703
	speed: 0.0163s/iter; left time: 9.3088s
Updating learning rate to 6.7376136703125e-05
Epoch: 6 cost time: 3.8557190895080566
Epoch: 6, Steps: 257 | Train Loss: 0.4610390 Vali Loss: 0.3767414 Best vali loss: 0.3714709
	iters: 100, epoch: 7 | loss: 0.6163929
	speed: 0.0339s/iter; left time: 14.0837s
	iters: 200, epoch: 7 | loss: 0.5625551
	speed: 0.0162s/iter; left time: 5.1178s
Updating learning rate to 3.36880683515625e-05
Epoch: 7 cost time: 4.101872444152832
Epoch: 7, Steps: 257 | Train Loss: 0.5894740 Vali Loss: 0.3794536 Best vali loss: 0.3714709
	iters: 100, epoch: 8 | loss: 0.7353185
	speed: 0.0364s/iter; left time: 5.7576s
	iters: 200, epoch: 8 | loss: 0.7382219
	speed: 0.0201s/iter; left time: 1.1641s
Updating learning rate to 1.684403417578125e-05
Epoch: 8 cost time: 4.807730197906494
Epoch: 8, Steps: 257 | Train Loss: 0.7367702 Vali Loss: 0.3782615 Best vali loss: 0.3714709

best validation loss 0.3714709335319654

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0046664203288, 'e_layers': 2, 'learning_rate': 0.0005146186858, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7091563
	speed: 0.0222s/iter; left time: 20.7196s
Updating learning rate to 0.0004950321783292384
Validation loss decreased (inf --> 0.3684).  Saving model state dict ...
Epoch: 1 cost time: 2.358996868133545
Epoch: 1, Steps: 129 | Train Loss: 0.7091563 Vali Loss: 0.3684477 Best vali loss: 0.3684477
	iters: 100, epoch: 2 | loss: 0.7628898
	speed: 0.0191s/iter; left time: 15.3889s
Updating learning rate to 0.0004392545241272446
Epoch: 2 cost time: 1.328282356262207
Epoch: 2, Steps: 129 | Train Loss: 0.7628898 Vali Loss: 0.3703666 Best vali loss: 0.3684477
	iters: 100, epoch: 3 | loss: 0.4589254
	speed: 0.0207s/iter; left time: 13.9783s
Updating learning rate to 0.00035577736542057785
Validation loss decreased (0.3684 --> 0.3650).  Saving model state dict ...
Epoch: 3 cost time: 1.32484769821167
Epoch: 3, Steps: 129 | Train Loss: 0.4589254 Vali Loss: 0.3650222 Best vali loss: 0.3650222

best validation loss 0.36502221202100893

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.003384061485, 'e_layers': 4, 'learning_rate': 7.01601196e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6424132
	speed: 0.0183s/iter; left time: 73.3069s
	iters: 200, epoch: 1 | loss: 0.6196902
	speed: 0.0113s/iter; left time: 44.2807s
	iters: 300, epoch: 1 | loss: 0.7434930
	speed: 0.0140s/iter; left time: 53.3918s
	iters: 400, epoch: 1 | loss: 0.4232609
	speed: 0.0148s/iter; left time: 54.9306s
	iters: 500, epoch: 1 | loss: 0.3922985
	speed: 0.0144s/iter; left time: 52.0128s
Updating learning rate to 6.748980904849198e-05
Validation loss decreased (inf --> 0.3656).  Saving model state dict ...
Epoch: 1 cost time: 7.2075254917144775
Epoch: 1, Steps: 514 | Train Loss: 0.5642312 Vali Loss: 0.3656171 Best vali loss: 0.3656171
	iters: 100, epoch: 2 | loss: 0.3288691
	speed: 0.0651s/iter; left time: 227.8847s
	iters: 200, epoch: 2 | loss: 0.2798336
	speed: 0.0145s/iter; left time: 49.2902s
	iters: 300, epoch: 2 | loss: 0.6327825
	speed: 0.0178s/iter; left time: 58.6032s
	iters: 400, epoch: 2 | loss: 0.6926188
	speed: 0.0158s/iter; left time: 50.6198s
	iters: 500, epoch: 2 | loss: 0.4498962
	speed: 0.0133s/iter; left time: 41.1152s
Updating learning rate to 5.9885407969009595e-05
Validation loss decreased (0.3656 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 7.828510522842407
Epoch: 2, Steps: 514 | Train Loss: 0.4768000 Vali Loss: 0.3623453 Best vali loss: 0.3623453
	iters: 100, epoch: 3 | loss: 0.4055870
	speed: 0.0559s/iter; left time: 166.9851s
	iters: 200, epoch: 3 | loss: 0.6411632
	speed: 0.0165s/iter; left time: 47.6760s
	iters: 300, epoch: 3 | loss: 0.5332587
	speed: 0.0148s/iter; left time: 41.0981s
	iters: 400, epoch: 3 | loss: 0.9756068
	speed: 0.0122s/iter; left time: 32.7161s
	iters: 500, epoch: 3 | loss: 0.5355361
	speed: 0.0143s/iter; left time: 36.8900s
Updating learning rate to 4.85046174918366e-05
Epoch: 3 cost time: 7.63519024848938
Epoch: 3, Steps: 514 | Train Loss: 0.6182304 Vali Loss: 0.3637452 Best vali loss: 0.3623453

best validation loss 0.3623452738190915

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0090342263642, 'e_layers': 4, 'learning_rate': 7.09981557e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 7.09981557e-05
Validation loss decreased (inf --> 0.4371).  Saving model state dict ...
Epoch: 1 cost time: 2.887160539627075
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4371252 Best vali loss: 0.4371252
Updating learning rate to 3.549907785e-05
Validation loss decreased (0.4371 --> 0.4252).  Saving model state dict ...
Epoch: 2 cost time: 1.4803881645202637
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4251564 Best vali loss: 0.4251564
Updating learning rate to 1.7749538925e-05
Validation loss decreased (0.4252 --> 0.4203).  Saving model state dict ...
Epoch: 3 cost time: 2.729581594467163
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4202640 Best vali loss: 0.4202640

best validation loss 0.42026396200558525

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.003384061485, 'e_layers': 4, 'learning_rate': 7.01601196e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5882331
	speed: 0.0221s/iter; left time: 54.6812s
	iters: 200, epoch: 4 | loss: 0.5797834
	speed: 0.0151s/iter; left time: 35.7325s
	iters: 300, epoch: 4 | loss: 0.7071542
	speed: 0.0156s/iter; left time: 35.4433s
	iters: 400, epoch: 4 | loss: 0.3964235
	speed: 0.0166s/iter; left time: 36.0426s
	iters: 500, epoch: 4 | loss: 0.4023293
	speed: 0.0092s/iter; left time: 19.0090s
Updating learning rate to 3.50800598e-05
Epoch: 4 cost time: 7.6236653327941895
Epoch: 4, Steps: 514 | Train Loss: 0.5347847 Vali Loss: 0.3631197 Best vali loss: 0.3623453
	iters: 100, epoch: 5 | loss: 0.2882802
	speed: 0.0259s/iter; left time: 50.7113s
	iters: 200, epoch: 5 | loss: 0.2676686
	speed: 0.0144s/iter; left time: 26.7601s
	iters: 300, epoch: 5 | loss: 0.5750327
	speed: 0.0167s/iter; left time: 29.3900s
	iters: 400, epoch: 5 | loss: 0.5812008
	speed: 0.0184s/iter; left time: 30.4659s
	iters: 500, epoch: 5 | loss: 0.4468768
	speed: 0.0167s/iter; left time: 25.9359s
Updating learning rate to 2.1655502108163395e-05
Validation loss decreased (0.3623 --> 0.3622).  Saving model state dict ...
Epoch: 5 cost time: 8.155610799789429
Epoch: 5, Steps: 514 | Train Loss: 0.4318118 Vali Loss: 0.3621996 Best vali loss: 0.3621996
	iters: 100, epoch: 6 | loss: 0.3745287
	speed: 0.0485s/iter; left time: 69.9609s
	iters: 200, epoch: 6 | loss: 0.5562539
	speed: 0.0125s/iter; left time: 16.7958s
	iters: 300, epoch: 6 | loss: 0.5257803
	speed: 0.0134s/iter; left time: 16.6289s
	iters: 400, epoch: 6 | loss: 0.8974755
	speed: 0.0121s/iter; left time: 13.7978s
	iters: 500, epoch: 6 | loss: 0.5704179
	speed: 0.0123s/iter; left time: 12.8356s
Updating learning rate to 1.02747116309904e-05
Epoch: 6 cost time: 6.5791175365448
Epoch: 6, Steps: 514 | Train Loss: 0.5848913 Vali Loss: 0.3626132 Best vali loss: 0.3621996
	iters: 100, epoch: 7 | loss: 0.4722079
	speed: 0.0387s/iter; left time: 35.9140s
	iters: 200, epoch: 7 | loss: 0.2975094
	speed: 0.0123s/iter; left time: 10.1824s
	iters: 300, epoch: 7 | loss: 0.8597983
	speed: 0.0162s/iter; left time: 11.7835s
	iters: 400, epoch: 7 | loss: 0.6816359
	speed: 0.0163s/iter; left time: 10.2258s
	iters: 500, epoch: 7 | loss: 0.7729425
	speed: 0.0159s/iter; left time: 8.4217s
Updating learning rate to 2.670310551508017e-06
Epoch: 7 cost time: 7.671107769012451
Epoch: 7, Steps: 514 | Train Loss: 0.6168188 Vali Loss: 0.3655188 Best vali loss: 0.3621996
	iters: 100, epoch: 8 | loss: 0.2163091
	speed: 0.0723s/iter; left time: 29.9876s
	iters: 200, epoch: 8 | loss: 0.3788182
	speed: 0.0155s/iter; left time: 4.8828s
	iters: 300, epoch: 8 | loss: 0.6622204
	speed: 0.0089s/iter; left time: 1.9141s
	iters: 400, epoch: 8 | loss: 0.3853002
	speed: 0.0085s/iter; left time: 0.9785s
	iters: 500, epoch: 8 | loss: 1.0515316
	speed: 0.0121s/iter; left time: 0.1811s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.310376405715942
Epoch: 8, Steps: 514 | Train Loss: 0.5388359 Vali Loss: 0.3645252 Best vali loss: 0.3621996

best validation loss 0.36219960082841995

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0075551485169, 'e_layers': 2, 'learning_rate': 0.0001043150747, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00010034481857385798
Validation loss decreased (inf --> 0.3634).  Saving model state dict ...
Epoch: 1 cost time: 1.1533818244934082
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3634118 Best vali loss: 0.3634118
Updating learning rate to 8.903848570017563e-05
Epoch: 2 cost time: 1.3309743404388428
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3658600 Best vali loss: 0.3634118
Updating learning rate to 7.211736276680837e-05
Validation loss decreased (0.3634 --> 0.3612).  Saving model state dict ...
Epoch: 3 cost time: 1.1266238689422607
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3611806 Best vali loss: 0.3611806
Updating learning rate to 5.215753735e-05
Validation loss decreased (0.3612 --> 0.3557).  Saving model state dict ...
Epoch: 4 cost time: 1.3802626132965088
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3556562 Best vali loss: 0.3556562
Updating learning rate to 3.2197711933191636e-05
Epoch: 5 cost time: 0.769942045211792
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3682770 Best vali loss: 0.3556562
Updating learning rate to 1.5276588999824375e-05
Epoch: 6 cost time: 0.6831138134002686
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3653754 Best vali loss: 0.3556562
Updating learning rate to 3.970256126142023e-06
Epoch: 7 cost time: 0.9591395854949951
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3674762 Best vali loss: 0.3556562
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0935492515563965
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3689983 Best vali loss: 0.3556562

best validation loss 0.3556561861267727

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0020876072005, 'e_layers': 4, 'learning_rate': 0.0038416036996, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5156320
	speed: 0.0178s/iter; left time: 144.5954s
	iters: 200, epoch: 1 | loss: 1.2666010
	speed: 0.0107s/iter; left time: 86.1702s
	iters: 300, epoch: 1 | loss: 0.8281062
	speed: 0.0083s/iter; left time: 65.8915s
	iters: 400, epoch: 1 | loss: 0.2367020
	speed: 0.0077s/iter; left time: 60.2518s
	iters: 500, epoch: 1 | loss: 0.5857004
	speed: 0.0093s/iter; left time: 71.6728s
	iters: 600, epoch: 1 | loss: 1.0520862
	speed: 0.0098s/iter; left time: 74.2911s
	iters: 700, epoch: 1 | loss: 0.6342826
	speed: 0.0073s/iter; left time: 54.8073s
	iters: 800, epoch: 1 | loss: 1.4597189
	speed: 0.0085s/iter; left time: 62.8418s
	iters: 900, epoch: 1 | loss: 1.8181127
	speed: 0.0106s/iter; left time: 77.2150s
	iters: 1000, epoch: 1 | loss: 1.0551887
	speed: 0.0095s/iter; left time: 68.8037s
Updating learning rate to 0.0038416036996
Validation loss decreased (inf --> 0.4038).  Saving model state dict ...
Epoch: 1 cost time: 9.88047981262207
Epoch: 1, Steps: 1027 | Train Loss: 0.9452131 Vali Loss: 0.4038423 Best vali loss: 0.4038423
	iters: 100, epoch: 2 | loss: 0.4856678
	speed: 0.0236s/iter; left time: 167.0856s
	iters: 200, epoch: 2 | loss: 0.3710252
	speed: 0.0080s/iter; left time: 56.1147s
	iters: 300, epoch: 2 | loss: 0.3634771
	speed: 0.0085s/iter; left time: 58.8408s
	iters: 400, epoch: 2 | loss: 1.0845609
	speed: 0.0105s/iter; left time: 71.3593s
	iters: 500, epoch: 2 | loss: 0.4404673
	speed: 0.0106s/iter; left time: 70.7079s
	iters: 600, epoch: 2 | loss: 0.4014163
	speed: 0.0107s/iter; left time: 70.2550s
	iters: 700, epoch: 2 | loss: 0.1927719
	speed: 0.0109s/iter; left time: 71.0500s
	iters: 800, epoch: 2 | loss: 1.0160366
	speed: 0.0097s/iter; left time: 61.8922s
	iters: 900, epoch: 2 | loss: 0.4036328
	speed: 0.0101s/iter; left time: 63.5066s
	iters: 1000, epoch: 2 | loss: 0.7937314
	speed: 0.0109s/iter; left time: 67.2760s
Updating learning rate to 0.0019208018498
Epoch: 2 cost time: 10.181281566619873
Epoch: 2, Steps: 1027 | Train Loss: 0.5552787 Vali Loss: 0.4046970 Best vali loss: 0.4038423
	iters: 100, epoch: 3 | loss: 0.2479830
	speed: 0.0263s/iter; left time: 159.7585s
	iters: 200, epoch: 3 | loss: 0.3464808
	speed: 0.0108s/iter; left time: 64.1439s
	iters: 300, epoch: 3 | loss: 0.9940410
	speed: 0.0102s/iter; left time: 59.8601s
	iters: 400, epoch: 3 | loss: 1.2357318
	speed: 0.0109s/iter; left time: 62.6865s
	iters: 500, epoch: 3 | loss: 0.3014336
	speed: 0.0117s/iter; left time: 66.4196s
	iters: 600, epoch: 3 | loss: 0.5519710
	speed: 0.0112s/iter; left time: 62.5228s
	iters: 700, epoch: 3 | loss: 1.4950001
	speed: 0.0113s/iter; left time: 61.8635s
	iters: 800, epoch: 3 | loss: 0.4180603
	speed: 0.0086s/iter; left time: 46.2507s
	iters: 900, epoch: 3 | loss: 0.9723878
	speed: 0.0098s/iter; left time: 51.3227s
	iters: 1000, epoch: 3 | loss: 1.3780625
	speed: 0.0092s/iter; left time: 47.4693s
Updating learning rate to 0.0009604009249
Validation loss decreased (0.4038 --> 0.4027).  Saving model state dict ...
Epoch: 3 cost time: 10.79788875579834
Epoch: 3, Steps: 1027 | Train Loss: 0.7941152 Vali Loss: 0.4026504 Best vali loss: 0.4026504
	iters: 100, epoch: 4 | loss: 1.5862006
	speed: 0.0282s/iter; left time: 141.8527s
	iters: 200, epoch: 4 | loss: 0.6302448
	speed: 0.0092s/iter; left time: 45.5348s
	iters: 300, epoch: 4 | loss: 0.4446040
	speed: 0.0107s/iter; left time: 51.6940s
	iters: 400, epoch: 4 | loss: 0.6070353
	speed: 0.0100s/iter; left time: 47.5810s
	iters: 500, epoch: 4 | loss: 1.0023944
	speed: 0.0093s/iter; left time: 42.9007s
	iters: 600, epoch: 4 | loss: 1.7332276
	speed: 0.0100s/iter; left time: 45.2329s
	iters: 700, epoch: 4 | loss: 0.3158909
	speed: 0.0100s/iter; left time: 44.5122s
	iters: 800, epoch: 4 | loss: 0.3302850
	speed: 0.0104s/iter; left time: 44.9100s
	iters: 900, epoch: 4 | loss: 0.4394478
	speed: 0.0106s/iter; left time: 45.0929s
	iters: 1000, epoch: 4 | loss: 0.3391668
	speed: 0.0105s/iter; left time: 43.3287s
Updating learning rate to 0.00048020046245
Epoch: 4 cost time: 10.463600635528564
Epoch: 4, Steps: 1027 | Train Loss: 0.7428497 Vali Loss: 0.4038191 Best vali loss: 0.4026504
	iters: 100, epoch: 5 | loss: 0.4467639
	speed: 0.0276s/iter; left time: 110.5086s
	iters: 200, epoch: 5 | loss: 1.0059440
	speed: 0.0113s/iter; left time: 44.0182s
	iters: 300, epoch: 5 | loss: 1.0463136
	speed: 0.0112s/iter; left time: 42.6208s
	iters: 400, epoch: 5 | loss: 0.3042145
	speed: 0.0114s/iter; left time: 42.1255s
	iters: 500, epoch: 5 | loss: 0.7680712
	speed: 0.0108s/iter; left time: 39.1350s
	iters: 600, epoch: 5 | loss: 0.2769364
	speed: 0.0084s/iter; left time: 29.6246s
	iters: 700, epoch: 5 | loss: 0.5100874
	speed: 0.0098s/iter; left time: 33.5530s
	iters: 800, epoch: 5 | loss: 0.6871147
	speed: 0.0185s/iter; left time: 61.3521s
	iters: 900, epoch: 5 | loss: 0.3781203
	speed: 0.0150s/iter; left time: 48.2068s
	iters: 1000, epoch: 5 | loss: 0.3807580
	speed: 0.0185s/iter; left time: 57.4815s
Updating learning rate to 0.000240100231225
Epoch: 5 cost time: 12.934087991714478
Epoch: 5, Steps: 1027 | Train Loss: 0.5804324 Vali Loss: 0.4034827 Best vali loss: 0.4026504
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0019541931717, 'e_layers': 4, 'learning_rate': 0.0008380425529, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9784428
	speed: 0.0206s/iter; left time: 82.5448s
	iters: 200, epoch: 1 | loss: 0.3723127
	speed: 0.0128s/iter; left time: 49.9796s
	iters: 300, epoch: 1 | loss: 0.8743729
	speed: 0.0120s/iter; left time: 45.9015s
	iters: 400, epoch: 1 | loss: 1.0716794
	speed: 0.0093s/iter; left time: 34.5185s
	iters: 500, epoch: 1 | loss: 0.3860801
	speed: 0.0150s/iter; left time: 54.2123s
Updating learning rate to 0.0008380425529
Validation loss decreased (inf --> 0.4124).  Saving model state dict ...
Epoch: 1 cost time: 6.786168336868286
Epoch: 1, Steps: 514 | Train Loss: 0.7365776 Vali Loss: 0.4124071 Best vali loss: 0.4124071
	iters: 100, epoch: 2 | loss: 1.1212417
	speed: 0.0675s/iter; left time: 236.1717s
	iters: 200, epoch: 2 | loss: 0.6246498
	speed: 0.0164s/iter; left time: 55.7292s
	iters: 300, epoch: 2 | loss: 0.7860574
	speed: 0.0172s/iter; left time: 56.7784s
	iters: 400, epoch: 2 | loss: 0.6805308
	speed: 0.0155s/iter; left time: 49.5070s
	iters: 500, epoch: 2 | loss: 0.4360067
	speed: 0.0151s/iter; left time: 46.8033s
Updating learning rate to 0.00041902127645
Validation loss decreased (0.4124 --> 0.4052).  Saving model state dict ...
Epoch: 2 cost time: 8.205031633377075
Epoch: 2, Steps: 514 | Train Loss: 0.7296973 Vali Loss: 0.4052434 Best vali loss: 0.4052434
	iters: 100, epoch: 3 | loss: 0.3725831
	speed: 0.0656s/iter; left time: 195.7791s
	iters: 200, epoch: 3 | loss: 0.5567382
	speed: 0.0159s/iter; left time: 45.7867s
	iters: 300, epoch: 3 | loss: 1.4111800
	speed: 0.0162s/iter; left time: 45.1754s
	iters: 400, epoch: 3 | loss: 1.5032302
	speed: 0.0151s/iter; left time: 40.5136s
	iters: 500, epoch: 3 | loss: 0.4210782
	speed: 0.0126s/iter; left time: 32.4839s
Updating learning rate to 0.000209510638225
Validation loss decreased (0.4052 --> 0.4003).  Saving model state dict ...
Epoch: 3 cost time: 7.704051733016968
Epoch: 3, Steps: 514 | Train Loss: 0.8529619 Vali Loss: 0.4002755 Best vali loss: 0.4002755

best validation loss 0.40027554557459294

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 2.6992530822753906
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3665982 Best vali loss: 0.3665982
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 2.4949676990509033
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3721837 Best vali loss: 0.3665982
Updating learning rate to 0.0008072813968307993
Epoch: 3 cost time: 2.624626636505127
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3693865 Best vali loss: 0.3665982

best validation loss 0.3665981802818583

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0010650567536, 'e_layers': 4, 'learning_rate': 6.7384655e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.7384655e-05
Validation loss decreased (inf --> 0.4218).  Saving model state dict ...
Epoch: 1 cost time: 2.2863383293151855
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4217726 Best vali loss: 0.4217726
Updating learning rate to 3.36923275e-05
Validation loss decreased (0.4218 --> 0.4047).  Saving model state dict ...
Epoch: 2 cost time: 1.277324914932251
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4046532 Best vali loss: 0.4046532
Updating learning rate to 1.684616375e-05
Validation loss decreased (0.4047 --> 0.3984).  Saving model state dict ...
Epoch: 3 cost time: 1.125260353088379
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3983737 Best vali loss: 0.3983737

best validation loss 0.3983737361103238

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 1.1178860664367676
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3813552 Best vali loss: 0.3665982
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.7263832092285156
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3696562 Best vali loss: 0.3665982
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.8152389526367188
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3767307 Best vali loss: 0.3665982
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.9340791702270508
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3760942 Best vali loss: 0.3665982
Updating learning rate to 0.0
Epoch: 8 cost time: 1.196702480316162
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3773846 Best vali loss: 0.3665982

best validation loss 0.3665981802818583

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.010282756286, 'e_layers': 2, 'learning_rate': 0.0001844439031, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5272084
	speed: 0.0119s/iter; left time: 96.7673s
	iters: 200, epoch: 1 | loss: 0.4937851
	speed: 0.0073s/iter; left time: 58.1721s
	iters: 300, epoch: 1 | loss: 2.0046566
	speed: 0.0086s/iter; left time: 67.8989s
	iters: 400, epoch: 1 | loss: 0.9276770
	speed: 0.0056s/iter; left time: 43.4354s
	iters: 500, epoch: 1 | loss: 0.5901683
	speed: 0.0079s/iter; left time: 60.6297s
	iters: 600, epoch: 1 | loss: 0.9836297
	speed: 0.0070s/iter; left time: 53.4077s
	iters: 700, epoch: 1 | loss: 1.2230077
	speed: 0.0059s/iter; left time: 44.4768s
	iters: 800, epoch: 1 | loss: 0.3166707
	speed: 0.0062s/iter; left time: 46.0625s
	iters: 900, epoch: 1 | loss: 0.3646303
	speed: 0.0087s/iter; left time: 63.7008s
	iters: 1000, epoch: 1 | loss: 0.7391531
	speed: 0.0060s/iter; left time: 43.4654s
Updating learning rate to 0.00017742392503529254
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 7.334974050521851
Epoch: 1, Steps: 1027 | Train Loss: 0.8170587 Vali Loss: 0.3727238 Best vali loss: 0.3727238
	iters: 100, epoch: 2 | loss: 0.7211375
	speed: 0.0165s/iter; left time: 117.1108s
	iters: 200, epoch: 2 | loss: 0.4887511
	speed: 0.0048s/iter; left time: 33.4237s
	iters: 300, epoch: 2 | loss: 0.4116106
	speed: 0.0055s/iter; left time: 38.1213s
	iters: 400, epoch: 2 | loss: 0.3125902
	speed: 0.0069s/iter; left time: 46.7955s
	iters: 500, epoch: 2 | loss: 0.9315497
	speed: 0.0062s/iter; left time: 41.2382s
	iters: 600, epoch: 2 | loss: 0.6189581
	speed: 0.0067s/iter; left time: 44.4515s
	iters: 700, epoch: 2 | loss: 0.4658700
	speed: 0.0073s/iter; left time: 47.5931s
	iters: 800, epoch: 2 | loss: 1.0122074
	speed: 0.0069s/iter; left time: 44.3601s
	iters: 900, epoch: 2 | loss: 0.2282149
	speed: 0.0083s/iter; left time: 52.0864s
	iters: 1000, epoch: 2 | loss: 1.3483198
	speed: 0.0081s/iter; left time: 50.3007s
Updating learning rate to 0.00015743271886526223
Validation loss decreased (0.3727 --> 0.3631).  Saving model state dict ...
Epoch: 2 cost time: 6.8892059326171875
Epoch: 2, Steps: 1027 | Train Loss: 0.6539209 Vali Loss: 0.3630669 Best vali loss: 0.3630669
	iters: 100, epoch: 3 | loss: 0.3863513
	speed: 0.0185s/iter; left time: 111.9245s
	iters: 200, epoch: 3 | loss: 0.8135355
	speed: 0.0043s/iter; left time: 25.5956s
	iters: 300, epoch: 3 | loss: 0.5163860
	speed: 0.0083s/iter; left time: 48.9453s
	iters: 400, epoch: 3 | loss: 0.2188998
	speed: 0.0095s/iter; left time: 54.6174s
	iters: 500, epoch: 3 | loss: 0.3349106
	speed: 0.0093s/iter; left time: 52.6686s
	iters: 600, epoch: 3 | loss: 0.2867359
	speed: 0.0055s/iter; left time: 30.5478s
	iters: 700, epoch: 3 | loss: 0.4524485
	speed: 0.0065s/iter; left time: 35.3901s
	iters: 800, epoch: 3 | loss: 0.2113503
	speed: 0.0087s/iter; left time: 46.7190s
	iters: 900, epoch: 3 | loss: 0.7787153
	speed: 0.0099s/iter; left time: 52.3606s
	iters: 1000, epoch: 3 | loss: 0.1700443
	speed: 0.0097s/iter; left time: 50.0877s
Updating learning rate to 0.00012751376450856103
Epoch: 3 cost time: 7.9855287075042725
Epoch: 3, Steps: 1027 | Train Loss: 0.4169378 Vali Loss: 0.3786107 Best vali loss: 0.3630669
	iters: 100, epoch: 4 | loss: 1.0404146
	speed: 0.0248s/iter; left time: 124.9611s
	iters: 200, epoch: 4 | loss: 0.3606359
	speed: 0.0054s/iter; left time: 26.7346s
	iters: 300, epoch: 4 | loss: 0.9368174
	speed: 0.0053s/iter; left time: 25.8074s
	iters: 400, epoch: 4 | loss: 0.4324299
	speed: 0.0062s/iter; left time: 29.4458s
	iters: 500, epoch: 4 | loss: 0.2772751
	speed: 0.0066s/iter; left time: 30.4931s
	iters: 600, epoch: 4 | loss: 0.5776736
	speed: 0.0065s/iter; left time: 29.4726s
	iters: 700, epoch: 4 | loss: 0.4316323
	speed: 0.0066s/iter; left time: 29.0899s
	iters: 800, epoch: 4 | loss: 0.3456864
	speed: 0.0063s/iter; left time: 27.4582s
	iters: 900, epoch: 4 | loss: 0.3616244
	speed: 0.0061s/iter; left time: 25.9551s
	iters: 1000, epoch: 4 | loss: 0.8063142
	speed: 0.0061s/iter; left time: 25.4277s
Updating learning rate to 9.222195155e-05
Epoch: 4 cost time: 6.2858500480651855
Epoch: 4, Steps: 1027 | Train Loss: 0.5570504 Vali Loss: 0.3908418 Best vali loss: 0.3630669
	iters: 100, epoch: 5 | loss: 0.9519248
	speed: 0.0183s/iter; left time: 73.5543s
	iters: 200, epoch: 5 | loss: 0.3720357
	speed: 0.0080s/iter; left time: 31.3618s
	iters: 300, epoch: 5 | loss: 0.1869067
	speed: 0.0067s/iter; left time: 25.3854s
	iters: 400, epoch: 5 | loss: 0.4732103
	speed: 0.0073s/iter; left time: 26.9838s
	iters: 500, epoch: 5 | loss: 0.4257883
	speed: 0.0065s/iter; left time: 23.2942s
	iters: 600, epoch: 5 | loss: 0.8590810
	speed: 0.0065s/iter; left time: 22.6646s
	iters: 700, epoch: 5 | loss: 0.8267674
	speed: 0.0058s/iter; left time: 19.6630s
	iters: 800, epoch: 5 | loss: 0.2748672
	speed: 0.0052s/iter; left time: 17.3692s
	iters: 900, epoch: 5 | loss: 0.4444498
	speed: 0.0057s/iter; left time: 18.1458s
	iters: 1000, epoch: 5 | loss: 1.4791766
	speed: 0.0078s/iter; left time: 24.1006s
Updating learning rate to 5.6930138591438997e-05
Epoch: 5 cost time: 6.748701095581055
Epoch: 5, Steps: 1027 | Train Loss: 0.6294208 Vali Loss: 0.3660088 Best vali loss: 0.3630669
	iters: 100, epoch: 6 | loss: 1.4444640
	speed: 0.0235s/iter; left time: 70.1732s
	iters: 200, epoch: 6 | loss: 0.2351530
	speed: 0.0068s/iter; left time: 19.7249s
	iters: 300, epoch: 6 | loss: 0.5378894
	speed: 0.0066s/iter; left time: 18.4472s
	iters: 400, epoch: 6 | loss: 0.3671780
	speed: 0.0056s/iter; left time: 14.9223s
	iters: 500, epoch: 6 | loss: 0.3303086
	speed: 0.0051s/iter; left time: 13.2872s
	iters: 600, epoch: 6 | loss: 0.3633253
	speed: 0.0056s/iter; left time: 13.7873s
	iters: 700, epoch: 6 | loss: 0.3018731
	speed: 0.0068s/iter; left time: 16.1308s
	iters: 800, epoch: 6 | loss: 0.4353744
	speed: 0.0075s/iter; left time: 17.0167s
	iters: 900, epoch: 6 | loss: 0.5359684
	speed: 0.0066s/iter; left time: 14.4209s
	iters: 1000, epoch: 6 | loss: 0.8330576
	speed: 0.0075s/iter; left time: 15.6293s
Updating learning rate to 2.701118423473777e-05
Epoch: 6 cost time: 6.791645288467407
Epoch: 6, Steps: 1027 | Train Loss: 0.5384592 Vali Loss: 0.3715548 Best vali loss: 0.3630669
	iters: 100, epoch: 7 | loss: 0.3534974
	speed: 0.0222s/iter; left time: 43.4664s
	iters: 200, epoch: 7 | loss: 0.3946068
	speed: 0.0070s/iter; left time: 12.9042s
	iters: 300, epoch: 7 | loss: 0.6563720
	speed: 0.0066s/iter; left time: 11.5377s
	iters: 400, epoch: 7 | loss: 0.4124493
	speed: 0.0069s/iter; left time: 11.4255s
	iters: 500, epoch: 7 | loss: 0.2976144
	speed: 0.0063s/iter; left time: 9.7928s
	iters: 600, epoch: 7 | loss: 1.1512028
	speed: 0.0053s/iter; left time: 7.7543s
	iters: 700, epoch: 7 | loss: 0.4006409
	speed: 0.0060s/iter; left time: 8.1765s
	iters: 800, epoch: 7 | loss: 2.2677181
	speed: 0.0062s/iter; left time: 7.7873s
	iters: 900, epoch: 7 | loss: 0.2681653
	speed: 0.0061s/iter; left time: 7.0392s
	iters: 1000, epoch: 7 | loss: 0.3846170
	speed: 0.0064s/iter; left time: 6.7871s
Updating learning rate to 7.019978064707465e-06
Epoch: 7 cost time: 6.537921667098999
Epoch: 7, Steps: 1027 | Train Loss: 0.6586884 Vali Loss: 0.3842945 Best vali loss: 0.3630669
	iters: 100, epoch: 8 | loss: 1.0581956
	speed: 0.0203s/iter; left time: 18.8740s
	iters: 200, epoch: 8 | loss: 0.8126957
	speed: 0.0065s/iter; left time: 5.3473s
	iters: 300, epoch: 8 | loss: 0.2307063
	speed: 0.0061s/iter; left time: 4.4734s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013224837754, 'e_layers': 4, 'learning_rate': 0.0001941136611, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8579367
	speed: 0.0169s/iter; left time: 67.6423s
	iters: 200, epoch: 1 | loss: 0.6920363
	speed: 0.0091s/iter; left time: 35.5505s
	iters: 300, epoch: 1 | loss: 1.2366959
	speed: 0.0121s/iter; left time: 46.0178s
	iters: 400, epoch: 1 | loss: 0.7434241
	speed: 0.0121s/iter; left time: 44.9487s
	iters: 500, epoch: 1 | loss: 0.7879969
	speed: 0.0130s/iter; left time: 46.7985s
Updating learning rate to 0.0001941136611
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 6.193748712539673
Epoch: 1, Steps: 514 | Train Loss: 0.8636180 Vali Loss: 0.3697484 Best vali loss: 0.3697484
	iters: 100, epoch: 2 | loss: 0.3588353
	speed: 0.0378s/iter; left time: 132.2226s
	iters: 200, epoch: 2 | loss: 0.2297298
	speed: 0.0095s/iter; left time: 32.3513s
	iters: 300, epoch: 2 | loss: 0.3010750
	speed: 0.0133s/iter; left time: 43.7139s
	iters: 400, epoch: 2 | loss: 0.6532362
	speed: 0.0148s/iter; left time: 47.5031s
	iters: 500, epoch: 2 | loss: 0.4053966
	speed: 0.0152s/iter; left time: 46.9851s
Updating learning rate to 9.705683055e-05
Validation loss decreased (0.3697 --> 0.3672).  Saving model state dict ...
Epoch: 2 cost time: 6.777621030807495
Epoch: 2, Steps: 514 | Train Loss: 0.3896546 Vali Loss: 0.3671577 Best vali loss: 0.3671577
	iters: 100, epoch: 3 | loss: 0.4717069
	speed: 0.0387s/iter; left time: 115.5166s
	iters: 200, epoch: 3 | loss: 0.5651475
	speed: 0.0110s/iter; left time: 31.6242s
	iters: 300, epoch: 3 | loss: 0.6299026
	speed: 0.0133s/iter; left time: 37.0110s
	iters: 400, epoch: 3 | loss: 0.3680845
	speed: 0.0139s/iter; left time: 37.3552s
	iters: 500, epoch: 3 | loss: 0.8340033
	speed: 0.0130s/iter; left time: 33.6101s
Updating learning rate to 4.8528415275e-05
Validation loss decreased (0.3672 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 6.528099298477173
Epoch: 3, Steps: 514 | Train Loss: 0.5737690 Vali Loss: 0.3661853 Best vali loss: 0.3661853
	iters: 100, epoch: 4 | loss: 0.5741637
	speed: 0.0334s/iter; left time: 82.6265s
	iters: 200, epoch: 4 | loss: 0.3438047
	speed: 0.0122s/iter; left time: 28.8596s
	iters: 300, epoch: 4 | loss: 0.9033882
	speed: 0.0137s/iter; left time: 31.0372s
	iters: 400, epoch: 4 | loss: 0.8858045
	speed: 0.0146s/iter; left time: 31.6780s
	iters: 500, epoch: 4 | loss: 0.3342149
	speed: 0.0136s/iter; left time: 28.0913s
Updating learning rate to 2.42642076375e-05
Epoch: 4 cost time: 6.946717977523804
Epoch: 4, Steps: 514 | Train Loss: 0.6082752 Vali Loss: 0.3666247 Best vali loss: 0.3661853
	iters: 100, epoch: 5 | loss: 0.8574108
	speed: 0.0372s/iter; left time: 72.8136s
	iters: 200, epoch: 5 | loss: 0.4898523
	speed: 0.0119s/iter; left time: 22.1624s
	iters: 300, epoch: 5 | loss: 0.2877432
	speed: 0.0126s/iter; left time: 22.1439s
	iters: 400, epoch: 5 | loss: 0.4848177
	speed: 0.0102s/iter; left time: 16.9053s
	iters: 500, epoch: 5 | loss: 0.4335596
	speed: 0.0102s/iter; left time: 15.8449s
Updating learning rate to 1.213210381875e-05
Epoch: 5 cost time: 5.956836938858032
Epoch: 5, Steps: 514 | Train Loss: 0.5106767 Vali Loss: 0.3668961 Best vali loss: 0.3661853
	iters: 100, epoch: 6 | loss: 0.3976686
	speed: 0.0336s/iter; left time: 48.5032s
	iters: 200, epoch: 6 | loss: 0.2880684
	speed: 0.0150s/iter; left time: 20.1987s
	iters: 300, epoch: 6 | loss: 0.6515860
	speed: 0.0161s/iter; left time: 20.0295s
	iters: 400, epoch: 6 | loss: 0.2991033
	speed: 0.0150s/iter; left time: 17.0984s
	iters: 500, epoch: 6 | loss: 0.7631441
	speed: 0.0148s/iter; left time: 15.3901s
Updating learning rate to 6.066051909375e-06
Epoch: 6 cost time: 7.4321489334106445
Epoch: 6, Steps: 514 | Train Loss: 0.4799141 Vali Loss: 0.3679807 Best vali loss: 0.3661853
	iters: 100, epoch: 7 | loss: 0.5218797
	speed: 0.0600s/iter; left time: 55.7564s
	iters: 200, epoch: 7 | loss: 0.4105823
	speed: 0.0086s/iter; left time: 7.0976s
	iters: 300, epoch: 7 | loss: 0.5776804
	speed: 0.0092s/iter; left time: 6.7339s
	iters: 400, epoch: 7 | loss: 0.5427985
	speed: 0.0082s/iter; left time: 5.1513s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0083677237872, 'e_layers': 4, 'learning_rate': 0.0003890233416, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5233545
	speed: 0.0177s/iter; left time: 143.3483s
	iters: 200, epoch: 1 | loss: 0.1525167
	speed: 0.0089s/iter; left time: 71.0038s
	iters: 300, epoch: 1 | loss: 0.8507606
	speed: 0.0107s/iter; left time: 84.9234s
	iters: 400, epoch: 1 | loss: 0.9461404
	speed: 0.0110s/iter; left time: 86.1224s
	iters: 500, epoch: 1 | loss: 0.9198107
	speed: 0.0110s/iter; left time: 84.5890s
	iters: 600, epoch: 1 | loss: 0.7987604
	speed: 0.0115s/iter; left time: 87.3244s
	iters: 700, epoch: 1 | loss: 1.1019446
	speed: 0.0115s/iter; left time: 86.4637s
	iters: 800, epoch: 1 | loss: 0.2384992
	speed: 0.0098s/iter; left time: 73.0128s
	iters: 900, epoch: 1 | loss: 0.5912986
	speed: 0.0076s/iter; left time: 55.5483s
	iters: 1000, epoch: 1 | loss: 0.5444671
	speed: 0.0076s/iter; left time: 54.8911s
Updating learning rate to 0.0003890233416
Validation loss decreased (inf --> 0.3753).  Saving model state dict ...
Epoch: 1 cost time: 10.597480297088623
Epoch: 1, Steps: 1027 | Train Loss: 0.6667553 Vali Loss: 0.3752684 Best vali loss: 0.3752684
	iters: 100, epoch: 2 | loss: 0.3430311
	speed: 0.0277s/iter; left time: 196.5092s
	iters: 200, epoch: 2 | loss: 0.6112932
	speed: 0.0107s/iter; left time: 75.0509s
	iters: 300, epoch: 2 | loss: 0.5507063
	speed: 0.0107s/iter; left time: 73.4395s
	iters: 400, epoch: 2 | loss: 0.3906652
	speed: 0.0116s/iter; left time: 78.8218s
	iters: 500, epoch: 2 | loss: 0.4001041
	speed: 0.0112s/iter; left time: 74.6116s
	iters: 600, epoch: 2 | loss: 0.2999371
	speed: 0.0109s/iter; left time: 71.5444s
	iters: 700, epoch: 2 | loss: 0.2342595
	speed: 0.0105s/iter; left time: 67.8997s
	iters: 800, epoch: 2 | loss: 0.6357082
	speed: 0.0104s/iter; left time: 66.4095s
	iters: 900, epoch: 2 | loss: 0.4746575
	speed: 0.0092s/iter; left time: 57.9854s
	iters: 1000, epoch: 2 | loss: 0.5282326
	speed: 0.0113s/iter; left time: 69.7719s
Updating learning rate to 0.0001945116708
Validation loss decreased (0.3753 --> 0.3739).  Saving model state dict ...
Epoch: 2 cost time: 11.066856861114502
Epoch: 2, Steps: 1027 | Train Loss: 0.4468595 Vali Loss: 0.3739083 Best vali loss: 0.3739083
	iters: 100, epoch: 3 | loss: 0.2388835
	speed: 0.0324s/iter; left time: 196.2558s
	iters: 200, epoch: 3 | loss: 0.4343964
	speed: 0.0127s/iter; left time: 75.5547s
	iters: 300, epoch: 3 | loss: 0.5953861
	speed: 0.0130s/iter; left time: 76.2454s
	iters: 400, epoch: 3 | loss: 0.2363535
	speed: 0.0105s/iter; left time: 60.2434s
	iters: 500, epoch: 3 | loss: 0.5512398
	speed: 0.0118s/iter; left time: 66.7012s
	iters: 600, epoch: 3 | loss: 0.4591706
	speed: 0.0120s/iter; left time: 66.6850s
	iters: 700, epoch: 3 | loss: 0.6260352
	speed: 0.0101s/iter; left time: 55.2963s
	iters: 800, epoch: 3 | loss: 0.8173862
	speed: 0.0137s/iter; left time: 73.5261s
	iters: 900, epoch: 3 | loss: 0.3324128
	speed: 0.0133s/iter; left time: 69.9935s
	iters: 1000, epoch: 3 | loss: 0.3991048
	speed: 0.0119s/iter; left time: 61.5642s
Updating learning rate to 9.72558354e-05
Validation loss decreased (0.3739 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 12.33622431755066
Epoch: 3, Steps: 1027 | Train Loss: 0.4690369 Vali Loss: 0.3638989 Best vali loss: 0.3638989

best validation loss 0.36389889392730995

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011940536002, 'e_layers': 4, 'learning_rate': 7.41197855e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7166497
	speed: 0.0275s/iter; left time: 25.6530s
Updating learning rate to 7.129876913878843e-05
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 3.0732641220092773
Epoch: 1, Steps: 129 | Train Loss: 0.7166497 Vali Loss: 0.3845352 Best vali loss: 0.3845352
	iters: 100, epoch: 2 | loss: 0.6397780
	speed: 0.0370s/iter; left time: 29.7312s
Updating learning rate to 6.326519422357117e-05
Validation loss decreased (0.3845 --> 0.3707).  Saving model state dict ...
Epoch: 2 cost time: 2.400718927383423
Epoch: 2, Steps: 129 | Train Loss: 0.6397780 Vali Loss: 0.3706702 Best vali loss: 0.3706702
	iters: 100, epoch: 3 | loss: 0.5472376
	speed: 0.0182s/iter; left time: 12.2875s
Updating learning rate to 5.124209971065211e-05
Validation loss decreased (0.3707 --> 0.3658).  Saving model state dict ...
Epoch: 3 cost time: 1.2828171253204346
Epoch: 3, Steps: 129 | Train Loss: 0.5472376 Vali Loss: 0.3658446 Best vali loss: 0.3658446

best validation loss 0.3658446165105449

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5687875
	speed: 0.0252s/iter; left time: 23.5098s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 2.430532693862915
Epoch: 1, Steps: 129 | Train Loss: 0.5687875 Vali Loss: 0.3696939 Best vali loss: 0.3696939
	iters: 100, epoch: 2 | loss: 0.4671884
	speed: 0.0208s/iter; left time: 16.7230s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.3697 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 2.2343552112579346
Epoch: 2, Steps: 129 | Train Loss: 0.4671884 Vali Loss: 0.3629822 Best vali loss: 0.3629822
	iters: 100, epoch: 3 | loss: 0.7143908
	speed: 0.0337s/iter; left time: 22.7754s
Updating learning rate to 0.000178512795825
Validation loss decreased (0.3630 --> 0.3574).  Saving model state dict ...
Epoch: 3 cost time: 2.530787706375122
Epoch: 3, Steps: 129 | Train Loss: 0.7143908 Vali Loss: 0.3574249 Best vali loss: 0.3574249

best validation loss 0.3574249305636101

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4011667
	speed: 0.0237s/iter; left time: 12.9133s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 2.536939859390259
Epoch: 4, Steps: 129 | Train Loss: 0.4011667 Vali Loss: 0.3582606 Best vali loss: 0.3574249
	iters: 100, epoch: 5 | loss: 0.4201786
	speed: 0.0298s/iter; left time: 12.4114s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 1.5376543998718262
Epoch: 5, Steps: 129 | Train Loss: 0.4201786 Vali Loss: 0.3580134 Best vali loss: 0.3574249
	iters: 100, epoch: 6 | loss: 0.6391698
	speed: 0.0246s/iter; left time: 7.0946s
Updating learning rate to 2.2314099478125e-05
Validation loss decreased (0.3574 --> 0.3572).  Saving model state dict ...
Epoch: 6 cost time: 2.111900806427002
Epoch: 6, Steps: 129 | Train Loss: 0.6391698 Vali Loss: 0.3572240 Best vali loss: 0.3572240
	iters: 100, epoch: 7 | loss: 0.8032660
	speed: 0.0270s/iter; left time: 4.2975s
Updating learning rate to 1.11570497390625e-05
Validation loss decreased (0.3572 --> 0.3567).  Saving model state dict ...
Epoch: 7 cost time: 2.0472962856292725
Epoch: 7, Steps: 129 | Train Loss: 0.8032660 Vali Loss: 0.3566757 Best vali loss: 0.3566757
	iters: 100, epoch: 8 | loss: 0.6126063
	speed: 0.0305s/iter; left time: 0.9135s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 2.1781868934631348
Epoch: 8, Steps: 129 | Train Loss: 0.6126063 Vali Loss: 0.3578779 Best vali loss: 0.3566757

best validation loss 0.3566757336698019

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0086816738717, 'e_layers': 1, 'learning_rate': 0.00271128889, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6589369
	speed: 0.0176s/iter; left time: 34.5143s
	iters: 200, epoch: 1 | loss: 0.9738088
	speed: 0.0103s/iter; left time: 19.0526s
Updating learning rate to 0.002608096601098123
Validation loss decreased (inf --> 0.3705).  Saving model state dict ...
Epoch: 1 cost time: 3.067856550216675
Epoch: 1, Steps: 257 | Train Loss: 0.8163728 Vali Loss: 0.3704778 Best vali loss: 0.3704778
	iters: 100, epoch: 2 | loss: 0.8576069
	speed: 0.0224s/iter; left time: 38.1259s
	iters: 200, epoch: 2 | loss: 0.7302930
	speed: 0.0053s/iter; left time: 8.5294s
Updating learning rate to 0.0023142298249373737
Validation loss decreased (0.3705 --> 0.3680).  Saving model state dict ...
Epoch: 2 cost time: 1.492264986038208
Epoch: 2, Steps: 257 | Train Loss: 0.7939500 Vali Loss: 0.3679756 Best vali loss: 0.3679756
	iters: 100, epoch: 3 | loss: 0.6600983
	speed: 0.0120s/iter; left time: 17.3622s
	iters: 200, epoch: 3 | loss: 0.5313209
	speed: 0.0062s/iter; left time: 8.2676s
Updating learning rate to 0.0018744271142792672
Epoch: 3 cost time: 1.4903738498687744
Epoch: 3, Steps: 257 | Train Loss: 0.5957096 Vali Loss: 0.3812615 Best vali loss: 0.3679756
	iters: 100, epoch: 4 | loss: 0.7897571
	speed: 0.0136s/iter; left time: 16.1576s
	iters: 200, epoch: 4 | loss: 0.6809571
	speed: 0.0078s/iter; left time: 8.4238s
Updating learning rate to 0.001355644445
Epoch: 4 cost time: 1.9811248779296875
Epoch: 4, Steps: 257 | Train Loss: 0.7353571 Vali Loss: 0.3723006 Best vali loss: 0.3679756
	iters: 100, epoch: 5 | loss: 0.4150935
	speed: 0.0164s/iter; left time: 15.2140s
	iters: 200, epoch: 5 | loss: 0.5936966
	speed: 0.0058s/iter; left time: 4.7676s
Updating learning rate to 0.0008368617757207329
Epoch: 5 cost time: 1.5321152210235596
Epoch: 5, Steps: 257 | Train Loss: 0.5043950 Vali Loss: 0.3886171 Best vali loss: 0.3679756
	iters: 100, epoch: 6 | loss: 0.5548733
	speed: 0.0135s/iter; left time: 9.0954s
	iters: 200, epoch: 6 | loss: 0.3954033
	speed: 0.0055s/iter; left time: 3.1430s
Updating learning rate to 0.0003970590650626264
Epoch: 6 cost time: 1.5385689735412598
Epoch: 6, Steps: 257 | Train Loss: 0.4751383 Vali Loss: 0.3929032 Best vali loss: 0.3679756
	iters: 100, epoch: 7 | loss: 0.4119152
	speed: 0.0142s/iter; left time: 5.8942s
	iters: 200, epoch: 7 | loss: 0.5586107
	speed: 0.0055s/iter; left time: 1.7304s
Updating learning rate to 0.00010319228890187723
Epoch: 7 cost time: 1.5346693992614746
Epoch: 7, Steps: 257 | Train Loss: 0.4852629 Vali Loss: 0.3886662 Best vali loss: 0.3679756
	iters: 100, epoch: 8 | loss: 0.5452346
	speed: 0.0138s/iter; left time: 2.1837s
	iters: 200, epoch: 8 | loss: 0.6468355
	speed: 0.0062s/iter; left time: 0.3592s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.584578514099121
Epoch: 8, Steps: 257 | Train Loss: 0.5960351 Vali Loss: 0.3928271 Best vali loss: 0.3679756

best validation loss 0.3679755775891025

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0103941528642, 'e_layers': 1, 'learning_rate': 5.42209019e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7920051
	speed: 0.0153s/iter; left time: 29.9899s
	iters: 200, epoch: 1 | loss: 0.8482391
	speed: 0.0086s/iter; left time: 15.9751s
Updating learning rate to 5.215724169985617e-05
Validation loss decreased (inf --> 0.4294).  Saving model state dict ...
Epoch: 1 cost time: 2.5980288982391357
Epoch: 1, Steps: 257 | Train Loss: 0.8201221 Vali Loss: 0.4294076 Best vali loss: 0.4294076
	iters: 100, epoch: 2 | loss: 0.3773033
	speed: 0.0249s/iter; left time: 42.3199s
	iters: 200, epoch: 2 | loss: 1.0111617
	speed: 0.0109s/iter; left time: 17.4764s
Updating learning rate to 4.628043465777028e-05
Validation loss decreased (0.4294 --> 0.4143).  Saving model state dict ...
Epoch: 2 cost time: 2.7763571739196777
Epoch: 2, Steps: 257 | Train Loss: 0.6942325 Vali Loss: 0.4143009 Best vali loss: 0.4143009
	iters: 100, epoch: 3 | loss: 0.4815148
	speed: 0.0257s/iter; left time: 37.0208s
	iters: 200, epoch: 3 | loss: 0.6718035
	speed: 0.0100s/iter; left time: 13.3793s
Updating learning rate to 3.7485171372511415e-05
Validation loss decreased (0.4143 --> 0.4043).  Saving model state dict ...
Epoch: 3 cost time: 2.7401814460754395
Epoch: 3, Steps: 257 | Train Loss: 0.5766592 Vali Loss: 0.4043030 Best vali loss: 0.4043030
	iters: 100, epoch: 4 | loss: 0.4309901
	speed: 0.0243s/iter; left time: 28.7679s
	iters: 200, epoch: 4 | loss: 0.7124894
	speed: 0.0063s/iter; left time: 6.7913s
Updating learning rate to 2.711045095e-05
Validation loss decreased (0.4043 --> 0.3977).  Saving model state dict ...
Epoch: 4 cost time: 1.9562804698944092
Epoch: 4, Steps: 257 | Train Loss: 0.5717397 Vali Loss: 0.3976712 Best vali loss: 0.3976712
	iters: 100, epoch: 5 | loss: 0.6505513
	speed: 0.0394s/iter; left time: 36.5787s
	iters: 200, epoch: 5 | loss: 1.3115695
	speed: 0.0137s/iter; left time: 11.3562s
Updating learning rate to 1.6735730527488594e-05
Validation loss decreased (0.3977 --> 0.3939).  Saving model state dict ...
Epoch: 5 cost time: 3.3433752059936523
Epoch: 5, Steps: 257 | Train Loss: 0.9810604 Vali Loss: 0.3938540 Best vali loss: 0.3938540
	iters: 100, epoch: 6 | loss: 0.6616820
	speed: 0.0216s/iter; left time: 14.5101s
	iters: 200, epoch: 6 | loss: 0.3975942
	speed: 0.0127s/iter; left time: 7.2414s
Updating learning rate to 7.940467242229723e-06
Validation loss decreased (0.3939 --> 0.3918).  Saving model state dict ...
Epoch: 6 cost time: 3.4346132278442383
Epoch: 6, Steps: 257 | Train Loss: 0.5296381 Vali Loss: 0.3917719 Best vali loss: 0.3917719
	iters: 100, epoch: 7 | loss: 0.9227091
	speed: 0.0312s/iter; left time: 12.9626s
	iters: 200, epoch: 7 | loss: 0.6411985
	speed: 0.0090s/iter; left time: 2.8280s
Updating learning rate to 2.0636602001438307e-06
Validation loss decreased (0.3918 --> 0.3908).  Saving model state dict ...
Epoch: 7 cost time: 2.6506147384643555
Epoch: 7, Steps: 257 | Train Loss: 0.7819538 Vali Loss: 0.3908192 Best vali loss: 0.3908192
	iters: 100, epoch: 8 | loss: 0.6800209
	speed: 0.0236s/iter; left time: 3.7294s
	iters: 200, epoch: 8 | loss: 0.7883454
	speed: 0.0059s/iter; left time: 0.3434s
Updating learning rate to 0.0
Validation loss decreased (0.3908 --> 0.3906).  Saving model state dict ...
Epoch: 8 cost time: 2.1946301460266113
Epoch: 8, Steps: 257 | Train Loss: 0.7341831 Vali Loss: 0.3905776 Best vali loss: 0.3905776

best validation loss 0.39057759339308223

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0015946653779, 'e_layers': 2, 'learning_rate': 5.11411667e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.919472194143889e-05
Validation loss decreased (inf --> 0.4196).  Saving model state dict ...
Epoch: 1 cost time: 0.9293050765991211
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4196379 Best vali loss: 0.4196379
Updating learning rate to 4.3651716235680824e-05
Validation loss decreased (0.4196 --> 0.4013).  Saving model state dict ...
Epoch: 2 cost time: 0.8486266136169434
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4013379 Best vali loss: 0.4013379
Updating learning rate to 3.535602195395562e-05
Validation loss decreased (0.4013 --> 0.3900).  Saving model state dict ...
Epoch: 3 cost time: 0.6273410320281982
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3900451 Best vali loss: 0.3900451

best validation loss 0.3900450680017003

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.010223158032, 'e_layers': 2, 'learning_rate': 0.0002911151304, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6274812
	speed: 0.0154s/iter; left time: 14.3823s
Updating learning rate to 0.0002911151304
Validation loss decreased (inf --> 0.3970).  Saving model state dict ...
Epoch: 1 cost time: 1.4837839603424072
Epoch: 1, Steps: 129 | Train Loss: 0.6274812 Vali Loss: 0.3970436 Best vali loss: 0.3970436
	iters: 100, epoch: 2 | loss: 0.7268646
	speed: 0.0144s/iter; left time: 11.5912s
Updating learning rate to 0.0001455575652
Validation loss decreased (0.3970 --> 0.3789).  Saving model state dict ...
Epoch: 2 cost time: 1.3522119522094727
Epoch: 2, Steps: 129 | Train Loss: 0.7268646 Vali Loss: 0.3788976 Best vali loss: 0.3788976
	iters: 100, epoch: 3 | loss: 0.6821316
	speed: 0.0161s/iter; left time: 10.8822s
Updating learning rate to 7.27787826e-05
Validation loss decreased (0.3789 --> 0.3739).  Saving model state dict ...
Epoch: 3 cost time: 1.1380655765533447
Epoch: 3, Steps: 129 | Train Loss: 0.6821316 Vali Loss: 0.3739446 Best vali loss: 0.3739446

best validation loss 0.3739445996542108

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001057774261, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7274354
	speed: 0.0163s/iter; left time: 15.2111s
Updating learning rate to 0.00010175151253775759
Validation loss decreased (inf --> 0.3801).  Saving model state dict ...
Epoch: 1 cost time: 1.5875282287597656
Epoch: 1, Steps: 129 | Train Loss: 0.7274354 Vali Loss: 0.3801216 Best vali loss: 0.3801216
	iters: 100, epoch: 2 | loss: 0.6876509
	speed: 0.0183s/iter; left time: 14.7180s
Updating learning rate to 9.028668069588445e-05
Validation loss decreased (0.3801 --> 0.3674).  Saving model state dict ...
Epoch: 2 cost time: 1.516101360321045
Epoch: 2, Steps: 129 | Train Loss: 0.6876509 Vali Loss: 0.3674065 Best vali loss: 0.3674065
	iters: 100, epoch: 3 | loss: 0.6525135
	speed: 0.0150s/iter; left time: 10.1011s
Updating learning rate to 7.312834729334631e-05
Validation loss decreased (0.3674 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 1.2264025211334229
Epoch: 3, Steps: 129 | Train Loss: 0.6525135 Vali Loss: 0.3638526 Best vali loss: 0.3638526

best validation loss 0.3638525889875378

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001057774261, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6278043
	speed: 0.0170s/iter; left time: 9.2548s
Updating learning rate to 5.288871305e-05
Epoch: 4 cost time: 1.793691635131836
Epoch: 4, Steps: 129 | Train Loss: 0.6278043 Vali Loss: 0.3638896 Best vali loss: 0.3638526
	iters: 100, epoch: 5 | loss: 0.6589710
	speed: 0.0176s/iter; left time: 7.3594s
Updating learning rate to 3.2649078806653686e-05
Validation loss decreased (0.3639 --> 0.3638).  Saving model state dict ...
Epoch: 5 cost time: 1.2304794788360596
Epoch: 5, Steps: 129 | Train Loss: 0.6589710 Vali Loss: 0.3637815 Best vali loss: 0.3637815
	iters: 100, epoch: 6 | loss: 0.6360306
	speed: 0.0201s/iter; left time: 5.7813s
Updating learning rate to 1.5490745404115554e-05
Validation loss decreased (0.3638 --> 0.3625).  Saving model state dict ...
Epoch: 6 cost time: 1.8203673362731934
Epoch: 6, Steps: 129 | Train Loss: 0.6360306 Vali Loss: 0.3624641 Best vali loss: 0.3624641
	iters: 100, epoch: 7 | loss: 0.6036762
	speed: 0.0281s/iter; left time: 4.4704s
Updating learning rate to 4.0259135622424095e-06
Epoch: 7 cost time: 2.1335396766662598
Epoch: 7, Steps: 129 | Train Loss: 0.6036762 Vali Loss: 0.3630962 Best vali loss: 0.3624641
	iters: 100, epoch: 8 | loss: 0.6398607
	speed: 0.0299s/iter; left time: 0.8966s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6277594566345215
Epoch: 8, Steps: 129 | Train Loss: 0.6398607 Vali Loss: 0.3627912 Best vali loss: 0.3624641

best validation loss 0.36246408636302985

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042447183801, 'e_layers': 3, 'learning_rate': 0.0001220593649, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5604938
	speed: 0.0220s/iter; left time: 42.9755s
	iters: 200, epoch: 1 | loss: 0.8818625
	speed: 0.0147s/iter; left time: 27.2082s
Updating learning rate to 0.0001220593649
Validation loss decreased (inf --> 0.3881).  Saving model state dict ...
Epoch: 1 cost time: 4.152612924575806
Epoch: 1, Steps: 257 | Train Loss: 0.7211781 Vali Loss: 0.3881023 Best vali loss: 0.3881023
	iters: 100, epoch: 2 | loss: 0.6679507
	speed: 0.0351s/iter; left time: 59.6628s
	iters: 200, epoch: 2 | loss: 0.7584330
	speed: 0.0149s/iter; left time: 23.8800s
Updating learning rate to 6.102968245e-05
Validation loss decreased (0.3881 --> 0.3704).  Saving model state dict ...
Epoch: 2 cost time: 3.933262825012207
Epoch: 2, Steps: 257 | Train Loss: 0.7131919 Vali Loss: 0.3703715 Best vali loss: 0.3703715
	iters: 100, epoch: 3 | loss: 0.5577469
	speed: 0.0405s/iter; left time: 58.3872s
	iters: 200, epoch: 3 | loss: 0.6069183
	speed: 0.0137s/iter; left time: 18.4139s
Updating learning rate to 3.0514841225e-05
Validation loss decreased (0.3704 --> 0.3687).  Saving model state dict ...
Epoch: 3 cost time: 3.7984671592712402
Epoch: 3, Steps: 257 | Train Loss: 0.5823326 Vali Loss: 0.3686918 Best vali loss: 0.3686918
	iters: 100, epoch: 4 | loss: 0.4324169
	speed: 0.0350s/iter; left time: 41.4667s
	iters: 200, epoch: 4 | loss: 0.7709729
	speed: 0.0138s/iter; left time: 14.9887s
Updating learning rate to 1.52574206125e-05
Validation loss decreased (0.3687 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 3.2424559593200684
Epoch: 4, Steps: 257 | Train Loss: 0.6016949 Vali Loss: 0.3678057 Best vali loss: 0.3678057
	iters: 100, epoch: 5 | loss: 0.8217529
	speed: 0.0196s/iter; left time: 18.2205s
	iters: 200, epoch: 5 | loss: 0.7874175
	speed: 0.0158s/iter; left time: 13.0726s
Updating learning rate to 7.62871030625e-06
Epoch: 5 cost time: 3.7411088943481445
Epoch: 5, Steps: 257 | Train Loss: 0.8045852 Vali Loss: 0.3681427 Best vali loss: 0.3678057
	iters: 100, epoch: 6 | loss: 0.7356325
	speed: 0.0399s/iter; left time: 26.8415s
	iters: 200, epoch: 6 | loss: 0.8317302
	speed: 0.0162s/iter; left time: 9.2521s
Updating learning rate to 3.814355153125e-06
Epoch: 6 cost time: 4.341480731964111
Epoch: 6, Steps: 257 | Train Loss: 0.7836814 Vali Loss: 0.3681127 Best vali loss: 0.3678057
	iters: 100, epoch: 7 | loss: 1.0103807
	speed: 0.0330s/iter; left time: 13.7070s
	iters: 200, epoch: 7 | loss: 0.5002202
	speed: 0.0099s/iter; left time: 3.1075s
Updating learning rate to 1.9071775765625e-06
Epoch: 7 cost time: 2.6104896068573
Epoch: 7, Steps: 257 | Train Loss: 0.7553005 Vali Loss: 0.3680831 Best vali loss: 0.3678057
	iters: 100, epoch: 8 | loss: 0.3943990
	speed: 0.0212s/iter; left time: 3.3433s
	iters: 200, epoch: 8 | loss: 1.0253708
	speed: 0.0105s/iter; left time: 0.6100s
Updating learning rate to 9.5358878828125e-07
Epoch: 8 cost time: 2.7150208950042725
Epoch: 8, Steps: 257 | Train Loss: 0.7098849 Vali Loss: 0.3680725 Best vali loss: 0.3678057

best validation loss 0.3678056857206498

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044408584486, 'e_layers': 1, 'learning_rate': 0.000472789623, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7913153
	speed: 0.0152s/iter; left time: 14.2236s
Updating learning rate to 0.000472789623
Validation loss decreased (inf --> 0.3642).  Saving model state dict ...
Epoch: 1 cost time: 1.483412504196167
Epoch: 1, Steps: 129 | Train Loss: 0.7913153 Vali Loss: 0.3642014 Best vali loss: 0.3642014
	iters: 100, epoch: 2 | loss: 0.4836618
	speed: 0.0154s/iter; left time: 12.3910s
Updating learning rate to 0.0002363948115
Epoch: 2 cost time: 1.0643360614776611
Epoch: 2, Steps: 129 | Train Loss: 0.4836618 Vali Loss: 0.3694659 Best vali loss: 0.3642014
	iters: 100, epoch: 3 | loss: 0.5414023
	speed: 0.0145s/iter; left time: 9.7680s
Updating learning rate to 0.00011819740575
Epoch: 3 cost time: 1.1537818908691406
Epoch: 3, Steps: 129 | Train Loss: 0.5414023 Vali Loss: 0.3703919 Best vali loss: 0.3642014
	iters: 100, epoch: 4 | loss: 0.5316977
	speed: 0.0086s/iter; left time: 4.6913s
Updating learning rate to 5.9098702875e-05
Epoch: 4 cost time: 0.5113615989685059
Epoch: 4, Steps: 129 | Train Loss: 0.5316977 Vali Loss: 0.3858124 Best vali loss: 0.3642014
	iters: 100, epoch: 5 | loss: 0.4196856
	speed: 0.0072s/iter; left time: 3.0015s
Updating learning rate to 2.95493514375e-05
Epoch: 5 cost time: 0.5427837371826172
Epoch: 5, Steps: 129 | Train Loss: 0.4196856 Vali Loss: 0.3769013 Best vali loss: 0.3642014
	iters: 100, epoch: 6 | loss: 0.4383877
	speed: 0.0074s/iter; left time: 2.1214s
Updating learning rate to 1.477467571875e-05
Epoch: 6 cost time: 0.556236982345581
Epoch: 6, Steps: 129 | Train Loss: 0.4383877 Vali Loss: 0.3840383 Best vali loss: 0.3642014
	iters: 100, epoch: 7 | loss: 0.4156966
	speed: 0.0109s/iter; left time: 1.7267s
Updating learning rate to 7.387337859375e-06
Epoch: 7 cost time: 0.9574260711669922
Epoch: 7, Steps: 129 | Train Loss: 0.4156966 Vali Loss: 0.3847164 Best vali loss: 0.3642014
	iters: 100, epoch: 8 | loss: 0.4390896
	speed: 0.0117s/iter; left time: 0.3517s
Updating learning rate to 3.6936689296875e-06
Epoch: 8 cost time: 0.9275100231170654
Epoch: 8, Steps: 129 | Train Loss: 0.4390896 Vali Loss: 0.3829627 Best vali loss: 0.3642014

best validation loss 0.36420144313445024

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0119807838687, 'e_layers': 3, 'learning_rate': 0.0004563359081, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5939523
	speed: 0.0178s/iter; left time: 71.3029s
	iters: 200, epoch: 1 | loss: 1.1635842
	speed: 0.0108s/iter; left time: 42.3461s
	iters: 300, epoch: 1 | loss: 0.3165322
	speed: 0.0105s/iter; left time: 39.9847s
	iters: 400, epoch: 1 | loss: 0.2929045
	speed: 0.0077s/iter; left time: 28.4695s
	iters: 500, epoch: 1 | loss: 0.9211326
	speed: 0.0097s/iter; left time: 35.1864s
Updating learning rate to 0.00043896765677177077
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 5.463379144668579
Epoch: 1, Steps: 514 | Train Loss: 0.6576212 Vali Loss: 0.3657314 Best vali loss: 0.3657314
	iters: 100, epoch: 2 | loss: 0.9067441
	speed: 0.0284s/iter; left time: 99.3493s
	iters: 200, epoch: 2 | loss: 0.5547755
	speed: 0.0087s/iter; left time: 29.6239s
	iters: 300, epoch: 2 | loss: 0.3249772
	speed: 0.0108s/iter; left time: 35.6425s
	iters: 400, epoch: 2 | loss: 0.3257119
	speed: 0.0115s/iter; left time: 36.7754s
	iters: 500, epoch: 2 | loss: 0.4094774
	speed: 0.0089s/iter; left time: 27.5066s
Updating learning rate to 0.0003895070616082156
Epoch: 2 cost time: 5.01245903968811
Epoch: 2, Steps: 514 | Train Loss: 0.5043372 Vali Loss: 0.3686280 Best vali loss: 0.3657314
	iters: 100, epoch: 3 | loss: 0.6294867
	speed: 0.0299s/iter; left time: 89.2466s
	iters: 200, epoch: 3 | loss: 1.8113239
	speed: 0.0116s/iter; left time: 33.5953s
	iters: 300, epoch: 3 | loss: 0.6273367
	speed: 0.0118s/iter; left time: 32.9242s
	iters: 400, epoch: 3 | loss: 0.5629458
	speed: 0.0124s/iter; left time: 33.3193s
	iters: 500, epoch: 3 | loss: 0.4074387
	speed: 0.0113s/iter; left time: 29.3116s
Updating learning rate to 0.0003154840498615741
Epoch: 3 cost time: 6.065938949584961
Epoch: 3, Steps: 514 | Train Loss: 0.8077064 Vali Loss: 0.3750818 Best vali loss: 0.3657314

best validation loss 0.365731442700669

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4010867
	speed: 0.0157s/iter; left time: 127.0995s
	iters: 200, epoch: 1 | loss: 0.8429462
	speed: 0.0069s/iter; left time: 55.3631s
	iters: 300, epoch: 1 | loss: 0.5032553
	speed: 0.0076s/iter; left time: 59.9072s
	iters: 400, epoch: 1 | loss: 0.2677594
	speed: 0.0089s/iter; left time: 69.6740s
	iters: 500, epoch: 1 | loss: 0.3441316
	speed: 0.0092s/iter; left time: 70.6999s
	iters: 600, epoch: 1 | loss: 0.7070072
	speed: 0.0087s/iter; left time: 66.0008s
	iters: 700, epoch: 1 | loss: 0.5814087
	speed: 0.0091s/iter; left time: 68.4725s
	iters: 800, epoch: 1 | loss: 1.0674077
	speed: 0.0077s/iter; left time: 56.9628s
	iters: 900, epoch: 1 | loss: 0.3014495
	speed: 0.0073s/iter; left time: 53.7489s
	iters: 1000, epoch: 1 | loss: 0.4578230
	speed: 0.0072s/iter; left time: 51.8988s
Updating learning rate to 9.547589994094374e-05
Validation loss decreased (inf --> 0.3844).  Saving model state dict ...
Epoch: 1 cost time: 8.744598388671875
Epoch: 1, Steps: 1027 | Train Loss: 0.5474275 Vali Loss: 0.3843937 Best vali loss: 0.3843937
	iters: 100, epoch: 2 | loss: 1.2455423
	speed: 0.0333s/iter; left time: 235.8085s
	iters: 200, epoch: 2 | loss: 0.5056686
	speed: 0.0094s/iter; left time: 65.8317s
	iters: 300, epoch: 2 | loss: 0.4245858
	speed: 0.0108s/iter; left time: 74.5610s
	iters: 400, epoch: 2 | loss: 0.2285097
	speed: 0.0107s/iter; left time: 72.6129s
	iters: 500, epoch: 2 | loss: 0.2579384
	speed: 0.0097s/iter; left time: 64.5736s
	iters: 600, epoch: 2 | loss: 0.4863743
	speed: 0.0090s/iter; left time: 59.4416s
	iters: 700, epoch: 2 | loss: 0.4532696
	speed: 0.0086s/iter; left time: 56.0752s
	iters: 800, epoch: 2 | loss: 0.2028350
	speed: 0.0072s/iter; left time: 45.6930s
	iters: 900, epoch: 2 | loss: 1.1019257
	speed: 0.0072s/iter; left time: 45.3794s
	iters: 1000, epoch: 2 | loss: 0.3620968
	speed: 0.0105s/iter; left time: 65.1511s
Updating learning rate to 8.47181715251795e-05
Validation loss decreased (0.3844 --> 0.3715).  Saving model state dict ...
Epoch: 2 cost time: 9.665736675262451
Epoch: 2, Steps: 1027 | Train Loss: 0.5268746 Vali Loss: 0.3714928 Best vali loss: 0.3714928
	iters: 100, epoch: 3 | loss: 0.4364078
	speed: 0.0326s/iter; left time: 197.6653s
	iters: 200, epoch: 3 | loss: 1.4768606
	speed: 0.0113s/iter; left time: 67.1811s
	iters: 300, epoch: 3 | loss: 0.5228292
	speed: 0.0094s/iter; left time: 55.1931s
	iters: 400, epoch: 3 | loss: 0.6521445
	speed: 0.0091s/iter; left time: 52.2989s
	iters: 500, epoch: 3 | loss: 0.3422905
	speed: 0.0088s/iter; left time: 49.8872s
	iters: 600, epoch: 3 | loss: 0.2758752
	speed: 0.0079s/iter; left time: 44.0152s
	iters: 700, epoch: 3 | loss: 0.3832306
	speed: 0.0101s/iter; left time: 54.9415s
	iters: 800, epoch: 3 | loss: 0.2014223
	speed: 0.0111s/iter; left time: 59.6528s
	iters: 900, epoch: 3 | loss: 0.3063796
	speed: 0.0088s/iter; left time: 46.5103s
	iters: 1000, epoch: 3 | loss: 0.3419995
	speed: 0.0111s/iter; left time: 57.5457s
Updating learning rate to 6.861809318495647e-05
Validation loss decreased (0.3715 --> 0.3669).  Saving model state dict ...
Epoch: 3 cost time: 10.207751989364624
Epoch: 3, Steps: 1027 | Train Loss: 0.4939440 Vali Loss: 0.3668807 Best vali loss: 0.3668807

best validation loss 0.3668807342150825

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014152615275, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.5502150058746338
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3654696 Best vali loss: 0.3654696
Updating learning rate to 0.0002257411363
Epoch: 2 cost time: 1.2875661849975586
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3658100 Best vali loss: 0.3654696
Updating learning rate to 0.00011287056815
Validation loss decreased (0.3655 --> 0.3649).  Saving model state dict ...
Epoch: 3 cost time: 1.0353868007659912
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3649396 Best vali loss: 0.3649396

best validation loss 0.36493956891633206

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014152615275, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.6435284075e-05
Validation loss decreased (0.3649 --> 0.3646).  Saving model state dict ...
Epoch: 4 cost time: 1.5862913131713867
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3646481 Best vali loss: 0.3646481
Updating learning rate to 2.82176420375e-05
Epoch: 5 cost time: 1.649726152420044
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3671681 Best vali loss: 0.3646481
Updating learning rate to 1.410882101875e-05
Epoch: 6 cost time: 1.469421148300171
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3677211 Best vali loss: 0.3646481
Updating learning rate to 7.054410509375e-06
Epoch: 7 cost time: 1.2408676147460938
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3679009 Best vali loss: 0.3646481
Updating learning rate to 3.5272052546875e-06
Epoch: 8 cost time: 1.3533704280853271
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3686306 Best vali loss: 0.3646481

best validation loss 0.3646480716398985

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0015757048477, 'e_layers': 3, 'learning_rate': 0.0011631691937, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6430489
	speed: 0.0283s/iter; left time: 26.3875s
Updating learning rate to 0.0011631691937
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 2.9619624614715576
Epoch: 1, Steps: 129 | Train Loss: 0.6430489 Vali Loss: 0.3674870 Best vali loss: 0.3674870
	iters: 100, epoch: 2 | loss: 0.7914803
	speed: 0.0315s/iter; left time: 25.3037s
Updating learning rate to 0.00058158459685
Epoch: 2 cost time: 2.000145196914673
Epoch: 2, Steps: 129 | Train Loss: 0.7914803 Vali Loss: 0.3693587 Best vali loss: 0.3674870
	iters: 100, epoch: 3 | loss: 0.6092583
	speed: 0.0140s/iter; left time: 9.4304s
Updating learning rate to 0.000290792298425
Epoch: 3 cost time: 1.4347307682037354
Epoch: 3, Steps: 129 | Train Loss: 0.6092583 Vali Loss: 0.3706630 Best vali loss: 0.3674870
	iters: 100, epoch: 4 | loss: 0.7888743
	speed: 0.0323s/iter; left time: 17.6295s
Updating learning rate to 0.0001453961492125
Epoch: 4 cost time: 2.6382694244384766
Epoch: 4, Steps: 129 | Train Loss: 0.7888743 Vali Loss: 0.3694342 Best vali loss: 0.3674870
	iters: 100, epoch: 5 | loss: 0.7058882
	speed: 0.0296s/iter; left time: 12.3232s
Updating learning rate to 7.269807460625e-05
Epoch: 5 cost time: 2.415541887283325
Epoch: 5, Steps: 129 | Train Loss: 0.7058882 Vali Loss: 0.3682402 Best vali loss: 0.3674870
	iters: 100, epoch: 6 | loss: 0.5048929
	speed: 0.0366s/iter; left time: 10.5317s
Updating learning rate to 3.6349037303125e-05
Epoch: 6 cost time: 2.8988566398620605
Epoch: 6, Steps: 129 | Train Loss: 0.5048929 Vali Loss: 0.3686029 Best vali loss: 0.3674870
	iters: 100, epoch: 7 | loss: 0.5318195
	speed: 0.0340s/iter; left time: 5.4035s
Updating learning rate to 1.81745186515625e-05
Epoch: 7 cost time: 2.4128196239471436
Epoch: 7, Steps: 129 | Train Loss: 0.5318195 Vali Loss: 0.3681036 Best vali loss: 0.3674870
	iters: 100, epoch: 8 | loss: 0.6389138
	speed: 0.0298s/iter; left time: 0.8943s
Updating learning rate to 9.08725932578125e-06
Epoch: 8 cost time: 2.476731061935425
Epoch: 8, Steps: 129 | Train Loss: 0.6389138 Vali Loss: 0.3682604 Best vali loss: 0.3674870

best validation loss 0.36748698915854416

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0069097083138, 'e_layers': 1, 'learning_rate': 0.0025717436101, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5671216
	speed: 0.0134s/iter; left time: 26.1662s
	iters: 200, epoch: 1 | loss: 0.7234750
	speed: 0.0075s/iter; left time: 13.8561s
Updating learning rate to 0.0025717436101
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 2.2071750164031982
Epoch: 1, Steps: 257 | Train Loss: 0.6452983 Vali Loss: 0.3799538 Best vali loss: 0.3799538
	iters: 100, epoch: 2 | loss: 0.8988762
	speed: 0.0149s/iter; left time: 25.2891s
	iters: 200, epoch: 2 | loss: 0.3535955
	speed: 0.0068s/iter; left time: 10.9594s
Updating learning rate to 0.00128587180505
Epoch: 2 cost time: 1.755854606628418
Epoch: 2, Steps: 257 | Train Loss: 0.6262359 Vali Loss: 0.3917704 Best vali loss: 0.3799538
	iters: 100, epoch: 3 | loss: 0.5977511
	speed: 0.0144s/iter; left time: 20.7183s
	iters: 200, epoch: 3 | loss: 0.6119125
	speed: 0.0066s/iter; left time: 8.8008s
Updating learning rate to 0.000642935902525
Epoch: 3 cost time: 1.830153465270996
Epoch: 3, Steps: 257 | Train Loss: 0.6048318 Vali Loss: 0.4046588 Best vali loss: 0.3799538
	iters: 100, epoch: 4 | loss: 0.4880970
	speed: 0.0158s/iter; left time: 18.7233s
	iters: 200, epoch: 4 | loss: 0.6285782
	speed: 0.0064s/iter; left time: 6.9059s
Updating learning rate to 0.0003214679512625
Epoch: 4 cost time: 1.659940481185913
Epoch: 4, Steps: 257 | Train Loss: 0.5583376 Vali Loss: 0.4625145 Best vali loss: 0.3799538
	iters: 100, epoch: 5 | loss: 0.4375582
	speed: 0.0146s/iter; left time: 13.5214s
	iters: 200, epoch: 5 | loss: 0.5709506
	speed: 0.0065s/iter; left time: 5.4006s
Updating learning rate to 0.00016073397563125
Epoch: 5 cost time: 1.6822984218597412
Epoch: 5, Steps: 257 | Train Loss: 0.5042544 Vali Loss: 0.4579739 Best vali loss: 0.3799538
	iters: 100, epoch: 6 | loss: 0.5749559
	speed: 0.0138s/iter; left time: 9.2971s
	iters: 200, epoch: 6 | loss: 0.5784985
	speed: 0.0088s/iter; left time: 5.0472s
Updating learning rate to 8.0366987815625e-05
Epoch: 6 cost time: 1.8802649974822998
Epoch: 6, Steps: 257 | Train Loss: 0.5767272 Vali Loss: 0.4606813 Best vali loss: 0.3799538
	iters: 100, epoch: 7 | loss: 0.4881041
	speed: 0.0149s/iter; left time: 6.1927s
	iters: 200, epoch: 7 | loss: 0.5829173
	speed: 0.0069s/iter; left time: 2.1794s
Updating learning rate to 4.01834939078125e-05
Epoch: 7 cost time: 1.7368533611297607
Epoch: 7, Steps: 257 | Train Loss: 0.5355107 Vali Loss: 0.4717035 Best vali loss: 0.3799538
	iters: 100, epoch: 8 | loss: 0.5649474
	speed: 0.0152s/iter; left time: 2.4062s
	iters: 200, epoch: 8 | loss: 0.4829829
	speed: 0.0064s/iter; left time: 0.3711s
Updating learning rate to 2.009174695390625e-05
Epoch: 8 cost time: 1.7289090156555176
Epoch: 8, Steps: 257 | Train Loss: 0.5239651 Vali Loss: 0.4752918 Best vali loss: 0.3799538

best validation loss 0.37995377074056147

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0035464357287, 'e_layers': 2, 'learning_rate': 0.0003036080774, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8559688
	speed: 0.0149s/iter; left time: 29.1991s
	iters: 200, epoch: 1 | loss: 0.6176646
	speed: 0.0084s/iter; left time: 15.6031s
Updating learning rate to 0.0002920526830074813
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 2.613070249557495
Epoch: 1, Steps: 257 | Train Loss: 0.7368167 Vali Loss: 0.3692544 Best vali loss: 0.3692544
	iters: 100, epoch: 2 | loss: 0.8311975
	speed: 0.0197s/iter; left time: 33.4091s
	iters: 200, epoch: 2 | loss: 0.7688318
	speed: 0.0083s/iter; left time: 13.3019s
Updating learning rate to 0.0002591457038762751
Epoch: 2 cost time: 2.190307855606079
Epoch: 2, Steps: 257 | Train Loss: 0.8000146 Vali Loss: 0.3713208 Best vali loss: 0.3692544
	iters: 100, epoch: 3 | loss: 0.8022665
	speed: 0.0180s/iter; left time: 25.9399s
	iters: 200, epoch: 3 | loss: 0.7342458
	speed: 0.0080s/iter; left time: 10.8065s
Updating learning rate to 0.00020989692927659895
Epoch: 3 cost time: 2.3312036991119385
Epoch: 3, Steps: 257 | Train Loss: 0.7682561 Vali Loss: 0.3738645 Best vali loss: 0.3692544

best validation loss 0.36925439278362776

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0059927497786, 'e_layers': 4, 'learning_rate': 0.003057829033, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6003721
	speed: 0.0166s/iter; left time: 66.4757s
	iters: 200, epoch: 1 | loss: 0.4907915
	speed: 0.0098s/iter; left time: 38.3564s
	iters: 300, epoch: 1 | loss: 1.0911157
	speed: 0.0094s/iter; left time: 35.8223s
	iters: 400, epoch: 1 | loss: 1.8129438
	speed: 0.0101s/iter; left time: 37.3288s
	iters: 500, epoch: 1 | loss: 0.5383865
	speed: 0.0082s/iter; left time: 29.5205s
Updating learning rate to 0.003057829033
Validation loss decreased (inf --> 0.4073).  Saving model state dict ...
Epoch: 1 cost time: 5.228362083435059
Epoch: 1, Steps: 514 | Train Loss: 0.9067219 Vali Loss: 0.4073123 Best vali loss: 0.4073123
	iters: 100, epoch: 2 | loss: 1.0027033
	speed: 0.0193s/iter; left time: 67.4599s
	iters: 200, epoch: 2 | loss: 0.5906233
	speed: 0.0093s/iter; left time: 31.5051s
	iters: 300, epoch: 2 | loss: 1.3815039
	speed: 0.0092s/iter; left time: 30.4727s
	iters: 400, epoch: 2 | loss: 0.4096124
	speed: 0.0095s/iter; left time: 30.2541s
	iters: 500, epoch: 2 | loss: 0.7202241
	speed: 0.0096s/iter; left time: 29.6588s
Updating learning rate to 0.0015289145165
Validation loss decreased (0.4073 --> 0.3974).  Saving model state dict ...
Epoch: 2 cost time: 4.842442989349365
Epoch: 2, Steps: 514 | Train Loss: 0.8209334 Vali Loss: 0.3974107 Best vali loss: 0.3974107
	iters: 100, epoch: 3 | loss: 0.6029907
	speed: 0.0196s/iter; left time: 58.6428s
	iters: 200, epoch: 3 | loss: 0.9695393
	speed: 0.0093s/iter; left time: 26.8300s
	iters: 300, epoch: 3 | loss: 0.7019185
	speed: 0.0102s/iter; left time: 28.2806s
	iters: 400, epoch: 3 | loss: 1.3178518
	speed: 0.0110s/iter; left time: 29.5933s
	iters: 500, epoch: 3 | loss: 1.9588739
	speed: 0.0086s/iter; left time: 22.1994s
Updating learning rate to 0.00076445725825
Epoch: 3 cost time: 5.016082525253296
Epoch: 3, Steps: 514 | Train Loss: 1.1102348 Vali Loss: 0.4048522 Best vali loss: 0.3974107

best validation loss 0.39741068499964205

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0030171201133, 'e_layers': 3, 'learning_rate': 0.0001768704453, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6212015
	speed: 0.0190s/iter; left time: 37.1073s
	iters: 200, epoch: 1 | loss: 0.3391296
	speed: 0.0130s/iter; left time: 24.1490s
Updating learning rate to 0.00017013871480941355
Validation loss decreased (inf --> 0.3753).  Saving model state dict ...
Epoch: 1 cost time: 3.6509501934051514
Epoch: 1, Steps: 257 | Train Loss: 0.4801655 Vali Loss: 0.3752810 Best vali loss: 0.3752810
	iters: 100, epoch: 2 | loss: 0.6013899
	speed: 0.0310s/iter; left time: 52.7349s
	iters: 200, epoch: 2 | loss: 0.5072053
	speed: 0.0132s/iter; left time: 21.1788s
Updating learning rate to 0.00015096836828155716
Validation loss decreased (0.3753 --> 0.3582).  Saving model state dict ...
Epoch: 2 cost time: 3.7149055004119873
Epoch: 2, Steps: 257 | Train Loss: 0.5542976 Vali Loss: 0.3582010 Best vali loss: 0.3582010
	iters: 100, epoch: 3 | loss: 0.4643952
	speed: 0.0470s/iter; left time: 67.8588s
	iters: 200, epoch: 3 | loss: 0.4855080
	speed: 0.0112s/iter; left time: 15.0061s
Updating learning rate to 0.00012227791719567294
Epoch: 3 cost time: 3.3511769771575928
Epoch: 3, Steps: 257 | Train Loss: 0.4749516 Vali Loss: 0.3734274 Best vali loss: 0.3582010

best validation loss 0.3582010139650821

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0030171201133, 'e_layers': 3, 'learning_rate': 0.0001768704453, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4981668
	speed: 0.0214s/iter; left time: 25.3220s
	iters: 200, epoch: 4 | loss: 0.3382713
	speed: 0.0129s/iter; left time: 13.9935s
Updating learning rate to 8.843522265e-05
Validation loss decreased (0.3582 --> 0.3540).  Saving model state dict ...
Epoch: 4 cost time: 3.748868942260742
Epoch: 4, Steps: 257 | Train Loss: 0.4182191 Vali Loss: 0.3539648 Best vali loss: 0.3539648
	iters: 100, epoch: 5 | loss: 0.4986089
	speed: 0.0336s/iter; left time: 31.1710s
	iters: 200, epoch: 5 | loss: 0.4504170
	speed: 0.0161s/iter; left time: 13.3465s
Updating learning rate to 5.4592528104327076e-05
Epoch: 5 cost time: 4.088791847229004
Epoch: 5, Steps: 257 | Train Loss: 0.4745129 Vali Loss: 0.3582478 Best vali loss: 0.3539648
	iters: 100, epoch: 6 | loss: 0.3453323
	speed: 0.0393s/iter; left time: 26.3817s
	iters: 200, epoch: 6 | loss: 0.4212736
	speed: 0.0183s/iter; left time: 10.4898s
Updating learning rate to 2.5902077018442846e-05
Epoch: 6 cost time: 3.9588141441345215
Epoch: 6, Steps: 257 | Train Loss: 0.3833030 Vali Loss: 0.3659861 Best vali loss: 0.3539648
	iters: 100, epoch: 7 | loss: 0.5211415
	speed: 0.0407s/iter; left time: 16.8773s
	iters: 200, epoch: 7 | loss: 0.3386823
	speed: 0.0129s/iter; left time: 4.0781s
Updating learning rate to 6.731730490586444e-06
Epoch: 7 cost time: 3.961684465408325
Epoch: 7, Steps: 257 | Train Loss: 0.4299119 Vali Loss: 0.3686766 Best vali loss: 0.3539648
	iters: 100, epoch: 8 | loss: 0.5054399
	speed: 0.0299s/iter; left time: 4.7276s
	iters: 200, epoch: 8 | loss: 0.5407972
	speed: 0.0165s/iter; left time: 0.9589s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.379069566726685
Epoch: 8, Steps: 257 | Train Loss: 0.5231185 Vali Loss: 0.3706248 Best vali loss: 0.3539648

best validation loss 0.3539647839509668

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0030808718104, 'e_layers': 2, 'learning_rate': 0.004541253833, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7469407
	speed: 0.0170s/iter; left time: 15.8509s
Updating learning rate to 0.004368412650623565
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 1.6460883617401123
Epoch: 1, Steps: 129 | Train Loss: 0.7469407 Vali Loss: 0.3736772 Best vali loss: 0.3736772
	iters: 100, epoch: 2 | loss: 0.6833569
	speed: 0.0145s/iter; left time: 11.6498s
Updating learning rate to 0.0038762026067018507
Epoch: 2 cost time: 1.1562659740447998
Epoch: 2, Steps: 129 | Train Loss: 0.6833569 Vali Loss: 0.3762838 Best vali loss: 0.3736772
	iters: 100, epoch: 3 | loss: 0.7790834
	speed: 0.0150s/iter; left time: 10.1248s
Updating learning rate to 0.00313955821852678
Epoch: 3 cost time: 1.2397003173828125
Epoch: 3, Steps: 129 | Train Loss: 0.7790834 Vali Loss: 0.3869387 Best vali loss: 0.3736772
	iters: 100, epoch: 4 | loss: 0.3884088
	speed: 0.0163s/iter; left time: 8.8975s
Updating learning rate to 0.0022706269165
Epoch: 4 cost time: 1.2827303409576416
Epoch: 4, Steps: 129 | Train Loss: 0.3884088 Vali Loss: 0.3873386 Best vali loss: 0.3736772
	iters: 100, epoch: 5 | loss: 0.5124581
	speed: 0.0183s/iter; left time: 7.6350s
Updating learning rate to 0.00140169561447322
Epoch: 5 cost time: 1.4235498905181885
Epoch: 5, Steps: 129 | Train Loss: 0.5124581 Vali Loss: 0.4029365 Best vali loss: 0.3736772
	iters: 100, epoch: 6 | loss: 0.4697541
	speed: 0.0160s/iter; left time: 4.5961s
Updating learning rate to 0.0006650512262981495
Epoch: 6 cost time: 1.2770507335662842
Epoch: 6, Steps: 129 | Train Loss: 0.4697541 Vali Loss: 0.4031734 Best vali loss: 0.3736772
	iters: 100, epoch: 7 | loss: 0.3941874
	speed: 0.0143s/iter; left time: 2.2735s
Updating learning rate to 0.00017284118237643548
Epoch: 7 cost time: 1.188049554824829
Epoch: 7, Steps: 129 | Train Loss: 0.3941874 Vali Loss: 0.3969494 Best vali loss: 0.3736772
	iters: 100, epoch: 8 | loss: 0.4807396
	speed: 0.0154s/iter; left time: 0.4628s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.251532793045044
Epoch: 8, Steps: 129 | Train Loss: 0.4807396 Vali Loss: 0.3955824 Best vali loss: 0.3736772

best validation loss 0.3736771621615104

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3698026
	speed: 0.0133s/iter; left time: 53.2487s
	iters: 200, epoch: 1 | loss: 0.6591713
	speed: 0.0083s/iter; left time: 32.3899s
	iters: 300, epoch: 1 | loss: 1.0961819
	speed: 0.0094s/iter; left time: 35.7318s
	iters: 400, epoch: 1 | loss: 0.2758059
	speed: 0.0097s/iter; left time: 36.1133s
	iters: 500, epoch: 1 | loss: 0.3369479
	speed: 0.0099s/iter; left time: 35.6231s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 4.864346742630005
Epoch: 1, Steps: 514 | Train Loss: 0.5475819 Vali Loss: 0.3675072 Best vali loss: 0.3675072
	iters: 100, epoch: 2 | loss: 0.2646711
	speed: 0.0203s/iter; left time: 70.8859s
	iters: 200, epoch: 2 | loss: 0.7228286
	speed: 0.0097s/iter; left time: 32.9048s
	iters: 300, epoch: 2 | loss: 0.2696287
	speed: 0.0097s/iter; left time: 32.0339s
	iters: 400, epoch: 2 | loss: 0.3556326
	speed: 0.0099s/iter; left time: 31.6536s
	iters: 500, epoch: 2 | loss: 0.4124698
	speed: 0.0097s/iter; left time: 30.0557s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 5.091954469680786
Epoch: 2, Steps: 514 | Train Loss: 0.4050461 Vali Loss: 0.3741252 Best vali loss: 0.3675072
	iters: 100, epoch: 3 | loss: 0.6216495
	speed: 0.0261s/iter; left time: 77.9584s
	iters: 200, epoch: 3 | loss: 0.3904777
	speed: 0.0088s/iter; left time: 25.4787s
	iters: 300, epoch: 3 | loss: 0.4733387
	speed: 0.0081s/iter; left time: 22.4439s
	iters: 400, epoch: 3 | loss: 0.5898510
	speed: 0.0085s/iter; left time: 22.9313s
	iters: 500, epoch: 3 | loss: 0.6582649
	speed: 0.0078s/iter; left time: 20.1085s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 4.477334976196289
Epoch: 3, Steps: 514 | Train Loss: 0.5467164 Vali Loss: 0.3685130 Best vali loss: 0.3675072
	iters: 100, epoch: 4 | loss: 0.6000493
	speed: 0.0172s/iter; left time: 42.5466s
	iters: 200, epoch: 4 | loss: 0.4804593
	speed: 0.0082s/iter; left time: 19.4725s
	iters: 300, epoch: 4 | loss: 0.7793694
	speed: 0.0081s/iter; left time: 18.3819s
	iters: 400, epoch: 4 | loss: 0.6141611
	speed: 0.0083s/iter; left time: 17.9249s
	iters: 500, epoch: 4 | loss: 0.5791575
	speed: 0.0098s/iter; left time: 20.2647s
Updating learning rate to 7.69341037125e-05
Epoch: 4 cost time: 4.438012599945068
Epoch: 4, Steps: 514 | Train Loss: 0.6106393 Vali Loss: 0.3740084 Best vali loss: 0.3675072
	iters: 100, epoch: 5 | loss: 0.4994678
	speed: 0.0173s/iter; left time: 33.8344s
	iters: 200, epoch: 5 | loss: 0.4303725
	speed: 0.0082s/iter; left time: 15.1900s
	iters: 300, epoch: 5 | loss: 0.3629333
	speed: 0.0081s/iter; left time: 14.2906s
	iters: 400, epoch: 5 | loss: 0.6188466
	speed: 0.0080s/iter; left time: 13.3326s
	iters: 500, epoch: 5 | loss: 0.9209468
	speed: 0.0077s/iter; left time: 12.0278s
Updating learning rate to 3.846705185625e-05
Epoch: 5 cost time: 4.1673264503479
Epoch: 5, Steps: 514 | Train Loss: 0.5665134 Vali Loss: 0.3739758 Best vali loss: 0.3675072
	iters: 100, epoch: 6 | loss: 0.5505284
	speed: 0.0165s/iter; left time: 23.8059s
	iters: 200, epoch: 6 | loss: 0.5522951
	speed: 0.0102s/iter; left time: 13.7121s
	iters: 300, epoch: 6 | loss: 0.5407470
	speed: 0.0103s/iter; left time: 12.7559s
	iters: 400, epoch: 6 | loss: 0.2982847
	speed: 0.0112s/iter; left time: 12.8297s
	iters: 500, epoch: 6 | loss: 0.6314433
	speed: 0.0100s/iter; left time: 10.4398s
Updating learning rate to 1.9233525928125e-05
Epoch: 6 cost time: 5.2097039222717285
Epoch: 6, Steps: 514 | Train Loss: 0.5146597 Vali Loss: 0.3752198 Best vali loss: 0.3675072
	iters: 100, epoch: 7 | loss: 0.4295432
	speed: 0.0174s/iter; left time: 16.1764s
	iters: 200, epoch: 7 | loss: 0.5464296
	speed: 0.0085s/iter; left time: 7.0513s
	iters: 300, epoch: 7 | loss: 0.4801010
	speed: 0.0084s/iter; left time: 6.1296s
	iters: 400, epoch: 7 | loss: 0.4984382
	speed: 0.0083s/iter; left time: 5.2401s
	iters: 500, epoch: 7 | loss: 0.9709734
	speed: 0.0084s/iter; left time: 4.4438s
Updating learning rate to 9.6167629640625e-06
Epoch: 7 cost time: 4.386282920837402
Epoch: 7, Steps: 514 | Train Loss: 0.5850971 Vali Loss: 0.3740581 Best vali loss: 0.3675072
	iters: 100, epoch: 8 | loss: 0.5865694
	speed: 0.0180s/iter; left time: 7.4779s
	iters: 200, epoch: 8 | loss: 0.3844050
	speed: 0.0084s/iter; left time: 2.6480s
	iters: 300, epoch: 8 | loss: 0.9488386
	speed: 0.0084s/iter; left time: 1.8047s
	iters: 400, epoch: 8 | loss: 0.3445545
	speed: 0.0101s/iter; left time: 1.1645s
	iters: 500, epoch: 8 | loss: 0.5539178
	speed: 0.0090s/iter; left time: 0.1344s
Updating learning rate to 4.80838148203125e-06
Epoch: 8 cost time: 4.613017797470093
Epoch: 8, Steps: 514 | Train Loss: 0.5636571 Vali Loss: 0.3740110 Best vali loss: 0.3675072

best validation loss 0.3675072320903448

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013187747098, 'e_layers': 3, 'learning_rate': 0.0024705248404, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4793804
	speed: 0.0148s/iter; left time: 120.1216s
	iters: 200, epoch: 1 | loss: 0.2732647
	speed: 0.0088s/iter; left time: 70.5501s
	iters: 300, epoch: 1 | loss: 0.9612973
	speed: 0.0087s/iter; left time: 68.7050s
	iters: 400, epoch: 1 | loss: 0.2967256
	speed: 0.0084s/iter; left time: 66.0509s
	iters: 500, epoch: 1 | loss: 0.3449450
	speed: 0.0075s/iter; left time: 57.8449s
	iters: 600, epoch: 1 | loss: 0.3299226
	speed: 0.0068s/iter; left time: 51.7377s
	iters: 700, epoch: 1 | loss: 0.5317091
	speed: 0.0071s/iter; left time: 53.3277s
	iters: 800, epoch: 1 | loss: 0.5635206
	speed: 0.0059s/iter; left time: 43.7779s
	iters: 900, epoch: 1 | loss: 0.3495235
	speed: 0.0081s/iter; left time: 59.2410s
	iters: 1000, epoch: 1 | loss: 0.5596130
	speed: 0.0092s/iter; left time: 66.1344s
Updating learning rate to 0.0024705248404
Validation loss decreased (inf --> 0.3794).  Saving model state dict ...
Epoch: 1 cost time: 8.499705076217651
Epoch: 1, Steps: 1027 | Train Loss: 0.4689902 Vali Loss: 0.3794242 Best vali loss: 0.3794242
	iters: 100, epoch: 2 | loss: 0.3698101
	speed: 0.0283s/iter; left time: 200.7788s
	iters: 200, epoch: 2 | loss: 0.9795412
	speed: 0.0092s/iter; left time: 64.3897s
	iters: 300, epoch: 2 | loss: 0.3672261
	speed: 0.0089s/iter; left time: 61.4822s
	iters: 400, epoch: 2 | loss: 1.1988262
	speed: 0.0092s/iter; left time: 62.2475s
	iters: 500, epoch: 2 | loss: 0.4163050
	speed: 0.0095s/iter; left time: 63.4241s
	iters: 600, epoch: 2 | loss: 0.4153985
	speed: 0.0099s/iter; left time: 64.9353s
	iters: 700, epoch: 2 | loss: 1.1669979
	speed: 0.0090s/iter; left time: 58.2995s
	iters: 800, epoch: 2 | loss: 0.6148688
	speed: 0.0086s/iter; left time: 55.2090s
	iters: 900, epoch: 2 | loss: 0.3558176
	speed: 0.0095s/iter; left time: 60.0454s
	iters: 1000, epoch: 2 | loss: 0.3279701
	speed: 0.0089s/iter; left time: 55.2106s
Updating learning rate to 0.0012352624202
Validation loss decreased (0.3794 --> 0.3782).  Saving model state dict ...
Epoch: 2 cost time: 9.543262243270874
Epoch: 2, Steps: 1027 | Train Loss: 0.6212761 Vali Loss: 0.3781737 Best vali loss: 0.3781737
	iters: 100, epoch: 3 | loss: 0.2481825
	speed: 0.0280s/iter; left time: 169.6766s
	iters: 200, epoch: 3 | loss: 1.6284865
	speed: 0.0096s/iter; left time: 57.5066s
	iters: 300, epoch: 3 | loss: 0.4089001
	speed: 0.0092s/iter; left time: 54.0841s
	iters: 400, epoch: 3 | loss: 0.6170819
	speed: 0.0094s/iter; left time: 54.4292s
	iters: 500, epoch: 3 | loss: 0.6131673
	speed: 0.0086s/iter; left time: 48.9613s
	iters: 600, epoch: 3 | loss: 1.0449132
	speed: 0.0085s/iter; left time: 47.1305s
	iters: 700, epoch: 3 | loss: 0.1766543
	speed: 0.0082s/iter; left time: 44.9691s
	iters: 800, epoch: 3 | loss: 0.2302008
	speed: 0.0089s/iter; left time: 47.9460s
	iters: 900, epoch: 3 | loss: 0.2657820
	speed: 0.0097s/iter; left time: 50.9200s
	iters: 1000, epoch: 3 | loss: 0.6338578
	speed: 0.0091s/iter; left time: 47.1897s
Updating learning rate to 0.0006176312101
Validation loss decreased (0.3782 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 9.393583536148071
Epoch: 3, Steps: 1027 | Train Loss: 0.5867226 Vali Loss: 0.3665337 Best vali loss: 0.3665337

best validation loss 0.36653365681354094

{'batch_size': 128, 'd_core': 64, 'd_model': 512, 'dropout': 0.002683587556, 'e_layers': 4, 'learning_rate': 0.0008020893783, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0008020893783
Validation loss decreased (inf --> 0.3779).  Saving model state dict ...
Epoch: 1 cost time: 1.6422531604766846
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3778555 Best vali loss: 0.3778555
Updating learning rate to 0.00040104468915
Validation loss decreased (0.3779 --> 0.3765).  Saving model state dict ...
Epoch: 2 cost time: 1.3204247951507568
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3765135 Best vali loss: 0.3765135
Updating learning rate to 0.000200522344575
Epoch: 3 cost time: 1.3273403644561768
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3776381 Best vali loss: 0.3765135

best validation loss 0.37651354230223094

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0099152799004, 'e_layers': 4, 'learning_rate': 0.0012333067614, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4134099
	speed: 0.0189s/iter; left time: 75.7675s
	iters: 200, epoch: 1 | loss: 0.5577430
	speed: 0.0096s/iter; left time: 37.7476s
	iters: 300, epoch: 1 | loss: 0.9218205
	speed: 0.0101s/iter; left time: 38.4371s
	iters: 400, epoch: 1 | loss: 0.8573565
	speed: 0.0107s/iter; left time: 39.9005s
	iters: 500, epoch: 1 | loss: 0.3698685
	speed: 0.0107s/iter; left time: 38.7235s
Updating learning rate to 0.0012333067614
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 5.85212779045105
Epoch: 1, Steps: 514 | Train Loss: 0.6240397 Vali Loss: 0.3681295 Best vali loss: 0.3681295
	iters: 100, epoch: 2 | loss: 0.2872987
	speed: 0.0206s/iter; left time: 72.0519s
	iters: 200, epoch: 2 | loss: 0.9879037
	speed: 0.0102s/iter; left time: 34.5450s
	iters: 300, epoch: 2 | loss: 0.4107842
	speed: 0.0092s/iter; left time: 30.2778s
	iters: 400, epoch: 2 | loss: 0.3180170
	speed: 0.0115s/iter; left time: 36.6650s
	iters: 500, epoch: 2 | loss: 1.0616598
	speed: 0.0126s/iter; left time: 38.9976s
Updating learning rate to 0.0006166533807
Epoch: 2 cost time: 5.661247491836548
Epoch: 2, Steps: 514 | Train Loss: 0.6131327 Vali Loss: 0.3704160 Best vali loss: 0.3681295
	iters: 100, epoch: 3 | loss: 1.1700490
	speed: 0.0525s/iter; left time: 156.6412s
	iters: 200, epoch: 3 | loss: 0.2917916
	speed: 0.0123s/iter; left time: 35.4048s
	iters: 300, epoch: 3 | loss: 0.5309674
	speed: 0.0128s/iter; left time: 35.5365s
	iters: 400, epoch: 3 | loss: 0.3003925
	speed: 0.0127s/iter; left time: 34.1168s
	iters: 500, epoch: 3 | loss: 0.3217868
	speed: 0.0148s/iter; left time: 38.2765s
Updating learning rate to 0.00030832669035
Epoch: 3 cost time: 6.726863861083984
Epoch: 3, Steps: 514 | Train Loss: 0.5229975 Vali Loss: 0.3701568 Best vali loss: 0.3681295

best validation loss 0.36812953354099176

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013187747098, 'e_layers': 3, 'learning_rate': 0.0024705248404, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4404885
	speed: 0.0148s/iter; left time: 74.7721s
	iters: 200, epoch: 4 | loss: 0.2876576
	speed: 0.0088s/iter; left time: 43.4024s
	iters: 300, epoch: 4 | loss: 0.9904465
	speed: 0.0073s/iter; left time: 35.0658s
	iters: 400, epoch: 4 | loss: 0.2813365
	speed: 0.0067s/iter; left time: 31.9432s
	iters: 500, epoch: 4 | loss: 0.3145408
	speed: 0.0074s/iter; left time: 34.2278s
	iters: 600, epoch: 4 | loss: 0.3392429
	speed: 0.0079s/iter; left time: 35.8650s
	iters: 700, epoch: 4 | loss: 0.4317375
	speed: 0.0088s/iter; left time: 39.1600s
	iters: 800, epoch: 4 | loss: 0.5008309
	speed: 0.0078s/iter; left time: 34.0184s
	iters: 900, epoch: 4 | loss: 0.2803905
	speed: 0.0089s/iter; left time: 37.7248s
	iters: 1000, epoch: 4 | loss: 0.4328707
	speed: 0.0089s/iter; left time: 36.8351s
Updating learning rate to 0.00030881560505
Epoch: 4 cost time: 8.615552425384521
Epoch: 4, Steps: 1027 | Train Loss: 0.4299542 Vali Loss: 0.3769713 Best vali loss: 0.3665337
	iters: 100, epoch: 5 | loss: 0.3259903
	speed: 0.0225s/iter; left time: 90.2819s
	iters: 200, epoch: 5 | loss: 0.9575382
	speed: 0.0067s/iter; left time: 26.0359s
	iters: 300, epoch: 5 | loss: 0.3053529
	speed: 0.0081s/iter; left time: 31.0039s
	iters: 400, epoch: 5 | loss: 1.0301255
	speed: 0.0093s/iter; left time: 34.5966s
	iters: 500, epoch: 5 | loss: 0.4016024
	speed: 0.0092s/iter; left time: 33.3647s
	iters: 600, epoch: 5 | loss: 0.3854086
	speed: 0.0070s/iter; left time: 24.6464s
	iters: 700, epoch: 5 | loss: 1.2812363
	speed: 0.0083s/iter; left time: 28.2210s
	iters: 800, epoch: 5 | loss: 0.5517797
	speed: 0.0097s/iter; left time: 32.2222s
	iters: 900, epoch: 5 | loss: 0.2925676
	speed: 0.0082s/iter; left time: 26.3129s
	iters: 1000, epoch: 5 | loss: 0.3131915
	speed: 0.0096s/iter; left time: 29.6995s
Updating learning rate to 0.000154407802525
Epoch: 5 cost time: 8.658215045928955
Epoch: 5, Steps: 1027 | Train Loss: 0.5844793 Vali Loss: 0.3863657 Best vali loss: 0.3665337
	iters: 100, epoch: 6 | loss: 0.2362738
	speed: 0.0249s/iter; left time: 74.1409s
	iters: 200, epoch: 6 | loss: 1.6557881
	speed: 0.0078s/iter; left time: 22.4834s
	iters: 300, epoch: 6 | loss: 0.3242072
	speed: 0.0087s/iter; left time: 24.0672s
	iters: 400, epoch: 6 | loss: 0.6124302
	speed: 0.0084s/iter; left time: 22.6277s
	iters: 500, epoch: 6 | loss: 0.6025476
	speed: 0.0074s/iter; left time: 19.1932s
	iters: 600, epoch: 6 | loss: 1.0746703
	speed: 0.0084s/iter; left time: 20.8403s
	iters: 700, epoch: 6 | loss: 0.1633209
	speed: 0.0087s/iter; left time: 20.8334s
	iters: 800, epoch: 6 | loss: 0.2168566
	speed: 0.0079s/iter; left time: 17.9694s
	iters: 900, epoch: 6 | loss: 0.2540163
	speed: 0.0091s/iter; left time: 19.8881s
	iters: 1000, epoch: 6 | loss: 0.5398319
	speed: 0.0086s/iter; left time: 17.8359s
Updating learning rate to 7.72039012625e-05
Epoch: 6 cost time: 8.456618785858154
Epoch: 6, Steps: 1027 | Train Loss: 0.5679943 Vali Loss: 0.3916438 Best vali loss: 0.3665337
	iters: 100, epoch: 7 | loss: 0.4690890
	speed: 0.0172s/iter; left time: 33.6723s
	iters: 200, epoch: 7 | loss: 0.8659344
	speed: 0.0082s/iter; left time: 15.1397s
	iters: 300, epoch: 7 | loss: 0.2876850
	speed: 0.0080s/iter; left time: 14.0241s
	iters: 400, epoch: 7 | loss: 0.4568599
	speed: 0.0077s/iter; left time: 12.8017s
	iters: 500, epoch: 7 | loss: 1.0003234
	speed: 0.0063s/iter; left time: 9.8616s
	iters: 600, epoch: 7 | loss: 0.2853484
	speed: 0.0059s/iter; left time: 8.5197s
	iters: 700, epoch: 7 | loss: 0.3999468
	speed: 0.0094s/iter; left time: 12.7830s
	iters: 800, epoch: 7 | loss: 0.6498037
	speed: 0.0092s/iter; left time: 11.5898s
	iters: 900, epoch: 7 | loss: 0.3503202
	speed: 0.0092s/iter; left time: 10.5697s
	iters: 1000, epoch: 7 | loss: 0.2983842
	speed: 0.0078s/iter; left time: 8.2145s
Updating learning rate to 3.860195063125e-05
Epoch: 7 cost time: 7.973031759262085
Epoch: 7, Steps: 1027 | Train Loss: 0.5063695 Vali Loss: 0.3932824 Best vali loss: 0.3665337
	iters: 100, epoch: 8 | loss: 0.4603332
	speed: 0.0269s/iter; left time: 24.9955s
	iters: 200, epoch: 8 | loss: 0.2958530
	speed: 0.0074s/iter; left time: 6.1505s
	iters: 300, epoch: 8 | loss: 0.2659913
	speed: 0.0096s/iter; left time: 6.9814s
	iters: 400, epoch: 8 | loss: 0.3756954
	speed: 0.0091s/iter; left time: 5.7365s
	iters: 500, epoch: 8 | loss: 0.3788906
	speed: 0.0072s/iter; left time: 3.7981s
	iters: 600, epoch: 8 | loss: 0.7896512
	speed: 0.0072s/iter; left time: 3.0605s
	iters: 700, epoch: 8 | loss: 0.3641650
	speed: 0.0096s/iter; left time: 3.1604s
	iters: 800, epoch: 8 | loss: 0.8819782
	speed: 0.0082s/iter; left time: 1.8629s
	iters: 900, epoch: 8 | loss: 0.4655737
	speed: 0.0090s/iter; left time: 1.1517s
	iters: 1000, epoch: 8 | loss: 0.2899502
	speed: 0.0082s/iter; left time: 0.2302s
Updating learning rate to 1.9300975315625e-05
Epoch: 8 cost time: 8.669283390045166
Epoch: 8, Steps: 1027 | Train Loss: 0.4568082 Vali Loss: 0.3977573 Best vali loss: 0.3665337

best validation loss 0.36653365681354094

{'batch_size': 8, 'd_core': 128, 'd_model': 256, 'dropout': 0.0012158342535, 'e_layers': 4, 'learning_rate': 0.0001583628596, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3486447
	speed: 0.0184s/iter; left time: 149.4975s
	iters: 200, epoch: 1 | loss: 0.2506006
	speed: 0.0097s/iter; left time: 77.9351s
	iters: 300, epoch: 1 | loss: 0.3697793
	speed: 0.0076s/iter; left time: 59.8051s
	iters: 400, epoch: 1 | loss: 0.8198479
	speed: 0.0092s/iter; left time: 72.0224s
	iters: 500, epoch: 1 | loss: 0.4125586
	speed: 0.0092s/iter; left time: 70.8295s
	iters: 600, epoch: 1 | loss: 0.3179877
	speed: 0.0095s/iter; left time: 72.4447s
	iters: 700, epoch: 1 | loss: 0.6747231
	speed: 0.0095s/iter; left time: 71.5275s
	iters: 800, epoch: 1 | loss: 0.4208697
	speed: 0.0095s/iter; left time: 70.2085s
	iters: 900, epoch: 1 | loss: 1.1998180
	speed: 0.0096s/iter; left time: 70.5517s
	iters: 1000, epoch: 1 | loss: 0.9923086
	speed: 0.0098s/iter; left time: 70.8270s
Updating learning rate to 0.00015233553214719927
Validation loss decreased (inf --> 0.3609).  Saving model state dict ...
Epoch: 1 cost time: 10.12735915184021
Epoch: 1, Steps: 1027 | Train Loss: 0.6807138 Vali Loss: 0.3608997 Best vali loss: 0.3608997
	iters: 100, epoch: 2 | loss: 1.1963255
	speed: 0.0263s/iter; left time: 186.5243s
	iters: 200, epoch: 2 | loss: 0.3248292
	speed: 0.0090s/iter; left time: 62.9177s
	iters: 300, epoch: 2 | loss: 0.3602836
	speed: 0.0082s/iter; left time: 56.8042s
	iters: 400, epoch: 2 | loss: 0.3435002
	speed: 0.0088s/iter; left time: 60.0487s
	iters: 500, epoch: 2 | loss: 0.4093316
	speed: 0.0089s/iter; left time: 59.6591s
	iters: 600, epoch: 2 | loss: 0.7438642
	speed: 0.0100s/iter; left time: 65.7227s
	iters: 700, epoch: 2 | loss: 0.6871942
	speed: 0.0099s/iter; left time: 64.0904s
	iters: 800, epoch: 2 | loss: 0.4464514
	speed: 0.0099s/iter; left time: 63.3357s
	iters: 900, epoch: 2 | loss: 0.5141407
	speed: 0.0094s/iter; left time: 59.0885s
	iters: 1000, epoch: 2 | loss: 1.2707418
	speed: 0.0085s/iter; left time: 52.4656s
Updating learning rate to 0.0001351711557556266
Epoch: 2 cost time: 9.42806339263916
Epoch: 2, Steps: 1027 | Train Loss: 0.6296662 Vali Loss: 0.3645847 Best vali loss: 0.3608997
	iters: 100, epoch: 3 | loss: 0.3550453
	speed: 0.0294s/iter; left time: 178.2554s
	iters: 200, epoch: 3 | loss: 0.3643506
	speed: 0.0125s/iter; left time: 74.6222s
	iters: 300, epoch: 3 | loss: 1.2950828
	speed: 0.0148s/iter; left time: 86.9541s
	iters: 400, epoch: 3 | loss: 0.7197615
	speed: 0.0133s/iter; left time: 76.5986s
	iters: 500, epoch: 3 | loss: 0.8649894
	speed: 0.0141s/iter; left time: 79.7855s
	iters: 600, epoch: 3 | loss: 0.8380190
	speed: 0.0103s/iter; left time: 57.1650s
	iters: 700, epoch: 3 | loss: 0.6241630
	speed: 0.0088s/iter; left time: 48.0983s
	iters: 800, epoch: 3 | loss: 0.4134338
	speed: 0.0104s/iter; left time: 55.9345s
	iters: 900, epoch: 3 | loss: 0.3728392
	speed: 0.0097s/iter; left time: 50.9327s
	iters: 1000, epoch: 3 | loss: 0.7581363
	speed: 0.0094s/iter; left time: 48.7623s
Updating learning rate to 0.00010948285113543942
Validation loss decreased (0.3609 --> 0.3579).  Saving model state dict ...
Epoch: 3 cost time: 11.56198239326477
Epoch: 3, Steps: 1027 | Train Loss: 0.6605821 Vali Loss: 0.3578522 Best vali loss: 0.3578522
	iters: 100, epoch: 4 | loss: 0.4849375
	speed: 0.0283s/iter; left time: 142.6700s
	iters: 200, epoch: 4 | loss: 0.9978771
	speed: 0.0084s/iter; left time: 41.6925s
	iters: 300, epoch: 4 | loss: 0.2746261
	speed: 0.0093s/iter; left time: 45.1860s
	iters: 400, epoch: 4 | loss: 0.2094326
	speed: 0.0094s/iter; left time: 44.5116s
	iters: 500, epoch: 4 | loss: 0.2532972
	speed: 0.0087s/iter; left time: 40.1996s
	iters: 600, epoch: 4 | loss: 0.8903753
	speed: 0.0095s/iter; left time: 42.9207s
	iters: 700, epoch: 4 | loss: 0.5139510
	speed: 0.0100s/iter; left time: 44.4823s
	iters: 800, epoch: 4 | loss: 0.2888166
	speed: 0.0099s/iter; left time: 42.8624s
	iters: 900, epoch: 4 | loss: 0.3619989
	speed: 0.0090s/iter; left time: 38.3103s
	iters: 1000, epoch: 4 | loss: 0.8051980
	speed: 0.0098s/iter; left time: 40.3458s
Updating learning rate to 7.91814298e-05
Validation loss decreased (0.3579 --> 0.3476).  Saving model state dict ...
Epoch: 4 cost time: 9.715038061141968
Epoch: 4, Steps: 1027 | Train Loss: 0.5080510 Vali Loss: 0.3476369 Best vali loss: 0.3476369
	iters: 100, epoch: 5 | loss: 1.0391798
	speed: 0.0263s/iter; left time: 105.4820s
	iters: 200, epoch: 5 | loss: 0.8834776
	speed: 0.0106s/iter; left time: 41.3635s
	iters: 300, epoch: 5 | loss: 0.2625349
	speed: 0.0103s/iter; left time: 39.2820s
	iters: 400, epoch: 5 | loss: 0.3912441
	speed: 0.0095s/iter; left time: 35.2032s
	iters: 500, epoch: 5 | loss: 0.3277723
	speed: 0.0098s/iter; left time: 35.5186s
	iters: 600, epoch: 5 | loss: 0.4541075
	speed: 0.0095s/iter; left time: 33.4209s
	iters: 700, epoch: 5 | loss: 1.1275717
	speed: 0.0082s/iter; left time: 27.8883s
	iters: 800, epoch: 5 | loss: 0.7838643
	speed: 0.0095s/iter; left time: 31.4683s
	iters: 900, epoch: 5 | loss: 0.5435888
	speed: 0.0098s/iter; left time: 31.2937s
	iters: 1000, epoch: 5 | loss: 0.8406595
	speed: 0.0095s/iter; left time: 29.4090s
Updating learning rate to 4.88800084645606e-05
Epoch: 5 cost time: 9.973676681518555
Epoch: 5, Steps: 1027 | Train Loss: 0.6654000 Vali Loss: 0.3476470 Best vali loss: 0.3476369
	iters: 100, epoch: 6 | loss: 0.2736971
	speed: 0.0226s/iter; left time: 67.2592s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.006258308639, 'e_layers': 2, 'learning_rate': 0.0015600129814, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0015600129814
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 0.9304170608520508
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3690461 Best vali loss: 0.3690461
Updating learning rate to 0.0007800064907
Validation loss decreased (0.3690 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 1.3930838108062744
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3647098 Best vali loss: 0.3647098
Updating learning rate to 0.00039000324535
Epoch: 3 cost time: 1.5008964538574219
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3675566 Best vali loss: 0.3647098
Updating learning rate to 0.000195001622675
Epoch: 4 cost time: 1.8444485664367676
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3656954 Best vali loss: 0.3647098
Updating learning rate to 9.75008113375e-05
Epoch: 5 cost time: 1.1304304599761963
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3668223 Best vali loss: 0.3647098
Updating learning rate to 4.875040566875e-05
Epoch: 6 cost time: 1.8142659664154053
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3664569 Best vali loss: 0.3647098
Updating learning rate to 2.4375202834375e-05
Epoch: 7 cost time: 0.8483626842498779
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3666911 Best vali loss: 0.3647098
Updating learning rate to 1.21876014171875e-05
Epoch: 8 cost time: 0.617124080657959
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3669149 Best vali loss: 0.3647098

best validation loss 0.36470981125513086

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.0100243466185, 'e_layers': 3, 'learning_rate': 0.0003146234386, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00030264879698543076
Validation loss decreased (inf --> 0.4092).  Saving model state dict ...
Epoch: 1 cost time: 1.1399180889129639
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4092165 Best vali loss: 0.4092165
Updating learning rate to 0.00026854790277714465
Validation loss decreased (0.4092 --> 0.3895).  Saving model state dict ...
Epoch: 2 cost time: 0.7850472927093506
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3895350 Best vali loss: 0.3895350
Updating learning rate to 0.00021751230799297756
Validation loss decreased (0.3895 --> 0.3808).  Saving model state dict ...
Epoch: 3 cost time: 1.021716833114624
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3807763 Best vali loss: 0.3807763

best validation loss 0.3807762588171219

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0016190983282, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5005737
	speed: 0.0160s/iter; left time: 64.3407s
	iters: 200, epoch: 1 | loss: 0.2500078
	speed: 0.0086s/iter; left time: 33.6753s
	iters: 300, epoch: 1 | loss: 0.5021363
	speed: 0.0083s/iter; left time: 31.5527s
	iters: 400, epoch: 1 | loss: 0.5994835
	speed: 0.0082s/iter; left time: 30.3236s
	iters: 500, epoch: 1 | loss: 0.8825062
	speed: 0.0085s/iter; left time: 30.5885s
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 4.764350414276123
Epoch: 1, Steps: 514 | Train Loss: 0.5469415 Vali Loss: 0.3654672 Best vali loss: 0.3654672
	iters: 100, epoch: 2 | loss: 0.2844942
	speed: 0.0203s/iter; left time: 70.9456s
	iters: 200, epoch: 2 | loss: 0.9591498
	speed: 0.0086s/iter; left time: 29.2314s
	iters: 300, epoch: 2 | loss: 0.4972635
	speed: 0.0088s/iter; left time: 28.9803s
	iters: 400, epoch: 2 | loss: 0.3457048
	speed: 0.0086s/iter; left time: 27.6442s
	iters: 500, epoch: 2 | loss: 0.5382767
	speed: 0.0086s/iter; left time: 26.6746s
Updating learning rate to 0.0001102632917922533
Epoch: 2 cost time: 4.6330437660217285
Epoch: 2, Steps: 514 | Train Loss: 0.5249778 Vali Loss: 0.3728342 Best vali loss: 0.3654672
	iters: 100, epoch: 3 | loss: 0.3628950
	speed: 0.0185s/iter; left time: 55.1213s
	iters: 200, epoch: 3 | loss: 0.3562469
	speed: 0.0076s/iter; left time: 21.9720s
	iters: 300, epoch: 3 | loss: 0.5521183
	speed: 0.0074s/iter; left time: 20.7403s
	iters: 400, epoch: 3 | loss: 0.3242675
	speed: 0.0093s/iter; left time: 24.8515s
	iters: 500, epoch: 3 | loss: 0.5381632
	speed: 0.0121s/iter; left time: 31.2541s
Updating learning rate to 8.93085473266162e-05
Epoch: 3 cost time: 4.75460147857666
Epoch: 3, Steps: 514 | Train Loss: 0.4267382 Vali Loss: 0.3693386 Best vali loss: 0.3654672

best validation loss 0.3654671846649267

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.003746361081, 'e_layers': 4, 'learning_rate': 0.0017176414911, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0016522676544597288
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 1.209834098815918
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3739885 Best vali loss: 0.3739885
Updating learning rate to 0.0014660987185520914
Validation loss decreased (0.3740 --> 0.3678).  Saving model state dict ...
Epoch: 2 cost time: 0.766162633895874
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3678248 Best vali loss: 0.3678248
Updating learning rate to 0.0011874772162434196
Epoch: 3 cost time: 0.8650312423706055
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3727337 Best vali loss: 0.3678248

best validation loss 0.36782478102298055

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0016190983282, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4714207
	speed: 0.0170s/iter; left time: 42.0430s
	iters: 200, epoch: 4 | loss: 0.2349804
	speed: 0.0084s/iter; left time: 20.0268s
	iters: 300, epoch: 4 | loss: 0.5216560
	speed: 0.0086s/iter; left time: 19.5230s
	iters: 400, epoch: 4 | loss: 0.4016510
	speed: 0.0079s/iter; left time: 17.2000s
	iters: 500, epoch: 4 | loss: 0.6324993
	speed: 0.0081s/iter; left time: 16.8147s
Updating learning rate to 6.45907409e-05
Validation loss decreased (0.3655 --> 0.3595).  Saving model state dict ...
Epoch: 4 cost time: 4.772136449813843
Epoch: 4, Steps: 514 | Train Loss: 0.4524415 Vali Loss: 0.3595417 Best vali loss: 0.3595417
	iters: 100, epoch: 5 | loss: 0.2600875
	speed: 0.0193s/iter; left time: 37.7231s
	iters: 200, epoch: 5 | loss: 0.7928544
	speed: 0.0084s/iter; left time: 15.5080s
	iters: 300, epoch: 5 | loss: 0.4188648
	speed: 0.0082s/iter; left time: 14.3601s
	iters: 400, epoch: 5 | loss: 0.2976247
	speed: 0.0088s/iter; left time: 14.5573s
	iters: 500, epoch: 5 | loss: 0.3838122
	speed: 0.0094s/iter; left time: 14.6899s
Updating learning rate to 3.987293447338382e-05
Epoch: 5 cost time: 4.480643033981323
Epoch: 5, Steps: 514 | Train Loss: 0.4306487 Vali Loss: 0.3739283 Best vali loss: 0.3595417
	iters: 100, epoch: 6 | loss: 0.3203336
	speed: 0.0173s/iter; left time: 24.9249s
	iters: 200, epoch: 6 | loss: 0.3215509
	speed: 0.0088s/iter; left time: 11.8015s
	iters: 300, epoch: 6 | loss: 0.4827225
	speed: 0.0085s/iter; left time: 10.5924s
	iters: 400, epoch: 6 | loss: 0.2417883
	speed: 0.0084s/iter; left time: 9.6463s
	iters: 500, epoch: 6 | loss: 0.4853333
	speed: 0.0087s/iter; left time: 9.0410s
Updating learning rate to 1.891819000774672e-05
Epoch: 6 cost time: 4.448412656784058
Epoch: 6, Steps: 514 | Train Loss: 0.3703457 Vali Loss: 0.3655772 Best vali loss: 0.3595417
	iters: 100, epoch: 7 | loss: 0.1735273
	speed: 0.0186s/iter; left time: 17.2657s
	iters: 200, epoch: 7 | loss: 0.3350113
	speed: 0.0080s/iter; left time: 6.6147s
	iters: 300, epoch: 7 | loss: 0.5296373
	speed: 0.0063s/iter; left time: 4.5615s
	iters: 400, epoch: 7 | loss: 0.3937846
	speed: 0.0066s/iter; left time: 4.1288s
	iters: 500, epoch: 7 | loss: 0.3087362
	speed: 0.0068s/iter; left time: 3.5764s
Updating learning rate to 4.916677392750353e-06
Epoch: 7 cost time: 3.7068002223968506
Epoch: 7, Steps: 514 | Train Loss: 0.3481394 Vali Loss: 0.3720977 Best vali loss: 0.3595417
	iters: 100, epoch: 8 | loss: 0.4492116
	speed: 0.0192s/iter; left time: 7.9769s
	iters: 200, epoch: 8 | loss: 0.7076296
	speed: 0.0086s/iter; left time: 2.7233s
	iters: 300, epoch: 8 | loss: 0.4689412
	speed: 0.0089s/iter; left time: 1.9036s
	iters: 400, epoch: 8 | loss: 0.4739247
	speed: 0.0049s/iter; left time: 0.5661s
	iters: 500, epoch: 8 | loss: 0.4721819
	speed: 0.0057s/iter; left time: 0.0860s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.9233717918395996
Epoch: 8, Steps: 514 | Train Loss: 0.5143778 Vali Loss: 0.3755244 Best vali loss: 0.3595417

best validation loss 0.35954168570065076

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0031811048754, 'e_layers': 2, 'learning_rate': 8.85696577e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4105902
	speed: 0.0142s/iter; left time: 115.1608s
	iters: 200, epoch: 1 | loss: 0.4799401
	speed: 0.0080s/iter; left time: 63.8586s
	iters: 300, epoch: 1 | loss: 0.6190853
	speed: 0.0087s/iter; left time: 68.5703s
	iters: 400, epoch: 1 | loss: 0.4206194
	speed: 0.0077s/iter; left time: 60.5203s
	iters: 500, epoch: 1 | loss: 0.9351090
	speed: 0.0051s/iter; left time: 39.0434s
	iters: 600, epoch: 1 | loss: 0.6083079
	speed: 0.0044s/iter; left time: 33.5610s
	iters: 700, epoch: 1 | loss: 0.4189765
	speed: 0.0044s/iter; left time: 33.2277s
	iters: 800, epoch: 1 | loss: 0.2982885
	speed: 0.0069s/iter; left time: 51.3396s
	iters: 900, epoch: 1 | loss: 0.3022523
	speed: 0.0087s/iter; left time: 63.6342s
	iters: 1000, epoch: 1 | loss: 0.3919728
	speed: 0.0077s/iter; left time: 55.2655s
Updating learning rate to 8.519867582528033e-05
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 7.546616792678833
Epoch: 1, Steps: 1027 | Train Loss: 0.4885142 Vali Loss: 0.3648995 Best vali loss: 0.3648995
	iters: 100, epoch: 2 | loss: 0.3183492
	speed: 0.0248s/iter; left time: 175.9486s
	iters: 200, epoch: 2 | loss: 0.8663549
	speed: 0.0061s/iter; left time: 42.5151s
	iters: 300, epoch: 2 | loss: 1.3330578
	speed: 0.0063s/iter; left time: 43.2385s
	iters: 400, epoch: 2 | loss: 0.3370458
	speed: 0.0086s/iter; left time: 58.2284s
	iters: 500, epoch: 2 | loss: 0.7958539
	speed: 0.0076s/iter; left time: 50.6799s
	iters: 600, epoch: 2 | loss: 0.4035589
	speed: 0.0074s/iter; left time: 48.6785s
	iters: 700, epoch: 2 | loss: 0.5547197
	speed: 0.0095s/iter; left time: 61.6011s
	iters: 800, epoch: 2 | loss: 0.8548650
	speed: 0.0074s/iter; left time: 47.1220s
	iters: 900, epoch: 2 | loss: 0.6492637
	speed: 0.0090s/iter; left time: 56.6584s
	iters: 1000, epoch: 2 | loss: 0.3007279
	speed: 0.0074s/iter; left time: 46.0566s
Updating learning rate to 7.559893163352066e-05
Validation loss decreased (0.3649 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 7.959960699081421
Epoch: 2, Steps: 1027 | Train Loss: 0.6413797 Vali Loss: 0.3643459 Best vali loss: 0.3643459
	iters: 100, epoch: 3 | loss: 0.4337458
	speed: 0.0235s/iter; left time: 142.4756s
	iters: 200, epoch: 3 | loss: 0.6674351
	speed: 0.0069s/iter; left time: 41.1821s
	iters: 300, epoch: 3 | loss: 0.7812035
	speed: 0.0061s/iter; left time: 35.8254s
	iters: 400, epoch: 3 | loss: 0.9688158
	speed: 0.0051s/iter; left time: 29.6181s
	iters: 500, epoch: 3 | loss: 0.3156913
	speed: 0.0063s/iter; left time: 35.6292s
	iters: 600, epoch: 3 | loss: 0.8446792
	speed: 0.0082s/iter; left time: 45.6201s
	iters: 700, epoch: 3 | loss: 1.0975833
	speed: 0.0085s/iter; left time: 46.5903s
	iters: 800, epoch: 3 | loss: 0.2997595
	speed: 0.0076s/iter; left time: 40.8627s
	iters: 900, epoch: 3 | loss: 0.2913262
	speed: 0.0067s/iter; left time: 35.3729s
	iters: 1000, epoch: 3 | loss: 0.3770469
	speed: 0.0075s/iter; left time: 38.9395s
Updating learning rate to 6.123189915601855e-05
Epoch: 3 cost time: 7.3170952796936035
Epoch: 3, Steps: 1027 | Train Loss: 0.6077287 Vali Loss: 0.3694952 Best vali loss: 0.3643459
	iters: 100, epoch: 4 | loss: 0.4354723
	speed: 0.0246s/iter; left time: 123.9254s
	iters: 200, epoch: 4 | loss: 0.5519486
	speed: 0.0085s/iter; left time: 41.7643s
	iters: 300, epoch: 4 | loss: 0.6313450
	speed: 0.0081s/iter; left time: 39.3678s
	iters: 400, epoch: 4 | loss: 1.5128736
	speed: 0.0077s/iter; left time: 36.6528s
	iters: 500, epoch: 4 | loss: 1.1356157
	speed: 0.0074s/iter; left time: 34.2455s
	iters: 600, epoch: 4 | loss: 0.3866128
	speed: 0.0068s/iter; left time: 30.8141s
	iters: 700, epoch: 4 | loss: 0.2275690
	speed: 0.0065s/iter; left time: 28.6335s
	iters: 800, epoch: 4 | loss: 0.8498076
	speed: 0.0069s/iter; left time: 29.9680s
	iters: 900, epoch: 4 | loss: 0.9036415
	speed: 0.0078s/iter; left time: 33.2163s
	iters: 1000, epoch: 4 | loss: 1.1285820
	speed: 0.0076s/iter; left time: 31.2649s
Updating learning rate to 4.428482885e-05
Epoch: 4 cost time: 7.775778770446777
Epoch: 4, Steps: 1027 | Train Loss: 0.7763468 Vali Loss: 0.3967206 Best vali loss: 0.3643459
	iters: 100, epoch: 5 | loss: 0.7981938
	speed: 0.0233s/iter; left time: 93.5270s
	iters: 200, epoch: 5 | loss: 0.5536920
	speed: 0.0079s/iter; left time: 30.8100s
	iters: 300, epoch: 5 | loss: 1.0293251
	speed: 0.0070s/iter; left time: 26.8304s
	iters: 400, epoch: 5 | loss: 0.2093023
	speed: 0.0072s/iter; left time: 26.8523s
	iters: 500, epoch: 5 | loss: 1.5484113
	speed: 0.0077s/iter; left time: 27.7525s
	iters: 600, epoch: 5 | loss: 0.5601764
	speed: 0.0073s/iter; left time: 25.5206s
	iters: 700, epoch: 5 | loss: 0.4171945
	speed: 0.0071s/iter; left time: 24.2203s
	iters: 800, epoch: 5 | loss: 0.3814905
	speed: 0.0062s/iter; left time: 20.5454s
	iters: 900, epoch: 5 | loss: 0.5591346
	speed: 0.0076s/iter; left time: 24.4361s
	iters: 1000, epoch: 5 | loss: 0.8591099
	speed: 0.0077s/iter; left time: 24.0943s
Updating learning rate to 2.733775854398145e-05
Epoch: 5 cost time: 7.493580341339111
Epoch: 5, Steps: 1027 | Train Loss: 0.6916030 Vali Loss: 0.3832918 Best vali loss: 0.3643459
	iters: 100, epoch: 6 | loss: 0.7421965
	speed: 0.0243s/iter; left time: 72.5765s
	iters: 200, epoch: 6 | loss: 0.4236777
	speed: 0.0051s/iter; left time: 14.6131s
	iters: 300, epoch: 6 | loss: 0.2053573
	speed: 0.0058s/iter; left time: 16.0613s
	iters: 400, epoch: 6 | loss: 0.4593876
	speed: 0.0071s/iter; left time: 18.9838s
	iters: 500, epoch: 6 | loss: 0.3106692
	speed: 0.0073s/iter; left time: 18.9232s
	iters: 600, epoch: 6 | loss: 0.3455732
	speed: 0.0077s/iter; left time: 19.0120s
	iters: 700, epoch: 6 | loss: 0.5727531
	speed: 0.0080s/iter; left time: 19.1361s
	iters: 800, epoch: 6 | loss: 0.2960416
	speed: 0.0086s/iter; left time: 19.6201s
	iters: 900, epoch: 6 | loss: 0.3357392
	speed: 0.0055s/iter; left time: 12.1044s
	iters: 1000, epoch: 6 | loss: 0.5181578
	speed: 0.0074s/iter; left time: 15.4505s
Updating learning rate to 1.2970726066479346e-05
Epoch: 6 cost time: 7.247237682342529
Epoch: 6, Steps: 1027 | Train Loss: 0.4209553 Vali Loss: 0.3836827 Best vali loss: 0.3643459
	iters: 100, epoch: 7 | loss: 0.2566451
	speed: 0.0236s/iter; left time: 46.0510s
	iters: 200, epoch: 7 | loss: 0.3158838
	speed: 0.0075s/iter; left time: 13.8371s
	iters: 300, epoch: 7 | loss: 0.6500849
	speed: 0.0060s/iter; left time: 10.6171s
	iters: 400, epoch: 7 | loss: 0.3622840
	speed: 0.0058s/iter; left time: 9.5270s
	iters: 500, epoch: 7 | loss: 0.9490406
	speed: 0.0064s/iter; left time: 9.9418s
	iters: 600, epoch: 7 | loss: 0.2548613
	speed: 0.0068s/iter; left time: 9.8571s
	iters: 700, epoch: 7 | loss: 1.9302642
	speed: 0.0078s/iter; left time: 10.5690s
	iters: 800, epoch: 7 | loss: 0.2772488
	speed: 0.0086s/iter; left time: 10.7747s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0024993553018, 'e_layers': 1, 'learning_rate': 0.0003469645636, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3535559
	speed: 0.0118s/iter; left time: 95.8131s
	iters: 200, epoch: 1 | loss: 0.5131601
	speed: 0.0038s/iter; left time: 30.7716s
	iters: 300, epoch: 1 | loss: 1.2195964
	speed: 0.0040s/iter; left time: 31.6407s
	iters: 400, epoch: 1 | loss: 1.0555484
	speed: 0.0051s/iter; left time: 40.1301s
	iters: 500, epoch: 1 | loss: 0.3939362
	speed: 0.0044s/iter; left time: 34.3075s
	iters: 600, epoch: 1 | loss: 0.2936473
	speed: 0.0061s/iter; left time: 46.1021s
	iters: 700, epoch: 1 | loss: 0.4639557
	speed: 0.0070s/iter; left time: 52.3667s
	iters: 800, epoch: 1 | loss: 0.3437490
	speed: 0.0068s/iter; left time: 50.0742s
	iters: 900, epoch: 1 | loss: 0.3740385
	speed: 0.0059s/iter; left time: 43.3357s
	iters: 1000, epoch: 1 | loss: 0.2008961
	speed: 0.0052s/iter; left time: 37.2344s
Updating learning rate to 0.0003337590112083753
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 5.810845375061035
Epoch: 1, Steps: 1027 | Train Loss: 0.5212084 Vali Loss: 0.3756884 Best vali loss: 0.3756884
	iters: 100, epoch: 2 | loss: 1.6022220
	speed: 0.0196s/iter; left time: 138.6609s
	iters: 200, epoch: 2 | loss: 0.2698349
	speed: 0.0059s/iter; left time: 41.5691s
	iters: 300, epoch: 2 | loss: 0.2719134
	speed: 0.0057s/iter; left time: 39.5220s
	iters: 400, epoch: 2 | loss: 0.2461935
	speed: 0.0058s/iter; left time: 39.7135s
	iters: 500, epoch: 2 | loss: 0.6550756
	speed: 0.0057s/iter; left time: 38.3391s
	iters: 600, epoch: 2 | loss: 0.6551234
	speed: 0.0055s/iter; left time: 36.0743s
	iters: 700, epoch: 2 | loss: 0.7255961
	speed: 0.0058s/iter; left time: 37.6790s
	iters: 800, epoch: 2 | loss: 0.7355890
	speed: 0.0059s/iter; left time: 37.6802s
	iters: 900, epoch: 2 | loss: 0.3001543
	speed: 0.0059s/iter; left time: 37.0707s
	iters: 1000, epoch: 2 | loss: 0.2290678
	speed: 0.0059s/iter; left time: 36.5892s
Updating learning rate to 0.00029615277967649556
Validation loss decreased (0.3757 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 6.022141695022583
Epoch: 2, Steps: 1027 | Train Loss: 0.5690770 Vali Loss: 0.3740996 Best vali loss: 0.3740996
	iters: 100, epoch: 3 | loss: 0.2382476
	speed: 0.0208s/iter; left time: 126.3263s
	iters: 200, epoch: 3 | loss: 0.3842611
	speed: 0.0045s/iter; left time: 26.5372s
	iters: 300, epoch: 3 | loss: 0.9569029
	speed: 0.0051s/iter; left time: 29.8031s
	iters: 400, epoch: 3 | loss: 0.2809044
	speed: 0.0060s/iter; left time: 34.5912s
	iters: 500, epoch: 3 | loss: 0.4719893
	speed: 0.0060s/iter; left time: 33.9974s
	iters: 600, epoch: 3 | loss: 1.5331537
	speed: 0.0060s/iter; left time: 33.3324s
	iters: 700, epoch: 3 | loss: 1.1988496
	speed: 0.0057s/iter; left time: 31.3207s
	iters: 800, epoch: 3 | loss: 0.5947014
	speed: 0.0052s/iter; left time: 27.6500s
	iters: 900, epoch: 3 | loss: 0.3891435
	speed: 0.0056s/iter; left time: 29.5037s
	iters: 1000, epoch: 3 | loss: 0.8234926
	speed: 0.0057s/iter; left time: 29.2574s
Updating learning rate to 0.00023987107685375175
Epoch: 3 cost time: 5.628003120422363
Epoch: 3, Steps: 1027 | Train Loss: 0.6871646 Vali Loss: 0.3808181 Best vali loss: 0.3740996
	iters: 100, epoch: 4 | loss: 0.3662583
	speed: 0.0228s/iter; left time: 114.7128s
	iters: 200, epoch: 4 | loss: 0.3859583
	speed: 0.0060s/iter; left time: 29.6338s
	iters: 300, epoch: 4 | loss: 0.7025609
	speed: 0.0060s/iter; left time: 29.1741s
	iters: 400, epoch: 4 | loss: 0.2267707
	speed: 0.0059s/iter; left time: 28.1638s
	iters: 500, epoch: 4 | loss: 0.2903028
	speed: 0.0060s/iter; left time: 27.8578s
	iters: 600, epoch: 4 | loss: 0.3638309
	speed: 0.0058s/iter; left time: 26.1904s
	iters: 700, epoch: 4 | loss: 1.1825140
	speed: 0.0051s/iter; left time: 22.6251s
	iters: 800, epoch: 4 | loss: 0.4858863
	speed: 0.0049s/iter; left time: 21.1711s
	iters: 900, epoch: 4 | loss: 0.3997459
	speed: 0.0057s/iter; left time: 24.2206s
	iters: 1000, epoch: 4 | loss: 0.2485225
	speed: 0.0061s/iter; left time: 25.4182s
Updating learning rate to 0.0001734822818
Epoch: 4 cost time: 5.944659948348999
Epoch: 4, Steps: 1027 | Train Loss: 0.4652350 Vali Loss: 0.3915825 Best vali loss: 0.3740996
	iters: 100, epoch: 5 | loss: 0.9862841
	speed: 0.0211s/iter; left time: 84.7835s
	iters: 200, epoch: 5 | loss: 0.4526046
	speed: 0.0056s/iter; left time: 22.0433s
	iters: 300, epoch: 5 | loss: 0.3901860
	speed: 0.0061s/iter; left time: 23.3193s
	iters: 400, epoch: 5 | loss: 0.5448412
	speed: 0.0062s/iter; left time: 22.8436s
	iters: 500, epoch: 5 | loss: 0.8218415
	speed: 0.0060s/iter; left time: 21.5884s
	iters: 600, epoch: 5 | loss: 0.4618168
	speed: 0.0050s/iter; left time: 17.6995s
	iters: 700, epoch: 5 | loss: 0.3517716
	speed: 0.0052s/iter; left time: 17.7088s
	iters: 800, epoch: 5 | loss: 0.8130221
	speed: 0.0058s/iter; left time: 19.1128s
	iters: 900, epoch: 5 | loss: 0.1565009
	speed: 0.0056s/iter; left time: 17.8988s
	iters: 1000, epoch: 5 | loss: 0.2881755
	speed: 0.0060s/iter; left time: 18.6343s
Updating learning rate to 0.00010709348674624827
Epoch: 5 cost time: 5.920635223388672
Epoch: 5, Steps: 1027 | Train Loss: 0.5267044 Vali Loss: 0.3979533 Best vali loss: 0.3740996
	iters: 100, epoch: 6 | loss: 0.5906841
	speed: 0.0242s/iter; left time: 72.0404s
	iters: 200, epoch: 6 | loss: 1.2360239
	speed: 0.0061s/iter; left time: 17.5462s
	iters: 300, epoch: 6 | loss: 0.5530714
	speed: 0.0063s/iter; left time: 17.5517s
	iters: 400, epoch: 6 | loss: 0.2535684
	speed: 0.0056s/iter; left time: 15.0611s
	iters: 500, epoch: 6 | loss: 0.2877552
	speed: 0.0058s/iter; left time: 14.9313s
	iters: 600, epoch: 6 | loss: 0.3104987
	speed: 0.0060s/iter; left time: 15.0089s
	iters: 700, epoch: 6 | loss: 0.1654577
	speed: 0.0061s/iter; left time: 14.5001s
	iters: 800, epoch: 6 | loss: 0.7240562
	speed: 0.0060s/iter; left time: 13.5964s
	iters: 900, epoch: 6 | loss: 0.2183118
	speed: 0.0060s/iter; left time: 13.1656s
	iters: 1000, epoch: 6 | loss: 0.3026741
	speed: 0.0054s/iter; left time: 11.2871s
Updating learning rate to 5.081178392350444e-05
Epoch: 6 cost time: 6.141934394836426
Epoch: 6, Steps: 1027 | Train Loss: 0.4642101 Vali Loss: 0.4168459 Best vali loss: 0.3740996
	iters: 100, epoch: 7 | loss: 0.3555615
	speed: 0.0197s/iter; left time: 38.5371s
	iters: 200, epoch: 7 | loss: 0.4811362
	speed: 0.0042s/iter; left time: 7.7233s
	iters: 300, epoch: 7 | loss: 0.7576053
	speed: 0.0067s/iter; left time: 11.7247s
	iters: 400, epoch: 7 | loss: 0.2098583
	speed: 0.0059s/iter; left time: 9.8265s
	iters: 500, epoch: 7 | loss: 0.7086815
	speed: 0.0057s/iter; left time: 8.8935s
	iters: 600, epoch: 7 | loss: 0.2213424
	speed: 0.0065s/iter; left time: 9.5233s
	iters: 700, epoch: 7 | loss: 0.2377041
	speed: 0.0039s/iter; left time: 5.3386s
	iters: 800, epoch: 7 | loss: 0.3576028
	speed: 0.0039s/iter; left time: 4.8814s
	iters: 900, epoch: 7 | loss: 0.6144671
	speed: 0.0065s/iter; left time: 7.4868s
	iters: 1000, epoch: 7 | loss: 0.2769686
	speed: 0.0072s/iter; left time: 7.5773s
Updating learning rate to 1.3205552391624692e-05
Epoch: 7 cost time: 5.758189916610718
Epoch: 7, Steps: 1027 | Train Loss: 0.4220928 Vali Loss: 0.4137045 Best vali loss: 0.3740996
	iters: 100, epoch: 8 | loss: 0.1926919
	speed: 0.0250s/iter; left time: 23.2188s
	iters: 200, epoch: 8 | loss: 0.5948513
	speed: 0.0056s/iter; left time: 4.6503s
	iters: 300, epoch: 8 | loss: 0.3064086
	speed: 0.0039s/iter; left time: 2.8086s
	iters: 400, epoch: 8 | loss: 0.6126982
	speed: 0.0040s/iter; left time: 2.4983s
	iters: 500, epoch: 8 | loss: 0.2432003
	speed: 0.0048s/iter; left time: 2.5269s
	iters: 600, epoch: 8 | loss: 0.2376956
	speed: 0.0059s/iter; left time: 2.5184s
	iters: 700, epoch: 8 | loss: 0.2137593
	speed: 0.0059s/iter; left time: 1.9334s
	iters: 800, epoch: 8 | loss: 0.1758885
	speed: 0.0058s/iter; left time: 1.3278s
	iters: 900, epoch: 8 | loss: 0.4758865
	speed: 0.0055s/iter; left time: 0.6999s
	iters: 1000, epoch: 8 | loss: 0.3786269
	speed: 0.0054s/iter; left time: 0.1505s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.52022123336792
Epoch: 8, Steps: 1027 | Train Loss: 0.3431707 Vali Loss: 0.4123097 Best vali loss: 0.3740996

best validation loss 0.37409958009752636

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.010056622218, 'e_layers': 4, 'learning_rate': 0.0005903490783, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005903490783
Validation loss decreased (inf --> 0.3912).  Saving model state dict ...
Epoch: 1 cost time: 1.1510944366455078
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3912111 Best vali loss: 0.3912111
Updating learning rate to 0.00029517453915
Validation loss decreased (0.3912 --> 0.3766).  Saving model state dict ...
Epoch: 2 cost time: 0.8280322551727295
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3766094 Best vali loss: 0.3766094
Updating learning rate to 0.000147587269575
Validation loss decreased (0.3766 --> 0.3705).  Saving model state dict ...
Epoch: 3 cost time: 0.8083357810974121
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3704501 Best vali loss: 0.3704501

best validation loss 0.3704500959055363

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0008236849278, 'e_layers': 4, 'learning_rate': 0.0005271398534, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4135766
	speed: 0.0157s/iter; left time: 62.8793s
	iters: 200, epoch: 1 | loss: 0.6638604
	speed: 0.0106s/iter; left time: 41.6704s
	iters: 300, epoch: 1 | loss: 0.8988768
	speed: 0.0118s/iter; left time: 44.9646s
	iters: 400, epoch: 1 | loss: 1.4827881
	speed: 0.0116s/iter; left time: 43.1934s
	iters: 500, epoch: 1 | loss: 0.9850633
	speed: 0.0115s/iter; left time: 41.5528s
Updating learning rate to 0.0005271398534
Validation loss decreased (inf --> 0.3687).  Saving model state dict ...
Epoch: 1 cost time: 5.979958772659302
Epoch: 1, Steps: 514 | Train Loss: 0.8888330 Vali Loss: 0.3686929 Best vali loss: 0.3686929
	iters: 100, epoch: 2 | loss: 0.3806455
	speed: 0.0221s/iter; left time: 77.4147s
	iters: 200, epoch: 2 | loss: 0.7513254
	speed: 0.0091s/iter; left time: 31.0141s
	iters: 300, epoch: 2 | loss: 0.4418856
	speed: 0.0122s/iter; left time: 40.3180s
	iters: 400, epoch: 2 | loss: 0.7872790
	speed: 0.0139s/iter; left time: 44.3330s
	iters: 500, epoch: 2 | loss: 0.5366529
	speed: 0.0139s/iter; left time: 43.1444s
Updating learning rate to 0.0002635699267
Epoch: 2 cost time: 6.304544448852539
Epoch: 2, Steps: 514 | Train Loss: 0.5795576 Vali Loss: 0.3735409 Best vali loss: 0.3686929
	iters: 100, epoch: 3 | loss: 0.5451192
	speed: 0.0402s/iter; left time: 119.9769s
	iters: 200, epoch: 3 | loss: 0.6332964
	speed: 0.0130s/iter; left time: 37.5217s
	iters: 300, epoch: 3 | loss: 0.8765395
	speed: 0.0137s/iter; left time: 38.1149s
	iters: 400, epoch: 3 | loss: 0.3257760
	speed: 0.0089s/iter; left time: 23.9516s
	iters: 500, epoch: 3 | loss: 0.4375948
	speed: 0.0124s/iter; left time: 32.1709s
Updating learning rate to 0.00013178496335
Epoch: 3 cost time: 6.485277891159058
Epoch: 3, Steps: 514 | Train Loss: 0.5636652 Vali Loss: 0.3806159 Best vali loss: 0.3686929

best validation loss 0.3686929204901918

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.008580376438, 'e_layers': 1, 'learning_rate': 0.0001718521032, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8468106
	speed: 0.0196s/iter; left time: 38.3555s
	iters: 200, epoch: 1 | loss: 0.8630784
	speed: 0.0131s/iter; left time: 24.2661s
Updating learning rate to 0.0001653113719827487
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 3.589538097381592
Epoch: 1, Steps: 257 | Train Loss: 0.8549445 Vali Loss: 0.3658229 Best vali loss: 0.3658229
	iters: 100, epoch: 2 | loss: 0.4587125
	speed: 0.0322s/iter; left time: 54.8128s
	iters: 200, epoch: 2 | loss: 0.8210060
	speed: 0.0121s/iter; left time: 19.3910s
Updating learning rate to 0.0001466849453669452
Validation loss decreased (0.3658 --> 0.3632).  Saving model state dict ...
Epoch: 2 cost time: 3.0865488052368164
Epoch: 2, Steps: 257 | Train Loss: 0.6398592 Vali Loss: 0.3631686 Best vali loss: 0.3631686
	iters: 100, epoch: 3 | loss: 0.5559063
	speed: 0.0348s/iter; left time: 50.2028s
	iters: 200, epoch: 3 | loss: 0.8761411
	speed: 0.0156s/iter; left time: 20.9388s
Updating learning rate to 0.00011880852795586783
Epoch: 3 cost time: 3.791412591934204
Epoch: 3, Steps: 257 | Train Loss: 0.7160237 Vali Loss: 0.3641007 Best vali loss: 0.3631686

best validation loss 0.3631686154072318

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.008580376438, 'e_layers': 1, 'learning_rate': 0.0001718521032, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8009152
	speed: 0.0178s/iter; left time: 21.0592s
	iters: 200, epoch: 4 | loss: 0.7963613
	speed: 0.0068s/iter; left time: 7.3968s
Updating learning rate to 8.59260516e-05
Epoch: 4 cost time: 2.5911786556243896
Epoch: 4, Steps: 257 | Train Loss: 0.7986383 Vali Loss: 0.3671783 Best vali loss: 0.3631686
	iters: 100, epoch: 5 | loss: 0.4487403
	speed: 0.0209s/iter; left time: 19.4353s
	iters: 200, epoch: 5 | loss: 0.7876397
	speed: 0.0110s/iter; left time: 9.1340s
Updating learning rate to 5.3043575244132195e-05
Epoch: 5 cost time: 2.9208691120147705
Epoch: 5, Steps: 257 | Train Loss: 0.6181900 Vali Loss: 0.3706687 Best vali loss: 0.3631686
	iters: 100, epoch: 6 | loss: 0.5085886
	speed: 0.0239s/iter; left time: 16.0834s
	iters: 200, epoch: 6 | loss: 0.8470243
	speed: 0.0099s/iter; left time: 5.6400s
Updating learning rate to 2.5167157833054814e-05
Epoch: 6 cost time: 2.3540031909942627
Epoch: 6, Steps: 257 | Train Loss: 0.6778064 Vali Loss: 0.3714545 Best vali loss: 0.3631686
	iters: 100, epoch: 7 | loss: 0.6236101
	speed: 0.0299s/iter; left time: 12.3937s
	iters: 200, epoch: 7 | loss: 0.4595911
	speed: 0.0100s/iter; left time: 3.1495s
Updating learning rate to 6.5407312172512985e-06
Epoch: 7 cost time: 3.038792133331299
Epoch: 7, Steps: 257 | Train Loss: 0.5416006 Vali Loss: 0.3739258 Best vali loss: 0.3631686
	iters: 100, epoch: 8 | loss: 0.7809650
	speed: 0.0271s/iter; left time: 4.2855s
	iters: 200, epoch: 8 | loss: 0.5143193
	speed: 0.0120s/iter; left time: 0.6953s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0578410625457764
Epoch: 8, Steps: 257 | Train Loss: 0.6476421 Vali Loss: 0.3740944 Best vali loss: 0.3631686

best validation loss 0.3631686154072318

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0011159986324, 'e_layers': 1, 'learning_rate': 0.0012468667758, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0012468667758
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.6722822189331055
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3690808 Best vali loss: 0.3690808
Updating learning rate to 0.0006234333879
Validation loss decreased (0.3691 --> 0.3678).  Saving model state dict ...
Epoch: 2 cost time: 0.9700219631195068
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3677640 Best vali loss: 0.3677640
Updating learning rate to 0.00031171669395
Epoch: 3 cost time: 1.1048674583435059
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3697087 Best vali loss: 0.3677640
Updating learning rate to 0.000155858346975
Epoch: 4 cost time: 1.2156760692596436
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3713677 Best vali loss: 0.3677640
Updating learning rate to 7.79291734875e-05
Epoch: 5 cost time: 0.9774246215820312
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3717325 Best vali loss: 0.3677640
Updating learning rate to 3.896458674375e-05
Epoch: 6 cost time: 1.591407060623169
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3711789 Best vali loss: 0.3677640
Updating learning rate to 1.9482293371875e-05
Epoch: 7 cost time: 0.9809761047363281
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3744140 Best vali loss: 0.3677640
Updating learning rate to 9.7411466859375e-06
Epoch: 8 cost time: 0.9989724159240723
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3721508 Best vali loss: 0.3677640

best validation loss 0.3677639508411317

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5753565
	speed: 0.0160s/iter; left time: 64.3401s
	iters: 200, epoch: 1 | loss: 0.3621132
	speed: 0.0089s/iter; left time: 34.9780s
	iters: 300, epoch: 1 | loss: 0.6700625
	speed: 0.0098s/iter; left time: 37.4275s
	iters: 400, epoch: 1 | loss: 0.7110271
	speed: 0.0096s/iter; left time: 35.7008s
	iters: 500, epoch: 1 | loss: 0.8176793
	speed: 0.0080s/iter; left time: 29.0171s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 5.0377421379089355
Epoch: 1, Steps: 514 | Train Loss: 0.6272477 Vali Loss: 0.3697221 Best vali loss: 0.3697221
	iters: 100, epoch: 2 | loss: 0.5795566
	speed: 0.0170s/iter; left time: 59.5023s
	iters: 200, epoch: 2 | loss: 0.4003554
	speed: 0.0090s/iter; left time: 30.5718s
	iters: 300, epoch: 2 | loss: 0.3921636
	speed: 0.0095s/iter; left time: 31.3946s
	iters: 400, epoch: 2 | loss: 0.6489633
	speed: 0.0092s/iter; left time: 29.3386s
	iters: 500, epoch: 2 | loss: 1.3377185
	speed: 0.0096s/iter; left time: 29.6248s
Updating learning rate to 0.0007540331008505288
Epoch: 2 cost time: 4.725373268127441
Epoch: 2, Steps: 514 | Train Loss: 0.6717515 Vali Loss: 0.3896063 Best vali loss: 0.3697221
	iters: 100, epoch: 3 | loss: 0.5316042
	speed: 0.0193s/iter; left time: 57.6163s
	iters: 200, epoch: 3 | loss: 0.6885605
	speed: 0.0085s/iter; left time: 24.5700s
	iters: 300, epoch: 3 | loss: 1.1583883
	speed: 0.0094s/iter; left time: 26.0431s
	iters: 400, epoch: 3 | loss: 0.3672598
	speed: 0.0098s/iter; left time: 26.3852s
	iters: 500, epoch: 3 | loss: 0.9813375
	speed: 0.0097s/iter; left time: 25.0112s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 4.819316625595093
Epoch: 3, Steps: 514 | Train Loss: 0.7454301 Vali Loss: 0.3843596 Best vali loss: 0.3697221
	iters: 100, epoch: 4 | loss: 0.6158549
	speed: 0.0199s/iter; left time: 49.1705s
	iters: 200, epoch: 4 | loss: 1.0997256
	speed: 0.0084s/iter; left time: 20.0281s
	iters: 300, epoch: 4 | loss: 0.6935261
	speed: 0.0089s/iter; left time: 20.3076s
	iters: 400, epoch: 4 | loss: 0.3549622
	speed: 0.0095s/iter; left time: 20.7209s
	iters: 500, epoch: 4 | loss: 0.4301768
	speed: 0.0093s/iter; left time: 19.3193s
Updating learning rate to 0.000441702364
Epoch: 4 cost time: 4.754580736160278
Epoch: 4, Steps: 514 | Train Loss: 0.6388491 Vali Loss: 0.3880376 Best vali loss: 0.3697221
	iters: 100, epoch: 5 | loss: 0.4631670
	speed: 0.0203s/iter; left time: 39.6520s
	iters: 200, epoch: 5 | loss: 0.2757644
	speed: 0.0088s/iter; left time: 16.3259s
	iters: 300, epoch: 5 | loss: 0.5571992
	speed: 0.0091s/iter; left time: 16.0144s
	iters: 400, epoch: 5 | loss: 0.4504987
	speed: 0.0083s/iter; left time: 13.8286s
	iters: 500, epoch: 5 | loss: 1.2112800
	speed: 0.0092s/iter; left time: 14.3660s
Updating learning rate to 0.0002726701872607057
Epoch: 5 cost time: 4.7206525802612305
Epoch: 5, Steps: 514 | Train Loss: 0.5915819 Vali Loss: 0.3953532 Best vali loss: 0.3697221
	iters: 100, epoch: 6 | loss: 0.6373432
	speed: 0.0327s/iter; left time: 47.1960s
	iters: 200, epoch: 6 | loss: 0.4919960
	speed: 0.0113s/iter; left time: 15.2274s
	iters: 300, epoch: 6 | loss: 0.7264081
	speed: 0.0106s/iter; left time: 13.2261s
	iters: 400, epoch: 6 | loss: 0.7342198
	speed: 0.0072s/iter; left time: 8.1801s
	iters: 500, epoch: 6 | loss: 0.4924043
	speed: 0.0083s/iter; left time: 8.6154s
Updating learning rate to 0.00012937162714947125
Epoch: 6 cost time: 5.044443368911743
Epoch: 6, Steps: 514 | Train Loss: 0.6164743 Vali Loss: 0.4019984 Best vali loss: 0.3697221
	iters: 100, epoch: 7 | loss: 0.8098358
	speed: 0.0184s/iter; left time: 17.1216s
	iters: 200, epoch: 7 | loss: 0.2575668
	speed: 0.0084s/iter; left time: 6.9876s
	iters: 300, epoch: 7 | loss: 0.3021841
	speed: 0.0077s/iter; left time: 5.5968s
	iters: 400, epoch: 7 | loss: 0.3122880
	speed: 0.0079s/iter; left time: 4.9408s
	iters: 500, epoch: 7 | loss: 0.3124905
	speed: 0.0086s/iter; left time: 4.5653s
Updating learning rate to 3.362259043854979e-05
Epoch: 7 cost time: 4.276834011077881
Epoch: 7, Steps: 514 | Train Loss: 0.3988730 Vali Loss: 0.3957466 Best vali loss: 0.3697221
	iters: 100, epoch: 8 | loss: 0.3741978
	speed: 0.0182s/iter; left time: 7.5336s
	iters: 200, epoch: 8 | loss: 0.8010507
	speed: 0.0084s/iter; left time: 2.6494s
	iters: 300, epoch: 8 | loss: 0.4424101
	speed: 0.0081s/iter; left time: 1.7476s
	iters: 400, epoch: 8 | loss: 0.9252896
	speed: 0.0079s/iter; left time: 0.9035s
	iters: 500, epoch: 8 | loss: 0.2913956
	speed: 0.0087s/iter; left time: 0.1311s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.337324857711792
Epoch: 8, Steps: 514 | Train Loss: 0.5668688 Vali Loss: 0.3985973 Best vali loss: 0.3697221

best validation loss 0.36972211292544144

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011419754009, 'e_layers': 4, 'learning_rate': 0.0041132147357, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6454911
	speed: 0.0173s/iter; left time: 33.8323s
	iters: 200, epoch: 1 | loss: 0.7393472
	speed: 0.0114s/iter; left time: 21.0790s
Updating learning rate to 0.0041132147357
Validation loss decreased (inf --> 0.3794).  Saving model state dict ...
Epoch: 1 cost time: 3.1238279342651367
Epoch: 1, Steps: 257 | Train Loss: 0.6924191 Vali Loss: 0.3794212 Best vali loss: 0.3794212
	iters: 100, epoch: 2 | loss: 0.8961949
	speed: 0.0160s/iter; left time: 27.1364s
	iters: 200, epoch: 2 | loss: 0.4932216
	speed: 0.0076s/iter; left time: 12.0845s
Updating learning rate to 0.00205660736785
Validation loss decreased (0.3794 --> 0.3789).  Saving model state dict ...
Epoch: 2 cost time: 1.9544646739959717
Epoch: 2, Steps: 257 | Train Loss: 0.6947083 Vali Loss: 0.3789080 Best vali loss: 0.3789080
	iters: 100, epoch: 3 | loss: 0.5745607
	speed: 0.0196s/iter; left time: 28.2426s
	iters: 200, epoch: 3 | loss: 0.5656450
	speed: 0.0093s/iter; left time: 12.4623s
Updating learning rate to 0.001028303683925
Validation loss decreased (0.3789 --> 0.3747).  Saving model state dict ...
Epoch: 3 cost time: 2.554816961288452
Epoch: 3, Steps: 257 | Train Loss: 0.5701028 Vali Loss: 0.3747166 Best vali loss: 0.3747166

best validation loss 0.3747165701946716

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012820365822, 'e_layers': 4, 'learning_rate': 0.000140448495, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5762572
	speed: 0.0241s/iter; left time: 96.5959s
	iters: 200, epoch: 1 | loss: 0.9162722
	speed: 0.0156s/iter; left time: 61.1219s
	iters: 300, epoch: 1 | loss: 1.3813939
	speed: 0.0162s/iter; left time: 61.6912s
	iters: 400, epoch: 1 | loss: 0.4728646
	speed: 0.0153s/iter; left time: 56.8879s
	iters: 500, epoch: 1 | loss: 0.3978070
	speed: 0.0155s/iter; left time: 56.1193s
Updating learning rate to 0.0001351029924512569
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 8.580084562301636
Epoch: 1, Steps: 514 | Train Loss: 0.7489190 Vali Loss: 0.3656759 Best vali loss: 0.3656759
	iters: 100, epoch: 2 | loss: 0.4374253
	speed: 0.0600s/iter; left time: 209.8869s
	iters: 200, epoch: 2 | loss: 0.4026975
	speed: 0.0163s/iter; left time: 55.4026s
	iters: 300, epoch: 2 | loss: 1.0552167
	speed: 0.0113s/iter; left time: 37.3720s
	iters: 400, epoch: 2 | loss: 0.4807716
	speed: 0.0107s/iter; left time: 34.1658s
	iters: 500, epoch: 2 | loss: 0.2160125
	speed: 0.0092s/iter; left time: 28.5209s
Updating learning rate to 0.00011988028911097245
Epoch: 2 cost time: 6.5207390785217285
Epoch: 2, Steps: 514 | Train Loss: 0.5184247 Vali Loss: 0.3678101 Best vali loss: 0.3656759
	iters: 100, epoch: 3 | loss: 0.9966368
	speed: 0.0203s/iter; left time: 60.6790s
	iters: 200, epoch: 3 | loss: 0.6582906
	speed: 0.0101s/iter; left time: 29.1671s
	iters: 300, epoch: 3 | loss: 0.4279028
	speed: 0.0106s/iter; left time: 29.6055s
	iters: 400, epoch: 3 | loss: 0.8002801
	speed: 0.0107s/iter; left time: 28.7292s
	iters: 500, epoch: 3 | loss: 0.2557090
	speed: 0.0122s/iter; left time: 31.5085s
Updating learning rate to 9.709790356855557e-05
Validation loss decreased (0.3657 --> 0.3643).  Saving model state dict ...
Epoch: 3 cost time: 5.593742370605469
Epoch: 3, Steps: 514 | Train Loss: 0.6277638 Vali Loss: 0.3642518 Best vali loss: 0.3642518

best validation loss 0.36425179426937065

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0040861671799, 'e_layers': 4, 'learning_rate': 0.000304682777, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4249645
	speed: 0.0164s/iter; left time: 65.8324s
	iters: 200, epoch: 1 | loss: 0.5879515
	speed: 0.0103s/iter; left time: 40.2026s
	iters: 300, epoch: 1 | loss: 0.3634389
	speed: 0.0101s/iter; left time: 38.4500s
	iters: 400, epoch: 1 | loss: 0.2759144
	speed: 0.0103s/iter; left time: 38.3173s
	iters: 500, epoch: 1 | loss: 0.6219049
	speed: 0.0101s/iter; left time: 36.4441s
Updating learning rate to 0.0002930864792895003
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 5.570966958999634
Epoch: 1, Steps: 514 | Train Loss: 0.6548348 Vali Loss: 0.3663070 Best vali loss: 0.3663070
	iters: 100, epoch: 2 | loss: 0.2927527
	speed: 0.0201s/iter; left time: 70.2745s
	iters: 200, epoch: 2 | loss: 0.7187141
	speed: 0.0110s/iter; left time: 37.5116s
	iters: 300, epoch: 2 | loss: 0.4997379
	speed: 0.0112s/iter; left time: 36.8717s
	iters: 400, epoch: 2 | loss: 0.6944174
	speed: 0.0102s/iter; left time: 32.5843s
	iters: 500, epoch: 2 | loss: 0.4622576
	speed: 0.0098s/iter; left time: 30.4637s
Updating learning rate to 0.00026006301736372433
Epoch: 2 cost time: 5.437639951705933
Epoch: 2, Steps: 514 | Train Loss: 0.5335760 Vali Loss: 0.3695643 Best vali loss: 0.3663070
	iters: 100, epoch: 3 | loss: 0.7823398
	speed: 0.0198s/iter; left time: 59.0477s
	iters: 200, epoch: 3 | loss: 0.9984601
	speed: 0.0102s/iter; left time: 29.3346s
	iters: 300, epoch: 3 | loss: 0.4408313
	speed: 0.0088s/iter; left time: 24.4197s
	iters: 400, epoch: 3 | loss: 0.6066986
	speed: 0.0092s/iter; left time: 24.6174s
	iters: 500, epoch: 3 | loss: 0.7610742
	speed: 0.0099s/iter; left time: 25.6674s
Updating learning rate to 0.00021063991394244363
Validation loss decreased (0.3663 --> 0.3622).  Saving model state dict ...
Epoch: 3 cost time: 5.020303964614868
Epoch: 3, Steps: 514 | Train Loss: 0.7178808 Vali Loss: 0.3621648 Best vali loss: 0.3621648

best validation loss 0.362164754571287

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0040861671799, 'e_layers': 4, 'learning_rate': 0.000304682777, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1023096
	speed: 0.0173s/iter; left time: 42.8153s
	iters: 200, epoch: 4 | loss: 0.5559167
	speed: 0.0075s/iter; left time: 17.7999s
	iters: 300, epoch: 4 | loss: 0.3318526
	speed: 0.0099s/iter; left time: 22.5766s
	iters: 400, epoch: 4 | loss: 0.2917901
	speed: 0.0096s/iter; left time: 20.7713s
	iters: 500, epoch: 4 | loss: 0.5898552
	speed: 0.0087s/iter; left time: 18.0256s
Updating learning rate to 0.0001523413885
Validation loss decreased (0.3622 --> 0.3620).  Saving model state dict ...
Epoch: 4 cost time: 5.034369945526123
Epoch: 4, Steps: 514 | Train Loss: 0.5743448 Vali Loss: 0.3620138 Best vali loss: 0.3620138
	iters: 100, epoch: 5 | loss: 0.2736560
	speed: 0.0191s/iter; left time: 37.3896s
	iters: 200, epoch: 5 | loss: 0.5870105
	speed: 0.0098s/iter; left time: 18.1931s
	iters: 300, epoch: 5 | loss: 0.4827200
	speed: 0.0100s/iter; left time: 17.6489s
	iters: 400, epoch: 5 | loss: 0.6463612
	speed: 0.0098s/iter; left time: 16.2490s
	iters: 500, epoch: 5 | loss: 0.3708943
	speed: 0.0092s/iter; left time: 14.3572s
Updating learning rate to 9.404286305755639e-05
Validation loss decreased (0.3620 --> 0.3619).  Saving model state dict ...
Epoch: 5 cost time: 5.080245018005371
Epoch: 5, Steps: 514 | Train Loss: 0.4721284 Vali Loss: 0.3618673 Best vali loss: 0.3618673
	iters: 100, epoch: 6 | loss: 0.7453557
	speed: 0.0198s/iter; left time: 28.6040s
	iters: 200, epoch: 6 | loss: 0.7578096
	speed: 0.0102s/iter; left time: 13.7224s
	iters: 300, epoch: 6 | loss: 0.3879181
	speed: 0.0094s/iter; left time: 11.7293s
	iters: 400, epoch: 6 | loss: 0.5301378
	speed: 0.0097s/iter; left time: 11.0991s
	iters: 500, epoch: 6 | loss: 0.7559999
	speed: 0.0099s/iter; left time: 10.3307s
Updating learning rate to 4.4619759636275684e-05
Validation loss decreased (0.3619 --> 0.3575).  Saving model state dict ...
Epoch: 6 cost time: 5.114171028137207
Epoch: 6, Steps: 514 | Train Loss: 0.6354442 Vali Loss: 0.3574838 Best vali loss: 0.3574838
	iters: 100, epoch: 7 | loss: 0.7503697
	speed: 0.0189s/iter; left time: 17.5977s
	iters: 200, epoch: 7 | loss: 0.7871628
	speed: 0.0091s/iter; left time: 7.5714s
	iters: 300, epoch: 7 | loss: 0.3251416
	speed: 0.0075s/iter; left time: 5.5039s
	iters: 400, epoch: 7 | loss: 0.6701827
	speed: 0.0099s/iter; left time: 6.2426s
	iters: 500, epoch: 7 | loss: 0.3170843
	speed: 0.0098s/iter; left time: 5.2027s
Updating learning rate to 1.1596297710499687e-05
Epoch: 7 cost time: 4.73558235168457
Epoch: 7, Steps: 514 | Train Loss: 0.5699882 Vali Loss: 0.3611684 Best vali loss: 0.3574838
	iters: 100, epoch: 8 | loss: 0.8672644
	speed: 0.0205s/iter; left time: 8.5212s
	iters: 200, epoch: 8 | loss: 0.2449137
	speed: 0.0088s/iter; left time: 2.7763s
	iters: 300, epoch: 8 | loss: 0.5197166
	speed: 0.0099s/iter; left time: 2.1350s
	iters: 400, epoch: 8 | loss: 0.5290763
	speed: 0.0099s/iter; left time: 1.1374s
	iters: 500, epoch: 8 | loss: 0.4433907
	speed: 0.0095s/iter; left time: 0.1425s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.942367076873779
Epoch: 8, Steps: 514 | Train Loss: 0.5208723 Vali Loss: 0.3631129 Best vali loss: 0.3574838

best validation loss 0.3574837895940938

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011400086869, 'e_layers': 3, 'learning_rate': 0.0005612978124, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7341788
	speed: 0.0139s/iter; left time: 12.9767s
Updating learning rate to 0.0005612978124
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.2724635601043701
Epoch: 1, Steps: 129 | Train Loss: 0.7341788 Vali Loss: 0.3709602 Best vali loss: 0.3709602
	iters: 100, epoch: 2 | loss: 0.6005058
	speed: 0.0232s/iter; left time: 18.6599s
Updating learning rate to 0.0002806489062
Validation loss decreased (0.3710 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 2.3180525302886963
Epoch: 2, Steps: 129 | Train Loss: 0.6005058 Vali Loss: 0.3667149 Best vali loss: 0.3667149
	iters: 100, epoch: 3 | loss: 0.4475787
	speed: 0.0344s/iter; left time: 23.2324s
Updating learning rate to 0.0001403244531
Epoch: 3 cost time: 2.280362367630005
Epoch: 3, Steps: 129 | Train Loss: 0.4475787 Vali Loss: 0.3727206 Best vali loss: 0.3667149
	iters: 100, epoch: 4 | loss: 0.5547981
	speed: 0.0313s/iter; left time: 17.0807s
Updating learning rate to 7.016222655e-05
Epoch: 4 cost time: 2.2160804271698
Epoch: 4, Steps: 129 | Train Loss: 0.5547981 Vali Loss: 0.3701078 Best vali loss: 0.3667149
	iters: 100, epoch: 5 | loss: 0.6529784
	speed: 0.0331s/iter; left time: 13.8076s
Updating learning rate to 3.5081113275e-05
Epoch: 5 cost time: 2.550778865814209
Epoch: 5, Steps: 129 | Train Loss: 0.6529784 Vali Loss: 0.3686373 Best vali loss: 0.3667149
	iters: 100, epoch: 6 | loss: 0.5633902
	speed: 0.0280s/iter; left time: 8.0774s
Updating learning rate to 1.75405566375e-05
Epoch: 6 cost time: 1.8614730834960938
Epoch: 6, Steps: 129 | Train Loss: 0.5633902 Vali Loss: 0.3677608 Best vali loss: 0.3667149
	iters: 100, epoch: 7 | loss: 0.5463954
	speed: 0.0269s/iter; left time: 4.2694s
Updating learning rate to 8.77027831875e-06
Epoch: 7 cost time: 2.7031047344207764
Epoch: 7, Steps: 129 | Train Loss: 0.5463954 Vali Loss: 0.3679286 Best vali loss: 0.3667149
	iters: 100, epoch: 8 | loss: 0.5386567
	speed: 0.0315s/iter; left time: 0.9440s
Updating learning rate to 4.385139159375e-06
Epoch: 8 cost time: 2.4935760498046875
Epoch: 8, Steps: 129 | Train Loss: 0.5386567 Vali Loss: 0.3681763 Best vali loss: 0.3667149

best validation loss 0.3667148850521545

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0048859156977, 'e_layers': 4, 'learning_rate': 7.7601951e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4590163
	speed: 0.0191s/iter; left time: 76.6086s
	iters: 200, epoch: 1 | loss: 0.6352499
	speed: 0.0120s/iter; left time: 47.1486s
	iters: 300, epoch: 1 | loss: 1.2226250
	speed: 0.0087s/iter; left time: 33.0671s
	iters: 400, epoch: 1 | loss: 0.5931667
	speed: 0.0127s/iter; left time: 47.2738s
	iters: 500, epoch: 1 | loss: 0.7782110
	speed: 0.0132s/iter; left time: 47.7961s
Updating learning rate to 7.464840260592189e-05
Validation loss decreased (inf --> 0.3637).  Saving model state dict ...
Epoch: 1 cost time: 6.429025888442993
Epoch: 1, Steps: 514 | Train Loss: 0.7376538 Vali Loss: 0.3636692 Best vali loss: 0.3636692
	iters: 100, epoch: 2 | loss: 0.6926468
	speed: 0.0435s/iter; left time: 152.0764s
	iters: 200, epoch: 2 | loss: 0.5272378
	speed: 0.0129s/iter; left time: 43.9747s
	iters: 300, epoch: 2 | loss: 0.6738645
	speed: 0.0133s/iter; left time: 43.7860s
	iters: 400, epoch: 2 | loss: 0.7756371
	speed: 0.0112s/iter; left time: 35.8849s
	iters: 500, epoch: 2 | loss: 0.3388881
	speed: 0.0126s/iter; left time: 39.0074s
Updating learning rate to 6.623740839270309e-05
Epoch: 2 cost time: 6.507558822631836
Epoch: 2, Steps: 514 | Train Loss: 0.6016549 Vali Loss: 0.3676720 Best vali loss: 0.3636692
	iters: 100, epoch: 3 | loss: 0.4258934
	speed: 0.0237s/iter; left time: 70.6111s
	iters: 200, epoch: 3 | loss: 0.6973028
	speed: 0.0096s/iter; left time: 27.5769s
	iters: 300, epoch: 3 | loss: 0.7909817
	speed: 0.0084s/iter; left time: 23.3718s
	iters: 400, epoch: 3 | loss: 0.9011502
	speed: 0.0086s/iter; left time: 23.0302s
	iters: 500, epoch: 3 | loss: 0.6727300
	speed: 0.0111s/iter; left time: 28.7258s
Updating learning rate to 5.3649465983453756e-05
Epoch: 3 cost time: 4.890745401382446
Epoch: 3, Steps: 514 | Train Loss: 0.6976116 Vali Loss: 0.3946669 Best vali loss: 0.3636692
	iters: 100, epoch: 4 | loss: 0.2899632
	speed: 0.0216s/iter; left time: 53.2871s
	iters: 200, epoch: 4 | loss: 0.5253064
	speed: 0.0110s/iter; left time: 25.9718s
	iters: 300, epoch: 4 | loss: 0.6713558
	speed: 0.0106s/iter; left time: 24.0913s
	iters: 400, epoch: 4 | loss: 0.3096279
	speed: 0.0111s/iter; left time: 24.0823s
	iters: 500, epoch: 4 | loss: 0.4858392
	speed: 0.0109s/iter; left time: 22.6481s
Updating learning rate to 3.88009755e-05
Epoch: 4 cost time: 5.639675855636597
Epoch: 4, Steps: 514 | Train Loss: 0.4564185 Vali Loss: 0.3795987 Best vali loss: 0.3636692
	iters: 100, epoch: 5 | loss: 0.6425813
	speed: 0.0208s/iter; left time: 40.6250s
	iters: 200, epoch: 5 | loss: 0.6547173
	speed: 0.0072s/iter; left time: 13.3398s
	iters: 300, epoch: 5 | loss: 0.2956188
	speed: 0.0096s/iter; left time: 16.8062s
	iters: 400, epoch: 5 | loss: 0.3984730
	speed: 0.0110s/iter; left time: 18.2677s
	iters: 500, epoch: 5 | loss: 0.3253891
	speed: 0.0111s/iter; left time: 17.2616s
Updating learning rate to 2.3952485016546247e-05
Validation loss decreased (0.3637 --> 0.3577).  Saving model state dict ...
Epoch: 5 cost time: 5.13809871673584
Epoch: 5, Steps: 514 | Train Loss: 0.4633559 Vali Loss: 0.3577203 Best vali loss: 0.3577203
	iters: 100, epoch: 6 | loss: 0.3043591
	speed: 0.0219s/iter; left time: 31.5586s
	iters: 200, epoch: 6 | loss: 0.2512249
	speed: 0.0110s/iter; left time: 14.7328s
	iters: 300, epoch: 6 | loss: 0.5301314
	speed: 0.0110s/iter; left time: 13.6363s
	iters: 400, epoch: 6 | loss: 0.7952878
	speed: 0.0111s/iter; left time: 12.7078s
	iters: 500, epoch: 6 | loss: 0.5421981
	speed: 0.0110s/iter; left time: 11.4536s
Updating learning rate to 1.1364542607296912e-05
Validation loss decreased (0.3577 --> 0.3541).  Saving model state dict ...
Epoch: 6 cost time: 5.687279939651489
Epoch: 6, Steps: 514 | Train Loss: 0.4846403 Vali Loss: 0.3541350 Best vali loss: 0.3541350
	iters: 100, epoch: 7 | loss: 0.3167081
	speed: 0.0222s/iter; left time: 20.5810s
	iters: 200, epoch: 7 | loss: 0.3271365
	speed: 0.0107s/iter; left time: 8.8948s
	iters: 300, epoch: 7 | loss: 0.8387613
	speed: 0.0110s/iter; left time: 7.9908s
	iters: 400, epoch: 7 | loss: 0.5565484
	speed: 0.0110s/iter; left time: 6.8968s
	iters: 500, epoch: 7 | loss: 0.2463373
	speed: 0.0107s/iter; left time: 5.6576s
Updating learning rate to 2.9535483940781098e-06
Epoch: 7 cost time: 5.639087438583374
Epoch: 7, Steps: 514 | Train Loss: 0.4570983 Vali Loss: 0.3784864 Best vali loss: 0.3541350
	iters: 100, epoch: 8 | loss: 0.3321261
	speed: 0.0161s/iter; left time: 6.6735s
	iters: 200, epoch: 8 | loss: 0.2857791
	speed: 0.0084s/iter; left time: 2.6554s
	iters: 300, epoch: 8 | loss: 0.7185922
	speed: 0.0107s/iter; left time: 2.2993s
	iters: 400, epoch: 8 | loss: 0.6695646
	speed: 0.0110s/iter; left time: 1.2703s
	iters: 500, epoch: 8 | loss: 0.2784559
	speed: 0.0111s/iter; left time: 0.1658s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.141563892364502
Epoch: 8, Steps: 514 | Train Loss: 0.4569036 Vali Loss: 0.3697627 Best vali loss: 0.3541350

best validation loss 0.3541350233414318

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022899640873, 'e_layers': 3, 'learning_rate': 0.0002283220047, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7444316
	speed: 0.0153s/iter; left time: 29.8812s
	iters: 200, epoch: 1 | loss: 0.6672791
	speed: 0.0116s/iter; left time: 21.5847s
Updating learning rate to 0.0002283220047
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 3.1664624214172363
Epoch: 1, Steps: 257 | Train Loss: 0.7058553 Vali Loss: 0.3677679 Best vali loss: 0.3677679
	iters: 100, epoch: 2 | loss: 0.6398462
	speed: 0.0342s/iter; left time: 58.2124s
	iters: 200, epoch: 2 | loss: 0.4355136
	speed: 0.0172s/iter; left time: 27.4742s
Updating learning rate to 0.00011416100235
Epoch: 2 cost time: 4.140551328659058
Epoch: 2, Steps: 257 | Train Loss: 0.5376799 Vali Loss: 0.3859038 Best vali loss: 0.3677679
	iters: 100, epoch: 3 | loss: 0.7769119
	speed: 0.0352s/iter; left time: 50.8576s
	iters: 200, epoch: 3 | loss: 0.4600959
	speed: 0.0134s/iter; left time: 18.0317s
Updating learning rate to 5.7080501175e-05
Epoch: 3 cost time: 3.4517154693603516
Epoch: 3, Steps: 257 | Train Loss: 0.6185039 Vali Loss: 0.3744641 Best vali loss: 0.3677679

best validation loss 0.3677678995493119

{'batch_size': 8, 'd_core': 64, 'd_model': 128, 'dropout': 0.0022567395576, 'e_layers': 4, 'learning_rate': 0.0017978874786, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9518177
	speed: 0.0158s/iter; left time: 128.5561s
	iters: 200, epoch: 1 | loss: 0.4485269
	speed: 0.0106s/iter; left time: 84.7287s
	iters: 300, epoch: 1 | loss: 0.2224929
	speed: 0.0104s/iter; left time: 82.4439s
	iters: 400, epoch: 1 | loss: 0.9303520
	speed: 0.0105s/iter; left time: 81.8917s
	iters: 500, epoch: 1 | loss: 1.6387210
	speed: 0.0099s/iter; left time: 76.4023s
	iters: 600, epoch: 1 | loss: 0.4938000
	speed: 0.0087s/iter; left time: 66.5391s
	iters: 700, epoch: 1 | loss: 1.4033591
	speed: 0.0102s/iter; left time: 76.4899s
	iters: 800, epoch: 1 | loss: 0.2026036
	speed: 0.0095s/iter; left time: 70.2929s
	iters: 900, epoch: 1 | loss: 0.3712875
	speed: 0.0098s/iter; left time: 71.6953s
	iters: 1000, epoch: 1 | loss: 0.4880615
	speed: 0.0105s/iter; left time: 75.4681s
Updating learning rate to 0.0017294594609184321
Validation loss decreased (inf --> 0.4008).  Saving model state dict ...
Epoch: 1 cost time: 10.52892518043518
Epoch: 1, Steps: 1027 | Train Loss: 0.7151022 Vali Loss: 0.4007843 Best vali loss: 0.4007843
	iters: 100, epoch: 2 | loss: 1.7991362
	speed: 0.0296s/iter; left time: 209.9970s
	iters: 200, epoch: 2 | loss: 0.5078592
	speed: 0.0106s/iter; left time: 74.1610s
	iters: 300, epoch: 2 | loss: 0.4527356
	speed: 0.0097s/iter; left time: 66.9158s
	iters: 400, epoch: 2 | loss: 0.4628373
	speed: 0.0090s/iter; left time: 61.2133s
	iters: 500, epoch: 2 | loss: 0.4828916
	speed: 0.0106s/iter; left time: 71.2405s
	iters: 600, epoch: 2 | loss: 0.5886409
	speed: 0.0102s/iter; left time: 66.9315s
	iters: 700, epoch: 2 | loss: 0.3276877
	speed: 0.0101s/iter; left time: 65.4926s
	iters: 800, epoch: 2 | loss: 0.2886554
	speed: 0.0106s/iter; left time: 67.4400s
	iters: 900, epoch: 2 | loss: 0.5178232
	speed: 0.0102s/iter; left time: 63.8798s
	iters: 1000, epoch: 2 | loss: 0.3618209
	speed: 0.0103s/iter; left time: 63.9597s
Updating learning rate to 0.0015345929532642219
Epoch: 2 cost time: 10.502626657485962
Epoch: 2, Steps: 1027 | Train Loss: 0.5790088 Vali Loss: 0.4025302 Best vali loss: 0.4007843
	iters: 100, epoch: 3 | loss: 0.3920727
	speed: 0.0258s/iter; left time: 156.5939s
	iters: 200, epoch: 3 | loss: 0.3138068
	speed: 0.0104s/iter; left time: 62.2101s
	iters: 300, epoch: 3 | loss: 0.3406533
	speed: 0.0083s/iter; left time: 48.8649s
	iters: 400, epoch: 3 | loss: 0.6258583
	speed: 0.0111s/iter; left time: 64.0872s
	iters: 500, epoch: 3 | loss: 1.1154708
	speed: 0.0133s/iter; left time: 75.4830s
	iters: 600, epoch: 3 | loss: 0.2973623
	speed: 0.0115s/iter; left time: 63.7951s
	iters: 700, epoch: 3 | loss: 0.9677042
	speed: 0.0171s/iter; left time: 93.6801s
	iters: 800, epoch: 3 | loss: 0.2366934
	speed: 0.0185s/iter; left time: 99.0033s
	iters: 900, epoch: 3 | loss: 0.3712460
	speed: 0.0147s/iter; left time: 77.1627s
	iters: 1000, epoch: 3 | loss: 0.2187587
	speed: 0.0140s/iter; left time: 72.4031s
Updating learning rate to 0.0012429546149584326
Epoch: 3 cost time: 13.340798139572144
Epoch: 3, Steps: 1027 | Train Loss: 0.4879626 Vali Loss: 0.4026687 Best vali loss: 0.4007843

best validation loss 0.40078434307120875

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0022985164426, 'e_layers': 1, 'learning_rate': 0.0001341069248, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012900278389537515
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 1.010847806930542
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3748766 Best vali loss: 0.3748766
Updating learning rate to 0.00011446742036507719
Validation loss decreased (0.3749 --> 0.3640).  Saving model state dict ...
Epoch: 2 cost time: 0.884357213973999
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3639981 Best vali loss: 0.3639981
Updating learning rate to 9.271371154319549e-05
Epoch: 3 cost time: 0.6829812526702881
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3642574 Best vali loss: 0.3639981

best validation loss 0.36399807990885436

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0022985164426, 'e_layers': 1, 'learning_rate': 0.0001341069248, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 6.70534624e-05
Epoch: 4 cost time: 1.0580320358276367
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3667969 Best vali loss: 0.3639981
Updating learning rate to 4.139321325680451e-05
Epoch: 5 cost time: 0.574444055557251
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3667676 Best vali loss: 0.3639981
Updating learning rate to 1.9639504434922814e-05
Epoch: 6 cost time: 0.6160104274749756
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3678732 Best vali loss: 0.3639981
Updating learning rate to 5.104140904624857e-06
Epoch: 7 cost time: 0.6321969032287598
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3684057 Best vali loss: 0.3639981
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6155991554260254
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3685465 Best vali loss: 0.3639981

best validation loss 0.36399807990885436

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0033642149727, 'e_layers': 1, 'learning_rate': 0.0023507902628, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6151046
	speed: 0.0154s/iter; left time: 14.3339s
Updating learning rate to 0.0023507902628
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 1.4979274272918701
Epoch: 1, Steps: 129 | Train Loss: 0.6151046 Vali Loss: 0.3667740 Best vali loss: 0.3667740
	iters: 100, epoch: 2 | loss: 0.8352260
	speed: 0.0148s/iter; left time: 11.9171s
Updating learning rate to 0.0011753951314
Epoch: 2 cost time: 1.1173245906829834
Epoch: 2, Steps: 129 | Train Loss: 0.8352260 Vali Loss: 0.3688374 Best vali loss: 0.3667740
	iters: 100, epoch: 3 | loss: 0.5734425
	speed: 0.0139s/iter; left time: 9.3839s
Updating learning rate to 0.0005876975657
Epoch: 3 cost time: 1.0371105670928955
Epoch: 3, Steps: 129 | Train Loss: 0.5734425 Vali Loss: 0.3853784 Best vali loss: 0.3667740
	iters: 100, epoch: 4 | loss: 0.6933905
	speed: 0.0133s/iter; left time: 7.2359s
Updating learning rate to 0.00029384878285
Epoch: 4 cost time: 1.0401360988616943
Epoch: 4, Steps: 129 | Train Loss: 0.6933905 Vali Loss: 0.3813356 Best vali loss: 0.3667740
	iters: 100, epoch: 5 | loss: 0.7123582
	speed: 0.0150s/iter; left time: 6.2505s
Updating learning rate to 0.000146924391425
Epoch: 5 cost time: 1.1045777797698975
Epoch: 5, Steps: 129 | Train Loss: 0.7123582 Vali Loss: 0.3844852 Best vali loss: 0.3667740
	iters: 100, epoch: 6 | loss: 0.6917411
	speed: 0.0086s/iter; left time: 2.4862s
Updating learning rate to 7.34621957125e-05
Epoch: 6 cost time: 0.6474237442016602
Epoch: 6, Steps: 129 | Train Loss: 0.6917411 Vali Loss: 0.3797189 Best vali loss: 0.3667740
	iters: 100, epoch: 7 | loss: 0.8314025
	speed: 0.0118s/iter; left time: 1.8787s
Updating learning rate to 3.673109785625e-05
Epoch: 7 cost time: 0.9745481014251709
Epoch: 7, Steps: 129 | Train Loss: 0.8314025 Vali Loss: 0.3830678 Best vali loss: 0.3667740
	iters: 100, epoch: 8 | loss: 0.5898150
	speed: 0.0118s/iter; left time: 0.3529s
Updating learning rate to 1.8365548928125e-05
Epoch: 8 cost time: 0.9342265129089355
Epoch: 8, Steps: 129 | Train Loss: 0.5898150 Vali Loss: 0.3818804 Best vali loss: 0.3667740

best validation loss 0.36677396367715714

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0065648019707, 'e_layers': 1, 'learning_rate': 8.73005964e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.397791529499427e-05
Validation loss decreased (inf --> 0.4277).  Saving model state dict ...
Epoch: 1 cost time: 0.9144511222839355
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4277360 Best vali loss: 0.4277360
Updating learning rate to 7.451572005803495e-05
Validation loss decreased (0.4277 --> 0.4126).  Saving model state dict ...
Epoch: 2 cost time: 0.7538437843322754
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4125932 Best vali loss: 0.4125932
Updating learning rate to 6.0354544138935704e-05
Validation loss decreased (0.4126 --> 0.4026).  Saving model state dict ...
Epoch: 3 cost time: 0.611095666885376
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4025500 Best vali loss: 0.4025500
Updating learning rate to 4.36502982e-05
Validation loss decreased (0.4026 --> 0.3962).  Saving model state dict ...
Epoch: 4 cost time: 0.6047532558441162
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3961509 Best vali loss: 0.3961509
Updating learning rate to 2.6946052261064304e-05
Validation loss decreased (0.3962 --> 0.3922).  Saving model state dict ...
Epoch: 5 cost time: 0.6094357967376709
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3922211 Best vali loss: 0.3922211
Updating learning rate to 1.2784876341965054e-05
Validation loss decreased (0.3922 --> 0.3901).  Saving model state dict ...
Epoch: 6 cost time: 0.6010110378265381
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3900696 Best vali loss: 0.3900696
Updating learning rate to 3.322681105005739e-06
Validation loss decreased (0.3901 --> 0.3891).  Saving model state dict ...
Epoch: 7 cost time: 0.5663278102874756
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3890771 Best vali loss: 0.3890771
Updating learning rate to 0.0
Validation loss decreased (0.3891 --> 0.3888).  Saving model state dict ...
Epoch: 8 cost time: 0.9052975177764893
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3888387 Best vali loss: 0.3888387

best validation loss 0.3888386528477922

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0056386129354, 'e_layers': 1, 'learning_rate': 0.003057829033, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4049522
	speed: 0.0149s/iter; left time: 59.9853s
	iters: 200, epoch: 1 | loss: 0.6361619
	speed: 0.0071s/iter; left time: 27.7355s
	iters: 300, epoch: 1 | loss: 0.3266382
	speed: 0.0084s/iter; left time: 32.0986s
	iters: 400, epoch: 1 | loss: 0.7335439
	speed: 0.0089s/iter; left time: 33.2158s
	iters: 500, epoch: 1 | loss: 0.7230832
	speed: 0.0100s/iter; left time: 36.2697s
Updating learning rate to 0.003057829033
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 4.764055490493774
Epoch: 1, Steps: 514 | Train Loss: 0.5648759 Vali Loss: 0.3685198 Best vali loss: 0.3685198
	iters: 100, epoch: 2 | loss: 0.4234049
	speed: 0.0243s/iter; left time: 85.0260s
	iters: 200, epoch: 2 | loss: 0.3956277
	speed: 0.0087s/iter; left time: 29.4748s
	iters: 300, epoch: 2 | loss: 1.5280524
	speed: 0.0066s/iter; left time: 21.6840s
	iters: 400, epoch: 2 | loss: 0.8479756
	speed: 0.0048s/iter; left time: 15.2884s
	iters: 500, epoch: 2 | loss: 0.7291462
	speed: 0.0071s/iter; left time: 21.8924s
Updating learning rate to 0.0015289145165
Epoch: 2 cost time: 3.762885332107544
Epoch: 2, Steps: 514 | Train Loss: 0.7848414 Vali Loss: 0.3817218 Best vali loss: 0.3685198
	iters: 100, epoch: 3 | loss: 0.4223425
	speed: 0.0260s/iter; left time: 77.6366s
	iters: 200, epoch: 3 | loss: 0.3499394
	speed: 0.0056s/iter; left time: 16.1637s
	iters: 300, epoch: 3 | loss: 0.4514126
	speed: 0.0055s/iter; left time: 15.1971s
	iters: 400, epoch: 3 | loss: 0.8000927
	speed: 0.0060s/iter; left time: 16.0334s
	iters: 500, epoch: 3 | loss: 0.5227715
	speed: 0.0060s/iter; left time: 15.4240s
Updating learning rate to 0.00076445725825
Epoch: 3 cost time: 3.187696695327759
Epoch: 3, Steps: 514 | Train Loss: 0.5093117 Vali Loss: 0.3726991 Best vali loss: 0.3685198

best validation loss 0.36851975029016054

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0009977413627, 'e_layers': 2, 'learning_rate': 0.000139137703, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8069698
	speed: 0.0124s/iter; left time: 11.5447s
Updating learning rate to 0.000139137703
Validation loss decreased (inf --> 0.4114).  Saving model state dict ...
Epoch: 1 cost time: 1.059730052947998
Epoch: 1, Steps: 129 | Train Loss: 0.8069698 Vali Loss: 0.4113626 Best vali loss: 0.4113626
	iters: 100, epoch: 2 | loss: 0.9625914
	speed: 0.0120s/iter; left time: 9.6570s
Updating learning rate to 6.95688515e-05
Validation loss decreased (0.4114 --> 0.3941).  Saving model state dict ...
Epoch: 2 cost time: 1.0993223190307617
Epoch: 2, Steps: 129 | Train Loss: 0.9625914 Vali Loss: 0.3940709 Best vali loss: 0.3940709
	iters: 100, epoch: 3 | loss: 0.6645430
	speed: 0.0147s/iter; left time: 9.9293s
Updating learning rate to 3.478442575e-05
Validation loss decreased (0.3941 --> 0.3889).  Saving model state dict ...
Epoch: 3 cost time: 1.1758623123168945
Epoch: 3, Steps: 129 | Train Loss: 0.6645430 Vali Loss: 0.3889391 Best vali loss: 0.3889391

best validation loss 0.3889391431522744

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008043881686, 'e_layers': 4, 'learning_rate': 0.0004018320868, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4915115
	speed: 0.0187s/iter; left time: 36.6714s
	iters: 200, epoch: 1 | loss: 0.5989163
	speed: 0.0116s/iter; left time: 21.6141s
Updating learning rate to 0.0004018320868
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 3.391636610031128
Epoch: 1, Steps: 257 | Train Loss: 0.5452139 Vali Loss: 0.3666269 Best vali loss: 0.3666269
	iters: 100, epoch: 2 | loss: 0.4776276
	speed: 0.0228s/iter; left time: 38.7361s
	iters: 200, epoch: 2 | loss: 0.6177512
	speed: 0.0102s/iter; left time: 16.2758s
Updating learning rate to 0.0002009160434
Epoch: 2 cost time: 2.7273218631744385
Epoch: 2, Steps: 257 | Train Loss: 0.5476894 Vali Loss: 0.3691067 Best vali loss: 0.3666269
	iters: 100, epoch: 3 | loss: 0.5236904
	speed: 0.0225s/iter; left time: 32.4838s
	iters: 200, epoch: 3 | loss: 0.3372720
	speed: 0.0114s/iter; left time: 15.2586s
Updating learning rate to 0.0001004580217
Epoch: 3 cost time: 2.968616008758545
Epoch: 3, Steps: 257 | Train Loss: 0.4304812 Vali Loss: 0.3826612 Best vali loss: 0.3666269

best validation loss 0.3666269348389039

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008043881686, 'e_layers': 4, 'learning_rate': 0.0004018320868, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4468061
	speed: 0.0192s/iter; left time: 22.8047s
	iters: 200, epoch: 4 | loss: 0.5268269
	speed: 0.0112s/iter; left time: 12.1366s
Updating learning rate to 5.022901085e-05
Validation loss decreased (0.3666 --> 0.3538).  Saving model state dict ...
Epoch: 4 cost time: 3.279069185256958
Epoch: 4, Steps: 257 | Train Loss: 0.4868165 Vali Loss: 0.3537621 Best vali loss: 0.3537621
	iters: 100, epoch: 5 | loss: 0.4606947
	speed: 0.0224s/iter; left time: 20.8186s
	iters: 200, epoch: 5 | loss: 0.5537955
	speed: 0.0115s/iter; left time: 9.5617s
Updating learning rate to 2.5114505425e-05
Epoch: 5 cost time: 3.2169222831726074
Epoch: 5, Steps: 257 | Train Loss: 0.5072451 Vali Loss: 0.3684101 Best vali loss: 0.3537621
	iters: 100, epoch: 6 | loss: 0.5029553
	speed: 0.0264s/iter; left time: 17.7711s
	iters: 200, epoch: 6 | loss: 0.3135068
	speed: 0.0113s/iter; left time: 6.4458s
Updating learning rate to 1.25572527125e-05
Epoch: 6 cost time: 2.955040216445923
Epoch: 6, Steps: 257 | Train Loss: 0.4082311 Vali Loss: 0.3614082 Best vali loss: 0.3537621
	iters: 100, epoch: 7 | loss: 0.2959702
	speed: 0.0231s/iter; left time: 9.5976s
	iters: 200, epoch: 7 | loss: 0.6179038
	speed: 0.0111s/iter; left time: 3.4831s
Updating learning rate to 6.27862635625e-06
Epoch: 7 cost time: 2.8999786376953125
Epoch: 7, Steps: 257 | Train Loss: 0.4569370 Vali Loss: 0.3630356 Best vali loss: 0.3537621
	iters: 100, epoch: 8 | loss: 0.8773496
	speed: 0.0216s/iter; left time: 3.4142s
	iters: 200, epoch: 8 | loss: 0.5188566
	speed: 0.0114s/iter; left time: 0.6627s
Updating learning rate to 3.139313178125e-06
Epoch: 8 cost time: 2.955850124359131
Epoch: 8, Steps: 257 | Train Loss: 0.6981031 Vali Loss: 0.3608075 Best vali loss: 0.3537621

best validation loss 0.35376205415060574

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0052896376836, 'e_layers': 4, 'learning_rate': 6.64499544e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9249209
	speed: 0.0180s/iter; left time: 72.1322s
	iters: 200, epoch: 1 | loss: 0.8666420
	speed: 0.0110s/iter; left time: 43.1612s
	iters: 300, epoch: 1 | loss: 0.7007247
	speed: 0.0116s/iter; left time: 44.2990s
	iters: 400, epoch: 1 | loss: 0.8189618
	speed: 0.0115s/iter; left time: 42.8805s
	iters: 500, epoch: 1 | loss: 0.8486497
	speed: 0.0115s/iter; left time: 41.6124s
Updating learning rate to 6.392085360323417e-05
Validation loss decreased (inf --> 0.3648).  Saving model state dict ...
Epoch: 1 cost time: 6.254792213439941
Epoch: 1, Steps: 514 | Train Loss: 0.8319798 Vali Loss: 0.3648390 Best vali loss: 0.3648390
	iters: 100, epoch: 2 | loss: 0.9756233
	speed: 0.0213s/iter; left time: 74.5886s
	iters: 200, epoch: 2 | loss: 0.3949969
	speed: 0.0112s/iter; left time: 38.1533s
	iters: 300, epoch: 2 | loss: 0.4584214
	speed: 0.0111s/iter; left time: 36.5208s
	iters: 400, epoch: 2 | loss: 1.2046400
	speed: 0.0125s/iter; left time: 40.0765s
	iters: 500, epoch: 2 | loss: 0.8312721
	speed: 0.0118s/iter; left time: 36.6407s
Updating learning rate to 5.671858388288843e-05
Epoch: 2 cost time: 6.022704601287842
Epoch: 2, Steps: 514 | Train Loss: 0.7729908 Vali Loss: 0.3672732 Best vali loss: 0.3648390
	iters: 100, epoch: 3 | loss: 0.4821813
	speed: 0.0191s/iter; left time: 56.9706s
	iters: 200, epoch: 3 | loss: 0.6823502
	speed: 0.0113s/iter; left time: 32.5472s
	iters: 300, epoch: 3 | loss: 0.3132165
	speed: 0.0119s/iter; left time: 33.1272s
	iters: 400, epoch: 3 | loss: 0.3626551
	speed: 0.0117s/iter; left time: 31.5411s
	iters: 500, epoch: 3 | loss: 0.8738086
	speed: 0.0122s/iter; left time: 31.4924s
Updating learning rate to 4.593962551514785e-05
Validation loss decreased (0.3648 --> 0.3568).  Saving model state dict ...
Epoch: 3 cost time: 5.834543704986572
Epoch: 3, Steps: 514 | Train Loss: 0.5428423 Vali Loss: 0.3568355 Best vali loss: 0.3568355
	iters: 100, epoch: 4 | loss: 0.7479422
	speed: 0.0268s/iter; left time: 66.2181s
	iters: 200, epoch: 4 | loss: 0.4903463
	speed: 0.0094s/iter; left time: 22.1922s
	iters: 300, epoch: 4 | loss: 0.4412099
	speed: 0.0107s/iter; left time: 24.2160s
	iters: 400, epoch: 4 | loss: 0.5678235
	speed: 0.0105s/iter; left time: 22.8902s
	iters: 500, epoch: 4 | loss: 1.1097651
	speed: 0.0101s/iter; left time: 20.8688s
Updating learning rate to 3.32249772e-05
Epoch: 4 cost time: 5.279554605484009
Epoch: 4, Steps: 514 | Train Loss: 0.6714174 Vali Loss: 0.3610473 Best vali loss: 0.3568355
	iters: 100, epoch: 5 | loss: 0.7885384
	speed: 0.0199s/iter; left time: 38.9381s
	iters: 200, epoch: 5 | loss: 0.6580514
	speed: 0.0101s/iter; left time: 18.7611s
	iters: 300, epoch: 5 | loss: 0.3637779
	speed: 0.0093s/iter; left time: 16.3263s
	iters: 400, epoch: 5 | loss: 0.6430209
	speed: 0.0098s/iter; left time: 16.2268s
	iters: 500, epoch: 5 | loss: 0.6701049
	speed: 0.0100s/iter; left time: 15.5100s
Updating learning rate to 2.0510328884852154e-05
Epoch: 5 cost time: 5.116783857345581
Epoch: 5, Steps: 514 | Train Loss: 0.6246987 Vali Loss: 0.3699671 Best vali loss: 0.3568355
	iters: 100, epoch: 6 | loss: 0.2734635
	speed: 0.0196s/iter; left time: 28.2208s
	iters: 200, epoch: 6 | loss: 0.5569654
	speed: 0.0092s/iter; left time: 12.3456s
	iters: 300, epoch: 6 | loss: 0.4067790
	speed: 0.0079s/iter; left time: 9.8165s
	iters: 400, epoch: 6 | loss: 0.5868449
	speed: 0.0088s/iter; left time: 10.0796s
	iters: 500, epoch: 6 | loss: 0.6572302
	speed: 0.0091s/iter; left time: 9.4833s
Updating learning rate to 9.731370517111572e-06
Epoch: 6 cost time: 4.713332891464233
Epoch: 6, Steps: 514 | Train Loss: 0.4962566 Vali Loss: 0.3674788 Best vali loss: 0.3568355
	iters: 100, epoch: 7 | loss: 0.7598604
	speed: 0.0202s/iter; left time: 18.7643s
	iters: 200, epoch: 7 | loss: 0.3377521
	speed: 0.0094s/iter; left time: 7.7964s
	iters: 300, epoch: 7 | loss: 0.6044656
	speed: 0.0103s/iter; left time: 7.5123s
	iters: 400, epoch: 7 | loss: 0.3282968
	speed: 0.0094s/iter; left time: 5.9370s
	iters: 500, epoch: 7 | loss: 0.9183974
	speed: 0.0088s/iter; left time: 4.6672s
Updating learning rate to 2.5291007967658393e-06
Epoch: 7 cost time: 4.96019721031189
Epoch: 7, Steps: 514 | Train Loss: 0.5897545 Vali Loss: 0.3660771 Best vali loss: 0.3568355
	iters: 100, epoch: 8 | loss: 0.6068355
	speed: 0.0180s/iter; left time: 7.4573s
	iters: 200, epoch: 8 | loss: 1.1353644
	speed: 0.0089s/iter; left time: 2.7962s
	iters: 300, epoch: 8 | loss: 0.4959051
	speed: 0.0096s/iter; left time: 2.0616s
	iters: 400, epoch: 8 | loss: 0.3649375
	speed: 0.0093s/iter; left time: 1.0744s
	iters: 500, epoch: 8 | loss: 0.6433448
	speed: 0.0095s/iter; left time: 0.1422s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.712276220321655
Epoch: 8, Steps: 514 | Train Loss: 0.6492775 Vali Loss: 0.3740866 Best vali loss: 0.3568355

best validation loss 0.35683552585322637

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0089874597665, 'e_layers': 2, 'learning_rate': 0.0007900549735, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0007900549735
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 1.1965346336364746
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3658890 Best vali loss: 0.3658890
Updating learning rate to 0.00039502748675
Epoch: 2 cost time: 0.79170823097229
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3932126 Best vali loss: 0.3658890
Updating learning rate to 0.000197513743375
Validation loss decreased (0.3659 --> 0.3608).  Saving model state dict ...
Epoch: 3 cost time: 0.7879741191864014
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3607706 Best vali loss: 0.3607706
Updating learning rate to 9.87568716875e-05
Validation loss decreased (0.3608 --> 0.3570).  Saving model state dict ...
Epoch: 4 cost time: 0.7811691761016846
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3569995 Best vali loss: 0.3569995
Updating learning rate to 4.937843584375e-05
Validation loss decreased (0.3570 --> 0.3512).  Saving model state dict ...
Epoch: 5 cost time: 0.773984432220459
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3512288 Best vali loss: 0.3512288
Updating learning rate to 2.4689217921875e-05
Epoch: 6 cost time: 0.7849199771881104
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3544005 Best vali loss: 0.3512288
Updating learning rate to 1.23446089609375e-05
Epoch: 7 cost time: 0.7956349849700928
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3521532 Best vali loss: 0.3512288
Updating learning rate to 6.17230448046875e-06
Epoch: 8 cost time: 0.7667176723480225
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3530975 Best vali loss: 0.3512288

best validation loss 0.35122880004712315

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0045415750231, 'e_layers': 3, 'learning_rate': 0.001151732196, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4648884
	speed: 0.0157s/iter; left time: 62.8315s
	iters: 200, epoch: 1 | loss: 0.6076251
	speed: 0.0087s/iter; left time: 33.8491s
	iters: 300, epoch: 1 | loss: 0.6711398
	speed: 0.0089s/iter; left time: 34.0503s
	iters: 400, epoch: 1 | loss: 0.6550748
	speed: 0.0096s/iter; left time: 35.6304s
	iters: 500, epoch: 1 | loss: 1.4750997
	speed: 0.0095s/iter; left time: 34.4442s
Updating learning rate to 0.001151732196
Validation loss decreased (inf --> 0.4018).  Saving model state dict ...
Epoch: 1 cost time: 5.087061166763306
Epoch: 1, Steps: 514 | Train Loss: 0.7747655 Vali Loss: 0.4017753 Best vali loss: 0.4017753
	iters: 100, epoch: 2 | loss: 0.8747988
	speed: 0.0192s/iter; left time: 67.2263s
	iters: 200, epoch: 2 | loss: 0.9996985
	speed: 0.0098s/iter; left time: 33.3885s
	iters: 300, epoch: 2 | loss: 0.6011032
	speed: 0.0098s/iter; left time: 32.2175s
	iters: 400, epoch: 2 | loss: 0.9372404
	speed: 0.0100s/iter; left time: 32.0638s
	iters: 500, epoch: 2 | loss: 0.7596294
	speed: 0.0098s/iter; left time: 30.4139s
Updating learning rate to 0.000575866098
Validation loss decreased (0.4018 --> 0.4002).  Saving model state dict ...
Epoch: 2 cost time: 5.095040798187256
Epoch: 2, Steps: 514 | Train Loss: 0.8344941 Vali Loss: 0.4001591 Best vali loss: 0.4001591
	iters: 100, epoch: 3 | loss: 0.3704262
	speed: 0.0200s/iter; left time: 59.7895s
	iters: 200, epoch: 3 | loss: 0.5885641
	speed: 0.0091s/iter; left time: 26.2153s
	iters: 300, epoch: 3 | loss: 0.7718679
	speed: 0.0093s/iter; left time: 25.9881s
	iters: 400, epoch: 3 | loss: 1.0736957
	speed: 0.0099s/iter; left time: 26.5551s
	iters: 500, epoch: 3 | loss: 0.8258810
	speed: 0.0099s/iter; left time: 25.5961s
Updating learning rate to 0.000287933049
Epoch: 3 cost time: 4.952455520629883
Epoch: 3, Steps: 514 | Train Loss: 0.7260870 Vali Loss: 0.4031739 Best vali loss: 0.4001591

best validation loss 0.4001591030178932

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0101347050857, 'e_layers': 3, 'learning_rate': 0.0034379020615, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2614802
	speed: 0.0151s/iter; left time: 60.4067s
	iters: 200, epoch: 1 | loss: 0.4107178
	speed: 0.0090s/iter; left time: 35.2363s
	iters: 300, epoch: 1 | loss: 0.3382889
	speed: 0.0065s/iter; left time: 24.8652s
	iters: 400, epoch: 1 | loss: 0.3865040
	speed: 0.0066s/iter; left time: 24.4108s
	iters: 500, epoch: 1 | loss: 0.4467496
	speed: 0.0068s/iter; left time: 24.5540s
Updating learning rate to 0.0033070547054491043
Validation loss decreased (inf --> 0.3741).  Saving model state dict ...
Epoch: 1 cost time: 4.208580493927002
Epoch: 1, Steps: 514 | Train Loss: 0.3687481 Vali Loss: 0.3741378 Best vali loss: 0.3741378
	iters: 100, epoch: 2 | loss: 0.9921854
	speed: 0.0185s/iter; left time: 64.7255s
	iters: 200, epoch: 2 | loss: 0.6396083
	speed: 0.0090s/iter; left time: 30.6851s
	iters: 300, epoch: 2 | loss: 0.3088618
	speed: 0.0091s/iter; left time: 29.9266s
	iters: 400, epoch: 2 | loss: 0.7699381
	speed: 0.0090s/iter; left time: 28.8182s
	iters: 500, epoch: 2 | loss: 0.5167417
	speed: 0.0095s/iter; left time: 29.4409s
Updating learning rate to 0.0029344329611209305
Epoch: 2 cost time: 4.751415967941284
Epoch: 2, Steps: 514 | Train Loss: 0.6454670 Vali Loss: 0.3850063 Best vali loss: 0.3741378
	iters: 100, epoch: 3 | loss: 0.3048197
	speed: 0.0189s/iter; left time: 56.5636s
	iters: 200, epoch: 3 | loss: 0.7400546
	speed: 0.0094s/iter; left time: 26.9888s
	iters: 300, epoch: 3 | loss: 0.5642248
	speed: 0.0093s/iter; left time: 25.9855s
	iters: 400, epoch: 3 | loss: 0.6726293
	speed: 0.0094s/iter; left time: 25.1600s
	iters: 500, epoch: 3 | loss: 0.7667691
	speed: 0.0097s/iter; left time: 25.1409s
Updating learning rate to 0.002376765111264919
Epoch: 3 cost time: 4.897012948989868
Epoch: 3, Steps: 514 | Train Loss: 0.6096995 Vali Loss: 0.3968606 Best vali loss: 0.3741378

best validation loss 0.3741377912359294

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0086057487695, 'e_layers': 4, 'learning_rate': 0.0011712676726, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6978386
	speed: 0.0160s/iter; left time: 14.8852s
Updating learning rate to 0.0011266889512036354
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 1.5810208320617676
Epoch: 1, Steps: 129 | Train Loss: 0.6978386 Vali Loss: 0.3696614 Best vali loss: 0.3696614
	iters: 100, epoch: 2 | loss: 0.6550477
	speed: 0.0233s/iter; left time: 18.6940s
Updating learning rate to 0.0009997394932400223
Validation loss decreased (0.3697 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 2.276060104370117
Epoch: 2, Steps: 129 | Train Loss: 0.6550477 Vali Loss: 0.3693896 Best vali loss: 0.3693896
	iters: 100, epoch: 3 | loss: 0.6241733
	speed: 0.0355s/iter; left time: 23.9885s
Updating learning rate to 0.0008097462028844191
Epoch: 3 cost time: 2.7512898445129395
Epoch: 3, Steps: 129 | Train Loss: 0.6241733 Vali Loss: 0.3719127 Best vali loss: 0.3693896

best validation loss 0.36938959197351645

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0086057487695, 'e_layers': 4, 'learning_rate': 0.0011712676726, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6233302
	speed: 0.0387s/iter; left time: 21.1261s
Updating learning rate to 0.0005856338363
Epoch: 4 cost time: 4.542598247528076
Epoch: 4, Steps: 129 | Train Loss: 0.6233302 Vali Loss: 0.3810136 Best vali loss: 0.3693896
	iters: 100, epoch: 5 | loss: 0.6220544
	speed: 0.0640s/iter; left time: 26.6952s
Updating learning rate to 0.0003615214697155809
Epoch: 5 cost time: 4.385941743850708
Epoch: 5, Steps: 129 | Train Loss: 0.6220544 Vali Loss: 0.3740473 Best vali loss: 0.3693896
	iters: 100, epoch: 6 | loss: 0.5643917
	speed: 0.0644s/iter; left time: 18.5591s
Updating learning rate to 0.00017152817935997753
Epoch: 6 cost time: 4.6538636684417725
Epoch: 6, Steps: 129 | Train Loss: 0.5643917 Vali Loss: 0.3795980 Best vali loss: 0.3693896
	iters: 100, epoch: 7 | loss: 0.8729956
	speed: 0.0612s/iter; left time: 9.7298s
Updating learning rate to 4.457872139636457e-05
Validation loss decreased (0.3694 --> 0.3592).  Saving model state dict ...
Epoch: 7 cost time: 4.102404594421387
Epoch: 7, Steps: 129 | Train Loss: 0.8729956 Vali Loss: 0.3592014 Best vali loss: 0.3592014
	iters: 100, epoch: 8 | loss: 0.5508119
	speed: 0.0579s/iter; left time: 1.7378s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.363382577896118
Epoch: 8, Steps: 129 | Train Loss: 0.5508119 Vali Loss: 0.3605570 Best vali loss: 0.3592014

best validation loss 0.3592014249275148

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0038403732863, 'e_layers': 4, 'learning_rate': 8.59328316e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4749809
	speed: 0.0162s/iter; left time: 131.8698s
	iters: 200, epoch: 1 | loss: 1.0850990
	speed: 0.0093s/iter; left time: 74.7767s
	iters: 300, epoch: 1 | loss: 1.1060750
	speed: 0.0086s/iter; left time: 67.7844s
	iters: 400, epoch: 1 | loss: 0.3264023
	speed: 0.0097s/iter; left time: 75.5149s
	iters: 500, epoch: 1 | loss: 0.4741388
	speed: 0.0100s/iter; left time: 77.1460s
	iters: 600, epoch: 1 | loss: 0.3967257
	speed: 0.0089s/iter; left time: 67.5664s
	iters: 700, epoch: 1 | loss: 0.7376445
	speed: 0.0079s/iter; left time: 59.2164s
	iters: 800, epoch: 1 | loss: 0.2520294
	speed: 0.0094s/iter; left time: 69.4492s
	iters: 900, epoch: 1 | loss: 0.8775744
	speed: 0.0089s/iter; left time: 64.7965s
	iters: 1000, epoch: 1 | loss: 0.6587114
	speed: 0.0086s/iter; left time: 62.3924s
Updating learning rate to 8.59328316e-05
Validation loss decreased (inf --> 0.3634).  Saving model state dict ...
Epoch: 1 cost time: 9.68976354598999
Epoch: 1, Steps: 1027 | Train Loss: 0.6389381 Vali Loss: 0.3633600 Best vali loss: 0.3633600
	iters: 100, epoch: 2 | loss: 0.6372324
	speed: 0.0228s/iter; left time: 161.5942s
	iters: 200, epoch: 2 | loss: 0.5028741
	speed: 0.0087s/iter; left time: 60.6243s
	iters: 300, epoch: 2 | loss: 0.2600125
	speed: 0.0089s/iter; left time: 61.4807s
	iters: 400, epoch: 2 | loss: 1.5525912
	speed: 0.0092s/iter; left time: 62.6902s
	iters: 500, epoch: 2 | loss: 0.5655258
	speed: 0.0078s/iter; left time: 52.4287s
	iters: 600, epoch: 2 | loss: 0.8748839
	speed: 0.0075s/iter; left time: 49.2298s
	iters: 700, epoch: 2 | loss: 0.8346281
	speed: 0.0077s/iter; left time: 49.7474s
	iters: 800, epoch: 2 | loss: 0.6292984
	speed: 0.0090s/iter; left time: 57.3475s
	iters: 900, epoch: 2 | loss: 0.4364646
	speed: 0.0088s/iter; left time: 55.3111s
	iters: 1000, epoch: 2 | loss: 0.4981033
	speed: 0.0084s/iter; left time: 51.9266s
Updating learning rate to 4.29664158e-05
Epoch: 2 cost time: 8.68008542060852
Epoch: 2, Steps: 1027 | Train Loss: 0.6791614 Vali Loss: 0.3706222 Best vali loss: 0.3633600
	iters: 100, epoch: 3 | loss: 0.3602657
	speed: 0.0252s/iter; left time: 153.0425s
	iters: 200, epoch: 3 | loss: 0.2430408
	speed: 0.0085s/iter; left time: 50.5501s
	iters: 300, epoch: 3 | loss: 0.7928966
	speed: 0.0090s/iter; left time: 52.5302s
	iters: 400, epoch: 3 | loss: 0.2821602
	speed: 0.0088s/iter; left time: 50.5144s
	iters: 500, epoch: 3 | loss: 0.8322064
	speed: 0.0079s/iter; left time: 44.9959s
	iters: 600, epoch: 3 | loss: 0.7675220
	speed: 0.0081s/iter; left time: 44.8789s
	iters: 700, epoch: 3 | loss: 0.9971243
	speed: 0.0084s/iter; left time: 45.9661s
	iters: 800, epoch: 3 | loss: 0.6912757
	speed: 0.0090s/iter; left time: 48.4464s
	iters: 900, epoch: 3 | loss: 0.2975753
	speed: 0.0106s/iter; left time: 55.5715s
	iters: 1000, epoch: 3 | loss: 0.3762330
	speed: 0.0105s/iter; left time: 54.3958s
Updating learning rate to 2.14832079e-05
Validation loss decreased (0.3634 --> 0.3597).  Saving model state dict ...
Epoch: 3 cost time: 9.375053644180298
Epoch: 3, Steps: 1027 | Train Loss: 0.5640300 Vali Loss: 0.3597402 Best vali loss: 0.3597402
	iters: 100, epoch: 4 | loss: 1.0469556
	speed: 0.0257s/iter; left time: 129.2244s
	iters: 200, epoch: 4 | loss: 0.4514672
	speed: 0.0100s/iter; left time: 49.3528s
	iters: 300, epoch: 4 | loss: 1.3054482
	speed: 0.0102s/iter; left time: 49.4553s
	iters: 400, epoch: 4 | loss: 0.8794122
	speed: 0.0104s/iter; left time: 49.2917s
	iters: 500, epoch: 4 | loss: 0.4564723
	speed: 0.0104s/iter; left time: 48.2891s
	iters: 600, epoch: 4 | loss: 0.9784606
	speed: 0.0097s/iter; left time: 44.2002s
	iters: 700, epoch: 4 | loss: 0.5770673
	speed: 0.0086s/iter; left time: 38.1556s
	iters: 800, epoch: 4 | loss: 0.3822387
	speed: 0.0092s/iter; left time: 39.9412s
	iters: 900, epoch: 4 | loss: 0.4485444
	speed: 0.0094s/iter; left time: 40.0248s
	iters: 1000, epoch: 4 | loss: 0.7821633
	speed: 0.0102s/iter; left time: 41.9880s
Updating learning rate to 1.074160395e-05
Validation loss decreased (0.3597 --> 0.3591).  Saving model state dict ...
Epoch: 4 cost time: 9.994458436965942
Epoch: 4, Steps: 1027 | Train Loss: 0.7308230 Vali Loss: 0.3590563 Best vali loss: 0.3590563
	iters: 100, epoch: 5 | loss: 0.8449183
	speed: 0.0270s/iter; left time: 108.2193s
	iters: 200, epoch: 5 | loss: 0.7325384
	speed: 0.0081s/iter; left time: 31.6752s
	iters: 300, epoch: 5 | loss: 0.4122408
	speed: 0.0097s/iter; left time: 36.8115s
	iters: 400, epoch: 5 | loss: 0.4011436
	speed: 0.0098s/iter; left time: 36.3173s
	iters: 500, epoch: 5 | loss: 0.3362603
	speed: 0.0104s/iter; left time: 37.5390s
	iters: 600, epoch: 5 | loss: 0.8409064
	speed: 0.0112s/iter; left time: 39.1599s
	iters: 700, epoch: 5 | loss: 0.2971899
	speed: 0.0087s/iter; left time: 29.7591s
	iters: 800, epoch: 5 | loss: 0.2076034
	speed: 0.0105s/iter; left time: 34.8206s
	iters: 900, epoch: 5 | loss: 0.8340710
	speed: 0.0088s/iter; left time: 28.1141s
	iters: 1000, epoch: 5 | loss: 0.6347323
	speed: 0.0082s/iter; left time: 25.4282s
Updating learning rate to 5.370801975e-06
Validation loss decreased (0.3591 --> 0.3551).  Saving model state dict ...
Epoch: 5 cost time: 9.803611993789673
Epoch: 5, Steps: 1027 | Train Loss: 0.5541604 Vali Loss: 0.3551298 Best vali loss: 0.3551298
	iters: 100, epoch: 6 | loss: 1.0288594
	speed: 0.0269s/iter; left time: 80.1058s
	iters: 200, epoch: 6 | loss: 0.5110146
	speed: 0.0107s/iter; left time: 30.9772s
	iters: 300, epoch: 6 | loss: 0.8170295
	speed: 0.0077s/iter; left time: 21.3652s
	iters: 400, epoch: 6 | loss: 0.5465496
	speed: 0.0102s/iter; left time: 27.4453s
	iters: 500, epoch: 6 | loss: 0.7491943
	speed: 0.0108s/iter; left time: 27.7876s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0062483566964, 'e_layers': 3, 'learning_rate': 0.0001625782347, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3729533
	speed: 0.0197s/iter; left time: 79.1267s
	iters: 200, epoch: 1 | loss: 0.8954933
	speed: 0.0117s/iter; left time: 45.8221s
	iters: 300, epoch: 1 | loss: 0.6762714
	speed: 0.0115s/iter; left time: 43.7499s
	iters: 400, epoch: 1 | loss: 0.5299303
	speed: 0.0078s/iter; left time: 29.0781s
	iters: 500, epoch: 1 | loss: 0.6414381
	speed: 0.0092s/iter; left time: 33.2348s
Updating learning rate to 0.00015639046908557313
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 5.791590690612793
Epoch: 1, Steps: 514 | Train Loss: 0.6232173 Vali Loss: 0.3685811 Best vali loss: 0.3685811
	iters: 100, epoch: 2 | loss: 0.3399836
	speed: 0.0182s/iter; left time: 63.7965s
	iters: 200, epoch: 2 | loss: 0.5297416
	speed: 0.0081s/iter; left time: 27.5798s
	iters: 300, epoch: 2 | loss: 0.4063479
	speed: 0.0080s/iter; left time: 26.3791s
	iters: 400, epoch: 2 | loss: 0.4493071
	speed: 0.0080s/iter; left time: 25.4714s
	iters: 500, epoch: 2 | loss: 0.6366227
	speed: 0.0080s/iter; left time: 24.7591s
Updating learning rate to 0.00013876920346485403
Validation loss decreased (0.3686 --> 0.3624).  Saving model state dict ...
Epoch: 2 cost time: 4.1845011711120605
Epoch: 2, Steps: 514 | Train Loss: 0.4724006 Vali Loss: 0.3624311 Best vali loss: 0.3624311
	iters: 100, epoch: 3 | loss: 0.9869644
	speed: 0.0185s/iter; left time: 55.1975s
	iters: 200, epoch: 3 | loss: 0.2091062
	speed: 0.0100s/iter; left time: 28.9455s
	iters: 300, epoch: 3 | loss: 0.3094268
	speed: 0.0080s/iter; left time: 22.2410s
	iters: 400, epoch: 3 | loss: 0.3474880
	speed: 0.0083s/iter; left time: 22.2209s
	iters: 500, epoch: 3 | loss: 1.0413158
	speed: 0.0081s/iter; left time: 21.0489s
Updating learning rate to 0.00011239711579142658
Epoch: 3 cost time: 4.425858497619629
Epoch: 3, Steps: 514 | Train Loss: 0.5788602 Vali Loss: 0.3696329 Best vali loss: 0.3624311
	iters: 100, epoch: 4 | loss: 0.6719542
	speed: 0.0200s/iter; left time: 49.4501s
	iters: 200, epoch: 4 | loss: 1.0163649
	speed: 0.0081s/iter; left time: 19.1672s
	iters: 300, epoch: 4 | loss: 0.3896835
	speed: 0.0079s/iter; left time: 17.9040s
	iters: 400, epoch: 4 | loss: 0.3370534
	speed: 0.0088s/iter; left time: 19.0336s
	iters: 500, epoch: 4 | loss: 0.3516043
	speed: 0.0085s/iter; left time: 17.6599s
Updating learning rate to 8.128911735e-05
Epoch: 4 cost time: 4.260721683502197
Epoch: 4, Steps: 514 | Train Loss: 0.5533321 Vali Loss: 0.3764006 Best vali loss: 0.3624311
	iters: 100, epoch: 5 | loss: 0.3026977
	speed: 0.0147s/iter; left time: 28.8003s
	iters: 200, epoch: 5 | loss: 0.7071394
	speed: 0.0084s/iter; left time: 15.6818s
	iters: 300, epoch: 5 | loss: 0.9853561
	speed: 0.0085s/iter; left time: 14.9039s
	iters: 400, epoch: 5 | loss: 0.2727222
	speed: 0.0083s/iter; left time: 13.7462s
	iters: 500, epoch: 5 | loss: 0.3050311
	speed: 0.0084s/iter; left time: 13.0355s
Updating learning rate to 5.018111890857343e-05
Epoch: 5 cost time: 4.329466819763184
Epoch: 5, Steps: 514 | Train Loss: 0.5145893 Vali Loss: 0.3877977 Best vali loss: 0.3624311
	iters: 100, epoch: 6 | loss: 0.3563174
	speed: 0.0223s/iter; left time: 32.2234s
	iters: 200, epoch: 6 | loss: 0.4294249
	speed: 0.0085s/iter; left time: 11.4622s
	iters: 300, epoch: 6 | loss: 0.5084763
	speed: 0.0086s/iter; left time: 10.6322s
	iters: 400, epoch: 6 | loss: 1.2680427
	speed: 0.0086s/iter; left time: 9.8171s
	iters: 500, epoch: 6 | loss: 0.5677747
	speed: 0.0086s/iter; left time: 8.9742s
Updating learning rate to 2.3809031235145972e-05
Epoch: 6 cost time: 4.443182945251465
Epoch: 6, Steps: 514 | Train Loss: 0.6260072 Vali Loss: 0.3717903 Best vali loss: 0.3624311
	iters: 100, epoch: 7 | loss: 1.1329668
	speed: 0.0197s/iter; left time: 18.3379s
	iters: 200, epoch: 7 | loss: 0.3442034
	speed: 0.0085s/iter; left time: 7.0173s
	iters: 300, epoch: 7 | loss: 0.8603826
	speed: 0.0084s/iter; left time: 6.0949s
	iters: 400, epoch: 7 | loss: 0.5729310
	speed: 0.0084s/iter; left time: 5.2542s
	iters: 500, epoch: 7 | loss: 0.3520166
	speed: 0.0084s/iter; left time: 4.4199s
Updating learning rate to 6.187765614426872e-06
Epoch: 7 cost time: 4.401438236236572
Epoch: 7, Steps: 514 | Train Loss: 0.6525001 Vali Loss: 0.3718326 Best vali loss: 0.3624311
	iters: 100, epoch: 8 | loss: 0.3601092
	speed: 0.0170s/iter; left time: 7.0456s
	iters: 200, epoch: 8 | loss: 0.6083902
	speed: 0.0088s/iter; left time: 2.7775s
	iters: 300, epoch: 8 | loss: 0.4329896
	speed: 0.0098s/iter; left time: 2.0989s
	iters: 400, epoch: 8 | loss: 0.5042921
	speed: 0.0097s/iter; left time: 1.1106s
	iters: 500, epoch: 8 | loss: 0.4743779
	speed: 0.0093s/iter; left time: 0.1397s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.760826349258423
Epoch: 8, Steps: 514 | Train Loss: 0.4760318 Vali Loss: 0.3752879 Best vali loss: 0.3624311

best validation loss 0.3624311440702974

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0015206249299, 'e_layers': 4, 'learning_rate': 0.0036651766384, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1969926
	speed: 0.0142s/iter; left time: 56.8067s
	iters: 200, epoch: 1 | loss: 0.9720962
	speed: 0.0115s/iter; left time: 45.0920s
	iters: 300, epoch: 1 | loss: 0.5493734
	speed: 0.0128s/iter; left time: 48.8738s
	iters: 400, epoch: 1 | loss: 0.3179821
	speed: 0.0081s/iter; left time: 29.9042s
	iters: 500, epoch: 1 | loss: 0.5151850
	speed: 0.0105s/iter; left time: 37.9423s
Updating learning rate to 0.0035256791588281406
Validation loss decreased (inf --> 0.4084).  Saving model state dict ...
Epoch: 1 cost time: 5.550687551498413
Epoch: 1, Steps: 514 | Train Loss: 0.7103259 Vali Loss: 0.4084468 Best vali loss: 0.4084468
	iters: 100, epoch: 2 | loss: 1.0458431
	speed: 0.0225s/iter; left time: 78.6348s
	iters: 200, epoch: 2 | loss: 0.7482457
	speed: 0.0121s/iter; left time: 41.2722s
	iters: 300, epoch: 2 | loss: 1.0211202
	speed: 0.0083s/iter; left time: 27.5069s
	iters: 400, epoch: 2 | loss: 0.8696104
	speed: 0.0078s/iter; left time: 24.9729s
	iters: 500, epoch: 2 | loss: 0.7074561
	speed: 0.0077s/iter; left time: 23.9182s
Updating learning rate to 0.0031284239468295774
Validation loss decreased (0.4084 --> 0.4034).  Saving model state dict ...
Epoch: 2 cost time: 4.8352508544921875
Epoch: 2, Steps: 514 | Train Loss: 0.8784551 Vali Loss: 0.4034038 Best vali loss: 0.4034038
	iters: 100, epoch: 3 | loss: 0.3963244
	speed: 0.0178s/iter; left time: 53.1752s
	iters: 200, epoch: 3 | loss: 0.8136476
	speed: 0.0091s/iter; left time: 26.1597s
	iters: 300, epoch: 3 | loss: 0.7563775
	speed: 0.0085s/iter; left time: 23.7701s
	iters: 400, epoch: 3 | loss: 0.4389175
	speed: 0.0104s/iter; left time: 27.9749s
	iters: 500, epoch: 3 | loss: 0.6347827
	speed: 0.0101s/iter; left time: 26.2243s
Updating learning rate to 0.0025338895073036267
Epoch: 3 cost time: 4.985083818435669
Epoch: 3, Steps: 514 | Train Loss: 0.6080099 Vali Loss: 0.4060680 Best vali loss: 0.4034038

best validation loss 0.40340384900687015

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0022191591884, 'e_layers': 1, 'learning_rate': 0.0008050296962, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6780481
	speed: 0.0114s/iter; left time: 22.3585s
	iters: 200, epoch: 1 | loss: 0.5335429
	speed: 0.0059s/iter; left time: 10.9633s
Updating learning rate to 0.0007743900777914795
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.8538634777069092
Epoch: 1, Steps: 257 | Train Loss: 0.6057955 Vali Loss: 0.3655420 Best vali loss: 0.3655420
	iters: 100, epoch: 2 | loss: 0.7135435
	speed: 0.0153s/iter; left time: 26.0283s
	iters: 200, epoch: 2 | loss: 0.3728434
	speed: 0.0104s/iter; left time: 16.6092s
Updating learning rate to 0.0006871358267197831
Epoch: 2 cost time: 2.3699140548706055
Epoch: 2, Steps: 257 | Train Loss: 0.5431935 Vali Loss: 0.3717275 Best vali loss: 0.3655420
	iters: 100, epoch: 3 | loss: 0.4812971
	speed: 0.0190s/iter; left time: 27.4335s
	iters: 200, epoch: 3 | loss: 0.5845421
	speed: 0.0058s/iter; left time: 7.8544s
Updating learning rate to 0.0005565506117488207
Epoch: 3 cost time: 1.654881238937378
Epoch: 3, Steps: 257 | Train Loss: 0.5329196 Vali Loss: 0.3666075 Best vali loss: 0.3655420

best validation loss 0.3655420196782395

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0099469591313, 'e_layers': 2, 'learning_rate': 6.1204951e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.1204951e-05
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 1.35587739944458
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3683494 Best vali loss: 0.3683494
Updating learning rate to 3.06024755e-05
Validation loss decreased (0.3683 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 1.0535166263580322
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3648964 Best vali loss: 0.3648964
Updating learning rate to 1.530123775e-05
Validation loss decreased (0.3649 --> 0.3620).  Saving model state dict ...
Epoch: 3 cost time: 1.009981632232666
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3619587 Best vali loss: 0.3619587

best validation loss 0.3619586906405001

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0099469591313, 'e_layers': 2, 'learning_rate': 6.1204951e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 7.650618875e-06
Epoch: 4 cost time: 1.2148869037628174
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3620239 Best vali loss: 0.3619587
Updating learning rate to 3.8253094375e-06
Epoch: 5 cost time: 0.9972779750823975
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3619986 Best vali loss: 0.3619587
Updating learning rate to 1.91265471875e-06
Validation loss decreased (0.3620 --> 0.3619).  Saving model state dict ...
Epoch: 6 cost time: 1.0125787258148193
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3618902 Best vali loss: 0.3618902
Updating learning rate to 9.56327359375e-07
Validation loss decreased (0.3619 --> 0.3617).  Saving model state dict ...
Epoch: 7 cost time: 1.0098352432250977
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3617260 Best vali loss: 0.3617260
Updating learning rate to 4.781636796875e-07
Epoch: 8 cost time: 0.9790077209472656
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3617894 Best vali loss: 0.3617260

best validation loss 0.3617260024215009

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013022659604, 'e_layers': 1, 'learning_rate': 0.0001882118338, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5120655
	speed: 0.0120s/iter; left time: 23.4719s
	iters: 200, epoch: 1 | loss: 0.5374493
	speed: 0.0072s/iter; left time: 13.2809s
Updating learning rate to 0.000181048447412118
Validation loss decreased (inf --> 0.3814).  Saving model state dict ...
Epoch: 1 cost time: 2.0487422943115234
Epoch: 1, Steps: 257 | Train Loss: 0.5247574 Vali Loss: 0.3814426 Best vali loss: 0.3814426
	iters: 100, epoch: 2 | loss: 1.2863455
	speed: 0.0155s/iter; left time: 26.2874s
	iters: 200, epoch: 2 | loss: 0.3568210
	speed: 0.0074s/iter; left time: 11.8931s
Updating learning rate to 0.00016064884888976772
Validation loss decreased (0.3814 --> 0.3692).  Saving model state dict ...
Epoch: 2 cost time: 1.8905339241027832
Epoch: 2, Steps: 257 | Train Loss: 0.8215833 Vali Loss: 0.3692298 Best vali loss: 0.3692298
	iters: 100, epoch: 3 | loss: 0.7155822
	speed: 0.0159s/iter; left time: 22.9346s
	iters: 200, epoch: 3 | loss: 0.3666061
	speed: 0.0061s/iter; left time: 8.1867s
Updating learning rate to 0.0001301186921851559
Validation loss decreased (0.3692 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 1.6246559619903564
Epoch: 3, Steps: 257 | Train Loss: 0.5410942 Vali Loss: 0.3664805 Best vali loss: 0.3664805
	iters: 100, epoch: 4 | loss: 0.6988294
	speed: 0.0139s/iter; left time: 16.4386s
	iters: 200, epoch: 4 | loss: 0.3909470
	speed: 0.0062s/iter; left time: 6.7037s
Updating learning rate to 9.41059169e-05
Validation loss decreased (0.3665 --> 0.3661).  Saving model state dict ...
Epoch: 4 cost time: 1.6630852222442627
Epoch: 4, Steps: 257 | Train Loss: 0.5448882 Vali Loss: 0.3661459 Best vali loss: 0.3661459
	iters: 100, epoch: 5 | loss: 0.6447499
	speed: 0.0156s/iter; left time: 14.4610s
	iters: 200, epoch: 5 | loss: 0.7631148
	speed: 0.0064s/iter; left time: 5.2979s
Updating learning rate to 5.809314161484409e-05
Validation loss decreased (0.3661 --> 0.3658).  Saving model state dict ...
Epoch: 5 cost time: 1.7911601066589355
Epoch: 5, Steps: 257 | Train Loss: 0.7039323 Vali Loss: 0.3658004 Best vali loss: 0.3658004
	iters: 100, epoch: 6 | loss: 1.0146711
	speed: 0.0149s/iter; left time: 10.0384s
	iters: 200, epoch: 6 | loss: 0.5579702
	speed: 0.0090s/iter; left time: 5.1572s
Updating learning rate to 2.756298491023228e-05
Epoch: 6 cost time: 2.230680227279663
Epoch: 6, Steps: 257 | Train Loss: 0.7863206 Vali Loss: 0.3670669 Best vali loss: 0.3658004
	iters: 100, epoch: 7 | loss: 0.9365528
	speed: 0.0188s/iter; left time: 7.7957s
	iters: 200, epoch: 7 | loss: 0.5404405
	speed: 0.0068s/iter; left time: 2.1353s
Updating learning rate to 7.163386387882002e-06
Epoch: 7 cost time: 1.808842420578003
Epoch: 7, Steps: 257 | Train Loss: 0.7384967 Vali Loss: 0.3676892 Best vali loss: 0.3658004
	iters: 100, epoch: 8 | loss: 0.6171566
	speed: 0.0152s/iter; left time: 2.4083s
	iters: 200, epoch: 8 | loss: 0.5442510
	speed: 0.0057s/iter; left time: 0.3316s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.634448766708374
Epoch: 8, Steps: 257 | Train Loss: 0.5807038 Vali Loss: 0.3677328 Best vali loss: 0.3658004

best validation loss 0.36580040511073203

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3417107
	speed: 0.0142s/iter; left time: 115.0454s
	iters: 200, epoch: 1 | loss: 0.9829014
	speed: 0.0067s/iter; left time: 53.9492s
	iters: 300, epoch: 1 | loss: 0.2189471
	speed: 0.0074s/iter; left time: 58.3906s
	iters: 400, epoch: 1 | loss: 0.2128519
	speed: 0.0073s/iter; left time: 56.7555s
	iters: 500, epoch: 1 | loss: 0.3963815
	speed: 0.0072s/iter; left time: 55.7969s
	iters: 600, epoch: 1 | loss: 1.0484698
	speed: 0.0058s/iter; left time: 43.8540s
	iters: 700, epoch: 1 | loss: 0.4556291
	speed: 0.0047s/iter; left time: 35.0161s
	iters: 800, epoch: 1 | loss: 1.1228961
	speed: 0.0061s/iter; left time: 45.5286s
	iters: 900, epoch: 1 | loss: 0.7921894
	speed: 0.0072s/iter; left time: 52.4856s
	iters: 1000, epoch: 1 | loss: 0.9362485
	speed: 0.0070s/iter; left time: 50.5602s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 7.252798557281494
Epoch: 1, Steps: 1027 | Train Loss: 0.6508225 Vali Loss: 0.3686361 Best vali loss: 0.3686361
	iters: 100, epoch: 2 | loss: 0.2770582
	speed: 0.0266s/iter; left time: 188.2949s
	iters: 200, epoch: 2 | loss: 0.1938187
	speed: 0.0065s/iter; left time: 45.4021s
	iters: 300, epoch: 2 | loss: 0.5251972
	speed: 0.0047s/iter; left time: 32.1538s
	iters: 400, epoch: 2 | loss: 1.0741026
	speed: 0.0044s/iter; left time: 30.1806s
	iters: 500, epoch: 2 | loss: 0.4809468
	speed: 0.0043s/iter; left time: 28.4331s
	iters: 600, epoch: 2 | loss: 0.2180425
	speed: 0.0041s/iter; left time: 27.0907s
	iters: 700, epoch: 2 | loss: 0.3930627
	speed: 0.0049s/iter; left time: 31.7602s
	iters: 800, epoch: 2 | loss: 0.8167732
	speed: 0.0050s/iter; left time: 31.6664s
	iters: 900, epoch: 2 | loss: 0.6893312
	speed: 0.0047s/iter; left time: 29.5840s
	iters: 1000, epoch: 2 | loss: 1.9462826
	speed: 0.0043s/iter; left time: 26.7747s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 5.157823085784912
Epoch: 2, Steps: 1027 | Train Loss: 0.6614616 Vali Loss: 0.3718409 Best vali loss: 0.3686361
	iters: 100, epoch: 3 | loss: 1.0811419
	speed: 0.0168s/iter; left time: 102.0864s
	iters: 200, epoch: 3 | loss: 0.3548253
	speed: 0.0048s/iter; left time: 28.4207s
	iters: 300, epoch: 3 | loss: 0.5659410
	speed: 0.0046s/iter; left time: 27.1121s
	iters: 400, epoch: 3 | loss: 0.3674345
	speed: 0.0049s/iter; left time: 28.4172s
	iters: 500, epoch: 3 | loss: 0.3513604
	speed: 0.0049s/iter; left time: 27.5314s
	iters: 600, epoch: 3 | loss: 1.4614744
	speed: 0.0048s/iter; left time: 26.5187s
	iters: 700, epoch: 3 | loss: 0.3328186
	speed: 0.0047s/iter; left time: 25.5152s
	iters: 800, epoch: 3 | loss: 0.4003572
	speed: 0.0047s/iter; left time: 24.9633s
	iters: 900, epoch: 3 | loss: 0.2274173
	speed: 0.0041s/iter; left time: 21.7646s
	iters: 1000, epoch: 3 | loss: 0.7557997
	speed: 0.0041s/iter; left time: 21.0118s
Updating learning rate to 0.00016007985843890398
Epoch: 3 cost time: 4.799977540969849
Epoch: 3, Steps: 1027 | Train Loss: 0.5898570 Vali Loss: 0.3818543 Best vali loss: 0.3686361
	iters: 100, epoch: 4 | loss: 0.1652338
	speed: 0.0175s/iter; left time: 88.1623s
	iters: 200, epoch: 4 | loss: 0.8460780
	speed: 0.0048s/iter; left time: 23.8247s
	iters: 300, epoch: 4 | loss: 0.9440329
	speed: 0.0045s/iter; left time: 21.6987s
	iters: 400, epoch: 4 | loss: 0.3552329
	speed: 0.0047s/iter; left time: 22.3895s
	iters: 500, epoch: 4 | loss: 0.4264075
	speed: 0.0048s/iter; left time: 22.2768s
	iters: 600, epoch: 4 | loss: 0.5195581
	speed: 0.0045s/iter; left time: 20.3499s
	iters: 700, epoch: 4 | loss: 0.7408614
	speed: 0.0051s/iter; left time: 22.6804s
	iters: 800, epoch: 4 | loss: 0.2563221
	speed: 0.0043s/iter; left time: 18.7491s
	iters: 900, epoch: 4 | loss: 0.2201289
	speed: 0.0044s/iter; left time: 18.5545s
	iters: 1000, epoch: 4 | loss: 0.3798364
	speed: 0.0048s/iter; left time: 19.9571s
Updating learning rate to 0.0001157747715
Epoch: 4 cost time: 4.871624708175659
Epoch: 4, Steps: 1027 | Train Loss: 0.4853692 Vali Loss: 0.3758157 Best vali loss: 0.3686361
	iters: 100, epoch: 5 | loss: 0.2994863
	speed: 0.0181s/iter; left time: 72.7588s
	iters: 200, epoch: 5 | loss: 0.3892825
	speed: 0.0047s/iter; left time: 18.2054s
	iters: 300, epoch: 5 | loss: 0.2203140
	speed: 0.0050s/iter; left time: 18.9603s
	iters: 400, epoch: 5 | loss: 0.3647177
	speed: 0.0043s/iter; left time: 15.9913s
	iters: 500, epoch: 5 | loss: 1.5566531
	speed: 0.0035s/iter; left time: 12.8035s
	iters: 600, epoch: 5 | loss: 0.1938421
	speed: 0.0034s/iter; left time: 11.8168s
	iters: 700, epoch: 5 | loss: 0.4632237
	speed: 0.0037s/iter; left time: 12.7277s
	iters: 800, epoch: 5 | loss: 0.5209098
	speed: 0.0039s/iter; left time: 12.7691s
	iters: 900, epoch: 5 | loss: 0.2573181
	speed: 0.0040s/iter; left time: 12.7052s
	iters: 1000, epoch: 5 | loss: 0.2648484
	speed: 0.0041s/iter; left time: 12.6893s
Updating learning rate to 7.146968456109603e-05
Epoch: 5 cost time: 4.43494176864624
Epoch: 5, Steps: 1027 | Train Loss: 0.4530596 Vali Loss: 0.3844336 Best vali loss: 0.3686361
	iters: 100, epoch: 6 | loss: 0.3655653
	speed: 0.0256s/iter; left time: 76.2835s
	iters: 200, epoch: 6 | loss: 0.4213626
	speed: 0.0037s/iter; left time: 10.7517s
	iters: 300, epoch: 6 | loss: 0.1948859
	speed: 0.0037s/iter; left time: 10.2641s
	iters: 400, epoch: 6 | loss: 0.5903816
	speed: 0.0046s/iter; left time: 12.3151s
	iters: 500, epoch: 6 | loss: 0.3148085
	speed: 0.0058s/iter; left time: 15.0793s
	iters: 600, epoch: 6 | loss: 0.3414797
	speed: 0.0056s/iter; left time: 13.8348s
	iters: 700, epoch: 6 | loss: 0.9914603
	speed: 0.0054s/iter; left time: 12.7798s
	iters: 800, epoch: 6 | loss: 0.3837726
	speed: 0.0047s/iter; left time: 10.8024s
	iters: 900, epoch: 6 | loss: 0.1812156
	speed: 0.0043s/iter; left time: 9.4492s
	iters: 1000, epoch: 6 | loss: 0.4167686
	speed: 0.0047s/iter; left time: 9.7096s
Updating learning rate to 3.390964548202697e-05
Epoch: 6 cost time: 5.139083385467529
Epoch: 6, Steps: 1027 | Train Loss: 0.4201701 Vali Loss: 0.3873444 Best vali loss: 0.3686361
	iters: 100, epoch: 7 | loss: 0.9456574
	speed: 0.0162s/iter; left time: 31.7026s
	iters: 200, epoch: 7 | loss: 0.2053815
	speed: 0.0053s/iter; left time: 9.8470s
	iters: 300, epoch: 7 | loss: 0.4340379
	speed: 0.0052s/iter; left time: 9.1456s
	iters: 400, epoch: 7 | loss: 0.4618173
	speed: 0.0052s/iter; left time: 8.6470s
	iters: 500, epoch: 7 | loss: 0.2787331
	speed: 0.0052s/iter; left time: 8.0903s
	iters: 600, epoch: 7 | loss: 0.2993600
	speed: 0.0052s/iter; left time: 7.6040s
	iters: 700, epoch: 7 | loss: 0.9347270
	speed: 0.0052s/iter; left time: 7.0382s
	iters: 800, epoch: 7 | loss: 0.2818100
	speed: 0.0053s/iter; left time: 6.6065s
	iters: 900, epoch: 7 | loss: 0.9047110
	speed: 0.0051s/iter; left time: 5.8577s
	iters: 1000, epoch: 7 | loss: 0.2985595
	speed: 0.0047s/iter; left time: 4.9145s
Updating learning rate to 8.812829729978956e-06
Epoch: 7 cost time: 5.279133319854736
Epoch: 7, Steps: 1027 | Train Loss: 0.5044795 Vali Loss: 0.3881522 Best vali loss: 0.3686361
	iters: 100, epoch: 8 | loss: 0.6314317
	speed: 0.0185s/iter; left time: 17.1335s
	iters: 200, epoch: 8 | loss: 0.4143878
	speed: 0.0051s/iter; left time: 4.2054s
	iters: 300, epoch: 8 | loss: 0.1755440
	speed: 0.0050s/iter; left time: 3.6093s
	iters: 400, epoch: 8 | loss: 0.3637900
	speed: 0.0045s/iter; left time: 2.8505s
	iters: 500, epoch: 8 | loss: 0.2873030
	speed: 0.0044s/iter; left time: 2.3457s
	iters: 600, epoch: 8 | loss: 0.2073890
	speed: 0.0049s/iter; left time: 2.1045s
	iters: 700, epoch: 8 | loss: 0.5874037
	speed: 0.0051s/iter; left time: 1.6886s
	iters: 800, epoch: 8 | loss: 0.4182417
	speed: 0.0044s/iter; left time: 1.0079s
	iters: 900, epoch: 8 | loss: 0.3394124
	speed: 0.0047s/iter; left time: 0.5963s
	iters: 1000, epoch: 8 | loss: 0.7270529
	speed: 0.0051s/iter; left time: 0.1439s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.084362030029297
Epoch: 8, Steps: 1027 | Train Loss: 0.4151956 Vali Loss: 0.3884007 Best vali loss: 0.3686361

best validation loss 0.3686360568335108

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6614438
	speed: 0.0152s/iter; left time: 60.8741s
	iters: 200, epoch: 1 | loss: 0.3293164
	speed: 0.0112s/iter; left time: 43.9929s
	iters: 300, epoch: 1 | loss: 0.5943259
	speed: 0.0104s/iter; left time: 39.4956s
	iters: 400, epoch: 1 | loss: 0.6864855
	speed: 0.0132s/iter; left time: 49.0863s
	iters: 500, epoch: 1 | loss: 0.4953537
	speed: 0.0142s/iter; left time: 51.3078s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 6.299502611160278
Epoch: 1, Steps: 514 | Train Loss: 0.5533851 Vali Loss: 0.3674560 Best vali loss: 0.3674560
	iters: 100, epoch: 2 | loss: 0.8554691
	speed: 0.0653s/iter; left time: 228.3836s
	iters: 200, epoch: 2 | loss: 0.4535390
	speed: 0.0150s/iter; left time: 51.0105s
	iters: 300, epoch: 2 | loss: 0.3059417
	speed: 0.0146s/iter; left time: 48.1230s
	iters: 400, epoch: 2 | loss: 0.9975578
	speed: 0.0129s/iter; left time: 41.1098s
	iters: 500, epoch: 2 | loss: 0.3965483
	speed: 0.0107s/iter; left time: 33.2505s
Updating learning rate to 0.00047560308946149616
Epoch: 2 cost time: 6.932992696762085
Epoch: 2, Steps: 514 | Train Loss: 0.6018112 Vali Loss: 0.3806192 Best vali loss: 0.3674560
	iters: 100, epoch: 3 | loss: 0.6866084
	speed: 0.0332s/iter; left time: 98.9616s
	iters: 200, epoch: 3 | loss: 0.5534713
	speed: 0.0074s/iter; left time: 21.2687s
	iters: 300, epoch: 3 | loss: 0.5596405
	speed: 0.0061s/iter; left time: 16.9120s
	iters: 400, epoch: 3 | loss: 0.4009785
	speed: 0.0113s/iter; left time: 30.4007s
	iters: 500, epoch: 3 | loss: 0.5278870
	speed: 0.0096s/iter; left time: 24.7600s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.3675 --> 0.3614).  Saving model state dict ...
Epoch: 3 cost time: 4.68513298034668
Epoch: 3, Steps: 514 | Train Loss: 0.5457171 Vali Loss: 0.3614291 Best vali loss: 0.3614291

best validation loss 0.3614290850277265

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7859181
	speed: 0.0169s/iter; left time: 33.0587s
	iters: 200, epoch: 1 | loss: 0.8837656
	speed: 0.0076s/iter; left time: 14.0332s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.3992).  Saving model state dict ...
Epoch: 1 cost time: 2.508847713470459
Epoch: 1, Steps: 257 | Train Loss: 0.8348418 Vali Loss: 0.3992110 Best vali loss: 0.3992110
	iters: 100, epoch: 2 | loss: 0.6662222
	speed: 0.0184s/iter; left time: 31.3463s
	iters: 200, epoch: 2 | loss: 0.5375297
	speed: 0.0098s/iter; left time: 15.7210s
Updating learning rate to 0.003956246664976659
Epoch: 2 cost time: 2.591531991958618
Epoch: 2, Steps: 257 | Train Loss: 0.6018759 Vali Loss: 0.4058379 Best vali loss: 0.3992110
	iters: 100, epoch: 3 | loss: 0.4050432
	speed: 0.0218s/iter; left time: 31.4668s
	iters: 200, epoch: 3 | loss: 0.5945272
	speed: 0.0085s/iter; left time: 11.4530s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 2.2494118213653564
Epoch: 3, Steps: 257 | Train Loss: 0.4997852 Vali Loss: 0.4027122 Best vali loss: 0.3992110

best validation loss 0.39921095325576766

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008416951448, 'e_layers': 2, 'learning_rate': 0.0004829801385, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004645978015348082
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 0.9027841091156006
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3650285 Best vali loss: 0.3650285
Updating learning rate to 0.0004122493348058839
Epoch: 2 cost time: 0.6334519386291504
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3941972 Best vali loss: 0.3650285
Updating learning rate to 0.0003339043178326732
Epoch: 3 cost time: 0.6438467502593994
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3782644 Best vali loss: 0.3650285

best validation loss 0.36502851644761436

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5674187
	speed: 0.0164s/iter; left time: 40.4200s
	iters: 200, epoch: 4 | loss: 0.3194783
	speed: 0.0106s/iter; left time: 25.0881s
	iters: 300, epoch: 4 | loss: 0.5962842
	speed: 0.0101s/iter; left time: 23.0382s
	iters: 400, epoch: 4 | loss: 0.6003875
	speed: 0.0107s/iter; left time: 23.1659s
	iters: 500, epoch: 4 | loss: 0.4513442
	speed: 0.0116s/iter; left time: 24.1182s
Updating learning rate to 0.0002786018395
Epoch: 4 cost time: 5.783646106719971
Epoch: 4, Steps: 514 | Train Loss: 0.5069826 Vali Loss: 0.3635054 Best vali loss: 0.3614291
	iters: 100, epoch: 5 | loss: 0.7521855
	speed: 0.0356s/iter; left time: 69.7267s
	iters: 200, epoch: 5 | loss: 0.3266099
	speed: 0.0106s/iter; left time: 19.6306s
	iters: 300, epoch: 5 | loss: 0.3215299
	speed: 0.0110s/iter; left time: 19.3134s
	iters: 400, epoch: 5 | loss: 0.8085120
	speed: 0.0114s/iter; left time: 18.9438s
	iters: 500, epoch: 5 | loss: 0.3653247
	speed: 0.0116s/iter; left time: 18.0460s
Updating learning rate to 0.0001719855312969122
Epoch: 5 cost time: 5.78770899772644
Epoch: 5, Steps: 514 | Train Loss: 0.5148324 Vali Loss: 0.3717652 Best vali loss: 0.3614291
	iters: 100, epoch: 6 | loss: 0.5970094
	speed: 0.0315s/iter; left time: 45.4062s
	iters: 200, epoch: 6 | loss: 0.4795220
	speed: 0.0105s/iter; left time: 14.1130s
	iters: 300, epoch: 6 | loss: 0.5565881
	speed: 0.0104s/iter; left time: 12.8881s
	iters: 400, epoch: 6 | loss: 0.3200724
	speed: 0.0148s/iter; left time: 16.8937s
	iters: 500, epoch: 6 | loss: 0.4945356
	speed: 0.0081s/iter; left time: 8.4040s
Updating learning rate to 8.160058953850389e-05
Validation loss decreased (0.3614 --> 0.3535).  Saving model state dict ...
Epoch: 6 cost time: 5.543110132217407
Epoch: 6, Steps: 514 | Train Loss: 0.4895455 Vali Loss: 0.3535495 Best vali loss: 0.3535495
	iters: 100, epoch: 7 | loss: 0.8983988
	speed: 0.0169s/iter; left time: 15.6851s
	iters: 200, epoch: 7 | loss: 0.3312137
	speed: 0.0097s/iter; left time: 8.0134s
	iters: 300, epoch: 7 | loss: 0.2364623
	speed: 0.0098s/iter; left time: 7.1473s
	iters: 400, epoch: 7 | loss: 0.2763527
	speed: 0.0093s/iter; left time: 5.8492s
	iters: 500, epoch: 7 | loss: 0.6035196
	speed: 0.0100s/iter; left time: 5.2756s
Updating learning rate to 2.1207302265955462e-05
Epoch: 7 cost time: 4.809325933456421
Epoch: 7, Steps: 514 | Train Loss: 0.4691894 Vali Loss: 0.3623653 Best vali loss: 0.3535495
	iters: 100, epoch: 8 | loss: 0.7058926
	speed: 0.0196s/iter; left time: 8.1348s
	iters: 200, epoch: 8 | loss: 0.4554962
	speed: 0.0081s/iter; left time: 2.5376s
	iters: 300, epoch: 8 | loss: 0.5988101
	speed: 0.0090s/iter; left time: 1.9300s
	iters: 400, epoch: 8 | loss: 0.3374281
	speed: 0.0075s/iter; left time: 0.8660s
	iters: 500, epoch: 8 | loss: 0.6161625
	speed: 0.0061s/iter; left time: 0.0916s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.2418177127838135
Epoch: 8, Steps: 514 | Train Loss: 0.5427579 Vali Loss: 0.3580084 Best vali loss: 0.3535495

best validation loss 0.35354945235144647

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010061079077, 'e_layers': 4, 'learning_rate': 0.0003121493614, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2993253
	speed: 0.0158s/iter; left time: 127.8615s
	iters: 200, epoch: 1 | loss: 0.3364706
	speed: 0.0107s/iter; left time: 86.1343s
	iters: 300, epoch: 1 | loss: 0.8133932
	speed: 0.0099s/iter; left time: 78.4099s
	iters: 400, epoch: 1 | loss: 0.4099902
	speed: 0.0109s/iter; left time: 84.8253s
	iters: 500, epoch: 1 | loss: 0.3175190
	speed: 0.0075s/iter; left time: 58.0532s
	iters: 600, epoch: 1 | loss: 0.4764484
	speed: 0.0060s/iter; left time: 45.4377s
	iters: 700, epoch: 1 | loss: 0.2574763
	speed: 0.0087s/iter; left time: 65.1919s
	iters: 800, epoch: 1 | loss: 0.3552743
	speed: 0.0093s/iter; left time: 68.7316s
	iters: 900, epoch: 1 | loss: 0.4488798
	speed: 0.0083s/iter; left time: 60.9637s
	iters: 1000, epoch: 1 | loss: 1.7225883
	speed: 0.0091s/iter; left time: 65.4741s
Updating learning rate to 0.00030026888374196434
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 9.527966022491455
Epoch: 1, Steps: 1027 | Train Loss: 0.5437365 Vali Loss: 0.3696850 Best vali loss: 0.3696850
	iters: 100, epoch: 2 | loss: 0.2770159
	speed: 0.0239s/iter; left time: 169.5314s
	iters: 200, epoch: 2 | loss: 0.4618627
	speed: 0.0093s/iter; left time: 64.9505s
	iters: 300, epoch: 2 | loss: 1.0302619
	speed: 0.0091s/iter; left time: 62.6970s
	iters: 400, epoch: 2 | loss: 0.5203225
	speed: 0.0101s/iter; left time: 68.5016s
	iters: 500, epoch: 2 | loss: 0.9159164
	speed: 0.0100s/iter; left time: 66.6009s
	iters: 600, epoch: 2 | loss: 0.3430715
	speed: 0.0107s/iter; left time: 70.4330s
	iters: 700, epoch: 2 | loss: 0.2459391
	speed: 0.0092s/iter; left time: 59.4057s
	iters: 800, epoch: 2 | loss: 0.6755192
	speed: 0.0091s/iter; left time: 57.9941s
	iters: 900, epoch: 2 | loss: 0.2134809
	speed: 0.0094s/iter; left time: 59.0109s
	iters: 1000, epoch: 2 | loss: 0.4973834
	speed: 0.0085s/iter; left time: 52.7630s
Updating learning rate to 0.0002664361457944952
Validation loss decreased (0.3697 --> 0.3681).  Saving model state dict ...
Epoch: 2 cost time: 9.784168720245361
Epoch: 2, Steps: 1027 | Train Loss: 0.5180773 Vali Loss: 0.3681350 Best vali loss: 0.3681350
	iters: 100, epoch: 3 | loss: 0.2249078
	speed: 0.0243s/iter; left time: 147.5847s
	iters: 200, epoch: 3 | loss: 0.8097757
	speed: 0.0082s/iter; left time: 49.0159s
	iters: 300, epoch: 3 | loss: 0.1874997
	speed: 0.0082s/iter; left time: 47.9905s
	iters: 400, epoch: 3 | loss: 0.8539187
	speed: 0.0083s/iter; left time: 47.8069s
	iters: 500, epoch: 3 | loss: 0.7895914
	speed: 0.0083s/iter; left time: 47.0845s
	iters: 600, epoch: 3 | loss: 1.3287636
	speed: 0.0096s/iter; left time: 53.2548s
	iters: 700, epoch: 3 | loss: 0.5296351
	speed: 0.0103s/iter; left time: 56.3472s
	iters: 800, epoch: 3 | loss: 0.4679234
	speed: 0.0085s/iter; left time: 45.7888s
	iters: 900, epoch: 3 | loss: 0.2756712
	speed: 0.0095s/iter; left time: 49.8221s
	iters: 1000, epoch: 3 | loss: 0.3032040
	speed: 0.0091s/iter; left time: 47.2103s
Updating learning rate to 0.00021580187521556143
Epoch: 3 cost time: 9.127026796340942
Epoch: 3, Steps: 1027 | Train Loss: 0.5770891 Vali Loss: 0.3969978 Best vali loss: 0.3681350
	iters: 100, epoch: 4 | loss: 0.5139775
	speed: 0.0246s/iter; left time: 123.7593s
	iters: 200, epoch: 4 | loss: 0.2591117
	speed: 0.0093s/iter; left time: 46.0375s
	iters: 300, epoch: 4 | loss: 0.2060848
	speed: 0.0091s/iter; left time: 43.7676s
	iters: 400, epoch: 4 | loss: 0.2181023
	speed: 0.0076s/iter; left time: 35.9744s
	iters: 500, epoch: 4 | loss: 0.2422606
	speed: 0.0077s/iter; left time: 35.6279s
	iters: 600, epoch: 4 | loss: 0.7904310
	speed: 0.0131s/iter; left time: 59.6084s
	iters: 700, epoch: 4 | loss: 0.8852587
	speed: 0.0099s/iter; left time: 43.8913s
	iters: 800, epoch: 4 | loss: 1.0154661
	speed: 0.0109s/iter; left time: 47.2550s
	iters: 900, epoch: 4 | loss: 1.0072361
	speed: 0.0100s/iter; left time: 42.3880s
	iters: 1000, epoch: 4 | loss: 0.5407797
	speed: 0.0102s/iter; left time: 42.0069s
Updating learning rate to 0.0001560746807
Epoch: 4 cost time: 10.009732007980347
Epoch: 4, Steps: 1027 | Train Loss: 0.5678708 Vali Loss: 0.3954008 Best vali loss: 0.3681350
	iters: 100, epoch: 5 | loss: 0.1996123
	speed: 0.0207s/iter; left time: 82.9505s
	iters: 200, epoch: 5 | loss: 0.4847705
	speed: 0.0065s/iter; left time: 25.2700s
	iters: 300, epoch: 5 | loss: 0.4825100
	speed: 0.0080s/iter; left time: 30.4452s
	iters: 400, epoch: 5 | loss: 0.4130778
	speed: 0.0081s/iter; left time: 29.8922s
	iters: 500, epoch: 5 | loss: 1.5191861
	speed: 0.0073s/iter; left time: 26.4646s
	iters: 600, epoch: 5 | loss: 0.4492613
	speed: 0.0074s/iter; left time: 25.9127s
	iters: 700, epoch: 5 | loss: 0.4944858
	speed: 0.0102s/iter; left time: 34.7458s
	iters: 800, epoch: 5 | loss: 0.6398831
	speed: 0.0083s/iter; left time: 27.5385s
	iters: 900, epoch: 5 | loss: 0.7869591
	speed: 0.0070s/iter; left time: 22.5904s
	iters: 1000, epoch: 5 | loss: 0.3719230
	speed: 0.0066s/iter; left time: 20.4397s
Updating learning rate to 9.634748618443858e-05
Epoch: 5 cost time: 7.856999635696411
Epoch: 5, Steps: 1027 | Train Loss: 0.5841669 Vali Loss: 0.4088655 Best vali loss: 0.3681350
	iters: 100, epoch: 6 | loss: 0.1997027
	speed: 0.0182s/iter; left time: 54.3553s
	iters: 200, epoch: 6 | loss: 0.7941909
	speed: 0.0068s/iter; left time: 19.4855s
	iters: 300, epoch: 6 | loss: 0.5149869
	speed: 0.0073s/iter; left time: 20.4215s
	iters: 400, epoch: 6 | loss: 0.2773542
	speed: 0.0081s/iter; left time: 21.7617s
	iters: 500, epoch: 6 | loss: 0.2807045
	speed: 0.0079s/iter; left time: 20.3905s
	iters: 600, epoch: 6 | loss: 0.3947813
	speed: 0.0077s/iter; left time: 19.0628s
	iters: 700, epoch: 6 | loss: 0.5074536
	speed: 0.0096s/iter; left time: 22.9011s
	iters: 800, epoch: 6 | loss: 0.8766829
	speed: 0.0087s/iter; left time: 19.8273s
	iters: 900, epoch: 6 | loss: 0.4682820
	speed: 0.0090s/iter; left time: 19.5941s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 0.0001452060165, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7033403
	speed: 0.0156s/iter; left time: 126.8667s
	iters: 200, epoch: 1 | loss: 0.4963709
	speed: 0.0084s/iter; left time: 67.0442s
	iters: 300, epoch: 1 | loss: 0.3031874
	speed: 0.0087s/iter; left time: 68.6533s
	iters: 400, epoch: 1 | loss: 0.6249242
	speed: 0.0076s/iter; left time: 59.0970s
	iters: 500, epoch: 1 | loss: 1.0381565
	speed: 0.0078s/iter; left time: 59.9586s
	iters: 600, epoch: 1 | loss: 0.3501978
	speed: 0.0054s/iter; left time: 41.0898s
	iters: 700, epoch: 1 | loss: 0.4275706
	speed: 0.0095s/iter; left time: 71.7840s
	iters: 800, epoch: 1 | loss: 0.2222517
	speed: 0.0070s/iter; left time: 51.9037s
	iters: 900, epoch: 1 | loss: 0.7399468
	speed: 0.0097s/iter; left time: 71.3251s
	iters: 1000, epoch: 1 | loss: 0.3128519
	speed: 0.0069s/iter; left time: 50.0542s
Updating learning rate to 0.0001396794415709231
Validation loss decreased (inf --> 0.3804).  Saving model state dict ...
Epoch: 1 cost time: 8.530248880386353
Epoch: 1, Steps: 1027 | Train Loss: 0.5218798 Vali Loss: 0.3803993 Best vali loss: 0.3803993
	iters: 100, epoch: 2 | loss: 0.2891306
	speed: 0.0220s/iter; left time: 156.0472s
	iters: 200, epoch: 2 | loss: 0.7547448
	speed: 0.0081s/iter; left time: 56.8809s
	iters: 300, epoch: 2 | loss: 1.0223334
	speed: 0.0105s/iter; left time: 72.3440s
	iters: 400, epoch: 2 | loss: 0.6945688
	speed: 0.0088s/iter; left time: 59.5353s
	iters: 500, epoch: 2 | loss: 1.7627589
	speed: 0.0072s/iter; left time: 47.9733s
	iters: 600, epoch: 2 | loss: 0.6119747
	speed: 0.0098s/iter; left time: 64.8818s
	iters: 700, epoch: 2 | loss: 0.5757700
	speed: 0.0075s/iter; left time: 48.8497s
	iters: 800, epoch: 2 | loss: 0.4456766
	speed: 0.0061s/iter; left time: 39.2492s
	iters: 900, epoch: 2 | loss: 0.7627926
	speed: 0.0071s/iter; left time: 44.5061s
	iters: 1000, epoch: 2 | loss: 0.6439679
	speed: 0.0061s/iter; left time: 37.6466s
Updating learning rate to 0.00012394108771811787
Validation loss decreased (0.3804 --> 0.3688).  Saving model state dict ...
Epoch: 2 cost time: 8.398151397705078
Epoch: 2, Steps: 1027 | Train Loss: 0.7563718 Vali Loss: 0.3688115 Best vali loss: 0.3688115
	iters: 100, epoch: 3 | loss: 0.3633516
	speed: 0.0191s/iter; left time: 115.9437s
	iters: 200, epoch: 3 | loss: 0.1838558
	speed: 0.0092s/iter; left time: 54.7705s
	iters: 300, epoch: 3 | loss: 1.8640051
	speed: 0.0101s/iter; left time: 59.4354s
	iters: 400, epoch: 3 | loss: 0.2658050
	speed: 0.0076s/iter; left time: 43.9584s
	iters: 500, epoch: 3 | loss: 0.3712659
	speed: 0.0107s/iter; left time: 60.8015s
	iters: 600, epoch: 3 | loss: 0.5343891
	speed: 0.0094s/iter; left time: 52.1190s
	iters: 700, epoch: 3 | loss: 0.4937758
	speed: 0.0109s/iter; left time: 59.6546s
	iters: 800, epoch: 3 | loss: 0.2762935
	speed: 0.0086s/iter; left time: 46.0182s
	iters: 900, epoch: 3 | loss: 0.3849433
	speed: 0.0104s/iter; left time: 54.6864s
	iters: 1000, epoch: 3 | loss: 0.2965255
	speed: 0.0085s/iter; left time: 43.9644s
Updating learning rate to 0.00010038697664714094
Validation loss decreased (0.3688 --> 0.3664).  Saving model state dict ...
Epoch: 3 cost time: 9.3044114112854
Epoch: 3, Steps: 1027 | Train Loss: 0.5034211 Vali Loss: 0.3664280 Best vali loss: 0.3664280
	iters: 100, epoch: 4 | loss: 0.5027555
	speed: 0.0247s/iter; left time: 124.5709s
	iters: 200, epoch: 4 | loss: 0.7036850
	speed: 0.0066s/iter; left time: 32.5365s
	iters: 300, epoch: 4 | loss: 1.8014916
	speed: 0.0074s/iter; left time: 35.8188s
	iters: 400, epoch: 4 | loss: 0.4201625
	speed: 0.0075s/iter; left time: 35.5072s
	iters: 500, epoch: 4 | loss: 0.6408217
	speed: 0.0074s/iter; left time: 34.2057s
	iters: 600, epoch: 4 | loss: 0.4965191
	speed: 0.0072s/iter; left time: 32.4862s
	iters: 700, epoch: 4 | loss: 0.5056259
	speed: 0.0068s/iter; left time: 30.3395s
	iters: 800, epoch: 4 | loss: 0.4239410
	speed: 0.0067s/iter; left time: 29.0224s
	iters: 900, epoch: 4 | loss: 0.3497611
	speed: 0.0069s/iter; left time: 29.2618s
	iters: 1000, epoch: 4 | loss: 0.2908881
	speed: 0.0070s/iter; left time: 28.7842s
Updating learning rate to 7.260300825e-05
Validation loss decreased (0.3664 --> 0.3651).  Saving model state dict ...
Epoch: 4 cost time: 7.032997131347656
Epoch: 4, Steps: 1027 | Train Loss: 0.6135651 Vali Loss: 0.3651073 Best vali loss: 0.3651073
	iters: 100, epoch: 5 | loss: 0.3232974
	speed: 0.0216s/iter; left time: 86.6177s
	iters: 200, epoch: 5 | loss: 1.1075535
	speed: 0.0076s/iter; left time: 29.8619s
	iters: 300, epoch: 5 | loss: 0.8115934
	speed: 0.0081s/iter; left time: 30.6906s
	iters: 400, epoch: 5 | loss: 0.3354748
	speed: 0.0081s/iter; left time: 30.0203s
	iters: 500, epoch: 5 | loss: 0.2596322
	speed: 0.0078s/iter; left time: 28.2418s
	iters: 600, epoch: 5 | loss: 0.6391985
	speed: 0.0069s/iter; left time: 24.2065s
	iters: 700, epoch: 5 | loss: 0.9160553
	speed: 0.0075s/iter; left time: 25.5168s
	iters: 800, epoch: 5 | loss: 0.3271385
	speed: 0.0082s/iter; left time: 27.1303s
	iters: 900, epoch: 5 | loss: 0.2618805
	speed: 0.0080s/iter; left time: 25.7316s
	iters: 1000, epoch: 5 | loss: 0.2231887
	speed: 0.0081s/iter; left time: 25.2536s
Updating learning rate to 4.4819039852859076e-05
Epoch: 5 cost time: 8.035488367080688
Epoch: 5, Steps: 1027 | Train Loss: 0.5205013 Vali Loss: 0.3663525 Best vali loss: 0.3651073
	iters: 100, epoch: 6 | loss: 0.5508362
	speed: 0.0241s/iter; left time: 71.8132s
	iters: 200, epoch: 6 | loss: 0.9419182
	speed: 0.0060s/iter; left time: 17.3382s
	iters: 300, epoch: 6 | loss: 1.0706842
	speed: 0.0072s/iter; left time: 19.8959s
	iters: 400, epoch: 6 | loss: 0.4227068
	speed: 0.0068s/iter; left time: 18.2787s
	iters: 500, epoch: 6 | loss: 0.3373711
	speed: 0.0071s/iter; left time: 18.2731s
	iters: 600, epoch: 6 | loss: 1.0328996
	speed: 0.0081s/iter; left time: 20.0447s
	iters: 700, epoch: 6 | loss: 0.7750881
	speed: 0.0082s/iter; left time: 19.4483s
	iters: 800, epoch: 6 | loss: 0.3281223
	speed: 0.0083s/iter; left time: 19.0051s
	iters: 900, epoch: 6 | loss: 0.3864097
	speed: 0.0071s/iter; left time: 15.4533s
	iters: 1000, epoch: 6 | loss: 1.3429449
	speed: 0.0072s/iter; left time: 15.0088s
Updating learning rate to 2.126492878188215e-05
Epoch: 6 cost time: 7.448968887329102
Epoch: 6, Steps: 1027 | Train Loss: 0.7188981 Vali Loss: 0.3659912 Best vali loss: 0.3651073
	iters: 100, epoch: 7 | loss: 0.5232950
	speed: 0.0263s/iter; left time: 51.3817s
	iters: 200, epoch: 7 | loss: 0.9237478
	speed: 0.0073s/iter; left time: 13.6060s
	iters: 300, epoch: 7 | loss: 0.4845288
	speed: 0.0065s/iter; left time: 11.3603s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6256120
	speed: 0.0130s/iter; left time: 25.3485s
	iters: 200, epoch: 1 | loss: 1.1427554
	speed: 0.0066s/iter; left time: 12.3298s
Updating learning rate to 0.000185960463
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 2.0392072200775146
Epoch: 1, Steps: 257 | Train Loss: 0.8841837 Vali Loss: 0.3645713 Best vali loss: 0.3645713
	iters: 100, epoch: 2 | loss: 0.5856410
	speed: 0.0159s/iter; left time: 26.9770s
	iters: 200, epoch: 2 | loss: 0.5112541
	speed: 0.0063s/iter; left time: 10.0625s
Updating learning rate to 9.29802315e-05
Epoch: 2 cost time: 1.643371343612671
Epoch: 2, Steps: 257 | Train Loss: 0.5484475 Vali Loss: 0.3686355 Best vali loss: 0.3645713
	iters: 100, epoch: 3 | loss: 0.6512255
	speed: 0.0146s/iter; left time: 21.0054s
	iters: 200, epoch: 3 | loss: 0.6050138
	speed: 0.0055s/iter; left time: 7.4203s
Updating learning rate to 4.649011575e-05
Epoch: 3 cost time: 1.5976746082305908
Epoch: 3, Steps: 257 | Train Loss: 0.6281196 Vali Loss: 0.3661845 Best vali loss: 0.3645713

best validation loss 0.36457132343458987

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0021821256011, 'e_layers': 4, 'learning_rate': 0.0002214516301, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6707996
	speed: 0.0187s/iter; left time: 17.4890s
Updating learning rate to 0.0002214516301
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 2.114628314971924
Epoch: 1, Steps: 129 | Train Loss: 0.6707996 Vali Loss: 0.3799801 Best vali loss: 0.3799801
	iters: 100, epoch: 2 | loss: 0.4957326
	speed: 0.0321s/iter; left time: 25.8307s
Updating learning rate to 0.00011072581505
Validation loss decreased (0.3800 --> 0.3715).  Saving model state dict ...
Epoch: 2 cost time: 2.7971932888031006
Epoch: 2, Steps: 129 | Train Loss: 0.4957326 Vali Loss: 0.3714889 Best vali loss: 0.3714889
	iters: 100, epoch: 3 | loss: 0.8258082
	speed: 0.0645s/iter; left time: 43.5508s
Updating learning rate to 5.5362907525e-05
Validation loss decreased (0.3715 --> 0.3688).  Saving model state dict ...
Epoch: 3 cost time: 4.7647035121917725
Epoch: 3, Steps: 129 | Train Loss: 0.8258082 Vali Loss: 0.3687609 Best vali loss: 0.3687609

best validation loss 0.368760948553535

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001453621946, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5199919
	speed: 0.0168s/iter; left time: 136.4375s
	iters: 200, epoch: 1 | loss: 0.9387329
	speed: 0.0093s/iter; left time: 74.9127s
	iters: 300, epoch: 1 | loss: 1.0398530
	speed: 0.0107s/iter; left time: 84.3611s
	iters: 400, epoch: 1 | loss: 0.6047484
	speed: 0.0079s/iter; left time: 61.6980s
	iters: 500, epoch: 1 | loss: 1.0813408
	speed: 0.0126s/iter; left time: 97.3789s
	iters: 600, epoch: 1 | loss: 1.2872440
	speed: 0.0134s/iter; left time: 101.7568s
	iters: 700, epoch: 1 | loss: 0.3883696
	speed: 0.0123s/iter; left time: 92.7626s
	iters: 800, epoch: 1 | loss: 0.4667662
	speed: 0.0092s/iter; left time: 68.4496s
	iters: 900, epoch: 1 | loss: 0.3628872
	speed: 0.0086s/iter; left time: 62.9484s
	iters: 1000, epoch: 1 | loss: 0.2038157
	speed: 0.0085s/iter; left time: 61.5129s
Updating learning rate to 0.0001453621946
Validation loss decreased (inf --> 0.3826).  Saving model state dict ...
Epoch: 1 cost time: 10.88960313796997
Epoch: 1, Steps: 1027 | Train Loss: 0.6893750 Vali Loss: 0.3826442 Best vali loss: 0.3826442
	iters: 100, epoch: 2 | loss: 0.6916932
	speed: 0.0243s/iter; left time: 172.3383s
	iters: 200, epoch: 2 | loss: 0.2959470
	speed: 0.0070s/iter; left time: 49.1577s
	iters: 300, epoch: 2 | loss: 0.4252484
	speed: 0.0069s/iter; left time: 47.4693s
	iters: 400, epoch: 2 | loss: 0.3408854
	speed: 0.0085s/iter; left time: 57.5442s
	iters: 500, epoch: 2 | loss: 0.9343298
	speed: 0.0085s/iter; left time: 57.1066s
	iters: 600, epoch: 2 | loss: 0.2235238
	speed: 0.0089s/iter; left time: 58.6097s
	iters: 700, epoch: 2 | loss: 0.4092609
	speed: 0.0080s/iter; left time: 51.7807s
	iters: 800, epoch: 2 | loss: 1.2605628
	speed: 0.0090s/iter; left time: 57.4674s
	iters: 900, epoch: 2 | loss: 0.7757936
	speed: 0.0078s/iter; left time: 48.7667s
	iters: 1000, epoch: 2 | loss: 0.9758139
	speed: 0.0076s/iter; left time: 47.2969s
Updating learning rate to 7.26810973e-05
Validation loss decreased (0.3826 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 8.294726371765137
Epoch: 2, Steps: 1027 | Train Loss: 0.6333059 Vali Loss: 0.3691257 Best vali loss: 0.3691257
	iters: 100, epoch: 3 | loss: 0.6202755
	speed: 0.0261s/iter; left time: 158.3393s
	iters: 200, epoch: 3 | loss: 0.2728947
	speed: 0.0066s/iter; left time: 39.6289s
	iters: 300, epoch: 3 | loss: 0.2960848
	speed: 0.0048s/iter; left time: 28.3426s
	iters: 400, epoch: 3 | loss: 0.4168603
	speed: 0.0066s/iter; left time: 37.9977s
	iters: 500, epoch: 3 | loss: 0.8143839
	speed: 0.0080s/iter; left time: 45.3739s
	iters: 600, epoch: 3 | loss: 1.1245793
	speed: 0.0066s/iter; left time: 36.9731s
	iters: 700, epoch: 3 | loss: 0.1774207
	speed: 0.0074s/iter; left time: 40.5884s
	iters: 800, epoch: 3 | loss: 0.2134639
	speed: 0.0080s/iter; left time: 42.8043s
	iters: 900, epoch: 3 | loss: 0.5186978
	speed: 0.0080s/iter; left time: 42.3011s
	iters: 1000, epoch: 3 | loss: 1.0682404
	speed: 0.0082s/iter; left time: 42.4702s
Updating learning rate to 3.634054865e-05
Validation loss decreased (0.3691 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 7.5138678550720215
Epoch: 3, Steps: 1027 | Train Loss: 0.5522901 Vali Loss: 0.3673008 Best vali loss: 0.3673008

best validation loss 0.36730077763203317

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5993374
	speed: 0.0129s/iter; left time: 15.2542s
	iters: 200, epoch: 4 | loss: 0.9205378
	speed: 0.0061s/iter; left time: 6.5787s
Updating learning rate to 2.3245057875e-05
Epoch: 4 cost time: 1.9293875694274902
Epoch: 4, Steps: 257 | Train Loss: 0.7599376 Vali Loss: 0.3686418 Best vali loss: 0.3645713
	iters: 100, epoch: 5 | loss: 0.5629799
	speed: 0.0142s/iter; left time: 13.1920s
	iters: 200, epoch: 5 | loss: 0.4495971
	speed: 0.0056s/iter; left time: 4.6172s
Updating learning rate to 1.16225289375e-05
Epoch: 5 cost time: 1.5398616790771484
Epoch: 5, Steps: 257 | Train Loss: 0.5062885 Vali Loss: 0.3725484 Best vali loss: 0.3645713
	iters: 100, epoch: 6 | loss: 0.5495468
	speed: 0.0145s/iter; left time: 9.7376s
	iters: 200, epoch: 6 | loss: 0.5419233
	speed: 0.0058s/iter; left time: 3.3178s
Updating learning rate to 5.81126446875e-06
Epoch: 6 cost time: 1.5268094539642334
Epoch: 6, Steps: 257 | Train Loss: 0.5457350 Vali Loss: 0.3727872 Best vali loss: 0.3645713
	iters: 100, epoch: 7 | loss: 0.3077003
	speed: 0.0275s/iter; left time: 11.4048s
	iters: 200, epoch: 7 | loss: 0.4131879
	speed: 0.0127s/iter; left time: 3.9963s
Updating learning rate to 2.905632234375e-06
Epoch: 7 cost time: 3.324322462081909
Epoch: 7, Steps: 257 | Train Loss: 0.3604441 Vali Loss: 0.3723202 Best vali loss: 0.3645713
	iters: 100, epoch: 8 | loss: 0.7711427
	speed: 0.0326s/iter; left time: 5.1578s
	iters: 200, epoch: 8 | loss: 0.5525072
	speed: 0.0120s/iter; left time: 0.6967s
Updating learning rate to 1.4528161171875e-06
Epoch: 8 cost time: 3.134042978286743
Epoch: 8, Steps: 257 | Train Loss: 0.6618250 Vali Loss: 0.3720986 Best vali loss: 0.3645713

best validation loss 0.36457132343458987

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0014517716849, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7581623
	speed: 0.0100s/iter; left time: 19.5014s
	iters: 200, epoch: 1 | loss: 0.9797500
	speed: 0.0039s/iter; left time: 7.2980s
Updating learning rate to 0.0003060628921
Validation loss decreased (inf --> 0.3855).  Saving model state dict ...
Epoch: 1 cost time: 1.5752389430999756
Epoch: 1, Steps: 257 | Train Loss: 0.8689561 Vali Loss: 0.3854681 Best vali loss: 0.3854681
	iters: 100, epoch: 2 | loss: 0.9805225
	speed: 0.0172s/iter; left time: 29.1769s
	iters: 200, epoch: 2 | loss: 0.8885698
	speed: 0.0071s/iter; left time: 11.3814s
Updating learning rate to 0.00015303144605
Validation loss decreased (0.3855 --> 0.3684).  Saving model state dict ...
Epoch: 2 cost time: 2.0581507682800293
Epoch: 2, Steps: 257 | Train Loss: 0.9345462 Vali Loss: 0.3683854 Best vali loss: 0.3683854
	iters: 100, epoch: 3 | loss: 0.7064896
	speed: 0.0180s/iter; left time: 25.9815s
	iters: 200, epoch: 3 | loss: 0.5800929
	speed: 0.0077s/iter; left time: 10.3482s
Updating learning rate to 7.6515723025e-05
Validation loss decreased (0.3684 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 2.0355732440948486
Epoch: 3, Steps: 257 | Train Loss: 0.6432913 Vali Loss: 0.3662237 Best vali loss: 0.3662237
	iters: 100, epoch: 4 | loss: 1.0567755
	speed: 0.0169s/iter; left time: 20.0566s
	iters: 200, epoch: 4 | loss: 0.7329689
	speed: 0.0070s/iter; left time: 7.6079s
Updating learning rate to 3.82578615125e-05
Validation loss decreased (0.3662 --> 0.3662).  Saving model state dict ...
Epoch: 4 cost time: 1.8169965744018555
Epoch: 4, Steps: 257 | Train Loss: 0.8948722 Vali Loss: 0.3661581 Best vali loss: 0.3661581
	iters: 100, epoch: 5 | loss: 0.4294272
	speed: 0.0159s/iter; left time: 14.7962s
	iters: 200, epoch: 5 | loss: 0.5773917
	speed: 0.0066s/iter; left time: 5.4626s
Updating learning rate to 1.912893075625e-05
Validation loss decreased (0.3662 --> 0.3657).  Saving model state dict ...
Epoch: 5 cost time: 1.8795814514160156
Epoch: 5, Steps: 257 | Train Loss: 0.5034095 Vali Loss: 0.3656789 Best vali loss: 0.3656789
	iters: 100, epoch: 6 | loss: 0.6859244
	speed: 0.0178s/iter; left time: 11.9911s
	iters: 200, epoch: 6 | loss: 0.4140029
	speed: 0.0068s/iter; left time: 3.8914s
Updating learning rate to 9.564465378125e-06
Validation loss decreased (0.3657 --> 0.3656).  Saving model state dict ...
Epoch: 6 cost time: 1.8783304691314697
Epoch: 6, Steps: 257 | Train Loss: 0.5499636 Vali Loss: 0.3656248 Best vali loss: 0.3656248
	iters: 100, epoch: 7 | loss: 0.5971471
	speed: 0.0171s/iter; left time: 7.0829s
	iters: 200, epoch: 7 | loss: 0.5674981
	speed: 0.0068s/iter; left time: 2.1504s
Updating learning rate to 4.7822326890625e-06
Validation loss decreased (0.3656 --> 0.3656).  Saving model state dict ...
Epoch: 7 cost time: 1.898878574371338
Epoch: 7, Steps: 257 | Train Loss: 0.5823226 Vali Loss: 0.3655912 Best vali loss: 0.3655912
	iters: 100, epoch: 8 | loss: 0.6693975
	speed: 0.0166s/iter; left time: 2.6235s
	iters: 200, epoch: 8 | loss: 0.7525582
	speed: 0.0038s/iter; left time: 0.2224s
Updating learning rate to 2.39111634453125e-06
Validation loss decreased (0.3656 --> 0.3656).  Saving model state dict ...
Epoch: 8 cost time: 1.3467886447906494
Epoch: 8, Steps: 257 | Train Loss: 0.7109779 Vali Loss: 0.3655721 Best vali loss: 0.3655721

best validation loss 0.3655720767314401

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0025777605036, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4311485
	speed: 0.0130s/iter; left time: 52.0951s
	iters: 200, epoch: 1 | loss: 0.5073358
	speed: 0.0068s/iter; left time: 26.6585s
	iters: 300, epoch: 1 | loss: 0.4604456
	speed: 0.0070s/iter; left time: 26.6322s
	iters: 400, epoch: 1 | loss: 0.5645162
	speed: 0.0063s/iter; left time: 23.5371s
	iters: 500, epoch: 1 | loss: 0.5644153
	speed: 0.0068s/iter; left time: 24.5552s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 3.7615935802459717
Epoch: 1, Steps: 514 | Train Loss: 0.5055723 Vali Loss: 0.3722303 Best vali loss: 0.3722303
	iters: 100, epoch: 2 | loss: 0.4017132
	speed: 0.0154s/iter; left time: 54.0100s
	iters: 200, epoch: 2 | loss: 0.7488458
	speed: 0.0058s/iter; left time: 19.8773s
	iters: 300, epoch: 2 | loss: 0.8483106
	speed: 0.0058s/iter; left time: 19.2006s
	iters: 400, epoch: 2 | loss: 0.7723917
	speed: 0.0061s/iter; left time: 19.4688s
	iters: 500, epoch: 2 | loss: 0.5306847
	speed: 0.0069s/iter; left time: 21.3882s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.3722 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 3.30843448638916
Epoch: 2, Steps: 514 | Train Loss: 0.6603892 Vali Loss: 0.3689623 Best vali loss: 0.3689623
	iters: 100, epoch: 3 | loss: 0.5601894
	speed: 0.0154s/iter; left time: 45.9189s
	iters: 200, epoch: 3 | loss: 0.2970488
	speed: 0.0065s/iter; left time: 18.7063s
	iters: 300, epoch: 3 | loss: 0.6919547
	speed: 0.0060s/iter; left time: 16.7035s
	iters: 400, epoch: 3 | loss: 0.4728826
	speed: 0.0058s/iter; left time: 15.5402s
	iters: 500, epoch: 3 | loss: 0.3647945
	speed: 0.0065s/iter; left time: 16.7445s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 3.296855926513672
Epoch: 3, Steps: 514 | Train Loss: 0.4773740 Vali Loss: 0.3728868 Best vali loss: 0.3689623
	iters: 100, epoch: 4 | loss: 0.8556451
	speed: 0.0164s/iter; left time: 40.5254s
	iters: 200, epoch: 4 | loss: 0.6028461
	speed: 0.0058s/iter; left time: 13.6841s
	iters: 300, epoch: 4 | loss: 0.4594787
	speed: 0.0067s/iter; left time: 15.3069s
	iters: 400, epoch: 4 | loss: 0.3147869
	speed: 0.0065s/iter; left time: 14.1824s
	iters: 500, epoch: 4 | loss: 0.6870183
	speed: 0.0065s/iter; left time: 13.5399s
Updating learning rate to 0.00015303144605
Epoch: 4 cost time: 3.3777542114257812
Epoch: 4, Steps: 514 | Train Loss: 0.5839550 Vali Loss: 0.3738283 Best vali loss: 0.3689623
	iters: 100, epoch: 5 | loss: 0.6951616
	speed: 0.0144s/iter; left time: 28.1942s
	iters: 200, epoch: 5 | loss: 0.5991715
	speed: 0.0059s/iter; left time: 10.9058s
	iters: 300, epoch: 5 | loss: 0.3226455
	speed: 0.0076s/iter; left time: 13.4403s
	iters: 400, epoch: 5 | loss: 0.9394386
	speed: 0.0062s/iter; left time: 10.2393s
	iters: 500, epoch: 5 | loss: 0.8444990
	speed: 0.0064s/iter; left time: 9.9883s
Updating learning rate to 9.446884701579294e-05
Epoch: 5 cost time: 3.3780405521392822
Epoch: 5, Steps: 514 | Train Loss: 0.6801832 Vali Loss: 0.3718722 Best vali loss: 0.3689623
	iters: 100, epoch: 6 | loss: 0.2814467
	speed: 0.0145s/iter; left time: 20.9683s
	iters: 200, epoch: 6 | loss: 0.7631127
	speed: 0.0063s/iter; left time: 8.4411s
	iters: 300, epoch: 6 | loss: 0.4198683
	speed: 0.0054s/iter; left time: 6.7538s
	iters: 400, epoch: 6 | loss: 1.0623395
	speed: 0.0064s/iter; left time: 7.3321s
	iters: 500, epoch: 6 | loss: 1.0221796
	speed: 0.0066s/iter; left time: 6.9352s
Updating learning rate to 4.4821872813261705e-05
Epoch: 6 cost time: 3.199995756149292
Epoch: 6, Steps: 514 | Train Loss: 0.7097894 Vali Loss: 0.3740863 Best vali loss: 0.3689623
	iters: 100, epoch: 7 | loss: 0.5615113
	speed: 0.0174s/iter; left time: 16.1301s
	iters: 200, epoch: 7 | loss: 0.4102081
	speed: 0.0067s/iter; left time: 5.5339s
	iters: 300, epoch: 7 | loss: 0.2745517
	speed: 0.0068s/iter; left time: 4.9356s
	iters: 400, epoch: 7 | loss: 0.7847376
	speed: 0.0065s/iter; left time: 4.0874s
	iters: 500, epoch: 7 | loss: 0.9761922
	speed: 0.0066s/iter; left time: 3.4827s
Updating learning rate to 1.1648825213799802e-05
Epoch: 7 cost time: 3.4917449951171875
Epoch: 7, Steps: 514 | Train Loss: 0.6014402 Vali Loss: 0.3739939 Best vali loss: 0.3689623
	iters: 100, epoch: 8 | loss: 0.3660883
	speed: 0.0151s/iter; left time: 6.2752s
	iters: 200, epoch: 8 | loss: 0.6393703
	speed: 0.0065s/iter; left time: 2.0454s
	iters: 300, epoch: 8 | loss: 0.3143220
	speed: 0.0067s/iter; left time: 1.4330s
	iters: 400, epoch: 8 | loss: 0.7199289
	speed: 0.0070s/iter; left time: 0.8044s
	iters: 500, epoch: 8 | loss: 0.3193543
	speed: 0.0056s/iter; left time: 0.0836s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2909958362579346
Epoch: 8, Steps: 514 | Train Loss: 0.4718127 Vali Loss: 0.3731142 Best vali loss: 0.3689623

best validation loss 0.3689622916383687

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0018682829331, 'e_layers': 2, 'learning_rate': 0.0025289717944, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6486537
	speed: 0.0166s/iter; left time: 15.4676s
Updating learning rate to 0.0024327185367722507
Validation loss decreased (inf --> 0.3756).  Saving model state dict ...
Epoch: 1 cost time: 1.6258249282836914
Epoch: 1, Steps: 129 | Train Loss: 0.6486537 Vali Loss: 0.3755867 Best vali loss: 0.3755867
	iters: 100, epoch: 2 | loss: 0.7321915
	speed: 0.0173s/iter; left time: 13.9171s
Updating learning rate to 0.0021586124498248756
Epoch: 2 cost time: 1.340153694152832
Epoch: 2, Steps: 129 | Train Loss: 0.7321915 Vali Loss: 0.4022428 Best vali loss: 0.3755867
	iters: 100, epoch: 3 | loss: 0.6242811
	speed: 0.0140s/iter; left time: 9.4583s
Updating learning rate to 0.001748383700517746
Epoch: 3 cost time: 1.1628434658050537
Epoch: 3, Steps: 129 | Train Loss: 0.6242811 Vali Loss: 0.3915030 Best vali loss: 0.3755867

best validation loss 0.3755866947951626

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020076739651, 'e_layers': 4, 'learning_rate': 6.71965198e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5717647
	speed: 0.0219s/iter; left time: 20.4659s
Updating learning rate to 6.71965198e-05
Validation loss decreased (inf --> 0.3631).  Saving model state dict ...
Epoch: 1 cost time: 2.3542494773864746
Epoch: 1, Steps: 129 | Train Loss: 0.5717647 Vali Loss: 0.3630822 Best vali loss: 0.3630822
	iters: 100, epoch: 2 | loss: 0.5514997
	speed: 0.0241s/iter; left time: 19.3758s
Updating learning rate to 3.35982599e-05
Validation loss decreased (0.3631 --> 0.3611).  Saving model state dict ...
Epoch: 2 cost time: 2.008730411529541
Epoch: 2, Steps: 129 | Train Loss: 0.5514997 Vali Loss: 0.3610525 Best vali loss: 0.3610525
	iters: 100, epoch: 3 | loss: 0.4408973
	speed: 0.0237s/iter; left time: 16.0285s
Updating learning rate to 1.679912995e-05
Validation loss decreased (0.3611 --> 0.3592).  Saving model state dict ...
Epoch: 3 cost time: 1.9753832817077637
Epoch: 3, Steps: 129 | Train Loss: 0.4408973 Vali Loss: 0.3591616 Best vali loss: 0.3591616

best validation loss 0.35916163837043147

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0031711086512, 'e_layers': 1, 'learning_rate': 0.0006694630353, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8890947
	speed: 0.0142s/iter; left time: 13.2115s
Updating learning rate to 0.0006439831156932756
Validation loss decreased (inf --> 0.3779).  Saving model state dict ...
Epoch: 1 cost time: 1.3059866428375244
Epoch: 1, Steps: 129 | Train Loss: 0.8890947 Vali Loss: 0.3779466 Best vali loss: 0.3779466
	iters: 100, epoch: 2 | loss: 0.7410918
	speed: 0.0230s/iter; left time: 18.5032s
Updating learning rate to 0.0005714224436571795
Validation loss decreased (0.3779 --> 0.3646).  Saving model state dict ...
Epoch: 2 cost time: 1.3132562637329102
Epoch: 2, Steps: 129 | Train Loss: 0.7410918 Vali Loss: 0.3645722 Best vali loss: 0.3645722
	iters: 100, epoch: 3 | loss: 0.5645904
	speed: 0.0198s/iter; left time: 13.3604s
Updating learning rate to 0.00046282772374507767
Validation loss decreased (0.3646 --> 0.3643).  Saving model state dict ...
Epoch: 3 cost time: 2.018123149871826
Epoch: 3, Steps: 129 | Train Loss: 0.5645904 Vali Loss: 0.3643154 Best vali loss: 0.3643154

best validation loss 0.3643153576462114

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0020076739651, 'e_layers': 4, 'learning_rate': 6.71965198e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5443587
	speed: 0.0282s/iter; left time: 15.4112s
Updating learning rate to 8.399564975e-06
Validation loss decreased (0.3592 --> 0.3563).  Saving model state dict ...
Epoch: 4 cost time: 2.98416805267334
Epoch: 4, Steps: 129 | Train Loss: 0.5443587 Vali Loss: 0.3562654 Best vali loss: 0.3562654
	iters: 100, epoch: 5 | loss: 0.5100302
	speed: 0.0344s/iter; left time: 14.3618s
Updating learning rate to 4.1997824875e-06
Epoch: 5 cost time: 2.5530471801757812
Epoch: 5, Steps: 129 | Train Loss: 0.5100302 Vali Loss: 0.3576232 Best vali loss: 0.3562654
	iters: 100, epoch: 6 | loss: 0.4191492
	speed: 0.0288s/iter; left time: 8.3014s
Updating learning rate to 2.09989124375e-06
Epoch: 6 cost time: 1.5804367065429688
Epoch: 6, Steps: 129 | Train Loss: 0.4191492 Vali Loss: 0.3579772 Best vali loss: 0.3562654
	iters: 100, epoch: 7 | loss: 0.5066379
	speed: 0.0160s/iter; left time: 2.5470s
Updating learning rate to 1.049945621875e-06
Epoch: 7 cost time: 1.3644239902496338
Epoch: 7, Steps: 129 | Train Loss: 0.5066379 Vali Loss: 0.3575282 Best vali loss: 0.3562654
	iters: 100, epoch: 8 | loss: 0.4299347
	speed: 0.0243s/iter; left time: 0.7305s
Updating learning rate to 5.249728109375e-07
Epoch: 8 cost time: 2.1162116527557373
Epoch: 8, Steps: 129 | Train Loss: 0.4299347 Vali Loss: 0.3578165 Best vali loss: 0.3562654

best validation loss 0.3562654364085619

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0092090029171, 'e_layers': 2, 'learning_rate': 0.0003368909719, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003240688227631225
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.4723522663116455
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3676146 Best vali loss: 0.3676146
Updating learning rate to 0.0002875544313255083
Validation loss decreased (0.3676 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 0.6015410423278809
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3649320 Best vali loss: 0.3649320
Updating learning rate to 0.0002329067826797515
Epoch: 3 cost time: 1.344871997833252
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3654206 Best vali loss: 0.3649320
Updating learning rate to 0.00016844548595
Epoch: 4 cost time: 1.1554255485534668
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3734397 Best vali loss: 0.3649320
Updating learning rate to 0.0001039841892202485
Epoch: 5 cost time: 1.0571904182434082
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3740445 Best vali loss: 0.3649320
Updating learning rate to 4.9336540574491694e-05
Epoch: 6 cost time: 0.7880020141601562
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3668079 Best vali loss: 0.3649320
Updating learning rate to 1.2822149136877481e-05
Epoch: 7 cost time: 0.8189475536346436
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3769488 Best vali loss: 0.3649320
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0500199794769287
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3696919 Best vali loss: 0.3649320

best validation loss 0.3649320048175767

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0064272911927, 'e_layers': 4, 'learning_rate': 0.0020657769463, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4221649
	speed: 0.0192s/iter; left time: 77.1711s
	iters: 200, epoch: 1 | loss: 0.8449612
	speed: 0.0131s/iter; left time: 51.2683s
	iters: 300, epoch: 1 | loss: 0.8482628
	speed: 0.0130s/iter; left time: 49.3930s
	iters: 400, epoch: 1 | loss: 1.1272986
	speed: 0.0116s/iter; left time: 42.9842s
	iters: 500, epoch: 1 | loss: 0.5782229
	speed: 0.0117s/iter; left time: 42.3058s
Updating learning rate to 0.0019871529928601186
Validation loss decreased (inf --> 0.4159).  Saving model state dict ...
Epoch: 1 cost time: 6.722689390182495
Epoch: 1, Steps: 514 | Train Loss: 0.7641821 Vali Loss: 0.4158560 Best vali loss: 0.4158560
	iters: 100, epoch: 2 | loss: 1.1731037
	speed: 0.0348s/iter; left time: 121.7616s
	iters: 200, epoch: 2 | loss: 0.7533972
	speed: 0.0128s/iter; left time: 43.6504s
	iters: 300, epoch: 2 | loss: 0.9200356
	speed: 0.0129s/iter; left time: 42.6422s
	iters: 400, epoch: 2 | loss: 0.7184334
	speed: 0.0125s/iter; left time: 39.8912s
	iters: 500, epoch: 2 | loss: 0.4037627
	speed: 0.0124s/iter; left time: 38.2823s
Updating learning rate to 0.001763250916723784
Validation loss decreased (0.4159 --> 0.4041).  Saving model state dict ...
Epoch: 2 cost time: 6.482771873474121
Epoch: 2, Steps: 514 | Train Loss: 0.7937465 Vali Loss: 0.4040996 Best vali loss: 0.4040996
	iters: 100, epoch: 3 | loss: 0.6049483
	speed: 0.0299s/iter; left time: 89.1425s
	iters: 200, epoch: 3 | loss: 0.5170591
	speed: 0.0085s/iter; left time: 24.5982s
	iters: 300, epoch: 3 | loss: 0.5002089
	speed: 0.0121s/iter; left time: 33.7680s
	iters: 400, epoch: 3 | loss: 1.3658524
	speed: 0.0120s/iter; left time: 32.1002s
	iters: 500, epoch: 3 | loss: 0.3673772
	speed: 0.0136s/iter; left time: 35.0826s
Updating learning rate to 0.001428157779305379
Validation loss decreased (0.4041 --> 0.4034).  Saving model state dict ...
Epoch: 3 cost time: 5.816173791885376
Epoch: 3, Steps: 514 | Train Loss: 0.6710892 Vali Loss: 0.4033868 Best vali loss: 0.4033868
	iters: 100, epoch: 4 | loss: 0.5989221
	speed: 0.0328s/iter; left time: 80.9795s
	iters: 200, epoch: 4 | loss: 0.6708516
	speed: 0.0126s/iter; left time: 29.9068s
	iters: 300, epoch: 4 | loss: 0.3288438
	speed: 0.0118s/iter; left time: 26.7939s
	iters: 400, epoch: 4 | loss: 0.4534571
	speed: 0.0122s/iter; left time: 26.4089s
	iters: 500, epoch: 4 | loss: 0.8327726
	speed: 0.0121s/iter; left time: 25.0404s
Updating learning rate to 0.00103288847315
Epoch: 4 cost time: 6.366992235183716
Epoch: 4, Steps: 514 | Train Loss: 0.5769694 Vali Loss: 0.4053138 Best vali loss: 0.4033868
	iters: 100, epoch: 5 | loss: 0.8036240
	speed: 0.0578s/iter; left time: 113.0234s
	iters: 200, epoch: 5 | loss: 0.8632971
	speed: 0.0161s/iter; left time: 29.9185s
	iters: 300, epoch: 5 | loss: 0.3840292
	speed: 0.0165s/iter; left time: 28.9372s
	iters: 400, epoch: 5 | loss: 0.6536956
	speed: 0.0142s/iter; left time: 23.5945s
	iters: 500, epoch: 5 | loss: 0.8454023
	speed: 0.0126s/iter; left time: 19.6179s
Updating learning rate to 0.0006376191669946211
Epoch: 5 cost time: 7.891401767730713
Epoch: 5, Steps: 514 | Train Loss: 0.7100097 Vali Loss: 0.4044858 Best vali loss: 0.4033868
	iters: 100, epoch: 6 | loss: 0.6361028
	speed: 0.0693s/iter; left time: 99.9564s
	iters: 200, epoch: 6 | loss: 0.7505627
	speed: 0.0150s/iter; left time: 20.1328s
	iters: 300, epoch: 6 | loss: 0.5906374
	speed: 0.0150s/iter; left time: 18.6955s
	iters: 400, epoch: 6 | loss: 0.3974195
	speed: 0.0142s/iter; left time: 16.2416s
	iters: 500, epoch: 6 | loss: 0.6458914
	speed: 0.0152s/iter; left time: 15.8320s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.002062493602, 'e_layers': 3, 'learning_rate': 0.000390124485, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6729685
	speed: 0.0188s/iter; left time: 36.7251s
	iters: 200, epoch: 1 | loss: 0.8716060
	speed: 0.0190s/iter; left time: 35.2267s
Updating learning rate to 0.000390124485
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 4.577055931091309
Epoch: 1, Steps: 257 | Train Loss: 0.7722872 Vali Loss: 0.3685514 Best vali loss: 0.3685514
	iters: 100, epoch: 2 | loss: 0.5641150
	speed: 0.0674s/iter; left time: 114.5989s
	iters: 200, epoch: 2 | loss: 0.4067151
	speed: 0.0221s/iter; left time: 35.4003s
Updating learning rate to 0.0001950622425
Validation loss decreased (0.3686 --> 0.3616).  Saving model state dict ...
Epoch: 2 cost time: 5.552037239074707
Epoch: 2, Steps: 257 | Train Loss: 0.4854150 Vali Loss: 0.3616314 Best vali loss: 0.3616314
	iters: 100, epoch: 3 | loss: 0.7422464
	speed: 0.0621s/iter; left time: 89.6308s
	iters: 200, epoch: 3 | loss: 0.3893987
	speed: 0.0230s/iter; left time: 30.8905s
Updating learning rate to 9.753112125e-05
Validation loss decreased (0.3616 --> 0.3606).  Saving model state dict ...
Epoch: 3 cost time: 5.760828018188477
Epoch: 3, Steps: 257 | Train Loss: 0.5658225 Vali Loss: 0.3606464 Best vali loss: 0.3606464

best validation loss 0.360646416525007

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0061589744518, 'e_layers': 3, 'learning_rate': 0.0035362361435, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0035362361435
Validation loss decreased (inf --> 0.4142).  Saving model state dict ...
Epoch: 1 cost time: 2.9280974864959717
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4141887 Best vali loss: 0.4141887
Updating learning rate to 0.00176811807175
Validation loss decreased (0.4142 --> 0.3705).  Saving model state dict ...
Epoch: 2 cost time: 2.0527024269104004
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3704846 Best vali loss: 0.3704846
Updating learning rate to 0.000884059035875
Validation loss decreased (0.3705 --> 0.3678).  Saving model state dict ...
Epoch: 3 cost time: 1.4589872360229492
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3677919 Best vali loss: 0.3677919

best validation loss 0.36779187509025246

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0092493039249, 'e_layers': 4, 'learning_rate': 0.0002196370677, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1674125
	speed: 0.0189s/iter; left time: 75.6695s
	iters: 200, epoch: 1 | loss: 0.9826875
	speed: 0.0120s/iter; left time: 47.0999s
	iters: 300, epoch: 1 | loss: 0.5365899
	speed: 0.0131s/iter; left time: 50.0183s
	iters: 400, epoch: 1 | loss: 0.2871228
	speed: 0.0124s/iter; left time: 46.1170s
	iters: 500, epoch: 1 | loss: 0.3983457
	speed: 0.0114s/iter; left time: 41.3427s
Updating learning rate to 0.0002196370677
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 6.587908983230591
Epoch: 1, Steps: 514 | Train Loss: 0.6744317 Vali Loss: 0.3698329 Best vali loss: 0.3698329
	iters: 100, epoch: 2 | loss: 1.0460382
	speed: 0.0208s/iter; left time: 72.9511s
	iters: 200, epoch: 2 | loss: 0.7308148
	speed: 0.0105s/iter; left time: 35.6536s
	iters: 300, epoch: 2 | loss: 1.1066635
	speed: 0.0102s/iter; left time: 33.7781s
	iters: 400, epoch: 2 | loss: 0.8144396
	speed: 0.0103s/iter; left time: 33.0926s
	iters: 500, epoch: 2 | loss: 0.6885892
	speed: 0.0101s/iter; left time: 31.4080s
Updating learning rate to 0.00010981853385
Validation loss decreased (0.3698 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 5.35540246963501
Epoch: 2, Steps: 514 | Train Loss: 0.8773090 Vali Loss: 0.3690972 Best vali loss: 0.3690972
	iters: 100, epoch: 3 | loss: 0.3830069
	speed: 0.0201s/iter; left time: 60.0221s
	iters: 200, epoch: 3 | loss: 0.7299755
	speed: 0.0101s/iter; left time: 29.0630s
	iters: 300, epoch: 3 | loss: 0.6581019
	speed: 0.0102s/iter; left time: 28.4595s
	iters: 400, epoch: 3 | loss: 0.4848076
	speed: 0.0082s/iter; left time: 22.0214s
	iters: 500, epoch: 3 | loss: 0.6422254
	speed: 0.0093s/iter; left time: 23.9746s
Updating learning rate to 5.4909266925e-05
Epoch: 3 cost time: 4.996468782424927
Epoch: 3, Steps: 514 | Train Loss: 0.5796235 Vali Loss: 0.3718423 Best vali loss: 0.3690972

best validation loss 0.36909719995993295

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.002062493602, 'e_layers': 3, 'learning_rate': 0.000390124485, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4723461
	speed: 0.0183s/iter; left time: 21.7222s
	iters: 200, epoch: 4 | loss: 0.6813688
	speed: 0.0097s/iter; left time: 10.5087s
Updating learning rate to 4.8765560625e-05
Validation loss decreased (0.3606 --> 0.3597).  Saving model state dict ...
Epoch: 4 cost time: 3.0023622512817383
Epoch: 4, Steps: 257 | Train Loss: 0.5768574 Vali Loss: 0.3596827 Best vali loss: 0.3596827
	iters: 100, epoch: 5 | loss: 0.4210832
	speed: 0.0220s/iter; left time: 20.3934s
	iters: 200, epoch: 5 | loss: 0.3390236
	speed: 0.0109s/iter; left time: 9.0410s
Updating learning rate to 2.43827803125e-05
Validation loss decreased (0.3597 --> 0.3544).  Saving model state dict ...
Epoch: 5 cost time: 2.7176952362060547
Epoch: 5, Steps: 257 | Train Loss: 0.3800534 Vali Loss: 0.3544363 Best vali loss: 0.3544363
	iters: 100, epoch: 6 | loss: 0.5749851
	speed: 0.0230s/iter; left time: 15.4426s
	iters: 200, epoch: 6 | loss: 0.3524490
	speed: 0.0111s/iter; left time: 6.3345s
Updating learning rate to 1.219139015625e-05
Epoch: 6 cost time: 2.816546678543091
Epoch: 6, Steps: 257 | Train Loss: 0.4637171 Vali Loss: 0.3573603 Best vali loss: 0.3544363
	iters: 100, epoch: 7 | loss: 0.5274182
	speed: 0.0239s/iter; left time: 9.9241s
	iters: 200, epoch: 7 | loss: 0.5636509
	speed: 0.0101s/iter; left time: 3.1758s
Updating learning rate to 6.095695078125e-06
Epoch: 7 cost time: 2.584824800491333
Epoch: 7, Steps: 257 | Train Loss: 0.5455346 Vali Loss: 0.3546984 Best vali loss: 0.3544363
	iters: 100, epoch: 8 | loss: 0.3500680
	speed: 0.0222s/iter; left time: 3.5036s
	iters: 200, epoch: 8 | loss: 0.4011931
	speed: 0.0095s/iter; left time: 0.5507s
Updating learning rate to 3.0478475390625e-06
Epoch: 8 cost time: 2.694282293319702
Epoch: 8, Steps: 257 | Train Loss: 0.3756306 Vali Loss: 0.3581642 Best vali loss: 0.3544363

best validation loss 0.3544362757435482

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.000863609928, 'e_layers': 4, 'learning_rate': 0.0020527463126, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7548889
	speed: 0.0208s/iter; left time: 83.3456s
	iters: 200, epoch: 1 | loss: 0.6664309
	speed: 0.0134s/iter; left time: 52.3398s
	iters: 300, epoch: 1 | loss: 0.6805125
	speed: 0.0141s/iter; left time: 53.6946s
	iters: 400, epoch: 1 | loss: 0.8916055
	speed: 0.0100s/iter; left time: 37.2966s
	iters: 500, epoch: 1 | loss: 0.7370672
	speed: 0.0102s/iter; left time: 36.8781s
Updating learning rate to 0.001974618308124578
Validation loss decreased (inf --> 0.3965).  Saving model state dict ...
Epoch: 1 cost time: 6.703840255737305
Epoch: 1, Steps: 514 | Train Loss: 0.7461010 Vali Loss: 0.3965111 Best vali loss: 0.3965111
	iters: 100, epoch: 2 | loss: 0.4272826
	speed: 0.0219s/iter; left time: 76.7761s
	iters: 200, epoch: 2 | loss: 0.3315370
	speed: 0.0102s/iter; left time: 34.7496s
	iters: 300, epoch: 2 | loss: 0.5631533
	speed: 0.0099s/iter; left time: 32.5118s
	iters: 400, epoch: 2 | loss: 0.5507520
	speed: 0.0104s/iter; left time: 33.1722s
	iters: 500, epoch: 2 | loss: 0.6763895
	speed: 0.0100s/iter; left time: 31.1047s
Updating learning rate to 0.0017521285751475701
Epoch: 2 cost time: 5.298799276351929
Epoch: 2, Steps: 514 | Train Loss: 0.5098229 Vali Loss: 0.4018274 Best vali loss: 0.3965111
	iters: 100, epoch: 3 | loss: 0.3523393
	speed: 0.0165s/iter; left time: 49.1858s
	iters: 200, epoch: 3 | loss: 0.3533906
	speed: 0.0094s/iter; left time: 27.2476s
	iters: 300, epoch: 3 | loss: 0.4781527
	speed: 0.0092s/iter; left time: 25.7219s
	iters: 400, epoch: 3 | loss: 0.2803684
	speed: 0.0080s/iter; left time: 21.4198s
	iters: 500, epoch: 3 | loss: 0.6977170
	speed: 0.0086s/iter; left time: 22.2676s
Updating learning rate to 0.0014191491586402747
Epoch: 3 cost time: 4.5881335735321045
Epoch: 3, Steps: 514 | Train Loss: 0.4323936 Vali Loss: 0.4022413 Best vali loss: 0.3965111
	iters: 100, epoch: 4 | loss: 0.4913239
	speed: 0.0204s/iter; left time: 50.4073s
	iters: 200, epoch: 4 | loss: 0.4309752
	speed: 0.0111s/iter; left time: 26.2485s
	iters: 300, epoch: 4 | loss: 0.9154270
	speed: 0.0111s/iter; left time: 25.2183s
	iters: 400, epoch: 4 | loss: 0.6663292
	speed: 0.0111s/iter; left time: 24.0785s
	iters: 500, epoch: 4 | loss: 0.5452271
	speed: 0.0114s/iter; left time: 23.5648s
Updating learning rate to 0.0010263731563
Epoch: 4 cost time: 5.699971437454224
Epoch: 4, Steps: 514 | Train Loss: 0.6098565 Vali Loss: 0.4046264 Best vali loss: 0.3965111
	iters: 100, epoch: 5 | loss: 0.9172288
	speed: 0.0218s/iter; left time: 42.6168s
	iters: 200, epoch: 5 | loss: 1.4128059
	speed: 0.0106s/iter; left time: 19.7597s
	iters: 300, epoch: 5 | loss: 0.6562151
	speed: 0.0111s/iter; left time: 19.4235s
	iters: 400, epoch: 5 | loss: 0.7555270
	speed: 0.0109s/iter; left time: 18.1310s
	iters: 500, epoch: 5 | loss: 0.3849319
	speed: 0.0106s/iter; left time: 16.5522s
Updating learning rate to 0.0006335971539597252
Epoch: 5 cost time: 5.643662691116333
Epoch: 5, Steps: 514 | Train Loss: 0.8253417 Vali Loss: 0.4039255 Best vali loss: 0.3965111
	iters: 100, epoch: 6 | loss: 0.6288980
	speed: 0.0226s/iter; left time: 32.6616s
	iters: 200, epoch: 6 | loss: 0.5027707
	speed: 0.0108s/iter; left time: 14.4512s
	iters: 300, epoch: 6 | loss: 0.7398899
	speed: 0.0111s/iter; left time: 13.7360s
	iters: 400, epoch: 6 | loss: 0.6580630
	speed: 0.0107s/iter; left time: 12.2125s
	iters: 500, epoch: 6 | loss: 0.4610419
	speed: 0.0103s/iter; left time: 10.7620s
Updating learning rate to 0.00030061773745242984
Epoch: 6 cost time: 5.570044755935669
Epoch: 6, Steps: 514 | Train Loss: 0.5981327 Vali Loss: 0.4036793 Best vali loss: 0.3965111
	iters: 100, epoch: 7 | loss: 0.5191733
	speed: 0.0224s/iter; left time: 20.7685s
	iters: 200, epoch: 7 | loss: 0.6862677
	speed: 0.0116s/iter; left time: 9.6260s
	iters: 300, epoch: 7 | loss: 0.6248302
	speed: 0.0108s/iter; left time: 7.9059s
	iters: 400, epoch: 7 | loss: 0.6870037
	speed: 0.0105s/iter; left time: 6.5863s
	iters: 500, epoch: 7 | loss: 0.9870471
	speed: 0.0108s/iter; left time: 5.7074s
Updating learning rate to 7.812800447542216e-05
Epoch: 7 cost time: 5.674722909927368
Epoch: 7, Steps: 514 | Train Loss: 0.7008644 Vali Loss: 0.4033065 Best vali loss: 0.3965111
	iters: 100, epoch: 8 | loss: 0.8380493
	speed: 0.0207s/iter; left time: 8.5758s
	iters: 200, epoch: 8 | loss: 0.9768693
	speed: 0.0099s/iter; left time: 3.1079s
	iters: 300, epoch: 8 | loss: 0.9464146
	speed: 0.0121s/iter; left time: 2.6114s
	iters: 400, epoch: 8 | loss: 0.3510208
	speed: 0.0123s/iter; left time: 1.4103s
	iters: 500, epoch: 8 | loss: 0.5777746
	speed: 0.0125s/iter; left time: 0.1868s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.89152455329895
Epoch: 8, Steps: 514 | Train Loss: 0.7380257 Vali Loss: 0.4035238 Best vali loss: 0.3965111

best validation loss 0.39651114411344696

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.001884033354, 'e_layers': 1, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.3735).  Saving model state dict ...
Epoch: 1 cost time: 0.92409348487854
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3735411 Best vali loss: 0.3735411
Updating learning rate to 0.002058451742387382
Epoch: 2 cost time: 0.8471341133117676
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3857221 Best vali loss: 0.3735411
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 1.229548454284668
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3769419 Best vali loss: 0.3735411
Updating learning rate to 0.0012058131132
Epoch: 4 cost time: 1.3371851444244385
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4062823 Best vali loss: 0.3735411
Updating learning rate to 0.0007443684122497895
Epoch: 5 cost time: 0.6653695106506348
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3883443 Best vali loss: 0.3735411
Updating learning rate to 0.000353174484012618
Epoch: 6 cost time: 0.5702383518218994
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4013337 Best vali loss: 0.3735411
Updating learning rate to 9.178705788080472e-05
Epoch: 7 cost time: 0.5854332447052002
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4043838 Best vali loss: 0.3735411
Updating learning rate to 0.0
Epoch: 8 cost time: 0.560114860534668
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4048992 Best vali loss: 0.3735411

best validation loss 0.3735410570395719

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012371274314, 'e_layers': 1, 'learning_rate': 0.0002034425323, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7741517
	speed: 0.0145s/iter; left time: 13.5598s
Updating learning rate to 0.00019569946196711818
Validation loss decreased (inf --> 0.4094).  Saving model state dict ...
Epoch: 1 cost time: 1.3847386837005615
Epoch: 1, Steps: 129 | Train Loss: 0.7741517 Vali Loss: 0.4093609 Best vali loss: 0.4093609
	iters: 100, epoch: 2 | loss: 0.8699481
	speed: 0.0132s/iter; left time: 10.6283s
Updating learning rate to 0.0001736490632355466
Validation loss decreased (0.4094 --> 0.3882).  Saving model state dict ...
Epoch: 2 cost time: 1.0036680698394775
Epoch: 2, Steps: 129 | Train Loss: 0.8699481 Vali Loss: 0.3882451 Best vali loss: 0.3882451
	iters: 100, epoch: 3 | loss: 0.6039248
	speed: 0.0129s/iter; left time: 8.7315s
Updating learning rate to 0.00014064830942480482
Validation loss decreased (0.3882 --> 0.3793).  Saving model state dict ...
Epoch: 3 cost time: 1.052008867263794
Epoch: 3, Steps: 129 | Train Loss: 0.6039248 Vali Loss: 0.3792521 Best vali loss: 0.3792521

best validation loss 0.3792521218185575

{'batch_size': 128, 'd_core': 128, 'd_model': 256, 'dropout': 0.0018458136979, 'e_layers': 1, 'learning_rate': 0.0001207189802, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001207189802
Validation loss decreased (inf --> 0.3794).  Saving model state dict ...
Epoch: 1 cost time: 1.6562535762786865
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3793700 Best vali loss: 0.3793700
Updating learning rate to 6.03594901e-05
Validation loss decreased (0.3794 --> 0.3646).  Saving model state dict ...
Epoch: 2 cost time: 1.3884680271148682
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3646072 Best vali loss: 0.3646072
Updating learning rate to 3.017974505e-05
Epoch: 3 cost time: 1.0903675556182861
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3648149 Best vali loss: 0.3646072

best validation loss 0.3646071569507389

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0015367993764, 'e_layers': 2, 'learning_rate': 0.0002427959433, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6012895
	speed: 0.0196s/iter; left time: 78.7146s
	iters: 200, epoch: 1 | loss: 0.9536220
	speed: 0.0125s/iter; left time: 49.0116s
	iters: 300, epoch: 1 | loss: 0.8122017
	speed: 0.0127s/iter; left time: 48.4186s
	iters: 400, epoch: 1 | loss: 0.2978512
	speed: 0.0121s/iter; left time: 44.8904s
	iters: 500, epoch: 1 | loss: 0.6983280
	speed: 0.0075s/iter; left time: 27.2683s
Updating learning rate to 0.00023355507294582045
Validation loss decreased (inf --> 0.3615).  Saving model state dict ...
Epoch: 1 cost time: 6.253674745559692
Epoch: 1, Steps: 514 | Train Loss: 0.6726585 Vali Loss: 0.3615117 Best vali loss: 0.3615117
	iters: 100, epoch: 2 | loss: 0.4098544
	speed: 0.0314s/iter; left time: 109.6940s
	iters: 200, epoch: 2 | loss: 0.6049427
	speed: 0.0096s/iter; left time: 32.5011s
	iters: 300, epoch: 2 | loss: 1.0186099
	speed: 0.0090s/iter; left time: 29.5826s
	iters: 400, epoch: 2 | loss: 0.3452752
	speed: 0.0087s/iter; left time: 27.7224s
	iters: 500, epoch: 2 | loss: 0.6114242
	speed: 0.0073s/iter; left time: 22.7188s
Updating learning rate to 0.00020723930062600725
Epoch: 2 cost time: 4.602692604064941
Epoch: 2, Steps: 514 | Train Loss: 0.5980213 Vali Loss: 0.3660791 Best vali loss: 0.3615117
	iters: 100, epoch: 3 | loss: 0.8722476
	speed: 0.0430s/iter; left time: 128.4419s
	iters: 200, epoch: 3 | loss: 0.6828516
	speed: 0.0098s/iter; left time: 28.3754s
	iters: 300, epoch: 3 | loss: 0.6773322
	speed: 0.0107s/iter; left time: 29.7781s
	iters: 400, epoch: 3 | loss: 0.4979056
	speed: 0.0120s/iter; left time: 32.1655s
	iters: 500, epoch: 3 | loss: 0.6337966
	speed: 0.0108s/iter; left time: 27.8581s
Updating learning rate to 0.00016785496412318187
Epoch: 3 cost time: 5.642495393753052
Epoch: 3, Steps: 514 | Train Loss: 0.6728267 Vali Loss: 0.3751390 Best vali loss: 0.3615117

best validation loss 0.36151165725674284

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0015367993764, 'e_layers': 2, 'learning_rate': 0.0002427959433, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4877469
	speed: 0.0195s/iter; left time: 48.2825s
	iters: 200, epoch: 4 | loss: 0.8333589
	speed: 0.0124s/iter; left time: 29.3649s
	iters: 300, epoch: 4 | loss: 0.8080164
	speed: 0.0121s/iter; left time: 27.5668s
	iters: 400, epoch: 4 | loss: 0.2449451
	speed: 0.0128s/iter; left time: 27.7916s
	iters: 500, epoch: 4 | loss: 0.5978696
	speed: 0.0125s/iter; left time: 25.7876s
Updating learning rate to 0.00012139797165
Epoch: 4 cost time: 6.733087062835693
Epoch: 4, Steps: 514 | Train Loss: 0.5943874 Vali Loss: 0.3808378 Best vali loss: 0.3615117
	iters: 100, epoch: 5 | loss: 0.3908852
	speed: 0.0565s/iter; left time: 110.6385s
	iters: 200, epoch: 5 | loss: 0.4136240
	speed: 0.0093s/iter; left time: 17.2228s
	iters: 300, epoch: 5 | loss: 0.8616582
	speed: 0.0110s/iter; left time: 19.2548s
	iters: 400, epoch: 5 | loss: 0.2921964
	speed: 0.0107s/iter; left time: 17.7410s
	iters: 500, epoch: 5 | loss: 0.4658681
	speed: 0.0101s/iter; left time: 15.6639s
Updating learning rate to 7.494097917681814e-05
Validation loss decreased (0.3615 --> 0.3543).  Saving model state dict ...
Epoch: 5 cost time: 5.327904939651489
Epoch: 5, Steps: 514 | Train Loss: 0.4848464 Vali Loss: 0.3542884 Best vali loss: 0.3542884
	iters: 100, epoch: 6 | loss: 0.6174781
	speed: 0.0344s/iter; left time: 49.5727s
	iters: 200, epoch: 6 | loss: 0.4422662
	speed: 0.0140s/iter; left time: 18.7483s
	iters: 300, epoch: 6 | loss: 0.5524250
	speed: 0.0142s/iter; left time: 17.6470s
	iters: 400, epoch: 6 | loss: 0.3881386
	speed: 0.0154s/iter; left time: 17.6173s
	iters: 500, epoch: 6 | loss: 0.5538664
	speed: 0.0132s/iter; left time: 13.7331s
Updating learning rate to 3.555664267399276e-05
Epoch: 6 cost time: 7.105370759963989
Epoch: 6, Steps: 514 | Train Loss: 0.5108349 Vali Loss: 0.3664160 Best vali loss: 0.3542884
	iters: 100, epoch: 7 | loss: 0.2357637
	speed: 0.0566s/iter; left time: 52.5641s
	iters: 200, epoch: 7 | loss: 0.1886997
	speed: 0.0132s/iter; left time: 10.9016s
	iters: 300, epoch: 7 | loss: 0.6047021
	speed: 0.0138s/iter; left time: 10.0825s
	iters: 400, epoch: 7 | loss: 0.3477878
	speed: 0.0145s/iter; left time: 9.1081s
	iters: 500, epoch: 7 | loss: 0.5573769
	speed: 0.0134s/iter; left time: 7.1064s
Updating learning rate to 9.240870354179559e-06
Epoch: 7 cost time: 6.983743906021118
Epoch: 7, Steps: 514 | Train Loss: 0.3868660 Vali Loss: 0.3722702 Best vali loss: 0.3542884
	iters: 100, epoch: 8 | loss: 0.3750788
	speed: 0.0515s/iter; left time: 21.3540s
	iters: 200, epoch: 8 | loss: 0.2801217
	speed: 0.0055s/iter; left time: 1.7228s
	iters: 300, epoch: 8 | loss: 0.8356501
	speed: 0.0037s/iter; left time: 0.8024s
	iters: 400, epoch: 8 | loss: 0.4929842
	speed: 0.0049s/iter; left time: 0.5688s
	iters: 500, epoch: 8 | loss: 0.7515798
	speed: 0.0074s/iter; left time: 0.1113s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1003942489624023
Epoch: 8, Steps: 514 | Train Loss: 0.5470829 Vali Loss: 0.3632101 Best vali loss: 0.3542884

best validation loss 0.3542884199464719

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7121547
	speed: 0.0250s/iter; left time: 48.9232s
	iters: 200, epoch: 1 | loss: 0.8198088
	speed: 0.0170s/iter; left time: 31.5687s
Updating learning rate to 8.666273256609723e-05
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 4.898206949234009
Epoch: 1, Steps: 257 | Train Loss: 0.7659818 Vali Loss: 0.3743644 Best vali loss: 0.3743644
	iters: 100, epoch: 2 | loss: 0.4925345
	speed: 0.0490s/iter; left time: 83.3830s
	iters: 200, epoch: 2 | loss: 0.6278667
	speed: 0.0172s/iter; left time: 27.5133s
Updating learning rate to 7.689802606643869e-05
Validation loss decreased (0.3744 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 4.771375894546509
Epoch: 2, Steps: 257 | Train Loss: 0.5602006 Vali Loss: 0.3658814 Best vali loss: 0.3658814
	iters: 100, epoch: 3 | loss: 0.4193803
	speed: 0.0363s/iter; left time: 52.3984s
	iters: 200, epoch: 3 | loss: 0.6600857
	speed: 0.0088s/iter; left time: 11.7527s
Updating learning rate to 6.228411004831259e-05
Validation loss decreased (0.3659 --> 0.3653).  Saving model state dict ...
Epoch: 3 cost time: 2.8317134380340576
Epoch: 3, Steps: 257 | Train Loss: 0.5397330 Vali Loss: 0.3652788 Best vali loss: 0.3652788
	iters: 100, epoch: 4 | loss: 0.6248482
	speed: 0.0344s/iter; left time: 40.8450s
	iters: 200, epoch: 4 | loss: 0.4509663
	speed: 0.0211s/iter; left time: 22.9628s
Updating learning rate to 4.504582075e-05
Epoch: 4 cost time: 4.806152582168579
Epoch: 4, Steps: 257 | Train Loss: 0.5379073 Vali Loss: 0.3683027 Best vali loss: 0.3652788
	iters: 100, epoch: 5 | loss: 0.6072641
	speed: 0.0676s/iter; left time: 62.8408s
	iters: 200, epoch: 5 | loss: 0.7515402
	speed: 0.0247s/iter; left time: 20.4465s
Updating learning rate to 2.780753145168742e-05
Epoch: 5 cost time: 6.49310827255249
Epoch: 5, Steps: 257 | Train Loss: 0.6794022 Vali Loss: 0.3702541 Best vali loss: 0.3652788
	iters: 100, epoch: 6 | loss: 0.4319880
	speed: 0.0730s/iter; left time: 49.0486s
	iters: 200, epoch: 6 | loss: 0.6590111
	speed: 0.0275s/iter; left time: 15.7343s
Updating learning rate to 1.3193615433561312e-05
Epoch: 6 cost time: 6.279322147369385
Epoch: 6, Steps: 257 | Train Loss: 0.5454996 Vali Loss: 0.3677049 Best vali loss: 0.3652788
	iters: 100, epoch: 7 | loss: 0.4661917
	speed: 0.0370s/iter; left time: 15.3520s
	iters: 200, epoch: 7 | loss: 0.4687929
	speed: 0.0086s/iter; left time: 2.7129s
Updating learning rate to 3.4289089339027804e-06
Epoch: 7 cost time: 2.9676973819732666
Epoch: 7, Steps: 257 | Train Loss: 0.4674923 Vali Loss: 0.3693861 Best vali loss: 0.3652788
	iters: 100, epoch: 8 | loss: 0.4122256
	speed: 0.0213s/iter; left time: 3.3658s
	iters: 200, epoch: 8 | loss: 0.5083551
	speed: 0.0122s/iter; left time: 0.7101s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.8875668048858643
Epoch: 8, Steps: 257 | Train Loss: 0.4602904 Vali Loss: 0.3687741 Best vali loss: 0.3652788

best validation loss 0.3652787775679515

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0098657068511, 'e_layers': 1, 'learning_rate': 0.0032183063091, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9929344
	speed: 0.0138s/iter; left time: 55.5270s
	iters: 200, epoch: 1 | loss: 0.3566836
	speed: 0.0077s/iter; left time: 30.0574s
	iters: 300, epoch: 1 | loss: 0.8985149
	speed: 0.0071s/iter; left time: 27.0612s
	iters: 400, epoch: 1 | loss: 0.5018154
	speed: 0.0077s/iter; left time: 28.6212s
	iters: 500, epoch: 1 | loss: 0.6118351
	speed: 0.0073s/iter; left time: 26.3351s
Updating learning rate to 0.0030958168187147166
Validation loss decreased (inf --> 0.3824).  Saving model state dict ...
Epoch: 1 cost time: 4.145326375961304
Epoch: 1, Steps: 514 | Train Loss: 0.6723567 Vali Loss: 0.3824436 Best vali loss: 0.3824436
	iters: 100, epoch: 2 | loss: 1.3977623
	speed: 0.0150s/iter; left time: 52.6036s
	iters: 200, epoch: 2 | loss: 0.5825217
	speed: 0.0061s/iter; left time: 20.6400s
	iters: 300, epoch: 2 | loss: 0.9119084
	speed: 0.0052s/iter; left time: 17.3107s
	iters: 400, epoch: 2 | loss: 0.8041759
	speed: 0.0066s/iter; left time: 21.2009s
	iters: 500, epoch: 2 | loss: 0.8455076
	speed: 0.0078s/iter; left time: 24.2872s
Updating learning rate to 0.0027469962621000294
Epoch: 2 cost time: 3.364974021911621
Epoch: 2, Steps: 514 | Train Loss: 0.9083752 Vali Loss: 0.3900954 Best vali loss: 0.3824436
	iters: 100, epoch: 3 | loss: 0.4674423
	speed: 0.0357s/iter; left time: 106.5391s
	iters: 200, epoch: 3 | loss: 1.3287580
	speed: 0.0088s/iter; left time: 25.4905s
	iters: 300, epoch: 3 | loss: 0.3727530
	speed: 0.0081s/iter; left time: 22.4459s
	iters: 400, epoch: 3 | loss: 0.4284594
	speed: 0.0088s/iter; left time: 23.5290s
	iters: 500, epoch: 3 | loss: 0.4055803
	speed: 0.0091s/iter; left time: 23.5384s
Updating learning rate to 0.002224949406934306
Validation loss decreased (0.3824 --> 0.3805).  Saving model state dict ...
Epoch: 3 cost time: 4.652990818023682
Epoch: 3, Steps: 514 | Train Loss: 0.6005986 Vali Loss: 0.3804662 Best vali loss: 0.3804662
	iters: 100, epoch: 4 | loss: 0.4069377
	speed: 0.0262s/iter; left time: 64.8550s
	iters: 200, epoch: 4 | loss: 0.3083421
	speed: 0.0088s/iter; left time: 20.8582s
	iters: 300, epoch: 4 | loss: 0.5488485
	speed: 0.0081s/iter; left time: 18.4602s
	iters: 400, epoch: 4 | loss: 0.3550056
	speed: 0.0091s/iter; left time: 19.7454s
	iters: 500, epoch: 4 | loss: 0.7559924
	speed: 0.0123s/iter; left time: 25.4294s
Updating learning rate to 0.00160915315455
Epoch: 4 cost time: 4.95930290222168
Epoch: 4, Steps: 514 | Train Loss: 0.4750253 Vali Loss: 0.3987949 Best vali loss: 0.3804662
	iters: 100, epoch: 5 | loss: 0.3463808
	speed: 0.0260s/iter; left time: 50.9686s
	iters: 200, epoch: 5 | loss: 0.4021052
	speed: 0.0033s/iter; left time: 6.0790s
	iters: 300, epoch: 5 | loss: 0.7168114
	speed: 0.0048s/iter; left time: 8.4662s
	iters: 400, epoch: 5 | loss: 0.7015514
	speed: 0.0049s/iter; left time: 8.1323s
	iters: 500, epoch: 5 | loss: 0.4529183
	speed: 0.0048s/iter; left time: 7.5475s
Updating learning rate to 0.0009933569021656943
Epoch: 5 cost time: 2.389256000518799
Epoch: 5, Steps: 514 | Train Loss: 0.5239534 Vali Loss: 0.4555956 Best vali loss: 0.3804662
	iters: 100, epoch: 6 | loss: 0.7628466
	speed: 0.0137s/iter; left time: 19.7198s
	iters: 200, epoch: 6 | loss: 0.3901384
	speed: 0.0055s/iter; left time: 7.3272s
	iters: 300, epoch: 6 | loss: 0.4546513
	speed: 0.0034s/iter; left time: 4.1652s
	iters: 400, epoch: 6 | loss: 0.4465497
	speed: 0.0046s/iter; left time: 5.2180s
	iters: 500, epoch: 6 | loss: 0.7148322
	speed: 0.0099s/iter; left time: 10.3603s
Updating learning rate to 0.0004713100469999706
Epoch: 6 cost time: 3.122398614883423
Epoch: 6, Steps: 514 | Train Loss: 0.5538036 Vali Loss: 0.4659523 Best vali loss: 0.3804662
	iters: 100, epoch: 7 | loss: 0.4918306
	speed: 0.0328s/iter; left time: 30.4956s
	iters: 200, epoch: 7 | loss: 0.3547908
	speed: 0.0099s/iter; left time: 8.2308s
	iters: 300, epoch: 7 | loss: 0.3350399
	speed: 0.0074s/iter; left time: 5.3629s
	iters: 400, epoch: 7 | loss: 0.9380481
	speed: 0.0073s/iter; left time: 4.5876s
	iters: 500, epoch: 7 | loss: 0.2969072
	speed: 0.0082s/iter; left time: 4.3320s
Updating learning rate to 0.00012248949038528366
Epoch: 7 cost time: 4.448907852172852
Epoch: 7, Steps: 514 | Train Loss: 0.4833233 Vali Loss: 0.4866048 Best vali loss: 0.3804662
	iters: 100, epoch: 8 | loss: 0.7062677
	speed: 0.0134s/iter; left time: 5.5701s
	iters: 200, epoch: 8 | loss: 0.7609694
	speed: 0.0049s/iter; left time: 1.5394s
	iters: 300, epoch: 8 | loss: 0.2618075
	speed: 0.0072s/iter; left time: 1.5421s
	iters: 400, epoch: 8 | loss: 0.4667574
	speed: 0.0067s/iter; left time: 0.7689s
	iters: 500, epoch: 8 | loss: 0.7116927
	speed: 0.0072s/iter; left time: 0.1080s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.1905629634857178
Epoch: 8, Steps: 514 | Train Loss: 0.5814989 Vali Loss: 0.4878780 Best vali loss: 0.3804662

best validation loss 0.38046619741059473

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0054289535492, 'e_layers': 2, 'learning_rate': 0.000351769056, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003383806435046083
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 0.9667530059814453
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3711994 Best vali loss: 0.3711994
Updating learning rate to 0.00030025367045459516
Validation loss decreased (0.3712 --> 0.3703).  Saving model state dict ...
Epoch: 2 cost time: 0.8057069778442383
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3702640 Best vali loss: 0.3702640
Updating learning rate to 0.00024319262287495375
Epoch: 3 cost time: 0.6648101806640625
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3731232 Best vali loss: 0.3702640

best validation loss 0.37026402480709997

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0107187533809, 'e_layers': 4, 'learning_rate': 0.000413644762, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8939057
	speed: 0.0192s/iter; left time: 155.6135s
	iters: 200, epoch: 1 | loss: 0.2953416
	speed: 0.0127s/iter; left time: 101.7305s
	iters: 300, epoch: 1 | loss: 1.0362235
	speed: 0.0125s/iter; left time: 99.1267s
	iters: 400, epoch: 1 | loss: 0.5362567
	speed: 0.0102s/iter; left time: 79.9480s
	iters: 500, epoch: 1 | loss: 0.4200323
	speed: 0.0095s/iter; left time: 73.3330s
	iters: 600, epoch: 1 | loss: 1.0810428
	speed: 0.0097s/iter; left time: 74.2428s
	iters: 700, epoch: 1 | loss: 0.2186294
	speed: 0.0104s/iter; left time: 78.2749s
	iters: 800, epoch: 1 | loss: 1.2722291
	speed: 0.0093s/iter; left time: 68.8232s
	iters: 900, epoch: 1 | loss: 0.2273720
	speed: 0.0107s/iter; left time: 78.2133s
	iters: 1000, epoch: 1 | loss: 1.7023731
	speed: 0.0137s/iter; left time: 98.9267s
Updating learning rate to 0.00039790134567115125
Validation loss decreased (inf --> 0.3972).  Saving model state dict ...
Epoch: 1 cost time: 11.904391050338745
Epoch: 1, Steps: 1027 | Train Loss: 0.7683406 Vali Loss: 0.3972172 Best vali loss: 0.3972172
	iters: 100, epoch: 2 | loss: 0.8262635
	speed: 0.0369s/iter; left time: 261.3322s
	iters: 200, epoch: 2 | loss: 0.6171408
	speed: 0.0132s/iter; left time: 92.0747s
	iters: 300, epoch: 2 | loss: 0.4751314
	speed: 0.0134s/iter; left time: 92.1945s
	iters: 400, epoch: 2 | loss: 1.1749514
	speed: 0.0115s/iter; left time: 78.0679s
	iters: 500, epoch: 2 | loss: 1.0375100
	speed: 0.0114s/iter; left time: 76.1029s
	iters: 600, epoch: 2 | loss: 0.2951238
	speed: 0.0129s/iter; left time: 84.8678s
	iters: 700, epoch: 2 | loss: 0.8575312
	speed: 0.0135s/iter; left time: 87.7330s
	iters: 800, epoch: 2 | loss: 0.7118959
	speed: 0.0161s/iter; left time: 102.7905s
	iters: 900, epoch: 2 | loss: 0.5661405
	speed: 0.0128s/iter; left time: 80.5690s
	iters: 1000, epoch: 2 | loss: 0.3656319
	speed: 0.0169s/iter; left time: 104.9019s
Updating learning rate to 0.00035306788910624776
Epoch: 2 cost time: 13.780255794525146
Epoch: 2, Steps: 1027 | Train Loss: 0.6927321 Vali Loss: 0.4019020 Best vali loss: 0.3972172
	iters: 100, epoch: 3 | loss: 1.1685249
	speed: 0.0263s/iter; left time: 159.7431s
	iters: 200, epoch: 3 | loss: 0.6561998
	speed: 0.0107s/iter; left time: 63.5617s
	iters: 300, epoch: 3 | loss: 0.9869767
	speed: 0.0113s/iter; left time: 66.2598s
	iters: 400, epoch: 3 | loss: 0.9052513
	speed: 0.0105s/iter; left time: 60.5224s
	iters: 500, epoch: 3 | loss: 2.2926099
	speed: 0.0115s/iter; left time: 65.0792s
	iters: 600, epoch: 3 | loss: 1.2995080
	speed: 0.0109s/iter; left time: 60.8500s
	iters: 700, epoch: 3 | loss: 0.3210118
	speed: 0.0109s/iter; left time: 59.4399s
	iters: 800, epoch: 3 | loss: 0.5278786
	speed: 0.0106s/iter; left time: 57.0988s
	iters: 900, epoch: 3 | loss: 0.7695780
	speed: 0.0107s/iter; left time: 56.3344s
	iters: 1000, epoch: 3 | loss: 0.3636226
	speed: 0.0112s/iter; left time: 57.5878s
Updating learning rate to 0.00028596987965100033
Epoch: 3 cost time: 11.225753545761108
Epoch: 3, Steps: 1027 | Train Loss: 0.9291162 Vali Loss: 0.4115274 Best vali loss: 0.3972172

best validation loss 0.3972171807335964

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0032137232287, 'e_layers': 1, 'learning_rate': 0.0001600716477, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8220506
	speed: 0.0106s/iter; left time: 85.6345s
	iters: 200, epoch: 1 | loss: 1.2871369
	speed: 0.0038s/iter; left time: 30.4435s
	iters: 300, epoch: 1 | loss: 0.2519327
	speed: 0.0043s/iter; left time: 33.9193s
	iters: 400, epoch: 1 | loss: 1.6345141
	speed: 0.0046s/iter; left time: 35.9472s
	iters: 500, epoch: 1 | loss: 0.6176570
	speed: 0.0049s/iter; left time: 38.0578s
	iters: 600, epoch: 1 | loss: 0.8070764
	speed: 0.0046s/iter; left time: 35.3425s
	iters: 700, epoch: 1 | loss: 0.8261581
	speed: 0.0058s/iter; left time: 43.4899s
	iters: 800, epoch: 1 | loss: 0.2569765
	speed: 0.0045s/iter; left time: 33.3742s
	iters: 900, epoch: 1 | loss: 0.8140706
	speed: 0.0041s/iter; left time: 29.6684s
	iters: 1000, epoch: 1 | loss: 0.4150159
	speed: 0.0051s/iter; left time: 36.5000s
Updating learning rate to 0.0001539792833726937
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 5.062225103378296
Epoch: 1, Steps: 1027 | Train Loss: 0.7732589 Vali Loss: 0.3681130 Best vali loss: 0.3681130
	iters: 100, epoch: 2 | loss: 0.2225102
	speed: 0.0206s/iter; left time: 146.1797s
	iters: 200, epoch: 2 | loss: 1.3283087
	speed: 0.0050s/iter; left time: 34.8667s
	iters: 300, epoch: 2 | loss: 1.0557615
	speed: 0.0056s/iter; left time: 38.6655s
	iters: 400, epoch: 2 | loss: 0.5066974
	speed: 0.0060s/iter; left time: 40.4244s
	iters: 500, epoch: 2 | loss: 0.4372066
	speed: 0.0046s/iter; left time: 30.4474s
	iters: 600, epoch: 2 | loss: 0.7054229
	speed: 0.0050s/iter; left time: 32.8603s
	iters: 700, epoch: 2 | loss: 0.7817553
	speed: 0.0048s/iter; left time: 31.3905s
	iters: 800, epoch: 2 | loss: 0.3447641
	speed: 0.0057s/iter; left time: 36.5162s
	iters: 900, epoch: 2 | loss: 0.4813401
	speed: 0.0056s/iter; left time: 35.4120s
	iters: 1000, epoch: 2 | loss: 0.3608246
	speed: 0.0058s/iter; left time: 35.6626s
Updating learning rate to 0.000136629697632187
Validation loss decreased (0.3681 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 5.514519214630127
Epoch: 2, Steps: 1027 | Train Loss: 0.6224591 Vali Loss: 0.3648831 Best vali loss: 0.3648831
	iters: 100, epoch: 3 | loss: 0.3060985
	speed: 0.0160s/iter; left time: 97.2597s
	iters: 200, epoch: 3 | loss: 0.5625302
	speed: 0.0051s/iter; left time: 30.2554s
	iters: 300, epoch: 3 | loss: 0.9975691
	speed: 0.0045s/iter; left time: 26.4266s
	iters: 400, epoch: 3 | loss: 0.4462919
	speed: 0.0048s/iter; left time: 27.9155s
	iters: 500, epoch: 3 | loss: 1.0460508
	speed: 0.0051s/iter; left time: 29.1073s
	iters: 600, epoch: 3 | loss: 1.1451931
	speed: 0.0042s/iter; left time: 23.5491s
	iters: 700, epoch: 3 | loss: 0.8918004
	speed: 0.0037s/iter; left time: 20.4468s
	iters: 800, epoch: 3 | loss: 0.3496448
	speed: 0.0038s/iter; left time: 20.1446s
	iters: 900, epoch: 3 | loss: 1.0881616
	speed: 0.0055s/iter; left time: 28.8162s
	iters: 1000, epoch: 3 | loss: 0.9147289
	speed: 0.0057s/iter; left time: 29.4346s
Updating learning rate to 0.00011066420763308572
Epoch: 3 cost time: 4.860476732254028
Epoch: 3, Steps: 1027 | Train Loss: 0.7748069 Vali Loss: 0.3737547 Best vali loss: 0.3648831

best validation loss 0.36488305875383803

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0032137232287, 'e_layers': 1, 'learning_rate': 0.0001600716477, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7621241
	speed: 0.0126s/iter; left time: 63.2863s
	iters: 200, epoch: 4 | loss: 1.0460060
	speed: 0.0058s/iter; left time: 28.7600s
	iters: 300, epoch: 4 | loss: 0.1844677
	speed: 0.0056s/iter; left time: 27.2009s
	iters: 400, epoch: 4 | loss: 1.3744509
	speed: 0.0061s/iter; left time: 28.8529s
	iters: 500, epoch: 4 | loss: 0.6411320
	speed: 0.0056s/iter; left time: 25.7977s
	iters: 600, epoch: 4 | loss: 0.7050068
	speed: 0.0055s/iter; left time: 25.1624s
	iters: 700, epoch: 4 | loss: 0.8082694
	speed: 0.0057s/iter; left time: 25.3094s
	iters: 800, epoch: 4 | loss: 0.2301410
	speed: 0.0049s/iter; left time: 21.2855s
	iters: 900, epoch: 4 | loss: 0.7982542
	speed: 0.0050s/iter; left time: 21.1359s
	iters: 1000, epoch: 4 | loss: 0.3720525
	speed: 0.0056s/iter; left time: 23.1812s
Updating learning rate to 8.003582385e-05
Epoch: 4 cost time: 6.060626745223999
Epoch: 4, Steps: 1027 | Train Loss: 0.6921904 Vali Loss: 0.3709197 Best vali loss: 0.3648831
	iters: 100, epoch: 5 | loss: 0.2284949
	speed: 0.0191s/iter; left time: 76.7492s
	iters: 200, epoch: 5 | loss: 1.2016383
	speed: 0.0040s/iter; left time: 15.4923s
	iters: 300, epoch: 5 | loss: 0.9607747
	speed: 0.0056s/iter; left time: 21.1525s
	iters: 400, epoch: 5 | loss: 0.4716600
	speed: 0.0054s/iter; left time: 20.1061s
	iters: 500, epoch: 5 | loss: 0.4467900
	speed: 0.0058s/iter; left time: 20.9015s
	iters: 600, epoch: 5 | loss: 0.7226670
	speed: 0.0054s/iter; left time: 18.9488s
	iters: 700, epoch: 5 | loss: 0.8066889
	speed: 0.0062s/iter; left time: 21.2983s
	iters: 800, epoch: 5 | loss: 0.3448052
	speed: 0.0041s/iter; left time: 13.5808s
	iters: 900, epoch: 5 | loss: 0.4846847
	speed: 0.0041s/iter; left time: 13.1719s
	iters: 1000, epoch: 5 | loss: 0.3197187
	speed: 0.0047s/iter; left time: 14.6650s
Updating learning rate to 4.940744006691429e-05
Epoch: 5 cost time: 5.153005838394165
Epoch: 5, Steps: 1027 | Train Loss: 0.5987923 Vali Loss: 0.3745756 Best vali loss: 0.3648831
	iters: 100, epoch: 6 | loss: 0.3094221
	speed: 0.0165s/iter; left time: 49.2550s
	iters: 200, epoch: 6 | loss: 0.5664850
	speed: 0.0055s/iter; left time: 15.7554s
	iters: 300, epoch: 6 | loss: 0.9154752
	speed: 0.0055s/iter; left time: 15.3479s
	iters: 400, epoch: 6 | loss: 0.4505936
	speed: 0.0060s/iter; left time: 16.0066s
	iters: 500, epoch: 6 | loss: 1.0073935
	speed: 0.0056s/iter; left time: 14.3464s
	iters: 600, epoch: 6 | loss: 1.1260387
	speed: 0.0053s/iter; left time: 13.1999s
	iters: 700, epoch: 6 | loss: 0.7593104
	speed: 0.0051s/iter; left time: 12.0977s
	iters: 800, epoch: 6 | loss: 0.3250676
	speed: 0.0053s/iter; left time: 11.9942s
	iters: 900, epoch: 6 | loss: 0.8915121
	speed: 0.0044s/iter; left time: 9.5219s
	iters: 1000, epoch: 6 | loss: 0.9067147
	speed: 0.0047s/iter; left time: 9.6898s
Updating learning rate to 2.344195006781299e-05
Epoch: 6 cost time: 5.456582307815552
Epoch: 6, Steps: 1027 | Train Loss: 0.7258013 Vali Loss: 0.3837730 Best vali loss: 0.3648831
	iters: 100, epoch: 7 | loss: 0.3552124
	speed: 0.0173s/iter; left time: 33.8631s
	iters: 200, epoch: 7 | loss: 0.2336367
	speed: 0.0050s/iter; left time: 9.3320s
	iters: 300, epoch: 7 | loss: 0.6327274
	speed: 0.0050s/iter; left time: 8.8613s
	iters: 400, epoch: 7 | loss: 0.6059465
	speed: 0.0057s/iter; left time: 9.3772s
	iters: 500, epoch: 7 | loss: 0.5106671
	speed: 0.0055s/iter; left time: 8.6023s
	iters: 600, epoch: 7 | loss: 0.2687213
	speed: 0.0046s/iter; left time: 6.6891s
	iters: 700, epoch: 7 | loss: 0.1917654
	speed: 0.0041s/iter; left time: 5.5598s
	iters: 800, epoch: 7 | loss: 0.5912790
	speed: 0.0053s/iter; left time: 6.6096s
	iters: 900, epoch: 7 | loss: 0.3189585
	speed: 0.0049s/iter; left time: 5.6203s
	iters: 1000, epoch: 7 | loss: 0.7751692
	speed: 0.0043s/iter; left time: 4.5374s
Updating learning rate to 6.092364327306306e-06
Epoch: 7 cost time: 5.190896272659302
Epoch: 7, Steps: 1027 | Train Loss: 0.4484083 Vali Loss: 0.3790636 Best vali loss: 0.3648831
	iters: 100, epoch: 8 | loss: 0.2996772
	speed: 0.0141s/iter; left time: 13.0913s
	iters: 200, epoch: 8 | loss: 0.8425418
	speed: 0.0033s/iter; left time: 2.7352s
	iters: 300, epoch: 8 | loss: 1.1506437
	speed: 0.0037s/iter; left time: 2.6745s
	iters: 400, epoch: 8 | loss: 0.7883061
	speed: 0.0042s/iter; left time: 2.6503s
	iters: 500, epoch: 8 | loss: 0.3548402
	speed: 0.0041s/iter; left time: 2.1778s
	iters: 600, epoch: 8 | loss: 0.3179263
	speed: 0.0051s/iter; left time: 2.1654s
	iters: 700, epoch: 8 | loss: 0.2929279
	speed: 0.0058s/iter; left time: 1.8906s
	iters: 800, epoch: 8 | loss: 0.5278081
	speed: 0.0063s/iter; left time: 1.4288s
	iters: 900, epoch: 8 | loss: 1.1033664
	speed: 0.0048s/iter; left time: 0.6169s
	iters: 1000, epoch: 8 | loss: 0.5018175
	speed: 0.0057s/iter; left time: 0.1595s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.8651347160339355
Epoch: 8, Steps: 1027 | Train Loss: 0.6179855 Vali Loss: 0.3805871 Best vali loss: 0.3648831

best validation loss 0.36488305875383803

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0057599163564, 'e_layers': 1, 'learning_rate': 0.0040096099014, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003857003211329029
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.2180886268615723
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3675978 Best vali loss: 0.3675978
Updating learning rate to 0.0034224161262963316
Epoch: 2 cost time: 0.5730090141296387
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3894885 Best vali loss: 0.3675978
Updating learning rate to 0.0027720105904564005
Epoch: 3 cost time: 1.246044397354126
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3757608 Best vali loss: 0.3675978
Updating learning rate to 0.0020048049507
Epoch: 4 cost time: 2.147246837615967
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3813840 Best vali loss: 0.3675978
Updating learning rate to 0.0012375993109435995
Epoch: 5 cost time: 1.163456678390503
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3794434 Best vali loss: 0.3675978
Updating learning rate to 0.000587193775103668
Epoch: 6 cost time: 1.0581867694854736
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3805767 Best vali loss: 0.3675978
Updating learning rate to 0.00015260669007097073
Epoch: 7 cost time: 0.9298434257507324
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3867939 Best vali loss: 0.3675978
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8885951042175293
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3849026 Best vali loss: 0.3675978

best validation loss 0.3675978138076767

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0013909605867, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3256457
	speed: 0.0181s/iter; left time: 72.7433s
	iters: 200, epoch: 1 | loss: 0.4345270
	speed: 0.0110s/iter; left time: 43.0863s
	iters: 300, epoch: 1 | loss: 0.9552369
	speed: 0.0105s/iter; left time: 39.8813s
	iters: 400, epoch: 1 | loss: 0.6877333
	speed: 0.0110s/iter; left time: 40.6974s
	iters: 500, epoch: 1 | loss: 0.5710166
	speed: 0.0143s/iter; left time: 51.6635s
Updating learning rate to 0.0006472014951
Validation loss decreased (inf --> 0.3802).  Saving model state dict ...
Epoch: 1 cost time: 6.377376079559326
Epoch: 1, Steps: 514 | Train Loss: 0.5948319 Vali Loss: 0.3802193 Best vali loss: 0.3802193
	iters: 100, epoch: 2 | loss: 0.8156275
	speed: 0.0733s/iter; left time: 256.5419s
	iters: 200, epoch: 2 | loss: 0.3074307
	speed: 0.0152s/iter; left time: 51.7439s
	iters: 300, epoch: 2 | loss: 0.8510736
	speed: 0.0150s/iter; left time: 49.4718s
	iters: 400, epoch: 2 | loss: 0.5819302
	speed: 0.0131s/iter; left time: 41.8452s
	iters: 500, epoch: 2 | loss: 0.7079495
	speed: 0.0135s/iter; left time: 41.8263s
Updating learning rate to 0.00032360074755
Validation loss decreased (0.3802 --> 0.3756).  Saving model state dict ...
Epoch: 2 cost time: 7.359655380249023
Epoch: 2, Steps: 514 | Train Loss: 0.6528023 Vali Loss: 0.3756484 Best vali loss: 0.3756484
	iters: 100, epoch: 3 | loss: 0.5463471
	speed: 0.0637s/iter; left time: 190.0281s
	iters: 200, epoch: 3 | loss: 0.4085374
	speed: 0.0154s/iter; left time: 44.4396s
	iters: 300, epoch: 3 | loss: 0.6703272
	speed: 0.0141s/iter; left time: 39.2030s
	iters: 400, epoch: 3 | loss: 0.3668977
	speed: 0.0129s/iter; left time: 34.6309s
	iters: 500, epoch: 3 | loss: 0.8925135
	speed: 0.0083s/iter; left time: 21.5776s
Updating learning rate to 0.000161800373775
Validation loss decreased (0.3756 --> 0.3728).  Saving model state dict ...
Epoch: 3 cost time: 6.63942289352417
Epoch: 3, Steps: 514 | Train Loss: 0.5769246 Vali Loss: 0.3728460 Best vali loss: 0.3728460
	iters: 100, epoch: 4 | loss: 0.9105351
	speed: 0.0566s/iter; left time: 139.7486s
	iters: 200, epoch: 4 | loss: 0.4489024
	speed: 0.0137s/iter; left time: 32.4662s
	iters: 300, epoch: 4 | loss: 1.0209661
	speed: 0.0163s/iter; left time: 37.0619s
	iters: 400, epoch: 4 | loss: 0.2049636
	speed: 0.0125s/iter; left time: 27.2066s
	iters: 500, epoch: 4 | loss: 0.4281989
	speed: 0.0120s/iter; left time: 24.7756s
Updating learning rate to 8.09001868875e-05
Epoch: 4 cost time: 7.082663536071777
Epoch: 4, Steps: 514 | Train Loss: 0.6027132 Vali Loss: 0.3760605 Best vali loss: 0.3728460
	iters: 100, epoch: 5 | loss: 0.6012442
	speed: 0.0696s/iter; left time: 136.2413s
	iters: 200, epoch: 5 | loss: 0.3279738
	speed: 0.0141s/iter; left time: 26.1004s
	iters: 300, epoch: 5 | loss: 0.5884565
	speed: 0.0147s/iter; left time: 25.8256s
	iters: 400, epoch: 5 | loss: 0.4611706
	speed: 0.0139s/iter; left time: 23.0523s
	iters: 500, epoch: 5 | loss: 0.9821743
	speed: 0.0135s/iter; left time: 21.0628s
Updating learning rate to 4.045009344375e-05
Epoch: 5 cost time: 7.291184902191162
Epoch: 5, Steps: 514 | Train Loss: 0.5922039 Vali Loss: 0.3881793 Best vali loss: 0.3728460
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003501237965075005
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 1.3835475444793701
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732017 Best vali loss: 0.3732017
Updating learning rate to 0.003106736659818519
Validation loss decreased (0.3732 --> 0.3711).  Saving model state dict ...
Epoch: 2 cost time: 1.0175750255584717
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3711088 Best vali loss: 0.3711088
Updating learning rate to 0.002516323732992606
Validation loss decreased (0.3711 --> 0.3691).  Saving model state dict ...
Epoch: 3 cost time: 1.1313438415527344
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3691344 Best vali loss: 0.3691344

best validation loss 0.36913436994337145

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0030317673518, 'e_layers': 4, 'learning_rate': 0.0007179148563, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5565647
	speed: 0.0191s/iter; left time: 17.8095s
Updating learning rate to 0.0007179148563
Validation loss decreased (inf --> 0.3681).  Saving model state dict ...
Epoch: 1 cost time: 1.9369347095489502
Epoch: 1, Steps: 129 | Train Loss: 0.5565647 Vali Loss: 0.3681158 Best vali loss: 0.3681158
	iters: 100, epoch: 2 | loss: 0.6724218
	speed: 0.0195s/iter; left time: 15.7123s
Updating learning rate to 0.00035895742815
Epoch: 2 cost time: 1.7766613960266113
Epoch: 2, Steps: 129 | Train Loss: 0.6724218 Vali Loss: 0.3822518 Best vali loss: 0.3681158
	iters: 100, epoch: 3 | loss: 0.5696280
	speed: 0.0204s/iter; left time: 13.7649s
Updating learning rate to 0.000179478714075
Epoch: 3 cost time: 1.7201297283172607
Epoch: 3, Steps: 129 | Train Loss: 0.5696280 Vali Loss: 0.3871324 Best vali loss: 0.3681158

best validation loss 0.36811582614724436

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 3, 'learning_rate': 0.0042134401242, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5013378
	speed: 0.0169s/iter; left time: 67.6937s
	iters: 200, epoch: 1 | loss: 0.3490311
	speed: 0.0104s/iter; left time: 40.7743s
	iters: 300, epoch: 1 | loss: 0.4851587
	speed: 0.0107s/iter; left time: 40.6487s
	iters: 400, epoch: 1 | loss: 0.8441676
	speed: 0.0105s/iter; left time: 38.8283s
	iters: 500, epoch: 1 | loss: 0.4084672
	speed: 0.0094s/iter; left time: 33.8261s
Updating learning rate to 0.0042134401242
Validation loss decreased (inf --> 0.3700).  Saving model state dict ...
Epoch: 1 cost time: 5.620683193206787
Epoch: 1, Steps: 514 | Train Loss: 0.5176325 Vali Loss: 0.3700358 Best vali loss: 0.3700358
	iters: 100, epoch: 2 | loss: 0.5437891
	speed: 0.0224s/iter; left time: 78.5400s
	iters: 200, epoch: 2 | loss: 0.4065529
	speed: 0.0106s/iter; left time: 35.9768s
	iters: 300, epoch: 2 | loss: 0.4169692
	speed: 0.0105s/iter; left time: 34.6430s
	iters: 400, epoch: 2 | loss: 0.2871747
	speed: 0.0093s/iter; left time: 29.6490s
	iters: 500, epoch: 2 | loss: 0.3217885
	speed: 0.0085s/iter; left time: 26.2126s
Updating learning rate to 0.0021067200621
Epoch: 2 cost time: 5.141488552093506
Epoch: 2, Steps: 514 | Train Loss: 0.3952549 Vali Loss: 0.3773860 Best vali loss: 0.3700358
	iters: 100, epoch: 3 | loss: 0.8130410
	speed: 0.0205s/iter; left time: 61.3312s
	iters: 200, epoch: 3 | loss: 0.6566574
	speed: 0.0074s/iter; left time: 21.4600s
	iters: 300, epoch: 3 | loss: 0.3406853
	speed: 0.0091s/iter; left time: 25.3651s
	iters: 400, epoch: 3 | loss: 0.2594885
	speed: 0.0094s/iter; left time: 25.2684s
	iters: 500, epoch: 3 | loss: 0.3953426
	speed: 0.0095s/iter; left time: 24.4375s
Updating learning rate to 0.00105336003105
Epoch: 3 cost time: 4.637648105621338
Epoch: 3, Steps: 514 | Train Loss: 0.4930430 Vali Loss: 0.3817597 Best vali loss: 0.3700358

best validation loss 0.3700358092901983

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0030317673518, 'e_layers': 4, 'learning_rate': 0.0007179148563, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5089692
	speed: 0.0200s/iter; left time: 10.9314s
Updating learning rate to 8.97393570375e-05
Validation loss decreased (0.3681 --> 0.3455).  Saving model state dict ...
Epoch: 4 cost time: 1.935335397720337
Epoch: 4, Steps: 129 | Train Loss: 0.5089692 Vali Loss: 0.3454560 Best vali loss: 0.3454560
	iters: 100, epoch: 5 | loss: 0.5273073
	speed: 0.0163s/iter; left time: 6.8146s
Updating learning rate to 4.486967851875e-05
Epoch: 5 cost time: 1.3638947010040283
Epoch: 5, Steps: 129 | Train Loss: 0.5273073 Vali Loss: 0.3455900 Best vali loss: 0.3454560
	iters: 100, epoch: 6 | loss: 0.4585469
	speed: 0.0191s/iter; left time: 5.5139s
Updating learning rate to 2.2434839259375e-05
Validation loss decreased (0.3455 --> 0.3440).  Saving model state dict ...
Epoch: 6 cost time: 1.643921136856079
Epoch: 6, Steps: 129 | Train Loss: 0.4585469 Vali Loss: 0.3439771 Best vali loss: 0.3439771
	iters: 100, epoch: 7 | loss: 0.4862848
	speed: 0.0237s/iter; left time: 3.7744s
Updating learning rate to 1.12174196296875e-05
Epoch: 7 cost time: 1.9373674392700195
Epoch: 7, Steps: 129 | Train Loss: 0.4862848 Vali Loss: 0.3440378 Best vali loss: 0.3439771
	iters: 100, epoch: 8 | loss: 0.5112445
	speed: 0.0190s/iter; left time: 0.5694s
Updating learning rate to 5.60870981484375e-06
Epoch: 8 cost time: 1.600740909576416
Epoch: 8, Steps: 129 | Train Loss: 0.5112445 Vali Loss: 0.3442004 Best vali loss: 0.3439771

best validation loss 0.3439771139902778

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010480885831, 'e_layers': 2, 'learning_rate': 0.0045292011947, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0045292011947
Validation loss decreased (inf --> 0.4196).  Saving model state dict ...
Epoch: 1 cost time: 1.0289344787597656
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4196188 Best vali loss: 0.4196188
Updating learning rate to 0.00226460059735
Validation loss decreased (0.4196 --> 0.3851).  Saving model state dict ...
Epoch: 2 cost time: 1.1168959140777588
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3850695 Best vali loss: 0.3850695
Updating learning rate to 0.001132300298675
Validation loss decreased (0.3851 --> 0.3837).  Saving model state dict ...
Epoch: 3 cost time: 1.1537282466888428
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3837285 Best vali loss: 0.3837285
Updating learning rate to 0.0005661501493375
Validation loss decreased (0.3837 --> 0.3831).  Saving model state dict ...
Epoch: 4 cost time: 1.1595652103424072
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3831337 Best vali loss: 0.3831337
Updating learning rate to 0.00028307507466875
Validation loss decreased (0.3831 --> 0.3795).  Saving model state dict ...
Epoch: 5 cost time: 1.1411306858062744
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3794662 Best vali loss: 0.3794662
Updating learning rate to 0.000141537537334375
Epoch: 6 cost time: 1.1688885688781738
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3842556 Best vali loss: 0.3794662
Updating learning rate to 7.07687686671875e-05
Epoch: 7 cost time: 0.8814465999603271
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3825058 Best vali loss: 0.3794662
Updating learning rate to 3.538438433359375e-05
Epoch: 8 cost time: 1.5806801319122314
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3884612 Best vali loss: 0.3794662

best validation loss 0.37946623411534575

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0021336555001, 'e_layers': 4, 'learning_rate': 0.0005331966574, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3707106
	speed: 0.0145s/iter; left time: 117.2913s
	iters: 200, epoch: 1 | loss: 0.6324190
	speed: 0.0108s/iter; left time: 86.5925s
	iters: 300, epoch: 1 | loss: 0.3007490
	speed: 0.0085s/iter; left time: 67.3019s
	iters: 400, epoch: 1 | loss: 0.3556398
	speed: 0.0102s/iter; left time: 80.0687s
	iters: 500, epoch: 1 | loss: 0.2304477
	speed: 0.0103s/iter; left time: 79.1822s
	iters: 600, epoch: 1 | loss: 0.9003663
	speed: 0.0094s/iter; left time: 71.3105s
	iters: 700, epoch: 1 | loss: 1.0910513
	speed: 0.0105s/iter; left time: 78.9278s
	iters: 800, epoch: 1 | loss: 0.5978345
	speed: 0.0089s/iter; left time: 66.0233s
	iters: 900, epoch: 1 | loss: 0.4815458
	speed: 0.0099s/iter; left time: 72.5426s
	iters: 1000, epoch: 1 | loss: 0.4978881
	speed: 0.0113s/iter; left time: 81.4860s
Updating learning rate to 0.0005331966574
Validation loss decreased (inf --> 0.3750).  Saving model state dict ...
Epoch: 1 cost time: 10.386573553085327
Epoch: 1, Steps: 1027 | Train Loss: 0.5458652 Vali Loss: 0.3750167 Best vali loss: 0.3750167
	iters: 100, epoch: 2 | loss: 0.2027762
	speed: 0.0305s/iter; left time: 216.4531s
	iters: 200, epoch: 2 | loss: 0.5473891
	speed: 0.0081s/iter; left time: 56.8493s
	iters: 300, epoch: 2 | loss: 0.9998559
	speed: 0.0107s/iter; left time: 73.8684s
	iters: 400, epoch: 2 | loss: 0.4880457
	speed: 0.0117s/iter; left time: 79.6865s
	iters: 500, epoch: 2 | loss: 0.3521759
	speed: 0.0111s/iter; left time: 74.4226s
	iters: 600, epoch: 2 | loss: 0.3548625
	speed: 0.0096s/iter; left time: 63.5652s
	iters: 700, epoch: 2 | loss: 1.0460950
	speed: 0.0093s/iter; left time: 60.3120s
	iters: 800, epoch: 2 | loss: 1.0857818
	speed: 0.0110s/iter; left time: 70.1310s
	iters: 900, epoch: 2 | loss: 0.8063136
	speed: 0.0103s/iter; left time: 64.5436s
	iters: 1000, epoch: 2 | loss: 0.2955894
	speed: 0.0093s/iter; left time: 57.4268s
Updating learning rate to 0.0002665983287
Epoch: 2 cost time: 10.668575286865234
Epoch: 2, Steps: 1027 | Train Loss: 0.6178885 Vali Loss: 0.3830261 Best vali loss: 0.3750167
	iters: 100, epoch: 3 | loss: 0.5139825
	speed: 0.0410s/iter; left time: 248.5092s
	iters: 200, epoch: 3 | loss: 0.4270065
	speed: 0.0118s/iter; left time: 70.4226s
	iters: 300, epoch: 3 | loss: 0.9274331
	speed: 0.0085s/iter; left time: 49.9683s
	iters: 400, epoch: 3 | loss: 0.5147398
	speed: 0.0096s/iter; left time: 55.0950s
	iters: 500, epoch: 3 | loss: 0.2038414
	speed: 0.0092s/iter; left time: 51.8520s
	iters: 600, epoch: 3 | loss: 1.0435063
	speed: 0.0095s/iter; left time: 52.7137s
	iters: 700, epoch: 3 | loss: 1.2129283
	speed: 0.0097s/iter; left time: 53.0811s
	iters: 800, epoch: 3 | loss: 0.2271223
	speed: 0.0099s/iter; left time: 52.9640s
	iters: 900, epoch: 3 | loss: 0.9367070
	speed: 0.0073s/iter; left time: 38.4935s
	iters: 1000, epoch: 3 | loss: 0.3315783
	speed: 0.0094s/iter; left time: 48.5325s
Updating learning rate to 0.00013329916435
Validation loss decreased (0.3750 --> 0.3688).  Saving model state dict ...
Epoch: 3 cost time: 10.326232671737671
Epoch: 3, Steps: 1027 | Train Loss: 0.6338845 Vali Loss: 0.3688301 Best vali loss: 0.3688301
	iters: 100, epoch: 4 | loss: 0.2704089
	speed: 0.0303s/iter; left time: 152.3671s
	iters: 200, epoch: 4 | loss: 0.6517590
	speed: 0.0115s/iter; left time: 56.5979s
	iters: 300, epoch: 4 | loss: 0.2959115
	speed: 0.0109s/iter; left time: 52.9260s
	iters: 400, epoch: 4 | loss: 0.4272693
	speed: 0.0084s/iter; left time: 39.6827s
	iters: 500, epoch: 4 | loss: 0.2828725
	speed: 0.0119s/iter; left time: 55.1348s
	iters: 600, epoch: 4 | loss: 0.2621152
	speed: 0.0113s/iter; left time: 51.3785s
	iters: 700, epoch: 4 | loss: 0.4532884
	speed: 0.0118s/iter; left time: 52.1446s
	iters: 800, epoch: 4 | loss: 0.2000615
	speed: 0.0107s/iter; left time: 46.1887s
	iters: 900, epoch: 4 | loss: 0.3589457
	speed: 0.0113s/iter; left time: 47.8723s
	iters: 1000, epoch: 4 | loss: 0.9187346
	speed: 0.0110s/iter; left time: 45.6864s
Updating learning rate to 6.6649582175e-05
Validation loss decreased (0.3688 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 11.31048035621643
Epoch: 4, Steps: 1027 | Train Loss: 0.4121366 Vali Loss: 0.3678090 Best vali loss: 0.3678090
	iters: 100, epoch: 5 | loss: 0.9216330
	speed: 0.0310s/iter; left time: 124.2063s
	iters: 200, epoch: 5 | loss: 0.6647806
	speed: 0.0084s/iter; left time: 32.6631s
	iters: 300, epoch: 5 | loss: 0.3264377
	speed: 0.0108s/iter; left time: 41.1770s
	iters: 400, epoch: 5 | loss: 0.2681061
	speed: 0.0108s/iter; left time: 40.0299s
	iters: 500, epoch: 5 | loss: 0.4856316
	speed: 0.0108s/iter; left time: 39.0089s
	iters: 600, epoch: 5 | loss: 0.3369092
	speed: 0.0109s/iter; left time: 38.2053s
	iters: 700, epoch: 5 | loss: 0.4572610
	speed: 0.0108s/iter; left time: 36.6838s
	iters: 800, epoch: 5 | loss: 0.3799158
	speed: 0.0092s/iter; left time: 30.4009s
	iters: 900, epoch: 5 | loss: 0.2693425
	speed: 0.0088s/iter; left time: 28.2805s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000998120144, 'e_layers': 3, 'learning_rate': 0.0005882178132, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3916706
	speed: 0.0151s/iter; left time: 122.9458s
	iters: 200, epoch: 1 | loss: 0.4322641
	speed: 0.0072s/iter; left time: 57.7938s
	iters: 300, epoch: 1 | loss: 0.8073252
	speed: 0.0074s/iter; left time: 58.2158s
	iters: 400, epoch: 1 | loss: 0.6439503
	speed: 0.0060s/iter; left time: 46.9196s
	iters: 500, epoch: 1 | loss: 0.4058251
	speed: 0.0088s/iter; left time: 67.7707s
	iters: 600, epoch: 1 | loss: 0.2812451
	speed: 0.0097s/iter; left time: 74.1470s
	iters: 700, epoch: 1 | loss: 0.4648956
	speed: 0.0090s/iter; left time: 67.4850s
	iters: 800, epoch: 1 | loss: 0.3483658
	speed: 0.0076s/iter; left time: 56.6233s
	iters: 900, epoch: 1 | loss: 0.5425008
	speed: 0.0090s/iter; left time: 65.6436s
	iters: 1000, epoch: 1 | loss: 0.9827194
	speed: 0.0086s/iter; left time: 61.9578s
Updating learning rate to 0.0005882178132
Validation loss decreased (inf --> 0.3752).  Saving model state dict ...
Epoch: 1 cost time: 8.727066278457642
Epoch: 1, Steps: 1027 | Train Loss: 0.5300762 Vali Loss: 0.3752449 Best vali loss: 0.3752449
	iters: 100, epoch: 2 | loss: 0.3096525
	speed: 0.0226s/iter; left time: 160.5870s
	iters: 200, epoch: 2 | loss: 1.3080918
	speed: 0.0081s/iter; left time: 56.2944s
	iters: 300, epoch: 2 | loss: 0.3050486
	speed: 0.0086s/iter; left time: 58.9355s
	iters: 400, epoch: 2 | loss: 0.5726335
	speed: 0.0088s/iter; left time: 59.4539s
	iters: 500, epoch: 2 | loss: 0.2891802
	speed: 0.0086s/iter; left time: 57.5098s
	iters: 600, epoch: 2 | loss: 0.3173046
	speed: 0.0091s/iter; left time: 59.6560s
	iters: 700, epoch: 2 | loss: 1.2773006
	speed: 0.0083s/iter; left time: 53.8901s
	iters: 800, epoch: 2 | loss: 0.6232454
	speed: 0.0074s/iter; left time: 47.5651s
	iters: 900, epoch: 2 | loss: 0.5576196
	speed: 0.0079s/iter; left time: 49.9409s
	iters: 1000, epoch: 2 | loss: 0.9216624
	speed: 0.0085s/iter; left time: 52.5375s
Updating learning rate to 0.0002941089066
Validation loss decreased (0.3752 --> 0.3710).  Saving model state dict ...
Epoch: 2 cost time: 8.593498229980469
Epoch: 2, Steps: 1027 | Train Loss: 0.6481739 Vali Loss: 0.3710225 Best vali loss: 0.3710225
	iters: 100, epoch: 3 | loss: 0.6330841
	speed: 0.0262s/iter; left time: 158.7096s
	iters: 200, epoch: 3 | loss: 0.2476203
	speed: 0.0086s/iter; left time: 51.0545s
	iters: 300, epoch: 3 | loss: 0.7382650
	speed: 0.0075s/iter; left time: 43.7013s
	iters: 400, epoch: 3 | loss: 1.3297948
	speed: 0.0066s/iter; left time: 37.7633s
	iters: 500, epoch: 3 | loss: 0.8955016
	speed: 0.0080s/iter; left time: 45.0369s
	iters: 600, epoch: 3 | loss: 0.3059516
	speed: 0.0073s/iter; left time: 40.4841s
	iters: 700, epoch: 3 | loss: 0.8243704
	speed: 0.0110s/iter; left time: 59.8913s
	iters: 800, epoch: 3 | loss: 1.0777593
	speed: 0.0103s/iter; left time: 54.9728s
	iters: 900, epoch: 3 | loss: 0.4908226
	speed: 0.0094s/iter; left time: 49.3125s
	iters: 1000, epoch: 3 | loss: 0.5162375
	speed: 0.0069s/iter; left time: 35.6788s
Updating learning rate to 0.0001470544533
Epoch: 3 cost time: 8.656137943267822
Epoch: 3, Steps: 1027 | Train Loss: 0.7059407 Vali Loss: 0.3848517 Best vali loss: 0.3710225

best validation loss 0.37102246036229763

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0054436866271, 'e_layers': 3, 'learning_rate': 0.0031278905454, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6022186
	speed: 0.0189s/iter; left time: 75.9369s
	iters: 200, epoch: 1 | loss: 0.6684628
	speed: 0.0129s/iter; left time: 50.4707s
	iters: 300, epoch: 1 | loss: 0.5410134
	speed: 0.0115s/iter; left time: 43.9958s
	iters: 400, epoch: 1 | loss: 0.6103601
	speed: 0.0093s/iter; left time: 34.6710s
	iters: 500, epoch: 1 | loss: 0.3835006
	speed: 0.0115s/iter; left time: 41.4789s
Updating learning rate to 0.0031278905454
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 6.30298376083374
Epoch: 1, Steps: 514 | Train Loss: 0.5611111 Vali Loss: 0.3737113 Best vali loss: 0.3737113
	iters: 100, epoch: 2 | loss: 0.3935043
	speed: 0.0343s/iter; left time: 119.9769s
	iters: 200, epoch: 2 | loss: 0.6124649
	speed: 0.0093s/iter; left time: 31.5074s
	iters: 300, epoch: 2 | loss: 0.6019125
	speed: 0.0113s/iter; left time: 37.2945s
	iters: 400, epoch: 2 | loss: 1.0430653
	speed: 0.0115s/iter; left time: 36.7938s
	iters: 500, epoch: 2 | loss: 0.6324624
	speed: 0.0115s/iter; left time: 35.6826s
Updating learning rate to 0.0015639452727
Epoch: 2 cost time: 5.691785573959351
Epoch: 2, Steps: 514 | Train Loss: 0.6566819 Vali Loss: 0.3801299 Best vali loss: 0.3737113
	iters: 100, epoch: 3 | loss: 0.9292302
	speed: 0.0345s/iter; left time: 102.9643s
	iters: 200, epoch: 3 | loss: 0.4692392
	speed: 0.0142s/iter; left time: 41.0927s
	iters: 300, epoch: 3 | loss: 0.3937137
	speed: 0.0150s/iter; left time: 41.6538s
	iters: 400, epoch: 3 | loss: 0.3472440
	speed: 0.0153s/iter; left time: 41.1179s
	iters: 500, epoch: 3 | loss: 0.3214891
	speed: 0.0155s/iter; left time: 40.1287s
Updating learning rate to 0.00078197263635
Epoch: 3 cost time: 7.621773719787598
Epoch: 3, Steps: 514 | Train Loss: 0.4921832 Vali Loss: 0.3913281 Best vali loss: 0.3737113

best validation loss 0.37371129326244235

[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0059022887684, 'e_layers': 3, 'learning_rate': 0.0024672810386, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4754553
	speed: 0.0205s/iter; left time: 82.3167s
	iters: 200, epoch: 1 | loss: 0.7683281
	speed: 0.0145s/iter; left time: 56.8467s
	iters: 300, epoch: 1 | loss: 0.4656609
	speed: 0.0137s/iter; left time: 52.0867s
	iters: 400, epoch: 1 | loss: 0.7504299
	speed: 0.0138s/iter; left time: 51.1870s
	iters: 500, epoch: 1 | loss: 0.5021644
	speed: 0.0139s/iter; left time: 50.2243s
Updating learning rate to 0.002373375745557865
Validation loss decreased (inf --> 0.4019).  Saving model state dict ...
Epoch: 1 cost time: 7.548754453659058
Epoch: 1, Steps: 514 | Train Loss: 0.5924077 Vali Loss: 0.4019267 Best vali loss: 0.4019267
	iters: 100, epoch: 2 | loss: 0.6660302
	speed: 0.0462s/iter; left time: 161.6841s
	iters: 200, epoch: 2 | loss: 0.5783939
	speed: 0.0115s/iter; left time: 38.9945s
	iters: 300, epoch: 2 | loss: 0.5840768
	speed: 0.0131s/iter; left time: 43.2996s
	iters: 400, epoch: 2 | loss: 0.6925188
	speed: 0.0149s/iter; left time: 47.6814s
	iters: 500, epoch: 2 | loss: 0.9763291
	speed: 0.0124s/iter; left time: 38.5153s
Updating learning rate to 0.002105956096043524
Epoch: 2 cost time: 6.5514748096466064
Epoch: 2, Steps: 514 | Train Loss: 0.6994698 Vali Loss: 0.4041295 Best vali loss: 0.4019267
	iters: 100, epoch: 3 | loss: 0.3907485
	speed: 0.0213s/iter; left time: 63.7123s
	iters: 200, epoch: 3 | loss: 0.5935465
	speed: 0.0078s/iter; left time: 22.3895s
	iters: 300, epoch: 3 | loss: 0.8807251
	speed: 0.0079s/iter; left time: 21.9641s
	iters: 400, epoch: 3 | loss: 0.6186245
	speed: 0.0087s/iter; left time: 23.2783s
	iters: 500, epoch: 3 | loss: 1.2358652
	speed: 0.0087s/iter; left time: 22.6027s
Updating learning rate to 0.0017057343075303757
Epoch: 3 cost time: 4.252262353897095
Epoch: 3, Steps: 514 | Train Loss: 0.7439020 Vali Loss: 0.4033549 Best vali loss: 0.4019267

best validation loss 0.4019267476963388

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000998120144, 'e_layers': 3, 'learning_rate': 0.0005882178132, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3419610
	speed: 0.0158s/iter; left time: 79.4920s
	iters: 200, epoch: 4 | loss: 0.4848006
	speed: 0.0076s/iter; left time: 37.3438s
	iters: 300, epoch: 4 | loss: 0.7650589
	speed: 0.0068s/iter; left time: 32.7001s
	iters: 400, epoch: 4 | loss: 0.3889099
	speed: 0.0077s/iter; left time: 36.5034s
	iters: 500, epoch: 4 | loss: 0.4110098
	speed: 0.0079s/iter; left time: 36.3976s
	iters: 600, epoch: 4 | loss: 0.2958248
	speed: 0.0082s/iter; left time: 37.0419s
	iters: 700, epoch: 4 | loss: 0.4799689
	speed: 0.0082s/iter; left time: 36.4491s
	iters: 800, epoch: 4 | loss: 0.3299718
	speed: 0.0082s/iter; left time: 35.6033s
	iters: 900, epoch: 4 | loss: 0.4390783
	speed: 0.0078s/iter; left time: 33.0924s
	iters: 1000, epoch: 4 | loss: 0.7481802
	speed: 0.0080s/iter; left time: 33.2458s
Updating learning rate to 7.352722665e-05
Epoch: 4 cost time: 8.466480731964111
Epoch: 4, Steps: 1027 | Train Loss: 0.4684764 Vali Loss: 0.3864020 Best vali loss: 0.3710225
	iters: 100, epoch: 5 | loss: 0.2646641
	speed: 0.0244s/iter; left time: 97.9885s
	iters: 200, epoch: 5 | loss: 1.1295668
	speed: 0.0083s/iter; left time: 32.6321s
	iters: 300, epoch: 5 | loss: 0.3259181
	speed: 0.0071s/iter; left time: 26.9834s
	iters: 400, epoch: 5 | loss: 0.5550064
	speed: 0.0073s/iter; left time: 26.9874s
	iters: 500, epoch: 5 | loss: 0.3213300
	speed: 0.0080s/iter; left time: 28.9951s
	iters: 600, epoch: 5 | loss: 0.3169570
	speed: 0.0077s/iter; left time: 26.8798s
	iters: 700, epoch: 5 | loss: 1.1861815
	speed: 0.0076s/iter; left time: 25.9213s
	iters: 800, epoch: 5 | loss: 0.6294758
	speed: 0.0065s/iter; left time: 21.5101s
	iters: 900, epoch: 5 | loss: 0.5533707
	speed: 0.0077s/iter; left time: 24.5905s
	iters: 1000, epoch: 5 | loss: 0.8959037
	speed: 0.0068s/iter; left time: 21.2689s
Updating learning rate to 3.6763613325e-05
Epoch: 5 cost time: 7.758958339691162
Epoch: 5, Steps: 1027 | Train Loss: 0.6178374 Vali Loss: 0.3833129 Best vali loss: 0.3710225
	iters: 100, epoch: 6 | loss: 0.4780749
	speed: 0.0202s/iter; left time: 60.0888s
	iters: 200, epoch: 6 | loss: 0.2334669
	speed: 0.0058s/iter; left time: 16.6851s
	iters: 300, epoch: 6 | loss: 0.7417225
	speed: 0.0065s/iter; left time: 17.9866s
	iters: 400, epoch: 6 | loss: 1.1733598
	speed: 0.0084s/iter; left time: 22.4422s
	iters: 500, epoch: 6 | loss: 0.8648100
	speed: 0.0094s/iter; left time: 24.2821s
	iters: 600, epoch: 6 | loss: 0.3264023
	speed: 0.0091s/iter; left time: 22.4701s
	iters: 700, epoch: 6 | loss: 0.6983994
	speed: 0.0079s/iter; left time: 18.7086s
	iters: 800, epoch: 6 | loss: 1.0869472
	speed: 0.0091s/iter; left time: 20.8131s
	iters: 900, epoch: 6 | loss: 0.4811184
	speed: 0.0090s/iter; left time: 19.6395s
	iters: 1000, epoch: 6 | loss: 0.5144807
	speed: 0.0087s/iter; left time: 18.1882s
Updating learning rate to 1.83818066625e-05
Epoch: 6 cost time: 8.387548685073853
Epoch: 6, Steps: 1027 | Train Loss: 0.6598782 Vali Loss: 0.3864692 Best vali loss: 0.3710225
	iters: 100, epoch: 7 | loss: 0.8912756
	speed: 0.0246s/iter; left time: 48.0637s
	iters: 200, epoch: 7 | loss: 0.1624669
	speed: 0.0084s/iter; left time: 15.5996s
	iters: 300, epoch: 7 | loss: 1.0794386
	speed: 0.0075s/iter; left time: 13.1894s
	iters: 400, epoch: 7 | loss: 0.3666619
	speed: 0.0067s/iter; left time: 11.0108s
	iters: 500, epoch: 7 | loss: 0.2247817
	speed: 0.0071s/iter; left time: 10.9834s
	iters: 600, epoch: 7 | loss: 0.6082359
	speed: 0.0081s/iter; left time: 11.7627s
	iters: 700, epoch: 7 | loss: 0.4069414
	speed: 0.0098s/iter; left time: 13.3432s
	iters: 800, epoch: 7 | loss: 0.6523914
	speed: 0.0076s/iter; left time: 9.5425s
	iters: 900, epoch: 7 | loss: 0.8326149
	speed: 0.0067s/iter; left time: 7.7531s
	iters: 1000, epoch: 7 | loss: 0.7455968
	speed: 0.0069s/iter; left time: 7.2635s
Updating learning rate to 9.19090333125e-06
Epoch: 7 cost time: 7.9148712158203125
Epoch: 7, Steps: 1027 | Train Loss: 0.5970405 Vali Loss: 0.3855763 Best vali loss: 0.3710225
	iters: 100, epoch: 8 | loss: 0.3469162
	speed: 0.0214s/iter; left time: 19.8242s
	iters: 200, epoch: 8 | loss: 0.8293062
	speed: 0.0069s/iter; left time: 5.7509s
	iters: 300, epoch: 8 | loss: 0.9086218
	speed: 0.0068s/iter; left time: 4.9312s
	iters: 400, epoch: 8 | loss: 1.1695238
	speed: 0.0081s/iter; left time: 5.0989s
	iters: 500, epoch: 8 | loss: 0.4507043
	speed: 0.0075s/iter; left time: 3.9462s
	iters: 600, epoch: 8 | loss: 0.2595566
	speed: 0.0078s/iter; left time: 3.3575s
	iters: 700, epoch: 8 | loss: 0.3075705
	speed: 0.0081s/iter; left time: 2.6708s
	iters: 800, epoch: 8 | loss: 0.2428021
	speed: 0.0081s/iter; left time: 1.8522s
	iters: 900, epoch: 8 | loss: 0.3249655
	speed: 0.0081s/iter; left time: 1.0368s
	iters: 1000, epoch: 8 | loss: 0.7819358
	speed: 0.0085s/iter; left time: 0.2374s
Updating learning rate to 4.595451665625e-06
Epoch: 8 cost time: 7.986086130142212
Epoch: 8, Steps: 1027 | Train Loss: 0.5621903 Vali Loss: 0.3865296 Best vali loss: 0.3710225

best validation loss 0.37102246036229763

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002924796084, 'e_layers': 2, 'learning_rate': 0.0023564983436, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0023564983436
Validation loss decreased (inf --> 0.3765).  Saving model state dict ...
Epoch: 1 cost time: 0.9620876312255859
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3765140 Best vali loss: 0.3765140
Updating learning rate to 0.0011782491718
Validation loss decreased (0.3765 --> 0.3716).  Saving model state dict ...
Epoch: 2 cost time: 0.8689775466918945
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3715903 Best vali loss: 0.3715903
Updating learning rate to 0.0005891245859
Epoch: 3 cost time: 1.386451005935669
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3739358 Best vali loss: 0.3715903
Updating learning rate to 0.00029456229295
Epoch: 4 cost time: 0.7656974792480469
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3729340 Best vali loss: 0.3715903
Updating learning rate to 0.000147281146475
Epoch: 5 cost time: 1.2135562896728516
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3725717 Best vali loss: 0.3715903
Updating learning rate to 7.36405732375e-05
Epoch: 6 cost time: 1.1349921226501465
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3733606 Best vali loss: 0.3715903
Updating learning rate to 3.682028661875e-05
Epoch: 7 cost time: 1.5222320556640625
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3738274 Best vali loss: 0.3715903
Updating learning rate to 1.8410143309375e-05
Epoch: 8 cost time: 1.2240893840789795
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3735588 Best vali loss: 0.3715903

best validation loss 0.3715902859663448

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0032277578285, 'e_layers': 2, 'learning_rate': 0.0001802980817, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3474091
	speed: 0.0157s/iter; left time: 127.7212s
	iters: 200, epoch: 1 | loss: 0.3374793
	speed: 0.0052s/iter; left time: 41.4986s
	iters: 300, epoch: 1 | loss: 0.3836733
	speed: 0.0046s/iter; left time: 36.5408s
	iters: 400, epoch: 1 | loss: 1.7724156
	speed: 0.0050s/iter; left time: 39.3817s
	iters: 500, epoch: 1 | loss: 0.5443741
	speed: 0.0066s/iter; left time: 50.6562s
	iters: 600, epoch: 1 | loss: 0.7425642
	speed: 0.0072s/iter; left time: 54.5725s
	iters: 700, epoch: 1 | loss: 0.7907137
	speed: 0.0073s/iter; left time: 54.5460s
	iters: 800, epoch: 1 | loss: 0.5294937
	speed: 0.0072s/iter; left time: 53.1784s
	iters: 900, epoch: 1 | loss: 1.4757078
	speed: 0.0052s/iter; left time: 38.1600s
	iters: 1000, epoch: 1 | loss: 0.5497960
	speed: 0.0062s/iter; left time: 45.0425s
Updating learning rate to 0.0001734358945668389
Validation loss decreased (inf --> 0.3773).  Saving model state dict ...
Epoch: 1 cost time: 6.94590163230896
Epoch: 1, Steps: 1027 | Train Loss: 0.8473627 Vali Loss: 0.3772750 Best vali loss: 0.3772750
	iters: 100, epoch: 2 | loss: 0.3308927
	speed: 0.0242s/iter; left time: 171.6692s
	iters: 200, epoch: 2 | loss: 1.0772958
	speed: 0.0072s/iter; left time: 50.3142s
	iters: 300, epoch: 2 | loss: 0.4440312
	speed: 0.0060s/iter; left time: 41.6293s
	iters: 400, epoch: 2 | loss: 0.4754038
	speed: 0.0054s/iter; left time: 36.5007s
	iters: 500, epoch: 2 | loss: 0.6926784
	speed: 0.0049s/iter; left time: 32.9057s
	iters: 600, epoch: 2 | loss: 0.2906540
	speed: 0.0053s/iter; left time: 34.7729s
	iters: 700, epoch: 2 | loss: 0.7724590
	speed: 0.0064s/iter; left time: 41.5978s
	iters: 800, epoch: 2 | loss: 0.7855439
	speed: 0.0069s/iter; left time: 44.1021s
	iters: 900, epoch: 2 | loss: 0.6082722
	speed: 0.0073s/iter; left time: 45.6830s
	iters: 1000, epoch: 2 | loss: 1.0420406
	speed: 0.0068s/iter; left time: 42.1755s
Updating learning rate to 0.0001538940389524981
Validation loss decreased (0.3773 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 6.587749004364014
Epoch: 2, Steps: 1027 | Train Loss: 0.6519272 Vali Loss: 0.3673408 Best vali loss: 0.3673408
	iters: 100, epoch: 3 | loss: 0.5990359
	speed: 0.0209s/iter; left time: 126.6313s
	iters: 200, epoch: 3 | loss: 0.2011138
	speed: 0.0065s/iter; left time: 38.4982s
	iters: 300, epoch: 3 | loss: 0.3722163
	speed: 0.0059s/iter; left time: 34.5557s
	iters: 400, epoch: 3 | loss: 1.4977767
	speed: 0.0065s/iter; left time: 37.6645s
	iters: 500, epoch: 3 | loss: 0.5907003
	speed: 0.0062s/iter; left time: 35.0616s
	iters: 600, epoch: 3 | loss: 0.1701707
	speed: 0.0063s/iter; left time: 35.0768s
	iters: 700, epoch: 3 | loss: 0.5803967
	speed: 0.0055s/iter; left time: 30.0834s
	iters: 800, epoch: 3 | loss: 0.4326189
	speed: 0.0071s/iter; left time: 38.1703s
	iters: 900, epoch: 3 | loss: 0.7508349
	speed: 0.0069s/iter; left time: 36.2520s
	iters: 1000, epoch: 3 | loss: 0.4186593
	speed: 0.0075s/iter; left time: 38.6592s
Updating learning rate to 0.00012464758522689868
Epoch: 3 cost time: 6.728370428085327
Epoch: 3, Steps: 1027 | Train Loss: 0.5613524 Vali Loss: 0.3715585 Best vali loss: 0.3673408
	iters: 100, epoch: 4 | loss: 0.5997238
	speed: 0.0198s/iter; left time: 99.9614s
	iters: 200, epoch: 4 | loss: 0.7869790
	speed: 0.0079s/iter; left time: 38.9725s
	iters: 300, epoch: 4 | loss: 0.6166344
	speed: 0.0077s/iter; left time: 37.3035s
	iters: 400, epoch: 4 | loss: 0.7089649
	speed: 0.0079s/iter; left time: 37.4879s
	iters: 500, epoch: 4 | loss: 1.1885353
	speed: 0.0069s/iter; left time: 32.1249s
	iters: 600, epoch: 4 | loss: 0.9333296
	speed: 0.0076s/iter; left time: 34.5505s
	iters: 700, epoch: 4 | loss: 0.2491812
	speed: 0.0085s/iter; left time: 37.5764s
	iters: 800, epoch: 4 | loss: 0.9639685
	speed: 0.0066s/iter; left time: 28.4433s
	iters: 900, epoch: 4 | loss: 1.1189843
	speed: 0.0080s/iter; left time: 34.0088s
	iters: 1000, epoch: 4 | loss: 0.4267654
	speed: 0.0079s/iter; left time: 32.5500s
Updating learning rate to 9.014904085e-05
Validation loss decreased (0.3673 --> 0.3671).  Saving model state dict ...
Epoch: 4 cost time: 7.645303964614868
Epoch: 4, Steps: 1027 | Train Loss: 0.7593066 Vali Loss: 0.3671021 Best vali loss: 0.3671021
	iters: 100, epoch: 5 | loss: 0.2059232
	speed: 0.0205s/iter; left time: 82.3409s
	iters: 200, epoch: 5 | loss: 1.1218548
	speed: 0.0053s/iter; left time: 20.8237s
	iters: 300, epoch: 5 | loss: 0.3455710
	speed: 0.0053s/iter; left time: 20.1669s
	iters: 400, epoch: 5 | loss: 0.6500373
	speed: 0.0053s/iter; left time: 19.6445s
	iters: 500, epoch: 5 | loss: 1.6588718
	speed: 0.0066s/iter; left time: 23.8928s
	iters: 600, epoch: 5 | loss: 0.7471381
	speed: 0.0067s/iter; left time: 23.5467s
	iters: 700, epoch: 5 | loss: 0.3348769
	speed: 0.0066s/iter; left time: 22.6044s
	iters: 800, epoch: 5 | loss: 0.4248389
	speed: 0.0064s/iter; left time: 21.2561s
	iters: 900, epoch: 5 | loss: 1.7370591
	speed: 0.0073s/iter; left time: 23.3056s
	iters: 1000, epoch: 5 | loss: 1.5677842
	speed: 0.0068s/iter; left time: 21.1224s
Updating learning rate to 5.5650496473101316e-05
Epoch: 5 cost time: 6.375100612640381
Epoch: 5, Steps: 1027 | Train Loss: 0.8793955 Vali Loss: 0.3705900 Best vali loss: 0.3671021
	iters: 100, epoch: 6 | loss: 0.3229445
	speed: 0.0208s/iter; left time: 62.1420s
	iters: 200, epoch: 6 | loss: 0.1932746
	speed: 0.0075s/iter; left time: 21.7167s
	iters: 300, epoch: 6 | loss: 0.6730893
	speed: 0.0078s/iter; left time: 21.6961s
	iters: 400, epoch: 6 | loss: 0.4818902
	speed: 0.0079s/iter; left time: 21.1297s
	iters: 500, epoch: 6 | loss: 0.2814417
	speed: 0.0076s/iter; left time: 19.6456s
	iters: 600, epoch: 6 | loss: 0.3248731
	speed: 0.0073s/iter; left time: 17.9982s
	iters: 700, epoch: 6 | loss: 0.6993399
	speed: 0.0081s/iter; left time: 19.2557s
	iters: 800, epoch: 6 | loss: 0.4370638
	speed: 0.0079s/iter; left time: 18.1311s
	iters: 900, epoch: 6 | loss: 0.5613294
	speed: 0.0066s/iter; left time: 14.3812s
	iters: 1000, epoch: 6 | loss: 0.8484280
	speed: 0.0071s/iter; left time: 14.7196s
Updating learning rate to 2.6404042747501922e-05
Epoch: 6 cost time: 7.793621063232422
Epoch: 6, Steps: 1027 | Train Loss: 0.4823675 Vali Loss: 0.3700641 Best vali loss: 0.3671021
	iters: 100, epoch: 7 | loss: 0.2120435
	speed: 0.0252s/iter; left time: 49.3590s
	iters: 200, epoch: 7 | loss: 0.7027921
	speed: 0.0079s/iter; left time: 14.5624s
	iters: 300, epoch: 7 | loss: 1.0713656
	speed: 0.0075s/iter; left time: 13.2347s
	iters: 400, epoch: 7 | loss: 0.5180783
	speed: 0.0080s/iter; left time: 13.2164s
	iters: 500, epoch: 7 | loss: 0.4140870
	speed: 0.0080s/iter; left time: 12.4619s
	iters: 600, epoch: 7 | loss: 1.3298223
	speed: 0.0074s/iter; left time: 10.7508s
	iters: 700, epoch: 7 | loss: 0.5162702
	speed: 0.0082s/iter; left time: 11.0539s
	iters: 800, epoch: 7 | loss: 0.4316531
	speed: 0.0074s/iter; left time: 9.2273s
	iters: 900, epoch: 7 | loss: 0.3377160
	speed: 0.0067s/iter; left time: 7.7118s
	iters: 1000, epoch: 7 | loss: 0.6487343
	speed: 0.0071s/iter; left time: 7.4797s
Updating learning rate to 6.862187133161109e-06
Epoch: 7 cost time: 7.881923675537109
Epoch: 7, Steps: 1027 | Train Loss: 0.6182562 Vali Loss: 0.3705108 Best vali loss: 0.3671021
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009225062942, 'e_layers': 1, 'learning_rate': 0.0034509285106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0033195853648514996
Validation loss decreased (inf --> 0.3992).  Saving model state dict ...
Epoch: 1 cost time: 0.8662912845611572
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3991865 Best vali loss: 0.3991865
Updating learning rate to 0.002945551730917626
Validation loss decreased (0.3992 --> 0.3779).  Saving model state dict ...
Epoch: 2 cost time: 0.457427978515625
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3779383 Best vali loss: 0.3779383
Updating learning rate to 0.0023857708389414777
Validation loss decreased (0.3779 --> 0.3748).  Saving model state dict ...
Epoch: 3 cost time: 0.39334917068481445
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3748434 Best vali loss: 0.3748434

best validation loss 0.37484344994623675

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0025546905279, 'e_layers': 3, 'learning_rate': 0.0006512109997, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3404844
	speed: 0.0141s/iter; left time: 114.6798s
	iters: 200, epoch: 1 | loss: 0.4154971
	speed: 0.0075s/iter; left time: 60.4133s
	iters: 300, epoch: 1 | loss: 0.4799418
	speed: 0.0067s/iter; left time: 53.2965s
	iters: 400, epoch: 1 | loss: 0.3371332
	speed: 0.0067s/iter; left time: 52.5880s
	iters: 500, epoch: 1 | loss: 1.2340196
	speed: 0.0083s/iter; left time: 64.2796s
	iters: 600, epoch: 1 | loss: 0.5674024
	speed: 0.0085s/iter; left time: 64.8655s
	iters: 700, epoch: 1 | loss: 0.8046805
	speed: 0.0077s/iter; left time: 58.0749s
	iters: 800, epoch: 1 | loss: 0.4519915
	speed: 0.0068s/iter; left time: 50.7592s
	iters: 900, epoch: 1 | loss: 0.5716594
	speed: 0.0104s/iter; left time: 76.3061s
	iters: 1000, epoch: 1 | loss: 0.3528093
	speed: 0.0094s/iter; left time: 68.1565s
Updating learning rate to 0.0006512109997
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 8.563035011291504
Epoch: 1, Steps: 1027 | Train Loss: 0.5555619 Vali Loss: 0.3635314 Best vali loss: 0.3635314
	iters: 100, epoch: 2 | loss: 0.5184087
	speed: 0.0338s/iter; left time: 239.4945s
	iters: 200, epoch: 2 | loss: 0.4507790
	speed: 0.0074s/iter; left time: 51.8445s
	iters: 300, epoch: 2 | loss: 1.0278759
	speed: 0.0079s/iter; left time: 54.4849s
	iters: 400, epoch: 2 | loss: 0.8656427
	speed: 0.0080s/iter; left time: 54.0527s
	iters: 500, epoch: 2 | loss: 0.2047724
	speed: 0.0078s/iter; left time: 52.0668s
	iters: 600, epoch: 2 | loss: 0.7653472
	speed: 0.0086s/iter; left time: 56.5129s
	iters: 700, epoch: 2 | loss: 1.0034568
	speed: 0.0065s/iter; left time: 42.4366s
	iters: 800, epoch: 2 | loss: 1.4973871
	speed: 0.0100s/iter; left time: 63.6998s
	iters: 900, epoch: 2 | loss: 0.3871692
	speed: 0.0114s/iter; left time: 72.0129s
	iters: 1000, epoch: 2 | loss: 0.4352073
	speed: 0.0128s/iter; left time: 79.3447s
Updating learning rate to 0.00032560549985
Epoch: 2 cost time: 9.540920495986938
Epoch: 2, Steps: 1027 | Train Loss: 0.7156046 Vali Loss: 0.3785172 Best vali loss: 0.3635314
	iters: 100, epoch: 3 | loss: 0.4853201
	speed: 0.0246s/iter; left time: 149.4005s
	iters: 200, epoch: 3 | loss: 0.7253381
	speed: 0.0111s/iter; left time: 66.3987s
	iters: 300, epoch: 3 | loss: 0.9175089
	speed: 0.0123s/iter; left time: 72.3903s
	iters: 400, epoch: 3 | loss: 0.3751327
	speed: 0.0101s/iter; left time: 58.1165s
	iters: 500, epoch: 3 | loss: 0.3147866
	speed: 0.0076s/iter; left time: 42.8089s
	iters: 600, epoch: 3 | loss: 0.2637737
	speed: 0.0074s/iter; left time: 41.4254s
	iters: 700, epoch: 3 | loss: 1.0538036
	speed: 0.0076s/iter; left time: 41.7105s
	iters: 800, epoch: 3 | loss: 0.2769278
	speed: 0.0081s/iter; left time: 43.3531s
	iters: 900, epoch: 3 | loss: 0.3544686
	speed: 0.0081s/iter; left time: 42.7737s
	iters: 1000, epoch: 3 | loss: 0.3612310
	speed: 0.0083s/iter; left time: 42.8375s
Updating learning rate to 0.000162802749925
Epoch: 3 cost time: 8.98172116279602
Epoch: 3, Steps: 1027 | Train Loss: 0.5128291 Vali Loss: 0.3762921 Best vali loss: 0.3635314

best validation loss 0.3635313687659434

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0011857304294, 'e_layers': 1, 'learning_rate': 0.0027601008743, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7341527
	speed: 0.0128s/iter; left time: 103.6457s
	iters: 200, epoch: 1 | loss: 0.9582301
	speed: 0.0062s/iter; left time: 49.4935s
	iters: 300, epoch: 1 | loss: 0.5481358
	speed: 0.0058s/iter; left time: 45.7366s
	iters: 400, epoch: 1 | loss: 0.6654642
	speed: 0.0058s/iter; left time: 45.2201s
	iters: 500, epoch: 1 | loss: 1.1031760
	speed: 0.0054s/iter; left time: 41.6381s
	iters: 600, epoch: 1 | loss: 0.3571158
	speed: 0.0055s/iter; left time: 42.0193s
	iters: 700, epoch: 1 | loss: 0.6779884
	speed: 0.0054s/iter; left time: 40.4990s
	iters: 800, epoch: 1 | loss: 0.2105647
	speed: 0.0058s/iter; left time: 43.0818s
	iters: 900, epoch: 1 | loss: 0.7587145
	speed: 0.0059s/iter; left time: 43.2658s
	iters: 1000, epoch: 1 | loss: 0.9284010
	speed: 0.0061s/iter; left time: 44.3239s
Updating learning rate to 0.0027601008743
Validation loss decreased (inf --> 0.3648).  Saving model state dict ...
Epoch: 1 cost time: 6.29149603843689
Epoch: 1, Steps: 1027 | Train Loss: 0.6941943 Vali Loss: 0.3648164 Best vali loss: 0.3648164
	iters: 100, epoch: 2 | loss: 0.7202129
	speed: 0.0188s/iter; left time: 133.0090s
	iters: 200, epoch: 2 | loss: 0.3610760
	speed: 0.0056s/iter; left time: 38.8213s
	iters: 300, epoch: 2 | loss: 0.3588409
	speed: 0.0046s/iter; left time: 31.5004s
	iters: 400, epoch: 2 | loss: 0.4626064
	speed: 0.0045s/iter; left time: 30.3134s
	iters: 500, epoch: 2 | loss: 0.3258415
	speed: 0.0057s/iter; left time: 37.9466s
	iters: 600, epoch: 2 | loss: 0.4650056
	speed: 0.0055s/iter; left time: 36.1300s
	iters: 700, epoch: 2 | loss: 0.6972750
	speed: 0.0052s/iter; left time: 34.0186s
	iters: 800, epoch: 2 | loss: 0.7857421
	speed: 0.0052s/iter; left time: 33.4500s
	iters: 900, epoch: 2 | loss: 0.4560122
	speed: 0.0054s/iter; left time: 34.1429s
	iters: 1000, epoch: 2 | loss: 0.2940361
	speed: 0.0060s/iter; left time: 37.0949s
Updating learning rate to 0.00138005043715
Epoch: 2 cost time: 5.550872087478638
Epoch: 2, Steps: 1027 | Train Loss: 0.4926649 Vali Loss: 0.3737855 Best vali loss: 0.3648164
	iters: 100, epoch: 3 | loss: 1.1610144
	speed: 0.0234s/iter; left time: 141.9902s
	iters: 200, epoch: 3 | loss: 0.4250138
	speed: 0.0048s/iter; left time: 28.6846s
	iters: 300, epoch: 3 | loss: 0.3665484
	speed: 0.0043s/iter; left time: 25.4096s
	iters: 400, epoch: 3 | loss: 0.9132134
	speed: 0.0045s/iter; left time: 26.0603s
	iters: 500, epoch: 3 | loss: 0.5118799
	speed: 0.0059s/iter; left time: 33.5187s
	iters: 600, epoch: 3 | loss: 0.2802218
	speed: 0.0060s/iter; left time: 33.5008s
	iters: 700, epoch: 3 | loss: 1.3351722
	speed: 0.0055s/iter; left time: 30.0626s
	iters: 800, epoch: 3 | loss: 0.1933186
	speed: 0.0057s/iter; left time: 30.5873s
	iters: 900, epoch: 3 | loss: 0.7760807
	speed: 0.0056s/iter; left time: 29.2933s
	iters: 1000, epoch: 3 | loss: 0.2388887
	speed: 0.0058s/iter; left time: 30.0911s
Updating learning rate to 0.000690025218575
Epoch: 3 cost time: 5.580950021743774
Epoch: 3, Steps: 1027 | Train Loss: 0.6201352 Vali Loss: 0.3769508 Best vali loss: 0.3648164

best validation loss 0.364816395543179

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0025546905279, 'e_layers': 3, 'learning_rate': 0.0006512109997, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3212592
	speed: 0.0170s/iter; left time: 85.8266s
	iters: 200, epoch: 4 | loss: 0.3535118
	speed: 0.0102s/iter; left time: 50.3371s
	iters: 300, epoch: 4 | loss: 0.4456357
	speed: 0.0101s/iter; left time: 49.0814s
	iters: 400, epoch: 4 | loss: 0.3367376
	speed: 0.0102s/iter; left time: 48.2902s
	iters: 500, epoch: 4 | loss: 1.2283841
	speed: 0.0097s/iter; left time: 44.8535s
	iters: 600, epoch: 4 | loss: 0.5670037
	speed: 0.0083s/iter; left time: 37.5299s
	iters: 700, epoch: 4 | loss: 0.8940991
	speed: 0.0137s/iter; left time: 60.9267s
	iters: 800, epoch: 4 | loss: 0.4616711
	speed: 0.0123s/iter; left time: 53.2380s
	iters: 900, epoch: 4 | loss: 0.5978062
	speed: 0.0151s/iter; left time: 63.9293s
	iters: 1000, epoch: 4 | loss: 0.3593654
	speed: 0.0133s/iter; left time: 54.8409s
Updating learning rate to 8.14013749625e-05
Epoch: 4 cost time: 12.012659788131714
Epoch: 4, Steps: 1027 | Train Loss: 0.5565474 Vali Loss: 0.3687078 Best vali loss: 0.3635314
	iters: 100, epoch: 5 | loss: 0.5663759
	speed: 0.0394s/iter; left time: 158.0430s
	iters: 200, epoch: 5 | loss: 0.4498017
	speed: 0.0134s/iter; left time: 52.3775s
	iters: 300, epoch: 5 | loss: 0.9797501
	speed: 0.0119s/iter; left time: 45.4609s
	iters: 400, epoch: 5 | loss: 0.8665050
	speed: 0.0149s/iter; left time: 55.1073s
	iters: 500, epoch: 5 | loss: 0.2061872
	speed: 0.0132s/iter; left time: 47.6692s
	iters: 600, epoch: 5 | loss: 0.7536281
	speed: 0.0144s/iter; left time: 50.5736s
	iters: 700, epoch: 5 | loss: 0.9939353
	speed: 0.0091s/iter; left time: 30.9014s
	iters: 800, epoch: 5 | loss: 1.5069680
	speed: 0.0148s/iter; left time: 48.9991s
	iters: 900, epoch: 5 | loss: 0.3519399
	speed: 0.0110s/iter; left time: 35.2619s
	iters: 1000, epoch: 5 | loss: 0.4812982
	speed: 0.0071s/iter; left time: 22.0761s
Updating learning rate to 4.070068748125e-05
Epoch: 5 cost time: 12.629156112670898
Epoch: 5, Steps: 1027 | Train Loss: 0.7156389 Vali Loss: 0.3705225 Best vali loss: 0.3635314
	iters: 100, epoch: 6 | loss: 0.4789224
	speed: 0.0311s/iter; left time: 92.8152s
	iters: 200, epoch: 6 | loss: 0.6571059
	speed: 0.0076s/iter; left time: 21.9011s
	iters: 300, epoch: 6 | loss: 0.9026253
	speed: 0.0095s/iter; left time: 26.3228s
	iters: 400, epoch: 6 | loss: 0.3755910
	speed: 0.0102s/iter; left time: 27.4412s
	iters: 500, epoch: 6 | loss: 0.2991849
	speed: 0.0087s/iter; left time: 22.5883s
	iters: 600, epoch: 6 | loss: 0.2509066
	speed: 0.0091s/iter; left time: 22.6324s
	iters: 700, epoch: 6 | loss: 1.0582755
	speed: 0.0093s/iter; left time: 22.2112s
	iters: 800, epoch: 6 | loss: 0.2756573
	speed: 0.0098s/iter; left time: 22.3142s
	iters: 900, epoch: 6 | loss: 0.7520521
	speed: 0.0101s/iter; left time: 21.9620s
	iters: 1000, epoch: 6 | loss: 0.3513511
	speed: 0.0096s/iter; left time: 19.9884s
Updating learning rate to 2.0350343740625e-05
Epoch: 6 cost time: 9.683002710342407
Epoch: 6, Steps: 1027 | Train Loss: 0.5401672 Vali Loss: 0.3720233 Best vali loss: 0.3635314
	iters: 100, epoch: 7 | loss: 0.3680359
	speed: 0.0279s/iter; left time: 54.4572s
	iters: 200, epoch: 7 | loss: 0.5079303
	speed: 0.0098s/iter; left time: 18.1925s
	iters: 300, epoch: 7 | loss: 0.9927586
	speed: 0.0099s/iter; left time: 17.3611s
	iters: 400, epoch: 7 | loss: 0.2486507
	speed: 0.0096s/iter; left time: 15.8127s
	iters: 500, epoch: 7 | loss: 0.9797199
	speed: 0.0098s/iter; left time: 15.2795s
	iters: 600, epoch: 7 | loss: 0.9308318
	speed: 0.0104s/iter; left time: 15.0872s
	iters: 700, epoch: 7 | loss: 1.1954269
	speed: 0.0091s/iter; left time: 12.3743s
	iters: 800, epoch: 7 | loss: 0.3966272
	speed: 0.0069s/iter; left time: 8.6955s
	iters: 900, epoch: 7 | loss: 0.1938983
	speed: 0.0076s/iter; left time: 8.7499s
	iters: 1000, epoch: 7 | loss: 0.3574176
	speed: 0.0087s/iter; left time: 9.1873s
Updating learning rate to 1.01751718703125e-05
Epoch: 7 cost time: 9.35079550743103
Epoch: 7, Steps: 1027 | Train Loss: 0.6171297 Vali Loss: 0.3711021 Best vali loss: 0.3635314
	iters: 100, epoch: 8 | loss: 0.4319404
	speed: 0.0238s/iter; left time: 22.1095s
	iters: 200, epoch: 8 | loss: 0.2957247
	speed: 0.0089s/iter; left time: 7.3807s
	iters: 300, epoch: 8 | loss: 0.7376733
	speed: 0.0092s/iter; left time: 6.6792s
	iters: 400, epoch: 8 | loss: 0.2619693
	speed: 0.0090s/iter; left time: 5.6727s
	iters: 500, epoch: 8 | loss: 0.9839334
	speed: 0.0075s/iter; left time: 3.9373s
	iters: 600, epoch: 8 | loss: 0.3042079
	speed: 0.0062s/iter; left time: 2.6604s
	iters: 700, epoch: 8 | loss: 0.9329056
	speed: 0.0098s/iter; left time: 3.2036s
	iters: 800, epoch: 8 | loss: 1.4123734
	speed: 0.0095s/iter; left time: 2.1680s
	iters: 900, epoch: 8 | loss: 0.3161058
	speed: 0.0073s/iter; left time: 0.9392s
	iters: 1000, epoch: 8 | loss: 0.5091618
	speed: 0.0106s/iter; left time: 0.2969s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0088883810649, 'e_layers': 2, 'learning_rate': 0.000686764093, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000686764093
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 1.369042158126831
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3647474 Best vali loss: 0.3647474
Updating learning rate to 0.0003433820465
Epoch: 2 cost time: 1.0205371379852295
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3702623 Best vali loss: 0.3647474
Updating learning rate to 0.00017169102325
Validation loss decreased (0.3647 --> 0.3584).  Saving model state dict ...
Epoch: 3 cost time: 1.0022308826446533
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3584401 Best vali loss: 0.3584401
Updating learning rate to 8.5845511625e-05
Validation loss decreased (0.3584 --> 0.3547).  Saving model state dict ...
Epoch: 4 cost time: 1.0535321235656738
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3546824 Best vali loss: 0.3546824
Updating learning rate to 4.29227558125e-05
Epoch: 5 cost time: 1.0282130241394043
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3575817 Best vali loss: 0.3546824
Updating learning rate to 2.146137790625e-05
Epoch: 6 cost time: 0.8530802726745605
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3582652 Best vali loss: 0.3546824
Updating learning rate to 1.0730688953125e-05
Epoch: 7 cost time: 0.7607724666595459
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3582595 Best vali loss: 0.3546824
Updating learning rate to 5.3653444765625e-06
Epoch: 8 cost time: 0.7683820724487305
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3584308 Best vali loss: 0.3546824

best validation loss 0.3546823643982293

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013113448531, 'e_layers': 3, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5220346
	speed: 0.0141s/iter; left time: 114.6592s
	iters: 200, epoch: 1 | loss: 0.2947251
	speed: 0.0077s/iter; left time: 61.9551s
	iters: 300, epoch: 1 | loss: 0.4830360
	speed: 0.0078s/iter; left time: 61.5802s
	iters: 400, epoch: 1 | loss: 1.0054814
	speed: 0.0075s/iter; left time: 58.2484s
	iters: 500, epoch: 1 | loss: 0.8277249
	speed: 0.0067s/iter; left time: 51.3579s
	iters: 600, epoch: 1 | loss: 1.2825139
	speed: 0.0074s/iter; left time: 56.2226s
	iters: 700, epoch: 1 | loss: 0.5075806
	speed: 0.0068s/iter; left time: 50.8354s
	iters: 800, epoch: 1 | loss: 0.2783591
	speed: 0.0077s/iter; left time: 56.8612s
	iters: 900, epoch: 1 | loss: 0.2914484
	speed: 0.0083s/iter; left time: 60.9101s
	iters: 1000, epoch: 1 | loss: 0.2529402
	speed: 0.0083s/iter; left time: 59.6072s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 8.148169994354248
Epoch: 1, Steps: 1027 | Train Loss: 0.5745844 Vali Loss: 0.3708088 Best vali loss: 0.3708088
	iters: 100, epoch: 2 | loss: 0.4927071
	speed: 0.0228s/iter; left time: 161.5847s
	iters: 200, epoch: 2 | loss: 0.3003436
	speed: 0.0081s/iter; left time: 56.6923s
	iters: 300, epoch: 2 | loss: 0.5701311
	speed: 0.0084s/iter; left time: 57.7494s
	iters: 400, epoch: 2 | loss: 0.7279508
	speed: 0.0082s/iter; left time: 55.8663s
	iters: 500, epoch: 2 | loss: 0.8391305
	speed: 0.0084s/iter; left time: 55.9866s
	iters: 600, epoch: 2 | loss: 0.2543152
	speed: 0.0075s/iter; left time: 49.1835s
	iters: 700, epoch: 2 | loss: 0.2763720
	speed: 0.0064s/iter; left time: 41.4970s
	iters: 800, epoch: 2 | loss: 0.3239989
	speed: 0.0075s/iter; left time: 48.1355s
	iters: 900, epoch: 2 | loss: 0.3710263
	speed: 0.0083s/iter; left time: 52.1206s
	iters: 1000, epoch: 2 | loss: 0.5962281
	speed: 0.0084s/iter; left time: 51.9749s
Updating learning rate to 0.00022164530374923903
Epoch: 2 cost time: 8.131487846374512
Epoch: 2, Steps: 1027 | Train Loss: 0.4752204 Vali Loss: 0.3765788 Best vali loss: 0.3708088
	iters: 100, epoch: 3 | loss: 0.3434015
	speed: 0.0225s/iter; left time: 136.5928s
	iters: 200, epoch: 3 | loss: 0.9816570
	speed: 0.0076s/iter; left time: 45.0566s
	iters: 300, epoch: 3 | loss: 0.8426349
	speed: 0.0073s/iter; left time: 42.7958s
	iters: 400, epoch: 3 | loss: 0.4346849
	speed: 0.0073s/iter; left time: 42.2694s
	iters: 500, epoch: 3 | loss: 1.1140125
	speed: 0.0075s/iter; left time: 42.4367s
	iters: 600, epoch: 3 | loss: 0.3549527
	speed: 0.0079s/iter; left time: 43.7022s
	iters: 700, epoch: 3 | loss: 0.2101375
	speed: 0.0080s/iter; left time: 43.6704s
	iters: 800, epoch: 3 | loss: 0.4107984
	speed: 0.0070s/iter; left time: 37.7686s
	iters: 900, epoch: 3 | loss: 0.6435065
	speed: 0.0076s/iter; left time: 39.7482s
	iters: 1000, epoch: 3 | loss: 0.4760222
	speed: 0.0083s/iter; left time: 42.9545s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.3708 --> 0.3695).  Saving model state dict ...
Epoch: 3 cost time: 7.782121181488037
Epoch: 3, Steps: 1027 | Train Loss: 0.5811808 Vali Loss: 0.3694800 Best vali loss: 0.3694800
	iters: 100, epoch: 4 | loss: 0.3193384
	speed: 0.0232s/iter; left time: 116.6373s
	iters: 200, epoch: 4 | loss: 0.3356890
	speed: 0.0062s/iter; left time: 30.4310s
	iters: 300, epoch: 4 | loss: 0.2719698
	speed: 0.0082s/iter; left time: 39.4196s
	iters: 400, epoch: 4 | loss: 0.5847275
	speed: 0.0079s/iter; left time: 37.4417s
	iters: 500, epoch: 4 | loss: 0.4363349
	speed: 0.0081s/iter; left time: 37.4949s
	iters: 600, epoch: 4 | loss: 0.5823907
	speed: 0.0084s/iter; left time: 37.9930s
	iters: 700, epoch: 4 | loss: 0.4013525
	speed: 0.0064s/iter; left time: 28.2933s
	iters: 800, epoch: 4 | loss: 0.8035633
	speed: 0.0075s/iter; left time: 32.5952s
	iters: 900, epoch: 4 | loss: 0.3781035
	speed: 0.0079s/iter; left time: 33.3112s
	iters: 1000, epoch: 4 | loss: 0.2558939
	speed: 0.0083s/iter; left time: 34.5290s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 7.7478532791137695
Epoch: 4, Steps: 1027 | Train Loss: 0.4369364 Vali Loss: 0.3702994 Best vali loss: 0.3694800
	iters: 100, epoch: 5 | loss: 0.7822132
	speed: 0.0218s/iter; left time: 87.2965s
	iters: 200, epoch: 5 | loss: 0.7105642
	speed: 0.0068s/iter; left time: 26.6296s
	iters: 300, epoch: 5 | loss: 0.9653257
	speed: 0.0078s/iter; left time: 29.6565s
	iters: 400, epoch: 5 | loss: 0.6056122
	speed: 0.0068s/iter; left time: 25.0990s
	iters: 500, epoch: 5 | loss: 0.8654391
	speed: 0.0085s/iter; left time: 30.6105s
	iters: 600, epoch: 5 | loss: 0.3677998
	speed: 0.0085s/iter; left time: 29.6836s
	iters: 700, epoch: 5 | loss: 0.9755419
	speed: 0.0087s/iter; left time: 29.7003s
	iters: 800, epoch: 5 | loss: 0.3461733
	speed: 0.0087s/iter; left time: 28.7214s
	iters: 900, epoch: 5 | loss: 0.3217889
	speed: 0.0080s/iter; left time: 25.7056s
	iters: 1000, epoch: 5 | loss: 0.9225615
	speed: 0.0088s/iter; left time: 27.4959s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 8.179312944412231
Epoch: 5, Steps: 1027 | Train Loss: 0.6863020 Vali Loss: 0.3730018 Best vali loss: 0.3694800
	iters: 100, epoch: 6 | loss: 0.3779407
	speed: 0.0228s/iter; left time: 67.8804s
	iters: 200, epoch: 6 | loss: 0.6393521
	speed: 0.0084s/iter; left time: 24.1982s
	iters: 300, epoch: 6 | loss: 0.5278581
	speed: 0.0084s/iter; left time: 23.2942s
	iters: 400, epoch: 6 | loss: 0.4656598
	speed: 0.0063s/iter; left time: 17.0099s
	iters: 500, epoch: 6 | loss: 0.4790859
	speed: 0.0079s/iter; left time: 20.4478s
	iters: 600, epoch: 6 | loss: 0.6179621
	speed: 0.0089s/iter; left time: 22.1628s
	iters: 700, epoch: 6 | loss: 0.3873047
	speed: 0.0082s/iter; left time: 19.5486s
	iters: 800, epoch: 6 | loss: 0.2704383
	speed: 0.0088s/iter; left time: 20.1133s
	iters: 900, epoch: 6 | loss: 1.0253503
	speed: 0.0070s/iter; left time: 15.3719s
	iters: 1000, epoch: 6 | loss: 0.8999917
	speed: 0.0072s/iter; left time: 15.0469s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 8.109103202819824
Epoch: 6, Steps: 1027 | Train Loss: 0.5690944 Vali Loss: 0.3735219 Best vali loss: 0.3694800
	iters: 100, epoch: 7 | loss: 1.1907550
	speed: 0.0267s/iter; left time: 52.1538s
	iters: 200, epoch: 7 | loss: 0.5640132
	speed: 0.0094s/iter; left time: 17.4874s
	iters: 300, epoch: 7 | loss: 0.6231099
	speed: 0.0089s/iter; left time: 15.6281s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 4, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.4009).  Saving model state dict ...
Epoch: 1 cost time: 2.4723587036132812
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4008789 Best vali loss: 0.4008789
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.4009 --> 0.3848).  Saving model state dict ...
Epoch: 2 cost time: 1.1343238353729248
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3848085 Best vali loss: 0.3848085
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.3848 --> 0.3795).  Saving model state dict ...
Epoch: 3 cost time: 1.57297682762146
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3795049 Best vali loss: 0.3795049

best validation loss 0.37950485318255095

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0080338200163, 'e_layers': 4, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8091369
	speed: 0.0209s/iter; left time: 83.9106s
	iters: 200, epoch: 1 | loss: 0.5958122
	speed: 0.0154s/iter; left time: 60.2615s
	iters: 300, epoch: 1 | loss: 1.2384502
	speed: 0.0155s/iter; left time: 58.9586s
	iters: 400, epoch: 1 | loss: 0.7531020
	speed: 0.0157s/iter; left time: 58.1827s
	iters: 500, epoch: 1 | loss: 0.7898915
	speed: 0.0140s/iter; left time: 50.6893s
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 8.045801162719727
Epoch: 1, Steps: 514 | Train Loss: 0.8372786 Vali Loss: 0.3686365 Best vali loss: 0.3686365
	iters: 100, epoch: 2 | loss: 0.3547824
	speed: 0.0648s/iter; left time: 226.6509s
	iters: 200, epoch: 2 | loss: 0.2250240
	speed: 0.0152s/iter; left time: 51.7022s
	iters: 300, epoch: 2 | loss: 0.3067677
	speed: 0.0176s/iter; left time: 58.0890s
	iters: 400, epoch: 2 | loss: 0.6627061
	speed: 0.0162s/iter; left time: 51.7503s
	iters: 500, epoch: 2 | loss: 0.4072530
	speed: 0.0150s/iter; left time: 46.5137s
Updating learning rate to 0.0005431763429672579
Epoch: 2 cost time: 8.235144853591919
Epoch: 2, Steps: 514 | Train Loss: 0.3913067 Vali Loss: 0.3714193 Best vali loss: 0.3686365
	iters: 100, epoch: 3 | loss: 0.4762482
	speed: 0.0419s/iter; left time: 124.9802s
	iters: 200, epoch: 3 | loss: 0.5808845
	speed: 0.0149s/iter; left time: 43.0868s
	iters: 300, epoch: 3 | loss: 0.4554654
	speed: 0.0151s/iter; left time: 42.0292s
	iters: 400, epoch: 3 | loss: 0.3717491
	speed: 0.0139s/iter; left time: 37.2577s
	iters: 500, epoch: 3 | loss: 0.8451666
	speed: 0.0107s/iter; left time: 27.7221s
Updating learning rate to 0.00043994959105690174
Epoch: 3 cost time: 6.834929943084717
Epoch: 3, Steps: 514 | Train Loss: 0.5459028 Vali Loss: 0.3846633 Best vali loss: 0.3686365

best validation loss 0.36863653129936436

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.001305182651, 'e_layers': 2, 'learning_rate': 6.28915805e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6895388
	speed: 0.0134s/iter; left time: 108.6542s
	iters: 200, epoch: 1 | loss: 0.9473912
	speed: 0.0066s/iter; left time: 52.7912s
	iters: 300, epoch: 1 | loss: 1.0900426
	speed: 0.0068s/iter; left time: 53.4540s
	iters: 400, epoch: 1 | loss: 0.4949694
	speed: 0.0054s/iter; left time: 41.9440s
	iters: 500, epoch: 1 | loss: 0.3728108
	speed: 0.0075s/iter; left time: 57.7536s
	iters: 600, epoch: 1 | loss: 0.4996896
	speed: 0.0084s/iter; left time: 63.6032s
	iters: 700, epoch: 1 | loss: 0.2675662
	speed: 0.0069s/iter; left time: 51.8307s
	iters: 800, epoch: 1 | loss: 0.2768387
	speed: 0.0047s/iter; left time: 34.6173s
	iters: 900, epoch: 1 | loss: 1.2442751
	speed: 0.0043s/iter; left time: 31.4754s
	iters: 1000, epoch: 1 | loss: 0.3077752
	speed: 0.0054s/iter; left time: 38.8338s
Updating learning rate to 6.049791224561798e-05
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 6.791749477386475
Epoch: 1, Steps: 1027 | Train Loss: 0.6190897 Vali Loss: 0.3695787 Best vali loss: 0.3695787
	iters: 100, epoch: 2 | loss: 0.6970676
	speed: 0.0247s/iter; left time: 174.8225s
	iters: 200, epoch: 2 | loss: 0.8239189
	speed: 0.0083s/iter; left time: 58.0666s
	iters: 300, epoch: 2 | loss: 0.2975133
	speed: 0.0059s/iter; left time: 40.9315s
	iters: 400, epoch: 2 | loss: 0.3118452
	speed: 0.0080s/iter; left time: 54.2206s
	iters: 500, epoch: 2 | loss: 1.0878580
	speed: 0.0066s/iter; left time: 44.2429s
	iters: 600, epoch: 2 | loss: 0.5181655
	speed: 0.0053s/iter; left time: 34.9426s
	iters: 700, epoch: 2 | loss: 0.3543779
	speed: 0.0051s/iter; left time: 33.0264s
	iters: 800, epoch: 2 | loss: 0.3837793
	speed: 0.0072s/iter; left time: 45.9222s
	iters: 900, epoch: 2 | loss: 0.2879343
	speed: 0.0070s/iter; left time: 44.2397s
	iters: 1000, epoch: 2 | loss: 1.2344764
	speed: 0.0073s/iter; left time: 45.3361s
Updating learning rate to 5.368132177554482e-05
Validation loss decreased (0.3696 --> 0.3651).  Saving model state dict ...
Epoch: 2 cost time: 7.126200914382935
Epoch: 2, Steps: 1027 | Train Loss: 0.5996936 Vali Loss: 0.3650633 Best vali loss: 0.3650633
	iters: 100, epoch: 3 | loss: 0.5881555
	speed: 0.0207s/iter; left time: 125.7726s
	iters: 200, epoch: 3 | loss: 0.3065216
	speed: 0.0068s/iter; left time: 40.3812s
	iters: 300, epoch: 3 | loss: 0.6434950
	speed: 0.0058s/iter; left time: 33.8377s
	iters: 400, epoch: 3 | loss: 0.6183908
	speed: 0.0059s/iter; left time: 33.9538s
	iters: 500, epoch: 3 | loss: 0.2569069
	speed: 0.0053s/iter; left time: 29.8339s
	iters: 600, epoch: 3 | loss: 0.9589170
	speed: 0.0052s/iter; left time: 28.6591s
	iters: 700, epoch: 3 | loss: 0.8815385
	speed: 0.0061s/iter; left time: 33.5527s
	iters: 800, epoch: 3 | loss: 1.0256552
	speed: 0.0056s/iter; left time: 30.2640s
	iters: 900, epoch: 3 | loss: 1.0473659
	speed: 0.0053s/iter; left time: 27.8276s
	iters: 1000, epoch: 3 | loss: 0.3344854
	speed: 0.0084s/iter; left time: 43.2391s
Updating learning rate to 4.347957319630268e-05
Epoch: 3 cost time: 6.360962629318237
Epoch: 3, Steps: 1027 | Train Loss: 0.6661432 Vali Loss: 0.3656037 Best vali loss: 0.3650633

best validation loss 0.3650632879940138

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.001305182651, 'e_layers': 2, 'learning_rate': 6.28915805e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5211651
	speed: 0.0153s/iter; left time: 76.8330s
	iters: 200, epoch: 4 | loss: 0.6852294
	speed: 0.0087s/iter; left time: 43.0976s
	iters: 300, epoch: 4 | loss: 0.6554239
	speed: 0.0071s/iter; left time: 34.3088s
	iters: 400, epoch: 4 | loss: 0.4545132
	speed: 0.0088s/iter; left time: 41.6940s
	iters: 500, epoch: 4 | loss: 0.3613639
	speed: 0.0073s/iter; left time: 33.7426s
	iters: 600, epoch: 4 | loss: 0.4745902
	speed: 0.0076s/iter; left time: 34.4818s
	iters: 700, epoch: 4 | loss: 0.2700912
	speed: 0.0083s/iter; left time: 36.6659s
	iters: 800, epoch: 4 | loss: 0.2474359
	speed: 0.0058s/iter; left time: 24.9819s
	iters: 900, epoch: 4 | loss: 1.1365242
	speed: 0.0053s/iter; left time: 22.4195s
	iters: 1000, epoch: 4 | loss: 0.2946281
	speed: 0.0067s/iter; left time: 27.9045s
Updating learning rate to 3.144579025e-05
Epoch: 4 cost time: 7.895501375198364
Epoch: 4, Steps: 1027 | Train Loss: 0.5100965 Vali Loss: 0.3709670 Best vali loss: 0.3650633
	iters: 100, epoch: 5 | loss: 0.5379849
	speed: 0.0219s/iter; left time: 87.9438s
	iters: 200, epoch: 5 | loss: 0.7624181
	speed: 0.0061s/iter; left time: 23.8169s
	iters: 300, epoch: 5 | loss: 0.2871742
	speed: 0.0061s/iter; left time: 23.1513s
	iters: 400, epoch: 5 | loss: 0.3191138
	speed: 0.0058s/iter; left time: 21.5657s
	iters: 500, epoch: 5 | loss: 1.0290916
	speed: 0.0063s/iter; left time: 22.7398s
	iters: 600, epoch: 5 | loss: 0.5278893
	speed: 0.0066s/iter; left time: 23.0043s
	iters: 700, epoch: 5 | loss: 0.3847285
	speed: 0.0066s/iter; left time: 22.5246s
	iters: 800, epoch: 5 | loss: 0.3325664
	speed: 0.0071s/iter; left time: 23.6265s
	iters: 900, epoch: 5 | loss: 0.2998182
	speed: 0.0065s/iter; left time: 20.8548s
	iters: 1000, epoch: 5 | loss: 1.1532339
	speed: 0.0060s/iter; left time: 18.5795s
Updating learning rate to 1.9412007303697326e-05
Epoch: 5 cost time: 6.57076096534729
Epoch: 5, Steps: 1027 | Train Loss: 0.5634019 Vali Loss: 0.3715634 Best vali loss: 0.3650633
	iters: 100, epoch: 6 | loss: 0.5869399
	speed: 0.0209s/iter; left time: 62.1812s
	iters: 200, epoch: 6 | loss: 0.2991039
	speed: 0.0070s/iter; left time: 20.3106s
	iters: 300, epoch: 6 | loss: 0.6364135
	speed: 0.0069s/iter; left time: 19.1530s
	iters: 400, epoch: 6 | loss: 0.6153604
	speed: 0.0067s/iter; left time: 18.0941s
	iters: 500, epoch: 6 | loss: 0.2703563
	speed: 0.0062s/iter; left time: 15.9266s
	iters: 600, epoch: 6 | loss: 0.4618548
	speed: 0.0061s/iter; left time: 15.0393s
	iters: 700, epoch: 6 | loss: 0.8288176
	speed: 0.0062s/iter; left time: 14.7473s
	iters: 800, epoch: 6 | loss: 0.9529718
	speed: 0.0064s/iter; left time: 14.6770s
	iters: 900, epoch: 6 | loss: 1.0183594
	speed: 0.0065s/iter; left time: 14.2565s
	iters: 1000, epoch: 6 | loss: 0.3521447
	speed: 0.0067s/iter; left time: 13.9107s
Updating learning rate to 9.210258724455183e-06
Epoch: 6 cost time: 6.8190248012542725
Epoch: 6, Steps: 1027 | Train Loss: 0.6022322 Vali Loss: 0.3685647 Best vali loss: 0.3650633
	iters: 100, epoch: 7 | loss: 0.4735865
	speed: 0.0208s/iter; left time: 40.7074s
	iters: 200, epoch: 7 | loss: 0.3848128
	speed: 0.0063s/iter; left time: 11.7198s
	iters: 300, epoch: 7 | loss: 0.2072316
	speed: 0.0063s/iter; left time: 11.1288s
	iters: 400, epoch: 7 | loss: 0.6693804
	speed: 0.0068s/iter; left time: 11.3256s
	iters: 500, epoch: 7 | loss: 0.2123275
	speed: 0.0068s/iter; left time: 10.6514s
	iters: 600, epoch: 7 | loss: 0.6554028
	speed: 0.0064s/iter; left time: 9.3357s
	iters: 700, epoch: 7 | loss: 0.8175225
	speed: 0.0059s/iter; left time: 7.9516s
	iters: 800, epoch: 7 | loss: 0.2019376
	speed: 0.0063s/iter; left time: 7.9107s
	iters: 900, epoch: 7 | loss: 0.5951895
	speed: 0.0065s/iter; left time: 7.5061s
	iters: 1000, epoch: 7 | loss: 0.2898976
	speed: 0.0062s/iter; left time: 6.5792s
Updating learning rate to 2.3936682543820215e-06
Epoch: 7 cost time: 6.635061979293823
Epoch: 7, Steps: 1027 | Train Loss: 0.4507289 Vali Loss: 0.3673217 Best vali loss: 0.3650633
	iters: 100, epoch: 8 | loss: 1.3620259
	speed: 0.0209s/iter; left time: 19.3666s
	iters: 200, epoch: 8 | loss: 0.2644710
	speed: 0.0060s/iter; left time: 4.9931s
	iters: 300, epoch: 8 | loss: 0.2654919
	speed: 0.0066s/iter; left time: 4.7885s
	iters: 400, epoch: 8 | loss: 1.5168779
	speed: 0.0064s/iter; left time: 4.0327s
	iters: 500, epoch: 8 | loss: 0.3404204
	speed: 0.0056s/iter; left time: 2.9816s
	iters: 600, epoch: 8 | loss: 0.3173708
	speed: 0.0050s/iter; left time: 2.1518s
	iters: 700, epoch: 8 | loss: 0.7847575
	speed: 0.0060s/iter; left time: 1.9672s
	iters: 800, epoch: 8 | loss: 1.5822743
	speed: 0.0067s/iter; left time: 1.5328s
	iters: 900, epoch: 8 | loss: 0.6976714
	speed: 0.0070s/iter; left time: 0.8938s
	iters: 1000, epoch: 8 | loss: 0.3346997
	speed: 0.0066s/iter; left time: 0.1857s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.39464807510376
Epoch: 8, Steps: 1027 | Train Loss: 0.7466061 Vali Loss: 0.3699567 Best vali loss: 0.3650633

best validation loss 0.3650632879940138

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.005307590091, 'e_layers': 1, 'learning_rate': 0.0014772868529, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2620481
	speed: 0.0118s/iter; left time: 47.4846s
	iters: 200, epoch: 1 | loss: 0.4372146
	speed: 0.0032s/iter; left time: 12.3408s
	iters: 300, epoch: 1 | loss: 0.8384429
	speed: 0.0035s/iter; left time: 13.3634s
	iters: 400, epoch: 1 | loss: 0.5005948
	speed: 0.0038s/iter; left time: 14.1213s
	iters: 500, epoch: 1 | loss: 1.1221319
	speed: 0.0072s/iter; left time: 25.8375s
Updating learning rate to 0.001421060969971161
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 2.724987506866455
Epoch: 1, Steps: 514 | Train Loss: 0.8320865 Vali Loss: 0.3775403 Best vali loss: 0.3775403
	iters: 100, epoch: 2 | loss: 0.5683945
	speed: 0.0167s/iter; left time: 58.4918s
	iters: 200, epoch: 2 | loss: 0.7962262
	speed: 0.0055s/iter; left time: 18.8433s
	iters: 300, epoch: 2 | loss: 0.6754527
	speed: 0.0059s/iter; left time: 19.4797s
	iters: 400, epoch: 2 | loss: 0.4436839
	speed: 0.0065s/iter; left time: 20.6739s
	iters: 500, epoch: 2 | loss: 0.3726812
	speed: 0.0056s/iter; left time: 17.4777s
Updating learning rate to 0.0012609432021716618
Epoch: 2 cost time: 3.1401705741882324
Epoch: 2, Steps: 514 | Train Loss: 0.5712877 Vali Loss: 0.3824226 Best vali loss: 0.3775403
	iters: 100, epoch: 3 | loss: 0.5607052
	speed: 0.0095s/iter; left time: 28.4744s
	iters: 200, epoch: 3 | loss: 0.5987654
	speed: 0.0068s/iter; left time: 19.5403s
	iters: 300, epoch: 3 | loss: 0.4822633
	speed: 0.0065s/iter; left time: 18.0285s
	iters: 400, epoch: 3 | loss: 0.8977051
	speed: 0.0064s/iter; left time: 17.2548s
	iters: 500, epoch: 3 | loss: 0.3213155
	speed: 0.0064s/iter; left time: 16.4168s
Updating learning rate to 0.0010213100281777968
Epoch: 3 cost time: 3.153012275695801
Epoch: 3, Steps: 514 | Train Loss: 0.5721509 Vali Loss: 0.3953848 Best vali loss: 0.3775403
	iters: 100, epoch: 4 | loss: 0.5509996
	speed: 0.0166s/iter; left time: 40.9457s
	iters: 200, epoch: 4 | loss: 0.6796453
	speed: 0.0068s/iter; left time: 16.2034s
	iters: 300, epoch: 4 | loss: 0.2676940
	speed: 0.0048s/iter; left time: 10.8147s
	iters: 400, epoch: 4 | loss: 0.4400133
	speed: 0.0037s/iter; left time: 7.9300s
	iters: 500, epoch: 4 | loss: 0.4023184
	speed: 0.0039s/iter; left time: 8.0474s
Updating learning rate to 0.00073864342645
Epoch: 4 cost time: 2.659334421157837
Epoch: 4, Steps: 514 | Train Loss: 0.4681341 Vali Loss: 0.4167729 Best vali loss: 0.3775403
	iters: 100, epoch: 5 | loss: 0.3707468
	speed: 0.0155s/iter; left time: 30.2828s
	iters: 200, epoch: 5 | loss: 0.4692266
	speed: 0.0075s/iter; left time: 13.9236s
	iters: 300, epoch: 5 | loss: 0.2639461
	speed: 0.0067s/iter; left time: 11.8127s
	iters: 400, epoch: 5 | loss: 0.4144201
	speed: 0.0074s/iter; left time: 12.2225s
	iters: 500, epoch: 5 | loss: 0.3529748
	speed: 0.0068s/iter; left time: 10.5806s
Updating learning rate to 0.00045597682472220326
Epoch: 5 cost time: 3.7022056579589844
Epoch: 5, Steps: 514 | Train Loss: 0.3742629 Vali Loss: 0.4617388 Best vali loss: 0.3775403
	iters: 100, epoch: 6 | loss: 0.4319720
	speed: 0.0148s/iter; left time: 21.3932s
	iters: 200, epoch: 6 | loss: 0.4240784
	speed: 0.0074s/iter; left time: 9.9561s
	iters: 300, epoch: 6 | loss: 0.2321311
	speed: 0.0069s/iter; left time: 8.5203s
	iters: 400, epoch: 6 | loss: 0.6025209
	speed: 0.0073s/iter; left time: 8.3321s
	iters: 500, epoch: 6 | loss: 0.8247761
	speed: 0.0061s/iter; left time: 6.3394s
Updating learning rate to 0.00021634365072833818
Epoch: 6 cost time: 3.524280071258545
Epoch: 6, Steps: 514 | Train Loss: 0.5030957 Vali Loss: 0.4947426 Best vali loss: 0.3775403
	iters: 100, epoch: 7 | loss: 0.3784536
	speed: 0.0166s/iter; left time: 15.4050s
	iters: 200, epoch: 7 | loss: 0.4923494
	speed: 0.0061s/iter; left time: 5.0481s
	iters: 300, epoch: 7 | loss: 0.3599875
	speed: 0.0055s/iter; left time: 4.0290s
	iters: 400, epoch: 7 | loss: 0.6132035
	speed: 0.0067s/iter; left time: 4.2003s
	iters: 500, epoch: 7 | loss: 0.3658166
	speed: 0.0077s/iter; left time: 4.0859s
Updating learning rate to 5.622588292883899e-05
Epoch: 7 cost time: 3.470830202102661
Epoch: 7, Steps: 514 | Train Loss: 0.4419621 Vali Loss: 0.5005804 Best vali loss: 0.3775403
	iters: 100, epoch: 8 | loss: 0.2741326
	speed: 0.0153s/iter; left time: 6.3495s
	iters: 200, epoch: 8 | loss: 0.5804281
	speed: 0.0072s/iter; left time: 2.2734s
	iters: 300, epoch: 8 | loss: 0.6516683
	speed: 0.0074s/iter; left time: 1.5962s
	iters: 400, epoch: 8 | loss: 0.4246323
	speed: 0.0068s/iter; left time: 0.7853s
	iters: 500, epoch: 8 | loss: 0.2615447
	speed: 0.0067s/iter; left time: 0.1007s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5764217376708984
Epoch: 8, Steps: 514 | Train Loss: 0.4384812 Vali Loss: 0.5213901 Best vali loss: 0.3775403

best validation loss 0.3775402701673901

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.003762804933, 'e_layers': 1, 'learning_rate': 0.0003146953787, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003146953787
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 1.1014714241027832
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3665072 Best vali loss: 0.3665072
Updating learning rate to 0.00015734768935
Validation loss decreased (0.3665 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.6372964382171631
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3650117 Best vali loss: 0.3650117
Updating learning rate to 7.8673844675e-05
Epoch: 3 cost time: 0.6465556621551514
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3694583 Best vali loss: 0.3650117
Updating learning rate to 3.93369223375e-05
Epoch: 4 cost time: 0.756486177444458
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3689346 Best vali loss: 0.3650117
Updating learning rate to 1.966846116875e-05
Epoch: 5 cost time: 0.605396032333374
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3697602 Best vali loss: 0.3650117
Updating learning rate to 9.834230584375e-06
Epoch: 6 cost time: 1.131314992904663
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3708124 Best vali loss: 0.3650117
Updating learning rate to 4.9171152921875e-06
Epoch: 7 cost time: 1.1541175842285156
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3705812 Best vali loss: 0.3650117
Updating learning rate to 2.45855764609375e-06
Epoch: 8 cost time: 1.2804059982299805
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3709402 Best vali loss: 0.3650117

best validation loss 0.36501169859309096

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0032434751379, 'e_layers': 1, 'learning_rate': 0.0013849881566, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7341474
	speed: 0.0113s/iter; left time: 91.6801s
	iters: 200, epoch: 1 | loss: 0.3767565
	speed: 0.0068s/iter; left time: 54.8899s
	iters: 300, epoch: 1 | loss: 1.7875266
	speed: 0.0060s/iter; left time: 47.5883s
	iters: 400, epoch: 1 | loss: 0.4824634
	speed: 0.0085s/iter; left time: 66.2217s
	iters: 500, epoch: 1 | loss: 0.1752387
	speed: 0.0065s/iter; left time: 50.2809s
	iters: 600, epoch: 1 | loss: 0.4906003
	speed: 0.0086s/iter; left time: 65.6074s
	iters: 700, epoch: 1 | loss: 0.3584395
	speed: 0.0050s/iter; left time: 37.8016s
	iters: 800, epoch: 1 | loss: 0.3724777
	speed: 0.0043s/iter; left time: 31.5649s
	iters: 900, epoch: 1 | loss: 1.0954319
	speed: 0.0046s/iter; left time: 33.4591s
	iters: 1000, epoch: 1 | loss: 0.4066873
	speed: 0.0078s/iter; left time: 56.0726s
Updating learning rate to 0.0013322751836266384
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 6.849510431289673
Epoch: 1, Steps: 1027 | Train Loss: 0.6279770 Vali Loss: 0.3727332 Best vali loss: 0.3727332
	iters: 100, epoch: 2 | loss: 0.7942294
	speed: 0.0213s/iter; left time: 151.3578s
	iters: 200, epoch: 2 | loss: 0.7615660
	speed: 0.0077s/iter; left time: 53.5675s
	iters: 300, epoch: 2 | loss: 0.3785611
	speed: 0.0080s/iter; left time: 55.1906s
	iters: 400, epoch: 2 | loss: 0.3680275
	speed: 0.0057s/iter; left time: 38.8999s
	iters: 500, epoch: 2 | loss: 0.3997480
	speed: 0.0074s/iter; left time: 49.6111s
	iters: 600, epoch: 2 | loss: 0.4433662
	speed: 0.0081s/iter; left time: 53.2920s
	iters: 700, epoch: 2 | loss: 0.4183618
	speed: 0.0062s/iter; left time: 40.5071s
	iters: 800, epoch: 2 | loss: 1.4626371
	speed: 0.0041s/iter; left time: 26.3391s
	iters: 900, epoch: 2 | loss: 0.7551128
	speed: 0.0046s/iter; left time: 28.6695s
	iters: 1000, epoch: 2 | loss: 1.6014745
	speed: 0.0055s/iter; left time: 33.8286s
Updating learning rate to 0.001182161336997458
Validation loss decreased (0.3727 --> 0.3725).  Saving model state dict ...
Epoch: 2 cost time: 6.4662134647369385
Epoch: 2, Steps: 1027 | Train Loss: 0.7383084 Vali Loss: 0.3725489 Best vali loss: 0.3725489
	iters: 100, epoch: 3 | loss: 0.2969003
	speed: 0.0177s/iter; left time: 107.4362s
	iters: 200, epoch: 3 | loss: 0.3023810
	speed: 0.0049s/iter; left time: 29.4393s
	iters: 300, epoch: 3 | loss: 0.1969304
	speed: 0.0054s/iter; left time: 31.6708s
	iters: 400, epoch: 3 | loss: 0.6121461
	speed: 0.0050s/iter; left time: 28.6771s
	iters: 500, epoch: 3 | loss: 0.3779039
	speed: 0.0049s/iter; left time: 27.9970s
	iters: 600, epoch: 3 | loss: 0.3006926
	speed: 0.0041s/iter; left time: 22.5902s
	iters: 700, epoch: 3 | loss: 0.3615310
	speed: 0.0042s/iter; left time: 23.1145s
	iters: 800, epoch: 3 | loss: 0.4121610
	speed: 0.0056s/iter; left time: 30.0572s
	iters: 900, epoch: 3 | loss: 1.0204557
	speed: 0.0055s/iter; left time: 28.6870s
	iters: 1000, epoch: 3 | loss: 0.2317785
	speed: 0.0033s/iter; left time: 17.2066s
Updating learning rate to 0.0009575000890763433
Epoch: 3 cost time: 4.796494483947754
Epoch: 3, Steps: 1027 | Train Loss: 0.4112881 Vali Loss: 0.3726520 Best vali loss: 0.3725489

best validation loss 0.3725488626359722

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0112758696693, 'e_layers': 2, 'learning_rate': 0.0028457949504, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4787386
	speed: 0.0140s/iter; left time: 113.7370s
	iters: 200, epoch: 1 | loss: 0.5586622
	speed: 0.0078s/iter; left time: 62.1407s
	iters: 300, epoch: 1 | loss: 0.2181922
	speed: 0.0069s/iter; left time: 54.3048s
	iters: 400, epoch: 1 | loss: 0.2795400
	speed: 0.0073s/iter; left time: 56.9730s
	iters: 500, epoch: 1 | loss: 0.5450475
	speed: 0.0071s/iter; left time: 54.6219s
	iters: 600, epoch: 1 | loss: 0.4206264
	speed: 0.0073s/iter; left time: 55.3256s
	iters: 700, epoch: 1 | loss: 0.5347943
	speed: 0.0070s/iter; left time: 52.3617s
	iters: 800, epoch: 1 | loss: 0.5846800
	speed: 0.0071s/iter; left time: 52.5762s
	iters: 900, epoch: 1 | loss: 0.7910820
	speed: 0.0073s/iter; left time: 53.6245s
	iters: 1000, epoch: 1 | loss: 0.5772824
	speed: 0.0066s/iter; left time: 47.5231s
Updating learning rate to 0.0027374833293992663
Validation loss decreased (inf --> 0.3840).  Saving model state dict ...
Epoch: 1 cost time: 7.690685987472534
Epoch: 1, Steps: 1027 | Train Loss: 0.4988645 Vali Loss: 0.3839581 Best vali loss: 0.3839581
	iters: 100, epoch: 2 | loss: 0.3292384
	speed: 0.0233s/iter; left time: 165.3463s
	iters: 200, epoch: 2 | loss: 1.1529547
	speed: 0.0078s/iter; left time: 54.1823s
	iters: 300, epoch: 2 | loss: 0.5565479
	speed: 0.0078s/iter; left time: 53.6878s
	iters: 400, epoch: 2 | loss: 0.8461570
	speed: 0.0071s/iter; left time: 48.2083s
	iters: 500, epoch: 2 | loss: 0.4890077
	speed: 0.0068s/iter; left time: 45.3114s
	iters: 600, epoch: 2 | loss: 0.4577154
	speed: 0.0078s/iter; left time: 51.5514s
	iters: 700, epoch: 2 | loss: 0.4051929
	speed: 0.0082s/iter; left time: 52.9475s
	iters: 800, epoch: 2 | loss: 0.2608970
	speed: 0.0079s/iter; left time: 50.5194s
	iters: 900, epoch: 2 | loss: 0.2551807
	speed: 0.0075s/iter; left time: 46.8762s
	iters: 1000, epoch: 2 | loss: 0.5295849
	speed: 0.0077s/iter; left time: 47.8510s
Updating learning rate to 0.0024290379288471374
Validation loss decreased (0.3840 --> 0.3761).  Saving model state dict ...
Epoch: 2 cost time: 7.864372968673706
Epoch: 2, Steps: 1027 | Train Loss: 0.5282477 Vali Loss: 0.3761365 Best vali loss: 0.3761365
	iters: 100, epoch: 3 | loss: 0.6425725
	speed: 0.0229s/iter; left time: 138.5891s
	iters: 200, epoch: 3 | loss: 0.5703062
	speed: 0.0065s/iter; left time: 38.5980s
	iters: 300, epoch: 3 | loss: 0.2351431
	speed: 0.0075s/iter; left time: 43.9407s
	iters: 400, epoch: 3 | loss: 0.4083333
	speed: 0.0078s/iter; left time: 45.1518s
	iters: 500, epoch: 3 | loss: 1.4459661
	speed: 0.0078s/iter; left time: 44.0914s
	iters: 600, epoch: 3 | loss: 0.8775192
	speed: 0.0070s/iter; left time: 38.6701s
	iters: 700, epoch: 3 | loss: 0.3680287
	speed: 0.0064s/iter; left time: 35.1890s
	iters: 800, epoch: 3 | loss: 0.5452943
	speed: 0.0056s/iter; left time: 30.0324s
	iters: 900, epoch: 3 | loss: 0.1655025
	speed: 0.0057s/iter; left time: 29.7486s
	iters: 1000, epoch: 3 | loss: 0.8875349
	speed: 0.0055s/iter; left time: 28.3122s
Updating learning rate to 0.0019674167649131563
Epoch: 3 cost time: 6.861848831176758
Epoch: 3, Steps: 1027 | Train Loss: 0.6146201 Vali Loss: 0.3834275 Best vali loss: 0.3761365

best validation loss 0.3761364548930016

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0026755699187, 'e_layers': 3, 'learning_rate': 0.0002913656694, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8208236
	speed: 0.0152s/iter; left time: 60.9658s
	iters: 200, epoch: 1 | loss: 0.9404190
	speed: 0.0081s/iter; left time: 31.5672s
	iters: 300, epoch: 1 | loss: 0.3984994
	speed: 0.0090s/iter; left time: 34.4862s
	iters: 400, epoch: 1 | loss: 0.3874625
	speed: 0.0092s/iter; left time: 34.3356s
	iters: 500, epoch: 1 | loss: 0.4182009
	speed: 0.0091s/iter; left time: 32.8423s
Updating learning rate to 0.00028027622391755506
Validation loss decreased (inf --> 0.3772).  Saving model state dict ...
Epoch: 1 cost time: 4.913408279418945
Epoch: 1, Steps: 514 | Train Loss: 0.5930811 Vali Loss: 0.3771724 Best vali loss: 0.3771724
	iters: 100, epoch: 2 | loss: 0.2648729
	speed: 0.0179s/iter; left time: 62.6243s
	iters: 200, epoch: 2 | loss: 0.7618757
	speed: 0.0078s/iter; left time: 26.3944s
	iters: 300, epoch: 2 | loss: 0.8609002
	speed: 0.0058s/iter; left time: 19.2381s
	iters: 400, epoch: 2 | loss: 0.3093911
	speed: 0.0084s/iter; left time: 26.8888s
	iters: 500, epoch: 2 | loss: 1.2456708
	speed: 0.0089s/iter; left time: 27.4804s
Updating learning rate to 0.00024869615501884885
Validation loss decreased (0.3772 --> 0.3693).  Saving model state dict ...
Epoch: 2 cost time: 4.14275860786438
Epoch: 2, Steps: 514 | Train Loss: 0.6885421 Vali Loss: 0.3693111 Best vali loss: 0.3693111
	iters: 100, epoch: 3 | loss: 0.4173364
	speed: 0.0156s/iter; left time: 46.5644s
	iters: 200, epoch: 3 | loss: 0.3931606
	speed: 0.0056s/iter; left time: 16.0177s
	iters: 300, epoch: 3 | loss: 0.5309377
	speed: 0.0088s/iter; left time: 24.5615s
	iters: 400, epoch: 3 | loss: 0.6046671
	speed: 0.0090s/iter; left time: 24.0635s
	iters: 500, epoch: 3 | loss: 0.9480782
	speed: 0.0081s/iter; left time: 20.9680s
Updating learning rate to 0.000201433241919672
Validation loss decreased (0.3693 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 3.825098752975464
Epoch: 3, Steps: 514 | Train Loss: 0.5788360 Vali Loss: 0.3683592 Best vali loss: 0.3683592

best validation loss 0.3683591998747618

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0026755699187, 'e_layers': 3, 'learning_rate': 0.0002913656694, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7018602
	speed: 0.0163s/iter; left time: 40.3992s
	iters: 200, epoch: 4 | loss: 0.6489367
	speed: 0.0087s/iter; left time: 20.7098s
	iters: 300, epoch: 4 | loss: 0.3775075
	speed: 0.0088s/iter; left time: 19.8796s
	iters: 400, epoch: 4 | loss: 0.3522805
	speed: 0.0076s/iter; left time: 16.4692s
	iters: 500, epoch: 4 | loss: 0.3977629
	speed: 0.0061s/iter; left time: 12.5660s
Updating learning rate to 0.0001456828347
Epoch: 4 cost time: 4.434019088745117
Epoch: 4, Steps: 514 | Train Loss: 0.4956696 Vali Loss: 0.3696750 Best vali loss: 0.3683592
	iters: 100, epoch: 5 | loss: 0.2597354
	speed: 0.0171s/iter; left time: 33.4547s
	iters: 200, epoch: 5 | loss: 0.6785164
	speed: 0.0081s/iter; left time: 15.0049s
	iters: 300, epoch: 5 | loss: 0.8406181
	speed: 0.0080s/iter; left time: 14.0665s
	iters: 400, epoch: 5 | loss: 0.2986631
	speed: 0.0081s/iter; left time: 13.4900s
	iters: 500, epoch: 5 | loss: 0.9460768
	speed: 0.0087s/iter; left time: 13.5823s
Updating learning rate to 8.9932427480328e-05
Epoch: 5 cost time: 4.276352882385254
Epoch: 5, Steps: 514 | Train Loss: 0.6047220 Vali Loss: 0.3710038 Best vali loss: 0.3683592
	iters: 100, epoch: 6 | loss: 0.4136209
	speed: 0.0171s/iter; left time: 24.7464s
	iters: 200, epoch: 6 | loss: 0.3796919
	speed: 0.0080s/iter; left time: 10.7096s
	iters: 300, epoch: 6 | loss: 0.4844202
	speed: 0.0079s/iter; left time: 9.8432s
	iters: 400, epoch: 6 | loss: 0.6019967
	speed: 0.0080s/iter; left time: 9.1651s
	iters: 500, epoch: 6 | loss: 0.8927131
	speed: 0.0092s/iter; left time: 9.5737s
Updating learning rate to 4.266951438115113e-05
Epoch: 6 cost time: 4.275261163711548
Epoch: 6, Steps: 514 | Train Loss: 0.5544885 Vali Loss: 0.3707783 Best vali loss: 0.3683592
	iters: 100, epoch: 7 | loss: 0.4521210
	speed: 0.0205s/iter; left time: 19.0348s
	iters: 200, epoch: 7 | loss: 0.6105834
	speed: 0.0100s/iter; left time: 8.2984s
	iters: 300, epoch: 7 | loss: 0.4770101
	speed: 0.0100s/iter; left time: 7.3025s
	iters: 400, epoch: 7 | loss: 0.3999393
	speed: 0.0117s/iter; left time: 7.3699s
	iters: 500, epoch: 7 | loss: 0.4005738
	speed: 0.0122s/iter; left time: 6.4731s
Updating learning rate to 1.1089445482444938e-05
Epoch: 7 cost time: 5.61212682723999
Epoch: 7, Steps: 514 | Train Loss: 0.4680455 Vali Loss: 0.3733971 Best vali loss: 0.3683592
	iters: 100, epoch: 8 | loss: 0.7848263
	speed: 0.0296s/iter; left time: 12.2978s
	iters: 200, epoch: 8 | loss: 0.4410780
	speed: 0.0101s/iter; left time: 3.1918s
	iters: 300, epoch: 8 | loss: 0.3731977
	speed: 0.0110s/iter; left time: 2.3590s
	iters: 400, epoch: 8 | loss: 0.7789800
	speed: 0.0121s/iter; left time: 1.3970s
	iters: 500, epoch: 8 | loss: 0.8843493
	speed: 0.0094s/iter; left time: 0.1407s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.544318437576294
Epoch: 8, Steps: 514 | Train Loss: 0.6524863 Vali Loss: 0.3727647 Best vali loss: 0.3683592

best validation loss 0.3683591998747618

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012374140538, 'e_layers': 2, 'learning_rate': 0.0005328478516, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5398196
	speed: 0.0240s/iter; left time: 22.3703s
Updating learning rate to 0.0005328478516
Validation loss decreased (inf --> 0.3805).  Saving model state dict ...
Epoch: 1 cost time: 2.537705421447754
Epoch: 1, Steps: 129 | Train Loss: 0.5398196 Vali Loss: 0.3804974 Best vali loss: 0.3804974
	iters: 100, epoch: 2 | loss: 0.7298386
	speed: 0.0277s/iter; left time: 22.2835s
Updating learning rate to 0.0002664239258
Validation loss decreased (0.3805 --> 0.3684).  Saving model state dict ...
Epoch: 2 cost time: 2.205230951309204
Epoch: 2, Steps: 129 | Train Loss: 0.7298386 Vali Loss: 0.3683501 Best vali loss: 0.3683501
	iters: 100, epoch: 3 | loss: 0.6932052
	speed: 0.0299s/iter; left time: 20.1567s
Updating learning rate to 0.0001332119629
Epoch: 3 cost time: 2.162165403366089
Epoch: 3, Steps: 129 | Train Loss: 0.6932052 Vali Loss: 0.3705934 Best vali loss: 0.3683501
	iters: 100, epoch: 4 | loss: 0.3891185
	speed: 0.0260s/iter; left time: 14.1846s
Updating learning rate to 6.660598145e-05
Epoch: 4 cost time: 1.8567001819610596
Epoch: 4, Steps: 129 | Train Loss: 0.3891185 Vali Loss: 0.3690355 Best vali loss: 0.3683501
	iters: 100, epoch: 5 | loss: 0.5449201
	speed: 0.0247s/iter; left time: 10.2958s
Updating learning rate to 3.3302990725e-05
Epoch: 5 cost time: 2.3415560722351074
Epoch: 5, Steps: 129 | Train Loss: 0.5449201 Vali Loss: 0.3683508 Best vali loss: 0.3683501
	iters: 100, epoch: 6 | loss: 0.5354182
	speed: 0.0289s/iter; left time: 8.3185s
Updating learning rate to 1.66514953625e-05
Epoch: 6 cost time: 2.2752130031585693
Epoch: 6, Steps: 129 | Train Loss: 0.5354182 Vali Loss: 0.3684418 Best vali loss: 0.3683501
	iters: 100, epoch: 7 | loss: 0.5385605
	speed: 0.0240s/iter; left time: 3.8140s
Updating learning rate to 8.32574768125e-06
Epoch: 7 cost time: 1.5733296871185303
Epoch: 7, Steps: 129 | Train Loss: 0.5385605 Vali Loss: 0.3684723 Best vali loss: 0.3683501
	iters: 100, epoch: 8 | loss: 0.6895329
	speed: 0.0234s/iter; left time: 0.7012s
Updating learning rate to 4.162873840625e-06
Epoch: 8 cost time: 2.1170599460601807
Epoch: 8, Steps: 129 | Train Loss: 0.6895329 Vali Loss: 0.3683534 Best vali loss: 0.3683501

best validation loss 0.36835005872376075

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0015252855344, 'e_layers': 1, 'learning_rate': 0.0001006740407, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8100693
	speed: 0.0111s/iter; left time: 90.5008s
	iters: 200, epoch: 1 | loss: 1.1675746
	speed: 0.0052s/iter; left time: 41.6237s
	iters: 300, epoch: 1 | loss: 2.1747313
	speed: 0.0057s/iter; left time: 44.8898s
	iters: 400, epoch: 1 | loss: 1.7670330
	speed: 0.0051s/iter; left time: 39.6669s
	iters: 500, epoch: 1 | loss: 1.1946201
	speed: 0.0048s/iter; left time: 36.6910s
	iters: 600, epoch: 1 | loss: 0.5077065
	speed: 0.0055s/iter; left time: 41.8935s
	iters: 700, epoch: 1 | loss: 0.9226683
	speed: 0.0045s/iter; left time: 33.8472s
	iters: 800, epoch: 1 | loss: 0.2394363
	speed: 0.0036s/iter; left time: 26.7237s
	iters: 900, epoch: 1 | loss: 0.4130849
	speed: 0.0044s/iter; left time: 32.4126s
	iters: 1000, epoch: 1 | loss: 0.9268977
	speed: 0.0047s/iter; left time: 33.5606s
Updating learning rate to 9.684236317896914e-05
Validation loss decreased (inf --> 0.3783).  Saving model state dict ...
Epoch: 1 cost time: 5.2752392292022705
Epoch: 1, Steps: 1027 | Train Loss: 1.0123822 Vali Loss: 0.3783428 Best vali loss: 0.3783428
	iters: 100, epoch: 2 | loss: 1.2415024
	speed: 0.0176s/iter; left time: 124.8167s
	iters: 200, epoch: 2 | loss: 0.3779536
	speed: 0.0047s/iter; left time: 32.7736s
	iters: 300, epoch: 2 | loss: 1.1002711
	speed: 0.0048s/iter; left time: 33.1686s
	iters: 400, epoch: 2 | loss: 1.3702869
	speed: 0.0044s/iter; left time: 29.9668s
	iters: 500, epoch: 2 | loss: 0.2957048
	speed: 0.0044s/iter; left time: 29.4997s
	iters: 600, epoch: 2 | loss: 0.4661661
	speed: 0.0045s/iter; left time: 29.8544s
	iters: 700, epoch: 2 | loss: 0.4836729
	speed: 0.0048s/iter; left time: 31.1288s
	iters: 800, epoch: 2 | loss: 0.2278215
	speed: 0.0047s/iter; left time: 30.1636s
	iters: 900, epoch: 2 | loss: 0.3898165
	speed: 0.0047s/iter; left time: 29.6282s
	iters: 1000, epoch: 2 | loss: 0.3203451
	speed: 0.0047s/iter; left time: 28.8912s
Updating learning rate to 8.593066878421023e-05
Validation loss decreased (0.3783 --> 0.3654).  Saving model state dict ...
Epoch: 2 cost time: 4.832639455795288
Epoch: 2, Steps: 1027 | Train Loss: 0.6273541 Vali Loss: 0.3653991 Best vali loss: 0.3653991
	iters: 100, epoch: 3 | loss: 0.2741269
	speed: 0.0143s/iter; left time: 86.4894s
	iters: 200, epoch: 3 | loss: 0.8861541
	speed: 0.0041s/iter; left time: 24.1746s
	iters: 300, epoch: 3 | loss: 0.3988737
	speed: 0.0047s/iter; left time: 27.5198s
	iters: 400, epoch: 3 | loss: 0.3616973
	speed: 0.0067s/iter; left time: 38.7604s
	iters: 500, epoch: 3 | loss: 1.4593437
	speed: 0.0064s/iter; left time: 36.1772s
	iters: 600, epoch: 3 | loss: 0.3342845
	speed: 0.0062s/iter; left time: 34.2165s
	iters: 700, epoch: 3 | loss: 0.3601831
	speed: 0.0064s/iter; left time: 35.2238s
	iters: 800, epoch: 3 | loss: 0.4752794
	speed: 0.0062s/iter; left time: 33.4074s
	iters: 900, epoch: 3 | loss: 1.0714842
	speed: 0.0061s/iter; left time: 32.3356s
	iters: 1000, epoch: 3 | loss: 0.5048458
	speed: 0.0061s/iter; left time: 31.7300s
Updating learning rate to 6.960016407256937e-05
Validation loss decreased (0.3654 --> 0.3641).  Saving model state dict ...
Epoch: 3 cost time: 5.8595733642578125
Epoch: 3, Steps: 1027 | Train Loss: 0.6126273 Vali Loss: 0.3640624 Best vali loss: 0.3640624
	iters: 100, epoch: 4 | loss: 0.3475627
	speed: 0.0240s/iter; left time: 121.0138s
	iters: 200, epoch: 4 | loss: 0.9053844
	speed: 0.0054s/iter; left time: 26.4231s
	iters: 300, epoch: 4 | loss: 0.4274121
	speed: 0.0062s/iter; left time: 30.1043s
	iters: 400, epoch: 4 | loss: 0.5137246
	speed: 0.0062s/iter; left time: 29.3243s
	iters: 500, epoch: 4 | loss: 0.4665396
	speed: 0.0062s/iter; left time: 28.7174s
	iters: 600, epoch: 4 | loss: 0.3232142
	speed: 0.0067s/iter; left time: 30.1880s
	iters: 700, epoch: 4 | loss: 0.3613185
	speed: 0.0063s/iter; left time: 27.8021s
	iters: 800, epoch: 4 | loss: 1.2787037
	speed: 0.0062s/iter; left time: 26.8926s
	iters: 900, epoch: 4 | loss: 0.3379585
	speed: 0.0063s/iter; left time: 26.5893s
	iters: 1000, epoch: 4 | loss: 0.5591010
	speed: 0.0063s/iter; left time: 25.9860s
Updating learning rate to 5.033702035e-05
Epoch: 4 cost time: 6.308011770248413
Epoch: 4, Steps: 1027 | Train Loss: 0.5520919 Vali Loss: 0.3670872 Best vali loss: 0.3640624
	iters: 100, epoch: 5 | loss: 0.3683460
	speed: 0.0212s/iter; left time: 85.0809s
	iters: 200, epoch: 5 | loss: 0.5555986
	speed: 0.0062s/iter; left time: 24.2104s
	iters: 300, epoch: 5 | loss: 0.2158708
	speed: 0.0062s/iter; left time: 23.6205s
	iters: 400, epoch: 5 | loss: 0.6531265
	speed: 0.0063s/iter; left time: 23.4021s
	iters: 500, epoch: 5 | loss: 0.6552140
	speed: 0.0062s/iter; left time: 22.5018s
	iters: 600, epoch: 5 | loss: 0.5472332
	speed: 0.0065s/iter; left time: 22.7899s
	iters: 700, epoch: 5 | loss: 0.9977372
	speed: 0.0062s/iter; left time: 21.2330s
	iters: 800, epoch: 5 | loss: 0.5136304
	speed: 0.0064s/iter; left time: 21.2439s
	iters: 900, epoch: 5 | loss: 0.5068910
	speed: 0.0062s/iter; left time: 20.0328s
	iters: 1000, epoch: 5 | loss: 0.4302337
	speed: 0.0062s/iter; left time: 19.3667s
Updating learning rate to 3.107387662743063e-05
Epoch: 5 cost time: 6.430432319641113
Epoch: 5, Steps: 1027 | Train Loss: 0.5443881 Vali Loss: 0.3656298 Best vali loss: 0.3640624
	iters: 100, epoch: 6 | loss: 0.3356152
	speed: 0.0229s/iter; left time: 68.1836s
	iters: 200, epoch: 6 | loss: 0.7880278
	speed: 0.0062s/iter; left time: 17.8599s
	iters: 300, epoch: 6 | loss: 0.4404483
	speed: 0.0062s/iter; left time: 17.2011s
	iters: 400, epoch: 6 | loss: 0.5110532
	speed: 0.0061s/iter; left time: 16.4379s
	iters: 500, epoch: 6 | loss: 0.4862010
	speed: 0.0067s/iter; left time: 17.3502s
	iters: 600, epoch: 6 | loss: 0.8254956
	speed: 0.0062s/iter; left time: 15.3032s
	iters: 700, epoch: 6 | loss: 1.1137191
	speed: 0.0062s/iter; left time: 14.7099s
	iters: 800, epoch: 6 | loss: 0.3964125
	speed: 0.0061s/iter; left time: 13.9861s
	iters: 900, epoch: 6 | loss: 0.5060030
	speed: 0.0068s/iter; left time: 14.9247s
	iters: 1000, epoch: 6 | loss: 0.8811752
	speed: 0.0069s/iter; left time: 14.3884s
Updating learning rate to 1.4743371915789763e-05
Epoch: 6 cost time: 6.547105073928833
Epoch: 6, Steps: 1027 | Train Loss: 0.6284151 Vali Loss: 0.3645831 Best vali loss: 0.3640624
	iters: 100, epoch: 7 | loss: 0.5446100
	speed: 0.0216s/iter; left time: 42.2825s
	iters: 200, epoch: 7 | loss: 1.2805678
	speed: 0.0063s/iter; left time: 11.6059s
	iters: 300, epoch: 7 | loss: 1.0685096
	speed: 0.0064s/iter; left time: 11.1579s
	iters: 400, epoch: 7 | loss: 0.7008645
	speed: 0.0063s/iter; left time: 10.5086s
	iters: 500, epoch: 7 | loss: 0.1881987
	speed: 0.0063s/iter; left time: 9.8021s
	iters: 600, epoch: 7 | loss: 0.3757545
	speed: 0.0063s/iter; left time: 9.2309s
	iters: 700, epoch: 7 | loss: 0.2894269
	speed: 0.0064s/iter; left time: 8.6924s
	iters: 800, epoch: 7 | loss: 0.4086280
	speed: 0.0063s/iter; left time: 7.9091s
	iters: 900, epoch: 7 | loss: 0.4095610
	speed: 0.0062s/iter; left time: 7.2093s
	iters: 1000, epoch: 7 | loss: 0.3586625
	speed: 0.0054s/iter; left time: 5.7306s
Updating learning rate to 3.831677521030873e-06
Epoch: 7 cost time: 6.427604913711548
Epoch: 7, Steps: 1027 | Train Loss: 0.5624784 Vali Loss: 0.3650103 Best vali loss: 0.3640624
	iters: 100, epoch: 8 | loss: 0.4110489
	speed: 0.0238s/iter; left time: 22.1113s
	iters: 200, epoch: 8 | loss: 0.2533528
	speed: 0.0062s/iter; left time: 5.1485s
	iters: 300, epoch: 8 | loss: 0.5476483
	speed: 0.0060s/iter; left time: 4.3485s
	iters: 400, epoch: 8 | loss: 0.3333710
	speed: 0.0056s/iter; left time: 3.5345s
	iters: 500, epoch: 8 | loss: 0.3713835
	speed: 0.0055s/iter; left time: 2.8975s
	iters: 600, epoch: 8 | loss: 0.3921688
	speed: 0.0055s/iter; left time: 2.3589s
	iters: 700, epoch: 8 | loss: 0.1652864
	speed: 0.0063s/iter; left time: 2.0819s
	iters: 800, epoch: 8 | loss: 0.3278580
	speed: 0.0063s/iter; left time: 1.4459s
	iters: 900, epoch: 8 | loss: 0.7498315
	speed: 0.0059s/iter; left time: 0.7604s
	iters: 1000, epoch: 8 | loss: 0.3725506
	speed: 0.0055s/iter; left time: 0.1537s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.119666576385498
Epoch: 8, Steps: 1027 | Train Loss: 0.3924500 Vali Loss: 0.3650005 Best vali loss: 0.3640624

best validation loss 0.36406244368590635

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023549867609129905
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 1.098252534866333
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3694511 Best vali loss: 0.3694511
Updating learning rate to 0.00020896390866591454
Validation loss decreased (0.3695 --> 0.3674).  Saving model state dict ...
Epoch: 2 cost time: 0.8235657215118408
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3674265 Best vali loss: 0.3674265
Updating learning rate to 0.00016925182282609557
Epoch: 3 cost time: 0.7810084819793701
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3693319 Best vali loss: 0.3674265

best validation loss 0.36742645916629635

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.003902434905, 'e_layers': 2, 'learning_rate': 0.0003142995314, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003142995314
Validation loss decreased (inf --> 0.4106).  Saving model state dict ...
Epoch: 1 cost time: 0.8544962406158447
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4106305 Best vali loss: 0.4106305
Updating learning rate to 0.0001571497657
Validation loss decreased (0.4106 --> 0.3909).  Saving model state dict ...
Epoch: 2 cost time: 0.46491050720214844
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3909058 Best vali loss: 0.3909058
Updating learning rate to 7.857488285e-05
Validation loss decreased (0.3909 --> 0.3852).  Saving model state dict ...
Epoch: 3 cost time: 0.7725741863250732
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3852464 Best vali loss: 0.3852464

best validation loss 0.38524637820678514

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0096207564637, 'e_layers': 3, 'learning_rate': 0.0006050851787, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6310756
	speed: 0.0234s/iter; left time: 21.8694s
Updating learning rate to 0.0005820554953634322
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 2.519942283630371
Epoch: 1, Steps: 129 | Train Loss: 0.6310756 Vali Loss: 0.3663697 Best vali loss: 0.3663697
	iters: 100, epoch: 2 | loss: 0.6533059
	speed: 0.0178s/iter; left time: 14.3146s
Updating learning rate to 0.0005164725058771219
Epoch: 2 cost time: 1.2371423244476318
Epoch: 2, Steps: 129 | Train Loss: 0.6533059 Vali Loss: 0.3678502 Best vali loss: 0.3663697
	iters: 100, epoch: 3 | loss: 0.7539517
	speed: 0.0180s/iter; left time: 12.1167s
Updating learning rate to 0.00041832062587907987
Epoch: 3 cost time: 1.538165807723999
Epoch: 3, Steps: 129 | Train Loss: 0.7539517 Vali Loss: 0.3711159 Best vali loss: 0.3663697

best validation loss 0.3663697385249297

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0096207564637, 'e_layers': 3, 'learning_rate': 0.0006050851787, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5705674
	speed: 0.0131s/iter; left time: 7.1523s
Updating learning rate to 0.00030254258935
Epoch: 4 cost time: 1.1356873512268066
Epoch: 4, Steps: 129 | Train Loss: 0.5705674 Vali Loss: 0.3728594 Best vali loss: 0.3663697
	iters: 100, epoch: 5 | loss: 0.5114421
	speed: 0.0143s/iter; left time: 5.9618s
Updating learning rate to 0.00018676455282092016
Epoch: 5 cost time: 1.372957468032837
Epoch: 5, Steps: 129 | Train Loss: 0.5114421 Vali Loss: 0.3828022 Best vali loss: 0.3663697
	iters: 100, epoch: 6 | loss: 0.7477872
	speed: 0.0180s/iter; left time: 5.1747s
Updating learning rate to 8.861267282287807e-05
Epoch: 6 cost time: 1.3847970962524414
Epoch: 6, Steps: 129 | Train Loss: 0.7477872 Vali Loss: 0.3767300 Best vali loss: 0.3663697
	iters: 100, epoch: 7 | loss: 0.5411639
	speed: 0.0145s/iter; left time: 2.2985s
Updating learning rate to 2.30296833365678e-05
Epoch: 7 cost time: 1.3253817558288574
Epoch: 7, Steps: 129 | Train Loss: 0.5411639 Vali Loss: 0.3816810 Best vali loss: 0.3663697
	iters: 100, epoch: 8 | loss: 0.3514682
	speed: 0.0180s/iter; left time: 0.5403s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5018398761749268
Epoch: 8, Steps: 129 | Train Loss: 0.3514682 Vali Loss: 0.3755367 Best vali loss: 0.3663697

best validation loss 0.3663697385249297

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0084606518785, 'e_layers': 3, 'learning_rate': 0.0001316855185, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4715744
	speed: 0.0186s/iter; left time: 36.4185s
	iters: 200, epoch: 1 | loss: 0.5828241
	speed: 0.0083s/iter; left time: 15.4233s
Updating learning rate to 0.0001316855185
Validation loss decreased (inf --> 0.3613).  Saving model state dict ...
Epoch: 1 cost time: 2.7198870182037354
Epoch: 1, Steps: 257 | Train Loss: 0.5271992 Vali Loss: 0.3612755 Best vali loss: 0.3612755
	iters: 100, epoch: 2 | loss: 0.6792680
	speed: 0.0132s/iter; left time: 22.3964s
	iters: 200, epoch: 2 | loss: 0.6884158
	speed: 0.0095s/iter; left time: 15.2246s
Updating learning rate to 6.584275925e-05
Epoch: 2 cost time: 2.322117805480957
Epoch: 2, Steps: 257 | Train Loss: 0.6838419 Vali Loss: 0.3631364 Best vali loss: 0.3612755
	iters: 100, epoch: 3 | loss: 0.6361123
	speed: 0.0237s/iter; left time: 34.2019s
	iters: 200, epoch: 3 | loss: 0.2877242
	speed: 0.0115s/iter; left time: 15.3817s
Updating learning rate to 3.2921379625e-05
Validation loss decreased (0.3613 --> 0.3611).  Saving model state dict ...
Epoch: 3 cost time: 3.0092859268188477
Epoch: 3, Steps: 257 | Train Loss: 0.4619182 Vali Loss: 0.3611310 Best vali loss: 0.3611310
	iters: 100, epoch: 4 | loss: 0.8954526
	speed: 0.0234s/iter; left time: 27.7682s
	iters: 200, epoch: 4 | loss: 0.5807451
	speed: 0.0105s/iter; left time: 11.3776s
Updating learning rate to 1.64606898125e-05
Epoch: 4 cost time: 2.6727092266082764
Epoch: 4, Steps: 257 | Train Loss: 0.7380988 Vali Loss: 0.3802053 Best vali loss: 0.3611310
	iters: 100, epoch: 5 | loss: 0.6325618
	speed: 0.0208s/iter; left time: 19.3249s
	iters: 200, epoch: 5 | loss: 0.5642424
	speed: 0.0122s/iter; left time: 10.0811s
Updating learning rate to 8.23034490625e-06
Epoch: 5 cost time: 3.063096761703491
Epoch: 5, Steps: 257 | Train Loss: 0.5984021 Vali Loss: 0.3703367 Best vali loss: 0.3611310
	iters: 100, epoch: 6 | loss: 0.6507297
	speed: 0.0247s/iter; left time: 16.5715s
	iters: 200, epoch: 6 | loss: 0.6166678
	speed: 0.0112s/iter; left time: 6.3843s
Updating learning rate to 4.115172453125e-06
Epoch: 6 cost time: 2.9896316528320312
Epoch: 6, Steps: 257 | Train Loss: 0.6336987 Vali Loss: 0.3615883 Best vali loss: 0.3611310
	iters: 100, epoch: 7 | loss: 0.3890762
	speed: 0.0252s/iter; left time: 10.4521s
	iters: 200, epoch: 7 | loss: 0.4359450
	speed: 0.0109s/iter; left time: 3.4442s
Updating learning rate to 2.0575862265625e-06
Epoch: 7 cost time: 2.9655954837799072
Epoch: 7, Steps: 257 | Train Loss: 0.4125106 Vali Loss: 0.3765812 Best vali loss: 0.3611310
	iters: 100, epoch: 8 | loss: 0.5952541
	speed: 0.0306s/iter; left time: 4.8378s
	iters: 200, epoch: 8 | loss: 0.3222390
	speed: 0.0132s/iter; left time: 0.7653s
Updating learning rate to 1.02879311328125e-06
Epoch: 8 cost time: 3.634624719619751
Epoch: 8, Steps: 257 | Train Loss: 0.4587465 Vali Loss: 0.3709239 Best vali loss: 0.3611310

best validation loss 0.3611310033643644

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.001090227289, 'e_layers': 1, 'learning_rate': 7.24352627e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9738774
	speed: 0.0117s/iter; left time: 94.5645s
	iters: 200, epoch: 1 | loss: 1.0787650
	speed: 0.0052s/iter; left time: 41.8174s
	iters: 300, epoch: 1 | loss: 0.4270657
	speed: 0.0051s/iter; left time: 40.6472s
	iters: 400, epoch: 1 | loss: 0.2601382
	speed: 0.0049s/iter; left time: 38.2544s
	iters: 500, epoch: 1 | loss: 0.8946739
	speed: 0.0050s/iter; left time: 38.8787s
	iters: 600, epoch: 1 | loss: 0.5281731
	speed: 0.0052s/iter; left time: 39.8328s
	iters: 700, epoch: 1 | loss: 0.5966717
	speed: 0.0054s/iter; left time: 40.2572s
	iters: 800, epoch: 1 | loss: 0.2394824
	speed: 0.0054s/iter; left time: 39.8112s
	iters: 900, epoch: 1 | loss: 0.3065169
	speed: 0.0051s/iter; left time: 36.9751s
	iters: 1000, epoch: 1 | loss: 0.3320208
	speed: 0.0047s/iter; left time: 34.0715s
Updating learning rate to 7.24352627e-05
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 5.591184616088867
Epoch: 1, Steps: 1027 | Train Loss: 0.5637385 Vali Loss: 0.3653261 Best vali loss: 0.3653261
	iters: 100, epoch: 2 | loss: 0.5715418
	speed: 0.0207s/iter; left time: 146.4533s
	iters: 200, epoch: 2 | loss: 0.4657881
	speed: 0.0051s/iter; left time: 35.4145s
	iters: 300, epoch: 2 | loss: 1.3919944
	speed: 0.0051s/iter; left time: 34.9298s
	iters: 400, epoch: 2 | loss: 1.5005113
	speed: 0.0052s/iter; left time: 35.4490s
	iters: 500, epoch: 2 | loss: 1.0271722
	speed: 0.0051s/iter; left time: 34.2605s
	iters: 600, epoch: 2 | loss: 0.8202044
	speed: 0.0049s/iter; left time: 32.1921s
	iters: 700, epoch: 2 | loss: 0.2875695
	speed: 0.0045s/iter; left time: 29.1681s
	iters: 800, epoch: 2 | loss: 0.6458499
	speed: 0.0044s/iter; left time: 27.8889s
	iters: 900, epoch: 2 | loss: 0.2983826
	speed: 0.0048s/iter; left time: 30.4841s
	iters: 1000, epoch: 2 | loss: 1.1434610
	speed: 0.0052s/iter; left time: 32.1577s
Updating learning rate to 3.621763135e-05
Epoch: 2 cost time: 5.157259702682495
Epoch: 2, Steps: 1027 | Train Loss: 0.8152475 Vali Loss: 0.3701237 Best vali loss: 0.3653261
	iters: 100, epoch: 3 | loss: 1.4678495
	speed: 0.0194s/iter; left time: 117.6239s
	iters: 200, epoch: 3 | loss: 0.3493305
	speed: 0.0046s/iter; left time: 27.2354s
	iters: 300, epoch: 3 | loss: 0.9276517
	speed: 0.0052s/iter; left time: 30.7754s
	iters: 400, epoch: 3 | loss: 0.6230231
	speed: 0.0052s/iter; left time: 29.9772s
	iters: 500, epoch: 3 | loss: 0.5099973
	speed: 0.0047s/iter; left time: 26.7621s
	iters: 600, epoch: 3 | loss: 0.4523638
	speed: 0.0048s/iter; left time: 26.8848s
	iters: 700, epoch: 3 | loss: 0.9589659
	speed: 0.0052s/iter; left time: 28.2582s
	iters: 800, epoch: 3 | loss: 0.2458633
	speed: 0.0052s/iter; left time: 28.0239s
	iters: 900, epoch: 3 | loss: 0.2652057
	speed: 0.0052s/iter; left time: 27.1275s
	iters: 1000, epoch: 3 | loss: 0.3223924
	speed: 0.0052s/iter; left time: 26.9999s
Updating learning rate to 1.8108815675e-05
Epoch: 3 cost time: 5.190293550491333
Epoch: 3, Steps: 1027 | Train Loss: 0.6122643 Vali Loss: 0.3742228 Best vali loss: 0.3653261
	iters: 100, epoch: 4 | loss: 0.3652193
	speed: 0.0201s/iter; left time: 101.3130s
	iters: 200, epoch: 4 | loss: 0.5651573
	speed: 0.0049s/iter; left time: 24.3597s
	iters: 300, epoch: 4 | loss: 0.7766745
	speed: 0.0045s/iter; left time: 21.6950s
	iters: 400, epoch: 4 | loss: 0.3708093
	speed: 0.0045s/iter; left time: 21.2622s
	iters: 500, epoch: 4 | loss: 0.7066668
	speed: 0.0050s/iter; left time: 23.3414s
	iters: 600, epoch: 4 | loss: 0.7183855
	speed: 0.0051s/iter; left time: 22.9597s
	iters: 700, epoch: 4 | loss: 0.5751302
	speed: 0.0053s/iter; left time: 23.6290s
	iters: 800, epoch: 4 | loss: 0.4514172
	speed: 0.0054s/iter; left time: 23.2307s
	iters: 900, epoch: 4 | loss: 0.4590276
	speed: 0.0051s/iter; left time: 21.5422s
	iters: 1000, epoch: 4 | loss: 0.4882430
	speed: 0.0050s/iter; left time: 20.6625s
Updating learning rate to 9.0544078375e-06
Epoch: 4 cost time: 5.193156003952026
Epoch: 4, Steps: 1027 | Train Loss: 0.5476731 Vali Loss: 0.3765141 Best vali loss: 0.3653261
	iters: 100, epoch: 5 | loss: 0.9479358
	speed: 0.0197s/iter; left time: 79.0576s
	iters: 200, epoch: 5 | loss: 0.4541744
	speed: 0.0046s/iter; left time: 18.1525s
	iters: 300, epoch: 5 | loss: 0.7376270
	speed: 0.0054s/iter; left time: 20.4015s
	iters: 400, epoch: 5 | loss: 0.4397970
	speed: 0.0054s/iter; left time: 19.9200s
	iters: 500, epoch: 5 | loss: 0.3186585
	speed: 0.0056s/iter; left time: 20.1966s
	iters: 600, epoch: 5 | loss: 0.2295136
	speed: 0.0052s/iter; left time: 18.1821s
	iters: 700, epoch: 5 | loss: 0.4862454
	speed: 0.0049s/iter; left time: 16.5459s
	iters: 800, epoch: 5 | loss: 0.2730264
	speed: 0.0050s/iter; left time: 16.5607s
	iters: 900, epoch: 5 | loss: 0.7290345
	speed: 0.0050s/iter; left time: 16.0515s
	iters: 1000, epoch: 5 | loss: 0.3892479
	speed: 0.0051s/iter; left time: 15.9677s
Updating learning rate to 4.52720391875e-06
Epoch: 5 cost time: 5.305141925811768
Epoch: 5, Steps: 1027 | Train Loss: 0.5005260 Vali Loss: 0.3762236 Best vali loss: 0.3653261
	iters: 100, epoch: 6 | loss: 0.6449434
	speed: 0.0178s/iter; left time: 52.9647s
	iters: 200, epoch: 6 | loss: 0.4808882
	speed: 0.0039s/iter; left time: 11.3147s
	iters: 300, epoch: 6 | loss: 0.4749185
	speed: 0.0032s/iter; left time: 8.8936s
	iters: 400, epoch: 6 | loss: 0.3589058
	speed: 0.0037s/iter; left time: 10.0198s
	iters: 500, epoch: 6 | loss: 0.2453793
	speed: 0.0040s/iter; left time: 10.3071s
	iters: 600, epoch: 6 | loss: 0.4137781
	speed: 0.0058s/iter; left time: 14.4569s
	iters: 700, epoch: 6 | loss: 0.2930530
	speed: 0.0059s/iter; left time: 13.9405s
	iters: 800, epoch: 6 | loss: 0.3034550
	speed: 0.0056s/iter; left time: 12.8489s
	iters: 900, epoch: 6 | loss: 0.5920129
	speed: 0.0057s/iter; left time: 12.3436s
	iters: 1000, epoch: 6 | loss: 0.1988039
	speed: 0.0058s/iter; left time: 11.9808s
Updating learning rate to 2.263601959375e-06
Epoch: 6 cost time: 4.963306665420532
Epoch: 6, Steps: 1027 | Train Loss: 0.4006138 Vali Loss: 0.3779949 Best vali loss: 0.3653261
	iters: 100, epoch: 7 | loss: 0.9987691
	speed: 0.0212s/iter; left time: 41.4904s
	iters: 200, epoch: 7 | loss: 0.9664010
	speed: 0.0053s/iter; left time: 9.8669s
	iters: 300, epoch: 7 | loss: 0.6892908
	speed: 0.0044s/iter; left time: 7.6576s
	iters: 400, epoch: 7 | loss: 1.6673559
	speed: 0.0043s/iter; left time: 7.1848s
	iters: 500, epoch: 7 | loss: 0.6763690
	speed: 0.0055s/iter; left time: 8.5708s
	iters: 600, epoch: 7 | loss: 0.9001145
	speed: 0.0051s/iter; left time: 7.4907s
	iters: 700, epoch: 7 | loss: 0.5088130
	speed: 0.0051s/iter; left time: 6.9548s
	iters: 800, epoch: 7 | loss: 0.5772324
	speed: 0.0055s/iter; left time: 6.8845s
	iters: 900, epoch: 7 | loss: 0.4626134
	speed: 0.0053s/iter; left time: 6.1493s
	iters: 1000, epoch: 7 | loss: 0.3465551
	speed: 0.0042s/iter; left time: 4.4676s
Updating learning rate to 1.1318009796875e-06
Epoch: 7 cost time: 5.189778804779053
Epoch: 7, Steps: 1027 | Train Loss: 0.7793514 Vali Loss: 0.3776719 Best vali loss: 0.3653261
	iters: 100, epoch: 8 | loss: 0.2535808
	speed: 0.0171s/iter; left time: 15.8289s
	iters: 200, epoch: 8 | loss: 0.2275428
	speed: 0.0050s/iter; left time: 4.1701s
	iters: 300, epoch: 8 | loss: 0.3430389
	speed: 0.0080s/iter; left time: 5.8417s
	iters: 400, epoch: 8 | loss: 0.2531025
	speed: 0.0061s/iter; left time: 3.8536s
	iters: 500, epoch: 8 | loss: 0.3263686
	speed: 0.0087s/iter; left time: 4.5678s
	iters: 600, epoch: 8 | loss: 0.5453420
	speed: 0.0050s/iter; left time: 2.1199s
	iters: 700, epoch: 8 | loss: 0.3674785
	speed: 0.0047s/iter; left time: 1.5332s
	iters: 800, epoch: 8 | loss: 0.7927807
	speed: 0.0040s/iter; left time: 0.9212s
	iters: 900, epoch: 8 | loss: 0.5549004
	speed: 0.0042s/iter; left time: 0.5335s
	iters: 1000, epoch: 8 | loss: 0.2573212
	speed: 0.0076s/iter; left time: 0.2123s
Updating learning rate to 5.6590048984375e-07
Epoch: 8 cost time: 6.258902072906494
Epoch: 8, Steps: 1027 | Train Loss: 0.3921456 Vali Loss: 0.3778743 Best vali loss: 0.3653261

best validation loss 0.36532612512645646

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0091131903544, 'e_layers': 4, 'learning_rate': 0.0029173918615, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5452311
	speed: 0.0287s/iter; left time: 56.2144s
	iters: 200, epoch: 1 | loss: 0.7050049
	speed: 0.0226s/iter; left time: 41.9616s
Updating learning rate to 0.0029173918615
Validation loss decreased (inf --> 0.4022).  Saving model state dict ...
Epoch: 1 cost time: 6.270248651504517
Epoch: 1, Steps: 257 | Train Loss: 0.6251180 Vali Loss: 0.4022362 Best vali loss: 0.4022362
	iters: 100, epoch: 2 | loss: 0.4985090
	speed: 0.0632s/iter; left time: 107.5246s
	iters: 200, epoch: 2 | loss: 0.6438820
	speed: 0.0258s/iter; left time: 41.3080s
Updating learning rate to 0.00145869593075
Epoch: 2 cost time: 5.9739930629730225
Epoch: 2, Steps: 257 | Train Loss: 0.5711955 Vali Loss: 0.4095938 Best vali loss: 0.4022362
	iters: 100, epoch: 3 | loss: 0.7780570
	speed: 0.0592s/iter; left time: 85.3599s
	iters: 200, epoch: 3 | loss: 0.3730065
	speed: 0.0190s/iter; left time: 25.4680s
Updating learning rate to 0.000729347965375
Validation loss decreased (0.4022 --> 0.3791).  Saving model state dict ...
Epoch: 3 cost time: 5.12396764755249
Epoch: 3, Steps: 257 | Train Loss: 0.5755318 Vali Loss: 0.3790954 Best vali loss: 0.3790954

best validation loss 0.379095431535792

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010763178867, 'e_layers': 2, 'learning_rate': 0.0039079010684, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0039079010684
Validation loss decreased (inf --> 0.3842).  Saving model state dict ...
Epoch: 1 cost time: 1.0966200828552246
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3841690 Best vali loss: 0.3841690
Updating learning rate to 0.0019539505342
Epoch: 2 cost time: 0.7060203552246094
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3928197 Best vali loss: 0.3841690
Updating learning rate to 0.0009769752671
Epoch: 3 cost time: 0.42472028732299805
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3862075 Best vali loss: 0.3841690

best validation loss 0.3841690073547288

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0101968430676, 'e_layers': 3, 'learning_rate': 0.0018502346986, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0017798143334893648
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 1.1236426830291748
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3720500 Best vali loss: 0.3720500
Updating learning rate to 0.0015792741003833538
Epoch: 2 cost time: 0.7394049167633057
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3766166 Best vali loss: 0.3720500
Updating learning rate to 0.0012791444318706177
Epoch: 3 cost time: 0.7346839904785156
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3909630 Best vali loss: 0.3720500

best validation loss 0.3720500121884824

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0101968430676, 'e_layers': 3, 'learning_rate': 0.0018502346986, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0009251173493
Validation loss decreased (0.3721 --> 0.3711).  Saving model state dict ...
Epoch: 4 cost time: 1.1081774234771729
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3710929 Best vali loss: 0.3710929
Updating learning rate to 0.0005710902667293824
Validation loss decreased (0.3711 --> 0.3579).  Saving model state dict ...
Epoch: 5 cost time: 0.6141800880432129
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3578651 Best vali loss: 0.3578651
Updating learning rate to 0.0002709605982166461
Epoch: 6 cost time: 0.741600513458252
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3655276 Best vali loss: 0.3578651
Updating learning rate to 7.042036511063524e-05
Validation loss decreased (0.3579 --> 0.3482).  Saving model state dict ...
Epoch: 7 cost time: 0.7310919761657715
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3481639 Best vali loss: 0.3481639
Updating learning rate to 0.0
Epoch: 8 cost time: 1.01460862159729
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3516418 Best vali loss: 0.3481639

best validation loss 0.3481638843629121

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038051638661, 'e_layers': 2, 'learning_rate': 0.0004113783415, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3013289
	speed: 0.0156s/iter; left time: 62.4319s
	iters: 200, epoch: 1 | loss: 0.5822152
	speed: 0.0082s/iter; left time: 32.1754s
	iters: 300, epoch: 1 | loss: 0.8784069
	speed: 0.0077s/iter; left time: 29.3924s
	iters: 400, epoch: 1 | loss: 0.3545272
	speed: 0.0081s/iter; left time: 29.9296s
	iters: 500, epoch: 1 | loss: 0.5832973
	speed: 0.0085s/iter; left time: 30.7000s
Updating learning rate to 0.0004113783415
Validation loss decreased (inf --> 0.3738).  Saving model state dict ...
Epoch: 1 cost time: 4.594847202301025
Epoch: 1, Steps: 514 | Train Loss: 0.7399551 Vali Loss: 0.3737907 Best vali loss: 0.3737907
	iters: 100, epoch: 2 | loss: 0.2587666
	speed: 0.0188s/iter; left time: 65.6123s
	iters: 200, epoch: 2 | loss: 0.5848287
	speed: 0.0084s/iter; left time: 28.4770s
	iters: 300, epoch: 2 | loss: 0.4522013
	speed: 0.0083s/iter; left time: 27.5259s
	iters: 400, epoch: 2 | loss: 0.7536315
	speed: 0.0098s/iter; left time: 31.2195s
	iters: 500, epoch: 2 | loss: 0.4351775
	speed: 0.0083s/iter; left time: 25.7388s
Updating learning rate to 0.00020568917075
Validation loss decreased (0.3738 --> 0.3598).  Saving model state dict ...
Epoch: 2 cost time: 4.470683813095093
Epoch: 2, Steps: 514 | Train Loss: 0.4969211 Vali Loss: 0.3598212 Best vali loss: 0.3598212
	iters: 100, epoch: 3 | loss: 0.5144209
	speed: 0.0187s/iter; left time: 55.7392s
	iters: 200, epoch: 3 | loss: 0.4091194
	speed: 0.0083s/iter; left time: 23.8594s
	iters: 300, epoch: 3 | loss: 1.0435425
	speed: 0.0084s/iter; left time: 23.3992s
	iters: 400, epoch: 3 | loss: 0.6004245
	speed: 0.0083s/iter; left time: 22.3515s
	iters: 500, epoch: 3 | loss: 0.2835100
	speed: 0.0084s/iter; left time: 21.6724s
Updating learning rate to 0.000102844585375
Epoch: 3 cost time: 4.343273639678955
Epoch: 3, Steps: 514 | Train Loss: 0.5702035 Vali Loss: 0.3649824 Best vali loss: 0.3598212
	iters: 100, epoch: 4 | loss: 0.6707230
	speed: 0.0175s/iter; left time: 43.2487s
	iters: 200, epoch: 4 | loss: 0.4827633
	speed: 0.0082s/iter; left time: 19.4725s
	iters: 300, epoch: 4 | loss: 0.8118680
	speed: 0.0089s/iter; left time: 20.2740s
	iters: 400, epoch: 4 | loss: 0.6666613
	speed: 0.0100s/iter; left time: 21.6492s
	iters: 500, epoch: 4 | loss: 0.5251870
	speed: 0.0083s/iter; left time: 17.2783s
Updating learning rate to 5.14222926875e-05
Epoch: 4 cost time: 4.5019690990448
Epoch: 4, Steps: 514 | Train Loss: 0.6314405 Vali Loss: 0.3619591 Best vali loss: 0.3598212
	iters: 100, epoch: 5 | loss: 0.3859681
	speed: 0.0193s/iter; left time: 37.7373s
	iters: 200, epoch: 5 | loss: 0.2877199
	speed: 0.0077s/iter; left time: 14.2244s
	iters: 300, epoch: 5 | loss: 0.5195940
	speed: 0.0082s/iter; left time: 14.4161s
	iters: 400, epoch: 5 | loss: 1.0779842
	speed: 0.0084s/iter; left time: 13.8958s
	iters: 500, epoch: 5 | loss: 0.3798557
	speed: 0.0083s/iter; left time: 12.8984s
Updating learning rate to 2.571114634375e-05
Epoch: 5 cost time: 4.26120400428772
Epoch: 5, Steps: 514 | Train Loss: 0.5302244 Vali Loss: 0.3609671 Best vali loss: 0.3598212
	iters: 100, epoch: 6 | loss: 0.3146812
	speed: 0.0191s/iter; left time: 27.5775s
	iters: 200, epoch: 6 | loss: 0.5564119
	speed: 0.0091s/iter; left time: 12.2121s
	iters: 300, epoch: 6 | loss: 0.5143387
	speed: 0.0095s/iter; left time: 11.7876s
	iters: 400, epoch: 6 | loss: 0.3481126
	speed: 0.0076s/iter; left time: 8.6514s
	iters: 500, epoch: 6 | loss: 0.6425769
	speed: 0.0083s/iter; left time: 8.7002s
Updating learning rate to 1.2855573171875e-05
Validation loss decreased (0.3598 --> 0.3566).  Saving model state dict ...
Epoch: 6 cost time: 4.4618918895721436
Epoch: 6, Steps: 514 | Train Loss: 0.4752242 Vali Loss: 0.3565937 Best vali loss: 0.3565937
	iters: 100, epoch: 7 | loss: 0.3948212
	speed: 0.0192s/iter; left time: 17.7953s
	iters: 200, epoch: 7 | loss: 0.7657796
	speed: 0.0082s/iter; left time: 6.7610s
	iters: 300, epoch: 7 | loss: 0.6589850
	speed: 0.0078s/iter; left time: 5.7055s
	iters: 400, epoch: 7 | loss: 0.3375772
	speed: 0.0080s/iter; left time: 5.0020s
	iters: 500, epoch: 7 | loss: 1.0196742
	speed: 0.0078s/iter; left time: 4.1522s
Updating learning rate to 6.4277865859375e-06
Validation loss decreased (0.3566 --> 0.3557).  Saving model state dict ...
Epoch: 7 cost time: 4.171281576156616
Epoch: 7, Steps: 514 | Train Loss: 0.6353674 Vali Loss: 0.3556989 Best vali loss: 0.3556989
	iters: 100, epoch: 8 | loss: 0.4115565
	speed: 0.0165s/iter; left time: 6.8414s
	iters: 200, epoch: 8 | loss: 0.3204866
	speed: 0.0114s/iter; left time: 3.5802s
	iters: 300, epoch: 8 | loss: 0.3136784
	speed: 0.0115s/iter; left time: 2.4777s
	iters: 400, epoch: 8 | loss: 0.7680895
	speed: 0.0098s/iter; left time: 1.1279s
	iters: 500, epoch: 8 | loss: 0.7180884
	speed: 0.0114s/iter; left time: 0.1706s
Updating learning rate to 3.21389329296875e-06
Epoch: 8 cost time: 5.427976608276367
Epoch: 8, Steps: 514 | Train Loss: 0.5063799 Vali Loss: 0.3573267 Best vali loss: 0.3556989

best validation loss 0.35569889002089883

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070932288252, 'e_layers': 4, 'learning_rate': 0.0005299103803, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3715934
	speed: 0.0166s/iter; left time: 135.0344s
	iters: 200, epoch: 1 | loss: 1.7097490
	speed: 0.0103s/iter; left time: 82.7010s
	iters: 300, epoch: 1 | loss: 0.6030084
	speed: 0.0095s/iter; left time: 75.4449s
	iters: 400, epoch: 1 | loss: 0.8436223
	speed: 0.0104s/iter; left time: 80.9449s
	iters: 500, epoch: 1 | loss: 0.8790109
	speed: 0.0079s/iter; left time: 60.9271s
	iters: 600, epoch: 1 | loss: 0.2968602
	speed: 0.0106s/iter; left time: 81.1177s
	iters: 700, epoch: 1 | loss: 0.2620227
	speed: 0.0100s/iter; left time: 74.9706s
	iters: 800, epoch: 1 | loss: 0.2692519
	speed: 0.0113s/iter; left time: 83.5931s
	iters: 900, epoch: 1 | loss: 0.2716967
	speed: 0.0096s/iter; left time: 70.0370s
	iters: 1000, epoch: 1 | loss: 0.8066720
	speed: 0.0101s/iter; left time: 73.2293s
Updating learning rate to 0.0005299103803
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 10.625419616699219
Epoch: 1, Steps: 1027 | Train Loss: 0.6313487 Vali Loss: 0.3728370 Best vali loss: 0.3728370
	iters: 100, epoch: 2 | loss: 1.0464336
	speed: 0.0263s/iter; left time: 186.3915s
	iters: 200, epoch: 2 | loss: 0.3140818
	speed: 0.0102s/iter; left time: 71.5932s
	iters: 300, epoch: 2 | loss: 0.2935555
	speed: 0.0081s/iter; left time: 56.0864s
	iters: 400, epoch: 2 | loss: 1.2085384
	speed: 0.0070s/iter; left time: 47.2451s
	iters: 500, epoch: 2 | loss: 1.3541272
	speed: 0.0083s/iter; left time: 55.3316s
	iters: 600, epoch: 2 | loss: 0.2549323
	speed: 0.0110s/iter; left time: 72.1649s
	iters: 700, epoch: 2 | loss: 0.7309995
	speed: 0.0121s/iter; left time: 78.4624s
	iters: 800, epoch: 2 | loss: 0.4462481
	speed: 0.0109s/iter; left time: 69.7864s
	iters: 900, epoch: 2 | loss: 0.6383628
	speed: 0.0111s/iter; left time: 70.1120s
	iters: 1000, epoch: 2 | loss: 0.4483364
	speed: 0.0105s/iter; left time: 64.9524s
Updating learning rate to 0.00026495519015
Epoch: 2 cost time: 10.22646427154541
Epoch: 2, Steps: 1027 | Train Loss: 0.6735615 Vali Loss: 0.3737017 Best vali loss: 0.3728370
	iters: 100, epoch: 3 | loss: 0.4324327
	speed: 0.0265s/iter; left time: 160.5270s
	iters: 200, epoch: 3 | loss: 1.1381721
	speed: 0.0086s/iter; left time: 51.0469s
	iters: 300, epoch: 3 | loss: 0.2555537
	speed: 0.0066s/iter; left time: 38.5371s
	iters: 400, epoch: 3 | loss: 1.5184349
	speed: 0.0084s/iter; left time: 48.1214s
	iters: 500, epoch: 3 | loss: 1.0990907
	speed: 0.0086s/iter; left time: 48.8386s
	iters: 600, epoch: 3 | loss: 0.4765865
	speed: 0.0102s/iter; left time: 56.4687s
	iters: 700, epoch: 3 | loss: 0.4288531
	speed: 0.0096s/iter; left time: 52.6654s
	iters: 800, epoch: 3 | loss: 0.9596919
	speed: 0.0083s/iter; left time: 44.7411s
	iters: 900, epoch: 3 | loss: 0.3528093
	speed: 0.0097s/iter; left time: 51.0695s
	iters: 1000, epoch: 3 | loss: 0.5756660
	speed: 0.0097s/iter; left time: 50.1969s
Updating learning rate to 0.000132477595075
Validation loss decreased (0.3728 --> 0.3726).  Saving model state dict ...
Epoch: 3 cost time: 9.110402822494507
Epoch: 3, Steps: 1027 | Train Loss: 0.7237291 Vali Loss: 0.3725761 Best vali loss: 0.3725761
	iters: 100, epoch: 4 | loss: 0.3667680
	speed: 0.0251s/iter; left time: 126.5844s
	iters: 200, epoch: 4 | loss: 0.6554624
	speed: 0.0082s/iter; left time: 40.6189s
	iters: 300, epoch: 4 | loss: 1.2763450
	speed: 0.0107s/iter; left time: 51.8544s
	iters: 400, epoch: 4 | loss: 1.2003140
	speed: 0.0101s/iter; left time: 48.0177s
	iters: 500, epoch: 4 | loss: 0.3784082
	speed: 0.0101s/iter; left time: 46.8484s
	iters: 600, epoch: 4 | loss: 0.3518133
	speed: 0.0108s/iter; left time: 49.1290s
	iters: 700, epoch: 4 | loss: 0.3626275
	speed: 0.0103s/iter; left time: 45.4901s
	iters: 800, epoch: 4 | loss: 0.4710075
	speed: 0.0102s/iter; left time: 44.1902s
	iters: 900, epoch: 4 | loss: 0.7042580
	speed: 0.0102s/iter; left time: 43.4127s
	iters: 1000, epoch: 4 | loss: 0.2432198
	speed: 0.0098s/iter; left time: 40.6280s
Updating learning rate to 6.62387975375e-05
Epoch: 4 cost time: 10.261541604995728
Epoch: 4, Steps: 1027 | Train Loss: 0.6010224 Vali Loss: 0.3776878 Best vali loss: 0.3725761
	iters: 100, epoch: 5 | loss: 0.4293494
	speed: 0.0265s/iter; left time: 106.0928s
	iters: 200, epoch: 5 | loss: 0.6775499
	speed: 0.0092s/iter; left time: 35.9098s
	iters: 300, epoch: 5 | loss: 0.3597750
	speed: 0.0113s/iter; left time: 43.1928s
	iters: 400, epoch: 5 | loss: 0.2016993
	speed: 0.0097s/iter; left time: 35.8702s
	iters: 500, epoch: 5 | loss: 0.9207804
	speed: 0.0096s/iter; left time: 34.7878s
	iters: 600, epoch: 5 | loss: 0.7983141
	speed: 0.0111s/iter; left time: 38.9335s
	iters: 700, epoch: 5 | loss: 1.1010063
	speed: 0.0084s/iter; left time: 28.7396s
	iters: 800, epoch: 5 | loss: 0.6373882
	speed: 0.0098s/iter; left time: 32.4375s
	iters: 900, epoch: 5 | loss: 1.2459317
	speed: 0.0105s/iter; left time: 33.6852s
	iters: 1000, epoch: 5 | loss: 0.2889367
	speed: 0.0098s/iter; left time: 30.5536s
Updating learning rate to 3.311939876875e-05
Epoch: 5 cost time: 10.166709661483765
Epoch: 5, Steps: 1027 | Train Loss: 0.6660731 Vali Loss: 0.3772301 Best vali loss: 0.3725761
	iters: 100, epoch: 6 | loss: 0.1754358
	speed: 0.0262s/iter; left time: 78.1448s
	iters: 200, epoch: 6 | loss: 0.3145461
	speed: 0.0094s/iter; left time: 27.2304s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0094053072029, 'e_layers': 3, 'learning_rate': 0.0019799505799, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0019799505799
Validation loss decreased (inf --> 0.3898).  Saving model state dict ...
Epoch: 1 cost time: 1.4989688396453857
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3897643 Best vali loss: 0.3897643
Updating learning rate to 0.00098997528995
Epoch: 2 cost time: 1.2483594417572021
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3958957 Best vali loss: 0.3897643
Updating learning rate to 0.000494987644975
Epoch: 3 cost time: 1.2144722938537598
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4016425 Best vali loss: 0.3897643

best validation loss 0.38976429826150005

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0015770726247, 'e_layers': 1, 'learning_rate': 0.0002662824309, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6248179
	speed: 0.0149s/iter; left time: 13.9366s
Updating learning rate to 0.0002662824309
Validation loss decreased (inf --> 0.4008).  Saving model state dict ...
Epoch: 1 cost time: 1.3484678268432617
Epoch: 1, Steps: 129 | Train Loss: 0.6248179 Vali Loss: 0.4008139 Best vali loss: 0.4008139
	iters: 100, epoch: 2 | loss: 0.6310951
	speed: 0.0099s/iter; left time: 7.9506s
Updating learning rate to 0.00013314121545
Validation loss decreased (0.4008 --> 0.3813).  Saving model state dict ...
Epoch: 2 cost time: 0.6421604156494141
Epoch: 2, Steps: 129 | Train Loss: 0.6310951 Vali Loss: 0.3813025 Best vali loss: 0.3813025
	iters: 100, epoch: 3 | loss: 0.5520329
	speed: 0.0070s/iter; left time: 4.7425s
Updating learning rate to 6.6570607725e-05
Validation loss decreased (0.3813 --> 0.3765).  Saving model state dict ...
Epoch: 3 cost time: 0.6263093948364258
Epoch: 3, Steps: 129 | Train Loss: 0.5520329 Vali Loss: 0.3765244 Best vali loss: 0.3765244

best validation loss 0.3765243848906519

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.002107290471, 'e_layers': 2, 'learning_rate': 0.0013961478844, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0013961478844
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 0.9786572456359863
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3683424 Best vali loss: 0.3683424
Updating learning rate to 0.0006980739422
Epoch: 2 cost time: 0.6818761825561523
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3844635 Best vali loss: 0.3683424
Updating learning rate to 0.0003490369711
Epoch: 3 cost time: 0.6519324779510498
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3841238 Best vali loss: 0.3683424

best validation loss 0.3683424315424471

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.002107290471, 'e_layers': 2, 'learning_rate': 0.0013961478844, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00017451848555
Epoch: 4 cost time: 1.0362210273742676
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3826392 Best vali loss: 0.3683424
Updating learning rate to 8.7259242775e-05
Epoch: 5 cost time: 0.7850134372711182
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3830054 Best vali loss: 0.3683424
Updating learning rate to 4.36296213875e-05
Epoch: 6 cost time: 0.8138918876647949
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3776808 Best vali loss: 0.3683424
Updating learning rate to 2.181481069375e-05
Epoch: 7 cost time: 0.48105812072753906
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3813475 Best vali loss: 0.3683424
Updating learning rate to 1.0907405346875e-05
Epoch: 8 cost time: 0.4575033187866211
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3794151 Best vali loss: 0.3683424

best validation loss 0.3683424315424471

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.0025086776697, 'e_layers': 2, 'learning_rate': 0.0038401597058, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0038401597058
Validation loss decreased (inf --> 0.3761).  Saving model state dict ...
Epoch: 1 cost time: 0.8974742889404297
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3760737 Best vali loss: 0.3760737
Updating learning rate to 0.0019200798529
Validation loss decreased (0.3761 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.5854923725128174
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3667936 Best vali loss: 0.3667936
Updating learning rate to 0.00096003992645
Epoch: 3 cost time: 0.57570481300354
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3857632 Best vali loss: 0.3667936
Updating learning rate to 0.000480019963225
Epoch: 4 cost time: 0.5814218521118164
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3894827 Best vali loss: 0.3667936
Updating learning rate to 0.0002400099816125
Epoch: 5 cost time: 0.7610716819763184
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3997590 Best vali loss: 0.3667936
Updating learning rate to 0.00012000499080625
Epoch: 6 cost time: 0.6736257076263428
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4015892 Best vali loss: 0.3667936
Updating learning rate to 6.0002495403125e-05
Epoch: 7 cost time: 0.5845940113067627
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4019337 Best vali loss: 0.3667936
Updating learning rate to 3.00012477015625e-05
Epoch: 8 cost time: 0.9536609649658203
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4041350 Best vali loss: 0.3667936

best validation loss 0.3667936314885415

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0015460420617, 'e_layers': 4, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8595577
	speed: 0.0205s/iter; left time: 82.2304s
	iters: 200, epoch: 1 | loss: 1.2079494
	speed: 0.0143s/iter; left time: 55.8281s
	iters: 300, epoch: 1 | loss: 0.8877661
	speed: 0.0144s/iter; left time: 55.0481s
	iters: 400, epoch: 1 | loss: 0.4308675
	speed: 0.0137s/iter; left time: 50.7298s
	iters: 500, epoch: 1 | loss: 0.3732388
	speed: 0.0126s/iter; left time: 45.5514s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 7.452398777008057
Epoch: 1, Steps: 514 | Train Loss: 0.7518759 Vali Loss: 0.3706465 Best vali loss: 0.3706465
	iters: 100, epoch: 2 | loss: 0.3984974
	speed: 0.0333s/iter; left time: 116.4597s
	iters: 200, epoch: 2 | loss: 0.9454948
	speed: 0.0105s/iter; left time: 35.6449s
	iters: 300, epoch: 2 | loss: 0.6946775
	speed: 0.0106s/iter; left time: 35.0005s
	iters: 400, epoch: 2 | loss: 0.6289816
	speed: 0.0098s/iter; left time: 31.2641s
	iters: 500, epoch: 2 | loss: 0.7699609
	speed: 0.0102s/iter; left time: 31.6253s
Updating learning rate to 0.000552421030539641
Epoch: 2 cost time: 5.1813249588012695
Epoch: 2, Steps: 514 | Train Loss: 0.6875224 Vali Loss: 0.3759192 Best vali loss: 0.3706465
	iters: 100, epoch: 3 | loss: 0.6833121
	speed: 0.0197s/iter; left time: 58.6721s
	iters: 200, epoch: 3 | loss: 0.3546500
	speed: 0.0103s/iter; left time: 29.8453s
	iters: 300, epoch: 3 | loss: 0.4858283
	speed: 0.0090s/iter; left time: 25.1448s
	iters: 400, epoch: 3 | loss: 0.7163541
	speed: 0.0064s/iter; left time: 17.0912s
	iters: 500, epoch: 3 | loss: 0.5122786
	speed: 0.0111s/iter; left time: 28.6958s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.3706 --> 0.3705).  Saving model state dict ...
Epoch: 3 cost time: 4.865251302719116
Epoch: 3, Steps: 514 | Train Loss: 0.5504846 Vali Loss: 0.3705298 Best vali loss: 0.3705298
	iters: 100, epoch: 4 | loss: 0.3617040
	speed: 0.0302s/iter; left time: 74.7353s
	iters: 200, epoch: 4 | loss: 0.4546190
	speed: 0.0153s/iter; left time: 36.3869s
	iters: 300, epoch: 4 | loss: 0.8905106
	speed: 0.0095s/iter; left time: 21.6838s
	iters: 400, epoch: 4 | loss: 0.6581548
	speed: 0.0087s/iter; left time: 18.8577s
	iters: 500, epoch: 4 | loss: 0.4107071
	speed: 0.0088s/iter; left time: 18.2178s
Updating learning rate to 0.00032360074755
Epoch: 4 cost time: 5.987760066986084
Epoch: 4, Steps: 514 | Train Loss: 0.5551391 Vali Loss: 0.3756612 Best vali loss: 0.3705298
	iters: 100, epoch: 5 | loss: 0.4452513
	speed: 0.0347s/iter; left time: 67.9696s
	iters: 200, epoch: 5 | loss: 0.9773881
	speed: 0.0119s/iter; left time: 22.0085s
	iters: 300, epoch: 5 | loss: 0.4741215
	speed: 0.0135s/iter; left time: 23.6842s
	iters: 400, epoch: 5 | loss: 0.7117254
	speed: 0.0123s/iter; left time: 20.3191s
	iters: 500, epoch: 5 | loss: 0.4317811
	speed: 0.0123s/iter; left time: 19.1626s
Updating learning rate to 0.0001997641027616571
Epoch: 5 cost time: 6.4257917404174805
Epoch: 5, Steps: 514 | Train Loss: 0.6080535 Vali Loss: 0.3759080 Best vali loss: 0.3705298
	iters: 100, epoch: 6 | loss: 0.5016699
	speed: 0.0351s/iter; left time: 50.6139s
	iters: 200, epoch: 6 | loss: 0.5963197
	speed: 0.0142s/iter; left time: 19.0707s
	iters: 300, epoch: 6 | loss: 0.8323766
	speed: 0.0127s/iter; left time: 15.7889s
	iters: 400, epoch: 6 | loss: 0.5120221
	speed: 0.0118s/iter; left time: 13.5314s
	iters: 500, epoch: 6 | loss: 0.3900186
	speed: 0.0121s/iter; left time: 12.6159s
Updating learning rate to 9.478046456035896e-05
Validation loss decreased (0.3705 --> 0.3673).  Saving model state dict ...
Epoch: 6 cost time: 6.559040307998657
Epoch: 6, Steps: 514 | Train Loss: 0.5664814 Vali Loss: 0.3672920 Best vali loss: 0.3672920
	iters: 100, epoch: 7 | loss: 0.3171048
	speed: 0.0296s/iter; left time: 27.5242s
	iters: 200, epoch: 7 | loss: 0.9602320
	speed: 0.0123s/iter; left time: 10.1979s
	iters: 300, epoch: 7 | loss: 0.7518454
	speed: 0.0135s/iter; left time: 9.8071s
	iters: 400, epoch: 7 | loss: 0.3825033
	speed: 0.0128s/iter; left time: 8.0326s
	iters: 500, epoch: 7 | loss: 0.4052084
	speed: 0.0134s/iter; left time: 7.1125s
Updating learning rate to 2.463264018320308e-05
Epoch: 7 cost time: 6.688962697982788
Epoch: 7, Steps: 514 | Train Loss: 0.5633788 Vali Loss: 0.3695555 Best vali loss: 0.3672920
	iters: 100, epoch: 8 | loss: 0.9223773
	speed: 0.0412s/iter; left time: 17.1091s
	iters: 200, epoch: 8 | loss: 0.2685176
	speed: 0.0110s/iter; left time: 3.4796s
	iters: 300, epoch: 8 | loss: 0.3779962
	speed: 0.0102s/iter; left time: 2.1949s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0011650416776, 'e_layers': 3, 'learning_rate': 0.0006284742465, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5394909
	speed: 0.0160s/iter; left time: 31.3280s
	iters: 200, epoch: 1 | loss: 0.8393523
	speed: 0.0093s/iter; left time: 17.3551s
Updating learning rate to 0.0006284742465
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 2.81938099861145
Epoch: 1, Steps: 257 | Train Loss: 0.6894216 Vali Loss: 0.3689658 Best vali loss: 0.3689658
	iters: 100, epoch: 2 | loss: 0.5127994
	speed: 0.0196s/iter; left time: 33.3876s
	iters: 200, epoch: 2 | loss: 0.7328953
	speed: 0.0111s/iter; left time: 17.6843s
Updating learning rate to 0.00031423712325
Epoch: 2 cost time: 2.7675418853759766
Epoch: 2, Steps: 257 | Train Loss: 0.6228474 Vali Loss: 0.3727612 Best vali loss: 0.3689658
	iters: 100, epoch: 3 | loss: 0.5619120
	speed: 0.0208s/iter; left time: 29.9759s
	iters: 200, epoch: 3 | loss: 0.4617121
	speed: 0.0094s/iter; left time: 12.5583s
Updating learning rate to 0.000157118561625
Epoch: 3 cost time: 2.4038002490997314
Epoch: 3, Steps: 257 | Train Loss: 0.5118120 Vali Loss: 0.3737911 Best vali loss: 0.3689658

best validation loss 0.3689657792478273

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0028185381011, 'e_layers': 4, 'learning_rate': 0.0001995278037, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001995278037
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 1.4989216327667236
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3664253 Best vali loss: 0.3664253
Updating learning rate to 9.976390185e-05
Validation loss decreased (0.3664 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 1.172623872756958
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3659360 Best vali loss: 0.3659360
Updating learning rate to 4.9881950925e-05
Validation loss decreased (0.3659 --> 0.3645).  Saving model state dict ...
Epoch: 3 cost time: 1.1686890125274658
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3645217 Best vali loss: 0.3645217

best validation loss 0.3645216809157538

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0035369297299, 'e_layers': 3, 'learning_rate': 0.0015538017858, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6248051
	speed: 0.0184s/iter; left time: 35.9777s
	iters: 200, epoch: 1 | loss: 0.4982461
	speed: 0.0091s/iter; left time: 16.9428s
Updating learning rate to 0.0015538017858
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 2.9980247020721436
Epoch: 1, Steps: 257 | Train Loss: 0.5615256 Vali Loss: 0.3818467 Best vali loss: 0.3818467
	iters: 100, epoch: 2 | loss: 0.6567429
	speed: 0.0199s/iter; left time: 33.8006s
	iters: 200, epoch: 2 | loss: 0.4602102
	speed: 0.0094s/iter; left time: 15.1062s
Updating learning rate to 0.0007769008929
Validation loss decreased (0.3818 --> 0.3782).  Saving model state dict ...
Epoch: 2 cost time: 2.5096330642700195
Epoch: 2, Steps: 257 | Train Loss: 0.5584766 Vali Loss: 0.3782446 Best vali loss: 0.3782446
	iters: 100, epoch: 3 | loss: 0.5193658
	speed: 0.0199s/iter; left time: 28.6704s
	iters: 200, epoch: 3 | loss: 0.8250431
	speed: 0.0094s/iter; left time: 12.5668s
Updating learning rate to 0.00038845044645
Epoch: 3 cost time: 2.4407355785369873
Epoch: 3, Steps: 257 | Train Loss: 0.6722044 Vali Loss: 0.3887567 Best vali loss: 0.3782446

best validation loss 0.378244594330872

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0028185381011, 'e_layers': 4, 'learning_rate': 0.0001995278037, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 2.49409754625e-05
Epoch: 4 cost time: 1.595571756362915
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3648784 Best vali loss: 0.3645217
Updating learning rate to 1.247048773125e-05
Epoch: 5 cost time: 0.8447122573852539
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3709459 Best vali loss: 0.3645217
Updating learning rate to 6.235243865625e-06
Epoch: 6 cost time: 1.0494120121002197
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3680234 Best vali loss: 0.3645217
Updating learning rate to 3.1176219328125e-06
Epoch: 7 cost time: 1.1973721981048584
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3677457 Best vali loss: 0.3645217
Updating learning rate to 1.55881096640625e-06
Epoch: 8 cost time: 1.172867774963379
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3678660 Best vali loss: 0.3645217

best validation loss 0.3645216809157538

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018136847288, 'e_layers': 2, 'learning_rate': 0.0002984833543, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9002424
	speed: 0.0138s/iter; left time: 111.7949s
	iters: 200, epoch: 1 | loss: 0.1925525
	speed: 0.0065s/iter; left time: 52.3921s
	iters: 300, epoch: 1 | loss: 0.1814585
	speed: 0.0079s/iter; left time: 62.8231s
	iters: 400, epoch: 1 | loss: 0.3032547
	speed: 0.0077s/iter; left time: 59.9139s
	iters: 500, epoch: 1 | loss: 0.3942901
	speed: 0.0077s/iter; left time: 59.1871s
	iters: 600, epoch: 1 | loss: 0.2929679
	speed: 0.0083s/iter; left time: 63.2607s
	iters: 700, epoch: 1 | loss: 0.9900983
	speed: 0.0074s/iter; left time: 55.6085s
	iters: 800, epoch: 1 | loss: 1.0075598
	speed: 0.0062s/iter; left time: 45.8555s
	iters: 900, epoch: 1 | loss: 0.8821469
	speed: 0.0051s/iter; left time: 37.1118s
	iters: 1000, epoch: 1 | loss: 0.2137908
	speed: 0.0057s/iter; left time: 41.4919s
Updating learning rate to 0.0002984833543
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 7.5624167919158936
Epoch: 1, Steps: 1027 | Train Loss: 0.5358362 Vali Loss: 0.3719532 Best vali loss: 0.3719532
	iters: 100, epoch: 2 | loss: 0.8535017
	speed: 0.0297s/iter; left time: 210.4814s
	iters: 200, epoch: 2 | loss: 0.2947881
	speed: 0.0067s/iter; left time: 46.7055s
	iters: 300, epoch: 2 | loss: 0.2531284
	speed: 0.0067s/iter; left time: 46.4917s
	iters: 400, epoch: 2 | loss: 0.2509218
	speed: 0.0063s/iter; left time: 42.9617s
	iters: 500, epoch: 2 | loss: 0.2302760
	speed: 0.0095s/iter; left time: 63.6087s
	iters: 600, epoch: 2 | loss: 0.3556605
	speed: 0.0096s/iter; left time: 62.9865s
	iters: 700, epoch: 2 | loss: 2.0863922
	speed: 0.0094s/iter; left time: 61.1476s
	iters: 800, epoch: 2 | loss: 0.8075402
	speed: 0.0106s/iter; left time: 67.8777s
	iters: 900, epoch: 2 | loss: 0.7696906
	speed: 0.0086s/iter; left time: 54.1214s
	iters: 1000, epoch: 2 | loss: 0.3585782
	speed: 0.0082s/iter; left time: 50.8738s
Updating learning rate to 0.00014924167715
Epoch: 2 cost time: 8.586012125015259
Epoch: 2, Steps: 1027 | Train Loss: 0.6260478 Vali Loss: 0.3889422 Best vali loss: 0.3719532
	iters: 100, epoch: 3 | loss: 0.1959292
	speed: 0.0178s/iter; left time: 107.6497s
	iters: 200, epoch: 3 | loss: 0.3491378
	speed: 0.0068s/iter; left time: 40.7132s
	iters: 300, epoch: 3 | loss: 0.6040275
	speed: 0.0058s/iter; left time: 34.2008s
	iters: 400, epoch: 3 | loss: 0.9712877
	speed: 0.0065s/iter; left time: 37.4630s
	iters: 500, epoch: 3 | loss: 0.5208970
	speed: 0.0065s/iter; left time: 36.8715s
	iters: 600, epoch: 3 | loss: 0.2977244
	speed: 0.0058s/iter; left time: 32.4917s
	iters: 700, epoch: 3 | loss: 0.7179781
	speed: 0.0051s/iter; left time: 27.8956s
	iters: 800, epoch: 3 | loss: 0.6527758
	speed: 0.0046s/iter; left time: 24.4703s
	iters: 900, epoch: 3 | loss: 0.9111432
	speed: 0.0056s/iter; left time: 29.4009s
	iters: 1000, epoch: 3 | loss: 0.2637618
	speed: 0.0067s/iter; left time: 34.8256s
Updating learning rate to 7.4620838575e-05
Epoch: 3 cost time: 6.254765272140503
Epoch: 3, Steps: 1027 | Train Loss: 0.5484662 Vali Loss: 0.3753034 Best vali loss: 0.3719532
	iters: 100, epoch: 4 | loss: 0.4535210
	speed: 0.0204s/iter; left time: 102.6801s
	iters: 200, epoch: 4 | loss: 0.3432084
	speed: 0.0073s/iter; left time: 35.8110s
	iters: 300, epoch: 4 | loss: 0.5061484
	speed: 0.0065s/iter; left time: 31.5686s
	iters: 400, epoch: 4 | loss: 0.8715851
	speed: 0.0069s/iter; left time: 32.6121s
	iters: 500, epoch: 4 | loss: 0.3426439
	speed: 0.0063s/iter; left time: 29.0447s
	iters: 600, epoch: 4 | loss: 0.3820586
	speed: 0.0066s/iter; left time: 29.7461s
	iters: 700, epoch: 4 | loss: 0.4175154
	speed: 0.0061s/iter; left time: 26.8979s
	iters: 800, epoch: 4 | loss: 0.2305500
	speed: 0.0050s/iter; left time: 21.5188s
	iters: 900, epoch: 4 | loss: 0.4805335
	speed: 0.0054s/iter; left time: 22.7837s
	iters: 1000, epoch: 4 | loss: 0.5978252
	speed: 0.0093s/iter; left time: 38.6227s
Updating learning rate to 3.73104192875e-05
Validation loss decreased (0.3720 --> 0.3620).  Saving model state dict ...
Epoch: 4 cost time: 6.853949308395386
Epoch: 4, Steps: 1027 | Train Loss: 0.4625590 Vali Loss: 0.3619725 Best vali loss: 0.3619725
	iters: 100, epoch: 5 | loss: 0.3389148
	speed: 0.0338s/iter; left time: 135.4255s
	iters: 200, epoch: 5 | loss: 0.2238913
	speed: 0.0080s/iter; left time: 31.1026s
	iters: 300, epoch: 5 | loss: 0.4255921
	speed: 0.0105s/iter; left time: 40.1449s
	iters: 400, epoch: 5 | loss: 0.3905534
	speed: 0.0063s/iter; left time: 23.4957s
	iters: 500, epoch: 5 | loss: 0.3020246
	speed: 0.0090s/iter; left time: 32.3726s
	iters: 600, epoch: 5 | loss: 0.2616180
	speed: 0.0090s/iter; left time: 31.5487s
	iters: 700, epoch: 5 | loss: 0.8025590
	speed: 0.0085s/iter; left time: 29.0340s
	iters: 800, epoch: 5 | loss: 0.7939069
	speed: 0.0087s/iter; left time: 28.7619s
	iters: 900, epoch: 5 | loss: 0.9779277
	speed: 0.0080s/iter; left time: 25.6422s
	iters: 1000, epoch: 5 | loss: 0.3279288
	speed: 0.0060s/iter; left time: 18.5835s
Updating learning rate to 1.865520964375e-05
Epoch: 5 cost time: 8.653022766113281
Epoch: 5, Steps: 1027 | Train Loss: 0.4844917 Vali Loss: 0.3671962 Best vali loss: 0.3619725
	iters: 100, epoch: 6 | loss: 0.3165238
	speed: 0.0165s/iter; left time: 49.3431s
	iters: 200, epoch: 6 | loss: 0.3503969
	speed: 0.0068s/iter; left time: 19.5964s
	iters: 300, epoch: 6 | loss: 1.0755237
	speed: 0.0065s/iter; left time: 18.0551s
	iters: 400, epoch: 6 | loss: 0.3625934
	speed: 0.0068s/iter; left time: 18.2566s
	iters: 500, epoch: 6 | loss: 0.8703566
	speed: 0.0072s/iter; left time: 18.6189s
	iters: 600, epoch: 6 | loss: 0.4418301
	speed: 0.0068s/iter; left time: 16.8654s
	iters: 700, epoch: 6 | loss: 0.2021226
	speed: 0.0069s/iter; left time: 16.4098s
	iters: 800, epoch: 6 | loss: 0.5610740
	speed: 0.0075s/iter; left time: 17.0035s
	iters: 900, epoch: 6 | loss: 0.4222545
	speed: 0.0071s/iter; left time: 15.4780s
	iters: 1000, epoch: 6 | loss: 0.7673464
	speed: 0.0060s/iter; left time: 12.4915s
Updating learning rate to 9.327604821875e-06
Epoch: 6 cost time: 7.071794748306274
Epoch: 6, Steps: 1027 | Train Loss: 0.5370022 Vali Loss: 0.3699698 Best vali loss: 0.3619725
	iters: 100, epoch: 7 | loss: 0.7044275
	speed: 0.0203s/iter; left time: 39.6116s
	iters: 200, epoch: 7 | loss: 0.7549962
	speed: 0.0077s/iter; left time: 14.2160s
	iters: 300, epoch: 7 | loss: 0.8273960
	speed: 0.0074s/iter; left time: 13.0041s
	iters: 400, epoch: 7 | loss: 0.1742427
	speed: 0.0069s/iter; left time: 11.4598s
	iters: 500, epoch: 7 | loss: 0.8790829
	speed: 0.0066s/iter; left time: 10.3224s
	iters: 600, epoch: 7 | loss: 0.2489284
	speed: 0.0076s/iter; left time: 11.1034s
	iters: 700, epoch: 7 | loss: 0.2270450
	speed: 0.0077s/iter; left time: 10.4726s
	iters: 800, epoch: 7 | loss: 1.2331653
	speed: 0.0066s/iter; left time: 8.3238s
	iters: 900, epoch: 7 | loss: 0.3406416
	speed: 0.0073s/iter; left time: 8.4114s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0030982356889, 'e_layers': 4, 'learning_rate': 0.0030793595896, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.002962158443836898
Validation loss decreased (inf --> 0.3823).  Saving model state dict ...
Epoch: 1 cost time: 1.6124303340911865
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3823189 Best vali loss: 0.3823189
Updating learning rate to 0.002628397818558992
Epoch: 2 cost time: 1.0549218654632568
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3964374 Best vali loss: 0.3823189
Updating learning rate to 0.0021288897434172415
Validation loss decreased (0.3823 --> 0.3787).  Saving model state dict ...
Epoch: 3 cost time: 1.1530299186706543
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3787255 Best vali loss: 0.3787255
Updating learning rate to 0.0015396797948
Epoch: 4 cost time: 1.2690670490264893
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3904694 Best vali loss: 0.3787255
Updating learning rate to 0.0009504698461827591
Epoch: 5 cost time: 1.0848236083984375
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3876849 Best vali loss: 0.3787255
Updating learning rate to 0.0004509617710410081
Validation loss decreased (0.3787 --> 0.3775).  Saving model state dict ...
Epoch: 6 cost time: 1.4930860996246338
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3774652 Best vali loss: 0.3774652
Updating learning rate to 0.00011720114576310211
Epoch: 7 cost time: 0.9784691333770752
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3877581 Best vali loss: 0.3774652
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7669391632080078
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3872156 Best vali loss: 0.3774652

best validation loss 0.37746522841144403

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0013703913795, 'e_layers': 3, 'learning_rate': 0.0008383415485, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4762737
	speed: 0.0151s/iter; left time: 29.6393s
	iters: 200, epoch: 1 | loss: 1.6093583
	speed: 0.0084s/iter; left time: 15.6052s
Updating learning rate to 0.0008064340732064841
Validation loss decreased (inf --> 0.3784).  Saving model state dict ...
Epoch: 1 cost time: 2.527796983718872
Epoch: 1, Steps: 257 | Train Loss: 1.0428160 Vali Loss: 0.3783831 Best vali loss: 0.3783831
	iters: 100, epoch: 2 | loss: 0.6325132
	speed: 0.0239s/iter; left time: 40.6423s
	iters: 200, epoch: 2 | loss: 0.8122812
	speed: 0.0086s/iter; left time: 13.7400s
Updating learning rate to 0.0007155692711973905
Validation loss decreased (0.3784 --> 0.3727).  Saving model state dict ...
Epoch: 2 cost time: 2.4930336475372314
Epoch: 2, Steps: 257 | Train Loss: 0.7223972 Vali Loss: 0.3726638 Best vali loss: 0.3726638
	iters: 100, epoch: 3 | loss: 0.7624761
	speed: 0.0187s/iter; left time: 26.9802s
	iters: 200, epoch: 3 | loss: 0.7262514
	speed: 0.0085s/iter; left time: 11.4009s
Updating learning rate to 0.0005795804848871222
Epoch: 3 cost time: 2.237499237060547
Epoch: 3, Steps: 257 | Train Loss: 0.7443638 Vali Loss: 0.4099119 Best vali loss: 0.3726638

best validation loss 0.37266379344205725

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0032013986518, 'e_layers': 1, 'learning_rate': 5.0701814e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 4.8772091107897105e-05
Validation loss decreased (inf --> 0.4435).  Saving model state dict ...
Epoch: 1 cost time: 0.8565335273742676
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4434614 Best vali loss: 0.4434614
Updating learning rate to 4.327670524892952e-05
Validation loss decreased (0.4435 --> 0.4367).  Saving model state dict ...
Epoch: 2 cost time: 0.5169093608856201
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4366662 Best vali loss: 0.4366662
Updating learning rate to 3.5052279104328187e-05
Validation loss decreased (0.4367 --> 0.4312).  Saving model state dict ...
Epoch: 3 cost time: 1.1917212009429932
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4311874 Best vali loss: 0.4311874

best validation loss 0.4311874391756264

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012202100866, 'e_layers': 1, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6673920
	speed: 0.0131s/iter; left time: 12.2337s
Updating learning rate to 0.0005385115939239891
Validation loss decreased (inf --> 0.3792).  Saving model state dict ...
Epoch: 1 cost time: 1.242805004119873
Epoch: 1, Steps: 129 | Train Loss: 0.6673920 Vali Loss: 0.3792274 Best vali loss: 0.3792274
	iters: 100, epoch: 2 | loss: 0.5174302
	speed: 0.0125s/iter; left time: 10.0488s
Updating learning rate to 0.0004778349050448276
Validation loss decreased (0.3792 --> 0.3685).  Saving model state dict ...
Epoch: 2 cost time: 0.9148609638214111
Epoch: 2, Steps: 129 | Train Loss: 0.5174302 Vali Loss: 0.3685409 Best vali loss: 0.3685409
	iters: 100, epoch: 3 | loss: 0.7888760
	speed: 0.0111s/iter; left time: 7.4593s
Updating learning rate to 0.0003870258228088137
Validation loss decreased (0.3685 --> 0.3664).  Saving model state dict ...
Epoch: 3 cost time: 0.8547079563140869
Epoch: 3, Steps: 129 | Train Loss: 0.7888760 Vali Loss: 0.3663944 Best vali loss: 0.3663944

best validation loss 0.36639441948508467

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012202100866, 'e_layers': 1, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6208690
	speed: 0.0192s/iter; left time: 10.4860s
Updating learning rate to 0.0002799092068
Validation loss decreased (0.3664 --> 0.3652).  Saving model state dict ...
Epoch: 4 cost time: 1.8586382865905762
Epoch: 4, Steps: 129 | Train Loss: 0.6208690 Vali Loss: 0.3651958 Best vali loss: 0.3651958
	iters: 100, epoch: 5 | loss: 0.5053443
	speed: 0.0286s/iter; left time: 11.9106s
Updating learning rate to 0.00017279259079118627
Epoch: 5 cost time: 2.497924327850342
Epoch: 5, Steps: 129 | Train Loss: 0.5053443 Vali Loss: 0.3675068 Best vali loss: 0.3651958
	iters: 100, epoch: 6 | loss: 0.7796447
	speed: 0.0191s/iter; left time: 5.4969s
Updating learning rate to 8.198350855517233e-05
Epoch: 6 cost time: 0.8604743480682373
Epoch: 6, Steps: 129 | Train Loss: 0.7796447 Vali Loss: 0.3672420 Best vali loss: 0.3651958
	iters: 100, epoch: 7 | loss: 0.6031782
	speed: 0.0109s/iter; left time: 1.7283s
Updating learning rate to 2.1306819676010916e-05
Epoch: 7 cost time: 0.8697853088378906
Epoch: 7, Steps: 129 | Train Loss: 0.6031782 Vali Loss: 0.3682530 Best vali loss: 0.3651958
	iters: 100, epoch: 8 | loss: 0.4678670
	speed: 0.0117s/iter; left time: 0.3502s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8956999778747559
Epoch: 8, Steps: 129 | Train Loss: 0.4678670 Vali Loss: 0.3680939 Best vali loss: 0.3651958

best validation loss 0.36519581909732407

[INFO][smbo.py:320] Finished 550 trials.
{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5211843
	speed: 0.0147s/iter; left time: 28.8262s
	iters: 200, epoch: 1 | loss: 1.1411717
	speed: 0.0071s/iter; left time: 13.1571s
Updating learning rate to 0.0006308326133
Validation loss decreased (inf --> 0.3667).  Saving model state dict ...
Epoch: 1 cost time: 2.3795719146728516
Epoch: 1, Steps: 257 | Train Loss: 0.8311780 Vali Loss: 0.3667353 Best vali loss: 0.3667353
	iters: 100, epoch: 2 | loss: 0.6610183
	speed: 0.0188s/iter; left time: 32.0047s
	iters: 200, epoch: 2 | loss: 0.8584663
	speed: 0.0134s/iter; left time: 21.4276s
Updating learning rate to 0.00031541630665
Epoch: 2 cost time: 3.2139296531677246
Epoch: 2, Steps: 257 | Train Loss: 0.7597423 Vali Loss: 0.3702272 Best vali loss: 0.3667353
	iters: 100, epoch: 3 | loss: 0.6891817
	speed: 0.0385s/iter; left time: 55.5346s
	iters: 200, epoch: 3 | loss: 0.2878526
	speed: 0.0245s/iter; left time: 32.9202s
Updating learning rate to 0.000157708153325
Epoch: 3 cost time: 5.505028486251831
Epoch: 3, Steps: 257 | Train Loss: 0.4885171 Vali Loss: 0.3990757 Best vali loss: 0.3667353
	iters: 100, epoch: 4 | loss: 0.4650182
	speed: 0.0670s/iter; left time: 79.4051s
	iters: 200, epoch: 4 | loss: 0.6230681
	speed: 0.0162s/iter; left time: 17.5464s
Updating learning rate to 7.88540766625e-05
Epoch: 4 cost time: 4.727016448974609
Epoch: 4, Steps: 257 | Train Loss: 0.5440431 Vali Loss: 0.3845827 Best vali loss: 0.3667353
	iters: 100, epoch: 5 | loss: 0.6095790
	speed: 0.0350s/iter; left time: 32.5229s
	iters: 200, epoch: 5 | loss: 0.6956480
	speed: 0.0102s/iter; left time: 8.4846s
Updating learning rate to 3.942703833125e-05
Epoch: 5 cost time: 2.8186826705932617
Epoch: 5, Steps: 257 | Train Loss: 0.6526135 Vali Loss: 0.3974061 Best vali loss: 0.3667353
	iters: 100, epoch: 6 | loss: 0.4217394
	speed: 0.0193s/iter; left time: 12.9611s
	iters: 200, epoch: 6 | loss: 0.7760280
	speed: 0.0104s/iter; left time: 5.9542s
Updating learning rate to 1.9713519165625e-05
Epoch: 6 cost time: 2.681245803833008
Epoch: 6, Steps: 257 | Train Loss: 0.5988837 Vali Loss: 0.3985985 Best vali loss: 0.3667353
	iters: 100, epoch: 7 | loss: 0.6961509
	speed: 0.0231s/iter; left time: 9.5917s
	iters: 200, epoch: 7 | loss: 0.2654155
	speed: 0.0107s/iter; left time: 3.3585s
Updating learning rate to 9.8567595828125e-06
Epoch: 7 cost time: 2.877932548522949
Epoch: 7, Steps: 257 | Train Loss: 0.4807832 Vali Loss: 0.3991354 Best vali loss: 0.3667353
	iters: 100, epoch: 8 | loss: 0.6467652
	speed: 0.0217s/iter; left time: 3.4268s
	iters: 200, epoch: 8 | loss: 0.4130757
	speed: 0.0103s/iter; left time: 0.6002s
Updating learning rate to 4.92837979140625e-06
Epoch: 8 cost time: 2.755061626434326
Epoch: 8, Steps: 257 | Train Loss: 0.5299204 Vali Loss: 0.3984466 Best vali loss: 0.3667353

best validation loss 0.36673532328577546

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0084698317464, 'e_layers': 1, 'learning_rate': 0.0005923265018, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0835372
	speed: 0.0111s/iter; left time: 10.3204s
Updating learning rate to 0.0005923265018
Validation loss decreased (inf --> 0.3679).  Saving model state dict ...
Epoch: 1 cost time: 1.002570629119873
Epoch: 1, Steps: 129 | Train Loss: 1.0835372 Vali Loss: 0.3679184 Best vali loss: 0.3679184
	iters: 100, epoch: 2 | loss: 0.7972184
	speed: 0.0118s/iter; left time: 9.4711s
Updating learning rate to 0.0002961632509
Epoch: 2 cost time: 0.961799144744873
Epoch: 2, Steps: 129 | Train Loss: 0.7972184 Vali Loss: 0.3703445 Best vali loss: 0.3679184
	iters: 100, epoch: 3 | loss: 0.5654021
	speed: 0.0117s/iter; left time: 7.8792s
Updating learning rate to 0.00014808162545
Epoch: 3 cost time: 0.8869094848632812
Epoch: 3, Steps: 129 | Train Loss: 0.5654021 Vali Loss: 0.3686969 Best vali loss: 0.3679184
	iters: 100, epoch: 4 | loss: 0.5640842
	speed: 0.0130s/iter; left time: 7.1114s
Updating learning rate to 7.4040812725e-05
Validation loss decreased (0.3679 --> 0.3675).  Saving model state dict ...
Epoch: 4 cost time: 0.8812651634216309
Epoch: 4, Steps: 129 | Train Loss: 0.5640842 Vali Loss: 0.3674701 Best vali loss: 0.3674701
	iters: 100, epoch: 5 | loss: 0.5715104
	speed: 0.0117s/iter; left time: 4.8919s
Updating learning rate to 3.70204063625e-05
Epoch: 5 cost time: 0.9076032638549805
Epoch: 5, Steps: 129 | Train Loss: 0.5715104 Vali Loss: 0.3696318 Best vali loss: 0.3674701
	iters: 100, epoch: 6 | loss: 0.4833259
	speed: 0.0113s/iter; left time: 3.2468s
Updating learning rate to 1.851020318125e-05
Epoch: 6 cost time: 0.9424307346343994
Epoch: 6, Steps: 129 | Train Loss: 0.4833259 Vali Loss: 0.3691856 Best vali loss: 0.3674701
	iters: 100, epoch: 7 | loss: 0.6635648
	speed: 0.0126s/iter; left time: 2.0046s
Updating learning rate to 9.255101590625e-06
Epoch: 7 cost time: 0.869281530380249
Epoch: 7, Steps: 129 | Train Loss: 0.6635648 Vali Loss: 0.3689902 Best vali loss: 0.3674701
	iters: 100, epoch: 8 | loss: 0.7098581
	speed: 0.0120s/iter; left time: 0.3602s
Updating learning rate to 4.6275507953125e-06
Epoch: 8 cost time: 0.9358522891998291
Epoch: 8, Steps: 129 | Train Loss: 0.7098581 Vali Loss: 0.3691277 Best vali loss: 0.3674701

best validation loss 0.3674701022141575

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023296914435, 'e_layers': 2, 'learning_rate': 0.004671208744, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7661461
	speed: 0.0154s/iter; left time: 14.3520s
Updating learning rate to 0.004671208744
Validation loss decreased (inf --> 0.4271).  Saving model state dict ...
Epoch: 1 cost time: 1.4768719673156738
Epoch: 1, Steps: 129 | Train Loss: 0.7661461 Vali Loss: 0.4271001 Best vali loss: 0.4271001
	iters: 100, epoch: 2 | loss: 0.6870902
	speed: 0.0142s/iter; left time: 11.4463s
Updating learning rate to 0.002335604372
Validation loss decreased (0.4271 --> 0.3802).  Saving model state dict ...
Epoch: 2 cost time: 1.1391854286193848
Epoch: 2, Steps: 129 | Train Loss: 0.6870902 Vali Loss: 0.3801735 Best vali loss: 0.3801735
	iters: 100, epoch: 3 | loss: 0.6993922
	speed: 0.0161s/iter; left time: 10.8934s
Updating learning rate to 0.001167802186
Epoch: 3 cost time: 1.1275138854980469
Epoch: 3, Steps: 129 | Train Loss: 0.6993922 Vali Loss: 0.3864057 Best vali loss: 0.3801735

best validation loss 0.38017351728057114

{'batch_size': 128, 'd_core': 512, 'd_model': 512, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036401371545035456
Validation loss decreased (inf --> 0.3762).  Saving model state dict ...
Epoch: 1 cost time: 1.3137495517730713
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3762177 Best vali loss: 0.3762177
Updating learning rate to 0.00032299854101523116
Validation loss decreased (0.3762 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 0.684776782989502
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3694042 Best vali loss: 0.3694042
Updating learning rate to 0.00026161499459889523
Validation loss decreased (0.3694 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 0.8259365558624268
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3672797 Best vali loss: 0.3672797

best validation loss 0.3672797396749785

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061646239199, 'e_layers': 2, 'learning_rate': 6.25759351e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7111490
	speed: 0.0137s/iter; left time: 111.0826s
	iters: 200, epoch: 1 | loss: 0.4384674
	speed: 0.0065s/iter; left time: 52.1127s
	iters: 300, epoch: 1 | loss: 0.4037274
	speed: 0.0061s/iter; left time: 48.6259s
	iters: 400, epoch: 1 | loss: 0.5710264
	speed: 0.0056s/iter; left time: 43.9240s
	iters: 500, epoch: 1 | loss: 0.3557356
	speed: 0.0057s/iter; left time: 44.0971s
	iters: 600, epoch: 1 | loss: 0.5046949
	speed: 0.0056s/iter; left time: 42.2820s
	iters: 700, epoch: 1 | loss: 1.5358776
	speed: 0.0066s/iter; left time: 49.7414s
	iters: 800, epoch: 1 | loss: 0.5159311
	speed: 0.0066s/iter; left time: 49.0589s
	iters: 900, epoch: 1 | loss: 0.9142753
	speed: 0.0065s/iter; left time: 47.7530s
	iters: 1000, epoch: 1 | loss: 0.3371001
	speed: 0.0061s/iter; left time: 44.3273s
Updating learning rate to 6.0194280383322307e-05
Validation loss decreased (inf --> 0.3627).  Saving model state dict ...
Epoch: 1 cost time: 6.7641496658325195
Epoch: 1, Steps: 1027 | Train Loss: 0.6287985 Vali Loss: 0.3627446 Best vali loss: 0.3627446
	iters: 100, epoch: 2 | loss: 0.1947547
	speed: 0.0218s/iter; left time: 154.3447s
	iters: 200, epoch: 2 | loss: 0.2895146
	speed: 0.0070s/iter; left time: 48.5899s
	iters: 300, epoch: 2 | loss: 0.7321385
	speed: 0.0066s/iter; left time: 45.5642s
	iters: 400, epoch: 2 | loss: 0.3880974
	speed: 0.0070s/iter; left time: 47.5622s
	iters: 500, epoch: 2 | loss: 0.8232708
	speed: 0.0069s/iter; left time: 45.9336s
	iters: 600, epoch: 2 | loss: 0.3032978
	speed: 0.0066s/iter; left time: 43.7963s
	iters: 700, epoch: 2 | loss: 1.2216628
	speed: 0.0059s/iter; left time: 38.3581s
	iters: 800, epoch: 2 | loss: 0.9589158
	speed: 0.0052s/iter; left time: 33.1172s
	iters: 900, epoch: 2 | loss: 1.2024649
	speed: 0.0053s/iter; left time: 33.2601s
	iters: 1000, epoch: 2 | loss: 0.8583195
	speed: 0.0068s/iter; left time: 42.2627s
Updating learning rate to 5.341190157414965e-05
Epoch: 2 cost time: 6.6992621421813965
Epoch: 2, Steps: 1027 | Train Loss: 0.6972437 Vali Loss: 0.3702054 Best vali loss: 0.3627446
	iters: 100, epoch: 3 | loss: 0.6200384
	speed: 0.0216s/iter; left time: 131.1557s
	iters: 200, epoch: 3 | loss: 0.4719056
	speed: 0.0066s/iter; left time: 39.2025s
	iters: 300, epoch: 3 | loss: 0.2987539
	speed: 0.0060s/iter; left time: 35.0169s
	iters: 400, epoch: 3 | loss: 0.6660823
	speed: 0.0059s/iter; left time: 34.2330s
	iters: 500, epoch: 3 | loss: 0.7553136
	speed: 0.0060s/iter; left time: 33.9692s
	iters: 600, epoch: 3 | loss: 0.1570195
	speed: 0.0061s/iter; left time: 33.8952s
	iters: 700, epoch: 3 | loss: 0.2997153
	speed: 0.0066s/iter; left time: 36.1360s
	iters: 800, epoch: 3 | loss: 0.3133707
	speed: 0.0064s/iter; left time: 34.2762s
	iters: 900, epoch: 3 | loss: 0.2497149
	speed: 0.0072s/iter; left time: 37.7670s
	iters: 1000, epoch: 3 | loss: 0.4589372
	speed: 0.0058s/iter; left time: 29.9439s
Updating learning rate to 4.326135436376155e-05
Validation loss decreased (0.3627 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 6.433751583099365
Epoch: 3, Steps: 1027 | Train Loss: 0.4290851 Vali Loss: 0.3542163 Best vali loss: 0.3542163

best validation loss 0.354216306113541

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061646239199, 'e_layers': 2, 'learning_rate': 6.25759351e-05, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7667804
	speed: 0.0136s/iter; left time: 68.3990s
	iters: 200, epoch: 4 | loss: 0.3944925
	speed: 0.0064s/iter; left time: 31.5218s
	iters: 300, epoch: 4 | loss: 0.4043091
	speed: 0.0070s/iter; left time: 33.8437s
	iters: 400, epoch: 4 | loss: 0.4707483
	speed: 0.0069s/iter; left time: 32.8688s
	iters: 500, epoch: 4 | loss: 0.3784989
	speed: 0.0051s/iter; left time: 23.8571s
	iters: 600, epoch: 4 | loss: 0.4186913
	speed: 0.0054s/iter; left time: 24.4002s
	iters: 700, epoch: 4 | loss: 0.9119259
	speed: 0.0085s/iter; left time: 37.5145s
	iters: 800, epoch: 4 | loss: 0.4121449
	speed: 0.0078s/iter; left time: 33.9043s
	iters: 900, epoch: 4 | loss: 0.8298687
	speed: 0.0066s/iter; left time: 28.1592s
	iters: 1000, epoch: 4 | loss: 0.3174953
	speed: 0.0059s/iter; left time: 24.5054s
Updating learning rate to 3.128796755e-05
Epoch: 4 cost time: 7.156444549560547
Epoch: 4, Steps: 1027 | Train Loss: 0.5304955 Vali Loss: 0.3887090 Best vali loss: 0.3542163
	iters: 100, epoch: 5 | loss: 0.3176049
	speed: 0.0206s/iter; left time: 82.7110s
	iters: 200, epoch: 5 | loss: 0.2800747
	speed: 0.0069s/iter; left time: 26.8361s
	iters: 300, epoch: 5 | loss: 0.3978724
	speed: 0.0068s/iter; left time: 25.9754s
	iters: 400, epoch: 5 | loss: 0.3476269
	speed: 0.0056s/iter; left time: 20.6935s
	iters: 500, epoch: 5 | loss: 0.7207177
	speed: 0.0047s/iter; left time: 17.1170s
	iters: 600, epoch: 5 | loss: 0.2956559
	speed: 0.0042s/iter; left time: 14.6054s
	iters: 700, epoch: 5 | loss: 1.0727452
	speed: 0.0039s/iter; left time: 13.4245s
	iters: 800, epoch: 5 | loss: 0.7496068
	speed: 0.0087s/iter; left time: 28.8902s
	iters: 900, epoch: 5 | loss: 1.0635135
	speed: 0.0094s/iter; left time: 30.2056s
	iters: 1000, epoch: 5 | loss: 0.5929466
	speed: 0.0077s/iter; left time: 24.0848s
Updating learning rate to 1.931458073623845e-05
Epoch: 5 cost time: 6.656551122665405
Epoch: 5, Steps: 1027 | Train Loss: 0.5838365 Vali Loss: 0.3967588 Best vali loss: 0.3542163
	iters: 100, epoch: 6 | loss: 0.5032743
	speed: 0.0187s/iter; left time: 55.7040s
	iters: 200, epoch: 6 | loss: 0.3946274
	speed: 0.0063s/iter; left time: 18.1474s
	iters: 300, epoch: 6 | loss: 0.2278214
	speed: 0.0072s/iter; left time: 19.9330s
	iters: 400, epoch: 6 | loss: 0.6986914
	speed: 0.0070s/iter; left time: 18.7266s
	iters: 500, epoch: 6 | loss: 0.5143505
	speed: 0.0055s/iter; left time: 14.1671s
	iters: 600, epoch: 6 | loss: 0.1569076
	speed: 0.0052s/iter; left time: 12.9532s
	iters: 700, epoch: 6 | loss: 0.2927359
	speed: 0.0063s/iter; left time: 14.9396s
	iters: 800, epoch: 6 | loss: 0.3045433
	speed: 0.0059s/iter; left time: 13.5314s
	iters: 900, epoch: 6 | loss: 0.2527259
	speed: 0.0071s/iter; left time: 15.5527s
	iters: 1000, epoch: 6 | loss: 0.4821668
	speed: 0.0099s/iter; left time: 20.6407s
Updating learning rate to 9.164033525850352e-06
Epoch: 6 cost time: 7.021959543228149
Epoch: 6, Steps: 1027 | Train Loss: 0.3827845 Vali Loss: 0.3850518 Best vali loss: 0.3542163
	iters: 100, epoch: 7 | loss: 0.2885893
	speed: 0.0218s/iter; left time: 42.6692s
	iters: 200, epoch: 7 | loss: 0.3734422
	speed: 0.0109s/iter; left time: 20.1547s
	iters: 300, epoch: 7 | loss: 0.2554817
	speed: 0.0086s/iter; left time: 15.1440s
	iters: 400, epoch: 7 | loss: 0.5270007
	speed: 0.0079s/iter; left time: 13.1091s
	iters: 500, epoch: 7 | loss: 0.6300895
	speed: 0.0079s/iter; left time: 12.2812s
	iters: 600, epoch: 7 | loss: 0.8291484
	speed: 0.0069s/iter; left time: 10.0484s
	iters: 700, epoch: 7 | loss: 0.2180324
	speed: 0.0087s/iter; left time: 11.7859s
	iters: 800, epoch: 7 | loss: 0.7309716
	speed: 0.0100s/iter; left time: 12.5215s
	iters: 900, epoch: 7 | loss: 0.3347633
	speed: 0.0111s/iter; left time: 12.7780s
	iters: 1000, epoch: 7 | loss: 0.2028333
	speed: 0.0081s/iter; left time: 8.5420s
Updating learning rate to 2.3816547166776904e-06
Epoch: 7 cost time: 8.986115217208862
Epoch: 7, Steps: 1027 | Train Loss: 0.4390352 Vali Loss: 0.3824251 Best vali loss: 0.3542163
	iters: 100, epoch: 8 | loss: 0.3873978
	speed: 0.0197s/iter; left time: 18.3142s
	iters: 200, epoch: 8 | loss: 0.6326537
	speed: 0.0072s/iter; left time: 5.9665s
	iters: 300, epoch: 8 | loss: 0.3890823
	speed: 0.0076s/iter; left time: 5.4981s
	iters: 400, epoch: 8 | loss: 0.2119599
	speed: 0.0066s/iter; left time: 4.1135s
	iters: 500, epoch: 8 | loss: 0.8618110
	speed: 0.0077s/iter; left time: 4.0757s
	iters: 600, epoch: 8 | loss: 0.3728515
	speed: 0.0074s/iter; left time: 3.1815s
	iters: 700, epoch: 8 | loss: 0.8245818
	speed: 0.0070s/iter; left time: 2.3057s
	iters: 800, epoch: 8 | loss: 0.6585020
	speed: 0.0068s/iter; left time: 1.5435s
	iters: 900, epoch: 8 | loss: 0.1850949
	speed: 0.0080s/iter; left time: 1.0180s
	iters: 1000, epoch: 8 | loss: 0.4205290
	speed: 0.0077s/iter; left time: 0.2143s
Updating learning rate to 0.0
Epoch: 8 cost time: 7.549533367156982
Epoch: 8, Steps: 1027 | Train Loss: 0.4944464 Vali Loss: 0.3842234 Best vali loss: 0.3542163

best validation loss 0.354216306113541

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0018990416299, 'e_layers': 3, 'learning_rate': 0.000236713365, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4083863
	speed: 0.0147s/iter; left time: 119.4457s
	iters: 200, epoch: 1 | loss: 0.6920639
	speed: 0.0093s/iter; left time: 74.7769s
	iters: 300, epoch: 1 | loss: 0.2906237
	speed: 0.0087s/iter; left time: 68.7666s
	iters: 400, epoch: 1 | loss: 0.9178091
	speed: 0.0083s/iter; left time: 64.5204s
	iters: 500, epoch: 1 | loss: 0.9813206
	speed: 0.0118s/iter; left time: 91.2958s
	iters: 600, epoch: 1 | loss: 0.7878883
	speed: 0.0108s/iter; left time: 82.3615s
	iters: 700, epoch: 1 | loss: 0.3036508
	speed: 0.0101s/iter; left time: 75.9458s
	iters: 800, epoch: 1 | loss: 0.3327278
	speed: 0.0100s/iter; left time: 73.9785s
	iters: 900, epoch: 1 | loss: 0.9705958
	speed: 0.0104s/iter; left time: 75.7590s
	iters: 1000, epoch: 1 | loss: 0.8515942
	speed: 0.0081s/iter; left time: 58.7034s
Updating learning rate to 0.000236713365
Validation loss decreased (inf --> 0.3776).  Saving model state dict ...
Epoch: 1 cost time: 10.127201795578003
Epoch: 1, Steps: 1027 | Train Loss: 0.6536660 Vali Loss: 0.3775733 Best vali loss: 0.3775733
	iters: 100, epoch: 2 | loss: 1.1957713
	speed: 0.0358s/iter; left time: 253.6151s
	iters: 200, epoch: 2 | loss: 1.3961279
	speed: 0.0131s/iter; left time: 91.7179s
	iters: 300, epoch: 2 | loss: 0.5063996
	speed: 0.0120s/iter; left time: 82.6952s
	iters: 400, epoch: 2 | loss: 0.2872636
	speed: 0.0138s/iter; left time: 93.4473s
	iters: 500, epoch: 2 | loss: 1.2195693
	speed: 0.0137s/iter; left time: 91.6549s
	iters: 600, epoch: 2 | loss: 0.5077180
	speed: 0.0131s/iter; left time: 86.1929s
	iters: 700, epoch: 2 | loss: 0.4383077
	speed: 0.0138s/iter; left time: 89.5986s
	iters: 800, epoch: 2 | loss: 0.2447689
	speed: 0.0112s/iter; left time: 71.8383s
	iters: 900, epoch: 2 | loss: 0.3800808
	speed: 0.0073s/iter; left time: 46.1780s
	iters: 1000, epoch: 2 | loss: 0.9318529
	speed: 0.0065s/iter; left time: 40.4445s
Updating learning rate to 0.0001183566825
Validation loss decreased (0.3776 --> 0.3743).  Saving model state dict ...
Epoch: 2 cost time: 11.898943901062012
Epoch: 2, Steps: 1027 | Train Loss: 0.7107860 Vali Loss: 0.3743217 Best vali loss: 0.3743217
	iters: 100, epoch: 3 | loss: 0.2931409
	speed: 0.0241s/iter; left time: 146.0189s
	iters: 200, epoch: 3 | loss: 0.2982795
	speed: 0.0068s/iter; left time: 40.7799s
	iters: 300, epoch: 3 | loss: 0.8747692
	speed: 0.0082s/iter; left time: 48.1382s
	iters: 400, epoch: 3 | loss: 0.4422604
	speed: 0.0099s/iter; left time: 56.9272s
	iters: 500, epoch: 3 | loss: 1.0496476
	speed: 0.0100s/iter; left time: 56.6640s
	iters: 600, epoch: 3 | loss: 0.6557347
	speed: 0.0095s/iter; left time: 52.6767s
	iters: 700, epoch: 3 | loss: 1.1283998
	speed: 0.0097s/iter; left time: 52.8957s
	iters: 800, epoch: 3 | loss: 0.7730457
	speed: 0.0087s/iter; left time: 46.4912s
	iters: 900, epoch: 3 | loss: 0.1883674
	speed: 0.0095s/iter; left time: 50.0343s
	iters: 1000, epoch: 3 | loss: 0.3466583
	speed: 0.0099s/iter; left time: 51.0405s
Updating learning rate to 5.917834125e-05
Epoch: 3 cost time: 9.474964618682861
Epoch: 3, Steps: 1027 | Train Loss: 0.6050304 Vali Loss: 0.3745530 Best vali loss: 0.3743217
	iters: 100, epoch: 4 | loss: 0.3502361
	speed: 0.0274s/iter; left time: 138.0132s
	iters: 200, epoch: 4 | loss: 0.2939960
	speed: 0.0096s/iter; left time: 47.3198s
	iters: 300, epoch: 4 | loss: 0.9357637
	speed: 0.0089s/iter; left time: 43.1458s
	iters: 400, epoch: 4 | loss: 0.4075991
	speed: 0.0098s/iter; left time: 46.4996s
	iters: 500, epoch: 4 | loss: 0.5163213
	speed: 0.0098s/iter; left time: 45.5100s
	iters: 600, epoch: 4 | loss: 0.7447742
	speed: 0.0089s/iter; left time: 40.5287s
	iters: 700, epoch: 4 | loss: 0.1326635
	speed: 0.0074s/iter; left time: 32.8096s
	iters: 800, epoch: 4 | loss: 0.3120176
	speed: 0.0102s/iter; left time: 44.2881s
	iters: 900, epoch: 4 | loss: 0.4273858
	speed: 0.0091s/iter; left time: 38.3654s
	iters: 1000, epoch: 4 | loss: 0.5256569
	speed: 0.0104s/iter; left time: 43.0965s
Updating learning rate to 2.9589170625e-05
Validation loss decreased (0.3743 --> 0.3597).  Saving model state dict ...
Epoch: 4 cost time: 9.632462501525879
Epoch: 4, Steps: 1027 | Train Loss: 0.4646414 Vali Loss: 0.3596931 Best vali loss: 0.3596931
	iters: 100, epoch: 5 | loss: 0.4407480
	speed: 0.0277s/iter; left time: 110.9314s
	iters: 200, epoch: 5 | loss: 0.2338771
	speed: 0.0085s/iter; left time: 33.2155s
	iters: 300, epoch: 5 | loss: 0.3205912
	speed: 0.0095s/iter; left time: 36.1254s
	iters: 400, epoch: 5 | loss: 0.8725641
	speed: 0.0085s/iter; left time: 31.6826s
	iters: 500, epoch: 5 | loss: 0.3890834
	speed: 0.0080s/iter; left time: 28.9105s
	iters: 600, epoch: 5 | loss: 0.6942031
	speed: 0.0087s/iter; left time: 30.5186s
	iters: 700, epoch: 5 | loss: 0.4406816
	speed: 0.0089s/iter; left time: 30.4031s
	iters: 800, epoch: 5 | loss: 1.1280010
	speed: 0.0090s/iter; left time: 29.9202s
	iters: 900, epoch: 5 | loss: 0.7702875
	speed: 0.0094s/iter; left time: 30.1351s
	iters: 1000, epoch: 5 | loss: 0.5490461
	speed: 0.0090s/iter; left time: 28.1326s
Updating learning rate to 1.47945853125e-05
Epoch: 5 cost time: 8.98929738998413
Epoch: 5, Steps: 1027 | Train Loss: 0.5839083 Vali Loss: 0.3785621 Best vali loss: 0.3596931
	iters: 100, epoch: 6 | loss: 1.0008798
	speed: 0.0261s/iter; left time: 77.8264s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0047486145421, 'e_layers': 3, 'learning_rate': 0.0019208975706, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7586533
	speed: 0.0153s/iter; left time: 14.2419s
Updating learning rate to 0.0019208975706
Validation loss decreased (inf --> 0.3879).  Saving model state dict ...
Epoch: 1 cost time: 1.4575302600860596
Epoch: 1, Steps: 129 | Train Loss: 0.7586533 Vali Loss: 0.3879269 Best vali loss: 0.3879269
	iters: 100, epoch: 2 | loss: 0.7932025
	speed: 0.0145s/iter; left time: 11.6181s
Updating learning rate to 0.0009604487853
Validation loss decreased (0.3879 --> 0.3722).  Saving model state dict ...
Epoch: 2 cost time: 1.1413636207580566
Epoch: 2, Steps: 129 | Train Loss: 0.7932025 Vali Loss: 0.3721994 Best vali loss: 0.3721994
	iters: 100, epoch: 3 | loss: 0.4432413
	speed: 0.0145s/iter; left time: 9.7713s
Updating learning rate to 0.00048022439265
Validation loss decreased (0.3722 --> 0.3652).  Saving model state dict ...
Epoch: 3 cost time: 1.1563167572021484
Epoch: 3, Steps: 129 | Train Loss: 0.4432413 Vali Loss: 0.3652117 Best vali loss: 0.3652117
	iters: 100, epoch: 4 | loss: 0.5863644
	speed: 0.0165s/iter; left time: 8.9910s
Updating learning rate to 0.000240112196325
Epoch: 4 cost time: 1.2497162818908691
Epoch: 4, Steps: 129 | Train Loss: 0.5863644 Vali Loss: 0.3792543 Best vali loss: 0.3652117
	iters: 100, epoch: 5 | loss: 0.5235679
	speed: 0.0146s/iter; left time: 6.0983s
Updating learning rate to 0.0001200560981625
Epoch: 5 cost time: 1.1609864234924316
Epoch: 5, Steps: 129 | Train Loss: 0.5235679 Vali Loss: 0.3793821 Best vali loss: 0.3652117
	iters: 100, epoch: 6 | loss: 0.5928576
	speed: 0.0145s/iter; left time: 4.1684s
Updating learning rate to 6.002804908125e-05
Epoch: 6 cost time: 1.1331121921539307
Epoch: 6, Steps: 129 | Train Loss: 0.5928576 Vali Loss: 0.3797608 Best vali loss: 0.3652117
	iters: 100, epoch: 7 | loss: 0.5370938
	speed: 0.0258s/iter; left time: 4.0956s
Updating learning rate to 3.0014024540625e-05
Epoch: 7 cost time: 2.266160726547241
Epoch: 7, Steps: 129 | Train Loss: 0.5370938 Vali Loss: 0.3786626 Best vali loss: 0.3652117
	iters: 100, epoch: 8 | loss: 0.8624080
	speed: 0.0230s/iter; left time: 0.6890s
Updating learning rate to 1.50070122703125e-05
Epoch: 8 cost time: 2.2732994556427
Epoch: 8, Steps: 129 | Train Loss: 0.8624080 Vali Loss: 0.3822751 Best vali loss: 0.3652117

best validation loss 0.36521174927591576

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4684568
	speed: 0.0252s/iter; left time: 49.3816s
	iters: 200, epoch: 1 | loss: 0.7530123
	speed: 0.0184s/iter; left time: 34.1393s
Updating learning rate to 0.0009753388759
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 5.019519090652466
Epoch: 1, Steps: 257 | Train Loss: 0.6107346 Vali Loss: 0.3799940 Best vali loss: 0.3799940
	iters: 100, epoch: 2 | loss: 0.2796961
	speed: 0.0420s/iter; left time: 71.4437s
	iters: 200, epoch: 2 | loss: 0.5393955
	speed: 0.0185s/iter; left time: 29.5915s
Updating learning rate to 0.00048766943795
Epoch: 2 cost time: 4.659916639328003
Epoch: 2, Steps: 257 | Train Loss: 0.4095458 Vali Loss: 0.3960830 Best vali loss: 0.3799940
	iters: 100, epoch: 3 | loss: 0.9943225
	speed: 0.0364s/iter; left time: 52.5604s
	iters: 200, epoch: 3 | loss: 0.8060923
	speed: 0.0182s/iter; left time: 24.4166s
Updating learning rate to 0.000243834718975
Epoch: 3 cost time: 4.248380184173584
Epoch: 3, Steps: 257 | Train Loss: 0.9002074 Vali Loss: 0.3923599 Best vali loss: 0.3799940

best validation loss 0.37999402722581666

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0011769656897, 'e_layers': 3, 'learning_rate': 8.6782891e-05, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 8.347991388352898e-05
Validation loss decreased (inf --> 0.4364).  Saving model state dict ...
Epoch: 1 cost time: 0.8075580596923828
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4363920 Best vali loss: 0.4363920
Updating learning rate to 7.40738308585365e-05
Validation loss decreased (0.4364 --> 0.4239).  Saving model state dict ...
Epoch: 2 cost time: 0.5236515998840332
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4238642 Best vali loss: 0.4238642
Updating learning rate to 5.999663279922273e-05
Validation loss decreased (0.4239 --> 0.4149).  Saving model state dict ...
Epoch: 3 cost time: 0.6557471752166748
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4149056 Best vali loss: 0.4149056

best validation loss 0.4149055884605775

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.006224374191, 'e_layers': 1, 'learning_rate': 0.0004730775791, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6014417
	speed: 0.0229s/iter; left time: 21.3987s
Updating learning rate to 0.00045507213586023967
Validation loss decreased (inf --> 0.3851).  Saving model state dict ...
Epoch: 1 cost time: 2.3448493480682373
Epoch: 1, Steps: 129 | Train Loss: 0.6014417 Vali Loss: 0.3851398 Best vali loss: 0.3851398
	iters: 100, epoch: 2 | loss: 0.6089329
	speed: 0.0276s/iter; left time: 22.1804s
Updating learning rate to 0.00040379697165446267
Validation loss decreased (0.3851 --> 0.3701).  Saving model state dict ...
Epoch: 2 cost time: 2.098444700241089
Epoch: 2, Steps: 129 | Train Loss: 0.6089329 Vali Loss: 0.3700741 Best vali loss: 0.3700741
	iters: 100, epoch: 3 | loss: 0.5485960
	speed: 0.0305s/iter; left time: 20.5907s
Updating learning rate to 0.00032705826542247764
Validation loss decreased (0.3701 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 2.3956682682037354
Epoch: 3, Steps: 129 | Train Loss: 0.5485960 Vali Loss: 0.3683827 Best vali loss: 0.3683827

best validation loss 0.3683827413205782

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.006224374191, 'e_layers': 1, 'learning_rate': 0.0004730775791, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5551022
	speed: 0.0248s/iter; left time: 13.5512s
Updating learning rate to 0.00023653878955
Validation loss decreased (0.3684 --> 0.3676).  Saving model state dict ...
Epoch: 4 cost time: 2.460418462753296
Epoch: 4, Steps: 129 | Train Loss: 0.5551022 Vali Loss: 0.3675629 Best vali loss: 0.3675629
	iters: 100, epoch: 5 | loss: 0.5602945
	speed: 0.0467s/iter; left time: 19.4776s
Updating learning rate to 0.00014601931367752238
Epoch: 5 cost time: 3.6639621257781982
Epoch: 5, Steps: 129 | Train Loss: 0.5602945 Vali Loss: 0.3681020 Best vali loss: 0.3675629
	iters: 100, epoch: 6 | loss: 0.5434238
	speed: 0.0578s/iter; left time: 16.6599s
Updating learning rate to 6.928060744553735e-05
Epoch: 6 cost time: 3.7878060340881348
Epoch: 6, Steps: 129 | Train Loss: 0.5434238 Vali Loss: 0.3704287 Best vali loss: 0.3675629
	iters: 100, epoch: 7 | loss: 0.5038385
	speed: 0.0540s/iter; left time: 8.5831s
Updating learning rate to 1.8005443239760363e-05
Epoch: 7 cost time: 3.6967151165008545
Epoch: 7, Steps: 129 | Train Loss: 0.5038385 Vali Loss: 0.3693735 Best vali loss: 0.3675629
	iters: 100, epoch: 8 | loss: 0.6227677
	speed: 0.0553s/iter; left time: 1.6603s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.8650434017181396
Epoch: 8, Steps: 129 | Train Loss: 0.6227677 Vali Loss: 0.3697423 Best vali loss: 0.3675629

best validation loss 0.3675628589038062

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.004626087804, 'e_layers': 2, 'learning_rate': 0.0002001097151, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8025144
	speed: 0.0311s/iter; left time: 29.0235s
Updating learning rate to 0.0002001097151
Validation loss decreased (inf --> 0.3662).  Saving model state dict ...
Epoch: 1 cost time: 3.5210278034210205
Epoch: 1, Steps: 129 | Train Loss: 0.8025144 Vali Loss: 0.3662000 Best vali loss: 0.3662000
	iters: 100, epoch: 2 | loss: 0.7830365
	speed: 0.0563s/iter; left time: 45.2291s
Updating learning rate to 0.00010005485755
Epoch: 2 cost time: 3.9551005363464355
Epoch: 2, Steps: 129 | Train Loss: 0.7830365 Vali Loss: 0.3686649 Best vali loss: 0.3662000
	iters: 100, epoch: 3 | loss: 0.6814547
	speed: 0.0591s/iter; left time: 39.8899s
Updating learning rate to 5.0027428775e-05
Validation loss decreased (0.3662 --> 0.3592).  Saving model state dict ...
Epoch: 3 cost time: 3.8066227436065674
Epoch: 3, Steps: 129 | Train Loss: 0.6814547 Vali Loss: 0.3592204 Best vali loss: 0.3592204
	iters: 100, epoch: 4 | loss: 0.4300409
	speed: 0.0532s/iter; left time: 29.0611s
Updating learning rate to 2.50137143875e-05
Validation loss decreased (0.3592 --> 0.3591).  Saving model state dict ...
Epoch: 4 cost time: 2.9576499462127686
Epoch: 4, Steps: 129 | Train Loss: 0.4300409 Vali Loss: 0.3591219 Best vali loss: 0.3591219
	iters: 100, epoch: 5 | loss: 0.4921041
	speed: 0.0322s/iter; left time: 13.4117s
Updating learning rate to 1.250685719375e-05
Validation loss decreased (0.3591 --> 0.3551).  Saving model state dict ...
Epoch: 5 cost time: 3.3086001873016357
Epoch: 5, Steps: 129 | Train Loss: 0.4921041 Vali Loss: 0.3551242 Best vali loss: 0.3551242
	iters: 100, epoch: 6 | loss: 0.4829676
	speed: 0.0513s/iter; left time: 14.7708s
Updating learning rate to 6.253428596875e-06
Validation loss decreased (0.3551 --> 0.3547).  Saving model state dict ...
Epoch: 6 cost time: 3.762840509414673
Epoch: 6, Steps: 129 | Train Loss: 0.4829676 Vali Loss: 0.3547405 Best vali loss: 0.3547405
	iters: 100, epoch: 7 | loss: 0.3856917
	speed: 0.0605s/iter; left time: 9.6260s
Updating learning rate to 3.1267142984375e-06
Epoch: 7 cost time: 3.759007692337036
Epoch: 7, Steps: 129 | Train Loss: 0.3856917 Vali Loss: 0.3560569 Best vali loss: 0.3547405
	iters: 100, epoch: 8 | loss: 0.4688978
	speed: 0.0376s/iter; left time: 1.1272s
Updating learning rate to 1.56335714921875e-06
Epoch: 8 cost time: 2.9456417560577393
Epoch: 8, Steps: 129 | Train Loss: 0.4688978 Vali Loss: 0.3550037 Best vali loss: 0.3547405

best validation loss 0.3547404554363318

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0033708130675, 'e_layers': 2, 'learning_rate': 8.41453631e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4147574
	speed: 0.0222s/iter; left time: 180.3085s
	iters: 200, epoch: 1 | loss: 0.5649698
	speed: 0.0122s/iter; left time: 97.9564s
	iters: 300, epoch: 1 | loss: 1.0839422
	speed: 0.0112s/iter; left time: 88.7471s
	iters: 400, epoch: 1 | loss: 1.1432850
	speed: 0.0117s/iter; left time: 91.3096s
	iters: 500, epoch: 1 | loss: 0.9568286
	speed: 0.0085s/iter; left time: 65.9441s
	iters: 600, epoch: 1 | loss: 0.2372679
	speed: 0.0125s/iter; left time: 95.4792s
	iters: 700, epoch: 1 | loss: 0.7027467
	speed: 0.0078s/iter; left time: 58.3775s
	iters: 800, epoch: 1 | loss: 0.4816240
	speed: 0.0058s/iter; left time: 42.6991s
	iters: 900, epoch: 1 | loss: 0.3806331
	speed: 0.0065s/iter; left time: 47.2098s
	iters: 1000, epoch: 1 | loss: 0.6020632
	speed: 0.0058s/iter; left time: 42.0250s
Updating learning rate to 8.094277091191025e-05
Validation loss decreased (inf --> 0.3789).  Saving model state dict ...
Epoch: 1 cost time: 10.253929615020752
Epoch: 1, Steps: 1027 | Train Loss: 0.6568118 Vali Loss: 0.3789459 Best vali loss: 0.3789459
	iters: 100, epoch: 2 | loss: 0.4131598
	speed: 0.0158s/iter; left time: 112.1308s
	iters: 200, epoch: 2 | loss: 1.1948470
	speed: 0.0049s/iter; left time: 34.5808s
	iters: 300, epoch: 2 | loss: 0.3301001
	speed: 0.0061s/iter; left time: 41.6899s
	iters: 400, epoch: 2 | loss: 0.1938480
	speed: 0.0062s/iter; left time: 42.1831s
	iters: 500, epoch: 2 | loss: 0.4590715
	speed: 0.0046s/iter; left time: 30.7394s
	iters: 600, epoch: 2 | loss: 0.3780791
	speed: 0.0052s/iter; left time: 34.1233s
	iters: 700, epoch: 2 | loss: 1.0085310
	speed: 0.0056s/iter; left time: 36.4492s
	iters: 800, epoch: 2 | loss: 0.6451042
	speed: 0.0058s/iter; left time: 37.0745s
	iters: 900, epoch: 2 | loss: 0.3510500
	speed: 0.0083s/iter; left time: 52.2304s
	iters: 1000, epoch: 2 | loss: 1.0086994
	speed: 0.0080s/iter; left time: 49.2918s
Updating learning rate to 7.182255997670715e-05
Validation loss decreased (0.3789 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 6.079772233963013
Epoch: 2, Steps: 1027 | Train Loss: 0.5982490 Vali Loss: 0.3682774 Best vali loss: 0.3682774
	iters: 100, epoch: 3 | loss: 0.2273949
	speed: 0.0181s/iter; left time: 109.6482s
	iters: 200, epoch: 3 | loss: 0.4375920
	speed: 0.0062s/iter; left time: 37.0736s
	iters: 300, epoch: 3 | loss: 0.4420758
	speed: 0.0053s/iter; left time: 30.8343s
	iters: 400, epoch: 3 | loss: 0.6387251
	speed: 0.0054s/iter; left time: 31.2058s
	iters: 500, epoch: 3 | loss: 0.2057318
	speed: 0.0045s/iter; left time: 25.5968s
	iters: 600, epoch: 3 | loss: 0.4045404
	speed: 0.0047s/iter; left time: 26.3270s
	iters: 700, epoch: 3 | loss: 0.4093519
	speed: 0.0062s/iter; left time: 33.8474s
	iters: 800, epoch: 3 | loss: 0.4989359
	speed: 0.0075s/iter; left time: 40.3931s
	iters: 900, epoch: 3 | loss: 0.4667025
	speed: 0.0073s/iter; left time: 38.2701s
	iters: 1000, epoch: 3 | loss: 0.9034653
	speed: 0.0079s/iter; left time: 40.6514s
Updating learning rate to 5.817319973435739e-05
Epoch: 3 cost time: 6.448943138122559
Epoch: 3, Steps: 1027 | Train Loss: 0.4634516 Vali Loss: 0.3704481 Best vali loss: 0.3682774
	iters: 100, epoch: 4 | loss: 0.2283182
	speed: 0.0206s/iter; left time: 103.8342s
	iters: 200, epoch: 4 | loss: 0.1832976
	speed: 0.0067s/iter; left time: 33.1975s
	iters: 300, epoch: 4 | loss: 1.7134072
	speed: 0.0053s/iter; left time: 25.7470s
	iters: 400, epoch: 4 | loss: 0.1918007
	speed: 0.0047s/iter; left time: 22.3435s
	iters: 500, epoch: 4 | loss: 0.5199234
	speed: 0.0055s/iter; left time: 25.4093s
	iters: 600, epoch: 4 | loss: 0.5398291
	speed: 0.0054s/iter; left time: 24.3686s
	iters: 700, epoch: 4 | loss: 0.6083031
	speed: 0.0050s/iter; left time: 22.2495s
	iters: 800, epoch: 4 | loss: 0.4678263
	speed: 0.0048s/iter; left time: 20.8190s
	iters: 900, epoch: 4 | loss: 0.2007151
	speed: 0.0046s/iter; left time: 19.5978s
	iters: 1000, epoch: 4 | loss: 2.0018373
	speed: 0.0066s/iter; left time: 27.2107s
Updating learning rate to 4.207268155e-05
Epoch: 4 cost time: 5.819631099700928
Epoch: 4, Steps: 1027 | Train Loss: 0.6655258 Vali Loss: 0.3700265 Best vali loss: 0.3682774
	iters: 100, epoch: 5 | loss: 0.4249993
	speed: 0.0211s/iter; left time: 84.6315s
	iters: 200, epoch: 5 | loss: 0.7703964
	speed: 0.0064s/iter; left time: 25.1988s
	iters: 300, epoch: 5 | loss: 0.6003953
	speed: 0.0066s/iter; left time: 24.9751s
	iters: 400, epoch: 5 | loss: 0.8922071
	speed: 0.0061s/iter; left time: 22.4718s
	iters: 500, epoch: 5 | loss: 0.8593289
	speed: 0.0053s/iter; left time: 19.0495s
	iters: 600, epoch: 5 | loss: 1.0732847
	speed: 0.0081s/iter; left time: 28.4254s
	iters: 700, epoch: 5 | loss: 0.3119774
	speed: 0.0069s/iter; left time: 23.3933s
	iters: 800, epoch: 5 | loss: 0.6238126
	speed: 0.0052s/iter; left time: 17.0506s
	iters: 900, epoch: 5 | loss: 0.5083687
	speed: 0.0051s/iter; left time: 16.3191s
	iters: 1000, epoch: 5 | loss: 0.2273571
	speed: 0.0062s/iter; left time: 19.1497s
Updating learning rate to 2.597216336564262e-05
Epoch: 5 cost time: 6.366571664810181
Epoch: 5, Steps: 1027 | Train Loss: 0.6292128 Vali Loss: 0.3706545 Best vali loss: 0.3682774
	iters: 100, epoch: 6 | loss: 0.2283585
	speed: 0.0208s/iter; left time: 61.9773s
	iters: 200, epoch: 6 | loss: 0.2376673
	speed: 0.0065s/iter; left time: 18.7652s
	iters: 300, epoch: 6 | loss: 0.2026396
	speed: 0.0067s/iter; left time: 18.6019s
	iters: 400, epoch: 6 | loss: 0.8345922
	speed: 0.0067s/iter; left time: 18.0836s
	iters: 500, epoch: 6 | loss: 0.5038351
	speed: 0.0064s/iter; left time: 16.4046s
	iters: 600, epoch: 6 | loss: 0.9328751
	speed: 0.0066s/iter; left time: 16.3171s
	iters: 700, epoch: 6 | loss: 0.2513996
	speed: 0.0062s/iter; left time: 14.7706s
	iters: 800, epoch: 6 | loss: 0.3186727
	speed: 0.0053s/iter; left time: 12.0156s
	iters: 900, epoch: 6 | loss: 0.6414838
	speed: 0.0060s/iter; left time: 13.1774s
	iters: 1000, epoch: 6 | loss: 0.5405474
	speed: 0.0067s/iter; left time: 14.0297s
Updating learning rate to 1.2322803123292859e-05
Epoch: 6 cost time: 6.5477800369262695
Epoch: 6, Steps: 1027 | Train Loss: 0.4692071 Vali Loss: 0.3711423 Best vali loss: 0.3682774
	iters: 100, epoch: 7 | loss: 0.1950988
	speed: 0.0195s/iter; left time: 38.1013s
	iters: 200, epoch: 7 | loss: 0.8890731
	speed: 0.0065s/iter; left time: 12.0521s
	iters: 300, epoch: 7 | loss: 0.4486478
	speed: 0.0065s/iter; left time: 11.3609s
	iters: 400, epoch: 7 | loss: 0.3707592
	speed: 0.0061s/iter; left time: 10.0798s
	iters: 500, epoch: 7 | loss: 0.4067803
	speed: 0.0064s/iter; left time: 10.0238s
	iters: 600, epoch: 7 | loss: 0.3960397
	speed: 0.0066s/iter; left time: 9.5315s
	iters: 700, epoch: 7 | loss: 1.1558625
	speed: 0.0062s/iter; left time: 8.3695s
	iters: 800, epoch: 7 | loss: 0.7815954
	speed: 0.0065s/iter; left time: 8.1612s
	iters: 900, epoch: 7 | loss: 0.2607532
	speed: 0.0065s/iter; left time: 7.5308s
	iters: 1000, epoch: 7 | loss: 0.3653066
	speed: 0.0065s/iter; left time: 6.8606s
Updating learning rate to 3.2025921880897614e-06
Epoch: 7 cost time: 6.6428093910217285
Epoch: 7, Steps: 1027 | Train Loss: 0.5269917 Vali Loss: 0.3713300 Best vali loss: 0.3682774
	iters: 100, epoch: 8 | loss: 0.4400818
	speed: 0.0213s/iter; left time: 19.7879s
	iters: 200, epoch: 8 | loss: 0.4297138
	speed: 0.0056s/iter; left time: 4.6226s
	iters: 300, epoch: 8 | loss: 1.3238173
	speed: 0.0061s/iter; left time: 4.4592s
	iters: 400, epoch: 8 | loss: 0.6434262
	speed: 0.0068s/iter; left time: 4.2943s
	iters: 500, epoch: 8 | loss: 0.9417768
	speed: 0.0063s/iter; left time: 3.3478s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0022002628646, 'e_layers': 2, 'learning_rate': 5.31978674e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6602362
	speed: 0.0158s/iter; left time: 14.7173s
Updating learning rate to 5.31978674e-05
Validation loss decreased (inf --> 0.3809).  Saving model state dict ...
Epoch: 1 cost time: 1.555647850036621
Epoch: 1, Steps: 129 | Train Loss: 0.6602362 Vali Loss: 0.3808799 Best vali loss: 0.3808799
	iters: 100, epoch: 2 | loss: 0.9485139
	speed: 0.0151s/iter; left time: 12.1526s
Updating learning rate to 2.65989337e-05
Validation loss decreased (0.3809 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 1.5312204360961914
Epoch: 2, Steps: 129 | Train Loss: 0.9485139 Vali Loss: 0.3689556 Best vali loss: 0.3689556
	iters: 100, epoch: 3 | loss: 0.5063257
	speed: 0.0306s/iter; left time: 20.6372s
Updating learning rate to 1.329946685e-05
Validation loss decreased (0.3690 --> 0.3661).  Saving model state dict ...
Epoch: 3 cost time: 2.5353643894195557
Epoch: 3, Steps: 129 | Train Loss: 0.5063257 Vali Loss: 0.3661245 Best vali loss: 0.3661245

best validation loss 0.3661244877077976

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083508181889, 'e_layers': 2, 'learning_rate': 0.001131171897, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7077596
	speed: 0.0260s/iter; left time: 24.2833s
Updating learning rate to 0.001131171897
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 2.8514187335968018
Epoch: 1, Steps: 129 | Train Loss: 0.7077596 Vali Loss: 0.3707081 Best vali loss: 0.3707081
	iters: 100, epoch: 2 | loss: 0.4794223
	speed: 0.0338s/iter; left time: 27.1481s
Updating learning rate to 0.0005655859485
Epoch: 2 cost time: 2.624173879623413
Epoch: 2, Steps: 129 | Train Loss: 0.4794223 Vali Loss: 0.3757822 Best vali loss: 0.3707081
	iters: 100, epoch: 3 | loss: 1.0030566
	speed: 0.0333s/iter; left time: 22.4578s
Updating learning rate to 0.00028279297425
Validation loss decreased (0.3707 --> 0.3650).  Saving model state dict ...
Epoch: 3 cost time: 2.5320334434509277
Epoch: 3, Steps: 129 | Train Loss: 1.0030566 Vali Loss: 0.3650445 Best vali loss: 0.3650445

best validation loss 0.36504454506169604

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020630177486, 'e_layers': 4, 'learning_rate': 9.2920321e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7147732
	speed: 0.0228s/iter; left time: 44.7055s
	iters: 200, epoch: 1 | loss: 0.4652977
	speed: 0.0141s/iter; left time: 26.2391s
Updating learning rate to 9.2920321e-05
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 3.737055778503418
Epoch: 1, Steps: 257 | Train Loss: 0.5900355 Vali Loss: 0.3743554 Best vali loss: 0.3743554
	iters: 100, epoch: 2 | loss: 0.6983820
	speed: 0.0176s/iter; left time: 29.9830s
	iters: 200, epoch: 2 | loss: 0.5791321
	speed: 0.0104s/iter; left time: 16.5788s
Updating learning rate to 4.64601605e-05
Validation loss decreased (0.3744 --> 0.3656).  Saving model state dict ...
Epoch: 2 cost time: 2.768289089202881
Epoch: 2, Steps: 257 | Train Loss: 0.6387571 Vali Loss: 0.3655679 Best vali loss: 0.3655679
	iters: 100, epoch: 3 | loss: 0.7953151
	speed: 0.0222s/iter; left time: 32.0184s
	iters: 200, epoch: 3 | loss: 1.0077022
	speed: 0.0075s/iter; left time: 10.0838s
Updating learning rate to 2.323008025e-05
Validation loss decreased (0.3656 --> 0.3646).  Saving model state dict ...
Epoch: 3 cost time: 2.48372745513916
Epoch: 3, Steps: 257 | Train Loss: 0.9015087 Vali Loss: 0.3645605 Best vali loss: 0.3645605

best validation loss 0.3645604621567754

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020630177486, 'e_layers': 4, 'learning_rate': 9.2920321e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6665298
	speed: 0.0203s/iter; left time: 24.0169s
	iters: 200, epoch: 4 | loss: 0.4509894
	speed: 0.0114s/iter; left time: 12.3423s
Updating learning rate to 1.1615040125e-05
Epoch: 4 cost time: 3.5889699459075928
Epoch: 4, Steps: 257 | Train Loss: 0.5587596 Vali Loss: 0.3655694 Best vali loss: 0.3645605
	iters: 100, epoch: 5 | loss: 0.6118474
	speed: 0.0215s/iter; left time: 19.9928s
	iters: 200, epoch: 5 | loss: 0.5570172
	speed: 0.0082s/iter; left time: 6.7693s
Updating learning rate to 5.8075200625e-06
Epoch: 5 cost time: 2.242384910583496
Epoch: 5, Steps: 257 | Train Loss: 0.5844323 Vali Loss: 0.3652969 Best vali loss: 0.3645605
	iters: 100, epoch: 6 | loss: 0.7690623
	speed: 0.0202s/iter; left time: 13.5748s
	iters: 200, epoch: 6 | loss: 0.9310625
	speed: 0.0099s/iter; left time: 5.6612s
Updating learning rate to 2.90376003125e-06
Epoch: 6 cost time: 2.5499751567840576
Epoch: 6, Steps: 257 | Train Loss: 0.8500624 Vali Loss: 0.3654936 Best vali loss: 0.3645605
	iters: 100, epoch: 7 | loss: 0.6012143
	speed: 0.0183s/iter; left time: 7.6121s
	iters: 200, epoch: 7 | loss: 0.8413408
	speed: 0.0094s/iter; left time: 2.9496s
Updating learning rate to 1.451880015625e-06
Epoch: 7 cost time: 2.443183183670044
Epoch: 7, Steps: 257 | Train Loss: 0.7212776 Vali Loss: 0.3654604 Best vali loss: 0.3645605
	iters: 100, epoch: 8 | loss: 0.6390588
	speed: 0.0271s/iter; left time: 4.2783s
	iters: 200, epoch: 8 | loss: 0.6376308
	speed: 0.0126s/iter; left time: 0.7324s
Updating learning rate to 7.259400078125e-07
Epoch: 8 cost time: 3.546339988708496
Epoch: 8, Steps: 257 | Train Loss: 0.6383448 Vali Loss: 0.3655629 Best vali loss: 0.3645605

best validation loss 0.3645604621567754

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0008576659619, 'e_layers': 3, 'learning_rate': 0.0013959247767, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4885992
	speed: 0.0200s/iter; left time: 80.3204s
	iters: 200, epoch: 1 | loss: 0.3423665
	speed: 0.0121s/iter; left time: 47.4810s
	iters: 300, epoch: 1 | loss: 0.5949544
	speed: 0.0130s/iter; left time: 49.4294s
	iters: 400, epoch: 1 | loss: 0.3586644
	speed: 0.0073s/iter; left time: 27.0345s
	iters: 500, epoch: 1 | loss: 0.6342241
	speed: 0.0068s/iter; left time: 24.7209s
Updating learning rate to 0.0013427955534092593
Validation loss decreased (inf --> 0.3680).  Saving model state dict ...
Epoch: 1 cost time: 5.714756011962891
Epoch: 1, Steps: 514 | Train Loss: 0.4837617 Vali Loss: 0.3679622 Best vali loss: 0.3679622
	iters: 100, epoch: 2 | loss: 0.8510928
	speed: 0.0145s/iter; left time: 50.6738s
	iters: 200, epoch: 2 | loss: 0.8912351
	speed: 0.0085s/iter; left time: 28.8482s
	iters: 300, epoch: 2 | loss: 0.4120980
	speed: 0.0105s/iter; left time: 34.4800s
	iters: 400, epoch: 2 | loss: 0.7686691
	speed: 0.0111s/iter; left time: 35.3978s
	iters: 500, epoch: 2 | loss: 0.6313403
	speed: 0.0106s/iter; left time: 32.9765s
Updating learning rate to 0.0011914963261654436
Epoch: 2 cost time: 4.899430751800537
Epoch: 2, Steps: 514 | Train Loss: 0.7108870 Vali Loss: 0.3721302 Best vali loss: 0.3679622
	iters: 100, epoch: 3 | loss: 0.5611488
	speed: 0.0219s/iter; left time: 65.4561s
	iters: 200, epoch: 3 | loss: 0.7151616
	speed: 0.0102s/iter; left time: 29.4172s
	iters: 300, epoch: 3 | loss: 0.8357407
	speed: 0.0108s/iter; left time: 30.0742s
	iters: 400, epoch: 3 | loss: 1.0157566
	speed: 0.0108s/iter; left time: 29.0484s
	iters: 500, epoch: 3 | loss: 0.3502589
	speed: 0.0108s/iter; left time: 27.8422s
Updating learning rate to 0.0009650610307855138
Epoch: 3 cost time: 5.471624851226807
Epoch: 3, Steps: 514 | Train Loss: 0.6956133 Vali Loss: 0.3768401 Best vali loss: 0.3679622
	iters: 100, epoch: 4 | loss: 0.2980080
	speed: 0.0197s/iter; left time: 48.6262s
	iters: 200, epoch: 4 | loss: 0.9959555
	speed: 0.0101s/iter; left time: 23.9580s
	iters: 300, epoch: 4 | loss: 0.4843822
	speed: 0.0090s/iter; left time: 20.4926s
	iters: 400, epoch: 4 | loss: 0.7475793
	speed: 0.0085s/iter; left time: 18.4597s
	iters: 500, epoch: 4 | loss: 0.4832364
	speed: 0.0112s/iter; left time: 23.1967s
Updating learning rate to 0.00069796238835
Epoch: 4 cost time: 5.037376165390015
Epoch: 4, Steps: 514 | Train Loss: 0.6018323 Vali Loss: 0.3699806 Best vali loss: 0.3679622
	iters: 100, epoch: 5 | loss: 0.6870555
	speed: 0.0246s/iter; left time: 48.0631s
	iters: 200, epoch: 5 | loss: 1.1361836
	speed: 0.0105s/iter; left time: 19.5571s
	iters: 300, epoch: 5 | loss: 0.4125403
	speed: 0.0111s/iter; left time: 19.5768s
	iters: 400, epoch: 5 | loss: 0.7175204
	speed: 0.0112s/iter; left time: 18.6296s
	iters: 500, epoch: 5 | loss: 0.4410447
	speed: 0.0112s/iter; left time: 17.5095s
Updating learning rate to 0.0004308637459144863
Epoch: 5 cost time: 5.690544128417969
Epoch: 5, Steps: 514 | Train Loss: 0.6788689 Vali Loss: 0.3811898 Best vali loss: 0.3679622
	iters: 100, epoch: 6 | loss: 0.4375216
	speed: 0.0213s/iter; left time: 30.7828s
	iters: 200, epoch: 6 | loss: 0.5803835
	speed: 0.0106s/iter; left time: 14.2557s
	iters: 300, epoch: 6 | loss: 0.7321200
	speed: 0.0108s/iter; left time: 13.3841s
	iters: 400, epoch: 6 | loss: 0.4855334
	speed: 0.0111s/iter; left time: 12.6308s
	iters: 500, epoch: 6 | loss: 0.3475403
	speed: 0.0111s/iter; left time: 11.6078s
Updating learning rate to 0.0002044284505345565
Epoch: 6 cost time: 5.547554969787598
Epoch: 6, Steps: 514 | Train Loss: 0.5166198 Vali Loss: 0.3896062 Best vali loss: 0.3679622
	iters: 100, epoch: 7 | loss: 0.2644999
	speed: 0.0223s/iter; left time: 20.7199s
	iters: 200, epoch: 7 | loss: 0.3617856
	speed: 0.0107s/iter; left time: 8.8957s
	iters: 300, epoch: 7 | loss: 0.5633631
	speed: 0.0103s/iter; left time: 7.5162s
	iters: 400, epoch: 7 | loss: 0.3289385
	speed: 0.0112s/iter; left time: 7.0747s
	iters: 500, epoch: 7 | loss: 0.3527838
	speed: 0.0128s/iter; left time: 6.7772s
Updating learning rate to 5.3129223290740836e-05
Epoch: 7 cost time: 5.8539652824401855
Epoch: 7, Steps: 514 | Train Loss: 0.3742742 Vali Loss: 0.3924036 Best vali loss: 0.3679622
	iters: 100, epoch: 8 | loss: 0.6299244
	speed: 0.0342s/iter; left time: 14.1811s
	iters: 200, epoch: 8 | loss: 0.5856974
	speed: 0.0134s/iter; left time: 4.2294s
	iters: 300, epoch: 8 | loss: 0.5041847
	speed: 0.0126s/iter; left time: 2.7037s
	iters: 400, epoch: 8 | loss: 0.5269023
	speed: 0.0105s/iter; left time: 1.2060s
	iters: 500, epoch: 8 | loss: 0.5930760
	speed: 0.0110s/iter; left time: 0.1655s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.217211723327637
Epoch: 8, Steps: 514 | Train Loss: 0.5679569 Vali Loss: 0.3913877 Best vali loss: 0.3679622

best validation loss 0.36796223529429706

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0017160125398, 'e_layers': 2, 'learning_rate': 0.0005326320428, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7566116
	speed: 0.0149s/iter; left time: 59.8368s
	iters: 200, epoch: 1 | loss: 0.7487134
	speed: 0.0083s/iter; left time: 32.4570s
	iters: 300, epoch: 1 | loss: 0.8805192
	speed: 0.0095s/iter; left time: 36.1574s
	iters: 400, epoch: 1 | loss: 0.4742111
	speed: 0.0092s/iter; left time: 34.2129s
	iters: 500, epoch: 1 | loss: 0.3095382
	speed: 0.0093s/iter; left time: 33.4833s
Updating learning rate to 0.0005326320428
Validation loss decreased (inf --> 0.3766).  Saving model state dict ...
Epoch: 1 cost time: 4.975529909133911
Epoch: 1, Steps: 514 | Train Loss: 0.6339187 Vali Loss: 0.3766145 Best vali loss: 0.3766145
	iters: 100, epoch: 2 | loss: 0.4746774
	speed: 0.0272s/iter; left time: 95.1507s
	iters: 200, epoch: 2 | loss: 0.2372800
	speed: 0.0108s/iter; left time: 36.6047s
	iters: 300, epoch: 2 | loss: 0.5181817
	speed: 0.0105s/iter; left time: 34.4764s
	iters: 400, epoch: 2 | loss: 0.8921096
	speed: 0.0096s/iter; left time: 30.7983s
	iters: 500, epoch: 2 | loss: 0.4358411
	speed: 0.0096s/iter; left time: 29.8647s
Updating learning rate to 0.0002663160214
Validation loss decreased (0.3766 --> 0.3631).  Saving model state dict ...
Epoch: 2 cost time: 5.322246313095093
Epoch: 2, Steps: 514 | Train Loss: 0.5116179 Vali Loss: 0.3630620 Best vali loss: 0.3630620
	iters: 100, epoch: 3 | loss: 0.6997845
	speed: 0.0252s/iter; left time: 75.1620s
	iters: 200, epoch: 3 | loss: 0.6003012
	speed: 0.0089s/iter; left time: 25.6967s
	iters: 300, epoch: 3 | loss: 0.8381595
	speed: 0.0079s/iter; left time: 21.8834s
	iters: 400, epoch: 3 | loss: 0.9653098
	speed: 0.0091s/iter; left time: 24.3468s
	iters: 500, epoch: 3 | loss: 0.8948151
	speed: 0.0096s/iter; left time: 24.8885s
Updating learning rate to 0.0001331580107
Epoch: 3 cost time: 4.679125785827637
Epoch: 3, Steps: 514 | Train Loss: 0.7996740 Vali Loss: 0.3729189 Best vali loss: 0.3630620
	iters: 100, epoch: 4 | loss: 0.3585902
	speed: 0.0258s/iter; left time: 63.7179s
	iters: 200, epoch: 4 | loss: 1.0849699
	speed: 0.0106s/iter; left time: 25.0792s
	iters: 300, epoch: 4 | loss: 0.5306983
	speed: 0.0112s/iter; left time: 25.4607s
	iters: 400, epoch: 4 | loss: 0.3138228
	speed: 0.0114s/iter; left time: 24.8263s
	iters: 500, epoch: 4 | loss: 0.8285064
	speed: 0.0090s/iter; left time: 18.7095s
Updating learning rate to 6.657900535e-05
Epoch: 4 cost time: 5.281184434890747
Epoch: 4, Steps: 514 | Train Loss: 0.6233175 Vali Loss: 0.3727668 Best vali loss: 0.3630620
	iters: 100, epoch: 5 | loss: 0.6220993
	speed: 0.0206s/iter; left time: 40.3792s
	iters: 200, epoch: 5 | loss: 0.3457525
	speed: 0.0092s/iter; left time: 17.1060s
	iters: 300, epoch: 5 | loss: 0.6899927
	speed: 0.0074s/iter; left time: 12.9730s
	iters: 400, epoch: 5 | loss: 0.5351317
	speed: 0.0052s/iter; left time: 8.5849s
	iters: 500, epoch: 5 | loss: 0.3755816
	speed: 0.0073s/iter; left time: 11.4247s
Updating learning rate to 3.3289502675e-05
Epoch: 5 cost time: 4.027878284454346
Epoch: 5, Steps: 514 | Train Loss: 0.5137116 Vali Loss: 0.3812438 Best vali loss: 0.3630620
	iters: 100, epoch: 6 | loss: 0.4693834
	speed: 0.0257s/iter; left time: 37.0610s
	iters: 200, epoch: 6 | loss: 0.5383326
	speed: 0.0091s/iter; left time: 12.2805s
	iters: 300, epoch: 6 | loss: 0.5347984
	speed: 0.0088s/iter; left time: 10.8889s
	iters: 400, epoch: 6 | loss: 0.2575261
	speed: 0.0084s/iter; left time: 9.6108s
	iters: 500, epoch: 6 | loss: 0.4857361
	speed: 0.0099s/iter; left time: 10.3224s
Updating learning rate to 1.66447513375e-05
Epoch: 6 cost time: 4.794987440109253
Epoch: 6, Steps: 514 | Train Loss: 0.4571553 Vali Loss: 0.3862698 Best vali loss: 0.3630620
	iters: 100, epoch: 7 | loss: 1.0800138
	speed: 0.0282s/iter; left time: 26.2350s
	iters: 200, epoch: 7 | loss: 0.7982438
	speed: 0.0093s/iter; left time: 7.7413s
	iters: 300, epoch: 7 | loss: 0.8118168
	speed: 0.0108s/iter; left time: 7.8411s
	iters: 400, epoch: 7 | loss: 0.3580765
	speed: 0.0103s/iter; left time: 6.4502s
	iters: 500, epoch: 7 | loss: 0.4011524
	speed: 0.0098s/iter; left time: 5.2038s
Updating learning rate to 8.32237566875e-06
Epoch: 7 cost time: 5.023284912109375
Epoch: 7, Steps: 514 | Train Loss: 0.6898606 Vali Loss: 0.3848219 Best vali loss: 0.3630620
	iters: 100, epoch: 8 | loss: 0.3598053
	speed: 0.0268s/iter; left time: 11.1305s
	iters: 200, epoch: 8 | loss: 0.3134969
	speed: 0.0092s/iter; left time: 2.9043s
	iters: 300, epoch: 8 | loss: 0.7838943
	speed: 0.0093s/iter; left time: 1.9962s
	iters: 400, epoch: 8 | loss: 0.3302960
	speed: 0.0091s/iter; left time: 1.0472s
	iters: 500, epoch: 8 | loss: 0.6870179
	speed: 0.0095s/iter; left time: 0.1430s
Updating learning rate to 4.161187834375e-06
Epoch: 8 cost time: 4.850651979446411
Epoch: 8, Steps: 514 | Train Loss: 0.4949021 Vali Loss: 0.3861573 Best vali loss: 0.3630620

best validation loss 0.3630619673574369

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0081740353862, 'e_layers': 2, 'learning_rate': 0.0001352780012, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001352780012
Validation loss decreased (inf --> 0.4113).  Saving model state dict ...
Epoch: 1 cost time: 1.9442682266235352
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4113028 Best vali loss: 0.4113028
Updating learning rate to 6.76390006e-05
Validation loss decreased (0.4113 --> 0.3902).  Saving model state dict ...
Epoch: 2 cost time: 0.5752296447753906
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3901898 Best vali loss: 0.3901898
Updating learning rate to 3.38195003e-05
Validation loss decreased (0.3902 --> 0.3840).  Saving model state dict ...
Epoch: 3 cost time: 0.5883941650390625
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3839992 Best vali loss: 0.3839992

best validation loss 0.3839992042726056

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0025789008972, 'e_layers': 2, 'learning_rate': 0.0001118721335, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8063312
	speed: 0.0144s/iter; left time: 57.7134s
	iters: 200, epoch: 1 | loss: 0.4713505
	speed: 0.0077s/iter; left time: 30.3005s
	iters: 300, epoch: 1 | loss: 0.3155711
	speed: 0.0078s/iter; left time: 29.7656s
	iters: 400, epoch: 1 | loss: 0.9703028
	speed: 0.0078s/iter; left time: 28.8049s
	iters: 500, epoch: 1 | loss: 0.6293754
	speed: 0.0078s/iter; left time: 28.2839s
Updating learning rate to 0.00010761425394951013
Validation loss decreased (inf --> 0.3644).  Saving model state dict ...
Epoch: 1 cost time: 4.353487968444824
Epoch: 1, Steps: 514 | Train Loss: 0.6385862 Vali Loss: 0.3644294 Best vali loss: 0.3644294
	iters: 100, epoch: 2 | loss: 1.1811283
	speed: 0.0178s/iter; left time: 62.1560s
	iters: 200, epoch: 2 | loss: 0.6411373
	speed: 0.0065s/iter; left time: 22.1401s
	iters: 300, epoch: 2 | loss: 1.1280951
	speed: 0.0048s/iter; left time: 15.7821s
	iters: 400, epoch: 2 | loss: 0.3983071
	speed: 0.0072s/iter; left time: 22.9252s
	iters: 500, epoch: 2 | loss: 0.8838497
	speed: 0.0082s/iter; left time: 25.5041s
Updating learning rate to 9.548883886182837e-05
Validation loss decreased (0.3644 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 3.742795944213867
Epoch: 2, Steps: 514 | Train Loss: 0.8465035 Vali Loss: 0.3629945 Best vali loss: 0.3629945
	iters: 100, epoch: 3 | loss: 0.9053342
	speed: 0.0183s/iter; left time: 54.5067s
	iters: 200, epoch: 3 | loss: 0.2790918
	speed: 0.0083s/iter; left time: 23.8370s
	iters: 300, epoch: 3 | loss: 0.3289736
	speed: 0.0068s/iter; left time: 18.9496s
	iters: 400, epoch: 3 | loss: 0.5642731
	speed: 0.0057s/iter; left time: 15.3311s
	iters: 500, epoch: 3 | loss: 0.4722803
	speed: 0.0071s/iter; left time: 18.4045s
Updating learning rate to 7.734187276689278e-05
Epoch: 3 cost time: 3.7247989177703857
Epoch: 3, Steps: 514 | Train Loss: 0.5099906 Vali Loss: 0.3983442 Best vali loss: 0.3629945

best validation loss 0.36299446296598215

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0022960309029, 'e_layers': 4, 'learning_rate': 0.004814200159, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6928410
	speed: 0.0164s/iter; left time: 15.3069s
Updating learning rate to 0.004630970575656341
Validation loss decreased (inf --> 0.3939).  Saving model state dict ...
Epoch: 1 cost time: 1.6380345821380615
Epoch: 1, Steps: 129 | Train Loss: 0.6928410 Vali Loss: 0.3938748 Best vali loss: 0.3938748
	iters: 100, epoch: 2 | loss: 0.5572811
	speed: 0.0158s/iter; left time: 12.7134s
Updating learning rate to 0.004109176868709127
Epoch: 2 cost time: 1.28829026222229
Epoch: 2, Steps: 129 | Train Loss: 0.5572811 Vali Loss: 0.4081814 Best vali loss: 0.3938748
	iters: 100, epoch: 3 | loss: 0.9285848
	speed: 0.0155s/iter; left time: 10.4756s
Updating learning rate to 0.0033282573999693405
Epoch: 3 cost time: 1.2997004985809326
Epoch: 3, Steps: 129 | Train Loss: 0.9285848 Vali Loss: 0.4042971 Best vali loss: 0.3938748

best validation loss 0.393874800626796

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0025789008972, 'e_layers': 2, 'learning_rate': 0.0001118721335, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6318619
	speed: 0.0142s/iter; left time: 35.1185s
	iters: 200, epoch: 4 | loss: 0.3918863
	speed: 0.0076s/iter; left time: 18.0613s
	iters: 300, epoch: 4 | loss: 0.3013757
	speed: 0.0076s/iter; left time: 17.2546s
	iters: 400, epoch: 4 | loss: 0.9571514
	speed: 0.0077s/iter; left time: 16.7995s
	iters: 500, epoch: 4 | loss: 0.4961728
	speed: 0.0076s/iter; left time: 15.7156s
Updating learning rate to 5.593606675e-05
Epoch: 4 cost time: 4.271765232086182
Epoch: 4, Steps: 514 | Train Loss: 0.5556896 Vali Loss: 0.3923388 Best vali loss: 0.3629945
	iters: 100, epoch: 5 | loss: 1.0139612
	speed: 0.0169s/iter; left time: 32.9845s
	iters: 200, epoch: 5 | loss: 0.6386424
	speed: 0.0078s/iter; left time: 14.4662s
	iters: 300, epoch: 5 | loss: 0.9178606
	speed: 0.0076s/iter; left time: 13.3456s
	iters: 400, epoch: 5 | loss: 0.2683722
	speed: 0.0072s/iter; left time: 11.9906s
	iters: 500, epoch: 5 | loss: 0.7424798
	speed: 0.0096s/iter; left time: 14.9139s
Updating learning rate to 3.453026073310723e-05
Epoch: 5 cost time: 4.14885401725769
Epoch: 5, Steps: 514 | Train Loss: 0.7162632 Vali Loss: 0.3790890 Best vali loss: 0.3629945
	iters: 100, epoch: 6 | loss: 0.8556963
	speed: 0.0286s/iter; left time: 41.3019s
	iters: 200, epoch: 6 | loss: 0.2539884
	speed: 0.0103s/iter; left time: 13.8871s
	iters: 300, epoch: 6 | loss: 0.3419828
	speed: 0.0090s/iter; left time: 11.2008s
	iters: 400, epoch: 6 | loss: 0.4868517
	speed: 0.0095s/iter; left time: 10.8607s
	iters: 500, epoch: 6 | loss: 0.3922698
	speed: 0.0110s/iter; left time: 11.4412s
Updating learning rate to 1.6383294638171637e-05
Epoch: 6 cost time: 5.080724716186523
Epoch: 6, Steps: 514 | Train Loss: 0.4661578 Vali Loss: 0.3951556 Best vali loss: 0.3629945
	iters: 100, epoch: 7 | loss: 0.4858498
	speed: 0.0255s/iter; left time: 23.6711s
	iters: 200, epoch: 7 | loss: 0.4315355
	speed: 0.0101s/iter; left time: 8.3486s
	iters: 300, epoch: 7 | loss: 0.6792204
	speed: 0.0098s/iter; left time: 7.1235s
	iters: 400, epoch: 7 | loss: 0.3697030
	speed: 0.0112s/iter; left time: 7.0449s
	iters: 500, epoch: 7 | loss: 0.4430884
	speed: 0.0078s/iter; left time: 4.1416s
Updating learning rate to 4.25787955048987e-06
Epoch: 7 cost time: 4.9845497608184814
Epoch: 7, Steps: 514 | Train Loss: 0.4818794 Vali Loss: 0.3762214 Best vali loss: 0.3629945
	iters: 100, epoch: 8 | loss: 0.2898371
	speed: 0.0227s/iter; left time: 9.4084s
	iters: 200, epoch: 8 | loss: 0.2658240
	speed: 0.0093s/iter; left time: 2.9442s
	iters: 300, epoch: 8 | loss: 0.5183522
	speed: 0.0102s/iter; left time: 2.2021s
	iters: 400, epoch: 8 | loss: 0.5926431
	speed: 0.0095s/iter; left time: 1.0921s
	iters: 500, epoch: 8 | loss: 0.8195535
	speed: 0.0097s/iter; left time: 0.1455s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.93583607673645
Epoch: 8, Steps: 514 | Train Loss: 0.4972420 Vali Loss: 0.3799962 Best vali loss: 0.3629945

best validation loss 0.36299446296598215

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0035888960285, 'e_layers': 3, 'learning_rate': 8.306939e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8263339
	speed: 0.0194s/iter; left time: 18.1285s
Updating learning rate to 7.990774959959888e-05
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 1.9587485790252686
Epoch: 1, Steps: 129 | Train Loss: 0.8263339 Vali Loss: 0.3684640 Best vali loss: 0.3684640
	iters: 100, epoch: 2 | loss: 0.8281612
	speed: 0.0316s/iter; left time: 25.4338s
Updating learning rate to 7.090415948901498e-05
Validation loss decreased (0.3685 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 3.0084457397460938
Epoch: 2, Steps: 129 | Train Loss: 0.8281612 Vali Loss: 0.3642230 Best vali loss: 0.3642230
	iters: 100, epoch: 3 | loss: 0.4370742
	speed: 0.0320s/iter; left time: 21.5928s
Updating learning rate to 5.742933464483714e-05
Validation loss decreased (0.3642 --> 0.3631).  Saving model state dict ...
Epoch: 3 cost time: 1.9219260215759277
Epoch: 3, Steps: 129 | Train Loss: 0.4370742 Vali Loss: 0.3630867 Best vali loss: 0.3630867
	iters: 100, epoch: 4 | loss: 0.7873932
	speed: 0.0171s/iter; left time: 9.3445s
Updating learning rate to 4.1534695e-05
Validation loss decreased (0.3631 --> 0.3607).  Saving model state dict ...
Epoch: 4 cost time: 1.534867763519287
Epoch: 4, Steps: 129 | Train Loss: 0.7873932 Vali Loss: 0.3606522 Best vali loss: 0.3606522
	iters: 100, epoch: 5 | loss: 0.3760571
	speed: 0.0231s/iter; left time: 9.6237s
Updating learning rate to 2.564005535516287e-05
Validation loss decreased (0.3607 --> 0.3575).  Saving model state dict ...
Epoch: 5 cost time: 1.809281587600708
Epoch: 5, Steps: 129 | Train Loss: 0.3760571 Vali Loss: 0.3575325 Best vali loss: 0.3575325
	iters: 100, epoch: 6 | loss: 0.4157793
	speed: 0.0249s/iter; left time: 7.1752s
Updating learning rate to 1.2165230510985013e-05
Validation loss decreased (0.3575 --> 0.3570).  Saving model state dict ...
Epoch: 6 cost time: 1.8746397495269775
Epoch: 6, Steps: 129 | Train Loss: 0.4157793 Vali Loss: 0.3569652 Best vali loss: 0.3569652
	iters: 100, epoch: 7 | loss: 0.5081716
	speed: 0.0240s/iter; left time: 3.8236s
Updating learning rate to 3.1616404004011213e-06
Epoch: 7 cost time: 1.7012076377868652
Epoch: 7, Steps: 129 | Train Loss: 0.5081716 Vali Loss: 0.3583297 Best vali loss: 0.3569652
	iters: 100, epoch: 8 | loss: 0.6992716
	speed: 0.0239s/iter; left time: 0.7179s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5807278156280518
Epoch: 8, Steps: 129 | Train Loss: 0.6992716 Vali Loss: 0.3579952 Best vali loss: 0.3569652

best validation loss 0.3569652129952706

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001557219609, 'e_layers': 3, 'learning_rate': 0.0033639330518, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6856135
	speed: 0.0222s/iter; left time: 43.4716s
	iters: 200, epoch: 1 | loss: 1.0867778
	speed: 0.0129s/iter; left time: 24.0025s
Updating learning rate to 0.0033639330518
Validation loss decreased (inf --> 0.4083).  Saving model state dict ...
Epoch: 1 cost time: 4.060312747955322
Epoch: 1, Steps: 257 | Train Loss: 0.8861956 Vali Loss: 0.4083201 Best vali loss: 0.4083201
	iters: 100, epoch: 2 | loss: 0.6197507
	speed: 0.0335s/iter; left time: 56.9456s
	iters: 200, epoch: 2 | loss: 0.8119373
	speed: 0.0149s/iter; left time: 23.9144s
Updating learning rate to 0.0016819665259
Epoch: 2 cost time: 3.535794496536255
Epoch: 2, Steps: 257 | Train Loss: 0.7158440 Vali Loss: 0.4121243 Best vali loss: 0.4083201
	iters: 100, epoch: 3 | loss: 1.1403983
	speed: 0.0185s/iter; left time: 26.7611s
	iters: 200, epoch: 3 | loss: 0.4973555
	speed: 0.0129s/iter; left time: 17.2700s
Updating learning rate to 0.00084098326295
Validation loss decreased (0.4083 --> 0.4034).  Saving model state dict ...
Epoch: 3 cost time: 2.733517646789551
Epoch: 3, Steps: 257 | Train Loss: 0.8188769 Vali Loss: 0.4034466 Best vali loss: 0.4034466
	iters: 100, epoch: 4 | loss: 0.9921920
	speed: 0.0177s/iter; left time: 21.0299s
	iters: 200, epoch: 4 | loss: 0.6537396
	speed: 0.0139s/iter; left time: 15.1131s
Updating learning rate to 0.000420491631475
Epoch: 4 cost time: 3.0565412044525146
Epoch: 4, Steps: 257 | Train Loss: 0.8229658 Vali Loss: 0.4035611 Best vali loss: 0.4034466
	iters: 100, epoch: 5 | loss: 0.3267508
	speed: 0.0318s/iter; left time: 29.5733s
	iters: 200, epoch: 5 | loss: 0.5658731
	speed: 0.0145s/iter; left time: 11.9942s
Updating learning rate to 0.0002102458157375
Epoch: 5 cost time: 3.809873104095459
Epoch: 5, Steps: 257 | Train Loss: 0.4463119 Vali Loss: 0.4041230 Best vali loss: 0.4034466
	iters: 100, epoch: 6 | loss: 0.4487234
	speed: 0.0259s/iter; left time: 17.3776s
	iters: 200, epoch: 6 | loss: 0.7225636
	speed: 0.0101s/iter; left time: 5.7960s
Updating learning rate to 0.00010512290786875
Epoch: 6 cost time: 2.812932252883911
Epoch: 6, Steps: 257 | Train Loss: 0.5856435 Vali Loss: 0.4039305 Best vali loss: 0.4034466
	iters: 100, epoch: 7 | loss: 0.8393083
	speed: 0.0398s/iter; left time: 16.5010s
	iters: 200, epoch: 7 | loss: 0.5581482
	speed: 0.0125s/iter; left time: 3.9369s
Updating learning rate to 5.2561453934375e-05
Epoch: 7 cost time: 3.6724631786346436
Epoch: 7, Steps: 257 | Train Loss: 0.6987283 Vali Loss: 0.4037338 Best vali loss: 0.4034466
	iters: 100, epoch: 8 | loss: 1.2211089
	speed: 0.0234s/iter; left time: 3.6947s
	iters: 200, epoch: 8 | loss: 0.5913709
	speed: 0.0143s/iter; left time: 0.8308s
Updating learning rate to 2.62807269671875e-05
Epoch: 8 cost time: 3.1231493949890137
Epoch: 8, Steps: 257 | Train Loss: 0.9062399 Vali Loss: 0.4036320 Best vali loss: 0.4034466

best validation loss 0.4034466389237312

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0019185554037, 'e_layers': 1, 'learning_rate': 0.0008261633471, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8273830
	speed: 0.0223s/iter; left time: 20.8162s
Updating learning rate to 0.0007947193769983539
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 2.2939138412475586
Epoch: 1, Steps: 129 | Train Loss: 0.8273830 Vali Loss: 0.3727056 Best vali loss: 0.3727056
	iters: 100, epoch: 2 | loss: 0.4760250
	speed: 0.0277s/iter; left time: 22.2536s
Updating learning rate to 0.0007051745261010926
Epoch: 2 cost time: 2.1263833045959473
Epoch: 2, Steps: 129 | Train Loss: 0.4760250 Vali Loss: 0.4091286 Best vali loss: 0.3727056
	iters: 100, epoch: 3 | loss: 0.5029857
	speed: 0.0277s/iter; left time: 18.6904s
Updating learning rate to 0.0005711611862312295
Epoch: 3 cost time: 2.2488014698028564
Epoch: 3, Steps: 129 | Train Loss: 0.5029857 Vali Loss: 0.3789902 Best vali loss: 0.3727056

best validation loss 0.3727055967322501

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 0.000109720172, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4129804
	speed: 0.0225s/iter; left time: 44.0721s
	iters: 200, epoch: 1 | loss: 0.9984873
	speed: 0.0090s/iter; left time: 16.6858s
Updating learning rate to 0.00010554419660720899
Validation loss decreased (inf --> 0.4009).  Saving model state dict ...
Epoch: 1 cost time: 3.4972665309906006
Epoch: 1, Steps: 257 | Train Loss: 0.7057338 Vali Loss: 0.4008664 Best vali loss: 0.4008664
	iters: 100, epoch: 2 | loss: 0.5220854
	speed: 0.0355s/iter; left time: 60.4201s
	iters: 200, epoch: 2 | loss: 0.7267455
	speed: 0.0135s/iter; left time: 21.6539s
Updating learning rate to 9.365202482707718e-05
Validation loss decreased (0.4009 --> 0.3853).  Saving model state dict ...
Epoch: 2 cost time: 4.085079669952393
Epoch: 2, Steps: 257 | Train Loss: 0.6244154 Vali Loss: 0.3853031 Best vali loss: 0.3853031
	iters: 100, epoch: 3 | loss: 0.6248330
	speed: 0.0293s/iter; left time: 42.3016s
	iters: 200, epoch: 3 | loss: 0.6574671
	speed: 0.0158s/iter; left time: 21.2771s
Updating learning rate to 7.585413201032401e-05
Validation loss decreased (0.3853 --> 0.3804).  Saving model state dict ...
Epoch: 3 cost time: 3.7970638275146484
Epoch: 3, Steps: 257 | Train Loss: 0.6411501 Vali Loss: 0.3803689 Best vali loss: 0.3803689

best validation loss 0.3803688856145488

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0008018849014, 'e_layers': 4, 'learning_rate': 0.0005221113879, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7150302
	speed: 0.0214s/iter; left time: 19.9527s
Updating learning rate to 0.0005022397064359356
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 2.289983034133911
Epoch: 1, Steps: 129 | Train Loss: 0.7150302 Vali Loss: 0.3653413 Best vali loss: 0.3653413
	iters: 100, epoch: 2 | loss: 0.6678683
	speed: 0.0238s/iter; left time: 19.1508s
Updating learning rate to 0.00044564994540940495
Epoch: 2 cost time: 1.943648099899292
Epoch: 2, Steps: 129 | Train Loss: 0.6678683 Vali Loss: 0.3686966 Best vali loss: 0.3653413
	iters: 100, epoch: 3 | loss: 0.6271517
	speed: 0.0231s/iter; left time: 15.6152s
Updating learning rate to 0.0003609573829492364
Epoch: 3 cost time: 1.90852952003479
Epoch: 3, Steps: 129 | Train Loss: 0.6271517 Vali Loss: 0.3686543 Best vali loss: 0.3653413

best validation loss 0.3653413089764376

{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0008018849014, 'e_layers': 4, 'learning_rate': 0.0005221113879, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6221955
	speed: 0.0187s/iter; left time: 10.1892s
Updating learning rate to 0.00026105569395
Epoch: 4 cost time: 1.7785289287567139
Epoch: 4, Steps: 129 | Train Loss: 0.6221955 Vali Loss: 0.3698018 Best vali loss: 0.3653413
	iters: 100, epoch: 5 | loss: 0.6225260
	speed: 0.0165s/iter; left time: 6.9008s
Updating learning rate to 0.00016115400495076362
Validation loss decreased (0.3653 --> 0.3649).  Saving model state dict ...
Epoch: 5 cost time: 1.2786524295806885
Epoch: 5, Steps: 129 | Train Loss: 0.6225260 Vali Loss: 0.3649001 Best vali loss: 0.3649001
	iters: 100, epoch: 6 | loss: 0.5912322
	speed: 0.0152s/iter; left time: 4.3822s
Updating learning rate to 7.646144249059505e-05
Validation loss decreased (0.3649 --> 0.3627).  Saving model state dict ...
Epoch: 6 cost time: 1.1336615085601807
Epoch: 6, Steps: 129 | Train Loss: 0.5912322 Vali Loss: 0.3626894 Best vali loss: 0.3626894
	iters: 100, epoch: 7 | loss: 0.9394720
	speed: 0.0124s/iter; left time: 1.9639s
Updating learning rate to 1.9871681464064455e-05
Epoch: 7 cost time: 1.131068468093872
Epoch: 7, Steps: 129 | Train Loss: 0.9394720 Vali Loss: 0.3673021 Best vali loss: 0.3626894
	iters: 100, epoch: 8 | loss: 0.5798873
	speed: 0.0151s/iter; left time: 0.4525s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.274662733078003
Epoch: 8, Steps: 129 | Train Loss: 0.5798873 Vali Loss: 0.3670628 Best vali loss: 0.3626894

best validation loss 0.36268936768027793

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013550112799, 'e_layers': 2, 'learning_rate': 0.0005502704673, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6113244
	speed: 0.0141s/iter; left time: 56.4928s
	iters: 200, epoch: 1 | loss: 0.4896130
	speed: 0.0077s/iter; left time: 29.9930s
	iters: 300, epoch: 1 | loss: 0.2696823
	speed: 0.0077s/iter; left time: 29.4797s
	iters: 400, epoch: 1 | loss: 0.3431827
	speed: 0.0078s/iter; left time: 28.9310s
	iters: 500, epoch: 1 | loss: 0.2945173
	speed: 0.0078s/iter; left time: 28.0674s
Updating learning rate to 0.0005502704673
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 4.305109739303589
Epoch: 1, Steps: 514 | Train Loss: 0.4016639 Vali Loss: 0.3677404 Best vali loss: 0.3677404
	iters: 100, epoch: 2 | loss: 1.1321236
	speed: 0.0185s/iter; left time: 64.8242s
	iters: 200, epoch: 2 | loss: 0.8579668
	speed: 0.0076s/iter; left time: 25.9640s
	iters: 300, epoch: 2 | loss: 0.6997888
	speed: 0.0077s/iter; left time: 25.3732s
	iters: 400, epoch: 2 | loss: 0.3414506
	speed: 0.0077s/iter; left time: 24.7671s
	iters: 500, epoch: 2 | loss: 0.8253809
	speed: 0.0077s/iter; left time: 23.7409s
Updating learning rate to 0.00027513523365
Epoch: 2 cost time: 4.1060872077941895
Epoch: 2, Steps: 514 | Train Loss: 0.7713422 Vali Loss: 0.3736070 Best vali loss: 0.3677404
	iters: 100, epoch: 3 | loss: 0.5187726
	speed: 0.0159s/iter; left time: 47.5424s
	iters: 200, epoch: 3 | loss: 0.3460684
	speed: 0.0071s/iter; left time: 20.4757s
	iters: 300, epoch: 3 | loss: 0.3556572
	speed: 0.0078s/iter; left time: 21.6118s
	iters: 400, epoch: 3 | loss: 0.7786328
	speed: 0.0078s/iter; left time: 20.8278s
	iters: 500, epoch: 3 | loss: 0.3958493
	speed: 0.0078s/iter; left time: 20.0612s
Updating learning rate to 0.000137567616825
Epoch: 3 cost time: 3.924398422241211
Epoch: 3, Steps: 514 | Train Loss: 0.4789961 Vali Loss: 0.3722041 Best vali loss: 0.3677404
	iters: 100, epoch: 4 | loss: 0.6168994
	speed: 0.0217s/iter; left time: 53.6367s
	iters: 200, epoch: 4 | loss: 0.5855828
	speed: 0.0076s/iter; left time: 17.9747s
	iters: 300, epoch: 4 | loss: 0.9562696
	speed: 0.0076s/iter; left time: 17.3617s
	iters: 400, epoch: 4 | loss: 0.3395147
	speed: 0.0077s/iter; left time: 16.7190s
	iters: 500, epoch: 4 | loss: 0.6663386
	speed: 0.0077s/iter; left time: 15.8975s
Updating learning rate to 6.87838084125e-05
Epoch: 4 cost time: 4.010756969451904
Epoch: 4, Steps: 514 | Train Loss: 0.6329210 Vali Loss: 0.3854152 Best vali loss: 0.3677404
	iters: 100, epoch: 5 | loss: 0.8198455
	speed: 0.0170s/iter; left time: 33.2055s
	iters: 200, epoch: 5 | loss: 0.8009270
	speed: 0.0076s/iter; left time: 14.1723s
	iters: 300, epoch: 5 | loss: 0.6871857
	speed: 0.0076s/iter; left time: 13.3354s
	iters: 400, epoch: 5 | loss: 0.3636890
	speed: 0.0076s/iter; left time: 12.6439s
	iters: 500, epoch: 5 | loss: 0.2643858
	speed: 0.0079s/iter; left time: 12.3519s
Updating learning rate to 3.439190420625e-05
Epoch: 5 cost time: 4.018852233886719
Epoch: 5, Steps: 514 | Train Loss: 0.5872066 Vali Loss: 0.3758885 Best vali loss: 0.3677404
	iters: 100, epoch: 6 | loss: 0.4956681
	speed: 0.0166s/iter; left time: 24.0159s
	iters: 200, epoch: 6 | loss: 0.3122892
	speed: 0.0056s/iter; left time: 7.4677s
	iters: 300, epoch: 6 | loss: 0.8767986
	speed: 0.0074s/iter; left time: 9.2108s
	iters: 400, epoch: 6 | loss: 0.7397014
	speed: 0.0075s/iter; left time: 8.6293s
	iters: 500, epoch: 6 | loss: 0.5434621
	speed: 0.0077s/iter; left time: 8.0096s
Updating learning rate to 1.7195952103125e-05
Epoch: 6 cost time: 3.45605731010437
Epoch: 6, Steps: 514 | Train Loss: 0.5935839 Vali Loss: 0.3797298 Best vali loss: 0.3677404
	iters: 100, epoch: 7 | loss: 0.9793304
	speed: 0.0172s/iter; left time: 16.0087s
	iters: 200, epoch: 7 | loss: 0.7710981
	speed: 0.0096s/iter; left time: 7.9889s
	iters: 300, epoch: 7 | loss: 0.5962566
	speed: 0.0096s/iter; left time: 7.0241s
	iters: 400, epoch: 7 | loss: 0.4553586
	speed: 0.0102s/iter; left time: 6.3995s
	iters: 500, epoch: 7 | loss: 0.5542850
	speed: 0.0127s/iter; left time: 6.7031s
Updating learning rate to 8.5979760515625e-06
Epoch: 7 cost time: 5.285614490509033
Epoch: 7, Steps: 514 | Train Loss: 0.6712657 Vali Loss: 0.3747955 Best vali loss: 0.3677404
	iters: 100, epoch: 8 | loss: 0.4897483
	speed: 0.0386s/iter; left time: 16.0356s
	iters: 200, epoch: 8 | loss: 0.7346480
	speed: 0.0109s/iter; left time: 3.4399s
	iters: 300, epoch: 8 | loss: 0.3117614
	speed: 0.0130s/iter; left time: 2.8007s
	iters: 400, epoch: 8 | loss: 0.2397397
	speed: 0.0118s/iter; left time: 1.3523s
	iters: 500, epoch: 8 | loss: 0.4104057
	speed: 0.0101s/iter; left time: 0.1522s
Updating learning rate to 4.29898802578125e-06
Epoch: 8 cost time: 5.735321044921875
Epoch: 8, Steps: 514 | Train Loss: 0.4372606 Vali Loss: 0.3756498 Best vali loss: 0.3677404

best validation loss 0.3677403858169357

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0052851717933, 'e_layers': 3, 'learning_rate': 0.0003752147486, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5132429
	speed: 0.0168s/iter; left time: 15.6942s
Updating learning rate to 0.000360933987563954
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 1.603914737701416
Epoch: 1, Steps: 129 | Train Loss: 0.5132429 Vali Loss: 0.3699001 Best vali loss: 0.3699001
	iters: 100, epoch: 2 | loss: 0.6230576
	speed: 0.0150s/iter; left time: 12.0991s
Updating learning rate to 0.00032026582086813277
Validation loss decreased (0.3699 --> 0.3634).  Saving model state dict ...
Epoch: 2 cost time: 1.1440787315368652
Epoch: 2, Steps: 129 | Train Loss: 0.6230576 Vali Loss: 0.3633875 Best vali loss: 0.3633875
	iters: 100, epoch: 3 | loss: 0.6552366
	speed: 0.0142s/iter; left time: 9.6039s
Updating learning rate to 0.00025940160823412613
Epoch: 3 cost time: 1.134653091430664
Epoch: 3, Steps: 129 | Train Loss: 0.6552366 Vali Loss: 0.3655164 Best vali loss: 0.3633875
	iters: 100, epoch: 4 | loss: 0.6714576
	speed: 0.0143s/iter; left time: 7.8339s
Updating learning rate to 0.0001876073743
Validation loss decreased (0.3634 --> 0.3621).  Saving model state dict ...
Epoch: 4 cost time: 1.1475205421447754
Epoch: 4, Steps: 129 | Train Loss: 0.6714576 Vali Loss: 0.3621435 Best vali loss: 0.3621435
	iters: 100, epoch: 5 | loss: 0.5171628
	speed: 0.0185s/iter; left time: 7.7078s
Updating learning rate to 0.00011581314036587387
Epoch: 5 cost time: 1.2519636154174805
Epoch: 5, Steps: 129 | Train Loss: 0.5171628 Vali Loss: 0.3747296 Best vali loss: 0.3621435
	iters: 100, epoch: 6 | loss: 0.5880281
	speed: 0.0123s/iter; left time: 3.5522s
Updating learning rate to 5.494892773186719e-05
Epoch: 6 cost time: 1.1605606079101562
Epoch: 6, Steps: 129 | Train Loss: 0.5880281 Vali Loss: 0.3654557 Best vali loss: 0.3621435
	iters: 100, epoch: 7 | loss: 0.6305165
	speed: 0.0157s/iter; left time: 2.4975s
Updating learning rate to 1.428076103604601e-05
Validation loss decreased (0.3621 --> 0.3603).  Saving model state dict ...
Epoch: 7 cost time: 1.2531888484954834
Epoch: 7, Steps: 129 | Train Loss: 0.6305165 Vali Loss: 0.3603093 Best vali loss: 0.3603093
	iters: 100, epoch: 8 | loss: 0.5443873
	speed: 0.0155s/iter; left time: 0.4665s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.260533094406128
Epoch: 8, Steps: 129 | Train Loss: 0.5443873 Vali Loss: 0.3615128 Best vali loss: 0.3603093

best validation loss 0.3603092983687088

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.003778909515, 'e_layers': 2, 'learning_rate': 7.38400575e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6567484
	speed: 0.0153s/iter; left time: 14.2355s
Updating learning rate to 7.38400575e-05
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.4779431819915771
Epoch: 1, Steps: 129 | Train Loss: 0.6567484 Vali Loss: 0.3706795 Best vali loss: 0.3706795
	iters: 100, epoch: 2 | loss: 0.9200091
	speed: 0.0145s/iter; left time: 11.6843s
Updating learning rate to 3.692002875e-05
Validation loss decreased (0.3707 --> 0.3661).  Saving model state dict ...
Epoch: 2 cost time: 1.1592028141021729
Epoch: 2, Steps: 129 | Train Loss: 0.9200091 Vali Loss: 0.3661170 Best vali loss: 0.3661170
	iters: 100, epoch: 3 | loss: 0.4956007
	speed: 0.0150s/iter; left time: 10.1247s
Updating learning rate to 1.8460014375e-05
Validation loss decreased (0.3661 --> 0.3645).  Saving model state dict ...
Epoch: 3 cost time: 1.1860136985778809
Epoch: 3, Steps: 129 | Train Loss: 0.4956007 Vali Loss: 0.3645381 Best vali loss: 0.3645381

best validation loss 0.3645381311068132

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0012599336841, 'e_layers': 4, 'learning_rate': 6.44670134e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7635303
	speed: 0.0266s/iter; left time: 24.7996s
Updating learning rate to 6.201338380119543e-05
Validation loss decreased (inf --> 0.3629).  Saving model state dict ...
Epoch: 1 cost time: 3.1046957969665527
Epoch: 1, Steps: 129 | Train Loss: 0.7635303 Vali Loss: 0.3628595 Best vali loss: 0.3628595
	iters: 100, epoch: 2 | loss: 0.4291017
	speed: 0.0376s/iter; left time: 30.2294s
Updating learning rate to 5.502603786899201e-05
Validation loss decreased (0.3629 --> 0.3608).  Saving model state dict ...
Epoch: 2 cost time: 3.137216091156006
Epoch: 2, Steps: 129 | Train Loss: 0.4291017 Vali Loss: 0.3607877 Best vali loss: 0.3607877
	iters: 100, epoch: 3 | loss: 0.4461240
	speed: 0.0282s/iter; left time: 19.0304s
Updating learning rate to 4.456873568111912e-05
Validation loss decreased (0.3608 --> 0.3583).  Saving model state dict ...
Epoch: 3 cost time: 1.749467372894287
Epoch: 3, Steps: 129 | Train Loss: 0.4461240 Vali Loss: 0.3583180 Best vali loss: 0.3583180

best validation loss 0.35831798822097555

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0065094553439, 'e_layers': 2, 'learning_rate': 0.0006446265408, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7443679
	speed: 0.0156s/iter; left time: 14.5198s
Updating learning rate to 0.000620091903979336
Validation loss decreased (inf --> 0.3550).  Saving model state dict ...
Epoch: 1 cost time: 1.5611443519592285
Epoch: 1, Steps: 129 | Train Loss: 0.7443679 Vali Loss: 0.3549516 Best vali loss: 0.3549516
	iters: 100, epoch: 2 | loss: 0.5736145
	speed: 0.0111s/iter; left time: 8.9538s
Updating learning rate to 0.0005502231695662533
Validation loss decreased (0.3550 --> 0.3536).  Saving model state dict ...
Epoch: 2 cost time: 0.7846958637237549
Epoch: 2, Steps: 129 | Train Loss: 0.5736145 Vali Loss: 0.3536377 Best vali loss: 0.3536377
	iters: 100, epoch: 3 | loss: 0.6582454
	speed: 0.0140s/iter; left time: 9.4764s
Updating learning rate to 0.0004456572190134893
Epoch: 3 cost time: 1.2347595691680908
Epoch: 3, Steps: 129 | Train Loss: 0.6582454 Vali Loss: 0.3606847 Best vali loss: 0.3536377

best validation loss 0.3536377209694306

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0065094553439, 'e_layers': 2, 'learning_rate': 0.0006446265408, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6193659
	speed: 0.0162s/iter; left time: 8.8346s
Updating learning rate to 0.0003223132704
Validation loss decreased (0.3536 --> 0.3479).  Saving model state dict ...
Epoch: 4 cost time: 1.524446964263916
Epoch: 4, Steps: 129 | Train Loss: 0.6193659 Vali Loss: 0.3478710 Best vali loss: 0.3478710
	iters: 100, epoch: 5 | loss: 0.4439788
	speed: 0.0157s/iter; left time: 6.5569s
Updating learning rate to 0.00019896932178651073
Epoch: 5 cost time: 1.271812915802002
Epoch: 5, Steps: 129 | Train Loss: 0.4439788 Vali Loss: 0.3518023 Best vali loss: 0.3478710
	iters: 100, epoch: 6 | loss: 0.5507042
	speed: 0.0146s/iter; left time: 4.2154s
Updating learning rate to 9.440337123374669e-05
Epoch: 6 cost time: 1.1937098503112793
Epoch: 6, Steps: 129 | Train Loss: 0.5507042 Vali Loss: 0.3627680 Best vali loss: 0.3478710
	iters: 100, epoch: 7 | loss: 0.3163780
	speed: 0.0116s/iter; left time: 1.8518s
Updating learning rate to 2.4534636820664045e-05
Epoch: 7 cost time: 0.7594599723815918
Epoch: 7, Steps: 129 | Train Loss: 0.3163780 Vali Loss: 0.3617120 Best vali loss: 0.3478710
	iters: 100, epoch: 8 | loss: 0.4475285
	speed: 0.0131s/iter; left time: 0.3919s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2208082675933838
Epoch: 8, Steps: 129 | Train Loss: 0.4475285 Vali Loss: 0.3591487 Best vali loss: 0.3478710

best validation loss 0.3478709584837578

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0026805940516, 'e_layers': 4, 'learning_rate': 0.0027816638554, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6768218
	speed: 0.0180s/iter; left time: 16.8125s
Updating learning rate to 0.0026757930788652478
Validation loss decreased (inf --> 0.3868).  Saving model state dict ...
Epoch: 1 cost time: 1.849792718887329
Epoch: 1, Steps: 129 | Train Loss: 0.6768218 Vali Loss: 0.3868249 Best vali loss: 0.3868249
	iters: 100, epoch: 2 | loss: 0.6276947
	speed: 0.0185s/iter; left time: 14.8924s
Updating learning rate to 0.002374298615267428
Epoch: 2 cost time: 1.5646789073944092
Epoch: 2, Steps: 129 | Train Loss: 0.6276947 Vali Loss: 0.3998447 Best vali loss: 0.3868249
	iters: 100, epoch: 3 | loss: 0.8462926
	speed: 0.0178s/iter; left time: 12.0265s
Updating learning rate to 0.0019230802636351905
Epoch: 3 cost time: 1.4795761108398438
Epoch: 3, Steps: 129 | Train Loss: 0.8462926 Vali Loss: 0.4068264 Best vali loss: 0.3868249
	iters: 100, epoch: 4 | loss: 0.8582497
	speed: 0.0205s/iter; left time: 11.1974s
Updating learning rate to 0.0013908319277
Epoch: 4 cost time: 1.753194808959961
Epoch: 4, Steps: 129 | Train Loss: 0.8582497 Vali Loss: 0.4049602 Best vali loss: 0.3868249
	iters: 100, epoch: 5 | loss: 0.6254753
	speed: 0.0179s/iter; left time: 7.4474s
Updating learning rate to 0.0008585835917648097
Epoch: 5 cost time: 1.4742345809936523
Epoch: 5, Steps: 129 | Train Loss: 0.6254753 Vali Loss: 0.4037897 Best vali loss: 0.3868249
	iters: 100, epoch: 6 | loss: 0.8535061
	speed: 0.0175s/iter; left time: 5.0302s
Updating learning rate to 0.0004073652401325721
Epoch: 6 cost time: 1.4565682411193848
Epoch: 6, Steps: 129 | Train Loss: 0.8535061 Vali Loss: 0.4049164 Best vali loss: 0.3868249
	iters: 100, epoch: 7 | loss: 0.5675040
	speed: 0.0173s/iter; left time: 2.7518s
Updating learning rate to 0.00010587077653475225
Epoch: 7 cost time: 1.5813937187194824
Epoch: 7, Steps: 129 | Train Loss: 0.5675040 Vali Loss: 0.4022071 Best vali loss: 0.3868249
	iters: 100, epoch: 8 | loss: 0.7155085
	speed: 0.0201s/iter; left time: 0.6039s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4625427722930908
Epoch: 8, Steps: 129 | Train Loss: 0.7155085 Vali Loss: 0.4033961 Best vali loss: 0.3868249

best validation loss 0.3868248684935579

{'batch_size': 8, 'd_core': 32, 'd_model': 512, 'dropout': 0.0043671913006, 'e_layers': 4, 'learning_rate': 0.0001190548855, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2807939
	speed: 0.0171s/iter; left time: 138.7111s
	iters: 200, epoch: 1 | loss: 1.2936491
	speed: 0.0122s/iter; left time: 97.5271s
	iters: 300, epoch: 1 | loss: 0.3716983
	speed: 0.0110s/iter; left time: 86.9314s
	iters: 400, epoch: 1 | loss: 0.2981817
	speed: 0.0100s/iter; left time: 78.0352s
	iters: 500, epoch: 1 | loss: 0.3434559
	speed: 0.0118s/iter; left time: 91.3436s
	iters: 600, epoch: 1 | loss: 0.7006920
	speed: 0.0116s/iter; left time: 88.5608s
	iters: 700, epoch: 1 | loss: 0.5626356
	speed: 0.0108s/iter; left time: 81.5576s
	iters: 800, epoch: 1 | loss: 0.9235291
	speed: 0.0119s/iter; left time: 87.9178s
	iters: 900, epoch: 1 | loss: 0.5818457
	speed: 0.0113s/iter; left time: 82.6095s
	iters: 1000, epoch: 1 | loss: 0.3112038
	speed: 0.0111s/iter; left time: 80.3461s
Updating learning rate to 0.0001190548855
Validation loss decreased (inf --> 0.3638).  Saving model state dict ...
Epoch: 1 cost time: 11.909326314926147
Epoch: 1, Steps: 1027 | Train Loss: 0.5667685 Vali Loss: 0.3637671 Best vali loss: 0.3637671
	iters: 100, epoch: 2 | loss: 0.5866005
	speed: 0.0301s/iter; left time: 213.1201s
	iters: 200, epoch: 2 | loss: 0.4282112
	speed: 0.0111s/iter; left time: 77.3978s
	iters: 300, epoch: 2 | loss: 0.4216185
	speed: 0.0113s/iter; left time: 77.7758s
	iters: 400, epoch: 2 | loss: 0.8531532
	speed: 0.0116s/iter; left time: 79.0533s
	iters: 500, epoch: 2 | loss: 0.6712527
	speed: 0.0118s/iter; left time: 78.8532s
	iters: 600, epoch: 2 | loss: 0.9648764
	speed: 0.0118s/iter; left time: 77.7119s
	iters: 700, epoch: 2 | loss: 1.5290329
	speed: 0.0113s/iter; left time: 73.4303s
	iters: 800, epoch: 2 | loss: 0.5359861
	speed: 0.0110s/iter; left time: 70.5045s
	iters: 900, epoch: 2 | loss: 0.4065772
	speed: 0.0109s/iter; left time: 68.7333s
	iters: 1000, epoch: 2 | loss: 0.3299447
	speed: 0.0115s/iter; left time: 71.1722s
Updating learning rate to 5.952744275e-05
Epoch: 2 cost time: 11.624692440032959
Epoch: 2, Steps: 1027 | Train Loss: 0.6727254 Vali Loss: 0.3971157 Best vali loss: 0.3637671
	iters: 100, epoch: 3 | loss: 0.2372993
	speed: 0.0305s/iter; left time: 184.7107s
	iters: 200, epoch: 3 | loss: 0.2964984
	speed: 0.0104s/iter; left time: 62.2811s
	iters: 300, epoch: 3 | loss: 0.8796476
	speed: 0.0112s/iter; left time: 65.7775s
	iters: 400, epoch: 3 | loss: 0.3932729
	speed: 0.0115s/iter; left time: 66.4232s
	iters: 500, epoch: 3 | loss: 0.3187936
	speed: 0.0114s/iter; left time: 64.6699s
	iters: 600, epoch: 3 | loss: 0.5006815
	speed: 0.0116s/iter; left time: 64.5875s
	iters: 700, epoch: 3 | loss: 0.2552833
	speed: 0.0116s/iter; left time: 63.1283s
	iters: 800, epoch: 3 | loss: 0.4480669
	speed: 0.0099s/iter; left time: 52.9352s
	iters: 900, epoch: 3 | loss: 0.2171639
	speed: 0.0111s/iter; left time: 58.6597s
	iters: 1000, epoch: 3 | loss: 0.2734383
	speed: 0.0111s/iter; left time: 57.3409s
Updating learning rate to 2.9763721375e-05
Validation loss decreased (0.3638 --> 0.3435).  Saving model state dict ...
Epoch: 3 cost time: 11.436956405639648
Epoch: 3, Steps: 1027 | Train Loss: 0.3820146 Vali Loss: 0.3435125 Best vali loss: 0.3435125
	iters: 100, epoch: 4 | loss: 0.3386151
	speed: 0.0315s/iter; left time: 158.7764s
	iters: 200, epoch: 4 | loss: 0.2738165
	speed: 0.0107s/iter; left time: 52.8067s
	iters: 300, epoch: 4 | loss: 1.1440593
	speed: 0.0107s/iter; left time: 51.5755s
	iters: 400, epoch: 4 | loss: 0.7352260
	speed: 0.0146s/iter; left time: 69.0879s
	iters: 500, epoch: 4 | loss: 0.2930363
	speed: 0.0155s/iter; left time: 71.9106s
	iters: 600, epoch: 4 | loss: 0.2213871
	speed: 0.0161s/iter; left time: 73.0804s
	iters: 700, epoch: 4 | loss: 0.8593217
	speed: 0.0160s/iter; left time: 70.8434s
	iters: 800, epoch: 4 | loss: 0.2326748
	speed: 0.0149s/iter; left time: 64.7516s
	iters: 900, epoch: 4 | loss: 0.1879731
	speed: 0.0147s/iter; left time: 62.1543s
	iters: 1000, epoch: 4 | loss: 0.4472474
	speed: 0.0131s/iter; left time: 54.2287s
Updating learning rate to 1.48818606875e-05
Epoch: 4 cost time: 14.29244613647461
Epoch: 4, Steps: 1027 | Train Loss: 0.4733357 Vali Loss: 0.3551354 Best vali loss: 0.3435125
	iters: 100, epoch: 5 | loss: 0.3394321
	speed: 0.0426s/iter; left time: 170.9074s
	iters: 200, epoch: 5 | loss: 0.6366608
	speed: 0.0151s/iter; left time: 58.9353s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0019798308604, 'e_layers': 3, 'learning_rate': 0.0003451809696, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7469369
	speed: 0.0160s/iter; left time: 129.7512s
	iters: 200, epoch: 1 | loss: 0.4765596
	speed: 0.0103s/iter; left time: 82.9079s
	iters: 300, epoch: 1 | loss: 0.2538963
	speed: 0.0123s/iter; left time: 97.5795s
	iters: 400, epoch: 1 | loss: 0.4878974
	speed: 0.0113s/iter; left time: 88.1043s
	iters: 500, epoch: 1 | loss: 0.9432218
	speed: 0.0117s/iter; left time: 90.0431s
	iters: 600, epoch: 1 | loss: 0.5286934
	speed: 0.0121s/iter; left time: 92.3099s
	iters: 700, epoch: 1 | loss: 0.8154411
	speed: 0.0102s/iter; left time: 76.8506s
	iters: 800, epoch: 1 | loss: 1.0368872
	speed: 0.0096s/iter; left time: 71.0304s
	iters: 900, epoch: 1 | loss: 0.4107592
	speed: 0.0079s/iter; left time: 57.4641s
	iters: 1000, epoch: 1 | loss: 0.4213399
	speed: 0.0075s/iter; left time: 53.9829s
Updating learning rate to 0.00033204330121292035
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 10.827069997787476
Epoch: 1, Steps: 1027 | Train Loss: 0.6121633 Vali Loss: 0.3708636 Best vali loss: 0.3708636
	iters: 100, epoch: 2 | loss: 0.8611535
	speed: 0.0263s/iter; left time: 186.3544s
	iters: 200, epoch: 2 | loss: 1.5494779
	speed: 0.0066s/iter; left time: 46.4352s
	iters: 300, epoch: 2 | loss: 0.8076458
	speed: 0.0070s/iter; left time: 48.1982s
	iters: 400, epoch: 2 | loss: 0.9056513
	speed: 0.0067s/iter; left time: 45.7403s
	iters: 500, epoch: 2 | loss: 0.2989464
	speed: 0.0081s/iter; left time: 53.9218s
	iters: 600, epoch: 2 | loss: 0.2073060
	speed: 0.0076s/iter; left time: 50.2843s
	iters: 700, epoch: 2 | loss: 0.3629073
	speed: 0.0082s/iter; left time: 53.0703s
	iters: 800, epoch: 2 | loss: 0.4280257
	speed: 0.0086s/iter; left time: 55.0950s
	iters: 900, epoch: 2 | loss: 0.5359182
	speed: 0.0082s/iter; left time: 51.7365s
	iters: 1000, epoch: 2 | loss: 0.4421510
	speed: 0.0082s/iter; left time: 50.8608s
Updating learning rate to 0.00029463038697035375
Epoch: 2 cost time: 8.108920097351074
Epoch: 2, Steps: 1027 | Train Loss: 0.6399183 Vali Loss: 0.3783132 Best vali loss: 0.3708636
	iters: 100, epoch: 3 | loss: 0.7990652
	speed: 0.0238s/iter; left time: 144.2163s
	iters: 200, epoch: 3 | loss: 0.6597698
	speed: 0.0078s/iter; left time: 46.6892s
	iters: 300, epoch: 3 | loss: 0.3441258
	speed: 0.0073s/iter; left time: 42.9288s
	iters: 400, epoch: 3 | loss: 0.4201792
	speed: 0.0065s/iter; left time: 37.6659s
	iters: 500, epoch: 3 | loss: 0.2196358
	speed: 0.0076s/iter; left time: 43.1988s
	iters: 600, epoch: 3 | loss: 0.9780009
	speed: 0.0084s/iter; left time: 46.8164s
	iters: 700, epoch: 3 | loss: 0.2834481
	speed: 0.0084s/iter; left time: 46.0468s
	iters: 800, epoch: 3 | loss: 1.0101885
	speed: 0.0081s/iter; left time: 43.5113s
	iters: 900, epoch: 3 | loss: 0.8314115
	speed: 0.0075s/iter; left time: 39.3457s
	iters: 1000, epoch: 3 | loss: 1.0928597
	speed: 0.0074s/iter; left time: 38.1913s
Updating learning rate to 0.00023863800391681886
Epoch: 3 cost time: 8.049728155136108
Epoch: 3, Steps: 1027 | Train Loss: 0.6638685 Vali Loss: 0.3909613 Best vali loss: 0.3708636

best validation loss 0.3708635614581099

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0027202557372, 'e_layers': 2, 'learning_rate': 0.0002478228464, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6342357
	speed: 0.0174s/iter; left time: 16.2225s
Updating learning rate to 0.0002383906509388242
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 1.8145222663879395
Epoch: 1, Steps: 129 | Train Loss: 0.6342357 Vali Loss: 0.3646097 Best vali loss: 0.3646097
	iters: 100, epoch: 2 | loss: 0.8428096
	speed: 0.0155s/iter; left time: 12.4578s
Updating learning rate to 0.00021153003081119604
Epoch: 2 cost time: 1.1931021213531494
Epoch: 2, Steps: 129 | Train Loss: 0.8428096 Vali Loss: 0.3690808 Best vali loss: 0.3646097
	iters: 100, epoch: 3 | loss: 0.4789030
	speed: 0.0185s/iter; left time: 12.5003s
Updating learning rate to 0.0001713302719394192
Validation loss decreased (0.3646 --> 0.3616).  Saving model state dict ...
Epoch: 3 cost time: 1.8237049579620361
Epoch: 3, Steps: 129 | Train Loss: 0.4789030 Vali Loss: 0.3616433 Best vali loss: 0.3616433

best validation loss 0.3616432947587873

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014883629299, 'e_layers': 2, 'learning_rate': 0.0001179211019, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5833597
	speed: 0.0129s/iter; left time: 104.5815s
	iters: 200, epoch: 1 | loss: 0.6284513
	speed: 0.0067s/iter; left time: 53.6846s
	iters: 300, epoch: 1 | loss: 0.2583550
	speed: 0.0073s/iter; left time: 57.5347s
	iters: 400, epoch: 1 | loss: 0.3238178
	speed: 0.0077s/iter; left time: 60.1256s
	iters: 500, epoch: 1 | loss: 0.1541747
	speed: 0.0076s/iter; left time: 58.6886s
	iters: 600, epoch: 1 | loss: 0.4998899
	speed: 0.0054s/iter; left time: 40.9124s
	iters: 700, epoch: 1 | loss: 0.3351117
	speed: 0.0063s/iter; left time: 47.3647s
	iters: 800, epoch: 1 | loss: 0.4875070
	speed: 0.0078s/iter; left time: 57.8800s
	iters: 900, epoch: 1 | loss: 0.3608897
	speed: 0.0080s/iter; left time: 58.7201s
	iters: 1000, epoch: 1 | loss: 0.2456942
	speed: 0.0076s/iter; left time: 54.6555s
Updating learning rate to 0.0001134329971982939
Validation loss decreased (inf --> 0.3617).  Saving model state dict ...
Epoch: 1 cost time: 7.617204427719116
Epoch: 1, Steps: 1027 | Train Loss: 0.3877251 Vali Loss: 0.3616770 Best vali loss: 0.3616770
	iters: 100, epoch: 2 | loss: 0.8449385
	speed: 0.0187s/iter; left time: 132.6199s
	iters: 200, epoch: 2 | loss: 0.2439484
	speed: 0.0068s/iter; left time: 47.2134s
	iters: 300, epoch: 2 | loss: 0.9959539
	speed: 0.0070s/iter; left time: 47.9664s
	iters: 400, epoch: 2 | loss: 0.4821340
	speed: 0.0066s/iter; left time: 45.0783s
	iters: 500, epoch: 2 | loss: 1.0068054
	speed: 0.0057s/iter; left time: 38.1299s
	iters: 600, epoch: 2 | loss: 0.4289760
	speed: 0.0071s/iter; left time: 46.5287s
	iters: 700, epoch: 2 | loss: 1.9743361
	speed: 0.0070s/iter; left time: 45.3242s
	iters: 800, epoch: 2 | loss: 0.3522088
	speed: 0.0054s/iter; left time: 34.3737s
	iters: 900, epoch: 2 | loss: 0.4356381
	speed: 0.0051s/iter; left time: 32.1431s
	iters: 1000, epoch: 2 | loss: 0.1701748
	speed: 0.0053s/iter; left time: 33.0836s
Updating learning rate to 0.00010065195634923994
Validation loss decreased (0.3617 --> 0.3574).  Saving model state dict ...
Epoch: 2 cost time: 6.508798599243164
Epoch: 2, Steps: 1027 | Train Loss: 0.6935114 Vali Loss: 0.3574200 Best vali loss: 0.3574200
	iters: 100, epoch: 3 | loss: 0.1709107
	speed: 0.0168s/iter; left time: 102.1319s
	iters: 200, epoch: 3 | loss: 0.3240747
	speed: 0.0058s/iter; left time: 34.6954s
	iters: 300, epoch: 3 | loss: 0.8232274
	speed: 0.0073s/iter; left time: 42.5297s
	iters: 400, epoch: 3 | loss: 0.2207726
	speed: 0.0070s/iter; left time: 40.4863s
	iters: 500, epoch: 3 | loss: 0.3199877
	speed: 0.0072s/iter; left time: 40.7805s
	iters: 600, epoch: 3 | loss: 1.0712647
	speed: 0.0064s/iter; left time: 35.7964s
	iters: 700, epoch: 3 | loss: 0.2663331
	speed: 0.0053s/iter; left time: 29.0661s
	iters: 800, epoch: 3 | loss: 0.9164794
	speed: 0.0064s/iter; left time: 34.4411s
	iters: 900, epoch: 3 | loss: 0.4396164
	speed: 0.0077s/iter; left time: 40.3027s
	iters: 1000, epoch: 3 | loss: 1.0929478
	speed: 0.0065s/iter; left time: 33.4536s
Updating learning rate to 8.152377696168276e-05
Epoch: 3 cost time: 6.737645626068115
Epoch: 3, Steps: 1027 | Train Loss: 0.5645615 Vali Loss: 0.3676086 Best vali loss: 0.3574200

best validation loss 0.3574199900060365

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014883629299, 'e_layers': 2, 'learning_rate': 0.0001179211019, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4155502
	speed: 0.0145s/iter; left time: 73.2661s
	iters: 200, epoch: 4 | loss: 0.4304967
	speed: 0.0075s/iter; left time: 36.8743s
	iters: 300, epoch: 4 | loss: 0.2548190
	speed: 0.0071s/iter; left time: 34.4471s
	iters: 400, epoch: 4 | loss: 0.3168736
	speed: 0.0072s/iter; left time: 34.2719s
	iters: 500, epoch: 4 | loss: 0.1411400
	speed: 0.0061s/iter; left time: 28.0790s
	iters: 600, epoch: 4 | loss: 0.4597068
	speed: 0.0072s/iter; left time: 32.8475s
	iters: 700, epoch: 4 | loss: 0.3272294
	speed: 0.0071s/iter; left time: 31.6099s
	iters: 800, epoch: 4 | loss: 0.4060543
	speed: 0.0075s/iter; left time: 32.5157s
	iters: 900, epoch: 4 | loss: 0.2934545
	speed: 0.0075s/iter; left time: 31.9233s
	iters: 1000, epoch: 4 | loss: 0.2414839
	speed: 0.0077s/iter; left time: 31.9212s
Updating learning rate to 5.896055095e-05
Validation loss decreased (0.3574 --> 0.3533).  Saving model state dict ...
Epoch: 4 cost time: 7.807480335235596
Epoch: 4, Steps: 1027 | Train Loss: 0.3286808 Vali Loss: 0.3533127 Best vali loss: 0.3533127
	iters: 100, epoch: 5 | loss: 0.8081819
	speed: 0.0197s/iter; left time: 79.0954s
	iters: 200, epoch: 5 | loss: 0.2134247
	speed: 0.0062s/iter; left time: 24.0731s
	iters: 300, epoch: 5 | loss: 0.7882937
	speed: 0.0063s/iter; left time: 23.9434s
	iters: 400, epoch: 5 | loss: 0.4627432
	speed: 0.0065s/iter; left time: 23.9942s
	iters: 500, epoch: 5 | loss: 0.8760974
	speed: 0.0095s/iter; left time: 34.1956s
	iters: 600, epoch: 5 | loss: 0.3853593
	speed: 0.0082s/iter; left time: 28.6630s
	iters: 700, epoch: 5 | loss: 0.8035243
	speed: 0.0094s/iter; left time: 32.1213s
	iters: 800, epoch: 5 | loss: 0.3319719
	speed: 0.0096s/iter; left time: 31.7218s
	iters: 900, epoch: 5 | loss: 0.3645823
	speed: 0.0075s/iter; left time: 23.9156s
	iters: 1000, epoch: 5 | loss: 0.1623609
	speed: 0.0090s/iter; left time: 27.9490s
Updating learning rate to 3.639732493831725e-05
Epoch: 5 cost time: 8.084917783737183
Epoch: 5, Steps: 1027 | Train Loss: 0.5196540 Vali Loss: 0.3602022 Best vali loss: 0.3533127
	iters: 100, epoch: 6 | loss: 0.1794105
	speed: 0.0213s/iter; left time: 63.5845s
	iters: 200, epoch: 6 | loss: 0.2836755
	speed: 0.0071s/iter; left time: 20.4653s
	iters: 300, epoch: 6 | loss: 0.6432442
	speed: 0.0071s/iter; left time: 19.7134s
	iters: 400, epoch: 6 | loss: 0.2035105
	speed: 0.0069s/iter; left time: 18.4898s
	iters: 500, epoch: 6 | loss: 0.3153191
	speed: 0.0073s/iter; left time: 18.8428s
	iters: 600, epoch: 6 | loss: 0.8806109
	speed: 0.0066s/iter; left time: 16.3018s
	iters: 700, epoch: 6 | loss: 0.2285811
	speed: 0.0065s/iter; left time: 15.5424s
	iters: 800, epoch: 6 | loss: 0.7114673
	speed: 0.0071s/iter; left time: 16.1742s
	iters: 900, epoch: 6 | loss: 0.3572825
	speed: 0.0072s/iter; left time: 15.6775s
	iters: 1000, epoch: 6 | loss: 0.9652404
	speed: 0.0064s/iter; left time: 13.3080s
Updating learning rate to 1.7269145550760067e-05
Epoch: 6 cost time: 7.099000453948975
Epoch: 6, Steps: 1027 | Train Loss: 0.4768342 Vali Loss: 0.3629445 Best vali loss: 0.3533127
	iters: 100, epoch: 7 | loss: 0.6253468
	speed: 0.0202s/iter; left time: 39.5205s
	iters: 200, epoch: 7 | loss: 0.3366596
	speed: 0.0047s/iter; left time: 8.7832s
	iters: 300, epoch: 7 | loss: 0.7508923
	speed: 0.0061s/iter; left time: 10.7682s
	iters: 400, epoch: 7 | loss: 0.6799222
	speed: 0.0070s/iter; left time: 11.6565s
	iters: 500, epoch: 7 | loss: 0.3407208
	speed: 0.0067s/iter; left time: 10.4389s
	iters: 600, epoch: 7 | loss: 0.3877353
	speed: 0.0069s/iter; left time: 10.0782s
	iters: 700, epoch: 7 | loss: 0.3653873
	speed: 0.0074s/iter; left time: 10.0252s
	iters: 800, epoch: 7 | loss: 0.2857959
	speed: 0.0078s/iter; left time: 9.8323s
	iters: 900, epoch: 7 | loss: 0.8633489
	speed: 0.0077s/iter; left time: 8.8510s
	iters: 1000, epoch: 7 | loss: 0.1856303
	speed: 0.0069s/iter; left time: 7.2949s
Updating learning rate to 4.488104701706097e-06
Epoch: 7 cost time: 6.944038391113281
Epoch: 7, Steps: 1027 | Train Loss: 0.4821439 Vali Loss: 0.3735343 Best vali loss: 0.3533127
	iters: 100, epoch: 8 | loss: 0.8116627
	speed: 0.0212s/iter; left time: 19.7198s
	iters: 200, epoch: 8 | loss: 0.9131943
	speed: 0.0066s/iter; left time: 5.5043s
	iters: 300, epoch: 8 | loss: 0.3112409
	speed: 0.0071s/iter; left time: 5.1995s
	iters: 400, epoch: 8 | loss: 0.6927214
	speed: 0.0070s/iter; left time: 4.3867s
	iters: 500, epoch: 8 | loss: 0.8275361
	speed: 0.0069s/iter; left time: 3.6410s
	iters: 600, epoch: 8 | loss: 0.3461430
	speed: 0.0056s/iter; left time: 2.4006s
	iters: 700, epoch: 8 | loss: 0.3046119
	speed: 0.0050s/iter; left time: 1.6258s
	iters: 800, epoch: 8 | loss: 0.2615532
	speed: 0.0053s/iter; left time: 1.2034s
	iters: 900, epoch: 8 | loss: 0.2248813
	speed: 0.0052s/iter; left time: 0.6659s
	iters: 1000, epoch: 8 | loss: 0.2610629
	speed: 0.0045s/iter; left time: 0.1247s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.167715787887573
Epoch: 8, Steps: 1027 | Train Loss: 0.4954608 Vali Loss: 0.3725965 Best vali loss: 0.3533127

best validation loss 0.3533126985628619

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010775968472, 'e_layers': 1, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6368754
	speed: 0.0135s/iter; left time: 12.5522s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.3941).  Saving model state dict ...
Epoch: 1 cost time: 1.223231554031372
Epoch: 1, Steps: 129 | Train Loss: 0.6368754 Vali Loss: 0.3940658 Best vali loss: 0.3940658
	iters: 100, epoch: 2 | loss: 0.6870565
	speed: 0.0141s/iter; left time: 11.3329s
Updating learning rate to 0.0026738530511141692
Validation loss decreased (0.3941 --> 0.3849).  Saving model state dict ...
Epoch: 2 cost time: 1.0820801258087158
Epoch: 2, Steps: 129 | Train Loss: 0.6870565 Vali Loss: 0.3849258 Best vali loss: 0.3849258
	iters: 100, epoch: 3 | loss: 0.7288757
	speed: 0.0121s/iter; left time: 8.1437s
Updating learning rate to 0.002165706536403478
Epoch: 3 cost time: 0.9348673820495605
Epoch: 3, Steps: 129 | Train Loss: 0.7288757 Vali Loss: 0.3930220 Best vali loss: 0.3849258
	iters: 100, epoch: 4 | loss: 0.5578086
	speed: 0.0148s/iter; left time: 8.0580s
Updating learning rate to 0.00156630685355
Epoch: 4 cost time: 1.3794500827789307
Epoch: 4, Steps: 129 | Train Loss: 0.5578086 Vali Loss: 0.3867079 Best vali loss: 0.3849258
	iters: 100, epoch: 5 | loss: 0.4251715
	speed: 0.0153s/iter; left time: 6.3674s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 1.1078603267669678
Epoch: 5, Steps: 129 | Train Loss: 0.4251715 Vali Loss: 0.4028186 Best vali loss: 0.3849258
	iters: 100, epoch: 6 | loss: 0.6647047
	speed: 0.0144s/iter; left time: 4.1607s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 1.1475203037261963
Epoch: 6, Steps: 129 | Train Loss: 0.6647047 Vali Loss: 0.4313540 Best vali loss: 0.3849258
	iters: 100, epoch: 7 | loss: 0.4560650
	speed: 0.0156s/iter; left time: 2.4829s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 1.0206825733184814
Epoch: 7, Steps: 129 | Train Loss: 0.4560650 Vali Loss: 0.4353229 Best vali loss: 0.3849258
	iters: 100, epoch: 8 | loss: 0.4390622
	speed: 0.0132s/iter; left time: 0.3963s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.003986120223999
Epoch: 8, Steps: 129 | Train Loss: 0.4390622 Vali Loss: 0.4457090 Best vali loss: 0.3849258

best validation loss 0.3849258077870652

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0031024789255, 'e_layers': 4, 'learning_rate': 0.0016584511036, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7353536
	speed: 0.0175s/iter; left time: 16.2946s
Updating learning rate to 0.0015953300669433977
Validation loss decreased (inf --> 0.4068).  Saving model state dict ...
Epoch: 1 cost time: 1.7548086643218994
Epoch: 1, Steps: 129 | Train Loss: 0.7353536 Vali Loss: 0.4067965 Best vali loss: 0.4067965
	iters: 100, epoch: 2 | loss: 0.8377820
	speed: 0.0170s/iter; left time: 13.6752s
Updating learning rate to 0.0014155765626109366
Validation loss decreased (0.4068 --> 0.4039).  Saving model state dict ...
Epoch: 2 cost time: 1.3985962867736816
Epoch: 2, Steps: 129 | Train Loss: 0.8377820 Vali Loss: 0.4039347 Best vali loss: 0.4039347
	iters: 100, epoch: 3 | loss: 0.7458628
	speed: 0.0165s/iter; left time: 11.1180s
Updating learning rate to 0.0011465564321676595
Validation loss decreased (0.4039 --> 0.4001).  Saving model state dict ...
Epoch: 3 cost time: 1.2931783199310303
Epoch: 3, Steps: 129 | Train Loss: 0.7458628 Vali Loss: 0.4000584 Best vali loss: 0.4000584
	iters: 100, epoch: 4 | loss: 0.5539657
	speed: 0.0180s/iter; left time: 9.8404s
Updating learning rate to 0.0008292255518
Epoch: 4 cost time: 1.543062448501587
Epoch: 4, Steps: 129 | Train Loss: 0.5539657 Vali Loss: 0.4113280 Best vali loss: 0.4000584
	iters: 100, epoch: 5 | loss: 0.7417253
	speed: 0.0212s/iter; left time: 8.8278s
Updating learning rate to 0.0005118946714323404
Epoch: 5 cost time: 1.6423609256744385
Epoch: 5, Steps: 129 | Train Loss: 0.7417253 Vali Loss: 0.4058474 Best vali loss: 0.4000584
	iters: 100, epoch: 6 | loss: 0.5482506
	speed: 0.0231s/iter; left time: 6.6642s
Updating learning rate to 0.0002428745409890633
Epoch: 6 cost time: 1.9539592266082764
Epoch: 6, Steps: 129 | Train Loss: 0.5482506 Vali Loss: 0.4036300 Best vali loss: 0.4000584
	iters: 100, epoch: 7 | loss: 0.8496497
	speed: 0.0226s/iter; left time: 3.5931s
Updating learning rate to 6.312103665660221e-05
Epoch: 7 cost time: 1.937242031097412
Epoch: 7, Steps: 129 | Train Loss: 0.8496497 Vali Loss: 0.4008081 Best vali loss: 0.4000584
	iters: 100, epoch: 8 | loss: 0.8390718
	speed: 0.0215s/iter; left time: 0.6460s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.8205878734588623
Epoch: 8, Steps: 129 | Train Loss: 0.8390718 Vali Loss: 0.4023922 Best vali loss: 0.4000584

best validation loss 0.4000584036872991

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.003513619288, 'e_layers': 2, 'learning_rate': 0.0014602270359, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014602270359
Validation loss decreased (inf --> 0.3704).  Saving model state dict ...
Epoch: 1 cost time: 1.111473560333252
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3704455 Best vali loss: 0.3704455
Updating learning rate to 0.00073011351795
Epoch: 2 cost time: 0.6879968643188477
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3717249 Best vali loss: 0.3704455
Updating learning rate to 0.000365056758975
Epoch: 3 cost time: 0.7606918811798096
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3777389 Best vali loss: 0.3704455

best validation loss 0.37044545674370877

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0033855970976, 'e_layers': 3, 'learning_rate': 0.0001366613199, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3733696
	speed: 0.0184s/iter; left time: 149.4394s
	iters: 200, epoch: 1 | loss: 0.2668743
	speed: 0.0111s/iter; left time: 88.6365s
	iters: 300, epoch: 1 | loss: 0.7855661
	speed: 0.0110s/iter; left time: 87.1120s
	iters: 400, epoch: 1 | loss: 0.2507966
	speed: 0.0101s/iter; left time: 78.9908s
	iters: 500, epoch: 1 | loss: 1.5936955
	speed: 0.0073s/iter; left time: 56.4759s
	iters: 600, epoch: 1 | loss: 1.7384886
	speed: 0.0051s/iter; left time: 38.6841s
	iters: 700, epoch: 1 | loss: 0.5685717
	speed: 0.0061s/iter; left time: 45.8117s
	iters: 800, epoch: 1 | loss: 1.1852000
	speed: 0.0083s/iter; left time: 61.6253s
	iters: 900, epoch: 1 | loss: 0.3895996
	speed: 0.0082s/iter; left time: 59.6808s
	iters: 1000, epoch: 1 | loss: 1.1866270
	speed: 0.0077s/iter; left time: 55.3971s
Updating learning rate to 0.0001366613199
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 9.24201512336731
Epoch: 1, Steps: 1027 | Train Loss: 0.8338789 Vali Loss: 0.3710464 Best vali loss: 0.3710464
	iters: 100, epoch: 2 | loss: 0.7909644
	speed: 0.0231s/iter; left time: 164.1333s
	iters: 200, epoch: 2 | loss: 1.3059849
	speed: 0.0078s/iter; left time: 54.7255s
	iters: 300, epoch: 2 | loss: 0.8197219
	speed: 0.0075s/iter; left time: 51.5838s
	iters: 400, epoch: 2 | loss: 0.4584966
	speed: 0.0062s/iter; left time: 42.1278s
	iters: 500, epoch: 2 | loss: 0.4220509
	speed: 0.0072s/iter; left time: 47.9832s
	iters: 600, epoch: 2 | loss: 0.3103214
	speed: 0.0078s/iter; left time: 51.4140s
	iters: 700, epoch: 2 | loss: 0.6777882
	speed: 0.0075s/iter; left time: 48.3616s
	iters: 800, epoch: 2 | loss: 0.3416608
	speed: 0.0078s/iter; left time: 49.5469s
	iters: 900, epoch: 2 | loss: 0.3211190
	speed: 0.0080s/iter; left time: 50.3450s
	iters: 1000, epoch: 2 | loss: 0.9155587
	speed: 0.0081s/iter; left time: 50.1497s
Updating learning rate to 6.833065995e-05
Validation loss decreased (0.3710 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 7.786991596221924
Epoch: 2, Steps: 1027 | Train Loss: 0.6363667 Vali Loss: 0.3649387 Best vali loss: 0.3649387
	iters: 100, epoch: 3 | loss: 0.2817116
	speed: 0.0223s/iter; left time: 135.1528s
	iters: 200, epoch: 3 | loss: 0.9811378
	speed: 0.0065s/iter; left time: 39.0479s
	iters: 300, epoch: 3 | loss: 0.5445620
	speed: 0.0077s/iter; left time: 45.2158s
	iters: 400, epoch: 3 | loss: 1.0833859
	speed: 0.0074s/iter; left time: 42.5123s
	iters: 500, epoch: 3 | loss: 0.5412363
	speed: 0.0072s/iter; left time: 41.0149s
	iters: 600, epoch: 3 | loss: 1.0839458
	speed: 0.0073s/iter; left time: 40.4323s
	iters: 700, epoch: 3 | loss: 0.7732137
	speed: 0.0061s/iter; left time: 33.4404s
	iters: 800, epoch: 3 | loss: 0.9078786
	speed: 0.0063s/iter; left time: 33.9751s
	iters: 900, epoch: 3 | loss: 0.3976029
	speed: 0.0076s/iter; left time: 40.0823s
	iters: 1000, epoch: 3 | loss: 0.6877940
	speed: 0.0082s/iter; left time: 42.2164s
Updating learning rate to 3.4165329975e-05
Epoch: 3 cost time: 7.384686231613159
Epoch: 3, Steps: 1027 | Train Loss: 0.7282469 Vali Loss: 0.3675302 Best vali loss: 0.3649387

best validation loss 0.36493869320231476

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0017120270946, 'e_layers': 1, 'learning_rate': 0.0042858100912, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3553156
	speed: 0.0107s/iter; left time: 86.5926s
	iters: 200, epoch: 1 | loss: 1.0772196
	speed: 0.0044s/iter; left time: 35.3988s
	iters: 300, epoch: 1 | loss: 0.2409016
	speed: 0.0047s/iter; left time: 37.3156s
	iters: 400, epoch: 1 | loss: 0.2656357
	speed: 0.0047s/iter; left time: 36.8170s
	iters: 500, epoch: 1 | loss: 0.3721615
	speed: 0.0048s/iter; left time: 36.7430s
	iters: 600, epoch: 1 | loss: 1.0694495
	speed: 0.0045s/iter; left time: 34.3279s
	iters: 700, epoch: 1 | loss: 0.5092430
	speed: 0.0044s/iter; left time: 33.0160s
	iters: 800, epoch: 1 | loss: 1.3072239
	speed: 0.0044s/iter; left time: 32.4996s
	iters: 900, epoch: 1 | loss: 0.6822065
	speed: 0.0043s/iter; left time: 31.5813s
	iters: 1000, epoch: 1 | loss: 0.9394910
	speed: 0.0040s/iter; left time: 29.1982s
Updating learning rate to 0.0041226911573450055
Validation loss decreased (inf --> 0.4058).  Saving model state dict ...
Epoch: 1 cost time: 4.928626537322998
Epoch: 1, Steps: 1027 | Train Loss: 0.6818848 Vali Loss: 0.4058389 Best vali loss: 0.4058389
	iters: 100, epoch: 2 | loss: 0.3300109
	speed: 0.0167s/iter; left time: 118.7088s
	iters: 200, epoch: 2 | loss: 0.2166627
	speed: 0.0046s/iter; left time: 31.9441s
	iters: 300, epoch: 2 | loss: 0.4634216
	speed: 0.0045s/iter; left time: 31.1450s
	iters: 400, epoch: 2 | loss: 1.0166715
	speed: 0.0045s/iter; left time: 30.2529s
	iters: 500, epoch: 2 | loss: 0.4707357
	speed: 0.0046s/iter; left time: 30.5729s
	iters: 600, epoch: 2 | loss: 0.3848837
	speed: 0.0046s/iter; left time: 30.6084s
	iters: 700, epoch: 2 | loss: 0.4460922
	speed: 0.0045s/iter; left time: 29.4602s
	iters: 800, epoch: 2 | loss: 0.8489509
	speed: 0.0047s/iter; left time: 29.8883s
	iters: 900, epoch: 2 | loss: 0.9698562
	speed: 0.0044s/iter; left time: 27.7720s
	iters: 1000, epoch: 2 | loss: 1.8107935
	speed: 0.0040s/iter; left time: 24.9694s
Updating learning rate to 0.0036581677347826275
Validation loss decreased (0.4058 --> 0.4038).  Saving model state dict ...
Epoch: 2 cost time: 4.664795398712158
Epoch: 2, Steps: 1027 | Train Loss: 0.6958079 Vali Loss: 0.4037907 Best vali loss: 0.4037907
	iters: 100, epoch: 3 | loss: 1.2010757
	speed: 0.0168s/iter; left time: 102.1143s
	iters: 200, epoch: 3 | loss: 0.4408060
	speed: 0.0048s/iter; left time: 28.3957s
	iters: 300, epoch: 3 | loss: 0.4251520
	speed: 0.0047s/iter; left time: 27.3837s
	iters: 400, epoch: 3 | loss: 0.4236595
	speed: 0.0046s/iter; left time: 26.4040s
	iters: 500, epoch: 3 | loss: 0.4320382
	speed: 0.0047s/iter; left time: 26.3681s
	iters: 600, epoch: 3 | loss: 1.5628211
	speed: 0.0047s/iter; left time: 26.4208s
	iters: 700, epoch: 3 | loss: 0.3607834
	speed: 0.0045s/iter; left time: 24.8375s
	iters: 800, epoch: 3 | loss: 0.5419490
	speed: 0.0044s/iter; left time: 23.3527s
	iters: 900, epoch: 3 | loss: 0.2933447
	speed: 0.0041s/iter; left time: 21.7980s
	iters: 1000, epoch: 3 | loss: 0.7531222
	speed: 0.0044s/iter; left time: 22.5075s
Updating learning rate to 0.0029629593036826773
Epoch: 3 cost time: 4.708076238632202
Epoch: 3, Steps: 1027 | Train Loss: 0.6434752 Vali Loss: 0.4147309 Best vali loss: 0.4037907

best validation loss 0.4037906884210283

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0033855970976, 'e_layers': 3, 'learning_rate': 0.0001366613199, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2820715
	speed: 0.0154s/iter; left time: 77.7932s
	iters: 200, epoch: 4 | loss: 0.2593623
	speed: 0.0079s/iter; left time: 39.0714s
	iters: 300, epoch: 4 | loss: 0.7391439
	speed: 0.0073s/iter; left time: 35.3046s
	iters: 400, epoch: 4 | loss: 0.2363525
	speed: 0.0078s/iter; left time: 36.9034s
	iters: 500, epoch: 4 | loss: 1.5625606
	speed: 0.0081s/iter; left time: 37.5049s
	iters: 600, epoch: 4 | loss: 1.7321372
	speed: 0.0080s/iter; left time: 36.3241s
	iters: 700, epoch: 4 | loss: 0.5596094
	speed: 0.0080s/iter; left time: 35.4376s
	iters: 800, epoch: 4 | loss: 0.6928087
	speed: 0.0075s/iter; left time: 32.7310s
	iters: 900, epoch: 4 | loss: 0.3870193
	speed: 0.0061s/iter; left time: 25.9129s
	iters: 1000, epoch: 4 | loss: 1.1257900
	speed: 0.0079s/iter; left time: 32.7514s
Updating learning rate to 1.70826649875e-05
Epoch: 4 cost time: 8.295702934265137
Epoch: 4, Steps: 1027 | Train Loss: 0.7576855 Vali Loss: 0.3705760 Best vali loss: 0.3649387
	iters: 100, epoch: 5 | loss: 0.7873983
	speed: 0.0242s/iter; left time: 97.1767s
	iters: 200, epoch: 5 | loss: 1.2821624
	speed: 0.0082s/iter; left time: 32.2427s
	iters: 300, epoch: 5 | loss: 0.5988061
	speed: 0.0077s/iter; left time: 29.2232s
	iters: 400, epoch: 5 | loss: 0.4626710
	speed: 0.0076s/iter; left time: 28.3377s
	iters: 500, epoch: 5 | loss: 0.3877431
	speed: 0.0072s/iter; left time: 26.0392s
	iters: 600, epoch: 5 | loss: 0.2819852
	speed: 0.0081s/iter; left time: 28.3863s
	iters: 700, epoch: 5 | loss: 0.6396721
	speed: 0.0091s/iter; left time: 31.0826s
	iters: 800, epoch: 5 | loss: 0.3268839
	speed: 0.0080s/iter; left time: 26.6312s
	iters: 900, epoch: 5 | loss: 0.3142337
	speed: 0.0070s/iter; left time: 22.3942s
	iters: 1000, epoch: 5 | loss: 0.9019346
	speed: 0.0073s/iter; left time: 22.7409s
Updating learning rate to 8.54133249375e-06
Epoch: 5 cost time: 8.126768112182617
Epoch: 5, Steps: 1027 | Train Loss: 0.5983490 Vali Loss: 0.3695920 Best vali loss: 0.3649387
	iters: 100, epoch: 6 | loss: 0.2691804
	speed: 0.0210s/iter; left time: 62.6971s
	iters: 200, epoch: 6 | loss: 0.9984060
	speed: 0.0078s/iter; left time: 22.4460s
	iters: 300, epoch: 6 | loss: 0.5078949
	speed: 0.0108s/iter; left time: 30.0328s
	iters: 400, epoch: 6 | loss: 1.0892447
	speed: 0.0113s/iter; left time: 30.2475s
	iters: 500, epoch: 6 | loss: 0.5321088
	speed: 0.0084s/iter; left time: 21.6896s
	iters: 600, epoch: 6 | loss: 1.0940585
	speed: 0.0115s/iter; left time: 28.6309s
	iters: 700, epoch: 6 | loss: 0.5828516
	speed: 0.0112s/iter; left time: 26.6845s
	iters: 800, epoch: 6 | loss: 0.8843587
	speed: 0.0085s/iter; left time: 19.3624s
	iters: 900, epoch: 6 | loss: 0.3876516
	speed: 0.0100s/iter; left time: 21.8807s
	iters: 1000, epoch: 6 | loss: 0.6874556
	speed: 0.0098s/iter; left time: 20.4516s
Updating learning rate to 4.270666246875e-06
Epoch: 6 cost time: 9.913035154342651
Epoch: 6, Steps: 1027 | Train Loss: 0.7033211 Vali Loss: 0.3706316 Best vali loss: 0.3649387
	iters: 100, epoch: 7 | loss: 0.3849646
	speed: 0.0349s/iter; left time: 68.1500s
	iters: 200, epoch: 7 | loss: 0.3329855
	speed: 0.0123s/iter; left time: 22.8265s
	iters: 300, epoch: 7 | loss: 0.8121993
	speed: 0.0125s/iter; left time: 21.8906s
	iters: 400, epoch: 7 | loss: 0.2760597
	speed: 0.0138s/iter; left time: 22.8886s
	iters: 500, epoch: 7 | loss: 0.2672515
	speed: 0.0116s/iter; left time: 18.0138s
	iters: 600, epoch: 7 | loss: 0.2768217
	speed: 0.0113s/iter; left time: 16.4534s
	iters: 700, epoch: 7 | loss: 0.3541307
	speed: 0.0157s/iter; left time: 21.2098s
	iters: 800, epoch: 7 | loss: 0.4731821
	speed: 0.0132s/iter; left time: 16.5063s
	iters: 900, epoch: 7 | loss: 1.2412006
	speed: 0.0150s/iter; left time: 17.3445s
	iters: 1000, epoch: 7 | loss: 0.3315271
	speed: 0.0106s/iter; left time: 11.1494s
Updating learning rate to 2.1353331234375e-06
Epoch: 7 cost time: 13.230211019515991
Epoch: 7, Steps: 1027 | Train Loss: 0.4750323 Vali Loss: 0.3708432 Best vali loss: 0.3649387
	iters: 100, epoch: 8 | loss: 0.6677936
	speed: 0.0382s/iter; left time: 35.4186s
	iters: 200, epoch: 8 | loss: 0.3644761
	speed: 0.0132s/iter; left time: 10.9097s
	iters: 300, epoch: 8 | loss: 0.8062518
	speed: 0.0124s/iter; left time: 9.0261s
	iters: 400, epoch: 8 | loss: 0.2711269
	speed: 0.0074s/iter; left time: 4.6210s
	iters: 500, epoch: 8 | loss: 0.5962401
	speed: 0.0087s/iter; left time: 4.6170s
	iters: 600, epoch: 8 | loss: 0.3354590
	speed: 0.0080s/iter; left time: 3.4213s
	iters: 700, epoch: 8 | loss: 0.7196355
	speed: 0.0089s/iter; left time: 2.9303s
	iters: 800, epoch: 8 | loss: 1.2558795
	speed: 0.0113s/iter; left time: 2.5871s
	iters: 900, epoch: 8 | loss: 0.2629967
	speed: 0.0105s/iter; left time: 1.3396s
	iters: 1000, epoch: 8 | loss: 0.5653250
	speed: 0.0068s/iter; left time: 0.1895s
Updating learning rate to 1.06766656171875e-06
Epoch: 8 cost time: 10.40840744972229
Epoch: 8, Steps: 1027 | Train Loss: 0.5845184 Vali Loss: 0.3709081 Best vali loss: 0.3649387

best validation loss 0.36493869320231476

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0063474459393, 'e_layers': 4, 'learning_rate': 0.0023919052306, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6472610
	speed: 0.0215s/iter; left time: 20.0357s
Updating learning rate to 0.0023919052306
Validation loss decreased (inf --> 0.3766).  Saving model state dict ...
Epoch: 1 cost time: 2.3218181133270264
Epoch: 1, Steps: 129 | Train Loss: 0.6472610 Vali Loss: 0.3766067 Best vali loss: 0.3766067
	iters: 100, epoch: 2 | loss: 0.8023233
	speed: 0.0238s/iter; left time: 19.1313s
Updating learning rate to 0.0011959526153
Epoch: 2 cost time: 2.1054201126098633
Epoch: 2, Steps: 129 | Train Loss: 0.8023233 Vali Loss: 0.3902706 Best vali loss: 0.3766067
	iters: 100, epoch: 3 | loss: 0.5727317
	speed: 0.0199s/iter; left time: 13.4141s
Updating learning rate to 0.00059797630765
Epoch: 3 cost time: 1.8510746955871582
Epoch: 3, Steps: 129 | Train Loss: 0.5727317 Vali Loss: 0.3813626 Best vali loss: 0.3766067
	iters: 100, epoch: 4 | loss: 0.7347054
	speed: 0.0301s/iter; left time: 16.4155s
Updating learning rate to 0.000298988153825
Epoch: 4 cost time: 2.6774449348449707
Epoch: 4, Steps: 129 | Train Loss: 0.7347054 Vali Loss: 0.3836858 Best vali loss: 0.3766067
	iters: 100, epoch: 5 | loss: 0.4887907
	speed: 0.0255s/iter; left time: 10.6155s
Updating learning rate to 0.0001494940769125
Epoch: 5 cost time: 1.964785099029541
Epoch: 5, Steps: 129 | Train Loss: 0.4887907 Vali Loss: 0.3869491 Best vali loss: 0.3766067
	iters: 100, epoch: 6 | loss: 0.4740928
	speed: 0.0250s/iter; left time: 7.1970s
Updating learning rate to 7.474703845625e-05
Epoch: 6 cost time: 2.187730073928833
Epoch: 6, Steps: 129 | Train Loss: 0.4740928 Vali Loss: 0.3851229 Best vali loss: 0.3766067
	iters: 100, epoch: 7 | loss: 0.4926879
	speed: 0.0242s/iter; left time: 3.8408s
Updating learning rate to 3.7373519228125e-05
Epoch: 7 cost time: 2.132782459259033
Epoch: 7, Steps: 129 | Train Loss: 0.4926879 Vali Loss: 0.3862666 Best vali loss: 0.3766067
	iters: 100, epoch: 8 | loss: 0.7722458
	speed: 0.0252s/iter; left time: 0.7566s
Updating learning rate to 1.86867596140625e-05
Epoch: 8 cost time: 2.184903383255005
Epoch: 8, Steps: 129 | Train Loss: 0.7722458 Vali Loss: 0.3881164 Best vali loss: 0.3766067

best validation loss 0.37660672784085825

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0023490767589, 'e_layers': 3, 'learning_rate': 0.0046788824728, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.004500803112222859
Validation loss decreased (inf --> 0.3731).  Saving model state dict ...
Epoch: 1 cost time: 0.9925739765167236
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3731284 Best vali loss: 0.3731284
Updating learning rate to 0.003993675998845881
Validation loss decreased (0.3731 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 0.5442349910736084
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3689623 Best vali loss: 0.3689623
Updating learning rate to 0.003234706638561982
Epoch: 3 cost time: 0.8305609226226807
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3786273 Best vali loss: 0.3689623
Updating learning rate to 0.0023394412364
Epoch: 4 cost time: 0.8097290992736816
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3783228 Best vali loss: 0.3689623
Updating learning rate to 0.0014441758342380187
Epoch: 5 cost time: 0.8603441715240479
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4117745 Best vali loss: 0.3689623
Updating learning rate to 0.0006852064739541192
Epoch: 6 cost time: 0.8569049835205078
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3887061 Best vali loss: 0.3689623
Updating learning rate to 0.00017807936057714137
Epoch: 7 cost time: 0.8286106586456299
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3958046 Best vali loss: 0.3689623
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7878215312957764
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3929193 Best vali loss: 0.3689623

best validation loss 0.36896229194283253

[INFO][smbo.py:320] Finished 600 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0046723325665, 'e_layers': 2, 'learning_rate': 0.0013135305907, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5375929
	speed: 0.0156s/iter; left time: 14.5907s
Updating learning rate to 0.0013135305907
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 1.550767183303833
Epoch: 1, Steps: 129 | Train Loss: 0.5375929 Vali Loss: 0.3711322 Best vali loss: 0.3711322
	iters: 100, epoch: 2 | loss: 0.6015311
	speed: 0.0139s/iter; left time: 11.1832s
Updating learning rate to 0.00065676529535
Validation loss decreased (0.3711 --> 0.3671).  Saving model state dict ...
Epoch: 2 cost time: 1.0903065204620361
Epoch: 2, Steps: 129 | Train Loss: 0.6015311 Vali Loss: 0.3671322 Best vali loss: 0.3671322
	iters: 100, epoch: 3 | loss: 0.6544195
	speed: 0.0154s/iter; left time: 10.4198s
Updating learning rate to 0.000328382647675
Epoch: 3 cost time: 1.2541353702545166
Epoch: 3, Steps: 129 | Train Loss: 0.6544195 Vali Loss: 0.3726948 Best vali loss: 0.3671322

best validation loss 0.3671321587735871

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0041191772107, 'e_layers': 4, 'learning_rate': 0.0002544936624, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0382750
	speed: 0.0222s/iter; left time: 89.2128s
	iters: 200, epoch: 1 | loss: 0.6603864
	speed: 0.0136s/iter; left time: 53.3319s
	iters: 300, epoch: 1 | loss: 0.8340319
	speed: 0.0119s/iter; left time: 45.5186s
	iters: 400, epoch: 1 | loss: 0.6273299
	speed: 0.0151s/iter; left time: 56.1082s
	iters: 500, epoch: 1 | loss: 0.3893622
	speed: 0.0126s/iter; left time: 45.5665s
Updating learning rate to 0.00024480757412259857
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 7.438979148864746
Epoch: 1, Steps: 514 | Train Loss: 0.7098771 Vali Loss: 0.3665680 Best vali loss: 0.3665680
	iters: 100, epoch: 2 | loss: 0.5827972
	speed: 0.0342s/iter; left time: 119.7450s
	iters: 200, epoch: 2 | loss: 1.2704782
	speed: 0.0094s/iter; left time: 31.8730s
	iters: 300, epoch: 2 | loss: 0.9132794
	speed: 0.0133s/iter; left time: 43.9605s
	iters: 400, epoch: 2 | loss: 0.8564970
	speed: 0.0154s/iter; left time: 49.1370s
	iters: 500, epoch: 2 | loss: 0.7376159
	speed: 0.0145s/iter; left time: 45.0534s
Updating learning rate to 0.00021722392842601993
Validation loss decreased (0.3666 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 6.6317949295043945
Epoch: 2, Steps: 514 | Train Loss: 0.8721336 Vali Loss: 0.3636291 Best vali loss: 0.3636291
	iters: 100, epoch: 3 | loss: 0.7279237
	speed: 0.0326s/iter; left time: 97.3089s
	iters: 200, epoch: 3 | loss: 0.4484195
	speed: 0.0139s/iter; left time: 40.0640s
	iters: 300, epoch: 3 | loss: 0.4294282
	speed: 0.0147s/iter; left time: 40.9431s
	iters: 400, epoch: 3 | loss: 0.3443392
	speed: 0.0152s/iter; left time: 40.8686s
	iters: 500, epoch: 3 | loss: 0.6012307
	speed: 0.0141s/iter; left time: 36.3849s
Updating learning rate to 0.0001759420853211972
Epoch: 3 cost time: 7.57032585144043
Epoch: 3, Steps: 514 | Train Loss: 0.5102682 Vali Loss: 0.3641614 Best vali loss: 0.3636291

best validation loss 0.36362913113914447

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0012534952035, 'e_layers': 3, 'learning_rate': 0.0004733979271, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3477909
	speed: 0.0201s/iter; left time: 162.9451s
	iters: 200, epoch: 1 | loss: 0.4280835
	speed: 0.0141s/iter; left time: 113.0437s
	iters: 300, epoch: 1 | loss: 0.4910514
	speed: 0.0142s/iter; left time: 112.3238s
	iters: 400, epoch: 1 | loss: 0.3417930
	speed: 0.0120s/iter; left time: 93.6041s
	iters: 500, epoch: 1 | loss: 1.2277606
	speed: 0.0056s/iter; left time: 43.0284s
	iters: 600, epoch: 1 | loss: 0.5611505
	speed: 0.0055s/iter; left time: 41.8129s
	iters: 700, epoch: 1 | loss: 0.7931752
	speed: 0.0077s/iter; left time: 57.8317s
	iters: 800, epoch: 1 | loss: 0.4557406
	speed: 0.0072s/iter; left time: 53.3604s
	iters: 900, epoch: 1 | loss: 0.5677943
	speed: 0.0093s/iter; left time: 67.7248s
	iters: 1000, epoch: 1 | loss: 0.3560551
	speed: 0.0104s/iter; left time: 75.1685s
Updating learning rate to 0.0004733979271
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 10.579706192016602
Epoch: 1, Steps: 1027 | Train Loss: 0.5570395 Vali Loss: 0.3648991 Best vali loss: 0.3648991
	iters: 100, epoch: 2 | loss: 0.5157906
	speed: 0.0339s/iter; left time: 240.4544s
	iters: 200, epoch: 2 | loss: 0.4633695
	speed: 0.0104s/iter; left time: 72.9959s
	iters: 300, epoch: 2 | loss: 1.0533291
	speed: 0.0090s/iter; left time: 61.7450s
	iters: 400, epoch: 2 | loss: 0.8517018
	speed: 0.0088s/iter; left time: 59.9440s
	iters: 500, epoch: 2 | loss: 0.2044988
	speed: 0.0089s/iter; left time: 59.8537s
	iters: 600, epoch: 2 | loss: 0.7700900
	speed: 0.0089s/iter; left time: 58.3408s
	iters: 700, epoch: 2 | loss: 0.9892074
	speed: 0.0102s/iter; left time: 65.9636s
	iters: 800, epoch: 2 | loss: 1.5075059
	speed: 0.0104s/iter; left time: 66.5096s
	iters: 900, epoch: 2 | loss: 0.3773007
	speed: 0.0099s/iter; left time: 62.0237s
	iters: 1000, epoch: 2 | loss: 0.4364269
	speed: 0.0098s/iter; left time: 60.8279s
Updating learning rate to 0.00023669896355
Epoch: 2 cost time: 10.010704278945923
Epoch: 2, Steps: 1027 | Train Loss: 0.7169221 Vali Loss: 0.3759778 Best vali loss: 0.3648991
	iters: 100, epoch: 3 | loss: 0.4818423
	speed: 0.0284s/iter; left time: 172.3861s
	iters: 200, epoch: 3 | loss: 0.7149383
	speed: 0.0098s/iter; left time: 58.2016s
	iters: 300, epoch: 3 | loss: 0.9190208
	speed: 0.0100s/iter; left time: 58.5766s
	iters: 400, epoch: 3 | loss: 0.3826630
	speed: 0.0099s/iter; left time: 57.2589s
	iters: 500, epoch: 3 | loss: 0.3127103
	speed: 0.0097s/iter; left time: 54.8019s
	iters: 600, epoch: 3 | loss: 0.2635726
	speed: 0.0089s/iter; left time: 49.7072s
	iters: 700, epoch: 3 | loss: 1.0566505
	speed: 0.0082s/iter; left time: 44.5680s
	iters: 800, epoch: 3 | loss: 0.2771723
	speed: 0.0103s/iter; left time: 55.0087s
	iters: 900, epoch: 3 | loss: 0.3866416
	speed: 0.0103s/iter; left time: 54.0887s
	iters: 1000, epoch: 3 | loss: 0.3650286
	speed: 0.0099s/iter; left time: 50.8724s
Updating learning rate to 0.000118349481775
Epoch: 3 cost time: 10.038002967834473
Epoch: 3, Steps: 1027 | Train Loss: 0.5160240 Vali Loss: 0.3804292 Best vali loss: 0.3648991

best validation loss 0.36489911203534287

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0041191772107, 'e_layers': 4, 'learning_rate': 0.0002544936624, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5991648
	speed: 0.0187s/iter; left time: 46.3261s
	iters: 200, epoch: 4 | loss: 0.6091815
	speed: 0.0110s/iter; left time: 26.1978s
	iters: 300, epoch: 4 | loss: 0.7068075
	speed: 0.0096s/iter; left time: 21.7471s
	iters: 400, epoch: 4 | loss: 0.6298149
	speed: 0.0112s/iter; left time: 24.2766s
	iters: 500, epoch: 4 | loss: 0.3560701
	speed: 0.0115s/iter; left time: 23.8700s
Updating learning rate to 0.0001272468312
Epoch: 4 cost time: 6.003694534301758
Epoch: 4, Steps: 514 | Train Loss: 0.5802077 Vali Loss: 0.3919503 Best vali loss: 0.3636291
	iters: 100, epoch: 5 | loss: 0.3982427
	speed: 0.0326s/iter; left time: 63.8161s
	iters: 200, epoch: 5 | loss: 0.6555358
	speed: 0.0125s/iter; left time: 23.2637s
	iters: 300, epoch: 5 | loss: 0.6394390
	speed: 0.0141s/iter; left time: 24.8482s
	iters: 400, epoch: 5 | loss: 0.8045747
	speed: 0.0146s/iter; left time: 24.1480s
	iters: 500, epoch: 5 | loss: 0.6974799
	speed: 0.0135s/iter; left time: 20.9786s
Updating learning rate to 7.855157707880281e-05
Validation loss decreased (0.3636 --> 0.3592).  Saving model state dict ...
Epoch: 5 cost time: 6.980787754058838
Epoch: 5, Steps: 514 | Train Loss: 0.6390544 Vali Loss: 0.3592086 Best vali loss: 0.3592086
	iters: 100, epoch: 6 | loss: 0.6138881
	speed: 0.0347s/iter; left time: 50.0166s
	iters: 200, epoch: 6 | loss: 0.3761683
	speed: 0.0135s/iter; left time: 18.0850s
	iters: 300, epoch: 6 | loss: 0.4365747
	speed: 0.0136s/iter; left time: 16.8524s
	iters: 400, epoch: 6 | loss: 0.2910851
	speed: 0.0132s/iter; left time: 15.0895s
	iters: 500, epoch: 6 | loss: 0.5732133
	speed: 0.0138s/iter; left time: 14.3813s
Updating learning rate to 3.7269733973980056e-05
Validation loss decreased (0.3592 --> 0.3522).  Saving model state dict ...
Epoch: 6 cost time: 6.892019987106323
Epoch: 6, Steps: 514 | Train Loss: 0.4581859 Vali Loss: 0.3522337 Best vali loss: 0.3522337
	iters: 100, epoch: 7 | loss: 0.7733582
	speed: 0.0509s/iter; left time: 47.3050s
	iters: 200, epoch: 7 | loss: 0.4370889
	speed: 0.0115s/iter; left time: 9.5034s
	iters: 300, epoch: 7 | loss: 0.3942376
	speed: 0.0069s/iter; left time: 5.0423s
	iters: 400, epoch: 7 | loss: 0.6570022
	speed: 0.0150s/iter; left time: 9.4044s
	iters: 500, epoch: 7 | loss: 0.3243513
	speed: 0.0164s/iter; left time: 8.6574s
Updating learning rate to 9.686088277401384e-06
Epoch: 7 cost time: 6.626075744628906
Epoch: 7, Steps: 514 | Train Loss: 0.5172076 Vali Loss: 0.3523616 Best vali loss: 0.3522337
	iters: 100, epoch: 8 | loss: 0.7065393
	speed: 0.0373s/iter; left time: 15.4879s
	iters: 200, epoch: 8 | loss: 0.4692261
	speed: 0.0148s/iter; left time: 4.6733s
	iters: 300, epoch: 8 | loss: 0.3210945
	speed: 0.0167s/iter; left time: 3.5988s
	iters: 400, epoch: 8 | loss: 0.7180077
	speed: 0.0156s/iter; left time: 1.7892s
	iters: 500, epoch: 8 | loss: 0.2921782
	speed: 0.0119s/iter; left time: 0.1788s
Updating learning rate to 0.0
Validation loss decreased (0.3522 --> 0.3519).  Saving model state dict ...
Epoch: 8 cost time: 7.584619045257568
Epoch: 8, Steps: 514 | Train Loss: 0.5014092 Vali Loss: 0.3518709 Best vali loss: 0.3518709

best validation loss 0.3518708630605859

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0037946543573, 'e_layers': 3, 'learning_rate': 0.000597159767, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5202317
	speed: 0.0151s/iter; left time: 60.6746s
	iters: 200, epoch: 1 | loss: 0.4281462
	speed: 0.0083s/iter; left time: 32.5610s
	iters: 300, epoch: 1 | loss: 0.3192955
	speed: 0.0078s/iter; left time: 29.9191s
	iters: 400, epoch: 1 | loss: 1.1651253
	speed: 0.0089s/iter; left time: 33.0227s
	iters: 500, epoch: 1 | loss: 0.9449448
	speed: 0.0089s/iter; left time: 32.0658s
Updating learning rate to 0.000597159767
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 4.690327405929565
Epoch: 1, Steps: 514 | Train Loss: 0.8755487 Vali Loss: 0.3696708 Best vali loss: 0.3696708
	iters: 100, epoch: 2 | loss: 0.7015032
	speed: 0.0188s/iter; left time: 65.9160s
	iters: 200, epoch: 2 | loss: 0.7552731
	speed: 0.0084s/iter; left time: 28.5447s
	iters: 300, epoch: 2 | loss: 0.4002824
	speed: 0.0077s/iter; left time: 25.5102s
	iters: 400, epoch: 2 | loss: 0.4845973
	speed: 0.0079s/iter; left time: 25.3664s
	iters: 500, epoch: 2 | loss: 0.5330406
	speed: 0.0082s/iter; left time: 25.3380s
Updating learning rate to 0.0002985798835
Validation loss decreased (0.3697 --> 0.3696).  Saving model state dict ...
Epoch: 2 cost time: 4.193986415863037
Epoch: 2, Steps: 514 | Train Loss: 0.5749393 Vali Loss: 0.3696072 Best vali loss: 0.3696072
	iters: 100, epoch: 3 | loss: 0.4181803
	speed: 0.0182s/iter; left time: 54.1883s
	iters: 200, epoch: 3 | loss: 0.7809427
	speed: 0.0087s/iter; left time: 25.0462s
	iters: 300, epoch: 3 | loss: 0.4477509
	speed: 0.0078s/iter; left time: 21.8335s
	iters: 400, epoch: 3 | loss: 0.3688633
	speed: 0.0079s/iter; left time: 21.1745s
	iters: 500, epoch: 3 | loss: 0.3097427
	speed: 0.0081s/iter; left time: 20.8930s
Updating learning rate to 0.00014928994175
Epoch: 3 cost time: 4.30994439125061
Epoch: 3, Steps: 514 | Train Loss: 0.4650960 Vali Loss: 0.3725197 Best vali loss: 0.3696072
	iters: 100, epoch: 4 | loss: 0.3417539
	speed: 0.0176s/iter; left time: 43.4980s
	iters: 200, epoch: 4 | loss: 0.3575286
	speed: 0.0083s/iter; left time: 19.5722s
	iters: 300, epoch: 4 | loss: 0.7522090
	speed: 0.0079s/iter; left time: 17.9981s
	iters: 400, epoch: 4 | loss: 0.3894421
	speed: 0.0092s/iter; left time: 20.0587s
	iters: 500, epoch: 4 | loss: 0.5464656
	speed: 0.0081s/iter; left time: 16.7022s
Updating learning rate to 7.4644970875e-05
Epoch: 4 cost time: 4.346461296081543
Epoch: 4, Steps: 514 | Train Loss: 0.4774798 Vali Loss: 0.3705728 Best vali loss: 0.3696072
	iters: 100, epoch: 5 | loss: 0.7487988
	speed: 0.0180s/iter; left time: 35.2689s
	iters: 200, epoch: 5 | loss: 0.5930073
	speed: 0.0082s/iter; left time: 15.1517s
	iters: 300, epoch: 5 | loss: 0.8959508
	speed: 0.0080s/iter; left time: 14.1206s
	iters: 400, epoch: 5 | loss: 0.3364977
	speed: 0.0077s/iter; left time: 12.8222s
	iters: 500, epoch: 5 | loss: 0.6517845
	speed: 0.0078s/iter; left time: 12.1381s
Updating learning rate to 3.73224854375e-05
Epoch: 5 cost time: 4.1879966259002686
Epoch: 5, Steps: 514 | Train Loss: 0.6452078 Vali Loss: 0.3707936 Best vali loss: 0.3696072
	iters: 100, epoch: 6 | loss: 0.4980388
	speed: 0.0201s/iter; left time: 29.0545s
	iters: 200, epoch: 6 | loss: 0.4576460
	speed: 0.0084s/iter; left time: 11.3044s
	iters: 300, epoch: 6 | loss: 0.7774412
	speed: 0.0082s/iter; left time: 10.1704s
	iters: 400, epoch: 6 | loss: 1.0913634
	speed: 0.0084s/iter; left time: 9.5626s
	iters: 500, epoch: 6 | loss: 0.3390291
	speed: 0.0081s/iter; left time: 8.4983s
Updating learning rate to 1.866124271875e-05
Epoch: 6 cost time: 4.463932514190674
Epoch: 6, Steps: 514 | Train Loss: 0.6327037 Vali Loss: 0.3704992 Best vali loss: 0.3696072
	iters: 100, epoch: 7 | loss: 0.6977847
	speed: 0.0189s/iter; left time: 17.5486s
	iters: 200, epoch: 7 | loss: 0.4734236
	speed: 0.0092s/iter; left time: 7.5903s
	iters: 300, epoch: 7 | loss: 0.6096053
	speed: 0.0085s/iter; left time: 6.2243s
	iters: 400, epoch: 7 | loss: 0.4036590
	speed: 0.0081s/iter; left time: 5.1080s
	iters: 500, epoch: 7 | loss: 0.4824887
	speed: 0.0086s/iter; left time: 4.5569s
Updating learning rate to 9.330621359375e-06
Epoch: 7 cost time: 4.44418740272522
Epoch: 7, Steps: 514 | Train Loss: 0.5333923 Vali Loss: 0.3707015 Best vali loss: 0.3696072
	iters: 100, epoch: 8 | loss: 0.5584535
	speed: 0.0206s/iter; left time: 8.5358s
	iters: 200, epoch: 8 | loss: 0.6872056
	speed: 0.0078s/iter; left time: 2.4622s
	iters: 300, epoch: 8 | loss: 0.6177422
	speed: 0.0079s/iter; left time: 1.6881s
	iters: 400, epoch: 8 | loss: 0.4897758
	speed: 0.0092s/iter; left time: 1.0546s
	iters: 500, epoch: 8 | loss: 0.2738855
	speed: 0.0087s/iter; left time: 0.1305s
Updating learning rate to 4.6653106796875e-06
Epoch: 8 cost time: 4.329256296157837
Epoch: 8, Steps: 514 | Train Loss: 0.5254125 Vali Loss: 0.3710411 Best vali loss: 0.3696072

best validation loss 0.3696072351019134

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012227245979, 'e_layers': 4, 'learning_rate': 0.0010346098134, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7370775
	speed: 0.0159s/iter; left time: 63.9004s
	iters: 200, epoch: 1 | loss: 0.6278354
	speed: 0.0093s/iter; left time: 36.4863s
	iters: 300, epoch: 1 | loss: 0.5638921
	speed: 0.0078s/iter; left time: 29.8931s
	iters: 400, epoch: 1 | loss: 0.8513131
	speed: 0.0096s/iter; left time: 35.5246s
	iters: 500, epoch: 1 | loss: 0.6995357
	speed: 0.0100s/iter; left time: 36.1838s
Updating learning rate to 0.0009952323220677908
Validation loss decreased (inf --> 0.3883).  Saving model state dict ...
Epoch: 1 cost time: 5.093742847442627
Epoch: 1, Steps: 514 | Train Loss: 0.6959308 Vali Loss: 0.3883356 Best vali loss: 0.3883356
	iters: 100, epoch: 2 | loss: 0.3915207
	speed: 0.0205s/iter; left time: 71.7178s
	iters: 200, epoch: 2 | loss: 0.2859352
	speed: 0.0099s/iter; left time: 33.6882s
	iters: 300, epoch: 2 | loss: 0.4348688
	speed: 0.0097s/iter; left time: 31.9688s
	iters: 400, epoch: 2 | loss: 0.5204545
	speed: 0.0104s/iter; left time: 33.4168s
	iters: 500, epoch: 2 | loss: 0.6432769
	speed: 0.0103s/iter; left time: 31.7873s
Updating learning rate to 0.0008830947141686443
Validation loss decreased (0.3883 --> 0.3781).  Saving model state dict ...
Epoch: 2 cost time: 5.232125520706177
Epoch: 2, Steps: 514 | Train Loss: 0.4552112 Vali Loss: 0.3781126 Best vali loss: 0.3781126
	iters: 100, epoch: 3 | loss: 0.3250096
	speed: 0.0193s/iter; left time: 57.6186s
	iters: 200, epoch: 3 | loss: 0.3245683
	speed: 0.0090s/iter; left time: 26.0889s
	iters: 300, epoch: 3 | loss: 0.4606817
	speed: 0.0096s/iter; left time: 26.8540s
	iters: 400, epoch: 3 | loss: 0.2494892
	speed: 0.0091s/iter; left time: 24.5118s
	iters: 500, epoch: 3 | loss: 0.7426729
	speed: 0.0094s/iter; left time: 24.3610s
Updating learning rate to 0.0007152689239752586
Validation loss decreased (0.3781 --> 0.3780).  Saving model state dict ...
Epoch: 3 cost time: 4.790400505065918
Epoch: 3, Steps: 514 | Train Loss: 0.4204843 Vali Loss: 0.3780442 Best vali loss: 0.3780442
	iters: 100, epoch: 4 | loss: 0.3129025
	speed: 0.0205s/iter; left time: 50.7359s
	iters: 200, epoch: 4 | loss: 0.3895924
	speed: 0.0112s/iter; left time: 26.4617s
	iters: 300, epoch: 4 | loss: 0.7694117
	speed: 0.0117s/iter; left time: 26.4903s
	iters: 400, epoch: 4 | loss: 0.6368846
	speed: 0.0121s/iter; left time: 26.2041s
	iters: 500, epoch: 4 | loss: 0.4518495
	speed: 0.0129s/iter; left time: 26.7129s
Updating learning rate to 0.0005173049067
Epoch: 4 cost time: 6.104986906051636
Epoch: 4, Steps: 514 | Train Loss: 0.5121281 Vali Loss: 0.3820641 Best vali loss: 0.3780442
	iters: 100, epoch: 5 | loss: 0.4458930
	speed: 0.0496s/iter; left time: 97.1464s
	iters: 200, epoch: 5 | loss: 1.0908968
	speed: 0.0097s/iter; left time: 18.0825s
	iters: 300, epoch: 5 | loss: 0.6218020
	speed: 0.0101s/iter; left time: 17.8138s
	iters: 400, epoch: 5 | loss: 0.6369185
	speed: 0.0103s/iter; left time: 17.0949s
	iters: 500, epoch: 5 | loss: 0.3061766
	speed: 0.0104s/iter; left time: 16.1601s
Updating learning rate to 0.00031934088942474153
Epoch: 5 cost time: 5.175631523132324
Epoch: 5, Steps: 514 | Train Loss: 0.6203374 Vali Loss: 0.4029971 Best vali loss: 0.3780442
	iters: 100, epoch: 6 | loss: 0.5387402
	speed: 0.0196s/iter; left time: 28.2839s
	iters: 200, epoch: 6 | loss: 0.3828670
	speed: 0.0096s/iter; left time: 12.9547s
	iters: 300, epoch: 6 | loss: 0.5718152
	speed: 0.0095s/iter; left time: 11.7852s
	iters: 400, epoch: 6 | loss: 0.3859909
	speed: 0.0091s/iter; left time: 10.3640s
	iters: 500, epoch: 6 | loss: 0.3219644
	speed: 0.0144s/iter; left time: 15.0404s
Updating learning rate to 0.00015151509923135576
Epoch: 6 cost time: 5.584173917770386
Epoch: 6, Steps: 514 | Train Loss: 0.4402755 Vali Loss: 0.3998220 Best vali loss: 0.3780442
	iters: 100, epoch: 7 | loss: 0.4351321
	speed: 0.0414s/iter; left time: 38.4735s
	iters: 200, epoch: 7 | loss: 0.5799633
	speed: 0.0123s/iter; left time: 10.1566s
	iters: 300, epoch: 7 | loss: 0.5909163
	speed: 0.0117s/iter; left time: 8.5238s
	iters: 400, epoch: 7 | loss: 0.4115454
	speed: 0.0127s/iter; left time: 7.9744s
	iters: 500, epoch: 7 | loss: 0.8078116
	speed: 0.0125s/iter; left time: 6.6134s
Updating learning rate to 3.93774913322092e-05
Epoch: 7 cost time: 6.305432319641113
Epoch: 7, Steps: 514 | Train Loss: 0.5650737 Vali Loss: 0.4040576 Best vali loss: 0.3780442
	iters: 100, epoch: 8 | loss: 0.5330145
	speed: 0.0342s/iter; left time: 14.2106s
	iters: 200, epoch: 8 | loss: 0.6062271
	speed: 0.0114s/iter; left time: 3.5937s
	iters: 300, epoch: 8 | loss: 0.6618838
	speed: 0.0138s/iter; left time: 2.9585s
	iters: 400, epoch: 8 | loss: 0.3274485
	speed: 0.0116s/iter; left time: 1.3323s
	iters: 500, epoch: 8 | loss: 0.5119349
	speed: 0.0082s/iter; left time: 0.1227s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.865309476852417
Epoch: 8, Steps: 514 | Train Loss: 0.5281018 Vali Loss: 0.4059652 Best vali loss: 0.3780442

best validation loss 0.37804418792307726

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0018973779905, 'e_layers': 1, 'learning_rate': 0.0007567722941, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7447665
	speed: 0.0122s/iter; left time: 98.9685s
	iters: 200, epoch: 1 | loss: 1.2794304
	speed: 0.0061s/iter; left time: 48.7665s
	iters: 300, epoch: 1 | loss: 1.0984654
	speed: 0.0049s/iter; left time: 38.6998s
	iters: 400, epoch: 1 | loss: 0.7218336
	speed: 0.0051s/iter; left time: 40.1053s
	iters: 500, epoch: 1 | loss: 0.5512603
	speed: 0.0067s/iter; left time: 51.8895s
	iters: 600, epoch: 1 | loss: 0.7847500
	speed: 0.0064s/iter; left time: 48.7008s
	iters: 700, epoch: 1 | loss: 0.3609822
	speed: 0.0066s/iter; left time: 49.5566s
	iters: 800, epoch: 1 | loss: 0.2290195
	speed: 0.0057s/iter; left time: 42.3292s
	iters: 900, epoch: 1 | loss: 0.3593806
	speed: 0.0050s/iter; left time: 36.8303s
	iters: 1000, epoch: 1 | loss: 0.3222857
	speed: 0.0036s/iter; left time: 25.7138s
Updating learning rate to 0.0007567722941
Validation loss decreased (inf --> 0.3830).  Saving model state dict ...
Epoch: 1 cost time: 5.998135805130005
Epoch: 1, Steps: 1027 | Train Loss: 0.6452174 Vali Loss: 0.3830306 Best vali loss: 0.3830306
	iters: 100, epoch: 2 | loss: 0.5565814
	speed: 0.0160s/iter; left time: 113.3131s
	iters: 200, epoch: 2 | loss: 0.2740214
	speed: 0.0041s/iter; left time: 28.6898s
	iters: 300, epoch: 2 | loss: 0.8534282
	speed: 0.0044s/iter; left time: 30.5693s
	iters: 400, epoch: 2 | loss: 0.3465774
	speed: 0.0040s/iter; left time: 27.4198s
	iters: 500, epoch: 2 | loss: 0.3337864
	speed: 0.0038s/iter; left time: 25.6762s
	iters: 600, epoch: 2 | loss: 0.9525330
	speed: 0.0043s/iter; left time: 28.1657s
	iters: 700, epoch: 2 | loss: 0.2183130
	speed: 0.0043s/iter; left time: 28.0207s
	iters: 800, epoch: 2 | loss: 0.8444700
	speed: 0.0055s/iter; left time: 35.0186s
	iters: 900, epoch: 2 | loss: 0.9495555
	speed: 0.0055s/iter; left time: 34.4283s
	iters: 1000, epoch: 2 | loss: 0.1946450
	speed: 0.0046s/iter; left time: 28.5618s
Updating learning rate to 0.00037838614705
Validation loss decreased (0.3830 --> 0.3727).  Saving model state dict ...
Epoch: 2 cost time: 4.62830662727356
Epoch: 2, Steps: 1027 | Train Loss: 0.5523911 Vali Loss: 0.3727146 Best vali loss: 0.3727146
	iters: 100, epoch: 3 | loss: 0.8743792
	speed: 0.0209s/iter; left time: 126.6908s
	iters: 200, epoch: 3 | loss: 0.2619437
	speed: 0.0046s/iter; left time: 27.1808s
	iters: 300, epoch: 3 | loss: 0.7272801
	speed: 0.0054s/iter; left time: 31.7048s
	iters: 400, epoch: 3 | loss: 0.4387213
	speed: 0.0053s/iter; left time: 30.8009s
	iters: 500, epoch: 3 | loss: 1.3420182
	speed: 0.0054s/iter; left time: 30.5343s
	iters: 600, epoch: 3 | loss: 0.2149576
	speed: 0.0053s/iter; left time: 29.5415s
	iters: 700, epoch: 3 | loss: 0.2701648
	speed: 0.0047s/iter; left time: 25.5031s
	iters: 800, epoch: 3 | loss: 0.3506305
	speed: 0.0050s/iter; left time: 26.9286s
	iters: 900, epoch: 3 | loss: 0.3590338
	speed: 0.0049s/iter; left time: 25.9626s
	iters: 1000, epoch: 3 | loss: 0.4339424
	speed: 0.0050s/iter; left time: 25.9803s
Updating learning rate to 0.000189193073525
Epoch: 3 cost time: 5.254095554351807
Epoch: 3, Steps: 1027 | Train Loss: 0.5273072 Vali Loss: 0.3876895 Best vali loss: 0.3727146

best validation loss 0.3727145622427665

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0016850189265, 'e_layers': 4, 'learning_rate': 0.0006374455458, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6420533
	speed: 0.0198s/iter; left time: 79.5711s
	iters: 200, epoch: 1 | loss: 0.4154214
	speed: 0.0133s/iter; left time: 52.1777s
	iters: 300, epoch: 1 | loss: 0.3131136
	speed: 0.0119s/iter; left time: 45.2904s
	iters: 400, epoch: 1 | loss: 1.6353294
	speed: 0.0116s/iter; left time: 43.2363s
	iters: 500, epoch: 1 | loss: 0.3473672
	speed: 0.0123s/iter; left time: 44.6189s
Updating learning rate to 0.000613184219327553
Validation loss decreased (inf --> 0.3939).  Saving model state dict ...
Epoch: 1 cost time: 6.74512791633606
Epoch: 1, Steps: 514 | Train Loss: 0.6706570 Vali Loss: 0.3938647 Best vali loss: 0.3938647
	iters: 100, epoch: 2 | loss: 0.5009682
	speed: 0.0345s/iter; left time: 120.8288s
	iters: 200, epoch: 2 | loss: 0.7535830
	speed: 0.0124s/iter; left time: 42.1659s
	iters: 300, epoch: 2 | loss: 0.6126673
	speed: 0.0120s/iter; left time: 39.5886s
	iters: 400, epoch: 2 | loss: 0.6731095
	speed: 0.0093s/iter; left time: 29.8715s
	iters: 500, epoch: 2 | loss: 0.3851738
	speed: 0.0136s/iter; left time: 42.2921s
Updating learning rate to 0.00054409380693617
Epoch: 2 cost time: 6.202370643615723
Epoch: 2, Steps: 514 | Train Loss: 0.5851003 Vali Loss: 0.4006865 Best vali loss: 0.3938647
	iters: 100, epoch: 3 | loss: 0.9224153
	speed: 0.0381s/iter; left time: 113.6240s
	iters: 200, epoch: 3 | loss: 0.3503234
	speed: 0.0126s/iter; left time: 36.2399s
	iters: 300, epoch: 3 | loss: 0.8096388
	speed: 0.0131s/iter; left time: 36.4470s
	iters: 400, epoch: 3 | loss: 1.0084417
	speed: 0.0137s/iter; left time: 36.8914s
	iters: 500, epoch: 3 | loss: 0.6937881
	speed: 0.0133s/iter; left time: 34.3619s
Updating learning rate to 0.000440692697606291
Epoch: 3 cost time: 6.687171936035156
Epoch: 3, Steps: 514 | Train Loss: 0.7569214 Vali Loss: 0.4079484 Best vali loss: 0.3938647

best validation loss 0.39386469685492675

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0019391438008, 'e_layers': 3, 'learning_rate': 0.0004988908191, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8165422
	speed: 0.0170s/iter; left time: 33.2708s
	iters: 200, epoch: 1 | loss: 0.5259610
	speed: 0.0105s/iter; left time: 19.4631s
Updating learning rate to 0.0004988908191
Validation loss decreased (inf --> 0.3753).  Saving model state dict ...
Epoch: 1 cost time: 2.985379934310913
Epoch: 1, Steps: 257 | Train Loss: 0.6712516 Vali Loss: 0.3752906 Best vali loss: 0.3752906
	iters: 100, epoch: 2 | loss: 0.7350852
	speed: 0.0250s/iter; left time: 42.5617s
	iters: 200, epoch: 2 | loss: 0.3501272
	speed: 0.0149s/iter; left time: 23.8072s
Updating learning rate to 0.00024944540955
Validation loss decreased (0.3753 --> 0.3700).  Saving model state dict ...
Epoch: 2 cost time: 3.5214309692382812
Epoch: 2, Steps: 257 | Train Loss: 0.5426062 Vali Loss: 0.3700306 Best vali loss: 0.3700306
	iters: 100, epoch: 3 | loss: 0.3552569
	speed: 0.0241s/iter; left time: 34.7556s
	iters: 200, epoch: 3 | loss: 0.5159428
	speed: 0.0154s/iter; left time: 20.6698s
Updating learning rate to 0.000124722704775
Validation loss decreased (0.3700 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 3.6049296855926514
Epoch: 3, Steps: 257 | Train Loss: 0.4355998 Vali Loss: 0.3676908 Best vali loss: 0.3676908

best validation loss 0.367690844807503

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.0019391438008, 'e_layers': 3, 'learning_rate': 0.0004988908191, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6041178
	speed: 0.0248s/iter; left time: 29.4278s
	iters: 200, epoch: 4 | loss: 0.4943343
	speed: 0.0189s/iter; left time: 20.4902s
Updating learning rate to 6.23613523875e-05
Epoch: 4 cost time: 4.861299753189087
Epoch: 4, Steps: 257 | Train Loss: 0.5492261 Vali Loss: 0.3694287 Best vali loss: 0.3676908
	iters: 100, epoch: 5 | loss: 0.6947149
	speed: 0.0398s/iter; left time: 36.9695s
	iters: 200, epoch: 5 | loss: 0.3461502
	speed: 0.0153s/iter; left time: 12.7190s
Updating learning rate to 3.118067619375e-05
Epoch: 5 cost time: 4.14616847038269
Epoch: 5, Steps: 257 | Train Loss: 0.5204326 Vali Loss: 0.3704547 Best vali loss: 0.3676908
	iters: 100, epoch: 6 | loss: 0.3473386
	speed: 0.0410s/iter; left time: 27.5489s
	iters: 200, epoch: 6 | loss: 0.5056574
	speed: 0.0152s/iter; left time: 8.6971s
Updating learning rate to 1.5590338096875e-05
Epoch: 6 cost time: 4.388270616531372
Epoch: 6, Steps: 257 | Train Loss: 0.4264980 Vali Loss: 0.3716731 Best vali loss: 0.3676908
	iters: 100, epoch: 7 | loss: 0.7026532
	speed: 0.0240s/iter; left time: 9.9528s
	iters: 200, epoch: 7 | loss: 0.4459603
	speed: 0.0103s/iter; left time: 3.2529s
Updating learning rate to 7.7951690484375e-06
Epoch: 7 cost time: 2.642503261566162
Epoch: 7, Steps: 257 | Train Loss: 0.5743068 Vali Loss: 0.3718610 Best vali loss: 0.3676908
	iters: 100, epoch: 8 | loss: 0.5206282
	speed: 0.0244s/iter; left time: 3.8492s
	iters: 200, epoch: 8 | loss: 0.5728154
	speed: 0.0107s/iter; left time: 0.6187s
Updating learning rate to 3.89758452421875e-06
Epoch: 8 cost time: 2.719569206237793
Epoch: 8, Steps: 257 | Train Loss: 0.5467218 Vali Loss: 0.3722399 Best vali loss: 0.3676908

best validation loss 0.367690844807503

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0014853479781, 'e_layers': 4, 'learning_rate': 0.0003925017025, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7278602
	speed: 0.0202s/iter; left time: 81.1571s
	iters: 200, epoch: 1 | loss: 0.6208012
	speed: 0.0131s/iter; left time: 51.3032s
	iters: 300, epoch: 1 | loss: 0.5324185
	speed: 0.0129s/iter; left time: 49.2849s
	iters: 400, epoch: 1 | loss: 0.8446665
	speed: 0.0119s/iter; left time: 44.0897s
	iters: 500, epoch: 1 | loss: 0.6565661
	speed: 0.0121s/iter; left time: 43.6148s
Updating learning rate to 0.0003925017025
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 6.917893409729004
Epoch: 1, Steps: 514 | Train Loss: 0.6764625 Vali Loss: 0.3716024 Best vali loss: 0.3716024
	iters: 100, epoch: 2 | loss: 0.4126630
	speed: 0.0239s/iter; left time: 83.6181s
	iters: 200, epoch: 2 | loss: 0.2686065
	speed: 0.0127s/iter; left time: 43.2304s
	iters: 300, epoch: 2 | loss: 0.4465322
	speed: 0.0125s/iter; left time: 41.3030s
	iters: 400, epoch: 2 | loss: 0.5001107
	speed: 0.0110s/iter; left time: 35.0724s
	iters: 500, epoch: 2 | loss: 0.6848511
	speed: 0.0127s/iter; left time: 39.3023s
Updating learning rate to 0.00019625085125
Epoch: 2 cost time: 6.144093751907349
Epoch: 2, Steps: 514 | Train Loss: 0.4625527 Vali Loss: 0.3739722 Best vali loss: 0.3716024
	iters: 100, epoch: 3 | loss: 0.3113723
	speed: 0.0223s/iter; left time: 66.5893s
	iters: 200, epoch: 3 | loss: 0.3235931
	speed: 0.0131s/iter; left time: 37.7283s
	iters: 300, epoch: 3 | loss: 0.3873468
	speed: 0.0131s/iter; left time: 36.6091s
	iters: 400, epoch: 3 | loss: 0.2449398
	speed: 0.0108s/iter; left time: 29.0799s
	iters: 500, epoch: 3 | loss: 0.5661361
	speed: 0.0092s/iter; left time: 23.7501s
Updating learning rate to 9.8125425625e-05
Epoch: 3 cost time: 5.841476678848267
Epoch: 3, Steps: 514 | Train Loss: 0.3666776 Vali Loss: 0.3855242 Best vali loss: 0.3716024
	iters: 100, epoch: 4 | loss: 0.3083808
	speed: 0.0198s/iter; left time: 48.9195s
	iters: 200, epoch: 4 | loss: 0.3278727
	speed: 0.0123s/iter; left time: 29.2378s
	iters: 300, epoch: 4 | loss: 0.6822546
	speed: 0.0124s/iter; left time: 28.0955s
	iters: 400, epoch: 4 | loss: 0.5757102
	speed: 0.0133s/iter; left time: 28.9648s
	iters: 500, epoch: 4 | loss: 0.4499662
	speed: 0.0097s/iter; left time: 20.1807s
Updating learning rate to 4.90627128125e-05
Validation loss decreased (0.3716 --> 0.3611).  Saving model state dict ...
Epoch: 4 cost time: 5.903894424438477
Epoch: 4, Steps: 514 | Train Loss: 0.4688369 Vali Loss: 0.3611433 Best vali loss: 0.3611433
	iters: 100, epoch: 5 | loss: 0.3678514
	speed: 0.0338s/iter; left time: 66.0530s
	iters: 200, epoch: 5 | loss: 1.0268438
	speed: 0.0119s/iter; left time: 22.1678s
	iters: 300, epoch: 5 | loss: 0.5864040
	speed: 0.0111s/iter; left time: 19.5831s
	iters: 400, epoch: 5 | loss: 0.6090131
	speed: 0.0112s/iter; left time: 18.4920s
	iters: 500, epoch: 5 | loss: 0.3325606
	speed: 0.0088s/iter; left time: 13.7112s
Updating learning rate to 2.453135640625e-05
Validation loss decreased (0.3611 --> 0.3567).  Saving model state dict ...
Epoch: 5 cost time: 5.80275297164917
Epoch: 5, Steps: 514 | Train Loss: 0.5845346 Vali Loss: 0.3566576 Best vali loss: 0.3566576
	iters: 100, epoch: 6 | loss: 0.4528692
	speed: 0.0319s/iter; left time: 46.0751s
	iters: 200, epoch: 6 | loss: 0.5011729
	speed: 0.0085s/iter; left time: 11.3959s
	iters: 300, epoch: 6 | loss: 0.5375867
	speed: 0.0120s/iter; left time: 14.8589s
	iters: 400, epoch: 6 | loss: 0.4060082
	speed: 0.0125s/iter; left time: 14.3153s
	iters: 500, epoch: 6 | loss: 0.3262496
	speed: 0.0138s/iter; left time: 14.4128s
Updating learning rate to 1.2265678203125e-05
Epoch: 6 cost time: 5.9808220863342285
Epoch: 6, Steps: 514 | Train Loss: 0.4447773 Vali Loss: 0.3629521 Best vali loss: 0.3566576
	iters: 100, epoch: 7 | loss: 0.4615078
	speed: 0.0330s/iter; left time: 30.6962s
	iters: 200, epoch: 7 | loss: 0.6066156
	speed: 0.0100s/iter; left time: 8.2492s
	iters: 300, epoch: 7 | loss: 0.6282654
	speed: 0.0086s/iter; left time: 6.2424s
	iters: 400, epoch: 7 | loss: 0.3960628
	speed: 0.0102s/iter; left time: 6.3927s
	iters: 500, epoch: 7 | loss: 0.8119672
	speed: 0.0091s/iter; left time: 4.8327s
Updating learning rate to 6.1328391015625e-06
Epoch: 7 cost time: 5.117163419723511
Epoch: 7, Steps: 514 | Train Loss: 0.5808837 Vali Loss: 0.3681267 Best vali loss: 0.3566576
	iters: 100, epoch: 8 | loss: 0.5592206
	speed: 0.0190s/iter; left time: 7.9014s
	iters: 200, epoch: 8 | loss: 0.6324747
	speed: 0.0084s/iter; left time: 2.6320s
	iters: 300, epoch: 8 | loss: 0.7763308
	speed: 0.0108s/iter; left time: 2.3247s
	iters: 400, epoch: 8 | loss: 0.3018960
	speed: 0.0133s/iter; left time: 1.5308s
	iters: 500, epoch: 8 | loss: 0.5597888
	speed: 0.0129s/iter; left time: 0.1932s
Updating learning rate to 3.06641955078125e-06
Epoch: 8 cost time: 5.713223695755005
Epoch: 8, Steps: 514 | Train Loss: 0.5659422 Vali Loss: 0.3658268 Best vali loss: 0.3566576

best validation loss 0.35665761110590577

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0081135440107, 'e_layers': 3, 'learning_rate': 0.0005801859378, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4781775
	speed: 0.0218s/iter; left time: 42.7076s
	iters: 200, epoch: 1 | loss: 0.7401003
	speed: 0.0154s/iter; left time: 28.5865s
Updating learning rate to 0.0005581039253921432
Validation loss decreased (inf --> 0.4002).  Saving model state dict ...
Epoch: 1 cost time: 4.433715343475342
Epoch: 1, Steps: 257 | Train Loss: 0.6091389 Vali Loss: 0.4002410 Best vali loss: 0.4002410
	iters: 100, epoch: 2 | loss: 0.4829575
	speed: 0.0373s/iter; left time: 63.4790s
	iters: 200, epoch: 2 | loss: 0.6851020
	speed: 0.0115s/iter; left time: 18.4714s
Updating learning rate to 0.0004952196743837282
Validation loss decreased (0.4002 --> 0.3991).  Saving model state dict ...
Epoch: 2 cost time: 2.971116304397583
Epoch: 2, Steps: 257 | Train Loss: 0.5840298 Vali Loss: 0.3990602 Best vali loss: 0.3990602
	iters: 100, epoch: 3 | loss: 0.4121761
	speed: 0.0245s/iter; left time: 35.3088s
	iters: 200, epoch: 3 | loss: 0.5248773
	speed: 0.0118s/iter; left time: 15.8194s
Updating learning rate to 0.00040110674194363124
Validation loss decreased (0.3991 --> 0.3930).  Saving model state dict ...
Epoch: 3 cost time: 3.104980945587158
Epoch: 3, Steps: 257 | Train Loss: 0.4685267 Vali Loss: 0.3929766 Best vali loss: 0.3929766
	iters: 100, epoch: 4 | loss: 0.7242295
	speed: 0.0252s/iter; left time: 29.8894s
	iters: 200, epoch: 4 | loss: 0.3380173
	speed: 0.0118s/iter; left time: 12.7645s
Updating learning rate to 0.0002900929689
Validation loss decreased (0.3930 --> 0.3811).  Saving model state dict ...
Epoch: 4 cost time: 3.060636520385742
Epoch: 4, Steps: 257 | Train Loss: 0.5311234 Vali Loss: 0.3810588 Best vali loss: 0.3810588
	iters: 100, epoch: 5 | loss: 0.3797580
	speed: 0.0246s/iter; left time: 22.8126s
	iters: 200, epoch: 5 | loss: 0.7363439
	speed: 0.0119s/iter; left time: 9.8610s
Updating learning rate to 0.00017907919585636876
Validation loss decreased (0.3811 --> 0.3785).  Saving model state dict ...
Epoch: 5 cost time: 3.078158378601074
Epoch: 5, Steps: 257 | Train Loss: 0.5580509 Vali Loss: 0.3785338 Best vali loss: 0.3785338
	iters: 100, epoch: 6 | loss: 0.4039020
	speed: 0.0247s/iter; left time: 16.6209s
	iters: 200, epoch: 6 | loss: 0.3780961
	speed: 0.0116s/iter; left time: 6.6140s
Updating learning rate to 8.496626341627177e-05
Epoch: 6 cost time: 3.0513792037963867
Epoch: 6, Steps: 257 | Train Loss: 0.3909990 Vali Loss: 0.3819292 Best vali loss: 0.3785338
	iters: 100, epoch: 7 | loss: 0.5461666
	speed: 0.0242s/iter; left time: 10.0332s
	iters: 200, epoch: 7 | loss: 0.5360026
	speed: 0.0124s/iter; left time: 3.9197s
Updating learning rate to 2.2082012407856755e-05
Epoch: 7 cost time: 3.0743863582611084
Epoch: 7, Steps: 257 | Train Loss: 0.5410846 Vali Loss: 0.3857052 Best vali loss: 0.3785338
	iters: 100, epoch: 8 | loss: 0.4578237
	speed: 0.0320s/iter; left time: 5.0489s
	iters: 200, epoch: 8 | loss: 0.7463627
	speed: 0.0153s/iter; left time: 0.8863s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8852853775024414
Epoch: 8, Steps: 257 | Train Loss: 0.6020932 Vali Loss: 0.3865589 Best vali loss: 0.3785338

best validation loss 0.37853382749735487

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0099703810531, 'e_layers': 4, 'learning_rate': 0.0005870167071, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6016706
	speed: 0.0189s/iter; left time: 36.9496s
	iters: 200, epoch: 1 | loss: 0.6738355
	speed: 0.0113s/iter; left time: 20.9371s
Updating learning rate to 0.0005646747140159315
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 3.4307093620300293
Epoch: 1, Steps: 257 | Train Loss: 0.6377530 Vali Loss: 0.3634648 Best vali loss: 0.3634648
	iters: 100, epoch: 2 | loss: 0.6218997
	speed: 0.0240s/iter; left time: 40.7244s
	iters: 200, epoch: 2 | loss: 0.8246810
	speed: 0.0111s/iter; left time: 17.7899s
Updating learning rate to 0.0005010501006801036
Epoch: 2 cost time: 3.036620616912842
Epoch: 2, Steps: 257 | Train Loss: 0.7232903 Vali Loss: 0.3667461 Best vali loss: 0.3634648
	iters: 100, epoch: 3 | loss: 0.4087163
	speed: 0.0239s/iter; left time: 34.4511s
	iters: 200, epoch: 3 | loss: 0.9121629
	speed: 0.0101s/iter; left time: 13.4972s
Updating learning rate to 0.0004058291377143403
Validation loss decreased (0.3635 --> 0.3571).  Saving model state dict ...
Epoch: 3 cost time: 3.015385866165161
Epoch: 3, Steps: 257 | Train Loss: 0.6604396 Vali Loss: 0.3570506 Best vali loss: 0.3570506

best validation loss 0.35705062754027733

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019010008109, 'e_layers': 4, 'learning_rate': 0.0006987665261, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8506430
	speed: 0.0184s/iter; left time: 36.0479s
	iters: 200, epoch: 1 | loss: 0.7524140
	speed: 0.0137s/iter; left time: 25.5129s
Updating learning rate to 0.0006987665261
Validation loss decreased (inf --> 0.4132).  Saving model state dict ...
Epoch: 1 cost time: 3.6964056491851807
Epoch: 1, Steps: 257 | Train Loss: 0.8015285 Vali Loss: 0.4131684 Best vali loss: 0.4131684
	iters: 100, epoch: 2 | loss: 0.7778519
	speed: 0.0271s/iter; left time: 46.1412s
	iters: 200, epoch: 2 | loss: 0.3502576
	speed: 0.0134s/iter; left time: 21.5125s
Updating learning rate to 0.00034938326305
Validation loss decreased (0.4132 --> 0.3982).  Saving model state dict ...
Epoch: 2 cost time: 3.5295209884643555
Epoch: 2, Steps: 257 | Train Loss: 0.5640548 Vali Loss: 0.3981786 Best vali loss: 0.3981786
	iters: 100, epoch: 3 | loss: 0.4621201
	speed: 0.0281s/iter; left time: 40.5307s
	iters: 200, epoch: 3 | loss: 0.4236176
	speed: 0.0134s/iter; left time: 17.9930s
Updating learning rate to 0.000174691631525
Epoch: 3 cost time: 3.656097650527954
Epoch: 3, Steps: 257 | Train Loss: 0.4428688 Vali Loss: 0.4052786 Best vali loss: 0.3981786

best validation loss 0.39817860841985303

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.0029036262858, 'e_layers': 4, 'learning_rate': 0.002942121309, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4211555
	speed: 0.0159s/iter; left time: 63.8670s
	iters: 200, epoch: 1 | loss: 0.6804712
	speed: 0.0100s/iter; left time: 39.2314s
	iters: 300, epoch: 1 | loss: 0.6642851
	speed: 0.0099s/iter; left time: 37.7676s
	iters: 400, epoch: 1 | loss: 0.2283714
	speed: 0.0099s/iter; left time: 36.7202s
	iters: 500, epoch: 1 | loss: 0.4194582
	speed: 0.0095s/iter; left time: 34.2885s
Updating learning rate to 0.002942121309
Validation loss decreased (inf --> 0.3978).  Saving model state dict ...
Epoch: 1 cost time: 5.384246826171875
Epoch: 1, Steps: 514 | Train Loss: 0.6827483 Vali Loss: 0.3977921 Best vali loss: 0.3977921
	iters: 100, epoch: 2 | loss: 0.5746703
	speed: 0.0198s/iter; left time: 69.3749s
	iters: 200, epoch: 2 | loss: 0.3520850
	speed: 0.0101s/iter; left time: 34.2182s
	iters: 300, epoch: 2 | loss: 0.5547177
	speed: 0.0107s/iter; left time: 35.4161s
	iters: 400, epoch: 2 | loss: 0.6927209
	speed: 0.0103s/iter; left time: 32.8990s
	iters: 500, epoch: 2 | loss: 0.6712559
	speed: 0.0101s/iter; left time: 31.3060s
Updating learning rate to 0.0014710606545
Epoch: 2 cost time: 5.3160316944122314
Epoch: 2, Steps: 514 | Train Loss: 0.5690900 Vali Loss: 0.4047707 Best vali loss: 0.3977921
	iters: 100, epoch: 3 | loss: 0.5026307
	speed: 0.0196s/iter; left time: 58.5665s
	iters: 200, epoch: 3 | loss: 1.0784615
	speed: 0.0097s/iter; left time: 28.0791s
	iters: 300, epoch: 3 | loss: 1.0448601
	speed: 0.0093s/iter; left time: 25.9294s
	iters: 400, epoch: 3 | loss: 0.8886760
	speed: 0.0085s/iter; left time: 22.8361s
	iters: 500, epoch: 3 | loss: 0.5838158
	speed: 0.0092s/iter; left time: 23.7723s
Updating learning rate to 0.00073553032725
Epoch: 3 cost time: 4.8686370849609375
Epoch: 3, Steps: 514 | Train Loss: 0.8196888 Vali Loss: 0.4098583 Best vali loss: 0.3977921

best validation loss 0.3977921173708378

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0099703810531, 'e_layers': 4, 'learning_rate': 0.0005870167071, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4639582
	speed: 0.0295s/iter; left time: 34.9588s
	iters: 200, epoch: 4 | loss: 0.4844826
	speed: 0.0248s/iter; left time: 26.9493s
Updating learning rate to 0.00029350835355
Epoch: 4 cost time: 6.463339805603027
Epoch: 4, Steps: 257 | Train Loss: 0.4742204 Vali Loss: 0.3736700 Best vali loss: 0.3570506
	iters: 100, epoch: 5 | loss: 0.4206525
	speed: 0.0658s/iter; left time: 61.1261s
	iters: 200, epoch: 5 | loss: 0.7430784
	speed: 0.0253s/iter; left time: 21.0143s
Updating learning rate to 0.0001811875693856597
Validation loss decreased (0.3571 --> 0.3553).  Saving model state dict ...
Epoch: 5 cost time: 5.9306581020355225
Epoch: 5, Steps: 257 | Train Loss: 0.5818654 Vali Loss: 0.3553043 Best vali loss: 0.3553043
	iters: 100, epoch: 6 | loss: 0.3371421
	speed: 0.0539s/iter; left time: 36.2284s
	iters: 200, epoch: 6 | loss: 0.7083632
	speed: 0.0170s/iter; left time: 9.7212s
Updating learning rate to 8.596660641989634e-05
Epoch: 6 cost time: 3.925905704498291
Epoch: 6, Steps: 257 | Train Loss: 0.5227527 Vali Loss: 0.3749288 Best vali loss: 0.3553043
	iters: 100, epoch: 7 | loss: 0.5971008
	speed: 0.0206s/iter; left time: 8.5469s
	iters: 200, epoch: 7 | loss: 0.5605803
	speed: 0.0166s/iter; left time: 5.2272s
Updating learning rate to 2.234199308406853e-05
Epoch: 7 cost time: 3.8415098190307617
Epoch: 7, Steps: 257 | Train Loss: 0.5788405 Vali Loss: 0.3684844 Best vali loss: 0.3553043
	iters: 100, epoch: 8 | loss: 0.3233601
	speed: 0.0357s/iter; left time: 5.6448s
	iters: 200, epoch: 8 | loss: 0.5429370
	speed: 0.0118s/iter; left time: 0.6841s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.2834696769714355
Epoch: 8, Steps: 257 | Train Loss: 0.4331485 Vali Loss: 0.3765762 Best vali loss: 0.3553043

best validation loss 0.3553043335734744

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0013377786543, 'e_layers': 2, 'learning_rate': 0.0002030902852, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9926708
	speed: 0.0170s/iter; left time: 137.9267s
	iters: 200, epoch: 1 | loss: 1.0545769
	speed: 0.0096s/iter; left time: 77.2475s
	iters: 300, epoch: 1 | loss: 0.4639869
	speed: 0.0087s/iter; left time: 68.5796s
	iters: 400, epoch: 1 | loss: 2.1323922
	speed: 0.0064s/iter; left time: 50.1249s
	iters: 500, epoch: 1 | loss: 0.7457891
	speed: 0.0079s/iter; left time: 60.6172s
	iters: 600, epoch: 1 | loss: 1.2812129
	speed: 0.0087s/iter; left time: 65.9465s
	iters: 700, epoch: 1 | loss: 0.8303988
	speed: 0.0096s/iter; left time: 72.4990s
	iters: 800, epoch: 1 | loss: 0.1988936
	speed: 0.0089s/iter; left time: 66.1026s
	iters: 900, epoch: 1 | loss: 0.4646238
	speed: 0.0078s/iter; left time: 57.3180s
	iters: 1000, epoch: 1 | loss: 0.4394999
	speed: 0.0090s/iter; left time: 64.7115s
Updating learning rate to 0.00019536062147407993
Validation loss decreased (inf --> 0.3651).  Saving model state dict ...
Epoch: 1 cost time: 9.3004789352417
Epoch: 1, Steps: 1027 | Train Loss: 0.8604045 Vali Loss: 0.3650850 Best vali loss: 0.3650850
	iters: 100, epoch: 2 | loss: 0.5189061
	speed: 0.0278s/iter; left time: 197.3512s
	iters: 200, epoch: 2 | loss: 0.2332617
	speed: 0.0093s/iter; left time: 64.6720s
	iters: 300, epoch: 2 | loss: 0.9374891
	speed: 0.0088s/iter; left time: 60.3069s
	iters: 400, epoch: 2 | loss: 0.4289100
	speed: 0.0092s/iter; left time: 62.3160s
	iters: 500, epoch: 2 | loss: 0.1542089
	speed: 0.0091s/iter; left time: 60.7437s
	iters: 600, epoch: 2 | loss: 0.4634258
	speed: 0.0085s/iter; left time: 55.7660s
	iters: 700, epoch: 2 | loss: 0.2178826
	speed: 0.0069s/iter; left time: 44.5559s
	iters: 800, epoch: 2 | loss: 0.2754228
	speed: 0.0073s/iter; left time: 46.7830s
	iters: 900, epoch: 2 | loss: 0.4527391
	speed: 0.0101s/iter; left time: 63.4793s
	iters: 1000, epoch: 2 | loss: 0.3630472
	speed: 0.0113s/iter; left time: 69.9154s
Updating learning rate to 0.00017334840152901496
Epoch: 2 cost time: 9.311867475509644
Epoch: 2, Steps: 1027 | Train Loss: 0.4045293 Vali Loss: 0.3703520 Best vali loss: 0.3650850
	iters: 100, epoch: 3 | loss: 0.5659679
	speed: 0.0372s/iter; left time: 225.7495s
	iters: 200, epoch: 3 | loss: 0.6087204
	speed: 0.0092s/iter; left time: 55.0589s
	iters: 300, epoch: 3 | loss: 0.6215007
	speed: 0.0106s/iter; left time: 62.3944s
	iters: 400, epoch: 3 | loss: 0.3786439
	speed: 0.0069s/iter; left time: 39.5673s
	iters: 500, epoch: 3 | loss: 0.6965771
	speed: 0.0064s/iter; left time: 36.0286s
	iters: 600, epoch: 3 | loss: 0.4201261
	speed: 0.0067s/iter; left time: 37.2706s
	iters: 700, epoch: 3 | loss: 0.2943426
	speed: 0.0076s/iter; left time: 41.4055s
	iters: 800, epoch: 3 | loss: 0.5294255
	speed: 0.0074s/iter; left time: 39.5808s
	iters: 900, epoch: 3 | loss: 0.2950810
	speed: 0.0072s/iter; left time: 38.0190s
	iters: 1000, epoch: 3 | loss: 0.8978517
	speed: 0.0077s/iter; left time: 39.7451s
Updating learning rate to 0.0001404047863101705
Epoch: 3 cost time: 8.25181269645691
Epoch: 3, Steps: 1027 | Train Loss: 0.5308237 Vali Loss: 0.3712224 Best vali loss: 0.3650850
	iters: 100, epoch: 4 | loss: 0.6580177
	speed: 0.0255s/iter; left time: 128.3846s
	iters: 200, epoch: 4 | loss: 0.5457388
	speed: 0.0064s/iter; left time: 31.5292s
	iters: 300, epoch: 4 | loss: 0.6419089
	speed: 0.0062s/iter; left time: 29.9394s
	iters: 400, epoch: 4 | loss: 0.3693703
	speed: 0.0064s/iter; left time: 30.4160s
	iters: 500, epoch: 4 | loss: 0.3813903
	speed: 0.0075s/iter; left time: 34.9845s
	iters: 600, epoch: 4 | loss: 0.4656241
	speed: 0.0082s/iter; left time: 36.9836s
	iters: 700, epoch: 4 | loss: 1.0137299
	speed: 0.0077s/iter; left time: 34.1906s
	iters: 800, epoch: 4 | loss: 0.8081340
	speed: 0.0071s/iter; left time: 30.8328s
	iters: 900, epoch: 4 | loss: 0.2107239
	speed: 0.0063s/iter; left time: 26.5117s
	iters: 1000, epoch: 4 | loss: 0.1814856
	speed: 0.0071s/iter; left time: 29.2774s
Updating learning rate to 0.0001015451426
Validation loss decreased (0.3651 --> 0.3610).  Saving model state dict ...
Epoch: 4 cost time: 7.238542795181274
Epoch: 4, Steps: 1027 | Train Loss: 0.5276123 Vali Loss: 0.3609720 Best vali loss: 0.3609720
	iters: 100, epoch: 5 | loss: 1.1165446
	speed: 0.0237s/iter; left time: 95.1485s
	iters: 200, epoch: 5 | loss: 0.3255472
	speed: 0.0076s/iter; left time: 29.8205s
	iters: 300, epoch: 5 | loss: 1.3546714
	speed: 0.0076s/iter; left time: 29.0245s
	iters: 400, epoch: 5 | loss: 0.2691272
	speed: 0.0078s/iter; left time: 28.7867s
	iters: 500, epoch: 5 | loss: 0.3669972
	speed: 0.0073s/iter; left time: 26.4568s
	iters: 600, epoch: 5 | loss: 0.3072944
	speed: 0.0071s/iter; left time: 24.9847s
	iters: 700, epoch: 5 | loss: 0.2142430
	speed: 0.0073s/iter; left time: 24.9169s
	iters: 800, epoch: 5 | loss: 0.3715190
	speed: 0.0077s/iter; left time: 25.4140s
	iters: 900, epoch: 5 | loss: 0.3585946
	speed: 0.0076s/iter; left time: 24.3619s
	iters: 1000, epoch: 5 | loss: 0.2243606
	speed: 0.0078s/iter; left time: 24.1078s
Updating learning rate to 6.26854988898295e-05
Epoch: 5 cost time: 7.721312522888184
Epoch: 5, Steps: 1027 | Train Loss: 0.4908899 Vali Loss: 0.3637474 Best vali loss: 0.3609720
	iters: 100, epoch: 6 | loss: 0.2032609
	speed: 0.0239s/iter; left time: 71.3043s
	iters: 200, epoch: 6 | loss: 0.3482106
	speed: 0.0071s/iter; left time: 20.5796s
	iters: 300, epoch: 6 | loss: 0.2131370
	speed: 0.0071s/iter; left time: 19.7402s
	iters: 400, epoch: 6 | loss: 0.3620006
	speed: 0.0068s/iter; left time: 18.1230s
	iters: 500, epoch: 6 | loss: 0.4424411
	speed: 0.0070s/iter; left time: 18.0342s
	iters: 600, epoch: 6 | loss: 0.2521427
	speed: 0.0063s/iter; left time: 15.7128s
	iters: 700, epoch: 6 | loss: 0.3354122
	speed: 0.0062s/iter; left time: 14.7423s
	iters: 800, epoch: 6 | loss: 0.1853076
	speed: 0.0065s/iter; left time: 14.7968s
	iters: 900, epoch: 6 | loss: 0.1893603
	speed: 0.0059s/iter; left time: 12.9488s
	iters: 1000, epoch: 6 | loss: 0.5724769
	speed: 0.0067s/iter; left time: 13.8556s
Updating learning rate to 2.974188367098504e-05
Epoch: 6 cost time: 6.942638874053955
Epoch: 6, Steps: 1027 | Train Loss: 0.3103750 Vali Loss: 0.3837269 Best vali loss: 0.3609720
	iters: 100, epoch: 7 | loss: 0.4706360
	speed: 0.0218s/iter; left time: 42.6169s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0037046253889, 'e_layers': 1, 'learning_rate': 0.0002729698754, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5457399
	speed: 0.0122s/iter; left time: 99.4046s
	iters: 200, epoch: 1 | loss: 1.0115241
	speed: 0.0059s/iter; left time: 47.0329s
	iters: 300, epoch: 1 | loss: 0.3234929
	speed: 0.0044s/iter; left time: 34.9480s
	iters: 400, epoch: 1 | loss: 0.9870856
	speed: 0.0041s/iter; left time: 32.2480s
	iters: 500, epoch: 1 | loss: 0.3088873
	speed: 0.0050s/iter; left time: 38.4888s
	iters: 600, epoch: 1 | loss: 1.4200995
	speed: 0.0048s/iter; left time: 36.4744s
	iters: 700, epoch: 1 | loss: 1.1052899
	speed: 0.0041s/iter; left time: 31.0677s
	iters: 800, epoch: 1 | loss: 0.8948168
	speed: 0.0037s/iter; left time: 27.0811s
	iters: 900, epoch: 1 | loss: 0.5930749
	speed: 0.0080s/iter; left time: 58.3438s
	iters: 1000, epoch: 1 | loss: 0.3483661
	speed: 0.0082s/iter; left time: 59.4721s
Updating learning rate to 0.0002625805781371081
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 5.982407331466675
Epoch: 1, Steps: 1027 | Train Loss: 0.7538377 Vali Loss: 0.3657785 Best vali loss: 0.3657785
	iters: 100, epoch: 2 | loss: 0.9155552
	speed: 0.0290s/iter; left time: 205.4732s
	iters: 200, epoch: 2 | loss: 0.6260729
	speed: 0.0083s/iter; left time: 57.7001s
	iters: 300, epoch: 2 | loss: 0.5595133
	speed: 0.0080s/iter; left time: 55.1691s
	iters: 400, epoch: 2 | loss: 1.0525295
	speed: 0.0090s/iter; left time: 61.2919s
	iters: 500, epoch: 2 | loss: 0.9695466
	speed: 0.0087s/iter; left time: 58.3657s
	iters: 600, epoch: 2 | loss: 0.8739914
	speed: 0.0077s/iter; left time: 50.6775s
	iters: 700, epoch: 2 | loss: 0.5679158
	speed: 0.0090s/iter; left time: 58.3981s
	iters: 800, epoch: 2 | loss: 0.4292602
	speed: 0.0090s/iter; left time: 57.3040s
	iters: 900, epoch: 2 | loss: 1.1949893
	speed: 0.0081s/iter; left time: 51.1017s
	iters: 1000, epoch: 2 | loss: 0.4439334
	speed: 0.0086s/iter; left time: 53.3774s
Updating learning rate to 0.00023299436267749346
Epoch: 2 cost time: 8.860153198242188
Epoch: 2, Steps: 1027 | Train Loss: 0.7633308 Vali Loss: 0.3700629 Best vali loss: 0.3657785
	iters: 100, epoch: 3 | loss: 1.0568593
	speed: 0.0264s/iter; left time: 160.0981s
	iters: 200, epoch: 3 | loss: 0.7077314
	speed: 0.0036s/iter; left time: 21.7511s
	iters: 300, epoch: 3 | loss: 0.3534515
	speed: 0.0041s/iter; left time: 23.8782s
	iters: 400, epoch: 3 | loss: 0.2683962
	speed: 0.0040s/iter; left time: 23.2316s
	iters: 500, epoch: 3 | loss: 0.2825296
	speed: 0.0043s/iter; left time: 24.3448s
	iters: 600, epoch: 3 | loss: 0.5355026
	speed: 0.0044s/iter; left time: 24.4999s
	iters: 700, epoch: 3 | loss: 0.5243746
	speed: 0.0049s/iter; left time: 26.9161s
	iters: 800, epoch: 3 | loss: 0.2849787
	speed: 0.0052s/iter; left time: 28.0258s
	iters: 900, epoch: 3 | loss: 0.2575595
	speed: 0.0049s/iter; left time: 26.0313s
	iters: 1000, epoch: 3 | loss: 0.3916710
	speed: 0.0058s/iter; left time: 29.7081s
Updating learning rate to 0.00018871546212517146
Epoch: 3 cost time: 4.720219373703003
Epoch: 3, Steps: 1027 | Train Loss: 0.4663054 Vali Loss: 0.3778918 Best vali loss: 0.3657785
	iters: 100, epoch: 4 | loss: 0.8837843
	speed: 0.0195s/iter; left time: 98.0431s
	iters: 200, epoch: 4 | loss: 0.7996488
	speed: 0.0047s/iter; left time: 23.3800s
	iters: 300, epoch: 4 | loss: 0.2141634
	speed: 0.0051s/iter; left time: 24.8212s
	iters: 400, epoch: 4 | loss: 0.4994890
	speed: 0.0042s/iter; left time: 19.9609s
	iters: 500, epoch: 4 | loss: 1.1267877
	speed: 0.0042s/iter; left time: 19.6394s
	iters: 600, epoch: 4 | loss: 0.6248260
	speed: 0.0042s/iter; left time: 18.8530s
	iters: 700, epoch: 4 | loss: 0.2581332
	speed: 0.0047s/iter; left time: 20.9204s
	iters: 800, epoch: 4 | loss: 0.8059266
	speed: 0.0040s/iter; left time: 17.2899s
	iters: 900, epoch: 4 | loss: 0.3005525
	speed: 0.0045s/iter; left time: 19.1889s
	iters: 1000, epoch: 4 | loss: 0.4903655
	speed: 0.0044s/iter; left time: 18.3971s
Updating learning rate to 0.0001364849377
Epoch: 4 cost time: 4.639156818389893
Epoch: 4, Steps: 1027 | Train Loss: 0.6003677 Vali Loss: 0.3831031 Best vali loss: 0.3657785
	iters: 100, epoch: 5 | loss: 0.5269056
	speed: 0.0200s/iter; left time: 80.2294s
	iters: 200, epoch: 5 | loss: 1.4076471
	speed: 0.0048s/iter; left time: 18.7631s
	iters: 300, epoch: 5 | loss: 0.8444295
	speed: 0.0049s/iter; left time: 18.7045s
	iters: 400, epoch: 5 | loss: 0.6506887
	speed: 0.0049s/iter; left time: 18.2022s
	iters: 500, epoch: 5 | loss: 0.8561895
	speed: 0.0046s/iter; left time: 16.4945s
	iters: 600, epoch: 5 | loss: 0.2384925
	speed: 0.0046s/iter; left time: 16.2116s
	iters: 700, epoch: 5 | loss: 0.7172870
	speed: 0.0045s/iter; left time: 15.4417s
	iters: 800, epoch: 5 | loss: 0.2645378
	speed: 0.0047s/iter; left time: 15.5818s
	iters: 900, epoch: 5 | loss: 0.6150306
	speed: 0.0047s/iter; left time: 15.1197s
	iters: 1000, epoch: 5 | loss: 0.8389294
	speed: 0.0043s/iter; left time: 13.4179s
Updating learning rate to 8.425441327482857e-05
Epoch: 5 cost time: 4.926159381866455
Epoch: 5, Steps: 1027 | Train Loss: 0.6960138 Vali Loss: 0.3852563 Best vali loss: 0.3657785
	iters: 100, epoch: 6 | loss: 0.3808935
	speed: 0.0190s/iter; left time: 56.5283s
	iters: 200, epoch: 6 | loss: 1.0169318
	speed: 0.0053s/iter; left time: 15.2602s
	iters: 300, epoch: 6 | loss: 0.3826454
	speed: 0.0052s/iter; left time: 14.3825s
	iters: 400, epoch: 6 | loss: 0.2792169
	speed: 0.0052s/iter; left time: 13.9710s
	iters: 500, epoch: 6 | loss: 0.3319603
	speed: 0.0049s/iter; left time: 12.5507s
	iters: 600, epoch: 6 | loss: 0.4420681
	speed: 0.0049s/iter; left time: 12.1493s
	iters: 700, epoch: 6 | loss: 0.5502400
	speed: 0.0051s/iter; left time: 12.1742s
	iters: 800, epoch: 6 | loss: 0.2666362
	speed: 0.0051s/iter; left time: 11.6845s
	iters: 900, epoch: 6 | loss: 0.3689427
	speed: 0.0055s/iter; left time: 11.9894s
	iters: 1000, epoch: 6 | loss: 0.4805647
	speed: 0.0054s/iter; left time: 11.2133s
Updating learning rate to 3.997551272250654e-05
Epoch: 6 cost time: 5.364917993545532
Epoch: 6, Steps: 1027 | Train Loss: 0.4500100 Vali Loss: 0.3948983 Best vali loss: 0.3657785
	iters: 100, epoch: 7 | loss: 0.2769748
	speed: 0.0190s/iter; left time: 37.1729s
	iters: 200, epoch: 7 | loss: 0.9234759
	speed: 0.0043s/iter; left time: 8.0366s
	iters: 300, epoch: 7 | loss: 0.4273837
	speed: 0.0042s/iter; left time: 7.3868s
	iters: 400, epoch: 7 | loss: 0.4269680
	speed: 0.0050s/iter; left time: 8.3088s
	iters: 500, epoch: 7 | loss: 0.3542083
	speed: 0.0054s/iter; left time: 8.4250s
	iters: 600, epoch: 7 | loss: 0.7101494
	speed: 0.0054s/iter; left time: 7.8275s
	iters: 700, epoch: 7 | loss: 1.2489570
	speed: 0.0052s/iter; left time: 7.0658s
	iters: 800, epoch: 7 | loss: 0.4072871
	speed: 0.0049s/iter; left time: 6.2009s
	iters: 900, epoch: 7 | loss: 0.7290630
	speed: 0.0047s/iter; left time: 5.3939s
	iters: 1000, epoch: 7 | loss: 0.4254704
	speed: 0.0045s/iter; left time: 4.7845s
Updating learning rate to 1.0389297262891906e-05
Epoch: 7 cost time: 4.983872652053833
Epoch: 7, Steps: 1027 | Train Loss: 0.5929938 Vali Loss: 0.3926188 Best vali loss: 0.3657785
	iters: 100, epoch: 8 | loss: 0.6786838
	speed: 0.0210s/iter; left time: 19.4557s
	iters: 200, epoch: 8 | loss: 0.7121745
	speed: 0.0053s/iter; left time: 4.4045s
	iters: 300, epoch: 8 | loss: 0.6363792
	speed: 0.0052s/iter; left time: 3.7825s
	iters: 400, epoch: 8 | loss: 0.4632659
	speed: 0.0046s/iter; left time: 2.8860s
	iters: 500, epoch: 8 | loss: 1.0370636
	speed: 0.0043s/iter; left time: 2.2937s
	iters: 600, epoch: 8 | loss: 0.6458390
	speed: 0.0042s/iter; left time: 1.8123s
	iters: 700, epoch: 8 | loss: 0.5160251
	speed: 0.0040s/iter; left time: 1.3003s
	iters: 800, epoch: 8 | loss: 0.2440390
	speed: 0.0049s/iter; left time: 1.1061s
	iters: 900, epoch: 8 | loss: 0.7270035
	speed: 0.0049s/iter; left time: 0.6333s
	iters: 1000, epoch: 8 | loss: 0.9745504
	speed: 0.0048s/iter; left time: 0.1340s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.951797008514404
Epoch: 8, Steps: 1027 | Train Loss: 0.6635024 Vali Loss: 0.3867337 Best vali loss: 0.3657785

best validation loss 0.36577849451357347

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0032174734801, 'e_layers': 4, 'learning_rate': 0.0003812607109, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3573157
	speed: 0.0171s/iter; left time: 33.4243s
	iters: 200, epoch: 1 | loss: 0.7377023
	speed: 0.0124s/iter; left time: 23.1006s
Updating learning rate to 0.00036674983912560644
Validation loss decreased (inf --> 0.3795).  Saving model state dict ...
Epoch: 1 cost time: 3.2377352714538574
Epoch: 1, Steps: 257 | Train Loss: 0.5475090 Vali Loss: 0.3795039 Best vali loss: 0.3795039
	iters: 100, epoch: 2 | loss: 0.9006625
	speed: 0.0216s/iter; left time: 36.8030s
	iters: 200, epoch: 2 | loss: 0.8021615
	speed: 0.0104s/iter; left time: 16.6405s
Updating learning rate to 0.0003254263724886969
Validation loss decreased (0.3795 --> 0.3783).  Saving model state dict ...
Epoch: 2 cost time: 2.6592283248901367
Epoch: 2, Steps: 257 | Train Loss: 0.8514120 Vali Loss: 0.3783269 Best vali loss: 0.3783269
	iters: 100, epoch: 3 | loss: 0.5310035
	speed: 0.0221s/iter; left time: 31.8428s
	iters: 200, epoch: 3 | loss: 0.5689939
	speed: 0.0103s/iter; left time: 13.8598s
Updating learning rate to 0.0002635814341865831
Validation loss decreased (0.3783 --> 0.3579).  Saving model state dict ...
Epoch: 3 cost time: 2.8691837787628174
Epoch: 3, Steps: 257 | Train Loss: 0.5499987 Vali Loss: 0.3579101 Best vali loss: 0.3579101

best validation loss 0.3579100969029784

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0009424504792, 'e_layers': 4, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5301231
	speed: 0.0156s/iter; left time: 126.5183s
	iters: 200, epoch: 1 | loss: 0.1593315
	speed: 0.0085s/iter; left time: 68.4332s
	iters: 300, epoch: 1 | loss: 0.8543257
	speed: 0.0092s/iter; left time: 73.0477s
	iters: 400, epoch: 1 | loss: 0.9567985
	speed: 0.0087s/iter; left time: 68.2396s
	iters: 500, epoch: 1 | loss: 0.9240659
	speed: 0.0093s/iter; left time: 72.0908s
	iters: 600, epoch: 1 | loss: 0.8145761
	speed: 0.0091s/iter; left time: 69.0426s
	iters: 700, epoch: 1 | loss: 1.1292974
	speed: 0.0092s/iter; left time: 69.5037s
	iters: 800, epoch: 1 | loss: 0.2439710
	speed: 0.0093s/iter; left time: 68.6305s
	iters: 900, epoch: 1 | loss: 0.5894221
	speed: 0.0080s/iter; left time: 58.2705s
	iters: 1000, epoch: 1 | loss: 0.5734804
	speed: 0.0078s/iter; left time: 55.9887s
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.3832).  Saving model state dict ...
Epoch: 1 cost time: 9.396054983139038
Epoch: 1, Steps: 1027 | Train Loss: 0.6775392 Vali Loss: 0.3832011 Best vali loss: 0.3832011
	iters: 100, epoch: 2 | loss: 0.3370341
	speed: 0.0235s/iter; left time: 166.3400s
	iters: 200, epoch: 2 | loss: 0.6185154
	speed: 0.0083s/iter; left time: 58.0121s
	iters: 300, epoch: 2 | loss: 0.5397125
	speed: 0.0084s/iter; left time: 57.7794s
	iters: 400, epoch: 2 | loss: 0.4586732
	speed: 0.0073s/iter; left time: 49.7819s
	iters: 500, epoch: 2 | loss: 0.4115243
	speed: 0.0073s/iter; left time: 48.7581s
	iters: 600, epoch: 2 | loss: 0.3104861
	speed: 0.0095s/iter; left time: 62.5951s
	iters: 700, epoch: 2 | loss: 0.2955886
	speed: 0.0086s/iter; left time: 55.7259s
	iters: 800, epoch: 2 | loss: 0.5655743
	speed: 0.0088s/iter; left time: 56.2300s
	iters: 900, epoch: 2 | loss: 0.4676978
	speed: 0.0082s/iter; left time: 51.8376s
	iters: 1000, epoch: 2 | loss: 0.5438718
	speed: 0.0086s/iter; left time: 53.1735s
Updating learning rate to 0.0002257411363
Validation loss decreased (0.3832 --> 0.3774).  Saving model state dict ...
Epoch: 2 cost time: 8.619680881500244
Epoch: 2, Steps: 1027 | Train Loss: 0.4548678 Vali Loss: 0.3773531 Best vali loss: 0.3773531
	iters: 100, epoch: 3 | loss: 0.2365774
	speed: 0.0201s/iter; left time: 121.7504s
	iters: 200, epoch: 3 | loss: 0.6331708
	speed: 0.0076s/iter; left time: 45.1923s
	iters: 300, epoch: 3 | loss: 0.6066763
	speed: 0.0080s/iter; left time: 47.1361s
	iters: 400, epoch: 3 | loss: 0.2373284
	speed: 0.0066s/iter; left time: 38.0914s
	iters: 500, epoch: 3 | loss: 0.6619824
	speed: 0.0073s/iter; left time: 41.5866s
	iters: 600, epoch: 3 | loss: 0.5102899
	speed: 0.0067s/iter; left time: 37.5284s
	iters: 700, epoch: 3 | loss: 0.9669598
	speed: 0.0075s/iter; left time: 40.7160s
	iters: 800, epoch: 3 | loss: 0.8643361
	speed: 0.0078s/iter; left time: 42.0072s
	iters: 900, epoch: 3 | loss: 0.3148648
	speed: 0.0064s/iter; left time: 33.8690s
	iters: 1000, epoch: 3 | loss: 0.4142820
	speed: 0.0049s/iter; left time: 25.2385s
Updating learning rate to 0.00011287056815
Epoch: 3 cost time: 7.143329381942749
Epoch: 3, Steps: 1027 | Train Loss: 0.5446468 Vali Loss: 0.3790533 Best vali loss: 0.3773531

best validation loss 0.3773530673418626

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.00216155938, 'e_layers': 4, 'learning_rate': 0.001084813014, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1014318
	speed: 0.0215s/iter; left time: 42.1447s
	iters: 200, epoch: 1 | loss: 0.7412431
	speed: 0.0148s/iter; left time: 27.4216s
Updating learning rate to 0.001084813014
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 4.135770559310913
Epoch: 1, Steps: 257 | Train Loss: 0.9213375 Vali Loss: 0.3696201 Best vali loss: 0.3696201
	iters: 100, epoch: 2 | loss: 1.4028717
	speed: 0.0348s/iter; left time: 59.0895s
	iters: 200, epoch: 2 | loss: 0.8430647
	speed: 0.0148s/iter; left time: 23.6941s
Updating learning rate to 0.000542406507
Epoch: 2 cost time: 3.955944776535034
Epoch: 2, Steps: 257 | Train Loss: 1.1229682 Vali Loss: 0.3835074 Best vali loss: 0.3696201
	iters: 100, epoch: 3 | loss: 0.5800051
	speed: 0.0224s/iter; left time: 32.3914s
	iters: 200, epoch: 3 | loss: 0.5274951
	speed: 0.0091s/iter; left time: 12.1749s
Updating learning rate to 0.0002712032535
Epoch: 3 cost time: 2.407137155532837
Epoch: 3, Steps: 257 | Train Loss: 0.5537501 Vali Loss: 0.3713628 Best vali loss: 0.3696201

best validation loss 0.369620144285247

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0032174734801, 'e_layers': 4, 'learning_rate': 0.0003812607109, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2929839
	speed: 0.0208s/iter; left time: 24.6739s
	iters: 200, epoch: 4 | loss: 0.5386211
	speed: 0.0134s/iter; left time: 14.5310s
Updating learning rate to 0.00019063035545
Validation loss decreased (0.3579 --> 0.3552).  Saving model state dict ...
Epoch: 4 cost time: 3.885284423828125
Epoch: 4, Steps: 257 | Train Loss: 0.4158025 Vali Loss: 0.3552183 Best vali loss: 0.3552183
	iters: 100, epoch: 5 | loss: 0.7520132
	speed: 0.0232s/iter; left time: 21.5545s
	iters: 200, epoch: 5 | loss: 0.7040576
	speed: 0.0131s/iter; left time: 10.8357s
Updating learning rate to 0.00011767927671341692
Validation loss decreased (0.3552 --> 0.3543).  Saving model state dict ...
Epoch: 5 cost time: 3.038357973098755
Epoch: 5, Steps: 257 | Train Loss: 0.7280354 Vali Loss: 0.3543021 Best vali loss: 0.3543021
	iters: 100, epoch: 6 | loss: 0.4633727
	speed: 0.0396s/iter; left time: 26.6141s
	iters: 200, epoch: 6 | loss: 0.4947504
	speed: 0.0135s/iter; left time: 7.7502s
Updating learning rate to 5.5834338411303084e-05
Epoch: 6 cost time: 3.9697697162628174
Epoch: 6, Steps: 257 | Train Loss: 0.4790616 Vali Loss: 0.3548913 Best vali loss: 0.3543021
	iters: 100, epoch: 7 | loss: 0.4120793
	speed: 0.0299s/iter; left time: 12.3980s
	iters: 200, epoch: 7 | loss: 0.4795284
	speed: 0.0131s/iter; left time: 4.1284s
Updating learning rate to 1.4510871774393578e-05
Epoch: 7 cost time: 3.358198881149292
Epoch: 7, Steps: 257 | Train Loss: 0.4458039 Vali Loss: 0.3585441 Best vali loss: 0.3543021
	iters: 100, epoch: 8 | loss: 0.5087509
	speed: 0.0312s/iter; left time: 4.9328s
	iters: 200, epoch: 8 | loss: 0.5908844
	speed: 0.0136s/iter; left time: 0.7894s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.7311971187591553
Epoch: 8, Steps: 257 | Train Loss: 0.5498177 Vali Loss: 0.3565271 Best vali loss: 0.3543021

best validation loss 0.3543021457368592

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0088784982474, 'e_layers': 3, 'learning_rate': 0.0002391486573, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002391486573
Validation loss decreased (inf --> 0.3934).  Saving model state dict ...
Epoch: 1 cost time: 0.880359411239624
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3933629 Best vali loss: 0.3933629
Updating learning rate to 0.00011957432865
Validation loss decreased (0.3934 --> 0.3772).  Saving model state dict ...
Epoch: 2 cost time: 0.5683937072753906
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3771673 Best vali loss: 0.3771673
Updating learning rate to 5.9787164325e-05
Validation loss decreased (0.3772 --> 0.3716).  Saving model state dict ...
Epoch: 3 cost time: 0.5687160491943359
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3715891 Best vali loss: 0.3715891
Updating learning rate to 2.98935821625e-05
Validation loss decreased (0.3716 --> 0.3703).  Saving model state dict ...
Epoch: 4 cost time: 0.5605189800262451
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3703071 Best vali loss: 0.3703071
Updating learning rate to 1.494679108125e-05
Validation loss decreased (0.3703 --> 0.3696).  Saving model state dict ...
Epoch: 5 cost time: 0.5799665451049805
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3695554 Best vali loss: 0.3695554
Updating learning rate to 7.473395540625e-06
Validation loss decreased (0.3696 --> 0.3693).  Saving model state dict ...
Epoch: 6 cost time: 0.591644287109375
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3692742 Best vali loss: 0.3692742
Updating learning rate to 3.7366977703125e-06
Validation loss decreased (0.3693 --> 0.3692).  Saving model state dict ...
Epoch: 7 cost time: 0.5832090377807617
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3691642 Best vali loss: 0.3691642
Updating learning rate to 1.86834888515625e-06
Validation loss decreased (0.3692 --> 0.3691).  Saving model state dict ...
Epoch: 8 cost time: 0.5914812088012695
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3691250 Best vali loss: 0.3691250

best validation loss 0.369125002353271

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0043376323922, 'e_layers': 4, 'learning_rate': 0.0025598871637, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5943403
	speed: 0.0153s/iter; left time: 14.2299s
Updating learning rate to 0.0024624572598904
Validation loss decreased (inf --> 0.3842).  Saving model state dict ...
Epoch: 1 cost time: 1.4182865619659424
Epoch: 1, Steps: 129 | Train Loss: 0.5943403 Vali Loss: 0.3841736 Best vali loss: 0.3841736
	iters: 100, epoch: 2 | loss: 0.8659183
	speed: 0.0129s/iter; left time: 10.3895s
Updating learning rate to 0.002185000368112334
Epoch: 2 cost time: 1.1764099597930908
Epoch: 2, Steps: 129 | Train Loss: 0.8659183 Vali Loss: 0.4096921 Best vali loss: 0.3841736
	iters: 100, epoch: 3 | loss: 0.7042879
	speed: 0.0152s/iter; left time: 10.2271s
Updating learning rate to 0.0017697567849860253
Epoch: 3 cost time: 1.2389764785766602
Epoch: 3, Steps: 129 | Train Loss: 0.7042879 Vali Loss: 0.3990468 Best vali loss: 0.3841736
	iters: 100, epoch: 4 | loss: 0.7094504
	speed: 0.0154s/iter; left time: 8.3845s
Updating learning rate to 0.00127994358185
Epoch: 4 cost time: 1.3005261421203613
Epoch: 4, Steps: 129 | Train Loss: 0.7094504 Vali Loss: 0.4011314 Best vali loss: 0.3841736
	iters: 100, epoch: 5 | loss: 0.8083830
	speed: 0.0163s/iter; left time: 6.8094s
Updating learning rate to 0.0007901303787139749
Epoch: 5 cost time: 1.2264387607574463
Epoch: 5, Steps: 129 | Train Loss: 0.8083830 Vali Loss: 0.4016198 Best vali loss: 0.3841736
	iters: 100, epoch: 6 | loss: 0.5710093
	speed: 0.0141s/iter; left time: 4.0673s
Updating learning rate to 0.0003748867955876662
Epoch: 6 cost time: 1.1488325595855713
Epoch: 6, Steps: 129 | Train Loss: 0.5710093 Vali Loss: 0.4038898 Best vali loss: 0.3841736
	iters: 100, epoch: 7 | loss: 0.5693879
	speed: 0.0152s/iter; left time: 2.4148s
Updating learning rate to 9.742990380960012e-05
Epoch: 7 cost time: 1.269016981124878
Epoch: 7, Steps: 129 | Train Loss: 0.5693879 Vali Loss: 0.4043272 Best vali loss: 0.3841736
	iters: 100, epoch: 8 | loss: 0.6097752
	speed: 0.0166s/iter; left time: 0.4973s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2516422271728516
Epoch: 8, Steps: 129 | Train Loss: 0.6097752 Vali Loss: 0.4037567 Best vali loss: 0.3841736

best validation loss 0.3841736245834523

[INFO][smbo.py:328] Configuration budget is exhausted:
[INFO][smbo.py:329] --- Remaining wallclock time: -6.704097032546997
[INFO][smbo.py:330] --- Remaining cpu time: inf
[INFO][smbo.py:331] --- Remaining trials: 876
{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.003098386677, 'e_layers': 1, 'learning_rate': 0.0005, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2887171
	speed: 0.0123s/iter; left time: 99.5971s
	iters: 200, epoch: 1 | loss: 0.3668302
	speed: 0.0041s/iter; left time: 32.6378s
	iters: 300, epoch: 1 | loss: 0.3722475
	speed: 0.0033s/iter; left time: 25.7887s
	iters: 400, epoch: 1 | loss: 0.4765303
	speed: 0.0028s/iter; left time: 22.1196s
	iters: 500, epoch: 1 | loss: 0.5380989
	speed: 0.0027s/iter; left time: 21.1369s
	iters: 600, epoch: 1 | loss: 1.8254241
	speed: 0.0022s/iter; left time: 16.4577s
	iters: 700, epoch: 1 | loss: 0.3124222
	speed: 0.0031s/iter; left time: 23.3860s
	iters: 800, epoch: 1 | loss: 0.3053548
	speed: 0.0035s/iter; left time: 25.7679s
	iters: 900, epoch: 1 | loss: 0.2902839
	speed: 0.0039s/iter; left time: 28.2798s
	iters: 1000, epoch: 1 | loss: 0.8669170
	speed: 0.0034s/iter; left time: 24.6133s
Updating learning rate to 0.0004809698831278217
Validation loss decreased (inf --> 0.3660).  Saving model state dict ...
Epoch: 1 cost time: 3.9299724102020264
Epoch: 1, Steps: 1027 | Train Loss: 0.5642826 Vali Loss: 0.3659566 Best vali loss: 0.3659566
	iters: 100, epoch: 2 | loss: 0.4003803
	speed: 0.0147s/iter; left time: 104.4582s
	iters: 200, epoch: 2 | loss: 0.2695107
	speed: 0.0038s/iter; left time: 26.6524s
	iters: 300, epoch: 2 | loss: 0.3544131
	speed: 0.0034s/iter; left time: 23.2471s
	iters: 400, epoch: 2 | loss: 0.9076534
	speed: 0.0029s/iter; left time: 19.9737s
	iters: 500, epoch: 2 | loss: 0.6799340
	speed: 0.0030s/iter; left time: 20.2255s
	iters: 600, epoch: 2 | loss: 0.2403506
	speed: 0.0030s/iter; left time: 19.6013s
	iters: 700, epoch: 2 | loss: 0.8917809
	speed: 0.0035s/iter; left time: 22.7195s
	iters: 800, epoch: 2 | loss: 0.2400889
	speed: 0.0036s/iter; left time: 22.8202s
	iters: 900, epoch: 2 | loss: 0.2591216
	speed: 0.0035s/iter; left time: 21.9690s
	iters: 1000, epoch: 2 | loss: 0.3724574
	speed: 0.0038s/iter; left time: 23.6774s
Updating learning rate to 0.00042677669529663686
Epoch: 2 cost time: 3.6101644039154053
Epoch: 2, Steps: 1027 | Train Loss: 0.4615691 Vali Loss: 0.3684681 Best vali loss: 0.3659566
	iters: 100, epoch: 3 | loss: 0.5010828
	speed: 0.0151s/iter; left time: 91.5951s
	iters: 200, epoch: 3 | loss: 0.9375905
	speed: 0.0040s/iter; left time: 23.9694s
	iters: 300, epoch: 3 | loss: 0.3383739
	speed: 0.0036s/iter; left time: 20.8656s
	iters: 400, epoch: 3 | loss: 0.4281971
	speed: 0.0039s/iter; left time: 22.5504s
	iters: 500, epoch: 3 | loss: 0.5888224
	speed: 0.0042s/iter; left time: 23.5305s
	iters: 600, epoch: 3 | loss: 0.6012668
	speed: 0.0039s/iter; left time: 21.5311s
	iters: 700, epoch: 3 | loss: 0.2427109
	speed: 0.0033s/iter; left time: 17.9097s
	iters: 800, epoch: 3 | loss: 0.4627784
	speed: 0.0035s/iter; left time: 18.9076s
	iters: 900, epoch: 3 | loss: 0.2997419
	speed: 0.0035s/iter; left time: 18.2710s
	iters: 1000, epoch: 3 | loss: 0.2049239
	speed: 0.0031s/iter; left time: 16.1857s
Updating learning rate to 0.0003456708580912725
Epoch: 3 cost time: 3.820814609527588
Epoch: 3, Steps: 1027 | Train Loss: 0.4605489 Vali Loss: 0.3754163 Best vali loss: 0.3659566
	iters: 100, epoch: 4 | loss: 0.7711829
	speed: 0.0121s/iter; left time: 61.0911s
	iters: 200, epoch: 4 | loss: 0.3769971
	speed: 0.0039s/iter; left time: 19.4123s
	iters: 300, epoch: 4 | loss: 0.3395211
	speed: 0.0038s/iter; left time: 18.3275s
	iters: 400, epoch: 4 | loss: 0.1939733
	speed: 0.0048s/iter; left time: 22.6153s
	iters: 500, epoch: 4 | loss: 0.6079667
	speed: 0.0039s/iter; left time: 18.0338s
	iters: 600, epoch: 4 | loss: 0.5953928
	speed: 0.0038s/iter; left time: 17.2685s
	iters: 700, epoch: 4 | loss: 1.0782107
	speed: 0.0047s/iter; left time: 20.8607s
	iters: 800, epoch: 4 | loss: 0.4735647
	speed: 0.0046s/iter; left time: 19.9879s
	iters: 900, epoch: 4 | loss: 1.0485998
	speed: 0.0038s/iter; left time: 15.9917s
	iters: 1000, epoch: 4 | loss: 0.7125406
	speed: 0.0038s/iter; left time: 15.6930s
Updating learning rate to 0.00025
Epoch: 4 cost time: 4.283950567245483
Epoch: 4, Steps: 1027 | Train Loss: 0.6197950 Vali Loss: 0.3673504 Best vali loss: 0.3659566
	iters: 100, epoch: 5 | loss: 0.4424810
	speed: 0.0121s/iter; left time: 48.4937s
	iters: 200, epoch: 5 | loss: 0.8268924
	speed: 0.0031s/iter; left time: 12.1896s
	iters: 300, epoch: 5 | loss: 0.3291218
	speed: 0.0054s/iter; left time: 20.4790s
	iters: 400, epoch: 5 | loss: 0.2042926
	speed: 0.0053s/iter; left time: 19.6752s
	iters: 500, epoch: 5 | loss: 1.6442838
	speed: 0.0045s/iter; left time: 16.3589s
	iters: 600, epoch: 5 | loss: 0.5364747
	speed: 0.0041s/iter; left time: 14.5248s
	iters: 700, epoch: 5 | loss: 0.2200306
	speed: 0.0054s/iter; left time: 18.4643s
	iters: 800, epoch: 5 | loss: 0.2694538
	speed: 0.0054s/iter; left time: 17.7442s
	iters: 900, epoch: 5 | loss: 0.4610839
	speed: 0.0036s/iter; left time: 11.5363s
	iters: 1000, epoch: 5 | loss: 0.4867272
	speed: 0.0047s/iter; left time: 14.4633s
Updating learning rate to 0.00015432914190872756
Epoch: 5 cost time: 4.566071271896362
Epoch: 5, Steps: 1027 | Train Loss: 0.5420842 Vali Loss: 0.3753361 Best vali loss: 0.3659566
	iters: 100, epoch: 6 | loss: 0.7982970
	speed: 0.0157s/iter; left time: 46.8198s
	iters: 200, epoch: 6 | loss: 0.6137468
	speed: 0.0030s/iter; left time: 8.6181s
	iters: 300, epoch: 6 | loss: 0.6052104
	speed: 0.0031s/iter; left time: 8.5175s
	iters: 400, epoch: 6 | loss: 1.2669059
	speed: 0.0044s/iter; left time: 11.6894s
	iters: 500, epoch: 6 | loss: 0.2412828
	speed: 0.0038s/iter; left time: 9.6836s
	iters: 600, epoch: 6 | loss: 0.3367415
	speed: 0.0048s/iter; left time: 11.8607s
	iters: 700, epoch: 6 | loss: 0.6105035
	speed: 0.0040s/iter; left time: 9.5868s
	iters: 800, epoch: 6 | loss: 0.4388474
	speed: 0.0045s/iter; left time: 10.2292s
	iters: 900, epoch: 6 | loss: 0.3498640
	speed: 0.0041s/iter; left time: 8.9896s
	iters: 1000, epoch: 6 | loss: 0.6203685
	speed: 0.0027s/iter; left time: 5.7143s
Updating learning rate to 7.322330470336314e-05
Epoch: 6 cost time: 3.8452463150024414
Epoch: 6, Steps: 1027 | Train Loss: 0.5881768 Vali Loss: 0.3718455 Best vali loss: 0.3659566
	iters: 100, epoch: 7 | loss: 0.7428134
	speed: 0.0105s/iter; left time: 20.5759s
	iters: 200, epoch: 7 | loss: 0.7308449
	speed: 0.0036s/iter; left time: 6.6761s
	iters: 300, epoch: 7 | loss: 0.8268752
	speed: 0.0035s/iter; left time: 6.2245s
	iters: 400, epoch: 7 | loss: 0.5006623
	speed: 0.0035s/iter; left time: 5.8349s
	iters: 500, epoch: 7 | loss: 0.5624242
	speed: 0.0035s/iter; left time: 5.5094s
	iters: 600, epoch: 7 | loss: 0.2497287
	speed: 0.0035s/iter; left time: 5.1108s
	iters: 700, epoch: 7 | loss: 0.5840889
	speed: 0.0035s/iter; left time: 4.7478s
	iters: 800, epoch: 7 | loss: 1.1861171
	speed: 0.0035s/iter; left time: 4.4488s
	iters: 900, epoch: 7 | loss: 1.1104513
	speed: 0.0037s/iter; left time: 4.2910s
	iters: 1000, epoch: 7 | loss: 0.4847402
	speed: 0.0035s/iter; left time: 3.7101s
Updating learning rate to 1.9030116872178316e-05
Epoch: 7 cost time: 3.703923463821411
Epoch: 7, Steps: 1027 | Train Loss: 0.6978746 Vali Loss: 0.3741688 Best vali loss: 0.3659566
	iters: 100, epoch: 8 | loss: 1.0000393
	speed: 0.0125s/iter; left time: 11.5581s
	iters: 200, epoch: 8 | loss: 0.4949030
	speed: 0.0036s/iter; left time: 2.9975s
	iters: 300, epoch: 8 | loss: 0.2021149
	speed: 0.0036s/iter; left time: 2.5939s
	iters: 400, epoch: 8 | loss: 0.3691242
	speed: 0.0037s/iter; left time: 2.3008s
	iters: 500, epoch: 8 | loss: 0.3115898
	speed: 0.0036s/iter; left time: 1.9016s
	iters: 600, epoch: 8 | loss: 0.2895049
	speed: 0.0036s/iter; left time: 1.5359s
	iters: 700, epoch: 8 | loss: 0.3767343
	speed: 0.0036s/iter; left time: 1.1768s
	iters: 800, epoch: 8 | loss: 0.2090365
	speed: 0.0036s/iter; left time: 0.8293s
	iters: 900, epoch: 8 | loss: 0.5614210
	speed: 0.0035s/iter; left time: 0.4422s
	iters: 1000, epoch: 8 | loss: 0.1720266
	speed: 0.0034s/iter; left time: 0.0949s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.7299351692199707
Epoch: 8, Steps: 1027 | Train Loss: 0.3986495 Vali Loss: 0.3742050 Best vali loss: 0.3659566

best validation loss 0.3659565966232352

Default cost: 0.3659565966232352
{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8
start_epoch 8
train_epoch 8

best validation loss 0.34199999968991535

Configuration(values={
  'alpha_d_ff': 2,
  'batch_size': 128,
  'd_core': 32,
  'd_model': 512,
  'dropout': 0.0092167719699,
  'e_layers': 4,
  'learning_rate': 0.0006724544284,
  'lradj': 'type1',
})
Incumbent cost: 0.34199999968991535
Traceback (most recent call last):
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 516, in <module>
    metrics_df = pd.read_csv(metrics_path)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
  File "parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file


Time taken (1 parallel trials): 8890 seconds


