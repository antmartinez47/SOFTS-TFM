horizon=336
maxconcurrent=1
gpu_fraction=$(echo "scale=2; 1/$maxconcurrent" | bc)  # Calculate GPU fraction with 2 decimal places
start_time=$(date +%s)  # Get the current time in seconds
python3 smac_softs.py \
    --model SOFTS \
    --data ETTh2 \
    --root_path ./dataset/ETT-small/ \
    --data_path ETTh2.csv \
    --features M \
    --seq_len 96 \
    --label_len 48 \
    --pred_len $horizon \
    --enc_in 7 \
    --dec_in 7 \
    --c_out 7 \
    --embed timeF \
    --activation gelu \
    --train_epochs 8 \
    --patience 0 \
    --loss MSE \
    --num_workers 1 \
    --gpu 0 \
    --smac_storage_path ./checkpoints/hptunning/smac/ \
    --smac_experiment_name ETTh2_96_${horizon} \
    --smac_n_trials 1500 \
    --smac_trial_walltime_limit 60 \
    --smac_time_budget_s 14400 \
    --smac_n_workers $maxconcurrent \
    --smac_default_config "{
        \"batch_size\": 32, \
        \"learning_rate\": 0.0003, \
        \"d_model\": 128, \
        \"alpha_d_ff\": 1, \
        \"d_core\": 64, \
        \"e_layers\": 2, \
        \"dropout\": 0.0031, \
        \"lradj\": \"cosine\"
    }" \
    --smac_param_space "{
        \"batch_size\": [\"choice\", [8, 16, 32, 64, 128]], \
        \"learning_rate\": [\"loguniform\", [0.00005, 0.005]], \
        \"d_model\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"alpha_d_ff\": [\"choice\", [1, 2, 3, 4]], \
        \"d_core\": [\"choice\", [32, 64, 128, 256, 512]], \
        \"e_layers\": [\"choice\", [1, 2, 3, 4]], \
        \"dropout\": [\"loguniform\", [0.0008, 0.012]], \
        \"lradj\": [\"choice\", [\"cosine\", \"type1\"]]
    }" \
    --smac_min_budget 1 \
    --smac_eta 3 \
    --smac_incumbent_selection "highest_budget" \
    --smac_n_init_configs 150 \
    --seed 123;
end_time=$(date +%s)  # Get the current time in seconds
elapsed_time=$((end_time - start_time))  # Calculate the elapsed time
echo ""
echo ""
echo "Time taken ($maxconcurrent parallel trials): $elapsed_time seconds"
echo ""
echo ""[INFO][abstract_initial_design.py:147] Using 150 initial design configurations and 1 additional configurations.
[INFO][successive_halving.py:164] Successive Halving uses budget type BUDGETS with eta 3, min budget 1, and max budget 8.
[INFO][successive_halving.py:323] Number of configs in stage:
[INFO][successive_halving.py:325] --- Bracket 0: [3, 1]
[INFO][successive_halving.py:325] --- Bracket 1: [2]
[INFO][successive_halving.py:327] Budgets in stage:
[INFO][successive_halving.py:329] --- Bracket 0: [2.6666666666666665, 8.0]
[INFO][successive_halving.py:329] --- Bracket 1: [8.0]
{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023508577801, 'e_layers': 1, 'learning_rate': 0.0004821026935, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7329904
	speed: 0.0080s/iter; left time: 15.5800s
	iters: 200, epoch: 1 | loss: 0.7682719
	speed: 0.0025s/iter; left time: 4.5561s
Updating learning rate to 0.00046375375229660605
Validation loss decreased (inf --> 0.3736).  Saving model state dict ...
Epoch: 1 cost time: 0.9259605407714844
Epoch: 1, Steps: 257 | Train Loss: 0.7506312 Vali Loss: 0.3736337 Best vali loss: 0.3736337
	iters: 100, epoch: 2 | loss: 0.3377167
	speed: 0.0064s/iter; left time: 10.9033s
	iters: 200, epoch: 2 | loss: 0.7159407
	speed: 0.0027s/iter; left time: 4.3769s
Updating learning rate to 0.00041150038865107484
Validation loss decreased (0.3736 --> 0.3680).  Saving model state dict ...
Epoch: 2 cost time: 0.7437841892242432
Epoch: 2, Steps: 257 | Train Loss: 0.5268287 Vali Loss: 0.3680045 Best vali loss: 0.3680045
	iters: 100, epoch: 3 | loss: 0.4112294
	speed: 0.0066s/iter; left time: 9.4968s
	iters: 200, epoch: 3 | loss: 0.6468997
	speed: 0.0026s/iter; left time: 3.4440s
Updating learning rate to 0.0003332977035005174
Validation loss decreased (0.3680 --> 0.3659).  Saving model state dict ...
Epoch: 3 cost time: 0.7180488109588623
Epoch: 3, Steps: 257 | Train Loss: 0.5290645 Vali Loss: 0.3659210 Best vali loss: 0.3659210

best validation loss 0.36592095474363073

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.00590255351, 'e_layers': 4, 'learning_rate': 0.0015120382784, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7297551
	speed: 0.0109s/iter; left time: 43.6452s
	iters: 200, epoch: 1 | loss: 0.5610297
	speed: 0.0049s/iter; left time: 19.2659s
	iters: 300, epoch: 1 | loss: 0.5825672
	speed: 0.0048s/iter; left time: 18.4539s
	iters: 400, epoch: 1 | loss: 0.7511373
	speed: 0.0048s/iter; left time: 17.6924s
	iters: 500, epoch: 1 | loss: 1.0213355
	speed: 0.0048s/iter; left time: 17.4972s
Updating learning rate to 0.0015120382784
Validation loss decreased (inf --> 0.3787).  Saving model state dict ...
Epoch: 1 cost time: 2.8342084884643555
Epoch: 1, Steps: 514 | Train Loss: 0.7291649 Vali Loss: 0.3787228 Best vali loss: 0.3787228
	iters: 100, epoch: 2 | loss: 0.7593931
	speed: 0.0102s/iter; left time: 35.5946s
	iters: 200, epoch: 2 | loss: 0.2756207
	speed: 0.0051s/iter; left time: 17.4292s
	iters: 300, epoch: 2 | loss: 0.6291634
	speed: 0.0047s/iter; left time: 15.4247s
	iters: 400, epoch: 2 | loss: 0.3453585
	speed: 0.0046s/iter; left time: 14.6211s
	iters: 500, epoch: 2 | loss: 0.8053963
	speed: 0.0047s/iter; left time: 14.5811s
Updating learning rate to 0.0007560191392
Validation loss decreased (0.3787 --> 0.3742).  Saving model state dict ...
Epoch: 2 cost time: 2.556865930557251
Epoch: 2, Steps: 514 | Train Loss: 0.5629864 Vali Loss: 0.3741856 Best vali loss: 0.3741856
	iters: 100, epoch: 3 | loss: 0.3738729
	speed: 0.0097s/iter; left time: 29.1015s
	iters: 200, epoch: 3 | loss: 0.5337664
	speed: 0.0046s/iter; left time: 13.2515s
	iters: 300, epoch: 3 | loss: 0.6730341
	speed: 0.0047s/iter; left time: 12.9951s
	iters: 400, epoch: 3 | loss: 0.3920505
	speed: 0.0047s/iter; left time: 12.5259s
	iters: 500, epoch: 3 | loss: 0.8274453
	speed: 0.0047s/iter; left time: 12.1032s
Updating learning rate to 0.0003780095696
Epoch: 3 cost time: 2.442448139190674
Epoch: 3, Steps: 514 | Train Loss: 0.5600338 Vali Loss: 0.3863496 Best vali loss: 0.3741856

best validation loss 0.3741855902030098

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4428795
	speed: 0.0088s/iter; left time: 8.2023s
Updating learning rate to 0.0002497903869048074
Validation loss decreased (inf --> 0.3855).  Saving model state dict ...
Epoch: 1 cost time: 0.7074689865112305
Epoch: 1, Steps: 129 | Train Loss: 0.4428795 Vali Loss: 0.3855214 Best vali loss: 0.3855214
	iters: 100, epoch: 2 | loss: 0.5430963
	speed: 0.0062s/iter; left time: 4.9633s
Updating learning rate to 0.00022164530374923903
Validation loss decreased (0.3855 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 0.4680609703063965
Epoch: 2, Steps: 129 | Train Loss: 0.5430963 Vali Loss: 0.3697077 Best vali loss: 0.3697077
	iters: 100, epoch: 3 | loss: 0.6421038
	speed: 0.0063s/iter; left time: 4.2632s
Updating learning rate to 0.000179523210107916
Validation loss decreased (0.3697 --> 0.3654).  Saving model state dict ...
Epoch: 3 cost time: 0.4729166030883789
Epoch: 3, Steps: 129 | Train Loss: 0.6421038 Vali Loss: 0.3654110 Best vali loss: 0.3654110

best validation loss 0.3654109507037989

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013113448531, 'e_layers': 1, 'learning_rate': 0.0002596736258, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4085591
	speed: 0.0087s/iter; left time: 4.7295s
Updating learning rate to 0.0001298368129
Epoch: 4 cost time: 0.6937863826751709
Epoch: 4, Steps: 129 | Train Loss: 0.4085591 Vali Loss: 0.3657449 Best vali loss: 0.3654110
	iters: 100, epoch: 5 | loss: 0.5441370
	speed: 0.0060s/iter; left time: 2.4982s
Updating learning rate to 8.015041569208405e-05
Epoch: 5 cost time: 0.4450845718383789
Epoch: 5, Steps: 129 | Train Loss: 0.5441370 Vali Loss: 0.3659624 Best vali loss: 0.3654110
	iters: 100, epoch: 6 | loss: 0.6178918
	speed: 0.0061s/iter; left time: 1.7495s
Updating learning rate to 3.8028322050761e-05
Epoch: 6 cost time: 0.4612092971801758
Epoch: 6, Steps: 129 | Train Loss: 0.6178918 Vali Loss: 0.3654779 Best vali loss: 0.3654110
	iters: 100, epoch: 7 | loss: 0.7216869
	speed: 0.0062s/iter; left time: 0.9780s
Updating learning rate to 9.883238895192597e-06
Epoch: 7 cost time: 0.45383238792419434
Epoch: 7, Steps: 129 | Train Loss: 0.7216869 Vali Loss: 0.3661015 Best vali loss: 0.3654110
	iters: 100, epoch: 8 | loss: 0.6749430
	speed: 0.0059s/iter; left time: 0.1772s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.41992878913879395
Epoch: 8, Steps: 129 | Train Loss: 0.6749430 Vali Loss: 0.3661506 Best vali loss: 0.3654110

best validation loss 0.3654109507037989

[INFO][abstract_intensifier.py:516] Added config e98a6b as new incumbent because there are no incumbents yet.
{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012865813859, 'e_layers': 2, 'learning_rate': 0.0003414993649, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6508887
	speed: 0.0093s/iter; left time: 18.2033s
	iters: 200, epoch: 1 | loss: 1.1240764
	speed: 0.0036s/iter; left time: 6.7286s
Updating learning rate to 0.0003414993649
Validation loss decreased (inf --> 0.3742).  Saving model state dict ...
Epoch: 1 cost time: 1.235625982284546
Epoch: 1, Steps: 257 | Train Loss: 0.8874826 Vali Loss: 0.3742377 Best vali loss: 0.3742377
	iters: 100, epoch: 2 | loss: 0.3588629
	speed: 0.0086s/iter; left time: 14.6537s
	iters: 200, epoch: 2 | loss: 0.4956456
	speed: 0.0038s/iter; left time: 6.0968s
Updating learning rate to 0.00017074968245
Validation loss decreased (0.3742 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 1.0290343761444092
Epoch: 2, Steps: 257 | Train Loss: 0.4272543 Vali Loss: 0.3666792 Best vali loss: 0.3666792
	iters: 100, epoch: 3 | loss: 0.3917209
	speed: 0.0084s/iter; left time: 12.1490s
	iters: 200, epoch: 3 | loss: 0.5767121
	speed: 0.0038s/iter; left time: 5.1125s
Updating learning rate to 8.5374841225e-05
Epoch: 3 cost time: 1.012779951095581
Epoch: 3, Steps: 257 | Train Loss: 0.4842165 Vali Loss: 0.3682919 Best vali loss: 0.3666792
	iters: 100, epoch: 4 | loss: 0.4799712
	speed: 0.0083s/iter; left time: 9.8003s
	iters: 200, epoch: 4 | loss: 0.3701420
	speed: 0.0036s/iter; left time: 3.8962s
Updating learning rate to 4.26874206125e-05
Validation loss decreased (0.3667 --> 0.3557).  Saving model state dict ...
Epoch: 4 cost time: 0.932572603225708
Epoch: 4, Steps: 257 | Train Loss: 0.4250566 Vali Loss: 0.3556553 Best vali loss: 0.3556553
	iters: 100, epoch: 5 | loss: 0.5408211
	speed: 0.0087s/iter; left time: 8.0807s
	iters: 200, epoch: 5 | loss: 0.4317681
	speed: 0.0036s/iter; left time: 3.0165s
Updating learning rate to 2.134371030625e-05
Validation loss decreased (0.3557 --> 0.3555).  Saving model state dict ...
Epoch: 5 cost time: 1.0108122825622559
Epoch: 5, Steps: 257 | Train Loss: 0.4862946 Vali Loss: 0.3555428 Best vali loss: 0.3555428
	iters: 100, epoch: 6 | loss: 0.4635032
	speed: 0.0084s/iter; left time: 5.6564s
	iters: 200, epoch: 6 | loss: 0.3887253
	speed: 0.0034s/iter; left time: 1.9360s
Updating learning rate to 1.0671855153125e-05
Validation loss decreased (0.3555 --> 0.3518).  Saving model state dict ...
Epoch: 6 cost time: 0.9479105472564697
Epoch: 6, Steps: 257 | Train Loss: 0.4261142 Vali Loss: 0.3517651 Best vali loss: 0.3517651
	iters: 100, epoch: 7 | loss: 0.7299186
	speed: 0.0085s/iter; left time: 3.5344s
	iters: 200, epoch: 7 | loss: 0.3386114
	speed: 0.0035s/iter; left time: 1.1069s
Updating learning rate to 5.3359275765625e-06
Validation loss decreased (0.3518 --> 0.3502).  Saving model state dict ...
Epoch: 7 cost time: 0.973090410232544
Epoch: 7, Steps: 257 | Train Loss: 0.5342650 Vali Loss: 0.3501581 Best vali loss: 0.3501581
	iters: 100, epoch: 8 | loss: 0.2687673
	speed: 0.0082s/iter; left time: 1.2894s
	iters: 200, epoch: 8 | loss: 0.7228745
	speed: 0.0033s/iter; left time: 0.1910s
Updating learning rate to 2.66796378828125e-06
Epoch: 8 cost time: 0.9202160835266113
Epoch: 8, Steps: 257 | Train Loss: 0.4958209 Vali Loss: 0.3520986 Best vali loss: 0.3501581

best validation loss 0.35015813249267624

[INFO][abstract_intensifier.py:595] Added config c221ed and rejected config e98a6b as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0033747601445, 'e_layers': 1, 'learning_rate': 0.0010195596024, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4811887
	speed: 0.0091s/iter; left time: 8.4703s
Updating learning rate to 0.0009807549256163528
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.7423372268676758
Epoch: 1, Steps: 129 | Train Loss: 0.4811887 Vali Loss: 0.3707602 Best vali loss: 0.3707602
	iters: 100, epoch: 2 | loss: 0.4821740
	speed: 0.0067s/iter; left time: 5.3730s
Updating learning rate to 0.0008702485555404501
Validation loss decreased (0.3708 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.49550962448120117
Epoch: 2, Steps: 129 | Train Loss: 0.4821740 Vali Loss: 0.3669783 Best vali loss: 0.3669783
	iters: 100, epoch: 3 | loss: 0.3958572
	speed: 0.0059s/iter; left time: 3.9953s
Updating learning rate to 0.0007048640852736092
Epoch: 3 cost time: 0.43871164321899414
Epoch: 3, Steps: 129 | Train Loss: 0.3958572 Vali Loss: 0.3780354 Best vali loss: 0.3669783
	iters: 100, epoch: 4 | loss: 0.4649741
	speed: 0.0087s/iter; left time: 4.7257s
Updating learning rate to 0.0005097798012
Epoch: 4 cost time: 0.7869217395782471
Epoch: 4, Steps: 129 | Train Loss: 0.4649741 Vali Loss: 0.4099041 Best vali loss: 0.3669783
	iters: 100, epoch: 5 | loss: 0.5597113
	speed: 0.0094s/iter; left time: 3.9319s
Updating learning rate to 0.00031469551712639095
Epoch: 5 cost time: 0.6651697158813477
Epoch: 5, Steps: 129 | Train Loss: 0.5597113 Vali Loss: 0.4115472 Best vali loss: 0.3669783
	iters: 100, epoch: 6 | loss: 0.4103152
	speed: 0.0091s/iter; left time: 2.6262s
Updating learning rate to 0.00014931104685954994
Epoch: 6 cost time: 0.6879572868347168
Epoch: 6, Steps: 129 | Train Loss: 0.4103152 Vali Loss: 0.4168390 Best vali loss: 0.3669783
	iters: 100, epoch: 7 | loss: 0.4627432
	speed: 0.0090s/iter; left time: 1.4271s
Updating learning rate to 3.880467678364731e-05
Epoch: 7 cost time: 0.6934316158294678
Epoch: 7, Steps: 129 | Train Loss: 0.4627432 Vali Loss: 0.4163238 Best vali loss: 0.3669783
	iters: 100, epoch: 8 | loss: 0.3081226
	speed: 0.0093s/iter; left time: 0.2796s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6979334354400635
Epoch: 8, Steps: 129 | Train Loss: 0.3081226 Vali Loss: 0.4184598 Best vali loss: 0.3669783

best validation loss 0.3669783223120309

{'batch_size': 64, 'd_core': 512, 'd_model': 256, 'dropout': 0.0095765985973, 'e_layers': 1, 'learning_rate': 0.0008036931396, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8222441
	speed: 0.0101s/iter; left time: 9.4417s
Updating learning rate to 0.0008036931396
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 0.8969945907592773
Epoch: 1, Steps: 129 | Train Loss: 0.8222441 Vali Loss: 0.3723780 Best vali loss: 0.3723780
	iters: 100, epoch: 2 | loss: 0.4913020
	speed: 0.0088s/iter; left time: 7.1135s
Updating learning rate to 0.0004018465698
Epoch: 2 cost time: 0.6786448955535889
Epoch: 2, Steps: 129 | Train Loss: 0.4913020 Vali Loss: 0.4029873 Best vali loss: 0.3723780
	iters: 100, epoch: 3 | loss: 0.4982567
	speed: 0.0086s/iter; left time: 5.7794s
Updating learning rate to 0.0002009232849
Epoch: 3 cost time: 0.6525866985321045
Epoch: 3, Steps: 129 | Train Loss: 0.4982567 Vali Loss: 0.3799598 Best vali loss: 0.3723780

best validation loss 0.37237800175876656

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3621423
	speed: 0.0108s/iter; left time: 21.1444s
	iters: 200, epoch: 1 | loss: 0.4732802
	speed: 0.0057s/iter; left time: 10.5984s
Updating learning rate to 0.0006153270642
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 1.7095565795898438
Epoch: 1, Steps: 257 | Train Loss: 0.4177113 Vali Loss: 0.3652747 Best vali loss: 0.3652747
	iters: 100, epoch: 2 | loss: 0.6691783
	speed: 0.0130s/iter; left time: 22.0325s
	iters: 200, epoch: 2 | loss: 0.4645570
	speed: 0.0055s/iter; left time: 8.8716s
Updating learning rate to 0.0003076635321
Validation loss decreased (0.3653 --> 0.3592).  Saving model state dict ...
Epoch: 2 cost time: 1.5321834087371826
Epoch: 2, Steps: 257 | Train Loss: 0.5668676 Vali Loss: 0.3592382 Best vali loss: 0.3592382
	iters: 100, epoch: 3 | loss: 0.6140156
	speed: 0.0117s/iter; left time: 16.8850s
	iters: 200, epoch: 3 | loss: 0.4731193
	speed: 0.0053s/iter; left time: 7.1281s
Updating learning rate to 0.00015383176605
Validation loss decreased (0.3592 --> 0.3586).  Saving model state dict ...
Epoch: 3 cost time: 1.434068202972412
Epoch: 3, Steps: 257 | Train Loss: 0.5435674 Vali Loss: 0.3585598 Best vali loss: 0.3585598

best validation loss 0.35855982014964277

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0030607900961, 'e_layers': 1, 'learning_rate': 0.0002423804971, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5744545
	speed: 0.0096s/iter; left time: 18.7961s
	iters: 200, epoch: 1 | loss: 0.3058044
	speed: 0.0034s/iter; left time: 6.3336s
Updating learning rate to 0.0002423804971
Validation loss decreased (inf --> 0.3899).  Saving model state dict ...
Epoch: 1 cost time: 1.2532145977020264
Epoch: 1, Steps: 257 | Train Loss: 0.4401295 Vali Loss: 0.3898755 Best vali loss: 0.3898755
	iters: 100, epoch: 2 | loss: 0.6151443
	speed: 0.0093s/iter; left time: 15.7939s
	iters: 200, epoch: 2 | loss: 0.7813535
	speed: 0.0025s/iter; left time: 4.0385s
Updating learning rate to 0.00012119024855
Validation loss decreased (0.3899 --> 0.3756).  Saving model state dict ...
Epoch: 2 cost time: 0.8244869709014893
Epoch: 2, Steps: 257 | Train Loss: 0.6982489 Vali Loss: 0.3756268 Best vali loss: 0.3756268
	iters: 100, epoch: 3 | loss: 0.7081679
	speed: 0.0082s/iter; left time: 11.8177s
	iters: 200, epoch: 3 | loss: 0.3506011
	speed: 0.0042s/iter; left time: 5.6452s
Updating learning rate to 6.0595124275e-05
Validation loss decreased (0.3756 --> 0.3710).  Saving model state dict ...
Epoch: 3 cost time: 1.080855131149292
Epoch: 3, Steps: 257 | Train Loss: 0.5293845 Vali Loss: 0.3710213 Best vali loss: 0.3710213

best validation loss 0.3710212847221577

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010744850459, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3410850
	speed: 0.0115s/iter; left time: 13.6477s
	iters: 200, epoch: 4 | loss: 0.4066859
	speed: 0.0038s/iter; left time: 4.1733s
Updating learning rate to 7.6915883025e-05
Validation loss decreased (0.3586 --> 0.3523).  Saving model state dict ...
Epoch: 4 cost time: 1.4235200881958008
Epoch: 4, Steps: 257 | Train Loss: 0.3738855 Vali Loss: 0.3523219 Best vali loss: 0.3523219
	iters: 100, epoch: 5 | loss: 0.6588585
	speed: 0.0096s/iter; left time: 8.9491s
	iters: 200, epoch: 5 | loss: 0.3857485
	speed: 0.0057s/iter; left time: 4.7130s
Updating learning rate to 3.84579415125e-05
Epoch: 5 cost time: 1.4405245780944824
Epoch: 5, Steps: 257 | Train Loss: 0.5223035 Vali Loss: 0.3563571 Best vali loss: 0.3523219
	iters: 100, epoch: 6 | loss: 0.5662025
	speed: 0.0124s/iter; left time: 8.3519s
	iters: 200, epoch: 6 | loss: 0.4254990
	speed: 0.0054s/iter; left time: 3.1085s
Updating learning rate to 1.922897075625e-05
Epoch: 6 cost time: 1.4989533424377441
Epoch: 6, Steps: 257 | Train Loss: 0.4958507 Vali Loss: 0.3546544 Best vali loss: 0.3523219
	iters: 100, epoch: 7 | loss: 0.4071760
	speed: 0.0129s/iter; left time: 5.3462s
	iters: 200, epoch: 7 | loss: 0.4238749
	speed: 0.0058s/iter; left time: 1.8365s
Updating learning rate to 9.614485378125e-06
Epoch: 7 cost time: 1.5210416316986084
Epoch: 7, Steps: 257 | Train Loss: 0.4155255 Vali Loss: 0.3524902 Best vali loss: 0.3523219
	iters: 100, epoch: 8 | loss: 0.5555384
	speed: 0.0126s/iter; left time: 1.9870s
	iters: 200, epoch: 8 | loss: 0.7248691
	speed: 0.0057s/iter; left time: 0.3300s
Updating learning rate to 4.8072426890625e-06
Epoch: 8 cost time: 1.5266296863555908
Epoch: 8, Steps: 257 | Train Loss: 0.6402037 Vali Loss: 0.3527067 Best vali loss: 0.3523219

best validation loss 0.352321904511255

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0015028868658, 'e_layers': 3, 'learning_rate': 0.000202867082, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8400228
	speed: 0.0135s/iter; left time: 26.3432s
	iters: 200, epoch: 1 | loss: 1.0493270
	speed: 0.0077s/iter; left time: 14.2479s
Updating learning rate to 0.000202867082
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 2.284257650375366
Epoch: 1, Steps: 257 | Train Loss: 0.9446749 Vali Loss: 0.3650297 Best vali loss: 0.3650297
	iters: 100, epoch: 2 | loss: 0.5123873
	speed: 0.0158s/iter; left time: 26.8504s
	iters: 200, epoch: 2 | loss: 0.6484324
	speed: 0.0069s/iter; left time: 10.9954s
Updating learning rate to 0.000101433541
Validation loss decreased (0.3650 --> 0.3569).  Saving model state dict ...
Epoch: 2 cost time: 1.9274461269378662
Epoch: 2, Steps: 257 | Train Loss: 0.5804099 Vali Loss: 0.3569013 Best vali loss: 0.3569013
	iters: 100, epoch: 3 | loss: 0.4810107
	speed: 0.0161s/iter; left time: 23.2782s
	iters: 200, epoch: 3 | loss: 0.4055078
	speed: 0.0077s/iter; left time: 10.2764s
Updating learning rate to 5.07167705e-05
Epoch: 3 cost time: 2.0189449787139893
Epoch: 3, Steps: 257 | Train Loss: 0.4432592 Vali Loss: 0.3642914 Best vali loss: 0.3569013
	iters: 100, epoch: 4 | loss: 0.4286056
	speed: 0.0153s/iter; left time: 18.2006s
	iters: 200, epoch: 4 | loss: 0.4613878
	speed: 0.0067s/iter; left time: 7.2550s
Updating learning rate to 2.535838525e-05
Validation loss decreased (0.3569 --> 0.3504).  Saving model state dict ...
Epoch: 4 cost time: 1.8778698444366455
Epoch: 4, Steps: 257 | Train Loss: 0.4449967 Vali Loss: 0.3503562 Best vali loss: 0.3503562
	iters: 100, epoch: 5 | loss: 0.4737908
	speed: 0.0160s/iter; left time: 14.8936s
	iters: 200, epoch: 5 | loss: 0.4328419
	speed: 0.0077s/iter; left time: 6.3495s
Updating learning rate to 1.2679192625e-05
Epoch: 5 cost time: 1.9833753108978271
Epoch: 5, Steps: 257 | Train Loss: 0.4533164 Vali Loss: 0.3525552 Best vali loss: 0.3503562
	iters: 100, epoch: 6 | loss: 1.1946253
	speed: 0.0153s/iter; left time: 10.2740s
	iters: 200, epoch: 6 | loss: 0.4559056
	speed: 0.0072s/iter; left time: 4.1009s
Updating learning rate to 6.3395963125e-06
Epoch: 6 cost time: 1.8051457405090332
Epoch: 6, Steps: 257 | Train Loss: 0.8252654 Vali Loss: 0.3541094 Best vali loss: 0.3503562
	iters: 100, epoch: 7 | loss: 0.4699158
	speed: 0.0113s/iter; left time: 4.6829s
	iters: 200, epoch: 7 | loss: 0.3833235
	speed: 0.0073s/iter; left time: 2.3121s
Updating learning rate to 3.16979815625e-06
Epoch: 7 cost time: 1.7263426780700684
Epoch: 7, Steps: 257 | Train Loss: 0.4266197 Vali Loss: 0.3528134 Best vali loss: 0.3503562
	iters: 100, epoch: 8 | loss: 0.4218867
	speed: 0.0146s/iter; left time: 2.3078s
	iters: 200, epoch: 8 | loss: 0.6736193
	speed: 0.0072s/iter; left time: 0.4186s
Updating learning rate to 1.584899078125e-06
Epoch: 8 cost time: 1.829526662826538
Epoch: 8, Steps: 257 | Train Loss: 0.5477530 Vali Loss: 0.3534901 Best vali loss: 0.3503562

best validation loss 0.3503561951790905

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0026114276247, 'e_layers': 2, 'learning_rate': 0.0003412042455, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5081428
	speed: 0.0115s/iter; left time: 22.5513s
	iters: 200, epoch: 1 | loss: 0.3998393
	speed: 0.0054s/iter; left time: 10.0184s
Updating learning rate to 0.0003412042455
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.7702686786651611
Epoch: 1, Steps: 257 | Train Loss: 0.4539910 Vali Loss: 0.3672092 Best vali loss: 0.3672092
	iters: 100, epoch: 2 | loss: 0.6790385
	speed: 0.0130s/iter; left time: 22.0188s
	iters: 200, epoch: 2 | loss: 0.6706109
	speed: 0.0045s/iter; left time: 7.1752s
Updating learning rate to 0.00017060212275
Validation loss decreased (0.3672 --> 0.3612).  Saving model state dict ...
Epoch: 2 cost time: 1.3692853450775146
Epoch: 2, Steps: 257 | Train Loss: 0.6748247 Vali Loss: 0.3611768 Best vali loss: 0.3611768
	iters: 100, epoch: 3 | loss: 0.3483652
	speed: 0.0127s/iter; left time: 18.3715s
	iters: 200, epoch: 3 | loss: 0.5327592
	speed: 0.0051s/iter; left time: 6.8386s
Updating learning rate to 8.5301061375e-05
Validation loss decreased (0.3612 --> 0.3558).  Saving model state dict ...
Epoch: 3 cost time: 1.4297773838043213
Epoch: 3, Steps: 257 | Train Loss: 0.4405622 Vali Loss: 0.3557939 Best vali loss: 0.3557939
	iters: 100, epoch: 4 | loss: 0.5919650
	speed: 0.0127s/iter; left time: 15.0780s
	iters: 200, epoch: 4 | loss: 0.4641920
	speed: 0.0047s/iter; left time: 5.0637s
Updating learning rate to 4.26505306875e-05
Epoch: 4 cost time: 1.3813443183898926
Epoch: 4, Steps: 257 | Train Loss: 0.5280785 Vali Loss: 0.3621095 Best vali loss: 0.3557939
	iters: 100, epoch: 5 | loss: 0.4793341
	speed: 0.0126s/iter; left time: 11.7141s
	iters: 200, epoch: 5 | loss: 0.5223783
	speed: 0.0050s/iter; left time: 4.1153s
Updating learning rate to 2.132526534375e-05
Epoch: 5 cost time: 1.3502931594848633
Epoch: 5, Steps: 257 | Train Loss: 0.5008562 Vali Loss: 0.3584234 Best vali loss: 0.3557939
	iters: 100, epoch: 6 | loss: 0.6650295
	speed: 0.0120s/iter; left time: 8.0823s
	iters: 200, epoch: 6 | loss: 0.7584730
	speed: 0.0053s/iter; left time: 3.0491s
Updating learning rate to 1.0662632671875e-05
Epoch: 6 cost time: 1.3827588558197021
Epoch: 6, Steps: 257 | Train Loss: 0.7117513 Vali Loss: 0.3619317 Best vali loss: 0.3557939
	iters: 100, epoch: 7 | loss: 0.6147783
	speed: 0.0087s/iter; left time: 3.6075s
	iters: 200, epoch: 7 | loss: 0.7661059
	speed: 0.0042s/iter; left time: 1.3279s
Updating learning rate to 5.3313163359375e-06
Epoch: 7 cost time: 1.1590142250061035
Epoch: 7, Steps: 257 | Train Loss: 0.6904421 Vali Loss: 0.3613852 Best vali loss: 0.3557939
	iters: 100, epoch: 8 | loss: 0.4486260
	speed: 0.0126s/iter; left time: 1.9916s
	iters: 200, epoch: 8 | loss: 0.6979831
	speed: 0.0053s/iter; left time: 0.3059s
Updating learning rate to 2.66565816796875e-06
Epoch: 8 cost time: 1.416612148284912
Epoch: 8, Steps: 257 | Train Loss: 0.5733046 Vali Loss: 0.3609034 Best vali loss: 0.3557939

best validation loss 0.35579389689713425

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7204728
	speed: 0.0124s/iter; left time: 11.5800s
Updating learning rate to 0.0002884157887385461
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.1742303371429443
Epoch: 1, Steps: 129 | Train Loss: 0.7204728 Vali Loss: 0.3676048 Best vali loss: 0.3676048
	iters: 100, epoch: 2 | loss: 0.5730880
	speed: 0.0114s/iter; left time: 9.1261s
Updating learning rate to 0.00025591859596019184
Epoch: 2 cost time: 0.8882303237915039
Epoch: 2, Steps: 129 | Train Loss: 0.5730880 Vali Loss: 0.3707542 Best vali loss: 0.3676048
	iters: 100, epoch: 3 | loss: 0.6437247
	speed: 0.0117s/iter; left time: 7.9304s
Updating learning rate to 0.00020728310997765554
Validation loss decreased (0.3676 --> 0.3505).  Saving model state dict ...
Epoch: 3 cost time: 0.9173462390899658
Epoch: 3, Steps: 129 | Train Loss: 0.6437247 Vali Loss: 0.3505434 Best vali loss: 0.3505434

best validation loss 0.35054340832125697

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.003159428647, 'e_layers': 1, 'learning_rate': 0.0035418893013, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6693649
	speed: 0.0094s/iter; left time: 8.7415s
Updating learning rate to 0.0035418893013
Validation loss decreased (inf --> 0.3937).  Saving model state dict ...
Epoch: 1 cost time: 0.7447624206542969
Epoch: 1, Steps: 129 | Train Loss: 0.6693649 Vali Loss: 0.3937234 Best vali loss: 0.3937234
	iters: 100, epoch: 2 | loss: 0.6208957
	speed: 0.0091s/iter; left time: 7.3038s
Updating learning rate to 0.00177094465065
Epoch: 2 cost time: 0.7438719272613525
Epoch: 2, Steps: 129 | Train Loss: 0.6208957 Vali Loss: 0.4013781 Best vali loss: 0.3937234
	iters: 100, epoch: 3 | loss: 0.5652633
	speed: 0.0096s/iter; left time: 6.4774s
Updating learning rate to 0.000885472325325
Validation loss decreased (0.3937 --> 0.3763).  Saving model state dict ...
Epoch: 3 cost time: 0.7112321853637695
Epoch: 3, Steps: 129 | Train Loss: 0.5652633 Vali Loss: 0.3762811 Best vali loss: 0.3762811

best validation loss 0.37628112170691574

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0017113089176, 'e_layers': 4, 'learning_rate': 0.0024116262264, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9311829
	speed: 0.0103s/iter; left time: 83.3801s
	iters: 200, epoch: 1 | loss: 0.2779590
	speed: 0.0061s/iter; left time: 49.2396s
	iters: 300, epoch: 1 | loss: 1.3028864
	speed: 0.0059s/iter; left time: 46.7448s
	iters: 400, epoch: 1 | loss: 0.5229861
	speed: 0.0055s/iter; left time: 42.9490s
	iters: 500, epoch: 1 | loss: 1.3628356
	speed: 0.0061s/iter; left time: 46.9294s
	iters: 600, epoch: 1 | loss: 1.3462019
	speed: 0.0056s/iter; left time: 42.5172s
	iters: 700, epoch: 1 | loss: 0.4815045
	speed: 0.0065s/iter; left time: 48.5413s
	iters: 800, epoch: 1 | loss: 0.4565451
	speed: 0.0061s/iter; left time: 44.9918s
	iters: 900, epoch: 1 | loss: 0.3802772
	speed: 0.0050s/iter; left time: 36.5229s
	iters: 1000, epoch: 1 | loss: 0.4956639
	speed: 0.0049s/iter; left time: 35.1768s
Updating learning rate to 0.0023198391685191953
Validation loss decreased (inf --> 0.4010).  Saving model state dict ...
Epoch: 1 cost time: 6.059441089630127
Epoch: 1, Steps: 1027 | Train Loss: 0.7558043 Vali Loss: 0.4010265 Best vali loss: 0.4010265
	iters: 100, epoch: 2 | loss: 0.7750127
	speed: 0.0159s/iter; left time: 112.5885s
	iters: 200, epoch: 2 | loss: 0.3970651
	speed: 0.0053s/iter; left time: 37.0522s
	iters: 300, epoch: 2 | loss: 0.4110726
	speed: 0.0052s/iter; left time: 35.7010s
	iters: 400, epoch: 2 | loss: 0.3171439
	speed: 0.0054s/iter; left time: 36.9889s
	iters: 500, epoch: 2 | loss: 0.3061584
	speed: 0.0051s/iter; left time: 34.1118s
	iters: 600, epoch: 2 | loss: 0.7813728
	speed: 0.0049s/iter; left time: 32.1020s
	iters: 700, epoch: 2 | loss: 0.3389444
	speed: 0.0060s/iter; left time: 38.6716s
	iters: 800, epoch: 2 | loss: 1.4457757
	speed: 0.0059s/iter; left time: 37.9209s
	iters: 900, epoch: 2 | loss: 0.8791264
	speed: 0.0061s/iter; left time: 38.2748s
	iters: 1000, epoch: 2 | loss: 0.3666762
	speed: 0.0062s/iter; left time: 38.1740s
Updating learning rate to 0.002058451742387382
Validation loss decreased (0.4010 --> 0.4001).  Saving model state dict ...
Epoch: 2 cost time: 5.76945424079895
Epoch: 2, Steps: 1027 | Train Loss: 0.6018348 Vali Loss: 0.4001437 Best vali loss: 0.4001437
	iters: 100, epoch: 3 | loss: 0.3937176
	speed: 0.0159s/iter; left time: 96.4904s
	iters: 200, epoch: 3 | loss: 0.4744630
	speed: 0.0075s/iter; left time: 44.4340s
	iters: 300, epoch: 3 | loss: 0.5489564
	speed: 0.0109s/iter; left time: 63.7765s
	iters: 400, epoch: 3 | loss: 0.2300292
	speed: 0.0076s/iter; left time: 43.9637s
	iters: 500, epoch: 3 | loss: 0.3886760
	speed: 0.0104s/iter; left time: 58.6390s
	iters: 600, epoch: 3 | loss: 0.4484844
	speed: 0.0076s/iter; left time: 42.4525s
	iters: 700, epoch: 3 | loss: 0.6374352
	speed: 0.0085s/iter; left time: 46.3973s
	iters: 800, epoch: 3 | loss: 1.1809425
	speed: 0.0084s/iter; left time: 45.0728s
	iters: 900, epoch: 3 | loss: 1.7864114
	speed: 0.0070s/iter; left time: 37.0544s
	iters: 1000, epoch: 3 | loss: 0.7864166
	speed: 0.0108s/iter; left time: 55.5089s
Updating learning rate to 0.0016672578141502105
Epoch: 3 cost time: 8.71926474571228
Epoch: 3, Steps: 1027 | Train Loss: 0.6875532 Vali Loss: 0.4041231 Best vali loss: 0.4001437

best validation loss 0.40014365494017046

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0018515748519, 'e_layers': 2, 'learning_rate': 0.0002998272853, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5440795
	speed: 0.0147s/iter; left time: 8.0486s
Updating learning rate to 0.00014991364265
Epoch: 4 cost time: 1.4102203845977783
Epoch: 4, Steps: 129 | Train Loss: 0.5440795 Vali Loss: 0.3530991 Best vali loss: 0.3505434
	iters: 100, epoch: 5 | loss: 0.4464834
	speed: 0.0119s/iter; left time: 4.9530s
Updating learning rate to 9.254417532234449e-05
Epoch: 5 cost time: 0.9130229949951172
Epoch: 5, Steps: 129 | Train Loss: 0.4464834 Vali Loss: 0.3695390 Best vali loss: 0.3505434
	iters: 100, epoch: 6 | loss: 0.5631809
	speed: 0.0126s/iter; left time: 3.6213s
Updating learning rate to 4.3908689339808184e-05
Validation loss decreased (0.3505 --> 0.3498).  Saving model state dict ...
Epoch: 6 cost time: 1.0736677646636963
Epoch: 6, Steps: 129 | Train Loss: 0.5631809 Vali Loss: 0.3498120 Best vali loss: 0.3498120
	iters: 100, epoch: 7 | loss: 0.6484976
	speed: 0.0122s/iter; left time: 1.9477s
Updating learning rate to 1.1411496561453903e-05
Epoch: 7 cost time: 0.9666612148284912
Epoch: 7, Steps: 129 | Train Loss: 0.6484976 Vali Loss: 0.3544245 Best vali loss: 0.3498120
	iters: 100, epoch: 8 | loss: 0.3793679
	speed: 0.0133s/iter; left time: 0.4003s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0875966548919678
Epoch: 8, Steps: 129 | Train Loss: 0.3793679 Vali Loss: 0.3520291 Best vali loss: 0.3498120

best validation loss 0.34981202142411927

[INFO][abstract_intensifier.py:595] Added config 134b22 and rejected config c221ed as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0063304072006, 'e_layers': 2, 'learning_rate': 0.0002592776834, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5185909
	speed: 0.0094s/iter; left time: 37.5543s
	iters: 200, epoch: 1 | loss: 0.5836442
	speed: 0.0051s/iter; left time: 19.8013s
	iters: 300, epoch: 1 | loss: 0.6612632
	speed: 0.0056s/iter; left time: 21.4321s
	iters: 400, epoch: 1 | loss: 0.8641998
	speed: 0.0049s/iter; left time: 18.0107s
	iters: 500, epoch: 1 | loss: 0.8824861
	speed: 0.0052s/iter; left time: 18.6816s
Updating learning rate to 0.0002592776834
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 2.8271563053131104
Epoch: 1, Steps: 514 | Train Loss: 0.7020368 Vali Loss: 0.3654460 Best vali loss: 0.3654460
	iters: 100, epoch: 2 | loss: 0.7792543
	speed: 0.0113s/iter; left time: 39.5902s
	iters: 200, epoch: 2 | loss: 1.1851263
	speed: 0.0052s/iter; left time: 17.7179s
	iters: 300, epoch: 2 | loss: 0.8616252
	speed: 0.0053s/iter; left time: 17.5818s
	iters: 400, epoch: 2 | loss: 0.3796244
	speed: 0.0048s/iter; left time: 15.4293s
	iters: 500, epoch: 2 | loss: 1.0958000
	speed: 0.0049s/iter; left time: 15.1693s
Updating learning rate to 0.0001296388417
Epoch: 2 cost time: 2.6164262294769287
Epoch: 2, Steps: 514 | Train Loss: 0.8602860 Vali Loss: 0.3680721 Best vali loss: 0.3654460
	iters: 100, epoch: 3 | loss: 0.3339357
	speed: 0.0116s/iter; left time: 34.7266s
	iters: 200, epoch: 3 | loss: 0.4149361
	speed: 0.0046s/iter; left time: 13.3299s
	iters: 300, epoch: 3 | loss: 0.7140118
	speed: 0.0051s/iter; left time: 14.1444s
	iters: 400, epoch: 3 | loss: 0.6720639
	speed: 0.0051s/iter; left time: 13.7970s
	iters: 500, epoch: 3 | loss: 0.2639908
	speed: 0.0049s/iter; left time: 12.6382s
Updating learning rate to 6.481942085e-05
Epoch: 3 cost time: 2.602985143661499
Epoch: 3, Steps: 514 | Train Loss: 0.4797876 Vali Loss: 0.3673020 Best vali loss: 0.3654460
	iters: 100, epoch: 4 | loss: 1.0399008
	speed: 0.0118s/iter; left time: 29.2606s
	iters: 200, epoch: 4 | loss: 0.4566542
	speed: 0.0050s/iter; left time: 11.7451s
	iters: 300, epoch: 4 | loss: 1.3841782
	speed: 0.0052s/iter; left time: 11.8150s
	iters: 400, epoch: 4 | loss: 0.6606963
	speed: 0.0053s/iter; left time: 11.4987s
	iters: 500, epoch: 4 | loss: 0.4245785
	speed: 0.0050s/iter; left time: 10.2676s
Updating learning rate to 3.2409710425e-05
Epoch: 4 cost time: 2.6610283851623535
Epoch: 4, Steps: 514 | Train Loss: 0.7932016 Vali Loss: 0.3710488 Best vali loss: 0.3654460
	iters: 100, epoch: 5 | loss: 0.3984444
	speed: 0.0112s/iter; left time: 21.8813s
	iters: 200, epoch: 5 | loss: 0.4044266
	speed: 0.0053s/iter; left time: 9.7583s
	iters: 300, epoch: 5 | loss: 1.3014897
	speed: 0.0044s/iter; left time: 7.7294s
	iters: 400, epoch: 5 | loss: 0.4955649
	speed: 0.0035s/iter; left time: 5.8549s
	iters: 500, epoch: 5 | loss: 0.8082548
	speed: 0.0035s/iter; left time: 5.4638s
Updating learning rate to 1.62048552125e-05
Epoch: 5 cost time: 2.2904961109161377
Epoch: 5, Steps: 514 | Train Loss: 0.6816361 Vali Loss: 0.3700282 Best vali loss: 0.3654460
	iters: 100, epoch: 6 | loss: 0.2848715
	speed: 0.0124s/iter; left time: 17.8971s
	iters: 200, epoch: 6 | loss: 0.4885114
	speed: 0.0060s/iter; left time: 8.0102s
	iters: 300, epoch: 6 | loss: 0.3893140
	speed: 0.0048s/iter; left time: 6.0259s
	iters: 400, epoch: 6 | loss: 0.4585627
	speed: 0.0054s/iter; left time: 6.1765s
	iters: 500, epoch: 6 | loss: 1.3599864
	speed: 0.0056s/iter; left time: 5.8827s
Updating learning rate to 8.10242760625e-06
Epoch: 6 cost time: 2.826612949371338
Epoch: 6, Steps: 514 | Train Loss: 0.5962492 Vali Loss: 0.3704132 Best vali loss: 0.3654460
	iters: 100, epoch: 7 | loss: 0.5891216
	speed: 0.0077s/iter; left time: 7.1996s
	iters: 200, epoch: 7 | loss: 0.8059493
	speed: 0.0047s/iter; left time: 3.9017s
	iters: 300, epoch: 7 | loss: 0.3532782
	speed: 0.0056s/iter; left time: 4.0689s
	iters: 400, epoch: 7 | loss: 0.4746796
	speed: 0.0055s/iter; left time: 3.4507s
	iters: 500, epoch: 7 | loss: 0.7079157
	speed: 0.0056s/iter; left time: 2.9443s
Updating learning rate to 4.051213803125e-06
Epoch: 7 cost time: 2.586306571960449
Epoch: 7, Steps: 514 | Train Loss: 0.5861889 Vali Loss: 0.3706692 Best vali loss: 0.3654460
	iters: 100, epoch: 8 | loss: 0.6614162
	speed: 0.0117s/iter; left time: 4.8399s
	iters: 200, epoch: 8 | loss: 0.7227315
	speed: 0.0031s/iter; left time: 0.9880s
	iters: 300, epoch: 8 | loss: 0.4063223
	speed: 0.0032s/iter; left time: 0.6913s
	iters: 400, epoch: 8 | loss: 0.5640593
	speed: 0.0040s/iter; left time: 0.4545s
	iters: 500, epoch: 8 | loss: 0.7513109
	speed: 0.0051s/iter; left time: 0.0766s
Updating learning rate to 2.0256069015625e-06
Epoch: 8 cost time: 2.126147508621216
Epoch: 8, Steps: 514 | Train Loss: 0.6211680 Vali Loss: 0.3709975 Best vali loss: 0.3654460

best validation loss 0.36544603765127937

{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010733605571, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6240085
	speed: 0.0126s/iter; left time: 11.7120s
Updating learning rate to 6.11157199e-05
Validation loss decreased (inf --> 0.4357).  Saving model state dict ...
Epoch: 1 cost time: 1.1018915176391602
Epoch: 1, Steps: 129 | Train Loss: 0.6240085 Vali Loss: 0.4357295 Best vali loss: 0.4357295
	iters: 100, epoch: 2 | loss: 0.6947989
	speed: 0.0106s/iter; left time: 8.5535s
Updating learning rate to 3.055785995e-05
Validation loss decreased (0.4357 --> 0.4204).  Saving model state dict ...
Epoch: 2 cost time: 0.8647966384887695
Epoch: 2, Steps: 129 | Train Loss: 0.6947989 Vali Loss: 0.4204398 Best vali loss: 0.4204398
	iters: 100, epoch: 3 | loss: 0.5958984
	speed: 0.0105s/iter; left time: 7.1096s
Updating learning rate to 1.5278929975e-05
Validation loss decreased (0.4204 --> 0.4141).  Saving model state dict ...
Epoch: 3 cost time: 0.839897632598877
Epoch: 3, Steps: 129 | Train Loss: 0.5958984 Vali Loss: 0.4140592 Best vali loss: 0.4140592
	iters: 100, epoch: 4 | loss: 0.7797271
	speed: 0.0108s/iter; left time: 5.8916s
Updating learning rate to 7.6394649875e-06
Validation loss decreased (0.4141 --> 0.4112).  Saving model state dict ...
Epoch: 4 cost time: 0.87520432472229
Epoch: 4, Steps: 129 | Train Loss: 0.7797271 Vali Loss: 0.4112404 Best vali loss: 0.4112404
	iters: 100, epoch: 5 | loss: 0.5401006
	speed: 0.0120s/iter; left time: 5.0196s
Updating learning rate to 3.81973249375e-06
Validation loss decreased (0.4112 --> 0.4099).  Saving model state dict ...
Epoch: 5 cost time: 0.9499564170837402
Epoch: 5, Steps: 129 | Train Loss: 0.5401006 Vali Loss: 0.4098757 Best vali loss: 0.4098757
	iters: 100, epoch: 6 | loss: 0.6520095
	speed: 0.0109s/iter; left time: 3.1500s
Updating learning rate to 1.909866246875e-06
Validation loss decreased (0.4099 --> 0.4092).  Saving model state dict ...
Epoch: 6 cost time: 0.8951640129089355
Epoch: 6, Steps: 129 | Train Loss: 0.6520095 Vali Loss: 0.4091990 Best vali loss: 0.4091990
	iters: 100, epoch: 7 | loss: 1.2859218
	speed: 0.0106s/iter; left time: 1.6821s
Updating learning rate to 9.549331234375e-07
Validation loss decreased (0.4092 --> 0.4089).  Saving model state dict ...
Epoch: 7 cost time: 0.851722002029419
Epoch: 7, Steps: 129 | Train Loss: 1.2859218 Vali Loss: 0.4088659 Best vali loss: 0.4088659
	iters: 100, epoch: 8 | loss: 0.6633461
	speed: 0.0106s/iter; left time: 0.3179s
Updating learning rate to 4.7746656171875e-07
Validation loss decreased (0.4089 --> 0.4087).  Saving model state dict ...
Epoch: 8 cost time: 0.8387408256530762
Epoch: 8, Steps: 129 | Train Loss: 0.6633461 Vali Loss: 0.4086981 Best vali loss: 0.4086981

best validation loss 0.4086980986923038

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002189490937942002
Validation loss decreased (inf --> 0.3643).  Saving model state dict ...
Epoch: 1 cost time: 0.782555103302002
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3642987 Best vali loss: 0.3642987
Updating learning rate to 0.001942790473283107
Epoch: 2 cost time: 0.4786050319671631
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3759664 Best vali loss: 0.3642987
Updating learning rate to 0.0015735771362223516
Epoch: 3 cost time: 0.4677278995513916
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3857666 Best vali loss: 0.3642987

best validation loss 0.3642986882880535

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0017721446715, 'e_layers': 4, 'learning_rate': 0.0002378546774, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002378546774
Validation loss decreased (inf --> 0.4178).  Saving model state dict ...
Epoch: 1 cost time: 0.8360395431518555
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4177734 Best vali loss: 0.4177734
Updating learning rate to 0.0001189273387
Validation loss decreased (0.4178 --> 0.3972).  Saving model state dict ...
Epoch: 2 cost time: 0.5617353916168213
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3972343 Best vali loss: 0.3972343
Updating learning rate to 5.946366935e-05
Validation loss decreased (0.3972 --> 0.3910).  Saving model state dict ...
Epoch: 3 cost time: 0.5669443607330322
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3909636 Best vali loss: 0.3909636

best validation loss 0.39096359648030027

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0073290448648, 'e_layers': 2, 'learning_rate': 0.0006363706699, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006121502534555532
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 0.7568929195404053
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3716312 Best vali loss: 0.3716312
Updating learning rate to 0.0005431763429672579
Validation loss decreased (0.3716 --> 0.3649).  Saving model state dict ...
Epoch: 2 cost time: 0.4929060935974121
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3648564 Best vali loss: 0.3648564
Updating learning rate to 0.00043994959105690174
Epoch: 3 cost time: 0.4903557300567627
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3681277 Best vali loss: 0.3648564

best validation loss 0.36485641835246435

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013498202028, 'e_layers': 2, 'learning_rate': 0.0022761206208, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0011380603104
Epoch: 4 cost time: 0.8171060085296631
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3864132 Best vali loss: 0.3642987
Updating learning rate to 0.0007025434845776485
Epoch: 5 cost time: 0.419295072555542
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3933630 Best vali loss: 0.3642987
Updating learning rate to 0.0003333301475168929
Epoch: 6 cost time: 0.35262465476989746
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3991999 Best vali loss: 0.3642987
Updating learning rate to 8.662968285799812e-05
Epoch: 7 cost time: 0.5181257724761963
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3956110 Best vali loss: 0.3642987
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5317239761352539
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4015860 Best vali loss: 0.3642987

best validation loss 0.3642986882880535

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0036399733072, 'e_layers': 3, 'learning_rate': 0.0007179148563, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0695324
	speed: 0.0116s/iter; left time: 93.8661s
	iters: 200, epoch: 1 | loss: 0.3702009
	speed: 0.0048s/iter; left time: 38.1745s
	iters: 300, epoch: 1 | loss: 0.4318048
	speed: 0.0053s/iter; left time: 41.7191s
	iters: 400, epoch: 1 | loss: 0.2339409
	speed: 0.0048s/iter; left time: 37.9060s
	iters: 500, epoch: 1 | loss: 0.8787757
	speed: 0.0052s/iter; left time: 39.9324s
	iters: 600, epoch: 1 | loss: 0.4530901
	speed: 0.0037s/iter; left time: 27.8873s
	iters: 700, epoch: 1 | loss: 0.6034732
	speed: 0.0038s/iter; left time: 28.6788s
	iters: 800, epoch: 1 | loss: 0.4244298
	speed: 0.0052s/iter; left time: 38.2371s
	iters: 900, epoch: 1 | loss: 0.2235518
	speed: 0.0053s/iter; left time: 39.0143s
	iters: 1000, epoch: 1 | loss: 0.6522905
	speed: 0.0053s/iter; left time: 38.5487s
Updating learning rate to 0.0006905908490606759
Validation loss decreased (inf --> 0.3693).  Saving model state dict ...
Epoch: 1 cost time: 5.356823205947876
Epoch: 1, Steps: 1027 | Train Loss: 0.5341090 Vali Loss: 0.3693082 Best vali loss: 0.3693082
	iters: 100, epoch: 2 | loss: 0.2166609
	speed: 0.0143s/iter; left time: 101.3401s
	iters: 200, epoch: 2 | loss: 1.5661639
	speed: 0.0051s/iter; left time: 35.7406s
	iters: 300, epoch: 2 | loss: 0.2043442
	speed: 0.0050s/iter; left time: 34.6070s
	iters: 400, epoch: 2 | loss: 0.3039296
	speed: 0.0050s/iter; left time: 33.6217s
	iters: 500, epoch: 2 | loss: 0.6007865
	speed: 0.0048s/iter; left time: 32.1992s
	iters: 600, epoch: 2 | loss: 0.2674896
	speed: 0.0047s/iter; left time: 31.2648s
	iters: 700, epoch: 2 | loss: 1.3648551
	speed: 0.0050s/iter; left time: 32.3766s
	iters: 800, epoch: 2 | loss: 0.2751463
	speed: 0.0049s/iter; left time: 31.2461s
	iters: 900, epoch: 2 | loss: 0.5349398
	speed: 0.0051s/iter; left time: 32.1444s
	iters: 1000, epoch: 2 | loss: 1.0389615
	speed: 0.0047s/iter; left time: 28.9678s
Updating learning rate to 0.0006127786597521479
Validation loss decreased (0.3693 --> 0.3690).  Saving model state dict ...
Epoch: 2 cost time: 5.083370208740234
Epoch: 2, Steps: 1027 | Train Loss: 0.6373278 Vali Loss: 0.3689726 Best vali loss: 0.3689726
	iters: 100, epoch: 3 | loss: 0.4472597
	speed: 0.0150s/iter; left time: 90.8322s
	iters: 200, epoch: 3 | loss: 0.5314680
	speed: 0.0050s/iter; left time: 29.9728s
	iters: 300, epoch: 3 | loss: 0.3023969
	speed: 0.0045s/iter; left time: 26.1289s
	iters: 400, epoch: 3 | loss: 0.3263136
	speed: 0.0049s/iter; left time: 28.0543s
	iters: 500, epoch: 3 | loss: 0.5472047
	speed: 0.0048s/iter; left time: 27.3830s
	iters: 600, epoch: 3 | loss: 0.3677925
	speed: 0.0046s/iter; left time: 25.7595s
	iters: 700, epoch: 3 | loss: 0.2823272
	speed: 0.0046s/iter; left time: 25.2336s
	iters: 800, epoch: 3 | loss: 0.2998399
	speed: 0.0046s/iter; left time: 24.5530s
	iters: 900, epoch: 3 | loss: 0.5543708
	speed: 0.0048s/iter; left time: 25.3668s
	iters: 1000, epoch: 3 | loss: 0.2357439
	speed: 0.0049s/iter; left time: 25.2670s
Updating learning rate to 0.0004963244888273871
Epoch: 3 cost time: 4.9463419914245605
Epoch: 3, Steps: 1027 | Train Loss: 0.3894717 Vali Loss: 0.3732626 Best vali loss: 0.3689726
	iters: 100, epoch: 4 | loss: 1.0732813
	speed: 0.0143s/iter; left time: 72.2622s
	iters: 200, epoch: 4 | loss: 0.3512879
	speed: 0.0051s/iter; left time: 25.0033s
	iters: 300, epoch: 4 | loss: 0.5315157
	speed: 0.0051s/iter; left time: 24.8471s
	iters: 400, epoch: 4 | loss: 0.2305881
	speed: 0.0053s/iter; left time: 25.0191s
	iters: 500, epoch: 4 | loss: 0.8422014
	speed: 0.0053s/iter; left time: 24.6828s
	iters: 600, epoch: 4 | loss: 0.3880744
	speed: 0.0049s/iter; left time: 22.3217s
	iters: 700, epoch: 4 | loss: 0.4964029
	speed: 0.0051s/iter; left time: 22.7325s
	iters: 800, epoch: 4 | loss: 0.5870662
	speed: 0.0049s/iter; left time: 21.1690s
	iters: 900, epoch: 4 | loss: 0.3652101
	speed: 0.0045s/iter; left time: 19.0176s
	iters: 1000, epoch: 4 | loss: 0.4743859
	speed: 0.0048s/iter; left time: 19.8941s
Updating learning rate to 0.00035895742815
Epoch: 4 cost time: 5.1822123527526855
Epoch: 4, Steps: 1027 | Train Loss: 0.5340014 Vali Loss: 0.3767083 Best vali loss: 0.3689726
	iters: 100, epoch: 5 | loss: 0.7289863
	speed: 0.0127s/iter; left time: 51.0994s
	iters: 200, epoch: 5 | loss: 0.2524658
	speed: 0.0047s/iter; left time: 18.2711s
	iters: 300, epoch: 5 | loss: 0.3741769
	speed: 0.0052s/iter; left time: 19.8022s
	iters: 400, epoch: 5 | loss: 0.3167796
	speed: 0.0050s/iter; left time: 18.7063s
	iters: 500, epoch: 5 | loss: 0.3300864
	speed: 0.0051s/iter; left time: 18.2382s
	iters: 600, epoch: 5 | loss: 0.3348369
	speed: 0.0054s/iter; left time: 18.8836s
	iters: 700, epoch: 5 | loss: 0.4698519
	speed: 0.0047s/iter; left time: 16.1476s
	iters: 800, epoch: 5 | loss: 0.8543795
	speed: 0.0047s/iter; left time: 15.4530s
	iters: 900, epoch: 5 | loss: 0.3158609
	speed: 0.0046s/iter; left time: 14.6558s
	iters: 1000, epoch: 5 | loss: 1.1108865
	speed: 0.0046s/iter; left time: 14.3503s
Updating learning rate to 0.00022159036747261294
Epoch: 5 cost time: 4.969579458236694
Epoch: 5, Steps: 1027 | Train Loss: 0.5088311 Vali Loss: 0.3775275 Best vali loss: 0.3689726
	iters: 100, epoch: 6 | loss: 0.5348079
	speed: 0.0139s/iter; left time: 41.4675s
	iters: 200, epoch: 6 | loss: 0.9640706
	speed: 0.0049s/iter; left time: 14.1790s
	iters: 300, epoch: 6 | loss: 0.2166191
	speed: 0.0049s/iter; left time: 13.5473s
	iters: 400, epoch: 6 | loss: 0.7964060
	speed: 0.0041s/iter; left time: 10.8868s
	iters: 500, epoch: 6 | loss: 1.1886005
	speed: 0.0042s/iter; left time: 10.7565s
	iters: 600, epoch: 6 | loss: 0.5894332
	speed: 0.0054s/iter; left time: 13.3833s
	iters: 700, epoch: 6 | loss: 0.3652717
	speed: 0.0052s/iter; left time: 12.3766s
	iters: 800, epoch: 6 | loss: 0.9648194
	speed: 0.0054s/iter; left time: 12.3206s
	iters: 900, epoch: 6 | loss: 0.2759047
	speed: 0.0042s/iter; left time: 9.1592s
	iters: 1000, epoch: 6 | loss: 0.5624241
	speed: 0.0038s/iter; left time: 7.8786s
Updating learning rate to 0.00010513619654785212
Epoch: 6 cost time: 4.861112117767334
Epoch: 6, Steps: 1027 | Train Loss: 0.6458357 Vali Loss: 0.3825936 Best vali loss: 0.3689726
	iters: 100, epoch: 7 | loss: 0.5091822
	speed: 0.0141s/iter; left time: 27.5822s
	iters: 200, epoch: 7 | loss: 1.4047532
	speed: 0.0053s/iter; left time: 9.8496s
	iters: 300, epoch: 7 | loss: 0.4093646
	speed: 0.0050s/iter; left time: 8.7185s
	iters: 400, epoch: 7 | loss: 0.4008441
	speed: 0.0041s/iter; left time: 6.7034s
	iters: 500, epoch: 7 | loss: 1.5831329
	speed: 0.0040s/iter; left time: 6.1827s
	iters: 600, epoch: 7 | loss: 0.4139748
	speed: 0.0051s/iter; left time: 7.3624s
	iters: 700, epoch: 7 | loss: 0.2811396
	speed: 0.0051s/iter; left time: 6.9736s
	iters: 800, epoch: 7 | loss: 0.7303380
	speed: 0.0051s/iter; left time: 6.4469s
	iters: 900, epoch: 7 | loss: 0.7306108
	speed: 0.0039s/iter; left time: 4.4567s
	iters: 1000, epoch: 7 | loss: 0.5910571
	speed: 0.0038s/iter; left time: 4.0375s
Updating learning rate to 2.7324007239324203e-05
Epoch: 7 cost time: 4.822985649108887
Epoch: 7, Steps: 1027 | Train Loss: 0.7054397 Vali Loss: 0.3902874 Best vali loss: 0.3689726
	iters: 100, epoch: 8 | loss: 0.2613695
	speed: 0.0133s/iter; left time: 12.3480s
	iters: 200, epoch: 8 | loss: 0.4861359
	speed: 0.0049s/iter; left time: 4.0353s
	iters: 300, epoch: 8 | loss: 0.7847692
	speed: 0.0048s/iter; left time: 3.4698s
	iters: 400, epoch: 8 | loss: 0.2462672
	speed: 0.0044s/iter; left time: 2.7822s
	iters: 500, epoch: 8 | loss: 0.2617988
	speed: 0.0043s/iter; left time: 2.2910s
	iters: 600, epoch: 8 | loss: 1.2873549
	speed: 0.0038s/iter; left time: 1.6206s
	iters: 700, epoch: 8 | loss: 0.6441470
	speed: 0.0040s/iter; left time: 1.3136s
	iters: 800, epoch: 8 | loss: 0.6448189
	speed: 0.0050s/iter; left time: 1.1374s
	iters: 900, epoch: 8 | loss: 0.4655391
	speed: 0.0051s/iter; left time: 0.6500s
	iters: 1000, epoch: 8 | loss: 0.6616184
	speed: 0.0051s/iter; left time: 0.1422s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.8020405769348145
Epoch: 8, Steps: 1027 | Train Loss: 0.5743819 Vali Loss: 0.3871197 Best vali loss: 0.3689726

best validation loss 0.36897260962979966

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050164002415, 'e_layers': 1, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8328959
	speed: 0.0080s/iter; left time: 65.1081s
	iters: 200, epoch: 1 | loss: 0.2923300
	speed: 0.0027s/iter; left time: 21.3848s
	iters: 300, epoch: 1 | loss: 1.1499056
	speed: 0.0027s/iter; left time: 21.0347s
	iters: 400, epoch: 1 | loss: 0.4717554
	speed: 0.0027s/iter; left time: 21.3667s
	iters: 500, epoch: 1 | loss: 0.4388565
	speed: 0.0026s/iter; left time: 19.7356s
	iters: 600, epoch: 1 | loss: 0.3002563
	speed: 0.0026s/iter; left time: 19.5051s
	iters: 700, epoch: 1 | loss: 0.8430382
	speed: 0.0024s/iter; left time: 18.2767s
	iters: 800, epoch: 1 | loss: 0.3489062
	speed: 0.0028s/iter; left time: 20.4634s
	iters: 900, epoch: 1 | loss: 1.0456532
	speed: 0.0028s/iter; left time: 20.3683s
	iters: 1000, epoch: 1 | loss: 0.4128056
	speed: 0.0028s/iter; left time: 20.4225s
Updating learning rate to 0.0005311094169208142
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 3.0027225017547607
Epoch: 1, Steps: 1027 | Train Loss: 0.6136403 Vali Loss: 0.3657311 Best vali loss: 0.3657311
	iters: 100, epoch: 2 | loss: 0.5288954
	speed: 0.0102s/iter; left time: 72.4415s
	iters: 200, epoch: 2 | loss: 0.4483832
	speed: 0.0027s/iter; left time: 18.6161s
	iters: 300, epoch: 2 | loss: 0.2921532
	speed: 0.0027s/iter; left time: 18.7541s
	iters: 400, epoch: 2 | loss: 0.3300559
	speed: 0.0027s/iter; left time: 18.0600s
	iters: 500, epoch: 2 | loss: 0.2483599
	speed: 0.0026s/iter; left time: 17.3161s
	iters: 600, epoch: 2 | loss: 0.4105301
	speed: 0.0027s/iter; left time: 17.5630s
	iters: 700, epoch: 2 | loss: 0.4785316
	speed: 0.0026s/iter; left time: 16.8282s
	iters: 800, epoch: 2 | loss: 0.4443923
	speed: 0.0027s/iter; left time: 17.1045s
	iters: 900, epoch: 2 | loss: 1.0762138
	speed: 0.0027s/iter; left time: 16.7044s
	iters: 1000, epoch: 2 | loss: 1.1118360
	speed: 0.0026s/iter; left time: 16.2478s
Updating learning rate to 0.0004712667668926594
Epoch: 2 cost time: 2.7816765308380127
Epoch: 2, Steps: 1027 | Train Loss: 0.5369351 Vali Loss: 0.3756105 Best vali loss: 0.3657311
	iters: 100, epoch: 3 | loss: 0.6498420
	speed: 0.0099s/iter; left time: 60.0835s
	iters: 200, epoch: 3 | loss: 0.5739467
	speed: 0.0027s/iter; left time: 15.8407s
	iters: 300, epoch: 3 | loss: 0.2376169
	speed: 0.0023s/iter; left time: 13.2367s
	iters: 400, epoch: 3 | loss: 0.8122805
	speed: 0.0026s/iter; left time: 14.7236s
	iters: 500, epoch: 3 | loss: 0.7849454
	speed: 0.0026s/iter; left time: 14.7079s
	iters: 600, epoch: 3 | loss: 0.6715453
	speed: 0.0027s/iter; left time: 15.1328s
	iters: 700, epoch: 3 | loss: 0.4498715
	speed: 0.0026s/iter; left time: 14.4561s
	iters: 800, epoch: 3 | loss: 0.6067699
	speed: 0.0026s/iter; left time: 14.0868s
	iters: 900, epoch: 3 | loss: 0.5250772
	speed: 0.0026s/iter; left time: 13.8509s
	iters: 1000, epoch: 3 | loss: 0.6177434
	speed: 0.0027s/iter; left time: 13.7076s
Updating learning rate to 0.00038170591200734896
Epoch: 3 cost time: 2.7195117473602295
Epoch: 3, Steps: 1027 | Train Loss: 0.5929639 Vali Loss: 0.3717102 Best vali loss: 0.3657311
	iters: 100, epoch: 4 | loss: 0.4670298
	speed: 0.0107s/iter; left time: 54.0601s
	iters: 200, epoch: 4 | loss: 0.9885210
	speed: 0.0030s/iter; left time: 14.5803s
	iters: 300, epoch: 4 | loss: 0.3469754
	speed: 0.0029s/iter; left time: 13.8919s
	iters: 400, epoch: 4 | loss: 0.4534771
	speed: 0.0027s/iter; left time: 12.6262s
	iters: 500, epoch: 4 | loss: 0.6216821
	speed: 0.0027s/iter; left time: 12.3721s
	iters: 600, epoch: 4 | loss: 0.4847644
	speed: 0.0028s/iter; left time: 12.5565s
	iters: 700, epoch: 4 | loss: 0.2111301
	speed: 0.0028s/iter; left time: 12.2457s
	iters: 800, epoch: 4 | loss: 0.6295589
	speed: 0.0030s/iter; left time: 12.9442s
	iters: 900, epoch: 4 | loss: 0.9373939
	speed: 0.0027s/iter; left time: 11.2531s
	iters: 1000, epoch: 4 | loss: 0.5558059
	speed: 0.0030s/iter; left time: 12.3061s
Updating learning rate to 0.00027606168055
Epoch: 4 cost time: 2.944775104522705
Epoch: 4, Steps: 1027 | Train Loss: 0.5696339 Vali Loss: 0.3775047 Best vali loss: 0.3657311
	iters: 100, epoch: 5 | loss: 0.2609310
	speed: 0.0102s/iter; left time: 40.8951s
	iters: 200, epoch: 5 | loss: 0.5279371
	speed: 0.0030s/iter; left time: 11.8382s
	iters: 300, epoch: 5 | loss: 0.8550663
	speed: 0.0030s/iter; left time: 11.4178s
	iters: 400, epoch: 5 | loss: 0.8122178
	speed: 0.0031s/iter; left time: 11.4765s
	iters: 500, epoch: 5 | loss: 0.3317558
	speed: 0.0030s/iter; left time: 10.8016s
	iters: 600, epoch: 5 | loss: 0.8297693
	speed: 0.0031s/iter; left time: 10.8307s
	iters: 700, epoch: 5 | loss: 1.0743775
	speed: 0.0030s/iter; left time: 10.1730s
	iters: 800, epoch: 5 | loss: 0.4208552
	speed: 0.0030s/iter; left time: 9.9672s
	iters: 900, epoch: 5 | loss: 0.4014939
	speed: 0.0029s/iter; left time: 9.4366s
	iters: 1000, epoch: 5 | loss: 0.2580173
	speed: 0.0030s/iter; left time: 9.3494s
Updating learning rate to 0.00017041744909265108
Epoch: 5 cost time: 3.156665802001953
Epoch: 5, Steps: 1027 | Train Loss: 0.5772421 Vali Loss: 0.4035815 Best vali loss: 0.3657311
	iters: 100, epoch: 6 | loss: 0.5352368
	speed: 0.0110s/iter; left time: 32.7279s
	iters: 200, epoch: 6 | loss: 0.2916093
	speed: 0.0031s/iter; left time: 8.8753s
	iters: 300, epoch: 6 | loss: 0.2885601
	speed: 0.0030s/iter; left time: 8.2232s
	iters: 400, epoch: 6 | loss: 0.2231092
	speed: 0.0029s/iter; left time: 7.8846s
	iters: 500, epoch: 6 | loss: 0.3063154
	speed: 0.0029s/iter; left time: 7.4038s
	iters: 600, epoch: 6 | loss: 0.2840458
	speed: 0.0028s/iter; left time: 6.8887s
	iters: 700, epoch: 6 | loss: 0.2825433
	speed: 0.0028s/iter; left time: 6.7537s
	iters: 800, epoch: 6 | loss: 0.3283652
	speed: 0.0027s/iter; left time: 6.1886s
	iters: 900, epoch: 6 | loss: 1.3364178
	speed: 0.0029s/iter; left time: 6.2972s
	iters: 1000, epoch: 6 | loss: 0.4646626
	speed: 0.0027s/iter; left time: 5.6316s
Updating learning rate to 8.085659420734059e-05
Epoch: 6 cost time: 3.008208751678467
Epoch: 6, Steps: 1027 | Train Loss: 0.4340866 Vali Loss: 0.3905456 Best vali loss: 0.3657311
	iters: 100, epoch: 7 | loss: 0.3335433
	speed: 0.0100s/iter; left time: 19.4947s
	iters: 200, epoch: 7 | loss: 0.7879366
	speed: 0.0026s/iter; left time: 4.8072s
	iters: 300, epoch: 7 | loss: 0.3225951
	speed: 0.0026s/iter; left time: 4.5048s
	iters: 400, epoch: 7 | loss: 0.3822911
	speed: 0.0025s/iter; left time: 4.2196s
	iters: 500, epoch: 7 | loss: 0.2989456
	speed: 0.0028s/iter; left time: 4.3055s
	iters: 600, epoch: 7 | loss: 0.7053707
	speed: 0.0027s/iter; left time: 3.9087s
	iters: 700, epoch: 7 | loss: 0.4883374
	speed: 0.0026s/iter; left time: 3.5121s
	iters: 800, epoch: 7 | loss: 0.2507022
	speed: 0.0027s/iter; left time: 3.3490s
	iters: 900, epoch: 7 | loss: 0.5041479
	speed: 0.0025s/iter; left time: 2.9413s
	iters: 1000, epoch: 7 | loss: 0.4634567
	speed: 0.0027s/iter; left time: 2.8062s
Updating learning rate to 2.101394417918582e-05
Epoch: 7 cost time: 2.7368860244750977
Epoch: 7, Steps: 1027 | Train Loss: 0.4537327 Vali Loss: 0.3948270 Best vali loss: 0.3657311
	iters: 100, epoch: 8 | loss: 0.5611909
	speed: 0.0104s/iter; left time: 9.6586s
	iters: 200, epoch: 8 | loss: 0.3336100
	speed: 0.0028s/iter; left time: 2.3066s
	iters: 300, epoch: 8 | loss: 0.4690803
	speed: 0.0028s/iter; left time: 2.0445s
	iters: 400, epoch: 8 | loss: 0.4051577
	speed: 0.0028s/iter; left time: 1.7476s
	iters: 500, epoch: 8 | loss: 0.3494704
	speed: 0.0027s/iter; left time: 1.4313s
	iters: 600, epoch: 8 | loss: 0.5320961
	speed: 0.0027s/iter; left time: 1.1669s
	iters: 700, epoch: 8 | loss: 0.5908926
	speed: 0.0029s/iter; left time: 0.9597s
	iters: 800, epoch: 8 | loss: 0.4447952
	speed: 0.0027s/iter; left time: 0.6235s
	iters: 900, epoch: 8 | loss: 1.0895183
	speed: 0.0028s/iter; left time: 0.3571s
	iters: 1000, epoch: 8 | loss: 0.6704878
	speed: 0.0029s/iter; left time: 0.0800s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.911846160888672
Epoch: 8, Steps: 1027 | Train Loss: 0.5446299 Vali Loss: 0.3962654 Best vali loss: 0.3657311

best validation loss 0.3657311064789478

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020607904424, 'e_layers': 1, 'learning_rate': 0.0001961966354, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6154590
	speed: 0.0096s/iter; left time: 38.7029s
	iters: 200, epoch: 1 | loss: 0.5905062
	speed: 0.0035s/iter; left time: 13.6788s
	iters: 300, epoch: 1 | loss: 0.6879976
	speed: 0.0036s/iter; left time: 13.6694s
	iters: 400, epoch: 1 | loss: 0.3094800
	speed: 0.0034s/iter; left time: 12.6218s
	iters: 500, epoch: 1 | loss: 1.2997344
	speed: 0.0034s/iter; left time: 12.4248s
Updating learning rate to 0.0001961966354
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 2.122826099395752
Epoch: 1, Steps: 514 | Train Loss: 0.7006354 Vali Loss: 0.3670375 Best vali loss: 0.3670375
	iters: 100, epoch: 2 | loss: 0.8336182
	speed: 0.0090s/iter; left time: 31.5517s
	iters: 200, epoch: 2 | loss: 0.5713409
	speed: 0.0034s/iter; left time: 11.6714s
	iters: 300, epoch: 2 | loss: 0.8596509
	speed: 0.0034s/iter; left time: 11.1349s
	iters: 400, epoch: 2 | loss: 0.5005952
	speed: 0.0032s/iter; left time: 10.2159s
	iters: 500, epoch: 2 | loss: 0.8209733
	speed: 0.0034s/iter; left time: 10.5169s
Updating learning rate to 9.80983177e-05
Epoch: 2 cost time: 1.7782466411590576
Epoch: 2, Steps: 514 | Train Loss: 0.7172357 Vali Loss: 0.3680329 Best vali loss: 0.3670375
	iters: 100, epoch: 3 | loss: 0.6406600
	speed: 0.0091s/iter; left time: 27.2227s
	iters: 200, epoch: 3 | loss: 0.4922599
	speed: 0.0033s/iter; left time: 9.4095s
	iters: 300, epoch: 3 | loss: 0.6475280
	speed: 0.0033s/iter; left time: 9.3235s
	iters: 400, epoch: 3 | loss: 0.4454690
	speed: 0.0037s/iter; left time: 10.0668s
	iters: 500, epoch: 3 | loss: 0.6895862
	speed: 0.0033s/iter; left time: 8.4563s
Updating learning rate to 4.904915885e-05
Epoch: 3 cost time: 1.7871313095092773
Epoch: 3, Steps: 514 | Train Loss: 0.5831006 Vali Loss: 0.3709941 Best vali loss: 0.3670375

best validation loss 0.3670374742952452

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0074951894677, 'e_layers': 4, 'learning_rate': 0.0035821064248, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1140138
	speed: 0.0126s/iter; left time: 50.5417s
	iters: 200, epoch: 1 | loss: 1.0203456
	speed: 0.0059s/iter; left time: 23.1918s
	iters: 300, epoch: 1 | loss: 0.3752244
	speed: 0.0062s/iter; left time: 23.6162s
	iters: 400, epoch: 1 | loss: 0.8928998
	speed: 0.0063s/iter; left time: 23.2741s
	iters: 500, epoch: 1 | loss: 0.5844668
	speed: 0.0061s/iter; left time: 22.0070s
Updating learning rate to 0.0035821064248
Validation loss decreased (inf --> 0.4078).  Saving model state dict ...
Epoch: 1 cost time: 3.5001893043518066
Epoch: 1, Steps: 514 | Train Loss: 0.7973901 Vali Loss: 0.4077806 Best vali loss: 0.4077806
	iters: 100, epoch: 2 | loss: 0.7491002
	speed: 0.0133s/iter; left time: 46.6311s
	iters: 200, epoch: 2 | loss: 0.6651832
	speed: 0.0065s/iter; left time: 22.1228s
	iters: 300, epoch: 2 | loss: 1.0385289
	speed: 0.0068s/iter; left time: 22.5533s
	iters: 400, epoch: 2 | loss: 0.8984941
	speed: 0.0061s/iter; left time: 19.6673s
	iters: 500, epoch: 2 | loss: 0.7094703
	speed: 0.0048s/iter; left time: 14.7536s
Updating learning rate to 0.0017910532124
Validation loss decreased (0.4078 --> 0.3997).  Saving model state dict ...
Epoch: 2 cost time: 3.184110164642334
Epoch: 2, Steps: 514 | Train Loss: 0.8121553 Vali Loss: 0.3997038 Best vali loss: 0.3997038
	iters: 100, epoch: 3 | loss: 0.4228771
	speed: 0.0135s/iter; left time: 40.2973s
	iters: 200, epoch: 3 | loss: 0.8631470
	speed: 0.0068s/iter; left time: 19.6404s
	iters: 300, epoch: 3 | loss: 0.8448170
	speed: 0.0068s/iter; left time: 18.8845s
	iters: 400, epoch: 3 | loss: 0.7898886
	speed: 0.0070s/iter; left time: 18.7290s
	iters: 500, epoch: 3 | loss: 0.4493133
	speed: 0.0068s/iter; left time: 17.5800s
Updating learning rate to 0.0008955266062
Epoch: 3 cost time: 3.577237367630005
Epoch: 3, Steps: 514 | Train Loss: 0.6740086 Vali Loss: 0.4061019 Best vali loss: 0.3997038

best validation loss 0.399703819314951

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7001905
	speed: 0.0151s/iter; left time: 14.0908s
Updating learning rate to 0.0006870327933
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 1.4740378856658936
Epoch: 1, Steps: 129 | Train Loss: 0.7001905 Vali Loss: 0.3708612 Best vali loss: 0.3708612
	iters: 100, epoch: 2 | loss: 0.7640333
	speed: 0.0143s/iter; left time: 11.4943s
Updating learning rate to 0.00034351639665
Epoch: 2 cost time: 1.1317412853240967
Epoch: 2, Steps: 129 | Train Loss: 0.7640333 Vali Loss: 0.3744502 Best vali loss: 0.3708612
	iters: 100, epoch: 3 | loss: 0.5899498
	speed: 0.0141s/iter; left time: 9.5328s
Updating learning rate to 0.000171758198325
Validation loss decreased (0.3709 --> 0.3474).  Saving model state dict ...
Epoch: 3 cost time: 1.155785322189331
Epoch: 3, Steps: 129 | Train Loss: 0.5899498 Vali Loss: 0.3473836 Best vali loss: 0.3473836

best validation loss 0.34738359658563533

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0009551657345, 'e_layers': 4, 'learning_rate': 0.0006870327933, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5446128
	speed: 0.0155s/iter; left time: 8.4766s
Updating learning rate to 8.58790991625e-05
Epoch: 4 cost time: 1.4622066020965576
Epoch: 4, Steps: 129 | Train Loss: 0.5446128 Vali Loss: 0.3526837 Best vali loss: 0.3473836
	iters: 100, epoch: 5 | loss: 0.5718719
	speed: 0.0142s/iter; left time: 5.9254s
Updating learning rate to 4.293954958125e-05
Epoch: 5 cost time: 1.133716106414795
Epoch: 5, Steps: 129 | Train Loss: 0.5718719 Vali Loss: 0.3496326 Best vali loss: 0.3473836
	iters: 100, epoch: 6 | loss: 0.5290766
	speed: 0.0140s/iter; left time: 4.0438s
Updating learning rate to 2.1469774790625e-05
Epoch: 6 cost time: 1.155106782913208
Epoch: 6, Steps: 129 | Train Loss: 0.5290766 Vali Loss: 0.3557021 Best vali loss: 0.3473836
	iters: 100, epoch: 7 | loss: 0.4031639
	speed: 0.0139s/iter; left time: 2.2101s
Updating learning rate to 1.07348873953125e-05
Epoch: 7 cost time: 1.1471986770629883
Epoch: 7, Steps: 129 | Train Loss: 0.4031639 Vali Loss: 0.3520294 Best vali loss: 0.3473836
	iters: 100, epoch: 8 | loss: 0.4556415
	speed: 0.0142s/iter; left time: 0.4250s
Updating learning rate to 5.36744369765625e-06
Epoch: 8 cost time: 1.155362606048584
Epoch: 8, Steps: 129 | Train Loss: 0.4556415 Vali Loss: 0.3517465 Best vali loss: 0.3473836

best validation loss 0.34738359658563533

[INFO][abstract_intensifier.py:595] Added config 27f795 and rejected config 134b22 as incumbent because it is not better than the incumbents on 1 instances:
{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008116820516, 'e_layers': 1, 'learning_rate': 0.0004109547451, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0903082
	speed: 0.0105s/iter; left time: 9.7579s
Updating learning rate to 0.0003953137114431415
Validation loss decreased (inf --> 0.3728).  Saving model state dict ...
Epoch: 1 cost time: 0.9392080307006836
Epoch: 1, Steps: 129 | Train Loss: 1.0903082 Vali Loss: 0.3727955 Best vali loss: 0.3727955
	iters: 100, epoch: 2 | loss: 0.8111333
	speed: 0.0092s/iter; left time: 7.3738s
Updating learning rate to 0.00035077181606049955
Validation loss decreased (0.3728 --> 0.3677).  Saving model state dict ...
Epoch: 2 cost time: 0.6807382106781006
Epoch: 2, Steps: 129 | Train Loss: 0.8111333 Vali Loss: 0.3677240 Best vali loss: 0.3677240
	iters: 100, epoch: 3 | loss: 0.5697822
	speed: 0.0096s/iter; left time: 6.4578s
Updating learning rate to 0.00028411015875079426
Epoch: 3 cost time: 0.7424757480621338
Epoch: 3, Steps: 129 | Train Loss: 0.5697822 Vali Loss: 0.3686494 Best vali loss: 0.3677240
	iters: 100, epoch: 4 | loss: 0.5645341
	speed: 0.0092s/iter; left time: 4.9998s
Updating learning rate to 0.00020547737255
Epoch: 4 cost time: 0.6550369262695312
Epoch: 4, Steps: 129 | Train Loss: 0.5645341 Vali Loss: 0.3681249 Best vali loss: 0.3677240
	iters: 100, epoch: 5 | loss: 0.5653678
	speed: 0.0090s/iter; left time: 3.7677s
Updating learning rate to 0.00012684458634920571
Epoch: 5 cost time: 0.698035717010498
Epoch: 5, Steps: 129 | Train Loss: 0.5653678 Vali Loss: 0.3721679 Best vali loss: 0.3677240
	iters: 100, epoch: 6 | loss: 0.4788215
	speed: 0.0091s/iter; left time: 2.6315s
Updating learning rate to 6.0182929039500455e-05
Epoch: 6 cost time: 0.7275986671447754
Epoch: 6, Steps: 129 | Train Loss: 0.4788215 Vali Loss: 0.3719815 Best vali loss: 0.3677240
	iters: 100, epoch: 7 | loss: 0.6616679
	speed: 0.0095s/iter; left time: 1.5076s
Updating learning rate to 1.5641033656858497e-05
Epoch: 7 cost time: 0.7270917892456055
Epoch: 7, Steps: 129 | Train Loss: 0.6616679 Vali Loss: 0.3706919 Best vali loss: 0.3677240
	iters: 100, epoch: 8 | loss: 0.7006497
	speed: 0.0095s/iter; left time: 0.2855s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7326028347015381
Epoch: 8, Steps: 129 | Train Loss: 0.7006497 Vali Loss: 0.3709694 Best vali loss: 0.3677240

best validation loss 0.3677239716521415

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.008835229483, 'e_layers': 1, 'learning_rate': 0.0016070226056, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8048356
	speed: 0.0103s/iter; left time: 20.1514s
	iters: 200, epoch: 1 | loss: 0.3058145
	speed: 0.0039s/iter; left time: 7.3338s
Updating learning rate to 0.001545858949598399
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.3360154628753662
Epoch: 1, Steps: 257 | Train Loss: 0.5553251 Vali Loss: 0.3707276 Best vali loss: 0.3707276
	iters: 100, epoch: 2 | loss: 1.0754639
	speed: 0.0097s/iter; left time: 16.4673s
	iters: 200, epoch: 2 | loss: 0.5917755
	speed: 0.0042s/iter; left time: 6.6769s
Updating learning rate to 0.0013716795937699173
Epoch: 2 cost time: 1.0937445163726807
Epoch: 2, Steps: 257 | Train Loss: 0.8336197 Vali Loss: 0.3779387 Best vali loss: 0.3707276
	iters: 100, epoch: 3 | loss: 0.5227979
	speed: 0.0100s/iter; left time: 14.4535s
	iters: 200, epoch: 3 | loss: 0.6507905
	speed: 0.0043s/iter; left time: 5.8062s
Updating learning rate to 0.0011110017660996491
Epoch: 3 cost time: 1.0860157012939453
Epoch: 3, Steps: 257 | Train Loss: 0.5867942 Vali Loss: 0.3865941 Best vali loss: 0.3707276
	iters: 100, epoch: 4 | loss: 0.4964006
	speed: 0.0098s/iter; left time: 11.6763s
	iters: 200, epoch: 4 | loss: 0.7476702
	speed: 0.0041s/iter; left time: 4.4900s
Updating learning rate to 0.0008035113028
Epoch: 4 cost time: 1.1003620624542236
Epoch: 4, Steps: 257 | Train Loss: 0.6220354 Vali Loss: 0.3793761 Best vali loss: 0.3707276
	iters: 100, epoch: 5 | loss: 0.4374080
	speed: 0.0103s/iter; left time: 9.6103s
	iters: 200, epoch: 5 | loss: 0.4725110
	speed: 0.0040s/iter; left time: 3.2872s
Updating learning rate to 0.0004960208395003511
Epoch: 5 cost time: 1.100184679031372
Epoch: 5, Steps: 257 | Train Loss: 0.4549595 Vali Loss: 0.4065468 Best vali loss: 0.3707276
	iters: 100, epoch: 6 | loss: 0.5569024
	speed: 0.0095s/iter; left time: 6.3887s
	iters: 200, epoch: 6 | loss: 0.6585943
	speed: 0.0039s/iter; left time: 2.2108s
Updating learning rate to 0.00023534301183008273
Epoch: 6 cost time: 1.0157103538513184
Epoch: 6, Steps: 257 | Train Loss: 0.6077483 Vali Loss: 0.4124319 Best vali loss: 0.3707276
	iters: 100, epoch: 7 | loss: 0.3527884
	speed: 0.0072s/iter; left time: 2.9691s
	iters: 200, epoch: 7 | loss: 0.3109872
	speed: 0.0027s/iter; left time: 0.8483s
Updating learning rate to 6.116365600160105e-05
Epoch: 7 cost time: 0.8030414581298828
Epoch: 7, Steps: 257 | Train Loss: 0.3318878 Vali Loss: 0.4278264 Best vali loss: 0.3707276
	iters: 100, epoch: 8 | loss: 0.5009128
	speed: 0.0103s/iter; left time: 1.6334s
	iters: 200, epoch: 8 | loss: 0.3551091
	speed: 0.0040s/iter; left time: 0.2328s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1538832187652588
Epoch: 8, Steps: 257 | Train Loss: 0.4280110 Vali Loss: 0.4334693 Best vali loss: 0.3707276

best validation loss 0.3707276291603658

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.003701149266, 'e_layers': 1, 'learning_rate': 0.0002377962535, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1014266
	speed: 0.0113s/iter; left time: 10.4983s
Updating learning rate to 0.0002377962535
Validation loss decreased (inf --> 0.3857).  Saving model state dict ...
Epoch: 1 cost time: 0.9726502895355225
Epoch: 1, Steps: 129 | Train Loss: 1.1014266 Vali Loss: 0.3857180 Best vali loss: 0.3857180
	iters: 100, epoch: 2 | loss: 0.8355550
	speed: 0.0088s/iter; left time: 7.0603s
Updating learning rate to 0.00011889812675
Validation loss decreased (0.3857 --> 0.3696).  Saving model state dict ...
Epoch: 2 cost time: 0.6658945083618164
Epoch: 2, Steps: 129 | Train Loss: 0.8355550 Vali Loss: 0.3696439 Best vali loss: 0.3696439
	iters: 100, epoch: 3 | loss: 0.5765018
	speed: 0.0097s/iter; left time: 6.5271s
Updating learning rate to 5.9449063375e-05
Validation loss decreased (0.3696 --> 0.3665).  Saving model state dict ...
Epoch: 3 cost time: 0.7402231693267822
Epoch: 3, Steps: 129 | Train Loss: 0.5765018 Vali Loss: 0.3665179 Best vali loss: 0.3665179

best validation loss 0.366517911245406

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5721465
	speed: 0.0099s/iter; left time: 19.3069s
	iters: 200, epoch: 1 | loss: 0.8475873
	speed: 0.0037s/iter; left time: 6.8719s
Updating learning rate to 0.000380413518
Validation loss decreased (inf --> 0.3662).  Saving model state dict ...
Epoch: 1 cost time: 1.373403787612915
Epoch: 1, Steps: 257 | Train Loss: 0.7098669 Vali Loss: 0.3662402 Best vali loss: 0.3662402
	iters: 100, epoch: 2 | loss: 0.6108014
	speed: 0.0126s/iter; left time: 21.4147s
	iters: 200, epoch: 2 | loss: 0.5678718
	speed: 0.0059s/iter; left time: 9.4774s
Updating learning rate to 0.000190206759
Epoch: 2 cost time: 1.5425865650177002
Epoch: 2, Steps: 257 | Train Loss: 0.5893366 Vali Loss: 0.3721809 Best vali loss: 0.3662402
	iters: 100, epoch: 3 | loss: 0.5189766
	speed: 0.0123s/iter; left time: 17.7265s
	iters: 200, epoch: 3 | loss: 0.8263980
	speed: 0.0052s/iter; left time: 6.9269s
Updating learning rate to 9.51033795e-05
Validation loss decreased (0.3662 --> 0.3579).  Saving model state dict ...
Epoch: 3 cost time: 1.431373119354248
Epoch: 3, Steps: 257 | Train Loss: 0.6726873 Vali Loss: 0.3579270 Best vali loss: 0.3579270

best validation loss 0.3579269782967558

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0038758267905, 'e_layers': 1, 'learning_rate': 0.0011658864209, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3391763
	speed: 0.0090s/iter; left time: 36.1316s
	iters: 200, epoch: 1 | loss: 0.5249398
	speed: 0.0036s/iter; left time: 13.9652s
	iters: 300, epoch: 1 | loss: 0.8626460
	speed: 0.0036s/iter; left time: 13.5429s
	iters: 400, epoch: 1 | loss: 0.6535936
	speed: 0.0036s/iter; left time: 13.3290s
	iters: 500, epoch: 1 | loss: 0.8277605
	speed: 0.0034s/iter; left time: 12.2693s
Updating learning rate to 0.0011215125112011748
Validation loss decreased (inf --> 0.3771).  Saving model state dict ...
Epoch: 1 cost time: 2.098691463470459
Epoch: 1, Steps: 514 | Train Loss: 0.6416233 Vali Loss: 0.3771301 Best vali loss: 0.3771301
	iters: 100, epoch: 2 | loss: 0.8047791
	speed: 0.0095s/iter; left time: 33.4130s
	iters: 200, epoch: 2 | loss: 0.9127592
	speed: 0.0033s/iter; left time: 11.2732s
	iters: 300, epoch: 2 | loss: 0.2983837
	speed: 0.0033s/iter; left time: 10.8659s
	iters: 400, epoch: 2 | loss: 0.8122023
	speed: 0.0036s/iter; left time: 11.6198s
	iters: 500, epoch: 2 | loss: 0.4156281
	speed: 0.0036s/iter; left time: 11.1370s
Updating learning rate to 0.0009951463076058517
Validation loss decreased (0.3771 --> 0.3719).  Saving model state dict ...
Epoch: 2 cost time: 1.8715758323669434
Epoch: 2, Steps: 514 | Train Loss: 0.6487505 Vali Loss: 0.3719337 Best vali loss: 0.3719337
	iters: 100, epoch: 3 | loss: 0.8139830
	speed: 0.0088s/iter; left time: 26.2592s
	iters: 200, epoch: 3 | loss: 0.3613237
	speed: 0.0035s/iter; left time: 10.0776s
	iters: 300, epoch: 3 | loss: 0.9219502
	speed: 0.0038s/iter; left time: 10.4903s
	iters: 400, epoch: 3 | loss: 1.2137156
	speed: 0.0035s/iter; left time: 9.3707s
	iters: 500, epoch: 3 | loss: 0.3991993
	speed: 0.0037s/iter; left time: 9.5922s
Updating learning rate to 0.0008060259190989309
Epoch: 3 cost time: 1.8808670043945312
Epoch: 3, Steps: 514 | Train Loss: 0.7420344 Vali Loss: 0.3744656 Best vali loss: 0.3719337

best validation loss 0.3719337226951052

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0010068042292, 'e_layers': 2, 'learning_rate': 0.000380413518, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4947038
	speed: 0.0133s/iter; left time: 15.7794s
	iters: 200, epoch: 4 | loss: 0.5910503
	speed: 0.0067s/iter; left time: 7.2870s
Updating learning rate to 4.755168975e-05
Epoch: 4 cost time: 2.1422133445739746
Epoch: 4, Steps: 257 | Train Loss: 0.5428771 Vali Loss: 0.3648814 Best vali loss: 0.3579270
	iters: 100, epoch: 5 | loss: 0.4815619
	speed: 0.0145s/iter; left time: 13.5141s
	iters: 200, epoch: 5 | loss: 0.4724560
	speed: 0.0083s/iter; left time: 6.9136s
Updating learning rate to 2.3775844875e-05
Validation loss decreased (0.3579 --> 0.3572).  Saving model state dict ...
Epoch: 5 cost time: 1.8371315002441406
Epoch: 5, Steps: 257 | Train Loss: 0.4770090 Vali Loss: 0.3571838 Best vali loss: 0.3571838
	iters: 100, epoch: 6 | loss: 0.4823992
	speed: 0.0098s/iter; left time: 6.5887s
	iters: 200, epoch: 6 | loss: 0.7776743
	speed: 0.0035s/iter; left time: 2.0083s
Updating learning rate to 1.18879224375e-05
Validation loss decreased (0.3572 --> 0.3545).  Saving model state dict ...
Epoch: 6 cost time: 1.0437226295471191
Epoch: 6, Steps: 257 | Train Loss: 0.6300368 Vali Loss: 0.3545294 Best vali loss: 0.3545294
	iters: 100, epoch: 7 | loss: 0.8758568
	speed: 0.0146s/iter; left time: 6.0384s
	iters: 200, epoch: 7 | loss: 0.4168533
	speed: 0.0074s/iter; left time: 2.3467s
Updating learning rate to 5.94396121875e-06
Validation loss decreased (0.3545 --> 0.3516).  Saving model state dict ...
Epoch: 7 cost time: 1.8831429481506348
Epoch: 7, Steps: 257 | Train Loss: 0.6463550 Vali Loss: 0.3515561 Best vali loss: 0.3515561
	iters: 100, epoch: 8 | loss: 0.5582772
	speed: 0.0164s/iter; left time: 2.5877s
	iters: 200, epoch: 8 | loss: 0.4742947
	speed: 0.0054s/iter; left time: 0.3113s
Updating learning rate to 2.971980609375e-06
Epoch: 8 cost time: 1.9340980052947998
Epoch: 8, Steps: 257 | Train Loss: 0.5162860 Vali Loss: 0.3526770 Best vali loss: 0.3515561

best validation loss 0.35155607644607606

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0072680941331, 'e_layers': 3, 'learning_rate': 0.0001290367597, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4020972
	speed: 0.0130s/iter; left time: 52.1507s
	iters: 200, epoch: 1 | loss: 0.8224426
	speed: 0.0040s/iter; left time: 15.6133s
	iters: 300, epoch: 1 | loss: 0.6807836
	speed: 0.0040s/iter; left time: 15.2953s
	iters: 400, epoch: 1 | loss: 1.2989491
	speed: 0.0057s/iter; left time: 21.1987s
	iters: 500, epoch: 1 | loss: 0.9454163
	speed: 0.0060s/iter; left time: 21.7682s
Updating learning rate to 0.0001290367597
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 3.0817830562591553
Epoch: 1, Steps: 514 | Train Loss: 0.8299378 Vali Loss: 0.3635323 Best vali loss: 0.3635323
	iters: 100, epoch: 2 | loss: 0.8671502
	speed: 0.0129s/iter; left time: 45.1268s
	iters: 200, epoch: 2 | loss: 0.5362384
	speed: 0.0058s/iter; left time: 19.6544s
	iters: 300, epoch: 2 | loss: 0.6953648
	speed: 0.0060s/iter; left time: 19.7244s
	iters: 400, epoch: 2 | loss: 0.4825126
	speed: 0.0057s/iter; left time: 18.2980s
	iters: 500, epoch: 2 | loss: 0.3990557
	speed: 0.0059s/iter; left time: 18.1522s
Updating learning rate to 6.451837985e-05
Validation loss decreased (0.3635 --> 0.3588).  Saving model state dict ...
Epoch: 2 cost time: 3.0715866088867188
Epoch: 2, Steps: 514 | Train Loss: 0.5960643 Vali Loss: 0.3588351 Best vali loss: 0.3588351
	iters: 100, epoch: 3 | loss: 0.9208062
	speed: 0.0134s/iter; left time: 39.9840s
	iters: 200, epoch: 3 | loss: 0.4191078
	speed: 0.0061s/iter; left time: 17.7094s
	iters: 300, epoch: 3 | loss: 0.3303316
	speed: 0.0060s/iter; left time: 16.7339s
	iters: 400, epoch: 3 | loss: 0.4866275
	speed: 0.0056s/iter; left time: 14.9116s
	iters: 500, epoch: 3 | loss: 0.3549708
	speed: 0.0041s/iter; left time: 10.5636s
Updating learning rate to 3.2259189925e-05
Epoch: 3 cost time: 2.8995914459228516
Epoch: 3, Steps: 514 | Train Loss: 0.5023688 Vali Loss: 0.3861804 Best vali loss: 0.3588351
	iters: 100, epoch: 4 | loss: 0.6318268
	speed: 0.0124s/iter; left time: 30.5614s
	iters: 200, epoch: 4 | loss: 0.2868009
	speed: 0.0058s/iter; left time: 13.6505s
	iters: 300, epoch: 4 | loss: 0.3995462
	speed: 0.0062s/iter; left time: 14.1030s
	iters: 400, epoch: 4 | loss: 0.6661788
	speed: 0.0060s/iter; left time: 12.9233s
	iters: 500, epoch: 4 | loss: 0.9382849
	speed: 0.0060s/iter; left time: 12.4545s
Updating learning rate to 1.61295949625e-05
Epoch: 4 cost time: 3.1387813091278076
Epoch: 4, Steps: 514 | Train Loss: 0.5845275 Vali Loss: 0.4126718 Best vali loss: 0.3588351
	iters: 100, epoch: 5 | loss: 0.3034296
	speed: 0.0132s/iter; left time: 25.8435s
	iters: 200, epoch: 5 | loss: 0.6970248
	speed: 0.0061s/iter; left time: 11.2462s
	iters: 300, epoch: 5 | loss: 0.6729536
	speed: 0.0058s/iter; left time: 10.2100s
	iters: 400, epoch: 5 | loss: 0.6585373
	speed: 0.0058s/iter; left time: 9.6471s
	iters: 500, epoch: 5 | loss: 0.5755568
	speed: 0.0063s/iter; left time: 9.7543s
Updating learning rate to 8.06479748125e-06
Epoch: 5 cost time: 3.099142551422119
Epoch: 5, Steps: 514 | Train Loss: 0.5815004 Vali Loss: 0.3930691 Best vali loss: 0.3588351
	iters: 100, epoch: 6 | loss: 0.5496382
	speed: 0.0130s/iter; left time: 18.8021s
	iters: 200, epoch: 6 | loss: 0.5556911
	speed: 0.0060s/iter; left time: 8.0968s
	iters: 300, epoch: 6 | loss: 0.5766678
	speed: 0.0061s/iter; left time: 7.6288s
	iters: 400, epoch: 6 | loss: 0.6857531
	speed: 0.0059s/iter; left time: 6.7020s
	iters: 500, epoch: 6 | loss: 0.5692911
	speed: 0.0061s/iter; left time: 6.3888s
Updating learning rate to 4.032398740625e-06
Epoch: 6 cost time: 3.1408019065856934
Epoch: 6, Steps: 514 | Train Loss: 0.5874082 Vali Loss: 0.3944278 Best vali loss: 0.3588351
	iters: 100, epoch: 7 | loss: 0.8005559
	speed: 0.0111s/iter; left time: 10.3480s
	iters: 200, epoch: 7 | loss: 0.8140129
	speed: 0.0042s/iter; left time: 3.4581s
	iters: 300, epoch: 7 | loss: 0.5003066
	speed: 0.0059s/iter; left time: 4.2796s
	iters: 400, epoch: 7 | loss: 0.5439562
	speed: 0.0057s/iter; left time: 3.5685s
	iters: 500, epoch: 7 | loss: 0.9110319
	speed: 0.0059s/iter; left time: 3.1293s
Updating learning rate to 2.0161993703125e-06
Epoch: 7 cost time: 2.725318193435669
Epoch: 7, Steps: 514 | Train Loss: 0.7139727 Vali Loss: 0.3921277 Best vali loss: 0.3588351
	iters: 100, epoch: 8 | loss: 0.8180929
	speed: 0.0127s/iter; left time: 5.2874s
	iters: 200, epoch: 8 | loss: 0.6356629
	speed: 0.0044s/iter; left time: 1.3751s
	iters: 300, epoch: 8 | loss: 0.8075020
	speed: 0.0049s/iter; left time: 1.0547s
	iters: 400, epoch: 8 | loss: 0.8547614
	speed: 0.0060s/iter; left time: 0.6880s
	iters: 500, epoch: 8 | loss: 0.3778655
	speed: 0.0060s/iter; left time: 0.0898s
Updating learning rate to 1.00809968515625e-06
Epoch: 8 cost time: 2.7871389389038086
Epoch: 8, Steps: 514 | Train Loss: 0.6987770 Vali Loss: 0.3980159 Best vali loss: 0.3588351

best validation loss 0.3588350958580587

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0019930161333, 'e_layers': 4, 'learning_rate': 0.0008547466509, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6683437
	speed: 0.0121s/iter; left time: 48.4280s
	iters: 200, epoch: 1 | loss: 0.5765599
	speed: 0.0063s/iter; left time: 24.6810s
	iters: 300, epoch: 1 | loss: 0.8139700
	speed: 0.0061s/iter; left time: 23.3723s
	iters: 400, epoch: 1 | loss: 0.3172916
	speed: 0.0055s/iter; left time: 20.2937s
	iters: 500, epoch: 1 | loss: 0.7257097
	speed: 0.0052s/iter; left time: 18.7667s
Updating learning rate to 0.00082221479357454
Validation loss decreased (inf --> 0.3747).  Saving model state dict ...
Epoch: 1 cost time: 3.3574559688568115
Epoch: 1, Steps: 514 | Train Loss: 0.6203750 Vali Loss: 0.3746529 Best vali loss: 0.3746529
	iters: 100, epoch: 2 | loss: 0.4043235
	speed: 0.0157s/iter; left time: 54.9010s
	iters: 200, epoch: 2 | loss: 0.5181674
	speed: 0.0068s/iter; left time: 22.9465s
	iters: 300, epoch: 2 | loss: 0.3409796
	speed: 0.0070s/iter; left time: 23.0438s
	iters: 400, epoch: 2 | loss: 0.7332813
	speed: 0.0075s/iter; left time: 24.1296s
	iters: 500, epoch: 2 | loss: 0.5498155
	speed: 0.0071s/iter; left time: 21.9466s
Updating learning rate to 0.0007295719019739402
Validation loss decreased (0.3747 --> 0.3725).  Saving model state dict ...
Epoch: 2 cost time: 3.761056423187256
Epoch: 2, Steps: 514 | Train Loss: 0.5093134 Vali Loss: 0.3725111 Best vali loss: 0.3725111
	iters: 100, epoch: 3 | loss: 0.3395584
	speed: 0.0153s/iter; left time: 45.6563s
	iters: 200, epoch: 3 | loss: 0.8898898
	speed: 0.0068s/iter; left time: 19.6325s
	iters: 300, epoch: 3 | loss: 0.9672783
	speed: 0.0048s/iter; left time: 13.4530s
	iters: 400, epoch: 3 | loss: 0.2883691
	speed: 0.0054s/iter; left time: 14.4116s
	iters: 500, epoch: 3 | loss: 0.4573348
	speed: 0.0063s/iter; left time: 16.3132s
Updating learning rate to 0.0005909220165344886
Validation loss decreased (0.3725 --> 0.3676).  Saving model state dict ...
Epoch: 3 cost time: 3.221018075942993
Epoch: 3, Steps: 514 | Train Loss: 0.5884861 Vali Loss: 0.3676438 Best vali loss: 0.3676438
	iters: 100, epoch: 4 | loss: 0.5955832
	speed: 0.0139s/iter; left time: 34.3211s
	iters: 200, epoch: 4 | loss: 0.7692913
	speed: 0.0062s/iter; left time: 14.8055s
	iters: 300, epoch: 4 | loss: 0.7164078
	speed: 0.0061s/iter; left time: 13.8633s
	iters: 400, epoch: 4 | loss: 0.4695461
	speed: 0.0062s/iter; left time: 13.4690s
	iters: 500, epoch: 4 | loss: 0.2543073
	speed: 0.0061s/iter; left time: 12.6367s
Updating learning rate to 0.00042737332545
Epoch: 4 cost time: 3.260500192642212
Epoch: 4, Steps: 514 | Train Loss: 0.5610271 Vali Loss: 0.3685084 Best vali loss: 0.3676438
	iters: 100, epoch: 5 | loss: 0.4491391
	speed: 0.0139s/iter; left time: 27.1403s
	iters: 200, epoch: 5 | loss: 0.6968245
	speed: 0.0063s/iter; left time: 11.7321s
	iters: 300, epoch: 5 | loss: 0.8004051
	speed: 0.0066s/iter; left time: 11.5811s
	iters: 400, epoch: 5 | loss: 0.3405152
	speed: 0.0062s/iter; left time: 10.3531s
	iters: 500, epoch: 5 | loss: 0.4039724
	speed: 0.0065s/iter; left time: 10.1410s
Updating learning rate to 0.00026382463436551147
Epoch: 5 cost time: 3.362826108932495
Epoch: 5, Steps: 514 | Train Loss: 0.5381713 Vali Loss: 0.3764320 Best vali loss: 0.3676438
	iters: 100, epoch: 6 | loss: 0.8947582
	speed: 0.0123s/iter; left time: 17.6844s
	iters: 200, epoch: 6 | loss: 0.4382491
	speed: 0.0056s/iter; left time: 7.5544s
	iters: 300, epoch: 6 | loss: 0.3502367
	speed: 0.0065s/iter; left time: 8.1106s
	iters: 400, epoch: 6 | loss: 0.4164471
	speed: 0.0064s/iter; left time: 7.2642s
	iters: 500, epoch: 6 | loss: 0.3440923
	speed: 0.0063s/iter; left time: 6.5818s
Updating learning rate to 0.0001251747489260597
Validation loss decreased (0.3676 --> 0.3567).  Saving model state dict ...
Epoch: 6 cost time: 3.121605396270752
Epoch: 6, Steps: 514 | Train Loss: 0.4887567 Vali Loss: 0.3566946 Best vali loss: 0.3566946
	iters: 100, epoch: 7 | loss: 0.5466800
	speed: 0.0141s/iter; left time: 13.0635s
	iters: 200, epoch: 7 | loss: 0.5092036
	speed: 0.0062s/iter; left time: 5.1566s
	iters: 300, epoch: 7 | loss: 0.7125549
	speed: 0.0067s/iter; left time: 4.9152s
	iters: 400, epoch: 7 | loss: 0.2995334
	speed: 0.0065s/iter; left time: 4.1074s
	iters: 500, epoch: 7 | loss: 0.6000343
	speed: 0.0064s/iter; left time: 3.4083s
Updating learning rate to 3.253185732546e-05
Epoch: 7 cost time: 3.4151530265808105
Epoch: 7, Steps: 514 | Train Loss: 0.5336012 Vali Loss: 0.3681035 Best vali loss: 0.3566946
	iters: 100, epoch: 8 | loss: 0.5897281
	speed: 0.0139s/iter; left time: 5.7627s
	iters: 200, epoch: 8 | loss: 0.7584464
	speed: 0.0066s/iter; left time: 2.0928s
	iters: 300, epoch: 8 | loss: 0.4160293
	speed: 0.0064s/iter; left time: 1.3675s
	iters: 400, epoch: 8 | loss: 0.5777674
	speed: 0.0063s/iter; left time: 0.7299s
	iters: 500, epoch: 8 | loss: 0.4973961
	speed: 0.0066s/iter; left time: 0.0989s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4223859310150146
Epoch: 8, Steps: 514 | Train Loss: 0.5678735 Vali Loss: 0.3666888 Best vali loss: 0.3566946

best validation loss 0.3566945674728551

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0076310052387, 'e_layers': 2, 'learning_rate': 6.80015623e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.80015623e-05
Validation loss decreased (inf --> 0.4421).  Saving model state dict ...
Epoch: 1 cost time: 0.7860112190246582
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4421287 Best vali loss: 0.4421287
Updating learning rate to 3.400078115e-05
Validation loss decreased (0.4421 --> 0.4319).  Saving model state dict ...
Epoch: 2 cost time: 0.5154714584350586
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4319402 Best vali loss: 0.4319402
Updating learning rate to 1.7000390575e-05
Validation loss decreased (0.4319 --> 0.4274).  Saving model state dict ...
Epoch: 3 cost time: 0.49526262283325195
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4274159 Best vali loss: 0.4274159

best validation loss 0.4274159038347908

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1215366
	speed: 0.0116s/iter; left time: 94.4745s
	iters: 200, epoch: 1 | loss: 0.8219554
	speed: 0.0054s/iter; left time: 43.3725s
	iters: 300, epoch: 1 | loss: 0.2811391
	speed: 0.0054s/iter; left time: 42.7282s
	iters: 400, epoch: 1 | loss: 0.4466641
	speed: 0.0050s/iter; left time: 39.0497s
	iters: 500, epoch: 1 | loss: 1.2130231
	speed: 0.0047s/iter; left time: 36.1890s
	iters: 600, epoch: 1 | loss: 0.9459447
	speed: 0.0052s/iter; left time: 39.8386s
	iters: 700, epoch: 1 | loss: 0.5071667
	speed: 0.0051s/iter; left time: 38.6670s
	iters: 800, epoch: 1 | loss: 1.1970277
	speed: 0.0052s/iter; left time: 38.7852s
	iters: 900, epoch: 1 | loss: 0.8133252
	speed: 0.0053s/iter; left time: 38.4516s
	iters: 1000, epoch: 1 | loss: 0.7260860
	speed: 0.0050s/iter; left time: 36.1746s
Updating learning rate to 0.0010132106523
Validation loss decreased (inf --> 0.3746).  Saving model state dict ...
Epoch: 1 cost time: 5.6646339893341064
Epoch: 1, Steps: 1027 | Train Loss: 0.8073869 Vali Loss: 0.3746100 Best vali loss: 0.3746100
	iters: 100, epoch: 2 | loss: 0.4883057
	speed: 0.0152s/iter; left time: 107.5952s
	iters: 200, epoch: 2 | loss: 0.7981391
	speed: 0.0053s/iter; left time: 36.8841s
	iters: 300, epoch: 2 | loss: 0.8257932
	speed: 0.0053s/iter; left time: 36.6618s
	iters: 400, epoch: 2 | loss: 0.4805796
	speed: 0.0048s/iter; left time: 32.8249s
	iters: 500, epoch: 2 | loss: 0.3026015
	speed: 0.0047s/iter; left time: 31.1446s
	iters: 600, epoch: 2 | loss: 1.0831162
	speed: 0.0053s/iter; left time: 35.2151s
	iters: 700, epoch: 2 | loss: 0.3046931
	speed: 0.0053s/iter; left time: 34.6524s
	iters: 800, epoch: 2 | loss: 1.0420643
	speed: 0.0053s/iter; left time: 34.1297s
	iters: 900, epoch: 2 | loss: 0.4077482
	speed: 0.0054s/iter; left time: 33.7288s
	iters: 1000, epoch: 2 | loss: 0.9049535
	speed: 0.0050s/iter; left time: 31.0053s
Updating learning rate to 0.00050660532615
Validation loss decreased (0.3746 --> 0.3733).  Saving model state dict ...
Epoch: 2 cost time: 5.369237661361694
Epoch: 2, Steps: 1027 | Train Loss: 0.6637994 Vali Loss: 0.3733418 Best vali loss: 0.3733418
	iters: 100, epoch: 3 | loss: 0.9608107
	speed: 0.0123s/iter; left time: 74.5221s
	iters: 200, epoch: 3 | loss: 0.4777332
	speed: 0.0051s/iter; left time: 30.4071s
	iters: 300, epoch: 3 | loss: 0.2825597
	speed: 0.0051s/iter; left time: 29.6150s
	iters: 400, epoch: 3 | loss: 1.3789346
	speed: 0.0051s/iter; left time: 29.4810s
	iters: 500, epoch: 3 | loss: 0.6898106
	speed: 0.0051s/iter; left time: 28.8815s
	iters: 600, epoch: 3 | loss: 0.9043235
	speed: 0.0052s/iter; left time: 28.8850s
	iters: 700, epoch: 3 | loss: 0.4020827
	speed: 0.0050s/iter; left time: 27.1165s
	iters: 800, epoch: 3 | loss: 0.9798530
	speed: 0.0048s/iter; left time: 25.8924s
	iters: 900, epoch: 3 | loss: 0.2391589
	speed: 0.0052s/iter; left time: 27.2701s
	iters: 1000, epoch: 3 | loss: 0.3204258
	speed: 0.0052s/iter; left time: 26.7829s
Updating learning rate to 0.000253302663075
Epoch: 3 cost time: 5.203187465667725
Epoch: 3, Steps: 1027 | Train Loss: 0.6635693 Vali Loss: 0.3800400 Best vali loss: 0.3733418

best validation loss 0.3733417718724324

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0028298480595, 'e_layers': 3, 'learning_rate': 0.0049106915834, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2274286
	speed: 0.0102s/iter; left time: 82.8410s
	iters: 200, epoch: 1 | loss: 0.4058528
	speed: 0.0055s/iter; left time: 43.8430s
	iters: 300, epoch: 1 | loss: 0.7300159
	speed: 0.0053s/iter; left time: 41.9760s
	iters: 400, epoch: 1 | loss: 0.4209786
	speed: 0.0054s/iter; left time: 42.1720s
	iters: 500, epoch: 1 | loss: 1.9921814
	speed: 0.0056s/iter; left time: 43.0413s
	iters: 600, epoch: 1 | loss: 0.4596820
	speed: 0.0052s/iter; left time: 39.7326s
	iters: 700, epoch: 1 | loss: 1.2167147
	speed: 0.0049s/iter; left time: 36.9582s
	iters: 800, epoch: 1 | loss: 0.3512498
	speed: 0.0047s/iter; left time: 34.9577s
	iters: 900, epoch: 1 | loss: 0.3508885
	speed: 0.0054s/iter; left time: 39.3135s
	iters: 1000, epoch: 1 | loss: 0.9989384
	speed: 0.0053s/iter; left time: 38.0211s
Updating learning rate to 0.004723789513889351
Validation loss decreased (inf --> 0.4027).  Saving model state dict ...
Epoch: 1 cost time: 5.634750843048096
Epoch: 1, Steps: 1027 | Train Loss: 0.7153931 Vali Loss: 0.4027492 Best vali loss: 0.4027492
	iters: 100, epoch: 2 | loss: 1.3682357
	speed: 0.0151s/iter; left time: 107.3195s
	iters: 200, epoch: 2 | loss: 0.3458068
	speed: 0.0049s/iter; left time: 33.9477s
	iters: 300, epoch: 2 | loss: 0.3927359
	speed: 0.0050s/iter; left time: 34.4437s
	iters: 400, epoch: 2 | loss: 1.1767906
	speed: 0.0059s/iter; left time: 40.0657s
	iters: 500, epoch: 2 | loss: 0.6200514
	speed: 0.0058s/iter; left time: 38.5138s
	iters: 600, epoch: 2 | loss: 0.6006798
	speed: 0.0059s/iter; left time: 38.6305s
	iters: 700, epoch: 2 | loss: 0.3173327
	speed: 0.0055s/iter; left time: 35.7112s
	iters: 800, epoch: 2 | loss: 0.4546239
	speed: 0.0051s/iter; left time: 32.6498s
	iters: 900, epoch: 2 | loss: 0.3486897
	speed: 0.0046s/iter; left time: 29.0226s
	iters: 1000, epoch: 2 | loss: 0.2957996
	speed: 0.0052s/iter; left time: 32.4870s
Updating learning rate to 0.004191537451168922
Validation loss decreased (0.4027 --> 0.4025).  Saving model state dict ...
Epoch: 2 cost time: 5.491186141967773
Epoch: 2, Steps: 1027 | Train Loss: 0.5920746 Vali Loss: 0.4025338 Best vali loss: 0.4025338
	iters: 100, epoch: 3 | loss: 0.4388532
	speed: 0.0149s/iter; left time: 90.3086s
	iters: 200, epoch: 3 | loss: 0.3387753
	speed: 0.0051s/iter; left time: 30.2105s
	iters: 300, epoch: 3 | loss: 0.3490874
	speed: 0.0056s/iter; left time: 32.7351s
	iters: 400, epoch: 3 | loss: 0.2385584
	speed: 0.0045s/iter; left time: 25.7410s
	iters: 500, epoch: 3 | loss: 1.0480398
	speed: 0.0050s/iter; left time: 28.0715s
	iters: 600, epoch: 3 | loss: 0.9934604
	speed: 0.0053s/iter; left time: 29.5668s
	iters: 700, epoch: 3 | loss: 0.6555737
	speed: 0.0052s/iter; left time: 28.5749s
	iters: 800, epoch: 3 | loss: 0.2565967
	speed: 0.0051s/iter; left time: 27.5476s
	iters: 900, epoch: 3 | loss: 0.2746864
	speed: 0.0052s/iter; left time: 27.1493s
	iters: 1000, epoch: 3 | loss: 0.3834322
	speed: 0.0052s/iter; left time: 26.7392s
Updating learning rate to 0.003394965946910935
Epoch: 3 cost time: 5.287705659866333
Epoch: 3, Steps: 1027 | Train Loss: 0.4977063 Vali Loss: 0.4109130 Best vali loss: 0.4025338

best validation loss 0.40253383731561

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 3, 'learning_rate': 0.0010132106523, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.1141235
	speed: 0.0112s/iter; left time: 56.1838s
	iters: 200, epoch: 4 | loss: 0.8624397
	speed: 0.0053s/iter; left time: 26.2323s
	iters: 300, epoch: 4 | loss: 0.2714801
	speed: 0.0052s/iter; left time: 25.0430s
	iters: 400, epoch: 4 | loss: 0.4659839
	speed: 0.0047s/iter; left time: 22.3060s
	iters: 500, epoch: 4 | loss: 1.0977044
	speed: 0.0042s/iter; left time: 19.5462s
	iters: 600, epoch: 4 | loss: 0.8487693
	speed: 0.0038s/iter; left time: 17.1590s
	iters: 700, epoch: 4 | loss: 0.3928634
	speed: 0.0044s/iter; left time: 19.5683s
	iters: 800, epoch: 4 | loss: 1.1061999
	speed: 0.0043s/iter; left time: 18.4878s
	iters: 900, epoch: 4 | loss: 0.8071530
	speed: 0.0046s/iter; left time: 19.4864s
	iters: 1000, epoch: 4 | loss: 0.7196072
	speed: 0.0044s/iter; left time: 18.3937s
Updating learning rate to 0.0001266513315375
Epoch: 4 cost time: 5.057565450668335
Epoch: 4, Steps: 1027 | Train Loss: 0.7686324 Vali Loss: 0.3886244 Best vali loss: 0.3733418
	iters: 100, epoch: 5 | loss: 0.3606885
	speed: 0.0114s/iter; left time: 45.6182s
	iters: 200, epoch: 5 | loss: 0.4634177
	speed: 0.0051s/iter; left time: 19.7428s
	iters: 300, epoch: 5 | loss: 0.7298526
	speed: 0.0051s/iter; left time: 19.2536s
	iters: 400, epoch: 5 | loss: 0.4771663
	speed: 0.0051s/iter; left time: 19.0292s
	iters: 500, epoch: 5 | loss: 0.2961334
	speed: 0.0051s/iter; left time: 18.2380s
	iters: 600, epoch: 5 | loss: 0.8744773
	speed: 0.0052s/iter; left time: 18.1718s
	iters: 700, epoch: 5 | loss: 0.2826810
	speed: 0.0051s/iter; left time: 17.4149s
	iters: 800, epoch: 5 | loss: 1.0954524
	speed: 0.0051s/iter; left time: 16.9994s
	iters: 900, epoch: 5 | loss: 0.3921764
	speed: 0.0051s/iter; left time: 16.4000s
	iters: 1000, epoch: 5 | loss: 0.6158532
	speed: 0.0051s/iter; left time: 15.8884s
Updating learning rate to 6.332566576875e-05
Epoch: 5 cost time: 5.164445161819458
Epoch: 5, Steps: 1027 | Train Loss: 0.5587899 Vali Loss: 0.3823704 Best vali loss: 0.3733418
	iters: 100, epoch: 6 | loss: 0.7189198
	speed: 0.0144s/iter; left time: 42.9679s
	iters: 200, epoch: 6 | loss: 0.3978845
	speed: 0.0052s/iter; left time: 15.0825s
	iters: 300, epoch: 6 | loss: 0.2802564
	speed: 0.0052s/iter; left time: 14.4150s
	iters: 400, epoch: 6 | loss: 1.3489320
	speed: 0.0053s/iter; left time: 14.1435s
	iters: 500, epoch: 6 | loss: 0.5343657
	speed: 0.0054s/iter; left time: 14.0677s
	iters: 600, epoch: 6 | loss: 0.9328042
	speed: 0.0054s/iter; left time: 13.3717s
	iters: 700, epoch: 6 | loss: 0.3548464
	speed: 0.0054s/iter; left time: 12.8015s
	iters: 800, epoch: 6 | loss: 0.7227242
	speed: 0.0055s/iter; left time: 12.5232s
	iters: 900, epoch: 6 | loss: 0.2225313
	speed: 0.0054s/iter; left time: 11.7490s
	iters: 1000, epoch: 6 | loss: 0.3524787
	speed: 0.0051s/iter; left time: 10.5732s
Updating learning rate to 3.1662832884375e-05
Epoch: 6 cost time: 5.49350905418396
Epoch: 6, Steps: 1027 | Train Loss: 0.5865743 Vali Loss: 0.3887690 Best vali loss: 0.3733418
	iters: 100, epoch: 7 | loss: 0.6335959
	speed: 0.0145s/iter; left time: 28.2577s
	iters: 200, epoch: 7 | loss: 0.3263090
	speed: 0.0056s/iter; left time: 10.3579s
	iters: 300, epoch: 7 | loss: 0.8113765
	speed: 0.0055s/iter; left time: 9.7006s
	iters: 400, epoch: 7 | loss: 0.3725314
	speed: 0.0050s/iter; left time: 8.2129s
	iters: 500, epoch: 7 | loss: 0.3211997
	speed: 0.0051s/iter; left time: 7.8562s
	iters: 600, epoch: 7 | loss: 0.9417582
	speed: 0.0052s/iter; left time: 7.5526s
	iters: 700, epoch: 7 | loss: 0.3207348
	speed: 0.0053s/iter; left time: 7.1431s
	iters: 800, epoch: 7 | loss: 0.5036904
	speed: 0.0054s/iter; left time: 6.7549s
	iters: 900, epoch: 7 | loss: 1.4600842
	speed: 0.0052s/iter; left time: 6.0065s
	iters: 1000, epoch: 7 | loss: 0.2900814
	speed: 0.0053s/iter; left time: 5.6413s
Updating learning rate to 1.58314164421875e-05
Epoch: 7 cost time: 5.464202404022217
Epoch: 7, Steps: 1027 | Train Loss: 0.5981361 Vali Loss: 0.3860774 Best vali loss: 0.3733418
	iters: 100, epoch: 8 | loss: 0.8066647
	speed: 0.0124s/iter; left time: 11.4872s
	iters: 200, epoch: 8 | loss: 0.2608172
	speed: 0.0051s/iter; left time: 4.2396s
	iters: 300, epoch: 8 | loss: 0.2130837
	speed: 0.0052s/iter; left time: 3.8032s
	iters: 400, epoch: 8 | loss: 0.7658957
	speed: 0.0052s/iter; left time: 3.2524s
	iters: 500, epoch: 8 | loss: 0.8497146
	speed: 0.0051s/iter; left time: 2.7191s
	iters: 600, epoch: 8 | loss: 0.3575017
	speed: 0.0053s/iter; left time: 2.2551s
	iters: 700, epoch: 8 | loss: 0.4365807
	speed: 0.0053s/iter; left time: 1.7375s
	iters: 800, epoch: 8 | loss: 0.5088723
	speed: 0.0052s/iter; left time: 1.1958s
	iters: 900, epoch: 8 | loss: 0.3089111
	speed: 0.0053s/iter; left time: 0.6788s
	iters: 1000, epoch: 8 | loss: 0.4018709
	speed: 0.0053s/iter; left time: 0.1474s
Updating learning rate to 7.91570822109375e-06
Epoch: 8 cost time: 5.357940196990967
Epoch: 8, Steps: 1027 | Train Loss: 0.4909912 Vali Loss: 0.3863870 Best vali loss: 0.3733418

best validation loss 0.3733417718724324

{'batch_size': 8, 'd_core': 128, 'd_model': 128, 'dropout': 0.0049587887577, 'e_layers': 2, 'learning_rate': 0.0017288793159, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5659605
	speed: 0.0100s/iter; left time: 81.2937s
	iters: 200, epoch: 1 | loss: 1.0755324
	speed: 0.0042s/iter; left time: 33.8657s
	iters: 300, epoch: 1 | loss: 1.5182428
	speed: 0.0041s/iter; left time: 32.6269s
	iters: 400, epoch: 1 | loss: 0.8230824
	speed: 0.0040s/iter; left time: 31.4358s
	iters: 500, epoch: 1 | loss: 0.4228685
	speed: 0.0039s/iter; left time: 30.2755s
	iters: 600, epoch: 1 | loss: 1.4668884
	speed: 0.0039s/iter; left time: 30.0284s
	iters: 700, epoch: 1 | loss: 0.3705272
	speed: 0.0039s/iter; left time: 29.5814s
	iters: 800, epoch: 1 | loss: 0.3416132
	speed: 0.0040s/iter; left time: 29.3664s
	iters: 900, epoch: 1 | loss: 0.3692527
	speed: 0.0041s/iter; left time: 29.9350s
	iters: 1000, epoch: 1 | loss: 0.8648105
	speed: 0.0041s/iter; left time: 29.5679s
Updating learning rate to 0.0016630777650210626
Validation loss decreased (inf --> 0.3927).  Saving model state dict ...
Epoch: 1 cost time: 4.490501403808594
Epoch: 1, Steps: 1027 | Train Loss: 0.7818779 Vali Loss: 0.3927032 Best vali loss: 0.3927032
	iters: 100, epoch: 2 | loss: 1.0014579
	speed: 0.0132s/iter; left time: 93.4747s
	iters: 200, epoch: 2 | loss: 0.2233801
	speed: 0.0044s/iter; left time: 31.0790s
	iters: 300, epoch: 2 | loss: 0.2680265
	speed: 0.0043s/iter; left time: 29.7692s
	iters: 400, epoch: 2 | loss: 1.2425287
	speed: 0.0043s/iter; left time: 29.1089s
	iters: 500, epoch: 2 | loss: 0.3828445
	speed: 0.0042s/iter; left time: 28.0475s
	iters: 600, epoch: 2 | loss: 0.5878212
	speed: 0.0041s/iter; left time: 27.2670s
	iters: 700, epoch: 2 | loss: 1.0966749
	speed: 0.0041s/iter; left time: 26.5417s
	iters: 800, epoch: 2 | loss: 0.4992893
	speed: 0.0041s/iter; left time: 25.9353s
	iters: 900, epoch: 2 | loss: 0.5540197
	speed: 0.0039s/iter; left time: 24.7750s
	iters: 1000, epoch: 2 | loss: 0.2939496
	speed: 0.0039s/iter; left time: 24.3256s
Updating learning rate to 0.0014756908020130246
Validation loss decreased (0.3927 --> 0.3885).  Saving model state dict ...
Epoch: 2 cost time: 4.318149566650391
Epoch: 2, Steps: 1027 | Train Loss: 0.6149992 Vali Loss: 0.3884559 Best vali loss: 0.3884559
	iters: 100, epoch: 3 | loss: 0.3252153
	speed: 0.0119s/iter; left time: 71.9240s
	iters: 200, epoch: 3 | loss: 0.4726978
	speed: 0.0030s/iter; left time: 17.7817s
	iters: 300, epoch: 3 | loss: 0.4884490
	speed: 0.0032s/iter; left time: 18.5608s
	iters: 400, epoch: 3 | loss: 0.2832278
	speed: 0.0041s/iter; left time: 23.6065s
	iters: 500, epoch: 3 | loss: 0.4072827
	speed: 0.0039s/iter; left time: 22.3126s
	iters: 600, epoch: 3 | loss: 1.8929592
	speed: 0.0040s/iter; left time: 22.1186s
	iters: 700, epoch: 3 | loss: 0.9228723
	speed: 0.0039s/iter; left time: 21.3473s
	iters: 800, epoch: 3 | loss: 0.3684407
	speed: 0.0040s/iter; left time: 21.2827s
	iters: 900, epoch: 3 | loss: 0.7703193
	speed: 0.0040s/iter; left time: 21.2058s
	iters: 1000, epoch: 3 | loss: 0.2631214
	speed: 0.0039s/iter; left time: 20.2634s
Updating learning rate to 0.0011952463933268102
Validation loss decreased (0.3885 --> 0.3861).  Saving model state dict ...
Epoch: 3 cost time: 3.858736276626587
Epoch: 3, Steps: 1027 | Train Loss: 0.6194586 Vali Loss: 0.3861325 Best vali loss: 0.3861325
	iters: 100, epoch: 4 | loss: 0.5560669
	speed: 0.0129s/iter; left time: 64.8573s
	iters: 200, epoch: 4 | loss: 1.1129875
	speed: 0.0040s/iter; left time: 19.8686s
	iters: 300, epoch: 4 | loss: 0.5249833
	speed: 0.0039s/iter; left time: 18.7061s
	iters: 400, epoch: 4 | loss: 0.5163199
	speed: 0.0036s/iter; left time: 16.8956s
	iters: 500, epoch: 4 | loss: 1.2078738
	speed: 0.0036s/iter; left time: 16.6566s
	iters: 600, epoch: 4 | loss: 1.2730361
	speed: 0.0040s/iter; left time: 18.0162s
	iters: 700, epoch: 4 | loss: 0.3466590
	speed: 0.0040s/iter; left time: 17.6346s
	iters: 800, epoch: 4 | loss: 0.3897940
	speed: 0.0040s/iter; left time: 17.3913s
	iters: 900, epoch: 4 | loss: 0.3818213
	speed: 0.0041s/iter; left time: 17.3879s
	iters: 1000, epoch: 4 | loss: 0.6171345
	speed: 0.0043s/iter; left time: 17.5955s
Updating learning rate to 0.00086443965795
Validation loss decreased (0.3861 --> 0.3820).  Saving model state dict ...
Epoch: 4 cost time: 4.104920148849487
Epoch: 4, Steps: 1027 | Train Loss: 0.6926676 Vali Loss: 0.3819719 Best vali loss: 0.3819719
	iters: 100, epoch: 5 | loss: 0.9312952
	speed: 0.0130s/iter; left time: 51.9674s
	iters: 200, epoch: 5 | loss: 0.3754149
	speed: 0.0041s/iter; left time: 15.9667s
	iters: 300, epoch: 5 | loss: 0.3342759
	speed: 0.0040s/iter; left time: 15.2961s
	iters: 400, epoch: 5 | loss: 0.4005143
	speed: 0.0041s/iter; left time: 15.0687s
	iters: 500, epoch: 5 | loss: 0.6819869
	speed: 0.0039s/iter; left time: 13.9860s
	iters: 600, epoch: 5 | loss: 1.0975651
	speed: 0.0041s/iter; left time: 14.2909s
	iters: 700, epoch: 5 | loss: 0.3701433
	speed: 0.0040s/iter; left time: 13.5475s
	iters: 800, epoch: 5 | loss: 0.9978761
	speed: 0.0040s/iter; left time: 13.2218s
	iters: 900, epoch: 5 | loss: 1.4009664
	speed: 0.0040s/iter; left time: 12.9283s
	iters: 1000, epoch: 5 | loss: 0.6071196
	speed: 0.0040s/iter; left time: 12.4545s
Updating learning rate to 0.0005336329225731899
Epoch: 5 cost time: 4.175174951553345
Epoch: 5, Steps: 1027 | Train Loss: 0.7197158 Vali Loss: 0.4044856 Best vali loss: 0.3819719
	iters: 100, epoch: 6 | loss: 1.4320618
	speed: 0.0126s/iter; left time: 37.5529s
	iters: 200, epoch: 6 | loss: 0.4126076
	speed: 0.0039s/iter; left time: 11.1417s
	iters: 300, epoch: 6 | loss: 0.3686402
	speed: 0.0040s/iter; left time: 11.0193s
	iters: 400, epoch: 6 | loss: 0.3187335
	speed: 0.0039s/iter; left time: 10.4560s
	iters: 500, epoch: 6 | loss: 0.9080231
	speed: 0.0039s/iter; left time: 10.1941s
	iters: 600, epoch: 6 | loss: 0.7005724
	speed: 0.0040s/iter; left time: 9.9930s
	iters: 700, epoch: 6 | loss: 0.4286824
	speed: 0.0042s/iter; left time: 9.8936s
	iters: 800, epoch: 6 | loss: 0.3411784
	speed: 0.0035s/iter; left time: 8.0020s
	iters: 900, epoch: 6 | loss: 0.3880647
	speed: 0.0038s/iter; left time: 8.2871s
	iters: 1000, epoch: 6 | loss: 0.9141995
	speed: 0.0040s/iter; left time: 8.2526s
Updating learning rate to 0.0002531885138869754
Epoch: 6 cost time: 4.054011821746826
Epoch: 6, Steps: 1027 | Train Loss: 0.6212764 Vali Loss: 0.4102862 Best vali loss: 0.3819719
	iters: 100, epoch: 7 | loss: 0.2669035
	speed: 0.0127s/iter; left time: 24.7946s
	iters: 200, epoch: 7 | loss: 0.4453492
	speed: 0.0040s/iter; left time: 7.3533s
	iters: 300, epoch: 7 | loss: 0.2814964
	speed: 0.0040s/iter; left time: 7.0932s
	iters: 400, epoch: 7 | loss: 0.4083014
	speed: 0.0039s/iter; left time: 6.5304s
	iters: 500, epoch: 7 | loss: 0.3386322
	speed: 0.0039s/iter; left time: 6.1121s
	iters: 600, epoch: 7 | loss: 0.4796061
	speed: 0.0040s/iter; left time: 5.7917s
	iters: 700, epoch: 7 | loss: 0.8212739
	speed: 0.0039s/iter; left time: 5.2263s
	iters: 800, epoch: 7 | loss: 0.3576050
	speed: 0.0039s/iter; left time: 4.8664s
	iters: 900, epoch: 7 | loss: 0.8056582
	speed: 0.0039s/iter; left time: 4.5042s
	iters: 1000, epoch: 7 | loss: 1.1340512
	speed: 0.0036s/iter; left time: 3.7958s
Updating learning rate to 6.580155087893739e-05
Epoch: 7 cost time: 4.077914476394653
Epoch: 7, Steps: 1027 | Train Loss: 0.5338877 Vali Loss: 0.4241215 Best vali loss: 0.3819719
	iters: 100, epoch: 8 | loss: 0.5639843
	speed: 0.0121s/iter; left time: 11.2145s
	iters: 200, epoch: 8 | loss: 0.4970204
	speed: 0.0040s/iter; left time: 3.2876s
	iters: 300, epoch: 8 | loss: 0.3800531
	speed: 0.0040s/iter; left time: 2.8948s
	iters: 400, epoch: 8 | loss: 0.3362480
	speed: 0.0040s/iter; left time: 2.5293s
	iters: 500, epoch: 8 | loss: 0.8606864
	speed: 0.0040s/iter; left time: 2.0886s
	iters: 600, epoch: 8 | loss: 0.2190121
	speed: 0.0040s/iter; left time: 1.7271s
	iters: 700, epoch: 8 | loss: 1.1612638
	speed: 0.0040s/iter; left time: 1.3203s
	iters: 800, epoch: 8 | loss: 0.5894749
	speed: 0.0040s/iter; left time: 0.9198s
	iters: 900, epoch: 8 | loss: 0.6380499
	speed: 0.0041s/iter; left time: 0.5231s
	iters: 1000, epoch: 8 | loss: 0.9958852
	speed: 0.0041s/iter; left time: 0.1141s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.160010099411011
Epoch: 8, Steps: 1027 | Train Loss: 0.6241678 Vali Loss: 0.4282429 Best vali loss: 0.3819719

best validation loss 0.38197194495931824

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023094333523, 'e_layers': 2, 'learning_rate': 0.0007022928253, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4139182
	speed: 0.0097s/iter; left time: 38.9175s
	iters: 200, epoch: 1 | loss: 0.3688449
	speed: 0.0046s/iter; left time: 17.8685s
	iters: 300, epoch: 1 | loss: 0.6811899
	speed: 0.0047s/iter; left time: 18.1031s
	iters: 400, epoch: 1 | loss: 0.4914118
	speed: 0.0046s/iter; left time: 17.1680s
	iters: 500, epoch: 1 | loss: 0.3456570
	speed: 0.0046s/iter; left time: 16.7426s
Updating learning rate to 0.0007022928253
Validation loss decreased (inf --> 0.3847).  Saving model state dict ...
Epoch: 1 cost time: 2.6124069690704346
Epoch: 1, Steps: 514 | Train Loss: 0.4602044 Vali Loss: 0.3846983 Best vali loss: 0.3846983
	iters: 100, epoch: 2 | loss: 0.9958380
	speed: 0.0111s/iter; left time: 38.8882s
	iters: 200, epoch: 2 | loss: 0.3235423
	speed: 0.0048s/iter; left time: 16.2349s
	iters: 300, epoch: 2 | loss: 0.7685295
	speed: 0.0049s/iter; left time: 16.0301s
	iters: 400, epoch: 2 | loss: 0.3905254
	speed: 0.0046s/iter; left time: 14.6193s
	iters: 500, epoch: 2 | loss: 0.5002531
	speed: 0.0046s/iter; left time: 14.2838s
Updating learning rate to 0.00035114641265
Validation loss decreased (0.3847 --> 0.3814).  Saving model state dict ...
Epoch: 2 cost time: 2.4701805114746094
Epoch: 2, Steps: 514 | Train Loss: 0.5957377 Vali Loss: 0.3814315 Best vali loss: 0.3814315
	iters: 100, epoch: 3 | loss: 0.2679108
	speed: 0.0108s/iter; left time: 32.1135s
	iters: 200, epoch: 3 | loss: 0.4109136
	speed: 0.0047s/iter; left time: 13.4289s
	iters: 300, epoch: 3 | loss: 0.4788879
	speed: 0.0046s/iter; left time: 12.8482s
	iters: 400, epoch: 3 | loss: 0.4444691
	speed: 0.0047s/iter; left time: 12.6145s
	iters: 500, epoch: 3 | loss: 1.1189283
	speed: 0.0046s/iter; left time: 11.9406s
Updating learning rate to 0.000175573206325
Validation loss decreased (0.3814 --> 0.3730).  Saving model state dict ...
Epoch: 3 cost time: 2.428767442703247
Epoch: 3, Steps: 514 | Train Loss: 0.5442220 Vali Loss: 0.3730388 Best vali loss: 0.3730388
	iters: 100, epoch: 4 | loss: 0.8567148
	speed: 0.0116s/iter; left time: 28.7228s
	iters: 200, epoch: 4 | loss: 0.2967325
	speed: 0.0049s/iter; left time: 11.5586s
	iters: 300, epoch: 4 | loss: 0.3457712
	speed: 0.0047s/iter; left time: 10.6237s
	iters: 400, epoch: 4 | loss: 1.1403005
	speed: 0.0047s/iter; left time: 10.2232s
	iters: 500, epoch: 4 | loss: 0.3853353
	speed: 0.0043s/iter; left time: 8.8244s
Updating learning rate to 8.77866031625e-05
Validation loss decreased (0.3730 --> 0.3729).  Saving model state dict ...
Epoch: 4 cost time: 2.4173660278320312
Epoch: 4, Steps: 514 | Train Loss: 0.6049708 Vali Loss: 0.3729086 Best vali loss: 0.3729086
	iters: 100, epoch: 5 | loss: 0.9122825
	speed: 0.0112s/iter; left time: 21.9140s
	iters: 200, epoch: 5 | loss: 0.3556939
	speed: 0.0047s/iter; left time: 8.7274s
	iters: 300, epoch: 5 | loss: 0.3447596
	speed: 0.0046s/iter; left time: 8.1648s
	iters: 400, epoch: 5 | loss: 0.4130787
	speed: 0.0045s/iter; left time: 7.4852s
	iters: 500, epoch: 5 | loss: 0.4446553
	speed: 0.0049s/iter; left time: 7.6985s
Updating learning rate to 4.389330158125e-05
Epoch: 5 cost time: 2.457077980041504
Epoch: 5, Steps: 514 | Train Loss: 0.4940940 Vali Loss: 0.3730887 Best vali loss: 0.3729086
	iters: 100, epoch: 6 | loss: 0.3973135
	speed: 0.0109s/iter; left time: 15.7785s
	iters: 200, epoch: 6 | loss: 0.3620084
	speed: 0.0048s/iter; left time: 6.3959s
	iters: 300, epoch: 6 | loss: 0.2726750
	speed: 0.0047s/iter; left time: 5.8610s
	iters: 400, epoch: 6 | loss: 0.5877792
	speed: 0.0045s/iter; left time: 5.1859s
	iters: 500, epoch: 6 | loss: 0.2903824
	speed: 0.0047s/iter; left time: 4.9227s
Updating learning rate to 2.1946650790625e-05
Validation loss decreased (0.3729 --> 0.3706).  Saving model state dict ...
Epoch: 6 cost time: 2.448880910873413
Epoch: 6, Steps: 514 | Train Loss: 0.3820317 Vali Loss: 0.3705942 Best vali loss: 0.3705942
	iters: 100, epoch: 7 | loss: 0.3334957
	speed: 0.0111s/iter; left time: 10.3537s
	iters: 200, epoch: 7 | loss: 0.3173243
	speed: 0.0046s/iter; left time: 3.8411s
	iters: 300, epoch: 7 | loss: 0.3961892
	speed: 0.0047s/iter; left time: 3.4346s
	iters: 400, epoch: 7 | loss: 0.8586675
	speed: 0.0046s/iter; left time: 2.8863s
	iters: 500, epoch: 7 | loss: 0.5894428
	speed: 0.0046s/iter; left time: 2.4596s
Updating learning rate to 1.09733253953125e-05
Validation loss decreased (0.3706 --> 0.3684).  Saving model state dict ...
Epoch: 7 cost time: 2.4659554958343506
Epoch: 7, Steps: 514 | Train Loss: 0.4990239 Vali Loss: 0.3684045 Best vali loss: 0.3684045
	iters: 100, epoch: 8 | loss: 0.7110727
	speed: 0.0112s/iter; left time: 4.6607s
	iters: 200, epoch: 8 | loss: 0.5913548
	speed: 0.0046s/iter; left time: 1.4605s
	iters: 300, epoch: 8 | loss: 0.7241364
	speed: 0.0046s/iter; left time: 0.9960s
	iters: 400, epoch: 8 | loss: 0.2750677
	speed: 0.0048s/iter; left time: 0.5484s
	iters: 500, epoch: 8 | loss: 0.4966781
	speed: 0.0046s/iter; left time: 0.0688s
Updating learning rate to 5.48666269765625e-06
Epoch: 8 cost time: 2.4407832622528076
Epoch: 8, Steps: 514 | Train Loss: 0.5596620 Vali Loss: 0.3690715 Best vali loss: 0.3684045

best validation loss 0.36840454068891193

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096207564637, 'e_layers': 2, 'learning_rate': 0.0003903011818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8000959
	speed: 0.0106s/iter; left time: 42.4183s
	iters: 200, epoch: 1 | loss: 0.3300870
	speed: 0.0049s/iter; left time: 19.1898s
	iters: 300, epoch: 1 | loss: 0.5283860
	speed: 0.0047s/iter; left time: 17.8424s
	iters: 400, epoch: 1 | loss: 0.9829745
	speed: 0.0047s/iter; left time: 17.5480s
	iters: 500, epoch: 1 | loss: 0.8997478
	speed: 0.0046s/iter; left time: 16.4807s
Updating learning rate to 0.0003903011818
Validation loss decreased (inf --> 0.3897).  Saving model state dict ...
Epoch: 1 cost time: 2.713862419128418
Epoch: 1, Steps: 514 | Train Loss: 0.7082582 Vali Loss: 0.3897384 Best vali loss: 0.3897384
	iters: 100, epoch: 2 | loss: 1.3238033
	speed: 0.0113s/iter; left time: 39.4945s
	iters: 200, epoch: 2 | loss: 0.6534771
	speed: 0.0047s/iter; left time: 15.9581s
	iters: 300, epoch: 2 | loss: 0.6707288
	speed: 0.0048s/iter; left time: 15.7331s
	iters: 400, epoch: 2 | loss: 0.6302174
	speed: 0.0046s/iter; left time: 14.7561s
	iters: 500, epoch: 2 | loss: 0.7218796
	speed: 0.0048s/iter; left time: 14.8568s
Updating learning rate to 0.0001951505909
Validation loss decreased (0.3897 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 2.5156290531158447
Epoch: 2, Steps: 514 | Train Loss: 0.8000212 Vali Loss: 0.3690788 Best vali loss: 0.3690788
	iters: 100, epoch: 3 | loss: 0.4485910
	speed: 0.0112s/iter; left time: 33.4923s
	iters: 200, epoch: 3 | loss: 0.3929313
	speed: 0.0045s/iter; left time: 12.9736s
	iters: 300, epoch: 3 | loss: 0.5185086
	speed: 0.0048s/iter; left time: 13.4526s
	iters: 400, epoch: 3 | loss: 0.4920582
	speed: 0.0048s/iter; left time: 12.8605s
	iters: 500, epoch: 3 | loss: 0.9920555
	speed: 0.0049s/iter; left time: 12.5398s
Updating learning rate to 9.757529545e-05
Validation loss decreased (0.3691 --> 0.3614).  Saving model state dict ...
Epoch: 3 cost time: 2.49485445022583
Epoch: 3, Steps: 514 | Train Loss: 0.5688289 Vali Loss: 0.3613608 Best vali loss: 0.3613608

best validation loss 0.3613608049503244

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 3, 'learning_rate': 6.03723773e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7199348
	speed: 0.0126s/iter; left time: 11.7583s
Updating learning rate to 5.8074590508259505e-05
Validation loss decreased (inf --> 0.4366).  Saving model state dict ...
Epoch: 1 cost time: 1.1405034065246582
Epoch: 1, Steps: 129 | Train Loss: 0.7199348 Vali Loss: 0.4365684 Best vali loss: 0.4365684
	iters: 100, epoch: 2 | loss: 0.9601367
	speed: 0.0111s/iter; left time: 8.9063s
Updating learning rate to 5.153104734259139e-05
Validation loss decreased (0.4366 --> 0.4223).  Saving model state dict ...
Epoch: 2 cost time: 0.8685798645019531
Epoch: 2, Steps: 129 | Train Loss: 0.9601367 Vali Loss: 0.4222782 Best vali loss: 0.4222782
	iters: 100, epoch: 3 | loss: 0.7662494
	speed: 0.0115s/iter; left time: 7.7741s
Updating learning rate to 4.1737942932602113e-05
Validation loss decreased (0.4223 --> 0.4117).  Saving model state dict ...
Epoch: 3 cost time: 0.9574675559997559
Epoch: 3, Steps: 129 | Train Loss: 0.7662494 Vali Loss: 0.4116634 Best vali loss: 0.4116634

best validation loss 0.41166335409891397

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3351688
	speed: 0.0103s/iter; left time: 41.4408s
	iters: 200, epoch: 1 | loss: 0.3885376
	speed: 0.0051s/iter; left time: 19.9640s
	iters: 300, epoch: 1 | loss: 0.3356673
	speed: 0.0049s/iter; left time: 18.7036s
	iters: 400, epoch: 1 | loss: 0.6646755
	speed: 0.0050s/iter; left time: 18.4893s
	iters: 500, epoch: 1 | loss: 0.4719063
	speed: 0.0050s/iter; left time: 18.1824s
Updating learning rate to 0.00019193372885267988
Validation loss decreased (inf --> 0.4126).  Saving model state dict ...
Epoch: 1 cost time: 2.850146532058716
Epoch: 1, Steps: 514 | Train Loss: 0.4391911 Vali Loss: 0.4126202 Best vali loss: 0.4126202
	iters: 100, epoch: 2 | loss: 0.4477439
	speed: 0.0115s/iter; left time: 40.0991s
	iters: 200, epoch: 2 | loss: 0.3598885
	speed: 0.0048s/iter; left time: 16.1486s
	iters: 300, epoch: 2 | loss: 0.6873467
	speed: 0.0033s/iter; left time: 10.8033s
	iters: 400, epoch: 2 | loss: 0.5809535
	speed: 0.0033s/iter; left time: 10.5080s
	iters: 500, epoch: 2 | loss: 0.3457148
	speed: 0.0042s/iter; left time: 13.1257s
Updating learning rate to 0.00017030763336576413
Validation loss decreased (0.4126 --> 0.3724).  Saving model state dict ...
Epoch: 2 cost time: 2.1317381858825684
Epoch: 2, Steps: 514 | Train Loss: 0.4843295 Vali Loss: 0.3723628 Best vali loss: 0.3723628
	iters: 100, epoch: 3 | loss: 0.3460182
	speed: 0.0119s/iter; left time: 35.5532s
	iters: 200, epoch: 3 | loss: 0.3963697
	speed: 0.0050s/iter; left time: 14.5447s
	iters: 300, epoch: 3 | loss: 0.5380616
	speed: 0.0050s/iter; left time: 14.0542s
	iters: 400, epoch: 3 | loss: 0.6256911
	speed: 0.0048s/iter; left time: 13.0098s
	iters: 500, epoch: 3 | loss: 0.3567729
	speed: 0.0046s/iter; left time: 11.9124s
Updating learning rate to 0.00013794189423609193
Validation loss decreased (0.3724 --> 0.3602).  Saving model state dict ...
Epoch: 3 cost time: 2.602151870727539
Epoch: 3, Steps: 514 | Train Loss: 0.4525827 Vali Loss: 0.3601794 Best vali loss: 0.3601794

best validation loss 0.3601793530179382

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028079405199, 'e_layers': 2, 'learning_rate': 0.0001995278037, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3214990
	speed: 0.0109s/iter; left time: 26.9910s
	iters: 200, epoch: 4 | loss: 0.3565430
	speed: 0.0048s/iter; left time: 11.3384s
	iters: 300, epoch: 4 | loss: 0.3010639
	speed: 0.0053s/iter; left time: 11.9837s
	iters: 400, epoch: 4 | loss: 0.4890069
	speed: 0.0051s/iter; left time: 11.0830s
	iters: 500, epoch: 4 | loss: 0.4658611
	speed: 0.0053s/iter; left time: 11.0504s
Updating learning rate to 9.976390185e-05
Epoch: 4 cost time: 2.873485565185547
Epoch: 4, Steps: 514 | Train Loss: 0.3867948 Vali Loss: 0.3853492 Best vali loss: 0.3601794
	iters: 100, epoch: 5 | loss: 0.2808773
	speed: 0.0113s/iter; left time: 22.0922s
	iters: 200, epoch: 5 | loss: 0.2482198
	speed: 0.0046s/iter; left time: 8.6024s
	iters: 300, epoch: 5 | loss: 0.6002316
	speed: 0.0052s/iter; left time: 9.2124s
	iters: 400, epoch: 5 | loss: 0.4800650
	speed: 0.0051s/iter; left time: 8.5012s
	iters: 500, epoch: 5 | loss: 0.3196126
	speed: 0.0054s/iter; left time: 8.3447s
Updating learning rate to 6.158590946390807e-05
Epoch: 5 cost time: 2.641899347305298
Epoch: 5, Steps: 514 | Train Loss: 0.3858013 Vali Loss: 0.4089372 Best vali loss: 0.3601794
	iters: 100, epoch: 6 | loss: 0.2535149
	speed: 0.0116s/iter; left time: 16.7741s
	iters: 200, epoch: 6 | loss: 0.2901801
	speed: 0.0049s/iter; left time: 6.5732s
	iters: 300, epoch: 6 | loss: 0.4615254
	speed: 0.0050s/iter; left time: 6.2694s
	iters: 400, epoch: 6 | loss: 0.4796412
	speed: 0.0051s/iter; left time: 5.8622s
	iters: 500, epoch: 6 | loss: 0.2942592
	speed: 0.0052s/iter; left time: 5.4684s
Updating learning rate to 2.922017033423585e-05
Epoch: 6 cost time: 2.6590359210968018
Epoch: 6, Steps: 514 | Train Loss: 0.3558241 Vali Loss: 0.4076377 Best vali loss: 0.3601794
	iters: 100, epoch: 7 | loss: 0.4612423
	speed: 0.0115s/iter; left time: 10.6562s
	iters: 200, epoch: 7 | loss: 0.7011342
	speed: 0.0052s/iter; left time: 4.3287s
	iters: 300, epoch: 7 | loss: 0.4509079
	speed: 0.0052s/iter; left time: 3.7763s
	iters: 400, epoch: 7 | loss: 0.4340279
	speed: 0.0051s/iter; left time: 3.1875s
	iters: 500, epoch: 7 | loss: 0.2327118
	speed: 0.0052s/iter; left time: 2.7546s
Updating learning rate to 7.594074847320105e-06
Epoch: 7 cost time: 2.7149245738983154
Epoch: 7, Steps: 514 | Train Loss: 0.4560048 Vali Loss: 0.4267931 Best vali loss: 0.3601794
	iters: 100, epoch: 8 | loss: 0.1699777
	speed: 0.0109s/iter; left time: 4.5137s
	iters: 200, epoch: 8 | loss: 0.2543542
	speed: 0.0050s/iter; left time: 1.5837s
	iters: 300, epoch: 8 | loss: 0.4568730
	speed: 0.0053s/iter; left time: 1.1380s
	iters: 400, epoch: 8 | loss: 0.2133229
	speed: 0.0050s/iter; left time: 0.5712s
	iters: 500, epoch: 8 | loss: 0.4429946
	speed: 0.0056s/iter; left time: 0.0840s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.6717782020568848
Epoch: 8, Steps: 514 | Train Loss: 0.3075045 Vali Loss: 0.4235575 Best vali loss: 0.3601794

best validation loss 0.3601793530179382

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0031170389496, 'e_layers': 1, 'learning_rate': 0.0003294206574, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6002049
	speed: 0.0096s/iter; left time: 38.6520s
	iters: 200, epoch: 1 | loss: 0.5861331
	speed: 0.0035s/iter; left time: 13.5770s
	iters: 300, epoch: 1 | loss: 0.7243405
	speed: 0.0035s/iter; left time: 13.4423s
	iters: 400, epoch: 1 | loss: 0.3034862
	speed: 0.0038s/iter; left time: 13.9457s
	iters: 500, epoch: 1 | loss: 1.1847134
	speed: 0.0036s/iter; left time: 12.9472s
Updating learning rate to 0.0003168828301791364
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 2.1639392375946045
Epoch: 1, Steps: 514 | Train Loss: 0.6797756 Vali Loss: 0.3674994 Best vali loss: 0.3674994
	iters: 100, epoch: 2 | loss: 0.8242413
	speed: 0.0061s/iter; left time: 21.2990s
	iters: 200, epoch: 2 | loss: 0.5463061
	speed: 0.0027s/iter; left time: 9.3259s
	iters: 300, epoch: 2 | loss: 0.8464564
	speed: 0.0038s/iter; left time: 12.5117s
	iters: 400, epoch: 2 | loss: 0.5068282
	speed: 0.0037s/iter; left time: 11.9013s
	iters: 500, epoch: 2 | loss: 0.8216140
	speed: 0.0037s/iter; left time: 11.6045s
Updating learning rate to 0.0002811781190552352
Epoch: 2 cost time: 1.742361307144165
Epoch: 2, Steps: 514 | Train Loss: 0.7090892 Vali Loss: 0.3711647 Best vali loss: 0.3674994
	iters: 100, epoch: 3 | loss: 0.4919840
	speed: 0.0102s/iter; left time: 30.3462s
	iters: 200, epoch: 3 | loss: 0.4919581
	speed: 0.0038s/iter; left time: 10.9109s
	iters: 300, epoch: 3 | loss: 0.6011283
	speed: 0.0038s/iter; left time: 10.7173s
	iters: 400, epoch: 3 | loss: 0.4180919
	speed: 0.0034s/iter; left time: 9.2118s
	iters: 500, epoch: 3 | loss: 0.7071750
	speed: 0.0035s/iter; left time: 9.1337s
Updating learning rate to 0.0002277422426328982
Epoch: 3 cost time: 1.943049430847168
Epoch: 3, Steps: 514 | Train Loss: 0.5420675 Vali Loss: 0.3732278 Best vali loss: 0.3674994
	iters: 100, epoch: 4 | loss: 0.5516322
	speed: 0.0097s/iter; left time: 24.0494s
	iters: 200, epoch: 4 | loss: 0.3357633
	speed: 0.0039s/iter; left time: 9.2485s
	iters: 300, epoch: 4 | loss: 0.4724849
	speed: 0.0038s/iter; left time: 8.6782s
	iters: 400, epoch: 4 | loss: 0.3105070
	speed: 0.0037s/iter; left time: 8.0662s
	iters: 500, epoch: 4 | loss: 0.7451422
	speed: 0.0035s/iter; left time: 7.3075s
Updating learning rate to 0.0001647103287
Epoch: 4 cost time: 1.968477725982666
Epoch: 4, Steps: 514 | Train Loss: 0.4831059 Vali Loss: 0.3849391 Best vali loss: 0.3674994
	iters: 100, epoch: 5 | loss: 0.6182848
	speed: 0.0101s/iter; left time: 19.8315s
	iters: 200, epoch: 5 | loss: 0.8927069
	speed: 0.0040s/iter; left time: 7.4725s
	iters: 300, epoch: 5 | loss: 0.2926271
	speed: 0.0039s/iter; left time: 6.7831s
	iters: 400, epoch: 5 | loss: 0.3001529
	speed: 0.0038s/iter; left time: 6.2194s
	iters: 500, epoch: 5 | loss: 0.4436161
	speed: 0.0033s/iter; left time: 5.1844s
Updating learning rate to 0.00010167841476710186
Epoch: 5 cost time: 2.0003085136413574
Epoch: 5, Steps: 514 | Train Loss: 0.5094775 Vali Loss: 0.3863707 Best vali loss: 0.3674994
	iters: 100, epoch: 6 | loss: 0.4161936
	speed: 0.0071s/iter; left time: 10.1854s
	iters: 200, epoch: 6 | loss: 0.3913060
	speed: 0.0022s/iter; left time: 3.0148s
	iters: 300, epoch: 6 | loss: 0.7339055
	speed: 0.0025s/iter; left time: 3.0535s
	iters: 400, epoch: 6 | loss: 0.3003265
	speed: 0.0034s/iter; left time: 3.8489s
	iters: 500, epoch: 6 | loss: 0.4531960
	speed: 0.0036s/iter; left time: 3.7450s
Updating learning rate to 4.824253834476479e-05
Epoch: 6 cost time: 1.4844398498535156
Epoch: 6, Steps: 514 | Train Loss: 0.4589855 Vali Loss: 0.3918755 Best vali loss: 0.3674994
	iters: 100, epoch: 7 | loss: 0.7963614
	speed: 0.0086s/iter; left time: 7.9830s
	iters: 200, epoch: 7 | loss: 0.2885405
	speed: 0.0034s/iter; left time: 2.8494s
	iters: 300, epoch: 7 | loss: 0.3163273
	speed: 0.0039s/iter; left time: 2.8188s
	iters: 400, epoch: 7 | loss: 0.2782986
	speed: 0.0036s/iter; left time: 2.2412s
	iters: 500, epoch: 7 | loss: 0.3385975
	speed: 0.0035s/iter; left time: 1.8657s
Updating learning rate to 1.2537827220863625e-05
Epoch: 7 cost time: 1.8969252109527588
Epoch: 7, Steps: 514 | Train Loss: 0.4036251 Vali Loss: 0.3885230 Best vali loss: 0.3674994
	iters: 100, epoch: 8 | loss: 0.2281844
	speed: 0.0093s/iter; left time: 3.8536s
	iters: 200, epoch: 8 | loss: 0.6729978
	speed: 0.0024s/iter; left time: 0.7684s
	iters: 300, epoch: 8 | loss: 0.5166451
	speed: 0.0024s/iter; left time: 0.5117s
	iters: 400, epoch: 8 | loss: 0.2925783
	speed: 0.0026s/iter; left time: 0.2974s
	iters: 500, epoch: 8 | loss: 0.3665515
	speed: 0.0034s/iter; left time: 0.0511s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.540590763092041
Epoch: 8, Steps: 514 | Train Loss: 0.4153914 Vali Loss: 0.3903995 Best vali loss: 0.3674994

best validation loss 0.36749935974540787

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0018706532697, 'e_layers': 2, 'learning_rate': 0.0002779769506, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5714290
	speed: 0.0111s/iter; left time: 21.7851s
	iters: 200, epoch: 1 | loss: 0.3907817
	speed: 0.0052s/iter; left time: 9.5990s
Updating learning rate to 0.0002779769506
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.6868174076080322
Epoch: 1, Steps: 257 | Train Loss: 0.4811053 Vali Loss: 0.3689588 Best vali loss: 0.3689588
	iters: 100, epoch: 2 | loss: 0.5793761
	speed: 0.0125s/iter; left time: 21.2873s
	iters: 200, epoch: 2 | loss: 0.6891791
	speed: 0.0053s/iter; left time: 8.5424s
Updating learning rate to 0.0001389884753
Validation loss decreased (0.3690 --> 0.3635).  Saving model state dict ...
Epoch: 2 cost time: 1.4078819751739502
Epoch: 2, Steps: 257 | Train Loss: 0.6342776 Vali Loss: 0.3635254 Best vali loss: 0.3635254
	iters: 100, epoch: 3 | loss: 0.8477292
	speed: 0.0119s/iter; left time: 17.2136s
	iters: 200, epoch: 3 | loss: 0.7908179
	speed: 0.0047s/iter; left time: 6.3169s
Updating learning rate to 6.949423765e-05
Epoch: 3 cost time: 1.3005728721618652
Epoch: 3, Steps: 257 | Train Loss: 0.8192735 Vali Loss: 0.3698543 Best vali loss: 0.3635254
	iters: 100, epoch: 4 | loss: 0.7008986
	speed: 0.0125s/iter; left time: 14.7753s
	iters: 200, epoch: 4 | loss: 0.5229416
	speed: 0.0051s/iter; left time: 5.5178s
Updating learning rate to 3.4747118825e-05
Epoch: 4 cost time: 1.3944189548492432
Epoch: 4, Steps: 257 | Train Loss: 0.6119201 Vali Loss: 0.3686993 Best vali loss: 0.3635254
	iters: 100, epoch: 5 | loss: 0.7361062
	speed: 0.0106s/iter; left time: 9.8463s
	iters: 200, epoch: 5 | loss: 0.4910782
	speed: 0.0039s/iter; left time: 3.2110s
Updating learning rate to 1.73735594125e-05
Epoch: 5 cost time: 1.0439751148223877
Epoch: 5, Steps: 257 | Train Loss: 0.6135922 Vali Loss: 0.3689559 Best vali loss: 0.3635254
	iters: 100, epoch: 6 | loss: 0.6742944
	speed: 0.0106s/iter; left time: 7.1103s
	iters: 200, epoch: 6 | loss: 0.7009853
	speed: 0.0054s/iter; left time: 3.1094s
Updating learning rate to 8.68677970625e-06
Epoch: 6 cost time: 1.4477360248565674
Epoch: 6, Steps: 257 | Train Loss: 0.6876398 Vali Loss: 0.3700502 Best vali loss: 0.3635254
	iters: 100, epoch: 7 | loss: 0.7404645
	speed: 0.0121s/iter; left time: 5.0029s
	iters: 200, epoch: 7 | loss: 0.5740279
	speed: 0.0055s/iter; left time: 1.7251s
Updating learning rate to 4.343389853125e-06
Epoch: 7 cost time: 1.3956356048583984
Epoch: 7, Steps: 257 | Train Loss: 0.6572462 Vali Loss: 0.3692344 Best vali loss: 0.3635254
	iters: 100, epoch: 8 | loss: 0.5579319
	speed: 0.0122s/iter; left time: 1.9277s
	iters: 200, epoch: 8 | loss: 0.5658436
	speed: 0.0051s/iter; left time: 0.2959s
Updating learning rate to 2.1716949265625e-06
Epoch: 8 cost time: 1.404322862625122
Epoch: 8, Steps: 257 | Train Loss: 0.5618878 Vali Loss: 0.3693753 Best vali loss: 0.3635254

best validation loss 0.3635254372899331

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.003868950085, 'e_layers': 4, 'learning_rate': 0.0048421309082, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0530754
	speed: 0.0125s/iter; left time: 50.2275s
	iters: 200, epoch: 1 | loss: 1.0207735
	speed: 0.0072s/iter; left time: 28.1020s
	iters: 300, epoch: 1 | loss: 0.3784153
	speed: 0.0071s/iter; left time: 26.9970s
	iters: 400, epoch: 1 | loss: 0.9029925
	speed: 0.0069s/iter; left time: 25.6214s
	iters: 500, epoch: 1 | loss: 0.5822940
	speed: 0.0074s/iter; left time: 26.7276s
Updating learning rate to 0.0048421309082
Validation loss decreased (inf --> 0.4093).  Saving model state dict ...
Epoch: 1 cost time: 3.934502363204956
Epoch: 1, Steps: 514 | Train Loss: 0.7875102 Vali Loss: 0.4092526 Best vali loss: 0.4092526
	iters: 100, epoch: 2 | loss: 0.7508265
	speed: 0.0150s/iter; left time: 52.5188s
	iters: 200, epoch: 2 | loss: 0.6650366
	speed: 0.0071s/iter; left time: 24.1340s
	iters: 300, epoch: 2 | loss: 1.0549791
	speed: 0.0069s/iter; left time: 22.9062s
	iters: 400, epoch: 2 | loss: 0.8980737
	speed: 0.0067s/iter; left time: 21.5135s
	iters: 500, epoch: 2 | loss: 0.7099178
	speed: 0.0070s/iter; left time: 21.7531s
Updating learning rate to 0.0024210654541
Validation loss decreased (0.4093 --> 0.3987).  Saving model state dict ...
Epoch: 2 cost time: 3.5882108211517334
Epoch: 2, Steps: 514 | Train Loss: 0.8157667 Vali Loss: 0.3986792 Best vali loss: 0.3986792
	iters: 100, epoch: 3 | loss: 0.4230420
	speed: 0.0122s/iter; left time: 36.4659s
	iters: 200, epoch: 3 | loss: 0.8632747
	speed: 0.0050s/iter; left time: 14.2925s
	iters: 300, epoch: 3 | loss: 0.8449386
	speed: 0.0070s/iter; left time: 19.3754s
	iters: 400, epoch: 3 | loss: 0.7899913
	speed: 0.0070s/iter; left time: 18.6728s
	iters: 500, epoch: 3 | loss: 0.4494157
	speed: 0.0067s/iter; left time: 17.3540s
Updating learning rate to 0.00121053272705
Epoch: 3 cost time: 3.219080686569214
Epoch: 3, Steps: 514 | Train Loss: 0.6741324 Vali Loss: 0.4060749 Best vali loss: 0.3986792

best validation loss 0.39867923068274214

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0055086616918, 'e_layers': 1, 'learning_rate': 0.0001485575734, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001485575734
Validation loss decreased (inf --> 0.4167).  Saving model state dict ...
Epoch: 1 cost time: 0.7546262741088867
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4166608 Best vali loss: 0.4166608
Updating learning rate to 7.42787867e-05
Validation loss decreased (0.4167 --> 0.3953).  Saving model state dict ...
Epoch: 2 cost time: 0.5157909393310547
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3952654 Best vali loss: 0.3952654
Updating learning rate to 3.713939335e-05
Validation loss decreased (0.3953 --> 0.3882).  Saving model state dict ...
Epoch: 3 cost time: 0.4351191520690918
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3882189 Best vali loss: 0.3882189

best validation loss 0.38821888936057775

[INFO][smbo.py:320] Finished 50 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5883850
	speed: 0.0137s/iter; left time: 12.8032s
Updating learning rate to 0.000280255645
Validation loss decreased (inf --> 0.3946).  Saving model state dict ...
Epoch: 1 cost time: 1.3223447799682617
Epoch: 1, Steps: 129 | Train Loss: 0.5883850 Vali Loss: 0.3945815 Best vali loss: 0.3945815
	iters: 100, epoch: 2 | loss: 0.7442865
	speed: 0.0129s/iter; left time: 10.3756s
Updating learning rate to 0.0001401278225
Validation loss decreased (0.3946 --> 0.3824).  Saving model state dict ...
Epoch: 2 cost time: 1.0399415493011475
Epoch: 2, Steps: 129 | Train Loss: 0.7442865 Vali Loss: 0.3824158 Best vali loss: 0.3824158
	iters: 100, epoch: 3 | loss: 0.4717863
	speed: 0.0138s/iter; left time: 9.2857s
Updating learning rate to 7.006391125e-05
Validation loss decreased (0.3824 --> 0.3774).  Saving model state dict ...
Epoch: 3 cost time: 1.1487298011779785
Epoch: 3, Steps: 129 | Train Loss: 0.4717863 Vali Loss: 0.3774189 Best vali loss: 0.3774189

best validation loss 0.37741891523943905

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0050942959516, 'e_layers': 4, 'learning_rate': 0.000280255645, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5339301
	speed: 0.0143s/iter; left time: 7.7909s
Updating learning rate to 3.5031955625e-05
Validation loss decreased (0.3774 --> 0.3743).  Saving model state dict ...
Epoch: 4 cost time: 1.3871219158172607
Epoch: 4, Steps: 129 | Train Loss: 0.5339301 Vali Loss: 0.3743483 Best vali loss: 0.3743483
	iters: 100, epoch: 5 | loss: 0.7266656
	speed: 0.0136s/iter; left time: 5.6902s
Updating learning rate to 1.75159778125e-05
Validation loss decreased (0.3743 --> 0.3743).  Saving model state dict ...
Epoch: 5 cost time: 1.1561903953552246
Epoch: 5, Steps: 129 | Train Loss: 0.7266656 Vali Loss: 0.3742969 Best vali loss: 0.3742969
	iters: 100, epoch: 6 | loss: 0.4650819
	speed: 0.0138s/iter; left time: 3.9689s
Updating learning rate to 8.75798890625e-06
Validation loss decreased (0.3743 --> 0.3738).  Saving model state dict ...
Epoch: 6 cost time: 1.1101536750793457
Epoch: 6, Steps: 129 | Train Loss: 0.4650819 Vali Loss: 0.3737640 Best vali loss: 0.3737640
	iters: 100, epoch: 7 | loss: 0.5872651
	speed: 0.0135s/iter; left time: 2.1533s
Updating learning rate to 4.378994453125e-06
Validation loss decreased (0.3738 --> 0.3736).  Saving model state dict ...
Epoch: 7 cost time: 1.1259777545928955
Epoch: 7, Steps: 129 | Train Loss: 0.5872651 Vali Loss: 0.3735884 Best vali loss: 0.3735884
	iters: 100, epoch: 8 | loss: 0.5789853
	speed: 0.0138s/iter; left time: 0.4154s
Updating learning rate to 2.1894972265625e-06
Validation loss decreased (0.3736 --> 0.3735).  Saving model state dict ...
Epoch: 8 cost time: 1.0274958610534668
Epoch: 8, Steps: 129 | Train Loss: 0.5789853 Vali Loss: 0.3734661 Best vali loss: 0.3734661

best validation loss 0.3734660619251386

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0103849055062, 'e_layers': 3, 'learning_rate': 0.0001339657668, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8288559
	speed: 0.0114s/iter; left time: 22.2868s
	iters: 200, epoch: 1 | loss: 0.4414019
	speed: 0.0062s/iter; left time: 11.5401s
Updating learning rate to 0.0001339657668
Validation loss decreased (inf --> 0.3667).  Saving model state dict ...
Epoch: 1 cost time: 1.834263563156128
Epoch: 1, Steps: 257 | Train Loss: 0.6351289 Vali Loss: 0.3667449 Best vali loss: 0.3667449
	iters: 100, epoch: 2 | loss: 0.7183819
	speed: 0.0138s/iter; left time: 23.4756s
	iters: 200, epoch: 2 | loss: 0.5706888
	speed: 0.0059s/iter; left time: 9.4623s
Updating learning rate to 6.69828834e-05
Epoch: 2 cost time: 1.6011567115783691
Epoch: 2, Steps: 257 | Train Loss: 0.6445354 Vali Loss: 0.3678447 Best vali loss: 0.3667449
	iters: 100, epoch: 3 | loss: 0.6979241
	speed: 0.0136s/iter; left time: 19.5592s
	iters: 200, epoch: 3 | loss: 0.7754724
	speed: 0.0063s/iter; left time: 8.5034s
Updating learning rate to 3.34914417e-05
Epoch: 3 cost time: 1.6800117492675781
Epoch: 3, Steps: 257 | Train Loss: 0.7366983 Vali Loss: 0.3826639 Best vali loss: 0.3667449
	iters: 100, epoch: 4 | loss: 0.4912842
	speed: 0.0134s/iter; left time: 15.9398s
	iters: 200, epoch: 4 | loss: 0.4697499
	speed: 0.0061s/iter; left time: 6.6221s
Updating learning rate to 1.674572085e-05
Epoch: 4 cost time: 1.6287274360656738
Epoch: 4, Steps: 257 | Train Loss: 0.4805171 Vali Loss: 0.3932650 Best vali loss: 0.3667449
	iters: 100, epoch: 5 | loss: 0.7858243
	speed: 0.0136s/iter; left time: 12.6572s
	iters: 200, epoch: 5 | loss: 0.7148141
	speed: 0.0060s/iter; left time: 4.9485s
Updating learning rate to 8.372860425e-06
Epoch: 5 cost time: 1.6093974113464355
Epoch: 5, Steps: 257 | Train Loss: 0.7503192 Vali Loss: 0.3946941 Best vali loss: 0.3667449
	iters: 100, epoch: 6 | loss: 0.4973920
	speed: 0.0135s/iter; left time: 9.0743s
	iters: 200, epoch: 6 | loss: 0.7888156
	speed: 0.0064s/iter; left time: 3.6380s
Updating learning rate to 4.1864302125e-06
Epoch: 6 cost time: 1.6652591228485107
Epoch: 6, Steps: 257 | Train Loss: 0.6431038 Vali Loss: 0.3953246 Best vali loss: 0.3667449
	iters: 100, epoch: 7 | loss: 0.7146986
	speed: 0.0137s/iter; left time: 5.6955s
	iters: 200, epoch: 7 | loss: 0.4778363
	speed: 0.0061s/iter; left time: 1.9277s
Updating learning rate to 2.09321510625e-06
Epoch: 7 cost time: 1.632575511932373
Epoch: 7, Steps: 257 | Train Loss: 0.5962674 Vali Loss: 0.3959771 Best vali loss: 0.3667449
	iters: 100, epoch: 8 | loss: 0.4717759
	speed: 0.0118s/iter; left time: 1.8664s
	iters: 200, epoch: 8 | loss: 0.7273515
	speed: 0.0044s/iter; left time: 0.2542s
Updating learning rate to 1.046607553125e-06
Epoch: 8 cost time: 1.2962145805358887
Epoch: 8, Steps: 257 | Train Loss: 0.5995637 Vali Loss: 0.3953506 Best vali loss: 0.3667449

best validation loss 0.3667448693970566

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 1, 'learning_rate': 8.12571782e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6531793
	speed: 0.0092s/iter; left time: 18.0741s
	iters: 200, epoch: 1 | loss: 0.4421897
	speed: 0.0037s/iter; left time: 6.9405s
Updating learning rate to 8.12571782e-05
Validation loss decreased (inf --> 0.4052).  Saving model state dict ...
Epoch: 1 cost time: 1.2358002662658691
Epoch: 1, Steps: 257 | Train Loss: 0.5476845 Vali Loss: 0.4051535 Best vali loss: 0.4051535
	iters: 100, epoch: 2 | loss: 0.7135018
	speed: 0.0090s/iter; left time: 15.3201s
	iters: 200, epoch: 2 | loss: 0.3800556
	speed: 0.0040s/iter; left time: 6.3960s
Updating learning rate to 4.06285891e-05
Validation loss decreased (0.4052 --> 0.3860).  Saving model state dict ...
Epoch: 2 cost time: 1.0207791328430176
Epoch: 2, Steps: 257 | Train Loss: 0.5467787 Vali Loss: 0.3859728 Best vali loss: 0.3859728
	iters: 100, epoch: 3 | loss: 0.5427138
	speed: 0.0093s/iter; left time: 13.4091s
	iters: 200, epoch: 3 | loss: 0.8464321
	speed: 0.0036s/iter; left time: 4.8921s
Updating learning rate to 2.031429455e-05
Validation loss decreased (0.3860 --> 0.3797).  Saving model state dict ...
Epoch: 3 cost time: 1.0117473602294922
Epoch: 3, Steps: 257 | Train Loss: 0.6945729 Vali Loss: 0.3796633 Best vali loss: 0.3796633
	iters: 100, epoch: 4 | loss: 0.7496412
	speed: 0.0097s/iter; left time: 11.5003s
	iters: 200, epoch: 4 | loss: 0.8867303
	speed: 0.0035s/iter; left time: 3.7681s
Updating learning rate to 1.0157147275e-05
Validation loss decreased (0.3797 --> 0.3773).  Saving model state dict ...
Epoch: 4 cost time: 0.9863603115081787
Epoch: 4, Steps: 257 | Train Loss: 0.8181857 Vali Loss: 0.3772760 Best vali loss: 0.3772760
	iters: 100, epoch: 5 | loss: 0.6032257
	speed: 0.0092s/iter; left time: 8.5868s
	iters: 200, epoch: 5 | loss: 0.2907970
	speed: 0.0035s/iter; left time: 2.9195s
Updating learning rate to 5.0785736375e-06
Validation loss decreased (0.3773 --> 0.3761).  Saving model state dict ...
Epoch: 5 cost time: 1.0394632816314697
Epoch: 5, Steps: 257 | Train Loss: 0.4470114 Vali Loss: 0.3761427 Best vali loss: 0.3761427
	iters: 100, epoch: 6 | loss: 0.6163468
	speed: 0.0094s/iter; left time: 6.3444s
	iters: 200, epoch: 6 | loss: 0.6610745
	speed: 0.0036s/iter; left time: 2.0858s
Updating learning rate to 2.53928681875e-06
Validation loss decreased (0.3761 --> 0.3756).  Saving model state dict ...
Epoch: 6 cost time: 0.9864034652709961
Epoch: 6, Steps: 257 | Train Loss: 0.6387106 Vali Loss: 0.3755753 Best vali loss: 0.3755753
	iters: 100, epoch: 7 | loss: 0.7646824
	speed: 0.0091s/iter; left time: 3.7663s
	iters: 200, epoch: 7 | loss: 0.6844441
	speed: 0.0038s/iter; left time: 1.1918s
Updating learning rate to 1.269643409375e-06
Validation loss decreased (0.3756 --> 0.3753).  Saving model state dict ...
Epoch: 7 cost time: 1.0134849548339844
Epoch: 7, Steps: 257 | Train Loss: 0.7245632 Vali Loss: 0.3753241 Best vali loss: 0.3753241
	iters: 100, epoch: 8 | loss: 0.5360253
	speed: 0.0093s/iter; left time: 1.4766s
	iters: 200, epoch: 8 | loss: 0.7995794
	speed: 0.0036s/iter; left time: 0.2076s
Updating learning rate to 6.348217046875e-07
Validation loss decreased (0.3753 --> 0.3752).  Saving model state dict ...
Epoch: 8 cost time: 0.9457955360412598
Epoch: 8, Steps: 257 | Train Loss: 0.6678024 Vali Loss: 0.3751972 Best vali loss: 0.3751972

best validation loss 0.37519722991935867

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 4, 'learning_rate': 0.0044405212972, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4626904
	speed: 0.0117s/iter; left time: 47.1282s
	iters: 200, epoch: 1 | loss: 0.7180849
	speed: 0.0070s/iter; left time: 27.2988s
	iters: 300, epoch: 1 | loss: 1.3460205
	speed: 0.0066s/iter; left time: 25.1867s
	iters: 400, epoch: 1 | loss: 0.7441911
	speed: 0.0052s/iter; left time: 19.3005s
	iters: 500, epoch: 1 | loss: 0.8212720
	speed: 0.0061s/iter; left time: 22.0352s
Updating learning rate to 0.0044405212972
Validation loss decreased (inf --> 0.4062).  Saving model state dict ...
Epoch: 1 cost time: 3.5252082347869873
Epoch: 1, Steps: 514 | Train Loss: 0.8184518 Vali Loss: 0.4062369 Best vali loss: 0.4062369
	iters: 100, epoch: 2 | loss: 0.7847904
	speed: 0.0146s/iter; left time: 51.0518s
	iters: 200, epoch: 2 | loss: 0.7298195
	speed: 0.0076s/iter; left time: 25.7291s
	iters: 300, epoch: 2 | loss: 0.6933530
	speed: 0.0074s/iter; left time: 24.5315s
	iters: 400, epoch: 2 | loss: 0.9340209
	speed: 0.0074s/iter; left time: 23.5948s
	iters: 500, epoch: 2 | loss: 0.4624413
	speed: 0.0047s/iter; left time: 14.6800s
Updating learning rate to 0.0022202606486
Validation loss decreased (0.4062 --> 0.4023).  Saving model state dict ...
Epoch: 2 cost time: 3.534327983856201
Epoch: 2, Steps: 514 | Train Loss: 0.7208850 Vali Loss: 0.4023358 Best vali loss: 0.4023358
	iters: 100, epoch: 3 | loss: 0.6789380
	speed: 0.0136s/iter; left time: 40.4703s
	iters: 200, epoch: 3 | loss: 0.8495986
	speed: 0.0073s/iter; left time: 20.9882s
	iters: 300, epoch: 3 | loss: 1.1336247
	speed: 0.0073s/iter; left time: 20.2578s
	iters: 400, epoch: 3 | loss: 1.0975356
	speed: 0.0074s/iter; left time: 19.9258s
	iters: 500, epoch: 3 | loss: 0.9211435
	speed: 0.0072s/iter; left time: 18.7312s
Updating learning rate to 0.0011101303243
Epoch: 3 cost time: 3.8640902042388916
Epoch: 3, Steps: 514 | Train Loss: 0.9361681 Vali Loss: 0.4072989 Best vali loss: 0.4023358

best validation loss 0.4023357911873426

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0065630235844, 'e_layers': 1, 'learning_rate': 0.0011205641286, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6698834
	speed: 0.0110s/iter; left time: 10.2558s
Updating learning rate to 0.0011205641286
Validation loss decreased (inf --> 0.3702).  Saving model state dict ...
Epoch: 1 cost time: 0.9912350177764893
Epoch: 1, Steps: 129 | Train Loss: 0.6698834 Vali Loss: 0.3702381 Best vali loss: 0.3702381
	iters: 100, epoch: 2 | loss: 0.5911899
	speed: 0.0067s/iter; left time: 5.4058s
Updating learning rate to 0.0005602820643
Validation loss decreased (0.3702 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 0.45845913887023926
Epoch: 2, Steps: 129 | Train Loss: 0.5911899 Vali Loss: 0.3660107 Best vali loss: 0.3660107
	iters: 100, epoch: 3 | loss: 0.7159843
	speed: 0.0075s/iter; left time: 5.0652s
Updating learning rate to 0.00028014103215
Epoch: 3 cost time: 0.6782159805297852
Epoch: 3, Steps: 129 | Train Loss: 0.7159843 Vali Loss: 0.3693690 Best vali loss: 0.3660107

best validation loss 0.3660106759877008

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2741672
	speed: 0.0096s/iter; left time: 38.4818s
	iters: 200, epoch: 1 | loss: 0.8053100
	speed: 0.0035s/iter; left time: 13.5907s
	iters: 300, epoch: 1 | loss: 0.6333768
	speed: 0.0035s/iter; left time: 13.4336s
	iters: 400, epoch: 1 | loss: 0.3709037
	speed: 0.0035s/iter; left time: 12.9206s
	iters: 500, epoch: 1 | loss: 0.6785799
	speed: 0.0036s/iter; left time: 12.9474s
Updating learning rate to 0.0012523603238
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 2.129549980163574
Epoch: 1, Steps: 514 | Train Loss: 0.5524675 Vali Loss: 0.3672255 Best vali loss: 0.3672255
	iters: 100, epoch: 2 | loss: 0.5034736
	speed: 0.0088s/iter; left time: 30.7175s
	iters: 200, epoch: 2 | loss: 1.3427680
	speed: 0.0037s/iter; left time: 12.5064s
	iters: 300, epoch: 2 | loss: 0.8667800
	speed: 0.0035s/iter; left time: 11.6279s
	iters: 400, epoch: 2 | loss: 0.6941574
	speed: 0.0033s/iter; left time: 10.7019s
	iters: 500, epoch: 2 | loss: 0.8391024
	speed: 0.0038s/iter; left time: 11.6980s
Updating learning rate to 0.0006261801619
Validation loss decreased (0.3672 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 1.8837049007415771
Epoch: 2, Steps: 514 | Train Loss: 0.8492563 Vali Loss: 0.3636495 Best vali loss: 0.3636495
	iters: 100, epoch: 3 | loss: 1.2680072
	speed: 0.0093s/iter; left time: 27.6339s
	iters: 200, epoch: 3 | loss: 0.2880032
	speed: 0.0037s/iter; left time: 10.5600s
	iters: 300, epoch: 3 | loss: 1.2855639
	speed: 0.0040s/iter; left time: 11.0308s
	iters: 400, epoch: 3 | loss: 0.8445731
	speed: 0.0038s/iter; left time: 10.1502s
	iters: 500, epoch: 3 | loss: 0.5654079
	speed: 0.0037s/iter; left time: 9.5541s
Updating learning rate to 0.00031309008095
Epoch: 3 cost time: 1.964123249053955
Epoch: 3, Steps: 514 | Train Loss: 0.8503111 Vali Loss: 0.3648582 Best vali loss: 0.3636495

best validation loss 0.36364952515525295

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009058722761, 'e_layers': 1, 'learning_rate': 0.0012523603238, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2452787
	speed: 0.0092s/iter; left time: 22.7679s
	iters: 200, epoch: 4 | loss: 0.7693775
	speed: 0.0035s/iter; left time: 8.2835s
	iters: 300, epoch: 4 | loss: 0.4934832
	speed: 0.0039s/iter; left time: 8.8648s
	iters: 400, epoch: 4 | loss: 0.3568641
	speed: 0.0035s/iter; left time: 7.6211s
	iters: 500, epoch: 4 | loss: 0.5894867
	speed: 0.0035s/iter; left time: 7.2352s
Updating learning rate to 0.000156545040475
Epoch: 4 cost time: 2.153595209121704
Epoch: 4, Steps: 514 | Train Loss: 0.4908980 Vali Loss: 0.3682601 Best vali loss: 0.3636495
	iters: 100, epoch: 5 | loss: 0.5026993
	speed: 0.0091s/iter; left time: 17.7316s
	iters: 200, epoch: 5 | loss: 1.2529953
	speed: 0.0036s/iter; left time: 6.6571s
	iters: 300, epoch: 5 | loss: 0.8237701
	speed: 0.0034s/iter; left time: 5.9084s
	iters: 400, epoch: 5 | loss: 0.6945348
	speed: 0.0038s/iter; left time: 6.2263s
	iters: 500, epoch: 5 | loss: 0.6349218
	speed: 0.0037s/iter; left time: 5.8168s
Updating learning rate to 7.82725202375e-05
Epoch: 5 cost time: 1.9014527797698975
Epoch: 5, Steps: 514 | Train Loss: 0.7817842 Vali Loss: 0.3695536 Best vali loss: 0.3636495
	iters: 100, epoch: 6 | loss: 1.1246341
	speed: 0.0093s/iter; left time: 13.4680s
	iters: 200, epoch: 6 | loss: 0.2891332
	speed: 0.0036s/iter; left time: 4.8342s
	iters: 300, epoch: 6 | loss: 1.1740123
	speed: 0.0037s/iter; left time: 4.5787s
	iters: 400, epoch: 6 | loss: 0.8057103
	speed: 0.0032s/iter; left time: 3.7095s
	iters: 500, epoch: 6 | loss: 0.5726145
	speed: 0.0030s/iter; left time: 3.1245s
Updating learning rate to 3.913626011875e-05
Epoch: 6 cost time: 1.7949049472808838
Epoch: 6, Steps: 514 | Train Loss: 0.7932209 Vali Loss: 0.3711204 Best vali loss: 0.3636495
	iters: 100, epoch: 7 | loss: 0.2969731
	speed: 0.0066s/iter; left time: 6.1149s
	iters: 200, epoch: 7 | loss: 0.2939810
	speed: 0.0031s/iter; left time: 2.5290s
	iters: 300, epoch: 7 | loss: 0.4353660
	speed: 0.0036s/iter; left time: 2.6115s
	iters: 400, epoch: 7 | loss: 0.5772840
	speed: 0.0039s/iter; left time: 2.4845s
	iters: 500, epoch: 7 | loss: 0.3148163
	speed: 0.0032s/iter; left time: 1.7044s
Updating learning rate to 1.9568130059375e-05
Epoch: 7 cost time: 1.742271900177002
Epoch: 7, Steps: 514 | Train Loss: 0.3836841 Vali Loss: 0.3726864 Best vali loss: 0.3636495
	iters: 100, epoch: 8 | loss: 0.6436383
	speed: 0.0093s/iter; left time: 3.8589s
	iters: 200, epoch: 8 | loss: 1.0809067
	speed: 0.0037s/iter; left time: 1.1645s
	iters: 300, epoch: 8 | loss: 0.5487865
	speed: 0.0034s/iter; left time: 0.7353s
	iters: 400, epoch: 8 | loss: 0.7467718
	speed: 0.0034s/iter; left time: 0.3962s
	iters: 500, epoch: 8 | loss: 0.7328490
	speed: 0.0038s/iter; left time: 0.0573s
Updating learning rate to 9.7840650296875e-06
Epoch: 8 cost time: 1.8844468593597412
Epoch: 8, Steps: 514 | Train Loss: 0.7505905 Vali Loss: 0.3728229 Best vali loss: 0.3636495

best validation loss 0.36364952515525295

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0054864235978, 'e_layers': 2, 'learning_rate': 0.0004151106276, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5301326
	speed: 0.0098s/iter; left time: 79.6659s
	iters: 200, epoch: 1 | loss: 0.4180470
	speed: 0.0040s/iter; left time: 32.0523s
	iters: 300, epoch: 1 | loss: 0.7165777
	speed: 0.0038s/iter; left time: 30.4337s
	iters: 400, epoch: 1 | loss: 0.2871627
	speed: 0.0036s/iter; left time: 28.5105s
	iters: 500, epoch: 1 | loss: 0.9146149
	speed: 0.0039s/iter; left time: 29.7762s
	iters: 600, epoch: 1 | loss: 0.6754029
	speed: 0.0040s/iter; left time: 30.3269s
	iters: 700, epoch: 1 | loss: 0.1718548
	speed: 0.0038s/iter; left time: 28.5390s
	iters: 800, epoch: 1 | loss: 0.7571210
	speed: 0.0038s/iter; left time: 28.0517s
	iters: 900, epoch: 1 | loss: 0.3375502
	speed: 0.0039s/iter; left time: 28.6544s
	iters: 1000, epoch: 1 | loss: 1.3005253
	speed: 0.0038s/iter; left time: 27.5560s
Updating learning rate to 0.0004151106276
Validation loss decreased (inf --> 0.3765).  Saving model state dict ...
Epoch: 1 cost time: 4.26010274887085
Epoch: 1, Steps: 1027 | Train Loss: 0.6108989 Vali Loss: 0.3764653 Best vali loss: 0.3764653
	iters: 100, epoch: 2 | loss: 0.3466097
	speed: 0.0126s/iter; left time: 89.5785s
	iters: 200, epoch: 2 | loss: 0.2458636
	speed: 0.0034s/iter; left time: 23.4380s
	iters: 300, epoch: 2 | loss: 1.7885171
	speed: 0.0034s/iter; left time: 23.4789s
	iters: 400, epoch: 2 | loss: 1.0302646
	speed: 0.0053s/iter; left time: 36.0265s
	iters: 500, epoch: 2 | loss: 1.1654333
	speed: 0.0061s/iter; left time: 41.0001s
	iters: 600, epoch: 2 | loss: 0.7348933
	speed: 0.0063s/iter; left time: 41.2138s
	iters: 700, epoch: 2 | loss: 0.4921664
	speed: 0.0064s/iter; left time: 41.7694s
	iters: 800, epoch: 2 | loss: 0.7793359
	speed: 0.0064s/iter; left time: 40.7868s
	iters: 900, epoch: 2 | loss: 0.2373249
	speed: 0.0055s/iter; left time: 34.5637s
	iters: 1000, epoch: 2 | loss: 0.3272634
	speed: 0.0038s/iter; left time: 23.5059s
Updating learning rate to 0.0002075553138
Validation loss decreased (0.3765 --> 0.3760).  Saving model state dict ...
Epoch: 2 cost time: 5.164362907409668
Epoch: 2, Steps: 1027 | Train Loss: 0.7147672 Vali Loss: 0.3760287 Best vali loss: 0.3760287
	iters: 100, epoch: 3 | loss: 0.4825899
	speed: 0.0170s/iter; left time: 103.0081s
	iters: 200, epoch: 3 | loss: 0.2931256
	speed: 0.0053s/iter; left time: 31.7624s
	iters: 300, epoch: 3 | loss: 0.2414007
	speed: 0.0053s/iter; left time: 30.8997s
	iters: 400, epoch: 3 | loss: 0.4242122
	speed: 0.0053s/iter; left time: 30.5055s
	iters: 500, epoch: 3 | loss: 1.0419812
	speed: 0.0040s/iter; left time: 22.5814s
	iters: 600, epoch: 3 | loss: 0.9210929
	speed: 0.0034s/iter; left time: 18.9869s
	iters: 700, epoch: 3 | loss: 0.2581460
	speed: 0.0058s/iter; left time: 31.6886s
	iters: 800, epoch: 3 | loss: 0.4138616
	speed: 0.0059s/iter; left time: 31.6805s
	iters: 900, epoch: 3 | loss: 0.7937434
	speed: 0.0057s/iter; left time: 29.8614s
	iters: 1000, epoch: 3 | loss: 0.5087081
	speed: 0.0055s/iter; left time: 28.5530s
Updating learning rate to 0.0001037776569
Epoch: 3 cost time: 5.352071046829224
Epoch: 3, Steps: 1027 | Train Loss: 0.5378862 Vali Loss: 0.3855379 Best vali loss: 0.3760287
	iters: 100, epoch: 4 | loss: 0.2839282
	speed: 0.0154s/iter; left time: 77.3768s
	iters: 200, epoch: 4 | loss: 0.3667979
	speed: 0.0030s/iter; left time: 15.0276s
	iters: 300, epoch: 4 | loss: 0.2551000
	speed: 0.0030s/iter; left time: 14.4439s
	iters: 400, epoch: 4 | loss: 0.2847001
	speed: 0.0032s/iter; left time: 14.9622s
	iters: 500, epoch: 4 | loss: 0.2712222
	speed: 0.0040s/iter; left time: 18.5228s
	iters: 600, epoch: 4 | loss: 0.3426622
	speed: 0.0035s/iter; left time: 15.8455s
	iters: 700, epoch: 4 | loss: 0.5791367
	speed: 0.0040s/iter; left time: 17.8817s
	iters: 800, epoch: 4 | loss: 0.5064995
	speed: 0.0034s/iter; left time: 14.5433s
	iters: 900, epoch: 4 | loss: 0.3936474
	speed: 0.0040s/iter; left time: 17.0926s
	iters: 1000, epoch: 4 | loss: 0.7860591
	speed: 0.0031s/iter; left time: 12.7931s
Updating learning rate to 5.188882845e-05
Epoch: 4 cost time: 3.598116159439087
Epoch: 4, Steps: 1027 | Train Loss: 0.4069753 Vali Loss: 0.3837079 Best vali loss: 0.3760287
	iters: 100, epoch: 5 | loss: 0.4595915
	speed: 0.0099s/iter; left time: 39.8823s
	iters: 200, epoch: 5 | loss: 0.4803152
	speed: 0.0038s/iter; left time: 14.9906s
	iters: 300, epoch: 5 | loss: 0.9132821
	speed: 0.0038s/iter; left time: 14.3438s
	iters: 400, epoch: 5 | loss: 0.7498216
	speed: 0.0039s/iter; left time: 14.3251s
	iters: 500, epoch: 5 | loss: 0.9021416
	speed: 0.0036s/iter; left time: 13.0971s
	iters: 600, epoch: 5 | loss: 0.7919124
	speed: 0.0035s/iter; left time: 12.2461s
	iters: 700, epoch: 5 | loss: 0.4241062
	speed: 0.0039s/iter; left time: 13.2322s
	iters: 800, epoch: 5 | loss: 0.2594057
	speed: 0.0037s/iter; left time: 12.2634s
	iters: 900, epoch: 5 | loss: 0.6153988
	speed: 0.0036s/iter; left time: 11.6253s
	iters: 1000, epoch: 5 | loss: 0.8038557
	speed: 0.0036s/iter; left time: 11.2133s
Updating learning rate to 2.5944414225e-05
Epoch: 5 cost time: 3.8595852851867676
Epoch: 5, Steps: 1027 | Train Loss: 0.6399831 Vali Loss: 0.3950260 Best vali loss: 0.3760287
	iters: 100, epoch: 6 | loss: 0.8212482
	speed: 0.0121s/iter; left time: 36.2105s
	iters: 200, epoch: 6 | loss: 0.6060145
	speed: 0.0041s/iter; left time: 11.7062s
	iters: 300, epoch: 6 | loss: 0.3479878
	speed: 0.0041s/iter; left time: 11.3092s
	iters: 400, epoch: 6 | loss: 0.2152884
	speed: 0.0039s/iter; left time: 10.4791s
	iters: 500, epoch: 6 | loss: 0.6313205
	speed: 0.0035s/iter; left time: 9.0064s
	iters: 600, epoch: 6 | loss: 0.2703547
	speed: 0.0036s/iter; left time: 8.8398s
	iters: 700, epoch: 6 | loss: 0.5011699
	speed: 0.0038s/iter; left time: 8.9662s
	iters: 800, epoch: 6 | loss: 0.3059978
	speed: 0.0038s/iter; left time: 8.6176s
	iters: 900, epoch: 6 | loss: 0.3498401
	speed: 0.0038s/iter; left time: 8.3124s
	iters: 1000, epoch: 6 | loss: 0.3981204
	speed: 0.0037s/iter; left time: 7.6688s
Updating learning rate to 1.29722071125e-05
Epoch: 6 cost time: 3.9679832458496094
Epoch: 6, Steps: 1027 | Train Loss: 0.4447342 Vali Loss: 0.4030277 Best vali loss: 0.3760287
	iters: 100, epoch: 7 | loss: 0.7132727
	speed: 0.0120s/iter; left time: 23.5065s
	iters: 200, epoch: 7 | loss: 0.3380977
	speed: 0.0036s/iter; left time: 6.6549s
	iters: 300, epoch: 7 | loss: 0.4400323
	speed: 0.0040s/iter; left time: 7.0926s
	iters: 400, epoch: 7 | loss: 0.2594769
	speed: 0.0034s/iter; left time: 5.6782s
	iters: 500, epoch: 7 | loss: 0.7094954
	speed: 0.0033s/iter; left time: 5.0858s
	iters: 600, epoch: 7 | loss: 0.3897699
	speed: 0.0035s/iter; left time: 5.0744s
	iters: 700, epoch: 7 | loss: 1.6187750
	speed: 0.0045s/iter; left time: 6.0655s
	iters: 800, epoch: 7 | loss: 0.7244637
	speed: 0.0045s/iter; left time: 5.5919s
	iters: 900, epoch: 7 | loss: 0.2086326
	speed: 0.0045s/iter; left time: 5.1760s
	iters: 1000, epoch: 7 | loss: 0.2978450
	speed: 0.0045s/iter; left time: 4.7389s
Updating learning rate to 6.48610355625e-06
Epoch: 7 cost time: 4.167083740234375
Epoch: 7, Steps: 1027 | Train Loss: 0.5699861 Vali Loss: 0.4002005 Best vali loss: 0.3760287
	iters: 100, epoch: 8 | loss: 0.1822302
	speed: 0.0143s/iter; left time: 13.2375s
	iters: 200, epoch: 8 | loss: 0.2665128
	speed: 0.0045s/iter; left time: 3.7432s
	iters: 300, epoch: 8 | loss: 0.2899705
	speed: 0.0045s/iter; left time: 3.2971s
	iters: 400, epoch: 8 | loss: 0.1998803
	speed: 0.0042s/iter; left time: 2.6541s
	iters: 500, epoch: 8 | loss: 0.2429233
	speed: 0.0041s/iter; left time: 2.1825s
	iters: 600, epoch: 8 | loss: 1.0040686
	speed: 0.0047s/iter; left time: 1.9939s
	iters: 700, epoch: 8 | loss: 0.4080644
	speed: 0.0046s/iter; left time: 1.5206s
	iters: 800, epoch: 8 | loss: 0.5790008
	speed: 0.0046s/iter; left time: 1.0482s
	iters: 900, epoch: 8 | loss: 0.3374822
	speed: 0.0047s/iter; left time: 0.6013s
	iters: 1000, epoch: 8 | loss: 0.3774130
	speed: 0.0047s/iter; left time: 0.1313s
Updating learning rate to 3.243051778125e-06
Epoch: 8 cost time: 4.684767007827759
Epoch: 8, Steps: 1027 | Train Loss: 0.3887546 Vali Loss: 0.4030947 Best vali loss: 0.3760287

best validation loss 0.37602866691315806

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0110950398132, 'e_layers': 2, 'learning_rate': 6.89350093e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.9014179
	speed: 0.0100s/iter; left time: 81.5699s
	iters: 200, epoch: 1 | loss: 0.4689494
	speed: 0.0041s/iter; left time: 32.8726s
	iters: 300, epoch: 1 | loss: 0.2975619
	speed: 0.0042s/iter; left time: 33.5391s
	iters: 400, epoch: 1 | loss: 1.3002354
	speed: 0.0045s/iter; left time: 35.1973s
	iters: 500, epoch: 1 | loss: 0.2597705
	speed: 0.0047s/iter; left time: 35.9129s
	iters: 600, epoch: 1 | loss: 0.3287959
	speed: 0.0042s/iter; left time: 31.9911s
	iters: 700, epoch: 1 | loss: 0.4474066
	speed: 0.0043s/iter; left time: 32.5752s
	iters: 800, epoch: 1 | loss: 0.5934463
	speed: 0.0046s/iter; left time: 34.3578s
	iters: 900, epoch: 1 | loss: 1.9942493
	speed: 0.0046s/iter; left time: 33.8681s
	iters: 1000, epoch: 1 | loss: 0.7791952
	speed: 0.0043s/iter; left time: 30.8433s
Updating learning rate to 6.89350093e-05
Validation loss decreased (inf --> 0.4014).  Saving model state dict ...
Epoch: 1 cost time: 4.8098649978637695
Epoch: 1, Steps: 1027 | Train Loss: 0.8371028 Vali Loss: 0.4014011 Best vali loss: 0.4014011
	iters: 100, epoch: 2 | loss: 0.3238855
	speed: 0.0137s/iter; left time: 96.9356s
	iters: 200, epoch: 2 | loss: 0.3024031
	speed: 0.0043s/iter; left time: 29.8519s
	iters: 300, epoch: 2 | loss: 0.3176836
	speed: 0.0042s/iter; left time: 28.7446s
	iters: 400, epoch: 2 | loss: 0.5701150
	speed: 0.0042s/iter; left time: 28.6852s
	iters: 500, epoch: 2 | loss: 1.1507250
	speed: 0.0045s/iter; left time: 29.8709s
	iters: 600, epoch: 2 | loss: 1.0105882
	speed: 0.0045s/iter; left time: 29.3782s
	iters: 700, epoch: 2 | loss: 0.1780438
	speed: 0.0045s/iter; left time: 29.1184s
	iters: 800, epoch: 2 | loss: 0.3518046
	speed: 0.0045s/iter; left time: 28.8217s
	iters: 900, epoch: 2 | loss: 1.0883269
	speed: 0.0045s/iter; left time: 28.2278s
	iters: 1000, epoch: 2 | loss: 1.2791345
	speed: 0.0045s/iter; left time: 27.7676s
Updating learning rate to 3.446750465e-05
Validation loss decreased (0.4014 --> 0.3817).  Saving model state dict ...
Epoch: 2 cost time: 4.541749954223633
Epoch: 2, Steps: 1027 | Train Loss: 0.6572710 Vali Loss: 0.3816619 Best vali loss: 0.3816619
	iters: 100, epoch: 3 | loss: 0.7573805
	speed: 0.0130s/iter; left time: 79.1123s
	iters: 200, epoch: 3 | loss: 0.9434662
	speed: 0.0044s/iter; left time: 26.3950s
	iters: 300, epoch: 3 | loss: 0.4908536
	speed: 0.0044s/iter; left time: 25.7588s
	iters: 400, epoch: 3 | loss: 0.3615046
	speed: 0.0046s/iter; left time: 26.5298s
	iters: 500, epoch: 3 | loss: 0.5968053
	speed: 0.0042s/iter; left time: 23.7905s
	iters: 600, epoch: 3 | loss: 0.7896298
	speed: 0.0041s/iter; left time: 23.0166s
	iters: 700, epoch: 3 | loss: 0.3891562
	speed: 0.0043s/iter; left time: 23.2217s
	iters: 800, epoch: 3 | loss: 1.0311347
	speed: 0.0040s/iter; left time: 21.6919s
	iters: 900, epoch: 3 | loss: 0.2332916
	speed: 0.0042s/iter; left time: 22.0276s
	iters: 1000, epoch: 3 | loss: 0.3569332
	speed: 0.0041s/iter; left time: 21.0196s
Updating learning rate to 1.7233752325e-05
Validation loss decreased (0.3817 --> 0.3764).  Saving model state dict ...
Epoch: 3 cost time: 4.44426417350769
Epoch: 3, Steps: 1027 | Train Loss: 0.5950156 Vali Loss: 0.3764116 Best vali loss: 0.3764116
	iters: 100, epoch: 4 | loss: 1.2880220
	speed: 0.0126s/iter; left time: 63.3243s
	iters: 200, epoch: 4 | loss: 0.4299869
	speed: 0.0041s/iter; left time: 20.3192s
	iters: 300, epoch: 4 | loss: 0.3963694
	speed: 0.0041s/iter; left time: 19.7103s
	iters: 400, epoch: 4 | loss: 0.5317436
	speed: 0.0041s/iter; left time: 19.1877s
	iters: 500, epoch: 4 | loss: 0.4568851
	speed: 0.0041s/iter; left time: 19.1481s
	iters: 600, epoch: 4 | loss: 0.3405222
	speed: 0.0041s/iter; left time: 18.5175s
	iters: 700, epoch: 4 | loss: 2.0393794
	speed: 0.0041s/iter; left time: 18.3112s
	iters: 800, epoch: 4 | loss: 0.2594257
	speed: 0.0042s/iter; left time: 18.3585s
	iters: 900, epoch: 4 | loss: 0.7720125
	speed: 0.0041s/iter; left time: 17.3077s
	iters: 1000, epoch: 4 | loss: 0.4996543
	speed: 0.0040s/iter; left time: 16.5119s
Updating learning rate to 8.6168761625e-06
Validation loss decreased (0.3764 --> 0.3745).  Saving model state dict ...
Epoch: 4 cost time: 4.234544277191162
Epoch: 4, Steps: 1027 | Train Loss: 0.7014001 Vali Loss: 0.3744531 Best vali loss: 0.3744531
	iters: 100, epoch: 5 | loss: 0.3271376
	speed: 0.0137s/iter; left time: 54.7804s
	iters: 200, epoch: 5 | loss: 0.6258717
	speed: 0.0044s/iter; left time: 17.2388s
	iters: 300, epoch: 5 | loss: 1.0759034
	speed: 0.0044s/iter; left time: 16.6720s
	iters: 400, epoch: 5 | loss: 0.4114005
	speed: 0.0044s/iter; left time: 16.4130s
	iters: 500, epoch: 5 | loss: 1.0933108
	speed: 0.0044s/iter; left time: 15.8596s
	iters: 600, epoch: 5 | loss: 0.4943643
	speed: 0.0045s/iter; left time: 15.7312s
	iters: 700, epoch: 5 | loss: 0.5815957
	speed: 0.0044s/iter; left time: 15.0301s
	iters: 800, epoch: 5 | loss: 0.2634765
	speed: 0.0041s/iter; left time: 13.4883s
	iters: 900, epoch: 5 | loss: 0.9513896
	speed: 0.0036s/iter; left time: 11.5250s
	iters: 1000, epoch: 5 | loss: 0.9183129
	speed: 0.0037s/iter; left time: 11.5732s
Updating learning rate to 4.30843808125e-06
Validation loss decreased (0.3745 --> 0.3735).  Saving model state dict ...
Epoch: 5 cost time: 4.3875837326049805
Epoch: 5, Steps: 1027 | Train Loss: 0.6742763 Vali Loss: 0.3735059 Best vali loss: 0.3735059
	iters: 100, epoch: 6 | loss: 0.2872109
	speed: 0.0136s/iter; left time: 40.7006s
	iters: 200, epoch: 6 | loss: 0.2538311
	speed: 0.0041s/iter; left time: 11.6746s
	iters: 300, epoch: 6 | loss: 0.3664609
	speed: 0.0041s/iter; left time: 11.4262s
	iters: 400, epoch: 6 | loss: 0.9046010
	speed: 0.0042s/iter; left time: 11.1529s
	iters: 500, epoch: 6 | loss: 0.3750379
	speed: 0.0041s/iter; left time: 10.4812s
	iters: 600, epoch: 6 | loss: 0.7217267
	speed: 0.0041s/iter; left time: 10.2249s
	iters: 700, epoch: 6 | loss: 0.3392204
	speed: 0.0042s/iter; left time: 10.0011s
	iters: 800, epoch: 6 | loss: 0.3781672
	speed: 0.0038s/iter; left time: 8.7383s
	iters: 900, epoch: 6 | loss: 0.9575027
	speed: 0.0034s/iter; left time: 7.3476s
	iters: 1000, epoch: 6 | loss: 0.3017126
	speed: 0.0029s/iter; left time: 6.1244s
Updating learning rate to 2.154219040625e-06
Validation loss decreased (0.3735 --> 0.3731).  Saving model state dict ...
Epoch: 6 cost time: 4.018786430358887
Epoch: 6, Steps: 1027 | Train Loss: 0.4885471 Vali Loss: 0.3730758 Best vali loss: 0.3730758
	iters: 100, epoch: 7 | loss: 0.9070683
	speed: 0.0117s/iter; left time: 22.9415s
	iters: 200, epoch: 7 | loss: 1.0415761
	speed: 0.0041s/iter; left time: 7.6364s
	iters: 300, epoch: 7 | loss: 1.2115818
	speed: 0.0042s/iter; left time: 7.2870s
	iters: 400, epoch: 7 | loss: 0.6653162
	speed: 0.0041s/iter; left time: 6.7193s
	iters: 500, epoch: 7 | loss: 0.2522137
	speed: 0.0042s/iter; left time: 6.4963s
	iters: 600, epoch: 7 | loss: 0.3919451
	speed: 0.0041s/iter; left time: 5.9959s
	iters: 700, epoch: 7 | loss: 0.7954778
	speed: 0.0042s/iter; left time: 5.6507s
	iters: 800, epoch: 7 | loss: 0.2404069
	speed: 0.0041s/iter; left time: 5.1835s
	iters: 900, epoch: 7 | loss: 0.4435699
	speed: 0.0040s/iter; left time: 4.5831s
	iters: 1000, epoch: 7 | loss: 1.1506063
	speed: 0.0040s/iter; left time: 4.2178s
Updating learning rate to 1.0771095203125e-06
Validation loss decreased (0.3731 --> 0.3729).  Saving model state dict ...
Epoch: 7 cost time: 4.271993637084961
Epoch: 7, Steps: 1027 | Train Loss: 0.7099762 Vali Loss: 0.3728614 Best vali loss: 0.3728614
	iters: 100, epoch: 8 | loss: 1.2340311
	speed: 0.0129s/iter; left time: 12.0165s
	iters: 200, epoch: 8 | loss: 0.3943516
	speed: 0.0043s/iter; left time: 3.5298s
	iters: 300, epoch: 8 | loss: 0.9493433
	speed: 0.0041s/iter; left time: 2.9767s
	iters: 400, epoch: 8 | loss: 0.6920303
	speed: 0.0040s/iter; left time: 2.4895s
	iters: 500, epoch: 8 | loss: 0.8837016
	speed: 0.0040s/iter; left time: 2.1321s
	iters: 600, epoch: 8 | loss: 0.4074333
	speed: 0.0040s/iter; left time: 1.6970s
	iters: 700, epoch: 8 | loss: 1.1081464
	speed: 0.0041s/iter; left time: 1.3438s
	iters: 800, epoch: 8 | loss: 0.3305808
	speed: 0.0040s/iter; left time: 0.9029s
	iters: 900, epoch: 8 | loss: 1.3081526
	speed: 0.0041s/iter; left time: 0.5287s
	iters: 1000, epoch: 8 | loss: 0.3173450
	speed: 0.0041s/iter; left time: 0.1155s
Updating learning rate to 5.3855476015625e-07
Validation loss decreased (0.3729 --> 0.3728).  Saving model state dict ...
Epoch: 8 cost time: 4.250317573547363
Epoch: 8, Steps: 1027 | Train Loss: 0.7625116 Vali Loss: 0.3727571 Best vali loss: 0.3727571

best validation loss 0.3727570605769841

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.010989339883, 'e_layers': 4, 'learning_rate': 0.0039398051864, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6938074
	speed: 0.0133s/iter; left time: 12.4033s
Updating learning rate to 0.0039398051864
Validation loss decreased (inf --> 0.3972).  Saving model state dict ...
Epoch: 1 cost time: 1.2655370235443115
Epoch: 1, Steps: 129 | Train Loss: 0.6938074 Vali Loss: 0.3971701 Best vali loss: 0.3971701
	iters: 100, epoch: 2 | loss: 0.8684182
	speed: 0.0128s/iter; left time: 10.3025s
Updating learning rate to 0.0019699025932
Epoch: 2 cost time: 1.022822380065918
Epoch: 2, Steps: 129 | Train Loss: 0.8684182 Vali Loss: 0.4041235 Best vali loss: 0.3971701
	iters: 100, epoch: 3 | loss: 0.5651045
	speed: 0.0132s/iter; left time: 8.8930s
Updating learning rate to 0.0009849512966
Epoch: 3 cost time: 1.0735173225402832
Epoch: 3, Steps: 129 | Train Loss: 0.5651045 Vali Loss: 0.4021664 Best vali loss: 0.3971701

best validation loss 0.3971700550296686

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3494675
	speed: 0.0116s/iter; left time: 46.3889s
	iters: 200, epoch: 1 | loss: 0.5890211
	speed: 0.0055s/iter; left time: 21.7091s
	iters: 300, epoch: 1 | loss: 0.3003992
	speed: 0.0054s/iter; left time: 20.6112s
	iters: 400, epoch: 1 | loss: 0.4491776
	speed: 0.0053s/iter; left time: 19.8454s
	iters: 500, epoch: 1 | loss: 0.7530859
	speed: 0.0052s/iter; left time: 18.9569s
Updating learning rate to 0.0006225688549167969
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 3.072990655899048
Epoch: 1, Steps: 514 | Train Loss: 0.4882303 Vali Loss: 0.3740091 Best vali loss: 0.3740091
	iters: 100, epoch: 2 | loss: 0.3281638
	speed: 0.0127s/iter; left time: 44.2985s
	iters: 200, epoch: 2 | loss: 0.6362269
	speed: 0.0054s/iter; left time: 18.5244s
	iters: 300, epoch: 2 | loss: 0.4619468
	speed: 0.0054s/iter; left time: 17.8236s
	iters: 400, epoch: 2 | loss: 0.4293118
	speed: 0.0057s/iter; left time: 18.3267s
	iters: 500, epoch: 2 | loss: 0.2498732
	speed: 0.0056s/iter; left time: 17.3548s
Updating learning rate to 0.000552421030539641
Validation loss decreased (0.3740 --> 0.3731).  Saving model state dict ...
Epoch: 2 cost time: 2.932011365890503
Epoch: 2, Steps: 514 | Train Loss: 0.4211045 Vali Loss: 0.3731184 Best vali loss: 0.3731184
	iters: 100, epoch: 3 | loss: 0.4014956
	speed: 0.0124s/iter; left time: 36.9002s
	iters: 200, epoch: 3 | loss: 0.2628505
	speed: 0.0052s/iter; left time: 14.9906s
	iters: 300, epoch: 3 | loss: 0.5082021
	speed: 0.0056s/iter; left time: 15.4651s
	iters: 400, epoch: 3 | loss: 0.3664423
	speed: 0.0057s/iter; left time: 15.3625s
	iters: 500, epoch: 3 | loss: 0.5797946
	speed: 0.0059s/iter; left time: 15.2348s
Updating learning rate to 0.00044743739233834293
Validation loss decreased (0.3731 --> 0.3585).  Saving model state dict ...
Epoch: 3 cost time: 2.9171454906463623
Epoch: 3, Steps: 514 | Train Loss: 0.4237570 Vali Loss: 0.3584511 Best vali loss: 0.3584511

best validation loss 0.3584511080811675

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0015590966815, 'e_layers': 1, 'learning_rate': 0.0005012943918, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4901837
	speed: 0.0094s/iter; left time: 37.5854s
	iters: 200, epoch: 1 | loss: 0.8486855
	speed: 0.0037s/iter; left time: 14.2958s
	iters: 300, epoch: 1 | loss: 0.3823222
	speed: 0.0040s/iter; left time: 15.3464s
	iters: 400, epoch: 1 | loss: 1.3246920
	speed: 0.0035s/iter; left time: 13.0558s
	iters: 500, epoch: 1 | loss: 0.6420013
	speed: 0.0036s/iter; left time: 13.0787s
Updating learning rate to 0.0005012943918
Validation loss decreased (inf --> 0.3737).  Saving model state dict ...
Epoch: 1 cost time: 2.1732542514801025
Epoch: 1, Steps: 514 | Train Loss: 0.7375769 Vali Loss: 0.3737000 Best vali loss: 0.3737000
	iters: 100, epoch: 2 | loss: 0.6496266
	speed: 0.0093s/iter; left time: 32.6621s
	iters: 200, epoch: 2 | loss: 0.4074836
	speed: 0.0036s/iter; left time: 12.2379s
	iters: 300, epoch: 2 | loss: 1.2747655
	speed: 0.0034s/iter; left time: 11.3168s
	iters: 400, epoch: 2 | loss: 0.8171148
	speed: 0.0038s/iter; left time: 12.2521s
	iters: 500, epoch: 2 | loss: 0.7134447
	speed: 0.0036s/iter; left time: 11.0735s
Updating learning rate to 0.0002506471959
Validation loss decreased (0.3737 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 1.912294626235962
Epoch: 2, Steps: 514 | Train Loss: 0.7724870 Vali Loss: 0.3666089 Best vali loss: 0.3666089
	iters: 100, epoch: 3 | loss: 1.3980207
	speed: 0.0095s/iter; left time: 28.3054s
	iters: 200, epoch: 3 | loss: 0.3809741
	speed: 0.0037s/iter; left time: 10.7061s
	iters: 300, epoch: 3 | loss: 0.3151372
	speed: 0.0037s/iter; left time: 10.1947s
	iters: 400, epoch: 3 | loss: 0.6522541
	speed: 0.0038s/iter; left time: 10.2861s
	iters: 500, epoch: 3 | loss: 0.5415773
	speed: 0.0034s/iter; left time: 8.8468s
Updating learning rate to 0.00012532359795
Epoch: 3 cost time: 1.9089860916137695
Epoch: 3, Steps: 514 | Train Loss: 0.6575927 Vali Loss: 0.3684215 Best vali loss: 0.3666089

best validation loss 0.3666088930515971

{'batch_size': 16, 'd_core': 256, 'd_model': 128, 'dropout': 0.0017142046816, 'e_layers': 3, 'learning_rate': 0.0006472014951, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3337228
	speed: 0.0116s/iter; left time: 28.5468s
	iters: 200, epoch: 4 | loss: 0.5757033
	speed: 0.0058s/iter; left time: 13.7806s
	iters: 300, epoch: 4 | loss: 0.2973703
	speed: 0.0053s/iter; left time: 11.9556s
	iters: 400, epoch: 4 | loss: 0.3838448
	speed: 0.0054s/iter; left time: 11.7195s
	iters: 500, epoch: 4 | loss: 0.4908914
	speed: 0.0054s/iter; left time: 11.2820s
Updating learning rate to 0.00032360074755
Validation loss decreased (0.3585 --> 0.3525).  Saving model state dict ...
Epoch: 4 cost time: 3.1397693157196045
Epoch: 4, Steps: 514 | Train Loss: 0.4163065 Vali Loss: 0.3524542 Best vali loss: 0.3524542
	iters: 100, epoch: 5 | loss: 0.2583498
	speed: 0.0127s/iter; left time: 24.9351s
	iters: 200, epoch: 5 | loss: 0.5295441
	speed: 0.0053s/iter; left time: 9.9067s
	iters: 300, epoch: 5 | loss: 0.4499626
	speed: 0.0057s/iter; left time: 9.9814s
	iters: 400, epoch: 5 | loss: 0.4002977
	speed: 0.0050s/iter; left time: 8.3636s
	iters: 500, epoch: 5 | loss: 0.2355738
	speed: 0.0046s/iter; left time: 7.1074s
Updating learning rate to 0.0001997641027616571
Validation loss decreased (0.3525 --> 0.3518).  Saving model state dict ...
Epoch: 5 cost time: 2.738260269165039
Epoch: 5, Steps: 514 | Train Loss: 0.3747456 Vali Loss: 0.3517639 Best vali loss: 0.3517639
	iters: 100, epoch: 6 | loss: 0.3747544
	speed: 0.0124s/iter; left time: 17.9400s
	iters: 200, epoch: 6 | loss: 0.2470379
	speed: 0.0065s/iter; left time: 8.6757s
	iters: 300, epoch: 6 | loss: 0.4524020
	speed: 0.0068s/iter; left time: 8.4334s
	iters: 400, epoch: 6 | loss: 0.3306900
	speed: 0.0066s/iter; left time: 7.5262s
	iters: 500, epoch: 6 | loss: 0.5551918
	speed: 0.0067s/iter; left time: 6.9587s
Updating learning rate to 9.478046456035896e-05
Validation loss decreased (0.3518 --> 0.3516).  Saving model state dict ...
Epoch: 6 cost time: 3.465449333190918
Epoch: 6, Steps: 514 | Train Loss: 0.3920152 Vali Loss: 0.3516341 Best vali loss: 0.3516341
	iters: 100, epoch: 7 | loss: 0.2850619
	speed: 0.0091s/iter; left time: 8.4459s
	iters: 200, epoch: 7 | loss: 0.2790491
	speed: 0.0061s/iter; left time: 5.0348s
	iters: 300, epoch: 7 | loss: 0.7391962
	speed: 0.0060s/iter; left time: 4.3874s
	iters: 400, epoch: 7 | loss: 0.7314611
	speed: 0.0060s/iter; left time: 3.7967s
	iters: 500, epoch: 7 | loss: 0.4296024
	speed: 0.0061s/iter; left time: 3.2083s
Updating learning rate to 2.463264018320308e-05
Epoch: 7 cost time: 3.00205135345459
Epoch: 7, Steps: 514 | Train Loss: 0.4928742 Vali Loss: 0.3617338 Best vali loss: 0.3516341
	iters: 100, epoch: 8 | loss: 0.3328745
	speed: 0.0126s/iter; left time: 5.2384s
	iters: 200, epoch: 8 | loss: 0.4522033
	speed: 0.0060s/iter; left time: 1.8841s
	iters: 300, epoch: 8 | loss: 0.3278976
	speed: 0.0060s/iter; left time: 1.2827s
	iters: 400, epoch: 8 | loss: 0.6866552
	speed: 0.0060s/iter; left time: 0.6878s
	iters: 500, epoch: 8 | loss: 0.4850006
	speed: 0.0061s/iter; left time: 0.0913s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.127988576889038
Epoch: 8, Steps: 514 | Train Loss: 0.4569263 Vali Loss: 0.3604385 Best vali loss: 0.3516341

best validation loss 0.3516340756755915

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 3, 'learning_rate': 5.08199726e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4864925
	speed: 0.0106s/iter; left time: 86.4208s
	iters: 200, epoch: 1 | loss: 0.5110322
	speed: 0.0053s/iter; left time: 42.2518s
	iters: 300, epoch: 1 | loss: 0.8384855
	speed: 0.0053s/iter; left time: 41.9862s
	iters: 400, epoch: 1 | loss: 1.0017208
	speed: 0.0049s/iter; left time: 38.1224s
	iters: 500, epoch: 1 | loss: 0.4773502
	speed: 0.0041s/iter; left time: 31.3663s
	iters: 600, epoch: 1 | loss: 0.3088197
	speed: 0.0036s/iter; left time: 27.1685s
	iters: 700, epoch: 1 | loss: 0.4916835
	speed: 0.0041s/iter; left time: 30.7180s
	iters: 800, epoch: 1 | loss: 0.4059474
	speed: 0.0048s/iter; left time: 35.4869s
	iters: 900, epoch: 1 | loss: 0.5533450
	speed: 0.0047s/iter; left time: 34.5046s
	iters: 1000, epoch: 1 | loss: 1.0382164
	speed: 0.0046s/iter; left time: 33.5420s
Updating learning rate to 4.88857525639622e-05
Validation loss decreased (inf --> 0.3874).  Saving model state dict ...
Epoch: 1 cost time: 5.074272155761719
Epoch: 1, Steps: 1027 | Train Loss: 0.6113093 Vali Loss: 0.3873548 Best vali loss: 0.3873548
	iters: 100, epoch: 2 | loss: 0.3319648
	speed: 0.0143s/iter; left time: 101.2505s
	iters: 200, epoch: 2 | loss: 1.3051960
	speed: 0.0051s/iter; left time: 35.8867s
	iters: 300, epoch: 2 | loss: 0.3221342
	speed: 0.0049s/iter; left time: 33.5297s
	iters: 400, epoch: 2 | loss: 0.5920965
	speed: 0.0049s/iter; left time: 33.3822s
	iters: 500, epoch: 2 | loss: 0.3167731
	speed: 0.0049s/iter; left time: 33.0190s
	iters: 600, epoch: 2 | loss: 0.3314548
	speed: 0.0048s/iter; left time: 31.3881s
	iters: 700, epoch: 2 | loss: 1.3954959
	speed: 0.0039s/iter; left time: 25.2965s
	iters: 800, epoch: 2 | loss: 0.6261159
	speed: 0.0040s/iter; left time: 25.6126s
	iters: 900, epoch: 2 | loss: 0.5435542
	speed: 0.0050s/iter; left time: 31.4101s
	iters: 1000, epoch: 2 | loss: 0.9575214
	speed: 0.0051s/iter; left time: 31.5374s
Updating learning rate to 4.337755992258727e-05
Validation loss decreased (0.3874 --> 0.3720).  Saving model state dict ...
Epoch: 2 cost time: 4.969787836074829
Epoch: 2, Steps: 1027 | Train Loss: 0.6722307 Vali Loss: 0.3719901 Best vali loss: 0.3719901
	iters: 100, epoch: 3 | loss: 0.6855525
	speed: 0.0141s/iter; left time: 85.7899s
	iters: 200, epoch: 3 | loss: 0.2468595
	speed: 0.0047s/iter; left time: 28.2346s
	iters: 300, epoch: 3 | loss: 0.7266594
	speed: 0.0047s/iter; left time: 27.4584s
	iters: 400, epoch: 3 | loss: 1.4541576
	speed: 0.0044s/iter; left time: 25.5396s
	iters: 500, epoch: 3 | loss: 0.8933533
	speed: 0.0048s/iter; left time: 27.3198s
	iters: 600, epoch: 3 | loss: 0.3017143
	speed: 0.0048s/iter; left time: 26.6184s
	iters: 700, epoch: 3 | loss: 0.9115247
	speed: 0.0047s/iter; left time: 25.6131s
	iters: 800, epoch: 3 | loss: 1.0647779
	speed: 0.0044s/iter; left time: 23.6245s
	iters: 900, epoch: 3 | loss: 0.4963414
	speed: 0.0052s/iter; left time: 27.3617s
	iters: 1000, epoch: 3 | loss: 0.5205220
	speed: 0.0045s/iter; left time: 23.3482s
Updating learning rate to 3.5133967073633905e-05
Validation loss decreased (0.3720 --> 0.3675).  Saving model state dict ...
Epoch: 3 cost time: 4.9028356075286865
Epoch: 3, Steps: 1027 | Train Loss: 0.7301462 Vali Loss: 0.3675432 Best vali loss: 0.3675432
	iters: 100, epoch: 4 | loss: 1.7196972
	speed: 0.0143s/iter; left time: 71.7812s
	iters: 200, epoch: 4 | loss: 0.1612207
	speed: 0.0052s/iter; left time: 25.5285s
	iters: 300, epoch: 4 | loss: 1.0968769
	speed: 0.0051s/iter; left time: 24.7017s
	iters: 400, epoch: 4 | loss: 0.3886668
	speed: 0.0046s/iter; left time: 21.6054s
	iters: 500, epoch: 4 | loss: 0.2295947
	speed: 0.0043s/iter; left time: 20.0050s
	iters: 600, epoch: 4 | loss: 0.7353452
	speed: 0.0050s/iter; left time: 22.4592s
	iters: 700, epoch: 4 | loss: 0.4834456
	speed: 0.0051s/iter; left time: 22.6270s
	iters: 800, epoch: 4 | loss: 0.7384015
	speed: 0.0052s/iter; left time: 22.6713s
	iters: 900, epoch: 4 | loss: 1.0598111
	speed: 0.0051s/iter; left time: 21.6013s
	iters: 1000, epoch: 4 | loss: 1.0763402
	speed: 0.0052s/iter; left time: 21.5476s
Updating learning rate to 2.54099863e-05
Validation loss decreased (0.3675 --> 0.3652).  Saving model state dict ...
Epoch: 4 cost time: 5.18668270111084
Epoch: 4, Steps: 1027 | Train Loss: 0.7689400 Vali Loss: 0.3652389 Best vali loss: 0.3652389
	iters: 100, epoch: 5 | loss: 0.3913024
	speed: 0.0151s/iter; left time: 60.6982s
	iters: 200, epoch: 5 | loss: 1.3388352
	speed: 0.0056s/iter; left time: 21.9920s
	iters: 300, epoch: 5 | loss: 1.1622155
	speed: 0.0053s/iter; left time: 20.3492s
	iters: 400, epoch: 5 | loss: 1.2308843
	speed: 0.0046s/iter; left time: 17.0537s
	iters: 500, epoch: 5 | loss: 0.7188570
	speed: 0.0049s/iter; left time: 17.6298s
	iters: 600, epoch: 5 | loss: 0.2500714
	speed: 0.0051s/iter; left time: 18.0623s
	iters: 700, epoch: 5 | loss: 0.3314292
	speed: 0.0056s/iter; left time: 19.1307s
	iters: 800, epoch: 5 | loss: 0.2855613
	speed: 0.0051s/iter; left time: 17.0069s
	iters: 900, epoch: 5 | loss: 0.3313271
	speed: 0.0049s/iter; left time: 15.7961s
	iters: 1000, epoch: 5 | loss: 0.8996771
	speed: 0.0049s/iter; left time: 15.2615s
Updating learning rate to 1.5686005526366093e-05
Validation loss decreased (0.3652 --> 0.3650).  Saving model state dict ...
Epoch: 5 cost time: 5.337291240692139
Epoch: 5, Steps: 1027 | Train Loss: 0.6940160 Vali Loss: 0.3650157 Best vali loss: 0.3650157
	iters: 100, epoch: 6 | loss: 0.2886980
	speed: 0.0151s/iter; left time: 45.1182s
	iters: 200, epoch: 6 | loss: 0.9448206
	speed: 0.0052s/iter; left time: 14.8825s
	iters: 300, epoch: 6 | loss: 0.8981209
	speed: 0.0048s/iter; left time: 13.4689s
	iters: 400, epoch: 6 | loss: 0.5599399
	speed: 0.0048s/iter; left time: 12.9048s
	iters: 500, epoch: 6 | loss: 0.3286981
	speed: 0.0051s/iter; left time: 13.2296s
	iters: 600, epoch: 6 | loss: 0.2950832
	speed: 0.0050s/iter; left time: 12.5259s
	iters: 700, epoch: 6 | loss: 1.1583552
	speed: 0.0051s/iter; left time: 12.0819s
	iters: 800, epoch: 6 | loss: 0.3865785
	speed: 0.0050s/iter; left time: 11.4700s
	iters: 900, epoch: 6 | loss: 1.8030382
	speed: 0.0051s/iter; left time: 11.0204s
	iters: 1000, epoch: 6 | loss: 0.5925652
	speed: 0.0051s/iter; left time: 10.6720s
Updating learning rate to 7.442412677412731e-06
Validation loss decreased (0.3650 --> 0.3647).  Saving model state dict ...
Epoch: 6 cost time: 5.247207880020142
Epoch: 6, Steps: 1027 | Train Loss: 0.7255898 Vali Loss: 0.3647313 Best vali loss: 0.3647313
	iters: 100, epoch: 7 | loss: 0.3763133
	speed: 0.0154s/iter; left time: 30.0300s
	iters: 200, epoch: 7 | loss: 0.5160294
	speed: 0.0048s/iter; left time: 8.9065s
	iters: 300, epoch: 7 | loss: 0.2853167
	speed: 0.0048s/iter; left time: 8.4199s
	iters: 400, epoch: 7 | loss: 0.5860698
	speed: 0.0051s/iter; left time: 8.4871s
	iters: 500, epoch: 7 | loss: 0.2940273
	speed: 0.0051s/iter; left time: 7.9109s
	iters: 600, epoch: 7 | loss: 0.4180943
	speed: 0.0051s/iter; left time: 7.3888s
	iters: 700, epoch: 7 | loss: 0.8209552
	speed: 0.0051s/iter; left time: 6.9434s
	iters: 800, epoch: 7 | loss: 0.5912973
	speed: 0.0052s/iter; left time: 6.4879s
	iters: 900, epoch: 7 | loss: 1.1840734
	speed: 0.0052s/iter; left time: 6.0373s
	iters: 1000, epoch: 7 | loss: 0.8366897
	speed: 0.0051s/iter; left time: 5.4050s
Updating learning rate to 1.934220036037799e-06
Epoch: 7 cost time: 5.273565769195557
Epoch: 7, Steps: 1027 | Train Loss: 0.5908866 Vali Loss: 0.3648744 Best vali loss: 0.3647313
	iters: 100, epoch: 8 | loss: 0.2736631
	speed: 0.0147s/iter; left time: 13.6132s
	iters: 200, epoch: 8 | loss: 0.9010456
	speed: 0.0052s/iter; left time: 4.3406s
	iters: 300, epoch: 8 | loss: 1.3730091
	speed: 0.0053s/iter; left time: 3.8649s
	iters: 400, epoch: 8 | loss: 0.3734956
	speed: 0.0053s/iter; left time: 3.3477s
	iters: 500, epoch: 8 | loss: 0.3110444
	speed: 0.0054s/iter; left time: 2.8710s
	iters: 600, epoch: 8 | loss: 0.7087383
	speed: 0.0054s/iter; left time: 2.3022s
	iters: 700, epoch: 8 | loss: 0.2443476
	speed: 0.0051s/iter; left time: 1.6737s
	iters: 800, epoch: 8 | loss: 0.3049712
	speed: 0.0052s/iter; left time: 1.1830s
	iters: 900, epoch: 8 | loss: 0.6126751
	speed: 0.0051s/iter; left time: 0.6554s
	iters: 1000, epoch: 8 | loss: 0.1887546
	speed: 0.0051s/iter; left time: 0.1440s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.417342662811279
Epoch: 8, Steps: 1027 | Train Loss: 0.5291745 Vali Loss: 0.3648620 Best vali loss: 0.3647313

best validation loss 0.3647313260844742

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0089588480994, 'e_layers': 3, 'learning_rate': 0.0004578762234, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5084727
	speed: 0.0109s/iter; left time: 88.2617s
	iters: 200, epoch: 1 | loss: 0.5977940
	speed: 0.0051s/iter; left time: 40.8371s
	iters: 300, epoch: 1 | loss: 0.4407018
	speed: 0.0050s/iter; left time: 39.7049s
	iters: 400, epoch: 1 | loss: 1.6451750
	speed: 0.0051s/iter; left time: 39.8741s
	iters: 500, epoch: 1 | loss: 0.6585137
	speed: 0.0050s/iter; left time: 38.7207s
	iters: 600, epoch: 1 | loss: 0.2928295
	speed: 0.0051s/iter; left time: 38.7410s
	iters: 700, epoch: 1 | loss: 0.3794113
	speed: 0.0050s/iter; left time: 37.9444s
	iters: 800, epoch: 1 | loss: 0.7014527
	speed: 0.0051s/iter; left time: 38.1564s
	iters: 900, epoch: 1 | loss: 1.0433817
	speed: 0.0051s/iter; left time: 37.0259s
	iters: 1000, epoch: 1 | loss: 0.9285246
	speed: 0.0049s/iter; left time: 35.2887s
Updating learning rate to 0.00044044934731141274
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 5.477248668670654
Epoch: 1, Steps: 1027 | Train Loss: 0.7196257 Vali Loss: 0.3749497 Best vali loss: 0.3749497
	iters: 100, epoch: 2 | loss: 0.3071231
	speed: 0.0150s/iter; left time: 106.0033s
	iters: 200, epoch: 2 | loss: 0.3378517
	speed: 0.0051s/iter; left time: 35.7679s
	iters: 300, epoch: 2 | loss: 0.3880549
	speed: 0.0050s/iter; left time: 34.4072s
	iters: 400, epoch: 2 | loss: 0.5785331
	speed: 0.0050s/iter; left time: 34.2850s
	iters: 500, epoch: 2 | loss: 0.2701809
	speed: 0.0051s/iter; left time: 34.0675s
	iters: 600, epoch: 2 | loss: 0.5869847
	speed: 0.0051s/iter; left time: 33.4905s
	iters: 700, epoch: 2 | loss: 0.4007598
	speed: 0.0051s/iter; left time: 33.0415s
	iters: 800, epoch: 2 | loss: 0.3108985
	speed: 0.0051s/iter; left time: 32.6699s
	iters: 900, epoch: 2 | loss: 0.5161480
	speed: 0.0046s/iter; left time: 29.2471s
	iters: 1000, epoch: 2 | loss: 0.3749324
	speed: 0.0048s/iter; left time: 29.6757s
Updating learning rate to 0.0003908218029551133
Validation loss decreased (0.3749 --> 0.3582).  Saving model state dict ...
Epoch: 2 cost time: 5.192630052566528
Epoch: 2, Steps: 1027 | Train Loss: 0.4071467 Vali Loss: 0.3582170 Best vali loss: 0.3582170
	iters: 100, epoch: 3 | loss: 0.8825395
	speed: 0.0155s/iter; left time: 94.1994s
	iters: 200, epoch: 3 | loss: 0.4747420
	speed: 0.0055s/iter; left time: 33.0909s
	iters: 300, epoch: 3 | loss: 0.2774539
	speed: 0.0056s/iter; left time: 32.6709s
	iters: 400, epoch: 3 | loss: 0.2241480
	speed: 0.0056s/iter; left time: 32.2631s
	iters: 500, epoch: 3 | loss: 0.8983906
	speed: 0.0056s/iter; left time: 31.6252s
	iters: 600, epoch: 3 | loss: 0.3473798
	speed: 0.0055s/iter; left time: 30.6576s
	iters: 700, epoch: 3 | loss: 0.2860014
	speed: 0.0059s/iter; left time: 32.2362s
	iters: 800, epoch: 3 | loss: 0.2465590
	speed: 0.0052s/iter; left time: 28.0227s
	iters: 900, epoch: 3 | loss: 0.2945260
	speed: 0.0048s/iter; left time: 25.4464s
	iters: 1000, epoch: 3 | loss: 1.1524001
	speed: 0.0044s/iter; left time: 22.6208s
Updating learning rate to 0.00031654893408453833
Epoch: 3 cost time: 5.530827045440674
Epoch: 3, Steps: 1027 | Train Loss: 0.5084140 Vali Loss: 0.3626275 Best vali loss: 0.3582170
	iters: 100, epoch: 4 | loss: 0.6361555
	speed: 0.0146s/iter; left time: 73.6150s
	iters: 200, epoch: 4 | loss: 0.2836648
	speed: 0.0053s/iter; left time: 26.2811s
	iters: 300, epoch: 4 | loss: 0.8511112
	speed: 0.0053s/iter; left time: 25.7924s
	iters: 400, epoch: 4 | loss: 1.1553261
	speed: 0.0054s/iter; left time: 25.3831s
	iters: 500, epoch: 4 | loss: 1.3976843
	speed: 0.0054s/iter; left time: 24.9407s
	iters: 600, epoch: 4 | loss: 0.2816837
	speed: 0.0054s/iter; left time: 24.6949s
	iters: 700, epoch: 4 | loss: 0.3618761
	speed: 0.0053s/iter; left time: 23.6172s
	iters: 800, epoch: 4 | loss: 0.3312134
	speed: 0.0051s/iter; left time: 22.2789s
	iters: 900, epoch: 4 | loss: 0.6184745
	speed: 0.0054s/iter; left time: 22.7151s
	iters: 1000, epoch: 4 | loss: 0.3583104
	speed: 0.0053s/iter; left time: 21.9711s
Updating learning rate to 0.0002289381117
Epoch: 4 cost time: 5.521891832351685
Epoch: 4, Steps: 1027 | Train Loss: 0.6275500 Vali Loss: 0.3602928 Best vali loss: 0.3582170
	iters: 100, epoch: 5 | loss: 1.0408529
	speed: 0.0148s/iter; left time: 59.1844s
	iters: 200, epoch: 5 | loss: 0.2928169
	speed: 0.0051s/iter; left time: 19.9439s
	iters: 300, epoch: 5 | loss: 1.2189213
	speed: 0.0052s/iter; left time: 19.8110s
	iters: 400, epoch: 5 | loss: 0.4179447
	speed: 0.0052s/iter; left time: 19.4541s
	iters: 500, epoch: 5 | loss: 0.5464860
	speed: 0.0053s/iter; left time: 19.0637s
	iters: 600, epoch: 5 | loss: 0.9726367
	speed: 0.0052s/iter; left time: 18.1646s
	iters: 700, epoch: 5 | loss: 0.1936656
	speed: 0.0052s/iter; left time: 17.8503s
	iters: 800, epoch: 5 | loss: 0.2428331
	speed: 0.0051s/iter; left time: 16.9379s
	iters: 900, epoch: 5 | loss: 0.7424631
	speed: 0.0052s/iter; left time: 16.5725s
	iters: 1000, epoch: 5 | loss: 0.2989838
	speed: 0.0056s/iter; left time: 17.3544s
Updating learning rate to 0.0001413272893154617
Validation loss decreased (0.3582 --> 0.3527).  Saving model state dict ...
Epoch: 5 cost time: 5.420016765594482
Epoch: 5, Steps: 1027 | Train Loss: 0.5967604 Vali Loss: 0.3527018 Best vali loss: 0.3527018
	iters: 100, epoch: 6 | loss: 0.3855571
	speed: 0.0156s/iter; left time: 46.5546s
	iters: 200, epoch: 6 | loss: 0.2139654
	speed: 0.0057s/iter; left time: 16.5391s
	iters: 300, epoch: 6 | loss: 0.6480165
	speed: 0.0060s/iter; left time: 16.6147s
	iters: 400, epoch: 6 | loss: 0.2781257
	speed: 0.0055s/iter; left time: 14.8543s
	iters: 500, epoch: 6 | loss: 0.3001944
	speed: 0.0057s/iter; left time: 14.6970s
	iters: 600, epoch: 6 | loss: 0.2244407
	speed: 0.0056s/iter; left time: 13.8827s
	iters: 700, epoch: 6 | loss: 0.3643067
	speed: 0.0054s/iter; left time: 12.9528s
	iters: 800, epoch: 6 | loss: 1.6196821
	speed: 0.0053s/iter; left time: 12.0654s
	iters: 900, epoch: 6 | loss: 0.2356441
	speed: 0.0055s/iter; left time: 11.9125s
	iters: 1000, epoch: 6 | loss: 0.4329838
	speed: 0.0054s/iter; left time: 11.2200s
Updating learning rate to 6.705442044488674e-05
Epoch: 6 cost time: 5.762907028198242
Epoch: 6, Steps: 1027 | Train Loss: 0.4702917 Vali Loss: 0.3531767 Best vali loss: 0.3527018
	iters: 100, epoch: 7 | loss: 0.6037931
	speed: 0.0150s/iter; left time: 29.3848s
	iters: 200, epoch: 7 | loss: 1.2039733
	speed: 0.0052s/iter; left time: 9.6308s
	iters: 300, epoch: 7 | loss: 0.3032452
	speed: 0.0052s/iter; left time: 9.1118s
	iters: 400, epoch: 7 | loss: 0.3681059
	speed: 0.0052s/iter; left time: 8.5901s
	iters: 500, epoch: 7 | loss: 0.9609041
	speed: 0.0052s/iter; left time: 8.0319s
	iters: 600, epoch: 7 | loss: 1.1075037
	speed: 0.0051s/iter; left time: 7.4914s
	iters: 700, epoch: 7 | loss: 0.2607873
	speed: 0.0046s/iter; left time: 6.2083s
	iters: 800, epoch: 7 | loss: 0.7505494
	speed: 0.0048s/iter; left time: 6.0619s
	iters: 900, epoch: 7 | loss: 0.3805445
	speed: 0.0052s/iter; left time: 6.0381s
	iters: 1000, epoch: 7 | loss: 0.3776664
	speed: 0.0052s/iter; left time: 5.4997s
Updating learning rate to 1.7426876088587254e-05
Epoch: 7 cost time: 5.274040460586548
Epoch: 7, Steps: 1027 | Train Loss: 0.6317073 Vali Loss: 0.3631702 Best vali loss: 0.3527018
	iters: 100, epoch: 8 | loss: 0.8898984
	speed: 0.0150s/iter; left time: 13.9014s
	iters: 200, epoch: 8 | loss: 0.3433813
	speed: 0.0051s/iter; left time: 4.1966s
	iters: 300, epoch: 8 | loss: 0.7472368
	speed: 0.0050s/iter; left time: 3.6390s
	iters: 400, epoch: 8 | loss: 0.4138936
	speed: 0.0052s/iter; left time: 3.2715s
	iters: 500, epoch: 8 | loss: 0.1758029
	speed: 0.0052s/iter; left time: 2.7428s
	iters: 600, epoch: 8 | loss: 0.4339356
	speed: 0.0054s/iter; left time: 2.3154s
	iters: 700, epoch: 8 | loss: 0.6590417
	speed: 0.0055s/iter; left time: 1.7972s
	iters: 800, epoch: 8 | loss: 0.4541180
	speed: 0.0057s/iter; left time: 1.2960s
	iters: 900, epoch: 8 | loss: 0.7249014
	speed: 0.0056s/iter; left time: 0.7231s
	iters: 1000, epoch: 8 | loss: 0.1829629
	speed: 0.0056s/iter; left time: 0.1567s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.537088394165039
Epoch: 8, Steps: 1027 | Train Loss: 0.5025173 Vali Loss: 0.3654891 Best vali loss: 0.3527018

best validation loss 0.3527017769621491

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0022985164426, 'e_layers': 4, 'learning_rate': 0.0001291814818, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012426480440724965
Validation loss decreased (inf --> 0.4035).  Saving model state dict ...
Epoch: 1 cost time: 0.7977478504180908
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4034988 Best vali loss: 0.4034988
Updating learning rate to 0.0001102632917922533
Validation loss decreased (0.4035 --> 0.3865).  Saving model state dict ...
Epoch: 2 cost time: 0.535146951675415
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3865422 Best vali loss: 0.3865422
Updating learning rate to 8.93085473266162e-05
Validation loss decreased (0.3865 --> 0.3782).  Saving model state dict ...
Epoch: 3 cost time: 0.5799286365509033
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3782249 Best vali loss: 0.3782249

best validation loss 0.3782249292947923

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4755637
	speed: 0.0169s/iter; left time: 15.7401s
Updating learning rate to 0.00022635856963078432
Validation loss decreased (inf --> 0.3634).  Saving model state dict ...
Epoch: 1 cost time: 1.7442350387573242
Epoch: 1, Steps: 129 | Train Loss: 0.4755637 Vali Loss: 0.3634423 Best vali loss: 0.3634423
	iters: 100, epoch: 2 | loss: 0.5511795
	speed: 0.0181s/iter; left time: 14.5520s
Updating learning rate to 0.0002008536619192565
Validation loss decreased (0.3634 --> 0.3583).  Saving model state dict ...
Epoch: 2 cost time: 1.494234323501587
Epoch: 2, Steps: 129 | Train Loss: 0.5511795 Vali Loss: 0.3583002 Best vali loss: 0.3583002
	iters: 100, epoch: 3 | loss: 0.8230171
	speed: 0.0185s/iter; left time: 12.4677s
Updating learning rate to 0.00016268287006193248
Epoch: 3 cost time: 1.4802336692810059
Epoch: 3, Steps: 129 | Train Loss: 0.8230171 Vali Loss: 0.3606501 Best vali loss: 0.3583002

best validation loss 0.3583002460963131

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0010602146623, 'e_layers': 4, 'learning_rate': 0.000225512069, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9802859
	speed: 0.0125s/iter; left time: 24.3963s
	iters: 200, epoch: 1 | loss: 0.3405740
	speed: 0.0070s/iter; left time: 12.9227s
Updating learning rate to 0.000225512069
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 2.030428171157837
Epoch: 1, Steps: 257 | Train Loss: 0.6604300 Vali Loss: 0.3657182 Best vali loss: 0.3657182
	iters: 100, epoch: 2 | loss: 0.6103957
	speed: 0.0138s/iter; left time: 23.4436s
	iters: 200, epoch: 2 | loss: 0.6435148
	speed: 0.0065s/iter; left time: 10.4545s
Updating learning rate to 0.0001127560345
Validation loss decreased (0.3657 --> 0.3609).  Saving model state dict ...
Epoch: 2 cost time: 1.7378199100494385
Epoch: 2, Steps: 257 | Train Loss: 0.6269552 Vali Loss: 0.3609287 Best vali loss: 0.3609287
	iters: 100, epoch: 3 | loss: 0.3906236
	speed: 0.0146s/iter; left time: 21.1252s
	iters: 200, epoch: 3 | loss: 0.3959781
	speed: 0.0067s/iter; left time: 8.9834s
Updating learning rate to 5.637801725e-05
Epoch: 3 cost time: 1.7497425079345703
Epoch: 3, Steps: 257 | Train Loss: 0.3933009 Vali Loss: 0.3646485 Best vali loss: 0.3609287

best validation loss 0.36092869967280766

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0023778809549, 'e_layers': 4, 'learning_rate': 0.0002353147022, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4004002
	speed: 0.0169s/iter; left time: 9.2215s
Updating learning rate to 0.0001176573511
Epoch: 4 cost time: 1.6144816875457764
Epoch: 4, Steps: 129 | Train Loss: 0.4004002 Vali Loss: 0.3614109 Best vali loss: 0.3583002
	iters: 100, epoch: 5 | loss: 0.4553118
	speed: 0.0167s/iter; left time: 6.9561s
Updating learning rate to 7.263183213806753e-05
Epoch: 5 cost time: 1.4759089946746826
Epoch: 5, Steps: 129 | Train Loss: 0.4553118 Vali Loss: 0.3875703 Best vali loss: 0.3583002
	iters: 100, epoch: 6 | loss: 0.6781163
	speed: 0.0187s/iter; left time: 5.3716s
Updating learning rate to 3.446104028074351e-05
Epoch: 6 cost time: 1.5325977802276611
Epoch: 6, Steps: 129 | Train Loss: 0.6781163 Vali Loss: 0.3824079 Best vali loss: 0.3583002
	iters: 100, epoch: 7 | loss: 0.3946624
	speed: 0.0170s/iter; left time: 2.7076s
Updating learning rate to 8.956132569215671e-06
Epoch: 7 cost time: 1.6931042671203613
Epoch: 7, Steps: 129 | Train Loss: 0.3946624 Vali Loss: 0.3918644 Best vali loss: 0.3583002
	iters: 100, epoch: 8 | loss: 0.3475603
	speed: 0.0259s/iter; left time: 0.7756s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.089803457260132
Epoch: 8, Steps: 129 | Train Loss: 0.3475603 Vali Loss: 0.3997287 Best vali loss: 0.3583002

best validation loss 0.3583002460963131

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0028252887435, 'e_layers': 1, 'learning_rate': 0.0029075166254, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0027968558630216732
Validation loss decreased (inf --> 0.3991).  Saving model state dict ...
Epoch: 1 cost time: 0.8934588432312012
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3991384 Best vali loss: 0.3991384
Updating learning rate to 0.0024817206738164837
Validation loss decreased (0.3991 --> 0.3722).  Saving model state dict ...
Epoch: 2 cost time: 0.5280630588531494
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3722097 Best vali loss: 0.3722097
Updating learning rate to 0.002010087533633318
Epoch: 3 cost time: 0.31976771354675293
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3997472 Best vali loss: 0.3722097
Updating learning rate to 0.0014537583127
Epoch: 4 cost time: 0.3278157711029053
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4043143 Best vali loss: 0.3722097
Updating learning rate to 0.0008974290917666826
Epoch: 5 cost time: 0.42862486839294434
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4064837 Best vali loss: 0.3722097
Updating learning rate to 0.0004257959515835167
Epoch: 6 cost time: 0.4521667957305908
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4373362 Best vali loss: 0.3722097
Updating learning rate to 0.000110660762378327
Epoch: 7 cost time: 0.4122178554534912
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4499236 Best vali loss: 0.3722097
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4861116409301758
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4559842 Best vali loss: 0.3722097

best validation loss 0.37220965573501963

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.004626800892, 'e_layers': 2, 'learning_rate': 0.0022058584169, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4014488
	speed: 0.0125s/iter; left time: 11.6276s
Updating learning rate to 0.0022058584169
Validation loss decreased (inf --> 0.3756).  Saving model state dict ...
Epoch: 1 cost time: 1.1447687149047852
Epoch: 1, Steps: 129 | Train Loss: 0.4014488 Vali Loss: 0.3755540 Best vali loss: 0.3755540
	iters: 100, epoch: 2 | loss: 0.6850314
	speed: 0.0114s/iter; left time: 9.1947s
Updating learning rate to 0.00110292920845
Epoch: 2 cost time: 0.9349856376647949
Epoch: 2, Steps: 129 | Train Loss: 0.6850314 Vali Loss: 0.3861649 Best vali loss: 0.3755540
	iters: 100, epoch: 3 | loss: 0.4067782
	speed: 0.0110s/iter; left time: 7.3958s
Updating learning rate to 0.000551464604225
Validation loss decreased (0.3756 --> 0.3754).  Saving model state dict ...
Epoch: 3 cost time: 0.8788578510284424
Epoch: 3, Steps: 129 | Train Loss: 0.4067782 Vali Loss: 0.3753956 Best vali loss: 0.3753956
	iters: 100, epoch: 4 | loss: 0.7756189
	speed: 0.0083s/iter; left time: 4.5171s
Updating learning rate to 0.0002757323021125
Epoch: 4 cost time: 0.5787270069122314
Epoch: 4, Steps: 129 | Train Loss: 0.7756189 Vali Loss: 0.3778760 Best vali loss: 0.3753956
	iters: 100, epoch: 5 | loss: 1.0322999
	speed: 0.0102s/iter; left time: 4.2686s
Updating learning rate to 0.00013786615105625
Epoch: 5 cost time: 1.0111825466156006
Epoch: 5, Steps: 129 | Train Loss: 1.0322999 Vali Loss: 0.3870025 Best vali loss: 0.3753956
	iters: 100, epoch: 6 | loss: 0.5652820
	speed: 0.0132s/iter; left time: 3.8074s
Updating learning rate to 6.8933075528125e-05
Epoch: 6 cost time: 0.9955704212188721
Epoch: 6, Steps: 129 | Train Loss: 0.5652820 Vali Loss: 0.3843897 Best vali loss: 0.3753956
	iters: 100, epoch: 7 | loss: 0.5281349
	speed: 0.0140s/iter; left time: 2.2283s
Updating learning rate to 3.44665377640625e-05
Epoch: 7 cost time: 1.1624126434326172
Epoch: 7, Steps: 129 | Train Loss: 0.5281349 Vali Loss: 0.3803472 Best vali loss: 0.3753956
	iters: 100, epoch: 8 | loss: 0.6546460
	speed: 0.0134s/iter; left time: 0.4022s
Updating learning rate to 1.723326888203125e-05
Epoch: 8 cost time: 1.0848867893218994
Epoch: 8, Steps: 129 | Train Loss: 0.6546460 Vali Loss: 0.3797578 Best vali loss: 0.3753956

best validation loss 0.3753956499408879

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4668409
	speed: 0.0133s/iter; left time: 25.9421s
	iters: 200, epoch: 1 | loss: 0.4139578
	speed: 0.0056s/iter; left time: 10.3746s
Updating learning rate to 0.0017284464069435928
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 1.913011074066162
Epoch: 1, Steps: 257 | Train Loss: 0.4403993 Vali Loss: 0.3756772 Best vali loss: 0.3756772
	iters: 100, epoch: 2 | loss: 0.5595556
	speed: 0.0153s/iter; left time: 25.9813s
	iters: 200, epoch: 2 | loss: 0.3667197
	speed: 0.0040s/iter; left time: 6.4493s
Updating learning rate to 0.001533694044948534
Validation loss decreased (0.3757 --> 0.3725).  Saving model state dict ...
Epoch: 2 cost time: 1.254502296447754
Epoch: 2, Steps: 257 | Train Loss: 0.4631377 Vali Loss: 0.3725283 Best vali loss: 0.3725283
	iters: 100, epoch: 3 | loss: 0.7608157
	speed: 0.0066s/iter; left time: 9.5841s
	iters: 200, epoch: 3 | loss: 0.3133416
	speed: 0.0030s/iter; left time: 4.0580s
Updating learning rate to 0.0012422265376940138
Epoch: 3 cost time: 0.9050633907318115
Epoch: 3, Steps: 257 | Train Loss: 0.5370786 Vali Loss: 0.3997259 Best vali loss: 0.3725283

best validation loss 0.37252830039775675

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0039181470431, 'e_layers': 3, 'learning_rate': 0.00012582665, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00012103765828973066
Validation loss decreased (inf --> 0.4117).  Saving model state dict ...
Epoch: 1 cost time: 0.8550717830657959
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4116518 Best vali loss: 0.4116518
Updating learning rate to 0.00010739976373449315
Validation loss decreased (0.4117 --> 0.3914).  Saving model state dict ...
Epoch: 2 cost time: 0.5890927314758301
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3913949 Best vali loss: 0.3913949
Updating learning rate to 8.698921215250042e-05
Validation loss decreased (0.3914 --> 0.3811).  Saving model state dict ...
Epoch: 3 cost time: 0.6105766296386719
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3811421 Best vali loss: 0.3811421

best validation loss 0.38114207552083584

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9974793
	speed: 0.0126s/iter; left time: 24.7509s
	iters: 200, epoch: 1 | loss: 0.7189469
	speed: 0.0048s/iter; left time: 8.8579s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.4038).  Saving model state dict ...
Epoch: 1 cost time: 1.718895435333252
Epoch: 1, Steps: 257 | Train Loss: 0.8582131 Vali Loss: 0.4038398 Best vali loss: 0.4038398
	iters: 100, epoch: 2 | loss: 1.1598021
	speed: 0.0128s/iter; left time: 21.7600s
	iters: 200, epoch: 2 | loss: 0.6204589
	speed: 0.0069s/iter; left time: 11.0855s
Updating learning rate to 0.0018678807033885223
Epoch: 2 cost time: 1.8549163341522217
Epoch: 2, Steps: 257 | Train Loss: 0.8901305 Vali Loss: 0.4058852 Best vali loss: 0.4038398
	iters: 100, epoch: 3 | loss: 0.7219403
	speed: 0.0146s/iter; left time: 21.0724s
	iters: 200, epoch: 3 | loss: 1.3407354
	speed: 0.0063s/iter; left time: 8.4951s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 1.7767269611358643
Epoch: 3, Steps: 257 | Train Loss: 1.0313379 Vali Loss: 0.4039350 Best vali loss: 0.4038398

best validation loss 0.40383983211105134

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0043931310567, 'e_layers': 1, 'learning_rate': 0.001796834342, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4044140
	speed: 0.0102s/iter; left time: 12.1395s
	iters: 200, epoch: 4 | loss: 0.3952633
	speed: 0.0043s/iter; left time: 4.6872s
Updating learning rate to 0.000898417171
Epoch: 4 cost time: 1.3789770603179932
Epoch: 4, Steps: 257 | Train Loss: 0.3998387 Vali Loss: 0.4270142 Best vali loss: 0.3725283
	iters: 100, epoch: 5 | loss: 0.4770718
	speed: 0.0102s/iter; left time: 9.4935s
	iters: 200, epoch: 5 | loss: 0.3164984
	speed: 0.0043s/iter; left time: 3.5668s
Updating learning rate to 0.0005546078043059862
Epoch: 5 cost time: 1.1355440616607666
Epoch: 5, Steps: 257 | Train Loss: 0.3967851 Vali Loss: 0.4293520 Best vali loss: 0.3725283
	iters: 100, epoch: 6 | loss: 0.6226487
	speed: 0.0104s/iter; left time: 7.0103s
	iters: 200, epoch: 6 | loss: 0.2907502
	speed: 0.0036s/iter; left time: 2.0679s
Updating learning rate to 0.000263140297051466
Epoch: 6 cost time: 1.0089237689971924
Epoch: 6, Steps: 257 | Train Loss: 0.4566994 Vali Loss: 0.4741374 Best vali loss: 0.3725283
	iters: 100, epoch: 7 | loss: 0.3485282
	speed: 0.0067s/iter; left time: 2.7775s
	iters: 200, epoch: 7 | loss: 0.4312728
	speed: 0.0039s/iter; left time: 1.2313s
Updating learning rate to 6.838793505640724e-05
Epoch: 7 cost time: 0.9890244007110596
Epoch: 7, Steps: 257 | Train Loss: 0.3899005 Vali Loss: 0.5041963 Best vali loss: 0.3725283
	iters: 100, epoch: 8 | loss: 0.3334388
	speed: 0.0106s/iter; left time: 1.6670s
	iters: 200, epoch: 8 | loss: 0.7044818
	speed: 0.0042s/iter; left time: 0.2419s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1496803760528564
Epoch: 8, Steps: 257 | Train Loss: 0.5189603 Vali Loss: 0.4972072 Best vali loss: 0.3725283

best validation loss 0.37252830039775675

{'batch_size': 32, 'd_core': 512, 'd_model': 64, 'dropout': 0.0010053990878, 'e_layers': 2, 'learning_rate': 0.0004254413654, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4150002
	speed: 0.0111s/iter; left time: 21.7498s
	iters: 200, epoch: 1 | loss: 0.7142684
	speed: 0.0044s/iter; left time: 8.2266s
Updating learning rate to 0.0004254413654
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 1.4585778713226318
Epoch: 1, Steps: 257 | Train Loss: 0.5646343 Vali Loss: 0.3675596 Best vali loss: 0.3675596
	iters: 100, epoch: 2 | loss: 0.6194140
	speed: 0.0089s/iter; left time: 15.1897s
	iters: 200, epoch: 2 | loss: 0.3462737
	speed: 0.0055s/iter; left time: 8.7327s
Updating learning rate to 0.0002127206827
Epoch: 2 cost time: 1.3989510536193848
Epoch: 2, Steps: 257 | Train Loss: 0.4828439 Vali Loss: 0.3679635 Best vali loss: 0.3675596
	iters: 100, epoch: 3 | loss: 0.8719909
	speed: 0.0129s/iter; left time: 18.5545s
	iters: 200, epoch: 3 | loss: 0.6785589
	speed: 0.0046s/iter; left time: 6.1164s
Updating learning rate to 0.00010636034135
Epoch: 3 cost time: 1.2792954444885254
Epoch: 3, Steps: 257 | Train Loss: 0.7752749 Vali Loss: 0.3717465 Best vali loss: 0.3675596
	iters: 100, epoch: 4 | loss: 0.6724608
	speed: 0.0085s/iter; left time: 10.0946s
	iters: 200, epoch: 4 | loss: 0.4200811
	speed: 0.0058s/iter; left time: 6.3519s
Updating learning rate to 5.3180170675e-05
Epoch: 4 cost time: 1.3733885288238525
Epoch: 4, Steps: 257 | Train Loss: 0.5462710 Vali Loss: 0.3719016 Best vali loss: 0.3675596
	iters: 100, epoch: 5 | loss: 0.3077812
	speed: 0.0123s/iter; left time: 11.3989s
	iters: 200, epoch: 5 | loss: 0.4059567
	speed: 0.0060s/iter; left time: 4.9343s
Updating learning rate to 2.65900853375e-05
Epoch: 5 cost time: 1.5120277404785156
Epoch: 5, Steps: 257 | Train Loss: 0.3568690 Vali Loss: 0.3724689 Best vali loss: 0.3675596
	iters: 100, epoch: 6 | loss: 0.6943374
	speed: 0.0125s/iter; left time: 8.4030s
	iters: 200, epoch: 6 | loss: 0.5345892
	speed: 0.0056s/iter; left time: 3.1788s
Updating learning rate to 1.329504266875e-05
Epoch: 6 cost time: 1.4899394512176514
Epoch: 6, Steps: 257 | Train Loss: 0.6144633 Vali Loss: 0.3730540 Best vali loss: 0.3675596
	iters: 100, epoch: 7 | loss: 0.4498364
	speed: 0.0130s/iter; left time: 5.3784s
	iters: 200, epoch: 7 | loss: 0.7660058
	speed: 0.0038s/iter; left time: 1.1846s
Updating learning rate to 6.647521334375e-06
Epoch: 7 cost time: 1.1873793601989746
Epoch: 7, Steps: 257 | Train Loss: 0.6079211 Vali Loss: 0.3728912 Best vali loss: 0.3675596
	iters: 100, epoch: 8 | loss: 0.5355822
	speed: 0.0090s/iter; left time: 1.4255s
	iters: 200, epoch: 8 | loss: 0.3152448
	speed: 0.0056s/iter; left time: 0.3240s
Updating learning rate to 3.3237606671875e-06
Epoch: 8 cost time: 1.354353427886963
Epoch: 8, Steps: 257 | Train Loss: 0.4254135 Vali Loss: 0.3731623 Best vali loss: 0.3675596

best validation loss 0.3675595670411535

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.0113842174153, 'e_layers': 1, 'learning_rate': 0.0018134405744, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1168650
	speed: 0.0083s/iter; left time: 67.4339s
	iters: 200, epoch: 1 | loss: 1.2202717
	speed: 0.0037s/iter; left time: 29.3056s
	iters: 300, epoch: 1 | loss: 0.4734292
	speed: 0.0038s/iter; left time: 30.0129s
	iters: 400, epoch: 1 | loss: 0.3025644
	speed: 0.0031s/iter; left time: 23.9258s
	iters: 500, epoch: 1 | loss: 1.0001115
	speed: 0.0030s/iter; left time: 23.3046s
	iters: 600, epoch: 1 | loss: 0.5992243
	speed: 0.0037s/iter; left time: 28.5574s
	iters: 700, epoch: 1 | loss: 0.7311769
	speed: 0.0037s/iter; left time: 27.6718s
	iters: 800, epoch: 1 | loss: 0.3387877
	speed: 0.0026s/iter; left time: 19.5861s
	iters: 900, epoch: 1 | loss: 0.3546385
	speed: 0.0033s/iter; left time: 24.0314s
	iters: 1000, epoch: 1 | loss: 0.3296684
	speed: 0.0035s/iter; left time: 25.5225s
Updating learning rate to 0.0018134405744
Validation loss decreased (inf --> 0.3861).  Saving model state dict ...
Epoch: 1 cost time: 3.6800215244293213
Epoch: 1, Steps: 1027 | Train Loss: 0.6466738 Vali Loss: 0.3861318 Best vali loss: 0.3861318
	iters: 100, epoch: 2 | loss: 0.8616487
	speed: 0.0091s/iter; left time: 64.5165s
	iters: 200, epoch: 2 | loss: 0.5124664
	speed: 0.0026s/iter; left time: 18.0049s
	iters: 300, epoch: 2 | loss: 1.4238179
	speed: 0.0030s/iter; left time: 20.8823s
	iters: 400, epoch: 2 | loss: 1.6283615
	speed: 0.0031s/iter; left time: 20.9610s
	iters: 500, epoch: 2 | loss: 1.0156096
	speed: 0.0030s/iter; left time: 20.3989s
	iters: 600, epoch: 2 | loss: 0.8589724
	speed: 0.0030s/iter; left time: 19.7235s
	iters: 700, epoch: 2 | loss: 0.3550822
	speed: 0.0026s/iter; left time: 16.9818s
	iters: 800, epoch: 2 | loss: 0.8534977
	speed: 0.0031s/iter; left time: 19.8537s
	iters: 900, epoch: 2 | loss: 0.3887066
	speed: 0.0029s/iter; left time: 18.0972s
	iters: 1000, epoch: 2 | loss: 1.1161768
	speed: 0.0029s/iter; left time: 18.2490s
Updating learning rate to 0.0009067202872
Validation loss decreased (0.3861 --> 0.3773).  Saving model state dict ...
Epoch: 2 cost time: 3.009584665298462
Epoch: 2, Steps: 1027 | Train Loss: 0.9014340 Vali Loss: 0.3773374 Best vali loss: 0.3773374
	iters: 100, epoch: 3 | loss: 1.6376127
	speed: 0.0103s/iter; left time: 62.2487s
	iters: 200, epoch: 3 | loss: 0.3733073
	speed: 0.0031s/iter; left time: 18.4526s
	iters: 300, epoch: 3 | loss: 0.9311464
	speed: 0.0029s/iter; left time: 17.2622s
	iters: 400, epoch: 3 | loss: 0.7434315
	speed: 0.0026s/iter; left time: 14.7305s
	iters: 500, epoch: 3 | loss: 0.5646837
	speed: 0.0031s/iter; left time: 17.5030s
	iters: 600, epoch: 3 | loss: 1.0828888
	speed: 0.0031s/iter; left time: 16.9777s
	iters: 700, epoch: 3 | loss: 1.0611367
	speed: 0.0030s/iter; left time: 16.4675s
	iters: 800, epoch: 3 | loss: 0.2874110
	speed: 0.0028s/iter; left time: 15.1613s
	iters: 900, epoch: 3 | loss: 0.2949578
	speed: 0.0027s/iter; left time: 14.2273s
	iters: 1000, epoch: 3 | loss: 0.3378969
	speed: 0.0030s/iter; left time: 15.5592s
Updating learning rate to 0.0004533601436
Epoch: 3 cost time: 3.0661723613739014
Epoch: 3, Steps: 1027 | Train Loss: 0.7314473 Vali Loss: 0.4245063 Best vali loss: 0.3773374
	iters: 100, epoch: 4 | loss: 0.4082234
	speed: 0.0103s/iter; left time: 51.9167s
	iters: 200, epoch: 4 | loss: 0.5248363
	speed: 0.0028s/iter; left time: 14.0540s
	iters: 300, epoch: 4 | loss: 0.8194860
	speed: 0.0031s/iter; left time: 14.7614s
	iters: 400, epoch: 4 | loss: 0.4119243
	speed: 0.0030s/iter; left time: 14.1106s
	iters: 500, epoch: 4 | loss: 0.7516367
	speed: 0.0028s/iter; left time: 12.7678s
	iters: 600, epoch: 4 | loss: 0.6672041
	speed: 0.0025s/iter; left time: 11.5412s
	iters: 700, epoch: 4 | loss: 0.7170619
	speed: 0.0029s/iter; left time: 12.8257s
	iters: 800, epoch: 4 | loss: 0.4606681
	speed: 0.0031s/iter; left time: 13.3477s
	iters: 900, epoch: 4 | loss: 0.4059613
	speed: 0.0030s/iter; left time: 12.5182s
	iters: 1000, epoch: 4 | loss: 0.3525778
	speed: 0.0028s/iter; left time: 11.6757s
Updating learning rate to 0.0002266800718
Epoch: 4 cost time: 2.977159261703491
Epoch: 4, Steps: 1027 | Train Loss: 0.5519580 Vali Loss: 0.4493434 Best vali loss: 0.3773374
	iters: 100, epoch: 5 | loss: 0.9209146
	speed: 0.0106s/iter; left time: 42.3543s
	iters: 200, epoch: 5 | loss: 0.3694780
	speed: 0.0029s/iter; left time: 11.2226s
	iters: 300, epoch: 5 | loss: 0.7593989
	speed: 0.0025s/iter; left time: 9.4666s
	iters: 400, epoch: 5 | loss: 0.4339349
	speed: 0.0022s/iter; left time: 8.2995s
	iters: 500, epoch: 5 | loss: 0.3265172
	speed: 0.0022s/iter; left time: 7.8711s
	iters: 600, epoch: 5 | loss: 0.2694307
	speed: 0.0022s/iter; left time: 7.8895s
	iters: 700, epoch: 5 | loss: 0.4486053
	speed: 0.0030s/iter; left time: 10.1511s
	iters: 800, epoch: 5 | loss: 0.2781005
	speed: 0.0037s/iter; left time: 12.1188s
	iters: 900, epoch: 5 | loss: 0.7399935
	speed: 0.0036s/iter; left time: 11.6797s
	iters: 1000, epoch: 5 | loss: 0.4040595
	speed: 0.0034s/iter; left time: 10.6448s
Updating learning rate to 0.0001133400359
Epoch: 5 cost time: 2.9952032566070557
Epoch: 5, Steps: 1027 | Train Loss: 0.4950433 Vali Loss: 0.4783850 Best vali loss: 0.3773374
	iters: 100, epoch: 6 | loss: 0.5532408
	speed: 0.0137s/iter; left time: 40.8475s
	iters: 200, epoch: 6 | loss: 0.5277807
	speed: 0.0036s/iter; left time: 10.3196s
	iters: 300, epoch: 6 | loss: 0.4315680
	speed: 0.0031s/iter; left time: 8.6165s
	iters: 400, epoch: 6 | loss: 0.3528920
	speed: 0.0024s/iter; left time: 6.3682s
	iters: 500, epoch: 6 | loss: 0.2443363
	speed: 0.0024s/iter; left time: 6.2032s
	iters: 600, epoch: 6 | loss: 0.3775695
	speed: 0.0026s/iter; left time: 6.5030s
	iters: 700, epoch: 6 | loss: 0.2279795
	speed: 0.0034s/iter; left time: 8.1821s
	iters: 800, epoch: 6 | loss: 0.3268621
	speed: 0.0033s/iter; left time: 7.4940s
	iters: 900, epoch: 6 | loss: 0.5086482
	speed: 0.0033s/iter; left time: 7.1655s
	iters: 1000, epoch: 6 | loss: 0.2354859
	speed: 0.0033s/iter; left time: 6.9227s
Updating learning rate to 5.667001795e-05
Epoch: 6 cost time: 3.2387542724609375
Epoch: 6, Steps: 1027 | Train Loss: 0.3786363 Vali Loss: 0.4711050 Best vali loss: 0.3773374
	iters: 100, epoch: 7 | loss: 0.9482330
	speed: 0.0135s/iter; left time: 26.4356s
	iters: 200, epoch: 7 | loss: 0.6265193
	speed: 0.0032s/iter; left time: 5.8717s
	iters: 300, epoch: 7 | loss: 0.5529046
	speed: 0.0024s/iter; left time: 4.2742s
	iters: 400, epoch: 7 | loss: 1.5817020
	speed: 0.0024s/iter; left time: 3.9965s
	iters: 500, epoch: 7 | loss: 0.5535480
	speed: 0.0023s/iter; left time: 3.5591s
	iters: 600, epoch: 7 | loss: 0.9262925
	speed: 0.0032s/iter; left time: 4.7191s
	iters: 700, epoch: 7 | loss: 0.4610137
	speed: 0.0033s/iter; left time: 4.4792s
	iters: 800, epoch: 7 | loss: 0.6158921
	speed: 0.0033s/iter; left time: 4.1281s
	iters: 900, epoch: 7 | loss: 0.4325725
	speed: 0.0033s/iter; left time: 3.8042s
	iters: 1000, epoch: 7 | loss: 0.3335583
	speed: 0.0033s/iter; left time: 3.4875s
Updating learning rate to 2.8335008975e-05
Epoch: 7 cost time: 3.1419925689697266
Epoch: 7, Steps: 1027 | Train Loss: 0.7032236 Vali Loss: 0.4937548 Best vali loss: 0.3773374
	iters: 100, epoch: 8 | loss: 0.2195445
	speed: 0.0139s/iter; left time: 12.8633s
	iters: 200, epoch: 8 | loss: 0.2237142
	speed: 0.0026s/iter; left time: 2.1860s
	iters: 300, epoch: 8 | loss: 0.3057536
	speed: 0.0025s/iter; left time: 1.8195s
	iters: 400, epoch: 8 | loss: 0.2239290
	speed: 0.0027s/iter; left time: 1.7216s
	iters: 500, epoch: 8 | loss: 0.3092897
	speed: 0.0035s/iter; left time: 1.8291s
	iters: 600, epoch: 8 | loss: 0.4613464
	speed: 0.0037s/iter; left time: 1.5842s
	iters: 700, epoch: 8 | loss: 0.3871662
	speed: 0.0037s/iter; left time: 1.2048s
	iters: 800, epoch: 8 | loss: 0.8116203
	speed: 0.0037s/iter; left time: 0.8334s
	iters: 900, epoch: 8 | loss: 0.5843429
	speed: 0.0037s/iter; left time: 0.4702s
	iters: 1000, epoch: 8 | loss: 0.2182512
	speed: 0.0037s/iter; left time: 0.1043s
Updating learning rate to 1.41675044875e-05
Epoch: 8 cost time: 3.4817426204681396
Epoch: 8, Steps: 1027 | Train Loss: 0.3744958 Vali Loss: 0.4907903 Best vali loss: 0.3773374

best validation loss 0.3773374320364654

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0014152615275, 'e_layers': 1, 'learning_rate': 0.0004514822726, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004514822726
Validation loss decreased (inf --> 0.4009).  Saving model state dict ...
Epoch: 1 cost time: 0.7372899055480957
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4009402 Best vali loss: 0.4009402
Updating learning rate to 0.0002257411363
Validation loss decreased (0.4009 --> 0.3819).  Saving model state dict ...
Epoch: 2 cost time: 0.5799281597137451
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3819314 Best vali loss: 0.3819314
Updating learning rate to 0.00011287056815
Validation loss decreased (0.3819 --> 0.3766).  Saving model state dict ...
Epoch: 3 cost time: 0.49753570556640625
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3765574 Best vali loss: 0.3765574

best validation loss 0.37655736467927287

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6100000
	speed: 0.0116s/iter; left time: 10.8443s
Updating learning rate to 6.8306078e-05
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 0.9713082313537598
Epoch: 1, Steps: 129 | Train Loss: 0.6100000 Vali Loss: 0.3711772 Best vali loss: 0.3711772
	iters: 100, epoch: 2 | loss: 0.5815114
	speed: 0.0090s/iter; left time: 7.2512s
Updating learning rate to 3.4153039e-05
Validation loss decreased (0.3712 --> 0.3625).  Saving model state dict ...
Epoch: 2 cost time: 0.7007777690887451
Epoch: 2, Steps: 129 | Train Loss: 0.5815114 Vali Loss: 0.3624891 Best vali loss: 0.3624891
	iters: 100, epoch: 3 | loss: 0.5620725
	speed: 0.0095s/iter; left time: 6.3978s
Updating learning rate to 1.70765195e-05
Epoch: 3 cost time: 0.6974799633026123
Epoch: 3, Steps: 129 | Train Loss: 0.5620725 Vali Loss: 0.3629084 Best vali loss: 0.3624891

best validation loss 0.36248914029134516

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0014438416367, 'e_layers': 1, 'learning_rate': 0.000558760672, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3460743
	speed: 0.0099s/iter; left time: 19.4689s
	iters: 200, epoch: 1 | loss: 0.6688406
	speed: 0.0040s/iter; left time: 7.3991s
Updating learning rate to 0.0005374941102165261
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 1.3994109630584717
Epoch: 1, Steps: 257 | Train Loss: 0.5074575 Vali Loss: 0.3693678 Best vali loss: 0.3693678
	iters: 100, epoch: 2 | loss: 0.7029994
	speed: 0.0102s/iter; left time: 17.2870s
	iters: 200, epoch: 2 | loss: 0.3912174
	speed: 0.0045s/iter; left time: 7.1439s
Updating learning rate to 0.00047693206611577606
Epoch: 2 cost time: 1.1739516258239746
Epoch: 2, Steps: 257 | Train Loss: 0.5471084 Vali Loss: 0.3760393 Best vali loss: 0.3693678
	iters: 100, epoch: 3 | loss: 0.5244998
	speed: 0.0112s/iter; left time: 16.1708s
	iters: 200, epoch: 3 | loss: 0.6672828
	speed: 0.0043s/iter; left time: 5.8120s
Updating learning rate to 0.000386294561915792
Epoch: 3 cost time: 1.1885697841644287
Epoch: 3, Steps: 257 | Train Loss: 0.5958913 Vali Loss: 0.3896087 Best vali loss: 0.3693678

best validation loss 0.3693677751043691

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0025029933314, 'e_layers': 1, 'learning_rate': 6.8306078e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5871800
	speed: 0.0114s/iter; left time: 6.2227s
Updating learning rate to 8.53825975e-06
Epoch: 4 cost time: 1.005127191543579
Epoch: 4, Steps: 129 | Train Loss: 0.5871800 Vali Loss: 0.3644141 Best vali loss: 0.3624891
	iters: 100, epoch: 5 | loss: 0.5627345
	speed: 0.0100s/iter; left time: 4.1679s
Updating learning rate to 4.269129875e-06
Epoch: 5 cost time: 0.7181491851806641
Epoch: 5, Steps: 129 | Train Loss: 0.5627345 Vali Loss: 0.3637217 Best vali loss: 0.3624891
	iters: 100, epoch: 6 | loss: 0.5622964
	speed: 0.0098s/iter; left time: 2.8094s
Updating learning rate to 2.1345649375e-06
Epoch: 6 cost time: 0.7103712558746338
Epoch: 6, Steps: 129 | Train Loss: 0.5622964 Vali Loss: 0.3636630 Best vali loss: 0.3624891
	iters: 100, epoch: 7 | loss: 0.6946155
	speed: 0.0096s/iter; left time: 1.5231s
Updating learning rate to 1.06728246875e-06
Epoch: 7 cost time: 0.7437586784362793
Epoch: 7, Steps: 129 | Train Loss: 0.6946155 Vali Loss: 0.3635809 Best vali loss: 0.3624891
	iters: 100, epoch: 8 | loss: 0.4669677
	speed: 0.0096s/iter; left time: 0.2872s
Updating learning rate to 5.33641234375e-07
Epoch: 8 cost time: 0.7097840309143066
Epoch: 8, Steps: 129 | Train Loss: 0.4669677 Vali Loss: 0.3636558 Best vali loss: 0.3624891

best validation loss 0.36248914029134516

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0079026385404, 'e_layers': 2, 'learning_rate': 0.0022201950658, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4327762
	speed: 0.0103s/iter; left time: 20.0775s
	iters: 200, epoch: 1 | loss: 0.4811751
	speed: 0.0050s/iter; left time: 9.2677s
Updating learning rate to 0.0022201950658
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 1.5631921291351318
Epoch: 1, Steps: 257 | Train Loss: 0.4569757 Vali Loss: 0.3692022 Best vali loss: 0.3692022
	iters: 100, epoch: 2 | loss: 0.5950590
	speed: 0.0111s/iter; left time: 18.8820s
	iters: 200, epoch: 2 | loss: 0.5680009
	speed: 0.0039s/iter; left time: 6.2906s
Updating learning rate to 0.0011100975329
Epoch: 2 cost time: 1.1171293258666992
Epoch: 2, Steps: 257 | Train Loss: 0.5815299 Vali Loss: 0.3731185 Best vali loss: 0.3692022
	iters: 100, epoch: 3 | loss: 0.5074316
	speed: 0.0089s/iter; left time: 12.8939s
	iters: 200, epoch: 3 | loss: 0.9410152
	speed: 0.0055s/iter; left time: 7.3678s
Updating learning rate to 0.00055504876645
Epoch: 3 cost time: 1.3167695999145508
Epoch: 3, Steps: 257 | Train Loss: 0.7242234 Vali Loss: 0.3713742 Best vali loss: 0.3692022
	iters: 100, epoch: 4 | loss: 0.8260192
	speed: 0.0123s/iter; left time: 14.5815s
	iters: 200, epoch: 4 | loss: 0.3180073
	speed: 0.0055s/iter; left time: 5.9845s
Updating learning rate to 0.000277524383225
Epoch: 4 cost time: 1.4808051586151123
Epoch: 4, Steps: 257 | Train Loss: 0.5720132 Vali Loss: 0.3807708 Best vali loss: 0.3692022
	iters: 100, epoch: 5 | loss: 0.6267120
	speed: 0.0103s/iter; left time: 9.5253s
	iters: 200, epoch: 5 | loss: 0.4431087
	speed: 0.0041s/iter; left time: 3.4154s
Updating learning rate to 0.0001387621916125
Epoch: 5 cost time: 1.169771432876587
Epoch: 5, Steps: 257 | Train Loss: 0.5349103 Vali Loss: 0.3947482 Best vali loss: 0.3692022
	iters: 100, epoch: 6 | loss: 0.5949050
	speed: 0.0127s/iter; left time: 8.5138s
	iters: 200, epoch: 6 | loss: 0.5589488
	speed: 0.0050s/iter; left time: 2.8502s
Updating learning rate to 6.938109580625e-05
Epoch: 6 cost time: 1.3907182216644287
Epoch: 6, Steps: 257 | Train Loss: 0.5769269 Vali Loss: 0.3966404 Best vali loss: 0.3692022
	iters: 100, epoch: 7 | loss: 0.5190042
	speed: 0.0120s/iter; left time: 4.9859s
	iters: 200, epoch: 7 | loss: 0.4819832
	speed: 0.0051s/iter; left time: 1.6123s
Updating learning rate to 3.4690547903125e-05
Epoch: 7 cost time: 1.403304100036621
Epoch: 7, Steps: 257 | Train Loss: 0.5004937 Vali Loss: 0.3940359 Best vali loss: 0.3692022
	iters: 100, epoch: 8 | loss: 0.6046292
	speed: 0.0121s/iter; left time: 1.9063s
	iters: 200, epoch: 8 | loss: 0.5602509
	speed: 0.0033s/iter; left time: 0.1896s
Updating learning rate to 1.73452739515625e-05
Epoch: 8 cost time: 1.0286757946014404
Epoch: 8, Steps: 257 | Train Loss: 0.5824400 Vali Loss: 0.3914802 Best vali loss: 0.3692022

best validation loss 0.36920217487573154

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0027523638828, 'e_layers': 2, 'learning_rate': 0.0003512624633, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0003378933318411835
Validation loss decreased (inf --> 0.4071).  Saving model state dict ...
Epoch: 1 cost time: 0.8399181365966797
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4070515 Best vali loss: 0.4070515
Updating learning rate to 0.0002998212665378604
Validation loss decreased (0.4071 --> 0.3870).  Saving model state dict ...
Epoch: 2 cost time: 0.6087346076965332
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3869875 Best vali loss: 0.3869875
Updating learning rate to 0.0002428423942083302
Validation loss decreased (0.3870 --> 0.3781).  Saving model state dict ...
Epoch: 3 cost time: 0.5262598991394043
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3780936 Best vali loss: 0.3780936
Updating learning rate to 0.00017563123165
Validation loss decreased (0.3781 --> 0.3736).  Saving model state dict ...
Epoch: 4 cost time: 0.5218944549560547
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3736452 Best vali loss: 0.3736452
Updating learning rate to 0.00010842006909166983
Validation loss decreased (0.3736 --> 0.3707).  Saving model state dict ...
Epoch: 5 cost time: 0.5888535976409912
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3707442 Best vali loss: 0.3707442
Updating learning rate to 5.144119676213962e-05
Validation loss decreased (0.3707 --> 0.3698).  Saving model state dict ...
Epoch: 6 cost time: 0.36891746520996094
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3698130 Best vali loss: 0.3698130
Updating learning rate to 1.3369131458816492e-05
Validation loss decreased (0.3698 --> 0.3693).  Saving model state dict ...
Epoch: 7 cost time: 0.34920740127563477
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3693498 Best vali loss: 0.3693498
Updating learning rate to 0.0
Validation loss decreased (0.3693 --> 0.3693).  Saving model state dict ...
Epoch: 8 cost time: 0.5659565925598145
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3692698 Best vali loss: 0.3692698

best validation loss 0.36926977367438596

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3744736
	speed: 0.0110s/iter; left time: 44.2195s
	iters: 200, epoch: 1 | loss: 0.3364629
	speed: 0.0051s/iter; left time: 19.9011s
	iters: 300, epoch: 1 | loss: 0.8870738
	speed: 0.0049s/iter; left time: 18.5985s
	iters: 400, epoch: 1 | loss: 0.9043940
	speed: 0.0053s/iter; left time: 19.5051s
	iters: 500, epoch: 1 | loss: 0.6916306
	speed: 0.0054s/iter; left time: 19.3389s
Updating learning rate to 9.34698808e-05
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 2.9454517364501953
Epoch: 1, Steps: 514 | Train Loss: 0.6388070 Vali Loss: 0.3634941 Best vali loss: 0.3634941
	iters: 100, epoch: 2 | loss: 1.0997485
	speed: 0.0112s/iter; left time: 39.0175s
	iters: 200, epoch: 2 | loss: 0.8563116
	speed: 0.0051s/iter; left time: 17.3154s
	iters: 300, epoch: 2 | loss: 1.2965876
	speed: 0.0048s/iter; left time: 15.9910s
	iters: 400, epoch: 2 | loss: 0.3816759
	speed: 0.0049s/iter; left time: 15.7884s
	iters: 500, epoch: 2 | loss: 0.6290401
	speed: 0.0051s/iter; left time: 15.8520s
Updating learning rate to 4.67349404e-05
Epoch: 2 cost time: 2.6278533935546875
Epoch: 2, Steps: 514 | Train Loss: 0.8526727 Vali Loss: 0.3636792 Best vali loss: 0.3634941
	iters: 100, epoch: 3 | loss: 1.0513308
	speed: 0.0114s/iter; left time: 33.9854s
	iters: 200, epoch: 3 | loss: 0.7176890
	speed: 0.0052s/iter; left time: 15.0064s
	iters: 300, epoch: 3 | loss: 0.4844642
	speed: 0.0049s/iter; left time: 13.7534s
	iters: 400, epoch: 3 | loss: 0.6530150
	speed: 0.0044s/iter; left time: 11.8350s
	iters: 500, epoch: 3 | loss: 0.2390027
	speed: 0.0052s/iter; left time: 13.3325s
Updating learning rate to 2.33674702e-05
Epoch: 3 cost time: 2.593445062637329
Epoch: 3, Steps: 514 | Train Loss: 0.6291003 Vali Loss: 0.3697024 Best vali loss: 0.3634941

best validation loss 0.36349414711148426

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0024194218485, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3714998
	speed: 0.0122s/iter; left time: 48.8685s
	iters: 200, epoch: 1 | loss: 0.6149608
	speed: 0.0056s/iter; left time: 21.7182s
	iters: 300, epoch: 1 | loss: 0.8161721
	speed: 0.0050s/iter; left time: 19.0186s
	iters: 400, epoch: 1 | loss: 0.9836345
	speed: 0.0067s/iter; left time: 24.8500s
	iters: 500, epoch: 1 | loss: 0.9158736
	speed: 0.0068s/iter; left time: 24.4395s
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 3.3976399898529053
Epoch: 1, Steps: 514 | Train Loss: 0.9404281 Vali Loss: 0.3699458 Best vali loss: 0.3699458
	iters: 100, epoch: 2 | loss: 0.5224845
	speed: 0.0142s/iter; left time: 49.6238s
	iters: 200, epoch: 2 | loss: 0.6256947
	speed: 0.0069s/iter; left time: 23.3809s
	iters: 300, epoch: 2 | loss: 0.6947412
	speed: 0.0067s/iter; left time: 22.0595s
	iters: 400, epoch: 2 | loss: 0.4028594
	speed: 0.0071s/iter; left time: 22.6887s
	iters: 500, epoch: 2 | loss: 0.3579559
	speed: 0.0070s/iter; left time: 21.8365s
Updating learning rate to 0.00034048964815
Epoch: 2 cost time: 3.600304126739502
Epoch: 2, Steps: 514 | Train Loss: 0.5207472 Vali Loss: 0.3794729 Best vali loss: 0.3699458
	iters: 100, epoch: 3 | loss: 0.3727205
	speed: 0.0109s/iter; left time: 32.5266s
	iters: 200, epoch: 3 | loss: 0.2929347
	speed: 0.0059s/iter; left time: 16.9098s
	iters: 300, epoch: 3 | loss: 0.3652551
	speed: 0.0059s/iter; left time: 16.5070s
	iters: 400, epoch: 3 | loss: 0.3760220
	speed: 0.0064s/iter; left time: 17.1582s
	iters: 500, epoch: 3 | loss: 0.4136873
	speed: 0.0064s/iter; left time: 16.6169s
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 3.1417534351348877
Epoch: 3, Steps: 514 | Train Loss: 0.3641239 Vali Loss: 0.3731183 Best vali loss: 0.3699458

best validation loss 0.3699458176588497

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0047262361197, 'e_layers': 2, 'learning_rate': 5.5626136e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.5626136e-05
Validation loss decreased (inf --> 0.3987).  Saving model state dict ...
Epoch: 1 cost time: 0.8817992210388184
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3987017 Best vali loss: 0.3987017
Updating learning rate to 2.7813068e-05
Validation loss decreased (0.3987 --> 0.3795).  Saving model state dict ...
Epoch: 2 cost time: 0.523768424987793
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3795412 Best vali loss: 0.3795412
Updating learning rate to 1.3906534e-05
Validation loss decreased (0.3795 --> 0.3739).  Saving model state dict ...
Epoch: 3 cost time: 0.5554196834564209
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3739405 Best vali loss: 0.3739405

best validation loss 0.37394047228432825

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0115959139193, 'e_layers': 2, 'learning_rate': 9.34698808e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3296438
	speed: 0.0110s/iter; left time: 27.1194s
	iters: 200, epoch: 4 | loss: 0.3365443
	speed: 0.0048s/iter; left time: 11.3528s
	iters: 300, epoch: 4 | loss: 0.8672776
	speed: 0.0038s/iter; left time: 8.6730s
	iters: 400, epoch: 4 | loss: 0.8629112
	speed: 0.0031s/iter; left time: 6.7373s
	iters: 500, epoch: 4 | loss: 0.6274156
	speed: 0.0034s/iter; left time: 7.0925s
Updating learning rate to 1.16837351e-05
Epoch: 4 cost time: 2.362718105316162
Epoch: 4, Steps: 514 | Train Loss: 0.6047585 Vali Loss: 0.3733115 Best vali loss: 0.3634941
	iters: 100, epoch: 5 | loss: 1.0654815
	speed: 0.0110s/iter; left time: 21.4978s
	iters: 200, epoch: 5 | loss: 0.7633016
	speed: 0.0050s/iter; left time: 9.2547s
	iters: 300, epoch: 5 | loss: 1.0570933
	speed: 0.0049s/iter; left time: 8.6701s
	iters: 400, epoch: 5 | loss: 0.3869909
	speed: 0.0048s/iter; left time: 7.9799s
	iters: 500, epoch: 5 | loss: 0.6187473
	speed: 0.0047s/iter; left time: 7.3667s
Updating learning rate to 5.84186755e-06
Epoch: 5 cost time: 2.5840742588043213
Epoch: 5, Steps: 514 | Train Loss: 0.7783229 Vali Loss: 0.3748033 Best vali loss: 0.3634941
	iters: 100, epoch: 6 | loss: 1.0015366
	speed: 0.0110s/iter; left time: 15.8845s
	iters: 200, epoch: 6 | loss: 0.6577790
	speed: 0.0050s/iter; left time: 6.6694s
	iters: 300, epoch: 6 | loss: 0.4480232
	speed: 0.0049s/iter; left time: 6.1316s
	iters: 400, epoch: 6 | loss: 0.6411836
	speed: 0.0048s/iter; left time: 5.5269s
	iters: 500, epoch: 6 | loss: 0.2320634
	speed: 0.0050s/iter; left time: 5.2397s
Updating learning rate to 2.920933775e-06
Epoch: 6 cost time: 2.5835297107696533
Epoch: 6, Steps: 514 | Train Loss: 0.5961171 Vali Loss: 0.3781941 Best vali loss: 0.3634941
	iters: 100, epoch: 7 | loss: 0.5885872
	speed: 0.0107s/iter; left time: 9.9553s
	iters: 200, epoch: 7 | loss: 0.3017436
	speed: 0.0048s/iter; left time: 4.0095s
	iters: 300, epoch: 7 | loss: 0.3425338
	speed: 0.0049s/iter; left time: 3.5935s
	iters: 400, epoch: 7 | loss: 0.3366288
	speed: 0.0051s/iter; left time: 3.1917s
	iters: 500, epoch: 7 | loss: 0.8267104
	speed: 0.0051s/iter; left time: 2.7168s
Updating learning rate to 1.4604668875e-06
Epoch: 7 cost time: 2.62261962890625
Epoch: 7, Steps: 514 | Train Loss: 0.4792407 Vali Loss: 0.3792122 Best vali loss: 0.3634941
	iters: 100, epoch: 8 | loss: 0.5366172
	speed: 0.0103s/iter; left time: 4.2576s
	iters: 200, epoch: 8 | loss: 0.5820164
	speed: 0.0048s/iter; left time: 1.5241s
	iters: 300, epoch: 8 | loss: 0.2507078
	speed: 0.0046s/iter; left time: 0.9968s
	iters: 400, epoch: 8 | loss: 0.7171664
	speed: 0.0047s/iter; left time: 0.5387s
	iters: 500, epoch: 8 | loss: 0.6247669
	speed: 0.0039s/iter; left time: 0.0589s
Updating learning rate to 7.3023344375e-07
Epoch: 8 cost time: 2.3681743144989014
Epoch: 8, Steps: 514 | Train Loss: 0.5422550 Vali Loss: 0.3800122 Best vali loss: 0.3634941

best validation loss 0.36349414711148426

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.002399800657, 'e_layers': 3, 'learning_rate': 5.41855407e-05, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 5.41855407e-05
Validation loss decreased (inf --> 0.4415).  Saving model state dict ...
Epoch: 1 cost time: 0.8241665363311768
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4415352 Best vali loss: 0.4415352
Updating learning rate to 2.709277035e-05
Validation loss decreased (0.4415 --> 0.4317).  Saving model state dict ...
Epoch: 2 cost time: 0.5806043148040771
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4317495 Best vali loss: 0.4317495
Updating learning rate to 1.3546385175e-05
Validation loss decreased (0.4317 --> 0.4275).  Saving model state dict ...
Epoch: 3 cost time: 0.41635632514953613
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4274859 Best vali loss: 0.4274859
Updating learning rate to 6.7731925875e-06
Validation loss decreased (0.4275 --> 0.4255).  Saving model state dict ...
Epoch: 4 cost time: 0.4558086395263672
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4255213 Best vali loss: 0.4255213
Updating learning rate to 3.38659629375e-06
Validation loss decreased (0.4255 --> 0.4246).  Saving model state dict ...
Epoch: 5 cost time: 0.5198097229003906
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4245510 Best vali loss: 0.4245510
Updating learning rate to 1.693298146875e-06
Validation loss decreased (0.4246 --> 0.4241).  Saving model state dict ...
Epoch: 6 cost time: 0.5290777683258057
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4240567 Best vali loss: 0.4240567
Updating learning rate to 8.466490734375e-07
Validation loss decreased (0.4241 --> 0.4238).  Saving model state dict ...
Epoch: 7 cost time: 0.5304651260375977
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4238150 Best vali loss: 0.4238150
Updating learning rate to 4.2332453671875e-07
Validation loss decreased (0.4238 --> 0.4237).  Saving model state dict ...
Epoch: 8 cost time: 0.5280709266662598
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4236954 Best vali loss: 0.4236954

best validation loss 0.42369542420495937

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0016060344052, 'e_layers': 3, 'learning_rate': 0.000441050979, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5593491
	speed: 0.0123s/iter; left time: 24.0043s
	iters: 200, epoch: 1 | loss: 0.4878121
	speed: 0.0067s/iter; left time: 12.3675s
Updating learning rate to 0.0004242644756460827
Validation loss decreased (inf --> 0.3636).  Saving model state dict ...
Epoch: 1 cost time: 2.0318753719329834
Epoch: 1, Steps: 257 | Train Loss: 0.5235806 Vali Loss: 0.3635561 Best vali loss: 0.3635561
	iters: 100, epoch: 2 | loss: 0.4047480
	speed: 0.0145s/iter; left time: 24.5816s
	iters: 200, epoch: 2 | loss: 0.8665576
	speed: 0.0063s/iter; left time: 10.0772s
Updating learning rate to 0.00037646055854993277
Epoch: 2 cost time: 1.7496519088745117
Epoch: 2, Steps: 257 | Train Loss: 0.6356528 Vali Loss: 0.3882389 Best vali loss: 0.3635561
	iters: 100, epoch: 3 | loss: 0.5369083
	speed: 0.0140s/iter; left time: 20.2422s
	iters: 200, epoch: 3 | loss: 0.4593700
	speed: 0.0067s/iter; left time: 9.0130s
Updating learning rate to 0.00030491694074585157
Epoch: 3 cost time: 1.767315149307251
Epoch: 3, Steps: 257 | Train Loss: 0.4981392 Vali Loss: 0.3664640 Best vali loss: 0.3635561
	iters: 100, epoch: 4 | loss: 0.4350224
	speed: 0.0139s/iter; left time: 16.4994s
	iters: 200, epoch: 4 | loss: 0.3297109
	speed: 0.0062s/iter; left time: 6.7675s
Updating learning rate to 0.0002205254895
Epoch: 4 cost time: 1.7585070133209229
Epoch: 4, Steps: 257 | Train Loss: 0.3823667 Vali Loss: 0.3672575 Best vali loss: 0.3635561
	iters: 100, epoch: 5 | loss: 0.4564091
	speed: 0.0143s/iter; left time: 13.3265s
	iters: 200, epoch: 5 | loss: 0.5286130
	speed: 0.0068s/iter; left time: 5.6315s
Updating learning rate to 0.00013613403825414846
Epoch: 5 cost time: 1.7789294719696045
Epoch: 5, Steps: 257 | Train Loss: 0.4925111 Vali Loss: 0.3666495 Best vali loss: 0.3635561
	iters: 100, epoch: 6 | loss: 0.5049165
	speed: 0.0139s/iter; left time: 9.3540s
	iters: 200, epoch: 6 | loss: 0.3910816
	speed: 0.0064s/iter; left time: 3.6607s
Updating learning rate to 6.459042045006724e-05
Epoch: 6 cost time: 1.7245023250579834
Epoch: 6, Steps: 257 | Train Loss: 0.4479991 Vali Loss: 0.3652903 Best vali loss: 0.3635561
	iters: 100, epoch: 7 | loss: 0.5151481
	speed: 0.0140s/iter; left time: 5.7956s
	iters: 200, epoch: 7 | loss: 0.4454476
	speed: 0.0066s/iter; left time: 2.0750s
Updating learning rate to 1.678650335391733e-05
Epoch: 7 cost time: 1.7690317630767822
Epoch: 7, Steps: 257 | Train Loss: 0.4802978 Vali Loss: 0.3684410 Best vali loss: 0.3635561
	iters: 100, epoch: 8 | loss: 0.2318268
	speed: 0.0140s/iter; left time: 2.2155s
	iters: 200, epoch: 8 | loss: 0.5330324
	speed: 0.0061s/iter; left time: 0.3563s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5800468921661377
Epoch: 8, Steps: 257 | Train Loss: 0.3824296 Vali Loss: 0.3708107 Best vali loss: 0.3635561

best validation loss 0.36355611126877235

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047364814747, 'e_layers': 3, 'learning_rate': 0.0010075758554, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1282456
	speed: 0.0142s/iter; left time: 27.8705s
	iters: 200, epoch: 1 | loss: 1.2040408
	speed: 0.0081s/iter; left time: 14.9684s
Updating learning rate to 0.000969227282828306
Validation loss decreased (inf --> 0.3984).  Saving model state dict ...
Epoch: 1 cost time: 2.4380626678466797
Epoch: 1, Steps: 257 | Train Loss: 1.1661432 Vali Loss: 0.3984227 Best vali loss: 0.3984227
	iters: 100, epoch: 2 | loss: 0.9739198
	speed: 0.0177s/iter; left time: 30.1144s
	iters: 200, epoch: 2 | loss: 0.7393582
	speed: 0.0083s/iter; left time: 13.3191s
Updating learning rate to 0.0008600197876565881
Validation loss decreased (0.3984 --> 0.3965).  Saving model state dict ...
Epoch: 2 cost time: 2.1938886642456055
Epoch: 2, Steps: 257 | Train Loss: 0.8566390 Vali Loss: 0.3964504 Best vali loss: 0.3964504
	iters: 100, epoch: 3 | loss: 0.9693198
	speed: 0.0166s/iter; left time: 23.8829s
	iters: 200, epoch: 3 | loss: 1.0793047
	speed: 0.0058s/iter; left time: 7.8124s
Updating learning rate to 0.0006965792210563318
Epoch: 3 cost time: 1.8337857723236084
Epoch: 3, Steps: 257 | Train Loss: 1.0243122 Vali Loss: 0.4030834 Best vali loss: 0.3964504

best validation loss 0.3964503962539268

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0012309194537, 'e_layers': 3, 'learning_rate': 0.0001461940837, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8340769
	speed: 0.0124s/iter; left time: 11.5766s
Updating learning rate to 0.0001461940837
Validation loss decreased (inf --> 0.3900).  Saving model state dict ...
Epoch: 1 cost time: 1.172860860824585
Epoch: 1, Steps: 129 | Train Loss: 0.8340769 Vali Loss: 0.3900115 Best vali loss: 0.3900115
	iters: 100, epoch: 2 | loss: 0.7425973
	speed: 0.0113s/iter; left time: 9.0991s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.3900 --> 0.3746).  Saving model state dict ...
Epoch: 2 cost time: 0.8938534259796143
Epoch: 2, Steps: 129 | Train Loss: 0.7425973 Vali Loss: 0.3746162 Best vali loss: 0.3746162
	iters: 100, epoch: 3 | loss: 0.7386695
	speed: 0.0113s/iter; left time: 7.6227s
Updating learning rate to 3.6548520925e-05
Validation loss decreased (0.3746 --> 0.3707).  Saving model state dict ...
Epoch: 3 cost time: 0.92124342918396
Epoch: 3, Steps: 129 | Train Loss: 0.7386695 Vali Loss: 0.3707063 Best vali loss: 0.3707063

best validation loss 0.37070625089474885

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6225795
	speed: 0.0106s/iter; left time: 9.8887s
Updating learning rate to 0.0017032495860327328
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 0.9347705841064453
Epoch: 1, Steps: 129 | Train Loss: 0.6225795 Vali Loss: 0.3663992 Best vali loss: 0.3663992
	iters: 100, epoch: 2 | loss: 0.9467952
	speed: 0.0091s/iter; left time: 7.3414s
Updating learning rate to 0.001511336270922462
Epoch: 2 cost time: 0.7144227027893066
Epoch: 2, Steps: 129 | Train Loss: 0.9467952 Vali Loss: 0.3708995 Best vali loss: 0.3663992
	iters: 100, epoch: 3 | loss: 0.4564782
	speed: 0.0091s/iter; left time: 6.1444s
Updating learning rate to 0.0012241176975961933
Epoch: 3 cost time: 0.705305814743042
Epoch: 3, Steps: 129 | Train Loss: 0.4564782 Vali Loss: 0.3734127 Best vali loss: 0.3663992

best validation loss 0.3663991639328378

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0094059862079, 'e_layers': 1, 'learning_rate': 0.0017706405804, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6250167
	speed: 0.0105s/iter; left time: 5.7422s
Updating learning rate to 0.0008853202902
Epoch: 4 cost time: 0.9193766117095947
Epoch: 4, Steps: 129 | Train Loss: 0.6250167 Vali Loss: 0.3784525 Best vali loss: 0.3663992
	iters: 100, epoch: 5 | loss: 0.8586056
	speed: 0.0089s/iter; left time: 3.6922s
Updating learning rate to 0.0005465228828038066
Epoch: 5 cost time: 0.7145955562591553
Epoch: 5, Steps: 129 | Train Loss: 0.8586056 Vali Loss: 0.3805634 Best vali loss: 0.3663992
	iters: 100, epoch: 6 | loss: 0.4458920
	speed: 0.0095s/iter; left time: 2.7422s
Updating learning rate to 0.0002593043094775379
Epoch: 6 cost time: 0.6999003887176514
Epoch: 6, Steps: 129 | Train Loss: 0.4458920 Vali Loss: 0.3796711 Best vali loss: 0.3663992
	iters: 100, epoch: 7 | loss: 0.6140592
	speed: 0.0094s/iter; left time: 1.4871s
Updating learning rate to 6.739099436726728e-05
Epoch: 7 cost time: 0.7068874835968018
Epoch: 7, Steps: 129 | Train Loss: 0.6140592 Vali Loss: 0.3830563 Best vali loss: 0.3663992
	iters: 100, epoch: 8 | loss: 0.6226791
	speed: 0.0091s/iter; left time: 0.2734s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7067258358001709
Epoch: 8, Steps: 129 | Train Loss: 0.6226791 Vali Loss: 0.3822576 Best vali loss: 0.3663992

best validation loss 0.3663991639328378

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0023321783568, 'e_layers': 4, 'learning_rate': 9.29387868e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4828491
	speed: 0.0110s/iter; left time: 89.4636s
	iters: 200, epoch: 1 | loss: 0.8938119
	speed: 0.0048s/iter; left time: 38.5548s
	iters: 300, epoch: 1 | loss: 0.5186536
	speed: 0.0115s/iter; left time: 90.7631s
	iters: 400, epoch: 1 | loss: 0.4501030
	speed: 0.0097s/iter; left time: 75.7635s
	iters: 500, epoch: 1 | loss: 1.0844506
	speed: 0.0107s/iter; left time: 82.3058s
	iters: 600, epoch: 1 | loss: 0.5756102
	speed: 0.0101s/iter; left time: 76.7673s
	iters: 700, epoch: 1 | loss: 1.6774460
	speed: 0.0091s/iter; left time: 68.1111s
	iters: 800, epoch: 1 | loss: 1.1043514
	speed: 0.0123s/iter; left time: 91.5837s
	iters: 900, epoch: 1 | loss: 0.8346955
	speed: 0.0055s/iter; left time: 40.2247s
	iters: 1000, epoch: 1 | loss: 1.1425103
	speed: 0.0050s/iter; left time: 36.0163s
Updating learning rate to 8.940151485047507e-05
Validation loss decreased (inf --> 0.3864).  Saving model state dict ...
Epoch: 1 cost time: 8.834502220153809
Epoch: 1, Steps: 1027 | Train Loss: 0.8764482 Vali Loss: 0.3863761 Best vali loss: 0.3863761
	iters: 100, epoch: 2 | loss: 1.1064260
	speed: 0.0170s/iter; left time: 120.3145s
	iters: 200, epoch: 2 | loss: 1.0100328
	speed: 0.0057s/iter; left time: 39.5022s
	iters: 300, epoch: 2 | loss: 0.8034941
	speed: 0.0059s/iter; left time: 40.3443s
	iters: 400, epoch: 2 | loss: 0.3368133
	speed: 0.0048s/iter; left time: 32.4087s
	iters: 500, epoch: 2 | loss: 0.4145169
	speed: 0.0050s/iter; left time: 33.6983s
	iters: 600, epoch: 2 | loss: 0.8688010
	speed: 0.0054s/iter; left time: 35.8646s
	iters: 700, epoch: 2 | loss: 0.8840261
	speed: 0.0052s/iter; left time: 33.9282s
	iters: 800, epoch: 2 | loss: 0.3851993
	speed: 0.0052s/iter; left time: 33.0450s
	iters: 900, epoch: 2 | loss: 0.4052722
	speed: 0.0049s/iter; left time: 30.9990s
	iters: 1000, epoch: 2 | loss: 1.0799608
	speed: 0.0048s/iter; left time: 29.8799s
Updating learning rate to 7.93282165907654e-05
Validation loss decreased (0.3864 --> 0.3713).  Saving model state dict ...
Epoch: 2 cost time: 5.519741535186768
Epoch: 2, Steps: 1027 | Train Loss: 0.7294543 Vali Loss: 0.3712722 Best vali loss: 0.3712722
	iters: 100, epoch: 3 | loss: 0.3704675
	speed: 0.0156s/iter; left time: 94.8291s
	iters: 200, epoch: 3 | loss: 0.3295871
	speed: 0.0054s/iter; left time: 32.3244s
	iters: 300, epoch: 3 | loss: 0.8506183
	speed: 0.0054s/iter; left time: 31.8561s
	iters: 400, epoch: 3 | loss: 0.2838045
	speed: 0.0054s/iter; left time: 31.0936s
	iters: 500, epoch: 3 | loss: 1.2732731
	speed: 0.0049s/iter; left time: 27.7336s
	iters: 600, epoch: 3 | loss: 0.6681860
	speed: 0.0050s/iter; left time: 27.6842s
	iters: 700, epoch: 3 | loss: 0.4858724
	speed: 0.0061s/iter; left time: 33.5680s
	iters: 800, epoch: 3 | loss: 0.2185889
	speed: 0.0063s/iter; left time: 33.9794s
	iters: 900, epoch: 3 | loss: 1.7050868
	speed: 0.0060s/iter; left time: 31.7027s
	iters: 1000, epoch: 3 | loss: 1.2808511
	speed: 0.0064s/iter; left time: 33.0708s
Updating learning rate to 6.425246036623565e-05
Validation loss decreased (0.3713 --> 0.3672).  Saving model state dict ...
Epoch: 3 cost time: 5.909365892410278
Epoch: 3, Steps: 1027 | Train Loss: 0.7466336 Vali Loss: 0.3671569 Best vali loss: 0.3671569
	iters: 100, epoch: 4 | loss: 0.8811607
	speed: 0.0169s/iter; left time: 85.1203s
	iters: 200, epoch: 4 | loss: 0.2596255
	speed: 0.0063s/iter; left time: 31.1033s
	iters: 300, epoch: 4 | loss: 0.2427701
	speed: 0.0065s/iter; left time: 31.2279s
	iters: 400, epoch: 4 | loss: 0.3884118
	speed: 0.0063s/iter; left time: 29.8941s
	iters: 500, epoch: 4 | loss: 1.8483503
	speed: 0.0058s/iter; left time: 26.6652s
	iters: 600, epoch: 4 | loss: 0.4473726
	speed: 0.0058s/iter; left time: 26.3841s
	iters: 700, epoch: 4 | loss: 1.0749229
	speed: 0.0060s/iter; left time: 26.5975s
	iters: 800, epoch: 4 | loss: 0.3633347
	speed: 0.0060s/iter; left time: 26.1575s
	iters: 900, epoch: 4 | loss: 0.3701347
	speed: 0.0060s/iter; left time: 25.5218s
	iters: 1000, epoch: 4 | loss: 0.2704269
	speed: 0.0060s/iter; left time: 24.6617s
Updating learning rate to 4.64693934e-05
Validation loss decreased (0.3672 --> 0.3656).  Saving model state dict ...
Epoch: 4 cost time: 6.307239294052124
Epoch: 4, Steps: 1027 | Train Loss: 0.6146510 Vali Loss: 0.3655695 Best vali loss: 0.3655695
	iters: 100, epoch: 5 | loss: 0.5061538
	speed: 0.0170s/iter; left time: 68.0253s
	iters: 200, epoch: 5 | loss: 0.3633237
	speed: 0.0059s/iter; left time: 23.2148s
	iters: 300, epoch: 5 | loss: 1.5285412
	speed: 0.0060s/iter; left time: 22.8498s
	iters: 400, epoch: 5 | loss: 0.3885072
	speed: 0.0059s/iter; left time: 21.9813s
	iters: 500, epoch: 5 | loss: 0.3224014
	speed: 0.0060s/iter; left time: 21.5338s
	iters: 600, epoch: 5 | loss: 0.3253991
	speed: 0.0061s/iter; left time: 21.3454s
	iters: 700, epoch: 5 | loss: 0.2767173
	speed: 0.0061s/iter; left time: 20.8765s
	iters: 800, epoch: 5 | loss: 1.1959660
	speed: 0.0061s/iter; left time: 20.3489s
	iters: 900, epoch: 5 | loss: 0.4563395
	speed: 0.0061s/iter; left time: 19.7286s
	iters: 1000, epoch: 5 | loss: 1.5256168
	speed: 0.0061s/iter; left time: 18.9703s
Updating learning rate to 2.8686326433764354e-05
Validation loss decreased (0.3656 --> 0.3647).  Saving model state dict ...
Epoch: 5 cost time: 6.268237829208374
Epoch: 5, Steps: 1027 | Train Loss: 0.6888966 Vali Loss: 0.3646945 Best vali loss: 0.3646945
	iters: 100, epoch: 6 | loss: 1.0671182
	speed: 0.0169s/iter; left time: 50.3048s
	iters: 200, epoch: 6 | loss: 0.5836148
	speed: 0.0063s/iter; left time: 18.0814s
	iters: 300, epoch: 6 | loss: 0.1496255
	speed: 0.0063s/iter; left time: 17.4393s
	iters: 400, epoch: 6 | loss: 1.2937176
	speed: 0.0064s/iter; left time: 17.2209s
	iters: 500, epoch: 6 | loss: 0.2790983
	speed: 0.0063s/iter; left time: 16.2999s
	iters: 600, epoch: 6 | loss: 0.3941697
	speed: 0.0063s/iter; left time: 15.7150s
	iters: 700, epoch: 6 | loss: 1.6247189
	speed: 0.0062s/iter; left time: 14.7803s
	iters: 800, epoch: 6 | loss: 0.9723973
	speed: 0.0062s/iter; left time: 14.1687s
	iters: 900, epoch: 6 | loss: 0.4711756
	speed: 0.0062s/iter; left time: 13.6215s
	iters: 1000, epoch: 6 | loss: 0.4554365
	speed: 0.0063s/iter; left time: 13.0125s
Updating learning rate to 1.3610570209234607e-05
Validation loss decreased (0.3647 --> 0.3647).  Saving model state dict ...
Epoch: 6 cost time: 6.4970526695251465
Epoch: 6, Steps: 1027 | Train Loss: 0.7291072 Vali Loss: 0.3646532 Best vali loss: 0.3646532
	iters: 100, epoch: 7 | loss: 0.6457511
	speed: 0.0168s/iter; left time: 32.8942s
	iters: 200, epoch: 7 | loss: 0.3901793
	speed: 0.0063s/iter; left time: 11.6994s
	iters: 300, epoch: 7 | loss: 0.3457962
	speed: 0.0062s/iter; left time: 10.8173s
	iters: 400, epoch: 7 | loss: 1.1233833
	speed: 0.0066s/iter; left time: 10.8787s
	iters: 500, epoch: 7 | loss: 0.2289376
	speed: 0.0071s/iter; left time: 11.0122s
	iters: 600, epoch: 7 | loss: 0.3362229
	speed: 0.0071s/iter; left time: 10.3561s
	iters: 700, epoch: 7 | loss: 0.2013416
	speed: 0.0064s/iter; left time: 8.6344s
	iters: 800, epoch: 7 | loss: 0.5779591
	speed: 0.0065s/iter; left time: 8.1712s
	iters: 900, epoch: 7 | loss: 0.9789472
	speed: 0.0064s/iter; left time: 7.3407s
	iters: 1000, epoch: 7 | loss: 0.5168291
	speed: 0.0063s/iter; left time: 6.6401s
Updating learning rate to 3.5372719495249264e-06
Epoch: 7 cost time: 6.721920728683472
Epoch: 7, Steps: 1027 | Train Loss: 0.5345347 Vali Loss: 0.3650226 Best vali loss: 0.3646532
	iters: 100, epoch: 8 | loss: 0.4683261
	speed: 0.0165s/iter; left time: 15.3015s
	iters: 200, epoch: 8 | loss: 1.0549248
	speed: 0.0054s/iter; left time: 4.4338s
	iters: 300, epoch: 8 | loss: 0.3481911
	speed: 0.0058s/iter; left time: 4.2474s
	iters: 400, epoch: 8 | loss: 0.6176281
	speed: 0.0060s/iter; left time: 3.7668s
	iters: 500, epoch: 8 | loss: 0.6897715
	speed: 0.0061s/iter; left time: 3.2070s
	iters: 600, epoch: 8 | loss: 0.4340421
	speed: 0.0060s/iter; left time: 2.5891s
	iters: 700, epoch: 8 | loss: 0.5165336
	speed: 0.0061s/iter; left time: 1.9956s
	iters: 800, epoch: 8 | loss: 1.5968174
	speed: 0.0060s/iter; left time: 1.3688s
	iters: 900, epoch: 8 | loss: 1.7982966
	speed: 0.0062s/iter; left time: 0.7890s
	iters: 1000, epoch: 8 | loss: 0.3465717
	speed: 0.0062s/iter; left time: 0.1731s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.179574966430664
Epoch: 8, Steps: 1027 | Train Loss: 0.7871103 Vali Loss: 0.3650124 Best vali loss: 0.3646532

best validation loss 0.3646532474777319

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0028520410111, 'e_layers': 4, 'learning_rate': 0.0001071741248, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8089677
	speed: 0.0158s/iter; left time: 30.9007s
	iters: 200, epoch: 1 | loss: 0.7192074
	speed: 0.0103s/iter; left time: 19.1177s
Updating learning rate to 0.0001071741248
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 2.9334421157836914
Epoch: 1, Steps: 257 | Train Loss: 0.7640876 Vali Loss: 0.3713627 Best vali loss: 0.3713627
	iters: 100, epoch: 2 | loss: 0.5889417
	speed: 0.0211s/iter; left time: 35.8925s
	iters: 200, epoch: 2 | loss: 0.3032589
	speed: 0.0103s/iter; left time: 16.4718s
Updating learning rate to 5.35870624e-05
Epoch: 2 cost time: 2.6998462677001953
Epoch: 2, Steps: 257 | Train Loss: 0.4461003 Vali Loss: 0.3805041 Best vali loss: 0.3713627
	iters: 100, epoch: 3 | loss: 0.3896523
	speed: 0.0206s/iter; left time: 29.7603s
	iters: 200, epoch: 3 | loss: 0.3625952
	speed: 0.0103s/iter; left time: 13.8361s
Updating learning rate to 2.67935312e-05
Validation loss decreased (0.3714 --> 0.3577).  Saving model state dict ...
Epoch: 3 cost time: 2.701664686203003
Epoch: 3, Steps: 257 | Train Loss: 0.3761238 Vali Loss: 0.3577126 Best vali loss: 0.3577126
	iters: 100, epoch: 4 | loss: 0.5012105
	speed: 0.0206s/iter; left time: 24.4724s
	iters: 200, epoch: 4 | loss: 0.3366272
	speed: 0.0101s/iter; left time: 11.0153s
Updating learning rate to 1.33967656e-05
Validation loss decreased (0.3577 --> 0.3514).  Saving model state dict ...
Epoch: 4 cost time: 2.639070749282837
Epoch: 4, Steps: 257 | Train Loss: 0.4189189 Vali Loss: 0.3514088 Best vali loss: 0.3514088
	iters: 100, epoch: 5 | loss: 0.5434762
	speed: 0.0214s/iter; left time: 19.8815s
	iters: 200, epoch: 5 | loss: 0.4726962
	speed: 0.0102s/iter; left time: 8.4889s
Updating learning rate to 6.6983828e-06
Epoch: 5 cost time: 2.717094659805298
Epoch: 5, Steps: 257 | Train Loss: 0.5080862 Vali Loss: 0.3522208 Best vali loss: 0.3514088
	iters: 100, epoch: 6 | loss: 0.4404662
	speed: 0.0207s/iter; left time: 13.9141s
	iters: 200, epoch: 6 | loss: 0.4325276
	speed: 0.0103s/iter; left time: 5.8892s
Updating learning rate to 3.3491914e-06
Epoch: 6 cost time: 2.6935012340545654
Epoch: 6, Steps: 257 | Train Loss: 0.4364969 Vali Loss: 0.3525000 Best vali loss: 0.3514088
	iters: 100, epoch: 7 | loss: 0.5102656
	speed: 0.0186s/iter; left time: 7.6991s
	iters: 200, epoch: 7 | loss: 0.9031568
	speed: 0.0129s/iter; left time: 4.0654s
Updating learning rate to 1.6745957e-06
Epoch: 7 cost time: 3.089350700378418
Epoch: 7, Steps: 257 | Train Loss: 0.7067112 Vali Loss: 0.3528084 Best vali loss: 0.3514088
	iters: 100, epoch: 8 | loss: 0.4825470
	speed: 0.0304s/iter; left time: 4.7996s
	iters: 200, epoch: 8 | loss: 0.2936374
	speed: 0.0140s/iter; left time: 0.8094s
Updating learning rate to 8.3729785e-07
Epoch: 8 cost time: 3.7886059284210205
Epoch: 8, Steps: 257 | Train Loss: 0.3880922 Vali Loss: 0.3520820 Best vali loss: 0.3514088

best validation loss 0.35140876439793406

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0041982547038, 'e_layers': 2, 'learning_rate': 0.0002999627711, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6289397
	speed: 0.0143s/iter; left time: 57.4260s
	iters: 200, epoch: 1 | loss: 0.7205672
	speed: 0.0093s/iter; left time: 36.2190s
	iters: 300, epoch: 1 | loss: 0.3349887
	speed: 0.0080s/iter; left time: 30.5493s
	iters: 400, epoch: 1 | loss: 0.3261138
	speed: 0.0067s/iter; left time: 24.8990s
	iters: 500, epoch: 1 | loss: 0.6148888
	speed: 0.0091s/iter; left time: 32.7949s
Updating learning rate to 0.0002999627711
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 4.6116416454315186
Epoch: 1, Steps: 514 | Train Loss: 0.5250997 Vali Loss: 0.3675485 Best vali loss: 0.3675485
	iters: 100, epoch: 2 | loss: 0.8457012
	speed: 0.0159s/iter; left time: 55.6538s
	iters: 200, epoch: 2 | loss: 0.3567419
	speed: 0.0072s/iter; left time: 24.5591s
	iters: 300, epoch: 2 | loss: 0.6037374
	speed: 0.0095s/iter; left time: 31.3840s
	iters: 400, epoch: 2 | loss: 0.6898304
	speed: 0.0085s/iter; left time: 27.3291s
	iters: 500, epoch: 2 | loss: 0.8105835
	speed: 0.0064s/iter; left time: 19.6956s
Updating learning rate to 0.00014998138555
Validation loss decreased (0.3675 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 3.945326328277588
Epoch: 2, Steps: 514 | Train Loss: 0.6613189 Vali Loss: 0.3667897 Best vali loss: 0.3667897
	iters: 100, epoch: 3 | loss: 0.6665237
	speed: 0.0192s/iter; left time: 57.3768s
	iters: 200, epoch: 3 | loss: 0.7340295
	speed: 0.0061s/iter; left time: 17.7246s
	iters: 300, epoch: 3 | loss: 0.5596814
	speed: 0.0083s/iter; left time: 23.0742s
	iters: 400, epoch: 3 | loss: 0.4809270
	speed: 0.0090s/iter; left time: 24.2878s
	iters: 500, epoch: 3 | loss: 0.6614702
	speed: 0.0083s/iter; left time: 21.4365s
Updating learning rate to 7.4990692775e-05
Epoch: 3 cost time: 4.255584955215454
Epoch: 3, Steps: 514 | Train Loss: 0.6205264 Vali Loss: 0.3714613 Best vali loss: 0.3667897

best validation loss 0.3667896823002454

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006881598346, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9478106
	speed: 0.0155s/iter; left time: 30.2378s
	iters: 200, epoch: 1 | loss: 0.7372931
	speed: 0.0049s/iter; left time: 9.0789s
Updating learning rate to 0.0006619683104416462
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 1.9421589374542236
Epoch: 1, Steps: 257 | Train Loss: 0.8425519 Vali Loss: 0.3686311 Best vali loss: 0.3686311
	iters: 100, epoch: 2 | loss: 0.7111989
	speed: 0.0079s/iter; left time: 13.5009s
	iters: 200, epoch: 2 | loss: 0.6366681
	speed: 0.0049s/iter; left time: 7.8947s
Updating learning rate to 0.0005873811600929365
Epoch: 2 cost time: 1.1699702739715576
Epoch: 2, Steps: 257 | Train Loss: 0.6739335 Vali Loss: 0.3702041 Best vali loss: 0.3686311
	iters: 100, epoch: 3 | loss: 0.7454016
	speed: 0.0115s/iter; left time: 16.5691s
	iters: 200, epoch: 3 | loss: 0.7285029
	speed: 0.0050s/iter; left time: 6.7297s
Updating learning rate to 0.0004757536010602603
Epoch: 3 cost time: 1.3381567001342773
Epoch: 3, Steps: 257 | Train Loss: 0.7369522 Vali Loss: 0.3729749 Best vali loss: 0.3686311

best validation loss 0.3686311482797671

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006724544284
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 1.2904856204986572
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3674673 Best vali loss: 0.3674673
Updating learning rate to 0.0003362272142
Validation loss decreased (0.3675 --> 0.3662).  Saving model state dict ...
Epoch: 2 cost time: 0.9638068675994873
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3662016 Best vali loss: 0.3662016
Updating learning rate to 0.0001681136071
Validation loss decreased (0.3662 --> 0.3588).  Saving model state dict ...
Epoch: 3 cost time: 0.9586787223815918
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3588230 Best vali loss: 0.3588230

best validation loss 0.35882295490716437

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0092167719699, 'e_layers': 4, 'learning_rate': 0.0006724544284, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 8.405680355e-05
Validation loss decreased (0.3588 --> 0.3564).  Saving model state dict ...
Epoch: 4 cost time: 1.3136060237884521
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3563777 Best vali loss: 0.3563777
Updating learning rate to 4.2028401775e-05
Validation loss decreased (0.3564 --> 0.3502).  Saving model state dict ...
Epoch: 5 cost time: 0.8205552101135254
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3502312 Best vali loss: 0.3502312
Updating learning rate to 2.10142008875e-05
Validation loss decreased (0.3502 --> 0.3436).  Saving model state dict ...
Epoch: 6 cost time: 0.9891684055328369
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3435992 Best vali loss: 0.3435992
Updating learning rate to 1.050710044375e-05
Validation loss decreased (0.3436 --> 0.3420).  Saving model state dict ...
Epoch: 7 cost time: 0.91457200050354
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3420000 Best vali loss: 0.3420000
Updating learning rate to 5.253550221875e-06
Epoch: 8 cost time: 0.9821829795837402
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3425172 Best vali loss: 0.3420000

best validation loss 0.34199999968991535

[INFO][abstract_intensifier.py:595] Added config 508807 and rejected config 27f795 as incumbent because it is not better than the incumbents on 1 instances:
[INFO][smbo.py:320] Finished 100 trials.
{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0014600474372, 'e_layers': 3, 'learning_rate': 0.0001170962273, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9533073
	speed: 0.0108s/iter; left time: 87.6465s
	iters: 200, epoch: 1 | loss: 0.3490332
	speed: 0.0043s/iter; left time: 34.5566s
	iters: 300, epoch: 1 | loss: 0.4093513
	speed: 0.0036s/iter; left time: 28.3114s
	iters: 400, epoch: 1 | loss: 0.4004977
	speed: 0.0038s/iter; left time: 29.9034s
	iters: 500, epoch: 1 | loss: 0.7025904
	speed: 0.0105s/iter; left time: 81.3089s
	iters: 600, epoch: 1 | loss: 0.5110203
	speed: 0.0103s/iter; left time: 78.7519s
	iters: 700, epoch: 1 | loss: 0.2275551
	speed: 0.0105s/iter; left time: 78.6192s
	iters: 800, epoch: 1 | loss: 0.3672076
	speed: 0.0048s/iter; left time: 35.8041s
	iters: 900, epoch: 1 | loss: 1.0426776
	speed: 0.0036s/iter; left time: 26.2478s
	iters: 1000, epoch: 1 | loss: 0.4722628
	speed: 0.0038s/iter; left time: 27.2650s
Updating learning rate to 0.0001170962273
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 6.439759254455566
Epoch: 1, Steps: 1027 | Train Loss: 0.5435503 Vali Loss: 0.3709615 Best vali loss: 0.3709615
	iters: 100, epoch: 2 | loss: 1.2018862
	speed: 0.0145s/iter; left time: 102.6556s
	iters: 200, epoch: 2 | loss: 0.2060612
	speed: 0.0051s/iter; left time: 35.9443s
	iters: 300, epoch: 2 | loss: 1.1248611
	speed: 0.0052s/iter; left time: 35.8421s
	iters: 400, epoch: 2 | loss: 0.5416381
	speed: 0.0048s/iter; left time: 32.4584s
	iters: 500, epoch: 2 | loss: 0.7307346
	speed: 0.0051s/iter; left time: 33.9422s
	iters: 600, epoch: 2 | loss: 0.2937230
	speed: 0.0049s/iter; left time: 32.4252s
	iters: 700, epoch: 2 | loss: 0.9319217
	speed: 0.0049s/iter; left time: 31.9109s
	iters: 800, epoch: 2 | loss: 0.4671112
	speed: 0.0052s/iter; left time: 33.4597s
	iters: 900, epoch: 2 | loss: 0.8661289
	speed: 0.0047s/iter; left time: 29.8312s
	iters: 1000, epoch: 2 | loss: 0.5039011
	speed: 0.0045s/iter; left time: 27.8938s
Updating learning rate to 5.854811365e-05
Validation loss decreased (0.3710 --> 0.3695).  Saving model state dict ...
Epoch: 2 cost time: 5.123884916305542
Epoch: 2, Steps: 1027 | Train Loss: 0.6867967 Vali Loss: 0.3694668 Best vali loss: 0.3694668
	iters: 100, epoch: 3 | loss: 0.7943698
	speed: 0.0140s/iter; left time: 84.8794s
	iters: 200, epoch: 3 | loss: 2.2168097
	speed: 0.0044s/iter; left time: 26.3690s
	iters: 300, epoch: 3 | loss: 1.2893294
	speed: 0.0051s/iter; left time: 29.8567s
	iters: 400, epoch: 3 | loss: 0.4143263
	speed: 0.0053s/iter; left time: 30.3623s
	iters: 500, epoch: 3 | loss: 0.9958310
	speed: 0.0052s/iter; left time: 29.6569s
	iters: 600, epoch: 3 | loss: 0.4387990
	speed: 0.0052s/iter; left time: 29.1756s
	iters: 700, epoch: 3 | loss: 1.0496808
	speed: 0.0052s/iter; left time: 28.6198s
	iters: 800, epoch: 3 | loss: 0.2341029
	speed: 0.0053s/iter; left time: 28.3887s
	iters: 900, epoch: 3 | loss: 0.4016824
	speed: 0.0053s/iter; left time: 27.6816s
	iters: 1000, epoch: 3 | loss: 0.2906342
	speed: 0.0053s/iter; left time: 27.4323s
Updating learning rate to 2.9274056825e-05
Validation loss decreased (0.3695 --> 0.3683).  Saving model state dict ...
Epoch: 3 cost time: 5.294468879699707
Epoch: 3, Steps: 1027 | Train Loss: 0.8125565 Vali Loss: 0.3683379 Best vali loss: 0.3683379
	iters: 100, epoch: 4 | loss: 0.5964605
	speed: 0.0148s/iter; left time: 74.4610s
	iters: 200, epoch: 4 | loss: 1.3215190
	speed: 0.0048s/iter; left time: 23.6720s
	iters: 300, epoch: 4 | loss: 0.3896130
	speed: 0.0051s/iter; left time: 24.7260s
	iters: 400, epoch: 4 | loss: 0.8353927
	speed: 0.0052s/iter; left time: 24.4685s
	iters: 500, epoch: 4 | loss: 0.3088812
	speed: 0.0054s/iter; left time: 24.8555s
	iters: 600, epoch: 4 | loss: 1.1276497
	speed: 0.0051s/iter; left time: 22.9178s
	iters: 700, epoch: 4 | loss: 0.3933488
	speed: 0.0049s/iter; left time: 21.8469s
	iters: 800, epoch: 4 | loss: 0.5535644
	speed: 0.0050s/iter; left time: 21.5890s
	iters: 900, epoch: 4 | loss: 0.8962732
	speed: 0.0051s/iter; left time: 21.4773s
	iters: 1000, epoch: 4 | loss: 0.4497793
	speed: 0.0051s/iter; left time: 21.0120s
Updating learning rate to 1.46370284125e-05
Epoch: 4 cost time: 5.2238616943359375
Epoch: 4, Steps: 1027 | Train Loss: 0.6872482 Vali Loss: 0.3692803 Best vali loss: 0.3683379
	iters: 100, epoch: 5 | loss: 0.2374960
	speed: 0.0143s/iter; left time: 57.1663s
	iters: 200, epoch: 5 | loss: 1.2612522
	speed: 0.0052s/iter; left time: 20.3376s
	iters: 300, epoch: 5 | loss: 0.3067217
	speed: 0.0052s/iter; left time: 19.6256s
	iters: 400, epoch: 5 | loss: 0.5110254
	speed: 0.0052s/iter; left time: 19.1905s
	iters: 500, epoch: 5 | loss: 0.6610900
	speed: 0.0051s/iter; left time: 18.4737s
	iters: 600, epoch: 5 | loss: 0.4879827
	speed: 0.0051s/iter; left time: 17.8476s
	iters: 700, epoch: 5 | loss: 0.2697529
	speed: 0.0051s/iter; left time: 17.2862s
	iters: 800, epoch: 5 | loss: 0.5744281
	speed: 0.0051s/iter; left time: 16.7963s
	iters: 900, epoch: 5 | loss: 0.9456656
	speed: 0.0050s/iter; left time: 16.1096s
	iters: 1000, epoch: 5 | loss: 0.5919268
	speed: 0.0050s/iter; left time: 15.5857s
Updating learning rate to 7.31851420625e-06
Epoch: 5 cost time: 5.248031377792358
Epoch: 5, Steps: 1027 | Train Loss: 0.5847341 Vali Loss: 0.3696191 Best vali loss: 0.3683379
	iters: 100, epoch: 6 | loss: 0.5924398
	speed: 0.0144s/iter; left time: 43.0800s
	iters: 200, epoch: 6 | loss: 0.6823587
	speed: 0.0050s/iter; left time: 14.4211s
	iters: 300, epoch: 6 | loss: 0.7261427
	speed: 0.0050s/iter; left time: 13.8323s
	iters: 400, epoch: 6 | loss: 0.3939580
	speed: 0.0049s/iter; left time: 13.2341s
	iters: 500, epoch: 6 | loss: 0.4466816
	speed: 0.0050s/iter; left time: 13.0020s
	iters: 600, epoch: 6 | loss: 0.5251234
	speed: 0.0051s/iter; left time: 12.6256s
	iters: 700, epoch: 6 | loss: 1.2382085
	speed: 0.0051s/iter; left time: 12.0765s
	iters: 800, epoch: 6 | loss: 0.6659809
	speed: 0.0051s/iter; left time: 11.6592s
	iters: 900, epoch: 6 | loss: 0.3180747
	speed: 0.0051s/iter; left time: 11.1363s
	iters: 1000, epoch: 6 | loss: 1.2461402
	speed: 0.0051s/iter; left time: 10.6059s
Updating learning rate to 3.659257103125e-06
Epoch: 6 cost time: 5.205286979675293
Epoch: 6, Steps: 1027 | Train Loss: 0.6835109 Vali Loss: 0.3694029 Best vali loss: 0.3683379
	iters: 100, epoch: 7 | loss: 0.5123677
	speed: 0.0144s/iter; left time: 28.1534s
	iters: 200, epoch: 7 | loss: 1.1134268
	speed: 0.0050s/iter; left time: 9.3526s
	iters: 300, epoch: 7 | loss: 0.6484560
	speed: 0.0051s/iter; left time: 8.9021s
	iters: 400, epoch: 7 | loss: 0.6424720
	speed: 0.0051s/iter; left time: 8.3979s
	iters: 500, epoch: 7 | loss: 1.0741386
	speed: 0.0051s/iter; left time: 7.9387s
	iters: 600, epoch: 7 | loss: 0.7680635
	speed: 0.0052s/iter; left time: 7.5394s
	iters: 700, epoch: 7 | loss: 0.2981430
	speed: 0.0051s/iter; left time: 6.8783s
	iters: 800, epoch: 7 | loss: 0.6847150
	speed: 0.0052s/iter; left time: 6.5433s
	iters: 900, epoch: 7 | loss: 0.3813806
	speed: 0.0051s/iter; left time: 5.9007s
	iters: 1000, epoch: 7 | loss: 0.3870853
	speed: 0.0048s/iter; left time: 5.0815s
Updating learning rate to 1.8296285515625e-06
Epoch: 7 cost time: 5.272909641265869
Epoch: 7, Steps: 1027 | Train Loss: 0.6510249 Vali Loss: 0.3696785 Best vali loss: 0.3683379
	iters: 100, epoch: 8 | loss: 0.7171725
	speed: 0.0151s/iter; left time: 13.9746s
	iters: 200, epoch: 8 | loss: 1.2933840
	speed: 0.0050s/iter; left time: 4.1527s
	iters: 300, epoch: 8 | loss: 0.7899806
	speed: 0.0051s/iter; left time: 3.7123s
	iters: 400, epoch: 8 | loss: 0.8030658
	speed: 0.0052s/iter; left time: 3.2591s
	iters: 500, epoch: 8 | loss: 0.9884964
	speed: 0.0052s/iter; left time: 2.7376s
	iters: 600, epoch: 8 | loss: 0.2248987
	speed: 0.0051s/iter; left time: 2.1800s
	iters: 700, epoch: 8 | loss: 0.8105674
	speed: 0.0050s/iter; left time: 1.6396s
	iters: 800, epoch: 8 | loss: 0.5830375
	speed: 0.0051s/iter; left time: 1.1570s
	iters: 900, epoch: 8 | loss: 1.5705432
	speed: 0.0048s/iter; left time: 0.6128s
	iters: 1000, epoch: 8 | loss: 1.6589397
	speed: 0.0050s/iter; left time: 0.1395s
Updating learning rate to 9.1481427578125e-07
Epoch: 8 cost time: 5.231338739395142
Epoch: 8, Steps: 1027 | Train Loss: 0.9440086 Vali Loss: 0.3696819 Best vali loss: 0.3683379

best validation loss 0.36833786318016426

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0008001774243, 'e_layers': 4, 'learning_rate': 8.14780285e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4625934
	speed: 0.0157s/iter; left time: 30.8217s
	iters: 200, epoch: 1 | loss: 0.5493234
	speed: 0.0095s/iter; left time: 17.6600s
Updating learning rate to 8.14780285e-05
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 2.7842705249786377
Epoch: 1, Steps: 257 | Train Loss: 0.5059584 Vali Loss: 0.3672982 Best vali loss: 0.3672982
	iters: 100, epoch: 2 | loss: 0.5997803
	speed: 0.0200s/iter; left time: 33.9184s
	iters: 200, epoch: 2 | loss: 0.6827573
	speed: 0.0094s/iter; left time: 15.0863s
Updating learning rate to 4.073901425e-05
Epoch: 2 cost time: 2.4798645973205566
Epoch: 2, Steps: 257 | Train Loss: 0.6412688 Vali Loss: 0.3975929 Best vali loss: 0.3672982
	iters: 100, epoch: 3 | loss: 0.5861010
	speed: 0.0196s/iter; left time: 28.2832s
	iters: 200, epoch: 3 | loss: 0.6312942
	speed: 0.0096s/iter; left time: 12.8436s
Updating learning rate to 2.0369507125e-05
Epoch: 3 cost time: 2.4715044498443604
Epoch: 3, Steps: 257 | Train Loss: 0.6086976 Vali Loss: 0.3755197 Best vali loss: 0.3672982
	iters: 100, epoch: 4 | loss: 0.3598687
	speed: 0.0198s/iter; left time: 23.4687s
	iters: 200, epoch: 4 | loss: 0.5892345
	speed: 0.0094s/iter; left time: 10.2547s
Updating learning rate to 1.01847535625e-05
Epoch: 4 cost time: 2.5013489723205566
Epoch: 4, Steps: 257 | Train Loss: 0.4745516 Vali Loss: 0.3817162 Best vali loss: 0.3672982
	iters: 100, epoch: 5 | loss: 0.4775228
	speed: 0.0200s/iter; left time: 18.5614s
	iters: 200, epoch: 5 | loss: 0.4406305
	speed: 0.0095s/iter; left time: 7.8948s
Updating learning rate to 5.09237678125e-06
Epoch: 5 cost time: 2.515852928161621
Epoch: 5, Steps: 257 | Train Loss: 0.4590766 Vali Loss: 0.3911834 Best vali loss: 0.3672982
	iters: 100, epoch: 6 | loss: 0.5631643
	speed: 0.0192s/iter; left time: 12.9096s
	iters: 200, epoch: 6 | loss: 0.3196456
	speed: 0.0093s/iter; left time: 5.2988s
Updating learning rate to 2.546188390625e-06
Epoch: 6 cost time: 2.355847120285034
Epoch: 6, Steps: 257 | Train Loss: 0.4414049 Vali Loss: 0.3873466 Best vali loss: 0.3672982
	iters: 100, epoch: 7 | loss: 0.2849335
	speed: 0.0219s/iter; left time: 9.0992s
	iters: 200, epoch: 7 | loss: 0.4175725
	speed: 0.0150s/iter; left time: 4.7223s
Updating learning rate to 1.2730941953125e-06
Epoch: 7 cost time: 3.7539799213409424
Epoch: 7, Steps: 257 | Train Loss: 0.3512530 Vali Loss: 0.3865141 Best vali loss: 0.3672982
	iters: 100, epoch: 8 | loss: 0.3254045
	speed: 0.0279s/iter; left time: 4.4096s
	iters: 200, epoch: 8 | loss: 0.6737150
	speed: 0.0151s/iter; left time: 0.8742s
Updating learning rate to 6.3654709765625e-07
Epoch: 8 cost time: 3.83746075630188
Epoch: 8, Steps: 257 | Train Loss: 0.4995598 Vali Loss: 0.3847957 Best vali loss: 0.3672982

best validation loss 0.36729818363555056

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0042555642414, 'e_layers': 4, 'learning_rate': 0.0033451766027, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4137295
	speed: 0.0160s/iter; left time: 129.5476s
	iters: 200, epoch: 1 | loss: 0.7921283
	speed: 0.0071s/iter; left time: 56.7922s
	iters: 300, epoch: 1 | loss: 0.4966547
	speed: 0.0083s/iter; left time: 65.8825s
	iters: 400, epoch: 1 | loss: 0.4411487
	speed: 0.0098s/iter; left time: 76.7257s
	iters: 500, epoch: 1 | loss: 1.0970889
	speed: 0.0090s/iter; left time: 69.0842s
	iters: 600, epoch: 1 | loss: 0.5580640
	speed: 0.0088s/iter; left time: 67.3060s
	iters: 700, epoch: 1 | loss: 1.6732651
	speed: 0.0098s/iter; left time: 73.7327s
	iters: 800, epoch: 1 | loss: 1.0615726
	speed: 0.0090s/iter; left time: 66.6744s
	iters: 900, epoch: 1 | loss: 0.8243638
	speed: 0.0080s/iter; left time: 58.5605s
	iters: 1000, epoch: 1 | loss: 1.1913971
	speed: 0.0098s/iter; left time: 70.8145s
Updating learning rate to 0.0032178583992850856
Validation loss decreased (inf --> 0.3876).  Saving model state dict ...
Epoch: 1 cost time: 9.576292276382446
Epoch: 1, Steps: 1027 | Train Loss: 0.8549413 Vali Loss: 0.3876030 Best vali loss: 0.3876030
	iters: 100, epoch: 2 | loss: 1.1327875
	speed: 0.0261s/iter; left time: 185.0916s
	iters: 200, epoch: 2 | loss: 0.9920700
	speed: 0.0098s/iter; left time: 68.6279s
	iters: 300, epoch: 2 | loss: 0.7965595
	speed: 0.0066s/iter; left time: 45.3484s
	iters: 400, epoch: 2 | loss: 0.3260955
	speed: 0.0098s/iter; left time: 66.8223s
	iters: 500, epoch: 2 | loss: 0.4094163
	speed: 0.0098s/iter; left time: 65.7886s
	iters: 600, epoch: 2 | loss: 0.9795572
	speed: 0.0077s/iter; left time: 50.8492s
	iters: 700, epoch: 2 | loss: 0.8767156
	speed: 0.0048s/iter; left time: 31.2155s
	iters: 800, epoch: 2 | loss: 0.3827100
	speed: 0.0051s/iter; left time: 32.3842s
	iters: 900, epoch: 2 | loss: 0.3968764
	speed: 0.0062s/iter; left time: 38.8848s
	iters: 1000, epoch: 2 | loss: 1.0710800
	speed: 0.0061s/iter; left time: 37.9440s
Updating learning rate to 0.0028552868313678737
Epoch: 2 cost time: 7.803112268447876
Epoch: 2, Steps: 1027 | Train Loss: 0.7363868 Vali Loss: 0.4011818 Best vali loss: 0.3876030
	iters: 100, epoch: 3 | loss: 0.3677061
	speed: 0.0169s/iter; left time: 102.2025s
	iters: 200, epoch: 3 | loss: 0.3568228
	speed: 0.0060s/iter; left time: 36.0659s
	iters: 300, epoch: 3 | loss: 0.8300208
	speed: 0.0061s/iter; left time: 35.7786s
	iters: 400, epoch: 3 | loss: 0.2863455
	speed: 0.0061s/iter; left time: 35.1195s
	iters: 500, epoch: 3 | loss: 1.3210938
	speed: 0.0061s/iter; left time: 34.3267s
	iters: 600, epoch: 3 | loss: 0.6850128
	speed: 0.0058s/iter; left time: 32.2953s
	iters: 700, epoch: 3 | loss: 0.5076115
	speed: 0.0057s/iter; left time: 31.2454s
	iters: 800, epoch: 3 | loss: 0.2181718
	speed: 0.0062s/iter; left time: 33.1364s
	iters: 900, epoch: 3 | loss: 1.7751085
	speed: 0.0061s/iter; left time: 32.0831s
	iters: 1000, epoch: 3 | loss: 1.2966903
	speed: 0.0061s/iter; left time: 31.3199s
Updating learning rate to 0.0023126601334443136
Validation loss decreased (0.3876 --> 0.3763).  Saving model state dict ...
Epoch: 3 cost time: 6.236653089523315
Epoch: 3, Steps: 1027 | Train Loss: 0.7644584 Vali Loss: 0.3763292 Best vali loss: 0.3763292

best validation loss 0.3763292099790161

{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0023938699804, 'e_layers': 1, 'learning_rate': 0.0016732396603, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8646170
	speed: 0.0095s/iter; left time: 18.5309s
	iters: 200, epoch: 1 | loss: 0.8712357
	speed: 0.0036s/iter; left time: 6.6528s
Updating learning rate to 0.0016095557677186542
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.2349252700805664
Epoch: 1, Steps: 257 | Train Loss: 0.8679264 Vali Loss: 0.3690726 Best vali loss: 0.3690726
	iters: 100, epoch: 2 | loss: 0.4688489
	speed: 0.0092s/iter; left time: 15.5938s
	iters: 200, epoch: 2 | loss: 0.8148702
	speed: 0.0038s/iter; left time: 6.0495s
Updating learning rate to 0.0014281993853242025
Epoch: 2 cost time: 1.0347442626953125
Epoch: 2, Steps: 257 | Train Loss: 0.6418595 Vali Loss: 0.3844460 Best vali loss: 0.3690726
	iters: 100, epoch: 3 | loss: 0.5895157
	speed: 0.0098s/iter; left time: 14.1463s
	iters: 200, epoch: 3 | loss: 0.8811371
	speed: 0.0041s/iter; left time: 5.5364s
Updating learning rate to 0.0011567803783365004
Epoch: 3 cost time: 1.100614309310913
Epoch: 3, Steps: 257 | Train Loss: 0.7353264 Vali Loss: 0.3777638 Best vali loss: 0.3690726

best validation loss 0.36907261937915226

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.2493540
	speed: 0.0088s/iter; left time: 71.6086s
	iters: 200, epoch: 1 | loss: 1.2329007
	speed: 0.0031s/iter; left time: 24.7418s
	iters: 300, epoch: 1 | loss: 0.4188052
	speed: 0.0031s/iter; left time: 24.6652s
	iters: 400, epoch: 1 | loss: 0.8669213
	speed: 0.0031s/iter; left time: 24.1133s
	iters: 500, epoch: 1 | loss: 0.3156043
	speed: 0.0031s/iter; left time: 23.8526s
	iters: 600, epoch: 1 | loss: 0.3809758
	speed: 0.0031s/iter; left time: 23.6076s
	iters: 700, epoch: 1 | loss: 0.5941271
	speed: 0.0031s/iter; left time: 23.2125s
	iters: 800, epoch: 1 | loss: 1.5011317
	speed: 0.0031s/iter; left time: 22.6595s
	iters: 900, epoch: 1 | loss: 0.4150397
	speed: 0.0031s/iter; left time: 22.7985s
	iters: 1000, epoch: 1 | loss: 0.2964819
	speed: 0.0031s/iter; left time: 22.5819s
Updating learning rate to 0.0002485111429
Validation loss decreased (inf --> 0.3639).  Saving model state dict ...
Epoch: 1 cost time: 3.492032289505005
Epoch: 1, Steps: 1027 | Train Loss: 0.7271342 Vali Loss: 0.3639056 Best vali loss: 0.3639056
	iters: 100, epoch: 2 | loss: 0.4163058
	speed: 0.0114s/iter; left time: 80.6446s
	iters: 200, epoch: 2 | loss: 1.0537742
	speed: 0.0027s/iter; left time: 18.8439s
	iters: 300, epoch: 2 | loss: 0.2531564
	speed: 0.0026s/iter; left time: 17.8054s
	iters: 400, epoch: 2 | loss: 0.2813052
	speed: 0.0027s/iter; left time: 18.1712s
	iters: 500, epoch: 2 | loss: 0.4183045
	speed: 0.0025s/iter; left time: 16.4340s
	iters: 600, epoch: 2 | loss: 0.4720384
	speed: 0.0024s/iter; left time: 15.8331s
	iters: 700, epoch: 2 | loss: 0.2617521
	speed: 0.0025s/iter; left time: 16.1702s
	iters: 800, epoch: 2 | loss: 0.2714826
	speed: 0.0031s/iter; left time: 19.7080s
	iters: 900, epoch: 2 | loss: 0.2953103
	speed: 0.0036s/iter; left time: 22.8045s
	iters: 1000, epoch: 2 | loss: 0.2459270
	speed: 0.0036s/iter; left time: 22.2681s
Updating learning rate to 0.00012425557145
Epoch: 2 cost time: 2.991279363632202
Epoch: 2, Steps: 1027 | Train Loss: 0.3969357 Vali Loss: 0.3645739 Best vali loss: 0.3639056
	iters: 100, epoch: 3 | loss: 0.6336522
	speed: 0.0114s/iter; left time: 68.8966s
	iters: 200, epoch: 3 | loss: 0.3568536
	speed: 0.0026s/iter; left time: 15.6324s
	iters: 300, epoch: 3 | loss: 0.2741523
	speed: 0.0035s/iter; left time: 20.4593s
	iters: 400, epoch: 3 | loss: 1.0508689
	speed: 0.0034s/iter; left time: 19.7391s
	iters: 500, epoch: 3 | loss: 0.4567376
	speed: 0.0027s/iter; left time: 15.5307s
	iters: 600, epoch: 3 | loss: 0.4522794
	speed: 0.0023s/iter; left time: 12.5756s
	iters: 700, epoch: 3 | loss: 1.4583783
	speed: 0.0022s/iter; left time: 11.9776s
	iters: 800, epoch: 3 | loss: 0.5012896
	speed: 0.0023s/iter; left time: 12.0911s
	iters: 900, epoch: 3 | loss: 0.9575522
	speed: 0.0024s/iter; left time: 12.6996s
	iters: 1000, epoch: 3 | loss: 0.3169878
	speed: 0.0032s/iter; left time: 16.3939s
Updating learning rate to 6.2127785725e-05
Epoch: 3 cost time: 2.9393742084503174
Epoch: 3, Steps: 1027 | Train Loss: 0.6458752 Vali Loss: 0.3735436 Best vali loss: 0.3639056

best validation loss 0.3639055895547736

{'batch_size': 8, 'd_core': 256, 'd_model': 512, 'dropout': 0.0117580472285, 'e_layers': 1, 'learning_rate': 0.0002485111429, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.9649649
	speed: 0.0094s/iter; left time: 47.3384s
	iters: 200, epoch: 4 | loss: 0.8623313
	speed: 0.0030s/iter; left time: 14.6372s
	iters: 300, epoch: 4 | loss: 0.2948775
	speed: 0.0025s/iter; left time: 12.2069s
	iters: 400, epoch: 4 | loss: 0.7204695
	speed: 0.0026s/iter; left time: 12.4729s
	iters: 500, epoch: 4 | loss: 0.2868160
	speed: 0.0030s/iter; left time: 13.6875s
	iters: 600, epoch: 4 | loss: 0.3097471
	speed: 0.0035s/iter; left time: 16.0425s
	iters: 700, epoch: 4 | loss: 0.5056774
	speed: 0.0035s/iter; left time: 15.4363s
	iters: 800, epoch: 4 | loss: 0.8913954
	speed: 0.0034s/iter; left time: 14.7677s
	iters: 900, epoch: 4 | loss: 0.2624161
	speed: 0.0036s/iter; left time: 15.0660s
	iters: 1000, epoch: 4 | loss: 0.2591983
	speed: 0.0035s/iter; left time: 14.4669s
Updating learning rate to 3.10638928625e-05
Epoch: 4 cost time: 3.599674940109253
Epoch: 4, Steps: 1027 | Train Loss: 0.5357894 Vali Loss: 0.3839003 Best vali loss: 0.3639056
	iters: 100, epoch: 5 | loss: 0.4050738
	speed: 0.0131s/iter; left time: 52.6667s
	iters: 200, epoch: 5 | loss: 0.7296615
	speed: 0.0027s/iter; left time: 10.7274s
	iters: 300, epoch: 5 | loss: 0.2521057
	speed: 0.0030s/iter; left time: 11.3132s
	iters: 400, epoch: 5 | loss: 0.2619033
	speed: 0.0034s/iter; left time: 12.7835s
	iters: 500, epoch: 5 | loss: 0.3288157
	speed: 0.0034s/iter; left time: 12.2578s
	iters: 600, epoch: 5 | loss: 0.4418341
	speed: 0.0035s/iter; left time: 12.3494s
	iters: 700, epoch: 5 | loss: 0.2497215
	speed: 0.0035s/iter; left time: 11.7736s
	iters: 800, epoch: 5 | loss: 0.2553479
	speed: 0.0034s/iter; left time: 11.1355s
	iters: 900, epoch: 5 | loss: 0.2471697
	speed: 0.0033s/iter; left time: 10.7186s
	iters: 1000, epoch: 5 | loss: 0.2255675
	speed: 0.0033s/iter; left time: 10.1997s
Updating learning rate to 1.553194643125e-05
Epoch: 5 cost time: 3.395219087600708
Epoch: 5, Steps: 1027 | Train Loss: 0.3397201 Vali Loss: 0.3875898 Best vali loss: 0.3639056
	iters: 100, epoch: 6 | loss: 0.5486127
	speed: 0.0111s/iter; left time: 32.9924s
	iters: 200, epoch: 6 | loss: 0.2962304
	speed: 0.0024s/iter; left time: 6.8868s
	iters: 300, epoch: 6 | loss: 0.2486868
	speed: 0.0023s/iter; left time: 6.3814s
	iters: 400, epoch: 6 | loss: 0.9251914
	speed: 0.0025s/iter; left time: 6.5926s
	iters: 500, epoch: 6 | loss: 0.3697937
	speed: 0.0025s/iter; left time: 6.4800s
	iters: 600, epoch: 6 | loss: 0.4047696
	speed: 0.0029s/iter; left time: 7.2377s
	iters: 700, epoch: 6 | loss: 1.3197854
	speed: 0.0034s/iter; left time: 8.0404s
	iters: 800, epoch: 6 | loss: 0.4114416
	speed: 0.0036s/iter; left time: 8.1118s
	iters: 900, epoch: 6 | loss: 0.8074986
	speed: 0.0034s/iter; left time: 7.4282s
	iters: 1000, epoch: 6 | loss: 0.2970352
	speed: 0.0032s/iter; left time: 6.7571s
Updating learning rate to 7.765973215625e-06
Epoch: 6 cost time: 3.009345531463623
Epoch: 6, Steps: 1027 | Train Loss: 0.5629045 Vali Loss: 0.3868083 Best vali loss: 0.3639056
	iters: 100, epoch: 7 | loss: 0.4626084
	speed: 0.0135s/iter; left time: 26.3989s
	iters: 200, epoch: 7 | loss: 0.5554924
	speed: 0.0032s/iter; left time: 5.9192s
	iters: 300, epoch: 7 | loss: 0.2750563
	speed: 0.0027s/iter; left time: 4.7049s
	iters: 400, epoch: 7 | loss: 0.3028250
	speed: 0.0027s/iter; left time: 4.5396s
	iters: 500, epoch: 7 | loss: 0.3763298
	speed: 0.0031s/iter; left time: 4.8479s
	iters: 600, epoch: 7 | loss: 0.3475327
	speed: 0.0038s/iter; left time: 5.5014s
	iters: 700, epoch: 7 | loss: 0.2107269
	speed: 0.0035s/iter; left time: 4.7975s
	iters: 800, epoch: 7 | loss: 0.4396582
	speed: 0.0035s/iter; left time: 4.4293s
	iters: 900, epoch: 7 | loss: 0.7459586
	speed: 0.0034s/iter; left time: 3.9238s
	iters: 1000, epoch: 7 | loss: 0.5737377
	speed: 0.0034s/iter; left time: 3.5786s
Updating learning rate to 3.8829866078125e-06
Epoch: 7 cost time: 3.444889783859253
Epoch: 7, Steps: 1027 | Train Loss: 0.4289926 Vali Loss: 0.3866791 Best vali loss: 0.3639056
	iters: 100, epoch: 8 | loss: 0.2517202
	speed: 0.0130s/iter; left time: 12.1049s
	iters: 200, epoch: 8 | loss: 0.4812072
	speed: 0.0024s/iter; left time: 1.9762s
	iters: 300, epoch: 8 | loss: 0.3471120
	speed: 0.0024s/iter; left time: 1.7510s
	iters: 400, epoch: 8 | loss: 1.0529354
	speed: 0.0024s/iter; left time: 1.5223s
	iters: 500, epoch: 8 | loss: 0.2798854
	speed: 0.0034s/iter; left time: 1.8030s
	iters: 600, epoch: 8 | loss: 0.2885472
	speed: 0.0035s/iter; left time: 1.5128s
	iters: 700, epoch: 8 | loss: 0.5880108
	speed: 0.0034s/iter; left time: 1.1185s
	iters: 800, epoch: 8 | loss: 0.6809649
	speed: 0.0032s/iter; left time: 0.7306s
	iters: 900, epoch: 8 | loss: 0.8791522
	speed: 0.0032s/iter; left time: 0.4092s
	iters: 1000, epoch: 8 | loss: 0.2161835
	speed: 0.0032s/iter; left time: 0.0892s
Updating learning rate to 1.94149330390625e-06
Epoch: 8 cost time: 3.206455945968628
Epoch: 8, Steps: 1027 | Train Loss: 0.5065719 Vali Loss: 0.3888107 Best vali loss: 0.3639056

best validation loss 0.3639055895547736

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0010455579744, 'e_layers': 2, 'learning_rate': 0.0031326137071, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6998032
	speed: 0.0131s/iter; left time: 12.2156s
Updating learning rate to 0.0030133856971769984
Validation loss decreased (inf --> 0.3990).  Saving model state dict ...
Epoch: 1 cost time: 1.2221729755401611
Epoch: 1, Steps: 129 | Train Loss: 0.6998032 Vali Loss: 0.3990243 Best vali loss: 0.3990243
	iters: 100, epoch: 2 | loss: 0.6958148
	speed: 0.0122s/iter; left time: 9.7926s
Updating learning rate to 0.0026738530511141692
Epoch: 2 cost time: 0.9321691989898682
Epoch: 2, Steps: 129 | Train Loss: 0.6958148 Vali Loss: 0.4038393 Best vali loss: 0.3990243
	iters: 100, epoch: 3 | loss: 0.8908224
	speed: 0.0119s/iter; left time: 8.0510s
Updating learning rate to 0.002165706536403478
Epoch: 3 cost time: 0.9284584522247314
Epoch: 3, Steps: 129 | Train Loss: 0.8908224 Vali Loss: 0.4086203 Best vali loss: 0.3990243
	iters: 100, epoch: 4 | loss: 0.8052298
	speed: 0.0120s/iter; left time: 6.5548s
Updating learning rate to 0.00156630685355
Epoch: 4 cost time: 0.9075636863708496
Epoch: 4, Steps: 129 | Train Loss: 0.8052298 Vali Loss: 0.4141974 Best vali loss: 0.3990243
	iters: 100, epoch: 5 | loss: 0.4181803
	speed: 0.0113s/iter; left time: 4.7090s
Updating learning rate to 0.000966907170696522
Epoch: 5 cost time: 0.8762176036834717
Epoch: 5, Steps: 129 | Train Loss: 0.4181803 Vali Loss: 0.4041618 Best vali loss: 0.3990243
	iters: 100, epoch: 6 | loss: 0.6124107
	speed: 0.0119s/iter; left time: 3.4188s
Updating learning rate to 0.0004587606559858305
Epoch: 6 cost time: 0.9273571968078613
Epoch: 6, Steps: 129 | Train Loss: 0.6124107 Vali Loss: 0.4084533 Best vali loss: 0.3990243
	iters: 100, epoch: 7 | loss: 0.5140570
	speed: 0.0121s/iter; left time: 1.9235s
Updating learning rate to 0.00011922800992300154
Epoch: 7 cost time: 0.9483847618103027
Epoch: 7, Steps: 129 | Train Loss: 0.5140570 Vali Loss: 0.3993886 Best vali loss: 0.3990243
	iters: 100, epoch: 8 | loss: 0.6705227
	speed: 0.0120s/iter; left time: 0.3613s
Updating learning rate to 0.0
Validation loss decreased (0.3990 --> 0.3931).  Saving model state dict ...
Epoch: 8 cost time: 0.9352385997772217
Epoch: 8, Steps: 129 | Train Loss: 0.6705227 Vali Loss: 0.3931205 Best vali loss: 0.3931205

best validation loss 0.39312050456148234

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014539170207, 'e_layers': 1, 'learning_rate': 0.0026890067218, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4157002
	speed: 0.0093s/iter; left time: 8.6687s
Updating learning rate to 0.0025866624974281455
Validation loss decreased (inf --> 0.3979).  Saving model state dict ...
Epoch: 1 cost time: 0.7429366111755371
Epoch: 1, Steps: 129 | Train Loss: 0.4157002 Vali Loss: 0.3978504 Best vali loss: 0.3978504
	iters: 100, epoch: 2 | loss: 0.5635052
	speed: 0.0061s/iter; left time: 4.8703s
Updating learning rate to 0.002295210804720494
Validation loss decreased (0.3979 --> 0.3793).  Saving model state dict ...
Epoch: 2 cost time: 0.5550820827484131
Epoch: 2, Steps: 129 | Train Loss: 0.5635052 Vali Loss: 0.3793088 Best vali loss: 0.3793088
	iters: 100, epoch: 3 | loss: 0.5687490
	speed: 0.0111s/iter; left time: 7.4938s
Updating learning rate to 0.001859022521875611
Epoch: 3 cost time: 0.7621119022369385
Epoch: 3, Steps: 129 | Train Loss: 0.5687490 Vali Loss: 0.3855253 Best vali loss: 0.3793088
	iters: 100, epoch: 4 | loss: 0.6231016
	speed: 0.0109s/iter; left time: 5.9249s
Updating learning rate to 0.0013445033609
Epoch: 4 cost time: 0.8653757572174072
Epoch: 4, Steps: 129 | Train Loss: 0.6231016 Vali Loss: 0.3930238 Best vali loss: 0.3793088
	iters: 100, epoch: 5 | loss: 0.5705624
	speed: 0.0109s/iter; left time: 4.5425s
Updating learning rate to 0.000829984199924389
Epoch: 5 cost time: 0.9504187107086182
Epoch: 5, Steps: 129 | Train Loss: 0.5705624 Vali Loss: 0.3968115 Best vali loss: 0.3793088
	iters: 100, epoch: 6 | loss: 0.7121060
	speed: 0.0114s/iter; left time: 3.2906s
Updating learning rate to 0.00039379591707950604
Epoch: 6 cost time: 0.8996734619140625
Epoch: 6, Steps: 129 | Train Loss: 0.7121060 Vali Loss: 0.4025388 Best vali loss: 0.3793088
	iters: 100, epoch: 7 | loss: 0.3427685
	speed: 0.0105s/iter; left time: 1.6725s
Updating learning rate to 0.00010234422437185415
Epoch: 7 cost time: 0.828453779220581
Epoch: 7, Steps: 129 | Train Loss: 0.3427685 Vali Loss: 0.4129519 Best vali loss: 0.3793088
	iters: 100, epoch: 8 | loss: 0.3467759
	speed: 0.0105s/iter; left time: 0.3138s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8290643692016602
Epoch: 8, Steps: 129 | Train Loss: 0.3467759 Vali Loss: 0.4197455 Best vali loss: 0.3793088

best validation loss 0.37930878596362055

{'batch_size': 16, 'd_core': 64, 'd_model': 32, 'dropout': 0.0051563633661, 'e_layers': 4, 'learning_rate': 0.0001081267842, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9270530
	speed: 0.0147s/iter; left time: 58.7950s
	iters: 200, epoch: 1 | loss: 0.3514820
	speed: 0.0081s/iter; left time: 31.6147s
	iters: 300, epoch: 1 | loss: 1.0351568
	speed: 0.0049s/iter; left time: 18.5579s
	iters: 400, epoch: 1 | loss: 0.8241409
	speed: 0.0054s/iter; left time: 20.0533s
	iters: 500, epoch: 1 | loss: 0.8015661
	speed: 0.0070s/iter; left time: 25.3461s
Updating learning rate to 0.00010401145351932239
Validation loss decreased (inf --> 0.3945).  Saving model state dict ...
Epoch: 1 cost time: 3.799307107925415
Epoch: 1, Steps: 514 | Train Loss: 0.7878798 Vali Loss: 0.3944591 Best vali loss: 0.3944591
	iters: 100, epoch: 2 | loss: 0.3071762
	speed: 0.0148s/iter; left time: 51.8008s
	iters: 200, epoch: 2 | loss: 0.9339597
	speed: 0.0067s/iter; left time: 22.6056s
	iters: 300, epoch: 2 | loss: 0.3875001
	speed: 0.0069s/iter; left time: 22.8173s
	iters: 400, epoch: 2 | loss: 0.5645691
	speed: 0.0068s/iter; left time: 21.6101s
	iters: 500, epoch: 2 | loss: 0.4499845
	speed: 0.0068s/iter; left time: 21.0446s
Updating learning rate to 9.229198326785722e-05
Validation loss decreased (0.3945 --> 0.3802).  Saving model state dict ...
Epoch: 2 cost time: 3.566736936569214
Epoch: 2, Steps: 514 | Train Loss: 0.5286379 Vali Loss: 0.3802449 Best vali loss: 0.3802449
	iters: 100, epoch: 3 | loss: 0.6381794
	speed: 0.0148s/iter; left time: 44.0499s
	iters: 200, epoch: 3 | loss: 1.1500769
	speed: 0.0067s/iter; left time: 19.4325s
	iters: 300, epoch: 3 | loss: 0.7667684
	speed: 0.0060s/iter; left time: 16.7410s
	iters: 400, epoch: 3 | loss: 0.5199935
	speed: 0.0048s/iter; left time: 12.9187s
	iters: 500, epoch: 3 | loss: 0.8586222
	speed: 0.0060s/iter; left time: 15.5071s
Updating learning rate to 7.475255655412767e-05
Validation loss decreased (0.3802 --> 0.3728).  Saving model state dict ...
Epoch: 3 cost time: 3.2305915355682373
Epoch: 3, Steps: 514 | Train Loss: 0.7867281 Vali Loss: 0.3727964 Best vali loss: 0.3727964

best validation loss 0.3727964490944838

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3573494
	speed: 0.0098s/iter; left time: 79.1930s
	iters: 200, epoch: 1 | loss: 0.8311587
	speed: 0.0041s/iter; left time: 33.0574s
	iters: 300, epoch: 1 | loss: 0.5557891
	speed: 0.0039s/iter; left time: 30.5225s
	iters: 400, epoch: 1 | loss: 0.7332094
	speed: 0.0037s/iter; left time: 28.9379s
	iters: 500, epoch: 1 | loss: 1.0650693
	speed: 0.0041s/iter; left time: 31.8241s
	iters: 600, epoch: 1 | loss: 2.4576116
	speed: 0.0042s/iter; left time: 31.8845s
	iters: 700, epoch: 1 | loss: 1.1910815
	speed: 0.0042s/iter; left time: 31.3447s
	iters: 800, epoch: 1 | loss: 1.4092376
	speed: 0.0043s/iter; left time: 31.6356s
	iters: 900, epoch: 1 | loss: 0.4268173
	speed: 0.0041s/iter; left time: 30.2847s
	iters: 1000, epoch: 1 | loss: 0.3940021
	speed: 0.0041s/iter; left time: 29.9273s
Updating learning rate to 0.0005849557155
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 4.503127098083496
Epoch: 1, Steps: 1027 | Train Loss: 1.0421326 Vali Loss: 0.3738672 Best vali loss: 0.3738672
	iters: 100, epoch: 2 | loss: 0.3576568
	speed: 0.0129s/iter; left time: 91.3077s
	iters: 200, epoch: 2 | loss: 0.2134239
	speed: 0.0040s/iter; left time: 28.2016s
	iters: 300, epoch: 2 | loss: 0.2943817
	speed: 0.0041s/iter; left time: 28.0165s
	iters: 400, epoch: 2 | loss: 1.0409313
	speed: 0.0040s/iter; left time: 27.1319s
	iters: 500, epoch: 2 | loss: 0.4108764
	speed: 0.0040s/iter; left time: 26.6832s
	iters: 600, epoch: 2 | loss: 1.3751334
	speed: 0.0041s/iter; left time: 26.9258s
	iters: 700, epoch: 2 | loss: 0.5214502
	speed: 0.0040s/iter; left time: 26.0167s
	iters: 800, epoch: 2 | loss: 1.0855238
	speed: 0.0039s/iter; left time: 25.0475s
	iters: 900, epoch: 2 | loss: 0.2972209
	speed: 0.0035s/iter; left time: 21.7505s
	iters: 1000, epoch: 2 | loss: 0.3509991
	speed: 0.0029s/iter; left time: 18.0947s
Updating learning rate to 0.00029247785775
Epoch: 2 cost time: 4.002579927444458
Epoch: 2, Steps: 1027 | Train Loss: 0.5947598 Vali Loss: 0.3761529 Best vali loss: 0.3738672
	iters: 100, epoch: 3 | loss: 0.2648031
	speed: 0.0111s/iter; left time: 67.2948s
	iters: 200, epoch: 3 | loss: 1.2783674
	speed: 0.0038s/iter; left time: 22.9160s
	iters: 300, epoch: 3 | loss: 0.5543953
	speed: 0.0038s/iter; left time: 22.2078s
	iters: 400, epoch: 3 | loss: 0.1866427
	speed: 0.0038s/iter; left time: 22.1739s
	iters: 500, epoch: 3 | loss: 0.4939725
	speed: 0.0039s/iter; left time: 22.1368s
	iters: 600, epoch: 3 | loss: 0.3658468
	speed: 0.0042s/iter; left time: 23.5849s
	iters: 700, epoch: 3 | loss: 0.4481257
	speed: 0.0041s/iter; left time: 22.1808s
	iters: 800, epoch: 3 | loss: 0.2154943
	speed: 0.0041s/iter; left time: 21.9654s
	iters: 900, epoch: 3 | loss: 0.6909571
	speed: 0.0040s/iter; left time: 21.1633s
	iters: 1000, epoch: 3 | loss: 0.4276251
	speed: 0.0037s/iter; left time: 18.8698s
Updating learning rate to 0.000146238928875
Validation loss decreased (0.3739 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 4.082594394683838
Epoch: 3, Steps: 1027 | Train Loss: 0.4926230 Vali Loss: 0.3638763 Best vali loss: 0.3638763

best validation loss 0.36387628850861947

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037417680783, 'e_layers': 4, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0272197
	speed: 0.0115s/iter; left time: 93.7083s
	iters: 200, epoch: 1 | loss: 0.3147579
	speed: 0.0056s/iter; left time: 45.2625s
	iters: 300, epoch: 1 | loss: 0.3357626
	speed: 0.0060s/iter; left time: 47.2800s
	iters: 400, epoch: 1 | loss: 0.3467509
	speed: 0.0059s/iter; left time: 46.0792s
	iters: 500, epoch: 1 | loss: 0.2389168
	speed: 0.0062s/iter; left time: 47.4905s
	iters: 600, epoch: 1 | loss: 0.5099252
	speed: 0.0069s/iter; left time: 52.2830s
	iters: 700, epoch: 1 | loss: 1.6116883
	speed: 0.0067s/iter; left time: 50.4892s
	iters: 800, epoch: 1 | loss: 0.6421367
	speed: 0.0067s/iter; left time: 49.7760s
	iters: 900, epoch: 1 | loss: 0.3195398
	speed: 0.0067s/iter; left time: 48.7040s
	iters: 1000, epoch: 1 | loss: 1.1204170
	speed: 0.0067s/iter; left time: 48.5910s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 6.780328989028931
Epoch: 1, Steps: 1027 | Train Loss: 0.6467115 Vali Loss: 0.3731667 Best vali loss: 0.3731667
	iters: 100, epoch: 2 | loss: 0.3458022
	speed: 0.0163s/iter; left time: 115.8831s
	iters: 200, epoch: 2 | loss: 0.4414844
	speed: 0.0051s/iter; left time: 35.7239s
	iters: 300, epoch: 2 | loss: 0.4887199
	speed: 0.0065s/iter; left time: 44.7663s
	iters: 400, epoch: 2 | loss: 0.9360582
	speed: 0.0065s/iter; left time: 43.8103s
	iters: 500, epoch: 2 | loss: 1.2145381
	speed: 0.0064s/iter; left time: 43.0301s
	iters: 600, epoch: 2 | loss: 0.4464755
	speed: 0.0063s/iter; left time: 41.3441s
	iters: 700, epoch: 2 | loss: 0.8927961
	speed: 0.0063s/iter; left time: 41.0755s
	iters: 800, epoch: 2 | loss: 0.5166640
	speed: 0.0064s/iter; left time: 40.6666s
	iters: 900, epoch: 2 | loss: 0.8605813
	speed: 0.0063s/iter; left time: 39.8195s
	iters: 1000, epoch: 2 | loss: 0.6203205
	speed: 0.0063s/iter; left time: 38.7620s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.3732 --> 0.3666).  Saving model state dict ...
Epoch: 2 cost time: 6.369186878204346
Epoch: 2, Steps: 1027 | Train Loss: 0.6763440 Vali Loss: 0.3665866 Best vali loss: 0.3665866
	iters: 100, epoch: 3 | loss: 0.4868367
	speed: 0.0179s/iter; left time: 108.3475s
	iters: 200, epoch: 3 | loss: 0.3599724
	speed: 0.0061s/iter; left time: 36.1590s
	iters: 300, epoch: 3 | loss: 0.5849835
	speed: 0.0063s/iter; left time: 36.6624s
	iters: 400, epoch: 3 | loss: 0.8401437
	speed: 0.0065s/iter; left time: 37.6034s
	iters: 500, epoch: 3 | loss: 0.4526930
	speed: 0.0066s/iter; left time: 37.1447s
	iters: 600, epoch: 3 | loss: 0.8571578
	speed: 0.0065s/iter; left time: 36.0783s
	iters: 700, epoch: 3 | loss: 0.1808959
	speed: 0.0065s/iter; left time: 35.4400s
	iters: 800, epoch: 3 | loss: 0.3238263
	speed: 0.0063s/iter; left time: 33.9311s
	iters: 900, epoch: 3 | loss: 0.2675368
	speed: 0.0064s/iter; left time: 33.9126s
	iters: 1000, epoch: 3 | loss: 1.4990146
	speed: 0.0064s/iter; left time: 33.2624s
Updating learning rate to 0.0002042442000052176
Epoch: 3 cost time: 6.642982482910156
Epoch: 3, Steps: 1027 | Train Loss: 0.5853061 Vali Loss: 0.3871040 Best vali loss: 0.3665866

best validation loss 0.36658664369161564

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0013187507888, 'e_layers': 2, 'learning_rate': 0.0005849557155, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.3158902
	speed: 0.0100s/iter; left time: 50.3045s
	iters: 200, epoch: 4 | loss: 0.3855391
	speed: 0.0042s/iter; left time: 20.5878s
	iters: 300, epoch: 4 | loss: 0.4906997
	speed: 0.0042s/iter; left time: 20.3816s
	iters: 400, epoch: 4 | loss: 0.7290534
	speed: 0.0042s/iter; left time: 19.7316s
	iters: 500, epoch: 4 | loss: 0.8128611
	speed: 0.0041s/iter; left time: 18.7842s
	iters: 600, epoch: 4 | loss: 2.1616986
	speed: 0.0041s/iter; left time: 18.6016s
	iters: 700, epoch: 4 | loss: 0.8308098
	speed: 0.0041s/iter; left time: 17.9806s
	iters: 800, epoch: 4 | loss: 1.3311965
	speed: 0.0041s/iter; left time: 17.9171s
	iters: 900, epoch: 4 | loss: 0.4089527
	speed: 0.0042s/iter; left time: 17.6772s
	iters: 1000, epoch: 4 | loss: 0.3899667
	speed: 0.0041s/iter; left time: 16.8690s
Updating learning rate to 7.31194644375e-05
Epoch: 4 cost time: 4.5298120975494385
Epoch: 4, Steps: 1027 | Train Loss: 0.8856668 Vali Loss: 0.3812047 Best vali loss: 0.3638763
	iters: 100, epoch: 5 | loss: 0.3394617
	speed: 0.0129s/iter; left time: 51.6235s
	iters: 200, epoch: 5 | loss: 0.2057274
	speed: 0.0032s/iter; left time: 12.4782s
	iters: 300, epoch: 5 | loss: 0.2811260
	speed: 0.0030s/iter; left time: 11.3074s
	iters: 400, epoch: 5 | loss: 0.4803117
	speed: 0.0032s/iter; left time: 11.9164s
	iters: 500, epoch: 5 | loss: 0.4142005
	speed: 0.0041s/iter; left time: 14.7824s
	iters: 600, epoch: 5 | loss: 1.1361260
	speed: 0.0041s/iter; left time: 14.4183s
	iters: 700, epoch: 5 | loss: 0.5341079
	speed: 0.0040s/iter; left time: 13.7554s
	iters: 800, epoch: 5 | loss: 1.0898525
	speed: 0.0042s/iter; left time: 13.8450s
	iters: 900, epoch: 5 | loss: 0.2748956
	speed: 0.0042s/iter; left time: 13.4370s
	iters: 1000, epoch: 5 | loss: 0.3255911
	speed: 0.0042s/iter; left time: 13.0586s
Updating learning rate to 3.655973221875e-05
Epoch: 5 cost time: 3.9875881671905518
Epoch: 5, Steps: 1027 | Train Loss: 0.5081400 Vali Loss: 0.3736019 Best vali loss: 0.3638763
	iters: 100, epoch: 6 | loss: 0.2341770
	speed: 0.0136s/iter; left time: 40.5273s
	iters: 200, epoch: 6 | loss: 1.2839401
	speed: 0.0041s/iter; left time: 11.7675s
	iters: 300, epoch: 6 | loss: 0.4918967
	speed: 0.0041s/iter; left time: 11.3233s
	iters: 400, epoch: 6 | loss: 0.1794205
	speed: 0.0041s/iter; left time: 11.0667s
	iters: 500, epoch: 6 | loss: 0.4882034
	speed: 0.0041s/iter; left time: 10.6070s
	iters: 600, epoch: 6 | loss: 0.3450747
	speed: 0.0041s/iter; left time: 10.2622s
	iters: 700, epoch: 6 | loss: 0.4253161
	speed: 0.0041s/iter; left time: 9.8218s
	iters: 800, epoch: 6 | loss: 0.2320046
	speed: 0.0040s/iter; left time: 9.1755s
	iters: 900, epoch: 6 | loss: 0.6596808
	speed: 0.0041s/iter; left time: 9.0005s
	iters: 1000, epoch: 6 | loss: 0.4009566
	speed: 0.0039s/iter; left time: 8.2172s
Updating learning rate to 1.8279866109375e-05
Epoch: 6 cost time: 4.265962362289429
Epoch: 6, Steps: 1027 | Train Loss: 0.4740671 Vali Loss: 0.3707159 Best vali loss: 0.3638763
	iters: 100, epoch: 7 | loss: 1.0031853
	speed: 0.0126s/iter; left time: 24.6371s
	iters: 200, epoch: 7 | loss: 0.5398881
	speed: 0.0040s/iter; left time: 7.3477s
	iters: 300, epoch: 7 | loss: 0.8475816
	speed: 0.0039s/iter; left time: 6.7718s
	iters: 400, epoch: 7 | loss: 0.2313596
	speed: 0.0039s/iter; left time: 6.5315s
	iters: 500, epoch: 7 | loss: 0.2786344
	speed: 0.0040s/iter; left time: 6.1453s
	iters: 600, epoch: 7 | loss: 0.9336041
	speed: 0.0039s/iter; left time: 5.7356s
	iters: 700, epoch: 7 | loss: 0.5574248
	speed: 0.0040s/iter; left time: 5.3677s
	iters: 800, epoch: 7 | loss: 0.6412405
	speed: 0.0040s/iter; left time: 4.9952s
	iters: 900, epoch: 7 | loss: 0.5440761
	speed: 0.0040s/iter; left time: 4.5854s
	iters: 1000, epoch: 7 | loss: 0.6593850
	speed: 0.0039s/iter; left time: 4.0777s
Updating learning rate to 9.1399330546875e-06
Epoch: 7 cost time: 4.099973201751709
Epoch: 7, Steps: 1027 | Train Loss: 0.6236380 Vali Loss: 0.3664258 Best vali loss: 0.3638763
	iters: 100, epoch: 8 | loss: 0.2683859
	speed: 0.0125s/iter; left time: 11.6409s
	iters: 200, epoch: 8 | loss: 0.5925066
	speed: 0.0041s/iter; left time: 3.3832s
	iters: 300, epoch: 8 | loss: 1.5451311
	speed: 0.0040s/iter; left time: 2.9372s
	iters: 400, epoch: 8 | loss: 0.3187271
	speed: 0.0039s/iter; left time: 2.4353s
	iters: 500, epoch: 8 | loss: 0.9234380
	speed: 0.0041s/iter; left time: 2.1433s
	iters: 600, epoch: 8 | loss: 0.8674508
	speed: 0.0041s/iter; left time: 1.7647s
	iters: 700, epoch: 8 | loss: 0.1990025
	speed: 0.0040s/iter; left time: 1.3207s
	iters: 800, epoch: 8 | loss: 0.3216831
	speed: 0.0042s/iter; left time: 0.9471s
	iters: 900, epoch: 8 | loss: 0.5070227
	speed: 0.0041s/iter; left time: 0.5288s
	iters: 1000, epoch: 8 | loss: 0.2841680
	speed: 0.0039s/iter; left time: 0.1100s
Updating learning rate to 4.56996652734375e-06
Epoch: 8 cost time: 4.205249547958374
Epoch: 8, Steps: 1027 | Train Loss: 0.5827516 Vali Loss: 0.3704463 Best vali loss: 0.3638763

best validation loss 0.36387628850861947

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018403809852, 'e_layers': 2, 'learning_rate': 0.0001571149601, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5492886
	speed: 0.0121s/iter; left time: 11.2624s
Updating learning rate to 0.00015113512799385873
Validation loss decreased (inf --> 0.3979).  Saving model state dict ...
Epoch: 1 cost time: 1.131361722946167
Epoch: 1, Steps: 129 | Train Loss: 0.5492886 Vali Loss: 0.3978618 Best vali loss: 0.3978618
	iters: 100, epoch: 2 | loss: 0.4075652
	speed: 0.0107s/iter; left time: 8.6196s
Updating learning rate to 0.0001341060069062819
Validation loss decreased (0.3979 --> 0.3795).  Saving model state dict ...
Epoch: 2 cost time: 0.8610868453979492
Epoch: 2, Steps: 129 | Train Loss: 0.4075652 Vali Loss: 0.3795432 Best vali loss: 0.3795432
	iters: 100, epoch: 3 | loss: 0.8411161
	speed: 0.0109s/iter; left time: 7.3436s
Updating learning rate to 0.00010862012615348607
Validation loss decreased (0.3795 --> 0.3706).  Saving model state dict ...
Epoch: 3 cost time: 0.8713369369506836
Epoch: 3, Steps: 129 | Train Loss: 0.8411161 Vali Loss: 0.3706339 Best vali loss: 0.3706339
	iters: 100, epoch: 4 | loss: 0.8016710
	speed: 0.0105s/iter; left time: 5.7472s
Updating learning rate to 7.855748005e-05
Validation loss decreased (0.3706 --> 0.3677).  Saving model state dict ...
Epoch: 4 cost time: 0.844743013381958
Epoch: 4, Steps: 129 | Train Loss: 0.8016710 Vali Loss: 0.3676752 Best vali loss: 0.3676752
	iters: 100, epoch: 5 | loss: 0.7003051
	speed: 0.0108s/iter; left time: 4.5070s
Updating learning rate to 4.849483394651394e-05
Validation loss decreased (0.3677 --> 0.3667).  Saving model state dict ...
Epoch: 5 cost time: 0.864037036895752
Epoch: 5, Steps: 129 | Train Loss: 0.7003051 Vali Loss: 0.3667453 Best vali loss: 0.3667453
	iters: 100, epoch: 6 | loss: 0.4767735
	speed: 0.0107s/iter; left time: 3.0724s
Updating learning rate to 2.3008953193718083e-05
Validation loss decreased (0.3667 --> 0.3664).  Saving model state dict ...
Epoch: 6 cost time: 0.8548934459686279
Epoch: 6, Steps: 129 | Train Loss: 0.4767735 Vali Loss: 0.3663694 Best vali loss: 0.3663694
	iters: 100, epoch: 7 | loss: 0.7881622
	speed: 0.0104s/iter; left time: 1.6508s
Updating learning rate to 5.979832106141266e-06
Validation loss decreased (0.3664 --> 0.3662).  Saving model state dict ...
Epoch: 7 cost time: 0.8542335033416748
Epoch: 7, Steps: 129 | Train Loss: 0.7881622 Vali Loss: 0.3662281 Best vali loss: 0.3662281
	iters: 100, epoch: 8 | loss: 0.9171174
	speed: 0.0112s/iter; left time: 0.3368s
Updating learning rate to 0.0
Validation loss decreased (0.3662 --> 0.3662).  Saving model state dict ...
Epoch: 8 cost time: 0.8252546787261963
Epoch: 8, Steps: 129 | Train Loss: 0.9171174 Vali Loss: 0.3661887 Best vali loss: 0.3661887

best validation loss 0.36618869146570004

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0080579476276, 'e_layers': 1, 'learning_rate': 0.000985904912, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7229443
	speed: 0.0096s/iter; left time: 18.8489s
	iters: 200, epoch: 1 | loss: 0.5599849
	speed: 0.0034s/iter; left time: 6.3293s
Updating learning rate to 0.000985904912
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 1.2040643692016602
Epoch: 1, Steps: 257 | Train Loss: 0.6414646 Vali Loss: 0.3724059 Best vali loss: 0.3724059
	iters: 100, epoch: 2 | loss: 0.5390595
	speed: 0.0089s/iter; left time: 15.0772s
	iters: 200, epoch: 2 | loss: 0.6826478
	speed: 0.0036s/iter; left time: 5.7355s
Updating learning rate to 0.000492952456
Validation loss decreased (0.3724 --> 0.3723).  Saving model state dict ...
Epoch: 2 cost time: 0.9666805267333984
Epoch: 2, Steps: 257 | Train Loss: 0.6108536 Vali Loss: 0.3722896 Best vali loss: 0.3722896
	iters: 100, epoch: 3 | loss: 0.6170662
	speed: 0.0091s/iter; left time: 13.1916s
	iters: 200, epoch: 3 | loss: 0.7229164
	speed: 0.0036s/iter; left time: 4.8931s
Updating learning rate to 0.000246476228
Validation loss decreased (0.3723 --> 0.3721).  Saving model state dict ...
Epoch: 3 cost time: 0.9803729057312012
Epoch: 3, Steps: 257 | Train Loss: 0.6699913 Vali Loss: 0.3721057 Best vali loss: 0.3721057
	iters: 100, epoch: 4 | loss: 0.7558573
	speed: 0.0092s/iter; left time: 10.8925s
	iters: 200, epoch: 4 | loss: 0.3826970
	speed: 0.0037s/iter; left time: 4.0264s
Updating learning rate to 0.000123238114
Epoch: 4 cost time: 1.0234434604644775
Epoch: 4, Steps: 257 | Train Loss: 0.5692772 Vali Loss: 0.3848835 Best vali loss: 0.3721057
	iters: 100, epoch: 5 | loss: 0.4872421
	speed: 0.0098s/iter; left time: 9.1118s
	iters: 200, epoch: 5 | loss: 0.7024300
	speed: 0.0028s/iter; left time: 2.2855s
Updating learning rate to 6.1619057e-05
Epoch: 5 cost time: 0.8731515407562256
Epoch: 5, Steps: 257 | Train Loss: 0.5948361 Vali Loss: 0.3816552 Best vali loss: 0.3721057
	iters: 100, epoch: 6 | loss: 0.5244347
	speed: 0.0087s/iter; left time: 5.8471s
	iters: 200, epoch: 6 | loss: 0.6067691
	speed: 0.0043s/iter; left time: 2.4787s
Updating learning rate to 3.08095285e-05
Epoch: 6 cost time: 1.1319611072540283
Epoch: 6, Steps: 257 | Train Loss: 0.5656019 Vali Loss: 0.3861059 Best vali loss: 0.3721057
	iters: 100, epoch: 7 | loss: 0.5065822
	speed: 0.0094s/iter; left time: 3.9026s
	iters: 200, epoch: 7 | loss: 0.5588553
	speed: 0.0038s/iter; left time: 1.1997s
Updating learning rate to 1.540476425e-05
Epoch: 7 cost time: 1.0703296661376953
Epoch: 7, Steps: 257 | Train Loss: 0.5327187 Vali Loss: 0.3864582 Best vali loss: 0.3721057
	iters: 100, epoch: 8 | loss: 0.6232259
	speed: 0.0098s/iter; left time: 1.5490s
	iters: 200, epoch: 8 | loss: 0.3934419
	speed: 0.0041s/iter; left time: 0.2398s
Updating learning rate to 7.702382125e-06
Epoch: 8 cost time: 1.0801026821136475
Epoch: 8, Steps: 257 | Train Loss: 0.5083339 Vali Loss: 0.3847204 Best vali loss: 0.3721057

best validation loss 0.3721057145323875

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0019831740413, 'e_layers': 2, 'learning_rate': 0.0013504261128, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9058250
	speed: 0.0105s/iter; left time: 42.1654s
	iters: 200, epoch: 1 | loss: 0.5825970
	speed: 0.0056s/iter; left time: 22.0502s
	iters: 300, epoch: 1 | loss: 0.3517128
	speed: 0.0052s/iter; left time: 19.7688s
	iters: 400, epoch: 1 | loss: 0.9746272
	speed: 0.0051s/iter; left time: 19.0534s
	iters: 500, epoch: 1 | loss: 0.7435511
	speed: 0.0050s/iter; left time: 18.1461s
Updating learning rate to 0.0013504261128
Validation loss decreased (inf --> 0.3965).  Saving model state dict ...
Epoch: 1 cost time: 2.923046112060547
Epoch: 1, Steps: 514 | Train Loss: 0.7116626 Vali Loss: 0.3964628 Best vali loss: 0.3964628
	iters: 100, epoch: 2 | loss: 1.5221380
	speed: 0.0112s/iter; left time: 39.3604s
	iters: 200, epoch: 2 | loss: 0.7011173
	speed: 0.0035s/iter; left time: 11.8189s
	iters: 300, epoch: 2 | loss: 1.2600822
	speed: 0.0036s/iter; left time: 11.7186s
	iters: 400, epoch: 2 | loss: 0.4262019
	speed: 0.0044s/iter; left time: 14.1920s
	iters: 500, epoch: 2 | loss: 1.2715117
	speed: 0.0049s/iter; left time: 15.3350s
Updating learning rate to 0.0006752130564
Epoch: 2 cost time: 2.2575724124908447
Epoch: 2, Steps: 514 | Train Loss: 1.0362102 Vali Loss: 0.3970334 Best vali loss: 0.3964628
	iters: 100, epoch: 3 | loss: 1.1971170
	speed: 0.0116s/iter; left time: 34.5616s
	iters: 200, epoch: 3 | loss: 0.3889988
	speed: 0.0048s/iter; left time: 13.8617s
	iters: 300, epoch: 3 | loss: 0.4195988
	speed: 0.0047s/iter; left time: 13.1903s
	iters: 400, epoch: 3 | loss: 0.8052938
	speed: 0.0046s/iter; left time: 12.3472s
	iters: 500, epoch: 3 | loss: 0.5084183
	speed: 0.0053s/iter; left time: 13.7327s
Updating learning rate to 0.0003376065282
Validation loss decreased (0.3965 --> 0.3882).  Saving model state dict ...
Epoch: 3 cost time: 2.5600826740264893
Epoch: 3, Steps: 514 | Train Loss: 0.6638853 Vali Loss: 0.3881987 Best vali loss: 0.3881987

best validation loss 0.38819873472328037

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6554335
	speed: 0.0111s/iter; left time: 44.3446s
	iters: 200, epoch: 1 | loss: 0.4259639
	speed: 0.0048s/iter; left time: 18.8083s
	iters: 300, epoch: 1 | loss: 0.4809049
	speed: 0.0050s/iter; left time: 18.9611s
	iters: 400, epoch: 1 | loss: 0.4680176
	speed: 0.0048s/iter; left time: 17.7190s
	iters: 500, epoch: 1 | loss: 0.4209723
	speed: 0.0052s/iter; left time: 18.6722s
Updating learning rate to 6.03650536e-05
Validation loss decreased (inf --> 0.3786).  Saving model state dict ...
Epoch: 1 cost time: 2.854616403579712
Epoch: 1, Steps: 514 | Train Loss: 0.4902584 Vali Loss: 0.3786441 Best vali loss: 0.3786441
	iters: 100, epoch: 2 | loss: 0.5475284
	speed: 0.0115s/iter; left time: 40.1806s
	iters: 200, epoch: 2 | loss: 0.6287902
	speed: 0.0048s/iter; left time: 16.4823s
	iters: 300, epoch: 2 | loss: 0.8095952
	speed: 0.0046s/iter; left time: 15.1111s
	iters: 400, epoch: 2 | loss: 0.4148124
	speed: 0.0049s/iter; left time: 15.6735s
	iters: 500, epoch: 2 | loss: 0.8365970
	speed: 0.0050s/iter; left time: 15.3935s
Updating learning rate to 3.01825268e-05
Validation loss decreased (0.3786 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 2.54984712600708
Epoch: 2, Steps: 514 | Train Loss: 0.6474647 Vali Loss: 0.3659812 Best vali loss: 0.3659812
	iters: 100, epoch: 3 | loss: 0.2846583
	speed: 0.0087s/iter; left time: 26.0411s
	iters: 200, epoch: 3 | loss: 0.4803855
	speed: 0.0036s/iter; left time: 10.2438s
	iters: 300, epoch: 3 | loss: 0.6778570
	speed: 0.0049s/iter; left time: 13.6784s
	iters: 400, epoch: 3 | loss: 0.7491131
	speed: 0.0049s/iter; left time: 13.1174s
	iters: 500, epoch: 3 | loss: 0.3325270
	speed: 0.0049s/iter; left time: 12.6169s
Updating learning rate to 1.50912634e-05
Validation loss decreased (0.3660 --> 0.3648).  Saving model state dict ...
Epoch: 3 cost time: 2.273967742919922
Epoch: 3, Steps: 514 | Train Loss: 0.5049082 Vali Loss: 0.3648358 Best vali loss: 0.3648358

best validation loss 0.364835817072621

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043939909637, 'e_layers': 2, 'learning_rate': 0.0005385073997, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5722567
	speed: 0.0115s/iter; left time: 10.7399s
Updating learning rate to 0.0005180116821943523
Validation loss decreased (inf --> 0.3815).  Saving model state dict ...
Epoch: 1 cost time: 1.0491690635681152
Epoch: 1, Steps: 129 | Train Loss: 0.5722567 Vali Loss: 0.3815068 Best vali loss: 0.3815068
	iters: 100, epoch: 2 | loss: 0.7069657
	speed: 0.0105s/iter; left time: 8.4441s
Updating learning rate to 0.00045964481687350226
Validation loss decreased (0.3815 --> 0.3692).  Saving model state dict ...
Epoch: 2 cost time: 0.8150284290313721
Epoch: 2, Steps: 129 | Train Loss: 0.7069657 Vali Loss: 0.3691599 Best vali loss: 0.3691599
	iters: 100, epoch: 3 | loss: 0.6633227
	speed: 0.0106s/iter; left time: 7.1697s
Updating learning rate to 0.0003722926298855977
Validation loss decreased (0.3692 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 0.7999298572540283
Epoch: 3, Steps: 129 | Train Loss: 0.6633227 Vali Loss: 0.3672702 Best vali loss: 0.3672702

best validation loss 0.36727016590433176

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0011505887831, 'e_layers': 2, 'learning_rate': 6.03650536e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5372533
	speed: 0.0113s/iter; left time: 27.9850s
	iters: 200, epoch: 4 | loss: 0.4075957
	speed: 0.0045s/iter; left time: 10.7326s
	iters: 300, epoch: 4 | loss: 0.4668443
	speed: 0.0039s/iter; left time: 8.9130s
	iters: 400, epoch: 4 | loss: 0.4452912
	speed: 0.0033s/iter; left time: 7.2405s
	iters: 500, epoch: 4 | loss: 0.3800323
	speed: 0.0035s/iter; left time: 7.2106s
Updating learning rate to 7.5456317e-06
Epoch: 4 cost time: 2.4027915000915527
Epoch: 4, Steps: 514 | Train Loss: 0.4474034 Vali Loss: 0.3661872 Best vali loss: 0.3648358
	iters: 100, epoch: 5 | loss: 0.5198039
	speed: 0.0113s/iter; left time: 22.1801s
	iters: 200, epoch: 5 | loss: 0.6178449
	speed: 0.0047s/iter; left time: 8.6553s
	iters: 300, epoch: 5 | loss: 0.8070041
	speed: 0.0050s/iter; left time: 8.6985s
	iters: 400, epoch: 5 | loss: 0.3886313
	speed: 0.0048s/iter; left time: 8.0040s
	iters: 500, epoch: 5 | loss: 0.8213297
	speed: 0.0045s/iter; left time: 7.0799s
Updating learning rate to 3.77281585e-06
Epoch: 5 cost time: 2.506180763244629
Epoch: 5, Steps: 514 | Train Loss: 0.6309228 Vali Loss: 0.3657870 Best vali loss: 0.3648358
	iters: 100, epoch: 6 | loss: 0.2844259
	speed: 0.0109s/iter; left time: 15.6615s
	iters: 200, epoch: 6 | loss: 0.4842951
	speed: 0.0048s/iter; left time: 6.4411s
	iters: 300, epoch: 6 | loss: 0.5170345
	speed: 0.0049s/iter; left time: 6.0792s
	iters: 400, epoch: 6 | loss: 0.6924590
	speed: 0.0047s/iter; left time: 5.3312s
	iters: 500, epoch: 6 | loss: 0.3233726
	speed: 0.0043s/iter; left time: 4.4918s
Updating learning rate to 1.886407925e-06
Epoch: 6 cost time: 2.4699718952178955
Epoch: 6, Steps: 514 | Train Loss: 0.4603174 Vali Loss: 0.3658764 Best vali loss: 0.3648358
	iters: 100, epoch: 7 | loss: 0.4670226
	speed: 0.0113s/iter; left time: 10.4893s
	iters: 200, epoch: 7 | loss: 0.5985528
	speed: 0.0047s/iter; left time: 3.8851s
	iters: 300, epoch: 7 | loss: 0.5195166
	speed: 0.0049s/iter; left time: 3.5879s
	iters: 400, epoch: 7 | loss: 0.3153504
	speed: 0.0047s/iter; left time: 2.9351s
	iters: 500, epoch: 7 | loss: 0.8421853
	speed: 0.0042s/iter; left time: 2.2164s
Updating learning rate to 9.432039625e-07
Epoch: 7 cost time: 2.4420783519744873
Epoch: 7, Steps: 514 | Train Loss: 0.5485255 Vali Loss: 0.3660447 Best vali loss: 0.3648358
	iters: 100, epoch: 8 | loss: 0.2681592
	speed: 0.0077s/iter; left time: 3.1861s
	iters: 200, epoch: 8 | loss: 0.9511546
	speed: 0.0050s/iter; left time: 1.5698s
	iters: 300, epoch: 8 | loss: 0.7318171
	speed: 0.0048s/iter; left time: 1.0260s
	iters: 400, epoch: 8 | loss: 1.0145446
	speed: 0.0049s/iter; left time: 0.5591s
	iters: 500, epoch: 8 | loss: 0.3241489
	speed: 0.0049s/iter; left time: 0.0729s
Updating learning rate to 4.7160198125e-07
Epoch: 8 cost time: 2.423133373260498
Epoch: 8, Steps: 514 | Train Loss: 0.6579649 Vali Loss: 0.3660649 Best vali loss: 0.3648358

best validation loss 0.364835817072621

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0014453407321, 'e_layers': 1, 'learning_rate': 0.0019242997604, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.5456275
	speed: 0.0079s/iter; left time: 64.1583s
	iters: 200, epoch: 1 | loss: 0.6190503
	speed: 0.0024s/iter; left time: 19.0517s
	iters: 300, epoch: 1 | loss: 0.5061507
	speed: 0.0031s/iter; left time: 24.2960s
	iters: 400, epoch: 1 | loss: 0.9878227
	speed: 0.0031s/iter; left time: 24.4036s
	iters: 500, epoch: 1 | loss: 0.9827813
	speed: 0.0031s/iter; left time: 23.7247s
	iters: 600, epoch: 1 | loss: 0.7390379
	speed: 0.0030s/iter; left time: 22.8859s
	iters: 700, epoch: 1 | loss: 0.2405946
	speed: 0.0029s/iter; left time: 21.9384s
	iters: 800, epoch: 1 | loss: 0.5947953
	speed: 0.0030s/iter; left time: 22.3799s
	iters: 900, epoch: 1 | loss: 1.2388681
	speed: 0.0028s/iter; left time: 20.6060s
	iters: 1000, epoch: 1 | loss: 0.4130243
	speed: 0.0026s/iter; left time: 18.4964s
Updating learning rate to 0.0018510604617249667
Validation loss decreased (inf --> 0.3877).  Saving model state dict ...
Epoch: 1 cost time: 3.1847894191741943
Epoch: 1, Steps: 1027 | Train Loss: 0.7867753 Vali Loss: 0.3877285 Best vali loss: 0.3877285
	iters: 100, epoch: 2 | loss: 0.3711010
	speed: 0.0114s/iter; left time: 80.9961s
	iters: 200, epoch: 2 | loss: 0.7947287
	speed: 0.0031s/iter; left time: 21.8978s
	iters: 300, epoch: 2 | loss: 0.4366826
	speed: 0.0033s/iter; left time: 22.4403s
	iters: 400, epoch: 2 | loss: 1.9064665
	speed: 0.0033s/iter; left time: 22.1218s
	iters: 500, epoch: 2 | loss: 0.3835745
	speed: 0.0028s/iter; left time: 19.0236s
	iters: 600, epoch: 2 | loss: 0.4402967
	speed: 0.0029s/iter; left time: 19.0100s
	iters: 700, epoch: 2 | loss: 0.3286687
	speed: 0.0031s/iter; left time: 20.3726s
	iters: 800, epoch: 2 | loss: 1.2596844
	speed: 0.0033s/iter; left time: 21.1425s
	iters: 900, epoch: 2 | loss: 0.4655429
	speed: 0.0034s/iter; left time: 21.4006s
	iters: 1000, epoch: 2 | loss: 0.3706965
	speed: 0.0030s/iter; left time: 18.3879s
Updating learning rate to 0.0016424925850072444
Validation loss decreased (0.3877 --> 0.3834).  Saving model state dict ...
Epoch: 2 cost time: 3.283505916595459
Epoch: 2, Steps: 1027 | Train Loss: 0.6757443 Vali Loss: 0.3834325 Best vali loss: 0.3834325
	iters: 100, epoch: 3 | loss: 0.3234821
	speed: 0.0116s/iter; left time: 70.1952s
	iters: 200, epoch: 3 | loss: 0.2323254
	speed: 0.0032s/iter; left time: 19.2152s
	iters: 300, epoch: 3 | loss: 0.4710245
	speed: 0.0030s/iter; left time: 17.7172s
	iters: 400, epoch: 3 | loss: 0.3105786
	speed: 0.0031s/iter; left time: 17.6553s
	iters: 500, epoch: 3 | loss: 0.3830408
	speed: 0.0030s/iter; left time: 17.0444s
	iters: 600, epoch: 3 | loss: 0.8732061
	speed: 0.0030s/iter; left time: 16.8191s
	iters: 700, epoch: 3 | loss: 1.1694869
	speed: 0.0030s/iter; left time: 16.4756s
	iters: 800, epoch: 3 | loss: 0.2861177
	speed: 0.0028s/iter; left time: 15.0619s
	iters: 900, epoch: 3 | loss: 0.2924987
	speed: 0.0024s/iter; left time: 12.3782s
	iters: 1000, epoch: 3 | loss: 0.2755240
	speed: 0.0027s/iter; left time: 14.1094s
Updating learning rate to 0.001330348698804596
Validation loss decreased (0.3834 --> 0.3833).  Saving model state dict ...
Epoch: 3 cost time: 3.0751664638519287
Epoch: 3, Steps: 1027 | Train Loss: 0.4617285 Vali Loss: 0.3833289 Best vali loss: 0.3833289
	iters: 100, epoch: 4 | loss: 0.9149258
	speed: 0.0111s/iter; left time: 55.9427s
	iters: 200, epoch: 4 | loss: 0.5831378
	speed: 0.0028s/iter; left time: 14.0489s
	iters: 300, epoch: 4 | loss: 0.2073615
	speed: 0.0031s/iter; left time: 15.1945s
	iters: 400, epoch: 4 | loss: 0.9491324
	speed: 0.0027s/iter; left time: 12.5959s
	iters: 500, epoch: 4 | loss: 0.2585436
	speed: 0.0025s/iter; left time: 11.4951s
	iters: 600, epoch: 4 | loss: 0.2226198
	speed: 0.0021s/iter; left time: 9.5409s
	iters: 700, epoch: 4 | loss: 0.4344659
	speed: 0.0021s/iter; left time: 9.2373s
	iters: 800, epoch: 4 | loss: 0.4255677
	speed: 0.0021s/iter; left time: 9.2504s
	iters: 900, epoch: 4 | loss: 0.2527089
	speed: 0.0022s/iter; left time: 9.4677s
	iters: 1000, epoch: 4 | loss: 0.2719491
	speed: 0.0030s/iter; left time: 12.5013s
Updating learning rate to 0.0009621498802
Epoch: 4 cost time: 2.6998112201690674
Epoch: 4, Steps: 1027 | Train Loss: 0.4520413 Vali Loss: 0.4099957 Best vali loss: 0.3833289
	iters: 100, epoch: 5 | loss: 0.3637474
	speed: 0.0111s/iter; left time: 44.6512s
	iters: 200, epoch: 5 | loss: 0.5144229
	speed: 0.0032s/iter; left time: 12.3676s
	iters: 300, epoch: 5 | loss: 0.3974502
	speed: 0.0032s/iter; left time: 12.0463s
	iters: 400, epoch: 5 | loss: 0.6070660
	speed: 0.0031s/iter; left time: 11.5079s
	iters: 500, epoch: 5 | loss: 0.2021046
	speed: 0.0031s/iter; left time: 11.1760s
	iters: 600, epoch: 5 | loss: 0.8219473
	speed: 0.0030s/iter; left time: 10.6247s
	iters: 700, epoch: 5 | loss: 0.3423841
	speed: 0.0027s/iter; left time: 9.1889s
	iters: 800, epoch: 5 | loss: 0.5195988
	speed: 0.0027s/iter; left time: 8.8484s
	iters: 900, epoch: 5 | loss: 0.5090091
	speed: 0.0030s/iter; left time: 9.5066s
	iters: 1000, epoch: 5 | loss: 0.3382826
	speed: 0.0030s/iter; left time: 9.3043s
Updating learning rate to 0.0005939510615954041
Epoch: 5 cost time: 3.131028175354004
Epoch: 5, Steps: 1027 | Train Loss: 0.4616013 Vali Loss: 0.4136426 Best vali loss: 0.3833289
	iters: 100, epoch: 6 | loss: 0.8167319
	speed: 0.0109s/iter; left time: 32.4474s
	iters: 200, epoch: 6 | loss: 0.7495748
	speed: 0.0030s/iter; left time: 8.7154s
	iters: 300, epoch: 6 | loss: 0.3328142
	speed: 0.0031s/iter; left time: 8.6567s
	iters: 400, epoch: 6 | loss: 1.1520697
	speed: 0.0030s/iter; left time: 8.1674s
	iters: 500, epoch: 6 | loss: 0.5905229
	speed: 0.0033s/iter; left time: 8.4133s
	iters: 600, epoch: 6 | loss: 1.2871004
	speed: 0.0026s/iter; left time: 6.3599s
	iters: 700, epoch: 6 | loss: 0.5518116
	speed: 0.0026s/iter; left time: 6.2619s
	iters: 800, epoch: 6 | loss: 0.3261878
	speed: 0.0028s/iter; left time: 6.4954s
	iters: 900, epoch: 6 | loss: 0.4094920
	speed: 0.0035s/iter; left time: 7.5722s
	iters: 1000, epoch: 6 | loss: 0.4712568
	speed: 0.0030s/iter; left time: 6.2855s
Updating learning rate to 0.0002818071753927558
Epoch: 6 cost time: 3.1448919773101807
Epoch: 6, Steps: 1027 | Train Loss: 0.6687562 Vali Loss: 0.4174035 Best vali loss: 0.3833289
	iters: 100, epoch: 7 | loss: 0.4169116
	speed: 0.0110s/iter; left time: 21.5048s
	iters: 200, epoch: 7 | loss: 0.5473497
	speed: 0.0029s/iter; left time: 5.4704s
	iters: 300, epoch: 7 | loss: 0.5197971
	speed: 0.0030s/iter; left time: 5.2823s
	iters: 400, epoch: 7 | loss: 0.2860208
	speed: 0.0030s/iter; left time: 4.9210s
	iters: 500, epoch: 7 | loss: 0.3822596
	speed: 0.0026s/iter; left time: 4.0933s
	iters: 600, epoch: 7 | loss: 0.5365480
	speed: 0.0027s/iter; left time: 3.8562s
	iters: 700, epoch: 7 | loss: 0.3494988
	speed: 0.0028s/iter; left time: 3.8218s
	iters: 800, epoch: 7 | loss: 0.4686075
	speed: 0.0029s/iter; left time: 3.6632s
	iters: 900, epoch: 7 | loss: 0.2598523
	speed: 0.0029s/iter; left time: 3.2997s
	iters: 1000, epoch: 7 | loss: 0.7425747
	speed: 0.0028s/iter; left time: 2.9682s
Updating learning rate to 7.323929867503346e-05
Epoch: 7 cost time: 2.978522777557373
Epoch: 7, Steps: 1027 | Train Loss: 0.4509420 Vali Loss: 0.4426412 Best vali loss: 0.3833289
	iters: 100, epoch: 8 | loss: 0.4066456
	speed: 0.0109s/iter; left time: 10.0877s
	iters: 200, epoch: 8 | loss: 0.2332269
	speed: 0.0029s/iter; left time: 2.4327s
	iters: 300, epoch: 8 | loss: 0.8686049
	speed: 0.0029s/iter; left time: 2.1229s
	iters: 400, epoch: 8 | loss: 0.2315539
	speed: 0.0026s/iter; left time: 1.6482s
	iters: 500, epoch: 8 | loss: 0.2719018
	speed: 0.0028s/iter; left time: 1.4654s
	iters: 600, epoch: 8 | loss: 0.7555285
	speed: 0.0027s/iter; left time: 1.1758s
	iters: 700, epoch: 8 | loss: 0.3857712
	speed: 0.0029s/iter; left time: 0.9630s
	iters: 800, epoch: 8 | loss: 0.1787736
	speed: 0.0029s/iter; left time: 0.6600s
	iters: 900, epoch: 8 | loss: 0.2124514
	speed: 0.0030s/iter; left time: 0.3820s
	iters: 1000, epoch: 8 | loss: 0.5860591
	speed: 0.0030s/iter; left time: 0.0849s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.006093740463257
Epoch: 8, Steps: 1027 | Train Loss: 0.4130517 Vali Loss: 0.4321225 Best vali loss: 0.3833289

best validation loss 0.383328910239319

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0071113834238, 'e_layers': 4, 'learning_rate': 0.0001530715139, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9403405
	speed: 0.0133s/iter; left time: 107.7329s
	iters: 200, epoch: 1 | loss: 0.2510541
	speed: 0.0070s/iter; left time: 56.2523s
	iters: 300, epoch: 1 | loss: 1.1405820
	speed: 0.0070s/iter; left time: 55.5406s
	iters: 400, epoch: 1 | loss: 0.5271375
	speed: 0.0070s/iter; left time: 54.5931s
	iters: 500, epoch: 1 | loss: 1.0323671
	speed: 0.0068s/iter; left time: 52.4723s
	iters: 600, epoch: 1 | loss: 0.5051214
	speed: 0.0062s/iter; left time: 47.1804s
	iters: 700, epoch: 1 | loss: 0.2531639
	speed: 0.0068s/iter; left time: 50.8054s
	iters: 800, epoch: 1 | loss: 0.3246399
	speed: 0.0070s/iter; left time: 51.9870s
	iters: 900, epoch: 1 | loss: 0.5028002
	speed: 0.0070s/iter; left time: 51.1944s
	iters: 1000, epoch: 1 | loss: 0.4163092
	speed: 0.0070s/iter; left time: 50.5260s
Updating learning rate to 0.0001472455763013635
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 7.406736135482788
Epoch: 1, Steps: 1027 | Train Loss: 0.5893516 Vali Loss: 0.3750968 Best vali loss: 0.3750968
	iters: 100, epoch: 2 | loss: 1.2308702
	speed: 0.0176s/iter; left time: 124.6899s
	iters: 200, epoch: 2 | loss: 0.1991393
	speed: 0.0066s/iter; left time: 46.3150s
	iters: 300, epoch: 2 | loss: 0.3721096
	speed: 0.0067s/iter; left time: 46.1173s
	iters: 400, epoch: 2 | loss: 0.4327334
	speed: 0.0067s/iter; left time: 45.3146s
	iters: 500, epoch: 2 | loss: 1.6556702
	speed: 0.0067s/iter; left time: 44.5838s
	iters: 600, epoch: 2 | loss: 0.5259319
	speed: 0.0067s/iter; left time: 43.8879s
	iters: 700, epoch: 2 | loss: 1.5853817
	speed: 0.0059s/iter; left time: 38.4151s
	iters: 800, epoch: 2 | loss: 1.2180145
	speed: 0.0054s/iter; left time: 34.3623s
	iters: 900, epoch: 2 | loss: 0.3460438
	speed: 0.0049s/iter; left time: 30.9435s
	iters: 1000, epoch: 2 | loss: 0.3789380
	speed: 0.0077s/iter; left time: 47.7640s
Updating learning rate to 0.00013065470969259043
Validation loss decreased (0.3751 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 6.66959810256958
Epoch: 2, Steps: 1027 | Train Loss: 0.7944833 Vali Loss: 0.3629720 Best vali loss: 0.3629720
	iters: 100, epoch: 3 | loss: 0.6692747
	speed: 0.0257s/iter; left time: 155.8140s
	iters: 200, epoch: 3 | loss: 0.1880261
	speed: 0.0093s/iter; left time: 55.3079s
	iters: 300, epoch: 3 | loss: 0.3557955
	speed: 0.0093s/iter; left time: 54.4645s
	iters: 400, epoch: 3 | loss: 0.4077211
	speed: 0.0093s/iter; left time: 53.8077s
	iters: 500, epoch: 3 | loss: 0.7510648
	speed: 0.0094s/iter; left time: 53.0513s
	iters: 600, epoch: 3 | loss: 0.2345226
	speed: 0.0094s/iter; left time: 52.0145s
	iters: 700, epoch: 3 | loss: 0.2686978
	speed: 0.0088s/iter; left time: 48.2666s
	iters: 800, epoch: 3 | loss: 0.6618939
	speed: 0.0071s/iter; left time: 38.3050s
	iters: 900, epoch: 3 | loss: 0.5399659
	speed: 0.0080s/iter; left time: 41.9031s
	iters: 1000, epoch: 3 | loss: 0.7655026
	speed: 0.0093s/iter; left time: 48.1670s
Updating learning rate to 0.00010582472311828629
Epoch: 3 cost time: 9.212788820266724
Epoch: 3, Steps: 1027 | Train Loss: 0.4842465 Vali Loss: 0.3724119 Best vali loss: 0.3629720
	iters: 100, epoch: 4 | loss: 0.4979826
	speed: 0.0249s/iter; left time: 125.5712s
	iters: 200, epoch: 4 | loss: 0.8615547
	speed: 0.0093s/iter; left time: 46.0924s
	iters: 300, epoch: 4 | loss: 0.4324863
	speed: 0.0093s/iter; left time: 44.8936s
	iters: 400, epoch: 4 | loss: 0.3112058
	speed: 0.0093s/iter; left time: 43.9319s
	iters: 500, epoch: 4 | loss: 0.3016425
	speed: 0.0094s/iter; left time: 43.3471s
	iters: 600, epoch: 4 | loss: 0.3998317
	speed: 0.0093s/iter; left time: 42.2516s
	iters: 700, epoch: 4 | loss: 0.3661677
	speed: 0.0073s/iter; left time: 32.3161s
	iters: 800, epoch: 4 | loss: 0.5416673
	speed: 0.0071s/iter; left time: 30.9789s
	iters: 900, epoch: 4 | loss: 0.6507453
	speed: 0.0093s/iter; left time: 39.4968s
	iters: 1000, epoch: 4 | loss: 0.5168082
	speed: 0.0092s/iter; left time: 38.1493s
Updating learning rate to 7.653575695e-05
Validation loss decreased (0.3630 --> 0.3502).  Saving model state dict ...
Epoch: 4 cost time: 9.183300971984863
Epoch: 4, Steps: 1027 | Train Loss: 0.4880092 Vali Loss: 0.3502043 Best vali loss: 0.3502043
	iters: 100, epoch: 5 | loss: 0.5205630
	speed: 0.0251s/iter; left time: 100.8152s
	iters: 200, epoch: 5 | loss: 0.8556483
	speed: 0.0093s/iter; left time: 36.2201s
	iters: 300, epoch: 5 | loss: 0.7376470
	speed: 0.0093s/iter; left time: 35.3864s
	iters: 400, epoch: 5 | loss: 0.2830225
	speed: 0.0093s/iter; left time: 34.4050s
	iters: 500, epoch: 5 | loss: 0.3321400
	speed: 0.0093s/iter; left time: 33.4670s
	iters: 600, epoch: 5 | loss: 0.7047378
	speed: 0.0077s/iter; left time: 27.1831s
	iters: 700, epoch: 5 | loss: 0.1537153
	speed: 0.0073s/iter; left time: 24.8218s
	iters: 800, epoch: 5 | loss: 0.5928000
	speed: 0.0083s/iter; left time: 27.5425s
	iters: 900, epoch: 5 | loss: 0.5083004
	speed: 0.0093s/iter; left time: 29.6984s
	iters: 1000, epoch: 5 | loss: 0.3989427
	speed: 0.0093s/iter; left time: 28.9288s
Updating learning rate to 4.724679078171373e-05
Validation loss decreased (0.3502 --> 0.3493).  Saving model state dict ...
Epoch: 5 cost time: 9.115855932235718
Epoch: 5, Steps: 1027 | Train Loss: 0.5087517 Vali Loss: 0.3493048 Best vali loss: 0.3493048
	iters: 100, epoch: 6 | loss: 0.2700615
	speed: 0.0250s/iter; left time: 74.6160s
	iters: 200, epoch: 6 | loss: 0.7648038
	speed: 0.0092s/iter; left time: 26.6553s
	iters: 300, epoch: 6 | loss: 0.3505729
	speed: 0.0093s/iter; left time: 25.9064s
	iters: 400, epoch: 6 | loss: 0.2197276
	speed: 0.0093s/iter; left time: 25.0095s
	iters: 500, epoch: 6 | loss: 0.6386150
	speed: 0.0091s/iter; left time: 23.3708s
	iters: 600, epoch: 6 | loss: 0.2915619
	speed: 0.0072s/iter; left time: 17.7662s
	iters: 700, epoch: 6 | loss: 0.2078749
	speed: 0.0073s/iter; left time: 17.4031s
	iters: 800, epoch: 6 | loss: 0.7017027
	speed: 0.0093s/iter; left time: 21.2068s
	iters: 900, epoch: 6 | loss: 0.3204460
	speed: 0.0093s/iter; left time: 20.2941s
	iters: 1000, epoch: 6 | loss: 0.2819585
	speed: 0.0093s/iter; left time: 19.3674s
Updating learning rate to 2.2416804207409573e-05
Epoch: 6 cost time: 9.148938417434692
Epoch: 6, Steps: 1027 | Train Loss: 0.4047325 Vali Loss: 0.3568463 Best vali loss: 0.3493048
	iters: 100, epoch: 7 | loss: 0.2157376
	speed: 0.0245s/iter; left time: 47.9097s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6407150
	speed: 0.0110s/iter; left time: 21.4437s
	iters: 200, epoch: 1 | loss: 0.5658868
	speed: 0.0045s/iter; left time: 8.4338s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.3946).  Saving model state dict ...
Epoch: 1 cost time: 1.5387609004974365
Epoch: 1, Steps: 257 | Train Loss: 0.6033009 Vali Loss: 0.3946495 Best vali loss: 0.3946495
	iters: 100, epoch: 2 | loss: 0.7124528
	speed: 0.0108s/iter; left time: 18.3149s
	iters: 200, epoch: 2 | loss: 0.5278378
	speed: 0.0053s/iter; left time: 8.4104s
Updating learning rate to 4.937857552178923e-05
Validation loss decreased (0.3946 --> 0.3759).  Saving model state dict ...
Epoch: 2 cost time: 1.288083791732788
Epoch: 2, Steps: 257 | Train Loss: 0.6201453 Vali Loss: 0.3759253 Best vali loss: 0.3759253
	iters: 100, epoch: 3 | loss: 0.5824889
	speed: 0.0117s/iter; left time: 16.8386s
	iters: 200, epoch: 3 | loss: 0.4245912
	speed: 0.0049s/iter; left time: 6.5334s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.3759 --> 0.3694).  Saving model state dict ...
Epoch: 3 cost time: 1.3331208229064941
Epoch: 3, Steps: 257 | Train Loss: 0.5035400 Vali Loss: 0.3693934 Best vali loss: 0.3693934

best validation loss 0.369393350321558

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020735604228, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.4055).  Saving model state dict ...
Epoch: 1 cost time: 0.7600646018981934
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4055049 Best vali loss: 0.4055049
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.4055 --> 0.3833).  Saving model state dict ...
Epoch: 2 cost time: 0.49477124214172363
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3832668 Best vali loss: 0.3832668
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.3833 --> 0.3773).  Saving model state dict ...
Epoch: 3 cost time: 0.470916748046875
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3773157 Best vali loss: 0.3773157

best validation loss 0.37731567096616525

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0062923252341, 'e_layers': 4, 'learning_rate': 0.0001977554099, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6632571
	speed: 0.0137s/iter; left time: 12.8188s
Updating learning rate to 0.00019022879277499492
Validation loss decreased (inf --> 0.4030).  Saving model state dict ...
Epoch: 1 cost time: 1.336785078048706
Epoch: 1, Steps: 129 | Train Loss: 0.6632571 Vali Loss: 0.4030121 Best vali loss: 0.4030121
	iters: 100, epoch: 2 | loss: 0.7144607
	speed: 0.0134s/iter; left time: 10.7985s
Updating learning rate to 0.00016879480062830765
Validation loss decreased (0.4030 --> 0.3847).  Saving model state dict ...
Epoch: 2 cost time: 1.083688735961914
Epoch: 2, Steps: 129 | Train Loss: 0.7144607 Vali Loss: 0.3847397 Best vali loss: 0.3847397
	iters: 100, epoch: 3 | loss: 0.4452259
	speed: 0.0131s/iter; left time: 8.8625s
Updating learning rate to 0.00013671656446464863
Validation loss decreased (0.3847 --> 0.3768).  Saving model state dict ...
Epoch: 3 cost time: 1.0905311107635498
Epoch: 3, Steps: 129 | Train Loss: 0.4452259 Vali Loss: 0.3767999 Best vali loss: 0.3767999

best validation loss 0.37679985194871374

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0065160060861, 'e_layers': 1, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5858805
	speed: 0.0083s/iter; left time: 9.7943s
	iters: 200, epoch: 4 | loss: 0.5457100
	speed: 0.0026s/iter; left time: 2.8588s
Updating learning rate to 2.892529985e-05
Validation loss decreased (0.3694 --> 0.3671).  Saving model state dict ...
Epoch: 4 cost time: 1.0113499164581299
Epoch: 4, Steps: 257 | Train Loss: 0.5657953 Vali Loss: 0.3671313 Best vali loss: 0.3671313
	iters: 100, epoch: 5 | loss: 0.6191276
	speed: 0.0101s/iter; left time: 9.3734s
	iters: 200, epoch: 5 | loss: 0.5115421
	speed: 0.0039s/iter; left time: 3.2663s
Updating learning rate to 1.7856066821212585e-05
Validation loss decreased (0.3671 --> 0.3669).  Saving model state dict ...
Epoch: 5 cost time: 1.1044261455535889
Epoch: 5, Steps: 257 | Train Loss: 0.5653349 Vali Loss: 0.3669049 Best vali loss: 0.3669049
	iters: 100, epoch: 6 | loss: 0.5667987
	speed: 0.0107s/iter; left time: 7.1796s
	iters: 200, epoch: 6 | loss: 0.4197135
	speed: 0.0040s/iter; left time: 2.2787s
Updating learning rate to 8.472024178210777e-06
Epoch: 6 cost time: 1.0975430011749268
Epoch: 6, Steps: 257 | Train Loss: 0.4932561 Vali Loss: 0.3673628 Best vali loss: 0.3669049
	iters: 100, epoch: 7 | loss: 0.3741871
	speed: 0.0104s/iter; left time: 4.2980s
	iters: 200, epoch: 7 | loss: 0.5506668
	speed: 0.0039s/iter; left time: 1.2431s
Updating learning rate to 2.2018073468332077e-06
Epoch: 7 cost time: 1.1133580207824707
Epoch: 7, Steps: 257 | Train Loss: 0.4624269 Vali Loss: 0.3670025 Best vali loss: 0.3669049
	iters: 100, epoch: 8 | loss: 0.7232532
	speed: 0.0076s/iter; left time: 1.1954s
	iters: 200, epoch: 8 | loss: 0.7772476
	speed: 0.0030s/iter; left time: 0.1722s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8960771560668945
Epoch: 8, Steps: 257 | Train Loss: 0.7502504 Vali Loss: 0.3671285 Best vali loss: 0.3669049

best validation loss 0.36690492498851246

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0047327455259, 'e_layers': 4, 'learning_rate': 0.0038245816163, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6232892
	speed: 0.0128s/iter; left time: 11.9355s
Updating learning rate to 0.0038245816163
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.1537480354309082
Epoch: 1, Steps: 129 | Train Loss: 0.6232892 Vali Loss: 0.3689749 Best vali loss: 0.3689749
	iters: 100, epoch: 2 | loss: 0.5530116
	speed: 0.0110s/iter; left time: 8.8094s
Updating learning rate to 0.00191229080815
Validation loss decreased (0.3690 --> 0.3617).  Saving model state dict ...
Epoch: 2 cost time: 1.0287458896636963
Epoch: 2, Steps: 129 | Train Loss: 0.5530116 Vali Loss: 0.3616684 Best vali loss: 0.3616684
	iters: 100, epoch: 3 | loss: 0.5405148
	speed: 0.0131s/iter; left time: 8.8711s
Updating learning rate to 0.000956145404075
Validation loss decreased (0.3617 --> 0.3598).  Saving model state dict ...
Epoch: 3 cost time: 1.0865511894226074
Epoch: 3, Steps: 129 | Train Loss: 0.5405148 Vali Loss: 0.3597826 Best vali loss: 0.3597826
	iters: 100, epoch: 4 | loss: 0.5520310
	speed: 0.0131s/iter; left time: 7.1262s
Updating learning rate to 0.0004780727020375
Epoch: 4 cost time: 1.080319881439209
Epoch: 4, Steps: 129 | Train Loss: 0.5520310 Vali Loss: 0.3640849 Best vali loss: 0.3597826
	iters: 100, epoch: 5 | loss: 0.5307195
	speed: 0.0114s/iter; left time: 4.7437s
Updating learning rate to 0.00023903635101875
Validation loss decreased (0.3598 --> 0.3547).  Saving model state dict ...
Epoch: 5 cost time: 0.8518462181091309
Epoch: 5, Steps: 129 | Train Loss: 0.5307195 Vali Loss: 0.3547114 Best vali loss: 0.3547114
	iters: 100, epoch: 6 | loss: 0.7080239
	speed: 0.0121s/iter; left time: 3.4901s
Updating learning rate to 0.000119518175509375
Validation loss decreased (0.3547 --> 0.3516).  Saving model state dict ...
Epoch: 6 cost time: 1.1194274425506592
Epoch: 6, Steps: 129 | Train Loss: 0.7080239 Vali Loss: 0.3515770 Best vali loss: 0.3515770
	iters: 100, epoch: 7 | loss: 0.5149541
	speed: 0.0137s/iter; left time: 2.1718s
Updating learning rate to 5.97590877546875e-05
Epoch: 7 cost time: 1.1182332038879395
Epoch: 7, Steps: 129 | Train Loss: 0.5149541 Vali Loss: 0.3525637 Best vali loss: 0.3515770
	iters: 100, epoch: 8 | loss: 0.6749389
	speed: 0.0140s/iter; left time: 0.4214s
Updating learning rate to 2.987954387734375e-05
Epoch: 8 cost time: 1.1397721767425537
Epoch: 8, Steps: 129 | Train Loss: 0.6749389 Vali Loss: 0.3519729 Best vali loss: 0.3515770

best validation loss 0.3515769537867638

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0036637688578, 'e_layers': 3, 'learning_rate': 0.0032858943573, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3948357
	speed: 0.0115s/iter; left time: 46.0529s
	iters: 200, epoch: 1 | loss: 0.6086918
	speed: 0.0058s/iter; left time: 22.7820s
	iters: 300, epoch: 1 | loss: 0.3103006
	speed: 0.0056s/iter; left time: 21.4036s
	iters: 400, epoch: 1 | loss: 0.4925854
	speed: 0.0045s/iter; left time: 16.5557s
	iters: 500, epoch: 1 | loss: 1.0897483
	speed: 0.0051s/iter; left time: 18.4954s
Updating learning rate to 0.0032858943573
Validation loss decreased (inf --> 0.4025).  Saving model state dict ...
Epoch: 1 cost time: 3.081019878387451
Epoch: 1, Steps: 514 | Train Loss: 0.5792323 Vali Loss: 0.4025289 Best vali loss: 0.4025289
	iters: 100, epoch: 2 | loss: 0.3703640
	speed: 0.0129s/iter; left time: 45.0166s
	iters: 200, epoch: 2 | loss: 0.7817223
	speed: 0.0068s/iter; left time: 23.0345s
	iters: 300, epoch: 2 | loss: 0.4963853
	speed: 0.0062s/iter; left time: 20.4612s
	iters: 400, epoch: 2 | loss: 0.4683692
	speed: 0.0065s/iter; left time: 20.8078s
	iters: 500, epoch: 2 | loss: 0.2869858
	speed: 0.0062s/iter; left time: 19.3508s
Updating learning rate to 0.00164294717865
Epoch: 2 cost time: 3.3143415451049805
Epoch: 2, Steps: 514 | Train Loss: 0.4807653 Vali Loss: 0.4031887 Best vali loss: 0.4025289
	iters: 100, epoch: 3 | loss: 0.4373842
	speed: 0.0128s/iter; left time: 38.3050s
	iters: 200, epoch: 3 | loss: 0.2858781
	speed: 0.0066s/iter; left time: 18.9931s
	iters: 300, epoch: 3 | loss: 0.6328625
	speed: 0.0067s/iter; left time: 18.6962s
	iters: 400, epoch: 3 | loss: 0.4223472
	speed: 0.0061s/iter; left time: 16.3573s
	iters: 500, epoch: 3 | loss: 0.5729894
	speed: 0.0064s/iter; left time: 16.5864s
Updating learning rate to 0.000821473589325
Epoch: 3 cost time: 3.340884208679199
Epoch: 3, Steps: 514 | Train Loss: 0.4702923 Vali Loss: 0.4053575 Best vali loss: 0.4025289
	iters: 100, epoch: 4 | loss: 0.4801105
	speed: 0.0129s/iter; left time: 31.9030s
	iters: 200, epoch: 4 | loss: 0.3222237
	speed: 0.0061s/iter; left time: 14.3852s
	iters: 300, epoch: 4 | loss: 1.0472819
	speed: 0.0041s/iter; left time: 9.2200s
	iters: 400, epoch: 4 | loss: 1.2088253
	speed: 0.0043s/iter; left time: 9.4115s
	iters: 500, epoch: 4 | loss: 0.5412612
	speed: 0.0060s/iter; left time: 12.4788s
Updating learning rate to 0.0004107367946625
Epoch: 4 cost time: 2.813076972961426
Epoch: 4, Steps: 514 | Train Loss: 0.7199405 Vali Loss: 0.4030680 Best vali loss: 0.4025289
	iters: 100, epoch: 5 | loss: 0.6567315
	speed: 0.0127s/iter; left time: 24.8265s
	iters: 200, epoch: 5 | loss: 0.5817692
	speed: 0.0060s/iter; left time: 11.1253s
	iters: 300, epoch: 5 | loss: 0.3791564
	speed: 0.0057s/iter; left time: 9.9689s
	iters: 400, epoch: 5 | loss: 0.9971571
	speed: 0.0061s/iter; left time: 10.0335s
	iters: 500, epoch: 5 | loss: 0.8748842
	speed: 0.0060s/iter; left time: 9.2647s
Updating learning rate to 0.00020536839733125
Epoch: 5 cost time: 3.1147360801696777
Epoch: 5, Steps: 514 | Train Loss: 0.6979397 Vali Loss: 0.4036954 Best vali loss: 0.4025289
	iters: 100, epoch: 6 | loss: 0.8470911
	speed: 0.0126s/iter; left time: 18.1749s
	iters: 200, epoch: 6 | loss: 0.5069420
	speed: 0.0060s/iter; left time: 8.0998s
	iters: 300, epoch: 6 | loss: 0.6072245
	speed: 0.0058s/iter; left time: 7.2462s
	iters: 400, epoch: 6 | loss: 1.2577990
	speed: 0.0060s/iter; left time: 6.9046s
	iters: 500, epoch: 6 | loss: 0.6266598
	speed: 0.0061s/iter; left time: 6.3491s
Updating learning rate to 0.000102684198665625
Epoch: 6 cost time: 3.132000684738159
Epoch: 6, Steps: 514 | Train Loss: 0.7691433 Vali Loss: 0.4033198 Best vali loss: 0.4025289
	iters: 100, epoch: 7 | loss: 0.9922727
	speed: 0.0127s/iter; left time: 11.8386s
	iters: 200, epoch: 7 | loss: 0.4847507
	speed: 0.0060s/iter; left time: 4.9967s
	iters: 300, epoch: 7 | loss: 0.5861612
	speed: 0.0058s/iter; left time: 4.2302s
	iters: 400, epoch: 7 | loss: 0.5442631
	speed: 0.0059s/iter; left time: 3.6932s
	iters: 500, epoch: 7 | loss: 0.4298619
	speed: 0.0061s/iter; left time: 3.2140s
Updating learning rate to 5.13420993328125e-05
Epoch: 7 cost time: 3.1147069931030273
Epoch: 7, Steps: 514 | Train Loss: 0.6074619 Vali Loss: 0.4034308 Best vali loss: 0.4025289
	iters: 100, epoch: 8 | loss: 0.8370391
	speed: 0.0126s/iter; left time: 5.2254s
	iters: 200, epoch: 8 | loss: 0.6045324
	speed: 0.0059s/iter; left time: 1.8579s
	iters: 300, epoch: 8 | loss: 0.5573937
	speed: 0.0058s/iter; left time: 1.2498s
	iters: 400, epoch: 8 | loss: 0.4003682
	speed: 0.0060s/iter; left time: 0.6868s
	iters: 500, epoch: 8 | loss: 1.5861024
	speed: 0.0059s/iter; left time: 0.0891s
Updating learning rate to 2.567104966640625e-05
Epoch: 8 cost time: 3.104929208755493
Epoch: 8, Steps: 514 | Train Loss: 0.7970871 Vali Loss: 0.4034161 Best vali loss: 0.4025289

best validation loss 0.4025288556320026

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0029231680578149597
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 0.8899819850921631
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3743653 Best vali loss: 0.3743653
Updating learning rate to 0.0025938006666821026
Epoch: 2 cost time: 0.48267149925231934
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3801330 Best vali loss: 0.3743653
Updating learning rate to 0.0021008675310785706
Epoch: 3 cost time: 0.4958837032318115
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3776173 Best vali loss: 0.3743653

best validation loss 0.3743652702080477

{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0118662500741, 'e_layers': 3, 'learning_rate': 0.0003750615196, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00036078659049551044
Validation loss decreased (inf --> 0.4006).  Saving model state dict ...
Epoch: 1 cost time: 0.7351715564727783
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4006320 Best vali loss: 0.4006320
Updating learning rate to 0.0003201350317356456
Validation loss decreased (0.4006 --> 0.3840).  Saving model state dict ...
Epoch: 2 cost time: 0.5572905540466309
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3840010 Best vali loss: 0.3840010
Updating learning rate to 0.0002592956746342972
Validation loss decreased (0.3840 --> 0.3757).  Saving model state dict ...
Epoch: 3 cost time: 0.4923362731933594
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3756729 Best vali loss: 0.3756729

best validation loss 0.3756728503230981

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047627831688, 'e_layers': 3, 'learning_rate': 0.0015982189843, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4314267
	speed: 0.0108s/iter; left time: 87.3985s
	iters: 200, epoch: 1 | loss: 0.8446139
	speed: 0.0049s/iter; left time: 39.1282s
	iters: 300, epoch: 1 | loss: 0.3185325
	speed: 0.0051s/iter; left time: 40.5755s
	iters: 400, epoch: 1 | loss: 0.6190820
	speed: 0.0052s/iter; left time: 40.9119s
	iters: 500, epoch: 1 | loss: 0.2477202
	speed: 0.0053s/iter; left time: 41.2234s
	iters: 600, epoch: 1 | loss: 0.4544212
	speed: 0.0054s/iter; left time: 40.9613s
	iters: 700, epoch: 1 | loss: 0.9733073
	speed: 0.0053s/iter; left time: 40.1799s
	iters: 800, epoch: 1 | loss: 0.7022151
	speed: 0.0048s/iter; left time: 35.6175s
	iters: 900, epoch: 1 | loss: 0.4413293
	speed: 0.0039s/iter; left time: 28.5620s
	iters: 1000, epoch: 1 | loss: 1.2659044
	speed: 0.0042s/iter; left time: 30.1423s
Updating learning rate to 0.0015373903961828739
Validation loss decreased (inf --> 0.3896).  Saving model state dict ...
Epoch: 1 cost time: 5.389333248138428
Epoch: 1, Steps: 1027 | Train Loss: 0.6298553 Vali Loss: 0.3895535 Best vali loss: 0.3895535
	iters: 100, epoch: 2 | loss: 0.3571926
	speed: 0.0143s/iter; left time: 101.4117s
	iters: 200, epoch: 2 | loss: 0.5668269
	speed: 0.0052s/iter; left time: 36.4793s
	iters: 300, epoch: 2 | loss: 0.3477214
	speed: 0.0042s/iter; left time: 29.0995s
	iters: 400, epoch: 2 | loss: 1.7867857
	speed: 0.0044s/iter; left time: 30.1401s
	iters: 500, epoch: 2 | loss: 0.3270529
	speed: 0.0050s/iter; left time: 33.4629s
	iters: 600, epoch: 2 | loss: 0.9178848
	speed: 0.0056s/iter; left time: 37.1970s
	iters: 700, epoch: 2 | loss: 0.2566308
	speed: 0.0050s/iter; left time: 32.3005s
	iters: 800, epoch: 2 | loss: 0.4525936
	speed: 0.0046s/iter; left time: 29.7081s
	iters: 900, epoch: 2 | loss: 0.9429974
	speed: 0.0042s/iter; left time: 26.5691s
	iters: 1000, epoch: 2 | loss: 0.3837149
	speed: 0.0048s/iter; left time: 29.9465s
Updating learning rate to 0.0013641652329598032
Validation loss decreased (0.3896 --> 0.3847).  Saving model state dict ...
Epoch: 2 cost time: 5.021610260009766
Epoch: 2, Steps: 1027 | Train Loss: 0.6339401 Vali Loss: 0.3846978 Best vali loss: 0.3846978
	iters: 100, epoch: 3 | loss: 0.5884025
	speed: 0.0153s/iter; left time: 92.6260s
	iters: 200, epoch: 3 | loss: 1.1966814
	speed: 0.0054s/iter; left time: 32.0950s
	iters: 300, epoch: 3 | loss: 1.7588750
	speed: 0.0053s/iter; left time: 31.1239s
	iters: 400, epoch: 3 | loss: 0.2236025
	speed: 0.0051s/iter; left time: 29.2071s
	iters: 500, epoch: 3 | loss: 0.3165919
	speed: 0.0053s/iter; left time: 29.7415s
	iters: 600, epoch: 3 | loss: 0.4417385
	speed: 0.0053s/iter; left time: 29.7128s
	iters: 700, epoch: 3 | loss: 0.3166959
	speed: 0.0054s/iter; left time: 29.6218s
	iters: 800, epoch: 3 | loss: 1.0147913
	speed: 0.0050s/iter; left time: 27.0160s
	iters: 900, epoch: 3 | loss: 0.5969011
	speed: 0.0051s/iter; left time: 26.9217s
	iters: 1000, epoch: 3 | loss: 0.3220115
	speed: 0.0054s/iter; left time: 27.7104s
Updating learning rate to 0.0011049154554414859
Validation loss decreased (0.3847 --> 0.3779).  Saving model state dict ...
Epoch: 3 cost time: 5.459698677062988
Epoch: 3, Steps: 1027 | Train Loss: 0.6776291 Vali Loss: 0.3778641 Best vali loss: 0.3778641

best validation loss 0.3778641021907447

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0019885065564, 'e_layers': 3, 'learning_rate': 0.0030388265049, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00151941325245
Epoch: 4 cost time: 0.7474348545074463
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3863669 Best vali loss: 0.3743653
Updating learning rate to 0.0009379589738214294
Epoch: 5 cost time: 0.5074286460876465
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4017748 Best vali loss: 0.3743653
Updating learning rate to 0.0004450258382178974
Epoch: 6 cost time: 0.48647260665893555
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4079076 Best vali loss: 0.3743653
Updating learning rate to 0.0001156584470850403
Epoch: 7 cost time: 0.506026029586792
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3911937 Best vali loss: 0.3743653
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5410690307617188
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3964958 Best vali loss: 0.3743653

best validation loss 0.3743652702080477

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0013602383229, 'e_layers': 1, 'learning_rate': 0.0004227075832, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5083258
	speed: 0.0084s/iter; left time: 68.1216s
	iters: 200, epoch: 1 | loss: 0.2757610
	speed: 0.0029s/iter; left time: 22.8790s
	iters: 300, epoch: 1 | loss: 0.4409836
	speed: 0.0029s/iter; left time: 22.6769s
	iters: 400, epoch: 1 | loss: 0.4330593
	speed: 0.0029s/iter; left time: 22.8045s
	iters: 500, epoch: 1 | loss: 0.2164832
	speed: 0.0030s/iter; left time: 22.7955s
	iters: 600, epoch: 1 | loss: 1.1361765
	speed: 0.0029s/iter; left time: 22.1472s
	iters: 700, epoch: 1 | loss: 0.3719678
	speed: 0.0030s/iter; left time: 22.3906s
	iters: 800, epoch: 1 | loss: 0.2670626
	speed: 0.0029s/iter; left time: 21.6482s
	iters: 900, epoch: 1 | loss: 1.3168617
	speed: 0.0030s/iter; left time: 22.1907s
	iters: 1000, epoch: 1 | loss: 1.0532454
	speed: 0.0029s/iter; left time: 21.2399s
Updating learning rate to 0.0004227075832
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 3.300668716430664
Epoch: 1, Steps: 1027 | Train Loss: 0.6019927 Vali Loss: 0.3695375 Best vali loss: 0.3695375
	iters: 100, epoch: 2 | loss: 0.6334462
	speed: 0.0108s/iter; left time: 76.6664s
	iters: 200, epoch: 2 | loss: 1.1173418
	speed: 0.0028s/iter; left time: 19.5457s
	iters: 300, epoch: 2 | loss: 0.4343577
	speed: 0.0028s/iter; left time: 19.4097s
	iters: 400, epoch: 2 | loss: 0.4128014
	speed: 0.0025s/iter; left time: 17.0766s
	iters: 500, epoch: 2 | loss: 0.3307909
	speed: 0.0022s/iter; left time: 14.8877s
	iters: 600, epoch: 2 | loss: 1.2152656
	speed: 0.0023s/iter; left time: 14.8825s
	iters: 700, epoch: 2 | loss: 0.5294794
	speed: 0.0025s/iter; left time: 15.9861s
	iters: 800, epoch: 2 | loss: 0.5542258
	speed: 0.0030s/iter; left time: 19.4361s
	iters: 900, epoch: 2 | loss: 1.1700006
	speed: 0.0028s/iter; left time: 17.7368s
	iters: 1000, epoch: 2 | loss: 0.9580405
	speed: 0.0024s/iter; left time: 15.1217s
Updating learning rate to 0.0002113537916
Epoch: 2 cost time: 2.744232654571533
Epoch: 2, Steps: 1027 | Train Loss: 0.7355750 Vali Loss: 0.3773101 Best vali loss: 0.3695375
	iters: 100, epoch: 3 | loss: 0.6517554
	speed: 0.0092s/iter; left time: 55.8387s
	iters: 200, epoch: 3 | loss: 0.5050877
	speed: 0.0023s/iter; left time: 13.9139s
	iters: 300, epoch: 3 | loss: 0.2007530
	speed: 0.0028s/iter; left time: 16.5747s
	iters: 400, epoch: 3 | loss: 0.5196767
	speed: 0.0027s/iter; left time: 15.2872s
	iters: 500, epoch: 3 | loss: 1.1675161
	speed: 0.0025s/iter; left time: 13.9630s
	iters: 600, epoch: 3 | loss: 0.7121263
	speed: 0.0027s/iter; left time: 14.9275s
	iters: 700, epoch: 3 | loss: 1.3061339
	speed: 0.0024s/iter; left time: 13.0332s
	iters: 800, epoch: 3 | loss: 0.2885508
	speed: 0.0021s/iter; left time: 11.1330s
	iters: 900, epoch: 3 | loss: 0.7959418
	speed: 0.0021s/iter; left time: 10.8221s
	iters: 1000, epoch: 3 | loss: 0.9332997
	speed: 0.0021s/iter; left time: 11.0968s
Updating learning rate to 0.0001056768958
Epoch: 3 cost time: 2.5391037464141846
Epoch: 3, Steps: 1027 | Train Loss: 0.7080841 Vali Loss: 0.3773677 Best vali loss: 0.3695375
	iters: 100, epoch: 4 | loss: 0.2884359
	speed: 0.0103s/iter; left time: 51.9373s
	iters: 200, epoch: 4 | loss: 0.7404339
	speed: 0.0030s/iter; left time: 14.8142s
	iters: 300, epoch: 4 | loss: 0.5188512
	speed: 0.0031s/iter; left time: 14.8300s
	iters: 400, epoch: 4 | loss: 0.4763316
	speed: 0.0030s/iter; left time: 14.1217s
	iters: 500, epoch: 4 | loss: 0.3192078
	speed: 0.0030s/iter; left time: 13.7457s
	iters: 600, epoch: 4 | loss: 0.3255916
	speed: 0.0030s/iter; left time: 13.7174s
	iters: 700, epoch: 4 | loss: 0.2882687
	speed: 0.0030s/iter; left time: 13.2284s
	iters: 800, epoch: 4 | loss: 0.2976515
	speed: 0.0029s/iter; left time: 12.6994s
	iters: 900, epoch: 4 | loss: 1.0654649
	speed: 0.0029s/iter; left time: 12.0978s
	iters: 1000, epoch: 4 | loss: 0.6041585
	speed: 0.0029s/iter; left time: 11.9088s
Updating learning rate to 5.28384479e-05
Epoch: 4 cost time: 3.1014773845672607
Epoch: 4, Steps: 1027 | Train Loss: 0.4924396 Vali Loss: 0.3797058 Best vali loss: 0.3695375
	iters: 100, epoch: 5 | loss: 0.6043802
	speed: 0.0113s/iter; left time: 45.4768s
	iters: 200, epoch: 5 | loss: 0.3635394
	speed: 0.0031s/iter; left time: 11.9560s
	iters: 300, epoch: 5 | loss: 0.4992768
	speed: 0.0031s/iter; left time: 11.7780s
	iters: 400, epoch: 5 | loss: 1.1729193
	speed: 0.0030s/iter; left time: 11.1000s
	iters: 500, epoch: 5 | loss: 0.3655034
	speed: 0.0030s/iter; left time: 10.8036s
	iters: 600, epoch: 5 | loss: 0.2222359
	speed: 0.0030s/iter; left time: 10.4756s
	iters: 700, epoch: 5 | loss: 0.6567111
	speed: 0.0027s/iter; left time: 9.2795s
	iters: 800, epoch: 5 | loss: 0.2924511
	speed: 0.0025s/iter; left time: 8.3785s
	iters: 900, epoch: 5 | loss: 0.4770514
	speed: 0.0025s/iter; left time: 7.9200s
	iters: 1000, epoch: 5 | loss: 0.4641474
	speed: 0.0031s/iter; left time: 9.4850s
Updating learning rate to 2.641922395e-05
Epoch: 5 cost time: 3.0389420986175537
Epoch: 5, Steps: 1027 | Train Loss: 0.5118216 Vali Loss: 0.3837584 Best vali loss: 0.3695375
	iters: 100, epoch: 6 | loss: 0.2515256
	speed: 0.0107s/iter; left time: 31.7988s
	iters: 200, epoch: 6 | loss: 0.4072807
	speed: 0.0031s/iter; left time: 8.8239s
	iters: 300, epoch: 6 | loss: 0.3212737
	speed: 0.0029s/iter; left time: 8.1559s
	iters: 400, epoch: 6 | loss: 0.6220251
	speed: 0.0031s/iter; left time: 8.3472s
	iters: 500, epoch: 6 | loss: 0.2964546
	speed: 0.0029s/iter; left time: 7.4828s
	iters: 600, epoch: 6 | loss: 0.7752023
	speed: 0.0030s/iter; left time: 7.3909s
	iters: 700, epoch: 6 | loss: 0.2080818
	speed: 0.0026s/iter; left time: 6.2500s
	iters: 800, epoch: 6 | loss: 0.3541681
	speed: 0.0028s/iter; left time: 6.2776s
	iters: 900, epoch: 6 | loss: 0.3028274
	speed: 0.0028s/iter; left time: 6.0208s
	iters: 1000, epoch: 6 | loss: 0.4636997
	speed: 0.0028s/iter; left time: 5.8366s
Updating learning rate to 1.3209611975e-05
Epoch: 6 cost time: 3.0215985774993896
Epoch: 6, Steps: 1027 | Train Loss: 0.4002539 Vali Loss: 0.3838844 Best vali loss: 0.3695375
	iters: 100, epoch: 7 | loss: 0.7989547
	speed: 0.0109s/iter; left time: 21.3325s
	iters: 200, epoch: 7 | loss: 0.4551536
	speed: 0.0030s/iter; left time: 5.5271s
	iters: 300, epoch: 7 | loss: 0.3418345
	speed: 0.0030s/iter; left time: 5.2009s
	iters: 400, epoch: 7 | loss: 0.3479948
	speed: 0.0029s/iter; left time: 4.7781s
	iters: 500, epoch: 7 | loss: 0.9082726
	speed: 0.0028s/iter; left time: 4.3718s
	iters: 600, epoch: 7 | loss: 0.4098041
	speed: 0.0026s/iter; left time: 3.7543s
	iters: 700, epoch: 7 | loss: 0.2492343
	speed: 0.0026s/iter; left time: 3.5410s
	iters: 800, epoch: 7 | loss: 0.3252937
	speed: 0.0028s/iter; left time: 3.5032s
	iters: 900, epoch: 7 | loss: 0.2929614
	speed: 0.0030s/iter; left time: 3.5190s
	iters: 1000, epoch: 7 | loss: 0.4113535
	speed: 0.0030s/iter; left time: 3.1956s
Updating learning rate to 6.6048059875e-06
Epoch: 7 cost time: 3.0140743255615234
Epoch: 7, Steps: 1027 | Train Loss: 0.4540857 Vali Loss: 0.3836117 Best vali loss: 0.3695375
	iters: 100, epoch: 8 | loss: 0.8275717
	speed: 0.0107s/iter; left time: 9.9466s
	iters: 200, epoch: 8 | loss: 0.2557327
	speed: 0.0030s/iter; left time: 2.4518s
	iters: 300, epoch: 8 | loss: 0.2486395
	speed: 0.0030s/iter; left time: 2.1600s
	iters: 400, epoch: 8 | loss: 0.6019968
	speed: 0.0030s/iter; left time: 1.8634s
	iters: 500, epoch: 8 | loss: 0.2984832
	speed: 0.0029s/iter; left time: 1.5251s
	iters: 600, epoch: 8 | loss: 0.8218654
	speed: 0.0029s/iter; left time: 1.2437s
	iters: 700, epoch: 8 | loss: 0.9029074
	speed: 0.0029s/iter; left time: 0.9364s
	iters: 800, epoch: 8 | loss: 0.1774314
	speed: 0.0030s/iter; left time: 0.6924s
	iters: 900, epoch: 8 | loss: 0.3295360
	speed: 0.0030s/iter; left time: 0.3799s
	iters: 1000, epoch: 8 | loss: 0.2655491
	speed: 0.0031s/iter; left time: 0.0861s
Updating learning rate to 3.30240299375e-06
Epoch: 8 cost time: 3.09014630317688
Epoch: 8, Steps: 1027 | Train Loss: 0.4729713 Vali Loss: 0.3833123 Best vali loss: 0.3695375

best validation loss 0.3695374690069431

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010436703114, 'e_layers': 3, 'learning_rate': 0.0001549877333, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4490148
	speed: 0.0120s/iter; left time: 23.4942s
	iters: 200, epoch: 1 | loss: 1.0620397
	speed: 0.0062s/iter; left time: 11.4598s
Updating learning rate to 0.0001549877333
Validation loss decreased (inf --> 0.3800).  Saving model state dict ...
Epoch: 1 cost time: 1.8697807788848877
Epoch: 1, Steps: 257 | Train Loss: 0.7555273 Vali Loss: 0.3800147 Best vali loss: 0.3800147
	iters: 100, epoch: 2 | loss: 0.4468892
	speed: 0.0143s/iter; left time: 24.3394s
	iters: 200, epoch: 2 | loss: 0.8696648
	speed: 0.0065s/iter; left time: 10.3476s
Updating learning rate to 7.749386665e-05
Validation loss decreased (0.3800 --> 0.3681).  Saving model state dict ...
Epoch: 2 cost time: 1.7277438640594482
Epoch: 2, Steps: 257 | Train Loss: 0.6582770 Vali Loss: 0.3681182 Best vali loss: 0.3681182
	iters: 100, epoch: 3 | loss: 0.4390881
	speed: 0.0142s/iter; left time: 20.4246s
	iters: 200, epoch: 3 | loss: 0.4167971
	speed: 0.0064s/iter; left time: 8.5418s
Updating learning rate to 3.8746933325e-05
Validation loss decreased (0.3681 --> 0.3677).  Saving model state dict ...
Epoch: 3 cost time: 1.7216343879699707
Epoch: 3, Steps: 257 | Train Loss: 0.4279426 Vali Loss: 0.3676654 Best vali loss: 0.3676654
	iters: 100, epoch: 4 | loss: 0.5939962
	speed: 0.0140s/iter; left time: 16.6093s
	iters: 200, epoch: 4 | loss: 0.3093784
	speed: 0.0061s/iter; left time: 6.5986s
Updating learning rate to 1.93734666625e-05
Validation loss decreased (0.3677 --> 0.3662).  Saving model state dict ...
Epoch: 4 cost time: 1.6965482234954834
Epoch: 4, Steps: 257 | Train Loss: 0.4516873 Vali Loss: 0.3662076 Best vali loss: 0.3662076
	iters: 100, epoch: 5 | loss: 0.6398381
	speed: 0.0149s/iter; left time: 13.8228s
	iters: 200, epoch: 5 | loss: 0.8597845
	speed: 0.0042s/iter; left time: 3.5225s
Updating learning rate to 9.68673333125e-06
Epoch: 5 cost time: 1.3841276168823242
Epoch: 5, Steps: 257 | Train Loss: 0.7498113 Vali Loss: 0.3663137 Best vali loss: 0.3662076
	iters: 100, epoch: 6 | loss: 0.8185682
	speed: 0.0116s/iter; left time: 7.7662s
	iters: 200, epoch: 6 | loss: 0.5408171
	speed: 0.0064s/iter; left time: 3.6827s
Updating learning rate to 4.843366665625e-06
Epoch: 6 cost time: 1.6656074523925781
Epoch: 6, Steps: 257 | Train Loss: 0.6796927 Vali Loss: 0.3662365 Best vali loss: 0.3662076
	iters: 100, epoch: 7 | loss: 0.9928078
	speed: 0.0133s/iter; left time: 5.5278s
	iters: 200, epoch: 7 | loss: 0.5398086
	speed: 0.0062s/iter; left time: 1.9543s
Updating learning rate to 2.4216833328125e-06
Epoch: 7 cost time: 1.625046730041504
Epoch: 7, Steps: 257 | Train Loss: 0.7663082 Vali Loss: 0.3662552 Best vali loss: 0.3662076
	iters: 100, epoch: 8 | loss: 0.8042796
	speed: 0.0129s/iter; left time: 2.0324s
	iters: 200, epoch: 8 | loss: 0.7032928
	speed: 0.0063s/iter; left time: 0.3631s
Updating learning rate to 1.21084166640625e-06
Epoch: 8 cost time: 1.6466636657714844
Epoch: 8, Steps: 257 | Train Loss: 0.7537862 Vali Loss: 0.3662714 Best vali loss: 0.3662076

best validation loss 0.36620758488510824

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.010984893356, 'e_layers': 2, 'learning_rate': 0.001815341793, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5791466
	speed: 0.0117s/iter; left time: 10.9601s
Updating learning rate to 0.001815341793
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 1.0760867595672607
Epoch: 1, Steps: 129 | Train Loss: 0.5791466 Vali Loss: 0.3671319 Best vali loss: 0.3671319
	iters: 100, epoch: 2 | loss: 0.5474000
	speed: 0.0108s/iter; left time: 8.6807s
Updating learning rate to 0.0009076708965
Epoch: 2 cost time: 0.869145393371582
Epoch: 2, Steps: 129 | Train Loss: 0.5474000 Vali Loss: 0.3759831 Best vali loss: 0.3671319
	iters: 100, epoch: 3 | loss: 0.6999136
	speed: 0.0104s/iter; left time: 7.0304s
Updating learning rate to 0.00045383544825
Epoch: 3 cost time: 0.8156919479370117
Epoch: 3, Steps: 129 | Train Loss: 0.6999136 Vali Loss: 0.3708487 Best vali loss: 0.3671319

best validation loss 0.36713191796613814

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.0047486145421, 'e_layers': 4, 'learning_rate': 0.0019208975706, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0018477877600639972
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 0.8353297710418701
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3706290 Best vali loss: 0.3706290
Updating learning rate to 0.0016395886343680123
Validation loss decreased (0.3706 --> 0.3698).  Saving model state dict ...
Epoch: 2 cost time: 0.556647539138794
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3698339 Best vali loss: 0.3698339
Updating learning rate to 0.0013279966230694852
Epoch: 3 cost time: 0.5562801361083984
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3741578 Best vali loss: 0.3698339

best validation loss 0.36983390364993535

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6541408
	speed: 0.0105s/iter; left time: 20.4756s
	iters: 200, epoch: 1 | loss: 0.5457284
	speed: 0.0037s/iter; left time: 6.9213s
Updating learning rate to 0.0006618030633303181
Validation loss decreased (inf --> 0.3671).  Saving model state dict ...
Epoch: 1 cost time: 1.3510799407958984
Epoch: 1, Steps: 257 | Train Loss: 0.5999346 Vali Loss: 0.3670771 Best vali loss: 0.3670771
	iters: 100, epoch: 2 | loss: 0.6234131
	speed: 0.0074s/iter; left time: 12.6089s
	iters: 200, epoch: 2 | loss: 0.3429789
	speed: 0.0026s/iter; left time: 4.2351s
Updating learning rate to 0.0005872345321676674
Validation loss decreased (0.3671 --> 0.3622).  Saving model state dict ...
Epoch: 2 cost time: 0.7265362739562988
Epoch: 2, Steps: 257 | Train Loss: 0.4831960 Vali Loss: 0.3622359 Best vali loss: 0.3622359
	iters: 100, epoch: 3 | loss: 0.5501881
	speed: 0.0093s/iter; left time: 13.3898s
	iters: 200, epoch: 3 | loss: 0.6006998
	speed: 0.0038s/iter; left time: 5.1650s
Updating learning rate to 0.0004756348387161433
Epoch: 3 cost time: 1.0890815258026123
Epoch: 3, Steps: 257 | Train Loss: 0.5754440 Vali Loss: 0.3703543 Best vali loss: 0.3622359

best validation loss 0.3622358912803335

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0038993371015, 'e_layers': 1, 'learning_rate': 0.0006879880493, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5974420
	speed: 0.0099s/iter; left time: 11.7066s
	iters: 200, epoch: 4 | loss: 0.4793311
	speed: 0.0031s/iter; left time: 3.3699s
Updating learning rate to 0.00034399402465
Epoch: 4 cost time: 1.1505138874053955
Epoch: 4, Steps: 257 | Train Loss: 0.5383866 Vali Loss: 0.3796809 Best vali loss: 0.3622359
	iters: 100, epoch: 5 | loss: 0.5702112
	speed: 0.0065s/iter; left time: 6.0286s
	iters: 200, epoch: 5 | loss: 0.2906631
	speed: 0.0036s/iter; left time: 2.9722s
Updating learning rate to 0.00021235321058385673
Epoch: 5 cost time: 0.9193952083587646
Epoch: 5, Steps: 257 | Train Loss: 0.4304371 Vali Loss: 0.3853641 Best vali loss: 0.3622359
	iters: 100, epoch: 6 | loss: 0.5132976
	speed: 0.0098s/iter; left time: 6.5850s
	iters: 200, epoch: 6 | loss: 0.5855001
	speed: 0.0042s/iter; left time: 2.4195s
Updating learning rate to 0.00010075351713233263
Epoch: 6 cost time: 1.1376049518585205
Epoch: 6, Steps: 257 | Train Loss: 0.5493988 Vali Loss: 0.3926730 Best vali loss: 0.3622359
	iters: 100, epoch: 7 | loss: 0.4640875
	speed: 0.0106s/iter; left time: 4.4011s
	iters: 200, epoch: 7 | loss: 0.4142731
	speed: 0.0028s/iter; left time: 0.8710s
Updating learning rate to 2.6184985969681952e-05
Epoch: 7 cost time: 0.9192764759063721
Epoch: 7, Steps: 257 | Train Loss: 0.4391803 Vali Loss: 0.3916447 Best vali loss: 0.3622359
	iters: 100, epoch: 8 | loss: 0.4865875
	speed: 0.0078s/iter; left time: 1.2283s
	iters: 200, epoch: 8 | loss: 0.6358122
	speed: 0.0042s/iter; left time: 0.2459s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.096073865890503
Epoch: 8, Steps: 257 | Train Loss: 0.5611998 Vali Loss: 0.3943273 Best vali loss: 0.3622359

best validation loss 0.3622358912803335

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0032599720922, 'e_layers': 1, 'learning_rate': 0.0002521535593, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002425565358935705
Validation loss decreased (inf --> 0.4189).  Saving model state dict ...
Epoch: 1 cost time: 0.7398648262023926
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4189088 Best vali loss: 0.4189088
Updating learning rate to 0.0002152265254906771
Validation loss decreased (0.4189 --> 0.3987).  Saving model state dict ...
Epoch: 2 cost time: 0.5267589092254639
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3987379 Best vali loss: 0.3987379
Updating learning rate to 0.0001743242744279991
Validation loss decreased (0.3987 --> 0.3871).  Saving model state dict ...
Epoch: 3 cost time: 0.4521644115447998
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3870725 Best vali loss: 0.3870725
Updating learning rate to 0.00012607677965
Validation loss decreased (0.3871 --> 0.3815).  Saving model state dict ...
Epoch: 4 cost time: 0.3311793804168701
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3815082 Best vali loss: 0.3815082
Updating learning rate to 7.782928487200091e-05
Validation loss decreased (0.3815 --> 0.3779).  Saving model state dict ...
Epoch: 5 cost time: 0.33061647415161133
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3779277 Best vali loss: 0.3779277
Updating learning rate to 3.692703380932289e-05
Validation loss decreased (0.3779 --> 0.3765).  Saving model state dict ...
Epoch: 6 cost time: 0.45851564407348633
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3765083 Best vali loss: 0.3765083
Updating learning rate to 9.59702340642949e-06
Validation loss decreased (0.3765 --> 0.3757).  Saving model state dict ...
Epoch: 7 cost time: 0.45029664039611816
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3757327 Best vali loss: 0.3757327
Updating learning rate to 0.0
Validation loss decreased (0.3757 --> 0.3755).  Saving model state dict ...
Epoch: 8 cost time: 0.48145604133605957
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3755454 Best vali loss: 0.3755454

best validation loss 0.3755454052525091

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 3, 'learning_rate': 0.0006514874423, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4583203
	speed: 0.0134s/iter; left time: 12.5320s
Updating learning rate to 0.0006514874423
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.296720027923584
Epoch: 1, Steps: 129 | Train Loss: 0.4583203 Vali Loss: 0.3670406 Best vali loss: 0.3670406
	iters: 100, epoch: 2 | loss: 0.8212556
	speed: 0.0103s/iter; left time: 8.2787s
Updating learning rate to 0.00032574372115
Epoch: 2 cost time: 0.7079133987426758
Epoch: 2, Steps: 129 | Train Loss: 0.8212556 Vali Loss: 0.3717321 Best vali loss: 0.3670406
	iters: 100, epoch: 3 | loss: 0.5898932
	speed: 0.0113s/iter; left time: 7.6520s
Updating learning rate to 0.000162871860575
Validation loss decreased (0.3670 --> 0.3660).  Saving model state dict ...
Epoch: 3 cost time: 0.9987127780914307
Epoch: 3, Steps: 129 | Train Loss: 0.5898932 Vali Loss: 0.3659651 Best vali loss: 0.3659651
	iters: 100, epoch: 4 | loss: 0.3881087
	speed: 0.0127s/iter; left time: 6.9074s
Updating learning rate to 8.14359302875e-05
Validation loss decreased (0.3660 --> 0.3513).  Saving model state dict ...
Epoch: 4 cost time: 1.0417115688323975
Epoch: 4, Steps: 129 | Train Loss: 0.3881087 Vali Loss: 0.3513389 Best vali loss: 0.3513389
	iters: 100, epoch: 5 | loss: 0.5279941
	speed: 0.0125s/iter; left time: 5.2254s
Updating learning rate to 4.071796514375e-05
Epoch: 5 cost time: 0.9628384113311768
Epoch: 5, Steps: 129 | Train Loss: 0.5279941 Vali Loss: 0.3529952 Best vali loss: 0.3513389
	iters: 100, epoch: 6 | loss: 0.5032858
	speed: 0.0120s/iter; left time: 3.4495s
Updating learning rate to 2.0358982571875e-05
Epoch: 6 cost time: 0.9870421886444092
Epoch: 6, Steps: 129 | Train Loss: 0.5032858 Vali Loss: 0.3523760 Best vali loss: 0.3513389
	iters: 100, epoch: 7 | loss: 0.5262806
	speed: 0.0116s/iter; left time: 1.8426s
Updating learning rate to 1.01794912859375e-05
Validation loss decreased (0.3513 --> 0.3509).  Saving model state dict ...
Epoch: 7 cost time: 0.8692953586578369
Epoch: 7, Steps: 129 | Train Loss: 0.5262806 Vali Loss: 0.3508634 Best vali loss: 0.3508634
	iters: 100, epoch: 8 | loss: 0.4628353
	speed: 0.0091s/iter; left time: 0.2742s
Updating learning rate to 5.08974564296875e-06
Epoch: 8 cost time: 0.8438520431518555
Epoch: 8, Steps: 129 | Train Loss: 0.4628353 Vali Loss: 0.3520599 Best vali loss: 0.3508634

best validation loss 0.35086339196896504

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0065094553439, 'e_layers': 1, 'learning_rate': 0.0006735335754, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6655768
	speed: 0.0110s/iter; left time: 10.2364s
Updating learning rate to 0.0006478987300856038
Validation loss decreased (inf --> 0.3749).  Saving model state dict ...
Epoch: 1 cost time: 0.9360344409942627
Epoch: 1, Steps: 129 | Train Loss: 0.6655768 Vali Loss: 0.3748678 Best vali loss: 0.3748678
	iters: 100, epoch: 2 | loss: 0.5196534
	speed: 0.0090s/iter; left time: 7.2071s
Updating learning rate to 0.0005748968669610804
Validation loss decreased (0.3749 --> 0.3672).  Saving model state dict ...
Epoch: 2 cost time: 0.7130494117736816
Epoch: 2, Steps: 129 | Train Loss: 0.5196534 Vali Loss: 0.3671632 Best vali loss: 0.3671632
	iters: 100, epoch: 3 | loss: 0.7882104
	speed: 0.0091s/iter; left time: 6.1373s
Updating learning rate to 0.00046564185792360155
Validation loss decreased (0.3672 --> 0.3662).  Saving model state dict ...
Epoch: 3 cost time: 0.6996574401855469
Epoch: 3, Steps: 129 | Train Loss: 0.7882104 Vali Loss: 0.3662150 Best vali loss: 0.3662150

best validation loss 0.36621502846303766

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0029036262858, 'e_layers': 2, 'learning_rate': 0.0030636692136, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6976160
	speed: 0.0103s/iter; left time: 83.3506s
	iters: 200, epoch: 1 | loss: 1.0550243
	speed: 0.0061s/iter; left time: 49.2887s
	iters: 300, epoch: 1 | loss: 0.5510468
	speed: 0.0041s/iter; left time: 32.0868s
	iters: 400, epoch: 1 | loss: 0.3599459
	speed: 0.0061s/iter; left time: 47.7113s
	iters: 500, epoch: 1 | loss: 0.9463756
	speed: 0.0041s/iter; left time: 31.4944s
	iters: 600, epoch: 1 | loss: 1.1386013
	speed: 0.0057s/iter; left time: 43.3850s
	iters: 700, epoch: 1 | loss: 0.4039845
	speed: 0.0039s/iter; left time: 29.0719s
	iters: 800, epoch: 1 | loss: 1.1670455
	speed: 0.0029s/iter; left time: 21.7104s
	iters: 900, epoch: 1 | loss: 1.2023957
	speed: 0.0030s/iter; left time: 21.6409s
	iters: 1000, epoch: 1 | loss: 0.3571854
	speed: 0.0035s/iter; left time: 25.3306s
Updating learning rate to 0.0030636692136
Validation loss decreased (inf --> 0.4019).  Saving model state dict ...
Epoch: 1 cost time: 4.774709939956665
Epoch: 1, Steps: 1027 | Train Loss: 0.7879221 Vali Loss: 0.4018834 Best vali loss: 0.4018834
	iters: 100, epoch: 2 | loss: 0.4178559
	speed: 0.0117s/iter; left time: 83.2208s
	iters: 200, epoch: 2 | loss: 0.4745667
	speed: 0.0039s/iter; left time: 27.1447s
	iters: 300, epoch: 2 | loss: 0.4564523
	speed: 0.0039s/iter; left time: 26.7042s
	iters: 400, epoch: 2 | loss: 0.3134440
	speed: 0.0032s/iter; left time: 21.5558s
	iters: 500, epoch: 2 | loss: 0.3630237
	speed: 0.0033s/iter; left time: 21.7661s
	iters: 600, epoch: 2 | loss: 0.5045131
	speed: 0.0041s/iter; left time: 26.8773s
	iters: 700, epoch: 2 | loss: 0.3324800
	speed: 0.0044s/iter; left time: 28.3840s
	iters: 800, epoch: 2 | loss: 0.7422003
	speed: 0.0045s/iter; left time: 28.8741s
	iters: 900, epoch: 2 | loss: 1.1009337
	speed: 0.0045s/iter; left time: 28.0933s
	iters: 1000, epoch: 2 | loss: 0.5785457
	speed: 0.0044s/iter; left time: 27.4258s
Updating learning rate to 0.0015318346068
Epoch: 2 cost time: 4.147494792938232
Epoch: 2, Steps: 1027 | Train Loss: 0.5284015 Vali Loss: 0.4064712 Best vali loss: 0.4018834
	iters: 100, epoch: 3 | loss: 0.5860876
	speed: 0.0143s/iter; left time: 86.4860s
	iters: 200, epoch: 3 | loss: 0.5021978
	speed: 0.0045s/iter; left time: 27.0919s
	iters: 300, epoch: 3 | loss: 0.9885700
	speed: 0.0045s/iter; left time: 26.6323s
	iters: 400, epoch: 3 | loss: 0.3629518
	speed: 0.0041s/iter; left time: 23.7201s
	iters: 500, epoch: 3 | loss: 0.5798774
	speed: 0.0042s/iter; left time: 23.6094s
	iters: 600, epoch: 3 | loss: 0.4346118
	speed: 0.0045s/iter; left time: 24.9772s
	iters: 700, epoch: 3 | loss: 0.6886279
	speed: 0.0045s/iter; left time: 24.4713s
	iters: 800, epoch: 3 | loss: 0.3947352
	speed: 0.0046s/iter; left time: 24.8573s
	iters: 900, epoch: 3 | loss: 0.3107733
	speed: 0.0046s/iter; left time: 24.2094s
	iters: 1000, epoch: 3 | loss: 0.8327140
	speed: 0.0045s/iter; left time: 23.4022s
Updating learning rate to 0.0007659173034
Epoch: 3 cost time: 4.650420427322388
Epoch: 3, Steps: 1027 | Train Loss: 0.5681147 Vali Loss: 0.4029476 Best vali loss: 0.4018834

best validation loss 0.401883370053089

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001591137315
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 0.9017603397369385
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3649267 Best vali loss: 0.3649267
Updating learning rate to 7.955686575e-05
Epoch: 2 cost time: 0.6574018001556396
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3652224 Best vali loss: 0.3649267
Updating learning rate to 3.9778432875e-05
Validation loss decreased (0.3649 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 0.6575078964233398
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3639210 Best vali loss: 0.3639210

best validation loss 0.3639209767455905

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0084474402652, 'e_layers': 2, 'learning_rate': 0.0001591137315, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 1.98892164375e-05
Validation loss decreased (0.3639 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 0.9114663600921631
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3553425 Best vali loss: 0.3553425
Updating learning rate to 9.94460821875e-06
Epoch: 5 cost time: 0.66015625
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3580550 Best vali loss: 0.3553425
Updating learning rate to 4.972304109375e-06
Epoch: 6 cost time: 0.6777687072753906
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3580759 Best vali loss: 0.3553425
Updating learning rate to 2.4861520546875e-06
Validation loss decreased (0.3553 --> 0.3551).  Saving model state dict ...
Epoch: 7 cost time: 0.6709725856781006
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3550677 Best vali loss: 0.3550677
Updating learning rate to 1.24307602734375e-06
Epoch: 8 cost time: 0.6683993339538574
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3560495 Best vali loss: 0.3550677

best validation loss 0.35506766638727694

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.01186370118, 'e_layers': 4, 'learning_rate': 0.0002221655976, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002221655976
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.3202087879180908
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3655173 Best vali loss: 0.3655173
Updating learning rate to 0.0001110827988
Validation loss decreased (0.3655 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 1.1001770496368408
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3640849 Best vali loss: 0.3640849
Updating learning rate to 5.55413994e-05
Epoch: 3 cost time: 1.032477855682373
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3661154 Best vali loss: 0.3640849
Updating learning rate to 2.77706997e-05
Epoch: 4 cost time: 0.6295995712280273
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3666624 Best vali loss: 0.3640849
Updating learning rate to 1.388534985e-05
Epoch: 5 cost time: 1.100508689880371
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3658941 Best vali loss: 0.3640849
Updating learning rate to 6.942674925e-06
Epoch: 6 cost time: 1.066650629043579
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3651171 Best vali loss: 0.3640849
Updating learning rate to 3.4713374625e-06
Epoch: 7 cost time: 0.9709558486938477
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3641247 Best vali loss: 0.3640849
Updating learning rate to 1.73566873125e-06
Epoch: 8 cost time: 0.9838812351226807
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3641074 Best vali loss: 0.3640849

best validation loss 0.36408491425055184

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0014508988157, 'e_layers': 3, 'learning_rate': 0.0010889710455, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0010889710455
Validation loss decreased (inf --> 0.3790).  Saving model state dict ...
Epoch: 1 cost time: 0.8926746845245361
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3789868 Best vali loss: 0.3789868
Updating learning rate to 0.00054448552275
Validation loss decreased (0.3790 --> 0.3715).  Saving model state dict ...
Epoch: 2 cost time: 0.7526092529296875
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3714922 Best vali loss: 0.3714922
Updating learning rate to 0.000272242761375
Validation loss decreased (0.3715 --> 0.3555).  Saving model state dict ...
Epoch: 3 cost time: 0.8290603160858154
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3554642 Best vali loss: 0.3554642
Updating learning rate to 0.0001361213806875
Validation loss decreased (0.3555 --> 0.3553).  Saving model state dict ...
Epoch: 4 cost time: 0.8756189346313477
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3553264 Best vali loss: 0.3553264
Updating learning rate to 6.806069034375e-05
Validation loss decreased (0.3553 --> 0.3527).  Saving model state dict ...
Epoch: 5 cost time: 0.9047584533691406
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3527480 Best vali loss: 0.3527480
Updating learning rate to 3.4030345171875e-05
Epoch: 6 cost time: 0.9810504913330078
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3527796 Best vali loss: 0.3527480
Updating learning rate to 1.70151725859375e-05
Epoch: 7 cost time: 0.9472935199737549
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3537726 Best vali loss: 0.3527480
Updating learning rate to 8.50758629296875e-06
Epoch: 8 cost time: 0.9405145645141602
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3541751 Best vali loss: 0.3527480

best validation loss 0.3527479871082868

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005760452490497884
Validation loss decreased (inf --> 0.3931).  Saving model state dict ...
Epoch: 1 cost time: 0.6411559581756592
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3931123 Best vali loss: 0.3931123
Updating learning rate to 0.0005111394628953558
Validation loss decreased (0.3931 --> 0.3749).  Saving model state dict ...
Epoch: 2 cost time: 0.3297398090362549
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3748517 Best vali loss: 0.3748517
Updating learning rate to 0.00041400108930629814
Validation loss decreased (0.3749 --> 0.3698).  Saving model state dict ...
Epoch: 3 cost time: 0.5449197292327881
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3697512 Best vali loss: 0.3697512

best validation loss 0.3697511877198585

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 2, 'learning_rate': 0.0015995261445, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3869054
	speed: 0.0127s/iter; left time: 103.3809s
	iters: 200, epoch: 1 | loss: 0.9458450
	speed: 0.0069s/iter; left time: 55.2337s
	iters: 300, epoch: 1 | loss: 0.3140505
	speed: 0.0067s/iter; left time: 52.7381s
	iters: 400, epoch: 1 | loss: 0.2554969
	speed: 0.0054s/iter; left time: 41.8689s
	iters: 500, epoch: 1 | loss: 0.2994528
	speed: 0.0058s/iter; left time: 44.7088s
	iters: 600, epoch: 1 | loss: 0.5178058
	speed: 0.0063s/iter; left time: 47.7320s
	iters: 700, epoch: 1 | loss: 0.4943897
	speed: 0.0069s/iter; left time: 51.6028s
	iters: 800, epoch: 1 | loss: 0.7619517
	speed: 0.0031s/iter; left time: 22.8814s
	iters: 900, epoch: 1 | loss: 0.9705107
	speed: 0.0029s/iter; left time: 21.4251s
	iters: 1000, epoch: 1 | loss: 0.4185720
	speed: 0.0030s/iter; left time: 21.5722s
Updating learning rate to 0.0015386478055601205
Validation loss decreased (inf --> 0.4306).  Saving model state dict ...
Epoch: 1 cost time: 5.79980731010437
Epoch: 1, Steps: 1027 | Train Loss: 0.5364980 Vali Loss: 0.4306279 Best vali loss: 0.4306279
	iters: 100, epoch: 2 | loss: 0.3674138
	speed: 0.0111s/iter; left time: 78.3788s
	iters: 200, epoch: 2 | loss: 0.2662011
	speed: 0.0033s/iter; left time: 23.1577s
	iters: 300, epoch: 2 | loss: 0.4678674
	speed: 0.0033s/iter; left time: 22.6129s
	iters: 400, epoch: 2 | loss: 0.3768730
	speed: 0.0030s/iter; left time: 20.1342s
	iters: 500, epoch: 2 | loss: 0.3108070
	speed: 0.0030s/iter; left time: 19.7614s
	iters: 600, epoch: 2 | loss: 0.6355934
	speed: 0.0035s/iter; left time: 23.3540s
	iters: 700, epoch: 2 | loss: 0.7124351
	speed: 0.0044s/iter; left time: 28.2417s
	iters: 800, epoch: 2 | loss: 0.3434785
	speed: 0.0045s/iter; left time: 28.5608s
	iters: 900, epoch: 2 | loss: 0.3717250
	speed: 0.0043s/iter; left time: 27.2173s
	iters: 1000, epoch: 2 | loss: 2.0668273
	speed: 0.0043s/iter; left time: 26.6480s
Updating learning rate to 0.0013652809639805618
Validation loss decreased (0.4306 --> 0.3906).  Saving model state dict ...
Epoch: 2 cost time: 3.849327564239502
Epoch: 2, Steps: 1027 | Train Loss: 0.5919222 Vali Loss: 0.3906097 Best vali loss: 0.3906097
	iters: 100, epoch: 3 | loss: 0.7619036
	speed: 0.0138s/iter; left time: 83.6545s
	iters: 200, epoch: 3 | loss: 0.3500323
	speed: 0.0043s/iter; left time: 25.5558s
	iters: 300, epoch: 3 | loss: 0.3334154
	speed: 0.0043s/iter; left time: 25.4681s
	iters: 400, epoch: 3 | loss: 0.3756845
	speed: 0.0036s/iter; left time: 20.6650s
	iters: 500, epoch: 3 | loss: 0.7969464
	speed: 0.0034s/iter; left time: 19.2970s
	iters: 600, epoch: 3 | loss: 0.2648839
	speed: 0.0044s/iter; left time: 24.3415s
	iters: 700, epoch: 3 | loss: 0.3629952
	speed: 0.0043s/iter; left time: 23.2735s
	iters: 800, epoch: 3 | loss: 0.6559971
	speed: 0.0043s/iter; left time: 23.0754s
	iters: 900, epoch: 3 | loss: 0.4795507
	speed: 0.0043s/iter; left time: 22.4801s
	iters: 1000, epoch: 3 | loss: 0.3044723
	speed: 0.0043s/iter; left time: 22.2489s
Updating learning rate to 0.0011058191498174795
Epoch: 3 cost time: 4.309332847595215
Epoch: 3, Steps: 1027 | Train Loss: 0.4685881 Vali Loss: 0.4035253 Best vali loss: 0.3906097

best validation loss 0.390609705237368

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.001776105869, 'e_layers': 3, 'learning_rate': 0.0035322605912, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8343195
	speed: 0.0116s/iter; left time: 22.7857s
	iters: 200, epoch: 1 | loss: 0.6087764
	speed: 0.0060s/iter; left time: 11.1242s
Updating learning rate to 0.0033978219274529487
Validation loss decreased (inf --> 0.4076).  Saving model state dict ...
Epoch: 1 cost time: 1.8426744937896729
Epoch: 1, Steps: 257 | Train Loss: 0.7215479 Vali Loss: 0.4075584 Best vali loss: 0.4075584
	iters: 100, epoch: 2 | loss: 0.6942447
	speed: 0.0130s/iter; left time: 22.0599s
	iters: 200, epoch: 2 | loss: 0.4757212
	speed: 0.0061s/iter; left time: 9.7620s
Updating learning rate to 0.003014973004077762
Validation loss decreased (0.4076 --> 0.4039).  Saving model state dict ...
Epoch: 2 cost time: 1.5739202499389648
Epoch: 2, Steps: 257 | Train Loss: 0.5849830 Vali Loss: 0.4038756 Best vali loss: 0.4038756
	iters: 100, epoch: 3 | loss: 0.5857604
	speed: 0.0135s/iter; left time: 19.5219s
	iters: 200, epoch: 3 | loss: 0.3434760
	speed: 0.0060s/iter; left time: 8.0294s
Updating learning rate to 0.0024419990991241787
Epoch: 3 cost time: 1.6212351322174072
Epoch: 3, Steps: 257 | Train Loss: 0.4646182 Vali Loss: 0.4184964 Best vali loss: 0.4038756

best validation loss 0.40387563732377674

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004818244248, 'e_layers': 1, 'learning_rate': 0.0005988371302, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002994185651
Validation loss decreased (0.3698 --> 0.3665).  Saving model state dict ...
Epoch: 4 cost time: 0.5852420330047607
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3665075 Best vali loss: 0.3665075
Updating learning rate to 0.00018483604089370196
Validation loss decreased (0.3665 --> 0.3658).  Saving model state dict ...
Epoch: 5 cost time: 0.3253970146179199
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3657822 Best vali loss: 0.3657822
Updating learning rate to 8.769766730464429e-05
Epoch: 6 cost time: 0.4498758316040039
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3663791 Best vali loss: 0.3657822
Updating learning rate to 2.2791881150211728e-05
Epoch: 7 cost time: 0.4211890697479248
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3662051 Best vali loss: 0.3657822
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4375495910644531
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3662149 Best vali loss: 0.3657822

best validation loss 0.365782199322826

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0111045942676, 'e_layers': 2, 'learning_rate': 0.0002179765149, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0002179765149
Validation loss decreased (inf --> 0.3644).  Saving model state dict ...
Epoch: 1 cost time: 0.8200011253356934
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3644476 Best vali loss: 0.3644476
Updating learning rate to 0.00010898825745
Validation loss decreased (0.3644 --> 0.3628).  Saving model state dict ...
Epoch: 2 cost time: 0.5553228855133057
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3627943 Best vali loss: 0.3627943
Updating learning rate to 5.4494128725e-05
Validation loss decreased (0.3628 --> 0.3598).  Saving model state dict ...
Epoch: 3 cost time: 0.5562520027160645
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3598011 Best vali loss: 0.3598011
Updating learning rate to 2.72470643625e-05
Validation loss decreased (0.3598 --> 0.3583).  Saving model state dict ...
Epoch: 4 cost time: 0.563058614730835
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3583119 Best vali loss: 0.3583119
Updating learning rate to 1.362353218125e-05
Validation loss decreased (0.3583 --> 0.3572).  Saving model state dict ...
Epoch: 5 cost time: 0.44704437255859375
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3572405 Best vali loss: 0.3572405
Updating learning rate to 6.811766090625e-06
Validation loss decreased (0.3572 --> 0.3570).  Saving model state dict ...
Epoch: 6 cost time: 0.37945127487182617
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3570227 Best vali loss: 0.3570227
Updating learning rate to 3.4058830453125e-06
Epoch: 7 cost time: 0.5804612636566162
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3573792 Best vali loss: 0.3570227
Updating learning rate to 1.70294152265625e-06
Epoch: 8 cost time: 0.5393786430358887
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3576448 Best vali loss: 0.3570227

best validation loss 0.35702273256652245

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0017015780889, 'e_layers': 1, 'learning_rate': 0.0028702571024, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0028702571024
Validation loss decreased (inf --> 0.3854).  Saving model state dict ...
Epoch: 1 cost time: 0.7156016826629639
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3854049 Best vali loss: 0.3854049
Updating learning rate to 0.0014351285512
Epoch: 2 cost time: 0.45924973487854004
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3895020 Best vali loss: 0.3854049
Updating learning rate to 0.0007175642756
Epoch: 3 cost time: 0.3330559730529785
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3966376 Best vali loss: 0.3854049
Updating learning rate to 0.0003587821378
Epoch: 4 cost time: 0.3503403663635254
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3946328 Best vali loss: 0.3854049
Updating learning rate to 0.0001793910689
Epoch: 5 cost time: 0.5239760875701904
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4237649 Best vali loss: 0.3854049
Updating learning rate to 8.969553445e-05
Epoch: 6 cost time: 0.5571603775024414
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4169856 Best vali loss: 0.3854049
Updating learning rate to 4.4847767225e-05
Epoch: 7 cost time: 0.6148185729980469
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4168717 Best vali loss: 0.3854049
Updating learning rate to 2.24238836125e-05
Epoch: 8 cost time: 0.6215553283691406
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4217993 Best vali loss: 0.3854049

best validation loss 0.385404905858349

[INFO][smbo.py:320] Finished 150 trials.
{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.001707636708, 'e_layers': 2, 'learning_rate': 0.0007419627822, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5182887
	speed: 0.0106s/iter; left time: 86.2104s
	iters: 200, epoch: 1 | loss: 0.4832006
	speed: 0.0051s/iter; left time: 40.9740s
	iters: 300, epoch: 1 | loss: 1.9324880
	speed: 0.0054s/iter; left time: 43.0889s
	iters: 400, epoch: 1 | loss: 0.9297885
	speed: 0.0038s/iter; left time: 29.5914s
	iters: 500, epoch: 1 | loss: 0.6096742
	speed: 0.0033s/iter; left time: 25.6414s
	iters: 600, epoch: 1 | loss: 1.0021547
	speed: 0.0043s/iter; left time: 32.3837s
	iters: 700, epoch: 1 | loss: 1.2625501
	speed: 0.0043s/iter; left time: 32.3985s
	iters: 800, epoch: 1 | loss: 0.3424565
	speed: 0.0048s/iter; left time: 35.4010s
	iters: 900, epoch: 1 | loss: 0.3595717
	speed: 0.0049s/iter; left time: 35.7584s
	iters: 1000, epoch: 1 | loss: 0.6983381
	speed: 0.0051s/iter; left time: 36.6301s
Updating learning rate to 0.0007137235052798548
Validation loss decreased (inf --> 0.3801).  Saving model state dict ...
Epoch: 1 cost time: 4.9762561321258545
Epoch: 1, Steps: 1027 | Train Loss: 0.8138511 Vali Loss: 0.3801334 Best vali loss: 0.3801334
	iters: 100, epoch: 2 | loss: 0.7054406
	speed: 0.0141s/iter; left time: 99.8854s
	iters: 200, epoch: 2 | loss: 0.4955556
	speed: 0.0053s/iter; left time: 36.9970s
	iters: 300, epoch: 2 | loss: 0.4459289
	speed: 0.0051s/iter; left time: 35.3674s
	iters: 400, epoch: 2 | loss: 0.2975319
	speed: 0.0032s/iter; left time: 21.8968s
	iters: 500, epoch: 2 | loss: 0.9166895
	speed: 0.0031s/iter; left time: 21.0232s
	iters: 600, epoch: 2 | loss: 0.6505505
	speed: 0.0035s/iter; left time: 23.2252s
	iters: 700, epoch: 2 | loss: 0.4490395
	speed: 0.0041s/iter; left time: 26.8003s
	iters: 800, epoch: 2 | loss: 1.8315139
	speed: 0.0041s/iter; left time: 25.9547s
	iters: 900, epoch: 2 | loss: 0.2275970
	speed: 0.0041s/iter; left time: 25.7256s
	iters: 1000, epoch: 2 | loss: 1.3816978
	speed: 0.0041s/iter; left time: 25.2164s
Updating learning rate to 0.0006333048484408287
Validation loss decreased (0.3801 --> 0.3732).  Saving model state dict ...
Epoch: 2 cost time: 4.299262523651123
Epoch: 2, Steps: 1027 | Train Loss: 0.7401545 Vali Loss: 0.3731908 Best vali loss: 0.3731908
	iters: 100, epoch: 3 | loss: 0.3867692
	speed: 0.0133s/iter; left time: 80.5126s
	iters: 200, epoch: 3 | loss: 0.8106879
	speed: 0.0046s/iter; left time: 27.4453s
	iters: 300, epoch: 3 | loss: 0.4800237
	speed: 0.0045s/iter; left time: 26.1768s
	iters: 400, epoch: 3 | loss: 0.2245788
	speed: 0.0040s/iter; left time: 23.0989s
	iters: 500, epoch: 3 | loss: 0.3161154
	speed: 0.0041s/iter; left time: 22.9796s
	iters: 600, epoch: 3 | loss: 0.3000037
	speed: 0.0041s/iter; left time: 22.7691s
	iters: 700, epoch: 3 | loss: 0.4596563
	speed: 0.0041s/iter; left time: 22.5904s
	iters: 800, epoch: 3 | loss: 0.2131157
	speed: 0.0040s/iter; left time: 21.7142s
	iters: 900, epoch: 3 | loss: 0.7245154
	speed: 0.0043s/iter; left time: 22.4463s
	iters: 1000, epoch: 3 | loss: 0.1770283
	speed: 0.0042s/iter; left time: 21.8848s
Updating learning rate to 0.0005129498231897238
Validation loss decreased (0.3732 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 4.412678480148315
Epoch: 3, Steps: 1027 | Train Loss: 0.4092495 Vali Loss: 0.3683955 Best vali loss: 0.3683955

best validation loss 0.3683954725506732

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4911140
	speed: 0.0128s/iter; left time: 11.9355s
Updating learning rate to 7.21066019e-05
Validation loss decreased (inf --> 0.3650).  Saving model state dict ...
Epoch: 1 cost time: 1.1940317153930664
Epoch: 1, Steps: 129 | Train Loss: 0.4911140 Vali Loss: 0.3649584 Best vali loss: 0.3649584
	iters: 100, epoch: 2 | loss: 0.5385129
	speed: 0.0126s/iter; left time: 10.1485s
Updating learning rate to 3.605330095e-05
Validation loss decreased (0.3650 --> 0.3633).  Saving model state dict ...
Epoch: 2 cost time: 0.9517638683319092
Epoch: 2, Steps: 129 | Train Loss: 0.5385129 Vali Loss: 0.3632501 Best vali loss: 0.3632501
	iters: 100, epoch: 3 | loss: 0.4845971
	speed: 0.0124s/iter; left time: 8.3899s
Updating learning rate to 1.8026650475e-05
Validation loss decreased (0.3633 --> 0.3620).  Saving model state dict ...
Epoch: 3 cost time: 0.9610779285430908
Epoch: 3, Steps: 129 | Train Loss: 0.4845971 Vali Loss: 0.3619887 Best vali loss: 0.3619887

best validation loss 0.3619886654884736

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0019248824173, 'e_layers': 4, 'learning_rate': 0.0047849704029, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.004602853310905798
Validation loss decreased (inf --> 0.4039).  Saving model state dict ...
Epoch: 1 cost time: 1.5492382049560547
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4039208 Best vali loss: 0.4039208
Updating learning rate to 0.004084227711283759
Validation loss decreased (0.4039 --> 0.4005).  Saving model state dict ...
Epoch: 2 cost time: 1.2917392253875732
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4005010 Best vali loss: 0.4005010
Updating learning rate to 0.0033080496502235694
Epoch: 3 cost time: 1.1465685367584229
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4105375 Best vali loss: 0.4005010

best validation loss 0.400500961183799

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 2, 'learning_rate': 7.21066019e-05, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4949661
	speed: 0.0173s/iter; left time: 9.4706s
Updating learning rate to 9.0133252375e-06
Validation loss decreased (0.3620 --> 0.3582).  Saving model state dict ...
Epoch: 4 cost time: 1.6347320079803467
Epoch: 4, Steps: 129 | Train Loss: 0.4949661 Vali Loss: 0.3581794 Best vali loss: 0.3581794
	iters: 100, epoch: 5 | loss: 0.4839759
	speed: 0.0161s/iter; left time: 6.7303s
Updating learning rate to 4.50666261875e-06
Validation loss decreased (0.3582 --> 0.3573).  Saving model state dict ...
Epoch: 5 cost time: 1.3055672645568848
Epoch: 5, Steps: 129 | Train Loss: 0.4839759 Vali Loss: 0.3572542 Best vali loss: 0.3572542
	iters: 100, epoch: 6 | loss: 0.4225862
	speed: 0.0100s/iter; left time: 2.8703s
Updating learning rate to 2.253331309375e-06
Epoch: 6 cost time: 0.7323143482208252
Epoch: 6, Steps: 129 | Train Loss: 0.4225862 Vali Loss: 0.3583484 Best vali loss: 0.3572542
	iters: 100, epoch: 7 | loss: 0.6365445
	speed: 0.0173s/iter; left time: 2.7531s
Updating learning rate to 1.1266656546875e-06
Epoch: 7 cost time: 1.6399109363555908
Epoch: 7, Steps: 129 | Train Loss: 0.6365445 Vali Loss: 0.3577091 Best vali loss: 0.3572542
	iters: 100, epoch: 8 | loss: 0.4908998
	speed: 0.0184s/iter; left time: 0.5521s
Updating learning rate to 5.6333282734375e-07
Epoch: 8 cost time: 1.6841249465942383
Epoch: 8, Steps: 129 | Train Loss: 0.4908998 Vali Loss: 0.3578209 Best vali loss: 0.3572542

best validation loss 0.357254245321034

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0061705426639, 'e_layers': 4, 'learning_rate': 0.001116068428, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5162606
	speed: 0.0124s/iter; left time: 49.7109s
	iters: 200, epoch: 1 | loss: 0.9106518
	speed: 0.0049s/iter; left time: 19.1570s
	iters: 300, epoch: 1 | loss: 0.3335861
	speed: 0.0080s/iter; left time: 30.6703s
	iters: 400, epoch: 1 | loss: 0.4645998
	speed: 0.0080s/iter; left time: 29.6214s
	iters: 500, epoch: 1 | loss: 0.4304554
	speed: 0.0089s/iter; left time: 32.2034s
Updating learning rate to 0.001116068428
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 4.045373201370239
Epoch: 1, Steps: 514 | Train Loss: 0.5311108 Vali Loss: 0.3714151 Best vali loss: 0.3714151
	iters: 100, epoch: 2 | loss: 0.2750500
	speed: 0.0170s/iter; left time: 59.6315s
	iters: 200, epoch: 2 | loss: 0.6321321
	speed: 0.0091s/iter; left time: 30.8224s
	iters: 300, epoch: 2 | loss: 0.7296705
	speed: 0.0085s/iter; left time: 28.0976s
	iters: 400, epoch: 2 | loss: 0.3694435
	speed: 0.0077s/iter; left time: 24.6564s
	iters: 500, epoch: 2 | loss: 0.6742085
	speed: 0.0049s/iter; left time: 15.0583s
Updating learning rate to 0.000558034214
Epoch: 2 cost time: 3.9547364711761475
Epoch: 2, Steps: 514 | Train Loss: 0.5361009 Vali Loss: 0.3762930 Best vali loss: 0.3714151
	iters: 100, epoch: 3 | loss: 0.9440874
	speed: 0.0122s/iter; left time: 36.4457s
	iters: 200, epoch: 3 | loss: 0.3862525
	speed: 0.0072s/iter; left time: 20.6521s
	iters: 300, epoch: 3 | loss: 0.2016176
	speed: 0.0072s/iter; left time: 20.0443s
	iters: 400, epoch: 3 | loss: 0.4379228
	speed: 0.0071s/iter; left time: 18.9324s
	iters: 500, epoch: 3 | loss: 0.2339546
	speed: 0.0069s/iter; left time: 17.7351s
Updating learning rate to 0.000279017107
Validation loss decreased (0.3714 --> 0.3680).  Saving model state dict ...
Epoch: 3 cost time: 3.6599128246307373
Epoch: 3, Steps: 514 | Train Loss: 0.4407670 Vali Loss: 0.3679755 Best vali loss: 0.3679755
	iters: 100, epoch: 4 | loss: 0.5882308
	speed: 0.0135s/iter; left time: 33.4710s
	iters: 200, epoch: 4 | loss: 0.8848254
	speed: 0.0073s/iter; left time: 17.1956s
	iters: 300, epoch: 4 | loss: 0.5879719
	speed: 0.0069s/iter; left time: 15.7158s
	iters: 400, epoch: 4 | loss: 0.4987080
	speed: 0.0071s/iter; left time: 15.5085s
	iters: 500, epoch: 4 | loss: 0.5720690
	speed: 0.0070s/iter; left time: 14.5032s
Updating learning rate to 0.0001395085535
Epoch: 4 cost time: 3.6753573417663574
Epoch: 4, Steps: 514 | Train Loss: 0.6263610 Vali Loss: 0.3681091 Best vali loss: 0.3679755
	iters: 100, epoch: 5 | loss: 0.4305796
	speed: 0.0141s/iter; left time: 27.6492s
	iters: 200, epoch: 5 | loss: 0.4182141
	speed: 0.0070s/iter; left time: 13.0180s
	iters: 300, epoch: 5 | loss: 0.3899547
	speed: 0.0068s/iter; left time: 11.9011s
	iters: 400, epoch: 5 | loss: 0.5688843
	speed: 0.0068s/iter; left time: 11.3443s
	iters: 500, epoch: 5 | loss: 0.4241270
	speed: 0.0069s/iter; left time: 10.7359s
Updating learning rate to 6.975427675e-05
Epoch: 5 cost time: 3.586422920227051
Epoch: 5, Steps: 514 | Train Loss: 0.4463519 Vali Loss: 0.3745547 Best vali loss: 0.3679755
	iters: 100, epoch: 6 | loss: 0.2642373
	speed: 0.0138s/iter; left time: 19.9643s
	iters: 200, epoch: 6 | loss: 0.3005520
	speed: 0.0071s/iter; left time: 9.5413s
	iters: 300, epoch: 6 | loss: 0.7075330
	speed: 0.0069s/iter; left time: 8.5586s
	iters: 400, epoch: 6 | loss: 0.6916489
	speed: 0.0070s/iter; left time: 8.0108s
	iters: 500, epoch: 6 | loss: 0.6640239
	speed: 0.0064s/iter; left time: 6.6506s
Updating learning rate to 3.4877138375e-05
Epoch: 6 cost time: 3.606844425201416
Epoch: 6, Steps: 514 | Train Loss: 0.5255990 Vali Loss: 0.3745678 Best vali loss: 0.3679755
	iters: 100, epoch: 7 | loss: 0.4223524
	speed: 0.0141s/iter; left time: 13.0871s
	iters: 200, epoch: 7 | loss: 0.3659474
	speed: 0.0070s/iter; left time: 5.7891s
	iters: 300, epoch: 7 | loss: 0.3779050
	speed: 0.0069s/iter; left time: 5.0546s
	iters: 400, epoch: 7 | loss: 0.6985163
	speed: 0.0067s/iter; left time: 4.2352s
	iters: 500, epoch: 7 | loss: 0.5648893
	speed: 0.0066s/iter; left time: 3.5050s
Updating learning rate to 1.74385691875e-05
Epoch: 7 cost time: 3.5874555110931396
Epoch: 7, Steps: 514 | Train Loss: 0.4859221 Vali Loss: 0.3735666 Best vali loss: 0.3679755
	iters: 100, epoch: 8 | loss: 0.5066549
	speed: 0.0137s/iter; left time: 5.6849s
	iters: 200, epoch: 8 | loss: 0.3014106
	speed: 0.0070s/iter; left time: 2.2127s
	iters: 300, epoch: 8 | loss: 0.3133123
	speed: 0.0072s/iter; left time: 1.5392s
	iters: 400, epoch: 8 | loss: 0.3231548
	speed: 0.0069s/iter; left time: 0.7973s
	iters: 500, epoch: 8 | loss: 0.3669629
	speed: 0.0072s/iter; left time: 0.1073s
Updating learning rate to 8.71928459375e-06
Epoch: 8 cost time: 3.6687848567962646
Epoch: 8, Steps: 514 | Train Loss: 0.3622991 Vali Loss: 0.3722474 Best vali loss: 0.3679755

best validation loss 0.3679755088622537

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0010878951032, 'e_layers': 1, 'learning_rate': 0.0009739953589, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7264485
	speed: 0.0091s/iter; left time: 36.4029s
	iters: 200, epoch: 1 | loss: 0.5817962
	speed: 0.0036s/iter; left time: 14.2340s
	iters: 300, epoch: 1 | loss: 0.6122410
	speed: 0.0036s/iter; left time: 13.6396s
	iters: 400, epoch: 1 | loss: 0.4693560
	speed: 0.0035s/iter; left time: 12.8731s
	iters: 500, epoch: 1 | loss: 0.2658790
	speed: 0.0035s/iter; left time: 12.5570s
Updating learning rate to 0.0009369248678743475
Validation loss decreased (inf --> 0.3713).  Saving model state dict ...
Epoch: 1 cost time: 2.0932159423828125
Epoch: 1, Steps: 514 | Train Loss: 0.5311441 Vali Loss: 0.3712894 Best vali loss: 0.3712894
	iters: 100, epoch: 2 | loss: 0.6635020
	speed: 0.0086s/iter; left time: 30.2593s
	iters: 200, epoch: 2 | loss: 0.5312233
	speed: 0.0037s/iter; left time: 12.4934s
	iters: 300, epoch: 2 | loss: 0.6070260
	speed: 0.0034s/iter; left time: 11.2480s
	iters: 400, epoch: 2 | loss: 0.5376730
	speed: 0.0033s/iter; left time: 10.3978s
	iters: 500, epoch: 2 | loss: 0.3840249
	speed: 0.0036s/iter; left time: 11.2561s
Updating learning rate to 0.0008313570410112075
Validation loss decreased (0.3713 --> 0.3675).  Saving model state dict ...
Epoch: 2 cost time: 1.835404872894287
Epoch: 2, Steps: 514 | Train Loss: 0.5446898 Vali Loss: 0.3675221 Best vali loss: 0.3675221
	iters: 100, epoch: 3 | loss: 0.4095818
	speed: 0.0091s/iter; left time: 27.1860s
	iters: 200, epoch: 3 | loss: 1.1955427
	speed: 0.0037s/iter; left time: 10.7777s
	iters: 300, epoch: 3 | loss: 0.2605458
	speed: 0.0034s/iter; left time: 9.4954s
	iters: 400, epoch: 3 | loss: 0.7061902
	speed: 0.0034s/iter; left time: 9.1026s
	iters: 500, epoch: 3 | loss: 0.8318144
	speed: 0.0024s/iter; left time: 6.0981s
Updating learning rate to 0.0006733636229757597
Epoch: 3 cost time: 1.73380446434021
Epoch: 3, Steps: 514 | Train Loss: 0.6807350 Vali Loss: 0.3757124 Best vali loss: 0.3675221
	iters: 100, epoch: 4 | loss: 0.3040645
	speed: 0.0069s/iter; left time: 17.0350s
	iters: 200, epoch: 4 | loss: 0.3318518
	speed: 0.0039s/iter; left time: 9.1529s
	iters: 300, epoch: 4 | loss: 0.4679455
	speed: 0.0036s/iter; left time: 8.1823s
	iters: 400, epoch: 4 | loss: 0.7964633
	speed: 0.0035s/iter; left time: 7.6054s
	iters: 500, epoch: 4 | loss: 0.4195495
	speed: 0.0035s/iter; left time: 7.3340s
Updating learning rate to 0.00048699767945
Epoch: 4 cost time: 1.8769924640655518
Epoch: 4, Steps: 514 | Train Loss: 0.4639749 Vali Loss: 0.3765462 Best vali loss: 0.3675221
	iters: 100, epoch: 5 | loss: 0.7636153
	speed: 0.0094s/iter; left time: 18.4407s
	iters: 200, epoch: 5 | loss: 0.5139491
	speed: 0.0037s/iter; left time: 6.8288s
	iters: 300, epoch: 5 | loss: 0.5855272
	speed: 0.0036s/iter; left time: 6.3847s
	iters: 400, epoch: 5 | loss: 0.2561725
	speed: 0.0039s/iter; left time: 6.3924s
	iters: 500, epoch: 5 | loss: 0.3536020
	speed: 0.0036s/iter; left time: 5.5282s
Updating learning rate to 0.00030063173592424026
Epoch: 5 cost time: 1.9436230659484863
Epoch: 5, Steps: 514 | Train Loss: 0.4945732 Vali Loss: 0.3837063 Best vali loss: 0.3675221
	iters: 100, epoch: 6 | loss: 0.3847327
	speed: 0.0088s/iter; left time: 12.6642s
	iters: 200, epoch: 6 | loss: 0.7645038
	speed: 0.0036s/iter; left time: 4.8820s
	iters: 300, epoch: 6 | loss: 1.1006554
	speed: 0.0036s/iter; left time: 4.4378s
	iters: 400, epoch: 6 | loss: 0.5615081
	speed: 0.0037s/iter; left time: 4.2477s
	iters: 500, epoch: 6 | loss: 0.4021571
	speed: 0.0036s/iter; left time: 3.7466s
Updating learning rate to 0.00014263831788879246
Epoch: 6 cost time: 1.8871514797210693
Epoch: 6, Steps: 514 | Train Loss: 0.6427114 Vali Loss: 0.3910479 Best vali loss: 0.3675221
	iters: 100, epoch: 7 | loss: 0.7737949
	speed: 0.0092s/iter; left time: 8.5843s
	iters: 200, epoch: 7 | loss: 0.6346073
	speed: 0.0036s/iter; left time: 2.9567s
	iters: 300, epoch: 7 | loss: 0.4516656
	speed: 0.0039s/iter; left time: 2.8445s
	iters: 400, epoch: 7 | loss: 0.5922095
	speed: 0.0036s/iter; left time: 2.2730s
	iters: 500, epoch: 7 | loss: 0.5241509
	speed: 0.0034s/iter; left time: 1.8189s
Updating learning rate to 3.707049102565253e-05
Epoch: 7 cost time: 1.9020652770996094
Epoch: 7, Steps: 514 | Train Loss: 0.5952856 Vali Loss: 0.3876171 Best vali loss: 0.3675221
	iters: 100, epoch: 8 | loss: 0.5168617
	speed: 0.0090s/iter; left time: 3.7416s
	iters: 200, epoch: 8 | loss: 0.2637350
	speed: 0.0040s/iter; left time: 1.2488s
	iters: 300, epoch: 8 | loss: 0.2766948
	speed: 0.0036s/iter; left time: 0.7845s
	iters: 400, epoch: 8 | loss: 0.5177840
	speed: 0.0036s/iter; left time: 0.4132s
	iters: 500, epoch: 8 | loss: 0.6190382
	speed: 0.0034s/iter; left time: 0.0512s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9226431846618652
Epoch: 8, Steps: 514 | Train Loss: 0.4388227 Vali Loss: 0.3932716 Best vali loss: 0.3675221

best validation loss 0.3675220853219098

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0096712489936, 'e_layers': 2, 'learning_rate': 0.0011324263099, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4897688
	speed: 0.0127s/iter; left time: 11.8394s
Updating learning rate to 0.0011324263099
Validation loss decreased (inf --> 0.3794).  Saving model state dict ...
Epoch: 1 cost time: 1.1710834503173828
Epoch: 1, Steps: 129 | Train Loss: 0.4897688 Vali Loss: 0.3794045 Best vali loss: 0.3794045
	iters: 100, epoch: 2 | loss: 0.5054114
	speed: 0.0106s/iter; left time: 8.5345s
Updating learning rate to 0.00056621315495
Epoch: 2 cost time: 0.8281641006469727
Epoch: 2, Steps: 129 | Train Loss: 0.5054114 Vali Loss: 0.3815801 Best vali loss: 0.3794045
	iters: 100, epoch: 3 | loss: 0.5400622
	speed: 0.0110s/iter; left time: 7.3991s
Updating learning rate to 0.000283106577475
Validation loss decreased (0.3794 --> 0.3788).  Saving model state dict ...
Epoch: 3 cost time: 0.8468630313873291
Epoch: 3, Steps: 129 | Train Loss: 0.5400622 Vali Loss: 0.3788299 Best vali loss: 0.3788299

best validation loss 0.37882988256180916

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0104119650236, 'e_layers': 2, 'learning_rate': 0.0007766870033, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6045076
	speed: 0.0106s/iter; left time: 42.3450s
	iters: 200, epoch: 1 | loss: 0.7215868
	speed: 0.0047s/iter; left time: 18.3428s
	iters: 300, epoch: 1 | loss: 0.3322736
	speed: 0.0045s/iter; left time: 17.1584s
	iters: 400, epoch: 1 | loss: 0.3306445
	speed: 0.0045s/iter; left time: 16.5454s
	iters: 500, epoch: 1 | loss: 0.5871595
	speed: 0.0032s/iter; left time: 11.5223s
Updating learning rate to 0.0007471261144081981
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 2.4793007373809814
Epoch: 1, Steps: 514 | Train Loss: 0.5152344 Vali Loss: 0.3662849 Best vali loss: 0.3662849
	iters: 100, epoch: 2 | loss: 0.8462950
	speed: 0.0086s/iter; left time: 30.0637s
	iters: 200, epoch: 2 | loss: 0.3463565
	speed: 0.0054s/iter; left time: 18.4868s
	iters: 300, epoch: 2 | loss: 0.5803466
	speed: 0.0049s/iter; left time: 16.0065s
	iters: 400, epoch: 2 | loss: 0.6684887
	speed: 0.0053s/iter; left time: 16.9826s
	iters: 500, epoch: 2 | loss: 0.7515412
	speed: 0.0050s/iter; left time: 15.4931s
Updating learning rate to 0.0006629438250964442
Epoch: 2 cost time: 2.6674857139587402
Epoch: 2, Steps: 514 | Train Loss: 0.6386056 Vali Loss: 0.3699105 Best vali loss: 0.3662849
	iters: 100, epoch: 3 | loss: 0.6730723
	speed: 0.0108s/iter; left time: 32.3334s
	iters: 200, epoch: 3 | loss: 0.7265728
	speed: 0.0030s/iter; left time: 8.7759s
	iters: 300, epoch: 3 | loss: 0.5259302
	speed: 0.0032s/iter; left time: 8.7974s
	iters: 400, epoch: 3 | loss: 0.5279122
	speed: 0.0049s/iter; left time: 13.1104s
	iters: 500, epoch: 3 | loss: 0.6218694
	speed: 0.0047s/iter; left time: 12.1973s
Updating learning rate to 0.0005369561257980999
Epoch: 3 cost time: 2.0794594287872314
Epoch: 3, Steps: 514 | Train Loss: 0.6150714 Vali Loss: 0.3741973 Best vali loss: 0.3662849

best validation loss 0.36628485680329076

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6290445
	speed: 0.0115s/iter; left time: 46.0017s
	iters: 200, epoch: 1 | loss: 0.4627065
	speed: 0.0055s/iter; left time: 21.5390s
	iters: 300, epoch: 1 | loss: 0.5434590
	speed: 0.0054s/iter; left time: 20.4863s
	iters: 400, epoch: 1 | loss: 0.2702823
	speed: 0.0056s/iter; left time: 20.8846s
	iters: 500, epoch: 1 | loss: 0.7420751
	speed: 0.0052s/iter; left time: 18.6567s
Updating learning rate to 0.00024547190550098694
Validation loss decreased (inf --> 0.3654).  Saving model state dict ...
Epoch: 1 cost time: 3.1008963584899902
Epoch: 1, Steps: 514 | Train Loss: 0.5295135 Vali Loss: 0.3653895 Best vali loss: 0.3653895
	iters: 100, epoch: 2 | loss: 1.1138710
	speed: 0.0123s/iter; left time: 43.1290s
	iters: 200, epoch: 2 | loss: 1.3753645
	speed: 0.0058s/iter; left time: 19.6260s
	iters: 300, epoch: 2 | loss: 0.6434941
	speed: 0.0053s/iter; left time: 17.5857s
	iters: 400, epoch: 2 | loss: 0.5505755
	speed: 0.0056s/iter; left time: 17.8130s
	iters: 500, epoch: 2 | loss: 0.7368609
	speed: 0.0058s/iter; left time: 17.9458s
Updating learning rate to 0.00021781340639583926
Validation loss decreased (0.3654 --> 0.3618).  Saving model state dict ...
Epoch: 2 cost time: 2.9119925498962402
Epoch: 2, Steps: 514 | Train Loss: 0.8840332 Vali Loss: 0.3618149 Best vali loss: 0.3618149
	iters: 100, epoch: 3 | loss: 0.5220394
	speed: 0.0090s/iter; left time: 26.8685s
	iters: 200, epoch: 3 | loss: 0.8905177
	speed: 0.0060s/iter; left time: 17.2201s
	iters: 300, epoch: 3 | loss: 0.6840211
	speed: 0.0058s/iter; left time: 16.0932s
	iters: 400, epoch: 3 | loss: 0.5840440
	speed: 0.0059s/iter; left time: 15.8787s
	iters: 500, epoch: 3 | loss: 0.8741661
	speed: 0.0060s/iter; left time: 15.5991s
Updating learning rate to 0.000176419537248397
Epoch: 3 cost time: 2.9423530101776123
Epoch: 3, Steps: 514 | Train Loss: 0.7109577 Vali Loss: 0.3715556 Best vali loss: 0.3618149

best validation loss 0.3618149110282568

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.00780504582, 'e_layers': 3, 'learning_rate': 0.0002551842788, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4355603
	speed: 0.0120s/iter; left time: 29.6483s
	iters: 200, epoch: 4 | loss: 0.3941386
	speed: 0.0059s/iter; left time: 14.0983s
	iters: 300, epoch: 4 | loss: 0.4916884
	speed: 0.0059s/iter; left time: 13.3626s
	iters: 400, epoch: 4 | loss: 0.2242625
	speed: 0.0058s/iter; left time: 12.5146s
	iters: 500, epoch: 4 | loss: 0.6185744
	speed: 0.0060s/iter; left time: 12.4470s
Updating learning rate to 0.0001275921394
Validation loss decreased (0.3618 --> 0.3542).  Saving model state dict ...
Epoch: 4 cost time: 3.3417000770568848
Epoch: 4, Steps: 514 | Train Loss: 0.4328448 Vali Loss: 0.3542482 Best vali loss: 0.3542482
	iters: 100, epoch: 5 | loss: 0.9654954
	speed: 0.0126s/iter; left time: 24.6457s
	iters: 200, epoch: 5 | loss: 1.1808156
	speed: 0.0061s/iter; left time: 11.2613s
	iters: 300, epoch: 5 | loss: 0.5571505
	speed: 0.0060s/iter; left time: 10.5349s
	iters: 400, epoch: 5 | loss: 0.5386456
	speed: 0.0062s/iter; left time: 10.2385s
	iters: 500, epoch: 5 | loss: 0.6917315
	speed: 0.0048s/iter; left time: 7.4024s
Updating learning rate to 7.8764741551603e-05
Validation loss decreased (0.3542 --> 0.3528).  Saving model state dict ...
Epoch: 5 cost time: 3.0076653957366943
Epoch: 5, Steps: 514 | Train Loss: 0.7867677 Vali Loss: 0.3527893 Best vali loss: 0.3527893
	iters: 100, epoch: 6 | loss: 0.5189775
	speed: 0.0111s/iter; left time: 16.0313s
	iters: 200, epoch: 6 | loss: 0.8683018
	speed: 0.0060s/iter; left time: 8.1161s
	iters: 300, epoch: 6 | loss: 0.6347080
	speed: 0.0058s/iter; left time: 7.2636s
	iters: 400, epoch: 6 | loss: 0.4784639
	speed: 0.0059s/iter; left time: 6.7235s
	iters: 500, epoch: 6 | loss: 0.8037620
	speed: 0.0058s/iter; left time: 6.0625s
Updating learning rate to 3.7370872404160736e-05
Validation loss decreased (0.3528 --> 0.3513).  Saving model state dict ...
Epoch: 6 cost time: 3.095362663269043
Epoch: 6, Steps: 514 | Train Loss: 0.6608426 Vali Loss: 0.3513283 Best vali loss: 0.3513283
	iters: 100, epoch: 7 | loss: 0.3428092
	speed: 0.0130s/iter; left time: 12.0979s
	iters: 200, epoch: 7 | loss: 0.2889346
	speed: 0.0060s/iter; left time: 4.9573s
	iters: 300, epoch: 7 | loss: 0.4555261
	speed: 0.0059s/iter; left time: 4.3298s
	iters: 400, epoch: 7 | loss: 0.7637494
	speed: 0.0058s/iter; left time: 3.6593s
	iters: 500, epoch: 7 | loss: 0.6243542
	speed: 0.0059s/iter; left time: 3.1428s
Updating learning rate to 9.71237329901307e-06
Epoch: 7 cost time: 3.1190218925476074
Epoch: 7, Steps: 514 | Train Loss: 0.4950747 Vali Loss: 0.3551729 Best vali loss: 0.3513283
	iters: 100, epoch: 8 | loss: 0.3811911
	speed: 0.0124s/iter; left time: 5.1582s
	iters: 200, epoch: 8 | loss: 1.1197647
	speed: 0.0060s/iter; left time: 1.8850s
	iters: 300, epoch: 8 | loss: 0.6104128
	speed: 0.0059s/iter; left time: 1.2722s
	iters: 400, epoch: 8 | loss: 0.4154963
	speed: 0.0058s/iter; left time: 0.6718s
	iters: 500, epoch: 8 | loss: 0.8550966
	speed: 0.0060s/iter; left time: 0.0893s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.086714267730713
Epoch: 8, Steps: 514 | Train Loss: 0.6763923 Vali Loss: 0.3567875 Best vali loss: 0.3513283

best validation loss 0.3513282514157136

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0012294507625, 'e_layers': 2, 'learning_rate': 0.0003922949282, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4061545
	speed: 0.0111s/iter; left time: 21.8025s
	iters: 200, epoch: 1 | loss: 0.6655009
	speed: 0.0057s/iter; left time: 10.6211s
Updating learning rate to 0.0003922949282
Validation loss decreased (inf --> 0.3751).  Saving model state dict ...
Epoch: 1 cost time: 1.706803798675537
Epoch: 1, Steps: 257 | Train Loss: 0.5358277 Vali Loss: 0.3750692 Best vali loss: 0.3750692
	iters: 100, epoch: 2 | loss: 0.6891594
	speed: 0.0128s/iter; left time: 21.7459s
	iters: 200, epoch: 2 | loss: 0.4462879
	speed: 0.0056s/iter; left time: 8.9593s
Updating learning rate to 0.0001961474641
Epoch: 2 cost time: 1.510068655014038
Epoch: 2, Steps: 257 | Train Loss: 0.5677236 Vali Loss: 0.3832553 Best vali loss: 0.3750692
	iters: 100, epoch: 3 | loss: 0.3689282
	speed: 0.0126s/iter; left time: 18.1490s
	iters: 200, epoch: 3 | loss: 0.5283883
	speed: 0.0052s/iter; left time: 7.0427s
Updating learning rate to 9.807373205e-05
Validation loss decreased (0.3751 --> 0.3542).  Saving model state dict ...
Epoch: 3 cost time: 1.4085006713867188
Epoch: 3, Steps: 257 | Train Loss: 0.4486583 Vali Loss: 0.3542391 Best vali loss: 0.3542391
	iters: 100, epoch: 4 | loss: 0.3724072
	speed: 0.0103s/iter; left time: 12.1789s
	iters: 200, epoch: 4 | loss: 0.4883350
	speed: 0.0037s/iter; left time: 4.0036s
Updating learning rate to 4.9036866025e-05
Epoch: 4 cost time: 1.0805742740631104
Epoch: 4, Steps: 257 | Train Loss: 0.4303711 Vali Loss: 0.3552005 Best vali loss: 0.3542391
	iters: 100, epoch: 5 | loss: 0.5625635
	speed: 0.0128s/iter; left time: 11.8909s
	iters: 200, epoch: 5 | loss: 0.4572582
	speed: 0.0052s/iter; left time: 4.2901s
Updating learning rate to 2.45184330125e-05
Validation loss decreased (0.3542 --> 0.3523).  Saving model state dict ...
Epoch: 5 cost time: 1.4105315208435059
Epoch: 5, Steps: 257 | Train Loss: 0.5099109 Vali Loss: 0.3523233 Best vali loss: 0.3523233
	iters: 100, epoch: 6 | loss: 0.5147655
	speed: 0.0128s/iter; left time: 8.5713s
	iters: 200, epoch: 6 | loss: 0.4832487
	speed: 0.0054s/iter; left time: 3.0929s
Updating learning rate to 1.225921650625e-05
Epoch: 6 cost time: 1.490159273147583
Epoch: 6, Steps: 257 | Train Loss: 0.4990071 Vali Loss: 0.3562203 Best vali loss: 0.3523233
	iters: 100, epoch: 7 | loss: 0.4465281
	speed: 0.0128s/iter; left time: 5.3156s
	iters: 200, epoch: 7 | loss: 0.7998587
	speed: 0.0050s/iter; left time: 1.5643s
Updating learning rate to 6.129608253125e-06
Epoch: 7 cost time: 1.4304444789886475
Epoch: 7, Steps: 257 | Train Loss: 0.6231934 Vali Loss: 0.3557301 Best vali loss: 0.3523233
	iters: 100, epoch: 8 | loss: 0.3325821
	speed: 0.0127s/iter; left time: 1.9989s
	iters: 200, epoch: 8 | loss: 0.4037747
	speed: 0.0048s/iter; left time: 0.2806s
Updating learning rate to 3.0648041265625e-06
Epoch: 8 cost time: 1.4175705909729004
Epoch: 8, Steps: 257 | Train Loss: 0.3681784 Vali Loss: 0.3558358 Best vali loss: 0.3523233

best validation loss 0.3523232515293863

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0024943532487, 'e_layers': 3, 'learning_rate': 0.0040105616226, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0040105616226
Validation loss decreased (inf --> 0.4060).  Saving model state dict ...
Epoch: 1 cost time: 0.901219367980957
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4059841 Best vali loss: 0.4059841
Updating learning rate to 0.0020052808113
Validation loss decreased (0.4060 --> 0.4005).  Saving model state dict ...
Epoch: 2 cost time: 0.6574609279632568
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4005022 Best vali loss: 0.4005022
Updating learning rate to 0.00100264040565
Epoch: 3 cost time: 0.661370038986206
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4027312 Best vali loss: 0.4005022
Updating learning rate to 0.000501320202825
Epoch: 4 cost time: 0.6565608978271484
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4028360 Best vali loss: 0.4005022
Updating learning rate to 0.0002506601014125
Epoch: 5 cost time: 0.6315701007843018
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4039080 Best vali loss: 0.4005022
Updating learning rate to 0.00012533005070625
Epoch: 6 cost time: 0.6474530696868896
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4031253 Best vali loss: 0.4005022
Updating learning rate to 6.2665025353125e-05
Epoch: 7 cost time: 0.6508815288543701
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4033953 Best vali loss: 0.4005022
Updating learning rate to 3.13325126765625e-05
Epoch: 8 cost time: 0.6608035564422607
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4035166 Best vali loss: 0.4005022

best validation loss 0.40050216554892787

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0025792385667, 'e_layers': 3, 'learning_rate': 0.0026285535245, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9372423
	speed: 0.0140s/iter; left time: 27.3851s
	iters: 200, epoch: 1 | loss: 0.8724548
	speed: 0.0082s/iter; left time: 15.2026s
Updating learning rate to 0.0026285535245
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 2.5028069019317627
Epoch: 1, Steps: 257 | Train Loss: 0.9048485 Vali Loss: 0.3697746 Best vali loss: 0.3697746
	iters: 100, epoch: 2 | loss: 0.5194305
	speed: 0.0179s/iter; left time: 30.3598s
	iters: 200, epoch: 2 | loss: 0.6207587
	speed: 0.0088s/iter; left time: 14.1438s
Updating learning rate to 0.00131427676225
Epoch: 2 cost time: 2.320284605026245
Epoch: 2, Steps: 257 | Train Loss: 0.5700946 Vali Loss: 0.3758419 Best vali loss: 0.3697746
	iters: 100, epoch: 3 | loss: 0.7137550
	speed: 0.0178s/iter; left time: 25.7061s
	iters: 200, epoch: 3 | loss: 0.5471482
	speed: 0.0076s/iter; left time: 10.1697s
Updating learning rate to 0.000657138381125
Epoch: 3 cost time: 1.8972043991088867
Epoch: 3, Steps: 257 | Train Loss: 0.6304516 Vali Loss: 0.3739329 Best vali loss: 0.3697746

best validation loss 0.3697745669684382

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0037879290128, 'e_layers': 3, 'learning_rate': 0.0044980854811, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6674221
	speed: 0.0119s/iter; left time: 47.7520s
	iters: 200, epoch: 1 | loss: 0.8705749
	speed: 0.0061s/iter; left time: 23.6807s
	iters: 300, epoch: 1 | loss: 0.8857972
	speed: 0.0061s/iter; left time: 23.0831s
	iters: 400, epoch: 1 | loss: 1.6527612
	speed: 0.0062s/iter; left time: 23.0113s
	iters: 500, epoch: 1 | loss: 0.8921695
	speed: 0.0060s/iter; left time: 21.5125s
Updating learning rate to 0.0044980854811
Validation loss decreased (inf --> 0.4048).  Saving model state dict ...
Epoch: 1 cost time: 3.431145191192627
Epoch: 1, Steps: 514 | Train Loss: 0.9937450 Vali Loss: 0.4048470 Best vali loss: 0.4048470
	iters: 100, epoch: 2 | loss: 0.3920550
	speed: 0.0131s/iter; left time: 45.6799s
	iters: 200, epoch: 2 | loss: 0.4586638
	speed: 0.0057s/iter; left time: 19.5363s
	iters: 300, epoch: 2 | loss: 0.8925111
	speed: 0.0041s/iter; left time: 13.5073s
	iters: 400, epoch: 2 | loss: 0.6461990
	speed: 0.0044s/iter; left time: 14.1165s
	iters: 500, epoch: 2 | loss: 1.0000166
	speed: 0.0064s/iter; left time: 19.7643s
Updating learning rate to 0.00224904274055
Epoch: 2 cost time: 2.842055082321167
Epoch: 2, Steps: 514 | Train Loss: 0.6778891 Vali Loss: 0.4100646 Best vali loss: 0.4048470
	iters: 100, epoch: 3 | loss: 0.7369172
	speed: 0.0133s/iter; left time: 39.6720s
	iters: 200, epoch: 3 | loss: 0.6689036
	speed: 0.0064s/iter; left time: 18.3838s
	iters: 300, epoch: 3 | loss: 0.4584983
	speed: 0.0061s/iter; left time: 16.9221s
	iters: 400, epoch: 3 | loss: 1.3267231
	speed: 0.0066s/iter; left time: 17.7954s
	iters: 500, epoch: 3 | loss: 0.7663416
	speed: 0.0064s/iter; left time: 16.5935s
Updating learning rate to 0.001124521370275
Validation loss decreased (0.4048 --> 0.4024).  Saving model state dict ...
Epoch: 3 cost time: 3.331475019454956
Epoch: 3, Steps: 514 | Train Loss: 0.7914768 Vali Loss: 0.4024163 Best vali loss: 0.4024163

best validation loss 0.4024162691562255

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9412204
	speed: 0.0106s/iter; left time: 42.5166s
	iters: 200, epoch: 1 | loss: 0.5259694
	speed: 0.0047s/iter; left time: 18.4955s
	iters: 300, epoch: 1 | loss: 1.0959988
	speed: 0.0053s/iter; left time: 20.2932s
	iters: 400, epoch: 1 | loss: 0.3342501
	speed: 0.0054s/iter; left time: 20.0549s
	iters: 500, epoch: 1 | loss: 0.3490931
	speed: 0.0055s/iter; left time: 19.9415s
Updating learning rate to 0.00016522745149179477
Validation loss decreased (inf --> 0.3647).  Saving model state dict ...
Epoch: 1 cost time: 2.982564687728882
Epoch: 1, Steps: 514 | Train Loss: 0.6493064 Vali Loss: 0.3646882 Best vali loss: 0.3646882
	iters: 100, epoch: 2 | loss: 0.6526382
	speed: 0.0121s/iter; left time: 42.2370s
	iters: 200, epoch: 2 | loss: 0.8032614
	speed: 0.0047s/iter; left time: 16.0637s
	iters: 300, epoch: 2 | loss: 0.8385335
	speed: 0.0035s/iter; left time: 11.6141s
	iters: 400, epoch: 2 | loss: 0.4495495
	speed: 0.0030s/iter; left time: 9.6789s
	iters: 500, epoch: 2 | loss: 0.7860979
	speed: 0.0033s/iter; left time: 10.2153s
Updating learning rate to 0.00014661048060095176
Validation loss decreased (0.3647 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 2.118697166442871
Epoch: 2, Steps: 514 | Train Loss: 0.7060161 Vali Loss: 0.3636781 Best vali loss: 0.3636781
	iters: 100, epoch: 3 | loss: 0.6063797
	speed: 0.0114s/iter; left time: 34.0522s
	iters: 200, epoch: 3 | loss: 0.7019929
	speed: 0.0047s/iter; left time: 13.6939s
	iters: 300, epoch: 3 | loss: 0.4528660
	speed: 0.0048s/iter; left time: 13.4806s
	iters: 400, epoch: 3 | loss: 0.6122040
	speed: 0.0047s/iter; left time: 12.5650s
	iters: 500, epoch: 3 | loss: 0.5271367
	speed: 0.0046s/iter; left time: 11.9767s
Updating learning rate to 0.0001187482146823405
Epoch: 3 cost time: 2.506743907928467
Epoch: 3, Steps: 514 | Train Loss: 0.5801158 Vali Loss: 0.3706234 Best vali loss: 0.3636781

best validation loss 0.36367806627146154

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.002166450892, 'e_layers': 2, 'learning_rate': 0.0001717648623, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8586191
	speed: 0.0108s/iter; left time: 26.8073s
	iters: 200, epoch: 4 | loss: 0.5084291
	speed: 0.0044s/iter; left time: 10.4365s
	iters: 300, epoch: 4 | loss: 0.9527509
	speed: 0.0047s/iter; left time: 10.5810s
	iters: 400, epoch: 4 | loss: 0.3521748
	speed: 0.0053s/iter; left time: 11.4684s
	iters: 500, epoch: 4 | loss: 0.3020155
	speed: 0.0048s/iter; left time: 10.0074s
Updating learning rate to 8.588243115e-05
Epoch: 4 cost time: 2.7424488067626953
Epoch: 4, Steps: 514 | Train Loss: 0.5947979 Vali Loss: 0.3898266 Best vali loss: 0.3636781
	iters: 100, epoch: 5 | loss: 0.5087826
	speed: 0.0114s/iter; left time: 22.3174s
	iters: 200, epoch: 5 | loss: 0.7006969
	speed: 0.0045s/iter; left time: 8.3788s
	iters: 300, epoch: 5 | loss: 0.7972876
	speed: 0.0034s/iter; left time: 6.0366s
	iters: 400, epoch: 5 | loss: 0.3984623
	speed: 0.0034s/iter; left time: 5.6194s
	iters: 500, epoch: 5 | loss: 0.7498201
	speed: 0.0044s/iter; left time: 6.7758s
Updating learning rate to 5.30166476176595e-05
Validation loss decreased (0.3637 --> 0.3619).  Saving model state dict ...
Epoch: 5 cost time: 2.16702938079834
Epoch: 5, Steps: 514 | Train Loss: 0.6310099 Vali Loss: 0.3619348 Best vali loss: 0.3619348
	iters: 100, epoch: 6 | loss: 0.5408407
	speed: 0.0112s/iter; left time: 16.2082s
	iters: 200, epoch: 6 | loss: 0.6748208
	speed: 0.0049s/iter; left time: 6.5962s
	iters: 300, epoch: 6 | loss: 0.4164401
	speed: 0.0049s/iter; left time: 6.1136s
	iters: 400, epoch: 6 | loss: 0.5624138
	speed: 0.0047s/iter; left time: 5.3997s
	iters: 500, epoch: 6 | loss: 0.4757954
	speed: 0.0048s/iter; left time: 4.9889s
Updating learning rate to 2.515438169904822e-05
Epoch: 6 cost time: 2.5409858226776123
Epoch: 6, Steps: 514 | Train Loss: 0.5340621 Vali Loss: 0.3716852 Best vali loss: 0.3619348
	iters: 100, epoch: 7 | loss: 0.4750805
	speed: 0.0111s/iter; left time: 10.2675s
	iters: 200, epoch: 7 | loss: 0.7409793
	speed: 0.0047s/iter; left time: 3.8632s
	iters: 300, epoch: 7 | loss: 0.5202449
	speed: 0.0047s/iter; left time: 3.3908s
	iters: 400, epoch: 7 | loss: 0.4209650
	speed: 0.0046s/iter; left time: 2.9004s
	iters: 500, epoch: 7 | loss: 0.2626486
	speed: 0.0050s/iter; left time: 2.6274s
Updating learning rate to 6.53741080820523e-06
Epoch: 7 cost time: 2.490424156188965
Epoch: 7, Steps: 514 | Train Loss: 0.4839837 Vali Loss: 0.3636485 Best vali loss: 0.3619348
	iters: 100, epoch: 8 | loss: 0.6326108
	speed: 0.0112s/iter; left time: 4.6370s
	iters: 200, epoch: 8 | loss: 0.2520554
	speed: 0.0048s/iter; left time: 1.4993s
	iters: 300, epoch: 8 | loss: 0.6412250
	speed: 0.0048s/iter; left time: 1.0374s
	iters: 400, epoch: 8 | loss: 0.6581948
	speed: 0.0045s/iter; left time: 0.5143s
	iters: 500, epoch: 8 | loss: 0.5436413
	speed: 0.0049s/iter; left time: 0.0735s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5091559886932373
Epoch: 8, Steps: 514 | Train Loss: 0.5455455 Vali Loss: 0.3720247 Best vali loss: 0.3619348

best validation loss 0.36193478050658184

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011023654446, 'e_layers': 1, 'learning_rate': 0.0011214708245, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4766688
	speed: 0.0099s/iter; left time: 9.2520s
Updating learning rate to 0.0010787873827820538
Validation loss decreased (inf --> 0.3789).  Saving model state dict ...
Epoch: 1 cost time: 0.8550252914428711
Epoch: 1, Steps: 129 | Train Loss: 0.4766688 Vali Loss: 0.3788625 Best vali loss: 0.3788625
	iters: 100, epoch: 2 | loss: 0.5241757
	speed: 0.0089s/iter; left time: 7.1767s
Updating learning rate to 0.0009572352247034093
Validation loss decreased (0.3789 --> 0.3697).  Saving model state dict ...
Epoch: 2 cost time: 0.7049636840820312
Epoch: 2, Steps: 129 | Train Loss: 0.5241757 Vali Loss: 0.3696788 Best vali loss: 0.3696788
	iters: 100, epoch: 3 | loss: 0.3926466
	speed: 0.0096s/iter; left time: 6.4542s
Updating learning rate to 0.0007753195644584837
Epoch: 3 cost time: 0.6751396656036377
Epoch: 3, Steps: 129 | Train Loss: 0.3926466 Vali Loss: 0.3766039 Best vali loss: 0.3696788
	iters: 100, epoch: 4 | loss: 0.4862073
	speed: 0.0092s/iter; left time: 5.0450s
Updating learning rate to 0.00056073541225
Epoch: 4 cost time: 0.6960153579711914
Epoch: 4, Steps: 129 | Train Loss: 0.4862073 Vali Loss: 0.3945481 Best vali loss: 0.3696788
	iters: 100, epoch: 5 | loss: 0.5779063
	speed: 0.0083s/iter; left time: 3.4569s
Updating learning rate to 0.0003461512600415164
Epoch: 5 cost time: 0.547274112701416
Epoch: 5, Steps: 129 | Train Loss: 0.5779063 Vali Loss: 0.4153809 Best vali loss: 0.3696788
	iters: 100, epoch: 6 | loss: 0.4145634
	speed: 0.0063s/iter; left time: 1.8124s
Updating learning rate to 0.00016423559979659077
Epoch: 6 cost time: 0.5156962871551514
Epoch: 6, Steps: 129 | Train Loss: 0.4145634 Vali Loss: 0.4212235 Best vali loss: 0.3696788
	iters: 100, epoch: 7 | loss: 0.4697191
	speed: 0.0100s/iter; left time: 1.5875s
Updating learning rate to 4.268344171794636e-05
Epoch: 7 cost time: 0.795095682144165
Epoch: 7, Steps: 129 | Train Loss: 0.4697191 Vali Loss: 0.4318129 Best vali loss: 0.3696788
	iters: 100, epoch: 8 | loss: 0.3167532
	speed: 0.0098s/iter; left time: 0.2938s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6672389507293701
Epoch: 8, Steps: 129 | Train Loss: 0.3167532 Vali Loss: 0.4350173 Best vali loss: 0.3696788

best validation loss 0.3696788286881737

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0064522030262, 'e_layers': 1, 'learning_rate': 7.26721484e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3851383
	speed: 0.0095s/iter; left time: 76.7563s
	iters: 200, epoch: 1 | loss: 0.4372224
	speed: 0.0040s/iter; left time: 32.1001s
	iters: 300, epoch: 1 | loss: 0.3919816
	speed: 0.0027s/iter; left time: 21.3355s
	iters: 400, epoch: 1 | loss: 0.9619996
	speed: 0.0038s/iter; left time: 29.6199s
	iters: 500, epoch: 1 | loss: 1.4042176
	speed: 0.0028s/iter; left time: 21.9377s
	iters: 600, epoch: 1 | loss: 1.3850940
	speed: 0.0036s/iter; left time: 27.4405s
	iters: 700, epoch: 1 | loss: 0.4161898
	speed: 0.0028s/iter; left time: 21.3587s
	iters: 800, epoch: 1 | loss: 1.2674373
	speed: 0.0034s/iter; left time: 25.1418s
	iters: 900, epoch: 1 | loss: 0.2988313
	speed: 0.0030s/iter; left time: 22.0380s
	iters: 1000, epoch: 1 | loss: 0.7703924
	speed: 0.0021s/iter; left time: 15.4888s
Updating learning rate to 6.990622944519142e-05
Validation loss decreased (inf --> 0.4008).  Saving model state dict ...
Epoch: 1 cost time: 3.5283305644989014
Epoch: 1, Steps: 1027 | Train Loss: 0.7718504 Vali Loss: 0.4008052 Best vali loss: 0.4008052
	iters: 100, epoch: 2 | loss: 0.9474180
	speed: 0.0077s/iter; left time: 54.8206s
	iters: 200, epoch: 2 | loss: 0.4390309
	speed: 0.0029s/iter; left time: 20.1829s
	iters: 300, epoch: 2 | loss: 0.3256809
	speed: 0.0029s/iter; left time: 19.7423s
	iters: 400, epoch: 2 | loss: 1.2682927
	speed: 0.0029s/iter; left time: 19.7559s
	iters: 500, epoch: 2 | loss: 0.9581484
	speed: 0.0029s/iter; left time: 19.4222s
	iters: 600, epoch: 2 | loss: 0.4074047
	speed: 0.0029s/iter; left time: 19.0505s
	iters: 700, epoch: 2 | loss: 1.1823018
	speed: 0.0029s/iter; left time: 18.6977s
	iters: 800, epoch: 2 | loss: 0.5959078
	speed: 0.0029s/iter; left time: 18.4986s
	iters: 900, epoch: 2 | loss: 0.3769045
	speed: 0.0029s/iter; left time: 18.1326s
	iters: 1000, epoch: 2 | loss: 1.0291132
	speed: 0.0029s/iter; left time: 17.8803s
Updating learning rate to 6.202955866851755e-05
Validation loss decreased (0.4008 --> 0.3811).  Saving model state dict ...
Epoch: 2 cost time: 2.987509250640869
Epoch: 2, Steps: 1027 | Train Loss: 0.7530203 Vali Loss: 0.3810761 Best vali loss: 0.3810761
	iters: 100, epoch: 3 | loss: 0.7719125
	speed: 0.0098s/iter; left time: 59.1793s
	iters: 200, epoch: 3 | loss: 0.8885090
	speed: 0.0029s/iter; left time: 17.0168s
	iters: 300, epoch: 3 | loss: 0.2661911
	speed: 0.0028s/iter; left time: 16.1483s
	iters: 400, epoch: 3 | loss: 0.5771682
	speed: 0.0027s/iter; left time: 15.7601s
	iters: 500, epoch: 3 | loss: 1.0762690
	speed: 0.0028s/iter; left time: 15.6098s
	iters: 600, epoch: 3 | loss: 0.2974519
	speed: 0.0027s/iter; left time: 15.1103s
	iters: 700, epoch: 3 | loss: 0.3741409
	speed: 0.0027s/iter; left time: 14.8432s
	iters: 800, epoch: 3 | loss: 0.3105795
	speed: 0.0027s/iter; left time: 14.4735s
	iters: 900, epoch: 3 | loss: 0.3749556
	speed: 0.0027s/iter; left time: 14.2778s
	iters: 1000, epoch: 3 | loss: 0.2353594
	speed: 0.0026s/iter; left time: 13.2796s
Updating learning rate to 5.024128779352858e-05
Validation loss decreased (0.3811 --> 0.3730).  Saving model state dict ...
Epoch: 3 cost time: 2.8458714485168457
Epoch: 3, Steps: 1027 | Train Loss: 0.5172537 Vali Loss: 0.3730061 Best vali loss: 0.3730061
	iters: 100, epoch: 4 | loss: 0.2711996
	speed: 0.0099s/iter; left time: 49.9202s
	iters: 200, epoch: 4 | loss: 0.6397258
	speed: 0.0030s/iter; left time: 14.9558s
	iters: 300, epoch: 4 | loss: 0.2792170
	speed: 0.0031s/iter; left time: 14.9414s
	iters: 400, epoch: 4 | loss: 0.3979722
	speed: 0.0030s/iter; left time: 14.0920s
	iters: 500, epoch: 4 | loss: 0.3991226
	speed: 0.0029s/iter; left time: 13.3747s
	iters: 600, epoch: 4 | loss: 1.2335206
	speed: 0.0029s/iter; left time: 13.3292s
	iters: 700, epoch: 4 | loss: 0.3522445
	speed: 0.0028s/iter; left time: 12.3139s
	iters: 800, epoch: 4 | loss: 1.1193271
	speed: 0.0029s/iter; left time: 12.4045s
	iters: 900, epoch: 4 | loss: 0.3139697
	speed: 0.0027s/iter; left time: 11.4716s
	iters: 1000, epoch: 4 | loss: 0.5208384
	speed: 0.0026s/iter; left time: 10.6883s
Updating learning rate to 3.63360742e-05
Validation loss decreased (0.3730 --> 0.3694).  Saving model state dict ...
Epoch: 4 cost time: 3.0065057277679443
Epoch: 4, Steps: 1027 | Train Loss: 0.5527138 Vali Loss: 0.3694471 Best vali loss: 0.3694471
	iters: 100, epoch: 5 | loss: 0.2842900
	speed: 0.0098s/iter; left time: 39.4682s
	iters: 200, epoch: 5 | loss: 0.3567016
	speed: 0.0028s/iter; left time: 11.0559s
	iters: 300, epoch: 5 | loss: 0.3051204
	speed: 0.0029s/iter; left time: 10.9834s
	iters: 400, epoch: 5 | loss: 0.2895144
	speed: 0.0030s/iter; left time: 11.0764s
	iters: 500, epoch: 5 | loss: 1.4370568
	speed: 0.0030s/iter; left time: 10.8099s
	iters: 600, epoch: 5 | loss: 0.4356041
	speed: 0.0030s/iter; left time: 10.4557s
	iters: 700, epoch: 5 | loss: 1.1172286
	speed: 0.0029s/iter; left time: 9.9929s
	iters: 800, epoch: 5 | loss: 0.6605566
	speed: 0.0029s/iter; left time: 9.6145s
	iters: 900, epoch: 5 | loss: 0.2516979
	speed: 0.0026s/iter; left time: 8.3435s
	iters: 1000, epoch: 5 | loss: 0.2871844
	speed: 0.0026s/iter; left time: 8.0500s
Updating learning rate to 2.2430860606471416e-05
Validation loss decreased (0.3694 --> 0.3676).  Saving model state dict ...
Epoch: 5 cost time: 2.9743494987487793
Epoch: 5, Steps: 1027 | Train Loss: 0.5424955 Vali Loss: 0.3676440 Best vali loss: 0.3676440
	iters: 100, epoch: 6 | loss: 0.6296995
	speed: 0.0100s/iter; left time: 29.7178s
	iters: 200, epoch: 6 | loss: 0.8582761
	speed: 0.0029s/iter; left time: 8.2860s
	iters: 300, epoch: 6 | loss: 0.3369042
	speed: 0.0029s/iter; left time: 8.0202s
	iters: 400, epoch: 6 | loss: 0.5651190
	speed: 0.0029s/iter; left time: 7.7209s
	iters: 500, epoch: 6 | loss: 1.1208268
	speed: 0.0029s/iter; left time: 7.4689s
	iters: 600, epoch: 6 | loss: 0.2375556
	speed: 0.0029s/iter; left time: 7.1535s
	iters: 700, epoch: 6 | loss: 0.7236885
	speed: 0.0029s/iter; left time: 6.8580s
	iters: 800, epoch: 6 | loss: 0.7473274
	speed: 0.0027s/iter; left time: 6.2453s
	iters: 900, epoch: 6 | loss: 0.3266156
	speed: 0.0026s/iter; left time: 5.6359s
	iters: 1000, epoch: 6 | loss: 0.6892348
	speed: 0.0026s/iter; left time: 5.4094s
Updating learning rate to 1.0642589731482448e-05
Validation loss decreased (0.3676 --> 0.3666).  Saving model state dict ...
Epoch: 6 cost time: 2.9291484355926514
Epoch: 6, Steps: 1027 | Train Loss: 0.6235248 Vali Loss: 0.3665727 Best vali loss: 0.3665727
	iters: 100, epoch: 7 | loss: 0.2531448
	speed: 0.0102s/iter; left time: 19.9107s
	iters: 200, epoch: 7 | loss: 0.4004718
	speed: 0.0029s/iter; left time: 5.4315s
	iters: 300, epoch: 7 | loss: 0.7367126
	speed: 0.0029s/iter; left time: 5.1222s
	iters: 400, epoch: 7 | loss: 1.4608140
	speed: 0.0029s/iter; left time: 4.7936s
	iters: 500, epoch: 7 | loss: 0.3262066
	speed: 0.0029s/iter; left time: 4.4902s
	iters: 600, epoch: 7 | loss: 0.2077287
	speed: 0.0029s/iter; left time: 4.2022s
	iters: 700, epoch: 7 | loss: 0.5963192
	speed: 0.0029s/iter; left time: 3.9079s
	iters: 800, epoch: 7 | loss: 1.0071108
	speed: 0.0026s/iter; left time: 3.2511s
	iters: 900, epoch: 7 | loss: 0.5035478
	speed: 0.0026s/iter; left time: 3.0417s
	iters: 1000, epoch: 7 | loss: 0.3022708
	speed: 0.0027s/iter; left time: 2.8592s
Updating learning rate to 2.7659189548085726e-06
Validation loss decreased (0.3666 --> 0.3662).  Saving model state dict ...
Epoch: 7 cost time: 2.9492716789245605
Epoch: 7, Steps: 1027 | Train Loss: 0.5794327 Vali Loss: 0.3662266 Best vali loss: 0.3662266
	iters: 100, epoch: 8 | loss: 0.1848631
	speed: 0.0103s/iter; left time: 9.5728s
	iters: 200, epoch: 8 | loss: 0.9922634
	speed: 0.0029s/iter; left time: 2.3955s
	iters: 300, epoch: 8 | loss: 0.6031254
	speed: 0.0029s/iter; left time: 2.1092s
	iters: 400, epoch: 8 | loss: 1.2188276
	speed: 0.0029s/iter; left time: 1.8361s
	iters: 500, epoch: 8 | loss: 0.3625377
	speed: 0.0031s/iter; left time: 1.6392s
	iters: 600, epoch: 8 | loss: 0.6606113
	speed: 0.0029s/iter; left time: 1.2224s
	iters: 700, epoch: 8 | loss: 1.3987712
	speed: 0.0026s/iter; left time: 0.8548s
	iters: 800, epoch: 8 | loss: 0.2531967
	speed: 0.0025s/iter; left time: 0.5767s
	iters: 900, epoch: 8 | loss: 0.9962042
	speed: 0.0026s/iter; left time: 0.3310s
	iters: 1000, epoch: 8 | loss: 0.9777130
	speed: 0.0029s/iter; left time: 0.0816s
Updating learning rate to 0.0
Validation loss decreased (0.3662 --> 0.3661).  Saving model state dict ...
Epoch: 8 cost time: 2.9470221996307373
Epoch: 8, Steps: 1027 | Train Loss: 0.7648114 Vali Loss: 0.3661409 Best vali loss: 0.3661409

best validation loss 0.36614093309769696

{'batch_size': 16, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023187419427, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6023933
	speed: 0.0103s/iter; left time: 41.4616s
	iters: 200, epoch: 1 | loss: 0.5866479
	speed: 0.0040s/iter; left time: 15.7387s
	iters: 300, epoch: 1 | loss: 0.7136483
	speed: 0.0035s/iter; left time: 13.2345s
	iters: 400, epoch: 1 | loss: 0.3033972
	speed: 0.0038s/iter; left time: 13.9307s
	iters: 500, epoch: 1 | loss: 1.2120448
	speed: 0.0027s/iter; left time: 9.9211s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 2.1757500171661377
Epoch: 1, Steps: 514 | Train Loss: 0.6836263 Vali Loss: 0.3674657 Best vali loss: 0.3674657
	iters: 100, epoch: 2 | loss: 0.8275701
	speed: 0.0065s/iter; left time: 22.7912s
	iters: 200, epoch: 2 | loss: 0.5556750
	speed: 0.0039s/iter; left time: 13.3537s
	iters: 300, epoch: 2 | loss: 0.8487567
	speed: 0.0040s/iter; left time: 13.0809s
	iters: 400, epoch: 2 | loss: 0.5073757
	speed: 0.0034s/iter; left time: 10.8083s
	iters: 500, epoch: 2 | loss: 0.8139293
	speed: 0.0034s/iter; left time: 10.4395s
Updating learning rate to 0.0002612410192867383
Epoch: 2 cost time: 1.8295185565948486
Epoch: 2, Steps: 514 | Train Loss: 0.7106614 Vali Loss: 0.3701750 Best vali loss: 0.3674657
	iters: 100, epoch: 3 | loss: 0.4982264
	speed: 0.0092s/iter; left time: 27.3575s
	iters: 200, epoch: 3 | loss: 0.4907640
	speed: 0.0037s/iter; left time: 10.7130s
	iters: 300, epoch: 3 | loss: 0.5983814
	speed: 0.0035s/iter; left time: 9.6690s
	iters: 400, epoch: 3 | loss: 0.4160495
	speed: 0.0034s/iter; left time: 9.1826s
	iters: 500, epoch: 3 | loss: 0.7227271
	speed: 0.0039s/iter; left time: 9.9589s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.9019505977630615
Epoch: 3, Steps: 514 | Train Loss: 0.5452297 Vali Loss: 0.3736650 Best vali loss: 0.3674657

best validation loss 0.36746574244471103

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.002026610841687957
Validation loss decreased (inf --> 0.3649).  Saving model state dict ...
Epoch: 1 cost time: 0.7628843784332275
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3649137 Best vali loss: 0.3649137
Updating learning rate to 0.001798262860126036
Epoch: 2 cost time: 0.48900437355041504
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3752778 Best vali loss: 0.3649137
Updating learning rate to 0.0014565159550274328
Epoch: 3 cost time: 0.4281013011932373
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3777580 Best vali loss: 0.3649137

best validation loss 0.364913678368323

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0103950152165, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6546248
	speed: 0.0107s/iter; left time: 9.9590s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 0.9456312656402588
Epoch: 1, Steps: 129 | Train Loss: 0.6546248 Vali Loss: 0.3665314 Best vali loss: 0.3665314
	iters: 100, epoch: 2 | loss: 0.5720847
	speed: 0.0094s/iter; left time: 7.5301s
Updating learning rate to 0.00093122262415
Epoch: 2 cost time: 0.6844429969787598
Epoch: 2, Steps: 129 | Train Loss: 0.5720847 Vali Loss: 0.3714985 Best vali loss: 0.3665314
	iters: 100, epoch: 3 | loss: 0.4080926
	speed: 0.0074s/iter; left time: 5.0282s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.47689247131347656
Epoch: 3, Steps: 129 | Train Loss: 0.4080926 Vali Loss: 0.3732642 Best vali loss: 0.3665314

best validation loss 0.3665314036877076

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0087723836716, 'e_layers': 1, 'learning_rate': 0.0021067959895, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00105339799475
Epoch: 4 cost time: 0.7335221767425537
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3866698 Best vali loss: 0.3649137
Updating learning rate to 0.0006502800344725672
Epoch: 5 cost time: 0.45036935806274414
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3925678 Best vali loss: 0.3649137
Updating learning rate to 0.0003085331293739639
Epoch: 6 cost time: 0.5014679431915283
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3927079 Best vali loss: 0.3649137
Updating learning rate to 8.018514781204311e-05
Epoch: 7 cost time: 0.42040157318115234
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3959045 Best vali loss: 0.3649137
Updating learning rate to 0.0
Epoch: 8 cost time: 0.33129358291625977
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3915209 Best vali loss: 0.3649137

best validation loss 0.364913678368323

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0015627682118, 'e_layers': 4, 'learning_rate': 7.53636528e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7017512
	speed: 0.0133s/iter; left time: 12.3992s
Updating learning rate to 7.53636528e-05
Validation loss decreased (inf --> 0.4265).  Saving model state dict ...
Epoch: 1 cost time: 1.2960498332977295
Epoch: 1, Steps: 129 | Train Loss: 0.7017512 Vali Loss: 0.4265017 Best vali loss: 0.4265017
	iters: 100, epoch: 2 | loss: 0.5182679
	speed: 0.0133s/iter; left time: 10.7239s
Updating learning rate to 3.76818264e-05
Validation loss decreased (0.4265 --> 0.4098).  Saving model state dict ...
Epoch: 2 cost time: 1.1190001964569092
Epoch: 2, Steps: 129 | Train Loss: 0.5182679 Vali Loss: 0.4098197 Best vali loss: 0.4098197
	iters: 100, epoch: 3 | loss: 0.5368702
	speed: 0.0142s/iter; left time: 9.5627s
Updating learning rate to 1.88409132e-05
Validation loss decreased (0.4098 --> 0.4034).  Saving model state dict ...
Epoch: 3 cost time: 1.1347265243530273
Epoch: 3, Steps: 129 | Train Loss: 0.5368702 Vali Loss: 0.4034356 Best vali loss: 0.4034356
	iters: 100, epoch: 4 | loss: 0.5571414
	speed: 0.0136s/iter; left time: 7.4438s
Updating learning rate to 9.4204566e-06
Validation loss decreased (0.4034 --> 0.4009).  Saving model state dict ...
Epoch: 4 cost time: 1.1301963329315186
Epoch: 4, Steps: 129 | Train Loss: 0.5571414 Vali Loss: 0.4009112 Best vali loss: 0.4009112
	iters: 100, epoch: 5 | loss: 0.6826801
	speed: 0.0134s/iter; left time: 5.5877s
Updating learning rate to 4.7102283e-06
Validation loss decreased (0.4009 --> 0.3997).  Saving model state dict ...
Epoch: 5 cost time: 1.1053104400634766
Epoch: 5, Steps: 129 | Train Loss: 0.6826801 Vali Loss: 0.3996567 Best vali loss: 0.3996567
	iters: 100, epoch: 6 | loss: 0.6704291
	speed: 0.0142s/iter; left time: 4.0925s
Updating learning rate to 2.35511415e-06
Validation loss decreased (0.3997 --> 0.3990).  Saving model state dict ...
Epoch: 6 cost time: 1.1479356288909912
Epoch: 6, Steps: 129 | Train Loss: 0.6704291 Vali Loss: 0.3990286 Best vali loss: 0.3990286
	iters: 100, epoch: 7 | loss: 0.6733106
	speed: 0.0134s/iter; left time: 2.1257s
Updating learning rate to 1.177557075e-06
Validation loss decreased (0.3990 --> 0.3987).  Saving model state dict ...
Epoch: 7 cost time: 1.1038904190063477
Epoch: 7, Steps: 129 | Train Loss: 0.6733106 Vali Loss: 0.3987397 Best vali loss: 0.3987397
	iters: 100, epoch: 8 | loss: 0.6578602
	speed: 0.0131s/iter; left time: 0.3918s
Updating learning rate to 5.887785375e-07
Validation loss decreased (0.3987 --> 0.3986).  Saving model state dict ...
Epoch: 8 cost time: 1.0582044124603271
Epoch: 8, Steps: 129 | Train Loss: 0.6578602 Vali Loss: 0.3985848 Best vali loss: 0.3985848

best validation loss 0.39858477391990554

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0055926391682, 'e_layers': 4, 'learning_rate': 0.0040085882975, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0660560
	speed: 0.0119s/iter; left time: 96.9951s
	iters: 200, epoch: 1 | loss: 0.3913689
	speed: 0.0059s/iter; left time: 47.4268s
	iters: 300, epoch: 1 | loss: 0.2897889
	speed: 0.0069s/iter; left time: 54.4076s
	iters: 400, epoch: 1 | loss: 0.4974125
	speed: 0.0061s/iter; left time: 47.5454s
	iters: 500, epoch: 1 | loss: 0.1738655
	speed: 0.0060s/iter; left time: 46.4594s
	iters: 600, epoch: 1 | loss: 1.1403787
	speed: 0.0065s/iter; left time: 49.1766s
	iters: 700, epoch: 1 | loss: 0.5487093
	speed: 0.0059s/iter; left time: 44.0321s
	iters: 800, epoch: 1 | loss: 1.0967160
	speed: 0.0066s/iter; left time: 49.0869s
	iters: 900, epoch: 1 | loss: 0.4350128
	speed: 0.0061s/iter; left time: 44.3075s
	iters: 1000, epoch: 1 | loss: 1.4691064
	speed: 0.0064s/iter; left time: 46.3610s
Updating learning rate to 0.0038560204899122574
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 6.706564903259277
Epoch: 1, Steps: 1027 | Train Loss: 0.7108415 Vali Loss: 0.3732273 Best vali loss: 0.3732273
	iters: 100, epoch: 2 | loss: 1.4807224
	speed: 0.0162s/iter; left time: 114.7277s
	iters: 200, epoch: 2 | loss: 0.8274930
	speed: 0.0059s/iter; left time: 41.5266s
	iters: 300, epoch: 2 | loss: 0.2858120
	speed: 0.0046s/iter; left time: 31.6269s
	iters: 400, epoch: 2 | loss: 0.4144226
	speed: 0.0053s/iter; left time: 36.2457s
	iters: 500, epoch: 2 | loss: 0.4984467
	speed: 0.0061s/iter; left time: 40.7661s
	iters: 600, epoch: 2 | loss: 0.5263249
	speed: 0.0061s/iter; left time: 40.4380s
	iters: 700, epoch: 2 | loss: 0.9599699
	speed: 0.0060s/iter; left time: 38.8012s
	iters: 800, epoch: 2 | loss: 0.3233084
	speed: 0.0060s/iter; left time: 38.6098s
	iters: 900, epoch: 2 | loss: 0.2756190
	speed: 0.0060s/iter; left time: 37.8839s
	iters: 1000, epoch: 2 | loss: 0.6417802
	speed: 0.0060s/iter; left time: 37.1248s
Updating learning rate to 0.0034215441328236435
Validation loss decreased (0.3732 --> 0.3728).  Saving model state dict ...
Epoch: 2 cost time: 6.041223764419556
Epoch: 2, Steps: 1027 | Train Loss: 0.6233899 Vali Loss: 0.3727574 Best vali loss: 0.3727574
	iters: 100, epoch: 3 | loss: 0.4268719
	speed: 0.0173s/iter; left time: 104.7252s
	iters: 200, epoch: 3 | loss: 0.4328243
	speed: 0.0059s/iter; left time: 35.3432s
	iters: 300, epoch: 3 | loss: 0.2345259
	speed: 0.0060s/iter; left time: 34.9778s
	iters: 400, epoch: 3 | loss: 0.9852920
	speed: 0.0061s/iter; left time: 35.2055s
	iters: 500, epoch: 3 | loss: 0.7888399
	speed: 0.0061s/iter; left time: 34.6320s
	iters: 600, epoch: 3 | loss: 2.4146416
	speed: 0.0061s/iter; left time: 34.1073s
	iters: 700, epoch: 3 | loss: 1.0180265
	speed: 0.0061s/iter; left time: 33.1798s
	iters: 800, epoch: 3 | loss: 0.3801467
	speed: 0.0061s/iter; left time: 32.7597s
	iters: 900, epoch: 3 | loss: 1.0910833
	speed: 0.0060s/iter; left time: 31.7688s
	iters: 1000, epoch: 3 | loss: 0.3557540
	speed: 0.0060s/iter; left time: 31.2027s
Updating learning rate to 0.002771304313062916
Epoch: 3 cost time: 6.293254375457764
Epoch: 3, Steps: 1027 | Train Loss: 0.8128006 Vali Loss: 0.3757968 Best vali loss: 0.3727574
	iters: 100, epoch: 4 | loss: 0.2361536
	speed: 0.0165s/iter; left time: 83.0879s
	iters: 200, epoch: 4 | loss: 0.2787037
	speed: 0.0057s/iter; left time: 28.3569s
	iters: 300, epoch: 4 | loss: 0.3477141
	speed: 0.0061s/iter; left time: 29.5157s
	iters: 400, epoch: 4 | loss: 1.2385191
	speed: 0.0060s/iter; left time: 28.6156s
	iters: 500, epoch: 4 | loss: 0.2107938
	speed: 0.0062s/iter; left time: 28.5346s
	iters: 600, epoch: 4 | loss: 1.6974264
	speed: 0.0062s/iter; left time: 27.9871s
	iters: 700, epoch: 4 | loss: 0.3631603
	speed: 0.0062s/iter; left time: 27.4243s
	iters: 800, epoch: 4 | loss: 0.4656226
	speed: 0.0062s/iter; left time: 26.7209s
	iters: 900, epoch: 4 | loss: 0.4583619
	speed: 0.0062s/iter; left time: 26.1450s
	iters: 1000, epoch: 4 | loss: 1.0717828
	speed: 0.0061s/iter; left time: 25.2979s
Updating learning rate to 0.00200429414875
Validation loss decreased (0.3728 --> 0.3651).  Saving model state dict ...
Epoch: 4 cost time: 6.274308681488037
Epoch: 4, Steps: 1027 | Train Loss: 0.6368238 Vali Loss: 0.3651397 Best vali loss: 0.3651397
	iters: 100, epoch: 5 | loss: 0.3937625
	speed: 0.0164s/iter; left time: 65.9017s
	iters: 200, epoch: 5 | loss: 0.6255246
	speed: 0.0061s/iter; left time: 24.0053s
	iters: 300, epoch: 5 | loss: 0.3531752
	speed: 0.0062s/iter; left time: 23.6691s
	iters: 400, epoch: 5 | loss: 1.4178050
	speed: 0.0060s/iter; left time: 22.4258s
	iters: 500, epoch: 5 | loss: 0.4189760
	speed: 0.0061s/iter; left time: 21.9659s
	iters: 600, epoch: 5 | loss: 1.7434208
	speed: 0.0061s/iter; left time: 21.3671s
	iters: 700, epoch: 5 | loss: 0.8794751
	speed: 0.0061s/iter; left time: 20.9292s
	iters: 800, epoch: 5 | loss: 0.4067223
	speed: 0.0061s/iter; left time: 20.1946s
	iters: 900, epoch: 5 | loss: 0.3044012
	speed: 0.0061s/iter; left time: 19.4536s
	iters: 1000, epoch: 5 | loss: 0.4892117
	speed: 0.0060s/iter; left time: 18.6279s
Updating learning rate to 0.0012372839844370842
Epoch: 5 cost time: 6.275741100311279
Epoch: 5, Steps: 1027 | Train Loss: 0.7032474 Vali Loss: 0.3735102 Best vali loss: 0.3651397
	iters: 100, epoch: 6 | loss: 0.9024114
	speed: 0.0163s/iter; left time: 48.5764s
	iters: 200, epoch: 6 | loss: 0.9786715
	speed: 0.0062s/iter; left time: 17.8752s
	iters: 300, epoch: 6 | loss: 0.9275361
	speed: 0.0061s/iter; left time: 17.0977s
	iters: 400, epoch: 6 | loss: 0.3054570
	speed: 0.0061s/iter; left time: 16.2382s
	iters: 500, epoch: 6 | loss: 0.2430204
	speed: 0.0061s/iter; left time: 15.7371s
	iters: 600, epoch: 6 | loss: 0.4621363
	speed: 0.0062s/iter; left time: 15.2944s
	iters: 700, epoch: 6 | loss: 0.8753741
	speed: 0.0060s/iter; left time: 14.2660s
	iters: 800, epoch: 6 | loss: 0.4250987
	speed: 0.0059s/iter; left time: 13.3809s
	iters: 900, epoch: 6 | loss: 0.3640079
	speed: 0.0059s/iter; left time: 12.8664s
	iters: 1000, epoch: 6 | loss: 0.9357717
	speed: 0.0061s/iter; left time: 12.7909s
Updating learning rate to 0.0005870441646763563
Epoch: 6 cost time: 6.259705543518066
Epoch: 6, Steps: 1027 | Train Loss: 0.6419485 Vali Loss: 0.3706177 Best vali loss: 0.3651397
	iters: 100, epoch: 7 | loss: 1.3532087
	speed: 0.0163s/iter; left time: 31.8153s
	iters: 200, epoch: 7 | loss: 1.4802939
	speed: 0.0061s/iter; left time: 11.3585s
	iters: 300, epoch: 7 | loss: 0.5131729
	speed: 0.0061s/iter; left time: 10.6373s
	iters: 400, epoch: 7 | loss: 0.4294224
	speed: 0.0060s/iter; left time: 9.9216s
	iters: 500, epoch: 7 | loss: 0.9840326
	speed: 0.0061s/iter; left time: 9.5103s
	iters: 600, epoch: 7 | loss: 0.7760671
	speed: 0.0066s/iter; left time: 9.6239s
	iters: 700, epoch: 7 | loss: 0.4398198
	speed: 0.0061s/iter; left time: 8.3281s
	iters: 800, epoch: 7 | loss: 0.3452562
	speed: 0.0063s/iter; left time: 7.9606s
	iters: 900, epoch: 7 | loss: 0.2662485
	speed: 0.0064s/iter; left time: 7.3479s
	iters: 1000, epoch: 7 | loss: 1.3413919
	speed: 0.0062s/iter; left time: 6.5205s
Updating learning rate to 0.0001525678075877426
Epoch: 7 cost time: 6.43131422996521
Epoch: 7, Steps: 1027 | Train Loss: 0.7928914 Vali Loss: 0.3720315 Best vali loss: 0.3651397
	iters: 100, epoch: 8 | loss: 0.8775836
	speed: 0.0169s/iter; left time: 15.7250s
	iters: 200, epoch: 8 | loss: 1.1436177
	speed: 0.0064s/iter; left time: 5.3111s
	iters: 300, epoch: 8 | loss: 0.7578764
	speed: 0.0062s/iter; left time: 4.5126s
	iters: 400, epoch: 8 | loss: 0.2127290
	speed: 0.0063s/iter; left time: 3.9592s
	iters: 500, epoch: 8 | loss: 0.2855594
	speed: 0.0064s/iter; left time: 3.3986s
	iters: 600, epoch: 8 | loss: 0.3530550
	speed: 0.0064s/iter; left time: 2.7390s
	iters: 700, epoch: 8 | loss: 1.1772684
	speed: 0.0065s/iter; left time: 2.1178s
	iters: 800, epoch: 8 | loss: 0.2347990
	speed: 0.0064s/iter; left time: 1.4606s
	iters: 900, epoch: 8 | loss: 0.3155826
	speed: 0.0062s/iter; left time: 0.7917s
	iters: 1000, epoch: 8 | loss: 0.5780798
	speed: 0.0063s/iter; left time: 0.1759s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.5778656005859375
Epoch: 8, Steps: 1027 | Train Loss: 0.5936151 Vali Loss: 0.3703027 Best vali loss: 0.3651397

best validation loss 0.365139678911048

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0042863874146, 'e_layers': 4, 'learning_rate': 5.37539066e-05, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.37539066e-05
Validation loss decreased (inf --> 0.4382).  Saving model state dict ...
Epoch: 1 cost time: 0.8007049560546875
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4381819 Best vali loss: 0.4381819
Updating learning rate to 2.68769533e-05
Validation loss decreased (0.4382 --> 0.4272).  Saving model state dict ...
Epoch: 2 cost time: 0.5730137825012207
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4272486 Best vali loss: 0.4272486
Updating learning rate to 1.343847665e-05
Validation loss decreased (0.4272 --> 0.4224).  Saving model state dict ...
Epoch: 3 cost time: 0.5601229667663574
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4224125 Best vali loss: 0.4224125

best validation loss 0.42241252226304915

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0019514269464, 'e_layers': 3, 'learning_rate': 0.0028203081441, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5525812
	speed: 0.0153s/iter; left time: 14.2958s
Updating learning rate to 0.002712966556904441
Validation loss decreased (inf --> 0.4000).  Saving model state dict ...
Epoch: 1 cost time: 1.5403447151184082
Epoch: 1, Steps: 129 | Train Loss: 0.5525812 Vali Loss: 0.3999725 Best vali loss: 0.3999725
	iters: 100, epoch: 2 | loss: 0.5169592
	speed: 0.0157s/iter; left time: 12.6049s
Updating learning rate to 0.002407283578914378
Epoch: 2 cost time: 1.2609663009643555
Epoch: 2, Steps: 129 | Train Loss: 0.5169592 Vali Loss: 0.4001531 Best vali loss: 0.3999725
	iters: 100, epoch: 3 | loss: 0.4812831
	speed: 0.0134s/iter; left time: 9.0358s
Updating learning rate to 0.0019497966725057021
Epoch: 3 cost time: 1.171381950378418
Epoch: 3, Steps: 129 | Train Loss: 0.4812831 Vali Loss: 0.4037083 Best vali loss: 0.3999725

best validation loss 0.39997246309909934

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5300471
	speed: 0.0134s/iter; left time: 26.2012s
	iters: 200, epoch: 1 | loss: 1.1420807
	speed: 0.0052s/iter; left time: 9.7378s
Updating learning rate to 0.00031785342192023166
Validation loss decreased (inf --> 0.3691).  Saving model state dict ...
Epoch: 1 cost time: 1.9936113357543945
Epoch: 1, Steps: 257 | Train Loss: 0.8360639 Vali Loss: 0.3690695 Best vali loss: 0.3690695
	iters: 100, epoch: 2 | loss: 0.6744125
	speed: 0.0187s/iter; left time: 31.7707s
	iters: 200, epoch: 2 | loss: 0.8814356
	speed: 0.0114s/iter; left time: 18.1847s
Updating learning rate to 0.0002820393495610895
Validation loss decreased (0.3691 --> 0.3677).  Saving model state dict ...
Epoch: 2 cost time: 2.6201608180999756
Epoch: 2, Steps: 257 | Train Loss: 0.7779241 Vali Loss: 0.3676885 Best vali loss: 0.3676885
	iters: 100, epoch: 3 | loss: 0.7050846
	speed: 0.0195s/iter; left time: 28.1524s
	iters: 200, epoch: 3 | loss: 0.3062209
	speed: 0.0058s/iter; left time: 7.7785s
Updating learning rate to 0.00022843980248387857
Epoch: 3 cost time: 1.8949100971221924
Epoch: 3, Steps: 257 | Train Loss: 0.5056527 Vali Loss: 0.3683654 Best vali loss: 0.3676885

best validation loss 0.3676884991832238

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003304296517, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4557335
	speed: 0.0132s/iter; left time: 15.6851s
	iters: 200, epoch: 4 | loss: 1.0463786
	speed: 0.0072s/iter; left time: 7.7890s
Updating learning rate to 0.00016521482585
Epoch: 4 cost time: 2.1667110919952393
Epoch: 4, Steps: 257 | Train Loss: 0.7510560 Vali Loss: 0.3729042 Best vali loss: 0.3676885
	iters: 100, epoch: 5 | loss: 0.5543391
	speed: 0.0156s/iter; left time: 14.5294s
	iters: 200, epoch: 5 | loss: 0.7516919
	speed: 0.0074s/iter; left time: 6.1743s
Updating learning rate to 0.00010198984921612144
Epoch: 5 cost time: 1.998488426208496
Epoch: 5, Steps: 257 | Train Loss: 0.6530155 Vali Loss: 0.3866791 Best vali loss: 0.3676885
	iters: 100, epoch: 6 | loss: 0.6436303
	speed: 0.0150s/iter; left time: 10.1128s
	iters: 200, epoch: 6 | loss: 0.2776652
	speed: 0.0049s/iter; left time: 2.7764s
Updating learning rate to 4.8390302138910505e-05
Epoch: 6 cost time: 1.5379159450531006
Epoch: 6, Steps: 257 | Train Loss: 0.4606477 Vali Loss: 0.3922041 Best vali loss: 0.3676885
	iters: 100, epoch: 7 | loss: 0.4566967
	speed: 0.0136s/iter; left time: 5.6556s
	iters: 200, epoch: 7 | loss: 0.6262738
	speed: 0.0075s/iter; left time: 2.3601s
Updating learning rate to 1.2576229779768348e-05
Epoch: 7 cost time: 1.9578001499176025
Epoch: 7, Steps: 257 | Train Loss: 0.5414852 Vali Loss: 0.3929209 Best vali loss: 0.3676885
	iters: 100, epoch: 8 | loss: 0.6222814
	speed: 0.0151s/iter; left time: 2.3821s
	iters: 200, epoch: 8 | loss: 0.6945255
	speed: 0.0072s/iter; left time: 0.4199s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9049739837646484
Epoch: 8, Steps: 257 | Train Loss: 0.6584035 Vali Loss: 0.3893732 Best vali loss: 0.3676885

best validation loss 0.3676884991832238

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0061161357241, 'e_layers': 2, 'learning_rate': 0.0026491544935, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7328022
	speed: 0.0114s/iter; left time: 22.3386s
	iters: 200, epoch: 1 | loss: 0.6781894
	speed: 0.0056s/iter; left time: 10.4820s
Updating learning rate to 0.0026491544935
Validation loss decreased (inf --> 0.3864).  Saving model state dict ...
Epoch: 1 cost time: 1.7447571754455566
Epoch: 1, Steps: 257 | Train Loss: 0.7054958 Vali Loss: 0.3863961 Best vali loss: 0.3863961
	iters: 100, epoch: 2 | loss: 0.7193683
	speed: 0.0125s/iter; left time: 21.2804s
	iters: 200, epoch: 2 | loss: 0.8383250
	speed: 0.0052s/iter; left time: 8.2925s
Updating learning rate to 0.00132457724675
Validation loss decreased (0.3864 --> 0.3837).  Saving model state dict ...
Epoch: 2 cost time: 1.4222140312194824
Epoch: 2, Steps: 257 | Train Loss: 0.7788466 Vali Loss: 0.3837390 Best vali loss: 0.3837390
	iters: 100, epoch: 3 | loss: 0.4078695
	speed: 0.0119s/iter; left time: 17.1638s
	iters: 200, epoch: 3 | loss: 0.4615102
	speed: 0.0053s/iter; left time: 7.0791s
Updating learning rate to 0.000662288623375
Epoch: 3 cost time: 1.4283182621002197
Epoch: 3, Steps: 257 | Train Loss: 0.4346899 Vali Loss: 0.3851650 Best vali loss: 0.3837390
	iters: 100, epoch: 4 | loss: 0.3635841
	speed: 0.0093s/iter; left time: 11.0541s
	iters: 200, epoch: 4 | loss: 0.7098786
	speed: 0.0050s/iter; left time: 5.4336s
Updating learning rate to 0.0003311443116875
Epoch: 4 cost time: 1.2433876991271973
Epoch: 4, Steps: 257 | Train Loss: 0.5367314 Vali Loss: 0.3938060 Best vali loss: 0.3837390
	iters: 100, epoch: 5 | loss: 0.3855132
	speed: 0.0120s/iter; left time: 11.1647s
	iters: 200, epoch: 5 | loss: 0.2616648
	speed: 0.0048s/iter; left time: 4.0163s
Updating learning rate to 0.00016557215584375
Epoch: 5 cost time: 1.3659071922302246
Epoch: 5, Steps: 257 | Train Loss: 0.3235890 Vali Loss: 0.3999572 Best vali loss: 0.3837390
	iters: 100, epoch: 6 | loss: 0.4254870
	speed: 0.0117s/iter; left time: 7.8806s
	iters: 200, epoch: 6 | loss: 0.5166591
	speed: 0.0055s/iter; left time: 3.1733s
Updating learning rate to 8.2786077921875e-05
Epoch: 6 cost time: 1.4022114276885986
Epoch: 6, Steps: 257 | Train Loss: 0.4710730 Vali Loss: 0.3916579 Best vali loss: 0.3837390
	iters: 100, epoch: 7 | loss: 0.5576835
	speed: 0.0120s/iter; left time: 4.9932s
	iters: 200, epoch: 7 | loss: 0.9417138
	speed: 0.0051s/iter; left time: 1.6130s
Updating learning rate to 4.13930389609375e-05
Epoch: 7 cost time: 1.3917462825775146
Epoch: 7, Steps: 257 | Train Loss: 0.7496986 Vali Loss: 0.4014423 Best vali loss: 0.3837390
	iters: 100, epoch: 8 | loss: 0.4331661
	speed: 0.0126s/iter; left time: 1.9834s
	iters: 200, epoch: 8 | loss: 0.6082231
	speed: 0.0051s/iter; left time: 0.2949s
Updating learning rate to 2.069651948046875e-05
Epoch: 8 cost time: 1.4007642269134521
Epoch: 8, Steps: 257 | Train Loss: 0.5206946 Vali Loss: 0.3972629 Best vali loss: 0.3837390

best validation loss 0.3837390309115524

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062416843763, 'e_layers': 2, 'learning_rate': 9.67455128e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5234166
	speed: 0.0111s/iter; left time: 21.7280s
	iters: 200, epoch: 1 | loss: 0.5821560
	speed: 0.0056s/iter; left time: 10.4374s
Updating learning rate to 9.306335596911435e-05
Validation loss decreased (inf --> 0.3985).  Saving model state dict ...
Epoch: 1 cost time: 1.7082340717315674
Epoch: 1, Steps: 257 | Train Loss: 0.5527863 Vali Loss: 0.3985000 Best vali loss: 0.3985000
	iters: 100, epoch: 2 | loss: 0.6789176
	speed: 0.0126s/iter; left time: 21.4297s
	iters: 200, epoch: 2 | loss: 0.6931348
	speed: 0.0051s/iter; left time: 8.1026s
Updating learning rate to 8.257746047512496e-05
Validation loss decreased (0.3985 --> 0.3784).  Saving model state dict ...
Epoch: 2 cost time: 1.4159040451049805
Epoch: 2, Steps: 257 | Train Loss: 0.6860262 Vali Loss: 0.3784268 Best vali loss: 0.3784268
	iters: 100, epoch: 3 | loss: 0.5699136
	speed: 0.0116s/iter; left time: 16.7672s
	iters: 200, epoch: 3 | loss: 1.1771783
	speed: 0.0055s/iter; left time: 7.4402s
Updating learning rate to 6.688420885211237e-05
Validation loss decreased (0.3784 --> 0.3704).  Saving model state dict ...
Epoch: 3 cost time: 1.3999946117401123
Epoch: 3, Steps: 257 | Train Loss: 0.8735459 Vali Loss: 0.3703665 Best vali loss: 0.3703665
	iters: 100, epoch: 4 | loss: 0.8465848
	speed: 0.0092s/iter; left time: 10.8544s
	iters: 200, epoch: 4 | loss: 0.3325431
	speed: 0.0043s/iter; left time: 4.6814s
Updating learning rate to 4.83727564e-05
Validation loss decreased (0.3704 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 1.1579687595367432
Epoch: 4, Steps: 257 | Train Loss: 0.5895639 Vali Loss: 0.3677603 Best vali loss: 0.3677603
	iters: 100, epoch: 5 | loss: 0.7951797
	speed: 0.0125s/iter; left time: 11.5678s
	iters: 200, epoch: 5 | loss: 0.5031798
	speed: 0.0051s/iter; left time: 4.2469s
Updating learning rate to 2.986130394788764e-05
Validation loss decreased (0.3678 --> 0.3665).  Saving model state dict ...
Epoch: 5 cost time: 1.4211349487304688
Epoch: 5, Steps: 257 | Train Loss: 0.6491798 Vali Loss: 0.3664910 Best vali loss: 0.3664910
	iters: 100, epoch: 6 | loss: 0.6448761
	speed: 0.0123s/iter; left time: 8.2360s
	iters: 200, epoch: 6 | loss: 0.8369879
	speed: 0.0053s/iter; left time: 3.0116s
Updating learning rate to 1.4168052324875036e-05
Validation loss decreased (0.3665 --> 0.3662).  Saving model state dict ...
Epoch: 6 cost time: 1.4617271423339844
Epoch: 6, Steps: 257 | Train Loss: 0.7409320 Vali Loss: 0.3661825 Best vali loss: 0.3661825
	iters: 100, epoch: 7 | loss: 0.6351355
	speed: 0.0121s/iter; left time: 5.0156s
	iters: 200, epoch: 7 | loss: 0.6567860
	speed: 0.0051s/iter; left time: 1.6130s
Updating learning rate to 3.682156830885646e-06
Validation loss decreased (0.3662 --> 0.3660).  Saving model state dict ...
Epoch: 7 cost time: 1.3759489059448242
Epoch: 7, Steps: 257 | Train Loss: 0.6459608 Vali Loss: 0.3660374 Best vali loss: 0.3660374
	iters: 100, epoch: 8 | loss: 0.7207243
	speed: 0.0122s/iter; left time: 1.9245s
	iters: 200, epoch: 8 | loss: 0.5650294
	speed: 0.0048s/iter; left time: 0.2758s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3864483833312988
Epoch: 8, Steps: 257 | Train Loss: 0.6428769 Vali Loss: 0.3660429 Best vali loss: 0.3660374

best validation loss 0.36603736923110974

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7349434
	speed: 0.0106s/iter; left time: 20.6822s
	iters: 200, epoch: 1 | loss: 0.5414647
	speed: 0.0055s/iter; left time: 10.2740s
Updating learning rate to 0.000288581929876693
Validation loss decreased (inf --> 0.3641).  Saving model state dict ...
Epoch: 1 cost time: 1.6378889083862305
Epoch: 1, Steps: 257 | Train Loss: 0.6382041 Vali Loss: 0.3640932 Best vali loss: 0.3640932
	iters: 100, epoch: 2 | loss: 0.8206618
	speed: 0.0119s/iter; left time: 20.3005s
	iters: 200, epoch: 2 | loss: 0.7026503
	speed: 0.0055s/iter; left time: 8.7924s
Updating learning rate to 0.00025606601717798207
Epoch: 2 cost time: 1.4039225578308105
Epoch: 2, Steps: 257 | Train Loss: 0.7616560 Vali Loss: 0.3675566 Best vali loss: 0.3640932
	iters: 100, epoch: 3 | loss: 0.6763277
	speed: 0.0113s/iter; left time: 16.3688s
	iters: 200, epoch: 3 | loss: 0.5287841
	speed: 0.0033s/iter; left time: 4.4057s
Updating learning rate to 0.00020740251485476345
Epoch: 3 cost time: 1.0578010082244873
Epoch: 3, Steps: 257 | Train Loss: 0.6025559 Vali Loss: 0.3737374 Best vali loss: 0.3640932

best validation loss 0.36409320873455353

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.003415295389, 'e_layers': 1, 'learning_rate': 0.0001528244414, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6072022
	speed: 0.0098s/iter; left time: 19.2657s
	iters: 200, epoch: 1 | loss: 1.0671557
	speed: 0.0038s/iter; left time: 7.1417s
Updating learning rate to 0.00014700790743846527
Validation loss decreased (inf --> 0.3863).  Saving model state dict ...
Epoch: 1 cost time: 1.3057031631469727
Epoch: 1, Steps: 257 | Train Loss: 0.8371790 Vali Loss: 0.3863027 Best vali loss: 0.3863027
	iters: 100, epoch: 2 | loss: 0.7059171
	speed: 0.0100s/iter; left time: 17.0843s
	iters: 200, epoch: 2 | loss: 1.1512679
	speed: 0.0039s/iter; left time: 6.2148s
Updating learning rate to 0.00013044382012249305
Validation loss decreased (0.3863 --> 0.3701).  Saving model state dict ...
Epoch: 2 cost time: 1.1077415943145752
Epoch: 2, Steps: 257 | Train Loss: 0.9285925 Vali Loss: 0.3700970 Best vali loss: 0.3700970
	iters: 100, epoch: 3 | loss: 0.5278855
	speed: 0.0098s/iter; left time: 14.1989s
	iters: 200, epoch: 3 | loss: 0.7688512
	speed: 0.0038s/iter; left time: 5.1410s
Updating learning rate to 0.00010565391159211477
Validation loss decreased (0.3701 --> 0.3661).  Saving model state dict ...
Epoch: 3 cost time: 1.0327091217041016
Epoch: 3, Steps: 257 | Train Loss: 0.6483683 Vali Loss: 0.3661266 Best vali loss: 0.3661266

best validation loss 0.3661265787827711

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0025198955415, 'e_layers': 1, 'learning_rate': 0.0003060628921, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5904772
	speed: 0.0087s/iter; left time: 17.0399s
	iters: 200, epoch: 1 | loss: 0.3857789
	speed: 0.0027s/iter; left time: 4.9971s
Updating learning rate to 0.0002944140668862002
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 1.0408766269683838
Epoch: 1, Steps: 257 | Train Loss: 0.4881281 Vali Loss: 0.3715341 Best vali loss: 0.3715341
	iters: 100, epoch: 2 | loss: 0.6773683
	speed: 0.0102s/iter; left time: 17.3923s
	iters: 200, epoch: 2 | loss: 0.3817992
	speed: 0.0041s/iter; left time: 6.5975s
Updating learning rate to 0.0002612410192867383
Validation loss decreased (0.3715 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 1.1186399459838867
Epoch: 2, Steps: 257 | Train Loss: 0.5295837 Vali Loss: 0.3662871 Best vali loss: 0.3662871
	iters: 100, epoch: 3 | loss: 0.5140209
	speed: 0.0101s/iter; left time: 14.5046s
	iters: 200, epoch: 3 | loss: 0.7603600
	speed: 0.0040s/iter; left time: 5.3258s
Updating learning rate to 0.00021159404508420707
Epoch: 3 cost time: 1.0688934326171875
Epoch: 3, Steps: 257 | Train Loss: 0.6371904 Vali Loss: 0.3671664 Best vali loss: 0.3662871

best validation loss 0.36628713572657645

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0031, 'e_layers': 2, 'learning_rate': 0.0003, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6798530
	speed: 0.0092s/iter; left time: 10.8645s
	iters: 200, epoch: 4 | loss: 0.5184565
	speed: 0.0037s/iter; left time: 4.0089s
Updating learning rate to 0.00015
Epoch: 4 cost time: 1.2821018695831299
Epoch: 4, Steps: 257 | Train Loss: 0.5991547 Vali Loss: 0.3688171 Best vali loss: 0.3640932
	iters: 100, epoch: 5 | loss: 0.7690012
	speed: 0.0122s/iter; left time: 11.3447s
	iters: 200, epoch: 5 | loss: 0.6235751
	speed: 0.0050s/iter; left time: 4.1711s
Updating learning rate to 9.259748514523653e-05
Epoch: 5 cost time: 1.389491081237793
Epoch: 5, Steps: 257 | Train Loss: 0.6962882 Vali Loss: 0.3755157 Best vali loss: 0.3640932
	iters: 100, epoch: 6 | loss: 0.6498014
	speed: 0.0121s/iter; left time: 8.1247s
	iters: 200, epoch: 6 | loss: 0.4671838
	speed: 0.0054s/iter; left time: 3.0749s
Updating learning rate to 4.3933982822017876e-05
Epoch: 6 cost time: 1.4231958389282227
Epoch: 6, Steps: 257 | Train Loss: 0.5584926 Vali Loss: 0.3789378 Best vali loss: 0.3640932
	iters: 100, epoch: 7 | loss: 0.4156417
	speed: 0.0115s/iter; left time: 4.7673s
	iters: 200, epoch: 7 | loss: 0.8160785
	speed: 0.0033s/iter; left time: 1.0382s
Updating learning rate to 1.1418070123306989e-05
Epoch: 7 cost time: 1.031445026397705
Epoch: 7, Steps: 257 | Train Loss: 0.6158601 Vali Loss: 0.3766945 Best vali loss: 0.3640932
	iters: 100, epoch: 8 | loss: 0.7763677
	speed: 0.0101s/iter; left time: 1.5972s
	iters: 200, epoch: 8 | loss: 0.6809283
	speed: 0.0053s/iter; left time: 0.3089s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4082603454589844
Epoch: 8, Steps: 257 | Train Loss: 0.7286480 Vali Loss: 0.3775548 Best vali loss: 0.3640932

best validation loss 0.36409320873455353

{'batch_size': 64, 'd_core': 64, 'd_model': 128, 'dropout': 0.0015226276442, 'e_layers': 1, 'learning_rate': 0.0003229925127, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5951786
	speed: 0.0109s/iter; left time: 10.1710s
Updating learning rate to 0.0003229925127
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 0.9123461246490479
Epoch: 1, Steps: 129 | Train Loss: 0.5951786 Vali Loss: 0.3672708 Best vali loss: 0.3672708
	iters: 100, epoch: 2 | loss: 0.4880781
	speed: 0.0093s/iter; left time: 7.4619s
Updating learning rate to 0.00016149625635
Validation loss decreased (0.3673 --> 0.3662).  Saving model state dict ...
Epoch: 2 cost time: 0.7086808681488037
Epoch: 2, Steps: 129 | Train Loss: 0.4880781 Vali Loss: 0.3662097 Best vali loss: 0.3662097
	iters: 100, epoch: 3 | loss: 0.4678021
	speed: 0.0091s/iter; left time: 6.1351s
Updating learning rate to 8.0748128175e-05
Validation loss decreased (0.3662 --> 0.3643).  Saving model state dict ...
Epoch: 3 cost time: 0.6845970153808594
Epoch: 3, Steps: 129 | Train Loss: 0.4678021 Vali Loss: 0.3643183 Best vali loss: 0.3643183
	iters: 100, epoch: 4 | loss: 0.6499844
	speed: 0.0093s/iter; left time: 5.0591s
Updating learning rate to 4.03740640875e-05
Epoch: 4 cost time: 0.6962771415710449
Epoch: 4, Steps: 129 | Train Loss: 0.6499844 Vali Loss: 0.3655651 Best vali loss: 0.3643183
	iters: 100, epoch: 5 | loss: 0.3854736
	speed: 0.0088s/iter; left time: 3.6863s
Updating learning rate to 2.018703204375e-05
Epoch: 5 cost time: 0.6740543842315674
Epoch: 5, Steps: 129 | Train Loss: 0.3854736 Vali Loss: 0.3666846 Best vali loss: 0.3643183
	iters: 100, epoch: 6 | loss: 0.5434546
	speed: 0.0093s/iter; left time: 2.6880s
Updating learning rate to 1.0093516021875e-05
Epoch: 6 cost time: 0.6942975521087646
Epoch: 6, Steps: 129 | Train Loss: 0.5434546 Vali Loss: 0.3668952 Best vali loss: 0.3643183
	iters: 100, epoch: 7 | loss: 0.5313216
	speed: 0.0088s/iter; left time: 1.3914s
Updating learning rate to 5.0467580109375e-06
Epoch: 7 cost time: 0.5786092281341553
Epoch: 7, Steps: 129 | Train Loss: 0.5313216 Vali Loss: 0.3669553 Best vali loss: 0.3643183
	iters: 100, epoch: 8 | loss: 0.5379423
	speed: 0.0063s/iter; left time: 0.1881s
Updating learning rate to 2.52337900546875e-06
Epoch: 8 cost time: 0.46283960342407227
Epoch: 8, Steps: 129 | Train Loss: 0.5379423 Vali Loss: 0.3670683 Best vali loss: 0.3643183

best validation loss 0.36431826334336886

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.0067707384255, 'e_layers': 1, 'learning_rate': 0.0002592776834, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8953633
	speed: 0.0101s/iter; left time: 19.6785s
	iters: 200, epoch: 1 | loss: 0.7460480
	speed: 0.0044s/iter; left time: 8.0948s
Updating learning rate to 0.0002494095141651007
Validation loss decreased (inf --> 0.3759).  Saving model state dict ...
Epoch: 1 cost time: 1.3766412734985352
Epoch: 1, Steps: 257 | Train Loss: 0.8207057 Vali Loss: 0.3759250 Best vali loss: 0.3759250
	iters: 100, epoch: 2 | loss: 0.9649087
	speed: 0.0097s/iter; left time: 16.5431s
	iters: 200, epoch: 2 | loss: 0.8122290
	speed: 0.0044s/iter; left time: 7.0760s
Updating learning rate to 0.00022130734577123935
Validation loss decreased (0.3759 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 1.10379958152771
Epoch: 2, Steps: 257 | Train Loss: 0.8885688 Vali Loss: 0.3647380 Best vali loss: 0.3647380
	iters: 100, epoch: 3 | loss: 0.7347594
	speed: 0.0104s/iter; left time: 15.0064s
	iters: 200, epoch: 3 | loss: 0.8629513
	speed: 0.0040s/iter; left time: 5.3698s
Updating learning rate to 0.00017924947860959052
Validation loss decreased (0.3647 --> 0.3637).  Saving model state dict ...
Epoch: 3 cost time: 1.1206684112548828
Epoch: 3, Steps: 257 | Train Loss: 0.7988553 Vali Loss: 0.3637345 Best vali loss: 0.3637345
	iters: 100, epoch: 4 | loss: 1.0088674
	speed: 0.0103s/iter; left time: 12.2109s
	iters: 200, epoch: 4 | loss: 0.7203203
	speed: 0.0043s/iter; left time: 4.6316s
Updating learning rate to 0.0001296388417
Epoch: 4 cost time: 1.1231880187988281
Epoch: 4, Steps: 257 | Train Loss: 0.8645938 Vali Loss: 0.3690805 Best vali loss: 0.3637345
	iters: 100, epoch: 5 | loss: 0.6846905
	speed: 0.0100s/iter; left time: 9.2630s
	iters: 200, epoch: 5 | loss: 0.5906283
	speed: 0.0043s/iter; left time: 3.5905s
Updating learning rate to 8.002820479040947e-05
Epoch: 5 cost time: 1.1028406620025635
Epoch: 5, Steps: 257 | Train Loss: 0.6376594 Vali Loss: 0.3663488 Best vali loss: 0.3637345
	iters: 100, epoch: 6 | loss: 0.4501784
	speed: 0.0068s/iter; left time: 4.5686s
	iters: 200, epoch: 6 | loss: 0.3836541
	speed: 0.0026s/iter; left time: 1.5077s
Updating learning rate to 3.797033762876063e-05
Epoch: 6 cost time: 0.8350746631622314
Epoch: 6, Steps: 257 | Train Loss: 0.4169163 Vali Loss: 0.3653245 Best vali loss: 0.3637345
	iters: 100, epoch: 7 | loss: 0.6510123
	speed: 0.0103s/iter; left time: 4.2740s
	iters: 200, epoch: 7 | loss: 0.6195042
	speed: 0.0040s/iter; left time: 1.2545s
Updating learning rate to 9.868169234899294e-06
Epoch: 7 cost time: 1.0479674339294434
Epoch: 7, Steps: 257 | Train Loss: 0.6352582 Vali Loss: 0.3664355 Best vali loss: 0.3637345
	iters: 100, epoch: 8 | loss: 0.5413736
	speed: 0.0100s/iter; left time: 1.5760s
	iters: 200, epoch: 8 | loss: 0.4708875
	speed: 0.0040s/iter; left time: 0.2312s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0546057224273682
Epoch: 8, Steps: 257 | Train Loss: 0.5061306 Vali Loss: 0.3661758 Best vali loss: 0.3637345

best validation loss 0.3637345009093669

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7492697
	speed: 0.0109s/iter; left time: 43.6814s
	iters: 200, epoch: 1 | loss: 0.4204173
	speed: 0.0052s/iter; left time: 20.3653s
	iters: 300, epoch: 1 | loss: 0.7004686
	speed: 0.0049s/iter; left time: 18.8016s
	iters: 400, epoch: 1 | loss: 0.3756393
	speed: 0.0053s/iter; left time: 19.8518s
	iters: 500, epoch: 1 | loss: 0.2612102
	speed: 0.0050s/iter; left time: 18.0494s
Updating learning rate to 0.0004342987517734106
Validation loss decreased (inf --> 0.3658).  Saving model state dict ...
Epoch: 1 cost time: 2.9497761726379395
Epoch: 1, Steps: 514 | Train Loss: 0.5014010 Vali Loss: 0.3657533 Best vali loss: 0.3657533
	iters: 100, epoch: 2 | loss: 0.3465199
	speed: 0.0119s/iter; left time: 41.6243s
	iters: 200, epoch: 2 | loss: 0.5708932
	speed: 0.0049s/iter; left time: 16.5973s
	iters: 300, epoch: 2 | loss: 0.7473310
	speed: 0.0049s/iter; left time: 16.1626s
	iters: 400, epoch: 2 | loss: 0.6268926
	speed: 0.0048s/iter; left time: 15.2449s
	iters: 500, epoch: 2 | loss: 0.7632952
	speed: 0.0048s/iter; left time: 14.8570s
Updating learning rate to 0.0003853642245704867
Epoch: 2 cost time: 2.55064058303833
Epoch: 2, Steps: 514 | Train Loss: 0.6109864 Vali Loss: 0.3810264 Best vali loss: 0.3657533
	iters: 100, epoch: 3 | loss: 0.5799393
	speed: 0.0108s/iter; left time: 32.3770s
	iters: 200, epoch: 3 | loss: 0.6754681
	speed: 0.0045s/iter; left time: 13.0643s
	iters: 300, epoch: 3 | loss: 0.7091278
	speed: 0.0036s/iter; left time: 9.9755s
	iters: 400, epoch: 3 | loss: 0.3714782
	speed: 0.0031s/iter; left time: 8.1964s
	iters: 500, epoch: 3 | loss: 0.5163823
	speed: 0.0035s/iter; left time: 9.0569s
Updating learning rate to 0.0003121285291652796
Epoch: 3 cost time: 2.034822463989258
Epoch: 3, Steps: 514 | Train Loss: 0.5704791 Vali Loss: 0.3760401 Best vali loss: 0.3657533

best validation loss 0.3657532825890365

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0034938739476, 'e_layers': 4, 'learning_rate': 0.0001269098969, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001220796765595138
Validation loss decreased (inf --> 0.4048).  Saving model state dict ...
Epoch: 1 cost time: 0.8213098049163818
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4048376 Best vali loss: 0.4048376
Updating learning rate to 0.0001083243727988378
Validation loss decreased (0.4048 --> 0.3882).  Saving model state dict ...
Epoch: 2 cost time: 0.6292839050292969
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3882209 Best vali loss: 0.3882209
Updating learning rate to 8.773810592339583e-05
Validation loss decreased (0.3882 --> 0.3799).  Saving model state dict ...
Epoch: 3 cost time: 0.6122865676879883
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3799201 Best vali loss: 0.3799201

best validation loss 0.3799200625222886

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0017396805512, 'e_layers': 3, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.4107).  Saving model state dict ...
Epoch: 1 cost time: 0.7852954864501953
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4107131 Best vali loss: 0.4107131
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.4107 --> 0.3889).  Saving model state dict ...
Epoch: 2 cost time: 0.539360523223877
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3889444 Best vali loss: 0.3889444
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.3889 --> 0.3825).  Saving model state dict ...
Epoch: 3 cost time: 0.5113651752471924
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3825462 Best vali loss: 0.3825462

best validation loss 0.3825462269993803

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010818463433, 'e_layers': 2, 'learning_rate': 0.0004514822726, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6707391
	speed: 0.0111s/iter; left time: 27.3845s
	iters: 200, epoch: 4 | loss: 0.3271398
	speed: 0.0041s/iter; left time: 9.8044s
	iters: 300, epoch: 4 | loss: 0.5342309
	speed: 0.0035s/iter; left time: 7.8784s
	iters: 400, epoch: 4 | loss: 0.3128597
	speed: 0.0035s/iter; left time: 7.6571s
	iters: 500, epoch: 4 | loss: 0.2585367
	speed: 0.0062s/iter; left time: 12.9329s
Updating learning rate to 0.0002257411363
Validation loss decreased (0.3658 --> 0.3604).  Saving model state dict ...
Epoch: 4 cost time: 2.574446439743042
Epoch: 4, Steps: 514 | Train Loss: 0.4207012 Vali Loss: 0.3604378 Best vali loss: 0.3604378
	iters: 100, epoch: 5 | loss: 0.3341028
	speed: 0.0112s/iter; left time: 21.9173s
	iters: 200, epoch: 5 | loss: 0.4166186
	speed: 0.0059s/iter; left time: 10.9145s
	iters: 300, epoch: 5 | loss: 0.5173410
	speed: 0.0035s/iter; left time: 6.1911s
	iters: 400, epoch: 5 | loss: 0.4668233
	speed: 0.0030s/iter; left time: 5.0395s
	iters: 500, epoch: 5 | loss: 0.5369344
	speed: 0.0034s/iter; left time: 5.2232s
Updating learning rate to 0.00013935374343472043
Validation loss decreased (0.3604 --> 0.3586).  Saving model state dict ...
Epoch: 5 cost time: 2.1751549243927
Epoch: 5, Steps: 514 | Train Loss: 0.4543640 Vali Loss: 0.3585722 Best vali loss: 0.3585722
	iters: 100, epoch: 6 | loss: 0.5070473
	speed: 0.0113s/iter; left time: 16.3396s
	iters: 200, epoch: 6 | loss: 0.6442955
	speed: 0.0051s/iter; left time: 6.8713s
	iters: 300, epoch: 6 | loss: 0.5280617
	speed: 0.0058s/iter; left time: 7.1800s
	iters: 400, epoch: 6 | loss: 0.3429205
	speed: 0.0038s/iter; left time: 4.3183s
	iters: 500, epoch: 6 | loss: 0.4169778
	speed: 0.0032s/iter; left time: 3.3226s
Updating learning rate to 6.611804802951332e-05
Validation loss decreased (0.3586 --> 0.3563).  Saving model state dict ...
Epoch: 6 cost time: 2.387131929397583
Epoch: 6, Steps: 514 | Train Loss: 0.4878606 Vali Loss: 0.3562826 Best vali loss: 0.3562826
	iters: 100, epoch: 7 | loss: 0.2741557
	speed: 0.0094s/iter; left time: 8.7268s
	iters: 200, epoch: 7 | loss: 0.3519589
	speed: 0.0051s/iter; left time: 4.2004s
	iters: 300, epoch: 7 | loss: 0.6580515
	speed: 0.0049s/iter; left time: 3.5472s
	iters: 400, epoch: 7 | loss: 0.5195325
	speed: 0.0049s/iter; left time: 3.0911s
	iters: 500, epoch: 7 | loss: 0.1650182
	speed: 0.0048s/iter; left time: 2.5237s
Updating learning rate to 1.718352082658934e-05
Validation loss decreased (0.3563 --> 0.3528).  Saving model state dict ...
Epoch: 7 cost time: 2.5986173152923584
Epoch: 7, Steps: 514 | Train Loss: 0.3937434 Vali Loss: 0.3527541 Best vali loss: 0.3527541
	iters: 100, epoch: 8 | loss: 0.5262973
	speed: 0.0112s/iter; left time: 4.6590s
	iters: 200, epoch: 8 | loss: 0.1796627
	speed: 0.0049s/iter; left time: 1.5289s
	iters: 300, epoch: 8 | loss: 0.3443270
	speed: 0.0049s/iter; left time: 1.0457s
	iters: 400, epoch: 8 | loss: 0.5244073
	speed: 0.0052s/iter; left time: 0.5983s
	iters: 500, epoch: 8 | loss: 0.7307616
	speed: 0.0047s/iter; left time: 0.0707s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.5763087272644043
Epoch: 8, Steps: 514 | Train Loss: 0.4610912 Vali Loss: 0.3575552 Best vali loss: 0.3527541

best validation loss 0.3527540804360845

{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066334976282, 'e_layers': 4, 'learning_rate': 0.0046791286395, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9466968
	speed: 0.0125s/iter; left time: 50.2462s
	iters: 200, epoch: 1 | loss: 0.8531853
	speed: 0.0063s/iter; left time: 24.5903s
	iters: 300, epoch: 1 | loss: 0.7590112
	speed: 0.0065s/iter; left time: 24.7263s
	iters: 400, epoch: 1 | loss: 0.7346308
	speed: 0.0065s/iter; left time: 24.2944s
	iters: 500, epoch: 1 | loss: 0.6543547
	speed: 0.0065s/iter; left time: 23.6650s
Updating learning rate to 0.0046791286395
Validation loss decreased (inf --> 0.4070).  Saving model state dict ...
Epoch: 1 cost time: 3.615140199661255
Epoch: 1, Steps: 514 | Train Loss: 0.7895757 Vali Loss: 0.4069606 Best vali loss: 0.4069606
	iters: 100, epoch: 2 | loss: 0.6407194
	speed: 0.0139s/iter; left time: 48.6897s
	iters: 200, epoch: 2 | loss: 0.6849310
	speed: 0.0063s/iter; left time: 21.4858s
	iters: 300, epoch: 2 | loss: 0.2859498
	speed: 0.0063s/iter; left time: 20.6470s
	iters: 400, epoch: 2 | loss: 0.3578503
	speed: 0.0065s/iter; left time: 20.6491s
	iters: 500, epoch: 2 | loss: 0.5434110
	speed: 0.0055s/iter; left time: 17.0080s
Updating learning rate to 0.00233956431975
Validation loss decreased (0.4070 --> 0.3966).  Saving model state dict ...
Epoch: 2 cost time: 3.218519926071167
Epoch: 2, Steps: 514 | Train Loss: 0.5025723 Vali Loss: 0.3966425 Best vali loss: 0.3966425
	iters: 100, epoch: 3 | loss: 0.7673842
	speed: 0.0101s/iter; left time: 30.1943s
	iters: 200, epoch: 3 | loss: 0.7922943
	speed: 0.0068s/iter; left time: 19.4987s
	iters: 300, epoch: 3 | loss: 0.7268787
	speed: 0.0069s/iter; left time: 19.1889s
	iters: 400, epoch: 3 | loss: 0.3293061
	speed: 0.0070s/iter; left time: 18.8530s
	iters: 500, epoch: 3 | loss: 0.6697615
	speed: 0.0071s/iter; left time: 18.3277s
Updating learning rate to 0.001169782159875
Epoch: 3 cost time: 3.419649600982666
Epoch: 3, Steps: 514 | Train Loss: 0.6571250 Vali Loss: 0.4035459 Best vali loss: 0.3966425
	iters: 100, epoch: 4 | loss: 0.8915856
	speed: 0.0131s/iter; left time: 32.4616s
	iters: 200, epoch: 4 | loss: 0.4080416
	speed: 0.0069s/iter; left time: 16.2655s
	iters: 300, epoch: 4 | loss: 0.4747235
	speed: 0.0070s/iter; left time: 15.7997s
	iters: 400, epoch: 4 | loss: 1.0551227
	speed: 0.0071s/iter; left time: 15.3868s
	iters: 500, epoch: 4 | loss: 0.7618088
	speed: 0.0071s/iter; left time: 14.7885s
Updating learning rate to 0.0005848910799375
Epoch: 4 cost time: 3.6093437671661377
Epoch: 4, Steps: 514 | Train Loss: 0.7182564 Vali Loss: 0.4023451 Best vali loss: 0.3966425
	iters: 100, epoch: 5 | loss: 1.4845526
	speed: 0.0133s/iter; left time: 26.0686s
	iters: 200, epoch: 5 | loss: 1.1102334
	speed: 0.0070s/iter; left time: 12.9122s
	iters: 300, epoch: 5 | loss: 0.6098593
	speed: 0.0069s/iter; left time: 12.1869s
	iters: 400, epoch: 5 | loss: 0.7046939
	speed: 0.0071s/iter; left time: 11.7579s
	iters: 500, epoch: 5 | loss: 0.7481702
	speed: 0.0070s/iter; left time: 10.9289s
Updating learning rate to 0.00029244553996875
Epoch: 5 cost time: 3.6067519187927246
Epoch: 5, Steps: 514 | Train Loss: 0.9315019 Vali Loss: 0.4026802 Best vali loss: 0.3966425
	iters: 100, epoch: 6 | loss: 1.2013323
	speed: 0.0135s/iter; left time: 19.4098s
	iters: 200, epoch: 6 | loss: 0.6699765
	speed: 0.0070s/iter; left time: 9.3907s
	iters: 300, epoch: 6 | loss: 0.7213691
	speed: 0.0071s/iter; left time: 8.7776s
	iters: 400, epoch: 6 | loss: 0.7762992
	speed: 0.0071s/iter; left time: 8.1213s
	iters: 500, epoch: 6 | loss: 0.7950978
	speed: 0.0071s/iter; left time: 7.4568s
Updating learning rate to 0.000146222769984375
Epoch: 6 cost time: 3.662332534790039
Epoch: 6, Steps: 514 | Train Loss: 0.8328150 Vali Loss: 0.4031962 Best vali loss: 0.3966425
	iters: 100, epoch: 7 | loss: 0.5928999
	speed: 0.0136s/iter; left time: 12.6441s
	iters: 200, epoch: 7 | loss: 0.8970768
	speed: 0.0070s/iter; left time: 5.7789s
	iters: 300, epoch: 7 | loss: 0.5549456
	speed: 0.0070s/iter; left time: 5.1049s
	iters: 400, epoch: 7 | loss: 0.8008002
	speed: 0.0070s/iter; left time: 4.4302s
	iters: 500, epoch: 7 | loss: 0.6834296
	speed: 0.0069s/iter; left time: 3.6263s
Updating learning rate to 7.31113849921875e-05
Epoch: 7 cost time: 3.640199899673462
Epoch: 7, Steps: 514 | Train Loss: 0.7058304 Vali Loss: 0.4034228 Best vali loss: 0.3966425
	iters: 100, epoch: 8 | loss: 0.3844281
	speed: 0.0141s/iter; left time: 5.8486s
	iters: 200, epoch: 8 | loss: 0.4920694
	speed: 0.0066s/iter; left time: 2.0912s
	iters: 300, epoch: 8 | loss: 0.7549433
	speed: 0.0069s/iter; left time: 1.4878s
	iters: 400, epoch: 8 | loss: 0.8980520
	speed: 0.0070s/iter; left time: 0.8035s
	iters: 500, epoch: 8 | loss: 1.0035880
	speed: 0.0067s/iter; left time: 0.1000s
Updating learning rate to 3.655569249609375e-05
Epoch: 8 cost time: 3.593203067779541
Epoch: 8, Steps: 514 | Train Loss: 0.7066162 Vali Loss: 0.4033839 Best vali loss: 0.3966425

best validation loss 0.3966424567994528

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3359253
	speed: 0.0119s/iter; left time: 96.5966s
	iters: 200, epoch: 1 | loss: 0.2637391
	speed: 0.0055s/iter; left time: 44.2624s
	iters: 300, epoch: 1 | loss: 0.7583610
	speed: 0.0055s/iter; left time: 43.4491s
	iters: 400, epoch: 1 | loss: 0.2342337
	speed: 0.0050s/iter; left time: 39.2770s
	iters: 500, epoch: 1 | loss: 1.5972472
	speed: 0.0051s/iter; left time: 39.3887s
	iters: 600, epoch: 1 | loss: 1.7476007
	speed: 0.0054s/iter; left time: 41.0631s
	iters: 700, epoch: 1 | loss: 0.5536750
	speed: 0.0054s/iter; left time: 40.6338s
	iters: 800, epoch: 1 | loss: 1.1995357
	speed: 0.0055s/iter; left time: 40.7671s
	iters: 900, epoch: 1 | loss: 0.3858291
	speed: 0.0056s/iter; left time: 40.6317s
	iters: 1000, epoch: 1 | loss: 1.1565243
	speed: 0.0055s/iter; left time: 39.5395s
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.3714).  Saving model state dict ...
Epoch: 1 cost time: 5.842036962509155
Epoch: 1, Steps: 1027 | Train Loss: 0.8232671 Vali Loss: 0.3713800 Best vali loss: 0.3713800
	iters: 100, epoch: 2 | loss: 0.7931815
	speed: 0.0125s/iter; left time: 88.6209s
	iters: 200, epoch: 2 | loss: 1.2927023
	speed: 0.0050s/iter; left time: 35.2392s
	iters: 300, epoch: 2 | loss: 0.7863742
	speed: 0.0051s/iter; left time: 35.1616s
	iters: 400, epoch: 2 | loss: 0.4601776
	speed: 0.0052s/iter; left time: 35.1000s
	iters: 500, epoch: 2 | loss: 0.4305618
	speed: 0.0050s/iter; left time: 33.6292s
	iters: 600, epoch: 2 | loss: 0.3212339
	speed: 0.0051s/iter; left time: 33.8554s
	iters: 700, epoch: 2 | loss: 0.6937251
	speed: 0.0051s/iter; left time: 33.2462s
	iters: 800, epoch: 2 | loss: 0.3412859
	speed: 0.0051s/iter; left time: 32.4128s
	iters: 900, epoch: 2 | loss: 0.3071663
	speed: 0.0050s/iter; left time: 31.5212s
	iters: 1000, epoch: 2 | loss: 0.8850111
	speed: 0.0051s/iter; left time: 31.6350s
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.3714 --> 0.3712).  Saving model state dict ...
Epoch: 2 cost time: 5.1706013679504395
Epoch: 2, Steps: 1027 | Train Loss: 0.6311420 Vali Loss: 0.3712345 Best vali loss: 0.3712345
	iters: 100, epoch: 3 | loss: 0.2759521
	speed: 0.0146s/iter; left time: 88.3020s
	iters: 200, epoch: 3 | loss: 0.9639207
	speed: 0.0051s/iter; left time: 30.3470s
	iters: 300, epoch: 3 | loss: 0.5223936
	speed: 0.0051s/iter; left time: 29.9904s
	iters: 400, epoch: 3 | loss: 1.1038060
	speed: 0.0051s/iter; left time: 29.4881s
	iters: 500, epoch: 3 | loss: 0.5537927
	speed: 0.0052s/iter; left time: 29.4221s
	iters: 600, epoch: 3 | loss: 1.0523599
	speed: 0.0052s/iter; left time: 28.8529s
	iters: 700, epoch: 3 | loss: 0.7313658
	speed: 0.0052s/iter; left time: 28.1863s
	iters: 800, epoch: 3 | loss: 0.9057928
	speed: 0.0051s/iter; left time: 27.4285s
	iters: 900, epoch: 3 | loss: 0.3727795
	speed: 0.0051s/iter; left time: 26.9424s
	iters: 1000, epoch: 3 | loss: 0.6621665
	speed: 0.0051s/iter; left time: 26.4106s
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.3712 --> 0.3711).  Saving model state dict ...
Epoch: 3 cost time: 5.29388689994812
Epoch: 3, Steps: 1027 | Train Loss: 0.7144330 Vali Loss: 0.3711142 Best vali loss: 0.3711142
	iters: 100, epoch: 4 | loss: 0.3846883
	speed: 0.0146s/iter; left time: 73.6757s
	iters: 200, epoch: 4 | loss: 0.3221569
	speed: 0.0051s/iter; left time: 25.2890s
	iters: 300, epoch: 4 | loss: 0.7681015
	speed: 0.0051s/iter; left time: 24.8386s
	iters: 400, epoch: 4 | loss: 0.2346766
	speed: 0.0051s/iter; left time: 24.2384s
	iters: 500, epoch: 4 | loss: 0.2739178
	speed: 0.0052s/iter; left time: 23.8831s
	iters: 600, epoch: 4 | loss: 0.2797423
	speed: 0.0051s/iter; left time: 23.0919s
	iters: 700, epoch: 4 | loss: 0.3468939
	speed: 0.0051s/iter; left time: 22.8276s
	iters: 800, epoch: 4 | loss: 0.5774752
	speed: 0.0050s/iter; left time: 21.7032s
	iters: 900, epoch: 4 | loss: 1.1892624
	speed: 0.0050s/iter; left time: 21.1913s
	iters: 1000, epoch: 4 | loss: 0.3259149
	speed: 0.0048s/iter; left time: 19.9091s
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 5.266472816467285
Epoch: 4, Steps: 1027 | Train Loss: 0.4702830 Vali Loss: 0.3780904 Best vali loss: 0.3711142
	iters: 100, epoch: 5 | loss: 0.5243574
	speed: 0.0149s/iter; left time: 59.6139s
	iters: 200, epoch: 5 | loss: 0.3494269
	speed: 0.0052s/iter; left time: 20.2157s
	iters: 300, epoch: 5 | loss: 0.5136471
	speed: 0.0052s/iter; left time: 19.9161s
	iters: 400, epoch: 5 | loss: 0.2554170
	speed: 0.0052s/iter; left time: 19.2856s
	iters: 500, epoch: 5 | loss: 0.5504426
	speed: 0.0054s/iter; left time: 19.4661s
	iters: 600, epoch: 5 | loss: 0.3146583
	speed: 0.0057s/iter; left time: 20.0643s
	iters: 700, epoch: 5 | loss: 0.7197808
	speed: 0.0052s/iter; left time: 17.6948s
	iters: 800, epoch: 5 | loss: 1.0407227
	speed: 0.0052s/iter; left time: 17.0499s
	iters: 900, epoch: 5 | loss: 0.2263395
	speed: 0.0050s/iter; left time: 16.0024s
	iters: 1000, epoch: 5 | loss: 0.4007106
	speed: 0.0048s/iter; left time: 15.0746s
Updating learning rate to 9.118741539478246e-05
Epoch: 5 cost time: 5.392066240310669
Epoch: 5, Steps: 1027 | Train Loss: 0.4895503 Vali Loss: 0.3748880 Best vali loss: 0.3711142
	iters: 100, epoch: 6 | loss: 0.3765850
	speed: 0.0149s/iter; left time: 44.5498s
	iters: 200, epoch: 6 | loss: 1.0811185
	speed: 0.0055s/iter; left time: 15.7647s
	iters: 300, epoch: 6 | loss: 0.2266364
	speed: 0.0054s/iter; left time: 15.1217s
	iters: 400, epoch: 6 | loss: 0.2574313
	speed: 0.0052s/iter; left time: 14.0252s
	iters: 500, epoch: 6 | loss: 0.2282992
	speed: 0.0053s/iter; left time: 13.7725s
	iters: 600, epoch: 6 | loss: 0.1657450
	speed: 0.0054s/iter; left time: 13.3334s
	iters: 700, epoch: 6 | loss: 1.0131493
	speed: 0.0054s/iter; left time: 12.9225s
	iters: 800, epoch: 6 | loss: 0.4132664
	speed: 0.0054s/iter; left time: 12.3278s
	iters: 900, epoch: 6 | loss: 0.4797623
	speed: 0.0049s/iter; left time: 10.7514s
	iters: 1000, epoch: 6 | loss: 0.3020473
	speed: 0.0052s/iter; left time: 10.8479s
Updating learning rate to 4.326495838688198e-05
Validation loss decreased (0.3711 --> 0.3683).  Saving model state dict ...
Epoch: 6 cost time: 5.521883726119995
Epoch: 6, Steps: 1027 | Train Loss: 0.4544041 Vali Loss: 0.3683267 Best vali loss: 0.3683267
	iters: 100, epoch: 7 | loss: 0.3906863
	speed: 0.0149s/iter; left time: 29.0685s
	iters: 200, epoch: 7 | loss: 0.5738267
	speed: 0.0054s/iter; left time: 10.1031s
	iters: 300, epoch: 7 | loss: 0.3541312
	speed: 0.0054s/iter; left time: 9.5312s
	iters: 400, epoch: 7 | loss: 0.4164055
	speed: 0.0056s/iter; left time: 9.3179s
	iters: 500, epoch: 7 | loss: 0.3212240
	speed: 0.0056s/iter; left time: 8.7684s
	iters: 600, epoch: 7 | loss: 0.5143864
	speed: 0.0055s/iter; left time: 7.9620s
	iters: 700, epoch: 7 | loss: 0.5073230
	speed: 0.0054s/iter; left time: 7.3725s
	iters: 800, epoch: 7 | loss: 0.9657471
	speed: 0.0056s/iter; left time: 7.0631s
	iters: 900, epoch: 7 | loss: 0.5057395
	speed: 0.0055s/iter; left time: 6.3503s
	iters: 1000, epoch: 7 | loss: 0.3031576
	speed: 0.0052s/iter; left time: 5.5144s
Updating learning rate to 1.124419633759687e-05
Validation loss decreased (0.3683 --> 0.3680).  Saving model state dict ...
Epoch: 7 cost time: 5.667050361633301
Epoch: 7, Steps: 1027 | Train Loss: 0.4852627 Vali Loss: 0.3680330 Best vali loss: 0.3680330
	iters: 100, epoch: 8 | loss: 0.3542370
	speed: 0.0152s/iter; left time: 14.0755s
	iters: 200, epoch: 8 | loss: 0.4519818
	speed: 0.0051s/iter; left time: 4.2154s
	iters: 300, epoch: 8 | loss: 0.3221388
	speed: 0.0051s/iter; left time: 3.7446s
	iters: 400, epoch: 8 | loss: 0.3274554
	speed: 0.0050s/iter; left time: 3.1623s
	iters: 500, epoch: 8 | loss: 0.4060865
	speed: 0.0051s/iter; left time: 2.6972s
	iters: 600, epoch: 8 | loss: 1.0337244
	speed: 0.0050s/iter; left time: 2.1554s
	iters: 700, epoch: 8 | loss: 0.7719012
	speed: 0.0048s/iter; left time: 1.5763s
	iters: 800, epoch: 8 | loss: 0.3024639
	speed: 0.0047s/iter; left time: 1.0673s
	iters: 900, epoch: 8 | loss: 0.8241445
	speed: 0.0050s/iter; left time: 0.6436s
	iters: 1000, epoch: 8 | loss: 0.5217251
	speed: 0.0050s/iter; left time: 0.1411s
Updating learning rate to 0.0
Validation loss decreased (0.3680 --> 0.3680).  Saving model state dict ...
Epoch: 8 cost time: 5.191608190536499
Epoch: 8, Steps: 1027 | Train Loss: 0.5315859 Vali Loss: 0.3679900 Best vali loss: 0.3679900

best validation loss 0.36799003255859103

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022460234567, 'e_layers': 3, 'learning_rate': 0.0002238773545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1830410
	speed: 0.0110s/iter; left time: 89.4239s
	iters: 200, epoch: 1 | loss: 0.4788970
	speed: 0.0054s/iter; left time: 43.4686s
	iters: 300, epoch: 1 | loss: 0.9051102
	speed: 0.0054s/iter; left time: 42.5755s
	iters: 400, epoch: 1 | loss: 0.2260150
	speed: 0.0050s/iter; left time: 38.9725s
	iters: 500, epoch: 1 | loss: 1.0089570
	speed: 0.0051s/iter; left time: 39.3983s
	iters: 600, epoch: 1 | loss: 0.7340312
	speed: 0.0040s/iter; left time: 30.7309s
	iters: 700, epoch: 1 | loss: 0.2886888
	speed: 0.0040s/iter; left time: 30.3988s
	iters: 800, epoch: 1 | loss: 0.6004286
	speed: 0.0056s/iter; left time: 41.1911s
	iters: 900, epoch: 1 | loss: 1.2213217
	speed: 0.0055s/iter; left time: 40.1226s
	iters: 1000, epoch: 1 | loss: 0.3414646
	speed: 0.0056s/iter; left time: 40.1339s
Updating learning rate to 0.0002238773545
Validation loss decreased (inf --> 0.3689).  Saving model state dict ...
Epoch: 1 cost time: 5.535092115402222
Epoch: 1, Steps: 1027 | Train Loss: 0.6987955 Vali Loss: 0.3688740 Best vali loss: 0.3688740
	iters: 100, epoch: 2 | loss: 0.2369489
	speed: 0.0163s/iter; left time: 115.4085s
	iters: 200, epoch: 2 | loss: 0.3883204
	speed: 0.0056s/iter; left time: 39.4801s
	iters: 300, epoch: 2 | loss: 0.8220050
	speed: 0.0054s/iter; left time: 37.1489s
	iters: 400, epoch: 2 | loss: 0.8894718
	speed: 0.0057s/iter; left time: 38.5862s
	iters: 500, epoch: 2 | loss: 1.2281299
	speed: 0.0052s/iter; left time: 34.7784s
	iters: 600, epoch: 2 | loss: 0.3074900
	speed: 0.0048s/iter; left time: 31.4552s
	iters: 700, epoch: 2 | loss: 0.4131807
	speed: 0.0056s/iter; left time: 36.6492s
	iters: 800, epoch: 2 | loss: 0.8446737
	speed: 0.0054s/iter; left time: 34.4409s
	iters: 900, epoch: 2 | loss: 0.3978674
	speed: 0.0057s/iter; left time: 36.0474s
	iters: 1000, epoch: 2 | loss: 0.6994373
	speed: 0.0056s/iter; left time: 34.6918s
Updating learning rate to 0.00011193867725
Epoch: 2 cost time: 5.647945404052734
Epoch: 2, Steps: 1027 | Train Loss: 0.6227525 Vali Loss: 0.3833177 Best vali loss: 0.3688740
	iters: 100, epoch: 3 | loss: 0.3675559
	speed: 0.0167s/iter; left time: 101.1325s
	iters: 200, epoch: 3 | loss: 1.0189383
	speed: 0.0055s/iter; left time: 33.0495s
	iters: 300, epoch: 3 | loss: 0.1984944
	speed: 0.0057s/iter; left time: 33.3920s
	iters: 400, epoch: 3 | loss: 0.2307303
	speed: 0.0052s/iter; left time: 30.0174s
	iters: 500, epoch: 3 | loss: 0.2531247
	speed: 0.0050s/iter; left time: 28.4244s
	iters: 600, epoch: 3 | loss: 0.7125925
	speed: 0.0053s/iter; left time: 29.3710s
	iters: 700, epoch: 3 | loss: 0.8811259
	speed: 0.0056s/iter; left time: 30.4178s
	iters: 800, epoch: 3 | loss: 0.3691771
	speed: 0.0056s/iter; left time: 30.0465s
	iters: 900, epoch: 3 | loss: 0.2584549
	speed: 0.0056s/iter; left time: 29.3950s
	iters: 1000, epoch: 3 | loss: 0.4177517
	speed: 0.0055s/iter; left time: 28.5036s
Updating learning rate to 5.5969338625e-05
Validation loss decreased (0.3689 --> 0.3609).  Saving model state dict ...
Epoch: 3 cost time: 5.683862209320068
Epoch: 3, Steps: 1027 | Train Loss: 0.4707946 Vali Loss: 0.3608709 Best vali loss: 0.3608709

best validation loss 0.3608709428774116

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0053842784557, 'e_layers': 2, 'learning_rate': 0.0021053293838, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0020252000553437097
Validation loss decreased (inf --> 0.3842).  Saving model state dict ...
Epoch: 1 cost time: 0.7259318828582764
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3841924 Best vali loss: 0.3841924
Updating learning rate to 0.0017970110338581377
Validation loss decreased (0.3842 --> 0.3780).  Saving model state dict ...
Epoch: 2 cost time: 0.5809392929077148
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3779643 Best vali loss: 0.3779643
Updating learning rate to 0.0014555020293258317
Epoch: 3 cost time: 0.35267186164855957
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3848650 Best vali loss: 0.3779643

best validation loss 0.37796426791339116

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 4, 'learning_rate': 5.78505997e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9528903
	speed: 0.0136s/iter; left time: 54.5584s
	iters: 200, epoch: 1 | loss: 0.5176324
	speed: 0.0069s/iter; left time: 26.8574s
	iters: 300, epoch: 1 | loss: 0.6661276
	speed: 0.0053s/iter; left time: 20.3100s
	iters: 400, epoch: 1 | loss: 0.4457914
	speed: 0.0076s/iter; left time: 28.0702s
	iters: 500, epoch: 1 | loss: 0.5193325
	speed: 0.0102s/iter; left time: 36.7662s
Updating learning rate to 5.5648792353166796e-05
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 4.197871208190918
Epoch: 1, Steps: 514 | Train Loss: 0.6203548 Vali Loss: 0.3673310 Best vali loss: 0.3673310
	iters: 100, epoch: 2 | loss: 0.6746230
	speed: 0.0198s/iter; left time: 69.3485s
	iters: 200, epoch: 2 | loss: 0.9721667
	speed: 0.0102s/iter; left time: 34.7051s
	iters: 300, epoch: 2 | loss: 0.3947003
	speed: 0.0087s/iter; left time: 28.5674s
	iters: 400, epoch: 2 | loss: 0.8366187
	speed: 0.0091s/iter; left time: 29.2419s
	iters: 500, epoch: 2 | loss: 0.3408546
	speed: 0.0102s/iter; left time: 31.5448s
Updating learning rate to 4.937857552178923e-05
Epoch: 2 cost time: 5.034996032714844
Epoch: 2, Steps: 514 | Train Loss: 0.6437927 Vali Loss: 0.3700911 Best vali loss: 0.3673310
	iters: 100, epoch: 3 | loss: 0.7034060
	speed: 0.0195s/iter; left time: 58.2384s
	iters: 200, epoch: 3 | loss: 0.3138745
	speed: 0.0103s/iter; left time: 29.5847s
	iters: 300, epoch: 3 | loss: 1.2269568
	speed: 0.0084s/iter; left time: 23.4816s
	iters: 400, epoch: 3 | loss: 0.8059472
	speed: 0.0096s/iter; left time: 25.8242s
	iters: 500, epoch: 3 | loss: 0.2989128
	speed: 0.0102s/iter; left time: 26.4448s
Updating learning rate to 3.999453287878742e-05
Validation loss decreased (0.3673 --> 0.3620).  Saving model state dict ...
Epoch: 3 cost time: 5.064970970153809
Epoch: 3, Steps: 514 | Train Loss: 0.6698195 Vali Loss: 0.3620006 Best vali loss: 0.3620006

best validation loss 0.3620006008560391

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022460234567, 'e_layers': 3, 'learning_rate': 0.0002238773545, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3722698
	speed: 0.0115s/iter; left time: 58.0800s
	iters: 200, epoch: 4 | loss: 0.3833180
	speed: 0.0042s/iter; left time: 20.4942s
	iters: 300, epoch: 4 | loss: 0.8112098
	speed: 0.0037s/iter; left time: 17.9140s
	iters: 400, epoch: 4 | loss: 0.2051625
	speed: 0.0043s/iter; left time: 20.2442s
	iters: 500, epoch: 4 | loss: 0.7876462
	speed: 0.0057s/iter; left time: 26.4888s
	iters: 600, epoch: 4 | loss: 0.4045542
	speed: 0.0057s/iter; left time: 25.6623s
	iters: 700, epoch: 4 | loss: 0.2451929
	speed: 0.0056s/iter; left time: 25.0491s
	iters: 800, epoch: 4 | loss: 0.4271426
	speed: 0.0058s/iter; left time: 24.9531s
	iters: 900, epoch: 4 | loss: 1.0484538
	speed: 0.0056s/iter; left time: 23.8405s
	iters: 1000, epoch: 4 | loss: 0.3426060
	speed: 0.0057s/iter; left time: 23.7495s
Updating learning rate to 2.79846693125e-05
Epoch: 4 cost time: 5.6089630126953125
Epoch: 4, Steps: 1027 | Train Loss: 0.5027556 Vali Loss: 0.3639507 Best vali loss: 0.3608709
	iters: 100, epoch: 5 | loss: 0.2341544
	speed: 0.0166s/iter; left time: 66.6723s
	iters: 200, epoch: 5 | loss: 0.3837253
	speed: 0.0054s/iter; left time: 21.2301s
	iters: 300, epoch: 5 | loss: 0.8269877
	speed: 0.0049s/iter; left time: 18.7296s
	iters: 400, epoch: 5 | loss: 0.8169698
	speed: 0.0055s/iter; left time: 20.3577s
	iters: 500, epoch: 5 | loss: 0.9274410
	speed: 0.0058s/iter; left time: 20.9066s
	iters: 600, epoch: 5 | loss: 0.2172235
	speed: 0.0059s/iter; left time: 20.6379s
	iters: 700, epoch: 5 | loss: 0.3752615
	speed: 0.0062s/iter; left time: 21.0911s
	iters: 800, epoch: 5 | loss: 0.6349342
	speed: 0.0063s/iter; left time: 20.8696s
	iters: 900, epoch: 5 | loss: 0.3346003
	speed: 0.0058s/iter; left time: 18.5973s
	iters: 1000, epoch: 5 | loss: 0.5768319
	speed: 0.0059s/iter; left time: 18.2311s
Updating learning rate to 1.399233465625e-05
Epoch: 5 cost time: 5.942301273345947
Epoch: 5, Steps: 1027 | Train Loss: 0.5328129 Vali Loss: 0.3628354 Best vali loss: 0.3608709
	iters: 100, epoch: 6 | loss: 0.3235663
	speed: 0.0171s/iter; left time: 51.0164s
	iters: 200, epoch: 6 | loss: 0.9541633
	speed: 0.0047s/iter; left time: 13.6714s
	iters: 300, epoch: 6 | loss: 0.2224297
	speed: 0.0049s/iter; left time: 13.7084s
	iters: 400, epoch: 6 | loss: 0.2085309
	speed: 0.0058s/iter; left time: 15.4461s
	iters: 500, epoch: 6 | loss: 0.2196775
	speed: 0.0058s/iter; left time: 14.9354s
	iters: 600, epoch: 6 | loss: 0.6577025
	speed: 0.0058s/iter; left time: 14.3292s
	iters: 700, epoch: 6 | loss: 0.7537424
	speed: 0.0057s/iter; left time: 13.6727s
	iters: 800, epoch: 6 | loss: 0.3617193
	speed: 0.0059s/iter; left time: 13.4409s
	iters: 900, epoch: 6 | loss: 0.2579194
	speed: 0.0058s/iter; left time: 12.6684s
	iters: 1000, epoch: 6 | loss: 0.3947713
	speed: 0.0059s/iter; left time: 12.2458s
Updating learning rate to 6.996167328125e-06
Epoch: 6 cost time: 5.8082780838012695
Epoch: 6, Steps: 1027 | Train Loss: 0.4354223 Vali Loss: 0.3609539 Best vali loss: 0.3608709
	iters: 100, epoch: 7 | loss: 0.2617253
	speed: 0.0161s/iter; left time: 31.4180s
	iters: 200, epoch: 7 | loss: 0.4296173
	speed: 0.0051s/iter; left time: 9.3862s
	iters: 300, epoch: 7 | loss: 0.5112650
	speed: 0.0056s/iter; left time: 9.8020s
	iters: 400, epoch: 7 | loss: 0.4298812
	speed: 0.0058s/iter; left time: 9.5340s
	iters: 500, epoch: 7 | loss: 0.2911353
	speed: 0.0058s/iter; left time: 9.0445s
	iters: 600, epoch: 7 | loss: 0.2638756
	speed: 0.0058s/iter; left time: 8.4494s
	iters: 700, epoch: 7 | loss: 0.5114743
	speed: 0.0057s/iter; left time: 7.7793s
	iters: 800, epoch: 7 | loss: 1.2977335
	speed: 0.0054s/iter; left time: 6.7820s
	iters: 900, epoch: 7 | loss: 0.2518139
	speed: 0.0054s/iter; left time: 6.2167s
	iters: 1000, epoch: 7 | loss: 0.4883312
	speed: 0.0054s/iter; left time: 5.6729s
Updating learning rate to 3.4980836640625e-06
Validation loss decreased (0.3609 --> 0.3580).  Saving model state dict ...
Epoch: 7 cost time: 5.714328050613403
Epoch: 7, Steps: 1027 | Train Loss: 0.4736853 Vali Loss: 0.3579867 Best vali loss: 0.3579867
	iters: 100, epoch: 8 | loss: 0.6567869
	speed: 0.0163s/iter; left time: 15.1259s
	iters: 200, epoch: 8 | loss: 0.4987911
	speed: 0.0056s/iter; left time: 4.6689s
	iters: 300, epoch: 8 | loss: 0.1787576
	speed: 0.0059s/iter; left time: 4.3234s
	iters: 400, epoch: 8 | loss: 0.3106271
	speed: 0.0060s/iter; left time: 3.7523s
	iters: 500, epoch: 8 | loss: 0.3982223
	speed: 0.0061s/iter; left time: 3.2111s
	iters: 600, epoch: 8 | loss: 1.0731089
	speed: 0.0061s/iter; left time: 2.6312s
	iters: 700, epoch: 8 | loss: 1.0427030
	speed: 0.0061s/iter; left time: 2.0053s
	iters: 800, epoch: 8 | loss: 0.2051210
	speed: 0.0062s/iter; left time: 1.4032s
	iters: 900, epoch: 8 | loss: 0.7594878
	speed: 0.0060s/iter; left time: 0.7678s
	iters: 1000, epoch: 8 | loss: 0.4799735
	speed: 0.0065s/iter; left time: 0.1820s
Updating learning rate to 1.74904183203125e-06
Epoch: 8 cost time: 6.2084386348724365
Epoch: 8, Steps: 1027 | Train Loss: 0.5603579 Vali Loss: 0.3633318 Best vali loss: 0.3579867

best validation loss 0.357986721138823

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0039198070782, 'e_layers': 3, 'learning_rate': 9.36341394e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7317333
	speed: 0.0114s/iter; left time: 10.6569s
Updating learning rate to 9.007040216798432e-05
Validation loss decreased (inf --> 0.4217).  Saving model state dict ...
Epoch: 1 cost time: 1.0855913162231445
Epoch: 1, Steps: 129 | Train Loss: 0.7317333 Vali Loss: 0.4217072 Best vali loss: 0.4217072
	iters: 100, epoch: 2 | loss: 0.6711769
	speed: 0.0118s/iter; left time: 9.4974s
Updating learning rate to 7.992173716015324e-05
Validation loss decreased (0.4217 --> 0.4040).  Saving model state dict ...
Epoch: 2 cost time: 0.9522559642791748
Epoch: 2, Steps: 129 | Train Loss: 0.6711769 Vali Loss: 0.4040210 Best vali loss: 0.4040210
	iters: 100, epoch: 3 | loss: 0.6522297
	speed: 0.0118s/iter; left time: 7.9403s
Updating learning rate to 6.473318662607164e-05
Validation loss decreased (0.4040 --> 0.3943).  Saving model state dict ...
Epoch: 3 cost time: 0.9343140125274658
Epoch: 3, Steps: 129 | Train Loss: 0.6522297 Vali Loss: 0.3942943 Best vali loss: 0.3942943
	iters: 100, epoch: 4 | loss: 0.8092270
	speed: 0.0116s/iter; left time: 6.3483s
Updating learning rate to 4.68170697e-05
Validation loss decreased (0.3943 --> 0.3899).  Saving model state dict ...
Epoch: 4 cost time: 0.9349310398101807
Epoch: 4, Steps: 129 | Train Loss: 0.8092270 Vali Loss: 0.3899245 Best vali loss: 0.3899245
	iters: 100, epoch: 5 | loss: 0.5188079
	speed: 0.0120s/iter; left time: 5.0050s
Updating learning rate to 2.8900952773928358e-05
Validation loss decreased (0.3899 --> 0.3867).  Saving model state dict ...
Epoch: 5 cost time: 0.956824541091919
Epoch: 5, Steps: 129 | Train Loss: 0.5188079 Vali Loss: 0.3866541 Best vali loss: 0.3866541
	iters: 100, epoch: 6 | loss: 0.5607310
	speed: 0.0119s/iter; left time: 3.4286s
Updating learning rate to 1.3712402239846759e-05
Validation loss decreased (0.3867 --> 0.3850).  Saving model state dict ...
Epoch: 6 cost time: 0.9551167488098145
Epoch: 6, Steps: 129 | Train Loss: 0.5607310 Vali Loss: 0.3850486 Best vali loss: 0.3850486
	iters: 100, epoch: 7 | loss: 0.5079425
	speed: 0.0118s/iter; left time: 1.8721s
Updating learning rate to 3.5637372320156725e-06
Validation loss decreased (0.3850 --> 0.3844).  Saving model state dict ...
Epoch: 7 cost time: 0.9396615028381348
Epoch: 7, Steps: 129 | Train Loss: 0.5079425 Vali Loss: 0.3844069 Best vali loss: 0.3844069
	iters: 100, epoch: 8 | loss: 0.6140730
	speed: 0.0118s/iter; left time: 0.3534s
Updating learning rate to 0.0
Validation loss decreased (0.3844 --> 0.3843).  Saving model state dict ...
Epoch: 8 cost time: 0.9527890682220459
Epoch: 8, Steps: 129 | Train Loss: 0.6140730 Vali Loss: 0.3842626 Best vali loss: 0.3842626

best validation loss 0.3842626411577573

{'batch_size': 32, 'd_core': 512, 'd_model': 32, 'dropout': 0.007940080013, 'e_layers': 4, 'learning_rate': 0.0005392900295, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4509804
	speed: 0.0121s/iter; left time: 23.6669s
	iters: 200, epoch: 1 | loss: 0.8178029
	speed: 0.0074s/iter; left time: 13.8195s
Updating learning rate to 0.000518764524921229
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 2.101041555404663
Epoch: 1, Steps: 257 | Train Loss: 0.6343917 Vali Loss: 0.3747568 Best vali loss: 0.3747568
	iters: 100, epoch: 2 | loss: 0.4803226
	speed: 0.0153s/iter; left time: 26.0570s
	iters: 200, epoch: 2 | loss: 0.5963035
	speed: 0.0076s/iter; left time: 12.1302s
Updating learning rate to 0.0004603128331928716
Validation loss decreased (0.3748 --> 0.3683).  Saving model state dict ...
Epoch: 2 cost time: 1.9978654384613037
Epoch: 2, Steps: 257 | Train Loss: 0.5383131 Vali Loss: 0.3682616 Best vali loss: 0.3682616
	iters: 100, epoch: 3 | loss: 0.5335751
	speed: 0.0158s/iter; left time: 22.7884s
	iters: 200, epoch: 3 | loss: 0.6315259
	speed: 0.0078s/iter; left time: 10.5313s
Updating learning rate to 0.0003728336945146653
Epoch: 3 cost time: 2.021817207336426
Epoch: 3, Steps: 257 | Train Loss: 0.5825505 Vali Loss: 0.3686457 Best vali loss: 0.3682616
	iters: 100, epoch: 4 | loss: 0.5239743
	speed: 0.0158s/iter; left time: 18.7444s
	iters: 200, epoch: 4 | loss: 0.9038643
	speed: 0.0075s/iter; left time: 8.1605s
Updating learning rate to 0.00026964501475
Epoch: 4 cost time: 1.9710373878479004
Epoch: 4, Steps: 257 | Train Loss: 0.7139193 Vali Loss: 0.3743120 Best vali loss: 0.3682616
	iters: 100, epoch: 5 | loss: 0.5578666
	speed: 0.0158s/iter; left time: 14.7200s
	iters: 200, epoch: 5 | loss: 0.5135294
	speed: 0.0074s/iter; left time: 6.1528s
Updating learning rate to 0.00016645633498533474
Epoch: 5 cost time: 1.954887866973877
Epoch: 5, Steps: 257 | Train Loss: 0.5356980 Vali Loss: 0.3801966 Best vali loss: 0.3682616
	iters: 100, epoch: 6 | loss: 0.3642216
	speed: 0.0156s/iter; left time: 10.4878s
	iters: 200, epoch: 6 | loss: 0.3879181
	speed: 0.0075s/iter; left time: 4.3180s
Updating learning rate to 7.897719630712839e-05
Epoch: 6 cost time: 1.991701364517212
Epoch: 6, Steps: 257 | Train Loss: 0.3760699 Vali Loss: 0.3880189 Best vali loss: 0.3682616
	iters: 100, epoch: 7 | loss: 0.3444994
	speed: 0.0153s/iter; left time: 6.3446s
	iters: 200, epoch: 7 | loss: 0.3333690
	speed: 0.0075s/iter; left time: 2.3494s
Updating learning rate to 2.0525504578770982e-05
Epoch: 7 cost time: 1.9496841430664062
Epoch: 7, Steps: 257 | Train Loss: 0.3389342 Vali Loss: 0.3826846 Best vali loss: 0.3682616
	iters: 100, epoch: 8 | loss: 0.4460739
	speed: 0.0155s/iter; left time: 2.4484s
	iters: 200, epoch: 8 | loss: 0.4876153
	speed: 0.0075s/iter; left time: 0.4349s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.9738719463348389
Epoch: 8, Steps: 257 | Train Loss: 0.4668446 Vali Loss: 0.3852887 Best vali loss: 0.3682616

best validation loss 0.368261592701985

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6842813
	speed: 0.0122s/iter; left time: 99.2465s
	iters: 200, epoch: 1 | loss: 0.3494326
	speed: 0.0064s/iter; left time: 51.5067s
	iters: 300, epoch: 1 | loss: 0.3668417
	speed: 0.0063s/iter; left time: 49.9738s
	iters: 400, epoch: 1 | loss: 0.3873792
	speed: 0.0064s/iter; left time: 49.6450s
	iters: 500, epoch: 1 | loss: 0.3508886
	speed: 0.0063s/iter; left time: 48.6251s
	iters: 600, epoch: 1 | loss: 0.4049290
	speed: 0.0063s/iter; left time: 47.6790s
	iters: 700, epoch: 1 | loss: 0.3563525
	speed: 0.0062s/iter; left time: 46.2854s
	iters: 800, epoch: 1 | loss: 1.1513598
	speed: 0.0063s/iter; left time: 46.3916s
	iters: 900, epoch: 1 | loss: 0.5452130
	speed: 0.0059s/iter; left time: 43.4379s
	iters: 1000, epoch: 1 | loss: 0.4069452
	speed: 0.0055s/iter; left time: 39.4689s
Updating learning rate to 9.479731376954724e-05
Validation loss decreased (inf --> 0.3634).  Saving model state dict ...
Epoch: 1 cost time: 6.655364036560059
Epoch: 1, Steps: 1027 | Train Loss: 0.5003623 Vali Loss: 0.3634180 Best vali loss: 0.3634180
	iters: 100, epoch: 2 | loss: 0.4525690
	speed: 0.0181s/iter; left time: 128.2125s
	iters: 200, epoch: 2 | loss: 1.0798944
	speed: 0.0064s/iter; left time: 44.8823s
	iters: 300, epoch: 2 | loss: 0.2561981
	speed: 0.0064s/iter; left time: 44.3261s
	iters: 400, epoch: 2 | loss: 0.3498881
	speed: 0.0063s/iter; left time: 42.8402s
	iters: 500, epoch: 2 | loss: 0.2620261
	speed: 0.0061s/iter; left time: 40.9708s
	iters: 600, epoch: 2 | loss: 1.2394496
	speed: 0.0062s/iter; left time: 40.5939s
	iters: 700, epoch: 2 | loss: 0.6217131
	speed: 0.0061s/iter; left time: 39.5533s
	iters: 800, epoch: 2 | loss: 0.4802155
	speed: 0.0057s/iter; left time: 36.1217s
	iters: 900, epoch: 2 | loss: 0.4556099
	speed: 0.0051s/iter; left time: 31.8978s
	iters: 1000, epoch: 2 | loss: 0.2389698
	speed: 0.0057s/iter; left time: 35.3991s
Updating learning rate to 8.411604491837567e-05
Validation loss decreased (0.3634 --> 0.3623).  Saving model state dict ...
Epoch: 2 cost time: 6.258000135421753
Epoch: 2, Steps: 1027 | Train Loss: 0.5436534 Vali Loss: 0.3622553 Best vali loss: 0.3622553
	iters: 100, epoch: 3 | loss: 0.3202076
	speed: 0.0181s/iter; left time: 109.5816s
	iters: 200, epoch: 3 | loss: 0.1939354
	speed: 0.0061s/iter; left time: 36.3274s
	iters: 300, epoch: 3 | loss: 0.4485356
	speed: 0.0061s/iter; left time: 35.8847s
	iters: 400, epoch: 3 | loss: 0.3233872
	speed: 0.0061s/iter; left time: 34.9211s
	iters: 500, epoch: 3 | loss: 0.7258892
	speed: 0.0063s/iter; left time: 35.4090s
	iters: 600, epoch: 3 | loss: 0.5237339
	speed: 0.0061s/iter; left time: 33.7694s
	iters: 700, epoch: 3 | loss: 0.2942280
	speed: 0.0059s/iter; left time: 32.3651s
	iters: 800, epoch: 3 | loss: 0.4373726
	speed: 0.0052s/iter; left time: 27.7290s
	iters: 900, epoch: 3 | loss: 0.5677405
	speed: 0.0045s/iter; left time: 23.9162s
	iters: 1000, epoch: 3 | loss: 0.9197145
	speed: 0.0041s/iter; left time: 21.0792s
Updating learning rate to 6.81303964031329e-05
Validation loss decreased (0.3623 --> 0.3531).  Saving model state dict ...
Epoch: 3 cost time: 5.794614315032959
Epoch: 3, Steps: 1027 | Train Loss: 0.4754744 Vali Loss: 0.3530907 Best vali loss: 0.3530907

best validation loss 0.3530907452691983

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0012653404301, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4214004
	speed: 0.0137s/iter; left time: 26.8564s
	iters: 200, epoch: 1 | loss: 0.5844068
	speed: 0.0080s/iter; left time: 14.8818s
Updating learning rate to 0.0005385115939239891
Validation loss decreased (inf --> 0.3719).  Saving model state dict ...
Epoch: 1 cost time: 2.360321283340454
Epoch: 1, Steps: 257 | Train Loss: 0.5029036 Vali Loss: 0.3719288 Best vali loss: 0.3719288
	iters: 100, epoch: 2 | loss: 0.8377767
	speed: 0.0161s/iter; left time: 27.4012s
	iters: 200, epoch: 2 | loss: 0.6134982
	speed: 0.0079s/iter; left time: 12.6212s
Updating learning rate to 0.0004778349050448276
Epoch: 2 cost time: 2.044252872467041
Epoch: 2, Steps: 257 | Train Loss: 0.7256374 Vali Loss: 0.3803296 Best vali loss: 0.3719288
	iters: 100, epoch: 3 | loss: 0.6677001
	speed: 0.0137s/iter; left time: 19.7076s
	iters: 200, epoch: 3 | loss: 0.6181010
	speed: 0.0066s/iter; left time: 8.8003s
Updating learning rate to 0.0003870258228088137
Epoch: 3 cost time: 1.678239107131958
Epoch: 3, Steps: 257 | Train Loss: 0.6429005 Vali Loss: 0.3868417 Best vali loss: 0.3719288

best validation loss 0.3719287923839097

[INFO][smbo.py:320] Finished 200 trials.
{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.004792616286, 'e_layers': 2, 'learning_rate': 0.0015570047911, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6179181
	speed: 0.0132s/iter; left time: 12.3207s
Updating learning rate to 0.0014977448248096508
Validation loss decreased (inf --> 0.3843).  Saving model state dict ...
Epoch: 1 cost time: 1.2688541412353516
Epoch: 1, Steps: 129 | Train Loss: 0.6179181 Vali Loss: 0.3842927 Best vali loss: 0.3842927
	iters: 100, epoch: 2 | loss: 0.6295852
	speed: 0.0097s/iter; left time: 7.8275s
Updating learning rate to 0.0013289867186133768
Validation loss decreased (0.3843 --> 0.3751).  Saving model state dict ...
Epoch: 2 cost time: 0.6682922840118408
Epoch: 2, Steps: 129 | Train Loss: 0.6295852 Vali Loss: 0.3750864 Best vali loss: 0.3750864
	iters: 100, epoch: 3 | loss: 0.5164949
	speed: 0.0104s/iter; left time: 7.0196s
Updating learning rate to 0.0010764223643835189
Epoch: 3 cost time: 0.9153904914855957
Epoch: 3, Steps: 129 | Train Loss: 0.5164949 Vali Loss: 0.3776638 Best vali loss: 0.3750864

best validation loss 0.3750864107271543

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008999589749, 'e_layers': 3, 'learning_rate': 9.85480766e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6308360
	speed: 0.0121s/iter; left time: 60.7943s
	iters: 200, epoch: 4 | loss: 0.3095843
	speed: 0.0057s/iter; left time: 28.3461s
	iters: 300, epoch: 4 | loss: 0.3771243
	speed: 0.0057s/iter; left time: 27.5711s
	iters: 400, epoch: 4 | loss: 0.3665676
	speed: 0.0044s/iter; left time: 20.9180s
	iters: 500, epoch: 4 | loss: 0.2548050
	speed: 0.0059s/iter; left time: 27.1386s
	iters: 600, epoch: 4 | loss: 0.2917713
	speed: 0.0059s/iter; left time: 26.7403s
	iters: 700, epoch: 4 | loss: 0.3359430
	speed: 0.0061s/iter; left time: 26.8564s
	iters: 800, epoch: 4 | loss: 0.8236526
	speed: 0.0056s/iter; left time: 24.3836s
	iters: 900, epoch: 4 | loss: 0.3710203
	speed: 0.0070s/iter; left time: 29.6830s
	iters: 1000, epoch: 4 | loss: 0.3568410
	speed: 0.0071s/iter; left time: 29.2987s
Updating learning rate to 4.92740383e-05
Epoch: 4 cost time: 6.39826774597168
Epoch: 4, Steps: 1027 | Train Loss: 0.4118145 Vali Loss: 0.3551743 Best vali loss: 0.3530907
	iters: 100, epoch: 5 | loss: 0.3516807
	speed: 0.0171s/iter; left time: 68.3898s
	iters: 200, epoch: 5 | loss: 0.8499330
	speed: 0.0058s/iter; left time: 22.8079s
	iters: 300, epoch: 5 | loss: 0.2302901
	speed: 0.0040s/iter; left time: 15.0978s
	iters: 400, epoch: 5 | loss: 0.3197927
	speed: 0.0038s/iter; left time: 14.2637s
	iters: 500, epoch: 5 | loss: 0.2332308
	speed: 0.0038s/iter; left time: 13.6484s
	iters: 600, epoch: 5 | loss: 0.9516430
	speed: 0.0038s/iter; left time: 13.4594s
	iters: 700, epoch: 5 | loss: 0.5433524
	speed: 0.0049s/iter; left time: 16.8137s
	iters: 800, epoch: 5 | loss: 0.3287179
	speed: 0.0047s/iter; left time: 15.4734s
	iters: 900, epoch: 5 | loss: 0.3554738
	speed: 0.0050s/iter; left time: 16.0599s
	iters: 1000, epoch: 5 | loss: 0.2414939
	speed: 0.0048s/iter; left time: 14.9315s
Updating learning rate to 3.041768019686711e-05
Validation loss decreased (0.3531 --> 0.3514).  Saving model state dict ...
Epoch: 5 cost time: 4.887918710708618
Epoch: 5, Steps: 1027 | Train Loss: 0.4405608 Vali Loss: 0.3513892 Best vali loss: 0.3513892
	iters: 100, epoch: 6 | loss: 0.2458778
	speed: 0.0144s/iter; left time: 42.7981s
	iters: 200, epoch: 6 | loss: 0.1709716
	speed: 0.0047s/iter; left time: 13.5657s
	iters: 300, epoch: 6 | loss: 0.3951645
	speed: 0.0053s/iter; left time: 14.7395s
	iters: 400, epoch: 6 | loss: 0.3027911
	speed: 0.0047s/iter; left time: 12.5848s
	iters: 500, epoch: 6 | loss: 0.5002680
	speed: 0.0049s/iter; left time: 12.5498s
	iters: 600, epoch: 6 | loss: 0.5158206
	speed: 0.0058s/iter; left time: 14.4684s
	iters: 700, epoch: 6 | loss: 0.2037209
	speed: 0.0042s/iter; left time: 9.9447s
	iters: 800, epoch: 6 | loss: 0.3913862
	speed: 0.0039s/iter; left time: 8.8929s
	iters: 900, epoch: 6 | loss: 0.4640172
	speed: 0.0051s/iter; left time: 11.1425s
	iters: 1000, epoch: 6 | loss: 0.7888706
	speed: 0.0056s/iter; left time: 11.7300s
Updating learning rate to 1.4432031681624341e-05
Epoch: 6 cost time: 5.075839042663574
Epoch: 6, Steps: 1027 | Train Loss: 0.3978888 Vali Loss: 0.3752046 Best vali loss: 0.3513892
	iters: 100, epoch: 7 | loss: 0.6407086
	speed: 0.0145s/iter; left time: 28.3523s
	iters: 200, epoch: 7 | loss: 0.3002882
	speed: 0.0054s/iter; left time: 10.0204s
	iters: 300, epoch: 7 | loss: 0.3673746
	speed: 0.0055s/iter; left time: 9.6440s
	iters: 400, epoch: 7 | loss: 0.6737418
	speed: 0.0057s/iter; left time: 9.3757s
	iters: 500, epoch: 7 | loss: 0.5788949
	speed: 0.0057s/iter; left time: 8.8673s
	iters: 600, epoch: 7 | loss: 0.5770280
	speed: 0.0054s/iter; left time: 7.8755s
	iters: 700, epoch: 7 | loss: 1.0364171
	speed: 0.0059s/iter; left time: 8.0534s
	iters: 800, epoch: 7 | loss: 0.3081533
	speed: 0.0053s/iter; left time: 6.6614s
	iters: 900, epoch: 7 | loss: 0.7384086
	speed: 0.0058s/iter; left time: 6.6805s
	iters: 1000, epoch: 7 | loss: 0.6406500
	speed: 0.0053s/iter; left time: 5.5747s
Updating learning rate to 3.750762830452762e-06
Epoch: 7 cost time: 5.719627380371094
Epoch: 7, Steps: 1027 | Train Loss: 0.5861665 Vali Loss: 0.3783908 Best vali loss: 0.3513892
	iters: 100, epoch: 8 | loss: 0.3110625
	speed: 0.0162s/iter; left time: 15.0675s
	iters: 200, epoch: 8 | loss: 0.3817065
	speed: 0.0051s/iter; left time: 4.1931s
	iters: 300, epoch: 8 | loss: 0.4051045
	speed: 0.0041s/iter; left time: 2.9638s
	iters: 400, epoch: 8 | loss: 0.2402673
	speed: 0.0051s/iter; left time: 3.2281s
	iters: 500, epoch: 8 | loss: 0.2218900
	speed: 0.0067s/iter; left time: 3.5327s
	iters: 600, epoch: 8 | loss: 0.2426029
	speed: 0.0065s/iter; left time: 2.7661s
	iters: 700, epoch: 8 | loss: 0.3923686
	speed: 0.0055s/iter; left time: 1.8150s
	iters: 800, epoch: 8 | loss: 0.4519132
	speed: 0.0072s/iter; left time: 1.6314s
	iters: 900, epoch: 8 | loss: 0.3176918
	speed: 0.0047s/iter; left time: 0.5963s
	iters: 1000, epoch: 8 | loss: 0.5643854
	speed: 0.0044s/iter; left time: 0.1224s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.707366943359375
Epoch: 8, Steps: 1027 | Train Loss: 0.3528993 Vali Loss: 0.3874367 Best vali loss: 0.3513892

best validation loss 0.3513891820384149

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0094422831379, 'e_layers': 4, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 0.7055375576019287
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3654836 Best vali loss: 0.3654836
Updating learning rate to 0.0009137180420535848
Epoch: 2 cost time: 0.591590404510498
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3727874 Best vali loss: 0.3654836
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 0.6151340007781982
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3689738 Best vali loss: 0.3654836
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 0.5875496864318848
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3664886 Best vali loss: 0.3654836
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 0.5655906200408936
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3707646 Best vali loss: 0.3654836
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 0.520007848739624
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3828157 Best vali loss: 0.3654836
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 0.5175859928131104
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3705473 Best vali loss: 0.3654836
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5928330421447754
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3778483 Best vali loss: 0.3654836

best validation loss 0.36548357334258746

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009319745802, 'e_layers': 4, 'learning_rate': 0.0004945924346, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6160579
	speed: 0.0139s/iter; left time: 12.9388s
Updating learning rate to 0.0004945924346
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.3191568851470947
Epoch: 1, Steps: 129 | Train Loss: 0.6160579 Vali Loss: 0.3705655 Best vali loss: 0.3705655
	iters: 100, epoch: 2 | loss: 0.5889817
	speed: 0.0128s/iter; left time: 10.2876s
Updating learning rate to 0.0002472962173
Validation loss decreased (0.3706 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 1.0691845417022705
Epoch: 2, Steps: 129 | Train Loss: 0.5889817 Vali Loss: 0.3667753 Best vali loss: 0.3667753
	iters: 100, epoch: 3 | loss: 0.6212483
	speed: 0.0128s/iter; left time: 8.6160s
Updating learning rate to 0.00012364810865
Validation loss decreased (0.3668 --> 0.3654).  Saving model state dict ...
Epoch: 3 cost time: 1.080698013305664
Epoch: 3, Steps: 129 | Train Loss: 0.6212483 Vali Loss: 0.3654251 Best vali loss: 0.3654251
	iters: 100, epoch: 4 | loss: 0.6191159
	speed: 0.0107s/iter; left time: 5.8424s
Updating learning rate to 6.1824054325e-05
Epoch: 4 cost time: 0.8921968936920166
Epoch: 4, Steps: 129 | Train Loss: 0.6191159 Vali Loss: 0.3664049 Best vali loss: 0.3654251
	iters: 100, epoch: 5 | loss: 0.6263426
	speed: 0.0137s/iter; left time: 5.7061s
Updating learning rate to 3.09120271625e-05
Epoch: 5 cost time: 1.1015386581420898
Epoch: 5, Steps: 129 | Train Loss: 0.6263426 Vali Loss: 0.3688494 Best vali loss: 0.3654251
	iters: 100, epoch: 6 | loss: 0.7415580
	speed: 0.0135s/iter; left time: 3.9010s
Updating learning rate to 1.545601358125e-05
Epoch: 6 cost time: 1.0829429626464844
Epoch: 6, Steps: 129 | Train Loss: 0.7415580 Vali Loss: 0.3701153 Best vali loss: 0.3654251
	iters: 100, epoch: 7 | loss: 0.5952507
	speed: 0.0137s/iter; left time: 2.1829s
Updating learning rate to 7.728006790625e-06
Epoch: 7 cost time: 1.1301627159118652
Epoch: 7, Steps: 129 | Train Loss: 0.5952507 Vali Loss: 0.3717889 Best vali loss: 0.3654251
	iters: 100, epoch: 8 | loss: 0.7679074
	speed: 0.0142s/iter; left time: 0.4253s
Updating learning rate to 3.8640033953125e-06
Epoch: 8 cost time: 1.1481173038482666
Epoch: 8, Steps: 129 | Train Loss: 0.7679074 Vali Loss: 0.3720079 Best vali loss: 0.3654251

best validation loss 0.3654250862673364

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6032607
	speed: 0.0126s/iter; left time: 11.7623s
Updating learning rate to 9.547589994094374e-05
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 1.1704161167144775
Epoch: 1, Steps: 129 | Train Loss: 0.6032607 Vali Loss: 0.3678193 Best vali loss: 0.3678193
	iters: 100, epoch: 2 | loss: 0.6325182
	speed: 0.0109s/iter; left time: 8.7714s
Updating learning rate to 8.47181715251795e-05
Validation loss decreased (0.3678 --> 0.3639).  Saving model state dict ...
Epoch: 2 cost time: 0.8765313625335693
Epoch: 2, Steps: 129 | Train Loss: 0.6325182 Vali Loss: 0.3639305 Best vali loss: 0.3639305
	iters: 100, epoch: 3 | loss: 0.4798157
	speed: 0.0113s/iter; left time: 7.6281s
Updating learning rate to 6.861809318495647e-05
Validation loss decreased (0.3639 --> 0.3631).  Saving model state dict ...
Epoch: 3 cost time: 0.8537003993988037
Epoch: 3, Steps: 129 | Train Loss: 0.4798157 Vali Loss: 0.3630722 Best vali loss: 0.3630722

best validation loss 0.3630721584167368

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.0004262443426, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9187828
	speed: 0.0090s/iter; left time: 8.4277s
Updating learning rate to 0.0004262443426
Validation loss decreased (inf --> 0.3886).  Saving model state dict ...
Epoch: 1 cost time: 0.7115228176116943
Epoch: 1, Steps: 129 | Train Loss: 0.9187828 Vali Loss: 0.3885596 Best vali loss: 0.3885596
	iters: 100, epoch: 2 | loss: 0.7583190
	speed: 0.0082s/iter; left time: 6.6271s
Updating learning rate to 0.0002131221713
Validation loss decreased (0.3886 --> 0.3706).  Saving model state dict ...
Epoch: 2 cost time: 0.7253901958465576
Epoch: 2, Steps: 129 | Train Loss: 0.7583190 Vali Loss: 0.3706209 Best vali loss: 0.3706209
	iters: 100, epoch: 3 | loss: 0.5869536
	speed: 0.0092s/iter; left time: 6.2101s
Updating learning rate to 0.00010656108565
Validation loss decreased (0.3706 --> 0.3674).  Saving model state dict ...
Epoch: 3 cost time: 0.6863260269165039
Epoch: 3, Steps: 129 | Train Loss: 0.5869536 Vali Loss: 0.3674193 Best vali loss: 0.3674193

best validation loss 0.36741925968636696

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0111145234284, 'e_layers': 2, 'learning_rate': 0.0023180376832, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5186256
	speed: 0.0125s/iter; left time: 11.6749s
Updating learning rate to 0.0023180376832
Validation loss decreased (inf --> 0.3797).  Saving model state dict ...
Epoch: 1 cost time: 1.1431505680084229
Epoch: 1, Steps: 129 | Train Loss: 0.5186256 Vali Loss: 0.3796648 Best vali loss: 0.3796648
	iters: 100, epoch: 2 | loss: 0.6268986
	speed: 0.0111s/iter; left time: 8.9113s
Updating learning rate to 0.0011590188416
Validation loss decreased (0.3797 --> 0.3657).  Saving model state dict ...
Epoch: 2 cost time: 0.8835854530334473
Epoch: 2, Steps: 129 | Train Loss: 0.6268986 Vali Loss: 0.3657227 Best vali loss: 0.3657227
	iters: 100, epoch: 3 | loss: 0.6329777
	speed: 0.0110s/iter; left time: 7.4046s
Updating learning rate to 0.0005795094208
Epoch: 3 cost time: 0.81831955909729
Epoch: 3, Steps: 129 | Train Loss: 0.6329777 Vali Loss: 0.3796869 Best vali loss: 0.3657227

best validation loss 0.36572271731841305

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0012309194537, 'e_layers': 2, 'learning_rate': 9.92535118e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4513067
	speed: 0.0128s/iter; left time: 7.0105s
Updating learning rate to 4.96267559e-05
Epoch: 4 cost time: 1.1218361854553223
Epoch: 4, Steps: 129 | Train Loss: 0.4513067 Vali Loss: 0.3786732 Best vali loss: 0.3630722
	iters: 100, epoch: 5 | loss: 0.5089622
	speed: 0.0108s/iter; left time: 4.5205s
Updating learning rate to 3.063541861504353e-05
Epoch: 5 cost time: 0.8722620010375977
Epoch: 5, Steps: 129 | Train Loss: 0.5089622 Vali Loss: 0.3869243 Best vali loss: 0.3630722
	iters: 100, epoch: 6 | loss: 0.4273598
	speed: 0.0108s/iter; left time: 3.1116s
Updating learning rate to 1.4535340274820496e-05
Epoch: 6 cost time: 0.855825662612915
Epoch: 6, Steps: 129 | Train Loss: 0.4273598 Vali Loss: 0.3672643 Best vali loss: 0.3630722
	iters: 100, epoch: 7 | loss: 0.5397586
	speed: 0.0111s/iter; left time: 1.7675s
Updating learning rate to 3.777611859056259e-06
Epoch: 7 cost time: 0.8809175491333008
Epoch: 7, Steps: 129 | Train Loss: 0.5397586 Vali Loss: 0.3736635 Best vali loss: 0.3630722
	iters: 100, epoch: 8 | loss: 0.3519950
	speed: 0.0087s/iter; left time: 0.2598s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6261663436889648
Epoch: 8, Steps: 129 | Train Loss: 0.3519950 Vali Loss: 0.3687410 Best vali loss: 0.3630722

best validation loss 0.3630721584167368

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0071897631756, 'e_layers': 1, 'learning_rate': 0.0003622765966, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7048578
	speed: 0.0094s/iter; left time: 18.3689s
	iters: 200, epoch: 1 | loss: 0.3091697
	speed: 0.0039s/iter; left time: 7.1734s
Updating learning rate to 0.0003622765966
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.2928824424743652
Epoch: 1, Steps: 257 | Train Loss: 0.5070138 Vali Loss: 0.3733843 Best vali loss: 0.3733843
	iters: 100, epoch: 2 | loss: 1.0454680
	speed: 0.0103s/iter; left time: 17.5086s
	iters: 200, epoch: 2 | loss: 0.5918403
	speed: 0.0041s/iter; left time: 6.4977s
Updating learning rate to 0.0001811382983
Epoch: 2 cost time: 1.0855364799499512
Epoch: 2, Steps: 257 | Train Loss: 0.8186541 Vali Loss: 0.3760013 Best vali loss: 0.3733843
	iters: 100, epoch: 3 | loss: 0.5185327
	speed: 0.0102s/iter; left time: 14.7619s
	iters: 200, epoch: 3 | loss: 0.5439044
	speed: 0.0040s/iter; left time: 5.3258s
Updating learning rate to 9.056914915e-05
Epoch: 3 cost time: 1.0776844024658203
Epoch: 3, Steps: 257 | Train Loss: 0.5312186 Vali Loss: 0.3774664 Best vali loss: 0.3733843
	iters: 100, epoch: 4 | loss: 0.4912319
	speed: 0.0103s/iter; left time: 12.1648s
	iters: 200, epoch: 4 | loss: 0.7059585
	speed: 0.0041s/iter; left time: 4.4586s
Updating learning rate to 4.5284574575e-05
Epoch: 4 cost time: 1.114814043045044
Epoch: 4, Steps: 257 | Train Loss: 0.5985952 Vali Loss: 0.3870660 Best vali loss: 0.3733843
	iters: 100, epoch: 5 | loss: 0.4306321
	speed: 0.0097s/iter; left time: 8.9889s
	iters: 200, epoch: 5 | loss: 0.4625700
	speed: 0.0042s/iter; left time: 3.4445s
Updating learning rate to 2.26422872875e-05
Epoch: 5 cost time: 1.107374668121338
Epoch: 5, Steps: 257 | Train Loss: 0.4466010 Vali Loss: 0.3827449 Best vali loss: 0.3733843
	iters: 100, epoch: 6 | loss: 0.6040453
	speed: 0.0098s/iter; left time: 6.6123s
	iters: 200, epoch: 6 | loss: 0.6795376
	speed: 0.0044s/iter; left time: 2.5287s
Updating learning rate to 1.132114364375e-05
Epoch: 6 cost time: 1.1469435691833496
Epoch: 6, Steps: 257 | Train Loss: 0.6417915 Vali Loss: 0.3836130 Best vali loss: 0.3733843
	iters: 100, epoch: 7 | loss: 0.4226794
	speed: 0.0106s/iter; left time: 4.4025s
	iters: 200, epoch: 7 | loss: 0.3352979
	speed: 0.0042s/iter; left time: 1.3288s
Updating learning rate to 5.660571821875e-06
Epoch: 7 cost time: 1.116182804107666
Epoch: 7, Steps: 257 | Train Loss: 0.3789887 Vali Loss: 0.3856101 Best vali loss: 0.3733843
	iters: 100, epoch: 8 | loss: 0.6254586
	speed: 0.0108s/iter; left time: 1.7024s
	iters: 200, epoch: 8 | loss: 0.4144227
	speed: 0.0038s/iter; left time: 0.2214s
Updating learning rate to 2.8302859109375e-06
Epoch: 8 cost time: 1.1334187984466553
Epoch: 8, Steps: 257 | Train Loss: 0.5199407 Vali Loss: 0.3841163 Best vali loss: 0.3733843

best validation loss 0.3733843228261925

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0054727202871, 'e_layers': 1, 'learning_rate': 0.0015843837106, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7119560
	speed: 0.0099s/iter; left time: 19.3596s
	iters: 200, epoch: 1 | loss: 0.5307248
	speed: 0.0042s/iter; left time: 7.7325s
Updating learning rate to 0.001524081696233813
Validation loss decreased (inf --> 0.3823).  Saving model state dict ...
Epoch: 1 cost time: 1.3527798652648926
Epoch: 1, Steps: 257 | Train Loss: 0.6213404 Vali Loss: 0.3822755 Best vali loss: 0.3822755
	iters: 100, epoch: 2 | loss: 0.6030914
	speed: 0.0104s/iter; left time: 17.6753s
	iters: 200, epoch: 2 | loss: 0.4761387
	speed: 0.0047s/iter; left time: 7.4811s
Updating learning rate to 0.0013523560881833821
Validation loss decreased (0.3823 --> 0.3743).  Saving model state dict ...
Epoch: 2 cost time: 1.1827545166015625
Epoch: 2, Steps: 257 | Train Loss: 0.5396150 Vali Loss: 0.3743076 Best vali loss: 0.3743076
	iters: 100, epoch: 3 | loss: 0.2692143
	speed: 0.0102s/iter; left time: 14.7836s
	iters: 200, epoch: 3 | loss: 0.2586419
	speed: 0.0028s/iter; left time: 3.6933s
Updating learning rate to 0.0010953505535778727
Epoch: 3 cost time: 0.9624369144439697
Epoch: 3, Steps: 257 | Train Loss: 0.2639281 Vali Loss: 0.3999770 Best vali loss: 0.3743076
	iters: 100, epoch: 4 | loss: 0.8603663
	speed: 0.0075s/iter; left time: 8.8950s
	iters: 200, epoch: 4 | loss: 0.4596946
	speed: 0.0040s/iter; left time: 4.2931s
Updating learning rate to 0.0007921918553
Epoch: 4 cost time: 0.9658443927764893
Epoch: 4, Steps: 257 | Train Loss: 0.6600304 Vali Loss: 0.4074249 Best vali loss: 0.3743076
	iters: 100, epoch: 5 | loss: 0.4722664
	speed: 0.0093s/iter; left time: 8.5990s
	iters: 200, epoch: 5 | loss: 0.5027153
	speed: 0.0035s/iter; left time: 2.9260s
Updating learning rate to 0.0004890331570221276
Epoch: 5 cost time: 0.9759936332702637
Epoch: 5, Steps: 257 | Train Loss: 0.4874909 Vali Loss: 0.4285591 Best vali loss: 0.3743076
	iters: 100, epoch: 6 | loss: 0.4076043
	speed: 0.0090s/iter; left time: 6.0554s
	iters: 200, epoch: 6 | loss: 0.4804348
	speed: 0.0038s/iter; left time: 2.1530s
Updating learning rate to 0.00023202762241661783
Epoch: 6 cost time: 0.9840292930603027
Epoch: 6, Steps: 257 | Train Loss: 0.4440195 Vali Loss: 0.4177944 Best vali loss: 0.3743076
	iters: 100, epoch: 7 | loss: 0.2193313
	speed: 0.0104s/iter; left time: 4.3024s
	iters: 200, epoch: 7 | loss: 0.7571328
	speed: 0.0036s/iter; left time: 1.1247s
Updating learning rate to 6.030201436618709e-05
Epoch: 7 cost time: 1.1252937316894531
Epoch: 7, Steps: 257 | Train Loss: 0.4882320 Vali Loss: 0.4492241 Best vali loss: 0.3743076
	iters: 100, epoch: 8 | loss: 0.6897094
	speed: 0.0096s/iter; left time: 1.5090s
	iters: 200, epoch: 8 | loss: 0.4156100
	speed: 0.0035s/iter; left time: 0.2034s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0054678916931152
Epoch: 8, Steps: 257 | Train Loss: 0.5526597 Vali Loss: 0.4520004 Best vali loss: 0.3743076

best validation loss 0.3743076342496516

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4511223
	speed: 0.0101s/iter; left time: 82.1614s
	iters: 200, epoch: 1 | loss: 0.5344576
	speed: 0.0043s/iter; left time: 34.5943s
	iters: 300, epoch: 1 | loss: 0.2261675
	speed: 0.0043s/iter; left time: 34.1762s
	iters: 400, epoch: 1 | loss: 0.2605006
	speed: 0.0043s/iter; left time: 33.5196s
	iters: 500, epoch: 1 | loss: 0.4560276
	speed: 0.0043s/iter; left time: 32.9392s
	iters: 600, epoch: 1 | loss: 0.4033536
	speed: 0.0044s/iter; left time: 33.6841s
	iters: 700, epoch: 1 | loss: 0.5451778
	speed: 0.0038s/iter; left time: 28.5662s
	iters: 800, epoch: 1 | loss: 0.5920198
	speed: 0.0034s/iter; left time: 25.3323s
	iters: 900, epoch: 1 | loss: 0.7326966
	speed: 0.0034s/iter; left time: 24.7693s
	iters: 1000, epoch: 1 | loss: 0.5626775
	speed: 0.0049s/iter; left time: 35.2735s
Updating learning rate to 0.0003784163294
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 4.5515031814575195
Epoch: 1, Steps: 1027 | Train Loss: 0.4764201 Vali Loss: 0.3695404 Best vali loss: 0.3695404
	iters: 100, epoch: 2 | loss: 0.3200217
	speed: 0.0133s/iter; left time: 94.5723s
	iters: 200, epoch: 2 | loss: 1.1101364
	speed: 0.0032s/iter; left time: 22.0761s
	iters: 300, epoch: 2 | loss: 0.5437029
	speed: 0.0030s/iter; left time: 20.8058s
	iters: 400, epoch: 2 | loss: 0.7207666
	speed: 0.0040s/iter; left time: 26.8263s
	iters: 500, epoch: 2 | loss: 0.4798887
	speed: 0.0041s/iter; left time: 27.5818s
	iters: 600, epoch: 2 | loss: 0.4083786
	speed: 0.0045s/iter; left time: 29.4773s
	iters: 700, epoch: 2 | loss: 0.4090051
	speed: 0.0045s/iter; left time: 29.0591s
	iters: 800, epoch: 2 | loss: 0.2577291
	speed: 0.0040s/iter; left time: 25.6887s
	iters: 900, epoch: 2 | loss: 0.2428242
	speed: 0.0041s/iter; left time: 25.5724s
	iters: 1000, epoch: 2 | loss: 0.5157181
	speed: 0.0052s/iter; left time: 32.3348s
Updating learning rate to 0.0001892081647
Validation loss decreased (0.3695 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 4.263975381851196
Epoch: 2, Steps: 1027 | Train Loss: 0.5008171 Vali Loss: 0.3642226 Best vali loss: 0.3642226
	iters: 100, epoch: 3 | loss: 0.6510080
	speed: 0.0096s/iter; left time: 58.0115s
	iters: 200, epoch: 3 | loss: 0.5149350
	speed: 0.0042s/iter; left time: 25.0148s
	iters: 300, epoch: 3 | loss: 0.2546134
	speed: 0.0042s/iter; left time: 24.3964s
	iters: 400, epoch: 3 | loss: 0.3868976
	speed: 0.0041s/iter; left time: 23.7431s
	iters: 500, epoch: 3 | loss: 1.0491015
	speed: 0.0038s/iter; left time: 21.4086s
	iters: 600, epoch: 3 | loss: 0.5946798
	speed: 0.0039s/iter; left time: 21.7194s
	iters: 700, epoch: 3 | loss: 0.4098860
	speed: 0.0040s/iter; left time: 21.6465s
	iters: 800, epoch: 3 | loss: 0.6016607
	speed: 0.0039s/iter; left time: 21.0015s
	iters: 900, epoch: 3 | loss: 0.1581088
	speed: 0.0040s/iter; left time: 21.0559s
	iters: 1000, epoch: 3 | loss: 0.3777607
	speed: 0.0037s/iter; left time: 19.0805s
Updating learning rate to 9.460408235e-05
Epoch: 3 cost time: 4.073096036911011
Epoch: 3, Steps: 1027 | Train Loss: 0.4998651 Vali Loss: 0.3759711 Best vali loss: 0.3642226

best validation loss 0.36422257644722644

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0020904164085, 'e_layers': 4, 'learning_rate': 0.0011131188943, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5519177
	speed: 0.0127s/iter; left time: 50.9134s
	iters: 200, epoch: 1 | loss: 0.3536148
	speed: 0.0073s/iter; left time: 28.4962s
	iters: 300, epoch: 1 | loss: 0.6679075
	speed: 0.0068s/iter; left time: 25.7807s
	iters: 400, epoch: 1 | loss: 1.1532738
	speed: 0.0070s/iter; left time: 26.0622s
	iters: 500, epoch: 1 | loss: 0.5937871
	speed: 0.0075s/iter; left time: 26.9550s
Updating learning rate to 0.0011131188943
Validation loss decreased (inf --> 0.3750).  Saving model state dict ...
Epoch: 1 cost time: 3.950161933898926
Epoch: 1, Steps: 514 | Train Loss: 0.6641002 Vali Loss: 0.3749591 Best vali loss: 0.3749591
	iters: 100, epoch: 2 | loss: 0.4740487
	speed: 0.0140s/iter; left time: 49.1536s
	iters: 200, epoch: 2 | loss: 0.7840279
	speed: 0.0072s/iter; left time: 24.6398s
	iters: 300, epoch: 2 | loss: 1.0257459
	speed: 0.0071s/iter; left time: 23.4494s
	iters: 400, epoch: 2 | loss: 0.7592581
	speed: 0.0071s/iter; left time: 22.8176s
	iters: 500, epoch: 2 | loss: 0.3787824
	speed: 0.0073s/iter; left time: 22.5647s
Updating learning rate to 0.00055655944715
Epoch: 2 cost time: 3.7308356761932373
Epoch: 2, Steps: 514 | Train Loss: 0.6843726 Vali Loss: 0.3962355 Best vali loss: 0.3749591
	iters: 100, epoch: 3 | loss: 0.3635599
	speed: 0.0142s/iter; left time: 42.4780s
	iters: 200, epoch: 3 | loss: 0.5310820
	speed: 0.0074s/iter; left time: 21.2231s
	iters: 300, epoch: 3 | loss: 0.8983297
	speed: 0.0072s/iter; left time: 19.9593s
	iters: 400, epoch: 3 | loss: 0.7035117
	speed: 0.0054s/iter; left time: 14.6021s
	iters: 500, epoch: 3 | loss: 0.3949713
	speed: 0.0051s/iter; left time: 13.1059s
Updating learning rate to 0.000278279723575
Validation loss decreased (0.3750 --> 0.3705).  Saving model state dict ...
Epoch: 3 cost time: 3.3565993309020996
Epoch: 3, Steps: 514 | Train Loss: 0.5782909 Vali Loss: 0.3704770 Best vali loss: 0.3704770

best validation loss 0.37047698593795414

{'batch_size': 128, 'd_core': 256, 'd_model': 256, 'dropout': 0.0019114256213, 'e_layers': 2, 'learning_rate': 0.0002250367297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00021647177916655239
Validation loss decreased (inf --> 0.3678).  Saving model state dict ...
Epoch: 1 cost time: 0.7960300445556641
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3678182 Best vali loss: 0.3678182
Updating learning rate to 0.00019208086364345706
Validation loss decreased (0.3678 --> 0.3645).  Saving model state dict ...
Epoch: 2 cost time: 0.5276834964752197
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3645327 Best vali loss: 0.3645327
Updating learning rate to 0.00015557727891490547
Epoch: 3 cost time: 0.5783498287200928
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3660964 Best vali loss: 0.3645327

best validation loss 0.3645326856194404

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0062585813635, 'e_layers': 2, 'learning_rate': 0.0003784163294, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3363824
	speed: 0.0093s/iter; left time: 47.0748s
	iters: 200, epoch: 4 | loss: 0.5248263
	speed: 0.0035s/iter; left time: 17.1827s
	iters: 300, epoch: 4 | loss: 0.2306739
	speed: 0.0036s/iter; left time: 17.2036s
	iters: 400, epoch: 4 | loss: 0.2604924
	speed: 0.0035s/iter; left time: 16.5735s
	iters: 500, epoch: 4 | loss: 0.3736453
	speed: 0.0037s/iter; left time: 17.1457s
	iters: 600, epoch: 4 | loss: 0.4294609
	speed: 0.0039s/iter; left time: 17.7638s
	iters: 700, epoch: 4 | loss: 0.4983186
	speed: 0.0036s/iter; left time: 16.0491s
	iters: 800, epoch: 4 | loss: 0.5880725
	speed: 0.0045s/iter; left time: 19.4618s
	iters: 900, epoch: 4 | loss: 0.8121588
	speed: 0.0042s/iter; left time: 17.8810s
	iters: 1000, epoch: 4 | loss: 0.5495392
	speed: 0.0037s/iter; left time: 15.3737s
Updating learning rate to 4.7302041175e-05
Epoch: 4 cost time: 4.193935871124268
Epoch: 4, Steps: 1027 | Train Loss: 0.4603570 Vali Loss: 0.3756999 Best vali loss: 0.3642226
	iters: 100, epoch: 5 | loss: 0.3158148
	speed: 0.0114s/iter; left time: 45.8947s
	iters: 200, epoch: 5 | loss: 0.9070864
	speed: 0.0033s/iter; left time: 12.8218s
	iters: 300, epoch: 5 | loss: 0.5162151
	speed: 0.0040s/iter; left time: 15.1678s
	iters: 400, epoch: 5 | loss: 0.6973884
	speed: 0.0044s/iter; left time: 16.2199s
	iters: 500, epoch: 5 | loss: 0.4568689
	speed: 0.0044s/iter; left time: 16.0570s
	iters: 600, epoch: 5 | loss: 0.3713458
	speed: 0.0044s/iter; left time: 15.4030s
	iters: 700, epoch: 5 | loss: 0.3600517
	speed: 0.0040s/iter; left time: 13.6451s
	iters: 800, epoch: 5 | loss: 0.2626217
	speed: 0.0045s/iter; left time: 14.8441s
	iters: 900, epoch: 5 | loss: 0.2385852
	speed: 0.0043s/iter; left time: 13.9431s
	iters: 1000, epoch: 5 | loss: 0.4803485
	speed: 0.0043s/iter; left time: 13.5101s
Updating learning rate to 2.36510205875e-05
Epoch: 5 cost time: 4.237202167510986
Epoch: 5, Steps: 1027 | Train Loss: 0.4606326 Vali Loss: 0.3663736 Best vali loss: 0.3642226
	iters: 100, epoch: 6 | loss: 0.5817534
	speed: 0.0126s/iter; left time: 37.5210s
	iters: 200, epoch: 6 | loss: 0.4488414
	speed: 0.0038s/iter; left time: 11.0836s
	iters: 300, epoch: 6 | loss: 0.2331970
	speed: 0.0037s/iter; left time: 10.2495s
	iters: 400, epoch: 6 | loss: 0.3981271
	speed: 0.0032s/iter; left time: 8.6370s
	iters: 500, epoch: 6 | loss: 1.0287353
	speed: 0.0031s/iter; left time: 7.9904s
	iters: 600, epoch: 6 | loss: 0.5283678
	speed: 0.0034s/iter; left time: 8.4562s
	iters: 700, epoch: 6 | loss: 0.3525019
	speed: 0.0043s/iter; left time: 10.1250s
	iters: 800, epoch: 6 | loss: 0.5258165
	speed: 0.0040s/iter; left time: 9.0725s
	iters: 900, epoch: 6 | loss: 0.1678500
	speed: 0.0041s/iter; left time: 8.9647s
	iters: 1000, epoch: 6 | loss: 0.3702643
	speed: 0.0040s/iter; left time: 8.4173s
Updating learning rate to 1.182551029375e-05
Validation loss decreased (0.3642 --> 0.3636).  Saving model state dict ...
Epoch: 6 cost time: 3.9258782863616943
Epoch: 6, Steps: 1027 | Train Loss: 0.4635455 Vali Loss: 0.3635751 Best vali loss: 0.3635751
	iters: 100, epoch: 7 | loss: 0.2562704
	speed: 0.0129s/iter; left time: 25.2504s
	iters: 200, epoch: 7 | loss: 0.8068931
	speed: 0.0041s/iter; left time: 7.5333s
	iters: 300, epoch: 7 | loss: 0.6099721
	speed: 0.0043s/iter; left time: 7.5125s
	iters: 400, epoch: 7 | loss: 0.4447584
	speed: 0.0040s/iter; left time: 6.6759s
	iters: 500, epoch: 7 | loss: 0.4300590
	speed: 0.0040s/iter; left time: 6.1575s
	iters: 600, epoch: 7 | loss: 0.2666131
	speed: 0.0037s/iter; left time: 5.3545s
	iters: 700, epoch: 7 | loss: 0.7835796
	speed: 0.0038s/iter; left time: 5.0820s
	iters: 800, epoch: 7 | loss: 0.6673844
	speed: 0.0041s/iter; left time: 5.1317s
	iters: 900, epoch: 7 | loss: 0.4417333
	speed: 0.0041s/iter; left time: 4.7398s
	iters: 1000, epoch: 7 | loss: 0.5984864
	speed: 0.0040s/iter; left time: 4.2142s
Updating learning rate to 5.912755146875e-06
Epoch: 7 cost time: 4.171098947525024
Epoch: 7, Steps: 1027 | Train Loss: 0.5305750 Vali Loss: 0.3642644 Best vali loss: 0.3635751
	iters: 100, epoch: 8 | loss: 0.3242595
	speed: 0.0138s/iter; left time: 12.7785s
	iters: 200, epoch: 8 | loss: 0.9368985
	speed: 0.0043s/iter; left time: 3.5851s
	iters: 300, epoch: 8 | loss: 0.4748631
	speed: 0.0047s/iter; left time: 3.3909s
	iters: 400, epoch: 8 | loss: 0.8757326
	speed: 0.0045s/iter; left time: 2.8395s
	iters: 500, epoch: 8 | loss: 0.8550261
	speed: 0.0043s/iter; left time: 2.2658s
	iters: 600, epoch: 8 | loss: 0.9183068
	speed: 0.0038s/iter; left time: 1.6319s
	iters: 700, epoch: 8 | loss: 0.8427736
	speed: 0.0039s/iter; left time: 1.2702s
	iters: 800, epoch: 8 | loss: 0.2596003
	speed: 0.0042s/iter; left time: 0.9576s
	iters: 900, epoch: 8 | loss: 0.3504656
	speed: 0.0045s/iter; left time: 0.5787s
	iters: 1000, epoch: 8 | loss: 0.6154547
	speed: 0.0046s/iter; left time: 0.1278s
Updating learning rate to 2.9563775734375e-06
Epoch: 8 cost time: 4.505035877227783
Epoch: 8, Steps: 1027 | Train Loss: 0.6453381 Vali Loss: 0.3650203 Best vali loss: 0.3635751

best validation loss 0.3635751042946851

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0022899640873, 'e_layers': 4, 'learning_rate': 0.0002423804971, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5328399
	speed: 0.0122s/iter; left time: 23.9060s
	iters: 200, epoch: 1 | loss: 0.5424046
	speed: 0.0062s/iter; left time: 11.4650s
Updating learning rate to 0.00023315543872530064
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 1.9216933250427246
Epoch: 1, Steps: 257 | Train Loss: 0.5376222 Vali Loss: 0.3700677 Best vali loss: 0.3700677
	iters: 100, epoch: 2 | loss: 0.6227621
	speed: 0.0144s/iter; left time: 24.4754s
	iters: 200, epoch: 2 | loss: 0.6736828
	speed: 0.0054s/iter; left time: 8.5618s
Updating learning rate to 0.00020688469511338813
Validation loss decreased (0.3701 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 1.5973362922668457
Epoch: 2, Steps: 257 | Train Loss: 0.6482225 Vali Loss: 0.3640624 Best vali loss: 0.3640624
	iters: 100, epoch: 3 | loss: 0.8216054
	speed: 0.0134s/iter; left time: 19.2777s
	iters: 200, epoch: 3 | loss: 0.6985644
	speed: 0.0066s/iter; left time: 8.8061s
Updating learning rate to 0.00016756774883429235
Epoch: 3 cost time: 1.7155137062072754
Epoch: 3, Steps: 257 | Train Loss: 0.7600849 Vali Loss: 0.3676269 Best vali loss: 0.3640624
	iters: 100, epoch: 4 | loss: 0.6873901
	speed: 0.0147s/iter; left time: 17.4516s
	iters: 200, epoch: 4 | loss: 0.5601023
	speed: 0.0065s/iter; left time: 7.0989s
Updating learning rate to 0.00012119024855
Epoch: 4 cost time: 1.8106849193572998
Epoch: 4, Steps: 257 | Train Loss: 0.6237462 Vali Loss: 0.3705328 Best vali loss: 0.3640624
	iters: 100, epoch: 5 | loss: 0.5063085
	speed: 0.0144s/iter; left time: 13.3811s
	iters: 200, epoch: 5 | loss: 0.6214201
	speed: 0.0069s/iter; left time: 5.6853s
Updating learning rate to 7.481274826570766e-05
Epoch: 5 cost time: 1.8132352828979492
Epoch: 5, Steps: 257 | Train Loss: 0.5638643 Vali Loss: 0.3700376 Best vali loss: 0.3640624
	iters: 100, epoch: 6 | loss: 0.5458779
	speed: 0.0152s/iter; left time: 10.2174s
	iters: 200, epoch: 6 | loss: 0.6017247
	speed: 0.0067s/iter; left time: 3.8098s
Updating learning rate to 3.549580198661185e-05
Epoch: 6 cost time: 1.8085174560546875
Epoch: 6, Steps: 257 | Train Loss: 0.5738013 Vali Loss: 0.3678295 Best vali loss: 0.3640624
	iters: 100, epoch: 7 | loss: 0.5683891
	speed: 0.0138s/iter; left time: 5.7161s
	iters: 200, epoch: 7 | loss: 0.7822309
	speed: 0.0051s/iter; left time: 1.6209s
Updating learning rate to 9.225058374699354e-06
Epoch: 7 cost time: 1.5554471015930176
Epoch: 7, Steps: 257 | Train Loss: 0.6753100 Vali Loss: 0.3700413 Best vali loss: 0.3640624
	iters: 100, epoch: 8 | loss: 0.7609904
	speed: 0.0142s/iter; left time: 2.2364s
	iters: 200, epoch: 8 | loss: 0.6440064
	speed: 0.0062s/iter; left time: 0.3596s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6777541637420654
Epoch: 8, Steps: 257 | Train Loss: 0.7024984 Vali Loss: 0.3694516 Best vali loss: 0.3640624

best validation loss 0.3640624115181344

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033888467905, 'e_layers': 1, 'learning_rate': 0.0037128733106, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4072282
	speed: 0.0096s/iter; left time: 18.6932s
	iters: 200, epoch: 1 | loss: 0.5637100
	speed: 0.0041s/iter; left time: 7.5796s
Updating learning rate to 0.0037128733106
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 1.3110833168029785
Epoch: 1, Steps: 257 | Train Loss: 0.4854691 Vali Loss: 0.3709844 Best vali loss: 0.3709844
	iters: 100, epoch: 2 | loss: 0.6611382
	speed: 0.0092s/iter; left time: 15.5851s
	iters: 200, epoch: 2 | loss: 0.4718664
	speed: 0.0038s/iter; left time: 6.1008s
Updating learning rate to 0.0018564366553
Validation loss decreased (0.3710 --> 0.3679).  Saving model state dict ...
Epoch: 2 cost time: 1.0659971237182617
Epoch: 2, Steps: 257 | Train Loss: 0.5665023 Vali Loss: 0.3679246 Best vali loss: 0.3679246
	iters: 100, epoch: 3 | loss: 0.7074174
	speed: 0.0102s/iter; left time: 14.6904s
	iters: 200, epoch: 3 | loss: 0.7119468
	speed: 0.0038s/iter; left time: 5.1631s
Updating learning rate to 0.00092821832765
Epoch: 3 cost time: 1.0692238807678223
Epoch: 3, Steps: 257 | Train Loss: 0.7096821 Vali Loss: 0.3877089 Best vali loss: 0.3679246
	iters: 100, epoch: 4 | loss: 0.4742163
	speed: 0.0096s/iter; left time: 11.4426s
	iters: 200, epoch: 4 | loss: 0.3930964
	speed: 0.0038s/iter; left time: 4.0760s
Updating learning rate to 0.000464109163825
Epoch: 4 cost time: 1.0278408527374268
Epoch: 4, Steps: 257 | Train Loss: 0.4336563 Vali Loss: 0.3882908 Best vali loss: 0.3679246
	iters: 100, epoch: 5 | loss: 0.5247506
	speed: 0.0098s/iter; left time: 9.1352s
	iters: 200, epoch: 5 | loss: 0.3039176
	speed: 0.0037s/iter; left time: 3.0526s
Updating learning rate to 0.0002320545819125
Epoch: 5 cost time: 1.0468497276306152
Epoch: 5, Steps: 257 | Train Loss: 0.4143341 Vali Loss: 0.3866056 Best vali loss: 0.3679246
	iters: 100, epoch: 6 | loss: 0.8474663
	speed: 0.0098s/iter; left time: 6.5804s
	iters: 200, epoch: 6 | loss: 0.5800204
	speed: 0.0039s/iter; left time: 2.2110s
Updating learning rate to 0.00011602729095625
Epoch: 6 cost time: 1.0713505744934082
Epoch: 6, Steps: 257 | Train Loss: 0.7137434 Vali Loss: 0.3839365 Best vali loss: 0.3679246
	iters: 100, epoch: 7 | loss: 0.3152591
	speed: 0.0101s/iter; left time: 4.1902s
	iters: 200, epoch: 7 | loss: 0.6155260
	speed: 0.0038s/iter; left time: 1.2114s
Updating learning rate to 5.8013645478125e-05
Epoch: 7 cost time: 1.052612543106079
Epoch: 7, Steps: 257 | Train Loss: 0.4653926 Vali Loss: 0.3859995 Best vali loss: 0.3679246
	iters: 100, epoch: 8 | loss: 0.5094138
	speed: 0.0091s/iter; left time: 1.4328s
	iters: 200, epoch: 8 | loss: 0.5670352
	speed: 0.0041s/iter; left time: 0.2359s
Updating learning rate to 2.90068227390625e-05
Epoch: 8 cost time: 1.0595402717590332
Epoch: 8, Steps: 257 | Train Loss: 0.5382245 Vali Loss: 0.3846213 Best vali loss: 0.3679246

best validation loss 0.3679245627230886

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0096712489936, 'e_layers': 4, 'learning_rate': 0.0007900549735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5943328
	speed: 0.0121s/iter; left time: 23.6883s
	iters: 200, epoch: 1 | loss: 0.8480011
	speed: 0.0064s/iter; left time: 11.8303s
Updating learning rate to 0.0007599852965376985
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 1.9207673072814941
Epoch: 1, Steps: 257 | Train Loss: 0.7211669 Vali Loss: 0.3706182 Best vali loss: 0.3706182
	iters: 100, epoch: 2 | loss: 0.5235533
	speed: 0.0137s/iter; left time: 23.3552s
	iters: 200, epoch: 2 | loss: 0.4841405
	speed: 0.0073s/iter; left time: 11.7355s
Updating learning rate to 0.000674354101386004
Validation loss decreased (0.3706 --> 0.3705).  Saving model state dict ...
Epoch: 2 cost time: 1.796067714691162
Epoch: 2, Steps: 257 | Train Loss: 0.5038469 Vali Loss: 0.3705356 Best vali loss: 0.3705356
	iters: 100, epoch: 3 | loss: 0.8038704
	speed: 0.0141s/iter; left time: 20.2801s
	iters: 200, epoch: 3 | loss: 0.5306723
	speed: 0.0063s/iter; left time: 8.5215s
Updating learning rate to 0.0005461979612580451
Epoch: 3 cost time: 1.6913130283355713
Epoch: 3, Steps: 257 | Train Loss: 0.6672714 Vali Loss: 0.3740702 Best vali loss: 0.3705356

best validation loss 0.3705355885806393

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 2.4648263
	speed: 0.0111s/iter; left time: 90.3470s
	iters: 200, epoch: 1 | loss: 0.2655614
	speed: 0.0051s/iter; left time: 40.9844s
	iters: 300, epoch: 1 | loss: 0.2735536
	speed: 0.0051s/iter; left time: 40.2450s
	iters: 400, epoch: 1 | loss: 0.2313503
	speed: 0.0049s/iter; left time: 38.4004s
	iters: 500, epoch: 1 | loss: 0.5476995
	speed: 0.0050s/iter; left time: 38.4036s
	iters: 600, epoch: 1 | loss: 0.6698667
	speed: 0.0051s/iter; left time: 38.6875s
	iters: 700, epoch: 1 | loss: 1.6055570
	speed: 0.0053s/iter; left time: 39.7729s
	iters: 800, epoch: 1 | loss: 0.3446052
	speed: 0.0051s/iter; left time: 38.1843s
	iters: 900, epoch: 1 | loss: 0.3624881
	speed: 0.0051s/iter; left time: 37.3702s
	iters: 1000, epoch: 1 | loss: 0.8927222
	speed: 0.0051s/iter; left time: 36.7493s
Updating learning rate to 0.0001606491471
Validation loss decreased (inf --> 0.3683).  Saving model state dict ...
Epoch: 1 cost time: 5.52870512008667
Epoch: 1, Steps: 1027 | Train Loss: 0.7658230 Vali Loss: 0.3683376 Best vali loss: 0.3683376
	iters: 100, epoch: 2 | loss: 0.9052638
	speed: 0.0154s/iter; left time: 108.8828s
	iters: 200, epoch: 2 | loss: 1.3970069
	speed: 0.0050s/iter; left time: 35.0635s
	iters: 300, epoch: 2 | loss: 0.4819513
	speed: 0.0051s/iter; left time: 35.4486s
	iters: 400, epoch: 2 | loss: 0.5943895
	speed: 0.0043s/iter; left time: 29.5105s
	iters: 500, epoch: 2 | loss: 0.7530330
	speed: 0.0043s/iter; left time: 28.7287s
	iters: 600, epoch: 2 | loss: 0.5526275
	speed: 0.0040s/iter; left time: 26.6168s
	iters: 700, epoch: 2 | loss: 1.7132534
	speed: 0.0043s/iter; left time: 27.6891s
	iters: 800, epoch: 2 | loss: 0.2953705
	speed: 0.0055s/iter; left time: 34.9706s
	iters: 900, epoch: 2 | loss: 0.4864575
	speed: 0.0052s/iter; left time: 32.4069s
	iters: 1000, epoch: 2 | loss: 0.4719875
	speed: 0.0049s/iter; left time: 30.3591s
Updating learning rate to 8.032457355e-05
Validation loss decreased (0.3683 --> 0.3644).  Saving model state dict ...
Epoch: 2 cost time: 4.956624269485474
Epoch: 2, Steps: 1027 | Train Loss: 0.7651341 Vali Loss: 0.3643841 Best vali loss: 0.3643841
	iters: 100, epoch: 3 | loss: 0.6965716
	speed: 0.0136s/iter; left time: 82.2426s
	iters: 200, epoch: 3 | loss: 1.0189538
	speed: 0.0052s/iter; left time: 30.7144s
	iters: 300, epoch: 3 | loss: 0.4356684
	speed: 0.0048s/iter; left time: 28.1689s
	iters: 400, epoch: 3 | loss: 0.4615722
	speed: 0.0046s/iter; left time: 26.6518s
	iters: 500, epoch: 3 | loss: 0.9165179
	speed: 0.0049s/iter; left time: 27.5870s
	iters: 600, epoch: 3 | loss: 0.3492435
	speed: 0.0049s/iter; left time: 27.3966s
	iters: 700, epoch: 3 | loss: 0.6812825
	speed: 0.0048s/iter; left time: 26.0801s
	iters: 800, epoch: 3 | loss: 0.3018096
	speed: 0.0043s/iter; left time: 23.2265s
	iters: 900, epoch: 3 | loss: 0.2492532
	speed: 0.0039s/iter; left time: 20.7453s
	iters: 1000, epoch: 3 | loss: 0.6420166
	speed: 0.0092s/iter; left time: 47.6831s
Updating learning rate to 4.0162286775e-05
Epoch: 3 cost time: 5.40229606628418
Epoch: 3, Steps: 1027 | Train Loss: 0.5752889 Vali Loss: 0.3701638 Best vali loss: 0.3643841

best validation loss 0.36438405129670626

{'batch_size': 16, 'd_core': 128, 'd_model': 256, 'dropout': 0.0061686788666, 'e_layers': 2, 'learning_rate': 0.0029971076006, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6161913
	speed: 0.0137s/iter; left time: 54.8967s
	iters: 200, epoch: 1 | loss: 1.0790392
	speed: 0.0082s/iter; left time: 32.0717s
	iters: 300, epoch: 1 | loss: 1.0444437
	speed: 0.0073s/iter; left time: 27.6844s
	iters: 400, epoch: 1 | loss: 0.3355361
	speed: 0.0085s/iter; left time: 31.6133s
	iters: 500, epoch: 1 | loss: 0.6857113
	speed: 0.0067s/iter; left time: 24.2380s
Updating learning rate to 0.0028830369847641763
Validation loss decreased (inf --> 0.4054).  Saving model state dict ...
Epoch: 1 cost time: 4.2778074741363525
Epoch: 1, Steps: 514 | Train Loss: 0.7521843 Vali Loss: 0.4053901 Best vali loss: 0.4053901
	iters: 100, epoch: 2 | loss: 0.4322260
	speed: 0.0154s/iter; left time: 53.9913s
	iters: 200, epoch: 2 | loss: 0.7908754
	speed: 0.0094s/iter; left time: 31.9733s
	iters: 300, epoch: 2 | loss: 1.0091783
	speed: 0.0061s/iter; left time: 19.9920s
	iters: 400, epoch: 2 | loss: 0.3687348
	speed: 0.0091s/iter; left time: 29.1496s
	iters: 500, epoch: 2 | loss: 0.8526786
	speed: 0.0057s/iter; left time: 17.7191s
Updating learning rate to 0.002558191354465001
Validation loss decreased (0.4054 --> 0.4034).  Saving model state dict ...
Epoch: 2 cost time: 3.766773223876953
Epoch: 2, Steps: 514 | Train Loss: 0.6907386 Vali Loss: 0.4033624 Best vali loss: 0.4033624
	iters: 100, epoch: 3 | loss: 1.2960265
	speed: 0.0075s/iter; left time: 22.3747s
	iters: 200, epoch: 3 | loss: 1.0008342
	speed: 0.0048s/iter; left time: 13.8118s
	iters: 300, epoch: 3 | loss: 0.7186882
	speed: 0.0055s/iter; left time: 15.3236s
	iters: 400, epoch: 3 | loss: 0.7647512
	speed: 0.0045s/iter; left time: 11.9766s
	iters: 500, epoch: 3 | loss: 0.7212549
	speed: 0.0047s/iter; left time: 12.0998s
Updating learning rate to 0.0020720255121825532
Validation loss decreased (0.4034 --> 0.4023).  Saving model state dict ...
Epoch: 3 cost time: 2.420609712600708
Epoch: 3, Steps: 514 | Train Loss: 0.9003110 Vali Loss: 0.4023457 Best vali loss: 0.4023457

best validation loss 0.4023457184082633

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008179670954, 'e_layers': 3, 'learning_rate': 0.0001606491471, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 2.1931605
	speed: 0.0107s/iter; left time: 53.8086s
	iters: 200, epoch: 4 | loss: 0.2415710
	speed: 0.0038s/iter; left time: 18.6907s
	iters: 300, epoch: 4 | loss: 0.2571870
	speed: 0.0040s/iter; left time: 19.1288s
	iters: 400, epoch: 4 | loss: 0.2234409
	speed: 0.0045s/iter; left time: 21.3064s
	iters: 500, epoch: 4 | loss: 0.4755635
	speed: 0.0043s/iter; left time: 20.1160s
	iters: 600, epoch: 4 | loss: 0.5841007
	speed: 0.0044s/iter; left time: 19.8487s
	iters: 700, epoch: 4 | loss: 1.1777451
	speed: 0.0049s/iter; left time: 21.6406s
	iters: 800, epoch: 4 | loss: 0.3376923
	speed: 0.0047s/iter; left time: 20.4026s
	iters: 900, epoch: 4 | loss: 0.3330695
	speed: 0.0052s/iter; left time: 22.0788s
	iters: 1000, epoch: 4 | loss: 0.8536980
	speed: 0.0046s/iter; left time: 18.9075s
Updating learning rate to 2.00811433875e-05
Epoch: 4 cost time: 4.926080942153931
Epoch: 4, Steps: 1027 | Train Loss: 0.6677229 Vali Loss: 0.3730075 Best vali loss: 0.3643841
	iters: 100, epoch: 5 | loss: 0.8174509
	speed: 0.0122s/iter; left time: 48.7987s
	iters: 200, epoch: 5 | loss: 1.3795874
	speed: 0.0048s/iter; left time: 18.8842s
	iters: 300, epoch: 5 | loss: 0.4899280
	speed: 0.0046s/iter; left time: 17.4876s
	iters: 400, epoch: 5 | loss: 0.5924792
	speed: 0.0049s/iter; left time: 18.0697s
	iters: 500, epoch: 5 | loss: 0.5406688
	speed: 0.0049s/iter; left time: 17.7257s
	iters: 600, epoch: 5 | loss: 0.5716347
	speed: 0.0046s/iter; left time: 15.9865s
	iters: 700, epoch: 5 | loss: 1.6940687
	speed: 0.0050s/iter; left time: 16.9752s
	iters: 800, epoch: 5 | loss: 0.2701542
	speed: 0.0049s/iter; left time: 16.2170s
	iters: 900, epoch: 5 | loss: 0.5073562
	speed: 0.0045s/iter; left time: 14.4560s
	iters: 1000, epoch: 5 | loss: 0.4656138
	speed: 0.0042s/iter; left time: 12.9906s
Updating learning rate to 1.004057169375e-05
Epoch: 5 cost time: 4.883520841598511
Epoch: 5, Steps: 1027 | Train Loss: 0.7328942 Vali Loss: 0.3722689 Best vali loss: 0.3643841
	iters: 100, epoch: 6 | loss: 0.4317068
	speed: 0.0133s/iter; left time: 39.5158s
	iters: 200, epoch: 6 | loss: 1.0324886
	speed: 0.0047s/iter; left time: 13.4812s
	iters: 300, epoch: 6 | loss: 0.4004356
	speed: 0.0047s/iter; left time: 12.9778s
	iters: 400, epoch: 6 | loss: 0.4556713
	speed: 0.0046s/iter; left time: 12.4334s
	iters: 500, epoch: 6 | loss: 0.9383146
	speed: 0.0050s/iter; left time: 12.8113s
	iters: 600, epoch: 6 | loss: 0.3396773
	speed: 0.0046s/iter; left time: 11.3055s
	iters: 700, epoch: 6 | loss: 0.6812484
	speed: 0.0046s/iter; left time: 10.9678s
	iters: 800, epoch: 6 | loss: 0.2638940
	speed: 0.0045s/iter; left time: 10.3508s
	iters: 900, epoch: 6 | loss: 0.2509842
	speed: 0.0046s/iter; left time: 10.1013s
	iters: 1000, epoch: 6 | loss: 0.5608764
	speed: 0.0044s/iter; left time: 9.2438s
Updating learning rate to 5.020285846875e-06
Epoch: 6 cost time: 4.804466485977173
Epoch: 6, Steps: 1027 | Train Loss: 0.5355297 Vali Loss: 0.3738203 Best vali loss: 0.3643841
	iters: 100, epoch: 7 | loss: 0.8824016
	speed: 0.0132s/iter; left time: 25.9025s
	iters: 200, epoch: 7 | loss: 0.5448129
	speed: 0.0063s/iter; left time: 11.7224s
	iters: 300, epoch: 7 | loss: 0.4971515
	speed: 0.0063s/iter; left time: 11.1125s
	iters: 400, epoch: 7 | loss: 0.3971775
	speed: 0.0063s/iter; left time: 10.4640s
	iters: 500, epoch: 7 | loss: 0.3801876
	speed: 0.0063s/iter; left time: 9.8164s
	iters: 600, epoch: 7 | loss: 1.2452902
	speed: 0.0063s/iter; left time: 9.1832s
	iters: 700, epoch: 7 | loss: 0.2799870
	speed: 0.0063s/iter; left time: 8.5474s
	iters: 800, epoch: 7 | loss: 1.1272098
	speed: 0.0063s/iter; left time: 7.9220s
	iters: 900, epoch: 7 | loss: 0.9878491
	speed: 0.0063s/iter; left time: 7.3157s
	iters: 1000, epoch: 7 | loss: 0.3610643
	speed: 0.0063s/iter; left time: 6.6765s
Updating learning rate to 2.5101429234375e-06
Epoch: 7 cost time: 6.428153991699219
Epoch: 7, Steps: 1027 | Train Loss: 0.6703131 Vali Loss: 0.3734764 Best vali loss: 0.3643841
	iters: 100, epoch: 8 | loss: 0.8742073
	speed: 0.0159s/iter; left time: 14.7144s
	iters: 200, epoch: 8 | loss: 0.2213593
	speed: 0.0061s/iter; left time: 5.0713s
	iters: 300, epoch: 8 | loss: 0.6579839
	speed: 0.0064s/iter; left time: 4.6644s
	iters: 400, epoch: 8 | loss: 0.2790815
	speed: 0.0064s/iter; left time: 4.0496s
	iters: 500, epoch: 8 | loss: 1.9101989
	speed: 0.0064s/iter; left time: 3.3642s
	iters: 600, epoch: 8 | loss: 0.5068766
	speed: 0.0065s/iter; left time: 2.7770s
	iters: 700, epoch: 8 | loss: 0.3974512
	speed: 0.0065s/iter; left time: 2.1245s
	iters: 800, epoch: 8 | loss: 0.5824889
	speed: 0.0068s/iter; left time: 1.5483s
	iters: 900, epoch: 8 | loss: 0.2885255
	speed: 0.0066s/iter; left time: 0.8462s
	iters: 1000, epoch: 8 | loss: 0.7948261
	speed: 0.0059s/iter; left time: 0.1658s
Updating learning rate to 1.25507146171875e-06
Epoch: 8 cost time: 6.5584516525268555
Epoch: 8, Steps: 1027 | Train Loss: 0.6512999 Vali Loss: 0.3732675 Best vali loss: 0.3643841

best validation loss 0.36438405129670626

{'batch_size': 128, 'd_core': 256, 'd_model': 32, 'dropout': 0.00487546233, 'e_layers': 4, 'learning_rate': 0.0010291718456, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.000990001324593353
Validation loss decreased (inf --> 0.3798).  Saving model state dict ...
Epoch: 1 cost time: 0.8092265129089355
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3798129 Best vali loss: 0.3798129
Updating learning rate to 0.0008784531183150171
Validation loss decreased (0.3798 --> 0.3707).  Saving model state dict ...
Epoch: 2 cost time: 0.5646178722381592
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3706766 Best vali loss: 0.3706766
Updating learning rate to 0.000711509429983861
Epoch: 3 cost time: 0.565208911895752
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3732115 Best vali loss: 0.3706766
Updating learning rate to 0.0005145859228
Epoch: 4 cost time: 0.568572998046875
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3713239 Best vali loss: 0.3706766
Updating learning rate to 0.0003176624156161389
Validation loss decreased (0.3707 --> 0.3653).  Saving model state dict ...
Epoch: 5 cost time: 0.5797855854034424
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3652959 Best vali loss: 0.3652959
Updating learning rate to 0.00015071872728498277
Epoch: 6 cost time: 0.5766606330871582
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3673344 Best vali loss: 0.3652959
Updating learning rate to 3.917052100664691e-05
Epoch: 7 cost time: 0.6165976524353027
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3682027 Best vali loss: 0.3652959
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6325869560241699
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3687021 Best vali loss: 0.3652959

best validation loss 0.36529588898413307

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0010495657123, 'e_layers': 4, 'learning_rate': 0.0016632342935, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7796278
	speed: 0.0170s/iter; left time: 15.8953s
Updating learning rate to 0.0016632342935
Validation loss decreased (inf --> 0.3971).  Saving model state dict ...
Epoch: 1 cost time: 1.6996440887451172
Epoch: 1, Steps: 129 | Train Loss: 0.7796278 Vali Loss: 0.3971170 Best vali loss: 0.3971170
	iters: 100, epoch: 2 | loss: 0.5752845
	speed: 0.0170s/iter; left time: 13.6770s
Updating learning rate to 0.00083161714675
Epoch: 2 cost time: 1.3647401332855225
Epoch: 2, Steps: 129 | Train Loss: 0.5752845 Vali Loss: 0.3981634 Best vali loss: 0.3971170
	iters: 100, epoch: 3 | loss: 0.5310532
	speed: 0.0167s/iter; left time: 11.2760s
Updating learning rate to 0.000415808573375
Epoch: 3 cost time: 1.374779224395752
Epoch: 3, Steps: 129 | Train Loss: 0.5310532 Vali Loss: 0.4030970 Best vali loss: 0.3971170
	iters: 100, epoch: 4 | loss: 0.6681291
	speed: 0.0171s/iter; left time: 9.3327s
Updating learning rate to 0.0002079042866875
Epoch: 4 cost time: 1.4050261974334717
Epoch: 4, Steps: 129 | Train Loss: 0.6681291 Vali Loss: 0.4056825 Best vali loss: 0.3971170
	iters: 100, epoch: 5 | loss: 0.8899131
	speed: 0.0163s/iter; left time: 6.7925s
Updating learning rate to 0.00010395214334375
Epoch: 5 cost time: 1.3434104919433594
Epoch: 5, Steps: 129 | Train Loss: 0.8899131 Vali Loss: 0.4044207 Best vali loss: 0.3971170
	iters: 100, epoch: 6 | loss: 0.7038974
	speed: 0.0163s/iter; left time: 4.6912s
Updating learning rate to 5.1976071671875e-05
Epoch: 6 cost time: 1.335494041442871
Epoch: 6, Steps: 129 | Train Loss: 0.7038974 Vali Loss: 0.4038536 Best vali loss: 0.3971170
	iters: 100, epoch: 7 | loss: 0.6023157
	speed: 0.0172s/iter; left time: 2.7301s
Updating learning rate to 2.59880358359375e-05
Epoch: 7 cost time: 1.3824543952941895
Epoch: 7, Steps: 129 | Train Loss: 0.6023157 Vali Loss: 0.4035740 Best vali loss: 0.3971170
	iters: 100, epoch: 8 | loss: 0.8212730
	speed: 0.0167s/iter; left time: 0.4996s
Updating learning rate to 1.299401791796875e-05
Epoch: 8 cost time: 1.3929638862609863
Epoch: 8, Steps: 129 | Train Loss: 0.8212730 Vali Loss: 0.4038274 Best vali loss: 0.3971170

best validation loss 0.39711697676561203

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0099997540142, 'e_layers': 1, 'learning_rate': 0.0030308631648, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8210468
	speed: 0.0098s/iter; left time: 19.1011s
	iters: 200, epoch: 1 | loss: 1.3312179
	speed: 0.0038s/iter; left time: 7.0732s
Updating learning rate to 0.0029155078043005514
Validation loss decreased (inf --> 0.3783).  Saving model state dict ...
Epoch: 1 cost time: 1.2501826286315918
Epoch: 1, Steps: 257 | Train Loss: 1.0761324 Vali Loss: 0.3782681 Best vali loss: 0.3782681
	iters: 100, epoch: 2 | loss: 0.6954791
	speed: 0.0092s/iter; left time: 15.6162s
	iters: 200, epoch: 2 | loss: 0.8120640
	speed: 0.0041s/iter; left time: 6.5394s
Updating learning rate to 0.0025870035307393
Epoch: 2 cost time: 1.0435559749603271
Epoch: 2, Steps: 257 | Train Loss: 0.7537715 Vali Loss: 0.3889365 Best vali loss: 0.3782681
	iters: 100, epoch: 3 | loss: 1.0234115
	speed: 0.0104s/iter; left time: 14.9975s
	iters: 200, epoch: 3 | loss: 0.5002027
	speed: 0.0038s/iter; left time: 5.0748s
Updating learning rate to 0.0020953621418672913
Epoch: 3 cost time: 1.0938446521759033
Epoch: 3, Steps: 257 | Train Loss: 0.7618071 Vali Loss: 0.3927906 Best vali loss: 0.3782681

best validation loss 0.37826812352787537

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0026411680255, 'e_layers': 1, 'learning_rate': 0.0015330488365, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4131677
	speed: 0.0101s/iter; left time: 19.7991s
	iters: 200, epoch: 1 | loss: 0.5679290
	speed: 0.0037s/iter; left time: 6.9232s
Updating learning rate to 0.0014747006394412961
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 1.2841155529022217
Epoch: 1, Steps: 257 | Train Loss: 0.4905483 Vali Loss: 0.3685175 Best vali loss: 0.3685175
	iters: 100, epoch: 2 | loss: 0.6551247
	speed: 0.0093s/iter; left time: 15.8724s
	iters: 200, epoch: 2 | loss: 0.4549292
	speed: 0.0044s/iter; left time: 7.0486s
Updating learning rate to 0.0013085390323396484
Epoch: 2 cost time: 1.1084270477294922
Epoch: 2, Steps: 257 | Train Loss: 0.5550269 Vali Loss: 0.3686492 Best vali loss: 0.3685175
	iters: 100, epoch: 3 | loss: 0.7202486
	speed: 0.0093s/iter; left time: 13.3983s
	iters: 200, epoch: 3 | loss: 0.7246639
	speed: 0.0037s/iter; left time: 5.0331s
Updating learning rate to 0.0010598606136175638
Epoch: 3 cost time: 0.9993085861206055
Epoch: 3, Steps: 257 | Train Loss: 0.7224563 Vali Loss: 0.3728401 Best vali loss: 0.3685175

best validation loss 0.36851754063239034

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0074460408096, 'e_layers': 2, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6979148
	speed: 0.0122s/iter; left time: 23.9603s
	iters: 200, epoch: 1 | loss: 0.6485643
	speed: 0.0053s/iter; left time: 9.9318s
Updating learning rate to 0.0027349231343
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 1.7515616416931152
Epoch: 1, Steps: 257 | Train Loss: 0.6732395 Vali Loss: 0.3744416 Best vali loss: 0.3744416
	iters: 100, epoch: 2 | loss: 0.4281993
	speed: 0.0130s/iter; left time: 22.1202s
	iters: 200, epoch: 2 | loss: 0.3721245
	speed: 0.0060s/iter; left time: 9.6759s
Updating learning rate to 0.00136746156715
Epoch: 2 cost time: 1.601651906967163
Epoch: 2, Steps: 257 | Train Loss: 0.4001619 Vali Loss: 0.3834360 Best vali loss: 0.3744416
	iters: 100, epoch: 3 | loss: 0.6036187
	speed: 0.0131s/iter; left time: 18.8569s
	iters: 200, epoch: 3 | loss: 0.6638579
	speed: 0.0061s/iter; left time: 8.1548s
Updating learning rate to 0.000683730783575
Validation loss decreased (0.3744 --> 0.3664).  Saving model state dict ...
Epoch: 3 cost time: 1.593923807144165
Epoch: 3, Steps: 257 | Train Loss: 0.6337383 Vali Loss: 0.3663753 Best vali loss: 0.3663753

best validation loss 0.36637525860593456

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0074460408096, 'e_layers': 2, 'learning_rate': 0.0027349231343, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6383196
	speed: 0.0116s/iter; left time: 13.7028s
	iters: 200, epoch: 4 | loss: 0.4768554
	speed: 0.0054s/iter; left time: 5.8325s
Updating learning rate to 0.0003418653917875
Epoch: 4 cost time: 1.647005558013916
Epoch: 4, Steps: 257 | Train Loss: 0.5575875 Vali Loss: 0.3868222 Best vali loss: 0.3663753
	iters: 100, epoch: 5 | loss: 0.3474341
	speed: 0.0127s/iter; left time: 11.8157s
	iters: 200, epoch: 5 | loss: 0.3357990
	speed: 0.0061s/iter; left time: 5.0542s
Updating learning rate to 0.00017093269589375
Epoch: 5 cost time: 1.624934196472168
Epoch: 5, Steps: 257 | Train Loss: 0.3416165 Vali Loss: 0.3951708 Best vali loss: 0.3663753
	iters: 100, epoch: 6 | loss: 0.5637758
	speed: 0.0131s/iter; left time: 8.7738s
	iters: 200, epoch: 6 | loss: 0.4865955
	speed: 0.0060s/iter; left time: 3.4085s
Updating learning rate to 8.5466347946875e-05
Epoch: 6 cost time: 1.5939490795135498
Epoch: 6, Steps: 257 | Train Loss: 0.5251856 Vali Loss: 0.4045697 Best vali loss: 0.3663753
	iters: 100, epoch: 7 | loss: 0.3379499
	speed: 0.0118s/iter; left time: 4.9159s
	iters: 200, epoch: 7 | loss: 1.0187604
	speed: 0.0032s/iter; left time: 1.0044s
Updating learning rate to 4.27331739734375e-05
Epoch: 7 cost time: 1.0567615032196045
Epoch: 7, Steps: 257 | Train Loss: 0.6783552 Vali Loss: 0.4085894 Best vali loss: 0.3663753
	iters: 100, epoch: 8 | loss: 0.5681747
	speed: 0.0099s/iter; left time: 1.5650s
	iters: 200, epoch: 8 | loss: 0.4026238
	speed: 0.0054s/iter; left time: 0.3120s
Updating learning rate to 2.136658698671875e-05
Epoch: 8 cost time: 1.408383846282959
Epoch: 8, Steps: 257 | Train Loss: 0.4853992 Vali Loss: 0.4071356 Best vali loss: 0.3663753

best validation loss 0.36637525860593456

{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0011667363616, 'e_layers': 4, 'learning_rate': 0.0008608226971, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2133594
	speed: 0.0119s/iter; left time: 96.9848s
	iters: 200, epoch: 1 | loss: 0.3312485
	speed: 0.0054s/iter; left time: 43.2464s
	iters: 300, epoch: 1 | loss: 0.6204459
	speed: 0.0061s/iter; left time: 48.4689s
	iters: 400, epoch: 1 | loss: 0.4410456
	speed: 0.0051s/iter; left time: 40.1880s
	iters: 500, epoch: 1 | loss: 1.2811334
	speed: 0.0055s/iter; left time: 42.3992s
	iters: 600, epoch: 1 | loss: 0.3666090
	speed: 0.0052s/iter; left time: 39.9261s
	iters: 700, epoch: 1 | loss: 0.4081997
	speed: 0.0055s/iter; left time: 41.5745s
	iters: 800, epoch: 1 | loss: 2.5589962
	speed: 0.0056s/iter; left time: 41.4780s
	iters: 900, epoch: 1 | loss: 1.0849433
	speed: 0.0057s/iter; left time: 41.4759s
	iters: 1000, epoch: 1 | loss: 0.2522794
	speed: 0.0056s/iter; left time: 40.6186s
Updating learning rate to 0.0008280595840359265
Validation loss decreased (inf --> 0.3980).  Saving model state dict ...
Epoch: 1 cost time: 5.9771013259887695
Epoch: 1, Steps: 1027 | Train Loss: 0.8558260 Vali Loss: 0.3979684 Best vali loss: 0.3979684
	iters: 100, epoch: 2 | loss: 1.8946410
	speed: 0.0162s/iter; left time: 114.7025s
	iters: 200, epoch: 2 | loss: 0.7166147
	speed: 0.0053s/iter; left time: 36.8243s
	iters: 300, epoch: 2 | loss: 0.5373486
	speed: 0.0051s/iter; left time: 34.8295s
	iters: 400, epoch: 2 | loss: 0.3100595
	speed: 0.0054s/iter; left time: 36.7464s
	iters: 500, epoch: 2 | loss: 1.4722987
	speed: 0.0053s/iter; left time: 35.7014s
	iters: 600, epoch: 2 | loss: 0.2729010
	speed: 0.0058s/iter; left time: 38.1502s
	iters: 700, epoch: 2 | loss: 0.6105666
	speed: 0.0055s/iter; left time: 35.4280s
	iters: 800, epoch: 2 | loss: 0.8742173
	speed: 0.0058s/iter; left time: 37.2054s
	iters: 900, epoch: 2 | loss: 0.7967748
	speed: 0.0048s/iter; left time: 30.2305s
	iters: 1000, epoch: 2 | loss: 0.4734552
	speed: 0.0047s/iter; left time: 29.3212s
Updating learning rate to 0.0007347581318093517
Epoch: 2 cost time: 5.501338243484497
Epoch: 2, Steps: 1027 | Train Loss: 0.7958877 Vali Loss: 0.4091900 Best vali loss: 0.3979684
	iters: 100, epoch: 3 | loss: 1.2959107
	speed: 0.0161s/iter; left time: 97.7644s
	iters: 200, epoch: 3 | loss: 1.1591461
	speed: 0.0057s/iter; left time: 33.7304s
	iters: 300, epoch: 3 | loss: 0.3043244
	speed: 0.0050s/iter; left time: 29.1829s
	iters: 400, epoch: 3 | loss: 0.3381128
	speed: 0.0048s/iter; left time: 27.7900s
	iters: 500, epoch: 3 | loss: 1.0573028
	speed: 0.0063s/iter; left time: 35.8520s
	iters: 600, epoch: 3 | loss: 0.9397005
	speed: 0.0067s/iter; left time: 37.4875s
	iters: 700, epoch: 3 | loss: 0.2697714
	speed: 0.0065s/iter; left time: 35.5487s
	iters: 800, epoch: 3 | loss: 1.0442116
	speed: 0.0049s/iter; left time: 26.1619s
	iters: 900, epoch: 3 | loss: 1.1658292
	speed: 0.0056s/iter; left time: 29.3526s
	iters: 1000, epoch: 3 | loss: 0.3750031
	speed: 0.0056s/iter; left time: 28.8542s
Updating learning rate to 0.000595122640742001
Epoch: 3 cost time: 5.904718399047852
Epoch: 3, Steps: 1027 | Train Loss: 0.7949313 Vali Loss: 0.4106223 Best vali loss: 0.3979684
	iters: 100, epoch: 4 | loss: 0.6339030
	speed: 0.0160s/iter; left time: 80.7214s
	iters: 200, epoch: 4 | loss: 0.6929750
	speed: 0.0058s/iter; left time: 28.5406s
	iters: 300, epoch: 4 | loss: 0.3096729
	speed: 0.0063s/iter; left time: 30.6811s
	iters: 400, epoch: 4 | loss: 1.0541645
	speed: 0.0048s/iter; left time: 22.6934s
	iters: 500, epoch: 4 | loss: 0.2903427
	speed: 0.0057s/iter; left time: 26.5323s
	iters: 600, epoch: 4 | loss: 1.1039723
	speed: 0.0072s/iter; left time: 32.6635s
	iters: 700, epoch: 4 | loss: 0.6262146
	speed: 0.0071s/iter; left time: 31.7056s
	iters: 800, epoch: 4 | loss: 0.5911962
	speed: 0.0069s/iter; left time: 29.9403s
	iters: 900, epoch: 4 | loss: 2.1978934
	speed: 0.0069s/iter; left time: 29.2411s
	iters: 1000, epoch: 4 | loss: 0.3794014
	speed: 0.0071s/iter; left time: 29.2191s
Updating learning rate to 0.00043041134855
Epoch: 4 cost time: 6.615905046463013
Epoch: 4, Steps: 1027 | Train Loss: 0.7879736 Vali Loss: 0.4049089 Best vali loss: 0.3979684
	iters: 100, epoch: 5 | loss: 0.3032336
	speed: 0.0198s/iter; left time: 79.2239s
	iters: 200, epoch: 5 | loss: 1.0351828
	speed: 0.0048s/iter; left time: 18.9195s
	iters: 300, epoch: 5 | loss: 0.6091805
	speed: 0.0051s/iter; left time: 19.5164s
	iters: 400, epoch: 5 | loss: 0.4843778
	speed: 0.0065s/iter; left time: 23.9824s
	iters: 500, epoch: 5 | loss: 0.9682723
	speed: 0.0065s/iter; left time: 23.4470s
	iters: 600, epoch: 5 | loss: 0.4137788
	speed: 0.0065s/iter; left time: 22.7353s
	iters: 700, epoch: 5 | loss: 0.4965014
	speed: 0.0064s/iter; left time: 21.9249s
	iters: 800, epoch: 5 | loss: 1.1388334
	speed: 0.0059s/iter; left time: 19.6614s
	iters: 900, epoch: 5 | loss: 0.2758719
	speed: 0.0063s/iter; left time: 20.3163s
	iters: 1000, epoch: 5 | loss: 0.3157507
	speed: 0.0065s/iter; left time: 20.2473s
Updating learning rate to 0.000265700056357999
Epoch: 5 cost time: 6.4214026927948
Epoch: 5, Steps: 1027 | Train Loss: 0.6040983 Vali Loss: 0.4004122 Best vali loss: 0.3979684
	iters: 100, epoch: 6 | loss: 0.8170431
	speed: 0.0178s/iter; left time: 53.0185s
	iters: 200, epoch: 6 | loss: 0.2488423
	speed: 0.0063s/iter; left time: 18.0387s
	iters: 300, epoch: 6 | loss: 1.4017152
	speed: 0.0067s/iter; left time: 18.5397s
	iters: 400, epoch: 6 | loss: 1.8098468
	speed: 0.0066s/iter; left time: 17.7427s
	iters: 500, epoch: 6 | loss: 0.9460365
	speed: 0.0065s/iter; left time: 16.7041s
	iters: 600, epoch: 6 | loss: 0.6927258
	speed: 0.0064s/iter; left time: 15.8741s
	iters: 700, epoch: 6 | loss: 0.3389304
	speed: 0.0058s/iter; left time: 13.7277s
	iters: 800, epoch: 6 | loss: 0.4256868
	speed: 0.0062s/iter; left time: 14.1305s
	iters: 900, epoch: 6 | loss: 0.3124047
	speed: 0.0062s/iter; left time: 13.4901s
	iters: 1000, epoch: 6 | loss: 0.3093155
	speed: 0.0062s/iter; left time: 12.8454s
Updating learning rate to 0.00012606456529064833
Epoch: 6 cost time: 6.505309581756592
Epoch: 6, Steps: 1027 | Train Loss: 0.7302547 Vali Loss: 0.4027681 Best vali loss: 0.3979684
	iters: 100, epoch: 7 | loss: 0.5991958
	speed: 0.0174s/iter; left time: 33.9970s
	iters: 200, epoch: 7 | loss: 0.3527550
	speed: 0.0064s/iter; left time: 11.8378s
	iters: 300, epoch: 7 | loss: 0.5049477
	speed: 0.0062s/iter; left time: 10.9090s
	iters: 400, epoch: 7 | loss: 1.0294520
	speed: 0.0062s/iter; left time: 10.2285s
	iters: 500, epoch: 7 | loss: 0.5207728
	speed: 0.0062s/iter; left time: 9.6830s
	iters: 600, epoch: 7 | loss: 1.2830389
	speed: 0.0061s/iter; left time: 8.8916s
	iters: 700, epoch: 7 | loss: 1.0181483
	speed: 0.0066s/iter; left time: 8.8909s
	iters: 800, epoch: 7 | loss: 1.4722819
	speed: 0.0066s/iter; left time: 8.2520s
	iters: 900, epoch: 7 | loss: 1.3503407
	speed: 0.0066s/iter; left time: 7.5902s
	iters: 1000, epoch: 7 | loss: 0.5494811
	speed: 0.0064s/iter; left time: 6.7929s
Updating learning rate to 3.276311306407351e-05
Epoch: 7 cost time: 6.595170021057129
Epoch: 7, Steps: 1027 | Train Loss: 0.8680414 Vali Loss: 0.4037988 Best vali loss: 0.3979684
	iters: 100, epoch: 8 | loss: 0.3412344
	speed: 0.0184s/iter; left time: 17.0306s
	iters: 200, epoch: 8 | loss: 0.9230876
	speed: 0.0065s/iter; left time: 5.4206s
	iters: 300, epoch: 8 | loss: 1.3351476
	speed: 0.0062s/iter; left time: 4.4978s
	iters: 400, epoch: 8 | loss: 0.2285852
	speed: 0.0061s/iter; left time: 3.8274s
	iters: 500, epoch: 8 | loss: 0.5716757
	speed: 0.0064s/iter; left time: 3.4002s
	iters: 600, epoch: 8 | loss: 0.2945987
	speed: 0.0063s/iter; left time: 2.6947s
	iters: 700, epoch: 8 | loss: 0.5241274
	speed: 0.0064s/iter; left time: 2.0883s
	iters: 800, epoch: 8 | loss: 0.3415159
	speed: 0.0063s/iter; left time: 1.4430s
	iters: 900, epoch: 8 | loss: 0.7913831
	speed: 0.0059s/iter; left time: 0.7610s
	iters: 1000, epoch: 8 | loss: 0.4506319
	speed: 0.0049s/iter; left time: 0.1382s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.360608100891113
Epoch: 8, Steps: 1027 | Train Loss: 0.5801987 Vali Loss: 0.4036685 Best vali loss: 0.3979684

best validation loss 0.39796837711146865

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0009946628485, 'e_layers': 1, 'learning_rate': 0.0001665995443, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9615987
	speed: 0.0104s/iter; left time: 20.3680s
	iters: 200, epoch: 1 | loss: 0.6801028
	speed: 0.0036s/iter; left time: 6.6489s
Updating learning rate to 0.0001665995443
Validation loss decreased (inf --> 0.4040).  Saving model state dict ...
Epoch: 1 cost time: 1.2702422142028809
Epoch: 1, Steps: 257 | Train Loss: 0.8208507 Vali Loss: 0.4039874 Best vali loss: 0.4039874
	iters: 100, epoch: 2 | loss: 0.9949159
	speed: 0.0101s/iter; left time: 17.1902s
	iters: 200, epoch: 2 | loss: 0.9838483
	speed: 0.0036s/iter; left time: 5.7344s
Updating learning rate to 8.329977215e-05
Validation loss decreased (0.4040 --> 0.3845).  Saving model state dict ...
Epoch: 2 cost time: 0.9589381217956543
Epoch: 2, Steps: 257 | Train Loss: 0.9893821 Vali Loss: 0.3844607 Best vali loss: 0.3844607
	iters: 100, epoch: 3 | loss: 0.4720563
	speed: 0.0068s/iter; left time: 9.8399s
	iters: 200, epoch: 3 | loss: 0.7231299
	speed: 0.0031s/iter; left time: 4.2120s
Updating learning rate to 4.1649886075e-05
Validation loss decreased (0.3845 --> 0.3780).  Saving model state dict ...
Epoch: 3 cost time: 0.8998689651489258
Epoch: 3, Steps: 257 | Train Loss: 0.5975931 Vali Loss: 0.3779556 Best vali loss: 0.3779556
	iters: 100, epoch: 4 | loss: 0.5416805
	speed: 0.0106s/iter; left time: 12.5440s
	iters: 200, epoch: 4 | loss: 0.8221446
	speed: 0.0038s/iter; left time: 4.1317s
Updating learning rate to 2.08249430375e-05
Validation loss decreased (0.3780 --> 0.3755).  Saving model state dict ...
Epoch: 4 cost time: 1.0797419548034668
Epoch: 4, Steps: 257 | Train Loss: 0.6819125 Vali Loss: 0.3754775 Best vali loss: 0.3754775
	iters: 100, epoch: 5 | loss: 0.9696310
	speed: 0.0098s/iter; left time: 9.1423s
	iters: 200, epoch: 5 | loss: 1.1248407
	speed: 0.0040s/iter; left time: 3.3019s
Updating learning rate to 1.041247151875e-05
Validation loss decreased (0.3755 --> 0.3745).  Saving model state dict ...
Epoch: 5 cost time: 1.0772759914398193
Epoch: 5, Steps: 257 | Train Loss: 1.0472359 Vali Loss: 0.3744582 Best vali loss: 0.3744582
	iters: 100, epoch: 6 | loss: 0.4103142
	speed: 0.0101s/iter; left time: 6.7882s
	iters: 200, epoch: 6 | loss: 0.6943222
	speed: 0.0027s/iter; left time: 1.5438s
Updating learning rate to 5.206235759375e-06
Validation loss decreased (0.3745 --> 0.3739).  Saving model state dict ...
Epoch: 6 cost time: 0.8799517154693604
Epoch: 6, Steps: 257 | Train Loss: 0.5523182 Vali Loss: 0.3739340 Best vali loss: 0.3739340
	iters: 100, epoch: 7 | loss: 0.4518370
	speed: 0.0075s/iter; left time: 3.1164s
	iters: 200, epoch: 7 | loss: 0.5981523
	speed: 0.0039s/iter; left time: 1.2227s
Updating learning rate to 2.6031178796875e-06
Validation loss decreased (0.3739 --> 0.3737).  Saving model state dict ...
Epoch: 7 cost time: 0.9852802753448486
Epoch: 7, Steps: 257 | Train Loss: 0.5249946 Vali Loss: 0.3736959 Best vali loss: 0.3736959
	iters: 100, epoch: 8 | loss: 0.6790547
	speed: 0.0095s/iter; left time: 1.5006s
	iters: 200, epoch: 8 | loss: 0.4615732
	speed: 0.0037s/iter; left time: 0.2149s
Updating learning rate to 1.30155893984375e-06
Validation loss decreased (0.3737 --> 0.3736).  Saving model state dict ...
Epoch: 8 cost time: 1.019648790359497
Epoch: 8, Steps: 257 | Train Loss: 0.5703140 Vali Loss: 0.3735785 Best vali loss: 0.3735785

best validation loss 0.3735784740368369

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6246635
	speed: 0.0128s/iter; left time: 11.9109s
Updating learning rate to 0.0004822150100733569
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 1.152839183807373
Epoch: 1, Steps: 129 | Train Loss: 0.6246635 Vali Loss: 0.3844570 Best vali loss: 0.3844570
	iters: 100, epoch: 2 | loss: 0.4994369
	speed: 0.0094s/iter; left time: 7.5697s
Updating learning rate to 0.000427881527806283
Validation loss decreased (0.3845 --> 0.3699).  Saving model state dict ...
Epoch: 2 cost time: 0.61102294921875
Epoch: 2, Steps: 129 | Train Loss: 0.4994369 Vali Loss: 0.3699169 Best vali loss: 0.3699169
	iters: 100, epoch: 3 | loss: 0.5607639
	speed: 0.0096s/iter; left time: 6.4693s
Updating learning rate to 0.00034656572513969705
Validation loss decreased (0.3699 --> 0.3690).  Saving model state dict ...
Epoch: 3 cost time: 0.8544590473175049
Epoch: 3, Steps: 129 | Train Loss: 0.5607639 Vali Loss: 0.3689635 Best vali loss: 0.3689635

best validation loss 0.36896351415422435

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0061589744518, 'e_layers': 1, 'learning_rate': 0.003977029424, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5269165
	speed: 0.0110s/iter; left time: 10.2486s
Updating learning rate to 0.003977029424
Validation loss decreased (inf --> 0.4037).  Saving model state dict ...
Epoch: 1 cost time: 0.9376099109649658
Epoch: 1, Steps: 129 | Train Loss: 0.5269165 Vali Loss: 0.4037393 Best vali loss: 0.4037393
	iters: 100, epoch: 2 | loss: 0.4874992
	speed: 0.0088s/iter; left time: 7.0353s
Updating learning rate to 0.001988514712
Validation loss decreased (0.4037 --> 0.3727).  Saving model state dict ...
Epoch: 2 cost time: 0.6698837280273438
Epoch: 2, Steps: 129 | Train Loss: 0.4874992 Vali Loss: 0.3726630 Best vali loss: 0.3726630
	iters: 100, epoch: 3 | loss: 0.5087347
	speed: 0.0091s/iter; left time: 6.1149s
Updating learning rate to 0.000994257356
Epoch: 3 cost time: 0.673612117767334
Epoch: 3, Steps: 129 | Train Loss: 0.5087347 Vali Loss: 0.3732055 Best vali loss: 0.3726630

best validation loss 0.37266297853297475

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0029805711624, 'e_layers': 3, 'learning_rate': 0.0023564983436, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0022668094658243945
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 0.8111457824707031
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3707770 Best vali loss: 0.3707770
Updating learning rate to 0.0020113971511072134
Validation loss decreased (0.3708 --> 0.3693).  Saving model state dict ...
Epoch: 2 cost time: 0.41679859161376953
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3693330 Best vali loss: 0.3693330
Updating learning rate to 0.0016291456090457483
Epoch: 3 cost time: 0.4167637825012207
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3729523 Best vali loss: 0.3693330

best validation loss 0.36933298154289457

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0014121922571, 'e_layers': 2, 'learning_rate': 0.0005012943918, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5976460
	speed: 0.0116s/iter; left time: 6.3319s
Updating learning rate to 0.0002506471959
Epoch: 4 cost time: 1.044663906097412
Epoch: 4, Steps: 129 | Train Loss: 0.5976460 Vali Loss: 0.3738450 Best vali loss: 0.3689635
	iters: 100, epoch: 5 | loss: 0.4524490
	speed: 0.0100s/iter; left time: 4.1565s
Updating learning rate to 0.00015472866666030294
Epoch: 5 cost time: 0.7596430778503418
Epoch: 5, Steps: 129 | Train Loss: 0.4524490 Vali Loss: 0.3695676 Best vali loss: 0.3689635
	iters: 100, epoch: 6 | loss: 0.5410491
	speed: 0.0097s/iter; left time: 2.7971s
Updating learning rate to 7.3412863993717e-05
Validation loss decreased (0.3690 --> 0.3677).  Saving model state dict ...
Epoch: 6 cost time: 0.7770113945007324
Epoch: 6, Steps: 129 | Train Loss: 0.5410491 Vali Loss: 0.3677387 Best vali loss: 0.3677387
	iters: 100, epoch: 7 | loss: 0.7364757
	speed: 0.0099s/iter; left time: 1.5766s
Updating learning rate to 1.9079381726643094e-05
Epoch: 7 cost time: 0.757500410079956
Epoch: 7, Steps: 129 | Train Loss: 0.7364757 Vali Loss: 0.3688118 Best vali loss: 0.3677387
	iters: 100, epoch: 8 | loss: 0.6904591
	speed: 0.0098s/iter; left time: 0.2944s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.7340259552001953
Epoch: 8, Steps: 129 | Train Loss: 0.6904591 Vali Loss: 0.3686179 Best vali loss: 0.3677387

best validation loss 0.3677386773944135

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0021061195851, 'e_layers': 4, 'learning_rate': 0.003460388698, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.003460388698
Validation loss decreased (inf --> 0.3845).  Saving model state dict ...
Epoch: 1 cost time: 0.8260359764099121
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3844688 Best vali loss: 0.3844688
Updating learning rate to 0.001730194349
Epoch: 2 cost time: 0.5619595050811768
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4058929 Best vali loss: 0.3844688
Updating learning rate to 0.0008650971745
Epoch: 3 cost time: 0.5439257621765137
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3933706 Best vali loss: 0.3844688
Updating learning rate to 0.00043254858725
Epoch: 4 cost time: 0.5705890655517578
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3976594 Best vali loss: 0.3844688
Updating learning rate to 0.000216274293625
Epoch: 5 cost time: 0.5514371395111084
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3955933 Best vali loss: 0.3844688
Updating learning rate to 0.0001081371468125
Epoch: 6 cost time: 0.5739986896514893
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4012091 Best vali loss: 0.3844688
Updating learning rate to 5.406857340625e-05
Epoch: 7 cost time: 0.5454127788543701
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3979748 Best vali loss: 0.3844688
Updating learning rate to 2.7034286703125e-05
Epoch: 8 cost time: 0.7206516265869141
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3974680 Best vali loss: 0.3844688

best validation loss 0.38446880809684636

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0056630894833, 'e_layers': 3, 'learning_rate': 0.0021883583663, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3081154
	speed: 0.0120s/iter; left time: 47.9889s
	iters: 200, epoch: 1 | loss: 0.6119934
	speed: 0.0056s/iter; left time: 22.0387s
	iters: 300, epoch: 1 | loss: 1.0074450
	speed: 0.0061s/iter; left time: 23.2417s
	iters: 400, epoch: 1 | loss: 0.9982314
	speed: 0.0056s/iter; left time: 20.6708s
	iters: 500, epoch: 1 | loss: 0.7679540
	speed: 0.0059s/iter; left time: 21.3962s
Updating learning rate to 0.0021050689353622034
Validation loss decreased (inf --> 0.4131).  Saving model state dict ...
Epoch: 1 cost time: 3.344695806503296
Epoch: 1, Steps: 514 | Train Loss: 0.9387478 Vali Loss: 0.4130820 Best vali loss: 0.4130820
	iters: 100, epoch: 2 | loss: 0.6393794
	speed: 0.0137s/iter; left time: 47.7941s
	iters: 200, epoch: 2 | loss: 0.7981146
	speed: 0.0057s/iter; left time: 19.2993s
	iters: 300, epoch: 2 | loss: 0.5488192
	speed: 0.0059s/iter; left time: 19.3215s
	iters: 400, epoch: 2 | loss: 0.6536599
	speed: 0.0059s/iter; left time: 18.9225s
	iters: 500, epoch: 2 | loss: 0.5555767
	speed: 0.0058s/iter; left time: 18.0438s
Updating learning rate to 0.0018678807033885223
Validation loss decreased (0.4131 --> 0.4035).  Saving model state dict ...
Epoch: 2 cost time: 3.0727317333221436
Epoch: 2, Steps: 514 | Train Loss: 0.6391100 Vali Loss: 0.4035101 Best vali loss: 0.4035101
	iters: 100, epoch: 3 | loss: 0.5260739
	speed: 0.0136s/iter; left time: 40.4752s
	iters: 200, epoch: 3 | loss: 0.5090159
	speed: 0.0061s/iter; left time: 17.5259s
	iters: 300, epoch: 3 | loss: 0.8366523
	speed: 0.0060s/iter; left time: 16.6356s
	iters: 400, epoch: 3 | loss: 0.4948844
	speed: 0.0058s/iter; left time: 15.6228s
	iters: 500, epoch: 3 | loss: 0.5460937
	speed: 0.0061s/iter; left time: 15.7393s
Updating learning rate to 0.0015129034285802723
Epoch: 3 cost time: 3.125417947769165
Epoch: 3, Steps: 514 | Train Loss: 0.5825440 Vali Loss: 0.4040943 Best vali loss: 0.4035101
	iters: 100, epoch: 4 | loss: 0.7342225
	speed: 0.0132s/iter; left time: 32.7182s
	iters: 200, epoch: 4 | loss: 1.0414203
	speed: 0.0062s/iter; left time: 14.6961s
	iters: 300, epoch: 4 | loss: 0.5653099
	speed: 0.0056s/iter; left time: 12.7293s
	iters: 400, epoch: 4 | loss: 0.4033941
	speed: 0.0059s/iter; left time: 12.7405s
	iters: 500, epoch: 4 | loss: 0.4727237
	speed: 0.0057s/iter; left time: 11.8301s
Updating learning rate to 0.00109417918315
Validation loss decreased (0.4035 --> 0.3992).  Saving model state dict ...
Epoch: 4 cost time: 3.074305534362793
Epoch: 4, Steps: 514 | Train Loss: 0.6434141 Vali Loss: 0.3991650 Best vali loss: 0.3991650
	iters: 100, epoch: 5 | loss: 1.2924576
	speed: 0.0134s/iter; left time: 26.2887s
	iters: 200, epoch: 5 | loss: 0.4501252
	speed: 0.0055s/iter; left time: 10.2705s
	iters: 300, epoch: 5 | loss: 0.3376121
	speed: 0.0063s/iter; left time: 11.0002s
	iters: 400, epoch: 5 | loss: 0.4302447
	speed: 0.0059s/iter; left time: 9.7620s
	iters: 500, epoch: 5 | loss: 2.4022622
	speed: 0.0059s/iter; left time: 9.1409s
Updating learning rate to 0.0006754549377197279
Epoch: 5 cost time: 3.08894944190979
Epoch: 5, Steps: 514 | Train Loss: 0.9825404 Vali Loss: 0.4002454 Best vali loss: 0.3991650
	iters: 100, epoch: 6 | loss: 0.4121705
	speed: 0.0130s/iter; left time: 18.7140s
	iters: 200, epoch: 6 | loss: 0.5942172
	speed: 0.0059s/iter; left time: 7.9076s
	iters: 300, epoch: 6 | loss: 0.6646960
	speed: 0.0058s/iter; left time: 7.1983s
	iters: 400, epoch: 6 | loss: 0.7914377
	speed: 0.0059s/iter; left time: 6.7981s
	iters: 500, epoch: 6 | loss: 1.1644590
	speed: 0.0057s/iter; left time: 5.9713s
Updating learning rate to 0.0003204776629114777
Validation loss decreased (0.3992 --> 0.3979).  Saving model state dict ...
Epoch: 6 cost time: 3.031442403793335
Epoch: 6, Steps: 514 | Train Loss: 0.7253961 Vali Loss: 0.3979416 Best vali loss: 0.3979416
	iters: 100, epoch: 7 | loss: 0.5739316
	speed: 0.0132s/iter; left time: 12.2450s
	iters: 200, epoch: 7 | loss: 1.1573416
	speed: 0.0060s/iter; left time: 4.9620s
	iters: 300, epoch: 7 | loss: 1.1513072
	speed: 0.0059s/iter; left time: 4.2651s
	iters: 400, epoch: 7 | loss: 0.4307177
	speed: 0.0058s/iter; left time: 3.6422s
	iters: 500, epoch: 7 | loss: 0.8746254
	speed: 0.0059s/iter; left time: 3.1274s
Updating learning rate to 8.32894309377964e-05
Epoch: 7 cost time: 3.066547155380249
Epoch: 7, Steps: 514 | Train Loss: 0.8375847 Vali Loss: 0.3996202 Best vali loss: 0.3979416
	iters: 100, epoch: 8 | loss: 0.7772681
	speed: 0.0133s/iter; left time: 5.5289s
	iters: 200, epoch: 8 | loss: 0.9427531
	speed: 0.0058s/iter; left time: 1.8232s
	iters: 300, epoch: 8 | loss: 0.4548696
	speed: 0.0060s/iter; left time: 1.2820s
	iters: 400, epoch: 8 | loss: 0.5814599
	speed: 0.0058s/iter; left time: 0.6697s
	iters: 500, epoch: 8 | loss: 0.4799758
	speed: 0.0058s/iter; left time: 0.0870s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.060241222381592
Epoch: 8, Steps: 514 | Train Loss: 0.6472653 Vali Loss: 0.4011652 Best vali loss: 0.3979416

best validation loss 0.39794159337204893

{'batch_size': 64, 'd_core': 512, 'd_model': 64, 'dropout': 0.0008377038747, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6316838
	speed: 0.0138s/iter; left time: 12.8363s
Updating learning rate to 0.0002742177349779177
Validation loss decreased (inf --> 0.3780).  Saving model state dict ...
Epoch: 1 cost time: 1.3388075828552246
Epoch: 1, Steps: 129 | Train Loss: 0.6316838 Vali Loss: 0.3779578 Best vali loss: 0.3779578
	iters: 100, epoch: 2 | loss: 0.6853485
	speed: 0.0129s/iter; left time: 10.3583s
Updating learning rate to 0.00024332030513956964
Validation loss decreased (0.3780 --> 0.3736).  Saving model state dict ...
Epoch: 2 cost time: 1.011385440826416
Epoch: 2, Steps: 129 | Train Loss: 0.6853485 Vali Loss: 0.3735902 Best vali loss: 0.3735902
	iters: 100, epoch: 3 | loss: 0.6709024
	speed: 0.0099s/iter; left time: 6.6851s
Updating learning rate to 0.00019707903359194527
Epoch: 3 cost time: 0.877086877822876
Epoch: 3, Steps: 129 | Train Loss: 0.6709024 Vali Loss: 0.3770293 Best vali loss: 0.3735902

best validation loss 0.37359020085840655

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.0028867448881, 'e_layers': 4, 'learning_rate': 0.0003383725477, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7953424
	speed: 0.0131s/iter; left time: 12.2300s
Updating learning rate to 0.0003383725477
Validation loss decreased (inf --> 0.3754).  Saving model state dict ...
Epoch: 1 cost time: 1.2531542778015137
Epoch: 1, Steps: 129 | Train Loss: 0.7953424 Vali Loss: 0.3754020 Best vali loss: 0.3754020
	iters: 100, epoch: 2 | loss: 0.5579776
	speed: 0.0121s/iter; left time: 9.6937s
Updating learning rate to 0.00016918627385
Validation loss decreased (0.3754 --> 0.3657).  Saving model state dict ...
Epoch: 2 cost time: 1.0156738758087158
Epoch: 2, Steps: 129 | Train Loss: 0.5579776 Vali Loss: 0.3657109 Best vali loss: 0.3657109
	iters: 100, epoch: 3 | loss: 0.3863409
	speed: 0.0125s/iter; left time: 8.4102s
Updating learning rate to 8.4593136925e-05
Epoch: 3 cost time: 1.0127975940704346
Epoch: 3, Steps: 129 | Train Loss: 0.3863409 Vali Loss: 0.3671775 Best vali loss: 0.3657109

best validation loss 0.36571085844152335

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0109034907503, 'e_layers': 3, 'learning_rate': 0.0007693898904, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5168735
	speed: 0.0120s/iter; left time: 23.5659s
	iters: 200, epoch: 1 | loss: 0.8690358
	speed: 0.0066s/iter; left time: 12.1684s
Updating learning rate to 0.0007401067313308311
Validation loss decreased (inf --> 0.3779).  Saving model state dict ...
Epoch: 1 cost time: 1.9409711360931396
Epoch: 1, Steps: 257 | Train Loss: 0.6929546 Vali Loss: 0.3779007 Best vali loss: 0.3779007
	iters: 100, epoch: 2 | loss: 0.6602884
	speed: 0.0137s/iter; left time: 23.2763s
	iters: 200, epoch: 2 | loss: 0.7360511
	speed: 0.0064s/iter; left time: 10.1710s
Updating learning rate to 0.0006567153496391073
Validation loss decreased (0.3779 --> 0.3628).  Saving model state dict ...
Epoch: 2 cost time: 1.6963577270507812
Epoch: 2, Steps: 257 | Train Loss: 0.6981698 Vali Loss: 0.3627519 Best vali loss: 0.3627519
	iters: 100, epoch: 3 | loss: 0.5262941
	speed: 0.0136s/iter; left time: 19.5617s
	iters: 200, epoch: 3 | loss: 0.5278485
	speed: 0.0064s/iter; left time: 8.5675s
Updating learning rate to 0.0005319113272426361
Epoch: 3 cost time: 1.6759679317474365
Epoch: 3, Steps: 257 | Train Loss: 0.5270713 Vali Loss: 0.3868369 Best vali loss: 0.3627519

best validation loss 0.36275194150291395

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0109034907503, 'e_layers': 3, 'learning_rate': 0.0007693898904, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4976611
	speed: 0.0122s/iter; left time: 14.4575s
	iters: 200, epoch: 4 | loss: 0.6674023
	speed: 0.0064s/iter; left time: 6.9700s
Updating learning rate to 0.0003846949452
Validation loss decreased (0.3628 --> 0.3480).  Saving model state dict ...
Epoch: 4 cost time: 1.9040277004241943
Epoch: 4, Steps: 257 | Train Loss: 0.5825317 Vali Loss: 0.3479854 Best vali loss: 0.3479854
	iters: 100, epoch: 5 | loss: 0.5851498
	speed: 0.0132s/iter; left time: 12.3046s
	iters: 200, epoch: 5 | loss: 0.7015089
	speed: 0.0062s/iter; left time: 5.1756s
Updating learning rate to 0.0002374785631573639
Epoch: 5 cost time: 1.671389102935791
Epoch: 5, Steps: 257 | Train Loss: 0.6433294 Vali Loss: 0.3572897 Best vali loss: 0.3479854
	iters: 100, epoch: 6 | loss: 0.4632304
	speed: 0.0132s/iter; left time: 8.8805s
	iters: 200, epoch: 6 | loss: 0.4491628
	speed: 0.0063s/iter; left time: 3.6212s
Updating learning rate to 0.00011267454076089274
Epoch: 6 cost time: 1.6679251194000244
Epoch: 6, Steps: 257 | Train Loss: 0.4561966 Vali Loss: 0.3600278 Best vali loss: 0.3479854
	iters: 100, epoch: 7 | loss: 0.3380022
	speed: 0.0135s/iter; left time: 5.6055s
	iters: 200, epoch: 7 | loss: 0.5308802
	speed: 0.0061s/iter; left time: 1.9317s
Updating learning rate to 2.928315906916893e-05
Epoch: 7 cost time: 1.6757020950317383
Epoch: 7, Steps: 257 | Train Loss: 0.4344412 Vali Loss: 0.3576338 Best vali loss: 0.3479854
	iters: 100, epoch: 8 | loss: 0.6230674
	speed: 0.0145s/iter; left time: 2.2901s
	iters: 200, epoch: 8 | loss: 0.5143319
	speed: 0.0063s/iter; left time: 0.3626s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7530841827392578
Epoch: 8, Steps: 257 | Train Loss: 0.5686997 Vali Loss: 0.3609649 Best vali loss: 0.3479854

best validation loss 0.3479853718828827

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0009909717048, 'e_layers': 2, 'learning_rate': 0.0008180744789, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.1575302
	speed: 0.0099s/iter; left time: 80.3626s
	iters: 200, epoch: 1 | loss: 0.3787393
	speed: 0.0042s/iter; left time: 33.4720s
	iters: 300, epoch: 1 | loss: 0.4465971
	speed: 0.0042s/iter; left time: 33.4833s
	iters: 400, epoch: 1 | loss: 0.3113228
	speed: 0.0042s/iter; left time: 32.8074s
	iters: 500, epoch: 1 | loss: 1.0813221
	speed: 0.0042s/iter; left time: 32.2148s
	iters: 600, epoch: 1 | loss: 1.2663171
	speed: 0.0041s/iter; left time: 31.0809s
	iters: 700, epoch: 1 | loss: 0.4703241
	speed: 0.0039s/iter; left time: 29.3861s
	iters: 800, epoch: 1 | loss: 0.3959954
	speed: 0.0038s/iter; left time: 28.1546s
	iters: 900, epoch: 1 | loss: 0.3228951
	speed: 0.0036s/iter; left time: 26.0596s
	iters: 1000, epoch: 1 | loss: 0.3353908
	speed: 0.0040s/iter; left time: 28.8219s
Updating learning rate to 0.0007869383730127732
Validation loss decreased (inf --> 0.4055).  Saving model state dict ...
Epoch: 1 cost time: 4.447631359100342
Epoch: 1, Steps: 1027 | Train Loss: 0.6166434 Vali Loss: 0.4054608 Best vali loss: 0.4054608
	iters: 100, epoch: 2 | loss: 0.3871485
	speed: 0.0133s/iter; left time: 94.0929s
	iters: 200, epoch: 2 | loss: 0.3970667
	speed: 0.0043s/iter; left time: 29.7586s
	iters: 300, epoch: 2 | loss: 0.5829878
	speed: 0.0042s/iter; left time: 28.9355s
	iters: 400, epoch: 2 | loss: 0.9372314
	speed: 0.0042s/iter; left time: 28.6859s
	iters: 500, epoch: 2 | loss: 1.0674307
	speed: 0.0042s/iter; left time: 27.9996s
	iters: 600, epoch: 2 | loss: 1.1443708
	speed: 0.0042s/iter; left time: 27.7700s
	iters: 700, epoch: 2 | loss: 1.1637725
	speed: 0.0042s/iter; left time: 27.2990s
	iters: 800, epoch: 2 | loss: 0.2610463
	speed: 0.0042s/iter; left time: 26.8413s
	iters: 900, epoch: 2 | loss: 0.3698454
	speed: 0.0043s/iter; left time: 26.9249s
	iters: 1000, epoch: 2 | loss: 0.3735845
	speed: 0.0042s/iter; left time: 26.2866s
Updating learning rate to 0.0006982702452229205
Validation loss decreased (0.4055 --> 0.3944).  Saving model state dict ...
Epoch: 2 cost time: 4.397181749343872
Epoch: 2, Steps: 1027 | Train Loss: 0.6684485 Vali Loss: 0.3943585 Best vali loss: 0.3943585
	iters: 100, epoch: 3 | loss: 1.1893588
	speed: 0.0134s/iter; left time: 81.0168s
	iters: 200, epoch: 3 | loss: 1.2242250
	speed: 0.0033s/iter; left time: 19.6195s
	iters: 300, epoch: 3 | loss: 1.0590975
	speed: 0.0033s/iter; left time: 19.4884s
	iters: 400, epoch: 3 | loss: 0.3958684
	speed: 0.0036s/iter; left time: 20.8736s
	iters: 500, epoch: 3 | loss: 0.7848238
	speed: 0.0042s/iter; left time: 23.5036s
	iters: 600, epoch: 3 | loss: 0.3239016
	speed: 0.0043s/iter; left time: 24.1137s
	iters: 700, epoch: 3 | loss: 1.2888945
	speed: 0.0043s/iter; left time: 23.4639s
	iters: 800, epoch: 3 | loss: 1.4315819
	speed: 0.0042s/iter; left time: 22.3598s
	iters: 900, epoch: 3 | loss: 1.3229116
	speed: 0.0042s/iter; left time: 22.2501s
	iters: 1000, epoch: 3 | loss: 1.0817293
	speed: 0.0042s/iter; left time: 21.5334s
Updating learning rate to 0.0005655690142078671
Epoch: 3 cost time: 4.106218099594116
Epoch: 3, Steps: 1027 | Train Loss: 1.0102393 Vali Loss: 0.3950422 Best vali loss: 0.3943585
	iters: 100, epoch: 4 | loss: 0.4908627
	speed: 0.0131s/iter; left time: 65.7538s
	iters: 200, epoch: 4 | loss: 0.2121179
	speed: 0.0041s/iter; left time: 20.3249s
	iters: 300, epoch: 4 | loss: 0.3467164
	speed: 0.0043s/iter; left time: 20.6740s
	iters: 400, epoch: 4 | loss: 0.2970098
	speed: 0.0042s/iter; left time: 20.1257s
	iters: 500, epoch: 4 | loss: 0.3173634
	speed: 0.0041s/iter; left time: 19.1615s
	iters: 600, epoch: 4 | loss: 0.8286270
	speed: 0.0042s/iter; left time: 19.1112s
	iters: 700, epoch: 4 | loss: 1.3488568
	speed: 0.0043s/iter; left time: 18.8823s
	iters: 800, epoch: 4 | loss: 0.9762112
	speed: 0.0034s/iter; left time: 14.8487s
	iters: 900, epoch: 4 | loss: 0.8182157
	speed: 0.0034s/iter; left time: 14.5473s
	iters: 1000, epoch: 4 | loss: 0.4847331
	speed: 0.0034s/iter; left time: 13.8618s
Updating learning rate to 0.00040903723945
Epoch: 4 cost time: 4.113994121551514
Epoch: 4, Steps: 1027 | Train Loss: 0.6120714 Vali Loss: 0.4078814 Best vali loss: 0.3943585
	iters: 100, epoch: 5 | loss: 0.2580718
	speed: 0.0128s/iter; left time: 51.4867s
	iters: 200, epoch: 5 | loss: 0.3146572
	speed: 0.0042s/iter; left time: 16.2452s
	iters: 300, epoch: 5 | loss: 0.9577392
	speed: 0.0041s/iter; left time: 15.7272s
	iters: 400, epoch: 5 | loss: 1.0515257
	speed: 0.0041s/iter; left time: 15.3689s
	iters: 500, epoch: 5 | loss: 1.5550989
	speed: 0.0042s/iter; left time: 15.0263s
	iters: 600, epoch: 5 | loss: 0.3366562
	speed: 0.0042s/iter; left time: 14.7101s
	iters: 700, epoch: 5 | loss: 0.3718834
	speed: 0.0041s/iter; left time: 14.0163s
	iters: 800, epoch: 5 | loss: 0.9466847
	speed: 0.0040s/iter; left time: 13.2384s
	iters: 900, epoch: 5 | loss: 0.2709529
	speed: 0.0040s/iter; left time: 12.8406s
	iters: 1000, epoch: 5 | loss: 0.8663197
	speed: 0.0042s/iter; left time: 12.9973s
Updating learning rate to 0.0002525054646921329
Validation loss decreased (0.3944 --> 0.3941).  Saving model state dict ...
Epoch: 5 cost time: 4.274386167526245
Epoch: 5, Steps: 1027 | Train Loss: 0.6929590 Vali Loss: 0.3940756 Best vali loss: 0.3940756
	iters: 100, epoch: 6 | loss: 1.0403157
	speed: 0.0132s/iter; left time: 39.3344s
	iters: 200, epoch: 6 | loss: 0.3118885
	speed: 0.0034s/iter; left time: 9.8347s
	iters: 300, epoch: 6 | loss: 0.6577185
	speed: 0.0033s/iter; left time: 9.2236s
	iters: 400, epoch: 6 | loss: 0.4243236
	speed: 0.0034s/iter; left time: 9.0845s
	iters: 500, epoch: 6 | loss: 0.1977895
	speed: 0.0039s/iter; left time: 10.0380s
	iters: 600, epoch: 6 | loss: 0.9678721
	speed: 0.0040s/iter; left time: 9.9229s
	iters: 700, epoch: 6 | loss: 0.2493784
	speed: 0.0040s/iter; left time: 9.5888s
	iters: 800, epoch: 6 | loss: 1.0433360
	speed: 0.0041s/iter; left time: 9.2636s
	iters: 900, epoch: 6 | loss: 0.4047246
	speed: 0.0040s/iter; left time: 8.7324s
	iters: 1000, epoch: 6 | loss: 0.4296007
	speed: 0.0040s/iter; left time: 8.4000s
Updating learning rate to 0.00011980423367707943
Validation loss decreased (0.3941 --> 0.3914).  Saving model state dict ...
Epoch: 6 cost time: 3.9680659770965576
Epoch: 6, Steps: 1027 | Train Loss: 0.5726948 Vali Loss: 0.3913543 Best vali loss: 0.3913543
	iters: 100, epoch: 7 | loss: 0.7569747
	speed: 0.0130s/iter; left time: 25.3394s
	iters: 200, epoch: 7 | loss: 0.4262738
	speed: 0.0040s/iter; left time: 7.5086s
	iters: 300, epoch: 7 | loss: 0.6684085
	speed: 0.0041s/iter; left time: 7.1413s
	iters: 400, epoch: 7 | loss: 0.4174733
	speed: 0.0040s/iter; left time: 6.6617s
	iters: 500, epoch: 7 | loss: 0.4958695
	speed: 0.0041s/iter; left time: 6.3975s
	iters: 600, epoch: 7 | loss: 0.8781220
	speed: 0.0043s/iter; left time: 6.2540s
	iters: 700, epoch: 7 | loss: 0.4617896
	speed: 0.0042s/iter; left time: 5.7564s
	iters: 800, epoch: 7 | loss: 0.3897789
	speed: 0.0041s/iter; left time: 5.1269s
	iters: 900, epoch: 7 | loss: 0.5389488
	speed: 0.0035s/iter; left time: 4.0312s
	iters: 1000, epoch: 7 | loss: 0.9289013
	speed: 0.0034s/iter; left time: 3.6396s
Updating learning rate to 3.113610588722674e-05
Epoch: 7 cost time: 4.124589204788208
Epoch: 7, Steps: 1027 | Train Loss: 0.5962540 Vali Loss: 0.3928316 Best vali loss: 0.3913543
	iters: 100, epoch: 8 | loss: 1.0897877
	speed: 0.0098s/iter; left time: 9.1017s
	iters: 200, epoch: 8 | loss: 0.8193609
	speed: 0.0038s/iter; left time: 3.1211s
	iters: 300, epoch: 8 | loss: 0.7026346
	speed: 0.0041s/iter; left time: 2.9587s
	iters: 400, epoch: 8 | loss: 0.3206225
	speed: 0.0040s/iter; left time: 2.5070s
	iters: 500, epoch: 8 | loss: 1.2731564
	speed: 0.0040s/iter; left time: 2.1021s
	iters: 600, epoch: 8 | loss: 0.2644093
	speed: 0.0039s/iter; left time: 1.6633s
	iters: 700, epoch: 8 | loss: 1.0875312
	speed: 0.0033s/iter; left time: 1.0957s
	iters: 800, epoch: 8 | loss: 0.4093179
	speed: 0.0041s/iter; left time: 0.9406s
	iters: 900, epoch: 8 | loss: 0.2870640
	speed: 0.0042s/iter; left time: 0.5345s
	iters: 1000, epoch: 8 | loss: 1.9498955
	speed: 0.0042s/iter; left time: 0.1185s
Updating learning rate to 0.0
Epoch: 8 cost time: 4.029468536376953
Epoch: 8, Steps: 1027 | Train Loss: 0.8203780 Vali Loss: 0.3925948 Best vali loss: 0.3913543

best validation loss 0.3913543300333566

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.0030171201133, 'e_layers': 4, 'learning_rate': 0.0002007150185, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2233403
	speed: 0.0117s/iter; left time: 94.6217s
	iters: 200, epoch: 1 | loss: 0.3391807
	speed: 0.0049s/iter; left time: 39.5047s
	iters: 300, epoch: 1 | loss: 0.6317260
	speed: 0.0047s/iter; left time: 36.8493s
	iters: 400, epoch: 1 | loss: 0.2851761
	speed: 0.0066s/iter; left time: 51.9376s
	iters: 500, epoch: 1 | loss: 1.0168082
	speed: 0.0060s/iter; left time: 46.4348s
	iters: 600, epoch: 1 | loss: 0.4880375
	speed: 0.0067s/iter; left time: 50.6972s
	iters: 700, epoch: 1 | loss: 0.5244411
	speed: 0.0058s/iter; left time: 43.8657s
	iters: 800, epoch: 1 | loss: 0.2988760
	speed: 0.0062s/iter; left time: 46.0258s
	iters: 900, epoch: 1 | loss: 0.2326151
	speed: 0.0046s/iter; left time: 33.5999s
	iters: 1000, epoch: 1 | loss: 0.9087300
	speed: 0.0050s/iter; left time: 35.9403s
Updating learning rate to 0.00019307575797988713
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 6.144841432571411
Epoch: 1, Steps: 1027 | Train Loss: 0.4948931 Vali Loss: 0.3757220 Best vali loss: 0.3757220
	iters: 100, epoch: 2 | loss: 0.9499781
	speed: 0.0194s/iter; left time: 137.7524s
	iters: 200, epoch: 2 | loss: 0.7909974
	speed: 0.0065s/iter; left time: 45.5632s
	iters: 300, epoch: 2 | loss: 0.4200120
	speed: 0.0064s/iter; left time: 44.1636s
	iters: 400, epoch: 2 | loss: 0.5226095
	speed: 0.0064s/iter; left time: 43.5499s
	iters: 500, epoch: 2 | loss: 0.4587346
	speed: 0.0068s/iter; left time: 45.7709s
	iters: 600, epoch: 2 | loss: 0.2816813
	speed: 0.0055s/iter; left time: 36.4545s
	iters: 700, epoch: 2 | loss: 1.0919901
	speed: 0.0045s/iter; left time: 29.2496s
	iters: 800, epoch: 2 | loss: 1.2630430
	speed: 0.0052s/iter; left time: 33.3680s
	iters: 900, epoch: 2 | loss: 0.9682570
	speed: 0.0064s/iter; left time: 40.3758s
	iters: 1000, epoch: 2 | loss: 0.5078793
	speed: 0.0066s/iter; left time: 40.8839s
Updating learning rate to 0.00017132098458366666
Validation loss decreased (0.3757 --> 0.3695).  Saving model state dict ...
Epoch: 2 cost time: 6.2732837200164795
Epoch: 2, Steps: 1027 | Train Loss: 0.7255182 Vali Loss: 0.3694814 Best vali loss: 0.3694814
	iters: 100, epoch: 3 | loss: 0.7396393
	speed: 0.0168s/iter; left time: 102.0908s
	iters: 200, epoch: 3 | loss: 0.2039670
	speed: 0.0058s/iter; left time: 34.8166s
	iters: 300, epoch: 3 | loss: 0.4569351
	speed: 0.0062s/iter; left time: 36.5632s
	iters: 400, epoch: 3 | loss: 0.5997661
	speed: 0.0063s/iter; left time: 36.2671s
	iters: 500, epoch: 3 | loss: 1.1000779
	speed: 0.0057s/iter; left time: 32.0910s
	iters: 600, epoch: 3 | loss: 0.4674028
	speed: 0.0062s/iter; left time: 34.5853s
	iters: 700, epoch: 3 | loss: 0.3382142
	speed: 0.0062s/iter; left time: 34.1008s
	iters: 800, epoch: 3 | loss: 0.7811553
	speed: 0.0056s/iter; left time: 29.9036s
	iters: 900, epoch: 3 | loss: 0.9709539
	speed: 0.0062s/iter; left time: 32.7883s
	iters: 1000, epoch: 3 | loss: 0.9484596
	speed: 0.0064s/iter; left time: 33.0987s
Updating learning rate to 0.00013876266535340126
Epoch: 3 cost time: 6.336985111236572
Epoch: 3, Steps: 1027 | Train Loss: 0.6606571 Vali Loss: 0.3729154 Best vali loss: 0.3694814
	iters: 100, epoch: 4 | loss: 0.5403736
	speed: 0.0145s/iter; left time: 73.0246s
	iters: 200, epoch: 4 | loss: 0.5224248
	speed: 0.0064s/iter; left time: 31.3934s
	iters: 300, epoch: 4 | loss: 0.2733184
	speed: 0.0063s/iter; left time: 30.5520s
	iters: 400, epoch: 4 | loss: 0.5898680
	speed: 0.0063s/iter; left time: 29.6959s
	iters: 500, epoch: 4 | loss: 1.1361082
	speed: 0.0063s/iter; left time: 29.3209s
	iters: 600, epoch: 4 | loss: 0.4351873
	speed: 0.0061s/iter; left time: 27.7686s
	iters: 700, epoch: 4 | loss: 0.3645287
	speed: 0.0062s/iter; left time: 27.6759s
	iters: 800, epoch: 4 | loss: 1.4226494
	speed: 0.0067s/iter; left time: 28.8933s
	iters: 900, epoch: 4 | loss: 0.4933359
	speed: 0.0065s/iter; left time: 27.4140s
	iters: 1000, epoch: 4 | loss: 0.5064060
	speed: 0.0063s/iter; left time: 25.9687s
Updating learning rate to 0.00010035750925
Validation loss decreased (0.3695 --> 0.3674).  Saving model state dict ...
Epoch: 4 cost time: 6.419739723205566
Epoch: 4, Steps: 1027 | Train Loss: 0.6284200 Vali Loss: 0.3673714 Best vali loss: 0.3673714
	iters: 100, epoch: 5 | loss: 0.2664900
	speed: 0.0169s/iter; left time: 67.8557s
	iters: 200, epoch: 5 | loss: 0.5457086
	speed: 0.0064s/iter; left time: 24.9862s
	iters: 300, epoch: 5 | loss: 0.4469915
	speed: 0.0070s/iter; left time: 26.8299s
	iters: 400, epoch: 5 | loss: 0.2048441
	speed: 0.0064s/iter; left time: 23.7364s
	iters: 500, epoch: 5 | loss: 0.2515166
	speed: 0.0067s/iter; left time: 24.3115s
	iters: 600, epoch: 5 | loss: 0.2868388
	speed: 0.0062s/iter; left time: 21.8614s
	iters: 700, epoch: 5 | loss: 0.8042896
	speed: 0.0066s/iter; left time: 22.3521s
	iters: 800, epoch: 5 | loss: 0.8782475
	speed: 0.0065s/iter; left time: 21.6405s
	iters: 900, epoch: 5 | loss: 0.2026872
	speed: 0.0065s/iter; left time: 20.8994s
	iters: 1000, epoch: 5 | loss: 0.3750898
	speed: 0.0063s/iter; left time: 19.4955s
Updating learning rate to 6.195235314659876e-05
Epoch: 5 cost time: 6.71318793296814
Epoch: 5, Steps: 1027 | Train Loss: 0.4262704 Vali Loss: 0.3696434 Best vali loss: 0.3673714
	iters: 100, epoch: 6 | loss: 0.3536899
	speed: 0.0166s/iter; left time: 49.5023s
	iters: 200, epoch: 6 | loss: 0.7964400
	speed: 0.0061s/iter; left time: 17.6385s
	iters: 300, epoch: 6 | loss: 0.3205196
	speed: 0.0062s/iter; left time: 17.3836s
	iters: 400, epoch: 6 | loss: 0.5642004
	speed: 0.0062s/iter; left time: 16.6215s
	iters: 500, epoch: 6 | loss: 0.2748305
	speed: 0.0060s/iter; left time: 15.4430s
	iters: 600, epoch: 6 | loss: 0.8575822
	speed: 0.0065s/iter; left time: 16.0872s
	iters: 700, epoch: 6 | loss: 0.7196104
	speed: 0.0067s/iter; left time: 16.0454s
	iters: 800, epoch: 6 | loss: 0.3533670
	speed: 0.0068s/iter; left time: 15.6086s
	iters: 900, epoch: 6 | loss: 0.2623731
	speed: 0.0069s/iter; left time: 15.1210s
	iters: 1000, epoch: 6 | loss: 0.5788712
	speed: 0.0067s/iter; left time: 13.8816s
Updating learning rate to 2.9394033916333338e-05
Epoch: 6 cost time: 6.671909332275391
Epoch: 6, Steps: 1027 | Train Loss: 0.5081484 Vali Loss: 0.3739470 Best vali loss: 0.3673714
	iters: 100, epoch: 7 | loss: 0.2157434
	speed: 0.0171s/iter; left time: 33.4719s
	iters: 200, epoch: 7 | loss: 0.3093969
	speed: 0.0067s/iter; left time: 12.4728s
	iters: 300, epoch: 7 | loss: 0.1931189
	speed: 0.0067s/iter; left time: 11.8398s
	iters: 400, epoch: 7 | loss: 1.0360013
	speed: 0.0067s/iter; left time: 11.0502s
	iters: 500, epoch: 7 | loss: 0.9760070
	speed: 0.0062s/iter; left time: 9.6681s
	iters: 600, epoch: 7 | loss: 0.3941045
	speed: 0.0066s/iter; left time: 9.5623s
	iters: 700, epoch: 7 | loss: 1.7330418
	speed: 0.0063s/iter; left time: 8.5700s
	iters: 800, epoch: 7 | loss: 0.8068915
	speed: 0.0063s/iter; left time: 7.8568s
	iters: 900, epoch: 7 | loss: 0.4841053
	speed: 0.0062s/iter; left time: 7.1246s
	iters: 1000, epoch: 7 | loss: 0.3547177
	speed: 0.0062s/iter; left time: 6.5614s
Updating learning rate to 7.639260520112865e-06
Epoch: 7 cost time: 6.666924715042114
Epoch: 7, Steps: 1027 | Train Loss: 0.6503128 Vali Loss: 0.3715274 Best vali loss: 0.3673714
	iters: 100, epoch: 8 | loss: 0.6341111
	speed: 0.0141s/iter; left time: 13.0473s
	iters: 200, epoch: 8 | loss: 0.3584466
	speed: 0.0061s/iter; left time: 5.0764s
	iters: 300, epoch: 8 | loss: 1.0949690
	speed: 0.0062s/iter; left time: 4.5103s
	iters: 400, epoch: 8 | loss: 1.1057926
	speed: 0.0059s/iter; left time: 3.7204s
	iters: 500, epoch: 8 | loss: 0.9414127
	speed: 0.0062s/iter; left time: 3.2640s
	iters: 600, epoch: 8 | loss: 0.7676176
	speed: 0.0066s/iter; left time: 2.8153s
	iters: 700, epoch: 8 | loss: 0.2121034
	speed: 0.0067s/iter; left time: 2.2135s
	iters: 800, epoch: 8 | loss: 1.0640568
	speed: 0.0065s/iter; left time: 1.4826s
	iters: 900, epoch: 8 | loss: 0.4136778
	speed: 0.0066s/iter; left time: 0.8398s
	iters: 1000, epoch: 8 | loss: 0.7891858
	speed: 0.0063s/iter; left time: 0.1757s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.467425107955933
Epoch: 8, Steps: 1027 | Train Loss: 0.7381373 Vali Loss: 0.3729030 Best vali loss: 0.3673714

best validation loss 0.367371352230636

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6321568
	speed: 0.0123s/iter; left time: 24.1234s
	iters: 200, epoch: 1 | loss: 0.8654147
	speed: 0.0063s/iter; left time: 11.6605s
Updating learning rate to 0.0002850674695
Validation loss decreased (inf --> 0.3707).  Saving model state dict ...
Epoch: 1 cost time: 1.951249599456787
Epoch: 1, Steps: 257 | Train Loss: 0.7487858 Vali Loss: 0.3706605 Best vali loss: 0.3706605
	iters: 100, epoch: 2 | loss: 0.5609405
	speed: 0.0138s/iter; left time: 23.4816s
	iters: 200, epoch: 2 | loss: 0.4631157
	speed: 0.0068s/iter; left time: 10.8100s
Updating learning rate to 0.00014253373475
Validation loss decreased (0.3707 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 1.7405071258544922
Epoch: 2, Steps: 257 | Train Loss: 0.5120281 Vali Loss: 0.3672948 Best vali loss: 0.3672948
	iters: 100, epoch: 3 | loss: 0.8166024
	speed: 0.0145s/iter; left time: 20.9231s
	iters: 200, epoch: 3 | loss: 0.5424501
	speed: 0.0064s/iter; left time: 8.6484s
Updating learning rate to 7.1266867375e-05
Epoch: 3 cost time: 1.6907594203948975
Epoch: 3, Steps: 257 | Train Loss: 0.6795262 Vali Loss: 0.3694570 Best vali loss: 0.3672948

best validation loss 0.3672948453187474

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0008267342166, 'e_layers': 4, 'learning_rate': 5.54518777e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7102124
	speed: 0.0125s/iter; left time: 11.6363s
Updating learning rate to 5.3341366273174527e-05
Validation loss decreased (inf --> 0.4303).  Saving model state dict ...
Epoch: 1 cost time: 1.1558268070220947
Epoch: 1, Steps: 129 | Train Loss: 0.7102124 Vali Loss: 0.4302872 Best vali loss: 0.4302872
	iters: 100, epoch: 2 | loss: 0.5248924
	speed: 0.0111s/iter; left time: 8.9397s
Updating learning rate to 4.733113822559855e-05
Validation loss decreased (0.4303 --> 0.4162).  Saving model state dict ...
Epoch: 2 cost time: 0.8834900856018066
Epoch: 2, Steps: 129 | Train Loss: 0.5248924 Vali Loss: 0.4161879 Best vali loss: 0.4161879
	iters: 100, epoch: 3 | loss: 0.5404279
	speed: 0.0125s/iter; left time: 8.4154s
Updating learning rate to 3.833619629466259e-05
Validation loss decreased (0.4162 --> 0.4064).  Saving model state dict ...
Epoch: 3 cost time: 1.0263817310333252
Epoch: 3, Steps: 129 | Train Loss: 0.5404279 Vali Loss: 0.4064469 Best vali loss: 0.4064469

best validation loss 0.406446876132418

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0010382705628, 'e_layers': 3, 'learning_rate': 0.0008045612191, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8596942
	speed: 0.0120s/iter; left time: 23.5682s
	iters: 200, epoch: 1 | loss: 0.5282303
	speed: 0.0064s/iter; left time: 11.8139s
Updating learning rate to 0.0007739394310394095
Validation loss decreased (inf --> 0.3811).  Saving model state dict ...
Epoch: 1 cost time: 1.913454532623291
Epoch: 1, Steps: 257 | Train Loss: 0.6939622 Vali Loss: 0.3811071 Best vali loss: 0.3811071
	iters: 100, epoch: 2 | loss: 0.5381135
	speed: 0.0135s/iter; left time: 22.9757s
	iters: 200, epoch: 2 | loss: 0.7455879
	speed: 0.0061s/iter; left time: 9.7841s
Updating learning rate to 0.0006867359565026628
Validation loss decreased (0.3811 --> 0.3754).  Saving model state dict ...
Epoch: 2 cost time: 1.6485047340393066
Epoch: 2, Steps: 257 | Train Loss: 0.6418507 Vali Loss: 0.3754447 Best vali loss: 0.3754447
	iters: 100, epoch: 3 | loss: 0.7659262
	speed: 0.0143s/iter; left time: 20.6128s
	iters: 200, epoch: 3 | loss: 0.5760849
	speed: 0.0063s/iter; left time: 8.4539s
Updating learning rate to 0.0005562267339865145
Epoch: 3 cost time: 1.727626085281372
Epoch: 3, Steps: 257 | Train Loss: 0.6710055 Vali Loss: 0.3872570 Best vali loss: 0.3754447

best validation loss 0.3754447043644656

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0009059927254, 'e_layers': 4, 'learning_rate': 0.0002850674695, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5131140
	speed: 0.0131s/iter; left time: 15.4857s
	iters: 200, epoch: 4 | loss: 0.8457961
	speed: 0.0064s/iter; left time: 6.9790s
Updating learning rate to 3.56334336875e-05
Epoch: 4 cost time: 1.9796419143676758
Epoch: 4, Steps: 257 | Train Loss: 0.6794551 Vali Loss: 0.3714292 Best vali loss: 0.3672948
	iters: 100, epoch: 5 | loss: 0.4988869
	speed: 0.0137s/iter; left time: 12.7653s
	iters: 200, epoch: 5 | loss: 0.4525555
	speed: 0.0064s/iter; left time: 5.3236s
Updating learning rate to 1.781671684375e-05
Epoch: 5 cost time: 1.7199037075042725
Epoch: 5, Steps: 257 | Train Loss: 0.4757212 Vali Loss: 0.3719440 Best vali loss: 0.3672948
	iters: 100, epoch: 6 | loss: 0.7380862
	speed: 0.0150s/iter; left time: 10.0697s
	iters: 200, epoch: 6 | loss: 0.5285060
	speed: 0.0064s/iter; left time: 3.6760s
Updating learning rate to 8.908358421875e-06
Epoch: 6 cost time: 1.7313597202301025
Epoch: 6, Steps: 257 | Train Loss: 0.6332961 Vali Loss: 0.3711277 Best vali loss: 0.3672948
	iters: 100, epoch: 7 | loss: 0.6083205
	speed: 0.0141s/iter; left time: 5.8486s
	iters: 200, epoch: 7 | loss: 0.4635274
	speed: 0.0064s/iter; left time: 2.0016s
Updating learning rate to 4.4541792109375e-06
Epoch: 7 cost time: 1.728445053100586
Epoch: 7, Steps: 257 | Train Loss: 0.5359239 Vali Loss: 0.3716452 Best vali loss: 0.3672948
	iters: 100, epoch: 8 | loss: 0.4789276
	speed: 0.0144s/iter; left time: 2.2704s
	iters: 200, epoch: 8 | loss: 0.5412050
	speed: 0.0064s/iter; left time: 0.3689s
Updating learning rate to 2.22708960546875e-06
Epoch: 8 cost time: 1.7074317932128906
Epoch: 8, Steps: 257 | Train Loss: 0.5100663 Vali Loss: 0.3718656 Best vali loss: 0.3672948

best validation loss 0.3672948453187474

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0102976635799, 'e_layers': 4, 'learning_rate': 9.28932504e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.2285182
	speed: 0.0123s/iter; left time: 49.1815s
	iters: 200, epoch: 1 | loss: 0.5971127
	speed: 0.0060s/iter; left time: 23.6621s
	iters: 300, epoch: 1 | loss: 0.6051111
	speed: 0.0059s/iter; left time: 22.6861s
	iters: 400, epoch: 1 | loss: 1.0604298
	speed: 0.0061s/iter; left time: 22.4930s
	iters: 500, epoch: 1 | loss: 0.6105707
	speed: 0.0060s/iter; left time: 21.5586s
Updating learning rate to 8.935771157650295e-05
Validation loss decreased (inf --> 0.3851).  Saving model state dict ...
Epoch: 1 cost time: 3.424241542816162
Epoch: 1, Steps: 514 | Train Loss: 0.8203485 Vali Loss: 0.3851274 Best vali loss: 0.3851274
	iters: 100, epoch: 2 | loss: 0.7276981
	speed: 0.0136s/iter; left time: 47.5946s
	iters: 200, epoch: 2 | loss: 0.8042545
	speed: 0.0063s/iter; left time: 21.4438s
	iters: 300, epoch: 2 | loss: 0.5402230
	speed: 0.0066s/iter; left time: 21.8282s
	iters: 400, epoch: 2 | loss: 0.3357709
	speed: 0.0066s/iter; left time: 21.1035s
	iters: 500, epoch: 2 | loss: 0.5265641
	speed: 0.0062s/iter; left time: 19.1518s
Updating learning rate to 7.928934884214998e-05
Validation loss decreased (0.3851 --> 0.3707).  Saving model state dict ...
Epoch: 2 cost time: 3.3736138343811035
Epoch: 2, Steps: 514 | Train Loss: 0.5869021 Vali Loss: 0.3707404 Best vali loss: 0.3707404
	iters: 100, epoch: 3 | loss: 1.0314871
	speed: 0.0132s/iter; left time: 39.3076s
	iters: 200, epoch: 3 | loss: 1.1735821
	speed: 0.0061s/iter; left time: 17.7147s
	iters: 300, epoch: 3 | loss: 0.5085612
	speed: 0.0061s/iter; left time: 17.1259s
	iters: 400, epoch: 3 | loss: 0.3149267
	speed: 0.0060s/iter; left time: 16.0345s
	iters: 500, epoch: 3 | loss: 0.3918878
	speed: 0.0061s/iter; left time: 15.7692s
Updating learning rate to 6.422097915331089e-05
Validation loss decreased (0.3707 --> 0.3697).  Saving model state dict ...
Epoch: 3 cost time: 3.221144914627075
Epoch: 3, Steps: 514 | Train Loss: 0.6840890 Vali Loss: 0.3696654 Best vali loss: 0.3696654
	iters: 100, epoch: 4 | loss: 0.4847449
	speed: 0.0134s/iter; left time: 33.1409s
	iters: 200, epoch: 4 | loss: 0.8091215
	speed: 0.0063s/iter; left time: 14.9014s
	iters: 300, epoch: 4 | loss: 0.9886740
	speed: 0.0049s/iter; left time: 11.2276s
	iters: 400, epoch: 4 | loss: 1.4163405
	speed: 0.0048s/iter; left time: 10.4241s
	iters: 500, epoch: 4 | loss: 1.0491832
	speed: 0.0051s/iter; left time: 10.5542s
Updating learning rate to 4.64466252e-05
Validation loss decreased (0.3697 --> 0.3680).  Saving model state dict ...
Epoch: 4 cost time: 2.9019343852996826
Epoch: 4, Steps: 514 | Train Loss: 0.9496128 Vali Loss: 0.3679635 Best vali loss: 0.3679635
	iters: 100, epoch: 5 | loss: 1.1327040
	speed: 0.0138s/iter; left time: 27.0774s
	iters: 200, epoch: 5 | loss: 0.9563019
	speed: 0.0065s/iter; left time: 12.0375s
	iters: 300, epoch: 5 | loss: 0.2962978
	speed: 0.0068s/iter; left time: 11.8784s
	iters: 400, epoch: 5 | loss: 0.8685309
	speed: 0.0066s/iter; left time: 10.8592s
	iters: 500, epoch: 5 | loss: 0.6966642
	speed: 0.0068s/iter; left time: 10.6103s
Updating learning rate to 2.8672271246689127e-05
Epoch: 5 cost time: 3.4760897159576416
Epoch: 5, Steps: 514 | Train Loss: 0.7900998 Vali Loss: 0.3688653 Best vali loss: 0.3679635
	iters: 100, epoch: 6 | loss: 0.4660706
	speed: 0.0113s/iter; left time: 16.2658s
	iters: 200, epoch: 6 | loss: 0.3249694
	speed: 0.0086s/iter; left time: 11.5566s
	iters: 300, epoch: 6 | loss: 0.6854241
	speed: 0.0081s/iter; left time: 10.0579s
	iters: 400, epoch: 6 | loss: 0.7556070
	speed: 0.0080s/iter; left time: 9.1232s
	iters: 500, epoch: 6 | loss: 0.8789550
	speed: 0.0084s/iter; left time: 8.7091s
Updating learning rate to 1.3603901557850019e-05
Epoch: 6 cost time: 4.0482728481292725
Epoch: 6, Steps: 514 | Train Loss: 0.6222052 Vali Loss: 0.3701632 Best vali loss: 0.3679635
	iters: 100, epoch: 7 | loss: 0.9040352
	speed: 0.0169s/iter; left time: 15.6995s
	iters: 200, epoch: 7 | loss: 0.3090612
	speed: 0.0066s/iter; left time: 5.4932s
	iters: 300, epoch: 7 | loss: 0.3925132
	speed: 0.0049s/iter; left time: 3.5895s
	iters: 400, epoch: 7 | loss: 0.9599453
	speed: 0.0060s/iter; left time: 3.8006s
	iters: 500, epoch: 7 | loss: 0.4603904
	speed: 0.0071s/iter; left time: 3.7533s
Updating learning rate to 3.53553882349705e-06
Epoch: 7 cost time: 3.4709789752960205
Epoch: 7, Steps: 514 | Train Loss: 0.6051891 Vali Loss: 0.3696581 Best vali loss: 0.3679635
	iters: 100, epoch: 8 | loss: 0.8037959
	speed: 0.0142s/iter; left time: 5.8769s
	iters: 200, epoch: 8 | loss: 0.8388556
	speed: 0.0073s/iter; left time: 2.3125s
	iters: 300, epoch: 8 | loss: 1.1769611
	speed: 0.0063s/iter; left time: 1.3589s
	iters: 400, epoch: 8 | loss: 0.2981712
	speed: 0.0048s/iter; left time: 0.5577s
	iters: 500, epoch: 8 | loss: 0.3076882
	speed: 0.0073s/iter; left time: 0.1097s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.461864471435547
Epoch: 8, Steps: 514 | Train Loss: 0.6850944 Vali Loss: 0.3697044 Best vali loss: 0.3679635

best validation loss 0.3679635107400141

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0043224728456, 'e_layers': 3, 'learning_rate': 0.0008063623482, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3360797
	speed: 0.0147s/iter; left time: 119.0212s
	iters: 200, epoch: 1 | loss: 0.4084483
	speed: 0.0073s/iter; left time: 58.4873s
	iters: 300, epoch: 1 | loss: 0.4636740
	speed: 0.0084s/iter; left time: 66.2282s
	iters: 400, epoch: 1 | loss: 0.3317725
	speed: 0.0072s/iter; left time: 56.0416s
	iters: 500, epoch: 1 | loss: 1.2393643
	speed: 0.0087s/iter; left time: 66.9740s
	iters: 600, epoch: 1 | loss: 0.5692397
	speed: 0.0073s/iter; left time: 55.3004s
	iters: 700, epoch: 1 | loss: 0.8146018
	speed: 0.0082s/iter; left time: 61.7803s
	iters: 800, epoch: 1 | loss: 0.4538352
	speed: 0.0046s/iter; left time: 33.9684s
	iters: 900, epoch: 1 | loss: 0.5830811
	speed: 0.0041s/iter; left time: 29.9168s
	iters: 1000, epoch: 1 | loss: 0.3600718
	speed: 0.0050s/iter; left time: 35.9872s
Updating learning rate to 0.0008063623482
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 7.4345057010650635
Epoch: 1, Steps: 1027 | Train Loss: 0.5560168 Vali Loss: 0.3635471 Best vali loss: 0.3635471
	iters: 100, epoch: 2 | loss: 0.5069813
	speed: 0.0177s/iter; left time: 125.3999s
	iters: 200, epoch: 2 | loss: 0.4479263
	speed: 0.0049s/iter; left time: 34.3695s
	iters: 300, epoch: 2 | loss: 1.0261545
	speed: 0.0069s/iter; left time: 47.8157s
	iters: 400, epoch: 2 | loss: 0.8676732
	speed: 0.0052s/iter; left time: 34.9826s
	iters: 500, epoch: 2 | loss: 0.2035388
	speed: 0.0066s/iter; left time: 44.3590s
	iters: 600, epoch: 2 | loss: 0.7781887
	speed: 0.0055s/iter; left time: 36.2918s
	iters: 700, epoch: 2 | loss: 1.0026582
	speed: 0.0061s/iter; left time: 39.4665s
	iters: 800, epoch: 2 | loss: 1.4993690
	speed: 0.0060s/iter; left time: 38.4913s
	iters: 900, epoch: 2 | loss: 0.3570768
	speed: 0.0058s/iter; left time: 36.2159s
	iters: 1000, epoch: 2 | loss: 0.4536554
	speed: 0.0069s/iter; left time: 42.6645s
Updating learning rate to 0.0004031811741
Epoch: 2 cost time: 6.35049843788147
Epoch: 2, Steps: 1027 | Train Loss: 0.7143222 Vali Loss: 0.3825974 Best vali loss: 0.3635471
	iters: 100, epoch: 3 | loss: 0.4772161
	speed: 0.0161s/iter; left time: 97.6309s
	iters: 200, epoch: 3 | loss: 0.7735934
	speed: 0.0042s/iter; left time: 24.7852s
	iters: 300, epoch: 3 | loss: 0.9177427
	speed: 0.0045s/iter; left time: 26.4295s
	iters: 400, epoch: 3 | loss: 0.3794597
	speed: 0.0049s/iter; left time: 28.4075s
	iters: 500, epoch: 3 | loss: 0.3037903
	speed: 0.0051s/iter; left time: 29.0612s
	iters: 600, epoch: 3 | loss: 0.2860670
	speed: 0.0050s/iter; left time: 27.9361s
	iters: 700, epoch: 3 | loss: 1.0567051
	speed: 0.0048s/iter; left time: 26.0108s
	iters: 800, epoch: 3 | loss: 0.2737969
	speed: 0.0043s/iter; left time: 23.1835s
	iters: 900, epoch: 3 | loss: 0.4147965
	speed: 0.0049s/iter; left time: 25.6379s
	iters: 1000, epoch: 3 | loss: 0.3531287
	speed: 0.0043s/iter; left time: 22.3424s
Updating learning rate to 0.00020159058705
Epoch: 3 cost time: 4.903531551361084
Epoch: 3, Steps: 1027 | Train Loss: 0.5236296 Vali Loss: 0.3795947 Best vali loss: 0.3635471
	iters: 100, epoch: 4 | loss: 0.3664352
	speed: 0.0134s/iter; left time: 67.3806s
	iters: 200, epoch: 4 | loss: 0.4873629
	speed: 0.0044s/iter; left time: 21.7796s
	iters: 300, epoch: 4 | loss: 0.9067644
	speed: 0.0049s/iter; left time: 23.5325s
	iters: 400, epoch: 4 | loss: 0.2460378
	speed: 0.0049s/iter; left time: 23.1690s
	iters: 500, epoch: 4 | loss: 0.9756667
	speed: 0.0047s/iter; left time: 21.7120s
	iters: 600, epoch: 4 | loss: 0.9228677
	speed: 0.0041s/iter; left time: 18.3874s
	iters: 700, epoch: 4 | loss: 1.2185645
	speed: 0.0049s/iter; left time: 21.6255s
	iters: 800, epoch: 4 | loss: 0.3918909
	speed: 0.0097s/iter; left time: 41.9892s
	iters: 900, epoch: 4 | loss: 0.1925358
	speed: 0.0107s/iter; left time: 45.4984s
	iters: 1000, epoch: 4 | loss: 0.3561420
	speed: 0.0103s/iter; left time: 42.3982s
Updating learning rate to 0.000100795293525
Epoch: 4 cost time: 6.515807390213013
Epoch: 4, Steps: 1027 | Train Loss: 0.6064268 Vali Loss: 0.3732529 Best vali loss: 0.3635471
	iters: 100, epoch: 5 | loss: 0.4198408
	speed: 0.0118s/iter; left time: 47.2514s
	iters: 200, epoch: 5 | loss: 0.2907035
	speed: 0.0053s/iter; left time: 20.8447s
	iters: 300, epoch: 5 | loss: 0.7154611
	speed: 0.0054s/iter; left time: 20.4469s
	iters: 400, epoch: 5 | loss: 0.2689075
	speed: 0.0054s/iter; left time: 19.8751s
	iters: 500, epoch: 5 | loss: 0.9341499
	speed: 0.0054s/iter; left time: 19.6654s
	iters: 600, epoch: 5 | loss: 0.2819118
	speed: 0.0053s/iter; left time: 18.6002s
	iters: 700, epoch: 5 | loss: 0.9196126
	speed: 0.0054s/iter; left time: 18.4849s
	iters: 800, epoch: 5 | loss: 1.3388454
	speed: 0.0055s/iter; left time: 18.1445s
	iters: 900, epoch: 5 | loss: 0.2944383
	speed: 0.0054s/iter; left time: 17.3471s
	iters: 1000, epoch: 5 | loss: 0.5074649
	speed: 0.0050s/iter; left time: 15.4511s
Updating learning rate to 5.03976467625e-05
Epoch: 5 cost time: 5.4264140129089355
Epoch: 5, Steps: 1027 | Train Loss: 0.5971336 Vali Loss: 0.3723489 Best vali loss: 0.3635471
	iters: 100, epoch: 6 | loss: 0.2896913
	speed: 0.0142s/iter; left time: 42.3405s
	iters: 200, epoch: 6 | loss: 0.5373745
	speed: 0.0052s/iter; left time: 15.1233s
	iters: 300, epoch: 6 | loss: 0.9397969
	speed: 0.0054s/iter; left time: 14.8899s
	iters: 400, epoch: 6 | loss: 1.3332191
	speed: 0.0053s/iter; left time: 14.0998s
	iters: 500, epoch: 6 | loss: 0.3757785
	speed: 0.0051s/iter; left time: 13.2777s
	iters: 600, epoch: 6 | loss: 0.8445582
	speed: 0.0052s/iter; left time: 12.8076s
	iters: 700, epoch: 6 | loss: 1.4991988
	speed: 0.0052s/iter; left time: 12.3505s
	iters: 800, epoch: 6 | loss: 1.1221243
	speed: 0.0051s/iter; left time: 11.7299s
	iters: 900, epoch: 6 | loss: 0.4303142
	speed: 0.0051s/iter; left time: 11.0637s
	iters: 1000, epoch: 6 | loss: 0.4783565
	speed: 0.0052s/iter; left time: 10.7387s
Updating learning rate to 2.519882338125e-05
Epoch: 6 cost time: 5.329683780670166
Epoch: 6, Steps: 1027 | Train Loss: 0.7850412 Vali Loss: 0.3747396 Best vali loss: 0.3635471
	iters: 100, epoch: 7 | loss: 1.5913092
	speed: 0.0145s/iter; left time: 28.3872s
	iters: 200, epoch: 7 | loss: 0.8546245
	speed: 0.0053s/iter; left time: 9.8651s
	iters: 300, epoch: 7 | loss: 0.4913444
	speed: 0.0053s/iter; left time: 9.3804s
	iters: 400, epoch: 7 | loss: 0.3607656
	speed: 0.0052s/iter; left time: 8.6346s
	iters: 500, epoch: 7 | loss: 0.3754963
	speed: 0.0052s/iter; left time: 8.1623s
	iters: 600, epoch: 7 | loss: 0.1317571
	speed: 0.0052s/iter; left time: 7.6076s
	iters: 700, epoch: 7 | loss: 0.4579126
	speed: 0.0052s/iter; left time: 7.0135s
	iters: 800, epoch: 7 | loss: 0.3725936
	speed: 0.0056s/iter; left time: 6.9941s
	iters: 900, epoch: 7 | loss: 0.2222039
	speed: 0.0055s/iter; left time: 6.3281s
	iters: 1000, epoch: 7 | loss: 1.0781816
	speed: 0.0056s/iter; left time: 5.9189s
Updating learning rate to 1.2599411690625e-05
Epoch: 7 cost time: 5.520496845245361
Epoch: 7, Steps: 1027 | Train Loss: 0.5936189 Vali Loss: 0.3743242 Best vali loss: 0.3635471
	iters: 100, epoch: 8 | loss: 1.0589856
	speed: 0.0146s/iter; left time: 13.5673s
	iters: 200, epoch: 8 | loss: 0.4954415
	speed: 0.0049s/iter; left time: 4.0561s
	iters: 300, epoch: 8 | loss: 0.4055680
	speed: 0.0039s/iter; left time: 2.8512s
	iters: 400, epoch: 8 | loss: 1.4726828
	speed: 0.0039s/iter; left time: 2.4552s
	iters: 500, epoch: 8 | loss: 0.4693640
	speed: 0.0043s/iter; left time: 2.2763s
	iters: 600, epoch: 8 | loss: 0.4496607
	speed: 0.0044s/iter; left time: 1.8839s
	iters: 700, epoch: 8 | loss: 0.9762403
	speed: 0.0043s/iter; left time: 1.4004s
	iters: 800, epoch: 8 | loss: 0.4212842
	speed: 0.0047s/iter; left time: 1.0621s
	iters: 900, epoch: 8 | loss: 0.2960907
	speed: 0.0045s/iter; left time: 0.5795s
	iters: 1000, epoch: 8 | loss: 0.3013337
	speed: 0.0053s/iter; left time: 0.1496s
Updating learning rate to 6.2997058453125e-06
Epoch: 8 cost time: 4.697457551956177
Epoch: 8, Steps: 1027 | Train Loss: 0.6346651 Vali Loss: 0.3740463 Best vali loss: 0.3635471

best validation loss 0.36354710661123685

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0066694129125, 'e_layers': 1, 'learning_rate': 0.0002333035787, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9570439
	speed: 0.0137s/iter; left time: 26.7566s
	iters: 200, epoch: 1 | loss: 0.6660813
	speed: 0.0042s/iter; left time: 7.7560s
Updating learning rate to 0.0002333035787
Validation loss decreased (inf --> 0.3929).  Saving model state dict ...
Epoch: 1 cost time: 1.9493632316589355
Epoch: 1, Steps: 257 | Train Loss: 0.8115626 Vali Loss: 0.3928685 Best vali loss: 0.3928685
	iters: 100, epoch: 2 | loss: 0.9959067
	speed: 0.0155s/iter; left time: 26.3469s
	iters: 200, epoch: 2 | loss: 0.9539254
	speed: 0.0064s/iter; left time: 10.2040s
Updating learning rate to 0.00011665178935
Validation loss decreased (0.3929 --> 0.3751).  Saving model state dict ...
Epoch: 2 cost time: 1.4887807369232178
Epoch: 2, Steps: 257 | Train Loss: 0.9749160 Vali Loss: 0.3751093 Best vali loss: 0.3751093
	iters: 100, epoch: 3 | loss: 0.4606617
	speed: 0.0129s/iter; left time: 18.6051s
	iters: 200, epoch: 3 | loss: 0.7065711
	speed: 0.0028s/iter; left time: 3.7993s
Updating learning rate to 5.8325894675e-05
Validation loss decreased (0.3751 --> 0.3700).  Saving model state dict ...
Epoch: 3 cost time: 0.9707512855529785
Epoch: 3, Steps: 257 | Train Loss: 0.5836164 Vali Loss: 0.3700044 Best vali loss: 0.3700044

best validation loss 0.37000441853330274

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3815647
	speed: 0.0115s/iter; left time: 22.4419s
	iters: 200, epoch: 1 | loss: 0.5868688
	speed: 0.0057s/iter; left time: 10.5512s
Updating learning rate to 0.00017249420488318464
Validation loss decreased (inf --> 0.3619).  Saving model state dict ...
Epoch: 1 cost time: 1.7903187274932861
Epoch: 1, Steps: 257 | Train Loss: 0.4842168 Vali Loss: 0.3619285 Best vali loss: 0.3619285
	iters: 100, epoch: 2 | loss: 0.5720478
	speed: 0.0128s/iter; left time: 21.7346s
	iters: 200, epoch: 2 | loss: 0.3844382
	speed: 0.0057s/iter; left time: 9.1748s
Updating learning rate to 0.0001530584539703962
Validation loss decreased (0.3619 --> 0.3469).  Saving model state dict ...
Epoch: 2 cost time: 1.5065748691558838
Epoch: 2, Steps: 257 | Train Loss: 0.4782430 Vali Loss: 0.3469282 Best vali loss: 0.3469282
	iters: 100, epoch: 3 | loss: 0.8613229
	speed: 0.0128s/iter; left time: 18.5232s
	iters: 200, epoch: 3 | loss: 0.3519106
	speed: 0.0058s/iter; left time: 7.7773s
Updating learning rate to 0.00012397079715258604
Epoch: 3 cost time: 1.5251076221466064
Epoch: 3, Steps: 257 | Train Loss: 0.6066168 Vali Loss: 0.3868819 Best vali loss: 0.3469282

best validation loss 0.346928190259896

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0008069876564, 'e_layers': 3, 'learning_rate': 0.000202447705, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5570660
	speed: 0.0125s/iter; left time: 11.6798s
Updating learning rate to 0.00019474249802669145
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 1.1907389163970947
Epoch: 1, Steps: 129 | Train Loss: 0.5570660 Vali Loss: 0.3677309 Best vali loss: 0.3677309
	iters: 100, epoch: 2 | loss: 0.6623986
	speed: 0.0124s/iter; left time: 10.0023s
Updating learning rate to 0.00017279992502057686
Validation loss decreased (0.3677 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.9941492080688477
Epoch: 2, Steps: 129 | Train Loss: 0.6623986 Vali Loss: 0.3668142 Best vali loss: 0.3668142
	iters: 100, epoch: 3 | loss: 0.5501056
	speed: 0.0121s/iter; left time: 8.1824s
Updating learning rate to 0.00013996054381191757
Epoch: 3 cost time: 0.9581615924835205
Epoch: 3, Steps: 129 | Train Loss: 0.5501056 Vali Loss: 0.3714865 Best vali loss: 0.3668142

best validation loss 0.36681419396681497

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.011457468898, 'e_layers': 2, 'learning_rate': 0.000179319133, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2823499
	speed: 0.0117s/iter; left time: 13.9014s
	iters: 200, epoch: 4 | loss: 0.4257411
	speed: 0.0059s/iter; left time: 6.3716s
Updating learning rate to 8.96595665e-05
Epoch: 4 cost time: 1.7976982593536377
Epoch: 4, Steps: 257 | Train Loss: 0.3540455 Vali Loss: 0.3506965 Best vali loss: 0.3469282
	iters: 100, epoch: 5 | loss: 0.3412195
	speed: 0.0130s/iter; left time: 12.0530s
	iters: 200, epoch: 5 | loss: 0.3430284
	speed: 0.0057s/iter; left time: 4.7541s
Updating learning rate to 5.5348335847413986e-05
Epoch: 5 cost time: 1.5311365127563477
Epoch: 5, Steps: 257 | Train Loss: 0.3421240 Vali Loss: 0.3503983 Best vali loss: 0.3469282
	iters: 100, epoch: 6 | loss: 0.6736696
	speed: 0.0128s/iter; left time: 8.5849s
	iters: 200, epoch: 6 | loss: 0.3120257
	speed: 0.0057s/iter; left time: 3.2604s
Updating learning rate to 2.6260679029603798e-05
Epoch: 6 cost time: 1.556086540222168
Epoch: 6, Steps: 257 | Train Loss: 0.4928477 Vali Loss: 0.3540571 Best vali loss: 0.3469282
	iters: 100, epoch: 7 | loss: 0.3971529
	speed: 0.0127s/iter; left time: 5.2874s
	iters: 200, epoch: 7 | loss: 0.2903176
	speed: 0.0059s/iter; left time: 1.8601s
Updating learning rate to 6.824928116815375e-06
Epoch: 7 cost time: 1.5540292263031006
Epoch: 7, Steps: 257 | Train Loss: 0.3437352 Vali Loss: 0.3527876 Best vali loss: 0.3469282
	iters: 100, epoch: 8 | loss: 0.2991686
	speed: 0.0128s/iter; left time: 2.0151s
	iters: 200, epoch: 8 | loss: 0.4200406
	speed: 0.0057s/iter; left time: 0.3302s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.5240333080291748
Epoch: 8, Steps: 257 | Train Loss: 0.3596046 Vali Loss: 0.3514007 Best vali loss: 0.3469282

best validation loss 0.346928190259896

[INFO][smbo.py:320] Finished 250 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.25739637e-05, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6839761
	speed: 0.0133s/iter; left time: 12.4184s
Updating learning rate to 8.905057700293642e-05
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 1.2955167293548584
Epoch: 1, Steps: 129 | Train Loss: 0.6839761 Vali Loss: 0.3672656 Best vali loss: 0.3672656
	iters: 100, epoch: 2 | loss: 0.7266409
	speed: 0.0127s/iter; left time: 10.2056s
Updating learning rate to 7.901682059679364e-05
Validation loss decreased (0.3673 --> 0.3642).  Saving model state dict ...
Epoch: 2 cost time: 1.0446524620056152
Epoch: 2, Steps: 129 | Train Loss: 0.7266409 Vali Loss: 0.3642146 Best vali loss: 0.3642146
	iters: 100, epoch: 3 | loss: 0.4972380
	speed: 0.0140s/iter; left time: 9.4226s
Updating learning rate to 6.400024293817862e-05
Validation loss decreased (0.3642 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 1.1940906047821045
Epoch: 3, Steps: 129 | Train Loss: 0.4972380 Vali Loss: 0.3638936 Best vali loss: 0.3638936
	iters: 100, epoch: 4 | loss: 0.7235367
	speed: 0.0131s/iter; left time: 7.1390s
Updating learning rate to 4.628698185e-05
Validation loss decreased (0.3639 --> 0.3600).  Saving model state dict ...
Epoch: 4 cost time: 1.0741808414459229
Epoch: 4, Steps: 129 | Train Loss: 0.7235367 Vali Loss: 0.3599520 Best vali loss: 0.3599520
	iters: 100, epoch: 5 | loss: 0.6701241
	speed: 0.0128s/iter; left time: 5.3369s
Updating learning rate to 2.857372076182139e-05
Epoch: 5 cost time: 1.0649712085723877
Epoch: 5, Steps: 129 | Train Loss: 0.6701241 Vali Loss: 0.3654217 Best vali loss: 0.3599520
	iters: 100, epoch: 6 | loss: 0.6439495
	speed: 0.0127s/iter; left time: 3.6468s
Updating learning rate to 1.3557143103206357e-05
Epoch: 6 cost time: 1.0467417240142822
Epoch: 6, Steps: 129 | Train Loss: 0.6439495 Vali Loss: 0.3678559 Best vali loss: 0.3599520
	iters: 100, epoch: 7 | loss: 0.5911763
	speed: 0.0126s/iter; left time: 2.0058s
Updating learning rate to 3.523386697063586e-06
Epoch: 7 cost time: 1.0493793487548828
Epoch: 7, Steps: 129 | Train Loss: 0.5911763 Vali Loss: 0.3663465 Best vali loss: 0.3599520
	iters: 100, epoch: 8 | loss: 0.5816098
	speed: 0.0128s/iter; left time: 0.3854s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.068791151046753
Epoch: 8, Steps: 129 | Train Loss: 0.5816098 Vali Loss: 0.3660431 Best vali loss: 0.3599520

best validation loss 0.3599520461498403

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0044569176576, 'e_layers': 2, 'learning_rate': 0.0006733362287, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7060283
	speed: 0.0120s/iter; left time: 11.2264s
Updating learning rate to 0.0006477088944471344
Validation loss decreased (inf --> 0.3761).  Saving model state dict ...
Epoch: 1 cost time: 1.1003258228302002
Epoch: 1, Steps: 129 | Train Loss: 0.7060283 Vali Loss: 0.3760588 Best vali loss: 0.3760588
	iters: 100, epoch: 2 | loss: 0.7869409
	speed: 0.0104s/iter; left time: 8.3747s
Updating learning rate to 0.0005747284210161729
Validation loss decreased (0.3761 --> 0.3660).  Saving model state dict ...
Epoch: 2 cost time: 0.8088626861572266
Epoch: 2, Steps: 129 | Train Loss: 0.7869409 Vali Loss: 0.3659846 Best vali loss: 0.3659846
	iters: 100, epoch: 3 | loss: 0.6091964
	speed: 0.0101s/iter; left time: 6.7949s
Updating learning rate to 0.00046550542391734053
Epoch: 3 cost time: 0.7943644523620605
Epoch: 3, Steps: 129 | Train Loss: 0.6091964 Vali Loss: 0.3701675 Best vali loss: 0.3659846
	iters: 100, epoch: 4 | loss: 0.7818196
	speed: 0.0103s/iter; left time: 5.6017s
Updating learning rate to 0.00033666811435
Epoch: 4 cost time: 0.8256916999816895
Epoch: 4, Steps: 129 | Train Loss: 0.7818196 Vali Loss: 0.3667856 Best vali loss: 0.3659846
	iters: 100, epoch: 5 | loss: 0.5049405
	speed: 0.0106s/iter; left time: 4.4389s
Updating learning rate to 0.00020783080478265948
Epoch: 5 cost time: 0.837263822555542
Epoch: 5, Steps: 129 | Train Loss: 0.5049405 Vali Loss: 0.3687711 Best vali loss: 0.3659846
	iters: 100, epoch: 6 | loss: 0.7805793
	speed: 0.0103s/iter; left time: 2.9582s
Updating learning rate to 9.8607807683827e-05
Epoch: 6 cost time: 0.8198742866516113
Epoch: 6, Steps: 129 | Train Loss: 0.7805793 Vali Loss: 0.3674185 Best vali loss: 0.3659846
	iters: 100, epoch: 7 | loss: 0.6179434
	speed: 0.0098s/iter; left time: 1.5560s
Updating learning rate to 2.5627334252865573e-05
Epoch: 7 cost time: 0.7784445285797119
Epoch: 7, Steps: 129 | Train Loss: 0.6179434 Vali Loss: 0.3688972 Best vali loss: 0.3659846
	iters: 100, epoch: 8 | loss: 0.7280784
	speed: 0.0111s/iter; left time: 0.3339s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8288061618804932
Epoch: 8, Steps: 129 | Train Loss: 0.7280784 Vali Loss: 0.3691971 Best vali loss: 0.3659846

best validation loss 0.3659846283480788

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00031764682727096065
Validation loss decreased (inf --> 0.3644).  Saving model state dict ...
Epoch: 1 cost time: 1.1993036270141602
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3644044 Best vali loss: 0.3644044
Updating learning rate to 0.00028185603292365586
Validation loss decreased (0.3644 --> 0.3450).  Saving model state dict ...
Epoch: 2 cost time: 0.9512064456939697
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3449587 Best vali loss: 0.3449587
Updating learning rate to 0.00022829132385310412
Epoch: 3 cost time: 0.9714782238006592
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4031382 Best vali loss: 0.3449587

best validation loss 0.34495874540276517

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0009854043892, 'e_layers': 4, 'learning_rate': 0.0004499065077, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3748226
	speed: 0.0115s/iter; left time: 93.6783s
	iters: 200, epoch: 1 | loss: 1.7031068
	speed: 0.0056s/iter; left time: 45.2336s
	iters: 300, epoch: 1 | loss: 0.6032292
	speed: 0.0060s/iter; left time: 47.5274s
	iters: 400, epoch: 1 | loss: 0.8412756
	speed: 0.0062s/iter; left time: 48.4013s
	iters: 500, epoch: 1 | loss: 0.8788892
	speed: 0.0061s/iter; left time: 47.1966s
	iters: 600, epoch: 1 | loss: 0.2956728
	speed: 0.0061s/iter; left time: 46.7058s
	iters: 700, epoch: 1 | loss: 0.2606404
	speed: 0.0061s/iter; left time: 45.9285s
	iters: 800, epoch: 1 | loss: 0.2787510
	speed: 0.0061s/iter; left time: 45.2113s
	iters: 900, epoch: 1 | loss: 0.2709142
	speed: 0.0061s/iter; left time: 44.3579s
	iters: 1000, epoch: 1 | loss: 0.7962517
	speed: 0.0061s/iter; left time: 43.7266s
Updating learning rate to 0.00043278296085383084
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 6.4892799854278564
Epoch: 1, Steps: 1027 | Train Loss: 0.6303553 Vali Loss: 0.3698534 Best vali loss: 0.3698534
	iters: 100, epoch: 2 | loss: 1.0492227
	speed: 0.0166s/iter; left time: 117.6919s
	iters: 200, epoch: 2 | loss: 0.3138767
	speed: 0.0057s/iter; left time: 39.9248s
	iters: 300, epoch: 2 | loss: 0.2907170
	speed: 0.0058s/iter; left time: 40.1419s
	iters: 400, epoch: 2 | loss: 1.2062135
	speed: 0.0062s/iter; left time: 41.8786s
	iters: 500, epoch: 2 | loss: 1.3093864
	speed: 0.0064s/iter; left time: 42.9782s
	iters: 600, epoch: 2 | loss: 0.2523232
	speed: 0.0061s/iter; left time: 40.3341s
	iters: 700, epoch: 2 | loss: 0.7350639
	speed: 0.0062s/iter; left time: 40.0223s
	iters: 800, epoch: 2 | loss: 0.4580482
	speed: 0.0061s/iter; left time: 38.8750s
	iters: 900, epoch: 2 | loss: 0.5925569
	speed: 0.0061s/iter; left time: 38.1370s
	iters: 1000, epoch: 2 | loss: 0.4489920
	speed: 0.0058s/iter; left time: 35.8403s
Updating learning rate to 0.0003840192250973138
Epoch: 2 cost time: 6.214855194091797
Epoch: 2, Steps: 1027 | Train Loss: 0.6656401 Vali Loss: 0.3758067 Best vali loss: 0.3698534
	iters: 100, epoch: 3 | loss: 0.3919147
	speed: 0.0158s/iter; left time: 95.5458s
	iters: 200, epoch: 3 | loss: 1.1220434
	speed: 0.0079s/iter; left time: 47.0416s
	iters: 300, epoch: 3 | loss: 0.2572041
	speed: 0.0075s/iter; left time: 43.9681s
	iters: 400, epoch: 3 | loss: 1.4287347
	speed: 0.0072s/iter; left time: 41.2304s
	iters: 500, epoch: 3 | loss: 1.1043868
	speed: 0.0074s/iter; left time: 41.7734s
	iters: 600, epoch: 3 | loss: 0.4894324
	speed: 0.0064s/iter; left time: 35.7386s
	iters: 700, epoch: 3 | loss: 0.4389127
	speed: 0.0061s/iter; left time: 33.1461s
	iters: 800, epoch: 3 | loss: 0.9379442
	speed: 0.0074s/iter; left time: 39.8868s
	iters: 900, epoch: 3 | loss: 0.3835645
	speed: 0.0074s/iter; left time: 38.9888s
	iters: 1000, epoch: 3 | loss: 0.5768007
	speed: 0.0072s/iter; left time: 37.2934s
Updating learning rate to 0.00031103913715501335
Epoch: 3 cost time: 7.468919038772583
Epoch: 3, Steps: 1027 | Train Loss: 0.7130938 Vali Loss: 0.3727519 Best vali loss: 0.3698534

best validation loss 0.36985337418048464

{'batch_size': 32, 'd_core': 32, 'd_model': 32, 'dropout': 0.0010212612733, 'e_layers': 1, 'learning_rate': 0.001033174495, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7070193
	speed: 0.0100s/iter; left time: 19.5329s
	iters: 200, epoch: 1 | loss: 0.7642816
	speed: 0.0043s/iter; left time: 8.0696s
Updating learning rate to 0.001033174495
Validation loss decreased (inf --> 0.3661).  Saving model state dict ...
Epoch: 1 cost time: 1.408998966217041
Epoch: 1, Steps: 257 | Train Loss: 0.7356505 Vali Loss: 0.3661374 Best vali loss: 0.3661374
	iters: 100, epoch: 2 | loss: 0.3328471
	speed: 0.0111s/iter; left time: 18.8480s
	iters: 200, epoch: 2 | loss: 0.7175149
	speed: 0.0045s/iter; left time: 7.2063s
Updating learning rate to 0.0005165872475
Epoch: 2 cost time: 1.1959543228149414
Epoch: 2, Steps: 257 | Train Loss: 0.5251810 Vali Loss: 0.3705333 Best vali loss: 0.3661374
	iters: 100, epoch: 3 | loss: 0.4078428
	speed: 0.0107s/iter; left time: 15.4733s
	iters: 200, epoch: 3 | loss: 0.6055601
	speed: 0.0044s/iter; left time: 5.8833s
Updating learning rate to 0.00025829362375
Validation loss decreased (0.3661 --> 0.3646).  Saving model state dict ...
Epoch: 3 cost time: 1.1926252841949463
Epoch: 3, Steps: 257 | Train Loss: 0.5067014 Vali Loss: 0.3645745 Best vali loss: 0.3645745

best validation loss 0.3645745317336384

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018384401586, 'e_layers': 4, 'learning_rate': 0.0003302148829, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00016510744145
Epoch: 4 cost time: 1.3699750900268555
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3607743 Best vali loss: 0.3449587
Updating learning rate to 0.00010192355904689593
Epoch: 5 cost time: 1.113682508468628
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3703066 Best vali loss: 0.3449587
Updating learning rate to 4.835884997634416e-05
Epoch: 6 cost time: 1.1270649433135986
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3709066 Best vali loss: 0.3449587
Updating learning rate to 1.2568055629039355e-05
Epoch: 7 cost time: 1.1234760284423828
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3711571 Best vali loss: 0.3449587
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1258795261383057
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3770066 Best vali loss: 0.3449587

best validation loss 0.34495874540276517

{'batch_size': 8, 'd_core': 512, 'd_model': 32, 'dropout': 0.005640097632, 'e_layers': 4, 'learning_rate': 0.0001952136558, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.2234125
	speed: 0.0138s/iter; left time: 111.9655s
	iters: 200, epoch: 1 | loss: 0.3394157
	speed: 0.0079s/iter; left time: 63.1457s
	iters: 300, epoch: 1 | loss: 0.6330255
	speed: 0.0078s/iter; left time: 61.5866s
	iters: 400, epoch: 1 | loss: 0.2860662
	speed: 0.0081s/iter; left time: 62.9415s
	iters: 500, epoch: 1 | loss: 1.0188501
	speed: 0.0067s/iter; left time: 51.6145s
	iters: 600, epoch: 1 | loss: 0.4867103
	speed: 0.0067s/iter; left time: 50.9785s
	iters: 700, epoch: 1 | loss: 0.5238752
	speed: 0.0074s/iter; left time: 55.5668s
	iters: 800, epoch: 1 | loss: 0.2992804
	speed: 0.0081s/iter; left time: 59.9726s
	iters: 900, epoch: 1 | loss: 0.2383996
	speed: 0.0078s/iter; left time: 56.7261s
	iters: 1000, epoch: 1 | loss: 0.9079307
	speed: 0.0079s/iter; left time: 57.1168s
Updating learning rate to 0.0001952136558
Validation loss decreased (inf --> 0.3759).  Saving model state dict ...
Epoch: 1 cost time: 8.155729055404663
Epoch: 1, Steps: 1027 | Train Loss: 0.4956966 Vali Loss: 0.3758895 Best vali loss: 0.3758895
	iters: 100, epoch: 2 | loss: 0.9530472
	speed: 0.0201s/iter; left time: 142.7384s
	iters: 200, epoch: 2 | loss: 0.7917569
	speed: 0.0086s/iter; left time: 60.3098s
	iters: 300, epoch: 2 | loss: 0.4198112
	speed: 0.0088s/iter; left time: 60.9545s
	iters: 400, epoch: 2 | loss: 0.5227911
	speed: 0.0085s/iter; left time: 57.8667s
	iters: 500, epoch: 2 | loss: 0.4585323
	speed: 0.0078s/iter; left time: 52.1330s
	iters: 600, epoch: 2 | loss: 0.2817686
	speed: 0.0064s/iter; left time: 42.3361s
	iters: 700, epoch: 2 | loss: 1.0916864
	speed: 0.0082s/iter; left time: 53.4050s
	iters: 800, epoch: 2 | loss: 1.2633395
	speed: 0.0082s/iter; left time: 52.6312s
	iters: 900, epoch: 2 | loss: 0.9508078
	speed: 0.0082s/iter; left time: 51.5184s
	iters: 1000, epoch: 2 | loss: 0.5068313
	speed: 0.0082s/iter; left time: 50.4585s
Updating learning rate to 9.76068279e-05
Validation loss decreased (0.3759 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 8.375882863998413
Epoch: 2, Steps: 1027 | Train Loss: 0.7240372 Vali Loss: 0.3693728 Best vali loss: 0.3693728
	iters: 100, epoch: 3 | loss: 0.7358196
	speed: 0.0170s/iter; left time: 103.0497s
	iters: 200, epoch: 3 | loss: 0.2047285
	speed: 0.0048s/iter; left time: 28.6930s
	iters: 300, epoch: 3 | loss: 0.4603872
	speed: 0.0047s/iter; left time: 27.3716s
	iters: 400, epoch: 3 | loss: 0.6005375
	speed: 0.0065s/iter; left time: 37.4331s
	iters: 500, epoch: 3 | loss: 1.0964872
	speed: 0.0085s/iter; left time: 48.1549s
	iters: 600, epoch: 3 | loss: 0.4652632
	speed: 0.0082s/iter; left time: 45.8736s
	iters: 700, epoch: 3 | loss: 0.3421844
	speed: 0.0080s/iter; left time: 43.5456s
	iters: 800, epoch: 3 | loss: 0.7789853
	speed: 0.0077s/iter; left time: 41.2757s
	iters: 900, epoch: 3 | loss: 0.9817809
	speed: 0.0069s/iter; left time: 36.3135s
	iters: 1000, epoch: 3 | loss: 0.9433874
	speed: 0.0049s/iter; left time: 25.5365s
Updating learning rate to 4.880341395e-05
Epoch: 3 cost time: 6.683520793914795
Epoch: 3, Steps: 1027 | Train Loss: 0.6609561 Vali Loss: 0.3701550 Best vali loss: 0.3693728
	iters: 100, epoch: 4 | loss: 0.5405151
	speed: 0.0179s/iter; left time: 90.3929s
	iters: 200, epoch: 4 | loss: 0.5166044
	speed: 0.0068s/iter; left time: 33.5576s
	iters: 300, epoch: 4 | loss: 0.2702456
	speed: 0.0072s/iter; left time: 34.7936s
	iters: 400, epoch: 4 | loss: 0.6130564
	speed: 0.0064s/iter; left time: 30.3484s
	iters: 500, epoch: 4 | loss: 1.1100175
	speed: 0.0064s/iter; left time: 29.7333s
	iters: 600, epoch: 4 | loss: 0.4450654
	speed: 0.0063s/iter; left time: 28.7348s
	iters: 700, epoch: 4 | loss: 0.3633884
	speed: 0.0069s/iter; left time: 30.6718s
	iters: 800, epoch: 4 | loss: 1.3859937
	speed: 0.0071s/iter; left time: 30.7230s
	iters: 900, epoch: 4 | loss: 0.5778650
	speed: 0.0065s/iter; left time: 27.7175s
	iters: 1000, epoch: 4 | loss: 0.5115698
	speed: 0.0062s/iter; left time: 25.5783s
Updating learning rate to 2.4401706975e-05
Epoch: 4 cost time: 6.861729860305786
Epoch: 4, Steps: 1027 | Train Loss: 0.6334321 Vali Loss: 0.3701299 Best vali loss: 0.3693728
	iters: 100, epoch: 5 | loss: 0.2641033
	speed: 0.0192s/iter; left time: 76.8869s
	iters: 200, epoch: 5 | loss: 0.5366434
	speed: 0.0068s/iter; left time: 26.4913s
	iters: 300, epoch: 5 | loss: 0.4398530
	speed: 0.0061s/iter; left time: 23.3443s
	iters: 400, epoch: 5 | loss: 0.2077807
	speed: 0.0048s/iter; left time: 17.8159s
	iters: 500, epoch: 5 | loss: 0.2422277
	speed: 0.0050s/iter; left time: 17.9016s
	iters: 600, epoch: 5 | loss: 0.2945678
	speed: 0.0057s/iter; left time: 19.9328s
	iters: 700, epoch: 5 | loss: 0.7458853
	speed: 0.0059s/iter; left time: 20.1371s
	iters: 800, epoch: 5 | loss: 0.8689641
	speed: 0.0053s/iter; left time: 17.4242s
	iters: 900, epoch: 5 | loss: 0.1992826
	speed: 0.0045s/iter; left time: 14.5168s
	iters: 1000, epoch: 5 | loss: 0.3833205
	speed: 0.0057s/iter; left time: 17.8362s
Updating learning rate to 1.22008534875e-05
Epoch: 5 cost time: 5.88947868347168
Epoch: 5, Steps: 1027 | Train Loss: 0.4182628 Vali Loss: 0.3708068 Best vali loss: 0.3693728
	iters: 100, epoch: 6 | loss: 0.3643805
	speed: 0.0215s/iter; left time: 64.1002s
	iters: 200, epoch: 6 | loss: 0.8344750
	speed: 0.0063s/iter; left time: 18.2541s
	iters: 300, epoch: 6 | loss: 0.3108111
	speed: 0.0072s/iter; left time: 20.0390s
	iters: 400, epoch: 6 | loss: 0.5650182
	speed: 0.0064s/iter; left time: 17.2668s
	iters: 500, epoch: 6 | loss: 0.2724257
	speed: 0.0073s/iter; left time: 18.7366s
	iters: 600, epoch: 6 | loss: 1.1267422
	speed: 0.0064s/iter; left time: 16.0032s
	iters: 700, epoch: 6 | loss: 0.7192162
	speed: 0.0086s/iter; left time: 20.5871s
	iters: 800, epoch: 6 | loss: 0.3513308
	speed: 0.0058s/iter; left time: 13.2594s
	iters: 900, epoch: 6 | loss: 0.2559493
	speed: 0.0051s/iter; left time: 11.1340s
	iters: 1000, epoch: 6 | loss: 0.5781712
	speed: 0.0060s/iter; left time: 12.5048s
Updating learning rate to 6.10042674375e-06
Epoch: 6 cost time: 6.928087472915649
Epoch: 6, Steps: 1027 | Train Loss: 0.5378520 Vali Loss: 0.3717605 Best vali loss: 0.3693728
	iters: 100, epoch: 7 | loss: 0.2217487
	speed: 0.0165s/iter; left time: 32.2420s
	iters: 200, epoch: 7 | loss: 0.2963636
	speed: 0.0062s/iter; left time: 11.5117s
	iters: 300, epoch: 7 | loss: 0.1848198
	speed: 0.0057s/iter; left time: 10.0348s
	iters: 400, epoch: 7 | loss: 1.0381263
	speed: 0.0059s/iter; left time: 9.7122s
	iters: 500, epoch: 7 | loss: 0.9977443
	speed: 0.0059s/iter; left time: 9.1816s
	iters: 600, epoch: 7 | loss: 0.4492950
	speed: 0.0055s/iter; left time: 7.9300s
	iters: 700, epoch: 7 | loss: 1.7903388
	speed: 0.0058s/iter; left time: 7.8334s
	iters: 800, epoch: 7 | loss: 0.8354742
	speed: 0.0057s/iter; left time: 7.2038s
	iters: 900, epoch: 7 | loss: 0.4532225
	speed: 0.0056s/iter; left time: 6.4393s
	iters: 1000, epoch: 7 | loss: 0.3575485
	speed: 0.0058s/iter; left time: 6.1106s
Updating learning rate to 3.050213371875e-06
Epoch: 7 cost time: 6.026208877563477
Epoch: 7, Steps: 1027 | Train Loss: 0.6624682 Vali Loss: 0.3712551 Best vali loss: 0.3693728
	iters: 100, epoch: 8 | loss: 0.6784841
	speed: 0.0168s/iter; left time: 15.6051s
	iters: 200, epoch: 8 | loss: 0.3694764
	speed: 0.0063s/iter; left time: 5.1990s
	iters: 300, epoch: 8 | loss: 1.0783535
	speed: 0.0065s/iter; left time: 4.7317s
	iters: 400, epoch: 8 | loss: 1.2908945
	speed: 0.0065s/iter; left time: 4.0509s
	iters: 500, epoch: 8 | loss: 0.9236414
	speed: 0.0064s/iter; left time: 3.3759s
	iters: 600, epoch: 8 | loss: 0.8800530
	speed: 0.0064s/iter; left time: 2.7256s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0036399733072, 'e_layers': 2, 'learning_rate': 0.0011858266081, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.3276986
	speed: 0.0087s/iter; left time: 70.8398s
	iters: 200, epoch: 1 | loss: 0.5916240
	speed: 0.0032s/iter; left time: 25.4616s
	iters: 300, epoch: 1 | loss: 0.4069919
	speed: 0.0045s/iter; left time: 35.2485s
	iters: 400, epoch: 1 | loss: 0.7326809
	speed: 0.0045s/iter; left time: 34.9658s
	iters: 500, epoch: 1 | loss: 0.3425781
	speed: 0.0048s/iter; left time: 36.7980s
	iters: 600, epoch: 1 | loss: 0.8317101
	speed: 0.0050s/iter; left time: 38.0413s
	iters: 700, epoch: 1 | loss: 0.3994733
	speed: 0.0053s/iter; left time: 40.2008s
	iters: 800, epoch: 1 | loss: 0.6834622
	speed: 0.0049s/iter; left time: 36.0131s
	iters: 900, epoch: 1 | loss: 0.3810342
	speed: 0.0050s/iter; left time: 36.5148s
	iters: 1000, epoch: 1 | loss: 0.7151904
	speed: 0.0044s/iter; left time: 32.0985s
Updating learning rate to 0.0011858266081
Validation loss decreased (inf --> 0.3964).  Saving model state dict ...
Epoch: 1 cost time: 4.932826280593872
Epoch: 1, Steps: 1027 | Train Loss: 0.6412444 Vali Loss: 0.3963750 Best vali loss: 0.3963750
	iters: 100, epoch: 2 | loss: 0.9415056
	speed: 0.0140s/iter; left time: 99.1677s
	iters: 200, epoch: 2 | loss: 1.0571992
	speed: 0.0033s/iter; left time: 22.9253s
	iters: 300, epoch: 2 | loss: 0.9326530
	speed: 0.0040s/iter; left time: 27.7732s
	iters: 400, epoch: 2 | loss: 1.3836024
	speed: 0.0048s/iter; left time: 32.5007s
	iters: 500, epoch: 2 | loss: 0.6533211
	speed: 0.0049s/iter; left time: 32.6659s
	iters: 600, epoch: 2 | loss: 0.4795187
	speed: 0.0049s/iter; left time: 32.4964s
	iters: 700, epoch: 2 | loss: 0.9227932
	speed: 0.0049s/iter; left time: 31.9861s
	iters: 800, epoch: 2 | loss: 0.2345540
	speed: 0.0049s/iter; left time: 31.5007s
	iters: 900, epoch: 2 | loss: 0.3652242
	speed: 0.0049s/iter; left time: 30.8921s
	iters: 1000, epoch: 2 | loss: 1.1511242
	speed: 0.0047s/iter; left time: 28.9642s
Updating learning rate to 0.00059291330405
Epoch: 2 cost time: 4.641856670379639
Epoch: 2, Steps: 1027 | Train Loss: 0.8121496 Vali Loss: 0.4137953 Best vali loss: 0.3963750
	iters: 100, epoch: 3 | loss: 0.2632938
	speed: 0.0140s/iter; left time: 84.9163s
	iters: 200, epoch: 3 | loss: 0.3367950
	speed: 0.0049s/iter; left time: 29.1830s
	iters: 300, epoch: 3 | loss: 0.3717758
	speed: 0.0049s/iter; left time: 28.8402s
	iters: 400, epoch: 3 | loss: 0.6777407
	speed: 0.0046s/iter; left time: 26.2597s
	iters: 500, epoch: 3 | loss: 0.4554876
	speed: 0.0046s/iter; left time: 25.8841s
	iters: 600, epoch: 3 | loss: 0.2883069
	speed: 0.0045s/iter; left time: 24.7811s
	iters: 700, epoch: 3 | loss: 0.3239474
	speed: 0.0040s/iter; left time: 21.8129s
	iters: 800, epoch: 3 | loss: 0.3617454
	speed: 0.0036s/iter; left time: 19.1236s
	iters: 900, epoch: 3 | loss: 0.6602821
	speed: 0.0042s/iter; left time: 22.0813s
	iters: 1000, epoch: 3 | loss: 1.1772819
	speed: 0.0042s/iter; left time: 21.8936s
Updating learning rate to 0.000296456652025
Epoch: 3 cost time: 4.594487905502319
Epoch: 3, Steps: 1027 | Train Loss: 0.4916656 Vali Loss: 0.4022217 Best vali loss: 0.3963750
	iters: 100, epoch: 4 | loss: 0.4860593
	speed: 0.0136s/iter; left time: 68.5118s
	iters: 200, epoch: 4 | loss: 0.2535715
	speed: 0.0046s/iter; left time: 22.8386s
	iters: 300, epoch: 4 | loss: 0.8344805
	speed: 0.0048s/iter; left time: 23.1063s
	iters: 400, epoch: 4 | loss: 1.1358072
	speed: 0.0046s/iter; left time: 21.7389s
	iters: 500, epoch: 4 | loss: 0.3502390
	speed: 0.0035s/iter; left time: 16.4069s
	iters: 600, epoch: 4 | loss: 0.6738893
	speed: 0.0032s/iter; left time: 14.3057s
	iters: 700, epoch: 4 | loss: 1.4141132
	speed: 0.0030s/iter; left time: 13.3993s
	iters: 800, epoch: 4 | loss: 0.4745427
	speed: 0.0030s/iter; left time: 13.1899s
	iters: 900, epoch: 4 | loss: 0.9733719
	speed: 0.0045s/iter; left time: 18.9132s
	iters: 1000, epoch: 4 | loss: 1.5082840
	speed: 0.0051s/iter; left time: 21.1729s
Updating learning rate to 0.0001482283260125
Epoch: 4 cost time: 4.263412237167358
Epoch: 4, Steps: 1027 | Train Loss: 0.8104359 Vali Loss: 0.4064070 Best vali loss: 0.3963750
	iters: 100, epoch: 5 | loss: 0.3827983
	speed: 0.0144s/iter; left time: 57.7984s
	iters: 200, epoch: 5 | loss: 0.4349294
	speed: 0.0049s/iter; left time: 19.0199s
	iters: 300, epoch: 5 | loss: 1.1894447
	speed: 0.0050s/iter; left time: 19.0923s
	iters: 400, epoch: 5 | loss: 0.4730509
	speed: 0.0040s/iter; left time: 14.9663s
	iters: 500, epoch: 5 | loss: 0.3891723
	speed: 0.0056s/iter; left time: 20.1572s
	iters: 600, epoch: 5 | loss: 0.9188433
	speed: 0.0060s/iter; left time: 20.9092s
	iters: 700, epoch: 5 | loss: 0.6219796
	speed: 0.0054s/iter; left time: 18.3187s
	iters: 800, epoch: 5 | loss: 0.6554808
	speed: 0.0034s/iter; left time: 11.3368s
	iters: 900, epoch: 5 | loss: 1.3478786
	speed: 0.0031s/iter; left time: 10.0245s
	iters: 1000, epoch: 5 | loss: 0.7012136
	speed: 0.0033s/iter; left time: 10.1900s
Updating learning rate to 7.411416300625e-05
Epoch: 5 cost time: 4.679380655288696
Epoch: 5, Steps: 1027 | Train Loss: 0.7114791 Vali Loss: 0.4042297 Best vali loss: 0.3963750
	iters: 100, epoch: 6 | loss: 0.2834561
	speed: 0.0147s/iter; left time: 43.8131s
	iters: 200, epoch: 6 | loss: 1.1554481
	speed: 0.0045s/iter; left time: 12.9783s
	iters: 300, epoch: 6 | loss: 0.2796347
	speed: 0.0033s/iter; left time: 9.1396s
	iters: 400, epoch: 6 | loss: 0.5092958
	speed: 0.0033s/iter; left time: 8.8598s
	iters: 500, epoch: 6 | loss: 0.4883820
	speed: 0.0038s/iter; left time: 9.8006s
	iters: 600, epoch: 6 | loss: 0.3234299
	speed: 0.0045s/iter; left time: 11.1865s
	iters: 700, epoch: 6 | loss: 0.5299073
	speed: 0.0045s/iter; left time: 10.8047s
	iters: 800, epoch: 6 | loss: 1.7847987
	speed: 0.0046s/iter; left time: 10.4582s
	iters: 900, epoch: 6 | loss: 0.3532824
	speed: 0.0045s/iter; left time: 9.7568s
	iters: 1000, epoch: 6 | loss: 0.6052701
	speed: 0.0045s/iter; left time: 9.2760s
Updating learning rate to 3.7057081503125e-05
Epoch: 6 cost time: 4.373162031173706
Epoch: 6, Steps: 1027 | Train Loss: 0.6312905 Vali Loss: 0.4036787 Best vali loss: 0.3963750
	iters: 100, epoch: 7 | loss: 0.4723436
	speed: 0.0145s/iter; left time: 28.2898s
	iters: 200, epoch: 7 | loss: 1.7271689
	speed: 0.0045s/iter; left time: 8.4230s
	iters: 300, epoch: 7 | loss: 0.6939833
	speed: 0.0046s/iter; left time: 8.1579s
	iters: 400, epoch: 7 | loss: 1.8975676
	speed: 0.0047s/iter; left time: 7.7359s
	iters: 500, epoch: 7 | loss: 0.5914432
	speed: 0.0047s/iter; left time: 7.3461s
	iters: 600, epoch: 7 | loss: 0.3158932
	speed: 0.0046s/iter; left time: 6.7018s
	iters: 700, epoch: 7 | loss: 0.5152705
	speed: 0.0047s/iter; left time: 6.3952s
	iters: 800, epoch: 7 | loss: 0.4426948
	speed: 0.0047s/iter; left time: 5.9403s
	iters: 900, epoch: 7 | loss: 1.0776023
	speed: 0.0049s/iter; left time: 5.6763s
	iters: 1000, epoch: 7 | loss: 1.7892233
	speed: 0.0039s/iter; left time: 4.1264s
Updating learning rate to 1.85285407515625e-05
Epoch: 7 cost time: 4.753474950790405
Epoch: 7, Steps: 1027 | Train Loss: 0.9523191 Vali Loss: 0.4036259 Best vali loss: 0.3963750
	iters: 100, epoch: 8 | loss: 0.9374811
	speed: 0.0137s/iter; left time: 12.7403s
	iters: 200, epoch: 8 | loss: 0.6141354
	speed: 0.0045s/iter; left time: 3.7308s
	iters: 300, epoch: 8 | loss: 1.1529566
	speed: 0.0045s/iter; left time: 3.3051s
	iters: 400, epoch: 8 | loss: 1.7791684
	speed: 0.0046s/iter; left time: 2.8701s
	iters: 500, epoch: 8 | loss: 0.5723180
	speed: 0.0046s/iter; left time: 2.4210s
	iters: 600, epoch: 8 | loss: 0.4927878
	speed: 0.0046s/iter; left time: 1.9863s
	iters: 700, epoch: 8 | loss: 0.4084120
	speed: 0.0038s/iter; left time: 1.2604s
	iters: 800, epoch: 8 | loss: 0.3857283
	speed: 0.0035s/iter; left time: 0.8073s
	iters: 900, epoch: 8 | loss: 0.7954076
	speed: 0.0047s/iter; left time: 0.6080s
	iters: 1000, epoch: 8 | loss: 0.7889951
	speed: 0.0048s/iter; left time: 0.1344s
Updating learning rate to 9.26427037578125e-06
Epoch: 8 cost time: 4.6286585330963135
Epoch: 8, Steps: 1027 | Train Loss: 0.7927390 Vali Loss: 0.4033965 Best vali loss: 0.3963750

best validation loss 0.3963750412398565

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0077699148402, 'e_layers': 2, 'learning_rate': 0.0001964127649, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6145810
	speed: 0.0115s/iter; left time: 22.4698s
	iters: 200, epoch: 1 | loss: 0.5680716
	speed: 0.0054s/iter; left time: 9.9399s
Updating learning rate to 0.0001964127649
Validation loss decreased (inf --> 0.3640).  Saving model state dict ...
Epoch: 1 cost time: 1.6974842548370361
Epoch: 1, Steps: 257 | Train Loss: 0.5913263 Vali Loss: 0.3640019 Best vali loss: 0.3640019
	iters: 100, epoch: 2 | loss: 0.3771756
	speed: 0.0118s/iter; left time: 20.1423s
	iters: 200, epoch: 2 | loss: 0.4611813
	speed: 0.0049s/iter; left time: 7.8858s
Updating learning rate to 9.820638245e-05
Validation loss decreased (0.3640 --> 0.3497).  Saving model state dict ...
Epoch: 2 cost time: 1.3152756690979004
Epoch: 2, Steps: 257 | Train Loss: 0.4191785 Vali Loss: 0.3497326 Best vali loss: 0.3497326
	iters: 100, epoch: 3 | loss: 0.5094424
	speed: 0.0109s/iter; left time: 15.7218s
	iters: 200, epoch: 3 | loss: 0.6055347
	speed: 0.0035s/iter; left time: 4.6420s
Updating learning rate to 4.9103191225e-05
Epoch: 3 cost time: 1.0300753116607666
Epoch: 3, Steps: 257 | Train Loss: 0.5574885 Vali Loss: 0.3566069 Best vali loss: 0.3497326

best validation loss 0.34973255295182026

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.0046875553557, 'e_layers': 4, 'learning_rate': 0.0008574476385, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6945369
	speed: 0.0133s/iter; left time: 53.5157s
	iters: 200, epoch: 1 | loss: 0.3747112
	speed: 0.0075s/iter; left time: 29.4441s
	iters: 300, epoch: 1 | loss: 0.3142379
	speed: 0.0078s/iter; left time: 29.8151s
	iters: 400, epoch: 1 | loss: 1.6241606
	speed: 0.0076s/iter; left time: 28.2368s
	iters: 500, epoch: 1 | loss: 0.3449760
	speed: 0.0076s/iter; left time: 27.5905s
Updating learning rate to 0.0008248129809551434
Validation loss decreased (inf --> 0.3974).  Saving model state dict ...
Epoch: 1 cost time: 4.2206525802612305
Epoch: 1, Steps: 514 | Train Loss: 0.6705245 Vali Loss: 0.3973654 Best vali loss: 0.3973654
	iters: 100, epoch: 2 | loss: 0.4965983
	speed: 0.0155s/iter; left time: 54.3889s
	iters: 200, epoch: 2 | loss: 0.7625862
	speed: 0.0076s/iter; left time: 25.9860s
	iters: 300, epoch: 2 | loss: 0.6143805
	speed: 0.0074s/iter; left time: 24.5543s
	iters: 400, epoch: 2 | loss: 0.6817781
	speed: 0.0077s/iter; left time: 24.6881s
	iters: 500, epoch: 2 | loss: 0.3940170
	speed: 0.0077s/iter; left time: 23.9010s
Updating learning rate to 0.0007318773390978706
Epoch: 2 cost time: 3.991039276123047
Epoch: 2, Steps: 514 | Train Loss: 0.5898720 Vali Loss: 0.4021177 Best vali loss: 0.3973654
	iters: 100, epoch: 3 | loss: 0.9223666
	speed: 0.0149s/iter; left time: 44.5965s
	iters: 200, epoch: 3 | loss: 0.3502018
	speed: 0.0078s/iter; left time: 22.4808s
	iters: 300, epoch: 3 | loss: 0.8085968
	speed: 0.0077s/iter; left time: 21.3957s
	iters: 400, epoch: 3 | loss: 1.0084503
	speed: 0.0076s/iter; left time: 20.2963s
	iters: 500, epoch: 3 | loss: 0.7023865
	speed: 0.0075s/iter; left time: 19.4656s
Updating learning rate to 0.0005927893219372603
Epoch: 3 cost time: 3.9756886959075928
Epoch: 3, Steps: 514 | Train Loss: 0.7584004 Vali Loss: 0.4079025 Best vali loss: 0.3973654

best validation loss 0.3973654410928078

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0092835703757, 'e_layers': 2, 'learning_rate': 0.0006403068671, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0006403068671
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 0.7479763031005859
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710466 Best vali loss: 0.3710466
Updating learning rate to 0.00032015343355
Validation loss decreased (0.3710 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.47271132469177246
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3648155 Best vali loss: 0.3648155
Updating learning rate to 0.000160076716775
Epoch: 3 cost time: 0.4820249080657959
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3677611 Best vali loss: 0.3648155

best validation loss 0.36481552148614743

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0077699148402, 'e_layers': 2, 'learning_rate': 0.0001964127649, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5452975
	speed: 0.0115s/iter; left time: 13.5903s
	iters: 200, epoch: 4 | loss: 0.5245475
	speed: 0.0054s/iter; left time: 5.8876s
Updating learning rate to 2.45515956125e-05
Epoch: 4 cost time: 1.6844968795776367
Epoch: 4, Steps: 257 | Train Loss: 0.5349225 Vali Loss: 0.3583685 Best vali loss: 0.3497326
	iters: 100, epoch: 5 | loss: 0.3636267
	speed: 0.0118s/iter; left time: 10.9922s
	iters: 200, epoch: 5 | loss: 0.4081378
	speed: 0.0055s/iter; left time: 4.5536s
Updating learning rate to 1.227579780625e-05
Epoch: 5 cost time: 1.387627124786377
Epoch: 5, Steps: 257 | Train Loss: 0.3858823 Vali Loss: 0.3559571 Best vali loss: 0.3497326
	iters: 100, epoch: 6 | loss: 0.4721740
	speed: 0.0119s/iter; left time: 8.0115s
	iters: 200, epoch: 6 | loss: 0.5710027
	speed: 0.0055s/iter; left time: 3.1391s
Updating learning rate to 6.137898903125e-06
Epoch: 6 cost time: 1.4140489101409912
Epoch: 6, Steps: 257 | Train Loss: 0.5215883 Vali Loss: 0.3520748 Best vali loss: 0.3497326
	iters: 100, epoch: 7 | loss: 0.7964011
	speed: 0.0120s/iter; left time: 4.9976s
	iters: 200, epoch: 7 | loss: 0.4892185
	speed: 0.0055s/iter; left time: 1.7271s
Updating learning rate to 3.0689494515625e-06
Epoch: 7 cost time: 1.444791316986084
Epoch: 7, Steps: 257 | Train Loss: 0.6428098 Vali Loss: 0.3571741 Best vali loss: 0.3497326
	iters: 100, epoch: 8 | loss: 0.8312933
	speed: 0.0119s/iter; left time: 1.8766s
	iters: 200, epoch: 8 | loss: 0.5176576
	speed: 0.0054s/iter; left time: 0.3145s
Updating learning rate to 1.53447472578125e-06
Epoch: 8 cost time: 1.3871941566467285
Epoch: 8, Steps: 257 | Train Loss: 0.6744754 Vali Loss: 0.3559241 Best vali loss: 0.3497326

best validation loss 0.34973255295182026

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0028852829179, 'e_layers': 3, 'learning_rate': 0.0002361458543, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4962789
	speed: 0.0122s/iter; left time: 23.8297s
	iters: 200, epoch: 1 | loss: 0.4133098
	speed: 0.0066s/iter; left time: 12.1745s
Updating learning rate to 0.0002361458543
Validation loss decreased (inf --> 0.3891).  Saving model state dict ...
Epoch: 1 cost time: 1.9454090595245361
Epoch: 1, Steps: 257 | Train Loss: 0.4547944 Vali Loss: 0.3891136 Best vali loss: 0.3891136
	iters: 100, epoch: 2 | loss: 0.5893683
	speed: 0.0139s/iter; left time: 23.5453s
	iters: 200, epoch: 2 | loss: 0.7605689
	speed: 0.0067s/iter; left time: 10.7437s
Updating learning rate to 0.00011807292715
Validation loss decreased (0.3891 --> 0.3735).  Saving model state dict ...
Epoch: 2 cost time: 1.7542169094085693
Epoch: 2, Steps: 257 | Train Loss: 0.6749686 Vali Loss: 0.3734613 Best vali loss: 0.3734613
	iters: 100, epoch: 3 | loss: 0.9193233
	speed: 0.0142s/iter; left time: 20.4351s
	iters: 200, epoch: 3 | loss: 0.6564758
	speed: 0.0067s/iter; left time: 8.9918s
Updating learning rate to 5.9036463575e-05
Validation loss decreased (0.3735 --> 0.3695).  Saving model state dict ...
Epoch: 3 cost time: 1.7462430000305176
Epoch: 3, Steps: 257 | Train Loss: 0.7878996 Vali Loss: 0.3695257 Best vali loss: 0.3695257
	iters: 100, epoch: 4 | loss: 0.6714843
	speed: 0.0116s/iter; left time: 13.7018s
	iters: 200, epoch: 4 | loss: 0.7015105
	speed: 0.0046s/iter; left time: 5.0291s
Updating learning rate to 2.95182317875e-05
Validation loss decreased (0.3695 --> 0.3680).  Saving model state dict ...
Epoch: 4 cost time: 1.3123350143432617
Epoch: 4, Steps: 257 | Train Loss: 0.6864974 Vali Loss: 0.3680492 Best vali loss: 0.3680492
	iters: 100, epoch: 5 | loss: 0.8446195
	speed: 0.0136s/iter; left time: 12.6554s
	iters: 200, epoch: 5 | loss: 0.8208715
	speed: 0.0061s/iter; left time: 5.0913s
Updating learning rate to 1.475911589375e-05
Validation loss decreased (0.3680 --> 0.3677).  Saving model state dict ...
Epoch: 5 cost time: 1.6250042915344238
Epoch: 5, Steps: 257 | Train Loss: 0.8327455 Vali Loss: 0.3676857 Best vali loss: 0.3676857
	iters: 100, epoch: 6 | loss: 0.4094705
	speed: 0.0133s/iter; left time: 8.9504s
	iters: 200, epoch: 6 | loss: 0.5633349
	speed: 0.0063s/iter; left time: 3.5954s
Updating learning rate to 7.379557946875e-06
Validation loss decreased (0.3677 --> 0.3675).  Saving model state dict ...
Epoch: 6 cost time: 1.6428027153015137
Epoch: 6, Steps: 257 | Train Loss: 0.4864027 Vali Loss: 0.3674994 Best vali loss: 0.3674994
	iters: 100, epoch: 7 | loss: 0.6486335
	speed: 0.0135s/iter; left time: 5.6048s
	iters: 200, epoch: 7 | loss: 0.5371945
	speed: 0.0062s/iter; left time: 1.9380s
Updating learning rate to 3.6897789734375e-06
Validation loss decreased (0.3675 --> 0.3674).  Saving model state dict ...
Epoch: 7 cost time: 1.6656763553619385
Epoch: 7, Steps: 257 | Train Loss: 0.5929140 Vali Loss: 0.3674263 Best vali loss: 0.3674263
	iters: 100, epoch: 8 | loss: 0.7574058
	speed: 0.0136s/iter; left time: 2.1459s
	iters: 200, epoch: 8 | loss: 0.6491451
	speed: 0.0061s/iter; left time: 0.3541s
Updating learning rate to 1.84488948671875e-06
Validation loss decreased (0.3674 --> 0.3674).  Saving model state dict ...
Epoch: 8 cost time: 1.6313879489898682
Epoch: 8, Steps: 257 | Train Loss: 0.7032754 Vali Loss: 0.3673797 Best vali loss: 0.3673797

best validation loss 0.36737970653592017

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023127490055, 'e_layers': 1, 'learning_rate': 0.0017907228824, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0017907228824
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 0.6568090915679932
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3681508 Best vali loss: 0.3681508
Updating learning rate to 0.0008953614412
Epoch: 2 cost time: 0.43714118003845215
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3804318 Best vali loss: 0.3681508
Updating learning rate to 0.0004476807206
Epoch: 3 cost time: 0.39963579177856445
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3799053 Best vali loss: 0.3681508
Updating learning rate to 0.0002238403603
Epoch: 4 cost time: 0.42775440216064453
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4055079 Best vali loss: 0.3681508
Updating learning rate to 0.00011192018015
Epoch: 5 cost time: 0.3910641670227051
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4106643 Best vali loss: 0.3681508
Updating learning rate to 5.5960090075e-05
Epoch: 6 cost time: 0.4264521598815918
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4037768 Best vali loss: 0.3681508
Updating learning rate to 2.79800450375e-05
Epoch: 7 cost time: 0.5476536750793457
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4060499 Best vali loss: 0.3681508
Updating learning rate to 1.399002251875e-05
Epoch: 8 cost time: 0.4264707565307617
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4085922 Best vali loss: 0.3681508

best validation loss 0.3681507827725064

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037670265647, 'e_layers': 4, 'learning_rate': 0.0001328666002, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6020654
	speed: 0.0136s/iter; left time: 54.3783s
	iters: 200, epoch: 1 | loss: 0.8573906
	speed: 0.0072s/iter; left time: 28.3499s
	iters: 300, epoch: 1 | loss: 0.7148792
	speed: 0.0073s/iter; left time: 27.9809s
	iters: 400, epoch: 1 | loss: 0.6796607
	speed: 0.0070s/iter; left time: 26.0874s
	iters: 500, epoch: 1 | loss: 0.6456226
	speed: 0.0072s/iter; left time: 26.0694s
Updating learning rate to 0.00012780966633957002
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 4.033371448516846
Epoch: 1, Steps: 514 | Train Loss: 0.6999237 Vali Loss: 0.3697462 Best vali loss: 0.3697462
	iters: 100, epoch: 2 | loss: 0.5574512
	speed: 0.0143s/iter; left time: 50.0140s
	iters: 200, epoch: 2 | loss: 0.7118611
	speed: 0.0075s/iter; left time: 25.4990s
	iters: 300, epoch: 2 | loss: 0.3409535
	speed: 0.0074s/iter; left time: 24.5380s
	iters: 400, epoch: 2 | loss: 0.3446026
	speed: 0.0071s/iter; left time: 22.7464s
	iters: 500, epoch: 2 | loss: 0.7122200
	speed: 0.0071s/iter; left time: 21.9521s
Updating learning rate to 0.00011340873709731094
Validation loss decreased (0.3697 --> 0.3641).  Saving model state dict ...
Epoch: 2 cost time: 3.77081036567688
Epoch: 2, Steps: 514 | Train Loss: 0.5334177 Vali Loss: 0.3640532 Best vali loss: 0.3640532
	iters: 100, epoch: 3 | loss: 0.5713568
	speed: 0.0147s/iter; left time: 43.9013s
	iters: 200, epoch: 3 | loss: 1.0621749
	speed: 0.0074s/iter; left time: 21.3821s
	iters: 300, epoch: 3 | loss: 0.5813154
	speed: 0.0071s/iter; left time: 19.6566s
	iters: 400, epoch: 3 | loss: 0.4901661
	speed: 0.0071s/iter; left time: 19.1338s
	iters: 500, epoch: 3 | loss: 1.5425711
	speed: 0.0076s/iter; left time: 19.7381s
Updating learning rate to 9.185622340560807e-05
Epoch: 3 cost time: 3.798999547958374
Epoch: 3, Steps: 514 | Train Loss: 0.8495169 Vali Loss: 0.3756093 Best vali loss: 0.3640532

best validation loss 0.36405317614729604

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.0117535854883, 'e_layers': 3, 'learning_rate': 0.0032838958315, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7451047
	speed: 0.0130s/iter; left time: 25.4701s
	iters: 200, epoch: 1 | loss: 0.5367600
	speed: 0.0068s/iter; left time: 12.6659s
Updating learning rate to 0.0032838958315
Validation loss decreased (inf --> 0.3972).  Saving model state dict ...
Epoch: 1 cost time: 2.0919127464294434
Epoch: 1, Steps: 257 | Train Loss: 0.6409324 Vali Loss: 0.3972260 Best vali loss: 0.3972260
	iters: 100, epoch: 2 | loss: 0.9943453
	speed: 0.0147s/iter; left time: 24.9762s
	iters: 200, epoch: 2 | loss: 0.6705810
	speed: 0.0070s/iter; left time: 11.1374s
Updating learning rate to 0.00164194791575
Epoch: 2 cost time: 1.8231260776519775
Epoch: 2, Steps: 257 | Train Loss: 0.8324632 Vali Loss: 0.4015176 Best vali loss: 0.3972260
	iters: 100, epoch: 3 | loss: 0.6091980
	speed: 0.0143s/iter; left time: 20.6029s
	iters: 200, epoch: 3 | loss: 0.6449847
	speed: 0.0061s/iter; left time: 8.1962s
Updating learning rate to 0.000820973957875
Epoch: 3 cost time: 1.6982531547546387
Epoch: 3, Steps: 257 | Train Loss: 0.6270913 Vali Loss: 0.4037795 Best vali loss: 0.3972260

best validation loss 0.3972259919512248

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0064466455121, 'e_layers': 1, 'learning_rate': 5.33657676e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.33657676e-05
Validation loss decreased (inf --> 0.3826).  Saving model state dict ...
Epoch: 1 cost time: 0.7022078037261963
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3825956 Best vali loss: 0.3825956
Updating learning rate to 2.66828838e-05
Validation loss decreased (0.3826 --> 0.3693).  Saving model state dict ...
Epoch: 2 cost time: 0.4271547794342041
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3692975 Best vali loss: 0.3692975
Updating learning rate to 1.33414419e-05
Validation loss decreased (0.3693 --> 0.3664).  Saving model state dict ...
Epoch: 3 cost time: 0.43648195266723633
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3664366 Best vali loss: 0.3664366

best validation loss 0.366436624327905

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0037670265647, 'e_layers': 4, 'learning_rate': 0.0001328666002, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5539279
	speed: 0.0134s/iter; left time: 33.1552s
	iters: 200, epoch: 4 | loss: 0.7948319
	speed: 0.0068s/iter; left time: 16.1144s
	iters: 300, epoch: 4 | loss: 0.6673650
	speed: 0.0074s/iter; left time: 16.7681s
	iters: 400, epoch: 4 | loss: 0.6755637
	speed: 0.0073s/iter; left time: 15.8341s
	iters: 500, epoch: 4 | loss: 0.5466229
	speed: 0.0075s/iter; left time: 15.5879s
Updating learning rate to 6.64333001e-05
Epoch: 4 cost time: 4.025474548339844
Epoch: 4, Steps: 514 | Train Loss: 0.6476623 Vali Loss: 0.3685668 Best vali loss: 0.3640532
	iters: 100, epoch: 5 | loss: 0.4567446
	speed: 0.0147s/iter; left time: 28.8290s
	iters: 200, epoch: 5 | loss: 0.6777683
	speed: 0.0073s/iter; left time: 13.5893s
	iters: 300, epoch: 5 | loss: 0.3428418
	speed: 0.0075s/iter; left time: 13.0915s
	iters: 400, epoch: 5 | loss: 0.3524891
	speed: 0.0072s/iter; left time: 11.8829s
	iters: 500, epoch: 5 | loss: 0.7363667
	speed: 0.0072s/iter; left time: 11.1416s
Updating learning rate to 4.101037679439195e-05
Validation loss decreased (0.3641 --> 0.3598).  Saving model state dict ...
Epoch: 5 cost time: 3.817852020263672
Epoch: 5, Steps: 514 | Train Loss: 0.5132421 Vali Loss: 0.3598160 Best vali loss: 0.3598160
	iters: 100, epoch: 6 | loss: 0.5717542
	speed: 0.0148s/iter; left time: 21.2915s
	iters: 200, epoch: 6 | loss: 1.0047345
	speed: 0.0073s/iter; left time: 9.8644s
	iters: 300, epoch: 6 | loss: 0.5319045
	speed: 0.0070s/iter; left time: 8.7113s
	iters: 400, epoch: 6 | loss: 0.4106485
	speed: 0.0072s/iter; left time: 8.2768s
	iters: 500, epoch: 6 | loss: 1.2572465
	speed: 0.0072s/iter; left time: 7.5160s
Updating learning rate to 1.945786310268906e-05
Epoch: 6 cost time: 3.751217842102051
Epoch: 6, Steps: 514 | Train Loss: 0.7552576 Vali Loss: 0.3669131 Best vali loss: 0.3598160
	iters: 100, epoch: 7 | loss: 0.2248357
	speed: 0.0149s/iter; left time: 13.8245s
	iters: 200, epoch: 7 | loss: 0.4051895
	speed: 0.0073s/iter; left time: 6.0716s
	iters: 300, epoch: 7 | loss: 0.5098790
	speed: 0.0069s/iter; left time: 5.0375s
	iters: 400, epoch: 7 | loss: 0.3649721
	speed: 0.0071s/iter; left time: 4.4715s
	iters: 500, epoch: 7 | loss: 0.5906773
	speed: 0.0050s/iter; left time: 2.6471s
Updating learning rate to 5.056933860429982e-06
Epoch: 7 cost time: 3.473198413848877
Epoch: 7, Steps: 514 | Train Loss: 0.4191107 Vali Loss: 0.3653942 Best vali loss: 0.3598160
	iters: 100, epoch: 8 | loss: 0.8987497
	speed: 0.0122s/iter; left time: 5.0607s
	iters: 200, epoch: 8 | loss: 0.4372036
	speed: 0.0068s/iter; left time: 2.1497s
	iters: 300, epoch: 8 | loss: 0.4226608
	speed: 0.0069s/iter; left time: 1.4778s
	iters: 400, epoch: 8 | loss: 0.9272993
	speed: 0.0051s/iter; left time: 0.5810s
	iters: 500, epoch: 8 | loss: 0.3358063
	speed: 0.0057s/iter; left time: 0.0848s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.301145076751709
Epoch: 8, Steps: 514 | Train Loss: 0.6043439 Vali Loss: 0.3658204 Best vali loss: 0.3598160

best validation loss 0.35981603319846345

{'batch_size': 16, 'd_core': 32, 'd_model': 256, 'dropout': 0.0014486999551, 'e_layers': 4, 'learning_rate': 0.000583131487, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4845753
	speed: 0.0127s/iter; left time: 50.9725s
	iters: 200, epoch: 1 | loss: 0.4419569
	speed: 0.0073s/iter; left time: 28.6886s
	iters: 300, epoch: 1 | loss: 1.3271286
	speed: 0.0075s/iter; left time: 28.7800s
	iters: 400, epoch: 1 | loss: 0.5763934
	speed: 0.0074s/iter; left time: 27.3911s
	iters: 500, epoch: 1 | loss: 0.7067075
	speed: 0.0074s/iter; left time: 26.7824s
Updating learning rate to 0.0005609373663010857
Validation loss decreased (inf --> 0.3932).  Saving model state dict ...
Epoch: 1 cost time: 4.060214042663574
Epoch: 1, Steps: 514 | Train Loss: 0.7073524 Vali Loss: 0.3931971 Best vali loss: 0.3931971
	iters: 100, epoch: 2 | loss: 0.8713740
	speed: 0.0136s/iter; left time: 47.6594s
	iters: 200, epoch: 2 | loss: 0.8052583
	speed: 0.0072s/iter; left time: 24.4463s
	iters: 300, epoch: 2 | loss: 1.0010458
	speed: 0.0076s/iter; left time: 24.9595s
	iters: 400, epoch: 2 | loss: 0.4466119
	speed: 0.0076s/iter; left time: 24.2463s
	iters: 500, epoch: 2 | loss: 0.3912948
	speed: 0.0073s/iter; left time: 22.5711s
Updating learning rate to 0.0004977338578905475
Validation loss decreased (0.3932 --> 0.3811).  Saving model state dict ...
Epoch: 2 cost time: 3.775822401046753
Epoch: 2, Steps: 514 | Train Loss: 0.7031170 Vali Loss: 0.3811005 Best vali loss: 0.3811005
	iters: 100, epoch: 3 | loss: 0.5107838
	speed: 0.0135s/iter; left time: 40.3303s
	iters: 200, epoch: 3 | loss: 0.5854124
	speed: 0.0050s/iter; left time: 14.3404s
	iters: 300, epoch: 3 | loss: 0.2790289
	speed: 0.0069s/iter; left time: 19.3417s
	iters: 400, epoch: 3 | loss: 0.2799156
	speed: 0.0074s/iter; left time: 19.8193s
	iters: 500, epoch: 3 | loss: 1.1198622
	speed: 0.0073s/iter; left time: 18.8187s
Updating learning rate to 0.0004031431229826594
Validation loss decreased (0.3811 --> 0.3771).  Saving model state dict ...
Epoch: 3 cost time: 3.4634664058685303
Epoch: 3, Steps: 514 | Train Loss: 0.5550006 Vali Loss: 0.3771261 Best vali loss: 0.3771261
	iters: 100, epoch: 4 | loss: 0.3387183
	speed: 0.0145s/iter; left time: 35.9283s
	iters: 200, epoch: 4 | loss: 0.8602633
	speed: 0.0071s/iter; left time: 16.9216s
	iters: 300, epoch: 4 | loss: 0.5316392
	speed: 0.0075s/iter; left time: 17.0769s
	iters: 400, epoch: 4 | loss: 0.6888424
	speed: 0.0074s/iter; left time: 16.1469s
	iters: 500, epoch: 4 | loss: 0.8689289
	speed: 0.0073s/iter; left time: 15.0186s
Updating learning rate to 0.0002915657435
Epoch: 4 cost time: 3.8209095001220703
Epoch: 4, Steps: 514 | Train Loss: 0.6576784 Vali Loss: 0.3782532 Best vali loss: 0.3771261
	iters: 100, epoch: 5 | loss: 0.3554346
	speed: 0.0139s/iter; left time: 27.1173s
	iters: 200, epoch: 5 | loss: 0.3968422
	speed: 0.0071s/iter; left time: 13.2105s
	iters: 300, epoch: 5 | loss: 0.4116063
	speed: 0.0074s/iter; left time: 12.9734s
	iters: 400, epoch: 5 | loss: 0.4742038
	speed: 0.0073s/iter; left time: 12.1233s
	iters: 500, epoch: 5 | loss: 0.7790672
	speed: 0.0075s/iter; left time: 11.6024s
Updating learning rate to 0.00017998836401734064
Epoch: 5 cost time: 3.785609006881714
Epoch: 5, Steps: 514 | Train Loss: 0.4834308 Vali Loss: 0.3901000 Best vali loss: 0.3771261
	iters: 100, epoch: 6 | loss: 0.6707017
	speed: 0.0144s/iter; left time: 20.7243s
	iters: 200, epoch: 6 | loss: 0.5224780
	speed: 0.0057s/iter; left time: 7.6824s
	iters: 300, epoch: 6 | loss: 0.6916147
	speed: 0.0048s/iter; left time: 6.0195s
	iters: 400, epoch: 6 | loss: 0.8396854
	speed: 0.0068s/iter; left time: 7.7298s
	iters: 500, epoch: 6 | loss: 0.5394296
	speed: 0.0072s/iter; left time: 7.4894s
Updating learning rate to 8.539762910945248e-05
Epoch: 6 cost time: 3.3376126289367676
Epoch: 6, Steps: 514 | Train Loss: 0.6527819 Vali Loss: 0.3960882 Best vali loss: 0.3771261
	iters: 100, epoch: 7 | loss: 0.3790693
	speed: 0.0141s/iter; left time: 13.0832s
	iters: 200, epoch: 7 | loss: 0.3064089
	speed: 0.0072s/iter; left time: 5.9931s
	iters: 300, epoch: 7 | loss: 0.4418661
	speed: 0.0071s/iter; left time: 5.1914s
	iters: 400, epoch: 7 | loss: 0.4444085
	speed: 0.0071s/iter; left time: 4.4885s
	iters: 500, epoch: 7 | loss: 0.8679222
	speed: 0.0073s/iter; left time: 3.8870s
Updating learning rate to 2.219412069891426e-05
Epoch: 7 cost time: 3.7422447204589844
Epoch: 7, Steps: 514 | Train Loss: 0.4879350 Vali Loss: 0.3913355 Best vali loss: 0.3771261
	iters: 100, epoch: 8 | loss: 0.5799050
	speed: 0.0139s/iter; left time: 5.7884s
	iters: 200, epoch: 8 | loss: 0.9032941
	speed: 0.0076s/iter; left time: 2.3816s
	iters: 300, epoch: 8 | loss: 0.2685829
	speed: 0.0076s/iter; left time: 1.6296s
	iters: 400, epoch: 8 | loss: 0.3532116
	speed: 0.0073s/iter; left time: 0.8447s
	iters: 500, epoch: 8 | loss: 0.2675191
	speed: 0.0075s/iter; left time: 0.1119s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.8584847450256348
Epoch: 8, Steps: 514 | Train Loss: 0.4745025 Vali Loss: 0.3945845 Best vali loss: 0.3771261

best validation loss 0.3771260569044087

{'batch_size': 8, 'd_core': 512, 'd_model': 512, 'dropout': 0.011623072433, 'e_layers': 3, 'learning_rate': 0.0006327740511, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3948332
	speed: 0.0109s/iter; left time: 88.3467s
	iters: 200, epoch: 1 | loss: 0.3087479
	speed: 0.0057s/iter; left time: 46.0637s
	iters: 300, epoch: 1 | loss: 0.3551407
	speed: 0.0059s/iter; left time: 46.5736s
	iters: 400, epoch: 1 | loss: 0.7430070
	speed: 0.0058s/iter; left time: 45.0635s
	iters: 500, epoch: 1 | loss: 0.3280271
	speed: 0.0058s/iter; left time: 44.7224s
	iters: 600, epoch: 1 | loss: 0.4154135
	speed: 0.0054s/iter; left time: 40.9125s
	iters: 700, epoch: 1 | loss: 1.3787715
	speed: 0.0054s/iter; left time: 40.2334s
	iters: 800, epoch: 1 | loss: 0.6521071
	speed: 0.0053s/iter; left time: 39.4186s
	iters: 900, epoch: 1 | loss: 0.6127255
	speed: 0.0054s/iter; left time: 39.5679s
	iters: 1000, epoch: 1 | loss: 0.9230267
	speed: 0.0056s/iter; left time: 40.1569s
Updating learning rate to 0.0006086905228077705
Validation loss decreased (inf --> 0.3985).  Saving model state dict ...
Epoch: 1 cost time: 5.977464914321899
Epoch: 1, Steps: 1027 | Train Loss: 0.6111800 Vali Loss: 0.3984877 Best vali loss: 0.3984877
	iters: 100, epoch: 2 | loss: 0.5546181
	speed: 0.0162s/iter; left time: 114.7304s
	iters: 200, epoch: 2 | loss: 0.9837444
	speed: 0.0054s/iter; left time: 37.4279s
	iters: 300, epoch: 2 | loss: 0.3513846
	speed: 0.0047s/iter; left time: 32.6609s
	iters: 400, epoch: 2 | loss: 1.0001904
	speed: 0.0041s/iter; left time: 27.5299s
	iters: 500, epoch: 2 | loss: 1.8230067
	speed: 0.0043s/iter; left time: 29.0283s
	iters: 600, epoch: 2 | loss: 0.6684052
	speed: 0.0075s/iter; left time: 49.1062s
	iters: 700, epoch: 2 | loss: 1.2367996
	speed: 0.0058s/iter; left time: 37.9413s
	iters: 800, epoch: 2 | loss: 0.7236665
	speed: 0.0077s/iter; left time: 49.1642s
	iters: 900, epoch: 2 | loss: 0.2638971
	speed: 0.0059s/iter; left time: 37.1273s
	iters: 1000, epoch: 2 | loss: 1.1152368
	speed: 0.0076s/iter; left time: 47.3420s
Updating learning rate to 0.0005401064367958465
Epoch: 2 cost time: 6.056484937667847
Epoch: 2, Steps: 1027 | Train Loss: 0.8720949 Vali Loss: 0.3986790 Best vali loss: 0.3984877
	iters: 100, epoch: 3 | loss: 1.2791961
	speed: 0.0187s/iter; left time: 113.2790s
	iters: 200, epoch: 3 | loss: 0.4180029
	speed: 0.0057s/iter; left time: 34.2771s
	iters: 300, epoch: 3 | loss: 0.6848398
	speed: 0.0065s/iter; left time: 38.3849s
	iters: 400, epoch: 3 | loss: 0.4472942
	speed: 0.0059s/iter; left time: 33.8506s
	iters: 500, epoch: 3 | loss: 0.5626898
	speed: 0.0065s/iter; left time: 36.7674s
	iters: 600, epoch: 3 | loss: 1.1066151
	speed: 0.0058s/iter; left time: 32.0352s
	iters: 700, epoch: 3 | loss: 0.7713001
	speed: 0.0063s/iter; left time: 34.5270s
	iters: 800, epoch: 3 | loss: 1.8044686
	speed: 0.0061s/iter; left time: 32.7571s
	iters: 900, epoch: 3 | loss: 1.5290191
	speed: 0.0039s/iter; left time: 20.3642s
	iters: 1000, epoch: 3 | loss: 1.1691126
	speed: 0.0037s/iter; left time: 19.0905s
Updating learning rate to 0.00043746309844325536
Epoch: 3 cost time: 5.884136438369751
Epoch: 3, Steps: 1027 | Train Loss: 0.9772538 Vali Loss: 0.4017399 Best vali loss: 0.3984877
	iters: 100, epoch: 4 | loss: 0.3791802
	speed: 0.0207s/iter; left time: 104.0952s
	iters: 200, epoch: 4 | loss: 1.4247069
	speed: 0.0074s/iter; left time: 36.3589s
	iters: 300, epoch: 4 | loss: 0.2373879
	speed: 0.0077s/iter; left time: 37.2389s
	iters: 400, epoch: 4 | loss: 0.3310455
	speed: 0.0070s/iter; left time: 32.9728s
	iters: 500, epoch: 4 | loss: 1.3210086
	speed: 0.0082s/iter; left time: 37.9319s
	iters: 600, epoch: 4 | loss: 0.3169102
	speed: 0.0064s/iter; left time: 28.8788s
	iters: 700, epoch: 4 | loss: 0.6223334
	speed: 0.0087s/iter; left time: 38.5680s
	iters: 800, epoch: 4 | loss: 0.3293913
	speed: 0.0059s/iter; left time: 25.4327s
	iters: 900, epoch: 4 | loss: 1.0463026
	speed: 0.0091s/iter; left time: 38.5417s
	iters: 1000, epoch: 4 | loss: 0.5154440
	speed: 0.0060s/iter; left time: 25.0120s
Updating learning rate to 0.00031638702555
Epoch: 4 cost time: 7.651537179946899
Epoch: 4, Steps: 1027 | Train Loss: 0.6523711 Vali Loss: 0.3999699 Best vali loss: 0.3984877
	iters: 100, epoch: 5 | loss: 0.4888654
	speed: 0.0227s/iter; left time: 90.8782s
	iters: 200, epoch: 5 | loss: 0.2405767
	speed: 0.0046s/iter; left time: 18.0801s
	iters: 300, epoch: 5 | loss: 0.3341015
	speed: 0.0044s/iter; left time: 16.6502s
	iters: 400, epoch: 5 | loss: 1.2149003
	speed: 0.0042s/iter; left time: 15.7345s
	iters: 500, epoch: 5 | loss: 0.6979993
	speed: 0.0039s/iter; left time: 14.0768s
	iters: 600, epoch: 5 | loss: 0.7823857
	speed: 0.0041s/iter; left time: 14.3895s
	iters: 700, epoch: 5 | loss: 0.9287468
	speed: 0.0044s/iter; left time: 15.0496s
	iters: 800, epoch: 5 | loss: 0.6881140
	speed: 0.0044s/iter; left time: 14.4198s
	iters: 900, epoch: 5 | loss: 1.1418828
	speed: 0.0046s/iter; left time: 14.6652s
	iters: 1000, epoch: 5 | loss: 0.3088432
	speed: 0.0040s/iter; left time: 12.3168s
Updating learning rate to 0.00019531095265674467
Epoch: 5 cost time: 4.8725879192352295
Epoch: 5, Steps: 1027 | Train Loss: 0.6826416 Vali Loss: 0.4045288 Best vali loss: 0.3984877
	iters: 100, epoch: 6 | loss: 0.8123683
	speed: 0.0168s/iter; left time: 49.9991s
	iters: 200, epoch: 6 | loss: 1.3972226
	speed: 0.0096s/iter; left time: 27.6844s
	iters: 300, epoch: 6 | loss: 1.1561900
	speed: 0.0068s/iter; left time: 18.8876s
	iters: 400, epoch: 6 | loss: 0.6997705
	speed: 0.0075s/iter; left time: 20.1290s
	iters: 500, epoch: 6 | loss: 0.8324480
	speed: 0.0095s/iter; left time: 24.4173s
	iters: 600, epoch: 6 | loss: 1.1665958
	speed: 0.0087s/iter; left time: 21.5955s
	iters: 700, epoch: 6 | loss: 0.2629935
	speed: 0.0055s/iter; left time: 12.9925s
	iters: 800, epoch: 6 | loss: 0.8783711
	speed: 0.0096s/iter; left time: 21.8647s
	iters: 900, epoch: 6 | loss: 0.3167532
	speed: 0.0095s/iter; left time: 20.6669s
	iters: 1000, epoch: 6 | loss: 1.3789502
	speed: 0.0066s/iter; left time: 13.6603s
Updating learning rate to 9.266761430415355e-05
Epoch: 6 cost time: 8.421741008758545
Epoch: 6, Steps: 1027 | Train Loss: 0.8901663 Vali Loss: 0.4024704 Best vali loss: 0.3984877
	iters: 100, epoch: 7 | loss: 0.4338803
	speed: 0.0115s/iter; left time: 22.5373s
	iters: 200, epoch: 7 | loss: 0.3498948
	speed: 0.0055s/iter; left time: 10.1744s
	iters: 300, epoch: 7 | loss: 2.0944848
	speed: 0.0055s/iter; left time: 9.6269s
	iters: 400, epoch: 7 | loss: 0.8938993
	speed: 0.0055s/iter; left time: 9.0959s
	iters: 500, epoch: 7 | loss: 0.4444025
	speed: 0.0053s/iter; left time: 8.1810s
	iters: 600, epoch: 7 | loss: 1.3333967
	speed: 0.0053s/iter; left time: 7.7651s
	iters: 700, epoch: 7 | loss: 0.3269385
	speed: 0.0052s/iter; left time: 7.0565s
	iters: 800, epoch: 7 | loss: 0.4910907
	speed: 0.0053s/iter; left time: 6.6832s
	iters: 900, epoch: 7 | loss: 0.6229824
	speed: 0.0052s/iter; left time: 6.0443s
	iters: 1000, epoch: 7 | loss: 1.0549701
	speed: 0.0052s/iter; left time: 5.4619s
Updating learning rate to 2.4083528292229468e-05
Epoch: 7 cost time: 5.448213815689087
Epoch: 7, Steps: 1027 | Train Loss: 0.8045940 Vali Loss: 0.4039775 Best vali loss: 0.3984877
	iters: 100, epoch: 8 | loss: 0.5202159
	speed: 0.0155s/iter; left time: 14.3622s
	iters: 200, epoch: 8 | loss: 1.1547899
	speed: 0.0052s/iter; left time: 4.3319s
	iters: 300, epoch: 8 | loss: 0.4292956
	speed: 0.0048s/iter; left time: 3.5186s
	iters: 400, epoch: 8 | loss: 1.0312924
	speed: 0.0053s/iter; left time: 3.3049s
	iters: 500, epoch: 8 | loss: 0.9467572
	speed: 0.0053s/iter; left time: 2.8100s
	iters: 600, epoch: 8 | loss: 0.4401354
	speed: 0.0054s/iter; left time: 2.3168s
	iters: 700, epoch: 8 | loss: 0.4500789
	speed: 0.0054s/iter; left time: 1.7861s
	iters: 800, epoch: 8 | loss: 0.5054268
	speed: 0.0054s/iter; left time: 1.2324s
	iters: 900, epoch: 8 | loss: 1.7408168
	speed: 0.0055s/iter; left time: 0.7061s
	iters: 1000, epoch: 8 | loss: 0.5708321
	speed: 0.0051s/iter; left time: 0.1420s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.468967914581299
Epoch: 8, Steps: 1027 | Train Loss: 0.7789641 Vali Loss: 0.4032815 Best vali loss: 0.3984877

best validation loss 0.3984877408370522

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005459653869797237
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 0.9465715885162354
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3658603 Best vali loss: 0.3658603
Updating learning rate to 0.0004844488434208944
Epoch: 2 cost time: 0.6380040645599365
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3724518 Best vali loss: 0.3658603
Updating learning rate to 0.00039238282983148796
Epoch: 3 cost time: 0.5504546165466309
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3974006 Best vali loss: 0.3658603

best validation loss 0.3658603139851089

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0008402255115, 'e_layers': 4, 'learning_rate': 0.0005990276297, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.4458277
	speed: 0.0145s/iter; left time: 58.1674s
	iters: 200, epoch: 1 | loss: 0.5924250
	speed: 0.0082s/iter; left time: 32.2254s
	iters: 300, epoch: 1 | loss: 0.3628941
	speed: 0.0093s/iter; left time: 35.6152s
	iters: 400, epoch: 1 | loss: 0.2771052
	speed: 0.0087s/iter; left time: 32.2441s
	iters: 500, epoch: 1 | loss: 0.6452069
	speed: 0.0084s/iter; left time: 30.2084s
Updating learning rate to 0.00057622849809429
Validation loss decreased (inf --> 0.3680).  Saving model state dict ...
Epoch: 1 cost time: 4.768265247344971
Epoch: 1, Steps: 514 | Train Loss: 0.6646918 Vali Loss: 0.3679803 Best vali loss: 0.3679803
	iters: 100, epoch: 2 | loss: 0.2892870
	speed: 0.0191s/iter; left time: 66.7278s
	iters: 200, epoch: 2 | loss: 0.7509274
	speed: 0.0088s/iter; left time: 30.0738s
	iters: 300, epoch: 2 | loss: 0.4968356
	speed: 0.0095s/iter; left time: 31.3133s
	iters: 400, epoch: 2 | loss: 0.7123547
	speed: 0.0085s/iter; left time: 27.1573s
	iters: 500, epoch: 2 | loss: 0.4493312
	speed: 0.0050s/iter; left time: 15.4361s
Updating learning rate to 0.000511302064389487
Epoch: 2 cost time: 4.157888650894165
Epoch: 2, Steps: 514 | Train Loss: 0.5397472 Vali Loss: 0.3753471 Best vali loss: 0.3679803
	iters: 100, epoch: 3 | loss: 0.7642769
	speed: 0.0117s/iter; left time: 34.9171s
	iters: 200, epoch: 3 | loss: 0.9882183
	speed: 0.0066s/iter; left time: 19.0047s
	iters: 300, epoch: 3 | loss: 0.4169848
	speed: 0.0069s/iter; left time: 19.1082s
	iters: 400, epoch: 3 | loss: 0.6078095
	speed: 0.0068s/iter; left time: 18.2694s
	iters: 500, epoch: 3 | loss: 0.7590621
	speed: 0.0067s/iter; left time: 17.2737s
Updating learning rate to 0.00041413278955756
Epoch: 3 cost time: 3.510331869125366
Epoch: 3, Steps: 514 | Train Loss: 0.7072703 Vali Loss: 0.3758032 Best vali loss: 0.3679803

best validation loss 0.3679802747161543

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0055356354333, 'e_layers': 4, 'learning_rate': 0.0007477641146, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8741750
	speed: 0.0125s/iter; left time: 50.2108s
	iters: 200, epoch: 1 | loss: 0.5000176
	speed: 0.0053s/iter; left time: 20.7155s
	iters: 300, epoch: 1 | loss: 0.6944180
	speed: 0.0065s/iter; left time: 24.6497s
	iters: 400, epoch: 1 | loss: 0.8205538
	speed: 0.0064s/iter; left time: 23.7606s
	iters: 500, epoch: 1 | loss: 0.4990869
	speed: 0.0065s/iter; left time: 23.5720s
Updating learning rate to 0.0007477641146
Validation loss decreased (inf --> 0.3731).  Saving model state dict ...
Epoch: 1 cost time: 3.478487730026245
Epoch: 1, Steps: 514 | Train Loss: 0.6776503 Vali Loss: 0.3730724 Best vali loss: 0.3730724
	iters: 100, epoch: 2 | loss: 0.4880288
	speed: 0.0138s/iter; left time: 48.2996s
	iters: 200, epoch: 2 | loss: 0.2668203
	speed: 0.0071s/iter; left time: 24.0212s
	iters: 300, epoch: 2 | loss: 0.2922240
	speed: 0.0066s/iter; left time: 21.8220s
	iters: 400, epoch: 2 | loss: 0.6839111
	speed: 0.0066s/iter; left time: 20.9984s
	iters: 500, epoch: 2 | loss: 0.5007269
	speed: 0.0065s/iter; left time: 20.2733s
Updating learning rate to 0.0003738820573
Validation loss decreased (0.3731 --> 0.3729).  Saving model state dict ...
Epoch: 2 cost time: 3.472513198852539
Epoch: 2, Steps: 514 | Train Loss: 0.4463422 Vali Loss: 0.3729208 Best vali loss: 0.3729208
	iters: 100, epoch: 3 | loss: 0.6441681
	speed: 0.0136s/iter; left time: 40.4900s
	iters: 200, epoch: 3 | loss: 0.5942022
	speed: 0.0064s/iter; left time: 18.5681s
	iters: 300, epoch: 3 | loss: 0.6839634
	speed: 0.0067s/iter; left time: 18.6625s
	iters: 400, epoch: 3 | loss: 0.6128356
	speed: 0.0066s/iter; left time: 17.7837s
	iters: 500, epoch: 3 | loss: 0.5633767
	speed: 0.0066s/iter; left time: 16.9952s
Updating learning rate to 0.00018694102865
Epoch: 3 cost time: 3.4606456756591797
Epoch: 3, Steps: 514 | Train Loss: 0.6197092 Vali Loss: 0.3796656 Best vali loss: 0.3729208

best validation loss 0.3729208276524759

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0002837835622
Validation loss decreased (0.3659 --> 0.3544).  Saving model state dict ...
Epoch: 4 cost time: 0.7200803756713867
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3544132 Best vali loss: 0.3544132
Updating learning rate to 0.00017518429456851207
Validation loss decreased (0.3544 --> 0.3541).  Saving model state dict ...
Epoch: 5 cost time: 0.5195577144622803
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3541284 Best vali loss: 0.3541284
Updating learning rate to 8.311828097910562e-05
Epoch: 6 cost time: 0.48441648483276367
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3583291 Best vali loss: 0.3541284
Updating learning rate to 2.1601737420276337e-05
Epoch: 7 cost time: 0.4795374870300293
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3560620 Best vali loss: 0.3541284
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5094051361083984
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3569647 Best vali loss: 0.3541284

best validation loss 0.3541283998250493

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0008863391839, 'e_layers': 1, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5544616
	speed: 0.0100s/iter; left time: 19.6406s
	iters: 200, epoch: 1 | loss: 0.5009557
	speed: 0.0037s/iter; left time: 6.8472s
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.3672).  Saving model state dict ...
Epoch: 1 cost time: 1.2369778156280518
Epoch: 1, Steps: 257 | Train Loss: 0.5277086 Vali Loss: 0.3672177 Best vali loss: 0.3672177
	iters: 100, epoch: 2 | loss: 0.3676723
	speed: 0.0096s/iter; left time: 16.3826s
	iters: 200, epoch: 2 | loss: 0.6470698
	speed: 0.0043s/iter; left time: 6.9058s
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 1.0635733604431152
Epoch: 2, Steps: 257 | Train Loss: 0.5073711 Vali Loss: 0.3760928 Best vali loss: 0.3672177
	iters: 100, epoch: 3 | loss: 0.3755044
	speed: 0.0093s/iter; left time: 13.4136s
	iters: 200, epoch: 3 | loss: 0.3296528
	speed: 0.0037s/iter; left time: 4.9508s
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.9646303653717041
Epoch: 3, Steps: 257 | Train Loss: 0.3525786 Vali Loss: 0.3811423 Best vali loss: 0.3672177
	iters: 100, epoch: 4 | loss: 0.7964024
	speed: 0.0092s/iter; left time: 10.8878s
	iters: 200, epoch: 4 | loss: 0.3865919
	speed: 0.0033s/iter; left time: 3.5699s
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.9316201210021973
Epoch: 4, Steps: 257 | Train Loss: 0.5914972 Vali Loss: 0.3954916 Best vali loss: 0.3672177
	iters: 100, epoch: 5 | loss: 0.8200721
	speed: 0.0095s/iter; left time: 8.8129s
	iters: 200, epoch: 5 | loss: 0.4661587
	speed: 0.0037s/iter; left time: 3.0739s
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 1.0600991249084473
Epoch: 5, Steps: 257 | Train Loss: 0.6431154 Vali Loss: 0.3993431 Best vali loss: 0.3672177
	iters: 100, epoch: 6 | loss: 0.4263314
	speed: 0.0098s/iter; left time: 6.6045s
	iters: 200, epoch: 6 | loss: 0.4948944
	speed: 0.0036s/iter; left time: 2.0307s
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.9773819446563721
Epoch: 6, Steps: 257 | Train Loss: 0.4606129 Vali Loss: 0.3947825 Best vali loss: 0.3672177
	iters: 100, epoch: 7 | loss: 0.6674499
	speed: 0.0094s/iter; left time: 3.9167s
	iters: 200, epoch: 7 | loss: 0.3283529
	speed: 0.0034s/iter; left time: 1.0638s
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.9687213897705078
Epoch: 7, Steps: 257 | Train Loss: 0.4979014 Vali Loss: 0.3958985 Best vali loss: 0.3672177
	iters: 100, epoch: 8 | loss: 0.6234959
	speed: 0.0096s/iter; left time: 1.5233s
	iters: 200, epoch: 8 | loss: 0.7384665
	speed: 0.0036s/iter; left time: 0.2062s
Updating learning rate to 3.37412718359375e-06
Epoch: 8 cost time: 0.9934594631195068
Epoch: 8, Steps: 257 | Train Loss: 0.6809812 Vali Loss: 0.3956872 Best vali loss: 0.3672177

best validation loss 0.3672177486429046

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0083903620173, 'e_layers': 4, 'learning_rate': 7.32472445e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4875861
	speed: 0.0153s/iter; left time: 14.3101s
Updating learning rate to 7.045943725319995e-05
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 1.4982271194458008
Epoch: 1, Steps: 129 | Train Loss: 0.4875861 Vali Loss: 0.3670311 Best vali loss: 0.3670311
	iters: 100, epoch: 2 | loss: 0.5387921
	speed: 0.0143s/iter; left time: 11.4714s
Updating learning rate to 6.252043389458952e-05
Validation loss decreased (0.3670 --> 0.3640).  Saving model state dict ...
Epoch: 2 cost time: 1.166186809539795
Epoch: 2, Steps: 129 | Train Loss: 0.5387921 Vali Loss: 0.3639807 Best vali loss: 0.3639807
	iters: 100, epoch: 3 | loss: 0.6547741
	speed: 0.0126s/iter; left time: 8.4897s
Updating learning rate to 5.063887571827247e-05
Epoch: 3 cost time: 0.8923890590667725
Epoch: 3, Steps: 129 | Train Loss: 0.6547741 Vali Loss: 0.3663580 Best vali loss: 0.3639807
	iters: 100, epoch: 4 | loss: 0.3765706
	speed: 0.0127s/iter; left time: 6.9119s
Updating learning rate to 3.662362225e-05
Validation loss decreased (0.3640 --> 0.3610).  Saving model state dict ...
Epoch: 4 cost time: 1.1949546337127686
Epoch: 4, Steps: 129 | Train Loss: 0.3765706 Vali Loss: 0.3610437 Best vali loss: 0.3610437
	iters: 100, epoch: 5 | loss: 0.6848922
	speed: 0.0149s/iter; left time: 6.2155s
Updating learning rate to 2.2608368781727528e-05
Validation loss decreased (0.3610 --> 0.3596).  Saving model state dict ...
Epoch: 5 cost time: 1.2108356952667236
Epoch: 5, Steps: 129 | Train Loss: 0.6848922 Vali Loss: 0.3595581 Best vali loss: 0.3595581
	iters: 100, epoch: 6 | loss: 0.6535334
	speed: 0.0146s/iter; left time: 4.2058s
Updating learning rate to 1.0726810605410478e-05
Validation loss decreased (0.3596 --> 0.3559).  Saving model state dict ...
Epoch: 6 cost time: 1.1902039051055908
Epoch: 6, Steps: 129 | Train Loss: 0.6535334 Vali Loss: 0.3558541 Best vali loss: 0.3558541
	iters: 100, epoch: 7 | loss: 0.4536205
	speed: 0.0147s/iter; left time: 2.3352s
Updating learning rate to 2.7878072468000404e-06
Epoch: 7 cost time: 1.1999149322509766
Epoch: 7, Steps: 129 | Train Loss: 0.4536205 Vali Loss: 0.3578997 Best vali loss: 0.3558541
	iters: 100, epoch: 8 | loss: 0.5048026
	speed: 0.0145s/iter; left time: 0.4361s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2155160903930664
Epoch: 8, Steps: 129 | Train Loss: 0.5048026 Vali Loss: 0.3564688 Best vali loss: 0.3558541

best validation loss 0.3558540641793099

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.002861454165, 'e_layers': 1, 'learning_rate': 5.78622565e-05, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.78622565e-05
Validation loss decreased (inf --> 0.4357).  Saving model state dict ...
Epoch: 1 cost time: 0.7275266647338867
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4356714 Best vali loss: 0.4356714
Updating learning rate to 2.893112825e-05
Validation loss decreased (0.4357 --> 0.4222).  Saving model state dict ...
Epoch: 2 cost time: 0.4290432929992676
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4222179 Best vali loss: 0.4222179
Updating learning rate to 1.4465564125e-05
Validation loss decreased (0.4222 --> 0.4164).  Saving model state dict ...
Epoch: 3 cost time: 0.4498257637023926
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4163920 Best vali loss: 0.4163920

best validation loss 0.41639202755888693

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 4, 'learning_rate': 0.0001249829864, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7025070
	speed: 0.0131s/iter; left time: 25.5649s
	iters: 200, epoch: 1 | loss: 0.5943199
	speed: 0.0080s/iter; left time: 14.8944s
Updating learning rate to 0.0001249829864
Validation loss decreased (inf --> 0.3645).  Saving model state dict ...
Epoch: 1 cost time: 2.328901767730713
Epoch: 1, Steps: 257 | Train Loss: 0.6484134 Vali Loss: 0.3644770 Best vali loss: 0.3644770
	iters: 100, epoch: 2 | loss: 0.8429883
	speed: 0.0182s/iter; left time: 30.8828s
	iters: 200, epoch: 2 | loss: 0.6381693
	speed: 0.0077s/iter; left time: 12.2738s
Updating learning rate to 6.24914932e-05
Validation loss decreased (0.3645 --> 0.3585).  Saving model state dict ...
Epoch: 2 cost time: 2.026785373687744
Epoch: 2, Steps: 257 | Train Loss: 0.7405788 Vali Loss: 0.3584587 Best vali loss: 0.3584587
	iters: 100, epoch: 3 | loss: 0.7275549
	speed: 0.0218s/iter; left time: 31.4998s
	iters: 200, epoch: 3 | loss: 0.8471033
	speed: 0.0134s/iter; left time: 18.0502s
Updating learning rate to 3.12457466e-05
Epoch: 3 cost time: 3.3919425010681152
Epoch: 3, Steps: 257 | Train Loss: 0.7873291 Vali Loss: 0.3612509 Best vali loss: 0.3584587

best validation loss 0.35845868709279416

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0029426146637, 'e_layers': 4, 'learning_rate': 0.0001092263501, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9299966
	speed: 0.0145s/iter; left time: 58.2554s
	iters: 200, epoch: 1 | loss: 0.5739868
	speed: 0.0108s/iter; left time: 42.3600s
	iters: 300, epoch: 1 | loss: 0.6016787
	speed: 0.0081s/iter; left time: 30.7228s
	iters: 400, epoch: 1 | loss: 0.7708443
	speed: 0.0048s/iter; left time: 17.7273s
	iters: 500, epoch: 1 | loss: 1.0308880
	speed: 0.0051s/iter; left time: 18.4570s
Updating learning rate to 0.00010506916968415107
Validation loss decreased (inf --> 0.3915).  Saving model state dict ...
Epoch: 1 cost time: 4.14224910736084
Epoch: 1, Steps: 514 | Train Loss: 0.7814789 Vali Loss: 0.3914992 Best vali loss: 0.3914992
	iters: 100, epoch: 2 | loss: 0.7672196
	speed: 0.0141s/iter; left time: 49.2224s
	iters: 200, epoch: 2 | loss: 0.3222860
	speed: 0.0065s/iter; left time: 22.0540s
	iters: 300, epoch: 2 | loss: 0.6263816
	speed: 0.0065s/iter; left time: 21.5051s
	iters: 400, epoch: 2 | loss: 0.3855526
	speed: 0.0067s/iter; left time: 21.5277s
	iters: 500, epoch: 2 | loss: 0.7487046
	speed: 0.0066s/iter; left time: 20.4338s
Updating learning rate to 9.323052146998297e-05
Validation loss decreased (0.3915 --> 0.3771).  Saving model state dict ...
Epoch: 2 cost time: 3.4216995239257812
Epoch: 2, Steps: 514 | Train Loss: 0.5700289 Vali Loss: 0.3771011 Best vali loss: 0.3771011
	iters: 100, epoch: 3 | loss: 0.3676365
	speed: 0.0113s/iter; left time: 33.6437s
	iters: 200, epoch: 3 | loss: 0.5543881
	speed: 0.0044s/iter; left time: 12.7047s
	iters: 300, epoch: 3 | loss: 0.9487661
	speed: 0.0046s/iter; left time: 12.8947s
	iters: 400, epoch: 3 | loss: 0.4073240
	speed: 0.0056s/iter; left time: 14.9260s
	iters: 500, epoch: 3 | loss: 0.8547060
	speed: 0.0073s/iter; left time: 18.8690s
Updating learning rate to 7.55127323304895e-05
Validation loss decreased (0.3771 --> 0.3711).  Saving model state dict ...
Epoch: 3 cost time: 2.7669191360473633
Epoch: 3, Steps: 514 | Train Loss: 0.6265641 Vali Loss: 0.3710529 Best vali loss: 0.3710529

best validation loss 0.3710528824061214

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0047485219288, 'e_layers': 4, 'learning_rate': 0.0001249829864, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4464338
	speed: 0.0159s/iter; left time: 18.8750s
	iters: 200, epoch: 4 | loss: 0.5191330
	speed: 0.0089s/iter; left time: 9.6225s
Updating learning rate to 1.56228733e-05
Validation loss decreased (0.3585 --> 0.3539).  Saving model state dict ...
Epoch: 4 cost time: 2.6446728706359863
Epoch: 4, Steps: 257 | Train Loss: 0.4827834 Vali Loss: 0.3539279 Best vali loss: 0.3539279
	iters: 100, epoch: 5 | loss: 0.7342458
	speed: 0.0194s/iter; left time: 18.0313s
	iters: 200, epoch: 5 | loss: 0.5081406
	speed: 0.0092s/iter; left time: 7.5867s
Updating learning rate to 7.81143665e-06
Epoch: 5 cost time: 2.421684503555298
Epoch: 5, Steps: 257 | Train Loss: 0.6211932 Vali Loss: 0.3625059 Best vali loss: 0.3539279
	iters: 100, epoch: 6 | loss: 0.6342943
	speed: 0.0194s/iter; left time: 13.0370s
	iters: 200, epoch: 6 | loss: 0.7834120
	speed: 0.0088s/iter; left time: 5.0493s
Updating learning rate to 3.905718325e-06
Epoch: 6 cost time: 2.423517942428589
Epoch: 6, Steps: 257 | Train Loss: 0.7088532 Vali Loss: 0.3613914 Best vali loss: 0.3539279
	iters: 100, epoch: 7 | loss: 0.6194572
	speed: 0.0168s/iter; left time: 6.9724s
	iters: 200, epoch: 7 | loss: 0.3438946
	speed: 0.0083s/iter; left time: 2.6246s
Updating learning rate to 1.9528591625e-06
Epoch: 7 cost time: 2.073122024536133
Epoch: 7, Steps: 257 | Train Loss: 0.4816759 Vali Loss: 0.3582634 Best vali loss: 0.3539279
	iters: 100, epoch: 8 | loss: 0.4737451
	speed: 0.0186s/iter; left time: 2.9316s
	iters: 200, epoch: 8 | loss: 0.5634403
	speed: 0.0088s/iter; left time: 0.5094s
Updating learning rate to 9.7642958125e-07
Epoch: 8 cost time: 2.3704006671905518
Epoch: 8, Steps: 257 | Train Loss: 0.5185927 Vali Loss: 0.3583779 Best vali loss: 0.3539279

best validation loss 0.3539278927861122

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0044504804088, 'e_layers': 1, 'learning_rate': 0.0002904810984, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00027942531989657855
Validation loss decreased (inf --> 0.3998).  Saving model state dict ...
Epoch: 1 cost time: 0.6551241874694824
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3998352 Best vali loss: 0.3998352
Updating learning rate to 0.00024794112644257836
Validation loss decreased (0.3998 --> 0.3782).  Saving model state dict ...
Epoch: 2 cost time: 0.43388819694519043
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3781621 Best vali loss: 0.3781621
Updating learning rate to 0.0002008217010864467
Validation loss decreased (0.3782 --> 0.3699).  Saving model state dict ...
Epoch: 3 cost time: 0.4218778610229492
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3698865 Best vali loss: 0.3698865
Updating learning rate to 0.0001452405492
Validation loss decreased (0.3699 --> 0.3672).  Saving model state dict ...
Epoch: 4 cost time: 0.45979881286621094
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3671503 Best vali loss: 0.3671503
Updating learning rate to 8.965939731355332e-05
Epoch: 5 cost time: 0.45133233070373535
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3673135 Best vali loss: 0.3671503
Updating learning rate to 4.253997195742162e-05
Epoch: 6 cost time: 0.4547574520111084
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3672834 Best vali loss: 0.3671503
Updating learning rate to 1.1055778503421459e-05
Epoch: 7 cost time: 0.49464964866638184
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3674660 Best vali loss: 0.3671503
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4449307918548584
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3674230 Best vali loss: 0.3671503

best validation loss 0.3671502959517458

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0111055611489, 'e_layers': 3, 'learning_rate': 8.17960163e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9208826
	speed: 0.0122s/iter; left time: 48.9188s
	iters: 200, epoch: 1 | loss: 0.4039398
	speed: 0.0064s/iter; left time: 24.8749s
	iters: 300, epoch: 1 | loss: 0.6856397
	speed: 0.0064s/iter; left time: 24.5696s
	iters: 400, epoch: 1 | loss: 0.6176974
	speed: 0.0058s/iter; left time: 21.7132s
	iters: 500, epoch: 1 | loss: 0.9769367
	speed: 0.0064s/iter; left time: 22.9763s
Updating learning rate to 7.86828408002648e-05
Validation loss decreased (inf --> 0.3976).  Saving model state dict ...
Epoch: 1 cost time: 3.5347044467926025
Epoch: 1, Steps: 514 | Train Loss: 0.7210192 Vali Loss: 0.3975911 Best vali loss: 0.3975911
	iters: 100, epoch: 2 | loss: 0.7035720
	speed: 0.0126s/iter; left time: 43.9674s
	iters: 200, epoch: 2 | loss: 0.5945477
	speed: 0.0065s/iter; left time: 22.0372s
	iters: 300, epoch: 2 | loss: 0.3344767
	speed: 0.0063s/iter; left time: 20.8369s
	iters: 400, epoch: 2 | loss: 0.5609072
	speed: 0.0060s/iter; left time: 19.2886s
	iters: 500, epoch: 2 | loss: 0.6764965
	speed: 0.0048s/iter; left time: 14.8669s
Updating learning rate to 6.98172670498877e-05
Validation loss decreased (0.3976 --> 0.3828).  Saving model state dict ...
Epoch: 2 cost time: 3.0953593254089355
Epoch: 2, Steps: 514 | Train Loss: 0.5740000 Vali Loss: 0.3827828 Best vali loss: 0.3827828
	iters: 100, epoch: 3 | loss: 0.2571095
	speed: 0.0113s/iter; left time: 33.6625s
	iters: 200, epoch: 3 | loss: 0.9725596
	speed: 0.0062s/iter; left time: 17.8744s
	iters: 300, epoch: 3 | loss: 0.5242748
	speed: 0.0057s/iter; left time: 15.7514s
	iters: 400, epoch: 3 | loss: 0.4014312
	speed: 0.0064s/iter; left time: 17.0596s
	iters: 500, epoch: 3 | loss: 0.3562244
	speed: 0.0047s/iter; left time: 12.2584s
Updating learning rate to 5.654899828573742e-05
Validation loss decreased (0.3828 --> 0.3762).  Saving model state dict ...
Epoch: 3 cost time: 3.044520854949951
Epoch: 3, Steps: 514 | Train Loss: 0.5023199 Vali Loss: 0.3762170 Best vali loss: 0.3762170
	iters: 100, epoch: 4 | loss: 0.7667708
	speed: 0.0091s/iter; left time: 22.3734s
	iters: 200, epoch: 4 | loss: 0.6669573
	speed: 0.0060s/iter; left time: 14.3302s
	iters: 300, epoch: 4 | loss: 1.0714352
	speed: 0.0057s/iter; left time: 12.9499s
	iters: 400, epoch: 4 | loss: 0.9469746
	speed: 0.0058s/iter; left time: 12.6160s
	iters: 500, epoch: 4 | loss: 0.7177421
	speed: 0.0058s/iter; left time: 12.0578s
Updating learning rate to 4.089800815e-05
Validation loss decreased (0.3762 --> 0.3734).  Saving model state dict ...
Epoch: 4 cost time: 2.9219210147857666
Epoch: 4, Steps: 514 | Train Loss: 0.8339760 Vali Loss: 0.3734469 Best vali loss: 0.3734469
	iters: 100, epoch: 5 | loss: 0.4846786
	speed: 0.0130s/iter; left time: 25.4080s
	iters: 200, epoch: 5 | loss: 1.2711207
	speed: 0.0057s/iter; left time: 10.6481s
	iters: 300, epoch: 5 | loss: 0.4409148
	speed: 0.0058s/iter; left time: 10.2344s
	iters: 400, epoch: 5 | loss: 0.4990504
	speed: 0.0048s/iter; left time: 7.9556s
	iters: 500, epoch: 5 | loss: 0.7177765
	speed: 0.0040s/iter; left time: 6.3020s
Updating learning rate to 2.5247018014262588e-05
Validation loss decreased (0.3734 --> 0.3714).  Saving model state dict ...
Epoch: 5 cost time: 2.749953269958496
Epoch: 5, Steps: 514 | Train Loss: 0.6827082 Vali Loss: 0.3714132 Best vali loss: 0.3714132
	iters: 100, epoch: 6 | loss: 0.6778589
	speed: 0.0128s/iter; left time: 18.4283s
	iters: 200, epoch: 6 | loss: 0.5599701
	speed: 0.0060s/iter; left time: 8.0506s
	iters: 300, epoch: 6 | loss: 0.2975650
	speed: 0.0060s/iter; left time: 7.5008s
	iters: 400, epoch: 6 | loss: 0.4153790
	speed: 0.0060s/iter; left time: 6.8967s
	iters: 500, epoch: 6 | loss: 0.3515526
	speed: 0.0061s/iter; left time: 6.3329s
Updating learning rate to 1.1978749250112316e-05
Validation loss decreased (0.3714 --> 0.3705).  Saving model state dict ...
Epoch: 6 cost time: 3.1727607250213623
Epoch: 6, Steps: 514 | Train Loss: 0.4604651 Vali Loss: 0.3705219 Best vali loss: 0.3705219
	iters: 100, epoch: 7 | loss: 1.1660854
	speed: 0.0145s/iter; left time: 13.4718s
	iters: 200, epoch: 7 | loss: 0.2183021
	speed: 0.0061s/iter; left time: 5.0934s
	iters: 300, epoch: 7 | loss: 0.2650459
	speed: 0.0061s/iter; left time: 4.4474s
	iters: 400, epoch: 7 | loss: 0.4921526
	speed: 0.0056s/iter; left time: 3.5173s
	iters: 500, epoch: 7 | loss: 0.4067498
	speed: 0.0061s/iter; left time: 3.2342s
Updating learning rate to 3.1131754997352054e-06
Validation loss decreased (0.3705 --> 0.3703).  Saving model state dict ...
Epoch: 7 cost time: 3.179877281188965
Epoch: 7, Steps: 514 | Train Loss: 0.5096672 Vali Loss: 0.3703416 Best vali loss: 0.3703416
	iters: 100, epoch: 8 | loss: 0.3589630
	speed: 0.0143s/iter; left time: 5.9424s
	iters: 200, epoch: 8 | loss: 0.8370065
	speed: 0.0061s/iter; left time: 1.9120s
	iters: 300, epoch: 8 | loss: 0.9677319
	speed: 0.0046s/iter; left time: 0.9921s
	iters: 400, epoch: 8 | loss: 0.3685960
	speed: 0.0043s/iter; left time: 0.4914s
	iters: 500, epoch: 8 | loss: 0.8201054
	speed: 0.0049s/iter; left time: 0.0728s
Updating learning rate to 0.0
Validation loss decreased (0.3703 --> 0.3703).  Saving model state dict ...
Epoch: 8 cost time: 2.775269031524658
Epoch: 8, Steps: 514 | Train Loss: 0.6704806 Vali Loss: 0.3703375 Best vali loss: 0.3703375

best validation loss 0.37033751731068776

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0072636125698, 'e_layers': 3, 'learning_rate': 0.0026797239204, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6507316
	speed: 0.0123s/iter; left time: 49.5555s
	iters: 200, epoch: 1 | loss: 0.8683447
	speed: 0.0062s/iter; left time: 24.4178s
	iters: 300, epoch: 1 | loss: 0.8952280
	speed: 0.0064s/iter; left time: 24.4861s
	iters: 400, epoch: 1 | loss: 1.6492610
	speed: 0.0065s/iter; left time: 24.0801s
	iters: 500, epoch: 1 | loss: 0.8946891
	speed: 0.0067s/iter; left time: 24.0544s
Updating learning rate to 0.0026797239204
Validation loss decreased (inf --> 0.4046).  Saving model state dict ...
Epoch: 1 cost time: 3.6287896633148193
Epoch: 1, Steps: 514 | Train Loss: 0.9916509 Vali Loss: 0.4046357 Best vali loss: 0.4046357
	iters: 100, epoch: 2 | loss: 0.3872356
	speed: 0.0139s/iter; left time: 48.7856s
	iters: 200, epoch: 2 | loss: 0.4598933
	speed: 0.0067s/iter; left time: 22.6213s
	iters: 300, epoch: 2 | loss: 0.8919389
	speed: 0.0067s/iter; left time: 22.0576s
	iters: 400, epoch: 2 | loss: 0.6516851
	speed: 0.0064s/iter; left time: 20.5329s
	iters: 500, epoch: 2 | loss: 0.9986854
	speed: 0.0065s/iter; left time: 20.0594s
Updating learning rate to 0.0013398619602
Epoch: 2 cost time: 3.386711597442627
Epoch: 2, Steps: 514 | Train Loss: 0.6778877 Vali Loss: 0.4071899 Best vali loss: 0.4046357
	iters: 100, epoch: 3 | loss: 0.7357574
	speed: 0.0135s/iter; left time: 40.3064s
	iters: 200, epoch: 3 | loss: 0.6686133
	speed: 0.0064s/iter; left time: 18.5808s
	iters: 300, epoch: 3 | loss: 0.4585180
	speed: 0.0066s/iter; left time: 18.3113s
	iters: 400, epoch: 3 | loss: 1.3217381
	speed: 0.0065s/iter; left time: 17.5412s
	iters: 500, epoch: 3 | loss: 0.7629494
	speed: 0.0058s/iter; left time: 15.0278s
Updating learning rate to 0.0006699309801
Validation loss decreased (0.4046 --> 0.4029).  Saving model state dict ...
Epoch: 3 cost time: 3.32539701461792
Epoch: 3, Steps: 514 | Train Loss: 0.7895152 Vali Loss: 0.4029217 Best vali loss: 0.4029217

best validation loss 0.40292168752617824

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0011116320123, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7701469
	speed: 0.0119s/iter; left time: 11.1304s
Updating learning rate to 0.0011116320123
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 1.0193121433258057
Epoch: 1, Steps: 129 | Train Loss: 0.7701469 Vali Loss: 0.3681814 Best vali loss: 0.3681814
	iters: 100, epoch: 2 | loss: 0.7298088
	speed: 0.0082s/iter; left time: 6.5602s
Updating learning rate to 0.00055581600615
Epoch: 2 cost time: 0.562786340713501
Epoch: 2, Steps: 129 | Train Loss: 0.7298088 Vali Loss: 0.3690813 Best vali loss: 0.3681814
	iters: 100, epoch: 3 | loss: 0.5397086
	speed: 0.0057s/iter; left time: 3.8503s
Updating learning rate to 0.000277908003075
Validation loss decreased (0.3682 --> 0.3660).  Saving model state dict ...
Epoch: 3 cost time: 0.4399724006652832
Epoch: 3, Steps: 129 | Train Loss: 0.5397086 Vali Loss: 0.3660024 Best vali loss: 0.3660024

best validation loss 0.3660023596408559

{'batch_size': 32, 'd_core': 64, 'd_model': 512, 'dropout': 0.0085651972878, 'e_layers': 3, 'learning_rate': 0.0005146719463, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9225387
	speed: 0.0132s/iter; left time: 25.8766s
	iters: 200, epoch: 1 | loss: 0.8085451
	speed: 0.0077s/iter; left time: 14.2899s
Updating learning rate to 0.0004950834117221591
Validation loss decreased (inf --> 0.3827).  Saving model state dict ...
Epoch: 1 cost time: 2.2589848041534424
Epoch: 1, Steps: 257 | Train Loss: 0.8655419 Vali Loss: 0.3826791 Best vali loss: 0.3826791
	iters: 100, epoch: 2 | loss: 0.7617208
	speed: 0.0161s/iter; left time: 27.3617s
	iters: 200, epoch: 2 | loss: 0.4296503
	speed: 0.0074s/iter; left time: 11.7957s
Updating learning rate to 0.0004392999848076043
Validation loss decreased (0.3827 --> 0.3730).  Saving model state dict ...
Epoch: 2 cost time: 1.9485037326812744
Epoch: 2, Steps: 257 | Train Loss: 0.5956856 Vali Loss: 0.3730175 Best vali loss: 0.3730175
	iters: 100, epoch: 3 | loss: 1.2100189
	speed: 0.0170s/iter; left time: 24.5190s
	iters: 200, epoch: 3 | loss: 0.7940773
	speed: 0.0074s/iter; left time: 9.9437s
Updating learning rate to 0.0003558141866260526
Epoch: 3 cost time: 1.9967057704925537
Epoch: 3, Steps: 257 | Train Loss: 1.0020481 Vali Loss: 0.3853816 Best vali loss: 0.3730175

best validation loss 0.37301746494409377

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0096712489936, 'e_layers': 1, 'learning_rate': 0.0011116320123, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7435023
	speed: 0.0109s/iter; left time: 5.9652s
Updating learning rate to 0.0001389540015375
Validation loss decreased (0.3660 --> 0.3658).  Saving model state dict ...
Epoch: 4 cost time: 0.9129655361175537
Epoch: 4, Steps: 129 | Train Loss: 0.7435023 Vali Loss: 0.3658175 Best vali loss: 0.3658175
	iters: 100, epoch: 5 | loss: 0.7222008
	speed: 0.0092s/iter; left time: 3.8540s
Updating learning rate to 6.947700076875e-05
Epoch: 5 cost time: 0.7122385501861572
Epoch: 5, Steps: 129 | Train Loss: 0.7222008 Vali Loss: 0.3668869 Best vali loss: 0.3658175
	iters: 100, epoch: 6 | loss: 0.5100464
	speed: 0.0088s/iter; left time: 2.5268s
Updating learning rate to 3.4738500384375e-05
Epoch: 6 cost time: 0.6561486721038818
Epoch: 6, Steps: 129 | Train Loss: 0.5100464 Vali Loss: 0.3671890 Best vali loss: 0.3658175
	iters: 100, epoch: 7 | loss: 0.5386692
	speed: 0.0086s/iter; left time: 1.3728s
Updating learning rate to 1.73692501921875e-05
Epoch: 7 cost time: 0.6735363006591797
Epoch: 7, Steps: 129 | Train Loss: 0.5386692 Vali Loss: 0.3667429 Best vali loss: 0.3658175
	iters: 100, epoch: 8 | loss: 1.1196117
	speed: 0.0086s/iter; left time: 0.2566s
Updating learning rate to 8.68462509609375e-06
Epoch: 8 cost time: 0.6973512172698975
Epoch: 8, Steps: 129 | Train Loss: 1.1196117 Vali Loss: 0.3667891 Best vali loss: 0.3658175

best validation loss 0.36581751896262404

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083084935006, 'e_layers': 4, 'learning_rate': 0.000151670542, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6248721
	speed: 0.0136s/iter; left time: 12.7163s
Updating learning rate to 0.00014589792571934672
Validation loss decreased (inf --> 0.4114).  Saving model state dict ...
Epoch: 1 cost time: 1.2868168354034424
Epoch: 1, Steps: 129 | Train Loss: 0.6248721 Vali Loss: 0.4114492 Best vali loss: 0.4114492
	iters: 100, epoch: 2 | loss: 0.7707484
	speed: 0.0129s/iter; left time: 10.3915s
Updating learning rate to 0.00012945890537721953
Validation loss decreased (0.4114 --> 0.3933).  Saving model state dict ...
Epoch: 2 cost time: 1.0577304363250732
Epoch: 2, Steps: 129 | Train Loss: 0.7707484 Vali Loss: 0.3933034 Best vali loss: 0.3933034
	iters: 100, epoch: 3 | loss: 0.4905261
	speed: 0.0125s/iter; left time: 8.4368s
Updating learning rate to 0.00010485617280061675
Validation loss decreased (0.3933 --> 0.3861).  Saving model state dict ...
Epoch: 3 cost time: 1.0052292346954346
Epoch: 3, Steps: 129 | Train Loss: 0.4905261 Vali Loss: 0.3860705 Best vali loss: 0.3860705
	iters: 100, epoch: 4 | loss: 0.6133317
	speed: 0.0128s/iter; left time: 7.0014s
Updating learning rate to 7.5835271e-05
Validation loss decreased (0.3861 --> 0.3824).  Saving model state dict ...
Epoch: 4 cost time: 1.0418057441711426
Epoch: 4, Steps: 129 | Train Loss: 0.6133317 Vali Loss: 0.3823914 Best vali loss: 0.3823914
	iters: 100, epoch: 5 | loss: 0.5903099
	speed: 0.0129s/iter; left time: 5.3739s
Updating learning rate to 4.681436919938325e-05
Validation loss decreased (0.3824 --> 0.3789).  Saving model state dict ...
Epoch: 5 cost time: 1.0594651699066162
Epoch: 5, Steps: 129 | Train Loss: 0.5903099 Vali Loss: 0.3789114 Best vali loss: 0.3789114
	iters: 100, epoch: 6 | loss: 0.5988478
	speed: 0.0131s/iter; left time: 3.7676s
Updating learning rate to 2.221163662278047e-05
Validation loss decreased (0.3789 --> 0.3773).  Saving model state dict ...
Epoch: 6 cost time: 1.0483317375183105
Epoch: 6, Steps: 129 | Train Loss: 0.5988478 Vali Loss: 0.3773116 Best vali loss: 0.3773116
	iters: 100, epoch: 7 | loss: 0.7764522
	speed: 0.0127s/iter; left time: 2.0214s
Updating learning rate to 5.772616280653259e-06
Validation loss decreased (0.3773 --> 0.3772).  Saving model state dict ...
Epoch: 7 cost time: 1.0361034870147705
Epoch: 7, Steps: 129 | Train Loss: 0.7764522 Vali Loss: 0.3772444 Best vali loss: 0.3772444
	iters: 100, epoch: 8 | loss: 0.5245847
	speed: 0.0128s/iter; left time: 0.3847s
Updating learning rate to 0.0
Validation loss decreased (0.3772 --> 0.3772).  Saving model state dict ...
Epoch: 8 cost time: 1.0503792762756348
Epoch: 8, Steps: 129 | Train Loss: 0.5245847 Vali Loss: 0.3771712 Best vali loss: 0.3771712

best validation loss 0.3771712264401037

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0011065600884, 'e_layers': 4, 'learning_rate': 0.0011706271719, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5132656
	speed: 0.0128s/iter; left time: 25.0954s
	iters: 200, epoch: 1 | loss: 0.5260741
	speed: 0.0066s/iter; left time: 12.2767s
Updating learning rate to 0.0011260728281099908
Validation loss decreased (inf --> 0.3724).  Saving model state dict ...
Epoch: 1 cost time: 2.0286433696746826
Epoch: 1, Steps: 257 | Train Loss: 0.5196698 Vali Loss: 0.3723747 Best vali loss: 0.3723747
	iters: 100, epoch: 2 | loss: 0.6093526
	speed: 0.0152s/iter; left time: 25.7998s
	iters: 200, epoch: 2 | loss: 0.6863580
	speed: 0.0070s/iter; left time: 11.2063s
Updating learning rate to 0.00099919279169586
Validation loss decreased (0.3724 --> 0.3704).  Saving model state dict ...
Epoch: 2 cost time: 1.8330249786376953
Epoch: 2, Steps: 257 | Train Loss: 0.6478553 Vali Loss: 0.3704378 Best vali loss: 0.3704378
	iters: 100, epoch: 3 | loss: 0.7391145
	speed: 0.0148s/iter; left time: 21.4050s
	iters: 200, epoch: 3 | loss: 0.6784630
	speed: 0.0072s/iter; left time: 9.6209s
Updating learning rate to 0.000809303398031265
Epoch: 3 cost time: 1.8458058834075928
Epoch: 3, Steps: 257 | Train Loss: 0.7087888 Vali Loss: 0.3768398 Best vali loss: 0.3704378
	iters: 100, epoch: 4 | loss: 0.6859829
	speed: 0.0149s/iter; left time: 17.6354s
	iters: 200, epoch: 4 | loss: 0.5482826
	speed: 0.0070s/iter; left time: 7.5822s
Updating learning rate to 0.00058531358595
Epoch: 4 cost time: 1.8623087406158447
Epoch: 4, Steps: 257 | Train Loss: 0.6171328 Vali Loss: 0.3798946 Best vali loss: 0.3704378
	iters: 100, epoch: 5 | loss: 0.4743807
	speed: 0.0150s/iter; left time: 13.9609s
	iters: 200, epoch: 5 | loss: 0.5981345
	speed: 0.0074s/iter; left time: 6.1468s
Updating learning rate to 0.000361323773868735
Validation loss decreased (0.3704 --> 0.3682).  Saving model state dict ...
Epoch: 5 cost time: 1.8650312423706055
Epoch: 5, Steps: 257 | Train Loss: 0.5362576 Vali Loss: 0.3681527 Best vali loss: 0.3681527
	iters: 100, epoch: 6 | loss: 0.5256731
	speed: 0.0150s/iter; left time: 10.0626s
	iters: 200, epoch: 6 | loss: 0.5498309
	speed: 0.0068s/iter; left time: 3.8654s
Updating learning rate to 0.00017143438020413989
Validation loss decreased (0.3682 --> 0.3556).  Saving model state dict ...
Epoch: 6 cost time: 1.8509411811828613
Epoch: 6, Steps: 257 | Train Loss: 0.5377520 Vali Loss: 0.3556304 Best vali loss: 0.3556304
	iters: 100, epoch: 7 | loss: 0.5230564
	speed: 0.0158s/iter; left time: 6.5429s
	iters: 200, epoch: 7 | loss: 0.6906477
	speed: 0.0071s/iter; left time: 2.2381s
Updating learning rate to 4.455434379000915e-05
Validation loss decreased (0.3556 --> 0.3553).  Saving model state dict ...
Epoch: 7 cost time: 1.8759641647338867
Epoch: 7, Steps: 257 | Train Loss: 0.6068521 Vali Loss: 0.3553449 Best vali loss: 0.3553449
	iters: 100, epoch: 8 | loss: 0.6715977
	speed: 0.0140s/iter; left time: 2.2073s
	iters: 200, epoch: 8 | loss: 0.5191379
	speed: 0.0071s/iter; left time: 0.4095s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.823331594467163
Epoch: 8, Steps: 257 | Train Loss: 0.5953678 Vali Loss: 0.3588454 Best vali loss: 0.3553449

best validation loss 0.35534485357215223

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0013301090585, 'e_layers': 1, 'learning_rate': 0.0017944511294, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6208007
	speed: 0.0110s/iter; left time: 10.2600s
Updating learning rate to 0.0017944511294
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 0.9321601390838623
Epoch: 1, Steps: 129 | Train Loss: 0.6208007 Vali Loss: 0.3664385 Best vali loss: 0.3664385
	iters: 100, epoch: 2 | loss: 0.8407985
	speed: 0.0088s/iter; left time: 7.0834s
Updating learning rate to 0.0008972255647
Epoch: 2 cost time: 0.6504173278808594
Epoch: 2, Steps: 129 | Train Loss: 0.8407985 Vali Loss: 0.3706102 Best vali loss: 0.3664385
	iters: 100, epoch: 3 | loss: 0.5766728
	speed: 0.0089s/iter; left time: 6.0320s
Updating learning rate to 0.00044861278235
Epoch: 3 cost time: 0.688758373260498
Epoch: 3, Steps: 129 | Train Loss: 0.5766728 Vali Loss: 0.3815932 Best vali loss: 0.3664385

best validation loss 0.36643854151306077

{'batch_size': 32, 'd_core': 64, 'd_model': 32, 'dropout': 0.0024236762505, 'e_layers': 2, 'learning_rate': 0.0003084774503, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9825850
	speed: 0.0114s/iter; left time: 22.3797s
	iters: 200, epoch: 1 | loss: 0.7513636
	speed: 0.0054s/iter; left time: 10.0589s
Updating learning rate to 0.0003084774503
Validation loss decreased (inf --> 0.3839).  Saving model state dict ...
Epoch: 1 cost time: 1.7115049362182617
Epoch: 1, Steps: 257 | Train Loss: 0.8669743 Vali Loss: 0.3838640 Best vali loss: 0.3838640
	iters: 100, epoch: 2 | loss: 0.7562252
	speed: 0.0120s/iter; left time: 20.3822s
	iters: 200, epoch: 2 | loss: 0.6492937
	speed: 0.0053s/iter; left time: 8.4588s
Updating learning rate to 0.00015423872515
Validation loss decreased (0.3839 --> 0.3698).  Saving model state dict ...
Epoch: 2 cost time: 1.3738410472869873
Epoch: 2, Steps: 257 | Train Loss: 0.7027595 Vali Loss: 0.3697628 Best vali loss: 0.3697628
	iters: 100, epoch: 3 | loss: 0.7412425
	speed: 0.0121s/iter; left time: 17.4254s
	iters: 200, epoch: 3 | loss: 0.7405832
	speed: 0.0054s/iter; left time: 7.2348s
Updating learning rate to 7.7119362575e-05
Validation loss decreased (0.3698 --> 0.3673).  Saving model state dict ...
Epoch: 3 cost time: 1.4383342266082764
Epoch: 3, Steps: 257 | Train Loss: 0.7409129 Vali Loss: 0.3672663 Best vali loss: 0.3672663

best validation loss 0.3672662866256092

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029638074311, 'e_layers': 2, 'learning_rate': 0.0001213169042, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7254451
	speed: 0.0110s/iter; left time: 44.2020s
	iters: 200, epoch: 1 | loss: 0.6239795
	speed: 0.0052s/iter; left time: 20.4374s
	iters: 300, epoch: 1 | loss: 0.3978224
	speed: 0.0051s/iter; left time: 19.4322s
	iters: 400, epoch: 1 | loss: 0.5115137
	speed: 0.0053s/iter; left time: 19.7618s
	iters: 500, epoch: 1 | loss: 1.0686702
	speed: 0.0049s/iter; left time: 17.8489s
Updating learning rate to 0.0001213169042
Validation loss decreased (inf --> 0.3626).  Saving model state dict ...
Epoch: 1 cost time: 2.918510913848877
Epoch: 1, Steps: 514 | Train Loss: 0.6654862 Vali Loss: 0.3625939 Best vali loss: 0.3625939
	iters: 100, epoch: 2 | loss: 0.4025523
	speed: 0.0118s/iter; left time: 41.1643s
	iters: 200, epoch: 2 | loss: 0.3513819
	speed: 0.0052s/iter; left time: 17.6672s
	iters: 300, epoch: 2 | loss: 0.3886474
	speed: 0.0049s/iter; left time: 16.0258s
	iters: 400, epoch: 2 | loss: 0.3659605
	speed: 0.0050s/iter; left time: 15.8787s
	iters: 500, epoch: 2 | loss: 0.8204567
	speed: 0.0049s/iter; left time: 15.0313s
Updating learning rate to 6.06584521e-05
Validation loss decreased (0.3626 --> 0.3446).  Saving model state dict ...
Epoch: 2 cost time: 2.624807119369507
Epoch: 2, Steps: 514 | Train Loss: 0.4657998 Vali Loss: 0.3446399 Best vali loss: 0.3446399
	iters: 100, epoch: 3 | loss: 0.5826914
	speed: 0.0121s/iter; left time: 36.2248s
	iters: 200, epoch: 3 | loss: 0.2582828
	speed: 0.0048s/iter; left time: 13.7866s
	iters: 300, epoch: 3 | loss: 0.3975536
	speed: 0.0050s/iter; left time: 13.8923s
	iters: 400, epoch: 3 | loss: 1.1512333
	speed: 0.0049s/iter; left time: 13.2019s
	iters: 500, epoch: 3 | loss: 0.3973615
	speed: 0.0050s/iter; left time: 12.9884s
Updating learning rate to 3.032922605e-05
Epoch: 3 cost time: 2.6341521739959717
Epoch: 3, Steps: 514 | Train Loss: 0.5574245 Vali Loss: 0.3494447 Best vali loss: 0.3446399

best validation loss 0.34463989870487355

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0029638074311, 'e_layers': 2, 'learning_rate': 0.0001213169042, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6357076
	speed: 0.0107s/iter; left time: 26.4485s
	iters: 200, epoch: 4 | loss: 0.5940557
	speed: 0.0050s/iter; left time: 11.9720s
	iters: 300, epoch: 4 | loss: 0.3837538
	speed: 0.0052s/iter; left time: 11.9151s
	iters: 400, epoch: 4 | loss: 0.3294282
	speed: 0.0053s/iter; left time: 11.4909s
	iters: 500, epoch: 4 | loss: 0.9134336
	speed: 0.0052s/iter; left time: 10.8274s
Updating learning rate to 1.5164613025e-05
Epoch: 4 cost time: 2.895986318588257
Epoch: 4, Steps: 514 | Train Loss: 0.5712758 Vali Loss: 0.3504923 Best vali loss: 0.3446399
	iters: 100, epoch: 5 | loss: 0.3380690
	speed: 0.0117s/iter; left time: 22.8095s
	iters: 200, epoch: 5 | loss: 0.2888902
	speed: 0.0049s/iter; left time: 9.0897s
	iters: 300, epoch: 5 | loss: 0.3614354
	speed: 0.0048s/iter; left time: 8.4955s
	iters: 400, epoch: 5 | loss: 0.3723067
	speed: 0.0050s/iter; left time: 8.2456s
	iters: 500, epoch: 5 | loss: 0.7155194
	speed: 0.0050s/iter; left time: 7.7600s
Updating learning rate to 7.5823065125e-06
Epoch: 5 cost time: 2.6069514751434326
Epoch: 5, Steps: 514 | Train Loss: 0.4152441 Vali Loss: 0.3501787 Best vali loss: 0.3446399
	iters: 100, epoch: 6 | loss: 0.5719165
	speed: 0.0113s/iter; left time: 16.2884s
	iters: 200, epoch: 6 | loss: 0.2379079
	speed: 0.0054s/iter; left time: 7.1981s
	iters: 300, epoch: 6 | loss: 0.3729267
	speed: 0.0047s/iter; left time: 5.8470s
	iters: 400, epoch: 6 | loss: 0.9811891
	speed: 0.0046s/iter; left time: 5.3074s
	iters: 500, epoch: 6 | loss: 0.3771029
	speed: 0.0034s/iter; left time: 3.5953s
Updating learning rate to 3.79115325625e-06
Epoch: 6 cost time: 2.415701150894165
Epoch: 6, Steps: 514 | Train Loss: 0.5082086 Vali Loss: 0.3471308 Best vali loss: 0.3446399
	iters: 100, epoch: 7 | loss: 0.3939687
	speed: 0.0087s/iter; left time: 8.1151s
	iters: 200, epoch: 7 | loss: 0.4324329
	speed: 0.0059s/iter; left time: 4.9167s
	iters: 300, epoch: 7 | loss: 0.3886467
	speed: 0.0056s/iter; left time: 4.1048s
	iters: 400, epoch: 7 | loss: 0.5650166
	speed: 0.0056s/iter; left time: 3.5487s
	iters: 500, epoch: 7 | loss: 0.6459856
	speed: 0.0054s/iter; left time: 2.8779s
Updating learning rate to 1.895576628125e-06
Epoch: 7 cost time: 2.8281826972961426
Epoch: 7, Steps: 514 | Train Loss: 0.4852101 Vali Loss: 0.3474872 Best vali loss: 0.3446399
	iters: 100, epoch: 8 | loss: 0.3497528
	speed: 0.0122s/iter; left time: 5.0485s
	iters: 200, epoch: 8 | loss: 0.4608436
	speed: 0.0056s/iter; left time: 1.7795s
	iters: 300, epoch: 8 | loss: 0.3811173
	speed: 0.0054s/iter; left time: 1.1686s
	iters: 400, epoch: 8 | loss: 0.2695198
	speed: 0.0055s/iter; left time: 0.6302s
	iters: 500, epoch: 8 | loss: 0.7221736
	speed: 0.0055s/iter; left time: 0.0830s
Updating learning rate to 9.477883140625e-07
Epoch: 8 cost time: 2.8801159858703613
Epoch: 8, Steps: 514 | Train Loss: 0.4366814 Vali Loss: 0.3469815 Best vali loss: 0.3446399

best validation loss 0.34463989870487355

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0023210420786, 'e_layers': 2, 'learning_rate': 5.47631081e-05, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4591632
	speed: 0.0106s/iter; left time: 86.2798s
	iters: 200, epoch: 1 | loss: 0.4495882
	speed: 0.0046s/iter; left time: 36.8976s
	iters: 300, epoch: 1 | loss: 0.6951960
	speed: 0.0045s/iter; left time: 35.9182s
	iters: 400, epoch: 1 | loss: 0.5385451
	speed: 0.0045s/iter; left time: 34.9501s
	iters: 500, epoch: 1 | loss: 0.7111340
	speed: 0.0045s/iter; left time: 34.5133s
	iters: 600, epoch: 1 | loss: 0.8153495
	speed: 0.0043s/iter; left time: 32.6658s
	iters: 700, epoch: 1 | loss: 0.2367625
	speed: 0.0045s/iter; left time: 33.8486s
	iters: 800, epoch: 1 | loss: 0.6296447
	speed: 0.0047s/iter; left time: 34.6795s
	iters: 900, epoch: 1 | loss: 0.2631106
	speed: 0.0046s/iter; left time: 33.7190s
	iters: 1000, epoch: 1 | loss: 0.2344002
	speed: 0.0046s/iter; left time: 33.5099s
Updating learning rate to 5.47631081e-05
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 4.964330196380615
Epoch: 1, Steps: 1027 | Train Loss: 0.5032894 Vali Loss: 0.3708837 Best vali loss: 0.3708837
	iters: 100, epoch: 2 | loss: 1.1102163
	speed: 0.0131s/iter; left time: 92.6939s
	iters: 200, epoch: 2 | loss: 1.8791732
	speed: 0.0048s/iter; left time: 33.7400s
	iters: 300, epoch: 2 | loss: 0.4720912
	speed: 0.0047s/iter; left time: 32.1454s
	iters: 400, epoch: 2 | loss: 0.2836989
	speed: 0.0046s/iter; left time: 31.1108s
	iters: 500, epoch: 2 | loss: 0.5478794
	speed: 0.0045s/iter; left time: 30.0999s
	iters: 600, epoch: 2 | loss: 0.7302040
	speed: 0.0050s/iter; left time: 33.0261s
	iters: 700, epoch: 2 | loss: 0.8542394
	speed: 0.0050s/iter; left time: 32.7372s
	iters: 800, epoch: 2 | loss: 0.3685006
	speed: 0.0050s/iter; left time: 32.1173s
	iters: 900, epoch: 2 | loss: 0.1954419
	speed: 0.0051s/iter; left time: 31.9526s
	iters: 1000, epoch: 2 | loss: 0.2582110
	speed: 0.0051s/iter; left time: 31.4213s
Updating learning rate to 2.738155405e-05
Validation loss decreased (0.3709 --> 0.3667).  Saving model state dict ...
Epoch: 2 cost time: 4.997941255569458
Epoch: 2, Steps: 1027 | Train Loss: 0.6699656 Vali Loss: 0.3667264 Best vali loss: 0.3667264
	iters: 100, epoch: 3 | loss: 1.0585328
	speed: 0.0124s/iter; left time: 75.2087s
	iters: 200, epoch: 3 | loss: 0.2663009
	speed: 0.0033s/iter; left time: 19.5476s
	iters: 300, epoch: 3 | loss: 0.4158360
	speed: 0.0034s/iter; left time: 20.1997s
	iters: 400, epoch: 3 | loss: 0.5190639
	speed: 0.0077s/iter; left time: 44.2310s
	iters: 500, epoch: 3 | loss: 0.2795640
	speed: 0.0077s/iter; left time: 43.6897s
	iters: 600, epoch: 3 | loss: 0.3345681
	speed: 0.0077s/iter; left time: 43.0742s
	iters: 700, epoch: 3 | loss: 0.9222788
	speed: 0.0077s/iter; left time: 42.2110s
	iters: 800, epoch: 3 | loss: 0.6018385
	speed: 0.0070s/iter; left time: 37.4896s
	iters: 900, epoch: 3 | loss: 0.7579355
	speed: 0.0041s/iter; left time: 21.4045s
	iters: 1000, epoch: 3 | loss: 1.7381532
	speed: 0.0059s/iter; left time: 30.6588s
Updating learning rate to 1.3690777025e-05
Validation loss decreased (0.3667 --> 0.3651).  Saving model state dict ...
Epoch: 3 cost time: 6.04741644859314
Epoch: 3, Steps: 1027 | Train Loss: 0.6894072 Vali Loss: 0.3650909 Best vali loss: 0.3650909
	iters: 100, epoch: 4 | loss: 0.2352031
	speed: 0.0247s/iter; left time: 124.3855s
	iters: 200, epoch: 4 | loss: 0.5323734
	speed: 0.0078s/iter; left time: 38.4921s
	iters: 300, epoch: 4 | loss: 1.5065616
	speed: 0.0035s/iter; left time: 16.7489s
	iters: 400, epoch: 4 | loss: 0.3394360
	speed: 0.0049s/iter; left time: 23.3814s
	iters: 500, epoch: 4 | loss: 0.2264839
	speed: 0.0077s/iter; left time: 35.7813s
	iters: 600, epoch: 4 | loss: 0.4534192
	speed: 0.0076s/iter; left time: 34.6346s
	iters: 700, epoch: 4 | loss: 1.0686215
	speed: 0.0077s/iter; left time: 34.2383s
	iters: 800, epoch: 4 | loss: 1.0964214
	speed: 0.0076s/iter; left time: 33.1273s
	iters: 900, epoch: 4 | loss: 0.3774408
	speed: 0.0057s/iter; left time: 24.1844s
	iters: 1000, epoch: 4 | loss: 0.2499143
	speed: 0.0036s/iter; left time: 15.0867s
Updating learning rate to 6.8453885125e-06
Epoch: 4 cost time: 6.5193986892700195
Epoch: 4, Steps: 1027 | Train Loss: 0.6085875 Vali Loss: 0.3668694 Best vali loss: 0.3650909
	iters: 100, epoch: 5 | loss: 0.5017096
	speed: 0.0092s/iter; left time: 37.0232s
	iters: 200, epoch: 5 | loss: 0.4409624
	speed: 0.0040s/iter; left time: 15.6967s
	iters: 300, epoch: 5 | loss: 0.2321051
	speed: 0.0042s/iter; left time: 15.9912s
	iters: 400, epoch: 5 | loss: 0.4431600
	speed: 0.0042s/iter; left time: 15.5322s
	iters: 500, epoch: 5 | loss: 0.3431072
	speed: 0.0036s/iter; left time: 13.1179s
	iters: 600, epoch: 5 | loss: 0.2919278
	speed: 0.0047s/iter; left time: 16.4934s
	iters: 700, epoch: 5 | loss: 0.8760483
	speed: 0.0044s/iter; left time: 15.1317s
	iters: 800, epoch: 5 | loss: 0.3285385
	speed: 0.0039s/iter; left time: 13.0703s
	iters: 900, epoch: 5 | loss: 0.3815989
	speed: 0.0039s/iter; left time: 12.5585s
	iters: 1000, epoch: 5 | loss: 0.8008615
	speed: 0.0045s/iter; left time: 14.0748s
Updating learning rate to 3.42269425625e-06
Epoch: 5 cost time: 4.246649742126465
Epoch: 5, Steps: 1027 | Train Loss: 0.4640019 Vali Loss: 0.3661740 Best vali loss: 0.3650909
	iters: 100, epoch: 6 | loss: 0.3486902
	speed: 0.0126s/iter; left time: 37.6071s
	iters: 200, epoch: 6 | loss: 0.6712034
	speed: 0.0035s/iter; left time: 10.0065s
	iters: 300, epoch: 6 | loss: 0.2407958
	speed: 0.0035s/iter; left time: 9.7197s
	iters: 400, epoch: 6 | loss: 0.4980947
	speed: 0.0042s/iter; left time: 11.3848s
	iters: 500, epoch: 6 | loss: 0.2953827
	speed: 0.0044s/iter; left time: 11.4339s
	iters: 600, epoch: 6 | loss: 0.3831344
	speed: 0.0039s/iter; left time: 9.7217s
	iters: 700, epoch: 6 | loss: 0.4381517
	speed: 0.0042s/iter; left time: 9.9915s
	iters: 800, epoch: 6 | loss: 0.9461522
	speed: 0.0042s/iter; left time: 9.6422s
	iters: 900, epoch: 6 | loss: 0.3801053
	speed: 0.0042s/iter; left time: 9.0835s
	iters: 1000, epoch: 6 | loss: 0.3702990
	speed: 0.0036s/iter; left time: 7.5855s
Updating learning rate to 1.711347128125e-06
Epoch: 6 cost time: 4.100146770477295
Epoch: 6, Steps: 1027 | Train Loss: 0.4572009 Vali Loss: 0.3674232 Best vali loss: 0.3650909
	iters: 100, epoch: 7 | loss: 0.5637977
	speed: 0.0131s/iter; left time: 25.6617s
	iters: 200, epoch: 7 | loss: 0.4247681
	speed: 0.0038s/iter; left time: 7.0741s
	iters: 300, epoch: 7 | loss: 0.5724331
	speed: 0.0044s/iter; left time: 7.7231s
	iters: 400, epoch: 7 | loss: 0.2488829
	speed: 0.0042s/iter; left time: 6.9874s
	iters: 500, epoch: 7 | loss: 0.2841744
	speed: 0.0039s/iter; left time: 6.0695s
	iters: 600, epoch: 7 | loss: 0.5724335
	speed: 0.0042s/iter; left time: 6.0509s
	iters: 700, epoch: 7 | loss: 0.6400984
	speed: 0.0044s/iter; left time: 5.9151s
	iters: 800, epoch: 7 | loss: 1.5358180
	speed: 0.0043s/iter; left time: 5.4400s
	iters: 900, epoch: 7 | loss: 1.3136775
	speed: 0.0035s/iter; left time: 4.0015s
	iters: 1000, epoch: 7 | loss: 0.6319149
	speed: 0.0032s/iter; left time: 3.4182s
Updating learning rate to 8.556735640625e-07
Epoch: 7 cost time: 4.142459392547607
Epoch: 7, Steps: 1027 | Train Loss: 0.6787998 Vali Loss: 0.3675684 Best vali loss: 0.3650909
	iters: 100, epoch: 8 | loss: 0.7736380
	speed: 0.0096s/iter; left time: 8.9534s
	iters: 200, epoch: 8 | loss: 0.7246507
	speed: 0.0032s/iter; left time: 2.6468s
	iters: 300, epoch: 8 | loss: 1.0045803
	speed: 0.0037s/iter; left time: 2.7229s
	iters: 400, epoch: 8 | loss: 0.3577187
	speed: 0.0038s/iter; left time: 2.3753s
	iters: 500, epoch: 8 | loss: 0.2715074
	speed: 0.0039s/iter; left time: 2.0447s
	iters: 600, epoch: 8 | loss: 1.0773277
	speed: 0.0038s/iter; left time: 1.6247s
	iters: 700, epoch: 8 | loss: 0.6818293
	speed: 0.0036s/iter; left time: 1.1907s
	iters: 800, epoch: 8 | loss: 0.1449567
	speed: 0.0037s/iter; left time: 0.8490s
	iters: 900, epoch: 8 | loss: 0.4388033
	speed: 0.0037s/iter; left time: 0.4765s
	iters: 1000, epoch: 8 | loss: 0.7300338
	speed: 0.0038s/iter; left time: 0.1074s
Updating learning rate to 4.2783678203125e-07
Epoch: 8 cost time: 3.8088934421539307
Epoch: 8, Steps: 1027 | Train Loss: 0.6205046 Vali Loss: 0.3674662 Best vali loss: 0.3650909

best validation loss 0.36509092546165106

{'batch_size': 16, 'd_core': 512, 'd_model': 64, 'dropout': 0.0094870957593, 'e_layers': 3, 'learning_rate': 6.09485552e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0131905
	speed: 0.0117s/iter; left time: 47.0960s
	iters: 200, epoch: 1 | loss: 0.4119450
	speed: 0.0057s/iter; left time: 22.1253s
	iters: 300, epoch: 1 | loss: 1.0149486
	speed: 0.0060s/iter; left time: 22.8906s
	iters: 400, epoch: 1 | loss: 0.8671686
	speed: 0.0061s/iter; left time: 22.7047s
	iters: 500, epoch: 1 | loss: 0.4951634
	speed: 0.0056s/iter; left time: 20.3071s
Updating learning rate to 6.09485552e-05
Validation loss decreased (inf --> 0.3890).  Saving model state dict ...
Epoch: 1 cost time: 3.273829221725464
Epoch: 1, Steps: 514 | Train Loss: 0.7604832 Vali Loss: 0.3889997 Best vali loss: 0.3889997
	iters: 100, epoch: 2 | loss: 0.7157198
	speed: 0.0131s/iter; left time: 45.6665s
	iters: 200, epoch: 2 | loss: 0.4941504
	speed: 0.0062s/iter; left time: 21.2374s
	iters: 300, epoch: 2 | loss: 0.7061902
	speed: 0.0054s/iter; left time: 17.6871s
	iters: 400, epoch: 2 | loss: 0.7666337
	speed: 0.0057s/iter; left time: 18.3617s
	iters: 500, epoch: 2 | loss: 0.5591058
	speed: 0.0059s/iter; left time: 18.2377s
Updating learning rate to 3.04742776e-05
Validation loss decreased (0.3890 --> 0.3722).  Saving model state dict ...
Epoch: 2 cost time: 3.07174015045166
Epoch: 2, Steps: 514 | Train Loss: 0.6483600 Vali Loss: 0.3721882 Best vali loss: 0.3721882
	iters: 100, epoch: 3 | loss: 0.3705399
	speed: 0.0127s/iter; left time: 37.7671s
	iters: 200, epoch: 3 | loss: 0.8564236
	speed: 0.0065s/iter; left time: 18.8436s
	iters: 300, epoch: 3 | loss: 0.6374812
	speed: 0.0062s/iter; left time: 17.3546s
	iters: 400, epoch: 3 | loss: 0.7661722
	speed: 0.0061s/iter; left time: 16.4666s
	iters: 500, epoch: 3 | loss: 0.3031733
	speed: 0.0062s/iter; left time: 16.0278s
Updating learning rate to 1.52371388e-05
Validation loss decreased (0.3722 --> 0.3696).  Saving model state dict ...
Epoch: 3 cost time: 3.2187905311584473
Epoch: 3, Steps: 514 | Train Loss: 0.5867581 Vali Loss: 0.3695761 Best vali loss: 0.3695761
	iters: 100, epoch: 4 | loss: 0.6558650
	speed: 0.0133s/iter; left time: 32.7924s
	iters: 200, epoch: 4 | loss: 0.6197690
	speed: 0.0059s/iter; left time: 14.0845s
	iters: 300, epoch: 4 | loss: 0.7016094
	speed: 0.0046s/iter; left time: 10.4761s
	iters: 400, epoch: 4 | loss: 0.4718325
	speed: 0.0050s/iter; left time: 10.9610s
	iters: 500, epoch: 4 | loss: 0.5352061
	speed: 0.0061s/iter; left time: 12.6173s
Updating learning rate to 7.6185694e-06
Validation loss decreased (0.3696 --> 0.3681).  Saving model state dict ...
Epoch: 4 cost time: 2.933225631713867
Epoch: 4, Steps: 514 | Train Loss: 0.5968564 Vali Loss: 0.3680666 Best vali loss: 0.3680666
	iters: 100, epoch: 5 | loss: 0.6608478
	speed: 0.0126s/iter; left time: 24.5815s
	iters: 200, epoch: 5 | loss: 0.4951753
	speed: 0.0062s/iter; left time: 11.5156s
	iters: 300, epoch: 5 | loss: 0.3924258
	speed: 0.0060s/iter; left time: 10.5149s
	iters: 400, epoch: 5 | loss: 0.6827945
	speed: 0.0060s/iter; left time: 10.0080s
	iters: 500, epoch: 5 | loss: 0.3872191
	speed: 0.0063s/iter; left time: 9.7926s
Updating learning rate to 3.8092847e-06
Validation loss decreased (0.3681 --> 0.3678).  Saving model state dict ...
Epoch: 5 cost time: 3.1970903873443604
Epoch: 5, Steps: 514 | Train Loss: 0.5236925 Vali Loss: 0.3677550 Best vali loss: 0.3677550
	iters: 100, epoch: 6 | loss: 0.8151639
	speed: 0.0128s/iter; left time: 18.4940s
	iters: 200, epoch: 6 | loss: 0.8827448
	speed: 0.0060s/iter; left time: 8.1087s
	iters: 300, epoch: 6 | loss: 0.3197305
	speed: 0.0061s/iter; left time: 7.5222s
	iters: 400, epoch: 6 | loss: 0.2918268
	speed: 0.0059s/iter; left time: 6.7322s
	iters: 500, epoch: 6 | loss: 0.3624638
	speed: 0.0064s/iter; left time: 6.6416s
Updating learning rate to 1.90464235e-06
Validation loss decreased (0.3678 --> 0.3675).  Saving model state dict ...
Epoch: 6 cost time: 3.2115426063537598
Epoch: 6, Steps: 514 | Train Loss: 0.5343859 Vali Loss: 0.3674947 Best vali loss: 0.3674947
	iters: 100, epoch: 7 | loss: 1.1788373
	speed: 0.0130s/iter; left time: 12.1030s
	iters: 200, epoch: 7 | loss: 0.7525330
	speed: 0.0061s/iter; left time: 5.0174s
	iters: 300, epoch: 7 | loss: 0.7797952
	speed: 0.0063s/iter; left time: 4.5827s
	iters: 400, epoch: 7 | loss: 0.8034300
	speed: 0.0055s/iter; left time: 3.4363s
	iters: 500, epoch: 7 | loss: 1.0497978
	speed: 0.0061s/iter; left time: 3.2520s
Updating learning rate to 9.52321175e-07
Validation loss decreased (0.3675 --> 0.3674).  Saving model state dict ...
Epoch: 7 cost time: 3.1731274127960205
Epoch: 7, Steps: 514 | Train Loss: 0.9128787 Vali Loss: 0.3674472 Best vali loss: 0.3674472
	iters: 100, epoch: 8 | loss: 0.7531925
	speed: 0.0127s/iter; left time: 5.2793s
	iters: 200, epoch: 8 | loss: 0.6951200
	speed: 0.0060s/iter; left time: 1.8878s
	iters: 300, epoch: 8 | loss: 0.8224891
	speed: 0.0061s/iter; left time: 1.3173s
	iters: 400, epoch: 8 | loss: 0.6151445
	speed: 0.0060s/iter; left time: 0.6953s
	iters: 500, epoch: 8 | loss: 0.4974288
	speed: 0.0061s/iter; left time: 0.0911s
Updating learning rate to 4.761605875e-07
Validation loss decreased (0.3674 --> 0.3674).  Saving model state dict ...
Epoch: 8 cost time: 3.1761562824249268
Epoch: 8, Steps: 514 | Train Loss: 0.6766750 Vali Loss: 0.3674303 Best vali loss: 0.3674303

best validation loss 0.36743034815273024

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0044711634464, 'e_layers': 3, 'learning_rate': 0.0004262443426, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3666358
	speed: 0.0105s/iter; left time: 85.1161s
	iters: 200, epoch: 1 | loss: 0.3794746
	speed: 0.0051s/iter; left time: 40.6783s
	iters: 300, epoch: 1 | loss: 0.2227617
	speed: 0.0046s/iter; left time: 36.2313s
	iters: 400, epoch: 1 | loss: 1.4896857
	speed: 0.0048s/iter; left time: 37.4363s
	iters: 500, epoch: 1 | loss: 0.2836031
	speed: 0.0053s/iter; left time: 40.5272s
	iters: 600, epoch: 1 | loss: 0.5549744
	speed: 0.0052s/iter; left time: 39.6685s
	iters: 700, epoch: 1 | loss: 1.6891981
	speed: 0.0052s/iter; left time: 39.0797s
	iters: 800, epoch: 1 | loss: 0.7560237
	speed: 0.0052s/iter; left time: 38.3936s
	iters: 900, epoch: 1 | loss: 0.7317945
	speed: 0.0052s/iter; left time: 38.3711s
	iters: 1000, epoch: 1 | loss: 0.3380734
	speed: 0.0050s/iter; left time: 36.0186s
Updating learning rate to 0.0004100213832884344
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 5.462615966796875
Epoch: 1, Steps: 1027 | Train Loss: 0.6812225 Vali Loss: 0.3747613 Best vali loss: 0.3747613
	iters: 100, epoch: 2 | loss: 0.2313159
	speed: 0.0150s/iter; left time: 106.1296s
	iters: 200, epoch: 2 | loss: 0.9323073
	speed: 0.0052s/iter; left time: 36.3968s
	iters: 300, epoch: 2 | loss: 0.5353748
	speed: 0.0052s/iter; left time: 35.9653s
	iters: 400, epoch: 2 | loss: 0.8740566
	speed: 0.0052s/iter; left time: 35.1391s
	iters: 500, epoch: 2 | loss: 0.3670503
	speed: 0.0053s/iter; left time: 35.1687s
	iters: 600, epoch: 2 | loss: 0.3393373
	speed: 0.0046s/iter; left time: 30.1873s
	iters: 700, epoch: 2 | loss: 0.3015462
	speed: 0.0050s/iter; left time: 32.3762s
	iters: 800, epoch: 2 | loss: 0.4432263
	speed: 0.0052s/iter; left time: 33.1372s
	iters: 900, epoch: 2 | loss: 0.4661711
	speed: 0.0052s/iter; left time: 32.4675s
	iters: 1000, epoch: 2 | loss: 0.2971294
	speed: 0.0050s/iter; left time: 30.8742s
Updating learning rate to 0.000363822303847431
Epoch: 2 cost time: 5.284006118774414
Epoch: 2, Steps: 1027 | Train Loss: 0.4787515 Vali Loss: 0.3874322 Best vali loss: 0.3747613
	iters: 100, epoch: 3 | loss: 1.1281186
	speed: 0.0154s/iter; left time: 93.4352s
	iters: 200, epoch: 3 | loss: 0.3935073
	speed: 0.0046s/iter; left time: 27.1564s
	iters: 300, epoch: 3 | loss: 2.0141809
	speed: 0.0044s/iter; left time: 25.7716s
	iters: 400, epoch: 3 | loss: 0.6316576
	speed: 0.0091s/iter; left time: 52.2397s
	iters: 500, epoch: 3 | loss: 1.3515161
	speed: 0.0069s/iter; left time: 38.7985s
	iters: 600, epoch: 3 | loss: 0.2719615
	speed: 0.0065s/iter; left time: 36.3674s
	iters: 700, epoch: 3 | loss: 0.9435388
	speed: 0.0085s/iter; left time: 46.1686s
	iters: 800, epoch: 3 | loss: 1.2471285
	speed: 0.0051s/iter; left time: 27.3876s
	iters: 900, epoch: 3 | loss: 0.4008241
	speed: 0.0082s/iter; left time: 43.3272s
	iters: 1000, epoch: 3 | loss: 0.1619930
	speed: 0.0065s/iter; left time: 33.5388s
Updating learning rate to 0.00029468049532618465
Epoch: 3 cost time: 6.67323899269104
Epoch: 3, Steps: 1027 | Train Loss: 0.8544426 Vali Loss: 0.3755046 Best vali loss: 0.3747613

best validation loss 0.3747613498878854

{'batch_size': 16, 'd_core': 512, 'd_model': 512, 'dropout': 0.00113692195, 'e_layers': 4, 'learning_rate': 0.0017228387955, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1323668
	speed: 0.0175s/iter; left time: 70.3705s
	iters: 200, epoch: 1 | loss: 1.0475243
	speed: 0.0100s/iter; left time: 39.0647s
	iters: 300, epoch: 1 | loss: 0.6157416
	speed: 0.0113s/iter; left time: 43.0088s
	iters: 400, epoch: 1 | loss: 0.5822282
	speed: 0.0114s/iter; left time: 42.2857s
	iters: 500, epoch: 1 | loss: 0.7506568
	speed: 0.0099s/iter; left time: 35.6824s
Updating learning rate to 0.0016572671482394242
Validation loss decreased (inf --> 0.4153).  Saving model state dict ...
Epoch: 1 cost time: 5.842149496078491
Epoch: 1, Steps: 514 | Train Loss: 0.8257036 Vali Loss: 0.4152851 Best vali loss: 0.4152851
	iters: 100, epoch: 2 | loss: 0.7274646
	speed: 0.0213s/iter; left time: 74.4656s
	iters: 200, epoch: 2 | loss: 0.5976844
	speed: 0.0092s/iter; left time: 31.3443s
	iters: 300, epoch: 2 | loss: 0.8517439
	speed: 0.0058s/iter; left time: 19.2276s
	iters: 400, epoch: 2 | loss: 0.3658644
	speed: 0.0072s/iter; left time: 23.1735s
	iters: 500, epoch: 2 | loss: 0.6672534
	speed: 0.0078s/iter; left time: 24.2867s
Updating learning rate to 0.0014705348953446568
Validation loss decreased (0.4153 --> 0.3989).  Saving model state dict ...
Epoch: 2 cost time: 4.316497325897217
Epoch: 2, Steps: 514 | Train Loss: 0.6420021 Vali Loss: 0.3989229 Best vali loss: 0.3989229
	iters: 100, epoch: 3 | loss: 0.6977591
	speed: 0.0163s/iter; left time: 48.5458s
	iters: 200, epoch: 3 | loss: 0.5716245
	speed: 0.0076s/iter; left time: 21.9443s
	iters: 300, epoch: 3 | loss: 0.3905996
	speed: 0.0074s/iter; left time: 20.5218s
	iters: 400, epoch: 3 | loss: 0.4014582
	speed: 0.0078s/iter; left time: 21.0237s
	iters: 500, epoch: 3 | loss: 0.7047484
	speed: 0.0080s/iter; left time: 20.7707s
Updating learning rate to 0.0011910703295868385
Epoch: 3 cost time: 4.0320963859558105
Epoch: 3, Steps: 514 | Train Loss: 0.5532379 Vali Loss: 0.4084201 Best vali loss: 0.3989229

best validation loss 0.3989229336410234

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7148471
	speed: 0.0119s/iter; left time: 23.2384s
	iters: 200, epoch: 1 | loss: 0.7124249
	speed: 0.0058s/iter; left time: 10.7974s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.3734).  Saving model state dict ...
Epoch: 1 cost time: 1.8340544700622559
Epoch: 1, Steps: 257 | Train Loss: 0.7136360 Vali Loss: 0.3734035 Best vali loss: 0.3734035
	iters: 100, epoch: 2 | loss: 0.5078289
	speed: 0.0128s/iter; left time: 21.7977s
	iters: 200, epoch: 2 | loss: 0.3638742
	speed: 0.0056s/iter; left time: 8.9874s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.3734 --> 0.3636).  Saving model state dict ...
Epoch: 2 cost time: 1.3949546813964844
Epoch: 2, Steps: 257 | Train Loss: 0.4358515 Vali Loss: 0.3635688 Best vali loss: 0.3635688
	iters: 100, epoch: 3 | loss: 0.5455037
	speed: 0.0101s/iter; left time: 14.6141s
	iters: 200, epoch: 3 | loss: 0.6350930
	speed: 0.0059s/iter; left time: 7.9065s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 1.4873952865600586
Epoch: 3, Steps: 257 | Train Loss: 0.5902984 Vali Loss: 0.3655377 Best vali loss: 0.3635688

best validation loss 0.3635688483715057

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0047463729232, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6187267
	speed: 0.0123s/iter; left time: 14.5948s
	iters: 200, epoch: 4 | loss: 0.6448041
	speed: 0.0056s/iter; left time: 6.0749s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 1.7804296016693115
Epoch: 4, Steps: 257 | Train Loss: 0.6317654 Vali Loss: 0.3641419 Best vali loss: 0.3635688
	iters: 100, epoch: 5 | loss: 0.5009366
	speed: 0.0132s/iter; left time: 12.2301s
	iters: 200, epoch: 5 | loss: 0.3617215
	speed: 0.0060s/iter; left time: 5.0054s
Updating learning rate to 3.3224917040731837e-05
Validation loss decreased (0.3636 --> 0.3595).  Saving model state dict ...
Epoch: 5 cost time: 1.5825536251068115
Epoch: 5, Steps: 257 | Train Loss: 0.4313290 Vali Loss: 0.3595196 Best vali loss: 0.3595196
	iters: 100, epoch: 6 | loss: 0.5316986
	speed: 0.0131s/iter; left time: 8.8205s
	iters: 200, epoch: 6 | loss: 0.6110383
	speed: 0.0058s/iter; left time: 3.3440s
Updating learning rate to 1.5763958732151084e-05
Epoch: 6 cost time: 1.5554876327514648
Epoch: 6, Steps: 257 | Train Loss: 0.5713685 Vali Loss: 0.3613649 Best vali loss: 0.3595196
	iters: 100, epoch: 7 | loss: 0.7603070
	speed: 0.0130s/iter; left time: 5.4120s
	iters: 200, epoch: 7 | loss: 0.5802144
	speed: 0.0057s/iter; left time: 1.8010s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 1.5243933200836182
Epoch: 7, Steps: 257 | Train Loss: 0.6702607 Vali Loss: 0.3602670 Best vali loss: 0.3595196
	iters: 100, epoch: 8 | loss: 0.4012331
	speed: 0.0130s/iter; left time: 2.0486s
	iters: 200, epoch: 8 | loss: 0.6620668
	speed: 0.0059s/iter; left time: 0.3397s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.564330816268921
Epoch: 8, Steps: 257 | Train Loss: 0.5316500 Vali Loss: 0.3609883 Best vali loss: 0.3595196

best validation loss 0.35951955162705984

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0012309194537, 'e_layers': 1, 'learning_rate': 0.0001461940837, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0296762
	speed: 0.0094s/iter; left time: 37.5547s
	iters: 200, epoch: 1 | loss: 0.3257773
	speed: 0.0032s/iter; left time: 12.5264s
	iters: 300, epoch: 1 | loss: 0.3791005
	speed: 0.0023s/iter; left time: 8.9535s
	iters: 400, epoch: 1 | loss: 0.8070459
	speed: 0.0027s/iter; left time: 9.8888s
	iters: 500, epoch: 1 | loss: 1.0218933
	speed: 0.0027s/iter; left time: 9.8605s
Updating learning rate to 0.00014062990270233595
Validation loss decreased (inf --> 0.3911).  Saving model state dict ...
Epoch: 1 cost time: 1.767728328704834
Epoch: 1, Steps: 514 | Train Loss: 0.7126987 Vali Loss: 0.3910864 Best vali loss: 0.3910864
	iters: 100, epoch: 2 | loss: 0.8785788
	speed: 0.0136s/iter; left time: 47.6846s
	iters: 200, epoch: 2 | loss: 0.6679427
	speed: 0.0045s/iter; left time: 15.3719s
	iters: 300, epoch: 2 | loss: 0.6414925
	speed: 0.0061s/iter; left time: 20.0899s
	iters: 400, epoch: 2 | loss: 0.3127972
	speed: 0.0052s/iter; left time: 16.6401s
	iters: 500, epoch: 2 | loss: 0.7808317
	speed: 0.0047s/iter; left time: 14.4112s
Updating learning rate to 0.00012478445582681183
Validation loss decreased (0.3911 --> 0.3747).  Saving model state dict ...
Epoch: 2 cost time: 2.6948955059051514
Epoch: 2, Steps: 514 | Train Loss: 0.6563286 Vali Loss: 0.3746821 Best vali loss: 0.3746821
	iters: 100, epoch: 3 | loss: 1.0970244
	speed: 0.0121s/iter; left time: 36.0118s
	iters: 200, epoch: 3 | loss: 0.6145691
	speed: 0.0055s/iter; left time: 15.9335s
	iters: 300, epoch: 3 | loss: 0.6919841
	speed: 0.0055s/iter; left time: 15.3491s
	iters: 400, epoch: 3 | loss: 0.9811618
	speed: 0.0043s/iter; left time: 11.6225s
	iters: 500, epoch: 3 | loss: 0.6923900
	speed: 0.0058s/iter; left time: 14.9660s
Updating learning rate to 0.00010107006872089262
Validation loss decreased (0.3747 --> 0.3682).  Saving model state dict ...
Epoch: 3 cost time: 2.656329870223999
Epoch: 3, Steps: 514 | Train Loss: 0.8154259 Vali Loss: 0.3681708 Best vali loss: 0.3681708
	iters: 100, epoch: 4 | loss: 1.0871150
	speed: 0.0075s/iter; left time: 18.4358s
	iters: 200, epoch: 4 | loss: 0.2505364
	speed: 0.0026s/iter; left time: 6.1839s
	iters: 300, epoch: 4 | loss: 0.5612385
	speed: 0.0028s/iter; left time: 6.3236s
	iters: 400, epoch: 4 | loss: 0.7196815
	speed: 0.0036s/iter; left time: 7.9134s
	iters: 500, epoch: 4 | loss: 0.7514899
	speed: 0.0035s/iter; left time: 7.2822s
Updating learning rate to 7.309704185e-05
Validation loss decreased (0.3682 --> 0.3663).  Saving model state dict ...
Epoch: 4 cost time: 1.6071217060089111
Epoch: 4, Steps: 514 | Train Loss: 0.6740123 Vali Loss: 0.3662912 Best vali loss: 0.3662912
	iters: 100, epoch: 5 | loss: 0.4310288
	speed: 0.0089s/iter; left time: 17.4073s
	iters: 200, epoch: 5 | loss: 0.5748347
	speed: 0.0034s/iter; left time: 6.3797s
	iters: 300, epoch: 5 | loss: 0.8075457
	speed: 0.0032s/iter; left time: 5.6394s
	iters: 400, epoch: 5 | loss: 0.4215042
	speed: 0.0036s/iter; left time: 5.8902s
	iters: 500, epoch: 5 | loss: 0.4150977
	speed: 0.0032s/iter; left time: 5.0220s
Updating learning rate to 4.512401497910739e-05
Epoch: 5 cost time: 1.7732739448547363
Epoch: 5, Steps: 514 | Train Loss: 0.5300022 Vali Loss: 0.3665100 Best vali loss: 0.3662912
	iters: 100, epoch: 6 | loss: 0.4628862
	speed: 0.0088s/iter; left time: 12.7028s
	iters: 200, epoch: 6 | loss: 0.8525696
	speed: 0.0035s/iter; left time: 4.6851s
	iters: 300, epoch: 6 | loss: 0.5531890
	speed: 0.0032s/iter; left time: 3.9803s
	iters: 400, epoch: 6 | loss: 1.3113430
	speed: 0.0033s/iter; left time: 3.7965s
	iters: 500, epoch: 6 | loss: 0.7762600
	speed: 0.0035s/iter; left time: 3.6367s
Updating learning rate to 2.1409627873188145e-05
Validation loss decreased (0.3663 --> 0.3661).  Saving model state dict ...
Epoch: 6 cost time: 1.7849457263946533
Epoch: 6, Steps: 514 | Train Loss: 0.7912496 Vali Loss: 0.3660583 Best vali loss: 0.3660583
	iters: 100, epoch: 7 | loss: 0.5572462
	speed: 0.0087s/iter; left time: 8.0687s
	iters: 200, epoch: 7 | loss: 0.6095400
	speed: 0.0033s/iter; left time: 2.7767s
	iters: 300, epoch: 7 | loss: 0.5788868
	speed: 0.0033s/iter; left time: 2.4297s
	iters: 400, epoch: 7 | loss: 0.4408885
	speed: 0.0034s/iter; left time: 2.1632s
	iters: 500, epoch: 7 | loss: 0.7171648
	speed: 0.0033s/iter; left time: 1.7260s
Updating learning rate to 5.564180997664037e-06
Validation loss decreased (0.3661 --> 0.3660).  Saving model state dict ...
Epoch: 7 cost time: 1.7501323223114014
Epoch: 7, Steps: 514 | Train Loss: 0.5807453 Vali Loss: 0.3660279 Best vali loss: 0.3660279
	iters: 100, epoch: 8 | loss: 0.8604763
	speed: 0.0089s/iter; left time: 3.6963s
	iters: 200, epoch: 8 | loss: 0.7609262
	speed: 0.0034s/iter; left time: 1.0816s
	iters: 300, epoch: 8 | loss: 0.4717225
	speed: 0.0032s/iter; left time: 0.6864s
	iters: 400, epoch: 8 | loss: 0.5183498
	speed: 0.0035s/iter; left time: 0.4057s
	iters: 500, epoch: 8 | loss: 0.5499312
	speed: 0.0034s/iter; left time: 0.0512s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7977545261383057
Epoch: 8, Steps: 514 | Train Loss: 0.6322812 Vali Loss: 0.3660292 Best vali loss: 0.3660279

best validation loss 0.3660278913197208

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0010359583968, 'e_layers': 4, 'learning_rate': 0.0005252026555, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.4423078
	speed: 0.0126s/iter; left time: 50.5937s
	iters: 200, epoch: 1 | loss: 0.5901209
	speed: 0.0070s/iter; left time: 27.5446s
	iters: 300, epoch: 1 | loss: 0.3599891
	speed: 0.0071s/iter; left time: 26.8964s
	iters: 400, epoch: 1 | loss: 0.2763895
	speed: 0.0068s/iter; left time: 25.3916s
	iters: 500, epoch: 1 | loss: 0.6163126
	speed: 0.0069s/iter; left time: 25.0662s
Updating learning rate to 0.0005252026555
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 3.8718905448913574
Epoch: 1, Steps: 514 | Train Loss: 0.6570240 Vali Loss: 0.3669711 Best vali loss: 0.3669711
	iters: 100, epoch: 2 | loss: 0.2951600
	speed: 0.0138s/iter; left time: 48.4424s
	iters: 200, epoch: 2 | loss: 0.7674327
	speed: 0.0067s/iter; left time: 22.7815s
	iters: 300, epoch: 2 | loss: 0.4970289
	speed: 0.0070s/iter; left time: 22.9417s
	iters: 400, epoch: 2 | loss: 0.6906739
	speed: 0.0069s/iter; left time: 22.0159s
	iters: 500, epoch: 2 | loss: 0.4707743
	speed: 0.0070s/iter; left time: 21.6447s
Updating learning rate to 0.00026260132775
Epoch: 2 cost time: 3.6004323959350586
Epoch: 2, Steps: 514 | Train Loss: 0.5442140 Vali Loss: 0.3731845 Best vali loss: 0.3669711
	iters: 100, epoch: 3 | loss: 0.7306944
	speed: 0.0136s/iter; left time: 40.6221s
	iters: 200, epoch: 3 | loss: 0.9622603
	speed: 0.0069s/iter; left time: 19.9411s
	iters: 300, epoch: 3 | loss: 0.4140168
	speed: 0.0069s/iter; left time: 19.3250s
	iters: 400, epoch: 3 | loss: 0.6223158
	speed: 0.0071s/iter; left time: 19.1285s
	iters: 500, epoch: 3 | loss: 0.7508538
	speed: 0.0066s/iter; left time: 17.0712s
Updating learning rate to 0.000131300663875
Epoch: 3 cost time: 3.5825130939483643
Epoch: 3, Steps: 514 | Train Loss: 0.6960282 Vali Loss: 0.3744652 Best vali loss: 0.3669711
	iters: 100, epoch: 4 | loss: 0.7954713
	speed: 0.0140s/iter; left time: 34.6243s
	iters: 200, epoch: 4 | loss: 0.8954483
	speed: 0.0070s/iter; left time: 16.6050s
	iters: 300, epoch: 4 | loss: 0.3262599
	speed: 0.0069s/iter; left time: 15.6509s
	iters: 400, epoch: 4 | loss: 0.6826243
	speed: 0.0070s/iter; left time: 15.2226s
	iters: 500, epoch: 4 | loss: 0.3493416
	speed: 0.0070s/iter; left time: 14.4887s
Updating learning rate to 6.56503319375e-05
Validation loss decreased (0.3670 --> 0.3632).  Saving model state dict ...
Epoch: 4 cost time: 3.643221616744995
Epoch: 4, Steps: 514 | Train Loss: 0.6098291 Vali Loss: 0.3632289 Best vali loss: 0.3632289
	iters: 100, epoch: 5 | loss: 0.8862268
	speed: 0.0137s/iter; left time: 26.8214s
	iters: 200, epoch: 5 | loss: 0.2503070
	speed: 0.0068s/iter; left time: 12.6569s
	iters: 300, epoch: 5 | loss: 0.5828453
	speed: 0.0068s/iter; left time: 11.9987s
	iters: 400, epoch: 5 | loss: 0.5461102
	speed: 0.0068s/iter; left time: 11.3150s
	iters: 500, epoch: 5 | loss: 0.5263821
	speed: 0.0068s/iter; left time: 10.6489s
Updating learning rate to 3.282516596875e-05
Validation loss decreased (0.3632 --> 0.3583).  Saving model state dict ...
Epoch: 5 cost time: 3.5632548332214355
Epoch: 5, Steps: 514 | Train Loss: 0.5583743 Vali Loss: 0.3582750 Best vali loss: 0.3582750
	iters: 100, epoch: 6 | loss: 0.4795673
	speed: 0.0140s/iter; left time: 20.1608s
	iters: 200, epoch: 6 | loss: 0.2124170
	speed: 0.0067s/iter; left time: 8.9472s
	iters: 300, epoch: 6 | loss: 0.5981422
	speed: 0.0068s/iter; left time: 8.4394s
	iters: 400, epoch: 6 | loss: 0.6732470
	speed: 0.0070s/iter; left time: 7.9852s
	iters: 500, epoch: 6 | loss: 0.5761837
	speed: 0.0069s/iter; left time: 7.2422s
Updating learning rate to 1.6412582984375e-05
Epoch: 6 cost time: 3.552381992340088
Epoch: 6, Steps: 514 | Train Loss: 0.5079114 Vali Loss: 0.3590917 Best vali loss: 0.3582750
	iters: 100, epoch: 7 | loss: 0.2680988
	speed: 0.0137s/iter; left time: 12.7027s
	iters: 200, epoch: 7 | loss: 0.7495517
	speed: 0.0069s/iter; left time: 5.7204s
	iters: 300, epoch: 7 | loss: 0.3422163
	speed: 0.0065s/iter; left time: 4.7263s
	iters: 400, epoch: 7 | loss: 0.8321121
	speed: 0.0066s/iter; left time: 4.1522s
	iters: 500, epoch: 7 | loss: 0.2725160
	speed: 0.0067s/iter; left time: 3.5398s
Updating learning rate to 8.2062914921875e-06
Epoch: 7 cost time: 3.4982962608337402
Epoch: 7, Steps: 514 | Train Loss: 0.4928990 Vali Loss: 0.3609926 Best vali loss: 0.3582750
	iters: 100, epoch: 8 | loss: 0.6692215
	speed: 0.0135s/iter; left time: 5.5833s
	iters: 200, epoch: 8 | loss: 0.7121077
	speed: 0.0069s/iter; left time: 2.1722s
	iters: 300, epoch: 8 | loss: 0.7166353
	speed: 0.0069s/iter; left time: 1.4819s
	iters: 400, epoch: 8 | loss: 0.5037236
	speed: 0.0068s/iter; left time: 0.7855s
	iters: 500, epoch: 8 | loss: 0.3722695
	speed: 0.0070s/iter; left time: 0.1050s
Updating learning rate to 4.10314574609375e-06
Epoch: 8 cost time: 3.593369722366333
Epoch: 8, Steps: 514 | Train Loss: 0.5947915 Vali Loss: 0.3606159 Best vali loss: 0.3582750

best validation loss 0.3582749961401484

[INFO][smbo.py:320] Finished 300 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0014282327355, 'e_layers': 2, 'learning_rate': 0.0011080068437, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5237262
	speed: 0.0113s/iter; left time: 22.1005s
	iters: 200, epoch: 1 | loss: 0.6578330
	speed: 0.0056s/iter; left time: 10.3155s
Updating learning rate to 0.0011080068437
Validation loss decreased (inf --> 0.4044).  Saving model state dict ...
Epoch: 1 cost time: 1.7237684726715088
Epoch: 1, Steps: 257 | Train Loss: 0.5907796 Vali Loss: 0.4043671 Best vali loss: 0.4043671
	iters: 100, epoch: 2 | loss: 0.4740165
	speed: 0.0124s/iter; left time: 20.9999s
	iters: 200, epoch: 2 | loss: 0.7613992
	speed: 0.0053s/iter; left time: 8.5427s
Updating learning rate to 0.00055400342185
Validation loss decreased (0.4044 --> 0.3904).  Saving model state dict ...
Epoch: 2 cost time: 1.4437966346740723
Epoch: 2, Steps: 257 | Train Loss: 0.6177078 Vali Loss: 0.3904008 Best vali loss: 0.3904008
	iters: 100, epoch: 3 | loss: 0.9026302
	speed: 0.0124s/iter; left time: 17.8801s
	iters: 200, epoch: 3 | loss: 0.8592792
	speed: 0.0055s/iter; left time: 7.4089s
Updating learning rate to 0.000277001710925
Epoch: 3 cost time: 1.4603960514068604
Epoch: 3, Steps: 257 | Train Loss: 0.8809547 Vali Loss: 0.3978266 Best vali loss: 0.3904008

best validation loss 0.39040083494073985

{'batch_size': 32, 'd_core': 128, 'd_model': 512, 'dropout': 0.0082216964171, 'e_layers': 4, 'learning_rate': 0.0011920870975, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4842898
	speed: 0.0142s/iter; left time: 27.8716s
	iters: 200, epoch: 1 | loss: 0.5816624
	speed: 0.0084s/iter; left time: 15.5436s
Updating learning rate to 0.0011467159839255183
Validation loss decreased (inf --> 0.4051).  Saving model state dict ...
Epoch: 1 cost time: 2.462963819503784
Epoch: 1, Steps: 257 | Train Loss: 0.5329761 Vali Loss: 0.4051391 Best vali loss: 0.4051391
	iters: 100, epoch: 2 | loss: 0.4581384
	speed: 0.0170s/iter; left time: 28.9476s
	iters: 200, epoch: 2 | loss: 0.6379376
	speed: 0.0084s/iter; left time: 13.4730s
Updating learning rate to 0.0010175099839536193
Validation loss decreased (0.4051 --> 0.4001).  Saving model state dict ...
Epoch: 2 cost time: 2.148366689682007
Epoch: 2, Steps: 257 | Train Loss: 0.5480380 Vali Loss: 0.4000579 Best vali loss: 0.4000579
	iters: 100, epoch: 3 | loss: 0.5690080
	speed: 0.0175s/iter; left time: 25.2476s
	iters: 200, epoch: 3 | loss: 0.4355726
	speed: 0.0080s/iter; left time: 10.7688s
Updating learning rate to 0.0008241395398247187
Epoch: 3 cost time: 2.131009578704834
Epoch: 3, Steps: 257 | Train Loss: 0.5022903 Vali Loss: 0.4047378 Best vali loss: 0.4000579

best validation loss 0.40005788385048363

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006117524437, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1377991
	speed: 0.0089s/iter; left time: 35.8009s
	iters: 200, epoch: 1 | loss: 0.3527339
	speed: 0.0032s/iter; left time: 12.3398s
	iters: 300, epoch: 1 | loss: 0.3450244
	speed: 0.0031s/iter; left time: 11.9501s
	iters: 400, epoch: 1 | loss: 0.2464247
	speed: 0.0037s/iter; left time: 13.7308s
	iters: 500, epoch: 1 | loss: 0.6161162
	speed: 0.0035s/iter; left time: 12.7714s
Updating learning rate to 0.0005884690026990967
Validation loss decreased (inf --> 0.3667).  Saving model state dict ...
Epoch: 1 cost time: 2.025608539581299
Epoch: 1, Steps: 514 | Train Loss: 0.5396197 Vali Loss: 0.3666721 Best vali loss: 0.3666721
	iters: 100, epoch: 2 | loss: 1.5188376
	speed: 0.0118s/iter; left time: 41.2996s
	iters: 200, epoch: 2 | loss: 0.2555426
	speed: 0.0048s/iter; left time: 16.1777s
	iters: 300, epoch: 2 | loss: 0.7315221
	speed: 0.0051s/iter; left time: 16.6862s
	iters: 400, epoch: 2 | loss: 0.8184869
	speed: 0.0053s/iter; left time: 16.9034s
	iters: 500, epoch: 2 | loss: 0.7012105
	speed: 0.0051s/iter; left time: 15.6811s
Updating learning rate to 0.0005221633725238558
Epoch: 2 cost time: 2.6682658195495605
Epoch: 2, Steps: 514 | Train Loss: 0.8051199 Vali Loss: 0.3699547 Best vali loss: 0.3666721
	iters: 100, epoch: 3 | loss: 0.6645613
	speed: 0.0115s/iter; left time: 34.2293s
	iters: 200, epoch: 3 | loss: 0.4891932
	speed: 0.0049s/iter; left time: 14.1264s
	iters: 300, epoch: 3 | loss: 0.5073050
	speed: 0.0038s/iter; left time: 10.5222s
	iters: 400, epoch: 3 | loss: 0.5984024
	speed: 0.0033s/iter; left time: 8.8148s
	iters: 500, epoch: 3 | loss: 0.8174087
	speed: 0.0038s/iter; left time: 9.7611s
Updating learning rate to 0.0004229299843064237
Epoch: 3 cost time: 2.242116689682007
Epoch: 3, Steps: 514 | Train Loss: 0.6153741 Vali Loss: 0.3705351 Best vali loss: 0.3666721

best validation loss 0.36667212380173164

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.011623072433, 'e_layers': 2, 'learning_rate': 0.0006117524437, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 1.0066499
	speed: 0.0112s/iter; left time: 27.6809s
	iters: 200, epoch: 4 | loss: 0.3084323
	speed: 0.0032s/iter; left time: 7.6383s
	iters: 300, epoch: 4 | loss: 0.3557955
	speed: 0.0034s/iter; left time: 7.6187s
	iters: 400, epoch: 4 | loss: 0.2287666
	speed: 0.0041s/iter; left time: 8.8477s
	iters: 500, epoch: 4 | loss: 0.5623771
	speed: 0.0053s/iter; left time: 10.9563s
Updating learning rate to 0.00030587622185
Epoch: 4 cost time: 2.502403974533081
Epoch: 4, Steps: 514 | Train Loss: 0.4924043 Vali Loss: 0.3735675 Best vali loss: 0.3666721
	iters: 100, epoch: 5 | loss: 1.3504524
	speed: 0.0108s/iter; left time: 21.1441s
	iters: 200, epoch: 5 | loss: 0.2544770
	speed: 0.0047s/iter; left time: 8.7723s
	iters: 300, epoch: 5 | loss: 0.6949905
	speed: 0.0048s/iter; left time: 8.3476s
	iters: 400, epoch: 5 | loss: 0.7600729
	speed: 0.0048s/iter; left time: 7.9739s
	iters: 500, epoch: 5 | loss: 0.6540868
	speed: 0.0046s/iter; left time: 7.1750s
Updating learning rate to 0.00018882245939357635
Epoch: 5 cost time: 2.47904896736145
Epoch: 5, Steps: 514 | Train Loss: 0.7428159 Vali Loss: 0.3778949 Best vali loss: 0.3666721
	iters: 100, epoch: 6 | loss: 0.5182227
	speed: 0.0107s/iter; left time: 15.3723s
	iters: 200, epoch: 6 | loss: 0.5009063
	speed: 0.0045s/iter; left time: 6.0179s
	iters: 300, epoch: 6 | loss: 0.5119317
	speed: 0.0047s/iter; left time: 5.8630s
	iters: 400, epoch: 6 | loss: 0.5099661
	speed: 0.0047s/iter; left time: 5.4270s
	iters: 500, epoch: 6 | loss: 0.8032346
	speed: 0.0036s/iter; left time: 3.7617s
Updating learning rate to 8.958907117614421e-05
Epoch: 6 cost time: 2.349832057952881
Epoch: 6, Steps: 514 | Train Loss: 0.5688523 Vali Loss: 0.3760891 Best vali loss: 0.3666721
	iters: 100, epoch: 7 | loss: 0.3403918
	speed: 0.0080s/iter; left time: 7.4401s
	iters: 200, epoch: 7 | loss: 0.6299890
	speed: 0.0057s/iter; left time: 4.7043s
	iters: 300, epoch: 7 | loss: 1.3844966
	speed: 0.0060s/iter; left time: 4.4000s
	iters: 400, epoch: 7 | loss: 0.2986037
	speed: 0.0060s/iter; left time: 3.7941s
	iters: 500, epoch: 7 | loss: 0.9910743
	speed: 0.0058s/iter; left time: 3.0835s
Updating learning rate to 2.328344100090337e-05
Epoch: 7 cost time: 2.9107868671417236
Epoch: 7, Steps: 514 | Train Loss: 0.7289111 Vali Loss: 0.3823072 Best vali loss: 0.3666721
	iters: 100, epoch: 8 | loss: 0.4668399
	speed: 0.0119s/iter; left time: 4.9485s
	iters: 200, epoch: 8 | loss: 1.0151109
	speed: 0.0035s/iter; left time: 1.0972s
	iters: 300, epoch: 8 | loss: 0.4778798
	speed: 0.0036s/iter; left time: 0.7710s
	iters: 400, epoch: 8 | loss: 0.4669253
	speed: 0.0048s/iter; left time: 0.5487s
	iters: 500, epoch: 8 | loss: 0.7811459
	speed: 0.0053s/iter; left time: 0.0802s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.3496501445770264
Epoch: 8, Steps: 514 | Train Loss: 0.6415803 Vali Loss: 0.3751228 Best vali loss: 0.3666721

best validation loss 0.36667212380173164

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0023125439433, 'e_layers': 4, 'learning_rate': 0.000700110878, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006734644943363532
Validation loss decreased (inf --> 0.3669).  Saving model state dict ...
Epoch: 1 cost time: 0.9208791255950928
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3669169 Best vali loss: 0.3669169
Updating learning rate to 0.0005975820137081337
Validation loss decreased (0.3669 --> 0.3614).  Saving model state dict ...
Epoch: 2 cost time: 0.6592299938201904
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3614463 Best vali loss: 0.3614463
Updating learning rate to 0.0004840158559145883
Epoch: 3 cost time: 0.6604270935058594
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3665489 Best vali loss: 0.3614463
Updating learning rate to 0.000350055439
Epoch: 4 cost time: 0.6513869762420654
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3747068 Best vali loss: 0.3614463
Updating learning rate to 0.0002160950220854117
Validation loss decreased (0.3614 --> 0.3525).  Saving model state dict ...
Epoch: 5 cost time: 0.7184944152832031
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3524894 Best vali loss: 0.3524894
Updating learning rate to 0.00010252886429186618
Epoch: 6 cost time: 0.6500754356384277
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3557784 Best vali loss: 0.3524894
Updating learning rate to 2.6646383663646746e-05
Epoch: 7 cost time: 0.684002161026001
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3586022 Best vali loss: 0.3524894
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6513800621032715
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3538655 Best vali loss: 0.3524894

best validation loss 0.35248937508446293

{'batch_size': 8, 'd_core': 32, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0006023774524, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4483611
	speed: 0.0105s/iter; left time: 85.5376s
	iters: 200, epoch: 1 | loss: 0.3075066
	speed: 0.0048s/iter; left time: 38.6081s
	iters: 300, epoch: 1 | loss: 0.2333665
	speed: 0.0064s/iter; left time: 50.7646s
	iters: 400, epoch: 1 | loss: 1.1574903
	speed: 0.0065s/iter; left time: 50.9773s
	iters: 500, epoch: 1 | loss: 0.2455897
	speed: 0.0065s/iter; left time: 49.9817s
	iters: 600, epoch: 1 | loss: 0.6157740
	speed: 0.0064s/iter; left time: 48.9622s
	iters: 700, epoch: 1 | loss: 1.1975372
	speed: 0.0063s/iter; left time: 47.1829s
	iters: 800, epoch: 1 | loss: 0.5250953
	speed: 0.0057s/iter; left time: 42.4975s
	iters: 900, epoch: 1 | loss: 0.8515900
	speed: 0.0065s/iter; left time: 47.5272s
	iters: 1000, epoch: 1 | loss: 0.9864082
	speed: 0.0064s/iter; left time: 46.4463s
Updating learning rate to 0.000579450825759326
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 6.480283260345459
Epoch: 1, Steps: 1027 | Train Loss: 0.6568719 Vali Loss: 0.3708296 Best vali loss: 0.3708296
	iters: 100, epoch: 2 | loss: 0.7100091
	speed: 0.0181s/iter; left time: 128.5362s
	iters: 200, epoch: 2 | loss: 0.4996687
	speed: 0.0064s/iter; left time: 44.7432s
	iters: 300, epoch: 2 | loss: 0.9346297
	speed: 0.0068s/iter; left time: 46.5777s
	iters: 400, epoch: 2 | loss: 1.0053335
	speed: 0.0066s/iter; left time: 44.6082s
	iters: 500, epoch: 2 | loss: 0.4633304
	speed: 0.0067s/iter; left time: 44.6592s
	iters: 600, epoch: 2 | loss: 0.3447898
	speed: 0.0065s/iter; left time: 43.0655s
	iters: 700, epoch: 2 | loss: 0.2551934
	speed: 0.0061s/iter; left time: 39.4767s
	iters: 800, epoch: 2 | loss: 0.3418238
	speed: 0.0060s/iter; left time: 38.5718s
	iters: 900, epoch: 2 | loss: 0.2879581
	speed: 0.0067s/iter; left time: 41.8717s
	iters: 1000, epoch: 2 | loss: 1.2794007
	speed: 0.0064s/iter; left time: 39.6428s
Updating learning rate to 0.0005141613169129584
Validation loss decreased (0.3708 --> 0.3691).  Saving model state dict ...
Epoch: 2 cost time: 6.681750059127808
Epoch: 2, Steps: 1027 | Train Loss: 0.6122137 Vali Loss: 0.3691413 Best vali loss: 0.3691413
	iters: 100, epoch: 3 | loss: 0.7053914
	speed: 0.0180s/iter; left time: 109.3930s
	iters: 200, epoch: 3 | loss: 0.6453400
	speed: 0.0068s/iter; left time: 40.6200s
	iters: 300, epoch: 3 | loss: 0.2569985
	speed: 0.0069s/iter; left time: 40.2042s
	iters: 400, epoch: 3 | loss: 0.1963135
	speed: 0.0069s/iter; left time: 39.7284s
	iters: 500, epoch: 3 | loss: 1.1672274
	speed: 0.0070s/iter; left time: 39.8583s
	iters: 600, epoch: 3 | loss: 0.3859089
	speed: 0.0066s/iter; left time: 36.9486s
	iters: 700, epoch: 3 | loss: 0.1898936
	speed: 0.0069s/iter; left time: 37.5751s
	iters: 800, epoch: 3 | loss: 0.2490687
	speed: 0.0069s/iter; left time: 37.1023s
	iters: 900, epoch: 3 | loss: 0.2782202
	speed: 0.0069s/iter; left time: 36.5662s
	iters: 1000, epoch: 3 | loss: 1.8799696
	speed: 0.0070s/iter; left time: 35.9857s
Updating learning rate to 0.0004164486617318853
Epoch: 3 cost time: 7.006953716278076
Epoch: 3, Steps: 1027 | Train Loss: 0.5954332 Vali Loss: 0.3709889 Best vali loss: 0.3691413
	iters: 100, epoch: 4 | loss: 0.2653679
	speed: 0.0175s/iter; left time: 87.9835s
	iters: 200, epoch: 4 | loss: 0.8833382
	speed: 0.0068s/iter; left time: 33.7311s
	iters: 300, epoch: 4 | loss: 0.2823725
	speed: 0.0068s/iter; left time: 32.7883s
	iters: 400, epoch: 4 | loss: 0.2022163
	speed: 0.0067s/iter; left time: 31.6854s
	iters: 500, epoch: 4 | loss: 0.9222676
	speed: 0.0068s/iter; left time: 31.5195s
	iters: 600, epoch: 4 | loss: 0.8633955
	speed: 0.0058s/iter; left time: 26.3569s
	iters: 700, epoch: 4 | loss: 0.9117544
	speed: 0.0063s/iter; left time: 27.9375s
	iters: 800, epoch: 4 | loss: 0.5115418
	speed: 0.0067s/iter; left time: 29.1493s
	iters: 900, epoch: 4 | loss: 1.3023152
	speed: 0.0065s/iter; left time: 27.5468s
	iters: 1000, epoch: 4 | loss: 0.3551753
	speed: 0.0066s/iter; left time: 27.1268s
Updating learning rate to 0.0003011887262
Epoch: 4 cost time: 6.765247106552124
Epoch: 4, Steps: 1027 | Train Loss: 0.6499745 Vali Loss: 0.3891839 Best vali loss: 0.3691413
	iters: 100, epoch: 5 | loss: 0.7249858
	speed: 0.0157s/iter; left time: 62.7480s
	iters: 200, epoch: 5 | loss: 0.5188052
	speed: 0.0048s/iter; left time: 18.7562s
	iters: 300, epoch: 5 | loss: 0.2776428
	speed: 0.0060s/iter; left time: 22.8400s
	iters: 400, epoch: 5 | loss: 1.2504812
	speed: 0.0061s/iter; left time: 22.4805s
	iters: 500, epoch: 5 | loss: 0.6644547
	speed: 0.0064s/iter; left time: 23.2360s
	iters: 600, epoch: 5 | loss: 0.2507931
	speed: 0.0067s/iter; left time: 23.6727s
	iters: 700, epoch: 5 | loss: 0.5147463
	speed: 0.0058s/iter; left time: 19.7118s
	iters: 800, epoch: 5 | loss: 0.9440413
	speed: 0.0062s/iter; left time: 20.4866s
	iters: 900, epoch: 5 | loss: 0.3235897
	speed: 0.0064s/iter; left time: 20.4751s
	iters: 1000, epoch: 5 | loss: 0.8639753
	speed: 0.0064s/iter; left time: 20.0350s
Updating learning rate to 0.00018592879066811477
Epoch: 5 cost time: 6.151330947875977
Epoch: 5, Steps: 1027 | Train Loss: 0.6333516 Vali Loss: 0.3858773 Best vali loss: 0.3691413
	iters: 100, epoch: 6 | loss: 0.2005224
	speed: 0.0173s/iter; left time: 51.4669s
	iters: 200, epoch: 6 | loss: 0.6882281
	speed: 0.0060s/iter; left time: 17.2739s
	iters: 300, epoch: 6 | loss: 0.4451286
	speed: 0.0064s/iter; left time: 17.7496s
	iters: 400, epoch: 6 | loss: 0.5103654
	speed: 0.0062s/iter; left time: 16.7430s
	iters: 500, epoch: 6 | loss: 1.5034230
	speed: 0.0058s/iter; left time: 15.0782s
	iters: 600, epoch: 6 | loss: 0.3196806
	speed: 0.0049s/iter; left time: 12.0490s
	iters: 700, epoch: 6 | loss: 0.3919880
	speed: 0.0047s/iter; left time: 11.1066s
	iters: 800, epoch: 6 | loss: 1.1318458
	speed: 0.0052s/iter; left time: 11.9217s
	iters: 900, epoch: 6 | loss: 0.4211783
	speed: 0.0054s/iter; left time: 11.8346s
	iters: 1000, epoch: 6 | loss: 0.2799041
	speed: 0.0054s/iter; left time: 11.1945s
Updating learning rate to 8.821613548704165e-05
Epoch: 6 cost time: 5.794617652893066
Epoch: 6, Steps: 1027 | Train Loss: 0.5892264 Vali Loss: 0.3911281 Best vali loss: 0.3691413
	iters: 100, epoch: 7 | loss: 0.3312850
	speed: 0.0139s/iter; left time: 27.2303s
	iters: 200, epoch: 7 | loss: 0.5066473
	speed: 0.0060s/iter; left time: 11.1611s
	iters: 300, epoch: 7 | loss: 0.3833858
	speed: 0.0062s/iter; left time: 10.8076s
	iters: 400, epoch: 7 | loss: 0.4778909
	speed: 0.0058s/iter; left time: 9.6769s
	iters: 500, epoch: 7 | loss: 0.4448868
	speed: 0.0060s/iter; left time: 9.3242s
	iters: 600, epoch: 7 | loss: 0.5498406
	speed: 0.0056s/iter; left time: 8.2185s
	iters: 700, epoch: 7 | loss: 0.6549270
	speed: 0.0060s/iter; left time: 8.0906s
	iters: 800, epoch: 7 | loss: 0.2670985
	speed: 0.0057s/iter; left time: 7.1017s
	iters: 900, epoch: 7 | loss: 0.5558574
	speed: 0.0056s/iter; left time: 6.5219s
	iters: 1000, epoch: 7 | loss: 0.9534639
	speed: 0.0061s/iter; left time: 6.4194s
Updating learning rate to 2.292662664067406e-05
Epoch: 7 cost time: 6.0795886516571045
Epoch: 7, Steps: 1027 | Train Loss: 0.5125283 Vali Loss: 0.3856653 Best vali loss: 0.3691413
	iters: 100, epoch: 8 | loss: 0.2257746
	speed: 0.0164s/iter; left time: 15.2384s
	iters: 200, epoch: 8 | loss: 0.8248360
	speed: 0.0061s/iter; left time: 5.0787s
	iters: 300, epoch: 8 | loss: 1.1172978
	speed: 0.0061s/iter; left time: 4.4106s
	iters: 400, epoch: 8 | loss: 1.1714165
	speed: 0.0056s/iter; left time: 3.5219s
	iters: 500, epoch: 8 | loss: 0.1893579
	speed: 0.0062s/iter; left time: 3.2820s
	iters: 600, epoch: 8 | loss: 1.4415486
	speed: 0.0068s/iter; left time: 2.9001s
	iters: 700, epoch: 8 | loss: 0.3070007
	speed: 0.0068s/iter; left time: 2.2204s
	iters: 800, epoch: 8 | loss: 0.1675941
	speed: 0.0067s/iter; left time: 1.5229s
	iters: 900, epoch: 8 | loss: 0.5367726
	speed: 0.0070s/iter; left time: 0.8988s
	iters: 1000, epoch: 8 | loss: 0.4315056
	speed: 0.0059s/iter; left time: 0.1663s
Updating learning rate to 0.0
Epoch: 8 cost time: 6.517740249633789
Epoch: 8, Steps: 1027 | Train Loss: 0.6413104 Vali Loss: 0.3909029 Best vali loss: 0.3691413

best validation loss 0.3691413199386334

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012754803453, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6723455
	speed: 0.0122s/iter; left time: 23.8630s
	iters: 200, epoch: 1 | loss: 0.5566916
	speed: 0.0054s/iter; left time: 9.9924s
Updating learning rate to 0.0005919075723073192
Validation loss decreased (inf --> 0.3762).  Saving model state dict ...
Epoch: 1 cost time: 1.7380342483520508
Epoch: 1, Steps: 257 | Train Loss: 0.6145186 Vali Loss: 0.3761613 Best vali loss: 0.3761613
	iters: 100, epoch: 2 | loss: 0.3630114
	speed: 0.0112s/iter; left time: 18.9774s
	iters: 200, epoch: 2 | loss: 0.3401277
	speed: 0.0035s/iter; left time: 5.5534s
Updating learning rate to 0.0005252145019717149
Validation loss decreased (0.3762 --> 0.3741).  Saving model state dict ...
Epoch: 2 cost time: 1.0003948211669922
Epoch: 2, Steps: 257 | Train Loss: 0.3515696 Vali Loss: 0.3740982 Best vali loss: 0.3740982
	iters: 100, epoch: 3 | loss: 0.5572706
	speed: 0.0086s/iter; left time: 12.3468s
	iters: 200, epoch: 3 | loss: 0.4919002
	speed: 0.0040s/iter; left time: 5.3958s
Updating learning rate to 0.00042540126857759495
Validation loss decreased (0.3741 --> 0.3616).  Saving model state dict ...
Epoch: 3 cost time: 1.0937862396240234
Epoch: 3, Steps: 257 | Train Loss: 0.5245854 Vali Loss: 0.3615678 Best vali loss: 0.3615678

best validation loss 0.36156776605982677

{'batch_size': 128, 'd_core': 32, 'd_model': 512, 'dropout': 0.0018094463314, 'e_layers': 1, 'learning_rate': 0.003460388698, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00332868549530779
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 0.7575440406799316
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3710450 Best vali loss: 0.3710450
Updating learning rate to 0.002953626505948544
Epoch: 2 cost time: 0.49924707412719727
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3865095 Best vali loss: 0.3710450
Updating learning rate to 0.002392311061134002
Epoch: 3 cost time: 0.5196094512939453
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3845635 Best vali loss: 0.3710450

best validation loss 0.37104504533507265

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0076454676045, 'e_layers': 4, 'learning_rate': 6.3831307e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6427457
	speed: 0.0142s/iter; left time: 27.8506s
	iters: 200, epoch: 1 | loss: 0.9070988
	speed: 0.0078s/iter; left time: 14.5745s
Updating learning rate to 6.3831307e-05
Validation loss decreased (inf --> 0.4207).  Saving model state dict ...
Epoch: 1 cost time: 2.393332004547119
Epoch: 1, Steps: 257 | Train Loss: 0.7749222 Vali Loss: 0.4206501 Best vali loss: 0.4206501
	iters: 100, epoch: 2 | loss: 1.0865821
	speed: 0.0136s/iter; left time: 23.1525s
	iters: 200, epoch: 2 | loss: 0.8133145
	speed: 0.0069s/iter; left time: 11.0677s
Updating learning rate to 3.19156535e-05
Validation loss decreased (0.4207 --> 0.4026).  Saving model state dict ...
Epoch: 2 cost time: 1.6930255889892578
Epoch: 2, Steps: 257 | Train Loss: 0.9499483 Vali Loss: 0.4025735 Best vali loss: 0.4025735
	iters: 100, epoch: 3 | loss: 0.8717867
	speed: 0.0160s/iter; left time: 23.0744s
	iters: 200, epoch: 3 | loss: 0.7995121
	speed: 0.0074s/iter; left time: 9.9973s
Updating learning rate to 1.595782675e-05
Validation loss decreased (0.4026 --> 0.3972).  Saving model state dict ...
Epoch: 3 cost time: 2.0242302417755127
Epoch: 3, Steps: 257 | Train Loss: 0.8356494 Vali Loss: 0.3972107 Best vali loss: 0.3972107

best validation loss 0.3972107263234369

{'batch_size': 32, 'd_core': 512, 'd_model': 128, 'dropout': 0.0012754803453, 'e_layers': 2, 'learning_rate': 0.0006153270642, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5679261
	speed: 0.0129s/iter; left time: 15.2416s
	iters: 200, epoch: 4 | loss: 0.3892291
	speed: 0.0059s/iter; left time: 6.3973s
Updating learning rate to 0.0003076635321
Validation loss decreased (0.3616 --> 0.3605).  Saving model state dict ...
Epoch: 4 cost time: 1.9289922714233398
Epoch: 4, Steps: 257 | Train Loss: 0.4785776 Vali Loss: 0.3605287 Best vali loss: 0.3605287
	iters: 100, epoch: 5 | loss: 0.3273150
	speed: 0.0098s/iter; left time: 9.0628s
	iters: 200, epoch: 5 | loss: 0.3158821
	speed: 0.0044s/iter; left time: 3.6436s
Updating learning rate to 0.00018992579562240503
Epoch: 5 cost time: 1.1865696907043457
Epoch: 5, Steps: 257 | Train Loss: 0.3215986 Vali Loss: 0.3656754 Best vali loss: 0.3605287
	iters: 100, epoch: 6 | loss: 0.5069562
	speed: 0.0125s/iter; left time: 8.4336s
	iters: 200, epoch: 6 | loss: 0.4084772
	speed: 0.0059s/iter; left time: 3.3933s
Updating learning rate to 9.011256222828497e-05
Validation loss decreased (0.3605 --> 0.3571).  Saving model state dict ...
Epoch: 6 cost time: 1.4851889610290527
Epoch: 6, Steps: 257 | Train Loss: 0.4577167 Vali Loss: 0.3571174 Best vali loss: 0.3571174
	iters: 100, epoch: 7 | loss: 0.2839579
	speed: 0.0124s/iter; left time: 5.1305s
	iters: 200, epoch: 7 | loss: 0.8868657
	speed: 0.0053s/iter; left time: 1.6837s
Updating learning rate to 2.3419491892680736e-05
Epoch: 7 cost time: 1.3683483600616455
Epoch: 7, Steps: 257 | Train Loss: 0.5854118 Vali Loss: 0.3636393 Best vali loss: 0.3571174
	iters: 100, epoch: 8 | loss: 0.4597173
	speed: 0.0082s/iter; left time: 1.2982s
	iters: 200, epoch: 8 | loss: 0.3491485
	speed: 0.0054s/iter; left time: 0.3130s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.3023366928100586
Epoch: 8, Steps: 257 | Train Loss: 0.4044329 Vali Loss: 0.3635821 Best vali loss: 0.3571174

best validation loss 0.357117370432627

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0016784352926, 'e_layers': 3, 'learning_rate': 0.0010192948397, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6247616
	speed: 0.0132s/iter; left time: 12.2723s
Updating learning rate to 0.0010192948397
Validation loss decreased (inf --> 0.3708).  Saving model state dict ...
Epoch: 1 cost time: 1.2138378620147705
Epoch: 1, Steps: 129 | Train Loss: 0.6247616 Vali Loss: 0.3707608 Best vali loss: 0.3707608
	iters: 100, epoch: 2 | loss: 0.5928679
	speed: 0.0112s/iter; left time: 9.0109s
Updating learning rate to 0.00050964741985
Epoch: 2 cost time: 0.911583662033081
Epoch: 2, Steps: 129 | Train Loss: 0.5928679 Vali Loss: 0.3712650 Best vali loss: 0.3707608
	iters: 100, epoch: 3 | loss: 0.5748728
	speed: 0.0114s/iter; left time: 7.6864s
Updating learning rate to 0.000254823709925
Validation loss decreased (0.3708 --> 0.3691).  Saving model state dict ...
Epoch: 3 cost time: 0.9155197143554688
Epoch: 3, Steps: 129 | Train Loss: 0.5748728 Vali Loss: 0.3690804 Best vali loss: 0.3690804
	iters: 100, epoch: 4 | loss: 0.7635795
	speed: 0.0114s/iter; left time: 6.2207s
Updating learning rate to 0.0001274118549625
Epoch: 4 cost time: 0.9313473701477051
Epoch: 4, Steps: 129 | Train Loss: 0.7635795 Vali Loss: 0.3720634 Best vali loss: 0.3690804
	iters: 100, epoch: 5 | loss: 0.4924710
	speed: 0.0119s/iter; left time: 4.9796s
Updating learning rate to 6.370592748125e-05
Epoch: 5 cost time: 0.9363627433776855
Epoch: 5, Steps: 129 | Train Loss: 0.4924710 Vali Loss: 0.3724533 Best vali loss: 0.3690804
	iters: 100, epoch: 6 | loss: 0.4595379
	speed: 0.0113s/iter; left time: 3.2436s
Updating learning rate to 3.1852963740625e-05
Epoch: 6 cost time: 0.9206879138946533
Epoch: 6, Steps: 129 | Train Loss: 0.4595379 Vali Loss: 0.3709317 Best vali loss: 0.3690804
	iters: 100, epoch: 7 | loss: 0.4471444
	speed: 0.0115s/iter; left time: 1.8281s
Updating learning rate to 1.59264818703125e-05
Epoch: 7 cost time: 0.935185432434082
Epoch: 7, Steps: 129 | Train Loss: 0.4471444 Vali Loss: 0.3718075 Best vali loss: 0.3690804
	iters: 100, epoch: 8 | loss: 0.4713160
	speed: 0.0111s/iter; left time: 0.3321s
Updating learning rate to 7.96324093515625e-06
Epoch: 8 cost time: 0.9004507064819336
Epoch: 8, Steps: 129 | Train Loss: 0.4713160 Vali Loss: 0.3713204 Best vali loss: 0.3690804

best validation loss 0.3690804043429774

{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0012223560033, 'e_layers': 4, 'learning_rate': 0.0005598184136, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4724718
	speed: 0.0128s/iter; left time: 51.3255s
	iters: 200, epoch: 1 | loss: 0.5278112
	speed: 0.0073s/iter; left time: 28.4069s
	iters: 300, epoch: 1 | loss: 1.1511542
	speed: 0.0068s/iter; left time: 25.8624s
	iters: 400, epoch: 1 | loss: 0.4764198
	speed: 0.0067s/iter; left time: 24.8153s
	iters: 500, epoch: 1 | loss: 0.7167636
	speed: 0.0072s/iter; left time: 25.9630s
Updating learning rate to 0.0005598184136
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 3.900561571121216
Epoch: 1, Steps: 514 | Train Loss: 0.6689241 Vali Loss: 0.3729095 Best vali loss: 0.3729095
	iters: 100, epoch: 2 | loss: 0.9185210
	speed: 0.0143s/iter; left time: 49.9934s
	iters: 200, epoch: 2 | loss: 0.3921851
	speed: 0.0075s/iter; left time: 25.4802s
	iters: 300, epoch: 2 | loss: 1.0973051
	speed: 0.0073s/iter; left time: 24.1559s
	iters: 400, epoch: 2 | loss: 0.3960540
	speed: 0.0073s/iter; left time: 23.1948s
	iters: 500, epoch: 2 | loss: 0.3569542
	speed: 0.0072s/iter; left time: 22.2111s
Updating learning rate to 0.0002799092068
Validation loss decreased (0.3729 --> 0.3718).  Saving model state dict ...
Epoch: 2 cost time: 3.813203811645508
Epoch: 2, Steps: 514 | Train Loss: 0.6322039 Vali Loss: 0.3717700 Best vali loss: 0.3717700
	iters: 100, epoch: 3 | loss: 0.8113422
	speed: 0.0142s/iter; left time: 42.2434s
	iters: 200, epoch: 3 | loss: 0.7235104
	speed: 0.0076s/iter; left time: 21.8408s
	iters: 300, epoch: 3 | loss: 0.5172257
	speed: 0.0062s/iter; left time: 17.2646s
	iters: 400, epoch: 3 | loss: 0.8791332
	speed: 0.0050s/iter; left time: 13.3003s
	iters: 500, epoch: 3 | loss: 0.5856101
	speed: 0.0082s/iter; left time: 21.0690s
Updating learning rate to 0.0001399546034
Validation loss decreased (0.3718 --> 0.3618).  Saving model state dict ...
Epoch: 3 cost time: 3.590266227722168
Epoch: 3, Steps: 514 | Train Loss: 0.7033643 Vali Loss: 0.3617839 Best vali loss: 0.3617839
	iters: 100, epoch: 4 | loss: 0.2848323
	speed: 0.0185s/iter; left time: 45.7050s
	iters: 200, epoch: 4 | loss: 0.9339585
	speed: 0.0078s/iter; left time: 18.4134s
	iters: 300, epoch: 4 | loss: 0.4382132
	speed: 0.0096s/iter; left time: 21.7389s
	iters: 400, epoch: 4 | loss: 0.6758990
	speed: 0.0059s/iter; left time: 12.7508s
	iters: 500, epoch: 4 | loss: 0.4051009
	speed: 0.0052s/iter; left time: 10.7378s
Updating learning rate to 6.99773017e-05
Validation loss decreased (0.3618 --> 0.3546).  Saving model state dict ...
Epoch: 4 cost time: 3.9443395137786865
Epoch: 4, Steps: 514 | Train Loss: 0.5476008 Vali Loss: 0.3546097 Best vali loss: 0.3546097
	iters: 100, epoch: 5 | loss: 1.0969948
	speed: 0.0176s/iter; left time: 34.5337s
	iters: 200, epoch: 5 | loss: 0.6513710
	speed: 0.0095s/iter; left time: 17.7216s
	iters: 300, epoch: 5 | loss: 0.4236905
	speed: 0.0084s/iter; left time: 14.8291s
	iters: 400, epoch: 5 | loss: 0.6314926
	speed: 0.0091s/iter; left time: 15.0039s
	iters: 500, epoch: 5 | loss: 0.6708874
	speed: 0.0092s/iter; left time: 14.3240s
Updating learning rate to 3.498865085e-05
Validation loss decreased (0.3546 --> 0.3525).  Saving model state dict ...
Epoch: 5 cost time: 4.590081453323364
Epoch: 5, Steps: 514 | Train Loss: 0.6948872 Vali Loss: 0.3524770 Best vali loss: 0.3524770
	iters: 100, epoch: 6 | loss: 0.3635614
	speed: 0.0178s/iter; left time: 25.7275s
	iters: 200, epoch: 6 | loss: 0.4826847
	speed: 0.0061s/iter; left time: 8.1514s
	iters: 300, epoch: 6 | loss: 0.3250704
	speed: 0.0048s/iter; left time: 6.0107s
	iters: 400, epoch: 6 | loss: 0.3985862
	speed: 0.0061s/iter; left time: 6.9214s
	iters: 500, epoch: 6 | loss: 0.7416911
	speed: 0.0066s/iter; left time: 6.9334s
Updating learning rate to 1.7494325425e-05
Validation loss decreased (0.3525 --> 0.3511).  Saving model state dict ...
Epoch: 6 cost time: 3.4817726612091064
Epoch: 6, Steps: 514 | Train Loss: 0.4623188 Vali Loss: 0.3511467 Best vali loss: 0.3511467
	iters: 100, epoch: 7 | loss: 0.5172809
	speed: 0.0141s/iter; left time: 13.1157s
	iters: 200, epoch: 7 | loss: 0.7968183
	speed: 0.0067s/iter; left time: 5.5686s
	iters: 300, epoch: 7 | loss: 0.2306105
	speed: 0.0067s/iter; left time: 4.8548s
	iters: 400, epoch: 7 | loss: 0.5180218
	speed: 0.0065s/iter; left time: 4.1036s
	iters: 500, epoch: 7 | loss: 0.2522800
	speed: 0.0066s/iter; left time: 3.4802s
Updating learning rate to 8.7471627125e-06
Validation loss decreased (0.3511 --> 0.3503).  Saving model state dict ...
Epoch: 7 cost time: 3.486962080001831
Epoch: 7, Steps: 514 | Train Loss: 0.4630023 Vali Loss: 0.3503467 Best vali loss: 0.3503467
	iters: 100, epoch: 8 | loss: 0.6006118
	speed: 0.0140s/iter; left time: 5.8254s
	iters: 200, epoch: 8 | loss: 0.2709363
	speed: 0.0069s/iter; left time: 2.1747s
	iters: 300, epoch: 8 | loss: 0.4769149
	speed: 0.0066s/iter; left time: 1.4187s
	iters: 400, epoch: 8 | loss: 0.5305489
	speed: 0.0065s/iter; left time: 0.7475s
	iters: 500, epoch: 8 | loss: 0.4681670
	speed: 0.0065s/iter; left time: 0.0978s
Updating learning rate to 4.37358135625e-06
Epoch: 8 cost time: 3.4816672801971436
Epoch: 8, Steps: 514 | Train Loss: 0.4694358 Vali Loss: 0.3516098 Best vali loss: 0.3503467

best validation loss 0.3503467220893543

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0091231059117, 'e_layers': 3, 'learning_rate': 0.0015501326551, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4562277
	speed: 0.0122s/iter; left time: 49.0510s
	iters: 200, epoch: 1 | loss: 0.7769172
	speed: 0.0059s/iter; left time: 23.0350s
	iters: 300, epoch: 1 | loss: 0.4610006
	speed: 0.0058s/iter; left time: 22.3036s
	iters: 400, epoch: 1 | loss: 0.7520927
	speed: 0.0059s/iter; left time: 21.8534s
	iters: 500, epoch: 1 | loss: 0.4718403
	speed: 0.0058s/iter; left time: 21.0605s
Updating learning rate to 0.0015501326551
Validation loss decreased (inf --> 0.3969).  Saving model state dict ...
Epoch: 1 cost time: 3.329235553741455
Epoch: 1, Steps: 514 | Train Loss: 0.5836157 Vali Loss: 0.3968851 Best vali loss: 0.3968851
	iters: 100, epoch: 2 | loss: 0.6863324
	speed: 0.0127s/iter; left time: 44.3894s
	iters: 200, epoch: 2 | loss: 0.5594429
	speed: 0.0060s/iter; left time: 20.3653s
	iters: 300, epoch: 2 | loss: 0.5920080
	speed: 0.0058s/iter; left time: 19.2755s
	iters: 400, epoch: 2 | loss: 0.6946295
	speed: 0.0060s/iter; left time: 19.2060s
	iters: 500, epoch: 2 | loss: 0.9564925
	speed: 0.0059s/iter; left time: 18.3734s
Updating learning rate to 0.00077506632755
Epoch: 2 cost time: 3.115840196609497
Epoch: 2, Steps: 514 | Train Loss: 0.6977811 Vali Loss: 0.4048712 Best vali loss: 0.3968851
	iters: 100, epoch: 3 | loss: 0.3880008
	speed: 0.0126s/iter; left time: 37.7285s
	iters: 200, epoch: 3 | loss: 0.5837325
	speed: 0.0058s/iter; left time: 16.7348s
	iters: 300, epoch: 3 | loss: 0.9378027
	speed: 0.0059s/iter; left time: 16.3309s
	iters: 400, epoch: 3 | loss: 0.6224504
	speed: 0.0057s/iter; left time: 15.2479s
	iters: 500, epoch: 3 | loss: 1.2315011
	speed: 0.0060s/iter; left time: 15.6386s
Updating learning rate to 0.000387533163775
Epoch: 3 cost time: 3.087662935256958
Epoch: 3, Steps: 514 | Train Loss: 0.7526975 Vali Loss: 0.4045753 Best vali loss: 0.3968851

best validation loss 0.39688510397094173

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0045557689701, 'e_layers': 1, 'learning_rate': 0.0003266375974, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003142056940932609
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 0.7325165271759033
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3721583 Best vali loss: 0.3721583
Updating learning rate to 0.00027880262875601067
Validation loss decreased (0.3722 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 0.41762256622314453
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3672851 Best vali loss: 0.3672851
Updating learning rate to 0.00022581819715625914
Epoch: 3 cost time: 0.44486379623413086
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3741308 Best vali loss: 0.3672851

best validation loss 0.36728512511272093

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0039792071051, 'e_layers': 2, 'learning_rate': 0.0015124708174, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2983256
	speed: 0.0096s/iter; left time: 77.9664s
	iters: 200, epoch: 1 | loss: 0.5947251
	speed: 0.0038s/iter; left time: 30.3285s
	iters: 300, epoch: 1 | loss: 0.3732696
	speed: 0.0040s/iter; left time: 32.0187s
	iters: 400, epoch: 1 | loss: 0.4753724
	speed: 0.0040s/iter; left time: 31.5617s
	iters: 500, epoch: 1 | loss: 0.2587610
	speed: 0.0042s/iter; left time: 32.0977s
	iters: 600, epoch: 1 | loss: 1.1380568
	speed: 0.0042s/iter; left time: 31.7309s
	iters: 700, epoch: 1 | loss: 0.4455495
	speed: 0.0041s/iter; left time: 31.0763s
	iters: 800, epoch: 1 | loss: 0.9799438
	speed: 0.0041s/iter; left time: 30.7193s
	iters: 900, epoch: 1 | loss: 0.3881285
	speed: 0.0042s/iter; left time: 30.5677s
	iters: 1000, epoch: 1 | loss: 0.5219153
	speed: 0.0043s/iter; left time: 30.9376s
Updating learning rate to 0.0015124708174
Validation loss decreased (inf --> 0.3743).  Saving model state dict ...
Epoch: 1 cost time: 4.483552932739258
Epoch: 1, Steps: 1027 | Train Loss: 0.5474047 Vali Loss: 0.3742830 Best vali loss: 0.3742830
	iters: 100, epoch: 2 | loss: 0.9312469
	speed: 0.0133s/iter; left time: 94.2201s
	iters: 200, epoch: 2 | loss: 0.9826722
	speed: 0.0043s/iter; left time: 29.9660s
	iters: 300, epoch: 2 | loss: 0.9004712
	speed: 0.0042s/iter; left time: 28.5937s
	iters: 400, epoch: 2 | loss: 0.4992088
	speed: 0.0042s/iter; left time: 28.8132s
	iters: 500, epoch: 2 | loss: 1.5592698
	speed: 0.0042s/iter; left time: 27.9888s
	iters: 600, epoch: 2 | loss: 0.2545000
	speed: 0.0041s/iter; left time: 27.3105s
	iters: 700, epoch: 2 | loss: 0.7979609
	speed: 0.0042s/iter; left time: 27.4485s
	iters: 800, epoch: 2 | loss: 0.3562153
	speed: 0.0044s/iter; left time: 27.9001s
	iters: 900, epoch: 2 | loss: 1.1584275
	speed: 0.0045s/iter; left time: 28.0047s
	iters: 1000, epoch: 2 | loss: 1.4957925
	speed: 0.0045s/iter; left time: 27.5741s
Updating learning rate to 0.0007562354087
Epoch: 2 cost time: 4.469208240509033
Epoch: 2, Steps: 1027 | Train Loss: 0.8935765 Vali Loss: 0.3786739 Best vali loss: 0.3742830
	iters: 100, epoch: 3 | loss: 1.0188429
	speed: 0.0135s/iter; left time: 81.9609s
	iters: 200, epoch: 3 | loss: 0.4415013
	speed: 0.0041s/iter; left time: 24.4615s
	iters: 300, epoch: 3 | loss: 0.4072920
	speed: 0.0041s/iter; left time: 24.2421s
	iters: 400, epoch: 3 | loss: 1.0373815
	speed: 0.0041s/iter; left time: 23.4488s
	iters: 500, epoch: 3 | loss: 0.3019640
	speed: 0.0042s/iter; left time: 24.0315s
	iters: 600, epoch: 3 | loss: 0.2603996
	speed: 0.0042s/iter; left time: 23.4982s
	iters: 700, epoch: 3 | loss: 0.2551492
	speed: 0.0042s/iter; left time: 22.9382s
	iters: 800, epoch: 3 | loss: 0.3432948
	speed: 0.0046s/iter; left time: 24.9109s
	iters: 900, epoch: 3 | loss: 0.2322776
	speed: 0.0043s/iter; left time: 22.5740s
	iters: 1000, epoch: 3 | loss: 1.0056466
	speed: 0.0043s/iter; left time: 22.2344s
Updating learning rate to 0.00037811770435
Validation loss decreased (0.3743 --> 0.3680).  Saving model state dict ...
Epoch: 3 cost time: 4.4231038093566895
Epoch: 3, Steps: 1027 | Train Loss: 0.5303750 Vali Loss: 0.3680496 Best vali loss: 0.3680496

best validation loss 0.36804960788116003

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0045557689701, 'e_layers': 1, 'learning_rate': 0.0003266375974, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001633187987
Epoch: 4 cost time: 0.6690316200256348
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3697968 Best vali loss: 0.3672851
Updating learning rate to 0.00010081940024374084
Epoch: 5 cost time: 0.5332341194152832
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3712325 Best vali loss: 0.3672851
Updating learning rate to 4.78349686439893e-05
Epoch: 6 cost time: 0.43190598487854004
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3747156 Best vali loss: 0.3672851
Updating learning rate to 1.2431903306739055e-05
Epoch: 7 cost time: 0.40860962867736816
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3724081 Best vali loss: 0.3672851
Updating learning rate to 0.0
Epoch: 8 cost time: 0.45176053047180176
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3727717 Best vali loss: 0.3672851

best validation loss 0.36728512511272093

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0069930416726, 'e_layers': 4, 'learning_rate': 0.0011677024226, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0011232593954519925
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 0.7930231094360352
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3665982 Best vali loss: 0.3665982
Updating learning rate to 0.0009966963620142097
Epoch: 2 cost time: 0.5523374080657959
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3721837 Best vali loss: 0.3665982
Updating learning rate to 0.0008072813968307993
Epoch: 3 cost time: 0.6534512042999268
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3693865 Best vali loss: 0.3665982
Updating learning rate to 0.0005838512113
Epoch: 4 cost time: 0.5270369052886963
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3751417 Best vali loss: 0.3665982
Updating learning rate to 0.0003604210257692007
Epoch: 5 cost time: 0.49257493019104004
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3811111 Best vali loss: 0.3665982
Updating learning rate to 0.0001710060605857902
Epoch: 6 cost time: 0.6125400066375732
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3858057 Best vali loss: 0.3665982
Updating learning rate to 4.44430271480075e-05
Epoch: 7 cost time: 0.6379320621490479
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3730465 Best vali loss: 0.3665982
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6284430027008057
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3759427 Best vali loss: 0.3665982

best validation loss 0.3665981802818583

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0008573937177, 'e_layers': 4, 'learning_rate': 0.0004318882795, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0004318882795
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 0.9031169414520264
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3652755 Best vali loss: 0.3652755
Updating learning rate to 0.00021594413975
Epoch: 2 cost time: 0.6192460060119629
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3665901 Best vali loss: 0.3652755
Updating learning rate to 0.000107972069875
Epoch: 3 cost time: 0.6110773086547852
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3685567 Best vali loss: 0.3652755
Updating learning rate to 5.39860349375e-05
Epoch: 4 cost time: 0.6360299587249756
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3669209 Best vali loss: 0.3652755
Updating learning rate to 2.699301746875e-05
Epoch: 5 cost time: 0.6235198974609375
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3656297 Best vali loss: 0.3652755
Updating learning rate to 1.3496508734375e-05
Epoch: 6 cost time: 0.6376242637634277
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3659776 Best vali loss: 0.3652755
Updating learning rate to 6.7482543671875e-06
Epoch: 7 cost time: 0.5989491939544678
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3656471 Best vali loss: 0.3652755
Updating learning rate to 3.37412718359375e-06
Validation loss decreased (0.3653 --> 0.3653).  Saving model state dict ...
Epoch: 8 cost time: 0.6425495147705078
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3652557 Best vali loss: 0.3652557

best validation loss 0.3652557171281054

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0012223560033, 'e_layers': 4, 'learning_rate': 0.0005594578486, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6225805
	speed: 0.0114s/iter; left time: 10.6109s
Updating learning rate to 0.0005381647521121691
Validation loss decreased (inf --> 0.3765).  Saving model state dict ...
Epoch: 1 cost time: 0.9936113357543945
Epoch: 1, Steps: 129 | Train Loss: 0.6225805 Vali Loss: 0.3764773 Best vali loss: 0.3764773
	iters: 100, epoch: 2 | loss: 0.6567152
	speed: 0.0101s/iter; left time: 8.0996s
Updating learning rate to 0.0004775271435665484
Validation loss decreased (0.3765 --> 0.3695).  Saving model state dict ...
Epoch: 2 cost time: 0.8964202404022217
Epoch: 2, Steps: 129 | Train Loss: 0.6567152 Vali Loss: 0.3695354 Best vali loss: 0.3695354
	iters: 100, epoch: 3 | loss: 0.4297753
	speed: 0.0132s/iter; left time: 8.9345s
Updating learning rate to 0.0003867765491829184
Validation loss decreased (0.3695 --> 0.3661).  Saving model state dict ...
Epoch: 3 cost time: 1.0471618175506592
Epoch: 3, Steps: 129 | Train Loss: 0.4297753 Vali Loss: 0.3660518 Best vali loss: 0.3660518

best validation loss 0.36605176993578026

{'batch_size': 8, 'd_core': 256, 'd_model': 64, 'dropout': 0.0013903803528, 'e_layers': 4, 'learning_rate': 0.0004476854138, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4849914
	speed: 0.0106s/iter; left time: 86.0544s
	iters: 200, epoch: 1 | loss: 0.4646395
	speed: 0.0060s/iter; left time: 47.8777s
	iters: 300, epoch: 1 | loss: 0.4816886
	speed: 0.0063s/iter; left time: 49.6023s
	iters: 400, epoch: 1 | loss: 0.3234693
	speed: 0.0063s/iter; left time: 48.8637s
	iters: 500, epoch: 1 | loss: 0.4623200
	speed: 0.0063s/iter; left time: 48.5667s
	iters: 600, epoch: 1 | loss: 0.3041995
	speed: 0.0062s/iter; left time: 47.5988s
	iters: 700, epoch: 1 | loss: 0.3385251
	speed: 0.0056s/iter; left time: 42.3979s
	iters: 800, epoch: 1 | loss: 0.3418863
	speed: 0.0063s/iter; left time: 46.4388s
	iters: 900, epoch: 1 | loss: 1.3621186
	speed: 0.0063s/iter; left time: 46.0216s
	iters: 1000, epoch: 1 | loss: 1.0640086
	speed: 0.0063s/iter; left time: 45.4724s
Updating learning rate to 0.00043064640230683294
Validation loss decreased (inf --> 0.3700).  Saving model state dict ...
Epoch: 1 cost time: 6.513107538223267
Epoch: 1, Steps: 1027 | Train Loss: 0.5627847 Vali Loss: 0.3699517 Best vali loss: 0.3699517
	iters: 100, epoch: 2 | loss: 0.6856422
	speed: 0.0168s/iter; left time: 118.8187s
	iters: 200, epoch: 2 | loss: 1.0125713
	speed: 0.0064s/iter; left time: 44.8022s
	iters: 300, epoch: 2 | loss: 0.3310122
	speed: 0.0063s/iter; left time: 43.3215s
	iters: 400, epoch: 2 | loss: 0.2003427
	speed: 0.0063s/iter; left time: 42.5500s
	iters: 500, epoch: 2 | loss: 0.8745703
	speed: 0.0065s/iter; left time: 43.7959s
	iters: 600, epoch: 2 | loss: 0.4137592
	speed: 0.0065s/iter; left time: 42.5307s
	iters: 700, epoch: 2 | loss: 1.2786322
	speed: 0.0055s/iter; left time: 35.9174s
	iters: 800, epoch: 2 | loss: 0.3576914
	speed: 0.0048s/iter; left time: 30.7613s
	iters: 900, epoch: 2 | loss: 0.4023243
	speed: 0.0057s/iter; left time: 35.8437s
	iters: 1000, epoch: 2 | loss: 0.6636738
	speed: 0.0061s/iter; left time: 37.7469s
Updating learning rate to 0.00038212340286814276
Validation loss decreased (0.3700 --> 0.3688).  Saving model state dict ...
Epoch: 2 cost time: 6.17724084854126
Epoch: 2, Steps: 1027 | Train Loss: 0.6220220 Vali Loss: 0.3688104 Best vali loss: 0.3688104
	iters: 100, epoch: 3 | loss: 0.9212759
	speed: 0.0179s/iter; left time: 108.6874s
	iters: 200, epoch: 3 | loss: 0.4796001
	speed: 0.0070s/iter; left time: 41.5624s
	iters: 300, epoch: 3 | loss: 0.4624567
	speed: 0.0069s/iter; left time: 40.5093s
	iters: 400, epoch: 3 | loss: 1.0107206
	speed: 0.0068s/iter; left time: 39.2653s
	iters: 500, epoch: 3 | loss: 1.1121042
	speed: 0.0064s/iter; left time: 36.4058s
	iters: 600, epoch: 3 | loss: 0.2411419
	speed: 0.0065s/iter; left time: 36.2320s
	iters: 700, epoch: 3 | loss: 0.4239883
	speed: 0.0068s/iter; left time: 36.8817s
	iters: 800, epoch: 3 | loss: 0.3540021
	speed: 0.0068s/iter; left time: 36.5210s
	iters: 900, epoch: 3 | loss: 0.8812804
	speed: 0.0069s/iter; left time: 36.1664s
	iters: 1000, epoch: 3 | loss: 0.9125298
	speed: 0.0067s/iter; left time: 34.7107s
Updating learning rate to 0.00030950360228638475
Epoch: 3 cost time: 6.996424436569214
Epoch: 3, Steps: 1027 | Train Loss: 0.6799100 Vali Loss: 0.3710169 Best vali loss: 0.3688104

best validation loss 0.3688104296538591

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022649231903, 'e_layers': 4, 'learning_rate': 0.0003541777998, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6253012
	speed: 0.0148s/iter; left time: 13.7621s
Updating learning rate to 0.0003541777998
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 1.4458279609680176
Epoch: 1, Steps: 129 | Train Loss: 0.6253012 Vali Loss: 0.3655185 Best vali loss: 0.3655185
	iters: 100, epoch: 2 | loss: 0.7195422
	speed: 0.0142s/iter; left time: 11.4216s
Updating learning rate to 0.0001770888999
Epoch: 2 cost time: 1.171644687652588
Epoch: 2, Steps: 129 | Train Loss: 0.7195422 Vali Loss: 0.3954529 Best vali loss: 0.3655185
	iters: 100, epoch: 3 | loss: 0.6216391
	speed: 0.0139s/iter; left time: 9.3601s
Updating learning rate to 8.854444995e-05
Epoch: 3 cost time: 1.1484994888305664
Epoch: 3, Steps: 129 | Train Loss: 0.6216391 Vali Loss: 0.3664307 Best vali loss: 0.3655185

best validation loss 0.3655185346870385

{'batch_size': 64, 'd_core': 64, 'd_model': 256, 'dropout': 0.0022649231903, 'e_layers': 4, 'learning_rate': 0.0003541777998, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5491191
	speed: 0.0154s/iter; left time: 8.3993s
Updating learning rate to 4.4272224975e-05
Validation loss decreased (0.3655 --> 0.3653).  Saving model state dict ...
Epoch: 4 cost time: 1.4688773155212402
Epoch: 4, Steps: 129 | Train Loss: 0.5491191 Vali Loss: 0.3653117 Best vali loss: 0.3653117
	iters: 100, epoch: 5 | loss: 0.6108788
	speed: 0.0142s/iter; left time: 5.9225s
Updating learning rate to 2.21361124875e-05
Epoch: 5 cost time: 1.152583122253418
Epoch: 5, Steps: 129 | Train Loss: 0.6108788 Vali Loss: 0.3720427 Best vali loss: 0.3653117
	iters: 100, epoch: 6 | loss: 0.5815017
	speed: 0.0126s/iter; left time: 3.6177s
Updating learning rate to 1.106805624375e-05
Epoch: 6 cost time: 0.9320180416107178
Epoch: 6, Steps: 129 | Train Loss: 0.5815017 Vali Loss: 0.3655727 Best vali loss: 0.3653117
	iters: 100, epoch: 7 | loss: 0.6028581
	speed: 0.0123s/iter; left time: 1.9531s
Updating learning rate to 5.534028121875e-06
Epoch: 7 cost time: 1.0922608375549316
Epoch: 7, Steps: 129 | Train Loss: 0.6028581 Vali Loss: 0.3653268 Best vali loss: 0.3653117
	iters: 100, epoch: 8 | loss: 0.3833864
	speed: 0.0135s/iter; left time: 0.4056s
Updating learning rate to 2.7670140609375e-06
Epoch: 8 cost time: 1.1263659000396729
Epoch: 8, Steps: 129 | Train Loss: 0.3833864 Vali Loss: 0.3670273 Best vali loss: 0.3653117

best validation loss 0.365311692412101

{'batch_size': 8, 'd_core': 128, 'd_model': 64, 'dropout': 0.0077420980639, 'e_layers': 3, 'learning_rate': 0.0044530631044, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9143168
	speed: 0.0108s/iter; left time: 87.6695s
	iters: 200, epoch: 1 | loss: 0.5244231
	speed: 0.0047s/iter; left time: 37.6109s
	iters: 300, epoch: 1 | loss: 0.7534439
	speed: 0.0041s/iter; left time: 32.7272s
	iters: 400, epoch: 1 | loss: 1.1037856
	speed: 0.0043s/iter; left time: 33.8741s
	iters: 500, epoch: 1 | loss: 0.7621841
	speed: 0.0055s/iter; left time: 42.2177s
	iters: 600, epoch: 1 | loss: 0.3736610
	speed: 0.0056s/iter; left time: 42.9456s
	iters: 700, epoch: 1 | loss: 0.3056772
	speed: 0.0051s/iter; left time: 38.5623s
	iters: 800, epoch: 1 | loss: 2.0332799
	speed: 0.0051s/iter; left time: 38.1798s
	iters: 900, epoch: 1 | loss: 0.2526587
	speed: 0.0049s/iter; left time: 36.2106s
	iters: 1000, epoch: 1 | loss: 0.4197643
	speed: 0.0055s/iter; left time: 39.8435s
Updating learning rate to 0.004283578481768166
Validation loss decreased (inf --> 0.4133).  Saving model state dict ...
Epoch: 1 cost time: 5.381921291351318
Epoch: 1, Steps: 1027 | Train Loss: 0.7443195 Vali Loss: 0.4133124 Best vali loss: 0.4133124
	iters: 100, epoch: 2 | loss: 0.3684962
	speed: 0.0168s/iter; left time: 119.3593s
	iters: 200, epoch: 2 | loss: 0.3251454
	speed: 0.0051s/iter; left time: 35.4218s
	iters: 300, epoch: 2 | loss: 0.2517273
	speed: 0.0040s/iter; left time: 27.8329s
	iters: 400, epoch: 2 | loss: 0.5643978
	speed: 0.0042s/iter; left time: 28.7167s
	iters: 500, epoch: 2 | loss: 1.8275973
	speed: 0.0051s/iter; left time: 34.3398s
	iters: 600, epoch: 2 | loss: 0.8720639
	speed: 0.0052s/iter; left time: 34.2744s
	iters: 700, epoch: 2 | loss: 0.3060896
	speed: 0.0052s/iter; left time: 33.5307s
	iters: 800, epoch: 2 | loss: 0.5674320
	speed: 0.0052s/iter; left time: 33.5399s
	iters: 900, epoch: 2 | loss: 0.4707630
	speed: 0.0052s/iter; left time: 32.6783s
	iters: 1000, epoch: 2 | loss: 2.0933874
	speed: 0.0052s/iter; left time: 32.3106s
Updating learning rate to 0.0038009271112864292
Validation loss decreased (0.4133 --> 0.4009).  Saving model state dict ...
Epoch: 2 cost time: 5.143157243728638
Epoch: 2, Steps: 1027 | Train Loss: 0.7647100 Vali Loss: 0.4008547 Best vali loss: 0.4008547
	iters: 100, epoch: 3 | loss: 0.3300655
	speed: 0.0145s/iter; left time: 87.8285s
	iters: 200, epoch: 3 | loss: 1.0439467
	speed: 0.0050s/iter; left time: 29.8595s
	iters: 300, epoch: 3 | loss: 0.2642059
	speed: 0.0049s/iter; left time: 28.7200s
	iters: 400, epoch: 3 | loss: 1.1792440
	speed: 0.0049s/iter; left time: 28.5190s
	iters: 500, epoch: 3 | loss: 0.3254979
	speed: 0.0050s/iter; left time: 28.0940s
	iters: 600, epoch: 3 | loss: 1.2889675
	speed: 0.0051s/iter; left time: 28.2891s
	iters: 700, epoch: 3 | loss: 0.3788869
	speed: 0.0051s/iter; left time: 28.0538s
	iters: 800, epoch: 3 | loss: 0.7197728
	speed: 0.0050s/iter; left time: 26.8882s
	iters: 900, epoch: 3 | loss: 0.6021563
	speed: 0.0048s/iter; left time: 25.4034s
	iters: 1000, epoch: 3 | loss: 0.5019946
	speed: 0.0048s/iter; left time: 24.7599s
Updating learning rate to 0.0030785882888650674
Epoch: 3 cost time: 5.168037176132202
Epoch: 3, Steps: 1027 | Train Loss: 0.6634738 Vali Loss: 0.4020143 Best vali loss: 0.4008547
	iters: 100, epoch: 4 | loss: 0.9145271
	speed: 0.0152s/iter; left time: 76.3541s
	iters: 200, epoch: 4 | loss: 1.1757854
	speed: 0.0050s/iter; left time: 24.7472s
	iters: 300, epoch: 4 | loss: 0.3749598
	speed: 0.0050s/iter; left time: 23.9755s
	iters: 400, epoch: 4 | loss: 0.3167559
	speed: 0.0049s/iter; left time: 23.1242s
	iters: 500, epoch: 4 | loss: 0.3669427
	speed: 0.0048s/iter; left time: 22.3287s
	iters: 600, epoch: 4 | loss: 0.3139724
	speed: 0.0047s/iter; left time: 21.4882s
	iters: 700, epoch: 4 | loss: 1.1116976
	speed: 0.0047s/iter; left time: 20.7045s
	iters: 800, epoch: 4 | loss: 0.3183472
	speed: 0.0049s/iter; left time: 21.4157s
	iters: 900, epoch: 4 | loss: 0.6129720
	speed: 0.0048s/iter; left time: 20.2592s
	iters: 1000, epoch: 4 | loss: 0.9540057
	speed: 0.0049s/iter; left time: 20.2653s
Updating learning rate to 0.0022265315522
Epoch: 4 cost time: 5.0795063972473145
Epoch: 4, Steps: 1027 | Train Loss: 0.6459966 Vali Loss: 0.4023871 Best vali loss: 0.4008547
	iters: 100, epoch: 5 | loss: 0.4339085
	speed: 0.0151s/iter; left time: 60.4351s
	iters: 200, epoch: 5 | loss: 1.4022760
	speed: 0.0050s/iter; left time: 19.6311s
	iters: 300, epoch: 5 | loss: 0.2740574
	speed: 0.0048s/iter; left time: 18.4664s
	iters: 400, epoch: 5 | loss: 0.7646927
	speed: 0.0049s/iter; left time: 18.2545s
	iters: 500, epoch: 5 | loss: 0.2363587
	speed: 0.0050s/iter; left time: 18.1454s
	iters: 600, epoch: 5 | loss: 0.4456590
	speed: 0.0052s/iter; left time: 18.1737s
	iters: 700, epoch: 5 | loss: 0.6177937
	speed: 0.0050s/iter; left time: 16.9458s
	iters: 800, epoch: 5 | loss: 0.9831892
	speed: 0.0050s/iter; left time: 16.4725s
	iters: 900, epoch: 5 | loss: 0.5443314
	speed: 0.0050s/iter; left time: 15.9078s
	iters: 1000, epoch: 5 | loss: 1.5321320
	speed: 0.0050s/iter; left time: 15.4593s
Updating learning rate to 0.001374474815534933
Epoch: 5 cost time: 5.167881488800049
Epoch: 5, Steps: 1027 | Train Loss: 0.7234399 Vali Loss: 0.4040559 Best vali loss: 0.4008547
	iters: 100, epoch: 6 | loss: 1.6622492
	speed: 0.0146s/iter; left time: 43.4195s
	iters: 200, epoch: 6 | loss: 0.2229906
	speed: 0.0047s/iter; left time: 13.6603s
	iters: 300, epoch: 6 | loss: 0.3972815
	speed: 0.0048s/iter; left time: 13.2877s
	iters: 400, epoch: 6 | loss: 1.1808939
	speed: 0.0048s/iter; left time: 12.9669s
	iters: 500, epoch: 6 | loss: 1.0202388
	speed: 0.0048s/iter; left time: 12.3508s
	iters: 600, epoch: 6 | loss: 0.3224289
	speed: 0.0048s/iter; left time: 11.9391s
	iters: 700, epoch: 6 | loss: 0.9626589
	speed: 0.0050s/iter; left time: 11.8159s
	iters: 800, epoch: 6 | loss: 1.1283531
	speed: 0.0050s/iter; left time: 11.3944s
	iters: 900, epoch: 6 | loss: 1.3317654
	speed: 0.0050s/iter; left time: 10.9407s
	iters: 1000, epoch: 6 | loss: 0.8835563
	speed: 0.0047s/iter; left time: 9.7474s
Updating learning rate to 0.0006521359931135707
Epoch: 6 cost time: 5.018584489822388
Epoch: 6, Steps: 1027 | Train Loss: 0.9112417 Vali Loss: 0.4024504 Best vali loss: 0.4008547
	iters: 100, epoch: 7 | loss: 0.2381369
	speed: 0.0147s/iter; left time: 28.8079s
	iters: 200, epoch: 7 | loss: 0.4156625
	speed: 0.0047s/iter; left time: 8.7301s
	iters: 300, epoch: 7 | loss: 0.6471251
	speed: 0.0046s/iter; left time: 8.1541s
	iters: 400, epoch: 7 | loss: 0.2593375
	speed: 0.0046s/iter; left time: 7.6896s
	iters: 500, epoch: 7 | loss: 0.4136044
	speed: 0.0048s/iter; left time: 7.5376s
	iters: 600, epoch: 7 | loss: 0.4555155
	speed: 0.0050s/iter; left time: 7.2712s
	iters: 700, epoch: 7 | loss: 1.0518911
	speed: 0.0050s/iter; left time: 6.7322s
	iters: 800, epoch: 7 | loss: 0.3714113
	speed: 0.0048s/iter; left time: 6.0780s
	iters: 900, epoch: 7 | loss: 0.3817268
	speed: 0.0048s/iter; left time: 5.5350s
	iters: 1000, epoch: 7 | loss: 1.6240613
	speed: 0.0049s/iter; left time: 5.1434s
Updating learning rate to 0.00016948462263183437
Epoch: 7 cost time: 5.048727512359619
Epoch: 7, Steps: 1027 | Train Loss: 0.5858472 Vali Loss: 0.4027655 Best vali loss: 0.4008547
	iters: 100, epoch: 8 | loss: 0.4407520
	speed: 0.0149s/iter; left time: 13.8096s
	iters: 200, epoch: 8 | loss: 1.8347948
	speed: 0.0051s/iter; left time: 4.2275s
	iters: 300, epoch: 8 | loss: 1.0516835
	speed: 0.0049s/iter; left time: 3.5423s
	iters: 400, epoch: 8 | loss: 0.4044235
	speed: 0.0050s/iter; left time: 3.1495s
	iters: 500, epoch: 8 | loss: 0.5095173
	speed: 0.0049s/iter; left time: 2.5726s
	iters: 600, epoch: 8 | loss: 0.5466312
	speed: 0.0044s/iter; left time: 1.8662s
	iters: 700, epoch: 8 | loss: 0.3620699
	speed: 0.0040s/iter; left time: 1.2990s
	iters: 800, epoch: 8 | loss: 0.3672642
	speed: 0.0049s/iter; left time: 1.1246s
	iters: 900, epoch: 8 | loss: 0.9813780
	speed: 0.0054s/iter; left time: 0.6931s
	iters: 1000, epoch: 8 | loss: 0.4427728
	speed: 0.0054s/iter; left time: 0.1522s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.101511240005493
Epoch: 8, Steps: 1027 | Train Loss: 0.6941287 Vali Loss: 0.4031076 Best vali loss: 0.4008547

best validation loss 0.4008547195048604

{'batch_size': 64, 'd_core': 512, 'd_model': 128, 'dropout': 0.0033649866997, 'e_layers': 4, 'learning_rate': 0.0007140511833, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5687875
	speed: 0.0136s/iter; left time: 12.6931s
Updating learning rate to 0.0007140511833
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 1.307744026184082
Epoch: 1, Steps: 129 | Train Loss: 0.5687875 Vali Loss: 0.3696939 Best vali loss: 0.3696939
	iters: 100, epoch: 2 | loss: 0.4671884
	speed: 0.0125s/iter; left time: 10.0370s
Updating learning rate to 0.00035702559165
Validation loss decreased (0.3697 --> 0.3630).  Saving model state dict ...
Epoch: 2 cost time: 1.0398316383361816
Epoch: 2, Steps: 129 | Train Loss: 0.4671884 Vali Loss: 0.3629822 Best vali loss: 0.3629822
	iters: 100, epoch: 3 | loss: 0.7143908
	speed: 0.0128s/iter; left time: 8.6105s
Updating learning rate to 0.000178512795825
Validation loss decreased (0.3630 --> 0.3574).  Saving model state dict ...
Epoch: 3 cost time: 1.1053478717803955
Epoch: 3, Steps: 129 | Train Loss: 0.7143908 Vali Loss: 0.3574249 Best vali loss: 0.3574249
	iters: 100, epoch: 4 | loss: 0.8320780
	speed: 0.0136s/iter; left time: 7.4361s
Updating learning rate to 8.92563979125e-05
Epoch: 4 cost time: 1.0284342765808105
Epoch: 4, Steps: 129 | Train Loss: 0.8320780 Vali Loss: 0.3584329 Best vali loss: 0.3574249
	iters: 100, epoch: 5 | loss: 0.6181701
	speed: 0.0124s/iter; left time: 5.1886s
Updating learning rate to 4.462819895625e-05
Epoch: 5 cost time: 1.03312087059021
Epoch: 5, Steps: 129 | Train Loss: 0.6181701 Vali Loss: 0.3584130 Best vali loss: 0.3574249
	iters: 100, epoch: 6 | loss: 0.7162017
	speed: 0.0123s/iter; left time: 3.5351s
Updating learning rate to 2.2314099478125e-05
Epoch: 6 cost time: 1.011359453201294
Epoch: 6, Steps: 129 | Train Loss: 0.7162017 Vali Loss: 0.3586764 Best vali loss: 0.3574249
	iters: 100, epoch: 7 | loss: 0.3819922
	speed: 0.0124s/iter; left time: 1.9648s
Updating learning rate to 1.11570497390625e-05
Epoch: 7 cost time: 1.0341897010803223
Epoch: 7, Steps: 129 | Train Loss: 0.3819922 Vali Loss: 0.3582038 Best vali loss: 0.3574249
	iters: 100, epoch: 8 | loss: 0.3108411
	speed: 0.0126s/iter; left time: 0.3770s
Updating learning rate to 5.57852486953125e-06
Epoch: 8 cost time: 1.0601942539215088
Epoch: 8, Steps: 129 | Train Loss: 0.3108411 Vali Loss: 0.3590117 Best vali loss: 0.3574249

best validation loss 0.3574249305636101

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0008582998373, 'e_layers': 1, 'learning_rate': 0.0002750366042, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7862156
	speed: 0.0100s/iter; left time: 9.3011s
Updating learning rate to 0.0002645686467558939
Validation loss decreased (inf --> 0.3679).  Saving model state dict ...
Epoch: 1 cost time: 0.847367525100708
Epoch: 1, Steps: 129 | Train Loss: 0.7862156 Vali Loss: 0.3679345 Best vali loss: 0.3679345
	iters: 100, epoch: 2 | loss: 0.5486414
	speed: 0.0084s/iter; left time: 6.7603s
Updating learning rate to 0.00023475842605217025
Validation loss decreased (0.3679 --> 0.3638).  Saving model state dict ...
Epoch: 2 cost time: 0.6480398178100586
Epoch: 2, Steps: 129 | Train Loss: 0.5486414 Vali Loss: 0.3637923 Best vali loss: 0.3637923
	iters: 100, epoch: 3 | loss: 0.6296898
	speed: 0.0081s/iter; left time: 5.4344s
Updating learning rate to 0.00019014427796064737
Validation loss decreased (0.3638 --> 0.3633).  Saving model state dict ...
Epoch: 3 cost time: 0.590468168258667
Epoch: 3, Steps: 129 | Train Loss: 0.6296898 Vali Loss: 0.3633470 Best vali loss: 0.3633470

best validation loss 0.36334704923020833

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.006740282698, 'e_layers': 4, 'learning_rate': 0.0001043113492, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3751724
	speed: 0.0127s/iter; left time: 50.9791s
	iters: 200, epoch: 1 | loss: 1.0501188
	speed: 0.0071s/iter; left time: 27.6206s
	iters: 300, epoch: 1 | loss: 0.7068094
	speed: 0.0071s/iter; left time: 26.8990s
	iters: 400, epoch: 1 | loss: 0.4520458
	speed: 0.0068s/iter; left time: 25.3562s
	iters: 500, epoch: 1 | loss: 0.3374870
	speed: 0.0072s/iter; left time: 26.0583s
Updating learning rate to 0.0001043113492
Validation loss decreased (inf --> 0.3677).  Saving model state dict ...
Epoch: 1 cost time: 3.8803162574768066
Epoch: 1, Steps: 514 | Train Loss: 0.5843267 Vali Loss: 0.3676602 Best vali loss: 0.3676602
	iters: 100, epoch: 2 | loss: 0.3710797
	speed: 0.0109s/iter; left time: 38.0887s
	iters: 200, epoch: 2 | loss: 0.8685408
	speed: 0.0073s/iter; left time: 24.6829s
	iters: 300, epoch: 2 | loss: 0.3928654
	speed: 0.0072s/iter; left time: 23.8298s
	iters: 400, epoch: 2 | loss: 0.3523754
	speed: 0.0069s/iter; left time: 22.0796s
	iters: 500, epoch: 2 | loss: 0.3307877
	speed: 0.0072s/iter; left time: 22.3901s
Updating learning rate to 5.21556746e-05
Validation loss decreased (0.3677 --> 0.3638).  Saving model state dict ...
Epoch: 2 cost time: 3.6048591136932373
Epoch: 2, Steps: 514 | Train Loss: 0.4631298 Vali Loss: 0.3638492 Best vali loss: 0.3638492
	iters: 100, epoch: 3 | loss: 0.4847451
	speed: 0.0142s/iter; left time: 42.4572s
	iters: 200, epoch: 3 | loss: 0.4067162
	speed: 0.0069s/iter; left time: 19.8940s
	iters: 300, epoch: 3 | loss: 0.5868502
	speed: 0.0071s/iter; left time: 19.8879s
	iters: 400, epoch: 3 | loss: 0.4006146
	speed: 0.0074s/iter; left time: 19.7968s
	iters: 500, epoch: 3 | loss: 0.2717525
	speed: 0.0073s/iter; left time: 18.8353s
Updating learning rate to 2.60778373e-05
Validation loss decreased (0.3638 --> 0.3612).  Saving model state dict ...
Epoch: 3 cost time: 3.729457139968872
Epoch: 3, Steps: 514 | Train Loss: 0.4301357 Vali Loss: 0.3611677 Best vali loss: 0.3611677

best validation loss 0.361167731828446

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0020155805449, 'e_layers': 3, 'learning_rate': 0.0005770289561, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4569941
	speed: 0.0110s/iter; left time: 89.6802s
	iters: 200, epoch: 1 | loss: 0.5438181
	speed: 0.0052s/iter; left time: 41.6782s
	iters: 300, epoch: 1 | loss: 0.6403689
	speed: 0.0055s/iter; left time: 43.6136s
	iters: 400, epoch: 1 | loss: 0.6525941
	speed: 0.0053s/iter; left time: 41.7963s
	iters: 500, epoch: 1 | loss: 1.0302500
	speed: 0.0048s/iter; left time: 37.3431s
	iters: 600, epoch: 1 | loss: 1.0324075
	speed: 0.0041s/iter; left time: 30.9734s
	iters: 700, epoch: 1 | loss: 0.9638437
	speed: 0.0048s/iter; left time: 36.3450s
	iters: 800, epoch: 1 | loss: 0.8866948
	speed: 0.0057s/iter; left time: 42.2372s
	iters: 900, epoch: 1 | loss: 1.1405060
	speed: 0.0058s/iter; left time: 42.3946s
	iters: 1000, epoch: 1 | loss: 0.4877156
	speed: 0.0054s/iter; left time: 38.6352s
Updating learning rate to 0.0005770289561
Validation loss decreased (inf --> 0.3777).  Saving model state dict ...
Epoch: 1 cost time: 5.635930299758911
Epoch: 1, Steps: 1027 | Train Loss: 0.7835193 Vali Loss: 0.3777129 Best vali loss: 0.3777129
	iters: 100, epoch: 2 | loss: 0.3415927
	speed: 0.0149s/iter; left time: 105.7869s
	iters: 200, epoch: 2 | loss: 0.4438297
	speed: 0.0045s/iter; left time: 31.3242s
	iters: 300, epoch: 2 | loss: 0.6835159
	speed: 0.0052s/iter; left time: 35.7808s
	iters: 400, epoch: 2 | loss: 0.5754350
	speed: 0.0052s/iter; left time: 35.5648s
	iters: 500, epoch: 2 | loss: 1.3545541
	speed: 0.0050s/iter; left time: 33.7462s
	iters: 600, epoch: 2 | loss: 0.3576362
	speed: 0.0041s/iter; left time: 26.8043s
	iters: 700, epoch: 2 | loss: 0.4859899
	speed: 0.0039s/iter; left time: 25.5302s
	iters: 800, epoch: 2 | loss: 1.5577409
	speed: 0.0046s/iter; left time: 29.6071s
	iters: 900, epoch: 2 | loss: 0.3883517
	speed: 0.0052s/iter; left time: 32.5489s
	iters: 1000, epoch: 2 | loss: 0.5170414
	speed: 0.0052s/iter; left time: 32.0376s
Updating learning rate to 0.00028851447805
Validation loss decreased (0.3777 --> 0.3777).  Saving model state dict ...
Epoch: 2 cost time: 5.004654169082642
Epoch: 2, Steps: 1027 | Train Loss: 0.6705687 Vali Loss: 0.3776695 Best vali loss: 0.3776695
	iters: 100, epoch: 3 | loss: 0.6749912
	speed: 0.0143s/iter; left time: 87.0010s
	iters: 200, epoch: 3 | loss: 0.3962592
	speed: 0.0052s/iter; left time: 30.9382s
	iters: 300, epoch: 3 | loss: 0.6488522
	speed: 0.0049s/iter; left time: 28.6352s
	iters: 400, epoch: 3 | loss: 0.4912999
	speed: 0.0049s/iter; left time: 28.0423s
	iters: 500, epoch: 3 | loss: 0.4212799
	speed: 0.0051s/iter; left time: 28.6854s
	iters: 600, epoch: 3 | loss: 0.8366650
	speed: 0.0051s/iter; left time: 28.1004s
	iters: 700, epoch: 3 | loss: 1.1531101
	speed: 0.0045s/iter; left time: 24.4540s
	iters: 800, epoch: 3 | loss: 1.4732596
	speed: 0.0052s/iter; left time: 28.0951s
	iters: 900, epoch: 3 | loss: 0.5852477
	speed: 0.0052s/iter; left time: 27.6219s
	iters: 1000, epoch: 3 | loss: 0.4789103
	speed: 0.0051s/iter; left time: 26.5770s
Updating learning rate to 0.000144257239025
Epoch: 3 cost time: 5.1961259841918945
Epoch: 3, Steps: 1027 | Train Loss: 0.7159875 Vali Loss: 0.3873352 Best vali loss: 0.3776695

best validation loss 0.3776694827674648

{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.006740282698, 'e_layers': 4, 'learning_rate': 0.0001043113492, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.3466302
	speed: 0.0122s/iter; left time: 30.1556s
	iters: 200, epoch: 4 | loss: 0.9009404
	speed: 0.0050s/iter; left time: 11.8661s
	iters: 300, epoch: 4 | loss: 0.7001296
	speed: 0.0050s/iter; left time: 11.3987s
	iters: 400, epoch: 4 | loss: 0.4195793
	speed: 0.0049s/iter; left time: 10.7096s
	iters: 500, epoch: 4 | loss: 0.3386004
	speed: 0.0061s/iter; left time: 12.5948s
Updating learning rate to 1.303891865e-05
Validation loss decreased (0.3612 --> 0.3600).  Saving model state dict ...
Epoch: 4 cost time: 3.1163747310638428
Epoch: 4, Steps: 514 | Train Loss: 0.5411760 Vali Loss: 0.3599883 Best vali loss: 0.3599883
	iters: 100, epoch: 5 | loss: 0.3737785
	speed: 0.0142s/iter; left time: 27.7480s
	iters: 200, epoch: 5 | loss: 0.8160011
	speed: 0.0065s/iter; left time: 12.1451s
	iters: 300, epoch: 5 | loss: 0.3994958
	speed: 0.0066s/iter; left time: 11.6567s
	iters: 400, epoch: 5 | loss: 0.3305388
	speed: 0.0065s/iter; left time: 10.8135s
	iters: 500, epoch: 5 | loss: 0.3295744
	speed: 0.0066s/iter; left time: 10.3157s
Updating learning rate to 6.519459325e-06
Epoch: 5 cost time: 3.4585092067718506
Epoch: 5, Steps: 514 | Train Loss: 0.4498777 Vali Loss: 0.3601675 Best vali loss: 0.3599883
	iters: 100, epoch: 6 | loss: 0.4739828
	speed: 0.0139s/iter; left time: 20.0506s
	iters: 200, epoch: 6 | loss: 0.3957751
	speed: 0.0068s/iter; left time: 9.1581s
	iters: 300, epoch: 6 | loss: 0.5644191
	speed: 0.0069s/iter; left time: 8.5335s
	iters: 400, epoch: 6 | loss: 0.3981585
	speed: 0.0066s/iter; left time: 7.4894s
	iters: 500, epoch: 6 | loss: 0.2715465
	speed: 0.0068s/iter; left time: 7.0741s
Updating learning rate to 3.2597296625e-06
Epoch: 6 cost time: 3.5238442420959473
Epoch: 6, Steps: 514 | Train Loss: 0.4207764 Vali Loss: 0.3600213 Best vali loss: 0.3599883
	iters: 100, epoch: 7 | loss: 0.8037853
	speed: 0.0135s/iter; left time: 12.5767s
	iters: 200, epoch: 7 | loss: 0.7873744
	speed: 0.0069s/iter; left time: 5.7041s
	iters: 300, epoch: 7 | loss: 0.4467540
	speed: 0.0068s/iter; left time: 4.9844s
	iters: 400, epoch: 7 | loss: 0.9144673
	speed: 0.0068s/iter; left time: 4.2517s
	iters: 500, epoch: 7 | loss: 0.4177920
	speed: 0.0066s/iter; left time: 3.4917s
Updating learning rate to 1.62986483125e-06
Epoch: 7 cost time: 3.5236399173736572
Epoch: 7, Steps: 514 | Train Loss: 0.6740346 Vali Loss: 0.3602853 Best vali loss: 0.3599883
	iters: 100, epoch: 8 | loss: 0.7440692
	speed: 0.0133s/iter; left time: 5.5004s
	iters: 200, epoch: 8 | loss: 1.2316830
	speed: 0.0068s/iter; left time: 2.1295s
	iters: 300, epoch: 8 | loss: 0.2745615
	speed: 0.0069s/iter; left time: 1.4869s
	iters: 400, epoch: 8 | loss: 1.0036268
	speed: 0.0066s/iter; left time: 0.7542s
	iters: 500, epoch: 8 | loss: 1.0432163
	speed: 0.0051s/iter; left time: 0.0761s
Updating learning rate to 8.14932415625e-07
Epoch: 8 cost time: 3.285492181777954
Epoch: 8, Steps: 514 | Train Loss: 0.8594314 Vali Loss: 0.3603239 Best vali loss: 0.3599883

best validation loss 0.3599882554797152

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0016263438524, 'e_layers': 1, 'learning_rate': 0.0001009597245, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7193958
	speed: 0.0115s/iter; left time: 10.7023s
Updating learning rate to 0.0001009597245
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 1.0239887237548828
Epoch: 1, Steps: 129 | Train Loss: 0.7193958 Vali Loss: 0.3686003 Best vali loss: 0.3686003
	iters: 100, epoch: 2 | loss: 0.4792738
	speed: 0.0091s/iter; left time: 7.2807s
Updating learning rate to 5.047986225e-05
Validation loss decreased (0.3686 --> 0.3633).  Saving model state dict ...
Epoch: 2 cost time: 0.6969850063323975
Epoch: 2, Steps: 129 | Train Loss: 0.4792738 Vali Loss: 0.3632609 Best vali loss: 0.3632609
	iters: 100, epoch: 3 | loss: 0.5124235
	speed: 0.0097s/iter; left time: 6.5723s
Updating learning rate to 2.5239931125e-05
Epoch: 3 cost time: 0.7410905361175537
Epoch: 3, Steps: 129 | Train Loss: 0.5124235 Vali Loss: 0.3679870 Best vali loss: 0.3632609
	iters: 100, epoch: 4 | loss: 0.6502181
	speed: 0.0095s/iter; left time: 5.1871s
Updating learning rate to 1.26199655625e-05
Epoch: 4 cost time: 0.7551229000091553
Epoch: 4, Steps: 129 | Train Loss: 0.6502181 Vali Loss: 0.3638709 Best vali loss: 0.3632609
	iters: 100, epoch: 5 | loss: 0.7441788
	speed: 0.0092s/iter; left time: 3.8401s
Updating learning rate to 6.30998278125e-06
Epoch: 5 cost time: 0.7226319313049316
Epoch: 5, Steps: 129 | Train Loss: 0.7441788 Vali Loss: 0.3651385 Best vali loss: 0.3632609
	iters: 100, epoch: 6 | loss: 0.4026857
	speed: 0.0095s/iter; left time: 2.7277s
Updating learning rate to 3.154991390625e-06
Epoch: 6 cost time: 0.7059228420257568
Epoch: 6, Steps: 129 | Train Loss: 0.4026857 Vali Loss: 0.3651881 Best vali loss: 0.3632609
	iters: 100, epoch: 7 | loss: 0.5802026
	speed: 0.0094s/iter; left time: 1.5005s
Updating learning rate to 1.5774956953125e-06
Epoch: 7 cost time: 0.6947364807128906
Epoch: 7, Steps: 129 | Train Loss: 0.5802026 Vali Loss: 0.3652595 Best vali loss: 0.3632609
	iters: 100, epoch: 8 | loss: 0.6790308
	speed: 0.0103s/iter; left time: 0.3088s
Updating learning rate to 7.8874784765625e-07
Epoch: 8 cost time: 0.8033945560455322
Epoch: 8, Steps: 129 | Train Loss: 0.6790308 Vali Loss: 0.3653037 Best vali loss: 0.3632609

best validation loss 0.363260870984589

{'batch_size': 8, 'd_core': 32, 'd_model': 128, 'dropout': 0.0061170225804, 'e_layers': 2, 'learning_rate': 0.0005675671244, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3027090
	speed: 0.0092s/iter; left time: 75.0399s
	iters: 200, epoch: 1 | loss: 1.0773531
	speed: 0.0030s/iter; left time: 24.0248s
	iters: 300, epoch: 1 | loss: 0.2419509
	speed: 0.0029s/iter; left time: 22.9530s
	iters: 400, epoch: 1 | loss: 0.3153768
	speed: 0.0039s/iter; left time: 30.7800s
	iters: 500, epoch: 1 | loss: 0.9679896
	speed: 0.0055s/iter; left time: 42.4473s
	iters: 600, epoch: 1 | loss: 0.3983804
	speed: 0.0040s/iter; left time: 30.7035s
	iters: 700, epoch: 1 | loss: 0.2970278
	speed: 0.0054s/iter; left time: 40.5675s
	iters: 800, epoch: 1 | loss: 1.1474453
	speed: 0.0041s/iter; left time: 30.3741s
	iters: 900, epoch: 1 | loss: 1.0093654
	speed: 0.0052s/iter; left time: 38.3518s
	iters: 1000, epoch: 1 | loss: 1.1210840
	speed: 0.0032s/iter; left time: 22.8217s
Updating learning rate to 0.0005675671244
Validation loss decreased (inf --> 0.3670).  Saving model state dict ...
Epoch: 1 cost time: 4.454976797103882
Epoch: 1, Steps: 1027 | Train Loss: 0.6878682 Vali Loss: 0.3669745 Best vali loss: 0.3669745
	iters: 100, epoch: 2 | loss: 0.7351528
	speed: 0.0104s/iter; left time: 73.8738s
	iters: 200, epoch: 2 | loss: 0.2824717
	speed: 0.0040s/iter; left time: 27.6718s
	iters: 300, epoch: 2 | loss: 0.3460155
	speed: 0.0046s/iter; left time: 31.4345s
	iters: 400, epoch: 2 | loss: 0.4166644
	speed: 0.0036s/iter; left time: 24.2899s
	iters: 500, epoch: 2 | loss: 0.7480175
	speed: 0.0046s/iter; left time: 30.5110s
	iters: 600, epoch: 2 | loss: 0.2483791
	speed: 0.0033s/iter; left time: 21.9351s
	iters: 700, epoch: 2 | loss: 0.3072269
	speed: 0.0031s/iter; left time: 19.8202s
	iters: 800, epoch: 2 | loss: 0.6395370
	speed: 0.0032s/iter; left time: 20.1757s
	iters: 900, epoch: 2 | loss: 0.8127804
	speed: 0.0037s/iter; left time: 23.4434s
	iters: 1000, epoch: 2 | loss: 0.4807743
	speed: 0.0034s/iter; left time: 21.1119s
Updating learning rate to 0.0002837835622
Epoch: 2 cost time: 3.9129233360290527
Epoch: 2, Steps: 1027 | Train Loss: 0.5017020 Vali Loss: 0.3690327 Best vali loss: 0.3669745
	iters: 100, epoch: 3 | loss: 0.2095433
	speed: 0.0113s/iter; left time: 68.7920s
	iters: 200, epoch: 3 | loss: 1.0281439
	speed: 0.0030s/iter; left time: 18.0128s
	iters: 300, epoch: 3 | loss: 0.3870960
	speed: 0.0029s/iter; left time: 16.8102s
	iters: 400, epoch: 3 | loss: 0.3420813
	speed: 0.0032s/iter; left time: 18.4518s
	iters: 500, epoch: 3 | loss: 0.5305373
	speed: 0.0055s/iter; left time: 30.9844s
	iters: 600, epoch: 3 | loss: 1.8796220
	speed: 0.0046s/iter; left time: 25.4119s
	iters: 700, epoch: 3 | loss: 0.2432278
	speed: 0.0054s/iter; left time: 29.7123s
	iters: 800, epoch: 3 | loss: 0.3709286
	speed: 0.0042s/iter; left time: 22.3236s
	iters: 900, epoch: 3 | loss: 0.7759058
	speed: 0.0055s/iter; left time: 29.0979s
	iters: 1000, epoch: 3 | loss: 0.9801818
	speed: 0.0041s/iter; left time: 21.0084s
Updating learning rate to 0.0001418917811
Epoch: 3 cost time: 4.410480260848999
Epoch: 3, Steps: 1027 | Train Loss: 0.6747268 Vali Loss: 0.3696248 Best vali loss: 0.3669745
	iters: 100, epoch: 4 | loss: 0.2246210
	speed: 0.0149s/iter; left time: 75.1322s
	iters: 200, epoch: 4 | loss: 0.4048481
	speed: 0.0040s/iter; left time: 19.9275s
	iters: 300, epoch: 4 | loss: 0.3947776
	speed: 0.0032s/iter; left time: 15.4643s
	iters: 400, epoch: 4 | loss: 0.5456095
	speed: 0.0032s/iter; left time: 15.2003s
	iters: 500, epoch: 4 | loss: 0.8759454
	speed: 0.0033s/iter; left time: 15.4545s
	iters: 600, epoch: 4 | loss: 0.5918179
	speed: 0.0034s/iter; left time: 15.6144s
	iters: 700, epoch: 4 | loss: 1.1477715
	speed: 0.0034s/iter; left time: 15.1717s
	iters: 800, epoch: 4 | loss: 0.8193028
	speed: 0.0032s/iter; left time: 13.8295s
	iters: 900, epoch: 4 | loss: 0.4228644
	speed: 0.0036s/iter; left time: 15.2658s
	iters: 1000, epoch: 4 | loss: 0.8233466
	speed: 0.0034s/iter; left time: 14.0698s
Updating learning rate to 7.094589055e-05
Validation loss decreased (0.3670 --> 0.3593).  Saving model state dict ...
Epoch: 4 cost time: 3.733659505844116
Epoch: 4, Steps: 1027 | Train Loss: 0.6250905 Vali Loss: 0.3593156 Best vali loss: 0.3593156
	iters: 100, epoch: 5 | loss: 0.6308181
	speed: 0.0106s/iter; left time: 42.4016s
	iters: 200, epoch: 5 | loss: 1.1967412
	speed: 0.0038s/iter; left time: 14.8596s
	iters: 300, epoch: 5 | loss: 0.5788472
	speed: 0.0033s/iter; left time: 12.6106s
	iters: 400, epoch: 5 | loss: 0.6333453
	speed: 0.0034s/iter; left time: 12.4945s
	iters: 500, epoch: 5 | loss: 0.4598680
	speed: 0.0034s/iter; left time: 12.3290s
	iters: 600, epoch: 5 | loss: 0.8059596
	speed: 0.0034s/iter; left time: 12.0280s
	iters: 700, epoch: 5 | loss: 0.3506548
	speed: 0.0032s/iter; left time: 10.9864s
	iters: 800, epoch: 5 | loss: 0.5452408
	speed: 0.0031s/iter; left time: 10.3601s
	iters: 900, epoch: 5 | loss: 0.1681826
	speed: 0.0034s/iter; left time: 11.0193s
	iters: 1000, epoch: 5 | loss: 0.5789596
	speed: 0.0032s/iter; left time: 10.0544s
Updating learning rate to 3.5472945275e-05
Epoch: 5 cost time: 3.5132837295532227
Epoch: 5, Steps: 1027 | Train Loss: 0.5948617 Vali Loss: 0.3646735 Best vali loss: 0.3593156
	iters: 100, epoch: 6 | loss: 0.3771842
	speed: 0.0107s/iter; left time: 31.8205s
	iters: 200, epoch: 6 | loss: 0.2340632
	speed: 0.0034s/iter; left time: 9.7817s
	iters: 300, epoch: 6 | loss: 1.0967916
	speed: 0.0033s/iter; left time: 9.3193s
	iters: 400, epoch: 6 | loss: 0.2353587
	speed: 0.0034s/iter; left time: 9.2407s
	iters: 500, epoch: 6 | loss: 0.5802997
	speed: 0.0033s/iter; left time: 8.6260s
	iters: 600, epoch: 6 | loss: 0.7200049
	speed: 0.0034s/iter; left time: 8.4692s
	iters: 700, epoch: 6 | loss: 0.1764913
	speed: 0.0039s/iter; left time: 9.1925s
	iters: 800, epoch: 6 | loss: 0.4238214
	speed: 0.0038s/iter; left time: 8.5952s
	iters: 900, epoch: 6 | loss: 0.2274144
	speed: 0.0038s/iter; left time: 8.3025s
	iters: 1000, epoch: 6 | loss: 0.2784346
	speed: 0.0032s/iter; left time: 6.5877s
Updating learning rate to 1.77364726375e-05
Epoch: 6 cost time: 3.628612518310547
Epoch: 6, Steps: 1027 | Train Loss: 0.4349864 Vali Loss: 0.3715529 Best vali loss: 0.3593156
	iters: 100, epoch: 7 | loss: 0.2825343
	speed: 0.0092s/iter; left time: 17.9054s
	iters: 200, epoch: 7 | loss: 0.5035430
	speed: 0.0032s/iter; left time: 5.8450s
	iters: 300, epoch: 7 | loss: 0.3360393
	speed: 0.0033s/iter; left time: 5.7665s
	iters: 400, epoch: 7 | loss: 0.9678783
	speed: 0.0062s/iter; left time: 10.2788s
	iters: 500, epoch: 7 | loss: 0.3511990
	speed: 0.0060s/iter; left time: 9.3939s
	iters: 600, epoch: 7 | loss: 0.7462742
	speed: 0.0052s/iter; left time: 7.6372s
	iters: 700, epoch: 7 | loss: 0.4956677
	speed: 0.0068s/iter; left time: 9.1838s
	iters: 800, epoch: 7 | loss: 0.2687080
	speed: 0.0033s/iter; left time: 4.2012s
	iters: 900, epoch: 7 | loss: 0.9705235
	speed: 0.0034s/iter; left time: 3.9411s
	iters: 1000, epoch: 7 | loss: 0.2985975
	speed: 0.0039s/iter; left time: 4.1265s
Updating learning rate to 8.86823631875e-06
Epoch: 7 cost time: 4.599937677383423
Epoch: 7, Steps: 1027 | Train Loss: 0.5220965 Vali Loss: 0.3662366 Best vali loss: 0.3593156
	iters: 100, epoch: 8 | loss: 0.5350412
	speed: 0.0133s/iter; left time: 12.2961s
	iters: 200, epoch: 8 | loss: 0.6794844
	speed: 0.0042s/iter; left time: 3.4561s
	iters: 300, epoch: 8 | loss: 0.6356661
	speed: 0.0041s/iter; left time: 2.9590s
	iters: 400, epoch: 8 | loss: 0.2474186
	speed: 0.0038s/iter; left time: 2.4150s
	iters: 500, epoch: 8 | loss: 0.3502800
	speed: 0.0037s/iter; left time: 1.9408s
	iters: 600, epoch: 8 | loss: 0.3075714
	speed: 0.0041s/iter; left time: 1.7757s
	iters: 700, epoch: 8 | loss: 0.2800888
	speed: 0.0042s/iter; left time: 1.3765s
	iters: 800, epoch: 8 | loss: 0.2843207
	speed: 0.0041s/iter; left time: 0.9394s
	iters: 900, epoch: 8 | loss: 0.3193943
	speed: 0.0040s/iter; left time: 0.5145s
	iters: 1000, epoch: 8 | loss: 0.2938281
	speed: 0.0042s/iter; left time: 0.1170s
Updating learning rate to 4.434118159375e-06
Epoch: 8 cost time: 4.2271201610565186
Epoch: 8, Steps: 1027 | Train Loss: 0.3933094 Vali Loss: 0.3666789 Best vali loss: 0.3593156

best validation loss 0.359315601945626

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.011915499154, 'e_layers': 4, 'learning_rate': 0.0022381340735, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8909388
	speed: 0.0123s/iter; left time: 99.7044s
	iters: 200, epoch: 1 | loss: 1.1353557
	speed: 0.0064s/iter; left time: 51.0421s
	iters: 300, epoch: 1 | loss: 0.6428068
	speed: 0.0058s/iter; left time: 45.9121s
	iters: 400, epoch: 1 | loss: 0.5048166
	speed: 0.0052s/iter; left time: 40.4081s
	iters: 500, epoch: 1 | loss: 0.7297357
	speed: 0.0048s/iter; left time: 36.9641s
	iters: 600, epoch: 1 | loss: 0.4887666
	speed: 0.0063s/iter; left time: 47.6407s
	iters: 700, epoch: 1 | loss: 1.0301596
	speed: 0.0065s/iter; left time: 48.9992s
	iters: 800, epoch: 1 | loss: 0.2948924
	speed: 0.0063s/iter; left time: 46.9163s
	iters: 900, epoch: 1 | loss: 0.9989186
	speed: 0.0047s/iter; left time: 34.4284s
	iters: 1000, epoch: 1 | loss: 0.4708116
	speed: 0.0052s/iter; left time: 37.6915s
Updating learning rate to 0.002152950167511381
Validation loss decreased (inf --> 0.3962).  Saving model state dict ...
Epoch: 1 cost time: 6.216145038604736
Epoch: 1, Steps: 1027 | Train Loss: 0.7187202 Vali Loss: 0.3961531 Best vali loss: 0.3961531
	iters: 100, epoch: 2 | loss: 0.8590610
	speed: 0.0170s/iter; left time: 120.8723s
	iters: 200, epoch: 2 | loss: 0.3479647
	speed: 0.0064s/iter; left time: 44.6773s
	iters: 300, epoch: 2 | loss: 1.1360632
	speed: 0.0059s/iter; left time: 40.8536s
	iters: 400, epoch: 2 | loss: 0.3218415
	speed: 0.0059s/iter; left time: 39.9103s
	iters: 500, epoch: 2 | loss: 1.2140164
	speed: 0.0060s/iter; left time: 39.8937s
	iters: 600, epoch: 2 | loss: 0.5814211
	speed: 0.0063s/iter; left time: 41.3753s
	iters: 700, epoch: 2 | loss: 0.4428213
	speed: 0.0062s/iter; left time: 40.3553s
	iters: 800, epoch: 2 | loss: 0.7190647
	speed: 0.0060s/iter; left time: 38.0428s
	iters: 900, epoch: 2 | loss: 0.3381328
	speed: 0.0059s/iter; left time: 37.4072s
	iters: 1000, epoch: 2 | loss: 1.0323609
	speed: 0.0062s/iter; left time: 38.2345s
Updating learning rate to 0.0019103669270382603
Epoch: 2 cost time: 6.300283670425415
Epoch: 2, Steps: 1027 | Train Loss: 0.6992748 Vali Loss: 0.4038944 Best vali loss: 0.3961531
	iters: 100, epoch: 3 | loss: 0.3734427
	speed: 0.0170s/iter; left time: 102.8662s
	iters: 200, epoch: 3 | loss: 0.3571043
	speed: 0.0059s/iter; left time: 34.9008s
	iters: 300, epoch: 3 | loss: 0.2910674
	speed: 0.0061s/iter; left time: 35.5283s
	iters: 400, epoch: 3 | loss: 0.4488403
	speed: 0.0061s/iter; left time: 34.9653s
	iters: 500, epoch: 3 | loss: 1.0144318
	speed: 0.0060s/iter; left time: 34.2042s
	iters: 600, epoch: 3 | loss: 0.6427960
	speed: 0.0059s/iter; left time: 32.9955s
	iters: 700, epoch: 3 | loss: 1.2613839
	speed: 0.0059s/iter; left time: 32.1609s
	iters: 800, epoch: 3 | loss: 0.3503953
	speed: 0.0063s/iter; left time: 33.8005s
	iters: 900, epoch: 3 | loss: 1.0229065
	speed: 0.0059s/iter; left time: 30.9118s
	iters: 1000, epoch: 3 | loss: 0.7292116
	speed: 0.0061s/iter; left time: 31.4512s
Updating learning rate to 0.00154731545142012
Epoch: 3 cost time: 6.221252679824829
Epoch: 3, Steps: 1027 | Train Loss: 0.6491580 Vali Loss: 0.4026406 Best vali loss: 0.3961531

best validation loss 0.3961531060617893

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0101561252832, 'e_layers': 1, 'learning_rate': 0.0020442502449, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4542591
	speed: 0.0089s/iter; left time: 72.2388s
	iters: 200, epoch: 1 | loss: 0.3304824
	speed: 0.0033s/iter; left time: 26.3280s
	iters: 300, epoch: 1 | loss: 0.2806296
	speed: 0.0028s/iter; left time: 22.0339s
	iters: 400, epoch: 1 | loss: 0.3513601
	speed: 0.0029s/iter; left time: 22.7453s
	iters: 500, epoch: 1 | loss: 0.4011592
	speed: 0.0033s/iter; left time: 25.5876s
	iters: 600, epoch: 1 | loss: 0.6863149
	speed: 0.0032s/iter; left time: 24.2611s
	iters: 700, epoch: 1 | loss: 0.4769007
	speed: 0.0026s/iter; left time: 19.4734s
	iters: 800, epoch: 1 | loss: 0.4262364
	speed: 0.0032s/iter; left time: 23.7762s
	iters: 900, epoch: 1 | loss: 0.4200825
	speed: 0.0033s/iter; left time: 24.4767s
	iters: 1000, epoch: 1 | loss: 0.5667545
	speed: 0.0031s/iter; left time: 22.2140s
Updating learning rate to 0.0019664456027471476
Validation loss decreased (inf --> 0.3991).  Saving model state dict ...
Epoch: 1 cost time: 3.457759380340576
Epoch: 1, Steps: 1027 | Train Loss: 0.4394179 Vali Loss: 0.3990564 Best vali loss: 0.3990564
	iters: 100, epoch: 2 | loss: 0.6213583
	speed: 0.0105s/iter; left time: 74.5384s
	iters: 200, epoch: 2 | loss: 0.3019775
	speed: 0.0027s/iter; left time: 18.5906s
	iters: 300, epoch: 2 | loss: 0.4011862
	speed: 0.0034s/iter; left time: 23.6958s
	iters: 400, epoch: 2 | loss: 0.4136185
	speed: 0.0034s/iter; left time: 23.1689s
	iters: 500, epoch: 2 | loss: 0.4663956
	speed: 0.0029s/iter; left time: 19.3760s
	iters: 600, epoch: 2 | loss: 0.4647096
	speed: 0.0029s/iter; left time: 19.1635s
	iters: 700, epoch: 2 | loss: 0.4340120
	speed: 0.0031s/iter; left time: 20.1317s
	iters: 800, epoch: 2 | loss: 0.5252750
	speed: 0.0032s/iter; left time: 20.5518s
	iters: 900, epoch: 2 | loss: 0.2857327
	speed: 0.0023s/iter; left time: 14.2122s
	iters: 1000, epoch: 2 | loss: 0.2958455
	speed: 0.0032s/iter; left time: 19.7737s
Updating learning rate to 0.0017448767277555254
Validation loss decreased (0.3991 --> 0.3816).  Saving model state dict ...
Epoch: 2 cost time: 3.164294958114624
Epoch: 2, Steps: 1027 | Train Loss: 0.4210111 Vali Loss: 0.3816033 Best vali loss: 0.3816033
	iters: 100, epoch: 3 | loss: 0.6537738
	speed: 0.0110s/iter; left time: 66.9789s
	iters: 200, epoch: 3 | loss: 2.4578638
	speed: 0.0033s/iter; left time: 19.8198s
	iters: 300, epoch: 3 | loss: 0.6878266
	speed: 0.0029s/iter; left time: 17.2610s
	iters: 400, epoch: 3 | loss: 0.2749882
	speed: 0.0025s/iter; left time: 14.6155s
	iters: 500, epoch: 3 | loss: 0.5593126
	speed: 0.0025s/iter; left time: 14.3075s
	iters: 600, epoch: 3 | loss: 0.5762482
	speed: 0.0026s/iter; left time: 14.2356s
	iters: 700, epoch: 3 | loss: 1.2641381
	speed: 0.0029s/iter; left time: 16.0908s
	iters: 800, epoch: 3 | loss: 0.2611302
	speed: 0.0030s/iter; left time: 16.3512s
	iters: 900, epoch: 3 | loss: 0.2215838
	speed: 0.0031s/iter; left time: 16.4192s
	iters: 1000, epoch: 3 | loss: 0.4375759
	speed: 0.0030s/iter; left time: 15.3574s
Updating learning rate to 0.001413275472615754
Epoch: 3 cost time: 3.069237470626831
Epoch: 3, Steps: 1027 | Train Loss: 0.7394441 Vali Loss: 0.3876892 Best vali loss: 0.3816033

best validation loss 0.3816033331607789

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.000987821602, 'e_layers': 4, 'learning_rate': 0.0009965286311, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9791631
	speed: 0.0126s/iter; left time: 24.6976s
	iters: 200, epoch: 1 | loss: 0.5182966
	speed: 0.0068s/iter; left time: 12.5855s
Updating learning rate to 0.0009586005184673902
Validation loss decreased (inf --> 0.3706).  Saving model state dict ...
Epoch: 1 cost time: 2.048229217529297
Epoch: 1, Steps: 257 | Train Loss: 0.7487299 Vali Loss: 0.3705776 Best vali loss: 0.3705776
	iters: 100, epoch: 2 | loss: 0.7100708
	speed: 0.0144s/iter; left time: 24.5202s
	iters: 200, epoch: 2 | loss: 0.6354251
	speed: 0.0068s/iter; left time: 10.8926s
Updating learning rate to 0.0008505903918986787
Epoch: 2 cost time: 1.8050823211669922
Epoch: 2, Steps: 257 | Train Loss: 0.6727480 Vali Loss: 0.3712149 Best vali loss: 0.3705776
	iters: 100, epoch: 3 | loss: 0.4626981
	speed: 0.0146s/iter; left time: 21.1160s
	iters: 200, epoch: 3 | loss: 0.4901040
	speed: 0.0067s/iter; left time: 8.9742s
Updating learning rate to 0.0006889418140497162
Epoch: 3 cost time: 1.816220760345459
Epoch: 3, Steps: 257 | Train Loss: 0.4764010 Vali Loss: 0.3723203 Best vali loss: 0.3705776

best validation loss 0.3705775592439535

{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.000987821602, 'e_layers': 4, 'learning_rate': 0.0009965286311, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.7032951
	speed: 0.0127s/iter; left time: 15.0591s
	iters: 200, epoch: 4 | loss: 0.4786595
	speed: 0.0066s/iter; left time: 7.1898s
Updating learning rate to 0.00049826431555
Epoch: 4 cost time: 2.009591579437256
Epoch: 4, Steps: 257 | Train Loss: 0.5909773 Vali Loss: 0.3835066 Best vali loss: 0.3705776
	iters: 100, epoch: 5 | loss: 0.6224033
	speed: 0.0147s/iter; left time: 13.6913s
	iters: 200, epoch: 5 | loss: 0.4412646
	speed: 0.0066s/iter; left time: 5.4304s
Updating learning rate to 0.0003075868170502838
Validation loss decreased (0.3706 --> 0.3699).  Saving model state dict ...
Epoch: 5 cost time: 1.7956745624542236
Epoch: 5, Steps: 257 | Train Loss: 0.5318340 Vali Loss: 0.3698972 Best vali loss: 0.3698972
	iters: 100, epoch: 6 | loss: 0.4416784
	speed: 0.0147s/iter; left time: 9.8549s
	iters: 200, epoch: 6 | loss: 0.4571618
	speed: 0.0048s/iter; left time: 2.7553s
Updating learning rate to 0.0001459382392013213
Epoch: 6 cost time: 1.5166652202606201
Epoch: 6, Steps: 257 | Train Loss: 0.4494201 Vali Loss: 0.3716436 Best vali loss: 0.3698972
	iters: 100, epoch: 7 | loss: 0.4651427
	speed: 0.0138s/iter; left time: 5.7316s
	iters: 200, epoch: 7 | loss: 0.4730111
	speed: 0.0070s/iter; left time: 2.2066s
Updating learning rate to 3.792811263260974e-05
Epoch: 7 cost time: 1.817383050918579
Epoch: 7, Steps: 257 | Train Loss: 0.4690769 Vali Loss: 0.3783247 Best vali loss: 0.3698972
	iters: 100, epoch: 8 | loss: 0.6122010
	speed: 0.0148s/iter; left time: 2.3359s
	iters: 200, epoch: 8 | loss: 0.6605124
	speed: 0.0057s/iter; left time: 0.3288s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.652054786682129
Epoch: 8, Steps: 257 | Train Loss: 0.6363567 Vali Loss: 0.3773210 Best vali loss: 0.3698972

best validation loss 0.3698971779735243

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0030625795344, 'e_layers': 3, 'learning_rate': 0.0002327366914, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4597051
	speed: 0.0104s/iter; left time: 20.2630s
	iters: 200, epoch: 1 | loss: 0.3634019
	speed: 0.0068s/iter; left time: 12.5619s
Updating learning rate to 0.0002238786785244278
Validation loss decreased (inf --> 0.3664).  Saving model state dict ...
Epoch: 1 cost time: 1.828815221786499
Epoch: 1, Steps: 257 | Train Loss: 0.4115535 Vali Loss: 0.3664083 Best vali loss: 0.3664083
	iters: 100, epoch: 2 | loss: 0.3751464
	speed: 0.0137s/iter; left time: 23.2960s
	iters: 200, epoch: 2 | loss: 0.9339913
	speed: 0.0066s/iter; left time: 10.5314s
Updating learning rate to 0.00019865319205993043
Epoch: 2 cost time: 1.7347679138183594
Epoch: 2, Steps: 257 | Train Loss: 0.6545689 Vali Loss: 0.3727334 Best vali loss: 0.3664083
	iters: 100, epoch: 3 | loss: 0.7486261
	speed: 0.0140s/iter; left time: 20.1990s
	iters: 200, epoch: 3 | loss: 0.5107224
	speed: 0.0067s/iter; left time: 8.9969s
Updating learning rate to 0.00016090058365112334
Epoch: 3 cost time: 1.759002685546875
Epoch: 3, Steps: 257 | Train Loss: 0.6296742 Vali Loss: 0.3690869 Best vali loss: 0.3664083
	iters: 100, epoch: 4 | loss: 0.3167160
	speed: 0.0136s/iter; left time: 16.1715s
	iters: 200, epoch: 4 | loss: 0.3769052
	speed: 0.0043s/iter; left time: 4.6156s
Updating learning rate to 0.0001163683457
Validation loss decreased (0.3664 --> 0.3661).  Saving model state dict ...
Epoch: 4 cost time: 1.380741834640503
Epoch: 4, Steps: 257 | Train Loss: 0.3468106 Vali Loss: 0.3661241 Best vali loss: 0.3661241
	iters: 100, epoch: 5 | loss: 0.4497415
	speed: 0.0125s/iter; left time: 11.6533s
	iters: 200, epoch: 5 | loss: 0.4139928
	speed: 0.0067s/iter; left time: 5.5492s
Updating learning rate to 7.183610774887667e-05
Epoch: 5 cost time: 1.7551491260528564
Epoch: 5, Steps: 257 | Train Loss: 0.4318672 Vali Loss: 0.3798717 Best vali loss: 0.3661241
	iters: 100, epoch: 6 | loss: 0.3963965
	speed: 0.0140s/iter; left time: 9.4393s
	iters: 200, epoch: 6 | loss: 0.7398844
	speed: 0.0068s/iter; left time: 3.8685s
Updating learning rate to 3.408349934006959e-05
Epoch: 6 cost time: 1.7733962535858154
Epoch: 6, Steps: 257 | Train Loss: 0.5681405 Vali Loss: 0.3782131 Best vali loss: 0.3661241
	iters: 100, epoch: 7 | loss: 0.6246694
	speed: 0.0141s/iter; left time: 5.8449s
	iters: 200, epoch: 7 | loss: 0.3550787
	speed: 0.0067s/iter; left time: 2.1125s
Updating learning rate to 8.858012875572196e-06
Epoch: 7 cost time: 1.7391300201416016
Epoch: 7, Steps: 257 | Train Loss: 0.4898741 Vali Loss: 0.3697607 Best vali loss: 0.3661241
	iters: 100, epoch: 8 | loss: 0.4938335
	speed: 0.0138s/iter; left time: 2.1727s
	iters: 200, epoch: 8 | loss: 0.4531642
	speed: 0.0067s/iter; left time: 0.3865s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7424702644348145
Epoch: 8, Steps: 257 | Train Loss: 0.4734988 Vali Loss: 0.3691935 Best vali loss: 0.3661241

best validation loss 0.36612406111887724

{'batch_size': 64, 'd_core': 32, 'd_model': 128, 'dropout': 0.0099506207971, 'e_layers': 4, 'learning_rate': 0.0041237779005, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7755820
	speed: 0.0136s/iter; left time: 12.6966s
Updating learning rate to 0.0041237779005
Validation loss decreased (inf --> 0.3962).  Saving model state dict ...
Epoch: 1 cost time: 1.3058876991271973
Epoch: 1, Steps: 129 | Train Loss: 0.7755820 Vali Loss: 0.3961782 Best vali loss: 0.3961782
	iters: 100, epoch: 2 | loss: 0.6162762
	speed: 0.0104s/iter; left time: 8.3639s
Updating learning rate to 0.00206188895025
Epoch: 2 cost time: 0.913853645324707
Epoch: 2, Steps: 129 | Train Loss: 0.6162762 Vali Loss: 0.4095212 Best vali loss: 0.3961782
	iters: 100, epoch: 3 | loss: 0.9077551
	speed: 0.0142s/iter; left time: 9.6097s
Updating learning rate to 0.001030944475125
Epoch: 3 cost time: 1.1868603229522705
Epoch: 3, Steps: 129 | Train Loss: 0.9077551 Vali Loss: 0.4112111 Best vali loss: 0.3961782
	iters: 100, epoch: 4 | loss: 0.9337502
	speed: 0.0146s/iter; left time: 7.9500s
Updating learning rate to 0.0005154722375625
Epoch: 4 cost time: 1.1824603080749512
Epoch: 4, Steps: 129 | Train Loss: 0.9337502 Vali Loss: 0.4035986 Best vali loss: 0.3961782
	iters: 100, epoch: 5 | loss: 0.7762058
	speed: 0.0143s/iter; left time: 5.9753s
Updating learning rate to 0.00025773611878125
Epoch: 5 cost time: 1.1597275733947754
Epoch: 5, Steps: 129 | Train Loss: 0.7762058 Vali Loss: 0.4068021 Best vali loss: 0.3961782
	iters: 100, epoch: 6 | loss: 0.6107666
	speed: 0.0143s/iter; left time: 4.1247s
Updating learning rate to 0.000128868059390625
Epoch: 6 cost time: 1.1581037044525146
Epoch: 6, Steps: 129 | Train Loss: 0.6107666 Vali Loss: 0.4048997 Best vali loss: 0.3961782
	iters: 100, epoch: 7 | loss: 0.6933565
	speed: 0.0140s/iter; left time: 2.2323s
Updating learning rate to 6.44340296953125e-05
Epoch: 7 cost time: 1.1571478843688965
Epoch: 7, Steps: 129 | Train Loss: 0.6933565 Vali Loss: 0.4060054 Best vali loss: 0.3961782
	iters: 100, epoch: 8 | loss: 0.7007953
	speed: 0.0143s/iter; left time: 0.4282s
Updating learning rate to 3.221701484765625e-05
Epoch: 8 cost time: 1.17498779296875
Epoch: 8, Steps: 129 | Train Loss: 0.7007953 Vali Loss: 0.4059433 Best vali loss: 0.3961782

best validation loss 0.3961782150395024

{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0033532746374, 'e_layers': 3, 'learning_rate': 0.0001820777857, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5181177
	speed: 0.0146s/iter; left time: 13.5958s
Updating learning rate to 0.0001820777857
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 1.317687749862671
Epoch: 1, Steps: 129 | Train Loss: 0.5181177 Vali Loss: 0.3681765 Best vali loss: 0.3681765
	iters: 100, epoch: 2 | loss: 0.6591401
	speed: 0.0089s/iter; left time: 7.1763s
Updating learning rate to 9.103889285e-05
Validation loss decreased (0.3682 --> 0.3654).  Saving model state dict ...
Epoch: 2 cost time: 0.785839319229126
Epoch: 2, Steps: 129 | Train Loss: 0.6591401 Vali Loss: 0.3654131 Best vali loss: 0.3654131
	iters: 100, epoch: 3 | loss: 0.4610925
	speed: 0.0121s/iter; left time: 8.1389s
Updating learning rate to 4.5519446425e-05
Epoch: 3 cost time: 0.9584558010101318
Epoch: 3, Steps: 129 | Train Loss: 0.4610925 Vali Loss: 0.3687491 Best vali loss: 0.3654131

best validation loss 0.36541310692817147

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038698826022, 'e_layers': 4, 'learning_rate': 0.0004004528328, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0004004528328
Validation loss decreased (inf --> 0.3696).  Saving model state dict ...
Epoch: 1 cost time: 0.8782017230987549
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3696192 Best vali loss: 0.3696192
Updating learning rate to 0.0002002264164
Validation loss decreased (0.3696 --> 0.3645).  Saving model state dict ...
Epoch: 2 cost time: 0.5960547924041748
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3645302 Best vali loss: 0.3645302
Updating learning rate to 0.0001001132082
Epoch: 3 cost time: 0.6501362323760986
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3656842 Best vali loss: 0.3645302

best validation loss 0.3645302237368286

{'batch_size': 128, 'd_core': 64, 'd_model': 32, 'dropout': 0.004191723262, 'e_layers': 3, 'learning_rate': 0.0043478566088, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0043478566088
Validation loss decreased (inf --> 0.3679).  Saving model state dict ...
Epoch: 1 cost time: 0.7967522144317627
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3678811 Best vali loss: 0.3678811
Updating learning rate to 0.0021739283044
Epoch: 2 cost time: 0.5579566955566406
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3689722 Best vali loss: 0.3678811
Updating learning rate to 0.0010869641522
Epoch: 3 cost time: 0.5635173320770264
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3718190 Best vali loss: 0.3678811

best validation loss 0.3678811217455124

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0038698826022, 'e_layers': 4, 'learning_rate': 0.0004004528328, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.00566041e-05
Epoch: 4 cost time: 0.7514433860778809
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3686239 Best vali loss: 0.3645302
Updating learning rate to 2.502830205e-05
Epoch: 5 cost time: 0.4662656784057617
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3705099 Best vali loss: 0.3645302
Updating learning rate to 1.2514151025e-05
Epoch: 6 cost time: 0.4778556823730469
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3695980 Best vali loss: 0.3645302
Updating learning rate to 6.2570755125e-06
Epoch: 7 cost time: 0.5943760871887207
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3708121 Best vali loss: 0.3645302
Updating learning rate to 3.12853775625e-06
Epoch: 8 cost time: 0.5887789726257324
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3707016 Best vali loss: 0.3645302

best validation loss 0.3645302237368286

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.000986867044, 'e_layers': 1, 'learning_rate': 6.59648622e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 6.345422412575373e-05
Validation loss decreased (inf --> 0.4357).  Saving model state dict ...
Epoch: 1 cost time: 0.6726319789886475
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4357231 Best vali loss: 0.4357231
Updating learning rate to 5.630453179082808e-05
Validation loss decreased (0.4357 --> 0.4229).  Saving model state dict ...
Epoch: 2 cost time: 0.4252157211303711
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4228703 Best vali loss: 0.4228703
Updating learning rate to 4.5604261041093085e-05
Validation loss decreased (0.4229 --> 0.4130).  Saving model state dict ...
Epoch: 3 cost time: 0.4183802604675293
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4130300 Best vali loss: 0.4130300
Updating learning rate to 3.29824311e-05
Validation loss decreased (0.4130 --> 0.4063).  Saving model state dict ...
Epoch: 4 cost time: 0.4372599124908447
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4063145 Best vali loss: 0.4063145
Updating learning rate to 2.0360601158906917e-05
Validation loss decreased (0.4063 --> 0.4020).  Saving model state dict ...
Epoch: 5 cost time: 0.4455223083496094
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.4020409 Best vali loss: 0.4020409
Updating learning rate to 9.660330409171922e-06
Validation loss decreased (0.4020 --> 0.3995).  Saving model state dict ...
Epoch: 6 cost time: 0.4363689422607422
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3995029 Best vali loss: 0.3995029
Updating learning rate to 2.5106380742462752e-06
Validation loss decreased (0.3995 --> 0.3984).  Saving model state dict ...
Epoch: 7 cost time: 0.42054247856140137
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3984294 Best vali loss: 0.3984294
Updating learning rate to 0.0
Validation loss decreased (0.3984 --> 0.3981).  Saving model state dict ...
Epoch: 8 cost time: 0.5573692321777344
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3981444 Best vali loss: 0.3981444

best validation loss 0.3981444127198989

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0021078822862, 'e_layers': 1, 'learning_rate': 0.0019637021813, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019637021813
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 0.6834852695465088
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3662884 Best vali loss: 0.3662884
Updating learning rate to 0.00098185109065
Epoch: 2 cost time: 0.4358866214752197
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3713071 Best vali loss: 0.3662884
Updating learning rate to 0.000490925545325
Validation loss decreased (0.3663 --> 0.3659).  Saving model state dict ...
Epoch: 3 cost time: 0.41567397117614746
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3659434 Best vali loss: 0.3659434
Updating learning rate to 0.0002454627726625
Epoch: 4 cost time: 0.44605278968811035
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3660423 Best vali loss: 0.3659434
Updating learning rate to 0.00012273138633125
Epoch: 5 cost time: 0.43246936798095703
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3675438 Best vali loss: 0.3659434
Updating learning rate to 6.1365693165625e-05
Epoch: 6 cost time: 0.443556547164917
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3679359 Best vali loss: 0.3659434
Updating learning rate to 3.06828465828125e-05
Epoch: 7 cost time: 0.4291067123413086
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3681262 Best vali loss: 0.3659434
Updating learning rate to 1.534142329140625e-05
Epoch: 8 cost time: 0.4100649356842041
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3683120 Best vali loss: 0.3659434

best validation loss 0.3659433722144728

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0070498653705, 'e_layers': 4, 'learning_rate': 6.58625109e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 6.58625109e-05
Validation loss decreased (inf --> 0.3811).  Saving model state dict ...
Epoch: 1 cost time: 0.9560825824737549
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3810532 Best vali loss: 0.3810532
Updating learning rate to 3.293125545e-05
Validation loss decreased (0.3811 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 0.6972241401672363
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3669679 Best vali loss: 0.3669679
Updating learning rate to 1.6465627725e-05
Validation loss decreased (0.3670 --> 0.3649).  Saving model state dict ...
Epoch: 3 cost time: 0.7026588916778564
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3648525 Best vali loss: 0.3648525

best validation loss 0.36485253396811795

{'batch_size': 16, 'd_core': 512, 'd_model': 32, 'dropout': 0.0054060240629, 'e_layers': 3, 'learning_rate': 0.0006154728297, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3698026
	speed: 0.0120s/iter; left time: 48.2450s
	iters: 200, epoch: 1 | loss: 0.6591713
	speed: 0.0062s/iter; left time: 24.3757s
	iters: 300, epoch: 1 | loss: 1.0961819
	speed: 0.0062s/iter; left time: 23.5374s
	iters: 400, epoch: 1 | loss: 0.2758059
	speed: 0.0061s/iter; left time: 22.6991s
	iters: 500, epoch: 1 | loss: 0.3369479
	speed: 0.0062s/iter; left time: 22.5762s
Updating learning rate to 0.0006154728297
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 3.485481023788452
Epoch: 1, Steps: 514 | Train Loss: 0.5475819 Vali Loss: 0.3675072 Best vali loss: 0.3675072
	iters: 100, epoch: 2 | loss: 0.2646711
	speed: 0.0097s/iter; left time: 33.9265s
	iters: 200, epoch: 2 | loss: 0.7228286
	speed: 0.0064s/iter; left time: 21.5974s
	iters: 300, epoch: 2 | loss: 0.2696287
	speed: 0.0067s/iter; left time: 22.1768s
	iters: 400, epoch: 2 | loss: 0.3556326
	speed: 0.0065s/iter; left time: 20.8948s
	iters: 500, epoch: 2 | loss: 0.4124698
	speed: 0.0057s/iter; left time: 17.7840s
Updating learning rate to 0.00030773641485
Epoch: 2 cost time: 3.064389944076538
Epoch: 2, Steps: 514 | Train Loss: 0.4050461 Vali Loss: 0.3741252 Best vali loss: 0.3675072
	iters: 100, epoch: 3 | loss: 0.6216495
	speed: 0.0095s/iter; left time: 28.2946s
	iters: 200, epoch: 3 | loss: 0.3904777
	speed: 0.0063s/iter; left time: 18.0837s
	iters: 300, epoch: 3 | loss: 0.4733387
	speed: 0.0063s/iter; left time: 17.6839s
	iters: 400, epoch: 3 | loss: 0.5898510
	speed: 0.0059s/iter; left time: 15.7551s
	iters: 500, epoch: 3 | loss: 0.6582649
	speed: 0.0061s/iter; left time: 15.7922s
Updating learning rate to 0.000153868207425
Epoch: 3 cost time: 3.1277685165405273
Epoch: 3, Steps: 514 | Train Loss: 0.5467164 Vali Loss: 0.3685130 Best vali loss: 0.3675072

best validation loss 0.3675072320903448

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00028418741906240314
Validation loss decreased (inf --> 0.3699).  Saving model state dict ...
Epoch: 1 cost time: 0.9121837615966797
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3698876 Best vali loss: 0.3698876
Updating learning rate to 0.000252166657013118
Validation loss decreased (0.3699 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 0.6132662296295166
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3650475 Best vali loss: 0.3650475
Updating learning rate to 0.0002042442000052176
Validation loss decreased (0.3650 --> 0.3628).  Saving model state dict ...
Epoch: 3 cost time: 0.6573209762573242
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3627895 Best vali loss: 0.3627895

best validation loss 0.3627894833069185

{'batch_size': 128, 'd_core': 128, 'd_model': 128, 'dropout': 0.0027329839382, 'e_layers': 3, 'learning_rate': 0.0002954316154, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001477158077
Epoch: 4 cost time: 0.8589396476745605
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3665702 Best vali loss: 0.3627895
Updating learning rate to 9.118741539478246e-05
Epoch: 5 cost time: 0.6116354465484619
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3690572 Best vali loss: 0.3627895
Updating learning rate to 4.326495838688198e-05
Epoch: 6 cost time: 0.6092357635498047
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3695651 Best vali loss: 0.3627895
Updating learning rate to 1.124419633759687e-05
Epoch: 7 cost time: 0.6268775463104248
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3718830 Best vali loss: 0.3627895
Updating learning rate to 0.0
Epoch: 8 cost time: 0.60733962059021
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3702781 Best vali loss: 0.3627895

best validation loss 0.3627894833069185

{'batch_size': 32, 'd_core': 256, 'd_model': 128, 'dropout': 0.0012126761903, 'e_layers': 1, 'learning_rate': 0.0006771784349, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5874979
	speed: 0.0095s/iter; left time: 18.6833s
	iters: 200, epoch: 1 | loss: 0.5537794
	speed: 0.0039s/iter; left time: 7.2978s
Updating learning rate to 0.0006514048653810684
Validation loss decreased (inf --> 0.3688).  Saving model state dict ...
Epoch: 1 cost time: 1.285912036895752
Epoch: 1, Steps: 257 | Train Loss: 0.5706386 Vali Loss: 0.3687505 Best vali loss: 0.3687505
	iters: 100, epoch: 2 | loss: 0.6042551
	speed: 0.0092s/iter; left time: 15.6347s
	iters: 200, epoch: 2 | loss: 0.4980688
	speed: 0.0037s/iter; left time: 5.8422s
Updating learning rate to 0.0005780079491455414
Epoch: 2 cost time: 0.9933948516845703
Epoch: 2, Steps: 257 | Train Loss: 0.5511620 Vali Loss: 0.3689392 Best vali loss: 0.3687505
	iters: 100, epoch: 3 | loss: 0.5426298
	speed: 0.0089s/iter; left time: 12.7709s
	iters: 200, epoch: 3 | loss: 0.4071374
	speed: 0.0037s/iter; left time: 4.9600s
Updating learning rate to 0.0004681617013455758
Epoch: 3 cost time: 0.9757480621337891
Epoch: 3, Steps: 257 | Train Loss: 0.4748836 Vali Loss: 0.3760219 Best vali loss: 0.3687505
	iters: 100, epoch: 4 | loss: 0.3533334
	speed: 0.0094s/iter; left time: 11.1274s
	iters: 200, epoch: 4 | loss: 0.4877535
	speed: 0.0040s/iter; left time: 4.3825s
Updating learning rate to 0.00033858921745
Epoch: 4 cost time: 1.0508713722229004
Epoch: 4, Steps: 257 | Train Loss: 0.4205435 Vali Loss: 0.3733342 Best vali loss: 0.3687505
	iters: 100, epoch: 5 | loss: 0.6289169
	speed: 0.0094s/iter; left time: 8.7076s
	iters: 200, epoch: 5 | loss: 0.6512783
	speed: 0.0037s/iter; left time: 3.0806s
Updating learning rate to 0.00020901673355442425
Epoch: 5 cost time: 0.9857814311981201
Epoch: 5, Steps: 257 | Train Loss: 0.6400976 Vali Loss: 0.3955521 Best vali loss: 0.3687505
	iters: 100, epoch: 6 | loss: 0.3672580
	speed: 0.0094s/iter; left time: 6.3006s
	iters: 200, epoch: 6 | loss: 0.4124192
	speed: 0.0040s/iter; left time: 2.2887s
Updating learning rate to 9.917048575445851e-05
Epoch: 6 cost time: 1.071150302886963
Epoch: 6, Steps: 257 | Train Loss: 0.3898386 Vali Loss: 0.3938576 Best vali loss: 0.3687505
	iters: 100, epoch: 7 | loss: 0.4117945
	speed: 0.0094s/iter; left time: 3.8890s
	iters: 200, epoch: 7 | loss: 0.4456362
	speed: 0.0038s/iter; left time: 1.2052s
Updating learning rate to 2.577356951893159e-05
Epoch: 7 cost time: 0.9873147010803223
Epoch: 7, Steps: 257 | Train Loss: 0.4287153 Vali Loss: 0.3933098 Best vali loss: 0.3687505
	iters: 100, epoch: 8 | loss: 0.6939561
	speed: 0.0089s/iter; left time: 1.4083s
	iters: 200, epoch: 8 | loss: 0.3683072
	speed: 0.0039s/iter; left time: 0.2243s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0183660984039307
Epoch: 8, Steps: 257 | Train Loss: 0.5311317 Vali Loss: 0.3912402 Best vali loss: 0.3687505

best validation loss 0.36875049030382645

{'batch_size': 32, 'd_core': 128, 'd_model': 32, 'dropout': 0.0066567632481, 'e_layers': 3, 'learning_rate': 0.002104042691, 'lradj': 'cosine', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9947689
	speed: 0.0120s/iter; left time: 23.4718s
	iters: 200, epoch: 1 | loss: 0.8715690
	speed: 0.0066s/iter; left time: 12.2020s
Updating learning rate to 0.0020239623343724345
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 1.9446358680725098
Epoch: 1, Steps: 257 | Train Loss: 0.9331690 Vali Loss: 0.3684852 Best vali loss: 0.3684852
	iters: 100, epoch: 2 | loss: 0.4084704
	speed: 0.0136s/iter; left time: 23.1547s
	iters: 200, epoch: 2 | loss: 0.6159315
	speed: 0.0063s/iter; left time: 10.0782s
Updating learning rate to 0.0017959127728560456
Epoch: 2 cost time: 1.6918222904205322
Epoch: 2, Steps: 257 | Train Loss: 0.5122010 Vali Loss: 0.3800120 Best vali loss: 0.3684852
	iters: 100, epoch: 3 | loss: 0.7005306
	speed: 0.0139s/iter; left time: 20.0460s
	iters: 200, epoch: 3 | loss: 0.5079636
	speed: 0.0065s/iter; left time: 8.6753s
Updating learning rate to 0.00145461248491728
Epoch: 3 cost time: 1.7117090225219727
Epoch: 3, Steps: 257 | Train Loss: 0.6042471 Vali Loss: 0.3761664 Best vali loss: 0.3684852
	iters: 100, epoch: 4 | loss: 0.6950567
	speed: 0.0134s/iter; left time: 15.9070s
	iters: 200, epoch: 4 | loss: 0.8294156
	speed: 0.0064s/iter; left time: 6.9322s
Updating learning rate to 0.0010520213455
Epoch: 4 cost time: 1.647017240524292
Epoch: 4, Steps: 257 | Train Loss: 0.7622361 Vali Loss: 0.3880851 Best vali loss: 0.3684852
	iters: 100, epoch: 5 | loss: 0.7084396
	speed: 0.0142s/iter; left time: 13.2121s
	iters: 200, epoch: 5 | loss: 0.3838280
	speed: 0.0063s/iter; left time: 5.1914s
Updating learning rate to 0.00064943020608272
Epoch: 5 cost time: 1.6854991912841797
Epoch: 5, Steps: 257 | Train Loss: 0.5461338 Vali Loss: 0.3862261 Best vali loss: 0.3684852
	iters: 100, epoch: 6 | loss: 0.6676189
	speed: 0.0133s/iter; left time: 8.9629s
	iters: 200, epoch: 6 | loss: 0.5027316
	speed: 0.0063s/iter; left time: 3.6215s
Updating learning rate to 0.00030812991814395423
Epoch: 6 cost time: 1.6717042922973633
Epoch: 6, Steps: 257 | Train Loss: 0.5851753 Vali Loss: 0.3959520 Best vali loss: 0.3684852
	iters: 100, epoch: 7 | loss: 0.4220881
	speed: 0.0134s/iter; left time: 5.5613s
	iters: 200, epoch: 7 | loss: 0.6320627
	speed: 0.0064s/iter; left time: 2.0065s
Updating learning rate to 8.008035662756513e-05
Epoch: 7 cost time: 1.7037274837493896
Epoch: 7, Steps: 257 | Train Loss: 0.5270754 Vali Loss: 0.3966288 Best vali loss: 0.3684852
	iters: 100, epoch: 8 | loss: 0.4408246
	speed: 0.0137s/iter; left time: 2.1714s
	iters: 200, epoch: 8 | loss: 0.4125372
	speed: 0.0063s/iter; left time: 0.3665s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6806328296661377
Epoch: 8, Steps: 257 | Train Loss: 0.4266809 Vali Loss: 0.3897416 Best vali loss: 0.3684852

best validation loss 0.36848522032407977

{'batch_size': 64, 'd_core': 64, 'd_model': 32, 'dropout': 0.0034282770657, 'e_layers': 2, 'learning_rate': 0.0002535480338, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6584820
	speed: 0.0122s/iter; left time: 11.3745s
Updating learning rate to 0.00024389793636814995
Validation loss decreased (inf --> 0.3996).  Saving model state dict ...
Epoch: 1 cost time: 1.121485948562622
Epoch: 1, Steps: 129 | Train Loss: 0.6584820 Vali Loss: 0.3996310 Best vali loss: 0.3996310
	iters: 100, epoch: 2 | loss: 0.6442427
	speed: 0.0106s/iter; left time: 8.5106s
Updating learning rate to 0.00021641678392824796
Validation loss decreased (0.3996 --> 0.3830).  Saving model state dict ...
Epoch: 2 cost time: 0.8523333072662354
Epoch: 2, Steps: 129 | Train Loss: 0.6442427 Vali Loss: 0.3830008 Best vali loss: 0.3830008
	iters: 100, epoch: 3 | loss: 0.6521055
	speed: 0.0096s/iter; left time: 6.4966s
Updating learning rate to 0.0001752883328220019
Validation loss decreased (0.3830 --> 0.3755).  Saving model state dict ...
Epoch: 3 cost time: 0.6603667736053467
Epoch: 3, Steps: 129 | Train Loss: 0.6521055 Vali Loss: 0.3755044 Best vali loss: 0.3755044

best validation loss 0.37550443739928524

{'batch_size': 128, 'd_core': 32, 'd_model': 128, 'dropout': 0.0046642077899, 'e_layers': 3, 'learning_rate': 0.0046118283421, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0046118283421
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 0.7905526161193848
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3818220 Best vali loss: 0.3818220
Updating learning rate to 0.00230591417105
Epoch: 2 cost time: 0.5201294422149658
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4006139 Best vali loss: 0.3818220
Updating learning rate to 0.001152957085525
Epoch: 3 cost time: 0.5132009983062744
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3901110 Best vali loss: 0.3818220

best validation loss 0.3818220165483141

[INFO][smbo.py:320] Finished 350 trials.
{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001706392447, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7275699
	speed: 0.0125s/iter; left time: 24.4429s
	iters: 200, epoch: 1 | loss: 0.7485095
	speed: 0.0065s/iter; left time: 12.0472s
Updating learning rate to 0.00016414467516075753
Validation loss decreased (inf --> 0.3789).  Saving model state dict ...
Epoch: 1 cost time: 2.0033297538757324
Epoch: 1, Steps: 257 | Train Loss: 0.7380397 Vali Loss: 0.3788553 Best vali loss: 0.3788553
	iters: 100, epoch: 2 | loss: 0.6777400
	speed: 0.0139s/iter; left time: 23.6639s
	iters: 200, epoch: 2 | loss: 0.4398066
	speed: 0.0070s/iter; left time: 11.2669s
Updating learning rate to 0.0001456497058819603
Validation loss decreased (0.3789 --> 0.3680).  Saving model state dict ...
Epoch: 2 cost time: 1.7935142517089844
Epoch: 2, Steps: 257 | Train Loss: 0.5587733 Vali Loss: 0.3679988 Best vali loss: 0.3679988
	iters: 100, epoch: 3 | loss: 0.7442163
	speed: 0.0142s/iter; left time: 20.5290s
	iters: 200, epoch: 3 | loss: 0.4122253
	speed: 0.0066s/iter; left time: 8.9011s
Updating learning rate to 0.00011797002827899123
Epoch: 3 cost time: 1.747870922088623
Epoch: 3, Steps: 257 | Train Loss: 0.5782208 Vali Loss: 0.3680956 Best vali loss: 0.3679988

best validation loss 0.36799878704056055

{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001706392447, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6404380
	speed: 0.0127s/iter; left time: 15.0869s
	iters: 200, epoch: 4 | loss: 0.6277228
	speed: 0.0065s/iter; left time: 7.0274s
Updating learning rate to 8.531962235e-05
Validation loss decreased (0.3680 --> 0.3678).  Saving model state dict ...
Epoch: 4 cost time: 1.9986538887023926
Epoch: 4, Steps: 257 | Train Loss: 0.6340804 Vali Loss: 0.3677629 Best vali loss: 0.3677629
	iters: 100, epoch: 5 | loss: 0.6822231
	speed: 0.0143s/iter; left time: 13.3038s
	iters: 200, epoch: 5 | loss: 0.3994775
	speed: 0.0067s/iter; left time: 5.5239s
Updating learning rate to 5.266921642100878e-05
Epoch: 5 cost time: 1.7624680995941162
Epoch: 5, Steps: 257 | Train Loss: 0.5408503 Vali Loss: 0.3687427 Best vali loss: 0.3677629
	iters: 100, epoch: 6 | loss: 0.7075182
	speed: 0.0144s/iter; left time: 9.7089s
	iters: 200, epoch: 6 | loss: 0.4137185
	speed: 0.0067s/iter; left time: 3.8122s
Updating learning rate to 2.4989538818039686e-05
Epoch: 6 cost time: 1.7832417488098145
Epoch: 6, Steps: 257 | Train Loss: 0.5606183 Vali Loss: 0.3703094 Best vali loss: 0.3677629
	iters: 100, epoch: 7 | loss: 0.5410222
	speed: 0.0146s/iter; left time: 6.0619s
	iters: 200, epoch: 7 | loss: 1.0227966
	speed: 0.0065s/iter; left time: 2.0465s
Updating learning rate to 6.4945695392424685e-06
Epoch: 7 cost time: 1.7926537990570068
Epoch: 7, Steps: 257 | Train Loss: 0.7819094 Vali Loss: 0.3705009 Best vali loss: 0.3677629
	iters: 100, epoch: 8 | loss: 0.7442517
	speed: 0.0143s/iter; left time: 2.2535s
	iters: 200, epoch: 8 | loss: 0.6572738
	speed: 0.0066s/iter; left time: 0.3825s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.7992792129516602
Epoch: 8, Steps: 257 | Train Loss: 0.7007627 Vali Loss: 0.3707511 Best vali loss: 0.3677629

best validation loss 0.3677629230064587

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0026209986474, 'e_layers': 4, 'learning_rate': 8.46744742e-05, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8128214
	speed: 0.0143s/iter; left time: 13.3171s
Updating learning rate to 8.46744742e-05
Validation loss decreased (inf --> 0.3665).  Saving model state dict ...
Epoch: 1 cost time: 1.4076855182647705
Epoch: 1, Steps: 129 | Train Loss: 0.8128214 Vali Loss: 0.3665055 Best vali loss: 0.3665055
	iters: 100, epoch: 2 | loss: 0.5922087
	speed: 0.0138s/iter; left time: 11.0840s
Updating learning rate to 4.23372371e-05
Validation loss decreased (0.3665 --> 0.3621).  Saving model state dict ...
Epoch: 2 cost time: 1.1405231952667236
Epoch: 2, Steps: 129 | Train Loss: 0.5922087 Vali Loss: 0.3620796 Best vali loss: 0.3620796
	iters: 100, epoch: 3 | loss: 0.5169916
	speed: 0.0142s/iter; left time: 9.5873s
Updating learning rate to 2.116861855e-05
Epoch: 3 cost time: 1.1178903579711914
Epoch: 3, Steps: 129 | Train Loss: 0.5169916 Vali Loss: 0.3624537 Best vali loss: 0.3620796
	iters: 100, epoch: 4 | loss: 0.7568279
	speed: 0.0135s/iter; left time: 7.3503s
Updating learning rate to 1.0584309275e-05
Epoch: 4 cost time: 1.1141538619995117
Epoch: 4, Steps: 129 | Train Loss: 0.7568279 Vali Loss: 0.3627521 Best vali loss: 0.3620796
	iters: 100, epoch: 5 | loss: 0.6732020
	speed: 0.0136s/iter; left time: 5.6696s
Updating learning rate to 5.2921546375e-06
Validation loss decreased (0.3621 --> 0.3618).  Saving model state dict ...
Epoch: 5 cost time: 1.092247486114502
Epoch: 5, Steps: 129 | Train Loss: 0.6732020 Vali Loss: 0.3618135 Best vali loss: 0.3618135
	iters: 100, epoch: 6 | loss: 0.6899316
	speed: 0.0124s/iter; left time: 3.5787s
Updating learning rate to 2.64607731875e-06
Epoch: 6 cost time: 0.9082090854644775
Epoch: 6, Steps: 129 | Train Loss: 0.6899316 Vali Loss: 0.3625333 Best vali loss: 0.3618135
	iters: 100, epoch: 7 | loss: 0.7078725
	speed: 0.0126s/iter; left time: 2.0086s
Updating learning rate to 1.323038659375e-06
Epoch: 7 cost time: 1.1879651546478271
Epoch: 7, Steps: 129 | Train Loss: 0.7078725 Vali Loss: 0.3621713 Best vali loss: 0.3618135
	iters: 100, epoch: 8 | loss: 0.6522946
	speed: 0.0142s/iter; left time: 0.4268s
Updating learning rate to 6.615193296875e-07
Epoch: 8 cost time: 1.1287236213684082
Epoch: 8, Steps: 129 | Train Loss: 0.6522946 Vali Loss: 0.3622842 Best vali loss: 0.3618135

best validation loss 0.36181353263864346

{'batch_size': 64, 'd_core': 32, 'd_model': 32, 'dropout': 0.0083025866439, 'e_layers': 3, 'learning_rate': 0.0007704396347, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6453834
	speed: 0.0121s/iter; left time: 11.2534s
Updating learning rate to 0.0007704396347
Validation loss decreased (inf --> 0.3736).  Saving model state dict ...
Epoch: 1 cost time: 1.119946002960205
Epoch: 1, Steps: 129 | Train Loss: 0.6453834 Vali Loss: 0.3735544 Best vali loss: 0.3735544
	iters: 100, epoch: 2 | loss: 1.0013536
	speed: 0.0111s/iter; left time: 8.9429s
Updating learning rate to 0.00038521981735
Validation loss decreased (0.3736 --> 0.3668).  Saving model state dict ...
Epoch: 2 cost time: 0.8714489936828613
Epoch: 2, Steps: 129 | Train Loss: 1.0013536 Vali Loss: 0.3667644 Best vali loss: 0.3667644
	iters: 100, epoch: 3 | loss: 0.3680190
	speed: 0.0120s/iter; left time: 8.0929s
Updating learning rate to 0.000192609908675
Epoch: 3 cost time: 0.9650702476501465
Epoch: 3, Steps: 129 | Train Loss: 0.3680190 Vali Loss: 0.3675688 Best vali loss: 0.3667644
	iters: 100, epoch: 4 | loss: 0.6954190
	speed: 0.0111s/iter; left time: 6.0488s
Updating learning rate to 9.63049543375e-05
Validation loss decreased (0.3668 --> 0.3667).  Saving model state dict ...
Epoch: 4 cost time: 0.8886582851409912
Epoch: 4, Steps: 129 | Train Loss: 0.6954190 Vali Loss: 0.3666638 Best vali loss: 0.3666638
	iters: 100, epoch: 5 | loss: 0.5078331
	speed: 0.0112s/iter; left time: 4.6810s
Updating learning rate to 4.815247716875e-05
Epoch: 5 cost time: 0.8732898235321045
Epoch: 5, Steps: 129 | Train Loss: 0.5078331 Vali Loss: 0.3686744 Best vali loss: 0.3666638
	iters: 100, epoch: 6 | loss: 0.6221238
	speed: 0.0113s/iter; left time: 3.2514s
Updating learning rate to 2.4076238584375e-05
Epoch: 6 cost time: 0.876715898513794
Epoch: 6, Steps: 129 | Train Loss: 0.6221238 Vali Loss: 0.3693080 Best vali loss: 0.3666638
	iters: 100, epoch: 7 | loss: 0.7393841
	speed: 0.0113s/iter; left time: 1.7928s
Updating learning rate to 1.20381192921875e-05
Epoch: 7 cost time: 0.8835599422454834
Epoch: 7, Steps: 129 | Train Loss: 0.7393841 Vali Loss: 0.3691135 Best vali loss: 0.3666638
	iters: 100, epoch: 8 | loss: 0.4089791
	speed: 0.0113s/iter; left time: 0.3401s
Updating learning rate to 6.01905964609375e-06
Epoch: 8 cost time: 0.8833153247833252
Epoch: 8, Steps: 129 | Train Loss: 0.4089791 Vali Loss: 0.3692139 Best vali loss: 0.3666638

best validation loss 0.3666638469532103

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0043465477863, 'e_layers': 4, 'learning_rate': 0.0010618747206, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5973008
	speed: 0.0113s/iter; left time: 91.9999s
	iters: 200, epoch: 1 | loss: 0.8207756
	speed: 0.0050s/iter; left time: 40.0992s
	iters: 300, epoch: 1 | loss: 0.4282146
	speed: 0.0060s/iter; left time: 47.1345s
	iters: 400, epoch: 1 | loss: 1.0489023
	speed: 0.0067s/iter; left time: 52.2064s
	iters: 500, epoch: 1 | loss: 0.3901609
	speed: 0.0062s/iter; left time: 48.1682s
	iters: 600, epoch: 1 | loss: 0.4098428
	speed: 0.0065s/iter; left time: 49.3297s
	iters: 700, epoch: 1 | loss: 1.1138420
	speed: 0.0067s/iter; left time: 50.0317s
	iters: 800, epoch: 1 | loss: 0.6593376
	speed: 0.0063s/iter; left time: 46.9392s
	iters: 900, epoch: 1 | loss: 0.3263643
	speed: 0.0049s/iter; left time: 35.9172s
	iters: 1000, epoch: 1 | loss: 0.9196385
	speed: 0.0048s/iter; left time: 34.3448s
Updating learning rate to 0.0010618747206
Validation loss decreased (inf --> 0.4035).  Saving model state dict ...
Epoch: 1 cost time: 6.290328502655029
Epoch: 1, Steps: 1027 | Train Loss: 0.6714379 Vali Loss: 0.4035014 Best vali loss: 0.4035014
	iters: 100, epoch: 2 | loss: 0.5285187
	speed: 0.0144s/iter; left time: 101.8287s
	iters: 200, epoch: 2 | loss: 0.5288773
	speed: 0.0062s/iter; left time: 43.6582s
	iters: 300, epoch: 2 | loss: 0.5908084
	speed: 0.0059s/iter; left time: 40.7003s
	iters: 400, epoch: 2 | loss: 0.2558509
	speed: 0.0062s/iter; left time: 42.2648s
	iters: 500, epoch: 2 | loss: 0.3938504
	speed: 0.0060s/iter; left time: 40.3891s
	iters: 600, epoch: 2 | loss: 0.3397716
	speed: 0.0062s/iter; left time: 41.0533s
	iters: 700, epoch: 2 | loss: 0.8349261
	speed: 0.0060s/iter; left time: 39.0773s
	iters: 800, epoch: 2 | loss: 0.9480987
	speed: 0.0057s/iter; left time: 36.3219s
	iters: 900, epoch: 2 | loss: 0.4773791
	speed: 0.0056s/iter; left time: 35.2293s
	iters: 1000, epoch: 2 | loss: 0.9376332
	speed: 0.0058s/iter; left time: 35.8550s
Updating learning rate to 0.0005309373603
Validation loss decreased (0.4035 --> 0.4026).  Saving model state dict ...
Epoch: 2 cost time: 6.204425811767578
Epoch: 2, Steps: 1027 | Train Loss: 0.5835714 Vali Loss: 0.4025520 Best vali loss: 0.4025520
	iters: 100, epoch: 3 | loss: 0.7124619
	speed: 0.0176s/iter; left time: 106.8217s
	iters: 200, epoch: 3 | loss: 0.8505507
	speed: 0.0067s/iter; left time: 40.1486s
	iters: 300, epoch: 3 | loss: 0.3842628
	speed: 0.0069s/iter; left time: 40.5348s
	iters: 400, epoch: 3 | loss: 1.5393677
	speed: 0.0059s/iter; left time: 33.7518s
	iters: 500, epoch: 3 | loss: 0.4315800
	speed: 0.0059s/iter; left time: 33.5733s
	iters: 600, epoch: 3 | loss: 0.9332098
	speed: 0.0062s/iter; left time: 34.4291s
	iters: 700, epoch: 3 | loss: 1.8012486
	speed: 0.0063s/iter; left time: 34.1531s
	iters: 800, epoch: 3 | loss: 0.4708612
	speed: 0.0060s/iter; left time: 32.4340s
	iters: 900, epoch: 3 | loss: 0.4709560
	speed: 0.0059s/iter; left time: 31.3143s
	iters: 1000, epoch: 3 | loss: 0.5912541
	speed: 0.0060s/iter; left time: 30.9070s
Updating learning rate to 0.00026546868015
Epoch: 3 cost time: 6.4860522747039795
Epoch: 3, Steps: 1027 | Train Loss: 0.8185753 Vali Loss: 0.4034867 Best vali loss: 0.4025520

best validation loss 0.4025519916842635

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0047550092177, 'e_layers': 4, 'learning_rate': 0.0009477249465, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0009116543135108521
Validation loss decreased (inf --> 0.3820).  Saving model state dict ...
Epoch: 1 cost time: 0.8246357440948486
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3819611 Best vali loss: 0.3819611
Updating learning rate to 0.0008089338414349039
Validation loss decreased (0.3820 --> 0.3717).  Saving model state dict ...
Epoch: 2 cost time: 0.5268459320068359
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3716815 Best vali loss: 0.3716815
Updating learning rate to 0.0006552017909823206
Validation loss decreased (0.3717 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 0.5683679580688477
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3684166 Best vali loss: 0.3684166

best validation loss 0.36841663981701867

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0010127908578, 'e_layers': 1, 'learning_rate': 0.0003534066616, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8430119
	speed: 0.0095s/iter; left time: 37.9268s
	iters: 200, epoch: 1 | loss: 0.4441322
	speed: 0.0034s/iter; left time: 13.4232s
	iters: 300, epoch: 1 | loss: 0.6371640
	speed: 0.0036s/iter; left time: 13.6137s
	iters: 400, epoch: 1 | loss: 0.4190887
	speed: 0.0034s/iter; left time: 12.6496s
	iters: 500, epoch: 1 | loss: 0.8769950
	speed: 0.0033s/iter; left time: 11.7570s
Updating learning rate to 0.0003534066616
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 2.0682177543640137
Epoch: 1, Steps: 514 | Train Loss: 0.6440783 Vali Loss: 0.3708801 Best vali loss: 0.3708801
	iters: 100, epoch: 2 | loss: 0.7932359
	speed: 0.0099s/iter; left time: 34.6874s
	iters: 200, epoch: 2 | loss: 0.6952231
	speed: 0.0039s/iter; left time: 13.0970s
	iters: 300, epoch: 2 | loss: 0.9406952
	speed: 0.0038s/iter; left time: 12.4185s
	iters: 400, epoch: 2 | loss: 0.3007820
	speed: 0.0039s/iter; left time: 12.4343s
	iters: 500, epoch: 2 | loss: 0.4889834
	speed: 0.0035s/iter; left time: 10.7972s
Updating learning rate to 0.0001767033308
Epoch: 2 cost time: 2.0101637840270996
Epoch: 2, Steps: 514 | Train Loss: 0.6437839 Vali Loss: 0.3826400 Best vali loss: 0.3708801
	iters: 100, epoch: 3 | loss: 0.6033047
	speed: 0.0092s/iter; left time: 27.5772s
	iters: 200, epoch: 3 | loss: 0.3573340
	speed: 0.0034s/iter; left time: 9.7823s
	iters: 300, epoch: 3 | loss: 0.7081882
	speed: 0.0035s/iter; left time: 9.8006s
	iters: 400, epoch: 3 | loss: 0.3582876
	speed: 0.0040s/iter; left time: 10.6355s
	iters: 500, epoch: 3 | loss: 0.4363093
	speed: 0.0034s/iter; left time: 8.7123s
Updating learning rate to 8.83516654e-05
Epoch: 3 cost time: 1.8670480251312256
Epoch: 3, Steps: 514 | Train Loss: 0.4926848 Vali Loss: 0.3920096 Best vali loss: 0.3708801

best validation loss 0.37088005984227645

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0047550092177, 'e_layers': 4, 'learning_rate': 0.0009477249465, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.00047386247325
Epoch: 4 cost time: 0.831376314163208
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3733140 Best vali loss: 0.3684166
Updating learning rate to 0.00029252315551767945
Epoch: 5 cost time: 0.5665111541748047
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3774183 Best vali loss: 0.3684166
Updating learning rate to 0.00013879110506509603
Epoch: 6 cost time: 0.566089391708374
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3760338 Best vali loss: 0.3684166
Updating learning rate to 3.607063298914788e-05
Epoch: 7 cost time: 0.578479528427124
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3783863 Best vali loss: 0.3684166
Updating learning rate to 0.0
Epoch: 8 cost time: 0.5446445941925049
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3820665 Best vali loss: 0.3684166

best validation loss 0.36841663981701867

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.002837852389, 'e_layers': 4, 'learning_rate': 0.000309609584, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4415780
	speed: 0.0128s/iter; left time: 51.2873s
	iters: 200, epoch: 1 | loss: 0.6723873
	speed: 0.0065s/iter; left time: 25.4465s
	iters: 300, epoch: 1 | loss: 0.9051526
	speed: 0.0065s/iter; left time: 24.6806s
	iters: 400, epoch: 1 | loss: 1.4998525
	speed: 0.0062s/iter; left time: 22.8920s
	iters: 500, epoch: 1 | loss: 0.9853376
	speed: 0.0063s/iter; left time: 22.6789s
Updating learning rate to 0.000309609584
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 3.601067543029785
Epoch: 1, Steps: 514 | Train Loss: 0.9008616 Vali Loss: 0.3676058 Best vali loss: 0.3676058
	iters: 100, epoch: 2 | loss: 0.3636690
	speed: 0.0135s/iter; left time: 47.2381s
	iters: 200, epoch: 2 | loss: 0.7507890
	speed: 0.0065s/iter; left time: 22.2182s
	iters: 300, epoch: 2 | loss: 0.4346886
	speed: 0.0062s/iter; left time: 20.3601s
	iters: 400, epoch: 2 | loss: 0.9600622
	speed: 0.0065s/iter; left time: 20.6629s
	iters: 500, epoch: 2 | loss: 0.5553431
	speed: 0.0065s/iter; left time: 20.1619s
Updating learning rate to 0.000154804792
Epoch: 2 cost time: 3.3313589096069336
Epoch: 2, Steps: 514 | Train Loss: 0.6129104 Vali Loss: 0.3693295 Best vali loss: 0.3676058
	iters: 100, epoch: 3 | loss: 0.6063629
	speed: 0.0140s/iter; left time: 41.7410s
	iters: 200, epoch: 3 | loss: 0.7238364
	speed: 0.0064s/iter; left time: 18.5407s
	iters: 300, epoch: 3 | loss: 1.0200673
	speed: 0.0061s/iter; left time: 17.0643s
	iters: 400, epoch: 3 | loss: 0.3331935
	speed: 0.0063s/iter; left time: 17.0296s
	iters: 500, epoch: 3 | loss: 0.4594381
	speed: 0.0065s/iter; left time: 16.8787s
Updating learning rate to 7.7402396e-05
Epoch: 3 cost time: 3.3283071517944336
Epoch: 3, Steps: 514 | Train Loss: 0.6285797 Vali Loss: 0.3677366 Best vali loss: 0.3676058
	iters: 100, epoch: 4 | loss: 0.3310715
	speed: 0.0115s/iter; left time: 28.3961s
	iters: 200, epoch: 4 | loss: 0.5206885
	speed: 0.0071s/iter; left time: 16.7502s
	iters: 300, epoch: 4 | loss: 0.5809573
	speed: 0.0071s/iter; left time: 16.0964s
	iters: 400, epoch: 4 | loss: 0.9480150
	speed: 0.0069s/iter; left time: 15.0755s
	iters: 500, epoch: 4 | loss: 0.4264174
	speed: 0.0071s/iter; left time: 14.7944s
Updating learning rate to 3.8701198e-05
Epoch: 4 cost time: 3.613492250442505
Epoch: 4, Steps: 514 | Train Loss: 0.5614299 Vali Loss: 0.3774302 Best vali loss: 0.3676058
	iters: 100, epoch: 5 | loss: 0.4434311
	speed: 0.0143s/iter; left time: 27.9622s
	iters: 200, epoch: 5 | loss: 0.7163790
	speed: 0.0071s/iter; left time: 13.2393s
	iters: 300, epoch: 5 | loss: 0.4265864
	speed: 0.0072s/iter; left time: 12.6287s
	iters: 400, epoch: 5 | loss: 1.1882479
	speed: 0.0071s/iter; left time: 11.8143s
	iters: 500, epoch: 5 | loss: 0.3205344
	speed: 0.0069s/iter; left time: 10.7496s
Updating learning rate to 1.9350599e-05
Epoch: 5 cost time: 3.675477981567383
Epoch: 5, Steps: 514 | Train Loss: 0.6190358 Vali Loss: 0.3935950 Best vali loss: 0.3676058
	iters: 100, epoch: 6 | loss: 0.6409733
	speed: 0.0148s/iter; left time: 21.4136s
	iters: 200, epoch: 6 | loss: 0.5729976
	speed: 0.0069s/iter; left time: 9.3092s
	iters: 300, epoch: 6 | loss: 0.5272217
	speed: 0.0071s/iter; left time: 8.7994s
	iters: 400, epoch: 6 | loss: 0.6211973
	speed: 0.0069s/iter; left time: 7.9163s
	iters: 500, epoch: 6 | loss: 0.4554079
	speed: 0.0066s/iter; left time: 6.8685s
Updating learning rate to 9.6752995e-06
Epoch: 6 cost time: 3.601543426513672
Epoch: 6, Steps: 514 | Train Loss: 0.5635596 Vali Loss: 0.3906109 Best vali loss: 0.3676058
	iters: 100, epoch: 7 | loss: 1.0221971
	speed: 0.0140s/iter; left time: 13.0416s
	iters: 200, epoch: 7 | loss: 1.0489354
	speed: 0.0071s/iter; left time: 5.8804s
	iters: 300, epoch: 7 | loss: 0.5582007
	speed: 0.0072s/iter; left time: 5.2553s
	iters: 400, epoch: 7 | loss: 0.3607355
	speed: 0.0070s/iter; left time: 4.4325s
	iters: 500, epoch: 7 | loss: 0.2414203
	speed: 0.0068s/iter; left time: 3.6088s
Updating learning rate to 4.83764975e-06
Epoch: 7 cost time: 3.670625925064087
Epoch: 7, Steps: 514 | Train Loss: 0.6462978 Vali Loss: 0.3916980 Best vali loss: 0.3676058
	iters: 100, epoch: 8 | loss: 0.8003221
	speed: 0.0138s/iter; left time: 5.7177s
	iters: 200, epoch: 8 | loss: 0.2928601
	speed: 0.0070s/iter; left time: 2.2190s
	iters: 300, epoch: 8 | loss: 0.5236888
	speed: 0.0069s/iter; left time: 1.4820s
	iters: 400, epoch: 8 | loss: 0.3066821
	speed: 0.0070s/iter; left time: 0.7998s
	iters: 500, epoch: 8 | loss: 0.3447646
	speed: 0.0066s/iter; left time: 0.0996s
Updating learning rate to 2.418824875e-06
Epoch: 8 cost time: 3.5855679512023926
Epoch: 8, Steps: 514 | Train Loss: 0.4536635 Vali Loss: 0.3941871 Best vali loss: 0.3676058

best validation loss 0.36760575991189787

{'batch_size': 16, 'd_core': 64, 'd_model': 64, 'dropout': 0.0027808440321, 'e_layers': 3, 'learning_rate': 0.00233717616, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3916782
	speed: 0.0122s/iter; left time: 48.8693s
	iters: 200, epoch: 1 | loss: 0.7492173
	speed: 0.0062s/iter; left time: 24.1366s
	iters: 300, epoch: 1 | loss: 0.6926841
	speed: 0.0060s/iter; left time: 22.7255s
	iters: 400, epoch: 1 | loss: 1.2974528
	speed: 0.0059s/iter; left time: 21.7238s
	iters: 500, epoch: 1 | loss: 1.0828214
	speed: 0.0060s/iter; left time: 21.6917s
Updating learning rate to 0.002248222689048662
Validation loss decreased (inf --> 0.4064).  Saving model state dict ...
Epoch: 1 cost time: 3.403665542602539
Epoch: 1, Steps: 514 | Train Loss: 0.8427708 Vali Loss: 0.4064405 Best vali loss: 0.4064405
	iters: 100, epoch: 2 | loss: 0.5392482
	speed: 0.0127s/iter; left time: 44.5585s
	iters: 200, epoch: 2 | loss: 0.7923808
	speed: 0.0061s/iter; left time: 20.6326s
	iters: 300, epoch: 2 | loss: 0.6401269
	speed: 0.0059s/iter; left time: 19.5174s
	iters: 400, epoch: 2 | loss: 0.6868203
	speed: 0.0061s/iter; left time: 19.6056s
	iters: 500, epoch: 2 | loss: 1.3354108
	speed: 0.0061s/iter; left time: 18.8858s
Updating learning rate to 0.0019949046357817675
Validation loss decreased (0.4064 --> 0.3866).  Saving model state dict ...
Epoch: 2 cost time: 3.1640305519104004
Epoch: 2, Steps: 514 | Train Loss: 0.7987974 Vali Loss: 0.3865617 Best vali loss: 0.3865617
	iters: 100, epoch: 3 | loss: 1.2834529
	speed: 0.0127s/iter; left time: 37.8711s
	iters: 200, epoch: 3 | loss: 0.8580821
	speed: 0.0062s/iter; left time: 17.7743s
	iters: 300, epoch: 3 | loss: 0.9436807
	speed: 0.0059s/iter; left time: 16.3810s
	iters: 400, epoch: 3 | loss: 0.6851381
	speed: 0.0049s/iter; left time: 13.2153s
	iters: 500, epoch: 3 | loss: 0.5806923
	speed: 0.0041s/iter; left time: 10.6641s
Updating learning rate to 0.0016157873774753303
Validation loss decreased (0.3866 --> 0.3856).  Saving model state dict ...
Epoch: 3 cost time: 2.8220374584198
Epoch: 3, Steps: 514 | Train Loss: 0.8702092 Vali Loss: 0.3856336 Best vali loss: 0.3856336
	iters: 100, epoch: 4 | loss: 1.0549392
	speed: 0.0125s/iter; left time: 30.9101s
	iters: 200, epoch: 4 | loss: 0.5812010
	speed: 0.0068s/iter; left time: 16.0557s
	iters: 300, epoch: 4 | loss: 0.2623374
	speed: 0.0070s/iter; left time: 15.9593s
	iters: 400, epoch: 4 | loss: 0.8578139
	speed: 0.0067s/iter; left time: 14.4500s
	iters: 500, epoch: 4 | loss: 0.6989513
	speed: 0.0064s/iter; left time: 13.2928s
Updating learning rate to 0.00116858808
Validation loss decreased (0.3856 --> 0.3815).  Saving model state dict ...
Epoch: 4 cost time: 3.5016725063323975
Epoch: 4, Steps: 514 | Train Loss: 0.6910486 Vali Loss: 0.3814734 Best vali loss: 0.3814734
	iters: 100, epoch: 5 | loss: 0.8438125
	speed: 0.0142s/iter; left time: 27.6937s
	iters: 200, epoch: 5 | loss: 0.6280948
	speed: 0.0069s/iter; left time: 12.8400s
	iters: 300, epoch: 5 | loss: 0.3792402
	speed: 0.0068s/iter; left time: 11.9820s
	iters: 400, epoch: 5 | loss: 0.5574217
	speed: 0.0065s/iter; left time: 10.7721s
	iters: 500, epoch: 5 | loss: 0.9403976
	speed: 0.0060s/iter; left time: 9.3946s
Updating learning rate to 0.00072138878252467
Epoch: 5 cost time: 3.4849133491516113
Epoch: 5, Steps: 514 | Train Loss: 0.6697934 Vali Loss: 0.3848644 Best vali loss: 0.3814734
	iters: 100, epoch: 6 | loss: 0.3291945
	speed: 0.0146s/iter; left time: 21.0648s
	iters: 200, epoch: 6 | loss: 0.7895103
	speed: 0.0069s/iter; left time: 9.2080s
	iters: 300, epoch: 6 | loss: 0.3901492
	speed: 0.0068s/iter; left time: 8.4582s
	iters: 400, epoch: 6 | loss: 0.6669961
	speed: 0.0063s/iter; left time: 7.1780s
	iters: 500, epoch: 6 | loss: 0.5849685
	speed: 0.0044s/iter; left time: 4.5720s
Updating learning rate to 0.0003422715242182324
Epoch: 6 cost time: 3.218313455581665
Epoch: 6, Steps: 514 | Train Loss: 0.5521637 Vali Loss: 0.3881968 Best vali loss: 0.3814734
	iters: 100, epoch: 7 | loss: 0.4891787
	speed: 0.0095s/iter; left time: 8.8292s
	iters: 200, epoch: 7 | loss: 0.9620218
	speed: 0.0054s/iter; left time: 4.4412s
	iters: 300, epoch: 7 | loss: 0.3908659
	speed: 0.0054s/iter; left time: 3.9187s
	iters: 400, epoch: 7 | loss: 0.3951970
	speed: 0.0058s/iter; left time: 3.6347s
	iters: 500, epoch: 7 | loss: 1.3210237
	speed: 0.0055s/iter; left time: 2.9099s
Updating learning rate to 8.895347095133785e-05
Epoch: 7 cost time: 2.831603527069092
Epoch: 7, Steps: 514 | Train Loss: 0.7116574 Vali Loss: 0.3822261 Best vali loss: 0.3814734
	iters: 100, epoch: 8 | loss: 0.9454622
	speed: 0.0119s/iter; left time: 4.9448s
	iters: 200, epoch: 8 | loss: 0.5037442
	speed: 0.0052s/iter; left time: 1.6403s
	iters: 300, epoch: 8 | loss: 0.8878495
	speed: 0.0056s/iter; left time: 1.2012s
	iters: 400, epoch: 8 | loss: 0.5304144
	speed: 0.0052s/iter; left time: 0.5984s
	iters: 500, epoch: 8 | loss: 0.7723773
	speed: 0.0055s/iter; left time: 0.0820s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.816375970840454
Epoch: 8, Steps: 514 | Train Loss: 0.7279695 Vali Loss: 0.3907703 Best vali loss: 0.3814734

best validation loss 0.3814734112010255

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010686625021, 'e_layers': 4, 'learning_rate': 0.000475580227, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000475580227
Validation loss decreased (inf --> 0.3748).  Saving model state dict ...
Epoch: 1 cost time: 0.8692307472229004
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3748420 Best vali loss: 0.3748420
Updating learning rate to 0.0002377901135
Validation loss decreased (0.3748 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 0.6475036144256592
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3659040 Best vali loss: 0.3659040
Updating learning rate to 0.00011889505675
Validation loss decreased (0.3659 --> 0.3651).  Saving model state dict ...
Epoch: 3 cost time: 0.4896659851074219
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3651277 Best vali loss: 0.3651277

best validation loss 0.3651276525673557

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010119987189, 'e_layers': 2, 'learning_rate': 0.000883404728, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5753565
	speed: 0.0113s/iter; left time: 45.5000s
	iters: 200, epoch: 1 | loss: 0.3621132
	speed: 0.0053s/iter; left time: 20.6091s
	iters: 300, epoch: 1 | loss: 0.6700625
	speed: 0.0038s/iter; left time: 14.5726s
	iters: 400, epoch: 1 | loss: 0.7110271
	speed: 0.0032s/iter; left time: 11.9741s
	iters: 500, epoch: 1 | loss: 0.8176793
	speed: 0.0033s/iter; left time: 11.9526s
Updating learning rate to 0.0008497821375614502
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 2.415727138519287
Epoch: 1, Steps: 514 | Train Loss: 0.6272477 Vali Loss: 0.3697221 Best vali loss: 0.3697221
	iters: 100, epoch: 2 | loss: 0.5795566
	speed: 0.0126s/iter; left time: 44.2033s
	iters: 200, epoch: 2 | loss: 0.4003554
	speed: 0.0061s/iter; left time: 20.8094s
	iters: 300, epoch: 2 | loss: 0.3921636
	speed: 0.0061s/iter; left time: 20.0582s
	iters: 400, epoch: 2 | loss: 0.6489633
	speed: 0.0059s/iter; left time: 18.8721s
	iters: 500, epoch: 2 | loss: 1.3377185
	speed: 0.0049s/iter; left time: 15.1045s
Updating learning rate to 0.0007540331008505288
Epoch: 2 cost time: 2.9924559593200684
Epoch: 2, Steps: 514 | Train Loss: 0.6717515 Vali Loss: 0.3896063 Best vali loss: 0.3697221
	iters: 100, epoch: 3 | loss: 0.5316042
	speed: 0.0122s/iter; left time: 36.3755s
	iters: 200, epoch: 3 | loss: 0.6885605
	speed: 0.0063s/iter; left time: 18.0718s
	iters: 300, epoch: 3 | loss: 1.1583883
	speed: 0.0060s/iter; left time: 16.8467s
	iters: 400, epoch: 3 | loss: 0.3672598
	speed: 0.0060s/iter; left time: 16.0411s
	iters: 500, epoch: 3 | loss: 0.9813375
	speed: 0.0052s/iter; left time: 13.4755s
Updating learning rate to 0.0006107345407392943
Epoch: 3 cost time: 3.0497634410858154
Epoch: 3, Steps: 514 | Train Loss: 0.7454301 Vali Loss: 0.3843596 Best vali loss: 0.3697221

best validation loss 0.36972211292544144

{'batch_size': 128, 'd_core': 256, 'd_model': 128, 'dropout': 0.000943052393, 'e_layers': 2, 'learning_rate': 6.11157199e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 5.878964131515138e-05
Validation loss decreased (inf --> 0.4120).  Saving model state dict ...
Epoch: 1 cost time: 0.7636163234710693
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4120058 Best vali loss: 0.4120058
Updating learning rate to 5.216552993919382e-05
Validation loss decreased (0.4120 --> 0.3927).  Saving model state dict ...
Epoch: 2 cost time: 0.5010080337524414
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3926939 Best vali loss: 0.3926939
Updating learning rate to 4.2251846681397714e-05
Validation loss decreased (0.3927 --> 0.3820).  Saving model state dict ...
Epoch: 3 cost time: 0.4969480037689209
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3819863 Best vali loss: 0.3819863

best validation loss 0.38198627745238645

{'batch_size': 128, 'd_core': 32, 'd_model': 64, 'dropout': 0.0010686625021, 'e_layers': 4, 'learning_rate': 0.000475580227, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 5.9447528375e-05
Epoch: 4 cost time: 0.862468957901001
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3656638 Best vali loss: 0.3651277
Updating learning rate to 2.97237641875e-05
Validation loss decreased (0.3651 --> 0.3651).  Saving model state dict ...
Epoch: 5 cost time: 0.5812547206878662
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3650590 Best vali loss: 0.3650590
Updating learning rate to 1.486188209375e-05
Epoch: 6 cost time: 0.5782654285430908
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3654687 Best vali loss: 0.3650590
Updating learning rate to 7.430941046875e-06
Epoch: 7 cost time: 0.7102229595184326
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3656680 Best vali loss: 0.3650590
Updating learning rate to 3.7154705234375e-06
Epoch: 8 cost time: 0.575789213180542
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3657386 Best vali loss: 0.3650590

best validation loss 0.3650590177603461

{'batch_size': 8, 'd_core': 512, 'd_model': 64, 'dropout': 0.0087891353463, 'e_layers': 2, 'learning_rate': 0.0010704872737, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8247942
	speed: 0.0093s/iter; left time: 75.1239s
	iters: 200, epoch: 1 | loss: 0.8742175
	speed: 0.0029s/iter; left time: 23.0792s
	iters: 300, epoch: 1 | loss: 1.6943517
	speed: 0.0028s/iter; left time: 22.4843s
	iters: 400, epoch: 1 | loss: 0.6768503
	speed: 0.0030s/iter; left time: 23.3768s
	iters: 500, epoch: 1 | loss: 0.8883063
	speed: 0.0038s/iter; left time: 29.7102s
	iters: 600, epoch: 1 | loss: 0.1873490
	speed: 0.0033s/iter; left time: 25.0019s
	iters: 700, epoch: 1 | loss: 0.2398490
	speed: 0.0038s/iter; left time: 28.4496s
	iters: 800, epoch: 1 | loss: 0.4187678
	speed: 0.0036s/iter; left time: 27.0089s
	iters: 900, epoch: 1 | loss: 0.3474044
	speed: 0.0035s/iter; left time: 25.3403s
	iters: 1000, epoch: 1 | loss: 0.5365831
	speed: 0.0038s/iter; left time: 27.7115s
Updating learning rate to 0.001029744277842619
Validation loss decreased (inf --> 0.3697).  Saving model state dict ...
Epoch: 1 cost time: 3.801069498062134
Epoch: 1, Steps: 1027 | Train Loss: 0.6688473 Vali Loss: 0.3697281 Best vali loss: 0.3697281
	iters: 100, epoch: 2 | loss: 0.3293895
	speed: 0.0116s/iter; left time: 82.5300s
	iters: 200, epoch: 2 | loss: 0.2693889
	speed: 0.0035s/iter; left time: 24.6114s
	iters: 300, epoch: 2 | loss: 1.3688750
	speed: 0.0040s/iter; left time: 27.3868s
	iters: 400, epoch: 2 | loss: 1.1810458
	speed: 0.0037s/iter; left time: 25.0768s
	iters: 500, epoch: 2 | loss: 0.2791854
	speed: 0.0036s/iter; left time: 24.3148s
	iters: 600, epoch: 2 | loss: 0.2869512
	speed: 0.0030s/iter; left time: 20.0928s
	iters: 700, epoch: 2 | loss: 0.3430540
	speed: 0.0031s/iter; left time: 20.1095s
	iters: 800, epoch: 2 | loss: 0.3255873
	speed: 0.0041s/iter; left time: 26.4658s
	iters: 900, epoch: 2 | loss: 0.4312336
	speed: 0.0063s/iter; left time: 39.4552s
	iters: 1000, epoch: 2 | loss: 1.0300330
	speed: 0.0062s/iter; left time: 38.3072s
Updating learning rate to 0.0009137180420535848
Epoch: 2 cost time: 4.371482849121094
Epoch: 2, Steps: 1027 | Train Loss: 0.5844744 Vali Loss: 0.3713690 Best vali loss: 0.3697281
	iters: 100, epoch: 3 | loss: 0.4731962
	speed: 0.0192s/iter; left time: 116.2012s
	iters: 200, epoch: 3 | loss: 0.4182178
	speed: 0.0061s/iter; left time: 36.4830s
	iters: 300, epoch: 3 | loss: 0.5016481
	speed: 0.0062s/iter; left time: 36.3492s
	iters: 400, epoch: 3 | loss: 1.3429263
	speed: 0.0061s/iter; left time: 35.2270s
	iters: 500, epoch: 3 | loss: 0.2491921
	speed: 0.0062s/iter; left time: 34.9023s
	iters: 600, epoch: 3 | loss: 1.1919541
	speed: 0.0046s/iter; left time: 25.8634s
	iters: 700, epoch: 3 | loss: 0.3820022
	speed: 0.0045s/iter; left time: 24.8069s
	iters: 800, epoch: 3 | loss: 0.8648340
	speed: 0.0055s/iter; left time: 29.3948s
	iters: 900, epoch: 3 | loss: 0.2786088
	speed: 0.0061s/iter; left time: 32.2661s
	iters: 1000, epoch: 3 | loss: 0.3753270
	speed: 0.0057s/iter; left time: 29.5928s
Updating learning rate to 0.0007400725089513316
Epoch: 3 cost time: 5.929773569107056
Epoch: 3, Steps: 1027 | Train Loss: 0.6077907 Vali Loss: 0.3748352 Best vali loss: 0.3697281
	iters: 100, epoch: 4 | loss: 0.9485037
	speed: 0.0177s/iter; left time: 88.8925s
	iters: 200, epoch: 4 | loss: 0.7424136
	speed: 0.0053s/iter; left time: 26.0252s
	iters: 300, epoch: 4 | loss: 0.2895971
	speed: 0.0053s/iter; left time: 25.5770s
	iters: 400, epoch: 4 | loss: 0.4987016
	speed: 0.0055s/iter; left time: 25.9463s
	iters: 500, epoch: 4 | loss: 0.5818478
	speed: 0.0054s/iter; left time: 24.9465s
	iters: 600, epoch: 4 | loss: 0.8332624
	speed: 0.0053s/iter; left time: 24.1371s
	iters: 700, epoch: 4 | loss: 0.3495000
	speed: 0.0053s/iter; left time: 23.6842s
	iters: 800, epoch: 4 | loss: 0.9528949
	speed: 0.0040s/iter; left time: 17.5052s
	iters: 900, epoch: 4 | loss: 0.9095391
	speed: 0.0038s/iter; left time: 16.2555s
	iters: 1000, epoch: 4 | loss: 0.2813793
	speed: 0.0048s/iter; left time: 19.9007s
Updating learning rate to 0.00053524363685
Epoch: 4 cost time: 5.2276318073272705
Epoch: 4, Steps: 1027 | Train Loss: 0.6387640 Vali Loss: 0.3816368 Best vali loss: 0.3697281
	iters: 100, epoch: 5 | loss: 0.5616171
	speed: 0.0171s/iter; left time: 68.6705s
	iters: 200, epoch: 5 | loss: 0.3164616
	speed: 0.0054s/iter; left time: 21.2087s
	iters: 300, epoch: 5 | loss: 0.4175877
	speed: 0.0055s/iter; left time: 21.0277s
	iters: 400, epoch: 5 | loss: 0.7391385
	speed: 0.0054s/iter; left time: 20.0500s
	iters: 500, epoch: 5 | loss: 0.9529205
	speed: 0.0053s/iter; left time: 19.0557s
	iters: 600, epoch: 5 | loss: 0.3221997
	speed: 0.0055s/iter; left time: 19.1401s
	iters: 700, epoch: 5 | loss: 0.2255809
	speed: 0.0054s/iter; left time: 18.3807s
	iters: 800, epoch: 5 | loss: 0.2299847
	speed: 0.0054s/iter; left time: 17.7378s
	iters: 900, epoch: 5 | loss: 0.3715270
	speed: 0.0054s/iter; left time: 17.3062s
	iters: 1000, epoch: 5 | loss: 0.7906374
	speed: 0.0042s/iter; left time: 12.9247s
Updating learning rate to 0.0003304147647486684
Epoch: 5 cost time: 5.43097186088562
Epoch: 5, Steps: 1027 | Train Loss: 0.4927655 Vali Loss: 0.4001523 Best vali loss: 0.3697281
	iters: 100, epoch: 6 | loss: 0.9403645
	speed: 0.0164s/iter; left time: 48.8826s
	iters: 200, epoch: 6 | loss: 0.3735506
	speed: 0.0054s/iter; left time: 15.6869s
	iters: 300, epoch: 6 | loss: 1.1975118
	speed: 0.0055s/iter; left time: 15.2858s
	iters: 400, epoch: 6 | loss: 0.4320870
	speed: 0.0053s/iter; left time: 14.1396s
	iters: 500, epoch: 6 | loss: 0.8965776
	speed: 0.0052s/iter; left time: 13.4384s
	iters: 600, epoch: 6 | loss: 0.4455125
	speed: 0.0052s/iter; left time: 12.8254s
	iters: 700, epoch: 6 | loss: 1.0246718
	speed: 0.0052s/iter; left time: 12.3180s
	iters: 800, epoch: 6 | loss: 0.2247210
	speed: 0.0052s/iter; left time: 11.8442s
	iters: 900, epoch: 6 | loss: 0.3531107
	speed: 0.0051s/iter; left time: 11.0819s
	iters: 1000, epoch: 6 | loss: 0.7624653
	speed: 0.0051s/iter; left time: 10.5420s
Updating learning rate to 0.00015676923164641517
Epoch: 6 cost time: 5.481951713562012
Epoch: 6, Steps: 1027 | Train Loss: 0.6650573 Vali Loss: 0.3923899 Best vali loss: 0.3697281
	iters: 100, epoch: 7 | loss: 0.3334664
	speed: 0.0144s/iter; left time: 28.1618s
	iters: 200, epoch: 7 | loss: 0.3264859
	speed: 0.0064s/iter; left time: 11.8064s
	iters: 300, epoch: 7 | loss: 0.5117652
	speed: 0.0063s/iter; left time: 10.9757s
	iters: 400, epoch: 7 | loss: 0.1966017
	speed: 0.0064s/iter; left time: 10.6108s
	iters: 500, epoch: 7 | loss: 0.4619002
	speed: 0.0064s/iter; left time: 10.0034s
	iters: 600, epoch: 7 | loss: 0.7418018
	speed: 0.0065s/iter; left time: 9.4205s
	iters: 700, epoch: 7 | loss: 0.6040426
	speed: 0.0065s/iter; left time: 8.8081s
	iters: 800, epoch: 7 | loss: 0.3717451
	speed: 0.0063s/iter; left time: 7.8511s
	iters: 900, epoch: 7 | loss: 0.3933803
	speed: 0.0063s/iter; left time: 7.2865s
	iters: 1000, epoch: 7 | loss: 0.5641128
	speed: 0.0063s/iter; left time: 6.6152s
Updating learning rate to 4.0742995857381066e-05
Epoch: 7 cost time: 6.344471454620361
Epoch: 7, Steps: 1027 | Train Loss: 0.4505302 Vali Loss: 0.3946669 Best vali loss: 0.3697281
	iters: 100, epoch: 8 | loss: 0.3506460
	speed: 0.0147s/iter; left time: 13.6045s
	iters: 200, epoch: 8 | loss: 0.2730543
	speed: 0.0051s/iter; left time: 4.2520s
	iters: 300, epoch: 8 | loss: 0.3604797
	speed: 0.0056s/iter; left time: 4.0534s
	iters: 400, epoch: 8 | loss: 0.6539575
	speed: 0.0055s/iter; left time: 3.4454s
	iters: 500, epoch: 8 | loss: 0.2763609
	speed: 0.0051s/iter; left time: 2.6880s
	iters: 600, epoch: 8 | loss: 0.5432884
	speed: 0.0054s/iter; left time: 2.2984s
	iters: 700, epoch: 8 | loss: 0.2808711
	speed: 0.0053s/iter; left time: 1.7457s
	iters: 800, epoch: 8 | loss: 0.3184787
	speed: 0.0052s/iter; left time: 1.1820s
	iters: 900, epoch: 8 | loss: 0.3194388
	speed: 0.0051s/iter; left time: 0.6474s
	iters: 1000, epoch: 8 | loss: 1.0992788
	speed: 0.0054s/iter; left time: 0.1502s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.388036251068115
Epoch: 8, Steps: 1027 | Train Loss: 0.4475854 Vali Loss: 0.3936965 Best vali loss: 0.3697281

best validation loss 0.3697281048023865

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0052842772816, 'e_layers': 4, 'learning_rate': 9.30573825e-05, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9354277
	speed: 0.0137s/iter; left time: 55.0794s
	iters: 200, epoch: 1 | loss: 0.5768818
	speed: 0.0080s/iter; left time: 31.2252s
	iters: 300, epoch: 1 | loss: 0.6141761
	speed: 0.0078s/iter; left time: 29.5658s
	iters: 400, epoch: 1 | loss: 0.7754936
	speed: 0.0078s/iter; left time: 29.1090s
	iters: 500, epoch: 1 | loss: 1.0374517
	speed: 0.0079s/iter; left time: 28.6002s
Updating learning rate to 8.9515596770412e-05
Validation loss decreased (inf --> 0.3955).  Saving model state dict ...
Epoch: 1 cost time: 4.349743843078613
Epoch: 1, Steps: 514 | Train Loss: 0.7878862 Vali Loss: 0.3954800 Best vali loss: 0.3954800
	iters: 100, epoch: 2 | loss: 0.7873477
	speed: 0.0159s/iter; left time: 55.5872s
	iters: 200, epoch: 2 | loss: 0.3251329
	speed: 0.0080s/iter; left time: 27.2508s
	iters: 300, epoch: 2 | loss: 0.6417702
	speed: 0.0081s/iter; left time: 26.6659s
	iters: 400, epoch: 2 | loss: 0.3883814
	speed: 0.0076s/iter; left time: 24.2320s
	iters: 500, epoch: 2 | loss: 0.7489203
	speed: 0.0073s/iter; left time: 22.5251s
Updating learning rate to 7.942944435261018e-05
Validation loss decreased (0.3955 --> 0.3802).  Saving model state dict ...
Epoch: 2 cost time: 4.052024841308594
Epoch: 2, Steps: 514 | Train Loss: 0.5783105 Vali Loss: 0.3801887 Best vali loss: 0.3801887
	iters: 100, epoch: 3 | loss: 0.3720782
	speed: 0.0157s/iter; left time: 46.9603s
	iters: 200, epoch: 3 | loss: 0.5550148
	speed: 0.0079s/iter; left time: 22.8161s
	iters: 300, epoch: 3 | loss: 0.9459495
	speed: 0.0077s/iter; left time: 21.5193s
	iters: 400, epoch: 3 | loss: 0.4089284
	speed: 0.0078s/iter; left time: 21.0631s
	iters: 500, epoch: 3 | loss: 0.8569943
	speed: 0.0078s/iter; left time: 20.2417s
Updating learning rate to 6.433445052100552e-05
Validation loss decreased (0.3802 --> 0.3734).  Saving model state dict ...
Epoch: 3 cost time: 4.091002464294434
Epoch: 3, Steps: 514 | Train Loss: 0.6277931 Vali Loss: 0.3734411 Best vali loss: 0.3734411
	iters: 100, epoch: 4 | loss: 0.7557777
	speed: 0.0155s/iter; left time: 38.3870s
	iters: 200, epoch: 4 | loss: 0.9168444
	speed: 0.0077s/iter; left time: 18.2711s
	iters: 300, epoch: 4 | loss: 0.6976726
	speed: 0.0072s/iter; left time: 16.2918s
	iters: 400, epoch: 4 | loss: 0.3403010
	speed: 0.0046s/iter; left time: 10.0565s
	iters: 500, epoch: 4 | loss: 0.3206981
	speed: 0.0054s/iter; left time: 11.1397s
Updating learning rate to 4.652869125e-05
Validation loss decreased (0.3734 --> 0.3703).  Saving model state dict ...
Epoch: 4 cost time: 3.4035325050354004
Epoch: 4, Steps: 514 | Train Loss: 0.6062588 Vali Loss: 0.3702806 Best vali loss: 0.3702806
	iters: 100, epoch: 5 | loss: 0.5153858
	speed: 0.0112s/iter; left time: 21.8653s
	iters: 200, epoch: 5 | loss: 0.7863193
	speed: 0.0068s/iter; left time: 12.6358s
	iters: 300, epoch: 5 | loss: 0.4407453
	speed: 0.0067s/iter; left time: 11.7154s
	iters: 400, epoch: 5 | loss: 0.6847513
	speed: 0.0065s/iter; left time: 10.8022s
	iters: 500, epoch: 5 | loss: 0.9470364
	speed: 0.0066s/iter; left time: 10.3234s
Updating learning rate to 2.8722931978994484e-05
Validation loss decreased (0.3703 --> 0.3684).  Saving model state dict ...
Epoch: 5 cost time: 3.3753960132598877
Epoch: 5, Steps: 514 | Train Loss: 0.6748476 Vali Loss: 0.3684249 Best vali loss: 0.3684249
	iters: 100, epoch: 6 | loss: 0.8560714
	speed: 0.0143s/iter; left time: 20.6536s
	iters: 200, epoch: 6 | loss: 1.1141295
	speed: 0.0067s/iter; left time: 9.0092s
	iters: 300, epoch: 6 | loss: 1.0946084
	speed: 0.0069s/iter; left time: 8.5667s
	iters: 400, epoch: 6 | loss: 0.7918462
	speed: 0.0067s/iter; left time: 7.7100s
	iters: 500, epoch: 6 | loss: 0.5590227
	speed: 0.0069s/iter; left time: 7.2195s
Updating learning rate to 1.3627938147389826e-05
Validation loss decreased (0.3684 --> 0.3678).  Saving model state dict ...
Epoch: 6 cost time: 3.553903818130493
Epoch: 6, Steps: 514 | Train Loss: 0.8831357 Vali Loss: 0.3677654 Best vali loss: 0.3677654
	iters: 100, epoch: 7 | loss: 0.3830389
	speed: 0.0138s/iter; left time: 12.7873s
	iters: 200, epoch: 7 | loss: 0.7993697
	speed: 0.0068s/iter; left time: 5.6359s
	iters: 300, epoch: 7 | loss: 0.7029297
	speed: 0.0067s/iter; left time: 4.9033s
	iters: 400, epoch: 7 | loss: 0.5305125
	speed: 0.0069s/iter; left time: 4.3114s
	iters: 500, epoch: 7 | loss: 0.3877233
	speed: 0.0069s/iter; left time: 3.6626s
Updating learning rate to 3.541785729588002e-06
Validation loss decreased (0.3678 --> 0.3675).  Saving model state dict ...
Epoch: 7 cost time: 3.5717434883117676
Epoch: 7, Steps: 514 | Train Loss: 0.5607148 Vali Loss: 0.3675155 Best vali loss: 0.3675155
	iters: 100, epoch: 8 | loss: 1.0643803
	speed: 0.0142s/iter; left time: 5.9010s
	iters: 200, epoch: 8 | loss: 0.6715846
	speed: 0.0069s/iter; left time: 2.1670s
	iters: 300, epoch: 8 | loss: 0.3623682
	speed: 0.0065s/iter; left time: 1.3930s
	iters: 400, epoch: 8 | loss: 1.0095943
	speed: 0.0068s/iter; left time: 0.7864s
	iters: 500, epoch: 8 | loss: 0.4803658
	speed: 0.0069s/iter; left time: 0.1033s
Updating learning rate to 0.0
Validation loss decreased (0.3675 --> 0.3675).  Saving model state dict ...
Epoch: 8 cost time: 3.5463192462921143
Epoch: 8, Steps: 514 | Train Loss: 0.7176586 Vali Loss: 0.3674510 Best vali loss: 0.3674510

best validation loss 0.3674509688070106

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0094025534782, 'e_layers': 3, 'learning_rate': 7.57956321e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5560930
	speed: 0.0129s/iter; left time: 51.8944s
	iters: 200, epoch: 1 | loss: 0.7080647
	speed: 0.0070s/iter; left time: 27.4225s
	iters: 300, epoch: 1 | loss: 0.9408807
	speed: 0.0070s/iter; left time: 26.7175s
	iters: 400, epoch: 1 | loss: 0.7130060
	speed: 0.0069s/iter; left time: 25.4521s
	iters: 500, epoch: 1 | loss: 1.1071643
	speed: 0.0058s/iter; left time: 21.1067s
Updating learning rate to 7.291083262547274e-05
Validation loss decreased (inf --> 0.3642).  Saving model state dict ...
Epoch: 1 cost time: 3.77091121673584
Epoch: 1, Steps: 514 | Train Loss: 0.8050417 Vali Loss: 0.3641529 Best vali loss: 0.3641529
	iters: 100, epoch: 2 | loss: 0.7769160
	speed: 0.0105s/iter; left time: 36.7532s
	iters: 200, epoch: 2 | loss: 0.6155810
	speed: 0.0067s/iter; left time: 22.6127s
	iters: 300, epoch: 2 | loss: 0.2890072
	speed: 0.0083s/iter; left time: 27.2916s
	iters: 400, epoch: 2 | loss: 0.4148782
	speed: 0.0082s/iter; left time: 26.1066s
	iters: 500, epoch: 2 | loss: 0.7327245
	speed: 0.0082s/iter; left time: 25.3916s
Updating learning rate to 6.469561877111538e-05
Epoch: 2 cost time: 3.747981548309326
Epoch: 2, Steps: 514 | Train Loss: 0.5658214 Vali Loss: 0.3746721 Best vali loss: 0.3641529
	iters: 100, epoch: 3 | loss: 0.4633412
	speed: 0.0155s/iter; left time: 46.2618s
	iters: 200, epoch: 3 | loss: 0.5109330
	speed: 0.0079s/iter; left time: 22.7404s
	iters: 300, epoch: 3 | loss: 0.3087910
	speed: 0.0081s/iter; left time: 22.6316s
	iters: 400, epoch: 3 | loss: 0.2603259
	speed: 0.0082s/iter; left time: 21.9036s
	iters: 500, epoch: 3 | loss: 0.2690317
	speed: 0.0081s/iter; left time: 21.0362s
Updating learning rate to 5.2400682375154794e-05
Epoch: 3 cost time: 4.03354549407959
Epoch: 3, Steps: 514 | Train Loss: 0.3624846 Vali Loss: 0.3997596 Best vali loss: 0.3641529

best validation loss 0.36415293099603857

{'batch_size': 16, 'd_core': 128, 'd_model': 128, 'dropout': 0.0041376749186, 'e_layers': 2, 'learning_rate': 0.0013179784539, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2531197
	speed: 0.0124s/iter; left time: 49.6988s
	iters: 200, epoch: 1 | loss: 0.2987250
	speed: 0.0061s/iter; left time: 23.8340s
	iters: 300, epoch: 1 | loss: 0.7316051
	speed: 0.0062s/iter; left time: 23.5437s
	iters: 400, epoch: 1 | loss: 0.7096562
	speed: 0.0058s/iter; left time: 21.4550s
	iters: 500, epoch: 1 | loss: 0.7735599
	speed: 0.0046s/iter; left time: 16.7385s
Updating learning rate to 0.0012678158858745402
Validation loss decreased (inf --> 0.3753).  Saving model state dict ...
Epoch: 1 cost time: 3.277724504470825
Epoch: 1, Steps: 514 | Train Loss: 0.5533332 Vali Loss: 0.3753469 Best vali loss: 0.3753469
	iters: 100, epoch: 2 | loss: 0.4513829
	speed: 0.0076s/iter; left time: 26.4471s
	iters: 200, epoch: 2 | loss: 0.4034882
	speed: 0.0042s/iter; left time: 14.1783s
	iters: 300, epoch: 2 | loss: 0.6556468
	speed: 0.0046s/iter; left time: 15.1531s
	iters: 400, epoch: 2 | loss: 0.6211450
	speed: 0.0045s/iter; left time: 14.5082s
	iters: 500, epoch: 2 | loss: 0.5339324
	speed: 0.0051s/iter; left time: 15.8052s
Updating learning rate to 0.0011249649780552258
Epoch: 2 cost time: 2.281403064727783
Epoch: 2, Steps: 514 | Train Loss: 0.5331191 Vali Loss: 0.3818302 Best vali loss: 0.3753469
	iters: 100, epoch: 3 | loss: 0.6842152
	speed: 0.0112s/iter; left time: 33.3095s
	iters: 200, epoch: 3 | loss: 1.2072964
	speed: 0.0043s/iter; left time: 12.3047s
	iters: 300, epoch: 3 | loss: 0.6876169
	speed: 0.0031s/iter; left time: 8.6090s
	iters: 400, epoch: 3 | loss: 0.8280353
	speed: 0.0033s/iter; left time: 8.7671s
	iters: 500, epoch: 3 | loss: 0.6947058
	speed: 0.0040s/iter; left time: 10.4242s
Updating learning rate to 0.0009111734862108432
Epoch: 3 cost time: 2.1096878051757812
Epoch: 3, Steps: 514 | Train Loss: 0.8203739 Vali Loss: 0.3877674 Best vali loss: 0.3753469

best validation loss 0.3753469104616956

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0090051442195, 'e_layers': 1, 'learning_rate': 0.0005778764026, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.000555882291641696
Validation loss decreased (inf --> 0.3668).  Saving model state dict ...
Epoch: 1 cost time: 0.7064824104309082
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3667547 Best vali loss: 0.3667547
Updating learning rate to 0.0004932483627830737
Epoch: 2 cost time: 0.44147706031799316
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3697474 Best vali loss: 0.3667547
Updating learning rate to 0.00039951006391487925
Epoch: 3 cost time: 0.43953561782836914
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3826953 Best vali loss: 0.3667547

best validation loss 0.3667547498330152

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0094025534782, 'e_layers': 3, 'learning_rate': 7.57956321e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5240847
	speed: 0.0134s/iter; left time: 33.1937s
	iters: 200, epoch: 4 | loss: 0.6490502
	speed: 0.0062s/iter; left time: 14.8055s
	iters: 300, epoch: 4 | loss: 0.5849524
	speed: 0.0066s/iter; left time: 14.9219s
	iters: 400, epoch: 4 | loss: 0.6934592
	speed: 0.0070s/iter; left time: 15.2442s
	iters: 500, epoch: 4 | loss: 0.5495238
	speed: 0.0071s/iter; left time: 14.6659s
Updating learning rate to 3.789781605e-05
Epoch: 4 cost time: 3.789102792739868
Epoch: 4, Steps: 514 | Train Loss: 0.6002141 Vali Loss: 0.3734549 Best vali loss: 0.3641529
	iters: 100, epoch: 5 | loss: 0.6676936
	speed: 0.0144s/iter; left time: 28.1994s
	iters: 200, epoch: 5 | loss: 0.4932778
	speed: 0.0071s/iter; left time: 13.2235s
	iters: 300, epoch: 5 | loss: 0.2611339
	speed: 0.0069s/iter; left time: 12.1401s
	iters: 400, epoch: 5 | loss: 0.3136774
	speed: 0.0071s/iter; left time: 11.6848s
	iters: 500, epoch: 5 | loss: 0.5561677
	speed: 0.0070s/iter; left time: 10.8698s
Updating learning rate to 2.3394949724845215e-05
Epoch: 5 cost time: 3.667393207550049
Epoch: 5, Steps: 514 | Train Loss: 0.4583901 Vali Loss: 0.4111052 Best vali loss: 0.3641529
	iters: 100, epoch: 6 | loss: 0.3493468
	speed: 0.0141s/iter; left time: 20.4040s
	iters: 200, epoch: 6 | loss: 0.4661136
	speed: 0.0059s/iter; left time: 7.9762s
	iters: 300, epoch: 6 | loss: 0.2743033
	speed: 0.0071s/iter; left time: 8.7728s
	iters: 400, epoch: 6 | loss: 0.2198545
	speed: 0.0071s/iter; left time: 8.0774s
	iters: 500, epoch: 6 | loss: 0.2602397
	speed: 0.0071s/iter; left time: 7.4431s
Updating learning rate to 1.1100013328884624e-05
Epoch: 6 cost time: 3.4998128414154053
Epoch: 6, Steps: 514 | Train Loss: 0.3139716 Vali Loss: 0.4219232 Best vali loss: 0.3641529
	iters: 100, epoch: 7 | loss: 0.3869136
	speed: 0.0144s/iter; left time: 13.3627s
	iters: 200, epoch: 7 | loss: 0.7500302
	speed: 0.0071s/iter; left time: 5.8599s
	iters: 300, epoch: 7 | loss: 0.5588506
	speed: 0.0071s/iter; left time: 5.1723s
	iters: 400, epoch: 7 | loss: 0.5323414
	speed: 0.0071s/iter; left time: 4.4583s
	iters: 500, epoch: 7 | loss: 0.3390921
	speed: 0.0070s/iter; left time: 3.7010s
Updating learning rate to 2.8847994745272605e-06
Epoch: 7 cost time: 3.6730141639709473
Epoch: 7, Steps: 514 | Train Loss: 0.5134456 Vali Loss: 0.3956902 Best vali loss: 0.3641529
	iters: 100, epoch: 8 | loss: 0.2624701
	speed: 0.0132s/iter; left time: 5.4782s
	iters: 200, epoch: 8 | loss: 0.5479323
	speed: 0.0066s/iter; left time: 2.0788s
	iters: 300, epoch: 8 | loss: 0.4837424
	speed: 0.0071s/iter; left time: 1.5261s
	iters: 400, epoch: 8 | loss: 0.7278329
	speed: 0.0070s/iter; left time: 0.8050s
	iters: 500, epoch: 8 | loss: 0.3223687
	speed: 0.0072s/iter; left time: 0.1073s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.5677103996276855
Epoch: 8, Steps: 514 | Train Loss: 0.4688693 Vali Loss: 0.4054772 Best vali loss: 0.3641529

best validation loss 0.36415293099603857

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0035713197255, 'e_layers': 2, 'learning_rate': 0.0033793788609, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0032507589115434083
Validation loss decreased (inf --> 0.3727).  Saving model state dict ...
Epoch: 1 cost time: 0.7582793235778809
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3726796 Best vali loss: 0.3726796
Updating learning rate to 0.00288448028482043
Epoch: 2 cost time: 0.4804706573486328
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3783341 Best vali loss: 0.3726796
Updating learning rate to 0.0023363055813256195
Validation loss decreased (0.3727 --> 0.3701).  Saving model state dict ...
Epoch: 3 cost time: 0.544177770614624
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3701128 Best vali loss: 0.3701128
Updating learning rate to 0.00168968943045
Epoch: 4 cost time: 0.5266695022583008
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3941696 Best vali loss: 0.3701128
Updating learning rate to 0.0010430732795743804
Epoch: 5 cost time: 0.4694817066192627
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3755571 Best vali loss: 0.3701128
Updating learning rate to 0.0004948985760795698
Epoch: 6 cost time: 0.5016231536865234
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3834374 Best vali loss: 0.3701128
Updating learning rate to 0.00012861994935659164
Epoch: 7 cost time: 0.47062063217163086
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3902974 Best vali loss: 0.3701128
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4753596782684326
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3927606 Best vali loss: 0.3701128

best validation loss 0.37011276695489415

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.001716146484, 'e_layers': 4, 'learning_rate': 9.46281852e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8776189
	speed: 0.0132s/iter; left time: 106.9195s
	iters: 200, epoch: 1 | loss: 0.2828529
	speed: 0.0071s/iter; left time: 57.1338s
	iters: 300, epoch: 1 | loss: 0.9333724
	speed: 0.0065s/iter; left time: 51.7418s
	iters: 400, epoch: 1 | loss: 0.4932718
	speed: 0.0060s/iter; left time: 47.1861s
	iters: 500, epoch: 1 | loss: 0.3900927
	speed: 0.0049s/iter; left time: 37.4879s
	iters: 600, epoch: 1 | loss: 1.1419405
	speed: 0.0055s/iter; left time: 41.7660s
	iters: 700, epoch: 1 | loss: 0.1808132
	speed: 0.0067s/iter; left time: 50.1759s
	iters: 800, epoch: 1 | loss: 1.2093226
	speed: 0.0067s/iter; left time: 49.8683s
	iters: 900, epoch: 1 | loss: 0.2170581
	speed: 0.0065s/iter; left time: 47.9218s
	iters: 1000, epoch: 1 | loss: 1.4387454
	speed: 0.0062s/iter; left time: 44.5287s
Updating learning rate to 9.46281852e-05
Validation loss decreased (inf --> 0.3674).  Saving model state dict ...
Epoch: 1 cost time: 6.7992377281188965
Epoch: 1, Steps: 1027 | Train Loss: 0.7165088 Vali Loss: 0.3674095 Best vali loss: 0.3674095
	iters: 100, epoch: 2 | loss: 0.7105537
	speed: 0.0183s/iter; left time: 129.8742s
	iters: 200, epoch: 2 | loss: 0.6814741
	speed: 0.0064s/iter; left time: 44.8806s
	iters: 300, epoch: 2 | loss: 0.4564798
	speed: 0.0062s/iter; left time: 43.0261s
	iters: 400, epoch: 2 | loss: 1.0664450
	speed: 0.0065s/iter; left time: 44.1622s
	iters: 500, epoch: 2 | loss: 0.9986066
	speed: 0.0067s/iter; left time: 44.8708s
	iters: 600, epoch: 2 | loss: 0.2997828
	speed: 0.0066s/iter; left time: 43.4169s
	iters: 700, epoch: 2 | loss: 0.8384473
	speed: 0.0060s/iter; left time: 38.8574s
	iters: 800, epoch: 2 | loss: 0.5841190
	speed: 0.0063s/iter; left time: 40.1538s
	iters: 900, epoch: 2 | loss: 0.5247901
	speed: 0.0067s/iter; left time: 42.0512s
	iters: 1000, epoch: 2 | loss: 0.2993805
	speed: 0.0065s/iter; left time: 40.5391s
Updating learning rate to 4.73140926e-05
Epoch: 2 cost time: 6.704862117767334
Epoch: 2, Steps: 1027 | Train Loss: 0.6460079 Vali Loss: 0.3761696 Best vali loss: 0.3674095
	iters: 100, epoch: 3 | loss: 0.7824166
	speed: 0.0178s/iter; left time: 107.9309s
	iters: 200, epoch: 3 | loss: 0.6315294
	speed: 0.0070s/iter; left time: 41.5708s
	iters: 300, epoch: 3 | loss: 0.9413951
	speed: 0.0069s/iter; left time: 40.7200s
	iters: 400, epoch: 3 | loss: 0.7633981
	speed: 0.0064s/iter; left time: 36.7477s
	iters: 500, epoch: 3 | loss: 1.6464866
	speed: 0.0063s/iter; left time: 35.6430s
	iters: 600, epoch: 3 | loss: 0.9047069
	speed: 0.0065s/iter; left time: 36.0194s
	iters: 700, epoch: 3 | loss: 0.2445049
	speed: 0.0066s/iter; left time: 36.2916s
	iters: 800, epoch: 3 | loss: 0.4926535
	speed: 0.0066s/iter; left time: 35.2902s
	iters: 900, epoch: 3 | loss: 0.4640768
	speed: 0.0063s/iter; left time: 32.9064s
	iters: 1000, epoch: 3 | loss: 0.2600110
	speed: 0.0065s/iter; left time: 33.5158s
Updating learning rate to 2.36570463e-05
Validation loss decreased (0.3674 --> 0.3514).  Saving model state dict ...
Epoch: 3 cost time: 6.821869134902954
Epoch: 3, Steps: 1027 | Train Loss: 0.7131179 Vali Loss: 0.3514435 Best vali loss: 0.3514435
	iters: 100, epoch: 4 | loss: 0.3313015
	speed: 0.0182s/iter; left time: 91.4684s
	iters: 200, epoch: 4 | loss: 0.3840554
	speed: 0.0063s/iter; left time: 30.8736s
	iters: 300, epoch: 4 | loss: 0.3407132
	speed: 0.0071s/iter; left time: 34.2394s
	iters: 400, epoch: 4 | loss: 0.4050289
	speed: 0.0069s/iter; left time: 32.8345s
	iters: 500, epoch: 4 | loss: 0.7926340
	speed: 0.0070s/iter; left time: 32.2319s
	iters: 600, epoch: 4 | loss: 0.2753976
	speed: 0.0066s/iter; left time: 29.8375s
	iters: 700, epoch: 4 | loss: 0.2626542
	speed: 0.0054s/iter; left time: 24.1233s
	iters: 800, epoch: 4 | loss: 0.5963043
	speed: 0.0063s/iter; left time: 27.4274s
	iters: 900, epoch: 4 | loss: 0.2443740
	speed: 0.0071s/iter; left time: 30.0461s
	iters: 1000, epoch: 4 | loss: 0.3449942
	speed: 0.0070s/iter; left time: 29.1219s
Updating learning rate to 1.182852315e-05
Validation loss decreased (0.3514 --> 0.3500).  Saving model state dict ...
Epoch: 4 cost time: 6.825108289718628
Epoch: 4, Steps: 1027 | Train Loss: 0.3977457 Vali Loss: 0.3499829 Best vali loss: 0.3499829
	iters: 100, epoch: 5 | loss: 0.3634959
	speed: 0.0194s/iter; left time: 77.6151s
	iters: 200, epoch: 5 | loss: 0.3714805
	speed: 0.0068s/iter; left time: 26.4072s
	iters: 300, epoch: 5 | loss: 0.3091658
	speed: 0.0068s/iter; left time: 25.7793s
	iters: 400, epoch: 5 | loss: 0.4439760
	speed: 0.0067s/iter; left time: 25.0066s
	iters: 500, epoch: 5 | loss: 0.8362030
	speed: 0.0068s/iter; left time: 24.5468s
	iters: 600, epoch: 5 | loss: 0.2974952
	speed: 0.0066s/iter; left time: 23.0815s
	iters: 700, epoch: 5 | loss: 0.3270095
	speed: 0.0068s/iter; left time: 23.3314s
	iters: 800, epoch: 5 | loss: 1.0569489
	speed: 0.0070s/iter; left time: 23.3020s
	iters: 900, epoch: 5 | loss: 0.4779727
	speed: 0.0070s/iter; left time: 22.6033s
	iters: 1000, epoch: 5 | loss: 0.6414364
	speed: 0.0070s/iter; left time: 21.9072s
Updating learning rate to 5.914261575e-06
Epoch: 5 cost time: 7.077179431915283
Epoch: 5, Steps: 1027 | Train Loss: 0.5125184 Vali Loss: 0.3555328 Best vali loss: 0.3499829
	iters: 100, epoch: 6 | loss: 0.8065704
	speed: 0.0180s/iter; left time: 53.8051s
	iters: 200, epoch: 6 | loss: 0.6387583
	speed: 0.0067s/iter; left time: 19.4098s
	iters: 300, epoch: 6 | loss: 0.1793508
	speed: 0.0070s/iter; left time: 19.5282s
	iters: 400, epoch: 6 | loss: 0.7062311
	speed: 0.0068s/iter; left time: 18.1222s
	iters: 500, epoch: 6 | loss: 0.8525668
	speed: 0.0065s/iter; left time: 16.8578s
	iters: 600, epoch: 6 | loss: 0.4864664
	speed: 0.0061s/iter; left time: 15.2230s
	iters: 700, epoch: 6 | loss: 0.2983691
	speed: 0.0063s/iter; left time: 15.0865s
	iters: 800, epoch: 6 | loss: 0.2308824
	speed: 0.0066s/iter; left time: 15.1152s
	iters: 900, epoch: 6 | loss: 0.6482918
	speed: 0.0066s/iter; left time: 14.4848s
	iters: 1000, epoch: 6 | loss: 0.3016579
	speed: 0.0066s/iter; left time: 13.8296s
Updating learning rate to 2.9571307875e-06
Epoch: 6 cost time: 6.825547218322754
Epoch: 6, Steps: 1027 | Train Loss: 0.5149145 Vali Loss: 0.3564430 Best vali loss: 0.3499829
	iters: 100, epoch: 7 | loss: 0.2617186
	speed: 0.0188s/iter; left time: 36.8453s
	iters: 200, epoch: 7 | loss: 0.4021237
	speed: 0.0070s/iter; left time: 12.9494s
	iters: 300, epoch: 7 | loss: 0.1930213
	speed: 0.0066s/iter; left time: 11.5400s
	iters: 400, epoch: 7 | loss: 0.3017642
	speed: 0.0066s/iter; left time: 10.9685s
	iters: 500, epoch: 7 | loss: 0.3214023
	speed: 0.0062s/iter; left time: 9.7106s
	iters: 600, epoch: 7 | loss: 0.2341755
	speed: 0.0062s/iter; left time: 9.0858s
	iters: 700, epoch: 7 | loss: 0.4158522
	speed: 0.0066s/iter; left time: 8.9537s
	iters: 800, epoch: 7 | loss: 0.3779015
	speed: 0.0066s/iter; left time: 8.3276s
	iters: 900, epoch: 7 | loss: 0.7045859
	speed: 0.0067s/iter; left time: 7.7514s
	iters: 1000, epoch: 7 | loss: 0.7335927
	speed: 0.0068s/iter; left time: 7.1777s
Updating learning rate to 1.47856539375e-06
Epoch: 7 cost time: 6.85870361328125
Epoch: 7, Steps: 1027 | Train Loss: 0.3946138 Vali Loss: 0.3527142 Best vali loss: 0.3499829
	iters: 100, epoch: 8 | loss: 0.3570269
	speed: 0.0183s/iter; left time: 16.9841s
	iters: 200, epoch: 8 | loss: 0.4684525
	speed: 0.0067s/iter; left time: 5.5184s
	iters: 300, epoch: 8 | loss: 1.3814322
	speed: 0.0067s/iter; left time: 4.8535s
	iters: 400, epoch: 8 | loss: 0.3939238
	speed: 0.0065s/iter; left time: 4.0624s
	iters: 500, epoch: 8 | loss: 0.2620883
	speed: 0.0064s/iter; left time: 3.3839s
	iters: 600, epoch: 8 | loss: 0.2849487
	speed: 0.0065s/iter; left time: 2.7672s
	iters: 700, epoch: 8 | loss: 0.4132463
	speed: 0.0067s/iter; left time: 2.1841s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019016322338, 'e_layers': 3, 'learning_rate': 0.0002203212483, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8561570
	speed: 0.0108s/iter; left time: 87.3479s
	iters: 200, epoch: 1 | loss: 0.2610905
	speed: 0.0051s/iter; left time: 41.1950s
	iters: 300, epoch: 1 | loss: 0.5716017
	speed: 0.0051s/iter; left time: 40.7164s
	iters: 400, epoch: 1 | loss: 0.6292528
	speed: 0.0051s/iter; left time: 40.2262s
	iters: 500, epoch: 1 | loss: 0.5509624
	speed: 0.0053s/iter; left time: 40.9371s
	iters: 600, epoch: 1 | loss: 0.6821298
	speed: 0.0054s/iter; left time: 40.7950s
	iters: 700, epoch: 1 | loss: 0.3949172
	speed: 0.0056s/iter; left time: 42.3447s
	iters: 800, epoch: 1 | loss: 0.2384663
	speed: 0.0056s/iter; left time: 41.7018s
	iters: 900, epoch: 1 | loss: 0.9983435
	speed: 0.0056s/iter; left time: 41.3324s
	iters: 1000, epoch: 1 | loss: 0.2999197
	speed: 0.0057s/iter; left time: 40.9139s
Updating learning rate to 0.00021193577009085356
Validation loss decreased (inf --> 0.3599).  Saving model state dict ...
Epoch: 1 cost time: 5.822667360305786
Epoch: 1, Steps: 1027 | Train Loss: 0.5482841 Vali Loss: 0.3599188 Best vali loss: 0.3599188
	iters: 100, epoch: 2 | loss: 1.8521606
	speed: 0.0157s/iter; left time: 110.9603s
	iters: 200, epoch: 2 | loss: 0.2225731
	speed: 0.0056s/iter; left time: 39.4263s
	iters: 300, epoch: 2 | loss: 0.4452443
	speed: 0.0057s/iter; left time: 39.4706s
	iters: 400, epoch: 2 | loss: 0.4201260
	speed: 0.0057s/iter; left time: 38.4236s
	iters: 500, epoch: 2 | loss: 0.3239303
	speed: 0.0054s/iter; left time: 35.9009s
	iters: 600, epoch: 2 | loss: 1.2325857
	speed: 0.0052s/iter; left time: 34.0152s
	iters: 700, epoch: 2 | loss: 0.3621045
	speed: 0.0046s/iter; left time: 30.1659s
	iters: 800, epoch: 2 | loss: 0.6311973
	speed: 0.0049s/iter; left time: 31.1684s
	iters: 900, epoch: 2 | loss: 0.2964512
	speed: 0.0055s/iter; left time: 34.8709s
	iters: 1000, epoch: 2 | loss: 0.3538169
	speed: 0.0055s/iter; left time: 34.2743s
Updating learning rate to 0.00018805594850620754
Validation loss decreased (0.3599 --> 0.3578).  Saving model state dict ...
Epoch: 2 cost time: 5.5738325119018555
Epoch: 2, Steps: 1027 | Train Loss: 0.6140190 Vali Loss: 0.3577931 Best vali loss: 0.3577931
	iters: 100, epoch: 3 | loss: 0.3541096
	speed: 0.0170s/iter; left time: 102.8631s
	iters: 200, epoch: 3 | loss: 0.6425402
	speed: 0.0060s/iter; left time: 35.9186s
	iters: 300, epoch: 3 | loss: 0.6558417
	speed: 0.0059s/iter; left time: 34.6918s
	iters: 400, epoch: 3 | loss: 0.9249716
	speed: 0.0063s/iter; left time: 36.3225s
	iters: 500, epoch: 3 | loss: 0.3548107
	speed: 0.0061s/iter; left time: 34.4126s
	iters: 600, epoch: 3 | loss: 0.2086779
	speed: 0.0058s/iter; left time: 32.4009s
	iters: 700, epoch: 3 | loss: 0.6341136
	speed: 0.0056s/iter; left time: 30.4069s
	iters: 800, epoch: 3 | loss: 0.2230877
	speed: 0.0056s/iter; left time: 30.0714s
	iters: 900, epoch: 3 | loss: 0.1237684
	speed: 0.0056s/iter; left time: 29.2744s
	iters: 1000, epoch: 3 | loss: 0.2215327
	speed: 0.0057s/iter; left time: 29.6144s
Updating learning rate to 0.0001523172699112026
Validation loss decreased (0.3578 --> 0.3518).  Saving model state dict ...
Epoch: 3 cost time: 6.097934007644653
Epoch: 3, Steps: 1027 | Train Loss: 0.4343454 Vali Loss: 0.3517579 Best vali loss: 0.3517579

best validation loss 0.3517579334950869

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0011236842427, 'e_layers': 3, 'learning_rate': 0.0014870102392, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3272551
	speed: 0.0127s/iter; left time: 50.8246s
	iters: 200, epoch: 1 | loss: 0.6023312
	speed: 0.0070s/iter; left time: 27.2518s
	iters: 300, epoch: 1 | loss: 0.7681219
	speed: 0.0070s/iter; left time: 26.7194s
	iters: 400, epoch: 1 | loss: 0.9003576
	speed: 0.0070s/iter; left time: 25.8842s
	iters: 500, epoch: 1 | loss: 0.6468973
	speed: 0.0069s/iter; left time: 25.0535s
Updating learning rate to 0.0014304142819157963
Validation loss decreased (inf --> 0.4069).  Saving model state dict ...
Epoch: 1 cost time: 3.892329454421997
Epoch: 1, Steps: 514 | Train Loss: 0.6489926 Vali Loss: 0.4068940 Best vali loss: 0.4068940
	iters: 100, epoch: 2 | loss: 0.6612816
	speed: 0.0137s/iter; left time: 47.8906s
	iters: 200, epoch: 2 | loss: 0.4642536
	speed: 0.0052s/iter; left time: 17.8387s
	iters: 300, epoch: 2 | loss: 0.3614168
	speed: 0.0047s/iter; left time: 15.3825s
	iters: 400, epoch: 2 | loss: 0.4150277
	speed: 0.0064s/iter; left time: 20.3738s
	iters: 500, epoch: 2 | loss: 0.8309960
	speed: 0.0074s/iter; left time: 23.0327s
Updating learning rate to 0.001269242631516075
Validation loss decreased (0.4069 --> 0.4033).  Saving model state dict ...
Epoch: 2 cost time: 3.199655055999756
Epoch: 2, Steps: 514 | Train Loss: 0.5465952 Vali Loss: 0.4033428 Best vali loss: 0.4033428
	iters: 100, epoch: 3 | loss: 0.3289268
	speed: 0.0153s/iter; left time: 45.5988s
	iters: 200, epoch: 3 | loss: 0.2670808
	speed: 0.0074s/iter; left time: 21.4238s
	iters: 300, epoch: 3 | loss: 0.9096584
	speed: 0.0064s/iter; left time: 17.9259s
	iters: 400, epoch: 3 | loss: 0.3017790
	speed: 0.0071s/iter; left time: 19.1908s
	iters: 500, epoch: 3 | loss: 0.7112511
	speed: 0.0075s/iter; left time: 19.2845s
Updating learning rate to 0.0010280322107495447
Epoch: 3 cost time: 3.7260804176330566
Epoch: 3, Steps: 514 | Train Loss: 0.5037392 Vali Loss: 0.4339974 Best vali loss: 0.4033428

best validation loss 0.40334280923682253

{'batch_size': 64, 'd_core': 64, 'd_model': 64, 'dropout': 0.010197037822, 'e_layers': 1, 'learning_rate': 0.0018624452483, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0902467
	speed: 0.0111s/iter; left time: 10.3391s
Updating learning rate to 0.0018624452483
Validation loss decreased (inf --> 0.3718).  Saving model state dict ...
Epoch: 1 cost time: 0.9724135398864746
Epoch: 1, Steps: 129 | Train Loss: 1.0902467 Vali Loss: 0.3718372 Best vali loss: 0.3718372
	iters: 100, epoch: 2 | loss: 0.8018503
	speed: 0.0089s/iter; left time: 7.1430s
Updating learning rate to 0.00093122262415
Validation loss decreased (0.3718 --> 0.3675).  Saving model state dict ...
Epoch: 2 cost time: 0.7004725933074951
Epoch: 2, Steps: 129 | Train Loss: 0.8018503 Vali Loss: 0.3674936 Best vali loss: 0.3674936
	iters: 100, epoch: 3 | loss: 0.5380110
	speed: 0.0094s/iter; left time: 6.3332s
Updating learning rate to 0.000465611312075
Epoch: 3 cost time: 0.7071342468261719
Epoch: 3, Steps: 129 | Train Loss: 0.5380110 Vali Loss: 0.3786251 Best vali loss: 0.3674936

best validation loss 0.36749355876141304

{'batch_size': 8, 'd_core': 128, 'd_model': 512, 'dropout': 0.0019016322338, 'e_layers': 3, 'learning_rate': 0.0002203212483, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5630824
	speed: 0.0099s/iter; left time: 50.0718s
	iters: 200, epoch: 4 | loss: 0.2481821
	speed: 0.0037s/iter; left time: 18.4461s
	iters: 300, epoch: 4 | loss: 0.5418560
	speed: 0.0053s/iter; left time: 25.8431s
	iters: 400, epoch: 4 | loss: 0.3774926
	speed: 0.0057s/iter; left time: 26.8633s
	iters: 500, epoch: 4 | loss: 0.4703752
	speed: 0.0056s/iter; left time: 26.0849s
	iters: 600, epoch: 4 | loss: 0.5461060
	speed: 0.0050s/iter; left time: 22.6537s
	iters: 700, epoch: 4 | loss: 0.2395293
	speed: 0.0058s/iter; left time: 25.7929s
	iters: 800, epoch: 4 | loss: 0.2209993
	speed: 0.0053s/iter; left time: 22.7710s
	iters: 900, epoch: 4 | loss: 0.9431468
	speed: 0.0038s/iter; left time: 15.9197s
	iters: 1000, epoch: 4 | loss: 0.3045799
	speed: 0.0038s/iter; left time: 15.7704s
Updating learning rate to 0.00011016062415
Epoch: 4 cost time: 5.187014579772949
Epoch: 4, Steps: 1027 | Train Loss: 0.4455350 Vali Loss: 0.3581291 Best vali loss: 0.3517579
	iters: 100, epoch: 5 | loss: 1.1405710
	speed: 0.0145s/iter; left time: 58.0186s
	iters: 200, epoch: 5 | loss: 0.1758505
	speed: 0.0052s/iter; left time: 20.3122s
	iters: 300, epoch: 5 | loss: 0.3357287
	speed: 0.0052s/iter; left time: 19.9063s
	iters: 400, epoch: 5 | loss: 0.3932432
	speed: 0.0052s/iter; left time: 19.4247s
	iters: 500, epoch: 5 | loss: 0.2108451
	speed: 0.0052s/iter; left time: 18.6432s
	iters: 600, epoch: 5 | loss: 0.7216880
	speed: 0.0055s/iter; left time: 19.3590s
	iters: 700, epoch: 5 | loss: 0.2587336
	speed: 0.0056s/iter; left time: 19.1074s
	iters: 800, epoch: 5 | loss: 0.4237866
	speed: 0.0050s/iter; left time: 16.4605s
	iters: 900, epoch: 5 | loss: 0.2299750
	speed: 0.0052s/iter; left time: 16.5294s
	iters: 1000, epoch: 5 | loss: 0.3018095
	speed: 0.0049s/iter; left time: 15.1369s
Updating learning rate to 6.800397838879741e-05
Epoch: 5 cost time: 5.394130229949951
Epoch: 5, Steps: 1027 | Train Loss: 0.4192231 Vali Loss: 0.3633598 Best vali loss: 0.3517579
	iters: 100, epoch: 6 | loss: 0.2767018
	speed: 0.0151s/iter; left time: 44.9608s
	iters: 200, epoch: 6 | loss: 0.5249398
	speed: 0.0054s/iter; left time: 15.6308s
	iters: 300, epoch: 6 | loss: 0.4916649
	speed: 0.0051s/iter; left time: 14.2792s
	iters: 400, epoch: 6 | loss: 0.6049708
	speed: 0.0053s/iter; left time: 14.2119s
	iters: 500, epoch: 6 | loss: 0.2810613
	speed: 0.0052s/iter; left time: 13.4557s
	iters: 600, epoch: 6 | loss: 0.1470015
	speed: 0.0052s/iter; left time: 12.8958s
	iters: 700, epoch: 6 | loss: 0.2925447
	speed: 0.0056s/iter; left time: 13.2461s
	iters: 800, epoch: 6 | loss: 0.2174850
	speed: 0.0053s/iter; left time: 12.0808s
	iters: 900, epoch: 6 | loss: 0.1168137
	speed: 0.0046s/iter; left time: 9.9372s
	iters: 1000, epoch: 6 | loss: 0.1638173
	speed: 0.0045s/iter; left time: 9.4350s
Updating learning rate to 3.2265299793792456e-05
Epoch: 6 cost time: 5.3291943073272705
Epoch: 6, Steps: 1027 | Train Loss: 0.3117001 Vali Loss: 0.3845975 Best vali loss: 0.3517579
	iters: 100, epoch: 7 | loss: 0.5281842
	speed: 0.0155s/iter; left time: 30.2802s
	iters: 200, epoch: 7 | loss: 0.2785543
	speed: 0.0052s/iter; left time: 9.6141s
	iters: 300, epoch: 7 | loss: 0.4190379
	speed: 0.0050s/iter; left time: 8.8226s
	iters: 400, epoch: 7 | loss: 0.3618907
	speed: 0.0052s/iter; left time: 8.5541s
	iters: 500, epoch: 7 | loss: 0.1927122
	speed: 0.0052s/iter; left time: 8.1369s
	iters: 600, epoch: 7 | loss: 0.2557051
	speed: 0.0051s/iter; left time: 7.4305s
	iters: 700, epoch: 7 | loss: 0.1868758
	speed: 0.0052s/iter; left time: 7.0921s
	iters: 800, epoch: 7 | loss: 0.3959073
	speed: 0.0052s/iter; left time: 6.5266s
	iters: 900, epoch: 7 | loss: 0.3805210
	speed: 0.0049s/iter; left time: 5.7015s
	iters: 1000, epoch: 7 | loss: 0.1825753
	speed: 0.0044s/iter; left time: 4.6866s
Updating learning rate to 8.385478209146436e-06
Epoch: 7 cost time: 5.226060390472412
Epoch: 7, Steps: 1027 | Train Loss: 0.3181964 Vali Loss: 0.3909247 Best vali loss: 0.3517579
	iters: 100, epoch: 8 | loss: 0.1467814
	speed: 0.0139s/iter; left time: 12.9137s
	iters: 200, epoch: 8 | loss: 0.3710886
	speed: 0.0049s/iter; left time: 4.0912s
	iters: 300, epoch: 8 | loss: 0.3262450
	speed: 0.0061s/iter; left time: 4.4687s
	iters: 400, epoch: 8 | loss: 0.3815095
	speed: 0.0052s/iter; left time: 3.2507s
	iters: 500, epoch: 8 | loss: 0.5540754
	speed: 0.0059s/iter; left time: 3.1339s
	iters: 600, epoch: 8 | loss: 0.1992421
	speed: 0.0062s/iter; left time: 2.6531s
	iters: 700, epoch: 8 | loss: 0.2231560
	speed: 0.0055s/iter; left time: 1.8011s
	iters: 800, epoch: 8 | loss: 0.4964998
	speed: 0.0066s/iter; left time: 1.4995s
	iters: 900, epoch: 8 | loss: 0.2919354
	speed: 0.0047s/iter; left time: 0.6076s
	iters: 1000, epoch: 8 | loss: 0.2461420
	speed: 0.0041s/iter; left time: 0.1150s
Updating learning rate to 0.0
Epoch: 8 cost time: 5.721839666366577
Epoch: 8, Steps: 1027 | Train Loss: 0.3236675 Vali Loss: 0.3968747 Best vali loss: 0.3517579

best validation loss 0.3517579334950869

{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0033733476764, 'e_layers': 2, 'learning_rate': 0.0015215628629, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8250220
	speed: 0.0113s/iter; left time: 45.3071s
	iters: 200, epoch: 1 | loss: 0.7059627
	speed: 0.0052s/iter; left time: 20.3381s
	iters: 300, epoch: 1 | loss: 1.3877600
	speed: 0.0064s/iter; left time: 24.4066s
	iters: 400, epoch: 1 | loss: 0.9544650
	speed: 0.0049s/iter; left time: 18.0170s
	iters: 500, epoch: 1 | loss: 0.3255749
	speed: 0.0064s/iter; left time: 22.9560s
Updating learning rate to 0.0015215628629
Validation loss decreased (inf --> 0.3789).  Saving model state dict ...
Epoch: 1 cost time: 3.224606513977051
Epoch: 1, Steps: 514 | Train Loss: 0.8397569 Vali Loss: 0.3788917 Best vali loss: 0.3788917
	iters: 100, epoch: 2 | loss: 0.1848436
	speed: 0.0122s/iter; left time: 42.7867s
	iters: 200, epoch: 2 | loss: 0.7208418
	speed: 0.0049s/iter; left time: 16.6519s
	iters: 300, epoch: 2 | loss: 0.8806708
	speed: 0.0056s/iter; left time: 18.3597s
	iters: 400, epoch: 2 | loss: 0.7980753
	speed: 0.0054s/iter; left time: 17.2624s
	iters: 500, epoch: 2 | loss: 0.3661315
	speed: 0.0051s/iter; left time: 15.7504s
Updating learning rate to 0.00076078143145
Validation loss decreased (0.3789 --> 0.3701).  Saving model state dict ...
Epoch: 2 cost time: 2.8134267330169678
Epoch: 2, Steps: 514 | Train Loss: 0.5901126 Vali Loss: 0.3700961 Best vali loss: 0.3700961
	iters: 100, epoch: 3 | loss: 0.9766445
	speed: 0.0111s/iter; left time: 33.0127s
	iters: 200, epoch: 3 | loss: 0.2639982
	speed: 0.0056s/iter; left time: 16.1221s
	iters: 300, epoch: 3 | loss: 1.1079410
	speed: 0.0052s/iter; left time: 14.4882s
	iters: 400, epoch: 3 | loss: 0.3542928
	speed: 0.0051s/iter; left time: 13.8057s
	iters: 500, epoch: 3 | loss: 0.6418009
	speed: 0.0055s/iter; left time: 14.2161s
Updating learning rate to 0.000380390715725
Epoch: 3 cost time: 2.71955943107605
Epoch: 3, Steps: 514 | Train Loss: 0.6689355 Vali Loss: 0.3725233 Best vali loss: 0.3700961
	iters: 100, epoch: 4 | loss: 0.4283484
	speed: 0.0091s/iter; left time: 22.4539s
	iters: 200, epoch: 4 | loss: 0.7377731
	speed: 0.0037s/iter; left time: 8.8726s
	iters: 300, epoch: 4 | loss: 1.0013646
	speed: 0.0049s/iter; left time: 11.2297s
	iters: 400, epoch: 4 | loss: 0.4635027
	speed: 0.0053s/iter; left time: 11.4022s
	iters: 500, epoch: 4 | loss: 1.0161954
	speed: 0.0050s/iter; left time: 10.3244s
Updating learning rate to 0.0001901953578625
Epoch: 4 cost time: 2.364567518234253
Epoch: 4, Steps: 514 | Train Loss: 0.7294369 Vali Loss: 0.3770470 Best vali loss: 0.3700961
	iters: 100, epoch: 5 | loss: 0.9463594
	speed: 0.0113s/iter; left time: 22.0232s
	iters: 200, epoch: 5 | loss: 0.2597794
	speed: 0.0052s/iter; left time: 9.5814s
	iters: 300, epoch: 5 | loss: 0.6648452
	speed: 0.0044s/iter; left time: 7.7788s
	iters: 400, epoch: 5 | loss: 0.5596645
	speed: 0.0052s/iter; left time: 8.6406s
	iters: 500, epoch: 5 | loss: 0.8261985
	speed: 0.0049s/iter; left time: 7.6655s
Updating learning rate to 9.509767893125e-05
Epoch: 5 cost time: 2.5888350009918213
Epoch: 5, Steps: 514 | Train Loss: 0.6513694 Vali Loss: 0.3808997 Best vali loss: 0.3700961
	iters: 100, epoch: 6 | loss: 0.5241721
	speed: 0.0116s/iter; left time: 16.7286s
	iters: 200, epoch: 6 | loss: 1.0392128
	speed: 0.0051s/iter; left time: 6.9069s
	iters: 300, epoch: 6 | loss: 0.5144174
	speed: 0.0048s/iter; left time: 5.9285s
	iters: 400, epoch: 6 | loss: 0.3911079
	speed: 0.0043s/iter; left time: 4.9327s
	iters: 500, epoch: 6 | loss: 0.5748569
	speed: 0.0050s/iter; left time: 5.1956s
Updating learning rate to 4.7548839465625e-05
Epoch: 6 cost time: 2.584066867828369
Epoch: 6, Steps: 514 | Train Loss: 0.6087534 Vali Loss: 0.3857625 Best vali loss: 0.3700961
	iters: 100, epoch: 7 | loss: 0.9940474
	speed: 0.0108s/iter; left time: 10.0298s
	iters: 200, epoch: 7 | loss: 0.2848782
	speed: 0.0052s/iter; left time: 4.3512s
	iters: 300, epoch: 7 | loss: 0.7400962
	speed: 0.0051s/iter; left time: 3.7178s
	iters: 400, epoch: 7 | loss: 0.3552954
	speed: 0.0044s/iter; left time: 2.7979s
	iters: 500, epoch: 7 | loss: 0.2454495
	speed: 0.0048s/iter; left time: 2.5401s
Updating learning rate to 2.37744197328125e-05
Epoch: 7 cost time: 2.5344598293304443
Epoch: 7, Steps: 514 | Train Loss: 0.5239533 Vali Loss: 0.3847041 Best vali loss: 0.3700961
	iters: 100, epoch: 8 | loss: 0.6587622
	speed: 0.0113s/iter; left time: 4.6759s
	iters: 200, epoch: 8 | loss: 0.2717105
	speed: 0.0048s/iter; left time: 1.5137s
	iters: 300, epoch: 8 | loss: 0.4689915
	speed: 0.0050s/iter; left time: 1.0722s
	iters: 400, epoch: 8 | loss: 0.3796426
	speed: 0.0051s/iter; left time: 0.5888s
	iters: 500, epoch: 8 | loss: 0.3367200
	speed: 0.0040s/iter; left time: 0.0605s
Updating learning rate to 1.188720986640625e-05
Epoch: 8 cost time: 2.4663686752319336
Epoch: 8, Steps: 514 | Train Loss: 0.4231654 Vali Loss: 0.3871578 Best vali loss: 0.3700961

best validation loss 0.37009614513407524

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0055598166579, 'e_layers': 4, 'learning_rate': 0.0001468646066, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3237213
	speed: 0.0140s/iter; left time: 113.5016s
	iters: 200, epoch: 1 | loss: 1.6122494
	speed: 0.0083s/iter; left time: 66.8852s
	iters: 300, epoch: 1 | loss: 0.4312936
	speed: 0.0076s/iter; left time: 60.2639s
	iters: 400, epoch: 1 | loss: 0.6031788
	speed: 0.0066s/iter; left time: 51.7853s
	iters: 500, epoch: 1 | loss: 0.9295254
	speed: 0.0083s/iter; left time: 63.9921s
	iters: 600, epoch: 1 | loss: 0.5427194
	speed: 0.0084s/iter; left time: 63.9637s
	iters: 700, epoch: 1 | loss: 0.3448702
	speed: 0.0084s/iter; left time: 63.0223s
	iters: 800, epoch: 1 | loss: 1.2790656
	speed: 0.0059s/iter; left time: 43.4606s
	iters: 900, epoch: 1 | loss: 0.5179344
	speed: 0.0084s/iter; left time: 61.1196s
	iters: 1000, epoch: 1 | loss: 0.2947059
	speed: 0.0081s/iter; left time: 58.3221s
Updating learning rate to 0.00014127490534403102
Validation loss decreased (inf --> 0.3720).  Saving model state dict ...
Epoch: 1 cost time: 8.355923414230347
Epoch: 1, Steps: 1027 | Train Loss: 0.6879264 Vali Loss: 0.3719535 Best vali loss: 0.3719535
	iters: 100, epoch: 2 | loss: 1.4680980
	speed: 0.0183s/iter; left time: 129.9501s
	iters: 200, epoch: 2 | loss: 0.3017817
	speed: 0.0046s/iter; left time: 31.8323s
	iters: 300, epoch: 2 | loss: 0.7498181
	speed: 0.0080s/iter; left time: 54.8536s
	iters: 400, epoch: 2 | loss: 1.2344017
	speed: 0.0068s/iter; left time: 46.2134s
	iters: 500, epoch: 2 | loss: 0.3096074
	speed: 0.0085s/iter; left time: 56.8987s
	iters: 600, epoch: 2 | loss: 0.3891582
	speed: 0.0063s/iter; left time: 41.6024s
	iters: 700, epoch: 2 | loss: 0.4546718
	speed: 0.0083s/iter; left time: 53.5991s
	iters: 800, epoch: 2 | loss: 0.2404782
	speed: 0.0048s/iter; left time: 30.8266s
	iters: 900, epoch: 2 | loss: 0.3091424
	speed: 0.0048s/iter; left time: 29.8978s
	iters: 1000, epoch: 2 | loss: 0.4585860
	speed: 0.0058s/iter; left time: 36.0981s
Updating learning rate to 0.00012535678292157728
Validation loss decreased (0.3720 --> 0.3650).  Saving model state dict ...
Epoch: 2 cost time: 6.4468934535980225
Epoch: 2, Steps: 1027 | Train Loss: 0.5915744 Vali Loss: 0.3649503 Best vali loss: 0.3649503
	iters: 100, epoch: 3 | loss: 0.8581918
	speed: 0.0168s/iter; left time: 101.9063s
	iters: 200, epoch: 3 | loss: 1.6420268
	speed: 0.0062s/iter; left time: 36.7729s
	iters: 300, epoch: 3 | loss: 0.9500067
	speed: 0.0055s/iter; left time: 32.1171s
	iters: 400, epoch: 3 | loss: 1.7195698
	speed: 0.0063s/iter; left time: 36.1765s
	iters: 500, epoch: 3 | loss: 0.4503913
	speed: 0.0061s/iter; left time: 34.7783s
	iters: 600, epoch: 3 | loss: 0.3426494
	speed: 0.0052s/iter; left time: 29.0521s
	iters: 700, epoch: 3 | loss: 0.5447411
	speed: 0.0046s/iter; left time: 24.8899s
	iters: 800, epoch: 3 | loss: 0.3211333
	speed: 0.0059s/iter; left time: 31.7727s
	iters: 900, epoch: 3 | loss: 1.2395450
	speed: 0.0083s/iter; left time: 43.8603s
	iters: 1000, epoch: 3 | loss: 0.2506275
	speed: 0.0083s/iter; left time: 42.9276s
Updating learning rate to 0.00010153362917331831
Epoch: 3 cost time: 6.519508361816406
Epoch: 3, Steps: 1027 | Train Loss: 0.8318883 Vali Loss: 0.3696480 Best vali loss: 0.3649503
	iters: 100, epoch: 4 | loss: 0.2177098
	speed: 0.0223s/iter; left time: 112.1066s
	iters: 200, epoch: 4 | loss: 0.2276201
	speed: 0.0083s/iter; left time: 41.0435s
	iters: 300, epoch: 4 | loss: 0.5698406
	speed: 0.0084s/iter; left time: 40.5201s
	iters: 400, epoch: 4 | loss: 0.6252422
	speed: 0.0062s/iter; left time: 29.2396s
	iters: 500, epoch: 4 | loss: 0.4625960
	speed: 0.0085s/iter; left time: 39.2395s
	iters: 600, epoch: 4 | loss: 0.6670810
	speed: 0.0084s/iter; left time: 38.0429s
	iters: 700, epoch: 4 | loss: 0.7005932
	speed: 0.0083s/iter; left time: 37.0061s
	iters: 800, epoch: 4 | loss: 1.4827700
	speed: 0.0058s/iter; left time: 25.0196s
	iters: 900, epoch: 4 | loss: 0.3305026
	speed: 0.0079s/iter; left time: 33.3823s
	iters: 1000, epoch: 4 | loss: 0.6707954
	speed: 0.0079s/iter; left time: 32.5935s
Updating learning rate to 7.34323033e-05
Epoch: 4 cost time: 8.050317764282227
Epoch: 4, Steps: 1027 | Train Loss: 0.5954751 Vali Loss: 0.3703655 Best vali loss: 0.3649503
	iters: 100, epoch: 5 | loss: 0.7815126
	speed: 0.0212s/iter; left time: 84.7930s
	iters: 200, epoch: 5 | loss: 1.2006772
	speed: 0.0083s/iter; left time: 32.4560s
	iters: 300, epoch: 5 | loss: 0.4317038
	speed: 0.0085s/iter; left time: 32.3989s
	iters: 400, epoch: 5 | loss: 0.9761301
	speed: 0.0077s/iter; left time: 28.6934s
	iters: 500, epoch: 5 | loss: 0.2039415
	speed: 0.0053s/iter; left time: 18.9590s
	iters: 600, epoch: 5 | loss: 0.2669767
	speed: 0.0045s/iter; left time: 15.8677s
	iters: 700, epoch: 5 | loss: 0.2447160
	speed: 0.0048s/iter; left time: 16.3435s
	iters: 800, epoch: 5 | loss: 1.1564679
	speed: 0.0050s/iter; left time: 16.5601s
	iters: 900, epoch: 5 | loss: 1.1966611
	speed: 0.0053s/iter; left time: 16.8728s
	iters: 1000, epoch: 5 | loss: 0.5794218
	speed: 0.0056s/iter; left time: 17.4443s
Updating learning rate to 4.5330977426681694e-05
Epoch: 5 cost time: 6.42735481262207
Epoch: 5, Steps: 1027 | Train Loss: 0.7038209 Vali Loss: 0.3680236 Best vali loss: 0.3649503
	iters: 100, epoch: 6 | loss: 0.9883065
	speed: 0.0160s/iter; left time: 47.5751s
	iters: 200, epoch: 6 | loss: 0.4300345
	speed: 0.0056s/iter; left time: 16.2127s
	iters: 300, epoch: 6 | loss: 0.9943085
	speed: 0.0055s/iter; left time: 15.4326s
	iters: 400, epoch: 6 | loss: 0.3004923
	speed: 0.0057s/iter; left time: 15.4192s
	iters: 500, epoch: 6 | loss: 0.3301837
	speed: 0.0060s/iter; left time: 15.5181s
	iters: 600, epoch: 6 | loss: 1.0371119
	speed: 0.0045s/iter; left time: 11.1203s
	iters: 700, epoch: 6 | loss: 0.4707382
	speed: 0.0051s/iter; left time: 12.2216s
	iters: 800, epoch: 6 | loss: 0.4838312
	speed: 0.0079s/iter; left time: 17.9356s
	iters: 900, epoch: 6 | loss: 0.3554345
	speed: 0.0065s/iter; left time: 14.1173s
	iters: 1000, epoch: 6 | loss: 1.2279576
	speed: 0.0072s/iter; left time: 15.0251s
Updating learning rate to 2.150782367842271e-05
Epoch: 6 cost time: 6.2163169384002686
Epoch: 6, Steps: 1027 | Train Loss: 0.6618399 Vali Loss: 0.3674965 Best vali loss: 0.3649503
	iters: 100, epoch: 7 | loss: 0.6087704
	speed: 0.0215s/iter; left time: 42.0803s
	iters: 200, epoch: 7 | loss: 0.3303254
	speed: 0.0064s/iter; left time: 11.9158s
	iters: 300, epoch: 7 | loss: 0.3802714
	speed: 0.0075s/iter; left time: 13.0878s
	iters: 400, epoch: 7 | loss: 0.3240482
	speed: 0.0076s/iter; left time: 12.5960s
	iters: 500, epoch: 7 | loss: 0.2759417
	speed: 0.0064s/iter; left time: 9.9234s
	iters: 600, epoch: 7 | loss: 0.3500486
	speed: 0.0078s/iter; left time: 11.3317s
	iters: 700, epoch: 7 | loss: 0.7821648
	speed: 0.0069s/iter; left time: 9.4149s
	iters: 800, epoch: 7 | loss: 1.5084263
	speed: 0.0073s/iter; left time: 9.1942s
	iters: 900, epoch: 7 | loss: 0.6337167
	speed: 0.0047s/iter; left time: 5.4578s
	iters: 1000, epoch: 7 | loss: 0.3781382
	speed: 0.0046s/iter; left time: 4.8182s
Updating learning rate to 5.589701255968981e-06
Epoch: 7 cost time: 6.880452632904053
Epoch: 7, Steps: 1027 | Train Loss: 0.5571852 Vali Loss: 0.3654860 Best vali loss: 0.3649503
	iters: 100, epoch: 8 | loss: 0.6030953
	speed: 0.0168s/iter; left time: 15.6357s
	iters: 200, epoch: 8 | loss: 0.3349539
	speed: 0.0063s/iter; left time: 5.1823s
	iters: 300, epoch: 8 | loss: 0.2791511
	speed: 0.0062s/iter; left time: 4.5231s
	iters: 400, epoch: 8 | loss: 1.3097829
	speed: 0.0061s/iter; left time: 3.8336s
	iters: 500, epoch: 8 | loss: 0.3834646
	speed: 0.0062s/iter; left time: 3.2481s
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 64, 'd_model': 256, 'dropout': 0.0021747175015, 'e_layers': 3, 'learning_rate': 0.0045316959995, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4851221
	speed: 0.0119s/iter; left time: 47.5923s
	iters: 200, epoch: 1 | loss: 0.3540864
	speed: 0.0057s/iter; left time: 22.1952s
	iters: 300, epoch: 1 | loss: 0.9112312
	speed: 0.0055s/iter; left time: 21.0197s
	iters: 400, epoch: 1 | loss: 1.2410363
	speed: 0.0057s/iter; left time: 20.9981s
	iters: 500, epoch: 1 | loss: 0.6932758
	speed: 0.0054s/iter; left time: 19.6633s
Updating learning rate to 0.004359218590500664
Validation loss decreased (inf --> 0.4038).  Saving model state dict ...
Epoch: 1 cost time: 3.1807260513305664
Epoch: 1, Steps: 514 | Train Loss: 0.7369504 Vali Loss: 0.4038281 Best vali loss: 0.4038281
	iters: 100, epoch: 2 | loss: 0.3591823
	speed: 0.0124s/iter; left time: 43.5498s
	iters: 200, epoch: 2 | loss: 0.6961645
	speed: 0.0059s/iter; left time: 19.9427s
	iters: 300, epoch: 2 | loss: 0.6645900
	speed: 0.0054s/iter; left time: 17.8527s
	iters: 400, epoch: 2 | loss: 1.1883674
	speed: 0.0057s/iter; left time: 18.3009s
	iters: 500, epoch: 2 | loss: 1.0400411
	speed: 0.0055s/iter; left time: 16.9775s
Updating learning rate to 0.003868044485511199
Validation loss decreased (0.4038 --> 0.4022).  Saving model state dict ...
Epoch: 2 cost time: 2.9430277347564697
Epoch: 2, Steps: 514 | Train Loss: 0.7896691 Vali Loss: 0.4021625 Best vali loss: 0.4021625
	iters: 100, epoch: 3 | loss: 0.8389937
	speed: 0.0129s/iter; left time: 38.3844s
	iters: 200, epoch: 3 | loss: 0.3145173
	speed: 0.0055s/iter; left time: 15.9644s
	iters: 300, epoch: 3 | loss: 0.6392149
	speed: 0.0055s/iter; left time: 15.4031s
	iters: 400, epoch: 3 | loss: 0.3404897
	speed: 0.0056s/iter; left time: 15.1193s
	iters: 500, epoch: 3 | loss: 1.4136728
	speed: 0.0056s/iter; left time: 14.5194s
Updating learning rate to 0.003132950489511903
Epoch: 3 cost time: 2.933628797531128
Epoch: 3, Steps: 514 | Train Loss: 0.7093777 Vali Loss: 0.4028161 Best vali loss: 0.4021625

best validation loss 0.4021625496432449

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.001857404995, 'e_layers': 3, 'learning_rate': 0.0002113522207, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5479294
	speed: 0.0124s/iter; left time: 11.5728s
Updating learning rate to 0.0002113522207
Validation loss decreased (inf --> 0.3690).  Saving model state dict ...
Epoch: 1 cost time: 1.1586158275604248
Epoch: 1, Steps: 129 | Train Loss: 0.5479294 Vali Loss: 0.3690009 Best vali loss: 0.3690009
	iters: 100, epoch: 2 | loss: 0.8065608
	speed: 0.0117s/iter; left time: 9.3709s
Updating learning rate to 0.00010567611035
Validation loss decreased (0.3690 --> 0.3677).  Saving model state dict ...
Epoch: 2 cost time: 0.8848793506622314
Epoch: 2, Steps: 129 | Train Loss: 0.8065608 Vali Loss: 0.3677226 Best vali loss: 0.3677226
	iters: 100, epoch: 3 | loss: 0.5697898
	speed: 0.0114s/iter; left time: 7.6962s
Updating learning rate to 5.2838055175e-05
Validation loss decreased (0.3677 --> 0.3661).  Saving model state dict ...
Epoch: 3 cost time: 0.9324719905853271
Epoch: 3, Steps: 129 | Train Loss: 0.5697898 Vali Loss: 0.3661003 Best vali loss: 0.3661003

best validation loss 0.36610030733297755

{'batch_size': 8, 'd_core': 64, 'd_model': 32, 'dropout': 0.0027066824413, 'e_layers': 3, 'learning_rate': 0.0001110346081, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.2937554
	speed: 0.0111s/iter; left time: 90.0857s
	iters: 200, epoch: 1 | loss: 0.3261909
	speed: 0.0053s/iter; left time: 42.4165s
	iters: 300, epoch: 1 | loss: 0.6066971
	speed: 0.0055s/iter; left time: 43.4305s
	iters: 400, epoch: 1 | loss: 0.4039790
	speed: 0.0055s/iter; left time: 42.6687s
	iters: 500, epoch: 1 | loss: 0.3718225
	speed: 0.0054s/iter; left time: 41.6662s
	iters: 600, epoch: 1 | loss: 1.1531602
	speed: 0.0050s/iter; left time: 38.1978s
	iters: 700, epoch: 1 | loss: 1.1570032
	speed: 0.0053s/iter; left time: 39.8695s
	iters: 800, epoch: 1 | loss: 0.4524881
	speed: 0.0055s/iter; left time: 40.4910s
	iters: 900, epoch: 1 | loss: 1.0933771
	speed: 0.0055s/iter; left time: 40.1913s
	iters: 1000, epoch: 1 | loss: 1.0367253
	speed: 0.0055s/iter; left time: 39.5216s
Updating learning rate to 0.00010680860496200096
Validation loss decreased (inf --> 0.3837).  Saving model state dict ...
Epoch: 1 cost time: 5.830829381942749
Epoch: 1, Steps: 1027 | Train Loss: 0.6895199 Vali Loss: 0.3836933 Best vali loss: 0.3836933
	iters: 100, epoch: 2 | loss: 0.3211492
	speed: 0.0140s/iter; left time: 99.0527s
	iters: 200, epoch: 2 | loss: 1.4547035
	speed: 0.0041s/iter; left time: 28.3425s
	iters: 300, epoch: 2 | loss: 0.1770567
	speed: 0.0049s/iter; left time: 33.9787s
	iters: 400, epoch: 2 | loss: 1.5694354
	speed: 0.0051s/iter; left time: 34.4157s
	iters: 500, epoch: 2 | loss: 0.4037720
	speed: 0.0050s/iter; left time: 33.7719s
	iters: 600, epoch: 2 | loss: 0.4144379
	speed: 0.0051s/iter; left time: 33.3659s
	iters: 700, epoch: 2 | loss: 0.3515265
	speed: 0.0051s/iter; left time: 32.7867s
	iters: 800, epoch: 2 | loss: 1.3191946
	speed: 0.0047s/iter; left time: 29.8188s
	iters: 900, epoch: 2 | loss: 0.4226598
	speed: 0.0050s/iter; left time: 31.1512s
	iters: 1000, epoch: 2 | loss: 0.8549990
	speed: 0.0051s/iter; left time: 31.3037s
Updating learning rate to 9.477396621695037e-05
Validation loss decreased (0.3837 --> 0.3718).  Saving model state dict ...
Epoch: 2 cost time: 4.981305360794067
Epoch: 2, Steps: 1027 | Train Loss: 0.7288934 Vali Loss: 0.3717890 Best vali loss: 0.3717890
	iters: 100, epoch: 3 | loss: 0.9376176
	speed: 0.0154s/iter; left time: 93.6378s
	iters: 200, epoch: 3 | loss: 0.7834712
	speed: 0.0050s/iter; left time: 29.6163s
	iters: 300, epoch: 3 | loss: 0.7957411
	speed: 0.0054s/iter; left time: 31.6439s
	iters: 400, epoch: 3 | loss: 1.1493363
	speed: 0.0053s/iter; left time: 30.5906s
	iters: 500, epoch: 3 | loss: 0.2585949
	speed: 0.0053s/iter; left time: 29.8509s
	iters: 600, epoch: 3 | loss: 0.2812305
	speed: 0.0052s/iter; left time: 28.8630s
	iters: 700, epoch: 3 | loss: 0.9553491
	speed: 0.0050s/iter; left time: 27.4695s
	iters: 800, epoch: 3 | loss: 0.8737408
	speed: 0.0046s/iter; left time: 24.4683s
	iters: 900, epoch: 3 | loss: 0.8094155
	speed: 0.0039s/iter; left time: 20.5885s
	iters: 1000, epoch: 3 | loss: 0.4708515
	speed: 0.0045s/iter; left time: 23.0783s
Updating learning rate to 7.67628565195103e-05
Validation loss decreased (0.3718 --> 0.3696).  Saving model state dict ...
Epoch: 3 cost time: 5.180331230163574
Epoch: 3, Steps: 1027 | Train Loss: 0.7315349 Vali Loss: 0.3696097 Best vali loss: 0.3696097

best validation loss 0.36960974475021213

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.001857404995, 'e_layers': 3, 'learning_rate': 0.0002113522207, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5238630
	speed: 0.0125s/iter; left time: 6.8332s
Updating learning rate to 2.64190275875e-05
Epoch: 4 cost time: 1.198498249053955
Epoch: 4, Steps: 129 | Train Loss: 0.5238630 Vali Loss: 0.3680481 Best vali loss: 0.3661003
	iters: 100, epoch: 5 | loss: 0.7557404
	speed: 0.0117s/iter; left time: 4.8973s
Updating learning rate to 1.320951379375e-05
Epoch: 5 cost time: 0.8903112411499023
Epoch: 5, Steps: 129 | Train Loss: 0.7557404 Vali Loss: 0.3688029 Best vali loss: 0.3661003
	iters: 100, epoch: 6 | loss: 0.5415868
	speed: 0.0111s/iter; left time: 3.1875s
Updating learning rate to 6.604756896875e-06
Epoch: 6 cost time: 0.9086005687713623
Epoch: 6, Steps: 129 | Train Loss: 0.5415868 Vali Loss: 0.3688356 Best vali loss: 0.3661003
	iters: 100, epoch: 7 | loss: 0.5238945
	speed: 0.0112s/iter; left time: 1.7837s
Updating learning rate to 3.3023784484375e-06
Epoch: 7 cost time: 0.8911986351013184
Epoch: 7, Steps: 129 | Train Loss: 0.5238945 Vali Loss: 0.3689396 Best vali loss: 0.3661003
	iters: 100, epoch: 8 | loss: 0.5173239
	speed: 0.0120s/iter; left time: 0.3589s
Updating learning rate to 1.65118922421875e-06
Epoch: 8 cost time: 0.923224687576294
Epoch: 8, Steps: 129 | Train Loss: 0.5173239 Vali Loss: 0.3690765 Best vali loss: 0.3661003

best validation loss 0.36610030733297755

{'batch_size': 64, 'd_core': 256, 'd_model': 128, 'dropout': 0.0014282327355, 'e_layers': 4, 'learning_rate': 0.0011080068437, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5951136
	speed: 0.0137s/iter; left time: 12.7559s
Updating learning rate to 0.0010658358442384311
Validation loss decreased (inf --> 0.3740).  Saving model state dict ...
Epoch: 1 cost time: 1.3156907558441162
Epoch: 1, Steps: 129 | Train Loss: 0.5951136 Vali Loss: 0.3740200 Best vali loss: 0.3740200
	iters: 100, epoch: 2 | loss: 0.4640978
	speed: 0.0125s/iter; left time: 10.0879s
Updating learning rate to 0.0009457429982406865
Validation loss decreased (0.3740 --> 0.3645).  Saving model state dict ...
Epoch: 2 cost time: 1.004850149154663
Epoch: 2, Steps: 129 | Train Loss: 0.4640978 Vali Loss: 0.3644986 Best vali loss: 0.3644986
	iters: 100, epoch: 3 | loss: 0.7476647
	speed: 0.0129s/iter; left time: 8.6960s
Updating learning rate to 0.0007660113528655628
Epoch: 3 cost time: 1.0546517372131348
Epoch: 3, Steps: 129 | Train Loss: 0.7476647 Vali Loss: 0.3800797 Best vali loss: 0.3644986
	iters: 100, epoch: 4 | loss: 0.8926541
	speed: 0.0124s/iter; left time: 6.7526s
Updating learning rate to 0.00055400342185
Validation loss decreased (0.3645 --> 0.3584).  Saving model state dict ...
Epoch: 4 cost time: 1.0147314071655273
Epoch: 4, Steps: 129 | Train Loss: 0.8926541 Vali Loss: 0.3583920 Best vali loss: 0.3583920
	iters: 100, epoch: 5 | loss: 0.5950844
	speed: 0.0126s/iter; left time: 5.2631s
Updating learning rate to 0.00034199549083443727
Epoch: 5 cost time: 1.0268402099609375
Epoch: 5, Steps: 129 | Train Loss: 0.5950844 Vali Loss: 0.3648132 Best vali loss: 0.3583920
	iters: 100, epoch: 6 | loss: 0.6703564
	speed: 0.0124s/iter; left time: 3.5850s
Updating learning rate to 0.0001622638454593135
Validation loss decreased (0.3584 --> 0.3508).  Saving model state dict ...
Epoch: 6 cost time: 1.0784268379211426
Epoch: 6, Steps: 129 | Train Loss: 0.6703564 Vali Loss: 0.3508163 Best vali loss: 0.3508163
	iters: 100, epoch: 7 | loss: 0.3671684
	speed: 0.0109s/iter; left time: 1.7373s
Updating learning rate to 4.217099946156882e-05
Validation loss decreased (0.3508 --> 0.3489).  Saving model state dict ...
Epoch: 7 cost time: 0.761040210723877
Epoch: 7, Steps: 129 | Train Loss: 0.3671684 Vali Loss: 0.3488520 Best vali loss: 0.3488520
	iters: 100, epoch: 8 | loss: 0.2866989
	speed: 0.0095s/iter; left time: 0.2838s
Updating learning rate to 0.0
Validation loss decreased (0.3489 --> 0.3488).  Saving model state dict ...
Epoch: 8 cost time: 0.760540246963501
Epoch: 8, Steps: 129 | Train Loss: 0.2866989 Vali Loss: 0.3488265 Best vali loss: 0.3488265

best validation loss 0.34882647059052774

{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0014929082757, 'e_layers': 2, 'learning_rate': 0.0003483819796, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4733262
	speed: 0.0116s/iter; left time: 22.7872s
	iters: 200, epoch: 1 | loss: 0.5109178
	speed: 0.0052s/iter; left time: 9.6555s
Updating learning rate to 0.0003483819796
Validation loss decreased (inf --> 0.3712).  Saving model state dict ...
Epoch: 1 cost time: 1.7611780166625977
Epoch: 1, Steps: 257 | Train Loss: 0.4921220 Vali Loss: 0.3712159 Best vali loss: 0.3712159
	iters: 100, epoch: 2 | loss: 0.6258114
	speed: 0.0129s/iter; left time: 21.9399s
	iters: 200, epoch: 2 | loss: 0.6029615
	speed: 0.0051s/iter; left time: 8.1530s
Updating learning rate to 0.0001741909898
Validation loss decreased (0.3712 --> 0.3706).  Saving model state dict ...
Epoch: 2 cost time: 1.4472038745880127
Epoch: 2, Steps: 257 | Train Loss: 0.6143864 Vali Loss: 0.3705671 Best vali loss: 0.3705671
	iters: 100, epoch: 3 | loss: 0.5705013
	speed: 0.0127s/iter; left time: 18.3684s
	iters: 200, epoch: 3 | loss: 1.0599209
	speed: 0.0054s/iter; left time: 7.2087s
Updating learning rate to 8.70954949e-05
Validation loss decreased (0.3706 --> 0.3688).  Saving model state dict ...
Epoch: 3 cost time: 1.4844386577606201
Epoch: 3, Steps: 257 | Train Loss: 0.8152111 Vali Loss: 0.3688048 Best vali loss: 0.3688048
	iters: 100, epoch: 4 | loss: 0.8333731
	speed: 0.0127s/iter; left time: 15.0544s
	iters: 200, epoch: 4 | loss: 0.3215666
	speed: 0.0055s/iter; left time: 5.9623s
Updating learning rate to 4.354774745e-05
Epoch: 4 cost time: 1.4743969440460205
Epoch: 4, Steps: 257 | Train Loss: 0.5774698 Vali Loss: 0.3705730 Best vali loss: 0.3688048
	iters: 100, epoch: 5 | loss: 0.7468194
	speed: 0.0123s/iter; left time: 11.4540s
	iters: 200, epoch: 5 | loss: 0.5096784
	speed: 0.0061s/iter; left time: 5.0692s
Updating learning rate to 2.1773873725e-05
Epoch: 5 cost time: 1.5686516761779785
Epoch: 5, Steps: 257 | Train Loss: 0.6282489 Vali Loss: 0.3702474 Best vali loss: 0.3688048
	iters: 100, epoch: 6 | loss: 0.6346684
	speed: 0.0126s/iter; left time: 8.4717s
	iters: 200, epoch: 6 | loss: 0.7068461
	speed: 0.0057s/iter; left time: 3.2521s
Updating learning rate to 1.08869368625e-05
Epoch: 6 cost time: 1.5145263671875
Epoch: 6, Steps: 257 | Train Loss: 0.6707572 Vali Loss: 0.3705309 Best vali loss: 0.3688048
	iters: 100, epoch: 7 | loss: 0.6015146
	speed: 0.0123s/iter; left time: 5.1040s
	iters: 200, epoch: 7 | loss: 0.6375717
	speed: 0.0060s/iter; left time: 1.8980s
Updating learning rate to 5.44346843125e-06
Epoch: 7 cost time: 1.5293843746185303
Epoch: 7, Steps: 257 | Train Loss: 0.6195432 Vali Loss: 0.3707018 Best vali loss: 0.3688048
	iters: 100, epoch: 8 | loss: 0.6911781
	speed: 0.0127s/iter; left time: 2.0073s
	iters: 200, epoch: 8 | loss: 0.5610449
	speed: 0.0060s/iter; left time: 0.3463s
Updating learning rate to 2.721734215625e-06
Epoch: 8 cost time: 1.540194034576416
Epoch: 8, Steps: 257 | Train Loss: 0.6261115 Vali Loss: 0.3707198 Best vali loss: 0.3688048

best validation loss 0.3688047668905764

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0034203496068, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5807536
	speed: 0.0127s/iter; left time: 50.9139s
	iters: 200, epoch: 1 | loss: 0.4084626
	speed: 0.0074s/iter; left time: 28.7873s
	iters: 300, epoch: 1 | loss: 0.3460270
	speed: 0.0070s/iter; left time: 26.5652s
	iters: 400, epoch: 1 | loss: 1.0638480
	speed: 0.0070s/iter; left time: 25.9281s
	iters: 500, epoch: 1 | loss: 1.2856972
	speed: 0.0067s/iter; left time: 24.3347s
Updating learning rate to 0.00010354612400724207
Validation loss decreased (inf --> 0.3710).  Saving model state dict ...
Epoch: 1 cost time: 3.9134693145751953
Epoch: 1, Steps: 514 | Train Loss: 0.7369577 Vali Loss: 0.3710098 Best vali loss: 0.3710098
	iters: 100, epoch: 2 | loss: 0.5641701
	speed: 0.0138s/iter; left time: 48.1823s
	iters: 200, epoch: 2 | loss: 0.5884656
	speed: 0.0071s/iter; left time: 24.0907s
	iters: 300, epoch: 2 | loss: 0.2829905
	speed: 0.0072s/iter; left time: 23.8552s
	iters: 400, epoch: 2 | loss: 0.4759317
	speed: 0.0048s/iter; left time: 15.4806s
	iters: 500, epoch: 2 | loss: 0.9143962
	speed: 0.0043s/iter; left time: 13.2311s
Updating learning rate to 9.187908466784891e-05
Validation loss decreased (0.3710 --> 0.3599).  Saving model state dict ...
Epoch: 2 cost time: 3.145209789276123
Epoch: 2, Steps: 514 | Train Loss: 0.5651908 Vali Loss: 0.3598517 Best vali loss: 0.3598517
	iters: 100, epoch: 3 | loss: 0.6125820
	speed: 0.0129s/iter; left time: 38.6045s
	iters: 200, epoch: 3 | loss: 0.5351433
	speed: 0.0056s/iter; left time: 16.1943s
	iters: 300, epoch: 3 | loss: 0.4607107
	speed: 0.0055s/iter; left time: 15.1880s
	iters: 400, epoch: 3 | loss: 0.4681755
	speed: 0.0057s/iter; left time: 15.3640s
	iters: 500, epoch: 3 | loss: 0.3088520
	speed: 0.0055s/iter; left time: 14.2139s
Updating learning rate to 7.441812635926816e-05
Epoch: 3 cost time: 2.9217262268066406
Epoch: 3, Steps: 514 | Train Loss: 0.4770927 Vali Loss: 0.3663296 Best vali loss: 0.3598517

best validation loss 0.3598517395160756

{'batch_size': 64, 'd_core': 128, 'd_model': 256, 'dropout': 0.0016962635724, 'e_layers': 4, 'learning_rate': 0.0031070450739, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8397123
	speed: 0.0152s/iter; left time: 14.1710s
Updating learning rate to 0.0029887902121331143
Validation loss decreased (inf --> 0.4093).  Saving model state dict ...
Epoch: 1 cost time: 1.4490959644317627
Epoch: 1, Steps: 129 | Train Loss: 0.8397123 Vali Loss: 0.4093119 Best vali loss: 0.4093119
	iters: 100, epoch: 2 | loss: 0.7346663
	speed: 0.0144s/iter; left time: 11.5959s
Updating learning rate to 0.002652028857553474
Validation loss decreased (0.4093 --> 0.3973).  Saving model state dict ...
Epoch: 2 cost time: 1.1482701301574707
Epoch: 2, Steps: 129 | Train Loss: 0.7346663 Vali Loss: 0.3973307 Best vali loss: 0.3973307
	iters: 100, epoch: 3 | loss: 0.8570649
	speed: 0.0142s/iter; left time: 9.5995s
Updating learning rate to 0.002148029873646548
Epoch: 3 cost time: 1.1113922595977783
Epoch: 3, Steps: 129 | Train Loss: 0.8570649 Vali Loss: 0.4165463 Best vali loss: 0.3973307

best validation loss 0.3973307310832273

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0090271357217, 'e_layers': 3, 'learning_rate': 5.47188441e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3996370
	speed: 0.0130s/iter; left time: 25.3741s
	iters: 200, epoch: 1 | loss: 0.8887193
	speed: 0.0065s/iter; left time: 12.0819s
Updating learning rate to 5.263623210333299e-05
Validation loss decreased (inf --> 0.3835).  Saving model state dict ...
Epoch: 1 cost time: 2.000129461288452
Epoch: 1, Steps: 257 | Train Loss: 0.6441781 Vali Loss: 0.3834548 Best vali loss: 0.3834548
	iters: 100, epoch: 2 | loss: 0.7458197
	speed: 0.0138s/iter; left time: 23.4043s
	iters: 200, epoch: 2 | loss: 0.3944555
	speed: 0.0060s/iter; left time: 9.6124s
Updating learning rate to 4.670545491089975e-05
Validation loss decreased (0.3835 --> 0.3693).  Saving model state dict ...
Epoch: 2 cost time: 1.4918475151062012
Epoch: 2, Steps: 257 | Train Loss: 0.5701376 Vali Loss: 0.3692543 Best vali loss: 0.3692543
	iters: 100, epoch: 3 | loss: 0.4879425
	speed: 0.0114s/iter; left time: 16.4267s
	iters: 200, epoch: 3 | loss: 0.3716043
	speed: 0.0072s/iter; left time: 9.6901s
Updating learning rate to 3.7829419587619125e-05
Validation loss decreased (0.3693 --> 0.3653).  Saving model state dict ...
Epoch: 3 cost time: 1.7532150745391846
Epoch: 3, Steps: 257 | Train Loss: 0.4297734 Vali Loss: 0.3653403 Best vali loss: 0.3653403

best validation loss 0.3653403289425818

{'batch_size': 16, 'd_core': 64, 'd_model': 512, 'dropout': 0.0034203496068, 'e_layers': 3, 'learning_rate': 0.0001076430434, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5646603
	speed: 0.0123s/iter; left time: 30.3991s
	iters: 200, epoch: 4 | loss: 0.3797682
	speed: 0.0059s/iter; left time: 13.9809s
	iters: 300, epoch: 4 | loss: 0.3217209
	speed: 0.0056s/iter; left time: 12.7979s
	iters: 400, epoch: 4 | loss: 0.8202684
	speed: 0.0055s/iter; left time: 11.9008s
	iters: 500, epoch: 4 | loss: 0.7036058
	speed: 0.0056s/iter; left time: 11.5616s
Updating learning rate to 5.38215217e-05
Epoch: 4 cost time: 3.2415530681610107
Epoch: 4, Steps: 514 | Train Loss: 0.5580047 Vali Loss: 0.3606207 Best vali loss: 0.3598517
	iters: 100, epoch: 5 | loss: 0.5219166
	speed: 0.0125s/iter; left time: 24.5435s
	iters: 200, epoch: 5 | loss: 0.4622870
	speed: 0.0057s/iter; left time: 10.6135s
	iters: 300, epoch: 5 | loss: 0.2749976
	speed: 0.0054s/iter; left time: 9.4059s
	iters: 400, epoch: 5 | loss: 0.3926918
	speed: 0.0055s/iter; left time: 9.1231s
	iters: 500, epoch: 5 | loss: 0.7084752
	speed: 0.0061s/iter; left time: 9.5307s
Updating learning rate to 3.3224917040731837e-05
Epoch: 5 cost time: 2.948982000350952
Epoch: 5, Steps: 514 | Train Loss: 0.4720736 Vali Loss: 0.3671438 Best vali loss: 0.3598517
	iters: 100, epoch: 6 | loss: 0.5313918
	speed: 0.0129s/iter; left time: 18.5753s
	iters: 200, epoch: 6 | loss: 0.4670139
	speed: 0.0054s/iter; left time: 7.3133s
	iters: 300, epoch: 6 | loss: 0.4414991
	speed: 0.0054s/iter; left time: 6.7739s
	iters: 400, epoch: 6 | loss: 0.3558626
	speed: 0.0056s/iter; left time: 6.4382s
	iters: 500, epoch: 6 | loss: 0.2980141
	speed: 0.0054s/iter; left time: 5.6439s
Updating learning rate to 1.5763958732151084e-05
Validation loss decreased (0.3599 --> 0.3593).  Saving model state dict ...
Epoch: 6 cost time: 2.8889753818511963
Epoch: 6, Steps: 514 | Train Loss: 0.4187563 Vali Loss: 0.3593435 Best vali loss: 0.3593435
	iters: 100, epoch: 7 | loss: 1.1572720
	speed: 0.0137s/iter; left time: 12.7004s
	iters: 200, epoch: 7 | loss: 0.5280414
	speed: 0.0052s/iter; left time: 4.3229s
	iters: 300, epoch: 7 | loss: 0.4350215
	speed: 0.0041s/iter; left time: 2.9819s
	iters: 400, epoch: 7 | loss: 0.6601743
	speed: 0.0049s/iter; left time: 3.1107s
	iters: 500, epoch: 7 | loss: 0.4621341
	speed: 0.0073s/iter; left time: 3.8656s
Updating learning rate to 4.096919392757925e-06
Epoch: 7 cost time: 2.9030921459198
Epoch: 7, Steps: 514 | Train Loss: 0.6485287 Vali Loss: 0.3714742 Best vali loss: 0.3593435
	iters: 100, epoch: 8 | loss: 0.6045521
	speed: 0.0151s/iter; left time: 6.2789s
	iters: 200, epoch: 8 | loss: 0.2899940
	speed: 0.0068s/iter; left time: 2.1437s
	iters: 300, epoch: 8 | loss: 0.2973683
	speed: 0.0066s/iter; left time: 1.4118s
	iters: 400, epoch: 8 | loss: 0.3660701
	speed: 0.0077s/iter; left time: 0.8810s
	iters: 500, epoch: 8 | loss: 0.5417516
	speed: 0.0052s/iter; left time: 0.0782s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.4888384342193604
Epoch: 8, Steps: 514 | Train Loss: 0.4199472 Vali Loss: 0.3668764 Best vali loss: 0.3593435

best validation loss 0.3593434691897544

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0062587438156, 'e_layers': 1, 'learning_rate': 0.0016392436863, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4075948
	speed: 0.0105s/iter; left time: 9.7831s
Updating learning rate to 0.0016392436863
Validation loss decreased (inf --> 0.3666).  Saving model state dict ...
Epoch: 1 cost time: 0.9320387840270996
Epoch: 1, Steps: 129 | Train Loss: 0.4075948 Vali Loss: 0.3665817 Best vali loss: 0.3665817
	iters: 100, epoch: 2 | loss: 0.5236234
	speed: 0.0093s/iter; left time: 7.5031s
Updating learning rate to 0.00081962184315
Epoch: 2 cost time: 0.7188067436218262
Epoch: 2, Steps: 129 | Train Loss: 0.5236234 Vali Loss: 0.3674312 Best vali loss: 0.3665817
	iters: 100, epoch: 3 | loss: 0.5667368
	speed: 0.0087s/iter; left time: 5.8415s
Updating learning rate to 0.000409810921575
Epoch: 3 cost time: 0.6507494449615479
Epoch: 3, Steps: 129 | Train Loss: 0.5667368 Vali Loss: 0.3707802 Best vali loss: 0.3665817
	iters: 100, epoch: 4 | loss: 0.6292698
	speed: 0.0090s/iter; left time: 4.9072s
Updating learning rate to 0.0002049054607875
Epoch: 4 cost time: 0.6839590072631836
Epoch: 4, Steps: 129 | Train Loss: 0.6292698 Vali Loss: 0.3798509 Best vali loss: 0.3665817
	iters: 100, epoch: 5 | loss: 0.5319270
	speed: 0.0098s/iter; left time: 4.0691s
Updating learning rate to 0.00010245273039375
Epoch: 5 cost time: 0.7906303405761719
Epoch: 5, Steps: 129 | Train Loss: 0.5319270 Vali Loss: 0.3785840 Best vali loss: 0.3665817
	iters: 100, epoch: 6 | loss: 0.5326728
	speed: 0.0101s/iter; left time: 2.9090s
Updating learning rate to 5.1226365196875e-05
Epoch: 6 cost time: 0.736220121383667
Epoch: 6, Steps: 129 | Train Loss: 0.5326728 Vali Loss: 0.3786082 Best vali loss: 0.3665817
	iters: 100, epoch: 7 | loss: 0.6176124
	speed: 0.0097s/iter; left time: 1.5345s
Updating learning rate to 2.56131825984375e-05
Epoch: 7 cost time: 0.7490990161895752
Epoch: 7, Steps: 129 | Train Loss: 0.6176124 Vali Loss: 0.3778147 Best vali loss: 0.3665817
	iters: 100, epoch: 8 | loss: 0.4688690
	speed: 0.0092s/iter; left time: 0.2753s
Updating learning rate to 1.280659129921875e-05
Epoch: 8 cost time: 0.7110617160797119
Epoch: 8, Steps: 129 | Train Loss: 0.4688690 Vali Loss: 0.3772085 Best vali loss: 0.3665817

best validation loss 0.3665817253130592

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0010633276881, 'e_layers': 4, 'learning_rate': 0.0001600989607, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7896714
	speed: 0.0145s/iter; left time: 13.5324s
Updating learning rate to 0.00015400555683352943
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 1.4187042713165283
Epoch: 1, Steps: 129 | Train Loss: 0.7896714 Vali Loss: 0.3653242 Best vali loss: 0.3653242
	iters: 100, epoch: 2 | loss: 0.5984651
	speed: 0.0137s/iter; left time: 11.0184s
Updating learning rate to 0.0001366530107359443
Validation loss decreased (0.3653 --> 0.3620).  Saving model state dict ...
Epoch: 2 cost time: 1.082366704940796
Epoch: 2, Steps: 129 | Train Loss: 0.5984651 Vali Loss: 0.3620340 Best vali loss: 0.3620340
	iters: 100, epoch: 3 | loss: 0.4918405
	speed: 0.0136s/iter; left time: 9.1796s
Updating learning rate to 0.00011068309024937981
Validation loss decreased (0.3620 --> 0.3611).  Saving model state dict ...
Epoch: 3 cost time: 1.0957956314086914
Epoch: 3, Steps: 129 | Train Loss: 0.4918405 Vali Loss: 0.3610815 Best vali loss: 0.3610815
	iters: 100, epoch: 4 | loss: 0.7002193
	speed: 0.0138s/iter; left time: 7.5520s
Updating learning rate to 8.004948035e-05
Validation loss decreased (0.3611 --> 0.3573).  Saving model state dict ...
Epoch: 4 cost time: 1.08846116065979
Epoch: 4, Steps: 129 | Train Loss: 0.7002193 Vali Loss: 0.3573254 Best vali loss: 0.3573254
	iters: 100, epoch: 5 | loss: 0.6106489
	speed: 0.0139s/iter; left time: 5.7804s
Updating learning rate to 4.94158704506202e-05
Validation loss decreased (0.3573 --> 0.3532).  Saving model state dict ...
Epoch: 5 cost time: 1.121429681777954
Epoch: 5, Steps: 129 | Train Loss: 0.6106489 Vali Loss: 0.3531712 Best vali loss: 0.3531712
	iters: 100, epoch: 6 | loss: 0.6378980
	speed: 0.0134s/iter; left time: 3.8486s
Updating learning rate to 2.344594996405572e-05
Epoch: 6 cost time: 1.0692589282989502
Epoch: 6, Steps: 129 | Train Loss: 0.6378980 Vali Loss: 0.3730971 Best vali loss: 0.3531712
	iters: 100, epoch: 7 | loss: 0.5760872
	speed: 0.0137s/iter; left time: 2.1772s
Updating learning rate to 6.093403866470566e-06
Epoch: 7 cost time: 1.0801618099212646
Epoch: 7, Steps: 129 | Train Loss: 0.5760872 Vali Loss: 0.3655048 Best vali loss: 0.3531712
	iters: 100, epoch: 8 | loss: 0.6051084
	speed: 0.0128s/iter; left time: 0.3848s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.057305097579956
Epoch: 8, Steps: 129 | Train Loss: 0.6051084 Vali Loss: 0.3617965 Best vali loss: 0.3531712

best validation loss 0.35317119226474425

{'batch_size': 8, 'd_core': 64, 'd_model': 256, 'dropout': 0.0010605591593, 'e_layers': 2, 'learning_rate': 0.0016136112128, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4083102
	speed: 0.0095s/iter; left time: 77.1525s
	iters: 200, epoch: 1 | loss: 1.1220034
	speed: 0.0035s/iter; left time: 28.4258s
	iters: 300, epoch: 1 | loss: 0.3118789
	speed: 0.0034s/iter; left time: 26.5981s
	iters: 400, epoch: 1 | loss: 0.2681603
	speed: 0.0029s/iter; left time: 23.0164s
	iters: 500, epoch: 1 | loss: 0.3065337
	speed: 0.0029s/iter; left time: 22.6297s
	iters: 600, epoch: 1 | loss: 0.5326870
	speed: 0.0030s/iter; left time: 23.0306s
	iters: 700, epoch: 1 | loss: 0.5046018
	speed: 0.0036s/iter; left time: 27.0318s
	iters: 800, epoch: 1 | loss: 1.1849051
	speed: 0.0037s/iter; left time: 27.3940s
	iters: 900, epoch: 1 | loss: 0.9702619
	speed: 0.0035s/iter; left time: 25.7403s
	iters: 1000, epoch: 1 | loss: 0.4323581
	speed: 0.0036s/iter; left time: 25.8076s
Updating learning rate to 0.0015521967928683173
Validation loss decreased (inf --> 0.4203).  Saving model state dict ...
Epoch: 1 cost time: 3.7696499824523926
Epoch: 1, Steps: 1027 | Train Loss: 0.6041701 Vali Loss: 0.4203219 Best vali loss: 0.4203219
	iters: 100, epoch: 2 | loss: 0.3486005
	speed: 0.0120s/iter; left time: 85.2774s
	iters: 200, epoch: 2 | loss: 0.2835325
	speed: 0.0040s/iter; left time: 28.0402s
	iters: 300, epoch: 2 | loss: 0.4663768
	speed: 0.0040s/iter; left time: 27.8480s
	iters: 400, epoch: 2 | loss: 0.4369492
	speed: 0.0041s/iter; left time: 27.6571s
	iters: 500, epoch: 2 | loss: 0.3205584
	speed: 0.0039s/iter; left time: 26.1212s
	iters: 600, epoch: 2 | loss: 0.5506597
	speed: 0.0038s/iter; left time: 24.9331s
	iters: 700, epoch: 2 | loss: 0.6126224
	speed: 0.0038s/iter; left time: 24.9476s
	iters: 800, epoch: 2 | loss: 0.3464227
	speed: 0.0037s/iter; left time: 23.8046s
	iters: 900, epoch: 2 | loss: 0.3688947
	speed: 0.0035s/iter; left time: 21.9355s
	iters: 1000, epoch: 2 | loss: 2.4863558
	speed: 0.0037s/iter; left time: 23.1260s
Updating learning rate to 0.0013773033217847647
Validation loss decreased (0.4203 --> 0.3982).  Saving model state dict ...
Epoch: 2 cost time: 3.9858429431915283
Epoch: 2, Steps: 1027 | Train Loss: 0.6220973 Vali Loss: 0.3981789 Best vali loss: 0.3981789
	iters: 100, epoch: 3 | loss: 0.9502113
	speed: 0.0121s/iter; left time: 73.0914s
	iters: 200, epoch: 3 | loss: 0.3545110
	speed: 0.0039s/iter; left time: 23.2449s
	iters: 300, epoch: 3 | loss: 0.3525625
	speed: 0.0037s/iter; left time: 21.6245s
	iters: 400, epoch: 3 | loss: 0.4075012
	speed: 0.0038s/iter; left time: 21.6330s
	iters: 500, epoch: 3 | loss: 0.9073424
	speed: 0.0036s/iter; left time: 20.1684s
	iters: 600, epoch: 3 | loss: 0.2620950
	speed: 0.0031s/iter; left time: 17.1116s
	iters: 700, epoch: 3 | loss: 0.3773429
	speed: 0.0030s/iter; left time: 16.5130s
	iters: 800, epoch: 3 | loss: 0.7320439
	speed: 0.0034s/iter; left time: 18.4748s
	iters: 900, epoch: 3 | loss: 0.4726085
	speed: 0.0037s/iter; left time: 19.6426s
	iters: 1000, epoch: 3 | loss: 0.3069021
	speed: 0.0043s/iter; left time: 22.3337s
Updating learning rate to 0.0011155567451085497
Epoch: 3 cost time: 3.7924869060516357
Epoch: 3, Steps: 1027 | Train Loss: 0.5123121 Vali Loss: 0.4044280 Best vali loss: 0.3981789

best validation loss 0.3981789479321253

{'batch_size': 8, 'd_core': 512, 'd_model': 128, 'dropout': 0.0067814173664, 'e_layers': 1, 'learning_rate': 0.000231549543, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3417107
	speed: 0.0087s/iter; left time: 70.2729s
	iters: 200, epoch: 1 | loss: 0.9829011
	speed: 0.0030s/iter; left time: 24.2368s
	iters: 300, epoch: 1 | loss: 0.2189472
	speed: 0.0028s/iter; left time: 22.1153s
	iters: 400, epoch: 1 | loss: 0.2128518
	speed: 0.0028s/iter; left time: 21.8548s
	iters: 500, epoch: 1 | loss: 0.3963828
	speed: 0.0028s/iter; left time: 21.4179s
	iters: 600, epoch: 1 | loss: 1.0484704
	speed: 0.0028s/iter; left time: 21.5884s
	iters: 700, epoch: 1 | loss: 0.4556289
	speed: 0.0029s/iter; left time: 21.9455s
	iters: 800, epoch: 1 | loss: 1.1228960
	speed: 0.0026s/iter; left time: 19.6077s
	iters: 900, epoch: 1 | loss: 0.7922295
	speed: 0.0027s/iter; left time: 19.6429s
	iters: 1000, epoch: 1 | loss: 0.9362669
	speed: 0.0026s/iter; left time: 18.8238s
Updating learning rate to 0.00022273671327002105
Validation loss decreased (inf --> 0.3686).  Saving model state dict ...
Epoch: 1 cost time: 3.1599409580230713
Epoch: 1, Steps: 1027 | Train Loss: 0.6508285 Vali Loss: 0.3686423 Best vali loss: 0.3686423
	iters: 100, epoch: 2 | loss: 0.2770581
	speed: 0.0078s/iter; left time: 55.4294s
	iters: 200, epoch: 2 | loss: 0.1937977
	speed: 0.0023s/iter; left time: 16.3146s
	iters: 300, epoch: 2 | loss: 0.5251255
	speed: 0.0023s/iter; left time: 15.9654s
	iters: 400, epoch: 2 | loss: 1.0744840
	speed: 0.0025s/iter; left time: 17.1038s
	iters: 500, epoch: 2 | loss: 0.4812727
	speed: 0.0065s/iter; left time: 43.7404s
	iters: 600, epoch: 2 | loss: 0.2181083
	speed: 0.0042s/iter; left time: 27.9095s
	iters: 700, epoch: 2 | loss: 0.3930272
	speed: 0.0052s/iter; left time: 33.6225s
	iters: 800, epoch: 2 | loss: 0.8165601
	speed: 0.0066s/iter; left time: 41.9054s
	iters: 900, epoch: 2 | loss: 0.6890626
	speed: 0.0025s/iter; left time: 15.9035s
	iters: 1000, epoch: 2 | loss: 1.9492652
	speed: 0.0022s/iter; left time: 13.6301s
Updating learning rate to 0.00019763989751797302
Epoch: 2 cost time: 3.773824691772461
Epoch: 2, Steps: 1027 | Train Loss: 0.6617761 Vali Loss: 0.3718812 Best vali loss: 0.3686423
	iters: 100, epoch: 3 | loss: 1.0804937
	speed: 0.0085s/iter; left time: 51.7535s
	iters: 200, epoch: 3 | loss: 0.3548642
	speed: 0.0030s/iter; left time: 18.1120s
	iters: 300, epoch: 3 | loss: 0.5651698
	speed: 0.0030s/iter; left time: 17.7914s
	iters: 400, epoch: 3 | loss: 0.3655874
	speed: 0.0030s/iter; left time: 17.5163s
	iters: 500, epoch: 3 | loss: 0.3510229
	speed: 0.0029s/iter; left time: 16.4075s
	iters: 600, epoch: 3 | loss: 1.4579087
	speed: 0.0026s/iter; left time: 14.5731s
	iters: 700, epoch: 3 | loss: 0.3335849
	speed: 0.0031s/iter; left time: 17.1565s
	iters: 800, epoch: 3 | loss: 0.4009643
	speed: 0.0033s/iter; left time: 17.9553s
	iters: 900, epoch: 3 | loss: 0.2267851
	speed: 0.0033s/iter; left time: 17.4694s
	iters: 1000, epoch: 3 | loss: 0.7550650
	speed: 0.0034s/iter; left time: 17.3947s
Updating learning rate to 0.00016007985843890398
Epoch: 3 cost time: 3.220961809158325
Epoch: 3, Steps: 1027 | Train Loss: 0.5891446 Vali Loss: 0.3819247 Best vali loss: 0.3686423

best validation loss 0.3686423097588927

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6614438
	speed: 0.0116s/iter; left time: 46.5663s
	iters: 200, epoch: 1 | loss: 0.3293164
	speed: 0.0057s/iter; left time: 22.3402s
	iters: 300, epoch: 1 | loss: 0.5943259
	speed: 0.0044s/iter; left time: 16.6547s
	iters: 400, epoch: 1 | loss: 0.6864855
	speed: 0.0046s/iter; left time: 17.0898s
	iters: 500, epoch: 1 | loss: 0.4953537
	speed: 0.0061s/iter; left time: 21.8721s
Updating learning rate to 0.0005359963767340445
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 3.0376436710357666
Epoch: 1, Steps: 514 | Train Loss: 0.5533851 Vali Loss: 0.3674560 Best vali loss: 0.3674560
	iters: 100, epoch: 2 | loss: 0.8554691
	speed: 0.0125s/iter; left time: 43.6822s
	iters: 200, epoch: 2 | loss: 0.4535390
	speed: 0.0056s/iter; left time: 19.1944s
	iters: 300, epoch: 2 | loss: 0.3059417
	speed: 0.0063s/iter; left time: 20.7322s
	iters: 400, epoch: 2 | loss: 0.9975578
	speed: 0.0061s/iter; left time: 19.3874s
	iters: 500, epoch: 2 | loss: 0.3965483
	speed: 0.0059s/iter; left time: 18.3635s
Updating learning rate to 0.00047560308946149616
Epoch: 2 cost time: 3.1051340103149414
Epoch: 2, Steps: 514 | Train Loss: 0.6018112 Vali Loss: 0.3806192 Best vali loss: 0.3674560
	iters: 100, epoch: 3 | loss: 0.6866084
	speed: 0.0125s/iter; left time: 37.2560s
	iters: 200, epoch: 3 | loss: 0.5534713
	speed: 0.0062s/iter; left time: 17.7725s
	iters: 300, epoch: 3 | loss: 0.5596405
	speed: 0.0058s/iter; left time: 16.2633s
	iters: 400, epoch: 3 | loss: 0.4009785
	speed: 0.0043s/iter; left time: 11.4447s
	iters: 500, epoch: 3 | loss: 0.5278870
	speed: 0.0041s/iter; left time: 10.4829s
Updating learning rate to 0.0003852181477030879
Validation loss decreased (0.3675 --> 0.3614).  Saving model state dict ...
Epoch: 3 cost time: 2.6964406967163086
Epoch: 3, Steps: 514 | Train Loss: 0.5457171 Vali Loss: 0.3614291 Best vali loss: 0.3614291

best validation loss 0.3614290850277265

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0043467228786, 'e_layers': 3, 'learning_rate': 0.000557203679, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5674187
	speed: 0.0115s/iter; left time: 28.5282s
	iters: 200, epoch: 4 | loss: 0.3194783
	speed: 0.0058s/iter; left time: 13.6826s
	iters: 300, epoch: 4 | loss: 0.5962842
	speed: 0.0058s/iter; left time: 13.1596s
	iters: 400, epoch: 4 | loss: 0.6003875
	speed: 0.0059s/iter; left time: 12.7999s
	iters: 500, epoch: 4 | loss: 0.4513442
	speed: 0.0056s/iter; left time: 11.4975s
Updating learning rate to 0.0002786018395
Epoch: 4 cost time: 3.230968713760376
Epoch: 4, Steps: 514 | Train Loss: 0.5069826 Vali Loss: 0.3635054 Best vali loss: 0.3614291
	iters: 100, epoch: 5 | loss: 0.7521855
	speed: 0.0126s/iter; left time: 24.7353s
	iters: 200, epoch: 5 | loss: 0.3266099
	speed: 0.0061s/iter; left time: 11.3618s
	iters: 300, epoch: 5 | loss: 0.3215299
	speed: 0.0059s/iter; left time: 10.3007s
	iters: 400, epoch: 5 | loss: 0.8085120
	speed: 0.0058s/iter; left time: 9.6394s
	iters: 500, epoch: 5 | loss: 0.3653247
	speed: 0.0058s/iter; left time: 9.0300s
Updating learning rate to 0.0001719855312969122
Epoch: 5 cost time: 3.110546112060547
Epoch: 5, Steps: 514 | Train Loss: 0.5148324 Vali Loss: 0.3717652 Best vali loss: 0.3614291
	iters: 100, epoch: 6 | loss: 0.5970094
	speed: 0.0124s/iter; left time: 17.8256s
	iters: 200, epoch: 6 | loss: 0.4795220
	speed: 0.0056s/iter; left time: 7.5477s
	iters: 300, epoch: 6 | loss: 0.5565881
	speed: 0.0061s/iter; left time: 7.5335s
	iters: 400, epoch: 6 | loss: 0.3200724
	speed: 0.0058s/iter; left time: 6.6458s
	iters: 500, epoch: 6 | loss: 0.4945356
	speed: 0.0059s/iter; left time: 6.1188s
Updating learning rate to 8.160058953850389e-05
Validation loss decreased (0.3614 --> 0.3535).  Saving model state dict ...
Epoch: 6 cost time: 2.9896185398101807
Epoch: 6, Steps: 514 | Train Loss: 0.4895455 Vali Loss: 0.3535495 Best vali loss: 0.3535495
	iters: 100, epoch: 7 | loss: 0.8983988
	speed: 0.0089s/iter; left time: 8.2382s
	iters: 200, epoch: 7 | loss: 0.3312137
	speed: 0.0057s/iter; left time: 4.7652s
	iters: 300, epoch: 7 | loss: 0.2364623
	speed: 0.0059s/iter; left time: 4.3231s
	iters: 400, epoch: 7 | loss: 0.2763527
	speed: 0.0057s/iter; left time: 3.5882s
	iters: 500, epoch: 7 | loss: 0.6035196
	speed: 0.0057s/iter; left time: 3.0365s
Updating learning rate to 2.1207302265955462e-05
Epoch: 7 cost time: 2.8839619159698486
Epoch: 7, Steps: 514 | Train Loss: 0.4691894 Vali Loss: 0.3623653 Best vali loss: 0.3535495
	iters: 100, epoch: 8 | loss: 0.7058926
	speed: 0.0123s/iter; left time: 5.0971s
	iters: 200, epoch: 8 | loss: 0.4554962
	speed: 0.0058s/iter; left time: 1.8261s
	iters: 300, epoch: 8 | loss: 0.5988101
	speed: 0.0056s/iter; left time: 1.2097s
	iters: 400, epoch: 8 | loss: 0.3374281
	speed: 0.0057s/iter; left time: 0.6611s
	iters: 500, epoch: 8 | loss: 0.6161625
	speed: 0.0057s/iter; left time: 0.0861s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.0045840740203857
Epoch: 8, Steps: 514 | Train Loss: 0.5427579 Vali Loss: 0.3580084 Best vali loss: 0.3535495

best validation loss 0.35354945235144647

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0021887918326, 'e_layers': 3, 'learning_rate': 0.0046350312805, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7859181
	speed: 0.0119s/iter; left time: 23.2967s
	iters: 200, epoch: 1 | loss: 0.8837656
	speed: 0.0062s/iter; left time: 11.5559s
Updating learning rate to 0.004458620906551766
Validation loss decreased (inf --> 0.3992).  Saving model state dict ...
Epoch: 1 cost time: 1.8802194595336914
Epoch: 1, Steps: 257 | Train Loss: 0.8348418 Vali Loss: 0.3992110 Best vali loss: 0.3992110
	iters: 100, epoch: 2 | loss: 0.6662222
	speed: 0.0135s/iter; left time: 22.9712s
	iters: 200, epoch: 2 | loss: 0.5375297
	speed: 0.0062s/iter; left time: 9.9744s
Updating learning rate to 0.003956246664976659
Epoch: 2 cost time: 1.631561040878296
Epoch: 2, Steps: 257 | Train Loss: 0.6018759 Vali Loss: 0.4058379 Best vali loss: 0.3992110
	iters: 100, epoch: 3 | loss: 0.4050432
	speed: 0.0134s/iter; left time: 19.2895s
	iters: 200, epoch: 3 | loss: 0.5945272
	speed: 0.0063s/iter; left time: 8.3961s
Updating learning rate to 0.003204390480020649
Epoch: 3 cost time: 1.6255009174346924
Epoch: 3, Steps: 257 | Train Loss: 0.4997852 Vali Loss: 0.4027122 Best vali loss: 0.3992110
	iters: 100, epoch: 4 | loss: 0.5966240
	speed: 0.0136s/iter; left time: 16.1684s
	iters: 200, epoch: 4 | loss: 0.5587440
	speed: 0.0061s/iter; left time: 6.6683s
Updating learning rate to 0.00231751564025
Epoch: 4 cost time: 1.6377737522125244
Epoch: 4, Steps: 257 | Train Loss: 0.5776840 Vali Loss: 0.4040952 Best vali loss: 0.3992110
	iters: 100, epoch: 5 | loss: 0.5903012
	speed: 0.0140s/iter; left time: 12.9601s
	iters: 200, epoch: 5 | loss: 0.4571335
	speed: 0.0062s/iter; left time: 5.1363s
Updating learning rate to 0.0014306408004793516
Epoch: 5 cost time: 1.6812374591827393
Epoch: 5, Steps: 257 | Train Loss: 0.5237173 Vali Loss: 0.4038798 Best vali loss: 0.3992110
	iters: 100, epoch: 6 | loss: 0.7961530
	speed: 0.0136s/iter; left time: 9.1537s
	iters: 200, epoch: 6 | loss: 0.6579186
	speed: 0.0062s/iter; left time: 3.5573s
Updating learning rate to 0.0006787846155233418
Epoch: 6 cost time: 1.6618986129760742
Epoch: 6, Steps: 257 | Train Loss: 0.7270358 Vali Loss: 0.4041406 Best vali loss: 0.3992110
	iters: 100, epoch: 7 | loss: 0.4591052
	speed: 0.0134s/iter; left time: 5.5650s
	iters: 200, epoch: 7 | loss: 0.5783757
	speed: 0.0062s/iter; left time: 1.9504s
Updating learning rate to 0.00017641037394823463
Epoch: 7 cost time: 1.6545524597167969
Epoch: 7, Steps: 257 | Train Loss: 0.5187404 Vali Loss: 0.4037901 Best vali loss: 0.3992110
	iters: 100, epoch: 8 | loss: 0.8868703
	speed: 0.0136s/iter; left time: 2.1446s
	iters: 200, epoch: 8 | loss: 0.7517655
	speed: 0.0063s/iter; left time: 0.3640s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.6620898246765137
Epoch: 8, Steps: 257 | Train Loss: 0.8193179 Vali Loss: 0.4036671 Best vali loss: 0.3992110

best validation loss 0.39921095325576766

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0011689257956, 'e_layers': 4, 'learning_rate': 0.000133952073, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.00012885382579107886
Validation loss decreased (inf --> 0.4069).  Saving model state dict ...
Epoch: 1 cost time: 0.8185157775878906
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4068846 Best vali loss: 0.4068846
Updating learning rate to 0.00011433524608614771
Validation loss decreased (0.4069 --> 0.3882).  Saving model state dict ...
Epoch: 2 cost time: 0.5566835403442383
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3881980 Best vali loss: 0.3881980
Updating learning rate to 9.260665603402952e-05
Validation loss decreased (0.3882 --> 0.3793).  Saving model state dict ...
Epoch: 3 cost time: 0.5759775638580322
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3793280 Best vali loss: 0.3793280
Updating learning rate to 6.69760365e-05
Validation loss decreased (0.3793 --> 0.3755).  Saving model state dict ...
Epoch: 4 cost time: 0.49504828453063965
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3755293 Best vali loss: 0.3755293
Updating learning rate to 4.1345416965970464e-05
Validation loss decreased (0.3755 --> 0.3723).  Saving model state dict ...
Epoch: 5 cost time: 0.5805120468139648
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3723365 Best vali loss: 0.3723365
Updating learning rate to 1.9616826913852282e-05
Validation loss decreased (0.3723 --> 0.3708).  Saving model state dict ...
Epoch: 6 cost time: 0.6528236865997314
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3707818 Best vali loss: 0.3707818
Updating learning rate to 5.098247208921122e-06
Validation loss decreased (0.3708 --> 0.3704).  Saving model state dict ...
Epoch: 7 cost time: 0.5863418579101562
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3704404 Best vali loss: 0.3704404
Updating learning rate to 0.0
Validation loss decreased (0.3704 --> 0.3703).  Saving model state dict ...
Epoch: 8 cost time: 0.6094193458557129
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3703208 Best vali loss: 0.3703208

best validation loss 0.37032083850244174

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0019332419074, 'e_layers': 1, 'learning_rate': 0.0002140554312, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.1091539
	speed: 0.0089s/iter; left time: 71.9729s
	iters: 200, epoch: 1 | loss: 0.4124956
	speed: 0.0037s/iter; left time: 29.4830s
	iters: 300, epoch: 1 | loss: 0.6776680
	speed: 0.0040s/iter; left time: 31.9986s
	iters: 400, epoch: 1 | loss: 1.1832825
	speed: 0.0029s/iter; left time: 22.9109s
	iters: 500, epoch: 1 | loss: 0.8290892
	speed: 0.0041s/iter; left time: 31.5718s
	iters: 600, epoch: 1 | loss: 0.4804136
	speed: 0.0034s/iter; left time: 25.6776s
	iters: 700, epoch: 1 | loss: 0.4254141
	speed: 0.0033s/iter; left time: 24.9110s
	iters: 800, epoch: 1 | loss: 2.2398539
	speed: 0.0039s/iter; left time: 28.9142s
	iters: 900, epoch: 1 | loss: 0.3930774
	speed: 0.0034s/iter; left time: 24.6386s
	iters: 1000, epoch: 1 | loss: 0.4708430
	speed: 0.0034s/iter; left time: 24.8109s
Updating learning rate to 0.0002140554312
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 3.950786590576172
Epoch: 1, Steps: 1027 | Train Loss: 0.8221291 Vali Loss: 0.3694218 Best vali loss: 0.3694218
	iters: 100, epoch: 2 | loss: 0.4577943
	speed: 0.0100s/iter; left time: 70.8886s
	iters: 200, epoch: 2 | loss: 0.9337276
	speed: 0.0023s/iter; left time: 16.1433s
	iters: 300, epoch: 2 | loss: 0.3610230
	speed: 0.0024s/iter; left time: 16.6640s
	iters: 400, epoch: 2 | loss: 0.3305458
	speed: 0.0048s/iter; left time: 32.4253s
	iters: 500, epoch: 2 | loss: 0.4654559
	speed: 0.0053s/iter; left time: 35.1495s
	iters: 600, epoch: 2 | loss: 2.2152402
	speed: 0.0051s/iter; left time: 33.8816s
	iters: 700, epoch: 2 | loss: 0.5432090
	speed: 0.0041s/iter; left time: 26.7427s
	iters: 800, epoch: 2 | loss: 1.3066140
	speed: 0.0035s/iter; left time: 22.5545s
	iters: 900, epoch: 2 | loss: 0.9027594
	speed: 0.0054s/iter; left time: 33.9922s
	iters: 1000, epoch: 2 | loss: 0.4337161
	speed: 0.0050s/iter; left time: 30.8995s
Updating learning rate to 0.0001070277156
Validation loss decreased (0.3694 --> 0.3670).  Saving model state dict ...
Epoch: 2 cost time: 4.2012152671813965
Epoch: 2, Steps: 1027 | Train Loss: 0.7950085 Vali Loss: 0.3669512 Best vali loss: 0.3669512
	iters: 100, epoch: 3 | loss: 0.5957237
	speed: 0.0149s/iter; left time: 90.3296s
	iters: 200, epoch: 3 | loss: 1.8183804
	speed: 0.0048s/iter; left time: 28.3906s
	iters: 300, epoch: 3 | loss: 0.7484767
	speed: 0.0048s/iter; left time: 28.1128s
	iters: 400, epoch: 3 | loss: 0.5389972
	speed: 0.0037s/iter; left time: 21.2747s
	iters: 500, epoch: 3 | loss: 0.8592933
	speed: 0.0025s/iter; left time: 14.2824s
	iters: 600, epoch: 3 | loss: 0.2170935
	speed: 0.0025s/iter; left time: 13.6663s
	iters: 700, epoch: 3 | loss: 0.5255988
	speed: 0.0025s/iter; left time: 13.4193s
	iters: 800, epoch: 3 | loss: 0.3815302
	speed: 0.0025s/iter; left time: 13.3256s
	iters: 900, epoch: 3 | loss: 0.4677922
	speed: 0.0040s/iter; left time: 20.9996s
	iters: 1000, epoch: 3 | loss: 0.5381510
	speed: 0.0033s/iter; left time: 16.9480s
Updating learning rate to 5.35138578e-05
Epoch: 3 cost time: 3.657644033432007
Epoch: 3, Steps: 1027 | Train Loss: 0.6691037 Vali Loss: 0.3670502 Best vali loss: 0.3669512

best validation loss 0.36695115664618894

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041151835701, 'e_layers': 1, 'learning_rate': 0.0005937223211, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8352195
	speed: 0.0079s/iter; left time: 64.4061s
	iters: 200, epoch: 1 | loss: 0.5005828
	speed: 0.0023s/iter; left time: 18.3065s
	iters: 300, epoch: 1 | loss: 1.0999104
	speed: 0.0031s/iter; left time: 24.6667s
	iters: 400, epoch: 1 | loss: 0.5986956
	speed: 0.0034s/iter; left time: 26.2198s
	iters: 500, epoch: 1 | loss: 0.2561189
	speed: 0.0034s/iter; left time: 26.5750s
	iters: 600, epoch: 1 | loss: 0.8237461
	speed: 0.0036s/iter; left time: 27.3554s
	iters: 700, epoch: 1 | loss: 1.0573597
	speed: 0.0036s/iter; left time: 26.7790s
	iters: 800, epoch: 1 | loss: 0.7750540
	speed: 0.0036s/iter; left time: 26.5410s
	iters: 900, epoch: 1 | loss: 0.9674413
	speed: 0.0036s/iter; left time: 26.4538s
	iters: 1000, epoch: 1 | loss: 0.5082017
	speed: 0.0032s/iter; left time: 22.7911s
Updating learning rate to 0.000571125110779692
Validation loss decreased (inf --> 0.3631).  Saving model state dict ...
Epoch: 1 cost time: 3.576220750808716
Epoch: 1, Steps: 1027 | Train Loss: 0.7422330 Vali Loss: 0.3631371 Best vali loss: 0.3631371
	iters: 100, epoch: 2 | loss: 1.1377740
	speed: 0.0114s/iter; left time: 80.7947s
	iters: 200, epoch: 2 | loss: 0.4567503
	speed: 0.0030s/iter; left time: 20.8336s
	iters: 300, epoch: 2 | loss: 0.2462098
	speed: 0.0030s/iter; left time: 20.9859s
	iters: 400, epoch: 2 | loss: 0.4354730
	speed: 0.0031s/iter; left time: 21.3175s
	iters: 500, epoch: 2 | loss: 0.6459950
	speed: 0.0032s/iter; left time: 21.6445s
	iters: 600, epoch: 2 | loss: 0.6052789
	speed: 0.0034s/iter; left time: 22.1575s
	iters: 700, epoch: 2 | loss: 0.4822418
	speed: 0.0033s/iter; left time: 21.4771s
	iters: 800, epoch: 2 | loss: 0.2527917
	speed: 0.0032s/iter; left time: 20.6748s
	iters: 900, epoch: 2 | loss: 0.8055435
	speed: 0.0033s/iter; left time: 21.0192s
	iters: 1000, epoch: 2 | loss: 0.7801345
	speed: 0.0032s/iter; left time: 19.6563s
Updating learning rate to 0.0005067737002458133
Validation loss decreased (0.3631 --> 0.3631).  Saving model state dict ...
Epoch: 2 cost time: 3.3153023719787598
Epoch: 2, Steps: 1027 | Train Loss: 0.5848192 Vali Loss: 0.3631358 Best vali loss: 0.3631358
	iters: 100, epoch: 3 | loss: 0.3062653
	speed: 0.0122s/iter; left time: 74.0263s
	iters: 200, epoch: 3 | loss: 0.4276617
	speed: 0.0036s/iter; left time: 21.7055s
	iters: 300, epoch: 3 | loss: 0.3351870
	speed: 0.0029s/iter; left time: 17.1557s
	iters: 400, epoch: 3 | loss: 1.3042619
	speed: 0.0029s/iter; left time: 16.5638s
	iters: 500, epoch: 3 | loss: 0.7962784
	speed: 0.0036s/iter; left time: 20.5140s
	iters: 600, epoch: 3 | loss: 0.2992967
	speed: 0.0036s/iter; left time: 20.1487s
	iters: 700, epoch: 3 | loss: 0.7057781
	speed: 0.0037s/iter; left time: 20.2122s
	iters: 800, epoch: 3 | loss: 1.2957611
	speed: 0.0038s/iter; left time: 20.1862s
	iters: 900, epoch: 3 | loss: 0.3668307
	speed: 0.0036s/iter; left time: 18.7314s
	iters: 1000, epoch: 3 | loss: 1.3117533
	speed: 0.0037s/iter; left time: 18.8943s
Updating learning rate to 0.00041046500840515797
Epoch: 3 cost time: 3.6412692070007324
Epoch: 3, Steps: 1027 | Train Loss: 0.7149074 Vali Loss: 0.3636330 Best vali loss: 0.3631358

best validation loss 0.36313581235692166

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0039466236882, 'e_layers': 1, 'learning_rate': 0.000185960463, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6256120
	speed: 0.0100s/iter; left time: 19.5252s
	iters: 200, epoch: 1 | loss: 1.1427554
	speed: 0.0027s/iter; left time: 5.0063s
Updating learning rate to 0.000185960463
Validation loss decreased (inf --> 0.3646).  Saving model state dict ...
Epoch: 1 cost time: 1.1181776523590088
Epoch: 1, Steps: 257 | Train Loss: 0.8841837 Vali Loss: 0.3645713 Best vali loss: 0.3645713
	iters: 100, epoch: 2 | loss: 0.5856410
	speed: 0.0070s/iter; left time: 11.8305s
	iters: 200, epoch: 2 | loss: 0.5112541
	speed: 0.0042s/iter; left time: 6.6844s
Updating learning rate to 9.29802315e-05
Epoch: 2 cost time: 1.0430796146392822
Epoch: 2, Steps: 257 | Train Loss: 0.5484475 Vali Loss: 0.3686355 Best vali loss: 0.3645713
	iters: 100, epoch: 3 | loss: 0.6512255
	speed: 0.0127s/iter; left time: 18.2792s
	iters: 200, epoch: 3 | loss: 0.6050138
	speed: 0.0050s/iter; left time: 6.7284s
Updating learning rate to 4.649011575e-05
Epoch: 3 cost time: 1.379866123199463
Epoch: 3, Steps: 257 | Train Loss: 0.6281196 Vali Loss: 0.3661845 Best vali loss: 0.3645713

best validation loss 0.36457132343458987

{'batch_size': 8, 'd_core': 32, 'd_model': 32, 'dropout': 0.0041151835701, 'e_layers': 1, 'learning_rate': 0.0005937223211, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8092510
	speed: 0.0108s/iter; left time: 54.5452s
	iters: 200, epoch: 4 | loss: 0.4104260
	speed: 0.0038s/iter; left time: 18.8875s
	iters: 300, epoch: 4 | loss: 1.2795192
	speed: 0.0032s/iter; left time: 15.5260s
	iters: 400, epoch: 4 | loss: 0.5983686
	speed: 0.0051s/iter; left time: 24.1905s
	iters: 500, epoch: 4 | loss: 0.2846387
	speed: 0.0051s/iter; left time: 23.8009s
	iters: 600, epoch: 4 | loss: 0.5444002
	speed: 0.0052s/iter; left time: 23.6522s
	iters: 700, epoch: 4 | loss: 1.1108547
	speed: 0.0032s/iter; left time: 14.0807s
	iters: 800, epoch: 4 | loss: 0.6595500
	speed: 0.0044s/iter; left time: 19.1996s
	iters: 900, epoch: 4 | loss: 0.8364651
	speed: 0.0049s/iter; left time: 20.8518s
	iters: 1000, epoch: 4 | loss: 0.5170515
	speed: 0.0051s/iter; left time: 21.0196s
Updating learning rate to 0.00029686116055
Epoch: 4 cost time: 4.950848340988159
Epoch: 4, Steps: 1027 | Train Loss: 0.7050525 Vali Loss: 0.3678087 Best vali loss: 0.3631358
	iters: 100, epoch: 5 | loss: 1.0375684
	speed: 0.0165s/iter; left time: 65.9979s
	iters: 200, epoch: 5 | loss: 0.5027809
	speed: 0.0050s/iter; left time: 19.3881s
	iters: 300, epoch: 5 | loss: 0.2798367
	speed: 0.0038s/iter; left time: 14.3460s
	iters: 400, epoch: 5 | loss: 0.4394375
	speed: 0.0025s/iter; left time: 9.2609s
	iters: 500, epoch: 5 | loss: 0.5358587
	speed: 0.0022s/iter; left time: 7.9801s
	iters: 600, epoch: 5 | loss: 0.6152863
	speed: 0.0022s/iter; left time: 7.8338s
	iters: 700, epoch: 5 | loss: 0.4374819
	speed: 0.0023s/iter; left time: 7.7660s
	iters: 800, epoch: 5 | loss: 0.2442115
	speed: 0.0023s/iter; left time: 7.5752s
	iters: 900, epoch: 5 | loss: 0.8155816
	speed: 0.0023s/iter; left time: 7.3111s
	iters: 1000, epoch: 5 | loss: 0.4965501
	speed: 0.0022s/iter; left time: 6.9862s
Updating learning rate to 0.00018325731269484204
Epoch: 5 cost time: 3.092203140258789
Epoch: 5, Steps: 1027 | Train Loss: 0.5404594 Vali Loss: 0.3737121 Best vali loss: 0.3631358
	iters: 100, epoch: 6 | loss: 0.3343971
	speed: 0.0079s/iter; left time: 23.5729s
	iters: 200, epoch: 6 | loss: 0.4234730
	speed: 0.0031s/iter; left time: 8.9961s
	iters: 300, epoch: 6 | loss: 0.3185379
	speed: 0.0031s/iter; left time: 8.6683s
	iters: 400, epoch: 6 | loss: 1.3312510
	speed: 0.0025s/iter; left time: 6.6027s
	iters: 500, epoch: 6 | loss: 0.7711379
	speed: 0.0029s/iter; left time: 7.5307s
	iters: 600, epoch: 6 | loss: 0.2888722
	speed: 0.0032s/iter; left time: 7.9457s
	iters: 700, epoch: 6 | loss: 0.6734223
	speed: 0.0032s/iter; left time: 7.5856s
	iters: 800, epoch: 6 | loss: 1.2596687
	speed: 0.0025s/iter; left time: 5.6760s
	iters: 900, epoch: 6 | loss: 0.3321769
	speed: 0.0031s/iter; left time: 6.7746s
	iters: 1000, epoch: 6 | loss: 1.1271883
	speed: 0.0032s/iter; left time: 6.6454s
Updating learning rate to 8.69486208541866e-05
Epoch: 6 cost time: 3.075472593307495
Epoch: 6, Steps: 1027 | Train Loss: 0.6860125 Vali Loss: 0.3754855 Best vali loss: 0.3631358
	iters: 100, epoch: 7 | loss: 0.7210419
	speed: 0.0106s/iter; left time: 20.7278s
	iters: 200, epoch: 7 | loss: 0.6048294
	speed: 0.0027s/iter; left time: 4.9656s
	iters: 300, epoch: 7 | loss: 0.5010818
	speed: 0.0029s/iter; left time: 5.0794s
	iters: 400, epoch: 7 | loss: 0.3080598
	speed: 0.0031s/iter; left time: 5.0661s
	iters: 500, epoch: 7 | loss: 0.2671802
	speed: 0.0028s/iter; left time: 4.4160s
	iters: 600, epoch: 7 | loss: 0.7618065
	speed: 0.0024s/iter; left time: 3.4226s
	iters: 700, epoch: 7 | loss: 0.9502832
	speed: 0.0031s/iter; left time: 4.2484s
	iters: 800, epoch: 7 | loss: 0.8148317
	speed: 0.0031s/iter; left time: 3.9219s
	iters: 900, epoch: 7 | loss: 0.3690114
	speed: 0.0026s/iter; left time: 2.9569s
	iters: 1000, epoch: 7 | loss: 0.3337028
	speed: 0.0028s/iter; left time: 2.9755s
Updating learning rate to 2.259721032030796e-05
Epoch: 7 cost time: 3.000933885574341
Epoch: 7, Steps: 1027 | Train Loss: 0.5631829 Vali Loss: 0.3760356 Best vali loss: 0.3631358
	iters: 100, epoch: 8 | loss: 0.4222009
	speed: 0.0106s/iter; left time: 9.8733s
	iters: 200, epoch: 8 | loss: 0.3237992
	speed: 0.0030s/iter; left time: 2.5151s
	iters: 300, epoch: 8 | loss: 0.3401778
	speed: 0.0029s/iter; left time: 2.1437s
	iters: 400, epoch: 8 | loss: 0.2216015
	speed: 0.0023s/iter; left time: 1.4299s
	iters: 500, epoch: 8 | loss: 0.3005373
	speed: 0.0020s/iter; left time: 1.0787s
	iters: 600, epoch: 8 | loss: 1.3684188
	speed: 0.0020s/iter; left time: 0.8581s
	iters: 700, epoch: 8 | loss: 0.2425280
	speed: 0.0021s/iter; left time: 0.6756s
	iters: 800, epoch: 8 | loss: 0.4012985
	speed: 0.0025s/iter; left time: 0.5644s
	iters: 900, epoch: 8 | loss: 0.5146862
	speed: 0.0067s/iter; left time: 0.8539s
	iters: 1000, epoch: 8 | loss: 0.4417804
	speed: 0.0031s/iter; left time: 0.0881s
Updating learning rate to 0.0
Epoch: 8 cost time: 3.104600191116333
Epoch: 8, Steps: 1027 | Train Loss: 0.4577029 Vali Loss: 0.3787921 Best vali loss: 0.3631358

best validation loss 0.36313581235692166

[INFO][smbo.py:320] Finished 400 trials.
{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0083070963017, 'e_layers': 1, 'learning_rate': 0.0006773932069, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4496653
	speed: 0.0133s/iter; left time: 25.9395s
	iters: 200, epoch: 1 | loss: 1.1045077
	speed: 0.0057s/iter; left time: 10.6751s
Updating learning rate to 0.0006516114631085467
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 2.0369930267333984
Epoch: 1, Steps: 257 | Train Loss: 0.7770865 Vali Loss: 0.3693995 Best vali loss: 0.3693995
	iters: 100, epoch: 2 | loss: 0.8083047
	speed: 0.0159s/iter; left time: 26.9995s
	iters: 200, epoch: 2 | loss: 0.6564120
	speed: 0.0049s/iter; left time: 7.8268s
Updating learning rate to 0.000578191268514346
Validation loss decreased (0.3694 --> 0.3624).  Saving model state dict ...
Epoch: 2 cost time: 1.7578020095825195
Epoch: 2, Steps: 257 | Train Loss: 0.7323583 Vali Loss: 0.3624181 Best vali loss: 0.3624181
	iters: 100, epoch: 3 | loss: 0.5477016
	speed: 0.0150s/iter; left time: 21.6459s
	iters: 200, epoch: 3 | loss: 0.8630227
	speed: 0.0048s/iter; left time: 6.4338s
Updating learning rate to 0.0004683101821886438
Epoch: 3 cost time: 1.3507075309753418
Epoch: 3, Steps: 257 | Train Loss: 0.7053621 Vali Loss: 0.3639643 Best vali loss: 0.3624181
	iters: 100, epoch: 4 | loss: 0.3308980
	speed: 0.0066s/iter; left time: 7.7726s
	iters: 200, epoch: 4 | loss: 0.6298170
	speed: 0.0029s/iter; left time: 3.2017s
Updating learning rate to 0.00033869660345
Epoch: 4 cost time: 0.8442330360412598
Epoch: 4, Steps: 257 | Train Loss: 0.4803575 Vali Loss: 0.3693195 Best vali loss: 0.3624181
	iters: 100, epoch: 5 | loss: 0.5428987
	speed: 0.0099s/iter; left time: 9.2278s
	iters: 200, epoch: 5 | loss: 0.7931438
	speed: 0.0039s/iter; left time: 3.2023s
Updating learning rate to 0.00020908302471135632
Epoch: 5 cost time: 1.0711886882781982
Epoch: 5, Steps: 257 | Train Loss: 0.6680212 Vali Loss: 0.3696412 Best vali loss: 0.3624181
	iters: 100, epoch: 6 | loss: 0.7542879
	speed: 0.0096s/iter; left time: 6.4485s
	iters: 200, epoch: 6 | loss: 0.8223436
	speed: 0.0042s/iter; left time: 2.4013s
Updating learning rate to 9.920193838565403e-05
Epoch: 6 cost time: 1.0890212059020996
Epoch: 6, Steps: 257 | Train Loss: 0.7883158 Vali Loss: 0.3733405 Best vali loss: 0.3624181
	iters: 100, epoch: 7 | loss: 0.5034815
	speed: 0.0097s/iter; left time: 4.0458s
	iters: 200, epoch: 7 | loss: 0.4860346
	speed: 0.0038s/iter; left time: 1.2038s
Updating learning rate to 2.5781743791453334e-05
Epoch: 7 cost time: 1.0534110069274902
Epoch: 7, Steps: 257 | Train Loss: 0.4947581 Vali Loss: 0.3723327 Best vali loss: 0.3624181
	iters: 100, epoch: 8 | loss: 0.5371633
	speed: 0.0098s/iter; left time: 1.5480s
	iters: 200, epoch: 8 | loss: 0.5732738
	speed: 0.0039s/iter; left time: 0.2239s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0666601657867432
Epoch: 8, Steps: 257 | Train Loss: 0.5552185 Vali Loss: 0.3725017 Best vali loss: 0.3624181

best validation loss 0.36241808856868557

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0029408778774, 'e_layers': 1, 'learning_rate': 0.0001005610743, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 9.673369630655839e-05
Validation loss decreased (inf --> 0.3897).  Saving model state dict ...
Epoch: 1 cost time: 0.6921918392181396
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3897403 Best vali loss: 0.3897403
Updating learning rate to 8.583424593046713e-05
Validation loss decreased (0.3897 --> 0.3732).  Saving model state dict ...
Epoch: 2 cost time: 0.4494211673736572
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3731840 Best vali loss: 0.3731840
Updating learning rate to 6.952206568772242e-05
Validation loss decreased (0.3732 --> 0.3670).  Saving model state dict ...
Epoch: 3 cost time: 0.4424405097961426
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3669760 Best vali loss: 0.3669760
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.3670 --> 0.3658).  Saving model state dict ...
Epoch: 4 cost time: 0.44808340072631836
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3658308 Best vali loss: 0.3658308
Updating learning rate to 3.10390086122776e-05
Epoch: 5 cost time: 0.4560737609863281
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3659325 Best vali loss: 0.3658308
Updating learning rate to 1.472682836953288e-05
Epoch: 6 cost time: 0.49562954902648926
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3661712 Best vali loss: 0.3658308
Updating learning rate to 3.827377993441614e-06
Epoch: 7 cost time: 0.33573246002197266
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3659228 Best vali loss: 0.3658308
Updating learning rate to 0.0
Epoch: 8 cost time: 0.35738444328308105
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3660165 Best vali loss: 0.3658308

best validation loss 0.3658307817572461

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0114311397825, 'e_layers': 2, 'learning_rate': 0.0007346262927, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0007346262927
Validation loss decreased (inf --> 0.3679).  Saving model state dict ...
Epoch: 1 cost time: 0.9216036796569824
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3678579 Best vali loss: 0.3678579
Updating learning rate to 0.00036731314635
Validation loss decreased (0.3679 --> 0.3644).  Saving model state dict ...
Epoch: 2 cost time: 0.6758880615234375
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3643635 Best vali loss: 0.3643635
Updating learning rate to 0.000183656573175
Validation loss decreased (0.3644 --> 0.3600).  Saving model state dict ...
Epoch: 3 cost time: 0.6598351001739502
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3599642 Best vali loss: 0.3599642

best validation loss 0.3599642455812053

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0008016835459, 'e_layers': 1, 'learning_rate': 0.0006601321641, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8439078
	speed: 0.0094s/iter; left time: 37.6473s
	iters: 200, epoch: 1 | loss: 0.5562852
	speed: 0.0036s/iter; left time: 13.9824s
	iters: 300, epoch: 1 | loss: 0.5205798
	speed: 0.0033s/iter; left time: 12.4477s
	iters: 400, epoch: 1 | loss: 0.8151544
	speed: 0.0033s/iter; left time: 12.3168s
	iters: 500, epoch: 1 | loss: 0.7494332
	speed: 0.0034s/iter; left time: 12.4142s
Updating learning rate to 0.0006601321641
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 2.077347993850708
Epoch: 1, Steps: 514 | Train Loss: 0.6970721 Vali Loss: 0.3674639 Best vali loss: 0.3674639
	iters: 100, epoch: 2 | loss: 0.3616004
	speed: 0.0088s/iter; left time: 30.8656s
	iters: 200, epoch: 2 | loss: 0.3985922
	speed: 0.0033s/iter; left time: 11.2549s
	iters: 300, epoch: 2 | loss: 0.9237248
	speed: 0.0034s/iter; left time: 11.1448s
	iters: 400, epoch: 2 | loss: 0.6149890
	speed: 0.0037s/iter; left time: 11.6856s
	iters: 500, epoch: 2 | loss: 0.3798569
	speed: 0.0034s/iter; left time: 10.6718s
Updating learning rate to 0.00033006608205
Epoch: 2 cost time: 1.8190116882324219
Epoch: 2, Steps: 514 | Train Loss: 0.5357527 Vali Loss: 0.3755515 Best vali loss: 0.3674639
	iters: 100, epoch: 3 | loss: 0.4567484
	speed: 0.0092s/iter; left time: 27.5209s
	iters: 200, epoch: 3 | loss: 0.6188090
	speed: 0.0033s/iter; left time: 9.6435s
	iters: 300, epoch: 3 | loss: 0.3889099
	speed: 0.0032s/iter; left time: 9.0255s
	iters: 400, epoch: 3 | loss: 0.5483303
	speed: 0.0030s/iter; left time: 8.1357s
	iters: 500, epoch: 3 | loss: 0.2989657
	speed: 0.0037s/iter; left time: 9.5783s
Updating learning rate to 0.000165033041025
Epoch: 3 cost time: 1.7642223834991455
Epoch: 3, Steps: 514 | Train Loss: 0.4623527 Vali Loss: 0.3846177 Best vali loss: 0.3674639

best validation loss 0.3674639226001466

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.0019750620614, 'e_layers': 1, 'learning_rate': 0.0043772257118, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4117709
	speed: 0.0093s/iter; left time: 37.2916s
	iters: 200, epoch: 1 | loss: 0.4938922
	speed: 0.0034s/iter; left time: 13.4337s
	iters: 300, epoch: 1 | loss: 0.4866602
	speed: 0.0034s/iter; left time: 13.1481s
	iters: 400, epoch: 1 | loss: 0.6952222
	speed: 0.0036s/iter; left time: 13.3948s
	iters: 500, epoch: 1 | loss: 0.9375249
	speed: 0.0035s/iter; left time: 12.6697s
Updating learning rate to 0.0043772257118
Validation loss decreased (inf --> 0.3733).  Saving model state dict ...
Epoch: 1 cost time: 2.0978121757507324
Epoch: 1, Steps: 514 | Train Loss: 0.6050141 Vali Loss: 0.3732514 Best vali loss: 0.3732514
	iters: 100, epoch: 2 | loss: 0.5493933
	speed: 0.0094s/iter; left time: 32.7227s
	iters: 200, epoch: 2 | loss: 1.2808735
	speed: 0.0033s/iter; left time: 11.2140s
	iters: 300, epoch: 2 | loss: 0.6502911
	speed: 0.0035s/iter; left time: 11.5185s
	iters: 400, epoch: 2 | loss: 0.3398306
	speed: 0.0036s/iter; left time: 11.5897s
	iters: 500, epoch: 2 | loss: 0.7167848
	speed: 0.0037s/iter; left time: 11.5932s
Updating learning rate to 0.0021886128559
Epoch: 2 cost time: 1.8779845237731934
Epoch: 2, Steps: 514 | Train Loss: 0.7074347 Vali Loss: 0.3866158 Best vali loss: 0.3732514
	iters: 100, epoch: 3 | loss: 0.5641637
	speed: 0.0094s/iter; left time: 28.1306s
	iters: 200, epoch: 3 | loss: 0.8688026
	speed: 0.0032s/iter; left time: 9.2544s
	iters: 300, epoch: 3 | loss: 0.4222699
	speed: 0.0024s/iter; left time: 6.7304s
	iters: 400, epoch: 3 | loss: 0.2791414
	speed: 0.0025s/iter; left time: 6.7441s
	iters: 500, epoch: 3 | loss: 0.8394564
	speed: 0.0023s/iter; left time: 6.0201s
Updating learning rate to 0.00109430642795
Epoch: 3 cost time: 1.5535938739776611
Epoch: 3, Steps: 514 | Train Loss: 0.5947668 Vali Loss: 0.4020511 Best vali loss: 0.3732514

best validation loss 0.3732513721541946

{'batch_size': 128, 'd_core': 256, 'd_model': 512, 'dropout': 0.0114311397825, 'e_layers': 2, 'learning_rate': 0.0007346262927, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 9.18282865875e-05
Validation loss decreased (0.3600 --> 0.3479).  Saving model state dict ...
Epoch: 4 cost time: 0.9906039237976074
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3478659 Best vali loss: 0.3478659
Updating learning rate to 4.591414329375e-05
Epoch: 5 cost time: 0.6782848834991455
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3508695 Best vali loss: 0.3478659
Updating learning rate to 2.2957071646875e-05
Epoch: 6 cost time: 0.7088234424591064
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3518806 Best vali loss: 0.3478659
Updating learning rate to 1.14785358234375e-05
Epoch: 7 cost time: 0.6108493804931641
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3514913 Best vali loss: 0.3478659
Updating learning rate to 5.73926791171875e-06
Epoch: 8 cost time: 0.5776314735412598
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3527939 Best vali loss: 0.3478659

best validation loss 0.34786585337520814

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0071994713635, 'e_layers': 3, 'learning_rate': 0.000446018847, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6551525
	speed: 0.0128s/iter; left time: 51.5096s
	iters: 200, epoch: 1 | loss: 0.6855366
	speed: 0.0062s/iter; left time: 24.2250s
	iters: 300, epoch: 1 | loss: 0.5130393
	speed: 0.0069s/iter; left time: 26.3989s
	iters: 400, epoch: 1 | loss: 0.6010720
	speed: 0.0064s/iter; left time: 23.7625s
	iters: 500, epoch: 1 | loss: 0.3743818
	speed: 0.0068s/iter; left time: 24.6698s
Updating learning rate to 0.000446018847
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 3.6955134868621826
Epoch: 1, Steps: 514 | Train Loss: 0.5658364 Vali Loss: 0.3684720 Best vali loss: 0.3684720
	iters: 100, epoch: 2 | loss: 0.3957818
	speed: 0.0139s/iter; left time: 48.7666s
	iters: 200, epoch: 2 | loss: 0.5958334
	speed: 0.0048s/iter; left time: 16.2506s
	iters: 300, epoch: 2 | loss: 0.5738196
	speed: 0.0039s/iter; left time: 12.7527s
	iters: 400, epoch: 2 | loss: 1.0112298
	speed: 0.0055s/iter; left time: 17.5394s
	iters: 500, epoch: 2 | loss: 0.6464458
	speed: 0.0071s/iter; left time: 22.0084s
Updating learning rate to 0.0002230094235
Validation loss decreased (0.3685 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 2.942563772201538
Epoch: 2, Steps: 514 | Train Loss: 0.6446221 Vali Loss: 0.3647057 Best vali loss: 0.3647057
	iters: 100, epoch: 3 | loss: 0.9127958
	speed: 0.0141s/iter; left time: 41.9709s
	iters: 200, epoch: 3 | loss: 0.4647466
	speed: 0.0070s/iter; left time: 20.0770s
	iters: 300, epoch: 3 | loss: 0.3925518
	speed: 0.0069s/iter; left time: 19.2739s
	iters: 400, epoch: 3 | loss: 0.3484845
	speed: 0.0063s/iter; left time: 16.8874s
	iters: 500, epoch: 3 | loss: 0.3292207
	speed: 0.0070s/iter; left time: 18.0919s
Updating learning rate to 0.00011150471175
Epoch: 3 cost time: 3.5070908069610596
Epoch: 3, Steps: 514 | Train Loss: 0.4895599 Vali Loss: 0.3688380 Best vali loss: 0.3647057
	iters: 100, epoch: 4 | loss: 0.4548513
	speed: 0.0145s/iter; left time: 35.8776s
	iters: 200, epoch: 4 | loss: 0.3065963
	speed: 0.0070s/iter; left time: 16.6882s
	iters: 300, epoch: 4 | loss: 0.6223857
	speed: 0.0068s/iter; left time: 15.3902s
	iters: 400, epoch: 4 | loss: 0.5204192
	speed: 0.0067s/iter; left time: 14.5370s
	iters: 500, epoch: 4 | loss: 0.6376599
	speed: 0.0074s/iter; left time: 15.3044s
Updating learning rate to 5.5752355875e-05
Epoch: 4 cost time: 3.5982534885406494
Epoch: 4, Steps: 514 | Train Loss: 0.5083825 Vali Loss: 0.3681605 Best vali loss: 0.3647057
	iters: 100, epoch: 5 | loss: 0.6134841
	speed: 0.0147s/iter; left time: 28.7042s
	iters: 200, epoch: 5 | loss: 0.3286837
	speed: 0.0072s/iter; left time: 13.3849s
	iters: 300, epoch: 5 | loss: 0.7005937
	speed: 0.0065s/iter; left time: 11.4471s
	iters: 400, epoch: 5 | loss: 0.9741548
	speed: 0.0071s/iter; left time: 11.6874s
	iters: 500, epoch: 5 | loss: 0.4373156
	speed: 0.0071s/iter; left time: 11.1262s
Updating learning rate to 2.78761779375e-05
Epoch: 5 cost time: 3.640449047088623
Epoch: 5, Steps: 514 | Train Loss: 0.6108464 Vali Loss: 0.3703880 Best vali loss: 0.3647057
	iters: 100, epoch: 6 | loss: 0.7639251
	speed: 0.0150s/iter; left time: 21.6567s
	iters: 200, epoch: 6 | loss: 0.9052926
	speed: 0.0073s/iter; left time: 9.7423s
	iters: 300, epoch: 6 | loss: 0.6095371
	speed: 0.0051s/iter; left time: 6.3762s
	iters: 400, epoch: 6 | loss: 0.8794143
	speed: 0.0039s/iter; left time: 4.4613s
	iters: 500, epoch: 6 | loss: 0.4927422
	speed: 0.0048s/iter; left time: 4.9750s
Updating learning rate to 1.393808896875e-05
Epoch: 6 cost time: 2.986531972885132
Epoch: 6, Steps: 514 | Train Loss: 0.7301823 Vali Loss: 0.3701441 Best vali loss: 0.3647057
	iters: 100, epoch: 7 | loss: 0.7297032
	speed: 0.0127s/iter; left time: 11.7768s
	iters: 200, epoch: 7 | loss: 0.3504995
	speed: 0.0060s/iter; left time: 4.9732s
	iters: 300, epoch: 7 | loss: 0.5290250
	speed: 0.0064s/iter; left time: 4.6814s
	iters: 400, epoch: 7 | loss: 0.2852103
	speed: 0.0065s/iter; left time: 4.0718s
	iters: 500, epoch: 7 | loss: 0.7544982
	speed: 0.0063s/iter; left time: 3.3167s
Updating learning rate to 6.969044484375e-06
Epoch: 7 cost time: 3.2555336952209473
Epoch: 7, Steps: 514 | Train Loss: 0.5297872 Vali Loss: 0.3703622 Best vali loss: 0.3647057
	iters: 100, epoch: 8 | loss: 0.3926026
	speed: 0.0128s/iter; left time: 5.2950s
	iters: 200, epoch: 8 | loss: 1.0561919
	speed: 0.0059s/iter; left time: 1.8591s
	iters: 300, epoch: 8 | loss: 0.4923228
	speed: 0.0038s/iter; left time: 0.8143s
	iters: 400, epoch: 8 | loss: 0.4777461
	speed: 0.0039s/iter; left time: 0.4467s
	iters: 500, epoch: 8 | loss: 0.4781246
	speed: 0.0039s/iter; left time: 0.0579s
Updating learning rate to 3.4845222421875e-06
Epoch: 8 cost time: 2.428267478942871
Epoch: 8, Steps: 514 | Train Loss: 0.5793976 Vali Loss: 0.3703225 Best vali loss: 0.3647057

best validation loss 0.36470571040872973

{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0029631840606, 'e_layers': 3, 'learning_rate': 7.97883763e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6771094
	speed: 0.0134s/iter; left time: 12.4644s
Updating learning rate to 7.675161204793932e-05
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 1.2840707302093506
Epoch: 1, Steps: 129 | Train Loss: 0.6771094 Vali Loss: 0.3694342 Best vali loss: 0.3694342
	iters: 100, epoch: 2 | loss: 0.6553333
	speed: 0.0122s/iter; left time: 9.7825s
Updating learning rate to 6.810363912079701e-05
Validation loss decreased (0.3694 --> 0.3646).  Saving model state dict ...
Epoch: 2 cost time: 0.9987938404083252
Epoch: 2, Steps: 129 | Train Loss: 0.6553333 Vali Loss: 0.3645567 Best vali loss: 0.3645567
	iters: 100, epoch: 3 | loss: 0.5126594
	speed: 0.0128s/iter; left time: 8.6714s
Updating learning rate to 5.51610330026607e-05
Epoch: 3 cost time: 1.038874864578247
Epoch: 3, Steps: 129 | Train Loss: 0.5126594 Vali Loss: 0.3651326 Best vali loss: 0.3645567
	iters: 100, epoch: 4 | loss: 0.4991357
	speed: 0.0122s/iter; left time: 6.6350s
Updating learning rate to 3.989418815e-05
Validation loss decreased (0.3646 --> 0.3629).  Saving model state dict ...
Epoch: 4 cost time: 1.020460844039917
Epoch: 4, Steps: 129 | Train Loss: 0.4991357 Vali Loss: 0.3629463 Best vali loss: 0.3629463
	iters: 100, epoch: 5 | loss: 0.5351811
	speed: 0.0128s/iter; left time: 5.3182s
Updating learning rate to 2.4627343297339313e-05
Validation loss decreased (0.3629 --> 0.3602).  Saving model state dict ...
Epoch: 5 cost time: 1.0370311737060547
Epoch: 5, Steps: 129 | Train Loss: 0.5351811 Vali Loss: 0.3602174 Best vali loss: 0.3602174
	iters: 100, epoch: 6 | loss: 0.6425503
	speed: 0.0101s/iter; left time: 2.8956s
Updating learning rate to 1.1684737179202996e-05
Validation loss decreased (0.3602 --> 0.3566).  Saving model state dict ...
Epoch: 6 cost time: 0.6895961761474609
Epoch: 6, Steps: 129 | Train Loss: 0.6425503 Vali Loss: 0.3565756 Best vali loss: 0.3565756
	iters: 100, epoch: 7 | loss: 0.5552453
	speed: 0.0112s/iter; left time: 1.7802s
Updating learning rate to 3.036764252060685e-06
Epoch: 7 cost time: 1.0173625946044922
Epoch: 7, Steps: 129 | Train Loss: 0.5552453 Vali Loss: 0.3572150 Best vali loss: 0.3565756
	iters: 100, epoch: 8 | loss: 0.4700368
	speed: 0.0121s/iter; left time: 0.3625s
Updating learning rate to 0.0
Validation loss decreased (0.3566 --> 0.3563).  Saving model state dict ...
Epoch: 8 cost time: 0.9962046146392822
Epoch: 8, Steps: 129 | Train Loss: 0.4700368 Vali Loss: 0.3562905 Best vali loss: 0.3562905

best validation loss 0.35629050605189355

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047463729232, 'e_layers': 4, 'learning_rate': 9.71227879e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3810281
	speed: 0.0144s/iter; left time: 28.1228s
	iters: 200, epoch: 1 | loss: 0.4857015
	speed: 0.0082s/iter; left time: 15.2608s
Updating learning rate to 9.342627189062243e-05
Validation loss decreased (inf --> 0.3701).  Saving model state dict ...
Epoch: 1 cost time: 2.423276901245117
Epoch: 1, Steps: 257 | Train Loss: 0.4333648 Vali Loss: 0.3700921 Best vali loss: 0.3700921
	iters: 100, epoch: 2 | loss: 0.7534120
	speed: 0.0170s/iter; left time: 28.9070s
	iters: 200, epoch: 2 | loss: 0.5578932
	speed: 0.0082s/iter; left time: 13.1366s
Updating learning rate to 8.289948491591637e-05
Epoch: 2 cost time: 2.156757354736328
Epoch: 2, Steps: 257 | Train Loss: 0.6556526 Vali Loss: 0.3720276 Best vali loss: 0.3700921
	iters: 100, epoch: 3 | loss: 0.4415000
	speed: 0.0174s/iter; left time: 25.0843s
	iters: 200, epoch: 3 | loss: 0.7338093
	speed: 0.0087s/iter; left time: 11.6318s
Updating learning rate to 6.714503486721931e-05
Validation loss decreased (0.3701 --> 0.3636).  Saving model state dict ...
Epoch: 3 cost time: 2.231771230697632
Epoch: 3, Steps: 257 | Train Loss: 0.5876546 Vali Loss: 0.3635714 Best vali loss: 0.3635714

best validation loss 0.3635714253648559

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0044711634464, 'e_layers': 1, 'learning_rate': 0.000356589613, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5595065
	speed: 0.0103s/iter; left time: 9.6143s
Updating learning rate to 0.0003430177289784103
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 0.8816437721252441
Epoch: 1, Steps: 129 | Train Loss: 0.5595065 Vali Loss: 0.3658983 Best vali loss: 0.3658983
	iters: 100, epoch: 2 | loss: 0.6281298
	speed: 0.0082s/iter; left time: 6.5628s
Updating learning rate to 0.0003043682732264933
Validation loss decreased (0.3659 --> 0.3651).  Saving model state dict ...
Epoch: 2 cost time: 0.5948829650878906
Epoch: 2, Steps: 129 | Train Loss: 0.6281298 Vali Loss: 0.3651423 Best vali loss: 0.3651423
	iters: 100, epoch: 3 | loss: 0.6894413
	speed: 0.0082s/iter; left time: 5.5662s
Updating learning rate to 0.0002465252750242895
Epoch: 3 cost time: 0.5881528854370117
Epoch: 3, Steps: 129 | Train Loss: 0.6894413 Vali Loss: 0.3682772 Best vali loss: 0.3651423

best validation loss 0.36514225678265916

{'batch_size': 8, 'd_core': 64, 'd_model': 512, 'dropout': 0.0090271357217, 'e_layers': 2, 'learning_rate': 9.03274957e-05, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.4825301
	speed: 0.0099s/iter; left time: 80.0862s
	iters: 200, epoch: 1 | loss: 1.6570183
	speed: 0.0035s/iter; left time: 28.3206s
	iters: 300, epoch: 1 | loss: 0.5952176
	speed: 0.0034s/iter; left time: 26.8685s
	iters: 400, epoch: 1 | loss: 0.9403323
	speed: 0.0035s/iter; left time: 27.3788s
	iters: 500, epoch: 1 | loss: 0.4046763
	speed: 0.0043s/iter; left time: 33.0651s
	iters: 600, epoch: 1 | loss: 1.5785457
	speed: 0.0042s/iter; left time: 32.2452s
	iters: 700, epoch: 1 | loss: 0.8873050
	speed: 0.0042s/iter; left time: 31.4153s
	iters: 800, epoch: 1 | loss: 0.4028121
	speed: 0.0043s/iter; left time: 31.8838s
	iters: 900, epoch: 1 | loss: 0.3863126
	speed: 0.0043s/iter; left time: 31.4694s
	iters: 1000, epoch: 1 | loss: 0.7323444
	speed: 0.0043s/iter; left time: 31.3411s
Updating learning rate to 9.03274957e-05
Validation loss decreased (inf --> 0.3645).  Saving model state dict ...
Epoch: 1 cost time: 4.421974420547485
Epoch: 1, Steps: 1027 | Train Loss: 0.8067095 Vali Loss: 0.3645356 Best vali loss: 0.3645356
	iters: 100, epoch: 2 | loss: 0.8158070
	speed: 0.0133s/iter; left time: 93.9549s
	iters: 200, epoch: 2 | loss: 0.8347023
	speed: 0.0042s/iter; left time: 29.1396s
	iters: 300, epoch: 2 | loss: 0.9395666
	speed: 0.0042s/iter; left time: 29.1643s
	iters: 400, epoch: 2 | loss: 0.2879645
	speed: 0.0042s/iter; left time: 28.5632s
	iters: 500, epoch: 2 | loss: 0.3327052
	speed: 0.0042s/iter; left time: 27.8409s
	iters: 600, epoch: 2 | loss: 0.2211111
	speed: 0.0042s/iter; left time: 27.8471s
	iters: 700, epoch: 2 | loss: 0.8473796
	speed: 0.0039s/iter; left time: 25.2568s
	iters: 800, epoch: 2 | loss: 0.6022861
	speed: 0.0035s/iter; left time: 22.5735s
	iters: 900, epoch: 2 | loss: 0.5210019
	speed: 0.0035s/iter; left time: 22.3286s
	iters: 1000, epoch: 2 | loss: 0.4990345
	speed: 0.0031s/iter; left time: 18.9442s
Updating learning rate to 4.516374785e-05
Epoch: 2 cost time: 4.045562982559204
Epoch: 2, Steps: 1027 | Train Loss: 0.5901559 Vali Loss: 0.3903801 Best vali loss: 0.3645356
	iters: 100, epoch: 3 | loss: 0.9337766
	speed: 0.0104s/iter; left time: 63.0306s
	iters: 200, epoch: 3 | loss: 0.9676682
	speed: 0.0040s/iter; left time: 23.9041s
	iters: 300, epoch: 3 | loss: 0.3741365
	speed: 0.0036s/iter; left time: 20.9396s
	iters: 400, epoch: 3 | loss: 0.5500454
	speed: 0.0043s/iter; left time: 24.5517s
	iters: 500, epoch: 3 | loss: 0.3349373
	speed: 0.0042s/iter; left time: 23.8197s
	iters: 600, epoch: 3 | loss: 0.4912457
	speed: 0.0041s/iter; left time: 22.6116s
	iters: 700, epoch: 3 | loss: 0.2518018
	speed: 0.0048s/iter; left time: 26.0449s
	iters: 800, epoch: 3 | loss: 0.9918954
	speed: 0.0044s/iter; left time: 23.7539s
	iters: 900, epoch: 3 | loss: 0.3617814
	speed: 0.0033s/iter; left time: 17.4462s
	iters: 1000, epoch: 3 | loss: 0.5860931
	speed: 0.0034s/iter; left time: 17.4827s
Updating learning rate to 2.2581873925e-05
Epoch: 3 cost time: 4.1389100551605225
Epoch: 3, Steps: 1027 | Train Loss: 0.5843381 Vali Loss: 0.3789801 Best vali loss: 0.3645356

best validation loss 0.3645355883305106

{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0047463729232, 'e_layers': 4, 'learning_rate': 9.71227879e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.2935454
	speed: 0.0146s/iter; left time: 17.3406s
	iters: 200, epoch: 4 | loss: 0.4508451
	speed: 0.0091s/iter; left time: 9.8523s
Updating learning rate to 4.856139395e-05
Epoch: 4 cost time: 2.478145122528076
Epoch: 4, Steps: 257 | Train Loss: 0.3721952 Vali Loss: 0.3685492 Best vali loss: 0.3635714
	iters: 100, epoch: 5 | loss: 0.6337286
	speed: 0.0169s/iter; left time: 15.6641s
	iters: 200, epoch: 5 | loss: 0.5003902
	speed: 0.0089s/iter; left time: 7.3376s
Updating learning rate to 2.9977753032780698e-05
Epoch: 5 cost time: 2.2122747898101807
Epoch: 5, Steps: 257 | Train Loss: 0.5670594 Vali Loss: 0.3684041 Best vali loss: 0.3635714
	iters: 100, epoch: 6 | loss: 0.3551639
	speed: 0.0134s/iter; left time: 8.9757s
	iters: 200, epoch: 6 | loss: 0.6052393
	speed: 0.0088s/iter; left time: 5.0510s
Updating learning rate to 1.422330298408362e-05
Epoch: 6 cost time: 1.9694724082946777
Epoch: 6, Steps: 257 | Train Loss: 0.4802016 Vali Loss: 0.3656940 Best vali loss: 0.3635714
	iters: 100, epoch: 7 | loss: 0.4005733
	speed: 0.0173s/iter; left time: 7.1870s
	iters: 200, epoch: 7 | loss: 0.6270894
	speed: 0.0092s/iter; left time: 2.8896s
Updating learning rate to 3.6965160093775718e-06
Validation loss decreased (0.3636 --> 0.3606).  Saving model state dict ...
Epoch: 7 cost time: 2.269850730895996
Epoch: 7, Steps: 257 | Train Loss: 0.5138313 Vali Loss: 0.3605912 Best vali loss: 0.3605912
	iters: 100, epoch: 8 | loss: 0.5203607
	speed: 0.0185s/iter; left time: 2.9196s
	iters: 200, epoch: 8 | loss: 0.5534958
	speed: 0.0087s/iter; left time: 0.5030s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.288454532623291
Epoch: 8, Steps: 257 | Train Loss: 0.5369282 Vali Loss: 0.3618703 Best vali loss: 0.3605912

best validation loss 0.36059117698950477

{'batch_size': 32, 'd_core': 64, 'd_model': 256, 'dropout': 0.006344494624, 'e_layers': 1, 'learning_rate': 0.0005423807869, 'lradj': 'cosine', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6044385
	speed: 0.0088s/iter; left time: 17.2598s
	iters: 200, epoch: 1 | loss: 0.8202403
	speed: 0.0041s/iter; left time: 7.6384s
Updating learning rate to 0.0005217376473721379
Validation loss decreased (inf --> 0.3657).  Saving model state dict ...
Epoch: 1 cost time: 1.3085300922393799
Epoch: 1, Steps: 257 | Train Loss: 0.7123394 Vali Loss: 0.3657477 Best vali loss: 0.3657477
	iters: 100, epoch: 2 | loss: 0.7061197
	speed: 0.0100s/iter; left time: 16.9764s
	iters: 200, epoch: 2 | loss: 0.3865452
	speed: 0.0039s/iter; left time: 6.2916s
Updating learning rate to 0.00046295095965114284
Validation loss decreased (0.3657 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 1.0593938827514648
Epoch: 2, Steps: 257 | Train Loss: 0.5463324 Vali Loss: 0.3646734 Best vali loss: 0.3646734
	iters: 100, epoch: 3 | loss: 0.8939136
	speed: 0.0105s/iter; left time: 15.0875s
	iters: 200, epoch: 3 | loss: 0.7600423
	speed: 0.0041s/iter; left time: 5.5479s
Updating learning rate to 0.00037497046403988515
Epoch: 3 cost time: 1.1505494117736816
Epoch: 3, Steps: 257 | Train Loss: 0.8269779 Vali Loss: 0.3799446 Best vali loss: 0.3646734
	iters: 100, epoch: 4 | loss: 0.5920110
	speed: 0.0102s/iter; left time: 12.0679s
	iters: 200, epoch: 4 | loss: 0.6139932
	speed: 0.0038s/iter; left time: 4.1506s
Updating learning rate to 0.00027119039345
Epoch: 4 cost time: 1.081747055053711
Epoch: 4, Steps: 257 | Train Loss: 0.6030021 Vali Loss: 0.3860375 Best vali loss: 0.3646734
	iters: 100, epoch: 5 | loss: 0.4092683
	speed: 0.0101s/iter; left time: 9.4025s
	iters: 200, epoch: 5 | loss: 0.2741227
	speed: 0.0043s/iter; left time: 3.5338s
Updating learning rate to 0.00016741032286011486
Epoch: 5 cost time: 1.1138288974761963
Epoch: 5, Steps: 257 | Train Loss: 0.3416955 Vali Loss: 0.3851944 Best vali loss: 0.3646734
	iters: 100, epoch: 6 | loss: 0.5715512
	speed: 0.0105s/iter; left time: 7.0674s
	iters: 200, epoch: 6 | loss: 0.4391886
	speed: 0.0040s/iter; left time: 2.2747s
Updating learning rate to 7.942982724885713e-05
Epoch: 6 cost time: 1.1038188934326172
Epoch: 6, Steps: 257 | Train Loss: 0.5053699 Vali Loss: 0.3833373 Best vali loss: 0.3646734
	iters: 100, epoch: 7 | loss: 0.4415865
	speed: 0.0110s/iter; left time: 4.5666s
	iters: 200, epoch: 7 | loss: 0.4787951
	speed: 0.0043s/iter; left time: 1.3519s
Updating learning rate to 2.0643139527862082e-05
Epoch: 7 cost time: 1.1913387775421143
Epoch: 7, Steps: 257 | Train Loss: 0.4601908 Vali Loss: 0.3874914 Best vali loss: 0.3646734
	iters: 100, epoch: 8 | loss: 0.5122044
	speed: 0.0102s/iter; left time: 1.6095s
	iters: 200, epoch: 8 | loss: 0.2502945
	speed: 0.0039s/iter; left time: 0.2283s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.1045715808868408
Epoch: 8, Steps: 257 | Train Loss: 0.3812495 Vali Loss: 0.3903695 Best vali loss: 0.3646734

best validation loss 0.36467344739231006

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0009796137024, 'e_layers': 4, 'learning_rate': 0.0039423373884, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0039423373884
Validation loss decreased (inf --> 0.3966).  Saving model state dict ...
Epoch: 1 cost time: 1.1633522510528564
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3966086 Best vali loss: 0.3966086
Updating learning rate to 0.0019711686942
Epoch: 2 cost time: 0.8870298862457275
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.4068160 Best vali loss: 0.3966086
Updating learning rate to 0.0009855843471
Epoch: 3 cost time: 0.8719170093536377
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.4089662 Best vali loss: 0.3966086
Updating learning rate to 0.00049279217355
Epoch: 4 cost time: 0.9002025127410889
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.4044439 Best vali loss: 0.3966086
Updating learning rate to 0.000246396086775
Epoch: 5 cost time: 0.9013411998748779
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3992443 Best vali loss: 0.3966086
Updating learning rate to 0.0001231980433875
Epoch: 6 cost time: 0.865572452545166
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.4035247 Best vali loss: 0.3966086
Updating learning rate to 6.159902169375e-05
Epoch: 7 cost time: 0.8981716632843018
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.4026426 Best vali loss: 0.3966086
Updating learning rate to 3.0799510846875e-05
Epoch: 8 cost time: 0.8962106704711914
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.4032275 Best vali loss: 0.3966086

best validation loss 0.3966085858218562

{'batch_size': 16, 'd_core': 512, 'd_model': 256, 'dropout': 0.002325483877, 'e_layers': 3, 'learning_rate': 0.0029565654282, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6551530
	speed: 0.0095s/iter; left time: 38.1950s
	iters: 200, epoch: 1 | loss: 0.8725005
	speed: 0.0066s/iter; left time: 25.7173s
	iters: 300, epoch: 1 | loss: 0.8984844
	speed: 0.0062s/iter; left time: 23.6101s
	iters: 400, epoch: 1 | loss: 1.6505448
	speed: 0.0066s/iter; left time: 24.4293s
	iters: 500, epoch: 1 | loss: 0.8952186
	speed: 0.0048s/iter; left time: 17.5004s
Updating learning rate to 0.0029565654282
Validation loss decreased (inf --> 0.4045).  Saving model state dict ...
Epoch: 1 cost time: 3.2293574810028076
Epoch: 1, Steps: 514 | Train Loss: 0.9943803 Vali Loss: 0.4044636 Best vali loss: 0.4044636
	iters: 100, epoch: 2 | loss: 0.3915344
	speed: 0.0109s/iter; left time: 38.1855s
	iters: 200, epoch: 2 | loss: 0.4583873
	speed: 0.0063s/iter; left time: 21.3462s
	iters: 300, epoch: 2 | loss: 0.8931962
	speed: 0.0064s/iter; left time: 21.0442s
	iters: 400, epoch: 2 | loss: 0.6470363
	speed: 0.0066s/iter; left time: 21.2436s
	iters: 500, epoch: 2 | loss: 0.9997577
	speed: 0.0053s/iter; left time: 16.3617s
Updating learning rate to 0.0014782827141
Epoch: 2 cost time: 3.190887689590454
Epoch: 2, Steps: 514 | Train Loss: 0.6779824 Vali Loss: 0.4076770 Best vali loss: 0.4044636
	iters: 100, epoch: 3 | loss: 0.7360271
	speed: 0.0086s/iter; left time: 25.6543s
	iters: 200, epoch: 3 | loss: 0.6682783
	speed: 0.0065s/iter; left time: 18.6624s
	iters: 300, epoch: 3 | loss: 0.4585994
	speed: 0.0061s/iter; left time: 16.9634s
	iters: 400, epoch: 3 | loss: 1.3236517
	speed: 0.0062s/iter; left time: 16.7659s
	iters: 500, epoch: 3 | loss: 0.7633693
	speed: 0.0042s/iter; left time: 10.7539s
Updating learning rate to 0.00073914135705
Validation loss decreased (0.4045 --> 0.4028).  Saving model state dict ...
Epoch: 3 cost time: 2.8274669647216797
Epoch: 3, Steps: 514 | Train Loss: 0.7899852 Vali Loss: 0.4027941 Best vali loss: 0.4027941

best validation loss 0.40279409152351336

{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0084343460894, 'e_layers': 3, 'learning_rate': 0.0011030524514, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3841585
	speed: 0.0107s/iter; left time: 87.1864s
	iters: 200, epoch: 1 | loss: 0.9032630
	speed: 0.0048s/iter; left time: 38.3861s
	iters: 300, epoch: 1 | loss: 1.5248141
	speed: 0.0045s/iter; left time: 35.2546s
	iters: 400, epoch: 1 | loss: 0.4879042
	speed: 0.0041s/iter; left time: 32.1613s
	iters: 500, epoch: 1 | loss: 0.5638030
	speed: 0.0042s/iter; left time: 32.5475s
	iters: 600, epoch: 1 | loss: 0.2866832
	speed: 0.0040s/iter; left time: 30.3965s
	iters: 700, epoch: 1 | loss: 0.3380577
	speed: 0.0040s/iter; left time: 30.4371s
	iters: 800, epoch: 1 | loss: 0.9674756
	speed: 0.0040s/iter; left time: 29.7529s
	iters: 900, epoch: 1 | loss: 0.5367418
	speed: 0.0040s/iter; left time: 29.2016s
	iters: 1000, epoch: 1 | loss: 1.0980897
	speed: 0.0041s/iter; left time: 29.3826s
Updating learning rate to 0.0011030524514
Validation loss decreased (inf --> 0.3739).  Saving model state dict ...
Epoch: 1 cost time: 4.648548126220703
Epoch: 1, Steps: 1027 | Train Loss: 0.8090991 Vali Loss: 0.3739174 Best vali loss: 0.3739174
	iters: 100, epoch: 2 | loss: 0.2411700
	speed: 0.0128s/iter; left time: 90.8503s
	iters: 200, epoch: 2 | loss: 0.8788268
	speed: 0.0041s/iter; left time: 28.6172s
	iters: 300, epoch: 2 | loss: 0.3050060
	speed: 0.0041s/iter; left time: 28.4754s
	iters: 400, epoch: 2 | loss: 0.7240352
	speed: 0.0043s/iter; left time: 28.8628s
	iters: 500, epoch: 2 | loss: 0.3947736
	speed: 0.0043s/iter; left time: 28.8426s
	iters: 600, epoch: 2 | loss: 0.3143205
	speed: 0.0045s/iter; left time: 29.7779s
	iters: 700, epoch: 2 | loss: 0.8904927
	speed: 0.0042s/iter; left time: 27.1111s
	iters: 800, epoch: 2 | loss: 0.4583137
	speed: 0.0042s/iter; left time: 27.0834s
	iters: 900, epoch: 2 | loss: 0.9832344
	speed: 0.0044s/iter; left time: 27.6852s
	iters: 1000, epoch: 2 | loss: 0.6078448
	speed: 0.0044s/iter; left time: 27.4033s
Updating learning rate to 0.0005515262257
Epoch: 2 cost time: 4.458349704742432
Epoch: 2, Steps: 1027 | Train Loss: 0.5798018 Vali Loss: 0.3781321 Best vali loss: 0.3739174
	iters: 100, epoch: 3 | loss: 0.2116854
	speed: 0.0121s/iter; left time: 73.3014s
	iters: 200, epoch: 3 | loss: 0.4169885
	speed: 0.0046s/iter; left time: 27.1584s
	iters: 300, epoch: 3 | loss: 1.4898002
	speed: 0.0047s/iter; left time: 27.5013s
	iters: 400, epoch: 3 | loss: 0.7263218
	speed: 0.0046s/iter; left time: 26.4898s
	iters: 500, epoch: 3 | loss: 1.1493284
	speed: 0.0047s/iter; left time: 26.8955s
	iters: 600, epoch: 3 | loss: 0.3567002
	speed: 0.0047s/iter; left time: 25.9688s
	iters: 700, epoch: 3 | loss: 0.5803586
	speed: 0.0044s/iter; left time: 23.7942s
	iters: 800, epoch: 3 | loss: 0.3610756
	speed: 0.0048s/iter; left time: 25.9349s
	iters: 900, epoch: 3 | loss: 0.4314184
	speed: 0.0049s/iter; left time: 25.9431s
	iters: 1000, epoch: 3 | loss: 0.3790141
	speed: 0.0049s/iter; left time: 25.0522s
Updating learning rate to 0.00027576311285
Validation loss decreased (0.3739 --> 0.3735).  Saving model state dict ...
Epoch: 3 cost time: 4.8173136711120605
Epoch: 3, Steps: 1027 | Train Loss: 0.6102691 Vali Loss: 0.3734536 Best vali loss: 0.3734536

best validation loss 0.3734535783734209

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050872293761, 'e_layers': 4, 'learning_rate': 0.0001304544179, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5915017
	speed: 0.0138s/iter; left time: 12.8292s
Updating learning rate to 0.000125489292261742
Validation loss decreased (inf --> 0.3757).  Saving model state dict ...
Epoch: 1 cost time: 1.2838270664215088
Epoch: 1, Steps: 129 | Train Loss: 0.5915017 Vali Loss: 0.3756973 Best vali loss: 0.3756973
	iters: 100, epoch: 2 | loss: 0.7016392
	speed: 0.0123s/iter; left time: 9.8557s
Updating learning rate to 0.00011134981071641684
Validation loss decreased (0.3757 --> 0.3652).  Saving model state dict ...
Epoch: 2 cost time: 0.9613211154937744
Epoch: 2, Steps: 129 | Train Loss: 0.7016392 Vali Loss: 0.3652115 Best vali loss: 0.3652115
	iters: 100, epoch: 3 | loss: 0.5977924
	speed: 0.0123s/iter; left time: 8.2891s
Updating learning rate to 9.01885811545809e-05
Validation loss decreased (0.3652 --> 0.3631).  Saving model state dict ...
Epoch: 3 cost time: 0.9752175807952881
Epoch: 3, Steps: 129 | Train Loss: 0.5977924 Vali Loss: 0.3630577 Best vali loss: 0.3630577

best validation loss 0.3630577398658033

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0050872293761, 'e_layers': 4, 'learning_rate': 0.0001304544179, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5466661
	speed: 0.0140s/iter; left time: 7.6355s
Updating learning rate to 6.522720895e-05
Epoch: 4 cost time: 1.2603912353515625
Epoch: 4, Steps: 129 | Train Loss: 0.5466661 Vali Loss: 0.3646349 Best vali loss: 0.3630577
	iters: 100, epoch: 5 | loss: 0.6423762
	speed: 0.0118s/iter; left time: 4.9055s
Updating learning rate to 4.0265836745419096e-05
Epoch: 5 cost time: 0.8817400932312012
Epoch: 5, Steps: 129 | Train Loss: 0.6423762 Vali Loss: 0.3641314 Best vali loss: 0.3630577
	iters: 100, epoch: 6 | loss: 0.5631258
	speed: 0.0111s/iter; left time: 3.1824s
Updating learning rate to 1.910460718358314e-05
Epoch: 6 cost time: 0.9928989410400391
Epoch: 6, Steps: 129 | Train Loss: 0.5631258 Vali Loss: 0.3633367 Best vali loss: 0.3630577
	iters: 100, epoch: 7 | loss: 0.5679504
	speed: 0.0135s/iter; left time: 2.1454s
Updating learning rate to 4.965125638257981e-06
Epoch: 7 cost time: 1.1146433353424072
Epoch: 7, Steps: 129 | Train Loss: 0.5679504 Vali Loss: 0.3647851 Best vali loss: 0.3630577
	iters: 100, epoch: 8 | loss: 0.6991041
	speed: 0.0130s/iter; left time: 0.3911s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.043677568435669
Epoch: 8, Steps: 129 | Train Loss: 0.6991041 Vali Loss: 0.3646326 Best vali loss: 0.3630577

best validation loss 0.3630577398658033

{'batch_size': 32, 'd_core': 512, 'd_model': 512, 'dropout': 0.0018333163825, 'e_layers': 2, 'learning_rate': 0.0006860415015, 'lradj': 'type1', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6601641
	speed: 0.0122s/iter; left time: 23.8093s
	iters: 200, epoch: 1 | loss: 0.9979864
	speed: 0.0065s/iter; left time: 11.9940s
Updating learning rate to 0.0006860415015
Validation loss decreased (inf --> 0.3968).  Saving model state dict ...
Epoch: 1 cost time: 1.9107646942138672
Epoch: 1, Steps: 257 | Train Loss: 0.8290753 Vali Loss: 0.3968465 Best vali loss: 0.3968465
	iters: 100, epoch: 2 | loss: 0.3784843
	speed: 0.0140s/iter; left time: 23.7523s
	iters: 200, epoch: 2 | loss: 0.7336690
	speed: 0.0046s/iter; left time: 7.3318s
Updating learning rate to 0.00034302075075
Validation loss decreased (0.3968 --> 0.3898).  Saving model state dict ...
Epoch: 2 cost time: 1.322525978088379
Epoch: 2, Steps: 257 | Train Loss: 0.5560767 Vali Loss: 0.3898047 Best vali loss: 0.3898047
	iters: 100, epoch: 3 | loss: 0.8280920
	speed: 0.0120s/iter; left time: 17.3509s
	iters: 200, epoch: 3 | loss: 0.6647344
	speed: 0.0060s/iter; left time: 8.1189s
Updating learning rate to 0.000171510375375
Epoch: 3 cost time: 1.7005712985992432
Epoch: 3, Steps: 257 | Train Loss: 0.7464132 Vali Loss: 0.4080176 Best vali loss: 0.3898047
	iters: 100, epoch: 4 | loss: 0.3408343
	speed: 0.0147s/iter; left time: 17.4650s
	iters: 200, epoch: 4 | loss: 0.8671195
	speed: 0.0062s/iter; left time: 6.7610s
Updating learning rate to 8.57551876875e-05
Validation loss decreased (0.3898 --> 0.3765).  Saving model state dict ...
Epoch: 4 cost time: 1.5692832469940186
Epoch: 4, Steps: 257 | Train Loss: 0.6039769 Vali Loss: 0.3765242 Best vali loss: 0.3765242
	iters: 100, epoch: 5 | loss: 0.4670008
	speed: 0.0103s/iter; left time: 9.5262s
	iters: 200, epoch: 5 | loss: 0.6024041
	speed: 0.0074s/iter; left time: 6.1689s
Updating learning rate to 4.287759384375e-05
Epoch: 5 cost time: 1.5822956562042236
Epoch: 5, Steps: 257 | Train Loss: 0.5347025 Vali Loss: 0.3777018 Best vali loss: 0.3765242
	iters: 100, epoch: 6 | loss: 0.4840368
	speed: 0.0147s/iter; left time: 9.9110s
	iters: 200, epoch: 6 | loss: 0.3415657
	speed: 0.0065s/iter; left time: 3.7212s
Updating learning rate to 2.1438796921875e-05
Epoch: 6 cost time: 1.854724645614624
Epoch: 6, Steps: 257 | Train Loss: 0.4128012 Vali Loss: 0.3818091 Best vali loss: 0.3765242
	iters: 100, epoch: 7 | loss: 0.9406956
	speed: 0.0134s/iter; left time: 5.5539s
	iters: 200, epoch: 7 | loss: 0.8451414
	speed: 0.0043s/iter; left time: 1.3496s
Updating learning rate to 1.07193984609375e-05
Epoch: 7 cost time: 1.247114896774292
Epoch: 7, Steps: 257 | Train Loss: 0.8929185 Vali Loss: 0.3824707 Best vali loss: 0.3765242
	iters: 100, epoch: 8 | loss: 0.3375413
	speed: 0.0128s/iter; left time: 2.0183s
	iters: 200, epoch: 8 | loss: 0.6661268
	speed: 0.0064s/iter; left time: 0.3715s
Updating learning rate to 5.35969923046875e-06
Epoch: 8 cost time: 1.6986770629882812
Epoch: 8, Steps: 257 | Train Loss: 0.5018340 Vali Loss: 0.3873523 Best vali loss: 0.3765242

best validation loss 0.37652417431880075

{'batch_size': 128, 'd_core': 128, 'd_model': 64, 'dropout': 0.0008179554336, 'e_layers': 1, 'learning_rate': 0.0022030201293, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.002119172668235319
Validation loss decreased (inf --> 0.3692).  Saving model state dict ...
Epoch: 1 cost time: 0.7408347129821777
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3692027 Best vali loss: 0.3692027
Updating learning rate to 0.0018803953009092472
Validation loss decreased (0.3692 --> 0.3664).  Saving model state dict ...
Epoch: 2 cost time: 0.4536564350128174
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3663825 Best vali loss: 0.3663825
Updating learning rate to 0.001523039716974954
Epoch: 3 cost time: 0.48949718475341797
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3796241 Best vali loss: 0.3663825
Updating learning rate to 0.00110151006465
Epoch: 4 cost time: 0.3283731937408447
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3879192 Best vali loss: 0.3663825
Updating learning rate to 0.0006799804123250461
Epoch: 5 cost time: 0.3257310390472412
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3815278 Best vali loss: 0.3663825
Updating learning rate to 0.0003226248283907527
Epoch: 6 cost time: 0.4322366714477539
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3815366 Best vali loss: 0.3663825
Updating learning rate to 8.384746106468076e-05
Epoch: 7 cost time: 0.4640998840332031
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3837971 Best vali loss: 0.3663825
Updating learning rate to 0.0
Epoch: 8 cost time: 0.4517066478729248
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3872294 Best vali loss: 0.3663825

best validation loss 0.36638246623612575

{'batch_size': 32, 'd_core': 128, 'd_model': 128, 'dropout': 0.0026169542971, 'e_layers': 4, 'learning_rate': 9.00916415e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7121547
	speed: 0.0131s/iter; left time: 25.5934s
	iters: 200, epoch: 1 | loss: 0.8198088
	speed: 0.0074s/iter; left time: 13.6580s
Updating learning rate to 8.666273256609723e-05
Validation loss decreased (inf --> 0.3744).  Saving model state dict ...
Epoch: 1 cost time: 2.180393934249878
Epoch: 1, Steps: 257 | Train Loss: 0.7659818 Vali Loss: 0.3743644 Best vali loss: 0.3743644
	iters: 100, epoch: 2 | loss: 0.4925345
	speed: 0.0152s/iter; left time: 25.7984s
	iters: 200, epoch: 2 | loss: 0.6278667
	speed: 0.0073s/iter; left time: 11.6973s
Updating learning rate to 7.689802606643869e-05
Validation loss decreased (0.3744 --> 0.3659).  Saving model state dict ...
Epoch: 2 cost time: 1.9275949001312256
Epoch: 2, Steps: 257 | Train Loss: 0.5602006 Vali Loss: 0.3658814 Best vali loss: 0.3658814
	iters: 100, epoch: 3 | loss: 0.4193803
	speed: 0.0153s/iter; left time: 22.0308s
	iters: 200, epoch: 3 | loss: 0.6600857
	speed: 0.0072s/iter; left time: 9.7285s
Updating learning rate to 6.228411004831259e-05
Validation loss decreased (0.3659 --> 0.3653).  Saving model state dict ...
Epoch: 3 cost time: 1.9359169006347656
Epoch: 3, Steps: 257 | Train Loss: 0.5397330 Vali Loss: 0.3652788 Best vali loss: 0.3652788

best validation loss 0.3652787775679515

{'batch_size': 8, 'd_core': 32, 'd_model': 256, 'dropout': 0.0061161357241, 'e_layers': 4, 'learning_rate': 0.0038059297724, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.3221021
	speed: 0.0121s/iter; left time: 97.8193s
	iters: 200, epoch: 1 | loss: 0.8437035
	speed: 0.0066s/iter; left time: 52.9405s
	iters: 300, epoch: 1 | loss: 1.5540557
	speed: 0.0068s/iter; left time: 53.7784s
	iters: 400, epoch: 1 | loss: 0.5294926
	speed: 0.0066s/iter; left time: 51.7487s
	iters: 500, epoch: 1 | loss: 0.8565437
	speed: 0.0060s/iter; left time: 46.6763s
	iters: 600, epoch: 1 | loss: 1.2617116
	speed: 0.0063s/iter; left time: 47.8407s
	iters: 700, epoch: 1 | loss: 0.3976381
	speed: 0.0065s/iter; left time: 49.0858s
	iters: 800, epoch: 1 | loss: 0.7610527
	speed: 0.0066s/iter; left time: 49.0000s
	iters: 900, epoch: 1 | loss: 0.3145443
	speed: 0.0067s/iter; left time: 48.9212s
	iters: 1000, epoch: 1 | loss: 0.8421900
	speed: 0.0065s/iter; left time: 47.2689s
Updating learning rate to 0.0036610751956478497
Validation loss decreased (inf --> 0.3994).  Saving model state dict ...
Epoch: 1 cost time: 6.961291313171387
Epoch: 1, Steps: 1027 | Train Loss: 0.8683034 Vali Loss: 0.3994166 Best vali loss: 0.3994166
	iters: 100, epoch: 2 | loss: 0.4234272
	speed: 0.0171s/iter; left time: 121.3511s
	iters: 200, epoch: 2 | loss: 1.4137934
	speed: 0.0065s/iter; left time: 45.1570s
	iters: 300, epoch: 2 | loss: 0.5313246
	speed: 0.0073s/iter; left time: 50.2623s
	iters: 400, epoch: 2 | loss: 0.9922380
	speed: 0.0069s/iter; left time: 47.1540s
	iters: 500, epoch: 2 | loss: 0.4079732
	speed: 0.0055s/iter; left time: 37.0589s
	iters: 600, epoch: 2 | loss: 0.5982789
	speed: 0.0067s/iter; left time: 43.9750s
	iters: 700, epoch: 2 | loss: 1.4045130
	speed: 0.0067s/iter; left time: 43.4273s
	iters: 800, epoch: 2 | loss: 0.5846902
	speed: 0.0067s/iter; left time: 42.8883s
	iters: 900, epoch: 2 | loss: 0.7978706
	speed: 0.0067s/iter; left time: 41.8752s
	iters: 1000, epoch: 2 | loss: 0.3545745
	speed: 0.0064s/iter; left time: 39.6039s
Updating learning rate to 0.0032485642615919063
Epoch: 2 cost time: 6.799749851226807
Epoch: 2, Steps: 1027 | Train Loss: 0.7508684 Vali Loss: 0.4025200 Best vali loss: 0.3994166
	iters: 100, epoch: 3 | loss: 1.6584475
	speed: 0.0169s/iter; left time: 102.3300s
	iters: 200, epoch: 3 | loss: 0.5906323
	speed: 0.0067s/iter; left time: 40.0194s
	iters: 300, epoch: 3 | loss: 0.5541899
	speed: 0.0067s/iter; left time: 39.1218s
	iters: 400, epoch: 3 | loss: 0.8473615
	speed: 0.0064s/iter; left time: 36.8622s
	iters: 500, epoch: 3 | loss: 0.5593086
	speed: 0.0054s/iter; left time: 30.4627s
	iters: 600, epoch: 3 | loss: 0.2316776
	speed: 0.0048s/iter; left time: 26.9788s
	iters: 700, epoch: 3 | loss: 1.1366214
	speed: 0.0058s/iter; left time: 31.6110s
	iters: 800, epoch: 3 | loss: 0.2906910
	speed: 0.0064s/iter; left time: 34.3071s
	iters: 900, epoch: 3 | loss: 0.7345333
	speed: 0.0062s/iter; left time: 32.5997s
	iters: 1000, epoch: 3 | loss: 0.9707646
	speed: 0.0062s/iter; left time: 32.1874s
Updating learning rate to 0.0026311980205212587
Epoch: 3 cost time: 6.330914258956909
Epoch: 3, Steps: 1027 | Train Loss: 0.7574228 Vali Loss: 0.4022750 Best vali loss: 0.3994166

best validation loss 0.39941662831601554

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0092252495316, 'e_layers': 4, 'learning_rate': 0.0006913977983, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6771029
	speed: 0.0150s/iter; left time: 13.9727s
Updating learning rate to 0.0006650830364863684
Validation loss decreased (inf --> 0.3689).  Saving model state dict ...
Epoch: 1 cost time: 1.391500473022461
Epoch: 1, Steps: 129 | Train Loss: 0.6771029 Vali Loss: 0.3688968 Best vali loss: 0.3688968
	iters: 100, epoch: 2 | loss: 0.8428093
	speed: 0.0129s/iter; left time: 10.3700s
Updating learning rate to 0.0005901449349876894
Epoch: 2 cost time: 1.0022861957550049
Epoch: 2, Steps: 129 | Train Loss: 0.8428093 Vali Loss: 0.3715402 Best vali loss: 0.3688968
	iters: 100, epoch: 3 | loss: 0.6870795
	speed: 0.0128s/iter; left time: 8.6706s
Updating learning rate to 0.000477992140441555
Validation loss decreased (0.3689 --> 0.3647).  Saving model state dict ...
Epoch: 3 cost time: 1.0788910388946533
Epoch: 3, Steps: 129 | Train Loss: 0.6870795 Vali Loss: 0.3646526 Best vali loss: 0.3646526

best validation loss 0.3646525808425221

{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0092252495316, 'e_layers': 4, 'learning_rate': 0.0006913977983, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5686971
	speed: 0.0152s/iter; left time: 8.2725s
Updating learning rate to 0.00034569889915
Epoch: 4 cost time: 1.3836863040924072
Epoch: 4, Steps: 129 | Train Loss: 0.5686971 Vali Loss: 0.3688918 Best vali loss: 0.3646526
	iters: 100, epoch: 5 | loss: 0.7831678
	speed: 0.0133s/iter; left time: 5.5457s
Updating learning rate to 0.00021340565785844497
Validation loss decreased (0.3647 --> 0.3597).  Saving model state dict ...
Epoch: 5 cost time: 1.0996153354644775
Epoch: 5, Steps: 129 | Train Loss: 0.7831678 Vali Loss: 0.3596750 Best vali loss: 0.3596750
	iters: 100, epoch: 6 | loss: 0.6118168
	speed: 0.0124s/iter; left time: 3.5706s
Updating learning rate to 0.00010125286331231061
Validation loss decreased (0.3597 --> 0.3579).  Saving model state dict ...
Epoch: 6 cost time: 0.9911303520202637
Epoch: 6, Steps: 129 | Train Loss: 0.6118168 Vali Loss: 0.3578674 Best vali loss: 0.3578674
	iters: 100, epoch: 7 | loss: 0.3329024
	speed: 0.0126s/iter; left time: 2.0042s
Updating learning rate to 2.631476181363154e-05
Epoch: 7 cost time: 1.005396842956543
Epoch: 7, Steps: 129 | Train Loss: 0.3329024 Vali Loss: 0.3593415 Best vali loss: 0.3578674
	iters: 100, epoch: 8 | loss: 0.6466054
	speed: 0.0125s/iter; left time: 0.3754s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.0146596431732178
Epoch: 8, Steps: 129 | Train Loss: 0.6466054 Vali Loss: 0.3617363 Best vali loss: 0.3578674

best validation loss 0.35786739676780926

{'batch_size': 64, 'd_core': 256, 'd_model': 512, 'dropout': 0.0065507519564, 'e_layers': 1, 'learning_rate': 0.0001029375142, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6597663
	speed: 0.0106s/iter; left time: 9.8790s
Updating learning rate to 0.0001029375142
Validation loss decreased (inf --> 0.3685).  Saving model state dict ...
Epoch: 1 cost time: 0.8788599967956543
Epoch: 1, Steps: 129 | Train Loss: 0.6597663 Vali Loss: 0.3685391 Best vali loss: 0.3685391
	iters: 100, epoch: 2 | loss: 0.6657773
	speed: 0.0090s/iter; left time: 7.2440s
Updating learning rate to 5.14687571e-05
Validation loss decreased (0.3685 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.6216230392456055
Epoch: 2, Steps: 129 | Train Loss: 0.6657773 Vali Loss: 0.3647850 Best vali loss: 0.3647850
	iters: 100, epoch: 3 | loss: 0.4723150
	speed: 0.0083s/iter; left time: 5.5732s
Updating learning rate to 2.573437855e-05
Validation loss decreased (0.3648 --> 0.3638).  Saving model state dict ...
Epoch: 3 cost time: 0.6242635250091553
Epoch: 3, Steps: 129 | Train Loss: 0.4723150 Vali Loss: 0.3638434 Best vali loss: 0.3638434
	iters: 100, epoch: 4 | loss: 0.5392129
	speed: 0.0089s/iter; left time: 4.8410s
Updating learning rate to 1.2867189275e-05
Epoch: 4 cost time: 0.6064951419830322
Epoch: 4, Steps: 129 | Train Loss: 0.5392129 Vali Loss: 0.3641873 Best vali loss: 0.3638434
	iters: 100, epoch: 5 | loss: 0.6579215
	speed: 0.0087s/iter; left time: 3.6414s
Updating learning rate to 6.4335946375e-06
Epoch: 5 cost time: 0.656994104385376
Epoch: 5, Steps: 129 | Train Loss: 0.6579215 Vali Loss: 0.3655291 Best vali loss: 0.3638434
	iters: 100, epoch: 6 | loss: 0.6447431
	speed: 0.0091s/iter; left time: 2.6109s
Updating learning rate to 3.21679731875e-06
Epoch: 6 cost time: 0.6589586734771729
Epoch: 6, Steps: 129 | Train Loss: 0.6447431 Vali Loss: 0.3650819 Best vali loss: 0.3638434
	iters: 100, epoch: 7 | loss: 0.7102943
	speed: 0.0088s/iter; left time: 1.3970s
Updating learning rate to 1.608398659375e-06
Epoch: 7 cost time: 0.6371433734893799
Epoch: 7, Steps: 129 | Train Loss: 0.7102943 Vali Loss: 0.3654056 Best vali loss: 0.3638434
	iters: 100, epoch: 8 | loss: 0.5287963
	speed: 0.0087s/iter; left time: 0.2604s
Updating learning rate to 8.041993296875e-07
Epoch: 8 cost time: 0.6384117603302002
Epoch: 8, Steps: 129 | Train Loss: 0.5287963 Vali Loss: 0.3655918 Best vali loss: 0.3638434

best validation loss 0.36384343920615897

{'batch_size': 16, 'd_core': 128, 'd_model': 64, 'dropout': 0.0010787314027, 'e_layers': 1, 'learning_rate': 6.93882705e-05, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4971237
	speed: 0.0094s/iter; left time: 37.6977s
	iters: 200, epoch: 1 | loss: 0.8461618
	speed: 0.0038s/iter; left time: 14.7264s
	iters: 300, epoch: 1 | loss: 0.4817981
	speed: 0.0035s/iter; left time: 13.5224s
	iters: 400, epoch: 1 | loss: 1.3037491
	speed: 0.0036s/iter; left time: 13.3475s
	iters: 500, epoch: 1 | loss: 0.6292838
	speed: 0.0036s/iter; left time: 13.1363s
Updating learning rate to 6.674733670565335e-05
Validation loss decreased (inf --> 0.3951).  Saving model state dict ...
Epoch: 1 cost time: 2.1610896587371826
Epoch: 1, Steps: 514 | Train Loss: 0.7516233 Vali Loss: 0.3950686 Best vali loss: 0.3950686
	iters: 100, epoch: 2 | loss: 0.5717355
	speed: 0.0096s/iter; left time: 33.5159s
	iters: 200, epoch: 2 | loss: 0.4075691
	speed: 0.0035s/iter; left time: 12.0579s
	iters: 300, epoch: 2 | loss: 1.3103912
	speed: 0.0038s/iter; left time: 12.5527s
	iters: 400, epoch: 2 | loss: 0.8429524
	speed: 0.0036s/iter; left time: 11.5335s
	iters: 500, epoch: 2 | loss: 0.7545180
	speed: 0.0037s/iter; left time: 11.3883s
Updating learning rate to 5.922659355267823e-05
Validation loss decreased (0.3951 --> 0.3774).  Saving model state dict ...
Epoch: 2 cost time: 1.952282428741455
Epoch: 2, Steps: 514 | Train Loss: 0.7774332 Vali Loss: 0.3774098 Best vali loss: 0.3774098
	iters: 100, epoch: 3 | loss: 1.5489047
	speed: 0.0098s/iter; left time: 29.3100s
	iters: 200, epoch: 3 | loss: 0.4224116
	speed: 0.0038s/iter; left time: 11.0075s
	iters: 300, epoch: 3 | loss: 0.3396593
	speed: 0.0040s/iter; left time: 11.2238s
	iters: 400, epoch: 3 | loss: 0.6850667
	speed: 0.0039s/iter; left time: 10.3405s
	iters: 500, epoch: 3 | loss: 0.5768148
	speed: 0.0036s/iter; left time: 9.2906s
Updating learning rate to 4.7971006010408654e-05
Validation loss decreased (0.3774 --> 0.3699).  Saving model state dict ...
Epoch: 3 cost time: 2.015852928161621
Epoch: 3, Steps: 514 | Train Loss: 0.7145714 Vali Loss: 0.3698868 Best vali loss: 0.3698868
	iters: 100, epoch: 4 | loss: 0.2728103
	speed: 0.0089s/iter; left time: 22.0701s
	iters: 200, epoch: 4 | loss: 0.8499908
	speed: 0.0034s/iter; left time: 8.1453s
	iters: 300, epoch: 4 | loss: 0.4876900
	speed: 0.0038s/iter; left time: 8.6142s
	iters: 400, epoch: 4 | loss: 0.5857663
	speed: 0.0037s/iter; left time: 7.9433s
	iters: 500, epoch: 4 | loss: 0.6747943
	speed: 0.0038s/iter; left time: 7.7768s
Updating learning rate to 3.469413525e-05
Validation loss decreased (0.3699 --> 0.3670).  Saving model state dict ...
Epoch: 4 cost time: 1.9084017276763916
Epoch: 4, Steps: 514 | Train Loss: 0.5742103 Vali Loss: 0.3669545 Best vali loss: 0.3669545
	iters: 100, epoch: 5 | loss: 0.7085575
	speed: 0.0099s/iter; left time: 19.3280s
	iters: 200, epoch: 5 | loss: 0.2748803
	speed: 0.0037s/iter; left time: 6.8401s
	iters: 300, epoch: 5 | loss: 0.9338483
	speed: 0.0037s/iter; left time: 6.4609s
	iters: 400, epoch: 5 | loss: 1.0047086
	speed: 0.0037s/iter; left time: 6.2079s
	iters: 500, epoch: 5 | loss: 0.6809750
	speed: 0.0035s/iter; left time: 5.5251s
Updating learning rate to 2.141726448959135e-05
Validation loss decreased (0.3670 --> 0.3663).  Saving model state dict ...
Epoch: 5 cost time: 1.9552860260009766
Epoch: 5, Steps: 514 | Train Loss: 0.7205939 Vali Loss: 0.3662723 Best vali loss: 0.3662723
	iters: 100, epoch: 6 | loss: 0.5201751
	speed: 0.0096s/iter; left time: 13.8093s
	iters: 200, epoch: 6 | loss: 1.0542566
	speed: 0.0035s/iter; left time: 4.6440s
	iters: 300, epoch: 6 | loss: 0.2973658
	speed: 0.0035s/iter; left time: 4.3520s
	iters: 400, epoch: 6 | loss: 0.2062369
	speed: 0.0037s/iter; left time: 4.2522s
	iters: 500, epoch: 6 | loss: 0.2671309
	speed: 0.0039s/iter; left time: 4.0921s
Updating learning rate to 1.0161676947321766e-05
Validation loss decreased (0.3663 --> 0.3659).  Saving model state dict ...
Epoch: 6 cost time: 1.9126863479614258
Epoch: 6, Steps: 514 | Train Loss: 0.4690331 Vali Loss: 0.3658671 Best vali loss: 0.3658671
	iters: 100, epoch: 7 | loss: 0.9927748
	speed: 0.0095s/iter; left time: 8.8354s
	iters: 200, epoch: 7 | loss: 0.4476634
	speed: 0.0036s/iter; left time: 3.0187s
	iters: 300, epoch: 7 | loss: 0.2935241
	speed: 0.0040s/iter; left time: 2.9319s
	iters: 400, epoch: 7 | loss: 0.8823549
	speed: 0.0037s/iter; left time: 2.3111s
	iters: 500, epoch: 7 | loss: 0.7345364
	speed: 0.0040s/iter; left time: 2.1374s
Updating learning rate to 2.6409337943466457e-06
Validation loss decreased (0.3659 --> 0.3657).  Saving model state dict ...
Epoch: 7 cost time: 1.9745993614196777
Epoch: 7, Steps: 514 | Train Loss: 0.6701707 Vali Loss: 0.3657110 Best vali loss: 0.3657110
	iters: 100, epoch: 8 | loss: 0.5865689
	speed: 0.0100s/iter; left time: 4.1487s
	iters: 200, epoch: 8 | loss: 0.6725751
	speed: 0.0037s/iter; left time: 1.1685s
	iters: 300, epoch: 8 | loss: 0.4808227
	speed: 0.0035s/iter; left time: 0.7437s
	iters: 400, epoch: 8 | loss: 1.0576310
	speed: 0.0030s/iter; left time: 0.3501s
	iters: 500, epoch: 8 | loss: 0.9217345
	speed: 0.0024s/iter; left time: 0.0361s
Updating learning rate to 0.0
Validation loss decreased (0.3657 --> 0.3657).  Saving model state dict ...
Epoch: 8 cost time: 1.7210161685943604
Epoch: 8, Steps: 514 | Train Loss: 0.7438664 Vali Loss: 0.3656805 Best vali loss: 0.3656805

best validation loss 0.36568046097144163

{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0021613678694, 'e_layers': 3, 'learning_rate': 0.0003089520735, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0003089520735
Validation loss decreased (inf --> 0.4085).  Saving model state dict ...
Epoch: 1 cost time: 0.8522458076477051
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.4085282 Best vali loss: 0.4085282
Updating learning rate to 0.00015447603675
Validation loss decreased (0.4085 --> 0.3874).  Saving model state dict ...
Epoch: 2 cost time: 0.5825059413909912
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3874205 Best vali loss: 0.3874205
Updating learning rate to 7.7238018375e-05
Validation loss decreased (0.3874 --> 0.3819).  Saving model state dict ...
Epoch: 3 cost time: 0.6397979259490967
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3818692 Best vali loss: 0.3818692

best validation loss 0.38186922430523723

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0117286521251, 'e_layers': 1, 'learning_rate': 0.0001923981906, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5795508
	speed: 0.0117s/iter; left time: 10.9555s
Updating learning rate to 0.00018507547049377273
Validation loss decreased (inf --> 0.3609).  Saving model state dict ...
Epoch: 1 cost time: 0.9356122016906738
Epoch: 1, Steps: 129 | Train Loss: 0.5795508 Vali Loss: 0.3608857 Best vali loss: 0.3608857
	iters: 100, epoch: 2 | loss: 0.7872107
	speed: 0.0089s/iter; left time: 7.1803s
Updating learning rate to 0.00016422212793064094
Epoch: 2 cost time: 0.7114927768707275
Epoch: 2, Steps: 129 | Train Loss: 0.7872107 Vali Loss: 0.3645179 Best vali loss: 0.3608857
	iters: 100, epoch: 3 | loss: 0.4936263
	speed: 0.0095s/iter; left time: 6.4366s
Updating learning rate to 0.0001330128952798204
Epoch: 3 cost time: 0.712590217590332
Epoch: 3, Steps: 129 | Train Loss: 0.4936263 Vali Loss: 0.3694055 Best vali loss: 0.3608857

best validation loss 0.3608857323120994

{'batch_size': 128, 'd_core': 256, 'd_model': 64, 'dropout': 0.0042120649381, 'e_layers': 1, 'learning_rate': 0.0036397684012, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.003501237965075005
Validation loss decreased (inf --> 0.3732).  Saving model state dict ...
Epoch: 1 cost time: 0.5659923553466797
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3732017 Best vali loss: 0.3732017
Updating learning rate to 0.003106736659818519
Validation loss decreased (0.3732 --> 0.3711).  Saving model state dict ...
Epoch: 2 cost time: 0.4629020690917969
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3711013 Best vali loss: 0.3711013
Updating learning rate to 0.002516323732992606
Validation loss decreased (0.3711 --> 0.3693).  Saving model state dict ...
Epoch: 3 cost time: 0.4456355571746826
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3692938 Best vali loss: 0.3692938

best validation loss 0.3692937571430956

{'batch_size': 64, 'd_core': 128, 'd_model': 512, 'dropout': 0.0117286521251, 'e_layers': 1, 'learning_rate': 0.0001923981906, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5215138
	speed: 0.0107s/iter; left time: 5.8429s
Updating learning rate to 9.61990953e-05
Epoch: 4 cost time: 0.890934944152832
Epoch: 4, Steps: 129 | Train Loss: 0.5215138 Vali Loss: 0.3753241 Best vali loss: 0.3608857
	iters: 100, epoch: 5 | loss: 0.6762324
	speed: 0.0094s/iter; left time: 3.9208s
Updating learning rate to 5.9385295320179635e-05
Epoch: 5 cost time: 0.6515591144561768
Epoch: 5, Steps: 129 | Train Loss: 0.6762324 Vali Loss: 0.3772283 Best vali loss: 0.3608857
	iters: 100, epoch: 6 | loss: 0.4468942
	speed: 0.0088s/iter; left time: 2.5224s
Updating learning rate to 2.8176062669359075e-05
Epoch: 6 cost time: 0.6529502868652344
Epoch: 6, Steps: 129 | Train Loss: 0.4468942 Vali Loss: 0.3813672 Best vali loss: 0.3608857
	iters: 100, epoch: 7 | loss: 0.6930515
	speed: 0.0088s/iter; left time: 1.4030s
Updating learning rate to 7.322720106227279e-06
Epoch: 7 cost time: 0.6421029567718506
Epoch: 7, Steps: 129 | Train Loss: 0.6930515 Vali Loss: 0.3828188 Best vali loss: 0.3608857
	iters: 100, epoch: 8 | loss: 0.5280367
	speed: 0.0084s/iter; left time: 0.2524s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6438720226287842
Epoch: 8, Steps: 129 | Train Loss: 0.5280367 Vali Loss: 0.3810504 Best vali loss: 0.3608857

best validation loss 0.3608857323120994

{'batch_size': 64, 'd_core': 256, 'd_model': 32, 'dropout': 0.0035319109171, 'e_layers': 1, 'learning_rate': 0.000506690727, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9001640
	speed: 0.0114s/iter; left time: 10.5902s
Updating learning rate to 0.000487405959494282
Validation loss decreased (inf --> 0.3818).  Saving model state dict ...
Epoch: 1 cost time: 0.9604628086090088
Epoch: 1, Steps: 129 | Train Loss: 0.9001640 Vali Loss: 0.3817620 Best vali loss: 0.3817620
	iters: 100, epoch: 2 | loss: 0.5798599
	speed: 0.0066s/iter; left time: 5.3217s
Updating learning rate to 0.0004324875880130208
Validation loss decreased (0.3818 --> 0.3684).  Saving model state dict ...
Epoch: 2 cost time: 0.45273327827453613
Epoch: 2, Steps: 129 | Train Loss: 0.5798599 Vali Loss: 0.3683759 Best vali loss: 0.3683759
	iters: 100, epoch: 3 | loss: 0.8038587
	speed: 0.0070s/iter; left time: 4.7562s
Updating learning rate to 0.00035029643677796134
Validation loss decreased (0.3684 --> 0.3649).  Saving model state dict ...
Epoch: 3 cost time: 0.6103463172912598
Epoch: 3, Steps: 129 | Train Loss: 0.8038587 Vali Loss: 0.3648905 Best vali loss: 0.3648905
	iters: 100, epoch: 4 | loss: 0.6032028
	speed: 0.0093s/iter; left time: 5.0581s
Updating learning rate to 0.0002533453635
Epoch: 4 cost time: 0.7083723545074463
Epoch: 4, Steps: 129 | Train Loss: 0.6032028 Vali Loss: 0.3663004 Best vali loss: 0.3648905
	iters: 100, epoch: 5 | loss: 0.7286001
	speed: 0.0086s/iter; left time: 3.5960s
Updating learning rate to 0.00015639429022203867
Epoch: 5 cost time: 0.7142150402069092
Epoch: 5, Steps: 129 | Train Loss: 0.7286001 Vali Loss: 0.3665319 Best vali loss: 0.3648905
	iters: 100, epoch: 6 | loss: 0.7250240
	speed: 0.0066s/iter; left time: 1.8964s
Updating learning rate to 7.420313898697917e-05
Epoch: 6 cost time: 0.43916916847229004
Epoch: 6, Steps: 129 | Train Loss: 0.7250240 Vali Loss: 0.3677222 Best vali loss: 0.3648905
	iters: 100, epoch: 7 | loss: 0.4162918
	speed: 0.0067s/iter; left time: 1.0612s
Updating learning rate to 1.9284767505717994e-05
Epoch: 7 cost time: 0.5856566429138184
Epoch: 7, Steps: 129 | Train Loss: 0.4162918 Vali Loss: 0.3681047 Best vali loss: 0.3648905
	iters: 100, epoch: 8 | loss: 0.4936299
	speed: 0.0087s/iter; left time: 0.2601s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6720175743103027
Epoch: 8, Steps: 129 | Train Loss: 0.4936299 Vali Loss: 0.3679816 Best vali loss: 0.3648905

best validation loss 0.36489046789808216

{'batch_size': 32, 'd_core': 256, 'd_model': 32, 'dropout': 0.0053854283141, 'e_layers': 2, 'learning_rate': 0.0047874674618, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3483218
	speed: 0.0111s/iter; left time: 21.8204s
	iters: 200, epoch: 1 | loss: 0.6115900
	speed: 0.0053s/iter; left time: 9.8266s
Updating learning rate to 0.0047874674618
Validation loss decreased (inf --> 0.3716).  Saving model state dict ...
Epoch: 1 cost time: 1.668748378753662
Epoch: 1, Steps: 257 | Train Loss: 0.4799559 Vali Loss: 0.3715570 Best vali loss: 0.3715570
	iters: 100, epoch: 2 | loss: 0.7925813
	speed: 0.0122s/iter; left time: 20.6969s
	iters: 200, epoch: 2 | loss: 0.4552237
	speed: 0.0054s/iter; left time: 8.5801s
Updating learning rate to 0.0023937337309
Validation loss decreased (0.3716 --> 0.3673).  Saving model state dict ...
Epoch: 2 cost time: 1.4295260906219482
Epoch: 2, Steps: 257 | Train Loss: 0.6239025 Vali Loss: 0.3672926 Best vali loss: 0.3672926
	iters: 100, epoch: 3 | loss: 0.3716049
	speed: 0.0123s/iter; left time: 17.6857s
	iters: 200, epoch: 3 | loss: 0.3174538
	speed: 0.0053s/iter; left time: 7.1235s
Updating learning rate to 0.00119686686545
Epoch: 3 cost time: 1.440577507019043
Epoch: 3, Steps: 257 | Train Loss: 0.3445293 Vali Loss: 0.3830471 Best vali loss: 0.3672926
	iters: 100, epoch: 4 | loss: 0.7075187
	speed: 0.0123s/iter; left time: 14.5839s
	iters: 200, epoch: 4 | loss: 0.8509989
	speed: 0.0055s/iter; left time: 5.9987s
Updating learning rate to 0.000598433432725
Epoch: 4 cost time: 1.4620859622955322
Epoch: 4, Steps: 257 | Train Loss: 0.7792588 Vali Loss: 0.3831818 Best vali loss: 0.3672926
	iters: 100, epoch: 5 | loss: 0.7836351
	speed: 0.0115s/iter; left time: 10.6871s
	iters: 200, epoch: 5 | loss: 0.7615880
	speed: 0.0055s/iter; left time: 4.5997s
Updating learning rate to 0.0002992167163625
Epoch: 5 cost time: 1.4315545558929443
Epoch: 5, Steps: 257 | Train Loss: 0.7726116 Vali Loss: 0.3883570 Best vali loss: 0.3672926
	iters: 100, epoch: 6 | loss: 0.4884070
	speed: 0.0118s/iter; left time: 7.9345s
	iters: 200, epoch: 6 | loss: 0.6246569
	speed: 0.0054s/iter; left time: 3.0796s
Updating learning rate to 0.00014960835818125
Epoch: 6 cost time: 1.3950345516204834
Epoch: 6, Steps: 257 | Train Loss: 0.5565320 Vali Loss: 0.3873862 Best vali loss: 0.3672926
	iters: 100, epoch: 7 | loss: 0.8315223
	speed: 0.0116s/iter; left time: 4.8139s
	iters: 200, epoch: 7 | loss: 0.6992599
	speed: 0.0055s/iter; left time: 1.7363s
Updating learning rate to 7.4804179090625e-05
Epoch: 7 cost time: 1.4242823123931885
Epoch: 7, Steps: 257 | Train Loss: 0.7653911 Vali Loss: 0.3901323 Best vali loss: 0.3672926
	iters: 100, epoch: 8 | loss: 0.3839990
	speed: 0.0119s/iter; left time: 1.8763s
	iters: 200, epoch: 8 | loss: 1.0923002
	speed: 0.0053s/iter; left time: 0.3101s
Updating learning rate to 3.74020895453125e-05
Epoch: 8 cost time: 1.4246258735656738
Epoch: 8, Steps: 257 | Train Loss: 0.7381496 Vali Loss: 0.3892107 Best vali loss: 0.3672926

best validation loss 0.36729264589564503

{'batch_size': 16, 'd_core': 32, 'd_model': 32, 'dropout': 0.0039151845006, 'e_layers': 1, 'learning_rate': 0.0002904722279, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3161443
	speed: 0.0084s/iter; left time: 33.5832s
	iters: 200, epoch: 1 | loss: 0.8359634
	speed: 0.0025s/iter; left time: 9.6106s
	iters: 300, epoch: 1 | loss: 0.6356059
	speed: 0.0025s/iter; left time: 9.5433s
	iters: 400, epoch: 1 | loss: 0.3762938
	speed: 0.0025s/iter; left time: 9.2897s
	iters: 500, epoch: 1 | loss: 0.6473472
	speed: 0.0026s/iter; left time: 9.4203s
Updating learning rate to 0.0002904722279
Validation loss decreased (inf --> 0.3762).  Saving model state dict ...
Epoch: 1 cost time: 1.5876803398132324
Epoch: 1, Steps: 514 | Train Loss: 0.5622709 Vali Loss: 0.3762299 Best vali loss: 0.3762299
	iters: 100, epoch: 2 | loss: 0.5064721
	speed: 0.0082s/iter; left time: 28.8643s
	iters: 200, epoch: 2 | loss: 1.4438742
	speed: 0.0038s/iter; left time: 12.8724s
	iters: 300, epoch: 2 | loss: 0.9240772
	speed: 0.0034s/iter; left time: 11.1859s
	iters: 400, epoch: 2 | loss: 0.7032017
	speed: 0.0037s/iter; left time: 11.8549s
	iters: 500, epoch: 2 | loss: 0.7837756
	speed: 0.0039s/iter; left time: 11.9886s
Updating learning rate to 0.00014523611395
Validation loss decreased (0.3762 --> 0.3663).  Saving model state dict ...
Epoch: 2 cost time: 1.9439377784729004
Epoch: 2, Steps: 514 | Train Loss: 0.8722802 Vali Loss: 0.3662893 Best vali loss: 0.3662893
	iters: 100, epoch: 3 | loss: 1.3025098
	speed: 0.0092s/iter; left time: 27.3571s
	iters: 200, epoch: 3 | loss: 0.2716123
	speed: 0.0037s/iter; left time: 10.7417s
	iters: 300, epoch: 3 | loss: 1.3376305
	speed: 0.0040s/iter; left time: 11.0602s
	iters: 400, epoch: 3 | loss: 0.8324164
	speed: 0.0037s/iter; left time: 9.9949s
	iters: 500, epoch: 3 | loss: 0.5722959
	speed: 0.0034s/iter; left time: 8.8346s
Updating learning rate to 7.2618056975e-05
Validation loss decreased (0.3663 --> 0.3641).  Saving model state dict ...
Epoch: 3 cost time: 1.9031567573547363
Epoch: 3, Steps: 514 | Train Loss: 0.8632930 Vali Loss: 0.3640730 Best vali loss: 0.3640730

best validation loss 0.3640729640111005

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013304591752, 'e_layers': 2, 'learning_rate': 0.0007475733017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6375171
	speed: 0.0131s/iter; left time: 12.1823s
Updating learning rate to 0.0007475733017
Validation loss decreased (inf --> 0.3863).  Saving model state dict ...
Epoch: 1 cost time: 1.1694362163543701
Epoch: 1, Steps: 129 | Train Loss: 0.6375171 Vali Loss: 0.3862907 Best vali loss: 0.3862907
	iters: 100, epoch: 2 | loss: 0.6738933
	speed: 0.0107s/iter; left time: 8.5693s
Updating learning rate to 0.00037378665085
Validation loss decreased (0.3863 --> 0.3648).  Saving model state dict ...
Epoch: 2 cost time: 0.8875892162322998
Epoch: 2, Steps: 129 | Train Loss: 0.6738933 Vali Loss: 0.3648465 Best vali loss: 0.3648465
	iters: 100, epoch: 3 | loss: 0.5362480
	speed: 0.0099s/iter; left time: 6.7044s
Updating learning rate to 0.000186893325425
Validation loss decreased (0.3648 --> 0.3639).  Saving model state dict ...
Epoch: 3 cost time: 0.7713737487792969
Epoch: 3, Steps: 129 | Train Loss: 0.5362480 Vali Loss: 0.3639099 Best vali loss: 0.3639099

best validation loss 0.363909882974531

{'batch_size': 64, 'd_core': 128, 'd_model': 64, 'dropout': 0.0048175691372, 'e_layers': 4, 'learning_rate': 0.0003697053685, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8762042
	speed: 0.0144s/iter; left time: 13.4171s
Updating learning rate to 0.0003556342957583465
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 1.3008644580841064
Epoch: 1, Steps: 129 | Train Loss: 0.8762042 Vali Loss: 0.3720981 Best vali loss: 0.3720981
	iters: 100, epoch: 2 | loss: 0.5080222
	speed: 0.0102s/iter; left time: 8.1963s
Updating learning rate to 0.0003155632708037107
Validation loss decreased (0.3721 --> 0.3694).  Saving model state dict ...
Epoch: 2 cost time: 0.8910996913909912
Epoch: 2, Steps: 129 | Train Loss: 0.5080222 Vali Loss: 0.3693993 Best vali loss: 0.3693993
	iters: 100, epoch: 3 | loss: 0.5846406
	speed: 0.0127s/iter; left time: 8.5900s
Updating learning rate to 0.0002555927439406902
Validation loss decreased (0.3694 --> 0.3684).  Saving model state dict ...
Epoch: 3 cost time: 1.0488555431365967
Epoch: 3, Steps: 129 | Train Loss: 0.5846406 Vali Loss: 0.3684309 Best vali loss: 0.3684309

best validation loss 0.36843085522033375

{'batch_size': 64, 'd_core': 128, 'd_model': 128, 'dropout': 0.0013304591752, 'e_layers': 2, 'learning_rate': 0.0007475733017, 'lradj': 'type1', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5168174
	speed: 0.0129s/iter; left time: 7.0321s
Updating learning rate to 9.34466627125e-05
Epoch: 4 cost time: 1.1099069118499756
Epoch: 4, Steps: 129 | Train Loss: 0.5168174 Vali Loss: 0.3652587 Best vali loss: 0.3639099
	iters: 100, epoch: 5 | loss: 0.4980528
	speed: 0.0105s/iter; left time: 4.3769s
Updating learning rate to 4.672333135625e-05
Validation loss decreased (0.3639 --> 0.3540).  Saving model state dict ...
Epoch: 5 cost time: 0.8553431034088135
Epoch: 5, Steps: 129 | Train Loss: 0.4980528 Vali Loss: 0.3539791 Best vali loss: 0.3539791
	iters: 100, epoch: 6 | loss: 0.4841587
	speed: 0.0107s/iter; left time: 3.0798s
Updating learning rate to 2.3361665678125e-05
Epoch: 6 cost time: 0.8624391555786133
Epoch: 6, Steps: 129 | Train Loss: 0.4841587 Vali Loss: 0.3630156 Best vali loss: 0.3539791
	iters: 100, epoch: 7 | loss: 0.5117605
	speed: 0.0109s/iter; left time: 1.7375s
Updating learning rate to 1.16808328390625e-05
Epoch: 7 cost time: 0.8960251808166504
Epoch: 7, Steps: 129 | Train Loss: 0.5117605 Vali Loss: 0.3673579 Best vali loss: 0.3539791
	iters: 100, epoch: 8 | loss: 0.3196678
	speed: 0.0109s/iter; left time: 0.3277s
Updating learning rate to 5.84041641953125e-06
Epoch: 8 cost time: 0.8403286933898926
Epoch: 8, Steps: 129 | Train Loss: 0.3196678 Vali Loss: 0.3624158 Best vali loss: 0.3539791

best validation loss 0.3539791484127344

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0031278255798, 'e_layers': 4, 'learning_rate': 0.0001800603475, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 1.0464631
	speed: 0.0126s/iter; left time: 50.4389s
	iters: 200, epoch: 1 | loss: 0.9909223
	speed: 0.0071s/iter; left time: 27.6575s
	iters: 300, epoch: 1 | loss: 0.3331173
	speed: 0.0072s/iter; left time: 27.4288s
	iters: 400, epoch: 1 | loss: 0.7814925
	speed: 0.0069s/iter; left time: 25.5384s
	iters: 500, epoch: 1 | loss: 0.4855352
	speed: 0.0072s/iter; left time: 25.9394s
Updating learning rate to 0.0001800603475
Validation loss decreased (inf --> 0.3682).  Saving model state dict ...
Epoch: 1 cost time: 3.931633949279785
Epoch: 1, Steps: 514 | Train Loss: 0.7275061 Vali Loss: 0.3682316 Best vali loss: 0.3682316
	iters: 100, epoch: 2 | loss: 0.7238010
	speed: 0.0144s/iter; left time: 50.4495s
	iters: 200, epoch: 2 | loss: 0.6575814
	speed: 0.0071s/iter; left time: 24.1112s
	iters: 300, epoch: 2 | loss: 0.7702605
	speed: 0.0072s/iter; left time: 23.7039s
	iters: 400, epoch: 2 | loss: 0.9175112
	speed: 0.0063s/iter; left time: 20.0036s
	iters: 500, epoch: 2 | loss: 0.6821106
	speed: 0.0048s/iter; left time: 14.7271s
Updating learning rate to 9.003017375e-05
Validation loss decreased (0.3682 --> 0.3621).  Saving model state dict ...
Epoch: 2 cost time: 3.3289542198181152
Epoch: 2, Steps: 514 | Train Loss: 0.7502529 Vali Loss: 0.3621368 Best vali loss: 0.3621368
	iters: 100, epoch: 3 | loss: 0.3618521
	speed: 0.0131s/iter; left time: 39.0171s
	iters: 200, epoch: 3 | loss: 0.7888680
	speed: 0.0074s/iter; left time: 21.2846s
	iters: 300, epoch: 3 | loss: 0.6642640
	speed: 0.0071s/iter; left time: 19.6755s
	iters: 400, epoch: 3 | loss: 0.7586697
	speed: 0.0049s/iter; left time: 13.2746s
	iters: 500, epoch: 3 | loss: 0.4278356
	speed: 0.0062s/iter; left time: 16.1481s
Updating learning rate to 4.5015086875e-05
Validation loss decreased (0.3621 --> 0.3575).  Saving model state dict ...
Epoch: 3 cost time: 3.4209396839141846
Epoch: 3, Steps: 514 | Train Loss: 0.6002979 Vali Loss: 0.3575091 Best vali loss: 0.3575091
	iters: 100, epoch: 4 | loss: 0.4050824
	speed: 0.0152s/iter; left time: 37.5438s
	iters: 200, epoch: 4 | loss: 0.6539404
	speed: 0.0055s/iter; left time: 13.0886s
	iters: 300, epoch: 4 | loss: 0.4279370
	speed: 0.0051s/iter; left time: 11.6462s
	iters: 400, epoch: 4 | loss: 0.8051895
	speed: 0.0072s/iter; left time: 15.5667s
	iters: 500, epoch: 4 | loss: 0.7455865
	speed: 0.0070s/iter; left time: 14.5719s
Updating learning rate to 2.25075434375e-05
Epoch: 4 cost time: 3.3874363899230957
Epoch: 4, Steps: 514 | Train Loss: 0.6075472 Vali Loss: 0.3644704 Best vali loss: 0.3575091
	iters: 100, epoch: 5 | loss: 0.7316045
	speed: 0.0140s/iter; left time: 27.4270s
	iters: 200, epoch: 5 | loss: 0.3780120
	speed: 0.0070s/iter; left time: 12.9936s
	iters: 300, epoch: 5 | loss: 0.6418201
	speed: 0.0070s/iter; left time: 12.3329s
	iters: 400, epoch: 5 | loss: 0.8134665
	speed: 0.0070s/iter; left time: 11.5887s
	iters: 500, epoch: 5 | loss: 0.6914565
	speed: 0.0069s/iter; left time: 10.7770s
Updating learning rate to 1.125377171875e-05
Epoch: 5 cost time: 3.655365228652954
Epoch: 5, Steps: 514 | Train Loss: 0.6512719 Vali Loss: 0.3645770 Best vali loss: 0.3575091
	iters: 100, epoch: 6 | loss: 0.6367759
	speed: 0.0139s/iter; left time: 20.1188s
	iters: 200, epoch: 6 | loss: 0.6698546
	speed: 0.0069s/iter; left time: 9.2666s
	iters: 300, epoch: 6 | loss: 0.2757317
	speed: 0.0072s/iter; left time: 8.9919s
	iters: 400, epoch: 6 | loss: 0.8032468
	speed: 0.0072s/iter; left time: 8.2717s
	iters: 500, epoch: 6 | loss: 0.5452457
	speed: 0.0069s/iter; left time: 7.2439s
Updating learning rate to 5.626885859375e-06
Epoch: 6 cost time: 3.668316602706909
Epoch: 6, Steps: 514 | Train Loss: 0.5861709 Vali Loss: 0.3620588 Best vali loss: 0.3575091
	iters: 100, epoch: 7 | loss: 0.4144837
	speed: 0.0139s/iter; left time: 12.8677s
	iters: 200, epoch: 7 | loss: 0.6314502
	speed: 0.0069s/iter; left time: 5.7564s
	iters: 300, epoch: 7 | loss: 0.2737649
	speed: 0.0053s/iter; left time: 3.8424s
	iters: 400, epoch: 7 | loss: 0.2578110
	speed: 0.0048s/iter; left time: 3.0251s
	iters: 500, epoch: 7 | loss: 0.6698843
	speed: 0.0077s/iter; left time: 4.0747s
Updating learning rate to 2.8134429296875e-06
Epoch: 7 cost time: 3.3480234146118164
Epoch: 7, Steps: 514 | Train Loss: 0.4494788 Vali Loss: 0.3626759 Best vali loss: 0.3575091
	iters: 100, epoch: 8 | loss: 0.5270519
	speed: 0.0149s/iter; left time: 6.1925s
	iters: 200, epoch: 8 | loss: 0.6082750
	speed: 0.0074s/iter; left time: 2.3341s
	iters: 300, epoch: 8 | loss: 0.7254975
	speed: 0.0073s/iter; left time: 1.5666s
	iters: 400, epoch: 8 | loss: 0.3753004
	speed: 0.0059s/iter; left time: 0.6759s
	iters: 500, epoch: 8 | loss: 0.8310500
	speed: 0.0055s/iter; left time: 0.0827s
Updating learning rate to 1.40672146484375e-06
Epoch: 8 cost time: 3.4498794078826904
Epoch: 8, Steps: 514 | Train Loss: 0.6134350 Vali Loss: 0.3645378 Best vali loss: 0.3575091

best validation loss 0.3575090998458019

{'batch_size': 8, 'd_core': 256, 'd_model': 256, 'dropout': 0.0018839111988, 'e_layers': 2, 'learning_rate': 0.003678803465, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6960661
	speed: 0.0101s/iter; left time: 81.8478s
	iters: 200, epoch: 1 | loss: 1.0493459
	speed: 0.0044s/iter; left time: 35.2689s
	iters: 300, epoch: 1 | loss: 0.5494851
	speed: 0.0036s/iter; left time: 28.1842s
	iters: 400, epoch: 1 | loss: 0.3597118
	speed: 0.0045s/iter; left time: 34.9506s
	iters: 500, epoch: 1 | loss: 0.9445602
	speed: 0.0044s/iter; left time: 34.2004s
	iters: 600, epoch: 1 | loss: 1.1340475
	speed: 0.0038s/iter; left time: 29.0345s
	iters: 700, epoch: 1 | loss: 0.4038733
	speed: 0.0040s/iter; left time: 30.2216s
	iters: 800, epoch: 1 | loss: 1.1668175
	speed: 0.0044s/iter; left time: 32.5672s
	iters: 900, epoch: 1 | loss: 1.2022654
	speed: 0.0041s/iter; left time: 29.7549s
	iters: 1000, epoch: 1 | loss: 0.3570570
	speed: 0.0036s/iter; left time: 25.8240s
Updating learning rate to 0.003678803465
Validation loss decreased (inf --> 0.4022).  Saving model state dict ...
Epoch: 1 cost time: 4.532581567764282
Epoch: 1, Steps: 1027 | Train Loss: 0.7863230 Vali Loss: 0.4022155 Best vali loss: 0.4022155
	iters: 100, epoch: 2 | loss: 0.4180631
	speed: 0.0124s/iter; left time: 88.1171s
	iters: 200, epoch: 2 | loss: 0.4747994
	speed: 0.0045s/iter; left time: 31.5732s
	iters: 300, epoch: 2 | loss: 0.4568568
	speed: 0.0044s/iter; left time: 30.0690s
	iters: 400, epoch: 2 | loss: 0.3143440
	speed: 0.0038s/iter; left time: 25.4645s
	iters: 500, epoch: 2 | loss: 0.3622954
	speed: 0.0042s/iter; left time: 27.8593s
	iters: 600, epoch: 2 | loss: 0.5041621
	speed: 0.0044s/iter; left time: 28.7010s
	iters: 700, epoch: 2 | loss: 0.3328942
	speed: 0.0040s/iter; left time: 26.1034s
	iters: 800, epoch: 2 | loss: 0.7422752
	speed: 0.0038s/iter; left time: 24.1417s
	iters: 900, epoch: 2 | loss: 1.1008108
	speed: 0.0044s/iter; left time: 27.5938s
	iters: 1000, epoch: 2 | loss: 0.5787077
	speed: 0.0044s/iter; left time: 27.4389s
Updating learning rate to 0.0018394017325
Epoch: 2 cost time: 4.259376525878906
Epoch: 2, Steps: 1027 | Train Loss: 0.5285209 Vali Loss: 0.4073723 Best vali loss: 0.4022155
	iters: 100, epoch: 3 | loss: 0.5860285
	speed: 0.0097s/iter; left time: 58.9642s
	iters: 200, epoch: 3 | loss: 0.5023856
	speed: 0.0052s/iter; left time: 31.1547s
	iters: 300, epoch: 3 | loss: 0.9886950
	speed: 0.0057s/iter; left time: 33.7112s
	iters: 400, epoch: 3 | loss: 0.3632642
	speed: 0.0053s/iter; left time: 30.7596s
	iters: 500, epoch: 3 | loss: 0.5797409
	speed: 0.0048s/iter; left time: 26.9335s
	iters: 600, epoch: 3 | loss: 0.4349023
	speed: 0.0056s/iter; left time: 31.1421s
	iters: 700, epoch: 3 | loss: 0.7010608
	speed: 0.0053s/iter; left time: 29.0931s
	iters: 800, epoch: 3 | loss: 0.3948247
	speed: 0.0039s/iter; left time: 20.7192s
	iters: 900, epoch: 3 | loss: 0.3111587
	speed: 0.0051s/iter; left time: 26.8095s
	iters: 1000, epoch: 3 | loss: 0.8329455
	speed: 0.0058s/iter; left time: 29.9317s
Updating learning rate to 0.00091970086625
Epoch: 3 cost time: 5.195910692214966
Epoch: 3, Steps: 1027 | Train Loss: 0.5695006 Vali Loss: 0.4028851 Best vali loss: 0.4022155
	iters: 100, epoch: 4 | loss: 0.4211338
	speed: 0.0161s/iter; left time: 81.2090s
	iters: 200, epoch: 4 | loss: 0.2741239
	speed: 0.0053s/iter; left time: 25.9431s
	iters: 300, epoch: 4 | loss: 0.3416080
	speed: 0.0045s/iter; left time: 21.6422s
	iters: 400, epoch: 4 | loss: 0.4208387
	speed: 0.0059s/iter; left time: 27.9196s
	iters: 500, epoch: 4 | loss: 0.3546878
	speed: 0.0058s/iter; left time: 26.8695s
	iters: 600, epoch: 4 | loss: 1.9109144
	speed: 0.0039s/iter; left time: 17.7355s
	iters: 700, epoch: 4 | loss: 0.3771049
	speed: 0.0058s/iter; left time: 25.6912s
	iters: 800, epoch: 4 | loss: 0.6094760
	speed: 0.0058s/iter; left time: 25.2833s
	iters: 900, epoch: 4 | loss: 0.3237157
	speed: 0.0046s/iter; left time: 19.5678s
	iters: 1000, epoch: 4 | loss: 0.4073431
	speed: 0.0053s/iter; left time: 21.8869s
Updating learning rate to 0.000459850433125
Epoch: 4 cost time: 5.449965953826904
Epoch: 4, Steps: 1027 | Train Loss: 0.5440946 Vali Loss: 0.4035551 Best vali loss: 0.4022155
	iters: 100, epoch: 5 | loss: 0.3587133
	speed: 0.0150s/iter; left time: 60.1064s
	iters: 200, epoch: 5 | loss: 0.3434771
	speed: 0.0058s/iter; left time: 22.6833s
	iters: 300, epoch: 5 | loss: 0.8331289
	speed: 0.0058s/iter; left time: 22.2248s
	iters: 400, epoch: 5 | loss: 0.5350450
	speed: 0.0036s/iter; left time: 13.5218s
	iters: 500, epoch: 5 | loss: 0.5670826
	speed: 0.0030s/iter; left time: 10.7333s
	iters: 600, epoch: 5 | loss: 0.1996950
	speed: 0.0032s/iter; left time: 11.2203s
	iters: 700, epoch: 5 | loss: 0.3602223
	speed: 0.0031s/iter; left time: 10.6844s
	iters: 800, epoch: 5 | loss: 1.1419126
	speed: 0.0031s/iter; left time: 10.1098s
	iters: 900, epoch: 5 | loss: 0.5283889
	speed: 0.0030s/iter; left time: 9.6281s
	iters: 1000, epoch: 5 | loss: 1.6357043
	speed: 0.0029s/iter; left time: 9.1291s
Updating learning rate to 0.0002299252165625
Epoch: 5 cost time: 3.8944804668426514
Epoch: 5, Steps: 1027 | Train Loss: 0.6503370 Vali Loss: 0.4032557 Best vali loss: 0.4022155
	iters: 100, epoch: 6 | loss: 0.2844858
	speed: 0.0146s/iter; left time: 43.6575s
	iters: 200, epoch: 6 | loss: 0.4547708
	speed: 0.0060s/iter; left time: 17.2474s
	iters: 300, epoch: 6 | loss: 0.8456900
	speed: 0.0045s/iter; left time: 12.3852s
	iters: 400, epoch: 6 | loss: 0.4092728
	speed: 0.0057s/iter; left time: 15.2068s
	iters: 500, epoch: 6 | loss: 0.6589277
	speed: 0.0033s/iter; left time: 8.4942s
	iters: 600, epoch: 6 | loss: 1.2348340
	speed: 0.0030s/iter; left time: 7.4656s
	iters: 700, epoch: 6 | loss: 1.0106285
	speed: 0.0032s/iter; left time: 7.6849s
	iters: 800, epoch: 6 | loss: 0.4459124
	speed: 0.0044s/iter; left time: 10.1533s
	iters: 900, epoch: 6 | loss: 1.0005065
	speed: 0.0047s/iter; left time: 10.3449s
	iters: 1000, epoch: 6 | loss: 0.5302168
	speed: 0.0048s/iter; left time: 9.9847s
Updating learning rate to 0.00011496260828125
Epoch: 6 cost time: 4.561513185501099
Epoch: 6, Steps: 1027 | Train Loss: 0.6875245 Vali Loss: 0.4033504 Best vali loss: 0.4022155
	iters: 100, epoch: 7 | loss: 0.3224643
	speed: 0.0127s/iter; left time: 24.9080s
	iters: 200, epoch: 7 | loss: 1.0836713
	speed: 0.0041s/iter; left time: 7.5775s
	iters: 300, epoch: 7 | loss: 0.4225526
	speed: 0.0042s/iter; left time: 7.3595s
	iters: 400, epoch: 7 | loss: 1.3137853
	speed: 0.0047s/iter; left time: 7.7648s
	iters: 500, epoch: 7 | loss: 1.2259631
	speed: 0.0047s/iter; left time: 7.2809s
	iters: 600, epoch: 7 | loss: 1.8876517
	speed: 0.0042s/iter; left time: 6.0394s
	iters: 700, epoch: 7 | loss: 0.3168859
	speed: 0.0032s/iter; left time: 4.3722s
	iters: 800, epoch: 7 | loss: 1.1151361
	speed: 0.0036s/iter; left time: 4.4588s
	iters: 900, epoch: 7 | loss: 0.5922784
	speed: 0.0034s/iter; left time: 3.9049s
	iters: 1000, epoch: 7 | loss: 0.4263758
	speed: 0.0043s/iter; left time: 4.5487s
Updating learning rate to 5.7481304140625e-05
Epoch: 7 cost time: 4.194622993469238
Epoch: 7, Steps: 1027 | Train Loss: 0.8706765 Vali Loss: 0.4034646 Best vali loss: 0.4022155
	iters: 100, epoch: 8 | loss: 0.8636164
	speed: 0.0133s/iter; left time: 12.3584s
	iters: 200, epoch: 8 | loss: 0.4404207
	speed: 0.0037s/iter; left time: 3.0702s
	iters: 300, epoch: 8 | loss: 0.3421504
	speed: 0.0041s/iter; left time: 2.9998s
	iters: 400, epoch: 8 | loss: 0.4300316
	speed: 0.0040s/iter; left time: 2.5397s
	iters: 500, epoch: 8 | loss: 0.4154549
	speed: 0.0042s/iter; left time: 2.2085s
	iters: 600, epoch: 8 | loss: 0.8466341
	speed: 0.0042s/iter; left time: 1.7767s
	iters: 700, epoch: 8 | loss: 0.3672350
	speed: 0.0042s/iter; left time: 1.3763s
	iters: 800, epoch: 8 | loss: 0.3026193
	speed: 0.0048s/iter; left time: 1.0975s
	iters: 900, epoch: 8 | loss: 0.4861642
	speed: 0.0043s/iter; left time: 0.5565s
	iters: 1000, epoch: 8 | loss: 1.3070273
	speed: 0.0042s/iter; left time: 0.1172s
Updating learning rate to 2.87406520703125e-05
Epoch: 8 cost time: 4.375530242919922
Epoch: 8, Steps: 1027 | Train Loss: 0.5801354 Vali Loss: 0.4034195 Best vali loss: 0.4022155

best validation loss 0.40221553984114605

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0055905958708, 'e_layers': 1, 'learning_rate': 0.0036280597991, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7191199
	speed: 0.0110s/iter; left time: 44.2994s
	iters: 200, epoch: 1 | loss: 0.5872945
	speed: 0.0040s/iter; left time: 15.6689s
	iters: 300, epoch: 1 | loss: 0.5450296
	speed: 0.0060s/iter; left time: 22.8716s
	iters: 400, epoch: 1 | loss: 1.0490239
	speed: 0.0044s/iter; left time: 16.3818s
	iters: 500, epoch: 1 | loss: 0.6465142
	speed: 0.0060s/iter; left time: 21.6404s
Updating learning rate to 0.0036280597991
Validation loss decreased (inf --> 0.3970).  Saving model state dict ...
Epoch: 1 cost time: 2.9256248474121094
Epoch: 1, Steps: 514 | Train Loss: 0.7093964 Vali Loss: 0.3970384 Best vali loss: 0.3970384
	iters: 100, epoch: 2 | loss: 0.5535829
	speed: 0.0115s/iter; left time: 40.3212s
	iters: 200, epoch: 2 | loss: 0.4741562
	speed: 0.0034s/iter; left time: 11.5595s
	iters: 300, epoch: 2 | loss: 0.2567115
	speed: 0.0055s/iter; left time: 18.1427s
	iters: 400, epoch: 2 | loss: 0.4225296
	speed: 0.0046s/iter; left time: 14.5636s
	iters: 500, epoch: 2 | loss: 0.7070004
	speed: 0.0028s/iter; left time: 8.7420s
Updating learning rate to 0.00181402989955
Epoch: 2 cost time: 2.2844395637512207
Epoch: 2, Steps: 514 | Train Loss: 0.4827961 Vali Loss: 0.4018887 Best vali loss: 0.3970384
	iters: 100, epoch: 3 | loss: 0.3589915
	speed: 0.0061s/iter; left time: 18.1260s
	iters: 200, epoch: 3 | loss: 1.2441102
	speed: 0.0033s/iter; left time: 9.5346s
	iters: 300, epoch: 3 | loss: 0.4897311
	speed: 0.0043s/iter; left time: 11.9064s
	iters: 400, epoch: 3 | loss: 0.4808008
	speed: 0.0031s/iter; left time: 8.2598s
	iters: 500, epoch: 3 | loss: 0.8510970
	speed: 0.0037s/iter; left time: 9.6279s
Updating learning rate to 0.000907014949775
Epoch: 3 cost time: 1.804657220840454
Epoch: 3, Steps: 514 | Train Loss: 0.6849461 Vali Loss: 0.4031554 Best vali loss: 0.3970384

best validation loss 0.3970384111573045

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.001012004623, 'e_layers': 3, 'learning_rate': 0.000825808451, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5795075
	speed: 0.0126s/iter; left time: 50.6325s
	iters: 200, epoch: 1 | loss: 0.4456231
	speed: 0.0071s/iter; left time: 27.5897s
	iters: 300, epoch: 1 | loss: 0.9744946
	speed: 0.0067s/iter; left time: 25.4379s
	iters: 400, epoch: 1 | loss: 1.3250186
	speed: 0.0071s/iter; left time: 26.4635s
	iters: 500, epoch: 1 | loss: 0.8034902
	speed: 0.0065s/iter; left time: 23.5431s
Updating learning rate to 0.000825808451
Validation loss decreased (inf --> 0.3711).  Saving model state dict ...
Epoch: 1 cost time: 3.8119771480560303
Epoch: 1, Steps: 514 | Train Loss: 0.8256268 Vali Loss: 0.3711396 Best vali loss: 0.3711396
	iters: 100, epoch: 2 | loss: 0.8285290
	speed: 0.0102s/iter; left time: 35.8014s
	iters: 200, epoch: 2 | loss: 0.4436952
	speed: 0.0056s/iter; left time: 19.0782s
	iters: 300, epoch: 2 | loss: 0.2833895
	speed: 0.0065s/iter; left time: 21.3462s
	iters: 400, epoch: 2 | loss: 0.7095894
	speed: 0.0064s/iter; left time: 20.3585s
	iters: 500, epoch: 2 | loss: 1.1232779
	speed: 0.0058s/iter; left time: 18.0167s
Updating learning rate to 0.0004129042255
Epoch: 2 cost time: 2.999314069747925
Epoch: 2, Steps: 514 | Train Loss: 0.6776962 Vali Loss: 0.3738894 Best vali loss: 0.3711396
	iters: 100, epoch: 3 | loss: 0.6737439
	speed: 0.0140s/iter; left time: 41.6920s
	iters: 200, epoch: 3 | loss: 0.8942898
	speed: 0.0060s/iter; left time: 17.3231s
	iters: 300, epoch: 3 | loss: 0.8147367
	speed: 0.0060s/iter; left time: 16.7313s
	iters: 400, epoch: 3 | loss: 0.5955778
	speed: 0.0064s/iter; left time: 17.2136s
	iters: 500, epoch: 3 | loss: 0.5620534
	speed: 0.0065s/iter; left time: 16.7384s
Updating learning rate to 0.00020645211275
Epoch: 3 cost time: 3.2963404655456543
Epoch: 3, Steps: 514 | Train Loss: 0.7080803 Vali Loss: 0.3808357 Best vali loss: 0.3711396

best validation loss 0.3711395744724686

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0009225062942, 'e_layers': 1, 'learning_rate': 0.0034509285106, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0033195853648514996
Validation loss decreased (inf --> 0.3992).  Saving model state dict ...
Epoch: 1 cost time: 0.8364028930664062
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3991865 Best vali loss: 0.3991865
Updating learning rate to 0.002945551730917626
Validation loss decreased (0.3992 --> 0.3779).  Saving model state dict ...
Epoch: 2 cost time: 0.5229315757751465
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3779383 Best vali loss: 0.3779383
Updating learning rate to 0.0023857708389414777
Validation loss decreased (0.3779 --> 0.3748).  Saving model state dict ...
Epoch: 3 cost time: 0.5135478973388672
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3748434 Best vali loss: 0.3748434

best validation loss 0.37484344994623675

{'batch_size': 16, 'd_core': 256, 'd_model': 64, 'dropout': 0.001012004623, 'e_layers': 3, 'learning_rate': 0.000825808451, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5561296
	speed: 0.0123s/iter; left time: 30.3704s
	iters: 200, epoch: 4 | loss: 0.4276967
	speed: 0.0064s/iter; left time: 15.2690s
	iters: 300, epoch: 4 | loss: 0.9119883
	speed: 0.0067s/iter; left time: 15.1237s
	iters: 400, epoch: 4 | loss: 0.6405762
	speed: 0.0058s/iter; left time: 12.5220s
	iters: 500, epoch: 4 | loss: 0.7637992
	speed: 0.0063s/iter; left time: 13.1247s
Updating learning rate to 0.000103226056375
Epoch: 4 cost time: 3.523082971572876
Epoch: 4, Steps: 514 | Train Loss: 0.6600380 Vali Loss: 0.3920679 Best vali loss: 0.3711396
	iters: 100, epoch: 5 | loss: 0.7131062
	speed: 0.0137s/iter; left time: 26.7410s
	iters: 200, epoch: 5 | loss: 0.3769824
	speed: 0.0061s/iter; left time: 11.3386s
	iters: 300, epoch: 5 | loss: 0.2465253
	speed: 0.0066s/iter; left time: 11.6651s
	iters: 400, epoch: 5 | loss: 0.6294355
	speed: 0.0066s/iter; left time: 11.0167s
	iters: 500, epoch: 5 | loss: 0.6983057
	speed: 0.0062s/iter; left time: 9.6229s
Updating learning rate to 5.16130281875e-05
Epoch: 5 cost time: 3.292755365371704
Epoch: 5, Steps: 514 | Train Loss: 0.5328710 Vali Loss: 0.3777937 Best vali loss: 0.3711396
	iters: 100, epoch: 6 | loss: 0.6293085
	speed: 0.0098s/iter; left time: 14.1928s
	iters: 200, epoch: 6 | loss: 0.8920001
	speed: 0.0061s/iter; left time: 8.1739s
	iters: 300, epoch: 6 | loss: 0.7426141
	speed: 0.0059s/iter; left time: 7.3141s
	iters: 400, epoch: 6 | loss: 0.5453075
	speed: 0.0058s/iter; left time: 6.6022s
	iters: 500, epoch: 6 | loss: 0.4723573
	speed: 0.0059s/iter; left time: 6.1595s
Updating learning rate to 2.580651409375e-05
Epoch: 6 cost time: 2.9881341457366943
Epoch: 6, Steps: 514 | Train Loss: 0.6563175 Vali Loss: 0.3807776 Best vali loss: 0.3711396
	iters: 100, epoch: 7 | loss: 0.6064277
	speed: 0.0111s/iter; left time: 10.3241s
	iters: 200, epoch: 7 | loss: 0.2196641
	speed: 0.0044s/iter; left time: 3.6644s
	iters: 300, epoch: 7 | loss: 0.3090416
	speed: 0.0063s/iter; left time: 4.5689s
	iters: 400, epoch: 7 | loss: 0.4439505
	speed: 0.0064s/iter; left time: 4.0166s
	iters: 500, epoch: 7 | loss: 0.3179025
	speed: 0.0058s/iter; left time: 3.0843s
Updating learning rate to 1.2903257046875e-05
Epoch: 7 cost time: 2.860379934310913
Epoch: 7, Steps: 514 | Train Loss: 0.3793973 Vali Loss: 0.3748941 Best vali loss: 0.3711396
	iters: 100, epoch: 8 | loss: 0.5617959
	speed: 0.0134s/iter; left time: 5.5552s
	iters: 200, epoch: 8 | loss: 0.2654026
	speed: 0.0064s/iter; left time: 2.0172s
	iters: 300, epoch: 8 | loss: 0.4064823
	speed: 0.0057s/iter; left time: 1.2154s
	iters: 400, epoch: 8 | loss: 0.8097734
	speed: 0.0059s/iter; left time: 0.6840s
	iters: 500, epoch: 8 | loss: 0.7804224
	speed: 0.0064s/iter; left time: 0.0957s
Updating learning rate to 6.4516285234375e-06
Epoch: 8 cost time: 3.2093565464019775
Epoch: 8, Steps: 514 | Train Loss: 0.5647753 Vali Loss: 0.3747739 Best vali loss: 0.3711396

best validation loss 0.3711395744724686

{'batch_size': 32, 'd_core': 256, 'd_model': 64, 'dropout': 0.0098036929311, 'e_layers': 1, 'learning_rate': 0.000566823774, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.6156964
	speed: 0.0102s/iter; left time: 20.0510s
	iters: 200, epoch: 1 | loss: 0.7550172
	speed: 0.0041s/iter; left time: 7.6306s
Updating learning rate to 0.000566823774
Validation loss decreased (inf --> 0.3675).  Saving model state dict ...
Epoch: 1 cost time: 1.391526222229004
Epoch: 1, Steps: 257 | Train Loss: 0.6853568 Vali Loss: 0.3675023 Best vali loss: 0.3675023
	iters: 100, epoch: 2 | loss: 0.6404713
	speed: 0.0077s/iter; left time: 13.0513s
	iters: 200, epoch: 2 | loss: 0.9823002
	speed: 0.0029s/iter; left time: 4.6560s
Updating learning rate to 0.000283411887
Validation loss decreased (0.3675 --> 0.3647).  Saving model state dict ...
Epoch: 2 cost time: 0.8325345516204834
Epoch: 2, Steps: 257 | Train Loss: 0.8113858 Vali Loss: 0.3646895 Best vali loss: 0.3646895
	iters: 100, epoch: 3 | loss: 0.3303400
	speed: 0.0096s/iter; left time: 13.8471s
	iters: 200, epoch: 3 | loss: 0.5110480
	speed: 0.0045s/iter; left time: 6.0851s
Updating learning rate to 0.0001417059435
Epoch: 3 cost time: 1.1436667442321777
Epoch: 3, Steps: 257 | Train Loss: 0.4206940 Vali Loss: 0.3711632 Best vali loss: 0.3646895
	iters: 100, epoch: 4 | loss: 0.6160378
	speed: 0.0101s/iter; left time: 12.0244s
	iters: 200, epoch: 4 | loss: 0.7631295
	speed: 0.0043s/iter; left time: 4.7003s
Updating learning rate to 7.085297175e-05
Epoch: 4 cost time: 1.194596529006958
Epoch: 4, Steps: 257 | Train Loss: 0.6895836 Vali Loss: 0.3738049 Best vali loss: 0.3646895
	iters: 100, epoch: 5 | loss: 0.6940050
	speed: 0.0104s/iter; left time: 9.6745s
	iters: 200, epoch: 5 | loss: 0.7431294
	speed: 0.0043s/iter; left time: 3.5679s
Updating learning rate to 3.5426485875e-05
Epoch: 5 cost time: 1.0852303504943848
Epoch: 5, Steps: 257 | Train Loss: 0.7185672 Vali Loss: 0.3756707 Best vali loss: 0.3646895
	iters: 100, epoch: 6 | loss: 0.4529439
	speed: 0.0070s/iter; left time: 4.7049s
	iters: 200, epoch: 6 | loss: 0.6781036
	speed: 0.0028s/iter; left time: 1.5761s
Updating learning rate to 1.77132429375e-05
Epoch: 6 cost time: 0.7778751850128174
Epoch: 6, Steps: 257 | Train Loss: 0.5655237 Vali Loss: 0.3751256 Best vali loss: 0.3646895
	iters: 100, epoch: 7 | loss: 0.6550702
	speed: 0.0067s/iter; left time: 2.7894s
	iters: 200, epoch: 7 | loss: 0.4246211
	speed: 0.0028s/iter; left time: 0.8709s
Updating learning rate to 8.85662146875e-06
Epoch: 7 cost time: 0.7575151920318604
Epoch: 7, Steps: 257 | Train Loss: 0.5398457 Vali Loss: 0.3757466 Best vali loss: 0.3646895
	iters: 100, epoch: 8 | loss: 0.8104141
	speed: 0.0079s/iter; left time: 1.2482s
	iters: 200, epoch: 8 | loss: 0.7620916
	speed: 0.0041s/iter; left time: 0.2402s
Updating learning rate to 4.428310734375e-06
Epoch: 8 cost time: 1.081923484802246
Epoch: 8, Steps: 257 | Train Loss: 0.7862528 Vali Loss: 0.3760505 Best vali loss: 0.3646895

best validation loss 0.3646894503553162

{'batch_size': 32, 'd_core': 128, 'd_model': 256, 'dropout': 0.0028852829179, 'e_layers': 3, 'learning_rate': 0.0002361458543, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.4762674
	speed: 0.0128s/iter; left time: 24.9846s
	iters: 200, epoch: 1 | loss: 1.5606964
	speed: 0.0067s/iter; left time: 12.3677s
Updating learning rate to 0.0002361458543
Validation loss decreased (inf --> 0.3709).  Saving model state dict ...
Epoch: 1 cost time: 2.0704448223114014
Epoch: 1, Steps: 257 | Train Loss: 1.0184819 Vali Loss: 0.3709410 Best vali loss: 0.3709410
	iters: 100, epoch: 2 | loss: 0.6204911
	speed: 0.0145s/iter; left time: 24.6670s
	iters: 200, epoch: 2 | loss: 0.7102502
	speed: 0.0069s/iter; left time: 10.9804s
Updating learning rate to 0.00011807292715
Epoch: 2 cost time: 1.6598823070526123
Epoch: 2, Steps: 257 | Train Loss: 0.6653707 Vali Loss: 0.3782346 Best vali loss: 0.3709410
	iters: 100, epoch: 3 | loss: 0.6536657
	speed: 0.0095s/iter; left time: 13.6594s
	iters: 200, epoch: 3 | loss: 0.5071954
	speed: 0.0061s/iter; left time: 8.1875s
Updating learning rate to 5.9036463575e-05
Validation loss decreased (0.3709 --> 0.3522).  Saving model state dict ...
Epoch: 3 cost time: 1.4511895179748535
Epoch: 3, Steps: 257 | Train Loss: 0.5804306 Vali Loss: 0.3521576 Best vali loss: 0.3521576
	iters: 100, epoch: 4 | loss: 0.6929819
	speed: 0.0140s/iter; left time: 16.5509s
	iters: 200, epoch: 4 | loss: 0.6732239
	speed: 0.0061s/iter; left time: 6.6320s
Updating learning rate to 2.95182317875e-05
Epoch: 4 cost time: 1.6350955963134766
Epoch: 4, Steps: 257 | Train Loss: 0.6831029 Vali Loss: 0.3528757 Best vali loss: 0.3521576
	iters: 100, epoch: 5 | loss: 0.5548884
	speed: 0.0137s/iter; left time: 12.7667s
	iters: 200, epoch: 5 | loss: 0.5522193
	speed: 0.0061s/iter; left time: 5.0917s
Updating learning rate to 1.475911589375e-05
Validation loss decreased (0.3522 --> 0.3500).  Saving model state dict ...
Epoch: 5 cost time: 1.6590864658355713
Epoch: 5, Steps: 257 | Train Loss: 0.5535538 Vali Loss: 0.3500440 Best vali loss: 0.3500440
	iters: 100, epoch: 6 | loss: 0.6350791
	speed: 0.0139s/iter; left time: 9.3737s
	iters: 200, epoch: 6 | loss: 0.4543242
	speed: 0.0060s/iter; left time: 3.4174s
Updating learning rate to 7.379557946875e-06
Epoch: 6 cost time: 1.6349811553955078
Epoch: 6, Steps: 257 | Train Loss: 0.5447017 Vali Loss: 0.3529921 Best vali loss: 0.3500440
	iters: 100, epoch: 7 | loss: 0.5016587
	speed: 0.0139s/iter; left time: 5.7803s
	iters: 200, epoch: 7 | loss: 0.5434922
	speed: 0.0061s/iter; left time: 1.9128s
Updating learning rate to 3.6897789734375e-06
Epoch: 7 cost time: 1.645843505859375
Epoch: 7, Steps: 257 | Train Loss: 0.5225754 Vali Loss: 0.3522189 Best vali loss: 0.3500440
	iters: 100, epoch: 8 | loss: 0.5942637
	speed: 0.0142s/iter; left time: 2.2507s
	iters: 200, epoch: 8 | loss: 0.5510154
	speed: 0.0061s/iter; left time: 0.3520s
Updating learning rate to 1.84488948671875e-06
Epoch: 8 cost time: 1.6597511768341064
Epoch: 8, Steps: 257 | Train Loss: 0.5726396 Vali Loss: 0.3526444 Best vali loss: 0.3500440

best validation loss 0.35004404837115577

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0012835601999, 'e_layers': 3, 'learning_rate': 0.0002687323862, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00025850436876654926
Validation loss decreased (inf --> 0.3694).  Saving model state dict ...
Epoch: 1 cost time: 0.9067144393920898
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3694397 Best vali loss: 0.3694397
Updating learning rate to 0.00022937743940323107
Validation loss decreased (0.3694 --> 0.3643).  Saving model state dict ...
Epoch: 2 cost time: 0.5821113586425781
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3643462 Best vali loss: 0.3643462
Updating learning rate to 0.00018578590906933844
Epoch: 3 cost time: 0.5735437870025635
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3645922 Best vali loss: 0.3643462

best validation loss 0.36434624788803294

{'batch_size': 128, 'd_core': 64, 'd_model': 256, 'dropout': 0.0068580862503, 'e_layers': 1, 'learning_rate': 0.0005898855996, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0005898855996
Validation loss decreased (inf --> 0.3659).  Saving model state dict ...
Epoch: 1 cost time: 0.7271308898925781
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3658652 Best vali loss: 0.3658652
Updating learning rate to 0.0002949427998
Epoch: 2 cost time: 0.49604129791259766
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3662167 Best vali loss: 0.3658652
Updating learning rate to 0.0001474713999
Epoch: 3 cost time: 0.510216236114502
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3669004 Best vali loss: 0.3658652

best validation loss 0.3658652169296924

{'batch_size': 16, 'd_core': 32, 'd_model': 64, 'dropout': 0.0016289526749, 'e_layers': 4, 'learning_rate': 0.0001397169929, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7254831
	speed: 0.0129s/iter; left time: 51.9353s
	iters: 200, epoch: 1 | loss: 0.6427810
	speed: 0.0068s/iter; left time: 26.4998s
	iters: 300, epoch: 1 | loss: 0.8902115
	speed: 0.0066s/iter; left time: 25.1090s
	iters: 400, epoch: 1 | loss: 0.3246369
	speed: 0.0065s/iter; left time: 23.9644s
	iters: 500, epoch: 1 | loss: 0.7202079
	speed: 0.0065s/iter; left time: 23.4324s
Updating learning rate to 0.0001397169929
Validation loss decreased (inf --> 0.3722).  Saving model state dict ...
Epoch: 1 cost time: 3.7433323860168457
Epoch: 1, Steps: 514 | Train Loss: 0.6606641 Vali Loss: 0.3721527 Best vali loss: 0.3721527
	iters: 100, epoch: 2 | loss: 0.4048989
	speed: 0.0141s/iter; left time: 49.1844s
	iters: 200, epoch: 2 | loss: 0.4942367
	speed: 0.0064s/iter; left time: 21.6357s
	iters: 300, epoch: 2 | loss: 0.4453089
	speed: 0.0063s/iter; left time: 20.9016s
	iters: 400, epoch: 2 | loss: 0.7227105
	speed: 0.0056s/iter; left time: 17.9262s
	iters: 500, epoch: 2 | loss: 0.5510153
	speed: 0.0056s/iter; left time: 17.4761s
Updating learning rate to 6.985849645e-05
Validation loss decreased (0.3722 --> 0.3671).  Saving model state dict ...
Epoch: 2 cost time: 3.2226450443267822
Epoch: 2, Steps: 514 | Train Loss: 0.5236341 Vali Loss: 0.3671098 Best vali loss: 0.3671098
	iters: 100, epoch: 3 | loss: 0.3252400
	speed: 0.0149s/iter; left time: 44.4258s
	iters: 200, epoch: 3 | loss: 0.8589485
	speed: 0.0073s/iter; left time: 21.0721s
	iters: 300, epoch: 3 | loss: 0.9657520
	speed: 0.0070s/iter; left time: 19.4061s
	iters: 400, epoch: 3 | loss: 0.2970748
	speed: 0.0068s/iter; left time: 18.3446s
	iters: 500, epoch: 3 | loss: 0.4674776
	speed: 0.0057s/iter; left time: 14.6772s
Updating learning rate to 3.4929248225e-05
Validation loss decreased (0.3671 --> 0.3644).  Saving model state dict ...
Epoch: 3 cost time: 3.4919071197509766
Epoch: 3, Steps: 514 | Train Loss: 0.5828986 Vali Loss: 0.3644001 Best vali loss: 0.3644001

best validation loss 0.36440013929293996

{'batch_size': 128, 'd_core': 64, 'd_model': 128, 'dropout': 0.0012835601999, 'e_layers': 3, 'learning_rate': 0.0002687323862, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Updating learning rate to 0.0001343661931
Validation loss decreased (0.3643 --> 0.3641).  Saving model state dict ...
Epoch: 4 cost time: 0.8469507694244385
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3640917 Best vali loss: 0.3640917
Updating learning rate to 8.294647713066156e-05
Epoch: 5 cost time: 0.6509830951690674
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3745250 Best vali loss: 0.3640917
Updating learning rate to 3.935494679676891e-05
Epoch: 6 cost time: 0.536959171295166
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3726242 Best vali loss: 0.3640917
Updating learning rate to 1.0228017433450717e-05
Epoch: 7 cost time: 0.6350643634796143
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3733477 Best vali loss: 0.3640917
Updating learning rate to 0.0
Epoch: 8 cost time: 0.6413171291351318
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3734131 Best vali loss: 0.3640917

best validation loss 0.36409169283269194

{'batch_size': 32, 'd_core': 32, 'd_model': 128, 'dropout': 0.0057222340446, 'e_layers': 2, 'learning_rate': 0.0034968811975, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5277912
	speed: 0.0111s/iter; left time: 21.7001s
	iters: 200, epoch: 1 | loss: 0.5644789
	speed: 0.0055s/iter; left time: 10.1444s
Updating learning rate to 0.0033637890817469042
Validation loss decreased (inf --> 0.3984).  Saving model state dict ...
Epoch: 1 cost time: 1.6995887756347656
Epoch: 1, Steps: 257 | Train Loss: 0.5461351 Vali Loss: 0.3984349 Best vali loss: 0.3984349
	iters: 100, epoch: 2 | loss: 0.7501799
	speed: 0.0124s/iter; left time: 21.0327s
	iters: 200, epoch: 2 | loss: 0.6778917
	speed: 0.0054s/iter; left time: 8.6428s
Updating learning rate to 0.002984774802627992
Validation loss decreased (0.3984 --> 0.3879).  Saving model state dict ...
Epoch: 2 cost time: 1.4336743354797363
Epoch: 2, Steps: 257 | Train Loss: 0.7140358 Vali Loss: 0.3879498 Best vali loss: 0.3879498
	iters: 100, epoch: 3 | loss: 0.7121211
	speed: 0.0121s/iter; left time: 17.5085s
	iters: 200, epoch: 3 | loss: 0.6538243
	speed: 0.0057s/iter; left time: 7.6238s
Updating learning rate to 0.002417539848366123
Epoch: 3 cost time: 1.4779253005981445
Epoch: 3, Steps: 257 | Train Loss: 0.6829727 Vali Loss: 0.3927222 Best vali loss: 0.3879498
	iters: 100, epoch: 4 | loss: 0.8277380
	speed: 0.0124s/iter; left time: 14.7546s
	iters: 200, epoch: 4 | loss: 0.9475596
	speed: 0.0052s/iter; left time: 5.6633s
Updating learning rate to 0.00174844059875
Epoch: 4 cost time: 1.4442319869995117
Epoch: 4, Steps: 257 | Train Loss: 0.8876488 Vali Loss: 0.3905969 Best vali loss: 0.3879498
	iters: 100, epoch: 5 | loss: 0.4016595
	speed: 0.0097s/iter; left time: 9.0445s
	iters: 200, epoch: 5 | loss: 0.9778619
	speed: 0.0036s/iter; left time: 2.9613s
Updating learning rate to 0.0010793413491338773
Epoch: 5 cost time: 1.1367197036743164
Epoch: 5, Steps: 257 | Train Loss: 0.6897607 Vali Loss: 0.3975968 Best vali loss: 0.3879498
	iters: 100, epoch: 6 | loss: 0.4926624
	speed: 0.0125s/iter; left time: 8.3968s
	iters: 200, epoch: 6 | loss: 0.5111024
	speed: 0.0060s/iter; left time: 3.4057s
Updating learning rate to 0.0005121063948720077
Epoch: 6 cost time: 1.5554883480072021
Epoch: 6, Steps: 257 | Train Loss: 0.5018824 Vali Loss: 0.4083949 Best vali loss: 0.3879498
	iters: 100, epoch: 7 | loss: 0.8637627
	speed: 0.0131s/iter; left time: 5.4517s
	iters: 200, epoch: 7 | loss: 0.5982828
	speed: 0.0058s/iter; left time: 1.8291s
Updating learning rate to 0.00013309211575309574
Epoch: 7 cost time: 1.5042612552642822
Epoch: 7, Steps: 257 | Train Loss: 0.7310227 Vali Loss: 0.4342065 Best vali loss: 0.3879498
	iters: 100, epoch: 8 | loss: 0.5728167
	speed: 0.0085s/iter; left time: 1.3453s
	iters: 200, epoch: 8 | loss: 0.4846661
	speed: 0.0045s/iter; left time: 0.2588s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.4182219505310059
Epoch: 8, Steps: 257 | Train Loss: 0.5287414 Vali Loss: 0.4278983 Best vali loss: 0.3879498

best validation loss 0.38794983601991695

{'batch_size': 32, 'd_core': 256, 'd_model': 256, 'dropout': 0.0094054645347, 'e_layers': 3, 'learning_rate': 8.14571881e-05, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7348844
	speed: 0.0157s/iter; left time: 30.7056s
	iters: 200, epoch: 1 | loss: 0.5199590
	speed: 0.0104s/iter; left time: 19.3688s
Updating learning rate to 8.14571881e-05
Validation loss decreased (inf --> 0.3655).  Saving model state dict ...
Epoch: 1 cost time: 2.9122085571289062
Epoch: 1, Steps: 257 | Train Loss: 0.6274217 Vali Loss: 0.3654903 Best vali loss: 0.3654903
	iters: 100, epoch: 2 | loss: 0.5808717
	speed: 0.0214s/iter; left time: 36.4422s
	iters: 200, epoch: 2 | loss: 0.7370264
	speed: 0.0082s/iter; left time: 13.1692s
Updating learning rate to 4.072859405e-05
Validation loss decreased (0.3655 --> 0.3625).  Saving model state dict ...
Epoch: 2 cost time: 2.7111868858337402
Epoch: 2, Steps: 257 | Train Loss: 0.6589490 Vali Loss: 0.3624557 Best vali loss: 0.3624557
	iters: 100, epoch: 3 | loss: 0.7541170
	speed: 0.0212s/iter; left time: 30.5484s
	iters: 200, epoch: 3 | loss: 0.5293596
	speed: 0.0101s/iter; left time: 13.5453s
Updating learning rate to 2.0364297025e-05
Validation loss decreased (0.3625 --> 0.3617).  Saving model state dict ...
Epoch: 3 cost time: 2.5574958324432373
Epoch: 3, Steps: 257 | Train Loss: 0.6417383 Vali Loss: 0.3617400 Best vali loss: 0.3617400
	iters: 100, epoch: 4 | loss: 0.7305676
	speed: 0.0197s/iter; left time: 23.3583s
	iters: 200, epoch: 4 | loss: 0.7065790
	speed: 0.0115s/iter; left time: 12.5190s
Updating learning rate to 1.01821485125e-05
Epoch: 4 cost time: 2.574993133544922
Epoch: 4, Steps: 257 | Train Loss: 0.7185733 Vali Loss: 0.3618681 Best vali loss: 0.3617400
	iters: 100, epoch: 5 | loss: 0.5042151
	speed: 0.0121s/iter; left time: 11.2620s
	iters: 200, epoch: 5 | loss: 0.7059206
	speed: 0.0061s/iter; left time: 5.0890s
Updating learning rate to 5.09107425625e-06
Epoch: 5 cost time: 1.507497787475586
Epoch: 5, Steps: 257 | Train Loss: 0.6050678 Vali Loss: 0.3630542 Best vali loss: 0.3617400
	iters: 100, epoch: 6 | loss: 0.9461273
	speed: 0.0143s/iter; left time: 9.6112s
	iters: 200, epoch: 6 | loss: 0.4638624
	speed: 0.0069s/iter; left time: 3.9400s
Updating learning rate to 2.545537128125e-06
Validation loss decreased (0.3617 --> 0.3616).  Saving model state dict ...
Epoch: 6 cost time: 1.7603340148925781
Epoch: 6, Steps: 257 | Train Loss: 0.7049949 Vali Loss: 0.3615846 Best vali loss: 0.3615846
	iters: 100, epoch: 7 | loss: 0.6828522
	speed: 0.0148s/iter; left time: 6.1533s
	iters: 200, epoch: 7 | loss: 0.6858716
	speed: 0.0067s/iter; left time: 2.1100s
Updating learning rate to 1.2727685640625e-06
Validation loss decreased (0.3616 --> 0.3615).  Saving model state dict ...
Epoch: 7 cost time: 1.7939281463623047
Epoch: 7, Steps: 257 | Train Loss: 0.6843619 Vali Loss: 0.3615090 Best vali loss: 0.3615090
	iters: 100, epoch: 8 | loss: 0.6368952
	speed: 0.0150s/iter; left time: 2.3748s
	iters: 200, epoch: 8 | loss: 0.7063311
	speed: 0.0070s/iter; left time: 0.4036s
Updating learning rate to 6.3638428203125e-07
Epoch: 8 cost time: 1.819833755493164
Epoch: 8, Steps: 257 | Train Loss: 0.6716132 Vali Loss: 0.3615837 Best vali loss: 0.3615090

best validation loss 0.36150901764924026

[INFO][smbo.py:320] Finished 450 trials.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041361621611, 'e_layers': 2, 'learning_rate': 7.55918174e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6021396
	speed: 0.0130s/iter; left time: 12.1662s
Updating learning rate to 7.271477516059527e-05
Validation loss decreased (inf --> 0.3630).  Saving model state dict ...
Epoch: 1 cost time: 1.2074167728424072
Epoch: 1, Steps: 129 | Train Loss: 0.6021396 Vali Loss: 0.3629917 Best vali loss: 0.3629917
	iters: 100, epoch: 2 | loss: 0.5168416
	speed: 0.0086s/iter; left time: 6.8934s
Updating learning rate to 6.452165204287762e-05
Epoch: 2 cost time: 0.6011252403259277
Epoch: 2, Steps: 129 | Train Loss: 0.5168416 Vali Loss: 0.3642470 Best vali loss: 0.3629917
	iters: 100, epoch: 3 | loss: 0.5599292
	speed: 0.0076s/iter; left time: 5.1634s
Updating learning rate to 5.2259776770673556e-05
Epoch: 3 cost time: 0.6127469539642334
Epoch: 3, Steps: 129 | Train Loss: 0.5599292 Vali Loss: 0.3630914 Best vali loss: 0.3629917

best validation loss 0.3629917297007293

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0048004007546, 'e_layers': 3, 'learning_rate': 0.0014807515313, 'lradj': 'type1', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3868915
	speed: 0.0126s/iter; left time: 24.6885s
	iters: 200, epoch: 1 | loss: 0.8653994
	speed: 0.0068s/iter; left time: 12.5790s
Updating learning rate to 0.0014807515313
Validation loss decreased (inf --> 0.3698).  Saving model state dict ...
Epoch: 1 cost time: 2.0675508975982666
Epoch: 1, Steps: 257 | Train Loss: 0.6261454 Vali Loss: 0.3697689 Best vali loss: 0.3697689
	iters: 100, epoch: 2 | loss: 0.8211496
	speed: 0.0109s/iter; left time: 18.4940s
	iters: 200, epoch: 2 | loss: 0.3836413
	speed: 0.0058s/iter; left time: 9.3089s
Updating learning rate to 0.00074037576565
Epoch: 2 cost time: 1.4128925800323486
Epoch: 2, Steps: 257 | Train Loss: 0.6023955 Vali Loss: 0.3756842 Best vali loss: 0.3697689
	iters: 100, epoch: 3 | loss: 0.4984471
	speed: 0.0136s/iter; left time: 19.6930s
	iters: 200, epoch: 3 | loss: 0.3717786
	speed: 0.0065s/iter; left time: 8.7317s
Updating learning rate to 0.000370187882825
Epoch: 3 cost time: 1.7136914730072021
Epoch: 3, Steps: 257 | Train Loss: 0.4351128 Vali Loss: 0.3774828 Best vali loss: 0.3697689

best validation loss 0.3697688716216734

{'batch_size': 32, 'd_core': 64, 'd_model': 128, 'dropout': 0.0013851757765, 'e_layers': 4, 'learning_rate': 7.13798299e-05, 'lradj': 'cosine', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 1.0412080
	speed: 0.0128s/iter; left time: 25.0449s
	iters: 200, epoch: 1 | loss: 0.3867484
	speed: 0.0073s/iter; left time: 13.4977s
Updating learning rate to 6.866309688937358e-05
Validation loss decreased (inf --> 0.3803).  Saving model state dict ...
Epoch: 1 cost time: 2.140029191970825
Epoch: 1, Steps: 257 | Train Loss: 0.7139782 Vali Loss: 0.3802680 Best vali loss: 0.3802680
	iters: 100, epoch: 2 | loss: 0.6542112
	speed: 0.0152s/iter; left time: 25.9173s
	iters: 200, epoch: 2 | loss: 0.6693829
	speed: 0.0076s/iter; left time: 12.0942s
Updating learning rate to 6.0926495831116134e-05
Validation loss decreased (0.3803 --> 0.3688).  Saving model state dict ...
Epoch: 2 cost time: 1.9622302055358887
Epoch: 2, Steps: 257 | Train Loss: 0.6617971 Vali Loss: 0.3687930 Best vali loss: 0.3687930
	iters: 100, epoch: 3 | loss: 0.3848278
	speed: 0.0150s/iter; left time: 21.5841s
	iters: 200, epoch: 3 | loss: 0.4022061
	speed: 0.0071s/iter; left time: 9.5939s
Updating learning rate to 4.934785410388413e-05
Validation loss decreased (0.3688 --> 0.3646).  Saving model state dict ...
Epoch: 3 cost time: 1.8974816799163818
Epoch: 3, Steps: 257 | Train Loss: 0.3935170 Vali Loss: 0.3646040 Best vali loss: 0.3646040

best validation loss 0.3646039761822444

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0041361621611, 'e_layers': 2, 'learning_rate': 7.55918174e-05, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5044782
	speed: 0.0126s/iter; left time: 6.9061s
Updating learning rate to 3.77959087e-05
Epoch: 4 cost time: 1.1215965747833252
Epoch: 4, Steps: 129 | Train Loss: 0.5044782 Vali Loss: 0.3719180 Best vali loss: 0.3629917
	iters: 100, epoch: 5 | loss: 0.4565000
	speed: 0.0108s/iter; left time: 4.5161s
Updating learning rate to 2.333204062932644e-05
Epoch: 5 cost time: 0.9010012149810791
Epoch: 5, Steps: 129 | Train Loss: 0.4565000 Vali Loss: 0.3767987 Best vali loss: 0.3629917
	iters: 100, epoch: 6 | loss: 0.4952943
	speed: 0.0107s/iter; left time: 3.0947s
Updating learning rate to 1.1070165357122374e-05
Epoch: 6 cost time: 0.831350564956665
Epoch: 6, Steps: 129 | Train Loss: 0.4952943 Vali Loss: 0.3750500 Best vali loss: 0.3629917
	iters: 100, epoch: 7 | loss: 0.5479798
	speed: 0.0118s/iter; left time: 1.8832s
Updating learning rate to 2.8770422394047244e-06
Epoch: 7 cost time: 0.922741174697876
Epoch: 7, Steps: 129 | Train Loss: 0.5479798 Vali Loss: 0.3811384 Best vali loss: 0.3629917
	iters: 100, epoch: 8 | loss: 0.5976498
	speed: 0.0109s/iter; left time: 0.3283s
Updating learning rate to 0.0
Epoch: 8 cost time: 0.8831570148468018
Epoch: 8, Steps: 129 | Train Loss: 0.5976498 Vali Loss: 0.3769583 Best vali loss: 0.3629917

best validation loss 0.3629917297007293

{'batch_size': 128, 'd_core': 512, 'd_model': 32, 'dropout': 0.0031194239568, 'e_layers': 4, 'learning_rate': 0.0006809792963, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0006809792963
Validation loss decreased (inf --> 0.3814).  Saving model state dict ...
Epoch: 1 cost time: 0.8303482532501221
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3814218 Best vali loss: 0.3814218
Updating learning rate to 0.00034048964815
Validation loss decreased (0.3814 --> 0.3712).  Saving model state dict ...
Epoch: 2 cost time: 0.5563194751739502
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3711897 Best vali loss: 0.3711897
Updating learning rate to 0.000170244824075
Epoch: 3 cost time: 0.5675935745239258
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3729833 Best vali loss: 0.3711897
Updating learning rate to 8.51224120375e-05
Validation loss decreased (0.3712 --> 0.3707).  Saving model state dict ...
Epoch: 4 cost time: 0.5783822536468506
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3707316 Best vali loss: 0.3707316
Updating learning rate to 4.256120601875e-05
Validation loss decreased (0.3707 --> 0.3704).  Saving model state dict ...
Epoch: 5 cost time: 0.5759518146514893
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3703888 Best vali loss: 0.3703888
Updating learning rate to 2.1280603009375e-05
Epoch: 6 cost time: 0.5690076351165771
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3705674 Best vali loss: 0.3703888
Updating learning rate to 1.06403015046875e-05
Epoch: 7 cost time: 0.704371452331543
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3706821 Best vali loss: 0.3703888
Updating learning rate to 5.32015075234375e-06
Epoch: 8 cost time: 0.46251511573791504
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3706498 Best vali loss: 0.3703888

best validation loss 0.3703887714501214

{'batch_size': 16, 'd_core': 256, 'd_model': 512, 'dropout': 0.0023685291638, 'e_layers': 1, 'learning_rate': 0.0009803611309, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.9671640
	speed: 0.0105s/iter; left time: 42.2256s
	iters: 200, epoch: 1 | loss: 0.6634523
	speed: 0.0048s/iter; left time: 18.8516s
	iters: 300, epoch: 1 | loss: 0.5841741
	speed: 0.0044s/iter; left time: 16.6578s
	iters: 400, epoch: 1 | loss: 1.0208479
	speed: 0.0040s/iter; left time: 14.8899s
	iters: 500, epoch: 1 | loss: 0.4914218
	speed: 0.0040s/iter; left time: 14.3833s
Updating learning rate to 0.0009430483571040641
Validation loss decreased (inf --> 0.3775).  Saving model state dict ...
Epoch: 1 cost time: 2.548025608062744
Epoch: 1, Steps: 514 | Train Loss: 0.7454120 Vali Loss: 0.3774765 Best vali loss: 0.3774765
	iters: 100, epoch: 2 | loss: 0.8607036
	speed: 0.0104s/iter; left time: 36.4387s
	iters: 200, epoch: 2 | loss: 0.3253467
	speed: 0.0045s/iter; left time: 15.1936s
	iters: 300, epoch: 2 | loss: 0.7102198
	speed: 0.0046s/iter; left time: 15.1416s
	iters: 400, epoch: 2 | loss: 0.8365252
	speed: 0.0045s/iter; left time: 14.3211s
	iters: 500, epoch: 2 | loss: 0.3169253
	speed: 0.0045s/iter; left time: 14.0468s
Updating learning rate to 0.0008367905672855512
Validation loss decreased (0.3775 --> 0.3767).  Saving model state dict ...
Epoch: 2 cost time: 2.34196138381958
Epoch: 2, Steps: 514 | Train Loss: 0.6099441 Vali Loss: 0.3766522 Best vali loss: 0.3766522
	iters: 100, epoch: 3 | loss: 0.4654673
	speed: 0.0107s/iter; left time: 32.0396s
	iters: 200, epoch: 3 | loss: 0.6888116
	speed: 0.0045s/iter; left time: 12.8679s
	iters: 300, epoch: 3 | loss: 0.3283623
	speed: 0.0042s/iter; left time: 11.7778s
	iters: 400, epoch: 3 | loss: 0.4240181
	speed: 0.0046s/iter; left time: 12.2939s
	iters: 500, epoch: 3 | loss: 0.6539953
	speed: 0.0043s/iter; left time: 11.2255s
Updating learning rate to 0.0006777645467150665
Epoch: 3 cost time: 2.322993278503418
Epoch: 3, Steps: 514 | Train Loss: 0.5121309 Vali Loss: 0.3799100 Best vali loss: 0.3766522
	iters: 100, epoch: 4 | loss: 0.7115874
	speed: 0.0094s/iter; left time: 23.1822s
	iters: 200, epoch: 4 | loss: 0.6517267
	speed: 0.0025s/iter; left time: 5.8960s
	iters: 300, epoch: 4 | loss: 0.7500157
	speed: 0.0024s/iter; left time: 5.4269s
	iters: 400, epoch: 4 | loss: 0.6275846
	speed: 0.0026s/iter; left time: 5.5420s
	iters: 500, epoch: 4 | loss: 0.4269076
	speed: 0.0029s/iter; left time: 5.9728s
Updating learning rate to 0.00049018056545
Epoch: 4 cost time: 1.4691808223724365
Epoch: 4, Steps: 514 | Train Loss: 0.6335644 Vali Loss: 0.4002882 Best vali loss: 0.3766522
	iters: 100, epoch: 5 | loss: 0.4918914
	speed: 0.0121s/iter; left time: 23.7251s
	iters: 200, epoch: 5 | loss: 1.2431856
	speed: 0.0042s/iter; left time: 7.7973s
	iters: 300, epoch: 5 | loss: 0.5416889
	speed: 0.0045s/iter; left time: 7.9391s
	iters: 400, epoch: 5 | loss: 0.7346907
	speed: 0.0042s/iter; left time: 6.9317s
	iters: 500, epoch: 5 | loss: 0.2209767
	speed: 0.0036s/iter; left time: 5.6065s
Updating learning rate to 0.0003025965841849335
Epoch: 5 cost time: 2.2202486991882324
Epoch: 5, Steps: 514 | Train Loss: 0.6464867 Vali Loss: 0.4340008 Best vali loss: 0.3766522
	iters: 100, epoch: 6 | loss: 0.4066193
	speed: 0.0106s/iter; left time: 15.3338s
	iters: 200, epoch: 6 | loss: 0.3703780
	speed: 0.0043s/iter; left time: 5.7557s
	iters: 300, epoch: 6 | loss: 0.4257848
	speed: 0.0043s/iter; left time: 5.3143s
	iters: 400, epoch: 6 | loss: 0.3078479
	speed: 0.0043s/iter; left time: 4.9647s
	iters: 500, epoch: 6 | loss: 0.2217716
	speed: 0.0042s/iter; left time: 4.3843s
Updating learning rate to 0.00014357056361444874
Epoch: 6 cost time: 2.2298686504364014
Epoch: 6, Steps: 514 | Train Loss: 0.3464803 Vali Loss: 0.4235147 Best vali loss: 0.3766522
	iters: 100, epoch: 7 | loss: 0.3078256
	speed: 0.0100s/iter; left time: 9.3214s
	iters: 200, epoch: 7 | loss: 0.5358481
	speed: 0.0043s/iter; left time: 3.5498s
	iters: 300, epoch: 7 | loss: 0.6435862
	speed: 0.0041s/iter; left time: 2.9619s
	iters: 400, epoch: 7 | loss: 0.2206792
	speed: 0.0044s/iter; left time: 2.7594s
	iters: 500, epoch: 7 | loss: 0.6593029
	speed: 0.0043s/iter; left time: 2.2887s
Updating learning rate to 3.7312773795935806e-05
Epoch: 7 cost time: 2.2405147552490234
Epoch: 7, Steps: 514 | Train Loss: 0.4734484 Vali Loss: 0.4449324 Best vali loss: 0.3766522
	iters: 100, epoch: 8 | loss: 0.3269624
	speed: 0.0101s/iter; left time: 4.1751s
	iters: 200, epoch: 8 | loss: 0.5288996
	speed: 0.0041s/iter; left time: 1.2836s
	iters: 300, epoch: 8 | loss: 0.4922947
	speed: 0.0043s/iter; left time: 0.9153s
	iters: 400, epoch: 8 | loss: 0.5873183
	speed: 0.0044s/iter; left time: 0.5107s
	iters: 500, epoch: 8 | loss: 0.3336690
	speed: 0.0045s/iter; left time: 0.0675s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.212881088256836
Epoch: 8, Steps: 514 | Train Loss: 0.4538288 Vali Loss: 0.4480909 Best vali loss: 0.3766522

best validation loss 0.37665224478146414

{'batch_size': 64, 'd_core': 512, 'd_model': 32, 'dropout': 0.0012374140538, 'e_layers': 2, 'learning_rate': 0.0005328478516, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5398196
	speed: 0.0123s/iter; left time: 11.4331s
Updating learning rate to 0.0005328478516
Validation loss decreased (inf --> 0.3805).  Saving model state dict ...
Epoch: 1 cost time: 1.1041419506072998
Epoch: 1, Steps: 129 | Train Loss: 0.5398196 Vali Loss: 0.3804974 Best vali loss: 0.3804974
	iters: 100, epoch: 2 | loss: 0.7298386
	speed: 0.0106s/iter; left time: 8.5080s
Updating learning rate to 0.0002664239258
Validation loss decreased (0.3805 --> 0.3684).  Saving model state dict ...
Epoch: 2 cost time: 0.7924795150756836
Epoch: 2, Steps: 129 | Train Loss: 0.7298386 Vali Loss: 0.3683501 Best vali loss: 0.3683501
	iters: 100, epoch: 3 | loss: 0.6932052
	speed: 0.0099s/iter; left time: 6.6554s
Updating learning rate to 0.0001332119629
Epoch: 3 cost time: 0.7275733947753906
Epoch: 3, Steps: 129 | Train Loss: 0.6932052 Vali Loss: 0.3705934 Best vali loss: 0.3683501

best validation loss 0.36835005872376075

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0062416843763, 'e_layers': 1, 'learning_rate': 6.62506528e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.9142200
	speed: 0.0100s/iter; left time: 40.0052s
	iters: 200, epoch: 1 | loss: 0.9506261
	speed: 0.0043s/iter; left time: 16.8146s
	iters: 300, epoch: 1 | loss: 0.1876925
	speed: 0.0047s/iter; left time: 17.9730s
	iters: 400, epoch: 1 | loss: 0.6305410
	speed: 0.0043s/iter; left time: 15.9080s
	iters: 500, epoch: 1 | loss: 0.7223161
	speed: 0.0044s/iter; left time: 15.7825s
Updating learning rate to 6.372913746871579e-05
Validation loss decreased (inf --> 0.3673).  Saving model state dict ...
Epoch: 1 cost time: 2.522810935974121
Epoch: 1, Steps: 514 | Train Loss: 0.6810791 Vali Loss: 0.3672722 Best vali loss: 0.3672722
	iters: 100, epoch: 2 | loss: 0.7964962
	speed: 0.0095s/iter; left time: 33.3966s
	iters: 200, epoch: 2 | loss: 0.4928133
	speed: 0.0038s/iter; left time: 13.0260s
	iters: 300, epoch: 2 | loss: 0.3798431
	speed: 0.0038s/iter; left time: 12.4827s
	iters: 400, epoch: 2 | loss: 0.4617570
	speed: 0.0037s/iter; left time: 11.7821s
	iters: 500, epoch: 2 | loss: 0.4945061
	speed: 0.0041s/iter; left time: 12.6254s
Updating learning rate to 5.654846932645776e-05
Validation loss decreased (0.3673 --> 0.3619).  Saving model state dict ...
Epoch: 2 cost time: 2.047203779220581
Epoch: 2, Steps: 514 | Train Loss: 0.5250831 Vali Loss: 0.3618953 Best vali loss: 0.3618953
	iters: 100, epoch: 3 | loss: 1.1029581
	speed: 0.0101s/iter; left time: 30.2524s
	iters: 200, epoch: 3 | loss: 0.8339066
	speed: 0.0036s/iter; left time: 10.2785s
	iters: 300, epoch: 3 | loss: 0.6087094
	speed: 0.0040s/iter; left time: 11.1192s
	iters: 400, epoch: 3 | loss: 0.3433056
	speed: 0.0037s/iter; left time: 9.8375s
	iters: 500, epoch: 3 | loss: 0.4029949
	speed: 0.0030s/iter; left time: 7.7439s
Updating learning rate to 4.580184000496592e-05
Epoch: 3 cost time: 1.923053503036499
Epoch: 3, Steps: 514 | Train Loss: 0.6583749 Vali Loss: 0.3682552 Best vali loss: 0.3618953

best validation loss 0.3618953181273342

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0050208083396, 'e_layers': 3, 'learning_rate': 0.0002448164473, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.00023549867609129905
Validation loss decreased (inf --> 0.3695).  Saving model state dict ...
Epoch: 1 cost time: 0.8115901947021484
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3694511 Best vali loss: 0.3694511
Updating learning rate to 0.00020896390866591454
Validation loss decreased (0.3695 --> 0.3674).  Saving model state dict ...
Epoch: 2 cost time: 0.5404863357543945
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3674265 Best vali loss: 0.3674265
Updating learning rate to 0.00016925182282609557
Epoch: 3 cost time: 0.5237095355987549
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3693441 Best vali loss: 0.3674265

best validation loss 0.36742648148583523

{'batch_size': 16, 'd_core': 32, 'd_model': 512, 'dropout': 0.0062416843763, 'e_layers': 1, 'learning_rate': 6.62506528e-05, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.8120160
	speed: 0.0102s/iter; left time: 25.2068s
	iters: 200, epoch: 4 | loss: 0.7184680
	speed: 0.0036s/iter; left time: 8.4319s
	iters: 300, epoch: 4 | loss: 0.1805396
	speed: 0.0037s/iter; left time: 8.5027s
	iters: 400, epoch: 4 | loss: 0.5796191
	speed: 0.0035s/iter; left time: 7.6015s
	iters: 500, epoch: 4 | loss: 0.7138839
	speed: 0.0033s/iter; left time: 6.7778s
Updating learning rate to 3.31253264e-05
Epoch: 4 cost time: 2.1523361206054688
Epoch: 4, Steps: 514 | Train Loss: 0.6009053 Vali Loss: 0.3679681 Best vali loss: 0.3618953
	iters: 100, epoch: 5 | loss: 0.7136949
	speed: 0.0098s/iter; left time: 19.1262s
	iters: 200, epoch: 5 | loss: 0.4985168
	speed: 0.0037s/iter; left time: 6.9053s
	iters: 300, epoch: 5 | loss: 0.3782618
	speed: 0.0037s/iter; left time: 6.4516s
	iters: 400, epoch: 5 | loss: 0.3931006
	speed: 0.0035s/iter; left time: 5.8214s
	iters: 500, epoch: 5 | loss: 0.4733178
	speed: 0.0038s/iter; left time: 5.9314s
Updating learning rate to 2.044881279503408e-05
Epoch: 5 cost time: 1.9328365325927734
Epoch: 5, Steps: 514 | Train Loss: 0.4913784 Vali Loss: 0.3646078 Best vali loss: 0.3618953
	iters: 100, epoch: 6 | loss: 0.9965153
	speed: 0.0095s/iter; left time: 13.6851s
	iters: 200, epoch: 6 | loss: 0.6932272
	speed: 0.0035s/iter; left time: 4.7326s
	iters: 300, epoch: 6 | loss: 0.5833297
	speed: 0.0037s/iter; left time: 4.5457s
	iters: 400, epoch: 6 | loss: 0.2723335
	speed: 0.0042s/iter; left time: 4.8416s
	iters: 500, epoch: 6 | loss: 0.3971325
	speed: 0.0038s/iter; left time: 3.9810s
Updating learning rate to 9.702183473542235e-06
Epoch: 6 cost time: 1.9765212535858154
Epoch: 6, Steps: 514 | Train Loss: 0.5885076 Vali Loss: 0.3701930 Best vali loss: 0.3618953
	iters: 100, epoch: 7 | loss: 0.4234980
	speed: 0.0099s/iter; left time: 9.1647s
	iters: 200, epoch: 7 | loss: 0.2835810
	speed: 0.0035s/iter; left time: 2.8998s
	iters: 300, epoch: 7 | loss: 0.3207344
	speed: 0.0036s/iter; left time: 2.6561s
	iters: 400, epoch: 7 | loss: 0.3273791
	speed: 0.0034s/iter; left time: 2.1604s
	iters: 500, epoch: 7 | loss: 0.2441811
	speed: 0.0033s/iter; left time: 1.7288s
Updating learning rate to 2.521515331284215e-06
Epoch: 7 cost time: 1.8743665218353271
Epoch: 7, Steps: 514 | Train Loss: 0.3198747 Vali Loss: 0.3696055 Best vali loss: 0.3618953
	iters: 100, epoch: 8 | loss: 0.3741500
	speed: 0.0099s/iter; left time: 4.0881s
	iters: 200, epoch: 8 | loss: 0.7028062
	speed: 0.0037s/iter; left time: 1.1702s
	iters: 300, epoch: 8 | loss: 0.3749602
	speed: 0.0035s/iter; left time: 0.7461s
	iters: 400, epoch: 8 | loss: 0.4767283
	speed: 0.0036s/iter; left time: 0.4092s
	iters: 500, epoch: 8 | loss: 0.4551506
	speed: 0.0036s/iter; left time: 0.0538s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.915022611618042
Epoch: 8, Steps: 514 | Train Loss: 0.4767591 Vali Loss: 0.3700086 Best vali loss: 0.3618953

best validation loss 0.3618953181273342

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0015412585082, 'e_layers': 1, 'learning_rate': 0.0019773820382, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0019773820382
Validation loss decreased (inf --> 0.3653).  Saving model state dict ...
Epoch: 1 cost time: 0.728313684463501
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3653241 Best vali loss: 0.3653241
Updating learning rate to 0.0009886910191
Epoch: 2 cost time: 0.4510951042175293
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3780965 Best vali loss: 0.3653241
Updating learning rate to 0.00049434550955
Epoch: 3 cost time: 0.5030505657196045
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3773794 Best vali loss: 0.3653241
Updating learning rate to 0.000247172754775
Epoch: 4 cost time: 0.5212135314941406
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3838198 Best vali loss: 0.3653241
Updating learning rate to 0.0001235863773875
Epoch: 5 cost time: 0.4712953567504883
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3967680 Best vali loss: 0.3653241
Updating learning rate to 6.179318869375e-05
Epoch: 6 cost time: 0.48661351203918457
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3993161 Best vali loss: 0.3653241
Updating learning rate to 3.0896594346875e-05
Epoch: 7 cost time: 0.4890589714050293
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3967736 Best vali loss: 0.3653241
Updating learning rate to 1.54482971734375e-05
Epoch: 8 cost time: 0.4835958480834961
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3942787 Best vali loss: 0.3653241

best validation loss 0.36532405993090633

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.0026033575383, 'e_layers': 2, 'learning_rate': 0.0001291814818, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.8298161
	speed: 0.0106s/iter; left time: 42.6737s
	iters: 200, epoch: 1 | loss: 0.7383828
	speed: 0.0048s/iter; left time: 18.9610s
	iters: 300, epoch: 1 | loss: 0.8376392
	speed: 0.0047s/iter; left time: 17.7731s
	iters: 400, epoch: 1 | loss: 0.6915351
	speed: 0.0048s/iter; left time: 17.9722s
	iters: 500, epoch: 1 | loss: 0.3393967
	speed: 0.0049s/iter; left time: 17.7165s
Updating learning rate to 0.0001291814818
Validation loss decreased (inf --> 0.3635).  Saving model state dict ...
Epoch: 1 cost time: 2.7667555809020996
Epoch: 1, Steps: 514 | Train Loss: 0.6873540 Vali Loss: 0.3635160 Best vali loss: 0.3635160
	iters: 100, epoch: 2 | loss: 0.3374865
	speed: 0.0112s/iter; left time: 39.1342s
	iters: 200, epoch: 2 | loss: 0.3753670
	speed: 0.0045s/iter; left time: 15.4360s
	iters: 300, epoch: 2 | loss: 0.6507165
	speed: 0.0049s/iter; left time: 16.1233s
	iters: 400, epoch: 2 | loss: 0.6626473
	speed: 0.0046s/iter; left time: 14.8535s
	iters: 500, epoch: 2 | loss: 0.5972565
	speed: 0.0048s/iter; left time: 14.8988s
Updating learning rate to 6.45907409e-05
Epoch: 2 cost time: 2.4732789993286133
Epoch: 2, Steps: 514 | Train Loss: 0.5246948 Vali Loss: 0.3658359 Best vali loss: 0.3635160
	iters: 100, epoch: 3 | loss: 0.4286349
	speed: 0.0113s/iter; left time: 33.8599s
	iters: 200, epoch: 3 | loss: 0.5639495
	speed: 0.0047s/iter; left time: 13.6495s
	iters: 300, epoch: 3 | loss: 0.6107672
	speed: 0.0045s/iter; left time: 12.4794s
	iters: 400, epoch: 3 | loss: 0.2478254
	speed: 0.0047s/iter; left time: 12.4854s
	iters: 500, epoch: 3 | loss: 0.6412330
	speed: 0.0042s/iter; left time: 10.7505s
Updating learning rate to 3.229537045e-05
Epoch: 3 cost time: 2.3852787017822266
Epoch: 3, Steps: 514 | Train Loss: 0.4984820 Vali Loss: 0.3671365 Best vali loss: 0.3635160
	iters: 100, epoch: 4 | loss: 0.2222692
	speed: 0.0076s/iter; left time: 18.8598s
	iters: 200, epoch: 4 | loss: 0.4314742
	speed: 0.0055s/iter; left time: 12.9275s
	iters: 300, epoch: 4 | loss: 0.6218611
	speed: 0.0055s/iter; left time: 12.4930s
	iters: 400, epoch: 4 | loss: 0.6666194
	speed: 0.0052s/iter; left time: 11.3322s
	iters: 500, epoch: 4 | loss: 0.3366512
	speed: 0.0052s/iter; left time: 10.7732s
Updating learning rate to 1.6147685225e-05
Epoch: 4 cost time: 2.6126928329467773
Epoch: 4, Steps: 514 | Train Loss: 0.4557750 Vali Loss: 0.3702640 Best vali loss: 0.3635160
	iters: 100, epoch: 5 | loss: 0.3811874
	speed: 0.0116s/iter; left time: 22.7626s
	iters: 200, epoch: 5 | loss: 0.6705124
	speed: 0.0053s/iter; left time: 9.8029s
	iters: 300, epoch: 5 | loss: 0.5609138
	speed: 0.0051s/iter; left time: 8.9072s
	iters: 400, epoch: 5 | loss: 0.9329612
	speed: 0.0055s/iter; left time: 9.0917s
	iters: 500, epoch: 5 | loss: 0.7485837
	speed: 0.0052s/iter; left time: 8.1029s
Updating learning rate to 8.0738426125e-06
Epoch: 5 cost time: 2.7718966007232666
Epoch: 5, Steps: 514 | Train Loss: 0.6588317 Vali Loss: 0.3646560 Best vali loss: 0.3635160
	iters: 100, epoch: 6 | loss: 0.5081314
	speed: 0.0115s/iter; left time: 16.5451s
	iters: 200, epoch: 6 | loss: 0.3253592
	speed: 0.0055s/iter; left time: 7.3439s
	iters: 300, epoch: 6 | loss: 0.8352726
	speed: 0.0053s/iter; left time: 6.6371s
	iters: 400, epoch: 6 | loss: 0.3808151
	speed: 0.0051s/iter; left time: 5.7800s
	iters: 500, epoch: 6 | loss: 0.4851617
	speed: 0.0047s/iter; left time: 4.9153s
Updating learning rate to 4.03692130625e-06
Validation loss decreased (0.3635 --> 0.3634).  Saving model state dict ...
Epoch: 6 cost time: 2.7065999507904053
Epoch: 6, Steps: 514 | Train Loss: 0.5069480 Vali Loss: 0.3634306 Best vali loss: 0.3634306
	iters: 100, epoch: 7 | loss: 0.6512500
	speed: 0.0120s/iter; left time: 11.1072s
	iters: 200, epoch: 7 | loss: 0.7066916
	speed: 0.0056s/iter; left time: 4.6313s
	iters: 300, epoch: 7 | loss: 0.8766776
	speed: 0.0054s/iter; left time: 3.9687s
	iters: 400, epoch: 7 | loss: 0.7167689
	speed: 0.0054s/iter; left time: 3.4001s
	iters: 500, epoch: 7 | loss: 0.3106793
	speed: 0.0046s/iter; left time: 2.4246s
Updating learning rate to 2.018460653125e-06
Epoch: 7 cost time: 2.767021417617798
Epoch: 7, Steps: 514 | Train Loss: 0.6524135 Vali Loss: 0.3636504 Best vali loss: 0.3634306
	iters: 100, epoch: 8 | loss: 0.2727799
	speed: 0.0088s/iter; left time: 3.6332s
	iters: 200, epoch: 8 | loss: 0.3491334
	speed: 0.0036s/iter; left time: 1.1313s
	iters: 300, epoch: 8 | loss: 0.5480411
	speed: 0.0048s/iter; left time: 1.0392s
	iters: 400, epoch: 8 | loss: 0.4677002
	speed: 0.0051s/iter; left time: 0.5830s
	iters: 500, epoch: 8 | loss: 0.6359508
	speed: 0.0052s/iter; left time: 0.0774s
Updating learning rate to 1.0092303265625e-06
Epoch: 8 cost time: 2.3095202445983887
Epoch: 8, Steps: 514 | Train Loss: 0.4547211 Vali Loss: 0.3638682 Best vali loss: 0.3634306

best validation loss 0.36343063600873665

{'batch_size': 32, 'd_core': 512, 'd_model': 256, 'dropout': 0.0038735474901, 'e_layers': 1, 'learning_rate': 0.0014785219913, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5639629
	speed: 0.0096s/iter; left time: 18.8774s
	iters: 200, epoch: 1 | loss: 0.8542500
	speed: 0.0038s/iter; left time: 7.0493s
Updating learning rate to 0.0014785219913
Validation loss decreased (inf --> 0.3765).  Saving model state dict ...
Epoch: 1 cost time: 1.2740471363067627
Epoch: 1, Steps: 257 | Train Loss: 0.7091064 Vali Loss: 0.3765175 Best vali loss: 0.3765175
	iters: 100, epoch: 2 | loss: 0.9172720
	speed: 0.0094s/iter; left time: 16.0580s
	iters: 200, epoch: 2 | loss: 0.5556000
	speed: 0.0035s/iter; left time: 5.5527s
Updating learning rate to 0.00073926099565
Epoch: 2 cost time: 0.9661097526550293
Epoch: 2, Steps: 257 | Train Loss: 0.7364360 Vali Loss: 0.3768068 Best vali loss: 0.3765175
	iters: 100, epoch: 3 | loss: 0.5090774
	speed: 0.0090s/iter; left time: 13.0356s
	iters: 200, epoch: 3 | loss: 0.6631979
	speed: 0.0040s/iter; left time: 5.3340s
Updating learning rate to 0.000369630497825
Validation loss decreased (0.3765 --> 0.3680).  Saving model state dict ...
Epoch: 3 cost time: 1.0467338562011719
Epoch: 3, Steps: 257 | Train Loss: 0.5861377 Vali Loss: 0.3680092 Best vali loss: 0.3680092

best validation loss 0.3680092095743228

{'batch_size': 128, 'd_core': 64, 'd_model': 64, 'dropout': 0.0033964440824, 'e_layers': 3, 'learning_rate': 0.0014790122285, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0014227206773725282
Validation loss decreased (inf --> 0.3721).  Saving model state dict ...
Epoch: 1 cost time: 0.7593576908111572
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3720769 Best vali loss: 0.3720769
Updating learning rate to 0.0012624159023650887
Epoch: 2 cost time: 0.4881453514099121
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3788908 Best vali loss: 0.3720769
Updating learning rate to 0.0010225028523061603
Epoch: 3 cost time: 0.4952988624572754
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3753417 Best vali loss: 0.3720769

best validation loss 0.3720769179124963

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010922907516, 'e_layers': 3, 'learning_rate': 8.12568833e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.5179359
	speed: 0.0115s/iter; left time: 46.1642s
	iters: 200, epoch: 1 | loss: 0.7403525
	speed: 0.0058s/iter; left time: 22.8215s
	iters: 300, epoch: 1 | loss: 0.6943443
	speed: 0.0059s/iter; left time: 22.3838s
	iters: 400, epoch: 1 | loss: 0.7255045
	speed: 0.0057s/iter; left time: 21.0654s
	iters: 500, epoch: 1 | loss: 0.6135586
	speed: 0.0055s/iter; left time: 19.8465s
Updating learning rate to 8.12568833e-05
Validation loss decreased (inf --> 0.3715).  Saving model state dict ...
Epoch: 1 cost time: 3.2364819049835205
Epoch: 1, Steps: 514 | Train Loss: 0.6583392 Vali Loss: 0.3715121 Best vali loss: 0.3715121
	iters: 100, epoch: 2 | loss: 0.3626250
	speed: 0.0125s/iter; left time: 43.6276s
	iters: 200, epoch: 2 | loss: 0.5425113
	speed: 0.0056s/iter; left time: 19.1053s
	iters: 300, epoch: 2 | loss: 0.6147657
	speed: 0.0056s/iter; left time: 18.3895s
	iters: 400, epoch: 2 | loss: 0.3762270
	speed: 0.0056s/iter; left time: 17.9303s
	iters: 500, epoch: 2 | loss: 0.8355184
	speed: 0.0057s/iter; left time: 17.5629s
Updating learning rate to 4.062844165e-05
Validation loss decreased (0.3715 --> 0.3637).  Saving model state dict ...
Epoch: 2 cost time: 2.945007085800171
Epoch: 2, Steps: 514 | Train Loss: 0.5463295 Vali Loss: 0.3636523 Best vali loss: 0.3636523
	iters: 100, epoch: 3 | loss: 0.6854943
	speed: 0.0117s/iter; left time: 34.9076s
	iters: 200, epoch: 3 | loss: 0.4670238
	speed: 0.0053s/iter; left time: 15.2351s
	iters: 300, epoch: 3 | loss: 0.6137096
	speed: 0.0040s/iter; left time: 11.1229s
	iters: 400, epoch: 3 | loss: 0.6152089
	speed: 0.0041s/iter; left time: 10.9557s
	iters: 500, epoch: 3 | loss: 0.9123776
	speed: 0.0082s/iter; left time: 21.3114s
Updating learning rate to 2.0314220825e-05
Epoch: 3 cost time: 2.815758228302002
Epoch: 3, Steps: 514 | Train Loss: 0.6587628 Vali Loss: 0.3645061 Best vali loss: 0.3636523

best validation loss 0.3636523369136166

{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0010922907516, 'e_layers': 3, 'learning_rate': 8.12568833e-05, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.4633245
	speed: 0.0108s/iter; left time: 26.7342s
	iters: 200, epoch: 4 | loss: 0.6329823
	speed: 0.0042s/iter; left time: 10.0696s
	iters: 300, epoch: 4 | loss: 0.6328297
	speed: 0.0065s/iter; left time: 14.8743s
	iters: 400, epoch: 4 | loss: 0.6991454
	speed: 0.0067s/iter; left time: 14.5503s
	iters: 500, epoch: 4 | loss: 0.5765619
	speed: 0.0066s/iter; left time: 13.7284s
Updating learning rate to 1.01571104125e-05
Epoch: 4 cost time: 3.2093894481658936
Epoch: 4, Steps: 514 | Train Loss: 0.6009688 Vali Loss: 0.3646150 Best vali loss: 0.3636523
	iters: 100, epoch: 5 | loss: 0.3536290
	speed: 0.0134s/iter; left time: 26.3068s
	iters: 200, epoch: 5 | loss: 0.5333393
	speed: 0.0061s/iter; left time: 11.2830s
	iters: 300, epoch: 5 | loss: 0.6103376
	speed: 0.0062s/iter; left time: 10.9438s
	iters: 400, epoch: 5 | loss: 0.3683630
	speed: 0.0066s/iter; left time: 10.9083s
	iters: 500, epoch: 5 | loss: 0.8318025
	speed: 0.0069s/iter; left time: 10.8196s
Updating learning rate to 5.07855520625e-06
Epoch: 5 cost time: 3.3914883136749268
Epoch: 5, Steps: 514 | Train Loss: 0.5394943 Vali Loss: 0.3636530 Best vali loss: 0.3636523
	iters: 100, epoch: 6 | loss: 0.6552251
	speed: 0.0136s/iter; left time: 19.6147s
	iters: 200, epoch: 6 | loss: 0.4462861
	speed: 0.0063s/iter; left time: 8.5211s
	iters: 300, epoch: 6 | loss: 0.6068546
	speed: 0.0061s/iter; left time: 7.5749s
	iters: 400, epoch: 6 | loss: 0.6129660
	speed: 0.0067s/iter; left time: 7.6267s
	iters: 500, epoch: 6 | loss: 0.9028392
	speed: 0.0069s/iter; left time: 7.1779s
Updating learning rate to 2.539277603125e-06
Epoch: 6 cost time: 3.416905164718628
Epoch: 6, Steps: 514 | Train Loss: 0.6448342 Vali Loss: 0.3637148 Best vali loss: 0.3636523
	iters: 100, epoch: 7 | loss: 0.4177902
	speed: 0.0131s/iter; left time: 12.2006s
	iters: 200, epoch: 7 | loss: 0.2096020
	speed: 0.0065s/iter; left time: 5.3501s
	iters: 300, epoch: 7 | loss: 0.8896940
	speed: 0.0061s/iter; left time: 4.4408s
	iters: 400, epoch: 7 | loss: 0.6616812
	speed: 0.0067s/iter; left time: 4.2219s
	iters: 500, epoch: 7 | loss: 0.7009825
	speed: 0.0066s/iter; left time: 3.4686s
Updating learning rate to 1.2696388015625e-06
Epoch: 7 cost time: 3.3856897354125977
Epoch: 7, Steps: 514 | Train Loss: 0.5759500 Vali Loss: 0.3638119 Best vali loss: 0.3636523
	iters: 100, epoch: 8 | loss: 0.7063304
	speed: 0.0131s/iter; left time: 5.4277s
	iters: 200, epoch: 8 | loss: 0.3296132
	speed: 0.0063s/iter; left time: 1.9871s
	iters: 300, epoch: 8 | loss: 0.4126358
	speed: 0.0059s/iter; left time: 1.2663s
	iters: 400, epoch: 8 | loss: 0.6814245
	speed: 0.0067s/iter; left time: 0.7720s
	iters: 500, epoch: 8 | loss: 0.4812344
	speed: 0.0068s/iter; left time: 0.1019s
Updating learning rate to 6.3481940078125e-07
Epoch: 8 cost time: 3.3650341033935547
Epoch: 8, Steps: 514 | Train Loss: 0.5222477 Vali Loss: 0.3638385 Best vali loss: 0.3636523

best validation loss 0.3636523369136166

{'batch_size': 64, 'd_core': 512, 'd_model': 512, 'dropout': 0.0097884354818, 'e_layers': 4, 'learning_rate': 0.0002505982255, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.7744014
	speed: 0.0162s/iter; left time: 15.1542s
Updating learning rate to 0.00024106039846154902
Validation loss decreased (inf --> 0.3618).  Saving model state dict ...
Epoch: 1 cost time: 1.570117473602295
Epoch: 1, Steps: 129 | Train Loss: 0.7744014 Vali Loss: 0.3617500 Best vali loss: 0.3617500
	iters: 100, epoch: 2 | loss: 0.4884457
	speed: 0.0131s/iter; left time: 10.5617s
Updating learning rate to 0.0002138989650521828
Epoch: 2 cost time: 1.0539286136627197
Epoch: 2, Steps: 129 | Train Loss: 0.4884457 Vali Loss: 0.3618671 Best vali loss: 0.3617500
	iters: 100, epoch: 3 | loss: 0.5902773
	speed: 0.0153s/iter; left time: 10.3088s
Updating learning rate to 0.0001732490072894704
Validation loss decreased (0.3618 --> 0.3544).  Saving model state dict ...
Epoch: 3 cost time: 1.4416372776031494
Epoch: 3, Steps: 129 | Train Loss: 0.5902773 Vali Loss: 0.3544006 Best vali loss: 0.3544006
	iters: 100, epoch: 4 | loss: 0.4347690
	speed: 0.0206s/iter; left time: 11.2503s
Updating learning rate to 0.00012529911275
Validation loss decreased (0.3544 --> 0.3476).  Saving model state dict ...
Epoch: 4 cost time: 1.5847909450531006
Epoch: 4, Steps: 129 | Train Loss: 0.4347690 Vali Loss: 0.3476475 Best vali loss: 0.3476475
	iters: 100, epoch: 5 | loss: 0.5948205
	speed: 0.0197s/iter; left time: 8.2278s
Updating learning rate to 7.734921821052962e-05
Epoch: 5 cost time: 1.6183891296386719
Epoch: 5, Steps: 129 | Train Loss: 0.5948205 Vali Loss: 0.3632268 Best vali loss: 0.3476475
	iters: 100, epoch: 6 | loss: 0.5027983
	speed: 0.0191s/iter; left time: 5.5001s
Updating learning rate to 3.669926044781721e-05
Epoch: 6 cost time: 1.6377198696136475
Epoch: 6, Steps: 129 | Train Loss: 0.5027983 Vali Loss: 0.3587178 Best vali loss: 0.3476475
	iters: 100, epoch: 7 | loss: 0.6291265
	speed: 0.0188s/iter; left time: 2.9847s
Updating learning rate to 9.537827038450992e-06
Epoch: 7 cost time: 1.452091932296753
Epoch: 7, Steps: 129 | Train Loss: 0.6291265 Vali Loss: 0.3702709 Best vali loss: 0.3476475
	iters: 100, epoch: 8 | loss: 0.4659027
	speed: 0.0160s/iter; left time: 0.4789s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.463493824005127
Epoch: 8, Steps: 129 | Train Loss: 0.4659027 Vali Loss: 0.3717123 Best vali loss: 0.3476475

best validation loss 0.3476475229431932

{'batch_size': 32, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045607678964, 'e_layers': 1, 'learning_rate': 9.30573825e-05, 'lradj': 'cosine', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.3443344
	speed: 0.0108s/iter; left time: 21.1266s
	iters: 200, epoch: 1 | loss: 0.6444530
	speed: 0.0044s/iter; left time: 8.2621s
Updating learning rate to 8.9515596770412e-05
Validation loss decreased (inf --> 0.3634).  Saving model state dict ...
Epoch: 1 cost time: 1.4583344459533691
Epoch: 1, Steps: 257 | Train Loss: 0.4943937 Vali Loss: 0.3634391 Best vali loss: 0.3634391
	iters: 100, epoch: 2 | loss: 0.7110773
	speed: 0.0113s/iter; left time: 19.2813s
	iters: 200, epoch: 2 | loss: 0.4099242
	speed: 0.0041s/iter; left time: 6.5368s
Updating learning rate to 7.942944435261018e-05
Validation loss decreased (0.3634 --> 0.3601).  Saving model state dict ...
Epoch: 2 cost time: 1.2416040897369385
Epoch: 2, Steps: 257 | Train Loss: 0.5605007 Vali Loss: 0.3600576 Best vali loss: 0.3600576
	iters: 100, epoch: 3 | loss: 0.5770804
	speed: 0.0121s/iter; left time: 17.4498s
	iters: 200, epoch: 3 | loss: 0.6704516
	speed: 0.0048s/iter; left time: 6.4095s
Updating learning rate to 6.433445052100552e-05
Epoch: 3 cost time: 1.2459797859191895
Epoch: 3, Steps: 257 | Train Loss: 0.6237660 Vali Loss: 0.3690614 Best vali loss: 0.3600576
	iters: 100, epoch: 4 | loss: 0.3075420
	speed: 0.0112s/iter; left time: 13.2415s
	iters: 200, epoch: 4 | loss: 0.5769630
	speed: 0.0035s/iter; left time: 3.8198s
Updating learning rate to 4.652869125e-05
Epoch: 4 cost time: 1.0500967502593994
Epoch: 4, Steps: 257 | Train Loss: 0.4422525 Vali Loss: 0.3653911 Best vali loss: 0.3600576
	iters: 100, epoch: 5 | loss: 0.8809379
	speed: 0.0069s/iter; left time: 6.4226s
	iters: 200, epoch: 5 | loss: 0.4432384
	speed: 0.0036s/iter; left time: 2.9816s
Updating learning rate to 2.8722931978994484e-05
Epoch: 5 cost time: 1.0737462043762207
Epoch: 5, Steps: 257 | Train Loss: 0.6620882 Vali Loss: 0.3718244 Best vali loss: 0.3600576
	iters: 100, epoch: 6 | loss: 0.4678831
	speed: 0.0156s/iter; left time: 10.5021s
	iters: 200, epoch: 6 | loss: 1.0086228
	speed: 0.0055s/iter; left time: 3.1390s
Updating learning rate to 1.3627938147389826e-05
Epoch: 6 cost time: 1.5623860359191895
Epoch: 6, Steps: 257 | Train Loss: 0.7382529 Vali Loss: 0.3692791 Best vali loss: 0.3600576
	iters: 100, epoch: 7 | loss: 0.3686430
	speed: 0.0151s/iter; left time: 6.2813s
	iters: 200, epoch: 7 | loss: 0.5627679
	speed: 0.0041s/iter; left time: 1.2981s
Updating learning rate to 3.541785729588002e-06
Epoch: 7 cost time: 1.395766019821167
Epoch: 7, Steps: 257 | Train Loss: 0.4657055 Vali Loss: 0.3685922 Best vali loss: 0.3600576
	iters: 100, epoch: 8 | loss: 0.5047882
	speed: 0.0158s/iter; left time: 2.4922s
	iters: 200, epoch: 8 | loss: 0.3032824
	speed: 0.0043s/iter; left time: 0.2520s
Updating learning rate to 0.0
Epoch: 8 cost time: 1.2831976413726807
Epoch: 8, Steps: 257 | Train Loss: 0.4040353 Vali Loss: 0.3713015 Best vali loss: 0.3600576

best validation loss 0.36005760793133196

{'batch_size': 128, 'd_core': 512, 'd_model': 128, 'dropout': 0.0038819458795, 'e_layers': 2, 'learning_rate': 0.0002544908897, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002544908897
Validation loss decreased (inf --> 0.3778).  Saving model state dict ...
Epoch: 1 cost time: 0.6039135456085205
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3777973 Best vali loss: 0.3777973
Updating learning rate to 0.00012724544485
Validation loss decreased (0.3778 --> 0.3662).  Saving model state dict ...
Epoch: 2 cost time: 0.35855579376220703
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3661735 Best vali loss: 0.3661735
Updating learning rate to 6.3622722425e-05
Epoch: 3 cost time: 0.3638126850128174
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3667561 Best vali loss: 0.3661735

best validation loss 0.3661735053380955

{'batch_size': 8, 'd_core': 64, 'd_model': 64, 'dropout': 0.0070932288252, 'e_layers': 4, 'learning_rate': 0.0005299103803, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.3715932
	speed: 0.0104s/iter; left time: 84.8056s
	iters: 200, epoch: 1 | loss: 1.7097539
	speed: 0.0048s/iter; left time: 38.7061s
	iters: 300, epoch: 1 | loss: 0.6030044
	speed: 0.0048s/iter; left time: 37.6450s
	iters: 400, epoch: 1 | loss: 0.8436715
	speed: 0.0048s/iter; left time: 37.5734s
	iters: 500, epoch: 1 | loss: 0.8790109
	speed: 0.0048s/iter; left time: 36.7307s
	iters: 600, epoch: 1 | loss: 0.2968627
	speed: 0.0048s/iter; left time: 36.8975s
	iters: 700, epoch: 1 | loss: 0.2620449
	speed: 0.0049s/iter; left time: 36.4580s
	iters: 800, epoch: 1 | loss: 0.2692101
	speed: 0.0048s/iter; left time: 35.8409s
	iters: 900, epoch: 1 | loss: 0.2716973
	speed: 0.0048s/iter; left time: 35.1720s
	iters: 1000, epoch: 1 | loss: 0.8057766
	speed: 0.0048s/iter; left time: 34.5269s
Updating learning rate to 0.0005299103803
Validation loss decreased (inf --> 0.3729).  Saving model state dict ...
Epoch: 1 cost time: 5.233470678329468
Epoch: 1, Steps: 1027 | Train Loss: 0.6312625 Vali Loss: 0.3728868 Best vali loss: 0.3728868
	iters: 100, epoch: 2 | loss: 1.0468705
	speed: 0.0125s/iter; left time: 88.8496s
	iters: 200, epoch: 2 | loss: 0.3141183
	speed: 0.0045s/iter; left time: 31.5087s
	iters: 300, epoch: 2 | loss: 0.2934912
	speed: 0.0044s/iter; left time: 30.6230s
	iters: 400, epoch: 2 | loss: 1.2093265
	speed: 0.0044s/iter; left time: 29.8019s
	iters: 500, epoch: 2 | loss: 1.3531704
	speed: 0.0044s/iter; left time: 29.5445s
	iters: 600, epoch: 2 | loss: 0.2520196
	speed: 0.0044s/iter; left time: 29.1475s
	iters: 700, epoch: 2 | loss: 0.7008002
	speed: 0.0044s/iter; left time: 28.7145s
	iters: 800, epoch: 2 | loss: 0.4416050
	speed: 0.0044s/iter; left time: 28.2147s
	iters: 900, epoch: 2 | loss: 0.7078796
	speed: 0.0044s/iter; left time: 27.9825s
	iters: 1000, epoch: 2 | loss: 0.4584339
	speed: 0.0045s/iter; left time: 27.6276s
Updating learning rate to 0.00026495519015
Epoch: 2 cost time: 4.640885829925537
Epoch: 2, Steps: 1027 | Train Loss: 0.6777715 Vali Loss: 0.3741549 Best vali loss: 0.3728868
	iters: 100, epoch: 3 | loss: 0.4226500
	speed: 0.0128s/iter; left time: 77.3202s
	iters: 200, epoch: 3 | loss: 1.1428733
	speed: 0.0052s/iter; left time: 30.8002s
	iters: 300, epoch: 3 | loss: 0.2599661
	speed: 0.0051s/iter; left time: 30.0931s
	iters: 400, epoch: 3 | loss: 1.5406383
	speed: 0.0052s/iter; left time: 29.6887s
	iters: 500, epoch: 3 | loss: 1.0789282
	speed: 0.0052s/iter; left time: 29.3142s
	iters: 600, epoch: 3 | loss: 0.4760744
	speed: 0.0052s/iter; left time: 28.9845s
	iters: 700, epoch: 3 | loss: 0.4086082
	speed: 0.0052s/iter; left time: 28.1476s
	iters: 800, epoch: 3 | loss: 0.9290676
	speed: 0.0052s/iter; left time: 27.7396s
	iters: 900, epoch: 3 | loss: 0.3592343
	speed: 0.0052s/iter; left time: 27.2453s
	iters: 1000, epoch: 3 | loss: 0.5815062
	speed: 0.0051s/iter; left time: 26.4328s
Updating learning rate to 0.000132477595075
Validation loss decreased (0.3729 --> 0.3726).  Saving model state dict ...
Epoch: 3 cost time: 5.3414788246154785
Epoch: 3, Steps: 1027 | Train Loss: 0.7199547 Vali Loss: 0.3725696 Best vali loss: 0.3725696

best validation loss 0.3725695830841196

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0113244039716, 'e_layers': 2, 'learning_rate': 0.0001157249236, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7339547
	speed: 0.0089s/iter; left time: 35.7660s
	iters: 200, epoch: 1 | loss: 0.6179045
	speed: 0.0034s/iter; left time: 13.3890s
	iters: 300, epoch: 1 | loss: 0.4086316
	speed: 0.0032s/iter; left time: 12.2809s
	iters: 400, epoch: 1 | loss: 1.1828582
	speed: 0.0031s/iter; left time: 11.5983s
	iters: 500, epoch: 1 | loss: 0.3711737
	speed: 0.0031s/iter; left time: 11.2739s
Updating learning rate to 0.0001157249236
Validation loss decreased (inf --> 0.3616).  Saving model state dict ...
Epoch: 1 cost time: 1.9672050476074219
Epoch: 1, Steps: 514 | Train Loss: 0.6629045 Vali Loss: 0.3615864 Best vali loss: 0.3615864
	iters: 100, epoch: 2 | loss: 0.3364811
	speed: 0.0078s/iter; left time: 27.3260s
	iters: 200, epoch: 2 | loss: 0.5992214
	speed: 0.0037s/iter; left time: 12.5475s
	iters: 300, epoch: 2 | loss: 0.8739290
	speed: 0.0037s/iter; left time: 12.1078s
	iters: 400, epoch: 2 | loss: 0.3454450
	speed: 0.0037s/iter; left time: 11.7678s
	iters: 500, epoch: 2 | loss: 0.6181457
	speed: 0.0037s/iter; left time: 11.4046s
Updating learning rate to 5.78624618e-05
Epoch: 2 cost time: 1.92368483543396
Epoch: 2, Steps: 514 | Train Loss: 0.5546444 Vali Loss: 0.3672168 Best vali loss: 0.3615864
	iters: 100, epoch: 3 | loss: 0.2704461
	speed: 0.0074s/iter; left time: 22.2073s
	iters: 200, epoch: 3 | loss: 0.5449623
	speed: 0.0036s/iter; left time: 10.3290s
	iters: 300, epoch: 3 | loss: 0.3385074
	speed: 0.0036s/iter; left time: 10.1344s
	iters: 400, epoch: 3 | loss: 0.3548124
	speed: 0.0036s/iter; left time: 9.7840s
	iters: 500, epoch: 3 | loss: 0.6903962
	speed: 0.0037s/iter; left time: 9.4665s
Updating learning rate to 2.89312309e-05
Epoch: 3 cost time: 1.903132438659668
Epoch: 3, Steps: 514 | Train Loss: 0.4398249 Vali Loss: 0.3620238 Best vali loss: 0.3615864

best validation loss 0.3615863578756338

{'batch_size': 16, 'd_core': 128, 'd_model': 512, 'dropout': 0.0113244039716, 'e_layers': 2, 'learning_rate': 0.0001157249236, 'lradj': 'type1', 'd_ff': 1024}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.6116549
	speed: 0.0094s/iter; left time: 23.1513s
	iters: 200, epoch: 4 | loss: 0.5771528
	speed: 0.0035s/iter; left time: 8.2190s
	iters: 300, epoch: 4 | loss: 0.3385234
	speed: 0.0032s/iter; left time: 7.3724s
	iters: 400, epoch: 4 | loss: 0.8172498
	speed: 0.0034s/iter; left time: 7.3296s
	iters: 500, epoch: 4 | loss: 0.3627749
	speed: 0.0037s/iter; left time: 7.7301s
Updating learning rate to 1.446561545e-05
Validation loss decreased (0.3616 --> 0.3544).  Saving model state dict ...
Epoch: 4 cost time: 2.087705612182617
Epoch: 4, Steps: 514 | Train Loss: 0.5414712 Vali Loss: 0.3543717 Best vali loss: 0.3543717
	iters: 100, epoch: 5 | loss: 0.3025870
	speed: 0.0075s/iter; left time: 14.7677s
	iters: 200, epoch: 5 | loss: 0.5686142
	speed: 0.0030s/iter; left time: 5.6276s
	iters: 300, epoch: 5 | loss: 0.6618457
	speed: 0.0033s/iter; left time: 5.7278s
	iters: 400, epoch: 5 | loss: 0.3420018
	speed: 0.0034s/iter; left time: 5.5580s
	iters: 500, epoch: 5 | loss: 0.5100861
	speed: 0.0033s/iter; left time: 5.0886s
Updating learning rate to 7.232807725e-06
Epoch: 5 cost time: 1.701526403427124
Epoch: 5, Steps: 514 | Train Loss: 0.4770270 Vali Loss: 0.3598215 Best vali loss: 0.3543717
	iters: 100, epoch: 6 | loss: 0.2677560
	speed: 0.0069s/iter; left time: 9.9842s
	iters: 200, epoch: 6 | loss: 0.4618729
	speed: 0.0032s/iter; left time: 4.3467s
	iters: 300, epoch: 6 | loss: 0.2924357
	speed: 0.0032s/iter; left time: 3.9308s
	iters: 400, epoch: 6 | loss: 0.3364250
	speed: 0.0031s/iter; left time: 3.5856s
	iters: 500, epoch: 6 | loss: 0.6640201
	speed: 0.0031s/iter; left time: 3.1904s
Updating learning rate to 3.6164038625e-06
Epoch: 6 cost time: 1.6572351455688477
Epoch: 6, Steps: 514 | Train Loss: 0.4045020 Vali Loss: 0.3604988 Best vali loss: 0.3543717
	iters: 100, epoch: 7 | loss: 0.2901666
	speed: 0.0076s/iter; left time: 7.0716s
	iters: 200, epoch: 7 | loss: 0.3097763
	speed: 0.0036s/iter; left time: 3.0131s
	iters: 300, epoch: 7 | loss: 0.7874175
	speed: 0.0035s/iter; left time: 2.5471s
	iters: 400, epoch: 7 | loss: 0.3535467
	speed: 0.0035s/iter; left time: 2.1702s
	iters: 500, epoch: 7 | loss: 0.2211737
	speed: 0.0034s/iter; left time: 1.8037s
Updating learning rate to 1.80820193125e-06
Epoch: 7 cost time: 1.8659415245056152
Epoch: 7, Steps: 514 | Train Loss: 0.3924162 Vali Loss: 0.3581270 Best vali loss: 0.3543717
	iters: 100, epoch: 8 | loss: 0.3677159
	speed: 0.0073s/iter; left time: 3.0495s
	iters: 200, epoch: 8 | loss: 0.4929760
	speed: 0.0036s/iter; left time: 1.1208s
	iters: 300, epoch: 8 | loss: 0.5200682
	speed: 0.0034s/iter; left time: 0.7398s
	iters: 400, epoch: 8 | loss: 0.6973065
	speed: 0.0035s/iter; left time: 0.4020s
	iters: 500, epoch: 8 | loss: 0.7225119
	speed: 0.0035s/iter; left time: 0.0518s
Updating learning rate to 9.04100965625e-07
Epoch: 8 cost time: 1.8370592594146729
Epoch: 8, Steps: 514 | Train Loss: 0.5601157 Vali Loss: 0.3602332 Best vali loss: 0.3543717

best validation loss 0.35437166098585765

{'batch_size': 128, 'd_core': 512, 'd_model': 64, 'dropout': 0.0052619006335, 'e_layers': 4, 'learning_rate': 0.0005447529536, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 0.0005447529536
Validation loss decreased (inf --> 0.3773).  Saving model state dict ...
Epoch: 1 cost time: 0.7166428565979004
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3772739 Best vali loss: 0.3772739
Updating learning rate to 0.0002723764768
Validation loss decreased (0.3773 --> 0.3696).  Saving model state dict ...
Epoch: 2 cost time: 0.47705769538879395
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3695588 Best vali loss: 0.3695588
Updating learning rate to 0.0001361882384
Epoch: 3 cost time: 0.4792640209197998
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3723241 Best vali loss: 0.3695588
Updating learning rate to 6.80941192e-05
Epoch: 4 cost time: 0.4790515899658203
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3715398 Best vali loss: 0.3695588
Updating learning rate to 3.40470596e-05
Epoch: 5 cost time: 0.467759370803833
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3709177 Best vali loss: 0.3695588
Updating learning rate to 1.70235298e-05
Epoch: 6 cost time: 0.47621631622314453
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3713724 Best vali loss: 0.3695588
Updating learning rate to 8.5117649e-06
Epoch: 7 cost time: 0.4538295269012451
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3712904 Best vali loss: 0.3695588
Updating learning rate to 4.25588245e-06
Epoch: 8 cost time: 0.46790051460266113
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3715159 Best vali loss: 0.3695588

best validation loss 0.3695588440581249

{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0010477009495, 'e_layers': 1, 'learning_rate': 0.0002179153135, 'lradj': 'cosine', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5429491
	speed: 0.0078s/iter; left time: 63.1232s
	iters: 200, epoch: 1 | loss: 1.0173149
	speed: 0.0024s/iter; left time: 19.0676s
	iters: 300, epoch: 1 | loss: 0.3281052
	speed: 0.0024s/iter; left time: 18.6464s
	iters: 400, epoch: 1 | loss: 0.9917988
	speed: 0.0024s/iter; left time: 18.7043s
	iters: 500, epoch: 1 | loss: 0.3105686
	speed: 0.0024s/iter; left time: 18.8093s
	iters: 600, epoch: 1 | loss: 1.4215970
	speed: 0.0024s/iter; left time: 18.3071s
	iters: 700, epoch: 1 | loss: 1.1107553
	speed: 0.0024s/iter; left time: 18.1663s
	iters: 800, epoch: 1 | loss: 0.8960371
	speed: 0.0024s/iter; left time: 17.9013s
	iters: 900, epoch: 1 | loss: 0.5949532
	speed: 0.0024s/iter; left time: 17.6247s
	iters: 1000, epoch: 1 | loss: 0.3506737
	speed: 0.0024s/iter; left time: 17.5971s
Updating learning rate to 0.00020962140573171524
Validation loss decreased (inf --> 0.3663).  Saving model state dict ...
Epoch: 1 cost time: 2.7549092769622803
Epoch: 1, Steps: 1027 | Train Loss: 0.7564753 Vali Loss: 0.3662974 Best vali loss: 0.3662974
	iters: 100, epoch: 2 | loss: 0.9164144
	speed: 0.0076s/iter; left time: 54.0586s
	iters: 200, epoch: 2 | loss: 0.6424502
	speed: 0.0023s/iter; left time: 16.0272s
	iters: 300, epoch: 2 | loss: 0.5530106
	speed: 0.0023s/iter; left time: 15.5282s
	iters: 400, epoch: 2 | loss: 1.0212371
	speed: 0.0023s/iter; left time: 15.5411s
	iters: 500, epoch: 2 | loss: 0.9882866
	speed: 0.0023s/iter; left time: 15.4545s
	iters: 600, epoch: 2 | loss: 0.8740387
	speed: 0.0023s/iter; left time: 15.1221s
	iters: 700, epoch: 2 | loss: 0.5645591
	speed: 0.0023s/iter; left time: 14.7732s
	iters: 800, epoch: 2 | loss: 0.4362414
	speed: 0.0023s/iter; left time: 14.8412s
	iters: 900, epoch: 2 | loss: 1.1932096
	speed: 0.0024s/iter; left time: 14.8641s
	iters: 1000, epoch: 2 | loss: 0.4498366
	speed: 0.0023s/iter; left time: 14.3529s
Updating learning rate to 0.0001860023547001212
Epoch: 2 cost time: 2.406121015548706
Epoch: 2, Steps: 1027 | Train Loss: 0.7639284 Vali Loss: 0.3684565 Best vali loss: 0.3662974
	iters: 100, epoch: 3 | loss: 1.0725598
	speed: 0.0076s/iter; left time: 45.9044s
	iters: 200, epoch: 3 | loss: 0.7153947
	speed: 0.0023s/iter; left time: 13.6879s
	iters: 300, epoch: 3 | loss: 0.3525134
	speed: 0.0023s/iter; left time: 13.4081s
	iters: 400, epoch: 3 | loss: 0.2814984
	speed: 0.0023s/iter; left time: 13.2248s
	iters: 500, epoch: 3 | loss: 0.2781717
	speed: 0.0023s/iter; left time: 12.9777s
	iters: 600, epoch: 3 | loss: 0.6155496
	speed: 0.0023s/iter; left time: 12.8365s
	iters: 700, epoch: 3 | loss: 0.5840983
	speed: 0.0023s/iter; left time: 12.6224s
	iters: 800, epoch: 3 | loss: 0.2946752
	speed: 0.0023s/iter; left time: 12.3645s
	iters: 900, epoch: 3 | loss: 0.2548781
	speed: 0.0023s/iter; left time: 12.1984s
	iters: 1000, epoch: 3 | loss: 0.3965279
	speed: 0.0023s/iter; left time: 11.7348s
Updating learning rate to 0.0001506539468175473
Epoch: 3 cost time: 2.39631986618042
Epoch: 3, Steps: 1027 | Train Loss: 0.4845867 Vali Loss: 0.3744933 Best vali loss: 0.3662974
	iters: 100, epoch: 4 | loss: 0.8704865
	speed: 0.0075s/iter; left time: 37.6719s
	iters: 200, epoch: 4 | loss: 0.7971791
	speed: 0.0025s/iter; left time: 12.0955s
	iters: 300, epoch: 4 | loss: 0.2019345
	speed: 0.0025s/iter; left time: 12.1213s
	iters: 400, epoch: 4 | loss: 0.4883718
	speed: 0.0024s/iter; left time: 11.5256s
	iters: 500, epoch: 4 | loss: 1.1665471
	speed: 0.0024s/iter; left time: 11.1976s
	iters: 600, epoch: 4 | loss: 0.5138859
	speed: 0.0024s/iter; left time: 10.9527s
	iters: 700, epoch: 4 | loss: 0.2470234
	speed: 0.0025s/iter; left time: 10.9169s
	iters: 800, epoch: 4 | loss: 0.8138298
	speed: 0.0025s/iter; left time: 10.6467s
	iters: 900, epoch: 4 | loss: 0.2855479
	speed: 0.0024s/iter; left time: 10.3591s
	iters: 1000, epoch: 4 | loss: 0.4908651
	speed: 0.0025s/iter; left time: 10.2091s
Updating learning rate to 0.00010895765675
Epoch: 4 cost time: 2.551053524017334
Epoch: 4, Steps: 1027 | Train Loss: 0.5875671 Vali Loss: 0.3818250 Best vali loss: 0.3662974
	iters: 100, epoch: 5 | loss: 0.5430737
	speed: 0.0079s/iter; left time: 31.6575s
	iters: 200, epoch: 5 | loss: 1.4324092
	speed: 0.0023s/iter; left time: 9.1130s
	iters: 300, epoch: 5 | loss: 0.8597643
	speed: 0.0023s/iter; left time: 8.7866s
	iters: 400, epoch: 5 | loss: 0.6557335
	speed: 0.0023s/iter; left time: 8.4972s
	iters: 500, epoch: 5 | loss: 0.8009493
	speed: 0.0023s/iter; left time: 8.3222s
	iters: 600, epoch: 5 | loss: 0.2419764
	speed: 0.0023s/iter; left time: 8.0792s
	iters: 700, epoch: 5 | loss: 0.7073170
	speed: 0.0023s/iter; left time: 7.8381s
	iters: 800, epoch: 5 | loss: 0.2636639
	speed: 0.0023s/iter; left time: 7.6528s
	iters: 900, epoch: 5 | loss: 0.6455269
	speed: 0.0023s/iter; left time: 7.4862s
	iters: 1000, epoch: 5 | loss: 0.8672237
	speed: 0.0023s/iter; left time: 7.2217s
Updating learning rate to 6.726136668245272e-05
Epoch: 5 cost time: 2.4286770820617676
Epoch: 5, Steps: 1027 | Train Loss: 0.7017638 Vali Loss: 0.3840944 Best vali loss: 0.3662974
	iters: 100, epoch: 6 | loss: 0.3869414
	speed: 0.0077s/iter; left time: 22.8732s
	iters: 200, epoch: 6 | loss: 1.0826225
	speed: 0.0023s/iter; left time: 6.5671s
	iters: 300, epoch: 6 | loss: 0.3893948
	speed: 0.0025s/iter; left time: 6.9567s
	iters: 400, epoch: 6 | loss: 0.2919290
	speed: 0.0025s/iter; left time: 6.6011s
	iters: 500, epoch: 6 | loss: 0.3279834
	speed: 0.0025s/iter; left time: 6.4133s
	iters: 600, epoch: 6 | loss: 0.4349009
	speed: 0.0024s/iter; left time: 6.0766s
	iters: 700, epoch: 6 | loss: 0.5301703
	speed: 0.0025s/iter; left time: 5.9397s
	iters: 800, epoch: 6 | loss: 0.2834923
	speed: 0.0025s/iter; left time: 5.6351s
	iters: 900, epoch: 6 | loss: 0.3747069
	speed: 0.0025s/iter; left time: 5.4193s
	iters: 1000, epoch: 6 | loss: 0.4920202
	speed: 0.0025s/iter; left time: 5.1863s
Updating learning rate to 3.19129587998788e-05
Epoch: 6 cost time: 2.5583009719848633
Epoch: 6, Steps: 1027 | Train Loss: 0.4594162 Vali Loss: 0.3872028 Best vali loss: 0.3662974
	iters: 100, epoch: 7 | loss: 0.2797715
	speed: 0.0076s/iter; left time: 14.8891s
	iters: 200, epoch: 7 | loss: 0.9599800
	speed: 0.0023s/iter; left time: 4.3344s
	iters: 300, epoch: 7 | loss: 0.4690004
	speed: 0.0022s/iter; left time: 3.8862s
	iters: 400, epoch: 7 | loss: 0.4463214
	speed: 0.0022s/iter; left time: 3.5669s
	iters: 500, epoch: 7 | loss: 0.3465564
	speed: 0.0023s/iter; left time: 3.6158s
	iters: 600, epoch: 7 | loss: 0.7036266
	speed: 0.0023s/iter; left time: 3.3627s
	iters: 700, epoch: 7 | loss: 1.3041385
	speed: 0.0021s/iter; left time: 2.8912s
	iters: 800, epoch: 7 | loss: 0.4199294
	speed: 0.0022s/iter; left time: 2.7942s
	iters: 900, epoch: 7 | loss: 0.7148436
	speed: 0.0023s/iter; left time: 2.6318s
	iters: 1000, epoch: 7 | loss: 0.4251737
	speed: 0.0022s/iter; left time: 2.2745s
Updating learning rate to 8.293907768284754e-06
Epoch: 7 cost time: 2.3671891689300537
Epoch: 7, Steps: 1027 | Train Loss: 0.6069342 Vali Loss: 0.3857564 Best vali loss: 0.3662974
	iters: 100, epoch: 8 | loss: 0.6789627
	speed: 0.0075s/iter; left time: 6.9578s
	iters: 200, epoch: 8 | loss: 0.7047417
	speed: 0.0023s/iter; left time: 1.9140s
	iters: 300, epoch: 8 | loss: 0.6793814
	speed: 0.0022s/iter; left time: 1.6009s
	iters: 400, epoch: 8 | loss: 0.4904766
	speed: 0.0022s/iter; left time: 1.3979s
	iters: 500, epoch: 8 | loss: 1.0880057
	speed: 0.0022s/iter; left time: 1.1677s
	iters: 600, epoch: 8 | loss: 0.6680388
	speed: 0.0022s/iter; left time: 0.9390s
	iters: 700, epoch: 8 | loss: 0.5120566
	speed: 0.0022s/iter; left time: 0.7289s
	iters: 800, epoch: 8 | loss: 0.2391371
	speed: 0.0022s/iter; left time: 0.5003s
	iters: 900, epoch: 8 | loss: 0.7361415
	speed: 0.0022s/iter; left time: 0.2833s
	iters: 1000, epoch: 8 | loss: 0.9588886
	speed: 0.0022s/iter; left time: 0.0609s
Updating learning rate to 0.0
Epoch: 8 cost time: 2.330085277557373
Epoch: 8, Steps: 1027 | Train Loss: 0.6755831 Vali Loss: 0.3847113 Best vali loss: 0.3662974

best validation loss 0.36629738641394144

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.011102994395, 'e_layers': 4, 'learning_rate': 0.0002339721939, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.6453101
	speed: 0.0111s/iter; left time: 44.3715s
	iters: 200, epoch: 1 | loss: 0.6119051
	speed: 0.0054s/iter; left time: 21.2821s
	iters: 300, epoch: 1 | loss: 0.7546054
	speed: 0.0054s/iter; left time: 20.5109s
	iters: 400, epoch: 1 | loss: 0.4206983
	speed: 0.0054s/iter; left time: 20.0642s
	iters: 500, epoch: 1 | loss: 0.3918715
	speed: 0.0055s/iter; left time: 19.9325s
Updating learning rate to 0.0002339721939
Validation loss decreased (inf --> 0.3572).  Saving model state dict ...
Epoch: 1 cost time: 3.0863752365112305
Epoch: 1, Steps: 514 | Train Loss: 0.5648781 Vali Loss: 0.3572334 Best vali loss: 0.3572334
	iters: 100, epoch: 2 | loss: 0.2854480
	speed: 0.0104s/iter; left time: 36.5144s
	iters: 200, epoch: 2 | loss: 0.2836037
	speed: 0.0055s/iter; left time: 18.6472s
	iters: 300, epoch: 2 | loss: 0.5669608
	speed: 0.0054s/iter; left time: 17.8243s
	iters: 400, epoch: 2 | loss: 0.5939565
	speed: 0.0054s/iter; left time: 17.4245s
	iters: 500, epoch: 2 | loss: 0.4555508
	speed: 0.0054s/iter; left time: 16.8386s
Updating learning rate to 0.00011698609695
Validation loss decreased (0.3572 --> 0.3550).  Saving model state dict ...
Epoch: 2 cost time: 2.828131914138794
Epoch: 2, Steps: 514 | Train Loss: 0.4371040 Vali Loss: 0.3550453 Best vali loss: 0.3550453
	iters: 100, epoch: 3 | loss: 0.3742942
	speed: 0.0104s/iter; left time: 31.1414s
	iters: 200, epoch: 3 | loss: 0.5897574
	speed: 0.0050s/iter; left time: 14.4671s
	iters: 300, epoch: 3 | loss: 0.5227307
	speed: 0.0048s/iter; left time: 13.4969s
	iters: 400, epoch: 3 | loss: 0.8866300
	speed: 0.0046s/iter; left time: 12.4579s
	iters: 500, epoch: 3 | loss: 0.5371221
	speed: 0.0048s/iter; left time: 12.3661s
Updating learning rate to 5.8493048475e-05
Validation loss decreased (0.3550 --> 0.3463).  Saving model state dict ...
Epoch: 3 cost time: 2.5808818340301514
Epoch: 3, Steps: 514 | Train Loss: 0.5821069 Vali Loss: 0.3462964 Best vali loss: 0.3462964

best validation loss 0.3462964369236603

{'batch_size': 8, 'd_core': 256, 'd_model': 32, 'dropout': 0.0020735604228, 'e_layers': 3, 'learning_rate': 0.0001005610743, 'lradj': 'type1', 'd_ff': 96}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.8900854
	speed: 0.0094s/iter; left time: 76.1690s
	iters: 200, epoch: 1 | loss: 1.4869472
	speed: 0.0040s/iter; left time: 31.9963s
	iters: 300, epoch: 1 | loss: 1.7645305
	speed: 0.0040s/iter; left time: 31.4884s
	iters: 400, epoch: 1 | loss: 0.2848640
	speed: 0.0040s/iter; left time: 31.2602s
	iters: 500, epoch: 1 | loss: 1.1282116
	speed: 0.0040s/iter; left time: 30.7788s
	iters: 600, epoch: 1 | loss: 0.4557501
	speed: 0.0040s/iter; left time: 30.5685s
	iters: 700, epoch: 1 | loss: 0.5194060
	speed: 0.0040s/iter; left time: 29.8642s
	iters: 800, epoch: 1 | loss: 0.9848419
	speed: 0.0040s/iter; left time: 29.5791s
	iters: 900, epoch: 1 | loss: 0.5934942
	speed: 0.0040s/iter; left time: 29.1711s
	iters: 1000, epoch: 1 | loss: 0.5214010
	speed: 0.0040s/iter; left time: 28.6517s
Updating learning rate to 0.0001005610743
Validation loss decreased (inf --> 0.3880).  Saving model state dict ...
Epoch: 1 cost time: 4.370950937271118
Epoch: 1, Steps: 1027 | Train Loss: 0.8629532 Vali Loss: 0.3879526 Best vali loss: 0.3879526
	iters: 100, epoch: 2 | loss: 0.3616682
	speed: 0.0110s/iter; left time: 77.9530s
	iters: 200, epoch: 2 | loss: 0.4057006
	speed: 0.0040s/iter; left time: 28.2955s
	iters: 300, epoch: 2 | loss: 1.0778039
	speed: 0.0040s/iter; left time: 27.4344s
	iters: 400, epoch: 2 | loss: 1.1564600
	speed: 0.0040s/iter; left time: 27.0019s
	iters: 500, epoch: 2 | loss: 2.0060749
	speed: 0.0040s/iter; left time: 26.7721s
	iters: 600, epoch: 2 | loss: 0.6610779
	speed: 0.0040s/iter; left time: 26.3530s
	iters: 700, epoch: 2 | loss: 1.0582392
	speed: 0.0040s/iter; left time: 25.9580s
	iters: 800, epoch: 2 | loss: 0.4079909
	speed: 0.0039s/iter; left time: 24.9455s
	iters: 900, epoch: 2 | loss: 0.4166729
	speed: 0.0039s/iter; left time: 24.5803s
	iters: 1000, epoch: 2 | loss: 0.6993649
	speed: 0.0039s/iter; left time: 24.2782s
Updating learning rate to 5.028053715e-05
Validation loss decreased (0.3880 --> 0.3758).  Saving model state dict ...
Epoch: 2 cost time: 4.131965637207031
Epoch: 2, Steps: 1027 | Train Loss: 0.8251053 Vali Loss: 0.3757695 Best vali loss: 0.3757695
	iters: 100, epoch: 3 | loss: 1.4045581
	speed: 0.0112s/iter; left time: 67.6829s
	iters: 200, epoch: 3 | loss: 0.4953495
	speed: 0.0042s/iter; left time: 25.1905s
	iters: 300, epoch: 3 | loss: 0.4299120
	speed: 0.0042s/iter; left time: 24.6875s
	iters: 400, epoch: 3 | loss: 0.6404632
	speed: 0.0042s/iter; left time: 24.1132s
	iters: 500, epoch: 3 | loss: 0.9312688
	speed: 0.0042s/iter; left time: 23.9043s
	iters: 600, epoch: 3 | loss: 0.3095744
	speed: 0.0042s/iter; left time: 23.3012s
	iters: 700, epoch: 3 | loss: 0.3537521
	speed: 0.0042s/iter; left time: 22.8846s
	iters: 800, epoch: 3 | loss: 1.3169565
	speed: 0.0042s/iter; left time: 22.4962s
	iters: 900, epoch: 3 | loss: 0.5148501
	speed: 0.0042s/iter; left time: 21.9878s
	iters: 1000, epoch: 3 | loss: 1.0678194
	speed: 0.0042s/iter; left time: 21.7641s
Updating learning rate to 2.5140268575e-05
Validation loss decreased (0.3758 --> 0.3723).  Saving model state dict ...
Epoch: 3 cost time: 4.354470252990723
Epoch: 3, Steps: 1027 | Train Loss: 0.7464504 Vali Loss: 0.3722978 Best vali loss: 0.3722978

best validation loss 0.37229782516220933

{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0053943522932, 'e_layers': 4, 'learning_rate': 0.0002804459926, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Updating learning rate to 0.0002697721525689759
Validation loss decreased (inf --> 0.3676).  Saving model state dict ...
Epoch: 1 cost time: 0.7900338172912598
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3676371 Best vali loss: 0.3676371
Updating learning rate to 0.00023937562786202615
Epoch: 2 cost time: 0.537423849105835
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3688551 Best vali loss: 0.3676371
Updating learning rate to 0.0001938840138206013
Validation loss decreased (0.3676 --> 0.3589).  Saving model state dict ...
Epoch: 3 cost time: 0.5436360836029053
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3588889 Best vali loss: 0.3588889

best validation loss 0.35888890920313027

{'batch_size': 16, 'd_core': 256, 'd_model': 256, 'dropout': 0.011102994395, 'e_layers': 4, 'learning_rate': 0.0002339721939, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
	iters: 100, epoch: 4 | loss: 0.5185745
	speed: 0.0110s/iter; left time: 27.2540s
	iters: 200, epoch: 4 | loss: 0.5540779
	speed: 0.0051s/iter; left time: 12.0150s
	iters: 300, epoch: 4 | loss: 0.6583974
	speed: 0.0050s/iter; left time: 11.3726s
	iters: 400, epoch: 4 | loss: 0.3886960
	speed: 0.0051s/iter; left time: 11.1179s
	iters: 500, epoch: 4 | loss: 0.3744498
	speed: 0.0048s/iter; left time: 9.9146s
Updating learning rate to 2.92465242375e-05
Epoch: 4 cost time: 2.86814546585083
Epoch: 4, Steps: 514 | Train Loss: 0.4988391 Vali Loss: 0.3484154 Best vali loss: 0.3462964
	iters: 100, epoch: 5 | loss: 0.2915146
	speed: 0.0095s/iter; left time: 18.5888s
	iters: 200, epoch: 5 | loss: 0.2668631
	speed: 0.0047s/iter; left time: 8.6514s
	iters: 300, epoch: 5 | loss: 0.5442292
	speed: 0.0046s/iter; left time: 8.1509s
	iters: 400, epoch: 5 | loss: 0.4973778
	speed: 0.0046s/iter; left time: 7.5605s
	iters: 500, epoch: 5 | loss: 0.4533380
	speed: 0.0045s/iter; left time: 7.0513s
Updating learning rate to 1.462326211875e-05
Epoch: 5 cost time: 2.4259841442108154
Epoch: 5, Steps: 514 | Train Loss: 0.4106645 Vali Loss: 0.3488279 Best vali loss: 0.3462964
	iters: 100, epoch: 6 | loss: 0.3167683
	speed: 0.0101s/iter; left time: 14.5806s
	iters: 200, epoch: 6 | loss: 0.5341048
	speed: 0.0053s/iter; left time: 7.1470s
	iters: 300, epoch: 6 | loss: 0.4292780
	speed: 0.0051s/iter; left time: 6.3591s
	iters: 400, epoch: 6 | loss: 0.7920961
	speed: 0.0052s/iter; left time: 5.9588s
	iters: 500, epoch: 6 | loss: 0.4796803
	speed: 0.0052s/iter; left time: 5.3892s
Updating learning rate to 7.311631059375e-06
Epoch: 6 cost time: 2.727321147918701
Epoch: 6, Steps: 514 | Train Loss: 0.5103855 Vali Loss: 0.3485177 Best vali loss: 0.3462964
	iters: 100, epoch: 7 | loss: 0.4535462
	speed: 0.0101s/iter; left time: 9.3946s
	iters: 200, epoch: 7 | loss: 0.2757767
	speed: 0.0047s/iter; left time: 3.9297s
	iters: 300, epoch: 7 | loss: 0.8010013
	speed: 0.0050s/iter; left time: 3.6236s
	iters: 400, epoch: 7 | loss: 0.6388069
	speed: 0.0051s/iter; left time: 3.2106s
	iters: 500, epoch: 7 | loss: 0.7124085
	speed: 0.0051s/iter; left time: 2.6833s
Updating learning rate to 3.6558155296875e-06
Epoch: 7 cost time: 2.6311748027801514
Epoch: 7, Steps: 514 | Train Loss: 0.5763079 Vali Loss: 0.3493558 Best vali loss: 0.3462964
	iters: 100, epoch: 8 | loss: 0.2039052
	speed: 0.0100s/iter; left time: 4.1370s
	iters: 200, epoch: 8 | loss: 0.3156397
	speed: 0.0050s/iter; left time: 1.5856s
	iters: 300, epoch: 8 | loss: 0.5281196
	speed: 0.0050s/iter; left time: 1.0746s
	iters: 400, epoch: 8 | loss: 0.3677471
	speed: 0.0050s/iter; left time: 0.5761s
	iters: 500, epoch: 8 | loss: 0.9595592
	speed: 0.0049s/iter; left time: 0.0739s
Updating learning rate to 1.82790776484375e-06
Epoch: 8 cost time: 2.610775947570801
Epoch: 8, Steps: 514 | Train Loss: 0.4749942 Vali Loss: 0.3502129 Best vali loss: 0.3462964

best validation loss 0.3462964369236603

{'batch_size': 128, 'd_core': 32, 'd_model': 256, 'dropout': 0.0019713488614, 'e_layers': 4, 'learning_rate': 8.81054616e-05, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Updating learning rate to 8.81054616e-05
Validation loss decreased (inf --> 0.3789).  Saving model state dict ...
Epoch: 1 cost time: 0.7090554237365723
Epoch: 1, Steps: 65 | Train Loss: nan Vali Loss: 0.3788654 Best vali loss: 0.3788654
Updating learning rate to 4.40527308e-05
Validation loss decreased (0.3789 --> 0.3664).  Saving model state dict ...
Epoch: 2 cost time: 0.4634218215942383
Epoch: 2, Steps: 65 | Train Loss: nan Vali Loss: 0.3663779 Best vali loss: 0.3663779
Updating learning rate to 2.20263654e-05
Validation loss decreased (0.3664 --> 0.3638).  Saving model state dict ...
Epoch: 3 cost time: 0.4788496494293213
Epoch: 3, Steps: 65 | Train Loss: nan Vali Loss: 0.3637659 Best vali loss: 0.3637659
Updating learning rate to 1.10131827e-05
Validation loss decreased (0.3638 --> 0.3637).  Saving model state dict ...
Epoch: 4 cost time: 0.482088565826416
Epoch: 4, Steps: 65 | Train Loss: nan Vali Loss: 0.3637087 Best vali loss: 0.3637087
Updating learning rate to 5.50659135e-06
Validation loss decreased (0.3637 --> 0.3635).  Saving model state dict ...
Epoch: 5 cost time: 0.4818298816680908
Epoch: 5, Steps: 65 | Train Loss: nan Vali Loss: 0.3635393 Best vali loss: 0.3635393
Updating learning rate to 2.753295675e-06
Epoch: 6 cost time: 0.48141908645629883
Epoch: 6, Steps: 65 | Train Loss: nan Vali Loss: 0.3635488 Best vali loss: 0.3635393
Updating learning rate to 1.3766478375e-06
Epoch: 7 cost time: 0.503504753112793
Epoch: 7, Steps: 65 | Train Loss: nan Vali Loss: 0.3636556 Best vali loss: 0.3635393
Updating learning rate to 6.8832391875e-07
Epoch: 8 cost time: 0.49074578285217285
Epoch: 8, Steps: 65 | Train Loss: nan Vali Loss: 0.3636395 Best vali loss: 0.3635393

best validation loss 0.3635392797485082

{'batch_size': 64, 'd_core': 32, 'd_model': 512, 'dropout': 0.0045395061906, 'e_layers': 1, 'learning_rate': 7.97839266e-05, 'lradj': 'type1', 'd_ff': 1536}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
	iters: 100, epoch: 1 | loss: 0.5842234
	speed: 0.0086s/iter; left time: 8.0417s
Updating learning rate to 7.97839266e-05
Validation loss decreased (inf --> 0.3660).  Saving model state dict ...
Epoch: 1 cost time: 0.677478551864624
Epoch: 1, Steps: 129 | Train Loss: 0.5842234 Vali Loss: 0.3659562 Best vali loss: 0.3659562
	iters: 100, epoch: 2 | loss: 0.5920972
	speed: 0.0058s/iter; left time: 4.6902s
Updating learning rate to 3.98919633e-05
Validation loss decreased (0.3660 --> 0.3631).  Saving model state dict ...
Epoch: 2 cost time: 0.41266846656799316
Epoch: 2, Steps: 129 | Train Loss: 0.5920972 Vali Loss: 0.3631222 Best vali loss: 0.3631222
	iters: 100, epoch: 3 | loss: 0.6914778
	speed: 0.0057s/iter; left time: 3.8731s
Updating learning rate to 1.994598165e-05
Epoch: 3 cost time: 0.41707277297973633
Epoch: 3, Steps: 129 | Train Loss: 0.6914778 Vali Loss: 0.3654175 Best vali loss: 0.3631222
	iters: 100, epoch: 4 | loss: 0.5422850
	speed: 0.0057s/iter; left time: 3.1185s
Updating learning rate to 9.972990825e-06
Epoch: 4 cost time: 0.43199753761291504
Epoch: 4, Steps: 129 | Train Loss: 0.5422850 Vali Loss: 0.3645481 Best vali loss: 0.3631222
	iters: 100, epoch: 5 | loss: 0.4647134
	speed: 0.0056s/iter; left time: 2.3428s
Updating learning rate to 4.9864954125e-06
Epoch: 5 cost time: 0.42717885971069336
Epoch: 5, Steps: 129 | Train Loss: 0.4647134 Vali Loss: 0.3637598 Best vali loss: 0.3631222
	iters: 100, epoch: 6 | loss: 0.8710192
	speed: 0.0059s/iter; left time: 1.7109s
Updating learning rate to 2.49324770625e-06
Epoch: 6 cost time: 0.44386744499206543
Epoch: 6, Steps: 129 | Train Loss: 0.8710192 Vali Loss: 0.3639918 Best vali loss: 0.3631222
	iters: 100, epoch: 7 | loss: 0.6099813
	speed: 0.0059s/iter; left time: 0.9445s
Updating learning rate to 1.246623853125e-06
Epoch: 7 cost time: 0.4506227970123291
Epoch: 7, Steps: 129 | Train Loss: 0.6099813 Vali Loss: 0.3637618 Best vali loss: 0.3631222
	iters: 100, epoch: 8 | loss: 0.3922126
	speed: 0.0059s/iter; left time: 0.1776s
Updating learning rate to 6.233119265625e-07
Epoch: 8 cost time: 0.4401695728302002
Epoch: 8, Steps: 129 | Train Loss: 0.3922126 Vali Loss: 0.3637818 Best vali loss: 0.3631222

best validation loss 0.36312215684205

{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001366266417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
	iters: 100, epoch: 1 | loss: 0.7704828
	speed: 0.0154s/iter; left time: 14.3262s
Updating learning rate to 0.00013142659978119153
Validation loss decreased (inf --> 0.3621).  Saving model state dict ...
Epoch: 1 cost time: 1.551520586013794
Epoch: 1, Steps: 129 | Train Loss: 0.7704828 Vali Loss: 0.3621407 Best vali loss: 0.3621407
	iters: 100, epoch: 2 | loss: 0.6663749
	speed: 0.0157s/iter; left time: 12.6445s
Updating learning rate to 0.00011661813326840736
Validation loss decreased (0.3621 --> 0.3571).  Saving model state dict ...
Epoch: 2 cost time: 1.2978920936584473
Epoch: 2, Steps: 129 | Train Loss: 0.6663749 Vali Loss: 0.3570976 Best vali loss: 0.3570976
	iters: 100, epoch: 3 | loss: 0.4869939
	speed: 0.0160s/iter; left time: 10.7803s
Updating learning rate to 9.445569694913567e-05
Epoch: 3 cost time: 1.3010108470916748
Epoch: 3, Steps: 129 | Train Loss: 0.4869939 Vali Loss: 0.3620146 Best vali loss: 0.3570976

best validation loss 0.3570975916910265

{'batch_size': 128, 'd_core': 128, 'd_model': 512, 'dropout': 0.0023881242916, 'e_layers': 3, 'learning_rate': 0.0003852241358, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 145, in _serve
    send(conn, destination_pid)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 50, in send
    reduction.send_handle(conn, new_fd, pid)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 183, in send_handle
    with socket.fromfd(conn.fileno(), socket.AF_UNIX, socket.SOCK_STREAM) as s:
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/socket.py", line 545, in fromfd
    nfd = dup(fd)
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1327, in _next_data
    idx, data = self._get_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1293, in _get_data
    success, data = self._try_get_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1131, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 496, in rebuild_storage_fd
    fd = df.detach()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 58, in detach
    return reduction.recv_handle(conn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 189, in recv_handle
    return recvfds(s, 1)[0]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 159, in recvfds
    raise EOFError
EOFError


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception EOFError - 


{'batch_size': 8, 'd_core': 128, 'd_model': 32, 'dropout': 0.0029512536949, 'e_layers': 3, 'learning_rate': 8.61514415e-05, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 64, 'd_model': 512, 'dropout': 0.0011568001468, 'e_layers': 4, 'learning_rate': 0.0001366266417, 'lradj': 'cosine', 'd_ff': 2048}
Use GPU: cuda:0
train 8209
val 2545
loading checkpoint...
starting training loop
budget 8.0
start_epoch 3
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
    new_fd = os.dup(fd)
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 64, 'd_core': 32, 'd_model': 64, 'dropout': 0.0066302201562, 'e_layers': 1, 'learning_rate': 0.0005581450259, 'lradj': 'cosine', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 570, in reduce_storage
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 198, in DupFd
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/resource_sharer.py", line 48, in __init__
OSError: [Errno 24] Too many open files
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 16, 'd_core': 256, 'd_model': 32, 'dropout': 0.0028704942058, 'e_layers': 1, 'learning_rate': 0.0001232468964, 'lradj': 'type1', 'd_ff': 32}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 244, in _feed
    obj = _ForkingPickler.dumps(obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/reduction.py", line 51, in dumps
    cls(buf, protocol).dump(obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 296, in reduce_tensor
    from torch.nested._internal.nested_tensor import NestedTensor
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 879, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1016, in get_code
  File "<frozen importlib._bootstrap_external>", line 1073, in get_data
OSError: [Errno 24] Too many open files: '/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nested/_internal/__init__.py'
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3455346_3307364322_3> in read-write mode: Too many open files (24)



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3455346_3307364322_3> in read-write mode: Too many open files (24)



{'batch_size': 64, 'd_core': 256, 'd_model': 256, 'dropout': 0.0056007514956, 'e_layers': 2, 'learning_rate': 0.0033265458685, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3455390_2079064284_1> in read-write mode: Too many open files (24)



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 317, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in collate
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 174, in <listcomp>
    return [collate(samples, collate_fn_map=collate_fn_map) for samples in transposed]  # Backwards compatibility.
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 223, in collate_numpy_array_fn
    return collate([torch.as_tensor(b) for b in batch], collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 142, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/_utils/collate.py", line 212, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 968, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(size * self._element_size(), device=device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/storage.py", line 302, in _new_shared
    return cls._new_using_fd_cpu(size)
RuntimeError: unable to open shared memory object </torch_3455390_2079064284_1> in read-write mode: Too many open files (24)



{'batch_size': 16, 'd_core': 32, 'd_model': 128, 'dropout': 0.0035662121138, 'e_layers': 2, 'learning_rate': 0.001522687034, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
    child_r, parent_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 32, 'd_core': 32, 'd_model': 64, 'dropout': 0.003712450571, 'e_layers': 4, 'learning_rate': 0.0006308326133, 'lradj': 'type1', 'd_ff': 128}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1020, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 43, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 68, in Lock
    return Lock(ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 162, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 57, in __init__
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7a6fa41a9120>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1477, in __del__
    self._shutdown_workers()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1408, in _shutdown_workers
    if not self._shutdown:
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_shutdown'
{'batch_size': 32, 'd_core': 128, 'd_model': 64, 'dropout': 0.0060846577031, 'e_layers': 4, 'learning_rate': 0.0023894564118, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1011, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 43, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 68, in Lock
    return Lock(ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 162, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/synchronize.py", line 57, in __init__
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 32, 'd_core': 64, 'd_model': 64, 'dropout': 0.0054087995747, 'e_layers': 2, 'learning_rate': 0.000320277044, 'lradj': 'type1', 'd_ff': 192}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 221, in train
    _, train_loader = _get_data(args, flag='train')
  File "/home/antonio/Documents/tfm/SOFTS/NEW/tfm_utils/train_utils.py", line 40, in _get_data
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_factory.py", line 38, in data_provider
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_loader.py", line 44, in __init__
  File "/home/antonio/Documents/tfm/SOFTS/NEW/data_provider/data_loader.py", line 48, in __read_data__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pandas/io/common.py", line 873, in get_handle
OSError: [Errno 24] Too many open files: './dataset/ETT-small/ETTh2.csv'


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files: './dataset/ETT-small/ETTh2.csv'


{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 1, 'learning_rate': 0.0044405212972, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 64, 'd_core': 32, 'd_model': 256, 'dropout': 0.0011380106664, 'e_layers': 2, 'learning_rate': 0.0014785421787, 'lradj': 'type1', 'd_ff': 256}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 32, 'd_core': 32, 'd_model': 256, 'dropout': 0.0022180841037, 'e_layers': 4, 'learning_rate': 0.0009753388759, 'lradj': 'type1', 'd_ff': 768}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 32, 'd_core': 256, 'd_model': 512, 'dropout': 0.0011282470783, 'e_layers': 1, 'learning_rate': 0.0044405212972, 'lradj': 'cosine', 'd_ff': 1024}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 64, 'd_core': 128, 'd_model': 32, 'dropout': 0.0010243840719, 'e_layers': 4, 'learning_rate': 5.49249532e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 128, 'd_core': 32, 'd_model': 32, 'dropout': 0.0090081835366, 'e_layers': 1, 'learning_rate': 0.0022095915955, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0022057538806, 'e_layers': 3, 'learning_rate': 0.0020632911339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 128, 'd_core': 128, 'd_model': 32, 'dropout': 0.0012644689267, 'e_layers': 3, 'learning_rate': 5.87850584e-05, 'lradj': 'cosine', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



[INFO][smbo.py:320] Finished 500 trials.
{'batch_size': 64, 'd_core': 256, 'd_model': 64, 'dropout': 0.0026375387316, 'e_layers': 2, 'learning_rate': 0.0003869507914, 'lradj': 'type1', 'd_ff': 64}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 256, 'd_model': 128, 'dropout': 0.0022057538806, 'e_layers': 3, 'learning_rate': 0.0020632911339, 'lradj': 'cosine', 'd_ff': 512}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 16, 'd_core': 128, 'd_model': 32, 'dropout': 0.0027868200264, 'e_layers': 4, 'learning_rate': 0.0001369508687, 'lradj': 'cosine', 'd_ff': 96}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 16, 'd_core': 64, 'd_model': 128, 'dropout': 0.0091523064195, 'e_layers': 3, 'learning_rate': 7.3618282e-05, 'lradj': 'cosine', 'd_ff': 384}
Use GPU: cuda:0
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 219, in train
    model = model.to(device)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception RuntimeError - CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0050164002415, 'e_layers': 4, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
    w.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
    child_r, parent_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0059416893406, 'e_layers': 3, 'learning_rate': 8.06031958e-05, 'lradj': 'cosine', 'd_ff': 768}
Use CPU
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1038, in __init__
    w.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
    return Popen(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 64, in _launch
    parent_r, child_w = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


{'batch_size': 128, 'd_core': 512, 'd_model': 256, 'dropout': 0.0020327141074, 'e_layers': 2, 'learning_rate': 0.0005663536047, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 8209
val 2545
starting training loop
budget 2.6666666666666665
start_epoch 0
train_epoch 3
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1020, in __init__
    index_queue = multiprocessing_context.Queue()  # type: ignore[var-annotated]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 42, in __init__
    self._reader, self._writer = connection.Pipe(duplex=False)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 527, in Pipe
    fd1, fd2 = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7a6fa41a9120>
Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1477, in __del__
    self._shutdown_workers()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1408, in _shutdown_workers
    if not self._shutdown:
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_shutdown'
{'batch_size': 8, 'd_core': 512, 'd_model': 256, 'dropout': 0.0050164002415, 'e_layers': 4, 'learning_rate': 0.0005521233611, 'lradj': 'cosine', 'd_ff': 512}
Use CPU
train 8209
val 2545
starting training loop
budget 8.0
start_epoch 0
train_epoch 8
[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: pynisher.exceptions.PynisherException: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/limiters/limiter.py", line 143, in __call__
    result = self.func(*args, **kwargs)
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 279, in train
    for i, (batch_x, batch_y, batch_x_mark, batch_y_mark) in enumerate(train_loader):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 440, in __iter__
    return self._get_iterator()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1011, in __init__
    self._worker_result_queue = multiprocessing_context.Queue()  # type: ignore[var-annotated]
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 103, in Queue
    return Queue(maxsize, ctx=self.get_context())
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/queues.py", line 42, in __init__
    self._reader, self._writer = connection.Pipe(duplex=False)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/connection.py", line 527, in Pipe
    fd1, fd2 = os.pipe()
OSError: [Errno 24] Too many open files


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 525, in __call__
    return self._handle_return(result=result, err=err, tb=tb)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 635, in _handle_return
    raise err from err.__class__(tb)
pynisher.exceptions.PynisherException: Wrapped Exception OSError - [Errno 24] Too many open files


[WARNING][abstract_runner.py:134] Target function returned infinity or nothing at all. Result is treated as CRASHED and cost is set to inf.
[WARNING][abstract_runner.py:140] Traceback: Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 186, in run
    rval = self(config_copy, target_function, kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/runner/target_function_runner.py", line 259, in __call__
    return algorithm(config, **algorithm_kwargs)
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/pynisher/pynisher.py", line 379, in __call__
    subprocess.start()
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/process.py", line 121, in start
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/context.py", line 281, in _Popen
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 19, in __init__
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/multiprocessing/popen_fork.py", line 65, in _launch
OSError: [Errno 24] Too many open files


Traceback (most recent call last):
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/facade/abstract_facade.py", line 322, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 310, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 431, in _add_results
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 229, in tell
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 417, in save
OSError: [Errno 24] Too many open files: 'checkpoints/hptunning/smac/ETTh2_96_336/123/optimization.json'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/antonio/Documents/tfm/SOFTS/NEW/smac_softs.py", line 478, in <module>
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/facade/abstract_facade.py", line 324, in optimize
  File "/home/antonio/miniconda3/envs/py3.10-softs-smac/lib/python3.10/site-packages/smac/main/smbo.py", line 417, in save
OSError: [Errno 24] Too many open files: 'checkpoints/hptunning/smac/ETTh2_96_336/123/optimization.json'


Time taken (1 parallel trials): 6567 seconds


